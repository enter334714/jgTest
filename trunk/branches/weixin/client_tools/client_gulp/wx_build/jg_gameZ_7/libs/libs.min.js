var Laya=window.Laya=function($EO,$EM){var $Eu={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($EM,$Ee){return 1==arguments.length?$Eu.__presubstr.call(this,$EM):$Eu.__presubstr.call(this,$EM,0<$Ee?$Ee:this.length+$Ee)},__init:function($EM){$EM.forEach(function($EM){$EM.__init$&&$EM.__init$()})},__isClass:function($EM){return $EM&&($EM.__isclass||$EM==Object||$EM==String||$EM==Array)},__newvec:function($EM,$Ee){var $EL=[];$EL.length=$EM;for(var $E_=0;$E_<$EM;$E_++)$EL[$E_]=$Ee;return $EL},__extend:function($EM,$Ee){for(var $EL in $Ee)if($Ee.hasOwnProperty($EL)){var $E_=Object.getOwnPropertyDescriptor($Ee,$EL),$Ec=$E_.get,$Eq=$E_.set;$Ec||$Eq?$Ec&&$Eq?Object.defineProperty($EM,$EL,$E_):($Ec&&Object.defineProperty($EM,$EL,$Ec),$Eq&&Object.defineProperty($EM,$EL,$Eq)):$EM[$EL]=$Ee[$EL]}function $EH(){$Eu.un(this,"constructor",$EM)}$EH.prototype=$Ee.prototype,$EM.prototype=new $EH,$Eu.un($EM.prototype,"__imps",$Eu.__copy({},$Ee.prototype.__imps))},__copy:function($EM,$Ee){if(!$Ee)return null;for(var $EL in $EM=$EM||{},$Ee)$EM[$EL]=$Ee[$EL];return $EM},__package:function($EM,$Ee){if(!$Eu.__packages[$EM]){$Eu.__packages[$EM]=!0;var $EL=$EO,$E_=$EM.split(".");if(1<$E_.length)for(var $Ec=0,$Eq=$E_.length-1;$Ec<$Eq;$Ec++){var $EH=$EL[$E_[$Ec]];$EL=$EH||($EL[$E_[$Ec]]={})}$EL[$E_[$E_.length-1]]||($EL[$E_[$E_.length-1]]=$Ee||{})}},__hasOwnProperty:function($EM,$Ee){return $Ee=$Ee||this,Object.hasOwnProperty.call($Ee,$EM)||function $EM($Ee,$EL){if(Object.hasOwnProperty.call($EL.prototype,$Ee))return!0;var $E_=$EL.prototype.__super;return null==$E_?null:$EM($Ee,$E_)}($EM,$Ee.__class)},__typeof:function($EM,$Ee){if(!$EM||!$Ee)return!1;if($Ee===String)return"string"==typeof $EM;if($Ee===Number)return"number"==typeof $EM;if($Ee.__interface__)$Ee=$Ee.__interface__;else if("string"!=typeof $Ee)return $EM instanceof $Ee;return $EM.__imps&&$EM.__imps[$Ee]||$EM.__class==$Ee},__as:function($EM,$Ee){return this.__typeof($EM,$Ee)?$EM:null},__int:function($EM){return $EM?parseInt($EM):0},interface:function($EM,$Ee){$Eu.__package($EM,{});var $EL=$Eu.__internals,$E_=$EL[$EM]=$EL[$EM]||{self:$EM};if($Ee){var $Ec=$Ee.split(",");$E_.extend=[];for(var $Eq=0;$Eq<$Ec.length;$Eq++){var $EH=$Ec[$Eq];$EL[$EH]=$EL[$EH]||{self:$EH},$E_.extend.push($EL[$EH])}}var $ET=$EO,$Ex=$EM.split(".");for($Eq=0;$Eq<$Ex.length-1;$Eq++)$ET=$ET[$Ex[$Eq]];$ET[$Ex[$Ex.length-1]]={__interface__:$EM}},class:function($EM,$Ee,$EL,$E_){if($EL&&$Eu.__extend($EM,$EL),$Ee)if($Eu.__package($Ee,$EM),$Eu.__classmap[$Ee]=$EM,0<$Ee.indexOf(".")){if(0==$Ee.indexOf("laya.")){var $Ec=$Ee.split(".");$E_=$E_||$Ec[$Ec.length-1],$Eu[$E_]&&console.log("Warning!,this class["+$E_+"] already exist:",$Eu[$E_]),$Eu[$E_]=$EM}}else"Main"==$Ee?$EO.Main=$EM:"MainWX"==$Ee?$EO.MainWX=$EM:($Eu[$Ee]&&console.log("Error!,this class["+$Ee+"] already exist:",$Eu[$Ee]),$Eu[$Ee]=$EM);var $Eq=$Eu.un,$EH=$EM.prototype;$Eq($EH,"hasOwnProperty",$Eu.__hasOwnProperty),$Eq($EH,"__class",$EM),$Eq($EH,"__super",$EL),$Eq($EH,"__className",$Ee),$Eq($EM,"__super",$EL),$Eq($EM,"__className",$Ee),$Eq($EM,"__isclass",!0),$Eq($EM,"super",function($EM){this.__super.call($EM)})},imps:function($EM,$Ee){if(!$Ee)return null;var $Ec=$EM.__imps||$Eu.un($EM,"__imps",{});function $Eq($EM){var $Ee,$EL;if(($Ee=$Eu.__internals[$EM])&&($Ec[$EM]=!0,$EL=$Ee.extend))for(var $E_=0;$E_<$EL.length;$E_++)$Eq($EL[$E_].self)}for(var $EL in $Ee)$Eq($EL)},superSet:function($EM,$Ee,$EL,$E_){var $Ec=$EM.prototype["_$set_"+$EL];$Ec&&$Ec.call($Ee,$E_)},superGet:function($EM,$Ee,$EL){var $E_=$EM.prototype["_$get_"+$EL];return $E_?$E_.call($Ee):null},getset:function($EM,$Ee,$EL,$E_,$Ec){$EM?($E_&&($Ee["_$GET_"+$EL]=$E_),$Ec&&($Ee["_$SET_"+$EL]=$Ec)):($E_&&$Eu.un($Ee,"_$get_"+$EL,$E_),$Ec&&$Eu.un($Ee,"_$set_"+$EL,$Ec)),$E_&&$Ec?Object.defineProperty($Ee,$EL,{get:$E_,set:$Ec,enumerable:!1,configurable:!0}):($E_&&Object.defineProperty($Ee,$EL,{get:$E_,enumerable:!1,configurable:!0}),$Ec&&Object.defineProperty($Ee,$EL,{set:$Ec,enumerable:!1,configurable:!0}))},static:function($EL,$E_){for(var $Ec=0,$EM=$E_.length;$Ec<$EM;$Ec+=2)if("length"==$E_[$Ec])$EL.length=$E_[$Ec+1].call($EL);else{function $Ee(){var $Ee=$E_[$Ec],$EM=$E_[$Ec+1];Object.defineProperty($EL,$Ee,{get:function(){return delete this[$Ee],this[$Ee]=$EM.call(this)},set:function($EM){delete this[$Ee],this[$Ee]=$EM},enumerable:!0,configurable:!0})}$Ee()}},un:function($EM,$Ee,$EL){return $EL||($EL=$EM[$Ee]),$Eu.__propun.value=$EL,Object.defineProperty($EM,$Ee,$Eu.__propun),$EL},uns:function($Ee,$EM){$EM.forEach(function($EM){$Eu.un($Ee,$EM)})}};return $EO.console=$EO.console||{log:function(){}},$EO.trace=$EO.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$Eu}(window,document);!function($EM,$Ee,$EL){$EL.un,$EL.uns,$EL.static,$EL.class,$EL.getset,$EL.__newvec}(window,document,Laya),function($EH,$Ee,$Ey){$Ey.un,$Ey.uns;var $Ex=$Ey.static,$Eu=$Ey.class,$Ed=$Ey.getset;$Ey.__newvec;$Ey.interface("laya.runtime.IMarket"),$Ey.interface("laya.filters.IFilter"),$Ey.interface("laya.display.ILayout"),$Ey.interface("laya.resource.IDispose"),$Ey.interface("laya.runtime.IPlatform"),$Ey.interface("laya.resource.IDestroy"),$Ey.interface("laya.runtime.IConchNode"),$Ey.interface("laya.filters.IFilterAction"),$Ey.interface("laya.runtime.ICPlatformClass"),$Ey.interface("laya.resource.ICreateResource"),$Ey.interface("laya.runtime.IConchRenderObject"),$Ey.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $ES=function(){function $Eq(){}return $Eu($Eq,"laya.utils.RunDriver"),$Eq.FILTER_ACTIONS=[],$Eq.pixelRatio=-1,$Eq._charSizeTestDiv=null,$Eq.now=function(){return Date.now()},$Eq.getWindow=function(){return $EH},$Eq.getPixelRatio=function(){if($Eq.pixelRatio<0){var $EM=$Eg.context,$Ee=$EM.backingStorePixelRatio||$EM.webkitBackingStorePixelRatio||$EM.mozBackingStorePixelRatio||$EM.msBackingStorePixelRatio||$EM.oBackingStorePixelRatio||$EM.backingStorePixelRatio||1;($Eq.pixelRatio=($Eg.window.devicePixelRatio||1)/$Ee)<1&&($Eq.pixelRatio=1)}return $Eq.pixelRatio},$Eq.getIncludeStr=function($EM){return null},$Eq.createShaderCondition=function($EM){var $Ee="(function() {return "+$EM+";})";return $Ey._runScript($Ee)},$Eq.fontMap=[],$Eq.measureText=function($EM,$Ee){var $EL=$Eq.hanzi.test($EM);if($EL&&$Eq.fontMap[$Ee])return $Eq.fontMap[$Ee];var $E_=$Eg.context;$E_.font=$Ee;var $Ec=$E_.measureText($EM);return $Ec||($Ec={width:16,height:16}),$EL&&($Eq.fontMap[$Ee]=$Ec),$Ec},$Eq.getWebGLContext=function($EM){},$Eq.beginFlush=function(){},$Eq.endFinish=function(){},$Eq.addToAtlas=null,$Eq.flashFlushImage=function($EM){},$Eq.drawToCanvas=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$EXM.create("2D"),$ET=new $El($EL,$E_,$EH);return $Ef.renders[$Ee]._fun($EM,$ET,$Ec,$Eq),$EH},$Eq.createParticleTemplate2D=null,$Eq.createGLTextur=null,$Eq.createWebGLContext2D=null,$Eq.changeWebGLSize=function($EM,$Ee){},$Eq.createRenderSprite=function($EM,$Ee){return new $Ef($EM,$Ee)},$Eq.createFilterAction=function($EM){return new $EX},$Eq.createGraphics=function(){return new $EV},$Eq.clear=function($EM){$En._context.ctx.clear()},$Eq.cancelLoadByUrl=function($EM){},$Eq.clearAtlas=function($EM){},$Eq.isAtlas=function($EM){return!1},$Eq.addTextureToAtlas=function($EM){},$Eq.getTexturePixels=function($EM,$Ee,$EL,$E_,$Ec){return null},$Eq.skinAniSprite=function(){return null},$Eq.update3DLoop=function(){},$Ex($Eq,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$Eq}(),$E_=($Ed(1,$Ey,"alertGlobalError",null,function($EM){var $Eq=0;$Eg.window.onerror=$EM?function($EM,$Ee,$EL,$E_,$Ec){$Eq++<5&&$Ec&&alert($Ec.stack||$Ec)}:null}),$Ey.init=function($EM,$Ee,$EL){for(var $E_=[],$Ec=2,$Eq=arguments.length;$Ec<$Eq;$Ec++)$E_.push(arguments[$Ec]);if(!$Ey._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$Ey._arrayBufferSlice),$Ey._isinit=!0,$Eg.__init__(),$Ej.__init__(),$EV.__init__(),$Ey.timer=new $Ev,$Ey.scaleTimer=new $Ev,$Ey.loader=new $ExM,$EU.__init__(),$Ec=0;for(var $EH=$E_.length;$Ec<$EH;$Ec++)$E_[$Ec].enable&&$E_[$Ec].enable();return $EE.__init__(),$ET.__init__(),$EF.__init__(),$Ew.beginCheck(),$Ey._currentStage=$Ey.stage=new $ECM,$Ey.stage.conchModel&&$Ey.stage.conchModel.setRootNode(),$Ey._getUrlPath(),$Ey.render=new $En(0,0),$Ey.stage.size($EM,$Ee),$Ef.__init__(),$EG.__init__(),$Er.instance.__init__($Ey.stage,$En.canvas),$EiM.__init__(),$Et.autoStopMusic=!0,$Ek.__init__(),$En.canvas}},$Ey._getUrlPath=function(){var $EM=$Eg.window.location,$Ee=$EM.pathname;$Ee=$Ee&&":"==$Ee.charAt(2)?$Ee.substring(1):$Ee,$Ea.rootPath=$Ea.basePath=$Ea.getPath("file:"==$EM.protocol?$Ee:$EM.protocol+"//"+$EM.host+$EM.pathname)},$Ey._arrayBufferSlice=function($EM,$Ee){var $EL=new Uint8Array(this,$EM,$Ee-$EM),$E_=new Uint8Array($EL.length);return $E_.set($EL),$E_.buffer},$Ey._runScript=function($EM){return $Eg.window[$Ey._evcode]($EM)},$Ey.stage=null,$Ey.timer=null,$Ey.scaleTimer=null,$Ey.loader=null,$Ey.version="1.8.6",$Ey.render=null,$Ey._currentStage=null,$Ey._isinit=!1,$Ey.isDebug=!1,$Ey.MiniAdpter={init:function(){$EH.navigator&&$EH.navigator.userAgent&&-1<$EH.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$Ex($Ey,["conchMarket",function(){return this.conchMarket=$EH.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$EH.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $EM(){}return $Eu($EM,"Config"),$EM.WebGLTextCacheCount=500,$EM.atlasEnable=!1,$EM.showCanvasMark=!1,$EM.animationInterval=50,$EM.isAntialias=!1,$EM.isAlpha=!1,$EM.premultipliedAlpha=!0,$EM.isStencil=!0,$EM.preserveDrawingBuffer=!1,$EM}()),$EO=function(){function $EO(){this._events=null}$Eu($EO,"laya.events.EventDispatcher");var $EM=$EO.prototype;return $EM.hasListener=function($EM){return!!(this._events&&this._events[$EM])},$EM.getListener=function($EM){return this._events?this._events[$EM]:null},$EM.event=function($EM,$Ee){if(!this._events||!this._events[$EM])return!1;var $EL=this._events[$EM];if($EL.lock)$EL.queue||($EL.queue=[]),$EL.queue.push($Ee);else{var $E_;for($EL.lock=!0,$EL.cursor=$EL.head;$EL.cursor;)$E_=$EL.cursor,$EL.cursor=$E_.next,$E_.once&&$EO.delNode($EL,$E_),null!=$Ee?$E_.args?$E_.method.apply($E_.caller,$E_.args.concat($Ee)):$Ee instanceof Array?$E_.method.apply($E_.caller,$Ee):$E_.method.call($E_.caller,$Ee):$E_.method.apply($E_.caller,$E_.args),$E_.once&&$EO.recoverHandler($E_);$EL.lock=!1,!$EL.head&&this._events&&this._events[$EM]==$EL&&delete this._events[$EM],$EL.queue&&$EL.queue.length&&this.event($EM,$EL.queue.shift())}return!0},$EM.on=function($EM,$Ee,$EL,$E_){return this._createListener($EM,$Ee,$EL,$E_,!1)},$EM.once=function($EM,$Ee,$EL,$E_){return this._createListener($EM,$Ee,$EL,$E_,!0)},$EM._createListener=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Eq&&($Eq=!0),$Eq&&this.off($EM,$Ee,$EL,$Ec);var $EH=$EO.createHandler($Ee||this,$EL,$E_,$Ec);this._events||(this._events={});var $ET=this._events,$Ex=$ET[$EM];return $Ex?$Ex.tail?($EH.prev=$Ex.tail,$Ex.tail.next=$EH,$Ex.tail=$EH):$Ex.head=$Ex.tail=$EH:$ET[$EM]={head:$EH,tail:$EH,cursor:null,lock:!1},this},$EM.off=function($EM,$Ee,$EL,$E_){if(void 0===$E_&&($E_=!1),!this._events||!this._events[$EM])return this;for(var $Ec=this._events[$EM],$Eq=$Ec.head;$Eq;){if((!$Ee||$Eq.caller===$Ee)&&$Eq.method===$EL&&(!$E_||$Eq.once)){$EO.delNode($Ec,$Eq),$Ec.cursor==$Eq&&($Ec.cursor=$Eq.next),$EO.recoverHandler($Eq);break}$Eq=$Eq.next}return this},$EM.offAll=function($EM){var $Ee=this._events;if(!$Ee)return this;if($EM)this._recoverHandlers($Ee[$EM]),delete $Ee[$EM];else{for(var $EL in $Ee)this._recoverHandlers($Ee[$EL]);this._events=null}return this},$EM._recoverHandlers=function($EM){if($EM){for(var $Ee=$EM.head;$Ee;){$EO.delNode($EM,$Ee);var $EL=$Ee.next;$EO.recoverHandler($Ee),$Ee=$EL}$EM.cursor=null}},$EM.isMouseEvent=function($EM){return $EO.MOUSE_EVENTS[$EM]},$EO.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$EO.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$EO.delNode=function($EM,$Ee){$Ee.prev?$Ee.prev.next=$Ee.next:$EM.head=$Ee.next,$Ee.next?$Ee.next.prev=$Ee.prev:$EM.tail=$Ee.prev},$EO.createHandler=function($EM,$Ee,$EL,$E_){var $Ec=$EO._freeHandler;return $Ec?($EO._freeCount--,$EO._freeHandler=$Ec.next,$Ec.caller=$EM,$Ec.method=$Ee,$Ec.args=$EL,$Ec.once=$E_):$Ec={caller:$EM,method:$Ee,args:$EL,once:$E_},$Ec.prev=$Ec.next=null,$Ec},$EO.recoverHandler=function($EM){$EM.caller=$EM.method=$EM.args=$EM.prev=null,$EM.next=$EO._freeHandler,$EO._freeHandler=$EM,$EO._freeCount++},$EO._freeHandler=null,$EO._freeCount=0,$EO}(),$EK=function(){function $Ec($EM,$Ee,$EL,$E_){this.once=!1,void(this._id=0)===$E_&&($E_=!1),this.setTo($EM,$Ee,$EL,$E_)}$Eu($Ec,"laya.utils.Handler");var $EM=$Ec.prototype;return $EM.setTo=function($EM,$Ee,$EL,$E_){return this._id=$Ec._gid++,this.caller=$EM,this.method=$Ee,this.args=$EL,this.once=$E_,this},$EM.run=function(){if(null==this.method)return null;var $EM=this._id,$Ee=this.method.apply(this.caller,this.args);return this._id===$EM&&this.once&&this.recover(),$Ee},$EM.runWith=function($EM){if(null==this.method)return null;var $Ee=this._id;if(null==$EM)var $EL=this.method.apply(this.caller,this.args);else $EL=this.args||$EM.unshift?this.args?this.method.apply(this.caller,this.args.concat($EM)):this.method.apply(this.caller,$EM):this.method.call(this.caller,$EM);return this._id===$Ee&&this.once&&this.recover(),$EL},$EM.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$EM.recover=function(){0<this._id&&(this._id=0,this.clear())},$Ec.create=function($EM,$Ee,$EL,$E_){return void 0===$E_&&($E_=!0),new $Ec($EM,$Ee,$EL,$E_)},$Ec._gid=1,$Ec}(),$Eh=function(){function $EM(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$Eu($EM,"laya.display.BitmapFont");var $Ee=$EM.prototype;return $Ee.loadFont=function($EM,$Ee){this._path=$EM,this._complete=$Ee,$Ey.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$EK.create(this,this.onLoaded))},$Ee.onLoaded=function(){this.parseFont($ETM.getRes(this._path),$ETM.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$Ee.parseFont=function($EM,$Ee){if(null!=$EM&&null!=$Ee){this._texture=$Ee;var $EL=$EM.getElementsByTagName("info");if(!$EL[0].getAttributeNode)return this.parseFont2($EM,$Ee);this.fontSize=parseInt($EL[0].getAttributeNode("size").nodeValue);var $E_,$Ec=$EL[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($Ec[0]),parseInt($Ec[1]),parseInt($Ec[2]),parseInt($Ec[3])],$E_=$EM.getElementsByTagName("char");var $Eq=0;for($Eq=0;$Eq<$E_.length;$Eq++){var $EH=$E_[$Eq],$ET=parseInt($EH.getAttributeNode("id").nodeValue),$Ex=parseInt($EH.getAttributeNode("xoffset").nodeValue)/1,$EO=parseInt($EH.getAttributeNode("yoffset").nodeValue)/1,$Eu=parseInt($EH.getAttributeNode("xadvance").nodeValue)/1,$EG=new $EB;$EG.x=parseInt($EH.getAttributeNode("x").nodeValue),$EG.y=parseInt($EH.getAttributeNode("y").nodeValue),$EG.width=parseInt($EH.getAttributeNode("width").nodeValue),$EG.height=parseInt($EH.getAttributeNode("height").nodeValue);var $EV=$EuM.create($Ee,$EG.x,$EG.y,$EG.width,$EG.height,$Ex,$EO);this._maxWidth=Math.max(this._maxWidth,$Eu+this.letterSpacing),this._fontCharDic[$ET]=$EV,this._fontWidthMap[$ET]=$Eu}}},$Ee.parseFont2=function($EM,$Ee){if(null!=$EM&&null!=$Ee){this._texture=$Ee;var $EL=$EM.getElementsByTagName("info");this.fontSize=parseInt($EL[0].attributes.size.nodeValue);var $E_=$EL[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($E_[0]),parseInt($E_[1]),parseInt($E_[2]),parseInt($E_[3])];var $Ec=$EM.getElementsByTagName("char"),$Eq=0;for($Eq=0;$Eq<$Ec.length;$Eq++){var $EH=$Ec[$Eq].attributes,$ET=parseInt($EH.id.nodeValue),$Ex=parseInt($EH.xoffset.nodeValue)/1,$EO=parseInt($EH.yoffset.nodeValue)/1,$Eu=parseInt($EH.xadvance.nodeValue)/1,$EG=new $EB;$EG.x=parseInt($EH.x.nodeValue),$EG.y=parseInt($EH.y.nodeValue),$EG.width=parseInt($EH.width.nodeValue),$EG.height=parseInt($EH.height.nodeValue);var $EV=$EuM.create($Ee,$EG.x,$EG.y,$EG.width,$EG.height,$Ex,$EO);this._maxWidth=Math.max(this._maxWidth,$Eu+this.letterSpacing),this._fontCharDic[$ET]=$EV,this._fontWidthMap[$ET]=$Eu}}},$Ee.getCharTexture=function($EM){return this._fontCharDic[$EM.charCodeAt(0)]},$Ee.destroy=function(){if(this._texture){for(var $EM in this._fontCharDic){var $Ee=this._fontCharDic[$EM];$Ee&&$Ee.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$Ee.setSpaceWidth=function($EM){this._spaceWidth=$EM},$Ee.getCharWidth=function($EM){var $Ee=$EM.charCodeAt(0);return this._fontWidthMap[$Ee]?this._fontWidthMap[$Ee]+this.letterSpacing:" "==$EM?this._spaceWidth+this.letterSpacing:0},$Ee.getTextWidth=function($EM){for(var $Ee=0,$EL=0,$E_=$EM.length;$EL<$E_;$EL++)$Ee+=this.getCharWidth($EM.charAt($EL));return $Ee},$Ee.getMaxWidth=function(){return this._maxWidth},$Ee.getMaxHeight=function(){return this.fontSize},$Ee.drawText=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH,$ET=this.getTextWidth($EM),$Ex=0;"center"===$Ec&&($Ex=($Eq-$ET)/2),"right"===$Ec&&($Ex=$Eq-$ET);for(var $EO=0,$Eu=0,$EG=$EM.length;$Eu<$EG;$Eu++)($EH=this.getCharTexture($EM.charAt($Eu)))&&($Ee.graphics.drawTexture($EH,$EL+$EO+$Ex,$E_),$EO+=this.getCharWidth($EM.charAt($Eu)))},$EM}(),$ET=function(){function $EL(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$EL._TF_EMPTY}$Eu($EL,"laya.display.css.Style");var $EM=$EL.prototype;return $EM.getTransform=function(){return this._tf},$EM.setTransform=function($EM){this._tf="none"!==$EM&&$EM?$EM:$EL._TF_EMPTY},$EM.setTranslateX=function($EM){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.translateX=$EM},$EM.setTranslateY=function($EM){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.translateY=$EM},$EM.setScaleX=function($EM){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.scaleX=$EM},$EM.setScale=function($EM,$Ee){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.scaleX=$EM,this._tf.scaleY=$Ee},$EM.setScaleY=function($EM){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.scaleY=$EM},$EM.setRotate=function($EM){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.rotate=$EM},$EM.setSkewX=function($EM){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.skewX=$EM},$EM.setSkewY=function($EM){this._tf===$EL._TF_EMPTY&&(this._tf=new $Ec),this._tf.skewY=$EM},$EM.destroy=function(){this.scrollRect=null},$EM.render=function($EM,$Ee,$EL,$E_){},$EM.getCSSStyle=function(){return $EeM.EMPTY},$EM._enableLayout=function(){return!1},$Ed(0,$EM,"scaleX",function(){return this._tf.scaleX},function($EM){this.setScaleX($EM)}),$Ed(0,$EM,"transform",function(){return this.getTransform()},function($EM){this.setTransform($EM)}),$Ed(0,$EM,"translateX",function(){return this._tf.translateX},function($EM){this.setTranslateX($EM)}),$Ed(0,$EM,"translateY",function(){return this._tf.translateY},function($EM){this.setTranslateY($EM)}),$Ed(0,$EM,"scaleY",function(){return this._tf.scaleY},function($EM){this.setScaleY($EM)}),$Ed(0,$EM,"block",function(){return 0!=(1&this._type)}),$Ed(0,$EM,"skewY",function(){return this._tf.skewY},function($EM){this.setSkewY($EM)}),$Ed(0,$EM,"rotate",function(){return this._tf.rotate},function($EM){this.setRotate($EM)}),$Ed(0,$EM,"skewX",function(){return this._tf.skewX},function($EM){this.setSkewX($EM)}),$Ed(0,$EM,"paddingLeft",function(){return 0}),$Ed(0,$EM,"paddingTop",function(){return 0}),$Ed(0,$EM,"absolute",function(){return!0}),$EL.__init__=function(){$EL._TF_EMPTY=new $Ec,$EL.EMPTY=new $EL},$EL.EMPTY=null,$EL._TF_EMPTY=null,$EL}(),$EE=function(){function $Ee($EM){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$Em.create($Ee.defaultColor),this.family=$Ee.defaultFamily,this.stroke=$Ee._STROKE,this.size=$Ee.defaultSize,$EM&&$EM!==$Ee.EMPTY&&$EM.copyTo(this)}$Eu($Ee,"laya.display.css.Font");var $EM=$Ee.prototype;return $EM.set=function($EM){this._text=null;for(var $Ee=$EM.split(" "),$EL=0,$E_=$Ee.length;$EL<$E_;$EL++){var $Ec=$Ee[$EL];switch($Ec){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$Ec.indexOf("px")&&(this.size=parseInt($Ec),this.family=$Ee[$EL+1],$EL++)}},$EM.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$EM.copyTo=function($EM){$EM._type=this._type,$EM._text=this._text,$EM._weight=this._weight,$EM._color=this._color,$EM.family=this.family,$EM.stroke=this.stroke!=$Ee._STROKE?this.stroke.slice():$Ee._STROKE,$EM.indent=this.indent,$EM.size=this.size},$Ed(0,$EM,"password",function(){return 0!=(1024&this._type)},function($EM){$EM?this._type|=1024:this._type&=-1025}),$Ed(0,$EM,"color",function(){return this._color.strColor},function($EM){this._color=$Em.create($EM)}),$Ed(0,$EM,"italic",function(){return 0!=(512&this._type)},function($EM){$EM?this._type|=512:this._type&=-513}),$Ed(0,$EM,"bold",function(){return 0!=(2048&this._type)},function($EM){$EM?this._type|=2048:this._type&=-2049}),$Ed(0,$EM,"weight",function(){return""+this._weight},function($EM){var $Ee=0;switch($EM){case"normal":break;case"bold":this.bold=!0,$Ee=700;break;case"bolder":$Ee=800;break;case"lighter":$Ee=100;break;default:$Ee=parseInt($EM)}this._weight=$Ee,this._text=null}),$Ed(0,$EM,"decoration",function(){return this._decoration?this._decoration.value:null},function($EM){var $Ee=$EM.split(" ");switch(this._decoration||(this._decoration={}),$Ee[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$Ee[0]}$Ee[1]&&(this._decoration.color=$Em.create($Ee)),this._decoration.value=$EM}),$Ee.__init__=function(){$Ee.EMPTY=new $Ee(null)},$Ee.EMPTY=null,$Ee.defaultColor="#000000",$Ee.defaultSize=12,$Ee.defaultFamily="Arial",$Ee.defaultFont="12px Arial",$Ee._STROKE=[0,"#000000"],$Ee._ITALIC=512,$Ee._PASSWORD=1024,$Ee._BOLD=2048,$Ee}(),$Ec=function(){function $EM(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $Eu($EM,"laya.display.css.TransformInfo"),$EM}(),$EV=function(){function $EG(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$En.isConchNode){this._nativeObj=new $EH._conchGraphics,this.id=this._nativeObj.conchID}}$Eu($EG,"laya.display.Graphics");var $EM=$EG.prototype;return $EM.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$EM.clear=function($EM){void 0===$EM&&($EM=!1);var $Ee=0,$EL=0;if($EM){var $E_=this._one;if(this._cmds){for($EL=this._cmds.length,$Ee=0;$Ee<$EL;$Ee++)!($E_=this._cmds[$Ee])||$E_.callee!==$En._context._drawTexture&&$E_.callee!==$En._context._drawTextureWithTransform||($E_[0]=null,$EG._cache.push($E_));this._cmds.length=0}else $E_&&(!$E_||$E_.callee!==$En._context._drawTexture&&$E_.callee!==$En._context._drawTextureWithTransform||($E_[0]=null,$EG._cache.push($E_)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($Ee=0,$EL=this._vectorgraphArray.length;$Ee<$EL;$Ee++)$ED.getInstance().deleteShape(this._vectorgraphArray[$Ee]);this._vectorgraphArray.length=0}},$EM._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$EM._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $EL,this._graphicBounds._graphics=this)},$EM._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$EM._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$EM.getBounds=function($EM){return void 0===$EM&&($EM=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($EM)},$EM.getBoundPoints=function($EM){return void 0===$EM&&($EM=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($EM)},$EM._addCmd=function($EM){this._cmds=this._cmds||[],$EM.callee=$EM.shift(),this._cmds.push($EM)},$EM.setFilters=function($EM){this._saveToCmd($En._context._setFilters,$EM)},$EM.drawTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){if(void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),void 0===$EH&&($EH=1),!$EM||$EH<.01)return null;$E_||($E_=$EM.sourceWidth),$Ec||($Ec=$EM.sourceHeight),$EH=$EH<0?0:1<$EH?1:$EH;var $ET,$Ex=!$En.isWebGL&&($Eg.onFirefox||$Eg.onEdge||$Eg.onIE||$Eg.onSafari)?.5:0,$EO=$E_/$EM.sourceWidth,$Eu=$Ec/$EM.sourceHeight;return $E_=$EM.width*$EO,$Ec=$EM.height*$Eu,$EM.loaded&&($E_<=0||$Ec<=0)?null:($Ee+=$EM.offsetX*$EO,$EL+=$EM.offsetY*$Eu,this._sp&&(this._sp._renderType|=512),$Ee-=$Ex,$EL-=$Ex,$E_+=2*$Ex,$Ec+=2*$Ex,$EG._cache.length?(($ET=$EG._cache.pop())[0]=$EM,$ET[1]=$Ee,$ET[2]=$EL,$ET[3]=$E_,$ET[4]=$Ec,$ET[5]=$Eq,$ET[6]=$EH):$ET=[$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH],$ET.callee=$Eq||1!=$EH?$En._context._drawTextureWithTransform:$En._context._drawTexture,null!=this._one||$Eq||1!=$EH?this._saveToCmd($ET.callee,$ET):(this._one=$ET,this._render=this._renderOneImg),$EM.loaded||$EM.once("loaded",this,this._textureLoaded,[$EM,$ET]),this._repaint(),$ET)},$EM.cleanByTexture=function($EM,$Ee,$EL,$E_,$Ec){if(void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),!$EM)return this.clear();if(this._one&&this._render===this._renderOneImg){$E_||($E_=$EM.sourceWidth),$Ec||($Ec=$EM.sourceHeight);var $Eq=$E_/$EM.sourceWidth,$EH=$Ec/$EM.sourceHeight;$E_=$EM.width*$Eq,$Ec=$EM.height*$EH,$Ee+=$EM.offsetX*$Eq,$EL+=$EM.offsetY*$EH,this._one[0]=$EM,this._one[1]=$Ee,this._one[2]=$EL,this._one[3]=$E_,this._one[4]=$Ec,this._repaint()}else this.clear(),$EM&&this.drawTexture($EM,$Ee,$EL,$E_,$Ec)},$EM.drawTextures=function($EM,$Ee){$EM&&this._saveToCmd($En._context._drawTextures,[$EM,$Ee])},$EM.fillTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){if(void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq="repeat"),$EM){var $ET=[$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH||$EA.EMPTY,{}];$EM.loaded||$EM.once("loaded",this,this._textureLoaded,[$EM,$ET]),this._saveToCmd($En._context._fillTexture,$ET)}},$EM._textureLoaded=function($EM,$Ee){$Ee[3]=$Ee[3]||$EM.width,$Ee[4]=$Ee[4]||$EM.height,this._repaint()},$EM.fillCircle=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$EL.bitmap.enableMerageInAtlas=!1;var $ET=new Float32Array(2*($EH+1)),$Ex=new Float32Array(2*($EH+1)),$EO=new Uint16Array(3*$EH),$Eu=2*Math.PI/$EH,$EG=0;$ET[0]=$E_,$ET[1]=$Ec,$Ex[0]=$E_/$EL.width,$Ex[1]=$Ec/$EL.height;for(var $EV=2,$EE=0;$EE<$EH;$EE++){var $Ed=$Eq*Math.cos($EG)+$E_,$Er=$Eq*Math.sin($EG)+$Ec;$ET[$EV]=$Ed,$ET[$EV+1]=$Er,$Ex[$EV]=$Ed/$EL.width,$Ex[$EV+1]=$Er/$EL.height,$EG+=$Eu,$EV+=2}for($EE=$EV=0;$EE<$EH;$EE++)$EO[$EV++]=0,$EO[$EV++]=$EE+1,$EO[$EV++]=$EH+1<=$EE+2?1:$EE+2;this.drawTriangles($EL,$EM,$Ee,$ET,$Ex,$EO)},$EM.drawTriangles=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){void 0===$ET&&($ET=1),this._saveToCmd($En._context.drawTriangles,[$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO])},$EM._saveToCmd=function($EM,$Ee){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$Ee,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($Ee)),$Ee.callee=$EM,this._repaint(),$Ee},$EM.clipRect=function($EM,$Ee,$EL,$E_){this._saveToCmd($En._context._clipRect,[$EM,$Ee,$EL,$E_])},$EM.fillText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){void 0===$EH&&($EH=0),this._saveToCmd($En._context._fillText,[$EM,$Ee,$EL,$E_||$EE.defaultFont,$Ec,$Eq])},$EM.fillBorderText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){this._saveToCmd($En._context._fillBorderText,[$EM,$Ee,$EL,$E_||$EE.defaultFont,$Ec,$Eq,$EH,$ET])},$EM.strokeText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._saveToCmd($En._context._strokeText,[$EM,$Ee,$EL,$E_||$EE.defaultFont,$Ec,$Eq,$EH])},$EM.alpha=function($EM){$EM=$EM<0?0:1<$EM?1:$EM,this._saveToCmd($En._context._alpha,[$EM])},$EM.setAlpha=function($EM){$EM=$EM<0?0:1<$EM?1:$EM,this._saveToCmd($En._context._setAlpha,[$EM])},$EM.transform=function($EM,$Ee,$EL){void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),this._saveToCmd($En._context._transform,[$EM,$Ee,$EL])},$EM.rotate=function($EM,$Ee,$EL){void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),this._saveToCmd($En._context._rotate,[$EM,$Ee,$EL])},$EM.scale=function($EM,$Ee,$EL,$E_){void 0===$EL&&($EL=0),void 0===$E_&&($E_=0),this._saveToCmd($En._context._scale,[$EM,$Ee,$EL,$E_])},$EM.translate=function($EM,$Ee){this._saveToCmd($En._context._translate,[$EM,$Ee])},$EM.save=function(){this._saveToCmd($En._context._save,[])},$EM.restore=function(){this._saveToCmd($En._context._restore,[])},$EM.replaceText=function($EM){this._repaint();var $Ee=this._cmds;if($Ee){for(var $EL=$Ee.length-1;-1<$EL;$EL--)if(this._isTextCmd($Ee[$EL].callee))return $Ee[$EL][0].toUpperCase?$Ee[$EL][0]=$EM:$Ee[$EL][0].setText($EM),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$EM:this._one[0].setText($EM),!0;return!1},$EM._isTextCmd=function($EM){return $EM===$En._context._fillText||$EM===$En._context._fillBorderText||$EM===$En._context._strokeText},$EM.replaceTextColor=function($EM){this._repaint();var $Ee=this._cmds;if($Ee)for(var $EL=$Ee.length-1;-1<$EL;$EL--)this._isTextCmd($Ee[$EL].callee)&&($Ee[$EL][4]=$EM,$Ee[$EL][0].toUpperCase||($Ee[$EL][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$EM,this._one[0].toUpperCase||(this._one[0].changed=!0))},$EM.loadImage=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=this;void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0);var $ET=$ETM.getRes($EM);function $Ex($EM){$EM&&($EH.drawTexture($EM,$Ee,$EL,$E_,$Ec),null!=$Eq&&$Eq.call($EH._sp,$EM))}$ET?$Ex($ET):$Ey.loader.load($EM,$EK.create(null,$Ex),null,"image")},$EM._renderEmpty=function($EM,$Ee,$EL,$E_){},$EM._renderAll=function($EM,$Ee,$EL,$E_){for(var $Ec,$Eq=this._cmds,$EH=0,$ET=$Eq.length;$EH<$ET;$EH++)($Ec=$Eq[$EH]).callee.call($Ee,$EL,$E_,$Ec)},$EM._renderOne=function($EM,$Ee,$EL,$E_){this._one.callee.call($Ee,$EL,$E_,this._one)},$EM._renderOneImg=function($EM,$Ee,$EL,$E_){this._one.callee.call($Ee,$EL,$E_,this._one),2305!==$EM._renderType&&($EM._renderType|=1)},$EM.drawLine=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Eq&&($Eq=1);var $EH=0;$En.isWebGL&&($EH=$ED.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($EH));var $ET=$Eq%2==0?0:.5,$Ex=[$EM+$ET,$Ee+$ET,$EL+$ET,$E_+$ET,$Ec,$Eq,$EH];this._saveToCmd($En._context._drawLine,$Ex)},$EM.drawLines=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=1);var $Eq=0;if($EL&&!($EL.length<4)){$En.isWebGL&&($Eq=$ED.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($Eq));var $EH=$Ec%2==0?0:.5,$ET=[$EM+$EH,$Ee+$EH,$EL,$E_,$Ec,$Eq];this._saveToCmd($En._context._drawLines,$ET)}},$EM.drawCurves=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=1);var $Eq=[$EM,$Ee,$EL,$E_,$Ec];this._saveToCmd($En._context._drawCurves,$Eq)},$EM.drawRect=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){void 0===$EH&&($EH=1);var $ET=$Eq?$EH/2:0,$Ex=$Eq?$EH:0,$EO=[$EM+$ET,$Ee+$ET,$EL-$Ex,$E_-$Ex,$Ec,$Eq,$EH];this._saveToCmd($En._context._drawRect,$EO)},$EM.drawCircle=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Eq&&($Eq=1);var $EH=$Ec?$Eq/2:0,$ET=0;$En.isWebGL&&($ET=$ED.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($ET));var $Ex=[$EM,$Ee,$EL-$EH,$E_,$Ec,$Eq,$ET];this._saveToCmd($En._context._drawCircle,$Ex)},$EM.drawPie=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){void 0===$ET&&($ET=1);var $Ex=$EH?$ET/2:0,$EO=$EH?$ET:0,$Eu=0;$En.isWebGL&&($Eu=$ED.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($Eu));var $EG=[$EM+$Ex,$Ee+$Ex,$EL-$EO,$E_,$Ec,$Eq,$EH,$ET,$Eu];$EG[3]=$Es.toRadian($E_),$EG[4]=$Es.toRadian($Ec),this._saveToCmd($En._context._drawPie,$EG)},$EM.drawPoly=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Eq&&($Eq=1);var $EH=0,$ET=!1;$En.isWebGL&&($EH=$ED.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($EH),$ET=!(6<$EL.length));var $Ex=$Ec?$Eq%2==0?0:.5:0,$EO=[$EM+$Ex,$Ee+$Ex,$EL,$E_,$Ec,$Eq,$EH,$ET];this._saveToCmd($En._context._drawPoly,$EO)},$EM.drawPath=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=[$EM,$Ee,$EL,$E_,$Ec];this._saveToCmd($En._context._drawPath,$Eq)},$Ed(0,$EM,"cmds",function(){return this._cmds},function($EM){this._sp&&(this._sp._renderType|=512),this._cmds=$EM,this._render=this._renderAll,this._repaint()}),$EG.__init__=function(){if($En.isConchNode){for(var $EM=laya.display.Graphics.prototype,$Ee=$Eg.window.ConchGraphics.prototype,$EL=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$E_=0,$Ec=$EL.length;$E_<=$Ec;$E_++){var $Eq=$EL[$E_];$EM[$Eq]=$Ee[$Eq]}$EM._saveToCmd=null,$Ee.drawImageS&&($EM.drawTextures=function($EM,$Ee){if($EM&&$EM.loaded&&$EM.bitmap&&$EM.source){var $EL=$EM.uv,$E_=$EM.bitmap.width,$Ec=$EM.bitmap.height;this.drawImageS($EM.bitmap.source,$EL[0]*$E_,$EL[1]*$Ec,($EL[2]-$EL[0])*$E_,($EL[5]-$EL[3])*$Ec,$EM.offsetX,$EM.offsetY,$EM.width,$EM.height,$Ee)}}),$EM.drawTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){if(void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),void 0===$EH&&($EH=1),$EM)if($EM.loaded){if($EM.loaded&&$EM.bitmap&&$EM.source&&($E_||($E_=$EM.sourceWidth),$Ec||($Ec=$EM.sourceHeight),$EH=$EH<0?0:1<$EH?1:$EH,$E_=$E_-$EM.sourceWidth+$EM.width,$Ec=$Ec-$EM.sourceHeight+$EM.height,!($E_<=0||$Ec<=0))){$Ee+=$EM.offsetX,$EL+=$EM.offsetY;var $ET=$EM.uv,$Ex=$EM.bitmap.width,$EO=$EM.bitmap.height;$ET[4]<$ET[0]&&$ET[5]<$ET[1]?this.drawImageM($EM.bitmap.source,$ET[4]*$Ex,$ET[5]*$EO,($ET[0]-$ET[4])*$Ex,($ET[1]-$ET[5])*$EO,$Ee,$EL,$E_,$Ec,$Eq,$EH):this.drawImageM($EM.bitmap.source,$ET[0]*$Ex,$ET[1]*$EO,($ET[2]-$ET[0])*$Ex,($ET[5]-$ET[3])*$EO,$Ee,$EL,$E_,$Ec,$Eq,$EH),this._repaint()}}else $EM.once("loaded",this,function(){this.drawTexture($EM,$Ee,$EL,$E_,$Ec,$Eq)})},$EM.fillTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){if(void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq="repeat"),$EM&&$EM.loaded){var $ET,$Ex=$En._context.ctx,$EO=$EM.bitmap.width,$Eu=$EM.bitmap.height,$EG=$EM.uv;$ET=$EM.uv!=$EuM.DEF_UV?$Ex.createPattern($EM.bitmap.source,$Eq,$EG[0]*$EO,$EG[1]*$Eu,($EG[2]-$EG[0])*$EO,($EG[5]-$EG[3])*$Eu):$Ex.createPattern($EM.bitmap.source,$Eq);var $EV=0,$EE=0;$EH&&($Ee+=$EH.x%$EM.width,$EL+=$EH.y%$EM.height,$EV-=$EH.x%$EM.width,$EE-=$EH.y%$EM.height),this._fillImage($ET,$Ee,$EL,$EV,$EE,$E_,$Ec)}}}},$EG._cache=[],$EG}(),$EL=function(){function $EX(){this._cacheBoundsType=!1}$Eu($EX,"laya.display.GraphicsBounds");var $EM=$EX.prototype;return $EM.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$EM.reset=function(){this._temp&&(this._temp.length=0)},$EM.getBounds=function($EM){return void 0===$EM&&($EM=!1),(!this._bounds||!this._temp||this._temp.length<1||$EM!=this._cacheBoundsType)&&(this._bounds=$EB._getWrapRec(this.getBoundPoints($EM),this._bounds)),this._cacheBoundsType=$EM,this._bounds},$EM.getBoundPoints=function($EM){return void 0===$EM&&($EM=!1),(!this._temp||this._temp.length<1||$EM!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($EM)),this._cacheBoundsType=$EM,this._rstBoundPoints=$Es.copyArray(this._rstBoundPoints,this._temp)},$EM._getCmdPoints=function($EM){void 0===$EM&&($EM=!1);var $Ee,$EL,$E_=$En._context,$Ec=this._graphics.cmds;if(($Ee=this._temp||(this._temp=[])).length=0,$Ec||null==this._graphics._one||($EX._tempCmds.length=0,$EX._tempCmds.push(this._graphics._one),$Ec=$EX._tempCmds),!$Ec)return $Ee;($EL=$EX._tempMatrixArrays).length=0;var $Eq=$EX._initMatrix;$Eq.identity();for(var $EH,$ET,$Ex=$EX._tempMatrix,$EO=NaN,$Eu=NaN,$EG=NaN,$EV=NaN,$EE=NaN,$Ed=NaN,$Er=0,$E$=$Ec.length;$Er<$E$;$Er++)if(($EH=$Ec[$Er]).callee)switch($EH.callee){case $E_._save:case 7:$EL.push($Eq),$Eq=$Eq.clone();break;case $E_._restore:case 8:$Eq=$EL.pop();break;case $E_._scale:case 5:$Ex.identity(),$Ex.translate(-$EH[2],-$EH[3]),$Ex.scale($EH[0],$EH[1]),$Ex.translate($EH[2],$EH[3]),this._switchMatrix($Eq,$Ex);break;case $E_._rotate:case 3:$Ex.identity(),$Ex.translate(-$EH[1],-$EH[2]),$Ex.rotate($EH[0]),$Ex.translate($EH[1],$EH[2]),this._switchMatrix($Eq,$Ex);break;case $E_._translate:case 6:$Ex.identity(),$Ex.translate($EH[0],$EH[1]),this._switchMatrix($Eq,$Ex);break;case $E_._transform:case 4:$Ex.identity(),$Ex.translate(-$EH[1],-$EH[2]),$Ex.concat($EH[0]),$Ex.translate($EH[1],$EH[2]),this._switchMatrix($Eq,$Ex);break;case 16:case 24:$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[0],$EH[1],$EH[2],$EH[3]),$Eq);break;case 17:$Eq.copyTo($Ex),$Ex.concat($EH[4]),$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[0],$EH[1],$EH[2],$EH[3]),$Ex);break;case $E_._drawTexture:$ET=$EH[0],$EM?$EH[3]&&$EH[4]?$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1],$EH[2],$EH[3],$EH[4]),$Eq):($ET=$EH[0],$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1],$EH[2],$ET.width,$ET.height),$Eq)):($EO=($EH[3]||$ET.sourceWidth)/$ET.width,$Eu=($EH[4]||$ET.sourceHeight)/$ET.height,$EG=$EO*$ET.sourceWidth,$EV=$Eu*$ET.sourceHeight,$EE=0<$ET.offsetX?$ET.offsetX:0,$Ed=0<$ET.offsetY?$ET.offsetY:0,$EE*=$EO,$Ed*=$Eu,$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1]-$EE,$EH[2]-$Ed,$EG,$EV),$Eq));break;case $E_._fillTexture:$EH[3]&&$EH[4]?$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1],$EH[2],$EH[3],$EH[4]),$Eq):($ET=$EH[0],$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1],$EH[2],$ET.width,$ET.height),$Eq));break;case $E_._drawTextureWithTransform:var $EC;$EC=$EH[5]?($Eq.copyTo($Ex),$Ex.concat($EH[5]),$Ex):$Eq,$EM?$EH[3]&&$EH[4]?$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1],$EH[2],$EH[3],$EH[4]),$EC):($ET=$EH[0],$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1],$EH[2],$ET.width,$ET.height),$EC)):($ET=$EH[0],$EO=($EH[3]||$ET.sourceWidth)/$ET.width,$Eu=($EH[4]||$ET.sourceHeight)/$ET.height,$EG=$EO*$ET.sourceWidth,$EV=$Eu*$ET.sourceHeight,$EE=0<$ET.offsetX?$ET.offsetX:0,$Ed=0<$ET.offsetY?$ET.offsetY:0,$EE*=$EO,$Ed*=$Eu,$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[1]-$EE,$EH[2]-$Ed,$EG,$EV),$EC));break;case $E_._drawRect:case 13:$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[0],$EH[1],$EH[2],$EH[3]),$Eq);break;case $E_._drawCircle:case $E_._fillCircle:case 14:$EX._addPointArrToRst($Ee,$EB._getBoundPointS($EH[0]-$EH[2],$EH[1]-$EH[2],$EH[2]+$EH[2],$EH[2]+$EH[2]),$Eq);break;case $E_._drawLine:case 20:$EX._tempPoints.length=0;var $EK;$EK=.5*$EH[5],$EH[0]==$EH[2]?$EX._tempPoints.push($EH[0]+$EK,$EH[1],$EH[2]+$EK,$EH[3],$EH[0]-$EK,$EH[1],$EH[2]-$EK,$EH[3]):$EH[1]==$EH[3]?$EX._tempPoints.push($EH[0],$EH[1]+$EK,$EH[2],$EH[3]+$EK,$EH[0],$EH[1]-$EK,$EH[2],$EH[3]-$EK):$EX._tempPoints.push($EH[0],$EH[1],$EH[2],$EH[3]),$EX._addPointArrToRst($Ee,$EX._tempPoints,$Eq);break;case $E_._drawCurves:case 22:$EX._addPointArrToRst($Ee,$Eo.I.getBezierPoints($EH[2]),$Eq,$EH[0],$EH[1]);break;case $E_._drawPoly:case $E_._drawLines:case 18:$EX._addPointArrToRst($Ee,$EH[2],$Eq,$EH[0],$EH[1]);break;case $E_._drawPath:case 19:$EX._addPointArrToRst($Ee,this._getPathPoints($EH[2]),$Eq,$EH[0],$EH[1]);break;case $E_._drawPie:case 15:$EX._addPointArrToRst($Ee,this._getPiePoints($EH[0],$EH[1],$EH[2],$EH[3],$EH[4]),$Eq)}return 200<$Ee.length?$Ee=$Es.copyArray($Ee,$EB._getWrapRec($Ee)._getBoundPoints()):8<$Ee.length&&($Ee=$Ei.scanPList($Ee)),$Ee},$EM._switchMatrix=function($EM,$Ee){$Ee.concat($EM),$Ee.copyTo($EM)},$EM._getPiePoints=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EX._tempPoints;$EX._tempPoints.length=0,$Eq.push($EM,$Ee);var $EH=($Ec-$E_)%(2*Math.PI)/10,$ET=NaN,$Ex=$E_;for($ET=0;$ET<=10;$ET++)$Eq.push($EM+$EL*Math.cos($Ex),$Ee+$EL*Math.sin($Ex)),$Ex+=$EH;return $Eq},$EM._getPathPoints=function($EM){var $Ee,$EL,$E_=0,$Ec=$EX._tempPoints;for($Ec.length=0,$Ee=$EM.length,$E_=0;$E_<$Ee;$E_++)1<($EL=$EM[$E_]).length&&($Ec.push($EL[1],$EL[2]),3<$EL.length&&$Ec.push($EL[3],$EL[4]));return $Ec},$EX._addPointArrToRst=function($EM,$Ee,$EL,$E_,$Ec){void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0);var $Eq,$EH=0;for($Eq=$Ee.length,$EH=0;$EH<$Eq;$EH+=2)$EX._addPointToRst($EM,$Ee[$EH]+$E_,$Ee[$EH+1]+$Ec,$EL)},$EX._addPointToRst=function($EM,$Ee,$EL,$E_){var $Ec=$EA.TEMP;$Ec.setTo($Ee||0,$EL||0),$E_.transformPoint($Ec),$EM.push($Ec.x,$Ec.y)},$EX._tempPoints=[],$EX._tempMatrixArrays=[],$EX._tempCmds=[],$Ex($EX,["_tempMatrix",function(){return this._tempMatrix=new $Ep},"_initMatrix",function(){return this._initMatrix=new $Ep}]),$EX}(),$Eq=function(){function $EM(){}$Eu($EM,"laya.events.Event");var $Ee=$EM.prototype;return $Ee.setTo=function($EM,$Ee,$EL){return this.type=$EM,this.currentTarget=$Ee,this.target=$EL,this},$Ee.stopPropagation=function(){this._stoped=!0},$Ed(0,$Ee,"stageY",function(){return $Ey.stage.mouseY}),$Ed(0,$Ee,"charCode",function(){return this.nativeEvent.charCode}),$Ed(0,$Ee,"touches",function(){var $EM=this.nativeEvent.touches;if($EM)for(var $Ee=$Ey.stage,$EL=0,$E_=$EM.length;$EL<$E_;$EL++){var $Ec=$EM[$EL],$Eq=$EA.TEMP;$Eq.setTo($Ec.clientX,$Ec.clientY),$Ee._canvasTransform.invertTransformPoint($Eq),$Ee.transform.invertTransformPoint($Eq),$Ec.stageX=$Eq.x,$Ec.stageY=$Eq.y}return $EM}),$Ed(0,$Ee,"keyLocation",function(){return this.nativeEvent.keyLocation}),$Ed(0,$Ee,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$Ed(0,$Ee,"altKey",function(){return this.nativeEvent.altKey}),$Ed(0,$Ee,"shiftKey",function(){return this.nativeEvent.shiftKey}),$Ed(0,$Ee,"stageX",function(){return $Ey.stage.mouseX}),$EM.EMPTY=new $EM,$EM.MOUSE_DOWN="mousedown",$EM.MOUSE_UP="mouseup",$EM.CLICK="click",$EM.RIGHT_MOUSE_DOWN="rightmousedown",$EM.RIGHT_MOUSE_UP="rightmouseup",$EM.RIGHT_CLICK="rightclick",$EM.MOUSE_MOVE="mousemove",$EM.MOUSE_OVER="mouseover",$EM.MOUSE_OUT="mouseout",$EM.MOUSE_WHEEL="mousewheel",$EM.ROLL_OVER="mouseover",$EM.ROLL_OUT="mouseout",$EM.DOUBLE_CLICK="doubleclick",$EM.CHANGE="change",$EM.CHANGED="changed",$EM.RESIZE="resize",$EM.ADDED="added",$EM.REMOVED="removed",$EM.DISPLAY="display",$EM.UNDISPLAY="undisplay",$EM.ERROR="error",$EM.COMPLETE="complete",$EM.LOADED="loaded",$EM.INITED="inited",$EM.PROGRESS="progress",$EM.INPUT="input",$EM.RENDER="render",$EM.OPEN="open",$EM.MESSAGE="message",$EM.CLOSE="close",$EM.KEY_DOWN="keydown",$EM.KEY_PRESS="keypress",$EM.KEY_UP="keyup",$EM.FRAME="enterframe",$EM.DRAG_START="dragstart",$EM.DRAG_MOVE="dragmove",$EM.DRAG_END="dragend",$EM.ENTER="enter",$EM.SELECT="select",$EM.BLUR="blur",$EM.FOCUS="focus",$EM.VISIBILITY_CHANGE="visibilitychange",$EM.FOCUS_CHANGE="focuschange",$EM.PLAYED="played",$EM.PAUSED="paused",$EM.STOPPED="stopped",$EM.START="start",$EM.END="end",$EM.ENABLE_CHANGED="enablechanged",$EM.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$EM.COMPONENT_ADDED="componentadded",$EM.COMPONENT_REMOVED="componentremoved",$EM.LAYER_CHANGED="layerchanged",$EM.HIERARCHY_LOADED="hierarchyloaded",$EM.RECOVERED="recovered",$EM.RELEASED="released",$EM.LINK="link",$EM.LABEL="label",$EM.FULL_SCREEN_CHANGE="fullscreenchange",$EM.DEVICE_LOST="devicelost",$EM.MESH_CHANGED="meshchanged",$EM.MATERIAL_CHANGED="materialchanged",$EM.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$EM.ANIMATION_CHANGED="animationchanged",$EM.TRIGGER_ENTER="triggerenter",$EM.TRIGGER_STAY="triggerstay",$EM.TRIGGER_EXIT="triggerexit",$EM.TRAIL_FILTER_CHANGE="trailfilterchange",$EM.DOMINO_FILTER_CHANGE="dominofilterchange",$EM}(),$EG=(function(){function $EM(){}$Eu($EM,"laya.events.Keyboard"),$EM.NUMBER_0=48,$EM.NUMBER_1=49,$EM.NUMBER_2=50,$EM.NUMBER_3=51,$EM.NUMBER_4=52,$EM.NUMBER_5=53,$EM.NUMBER_6=54,$EM.NUMBER_7=55,$EM.NUMBER_8=56,$EM.NUMBER_9=57,$EM.A=65,$EM.B=66,$EM.C=67,$EM.D=68,$EM.E=69,$EM.F=70,$EM.G=71,$EM.H=72,$EM.I=73,$EM.J=74,$EM.K=75,$EM.L=76,$EM.M=77,$EM.N=78,$EM.O=79,$EM.P=80,$EM.Q=81,$EM.R=82,$EM.S=83,$EM.T=84,$EM.U=85,$EM.V=86,$EM.W=87,$EM.X=88,$EM.Y=89,$EM.Z=90,$EM.F1=112,$EM.F2=113,$EM.F3=114,$EM.F4=115,$EM.F5=116,$EM.F6=117,$EM.F7=118,$EM.F8=119,$EM.F9=120,$EM.F10=121,$EM.F11=122,$EM.F12=123,$EM.F13=124,$EM.F14=125,$EM.F15=126,$EM.NUMPAD=21,$EM.NUMPAD_0=96,$EM.NUMPAD_1=97,$EM.NUMPAD_2=98,$EM.NUMPAD_3=99,$EM.NUMPAD_4=100,$EM.NUMPAD_5=101,$EM.NUMPAD_6=102,$EM.NUMPAD_7=103,$EM.NUMPAD_8=104,$EM.NUMPAD_9=105,$EM.NUMPAD_ADD=107,$EM.NUMPAD_DECIMAL=110,$EM.NUMPAD_DIVIDE=111,$EM.NUMPAD_ENTER=108,$EM.NUMPAD_MULTIPLY=106,$EM.NUMPAD_SUBTRACT=109,$EM.SEMICOLON=186,$EM.EQUAL=187,$EM.COMMA=188,$EM.MINUS=189,$EM.PERIOD=190,$EM.SLASH=191,$EM.BACKQUOTE=192,$EM.LEFTBRACKET=219,$EM.BACKSLASH=220,$EM.RIGHTBRACKET=221,$EM.QUOTE=222,$EM.ALTERNATE=18,$EM.BACKSPACE=8,$EM.CAPS_LOCK=20,$EM.COMMAND=15,$EM.CONTROL=17,$EM.DELETE=46,$EM.ENTER=13,$EM.ESCAPE=27,$EM.PAGE_UP=33,$EM.PAGE_DOWN=34,$EM.END=35,$EM.HOME=36,$EM.LEFT=37,$EM.UP=38,$EM.RIGHT=39,$EM.DOWN=40,$EM.SHIFT=16,$EM.SPACE=32,$EM.TAB=9,$EM.INSERT=45}(),function(){function $Ec(){}return $Eu($Ec,"laya.events.KeyBoardManager"),$Ec.__init__=function(){$Ec._addEvent("keydown"),$Ec._addEvent("keypress"),$Ec._addEvent("keyup")},$Ec._addEvent=function($Ee){$Eg.document.addEventListener($Ee,function($EM){laya.events.KeyBoardManager._dispatch($EM,$Ee)},!0)},$Ec._dispatch=function($EM,$Ee){if($Ec.enabled){$Ec._event._stoped=!1,$Ec._event.nativeEvent=$EM,$Ec._event.keyCode=$EM.keyCode||$EM.which||$EM.charCode,"keydown"===$Ee?$Ec._pressKeys[$Ec._event.keyCode]=!0:"keyup"===$Ee&&($Ec._pressKeys[$Ec._event.keyCode]=null);for(var $EL=$Ey.stage.focus&&null!=$Ey.stage.focus.event&&$Ey.stage.focus.displayedInStage?$Ey.stage.focus:$Ey.stage,$E_=$EL;$E_;)$E_.event($Ee,$Ec._event.setTo($Ee,$E_,$EL)),$E_=$E_.parent}},$Ec.hasKeyDown=function($EM){return $Ec._pressKeys[$EM]},$Ec._pressKeys={},$Ec.enabled=!0,$Ex($Ec,["_event",function(){return this._event=new $Eq}]),$Ec}()),$Er=(function(){function $EM(){}$Eu($EM,"laya.events.KeyLocation"),$EM.STANDARD=0,$EM.LEFT=1,$EM.RIGHT=2,$EM.NUM_PAD=3}(),function(){function $EO(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$Eg.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $Eq,this._matrix=new $Ep,this._point=new $EA,this._rect=new $EB,this._prePoint=new $EA,this._curTouchID=NaN}$Eu($EO,"laya.events.MouseManager");var $EM=$EO.prototype;return $EM.__init__=function($EM,$Ee){var $EL=this;this._stage=$EM;var $E_=this,$Ec=this._eventList;$Ee.oncontextmenu=function($EM){if($EO.enabled)return!1},$Ee.addEventListener("mousedown",function($EM){$EO.enabled&&($Eg.onIE||$EM.preventDefault(),$Ec.push($EM),$E_.mouseDownTime=$Eg.now())}),$Ee.addEventListener("mouseup",function($EM){$EO.enabled&&($EM.preventDefault(),$Ec.push($EM),$E_.mouseDownTime=-$Eg.now())},!0),$Ee.addEventListener("mousemove",function($EM){if($EO.enabled){$EM.preventDefault();var $Ee=$Eg.now();if($Ee-$E_._lastMoveTimer<10)return;$E_._lastMoveTimer=$Ee,$Ec.push($EM)}},!0),$Ee.addEventListener("mouseout",function($EM){$EO.enabled&&$Ec.push($EM)}),$Ee.addEventListener("mouseover",function($EM){$EO.enabled&&$Ec.push($EM)}),$Ee.addEventListener("touchstart",function($EM){$EO.enabled&&($Ec.push($EM),$EO._isFirstTouch||$EiM.isInputting||$EM.preventDefault(),$E_.mouseDownTime=$Eg.now())}),$Ee.addEventListener("touchend",function($EM){$EO.enabled?($EO._isFirstTouch||$EiM.isInputting||$EM.preventDefault(),$EO._isFirstTouch=!1,$Ec.push($EM),$E_.mouseDownTime=-$Eg.now()):$EL._curTouchID=NaN},!0),$Ee.addEventListener("touchmove",function($EM){$EO.enabled&&($EM.preventDefault(),$Ec.push($EM))},!0),$Ee.addEventListener("touchcancel",function($EM){$EO.enabled?($EM.preventDefault(),$Ec.push($EM)):$EL._curTouchID=NaN},!0),$Ee.addEventListener("mousewheel",function($EM){$EO.enabled&&$Ec.push($EM)}),$Ee.addEventListener("DOMMouseScroll",function($EM){$EO.enabled&&$Ec.push($EM)})},$EM.initEvent=function($EM,$Ee){var $EL;this._event._stoped=!1,this._event.nativeEvent=$Ee||$EM,this._target=null,this._point.setTo($EM.pageX||$EM.clientX,$EM.pageY||$EM.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$EM.identifier||0,this._tTouchID=this._event.touchId,($EL=$E$.I._event)._stoped=!1,$EL.nativeEvent=this._event.nativeEvent,$EL.touchId=this._event.touchId},$EM.checkMouseWheel=function($EM){this._event.delta=$EM.wheelDelta?.025*$EM.wheelDelta:-$EM.detail;for(var $Ee=$E$.I.getLastOvers(),$EL=0,$E_=$Ee.length;$EL<$E_;$EL++){var $Ec=$Ee[$EL];$Ec.event("mousewheel",this._event.setTo("mousewheel",$Ec,this._target))}},$EM.onMouseMove=function($EM){$E$.I.onMouseMove($EM,this._tTouchID)},$EM.onMouseDown=function($EM){if($EiM.isInputting&&$Ey.stage.focus&&$Ey.stage.focus.focus&&!$Ey.stage.focus.contains(this._target)){var $Ee=$Ey.stage.focus._tf||$Ey.stage.focus,$EL=$EM._tf||$EM;$EL instanceof laya.display.Input&&$EL.multiline==$Ee.multiline?$Ee._focusOut():$Ee.focus=!1}$E$.I.onMouseDown($EM,this._tTouchID,this._isLeftMouse)},$EM.onMouseUp=function($EM){$E$.I.onMouseUp($EM,this._tTouchID,this._isLeftMouse)},$EM.check=function($EM,$Ee,$EL,$E_){this._point.setTo($Ee,$EL),$EM.fromParentPoint(this._point),$Ee=this._point.x,$EL=this._point.y;var $Ec=$EM.scrollRect;if($Ec&&(this._rect.setTo($Ec.x,$Ec.y,$Ec.width,$Ec.height),!this._rect.contains($Ee,$EL)))return!1;if(!this.disableMouseEvent){if($EM.hitTestPrior&&!$EM.mouseThrough&&!this.hitTest($EM,$Ee,$EL))return!1;for(var $Eq=$EM._childs.length-1;-1<$Eq;$Eq--){var $EH=$EM._childs[$Eq];if(!$EH.destroyed&&$EH.mouseEnabled&&$EH.visible&&this.check($EH,$Ee,$EL,$E_))return!0}}var $ET=!(!$EM.hitTestPrior||$EM.mouseThrough||this.disableMouseEvent)||this.hitTest($EM,$Ee,$EL);return $ET?(this._target=$EM,$E_.call(this,$EM)):$E_===this.onMouseUp&&$EM===this._stage&&(this._target=this._stage,$E_.call(this,this._target)),$ET},$EM.hitTest=function($EM,$Ee,$EL){var $E_=!1;if($EM.scrollRect&&($Ee-=$EM.scrollRect.x,$EL-=$EM.scrollRect.y),$EM.hitArea instanceof laya.utils.HitArea)return $EM.hitArea.isHit($Ee,$EL);if(0<$EM.width&&0<$EM.height||$EM.mouseThrough||$EM.hitArea)if($EM.mouseThrough)$E_=$EM.getGraphicBounds().contains($Ee,$EL);else{var $Ec=this._rect;$EM.hitArea?$Ec=$EM.hitArea:$Ec.setTo(0,0,$EM.width,$EM.height),$E_=$Ec.contains($Ee,$EL)}return $E_},$EM.runEvent=function(){var $EM=this._eventList.length;if($EM){this.mouseEventTime=$Eg.now();var $Ee,$EL=0,$E_=0,$Ec=0;try{for(;$EL<$EM;){var $Eq=this._eventList[$EL];switch("mousemove"!==$Eq.type&&(this._prePoint.x=this._prePoint.y=-1e6),$Eq.type){case"mousedown":this._touchIDs[0]=this._id++,$EO._isTouchRespond?$EO._isTouchRespond=!1:(this._isLeftMouse=0===$Eq.button,this.initEvent($Eq),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===$Eq.button,this.initEvent($Eq),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$Eq.clientX)+Math.abs(this._prePoint.y-$Eq.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$Eq.clientX,this._prePoint.y=$Eq.clientY,this.initEvent($Eq),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":$EO._isTouchRespond=!0,this._isLeftMouse=!0;var $EH=$Eq.changedTouches;for($E_=0,$Ec=$EH.length;$E_<$Ec;$E_++)$Ee=$EH[$E_],($EO.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$Ee.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$Ee.identifier]=this._id++,this.initEvent($Ee,$Eq),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":$EO._isTouchRespond=!0,this._isLeftMouse=!0;var $ET=$Eq.changedTouches;for($E_=0,$Ec=$ET.length;$E_<$Ec;$E_++)if($Ee=$ET[$E_],$EO.multiTouchEnabled||$Ee.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent($Ee,$Eq);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var $Ex=$Eq.changedTouches;for($E_=0,$Ec=$Ex.length;$E_<$Ec;$E_++)$Ee=$Ex[$E_],($EO.multiTouchEnabled||$Ee.identifier==this._curTouchID)&&(this.initEvent($Ee,$Eq),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel($Eq);break;case"mouseout":$E$.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}$EL++}}catch($EM){throw this._eventList.length=0,$EM}this._eventList.length=0}},$EO.enabled=!0,$EO.multiTouchEnabled=!0,$EO._isTouchRespond=!1,$EO._isFirstTouch=!0,$Ex($EO,["instance",function(){return this.instance=new $EO}]),$EO}()),$E$=function(){function $Ed(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $Eq}$Eu($Ed,"laya.events.TouchManager");var $EM=$Ed.prototype;return $EM._clearTempArrs=function(){$Ed._oldArr.length=0,$Ed._newArr.length=0,$Ed._tEleArr.length=0},$EM.getTouchFromArr=function($EM,$Ee){var $EL,$E_,$Ec=0;for($EL=$Ee.length,$Ec=0;$Ec<$EL;$Ec++)if(($E_=$Ee[$Ec]).id==$EM)return $E_;return null},$EM.removeTouchFromArr=function($EM,$Ee){var $EL=0;for($EL=$Ee.length-1;0<=$EL;$EL--)$Ee[$EL].id==$EM&&$Ee.splice($EL,1)},$EM.createTouchO=function($EM,$Ee){var $EL;return($EL=$EP.getItem("TouchData")||{}).id=$Ee,$EL.tar=$EM,$EL},$EM.onMouseDown=function($EM,$Ee,$EL){var $E_,$Ec,$Eq,$EH;(void 0===$EL&&($EL=!1),this.enable)&&($E_=this.getTouchFromArr($Ee,this.preOvers),$Eq=this.getEles($EM,null,$Ed._tEleArr),$E_?$E_.tar=$EM:($Ec=this.createTouchO($EM,$Ee),this.preOvers.push($Ec)),$Eg.onMobile&&this.sendEvents($Eq,"mouseover",$Ee),$EH=$EL?this.preDowns:this.preRightDowns,($E_=this.getTouchFromArr($Ee,$EH))?$E_.tar=$EM:($Ec=this.createTouchO($EM,$Ee),$EH.push($Ec)),this.sendEvents($Eq,$EL?"mousedown":"rightmousedown",$Ee),this._clearTempArrs())},$EM.sendEvents=function($EM,$Ee,$EL){void 0===$EL&&($EL=0);var $E_,$Ec,$Eq,$EH=0;for($E_=$EM.length,this._event._stoped=!1,$Ec=$EM[0],$EH=0;$EH<$E_;$EH++){if(($Eq=$EM[$EH]).destroyed)return;if($Eq.event($Ee,this._event.setTo($Ee,$Eq,$Ec)),this._event._stoped)break}},$EM.getEles=function($EM,$Ee,$EL){for($EL?$EL.length=0:$EL=[];$EM&&$EM!=$Ee;)$EL.push($EM),$EM=$EM.parent;return $EL},$EM.checkMouseOutAndOverOfMove=function($EM,$Ee,$EL){if(void 0===$EL&&($EL=0),$Ee!=$EM){var $E_,$Ec,$Eq=0,$EH=0;if($Ee.contains($EM))$Ec=this.getEles($EM,$Ee,$Ed._tEleArr),this.sendEvents($Ec,"mouseover",$EL);else if($EM.contains($Ee))$Ec=this.getEles($Ee,$EM,$Ed._tEleArr),this.sendEvents($Ec,"mouseout",$EL);else{var $ET,$Ex;($Ec=$Ed._tEleArr).length=0,$ET=this.getEles($Ee,null,$Ed._oldArr),$Ex=this.getEles($EM,null,$Ed._newArr),$EH=$ET.length;var $EO=0;for($Eq=0;$Eq<$EH;$Eq++){if($E_=$ET[$Eq],0<=($EO=$Ex.indexOf($E_))){$Ex.splice($EO,$Ex.length-$EO);break}$Ec.push($E_)}0<$Ec.length&&this.sendEvents($Ec,"mouseout",$EL),0<$Ex.length&&this.sendEvents($Ex,"mouseover",$EL)}}},$EM.onMouseMove=function($EM,$Ee){var $EL,$E_;this.enable&&(($EL=this.getTouchFromArr($Ee,this.preOvers))?(this.checkMouseOutAndOverOfMove($EM,$EL.tar),$EL.tar=$EM,$E_=this.getEles($EM,null,$Ed._tEleArr)):($E_=this.getEles($EM,null,$Ed._tEleArr),this.sendEvents($E_,"mouseover",$Ee),this.preOvers.push(this.createTouchO($EM,$Ee))),this.sendEvents($E_,"mousemove",$Ee),this._clearTempArrs())},$EM.getLastOvers=function(){return($Ed._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$Ed._tEleArr):($Ed._tEleArr.push($Ey.stage),$Ed._tEleArr)},$EM.stageMouseOut=function(){var $EM;$EM=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($EM,"mouseout",0)},$EM.onMouseUp=function($EM,$Ee,$EL){if(void 0===$EL&&($EL=!1),this.enable){var $E_,$Ec,$Eq,$EH,$ET,$Ex,$EO=0,$Eu=0,$EG=$Eg.onMobile;if($Ec=this.getEles($EM,null,$Ed._tEleArr),this.sendEvents($Ec,$EL?"mouseup":"rightmouseup",$Ee),$Ex=$EL?this.preDowns:this.preRightDowns,$E_=this.getTouchFromArr($Ee,$Ex)){var $EV,$EE=$Eg.now();if($EV=$EE-this._lastClickTime<300,this._lastClickTime=$EE,$EM==$E_.tar)$ET=$Ec;else for($Eq=this.getEles($E_.tar,null,$Ed._oldArr),($ET=$Ed._newArr).length=0,$Eu=$Eq.length,$EO=0;$EO<$Eu;$EO++)$EH=$Eq[$EO],0<=$Ec.indexOf($EH)&&$ET.push($EH);0<$ET.length&&this.sendEvents($ET,$EL?"click":"rightclick",$Ee),$EL&&$EV&&this.sendEvents($ET,"doubleclick",$Ee),this.removeTouchFromArr($Ee,$Ex),$E_.tar=null,$EP.recover("TouchData",$E_)}else;($E_=this.getTouchFromArr($Ee,this.preOvers))&&$EG&&(($ET=this.getEles($E_.tar,null,$ET))&&0<$ET.length&&this.sendEvents($ET,"mouseout",$Ee),this.removeTouchFromArr($Ee,this.preOvers),$E_.tar=null,$EP.recover("TouchData",$E_)),this._clearTempArrs()}},$Ed._oldArr=[],$Ed._newArr=[],$Ed._tEleArr=[],$Ex($Ed,["I",function(){return this.I=new $Ed}]),$Ed}(),$EC=function(){function $EM(){this._action=null}$Eu($EM,"laya.filters.Filter");var $Ee=$EM.prototype;return $Ey.imps($Ee,{"laya.filters.IFilter":!0}),$Ee.callNative=function($EM){},$Ed(0,$Ee,"type",function(){return-1}),$Ed(0,$Ee,"action",function(){return this._action}),$EM.BLUR=16,$EM.COLOR=32,$EM.GLOW=8,$EM._filterStart=null,$EM._filterEnd=null,$EM._EndTarget=null,$EM._recycleScope=null,$EM._filter=null,$EM._useSrc=null,$EM._endSrc=null,$EM._useOut=null,$EM._endOut=null,$EM}(),$EX=function(){function $EM(){this.data=null}$Eu($EM,"laya.filters.ColorFilterAction");var $Ee=$EM.prototype;return $Ey.imps($Ee,{"laya.filters.IFilterAction":!0}),$Ee.apply=function($EM){var $Ee=$EM.ctx.ctx,$EL=$EM.ctx.ctx.canvas;if(0==$EL.width||0==$EL.height)return $EL;for(var $E_,$Ec=$Ee.getImageData(0,0,$EL.width,$EL.height),$Eq=$Ec.data,$EH=0,$ET=$Eq.length;$EH<$ET;$EH+=4)$E_=this.getColor($Eq[$EH],$Eq[$EH+1],$Eq[$EH+2],$Eq[$EH+3]),0!=$Eq[$EH+3]&&($Eq[$EH]=$E_[0],$Eq[$EH+1]=$E_[1],$Eq[$EH+2]=$E_[2],$Eq[$EH+3]=$E_[3]);return $Ee.putImageData($Ec,0,0),$EM},$Ee.getColor=function($EM,$Ee,$EL,$E_){var $Ec=[];if(this.data._mat&&this.data._alpha){var $Eq=this.data._mat,$EH=this.data._alpha;$Ec[0]=$Eq[0]*$EM+$Eq[1]*$Ee+$Eq[2]*$EL+$Eq[3]*$E_+$EH[0],$Ec[1]=$Eq[4]*$EM+$Eq[5]*$Ee+$Eq[6]*$EL+$Eq[7]*$E_+$EH[1],$Ec[2]=$Eq[8]*$EM+$Eq[9]*$Ee+$Eq[10]*$EL+$Eq[11]*$E_+$EH[2],$Ec[3]=$Eq[12]*$EM+$Eq[13]*$Ee+$Eq[14]*$EL+$Eq[15]*$E_+$EH[3]}return $Ec},$EM}(),$Eo=(function(){function $EM(){}$Eu($EM,"laya.maths.Arith"),$EM.formatR=function($EM){return $EM>Math.PI&&($EM-=2*Math.PI),$EM<-Math.PI&&($EM+=2*Math.PI),$EM},$EM.isPOT=function($EM,$Ee){return 0<$EM&&0==($EM&$EM-1)&&0<$Ee&&0==($Ee&$Ee-1)},$EM.setMatToArray=function($EM,$Ee){$EM.a,$EM.b,$EM.c,$EM.d,$EM.tx,$EM.ty,$Ee[0]=$EM.a,$Ee[1]=$EM.b,$Ee[4]=$EM.c,$Ee[5]=$EM.d,$Ee[12]=$EM.tx,$Ee[13]=$EM.ty}}(),function(){function $EM(){this._controlPoints=[new $EA,new $EA,new $EA],this._calFun=this.getPoint2}$Eu($EM,"laya.maths.Bezier");var $Ee=$EM.prototype;return $Ee._switchPoint=function($EM,$Ee){var $EL=this._controlPoints.shift();$EL.setTo($EM,$Ee),this._controlPoints.push($EL)},$Ee.getPoint2=function($EM,$Ee){var $EL=this._controlPoints[0],$E_=this._controlPoints[1],$Ec=this._controlPoints[2],$Eq=Math.pow(1-$EM,2)*$EL.x+2*$EM*(1-$EM)*$E_.x+Math.pow($EM,2)*$Ec.x,$EH=Math.pow(1-$EM,2)*$EL.y+2*$EM*(1-$EM)*$E_.y+Math.pow($EM,2)*$Ec.y;$Ee.push($Eq,$EH)},$Ee.getPoint3=function($EM,$Ee){var $EL=this._controlPoints[0],$E_=this._controlPoints[1],$Ec=this._controlPoints[2],$Eq=this._controlPoints[3],$EH=Math.pow(1-$EM,3)*$EL.x+3*$E_.x*$EM*(1-$EM)*(1-$EM)+3*$Ec.x*$EM*$EM*(1-$EM)+$Eq.x*Math.pow($EM,3),$ET=Math.pow(1-$EM,3)*$EL.y+3*$E_.y*$EM*(1-$EM)*(1-$EM)+3*$Ec.y*$EM*$EM*(1-$EM)+$Eq.y*Math.pow($EM,3);$Ee.push($EH,$ET)},$Ee.insertPoints=function($EM,$Ee){var $EL,$E_=NaN;for($EL=1/($EM=0<$EM?$EM:5),$E_=0;$E_<=1;$E_+=$EL)this._calFun($E_,$Ee)},$Ee.getBezierPoints=function($EM,$Ee,$EL){void 0===$Ee&&($Ee=5),void 0===$EL&&($EL=2);var $E_,$Ec,$Eq=0;if(($E_=$EM.length)<2*($EL+1))return[];switch($Ec=[],$EL){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$EL;)this._controlPoints.push(new $EA);for($Eq=0;$Eq<2*$EL;$Eq+=2)this._switchPoint($EM[$Eq],$EM[$Eq+1]);for($Eq=2*$EL;$Eq<$E_;$Eq+=2)this._switchPoint($EM[$Eq],$EM[$Eq+1]),$Eq/2%$EL==0&&this.insertPoints($Ee,$Ec);return $Ec},$Ex($EM,["I",function(){return this.I=new $EM}]),$EM}()),$Ei=function(){function $EO(){}return $Eu($EO,"laya.maths.GrahamScan"),$EO.multiply=function($EM,$Ee,$EL){return($EM.x-$EL.x)*($Ee.y-$EL.y)-($Ee.x-$EL.x)*($EM.y-$EL.y)},$EO.dis=function($EM,$Ee){return($EM.x-$Ee.x)*($EM.x-$Ee.x)+($EM.y-$Ee.y)*($EM.y-$Ee.y)},$EO._getPoints=function($EM,$Ee,$EL){for(void 0===$Ee&&($Ee=!1),$EO._mPointList||($EO._mPointList=[]);$EO._mPointList.length<$EM;)$EO._mPointList.push(new $EA);return $EL||($EL=[]),$EL.length=0,$Ee?$EO.getFrom($EL,$EO._mPointList,$EM):$EO.getFromR($EL,$EO._mPointList,$EM),$EL},$EO.getFrom=function($EM,$Ee,$EL){var $E_=0;for($E_=0;$E_<$EL;$E_++)$EM.push($Ee[$E_]);return $EM},$EO.getFromR=function($EM,$Ee,$EL){var $E_=0;for($E_=0;$E_<$EL;$E_++)$EM.push($Ee.pop());return $EM},$EO.pListToPointList=function($EM,$Ee){void 0===$Ee&&($Ee=!1);var $EL=0,$E_=$EM.length/2,$Ec=$EO._getPoints($E_,$Ee,$EO._tempPointList);for($EL=0;$EL<$E_;$EL++)$Ec[$EL].setTo($EM[$EL+$EL],$EM[$EL+$EL+1]);return $Ec},$EO.pointListToPlist=function($EM){var $Ee,$EL=0,$E_=$EM.length,$Ec=$EO._temPList;for($EL=$Ec.length=0;$EL<$E_;$EL++)$Ee=$EM[$EL],$Ec.push($Ee.x,$Ee.y);return $Ec},$EO.scanPList=function($EM){return $Es.copyArray($EM,$EO.pointListToPlist($EO.scan($EO.pListToPointList($EM,!0))))},$EO.scan=function($EM){var $Ee,$EL,$E_,$Ec=0,$Eq=0,$EH=0,$ET=$EM.length,$Ex={};for(($EL=$EO._temArr).length=0,$Ec=($ET=$EM.length)-1;0<=$Ec;$Ec--)$E_=($Ee=$EM[$Ec]).x+"_"+$Ee.y,$Ex.hasOwnProperty($E_)||($Ex[$E_]=!0,$EL.push($Ee));for($ET=$EL.length,$Es.copyArray($EM,$EL),$Ec=1;$Ec<$ET;$Ec++)($EM[$Ec].y<$EM[$EH].y||$EM[$Ec].y==$EM[$EH].y&&$EM[$Ec].x<$EM[$EH].x)&&($EH=$Ec);for($Ee=$EM[0],$EM[0]=$EM[$EH],$EM[$EH]=$Ee,$Ec=1;$Ec<$ET-1;$Ec++){for($Eq=($EH=$Ec)+1;$Eq<$ET;$Eq++)(0<$EO.multiply($EM[$Eq],$EM[$EH],$EM[0])||0==$EO.multiply($EM[$Eq],$EM[$EH],$EM[0])&&$EO.dis($EM[0],$EM[$Eq])<$EO.dis($EM[0],$EM[$EH]))&&($EH=$Eq);$Ee=$EM[$Ec],$EM[$Ec]=$EM[$EH],$EM[$EH]=$Ee}if(($EL=$EO._temArr).length=0,$EM.length<3)return $Es.copyArray($EL,$EM);for($EL.push($EM[0],$EM[1],$EM[2]),$Ec=3;$Ec<$ET;$Ec++){for(;2<=$EL.length&&0<=$EO.multiply($EM[$Ec],$EL[$EL.length-1],$EL[$EL.length-2]);)$EL.pop();$EM[$Ec]&&$EL.push($EM[$Ec])}return $EL},$EO._mPointList=null,$EO._tempPointList=[],$EO._temPList=[],$EO._temArr=[],$EO}(),$EW=function(){function $Ec(){}return $Eu($Ec,"laya.maths.MathUtil"),$Ec.subtractVector3=function($EM,$Ee,$EL){$EL[0]=$EM[0]-$Ee[0],$EL[1]=$EM[1]-$Ee[1],$EL[2]=$EM[2]-$Ee[2]},$Ec.lerp=function($EM,$Ee,$EL){return $EM*(1-$EL)+$Ee*$EL},$Ec.scaleVector3=function($EM,$Ee,$EL){$EL[0]=$EM[0]*$Ee,$EL[1]=$EM[1]*$Ee,$EL[2]=$EM[2]*$Ee},$Ec.lerpVector3=function($EM,$Ee,$EL,$E_){var $Ec=$EM[0],$Eq=$EM[1],$EH=$EM[2];$E_[0]=$Ec+$EL*($Ee[0]-$Ec),$E_[1]=$Eq+$EL*($Ee[1]-$Eq),$E_[2]=$EH+$EL*($Ee[2]-$EH)},$Ec.lerpVector4=function($EM,$Ee,$EL,$E_){var $Ec=$EM[0],$Eq=$EM[1],$EH=$EM[2],$ET=$EM[3];$E_[0]=$Ec+$EL*($Ee[0]-$Ec),$E_[1]=$Eq+$EL*($Ee[1]-$Eq),$E_[2]=$EH+$EL*($Ee[2]-$EH),$E_[3]=$ET+$EL*($Ee[3]-$ET)},$Ec.slerpQuaternionArray=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){var $ET,$Ex,$EO,$Eu,$EG,$EV=$EM[$Ee+0],$EE=$EM[$Ee+1],$Ed=$EM[$Ee+2],$Er=$EM[$Ee+3],$E$=$EL[$E_+0],$EC=$EL[$E_+1],$EK=$EL[$E_+2],$EX=$EL[$E_+3];return($Ex=$EV*$E$+$EE*$EC+$Ed*$EK+$Er*$EX)<0&&($Ex=-$Ex,$E$=-$E$,$EC=-$EC,$EK=-$EK,$EX=-$EX),$EG=1e-6<1-$Ex?($ET=Math.acos($Ex),$EO=Math.sin($ET),$Eu=Math.sin((1-$Ec)*$ET)/$EO,Math.sin($Ec*$ET)/$EO):($Eu=1-$Ec,$Ec),$Eq[$EH+0]=$Eu*$EV+$EG*$E$,$Eq[$EH+1]=$Eu*$EE+$EG*$EC,$Eq[$EH+2]=$Eu*$Ed+$EG*$EK,$Eq[$EH+3]=$Eu*$Er+$EG*$EX,$Eq},$Ec.getRotation=function($EM,$Ee,$EL,$E_){return Math.atan2($E_-$Ee,$EL-$EM)/Math.PI*180},$Ec.sortBigFirst=function($EM,$Ee){return $EM==$Ee?0:$EM<$Ee?1:-1},$Ec.sortSmallFirst=function($EM,$Ee){return $EM==$Ee?0:$EM<$Ee?-1:1},$Ec.sortNumBigFirst=function($EM,$Ee){return parseFloat($Ee)-parseFloat($EM)},$Ec.sortNumSmallFirst=function($EM,$Ee){return parseFloat($EM)-parseFloat($Ee)},$Ec.sortByKey=function($EL,$EM,$Ee){var $E_;return void 0===$EM&&($EM=!1),void 0===$Ee&&($Ee=!0),$E_=$EM?$Ee?$Ec.sortNumBigFirst:$Ec.sortBigFirst:$Ee?$Ec.sortNumSmallFirst:$Ec.sortSmallFirst,function($EM,$Ee){return $E_($EM[$EL],$Ee[$EL])}},$Ec}(),$Ep=function(){function $EL($EM,$Ee,$EL,$E_,$Ec,$Eq){this.inPool=!1,this.bTransform=!1,void 0===$EM&&($EM=1),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=1),void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=0),this.a=$EM,this.b=$Ee,this.c=$EL,this.d=$E_,this.tx=$Ec,this.ty=$Eq,this._checkTransform()}$Eu($EL,"laya.maths.Matrix");var $EM=$EL.prototype;return $EM.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$EM._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$EM.setTranslate=function($EM,$Ee){return this.tx=$EM,this.ty=$Ee,this},$EM.translate=function($EM,$Ee){return this.tx+=$EM,this.ty+=$Ee,this},$EM.scale=function($EM,$Ee){this.a*=$EM,this.d*=$Ee,this.c*=$EM,this.b*=$Ee,this.tx*=$EM,this.ty*=$Ee,this.bTransform=!0},$EM.rotate=function($EM){var $Ee=Math.cos($EM),$EL=Math.sin($EM),$E_=this.a,$Ec=this.c,$Eq=this.tx;this.a=$E_*$Ee-this.b*$EL,this.b=$E_*$EL+this.b*$Ee,this.c=$Ec*$Ee-this.d*$EL,this.d=$Ec*$EL+this.d*$Ee,this.tx=$Eq*$Ee-this.ty*$EL,this.ty=$Eq*$EL+this.ty*$Ee,this.bTransform=!0},$EM.skew=function($EM,$Ee){var $EL=Math.tan($EM),$E_=Math.tan($Ee),$Ec=this.a,$Eq=this.b;return this.a+=$E_*this.c,this.b+=$E_*this.d,this.c+=$EL*$Ec,this.d+=$EL*$Eq,this},$EM.invertTransformPoint=function($EM){var $Ee=this.a,$EL=this.b,$E_=this.c,$Ec=this.d,$Eq=this.tx,$EH=$Ee*$Ec-$EL*$E_,$ET=$Ec/$EH,$Ex=-$EL/$EH,$EO=-$E_/$EH,$Eu=$Ee/$EH,$EG=($E_*this.ty-$Ec*$Eq)/$EH,$EV=-($Ee*this.ty-$EL*$Eq)/$EH;return $EM.setTo($ET*$EM.x+$EO*$EM.y+$EG,$Ex*$EM.x+$Eu*$EM.y+$EV)},$EM.transformPoint=function($EM){return $EM.setTo(this.a*$EM.x+this.c*$EM.y+this.tx,this.b*$EM.x+this.d*$EM.y+this.ty)},$EM.transformPointN=function($EM){return $EM.setTo(this.a*$EM.x+this.c*$EM.y,this.b*$EM.x+this.d*$EM.y)},$EM.transformPointArray=function($EM,$Ee){for(var $EL=$EM.length,$E_=0;$E_<$EL;$E_+=2){var $Ec=$EM[$E_],$Eq=$EM[$E_+1];$Ee[$E_]=this.a*$Ec+this.c*$Eq+this.tx,$Ee[$E_+1]=this.b*$Ec+this.d*$Eq+this.ty}return $Ee},$EM.transformPointArrayScale=function($EM,$Ee){for(var $EL=$EM.length,$E_=0;$E_<$EL;$E_+=2){var $Ec=$EM[$E_],$Eq=$EM[$E_+1];$Ee[$E_]=this.a*$Ec+this.c*$Eq,$Ee[$E_+1]=this.b*$Ec+this.d*$Eq}return $Ee},$EM.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$EM.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$EM.invert=function(){var $EM=this.a,$Ee=this.b,$EL=this.c,$E_=this.d,$Ec=this.tx,$Eq=$EM*$E_-$Ee*$EL;return this.a=$E_/$Eq,this.b=-$Ee/$Eq,this.c=-$EL/$Eq,this.d=$EM/$Eq,this.tx=($EL*this.ty-$E_*$Ec)/$Eq,this.ty=-($EM*this.ty-$Ee*$Ec)/$Eq,this},$EM.setTo=function($EM,$Ee,$EL,$E_,$Ec,$Eq){return this.a=$EM,this.b=$Ee,this.c=$EL,this.d=$E_,this.tx=$Ec,this.ty=$Eq,this},$EM.concat=function($EM){var $Ee=this.a,$EL=this.c,$E_=this.tx;return this.a=$Ee*$EM.a+this.b*$EM.c,this.b=$Ee*$EM.b+this.b*$EM.d,this.c=$EL*$EM.a+this.d*$EM.c,this.d=$EL*$EM.b+this.d*$EM.d,this.tx=$E_*$EM.a+this.ty*$EM.c+$EM.tx,this.ty=$E_*$EM.b+this.ty*$EM.d+$EM.ty,this},$EM.scaleEx=function($EM,$Ee){var $EL=this.a,$E_=this.b,$Ec=this.c,$Eq=this.d;0!==$E_||0!==$Ec?(this.a=$EM*$EL,this.b=$EM*$E_,this.c=$Ee*$Ec):(this.a=$EM*$EL,this.b=0*$Eq,this.c=0*$EL),this.d=$Ee*$Eq,this.bTransform=!0},$EM.rotateEx=function($EM){var $Ee=Math.cos($EM),$EL=Math.sin($EM),$E_=this.a,$Ec=this.b,$Eq=this.c,$EH=this.d;0!==$Ec||0!==$Eq?(this.a=$Ee*$E_+$EL*$Eq,this.b=$Ee*$Ec+$EL*$EH,this.c=-$EL*$E_+$Ee*$Eq,this.d=-$EL*$Ec+$Ee*$EH):(this.a=$Ee*$E_,this.b=$EL*$EH,this.c=-$EL*$E_,this.d=$Ee*$EH),this.bTransform=!0},$EM.clone=function(){var $EM=$EL.create();return $EM.a=this.a,$EM.b=this.b,$EM.c=this.c,$EM.d=this.d,$EM.tx=this.tx,$EM.ty=this.ty,$EM.bTransform=this.bTransform,$EM},$EM.copyTo=function($EM){return $EM.a=this.a,$EM.b=this.b,$EM.c=this.c,$EM.d=this.d,$EM.tx=this.tx,$EM.ty=this.ty,$EM.bTransform=this.bTransform,$EM},$EM.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$EM.destroy=function(){if(!this.inPool){var $EM=$EL._cache;this.inPool=!0,$EM._length||($EM._length=0),($EM[$EM._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$EL.mul=function($EM,$Ee,$EL){var $E_=$EM.a,$Ec=$EM.b,$Eq=$EM.c,$EH=$EM.d,$ET=$EM.tx,$Ex=$EM.ty,$EO=$Ee.a,$Eu=$Ee.b,$EG=$Ee.c,$EV=$Ee.d,$EE=$Ee.tx,$Ed=$Ee.ty;return 0!==$Eu||0!==$EG?($EL.a=$E_*$EO+$Ec*$EG,$EL.b=$E_*$Eu+$Ec*$EV,$EL.c=$Eq*$EO+$EH*$EG,$EL.d=$Eq*$Eu+$EH*$EV,$EL.tx=$EO*$ET+$EG*$Ex+$EE,$EL.ty=$Eu*$ET+$EV*$Ex+$Ed):($EL.a=$E_*$EO,$EL.b=$Ec*$EV,$EL.c=$Eq*$EO,$EL.d=$EH*$EV,$EL.tx=$EO*$ET+$EE,$EL.ty=$EV*$Ex+$Ed),$EL},$EL.mul16=function($EM,$Ee,$EL){var $E_=$EM.a,$Ec=$EM.b,$Eq=$EM.c,$EH=$EM.d,$ET=$EM.tx,$Ex=$EM.ty,$EO=$Ee.a,$Eu=$Ee.b,$EG=$Ee.c,$EV=$Ee.d,$EE=$Ee.tx,$Ed=$Ee.ty;return 0!==$Eu||0!==$EG?($EL[0]=$E_*$EO+$Ec*$EG,$EL[1]=$E_*$Eu+$Ec*$EV,$EL[4]=$Eq*$EO+$EH*$EG,$EL[5]=$Eq*$Eu+$EH*$EV,$EL[12]=$EO*$ET+$EG*$Ex+$EE,$EL[13]=$Eu*$ET+$EV*$Ex+$Ed):($EL[0]=$E_*$EO,$EL[1]=$Ec*$EV,$EL[4]=$Eq*$EO,$EL[5]=$EH*$EV,$EL[12]=$EO*$ET+$EE,$EL[13]=$EV*$Ex+$Ed),$EL},$EL.mulPre=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){var $Ex=$EM.a,$EO=$EM.b,$Eu=$EM.c,$EG=$EM.d,$EV=$EM.tx,$EE=$EM.ty;return 0!==$EL||0!==$E_?($ET.a=$Ex*$Ee+$EO*$E_,$ET.b=$Ex*$EL+$EO*$Ec,$ET.c=$Eu*$Ee+$EG*$E_,$ET.d=$Eu*$EL+$EG*$Ec,$ET.tx=$Ee*$EV+$E_*$EE+$Eq,$ET.ty=$EL*$EV+$Ec*$EE+$EH):($ET.a=$Ex*$Ee,$ET.b=$EO*$Ec,$ET.c=$Eu*$Ee,$ET.d=$EG*$Ec,$ET.tx=$Ee*$EV+$Eq,$ET.ty=$Ec*$EE+$EH),$ET},$EL.mulPos=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){var $Ex=$EM.a,$EO=$EM.b,$Eu=$EM.c,$EG=$EM.d,$EV=$EM.tx,$EE=$EM.ty;return 0!==$EO||0!==$Eu?($ET.a=$Ee*$Ex+$EL*$Eu,$ET.b=$Ee*$EO+$EL*$EG,$ET.c=$E_*$Ex+$Ec*$Eu,$ET.d=$E_*$EO+$Ec*$EG,$ET.tx=$Ex*$Eq+$Eu*$EH+$EV,$ET.ty=$EO*$Eq+$EG*$EH+$EE):($ET.a=$Ee*$Ex,$ET.b=$EL*$EG,$ET.c=$E_*$Ex,$ET.d=$Ec*$EG,$ET.tx=$Ex*$Eq+$EV,$ET.ty=$EG*$EH+$EE),$ET},$EL.preMul=function($EM,$Ee,$EL){var $E_=$EM.a,$Ec=$EM.b,$Eq=$EM.c,$EH=$EM.d,$ET=$Ee.a,$Ex=$Ee.b,$EO=$Ee.c,$Eu=$Ee.d,$EG=$Ee.tx,$EV=$Ee.ty;return $EL.a=$ET*$E_,$EL.b=$EL.c=0,$EL.d=$Eu*$EH,$EL.tx=$EG*$E_+$EM.tx,$EL.ty=$EV*$EH+$EM.ty,0===$Ex&&0===$EO&&0===$Ec&&0===$Eq||($EL.a+=$Ex*$Eq,$EL.d+=$EO*$Ec,$EL.b+=$ET*$Ec+$Ex*$EH,$EL.c+=$EO*$E_+$Eu*$Eq,$EL.tx+=$EV*$Eq,$EL.ty+=$EG*$Ec),$EL},$EL.preMulXY=function($EM,$Ee,$EL,$E_){var $Ec=$EM.a,$Eq=$EM.b,$EH=$EM.c,$ET=$EM.d;return $E_.a=$Ec,$E_.b=$Eq,$E_.c=$EH,$E_.d=$ET,$E_.tx=$Ee*$Ec+$EM.tx+$EL*$EH,$E_.ty=$EL*$ET+$EM.ty+$Ee*$Eq,$E_},$EL.create=function(){var $EM=$EL._cache,$Ee=$EM._length?$EM[--$EM._length]:new $EL;return $Ee.inPool=!1,$Ee},$EL.EMPTY=new $EL,$EL.TEMP=new $EL,$EL._cache=[],$EL}(),$EA=function(){function $EM($EM,$Ee){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),this.x=$EM,this.y=$Ee}$Eu($EM,"laya.maths.Point");var $Ee=$EM.prototype;return $Ee.setTo=function($EM,$Ee){return this.x=$EM,this.y=$Ee,this},$Ee.distance=function($EM,$Ee){return Math.sqrt((this.x-$EM)*(this.x-$EM)+(this.y-$Ee)*(this.y-$Ee))},$Ee.toString=function(){return this.x+","+this.y},$Ee.normalize=function(){var $EM=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$EM){var $Ee=1/$EM;this.x*=$Ee,this.y*=$Ee}},$EM.TEMP=new $EM,$EM.EMPTY=new $EM,$EM}(),$EB=function(){function $EO($EM,$Ee,$EL,$E_){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=0),this.x=$EM,this.y=$Ee,this.width=$EL,this.height=$E_}$Eu($EO,"laya.maths.Rectangle");var $EM=$EO.prototype;return $EM.setTo=function($EM,$Ee,$EL,$E_){return this.x=$EM,this.y=$Ee,this.width=$EL,this.height=$E_,this},$EM.copyFrom=function($EM){return this.x=$EM.x,this.y=$EM.y,this.width=$EM.width,this.height=$EM.height,this},$EM.contains=function($EM,$Ee){return!(this.width<=0||this.height<=0)&&($EM>=this.x&&$EM<this.right&&$Ee>=this.y&&$Ee<this.bottom)},$EM.intersects=function($EM){return!($EM.x>this.x+this.width||$EM.x+$EM.width<this.x||$EM.y>this.y+this.height||$EM.y+$EM.height<this.y)},$EM.intersection=function($EM,$Ee){return this.intersects($EM)?($Ee||($Ee=new $EO),$Ee.x=Math.max(this.x,$EM.x),$Ee.y=Math.max(this.y,$EM.y),$Ee.width=Math.min(this.right,$EM.right)-$Ee.x,$Ee.height=Math.min(this.bottom,$EM.bottom)-$Ee.y,$Ee):null},$EM.union=function($EM,$Ee){return $Ee||($Ee=new $EO),this.clone($Ee),$EM.width<=0||$EM.height<=0?$Ee:($Ee.addPoint($EM.x,$EM.y),$Ee.addPoint($EM.right,$EM.bottom),this)},$EM.clone=function($EM){return $EM||($EM=new $EO),$EM.x=this.x,$EM.y=this.y,$EM.width=this.width,$EM.height=this.height,$EM},$EM.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$EM.equals=function($EM){return!(!$EM||$EM.x!==this.x||$EM.y!==this.y||$EM.width!==this.width||$EM.height!==this.height)},$EM.addPoint=function($EM,$Ee){return this.x>$EM&&(this.width+=this.x-$EM,this.x=$EM),this.y>$Ee&&(this.height+=this.y-$Ee,this.y=$Ee),this.width<$EM-this.x&&(this.width=$EM-this.x),this.height<$Ee-this.y&&(this.height=$Ee-this.y),this},$EM._getBoundPoints=function(){var $EM=$EO._temB;return($EM.length=0)==this.width||0==this.height||$EM.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$EM},$EM.isEmpty=function(){return this.width<=0||this.height<=0},$Ed(0,$EM,"right",function(){return this.x+this.width}),$Ed(0,$EM,"bottom",function(){return this.y+this.height}),$EO._getBoundPointS=function($EM,$Ee,$EL,$E_){var $Ec=$EO._temA;return($Ec.length=0)==$EL||0==$E_||$Ec.push($EM,$Ee,$EM+$EL,$Ee,$EM,$Ee+$E_,$EM+$EL,$Ee+$E_),$Ec},$EO._getWrapRec=function($EM,$Ee){if(!$EM||$EM.length<1)return $Ee?$Ee.setTo(0,0,0,0):$EO.TEMP.setTo(0,0,0,0);$Ee=$Ee||new $EO;var $EL,$E_,$Ec,$Eq,$EH,$ET=$EM.length,$Ex=$EA.TEMP;for($Ec=$EH=-($E_=$Eq=99999),$EL=0;$EL<$ET;$EL+=2)$Ex.x=$EM[$EL],$Ex.y=$EM[$EL+1],$E_=$E_<$Ex.x?$E_:$Ex.x,$Eq=$Eq<$Ex.y?$Eq:$Ex.y,$Ec=$Ec>$Ex.x?$Ec:$Ex.x,$EH=$EH>$Ex.y?$EH:$Ex.y;return $Ee.setTo($E_,$Eq,$Ec-$E_,$EH-$Eq)},$EO.EMPTY=new $EO,$EO.TEMP=new $EO,$EO._temB=[],$EO._temA=[],$EO}(),$Et=function(){function $Ex(){}return $Eu($Ex,"laya.media.SoundManager"),$Ed(1,$Ex,"useAudioMusic",function(){return $Ex._useAudioMusic},function($EM){$Ex._useAudioMusic=$EM,$Ex._musicClass=$EM?$ELM:null}),$Ed(1,$Ex,"autoStopMusic",function(){return $Ex._autoStopMusic},function($EM){$Ey.stage.off("blur",null,$Ex._stageOnBlur),$Ey.stage.off("focus",null,$Ex._stageOnFocus),$Ey.stage.off("visibilitychange",null,$Ex._visibilityChange),($Ex._autoStopMusic=$EM)&&($Ey.stage.on("blur",null,$Ex._stageOnBlur),$Ey.stage.on("focus",null,$Ex._stageOnFocus),$Ey.stage.on("visibilitychange",null,$Ex._visibilityChange))}),$Ed(1,$Ex,"muted",function(){return $Ex._muted},function($EM){$EM!=$Ex._muted&&($EM&&$Ex.stopAllSound(),$Ex.musicMuted=$EM,$Ex._muted=$EM)}),$Ed(1,$Ex,"musicMuted",function(){return $Ex._musicMuted},function($EM){$EM!=$Ex._musicMuted&&($EM?($Ex._tMusic&&$Ex._musicChannel&&!$Ex._musicChannel.isStopped?$Ex._musicChannel.pause():$Ex._musicChannel=null,$Ex._musicMuted=$EM):($Ex._musicMuted=$EM,$Ex._tMusic&&$Ex._musicChannel&&$Ex._musicChannel.resume()))}),$Ed(1,$Ex,"soundMuted",function(){return $Ex._soundMuted},function($EM){$Ex._soundMuted=$EM}),$Ex.addChannel=function($EM){0<=$Ex._channels.indexOf($EM)||($Ex._channels.push($EM),$Ex.autoReleaseSound&&0!=$Ex._notUsedCount&&$Ex._notUsedUrls[$EM.url]&&(delete $Ex._notUsedUrls[$EM.url],0==--$Ex._notUsedCount&&$Ey.timer.clear($Ex,$Ex.disposeSoundIfNotUsed)))},$Ex.removeChannel=function($EM){var $Ee=$Ex._channels,$EL=$Ee.indexOf($EM);if(-1!=$EL&&($Ee.splice($EL,1),$Ex.autoReleaseSound)){var $E_=$EM.url,$Ec=$Ex.defaultIntervals[$E_]||2e4;if(0<$Ec){var $Eq=!0;for($EL=$Ee.length-1;0<=$EL;$EL--)if($Ee[$EL].url==$E_){$Eq=!1;break}$Eq&&($Ex._notUsedUrls[$E_]=Date.now()+$Ec,0==$Ex._notUsedCount++&&$Ey.timer.loop(1e4,$Ex,$Ex.disposeSoundIfNotUsed))}}},$Ex.disposeSoundIfNotUsed=function(){var $EM=$Ex._notUsedUrls;if(0!=$Ex._notUsedCount){var $Ee=Date.now();for(var $EL in $EM)$Ee>=$EM[$EL]&&(delete $EM[$EL],--$Ex._notUsedCount,$Ex.destroySound($EL));if(0!=$Ex._notUsedCount)return}$Ey.timer.clear($Ex,$Ex.disposeSoundIfNotUsed)},$Ex._visibilityChange=function(){$Ey.stage.isVisibility?$Ex._stageOnFocus():$Ex._stageOnBlur()},$Ex._stageOnBlur=function(){$Ex._isActive=!1,$Ex._musicChannel&&($Ex._musicChannel.isStopped||($Ex._blurPaused=!0,$Ex._musicChannel.pause())),$Ex.stopAllSound(),$Ey.stage.once("mousedown",null,$Ex._stageOnFocus)},$Ex._recoverWebAudio=function(){$EqM.ctx&&"running"!=$EqM.ctx.state&&$EqM.ctx.resume&&$EqM.ctx.resume()},$Ex._stageOnFocus=function(){if($Ex._isActive=!0,$Ex._recoverWebAudio(),$Ey.stage.off("mousedown",null,$Ex._stageOnFocus),$Ex._blurPaused){var $EM=$Ex._musicChannel;$EM&&$Ex._music&&$EM.isStopped&&($Ex._blurPaused=!1,$Ex._music._disposed?$Ex.playMusic($EM.url,$EM.loops,$EM.startHandler,$EM.completeHandler,$EM.startTime):$EM.audioBuffer?$EM.resume():$Ex._music.play($EM.startTime,$EM.loops,$EM.startHandler,$EM))}},$Ex.playSound=function($EM,$Ee,$EL,$E_,$Ec,$Eq){if(void 0===$Ee&&($Ee=1),void 0===$Eq&&($Eq=0),!$EM)return null;if($Ex._muted)return null;if($Ex._recoverWebAudio(),$EM==$Ex._tMusic){if($Ex._musicMuted)return null}else{if(!$Ex._isActive)return null;if($Ex._soundMuted)return null}var $EH,$ET=$Ex._pool[$EM];return $Ec||($Ec=$Ex._soundClass),$ET||(($ET=new $Ec).load($EM),$Ex._pool[$EM]=$ET),($EH=$ET.play($Eq,$Ee,$EL))?($EM==$Ex._tMusic&&($Ex._music=$ET,$Ex._isActive||($Ex._blurPaused=!0,$EH.pause())),$EH.url=$EM,$EH.volume=$EM==$Ex._tMusic?$Ex.musicVolume:$Ex.soundVolume,$EH.completeHandler=$E_,$EH):null},$Ex.destroySound=function($EM){var $Ee=$Ex._pool[$EM];$Ee&&(delete $Ex._pool[$EM],$Ee.dispose())},$Ex.playMusic=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ee&&($Ee=0),void 0===$Ec&&($Ec=0),$Ex._tMusic=$EM,$Ex._musicChannel&&$Ex._musicChannel.stop(),$Ex._musicChannel=$Ex.playSound($EM,$Ee,$EL,$E_,null,$Ec)},$Ex.stopSound=function($EM){for(var $Ee,$EL=$Ex._channels.length-1;0<=$EL;$EL--)($Ee=$Ex._channels[$EL]).url==$EM&&$Ee.stop()},$Ex.stopAll=function(){$Ex._tMusic=null;var $EM=0;for($EM=$Ex._channels.length-1;0<=$EM;$EM--)$Ex._channels[$EM].stop()},$Ex.stopAllSound=function(){var $EM,$Ee=0;for($Ee=$Ex._channels.length-1;0<=$Ee;$Ee--)($EM=$Ex._channels[$Ee]).url!=$Ex._tMusic&&$EM.stop()},$Ex.stopMusic=function(){$Ex._musicChannel&&$Ex._musicChannel.stop(),$Ex._tMusic=null},$Ex.setSoundVolume=function($EM,$Ee){if($Ee)$Ex._setVolume($Ee,$EM);else{$Ex.soundVolume=$EM;var $EL,$E_=0;for($E_=$Ex._channels.length-1;0<=$E_;$E_--)($EL=$Ex._channels[$E_]).url!=$Ex._tMusic&&($EL.volume=$EM)}},$Ex.setMusicVolume=function($EM){$Ex.musicVolume=$EM,$Ex._setVolume($Ex._tMusic,$EM)},$Ex._setVolume=function($EM,$Ee){for(var $EL,$E_=$Ex._channels.length-1;0<=$E_;$E_--)($EL=$Ex._channels[$E_]).url==$EM&&($EL.volume=$Ee)},$Ex.musicVolume=1,$Ex.soundVolume=1,$Ex.playbackRate=1,$Ex._useAudioMusic=!0,$Ex._muted=!1,$Ex._soundMuted=!1,$Ex._musicMuted=!1,$Ex._tMusic=null,$Ex._musicChannel=null,$Ex._music=null,$Ex._channels=[],$Ex._autoStopMusic=!1,$Ex._blurPaused=!1,$Ex._isActive=!0,$Ex._soundClass=null,$Ex._musicClass=null,$Ex.autoReleaseSound=!0,$Ex._pool={},$Ex.defaultIntervals={},$Ex._notUsedUrls={},$Ex._notUsedCount=0,$Ex}(),$Ek=function(){var $EM;function $EL(){}return $Eu($EL,"laya.net.LocalStorage"),$EL.__init__=function(){$EL._baseClass||($EL._baseClass=$EM).init(),$EL.items=$EL._baseClass.items,$EL.support=$EL._baseClass.support},$EL.setItem=function($EM,$Ee){$EL._baseClass.setItem($EM,$Ee)},$EL.getItem=function($EM){return $EL._baseClass.getItem($EM)},$EL.setJSON=function($EM,$Ee){$EL._baseClass.setJSON($EM,$Ee)},$EL.getJSON=function($EM){return $EL._baseClass.getJSON($EM)},$EL.removeItem=function($EM){$EL._baseClass.removeItem($EM)},$EL.clear=function(){$EL._baseClass.clear()},$EL._baseClass=null,$EL.items=null,$EL.support=!1,$EL.__init$=function(){$EM=function(){function $EL(){}return $Eu($EL,""),$EL.init=function(){try{$EL.support=!0,$EL.items=$EH.localStorage,$EL.setItem("laya","1"),$EL.removeItem("laya")}catch($EM){$EL.support=!1}$EL.support||console.log("LocalStorage is not supprot or browser is private mode.")},$EL.setItem=function($EM,$Ee){try{$EL.support&&$EL.items.setItem($EM,$Ee)}catch($EM){console.warn("set localStorage failed",$EM)}},$EL.getItem=function($EM){return $EL.support?$EL.items.getItem($EM):null},$EL.setJSON=function($EM,$Ee){try{$EL.support&&$EL.items.setItem($EM,JSON.stringify($Ee))}catch($EM){console.warn("set localStorage failed",$EM)}},$EL.getJSON=function($EM){return JSON.parse($EL.support?$EL.items.getItem($EM):null)},$EL.removeItem=function($EM){$EL.support&&$EL.items.removeItem($EM)},$EL.clear=function(){$EL.support&&$EL.items.clear()},$EL.items=null,$EL.support=!1,$EL}()},$EL}(),$ER=(function(){function $E_(){}$Eu($E_,"laya.net.ResourceVersion"),$E_.enable=function($EM,$Ee,$EL){void 0===$EL&&($EL=2),laya.net.ResourceVersion.type=$EL,$Ey.loader.load($EM,$EK.create(null,$E_.onManifestLoaded,[$Ee]),null,"json"),$Ea.customFormat=$E_.addVersionPrefix},$E_.onManifestLoaded=function($EM,$Ee){$E_.manifest=$Ee,$EM.run(),$Ee||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$E_.addVersionPrefix=function($EM){return $E_.manifest&&$E_.manifest[$EM]?2==$E_.type?$E_.manifest[$EM]:$E_.manifest[$EM]+"/"+$EM:$EM},$E_.FOLDER_VERSION=1,$E_.FILENAME_VERSION=2,$E_.manifest=null,$E_.type=1}(),function(){function $EM(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$Eu($EM,"laya.net.TTFLoader");var $Ee=$EM.prototype;return $Ee.load=function($EM){var $Ee=(this._url=$EM).split(".ttf")[0].split("/");this.fontName=$Ee[$Ee.length-1],$Eg.window.conch?this._loadConch():$Eg.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$Ee._loadConch=function(){this._http=new $EHM,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$Ee._onHttpLoaded=function($EM){$Eg.window.conch.setFontFaceFromBuffer(this.fontName,$EM),this._clearHttp(),this._complete()},$Ee._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$Ee._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$Ee._complete=function(){$Ey.timer.clear(this,this._complete),$Ey.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$Ee._checkComplete=function(){$ES.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$Ee._loadWithFontFace=function(){var $EM=new $Eg.window.FontFace(this.fontName,"url('"+this._url+"')");$Eg.window.document.fonts.add($EM);var $Ee=this;$EM.loaded.then(function(){$Ee._complete()}),$EM.load()},$Ee._createDiv=function(){this._div=$Eg.createElement("div"),this._div.innerHTML="laya";var $EM=this._div.style;$EM.fontFamily=this.fontName,$EM.position="absolute",$EM.left="-100px",$EM.top="-100px",$Eg.document.body.appendChild(this._div)},$Ee._loadWithCSS=function(){var $EM=this,$Ee=$Eg.createElement("style");$Ee.type="text/css",$Eg.document.body.appendChild($Ee),$Ee.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$ES.measureText("LayaTTFFont",this._fontTxt).width;var $EL=this;$Ee.onload=function(){$Ey.timer.once(1e4,$EL,$EM._complete)},$Ey.timer.loop(20,this,this._checkComplete),this._createDiv()},$EM._testString="LayaTTFFont",$EM}()),$Ea=function(){function $E_($EM){this._url=null,this._path=null,this._url=$E_.formatURL($EM),this._path=$E_.getPath($EM)}$Eu($E_,"laya.net.URL");var $EM=$E_.prototype;return $Ed(0,$EM,"path",function(){return this._path}),$Ed(0,$EM,"url",function(){return this._url}),$E_.formatURL=function($EM,$Ee){if(!$EM)return"null path";if(0<$EM.indexOf(":"))return $EM;null!=$E_.customFormat&&($EM=$E_.customFormat($EM,$Ee));var $EL=$EM.charAt(0);if("."===$EL)return $E_.formatRelativePath(($Ee||$E_.basePath)+$EM);if("~"===$EL)return $E_.rootPath+$EM.substring(1);if("d"===$EL){if(0===$EM.indexOf("data:image"))return $EM}else if("/"===$EL)return $EM;return($Ee||$E_.basePath)+$EM},$E_.formatRelativePath=function($EM){for(var $Ee=$EM.split("/"),$EL=0,$E_=$Ee.length;$EL<$E_;$EL++)".."==$Ee[$EL]&&($Ee.splice($EL-1,2),$EL-=2);return $Ee.join("/")},$E_.isAbsolute=function($EM){return 0<$EM.indexOf(":")||"/"==$EM.charAt(0)},$E_.getPath=function($EM){var $Ee=$EM.lastIndexOf("/");return 0<$Ee?$EM.substr(0,$Ee+1):""},$E_.getFileName=function($EM){var $Ee=$EM.lastIndexOf("/");return 0<$Ee?$EM.substr($Ee+1):$EM},$E_.version={},$E_.basePath="",$E_.rootPath="",$E_.customFormat=function($EM){var $Ee=$E_.version[$EM];return!$En.isConchApp&&$Ee&&($EM+="?v="+$Ee),$EM},$E_}(),$En=function(){function $Ec($EM,$Ee){this._timeId=0;var $EL=$Ec._mainCanvas.source.style;$EL.position="absolute",$EL.top=$EL.left="0px",$EL.background="#000000",$Ec._mainCanvas.source.id="layaCanvas";var $E_=laya.renders.Render.isWebGL;$Ec._mainCanvas.source.width=$EM,$Ec._mainCanvas.source.height=$Ee,$E_&&$Ec.WebGL.init($Ec._mainCanvas,$EM,$Ee),$Eg.container.appendChild($Ec._mainCanvas.source),($Ec._context=new $El($EM,$Ee,$E_?null:$Ec._mainCanvas)).ctx.setIsMainContext(),$Eg.window.requestAnimationFrame(function $EM($Ee){$Eg.window.requestAnimationFrame($EM);$Ey.stage._loop()}),$Ey.stage.on("visibilitychange",this,this._onVisibilitychange)}$Eu($Ec,"laya.renders.Render");var $EM=$Ec.prototype;return $EM._onVisibilitychange=function(){$Ey.stage.isVisibility?0!=this._timeId&&$Eg.window.clearInterval(this._timeId):this._timeId=$Eg.window.setInterval(this._enterFrame,1e3)},$EM._enterFrame=function($EM){$Ey.stage._loop()},$Ed(1,$Ec,"context",function(){return $Ec._context}),$Ed(1,$Ec,"canvas",function(){return $Ec._mainCanvas.source}),$Ec._context=null,$Ec._mainCanvas=null,$Ec.WebGL=null,$Ec.isConchNode=!1,$Ec.isConchApp=!1,$Ec.isConchWebGL=!1,$Ec.isWebGL=!1,$Ec.is3DMode=!1,$Ec.optimizeTextureMemory=function($EM,$Ee){return!0},$Ec.__init$=function(){$EH.ConchRenderType=$EH.ConchRenderType||1,$EH.ConchRenderType|=$EH.conch?4:0,$Ec.isConchNode=5==(5&$EH.ConchRenderType),$Ec.isConchApp=4==(4&$EH.ConchRenderType),$Ec.isConchWebGL=6==$EH.ConchRenderType},$Ec}(),$El=function(){function $EH($EM,$Ee,$EL){this.x=0,this.y=0,this._drawTexture=function($EM,$Ee,$EL){$EL[0].loaded&&this.ctx.drawTexture($EL[0],$EL[1],$EL[2],$EL[3],$EL[4],$EM,$Ee)},this._fillTexture=function($EM,$Ee,$EL){$EL[0].loaded&&this.ctx.fillTexture($EL[0],$EL[1]+$EM,$EL[2]+$Ee,$EL[3],$EL[4],$EL[5],$EL[6],$EL[7])},this._drawTextureWithTransform=function($EM,$Ee,$EL){$EL[0].loaded&&this.ctx.drawTextureWithTransform($EL[0],$EL[1],$EL[2],$EL[3],$EL[4],$EL[5],$EM,$Ee,$EL[6])},this._fillQuadrangle=function($EM,$Ee,$EL){this.ctx.fillQuadrangle($EL[0],$EL[1],$EL[2],$EL[3],$EL[4])},this._drawRect=function($EM,$Ee,$EL){var $E_=this.ctx;null!=$EL[4]&&($E_.fillStyle=$EL[4],$E_.fillRect($EM+$EL[0],$Ee+$EL[1],$EL[2],$EL[3],null)),null!=$EL[5]&&($E_.strokeStyle=$EL[5],$E_.lineWidth=$EL[6],$E_.strokeRect($EM+$EL[0],$Ee+$EL[1],$EL[2],$EL[3],$EL[6]))},this._drawPie=function($EM,$Ee,$EL){var $E_=this.ctx;$En.isWebGL&&$E_.setPathId($EL[8]),$E_.beginPath(),$En.isWebGL?($E_.movePath($EL[0]+$EM,$EL[1]+$Ee),$E_.moveTo(0,0)):$E_.moveTo($EM+$EL[0],$Ee+$EL[1]),$E_.arc($EM+$EL[0],$Ee+$EL[1],$EL[2],$EL[3],$EL[4]),$E_.closePath(),this._fillAndStroke($EL[5],$EL[6],$EL[7],!0)},this._clipRect=function($EM,$Ee,$EL){this.ctx.clipRect($EM+$EL[0],$Ee+$EL[1],$EL[2],$EL[3])},this._fillRect=function($EM,$Ee,$EL){this.ctx.fillRect($EM+$EL[0],$Ee+$EL[1],$EL[2],$EL[3],$EL[4])},this._drawCircle=function($EM,$Ee,$EL){var $E_=this.ctx;$En.isWebGL&&$E_.setPathId($EL[6]),$EZ.drawCall++,$E_.beginPath(),$En.isWebGL&&$E_.movePath($EL[0]+$EM,$EL[1]+$Ee),$E_.arc($EL[0]+$EM,$EL[1]+$Ee,$EL[2],0,$EH.PI2),$E_.closePath(),this._fillAndStroke($EL[3],$EL[4],$EL[5],!0)},this._fillCircle=function($EM,$Ee,$EL){$EZ.drawCall++;var $E_=this.ctx;$E_.beginPath(),$E_.fillStyle=$EL[3],$E_.arc($EL[0]+$EM,$EL[1]+$Ee,$EL[2],0,$EH.PI2),$E_.fill()},this._setShader=function($EM,$Ee,$EL){this.ctx.setShader($EL[0])},this._drawLine=function($EM,$Ee,$EL){var $E_=this.ctx;$En.isWebGL&&$E_.setPathId($EL[6]),$E_.beginPath(),$E_.strokeStyle=$EL[4],$E_.lineWidth=$EL[5],$En.isWebGL?($E_.movePath($EM,$Ee),$E_.moveTo($EL[0],$EL[1]),$E_.lineTo($EL[2],$EL[3])):($E_.moveTo($EM+$EL[0],$Ee+$EL[1]),$E_.lineTo($EM+$EL[2],$Ee+$EL[3])),$E_.stroke()},this._drawLines=function($EM,$Ee,$EL){var $E_=this.ctx;$En.isWebGL&&$E_.setPathId($EL[5]),$E_.beginPath(),$EM+=$EL[0],$Ee+=$EL[1],$En.isWebGL&&$E_.movePath($EM,$Ee),$E_.strokeStyle=$EL[3],$E_.lineWidth=$EL[4];var $Ec=$EL[2],$Eq=2,$EH=$Ec.length;if($En.isWebGL)for($E_.moveTo($Ec[0],$Ec[1]);$Eq<$EH;)$E_.lineTo($Ec[$Eq++],$Ec[$Eq++]);else for($E_.moveTo($EM+$Ec[0],$Ee+$Ec[1]);$Eq<$EH;)$E_.lineTo($EM+$Ec[$Eq++],$Ee+$Ec[$Eq++]);$E_.stroke()},this._drawLinesWebGL=function($EM,$Ee,$EL){this.ctx.drawLines($EM+this.x+$EL[0],$Ee+this.y+$EL[1],$EL[2],$EL[3],$EL[4])},this._drawCurves=function($EM,$Ee,$EL){this.ctx.drawCurves($EM,$Ee,$EL)},this._draw=function($EM,$Ee,$EL){$EL[0].call(null,this,$EM,$Ee)},this._transformByMatrix=function($EM,$Ee,$EL){this.ctx.transformByMatrix($EL[0])},this._setTransform=function($EM,$Ee,$EL){this.ctx.setTransform($EL[0],$EL[1],$EL[2],$EL[3],$EL[4],$EL[5])},this._setTransformByMatrix=function($EM,$Ee,$EL){this.ctx.setTransformByMatrix($EL[0])},this._save=function($EM,$Ee,$EL){this.ctx.save()},this._restore=function($EM,$Ee,$EL){this.ctx.restore()},this._translate=function($EM,$Ee,$EL){this.ctx.translate($EL[0],$EL[1])},this._transform=function($EM,$Ee,$EL){this.ctx.translate($EL[1]+$EM,$EL[2]+$Ee);var $E_=$EL[0];this.ctx.transform($E_.a,$E_.b,$E_.c,$E_.d,$E_.tx,$E_.ty),this.ctx.translate(-$EM-$EL[1],-$Ee-$EL[2])},this._rotate=function($EM,$Ee,$EL){this.ctx.translate($EL[1]+$EM,$EL[2]+$Ee),this.ctx.rotate($EL[0]),this.ctx.translate(-$EM-$EL[1],-$Ee-$EL[2])},this._scale=function($EM,$Ee,$EL){this.ctx.translate($EL[2]+$EM,$EL[3]+$Ee),this.ctx.scale($EL[0],$EL[1]),this.ctx.translate(-$EM-$EL[2],-$Ee-$EL[3])},this._alpha=function($EM,$Ee,$EL){this.ctx.globalAlpha*=$EL[0]},this._setAlpha=function($EM,$Ee,$EL){this.ctx.globalAlpha=$EL[0]},this._fillText=function($EM,$Ee,$EL){this.ctx.fillText($EL[0],$EL[1]+$EM,$EL[2]+$Ee,$EL[3],$EL[4],$EL[5])},this._strokeText=function($EM,$Ee,$EL){this.ctx.strokeText($EL[0],$EL[1]+$EM,$EL[2]+$Ee,$EL[3],$EL[4],$EL[5],$EL[6])},this._fillBorderText=function($EM,$Ee,$EL){this.ctx.fillBorderText($EL[0],$EL[1]+$EM,$EL[2]+$Ee,$EL[3],$EL[4],$EL[5],$EL[6],$EL[7])},this._blendMode=function($EM,$Ee,$EL){this.ctx.globalCompositeOperation=$EL[0]},this._beginClip=function($EM,$Ee,$EL){this.ctx.beginClip&&this.ctx.beginClip($EM+$EL[0],$Ee+$EL[1],$EL[2],$EL[3])},this._setIBVB=function($EM,$Ee,$EL){this.ctx.setIBVB($EL[0]+$EM,$EL[1]+$Ee,$EL[2],$EL[3],$EL[4],$EL[5],$EL[6],$EL[7])},this._fillTrangles=function($EM,$Ee,$EL){this.ctx.fillTrangles($EL[0],$EL[1]+$EM,$EL[2]+$Ee,$EL[3],$EL[4])},this._drawPath=function($EM,$Ee,$EL){var $E_=this.ctx;$En.isWebGL&&$E_.setPathId(-1),$E_.beginPath(),$EM+=$EL[0],$Ee+=$EL[1],$En.isWebGL&&$E_.movePath($EM,$Ee);for(var $Ec=$EL[2],$Eq=0,$EH=$Ec.length;$Eq<$EH;$Eq++){var $ET=$Ec[$Eq];switch($ET[0]){case"moveTo":$En.isWebGL?$E_.moveTo($ET[1],$ET[2]):$E_.moveTo($EM+$ET[1],$Ee+$ET[2]);break;case"lineTo":$En.isWebGL?$E_.lineTo($ET[1],$ET[2]):$E_.lineTo($EM+$ET[1],$Ee+$ET[2]);break;case"arcTo":$En.isWebGL?$E_.arcTo($ET[1],$ET[2],$ET[3],$ET[4],$ET[5]):$E_.arcTo($EM+$ET[1],$Ee+$ET[2],$EM+$ET[3],$Ee+$ET[4],$ET[5]);break;case"closePath":$E_.closePath()}}var $Ex=$EL[3];null!=$Ex&&($E_.fillStyle=$Ex.fillStyle,$E_.fill());var $EO=$EL[4];null!=$EO&&($E_.strokeStyle=$EO.strokeStyle,$E_.lineWidth=$EO.lineWidth||1,$E_.lineJoin=$EO.lineJoin,$E_.lineCap=$EO.lineCap,$E_.miterLimit=$EO.miterLimit,$E_.stroke())},this.drawPoly=function($EM,$Ee,$EL){this.ctx.drawPoly($EM+this.x+$EL[0],$Ee+this.y+$EL[1],$EL[2],$EL[3],$EL[4],$EL[5],$EL[6])},this._drawPoly=function($EM,$Ee,$EL){var $E_=this.ctx,$Ec=$EL[2],$Eq=2,$EH=$Ec.length;if($En.isWebGL)for($E_.setPathId($EL[6]),$E_.beginPath(),$EM+=$EL[0],$Ee+=$EL[1],$E_.movePath($EM,$Ee),$E_.moveTo($Ec[0],$Ec[1]);$Eq<$EH;)$E_.lineTo($Ec[$Eq++],$Ec[$Eq++]);else for($E_.beginPath(),$EM+=$EL[0],$Ee+=$EL[1],$E_.moveTo($EM+$Ec[0],$Ee+$Ec[1]);$Eq<$EH;)$E_.lineTo($EM+$Ec[$Eq++],$Ee+$Ec[$Eq++]);$E_.closePath(),this._fillAndStroke($EL[3],$EL[4],$EL[5],$EL[7])},this._drawSkin=function($EM,$Ee,$EL){var $E_=$EL[0];if($E_){var $Ec=this.ctx;$E_.render($Ec,$EM,$Ee)}},this._drawParticle=function($EM,$Ee,$EL){this.ctx.drawParticle($EM+this.x,$Ee+this.y,$EL[0])},this._setFilters=function($EM,$Ee,$EL){this.ctx.setFilters($EL)},$EL?this.ctx=$EL.getContext("2d"):($EL=$EXM.create("3D"),this.ctx=$ES.createWebGLContext2D($EL),$EL._setContext(this.ctx)),$EL.size($EM,$Ee),this.canvas=$EL}$Eu($EH,"laya.renders.RenderContext");var $EM=$EH.prototype;return $EM.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$EM.drawTexture=function($EM,$Ee,$EL,$E_,$Ec){$EM.loaded&&this.ctx.drawTexture($EM,$Ee,$EL,$E_,$Ec,this.x,this.y)},$EM._drawTextures=function($EM,$Ee,$EL){$EL[0].loaded&&this.ctx.drawTextures($EL[0],$EL[1],$EM+this.x,$Ee+this.y)},$EM.drawTextureWithTransform=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$EM.loaded&&this.ctx.drawTextureWithTransform($EM,$Ee,$EL,$E_,$Ec,$Eq,this.x,this.y,$EH)},$EM.fillQuadrangle=function($EM,$Ee,$EL,$E_,$Ec){this.ctx.fillQuadrangle($EM,$Ee,$EL,$E_,$Ec)},$EM.drawCanvas=function($EM,$Ee,$EL,$E_,$Ec){this.ctx.drawCanvas($EM,$Ee+this.x,$EL+this.y,$E_,$Ec)},$EM.drawRect=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Eq&&($Eq=1);var $EH=this.ctx;$EH.strokeStyle=$Ec,$EH.lineWidth=$Eq,$EH.strokeRect($EM+this.x,$Ee+this.y,$EL,$E_,$Eq)},$EM._fillAndStroke=function($EM,$Ee,$EL,$E_){void 0===$E_&&($E_=!1);var $Ec=this.ctx;null!=$EM&&($Ec.fillStyle=$EM,$En.isWebGL?$Ec.fill($E_):$Ec.fill()),null!=$Ee&&0<$EL&&($Ec.strokeStyle=$Ee,$Ec.lineWidth=$EL,$Ec.stroke())},$EM.clipRect=function($EM,$Ee,$EL,$E_){this.ctx.clipRect($EM+this.x,$Ee+this.y,$EL,$E_)},$EM.fillRect=function($EM,$Ee,$EL,$E_,$Ec){this.ctx.fillRect($EM+this.x,$Ee+this.y,$EL,$E_,$Ec)},$EM.drawCircle=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=1),$EZ.drawCall++;var $Eq=this.ctx;$Eq.beginPath(),$Eq.strokeStyle=$E_,$Eq.lineWidth=$Ec,$Eq.arc($EM+this.x,$Ee+this.y,$EL,0,$EH.PI2),$Eq.stroke()},$EM.drawTriangles=function($EM,$Ee,$EL){if($En.isWebGL)this.ctx.drawTriangles($EL[0],$EM+$EL[1],$Ee+$EL[2],$EL[3],$EL[4],$EL[5],$EL[6],$EL[7],$EL[8],$EL[9]);else{var $E_=$EL[5],$Ec=0,$Eq=$E_.length,$EH=this.ctx;for($Ec=0;$Ec<$Eq;$Ec+=3){var $ET=2*$E_[$Ec],$Ex=2*$E_[$Ec+1],$EO=2*$E_[$Ec+2];$EH.drawTriangle($EL[0],$EL[3],$EL[4],$ET,$Ex,$EO,$EL[6],!0)}}},$EM.fillCircle=function($EM,$Ee,$EL,$E_){$EZ.drawCall++;var $Ec=this.ctx;$Ec.beginPath(),$Ec.fillStyle=$E_,$Ec.arc($EM+this.x,$Ee+this.y,$EL,0,$EH.PI2),$Ec.fill()},$EM.setShader=function($EM){this.ctx.setShader($EM)},$EM.drawLine=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Eq&&($Eq=1);var $EH=this.ctx;$EH.beginPath(),$EH.strokeStyle=$Ec,$EH.lineWidth=$Eq,$EH.moveTo(this.x+$EM,this.y+$Ee),$EH.lineTo(this.x+$EL,this.y+$E_),$EH.stroke()},$EM.clear=function(){this.ctx.clear()},$EM.transformByMatrix=function($EM){this.ctx.transformByMatrix($EM)},$EM.setTransform=function($EM,$Ee,$EL,$E_,$Ec,$Eq){this.ctx.setTransform($EM,$Ee,$EL,$E_,$Ec,$Eq)},$EM.setTransformByMatrix=function($EM){this.ctx.setTransformByMatrix($EM)},$EM.save=function(){this.ctx.save()},$EM.restore=function(){this.ctx.restore()},$EM.translate=function($EM,$Ee){this.ctx.translate($EM,$Ee)},$EM.transform=function($EM,$Ee,$EL,$E_,$Ec,$Eq){this.ctx.transform($EM,$Ee,$EL,$E_,$Ec,$Eq)},$EM.rotate=function($EM){this.ctx.rotate($EM)},$EM.scale=function($EM,$Ee){this.ctx.scale($EM,$Ee)},$EM.alpha=function($EM){this.ctx.globalAlpha*=$EM},$EM.setAlpha=function($EM){this.ctx.globalAlpha=$EM},$EM.fillWords=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Eq&&($Eq=0),this.ctx.fillWords($EM,$Ee,$EL,$E_,$Ec,$Eq)},$EM.fillBorderWords=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this.ctx.fillBorderWords($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH)},$EM.fillText=function($EM,$Ee,$EL,$E_,$Ec,$Eq){this.ctx.fillText($EM,$Ee+this.x,$EL+this.y,$E_,$Ec,$Eq)},$EM.strokeText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this.ctx.strokeText($EM,$Ee+this.x,$EL+this.y,$E_,$Ec,$Eq,$EH)},$EM.blendMode=function($EM){this.ctx.globalCompositeOperation=$EM},$EM.flush=function(){this.ctx.flush&&this.ctx.flush()},$EM.addRenderObject=function($EM){this.ctx.addRenderObject($EM)},$EM.beginClip=function($EM,$Ee,$EL,$E_){this.ctx.beginClip&&this.ctx.beginClip($EM,$Ee,$EL,$E_)},$EM.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$EM.fillTrangles=function($EM,$Ee,$EL){this.ctx.fillTrangles($EL[0],$EL[1],$EL[2],$EL[3],4<$EL.length?$EL[4]:null)},$EH.PI2=2*Math.PI,$EH}(),$Ef=function(){function $EH($EM,$Ee){switch(this._next=$Ee||$EH.NORENDER,$EM){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$EC._filter);case 69905:return void(this._fun=$EH._initRenderFun)}this.onCreate($EM)}$Eu($EH,"laya.renders.RenderSprite");var $EM=$EH.prototype;return $EM.onCreate=function($EM){},$EM._style=function($EM,$Ee,$EL,$E_){$EM._style.render($EM,$Ee,$EL,$E_);var $Ec=this._next;$Ec._fun.call($Ec,$EM,$Ee,$EL,$E_)},$EM._no=function($EM,$Ee,$EL,$E_){},$EM._custom=function($EM,$Ee,$EL,$E_){$EM.customRender($Ee,$EL,$E_);var $Ec=$EM._style._tf;this._next._fun.call(this._next,$EM,$Ee,$EL-$Ec.translateX,$E_-$Ec.translateY)},$EM._clip=function($EM,$Ee,$EL,$E_){var $Ec=this._next;if($Ec!=$EH.NORENDER){var $Eq=$EM._style.scrollRect;$Ee.ctx.save(),$Ee.ctx.clipRect($EL,$E_,$Eq.width,$Eq.height),$Ec._fun.call($Ec,$EM,$Ee,$EL-$Eq.x,$E_-$Eq.y),$Ee.ctx.restore()}},$EM._blend=function($EM,$Ee,$EL,$E_){var $Ec=$EM._style;$Ec.blendMode&&($Ee.ctx.globalCompositeOperation=$Ec.blendMode);var $Eq=this._next;$Eq._fun.call($Eq,$EM,$Ee,$EL,$E_),$Ee.ctx.globalCompositeOperation="source-over"},$EM._mask=function($EM,$Ee,$EL,$E_){var $Ec=this._next;$Ec._fun.call($Ec,$EM,$Ee,$EL,$E_);var $Eq=$EM.mask;$Eq&&($Ee.ctx.globalCompositeOperation="destination-in",(0<$Eq.numChildren||!$Eq.graphics._isOnlyOne())&&($Eq.cacheAsBitmap=!0),$Eq.render($Ee,$EL-$EM.pivotX,$E_-$EM.pivotY)),$Ee.ctx.globalCompositeOperation="source-over"},$EM._graphics=function($EM,$Ee,$EL,$E_){var $Ec=$EM._style._tf;$EM._graphics&&$EM._graphics._render($EM,$Ee,$EL-$Ec.translateX,$E_-$Ec.translateY);var $Eq=this._next;$Eq._fun.call($Eq,$EM,$Ee,$EL,$E_)},$EM._image=function($EM,$Ee,$EL,$E_){var $Ec=$EM._style;$Ee.ctx.drawTexture2($EL,$E_,$Ec._tf.translateX,$Ec._tf.translateY,$EM.transform,$Ec.alpha,$Ec.blendMode,$EM._graphics._one)},$EM._image2=function($EM,$Ee,$EL,$E_){var $Ec=$EM._style._tf;$Ee.ctx.drawTexture2($EL,$E_,$Ec.translateX,$Ec.translateY,$EM.transform,1,null,$EM._graphics._one)},$EM._alpha=function($EM,$Ee,$EL,$E_){var $Ec;if(.01<($Ec=$EM._style.alpha)||$EM._needRepaint()){var $Eq=$Ee.ctx.globalAlpha;$Ee.ctx.globalAlpha*=$Ec;var $EH=this._next;$EH._fun.call($EH,$EM,$Ee,$EL,$E_),$Ee.ctx.globalAlpha=$Eq}},$EM._transform=function($EM,$Ee,$EL,$E_){var $Ec=$EM.transform,$Eq=this._next;$Ec&&$Eq!=$EH.NORENDER?($Ee.save(),$Ee.transform($Ec.a,$Ec.b,$Ec.c,$Ec.d,$Ec.tx+$EL,$Ec.ty+$E_),$Eq._fun.call($Eq,$EM,$Ee,0,0),$Ee.restore()):$Eq._fun.call($Eq,$EM,$Ee,$EL,$E_)},$EM._childs=function($EM,$Ee,$EL,$E_){var $Ec=$EM._style,$Eq=$Ec._tf;if($EL=$EL-$Eq.translateX+$Ec.paddingLeft,$E_=$E_-$Eq.translateY+$Ec.paddingTop,$Ec._calculation){var $EH=$EM._getWords();if($EH){var $ET=$Ec;$ET&&($ET.stroke?$Ee.fillBorderWords($EH,$EL,$E_,$ET.font,$ET.color,$ET.strokeColor,$ET.stroke):$Ee.fillWords($EH,$EL,$E_,$ET.font,$ET.color,"none"!=$ET.textDecoration&&$ET.underLine?1:0))}}var $Ex,$EO=$EM._childs,$Eu=$EO.length;if($EM.viewport||$EM.optimizeScrollRect&&$EM._style.scrollRect){var $EG=$EM.viewport||$EM._style.scrollRect,$EV=$EG.x,$EE=$EG.y,$Ed=$EG.right,$Er=$EG.bottom,$E$=NaN,$EC=NaN;for($EK=0;$EK<$Eu;++$EK)($Ex=$EO[$EK]).visible&&($E$=$Ex._x)<$Ed&&$E$+$Ex.width>$EV&&($EC=$Ex._y)<$Er&&$EC+$Ex.height>$EE&&$Ex.render($Ee,$EL,$E_)}else for(var $EK=0;$EK<$Eu;++$EK)($Ex=$EO[$EK])._style.visible&&$Ex.render($Ee,$EL,$E_)},$EM._canvas=function($EM,$Ee,$EL,$E_){var $Ec=$EM._$P.cacheCanvas;if($Ec){"bitmap"===$Ec.type?$EZ.canvasBitmap++:$EZ.canvasNormal++;var $Eq=$Ec.ctx;if($EM._needRepaint()||!$Eq)this._canvas_repaint($EM,$Ee,$EL,$E_);else{var $EH=$Ec._cacheRec;$Ee.drawCanvas($Eq.canvas,$EL+$EH.x,$E_+$EH.y,$EH.width,$EH.height)}}else this._next._fun.call(this._next,$EM,$Ee,$EL,$E_)},$EM._canvas_repaint=function($EM,$Ee,$EL,$E_){var $Ec=$EM._$P.cacheCanvas,$Eq=this._next;if($Ec){var $EH,$ET,$Ex,$EO,$Eu=$Ec.ctx,$EG=$EM._needRepaint()||!$Eu,$EV=$Ec.type;if("bitmap"===$EV?$EZ.canvasBitmap++:$EZ.canvasNormal++,$EG){var $EE,$Ed;$Ec._cacheRec||($Ec._cacheRec=new $EB),$En.isWebGL&&"bitmap"!==$EV?$Ec._cacheRec.setTo(-$EM.pivotX,-$EM.pivotY,1,1):(($EO=$EM.getSelfBounds()).x=$EO.x-$EM.pivotX,$EO.y=$EO.y-$EM.pivotY,$EO.x=$EO.x-16,$EO.y=$EO.y-16,$EO.width=$EO.width+32,$EO.height=$EO.height+32,$EO.x=Math.floor($EO.x+$EL)-$EL,$EO.y=Math.floor($EO.y+$E_)-$E_,$EO.width=Math.floor($EO.width),$EO.height=Math.floor($EO.height),$Ec._cacheRec.copyFrom($EO)),$EO=$Ec._cacheRec;var $Er,$E$=$En.isWebGL?1:$Eg.pixelRatio*$Ey.stage.clientScaleX,$EC=$En.isWebGL?1:$Eg.pixelRatio*$Ey.stage.clientScaleY;if(!$En.isWebGL){var $EK,$EX=1,$Eo=1;for($EK=$EM;$EK&&$EK!=$Ey.stage;)$EX*=$EK.scaleX,$Eo*=$EK.scaleY,$EK=$EK.parent;$En.isWebGL?($EX<1&&($E$*=$EX),$Eo<1&&($EC*=$Eo)):(1<$EX&&($E$*=$EX),1<$Eo&&($EC*=$Eo))}if($EM.scrollRect){var $Ei=$EM.scrollRect;$EO.x-=$Ei.x,$EO.y-=$Ei.y}if($EE=$EO.width*$E$,$Ed=$EO.height*$EC,$ET=$EO.x,$Ex=$EO.y,$En.isWebGL&&"bitmap"===$EV&&(2048<$EE||2048<$Ed))return console.warn("cache bitmap size larger than 2048,cache ignored"),$Ec.ctx&&($EP.recover("RenderContext",$Ec.ctx),$Ec.ctx.canvas.size(0,0),$Ec.ctx=null),void $Eq._fun.call($Eq,$EM,$Ee,$EL,$E_);if($Eu||($Eu=$Ec.ctx=$EP.getItem("RenderContext")||new $El($EE,$Ed,$EXM.create("AUTO"))),$Eu.ctx.sprite=$EM,($EH=$Eu.canvas).clear(),($EH.width!=$EE||$EH.height!=$Ed)&&$EH.size($EE,$Ed),"bitmap"===$EV?$EH.context.asBitmap=!0:"normal"===$EV&&($EH.context.asBitmap=!1),1!=$E$||1!=$EC){var $EW=$Eu.ctx;$EW.save(),$EW.scale($E$,$EC),!$En.isConchWebGL&&$En.isConchApp&&($Er=$EM._$P.cf)&&$EW.setFilterMatrix&&$EW.setFilterMatrix($Er._mat,$Er._alpha),$Eq._fun.call($Eq,$EM,$Eu,-$ET,-$Ex),$EW.restore(),$En.isConchApp&&!$En.isConchWebGL||$EM._applyFilters()}else $EW=$Eu.ctx,!$En.isConchWebGL&&$En.isConchApp&&($Er=$EM._$P.cf)&&$EW.setFilterMatrix&&$EW.setFilterMatrix($Er._mat,$Er._alpha),$Eq._fun.call($Eq,$EM,$Eu,-$ET,-$Ex),$En.isConchApp&&!$En.isConchWebGL||$EM._applyFilters();$EM._$P.staticCache&&($Ec.reCache=!1),$EZ.canvasReCache++}else $ET=($EO=$Ec._cacheRec).x,$Ex=$EO.y,$EH=$Eu.canvas;$Ee.drawCanvas($EH,$EL+$ET,$E_+$Ex,$EO.width,$EO.height)}else $Eq._fun.call($Eq,$EM,$Eu,$EL,$E_)},$EH.__init__=function(){var $EM,$Ee,$EL=0;for($Ee=$ES.createRenderSprite(69905,null),$EM=$EH.renders.length=4096,$EL=0;$EL<$EM;$EL++)$EH.renders[$EL]=$Ee;$EH.renders[0]=$ES.createRenderSprite(0,null),function($EM,$Ee){for(var $EL=0,$E_=0;$E_<$EM.length;$E_++)$EL|=$EM[$E_],$EH.renders[$EL]=$Ee}([1,512,4,2],new $EH(1,null)),$EH.renders[513]=$ES.createRenderSprite(513,null),$EH.renders[517]=new $EH(517,null)},$EH._initRenderFun=function($EM,$Ee,$EL,$E_){var $Ec=$EM._renderType;($EH.renders[$Ec]=$EH._getTypeRender($Ec))._fun($EM,$Ee,$EL,$E_)},$EH._getTypeRender=function($EM){for(var $Ee=null,$EL=2048;1<$EL;)$EL&$EM&&($Ee=$ES.createRenderSprite($EL,$Ee)),$EL>>=1;return $Ee},$EH.IMAGE=1,$EH.ALPHA=2,$EH.TRANSFORM=4,$EH.BLEND=8,$EH.CANVAS=16,$EH.FILTERS=32,$EH.MASK=64,$EH.CLIP=128,$EH.STYLE=256,$EH.GRAPHICS=512,$EH.CUSTOM=1024,$EH.CHILDS=2048,$EH.INIT=69905,$EH.renders=[],$EH.NORENDER=new $EH(0,null),$EH}(),$Ej=function(){function $ET(){this._repaint=!1}$Eu($ET,"laya.resource.Context");var $EM=$ET.prototype;return $EM.replaceReset=function(){var $EM,$Ee,$EL=0;for($EM=$ET.replaceKeys.length,$EL=0;$EL<$EM;$EL++)$Ee=$ET.replaceKeys[$EL],this[$ET.newKeys[$EL]]=this[$Ee]},$EM.replaceResotre=function(){this.__restore(),this.__reset()},$EM.setIsMainContext=function(){},$EM.drawTextures=function($EM,$Ee,$EL,$E_){$EZ.drawCall+=$Ee.length/2;for(var $Ec=$EM.width,$Eq=$EM.height,$EH=0,$ET=$Ee.length;$EH<$ET;$EH+=2)this.drawTexture($EM,$Ee[$EH],$Ee[$EH+1],$Ec,$Eq,$EL,$E_)},$EM.drawCanvas=function($EM,$Ee,$EL,$E_,$Ec){$EZ.drawCall++,this.drawImage($EM.source,$Ee,$EL,$E_,$Ec)},$EM.fillRect=function($EM,$Ee,$EL,$E_,$Ec){$EZ.drawCall++,$Ec&&(this.fillStyle=$Ec),this.__fillRect($EM,$Ee,$EL,$E_)},$EM.fillText=function($EM,$Ee,$EL,$E_,$Ec,$Eq){$EZ.drawCall++,3<arguments.length&&null!=$E_&&(this.font=$E_,this.fillStyle=$Ec,this.textAlign=$Eq,this.textBaseline="top"),this.__fillText($EM,$Ee,$EL)},$EM.fillBorderText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){$EZ.drawCall++,this.font=$E_,this.fillStyle=$Ec,this.textBaseline="top",this.strokeStyle=$Eq,this.lineWidth=$EH,this.textAlign=$ET,this.__strokeText($EM,$Ee,$EL),this.__fillText($EM,$Ee,$EL)},$EM.strokeText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$EZ.drawCall++,3<arguments.length&&null!=$E_&&(this.font=$E_,this.strokeStyle=$Ec,this.lineWidth=$Eq,this.textAlign=$EH,this.textBaseline="top"),this.__strokeText($EM,$Ee,$EL)},$EM.transformByMatrix=function($EM){this.transform($EM.a,$EM.b,$EM.c,$EM.d,$EM.tx,$EM.ty)},$EM.setTransformByMatrix=function($EM){this.setTransform($EM.a,$EM.b,$EM.c,$EM.d,$EM.tx,$EM.ty)},$EM.clipRect=function($EM,$Ee,$EL,$E_){$EZ.drawCall++,this.beginPath(),this.rect($EM,$Ee,$EL,$E_),this.clip()},$EM.drawTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$EZ.drawCall++;var $ET=$EM.uv,$Ex=$EM.bitmap.width,$EO=$EM.bitmap.height;this.drawImage($EM.source,$ET[0]*$Ex,$ET[1]*$EO,($ET[2]-$ET[0])*$Ex,($ET[5]-$ET[3])*$EO,$Ee+$Eq,$EL+$EH,$E_,$Ec)},$EM.drawTextureWithTransform=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){$EZ.drawCall++;var $EO=$EM.uv,$Eu=$EM.bitmap.width,$EG=$EM.bitmap.height;this.save(),1!=$Ex&&(this.globalAlpha*=$Ex),$Eq?(this.transform($Eq.a,$Eq.b,$Eq.c,$Eq.d,$Eq.tx+$EH,$Eq.ty+$ET),this.drawImage($EM.source,$EO[0]*$Eu,$EO[1]*$EG,($EO[2]-$EO[0])*$Eu,($EO[5]-$EO[3])*$EG,$Ee,$EL,$E_,$Ec)):this.drawImage($EM.source,$EO[0]*$Eu,$EO[1]*$EG,($EO[2]-$EO[0])*$Eu,($EO[5]-$EO[3])*$EG,$Ee+$EH,$EL+$ET,$E_,$Ec),this.restore()},$EM.drawTexture2=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){var $Ex=$ET[0];if($Ex.loaded&&$Ex.bitmap&&$Ex.source){$EZ.drawCall++;var $EO=1!==$Eq;if($EO){var $Eu=this.globalAlpha;this.globalAlpha*=$Eq}var $EG=$Ex.uv,$EV=$Ex.bitmap.width,$EE=$Ex.bitmap.height;$Ec?(this.save(),this.transform($Ec.a,$Ec.b,$Ec.c,$Ec.d,$Ec.tx+$EM,$Ec.ty+$Ee),this.drawImage($Ex.source,$EG[0]*$EV,$EG[1]*$EE,($EG[2]-$EG[0])*$EV,($EG[5]-$EG[3])*$EE,$ET[1]-$EL,$ET[2]-$E_,$ET[3],$ET[4]),this.restore()):this.drawImage($Ex.source,$EG[0]*$EV,$EG[1]*$EE,($EG[2]-$EG[0])*$EV,($EG[5]-$EG[3])*$EE,$ET[1]-$EL+$EM,$ET[2]-$E_+$Ee,$ET[3],$ET[4]),$EO&&(this.globalAlpha=$Eu)}},$EM.fillTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){if(!$ET.pat){if($EM.uv!=$EuM.DEF_UV){var $Ex=new $EXM("2D");$Ex.getContext("2d"),$Ex.size($EM.width,$EM.height),$Ex.context.drawTexture($EM,0,0,$EM.width,$EM.height,0,0),$EM=new $EuM($Ex)}$ET.pat=this.createPattern($EM.bitmap.source,$Eq)}var $EO=$Ee,$Eu=$EL,$EG=0,$EV=0;$EH&&($EO+=$EH.x%$EM.width,$Eu+=$EH.y%$EM.height,$EG-=$EH.x%$EM.width,$EV-=$EH.y%$EM.height),this.translate($EO,$Eu),this.fillRect($EG,$EV,$E_,$Ec,$ET.pat),this.translate(-$EO,-$Eu)},$EM.drawTriangle=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){var $Ex=$EM.bitmap,$EO=$Ex.source,$Eu=$EM.width,$EG=$EM.height,$EV=$Ex.width,$EE=$Ex.height,$Ed=$EL[$E_]*$EV,$Er=$EL[$Ec]*$EV,$E$=$EL[$Eq]*$EV,$EC=$EL[$E_+1]*$EE,$EK=$EL[$Ec+1]*$EE,$EX=$EL[$Eq+1]*$EE,$Eo=$Ee[$E_],$Ei=$Ee[$Ec],$EW=$Ee[$Eq],$Ey=$Ee[$E_+1],$EA=$Ee[$Ec+1],$EB=$Ee[$Eq+1];if($ET){var $Ek=($Eo+$Ei+$EW)/3,$Eh=($Ey+$EA+$EB)/3,$Et=$Eo-$Ek,$ES=$Ey-$Eh,$Ep=Math.sqrt($Et*$Et+$ES*$ES);$Eo=$Ek+$Et/$Ep*($Ep+1),$Ey=$Eh+$ES/$Ep*($Ep+1),$ES=$EA-$Eh,$Ei=$Ek+($Et=$Ei-$Ek)/($Ep=Math.sqrt($Et*$Et+$ES*$ES))*($Ep+1),$EA=$Eh+$ES/$Ep*($Ep+1),$ES=$EB-$Eh,$EW=$Ek+($Et=$EW-$Ek)/($Ep=Math.sqrt($Et*$Et+$ES*$ES))*($Ep+1),$EB=$Eh+$ES/$Ep*($Ep+1)}this.save(),$EH&&this.transform($EH.a,$EH.b,$EH.c,$EH.d,$EH.tx,$EH.ty),this.beginPath(),this.moveTo($Eo,$Ey),this.lineTo($Ei,$EA),this.lineTo($EW,$EB),this.closePath(),this.clip();var $ER=1/($Ed*$EK+$EC*$E$+$Er*$EX-$EK*$E$-$EC*$Er-$Ed*$EX),$Ea=$Eo*$EK+$EC*$EW+$Ei*$EX-$EK*$EW-$EC*$Ei-$Eo*$EX,$En=$Ed*$Ei+$Eo*$E$+$Er*$EW-$Ei*$E$-$Eo*$Er-$Ed*$EW,$El=$Ed*$EK*$EW+$EC*$Ei*$E$+$Eo*$Er*$EX-$Eo*$EK*$E$-$EC*$Er*$EW-$Ed*$Ei*$EX,$Ef=$Ey*$EK+$EC*$EB+$EA*$EX-$EK*$EB-$EC*$EA-$Ey*$EX,$Ej=$Ed*$EA+$Ey*$E$+$Er*$EB-$EA*$E$-$Ey*$Er-$Ed*$EB,$EF=$Ed*$EK*$EB+$EC*$EA*$E$+$Ey*$Er*$EX-$Ey*$EK*$E$-$EC*$Er*$EB-$Ed*$EA*$EX;this.transform($Ea*$ER,$Ef*$ER,$En*$ER,$Ej*$ER,$El*$ER,$EF*$ER),this.drawImage($EO,$EM.uv[0]*$EV,$EM.uv[1]*$EE,$Eu,$EG,$EM.uv[0]*$EV,$EM.uv[1]*$EE,$Eu,$EG),this.restore()},$EM.flush=function(){return 0},$EM.fillWords=function($EM,$Ee,$EL,$E_,$Ec,$Eq){$E_&&(this.font=$E_),$Ec&&(this.fillStyle=$Ec);this.textBaseline="top",this.textAlign="left";for(var $EH=0,$ET=$EM.length;$EH<$ET;$EH++){var $Ex=$EM[$EH];if(this.__fillText($Ex.char,$Ex.x+$Ee,$Ex.y+$EL),1===$Eq){var $EO=$Ex.height,$Eu=.5*$Ex.style.letterSpacing;$Eu||($Eu=0),this.beginPath(),this.strokeStyle=$Ec,this.lineWidth=1,this.moveTo($Ee+$Ex.x-$Eu+.5,$EL+$Ex.y+$EO+.5),this.lineTo($Ee+$Ex.x+$Ex.width+$Eu+.5,$EL+$Ex.y+$EO+.5),this.stroke()}}},$EM.fillBorderWords=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$E_&&(this.font=$E_),$Ec&&(this.fillStyle=$Ec),this.textBaseline="top",this.lineWidth=$EH,this.textAlign="left",this.strokeStyle=$Eq;for(var $ET=0,$Ex=$EM.length;$ET<$Ex;$ET++){var $EO=$EM[$ET];this.__strokeText($EO.char,$EO.x+$Ee,$EO.y+$EL),this.__fillText($EO.char,$EO.x+$Ee,$EO.y+$EL)}},$EM.destroy=function(){this.canvas.width=this.canvas.height=0},$EM.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$EM.drawCurves=function($EM,$Ee,$EL){this.beginPath(),this.strokeStyle=$EL[3],this.lineWidth=$EL[4];var $E_=$EL[2];$EM+=$EL[0],$Ee+=$EL[1],this.moveTo($EM+$E_[0],$Ee+$E_[1]);for(var $Ec=2,$Eq=$E_.length;$Ec<$Eq;)this.quadraticCurveTo($EM+$E_[$Ec++],$Ee+$E_[$Ec++],$EM+$E_[$Ec++],$Ee+$E_[$Ec++]);this.stroke()},$ET.__init__=function($Ee){var $EL=laya.resource.Context.prototype;if(!($Ee=$Ee||CanvasRenderingContext2D.prototype).inited){$Ee.inited=!0,$Ee.__fillText=$Ee.fillText,$Ee.__fillRect=$Ee.fillRect,$Ee.__strokeText=$Ee.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($EM){$Ee[$EM]=$EL[$EM]})}},$ET.replaceCanvasGetSet=function($EM,$Ee){var $EL=Object.getOwnPropertyDescriptor($EM,$Ee);if(!$EL||!$EL.configurable)return!1;var $E_,$Ec={};for($E_ in $EL)"set"!=$E_&&($Ec[$E_]=$EL[$E_]);var $Eq=$EL.set;return $Ec.set=function($EM){$Eq.call(this,$EM);var $Ee=this.getContext("2d");$Ee&&"__reset"in $Ee&&$Ee.__reset()},Object.defineProperty($EM,$Ee,$Ec),!0},$ET.replaceGetSet=function($EM,$Ee){var $EL=Object.getOwnPropertyDescriptor($EM,$Ee);if(!$EL||!$EL.configurable)return!1;var $E_,$Ec={};for($E_ in $EL)"set"!=$E_&&($Ec[$E_]=$EL[$E_]);var $Eq=$EL.set,$EH="___"+$Ee+"__";return $ET.newKeys.push($EH),$Ec.set=function($EM){$EM!=this[$EH]&&(this[$EH]=$EM,$Eq.call(this,$EM))},Object.defineProperty($EM,$Ee,$Ec),!0},$ET._default=new $ET,$ET.newKeys=[],$Ex($ET,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$ET}(),$EF=function(){function $Eq($EM){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$Eq._uniqueIDCounter,this._name=$EM||"Content Manager",$Eq._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$Eq._resourceManagers.push(this),this._resources=[],this._records={}}$Eu($Eq,"laya.resource.ResourceManager");var $EM=$Eq.prototype;return $Ey.imps($EM,{"laya.resource.IDispose":!0}),$EM.getResourceByIndex=function($EM){return this._resources[$EM]},$EM.getResourcesLength=function(){return this._resources.length},$EM.addResource=function($EM){return $EM.resourceManager&&$EM.resourceManager.removeResource($EM),-1===this._resources.indexOf($EM)&&(($EM._resourceManager=this)._resources.push($EM),this.addRecord($EM.uri,$EM.__className,$EM.memorySize),this.addSize($EM.memorySize),!0)},$EM.removeResource=function($EM){var $Ee=this._resources.indexOf($EM);return-1!==$Ee&&(this._resources.splice($Ee,1),$EM._resourceManager=null,this._memorySize-=$EM.memorySize,this.addRecord($EM.uri,$EM.__className,-$EM.memorySize),!0)},$EM.unload=function(){for(var $EM=this._resources.slice(0,this._resources.length),$Ee=0;$Ee<$EM.length;$Ee++){$EM[$Ee].destroy()}$EM.length=0},$EM.dispose=function(){if(this===$Eq._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$Eq._resourceManagers.splice($Eq._resourceManagers.indexOf(this),1),$Eq._isResourceManagersSorted=!1;for(var $EM=this._resources.slice(0,this._resources.length),$Ee=0;$Ee<$EM.length;$Ee++){var $EL=$EM[$Ee];$EL.resourceManager.removeResource($EL),$EL.destroy()}$EM.length=0},$EM.addSize=function($EM){$EM&&(this.autoRelease&&0<$EM&&this._memorySize+$EM>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$EM)},$EM.addRecord=function($EM,$Ee,$EL){DEBUG&&$EL&&!$EM&&console.error($EM,$Ee,$EL),$EM&&(this._records.hasOwnProperty($Ee+"|"+$EM)||(this._records[$Ee+"|"+$EM]=0),this._records[$Ee+"|"+$EM]+=$EL,DEBUG&&this._records[$Ee+"|"+$EM]<0&&console.error($EM,$Ee,this._records[$Ee+"|"+$EM]))},$EM.garbageCollection=function($EM){var $Ee=this._resources;($Ee=$Ee.slice()).sort(function($EM,$Ee){if(!$EM||!$Ee)throw new Error("a或b不能为空！");return $EM.released&&$Ee.released?0:$EM.released?1:$Ee.released?-1:$EM._lastUseFrameCount-$Ee._lastUseFrameCount});for(var $EL=$EZ.loopCount,$E_=0,$Ec=$Ee.length;$E_<$Ec;$E_++){var $Eq=$Ee[$E_];if(!(1<$EL-$Eq._lastUseFrameCount))return void(this._memorySize>=$EM&&(this._isOverflow=!0));if($Eq.releaseResource(),this._memorySize<$EM)return void(this._isOverflow=!1)}},$Ed(0,$EM,"id",function(){return this._id}),$Ed(0,$EM,"name",function(){return this._name},function($EM){!$EM&&""===$EM||this._name===$EM||(this._name=$EM,$Eq._isResourceManagersSorted=!1)}),$Ed(0,$EM,"memorySize",function(){return this._memorySize}),$Ed(0,$EM,"records",function(){return this._records}),$Ed(1,$Eq,"systemResourceManager",function(){return $Eq._systemResourceManager}),$Eq.__init__=function(){$Eq.currentResourceManager=$Eq.systemResourceManager},$Eq.getLoadedResourceManagerByIndex=function($EM){return $Eq._resourceManagers[$EM]},$Eq.getLoadedResourceManagersCount=function(){return $Eq._resourceManagers.length},$Eq.recreateContentManagers=function($EM){void 0===$EM&&($EM=!1);for(var $Ee=$Eq.currentResourceManager,$EL=0;$EL<$Eq._resourceManagers.length;$EL++){$Eq.currentResourceManager=$Eq._resourceManagers[$EL];for(var $E_=0;$E_<$Eq.currentResourceManager._resources.length;$E_++)$Eq.currentResourceManager._resources[$E_].releaseResource($EM),$Eq.currentResourceManager._resources[$E_].activeResource($EM)}$Eq.currentResourceManager=$Ee},$Eq.releaseContentManagers=function($EM){void 0===$EM&&($EM=!1);for(var $Ee=$Eq.currentResourceManager,$EL=0;$EL<$Eq._resourceManagers.length;$EL++){$Eq.currentResourceManager=$Eq._resourceManagers[$EL];for(var $E_=0;$E_<$Eq.currentResourceManager._resources.length;$E_++){var $Ec=$Eq.currentResourceManager._resources[$E_];!$Ec.released&&$Ec.releaseResource($EM)}}$Eq.currentResourceManager=$Ee},$Eq._uniqueIDCounter=0,$Eq._isResourceManagersSorted=!1,$Eq._resourceManagers=[],$Ex($Eq,["_systemResourceManager",function(){return this._systemResourceManager=new $Eq("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$Eq._systemResourceManager}]),$Eq}(),$Eg=(function(){function $EM(){}$Eu($EM,"laya.system.System"),$EM.changeDefinition=function($EM,$Ee){$Ey[$EM]=$Ee;var $EL=$EM+"=classObj";$Ey._runScript($EL)},$EM.__init__=function(){$En.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $EL(){}return $Eu($EL,"laya.utils.Browser"),$Ed(1,$EL,"pixelRatio",function(){return $EL.__init__(),-1<$EL.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$ES.getPixelRatio()}),$Ed(1,$EL,"height",function(){return $EL.__init__(),($Ey.stage&&$Ey.stage.canvasRotation?$EL.clientWidth:$EL.clientHeight)*$EL.pixelRatio}),$Ed(1,$EL,"clientWidth",function(){return $EL.__init__(),$EL.window.innerWidth||$EL.document.body.clientWidth}),$Ed(1,$EL,"window",function(){return $EL.__init__(),$EL._window}),$Ed(1,$EL,"clientHeight",function(){return $EL.__init__(),$EL.window.innerHeight||$EL.document.body.clientHeight||$EL.document.documentElement.clientHeight}),$Ed(1,$EL,"width",function(){return $EL.__init__(),($Ey.stage&&$Ey.stage.canvasRotation?$EL.clientHeight:$EL.clientWidth)*$EL.pixelRatio}),$Ed(1,$EL,"container",function(){return $EL.__init__(),$EL._container||(($EL._container=$EL.createElement("div")).id="layaContainer",$EL.document.body.appendChild($EL._container)),$EL._container},function($EM){$EL._container=$EM}),$Ed(1,$EL,"document",function(){return $EL.__init__(),$EL._document}),$EL.__init__=function(){if(!$EL._window){$EL._window=$ES.getWindow(),$EL._document=$EL.window.document,$EL._window.addEventListener("message",function($EM){laya.utils.Browser._onMessage($EM)},!1),$EL.document.__createElement=$EL.document.createElement,$EH.requestAnimationFrame=$EH.requestAnimationFrame||$EH.webkitRequestAnimationFrame||$EH.mozRequestAnimationFrame||$EH.oRequestAnimationFrame||$EH.msRequestAnimationFrame||function($EM){return $EH.setTimeout($EM,1e3/60)};var $EM=$EH.document.body.style;$EM["-webkit-user-select"]="none",$EM["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$EL.userAgent=$EL.window.navigator.userAgent,$EL.onIOS=!!($EL.u=$EL.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$EL.onMobile=-1<$EL.u.indexOf("Mobile"),$EL.onIPhone=-1<$EL.u.indexOf("iPhone"),$EL.onMac=-1<$EL.u.indexOf("Mac OS X"),$EL.onIPad=-1<$EL.u.indexOf("iPad"),$EL.onAndroid=-1<$EL.u.indexOf("Android")||-1<$EL.u.indexOf("Adr"),$EL.onWP=-1<$EL.u.indexOf("Windows Phone"),$EL.onQQBrowser=-1<$EL.u.indexOf("QQBrowser"),$EL.onMQQBrowser=-1<$EL.u.indexOf("MQQBrowser")||-1<$EL.u.indexOf("Mobile")&&-1<$EL.u.indexOf("QQ"),$EL.onIE=!!$EL.window.ActiveXObject||"ActiveXObject"in $EL.window,$EL.onWeiXin=-1<$EL.u.indexOf("MicroMessenger"),$EL.onPC=!$EL.onMobile,$EL.onSafari=-1<$EL.u.indexOf("Safari"),$EL.onFirefox=-1<$EL.u.indexOf("Firefox"),$EL.onEdge=-1<$EL.u.indexOf("Edge"),$EL.onMiniGame=-1<$EL.u.indexOf("MiniGame"),$EL.onLimixiu=-1<$EL.u.indexOf("limixiu"),$EL.httpProtocol="http:"==$EL.window.location.protocol,$EL.onMiniGame&&null==$EL.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$EL.webAudioEnabled=!!($EL.window.AudioContext||$EL.window.webkitAudioContext||$EL.window.mozAudioContext),$EL.soundType=$EL.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$EcM=$EL.webAudioEnabled?$EqM:$ELM,$EL.webAudioEnabled&&$EqM.initWebAudio(),$ELM._initMusicAudio(),$EL.enableTouch="ontouchstart"in $EH||$EH.DocumentTouch&&$Ee instanceof DocumentTouch,$EH.focus(),$Et._soundClass=$EcM,$Et._musicClass=$ELM,$En._mainCanvas=$En._mainCanvas||$EXM.create("2D"),$EL.canvas||($EL.canvas=$EXM.create("2D"),$EL.context=$EL.canvas.getContext("2d"))}},$EL._onMessage=function($EM){if($EM.data&&"size"==$EM.data.name){if($EL.window.innerWidth=$EM.data.width,$EL.window.innerHeight=$EM.data.height,$EL.window.__innerHeight=$EM.data.clientHeight,!$EL.document.createEvent)return void console.warn("no document.createEvent");var $Ee=$EL.document.createEvent("HTMLEvents");return $Ee.initEvent("resize",!1,!1),void $EL.window.dispatchEvent($Ee)}},$EL.createElement=function($EM){return $EL.__init__(),$EL.document.__createElement($EM)},$EL.getElementById=function($EM){return $EL.__init__(),$EL.document.getElementById($EM)},$EL.removeElement=function($EM){$EM&&$EM.parentNode&&$EM.parentNode.removeChild($EM)},$EL.now=function(){return $ES.now()},$EL._window=null,$EL._document=null,$EL._container=null,$EL.userAgent=null,$EL.u=null,$EL.onIOS=!1,$EL.onMac=!1,$EL.onMobile=!1,$EL.onIPhone=!1,$EL.onIPad=!1,$EL.onAndroid=!1,$EL.onWP=!1,$EL.onQQBrowser=!1,$EL.onMQQBrowser=!1,$EL.onSafari=!1,$EL.onFirefox=!1,$EL.onEdge=!1,$EL.onIE=!1,$EL.onWeiXin=!1,$EL.onMiniGame=!1,$EL.onLimixiu=!1,$EL.onPC=!1,$EL.httpProtocol=!1,$EL.webAudioEnabled=!1,$EL.soundType=null,$EL.enableTouch=!1,$EL.canvas=null,$EL.context=null,$EL.__init$=function(){},$EL}()),$EJ=function(){function $Ee($EM){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$EM?(this._u8d_=new Uint8Array($EM),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$Eu($Ee,"laya.utils.Byte");var $EM=$Ee.prototype;return $EM.___resizeBuffer=function($Ee){try{var $EM=new Uint8Array($Ee);null!=this._u8d_&&(this._u8d_.length<=$Ee?$EM.set(this._u8d_):$EM.set(this._u8d_.subarray(0,$Ee))),this._u8d_=$EM,this._d_=new DataView($EM.buffer)}catch($EM){throw"___resizeBuffer err:"+$Ee}},$EM.getString=function(){return this.rUTF(this.getUint16())},$EM.getFloat32Array=function($EM,$Ee){var $EL=$EM+$Ee;$EL=$EL>this._length?this._length:$EL;var $E_=new Float32Array(this._d_.buffer.slice($EM,$EL));return this._pos_=$EL,$E_},$EM.getUint8Array=function($EM,$Ee){var $EL=$EM+$Ee;$EL=$EL>this._length?this._length:$EL;var $E_=new Uint8Array(this._d_.buffer.slice($EM,$EL));return this._pos_=$EL,$E_},$EM.getInt16Array=function($EM,$Ee){var $EL=$EM+$Ee;$EL=$EL>this._length?this._length:$EL;var $E_=new Int16Array(this._d_.buffer.slice($EM,$EL));return this._pos_=$EL,$E_},$EM.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $EM=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$EM},$EM.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $EM=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$EM},$EM.writeFloat32=function($EM){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$EM,this._xd_),this._pos_+=4},$EM.writeFloat64=function($EM){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$EM,this._xd_),this._pos_+=8},$EM.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $EM=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$EM},$EM.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $EM=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$EM},$EM.writeInt32=function($EM){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$EM,this._xd_),this._pos_+=4},$EM.writeUint32=function($EM){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$EM,this._xd_),this._pos_+=4},$EM.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $EM=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$EM},$EM.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $EM=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$EM},$EM.writeUint16=function($EM){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$EM,this._xd_),this._pos_+=2},$EM.writeInt16=function($EM){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$EM,this._xd_),this._pos_+=2},$EM.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$EM.writeUint8=function($EM){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$EM),this._pos_++},$EM._getUInt8=function($EM){return this._d_.getUint8($EM)},$EM._getUint16=function($EM){return this._d_.getUint16($EM,this._xd_)},$EM._getMatrix=function(){return new $Ep(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$EM.rUTF=function($EM){for(var $Ee=[],$EL=this._pos_+$EM,$E_=0,$Ec=0,$Eq=0,$EH=String.fromCharCode,$ET=this._u8d_;this._pos_<$EL;)($E_=$ET[this._pos_++])<128?0!=$E_&&$Ee.push($EH($E_)):$E_<224?$Ee.push($EH((63&$E_)<<6|127&$ET[this._pos_++])):$E_<240?($Ec=$ET[this._pos_++],$Ee.push($EH((31&$E_)<<12|(127&$Ec)<<6|127&$ET[this._pos_++]))):($Ec=$ET[this._pos_++],$Eq=$ET[this._pos_++],$Ee.push($EH((15&$E_)<<18|(127&$Ec)<<12|$Eq<<6&127|127&$ET[this._pos_++]))),0;return $Ee.join("")},$EM.getCustomString=function($EM){for(var $Ee=[],$EL=0,$E_=0,$Ec=0,$Eq=String.fromCharCode,$EH=this._u8d_;0<$EM;)if(($E_=$EH[this._pos_])<128)$Ee.push($Eq($E_)),this._pos_++,$EM--;else for($EL=$E_-128,this._pos_++,$EM-=$EL;0<$EL;)$E_=$EH[this._pos_++],$Ec=$EH[this._pos_++],$Ee.push($Eq($Ec<<8|$E_)),$EL--;return $Ee.join("")},$EM.clear=function(){this._pos_=0,this.length=0},$EM.__getBuffer=function(){return this._d_.buffer},$EM.writeUTFBytes=function($EM){for(var $Ee=0,$EL=($EM+="").length;$Ee<$EL;$Ee++){var $E_=$EM.charCodeAt($Ee);$E_<=127?this.writeByte($E_):$E_<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$E_>>6,128|63&$E_],this._pos_),this._pos_+=2):$E_<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$E_>>12,128|$E_>>6&63,128|63&$E_],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$E_>>18,128|$E_>>12&63,128|$E_>>6&63,128|63&$E_],this._pos_),this._pos_+=4)}},$EM.writeUTFString=function($EM){var $Ee=this.pos;this.writeUint16(1),this.writeUTFBytes($EM);var $EL=this.pos-$Ee-2;if(65536<=$EL)throw"writeUTFString byte len more than 65536";this._d_.setUint16($Ee,$EL,this._xd_)},$EM.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$EM.getUTFString=function(){return this.readUTFString()},$EM.readUTFBytes=function($EM){if(void 0===$EM&&($EM=-1),0==$EM)return"";var $Ee=this.bytesAvailable;if($Ee<$EM)throw"readUTFBytes error - Out of bounds";return $EM=0<$EM?$EM:$Ee,this.rUTF($EM)},$EM.getUTFBytes=function($EM){return void 0===$EM&&($EM=-1),this.readUTFBytes($EM)},$EM.writeByte=function($EM){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$EM),this._pos_+=1},$EM.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$EM.getByte=function(){return this.readByte()},$EM.ensureWrite=function($EM){this._length<$EM&&(this._length=$EM),this._allocated_<$EM&&(this.length=$EM)},$EM.writeArrayBuffer=function($EM,$Ee,$EL){if(void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),$Ee<0||$EL<0)throw"writeArrayBuffer error - Out of bounds";0==$EL&&($EL=$EM.byteLength-$Ee),this.ensureWrite(this._pos_+$EL);var $E_=new Uint8Array($EM);this._u8d_.set($E_.subarray($Ee,$Ee+$EL),this._pos_),this._pos_+=$EL},$Ed(0,$EM,"buffer",function(){var $EM=this._d_.buffer;return $EM.byteLength==this.length?$EM:$EM.slice(0,this.length)}),$Ed(0,$EM,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($EM){this._xd_="littleEndian"==$EM}),$Ed(0,$EM,"length",function(){return this._length},function($EM){this._allocated_<$EM?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($EM,2*this._allocated_))):this._allocated_>$EM&&this.___resizeBuffer(this._allocated_=$EM),this._length=$EM}),$Ed(0,$EM,"pos",function(){return this._pos_},function($EM){this._pos_=$EM}),$Ed(0,$EM,"bytesAvailable",function(){return this._length-this._pos_}),$Ee.getSystemEndian=function(){if(!$Ee._sysEndian){var $EM=new ArrayBuffer(2);new DataView($EM).setInt16(0,256,!0),$Ee._sysEndian=256===new Int16Array($EM)[0]?"littleEndian":"bigEndian"}return $Ee._sysEndian},$Ee.BIG_ENDIAN="bigEndian",$Ee.LITTLE_ENDIAN="littleEndian",$Ee._sysEndian=null,$Ee}(),$Ew=function(){function $Ec(){}return $Eu($Ec,"laya.utils.CacheManager"),$Ec.regCacheByFunction=function($EM,$Ee){var $EL;$Ec.unRegCacheByFunction($EM,$Ee),$EL={tryDispose:$EM,getCacheList:$Ee},$Ec._cacheList.push($EL)},$Ec.unRegCacheByFunction=function($EM,$Ee){var $EL,$E_=0;for($EL=$Ec._cacheList.length,$E_=0;$E_<$EL;$E_++)if($Ec._cacheList[$E_].tryDispose==$EM&&$Ec._cacheList[$E_].getCacheList==$Ee)return void $Ec._cacheList.splice($E_,1)},$Ec.forceDispose=function(){var $EM=0,$Ee=$Ec._cacheList.length;for($EM=0;$EM<$Ee;$EM++)$Ec._cacheList[$EM].tryDispose(!0)},$Ec.beginCheck=function($EM){void 0===$EM&&($EM=15e3),$Ey.timer.loop($EM,null,$Ec._checkLoop)},$Ec.stopCheck=function(){$Ey.timer.clear(null,$Ec._checkLoop)},$Ec._checkLoop=function(){var $EM=$Ec._cacheList;if(!($EM.length<1)){var $Ee,$EL=$Eg.now(),$E_=0;for($Ee=$E_=$EM.length;0<$E_&&($EM[$Ec._index=++$Ec._index%$Ee].tryDispose(!1),!($Eg.now()-$EL>$Ec.loopTimeLimit));)$E_--}},$Ec.loopTimeLimit=2,$Ec._cacheList=[],$Ec._index=0,$Ec}(),$Eb=function(){function $EE(){}return $Eu($EE,"laya.utils.ClassUtils"),$EE.regClass=function($EM,$Ee){$EE._classMap[$EM]=$Ee},$EE.getRegClass=function($EM){return $EE._classMap[$EM]},$EE.getInstance=function($EM){var $Ee=$EE.getClass($EM);return $Ee?new $Ee:(console.warn("[error] Undefined class:",$EM),null)},$EE.createByJson=function($EM,$Ee,$EL,$E_,$Ec){"string"==typeof $EM&&($EM=JSON.parse($EM));var $Eq=$EM.props;if(!$Ee&&!($Ee=$Ec?$Ec.runWith($EM):$EE.getInstance($Eq.runtime||$EM.type)))return null;var $EH=$EM.child;if($EH)for(var $ET=0,$Ex=$EH.length;$ET<$Ex;$ET++){var $EO=$EH[$ET];if("render"!==$EO.props.name&&"render"!==$EO.props.renderType||!$Ee._$set_itemRender)if("Graphic"==$EO.type)$EE.addGraphicsToSprite($EO,$Ee);else if($EE.isDrawType($EO.type))$EE.addGraphicToSprite($EO,$Ee,!0);else{var $Eu=$EE.createByJson($EO,null,$EL,$E_,$Ec);"Script"==$EO.type?$Eu.hasOwnProperty("owner")?$Eu.owner=$Ee:$Eu.hasOwnProperty("target")&&($Eu.target=$Ee):"mask"==$EO.props.renderType?$Ee.mask=$Eu:$Ee.addChild($Eu)}else $Ee.itemRender=$EO}if($Eq)for(var $EG in $Eq){var $EV=$Eq[$EG];"var"===$EG&&$EL?$EL[$EV]=$Ee:$EV instanceof Array&&"function"==typeof $Ee[$EG]?$Ee[$EG].apply($Ee,$EV):$Ee[$EG]=$EV}return $E_&&$EM.customProps&&$E_.runWith([$Ee,$EM]),$Ee.created&&$Ee.created(),$Ee},$EE.addGraphicsToSprite=function($EM,$Ee){var $EL;if(($EL=$EM.child)&&!($EL.length<1)){var $E_;$E_=$EE._getGraphicsFromSprite($EM,$Ee);var $Ec=0,$Eq=0;$EM.props&&($Ec=$EE._getObjVar($EM.props,"x",0),$Eq=$EE._getObjVar($EM.props,"y",0)),0!=$Ec&&0!=$Eq&&$E_.translate($Ec,$Eq);var $EH,$ET=0;for($EH=$EL.length,$ET=0;$ET<$EH;$ET++)$EE._addGraphicToGraphics($EL[$ET],$E_);0!=$Ec&&0!=$Eq&&$E_.translate(-$Ec,-$Eq)}},$EE.addGraphicToSprite=function($EM,$Ee,$EL){var $E_;void 0===$EL&&($EL=!1),$E_=$EL?$EE._getGraphicsFromSprite($EM,$Ee):$Ee.graphics,$EE._addGraphicToGraphics($EM,$E_)},$EE._getGraphicsFromSprite=function($EM,$Ee){var $EL,$E_;if(!$EM||!$EM.props)return $Ee.graphics;switch($E_=$EM.props.renderType){case"hit":case"unHit":var $Ec;$Ee.hitArea||($Ee.hitArea=new $EY),($Ec=$Ee.hitArea)[$E_]||($Ec[$E_]=new $EV),$EL=$Ec[$E_]}return $EL||($EL=$Ee.graphics),$EL},$EE._getTransformData=function($EM){var $Ee;($EM.hasOwnProperty("pivotX")||$EM.hasOwnProperty("pivotY"))&&($Ee=$Ee||new $Ep).translate(-$EE._getObjVar($EM,"pivotX",0),-$EE._getObjVar($EM,"pivotY",0));var $EL=$EE._getObjVar($EM,"scaleX",1),$E_=$EE._getObjVar($EM,"scaleY",1),$Ec=$EE._getObjVar($EM,"rotation",0);$EE._getObjVar($EM,"skewX",0),$EE._getObjVar($EM,"skewY",0);return 1==$EL&&1==$E_&&0==$Ec||(($Ee=$Ee||new $Ep).scale($EL,$E_),$Ee.rotate(.0174532922222222*$Ec)),$Ee},$EE._addGraphicToGraphics=function($EM,$Ee){var $EL,$E_;if(($EL=$EM.props)&&($E_=$EE.DrawTypeDic[$EM.type])){var $Ec,$Eq;$Ec=$Ee;var $EH=$EE._getParams($EL,$E_[1],$E_[2],$E_[3]);(($Eq=$EE._tM)||1!=$EE._alpha)&&($Ec.save(),$Eq&&$Ec.transform($Eq),1!=$EE._alpha&&$Ec.alpha($EE._alpha)),$Ec[$E_[0]].apply($Ec,$EH),($Eq||1!=$EE._alpha)&&$Ec.restore()}},$EE._adptLineData=function($EM){return $EM[2]=parseFloat($EM[0])+parseFloat($EM[2]),$EM[3]=parseFloat($EM[1])+parseFloat($EM[3]),$EM},$EE._adptTextureData=function($EM){return $EM[0]=$ETM.getRes($EM[0]),$EM},$EE._adptLinesData=function($EM){return $EM[2]=$EE._getPointListByStr($EM[2]),$EM},$EE.isDrawType=function($EM){return"Image"!=$EM&&$EE.DrawTypeDic.hasOwnProperty($EM)},$EE._getParams=function($EM,$Ee,$EL,$E_){var $Ec;void 0===$EL&&($EL=0),($Ec=$EE._temParam).length=$Ee.length;var $Eq,$EH,$ET=0;for($Eq=$Ee.length,$ET=0;$ET<$Eq;$ET++)$Ec[$ET]=$EE._getObjVar($EM,$Ee[$ET][0],$Ee[$ET][1]);return $EE._alpha=$EE._getObjVar($EM,"alpha",1),$EH=$EE._getTransformData($EM),$EE._tM=$EH?($EL||($EL=0),$EH.translate($Ec[$EL],$Ec[$EL+1]),$Ec[$EL]=$Ec[$EL+1]=0,$EH):null,$E_&&$EE[$E_]&&($Ec=$EE[$E_]($Ec)),$Ec},$EE._getPointListByStr=function($EM){var $Ee,$EL,$E_=0;for($EL=($Ee=$EM.split(",")).length,$E_=0;$E_<$EL;$E_++)$Ee[$E_]=parseFloat($Ee[$E_]);return $Ee},$EE._getObjVar=function($EM,$Ee,$EL){return $EM.hasOwnProperty($Ee)?$EM[$Ee]:$EL},$EE._temParam=[],$EE._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$EE.getClass=function($EM){var $Ee=$EE._classMap[$EM]||$EM;return"string"==typeof $Ee?$Ey.__classmap[$Ee]:$Ee},$EE._tM=null,$EE._alpha=NaN,$Ex($EE,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$EE}(),$Em=function(){function $Eq($EM){if(this._color=[],"string"==typeof $EM){null===(this.strColor=$EM)&&($EM="#000000"),"#"==$EM.charAt(0)&&($EM=$EM.substr(1));var $Ee=$EM.length;if(3==$Ee||4==$Ee){for(var $EL="",$E_=0;$E_<$Ee;$E_++)$EL+=$EM[$E_]+$EM[$E_];$EM=$EL}var $Ec=this.numColor=parseInt($EM,16);if(8==$EM.length)return void(this._color=[parseInt($EM.substr(0,2),16)/255,((16711680&$Ec)>>16)/255,((65280&$Ec)>>8)/255,(255&$Ec)/255])}else $Ec=this.numColor=$EM,this.strColor=$Es.toHexColor($Ec);this._color=[((16711680&$Ec)>>16)/255,((65280&$Ec)>>8)/255,(255&$Ec)/255,1],this._color.__id=++$Eq._COLODID}return $Eu($Eq,"laya.utils.Color"),$Eq._initDefault=function(){for(var $EM in $Eq._DEFAULT={},$Eq._COLOR_MAP)$Eq._SAVE[$EM]=$Eq._DEFAULT[$EM]=new $Eq($Eq._COLOR_MAP[$EM]);return $Eq._DEFAULT},$Eq._initSaveMap=function(){for(var $EM in $Eq._SAVE_SIZE=0,$Eq._SAVE={},$Eq._DEFAULT)$Eq._SAVE[$EM]=$Eq._DEFAULT[$EM]},$Eq.create=function($EM){var $Ee=$Eq._SAVE[$EM+""];return null!=$Ee?$Ee:($Eq._SAVE_SIZE<1e3||$Eq._initSaveMap(),$Eq._SAVE[$EM+""]=new $Eq($EM))},$Eq._SAVE={},$Eq._SAVE_SIZE=0,$Eq._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$Eq._DEFAULT=$Eq._initDefault(),$Eq._COLODID=1,$Eq}(),$Ez=(function(){function $EM(){this._values=[],this._keys=[]}$Eu($EM,"laya.utils.Dictionary");var $Ee=$EM.prototype;$Ee.set=function($EM,$Ee){var $EL=this.indexOf($EM);0<=$EL?this._values[$EL]=$Ee:(this._keys.push($EM),this._values.push($Ee))},$Ee.indexOf=function($EM){var $Ee=this._keys.indexOf($EM);return 0<=$Ee?$Ee:($EM="string"==typeof $EM?Number($EM):"number"==typeof $EM?$EM.toString():$EM,this._keys.indexOf($EM))},$Ee.get=function($EM){var $Ee=this.indexOf($EM);return $Ee<0?null:this._values[$Ee]},$Ee.remove=function($EM){var $Ee=this.indexOf($EM);return 0<=$Ee&&(this._keys.splice($Ee,1),this._values.splice($Ee,1),!0)},$Ee.clear=function(){this._values.length=0,this._keys.length=0},$Ed(0,$Ee,"values",function(){return this._values}),$Ed(0,$Ee,"keys",function(){return this._keys})}(),function(){function $EM(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$Eu($EM,"laya.utils.Dragging");var $Ee=$EM.prototype;return $Ee.start=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){void 0===$ET&&($ET=.92),this.clearTimer(),this.target=$EM,this.area=$Ee,this.hasInertia=$EL,this.elasticDistance=$Ee?$E_:0,this.elasticBackTime=$Ec,this.data=$Eq,this._disableMouseEvent=$EH,this.ratio=$ET,1!=$EM.globalScaleX||1!=$EM.globalScaleY?this._parent=$EM.parent:this._parent=$Ey.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$Ey.stage.on("mouseup",this,this.onStageMouseUp),$Ey.stage.on("mouseout",this,this.onStageMouseUp),$Ey.timer.frameLoop(1,this,this.loop)},$Ee.clearTimer=function(){$Ey.timer.clear(this,this.loop),$Ey.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$Ee.stop=function(){this._dragging&&($Er.instance.disableMouseEvent=!1,$Ey.stage.off("mouseup",this,this.onStageMouseUp),$Ey.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$Ee.loop=function(){var $EM=this._parent.getMousePoint(),$Ee=$EM.x,$EL=$EM.y,$E_=$Ee-this._lastX,$Ec=$EL-this._lastY;if(this._clickOnly){if(!(1<Math.abs($E_*$Ey.stage._canvasTransform.getScaleX())||1<Math.abs($Ec*$Ey.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$Er.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($E_,$Ec);0==$E_&&0==$Ec||(this._lastX=$Ee,this._lastY=$EL,this.target.x+=$E_*this._elasticRateX,this.target.y+=$Ec*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$Ee.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $EM=this.area.x-this.target.x;else $EM=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$EM/this.elasticDistance),this.target.y<this.area.y)var $Ee=this.area.y-this.target.y;else $Ee=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$Ee/this.elasticDistance)}},$Ee.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$Ee.onStageMouseUp=function($EM){if($Er.instance.disableMouseEvent=!1,$Ey.stage.off("mouseup",this,this.onStageMouseUp),$Ey.stage.off("mouseout",this,this.onStageMouseUp),$Ey.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $Ee=this._offsets.length,$EL=Math.min($Ee,6),$E_=this._offsets.length-$EL,$Ec=$Ee-1;$E_<$Ec;$Ec--)this._offsetY+=this._offsets[$Ec--],this._offsetX+=this._offsets[$Ec];this._offsetX=this._offsetX/$EL*2,this._offsetY=this._offsetY/$EL*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$Ey.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$Ee.checkElastic=function(){var $EM=NaN,$Ee=NaN;if(this.target.x<this.area.x?$EM=this.area.x:this.target.x>this.area.x+this.area.width&&($EM=this.area.x+this.area.width),this.target.y<this.area.y?$Ee=this.area.y:this.target.y>this.area.y+this.area.height&&($Ee=this.area.y+this.area.height),isNaN($EM)&&isNaN($Ee))this.clear();else{var $EL={};isNaN($EM)||($EL.x=$EM),isNaN($Ee)||($EL.y=$Ee),this._tween=$EN.to(this.target,$EL,this.elasticBackTime,$EQ.sineOut,$EK.create(this,this.clear),0,!1,!1)}},$Ee.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($Ey.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$Ee.clear=function(){if(this.target){this.clearTimer();var $EM=this.target;this.target=null,this._parent=null,$EM.event("dragend",this.data)}},$EM}()),$EQ=function(){function $ET(){}return $Eu($ET,"laya.utils.Ease"),$ET.linearNone=function($EM,$Ee,$EL,$E_){return $EL*$EM/$E_+$Ee},$ET.linearIn=function($EM,$Ee,$EL,$E_){return $EL*$EM/$E_+$Ee},$ET.linearInOut=function($EM,$Ee,$EL,$E_){return $EL*$EM/$E_+$Ee},$ET.linearOut=function($EM,$Ee,$EL,$E_){return $EL*$EM/$E_+$Ee},$ET.bounceIn=function($EM,$Ee,$EL,$E_){return $EL-$ET.bounceOut($E_-$EM,0,$EL,$E_)+$Ee},$ET.bounceInOut=function($EM,$Ee,$EL,$E_){return $EM<.5*$E_?.5*$ET.bounceIn(2*$EM,0,$EL,$E_)+$Ee:.5*$ET.bounceOut(2*$EM-$E_,0,$EL,$E_)+.5*$EL+$Ee},$ET.bounceOut=function($EM,$Ee,$EL,$E_){return($EM/=$E_)<1/2.75?$EL*(7.5625*$EM*$EM)+$Ee:$EM<2/2.75?$EL*(7.5625*($EM-=1.5/2.75)*$EM+.75)+$Ee:$EM<2.5/2.75?$EL*(7.5625*($EM-=2.25/2.75)*$EM+.9375)+$Ee:$EL*(7.5625*($EM-=2.625/2.75)*$EM+.984375)+$Ee},$ET.backIn=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ec&&($Ec=1.70158),$EL*($EM/=$E_)*$EM*(($Ec+1)*$EM-$Ec)+$Ee},$ET.backInOut=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ec&&($Ec=1.70158),($EM/=.5*$E_)<1?.5*$EL*($EM*$EM*((1+($Ec*=1.525))*$EM-$Ec))+$Ee:$EL/2*(($EM-=2)*$EM*((1+($Ec*=1.525))*$EM+$Ec)+2)+$Ee},$ET.backOut=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ec&&($Ec=1.70158),$EL*(($EM=$EM/$E_-1)*$EM*(($Ec+1)*$EM+$Ec)+1)+$Ee},$ET.elasticIn=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH;return void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=0),0==$EM?$Ee:1==($EM/=$E_)?$Ee+$EL:($Eq||($Eq=.3*$E_),$EH=!$Ec||0<$EL&&$Ec<$EL||$EL<0&&$Ec<-$EL?($Ec=$EL,$Eq/4):$Eq/$ET.PI2*Math.asin($EL/$Ec),-$Ec*Math.pow(2,10*($EM-=1))*Math.sin(($EM*$E_-$EH)*$ET.PI2/$Eq)+$Ee)},$ET.elasticInOut=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH;return void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=0),0==$EM?$Ee:2==($EM/=.5*$E_)?$Ee+$EL:($Eq||($Eq=$E_*(.3*1.5)),$EH=!$Ec||0<$EL&&$Ec<$EL||$EL<0&&$Ec<-$EL?($Ec=$EL,$Eq/4):$Eq/$ET.PI2*Math.asin($EL/$Ec),$EM<1?$Ec*Math.pow(2,10*($EM-=1))*Math.sin(($EM*$E_-$EH)*$ET.PI2/$Eq)*-.5+$Ee:$Ec*Math.pow(2,-10*($EM-=1))*Math.sin(($EM*$E_-$EH)*$ET.PI2/$Eq)*.5+$EL+$Ee)},$ET.elasticOut=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH;return void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=0),0==$EM?$Ee:1==($EM/=$E_)?$Ee+$EL:($Eq||($Eq=.3*$E_),$EH=!$Ec||0<$EL&&$Ec<$EL||$EL<0&&$Ec<-$EL?($Ec=$EL,$Eq/4):$Eq/$ET.PI2*Math.asin($EL/$Ec),$Ec*Math.pow(2,-10*$EM)*Math.sin(($EM*$E_-$EH)*$ET.PI2/$Eq)+$EL+$Ee)},$ET.strongIn=function($EM,$Ee,$EL,$E_){return $EL*($EM/=$E_)*$EM*$EM*$EM*$EM+$Ee},$ET.strongInOut=function($EM,$Ee,$EL,$E_){return($EM/=.5*$E_)<1?.5*$EL*$EM*$EM*$EM*$EM*$EM+$Ee:.5*$EL*(($EM-=2)*$EM*$EM*$EM*$EM+2)+$Ee},$ET.strongOut=function($EM,$Ee,$EL,$E_){return $EL*(($EM=$EM/$E_-1)*$EM*$EM*$EM*$EM+1)+$Ee},$ET.sineInOut=function($EM,$Ee,$EL,$E_){return.5*-$EL*(Math.cos(Math.PI*$EM/$E_)-1)+$Ee},$ET.sineIn=function($EM,$Ee,$EL,$E_){return-$EL*Math.cos($EM/$E_*$ET.HALF_PI)+$EL+$Ee},$ET.sineOut=function($EM,$Ee,$EL,$E_){return $EL*Math.sin($EM/$E_*$ET.HALF_PI)+$Ee},$ET.quintIn=function($EM,$Ee,$EL,$E_){return $EL*($EM/=$E_)*$EM*$EM*$EM*$EM+$Ee},$ET.quintInOut=function($EM,$Ee,$EL,$E_){return($EM/=.5*$E_)<1?.5*$EL*$EM*$EM*$EM*$EM*$EM+$Ee:.5*$EL*(($EM-=2)*$EM*$EM*$EM*$EM+2)+$Ee},$ET.quintOut=function($EM,$Ee,$EL,$E_){return $EL*(($EM=$EM/$E_-1)*$EM*$EM*$EM*$EM+1)+$Ee},$ET.quartIn=function($EM,$Ee,$EL,$E_){return $EL*($EM/=$E_)*$EM*$EM*$EM+$Ee},$ET.quartInOut=function($EM,$Ee,$EL,$E_){return($EM/=.5*$E_)<1?.5*$EL*$EM*$EM*$EM*$EM+$Ee:.5*-$EL*(($EM-=2)*$EM*$EM*$EM-2)+$Ee},$ET.quartOut=function($EM,$Ee,$EL,$E_){return-$EL*(($EM=$EM/$E_-1)*$EM*$EM*$EM-1)+$Ee},$ET.cubicIn=function($EM,$Ee,$EL,$E_){return $EL*($EM/=$E_)*$EM*$EM+$Ee},$ET.cubicInOut=function($EM,$Ee,$EL,$E_){return($EM/=.5*$E_)<1?.5*$EL*$EM*$EM*$EM+$Ee:.5*$EL*(($EM-=2)*$EM*$EM+2)+$Ee},$ET.cubicOut=function($EM,$Ee,$EL,$E_){return $EL*(($EM=$EM/$E_-1)*$EM*$EM+1)+$Ee},$ET.quadIn=function($EM,$Ee,$EL,$E_){return $EL*($EM/=$E_)*$EM+$Ee},$ET.quadInOut=function($EM,$Ee,$EL,$E_){return($EM/=.5*$E_)<1?.5*$EL*$EM*$EM+$Ee:.5*-$EL*(--$EM*($EM-2)-1)+$Ee},$ET.quadOut=function($EM,$Ee,$EL,$E_){return-$EL*($EM/=$E_)*($EM-2)+$Ee},$ET.expoIn=function($EM,$Ee,$EL,$E_){return 0==$EM?$Ee:$EL*Math.pow(2,10*($EM/$E_-1))+$Ee-.001*$EL},$ET.expoInOut=function($EM,$Ee,$EL,$E_){return 0==$EM?$Ee:$EM==$E_?$Ee+$EL:($EM/=.5*$E_)<1?.5*$EL*Math.pow(2,10*($EM-1))+$Ee:.5*$EL*(2-Math.pow(2,-10*--$EM))+$Ee},$ET.expoOut=function($EM,$Ee,$EL,$E_){return $EM==$E_?$Ee+$EL:$EL*(1-Math.pow(2,-10*$EM/$E_))+$Ee},$ET.circIn=function($EM,$Ee,$EL,$E_){return-$EL*(Math.sqrt(1-($EM/=$E_)*$EM)-1)+$Ee},$ET.circInOut=function($EM,$Ee,$EL,$E_){return($EM/=.5*$E_)<1?.5*-$EL*(Math.sqrt(1-$EM*$EM)-1)+$Ee:.5*$EL*(Math.sqrt(1-($EM-=2)*$EM)+1)+$Ee},$ET.circOut=function($EM,$Ee,$EL,$E_){return $EL*Math.sqrt(1-($EM=$EM/$E_-1)*$EM)+$Ee},$ET.HALF_PI=.5*Math.PI,$ET.PI2=2*Math.PI,$ET}(),$EY=function(){function $EG(){this._hit=null,this._unHit=null}$Eu($EG,"laya.utils.HitArea");var $EM=$EG.prototype;return $EM.isHit=function($EM,$Ee){return!!$EG.isHitGraphic($EM,$Ee,this.hit)&&!$EG.isHitGraphic($EM,$Ee,this.unHit)},$EM.contains=function($EM,$Ee){return this.isHit($EM,$Ee)},$Ed(0,$EM,"hit",function(){return this._hit||(this._hit=new $EV),this._hit},function($EM){this._hit=$EM}),$Ed(0,$EM,"unHit",function(){return this._unHit||(this._unHit=new $EV),this._unHit},function($EM){this._unHit=$EM}),$EG.isHitGraphic=function($EM,$Ee,$EL){if(!$EL)return!1;var $E_;if(!($E_=$EL.cmds)&&$EL._one&&(($E_=$EG._cmds).length=1,$E_[0]=$EL._one),!$E_)return!1;var $Ec,$Eq,$EH=0;for($Ec=$E_.length,$EH=0;$EH<$Ec;$EH++)if($Eq=$E_[$EH]){var $ET=$En._context;switch($Eq.callee){case $ET._translate:case 6:$EM-=$Eq[0],$Ee-=$Eq[1]}if($EG.isHitCmd($EM,$Ee,$Eq))return!0}return!1},$EG.isHitCmd=function($EM,$Ee,$EL){if(!$EL)return!1;var $E_=$En._context,$Ec=!1;switch($EL.callee){case $E_._drawRect:case 13:$EG._rec.setTo($EL[0],$EL[1],$EL[2],$EL[3]),$Ec=$EG._rec.contains($EM,$Ee);break;case $E_._drawCircle:case $E_._fillCircle:case 14:$Ec=($EM-=$EL[0])*$EM+($Ee-=$EL[1])*$Ee<$EL[2]*$EL[2];break;case $E_._drawPoly:case 18:$EM-=$EL[0],$Ee-=$EL[1],$Ec=$EG.ptInPolygon($EM,$Ee,$EL[2])}return $Ec},$EG.ptInPolygon=function($EM,$Ee,$EL){var $E_;($E_=$EG._ptPoint).setTo($EM,$Ee);var $Ec,$Eq=0,$EH=NaN,$ET=NaN,$Ex=NaN,$EO=NaN;$Ec=$EL.length;for(var $Eu=0;$Eu<$Ec;$Eu+=2){if($EH=$EL[$Eu],$ET=$EL[$Eu+1],$Ex=$EL[($Eu+2)%$Ec],$ET!=($EO=$EL[($Eu+3)%$Ec]))if(!($E_.y<Math.min($ET,$EO)))if(!($E_.y>=Math.max($ET,$EO)))($E_.y-$ET)*($Ex-$EH)/($EO-$ET)+$EH>$E_.x&&$Eq++}return $Eq%2==1},$EG._cmds=[],$Ex($EG,["_rec",function(){return this._rec=new $EB},"_ptPoint",function(){return this._ptPoint=new $EA}]),$EG}(),$EP=(function(){function $Ec($EM,$Ee,$EL,$E_){this.char=$EM,this.charNum=$EM.charCodeAt(0),this._x=this._y=0,this.width=$Ee,this.height=$EL,this.style=$E_,this.isWord=!$Ec._isWordRegExp.test($EM)}$Eu($Ec,"laya.utils.HTMLChar");var $EM=$Ec.prototype;$Ey.imps($EM,{"laya.display.ILayout":!0}),$EM.setSprite=function($EM){this._sprite=$EM},$EM.getSprite=function(){return this._sprite},$EM._isChar=function(){return!0},$EM._getCSSStyle=function(){return this.style},$Ed(0,$EM,"width",function(){return this._w},function($EM){this._w=$EM}),$Ed(0,$EM,"x",function(){return this._x},function($EM){this._sprite&&(this._sprite.x=$EM),this._x=$EM}),$Ed(0,$EM,"y",function(){return this._y},function($EM){this._sprite&&(this._sprite.y=$EM),this._y=$EM}),$Ed(0,$EM,"height",function(){return this._h},function($EM){this._h=$EM}),$Ec._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $Ee(){}$Eu($Ee,"laya.utils.Log"),$Ee.enable=function(){$Ee._logdiv||($Ee._logdiv=$Eg.window.document.createElement("div"),$Eg.window.document.body.appendChild($Ee._logdiv),$Ee._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$Ee.toggle=function(){var $EM=$Ee._logdiv.style;"1px"==$EM.width?$EM.width=$EM.height="50%":$EM.width=$EM.height="1px"},$Ee.print=function($EM){$Ee._logdiv&&($Ee.maxCount<=$Ee._count&&$Ee.clear(),$Ee._count++,$Ee._logdiv.innerText+=$EM+"\n",$Ee._logdiv.scrollTop=$Ee._logdiv.scrollHeight)},$Ee.clear=function(){$Ee._logdiv.innerText="",$Ee._count=0},$Ee._logdiv=null,$Ee._count=0,$Ee.maxCount=20}(),function(){function $Ee(){}$Eu($Ee,"laya.utils.Mouse"),$Ed(1,$Ee,"cursor",function(){return $Ee._style.cursor},function($EM){$Ee._style.cursor=$EM}),$Ee.hide=function(){"none"!=$Ee.cursor&&($Ee._preCursor=$Ee.cursor,$Ee.cursor="none")},$Ee.show=function(){"none"==$Ee.cursor&&($Ee.cursor=$Ee._preCursor?$Ee._preCursor:"auto")},$Ee._preCursor=null,$Ex($Ee,["_style",function(){return this._style=$Eg.document.body.style}])}(),function(){function $Eq(){}return $Eu($Eq,"laya.utils.Pool"),$Eq.getPoolBySign=function($EM){return $Eq._poolDic[$EM]||($Eq._poolDic[$EM]=[])},$Eq.clearBySign=function($EM){$Eq._poolDic[$EM]&&($Eq._poolDic[$EM].length=0)},$Eq.recover=function($EM,$Ee){$Ee.__InPool||($Ee.__InPool=!0,$Eq.getPoolBySign($EM).push($Ee))},$Eq.getItemByClass=function($EM,$Ee){var $EL=$Eq.getPoolBySign($EM),$E_=$EL.length?$EL.pop():new $Ee;return $E_.__InPool=!1,$E_},$Eq.getItemByCreateFun=function($EM,$Ee,$EL){var $E_=$Eq.getPoolBySign($EM),$Ec=$E_.length?$E_.pop():$Ee.call($EL);return $Ec.__InPool=!1,$Ec},$Eq.getItem=function($EM){var $Ee=$Eq.getPoolBySign($EM),$EL=$Ee.length?$Ee.pop():null;return $EL&&($EL.__InPool=!1),$EL},$Eq._poolDic={},$Eq.InPoolSign="__InPool",$Eq}()),$EZ=function(){function $Ex(){}return $Eu($Ex,"laya.utils.Stat"),$Ed(1,$Ex,"onclick",null,function($EM){$Ex._sp&&$Ex._sp.on("click",$Ex._sp,$EM),$Ex._canvas&&($Ex._canvas.source.onclick=$EM,$Ex._canvas.source.style.pointerEvents="")}),$Ex.show=function($EM,$Ee,$EL){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),!$En.isConchApp||$En.isConchWebGL){if($En.isConchWebGL||$Eg.onMiniGame||$Eg.onLimixiu||($Ex._useCanvas=!0),$Ex._show=!0,$Ex._fpsData.length=60,$Ex._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$Ex._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$Ex._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$Ex._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$En.isWebGL)if($Ex._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$En.is3DMode){if($Ex._view[0].title="FPS(3D)",$Ex._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$Ex._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$Ex._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$EL){var $E_=8;$Ex._view[$E_++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$Ex._view[$E_++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$Ex._view[$E_++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$Ex._view[$E_++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$Ex._view[$E_++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$Ex._view[$E_++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$Ex._view[$E_++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$Ex._view[$E_++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$Ex._view[$E_++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$EL){$E_=8;$Ex._view[$E_++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$Ex._view[$E_++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$Ex._view[$E_++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$Ex._view[$E_++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$Ex._view[$E_++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$Ex._view[$E_++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$Ex._view[$E_++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $Ex._view[0].title="FPS(WebGL)",$Ex._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $Ex._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$Ex._useCanvas?$Ex.createUIPre($EM,$Ee):$Ex.createUI($EM,$Ee),$Ex.enable()}else $Eg.window.conch.showFPS&&$Eg.window.conch.showFPS($EM,$Ee)},$Ex.createUIPre=function($EM,$Ee){var $EL=$Eg.pixelRatio;$Ex._width=170*$EL,$Ex._vx=75*$EL,$Ex._height=$EL*(12*$Ex._view.length+3*$EL)+4,$Ex._fontSize=12*$EL;for(var $E_=0;$E_<$Ex._view.length;$E_++)$Ex._view[$E_].x=4,$Ex._view[$E_].y=$E_*$Ex._fontSize+2*$EL;$Ex._canvas||(($Ex._canvas=new $EXM("2D")).size($Ex._width,$Ex._height),($Ex._ctx=$Ex._canvas.getContext("2d")).textBaseline="top",$Ex._ctx.font=$Ex._fontSize+"px Sans-serif",$Ex._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$EM+"px;top:"+$Ee+"px;width:"+$Ex._width/$EL+"px;height:"+$Ex._height/$EL+"px;"),$Ex._first=!0,$Ex.loop(),$Ex._first=!1,$Eg.container.appendChild($Ex._canvas.source)},$Ex.createUI=function($EM,$Ee){var $EL=$Ex._sp,$E_=$Eg.pixelRatio;$EL||($EL=new $EGM,($Ex._leftText=new $E$M).pos(5,5),$Ex._leftText.color="#ffffff",$EL.addChild($Ex._leftText),($Ex._txt=new $E$M).pos(80*$E_,5),$Ex._txt.color="#ffffff",$EL.addChild($Ex._txt),$Ex._sp=$EL),$EL.pos($EM,$Ee);for(var $Ec="",$Eq=0;$Eq<$Ex._view.length;$Eq++){$Ec+=$Ex._view[$Eq].title+"\n"}$Ex._leftText.text=$Ec;var $EH=170*$E_,$ET=$E_*(12*$Ex._view.length+3*$E_)+4;$Ex._txt.fontSize=$Ex._fontSize*$E_,$Ex._leftText.fontSize=$Ex._fontSize*$E_,$EL.size($EH,$ET),$EL.graphics.clear(),$EL.graphics.setAlpha(.5),$EL.graphics.drawRect(0,0,$EH,$ET,"#999999"),$EL.graphics.setAlpha(1),$Ex.loop()},$Ex.enable=function(){$Ey.timer.frameLoop(1,$Ex,$Ex.loop)},$Ex.hide=function(){$Ex._show=!1,$Ey.timer.clear($Ex,$Ex.loop),$Ex._canvas&&$Eg.removeElement($Ex._canvas.source)},$Ex.clear=function(){$Ex.trianglesFaces=$Ex.drawCall=$Ex.shaderCall=$Ex.spriteCount=$Ex.spriteRenderUseCacheCount=$Ex.treeNodeCollision=$Ex.treeSpriteCollision=$Ex.canvasNormal=$Ex.canvasBitmap=$Ex.canvasReCache=0},$Ex.loop=function(){$Ex._count++;var $EM=$Eg.now();if(!($EM-$Ex._timer<1e3)){var $Ee=$Ex._count;if($Ex.FPS=Math.round(1e3*$Ee/($EM-$Ex._timer)),$Ex._show){$Ex.trianglesFaces=Math.round($Ex.trianglesFaces/$Ee),$Ex.spriteCount=$Ex._useCanvas?($Ex.drawCall=Math.round($Ex.drawCall/$Ee)-2,$Ex.shaderCall=Math.round($Ex.shaderCall/$Ee),Math.round($Ex.spriteCount/$Ee)-1):($Ex.drawCall=Math.round($Ex.drawCall/$Ee)-2,$Ex.shaderCall=Math.round($Ex.shaderCall/$Ee)-4,Math.round($Ex.spriteCount/$Ee)-4),$Ex.spriteRenderUseCacheCount=Math.round($Ex.spriteRenderUseCacheCount/$Ee),$Ex.canvasNormal=Math.round($Ex.canvasNormal/$Ee),$Ex.canvasBitmap=Math.round($Ex.canvasBitmap/$Ee),$Ex.canvasReCache=Math.ceil($Ex.canvasReCache/$Ee),$Ex.treeNodeCollision=Math.round($Ex.treeNodeCollision/$Ee),$Ex.treeSpriteCollision=Math.round($Ex.treeSpriteCollision/$Ee);var $EL=0<$Ex.FPS?Math.floor(1e3/$Ex.FPS).toString():" ";$Ex._fpsStr=$Ex.FPS+($Ex.renderSlow?" slow":"")+" "+$EL,$Ex._spriteStr=$Ex.spriteCount+($Ex.spriteRenderUseCacheCount?"/"+$Ex.spriteRenderUseCacheCount:""),$Ex._canvasStr=$Ex.canvasReCache+"/"+$Ex.canvasNormal+"/"+$Ex.canvasBitmap,$Ex.currentMemorySize=$EF.systemResourceManager.memorySize,$Ex._useCanvas?$Ex.renderInfoPre():$Ex.renderInfo(),$Ex.clear()}$Ex._count=0,$Ex._timer=$EM}},$Ex.renderInfoPre=function(){if($Ex._canvas){var $EM=$Ex._ctx;$EM.clearRect($Ex._first?0:$Ex._vx,0,$Ex._width,$Ex._height);for(var $Ee=$En.WebGL.mainContext,$EL=0;$EL<$Ex._view.length;$EL++){var $E_=$Ex._view[$EL];$Ex._first&&($EM.fillStyle="white",$EM.fillText($E_.title,$E_.x,$E_.y,null,null,null)),$EM.fillStyle=$E_.color;var $Ec=-1;if(($E_=$Ex._view[$EL]).varying){if($Ee)switch($E_.varying){case 1:$Ec=$Ee.getParameter($Ee[$E_.value]);break;case 2:$Ec=$Ee.getExtension($E_.value)}}else $Ec=$Ex[$E_.value];"M"==$E_.units&&($Ec=Math.floor($Ec/1048576*100)/100+" M"),"K"==$E_.units&&($Ec=Math.floor($Ec/1024*100)/100+" K"),"string"==$E_.units&&($Ec=$Ec.match(/\d+\.?\d/i)),$EM.fillText($Ec+"",$E_.x+$Ex._vx,$E_.y,null,null,null)}}},$Ex.renderInfo=function(){for(var $EM="",$Ee=$En.WebGL.mainContext,$EL=0;$EL<$Ex._view.length;$EL++){var $E_=$Ex._view[$EL],$Ec=-1;if($E_.varying){if($Ee)switch($E_.varying){case 1:$Ec=$Ee.getParameter($Ee[$E_.value]);break;case 2:$Ec=$Ee.getExtension($E_.value)}}else $Ec=$Ex[$E_.value];"M"==$E_.units&&($Ec=Math.floor($Ec/1048576*100)/100+" M"),"K"==$E_.units&&($Ec=Math.floor($Ec/1024*100)/100+" K"),"string"==$E_.units&&($Ec=$Ec.match(/\d+\.?\d/i)),$EM+=$Ec+"\n"}$Ex._txt.text=$EM},$Ex.FPS=0,$Ex.loopCount=0,$Ex.shaderCall=0,$Ex.drawCall=0,$Ex.trianglesFaces=0,$Ex.spriteCount=0,$Ex.spriteRenderUseCacheCount=0,$Ex.treeNodeCollision=0,$Ex.treeSpriteCollision=0,$Ex.canvasNormal=0,$Ex.canvasBitmap=0,$Ex.canvasReCache=0,$Ex.renderSlow=!1,$Ex.currentMemorySize=0,$Ex._fpsStr=null,$Ex._canvasStr=null,$Ex._spriteStr=null,$Ex._fpsData=[],$Ex._timer=0,$Ex._count=0,$Ex._view=[],$Ex._fontSize=12,$Ex._txt=null,$Ex._leftText=null,$Ex._sp=null,$Ex._show=!1,$Ex._useCanvas=!1,$Ex._canvas=null,$Ex._ctx=null,$Ex._first=!1,$Ex._vx=NaN,$Ex._width=0,$Ex._height=100,$Ex}(),$Ev=(function(){function $EM(){this._strsToID={},this._idToStrs=[],this._length=0}$Eu($EM,"laya.utils.StringKey");var $Ee=$EM.prototype;$Ee.add=function($EM){var $Ee=this._strsToID[$EM];return null!=$Ee?$Ee:(this._idToStrs[this._length]=$EM,this._strsToID[$EM]=this._length++)},$Ee.getID=function($EM){var $Ee=this._strsToID[$EM];return null==$Ee?-1:$Ee},$Ee.getName=function($EM){var $Ee=this._idToStrs[$EM];return null==$Ee?void 0:$Ee}}(),function(){var $EO;function $EM(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$Eu($EM,"laya.utils.Timer");var $Ee=$EM.prototype;return $Ee._init=function(){$Ey.timer&&$Ey.timer.frameLoop(1,this,this._update)},$Ee._now=function(){return Date.now()},$Ee._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $EM=this.currFrame=this.currFrame+this.scale,$Ee=this._now();this._delta=($Ee-this._lastTimer)*this.scale;var $EL=this.currTimer=this.currTimer+this._delta;$Ey.isDebug&&6e4<Math.abs($Ee-this._lastTimer)&&console.error("系统时间错误！"+($Ee-this._lastTimer)),this._lastTimer=$Ee;var $E_=this._handlers;for($EH=this._count=0,$ET=$E_.length;$EH<$ET;$EH++)if(null!==($Ex=$E_[$EH]).method){var $Ec=$Ex.userFrame?$EM:$EL;if($Ec>=$Ex.exeTime)if($Ex.repeat)if($Ex.jumpFrame)for(;$Ec>=$Ex.exeTime;)$Ex.exeTime+=$Ex.delay,$Ex.run(!1);else $Ex.exeTime+=$Ex.delay,$Ex.run(!1),$Ec>$Ex.exeTime&&($Ex.exeTime+=Math.ceil(($Ec-$Ex.exeTime)/$Ex.delay)*$Ex.delay);else $Ex.run(!0)}else this._count++;(30<this._count||$EM%200==0)&&this._clearHandlers();for(var $Eq=this._laters,$EH=0,$ET=$Eq.length-1;$EH<=$ET;$EH++){var $Ex=$Eq[$EH];this._isIgnoreRecover($Ex)||(null!==$Ex.method&&(delete this._map[$Ex.key],$Ex.run(!1)),this._recoverHandler($Ex)),$EH===$ET&&($ET=$Eq.length-1)}$Eq.length=0}},$Ee._clearHandlers=function(){for(var $EM=this._handlers,$Ee=0,$EL=$EM.length;$Ee<$EL;$Ee++){var $E_=$EM[$Ee];null!==$E_.method?this._temp.push($E_):this._isIgnoreRecover($E_)?this._temp.push($E_):this._recoverHandler($E_)}this._handlers=this._temp,this._temp=$EM,this._temp.length=0},$Ee._recoverHandler=function($EM){this._map[$EM.key]==$EM&&delete this._map[$EM.key],$EM.recover()},$Ee._create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){if(!$EL)return $Ec.apply($E_,$Eq),null;if($EH){var $Ex=this._getHandler($E_,$Ec);if($Ex)return $Ex.repeat=$Ee,$Ex.userFrame=$EM,$Ex.delay=$EL,$Ex.ignoreRecover=$ET,$Ex.caller=$E_,$Ex.method=$Ec,$Ex.args=$Eq,$Ex.exeTime=$EL+($EM?this.currFrame:this.currTimer+this._now()-this._lastTimer),$Ex}return($Ex=$EO.create()).repeat=$Ee,$Ex.userFrame=$EM,$Ex.delay=$EL,$Ex.ignoreRecover=$ET,$Ex.caller=$E_,$Ex.method=$Ec,$Ex.args=$Eq,$Ex.exeTime=$EL+($EM?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($Ex),this._handlers.push($Ex),$Ex},$Ee._indexHandler=function($EM){var $Ee=$EM.caller,$EL=$EM.method,$E_=$Ee?$Ee.$_GID||($Ee.$_GID=$Es.getGID()):0,$Ec=$EL.$_TID||($EL.$_TID=this._mid++);$EM.key=$E_+"_"+$Ec,this._map[$EM.key]=$EM},$Ee.once=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=!0),this._create(!1,!1,$EM,$Ee,$EL,$E_,$Ec,!1)},$Ee.loop=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){void 0===$Ec&&($Ec=!0),void 0===$Eq&&($Eq=!1),void 0===$EH&&($EH=!1);var $ET=this._create(!1,!0,$EM,$Ee,$EL,$E_,$Ec,$EH);$ET&&($ET.jumpFrame=$Eq)},$Ee.frameOnce=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=!0),this._create(!0,!1,$EM,$Ee,$EL,$E_,$Ec,!1)},$Ee.frameLoop=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Ec&&($Ec=!0),void 0===$Eq&&($Eq=!1),this._create(!0,!0,$EM,$Ee,$EL,$E_,$Ec,$Eq)},$Ee.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$EO._freeCount},$Ee.clear=function($EM,$Ee){var $EL=this._getHandler($EM,$Ee);return!(!$EL||this._isIgnoreRecover($EL))&&(delete this._map[$EL.key],$EL.key=null,$EL.clear(),!0)},$Ee.clearAll=function($EM){if($EM)for(var $Ee=0,$EL=this._handlers.length;$Ee<$EL;$Ee++){var $E_=this._handlers[$Ee];$E_.caller===$EM&&(this._isIgnoreRecover($E_)||(delete this._map[$E_.key],$E_.key=null,$E_.clear()))}},$Ee._getHandler=function($EM,$Ee){var $EL=$EM?$EM.$_GID||($EM.$_GID=$Es.getGID()):0,$E_=$Ee.$_TID||($Ee.$_TID=this._mid++);return this._map[$EL+"_"+$E_]},$Ee._isIgnoreRecover=function($EM){if($EM.ignoreRecover||$EM.caller&&"IgnoreRecover"==$EM.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $Ee="";try{arguments.propertyIsEnumerable.caller}catch($EM){$Ee=$EM.stack}$Ey.recordError("报错：核心定时器销毁忽略  "+$Ee)}return!0}return!1},$Ee.hasHandler=function($EM,$Ee){return this._map[$EM.$_GID+"_"+$Ee.$_TID]},$Ee.callLater=function($EM,$Ee,$EL){if(null==this._getHandler($EM,$Ee)){var $E_=$EO.create();$E_.caller=$EM,$E_.method=$Ee,$E_.args=$EL,this._indexHandler($E_),this._laters.push($E_)}},$Ee.runCallLater=function($EM,$Ee){var $EL=this._getHandler($EM,$Ee);$EL&&null!=$EL.method&&(this._isIgnoreRecover($EL)||(delete this._map[$EL.key],$EL.run(!0)))},$Ee.runTimer=function($EM,$Ee){this.runCallLater($EM,$Ee)},$Ed(0,$Ee,"delta",function(){return this._delta}),$EM.__init$=function(){$EO=function(){function $Ee(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$Eu($Ee,"");var $EM=$Ee.prototype;return $EM.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$EM.recover=function(){this.clear(),this.args=$Ee._freeHandler,$Ee._freeHandler=this,$Ee._freeCount++},$EM.run=function($EM){var $Ee=this.caller;if($Ee&&$Ee.destroyed)return this.clear();var $EL=this.method,$E_=this.args;$EM&&this.clear(),null!=$EL&&($E_?$EL.apply($Ee,$E_):$EL.call($Ee))},$Ee._freeHandler=null,$Ee._freeCount=0,$Ee.create=function(){var $EM=$Ee._freeHandler;return $EM?($Ee._freeHandler=$EM.args,--$Ee._freeCount,$EM.args=null,$EM):new $Ee},$Ee}()},$EM}()),$EN=function(){function $EG(){this.gid=0}$Eu($EG,"laya.utils.Tween");var $EM=$EG.prototype;return $EM.to=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){return void 0===$Eq&&($Eq=0),void 0===$EH&&($EH=!1),this._create($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,!0,!1,!0)},$EM.from=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){return void 0===$Eq&&($Eq=0),void 0===$EH&&($EH=!1),this._create($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,!1,!1,!0)},$EM._create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){if(!$EM)throw new Error("Tween:target is null");this._target=$EM,this._duration=$EL,this._ease=$E_||$Ee.ease||$EG.easeNone,this._complete=$Ec||$Ee.complete,this._delay=$Eq,this._props=[],this._usedTimer=0,this._startTimer=$Eg.now(),this._usedPool=$Ex,this._delayParam=null,this.update=$Ee.update;var $Eu=$EM.$_GID||($EM.$_GID=$Es.getGID());return $EG.tweenMap[$Eu]?($EH&&$EG.clearTween($EM),$EG.tweenMap[$Eu].push(this)):$EG.tweenMap[$Eu]=[this],$EO?$Eq<=0?this.firstStart($EM,$Ee,$ET):(this._delayParam=[$EM,$Ee,$ET],$Ey.scaleTimer.once($Eq,this,this.firstStart,this._delayParam)):this._initProps($EM,$Ee,$ET),this},$EM.firstStart=function($EM,$Ee,$EL){this._delayParam=null,$EM.destroyed?this.clear():(this._initProps($EM,$Ee,$EL),this._beginLoop())},$EM._initProps=function($EM,$Ee,$EL){for(var $E_ in $Ee)if("number"==typeof $EM[$E_]){var $Ec=$EL?$EM[$E_]:$Ee[$E_],$Eq=$EL?$Ee[$E_]:$EM[$E_];this._props.push([$E_,$Ec,$Eq-$Ec]),$EL||($EM[$E_]=$Ec)}},$EM._beginLoop=function(){$Ey.scaleTimer.frameLoop(1,this,this._doEase)},$EM._doEase=function(){this._updateEase($Eg.now())},$EM._updateEase=function($EM){var $Ee=this._target;if($Ee){if($Ee.destroyed)return $EG.clearTween($Ee);var $EL=this._usedTimer=$EM-this._startTimer-this._delay;if(!($EL<0)){if($EL>=this._duration)return this.complete();for(var $E_=0<$EL?this._ease($EL,0,1,this._duration):0,$Ec=this._props,$Eq=0,$EH=$Ec.length;$Eq<$EH;$Eq++){var $ET=$Ec[$Eq];$Ee[$ET[0]]=$ET[1]+$E_*$ET[2]}this.update&&this.update.run()}}},$EM.complete=function(){if(this._target){$Ey.scaleTimer.runTimer(this,this.firstStart);for(var $EM=this._target,$Ee=this._props,$EL=this._complete,$E_=0,$Ec=$Ee.length;$E_<$Ec;$E_++){var $Eq=$Ee[$E_];$EM[$Eq[0]]=$Eq[1]+$Eq[2]}this.update&&this.update.run(),this.clear(),$EL&&$EL.run()}},$EM.pause=function(){$Ey.scaleTimer.clear(this,this._beginLoop),$Ey.scaleTimer.clear(this,this._doEase),$Ey.scaleTimer.clear(this,this.firstStart);var $EM;($EM=$Eg.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$EM)},$EM.setStartTime=function($EM){this._startTimer=$EM},$EM.clear=function(){this._target&&(this._remove(),this._clear())},$EM._clear=function(){this.pause(),$Ey.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$EP.recover("tween",this))},$EM.recover=function(){this._usedPool=!0,this._clear()},$EM._remove=function(){var $EM=$EG.tweenMap[this._target.$_GID];if($EM)for(var $Ee=0,$EL=$EM.length;$Ee<$EL;$Ee++)if($EM[$Ee]===this){$EM.splice($Ee,1);break}},$EM.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$Eg.now(),this._delayParam)$Ey.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $EM=this._props,$Ee=0,$EL=$EM.length;$Ee<$EL;$Ee++){var $E_=$EM[$Ee];this._target[$E_[0]]=$E_[1]}$Ey.scaleTimer.once(this._delay,this,this._beginLoop)}},$EM.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$Eg.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$Ey.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$Ed(0,$EM,"progress",null,function($EM){var $Ee=$EM*this._duration;this._startTimer=$Eg.now()-this._delay-$Ee}),$EG.to=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){return void 0===$Eq&&($Eq=0),void 0===$EH&&($EH=!1),void 0===$ET&&($ET=!0),$EP.getItemByClass("tween",$EG)._create($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,!0,$ET,!0)},$EG.from=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){return void 0===$Eq&&($Eq=0),void 0===$EH&&($EH=!1),void 0===$ET&&($ET=!0),$EP.getItemByClass("tween",$EG)._create($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,!1,$ET,!0)},$EG.clearAll=function($EM){if($EM&&$EM.$_GID){var $Ee=$EG.tweenMap[$EM.$_GID];if($Ee){for(var $EL=0,$E_=$Ee.length;$EL<$E_;$EL++)$Ee[$EL]._clear();$Ee.length=0}}},$EG.clear=function($EM){$EM.clear()},$EG.clearTween=function($EM){$EG.clearAll($EM)},$EG.easeNone=function($EM,$Ee,$EL,$E_){return $EL*$EM/$E_+$Ee},$EG.tweenMap={},$EG}(),$Es=function(){function $ET(){}return $Eu($ET,"laya.utils.Utils"),$ET.toRadian=function($EM){return $EM*$ET._pi2},$ET.toAngle=function($EM){return $EM*$ET._pi},$ET.toHexColor=function($EM){if($EM<0||isNaN($EM))return null;for(var $Ee=$EM.toString(16);$Ee.length<6;)$Ee="0"+$Ee;return"#"+$Ee},$ET.getGID=function(){return $ET._gid++},$ET.concatArray=function($EM,$Ee){if(!$Ee)return $EM;if(!$EM)return $Ee;var $EL=0,$E_=$Ee.length;for($EL=0;$EL<$E_;$EL++)$EM.push($Ee[$EL]);return $EM},$ET.clearArray=function($EM){return $EM&&($EM.length=0),$EM},$ET.copyArray=function($EM,$Ee){if($EM||($EM=[]),!$Ee)return $EM;$EM.length=$Ee.length;var $EL=0,$E_=$Ee.length;for($EL=0;$EL<$E_;$EL++)$EM[$EL]=$Ee[$EL];return $EM},$ET.getGlobalRecByPoints=function($EM,$Ee,$EL,$E_,$Ec){var $Eq,$EH;return $Eq=new $EA($Ee,$EL),$Eq=$EM.localToGlobal($Eq),$EH=new $EA($E_,$Ec),$EH=$EM.localToGlobal($EH),$EB._getWrapRec([$Eq.x,$Eq.y,$EH.x,$EH.y])},$ET.getGlobalPosAndScale=function($EM){return $ET.getGlobalRecByPoints($EM,0,0,1,1)},$ET.bind=function($EM,$Ee){return $EM.bind($Ee)},$ET.measureText=function($EM,$Ee){return $ES.measureText($EM,$Ee)},$ET.contextMeasureText=function($EM){var $Ee=$Eg.context.measureText($EM);return $Ee||($Ee={width:16,height:16}),$Ee},$ET.updateOrder=function($EM){if(!$EM||$EM.length<2)return!1;for(var $Ee,$EL=1,$E_=0,$Ec=$EM.length,$Eq=NaN;$EL<$Ec;){for($Ee=$EM[$E_=$EL],$Eq=$EM[$E_]._zOrder;-1<--$E_&&$EM[$E_]._zOrder>$Eq;)$EM[$E_+1]=$EM[$E_];$EM[$E_+1]=$Ee,$EL++}var $EH=$Ee.parent.conchModel;if($EH)if(null!=$EH.updateZOrder)$EH.updateZOrder();else{for($EL=0;$EL<$Ec;$EL++)$EH.removeChild($EM[$EL].conchModel);for($EL=0;$EL<$Ec;$EL++)$EH.addChildAt($EM[$EL].conchModel,$EL)}return!0},$ET.transPointList=function($EM,$Ee,$EL){var $E_=0,$Ec=$EM.length;for($E_=0;$E_<$Ec;$E_+=2)$EM[$E_]+=$Ee,$EM[$E_+1]+=$EL},$ET.parseInt=function($EM,$Ee){void 0===$Ee&&($Ee=0);var $EL=$Eg.window.parseInt($EM,$Ee);return isNaN($EL)?0:$EL},$ET.getFileExtension=function($EM){$ET._extReg.lastIndex=$EM.lastIndexOf(".");var $Ee=$ET._extReg.exec($EM);return $Ee&&1<$Ee.length?$Ee[1].toLowerCase():null},$ET.getTransformRelativeToWindow=function($EM,$Ee,$EL){var $E_=$Ey.stage,$Ec=laya.utils.Utils.getGlobalPosAndScale($EM),$Eq=$E_._canvasTransform.clone(),$EH=$Eq.tx,$ET=$Eq.ty;$Eq.rotate(-Math.PI/180*$Ey.stage.canvasDegree),$Eq.scale($Ey.stage.clientScaleX,$Ey.stage.clientScaleY);var $Ex=$Ey.stage.canvasDegree%180!=0,$EO=NaN,$Eu=NaN;$Ex?($EO=$EL+$Ec.y,$Eu=$Ee+$Ec.x,$EO*=$Eq.d,$Eu*=$Eq.a,90==$Ey.stage.canvasDegree?($EO=$EH-$EO,$Eu+=$ET):($EO+=$EH,$Eu=$ET-$Eu)):($EO=$Ee+$Ec.x,$Eu=$EL+$Ec.y,$EO*=$Eq.a,$Eu*=$Eq.d,$EO+=$EH,$Eu+=$ET);var $EG=NaN,$EV=NaN;return $EV=$Ex?($EG=$Eq.d*$Ec.height,$Eq.a*$Ec.width):($EG=$Eq.a*$Ec.width,$Eq.d*$Ec.height),{x:$EO,y:$Eu,scaleX:$EG,scaleY:$EV}},$ET.fitDOMElementInArea=function($EM,$Ee,$EL,$E_,$Ec,$Eq){$EM._fitLayaAirInitialized||($EM._fitLayaAirInitialized=!0,$EM.style.transformOrigin=$EM.style.webKittransformOrigin="left top",$EM.style.position="absolute");var $EH=$ET.getTransformRelativeToWindow($Ee,$EL,$E_);$EM.style.transform=$EM.style.webkitTransform="scale("+$EH.scaleX+","+$EH.scaleY+") rotate("+$Ey.stage.canvasDegree+"deg)",$EM.style.width=$Ec+"px",$EM.style.height=$Eq+"px",$EM.style.left=$EH.x+"px",$EM.style.top=$EH.y+"px"},$ET.isOkTextureList=function($EM){if(!$EM)return!1;var $Ee,$EL=0,$E_=$EM.length;for($EL=0;$EL<$E_;$EL++)if(!($Ee=$EM[$EL])||!$Ee.source)return!1;return!0},$ET.isOKCmdList=function($EM){if(!$EM)return!1;var $Ee,$EL,$E_=0,$Ec=$EM.length,$Eq=$En._context;for($E_=0;$E_<$Ec;$E_++)switch(($Ee=$EM[$E_]).callee){case $Eq._drawTexture:case $Eq._fillTexture:case $Eq._drawTextureWithTransform:if(!($EL=$Ee[0])||!$EL.source)return!1}return!0},$ET._gid=1,$ET._pi=180/Math.PI,$ET._pi2=Math.PI/180,$ET._extReg=/\.(\w+)\??/g,$ET.parseXMLFromString=function($EM){var $Ee;if($EM=$EM.replace(/>\s+</g,"><"),-1<($Ee=(new DOMParser).parseFromString($EM,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($Ee.firstChild.firstChild.textContent);return $Ee},$ET}(),$ED=function(){function $EM(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$En.isWebGL&&$Ew.regCacheByFunction($Es.bind(this.startDispose,this),$Es.bind(this.getCacheList,this))}$Eu($EM,"laya.utils.VectorGraphManager");var $Ee=$EM.prototype;return $Ee.getId=function(){return this._id++},$Ee.addShape=function($EM,$Ee){this.shapeDic[$EM]=$Ee,this.useDic[$EM]||(this.useDic[$EM]=!0)},$Ee.addLine=function($EM,$Ee){this.shapeLineDic[$EM]=$Ee,this.shapeLineDic[$EM]||(this.shapeLineDic[$EM]=!0)},$Ee.getShape=function($EM){this._checkKey&&null!=this.useDic[$EM]&&(this.useDic[$EM]=!0)},$Ee.deleteShape=function($EM){this.shapeDic[$EM]&&(this.shapeDic[$EM]=null,delete this.shapeDic[$EM]),this.shapeLineDic[$EM]&&(this.shapeLineDic[$EM]=null,delete this.shapeLineDic[$EM]),null!=this.useDic[$EM]&&delete this.useDic[$EM]},$Ee.getCacheList=function(){var $EM,$Ee=[];for($EM in this.shapeDic)$Ee.push(this.shapeDic[$EM]);for($EM in this.shapeLineDic)$Ee.push(this.shapeLineDic[$EM]);return $Ee},$Ee.startDispose=function($EM){var $Ee;for($Ee in this.useDic)this.useDic[$Ee]=!1;this._checkKey=!0},$Ee.endDispose=function(){if(this._checkKey){var $EM;for($EM in this.useDic)this.useDic[$EM]||this.deleteShape($EM);this._checkKey=!1}},$EM.getInstance=function(){return $EM.instance=$EM.instance||new $EM},$EM.instance=null,$EM}(),$EU=function(){function $E_(){this._obj=null,this._obj=$E_.supportWeakMap?new $Eg.window.WeakMap:{},$E_.supportWeakMap||$E_._maps.push(this)}$Eu($E_,"laya.utils.WeakObject");var $EM=$E_.prototype;return $EM.set=function($EM,$Ee){if(null!=$EM)if($E_.supportWeakMap){var $EL=$EM;"string"!=typeof $EM&&"number"!=typeof $EM||($EL=$E_._keys[$EM])||($EL=$E_._keys[$EM]={k:$EM}),this._obj.set($EL,$Ee)}else"string"==typeof $EM||"number"==typeof $EM?this._obj[$EM]=$Ee:($EM.$_GID||($EM.$_GID=$Es.getGID()),this._obj[$EM.$_GID]=$Ee)},$EM.get=function($EM){if(null==$EM)return null;if($E_.supportWeakMap){var $Ee="string"==typeof $EM||"number"==typeof $EM?$E_._keys[$EM]:$EM;return $Ee?this._obj.get($Ee):null}return"string"==typeof $EM||"number"==typeof $EM?this._obj[$EM]:this._obj[$EM.$_GID]},$EM.del=function($EM){if(null!=$EM)if($E_.supportWeakMap){var $Ee="string"==typeof $EM||"number"==typeof $EM?$E_._keys[$EM]:$EM;if(!$Ee)return;this._obj.delete($Ee)}else"string"==typeof $EM||"number"==typeof $EM?delete this._obj[$EM]:delete this._obj[this._obj.$_GID]},$EM.has=function($EM){if(null==$EM)return!1;if($E_.supportWeakMap){var $Ee="string"==typeof $EM||"number"==typeof $EM?$E_._keys[$EM]:$EM;return this._obj.has($Ee)}return"string"==typeof $EM||"number"==typeof $EM?null!=this._obj[$EM]:null!=this._obj[this._obj.$_GID]},$E_.__init__=function(){($E_.supportWeakMap=null!=$Eg.window.WeakMap)||$Ey.timer.loop($E_.delInterval,null,$E_.clearCache)},$E_.clearCache=function(){for(var $EM=0,$Ee=$E_._maps.length;$EM<$Ee;$EM++){$E_._maps[$EM]._obj={}}},$E_.supportWeakMap=!1,$E_.delInterval=3e5,$E_._keys={},$E_._maps=[],$Ex($E_,["I",function(){return this.I=new $E_}]),$E_}(),$EI=function(){function $EM(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$Eu($EM,"laya.utils.WordText");var $Ee=$EM.prototype;return $Ee.setText=function($EM){this.changed=!0,this._text=$EM},$Ee.toString=function(){return this._text},$Ee.charCodeAt=function($EM){return this._text?this._text.charCodeAt($EM):NaN},$Ee.charAt=function($EM){return this._text?this._text.charAt($EM):null},$Ed(0,$Ee,"length",function(){return this._text?this._text.length:0}),$EM}(),$EMM=function($EM){function $EH(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$EH.__super.call(this),this._childs=$EH.ARRAY_EMPTY,this._$P=$EH.PROP_EMPTY,this.timer=$Ey.scaleTimer,this.conchModel=$En.isConchNode?this.createConchModel():null}$Eu($EH,"laya.display.Node",$EO);var $Ee=$EH.prototype;return $Ee._setBit=function($EM,$Ee){1==$EM&&(this._getBit($EM)!=$Ee&&this._updateDisplayedInstage());$Ee?this._bits|=$EM:this._bits&=~$EM},$Ee._getBit=function($EM){return 0!=(this._bits&$EM)},$Ee._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$Ee._setUpNoticeType=function($EM){var $Ee=this;for($Ee._setBit($EM,!0),$Ee=$Ee.parent;$Ee;){if($Ee._getBit($EM))return;$Ee._setBit($EM,!0),$Ee=$Ee.parent}},$Ee.on=function($EM,$Ee,$EL,$E_){return"display"!==$EM&&"undisplay"!==$EM||this._getBit(1)||this._setUpNoticeType(1),this._createListener($EM,$Ee,$EL,$E_,!1)},$Ee.once=function($EM,$Ee,$EL,$E_){return"display"!==$EM&&"undisplay"!==$EM||this._getBit(1)||this._setUpNoticeType(1),this._createListener($EM,$Ee,$EL,$E_,!0)},$Ee.createConchModel=function(){return null},$Ee.destroy=function($EM){void 0===$EM&&($EM=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($EM?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$Ee.destroyChildren=function(){if(this._childs)for(var $EM=this._childs.length-1;-1<$EM;$EM--)this._childs[$EM].destroy(!0)},$Ee.addChild=function($EM){if(!$EM||this.destroyed||$EM===this)return $EM;if($EM.zOrder&&this._set$P("hasZorder",!0),$EM._parent===this){var $Ee=this.getChildIndex($EM);$Ee!==this._childs.length-1&&(this._childs.splice($Ee,1),this._childs.push($EM),this.conchModel&&(this.conchModel.removeChild($EM.conchModel),this.conchModel.addChildAt($EM.conchModel,this._childs.length-1)),this._childChanged())}else $EM.parent&&$EM.parent.removeChild($EM),this._childs===$EH.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($EM),this.conchModel&&this.conchModel.addChildAt($EM.conchModel,this._childs.length-1),($EM.parent=this)._childChanged();return $EM},$Ee.addChildren=function($EM){for(var $Ee=arguments,$EL=0,$E_=$Ee.length;$EL<$E_;)this.addChild($Ee[$EL++])},$Ee.addChildAt=function($EM,$Ee){if(!$EM||this.destroyed||$EM===this)return $EM;if($EM.zOrder&&this._set$P("hasZorder",!0),0<=$Ee&&$Ee<=this._childs.length){if($EM._parent===this){var $EL=this.getChildIndex($EM);this._childs.splice($EL,1),this._childs.splice($Ee,0,$EM),this.conchModel&&(this.conchModel.removeChild($EM.conchModel),this.conchModel.addChildAt($EM.conchModel,$Ee)),this._childChanged()}else $EM.parent&&$EM.parent.removeChild($EM),this._childs===$EH.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($Ee,0,$EM),this.conchModel&&this.conchModel.addChildAt($EM.conchModel,$Ee),$EM.parent=this;return $EM}throw new Error("appendChildAt:The index is out of bounds")},$Ee.getChildIndex=function($EM){return this._childs.indexOf($EM)},$Ee.getChildByName=function($EM){var $Ee=this._childs;if($Ee)for(var $EL=0,$E_=$Ee.length;$EL<$E_;$EL++){var $Ec=$Ee[$EL];if($Ec.name===$EM)return $Ec}return null},$Ee._get$P=function($EM){return this._$P[$EM]},$Ee._set$P=function($EM,$Ee){return this.destroyed||(this._$P===$EH.PROP_EMPTY&&(this._$P={}),this._$P[$EM]=$Ee),$Ee},$Ee.getChildAt=function($EM){return this._childs[$EM]},$Ee.setChildIndex=function($EM,$Ee){var $EL=this._childs;if($Ee<0||$Ee>=$EL.length)throw new Error("setChildIndex:The index is out of bounds.");var $E_=this.getChildIndex($EM);if($E_<0)throw new Error("setChildIndex:node is must child of this object.");return $EL.splice($E_,1),$EL.splice($Ee,0,$EM),this.conchModel&&(this.conchModel.removeChild($EM.conchModel),this.conchModel.addChildAt($EM.conchModel,$Ee)),this._childChanged(),$EM},$Ee._childChanged=function($EM){},$Ee.removeChild=function($EM){if(!this._childs)return $EM;var $Ee=this._childs.indexOf($EM);return this.removeChildAt($Ee)},$Ee.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$Ee.removeChildByName=function($EM){var $Ee=this.getChildByName($EM);return $Ee&&this.removeChild($Ee),$Ee},$Ee.removeChildAt=function($EM){var $Ee=this.getChildAt($EM);if($Ee){for(var $EL=this._childs.length-1,$E_=$EM;$E_<$EL;++$E_)this._childs[$E_]=this._childs[$E_+1];this._childs.length=$EL,this.conchModel&&this.conchModel.removeChild($Ee.conchModel),$Ee.parent=null}return $Ee},$Ee.removeChildren=function($EM,$Ee){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=2147483647),this._childs&&0<this._childs.length){var $EL=this._childs;if(0===$EM&&$Eq<=$Ee){var $E_=$EL;this._childs=$EH.ARRAY_EMPTY}else $E_=$EL.splice($EM,$Ee-$EM);for(var $Ec=0,$Eq=$E_.length;$Ec<$Eq;$Ec++)$E_[$Ec].parent=null,this.conchModel&&this.conchModel.removeChild($E_[$Ec].conchModel)}return this},$Ee.replaceChild=function($EM,$Ee){var $EL=this._childs.indexOf($Ee);return-1<$EL?(this._childs.splice($EL,1,$EM),this.conchModel&&(this.conchModel.removeChild($Ee.conchModel),this.conchModel.addChildAt($EM.conchModel,$EL)),$Ee.parent=null,$EM.parent=this,$EM):null},$Ee._updateDisplayedInstage=function(){var $EM;$EM=this;var $Ee=$Ey.stage;for(this._displayedInStage=!1;$EM;){if($EM._getBit(1)){this._displayedInStage=$EM._displayedInStage;break}if($EM==$Ee||$EM._displayedInStage){this._displayedInStage=!0;break}$EM=$EM.parent}},$Ee._setDisplay=function($EM){this._displayedInStage!==$EM&&((this._displayedInStage=$EM)?this.event("display"):this.event("undisplay"))},$Ee._displayChild=function($EM,$Ee){var $EL=$EM._childs;if($EL)for(var $E_=0;$E_<$EL.length;$E_++){var $Ec=$EL[$E_];$Ec&&$Ec._getBit(1)&&(0<$Ec._childs.length?this._displayChild($Ec,$Ee):$Ec._setDisplay($Ee))}$EM._setDisplay($Ee)},$Ee.contains=function($EM){if($EM===this)return!0;for(;$EM;){if($EM.parent===this)return!0;$EM=$EM.parent}return!1},$Ee.timerLoop=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Ec&&($Ec=!0),void 0===$Eq&&($Eq=!1),this.timer.loop($EM,$Ee,$EL,$E_,$Ec,$Eq)},$Ee.timerOnce=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=!0),this.timer._create(!1,!1,$EM,$Ee,$EL,$E_,$Ec)},$Ee.frameLoop=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=!0),this.timer._create(!0,!0,$EM,$Ee,$EL,$E_,$Ec)},$Ee.frameOnce=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=!0),this.timer._create(!0,!1,$EM,$Ee,$EL,$E_,$Ec)},$Ee.clearTimer=function($EM,$Ee){this.timer.clear($EM,$Ee)},$Ed(0,$Ee,"numChildren",function(){return this._childs.length}),$Ed(0,$Ee,"destroyed",function(){return this._destroyed}),$Ed(0,$Ee,"parent",function(){return this._parent},function($EM){this._parent!==$EM&&($EM?(this._parent=$EM,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$EM.displayedInStage&&this._displayChild(this,!0)),$EM._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$EM))}),$Ed(0,$Ee,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$EH.ARRAY_EMPTY=[],$EH.PROP_EMPTY={},$EH.NOTICE_DISPLAY=1,$EH.MOUSEENABLE=2,$EH}(),$EeM=function($EM){function $EV($EM){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$EV.__super.call(this),this._padding=$EV._PADDING,this._spacing=$EV._SPACING,this._aligns=$EV._ALIGNS,this._font=$EE.EMPTY,this._ower=$EM}$Eu($EV,"laya.display.css.CSSStyle",$EM);var $Ee=$EV.prototype;return $Ee.destroy=function(){this._ower=null,this._font=null,this._rect=null},$Ee.inherit=function($EM){this._font=$EM._font,this._spacing=$EM._spacing===$EV._SPACING?$EV._SPACING:$EM._spacing.slice(),this.lineHeight=$EM.lineHeight},$Ee._widthAuto=function(){return 0!=(262144&this._type)},$Ee.widthed=function($EM){return 0!=(8&this._type)},$Ee._calculation=function($EM,$Ee){if($Ee.indexOf("%")<0)return!1;var $E_=this._ower,$Ec=$E_.parent,$Eq=this._rect;function $EH($EM,$Ee,$EL){return $EM*$EL[0]+$Ee*$EL[1]+$EL[2]}function $EL($EM){var $Ee=$Ec.width,$EL=$E_.width;$Eq.width&&($E_.width=$EH($Ee,$EL,$Eq.width)),$Eq.height&&($E_.height=$EH($Ee,$EL,$Eq.height)),$Eq.left&&($E_.x=$EH($Ee,$EL,$Eq.left)),$Eq.top&&($E_.y=$EH($Ee,$EL,$Eq.top))}null===$Eq&&($Ec._getCSSStyle()._type|=524288,$Ec.on("resize",this,$EL),this._rect=$Eq={input:{}});var $ET=$Ee.split(" ");return $ET[0]=parseFloat($ET[0])/100,1==$ET.length?$ET[1]=$ET[2]=0:($ET[1]=parseFloat($ET[1])/100,$ET[2]=parseFloat($ET[2])),$Eq[$EM]=$ET,$Eq.input[$EM]=$Ee,$EL(),!0},$Ee.heighted=function($EM){return 0!=(8192&this._type)},$Ee.size=function($EM,$Ee){var $EL=this._ower,$E_=!1;-1!==$EM&&$EM!=this._ower.width&&(this._type|=8,this._ower.width=$EM,$E_=!0),-1!==$Ee&&$Ee!=this._ower.height&&(this._type|=8192,this._ower.height=$Ee,$E_=!0),$E_&&($EL._layoutLater(),524288&this._type&&$EL.event("resize",this))},$Ee._getAlign=function(){return this._aligns[0]},$Ee._getValign=function(){return this._aligns[1]},$Ee._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$Ee._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $EE(this._font))},$Ee.render=function($EM,$Ee,$EL,$E_){var $Ec=$EM.width,$Eq=$EM.height;$EL-=$EM.pivotX,$E_-=$EM.pivotY,this._bgground&&null!=this._bgground.color&&$Ee.ctx.fillRect($EL,$E_,$Ec,$Eq,this._bgground.color),this._border&&this._border.color&&$Ee.drawRect($EL,$E_,$Ec,$Eq,this._border.color.strColor,this._border.size)},$Ee.getCSSStyle=function(){return this},$Ee.cssText=function($EM){this.attrs($EV.parseOneCSS($EM,";"))},$Ee.attrs=function($EM){if($EM)for(var $Ee=0,$EL=$EM.length;$Ee<$EL;$Ee++){var $E_=$EM[$Ee];this[$E_[0]]=$E_[1]}},$Ee.setTransform=function($EM){"none"===$EM?this._tf=$ET._TF_EMPTY:this.attrs($EV.parseOneCSS($EM,","))},$Ee.translate=function($EM,$Ee){this._tf===$ET._TF_EMPTY&&(this._tf=new $Ec),this._tf.translateX=$EM,this._tf.translateY=$Ee},$Ee.scale=function($EM,$Ee){this._tf===$ET._TF_EMPTY&&(this._tf=new $Ec),this._tf.scaleX=$EM,this._tf.scaleY=$Ee},$Ee._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$Ed(0,$Ee,"block",$EM.prototype._$get_block,function($EM){$EM?this._type|=1:this._type&=-2}),$Ed(0,$Ee,"valign",function(){return $EV._valigndef[this._aligns[1]]},function($EM){this._aligns===$EV._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$EV._valigndef[$EM]}),$Ed(0,$Ee,"height",null,function($EM){if(this._type|=8192,"string"==typeof $EM){if(this._calculation("height",$EM))return;$EM=parseInt($EM)}this.size(-1,$EM)}),$Ed(0,$Ee,"width",null,function($EM){if(this._type|=8,"string"==typeof $EM){var $Ee=$EM.indexOf("auto");if(0<=$Ee&&(this._type|=262144,$EM=$EM.substr(0,$Ee)),this._calculation("width",$EM))return;$EM=parseInt($EM)}this.size($EM,-1)}),$Ed(0,$Ee,"fontWeight",function(){return this._font.weight},function($EM){this._createFont().weight=$EM}),$Ed(0,$Ee,"left",null,function($EM){var $Ee=this._ower;if("string"==typeof $EM){if("center"===$EM?$EM="50% -50% 0":"right"===$EM&&($EM="100% -100% 0"),this._calculation("left",$EM))return;$EM=parseInt($EM)}$Ee.x=$EM}),$Ed(0,$Ee,"_translate",null,function($EM){this.translate($EM[0],$EM[1])}),$Ed(0,$Ee,"absolute",function(){return 0!=(4&this._type)}),$Ed(0,$Ee,"top",null,function($EM){var $Ee=this._ower;if("string"==typeof $EM){if("middle"===$EM?$EM="50% -50% 0":"bottom"===$EM&&($EM="100% -100% 0"),this._calculation("top",$EM))return;$EM=parseInt($EM)}$Ee.y=$EM}),$Ed(0,$Ee,"align",function(){return $EV._aligndef[this._aligns[0]]},function($EM){this._aligns===$EV._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$EV._aligndef[$EM]}),$Ed(0,$Ee,"bold",function(){return this._font.bold},function($EM){this._createFont().bold=$EM}),$Ed(0,$Ee,"padding",function(){return this._padding},function($EM){this._padding=$EM}),$Ed(0,$Ee,"leading",function(){return this._spacing[1]},function($EM){"string"==typeof $EM&&($EM=parseInt($EM+"")),this._spacing===$EV._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$EM}),$Ed(0,$Ee,"lineElement",function(){return 0!=(65536&this._type)},function($EM){$EM?this._type|=65536:this._type&=-65537}),$Ed(0,$Ee,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($EM){this.lineElement=!1,"right"===$EM?this._type|=32768:this._type&=-32769}),$Ed(0,$Ee,"textDecoration",function(){return this._font.decoration},function($EM){this._createFont().decoration=$EM}),$Ed(0,$Ee,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($EM){"nowrap"===$EM&&(this._type|=131072),"none"===$EM&&(this._type&=-131073)}),$Ed(0,$Ee,"background",null,function($EM){$EM?(this._bgground||(this._bgground={}),this._bgground.color=$EM,this._ower.conchModel&&this._ower.conchModel.bgColor($EM),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$Ed(0,$Ee,"wordWrap",function(){return 0==(131072&this._type)},function($EM){$EM?this._type&=-131073:this._type|=131072}),$Ed(0,$Ee,"color",function(){return this._font.color},function($EM){this._createFont().color=$EM}),$Ed(0,$Ee,"password",function(){return this._font.password},function($EM){this._createFont().password=$EM}),$Ed(0,$Ee,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($EM){"none"===$EM?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$EM),this._ower.conchModel&&this._ower.conchModel.bgColor($EM),this._ower._renderType|=256}),$Ed(0,$Ee,"font",function(){return this._font.toString()},function($EM){this._createFont().set($EM)}),$Ed(0,$Ee,"weight",null,function($EM){this._createFont().weight=$EM}),$Ed(0,$Ee,"letterSpacing",function(){return this._spacing[0]},function($EM){"string"==typeof $EM&&($EM=parseInt($EM+"")),this._spacing===$EV._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$EM}),$Ed(0,$Ee,"fontSize",function(){return this._font.size},function($EM){this._createFont().size=$EM}),$Ed(0,$Ee,"italic",function(){return this._font.italic},function($EM){this._createFont().italic=$EM}),$Ed(0,$Ee,"fontFamily",function(){return this._font.family},function($EM){this._createFont().family=$EM}),$Ed(0,$Ee,"stroke",function(){return this._font.stroke[0]},function($EM){this._createFont().stroke===$EE._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$EM}),$Ed(0,$Ee,"strokeColor",function(){return this._font.stroke[1]},function($EM){this._createFont().stroke===$EE._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$EM}),$Ed(0,$Ee,"border",function(){return this._border?this._border.value:""},function($EM){if("none"!=$EM){this._border||(this._border={});var $Ee=(this._border.value=$EM).split(" ");if(this._border.color=$Em.create($Ee[$Ee.length-1]),1==$Ee.length)return this._border.size=1,void(this._border.type="solid");var $EL=0;0<$Ee[0].indexOf("px")?(this._border.size=parseInt($Ee[0]),$EL++):this._border.size=1,this._border.type=$Ee[$EL],this._ower._renderType|=256}else this._border=null}),$Ed(0,$Ee,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($EM){$EM?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$EM?null:$Em.create($EM),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$Ed(0,$Ee,"position",function(){return 4&this._type?"absolute":""},function($EM){"absolute"==$EM?this._type|=4:this._type&=-5}),$Ed(0,$Ee,"display",null,function($EM){switch($EM){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$Ed(0,$Ee,"paddingLeft",function(){return this.padding[3]}),$Ed(0,$Ee,"paddingTop",function(){return this.padding[0]}),$Ed(0,$Ee,"_scale",null,function($EM){this._ower.scale($EM[0],$EM[1])}),$Ed(0,$Ee,"_rotate",null,function($EM){this._ower.rotation=$EM}),$EV.parseOneCSS=function($EM,$Ee){for(var $EL,$E_=[],$Ec=$EM.split($Ee),$Eq=0,$EH=$Ec.length;$Eq<$EH;$Eq++){var $ET=$Ec[$Eq],$Ex=$ET.indexOf(":"),$EO=$ET.substr(0,$Ex).replace(/^\s+|\s+$/g,"");if(0!=$EO.length){var $Eu=$ET.substr($Ex+1).replace(/^\s+|\s+$/g,""),$EG=[$EO,$Eu];switch($EO){case"italic":case"bold":$EG[1]="true"==$Eu;break;case"line-height":$EG[0]="lineHeight",$EG[1]=parseInt($Eu);break;case"font-size":$EG[0]="fontSize",$EG[1]=parseInt($Eu);break;case"padding":1<($EL=$Eu.split(" ")).length||($EL[1]=$EL[2]=$EL[3]=$EL[0]),$EG[1]=[parseInt($EL[0]),parseInt($EL[1]),parseInt($EL[2]),parseInt($EL[3])];break;case"rotate":$EG[0]="_rotate",$EG[1]=parseFloat($Eu);break;case"scale":$EL=$Eu.split(" "),$EG[0]="_scale",$EG[1]=[parseFloat($EL[0]),parseFloat($EL[1])];break;case"translate":$EL=$Eu.split(" "),$EG[0]="_translate",$EG[1]=[parseInt($EL[0]),parseInt($EL[1])];break;default:($EG[0]=$EV._CSSTOVALUE[$EO])||($EG[0]=$EO)}$E_.push($EG)}}return $E_},$EV.parseCSS=function($EM,$Ee){for(var $EL;null!=($EL=$EV._parseCSSRegExp.exec($EM));)$EV.styleSheets[$EL[1]]=$EV.parseOneCSS($EL[2],";")},$EV.EMPTY=new $EV(null),$EV._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$EV._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$EV._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$EV._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$EV.styleSheets={},$EV.ALIGN_CENTER=1,$EV.ALIGN_RIGHT=2,$EV.VALIGN_MIDDLE=1,$EV.VALIGN_BOTTOM=2,$EV._CSS_BLOCK=1,$EV._DISPLAY_NONE=2,$EV._ABSOLUTE=4,$EV._WIDTH_SET=8,$EV._PADDING=[0,0,0,0],$EV._RECT=[-1,-1,-1,-1],$EV._SPACING=[0,0],$EV._ALIGNS=[0,0,0],$EV.ADDLAYOUTED=512,$EV._NEWFONT=4096,$EV._HEIGHT_SET=8192,$EV._BACKGROUND_SET=16384,$EV._FLOAT_RIGHT=32768,$EV._LINE_ELEMENT=65536,$EV._NOWARP=131072,$EV._WIDTHAUTO=262144,$EV._LISTERRESZIE=524288,$EV}($ET),$ELM=function($EM){function $EH(){this.url=null,this.audio=null,this.loaded=!1,$EH.__super.call(this)}$Eu($EH,"laya.media.h5audio.AudioSound",$EO);var $Ee=$EH.prototype;return $Ee.dispose=function(){var $EM=$EH._audioCache[this.url];$EM&&($EM.src="",delete $EH._audioCache[this.url])},$Ee.load=function($EM){var $Ee;if($EM=$Ea.formatURL($EM),(this.url=$EM)==$Et._tMusic?($EH._initMusicAudio(),($Ee=$EH._musicAudio).src!=$EM&&($EH._audioCache[$Ee.src]=null,$Ee=null)):$Ee=$EH._audioCache[$EM],$Ee&&2<=$Ee.readyState)this.event("complete");else{$Ee||($Ee=$EM==$Et._tMusic?($EH._initMusicAudio(),$EH._musicAudio):$Eg.createElement("audio"),($EH._audioCache[$EM]=$Ee).src=$EM),$Ee.addEventListener("canplaythrough",$E_),$Ee.addEventListener("error",$Ec);var $EL=this;(this.audio=$Ee).load?$Ee.load():$Ec()}function $E_(){$Eq(),$EL.loaded=!0,$EL.event("complete")}function $Ec(){$Ee.load=null,$Eq(),$EL.event("error")}function $Eq(){$Ee.removeEventListener("canplaythrough",$E_),$Ee.removeEventListener("error",$Ec)}},$Ee.play=function($EM,$Ee,$EL){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),!this.url)return null;var $E_,$Ec;if(!($E_=this.url==$Et._tMusic?$EH._musicAudio:$EH._audioCache[this.url]))return null;$Ec=$EP.getItem("audio:"+this.url),$En.isConchApp?$Ec||(($Ec=$Eg.createElement("audio")).src=this.url):this.url==$Et._tMusic?($EH._initMusicAudio(),($Ec=$EH._musicAudio).src=this.url):$Ec=$Ec||$E_.cloneNode(!0);var $Eq=new $EVM($Ec);return $Eq.url=this.url,$Eq.loops=$Ee,$Eq.startTime=$EM,$Eq.startHandler=$EL,$Eq.play(!1),$Et.addChannel($Eq),$Eq},$Ed(0,$Ee,"duration",function(){var $EM;return($EM=$EH._audioCache[this.url])?$EM.duration:0}),$EH._initMusicAudio=function(){$EH._musicAudio||($EH._musicAudio||($EH._musicAudio=$Eg.createElement("audio")),$En.isConchApp||$Eg.document.addEventListener("mousedown",$EH._makeMusicOK))},$EH._makeMusicOK=function(){$Eg.document.removeEventListener("mousedown",$EH._makeMusicOK),$EH._musicAudio.src?$EH._musicAudio.play():($EH._musicAudio.src="",$EH._musicAudio.load())},$EH._audioCache={},$EH._musicAudio=null,$EH}(),$E_M=function($EM){function $Ee(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$Ee.__super.call(this)}$Eu($Ee,"laya.media.SoundChannel",$EO);var $EL=$Ee.prototype;return $EL.play=function(){},$EL.stop=function(){},$EL.pause=function(){},$EL.resume=function(){},$EL.__runComplete=function($EM){$EM&&$EM.run()},$Ed(0,$EL,"volume",function(){return 1},function($EM){}),$Ed(0,$EL,"position",function(){return 0}),$Ed(0,$EL,"duration",function(){return 0}),$Ee}(),$EcM=function($EM){function $Ee(){$Ee.__super.call(this)}$Eu($Ee,"laya.media.Sound",$EO);var $EL=$Ee.prototype;return $EL.load=function($EM){},$EL.play=function($EM,$Ee,$EL){return void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),null},$EL.dispose=function(){},$Ed(0,$EL,"duration",function(){return 0}),$Ee}(),$EqM=function($EM){function $Ec(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$Ec.__super.call(this)}$Eu($Ec,"laya.media.webaudio.WebAudioSound",$EO);var $Ee=$Ec.prototype;return $Ee.load=function($EM){this.url=$EM,this.audioBuffer=$Ec._dataCache[$EM],this.audioBuffer?this._loaded(this.audioBuffer):($Ec.e.on("loaded:"+$EM,this,this._loaded),$Ec.e.on("err:"+$EM,this,this._err),$Ec.__loadingSound[$EM]||($Ec.__loadingSound[$EM]=!0,$Ey.loader.load($EM,$EK.create(this,this.onloaded),null,$ETM.BUFFER,4,!1,null,!0)))},$Ee.onloaded=function($EM){$EM||this._err(),this._disposed?this._removeLoadEvents():(this.data=$EM,$Ec.buffs.push({buffer:this.data,url:this.url}),$Ec.decode())},$Ee._err=function(){if(this._removeLoadEvents(),$Ec.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $EM,$Ee,$EL,$E_=0;for($EM=($Ee=this.__toPlays).length,$E_=0;$E_<$EM;$E_++)($EL=$Ee[$E_])[3]&&!$EL[3].isStopped&&$EL[3].event("error");this.__toPlays.length=0}},$Ee._loaded=function($EM){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$EM,this.loaded=!0,this.event("complete"))},$Ee._removeLoadEvents=function(){$Ec.e.off("loaded:"+this.url,this,this._loaded),$Ec.e.off("err:"+this.url,this,this._err)},$Ee.__playAfterLoaded=function(){if(this.__toPlays){var $EM,$Ee,$EL,$E_=0;for($EM=($Ee=this.__toPlays).length,$E_=0;$E_<$EM;$E_++)($EL=$Ee[$E_])[3]&&!$EL[3].isStopped&&this.play($EL[0],$EL[1],$EL[2],$EL[3]);this.__toPlays.length=0}},$Ee.play=function($EM,$Ee,$EL,$E_){return void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),$E_=$E_||new $EEM,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$EM,$Ee,$EL,$E_]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$E_.url=this.url,$E_.loops=$Ee,$E_.audioBuffer=this.audioBuffer,$E_.startTime=$EM,$E_.startHandler=$EL,$E_.play(!1),$Et.addChannel($E_),$E_},$Ee.dispose=function(){this._disposed=!0,delete $Ec._dataCache[this.url],delete $Ec.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$Ed(0,$Ee,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$Ec.decode=function(){if(!($Ec.buffs.length<=0||$Ec.isDecoding))if($Ec.isDecoding=!0,($Ec.tInfo=$Ec.buffs.shift())&&$Ec.tInfo.buffer&&$Ec.tInfo.buffer.byteLength)try{$Ec.ctx.decodeAudioData($Ec.tInfo.buffer,$Ec._done,$Ec._fail)}catch($EM){console.error("decodeAudioData error  byteLength:"+$Ec.tInfo.buffer.byteLength+"  url:"+$Ec.tInfo.url)}else $Ec._fail()},$Ec._done=function($EM){$Ec.e.event("loaded:"+$Ec.tInfo.url,$EM),$Ec._dataCache[$Ec.tInfo.url]=$EM,$Ec.isDecoding=!1,$Ec.decode()},$Ec._fail=function(){$Ec.e.event("err:"+$Ec.tInfo.url,null),$Ec.isDecoding=!1,$Ec.decode()},$Ec._playEmptySound=function(){if(null!=$Ec.ctx){if($Ec._emptySource&&($Ec._emptySource.stop(),$Ec._emptySource.disconnect(0),!$EEM._tryCleanFailed))try{$Ec._emptySource.buffer=null}catch($EM){$EEM._tryCleanFailed=!0}var $EM=$Ec.ctx.createBufferSource();$EM.buffer=$Ec._miniBuffer,$EM.connect($Ec.ctx.destination),$EM.start(0,0,0),$Ec._emptySource=$EM}},$Ec._unlock=function(){$Ec._unlocked||($Ec._playEmptySound(),"running"==$Ec.ctx.state?($Eg.document.removeEventListener("mousedown",$Ec._unlock,!0),$Eg.document.removeEventListener("touchend",$Ec._unlock,!0),$Eg.document.removeEventListener("touchstart",$Ec._unlock,!0),$Ec._unlocked=!0):"suspended"==$Ec.ctx.state&&$Et._recoverWebAudio())},$Ec.initWebAudio=function(){"running"!=$Ec.ctx.state&&($Ec._unlock(),$Eg.document.addEventListener("mousedown",$Ec._unlock,!0),$Eg.document.addEventListener("touchend",$Ec._unlock,!0),$Eg.document.addEventListener("touchstart",$Ec._unlock,!0))},$Ec._emptySource=null,$Ec._dataCache={},$Ec.buffs=[],$Ec.isDecoding=!1,$Ec._unlocked=!1,$Ec.tInfo=null,$Ec.__loadingSound={},$Ex($Ec,["window",function(){return this.window=$Eg.window},"webAudioEnabled",function(){return this.webAudioEnabled=$Ec.window.AudioContext||$Ec.window.webkitAudioContext||$Ec.window.mozAudioContext},"ctx",function(){return this.ctx=$Ec.webAudioEnabled?new($Ec.window.AudioContext||$Ec.window.webkitAudioContext||$Ec.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$Ec.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $EO}]),$Ec}(),$EHM=function($EM){function $Ee(){this._responseType=null,this._data=null,$Ee.__super.call(this),this._http=new $Eg.window.XMLHttpRequest}$Eu($Ee,"laya.net.HttpRequest",$EO);var $EL=$Ee.prototype;return $EL.send=function($EM,$Ee,$EL,$E_,$Ec){void 0===$EL&&($EL="get"),void 0===$E_&&($E_="text"),this._responseType=$E_,this._data=null;var $Eq=this,$EH=this._http;if($EH.open($EL,$EM,!0),$Ec)for(var $ET=0;$ET<$Ec.length;$ET++)$EH.setRequestHeader($Ec[$ET++],$Ec[$ET]);else $En.isConchApp||($Ee&&"string"!=typeof $Ee?$EH.setRequestHeader("Content-Type","application/json"):$EH.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$EH.responseType="arraybuffer"!==$E_?"text":"arraybuffer",$EH.onerror=function($EM){$Eq._onError($EM)},$EH.onabort=function($EM){$Eq._onAbort($EM)},$EH.onprogress=function($EM){$Eq._onProgress($EM)},$EH.onload=function($EM){$Eq._onLoad($EM)},$EH.send($Ee)},$EL._onProgress=function($EM){$EM&&$EM.lengthComputable&&this.event("progress",$EM.loaded/$EM.total)},$EL._onAbort=function($EM){this.error("Request was aborted by user")},$EL._onError=function($EM){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$EL._onLoad=function($EM){var $Ee=this._http,$EL=void 0!==$Ee.status?$Ee.status:200;200===$EL||204===$EL||0===$EL?this.complete():this.error("["+$Ee.status+"]"+$Ee.statusText+":"+$Ee.responseURL)},$EL.error=function($EM){this.clear(),this.event("error",$EM)},$EL.complete=function(){this.clear();var $Ee=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$Es.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($EM){$Ee=!1,this.error($EM.message)}$Ee&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$EL.clear=function(){var $EM=this._http;$EM.onerror=$EM.onabort=$EM.onprogress=$EM.onload=null},$Ed(0,$EL,"url",function(){return this._http.responseURL}),$Ed(0,$EL,"http",function(){return this._http}),$Ed(0,$EL,"data",function(){return this._data}),$Ee}(),$ETM=function($EM){function $Ek(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$Ek.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}$Eu($Ek,"laya.net.Loader",$EO);var $Ee=$Ek.prototype;return $Ee.load=function($EM,$Ee,$EL,$E_,$Ec){if($EM&&""!=$EM||console.error("Loader 加载的url不合法 "+$EM),void 0===$EL&&($EL=!0),void 0===$Ec&&($Ec=!1),0===(this._url=$EM).indexOf("data:image")?this._type=$Ee="image":this._type=$Ee||($Ee=this.getTypeFromUrl($EM)),this._cache=$EL,this._data=null,!$Ec&&$Ek.loadedMap[$EM])return this._data=$Ek.loadedMap[$EM],this.event("progress",1),void this.event("complete",this._data);if($E_&&$Ek.setGroup($EM,$E_),null!=$Ek.parserMap[$Ee])return this._customParse=!0,void($Ek.parserMap[$Ee]instanceof laya.utils.Handler?$Ek.parserMap[$Ee].runWith(this):$Ek.parserMap[$Ee].call(null,this));if("image"===$Ee||"htmlimage"===$Ee||"nativeimage"===$Ee)return this._loadImage($EM);if("ttf"===$Ee)return this._loadTTF($EM);switch($Ee){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$Ee}$Ek.preLoadedMap[$EM]?this.onLoaded($Ek.preLoadedMap[$EM]):$EH.resMgrLoad($EM,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$Ee.getTypeFromUrl=function($EM){var $Ee=$Es.getFileExtension($EM);return $Ee?$Ek.typeMap[$Ee]:(console.warn("Not recognize the resources suffix",$EM),"text")},$Ee._loadTTF=function($EM){$EM=$Ea.formatURL($EM);var $Ee=new $ER;$Ee.complete=$EK.create(this,this.onLoaded),$Ee.load($EM)},$Ee._loadImage=function($EM){$EH.imgMgrLoad($EM,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$Ee._loadImageComplete=function($EM,$Ee,$EL){if(null!=$EL)if($EL instanceof ArrayBuffer){var $E_=new DataView($EL),$Ec=new laya.webgl.resource.WebGLImage(new Uint8Array($EL,8),$EM,0,!1,$E_.getUint32(0),$E_.getUint32(4));this.onLoaded($Ec)}else if($EL instanceof $EuM)$Ek.imgMgrSet[$EM]=$Ee,$EH.imgMgrLock($EM,$Ek.imgMgrSet[$EM]),this._url=$EM,this.complete($EL);else{var $Eq=-1!=$EM.indexOf(".png",$EM.length-4)?6408:6407;$Ec=new laya.webgl.resource.WebGLImage($EL,$EM,$Eq,!1,$EL.width,$EL.height);this.onLoaded($Ec)}else this.event("error","Load image failed")},$Ee.imageCancel=function($EM,$Ee,$EL){$EH.imgMgrCancel($EM,this._onImageCallback)},$Ee._loadSound=function($EM){var $Ee=new $Et._soundClass,$EL=this;function $E_(){$Ee.offAll()}$Ee.on("complete",this,function(){$E_(),$EL.onLoaded($Ee)}),$Ee.on("error",this,function(){$E_(),$Ee.dispose(),$EL.event("error","Load sound failed")}),$Ee.load($EM)},$Ee.onProgress=function($EM){"atlas"===this._type?this.event("progress",.3*$EM):this.event("progress",$EM)},$Ee.onError=function($EM){this.event("error",$EM)},$Ee._loadedComplete=function($EM,$Ee,$EL){if(null!=$EL)switch(this._type){case"atlas":case"plf":case"json":var $E_=new $EJ($EL);this.onLoaded(JSON.parse($E_.readUTFBytes()));break;case"font":$E_=new $EJ($EL);this.onLoaded($Es.parseXMLFromString($E_.readUTFBytes()));break;default:this.onLoaded($EL)}else this.event("error",$EM)},$Ee.onLoaded=function($EM){var $Ee=this._type;if("plf"==$Ee)this.parsePLFData($EM),this.complete($EM);else if("image"===$Ee){var $EL=new $EuM($EM);$EL.url=this._url,this.complete($EL)}else if("sound"===$Ee||"htmlimage"===$Ee||"nativeimage"===$Ee)this.complete($EM);else if("atlas"===$Ee){if(!$EM.src&&!$EM._setContext){if(!this._data){if((this._data=$EM).meta&&$EM.meta.image)for(var $E_=$EM.meta.image.split(","),$Ec=0<=this._url.indexOf("/")?"/":"\\",$Eq=this._url.lastIndexOf($Ec),$EH=0<=$Eq?this._url.substr(0,$Eq+1):"",$ET=0,$Ex=$E_.length;$ET<$Ex;$ET++)$E_[$ET]=$EH+$E_[$ET];else $E_=[this._url.replace(".json",".png")];$E_.reverse(),$EM.toLoads=$E_,$EM.pics=[]}return this.event("progress",.3+1/$E_.length*.6),this._loadImage($E_.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($EM),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $EO=this._data.frames,$Eu=this._url.split("?")[0],$EG=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$Eu.substring(0,$Eu.lastIndexOf("."))+"/",$EV=this._data.pics,$EE=$Ea.formatURL(this._url),$Ed=$Ek.atlasMap[$EE]||($Ek.atlasMap[$EE]=[]);$Ed.dir=$EG;var $Er=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $E$ in $Er=parseFloat(this._data.meta.scale),$EO){var $EC,$EK=$EO[$E$],$EX=$EV[$EK.frame.idx?$EK.frame.idx:0],$Eo=$Ea.formatURL($EG+$E$);$EX.scaleRate=$Er,$EC=$EuM.create($EX,$EK.frame.x,$EK.frame.y,$EK.frame.w,$EK.frame.h,$EK.spriteSourceSize.x,$EK.spriteSourceSize.y,$EK.sourceSize.w,$EK.sourceSize.h),$Ek.cacheRes($Eo,$EC),$Ek.keepCache(this._url,$EG+$E$),$EC.url=$Eo,$Ed.push($Eo)}else for($E$ in $EO)$EX=$EV[($EK=$EO[$E$]).frame.idx?$EK.frame.idx:0],$Eo=$Ea.formatURL($EG+$E$),$Ek.cacheRes($Eo,$EuM.create($EX,$EK.frame.x,$EK.frame.y,$EK.frame.w,$EK.frame.h,$EK.spriteSourceSize.x,$EK.spriteSourceSize.y,$EK.sourceSize.w,$EK.sourceSize.h)),$Ek.loadedMap[$Eo].url=$Eo,$Ek.keepCache(this._url,$EG+$E$),$Ed.push($Eo);delete this._data.pics,this.complete(this._data)}else if("font"==$Ee){if(!$EM.src)return this._data=$EM,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $Ei=new $Eh;$Ei.parseFont(this._data,$EM);var $EW=this._url.split(".fnt")[0].split("/"),$Ey=$EW[$EW.length-1];$E$M.registerBitmapFont($Ey,$Ei),this._data=$Ei,this.complete(this._data)}else if("pkm"==$Ee){var $EA=$EWM.create($EM,this._url),$EB=new $EuM($EA);$EB.url=this._url,this.complete($EB)}else this.complete($EM)},$Ee.parsePLFData=function($EM){var $Ee,$EL,$E_;for($Ee in $EM)switch($E_=$EM[$Ee],$Ee){case"json":case"text":for($EL in $E_)$Ek.preLoadedMap[$Ea.formatURL($EL)]=$E_[$EL];break;default:for($EL in $E_)$Ek.preLoadedMap[$Ea.formatURL($EL)]=$E_[$EL]}},$Ee.complete=function($EM){this._data=$EM,this._customParse?this.event("loaded",$EM instanceof Array?[$EM]:$EM):($Ek._loaders.push(this),$Ek._isWorking||$Ek.checkNext())},$Ee.endLoad=function($EM){$EM&&(this._data=$EM),this._cache&&$Ek.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$Ed(0,$Ee,"url",function(){return this._url}),$Ed(0,$Ee,"data",function(){return this._data}),$Ed(0,$Ee,"cache",function(){return this._cache}),$Ed(0,$Ee,"type",function(){return this._type}),$Ek.checkNext=function(){$Ek._isWorking=!0;for(var $EM=$Eg.now();$Ek._startIndex<$Ek._loaders.length;)if($Eg.now(),$Ek._loaders[$Ek._startIndex].endLoad(),$Ek._startIndex++,$Eg.now()-$EM>$Ek.maxTimeOut)return console.warn("loader callback cost a long time:"+($Eg.now()-$EM)+" url="+$Ek._loaders[$Ek._startIndex-1].url),void $Ey.timer.frameOnce(1,null,$Ek.checkNext);$Ek._loaders.length=0,$Ek._startIndex=0,$Ek._isWorking=!1},$Ek.clearRes=function($EM,$Ee){if(null!=$EM){void 0===$Ee&&($Ee=!1),$EM=$Ea.formatURL($EM);var $EL=$Ek.getAtlas($EM);if($EL){for(var $E_=0,$Ec=$EL.length;$E_<$Ec;$E_++){var $Eq=$EL[$E_],$EH=$Ek.getRes($Eq);delete $Ek.loadedMap[$Eq],$Ek.clearCache($EM.substring($Ea.basePath.length),$Eq.substring($Ea.basePath.length)),$EH&&$EH.destroy($Ee)}$EL.length=0,delete $Ek.atlasMap[$EM],delete $Ek.loadedMap[$EM]}else{var $ET=$Ek.loadedMap[$EM];$ET&&(delete $Ek.loadedMap[$EM],$ET instanceof laya.resource.Texture&&$ET.bitmap&&$ET.destroy($Ee))}}},$Ek.clearTextureRes=function($EM){$EM=$Ea.formatURL($EM);var $Ee=laya.net.Loader.getAtlas($EM),$EL=$Ee&&0<$Ee.length?laya.net.Loader.getRes($Ee[0]):laya.net.Loader.getRes($EM);$EL&&$EL.bitmap&&($En.isConchApp&&!$En.isConchWebGL?$EL.bitmap.source.releaseTexture&&$EL.bitmap.source.releaseTexture():null==$EL.bitmap._atlaser&&$EL.bitmap.releaseResource(!0))},$Ek.getRes=function($EM){return $Ek.loadedMap[$Ea.formatURL($EM)]},$Ek.getAtlas=function($EM){return $Ek.atlasMap[$Ea.formatURL($EM)]},$Ek.cacheRes=function($EM,$Ee){$EM=$Ea.formatURL($EM),null!=$Ek.loadedMap[$EM]?console.warn("Resources already exist,is repeated loading:",$EM):$Ek.loadedMap[$EM]=$Ee},$Ek.setGroup=function($EM,$Ee){$Ek.groupMap[$Ee]||($Ek.groupMap[$Ee]=[]),$Ek.groupMap[$Ee].push($EM)},$Ek.clearResByGroup=function($EM){if($Ek.groupMap[$EM]){var $Ee=$Ek.groupMap[$EM],$EL=0,$E_=$Ee.length;for($EL=0;$EL<$E_;$EL++)$Ek.clearRes($Ee[$EL]);$Ee.length=0}},$Ek.keepCache=function($EM,$Ee){if($EM&&$Ee){var $EL=$Ek.cacheSet[$Ee];$EL?-1==$EL.indexOf($EM)&&$EL.push($EM):$Ek.cacheSet[$Ee]=[$EM]}},$Ek.clearCache=function($EM,$Ee){if($EM&&$Ee){var $EL=$Ek.cacheSet[$Ee];if($EL){var $E_=$EL.indexOf($EM);if(-1!==$E_){var $Ec=$EL.length-1;0==$Ec?(delete $Ek.cacheSet[$Ee],0<$Ek.imgMgrSet[$Ee]?$EH.imgMgrFree($Ee,$Ek.imgMgrSet[$Ee]):$Ek.clearRes($Ee,!0)):($EL[$E_]=$EL[$Ec],$EL.length=$Ec)}}}},$Ek.saveObject=function($EM,$Ee,$EL){if($Ee&&$EM){var $E_=$Ek.objectSet[$EM];$E_?(console.warn("Loader.saveObject: "+$EM),$E_[0]=$Ee,$E_[1]=$EL):$Ek.objectSet[$EM]=[$Ee,$EL,[]]}},$Ek.findObject=function($EM){if($EM){var $Ee=$Ek.objectSet[$EM];if($Ee)return $Ee[0]}return null},$Ek.keepObject=function($EM,$Ee){if($EM&&$Ee){var $EL=$Ek.objectSet[$Ee];$EL&&-1===$EL[2].indexOf($EM)&&$EL[2].push($EM)}},$Ek.clearObject=function($EM,$Ee){if($EM&&$Ee){var $EL=$Ek.objectSet[$Ee];if($EL){var $E_=$EL[2],$Ec=$E_.indexOf($EM);if(-1!==$Ec){var $Eq=$E_.length-1;0==$Eq?(delete $Ek.objectSet[$Ee],$EL[1]&&$EL[1].call(null,$EL[0])):($E_[$Ec]=$E_[$Eq],$E_.length=$Eq)}}}},$Ek.TEXT="text",$Ek.JSON="json",$Ek.XML="xml",$Ek.BUFFER="arraybuffer",$Ek.IMAGE="image",$Ek.SOUND="sound",$Ek.ATLAS="atlas",$Ek.FONT="font",$Ek.TTF="ttf",$Ek.PLF="plf",$Ek.PKM="pkm",$Ek.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$Ek.parserMap={},$Ek.groupMap={},$Ek.maxTimeOut=100,$Ek.loadedMap={},$Ek.preLoadedMap={},$Ek.atlasMap={},$Ek._loaders=[],$Ek._isWorking=!1,$Ek._startIndex=0,$Ek.imgCache={},$Ek.cacheSet={},$Ek.objectSet={},$Ek.imgMgrSet={},$Ek}(),$ExM=function($EM){var $EV;function $EE(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$EE.__super.call(this);for(var $EM=0;$EM<this._maxPriority;$EM++)this._resInfos[$EM]=[]}$Eu($EE,"laya.net.LoaderManager",$EO);var $Ee=$EE.prototype;return $Ee.create=function($EM,$EL,$Ee,$E_,$Ec,$Eq,$EH,$ET){if(null==$Eq&&($Eq=2),null==$EH&&($EH=!0),$EM instanceof Array){var $Ex=$EM,$EO=$Ex.length,$Eu=0;if($Ee)var $EG=$EK.create($Ee.caller,$Ee.method,$Ee.args,!1);for(var $EV=0;$EV<$EO;$EV++){var $EE=$Ex[$EV];"string"==typeof $EE&&($EE=$Ex[$EV]={url:$EE}),$EE.progress=0}for($EV=0;$EV<$EO;$EV++){$EE=$Ex[$EV];var $Ed=$Ee?$EK.create(null,$EC,[$EE],!1):null,$Er=$Ee||$EL?$EK.create(null,$E$,[$EE]):null;this._create($EE.url,$Er,$Ed,$EE.clas||$E_,$EE.params||$Ec,null!=$EE.priority&&0<=$EE.priority?$EE.priority:$Eq,$EH,$EE.group||$ET)}function $E$($EM,$Ee){$Eu++,$EM.progress=1,$Eu===$EO&&$EL&&$EL.run()}function $EC($EM,$Ee){$EM.progress=$Ee;for(var $EL=0,$E_=0;$E_<$EO;$E_++){$EL+=$Ex[$E_].progress}var $Ec=$EL/$EO;$EG.runWith($Ec)}return!0}return this._create($EM,$EL,$Ee,$E_,$Ec,$Eq,$EH,$ET)},$Ee._create=function($Ee,$EL,$EM,$E_,$Ec,$Eq,$EH,$ET){$Ee&&""!=$Ee||console.error("加载的url不合法 "+$Ee),null==$Eq&&($Eq=2),null==$EH&&($EH=!0);var $Ex=$Ea.formatURL($Ee),$EO=this.getRes($Ex);if($EO)!$EO.hasOwnProperty("loaded")||$EO.loaded?($EM&&$EM.runWith(1),$EL&&$EL.run()):$EL&&$Ey.loader._createListener($Ee,$EL.caller,$EL.method,$EL.args,!0,!1);else{var $Eu=$Es.getFileExtension($Ee),$EG=$EE.createMap[$Eu];if(!$EG)throw new Error("LoaderManager:unknown file("+$Ee+") extension with: "+$Eu+".");$E_||($E_=$EG[0]);var $EV=$EG[1];if("atlas"==$Eu)this.load($Ee,$EL,$EM,$EV,$Eq,$EH);else{$E_===$EuM&&($EV="htmlimage"),($EO=$E_?new $E_:null).hasOwnProperty("_loaded")&&($EO._loaded=!1),$EO._setUrl($Ee),$ET&&$EO._setGroup($ET),this._createLoad($EO,$Ee,$EK.create(null,function($EM){$EO&&!$EO.destroyed&&$EM&&$EO.onAsynLoaded.call($EO,$Ee,$EM,$Ec),$EL&&$EL.run();$Ey.loader.event($Ee)}),$EM,$EV,$Eq,!1,$ET,!0),$EH&&this.cacheRes($Ex,$EO)}}return $EO},$Ee.load=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){$EM&&""!=$EM||console.error("加载的url不合法 "+$EM);var $Ex=this;if(null==$Ec&&($Ec=2),null==$Eq&&($Eq=!0),void 0===$ET&&($ET=!1),$EM instanceof Array)return this._loadAssets($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH);var $EO=$ETM.getRes($EM);if(null!=$EO)$Ey.timer.frameOnce(1,null,function(){$EL&&$EL.runWith(1),$Ee&&$Ee.runWith($EO),$Ex._loaderCount||$Ex.event("complete")});else{var $Eu=$EE._resMap[$EM];$Eu?($Ee&&$Eu._createListener("complete",$Ee.caller,$Ee.method,$Ee.args,!1,!1),$EL&&$Eu._createListener("progress",$EL.caller,$EL.method,$EL.args,!1,!1)):(($Eu=this._infoPool.length?this._infoPool.pop():new $EV).url=$EM,$Eu.clas=null,$Eu.type=$E_,$Eu.cache=$Eq,$Eu.group=$EH,$Eu.ignoreCache=$ET,$Eu.priority=$Ec,$Ee&&$Eu.on("complete",$Ee.caller,$Ee.method,$Ee.args),$EL&&$Eu.on("progress",$EL.caller,$EL.method,$EL.args),$EE._resMap[$EM]=$Eu,$Ec=$Ec<this._maxPriority?0<=$Ec?$Ec:0:this._maxPriority-1,this._resInfos[$Ec].push($Eu),this._next())}return this},$Ee.cancel=function($EM,$Ee,$EL){if($EO=$EE._resMap[$EM]){$Ee&&$EO.off("complete",$Ee.caller,$Ee.method,!1),$EL&&$EO.off("progress",$EL.caller,$EL.method,!1);var $E_=$EO.getListener("complete"),$Ec=$EO.getListener("progress");if(!($E_&&$E_.head||$Ec&&$Ec.head)){if($EO.loader){var $Eq=$EO.loader;$Eq.imageCancel($EM),$Eq.offAll(),$Eq._data=null,$Eq._customParse=!1,this._loaders.push($Eq),this._loaderCount--,delete this._loaderMap[$EO.url]}for(var $EH=0;$EH<this._maxPriority;$EH++)for(var $ET=this._resInfos[$EH],$Ex=$ET.length-1;-1<$Ex;$Ex--){var $EO;($EO=$ET[$Ex])&&$EO.url===$EM&&($ET[$Ex]=null,$EO.destroy(),$EO.offAll(),this._infoPool.push($EO))}delete $EE._resMap[$EM],this._next()}}},$Ee._createLoad=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){var $EO=this;if(null==$Eq&&($Eq=2),null==$EH&&($EH=!0),void 0===$Ex&&($Ex=!1),$Ee instanceof Array)return this._loadAssets($Ee,$EL,$E_,$Ec,$Eq,$EH,$ET);var $Eu=$ETM.getRes($Ee);if(null!=$Eu)$Ey.timer.frameOnce(1,null,function(){$E_&&$E_.runWith(1),$EL&&$EL.runWith($Eu),$EO._loaderCount||$EO.event("complete")});else{var $EG=$EE._resMap[$Ee];$EG?($EL&&$EG._createListener("complete",$EL.caller,$EL.method,$EL.args,!1,!1),$E_&&$EG._createListener("progress",$E_.caller,$E_.method,$E_.args,!1,!1)):(($EG=this._infoPool.length?this._infoPool.pop():new $EV).url=$Ee,$EG.clas=$EM,$EG.type=$Ec,$EG.cache=$EH,$EG.group=$ET,$EG.ignoreCache=$Ex,$EG.priority=$Eq,$EL&&$EG.on("complete",$EL.caller,$EL.method,$EL.args),$E_&&$EG.on("progress",$E_.caller,$E_.method,$E_.args),$EE._resMap[$Ee]=$EG,$Eq=$Eq<this._maxPriority?0<=$Eq?$Eq:0:this._maxPriority-1,this._resInfos[$Eq].push($EG),this._next())}return this},$Ee._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $EM=0;$EM<this._maxPriority;$EM++)for(var $Ee=this._resInfos[$EM];0<$Ee.length;){var $EL=$Ee.shift();if($EL)return this._doLoad($EL)}this._loaderCount||this.event("complete")}},$Ee._doLoad=function($Ee){var $EL=this._loaders.length?this._loaders.pop():new $ETM;this._loaderCount++,(this._loaderMap[$Ee.url]=$EL).on("complete",null,$Ec),$EL.on("progress",null,function($EM){$Ee.event("progress",$EM)}),$EL.on("error",null,function($EM){$Ec(null)}),$Ee.loader=$EL;var $E_=this;function $Ec($EM){$EL.offAll(),$EL._data=null,$EL._customParse=!1,$E_._endLoad($Ee,$EM instanceof Array?[$EM]:$EM),$E_._loaders.push($EL),$E_._loaderCount--,delete $E_._loaderMap[$Ee.url],$E_._next()}$EL._class=$Ee.clas,1<=$Ee.priority?($EL.priority=$Ee.priority,$EL.realTime=!1):($EL.priority=0,$EL.realTime=!0),$EL.load($Ee.url,$Ee.type,$Ee.cache,$Ee.group,$Ee.ignoreCache)},$Ee._endLoad=function($EM,$Ee){var $EL=$EM.url;if(null==$Ee){var $E_=this._failRes[$EL]||0;if($E_<this.retryNum)return console.warn("[warn]Retry to load:",$EL),this._failRes[$EL]=$E_+1,void $Ey.timer.once(this.retryDelay,this,this._addReTry,[$EM],!1);console.warn("[error]Failed to load:",$EL),this.event("error",$EL)}this._failRes[$EL]&&(this._failRes[$EL]=0),delete $EE._resMap[$EL],$EM.event("complete",$Ee),$EM.destroy(),$EM.offAll(),this._infoPool.push($EM)},$Ee._addReTry=function($EM){this._resInfos[this._maxPriority-1].push($EM),this._next()},$Ee.clearRes=function($EM,$Ee){void 0===$Ee&&($Ee=!1),$ETM.clearRes($EM,$Ee)},$Ee.getRes=function($EM){return $ETM.getRes($EM)},$Ee.cacheRes=function($EM,$Ee){$ETM.cacheRes($EM,$Ee)},$Ee.clearTextureRes=function($EM){$ETM.clearTextureRes($EM)},$Ee.setGroup=function($EM,$Ee){$ETM.setGroup($EM,$Ee)},$Ee.clearResByGroup=function($EM){$ETM.clearResByGroup($EM)},$Ee.clearUnLoaded=function(){for(var $EM=0;$EM<this._maxPriority;$EM++){for(var $Ee=this._resInfos[$EM],$EL=$Ee.length-1;-1<$EL;$EL--){var $E_=$Ee[$EL];$E_&&($E_.destroy(),$E_.offAll(),this._infoPool.push($E_))}$Ee.length=0}this._loaderCount=0,$EE._resMap={}},$Ee.cancelLoadByUrls=function($EM){if($EM)for(var $Ee=0,$EL=$EM.length;$Ee<$EL;$Ee++)this.cancelLoadByUrl($EM[$Ee])},$Ee.cancelLoadByUrl=function($EM){for(var $Ee=0;$Ee<this._maxPriority;$Ee++)for(var $EL=this._resInfos[$Ee],$E_=$EL.length-1;-1<$E_;$E_--){var $Ec=$EL[$E_];$Ec&&$Ec.url===$EM&&($EL[$E_]=null,$Ec.destroy(),$Ec.offAll(),this._infoPool.push($Ec))}$EE._resMap[$EM]&&delete $EE._resMap[$EM]},$Ee._loadAssets=function($EM,$EL,$EH,$Ee,$E_,$Ec,$Eq){null==$E_&&($E_=2),null==$Ec&&($Ec=!0);for(var $ET=$EM.length,$Ex=0,$EO=0,$Eu=[],$EG=!0,$EV=0;$EV<$ET;$EV++){var $EE=$EM[$EV];if(!$EE)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$EM);"string"==typeof $EE&&($EE={url:$EE,type:$Ee,size:1,priority:$E_}),$EE.size||($EE.size=1),$EE.progress=0,$EO+=$EE.size,$Eu.push($EE);var $Ed=$EH?$EK.create(null,$EC,[$EE],!1):null,$Er=$EL||$EH?$EK.create(null,$E$,[$EE]):null;this.load($EE.url,$Er,$Ed,$EE.type,null!=$EE.priority&&0<=$EE.priority?$EE.priority:2,$Ec,$EE.group||$Eq)}function $E$($EM,$Ee){$Ex++,$EM.progress=1,$Ee||($EG=!1),$Ex===$ET&&$EL&&$EL.runWith($EG)}function $EC($EM,$Ee){if(null!=$EH){$EM.progress=$Ee;for(var $EL=0,$E_=0;$E_<$Eu.length;$E_++){var $Ec=$Eu[$E_];$EL+=$Ec.size*$Ec.progress}var $Eq=$EL/$EO;$EH.runWith($Eq)}}return this},$EE.cacheRes=function($EM,$Ee){$ETM.cacheRes($EM,$Ee)},$EE._resMap={},$Ex($EE,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$EE.__init$=function(){$EV=function($EM){function $Ee(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$Ee.__super.call(this)}return $Eu($Ee,"",$EO),$Ee.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},$Ee}()},$EE}(),$EOM=(function($EM){function $Ec($EM){$Ec.__super.call(this),$EM||($EM=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $Ee=0,$EL=0,$E_=0;$E_<20;$E_++)$E_%5!=4?this._mat[$Ee++]=$EM[$E_]:this._alpha[$EL++]=$EM[$E_];this._action=$ES.createFilterAction(32),this._action.data=this}$Eu($Ec,"laya.filters.ColorFilter",$EC);var $Ee=$Ec.prototype;$Ey.imps($Ee,{"laya.filters.IFilter":!0}),$Ee.callNative=function($EM){$EM._$P.cf=this;$EM.conchModel&&$EM.conchModel.setFilterMatrix&&$EM.conchModel.setFilterMatrix(this._mat,this._alpha)},$Ed(0,$Ee,"type",function(){return 32}),$Ed(0,$Ee,"action",function(){return this._action})}(),function($EM){function $E_($EM,$Ee,$EL){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$Ee&&($Ee=0),$E_.__super.call(this),this._byteClass=$EL||$EJ,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$EM&&0<$Ee&&$Ee<65535&&this.connect($EM,$Ee)}$Eu($E_,"laya.net.Socket",$EO);var $Ee=$E_.prototype;$Ee.connect=function($EM,$Ee){var $EL="ws://"+$EM+":"+$Ee;$EL="https:"==$Eg.window.location.protocol?"wss://"+$EM+":"+$Ee:"ws://"+$EM+":"+$Ee,this.connectByUrl($EL)},$Ee.connectByUrl=function($EM){var $Ee=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $Eg.window.WebSocket($EM,this.protocols):this._socket=new $Eg.window.WebSocket($EM),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($EM){$Ee._onOpen($EM)},this._socket.onmessage=function($EM){$Ee._onMessage($EM)},this._socket.onclose=function($EM){$Ee._onClose($EM)},this._socket.onerror=function($EM){$Ee._onError($EM)}},$Ee.cleanSocket=function(){try{this._socket.close()}catch($EM){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$Ee.close=function(){if(null!=this._socket)try{this._socket.close()}catch($EM){}},$Ee._onOpen=function($EM){this._connected=!0,this.event("open",$EM)},$Ee._onMessage=function($EM){if($EM&&$EM.data){var $Ee=$EM.data;if(this.disableInput&&$Ee)this.event("message",$Ee);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $EL=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$Ee&&("string"==typeof $Ee?this._input.writeUTFBytes($Ee):this._input.writeArrayBuffer($Ee),this._addInputPosition=this._input.pos,this._input.pos=$EL),this.event("message",$Ee)}}},$Ee._onClose=function($EM){this._connected=!1,this.event("close",$EM)},$Ee._onError=function($EM){this.event("error",$EM)},$Ee.send=function($EM){this._socket.send($EM)},$Ee.flush=function(){if(this._output&&0<this._output.length){var $Ee;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($EM){$Ee=$EM}this._output.endian=this.endian,this._output.clear(),$Ee&&this.event("error",$Ee)}},$Ed(0,$Ee,"input",function(){return this._input}),$Ed(0,$Ee,"output",function(){return this._output}),$Ed(0,$Ee,"connected",function(){return this._connected}),$Ed(0,$Ee,"endian",function(){return this._endian},function($EM){this._endian=$EM,null!=this._input&&(this._input.endian=$EM),null!=this._output&&(this._output.endian=$EM)}),$E_.LITTLE_ENDIAN="littleEndian",$E_.BIG_ENDIAN="bigEndian"}(),function($EM){function $ET(){$ET.__super.call(this),this._$1__id=++$ET._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($ET._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$EF.currentResourceManager&&$EF.currentResourceManager.addResource(this)}$Eu($ET,"laya.resource.Resource",$EO);var $Ee=$ET.prototype;return $Ey.imps($Ee,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$Ee._setUrl=function($EM){var $Ee;this._url!==$EM&&(this._url&&(($Ee=$ET._urlResourcesMap[this._url]).splice($Ee.indexOf(this),1),0===$Ee.length&&delete $ET._urlResourcesMap[this._url]),$EM&&(($Ee=$ET._urlResourcesMap[$EM])||($ET._urlResourcesMap[$EM]=$Ee=[]),$Ee.push(this)),this._url=$EM)},$Ee._getGroup=function(){return this._group},$Ee._setGroup=function($EM){var $Ee;this._group!==$EM&&(this._group&&(($Ee=$ET._groupResourcesMap[this._group]).splice($Ee.indexOf(this),1),0===$Ee.length&&delete $ET._groupResourcesMap[this._group]),$EM&&(($Ee=$ET._groupResourcesMap[$EM])||($ET._groupResourcesMap[$EM]=$Ee=[]),$Ee.push(this)),this._group=$EM)},$Ee._addReference=function(){this._referenceCount++},$Ee._removeReference=function(){this._referenceCount--},$Ee._clearReference=function(){this._referenceCount=0},$Ee._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$Ee.recreateResource=function(){this.completeCreate()},$Ee.disposeResource=function(){},$Ee.activeResource=function($EM){void 0===$EM&&($EM=!1),this._lastUseFrameCount=$EZ.loopCount,!this._destroyed&&this.__loaded&&(this._released||$EM)&&this.recreateResource()},$Ee.releaseResource=function($EM){return void 0===$EM&&($EM=!0),!(!$EM&&this.lock)&&(!(this._released&&!$EM)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$Ee.onAsynLoaded=function($EM,$Ee,$EL){throw new Error("Resource: must override this function!")},$Ee.destroy=function(){var $EM;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $ET._idResourcesMap[this.id],this._url&&(($EM=$ET._urlResourcesMap[this._url])&&($EM.splice($EM.indexOf(this),1),0===$EM.length&&delete $ET._urlResourcesMap[this.url]),$ETM.clearRes(this._url),this.__loaded||$ES.cancelLoadByUrl(this._url)),this._group&&(($EM=$ET._groupResourcesMap[this._group]).splice($EM.indexOf(this),1),0===$EM.length&&delete $ET._groupResourcesMap[this.url]))},$Ee.completeCreate=function(){this._released=!1,this.event("recovered",this)},$Ee.dispose=function(){this.destroy()},$Ed(0,$Ee,"memorySize",function(){return this._memorySize},function($EM){var $Ee=$EM-this._memorySize;this._memorySize=$EM,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$Ee),this.resourceManager&&this.resourceManager.addSize($Ee)}),$Ed(0,$Ee,"_loaded",null,function($EM){this.__loaded=$EM}),$Ed(0,$Ee,"loaded",function(){return this.__loaded}),$Ed(0,$Ee,"id",function(){return this._$1__id}),$Ed(0,$Ee,"destroyed",function(){return this._destroyed}),$Ed(0,$Ee,"group",function(){return this._getGroup()},function($EM){this._setGroup($EM)}),$Ed(0,$Ee,"resourceManager",function(){return this._resourceManager}),$Ed(0,$Ee,"url",function(){return this._url}),$Ed(0,$Ee,"released",function(){return this._released}),$Ed(0,$Ee,"referenceCount",function(){return this._referenceCount}),$ET.getResourceByID=function($EM){return $ET._idResourcesMap[$EM]},$ET.getResourceByURL=function($EM,$Ee){return void 0===$Ee&&($Ee=0),null==$ET._urlResourcesMap[$EM]?null:$ET._urlResourcesMap[$EM][$Ee]},$ET.getResourceCountByURL=function($EM){return $ET._urlResourcesMap[$EM].length},$ET.destroyUnusedResources=function($EM){var $Ee;if($EM){var $EL=$ET._groupResourcesMap[$EM];if($EL)for(var $E_=$EL.slice(),$Ec=0,$Eq=$E_.length;$Ec<$Eq;$Ec++)($Ee=$E_[$Ec]).lock||0!==$Ee._referenceCount||$Ee.destroy()}else for(var $EH in $ET._idResourcesMap)($Ee=$ET._idResourcesMap[$EH]).lock||0!==$Ee._referenceCount||$Ee.destroy()},$ET._uniqueIDCounter=0,$ET._idResourcesMap={},$ET._urlResourcesMap={},$ET._groupResourcesMap={},$ET}()),$EuM=function($EM){function $Ek($EM,$Ee){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$Ek.__super.call(this),$EM&&null!=$EM._addReference&&$EM._addReference(),this.setTo($EM,$Ee)}$Eu($Ek,"laya.resource.Texture",$EO);var $Ee=$Ek.prototype;return $Ee._setUrl=function($EM){this.url=$EM},$Ee.setTo=function($EM,$Ee){if($EM instanceof $EH.HTMLElement){var $EL=$EXM.create("2D",$EM);this.bitmap=$EL}else this.bitmap=$EM;if(this.uv=$Ee||$Ek.DEF_UV,$EM){this._w=$EM.width,this._h=$EM.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $E_=this;if(this._loaded)$ES.addToAtlas&&$ES.addToAtlas($E_);else{var $Ec=$EM;$Ec instanceof laya.resource.HTMLImage&&$Ec.image&&$Ec.image.addEventListener("load",function($EM){$ES.addToAtlas&&$ES.addToAtlas($E_)},!1)}}},$Ee.active=function(){this.bitmap&&this.bitmap.activeResource()},$Ee.destroy=function($EM){if(void 0===$EM&&($EM=!1),this.alphaTexture&&(this.alphaTexture.destroy($EM),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $Ee=this.bitmap;$EM?($En.isConchApp&&$Ee.source&&$Ee.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$Ee.dispose(),$Ee._clearReference()):($Ee._removeReference(),0==$Ee.referenceCount&&($En.isConchApp&&$Ee.source&&$Ee.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$Ee.dispose())),this.url&&this===$Ey.loader.getRes(this.url)&&$Ey.loader.clearRes(this.url,$EM),this._loaded=!1}},$Ee.load=function($EM){var $Ee=this;this._loaded=!1,$EM=$Ea.customFormat($EM);var $EL=this.bitmap||(this.bitmap=$EWM.create($EM));$EL.uri=$EM,$EL&&$EL._addReference();var $E_=this;$EL.onload=function(){$EL.onload=null,$E_._loaded=!0,$Ee.sourceWidth=$Ee._w=$EL.width,$Ee.sourceHeight=$Ee._h=$EL.height,$E_.event("loaded",this),$ES.addToAtlas&&$ES.addToAtlas($E_)}},$Ee.addTextureToAtlas=function($EM){$ES.addTextureToAtlas(this)},$Ee.getPixels=function($EM,$Ee,$EL,$E_){if($En.isConchApp){var $Ec=this.bitmap;if($Ec.source&&$Ec.source.getImageData){var $Eq=$Ec.source.getImageData($EM,$Ee,$EL,$E_),$EH=new Uint8Array($Eq);return Array.from($EH)}return null}return $En.isWebGL?$ES.getTexturePixels(this,$EM,$Ee,$EL,$E_):($Eg.canvas.size($EL,$E_),$Eg.canvas.clear(),$Eg.context.drawTexture(this,-$EM,-$Ee,this.width,this.height,0,0),$Eg.context.getImageData(0,0,$EL,$E_).data)},$Ee.onAsynLoaded=function($EM,$Ee){if($Ee){if("function"!=typeof $Ee._addReference)throw new Error("bitmap._addReference is not a function. "+$Ee.className+" "+typeof $Ee._addReference+" "+$Ee.constructor);$Ee._addReference()}this.setTo($Ee,this.uv),this._loaded&&this.event("loaded",this)},$Ed(0,$Ee,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$Ed(0,$Ee,"loaded",function(){return this._loaded}),$Ed(0,$Ee,"released",function(){return!this.bitmap||this.bitmap.released}),$Ed(0,$Ee,"width",function(){return this._w?this._w:this.uv&&this.uv!==$Ek.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($EM){this._w=$EM,this.sourceWidth||(this.sourceWidth=$EM)}),$Ed(0,$Ee,"repeat",function(){return!$En.isWebGL||!this.bitmap||this.bitmap.repeat},function($EM){$EM&&$En.isWebGL&&this.bitmap&&(this.bitmap.repeat=$EM)&&(this.bitmap.enableMerageInAtlas=!1)}),$Ed(0,$Ee,"height",function(){return this._h?this._h:this.uv&&this.uv!==$Ek.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($EM){this._h=$EM,this.sourceHeight||(this.sourceHeight=$EM)}),$Ed(0,$Ee,"isLinearSampling",function(){return!$En.isWebGL||9728!=this.bitmap.minFifter},function($EM){!$EM&&$En.isWebGL&&($EM||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$Ek.moveUV=function($EM,$Ee,$EL){for(var $E_=0;$E_<8;$E_+=2)$EL[$E_]+=$EM,$EL[$E_+1]+=$Ee;return $EL},$Ek.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){void 0===$Eq&&($Eq=0),void 0===$EH&&($EH=0),void 0===$ET&&($ET=0),void 0===$Ex&&($Ex=0);var $EO=$EM instanceof laya.resource.Texture,$Eu=$EO?$EM.uv:$Ek.DEF_UV,$EG=$EO?$EM.bitmap:$EM,$EV=$ES.isAtlas($EG);if($EV){var $EE=$EG._atlaser,$Ed=$EM._atlasID;if(-1==$Ed)throw new Error("create texture error");$EG=$EE._inAtlasTextureBitmapValue[$Ed],$Eu=$EE._inAtlasTextureOriUVValue[$Ed]}var $Er=new $Ek($EG,null);$EG.width&&$Ee+$E_>$EG.width&&($E_=$EG.width-$Ee),$EG.height&&$EL+$Ec>$EG.height&&($Ec=$EG.height-$EL),$Er.width=$E_,$Er.height=$Ec,$Er.offsetX=$Eq,$Er.offsetY=$EH,$Er.sourceWidth=$ET||$E_,$Er.sourceHeight=$Ex||$Ec;var $E$=1/$EG.width,$EC=1/$EG.height;$Ee*=$E$,$EL*=$EC,$E_*=$E$,$Ec*=$EC;var $EK=$Er.uv[0],$EX=$Er.uv[1],$Eo=$Er.uv[4],$Ei=$Er.uv[5],$EW=$Eo-$EK,$Ey=$Ei-$EX,$EA=$Ek.moveUV($Eu[0],$Eu[1],[$Ee,$EL,$Ee+$E_,$EL,$Ee+$E_,$EL+$Ec,$Ee,$EL+$Ec]);$Er.uv=[$EK+$EA[0]*$EW,$EX+$EA[1]*$Ey,$Eo-(1-$EA[2])*$EW,$EX+$EA[3]*$Ey,$Eo-(1-$EA[4])*$EW,$Ei-(1-$EA[5])*$Ey,$EK+$EA[6]*$EW,$Ei-(1-$EA[7])*$Ey],$EV&&$Er.addTextureToAtlas();var $EB=$EG.scaleRate;return $EB&&1!=$EB?($Er.sourceWidth/=$EB,$Er.sourceHeight/=$EB,$Er.width/=$EB,$Er.height/=$EB,$Er.scaleRate=$EB,$Er.offsetX/=$EB,$Er.offsetY/=$EB):$Er.scaleRate=1,$Er},$Ek.createFromTexture=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EM.scaleRate;1!=$Eq&&($Ee*=$Eq,$EL*=$Eq,$E_*=$Eq,$Ec*=$Eq);var $EH=$EB.TEMP.setTo($Ee-$EM.offsetX,$EL-$EM.offsetY,$E_,$Ec),$ET=$EH.intersection($Ek._rect1.setTo(0,0,$EM.width,$EM.height),$Ek._rect2);if(!$ET)return null;var $Ex=$Ek.create($EM,$ET.x,$ET.y,$ET.width,$ET.height,$ET.x-$EH.x,$ET.y-$EH.y,$E_,$Ec);if($Ex.bitmap&&$Ex.bitmap._removeReference)return $Ex.bitmap._removeReference(),$Ex;var $EO="bitmap:"+($Ex.bitmap?$Ex.bitmap.constructor?$Ex.bitmap.constructor.name:$Ex.bitmap.__className:"")+", url:"+($EM.url+" | "+($Ex.bitmap?$Ex.bitmap.url:$EM.url))+", x="+$Ee+",y="+$EL+",width="+$E_+",height="+$Ec+", result="+($ET?$ET.x+","+$ET.y+","+$ET.width+","+$ET.height:"null")+", rect="+$EH.x+","+$EH.y+","+$EH.width+","+$EH.height;throw new Error("报错：bitmap._removeReference is not a function  "+$EO)},$Ek.DEF_UV=[0,0,1,0,1,1,0,1],$Ek.INV_UV=[0,1,1,1,1,0,0,0],$Ek._rect1=new $EB,$Ek._rect2=new $EB,$Ek}(),$EM=function($EM){var $ET;function $Eq(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$Eq.__super.call(this)}$Eu($Eq,"laya.utils.TimeLine",$EO);var $Ee=$Eq.prototype;return $Ee.to=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ec&&($Ec=0),this._create($EM,$Ee,$EL,$E_,$Ec,!0)},$Ee.from=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ec&&($Ec=0),this._create($EM,$Ee,$EL,$E_,$Ec,!1)},$Ee._create=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$EP.getItemByClass("tweenData",$ET);return $EH.isTo=$Eq,$EH.type=0,$EH.target=$EM,$EH.duration=$EL,$EH.data=$Ee,$EH.startTime=this._startTime+$Ec,$EH.endTime=$EH.startTime+$EH.duration,$EH.ease=$E_,this._startTime=Math.max($EH.endTime,this._startTime),this._tweenDataList.push($EH),this._startTimeSort=!0,this._endTimeSort=!0,this},$Ee.addLabel=function($EM,$Ee){var $EL=$EP.getItemByClass("tweenData",$ET);return $EL.type=1,$EL.data=$EM,$EL.endTime=$EL.startTime=this._startTime+$Ee,this._labelDic||(this._labelDic={}),this._labelDic[$EM]=$EL,this._tweenDataList.push($EL),this},$Ee.removeLabel=function($EM){if(this._labelDic&&this._labelDic[$EM]){var $Ee=this._labelDic[$EM];if($Ee){var $EL=this._tweenDataList.indexOf($Ee);-1<$EL&&this._tweenDataList.splice($EL,1)}delete this._labelDic[$EM]}},$Ee.gotoTime=function($EM){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $Ee,$EL,$E_,$Ec;for(var $Eq in this._firstTweenDic)if($EL=this._firstTweenDic[$Eq])for(var $EH in $EL)$EL.diyTarget.hasOwnProperty($EH)&&($EL.diyTarget[$EH]=$EL[$EH]);for($Eq in this._tweenDic)($Ee=this._tweenDic[$Eq]).clear(),delete this._tweenDic[$Eq];if(this._index=0,this._gidIndex=0,this._currTime=$EM,this._lastTime=$Eg.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$E_=this._tweenDataList.concat(),$E_.sort(function($EM,$Ee){return $EM.endTime>$Ee.endTime?1:$EM.endTime<$Ee.endTime?-1:0})}else $E_=this._endTweenDataList;for(var $ET=0,$Ex=$E_.length;$ET<$Ex;$ET++)if(0==($Ec=$E_[$ET]).type){if(!($EM>=$Ec.endTime))break;this._index=Math.max(this._index,$ET+1);var $EO=$Ec.data;if($Ec.isTo)for(var $Eu in $EO)$Ec.target[$Eu]=$EO[$Eu]}for($ET=0,$Ex=this._tweenDataList.length;$ET<$Ex;$ET++)0==($Ec=this._tweenDataList[$ET]).type&&$EM>=$Ec.startTime&&$EM<$Ec.endTime&&(this._index=Math.max(this._index,$ET+1),this._gidIndex++,($Ee=$EP.getItemByClass("tween",$EN))._create($Ec.target,$Ec.data,$Ec.duration,$Ec.ease,$EK.create(this,this._animComplete,[this._gidIndex]),0,!1,$Ec.isTo,!0,!1),$Ee.setStartTime(this._currTime-($EM-$Ec.startTime)),$Ee._updateEase(this._currTime),$Ee.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$Ee)}},$Ee.gotoLabel=function($EM){if(null!=this._labelDic){var $Ee=this._labelDic[$EM];$Ee&&this.gotoTime($Ee.startTime)}},$Ee.pause=function(){$Ey.timer.clear(this,this._update)},$Ee.resume=function(){this.play(this._currTime,this._loopKey)},$Ee.play=function($EM,$Ee){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($EM,$Ee){return $EM.startTime>$Ee.startTime?1:$EM.startTime<$Ee.startTime?-1:0});for(var $EL=0,$E_=this._tweenDataList.length;$EL<$E_;$EL++){var $Ec=this._tweenDataList[$EL];if(null!=$Ec&&0==$Ec.type){var $Eq=$Ec.target,$EH=$Eq.$_GID||($Eq.$_GID=$Es.getGID()),$ET=null;for(var $Ex in null==this._firstTweenDic[$EH]?(($ET={}).diyTarget=$Eq,this._firstTweenDic[$EH]=$ET):$ET=this._firstTweenDic[$EH],$Ec.data)null==$ET[$Ex]&&($ET[$Ex]=$Eq[$Ex])}}}"string"==typeof $EM?this.gotoLabel($EM):this.gotoTime($EM),this._loopKey=$Ee,this._lastTime=$Eg.now(),$Ey.timer.frameLoop(1,this,this._update)}},$Ee._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $EM in this._tweenDic)($Ee=this._tweenDic[$EM]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $Ee,$EL=$Eg.now(),$E_=$EL-this._lastTime,$Ec=this._currTime+=$E_*this.scale;for($EM in this._lastTime=$EL,this._tweenDic)($Ee=this._tweenDic[$EM])._updateEase($Ec);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $Eq=this._tweenDataList[this._index];$Ec>=$Eq.startTime&&(this._index++,0==$Eq.type?(this._gidIndex++,($Ee=$EP.getItemByClass("tween",$EN))._create($Eq.target,$Eq.data,$Eq.duration,$Eq.ease,$EK.create(this,this._animComplete,[this._gidIndex]),0,!1,$Eq.isTo,!0,!1),$Ee.setStartTime($Ec),$Ee.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$Ee)._updateEase($Ec)):this.event("label",$Eq.data))}},$Ee._animComplete=function($EM){this._tweenDic[$EM]&&delete this._tweenDic[$EM]},$Ee._complete=function(){this.event("complete")},$Ee.reset=function(){var $EM;if(this._labelDic)for($EM in this._labelDic)delete this._labelDic[$EM];for($EM in this._tweenDic)this._tweenDic[$EM].clear(),delete this._tweenDic[$EM];for($EM in this._firstTweenDic)delete this._firstTweenDic[$EM];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $Ee,$EL=0;for($Ee=this._tweenDataList.length,$EL=0;$EL<$Ee;$EL++)this._tweenDataList[$EL]&&this._tweenDataList[$EL].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$Ey.timer.clear(this,this._update)},$Ee.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$Ed(0,$Ee,"index",function(){return this._frameIndex},function($EM){this._frameIndex=$EM,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$Ed(0,$Ee,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$Eq.to=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ec&&($Ec=0),(new $Eq).to($EM,$Ee,$EL,$E_,$Ec)},$Eq.from=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$Ec&&($Ec=0),(new $Eq).from($EM,$Ee,$EL,$E_,$Ec)},$Eq.__init$=function(){$ET=function(){function $EM(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $Eu($EM,""),$EM.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$EP.recover("tweenData",this)},$EM}()},$Eq}(),$EGM=function($Ec){function $EL(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$EL.__super.call(this),this._style=$ET.EMPTY}$Eu($EL,"laya.display.Sprite",$Ec);var $EM=$EL.prototype;return $Ey.imps($EM,{"laya.display.ILayout":!0}),$EM.createConchModel=function(){return new ConchNode},$EM.destroy=function($EM){if(void 0===$EM&&($EM=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $Ee=this.mask;$Ee&&(this.mask=null,$Ee.destroy($EM))}$Ec.prototype.destroy.call(this,$EM),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$EM.updateZOrder=function(){$Es.updateOrder(this._childs)&&this.repaint()},$EM.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$EM.setBounds=function($EM){this._set$P("uBounds",$EM)},$EM.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $EB),$EB._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$EM.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $EB),$EB._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$EM._boundPointsToParent=function($EM){void 0===$EM&&($EM=!1);var $Ee=0,$EL=0;this._style&&($Ee=this._style._tf.translateX,$EL=this._style._tf.translateY,$EM=$EM||0!==this._style._tf.rotate,this._style.scrollRect&&($Ee+=this._style.scrollRect.x,$EL+=this._style.scrollRect.y));var $E_=this._getBoundPointsM($EM);if(!$E_||$E_.length<1)return $E_;if(8!=$E_.length&&($E_=$EM?$Ei.scanPList($E_):$EB._getWrapRec($E_,$EB.TEMP)._getBoundPoints()),!this.transform)return $Es.transPointList($E_,this._x-$Ee,this._y-$EL),$E_;var $Ec=$EA.TEMP,$Eq=0,$EH=$E_.length;for($Eq=0;$Eq<$EH;$Eq+=2)$Ec.x=$E_[$Eq],$Ec.y=$E_[$Eq+1],this.toParentPoint($Ec),$E_[$Eq]=$Ec.x,$E_[$Eq+1]=$Ec.y;return $E_},$EM.getGraphicBounds=function($EM){return void 0===$EM&&($EM=!1),this._graphics?this._graphics.getBounds($EM):$EB.TEMP.setTo(0,0,0,0)},$EM._getBoundPointsM=function($EM){if(void 0===$EM&&($EM=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $Ee=$Es.clearArray(this._$P.temBM),$EL=$EB.TEMP;return $EL.copyFrom(this.scrollRect),$Es.concatArray($Ee,$EL._getBoundPoints()),$Ee}for(var $E_,$Ec,$Eq,$EH=this._graphics?this._graphics.getBoundPoints():$Es.clearArray(this._$P.temBM),$ET=0,$Ex=($Eq=this._childs).length;$ET<$Ex;$ET++)($E_=$Eq[$ET])instanceof laya.display.Sprite&&1==$E_.visible&&($Ec=$E_._boundPointsToParent($EM))&&($EH=$EH?$Es.concatArray($EH,$Ec):$Ec);return $EH},$EM.getStyle=function(){return this._style===$ET.EMPTY&&(this._style=new $ET),this._style},$EM.setStyle=function($EM){this._style=$EM},$EM._adjustTransform=function(){this._tfChanged=!1;var $EM,$Ee=this._style._tf,$EL=$Ee.scaleX,$E_=$Ee.scaleY;if($Ee.rotate||1!==$EL||1!==$E_||$Ee.skewX||$Ee.skewY){($EM=this._transform||(this._transform=$Ep.create())).bTransform=!0;var $Ec=.0174532922222222*($Ee.rotate-$Ee.skewX),$Eq=.0174532922222222*($Ee.rotate+$Ee.skewY),$EH=Math.cos($Eq),$ET=Math.sin($Eq),$Ex=Math.sin($Ec),$EO=Math.cos($Ec);return $EM.a=$EL*$EH,$EM.b=$EL*$ET,$EM.c=-$E_*$Ex,$EM.d=$E_*$EO,$EM.tx=$EM.ty=0,$EM}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$EM},$EM.pos=function($EM,$Ee,$EL){if(void 0===$EL&&($EL=!1),this._x!==$EM||this._y!==$Ee){if(this.destroyed)return this;if($EL){this._x=$EM,this._y=$Ee,this.conchModel&&this.conchModel.pos(this._x,this._y);var $E_=this._parent;$E_&&0===$E_._repaint&&($E_._repaint=1,$E_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$EM,this.y=$Ee}return this},$EM.pivot=function($EM,$Ee){return this.pivotX=$EM,this.pivotY=$Ee,this},$EM.size=function($EM,$Ee){return this.width=$EM,this.height=$Ee,this},$EM.scale=function($EM,$Ee,$EL){void 0===$EL&&($EL=!1);var $E_=this.getStyle(),$Ec=$E_._tf;if($Ec.scaleX!=$EM||$Ec.scaleY!=$Ee){if(this.destroyed)return this;if($EL){$E_.setScale($EM,$Ee),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($EM,$Ee),this._renderType|=4;var $Eq=this._parent;$Eq&&0===$Eq._repaint&&($Eq._repaint=1,$Eq.parentRepaint())}else this.scaleX=$EM,this.scaleY=$Ee}return this},$EM.skew=function($EM,$Ee){return this.skewX=$EM,this.skewY=$Ee,this},$EM.render=function($EM,$Ee,$EL){$EZ.spriteCount++,$Ef.renders[this._renderType]._fun(this,$EM,$Ee+this._x,$EL+this._y),this._repaint=0},$EM.drawToCanvas=function($EM,$Ee,$EL,$E_){if($En.isConchNode){var $Ec=$EXM.create("2D");return new $El($EM,$Ee,$Ec).ctx.setCanvasType(1),this.conchModel.drawToCanvas($Ec.source,$EL,$E_),$Ec}return $ES.drawToCanvas(this,this._renderType,$EM,$Ee,$EL,$E_)},$EM.customRender=function($EM,$Ee,$EL){this._renderType|=1024},$EM._applyFilters=function(){var $EM;if(!$En.isWebGL&&(($EM=this._$P.filters)&&!($EM.length<1)))for(var $Ee=0,$EL=$EM.length;$Ee<$EL;$Ee++)$EM[$Ee].action.apply(this._$P.cacheCanvas)},$EM._isHaveGlowFilter=function(){var $EM,$Ee=0;if(this.filters)for($Ee=0;$Ee<this.filters.length;$Ee++)if(8==this.filters[$Ee].type)return!0;for($Ee=0,$EM=this._childs.length;$Ee<$EM;$Ee++)if(this._childs[$Ee]._isHaveGlowFilter())return!0;return!1},$EM.localToGlobal=function($EM,$Ee){void 0===$Ee&&($Ee=!1),!0===$Ee&&($EM=new $EA($EM.x,$EM.y));for(var $EL=this;$EL&&$EL!=$Ey.stage;)$EM=$EL.toParentPoint($EM),$EL=$EL.parent;return $EM},$EM.globalToLocal=function($EM,$Ee){void 0===$Ee&&($Ee=!1),$Ee&&($EM=new $EA($EM.x,$EM.y));for(var $EL=this,$E_=[];$EL&&$EL!=$Ey.stage;)$E_.push($EL),$EL=$EL.parent;for(var $Ec=$E_.length-1;0<=$Ec;)$EM=($EL=$E_[$Ec]).fromParentPoint($EM),$Ec--;return $EM},$EM.toParentPoint=function($EM){if(!$EM)return $EM;$EM.x-=this.pivotX,$EM.y-=this.pivotY,this.transform&&this._transform.transformPoint($EM),$EM.x+=this._x,$EM.y+=this._y;var $Ee=this._style.scrollRect;return $Ee&&($EM.x-=$Ee.x,$EM.y-=$Ee.y),$EM},$EM.fromParentPoint=function($EM){if(!$EM)return $EM;$EM.x-=this._x,$EM.y-=this._y;var $Ee=this._style.scrollRect;return $Ee&&($EM.x+=$Ee.x,$EM.y+=$Ee.y),this.transform&&this._transform.invertTransformPoint($EM),$EM.x+=this.pivotX,$EM.y+=this.pivotY,$EM},$EM.on=function($EM,$Ee,$EL,$E_){return 1!==this._mouseEnableState&&this.isMouseEvent($EM)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($EM,$Ee,$EL,$E_,!1)):$Ec.prototype.on.call(this,$EM,$Ee,$EL,$E_)},$EM.once=function($EM,$Ee,$EL,$E_){return 1!==this._mouseEnableState&&this.isMouseEvent($EM)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($EM,$Ee,$EL,$E_,!0)):$Ec.prototype.once.call(this,$EM,$Ee,$EL,$E_)},$EM._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $EM=this;for($EM=$EM.parent;$EM&&1!==$EM._mouseEnableState&&!$EM._getBit(2);)$EM.mouseEnabled=!0,$EM._setBit(2,!0),$EM=$EM.parent}},$EM.loadImage=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=this;return void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),this.graphics.loadImage($EM,$Ee,$EL,$E_,$Ec,function($EM){$EH.destroyed||($EH.size($Ee+($E_||$EM.width),$EL+($Ec||$EM.height)),$EH.repaint(),$Eq&&$Eq.runWith($EM))}),this},$EM.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$EM._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$EM._childChanged=function($EM){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$EM&&this._get$P("hasZorder")&&$Ey.timer.callLater(this,this.updateZOrder),this.repaint()},$EM.parentRepaint=function(){var $EM=this._parent;$EM&&0===$EM._repaint&&($EM._repaint=1,$EM.parentRepaint())},$EM.startDrag=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){void 0===$Ee&&($Ee=!1),void 0===$EL&&($EL=0),void 0===$E_&&($E_=300),void 0===$Eq&&($Eq=!1),void 0===$EH&&($EH=.92),this._$P.dragging||this._set$P("dragging",new $Ez),this._$P.dragging.start(this,$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH)},$EM.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$EM._releaseMem=function(){if(this._$P){var $EM=this._$P.cacheCanvas;$EM&&$EM.ctx&&($EP.recover("RenderContext",$EM.ctx),$EM.ctx.canvas.size(0,0),$EM.ctx=null);var $Ee=this._$P._filterCache;$Ee&&($Ee.destroy(),$Ee.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$EM._setDisplay=function($EM){$EM||this._releaseMem(),$Ec.prototype._setDisplay.call(this,$EM)},$EM.hitTestPoint=function($EM,$Ee){var $EL=this.globalToLocal($EA.TEMP.setTo($EM,$Ee));return $EM=$EL.x,$Ee=$EL.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$EB.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($EM,$Ee)},$EM.getMousePoint=function(){return this.globalToLocal($EA.TEMP.setTo($Ey.stage.mouseX,$Ey.stage.mouseY))},$EM._getWords=function(){return null},$EM._addChildsToLayout=function($EM){var $Ee=this._getWords();if(null==$Ee&&0==this._childs.length)return!1;if($Ee)for(var $EL=0,$E_=$Ee.length;$EL<$E_;$EL++)$EM.push($Ee[$EL]);$EL=0;for(var $Ec=this._childs.length;$EL<$Ec;++$EL){var $Eq=this._childs[$EL];$Eq._style._enableLayout()&&$Eq._addToLayout($EM)}return!0},$EM._addToLayout=function($EM){this._style.absolute||(this._style.block?$EM.push(this):this._addChildsToLayout($EM)&&(this.x=this.y=0))},$EM._isChar=function(){return!1},$EM._getCSSStyle=function(){return this._style.getCSSStyle()},$EM._setAttributes=function($EM,$Ee){switch($EM){case"x":this.x=parseFloat($Ee);break;case"y":this.y=parseFloat($Ee);break;case"width":this.width=parseFloat($Ee);break;case"height":this.height=parseFloat($Ee);break;default:this[$EM]=$Ee}},$EM._layoutLater=function(){this.parent&&this.parent._layoutLater()},$Ed(0,$EM,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($EM){this._optimizeScrollRect!=$EM&&(this._optimizeScrollRect=$EM,this.conchModel&&this.conchModel.optimizeScrollRect($EM))}),$Ed(0,$EM,"customRenderEnable",null,function($EM){if($EM&&(this._renderType|=1024,$En.isConchNode)){$EL.CustomList.push(this);var $Ee=new $EXM("2d");$Ee._setContext(new CanvasRenderingContext2D),this.customContext=new $El(0,0,$Ee),$Ee.context.setCanvasType&&$Ee.context.setCanvasType(2),this.conchModel.custom($Ee.context)}}),$Ed(0,$EM,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($EM){this.cacheAs=$EM?this._$P.hasFilter?"none":"normal":"none"}),$Ed(0,$EM,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($EM){var $Ee=this._$P.cacheCanvas;if($EM!==($Ee?$Ee.type:"none")){if("none"!==$EM)this._getBit(1)||this._setUpNoticeType(1),$Ee||($Ee=this._set$P("cacheCanvas",$EP.getItemByClass("cacheCanvas",Object))),$Ee.type=$EM,$Ee.reCache=!0,this._renderType|=16,"bitmap"==$EM&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($Ee){var $EL=$Ee;$EL&&$EL.ctx&&($EP.recover("RenderContext",$EL.ctx),$EL.ctx.canvas.size(0,0),$EL.ctx=null),$EP.recover("cacheCanvas",$Ee)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$Ed(0,$EM,"zOrder",function(){return this._zOrder},function($EM){this._zOrder!=$EM&&(this._zOrder=$EM,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($EM),this._parent&&($EM&&this._parent._set$P("hasZorder",!0),$Ey.timer.callLater(this._parent,this.updateZOrder)))}),$Ed(0,$EM,"rotation",function(){return this._style._tf.rotate},function($EM){var $Ee=this.getStyle();if($Ee._tf.rotate!==$EM){$Ee.setRotate($EM),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($EM),this._renderType|=4;var $EL=this._parent;$EL&&0===$EL._repaint&&($EL._repaint=1,$EL.parentRepaint())}}),$Ed(0,$EM,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($EM){this._width!==$EM&&(this._width=$EM,this.conchModel&&this.conchModel.size($EM,this._height),this.repaint())}),$Ed(0,$EM,"x",function(){return this._x},function($EM){if(this._x!==$EM){if(this.destroyed)return;this._x=$EM,this.conchModel&&this.conchModel.pos($EM,this._y);var $Ee=this._parent;$Ee&&0===$Ee._repaint&&($Ee._repaint=1,$Ee.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$Ed(0,$EM,"globalScaleY",function(){for(var $EM=1,$Ee=this;$Ee&&$Ee!==$Ey.stage;)$EM*=$Ee.scaleY,$Ee=$Ee.parent;return $EM}),$Ed(0,$EM,"hitArea",function(){return this._$P.hitArea},function($EM){this._set$P("hitArea",$EM)}),$Ed(0,$EM,"staticCache",function(){return this._$P.staticCache},function($EM){this._set$P("staticCache",$EM),$EM||this.reCache()}),$Ed(0,$EM,"texture",function(){return this._texture},function($EM){this._texture!=$EM&&(this._texture=$EM,this.graphics.cleanByTexture($EM,0,0))}),$Ed(0,$EM,"y",function(){return this._y},function($EM){if(this._y!==$EM){if(this.destroyed)return;this._y=$EM,this.conchModel&&this.conchModel.pos(this._x,$EM);var $Ee=this._parent;$Ee&&0===$Ee._repaint&&($Ee._repaint=1,$Ee.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$Ed(0,$EM,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($EM){this._height!==$EM&&(this._height=$EM,this.conchModel&&this.conchModel.size(this._width,$EM),this.repaint())}),$Ed(0,$EM,"blendMode",function(){return this._style.blendMode},function($EM){this.getStyle().blendMode=$EM,this.conchModel&&this.conchModel.blendMode($EM),$EM&&"source-over"!=$EM?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$Ed(0,$EM,"scaleX",function(){return this._style._tf.scaleX},function($EM){var $Ee=this.getStyle();if($Ee._tf.scaleX!==$EM){$Ee.setScaleX($EM),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($EM,$Ee._tf.scaleY),this._renderType|=4;var $EL=this._parent;$EL&&0===$EL._repaint&&($EL._repaint=1,$EL.parentRepaint())}}),$Ed(0,$EM,"scaleY",function(){return this._style._tf.scaleY},function($EM){var $Ee=this.getStyle();if($Ee._tf.scaleY!==$EM){$Ee.setScaleY($EM),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($Ee._tf.scaleX,$EM),this._renderType|=4;var $EL=this._parent;$EL&&0===$EL._repaint&&($EL._repaint=1,$EL.parentRepaint())}}),$Ed(0,$EM,"stage",function(){return $Ey.stage}),$Ed(0,$EM,"skewX",function(){return this._style._tf.skewX},function($EM){var $Ee=this.getStyle();if($Ee._tf.skewX!==$EM){$Ee.setSkewX($EM),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($EM,$Ee._tf.skewY),this._renderType|=4;var $EL=this._parent;$EL&&0===$EL._repaint&&($EL._repaint=1,$EL.parentRepaint())}}),$Ed(0,$EM,"scrollRect",function(){return this._style.scrollRect},function($EM){this.getStyle().scrollRect=$EM,this.repaint(),$EM?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($EM.x,$EM.y,$EM.width,$EM.height)):(this._renderType&=-129,this.conchModel&&($EL.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$Ed(0,$EM,"skewY",function(){return this._style._tf.skewY},function($EM){var $Ee=this.getStyle();if($Ee._tf.skewY!==$EM){$Ee.setSkewY($EM),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($Ee._tf.skewX,$EM),this._renderType|=4;var $EL=this._parent;$EL&&0===$EL._repaint&&($EL._repaint=1,$EL.parentRepaint())}}),$Ed(0,$EM,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($EM){this._tfChanged=!1,(this._transform=$EM)&&(this._x=$EM.tx,this._y=$EM.ty,$EM.tx=$EM.ty=0,this.conchModel&&this.conchModel.transform($EM.a,$EM.b,$EM.c,$EM.d,this._x,this._y)),$EM?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$Ed(0,$EM,"pivotX",function(){return this._style._tf.translateX},function($EM){this.getStyle().setTranslateX($EM),this.conchModel&&this.conchModel.pivot($EM,this._style._tf.translateY),this.repaint()}),$Ed(0,$EM,"pivotY",function(){return this._style._tf.translateY},function($EM){this.getStyle().setTranslateY($EM),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$EM),this.repaint()}),$Ed(0,$EM,"alpha",function(){return this._style.alpha},function($EM){this._style&&this._style.alpha!==$EM&&($EM=$EM<0?0:1<$EM?1:$EM,this.getStyle().alpha=$EM,this.conchModel&&this.conchModel.alpha($EM),1!==$EM?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$Ed(0,$EM,"visible",function(){return this._style.visible},function($EM){this._style&&this._style.visible!==$EM&&(this.getStyle().visible=$EM,this.conchModel&&this.conchModel.visible($EM),this.parentRepaint())}),$Ed(0,$EM,"graphics",function(){return this._graphics||(this.graphics=$ES.createGraphics())},function($EM){this._graphics&&(this._graphics._sp=null),(this._graphics=$EM)?(this._renderType&=-2,this._renderType|=512,($EM._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($EL.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$Ed(0,$EM,"filters",function(){return this._$P.filters},function($EM){$EM&&0===$EM.length&&($EM=null),this._$P.filters!=$EM&&(this._set$P("filters",$EM?$EM.slice():null),$En.isConchApp&&(this.conchModel&&($EL.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$En.isWebGL&&($EM&&$EM.length?this._renderType|=32:this._renderType&=-33),$EM&&0<$EM.length?(this._getBit(1)||this._setUpNoticeType(1),$En.isWebGL&&1==$EM.length&&$EM[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($En.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$Ed(0,$EM,"parent",$Ec.prototype._$get_parent,function($EM){$Ey.superSet($EMM,this,"parent",$EM),$EM&&this._getBit(2)&&this._$2__onDisplay()}),$Ed(0,$EM,"mask",function(){return this._$P._mask},function($EM){$EM&&this.mask&&this.mask._$P.maskParent||($EM?(this.cacheAs="bitmap",this._set$P("_mask",$EM),$EM._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$EM),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($EM?$EM.conchModel:null),this._renderType|=64,this.parentRepaint())}),$Ed(0,$EM,"mouseEnabled",function(){return 1<this._mouseEnableState},function($EM){this._mouseEnableState=$EM?2:1}),$Ed(0,$EM,"globalScaleX",function(){for(var $EM=1,$Ee=this;$Ee&&$Ee!==$Ey.stage;)$EM*=$Ee.scaleX,$Ee=$Ee.parent;return $EM}),$Ed(0,$EM,"mouseX",function(){return this.getMousePoint().x}),$Ed(0,$EM,"mouseY",function(){return this.getMousePoint().y}),$EL.fromImage=function($EM){return(new $EL).loadImage($EM)},$EL._cachePool=[],$EL.CustomList=[],$Ex($EL,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$EH.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$EL}($EMM),$EVM=function($EM){function $Ee($EM){this._audio=null,this._onEnd=null,this._resumePlay=null,$Ee.__super.call(this),this._onEnd=$Es.bind(this.__onEnd,this),this._resumePlay=$Es.bind(this.__resumePlay,this),$EM.addEventListener("ended",this._onEnd),this._audio=$EM}$Eu($Ee,"laya.media.h5audio.AudioSoundChannel",$E_M);var $EL=$Ee.prototype;return $EL.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($Ey.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$EL.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$Eg.container.appendChild(this._audio),this._audio.play()}catch($EM){this.event("error")}},$EL.play=function($EM){this.isStopped=!1;try{this._audio.playbackRate=$Et.playbackRate,this._audio.currentTime=this.startTime}catch($EM){return void this._audio.addEventListener("canplay",this._resumePlay)}$Et.addChannel(this),$Eg.container.appendChild(this._audio),!$EM&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$EL.stop=function(){this.isStopped=!0,$Et.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$En.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$Eg.onIE||this._audio!=$ELM._musicAudio&&$EP.recover("audio:"+this.url,this._audio),$Eg.removeElement(this._audio),this._audio=null)},$EL.pause=function(){this.isStopped=!0,$Et.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$EL.resume=function(){this._audio&&(this.isStopped=!1,$Et.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$Ed(0,$EL,"position",function(){return this._audio?this._audio.currentTime:0}),$Ed(0,$EL,"duration",function(){return this._audio?this._audio.duration:0}),$Ed(0,$EL,"volume",function(){return this._audio?this._audio.volume:1},function($EM){this._audio&&(this._audio.volume=$EM)}),$Ee}(),$EEM=function($EM){function $Ee(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$EqM.ctx,$Ee.__super.call(this),this._onPlayEnd=$Es.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$Eu($Ee,"laya.media.webaudio.WebAudioSoundChannel",$E_M);var $EL=$Ee.prototype;return $EL.play=function($EM){if($Et.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $Ee=this.context,$EL=this.gain,$E_=$Ee.createBufferSource();(this.bufferSource=$E_).buffer=this.audioBuffer,$E_.connect($EL),$EL&&$EL.disconnect(),$EL.connect($Ee.destination),$E_.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$Eg.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($E_.loop=!0),$E_.playbackRate.setTargetAtTime?$E_.playbackRate.setTargetAtTime($Et.playbackRate,this.context.currentTime,.1):$E_.playbackRate.value=$Et.playbackRate,$E_.start(0,this.startTime),!$EM&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$EL.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($Ey.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$EL._clearBufferSource=function(){if(this.bufferSource){var $EM=this.bufferSource;$EM.stop?$EM.stop(0):$EM.noteOff(0),$EM.disconnect(0),$EM.onended=null,$Ee._tryCleanFailed||this._tryClearBuffer($EM),this.bufferSource=null}},$EL._tryClearBuffer=function($EM){try{$EM.buffer=null}catch($EM){$Ee._tryCleanFailed=!0}},$EL.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$Et.removeChannel(this),this.startHandler=null,this.completeHandler=null},$EL.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$Et.removeChannel(this)},$EL.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$Ed(0,$EL,"position",function(){return this.bufferSource?($Eg.now()-this._startTime)/1e3+this.startTime:0}),$Ed(0,$EL,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$Ed(0,$EL,"volume",function(){return this._volume},function($EM){this.isStopped||(this._volume=$EM,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($EM,this.context.currentTime,.1):this.gain.gain.value=$EM)}),$Ee._tryCleanFailed=!1,$Ee}(),$EdM=function($EM){function $Ee(){$Ee.__super.call(this),this._w=0,this._h=0}$Eu($Ee,"laya.resource.Bitmap",$EOM);var $EL=$Ee.prototype;return $Ed(0,$EL,"width",function(){return this._w}),$Ed(0,$EL,"height",function(){return this._h}),$Ed(0,$EL,"source",function(){return this._source}),$Ee}(),$ErM=function($Ee){function $EM(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$EM.__super.call(this),this._interval=$E_.animationInterval,this._setUpNoticeType(1)}$Eu($EM,"laya.display.AnimationPlayerBase",$Ee);var $EL=$EM.prototype;return $EL.play=function($EM,$Ee,$EL,$E_){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=!0),void 0===$EL&&($EL=""),void 0===$E_&&($E_=!0),this._isPlaying=!0,this.index="string"==typeof $EM?this._getFrameByLabel($EM):$EM,this.loop=$Ee,this._actionName=$EL,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$EL._getFrameByLabel=function($EM){var $Ee=0;for($Ee=0;$Ee<this._count;$Ee++)if(this._labels[$Ee]&&0<=this._labels[$Ee].indexOf($EM))return $Ee;return 0},$EL._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$EL._setControlNode=function($EM){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$EM)&&$EM!=this&&($EM.on("display",this,this._checkResumePlaying),$EM.on("undisplay",this,this._checkResumePlaying))},$EL._setDisplay=function($EM){$Ee.prototype._setDisplay.call(this,$EM),this._checkResumePlaying()},$EL._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$EL.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$EL.addLabel=function($EM,$Ee){this._labels||(this._labels={}),this._labels[$Ee]||(this._labels[$Ee]=[]),this._labels[$Ee].push($EM)},$EL.removeLabel=function($EM){if($EM){if(this._labels)for(var $Ee in this._labels)this._removeLabelFromLabelList(this._labels[$Ee],$EM)}else this._labels=null},$EL._removeLabelFromLabelList=function($EM,$Ee){if($EM)for(var $EL=$EM.length-1;0<=$EL;$EL--)$EM[$EL]==$Ee&&$EM.splice($EL,1)},$EL.gotoAndStop=function($EM){this.index="string"==typeof $EM?this._getFrameByLabel($EM):$EM,this.stop()},$EL._displayToIndex=function($EM){},$EL.clear=function(){this.stop(),this._labels=null},$Ed(0,$EL,"interval",function(){return this._interval},function($EM){this._interval!=$EM&&(this._frameRateChanged=!0,this._interval=$EM,this._isPlaying&&0<$EM&&this.timerLoop($EM,this,this._frameLoop,null,!0,!0))}),$Ed(0,$EL,"isPlaying",function(){return this._isPlaying}),$Ed(0,$EL,"index",function(){return this._index},function($EM){if(this._index=$EM,this._displayToIndex($EM),this._labels&&this._labels[$EM])for(var $Ee=this._labels[$EM],$EL=0,$E_=$Ee.length;$EL<$E_;$EL++)this.event("label",$Ee[$EL])}),$Ed(0,$EL,"count",function(){return this._count}),$EM.WRAP_POSITIVE=0,$EM.WRAP_REVERSE=1,$EM.WRAP_PINGPONG=2,$EM}($EGM),$E$M=function($Ee){function $EE(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$EE.__super.call(this),this.overflow=$EE.VISIBLE,this._style=new $EeM(this),this._style.wordWrap=!1}$Eu($EE,"laya.display.Text",$Ee);var $EM=$EE.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$EM._getBoundPointsM=function($EM){void 0===$EM&&($EM=!1);var $Ee=$EB.TEMP;return $Ee.setTo(0,0,this.width,this.height),$Ee._getBoundPoints()},$EM.getGraphicBounds=function($EM){void 0===$EM&&($EM=!1);var $Ee=$EB.TEMP;return $Ee.setTo(0,0,this.width,this.height),$Ee},$EM._getCSSStyle=function(){return this._style},$EM.lang=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu){if($EM=$EE.langPacks&&$EE.langPacks[$EM]?$EE.langPacks[$EM]:$EM,arguments.length<2)this._text=$EM;else{for(var $EG=0,$EV=arguments.length;$EG<$EV;$EG++)$EM=$EM.replace("{"+$EG+"}",arguments[$EG+1]);this._text=$EM}},$EM._isPassWordMode=function(){var $EM=this._style.password;return"prompt"in this&&this.prompt==this._text&&($EM=!1),$EM},$EM._getPassWordTxt=function($EM){var $Ee;$Ee="";for(var $EL=$EM.length;0<$EL;$EL--)$Ee+="●";return $Ee},$EM.renderText=function($EM,$Ee){var $EL=this.graphics;$EL.clear(!0);var $E_=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($Eg.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$Eg.context.font=$E_;var $Ec=this.padding,$Eq=$Ec[3],$EH="left",$ET=this._lines,$Ex=this.leading+this._charSize.height,$EO=this._currBitmapFont;$EO&&($Ex=this.leading+$EO.getMaxHeight());var $Eu=$Ec[0];if(!$EO&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($EH="right",$Eq=this._width-$Ec[1]):"center"==this.align&&($EH="center",$Eq=.5*this._width+$Ec[3]-$Ec[1])),0<this._height){var $EG=this._textHeight>this._height?"top":this.valign;"middle"===$EG?$Eu=.5*(this._height-$Ee*$Ex)+$Ec[0]-$Ec[2]:"bottom"===$EG&&($Eu=this._height-$Ee*$Ex-$Ec[2])}var $EV=this._style;if($EO&&$EO.autoScaleSize)var $EE=$EO.fontSize/this.fontSize;if(this._clipPoint)if($EL.save(),$EO&&$EO.autoScaleSize){var $Ed=0,$Er=0;$Ed=this._width?this._width-$Ec[3]-$Ec[1]:this._textWidth,$Er=this._height?this._height-$Ec[0]-$Ec[2]:this._textHeight,$Ed*=$EE,$Er*=$EE,$EL.clipRect($Ec[3],$Ec[0],$Ed,$Er)}else $EL.clipRect($Ec[3],$Ec[0],this._width?this._width-$Ec[3]-$Ec[1]:this._textWidth,this._height?this._height-$Ec[0]-$Ec[2]:this._textHeight);var $E$=$EV.password;"prompt"in this&&this.prompt==this._text&&($E$=!1);for(var $EC=0,$EK=0,$EX=Math.min(this._lines.length,$Ee+$EM)||1,$Eo=$EM;$Eo<$EX;$Eo++){var $Ei,$EW=$ET[$Eo];if($E$){var $Ey=$EW.length;$EW="";for(var $EA=$Ey;0<$EA;$EA--)$EW+="●"}if($EC=$Eq-(this._clipPoint?this._clipPoint.x:0),$EK=$Eu+$Ex*$Eo-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($EH,$EC,$EK,$Eo),$EO){var $EB=this.width;$EO.autoScaleSize&&($EB=this.width*$EE),$EO.drawText($EW,this,$EC,$EK,this.align,$EB)}else $En.isWebGL?(this._words||(this._words=[]),($Ei=this._words.length>$Eo-$EM?this._words[$Eo-$EM]:new $EI).setText($EW)):$Ei=$EW,$EV.stroke?$EL.fillBorderText($Ei,$EC,$EK,$E_,this.color,$EV.strokeColor,$EV.stroke,$EH):$EL.fillText($Ei,$EC,$EK,$E_,this.color,$EH)}if($EO&&$EO.autoScaleSize){var $Ek=1/$EE;this.scale($Ek,$Ek)}this._clipPoint&&$EL.restore(),this._startX=$Eq,this._startY=$Eu},$EM.drawUnderline=function($EM,$Ee,$EL,$E_){var $Ec=this._lineWidths[$E_];switch($EM){case"center":$Ee-=$Ec/2;break;case"right":$Ee-=$Ec}$EL+=this._charSize.height,this._graphics.drawLine($Ee,$EL,$Ee+$Ec,$EL,this.underlineColor||this.color,1)},$EM.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$Eg.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $EA(0,0)):this._clipPoint=null;var $EM=this._lines.length;if(this.overflow!=$EE.VISIBLE){var $Ee=this.overflow==$EE.HIDDEN?Math.floor:Math.ceil;$EM=Math.min($EM,$Ee((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $EL=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($EL,$EM),this.repaint()},$EM.evalTextSize=function(){var $EM,$Ee=NaN;$EM=Math.max.apply(this,this._lineWidths),$Ee=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$EM==this._textWidth&&$Ee==this._textHeight||(this._textWidth=$EM,this._textHeight=$Ee,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$EM.checkEnabledViewportOrNot=function(){return this.overflow==$EE.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$EM.changeText=function($EM){this._text!==$EM&&(this.lang($EM+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$EM.parseLines=function($EM){var $Ee=this.wordWrap||this.overflow==$EE.HIDDEN;if($Ee)var $EL=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $E_=$Es.contextMeasureText($EE._testWord);$En.isConchApp&&0===$E_.width&&0===$E_.height&&($E_=$Es.contextMeasureText("W")),this._charSize.width=$E_.width,this._charSize.height=$E_.height||this.fontSize}for(var $Ec=$EM.replace(/\r\n/g,"\n").split("\n"),$Eq=0,$EH=$Ec.length;$Eq<$EH;$Eq++){var $ET=$Ec[$Eq];$Ee?this.parseLine($ET,$EL):(this._lineWidths.push(this.getTextWidth($ET)),this._lines.push($ET))}},$EM.parseLine=function($EM,$Ee){$Eg.context;var $EL,$E_=this._lines,$Ec=0,$Eq=NaN,$EH=NaN,$ET=0;if(($Eq=this.getTextWidth($EM))<=$Ee)return $E_.push($EM),void this._lineWidths.push($Eq);$Eq=this._charSize.width,0==($Ec=Math.floor($Ee/$Eq))&&($Ec=1),$EH=$Eq=this.getTextWidth($EM.substring(0,$Ec));for(var $Ex=$Ec,$EO=$EM.length;$Ex<$EO;$Ex++)if($Ee<($EH+=$Eq=this.getTextWidth($EM.charAt($Ex))))if(this.wordWrap){var $Eu=$EM.substring($ET,$Ex);if($Eu.charCodeAt($Eu.length-1)<255?($EL=/(?:\w|-)+$/.exec($Eu))&&($Ex=$EL.index+$ET,0==$EL.index?$Ex+=$Eu.length:$Eu=$EM.substring($ET,$Ex)):$EE.RightToLeft&&($EL=/([\u0600-\u06FF])+$/.exec($Eu))&&($Ex=$EL.index+$ET,0==$EL.index?$Ex+=$Eu.length:$Eu=$EM.substring($ET,$Ex)),$E_.push($Eu),this._lineWidths.push($EH-$Eq),!(($ET=$Ex)+$Ec<$EO)){$E_.push($EM.substring($ET,$EO)),this._lineWidths.push(this.getTextWidth($E_[$E_.length-1])),$ET=-1;break}$Ex+=$Ec,$EH=$Eq=this.getTextWidth($EM.substring($ET,$Ex)),$Ex--}else if(this.overflow==$EE.HIDDEN)return $E_.push($EM.substring(0,$Ex)),void this._lineWidths.push(this.getTextWidth($E_[$E_.length-1]));this.wordWrap&&-1!=$ET&&($E_.push($EM.substring($ET,$EO)),this._lineWidths.push(this.getTextWidth($E_[$E_.length-1])))},$EM.getTextWidth=function($EM){return this._currBitmapFont?this._currBitmapFont.getTextWidth($EM):$Es.contextMeasureText($EM).width},$EM.getWordWrapWidth=function(){var $EM=this.padding,$Ee=NaN;return($Ee=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($Ee=this.wordWrap?100:$Eg.width),$Ee<=0&&($Ee=100),$Ee-$EM[3]-$EM[1]},$EM.getCharPoint=function($EM,$Ee){this._isChanged&&$Ey.timer.runCallLater(this,this.typeset);for(var $EL=0,$E_=this._lines,$Ec=0,$Eq=0,$EH=$E_.length;$Eq<$EH;$Eq++){if($EM<($EL+=$E_[$Eq].length)){var $ET=$Eq;break}$Ec=$EL}var $Ex=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$Eg.context.font=$Ex;var $EO=this.getTextWidth(this._text.substring($Ec,$EM));return($Ee||new $EA).setTo(this._startX+$EO-(this._clipPoint?this._clipPoint.x:0),this._startY+$ET*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$Ed(0,$EM,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($EM){$EM!=this._width&&($Ey.superSet($EGM,this,"width",$EM),this.isChanged=!0)}),$Ed(0,$EM,"textWidth",function(){return this._isChanged&&$Ey.timer.runCallLater(this,this.typeset),this._textWidth}),$Ed(0,$EM,"height",function(){return this._height?this._height:this.textHeight},function($EM){$EM!=this._height&&($Ey.superSet($EGM,this,"height",$EM),this.isChanged=!0)}),$Ed(0,$EM,"textHeight",function(){return this._isChanged&&$Ey.timer.runCallLater(this,this.typeset),this._textHeight}),$Ed(0,$EM,"padding",function(){return this._getCSSStyle().padding},function($EM){this._getCSSStyle().padding=$EM,this.isChanged=!0}),$Ed(0,$EM,"bold",function(){return this._getCSSStyle().bold},function($EM){this._getCSSStyle().bold=$EM,this.isChanged=!0}),$Ed(0,$EM,"text",function(){return this._text||""},function($EM){this._text!==$EM&&(this.lang($EM+""),this.isChanged=!0,this.event("change"))}),$Ed(0,$EM,"color",function(){return this._getCSSStyle().color},function($EM){this._getCSSStyle().color!=$EM&&(this._getCSSStyle().color=$EM,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$Ed(0,$EM,"font",function(){return this._getCSSStyle().fontFamily},function($EM){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$EE._bitmapFonts&&$EE._bitmapFonts[$EM]&&(this._currBitmapFont=$EE._bitmapFonts[$EM]),this._getCSSStyle().fontFamily=$EM,this.isChanged=!0}),$Ed(0,$EM,"fontSize",function(){return this._getCSSStyle().fontSize},function($EM){this._getCSSStyle().fontSize=$EM,this.isChanged=!0}),$Ed(0,$EM,"italic",function(){return this._getCSSStyle().italic},function($EM){this._getCSSStyle().italic=$EM,this.isChanged=!0}),$Ed(0,$EM,"align",function(){return this._getCSSStyle().align},function($EM){this._getCSSStyle().align=$EM,this.isChanged=!0}),$Ed(0,$EM,"valign",function(){return this._getCSSStyle().valign},function($EM){this._getCSSStyle().valign=$EM,this.isChanged=!0}),$Ed(0,$EM,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($EM){this._getCSSStyle().wordWrap=$EM,this.isChanged=!0}),$Ed(0,$EM,"leading",function(){return this._getCSSStyle().leading},function($EM){this._getCSSStyle().leading=$EM,this.isChanged=!0}),$Ed(0,$EM,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($EM){this._getCSSStyle().backgroundColor=$EM,this.isChanged=!0}),$Ed(0,$EM,"borderColor",function(){return this._getCSSStyle().borderColor},function($EM){this._getCSSStyle().borderColor=$EM,this.isChanged=!0}),$Ed(0,$EM,"stroke",function(){return this._getCSSStyle().stroke},function($EM){this._getCSSStyle().stroke=$EM,this.isChanged=!0}),$Ed(0,$EM,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($EM){this._getCSSStyle().strokeColor=$EM,this.isChanged=!0}),$Ed(0,$EM,"isChanged",null,function($EM){this._isChanged!==$EM&&(this._isChanged=$EM)&&$Ey.timer.callLater(this,this.typeset)}),$Ed(0,$EM,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($EM){if(!(this.overflow!=$EE.SCROLL||this.textWidth<this._width)&&this._clipPoint){$EM=$EM<this.padding[3]?this.padding[3]:$EM;var $Ee=this._textWidth-this._width;$EM=$Ee<$EM?$Ee:$EM;var $EL=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$EM,this.renderText(this._lastVisibleLineIndex,$EL)}}),$Ed(0,$EM,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($EM){if(!(this.overflow!=$EE.SCROLL||this.textHeight<this._height)&&this._clipPoint){$EM=$EM<this.padding[0]?this.padding[0]:$EM;var $Ee=this._textHeight-this._height,$EL=($EM=$Ee<$EM?$Ee:$EM)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$EL;var $E_=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$EM,this.renderText($EL,$E_)}}),$Ed(0,$EM,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$Ed(0,$EM,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$Ed(0,$EM,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$Ed(0,$EM,"underlineColor",function(){return this._underlineColor},function($EM){this._underlineColor=$EM,this._isChanged=!0,this.typeset()}),$EE.registerBitmapFont=function($EM,$Ee){$EE._bitmapFonts||($EE._bitmapFonts={}),$EE._bitmapFonts[$EM]=$Ee},$EE.unregisterBitmapFont=function($EM,$Ee){if(void 0===$Ee&&($Ee=!0),$EE._bitmapFonts&&$EE._bitmapFonts[$EM]){var $EL=$EE._bitmapFonts[$EM];$Ee&&$EL.destroy(),delete $EE._bitmapFonts[$EM]}},$EE.setTextRightToLeft=function(){var $EM;($EM=$Eg.canvas.source.style).display="none",$EM.position="absolute",$EM.direction="rtl",$En._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$Eg.document.body.appendChild($Eg.canvas.source)},$EE.supportFont=function($EM){$Eg.context.font="10px sans-serif";var $Ee=$Es.contextMeasureText("abcji").width;$Eg.context.font="10px "+$EM;var $EL=$Es.contextMeasureText("abcji").width;return console.log($Ee,$EL),$Ee!==$EL},$EE._testWord="游",$EE.langPacks=null,$EE.VISIBLE="visible",$EE.SCROLL="scroll",$EE.HIDDEN="hidden",$EE.CharacterCache=!0,$EE.RightToLeft=!1,$EE._bitmapFonts=null,$Ex($EE,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$EE}($EGM),$ECM=function($EG){function $EH(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$EH.__super.call(this),this.offset=new $EA,this._canvasTransform=new $Ep,this._previousOrientation=$Eg.window.orientation;var $Ee=this;this.transform=$Ep.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $EM=$Eg.window,$EL=this;$EM.addEventListener("focus",function(){$Ee._isFocused=!0,$EL.event("focus"),$EL.event("focuschange")}),$EM.addEventListener("blur",function(){$Ee._isFocused=!1,$EL.event("blur"),$EL.event("focuschange"),$EL._isInputting()&&($EiM.inputElement.target.focus=!1)});var $E_="visibilityState",$Ec="visibilitychange",$Eq=$EM.document;void 0!==$Eq.hidden?($Ec="visibilitychange",$E_="visibilityState"):void 0!==$Eq.mozHidden?($Ec="mozvisibilitychange",$E_="mozVisibilityState"):void 0!==$Eq.msHidden?($Ec="msvisibilitychange",$E_="msVisibilityState"):void 0!==$Eq.webkitHidden&&($Ec="webkitvisibilitychange",$E_="webkitVisibilityState"),$EM.document.addEventListener($Ec,function(){"hidden"==$Eg.document[$E_]?$EL._setStageVisible(!1):$EL._setStageVisible(!0)}),$EM.document.addEventListener("qbrowserVisibilityChange",function($EM){$EL._setStageVisible(!$EM.hidden)}),$EM.addEventListener("resize",function(){var $EM=$Eg.window.orientation;null!=$EM&&$EM!=$Ee._previousOrientation&&$EL._isInputting()&&($EiM.inputElement.target.focus=!1),$Ee._previousOrientation=$EM,$EL._isInputting()||$EL._resetCanvas()}),$EM.addEventListener("orientationchange",function($EM){$EL._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$Eg.onMobile&&this.on("mousedown",this,this._onmouseMove)}$Eu($EH,"laya.display.Stage",$EG);var $EM=$EH.prototype;return $EM._setStageVisible=function($EM){this._isVisibility!=$EM&&(this._isVisibility=$EM,this._isVisibility||this._isInputting()&&($EiM.inputElement.target.focus=!1),this.event("visibilitychange"))},$EM._isInputting=function(){return $Eg.onMobile&&$EiM.isInputting},$EM._changeCanvasSize=function(){this.setScreenSize($Eg.clientWidth*$Eg.pixelRatio,$Eg.clientHeight*$Eg.pixelRatio)},$EM._resetCanvas=function(){if(this.screenAdaptationEnabled){var $EM=$En._mainCanvas;$EM.source.style;$EM.size(1,1),$Ey.timer.once(100,this,this._changeCanvasSize)}},$EM.setScreenSize=function($EM,$Ee){var $EL=!1;if("none"!==this._screenMode&&($EL=($EM/$Ee<1?"vertical":"horizontal")!==this._screenMode)){var $E_=$Ee;$Ee=$EM,$EM=$E_}this.canvasRotation=$EL;var $Ec=$En._mainCanvas,$Eq=$Ec.source.style,$EH=this._canvasTransform.identity(),$ET=this._scaleMode,$Ex=$EM/this.designWidth,$EO=$Ee/this.designHeight,$Eu=this.designWidth,$EG=this.designHeight,$EV=$EM,$EE=$Ee,$Ed=$Eg.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$ET){case"noscale":$Ex=$EO=1,$EV=this.designWidth,$EE=this.designHeight;break;case"showall":$Ex=$EO=Math.min($Ex,$EO),$Eu=$EV=Math.round(this.designWidth*$Ex),$EG=$EE=Math.round(this.designHeight*$EO);break;case"noborder":$Ex=$EO=Math.max($Ex,$EO),$EV=Math.round(this.designWidth*$Ex),$EE=Math.round(this.designHeight*$EO);break;case"full":$Ex=$EO=1,this._width=$Eu=$EM,this._height=$EG=$Ee;break;case"fixedwidth":$EO=$Ex,this._height=$EG=Math.round($Ee/$Ex);break;case"fixedheight":$Ex=$EO,this._width=$Eu=Math.round($EM/$EO);break;case"fixedauto":$EM/$Ee<this.designWidth/this.designHeight?($EO=$Ex,this._height=$EG=Math.round($Ee/$Ex)):($Ex=$EO,this._width=$Eu=Math.round($EM/$EO))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$Eu=$Eu+1&2147483646,$EG=$EG+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$Ex*=this.scaleX,$EO*=this.scaleY,1===$Ex&&1===$EO?this.transform.identity():(this.transform.a=this._formatData($Ex/($EV/$Eu)),this.transform.d=this._formatData($EO/($EE/$EG)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$Ec.size($Eu,$EG),$ES.changeWebGLSize($Eu,$EG),$EH.scale($EV/$Eu/$Ed,$EE/$EG/$Ed),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($EM-$EV)/$Ed:this.offset.x=.5*($EM-$EV)/$Ed,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($Ee-$EE)/$Ed:this.offset.y=.5*($Ee-$EE)/$Ed,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$EH.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$EL&&("horizontal"===this._screenMode?($EH.rotate(Math.PI/2),$EH.translate($Ee/$Ed,0),this.canvasDegree=90):($EH.rotate(-Math.PI/2),$EH.translate(0,$EM/$Ed),this.canvasDegree=-90)),$EH.a=this._formatData($EH.a),$EH.d=this._formatData($EH.d),$EH.tx=this._formatData($EH.tx),$EH.ty=this._formatData($EH.ty),$Eq.transformOrigin=$Eq.webkitTransformOrigin=$Eq.msTransformOrigin=$Eq.mozTransformOrigin=$Eq.oTransformOrigin="0px 0px 0px",$Eq.transform=$Eq.webkitTransform=$Eq.msTransform=$Eq.mozTransform=$Eq.oTransform="matrix("+$EH.toString()+")",$EH.translate(parseInt($Eq.left)||0,parseInt($Eq.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$EM._formatData=function($EM){return Math.abs($EM)<1e-6?0:Math.abs(1-$EM)<.001?0<$EM?1:-1:$EM},$EM.getMousePoint=function(){return $EA.TEMP.setTo(this.mouseX,this.mouseY)},$EM.repaint=function(){this._repaint=1},$EM.parentRepaint=function(){},$EM._loop=function(){return this.render($En.context,0,0),!0},$EM._onmouseMove=function($EM){this._mouseMoveTime=$Eg.now()},$EM.getTimeFromFrameStart=function(){return $Eg.now()-this._frameStartTime},$EM.render=function($EM,$Ee,$EL){if("sleep"===this._frameRate&&!$En.isConchApp){var $E_=$Eg.now();if(!(1e3<=$E_-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($EZ.loopCount++,$Er.instance.runEvent(),$Ey.timer._update()));this._frameStartTime=$E_}if(this._renderCount++,$En.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$Eg.now();var $Ec="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$Eq=this._renderCount%2==0;if($EZ.renderSlow=!$Ec,$Ec||$Eq||$En.isConchApp){var $EH;$EZ.loopCount++,$Er.instance.runEvent(),$Ey.timer._update(),$ES.update3DLoop();var $ET=0,$Ex=0;if($En.isConchNode)for($ET=0,$Ex=this._scenes.length;$ET<$Ex;$ET++)($EH=this._scenes[$ET])&&$EH._updateSceneConch();else for($ET=0,$Ex=this._scenes.length;$ET<$Ex;$ET++)($EH=this._scenes[$ET])&&$EH._updateScene();if($En.isConchNode){var $EO=$EGM.CustomList;for($ET=0,$Ex=$EO.length;$ET<$Ex;$ET++){var $Eu=$EO[$ET];$Eu.customRender($Eu.customContext,0,0)}return}}$En.isConchNode||this.renderingEnabled&&($Ec||!$Eq||$En.isConchWebGL)&&($En.isWebGL?$En.WebGL.mainContext&&!$En.WebGL.mainContext.isContextLost()&&($EM.clear(),$EG.prototype.render.call(this,$EM,$Ee,$EL),$EZ._show&&$EZ._sp&&$EZ._sp.render($EM,$Ee,$EL),$ES.clear(this._bgColor),$ES.beginFlush(),$EM.flush(),$ES.endFinish(),$ED.instance&&$ED.getInstance().endDispose()):($ES.clear(this._bgColor),$EG.prototype.render.call(this,$EM,$Ee,$EL),$EZ._show&&$EZ._sp&&$EZ._sp.render($EM,$Ee,$EL)))}else this._renderCount%5==0&&($EZ.loopCount++,$Er.instance.runEvent(),$Ey.timer._update())},$EM._requestFullscreen=function(){var $EM=$Eg.document.documentElement;$EM.requestFullscreen?$EM.requestFullscreen():$EM.mozRequestFullScreen?$EM.mozRequestFullScreen():$EM.webkitRequestFullscreen?$EM.webkitRequestFullscreen():$EM.msRequestFullscreen&&$EM.msRequestFullscreen()},$EM._fullScreenChanged=function(){$Ey.stage.event("fullscreenchange")},$EM.exitFullscreen=function(){var $EM=$Eg.document;$EM.exitFullscreen?$EM.exitFullscreen():$EM.mozCancelFullScreen?$EM.mozCancelFullScreen():$EM.webkitExitFullscreen&&$EM.webkitExitFullscreen()},$Ed(0,$EM,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$Ed(0,$EM,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$Ed(0,$EM,"frameRate",function(){return this._frameRate},function($EM){if(this._frameRate=$EM,$En.isConchApp)switch(this._frameRate){case"slow":$Eg.window.conch&&$Eg.window.conchConfig.setSlowFrame&&$Eg.window.conchConfig.setSlowFrame(!0);break;case"fast":$Eg.window.conch&&$Eg.window.conchConfig.setSlowFrame&&$Eg.window.conchConfig.setSlowFrame(!1);break;case"mouse":$Eg.window.conch&&$Eg.window.conchConfig.setMouseFrame&&$Eg.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$Eg.window.conch&&$Eg.window.conchConfig.setLimitFPS&&$Eg.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$Ed(0,$EM,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$Ed(0,$EM,"width",$EG.prototype._$get_width,function($EM){this.designWidth=$EM,$Ey.superSet($EGM,this,"width",$EM),$Ey.timer.callLater(this,this._changeCanvasSize)}),$Ed(0,$EM,"alignH",function(){return this._alignH},function($EM){this._alignH=$EM,$Ey.timer.callLater(this,this._changeCanvasSize)}),$Ed(0,$EM,"isFocused",function(){return this._isFocused}),$Ed(0,$EM,"height",$EG.prototype._$get_height,function($EM){this.designHeight=$EM,$Ey.superSet($EGM,this,"height",$EM),$Ey.timer.callLater(this,this._changeCanvasSize)}),$Ed(0,$EM,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$Ep.create()},$EG.prototype._$set_transform),$Ed(0,$EM,"isVisibility",function(){return this._isVisibility}),$Ed(0,$EM,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$Ed(0,$EM,"scaleMode",function(){return this._scaleMode},function($EM){this._scaleMode=$EM,$Ey.timer.callLater(this,this._changeCanvasSize)}),$Ed(0,$EM,"alignV",function(){return this._alignV},function($EM){this._alignV=$EM,$Ey.timer.callLater(this,this._changeCanvasSize)}),$Ed(0,$EM,"bgColor",function(){return this._bgColor},function($EM){this._bgColor=$EM,this.conchModel&&this.conchModel.bgColor($EM),$En.isWebGL&&($EM?$EH._wgColor=$Em.create($EM)._color:$Eg.onMiniGame||($EH._wgColor=null)),$Eg.onLimixiu?$EH._wgColor=$Em.create($EM)._color:$En.canvas.style.background=$EM||"none"}),$Ed(0,$EM,"mouseX",function(){return Math.round($Er.instance.mouseX/this.clientScaleX)}),$Ed(0,$EM,"mouseY",function(){return Math.round($Er.instance.mouseY/this.clientScaleY)}),$Ed(0,$EM,"screenMode",function(){return this._screenMode},function($EM){this._screenMode=$EM}),$Ed(0,$EM,"visible",$EG.prototype._$get_visible,function($EM){this.visible!==$EM&&($Ey.superSet($EGM,this,"visible",$EM),$En._mainCanvas.source.style.visibility=$EM?"visible":"hidden")}),$Ed(0,$EM,"fullScreenEnabled",null,function($EM){var $Ee=$Eg.document,$EL=$En.canvas;$EM?($EL.addEventListener("mousedown",this._requestFullscreen),$EL.addEventListener("touchstart",this._requestFullscreen),$Ee.addEventListener("fullscreenchange",this._fullScreenChanged),$Ee.addEventListener("mozfullscreenchange",this._fullScreenChanged),$Ee.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$Ee.addEventListener("msfullscreenchange",this._fullScreenChanged)):($EL.removeEventListener("mousedown",this._requestFullscreen),$EL.removeEventListener("touchstart",this._requestFullscreen),$Ee.removeEventListener("fullscreenchange",this._fullScreenChanged),$Ee.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$Ee.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$Ee.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$EH.SCALE_NOSCALE="noscale",$EH.SCALE_EXACTFIT="exactfit",$EH.SCALE_SHOWALL="showall",$EH.SCALE_NOBORDER="noborder",$EH.SCALE_FULL="full",$EH.SCALE_FIXED_WIDTH="fixedwidth",$EH.SCALE_FIXED_HEIGHT="fixedheight",$EH.SCALE_FIXED_AUTO="fixedauto",$EH.ALIGN_LEFT="left",$EH.ALIGN_RIGHT="right",$EH.ALIGN_CENTER="center",$EH.ALIGN_TOP="top",$EH.ALIGN_MIDDLE="middle",$EH.ALIGN_BOTTOM="bottom",$EH.SCREEN_NONE="none",$EH.SCREEN_HORIZONTAL="horizontal",$EH.SCREEN_VERTICAL="vertical",$EH.FRAME_FAST="fast",$EH.FRAME_SLOW="slow",$EH.FRAME_MOUSE="mouse",$EH.FRAME_SLEEP="sleep",$EH.FRAME_MOUSE_THREDHOLD=2e3,$Ex($EH,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$EH}($EGM),$EKM=(function($EM){function $Ee(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$Ee.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$Eu($Ee,"laya.media.SoundNode",$EGM);var $EL=$Ee.prototype;$EL._onParentChange=function(){this.target=this.parent},$EL.play=function($EM,$Ee){void 0===$EM&&($EM=1),isNaN($EM)&&($EM=1),this.url&&(this.stop(),this._channel=$Et.playSound(this.url,$EM,null,$Ee))},$EL.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$EL._setPlayAction=function($EM,$Ee,$EL,$E_){void 0===$E_&&($E_=!0),this[$EL]&&$EM&&($E_?$EM.on($Ee,this,this[$EL]):$EM.off($Ee,this,this[$EL]))},$EL._setPlayActions=function($EM,$Ee,$EL,$E_){if(void 0===$E_&&($E_=!0),$EM&&$Ee){var $Ec,$Eq=$Ee.split(","),$EH=0;for($Ec=$Eq.length,$EH=0;$EH<$Ec;$EH++)this._setPlayAction($EM,$Eq[$EH],$EL,$E_)}},$Ed(0,$EL,"playEvent",null,function($EM){(this._playEvents=$EM)&&this._tar&&this._setPlayActions(this._tar,$EM,"play")}),$Ed(0,$EL,"target",null,function($EM){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$EM,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$Ed(0,$EL,"stopEvent",null,function($EM){(this._stopEvents=$EM)&&this._tar&&this._setPlayActions(this._tar,$EM,"stop")})}(),function($EM){function $Ee(){this._src=null,this._onload=null,this._onerror=null,$Ee.__super.call(this)}$Eu($Ee,"laya.resource.FileBitmap",$EdM);var $EL=$Ee.prototype;return $Ed(0,$EL,"src",function(){return this._src},function($EM){this._src=$EM}),$Ed(0,$EL,"onload",null,function($EM){}),$Ed(0,$EL,"onerror",null,function($EM){}),$Ee}()),$EXM=function($EM){function $EL($EM,$Ee){this._is2D=!1,$EL.__super.call(this);var $E_=this;if(this._source=this,"2D"===$EM||"AUTO"===$EM&&!$En.isWebGL){this._is2D=!0,this._source=$Ee||$Eg.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $Ec=this;$Ec.getContext=function($EM,$Ee){if($E_._ctx)return $E_._ctx;var $EL=$E_._ctx=$E_._source.getContext($EM,$Ee);return $EL&&($EL._canvas=$Ec,$En.isFlash||$Eg.onLimixiu||($EL.size=function($EM,$Ee){})),$EL}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$Eu($EL,"laya.resource.HTMLCanvas",$EdM);var $Ee=$EL.prototype;return $Ee.clear=function(){this._ctx&&this._ctx.clear()},$Ee.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$Ee.release=function(){},$Ee._setContext=function($EM){this._ctx=$EM},$Ee.getContext=function($EM,$Ee){return this._ctx?this._ctx:this._ctx=$EL._createContext(this)},$Ee.getMemSize=function(){return 0},$Ee.size=function($EM,$Ee){(this._w!=$EM||this._h!=$Ee||this._source&&(this._source.width!=$EM||this._source.height!=$Ee))&&(this._w=$EM,this._h=$Ee,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($EM,$Ee),this._source&&(this._source.height=$Ee,this._source.width=$EM))},$Ee.getCanvas=function(){return this._source},$Ee.toBase64=function($EM,$Ee,$EL){if(this._source)if($En.isConchApp&&this._source.toBase64)this._source.toBase64($EM,$Ee,$EL);else{var $E_=this._source.toDataURL($EM,$Ee);$EL.call(this,$E_)}},$Ed(0,$Ee,"context",function(){return this._ctx}),$Ed(0,$Ee,"asBitmap",null,function($EM){}),$EL.create=function($EM,$Ee){return new $EL($EM,$Ee)},$EL.TYPE2D="2D",$EL.TYPE3D="3D",$EL.TYPEAUTO="AUTO",$EL._createContext=null,$EL}(),$EoM=(function($EM){function $Ex($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){throw $Ex.__super.call(this),new Error("不允许new！")}$Eu($Ex,"laya.resource.HTMLSubImage",$EdM),$Ex.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){return void 0===$ET&&($ET=!1),new $Ex($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET)}}(),function($EM){function $EG(){this._frames=null,this._url=null,$EG.__super.call(this),this._setControlNode(this)}$Eu($EG,"laya.display.Animation",$EM);var $Ee=$EG.prototype;$Ee.destroy=function($EM){void 0===$EM&&($EM=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$EM),this._frames=null,this._labels=null},$Ee.play=function($EM,$Ee,$EL,$E_){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=!0),void 0===$EL&&($EL=""),void 0===$E_&&($E_=!0),$EL&&this._setFramesFromCache($EL,$E_),this._isPlaying=!0,this.index="string"==typeof $EM?this._getFrameByLabel($EM):$EM,this.loop=$Ee,this._actionName=$EL,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$Ee._setFramesFromCache=function($EM,$Ee){var $EL;return void 0===$Ee&&($Ee=!1),this._url&&($EM=this._url+"#"+$EM),$EM&&$EG.framesMap[$EM]?(($EL=$EG.framesMap[$EM])instanceof Array?(this._frames=$EG.framesMap[$EM],this._count=this._frames.length):($EL.nodeRoot&&($EG.framesMap[$EM]=this._parseGraphicAnimationByData($EL),$EL=$EG.framesMap[$EM]),this._frames=$EL.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$EL.interval),this._labels=this._copyLabels($EL.labels)),!0):($Ee&&console.log("ani not found:",$EM),!1)},$Ee._copyLabels=function($EM){if(!$EM)return null;var $Ee,$EL;for($EL in $Ee={},$EM)$Ee[$EL]=$Es.copyArray([],$EM[$EL]);return $Ee},$Ee._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$EM.prototype._frameLoop.call(this)},$Ee._displayToIndex=function($EM){this._frames&&(this.graphics=this._frames[$EM])},$Ee.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$Ee.loadImages=function($EM,$Ee){return void 0===$Ee&&($Ee=""),this._url="",this._setFramesFromCache($Ee)||(this.frames=$EG.framesMap[$Ee]?$EG.framesMap[$Ee]:$EG.createFrames($EM,$Ee)),this},$Ee.loadAtlas=function($Ee,$EL,$E_){void 0===$E_&&($E_=""),this._url="";var $Ec=this;function $EM($EM){$Ee===$EM&&($Ec.frames=$EG.framesMap[$E_]?$EG.framesMap[$E_]:$EG.createFrames($Ee,$E_),$EL&&$EL.run())}return $Ec._setFramesFromCache($E_)||($ETM.getAtlas($Ee)?$EM($Ee):$Ey.loader.load($Ee,$EK.create(null,$EM,[$Ee]),null,"atlas")),this},$Ee.loadAnimation=function($EM,$Ee,$EL){this._url=$EM;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$Ee&&$Ee.run()):!$EL||$ETM.getAtlas($EL)?this._loadAnimationData($EM,$Ee,$EL):$Ey.loader.load($EL,$EK.create(this,this._loadAnimationData,[$EM,$Ee,$EL]),null,"atlas"),this},$Ee._loadAnimationData=function($ET,$Ex,$EM){var $EO=this;if(!$EM||$ETM.getAtlas($EM)){var $Eu=this;$ETM.getRes($ET)?$Ee($ET):$Ey.loader.load($ET,$EK.create(null,$Ee,[$ET]),null,"json"),$ETM.clearRes($ET)}else console.warn("atlas load fail:"+$EM);function $Ee($EM){if($ETM.getRes($EM)&&$ET===$EM){var $Ee;if($EG.framesMap[$ET+"#"])$Eu._setFramesFromCache($EO._actionName,!0),$EO.index=0,$EO._checkResumePlaying();else{var $EL=$Eu._parseGraphicAnimation($ETM.getRes($ET));if(!$EL)return;var $E_,$Ec=$EL.animationList,$Eq=0,$EH=$Ec.length;for($Eq=0;$Eq<$EH;$Eq++)$Ee=$Ec[$Eq],$EG.framesMap[$ET+"#"+$Ee.name]=$Ee,$E_||($E_=$Ee);$E_&&($EG.framesMap[$ET+"#"]=$E_,$Eu._setFramesFromCache($EO._actionName,!0),$EO.index=0),$EO._checkResumePlaying()}$Ex&&$Ex.run()}}},$Ee._parseGraphicAnimation=function($EM){return $EyM.parseAnimationData($EM)},$Ee._parseGraphicAnimationByData=function($EM){return $EyM.parseAnimationByData($EM)},$Ed(0,$Ee,"frames",function(){return this._frames},function($EM){(this._frames=$EM)&&(this._count=$EM.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$Ed(0,$Ee,"autoPlay",null,function($EM){$EM?this.play():this.stop()}),$Ed(0,$Ee,"source",null,function($EM){-1<$EM.indexOf(".ani")?this.loadAnimation($EM):-1<$EM.indexOf(".json")||-1<$EM.indexOf("als")||-1<$EM.indexOf("atlas")?this.loadAtlas($EM):this.loadImages($EM.split(","))}),$Ed(0,$Ee,"autoAnimation",null,function($EM){this.play(0,!0,$EM,!1)}),$EG.createFrames=function($EM,$Ee){var $EL,$E_,$Ec=0,$Eq=0;if("string"==typeof $EM){var $EH=$ETM.getAtlas($EM);if($EH&&$EH.length)for($EL=[],$Ec=0,$Eq=$EH.length;$Ec<$Eq;$Ec++)($E_=new $ES.createGraphics).drawTexture($ETM.getRes($EH[$Ec]),0,0),$EL.push($E_)}else if($EM instanceof Array)for($EL=[],$Ec=0,$Eq=$EM.length;$Ec<$Eq;$Ec++)($E_=new $ES.createGraphics).loadImage($EM[$Ec],0,0),$EL.push($E_);return $Ee&&($EG.framesMap[$Ee]=$EL),$EL},$EG.clearCache=function($EM){var $Ee,$EL=$EG.framesMap,$E_=$EM+"#";for($Ee in $EL)$Ee!==$EM&&0!=$Ee.indexOf($E_)||delete $EG.framesMap[$Ee]},$EG.framesMap={}}($ErM),function($EM){function $Eq(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$Eq.__super.call(this),null==$Eq._sortIndexFun&&($Eq._sortIndexFun=$EW.sortByKey("index",!1,!0))}$Eu($Eq,"laya.display.FrameAnimation",$EM);var $Ee=$Eq.prototype;return $Ee._setUp=function($EM,$Ee){this._labels=null,this._animationNewFrames=null,this._targetDic=$EM,this._animationData=$Ee,this.interval=1e3/$Ee.frameRate,$Ee.parsed?(this._count=$Ee.count,this._labels=$Ee.labels,this._animationNewFrames=$Ee.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$Ee.parsed=!0,$Ee.labels=this._labels,$Ee.count=this._count,$Ee.animationNewFrames=this._animationNewFrames},$Ee.clear=function(){$EM.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$Ee._displayToIndex=function($EM){if(this._animationData){$EM<0&&($EM=0),$EM>this._count&&($EM=this._count);var $Ee=this._animationData.nodes,$EL=0,$E_=$Ee.length;for($EL=0;$EL<$E_;$EL++)this._displayNodeToFrame($Ee[$EL],$EM)}},$Ee._displayNodeToFrame=function($EM,$Ee,$EL){$EL||($EL=this._targetDic);var $E_=$EL[$EM.target];if($E_){var $Ec,$Eq,$EH,$ET=$EM.frames,$Ex=$EM.keys,$EO=0,$Eu=$Ex.length;for($EO=0;$EO<$Eu;$EO++)$EH=($Eq=$ET[$Ec=$Ex[$EO]]).length>$Ee?$Eq[$Ee]:$Eq[$Eq.length-1],$E_[$Ec]=$EH}},$Ee._calculateDatas=function(){if(this._animationData){var $EM,$Ee=this._animationData.nodes,$EL=0,$E_=$Ee.length;for($EL=this._count=0;$EL<$E_;$EL++)$EM=$Ee[$EL],this._calculateNodeKeyFrames($EM);this._count+=1}},$Ee._calculateNodeKeyFrames=function($EM){var $Ee,$EL,$E_=$EM.keyframes,$Ec=$EM.target;for($Ee in $EM.frames||($EM.frames={}),$EM.keys?$EM.keys.length=0:$EM.keys=[],$EM.initValues||($EM.initValues={}),$E_)$EL=$E_[$Ee],$EM.frames[$Ee]||($EM.frames[$Ee]=[]),this._targetDic&&this._targetDic[$Ec]&&($EM.initValues[$Ee]=this._targetDic[$Ec][$Ee]),$EL.sort($Eq._sortIndexFun),$EM.keys.push($Ee),this._calculateNodePropFrames($EL,$EM.frames[$Ee],$Ee,$Ec)},$Ee.resetToInitState=function(){if(this._targetDic&&this._animationData){var $EM,$Ee,$EL=this._animationData.nodes,$E_=0,$Ec=$EL.length;for($E_=0;$E_<$Ec;$E_++)if($Ee=($EM=$EL[$E_]).initValues){var $Eq,$EH=this._targetDic[$EM.target];if($EH)for($Eq in $Ee)$EH[$Eq]=$Ee[$Eq]}}},$Ee._calculateNodePropFrames=function($EM,$Ee,$EL,$E_){var $Ec=0,$Eq=$EM.length-1;if(0<$Eq){for($Ee.length=$EM[$Eq].index+1,$Ec=0;$Ec<$Eq;$Ec++)this._dealKeyFrame($EM[$Ec]),this._calculateFrameValues($EM[$Ec],$EM[$Ec+1],$Ee);this._dealKeyFrame($EM[$Ec])}0==$Eq&&($Ee[$EM[0].index]=$EM[0].value,this._animationNewFrames&&(this._animationNewFrames[$EM[0].index]=!0))},$Ee._dealKeyFrame=function($EM){$EM.label&&""!=$EM.label&&this.addLabel($EM.label,$EM.index)},$Ee._calculateFrameValues=function($EM,$Ee,$EL){var $E_,$Ec=0,$Eq=$EM.index,$EH=$Ee.index,$ET=$EM.value,$Ex=$Ee.value-$EM.value,$EO=$EH-$Eq;if($EH>this._count&&(this._count=$EH),$EM.tween)for(null==($E_=$EQ[$EM.tweenMethod])&&($E_=$EQ.linearNone),$Ec=$Eq;$Ec<$EH;$Ec++)$EL[$Ec]=$E_($Ec-$Eq,$ET,$Ex,$EO),this._animationNewFrames&&(this._animationNewFrames[$Ec]=!0);else for($Ec=$Eq;$Ec<$EH;$Ec++)$EL[$Ec]=$ET;this._animationNewFrames&&(this._animationNewFrames[$EM.index]=!0,this._animationNewFrames[$Ee.index]=!0),$EL[$Ee.index]=$Ee.value},$Eq._sortIndexFun=null,$Eq}($ErM)),$EiM=function($Ee){function $Ec(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$Ec.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$E$M.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$Eu($Ec,"laya.display.Input",$Ee);var $EM=$Ec.prototype;return $EM.setSelection=function($EM,$Ee){this.focus=!0,laya.display.Input.inputElement.selectionStart=$EM,laya.display.Input.inputElement.selectionEnd=$Ee},$EM._onUnDisplay=function($EM){this.focus=!1},$EM._onMouseDown=function($EM){this.focus=!0},$EM._syncInputTransform=function(){var $EM=this.nativeInput,$Ee=$Es.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$EL=this._width-this.padding[1]-this.padding[3],$E_=this._height-this.padding[0]-this.padding[2];$En.isConchApp?($EM.setScale($Ee.scaleX,$Ee.scaleY),$EM.setSize($EL,$E_),$EM.setPos($Ee.x,$Ee.y)):($Ec.inputContainer.style.transform=$Ec.inputContainer.style.webkitTransform="scale("+$Ee.scaleX+","+$Ee.scaleY+") rotate("+$Ey.stage.canvasDegree+"deg)",$EM.style.width=$EL+"px",$EM.style.height=$E_+"px",$Ec.inputContainer.style.left=$Ee.x+"px",$Ec.inputContainer.style.top=$Ee.y+"px")},$EM.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$EM._setInputMethod=function(){$Ec.input.parentElement&&$Ec.inputContainer.removeChild($Ec.input),$Ec.area.parentElement&&$Ec.inputContainer.removeChild($Ec.area),$Ec.inputElement=this._multiline?$Ec.area:$Ec.input,$Ec.inputContainer.appendChild($Ec.inputElement),$E$M.RightToLeft&&($Ec.inputElement.style.direction="rtl")},$EM._focusIn=function(){laya.display.Input.isInputting=!0;var $EM=this.nativeInput;this._focus=!0;var $Ee=$EM.style;$Ee.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$EM.readOnly=!this._editable,$En.isConchApp&&($EM.setType(this._type),$EM.setForbidEdit(!this._editable)),$EM.maxLength=this._maxChars;this.padding;if($EM.type=this._type,$EM.value=this._content,$EM.placeholder=this._prompt,$Ey.stage.off("keydown",this,this._onKeyDown),$Ey.stage.on("keydown",this,this._onKeyDown),($Ey.stage.focus=this).event("focus"),$Eg.onPC&&$EM.focus(),!$Eg.onMiniGame){this._text;this._text=null}this.typeset(),$EM.setColor(this._originColor),$EM.setFontSize(this.fontSize),$EM.setFontFace($Eg.onIPhone&&$E$M._fontFamilyMap[this.font]||this.font),$En.isConchApp&&$EM.setMultiAble&&$EM.setMultiAble(this._multiline),$Ee.lineHeight=this.leading+this.fontSize+"px",$Ee.fontStyle=this.italic?"italic":"normal",$Ee.fontWeight=this.bold?"bold":"normal",$Ee.textAlign=this.align,$Ee.padding="0 0",this._syncInputTransform(),!$En.isConchApp&&$Eg.onPC&&$Ey.timer.frameLoop(1,this,this._syncInputTransform)},$EM._setPromptColor=function(){($Ec.promptStyleDOM=$Eg.getElementById("promptStyle"))||(($Ec.promptStyleDOM=$Eg.createElement("style")).setAttribute("id","promptStyle"),$Eg.document.head.appendChild($Ec.promptStyleDOM)),$Ec.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$EM._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($Ey.superSet($E$M,this,"text",this._content),$Ey.superSet($E$M,this,"color",this._originColor)):($Ey.superSet($E$M,this,"text",this._prompt),$Ey.superSet($E$M,this,"color",this._promptColor)),$Ey.stage.off("keydown",this,this._onKeyDown),$Ey.stage.focus=null,this.event("blur"),$En.isConchApp&&this.nativeInput.blur(),$Eg.onPC&&$Ey.timer.clear(this,this._syncInputTransform)},$EM._onKeyDown=function($EM){13===$EM.keyCode&&($Eg.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$EM.changeText=function($EM){this._content=$EM,this._focus?(this.nativeInput.value=$EM||"",this.event("change")):$Ee.prototype.changeText.call(this,$EM)},$Ed(0,$EM,"color",$Ee.prototype._$get_color,function($EM){this._focus&&this.nativeInput.setColor($EM),$Ey.superSet($E$M,this,"color",this._content?$EM:this._promptColor),this._originColor=$EM}),$Ed(0,$EM,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($EM){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$Ed(0,$EM,"multiline",function(){return this._multiline},function($EM){this._multiline=$EM,this.valign=$EM?"top":"middle"}),$Ed(0,$EM,"maxChars",function(){return this._maxChars},function($EM){$EM<=0&&($EM=1e5),this._maxChars=$EM}),$Ed(0,$EM,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($EM){$Ey.superSet($E$M,this,"color",this._originColor),$EM+="",this._focus?(this.nativeInput.value=$EM||"",this.event("change")):(this._multiline||($EM=$EM.replace(/\r?\n/g,"")),(this._content=$EM)?$Ey.superSet($E$M,this,"text",$EM):($Ey.superSet($E$M,this,"text",this._prompt),$Ey.superSet($E$M,this,"color",this.promptColor)))}),$Ed(0,$EM,"nativeInput",function(){return this._multiline?$Ec.area:$Ec.input}),$Ed(0,$EM,"prompt",function(){return this._prompt},function($EM){!this._text&&$EM&&$Ey.superSet($E$M,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$Ey.superSet($E$M,this,"text",this._text==this._prompt?$EM:this._text):$Ey.superSet($E$M,this,"text",$EM),this._prompt=$E$M.langPacks&&$E$M.langPacks[$EM]?$E$M.langPacks[$EM]:$EM}),$Ed(0,$EM,"focus",function(){return this._focus},function($EM){var $Ee=this.nativeInput;this._focus!==$EM&&($EM?($Ee.target?$Ee.target._focusOut():this._setInputMethod(),($Ee.target=this)._focusIn()):($Ee.target=null,this._focusOut(),$Eg.document.body.scrollTop=0,$Ee.blur(),$En.isConchApp?$Ee.setPos(-1e4,-1e4):$Ec.inputContainer.contains($Ee)&&$Ec.inputContainer.removeChild($Ee)))}),$Ed(0,$EM,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($EM){$EM?(-1<($EM="[^"+$EM+"]").indexOf("^^")&&($EM=$EM.replace("^^","")),this._restrictPattern=new RegExp($EM,"g")):this._restrictPattern=null}),$Ed(0,$EM,"editable",function(){return this._editable},function($EM){this._editable=$EM,$En.isConchApp&&$Ec.input.setForbidEdit(!$EM)}),$Ed(0,$EM,"promptColor",function(){return this._promptColor},function($EM){this._promptColor=$EM,this._content||$Ey.superSet($E$M,this,"color",$EM)}),$Ed(0,$EM,"type",function(){return this._type},function($EM){this._getCSSStyle().password="password"==$EM,this._type=$EM,$En.isConchApp&&this.nativeInput.setType($EM)}),$Ed(0,$EM,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($EM){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$Ed(0,$EM,"asPassword",function(){return this._getCSSStyle().password},function($EM){this._getCSSStyle().password=$EM,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$Ec.__init__=function(){$Ec._createInputElement(),$Eg.onMobile&&$En.canvas.addEventListener($Ec.IOS_IFRAME?$Eg.onMiniGame?"touchend":"click":"touchend",$Ec._popupInputMethod)},$Ec._popupInputMethod=function($EM){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$Ec._createInputElement=function(){$Ec._initInput($Ec.area=$Eg.createElement("textarea")),$Ec._initInput($Ec.input=$Eg.createElement("input")),($Ec.inputContainer=$Eg.createElement("div")).style.position="absolute",$Ec.inputContainer.style.zIndex=1e5,$Eg.container.appendChild($Ec.inputContainer),$Ec.inputContainer.setPos=function($EM,$Ee){$Ec.inputContainer.style.left=$EM+"px",$Ec.inputContainer.style.top=$Ee+"px"}},$Ec._initInput=function($Ee){var $EM=$Ee.style;$EM.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$EM.resize="none",$EM.backgroundColor="transparent",$EM.border="none",$EM.outline="none",$EM.zIndex=1,$Ee.addEventListener("input",$Ec._processInputting),$Ee.addEventListener("mousemove",$Ec._stopEvent),$Ee.addEventListener("mousedown",$Ec._stopEvent),$Ee.addEventListener("touchmove",$Ec._stopEvent),$Ee.setFontFace=function($EM){$Ee.style.fontFamily=$EM},$En.isConchApp||($Ee.setColor=function($EM){$Ee.style.color=$EM},$Ee.setFontSize=function($EM){$Ee.style.fontSize=$EM+"px"})},$Ec._processInputting=function($EM){var $Ee=laya.display.Input.inputElement.target;if($Ee){var $EL=laya.display.Input.inputElement.value;$Ee._restrictPattern&&($EL=$EL.replace(/\u2006|\x27/g,""),$Ee._restrictPattern.test($EL)&&($EL=$EL.replace($Ee._restrictPattern,""),laya.display.Input.inputElement.value=$EL)),$Ee._text=$EL,$Ee.event("input")}},$Ec._stopEvent=function($EM){"touchmove"==$EM.type&&$EM.preventDefault(),$EM.stopPropagation&&$EM.stopPropagation()},$Ec.TYPE_TEXT="text",$Ec.TYPE_PASSWORD="password",$Ec.TYPE_EMAIL="email",$Ec.TYPE_URL="url",$Ec.TYPE_NUMBER="number",$Ec.TYPE_RANGE="range",$Ec.TYPE_DATE="date",$Ec.TYPE_MONTH="month",$Ec.TYPE_WEEK="week",$Ec.TYPE_TIME="time",$Ec.TYPE_DATE_TIME="datetime",$Ec.TYPE_DATE_TIME_LOCAL="datetime-local",$Ec.TYPE_SEARCH="search",$Ec.input=null,$Ec.area=null,$Ec.inputElement=null,$Ec.inputContainer=null,$Ec.confirmButton=null,$Ec.promptStyleDOM=null,$Ec.inputHeight=45,$Ec.isInputting=!1,$Ec.stageMatrix=null,$Ex($Ec,["IOS_IFRAME",function(){return this.IOS_IFRAME=$Eg.onIOS&&$Eg.window.top!=$Eg.window.self}]),$Ec}($E$M),$EWM=function($EM){function $EL($EM,$Ee){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$EL.__super.call(this),$EM&&this._init_($EM,$Ee)}$Eu($EL,"laya.resource.HTMLImage",$EKM);var $Ee=$EL.prototype;return $Ee._init_=function($EM,$Ee){this._src=$EM,this._source=new $Eg.window.Image,$Ee&&($Ee.onload&&(this.onload=$Ee.onload),$Ee.onerror&&(this.onerror=$Ee.onerror),$Ee.onCreate&&$Ee.onCreate(this)),0!=$EM.indexOf("data:image")&&(this._source.crossOrigin=""),$EM&&(this._source.src=$EM)},$Ee.recreateResource=function(){var $EM=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $Ee=this;this._source=new $Eg.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($Ee._needReleaseAgain)return $Ee._needReleaseAgain=!1,$Ee._source.onload=null,void($Ee._source=null);$Ee._source.onload=null,$Ee.memorySize=$EM._w*$EM._h*4,$Ee._recreateLock=!1,$Ee.completeCreate()},this._source.src=this._src}},$Ee.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$Ee.onresize=function(){this._w=this._source.width,this._h=this._source.height},$Ed(0,$Ee,"onload",null,function($EM){var $Ee=this;this._onload=$EM,this._source&&(this._source.onload=null!=this._onload?function(){$Ee.onresize(),$Ee._onload()}:null)}),$Ed(0,$Ee,"onerror",null,function($EM){var $Ee=this;this._onerror=$EM,this._source&&(this._source.onerror=null!=this._onerror?function(){$Ee._onerror()}:null)}),$Ed(0,$Ee,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($EM){this._enableMerageInAtlas=$EM,$En.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$EM)}),$EL.create=function($EM,$Ee){return new $EL($EM,$Ee)},$EL}(),$EyM=(function($Eq){function $EM(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$EM.__super.call(this)}$Eu($EM,"laya.display.EffectAnimation",$Eq);var $Ee=$EM.prototype;$Ee._onOtherBegin=function($EM){$EM!=this&&this.stop()},$Ee.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$Ee._onPlayAction=function(){this.play(0,!1)},$Ee.play=function($EM,$Ee,$EL,$E_){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=!0),void 0===$EL&&($EL=""),void 0===$E_&&($E_=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$EM,$Ee,$EL,$E_))},$Ee._recordInitData=function(){if(this._aniKeys){var $EM,$Ee,$EL=0;for($EM=this._aniKeys.length,$EL=0;$EL<$EM;$EL++)$Ee=this._aniKeys[$EL],this._initData[$Ee]=this._target[$Ee]}},$Ee._displayToIndex=function($EM){if(this._animationData){$EM<0&&($EM=0),$EM>this._count&&($EM=this._count);var $Ee=this._animationData.nodes,$EL=0,$E_=$Ee.length;for($E_=1<$E_?1:$E_,$EL=0;$EL<$E_;$EL++)this._displayNodeToFrame($Ee[$EL],$EM)}},$Ee._displayNodeToFrame=function($EM,$Ee,$EL){if(this._target){var $E_;$E_=this._target;var $Ec,$Eq,$EH,$ET,$Ex=$EM.frames,$EO=$EM.keys,$Eu=0,$EG=$EO.length;$ET=$EM.secondFrames;var $EV,$EE,$Ed,$Er,$E$=0;for($Eu=0;$Eu<$EG;$Eu++)$Eq=$Ex[$Ec=$EO[$Eu]],$EH=-1==($E$=$ET[$Ec])?this._initData[$Ec]:$Ee<$E$?($Ed=($EE=$EM.keyframes[$Ec])[0]).tween?(null==($EV=$EQ[$Ed.tweenMethod])&&($EV=$EQ.linearNone),$Er=$EE[1],$EV($Ee,this._initData[$Ec],$Er.value-this._initData[$Ec],$Er.index)):this._initData[$Ec]:$Eq.length>$Ee?$Eq[$Ee]:$Eq[$Eq.length-1],$E_[$Ec]=$EH}},$Ee._calculateNodeKeyFrames=function($EM){$Eq.prototype._calculateNodeKeyFrames.call(this,$EM);var $Ee,$EL,$E_,$Ec=$EM.keyframes;$EM.target;for($Ee in $E_={},$EM.secondFrames=$E_,$Ec)($EL=$Ec[$Ee]).length<=1?$E_[$Ee]=-1:$E_[$Ee]=$EL[1].index},$Ed(0,$Ee,"target",function(){return this._target},function($EM){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$EM,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$Ed(0,$Ee,"playEvent",null,function($EM){(this._playEvents=$EM)&&this.addEvent()}),$Ed(0,$Ee,"effectData",null,function($EM){var $Ee;$EM&&(($Ee=$EM.animations)&&$Ee[0]&&(this._setUp({},$Ee[0]),$Ee[0].nodes&&$Ee[0].nodes[0]&&(this._aniKeys=$Ee[0].nodes[0].keys)))}),$Ed(0,$Ee,"effectClass",null,function($EM){var $Ee,$EL;(this._effectClass=$Eb.getClass($EM),this._effectClass)&&(($Ee=this._effectClass.uiView)&&($EL=$Ee.animations)&&$EL[0]&&(this._setUp({},$EL[0]),$EL[0].nodes&&$EL[0].nodes[0]&&(this._aniKeys=$EL[0].nodes[0].keys)))}),$EM.EffectAnimationBegin="effectanimationbegin"}($EoM),function($Ee){var $Eh;function $Et(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$Et.__super.call(this)}$Eu($Et,"laya.utils.GraphicAnimation",$Ee);var $EM=$Et.prototype;return $EM._parseNodeList=function($EM){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$EM.compId]=$EM.props,$EM.compId&&this._nodeList.push($EM.compId);var $Ee=$EM.child;if($Ee){var $EL=0,$E_=$Ee.length;for($EL=0;$EL<$E_;$EL++)this._parseNodeList($Ee[$EL])}},$EM._calGraphicData=function($EM){var $Ee;if(this._setUp(null,$EM),this._createGraphicData(),this._nodeIDAniDic)for($Ee in this._nodeIDAniDic)this._nodeIDAniDic[$Ee]=null},$EM._createGraphicData=function(){var $EM,$Ee=[],$EL=0,$E_=this.count,$Ec=this._animationNewFrames;for($Ec||($Ec=[]),$EL=0;$EL<$E_;$EL++)!$Ec[$EL]&&$EM||($EM=this._createFrameGraphic($EL)),$Ee.push($EM);this._gList=$Ee},$EM._createFrameGraphic=function($EM){var $Ee=$ES.createGraphics();return $Et._rootMatrix||($Et._rootMatrix=new $Ep),this._updateNodeGraphic(this._rootNode,$EM,$Et._rootMatrix,$Ee),$Ee},$EM._updateNodeGraphic=function($EM,$Ee,$EL,$E_,$Ec){var $Eq;void 0===$Ec&&($Ec=1);var $EH,$ET,$Ex,$EO=($Eq=this._nodeGDic[$EM.compId]=this._getNodeGraphicData($EM.compId,$Ee,this._nodeGDic[$EM.compId])).alpha*$Ec;if(!($EO<.01)&&($Eq.resultTransform||($Eq.resultTransform=$Ep.create()),$EH=$Eq.resultTransform,$Ep.mul($Eq.transform,$EL,$EH),$Eq.skin&&($ET=this._getTextureByUrl($Eq.skin))&&($EH._checkTransform()?($E_.drawTexture($ET,0,0,$Eq.width,$Eq.height,$EH,$EO),$Eq.resultTransform=null):$E_.drawTexture($ET,$EH.tx,$EH.ty,$Eq.width,$Eq.height,null,$EO)),$Ex=$EM.child)){var $Eu,$EG=0;for($Eu=$Ex.length,$EG=0;$EG<$Eu;$EG++)this._updateNodeGraphic($Ex[$EG],$Ee,$EH,$E_,$EO)}},$EM._updateNoChilds=function($EM,$Ee){if($EM.skin){var $EL=this._getTextureByUrl($EM.skin);if($EL){var $E_=$EM.transform;$E_._checkTransform();!$E_.bTransform?$Ee.drawTexture($EL,$E_.tx,$E_.ty,$EM.width,$EM.height,null,$EM.alpha):$Ee.drawTexture($EL,0,0,$EM.width,$EM.height,$E_.clone(),$EM.alpha)}}},$EM._updateNodeGraphic2=function($EM,$Ee,$EL){var $E_;if($E_=this._nodeGDic[$EM.compId]=this._getNodeGraphicData($EM.compId,$Ee,this._nodeGDic[$EM.compId]),$EM.child){var $Ec=$E_.transform;$Ec._checkTransform();var $Eq,$EH;$EH=($Eq=!$Ec.bTransform)&&(0!=$Ec.tx||0!=$Ec.ty);var $ET,$Ex,$EO;if(($ET=$Ec.bTransform||1!=$E_.alpha)&&$EL.save(),1!=$E_.alpha&&$EL.alpha($E_.alpha),$Eq?$EH&&$EL.translate($Ec.tx,$Ec.ty):$EL.transform($Ec.clone()),$Ex=$EM.child,$E_.skin&&($EO=this._getTextureByUrl($E_.skin))&&$EL.drawTexture($EO,0,0,$E_.width,$E_.height),$Ex){var $Eu,$EG=0;for($Eu=$Ex.length,$EG=0;$EG<$Eu;$EG++)this._updateNodeGraphic2($Ex[$EG],$Ee,$EL)}$ET?$EL.restore():$Eq?$EH&&$EL.translate(-$Ec.tx,-$Ec.ty):$EL.transform($Ec.clone().invert())}else this._updateNoChilds($E_,$EL)},$EM._calculateNodeKeyFrames=function($EM){$Ee.prototype._calculateNodeKeyFrames.call(this,$EM),this._nodeIDAniDic[$EM.target]=$EM},$EM.getNodeDataByID=function($EM){return this._nodeIDAniDic[$EM]},$EM._getParams=function($EM,$Ee,$EL,$E_){var $Ec=$Et._temParam;$Ec.length=$Ee.length;var $Eq=0,$EH=$Ee.length;for($Eq=0;$Eq<$EH;$Eq++)$Ec[$Eq]=this._getObjVar($EM,$Ee[$Eq][0],$EL,$Ee[$Eq][1],$E_);return $Ec},$EM._getObjVar=function($EM,$Ee,$EL,$E_,$Ec){if($EM.hasOwnProperty($Ee)){var $Eq=$EM[$Ee];if($EL>=$Eq.length&&($EL=$Eq.length-1),null!=$EM[$Ee][$EL])return $EM[$Ee][$EL]}return $Ec.hasOwnProperty($Ee)?$Ec[$Ee]:$E_},$EM._getNodeGraphicData=function($EM,$Ee,$EL){$EL||($EL=$Eh.create()),$EL.transform?$EL.transform.identity():$EL.transform=$Ep.create();var $E_=this.getNodeDataByID($EM);if(!$E_)return $EL;var $Ec,$Eq,$EH=$E_.frames,$ET=this._getParams($EH,$Et._drawTextureCmd,$Ee,this._nodeDefaultProps[$EM]),$Ex=$ET[0],$EO=NaN,$Eu=NaN,$EG=$ET[5],$EV=$ET[6],$EE=$ET[13],$Ed=$ET[14],$Er=$ET[7],$E$=$ET[8],$EC=$ET[9],$EK=$ET[11],$EX=$ET[12];$EO=$ET[3],$Eu=$ET[4],0!=$EO&&0!=$Eu||($Ex=null),-1==$EO&&($EO=0),-1==$Eu&&($Eu=0),$EL.skin=$Ex,$EL.width=$EO,$EL.height=$Eu,$Ex&&(($Ec=this._getTextureByUrl($Ex))?($EO||($EO=$Ec.sourceWidth),$Eu||($Eu=$Ec.sourceHeight)):console.warn("lost skin:",$Ex,",you may load pics first")),$EL.alpha=$ET[10],$Eq=$EL.transform,0!=$EE&&($EG=$EE*$EO),0!=$Ed&&($EV=$Ed*$Eu),0==$EG&&0==$EV||$Eq.translate(-$EG,-$EV);var $Eo=null;if($EC||1!==$Er||1!==$E$||$EK||$EX){($Eo=$Et._tempMt).identity(),$Eo.bTransform=!0;var $Ei=.0174532922222222*($EC-$EK),$EW=.0174532922222222*($EC+$EX),$Ey=Math.cos($EW),$EA=Math.sin($EW),$EB=Math.sin($Ei),$Ek=Math.cos($Ei);$Eo.a=$Er*$Ey,$Eo.b=$Er*$EA,$Eo.c=-$E$*$EB,$Eo.d=$E$*$Ek,$Eo.tx=$Eo.ty=0}return $Eo&&($Eq=$Ep.mul($Eq,$Eo,$Eq)),$Eq.translate($ET[1],$ET[2]),$EL},$EM._getTextureByUrl=function($EM){return $ETM.getRes($EM)},$EM.setAniData=function($EM,$Ee){if($EM.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$EM,this._parseNodeList($EM);var $EL,$E_={},$Ec=[],$Eq=$EM.animations,$EH=0,$ET=$Eq.length;for($EH=0;$EH<$ET;$EH++)if($EL=$Eq[$EH],this._labels=null,(!$Ee||$Ee==$EL.name)&&$EL){try{this._calGraphicData($EL)}catch($EM){console.warn("parse animation fail:"+$EL.name+",empty animation created"),this._gList=[]}var $Ex={};$Ex.interval=1e3/$EL.frameRate,$Ex.frames=this._gList,$Ex.labels=this._labels,$Ex.name=$EL.name,$Ec.push($Ex),$E_[$EL.name]=$Ex}this.animationList=$Ec,this.animationDic=$E_}$Et._temParam.length=0},$EM.parseByData=function($EM){var $Ee,$EL;$Ee=$EM.nodeRoot,$EL=$EM.aniO,delete $EM.nodeRoot,delete $EM.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$Ee,this._parseNodeList($Ee),this._labels=null;try{this._calGraphicData($EL)}catch($EM){console.warn("parse animation fail:"+$EL.name+",empty animation created"),this._gList=[]}var $E_=$EM;return $E_.interval=1e3/$EL.frameRate,$E_.frames=this._gList,$E_.labels=this._labels,$E_.name=$EL.name,$E_},$EM.setUpAniData=function($EM){if($EM.animations){var $Ee,$EL={},$E_=[],$Ec=$EM.animations,$Eq=0,$EH=$Ec.length;for($Eq=0;$Eq<$EH;$Eq++)if($Ee=$Ec[$Eq]){var $ET={};$ET.name=$Ee.name,$ET.aniO=$Ee,$ET.nodeRoot=$EM,$E_.push($ET),$EL[$Ee.name]=$ET}this.animationList=$E_,this.animationDic=$EL}},$EM._clear=function(){var $EM,$Ee;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($EM in this._nodeGDic)($Ee=this._nodeGDic[$EM])&&$Ee.recover();this._nodeGDic=null},$Et.parseAnimationByData=function($EM){var $Ee;return $Et._I||($Et._I=new $Et),$Ee=$Et._I.parseByData($EM),$Et._I._clear(),$Ee},$Et.parseAnimationData=function($EM){var $Ee;return $Et._I||($Et._I=new $Et),$Et._I.setUpAniData($EM),($Ee={}).animationList=$Et._I.animationList,$Ee.animationDic=$Et._I.animationDic,$Et._I._clear(),$Ee},$Et._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$Et._temParam=[],$Et._I=null,$Et._rootMatrix=null,$Ex($Et,["_tempMt",function(){return this._tempMt=new $Ep}]),$Et.__init$=function(){$Eh=function(){function $EM(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $Eu($EM,""),$EM.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$EP.recover("GraphicNode",this)},$EM.create=function(){return $EP.getItemByClass("GraphicNode",$EM)},$EM}()},$Et}($EoM));$Ey.__init([$EO,$ExM,$En,$Eg,$Ev,$Ek,$EM,$EyM])}(window,document,Laya),function($EM,$Ee,$EL){$EL.un,$EL.uns,$EL.static;var $E_=$EL.class;$EL.getset,$EL.__newvec;new(function(){function $EM(){}return $E_($EM,"LayaMain"),$EM}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($EM,$Ee){"use strict";for(var $EL in Object.defineProperty($Ee,"__esModule",{value:!0}),Laya){var $E_=Laya[$EL];$E_&&$E_.__isclass&&($Ee[$EL]=$E_)}}),function($EM,$Ee,$EW){$EW.un,$EW.uns;var $EH=$EW.static,$EV=$EW.class,$E_=$EW.getset,$Eq=$EW.__newvec,$Eu=laya.maths.Arith,$EG=laya.maths.Bezier,$EL=laya.resource.Bitmap,$EE=laya.utils.Browser,$Ex=laya.utils.Byte,$Ed=laya.utils.Color,$Ey=(laya.filters.ColorFilter,$EW.Config),$Ec=laya.resource.Context,$EA=(laya.events.Event,laya.filters.Filter),$ET=laya.display.Graphics,$EO=laya.resource.HTMLCanvas,$Er=(laya.utils.HTMLChar,laya.resource.HTMLImage),$E$=laya.resource.HTMLSubImage,$EB=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$Ek=laya.maths.Point,$Eh=laya.maths.Rectangle,$EC=laya.renders.Render,$EK=(laya.renders.RenderContext,laya.renders.RenderSprite),$EX=laya.resource.Resource,$Eo=laya.resource.ResourceManager,$Ei=laya.utils.RunDriver,$Et=laya.display.Sprite,$ES=laya.display.Stage,$Ep=laya.utils.Stat,$ER=laya.utils.StringKey,$Ea=(laya.display.css.Style,laya.system.System),$En=laya.display.Text,$El=laya.resource.Texture,$Ef=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$Ej=laya.utils.VectorGraphManager;laya.utils.WordText;$EW.interface("laya.webgl.shapes.IShape"),$EW.interface("laya.webgl.submit.ISubmit"),$EW.interface("laya.webgl.text.ICharSegment"),$EW.interface("laya.webgl.canvas.save.ISaveData"),$EW.interface("laya.webgl.resource.IMergeAtlasBitmap"),$EW.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $EF=function(){function $EM(){}$EV($EM,"laya.filters.webgl.FilterActionGL");var $Ee=$EM.prototype;return $EW.imps($Ee,{"laya.filters.IFilterActionGL":!0}),$Ee.setValue=function($EM){},$Ee.setValueMix=function($EM){},$Ee.apply3d=function($EM,$Ee,$EL,$E_,$Ec){return null},$Ee.apply=function($EM){return null},$E_(0,$Ee,"typeMix",function(){return 0}),$EM}(),$Eg=function(){function $EM(){}return $EV($EM,"laya.webgl.shader.ShaderValue"),$EM}(),$EJ=function(){var $E_,$Ec;function $EM($EM,$Ee,$EL){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $Ec,void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),this._cells=null,this._rowInfo=null,this._init($EM,$Ee),this._atlasID=$EL}$EV($EM,"laya.webgl.atlas.AtlasGrid");var $Ee=$EM.prototype;return $Ee.getAltasID=function(){return this._atlasID},$Ee.setAltasID=function($EM){0<=$EM&&(this._atlasID=$EM)},$Ee.addTex=function($EM,$Ee,$EL){var $E_=this._get($Ee,$EL);return 0==$E_.ret||(this._fill($E_.x,$E_.y,$Ee,$EL,$EM),this._texCount++),$E_},$Ee._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$Ee._init=function($EM,$Ee){if(this._width=$EM,this._height=$Ee,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$Eq(this._height);for(var $EL=0;$EL<this._height;$EL++)this._rowInfo[$EL]=new $E_;return this._clear(),!0},$Ee._get=function($EM,$Ee){var $EL=new $Eb;if($EM>=this._failSize.width&&$Ee>=this._failSize.height)return $EL;for(var $E_=-1,$Ec=-1,$Eq=this._width,$EH=this._height,$ET=this._cells,$Ex=0;$Ex<$EH;$Ex++)if(!(this._rowInfo[$Ex].spaceCount<$EM))for(var $EO=0;$EO<$Eq;){var $Eu=3*($Ex*$Eq+$EO);if(0!=$ET[$Eu]||$ET[1+$Eu]<$EM||$ET[2+$Eu]<$Ee)$EO+=$ET[1+$Eu];else{$E_=$EO,$Ec=$Ex;for(var $EG=0;$EG<$EM;$EG++)if($ET[3*$EG+$Eu+2]<$Ee){$E_=-1;break}if(!($E_<0))return $EL.ret=!0,$EL.x=$E_,$EL.y=$Ec,$EL;$EO+=$ET[1+$Eu]}}return $EL},$Ee._fill=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=this._width,$EH=this._height;this._check($EM+$EL<=$Eq&&$Ee+$E_<=$EH);for(var $ET=$Ee;$ET<$E_+$Ee;++$ET){this._check(this._rowInfo[$ET].spaceCount>=$EL),this._rowInfo[$ET].spaceCount-=$EL;for(var $Ex=0;$Ex<$EL;$Ex++){var $EO=3*($EM+$ET*$Eq+$Ex);this._check(0==this._cells[$EO]),this._cells[$EO]=$Ec,this._cells[1+$EO]=$EL,this._cells[2+$EO]=$E_}}if(0<$EM)for($ET=0;$ET<$E_;++$ET){var $Eu=0;for($Ex=$EM-1;0<=$Ex&&0==this._cells[3*(($Ee+$ET)*$Eq+$Ex)];--$Ex,++$Eu);for($Ex=$Eu;0<$Ex;--$Ex)this._cells[3*(($Ee+$ET)*$Eq+$EM-$Ex)+1]=$Ex,this._check(0<$Ex)}if(0<$Ee)for($Ex=$EM;$Ex<$EM+$EL;++$Ex){for($Eu=0,$ET=$Ee-1;0<=$ET&&0==this._cells[3*($Ex+$ET*$Eq)];--$ET,$Eu++);for($ET=$Eu;0<$ET;--$ET)this._cells[3*($Ex+($Ee-$ET)*$Eq)+2]=$ET,this._check(0<$ET)}},$Ee._check=function($EM){0==$EM&&console.log("xtexMerger 错误啦")},$Ee._clear=function(){for(var $EM=this._texCount=0;$EM<this._height;$EM++)this._rowInfo[$EM].spaceCount=this._width;for(var $Ee=0;$Ee<this._height;$Ee++)for(var $EL=0;$EL<this._width;$EL++){var $E_=3*($Ee*this._width+$EL);this._cells[$E_]=0,this._cells[1+$E_]=this._width-$EL,this._cells[2+$E_]=this._width-$Ee}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$EM.__init$=function(){$E_=function(){function $EM(){this.spaceCount=0}return $EV($EM,""),$EM}(),$Ec=function(){function $EM(){this.width=0,this.height=0}return $EV($EM,""),$EM}()},$EM}(),$Ew=function(){function $EC($EM,$Ee,$EL,$E_){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$EM,this._height=$Ee,this._gridSize=$EL,this._maxAtlaserCount=$E_,this._gridNumX=$EM/$EL,this._gridNumY=$Ee/$EL,this._curAtlasIndex=0,this._atlaserArray=[]}$EV($EC,"laya.webgl.atlas.AtlasResourceManager");var $EM=$EC.prototype;return $EM.setAtlasParam=function($EM,$Ee,$EL,$E_){if(1==this._setAtlasParam)return $EC._sid_=0,this._width=$EM,this._height=$Ee,this._gridSize=$EL,this._maxAtlaserCount=$E_,this._gridNumX=$EM/$EL,this._gridNumY=$Ee/$EL,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$EM.pushData=function($EM){var $Ee,$EL=$EM.bitmap,$E_=-1,$Ec=null,$Eq=0,$EH=0;for($Eq=0,$Ee=this._atlaserArray.length;$Eq<$Ee&&($EH=(this._curAtlasIndex+$Eq)%$Ee,-1==($E_=($Ec=this._atlaserArray[$EH]).findBitmapIsExist($EL)));$Eq++);if(-1!=$E_){var $ET=$Ec.InAtlasWebGLImagesOffsetValue[$E_];return $Ed=$ET[0],$Er=$ET[1],$Ec.addToAtlas($EM,$Ed,$Er),!0}this._setAtlasParam=!1;for(var $Ex=Math.ceil(($EM.bitmap.width+2)/this._gridSize),$EO=Math.ceil(($EM.bitmap.height+2)/this._gridSize),$Eu=!1,$EG=0;$EG<2;$EG++){var $EV=this._maxAtlaserCount;for($Eq=0;$Eq<$EV;$Eq++){$EH=(this._curAtlasIndex+$Eq)%$EV,this._atlaserArray.length-1>=$EH||this._atlaserArray.push(new $EhM(this._gridNumX,this._gridNumY,this._width,this._height,$EC._sid_++));var $EE=this._atlaserArray[$EH],$Ed=0,$Er=0,$E$=$EE.addTex(1,$Ex,$EO);if($E$.ret){$Ed=$E$.x*this._gridSize+1,$Er=$E$.y*this._gridSize+1,$EL.lock=!0,$EE.addToAtlasTexture($EL,$Ed,$Er),$EE.addToAtlas($EM,$Ed,$Er),$Eu=!0,this._curAtlasIndex=$EH;break}}if($Eu)break;this._atlaserArray.push(new $EhM(this._gridNumX,this._gridNumY,this._width,this._height,$EC._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $Eu||console.log(">>>AtlasManager pushData error"),$Eu},$EM.addToAtlas=function($EM){laya.webgl.atlas.AtlasResourceManager.instance.pushData($EM)},$EM.garbageCollection=function(){if(!0===this._needGC){for(var $EM=this._atlaserArray.length-this._maxAtlaserCount,$Ee=0;$Ee<$EM;$Ee++)this._atlaserArray[$Ee].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$EM),this._atlaserArray.splice(0,$EM),this._needGC=!1}return!0},$EM.freeAll=function(){for(var $EM=0,$Ee=this._atlaserArray.length;$EM<$Ee;$EM++)this._atlaserArray[$EM].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$EM.getAtlaserCount=function(){return this._atlaserArray.length},$EM.getAtlaserByIndex=function($EM){return this._atlaserArray[$EM]},$E_(1,$EC,"instance",function(){return $EC._Instance||($EC._Instance=new $EC(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$EC._Instance}),$E_(1,$EC,"enabled",function(){return $Ey.atlasEnable}),$E_(1,$EC,"atlasLimitWidth",function(){return $EC._atlasLimitWidth},function($EM){$EC._atlasLimitWidth=$EM}),$E_(1,$EC,"atlasLimitHeight",function(){return $EC._atlasLimitHeight},function($EM){$EC._atlasLimitHeight=$EM}),$EC._enable=function(){$Ey.atlasEnable=!0},$EC._disable=function(){$Ey.atlasEnable=!1},$EC.__init__=function(){$EC.atlasTextureWidth=2048,$EC.atlasTextureHeight=2048,$EC.maxTextureCount=6,$EC.atlasLimitWidth=512,$EC.atlasLimitHeight=512},$EC._atlasLimitWidth=0,$EC._atlasLimitHeight=0,$EC.gridSize=16,$EC.atlasTextureWidth=0,$EC.atlasTextureHeight=0,$EC.maxTextureCount=0,$EC._atlasRestore=0,$EC.BOARDER_TYPE_NO=0,$EC.BOARDER_TYPE_RIGHT=1,$EC.BOARDER_TYPE_LEFT=2,$EC.BOARDER_TYPE_BOTTOM=4,$EC.BOARDER_TYPE_TOP=8,$EC.BOARDER_TYPE_ALL=15,$EC._sid_=0,$EC._Instance=null,$EC}(),$Eb=function(){function $EM(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $EV($EM,"laya.webgl.atlas.MergeFillInfo"),$EM}(),$Em=function(){function $Ee(){}return $EV($Ee,"laya.webgl.canvas.BlendMode"),$Ee._init_=function($EM){$Ee.fns=[$Ee.BlendNormal,$Ee.BlendAdd,$Ee.BlendMultiply,$Ee.BlendScreen,$Ee.BlendOverlay,$Ee.BlendLight,$Ee.BlendMask,$Ee.BlendDestinationOut],$Ee.targetFns=[$Ee.BlendNormalTarget,$Ee.BlendAddTarget,$Ee.BlendMultiplyTarget,$Ee.BlendScreenTarget,$Ee.BlendOverlayTarget,$Ee.BlendLightTarget,$Ee.BlendMask,$Ee.BlendDestinationOut]},$Ee.BlendNormal=function($EM){$EM.blendFunc(1,771)},$Ee.BlendAdd=function($EM){$EM.blendFunc(1,772)},$Ee.BlendMultiply=function($EM){$EM.blendFunc(774,771)},$Ee.BlendScreen=function($EM){$EM.blendFunc(1,1)},$Ee.BlendOverlay=function($EM){$EM.blendFunc(1,769)},$Ee.BlendLight=function($EM){$EM.blendFunc(1,1)},$Ee.BlendNormalTarget=function($EM){$EM.blendFunc(1,771)},$Ee.BlendAddTarget=function($EM){$EM.blendFunc(1,772)},$Ee.BlendMultiplyTarget=function($EM){$EM.blendFunc(774,771)},$Ee.BlendScreenTarget=function($EM){$EM.blendFunc(1,1)},$Ee.BlendOverlayTarget=function($EM){$EM.blendFunc(1,769)},$Ee.BlendLightTarget=function($EM){$EM.blendFunc(1,1)},$Ee.BlendMask=function($EM){$EM.blendFunc(0,770)},$Ee.BlendDestinationOut=function($EM){$EM.blendFunc(0,0)},$Ee.activeBlendFunction=null,$Ee.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$Ee.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$Ee.NORMAL="normal",$Ee.ADD="add",$Ee.MULTIPLY="multiply",$Ee.SCREEN="screen",$Ee.LIGHT="light",$Ee.OVERLAY="overlay",$Ee.DESTINATIONOUT="destination-out",$Ee.fns=[],$Ee.targetFns=[],$Ee}(),$Ez=function(){function $EL($EM){this._color=$Ed.create("black"),this.setValue($EM)}$EV($EL,"laya.webgl.canvas.DrawStyle");var $EM=$EL.prototype;return $EM.setValue=function($EM){if($EM){if("string"==typeof $EM)return void(this._color=$Ed.create($EM));if($EM instanceof laya.utils.Color)return void(this._color=$EM)}},$EM.reset=function(){this._color=$Ed.create("black")},$EM.equal=function($EM){return"string"==typeof $EM?this._color.strColor===$EM:$EM instanceof laya.utils.Color&&this._color.numColor===$EM.numColor},$EM.toColorStr=function(){return this._color.strColor},$EL.create=function($EM){var $Ee;if($EM&&("string"==typeof $EM?$Ee=$Ed.create($EM):$EM instanceof laya.utils.Color&&($Ee=$EM),$Ee))return $Ee._drawStyle||($Ee._drawStyle=new $EL($EM));return laya.webgl.canvas.DrawStyle.DEFAULT},$EH($EL,["DEFAULT",function(){return this.DEFAULT=new $EL("#000000")}]),$EL}(),$EQ=function(){function $EM(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$EoM.mainContext;this.ib=$EUM.create(35048),this.vb=$EIM.create(5)}$EV($EM,"laya.webgl.canvas.Path");var $Ee=$EM.prototype;return $Ee.addPoint=function($EM,$Ee){this.tempArray.push($EM,$Ee)},$Ee.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$Ee.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$Ee.polygon=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH;return this.geomatrys.push(this._curGeomatry=$EH=new $ERM($EM,$Ee,$EL,$E_,$Ec,$Eq)),$E_||($EH.fill=!1),null==$Eq&&($EH.borderWidth=0),$EH},$Ee.setGeomtry=function($EM){this.geomatrys.push(this._curGeomatry=$EM)},$Ee.drawLine=function($EM,$Ee,$EL,$E_,$Ec){var $Eq;return this.closePath?this.geomatrys.push(this._curGeomatry=$Eq=new $EpM($EM,$Ee,$EL,$E_,$Ec)):this.geomatrys.push(this._curGeomatry=$Eq=new $ESM($EM,$Ee,$EL,$E_,$Ec)),$Eq.fill=!1,$Eq},$Ee.update=function(){var $EM=this.ib._byteLength,$Ee=this.geomatrys.length;this.offset=$EM;for(var $EL=this.geoStart;$EL<$Ee;$EL++)this.geomatrys[$EL].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$Ee,this.count=(this.ib._byteLength-$EM)/$ErM.BYTES_PIDX},$Ee.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$Ee.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$EM}(),$EY=function(){function $ET(){}$EV($ET,"laya.webgl.canvas.save.SaveBase");var $EM=$ET.prototype;return $EW.imps($EM,{"laya.webgl.canvas.save.ISaveData":!0}),$EM.isSaveMark=function(){return!1},$EM.restore=function($EM){this._dataObj[this._valueName]=this._value,($ET._cache[$ET._cache._length++]=this)._newSubmit&&($EM._curSubmit=$EqM.RENDERBASE,$EM._renderKey=0)},$ET._createArray=function(){var $EM=[];return $EM._length=0,$EM},$ET._init=function(){var $EM=$ET._namemap={};return $EM[1]="ALPHA",$EM[2]="fillStyle",$EM[8]="font",$EM[256]="lineWidth",$EM[512]="strokeStyle",$EM[8192]="_mergeID",$EM[1024]=$EM[2048]=$EM[4096]=[],$EM[16384]="textBaseline",$EM[32768]="textAlign",$EM[65536]="_nBlendType",$EM[1048576]="shader",$EM[2097152]="filters",$EM},$ET.save=function($EM,$Ee,$EL,$E_){if(($EM._saveMark._saveuse&$Ee)!==$Ee){$EM._saveMark._saveuse|=$Ee;var $Ec=$ET._cache,$Eq=0<$Ec._length?$Ec[--$Ec._length]:new $ET;$Eq._value=$EL[$Eq._valueName=$ET._namemap[$Ee]],$Eq._dataObj=$EL,$Eq._newSubmit=$E_;var $EH=$EM._save;$EH[$EH._length++]=$Eq}},$ET._cache=laya.webgl.canvas.save.SaveBase._createArray(),$ET._namemap=$ET._init(),$ET}(),$EP=function(){function $Eq(){this._clipRect=new $Eh}$EV($Eq,"laya.webgl.canvas.save.SaveClipRect");var $EM=$Eq.prototype;return $EW.imps($EM,{"laya.webgl.canvas.save.ISaveData":!0}),$EM.isSaveMark=function(){return!1},$EM.restore=function($EM){$EM._clipRect=this._clipSaveRect,($Eq._cache[$Eq._cache._length++]=this)._submitScissor.submitLength=$EM._submits._length-this._submitScissor.submitIndex,$EM._curSubmit=$EqM.RENDERBASE,$EM._renderKey=0},$Eq.save=function($EM,$Ee){if(131072!=(131072&$EM._saveMark._saveuse)){$EM._saveMark._saveuse|=131072;var $EL=$Eq._cache,$E_=0<$EL._length?$EL[--$EL._length]:new $Eq;$E_._clipSaveRect=$EM._clipRect,$EM._clipRect=$E_._clipRect.copyFrom($EM._clipRect),$E_._submitScissor=$Ee;var $Ec=$EM._save;$Ec[$Ec._length++]=$E_}},$EH($Eq,["_cache",function(){return this._cache=$EY._createArray()}]),$Eq}(),$EZ=function(){function $EE(){this._contextX=0,this._contextY=0,this._clipRect=new $Eh,this._rect=new $Eh,this._matrix=new $EB}$EV($EE,"laya.webgl.canvas.save.SaveClipRectStencil");var $EM=$EE.prototype;return $EW.imps($EM,{"laya.webgl.canvas.save.ISaveData":!0}),$EM.isSaveMark=function(){return!1},$EM.restore=function($EM){$EuM.restore($EM,this._rect,this._saveMatrix,this._contextX,this._contextY),$EM._clipRect=this._clipSaveRect,$EM._curMat=this._saveMatrix,$EM._x=this._contextX,$EM._y=this._contextY,$EE._cache[$EE._cache._length++]=this,$EM._curSubmit=$EqM.RENDERBASE},$EE.save=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){if(262144!=(262144&$EM._saveMark._saveuse)){$EM._saveMark._saveuse|=262144;var $Eu=$EE._cache,$EG=0<$Eu._length?$Eu[--$Eu._length]:new $EE;$EG._clipSaveRect=$EM._clipRect,$EG._clipRect.setTo($EH,$ET,$Ex,$EO),$EM._clipRect=$EG._clipRect,$EG._rect.x=$EL,$EG._rect.y=$E_,$EG._rect.width=$Ec,$EG._rect.height=$Eq,$EG._contextX=$EM._x,$EG._contextY=$EM._y,$EG._saveMatrix=$EM._curMat,$EM._curMat.copyTo($EG._matrix),$EM._curMat=$EG._matrix,$EG._submitStencil=$Ee;var $EV=$EM._save;$EV[$EV._length++]=$EG}},$EH($EE,["_cache",function(){return this._cache=$EY._createArray()}]),$EE}(),$Ev=function(){function $E_(){this._saveuse=0}$EV($E_,"laya.webgl.canvas.save.SaveMark");var $EM=$E_.prototype;return $EW.imps($EM,{"laya.webgl.canvas.save.ISaveData":!0}),$EM.isSaveMark=function(){return!0},$EM.restore=function($EM){$EM._saveMark=this._preSaveMark,$E_._no[$E_._no._length++]=this},$E_.Create=function($EM){var $Ee=$E_._no,$EL=0<$Ee._length?$Ee[--$Ee._length]:new $E_;return $EL._saveuse=0,$EL._preSaveMark=$EM._saveMark,$EM._saveMark=$EL},$EH($E_,["_no",function(){return this._no=$EY._createArray()}]),$E_}(),$EN=function(){function $Eq(){this._matrix=new $EB}$EV($Eq,"laya.webgl.canvas.save.SaveTransform");var $EM=$Eq.prototype;return $EW.imps($EM,{"laya.webgl.canvas.save.ISaveData":!0}),$EM.isSaveMark=function(){return!1},$EM.restore=function($EM){$EM._curMat=this._savematrix,$Eq._no[$Eq._no._length++]=this},$Eq.save=function($EM){var $Ee=$EM._saveMark;if(2048!=(2048&$Ee._saveuse)){$Ee._saveuse|=2048;var $EL=$Eq._no,$E_=0<$EL._length?$EL[--$EL._length]:new $Eq;$E_._savematrix=$EM._curMat,$EM._curMat=$EM._curMat.copyTo($E_._matrix);var $Ec=$EM._save;$Ec[$Ec._length++]=$E_}},$EH($Eq,["_no",function(){return this._no=$EY._createArray()}]),$Eq}(),$Es=function(){function $Ec(){}$EV($Ec,"laya.webgl.canvas.save.SaveTranslate");var $EM=$Ec.prototype;return $EW.imps($EM,{"laya.webgl.canvas.save.ISaveData":!0}),$EM.isSaveMark=function(){return!1},$EM.restore=function($EM){$EM._curMat;$EM._x=this._x,$EM._y=this._y,$Ec._no[$Ec._no._length++]=this},$Ec.save=function($EM){var $Ee=$Ec._no,$EL=0<$Ee._length?$Ee[--$Ee._length]:new $Ec;$EL._x=$EM._x,$EL._y=$EM._y;var $E_=$EM._save;$E_[$E_._length++]=$EL},$EH($Ec,["_no",function(){return this._no=$EY._createArray()}]),$Ec}(),$ED=function(){function $EM(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $Eh}$EV($EM,"laya.webgl.resource.RenderTargetMAX");var $Ee=$EM.prototype;return $Ee.setSP=function($EM){this._sp=$EM},$Ee.size=function($EM,$Ee){var $EL=this;this._width!==$EM||this._height!==$Ee?(this.repaint=!0,this._width=$EM,this._height=$Ee,this.target?this.target.size($EM,$Ee):this.target=$EjM.create($EM,$Ee),this.target.hasListener("recovered")||this.target.on("recovered",this,function($EM){$EW.timer.callLater($EL._sp,$EL._sp.repaint)})):this.target.size($EM,$Ee)},$Ee._flushToTarget=function($EM,$Ee){if(!$Ee._destroy){var $EL=$EKM.worldScissorTest,$E_=$EKM.worldClipRect;$EKM.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$EKM.worldScissorTest=!1,$EoM.mainContext.disable(3089);var $Ec=$EKM.worldAlpha,$Eq=$EKM.worldMatrix4,$EH=$EKM.worldMatrix,$ET=$EKM.worldFilters,$Ex=$EKM.worldShaderDefines;if($EKM.worldMatrix=$EB.EMPTY,$EKM.restoreTempArray(),$EKM.worldMatrix4=$EKM.TEMPMAT4_ARRAY,$EKM.worldAlpha=1,$EKM.worldFilters=null,$EKM.worldShaderDefines=null,$EfM.activeShader=null,$Ee.start(),$Ey.showCanvasMark?$Ee.clear(0,1,0,.3):$Ee.clear(0,0,0,0),$EM.flush(),$Ee.end(),$EfM.activeShader=null,$EKM.worldAlpha=$Ec,$EKM.worldMatrix4=$Eq,$EKM.worldMatrix=$EH,$EKM.worldFilters=$ET,$EKM.worldShaderDefines=$Ex,$EKM.worldScissorTest=$EL){var $EO=$EKM.height-$E_.y-$E_.height;$EoM.mainContext.scissor($E_.x,$EO,$E_.width,$E_.height),$EoM.mainContext.enable(3089)}$EKM.worldClipRect=$E_}},$Ee.flush=function($EM){this.repaint&&(this._flushToTarget($EM,this.target),this.repaint=!1)},$Ee.drawTo=function($EM,$Ee,$EL,$E_,$Ec){$EM.drawTexture(this.target.getTexture(),$Ee,$EL,$E_,$Ec,0,0)},$Ee.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$EM}(),$EU=function(){function $EM(){this.ALPHA=1,this.shaderType=0,this.defines=new $EtM}return $EV($EM,"laya.webgl.shader.d2.Shader2D"),$EM.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$EM.__init__=function(){var $EM,$Ee;$EvM.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$EvM.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$EvM.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$EvM.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$EvM.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$EvM.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$EvM.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$EvM.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$EM="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$Ee='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$EvM.preCompile2D(0,1,$EM,$Ee,null),$EM="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$Ee='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$EvM.preCompile2D(0,2,$EM,$Ee,null),$EM="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$Ee="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$EvM.preCompile2D(0,4,$EM,$Ee,null),$EM="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$Ee='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$EvM.preCompile2D(0,256,$EM,$Ee,null),$EM="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$Ee="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$EvM.preCompile2D(0,512,$EM,$Ee,null)},$EM}(),$EI=function(){function $Ee($EM,$Ee,$EL){this._value=0,this._name2int=$EM,this._int2name=$Ee,this._int2nameMap=$EL}$EV($Ee,"laya.webgl.shader.ShaderDefines");var $EM=$Ee.prototype;return $EM.add=function($EM){return"string"==typeof $EM&&($EM=this._name2int[$EM]),this._value|=$EM,this._value},$EM.addInt=function($EM){return this._value|=$EM,this._value},$EM.remove=function($EM){return"string"==typeof $EM&&($EM=this._name2int[$EM]),this._value&=~$EM,this._value},$EM.isDefine=function($EM){return(this._value&$EM)===$EM},$EM.getValue=function(){return this._value},$EM.setValue=function($EM){this._value=$EM},$EM.toNameDic=function(){var $EM=this._int2nameMap[this._value];return $EM||$Ee._toText(this._value,this._int2name,this._int2nameMap)},$Ee._reg=function($EM,$Ee,$EL,$E_){$E_[$EL[$EM]=$Ee]=$EM},$Ee._toText=function($EM,$Ee,$EL){var $E_=$EL[$EM];if($E_)return $E_;for(var $Ec={},$Eq=1,$EH=0;$EH<32&&!($EM<($Eq=1<<$EH));$EH++)if($EM&$Eq){var $ET=$Ee[$Eq];$ET&&($Ec[$ET]="")}return $EL[$EM]=$Ec},$Ee._toInt=function($EM,$Ee){for(var $EL=$EM.split("."),$E_=0,$Ec=0,$Eq=$EL.length;$Ec<$Eq;$Ec++){var $EH=$Ee[$EL[$Ec]];if(!$EH)throw new Error("Defines to int err:"+$EM+"/"+$EL[$Ec]);$E_|=$EH}return $E_},$Ee}(),$EMM=function(){function $EH(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $EB}$EV($EH,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $EM=$EH.prototype;return $EM.init=function($EM,$Ee,$EL){if($Ee)this._vs=$Ee;else{this._vs=[];var $E_=$EM.width,$Ec=$EM.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($E_,0,1,0,1,1,1,1),this._vs.push($E_,$Ec,1,1,1,1,1,1),this._vs.push(0,$Ec,0,1,1,1,1,1)}$EL?this._ps=$EL:($EH._defaultPS||($EH._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$EH._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$EM},$EM.init2=function($EM,$Ee,$EL,$E_,$Ec){this.transform&&(this.transform=null),$EL?this._ps=$EL:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$E_,this._uvs=$Ec,this.mEleNum=this._ps.length,this.mTexture=$EM,($EC.isConchNode||$EC.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$EM._initMyData=function(){var $EM=0,$Ee=0,$EL=4*this._verticles.length;this._vs=$EH._tempVS;var $E_=!1;if($EC.isConchNode||$EC.isConchApp?(this._vs.length=$EL,$E_=!0):this._vs.length<$EL&&(this._vs.length=$EL,$E_=!0),$EH._tVSLen=$EL,$E_)for(;$EM<$EL;)this._vs[$EM]=this._verticles[$Ee],this._vs[$EM+1]=this._verticles[$Ee+1],this._vs[$EM+2]=this._uvs[$Ee],this._vs[$EM+3]=this._uvs[$Ee+1],this._vs[$EM+4]=1,this._vs[$EM+5]=1,this._vs[$EM+6]=1,this._vs[$EM+7]=1,$EM+=8,$Ee+=2;else for(;$EM<$EL;)this._vs[$EM]=this._verticles[$Ee],this._vs[$EM+1]=this._verticles[$Ee+1],this._vs[$EM+2]=this._uvs[$Ee],this._vs[$EM+3]=this._uvs[$Ee+1],$EM+=8,$Ee+=2},$EM.getData2=function($EM,$Ee,$EL){var $E_;this.mVBBuffer=$EM,this.mIBBuffer=$Ee,this._initMyData(),$EM.appendEx2(this._vs,Float32Array,$EH._tVSLen,4),this._indexStart=$Ee._byteLength,($E_=$EH._tempIB).length<this._ps.length&&($E_.length=this._ps.length);for(var $Ec=0,$Eq=this._ps.length;$Ec<$Eq;$Ec++)$E_[$Ec]=this._ps[$Ec]+$EL;$Ee.appendEx2($E_,Uint16Array,this._ps.length,2)},$EM.getData=function($EM,$Ee,$EL){if(this.mVBBuffer=$EM,this.mIBBuffer=$Ee,$EM.append(this.mVBData),this._indexStart=$Ee._byteLength,this.mIBData.start!=$EL){for(var $E_=0,$Ec=this._ps.length;$E_<$Ec;$E_++)this.mIBData[$E_]=this._ps[$E_]+$EL;this.mIBData.start=$EL}$Ee.append(this.mIBData)},$EM.render=function($EM,$Ee,$EL){if($EC.isWebGL&&this.mTexture){$EM._renderKey=0,$EM._shader2D.glTexture=null,$EeM.getInstance().addSkinMesh(this);var $E_=$EqM.createShape($EM,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$EAM.create(512,0));this.transform||(this.transform=$EB.EMPTY),this.transform.translate($Ee,$EL),$EB.mul(this.transform,$EM._curMat,this._tempMatrix),this.transform.translate(-$Ee,-$EL);var $Ec=$E_.shaderValue,$Eq=$Ec.u_mmat2||$EKM.getMatrArray();$EKM.mat2MatArray(this._tempMatrix,$Eq),$Ec.textureHost=this.mTexture,$Ec.offsetX=0,$Ec.offsetY=0,$Ec.u_mmat2=$Eq,$Ec.ALPHA=$EM._shader2D.ALPHA,$EM._submits[$EM._submits._length++]=$E_}else $EC.isConchApp&&this.mTexture&&(this.transform||(this.transform=$EB.EMPTY),$EM.setSkinMesh&&$EM.setSkinMesh($Ee,$EL,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$EH._tempVS=[],$EH._tempIB=[],$EH._defaultPS=null,$EH._tVSLen=0,$EH}(),$EeM=function(){function $EM(){this.ib=null,this.vb=null;$EoM.mainContext;this.ib=$EUM.create(35048),this.vb=$EIM.create(8)}$EV($EM,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $Ee=$EM.prototype;return $Ee.addSkinMesh=function($EM){$EM.getData2(this.vb,this.ib,this.vb._byteLength/32)},$Ee.reset=function(){this.vb.clear(),this.ib.clear()},$EM.getInstance=function(){return $EM.instance=$EM.instance||new $EM},$EM.instance=null,$EM}(),$ELM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$Ex&&($Ex=0),this.x=$EM,this.y=$Ee,this.width=$EL,this.height=$E_,this.edges=$Ec,this.color=$Eq,this.borderWidth=$EH,this.borderColor=$ET}$EV($EM,"laya.webgl.shapes.BasePoly");var $Ee=$EM.prototype;return $EW.imps($Ee,{"laya.webgl.shapes.IShape":!0}),$Ee.getData=function($EM,$Ee,$EL){},$Ee.rebuild=function($EM){},$Ee.setMatrix=function($EM){},$Ee.needUpdate=function($EM){return!0},$Ee.sector=function($EM,$Ee,$EL){var $E_=this.x,$Ec=this.y,$Eq=this.edges,$EH=(this.r1-this.r0)/$Eq,$ET=this.width,$Ex=this.height,$EO=this.color,$Eu=($EO>>16&255)/255,$EG=($EO>>8&255)/255,$EV=(255&$EO)/255;$EM.push($E_,$Ec,$Eu,$EG,$EV);for(var $EE=0;$EE<$Eq+1;$EE++)$EM.push($E_+Math.sin($EH*$EE+this.r0)*$ET,$Ec+Math.cos($EH*$EE+this.r0)*$Ex),$EM.push($Eu,$EG,$EV);for($EE=0;$EE<$Eq;$EE++)$Ee.push($EL,$EL+$EE+1,$EL+$EE+2)},$Ee.createLine2=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH,$ET,$Ex,$EO,$Eu,$EG,$EV,$EE,$Ed,$Er,$E$,$EC,$EK,$EX,$Eo,$Ei,$EW,$Ey,$EA,$EB,$Ek=$EM.concat(),$Eh=$Ec,$Et=this.borderColor,$ES=($Et>>16&255)/255,$Ep=($Et>>8&255)/255,$ER=(255&$Et)/255,$Ea=$Ek.length/2,$En=$E_,$El=$EL/2;$Ex=$Ek[0],$EO=$Ek[1],$Er=$Ex-($Eu=$Ek[2]),$Ed=($Ed=-($EO-($EG=$Ek[3])))/($EB=Math.sqrt($Ed*$Ed+$Er*$Er))*$El,$Er=$Er/$EB*$El,$Eh.push($Ex-$Ed+this.x,$EO-$Er+this.y,$ES,$Ep,$ER,$Ex+$Ed+this.x,$EO+$Er+this.y,$ES,$Ep,$ER);for(var $Ef=1;$Ef<$Ea-1;$Ef++)$Ex=$Ek[2*($Ef-1)],$EO=$Ek[2*($Ef-1)+1],$Eu=$Ek[2*$Ef],$EG=$Ek[2*$Ef+1],$EV=$Ek[2*($Ef+1)],$EE=$Ek[2*($Ef+1)+1],$Er=$Ex-$Eu,$EC=$Eu-$EV,$Eo=(-($Ed=($Ed=-($EO-$EG))/($EB=Math.sqrt($Ed*$Ed+$Er*$Er))*$El)+$Ex)*(-($Er=$Er/$EB*$El)+$EG)-(-$Ed+$Eu)*(-$Er+$EO),$Ey=(-($E$=($E$=-($EG-$EE))/($EB=Math.sqrt($E$*$E$+$EC*$EC))*$El)+$EV)*(-($EC=$EC/$EB*$El)+$EG)-(-$E$+$Eu)*(-$EC+$EE),$EA=($EK=-$Er+$EO-(-$Er+$EG))*($EW=-$E$+$Eu-(-$E$+$EV))-($Ei=-$EC+$EE-(-$EC+$EG))*($EX=-$Ed+$Eu-(-$Ed+$Ex)),Math.abs($EA)<.1?($EA+=10.1,$Eh.push($Eu-$Ed+this.x,$EG-$Er+this.y,$ES,$Ep,$ER,$Eu+$Ed+this.x,$EG+$Er+this.y,$ES,$Ep,$ER)):((($EH=($EX*$Ey-$EW*$Eo)/$EA)-$Eu)*($EH-$Eu)+(($ET=($Ei*$Eo-$EK*$Ey)/$EA)-$EG)+($ET-$EG),$Eh.push($EH+this.x,$ET+this.y,$ES,$Ep,$ER,$Eu-($EH-$Eu)+this.x,$EG-($ET-$EG)+this.y,$ES,$Ep,$ER));$Ex=$Ek[$Ek.length-4],$EO=$Ek[$Ek.length-3],$Er=$Ex-($Eu=$Ek[$Ek.length-2]),$Ed=($Ed=-($EO-($EG=$Ek[$Ek.length-1])))/($EB=Math.sqrt($Ed*$Ed+$Er*$Er))*$El,$Er=$Er/$EB*$El,$Eh.push($Eu-$Ed+this.x,$EG-$Er+this.y,$ES,$Ep,$ER,$Eu+$Ed+this.x,$EG+$Er+this.y,$ES,$Ep,$ER);var $Ej=$Eq;for($Ef=1;$Ef<$Ej;$Ef++)$Ee.push($En+2*($Ef-1),$En+2*($Ef-1)+1,$En+2*$Ef+1,$En+2*$Ef+1,$En+2*$Ef,$En+2*($Ef-1));return $Eh},$Ee.createLine=function($EM,$Ee,$EL,$E_){var $Ec=$EM.concat(),$Eq=$EM,$EH=this.borderColor,$ET=($EH>>16&255)/255,$Ex=($EH>>8&255)/255,$EO=(255&$EH)/255;$Ec.splice(0,5);var $Eu,$EG,$EV,$EE,$Ed,$Er,$E$,$EC,$EK,$EX,$Eo,$Ei,$EW,$Ey,$EA,$EB,$Ek,$Eh,$Et,$ES,$Ep=$Ec.length/5,$ER=$E_,$Ea=$EL/2;$EV=$Ec[0],$EE=$Ec[1],$EX=$EV-($Ed=$Ec[5]),$EK=($EK=-($EE-($Er=$Ec[6])))/($ES=Math.sqrt($EK*$EK+$EX*$EX))*$Ea,$EX=$EX/$ES*$Ea,$Eq.push($EV-$EK,$EE-$EX,$ET,$Ex,$EO,$EV+$EK,$EE+$EX,$ET,$Ex,$EO);for(var $En=1;$En<$Ep-1;$En++)$EV=$Ec[5*($En-1)],$EE=$Ec[5*($En-1)+1],$Ed=$Ec[5*$En],$Er=$Ec[5*$En+1],$E$=$Ec[5*($En+1)],$EC=$Ec[5*($En+1)+1],$EX=$EV-$Ed,$Ei=$Ed-$E$,$EA=(-($EK=($EK=-($EE-$Er))/($ES=Math.sqrt($EK*$EK+$EX*$EX))*$Ea)+$EV)*(-($EX=$EX/$ES*$Ea)+$Er)-(-$EK+$Ed)*(-$EX+$EE),$Eh=(-($Eo=($Eo=-($Er-$EC))/($ES=Math.sqrt($Eo*$Eo+$Ei*$Ei))*$Ea)+$E$)*(-($Ei=$Ei/$ES*$Ea)+$Er)-(-$Eo+$Ed)*(-$Ei+$EC),$Et=($EW=-$EX+$EE-(-$EX+$Er))*($Ek=-$Eo+$Ed-(-$Eo+$E$))-($EB=-$Ei+$EC-(-$Ei+$Er))*($Ey=-$EK+$Ed-(-$EK+$EV)),Math.abs($Et)<.1?($Et+=10.1,$Eq.push($Ed-$EK,$Er-$EX,$ET,$Ex,$EO,$Ed+$EK,$Er+$EX,$ET,$Ex,$EO)):((($Eu=($Ey*$Eh-$Ek*$EA)/$Et)-$Ed)*($Eu-$Ed)+(($EG=($EB*$EA-$EW*$Eh)/$Et)-$Er)+($EG-$Er),$Eq.push($Eu,$EG,$ET,$Ex,$EO,$Ed-($Eu-$Ed),$Er-($EG-$Er),$ET,$Ex,$EO));$EV=$Ec[$Ec.length-10],$EE=$Ec[$Ec.length-9],$EX=$EV-($Ed=$Ec[$Ec.length-5]),$EK=($EK=-($EE-($Er=$Ec[$Ec.length-4])))/($ES=Math.sqrt($EK*$EK+$EX*$EX))*$Ea,$EX=$EX/$ES*$Ea,$Eq.push($Ed-$EK,$Er-$EX,$ET,$Ex,$EO,$Ed+$EK,$Er+$EX,$ET,$Ex,$EO);var $El=this.edges+1;for($En=1;$En<$El;$En++)$Ee.push($ER+2*($En-1),$ER+2*($En-1)+1,$ER+2*$En+1,$ER+2*$En+1,$ER+2*$En,$ER+2*($En-1));return $Eq},$Ee.createLoopLine=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$EM.concat(),$ET=$Ec||$EM,$Ex=this.borderColor,$EO=($Ex>>16&255)/255,$Eu=($Ex>>8&255)/255,$EG=(255&$Ex)/255;$EH.splice(0,5);var $EV=[$EH[0],$EH[1]],$EE=[$EH[$EH.length-5],$EH[$EH.length-4]],$Ed=$EE[0]+.5*($EV[0]-$EE[0]),$Er=$EE[1]+.5*($EV[1]-$EE[1]);$EH.unshift($Ed,$Er,0,0,0),$EH.push($Ed,$Er,0,0,0);var $E$,$EC,$EK,$EX,$Eo,$Ei,$EW,$Ey,$EA,$EB,$Ek,$Eh,$Et,$ES,$Ep,$ER,$Ea,$En,$El,$Ef,$Ej=$EH.length/5,$EF=$E_,$Eg=$EL/2;$EK=$EH[0],$EX=$EH[1],$EB=$EK-($Eo=$EH[5]),$EA=($EA=-($EX-($Ei=$EH[6])))/($Ef=Math.sqrt($EA*$EA+$EB*$EB))*$Eg,$EB=$EB/$Ef*$Eg,$ET.push($EK-$EA,$EX-$EB,$EO,$Eu,$EG,$EK+$EA,$EX+$EB,$EO,$Eu,$EG);for(var $EJ=1;$EJ<$Ej-1;$EJ++)$EK=$EH[5*($EJ-1)],$EX=$EH[5*($EJ-1)+1],$Eo=$EH[5*$EJ],$Ei=$EH[5*$EJ+1],$EW=$EH[5*($EJ+1)],$Ey=$EH[5*($EJ+1)+1],$EB=$EK-$Eo,$Eh=$Eo-$EW,$Ep=(-($EA=($EA=-($EX-$Ei))/($Ef=Math.sqrt($EA*$EA+$EB*$EB))*$Eg)+$EK)*(-($EB=$EB/$Ef*$Eg)+$Ei)-(-$EA+$Eo)*(-$EB+$EX),$En=(-($Ek=($Ek=-($Ei-$Ey))/($Ef=Math.sqrt($Ek*$Ek+$Eh*$Eh))*$Eg)+$EW)*(-($Eh=$Eh/$Ef*$Eg)+$Ei)-(-$Ek+$Eo)*(-$Eh+$Ey),$El=($Et=-$EB+$EX-(-$EB+$Ei))*($Ea=-$Ek+$Eo-(-$Ek+$EW))-($ER=-$Eh+$Ey-(-$Eh+$Ei))*($ES=-$EA+$Eo-(-$EA+$EK)),Math.abs($El)<.1?($El+=10.1,$ET.push($Eo-$EA,$Ei-$EB,$EO,$Eu,$EG,$Eo+$EA,$Ei+$EB,$EO,$Eu,$EG)):((($E$=($ES*$En-$Ea*$Ep)/$El)-$Eo)*($E$-$Eo)+(($EC=($ER*$Ep-$Et*$En)/$El)-$Ei)+($EC-$Ei),$ET.push($E$,$EC,$EO,$Eu,$EG,$Eo-($E$-$Eo),$Ei-($EC-$Ei),$EO,$Eu,$EG));$Eq&&($Ee=$Eq);var $Ew=this.edges+1;for($EJ=1;$EJ<$Ew;$EJ++)$Ee.push($EF+2*($EJ-1),$EF+2*($EJ-1)+1,$EF+2*$EJ+1,$EF+2*$EJ+1,$EF+2*$EJ,$EF+2*($EJ-1));return $Ee.push($EF+2*($EJ-1),$EF+2*($EJ-1)+1,$EF+1,$EF+1,$EF,$EF+2*($EJ-1)),$ET},$EM}(),$E_M=function(){function $Er(){}return $EV($Er,"laya.webgl.shapes.Earcut"),$Er.earcut=function($EM,$Ee,$EL){$EL=$EL||2;var $E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu=$Ee&&$Ee.length,$EG=$Eu?$Ee[0]*$EL:$EM.length,$EV=$Er.linkedList($EM,0,$EG,$EL,!0),$EE=[];if(!$EV)return $EE;if($Eu&&($EV=$Er.eliminateHoles($EM,$Ee,$EV,$EL)),$EM.length>80*$EL){$E_=$Eq=$EM[0],$Ec=$EH=$EM[1];for(var $Ed=$EL;$Ed<$EG;$Ed+=$EL)($ET=$EM[$Ed])<$E_&&($E_=$ET),($Ex=$EM[$Ed+1])<$Ec&&($Ec=$Ex),$Eq<$ET&&($Eq=$ET),$EH<$Ex&&($EH=$Ex);$EO=0!==($EO=Math.max($Eq-$E_,$EH-$Ec))?1/$EO:0}return $Er.earcutLinked($EV,$EE,$EL,$E_,$Ec,$EO),$EE},$Er.linkedList=function($EM,$Ee,$EL,$E_,$Ec){var $Eq,$EH;if($Ec===0<$Er.signedArea($EM,$Ee,$EL,$E_))for($Eq=$Ee;$Eq<$EL;$Eq+=$E_)$EH=$Er.insertNode($Eq,$EM[$Eq],$EM[$Eq+1],$EH);else for($Eq=$EL-$E_;$Ee<=$Eq;$Eq-=$E_)$EH=$Er.insertNode($Eq,$EM[$Eq],$EM[$Eq+1],$EH);return $EH&&$Er.equals($EH,$EH.next)&&($Er.removeNode($EH),$EH=$EH.next),$EH},$Er.filterPoints=function($EM,$Ee){if(!$EM)return $EM;$Ee||($Ee=$EM);var $EL,$E_=$EM;do{if($EL=!1,$E_.steiner||!$Er.equals($E_,$E_.next)&&0!==$Er.area($E_.prev,$E_,$E_.next))$E_=$E_.next;else{if($Er.removeNode($E_),($E_=$Ee=$E_.prev)===$E_.next)break;$EL=!0}}while($EL||$E_!==$Ee);return $Ee},$Er.earcutLinked=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){if($EM){!$EH&&$Eq&&$Er.indexCurve($EM,$E_,$Ec,$Eq);for(var $ET,$Ex,$EO=$EM;$EM.prev!==$EM.next;)if($ET=$EM.prev,$Ex=$EM.next,$Eq?$Er.isEarHashed($EM,$E_,$Ec,$Eq):$Er.isEar($EM))$Ee.push($ET.i/$EL),$Ee.push($EM.i/$EL),$Ee.push($Ex.i/$EL),$Er.removeNode($EM),$EM=$Ex.next,$EO=$Ex.next;else if(($EM=$Ex)===$EO){$EH?1===$EH?($EM=$Er.cureLocalIntersections($EM,$Ee,$EL),$Er.earcutLinked($EM,$Ee,$EL,$E_,$Ec,$Eq,2)):2===$EH&&$Er.splitEarcut($EM,$Ee,$EL,$E_,$Ec,$Eq):$Er.earcutLinked($Er.filterPoints($EM,null),$Ee,$EL,$E_,$Ec,$Eq,1);break}}},$Er.isEar=function($EM){var $Ee=$EM.prev,$EL=$EM,$E_=$EM.next;if(0<=$Er.area($Ee,$EL,$E_))return!1;for(var $Ec=$EM.next.next;$Ec!==$EM.prev;){if($Er.pointInTriangle($Ee.x,$Ee.y,$EL.x,$EL.y,$E_.x,$E_.y,$Ec.x,$Ec.y)&&0<=$Er.area($Ec.prev,$Ec,$Ec.next))return!1;$Ec=$Ec.next}return!0},$Er.isEarHashed=function($EM,$Ee,$EL,$E_){var $Ec=$EM.prev,$Eq=$EM,$EH=$EM.next;if(0<=$Er.area($Ec,$Eq,$EH))return!1;for(var $ET=$Ec.x<$Eq.x?$Ec.x<$EH.x?$Ec.x:$EH.x:$Eq.x<$EH.x?$Eq.x:$EH.x,$Ex=$Ec.y<$Eq.y?$Ec.y<$EH.y?$Ec.y:$EH.y:$Eq.y<$EH.y?$Eq.y:$EH.y,$EO=$Ec.x>$Eq.x?$Ec.x>$EH.x?$Ec.x:$EH.x:$Eq.x>$EH.x?$Eq.x:$EH.x,$Eu=$Ec.y>$Eq.y?$Ec.y>$EH.y?$Ec.y:$EH.y:$Eq.y>$EH.y?$Eq.y:$EH.y,$EG=$Er.zOrder($ET,$Ex,$Ee,$EL,$E_),$EV=$Er.zOrder($EO,$Eu,$Ee,$EL,$E_),$EE=$EM.nextZ;$EE&&$EE.z<=$EV;){if($EE!==$EM.prev&&$EE!==$EM.next&&$Er.pointInTriangle($Ec.x,$Ec.y,$Eq.x,$Eq.y,$EH.x,$EH.y,$EE.x,$EE.y)&&0<=$Er.area($EE.prev,$EE,$EE.next))return!1;$EE=$EE.nextZ}for($EE=$EM.prevZ;$EE&&$EE.z>=$EG;){if($EE!==$EM.prev&&$EE!==$EM.next&&$Er.pointInTriangle($Ec.x,$Ec.y,$Eq.x,$Eq.y,$EH.x,$EH.y,$EE.x,$EE.y)&&0<=$Er.area($EE.prev,$EE,$EE.next))return!1;$EE=$EE.prevZ}return!0},$Er.cureLocalIntersections=function($EM,$Ee,$EL){var $E_=$EM;do{var $Ec=$E_.prev,$Eq=$E_.next.next;!$Er.equals($Ec,$Eq)&&$Er.intersects($Ec,$E_,$E_.next,$Eq)&&$Er.locallyInside($Ec,$Eq)&&$Er.locallyInside($Eq,$Ec)&&($Ee.push($Ec.i/$EL),$Ee.push($E_.i/$EL),$Ee.push($Eq.i/$EL),$Er.removeNode($E_),$Er.removeNode($E_.next),$E_=$EM=$Eq),$E_=$E_.next}while($E_!==$EM);return $E_},$Er.splitEarcut=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$EM;do{for(var $ET=$EH.next.next;$ET!==$EH.prev;){if($EH.i!==$ET.i&&$Er.isValidDiagonal($EH,$ET)){var $Ex=$Er.splitPolygon($EH,$ET);return $EH=$Er.filterPoints($EH,$EH.next),$Ex=$Er.filterPoints($Ex,$Ex.next),$Er.earcutLinked($EH,$Ee,$EL,$E_,$Ec,$Eq),void $Er.earcutLinked($Ex,$Ee,$EL,$E_,$Ec,$Eq)}$ET=$ET.next}$EH=$EH.next}while($EH!==$EM)},$Er.eliminateHoles=function($EM,$Ee,$EL,$E_){var $Ec,$Eq,$EH,$ET,$Ex,$EO=[];for($Ec=0,$Eq=$Ee.length;$Ec<$Eq;$Ec++)$EH=$Ee[$Ec]*$E_,$ET=$Ec<$Eq-1?$Ee[$Ec+1]*$E_:$EM.length,($Ex=$Er.linkedList($EM,$EH,$ET,$E_,!1))===$Ex.next&&($Ex.steiner=!0),$EO.push($Er.getLeftmost($Ex));for($EO.sort($Er.compareX),$Ec=0;$Ec<$EO.length;$Ec++)$Er.eliminateHole($EO[$Ec],$EL),$EL=$Er.filterPoints($EL,$EL.next);return $EL},$Er.compareX=function($EM,$Ee){return $EM.x-$Ee.x},$Er.eliminateHole=function($EM,$Ee){if($Ee=$Er.findHoleBridge($EM,$Ee)){var $EL=$Er.splitPolygon($Ee,$EM);$Er.filterPoints($EL,$EL.next)}},$Er.findHoleBridge=function($EM,$Ee){var $EL,$E_=$Ee,$Ec=$EM.x,$Eq=$EM.y,$EH=-1/0;do{if($Eq<=$E_.y&&$Eq>=$E_.next.y&&$E_.next.y!==$E_.y){var $ET=$E_.x+($Eq-$E_.y)*($E_.next.x-$E_.x)/($E_.next.y-$E_.y);if($ET<=$Ec&&$EH<$ET){if(($EH=$ET)===$Ec){if($Eq===$E_.y)return $E_;if($Eq===$E_.next.y)return $E_.next}$EL=$E_.x<$E_.next.x?$E_:$E_.next}}$E_=$E_.next}while($E_!==$Ee);if(!$EL)return null;if($Ec===$EH)return $EL.prev;var $Ex,$EO=$EL,$Eu=$EL.x,$EG=$EL.y,$EV=1/0;for($E_=$EL.next;$E_!==$EO;)$Ec>=$E_.x&&$E_.x>=$Eu&&$Ec!==$E_.x&&$Er.pointInTriangle($Eq<$EG?$Ec:$EH,$Eq,$Eu,$EG,$Eq<$EG?$EH:$Ec,$Eq,$E_.x,$E_.y)&&(($Ex=Math.abs($Eq-$E_.y)/($Ec-$E_.x))<$EV||$Ex===$EV&&$E_.x>$EL.x)&&$Er.locallyInside($E_,$EM)&&($EL=$E_,$EV=$Ex),$E_=$E_.next;return $EL},$Er.indexCurve=function($EM,$Ee,$EL,$E_){for(var $Ec=$EM;null===$Ec.z&&($Ec.z=$Er.zOrder($Ec.x,$Ec.y,$Ee,$EL,$E_)),$Ec.prevZ=$Ec.prev,$Ec.nextZ=$Ec.next,($Ec=$Ec.next)!==$EM;);$Ec.prevZ.nextZ=null,$Ec.prevZ=null,$Er.sortLinked($Ec)},$Er.sortLinked=function($EM){var $Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO=1;do{for($EL=$EM,$Eq=$EM=null,$EH=0;$EL;){for($EH++,$E_=$EL,$Ee=$ET=0;$Ee<$EO&&($ET++,$E_=$E_.nextZ);$Ee++);for($Ex=$EO;0<$ET||0<$Ex&&$E_;)0!==$ET&&(0===$Ex||!$E_||$EL.z<=$E_.z)?($EL=($Ec=$EL).nextZ,$ET--):($E_=($Ec=$E_).nextZ,$Ex--),$Eq?$Eq.nextZ=$Ec:$EM=$Ec,$Ec.prevZ=$Eq,$Eq=$Ec;$EL=$E_}$Eq.nextZ=null,$EO*=2}while(1<$EH);return $EM},$Er.zOrder=function($EM,$Ee,$EL,$E_,$Ec){return($EM=1431655765&(($EM=858993459&(($EM=252645135&(($EM=16711935&(($EM=32767*($EM-$EL)*$Ec)|$EM<<8))|$EM<<4))|$EM<<2))|$EM<<1))|($Ee=1431655765&(($Ee=858993459&(($Ee=252645135&(($Ee=16711935&(($Ee=32767*($Ee-$E_)*$Ec)|$Ee<<8))|$Ee<<4))|$Ee<<2))|$Ee<<1))<<1},$Er.getLeftmost=function($EM){for(var $Ee=$EM,$EL=$EM;$Ee.x<$EL.x&&($EL=$Ee),($Ee=$Ee.next)!==$EM;);return $EL},$Er.pointInTriangle=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){return 0<=($Ec-$EH)*($Ee-$ET)-($EM-$EH)*($Eq-$ET)&&0<=($EM-$EH)*($E_-$ET)-($EL-$EH)*($Ee-$ET)&&0<=($EL-$EH)*($Eq-$ET)-($Ec-$EH)*($E_-$ET)},$Er.isValidDiagonal=function($EM,$Ee){return $EM.next.i!==$Ee.i&&$EM.prev.i!==$Ee.i&&!$Er.intersectsPolygon($EM,$Ee)&&$Er.locallyInside($EM,$Ee)&&$Er.locallyInside($Ee,$EM)&&$Er.middleInside($EM,$Ee)},$Er.area=function($EM,$Ee,$EL){return($Ee.y-$EM.y)*($EL.x-$Ee.x)-($Ee.x-$EM.x)*($EL.y-$Ee.y)},$Er.equals=function($EM,$Ee){return $EM.x===$Ee.x&&$EM.y===$Ee.y},$Er.intersects=function($EM,$Ee,$EL,$E_){return!!($Er.equals($EM,$Ee)&&$Er.equals($EL,$E_)||$Er.equals($EM,$E_)&&$Er.equals($EL,$Ee))||0<$Er.area($EM,$Ee,$EL)!=0<$Er.area($EM,$Ee,$E_)&&0<$Er.area($EL,$E_,$EM)!=0<$Er.area($EL,$E_,$Ee)},$Er.intersectsPolygon=function($EM,$Ee){var $EL=$EM;do{if($EL.i!==$EM.i&&$EL.next.i!==$EM.i&&$EL.i!==$Ee.i&&$EL.next.i!==$Ee.i&&$Er.intersects($EL,$EL.next,$EM,$Ee))return!0;$EL=$EL.next}while($EL!==$EM);return!1},$Er.locallyInside=function($EM,$Ee){return $Er.area($EM.prev,$EM,$EM.next)<0?0<=$Er.area($EM,$Ee,$EM.next)&&0<=$Er.area($EM,$EM.prev,$Ee):$Er.area($EM,$Ee,$EM.prev)<0||$Er.area($EM,$EM.next,$Ee)<0},$Er.middleInside=function($EM,$Ee){for(var $EL=$EM,$E_=!1,$Ec=($EM.x+$Ee.x)/2,$Eq=($EM.y+$Ee.y)/2;$EL.y>$Eq!=$EL.next.y>$Eq&&$EL.next.y!==$EL.y&&$Ec<($EL.next.x-$EL.x)*($Eq-$EL.y)/($EL.next.y-$EL.y)+$EL.x&&($E_=!$E_),($EL=$EL.next)!==$EM;);return $E_},$Er.splitPolygon=function($EM,$Ee){var $EL=new $EcM($EM.i,$EM.x,$EM.y),$E_=new $EcM($Ee.i,$Ee.x,$Ee.y),$Ec=$EM.next,$Eq=$Ee.prev;return($EM.next=$Ee).prev=$EM,($EL.next=$Ec).prev=$EL,($E_.next=$EL).prev=$E_,($Eq.next=$E_).prev=$Eq,$E_},$Er.insertNode=function($EM,$Ee,$EL,$E_){var $Ec=new $EcM($EM,$Ee,$EL);return $E_?($Ec.next=$E_.next,($Ec.prev=$E_).next.prev=$Ec,$E_.next=$Ec):($Ec.prev=$Ec).next=$Ec,$Ec},$Er.removeNode=function($EM){$EM.next.prev=$EM.prev,$EM.prev.next=$EM.next,$EM.prevZ&&($EM.prevZ.nextZ=$EM.nextZ),$EM.nextZ&&($EM.nextZ.prevZ=$EM.prevZ)},$Er.signedArea=function($EM,$Ee,$EL,$E_){for(var $Ec=0,$Eq=$Ee,$EH=$EL-$E_;$Eq<$EL;$Eq+=$E_)$Ec+=($EM[$EH]-$EM[$Eq])*($EM[$Eq+1]+$EM[$EH+1]),$EH=$Eq;return $Ec},$Er}(),$EcM=function(){function $EM($EM,$Ee,$EL){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$EM,this.x=$Ee,this.y=$EL,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $EV($EM,"laya.webgl.shapes.EarcutNode"),$EM}(),$EqM=(function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this.lineWidth=$EM,this.lineColor=$Ee,this.lineAlpha=$EL,this.fillColor=$E_,this.fillAlpha=$Ec,this.shape=$EH,this.fill=$Eq}$EV($EM,"laya.webgl.shapes.GeometryData");var $Ee=$EM.prototype;$Ee.clone=function(){return new $EM(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$Ee.getIndexData=function(){return null},$Ee.getVertexData=function(){return null},$Ee.destroy=function(){this.shape=null}}(),function(){function $EM($EM){if($EM instanceof Float32Array)this.points=$EM;else if($EM instanceof Array){$EM.length;this.points=new Float32Array($EM)}}$EV($EM,"laya.webgl.shapes.Vertex");var $Ee=$EM.prototype;$EW.imps($Ee,{"laya.webgl.shapes.IShape":!0}),$Ee.getData=function($EM,$Ee,$EL){},$Ee.needUpdate=function($EM){return!1},$Ee.rebuild=function($EM){},$Ee.setMatrix=function($EM){}}(),function(){function $Ex($EM){void 0===$EM&&($EM=1e4),this._renderType=$EM}$EV($Ex,"laya.webgl.submit.Submit");var $EM=$Ex.prototype;return $EW.imps($EM,{"laya.webgl.submit.ISubmit":!0}),$EM.releaseRender=function(){var $EM=$Ex._cache;($EM[$EM._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$EM.getRenderType=function(){return this._renderType},$EM.renderSubmit=function(){if(0===this._numEle)return 1;var $EM=this.shaderValue.textureHost;if($EM){var $Ee=$EM.source;if(!$EM.bitmap||!$Ee)return 1;this.shaderValue.texture=$Ee,$EM.alphaTexture&&$EM.alphaTexture.source&&(this.shaderValue.texture1=$EM.alphaTexture.source)}this._vb.bind_upload(this._ib);var $EL=$EoM.mainContext;return this.shaderValue.upload(),$Em.activeBlendFunction!==this._blendFn&&($EL.enable(3042),this._blendFn($EL),$Em.activeBlendFunction=this._blendFn),$Ep.drawCall++,$Ep.trianglesFaces+=this._numEle/3,$EL.drawElements(4,this._numEle,5123,this._startIdx),1},$Ex.__init__=function(){var $EM=$Ex.RENDERBASE=new $Ex(-1);$EM.shaderValue=new $EAM(0,0),$EM.shaderValue.ALPHA=-1234},$Ex.createSubmit=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$Ex._cache._length?$Ex._cache[--$Ex._cache._length]:new $Ex;null==$EL&&(($EL=$Eq._selfVb||($Eq._selfVb=$EIM.create(-1))).clear(),$E_=0),$Eq._ib=$Ee,$Eq._vb=$EL,$Eq._startIdx=$E_*$ErM.BYTES_PIDX,$Eq._numEle=0;var $EH=$EM._nBlendType;$Eq._blendFn=$EM._targets?$Em.targetFns[$EH]:$Em.fns[$EH],$Eq.shaderValue=$Ec,$Eq.shaderValue.setValue($EM._shader2D);var $ET=$EM._shader2D.filters;return $ET&&$Eq.shaderValue.setFilters($ET),$Eq},$Ex.createShape=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$Ex._cache._length?$Ex._cache[--$Ex._cache._length]:new $Ex;$EH._ib=$Ee,$EH._vb=$EL,$EH._numEle=$E_,$EH._startIdx=$Ec,$EH.shaderValue=$Eq,$EH.shaderValue.setValue($EM._shader2D);var $ET=$EM._nBlendType;return $EH._blendFn=$EM._targets?$Em.targetFns[$ET]:$Em.fns[$ET],$EH},$Ex.TYPE_2D=1e4,$Ex.TYPE_CANVAS=10003,$Ex.TYPE_CMDSETRT=10004,$Ex.TYPE_CUSTOM=10005,$Ex.TYPE_BLURRT=10006,$Ex.TYPE_CMDDESTORYPRERT=10007,$Ex.TYPE_DISABLESTENCIL=10008,$Ex.TYPE_OTHERIBVB=10009,$Ex.TYPE_PRIMITIVE=10010,$Ex.TYPE_RT=10011,$Ex.TYPE_BLUR_RT=10012,$Ex.TYPE_TARGET=10013,$Ex.TYPE_CHANGE_VALUE=10014,$Ex.TYPE_SHAPE=10015,$Ex.TYPE_TEXTURE=10016,$Ex.TYPE_FILLTEXTURE=10017,$Ex.RENDERBASE=null,$Ex._cache=(($Ex._cache=[])._length=0,$Ex._cache),$Ex}()),$EHM=function(){function $E_(){this.fun=null,this.args=null}$EV($E_,"laya.webgl.submit.SubmitCMD");var $EM=$E_.prototype;return $EW.imps($EM,{"laya.webgl.submit.ISubmit":!0}),$EM.renderSubmit=function(){return this.fun.apply(null,this.args),1},$EM.getRenderType=function(){return 0},$EM.releaseRender=function(){var $EM=$E_._cache;$EM[$EM._length++]=this},$E_.create=function($EM,$Ee){var $EL=$E_._cache._length?$E_._cache[--$E_._cache._length]:new $E_;return $EL.fun=$Ee,$EL.args=$EM,$EL},$E_._cache=(($E_._cache=[])._length=0,$E_._cache),$E_}(),$ETM=function(){function $Ee(){this.variables={}}$EV($Ee,"laya.webgl.submit.SubmitCMDScope");var $EM=$Ee.prototype;return $EM.getValue=function($EM){return this.variables[$EM]},$EM.addValue=function($EM,$Ee){return this.variables[$EM]=$Ee},$EM.setValue=function($EM,$Ee){return this.variables.hasOwnProperty($EM)?this.variables[$EM]=$Ee:null},$EM.clear=function(){for(var $EM in this.variables)delete this.variables[$EM]},$EM.recycle=function(){this.clear(),$Ee.POOL.push(this)},$Ee.create=function(){var $EM=$Ee.POOL.pop();return $EM||($EM=new $Ee),$EM},$Ee.POOL=[],$Ee}(),$ExM=function(){function $EG(){this.offset=0,this.startIndex=0,this._mat=$EB.create()}$EV($EG,"laya.webgl.submit.SubmitOtherIBVB");var $EM=$EG.prototype;return $EW.imps($EM,{"laya.webgl.submit.ISubmit":!0}),$EM.releaseRender=function(){var $EM=$EG._cache;($EM[$EM._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$EM.getRenderType=function(){return 10009},$EM.renderSubmit=function(){var $EM=this._shaderValue.textureHost;if($EM){var $Ee=$EM.source;if(!$EM.bitmap||!$Ee)return 1;this._shaderValue.texture=$Ee}this._vb.bind_upload(this._ib);var $EL=$EKM.worldMatrix4,$E_=$EB.TEMP;$EB.mulPre(this._mat,$EL[0],$EL[1],$EL[4],$EL[5],$EL[12],$EL[13],$E_);var $Ec=$EKM.worldMatrix4=$EG.tempMatrix4;$Ec[0]=$E_.a,$Ec[1]=$E_.b,$Ec[4]=$E_.c,$Ec[5]=$E_.d,$Ec[12]=$E_.tx,$Ec[13]=$E_.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $Eq=$EoM.mainContext;return $Em.activeBlendFunction!==this._blendFn&&($Eq.enable(3042),this._blendFn($Eq),$Em.activeBlendFunction=this._blendFn),$Ep.drawCall++,$Ep.trianglesFaces+=this._numEle/3,$Eq.drawElements(4,this._numEle,5123,this.startIndex),$EKM.worldMatrix4=$EL,$EfM.activeShader=null,1},$EG.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){void 0===$Ex&&($Ex=0);var $EO=$EG._cache._length?$EG._cache[--$EG._cache._length]:new $EG;$EO._ib=$EL,$EO._vb=$Ee,$EO._numEle=$E_,$EO._shader=$Ec,$EO._shaderValue=$Eq;var $Eu=$EM._nBlendType;switch($EO._blendFn=$EM._targets?$Em.targetFns[$Eu]:$Em.fns[$Eu],$Ex){case 0:$EO.offset=0,$EO.startIndex=$ET/($ErM.BYTES_PE*$Ee.vertexStride)*1.5,$EO.startIndex*=$ErM.BYTES_PIDX;break;case 1:$EO.startIndex=$EH,$EO.offset=$ET}return $EO},$EG._cache=(($EG._cache=[])._length=0,$EG._cache),$EG.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$EG}(),$EOM=function(){function $EL(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $Eh,this.screenRect=new $Eh}$EV($EL,"laya.webgl.submit.SubmitScissor");var $EM=$EL.prototype;return $EW.imps($EM,{"laya.webgl.submit.ISubmit":!0}),$EM._scissor=function($EM,$Ee,$EL,$E_){var $Ec=$EKM.worldMatrix4,$Eq=$Ec[0],$EH=$Ec[5],$ET=$Ec[12],$Ex=$Ec[13];if($E_*=$EH,($EL*=$Eq)<1||$E_<1)return!1;var $EO=($EM=$EM*$Eq+$ET)+$EL,$Eu=($Ee=$Ee*$EH+$Ex)+$E_;$EM<0&&($EL=$EO-($EM=0)),$Ee<0&&($E_=$Eu-($Ee=0));var $EG=$EKM.worldClipRect;if($EM=Math.max($EM,$EG.x),$Ee=Math.max($Ee,$EG.y),$EL=Math.min($EO,$EG.right)-$EM,$E_=Math.min($Eu,$EG.bottom)-$Ee,$EL<1||$E_<1)return!1;var $EV=$EKM.worldScissorTest;return this.screenRect.copyFrom($EG),$EG.x=$EM,$EG.y=$Ee,$EG.width=$EL,$EG.height=$E_,$EKM.worldScissorTest=!0,$Ee=$EKM.height-$Ee-$E_,$EoM.mainContext.scissor($EM,$Ee,$EL,$E_),$EoM.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$EV?($Ee=$EKM.height-this.screenRect.y-this.screenRect.height,$EoM.mainContext.scissor(this.screenRect.x,$Ee,this.screenRect.width,this.screenRect.height),$EoM.mainContext.enable(3089)):($EoM.mainContext.disable(3089),$EKM.worldScissorTest=!1),$EG.copyFrom(this.screenRect),!0},$EM._scissorWithTagart=function($EM,$Ee,$EL,$E_){if($EL<1||$E_<1)return!1;var $Ec=$EM+$EL,$Eq=$Ee+$E_;$EM<0&&($EL=$Ec-($EM=0)),$Ee<0&&($E_=$Eq-($Ee=0));var $EH=$EKM.worldClipRect;if($EM=Math.max($EM,$EH.x),$Ee=Math.max($Ee,$EH.y),$EL=Math.min($Ec,$EH.right)-$EM,$E_=Math.min($Eq,$EH.bottom)-$Ee,$EL<1||$E_<1)return!1;var $ET=$EKM.worldScissorTest;return this.screenRect.copyFrom($EH),$EKM.worldScissorTest=!0,$EH.x=$EM,$EH.y=$Ee,$EH.width=$EL,$EH.height=$E_,$Ee=$EKM.height-$Ee-$E_,$EoM.mainContext.scissor($EM,$Ee,$EL,$E_),$EoM.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$ET?($Ee=$EKM.height-this.screenRect.y-this.screenRect.height,$EoM.mainContext.scissor(this.screenRect.x,$Ee,this.screenRect.width,this.screenRect.height),$EoM.mainContext.enable(3089)):($EoM.mainContext.disable(3089),$EKM.worldScissorTest=!1),$EH.copyFrom(this.screenRect),!0},$EM.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$EM.getRenderType=function(){return 0},$EM.releaseRender=function(){var $EM=$EL._cache;($EM[$EM._length++]=this).context=null},$EL.create=function($EM){var $Ee=$EL._cache._length?$EL._cache[--$EL._cache._length]:new $EL;return $Ee.context=$EM,$Ee},$EL._cache=(($EL._cache=[])._length=0,$EL._cache),$EL}(),$EuM=function(){function $Ex(){this.step=0,this.blendMode=null,this.level=0}$EV($Ex,"laya.webgl.submit.SubmitStencil");var $EM=$Ex.prototype;return $EW.imps($EM,{"laya.webgl.submit.ISubmit":!0}),$EM.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$EM.getRenderType=function(){return 0},$EM.releaseRender=function(){var $EM=$Ex._cache;$EM[$EM._length++]=this},$EM.do1=function(){var $EM=$EoM.mainContext;$EM.enable(2960),$EM.clear(1024),$EM.colorMask(!1,!1,!1,!1),$EM.stencilFunc(514,this.level,255),$EM.stencilOp(7680,7680,7682)},$EM.do2=function(){var $EM=$EoM.mainContext;$EM.stencilFunc(514,this.level+1,255),$EM.colorMask(!0,!0,!0,!0),$EM.stencilOp(7680,7680,7680)},$EM.do3=function(){var $EM=$EoM.mainContext;$EM.colorMask(!0,!0,!0,!0),$EM.stencilOp(7680,7680,7680),$EM.clear(1024),$EM.disable(2960)},$EM.do4=function(){var $EM=$EoM.mainContext;0==this.level&&($EM.enable(2960),$EM.clear(1024)),$EM.colorMask(!1,!1,!1,!1),$EM.stencilFunc(519,0,255),$EM.stencilOp(7680,7680,7682)},$EM.do5=function(){var $EM=$EoM.mainContext;$EM.stencilFunc(514,this.level,255),$EM.colorMask(!0,!0,!0,!0),$EM.stencilOp(7680,7680,7680)},$EM.do6=function(){var $EM=$EoM.mainContext;$Em.targetFns[$Em.TOINT[this.blendMode]]($EM)},$EM.do7=function(){var $EM=$EoM.mainContext;$EM.colorMask(!1,!1,!1,!1),$EM.stencilOp(7680,7680,7683)},$EM.do8=function(){var $EM=$EoM.mainContext;$EM.colorMask(!0,!0,!0,!0),$EM.stencilFunc(514,this.level,255),$EM.stencilOp(7680,7680,7680)},$Ex.restore=function($EM,$Ee,$EL,$E_,$Ec){var $Eq;if(($EM._renderKey=0)<$Ex._mask&&$Ex._mask--,0==$Ex._mask)$Eq=laya.webgl.submit.SubmitStencil.create(3),$EM.addRenderObject($Eq),$EM._curSubmit=$EqM.RENDERBASE;else{$Eq=laya.webgl.submit.SubmitStencil.create(7),$EM.addRenderObject($Eq);var $EH=$EM._vb;$EH._byteLength;if($E$M.fillRectImgVb($EH,null,$Ee.x,$Ee.y,$Ee.width,$Ee.height,$El.DEF_UV,$EL,$E_,$Ec,0,0)){$EM._shader2D.glTexture=null;var $ET=$EM._curSubmit=$EqM.createSubmit($EM,$EM._ib,$EH,($EH._byteLength-64)/32*3,$EAM.create(2,0));$ET.shaderValue.ALPHA=1,$EM._submits[$EM._submits._length++]=$ET,$EM._curSubmit._numEle+=6,$EM._curSubmit=$EqM.RENDERBASE}else alert("clipRect calc stencil rect error");$Eq=laya.webgl.submit.SubmitStencil.create(8),$EM.addRenderObject($Eq)}},$Ex.restore2=function($EM,$Ee){var $EL;($EM._renderKey=0)<$Ex._mask&&$Ex._mask--,0==$Ex._mask?($EL=laya.webgl.submit.SubmitStencil.create(3),$EM.addRenderObject($EL),$EM._curSubmit=$EqM.RENDERBASE):($EL=laya.webgl.submit.SubmitStencil.create(7),$EM.addRenderObject($EL),$EM._submits[$EM._submits._length++]=$Ee,$EL=laya.webgl.submit.SubmitStencil.create(8),$EM.addRenderObject($EL))},$Ex.create=function($EM){var $Ee=$Ex._cache._length?$Ex._cache[--$Ex._cache._length]:new $Ex;return 5==($Ee.step=$EM)&&++$Ex._mask,$Ee.level=$Ex._mask,$Ee},$Ex._cache=(($Ex._cache=[])._length=0,$Ex._cache),$Ex._mask=0,$Ex}(),$EGM=function(){function $ET(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$EV($ET,"laya.webgl.submit.SubmitTarget");var $EM=$ET.prototype;return $EW.imps($EM,{"laya.webgl.submit.ISubmit":!0}),$EM.renderSubmit=function(){this._vb.bind_upload(this._ib);var $EM=this.scope.getValue(this.proName);return $EM&&(this.shaderValue.texture=$EM.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$EM.width,$EM.height]),this.shaderValue.upload(),this.blend(),$Ep.drawCall++,$Ep.trianglesFaces+=this._numEle/3,$EoM.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$EM.blend=function(){if($Em.activeBlendFunction!==$Em.fns[this.blendType]){var $EM=$EoM.mainContext;$EM.enable(3042),$Em.fns[this.blendType]($EM),$Em.activeBlendFunction=$Em.fns[this.blendType]}},$EM.getRenderType=function(){return 0},$EM.releaseRender=function(){var $EM=$ET._cache;($EM[$EM._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$ET.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$ET._cache._length?$ET._cache[--$ET._cache._length]:new $ET;return $EH._ib=$Ee,$EH._vb=$EL,$EH.proName=$Eq,$EH._startIdx=$E_*$ErM.BYTES_PIDX,$EH._numEle=0,$EH.blendType=$EM._nBlendType,$EH.shaderValue=$Ec,$EH.shaderValue.setValue($EM._shader2D),$EH},$ET._cache=(($ET._cache=[])._length=0,$ET._cache),$ET}(),$EVM=function(){function $EM(){this._sourceStr=null}$EV($EM,"laya.webgl.text.CharSegment");var $Ee=$EM.prototype;return $EW.imps($Ee,{"laya.webgl.text.ICharSegment":!0}),$Ee.textToSpit=function($EM){this._sourceStr=$EM},$Ee.getChar=function($EM){return this._sourceStr.charAt($EM)},$Ee.getCharCode=function($EM){return this._sourceStr.charCodeAt($EM)},$Ee.length=function(){return this._sourceStr.length},$EM}(),$EEM=function(){var $EM;function $Ep(){}return $EV($Ep,"laya.webgl.text.DrawText"),$Ep.__init__=function(){$Ep._charsTemp=new Array,$Ep._drawValue=new $EM,$Ep._charSeg=new $EVM},$Ep.customCharSeg=function($EM){$Ep._charSeg=$EM},$Ep.getChar=function($EM,$Ee,$EL){var $E_=$EYM.createOneChar($EM,$EL);return-1!=$Ee&&($Ep._charsCache[$Ee]=$E_),$E_},$Ep._drawSlow=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG,$EV,$EE,$Ed){var $Er,$E$,$EC=$Ep._drawValue.value($Eq,$ET,$Ex,$EO,$EV,$EE,$Ed),$EK=0,$EX=0,$Eo=$Ep._charsTemp,$Ei=0,$EW=NaN;if($E_)for($Eo.length=$E_.length,$EK=0,$EX=$E_.length;$EK<$EX;$EK++)($E$=$E_[$EK])&&($EW=$E$.charNum+$EC.txtID,$Eo[$EK]=$Er=$Ep._charsCache[$EW]||$Ep.getChar($E$.char,$EW,$EC),$Er.active());else{var $Ey=$EL instanceof laya.utils.WordText?$EL.toString():$EL;if($En.CharacterCache){$Ep._charSeg.textToSpit($Ey);var $EA=$Ep._charSeg.length();for($EK=0,$EX=$Eo.length=$EA;$EK<$EX;$EK++)$EW=$Ep._charSeg.getCharCode($EK)+$EC.txtID,$Eo[$EK]=$Er=$Ep._charsCache[$EW]||$Ep.getChar($Ep._charSeg.getChar($EK),$EW,$EC),$Er.active(),$Ei+=$Er.cw}else $Eo.length=0,($Er=$Ep.getChar($Ey,-1,$EC)).active(),$Ei+=$Er.cw,$Eo[0]=$Er}var $EB=0;null!==$EH&&"left"!==$EH&&($EB=-("center"==$EH?$Ei/2:$Ei));var $Ek,$Eh,$Et=NaN,$ES=0;if($E_)for($EK=0,$EX=$Eo.length;$EK<$EX;$EK++)$Er=$Eo[$EK],$E$=$E_[$EK],$Er&&$E$&&!$Er.isSpace&&($Et=$Er.borderSize,$Ek=$Er.texture,$Ee._drawText($Ek,$Eu+$EB+$E$.x*$EV-$Et,$EG+$E$.y*$EE-$Et,$Ek.width,$Ek.height,$Ec,0,0,0,0));else{for($EK=0,$EX=$Eo.length;$EK<$EX;$EK++)($Er=$Eo[$EK])&&!$Er.isSpace&&($Et=$Er.borderSize,$Ek=$Er.texture,$Ee._drawText($Ek,$Eu+$EB-$Et,$EG-$Et,$Ek.width,$Ek.height,$Ec,0,0,0,0),$EM&&(($Eh=$EM[$ES++])||($Eh=$EM[$ES-1]=[]),$Eh[0]=$Ek,$Eh[1]=$EB-$Et,$Eh[2]=-$Et)),$EB+=$Er.cw;$EM&&($EM.length=$ES)}},$Ep._drawFast=function($EM,$Ee,$EL,$E_,$Ec){for(var $Eq,$EH,$ET=0,$Ex=$EM.length;$ET<$Ex;$ET++)($Eq=($EH=$EM[$ET])[0]).active(),$Ee._drawText($Eq,$E_+$EH[1],$Ec+$EH[2],$Eq.width,$Eq.height,$EL,0,0,0,0)},$Ep.drawText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG){if(void 0===$EG&&($EG=0),!($Ee&&0===$Ee.length||$EL&&0===$EL.length)){var $EV=$E_.a,$EE=$E_.d;(0!==$E_.b||0!==$E_.c)&&($EV=$EE=1);var $Ed=1!==$EV||1!==$EE;if($Ed&&$EW.stage.transform){var $Er=$EW.stage.transform;$Ed=$Er.a===$EV&&$Er.d===$EE}else $Ed=!1;if($Ed){var $E$=($E_=$E_.copyTo($EyM._tmpMatrix)).tx,$EC=$E_.ty;$E_.scale(1/$EV,1/$EE),$E_._checkTransform(),$EO*=$EV,$Eu*=$EE,$EO+=$E$-$E_.tx,$Eu+=$EC-$E_.ty}else $EV=$EE=1;if($EL)$Ep._drawSlow(null,$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EV,$EE,$EG);else{if(null===$Ee.toUpperCase){var $EK=$EV+1e5*$EE,$EX=$Ee;return void($EX.changed||$EX.id!==$EK?($EX.id=$EK,$EX.changed=!1,$Ep._drawSlow($EX.save,$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EV,$EE,$EG)):$Ep._drawFast($EX.save,$EM,$E_,$EO,$Eu))}var $Eo=$Ee+$Ec.toString()+$EH+$ET+$Ex+$EV+$EE+$Eq,$Ei=$Ep._textsCache[$Eo];$En.CharacterCache?$Ei?$Ep._drawFast($Ei,$EM,$E_,$EO,$Eu):($Ep._textsCache.__length||($Ep._textsCache.__length=0),$Ep._textsCache.__length>$Ey.WebGLTextCacheCount&&(($Ep._textsCache={}).__length=0,$Ep._curPoolIndex=0),$Ep._textCachesPool[$Ep._curPoolIndex]?($Ei=$Ep._textsCache[$Eo]=$Ep._textCachesPool[$Ep._curPoolIndex]).length=0:$Ep._textCachesPool[$Ep._curPoolIndex]=$Ei=$Ep._textsCache[$Eo]=[],$Ep._textsCache.__length++,$Ep._curPoolIndex++,$Ep._drawSlow($Ei,$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EV,$EE,$EG)):$Ep._drawSlow($Ei,$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EV,$EE,$EG)}}},$Ep._charsTemp=null,$Ep._textCachesPool=[],$Ep._curPoolIndex=0,$Ep._charsCache={},$Ep._textsCache={},$Ep._drawValue=null,$Ep.d=[],$Ep._charSeg=null,$Ep.__init$=function(){$EM=function(){function $Ex(){}return $EV($Ex,""),$Ex.prototype.value=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this.font=$EM,this.fillColor=$Ee,this.borderColor=$EL,this.lineWidth=$E_,this.scaleX=$Ec,this.scaleY=$Eq,this.underLine=$EH;var $ET=$EM.toString()+$Ec+$Eq+$E_+($Ee?$Ee.toLowerCase():" ")+($EL?$EL.toLowerCase():" ")+$EH;return this.txtID=$Ex._keymap[$ET],this.txtID||(this.txtID=1e-7*++$Ex._keymapCount,$Ex._keymap[$ET]=this.txtID),this},$Ex.clear=function(){$Ex._keymap={},$Ex._keymapCount=1},$Ex._keymap={},$Ex._keymapCount=1,$Ex}()},$Ep}(),$EdM=function(){function $Ec($EM){this._index=0,this._size=14,this._italic=-2,$Ec._cache2=$Ec._cache2||[],this.setFont($EM||"14px Arial")}$EV($Ec,"laya.webgl.text.FontInContext");var $EM=$Ec.prototype;return $EM.setFont=function($EM){var $Ee=$Ec._cache2[$EM];if($Ee)this._words=$Ee[0],this._size=$Ee[1];else{this._words=$EM.split(" ");for(var $EL=0,$E_=this._words.length;$EL<$E_;$EL++)if(0<this._words[$EL].indexOf("px")){this._index=$EL;break}this._size=parseInt(this._words[this._index]),$Ec._cache2[$EM]=[this._words,this._size]}this._text=null,this._italic=-2},$EM.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$EM.hasType=function($EM){for(var $Ee=0,$EL=this._words.length;$Ee<$EL;$Ee++)if(this._words[$Ee]===$EM)return $Ee;return-1},$EM.removeType=function($EM){for(var $Ee=0,$EL=this._words.length;$Ee<$EL;$Ee++)if(this._words[$Ee]===$EM){this._words.splice($Ee,1),this._index>$Ee&&this._index--;break}this._text=null,this._italic=-2},$EM.copyTo=function($EM){return $EM._text=this._text,$EM._size=this._size,$EM._index=this._index,$EM._words=this._words.slice(),$EM._italic=-2,$EM},$EM.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$E_(0,$EM,"size",function(){return this._size},function($EM){this._size=$EM,this._words[this._index]=$EM+"px",this._text=null}),$Ec.create=function($EM){var $Ee=$Ec._cache[$EM];return $Ee||($Ee=$Ec._cache[$EM]=new $Ec($EM))},$Ec.EMPTY=new $Ec,$Ec._cache={},$Ec._cache2=null,$Ec}(),$ErM=function(){function $EM(){}return $EV($EM,"laya.webgl.utils.CONST3D2D"),$EM.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$EM.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$EM.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$EM._TMPARRAY=[],$EM._OFFSETX=0,$EM._OFFSETY=0,$EH($EM,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$EM}(),$E$M=function(){function $Ed(){}return $EV($Ed,"laya.webgl.utils.GlUtils"),$Ed.make2DProjection=function($EM,$Ee,$EL){return[2/$EM,0,0,0,0,-2/$Ee,0,0,0,0,2/$EL,0,-1,1,0,1]},$Ed.fillIBQuadrangle=function($EM,$Ee){if(65535/4<$Ee)throw Error("IBQuadrangle count:"+$Ee+" must<:"+Math.floor(65535/4));$Ee=Math.floor($Ee),$EM._resizeBuffer(6*($Ee+1)*2,!1),$EM.byteLength=$EM.bufferLength;for(var $EL=$EM.getUint16Array(),$E_=0,$Ec=0;$Ec<$Ee;$Ec++)$EL[$E_++]=4*$Ec,$EL[$E_++]=4*$Ec+2,$EL[$E_++]=4*$Ec+1,$EL[$E_++]=4*$Ec,$EL[$E_++]=4*$Ec+3,$EL[$E_++]=4*$Ec+2;return $EM.setNeedUpload(),!0},$Ed.expandIBQuadrangle=function($EM,$Ee){$EM.bufferLength>=6*$Ee*2||$Ed.fillIBQuadrangle($EM,$Ee)},$Ed.mathCeilPowerOfTwo=function($EM){return $EM--,$EM|=$EM>>1,$EM|=$EM>>2,$EM|=$EM>>4,$EM|=$EM>>8,$EM|=$EM>>16,++$EM},$Ed.fillQuadrangleImgVb=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){var $Ex=16+($EM._byteLength>>2);$EM.byteLength=$Ex<<2;var $EO=$EM.getFloat32Array();$EO[($Ex-=16)+2]=$Ec[0],$EO[$Ex+3]=$Ec[1],$EO[$Ex+6]=$Ec[2],$EO[$Ex+7]=$Ec[3],$EO[$Ex+10]=$Ec[4],$EO[$Ex+11]=$Ec[5],$EO[$Ex+14]=$Ec[6],$EO[$Ex+15]=$Ec[7];var $Eu=$Eq.a,$EG=$Eq.b,$EV=$Eq.c,$EE=$Eq.d;if(1!==$Eu||0!==$EG||0!==$EV||1!==$EE){$Eq.bTransform=!0;var $Ed=$Eq.tx+$EH,$Er=$Eq.ty+$ET;$EO[$Ex]=($E_[0]+$Ee)*$Eu+($E_[1]+$EL)*$EV+$Ed,$EO[$Ex+1]=($E_[0]+$Ee)*$EG+($E_[1]+$EL)*$EE+$Er,$EO[$Ex+4]=($E_[2]+$Ee)*$Eu+($E_[3]+$EL)*$EV+$Ed,$EO[$Ex+5]=($E_[2]+$Ee)*$EG+($E_[3]+$EL)*$EE+$Er,$EO[$Ex+8]=($E_[4]+$Ee)*$Eu+($E_[5]+$EL)*$EV+$Ed,$EO[$Ex+9]=($E_[4]+$Ee)*$EG+($E_[5]+$EL)*$EE+$Er,$EO[$Ex+12]=($E_[6]+$Ee)*$Eu+($E_[7]+$EL)*$EV+$Ed,$EO[$Ex+13]=($E_[6]+$Ee)*$EG+($E_[7]+$EL)*$EE+$Er}else $Eq.bTransform=!1,$Ee+=$Eq.tx+$EH,$EL+=$Eq.ty+$ET,$EO[$Ex]=$Ee+$E_[0],$EO[$Ex+1]=$EL+$E_[1],$EO[$Ex+4]=$Ee+$E_[2],$EO[$Ex+5]=$EL+$E_[3],$EO[$Ex+8]=$Ee+$E_[4],$EO[$Ex+9]=$EL+$E_[5],$EO[$Ex+12]=$Ee+$E_[6],$EO[$Ex+13]=$EL+$E_[7];return $EM._upload=!0},$Ed.fillTranglesVB=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){var $ET=($EM._byteLength>>2)+$E_.length;$EM.byteLength=$ET<<2;var $Ex=$EM.getFloat32Array();$ET-=$E_.length;for(var $EO=$E_.length,$Eu=$Ec.a,$EG=$Ec.b,$EV=$Ec.c,$EE=$Ec.d,$Ed=0;$Ed<$EO;$Ed+=4)if($Ex[$ET+$Ed+2]=$E_[$Ed+2],$Ex[$ET+$Ed+3]=$E_[$Ed+3],1!==$Eu||0!==$EG||0!==$EV||1!==$EE){$Ec.bTransform=!0;var $Er=$Ec.tx+$Eq,$E$=$Ec.ty+$EH;$Ex[$ET+$Ed]=($E_[$Ed]+$Ee)*$Eu+($E_[$Ed+1]+$EL)*$EV+$Er,$Ex[$ET+$Ed+1]=($E_[$Ed]+$Ee)*$EG+($E_[$Ed+1]+$EL)*$EE+$E$}else $Ec.bTransform=!1,$Ee+=$Ec.tx+$Eq,$EL+=$Ec.ty+$EH,$Ex[$ET+$Ed]=$Ee+$E_[$Ed],$Ex[$ET+$Ed+1]=$EL+$E_[$Ed+1];return $EM._upload=!0},$Ed.copyPreImgVb=function($EM,$Ee,$EL){var $E_=$EM._byteLength>>2;$EM.byteLength=$E_+16<<2;for(var $Ec=$EM.getFloat32Array(),$Eq=0,$EH=$E_-16;$Eq<4;$Eq++)$Ec[$E_]=$Ec[$EH]+$Ee,++$EH,$Ec[++$E_]=$Ec[$EH]+$EL,++$EH,$Ec[++$E_]=$Ec[$EH],++$EH,$Ec[++$E_]=$Ec[$EH],++$E_,++$EH;$EM._upload=!0},$Ed.fillRectImgVb=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG,$EV){void 0===$EV&&($EV=!1);var $EE,$Ed,$Er,$E$,$EC,$EK,$EX,$Eo,$Ei,$EW,$Ey,$EA,$EB,$Ek,$Eh,$Et,$ES=1,$Ep=$ET.a,$ER=$ET.b,$Ea=$ET.c,$En=$ET.d,$El=$Ee&&$Ee.width<99999999;if(1!==$Ep||0!==$ER||0!==$Ea||1!==$En?($ET.bTransform=!0,0===$ER&&0===$Ea&&($ES=23,$Ei=$Ec+$EL,$EW=$Eq+$E_,$EE=$Ep*$EL+($Ey=$ET.tx+$Ex),$Er=$Ep*$Ei+$Ey,$Ed=$En*$E_+($EA=$ET.ty+$EO),$E$=$En*$EW+$EA)):($ES=23,$ET.bTransform=!1,$Er=($EE=$EL+$ET.tx+$Ex)+$Ec,$E$=($Ed=$E_+$ET.ty+$EO)+$Eq),$El&&($EC=$Ee.x,$EK=$Ee.y,$EX=$Ee.width+$EC,$Eo=$Ee.height+$EK),1!==$ES){if(Math.min($EE,$Er)>=$EX)return!1;if(Math.min($Ed,$E$)>=$Eo)return!1;if(Math.max($Er,$EE)<=$EC)return!1;if(Math.max($E$,$Ed)<=$EK)return!1}var $Ef=$EM._byteLength>>2;$EM.byteLength=16+$Ef<<2;var $Ej=$EM.getFloat32Array();switch($Ej[2+$Ef]=$EH[0],$Ej[3+$Ef]=$EH[1],$Ej[6+$Ef]=$EH[2],$Ej[7+$Ef]=$EH[3],$Ej[10+$Ef]=$EH[4],$Ej[11+$Ef]=$EH[5],$Ej[14+$Ef]=$EH[6],$Ej[15+$Ef]=$EH[7],$ES){case 1:$Ey=$ET.tx+$Ex,$EA=$ET.ty+$EO;var $EF=$Ep*$EL,$Eg=$Ea*$E_,$EJ=$En*$E_,$Ew=$ER*$EL,$Eb=$Ep*($Ei=$Ec+$EL),$Em=$Ea*($EW=$Eq+$E_),$Ez=$En*$EW,$EQ=$ER*$Ei;$EV?($EB=$EF+$Eg+$Ey,$Eh=Math.round($EB)-$EB,$Ek=$EJ+$Ew+$EA,$Et=Math.round($Ek)-$Ek,$Ej[$Ef]=$EB+$Eh,$Ej[1+$Ef]=$Ek+$Et,$Ej[4+$Ef]=$Eb+$Eg+$Ey+$Eh,$Ej[5+$Ef]=$EJ+$EQ+$EA+$Et,$Ej[8+$Ef]=$Eb+$Em+$Ey+$Eh,$Ej[9+$Ef]=$Ez+$EQ+$EA+$Et,$Ej[12+$Ef]=$EF+$Em+$Ey+$Eh,$Ej[13+$Ef]=$Ez+$Ew+$EA+$Et):($Ej[$Ef]=$EF+$Eg+$Ey,$Ej[1+$Ef]=$EJ+$Ew+$EA,$Ej[4+$Ef]=$Eb+$Eg+$Ey,$Ej[5+$Ef]=$EJ+$EQ+$EA,$Ej[8+$Ef]=$Eb+$Em+$Ey,$Ej[9+$Ef]=$Ez+$EQ+$EA,$Ej[12+$Ef]=$EF+$Em+$Ey,$Ej[13+$Ef]=$Ez+$Ew+$EA);break;case 23:$EV?($EB=$EE+$Eu,$Eh=Math.round($EB)-$EB,$Ek=$Ed,$Et=Math.round($Ek)-$Ek,$Ej[$Ef]=$EB+$Eh,$Ej[1+$Ef]=$Ek+$Et,$Ej[4+$Ef]=$Er+$Eu+$Eh,$Ej[5+$Ef]=$Ed+$Et,$Ej[8+$Ef]=$Er+$Eh,$Ej[9+$Ef]=$E$+$Et,$Ej[12+$Ef]=$EE+$Eh,$Ej[13+$Ef]=$E$+$Et):($Ej[$Ef]=$EE+$Eu,$Ej[1+$Ef]=$Ed,$Ej[4+$Ef]=$Er+$Eu,$Ej[5+$Ef]=$Ed,$Ej[8+$Ef]=$Er,$Ej[9+$Ef]=$E$,$Ej[12+$Ef]=$EE,$Ej[13+$Ef]=$E$)}return $EM._upload=!0},$Ed.fillLineVb=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){var $Ex=.5*$EH,$EO=$Ed._fillLineArray,$Eu=-($E_-$Eq),$EG=$EL-$Ec,$EV=Math.sqrt($Eu*$Eu+$EG*$EG);$Eu/=$EV,$EG/=$EV,$Eu*=$Ex,$EG*=$Ex,$EO[0]=$EL-$Eu,$EO[1]=$E_-$EG,$EO[4]=$EL+$Eu,$EO[5]=$E_+$EG,$EO[8]=$Ec+$Eu,$EO[9]=$Eq+$EG,$EO[12]=$Ec-$Eu,$EO[13]=$Eq-$EG,$ET&&$ET.transformPointArray($EO,$EO);var $EE=16+($EM._byteLength>>2);return $EM.byteLength=$EE<<2,$EM.insertData($EO,$EE-16),!0},$Ed._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$Ed}(),$ECM=(function(){function $Ex(){}$EV($Ex,"laya.webgl.utils.MatirxArray"),$Ex.ArrayMul=function($EM,$Ee,$EL){if($EM)if($Ee)for(var $E_=NaN,$Ec=NaN,$Eq=NaN,$EH=NaN,$ET=0;$ET<4;$ET++)$E_=$EM[$ET],$Ec=$EM[$ET+4],$Eq=$EM[$ET+8],$EH=$EM[$ET+12],$EL[$ET]=$E_*$Ee[0]+$Ec*$Ee[1]+$Eq*$Ee[2]+$EH*$Ee[3],$EL[$ET+4]=$E_*$Ee[4]+$Ec*$Ee[5]+$Eq*$Ee[6]+$EH*$Ee[7],$EL[$ET+8]=$E_*$Ee[8]+$Ec*$Ee[9]+$Eq*$Ee[10]+$EH*$Ee[11],$EL[$ET+12]=$E_*$Ee[12]+$Ec*$Ee[13]+$Eq*$Ee[14]+$EH*$Ee[15];else $Ex.copyArray($EM,$EL);else $Ex.copyArray($Ee,$EL)},$Ex.copyArray=function($EM,$Ee){if($EM&&$Ee)for(var $EL=0;$EL<$EM.length;$EL++)$Ee[$EL]=$EM[$EL]}}(),function(){function $Ee($EM,$Ee,$EL){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$EM,this._vb=new $EIM($EM,35048),$Ee&&this._vb._resizeBuffer($Ee,!1),this._ib=new $EUM,$EL&&this._ib._resizeBuffer($EL,!1)}$EV($Ee,"laya.webgl.utils.Mesh2D");var $EM=$Ee.prototype;return $EM.cloneWithNewVB=function(){var $EM=new $Ee(this._stride,0,0);return $EM._ib=this._ib,$EM._quadNum=this._quadNum,$EM._attribInfo=this._attribInfo,$EM},$EM.cloneWithNewVBIB=function(){var $EM=new $Ee(this._stride,0,0);return $EM._attribInfo=this._attribInfo,$EM},$EM.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$EM.getVBR=function(){return this._vb},$EM.getIBR=function(){return this._ib},$EM.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$EM.createQuadIB=function($EM){this._quadNum=$EM,this._ib._resizeBuffer(6*$EM*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $Ee=this._ib.getUint16Array(),$EL=0,$E_=0,$Ec=0;$Ec<$EM;$Ec++)$Ee[$EL++]=$E_,$Ee[$EL++]=$E_+2,$Ee[$EL++]=$E_+1,$Ee[$EL++]=$E_,$Ee[$EL++]=$E_+3,$Ee[$EL++]=$E_+2,$E_+=4;this._ib.setNeedUpload()},$EM.setAttributes=function($EM){if(this._attribInfo=$EM,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$EM.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$EM.releaseMesh=function(){},$EM.destroy=function(){},$EM.clearVB=function(){this._vb.clear()},$Ee._gvaoid=0,$Ee}()),$EKM=function(){function $Ec(){}return $EV($Ec,"laya.webgl.utils.RenderState2D"),$Ec.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$Ec.mat2MatArray=function($EM,$Ee){var $EL=$EM,$E_=$Ee;return $E_[0]=$EL.a,$E_[1]=$EL.b,$E_[2]=$Ec.EMPTYMAT4_ARRAY[2],$E_[3]=$Ec.EMPTYMAT4_ARRAY[3],$E_[4]=$EL.c,$E_[5]=$EL.d,$E_[6]=$Ec.EMPTYMAT4_ARRAY[6],$E_[7]=$Ec.EMPTYMAT4_ARRAY[7],$E_[8]=$Ec.EMPTYMAT4_ARRAY[8],$E_[9]=$Ec.EMPTYMAT4_ARRAY[9],$E_[10]=$Ec.EMPTYMAT4_ARRAY[10],$E_[11]=$Ec.EMPTYMAT4_ARRAY[11],$E_[12]=$EL.tx,$E_[13]=$EL.ty,$E_[14]=$Ec.EMPTYMAT4_ARRAY[14],$E_[15]=$Ec.EMPTYMAT4_ARRAY[15],$Ee},$Ec.restoreTempArray=function(){$Ec.TEMPMAT4_ARRAY[0]=1,$Ec.TEMPMAT4_ARRAY[1]=0,$Ec.TEMPMAT4_ARRAY[4]=0,$Ec.TEMPMAT4_ARRAY[5]=1,$Ec.TEMPMAT4_ARRAY[12]=0,$Ec.TEMPMAT4_ARRAY[13]=0},$Ec.clear=function(){$Ec.worldScissorTest=!1,$Ec.worldShaderDefines=null,$Ec.worldFilters=null,$Ec.worldAlpha=1,$Ec.worldClipRect.x=$Ec.worldClipRect.y=0,$Ec.worldClipRect.width=$Ec.width,$Ec.worldClipRect.height=$Ec.height,$Ec.curRenderTarget=null},$Ec._MAXSIZE=99999999,$Ec.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Ec.worldMatrix4=$Ec.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Ec.worldAlpha=1,$Ec.worldScissorTest=!1,$Ec.worldFilters=null,$Ec.worldShaderDefines=null,$Ec.curRenderTarget=null,$Ec.width=0,$Ec.height=0,$EH($Ec,["worldMatrix",function(){return this.worldMatrix=new $EB},"worldClipRect",function(){return this.worldClipRect=new $Eh(0,0,99999999,99999999)}]),$Ec}(),$EXM=function(){var $EK,$EL;function $EX($EM,$Ee,$EL,$E_,$Ec){var $Eq=this;function $EH($EM){var $Ee=[],$EL=new $EK($Ee);return $Eq._compileToTree($EL,$EM.split("\n"),0,$Ee,$Ec),$EL}var $ET=$EE.now();this._VS=$EH($Ee),this._PS=$EH($EL),this._nameMap=$E_,2<$EE.now()-$ET&&console.log("ShaderCompile use time:"+($EE.now()-$ET)+"  size:"+$Ee.length+"/"+$EL.length)}$EV($EX,"laya.webgl.utils.ShaderCompile");var $EM=$EX.prototype;return $EM._compileToTree=function($EM,$Ee,$EL,$E_,$Ec){var $Eq,$EH,$ET,$Ex,$EO,$Eu,$EG,$EV=0,$EE=0,$Ed=0,$Er=0;for($EE=$EL;$EE<$Ee.length;$EE++)if(!(($ET=$Ee[$EE]).length<1)&&0!==($EV=$ET.indexOf("//"))){if(0<=$EV&&($ET=$ET.substr(0,$EV)),$Eq=$EG||new $EK($E_),$EG=null,$Eq.text=$ET,$Eq.noCompile=!0,0<=($EV=$ET.indexOf("#"))){for($Ex="#",$Er=$EV+1,$Ed=$ET.length;$Er<$Ed;$Er++){var $E$=$ET.charAt($Er);if(" "===$E$||"\t"===$E$||"\r"===$E$||"\n"===$E$||"?"===$E$)break;$Ex+=$E$}switch($Eq.name=$Ex){case"#ifdef":case"#ifndef":if($Eq.src=$ET,$Eq.noCompile=null!=$ET.match(/[!&|()=<>]/),$Eq.noCompile?console.log("function():Boolean{return "+$ET.substr($EV+$Eq.name.length)+"}"):($Eu=$ET.replace(/^\s*/,"").split(/\s+/),$Eq.setCondition($Eu[1],"#ifdef"===$Ex?1:2),$Eq.text="//"+$Eq.text),$Eq.setParent($EM),$EM=$Eq,$Ec)for($Eu=$ET.substr($Er).split($EX._splitToWordExps3),$Er=0;$Er<$Eu.length;$Er++)($ET=$Eu[$Er]).length&&($Ec[$ET]=!0);continue;case"#if":if($Eq.src=$ET,$Eq.noCompile=!0,$Eq.setParent($EM),$EM=$Eq,$Ec)for($Eu=$ET.substr($Er).split($EX._splitToWordExps3),$Er=0;$Er<$Eu.length;$Er++)($ET=$Eu[$Er]).length&&"defined"!=$ET&&($Ec[$ET]=!0);continue;case"#else":$Eq.src=$ET,$EH=($EM=$EM.parent).childs[$EM.childs.length-1],$Eq.noCompile=$EH.noCompile,$Eq.noCompile||($Eq.condition=$EH.condition,$Eq.conditionType=1==$EH.conditionType?2:1,$Eq.text="//"+$Eq.text+" "+$EH.text+" "+$Eq.conditionType),$Eq.setParent($EM),$EM=$Eq;continue;case"#endif":$EH=($EM=$EM.parent).childs[$EM.childs.length-1],$Eq.noCompile=$EH.noCompile,$Eq.noCompile||($Eq.text="//"+$Eq.text),$Eq.setParent($EM);continue;case"#include":$Eu=$EX.splitToWords($ET,null);var $EC=$EX.includes[$Eu[1]];if(!$EC)throw"ShaderCompile error no this include file:"+$Eu[1];if(($EV=$Eu[0].indexOf("?"))<0){$Eq.setParent($EM),$ET=$EC.getWith("with"==$Eu[2]?$Eu[3]:null),this._compileToTree($Eq,$ET.split("\n"),0,$E_,$Ec),$Eq.text="";continue}$Eq.setCondition($Eu[0].substr($EV+1),1),$Eq.text=$EC.getWith("with"==$Eu[2]?$Eu[3]:null);break;case"#import":$EO=($Eu=$EX.splitToWords($ET,null))[1],$E_.push({node:$Eq,file:$EX.includes[$EO],ofs:$Eq.text.length});continue}}else{if(($EH=$EM.childs[$EM.childs.length-1])&&!$EH.name){0<$E_.length&&$EX.splitToWords($ET,$EH),$EG=$Eq,$EH.text+="\n"+$ET;continue}0<$E_.length&&$EX.splitToWords($ET,$Eq)}$Eq.setParent($EM)}},$EM.createShader=function($EM,$Ee,$EL){var $E_={},$Ec="";if($EM)for(var $Eq in $EM)$Ec+="#define "+$Eq+"\n",$E_[$Eq]=!0;var $EH=this._VS.toscript($E_,[]),$ET=this._PS.toscript($E_,[]);return($EL||$EvM.create)($Ec+$EH.join("\n"),$Ec+$ET.join("\n"),$Ee,this._nameMap)},$EX._parseOne=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH={type:$EX.shaderParamsMap[$EL[$E_+1]],name:$EL[$E_+2],size:isNaN(parseInt($EL[$E_+3]))?1:parseInt($EL[$E_+3])};return $Eq&&("attribute"==$Ec?$EM.push($EH):$Ee.push($EH)),":"==$EL[$E_+3]&&($EH.type=$EL[$E_+4],$E_+=2),$E_+=2},$EX.addInclude=function($EM,$Ee){if(!$Ee||0===$Ee.length)throw new Error("add shader include file err:"+$EM);if($EX.includes[$EM])throw new Error("add shader include file err, has add:"+$EM);$EX.includes[$EM]=new $EL($Ee)},$EX.preGetParams=function($EM,$Ee){var $EL=[$EM,$Ee],$E_={},$Ec=[],$Eq=[],$EH={},$ET=[];$E_.attributes=$Ec,$E_.uniforms=$Eq,$E_.defines=$EH;for(var $Ex=0,$EO=0,$Eu=0;$Eu<2;$Eu++){$EL[$Eu]=$EL[$Eu].replace($EX._removeAnnotation,"");var $EG,$EV=$EL[$Eu].match($EX._reg);for($Ex=0,$EO=$EV.length;$Ex<$EO;$Ex++){var $EE=$EV[$Ex];if("attribute"==$EE||"uniform"==$EE)$Ex=$EX._parseOne($Ec,$Eq,$EV,$Ex,$EE,!0);else{if("#define"==$EE){$ET[$EE=$EV[++$Ex]]=1;continue}if("#ifdef"==$EE){$EH[$EG=$EV[++$Ex]]=$EH[$EG]||[];for($Ex++;$Ex<$EO;$Ex++)if("attribute"==($EE=$EV[$Ex])||"uniform"==$EE)$Ex=$EX._parseOne($Ec,$Eq,$EV,$Ex,$EE,$ET[$EG]);else if("#else"==$EE)for($Ex++;$Ex<$EO;$Ex++)if("attribute"==($EE=$EV[$Ex])||"uniform"==$EE)$Ex=$EX._parseOne($Ec,$Eq,$EV,$Ex,$EE,!$ET[$EG]);else if("#endif"==$EE)break}}}}return $E_},$EX.splitToWords=function($EM,$Ee){for(var $EL,$E_,$Ec=[],$Eq=-1,$EH=0,$ET=$EM.length;$EH<$ET;$EH++)if($EL=$EM.charAt($EH),0<=" \t=+-*/&%!<>()'\",;".indexOf($EL)){if(0<=$Eq&&1<$EH-$Eq&&($E_=$EM.substr($Eq,$EH-$Eq),$Ec.push($E_)),'"'==$EL||"'"==$EL){var $Ex=$EM.indexOf($EL,$EH+1);if($Ex<0)throw"Sharder err:"+$EM;$Ec.push($EM.substr($EH+1,$Ex-$EH-1)),$EH=$Ex,$Eq=-1;continue}"("==$EL&&$Ee&&0<$Ec.length&&($E_=$Ec[$Ec.length-1]+";","vec4;main;".indexOf($E_)<0&&($Ee.useFuns+=$E_)),$Eq=-1}else $Eq<0&&($Eq=$EH);return $Eq<$ET&&1<$ET-$Eq&&($E_=$EM.substr($Eq,$ET-$Eq),$Ec.push($E_)),$Ec},$EX.IFDEF_NO=0,$EX.IFDEF_YES=1,$EX.IFDEF_ELSE=2,$EX.IFDEF_PARENT=3,$EX._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$EX._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$EX._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$EX.includes={},$EH($EX,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$EX.__init$=function(){$EK=function(){function $EL($EM){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$EM}$EV($EL,"");var $EM=$EL.prototype;return $EM.setParent=function($EM){$EM.childs.push(this),this.z=$EM.z+1,this.parent=$EM},$EM.setCondition=function($EM,$Ee){$EM&&(this.conditionType=$Ee,$EM=$EM.replace(/(\s*$)/g,""),this.condition=function(){return this[$EM]},this.condition.__condition=$EM)},$EM.toscript=function($EM,$Ee){return this._toscript($EM,$Ee,++$EL.__id)},$EM._toscript=function($E_,$Ec,$Eq){if(this.childs.length<1&&!this.text)return $Ec;$Ec.length;if(this.condition){var $EM=!!this.condition.call($E_);if(2===this.conditionType&&($EM=!$EM),!$EM)return $Ec}if(this.text&&$Ec.push(this.text),0<this.childs.length&&this.childs.forEach(function($EM,$Ee,$EL){$EM._toscript($E_,$Ec,$Eq)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $Ee,$EL=0,$EH=this.includefiles.length;$EL<$EH;$EL++)this.includefiles[$EL].curUseID!=$Eq&&0<($Ee=this.includefiles[$EL].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$EL].curUseID=$Eq,$Ec[0]=$Ee+$Ec[0]);return $Ec},$EL.__id=1,$EL}(),$EL=function(){function $EM($EM){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$EM;for(var $Ee=0,$EL=0,$E_=0;!(($Ee=$EM.indexOf("#begin",$Ee))<0);){for($E_=$Ee+5;!(($E_=$EM.indexOf("#end",$E_))<0)&&"i"===$EM.charAt($E_+4);)$E_+=5;if($E_<0)throw"add include err,no #end:"+$EM;$EL=$EM.indexOf("\n",$Ee);var $Ec=$EX.splitToWords($EM.substr($Ee,$EL-$Ee),null);"code"==$Ec[1]?this.codes[$Ec[2]]=$EM.substr($EL+1,$E_-$EL-1):"function"==$Ec[1]&&($EL=$EM.indexOf("function",$Ee),$EL+="function".length,this.funs[$Ec[3]]=$EM.substr($EL+1,$E_-$EL-1),this.funnames+=$Ec[3]+";"),$Ee=$E_+1}}$EV($EM,"");var $Ee=$EM.prototype;return $Ee.getWith=function($EM){var $Ee=$EM?this.codes[$EM]:this.script;if(!$Ee)throw"get with error:"+$EM;return $Ee},$Ee.getFunsScript=function($EM){var $Ee="";for(var $EL in this.funs)0<=$EM.indexOf($EL+";")&&($Ee+=this.funs[$EL]);return $Ee},$EM}()},$EX}(),$EoM=function(){function $EH(){}return $EV($EH,"laya.webgl.WebGL"),$EH._uint8ArraySlice=function(){for(var $EM=this.length,$Ee=new Uint8Array(this.length),$EL=0;$EL<$EM;$EL++)$Ee[$EL]=this[$EL];return $Ee},$EH._float32ArraySlice=function(){for(var $EM=this.length,$Ee=new Float32Array(this.length),$EL=0;$EL<$EM;$EL++)$Ee[$EL]=this[$EL];return $Ee},$EH._uint16ArraySlice=function($EM){var $Ee,$EL=arguments,$E_=0,$Ec=0;if(0===$EL.length)for($E_=this.length,$Ee=new Uint16Array($E_),$Ec=0;$Ec<$E_;$Ec++)$Ee[$Ec]=this[$Ec];else if(2===$EL.length){var $Eq=$EL[0],$EH=$EL[1];if($Eq<$EH)for($E_=$EH-$Eq,$Ee=new Uint16Array($E_),$Ec=$Eq;$Ec<$EH;$Ec++)$Ee[$Ec-$Eq]=this[$Ec];else $Ee=new Uint16Array(0)}return $Ee},$EH.expandContext=function(){var $EM=$Ec.prototype,$Ee=CanvasRenderingContext2D.prototype;$Ee.fillTrangles=$EM.fillTrangles,$ENM.__int__(null),$Ee.setIBVB=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){void 0===$Ex&&($Ex=0),void 0===$EO&&($EO=0),null===$EL&&(this._ib=this._ib||$EUM.QuadrangleIB,$EL=this._ib,$E$M.expandIBQuadrangle($EL,$E_._byteLength/64+8)),this._setIBVB($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO)},$Ee.fillTrangles=function($EM,$Ee,$EL,$E_,$Ec){this._curMat=this._curMat||$EB.create(),this._vb=this._vb||$EIM.create(),this._ib||(this._ib=$EUM.create(),$E$M.fillIBQuadrangle(this._ib,$EH/4));var $Eq=this._vb,$EH=$E_.length>>4;$E$M.fillTranglesVB($Eq,$Ee,$EL,$E_,$Ec||this._curMat,0,0),$E$M.expandIBQuadrangle(this._ib,$Eq._byteLength/64+8);var $ET=new $EAM(1,0);$ET.textureHost=$EM;var $Ex=new $EDM("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$Eq._vertType=3,this._setIBVB($Ee,$EL,this._ib,$Eq,6*$EH,$Ec,$Ex,$ET,0,0)}},$EH.enable=function(){if($EE.__init__(),$EC.isConchApp&&!$EC.isConchWebGL)return $Ei.skinAniSprite=function(){return new $EMM},$EH.expandContext(),!1;if($Ei.getWebGLContext=function($EM){for(var $Ee,$EL=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$E_=0;$E_<$EL.length;$E_++){try{$Ee=$EM.getContext($EL[$E_],{stencil:$Ey.isStencil,alpha:$Ey.isAlpha,antialias:$Ey.isAntialias,premultipliedAlpha:$Ey.premultipliedAlpha,preserveDrawingBuffer:$Ey.preserveDrawingBuffer})}catch($EM){}if($Ee)return $Ee}return null},null==($EH.mainContext=$EH.mainContext||$Ei.getWebGLContext($EC._mainCanvas)))return!1;if($EC.isWebGL)return!0;$Er.create=function($EM,$Ee){return new $EMe($EM,$Ee)},$E$.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){return new $EZM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH)},$EC.WebGL=$EH,$EC.isWebGL=!0,$EEM.__init__(),$Ei.createRenderSprite=function($EM,$Ee){return new $EBM($EM,$Ee)},$Ei.createWebGLContext2D=function($EM){return new $EyM($EM)},$Ei.changeWebGLSize=function($EM,$Ee){laya.webgl.WebGL.onStageResize($EM,$Ee)},$Ei.createGraphics=function(){return new $EWM};var $EM=$Ei.createFilterAction;return $Ei.createFilterAction=$EM||function($EM){return new $EkM},$Ei.clear=function($EM){$EKM.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $Ee=$EC.context.ctx,$EL=0==$Ee._submits._length||$Ey.preserveDrawingBuffer?$Ed.create($EM)._color:$ES._wgColor;$EL&&$Ee.clearBG($EL[0],$EL[1],$EL[2],$EL[3]),$EKM.clear()},$Ei.addToAtlas=function($EM,$Ee){void 0===$Ee&&($Ee=!1);var $EL=$EM.bitmap;$EC.optimizeTextureMemory($EM.url,$EM)?$EW.__typeof($EL,"laya.webgl.resource.IMergeAtlasBitmap")&&$EL.allowMerageInAtlas&&$EL.on("recovered",$EM,$EM.addTextureToAtlas):$EL.enableMerageInAtlas=!1},$Ei.isAtlas=function($EM){return $EM instanceof laya.webgl.atlas.AtlasWebGLCanvas},$Ew._enable(),$Ei.beginFlush=function(){for(var $EM=$Ew.instance,$Ee=$EM.getAtlaserCount(),$EL=0;$EL<$Ee;$EL++){var $E_=$EM.getAtlaserByIndex($EL).texture;$E_._flashCacheImageNeedFlush&&$Ei.flashFlushImage($E_)}},$Ei.drawToCanvas=function($EM,$Ee,$EL,$E_,$Ec,$Eq){($EL<=0||$E_<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$EL|=0,$E_|=0,$Ec|=0,$Eq|=0;var $EH=$EjM.create($EL,$E_,6408,5121,0,!1);$EH.start(),$EH.clear(0,0,0,0),$EC.context.clear(),$EK.renders[$Ee]._fun($EM,$EC.context,$Ec,$EKM.height-$E_+$Eq),$EC.context.flush(),$EH.end();var $ET=$EH.getData(0,0,$EL,$E_);if($EH.recycle(),$ET.byteLength==$EL*$E_*4){var $Ex=new $EQM;$Ex._canvas=$EE.createElement("canvas"),$Ex.size($EL,$E_);var $EO=$Ex._canvas.getContext("2d");$EE.canvas.size($EL,$E_);var $Eu=$EE.context,$EG=$Eu.createImageData($EL,$E_);return $EG.data.set(new Uint8ClampedArray($ET.buffer)),$Ex._imgData=$EG,$Eu.putImageData($EG,0,0),$EO.save(),$EO.translate(0,$E_),$EO.scale(1,-1),$EO.drawImage($EE.canvas.source,0,0),$EO.restore(),$Ex}console.log("drawToCanvas error: w:"+$EL+",h:"+$E_+",datalen:"+$ET.byteLength)},$Ei.createFilterAction=function($EM){var $Ee;switch($EM){case 32:$Ee=new $EkM}return $Ee},$Ei.addTextureToAtlas=function($EM){$EM._uvID++,$Ew._atlasRestore++,$EM.bitmap.enableMerageInAtlas&&$Ew.instance.addToAtlas($EM)},$Ei.getTexturePixels=function($EM,$Ee,$EL,$E_,$Ec){$EC.context.ctx.clear();var $Eq=new $Et;$Eq.graphics.drawTexture($EM,-$Ee,-$EL);var $EH=$EjM.create($E_,$Ec);$EH.start(),$EH.clear(0,0,0,0),$Eq.render($EC.context,0,0),$EC.context.ctx.flush(),$EH.end();for(var $ET=$EH.getData(0,0,$E_,$Ec),$Ex=[],$EO=0,$Eu=$Ec-1;0<=$Eu;$Eu--)for(var $EG=0;$EG<$E_;$EG++)$EO=4*($Eu*$E_+$EG),$Ex.push($ET[$EO]),$Ex.push($ET[$EO+1]),$Ex.push($ET[$EO+2]),$Ex.push($ET[$EO+3]);return $Ex},$Ei.skinAniSprite=function(){return new $EMM},$EO.create=function($EM,$Ee){var $EL=new $EQM;return $EL._imgData=$Ee,$EL.flipY=!1,$EL},$EA._filterStart=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EM.getValue("bounds"),$EH=$EjM.create($Eq.width,$Eq.height);if($EH.start(),$EH.clear(0,0,0,0),$EM.addValue("src",$EH),$EM.addValue("ScissorTest",$EKM.worldScissorTest),$EKM.worldScissorTest){var $ET=new $Eh;$ET.copyFrom($EL.ctx._clipRect),$EM.addValue("clipRect",$ET),$EKM.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$EA._filterEnd=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EM.getValue("bounds");$EM.getValue("src").end();var $EH=$EjM.create($Eq.width,$Eq.height);$EH.start(),$EH.clear(0,0,0,0),$EM.addValue("out",$EH),$Ee._set$P("_filterCache",$EH),$Ee._set$P("_isHaveGlowFilter",$EM.getValue("_isHaveGlowFilter"))},$EA._EndTarget=function($EM,$Ee){if($EM.getValue("src").recycle(),$EM.getValue("out").end(),$EM.getValue("ScissorTest")){$EKM.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$Ee.ctx.save();var $EL=$EM.getValue("clipRect");$Ee.ctx.clipRect($EL.x,$EL.y,$EL.width,$EL.height)}},$EA._useSrc=function($EM){var $Ee=$EM.getValue("out");$Ee.end(),($Ee=$EM.getValue("src")).start(),$Ee.clear(0,0,0,0)},$EA._endSrc=function($EM){$EM.getValue("src").end()},$EA._useOut=function($EM){var $Ee=$EM.getValue("src");$Ee.end(),($Ee=$EM.getValue("out")).start(),$Ee.clear(0,0,0,0)},$EA._endOut=function($EM){$EM.getValue("out").end()},$EA._recycleScope=function($EM){$EM.recycle()},$EA._filter=function($EM,$Ee,$EL,$E_){var $Ec=this._next;if($Ec){var $Eq,$EH,$ET=$EM.filters,$Ex=$ET.length;if(1==$Ex&&32==$ET[0].type)return $Ee.ctx.save(),$Ee.ctx.setFilters([$ET[0]]),$Ec._fun.call($Ec,$EM,$Ee,$EL,$E_),void $Ee.ctx.restore();var $EO=$ETM.create(),$Eu=$Ek.TEMP,$EG=$Ee.ctx._getTransformMatrix(),$EV=$EB.create();$EG.copyTo($EV);var $EE=0,$Ed=0,$Er=!1,$E$=$EM._$P._filterCache?$EM._$P._filterCache:null;if(!$E$||$EM._repaint){$Er=$EM._isHaveGlowFilter(),$EO.addValue("_isHaveGlowFilter",$Er),$Er&&($EE=50,$Ed=25),($EH=new $Eh).copyFrom($EM.getSelfBounds()),$EH.x+=$EM.x,$EH.y+=$EM.y,$EH.x-=$EM.pivotX+4,$EH.y-=$EM.pivotY+4;var $EC=$EH.x,$EK=$EH.y;if($EH.width+=$EE+8,$EH.height+=$EE+8,$Eu.x=$EH.x*$EV.a+$EH.y*$EV.c,$Eu.y=$EH.y*$EV.d+$EH.x*$EV.b,$EH.x=$Eu.x,$EH.y=$Eu.y,$Eu.x=$EH.width*$EV.a+$EH.height*$EV.c,$Eu.y=$EH.height*$EV.d+$EH.width*$EV.b,$EH.width=$Eu.x,$EH.height=$Eu.y,$EH.width<=0||$EH.height<=0)return;$E$&&$E$.recycle(),$EO.addValue("bounds",$EH);var $EX=$EHM.create([$EO,$EM,$Ee,0,0],$EA._filterStart);$Ee.addRenderObject($EX),$Ee.ctx._renderKey=0,$Ee.ctx._shader2D.glTexture=null;var $Eo=$EM.x-$EC+$Ed,$Ei=$EM.y-$EK+$Ed;$Ec._fun.call($Ec,$EM,$Ee,$Eo,$Ei),$EX=$EHM.create([$EO,$EM,$Ee,0,0],$EA._filterEnd),$Ee.addRenderObject($EX);for(var $EW=0;$EW<$Ex;$EW++){0!=$EW&&($EX=$EHM.create([$EO],$EA._useSrc),$Ee.addRenderObject($EX),$Eq=$EAM.create(1,0),$EB.TEMP.identity(),$Ee.ctx.drawTarget($EO,0,0,$EH.width,$EH.height,$EB.TEMP,"out",$Eq,null,$Em.TOINT.overlay),$EX=$EHM.create([$EO],$EA._useOut),$Ee.addRenderObject($EX)),$ET[$EW].action.apply3d($EO,$EM,$Ee,0,0)}$EX=$EHM.create([$EO,$Ee],$EA._EndTarget),$Ee.addRenderObject($EX)}else{if(($Er=!!$EM._$P._isHaveGlowFilter&&$EM._$P._isHaveGlowFilter)&&($EE=50,$Ed=25),($EH=$EM.getBounds()).width<=0||$EH.height<=0)return;$EH.width+=$EE,$EH.height+=$EE,$Eu.x=$EH.x*$EV.a+$EH.y*$EV.c,$Eu.y=$EH.y*$EV.d+$EH.x*$EV.b,$EH.x=$Eu.x,$EH.y=$Eu.y,$Eu.x=$EH.width*$EV.a+$EH.height*$EV.c,$Eu.y=$EH.height*$EV.d+$EH.width*$EV.b,$EH.width=$Eu.x,$EH.height=$Eu.y,$EO.addValue("out",$E$)}$EL=$EL-$Ed-$EM.x,$E_=$E_-$Ed-$EM.y,$Eu.setTo($EL,$E_),$EV.transformPoint($Eu),$EL=$Eu.x+$EH.x,$E_=$Eu.y+$EH.y,$Eq=$EAM.create(1,0),$EB.TEMP.identity(),$Ee.ctx.drawTarget($EO,$EL,$E_,$EH.width,$EH.height,$EB.TEMP,"out",$Eq,null,$Em.TOINT.overlay),$EX=$EHM.create([$EO],$EA._recycleScope),$Ee.addRenderObject($EX),$EV.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$EH._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$EH._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$EH._uint8ArraySlice),!0},$EH.onStageResize=function($EM,$Ee){null!=$EH.mainContext&&($EH.mainContext.viewport(0,0,$EM,$Ee),$EKM.width=$EM,$EKM.height=$Ee)},$EH.onInvalidGLRes=function(){$Ew.instance.freeAll(),$Eo.releaseContentManagers(!0),$EH.doNodeRepaint($EW.stage),$EH.mainContext.viewport(0,0,$EKM.width,$EKM.height),$EW.stage.event("devicelost")},$EH.doNodeRepaint=function($EM){0==$EM.numChildren&&$EM.repaint();for(var $Ee=0;$Ee<$EM.numChildren;$Ee++)$EH.doNodeRepaint($EM.getChildAt($Ee))},$EH.init=function($EM,$Ee,$EL){$EH.mainCanvas=$EM,$EO._createContext=function($EM){return new $EyM($EM)},$EQM._createContext=function($EM){return new $EyM($EM)};var $E_=laya.webgl.WebGL.mainContext;if(null!=$E_.getShaderPrecisionFormat){var $Ec=$E_.getShaderPrecisionFormat(35633,36338),$Eq=$E_.getShaderPrecisionFormat(35632,36338);$EH.shaderHighPrecision=!(!$Ec.precision||!$Eq.precision)}else $EH.shaderHighPrecision=!1;if($EH.compressAstc=$E_.getExtension("WEBGL_compressed_texture_astc"),$EH.compressAtc=$E_.getExtension("WEBGL_compressed_texture_atc"),$EH.compressEtc=$E_.getExtension("WEBGL_compressed_texture_etc"),$EH.compressEtc1=$E_.getExtension("WEBGL_compressed_texture_etc1"),$EH.compressPvrtc=$E_.getExtension("WEBGL_compressed_texture_pvrtc"),$EH.compressS3tc=$E_.getExtension("WEBGL_compressed_texture_s3tc"),$EH.compressS3tc_srgb=$E_.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$EH.compressAstc=$EH.compressAstc?$EH.compressAstc:{},$EH.compressAtc=$EH.compressAtc?$EH.compressAtc:{},$EH.compressEtc=$EH.compressEtc?$EH.compressEtc:{},$EH.compressEtc1=$EH.compressEtc1?$EH.compressEtc1:{},$EH.compressPvrtc=$EH.compressPvrtc?$EH.compressPvrtc:{},$EH.compressS3tc=$EH.compressS3tc?$EH.compressS3tc:{},$EH.compressS3tc_srgb=$EH.compressS3tc_srgb?$EH.compressS3tc_srgb:{},$E_.deleteTexture1=$E_.deleteTexture,$E_.deleteTexture=function($EM){$EM==$EiM.curBindTexValue&&($EiM.curBindTexValue=null),$E_.deleteTexture1($EM)},$EH.onStageResize($Ee,$EL),null==$EH.mainContext)throw new Error("webGL getContext err!");$Ea.__init__(),$Ew.__init__(),$EtM.__init__(),$EqM.__init__(),$EyM.__init__(),$EAM.__init__(),$EU.__init__(),$ENM.__int__($E_),$Em._init_($E_),$EC.isConchApp&&conch.setOnInvalidGLRes($EH.onInvalidGLRes)},$EH.mainCanvas=null,$EH.antialias=!0,$EH.shaderHighPrecision=!1,$EH._bg_null=[0,0,0,0],$EH}(),$EiM=function(){function $E_(){}return $EV($E_,"laya.webgl.WebGLContext"),$E_.UseProgram=function($EM){return $E_._useProgram!==$EM&&($EoM.mainContext.useProgram($EM),$E_._useProgram=$EM,!0)},$E_.setDepthTest=function($EM,$Ee){$Ee!==$E_._depthTest&&(($E_._depthTest=$Ee)?$EM.enable(2929):$EM.disable(2929))},$E_.setDepthMask=function($EM,$Ee){$Ee!==$E_._depthMask&&($E_._depthMask=$Ee,$EM.depthMask($Ee))},$E_.setDepthFunc=function($EM,$Ee){$Ee!==$E_._depthFunc&&($E_._depthFunc=$Ee,$EM.depthFunc($Ee))},$E_.setBlend=function($EM,$Ee){$Ee!==$E_._blend&&(($E_._blend=$Ee)?$EM.enable(3042):$EM.disable(3042))},$E_.setBlendFunc=function($EM,$Ee,$EL){($Ee!==$E_._sFactor||$EL!==$E_._dFactor)&&($E_._sFactor=$Ee,$E_._dFactor=$EL,$EM.blendFunc($Ee,$EL))},$E_.setCullFace=function($EM,$Ee){$Ee!==$E_._cullFace&&(($E_._cullFace=$Ee)?$EM.enable(2884):$EM.disable(2884))},$E_.setFrontFace=function($EM,$Ee){$Ee!==$E_._frontFace&&($E_._frontFace=$Ee,$EM.frontFace($Ee))},$E_.bindTexture=function($EM,$Ee,$EL){$EM.bindTexture($Ee,$EL),$E_.curBindTexTarget=$Ee,$E_.curBindTexValue=$EL},$E_.DEPTH_BUFFER_BIT=256,$E_.STENCIL_BUFFER_BIT=1024,$E_.COLOR_BUFFER_BIT=16384,$E_.POINTS=0,$E_.LINES=1,$E_.LINE_LOOP=2,$E_.LINE_STRIP=3,$E_.TRIANGLES=4,$E_.TRIANGLE_STRIP=5,$E_.TRIANGLE_FAN=6,$E_.ZERO=0,$E_.ONE=1,$E_.SRC_COLOR=768,$E_.ONE_MINUS_SRC_COLOR=769,$E_.SRC_ALPHA=770,$E_.ONE_MINUS_SRC_ALPHA=771,$E_.DST_ALPHA=772,$E_.ONE_MINUS_DST_ALPHA=773,$E_.DST_COLOR=774,$E_.ONE_MINUS_DST_COLOR=775,$E_.SRC_ALPHA_SATURATE=776,$E_.FUNC_ADD=32774,$E_.BLEND_EQUATION=32777,$E_.BLEND_EQUATION_RGB=32777,$E_.BLEND_EQUATION_ALPHA=34877,$E_.FUNC_SUBTRACT=32778,$E_.FUNC_REVERSE_SUBTRACT=32779,$E_.BLEND_DST_RGB=32968,$E_.BLEND_SRC_RGB=32969,$E_.BLEND_DST_ALPHA=32970,$E_.BLEND_SRC_ALPHA=32971,$E_.CONSTANT_COLOR=32769,$E_.ONE_MINUS_CONSTANT_COLOR=32770,$E_.CONSTANT_ALPHA=32771,$E_.ONE_MINUS_CONSTANT_ALPHA=32772,$E_.BLEND_COLOR=32773,$E_.ARRAY_BUFFER=34962,$E_.ELEMENT_ARRAY_BUFFER=34963,$E_.ARRAY_BUFFER_BINDING=34964,$E_.ELEMENT_ARRAY_BUFFER_BINDING=34965,$E_.STREAM_DRAW=35040,$E_.STATIC_DRAW=35044,$E_.DYNAMIC_DRAW=35048,$E_.BUFFER_SIZE=34660,$E_.BUFFER_USAGE=34661,$E_.CURRENT_VERTEX_ATTRIB=34342,$E_.FRONT=1028,$E_.BACK=1029,$E_.CULL_FACE=2884,$E_.FRONT_AND_BACK=1032,$E_.BLEND=3042,$E_.DITHER=3024,$E_.STENCIL_TEST=2960,$E_.DEPTH_TEST=2929,$E_.SCISSOR_TEST=3089,$E_.POLYGON_OFFSET_FILL=32823,$E_.SAMPLE_ALPHA_TO_COVERAGE=32926,$E_.SAMPLE_COVERAGE=32928,$E_.NO_ERROR=0,$E_.INVALID_ENUM=1280,$E_.INVALID_VALUE=1281,$E_.INVALID_OPERATION=1282,$E_.OUT_OF_MEMORY=1285,$E_.CW=2304,$E_.CCW=2305,$E_.LINE_WIDTH=2849,$E_.ALIASED_POINT_SIZE_RANGE=33901,$E_.ALIASED_LINE_WIDTH_RANGE=33902,$E_.CULL_FACE_MODE=2885,$E_.FRONT_FACE=2886,$E_.DEPTH_RANGE=2928,$E_.DEPTH_WRITEMASK=2930,$E_.DEPTH_CLEAR_VALUE=2931,$E_.DEPTH_FUNC=2932,$E_.STENCIL_CLEAR_VALUE=2961,$E_.STENCIL_FUNC=2962,$E_.STENCIL_FAIL=2964,$E_.STENCIL_PASS_DEPTH_FAIL=2965,$E_.STENCIL_PASS_DEPTH_PASS=2966,$E_.STENCIL_REF=2967,$E_.STENCIL_VALUE_MASK=2963,$E_.STENCIL_WRITEMASK=2968,$E_.STENCIL_BACK_FUNC=34816,$E_.STENCIL_BACK_FAIL=34817,$E_.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$E_.STENCIL_BACK_PASS_DEPTH_PASS=34819,$E_.STENCIL_BACK_REF=36003,$E_.STENCIL_BACK_VALUE_MASK=36004,$E_.STENCIL_BACK_WRITEMASK=36005,$E_.VIEWPORT=2978,$E_.SCISSOR_BOX=3088,$E_.COLOR_CLEAR_VALUE=3106,$E_.COLOR_WRITEMASK=3107,$E_.UNPACK_ALIGNMENT=3317,$E_.PACK_ALIGNMENT=3333,$E_.MAX_TEXTURE_SIZE=3379,$E_.MAX_VIEWPORT_DIMS=3386,$E_.SUBPIXEL_BITS=3408,$E_.RED_BITS=3410,$E_.GREEN_BITS=3411,$E_.BLUE_BITS=3412,$E_.ALPHA_BITS=3413,$E_.DEPTH_BITS=3414,$E_.STENCIL_BITS=3415,$E_.POLYGON_OFFSET_UNITS=10752,$E_.POLYGON_OFFSET_FACTOR=32824,$E_.TEXTURE_BINDING_2D=32873,$E_.SAMPLE_BUFFERS=32936,$E_.SAMPLES=32937,$E_.SAMPLE_COVERAGE_VALUE=32938,$E_.SAMPLE_COVERAGE_INVERT=32939,$E_.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$E_.COMPRESSED_TEXTURE_FORMATS=34467,$E_.DONT_CARE=4352,$E_.FASTEST=4353,$E_.NICEST=4354,$E_.GENERATE_MIPMAP_HINT=33170,$E_.BYTE=5120,$E_.UNSIGNED_BYTE=5121,$E_.SHORT=5122,$E_.UNSIGNED_SHORT=5123,$E_.INT=5124,$E_.UNSIGNED_INT=5125,$E_.FLOAT=5126,$E_.DEPTH_COMPONENT=6402,$E_.ALPHA=6406,$E_.RGB=6407,$E_.RGBA=6408,$E_.LUMINANCE=6409,$E_.LUMINANCE_ALPHA=6410,$E_.UNSIGNED_SHORT_4_4_4_4=32819,$E_.UNSIGNED_SHORT_5_5_5_1=32820,$E_.UNSIGNED_SHORT_5_6_5=33635,$E_.FRAGMENT_SHADER=35632,$E_.VERTEX_SHADER=35633,$E_.MAX_VERTEX_ATTRIBS=34921,$E_.MAX_VERTEX_UNIFORM_VECTORS=36347,$E_.MAX_VARYING_VECTORS=36348,$E_.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$E_.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$E_.MAX_TEXTURE_IMAGE_UNITS=34930,$E_.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$E_.SHADER_TYPE=35663,$E_.DELETE_STATUS=35712,$E_.LINK_STATUS=35714,$E_.VALIDATE_STATUS=35715,$E_.ATTACHED_SHADERS=35717,$E_.ACTIVE_UNIFORMS=35718,$E_.ACTIVE_ATTRIBUTES=35721,$E_.SHADING_LANGUAGE_VERSION=35724,$E_.CURRENT_PROGRAM=35725,$E_.NEVER=512,$E_.LESS=513,$E_.EQUAL=514,$E_.LEQUAL=515,$E_.GREATER=516,$E_.NOTEQUAL=517,$E_.GEQUAL=518,$E_.ALWAYS=519,$E_.KEEP=7680,$E_.REPLACE=7681,$E_.INCR=7682,$E_.DECR=7683,$E_.INVERT=5386,$E_.INCR_WRAP=34055,$E_.DECR_WRAP=34056,$E_.VENDOR=7936,$E_.RENDERER=7937,$E_.VERSION=7938,$E_.NEAREST=9728,$E_.LINEAR=9729,$E_.NEAREST_MIPMAP_NEAREST=9984,$E_.LINEAR_MIPMAP_NEAREST=9985,$E_.NEAREST_MIPMAP_LINEAR=9986,$E_.LINEAR_MIPMAP_LINEAR=9987,$E_.TEXTURE_MAG_FILTER=10240,$E_.TEXTURE_MIN_FILTER=10241,$E_.TEXTURE_WRAP_S=10242,$E_.TEXTURE_WRAP_T=10243,$E_.TEXTURE_2D=3553,$E_.TEXTURE=5890,$E_.TEXTURE_CUBE_MAP=34067,$E_.TEXTURE_BINDING_CUBE_MAP=34068,$E_.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$E_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$E_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$E_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$E_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$E_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$E_.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$E_.TEXTURE0=33984,$E_.TEXTURE1=33985,$E_.TEXTURE2=33986,$E_.TEXTURE3=33987,$E_.TEXTURE4=33988,$E_.TEXTURE5=33989,$E_.TEXTURE6=33990,$E_.TEXTURE7=33991,$E_.TEXTURE8=33992,$E_.TEXTURE9=33993,$E_.TEXTURE10=33994,$E_.TEXTURE11=33995,$E_.TEXTURE12=33996,$E_.TEXTURE13=33997,$E_.TEXTURE14=33998,$E_.TEXTURE15=33999,$E_.TEXTURE16=34e3,$E_.TEXTURE17=34001,$E_.TEXTURE18=34002,$E_.TEXTURE19=34003,$E_.TEXTURE20=34004,$E_.TEXTURE21=34005,$E_.TEXTURE22=34006,$E_.TEXTURE23=34007,$E_.TEXTURE24=34008,$E_.TEXTURE25=34009,$E_.TEXTURE26=34010,$E_.TEXTURE27=34011,$E_.TEXTURE28=34012,$E_.TEXTURE29=34013,$E_.TEXTURE30=34014,$E_.TEXTURE31=34015,$E_.ACTIVE_TEXTURE=34016,$E_.REPEAT=10497,$E_.CLAMP_TO_EDGE=33071,$E_.MIRRORED_REPEAT=33648,$E_.FLOAT_VEC2=35664,$E_.FLOAT_VEC3=35665,$E_.FLOAT_VEC4=35666,$E_.INT_VEC2=35667,$E_.INT_VEC3=35668,$E_.INT_VEC4=35669,$E_.BOOL=35670,$E_.BOOL_VEC2=35671,$E_.BOOL_VEC3=35672,$E_.BOOL_VEC4=35673,$E_.FLOAT_MAT2=35674,$E_.FLOAT_MAT3=35675,$E_.FLOAT_MAT4=35676,$E_.SAMPLER_2D=35678,$E_.SAMPLER_CUBE=35680,$E_.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$E_.VERTEX_ATTRIB_ARRAY_SIZE=34339,$E_.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$E_.VERTEX_ATTRIB_ARRAY_TYPE=34341,$E_.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$E_.VERTEX_ATTRIB_ARRAY_POINTER=34373,$E_.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$E_.COMPILE_STATUS=35713,$E_.LOW_FLOAT=36336,$E_.MEDIUM_FLOAT=36337,$E_.HIGH_FLOAT=36338,$E_.LOW_INT=36339,$E_.MEDIUM_INT=36340,$E_.HIGH_INT=36341,$E_.FRAMEBUFFER=36160,$E_.RENDERBUFFER=36161,$E_.RGBA4=32854,$E_.RGB5_A1=32855,$E_.RGB565=36194,$E_.DEPTH_COMPONENT16=33189,$E_.STENCIL_INDEX=6401,$E_.STENCIL_INDEX8=36168,$E_.DEPTH_STENCIL=34041,$E_.RENDERBUFFER_WIDTH=36162,$E_.RENDERBUFFER_HEIGHT=36163,$E_.RENDERBUFFER_INTERNAL_FORMAT=36164,$E_.RENDERBUFFER_RED_SIZE=36176,$E_.RENDERBUFFER_GREEN_SIZE=36177,$E_.RENDERBUFFER_BLUE_SIZE=36178,$E_.RENDERBUFFER_ALPHA_SIZE=36179,$E_.RENDERBUFFER_DEPTH_SIZE=36180,$E_.RENDERBUFFER_STENCIL_SIZE=36181,$E_.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$E_.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$E_.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$E_.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$E_.COLOR_ATTACHMENT0=36064,$E_.DEPTH_ATTACHMENT=36096,$E_.STENCIL_ATTACHMENT=36128,$E_.DEPTH_STENCIL_ATTACHMENT=33306,$E_.NONE=0,$E_.FRAMEBUFFER_COMPLETE=36053,$E_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$E_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$E_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$E_.FRAMEBUFFER_UNSUPPORTED=36061,$E_.FRAMEBUFFER_BINDING=36006,$E_.RENDERBUFFER_BINDING=36007,$E_.MAX_RENDERBUFFER_SIZE=34024,$E_.INVALID_FRAMEBUFFER_OPERATION=1286,$E_.UNPACK_FLIP_Y_WEBGL=37440,$E_.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$E_.CONTEXT_LOST_WEBGL=37442,$E_.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$E_.BROWSER_DEFAULT_WEBGL=37444,$E_._useProgram=null,$E_._depthTest=!0,$E_._depthMask=!0,$E_._blend=!1,$E_._cullFace=!1,$E_.curBindTexTarget=null,$E_.curBindTexValue=null,$EH($E_,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$E_}(),$EWM=function($EM){function $Ee(){$Ee.__super.call(this)}$EV($Ee,"laya.webgl.display.GraphicsGL",$ET);var $EL=$Ee.prototype;return $EL.setShader=function($EM){this._saveToCmd($EC.context._setShader,[$EM])},$EL.setIBVB=function($EM,$Ee,$EL,$E_,$Ec,$Eq){this._saveToCmd($EC.context._setIBVB,[$EM,$Ee,$EL,$E_,$Ec,$Eq])},$EL.drawParticle=function($EM,$Ee,$EL){var $E_=$Ei.createParticleTemplate2D($EL);$E_.x=$EM,$E_.y=$Ee,this._saveToCmd($EC.context._drawParticle,[$E_])},$Ee}(),$EyM=function($EM){var $EL;function $EJ($EM){this._x=0,this._y=0,this._id=++$EJ._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$EJ.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$EJ.MAXCLIPRECT,this.mOutPoint,this._canvas=$EM,this._canvas._addReference(),$EJ._contextcount++,$EC.isFlash?(this._ib=$EUM.create(35044),$E$M.fillIBQuadrangle(this._ib,16)):this._ib=$EUM.QuadrangleIB,this.clear()}$EV($EJ,"laya.webgl.canvas.WebGLContext2D",$Ec);var $Ee=$EJ.prototype;return $Ee.setIsMainContext=function(){this._isMain=!0},$Ee.clearBG=function($EM,$Ee,$EL,$E_){var $Ec=$EoM.mainContext;$Ec.clearColor($EM,$Ee,$EL,$E_),$Ec.clear(16384)},$Ee._getSubmits=function(){return this._submits},$Ee._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $EM=0,$Ee=this._submits._length;$EM<$Ee;$EM++)this._submits[$EM].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$Ee.destroy=function(){--$EJ._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$EUM.QuadrangleIB&&this._ib.releaseResource()},$Ee.clear=function(){this._submits||(this._other=$EL.DEFAULT,this._curMat=$EB.create(),this._vb=$EIM.create(-1),this._submits=[],this._save=[$Ev.Create(this)],this._save.length=10,this._shader2D=new $EU,this._triangleMesh=$ElM.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$EL.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$EJ.MAXCLIPRECT,this._curSubmit=$EqM.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$Ez.DEFAULT;for(var $EM=0,$Ee=this._submits._length;$EM<$Ee;$EM++)this._submits[$EM].releaseRender(),this._submits[$EM]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$Ee.size=function($EM,$Ee){if(this._width!=$EM||this._height!=$Ee)if(0==$EM||0==$Ee){0!=this._vb._byteLength&&(this._width=$EM,this._height=$Ee,this._vb.clear(),this._vb.upload());for(var $EL=0,$E_=this._submits._length;$EL<$E_;$EL++)this._submits[$EL].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$EM,this._height=$Ee,this._targets&&this._targets.size($EM,$Ee),this._canvas.memorySize-=this._canvas.memorySize;0===$EM&&0===$Ee&&this._releaseMem()},$Ee._getTransformMatrix=function(){return this._curMat},$Ee.translate=function($EM,$Ee){0===$EM&&0===$Ee||($Es.save(this),this._curMat.bTransform&&($EN.save(this),this._curMat.transformPointN($Ek.TEMP.setTo($EM,$Ee)),$EM=$Ek.TEMP.x,$Ee=$Ek.TEMP.y),this._x+=$EM,this._y+=$Ee)},$Ee.save=function(){this._save[this._save._length++]=$Ev.Create(this)},$Ee.restore=function(){var $EM=this._save._length;if(!($EM<1))for(var $Ee=$EM-1;0<=$Ee;$Ee--){var $EL=this._save[$Ee];if($EL.restore(this),$EL.isSaveMark())return void(this._save._length=$Ee)}},$Ee._fillText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){void 0===$EO&&($EO=0);var $Eu=this._shader2D,$EG=this._curSubmit.shaderValue,$EV=$Ec?$EdM.create($Ec):this._other.font;if($Ew.enabled)$Eu.ALPHA!==$EG.ALPHA&&($Eu.glTexture=null),$EEM.drawText(this,$EM,$Ee,this._curMat,$EV,$Ex||this._other.textAlign,$Eq,$EH,$ET,$EL,$E_,$EO);else{this._shader2D.defines.getValue();var $EE=$Eq?$Ed.create($Eq)._color:$Eu.colorAdd;$Eu.ALPHA===$EG.ALPHA&&$EE===$Eu.colorAdd&&$EG.colorAdd===$Eu.colorAdd||($Eu.glTexture=null,$Eu.colorAdd=$EE),$EEM.drawText(this,$EM,$Ee,this._curMat,$EV,$Ex||this._other.textAlign,$Eq,$EH,$ET,$EL,$E_,$EO)}},$Ee.fillWords=function($EM,$Ee,$EL,$E_,$Ec,$Eq){this._fillText(null,$EM,$Ee,$EL,$E_,$Ec,null,-1,null,$Eq)},$Ee.fillBorderWords=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._fillBorderText(null,$EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,null)},$Ee.fillText=function($EM,$Ee,$EL,$E_,$Ec,$Eq){this._fillText($EM,null,$Ee,$EL,$E_,$Ec,null,-1,$Eq)},$Ee.strokeText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._fillText($EM,null,$Ee,$EL,$E_,null,$Ec,$Eq||1,$EH)},$Ee.fillBorderText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){this._fillBorderText($EM,null,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET)},$Ee._fillBorderText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){if(!$Ew.enabled)return this._fillText($EM,$Ee,$EL,$E_,$Ec,null,$EH,$ET||1,$Ex),void this._fillText($EM,$Ee,$EL,$E_,$Ec,$Eq,null,-1,$Ex);var $EO=this._shader2D,$Eu=this._curSubmit.shaderValue;$EO.ALPHA!==$Eu.ALPHA&&($EO.glTexture=null);var $EG=$Ec?($EJ._fontTemp.setFont($Ec),$EJ._fontTemp):this._other.font;$EEM.drawText(this,$EM,$Ee,this._curMat,$EG,$Ex||this._other.textAlign,$Eq,$EH,$ET||1,$EL,$E_,0)},$Ee.fillRect=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=this._vb;if($E$M.fillRectImgVb($Eq,this._clipRect,$EM,$Ee,$EL,$E_,$El.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $EH=this._shader2D.fillStyle;$Ec&&(this._shader2D.fillStyle=$Ez.create($Ec));var $ET=this._shader2D,$Ex=this._curSubmit.shaderValue;if($ET.fillStyle!==$Ex.fillStyle||$ET.ALPHA!==$Ex.ALPHA){$ET.glTexture=null;var $EO=this._curSubmit=$EqM.createSubmit(this,this._ib,$Eq,($Eq._byteLength-64)/32*3,$EAM.create(2,0));$EO.shaderValue.color=$ET.fillStyle._color._color,$EO.shaderValue.ALPHA=$ET.ALPHA,this._submits[this._submits._length++]=$EO}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$EH}},$Ee.fillTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){if($EM.loaded&&$EM.bitmap&&$EM.source){var $Ex=this._vb,$EO=$EM.bitmap.width,$Eu=$EM.bitmap.height,$EG=$EM.uv,$EV=$EH.x%$EM.width,$EE=$EH.y%$EM.height;if($EO!=$ET.w||$Eu!=$ET.h){if(!$ET.w&&!$ET.h)switch($ET.oy=$ET.ox=0,$Eq){case"repeat":$ET.width=$E_,$ET.height=$Ec;break;case"repeat-x":$ET.width=$E_,$EE<0?$EM.height+$EE>$Ec?$ET.height=$Ec:$ET.height=$EM.height+$EE:($ET.oy=$EE,$EM.height+$EE>$Ec?$ET.height=$Ec-$EE:$ET.height=$EM.height);break;case"repeat-y":$EV<0?$EM.width+$EV>$E_?$ET.width=$E_:$ET.width=$EM.width+$EV:($ET.ox=$EV,$EM.width+$EV>$E_?$ET.width=$E_-$EV:$ET.width=$EM.width),$ET.height=$Ec;break;case"no-repeat":$EV<0?$EM.width+$EV>$E_?$ET.width=$E_:$ET.width=$EM.width+$EV:($ET.ox=$EV,$EM.width+$EV>$E_?$ET.width=$E_-$EV:$ET.width=$EM.width),$EE<0?$EM.height+$EE>$Ec?$ET.height=$Ec:$ET.height=$EM.height+$EE:($ET.oy=$EE,$EM.height+$EE>$Ec?$ET.height=$Ec-$EE:$ET.height=$EM.height);break;default:$ET.width=$E_,$ET.height=$Ec}$ET.w=$EO,$ET.h=$Eu,$ET.uv=[0,0,$ET.width/$EO,0,$ET.width/$EO,$ET.height/$Eu,0,$ET.height/$Eu]}if($Ee+=$ET.ox,$EL+=$ET.oy,$EV-=$ET.ox,$EE-=$ET.oy,$E$M.fillRectImgVb($Ex,this._clipRect,$Ee,$EL,$ET.width,$ET.height,$ET.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $Ed=$EnM.create(this,this._ib,$Ex,($Ex._byteLength-64)/32*3,$EAM.create(256,0)),$Er=(this._submits[this._submits._length++]=$Ed).shaderValue;$Er.textureHost=$EM;var $E$=$EG[0]*$EO,$EC=$EG[1]*$Eu,$EK=($EG[2]-$EG[0])*$EO,$EX=($EG[5]-$EG[3])*$Eu,$Eo=-$EV/$EO,$Ei=-$EE/$Eu;$Er.u_TexRange[0]=$E$/$EO,$Er.u_TexRange[1]=$EK/$EO,$Er.u_TexRange[2]=$EC/$Eu,$Er.u_TexRange[3]=$EX/$Eu,$Er.u_offset[0]=$Eo,$Er.u_offset[1]=$Ei,$Ew.enabled&&!this._isMain&&$Ed.addTexture($EM,($Ex._byteLength>>2)-16),(this._curSubmit=$Ed)._renderType=10017,$Ed._numEle+=6}}else this.sprite&&$EW.timer.callLater(this,this._repaintSprite)},$Ee.setShader=function($EM){$EY.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$EM},$Ee.setFilters=function($EM){$EY.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$EM,this._curSubmit=$EqM.RENDERBASE,this._renderKey=0,this._drawCount++},$Ee.drawTexture=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._drawTextureM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,null,1)},$Ee.addTextureVb=function($EM,$Ee,$EL){var $E_=this._curSubmit._vb||this._vb,$Ec=$E_._byteLength>>2;$E_.byteLength=$Ec+16<<2;for(var $Eq=$E_.getFloat32Array(),$EH=0;$EH<16;$EH+=4)$Eq[$Ec++]=$EM[$EH]+$Ee,$Eq[$Ec++]=$EM[$EH+1]+$EL,$Eq[$Ec++]=$EM[$EH+2],$Eq[$Ec++]=$EM[$EH+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$E_._upload=!0},$Ee.willDrawTexture=function($EM,$Ee){if(!($EM.loaded&&$EM.bitmap&&$EM.source))return this.sprite&&$EW.timer.callLater(this,this._repaintSprite),0;var $EL=$EM.bitmap,$E_=$EL.id+this._shader2D.ALPHA*$Ee+10016;if($E_==this._renderKey)return $E_;var $Ec=this._shader2D,$Eq=$Ec.ALPHA,$EH=this._curSubmit.shaderValue;$Ec.ALPHA*=$Ee,this._renderKey=$E_,this._drawCount++,$Ec.glTexture=$EL;var $ET=this._vb,$Ex=null,$EO=$ET._byteLength/32*3,$Eu=$EH.textureHost&&$EH.textureHost==$EM&&$EH.textureHost.alphaTexture==$EM.alphaTexture;return $Ex=$EnM.create(this,this._ib,$ET,$EO,$EAM.create(1,0)),(this._submits[this._submits._length++]=$Ex).shaderValue.textureHost=$EM,$Ex._renderType=10016,$Ex._preIsSameTextureShader=10016===this._curSubmit._renderType&&$Ec.ALPHA===$EH.ALPHA&&$Eu,this._curSubmit=$Ex,$Ec.ALPHA=$Eq,$E_},$Ee.drawTextures=function($EM,$Ee,$EL,$E_){if($EM.loaded&&$EM.bitmap&&$EM.source){var $Ec=this._clipRect;if(this._clipRect=$EJ.MAXCLIPRECT,this._drawTextureM($EM,$Ee[0],$Ee[1],$EM.width,$EM.height,$EL,$E_,null,1)){if(this._clipRect=$Ec,$Ep.drawCall++,!($Ee.length<4)){for(var $Eq=this._curSubmit._vb||this._vb,$EH=this._curMat.a,$ET=this._curMat.d,$Ex=2,$EO=$Ee.length;$Ex<$EO;$Ex+=2)$E$M.copyPreImgVb($Eq,($Ee[$Ex]-$Ee[$Ex-2])*$EH,($Ee[$Ex+1]-$Ee[$Ex-1])*$ET),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$EW.timer.callLater(this,this._repaintSprite)},$Ee._drawTextureM=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){if(!$EM.loaded||!$EM.source)return this.sprite&&$EW.timer.callLater(this,this._repaintSprite),!1;var $EO=this._curSubmit._vb||this._vb,$Eu=$EM.bitmap;$Ee+=$Eq,$EL+=$EH,this._drawCount++;var $EG=$Eu.id+this._shader2D.ALPHA*$Ex+10016;if($EG!=this._renderKey){this._renderKey=$EG;var $EV=this._curSubmit.shaderValue,$EE=this._shader2D,$Ed=$EE.ALPHA;$EE.ALPHA*=$Ex,$EE.glTexture=$Eu;var $Er=this._vb,$E$=null,$EC=$Er._byteLength/32*3,$EK=$EV.textureHost&&$EV.textureHost==$EM&&$EV.textureHost.alphaTexture==$EM.alphaTexture;$E$=$EnM.create(this,this._ib,$Er,$EC,$EAM.create(1,0)),(this._submits[this._submits._length++]=$E$).shaderValue.textureHost=$EM,$E$._renderType=10016,$E$._preIsSameTextureShader=10016===this._curSubmit._renderType&&$EE.ALPHA===$EV.ALPHA&&$EK,this._curSubmit=$E$,$EO=this._curSubmit._vb||this._vb,$EE.ALPHA=$Ed}return!!$E$M.fillRectImgVb($EO,this._clipRect,$Ee,$EL,$E_||$EM.width,$Ec||$EM.height,$EM.uv,$ET||this._curMat,this._x,this._y,0,0)&&($Ew.enabled&&!this._isMain&&this._curSubmit.addTexture($EM,($EO._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$Ee._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$Ee._drawText=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){var $Eu=$EM.bitmap;this._drawCount++;var $EG=$Eu.id+this._shader2D.ALPHA+10016;if($EG!=this._renderKey){this._renderKey=$EG;var $EV=this._curSubmit.shaderValue,$EE=this._shader2D;$EE.glTexture=$Eu;var $Ed=this._vb,$Er=null,$E$=$Ed._byteLength/32*3,$EC=$EV.textureHost&&$EV.textureHost==$EM&&$EV.textureHost.alphaTexture==$EM.alphaTexture;($Er=$Ew.enabled?$EnM.create(this,this._ib,$Ed,$E$,$EAM.create(1,0)):$EnM.create(this,this._ib,$Ed,$E$,$EsM.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$EE.ALPHA===$EV.ALPHA&&$EC,(this._submits[this._submits._length++]=$Er).shaderValue.textureHost=$EM,$Er._renderType=10016,this._curSubmit=$Er}$EM.active();var $EK=this._curSubmit._vb||this._vb;$E$M.fillRectImgVb($EK,this._clipRect,$Ee+$EH,$EL+$ET,$E_||$EM.width,$Ec||$EM.height,$EM.uv,$Eq||this._curMat,this._x,this._y,$Ex,$EO,!0)&&($Ew.enabled&&!this._isMain&&this._curSubmit.addTexture($EM,($EK._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$Ee.drawTextureWithTransform=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){if($Eq){var $EO=this._curMat,$Eu=this._x,$EG=this._y;(0!==$EH||0!==$ET)&&(this._x=$EH*$EO.a+$ET*$EO.c,this._y=$ET*$EO.d+$EH*$EO.b),$Eq&&$EO.bTransform?($EB.mul($Eq,$EO,$EJ._tmpMatrix),($Eq=$EJ._tmpMatrix)._checkTransform()):(this._x+=$EO.tx,this._y+=$EO.ty),this._drawTextureM($EM,$Ee,$EL,$E_,$Ec,0,0,$Eq,$Ex),this._x=$Eu,this._y=$EG}else this._drawTextureM($EM,$Ee,$EL,$E_,$Ec,$EH,$ET,null,$Ex)},$Ee.fillQuadrangle=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=this._curSubmit,$EH=this._vb,$ET=this._shader2D,$Ex=$Eq.shaderValue;if(this._renderKey=0,$EM.bitmap){var $EO=$EM.bitmap;$ET.glTexture==$EO&&$ET.ALPHA===$Ex.ALPHA||($ET.glTexture=$EO,($Eq=this._curSubmit=$EqM.createSubmit(this,this._ib,$EH,$EH._byteLength/32*3,$EAM.create(1,0))).shaderValue.glTexture=$EO,this._submits[this._submits._length++]=$Eq),$E$M.fillQuadrangleImgVb($EH,$Ee,$EL,$E_,$EM.uv,$Ec||this._curMat,this._x,this._y)}else $Eq.shaderValue.fillStyle&&$Eq.shaderValue.fillStyle.equal($EM)&&$ET.ALPHA===$Ex.ALPHA||($ET.glTexture=null,($Eq=this._curSubmit=$EqM.createSubmit(this,this._ib,$EH,$EH._byteLength/32*3,$EAM.create(2,0))).shaderValue.defines.add(2),$Eq.shaderValue.fillStyle=$Ez.create($EM),this._submits[this._submits._length++]=$Eq),$E$M.fillQuadrangleImgVb($EH,$Ee,$EL,$E_,$El.DEF_UV,$Ec||this._curMat,this._x,this._y);$Eq._numEle+=6},$Ee.drawTexture2=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){if(0!=$Eq){var $Ex=this._curMat;if(this._x=$EM*$Ex.a+$Ee*$Ex.c,this._y=$Ee*$Ex.d+$EM*$Ex.b,$Ec&&($Ec=$Ex.bTransform||$Ec.bTransform?($EB.mul($Ec,$Ex,$EJ._tmpMatrix),$EJ._tmpMatrix):(this._x+=$Ec.tx+$Ex.tx,this._y+=$Ec.ty+$Ex.ty,$EB.EMPTY)),1!==$Eq||$EH){var $EO=this._shader2D.ALPHA,$Eu=this._nBlendType;this._shader2D.ALPHA=$Eq,$EH&&(this._nBlendType=$Em.TOINT($EH)),this._drawTextureM($ET[0],$ET[1]-$EL,$ET[2]-$E_,$ET[3],$ET[4],0,0,$Ec,1),this._shader2D.ALPHA=$EO,this._nBlendType=$Eu}else this._drawTextureM($ET[0],$ET[1]-$EL,$ET[2]-$E_,$ET[3],$ET[4],0,0,$Ec,1);this._x=this._y=0}},$Ee.drawCanvas=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EM.context;if(this._renderKey=0,$Eq._targets)this._submits[this._submits._length++]=$EaM.create($Eq,0,null),this._curSubmit=$EqM.RENDERBASE,$Eq._targets.drawTo(this,$Ee,$EL,$E_,$Ec);else{var $EH=this._submits[this._submits._length++]=$EaM.create($Eq,this._shader2D.ALPHA,this._shader2D.filters),$ET=$E_/$EM.width,$Ex=$Ec/$EM.height,$EO=$EH._matrix;this._curMat.copyTo($EO),1!=$ET&&1!=$Ex&&$EO.scale($ET,$Ex);var $Eu=$EO.tx,$EG=$EO.ty;$EO.tx=$EO.ty=0,$EO.transformPoint($Ek.TEMP.setTo($Ee,$EL)),$EO.translate($Ek.TEMP.x+$Eu,$Ek.TEMP.y+$EG),this._curSubmit=$EqM.RENDERBASE}$Ey.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$Eq._targets?"yellow":"green",this.strokeRect($Ee-1,$EL-1,$E_+2,$Ec+2,1),this.strokeRect($Ee,$EL,$E_,$Ec,1),this.restore())},$Ee.drawTarget=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){void 0===$EO&&($EO=-1);var $Eu=this._vb;if($E$M.fillRectImgVb($Eu,this._clipRect,$Ee,$EL,$E_,$Ec,$Ex||$El.DEF_UV,$Eq||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $EG=this._curSubmit=$EGM.create(this,this._ib,$Eu,($Eu._byteLength-64)/32*3,$ET,$EH);$EG.blendType=-1==$EO?this._nBlendType:$EO,$EG.scope=$EM,this._submits[this._submits._length++]=$EG,this._curSubmit._numEle+=6}},$Ee.mixRGBandAlpha=function($EM){return this._mixRGBandAlpha($EM,this._shader2D.ALPHA)},$Ee._mixRGBandAlpha=function($EM,$Ee){var $EL=(4278190080&$EM)>>>24;return 0!=$EL?$EL*=$Ee:$EL=255*$Ee,16777215&$EM|$EL<<24},$Ee.drawTriangles=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){if(!$EM.loaded||!$EM.source)return this.sprite&&$EW.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$EM.bitmap;var $Eu=this._mixRGBandAlpha(4294967295,$ET),$EG=($E_.length,$Eq.length);this._renderKey=-1;var $EV=this._curSubmit=$EnM.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$EAM.create(1,0));return $EV.shaderValue.textureHost=$EM,$EV._renderType=10016,this._submits[this._submits._length++]=$EV,$EH?($EJ._tmpMatrix.a=$EH.a,$EJ._tmpMatrix.b=$EH.b,$EJ._tmpMatrix.c=$EH.c,$EJ._tmpMatrix.d=$EH.d,$EJ._tmpMatrix.tx=$EH.tx+$Ee,$EJ._tmpMatrix.ty=$EH.ty+$EL,$EB.mul($EJ._tmpMatrix,this._curMat,$EJ._tmpMatrix)):($EJ._tmpMatrix.a=this._curMat.a,$EJ._tmpMatrix.b=this._curMat.b,$EJ._tmpMatrix.c=this._curMat.c,$EJ._tmpMatrix.d=this._curMat.d,$EJ._tmpMatrix.tx=this._curMat.tx+$Ee,$EJ._tmpMatrix.ty=this._curMat.ty+$EL),this._triangleMesh.addData($E_,$Ec,$Eq,$EJ._tmpMatrix,$Eu,this),this._curSubmit._numEle+=$EG,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$Ee.transform=function($EM,$Ee,$EL,$E_,$Ec,$Eq){$EN.save(this),$EB.mul($EB.TEMP.setTo($EM,$Ee,$EL,$E_,$Ec,$Eq),this._curMat,this._curMat),this._curMat._checkTransform()},$Ee.setTransformByMatrix=function($EM){$EM.copyTo(this._curMat)},$Ee.transformByMatrix=function($EM){$EN.save(this),$EB.mul($EM,this._curMat,this._curMat),this._curMat._checkTransform()},$Ee.rotate=function($EM){$EN.save(this),this._curMat.rotateEx($EM)},$Ee.scale=function($EM,$Ee){$EN.save(this),this._curMat.scaleEx($EM,$Ee)},$Ee.clipRect=function($EM,$Ee,$EL,$E_){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $Ec=$EuM.create(4);this.addRenderObject($Ec);var $Eq=this._vb,$EH=$Eq._byteLength>>2;if($E$M.fillRectImgVb($Eq,null,$EM,$Ee,$EL,$E_,$El.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $ET=this._curSubmit=$EqM.createSubmit(this,this._ib,$Eq,($Eq._byteLength-64)/32*3,$EAM.create(2,0));$ET.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$ET,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $Ex=$EuM.create(5);this.addRenderObject($Ex);var $EO=$Eq.getFloat32Array(),$Eu=Math.min(Math.min(Math.min($EO[0+$EH],$EO[4+$EH]),$EO[8+$EH]),$EO[12+$EH]),$EG=Math.max(Math.max(Math.max($EO[0+$EH],$EO[4+$EH]),$EO[8+$EH]),$EO[12+$EH]),$EV=Math.min(Math.min(Math.min($EO[1+$EH],$EO[5+$EH]),$EO[9+$EH]),$EO[13+$EH]),$EE=Math.max(Math.max(Math.max($EO[1+$EH],$EO[5+$EH]),$EO[9+$EH]),$EO[13+$EH]);$EZ.save(this,$Ex,$EM,$Ee,$EL,$E_,$Eu,$EV,$EG-$Eu,$EE-$EV),this._curSubmit=$EqM.RENDERBASE}else{$EL*=this._curMat.a,$E_*=this._curMat.d;var $Ed=$Ek.TEMP;this._curMat.transformPoint($Ed.setTo($EM,$Ee)),$EL<0&&($Ed.x=$Ed.x+$EL,$EL=-$EL),$E_<0&&($Ed.y=$Ed.y+$E_,$E_=-$E_),this._renderKey=0;var $Er=this._curSubmit=$EOM.create(this);(this._submits[this._submits._length++]=$Er).submitIndex=this._submits._length,$Er.submitLength=9999999,$EP.save(this,$Er);var $E$=this._clipRect,$EC=$E$.x,$EK=$E$.y,$EX=$Ed.x+$EL,$Eo=$Ed.y+$E_;$EC<$Ed.x&&($E$.x=$Ed.x),$EK<$Ed.y&&($E$.y=$Ed.y),$E$.width=Math.min($EX,$EC+$E$.width)-$E$.x,$E$.height=Math.min($Eo,$EK+$E$.height)-$E$.y,this._shader2D.glTexture=null,$Er.clipRect.copyFrom($E$),this._curSubmit=$EqM.RENDERBASE}},$Ee.setIBVB=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu){if(void 0===$Ex&&($Ex=0),void 0===$EO&&($EO=0),void 0===$Eu&&($Eu=0),null===$EL){if($EC.isFlash){var $EG=$E_;$EG._selfIB||($EG._selfIB=$EUM.create(35044)),$EG._selfIB.clear(),$EL=$EG._selfIB}else $EL=this._ib;$E$M.expandIBQuadrangle($EL,$E_._byteLength/(4*$E_.vertexStride*4))}if(!$ET||!$EH)throw Error("setIBVB must input:shader shaderValues");var $EV=$ExM.create(this,$E_,$EL,$Ec,$EH,$ET,$Ex,$EO,$Eu);$Eq||($Eq=$EB.EMPTY),$Eq.translate($EM,$Ee),$EB.mul($Eq,this._curMat,$EV._mat),$Eq.translate(-$EM,-$Ee),this._submits[this._submits._length++]=$EV,this._curSubmit=$EqM.RENDERBASE,this._renderKey=0},$Ee.addRenderObject=function($EM){this._submits[this._submits._length++]=$EM},$Ee.fillTrangles=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=this._curSubmit,$EH=this._vb,$ET=this._shader2D,$Ex=$Eq.shaderValue,$EO=$E_.length>>4,$Eu=$EM.bitmap;this._renderKey=0,$ET.glTexture==$Eu&&$ET.ALPHA===$Ex.ALPHA||(($Eq=this._curSubmit=$EqM.createSubmit(this,this._ib,$EH,$EH._byteLength/32*3,$EAM.create(1,0))).shaderValue.textureHost=$EM,this._submits[this._submits._length++]=$Eq),$E$M.fillTranglesVB($EH,$Ee,$EL,$E_,$Ec||this._curMat,this._x,this._y),$Eq._numEle+=6*$EO},$Ee.submitElement=function($EM,$Ee){var $EL=this._submits;for($Ee<0&&($Ee=$EL._length);$EM<$Ee;)$EM+=$EL[$EM].renderSubmit()},$Ee.finish=function(){$EoM.mainContext.finish()},$Ee.flush=function(){var $EM=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($EM>this._ib.bufferLength/12&&$E$M.expandIBQuadrangle(this._ib,$EM),!this._isMain&&$Ew.enabled&&$Ew._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$Ew._atlasRestore;for(var $Ee=this._submits,$EL=0,$E_=$Ee._length;$EL<$E_;$EL++){var $Ec=$Ee[$EL];10016===$Ec.getRenderType()&&$Ec.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$EeM.instance&&$EeM.getInstance().reset();var $Eq;for($EL=0,$Eq=this.meshlist.length;$EL<$Eq;$EL++){var $EH=this.meshlist[$EL];$EH.canReuse?$EH.releaseMesh():$EH.destroy()}return this.meshlist.length=0,this._curSubmit=$EqM.RENDERBASE,this._renderKey=0,this._triangleMesh=$ElM.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$Ee.setPathId=function($EM){if(this.mId=$EM,-1!=this.mId){this.mHaveKey=!1;var $Ee=$Ej.getInstance();$Ee.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$Ee.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$Ee.movePath=function($EM,$Ee){var $EL=$EM,$E_=$Ee;$EM=this._curMat.a*$EL+this._curMat.c*$E_+this._curMat.tx,$Ee=this._curMat.b*$EL+this._curMat.d*$E_+this._curMat.ty,this.mX+=$EM,this.mY+=$Ee},$Ee.beginPath=function(){var $EM=this._getPath();$EM.tempArray.length=0,$EM.closePath=!1,this.mX=0,this.mY=0},$Ee.closePath=function(){this._path.closePath=!0},$Ee.fill=function($EM){void 0===$EM&&($EM=!1);var $Ee=this._getPath();this.drawPoly(0,0,$Ee.tempArray,this.fillStyle._color.numColor,0,0,$EM)},$Ee.stroke=function(){var $EM=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$EM.drawLine(0,0,$EM.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $Ee=$Ej.getInstance().shapeLineDic[this.mId];$Ee.rebuild($EM.tempArray),$EM.setGeomtry($Ee)}else $Ej.getInstance().addLine(this.mId,$EM.drawLine(0,0,$EM.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$EM.update();var $EL=[this.mX,this.mY],$E_=$EqM.createShape(this,$EM.ib,$EM.vb,$EM.count,$EM.offset,$EAM.create(4,0));$E_.shaderValue.ALPHA=this._shader2D.ALPHA,$E_.shaderValue.u_pos=$EL,$E_.shaderValue.u_mmat2=$EKM.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$E_,this._renderKey=-1}},$Ee.line=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=this._curSubmit,$ET=this._vb;if($E$M.fillLineVb($ET,this._clipRect,$EM,$Ee,$EL,$E_,$Ec,$Eq)){this._renderKey=0;var $Ex=this._shader2D,$EO=$EH.shaderValue;$Ex.strokeStyle===$EO.strokeStyle&&$Ex.ALPHA===$EO.ALPHA||($Ex.glTexture=null,($EH=this._curSubmit=$EqM.createSubmit(this,this._ib,$ET,($ET._byteLength-64)/32*3,$EAM.create(2,0))).shaderValue.strokeStyle=$Ex.strokeStyle,$EH.shaderValue.mainID=2,$EH.shaderValue.ALPHA=$Ex.ALPHA,this._submits[this._submits._length++]=$EH),$EH._numEle+=6}},$Ee.moveTo=function($EM,$Ee,$EL){void 0===$EL&&($EL=!0);var $E_=this._getPath();if($EL){var $Ec=$EM,$Eq=$Ee;$EM=this._curMat.a*$Ec+this._curMat.c*$Eq,$Ee=this._curMat.b*$Ec+this._curMat.d*$Eq}$E_.addPoint($EM,$Ee)},$Ee.lineTo=function($EM,$Ee,$EL){void 0===$EL&&($EL=!0);var $E_=this._getPath();if($EL){var $Ec=$EM,$Eq=$Ee;$EM=this._curMat.a*$Ec+this._curMat.c*$Eq,$Ee=this._curMat.b*$Ec+this._curMat.d*$Eq}$E_.addPoint($EM,$Ee)},$Ee.drawCurves=function($EM,$Ee,$EL){this.setPathId(-1),this.beginPath(),this.strokeStyle=$EL[3],this.lineWidth=$EL[4];var $E_=$EL[2];$EM+=$EL[0],$Ee+=$EL[1],this.movePath($EM,$Ee),this.moveTo($E_[0],$E_[1]);for(var $Ec=2,$Eq=$E_.length;$Ec<$Eq;)this.quadraticCurveTo($E_[$Ec++],$E_[$Ec++],$E_[$Ec++],$E_[$Ec++]);this.stroke()},$Ee.arcTo=function($EM,$Ee,$EL,$E_,$Ec){if(-1==this.mId||!this.mHaveKey){var $Eq=0,$EH=0,$ET=0,$Ex=this._getPath();this._curMat.copyTo($EJ._tmpMatrix),$EJ._tmpMatrix.tx=$EJ._tmpMatrix.ty=0,$EJ._tempPoint.setTo($Ex.getEndPointX(),$Ex.getEndPointY()),$EJ._tmpMatrix.invertTransformPoint($EJ._tempPoint);var $EO=$EJ._tempPoint.x-$EM,$Eu=$EJ._tempPoint.y-$Ee,$EG=Math.sqrt($EO*$EO+$Eu*$Eu);if(!($EG<=1e-6)){var $EV=$EO/$EG,$EE=$Eu/$EG,$Ed=$EL-$EM,$Er=$E_-$Ee,$E$=$Ed*$Ed+$Er*$Er,$EC=Math.sqrt($E$);if(!($EC<=1e-6)){var $EK=$Ed/$EC,$EX=$Er/$EC,$Eo=$EV+$EK,$Ei=$EE+$EX,$EW=Math.sqrt($Eo*$Eo+$Ei*$Ei);if(!($EW<=1e-6)){var $Ey=$Eo/$EW,$EA=$Ei/$EW,$EB=Math.acos($Ey*$EV+$EA*$EE),$Ek=Math.PI/2-$EB,$Eh=($EG=$Ec/Math.tan($Ek))*$EV+$EM,$Et=$EG*$EE+$Ee,$ES=Math.sqrt($EG*$EG+$Ec*$Ec),$Ep=$EM+$Ey*$ES,$ER=$Ee+$EA*$ES,$Ea=0,$En=0;if(0<=$EV*$EX-$EE*$EK){var $El=2*$Ek/$EJ.SEGNUM;$Ea=Math.sin($El),$En=Math.cos($El)}else $El=2*-$Ek/$EJ.SEGNUM,$Ea=Math.sin($El),$En=Math.cos($El);$EH=this._curMat.a*$Eh+this._curMat.c*$Et,$ET=this._curMat.b*$Eh+this._curMat.d*$Et,$EH==this._path.getEndPointX()&&$ET==this._path.getEndPointY()||$Ex.addPoint($EH,$ET);var $Ef=$Eh-$Ep,$Ej=$Et-$ER;for($Eq=0;$Eq<$EJ.SEGNUM;$Eq++){var $EF=$Ef*$En+$Ej*$Ea,$Eg=-$Ef*$Ea+$Ej*$En;$EH=$EF+$Ep,$ET=$Eg+$ER,$EM=this._curMat.a*$EH+this._curMat.c*$ET,$ET=$Ee=this._curMat.b*$EH+this._curMat.d*$ET,($EH=$EM)==this._path.getEndPointX()&&$ET==this._path.getEndPointY()||$Ex.addPoint($EH,$ET),$Ef=$EF,$Ej=$Eg}}}}}},$Ee.arc=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){if(void 0===$Eq&&($Eq=!1),void 0===$EH&&($EH=!0),-1!=this.mId){var $ET=$Ej.getInstance().shapeDic[this.mId];if($ET&&this.mHaveKey&&!$ET.needUpdate(this._curMat))return;$Ee=$EM=0}var $Ex,$EO=0,$Eu=0,$EG=0,$EV=0,$EE=0,$Ed=0,$Er=0;if($Eu=$Ec-$E_,$Eq)if(Math.abs($Eu)>=2*Math.PI)$Eu=2*-Math.PI;else for(;0<$Eu;)$Eu-=2*Math.PI;else if(Math.abs($Eu)>=2*Math.PI)$Eu=2*Math.PI;else for(;$Eu<0;)$Eu+=2*Math.PI;$Ex=$Eu/($Er=$EL<101?Math.max(10,$Eu*$EL/5):$EL<201?Math.max(10,$Eu*$EL/20):Math.max(10,$Eu*$EL/40))/2,$EG=Math.abs(4/3*(1-Math.cos($Ex))/Math.sin($Ex)),$Eq&&($EG=-$EG);var $E$=this._getPath(),$EC=NaN,$EK=NaN;for($Ed=0;$Ed<=$Er;$Ed++)$EO=$E_+$Eu*($Ed/$Er),$EV=$EM+Math.cos($EO)*$EL,$EE=$Ee+Math.sin($EO)*$EL,$EH&&($EC=$EV,$EK=$EE,$EV=this._curMat.a*$EC+this._curMat.c*$EK,$EE=this._curMat.b*$EC+this._curMat.d*$EK),$EV==this._path.getEndPointX()&&$EE==this._path.getEndPointY()||$E$.addPoint($EV,$EE);$EV=$EM+Math.cos($Ec)*$EL,$EE=$Ee+Math.sin($Ec)*$EL,$EH&&($EC=$EV,$EK=$EE,$EV=this._curMat.a*$EC+this._curMat.c*$EK,$EE=this._curMat.b*$EC+this._curMat.d*$EK),$EV==this._path.getEndPointX()&&$EE==this._path.getEndPointY()||$E$.addPoint($EV,$EE)},$Ee.quadraticCurveTo=function($EM,$Ee,$EL,$E_){var $Ec=$EG.I,$Eq=$EL,$EH=$E_;$EL=this._curMat.a*$Eq+this._curMat.c*$EH,$E_=this._curMat.b*$Eq+this._curMat.d*$EH,$Eq=$EM,$EH=$Ee,$EM=this._curMat.a*$Eq+this._curMat.c*$EH,$Ee=this._curMat.b*$Eq+this._curMat.d*$EH;for(var $ET=$Ec.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$EM,$Ee,$EL,$E_],30,2),$Ex=0,$EO=$ET.length/2;$Ex<$EO;$Ex++)this.lineTo($ET[2*$Ex],$ET[2*$Ex+1],!1);this.lineTo($EL,$E_,!1)},$Ee.rect=function($EM,$Ee,$EL,$E_){this._other=this._other.make(),this._other.path||(this._other.path=new $EQ),this._other.path.rect($EM,$Ee,$EL,$E_)},$Ee.strokeRect=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=.5*$Ec;this.line($EM-$Eq,$Ee,$EM+$EL+$Eq,$Ee,$Ec,this._curMat),this.line($EM+$EL,$Ee,$EM+$EL,$Ee+$E_,$Ec,this._curMat),this.line($EM,$Ee,$EM,$Ee+$E_,$Ec,this._curMat),this.line($EM-$Eq,$Ee+$E_,$EM+$EL+$Eq,$Ee+$E_,$Ec,this._curMat)},$Ee.clip=function(){},$Ee.drawPoly=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){void 0===$EH&&($EH=!1),this._renderKey=0,this._shader2D.glTexture=null;var $ET=this._getPath();if(-1==this.mId)$ET.polygon($EM,$Ee,$EL,$E_,$Ec||1,$Eq);else if(this.mHaveKey){var $Ex=$Ej.getInstance().shapeDic[this.mId];$Ex.setMatrix(this._curMat),$Ex.rebuild($ET.tempArray),$ET.setGeomtry($Ex)}else{var $EO=$ET.polygon($EM,$Ee,$EL,$E_,$Ec||1,$Eq);$Ej.getInstance().addShape(this.mId,$EO),$EO.setMatrix(this._curMat)}$ET.update();var $Eu,$EG=[this.mX,this.mY];if(($Eu=$EqM.createShape(this,$ET.ib,$ET.vb,$ET.count,$ET.offset,$EAM.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$Eu.shaderValue.u_pos=$EG,$Eu.shaderValue.u_mmat2=$EKM.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$Eu,0<$Ec){if(this.mHaveLineKey){var $EV=$Ej.getInstance().shapeLineDic[this.mId];$EV.rebuild($ET.tempArray),$ET.setGeomtry($EV)}else $Ej.getInstance().addShape(this.mId,$ET.drawLine($EM,$Ee,$EL,$Ec,$Eq));$ET.update(),($Eu=$EqM.createShape(this,$ET.ib,$ET.vb,$ET.count,$ET.offset,$EAM.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$Eu.shaderValue.u_mmat2=$EKM.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$Eu}},$Ee.drawParticle=function($EM,$Ee,$EL){$EL.x=$EM,$EL.y=$Ee,this._submits[this._submits._length++]=$EL},$Ee._getPath=function(){return this._path||(this._path=new $EQ)},$E_(0,$Ee,"globalCompositeOperation",function(){return $Em.NAMES[this._nBlendType]},function($EM){var $Ee=$Em.TOINT[$EM];null==$Ee||this._nBlendType===$Ee||($EY.save(this,65536,this,!0),this._curSubmit=$EqM.RENDERBASE,this._renderKey=0,this._nBlendType=$Ee)}),$E_(0,$Ee,"strokeStyle",function(){return this._shader2D.strokeStyle},function($EM){this._shader2D.strokeStyle.equal($EM)||($EY.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$Ez.create($EM))}),$E_(0,$Ee,"globalAlpha",function(){return this._shader2D.ALPHA},function($EM){($EM=Math.floor(1e3*$EM)/1e3)!=this._shader2D.ALPHA&&($EY.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$EM)}),$E_(0,$Ee,"asBitmap",null,function($EM){if($EM){if(this._targets||(this._targets=new $ED),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$E_(0,$Ee,"fillStyle",function(){return this._shader2D.fillStyle},function($EM){this._shader2D.fillStyle.equal($EM)||($EY.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$Ez.create($EM))}),$E_(0,$Ee,"textAlign",function(){return this._other.textAlign},function($EM){this._other.textAlign===$EM||(this._other=this._other.make(),$EY.save(this,32768,this._other,!1),this._other.textAlign=$EM)}),$E_(0,$Ee,"lineWidth",function(){return this._other.lineWidth},function($EM){this._other.lineWidth===$EM||(this._other=this._other.make(),$EY.save(this,256,this._other,!1),this._other.lineWidth=$EM)}),$E_(0,$Ee,"textBaseline",function(){return this._other.textBaseline},function($EM){this._other.textBaseline===$EM||(this._other=this._other.make(),$EY.save(this,16384,this._other,!1),this._other.textBaseline=$EM)}),$E_(0,$Ee,"font",null,function($EM){$EM!=this._other.font.toString()&&(this._other=this._other.make(),$EY.save(this,8,this._other,!1),this._other.font===$EdM.EMPTY?this._other.font=new $EdM($EM):this._other.font.setFont($EM))}),$EJ.__init__=function(){$EL.DEFAULT=new $EL},$EJ._tempPoint=new $Ek,$EJ._SUBMITVBSIZE=32e3,$EJ._MAXSIZE=99999999,$EJ._RECTVBSIZE=16,$EJ.MAXCLIPRECT=new $Eh(0,0,99999999,99999999),$EJ._COUNT=0,$EJ._tmpMatrix=new $EB,$EJ.SEGNUM=32,$EJ._contextcount=0,$EH($EJ,["_fontTemp",function(){return this._fontTemp=new $EdM},"_drawStyleTemp",function(){return this._drawStyleTemp=new $Ez(null)}]),$EJ.__init$=function(){$EL=function(){function $EM(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$EdM.EMPTY}$EV($EM,"");var $Ee=$EM.prototype;return $Ee.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$EdM.EMPTY},$Ee.make=function(){return this===$EM.DEFAULT?new $EM:this},$EM.DEFAULT=null,$EM}()},$EJ}(),$EAM=function($EM){function $E_($EM,$Ee){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$E_.__super.call(this),this.defines=new $EtM,this.position=$E_._POSITION,this.mainID=$EM,this.subID=$Ee,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$EM|$Ee,this._inClassCache=$E_._cache[this._cacheID],0<$EM&&!this._inClassCache&&(this._inClassCache=$E_._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$EV($E_,"laya.webgl.shader.d2.value.Value2D",$Eg);var $Ee=$E_.prototype;return $Ee.setValue=function($EM){},$Ee.refresh=function(){var $EM=this.size;return $EM[0]=$EKM.width,$EM[1]=$EKM.height,this.alpha=this.ALPHA*$EKM.worldAlpha,this.mmat=$EKM.worldMatrix4,this},$Ee._ShaderWithCompile=function(){return $EvM.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$EDM.create)},$Ee._withWorldShaderDefines=function(){var $EM=$EKM.worldShaderDefines,$Ee=$EvM.sharders[this.mainID|this.defines._value|$EM.getValue()];if(!$Ee){var $EL,$E_={};for($EL in this.defines.toNameDic())$E_[$EL]="";for($EL in $EM.toNameDic())$E_[$EL]="";$Ee=$EvM.withCompile2D(0,this.mainID,$E_,this.mainID|this.defines._value|$EM.getValue(),$EDM.create)}var $Ec=$EKM.worldFilters;if(!$Ec)return $Ee;for(var $Eq,$EH=$Ec.length,$ET=0;$ET<$EH;$ET++)($Eq=$Ec[$ET])&&$Eq.action.setValue(this);return $Ee},$Ee.upload=function(){var $EM=$EKM;this.alpha=this.ALPHA*$EM.worldAlpha,$EKM.worldMatrix4!==$EKM.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$EoM.shaderHighPrecision&&this.defines.add(1024);var $Ee,$EL=$EM.worldShaderDefines?this._withWorldShaderDefines():$EvM.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$EM.width,this.size[1]=$EM.height,this.mmat=$EM.worldMatrix4,$EfM.activeShader!==$EL?$EL._shaderValueWidth!==$EM.width||$EL._shaderValueHeight!==$EM.height?($EL._shaderValueWidth=$EM.width,$EL._shaderValueHeight=$EM.height):$Ee=$EL._params2dQuick2||$EL._make2dQuick2():$EL._shaderValueWidth!==$EM.width||$EL._shaderValueHeight!==$EM.height?($EL._shaderValueWidth=$EM.width,$EL._shaderValueHeight=$EM.height):$Ee=$EL._params2dQuick1||$EL._make2dQuick1(),$EL.upload(this,$Ee)},$Ee.setFilters=function($EM){if(this.filters=$EM)for(var $Ee,$EL=$EM.length,$E_=0;$E_<$EL;$E_++)($Ee=$EM[$E_])&&(this.defines.add($Ee.type),$Ee.action.setValue(this))},$Ee.clear=function(){this.defines.setValue(this.subID)},$Ee.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$E_._initone=function($EM,$Ee){$E_._typeClass[$EM]=$Ee,$E_._cache[$EM]=[],$E_._cache[$EM]._length=0},$E_.__init__=function(){$E_._POSITION=[2,5126,!1,4*$ErM.BYTES_PE,0],$E_._TEXCOORD=[2,5126,!1,4*$ErM.BYTES_PE,2*$ErM.BYTES_PE],$E_._initone(2,$EJM),$E_._initone(4,$EmM),$E_._initone(256,$EwM),$E_._initone(512,$EgM),$E_._initone(1,$EbM),$E_._initone(65,$EsM),$E_._initone(9,$EbM)},$E_.create=function($EM,$Ee){var $EL=$E_._cache[$EM|$Ee];return $EL._length?$EL[--$EL._length]:new $E_._typeClass[$EM|$Ee]($Ee)},$E_._POSITION=null,$E_._TEXCOORD=null,$E_._cache=[],$E_._typeClass=[],$E_.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$E_}(),$EBM=function($EM){function $E$($EM,$Ee){$E$.__super.call(this,$EM,$Ee)}$EV($E$,"laya.webgl.utils.RenderSprite3D",$EK);var $Ee=$E$.prototype;return $Ee.onCreate=function($EM){switch($EM){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$Ee._mask=function($EM,$Ee,$EL,$E_){var $Ec,$Eq,$EH=this._next,$ET=$EM.mask;if($ET){$Ee.ctx.save();var $Ex=$Ee.ctx.globalCompositeOperation,$EO=new $Eh;if($EO.copyFrom($ET.getBounds()),$EO.width=Math.round($EO.width),$EO.height=Math.round($EO.height),$EO.x=Math.round($EO.x),$EO.y=Math.round($EO.y),0<$EO.width&&0<$EO.height){var $Eu=$EM._style._tf,$EG=$ETM.create();$EG.addValue("bounds",$EO),$Ec=$EHM.create([$EG,$Ee],laya.webgl.utils.RenderSprite3D.tmpTarget),$Ee.addRenderObject($Ec),$ET.render($Ee,-$EO.x,-$EO.y),$Ec=$EHM.create([$EG],laya.webgl.utils.RenderSprite3D.endTmpTarget),$Ee.addRenderObject($Ec),$Ee.ctx.save(),$Ee.clipRect($EL-$Eu.translateX+$EO.x,$E_-$Eu.translateY+$EO.y,$EO.width,$EO.height),$EH._fun.call($EH,$EM,$Ee,$EL,$E_),$Ee.ctx.restore(),$Eq=$EuM.create(6),$Ex=$Ee.ctx.globalCompositeOperation,$Eq.blendMode="mask",$Ee.addRenderObject($Eq),$EB.TEMP.identity();var $EV=$EAM.create(1,0),$EE=$El.INV_UV,$Ed=$EO.width,$Er=$EO.height;($EO.width<32||$EO.height<32)&&(($EE=$E$.tempUV)[0]=0,$EE[1]=0,$EE[2]=32<=$EO.width?1:$EO.width/32,$EE[3]=0,$EE[4]=32<=$EO.width?1:$EO.width/32,$EE[5]=32<=$EO.height?1:$EO.height/32,$EE[6]=0,$EE[7]=32<=$EO.height?1:$EO.height/32,$EO.width=32<=$EO.width?$EO.width:32,$EO.height=32<=$EO.height?$EO.height:32,$EE[1]*=-1,$EE[3]*=-1,$EE[5]*=-1,$EE[7]*=-1,$EE[1]+=1,$EE[3]+=1,$EE[5]+=1,$EE[7]+=1),$Ee.ctx.drawTarget($EG,$EL+$EO.x-$Eu.translateX,$E_+$EO.y-$Eu.translateY,$Ed,$Er,$EB.TEMP,"tmpTarget",$EV,$EE,6),$Ec=$EHM.create([$EG],laya.webgl.utils.RenderSprite3D.recycleTarget),$Ee.addRenderObject($Ec),($Eq=$EuM.create(6)).blendMode=$Ex,$Ee.addRenderObject($Eq)}$Ee.ctx.restore()}else $EH._fun.call($EH,$EM,$Ee,$EL,$E_)},$Ee._blend=function($EM,$Ee,$EL,$E_){var $Ec=$EM._style,$Eq=this._next;$Ec.blendMode?($Ee.ctx.save(),$Ee.ctx.globalCompositeOperation=$Ec.blendMode,$Eq._fun.call($Eq,$EM,$Ee,$EL,$E_),$Ee.ctx.restore()):$Eq._fun.call($Eq,$EM,$Ee,$EL,$E_)},$Ee._transform=function($EM,$Ee,$EL,$E_){var $Ec=$EM.transform,$Eq=this._next;if($Ec&&$Eq!=$EK.NORENDER){var $EH=$Ee.ctx;$EM._style;$Ec.tx=$EL,$Ec.ty=$E_;var $ET=$EH._getTransformMatrix(),$Ex=$ET.clone();$EB.mul($Ec,$ET,$ET),$ET._checkTransform(),$Ec.tx=$Ec.ty=0,$Eq._fun.call($Eq,$EM,$Ee,0,0),$Ex.copyTo($ET),$Ex.destroy()}else $Eq._fun.call($Eq,$EM,$Ee,$EL,$E_)},$E$.tmpTarget=function($EM,$Ee){var $EL=$EM.getValue("bounds"),$E_=$EjM.create($EL.width,$EL.height);$E_.start(),$E_.clear(0,0,0,0),$EM.addValue("tmpTarget",$E_)},$E$.endTmpTarget=function($EM){$EM.getValue("tmpTarget").end()},$E$.recycleTarget=function($EM){$EM.getValue("tmpTarget").recycle(),$EM.recycle()},$EH($E$,["tempUV",function(){return this.tempUV=new Array(8)}]),$E$}(),$EkM=function($EM){function $Ee(){this.data=null,$Ee.__super.call(this)}$EV($Ee,"laya.filters.webgl.ColorFilterActionGL",$EF);var $EL=$Ee.prototype;return $EW.imps($EL,{"laya.filters.IFilterActionGL":!0}),$EL.setValue=function($EM){$EM.colorMat=this.data._mat,$EM.colorAlpha=this.data._alpha},$EL.apply3d=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EM.getValue("bounds"),$EH=$EAM.create(1,0);$EH.setFilters([this.data]);var $ET=$EB.TEMP;$ET.identity(),$EL.ctx.drawTarget($EM,0,0,$Eq.width,$Eq.height,$ET,"src",$EH)},$Ee}(),$EhM=function($EM){function $Eq($EM,$Ee,$EL,$E_,$Ec){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$Eq.__super.call(this,$EM,$Ee,$Ec),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $EzM,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$EL,this._atlasCanvas.height=$E_,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$EV($Eq,"laya.webgl.atlas.Atlaser",$EJ);var $Ee=$Eq.prototype;return $Ee.computeUVinAtlasTexture=function($EM,$Ee,$EL,$E_){var $Ec=$Ew.atlasTextureWidth,$Eq=$Ew.atlasTextureHeight,$EH=$EL/$Ec,$ET=$E_/$Eq,$Ex=($EL+$EM.bitmap.width)/$Ec,$EO=($E_+$EM.bitmap.height)/$Eq,$Eu=$EM.bitmap.width/$Ec,$EG=$EM.bitmap.height/$Eq;$EM.uv=[$EH+$Ee[0]*$Eu,$ET+$Ee[1]*$EG,$Ex-(1-$Ee[2])*$Eu,$ET+$Ee[3]*$EG,$Ex-(1-$Ee[4])*$Eu,$EO-(1-$Ee[5])*$EG,$EH+$Ee[6]*$Eu,$EO-(1-$Ee[7])*$EG]},$Ee.findBitmapIsExist=function($EM){if($EM instanceof laya.webgl.resource.WebGLImage){var $Ee=$EM,$EL=$Ee.url,$E_=this._InAtlasWebGLImagesKey[$EL||$Ee.id];if($E_)return $E_.offsetInfoID}return-1},$Ee.addToAtlasTexture=function($EM,$Ee,$EL){if($EM instanceof laya.webgl.resource.WebGLImage){var $E_=$EM,$Ec=$E_.url;this._InAtlasWebGLImagesKey[$Ec||$E_.id]={bitmap:$EM,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$Ee,$EL])}this._atlasCanvas.texSubImage2D($Ee,$EL,$EM.atlasSource),$EM.clearAtlasSource()},$Ee.addToAtlas=function($EM,$Ee,$EL){$EM._atlasID=this._inAtlasTextureKey.length;var $E_=$EM.uv.slice(),$Ec=$EM.bitmap;this._inAtlasTextureKey.push($EM),this._inAtlasTextureOriUVValue.push($E_),this._inAtlasTextureBitmapValue.push($Ec),this.computeUVinAtlasTexture($EM,$E_,$Ee,$EL),$EM.bitmap=this._atlasCanvas},$Ee.clear=function(){for(var $EM=0,$Ee=this._inAtlasTextureKey.length;$EM<$Ee;$EM++)this._inAtlasTextureKey[$EM].bitmap=this._inAtlasTextureBitmapValue[$EM],this._inAtlasTextureKey[$EM].uv=this._inAtlasTextureOriUVValue[$EM],this._inAtlasTextureKey[$EM]._atlasID=-1,this._inAtlasTextureKey[$EM].bitmap.lock=!1,this._inAtlasTextureKey[$EM].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$Ee.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$E_(0,$Ee,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$E_(0,$Ee,"texture",function(){return this._atlasCanvas}),$E_(0,$Ee,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$Eq}(),$EtM=function($EM){function $EL(){$EL.__super.call(this,$EL.__name2int,$EL.__int2name,$EL.__int2nameMap)}return $EV($EL,"laya.webgl.shader.d2.ShaderDefines2D",$EI),$EL.__init__=function(){$EL.reg("TEXTURE2D",1),$EL.reg("COLOR2D",2),$EL.reg("PRIMITIVE",4),$EL.reg("GLOW_FILTER",8),$EL.reg("BLUR_FILTER",16),$EL.reg("COLOR_FILTER",32),$EL.reg("COLOR_ADD",64),$EL.reg("WORLDMAT",128),$EL.reg("FILLTEXTURE",256),$EL.reg("FSHIGHPRECISION",1024),$EL.reg("TXTALPHA",2048),$EL.reg("TXTCOMPRESS",4096)},$EL.reg=function($EM,$Ee){$EI._reg($EM,$Ee,$EL.__name2int,$EL.__int2name)},$EL.toText=function($EM,$Ee,$EL){return $EI._toText($EM,$Ee,$EL)},$EL.toInt=function($EM){return $EI._toInt($EM,$EL.__name2int)},$EL.TEXTURE2D=1,$EL.COLOR2D=2,$EL.PRIMITIVE=4,$EL.FILTERGLOW=8,$EL.FILTERBLUR=16,$EL.FILTERCOLOR=32,$EL.COLORADD=64,$EL.WORLDMAT=128,$EL.FILLTEXTURE=256,$EL.SKINMESH=512,$EL.SHADERDEFINE_FSHIGHPRECISION=1024,$EL.TXTALPHA=2048,$EL.TXTCOMPRESS=4096,$EL.__name2int={},$EL.__int2name=[],$EL.__int2nameMap=[],$EL}(),$ESM=(function($EM){function $ET($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$ET.__super.call(this,$EM,$Ee,$EL,$E_,40,$Ec,$Eq,$EH)}$EV($ET,"laya.webgl.shapes.Ellipse",$ELM)}(),function($EM){function $Eq($EM,$Ee,$EL,$E_,$Ec){this._points=[],this.rebuild($EL),$Eq.__super.call(this,$EM,$Ee,0,0,0,$Ec,$E_,$Ec,0)}$EV($Eq,"laya.webgl.shapes.Line",$ELM);var $Ee=$Eq.prototype;return $Ee.rebuild=function($EM){var $Ee=$EM.length;$Ee!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($Ee/2-1)),this.mFloat32Array=new Float32Array(5*$Ee)),this._points.length=0;for(var $EL=NaN,$E_=NaN,$Ec=-1,$Eq=-1,$EH=$EM.length/2,$ET=0;$ET<$EH;$ET++)$EL=$EM[2*$ET],$E_=$EM[2*$ET+1],(.01<Math.abs($Ec-$EL)||.01<Math.abs($Eq-$E_))&&this._points.push($EL,$E_),$Ec=$EL,$Eq=$E_},$Ee.getData=function($EM,$Ee,$EL){var $E_=[],$Ec=[];0<this.borderWidth&&this.createLine2(this._points,$E_,this.borderWidth,$EL,$Ec,this._points.length/2),this.mUint16Array.set($E_,0),this.mFloat32Array.set($Ec,0),$EM.append(this.mUint16Array),$Ee.append(this.mFloat32Array)},$Eq}()),$EpM=function($EM){function $EG($EM,$Ee,$EL,$E_,$Ec){this._points=[];for(var $Eq=NaN,$EH=NaN,$ET=-1,$Ex=-1,$EO=$EL.length/2-1,$Eu=0;$Eu<$EO;$Eu++)$Eq=$EL[2*$Eu],$EH=$EL[2*$Eu+1],(.01<Math.abs($ET-$Eq)||.01<Math.abs($Ex-$EH))&&this._points.push($Eq,$EH),$ET=$Eq,$Ex=$EH;$Eq=$EL[2*$EO],$EH=$EL[2*$EO+1],$ET=this._points[0],$Ex=this._points[1],(.01<Math.abs($ET-$Eq)||.01<Math.abs($Ex-$EH))&&this._points.push($Eq,$EH),$EG.__super.call(this,$EM,$Ee,0,0,this._points.length/2,0,$E_,$Ec)}$EV($EG,"laya.webgl.shapes.LoopLine",$ELM);var $Ee=$EG.prototype;return $Ee.getData=function($EM,$Ee,$EL){if(0<this.borderWidth){for(var $E_=this.color,$Ec=($E_>>16&255)/255,$Eq=($E_>>8&255)/255,$EH=(255&$E_)/255,$ET=[],$Ex=0,$EO=0,$Eu=[],$EG=Math.floor(this._points.length/2),$EV=0;$EV<$EG;$EV++)$Ex=this._points[2*$EV],$EO=this._points[2*$EV+1],$ET.push(this.x+$Ex,this.y+$EO,$Ec,$Eq,$EH);this.createLoopLine($ET,$Eu,this.borderWidth,$EL+$ET.length/5),$EM.append(new Uint16Array($Eu)),$Ee.append(new Float32Array($ET))}},$Ee.createLoopLine=function($EM,$Ee,$EL,$E_,$Ec,$Eq){$EM.length;var $EH=$EM.concat(),$ET=$Ec||$EM,$Ex=this.borderColor,$EO=($Ex>>16&255)/255,$Eu=($Ex>>8&255)/255,$EG=(255&$Ex)/255,$EV=[$EH[0],$EH[1]],$EE=[$EH[$EH.length-5],$EH[$EH.length-4]],$Ed=$EE[0]+.5*($EV[0]-$EE[0]),$Er=$EE[1]+.5*($EV[1]-$EE[1]);$EH.unshift($Ed,$Er,0,0,0),$EH.push($Ed,$Er,0,0,0);var $E$,$EC,$EK,$EX,$Eo,$Ei,$EW,$Ey,$EA,$EB,$Ek,$Eh,$Et,$ES,$Ep,$ER,$Ea,$En,$El,$Ef,$Ej=$EH.length/5,$EF=$E_,$Eg=$EL/2;$EK=$EH[0],$EX=$EH[1],$EB=$EK-($Eo=$EH[5]),$EA=($EA=-($EX-($Ei=$EH[6])))/($Ef=Math.sqrt($EA*$EA+$EB*$EB))*$Eg,$EB=$EB/$Ef*$Eg,$ET.push($EK-$EA,$EX-$EB,$EO,$Eu,$EG,$EK+$EA,$EX+$EB,$EO,$Eu,$EG);for(var $EJ=1;$EJ<$Ej-1;$EJ++)$EK=$EH[5*($EJ-1)],$EX=$EH[5*($EJ-1)+1],$Eo=$EH[5*$EJ],$Ei=$EH[5*$EJ+1],$EW=$EH[5*($EJ+1)],$Ey=$EH[5*($EJ+1)+1],$EB=$EK-$Eo,$Eh=$Eo-$EW,$Ep=(-($EA=($EA=-($EX-$Ei))/($Ef=Math.sqrt($EA*$EA+$EB*$EB))*$Eg)+$EK)*(-($EB=$EB/$Ef*$Eg)+$Ei)-(-$EA+$Eo)*(-$EB+$EX),$En=(-($Ek=($Ek=-($Ei-$Ey))/($Ef=Math.sqrt($Ek*$Ek+$Eh*$Eh))*$Eg)+$EW)*(-($Eh=$Eh/$Ef*$Eg)+$Ei)-(-$Ek+$Eo)*(-$Eh+$Ey),$El=($Et=-$EB+$EX-(-$EB+$Ei))*($Ea=-$Ek+$Eo-(-$Ek+$EW))-($ER=-$Eh+$Ey-(-$Eh+$Ei))*($ES=-$EA+$Eo-(-$EA+$EK)),Math.abs($El)<.1?($El+=10.1,$ET.push($Eo-$EA,$Ei-$EB,$EO,$Eu,$EG,$Eo+$EA,$Ei+$EB,$EO,$Eu,$EG)):((($E$=($ES*$En-$Ea*$Ep)/$El)-$Eo)*($E$-$Eo)+(($EC=($ER*$Ep-$Et*$En)/$El)-$Ei)+($EC-$Ei),$ET.push($E$,$EC,$EO,$Eu,$EG,$Eo-($E$-$Eo),$Ei-($EC-$Ei),$EO,$Eu,$EG));$Eq&&($Ee=$Eq);var $Ew=this.edges+1;for($EJ=1;$EJ<$Ew;$EJ++)$Ee.push($EF+2*($EJ-1),$EF+2*($EJ-1)+1,$EF+2*$EJ+1,$EF+2*$EJ+1,$EF+2*$EJ,$EF+2*($EJ-1));return $Ee.push($EF+2*($EJ-1),$EF+2*($EJ-1)+1,$EF+1,$EF+1,$EF,$EF+2*($EJ-1)),$ET},$EG}(),$ERM=function($EM){function $EH($EM,$Ee,$EL,$E_,$Ec,$Eq){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$EB.create(),this._points=$EL.slice(0,$EL.length),$EH.__super.call(this,$EM,$Ee,0,0,this._points.length/2,$E_,$Ec,$Eq)}$EV($EH,"laya.webgl.shapes.Polygon",$ELM);var $Ee=$EH.prototype;return $Ee.rebuild=function($EM){this._repaint||(this._points.length=0,this._points=this._points.concat($EM))},$Ee.setMatrix=function($EM){$EM.copyTo(this._mat)},$Ee.needUpdate=function($EM){return this._repaint=this._mat.a==$EM.a&&this._mat.b==$EM.b&&this._mat.c==$EM.c&&this._mat.d==$EM.d&&this._mat.tx==$EM.tx&&this._mat.ty==$EM.ty,!this._repaint},$Ee.getData=function($EM,$Ee,$EL){var $E_,$Ec=0,$Eq=this._points,$EH=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$EL){for(this._start=$EL,$E_=[],$EH=this.earcutTriangles.length,$Ec=0;$Ec<$EH;$Ec++)$E_.push(this.earcutTriangles[$Ec]+$EL);this.mUint16Array=new Uint16Array($E_)}}else{this._start=$EL,$E_=[];var $ET=[],$Ex=[],$EO=this.color,$Eu=($EO>>16&255)/255,$EG=($EO>>8&255)/255,$EV=(255&$EO)/255;for($EH=Math.floor($Eq.length/2),$Ec=0;$Ec<$EH;$Ec++)$ET.push(this.x+$Eq[2*$Ec],this.y+$Eq[2*$Ec+1],$Eu,$EG,$EV),$Ex.push(this.x+$Eq[2*$Ec],this.y+$Eq[2*$Ec+1]);for(this.earcutTriangles=$E_M.earcut($Ex,null,2),$EH=this.earcutTriangles.length,$Ec=0;$Ec<$EH;$Ec++)$E_.push(this.earcutTriangles[$Ec]+$EL);this.mUint16Array=new Uint16Array($E_),this.mFloat32Array=new Float32Array($ET)}$EM.append(this.mUint16Array),$Ee.append(this.mFloat32Array)},$EH}(),$EaM=function($EM){function $Eq(){this._matrix=new $EB,this._matrix4=$ErM.defaultMatrix4.concat(),$Eq.__super.call(this,1e4),this.shaderValue=new $EAM(0,0)}$EV($Eq,"laya.webgl.submit.SubmitCanvas",$EqM);var $Ee=$Eq.prototype;return $Ee.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $EM=$EKM.worldAlpha,$Ee=$EKM.worldMatrix4,$EL=$EKM.worldMatrix,$E_=$EKM.worldFilters,$Ec=$EKM.worldShaderDefines,$Eq=this.shaderValue,$EH=this._matrix,$ET=this._matrix4,$Ex=$EB.TEMP;return $EB.mul($EH,$EL,$Ex),$ET[0]=$Ex.a,$ET[1]=$Ex.b,$ET[4]=$Ex.c,$ET[5]=$Ex.d,$ET[12]=$Ex.tx,$ET[13]=$Ex.ty,$EKM.worldMatrix=$Ex.clone(),$EKM.worldMatrix4=$ET,$EKM.worldAlpha=$EKM.worldAlpha*$Eq.alpha,$Eq.filters&&$Eq.filters.length&&($EKM.worldFilters=$Eq.filters,$EKM.worldShaderDefines=$Eq.defines),this._ctx_src.flush(),$EKM.worldAlpha=$EM,$EKM.worldMatrix4=$Ee,$EKM.worldMatrix.destroy(),$EKM.worldMatrix=$EL,$EKM.worldFilters=$E_,$EKM.worldShaderDefines=$Ec,1},$Ee.releaseRender=function(){var $EM=$Eq._cache;this._ctx_src=null,$EM[$EM._length++]=this},$Ee.getRenderType=function(){return 10003},$Eq.create=function($EM,$Ee,$EL){var $E_=$Eq._cache._length?$Eq._cache[--$Eq._cache._length]:new $Eq;$E_._ctx_src=$EM;var $Ec=$E_.shaderValue;return $Ec.alpha=$Ee,$Ec.defines.setValue(0),$EL&&$EL.length&&$Ec.setFilters($EL),$E_},$Eq._cache=(($Eq._cache=[])._length=0,$Eq._cache),$Eq}(),$EnM=function($EM){function $EO($EM){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$EM&&($EM=1e4),$EO.__super.call(this,$EM)}$EV($EO,"laya.webgl.submit.SubmitTexture",$EqM);var $Ee=$EO.prototype;return $Ee.releaseRender=function(){var $EM=$EO._cache;($EM[$EM._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$Ee.addTexture=function($EM,$Ee){this._texsID[this._texs.length]=$EM._uvID,this._texs.push($EM),this._vbPos.push($Ee)},$Ee.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $EM=this.shaderValue.textureHost.bitmap;if(null!==$EM)for(var $Ee=this._vb.getFloat32Array(),$EL=0,$E_=this._texs.length;$EL<$E_;$EL++){var $Ec=this._texs[$EL];$Ec.active();var $Eq=$Ec.uv;if(this._texsID[$EL]!==$Ec._uvID){this._texsID[$EL]=$Ec._uvID;var $EH=this._vbPos[$EL];$Ee[$EH+2]=$Eq[0],$Ee[$EH+3]=$Eq[1],$Ee[$EH+6]=$Eq[2],$Ee[$EH+7]=$Eq[3],$Ee[$EH+10]=$Eq[4],$Ee[$EH+11]=$Eq[5],$Ee[$EH+14]=$Eq[6],$Ee[$EH+15]=$Eq[7],this._vb.setNeedUpload()}$Ec.bitmap!==$EM&&(this._isSameTexture=!1)}}},$Ee.renderSubmit=function(){if(0===this._numEle)return $EO._shaderSet=!1,1;var $EM=this.shaderValue.textureHost;if($EM){var $Ee=$EM.source;if(!$EM.bitmap||!$Ee)return $EO._shaderSet=!1,1;this.shaderValue.texture=$Ee,$EM.alphaTexture&&$EM.alphaTexture.source&&(this.shaderValue.texture1=$EM.alphaTexture.source)}this._vb.bind_upload(this._ib);var $EL=$EoM.mainContext;if($Em.activeBlendFunction!==this._blendFn&&($EL.enable(3042),this._blendFn($EL),$Em.activeBlendFunction=this._blendFn),$Ep.drawCall++,$Ep.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$EfM.activeShader&&$EO._shaderSet?($EfM.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$EfM.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$EO._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $E_=$EM.bitmap,$Ec=0,$Eq=$EfM.activeShader,$EH=0,$ET=this._texs.length;$EH<$ET;$EH++){var $Ex=this._texs[$EH];$Ex.bitmap===$E_&&$EH+1!==$ET||($Eq.uploadTexture2D($Ex.source),$EL.drawElements(4,6*($EH-$Ec+1),5123,this._startIdx+6*$Ec*$ErM.BYTES_PIDX),$E_=$Ex.bitmap,$Ec=$EH)}else $EL.drawElements(4,this._numEle,5123,this._startIdx);return 1},$EO.create=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EO._cache._length?$EO._cache[--$EO._cache._length]:new $EO;null==$EL&&(($EL=$Eq._selfVb||($Eq._selfVb=$EIM.create(-1))).clear(),$E_=0),$Eq._ib=$Ee,$Eq._vb=$EL,$Eq._startIdx=$E_*$ErM.BYTES_PIDX,$Eq._numEle=0;var $EH=$EM._nBlendType;$Eq._blendFn=$EM._targets?$Em.targetFns[$EH]:$Em.fns[$EH],$Eq.shaderValue=$Ec,$Eq.shaderValue.setValue($EM._shader2D);var $ET=$EM._shader2D.filters;return $ET&&$Eq.shaderValue.setFilters($ET),$Eq},$EO._cache=(($EO._cache=[])._length=0,$EO._cache),$EO._shaderSet=!0,$EO}(),$ElM=function($EM){function $EC(){$EC.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$EV($EC,"laya.webgl.utils.MeshTexture",$ECM);var $Ee=$EC.prototype;return $Ee.addData=function($EM,$Ee,$EL,$E_,$Ec,$Eq){for(var $EH=$EM.length/2,$ET=this._vb.needSize($EH*$EC.const_stride)>>2,$Ex=this._vb.getFloat32Array(),$EO=0,$Eu=0;$Eu<$EH;$Eu++){var $EG=$EM[$EO],$EV=$EM[$EO+1],$EE=$EG*$E_.a+$EV*$E_.c+$E_.tx,$Ed=$EG*$E_.b+$EV*$E_.d+$E_.ty;$Ex[$ET++]=$EE,$Ex[$ET++]=$Ed,$Ex[$ET++]=$Ee[$EO],$Ex[$ET++]=$Ee[$EO+1],$EO+=2}this._vb.setNeedUpload();var $Er=this.vertNum;if(0<$Er){($EH=$EL.length)>$EC.tmpIdx.length&&($EC.tmpIdx=new Uint16Array($EH));for(var $E$=0;$E$<$EH;$E$++)$EC.tmpIdx[$E$]=$EL[$E$]+$Er;this._ib.appendU16Array($EC.tmpIdx,$EL.length)}else this._ib.append($EL);this._ib.setNeedUpload(),this.vertNum+=$EH,this.indexNum+=$EL.length},$Ee.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$Ee.destroy=function(){this._ib.destroy(),this._vb.destroy()},$EC.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $EC},$EC.const_stride=16,$EC._POOL=[],$EH($EC,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$EC}(),$EfM=function($EM){function $Ee(){$Ee.__super.call(this),this.lock=!0}return $EV($Ee,"laya.webgl.shader.BaseShader",$EX),$Ee.activeShader=null,$Ee.bindShader=null,$Ee}(),$EjM=function($Ee){function $Eu($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$EL&&($EL=6408),void 0===$E_&&($E_=5121),void 0===$Ec&&($Ec=34041),void 0===$Eq&&($Eq=!1),void 0===$EH&&($EH=!1),void 0===$ET&&($ET=-1),void 0===$Ex&&($Ex=-1),this._type=1,this._w=$EM,this._h=$Ee,this._surfaceFormat=$EL,this._surfaceType=$E_,this._depthStencilFormat=$Ec,$EC.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$Eq,this._repeat=$EH,this._minFifter=$ET,this._magFifter=$Ex,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$Eu.__super.call(this,this.bitmap,$El.INV_UV)}$EV($Eu,"laya.webgl.resource.RenderTarget2D",$Ee);var $EM=$Eu.prototype;return $EW.imps($EM,{"laya.resource.IDispose":!0}),$EM.getType=function(){return this._type},$EM.getTexture=function(){return this},$EM.size=function($EM,$Ee){this._w==$EM&&this._h==$Ee||(this._w=$EM,this._h=$Ee,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$EM.release=function(){this.destroy()},$EM.recycle=function(){$Eu.POOL.push(this)},$EM.start=function(){var $EM=$EoM.mainContext;return this._preRenderTarget=$EKM.curRenderTarget,$EKM.curRenderTarget=this,$EM.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($EM.viewport(0,0,this._w,this._h),this._svWidth=$EKM.width,this._svHeight=$EKM.height,$EKM.width=this._w,$EKM.height=this._h,$EfM.activeShader=null),this},$EM.clear=function($EM,$Ee,$EL,$E_){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=1);var $Ec=$EoM.mainContext;$Ec.clearColor($EM,$Ee,$EL,$E_);var $Eq=16384;switch(this._depthStencilFormat){case 33189:$Eq|=256;break;case 36168:$Eq|=1024;break;case 34041:$Eq|=256,$Eq|=1024}$Ec.clear($Eq)},$EM.end=function(){var $EM=$EoM.mainContext;$EM.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$EKM.curRenderTarget=this._preRenderTarget,1==this._type?($EM.viewport(0,0,this._svWidth,this._svHeight),$EKM.width=this._svWidth,$EKM.height=this._svHeight,$EfM.activeShader=null):$EM.viewport(0,0,$EW.stage.width,$EW.stage.height)},$EM.getData=function($EM,$Ee,$EL,$E_){var $Ec=$EoM.mainContext;if($Ec.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$Ec.checkFramebufferStatus(36160)))return $Ec.bindFramebuffer(36160,null),null;var $Eq=new Uint8Array(this._w*this._h*4);return $Ec.readPixels($EM,$Ee,$EL,$E_,this._surfaceFormat,this._surfaceType,$Eq),$Ec.bindFramebuffer(36160,null),$Eq},$EM.destroy=function($EM){void 0===$EM&&($EM=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$Ee.prototype.destroy.call(this))},$EM.dispose=function(){},$EM._createWebGLRenderTarget=function(){this.bitmap=new $EPM(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($EM){this.event("recovered")})},$E_(0,$EM,"surfaceFormat",function(){return this._surfaceFormat}),$E_(0,$EM,"magFifter",function(){return this._magFifter}),$E_(0,$EM,"surfaceType",function(){return this._surfaceType}),$E_(0,$EM,"mipMap",function(){return this._mipMap}),$E_(0,$EM,"depthStencilFormat",function(){return this._depthStencilFormat}),$E_(0,$EM,"minFifter",function(){return this._minFifter}),$E_(0,$EM,"source",function(){return this._alreadyResolved?$EW.superGet($El,this,"source"):null}),$Eu.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){void 0===$EL&&($EL=6408),void 0===$E_&&($E_=5121),void 0===$Ec&&($Ec=34041),void 0===$Eq&&($Eq=!1),void 0===$EH&&($EH=!1),void 0===$ET&&($ET=-1),void 0===$Ex&&($Ex=-1);var $EO=$Eu.POOL.pop();return $EO||($EO=new $Eu($EM,$Ee)),$EO.bitmap&&$EO._w==$EM&&$EO._h==$Ee&&$EO._surfaceFormat==$EL&&$EO._surfaceType==$E_&&$EO._depthStencilFormat==$Ec&&$EO._mipMap==$Eq&&$EO._repeat==$EH&&$EO._minFifter==$ET&&$EO._magFifter==$Ex||($EO._w=$EM,$EO._h=$Ee,$EO._surfaceFormat=$EL,$EO._surfaceType=$E_,$EO._depthStencilFormat=$Ec,$EC.isConchWebGL&&34041===$EO._depthStencilFormat&&($EO._depthStencilFormat=33189),$EO._mipMap=$Eq,$EO._repeat=$EH,$EO._minFifter=$ET,$EO._magFifter=$Ex,$EO.release(),$EO._createWebGLRenderTarget()),$EO},$Eu.TYPE2D=1,$Eu.TYPE3D=2,$Eu.POOL=[],$Eu}($El),$EFM=function($EM){function $Ee(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$Ee.__super.call(this),$Ee._gl=$EoM.mainContext}$EV($Ee,"laya.webgl.utils.Buffer",$EX);var $EL=$Ee.prototype;return $EL._bind=function(){this.activeResource(),$Ee._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($Ee._bindVertexBuffer=this._glBuffer),$Ee._gl.bindBuffer(this._bufferType,$Ee._bindActive[this._bufferType]=this._glBuffer),$EfM.activeShader=null)},$EL.recreateResource=function(){this._glBuffer||(this._glBuffer=$Ee._gl.createBuffer()),this.completeCreate()},$EL.disposeResource=function(){this._glBuffer&&($EoM.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$E_(0,$EL,"bufferUsage",function(){return this._bufferUsage}),$Ee._gl=null,$Ee._bindActive={},$Ee._bindVertexBuffer=null,$Ee._enableAtributes=[],$Ee}(),$EgM=function($EM){function $EL($EM){this.texcoord=null,this.offsetX=300,this.offsetY=0,$EL.__super.call(this,512,0);var $Ee=8*$ErM.BYTES_PE;this.position=[2,5126,!1,$Ee,0],this.texcoord=[2,5126,!1,$Ee,2*$ErM.BYTES_PE],this.color=[4,5126,!1,$Ee,4*$ErM.BYTES_PE]}return $EV($EL,"laya.webgl.shader.d2.skinAnishader.SkinSV",$EAM),$EL}(),$EJM=function($EM){function $Ee($EM){$Ee.__super.call(this,2,0),this.color=[]}return $EV($Ee,"laya.webgl.shader.d2.value.Color2dSV",$EAM),$Ee.prototype.setValue=function($EM){$EM.fillStyle&&(this.color=$EM.fillStyle._color._color),$EM.strokeStyle&&(this.color=$EM.strokeStyle._color._color)},$Ee}(),$EwM=function($EM){function $Ee($EM){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$EAM._TEXCOORD,$Ee.__super.call(this,256,0)}$EV($Ee,"laya.webgl.shader.d2.value.FillTextureSV",$EAM);var $EL=$Ee.prototype;return $EL.setValue=function($EM){this.ALPHA=$EM.ALPHA,$EM.filters&&this.setFilters($EM.filters)},$EL.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$Ee}(),$EbM=function($EM){function $Ee($EM){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$EAM._TEXCOORD,void 0===$EM&&($EM=0),$Ee.__super.call(this,1,$EM)}$EV($Ee,"laya.webgl.shader.d2.value.TextureSV",$EAM);var $EL=$Ee.prototype;return $EL.setValue=function($EM){this.ALPHA=$EM.ALPHA,$EM.filters&&this.setFilters($EM.filters)},$EL.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$Ee}(),$EmM=function($EM){function $Ee($EM){this.a_color=null,this.u_pos=[0,0],$Ee.__super.call(this,4,0),this.position=[2,5126,!1,5*$ErM.BYTES_PE,0],this.a_color=[3,5126,!1,5*$ErM.BYTES_PE,2*$ErM.BYTES_PE]}return $EV($Ee,"laya.webgl.shader.d2.value.PrimitiveSV",$EAM),$Ee}(),$EzM=function($EM){function $Ee(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$Ee.__super.call(this)}$EV($Ee,"laya.webgl.atlas.AtlasWebGLCanvas",$EM);var $EL=$Ee.prototype;return $EL.recreateResource=function(){var $EM=$EoM.mainContext,$Ee=this._source=$EM.createTexture(),$EL=$EiM.curBindTexTarget,$E_=$EiM.curBindTexValue;$EiM.bindTexture($EM,3553,$Ee),$EM.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$EM.texParameteri(3553,10241,9729),$EM.texParameteri(3553,10240,9729),$EM.texParameteri(3553,10242,33071),$EM.texParameteri(3553,10243,33071),$EL&&$E_&&$EiM.bindTexture($EM,$EL,$E_),this.memorySize=this._w*this._h*4,this.completeCreate()},$EL.disposeResource=function(){this._source&&($EoM.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$EL.texSubImage2D=function($EM,$Ee,$EL){if($EC.isFlash){this._flashCacheImage||(this._flashCacheImage=$Er.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $E_=$EL.bitmapdata;this._flashCacheImage._image.copyPixels($E_,0,0,$E_.width,$E_.height,$EM,$Ee),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $Ec=$EoM.mainContext,$Eq=$EiM.curBindTexTarget,$EH=$EiM.curBindTexValue;$EiM.bindTexture($Ec,3553,this._source),$Ec.pixelStorei(37441,!0),0<=$EM-1&&$Ec.texSubImage2D(3553,0,$EM-1,$Ee,6408,5121,$EL),$EM+1<=this._w&&$Ec.texSubImage2D(3553,0,$EM+1,$Ee,6408,5121,$EL),0<=$Ee-1&&$Ec.texSubImage2D(3553,0,$EM,$Ee-1,6408,5121,$EL),$Ee+1<=this._h&&$Ec.texSubImage2D(3553,0,$EM,$Ee+1,6408,5121,$EL),$Ec.texSubImage2D(3553,0,$EM,$Ee,6408,5121,$EL),$Ec.pixelStorei(37441,!1),$Eq&&$EH&&$EiM.bindTexture($Ec,$Eq,$EH)}},$EL.texSubImage2DPixel=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EoM.mainContext,$EH=$EiM.curBindTexTarget,$ET=$EiM.curBindTexValue;$EiM.bindTexture($Eq,3553,this._source);var $Ex=new Uint8Array($Ec.data);$Eq.pixelStorei(37441,!0),$Eq.texSubImage2D(3553,0,$EM,$Ee,$EL,$E_,6408,5121,$Ex),$Eq.pixelStorei(37441,!1),$EH&&$ET&&$EiM.bindTexture($Eq,$EH,$ET)},$E_(0,$EL,"width",$EM.prototype._$get_width,function($EM){this._w=$EM}),$E_(0,$EL,"height",$EM.prototype._$get_height,function($EM){this._h=$EM}),$Ee}($EL),$EQM=function($EM){function $Ec(){this.flipY=!0,this.alwaysChange=!1,$Ec.__super.call(this)}$EV($Ec,"laya.webgl.resource.WebGLCanvas",$EL);var $Ee=$Ec.prototype;return $Ee.getCanvas=function(){return this._canvas},$Ee.clear=function(){this._ctx&&this._ctx.clear()},$Ee.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$Ee._setContext=function($EM){this._ctx=$EM},$Ee.getContext=function($EM,$Ee){return this._ctx?this._ctx:this._ctx=$Ec._createContext(this)},$Ee.size=function($EM,$Ee){this._w==$EM&&this._h==$Ee||(this._w=$EM,this._h=$Ee,this._ctx&&this._ctx.size($EM,$Ee),this._canvas&&(this._canvas.height=$Ee,this._canvas.width=$EM))},$Ee.activeResource=function($EM){void 0===$EM&&($EM=!1),this._source||this.recreateResource()},$Ee.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$Ee.disposeResource=function(){this._source&&!this.iscpuSource&&($EoM.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$Ee.createWebGlTexture=function(){var $EM=$EoM.mainContext;this._canvas;var $Ee=this._source=$EM.createTexture();this.iscpuSource=!1;var $EL=$EiM.curBindTexTarget,$E_=$EiM.curBindTexValue;$EiM.bindTexture($EM,3553,$Ee),$EM.pixelStorei(37440,this.flipY?1:0),$Ec.premulAlpha&&$EM.pixelStorei(37441,!0),$EM.texImage2D(3553,0,6408,6408,5121,this._imgData),$Ec.premulAlpha&&$EM.pixelStorei(37441,!1),$EM.texParameteri(3553,10240,9729),$EM.texParameteri(3553,10241,9729),$EM.texParameteri(3553,10242,33071),$EM.texParameteri(3553,10243,33071),$EM.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$EL&&$E_&&$EiM.bindTexture($EM,$EL,$E_)},$Ee.reloadCanvasData=function(){var $EM=$EoM.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $Ee=$EiM.curBindTexTarget,$EL=$EiM.curBindTexValue;$EiM.bindTexture($EM,3553,this._source),$Ec.premulAlpha&&$EM.pixelStorei(37441,!0),$EM.texImage2D(3553,0,6408,6408,5121,this._imgData),$Ec.premulAlpha&&$EM.pixelStorei(37441,!1),$EM.pixelStorei(37440,0),$Ee&&$EL&&$EiM.bindTexture($EM,$Ee,$EL)},$Ee.texSubImage2D=function($EM,$Ee,$EL){var $E_=$EoM.mainContext,$Ec=$EiM.curBindTexTarget,$Eq=$EiM.curBindTexValue;$EiM.bindTexture($E_,3553,this._source),$E_.pixelStorei(37441,!0),$E_.texSubImage2D(3553,0,$Ee,$EL,6408,5121,$EM._source),$E_.pixelStorei(37441,!1),$Ec&&$Eq&&$EiM.bindTexture($E_,$Ec,$Eq)},$Ee.toBase64=function($EM,$Ee,$EL){var $E_=null;this._canvas&&($E_=this._canvas.toDataURL($EM,$Ee)),$EL.call(this,$E_)},$E_(0,$Ee,"context",function(){return this._ctx}),$E_(0,$Ee,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$E_(0,$Ee,"asBitmap",null,function($EM){this._ctx&&(this._ctx.asBitmap=$EM)}),$Ec._createContext=null,$Ec.premulAlpha=!1,$Ec}(),$EYM=function($EM){function $Eq($EM,$Ee){this.CborderSize=12,$Eq.__super.call(this),this.char=$EM,this.isSpace=" "===$EM,this.xs=$Ee.scaleX,this.ys=$Ee.scaleY,this.font=$Ee.font.toString(),this.fontSize=$Ee.font.size,this.fillColor=$Ee.fillColor,this.borderColor=$Ee.borderColor,this.lineWidth=$Ee.lineWidth,this.underLine=$Ee.underLine;var $EL,$E_=$EC.isConchApp;$E_?(($EL=ConchTextCanvas)._source=ConchTextCanvas,$EL._source.canvas=ConchTextCanvas):$EL=$EE.canvas.source,this.canvas=$EL,this._enableMerageInAtlas=!0,this._ctx=$E_?$EL:this.canvas.getContext("2d",void 0);var $Ec=$Ef.measureText(this.char,this.font);this.cw=$Ec.width*this.xs,this.ch=($Ec.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $El(this)}$EV($Eq,"laya.webgl.resource.WebGLCharImage",$EL);var $Ee=$Eq.prototype;return $EW.imps($Ee,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$Ee.active=function(){this.texture.active()},$Ee.recreateResource=function(){var $EM=$EC.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$EM){var $Ee=this.fontSize;1==this.xs&&1==this.ys||($Ee=parseInt($Ee*(this.xs>this.ys?this.xs:this.ys)+""));var $EL="normal 100 "+this.font;$EL=$EL.replace($Eq._fontSizeReg,$Ee),this.borderColor&&($EL+=" 1 "+this.borderColor),this._ctx.font=$EL,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$En.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $E_=this._ctx.measureText(this.char);$E_||($E_={width:16});var $Ec=$E_.width+1;this._ctx.lineTo($Ec,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$Ee.onresize=function($EM,$Ee){this._w=$EM,this._h=$Ee,this._allowMerageInAtlas=!0},$Ee.clearAtlasSource=function(){},$E_(0,$Ee,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$E_(0,$Ee,"atlasSource",function(){return this.canvas}),$E_(0,$Ee,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($EM){this._enableMerageInAtlas=$EM}),$Eq.createOneChar=function($EM,$Ee){return new $Eq($EM,$Ee)},$Eq._fontSizeReg=new RegExp("\\d+(?=px)","g"),$Eq}(),$EPM=function($EM){function $EO($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){void 0===$EL&&($EL=6408),void 0===$E_&&($E_=5121),void 0===$Ec&&($Ec=34041),void 0===$Eq&&($Eq=!1),void 0===$EH&&($EH=!1),void 0===$ET&&($ET=-1),void 0===$Ex&&($Ex=1),$EO.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$EM,this._h=$Ee,this._surfaceFormat=$EL,this._surfaceType=$E_,this._depthStencilFormat=$Ec,this._mipMap=$Eq,this._repeat=$EH,this._minFifter=$ET,this._magFifter=$Ex}$EV($EO,"laya.webgl.resource.WebGLRenderTarget",$EL);var $Ee=$EO.prototype;return $Ee.recreateResource=function(){var $EM=$EoM.mainContext;this._frameBuffer||(this._frameBuffer=$EM.createFramebuffer()),this._source||(this._source=$EM.createTexture());var $Ee=$EiM.curBindTexTarget,$EL=$EiM.curBindTexValue;$EiM.bindTexture($EM,3553,this._source),$EM.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $E_=this._minFifter,$Ec=this._magFifter,$Eq=this._repeat?10497:33071,$EH=$Eu.isPOT(this._w,this._h);if($EH?(this._mipMap?-1!==$E_||($E_=9987):-1!==$E_||($E_=9729),-1!==$Ec||($Ec=9729),$EM.texParameteri(3553,10241,$E_),$EM.texParameteri(3553,10240,$Ec),$EM.texParameteri(3553,10242,$Eq),$EM.texParameteri(3553,10243,$Eq),this._mipMap&&$EM.generateMipmap(3553)):(-1!==$E_||($E_=9729),-1!==$Ec||($Ec=9729),$EM.texParameteri(3553,10241,$E_),$EM.texParameteri(3553,10240,$Ec),$EM.texParameteri(3553,10242,33071),$EM.texParameteri(3553,10243,33071)),$EM.bindFramebuffer(36160,this._frameBuffer),$EM.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$EM.createRenderbuffer()),$EM.bindRenderbuffer(36161,this._depthStencilBuffer),$EM.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$EM.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$EM.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$EM.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$EM.bindFramebuffer(36160,null),$Ee&&$EL&&$EiM.bindTexture($EM,$Ee,$EL),$EM.bindRenderbuffer(36161,null),$EH&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$Ee.disposeResource=function(){this._frameBuffer&&($EoM.mainContext.deleteTexture(this._source),$EoM.mainContext.deleteFramebuffer(this._frameBuffer),$EoM.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},$E_(0,$Ee,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$E_(0,$Ee,"frameBuffer",function(){return this._frameBuffer}),$EO}(),$EZM=function($EM){function $ET($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this.offsetX=0,this.offsetY=0,$ET.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$Eq,this.canvas=$EM,this._ctx=$EM.getContext("2d",void 0),this._w=$E_,this._h=$Ec,this.offsetX=$Ee,this.offsetY=$EL,this.src=$EH,this._enableMerageInAtlas=!0,$Ew.enabled&&this._w<$Ew.atlasLimitWidth&&this._h<$Ew.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$EV($ET,"laya.webgl.resource.WebGLSubImage",$EL);var $Ee=$ET.prototype;return $EW.imps($Ee,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$Ee.size=function($EM,$Ee){this._w=$EM,this._h=$Ee,this._ctx&&this._ctx.size($EM,$Ee),this.canvas&&(this.canvas.height=$Ee,this.canvas.width=$EM)},$Ee.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$Ee.createWebGlTexture=function(){var $EM=$EoM.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $Ee=this._source=$EM.createTexture(),$EL=$EiM.curBindTexTarget,$E_=$EiM.curBindTexValue;$EiM.bindTexture($EM,3553,$Ee),$EM.pixelStorei(37441,!0),$EM.texImage2D(3553,0,6408,6408,5121,this.canvas),$EM.pixelStorei(37441,!1);var $Ec=this.minFifter,$Eq=this.magFifter,$EH=this.repeat?10497:33071,$ET=$Eu.isPOT(this.width,this.height);$ET?(this.mipmap?-1!==$Ec||($Ec=9987):-1!==$Ec||($Ec=9729),-1!==$Eq||($Eq=9729),$EM.texParameteri(3553,10240,$Eq),$EM.texParameteri(3553,10241,$Ec),$EM.texParameteri(3553,10242,$EH),$EM.texParameteri(3553,10243,$EH),this.mipmap&&$EM.generateMipmap(3553)):(-1!==$Ec||($Ec=9729),-1!==$Eq||($Eq=9729),$EM.texParameteri(3553,10241,$Ec),$EM.texParameteri(3553,10240,$Eq),$EM.texParameteri(3553,10242,33071),$EM.texParameteri(3553,10243,33071)),$EL&&$E_&&$EiM.bindTexture($EM,$EL,$E_),this.canvas=null,$ET&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$Ee.disposeResource=function(){$Ew.enabled&&this._allowMerageInAtlas||!this._source||($EoM.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$Ee.clearAtlasSource=function(){},$E_(0,$Ee,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$E_(0,$Ee,"atlasSource",function(){return this.canvas}),$E_(0,$Ee,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($EM){this._allowMerageInAtlas=$EM}),$ET}(),$EvM=function($EM){function $EO($EM,$Ee,$EL,$E_){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$EO.__super.call(this),!$EM||!$Ee)throw"Shader Error";this._id=++$EO._count,this._vs=$EM,this._ps=$Ee,this._nameMap=$E_||{},null!=$EL&&($EO.sharders[$EL]=this)}$EV($EO,"laya.webgl.shader.Shader",$EfM);var $Ee=$EO.prototype;return $Ee.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$Ee.disposeResource=function(){$EoM.mainContext.deleteShader(this._vshader),$EoM.mainContext.deleteShader(this._pshader),$EoM.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$Ee._compile=function(){if(!$EoM.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $EM=[this._vs,this._ps],$Ee=$EoM.mainContext;if(this._program=$Ee.createProgram(),this._vshader=$EO._createShader($Ee,$EM[0],35633),this._pshader=$EO._createShader($Ee,$EM[1],35632),$Ee.attachShader(this._program,this._vshader),$Ee.attachShader(this._program,this._pshader),$Ee.linkProgram(this._program),!$EC.isConchApp&&!$Ee.getProgramParameter(this._program,35714))throw $Ee.getProgramInfoLog(this._program);var $EL,$E_,$Ec=0,$Eq=0;for($Eq=$EC.isConchApp?$Ee.getProgramParameterEx(this._vs,this._ps,"",35721):$Ee.getProgramParameter(this._program,35721),$Ec=0;$Ec<$Eq;$Ec++){var $EH=null;$EL={vartype:"attribute",glfun:null,ivartype:0,attrib:$EH=$EC.isConchApp?$Ee.getActiveAttribEx(this._vs,this._ps,"",$Ec):$Ee.getActiveAttrib(this._program,$Ec),location:$Ee.getAttribLocation(this._program,$EH.name),name:$EH.name,type:$EH.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($EL)}var $ET=0;for($ET=$EC.isConchApp?$Ee.getProgramParameterEx(this._vs,this._ps,"",35718):$Ee.getProgramParameter(this._program,35718),$Ec=0;$Ec<$ET;$Ec++){var $Ex=null;$Ex=$EC.isConchApp?$Ee.getActiveUniformEx(this._vs,this._ps,"",$Ec):$Ee.getActiveUniform(this._program,$Ec),0<($EL={vartype:"uniform",glfun:null,ivartype:1,attrib:$EH,location:$Ee.getUniformLocation(this._program,$Ex.name),name:$Ex.name,type:$Ex.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($EL.name=$EL.name.substr(0,$EL.name.length-3),$EL.isArray=!0,$EL.location=$Ee.getUniformLocation(this._program,$EL.name)),this._params.push($EL)}for($Ec=0,$E_=this._params.length;$Ec<$E_;$Ec++)if(($EL=this._params[$Ec]).indexOfParams=$Ec,$EL.index=1,$EL.value=[$EL.location,null],$EL.codename=$EL.name,$EL.name=this._nameMap[$EL.codename]?this._nameMap[$EL.codename]:$EL.codename,(this._paramsMap[$EL.name]=$EL)._this=this,$EL.uploadedValue=[],"attribute"!==$EL.vartype)switch($EL.type){case 5124:$EL.fun=$EL.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$EL.fun=$EL.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$EL.fun=$EL.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$EL.fun=$EL.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$EL.fun=$EL.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$EL.fun=this._uniform_sampler2D;break;case 35680:$EL.fun=this._uniform_samplerCube;break;case 35676:$EL.glfun=$Ee.uniformMatrix4fv,$EL.fun=this._uniformMatrix4fv;break;case 35670:$EL.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $EL.fun=this._attribute}},$Ee.getUniform=function($EM){return this._paramsMap[$EM]},$Ee._attribute=function($EM,$Ee){var $EL=$EoM.mainContext,$E_=$EFM._enableAtributes,$Ec=$EM.location;return $E_[$Ec]||$EL.enableVertexAttribArray($Ec),$EL.vertexAttribPointer($Ec,$Ee[0],$Ee[1],$Ee[2],$Ee[3],$Ee[4]+this._offset),$E_[$Ec]=$EFM._bindVertexBuffer,1},$Ee._uniform1f=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee?($EoM.mainContext.uniform1f($EM.location,$EL[0]=$Ee),1):0},$Ee._uniform1fv=function($EM,$Ee){if($Ee.length<4){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($EoM.mainContext.uniform1fv($EM.location,$Ee),$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3],1):0}return $EoM.mainContext.uniform1fv($EM.location,$Ee),1},$Ee._uniform_vec2=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]?($EoM.mainContext.uniform2f($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1]),1):0},$Ee._uniform_vec2v=function($EM,$Ee){if($Ee.length<2){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($EoM.mainContext.uniform2fv($EM.location,$Ee),$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3],1):0}return $EoM.mainContext.uniform2fv($EM.location,$Ee),1},$Ee._uniform_vec3=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]?($EoM.mainContext.uniform3f($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2]),1):0},$Ee._uniform_vec3v=function($EM,$Ee){return $EoM.mainContext.uniform3fv($EM.location,$Ee),1},$Ee._uniform_vec4=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($EoM.mainContext.uniform4f($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3]),1):0},$Ee._uniform_vec4v=function($EM,$Ee){return $EoM.mainContext.uniform4fv($EM.location,$Ee),1},$Ee._uniformMatrix2fv=function($EM,$Ee){return $EoM.mainContext.uniformMatrix2fv($EM.location,!1,$Ee),1},$Ee._uniformMatrix3fv=function($EM,$Ee){return $EoM.mainContext.uniformMatrix3fv($EM.location,!1,$Ee),1},$Ee._uniformMatrix4fv=function($EM,$Ee){return $EoM.mainContext.uniformMatrix4fv($EM.location,!1,$Ee),1},$Ee._uniform1i=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee?($EoM.mainContext.uniform1i($EM.location,$EL[0]=$Ee),1):0},$Ee._uniform1iv=function($EM,$Ee){return $EoM.mainContext.uniform1iv($EM.location,$Ee),1},$Ee._uniform_ivec2=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]?($EoM.mainContext.uniform2i($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1]),1):0},$Ee._uniform_ivec2v=function($EM,$Ee){return $EoM.mainContext.uniform2iv($EM.location,$Ee),1},$Ee._uniform_vec3i=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]?($EoM.mainContext.uniform3i($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2]),1):0},$Ee._uniform_vec3vi=function($EM,$Ee){return $EoM.mainContext.uniform3iv($EM.location,$Ee),1},$Ee._uniform_vec4i=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($EoM.mainContext.uniform4i($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3]),1):0},$Ee._uniform_vec4vi=function($EM,$Ee){return $EoM.mainContext.uniform4iv($EM.location,$Ee),1},$Ee._uniform_sampler2D=function($EM,$Ee){var $EL=$EoM.mainContext,$E_=$EM.uploadedValue;return null==$E_[0]?($E_[0]=this._curActTexIndex,$EL.uniform1i($EM.location,this._curActTexIndex),$EL.activeTexture($EO._TEXTURES[this._curActTexIndex]),$EiM.bindTexture($EL,3553,$Ee),this._curActTexIndex++,1):($EL.activeTexture($EO._TEXTURES[$E_[0]]),$EiM.bindTexture($EL,3553,$Ee),0)},$Ee._uniform_samplerCube=function($EM,$Ee){var $EL=$EoM.mainContext,$E_=$EM.uploadedValue;return null==$E_[0]?($E_[0]=this._curActTexIndex,$EL.uniform1i($EM.location,this._curActTexIndex),$EL.activeTexture($EO._TEXTURES[this._curActTexIndex]),$EiM.bindTexture($EL,34067,$Ee),this._curActTexIndex++,1):($EL.activeTexture($EO._TEXTURES[$E_[0]]),$EiM.bindTexture($EL,34067,$Ee),0)},$Ee._noSetValue=function($EM){console.log("no....:"+$EM.name)},$Ee.uploadOne=function($EM,$Ee){this.activeResource(),$EiM.UseProgram(this._program);var $EL=this._paramsMap[$EM];$EL.fun.call(this,$EL,$Ee)},$Ee.uploadTexture2D=function($EM){$Ep.shaderCall++;var $Ee=$EoM.mainContext;$Ee.activeTexture(33984),$EiM.bindTexture($Ee,3553,$EM)},$Ee.uploadTexture2D1=function($EM){$Ep.shaderCall++;var $Ee=$EoM.mainContext;$Ee.activeTexture(33985),$EiM.bindTexture($Ee,3553,$EM)},$Ee.upload=function($EM,$Ee){$EfM.activeShader=$EfM.bindShader=this,this._lastUseFrameCount===$Ep.loopCount||this.activeResource(),$EiM.UseProgram(this._program),this._reCompile?($Ee=this._params,this._reCompile=!1):$Ee=$Ee||this._params;$EoM.mainContext;for(var $EL,$E_,$Ec=$Ee.length,$Eq=0,$EH=0;$EH<$Ec;$EH++)null!==($E_=$EM[($EL=$Ee[$EH]).name])&&($Eq+=$EL.fun.call(this,$EL,$E_));$Ep.shaderCall+=$Eq},$Ee.uploadArray=function($EM,$Ee,$EL){$EfM.activeShader=this,($EfM.bindShader=this).activeResource(),$EiM.UseProgram(this._program);this._params;for(var $E_,$Ec,$Eq=0,$EH=$Ee-2;0<=$EH;$EH-=2)($Ec=this._paramsMap[$EM[$EH]])&&null!=($E_=$EM[$EH+1])&&($EL&&$EL[$Ec.name]&&$EL[$Ec.name].bind(),$Eq+=$Ec.fun.call(this,$Ec,$E_));$Ep.shaderCall+=$Eq},$Ee.getParams=function(){return this._params},$EO.getShader=function($EM){return $EO.sharders[$EM]},$EO.create=function($EM,$Ee,$EL,$E_){return new $EO($EM,$Ee,$EL,$E_)},$EO.withCompile=function($EM,$Ee,$EL,$E_){if($EL&&$EO.sharders[$EL])return $EO.sharders[$EL];var $Ec=$EO._preCompileShader[2e-4*$EM];if(!$Ec)throw new Error("withCompile shader err!"+$EM);return $Ec.createShader($Ee,$EL,$E_)},$EO.withCompile2D=function($EM,$Ee,$EL,$E_,$Ec){if($E_&&$EO.sharders[$E_])return $EO.sharders[$E_];var $Eq=$EO._preCompileShader[2e-4*$EM+$Ee];if(!$Eq)throw new Error("withCompile shader err!"+$EM+" "+$Ee);return $Eq.createShader($EL,$E_,$Ec)},$EO.addInclude=function($EM,$Ee){$EXM.addInclude($EM,$Ee)},$EO.preCompile=function($EM,$Ee,$EL,$E_){var $Ec=2e-4*$EM;$EO._preCompileShader[$Ec]=new $EXM($Ec,$Ee,$EL,$E_)},$EO.preCompile2D=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=2e-4*$EM+$Ee;$EO._preCompileShader[$Eq]=new $EXM($Eq,$EL,$E_,$Ec)},$EO._createShader=function($EM,$Ee,$EL){var $E_=$EM.createShader($EL);return $EM.shaderSource($E_,$Ee),$EM.compileShader($E_),$E_},$EO._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$EO._count=0,$EO._preCompileShader={},$EO.SHADERNAME2ID=2e-4,$EO.sharders=(($EO.sharders=[]).length=32,$EO.sharders),$EH($EO,["nameKey",function(){return this.nameKey=new $ER}]),$EO}(),$ENM=function($EM){function $Ee(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$Ee.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$EV($Ee,"laya.webgl.utils.Buffer2D",$EM);var $EL=$Ee.prototype;return $EL.needSize=function($EM){var $Ee=this._byteLength;if($EM){var $EL=this._byteLength+$EM;$EL<=this._buffer.byteLength||this._resizeBuffer($EL<<1,!0),this._byteLength=$EL}return $Ee},$EL._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$Ep.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$EFM._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$EFM._gl.bufferSubData(this._bufferType,0,this._buffer)},$EL._bufferSubData=function($EM,$Ee,$EL){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$Ep.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$EFM._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$Ee||$EL){var $E_=this._buffer.slice($Ee,$EL);$EFM._gl.bufferSubData(this._bufferType,$EM,$E_)}else $EFM._gl.bufferSubData(this._bufferType,$EM,this._buffer)},$EL._checkArrayUse=function(){},$EL._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$EL._bind_subUpload=function($EM,$Ee,$EL){return void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($EM,$Ee,$EL),!0)},$EL._resizeBuffer=function($EM,$Ee){if($EM<this._buffer.byteLength)return this;if(this.memorySize=$EM,$Ee&&this._buffer&&0<this._buffer.byteLength){var $EL=new ArrayBuffer($EM);new Uint8Array($EL).set(new Uint8Array(this._buffer),0),this._buffer=$EL}else this._buffer=new ArrayBuffer($EM);return this._checkArrayUse(),this._upload=!0,this},$EL.append=function($EM){this._upload=!0;var $Ee,$EL;$Ee=$EM.byteLength,$EM instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$Ee,!0),$EL=new Uint8Array(this._buffer,this._byteLength)):$EM instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$Ee,!0),$EL=new Uint16Array(this._buffer,this._byteLength)):$EM instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$Ee,!0),$EL=new Float32Array(this._buffer,this._byteLength)),$EL.set($EM,0),this._byteLength+=$Ee,this._checkArrayUse()},$EL.appendU16Array=function($EM,$Ee){this._resizeBuffer(this._byteLength+2*$Ee,!0);for(var $EL=new Uint16Array(this._buffer,this._byteLength,$Ee),$E_=0;$E_<$Ee;$E_++)$EL[$E_]=$EM[$E_];this._byteLength+=2*$Ee,this._checkArrayUse()},$EL.appendEx=function($EM,$Ee){this._upload=!0;var $EL;$EL=$EM.byteLength,this._resizeBuffer(this._byteLength+$EL,!0),new $Ee(this._buffer,this._byteLength).set($EM,0),this._byteLength+=$EL,this._checkArrayUse()},$EL.appendEx2=function($EM,$Ee,$EL,$E_){void 0===$E_&&($E_=1),this._upload=!0;var $Ec,$Eq;$Ec=$EL*$E_,this._resizeBuffer(this._byteLength+$Ec,!0),$Eq=new $Ee(this._buffer,this._byteLength);var $EH=0;for($EH=0;$EH<$EL;$EH++)$Eq[$EH]=$EM[$EH];this._byteLength+=$Ec,this._checkArrayUse()},$EL.getBuffer=function(){return this._buffer},$EL.setNeedUpload=function(){this._upload=!0},$EL.getNeedUpload=function(){return this._upload},$EL.upload=function(){var $EM=this._bind_upload();return $EFM._gl.bindBuffer(this._bufferType,null),$EFM._bindActive[this._bufferType]=null,$EfM.activeShader=null,$EM},$EL.subUpload=function($EM,$Ee,$EL){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0);var $E_=this._bind_subUpload();return $EFM._gl.bindBuffer(this._bufferType,null),$EFM._bindActive[this._bufferType]=null,$EfM.activeShader=null,$E_},$EL.disposeResource=function(){$EM.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$EL.clear=function(){this._byteLength=0,this._upload=!0},$E_(0,$EL,"bufferLength",function(){return this._buffer.byteLength}),$E_(0,$EL,"byteLength",null,function($EM){this._byteLength!==$EM&&($EM<=this._buffer.byteLength||this._resizeBuffer(2*$EM+256,!0),this._byteLength=$EM)}),$Ee.__int__=function($EM){$EUM.QuadrangleIB=$EUM.create(35044),$E$M.fillIBQuadrangle($EUM.QuadrangleIB,16)},$Ee.FLOAT32=4,$Ee.SHORT=2,$Ee}($EFM),$EsM=(function($Ee){function $EL($EM){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$EL.__super.call(this,9)}$EV($EL,"laya.webgl.shader.d2.value.GlowSV",$Ee);var $EM=$EL.prototype;$EM.setValue=function($EM){$Ee.prototype.setValue.call(this,$EM)},$EM.clear=function(){$Ee.prototype.clear.call(this)}}($EbM),function($EM){function $Ee($EM){$Ee.__super.call(this,64),this.defines.add(64)}$EV($Ee,"laya.webgl.shader.d2.value.TextSV",$EM);var $EL=$Ee.prototype;return $EL.release=function(){($Ee.pool[$Ee._length++]=this).clear()},$EL.clear=function(){$EM.prototype.clear.call(this)},$Ee.create=function(){return $Ee._length?$Ee.pool[--$Ee._length]:new $Ee(null)},$Ee.pool=[],$Ee._length=0,$Ee}($EbM)),$EDM=function($EM){function $Ec($EM,$Ee,$EL,$E_){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$Ec.__super.call(this,$EM,$Ee,$EL,$E_)}$EV($Ec,"laya.webgl.shader.d2.Shader2X",$EM);var $Ee=$Ec.prototype;return $Ee.upload2dQuick1=function($EM){this.upload($EM,this._params2dQuick1||this._make2dQuick1())},$Ee._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $EM,$Ee=this._params,$EL=0,$E_=$Ee.length;$EL<$E_;$EL++)$EM=$Ee[$EL],($EC.isFlash||"size"!==$EM.name&&"position"!==$EM.name&&"texcoord"!==$EM.name)&&this._params2dQuick1.push($EM)}return this._params2dQuick1},$Ee.disposeResource=function(){$EM.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$Ee.upload2dQuick2=function($EM){this.upload($EM,this._params2dQuick2||this._make2dQuick2())},$Ee._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $EM,$Ee=this._params,$EL=0,$E_=$Ee.length;$EL<$E_;$EL++)$EM=$Ee[$EL],($EC.isFlash||"size"!==$EM.name)&&this._params2dQuick2.push($EM)}return this._params2dQuick2},$Ec.create=function($EM,$Ee,$EL,$E_){return new $Ec($EM,$Ee,$EL,$E_)},$Ec}($EvM),$EUM=function($EM){function $Ee($EM){this._uint8Array=null,this._uint16Array=null,void 0===$EM&&($EM=35044),$Ee.__super.call(this),this._bufferUsage=$EM,this._bufferType=34963,$EC.isFlash||(this._buffer=new ArrayBuffer(8))}$EV($Ee,"laya.webgl.utils.IndexBuffer2D",$ENM);var $EL=$Ee.prototype;return $EL._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$EL.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$EL.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$EL.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$Ee.QuadrangleIB=null,$Ee.create=function($EM){return void 0===$EM&&($EM=35044),new $Ee($EM)},$Ee}(),$EIM=function($EM){function $EL($EM,$Ee){this._floatArray32=null,this._vertexStride=0,$EL.__super.call(this),this._vertexStride=$EM,this._bufferUsage=$Ee,this._bufferType=34962,$EC.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$EV($EL,"laya.webgl.utils.VertexBuffer2D",$EM);var $Ee=$EL.prototype;return $Ee.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$Ee.bind=function($EM){$EM&&$EM._bind(),this._bind()},$Ee.insertData=function($EM,$Ee){this.getFloat32Array().set($EM,$Ee),this._upload=!0},$Ee.bind_upload=function($EM){$EM._bind_upload()||$EM._bind(),this._bind_upload()||this._bind()},$Ee._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$Ee.disposeResource=function(){$EM.prototype.disposeResource.call(this)},$Ee.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$E_(0,$Ee,"vertexStride",function(){return this._vertexStride}),$EL.create=function($EM,$Ee){return void 0===$Ee&&($Ee=35048),new $EL($EM,$Ee)},$EL}($ENM),$EMe=function($EM){function $ET($EM,$Ee,$EL,$E_,$Ec,$Eq){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$EL&&($EL=6408),void 0===$E_&&($E_=!0),$ET.__super.call(this,$EM,$Ee),$EM){if(this._format=$EL,this._mipmap=$E_,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $EM)this._url=$EM,this._src=$EM,this._image=new $EE.window.Image,$Ee&&($Ee.onload&&(this.onload=$Ee.onload),$Ee.onerror&&(this.onerror=$Ee.onerror),$Ee.onCreate&&$Ee.onCreate(this)),this._image.crossOrigin=$EM&&0==$EM.indexOf("data:")?null:"",$EM&&(this._image.src=$EM);else if($EM instanceof ArrayBuffer){this._src=$Ee,this._url=this._src;var $EH=new $Ex($EM);$EH.readUTFBytes(4),$EH.readUTFBytes(2),$EH.getInt16();$EH.endian="bigEndian",this._w=$EH.getInt16(),this._h=$EH.getInt16();$EH.getInt16(),$EH.getInt16();this._image=new Uint8Array($EM,$EH.pos),this._format=$EoM.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$Ew.enabled&&this._w<$Ew.atlasLimitWidth&&this._h<$Ew.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($EM instanceof Uint8Array))return this._src=$Ee,this._url=this._src,this._image=$EM.source||$EM,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$Ee,this._url=this._src,this._w=$Ec,this._h=$Eq,this._image=$EM,this._format=0===$EL?$EM.byteLength/($Ec*$Eq)==4?6408:6407:$EL}this._$5__enableMerageInAtlas=!0}}$EV($ET,"laya.webgl.resource.WebGLImage",$Er);var $Ee=$ET.prototype;return $EW.imps($Ee,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$Ee._init_=function($EM,$Ee){},$Ee._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $EM=$EoM.mainContext,$Ee=this._source=$EM.createTexture(),$EL=$EiM.curBindTexTarget,$E_=$EiM.curBindTexValue;$EiM.bindTexture($EM,3553,$Ee);var $Ec=this.minFifter,$Eq=this.magFifter,$EH=this.repeat?10497:33071,$ET=$Eu.isPOT(this._w,this._h),$Ex=!1;switch($ET?(this.mipmap?-1!==$Ec||($Ec=9987):-1!==$Ec||($Ec=9729),-1!==$Eq||($Eq=9729),$EM.texParameteri(3553,10241,$Ec),$EM.texParameteri(3553,10240,$Eq),$EM.texParameteri(3553,10242,$EH),$EM.texParameteri(3553,10243,$EH),this.mipmap&&$EM.generateMipmap(3553)):(-1!==$Ec||($Ec=9729),-1!==$Eq||($Eq=9729),$EM.texParameteri(3553,10241,$Ec),$EM.texParameteri(3553,10240,$Eq),$EM.texParameteri(3553,10242,33071),$EM.texParameteri(3553,10243,33071)),$EM.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$EM.pixelStorei($EM.UNPACK_ALIGNMENT,1),$EM.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$EM.pixelStorei($EM.UNPACK_ALIGNMENT,1),$EM.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$Ex=!0,$EM.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $EoM.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$Ex=!0,$EM.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$EM.pixelStorei(37441,!1),$EL&&$E_&&$EiM.bindTexture($EM,$EL,$E_),this.uri||(this.uri=this._url),$Ex?this.memorySize=this._image.length:$ET&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$Ee.recreateResource=function(){var $EM=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $Ee=this;this._image=new $EE.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($Ee._needReleaseAgain)return $Ee._needReleaseAgain=!1,$Ee._image.onload=null,void($Ee._image=null);$Ee._allowMerageInAtlas&&$Ee._enableMerageInAtlas?($EM.memorySize=0,$EM._recreateLock=!1):$Ee._createWebGlTexture(),$Ee.completeCreate()},this._image.src=this._src}},$Ee.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$EoM.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$Ee.onresize=function(){this._w=this._image.width,this._h=this._image.height,$Ew.enabled&&this._w<$Ew.atlasLimitWidth&&this._h<$Ew.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$Ee.clearAtlasSource=function(){this._image=null},$E_(0,$Ee,"format",function(){return this._format}),$E_(0,$Ee,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($EM){this._$5__enableMerageInAtlas=$EM}),$E_(0,$Ee,"mipmap",function(){return this._mipmap}),$E_(0,$Ee,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$E_(0,$Ee,"atlasSource",function(){return this._image}),$E_(0,$Ee,"onload",null,function($EM){var $Ee=this;this._onload=$EM,this._image&&(this._image.onload=null!=this._onload?function(){$Ee.onresize(),$Ee._onload()}:null)}),$E_(0,$Ee,"onerror",null,function($EM){var $Ee=this;this._onerror=$EM,this._image&&(this._image.onerror=null!=this._onerror?function(){$Ee._onerror()}:null)}),$ET}();$EW.__init([$EEM,$EJ,$EyM,$EXM])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($EM,$Ee){"use strict";for(var $EL in Object.defineProperty($Ee,"__esModule",{value:!0}),Laya){var $E_=Laya[$EL];$E_&&$E_.__isclass&&($Ee[$EL]=$E_)}}),function($Eq,$EM,$E_){$E_.un,$E_.uns;var $Ec=$E_.static,$EH=$E_.class,$ET=$E_.getset,$Ex=($E_.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$Ed=laya.utils.ClassUtils,$EG=(laya.events.Event,laya.utils.HTMLChar),$EO=laya.net.Loader,$Eu=(laya.display.Node,laya.maths.Rectangle),$EV=laya.renders.Render,$EE=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$Er=laya.utils.Stat,$Ef=laya.display.Text,$E$=laya.resource.Texture,$EC=laya.net.URL,$EK=laya.utils.Utils,$EX=function(){function $EE(){}return $EH($EE,"laya.html.utils.HTMLParse"),$EE.parse=function($EM,$Ee,$EL){$Ee=($Ee="<root>"+($Ee=$Ee.replace(/<br>/g,"<br/>"))+"</root>").replace($EE.spacePattern,$EE.char255);var $E_=$EK.parseXMLFromString($Ee);$EE._parseXML($EM,$E_.childNodes[0].childNodes,$EL)},$EE._parseXML=function($EM,$Ee,$EL,$E_){var $Ec=0,$Eq=0;if($Ee.join||$Ee.item)for($Ec=0,$Eq=$Ee.length;$Ec<$Eq;++$Ec)$EE._parseXML($EM,$Ee[$Ec],$EL,$E_);else{var $EH,$ET,$Ex;if(3==$Ee.nodeType)return void($EM instanceof laya.html.dom.HTMLDivElement?(null==$Ee.nodeName&&($Ee.nodeName="#text"),$ET=$Ee.nodeName.toLowerCase(),0<($Ex=$Ee.textContent.replace(/^\s+|\s+$/g,"")).length&&($EH=$Ed.getInstance($ET))&&($EM.addChild($EH),$EH.innerTEXT=$Ex.replace($EE.char255AndOneSpacePattern," "))):0<($Ex=$Ee.textContent.replace(/^\s+|\s+$/g,"")).length&&($EM.innerTEXT=$Ex.replace($EE.char255AndOneSpacePattern," ")));if("#comment"==($ET=$Ee.nodeName.toLowerCase()))return;if($EH=$Ed.getInstance($ET)){($EH=$EM.addChild($EH)).URI=$EL,$EH.href=$E_;var $EO=$Ee.attributes;if($EO&&0<$EO.length)for($Ec=0,$Eq=$EO.length;$Ec<$Eq;++$Ec){var $Eu=$EO[$Ec],$EG=$Eu.nodeName,$EV=$Eu.value;$EH._setAttributes($EG,$EV)}$EE._parseXML($EH,$Ee.childNodes,$EL,$EH.href)}else $EE._parseXML($EM,$Ee.childNodes,$EL,$E_)}},$EE.char255=String.fromCharCode(255),$EE.spacePattern=/&nbsp;|&#160;/g,$EE.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$EE}(),$Eo=function(){function $El(){}return $EH($El,"laya.html.utils.Layout"),$El.later=function($EM){null==$El._will&&($El._will=[],$E_.stage.frameLoop(1,null,function(){if(!($El._will.length<1)){for(var $EM=0;$EM<$El._will.length;$EM++)laya.html.utils.Layout.layout($El._will[$EM]);$El._will.length=0}})),$El._will.push($EM)},$El.layout=function($EM){if(!$EM||!$EM._style)return null;if(0==(512&$EM._style._type))return null;$EM.getStyle()._type&=-513;var $Ee=$El._multiLineLayout($EM);return $EV.isConchApp&&$EM.layaoutCallNative&&$EM.layaoutCallNative(),$Ee},$El._multiLineLayout=function($EM){if($Ef.RightToLeft)return $El._multiLineLayout2($EM);var $Ee=new Array;$EM._addChildsToLayout($Ee);var $EL,$E_,$Ec,$Eq,$EH,$ET=0,$Ex=$Ee.length,$EO=$EM._getCSSStyle(),$Eu=$EO.letterSpacing,$EG=$EO.leading,$EV=$EO.lineHeight,$EE=$EO._widthAuto()||!$EO.wordWrap,$Ed=$EE?999999:$EM.width,$Er=($EM.height,0),$E$=$EO.italic?$EO.fontSize/3:0,$EC=$EO._getAlign(),$EK=$EO._getValign(),$EX=0!==$EK||0!==$EC||0!=$EV,$Eo=0,$Ei=0,$EW=0,$Ey=0,$EA=new Array,$EB=$EA[0]=new $Ej,$Ek=!1,$Eh=!1;$EB.h=0,$EO.italic&&($Ed-=$EO.fontSize/3);var $Et=0,$ES=!0;function $Ep(){$EB.y=$Ei,$Ei+=$EB.h+$EG,0==$EB.h&&($Ei+=$EV),$EB.mWidth=$Et,$Et=0,$EB=new $Ej,$EA.push($EB),$EB.h=0,$Ek=!($ES=!($Eo=0))}for($ET=0;$ET<$Ex;$ET++)if(null!=($EL=$Ee[$ET]))if($ES=!1,$EL instanceof laya.html.dom.HTMLBrElement)$Ep(),$EB.y=$Ei;else{if($EL._isChar()){if(($Eq=$EL).isWord)$Ek=$Eh||"\n"===$Eq.char,$EB.wordStartIndex=$EB.elements.length;else{if($EW=$Eq.width+$Eq.style.letterSpacin,0<$EA.length&&$Ed<$Eo+$EW&&0<$EB.wordStartIndex){var $ER;$ER=$EB.elements.length-$EB.wordStartIndex+1,$EB.elements.length=$EB.wordStartIndex,$ET-=$ER,$Ep();continue}$Ek=!1,$Et+=$Eq.width}$EW=$Eq.width+$Eu,$Ey=$Eq.height,$Eh=!1,($Ek=$Ek||$Ed<$Eo+$EW)&&$Ep(),$EB.minTextHeight=Math.min($EB.minTextHeight,$EL.height)}else $E_=$EL._getCSSStyle(),$EH=$EL,$Ec=$E_.padding,0===$E_._getCssFloat()||($EX=!0),$Ek=$Eh||$E_.lineElement,$EW=$EH.width*$EH._style._tf.scaleX+$Ec[1]+$Ec[3]+$Eu,$Ey=$EH.height*$EH._style._tf.scaleY+$Ec[0]+$Ec[2],$Eh=$E_.lineElement,($Ek=$Ek||$Ed<$Eo+$EW&&$E_.wordWrap)&&$Ep();$EB.elements.push($EL),$EB.h=Math.max($EB.h,$Ey),$EL.x=$Eo,$EL.y=$Ei,$Eo+=$EW,$EB.w=$Eo-$Eu,$EB.y=$Ei,$Er=Math.max($Eo+$E$,$Er)}else $ES||($Eo+=$El.DIV_ELEMENT_PADDING),$EB.wordStartIndex=$EB.elements.length;if($Ei=$EB.y+$EB.h,$EX){var $Ea=0,$En=$Ed;for($EE&&0<$EM.width&&($En=$EM.width),$ET=0,$Ex=$EA.length;$ET<$Ex;$ET++)$EA[$ET].updatePos(0,$En,$ET,$Ea,$EC,$EK,$EV),$Ea+=Math.max($EV,$EA[$ET].h+$EG);$Ei=$Ea}return $EE&&($EM.width=$Er),$Ei>$EM.height&&($EM.height=$Ei),[$Er,$Ei]},$El._multiLineLayout2=function($EM){var $Ee=new Array;$EM._addChildsToLayout($Ee);var $EL,$E_,$Ec,$Eq,$EH,$ET=0,$Ex=$Ee.length,$EO=$EM._getCSSStyle(),$Eu=$EO.letterSpacing,$EG=$EO.leading,$EV=$EO.lineHeight,$EE=$EO._widthAuto()||!$EO.wordWrap,$Ed=$EE?999999:$EM.width,$Er=($EM.height,0),$E$=$EO.italic?$EO.fontSize/3:0,$EC=2-$EO._getAlign(),$EK=$EO._getValign(),$EX=0!==$EK||0!=$EC||0!=$EV,$Eo=0,$Ei=0,$EW=0,$Ey=0,$EA=new Array,$EB=$EA[0]=new $Ej,$Ek=!1,$Eh=!1;$EB.h=0,$EO.italic&&($Ed-=$EO.fontSize/3);var $Et=0,$ES=!0;function $Ep(){$EB.y=$Ei,$Ei+=$EB.h+$EG,0==$EB.h&&($Ei+=$EV),$EB.mWidth=$Et,$Et=0,$EB=new $Ej,$EA.push($EB),$EB.h=0,$Ek=!($ES=!($Eo=0))}for($ET=0;$ET<$Ex;$ET++)if(null!=($EL=$Ee[$ET]))if($ES=!1,$EL instanceof laya.html.dom.HTMLBrElement)$Ep(),$EB.y=$Ei;else{if($EL._isChar()){if(($Eq=$EL).isWord)$Ek=$Eh||"\n"===$Eq.char,$EB.wordStartIndex=$EB.elements.length;else{if(0<$EA.length&&$Ed<$Eo+$EW&&0<$EB.wordStartIndex){var $ER;$ER=$EB.elements.length-$EB.wordStartIndex+1,$EB.elements.length=$EB.wordStartIndex,$ET-=$ER,$Ep();continue}$Ek=!1,$Et+=$Eq.width}$EW=$Eq.width+$Eu,$Ey=$Eq.height,$Eh=!1,($Ek=$Ek||$Ed<$Eo+$EW)&&$Ep(),$EB.minTextHeight=Math.min($EB.minTextHeight,$EL.height)}else $E_=$EL._getCSSStyle(),$EH=$EL,$Ec=$E_.padding,0===$E_._getCssFloat()||($EX=!0),$Ek=$Eh||$E_.lineElement,$EW=$EH.width*$EH._style._tf.scaleX+$Ec[1]+$Ec[3]+$Eu,$Ey=$EH.height*$EH._style._tf.scaleY+$Ec[0]+$Ec[2],$Eh=$E_.lineElement,($Ek=$Ek||$Ed<$Eo+$EW&&$E_.wordWrap)&&$Ep();$EB.elements.push($EL),$EB.h=Math.max($EB.h,$Ey),$EL.x=$Eo,$EL.y=$Ei,$Eo+=$EW,$EB.w=$Eo-$Eu,$EB.y=$Ei,$Er=Math.max($Eo+$E$,$Er)}else $ES||($Eo+=$El.DIV_ELEMENT_PADDING),$EB.wordStartIndex=$EB.elements.length;if($Ei=$EB.y+$EB.h,$EX){var $Ea=0,$En=$Ed;for($ET=0,$Ex=$EA.length;$ET<$Ex;$ET++)$EA[$ET].updatePos(0,$En,$ET,$Ea,$EC,$EK,$EV),$Ea+=Math.max($EV,$EA[$ET].h+$EG);$Ei=$Ea}for($EE&&($EM.width=$Er),$Ei>$EM.height&&($EM.height=$Ei),$ET=0,$Ex=$EA.length;$ET<$Ex;$ET++)$EA[$ET].revertOrder($Ed);return[$Er,$Ei]},$El._will=null,$El.DIV_ELEMENT_PADDING=0,$El}(),$Ej=function(){function $EM(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$EH($EM,"laya.html.utils.LayoutLine");var $Ee=$EM.prototype;return $Ee.updatePos=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){var $ET,$Ex=0;0<this.elements.length&&($Ex=($ET=this.elements[this.elements.length-1]).x+$ET.width-this.elements[0].x);var $EO=0,$Eu=NaN;1===$Ec&&($EO=($Ee-$Ex)/2),2===$Ec&&($EO=$Ee-$Ex),0===$EH||0!=$Eq||($Eq=1);for(var $EG=0,$EV=this.elements.length;$EG<$EV;$EG++){var $EE=($ET=this.elements[$EG])._getCSSStyle();switch(0!==$EO&&($ET.x+=$EO),$EE._getValign()){case 0:$ET.y=$E_;break;case 1:var $Ed=0;99999!=this.minTextHeight&&($Ed=this.minTextHeight);var $Er=($Ed+$EH)/2;$Er=Math.max($Er,this.h),$Eu=(laya.html.dom.HTMLImageElement,$E_+$Er-$ET.height),$ET.y=$Eu;break;case 2:$ET.y=$E_+($EH-$ET.height)}}},$Ee.revertOrder=function($EM){var $Ee;if(0<this.elements.length){var $EL,$E_=0;for($EL=this.elements.length,$E_=0;$E_<$EL;$E_++)($Ee=this.elements[$E_]).x=$EM-$Ee.x-$Ee.width}},$EM}(),$Ei=function($EL){function $Ee(){this.URI=null,this._href=null,$Ee.__super.call(this),this._text=$Ee._EMPTYTEXT,this.setStyle(new $Ex(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$EH($Ee,"laya.html.dom.HTMLElement",$EL);var $EM=$Ee.prototype;return $EM.layaoutCallNative=function(){var $EM=0;if(this._childs&&0<($EM=this._childs.length))for(var $Ee=0;$Ee<$EM;$Ee++)this._childs[$Ee].layaoutCallNative&&this._childs[$Ee].layaoutCallNative();var $EL=this._getWords();$EL?laya.html.dom.HTMLElement.fillWords(this,$EL,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$EM.appendChild=function($EM){return this.addChild($EM)},$EM._getWords2=function(){var $EM=this._text.text;if(!$EM||0===$EM.length)return null;var $Ee,$EL,$E_=0,$Ec=0;if(this._text.drawWords)$EL=this._text.drawWords;else{for($Ec=($Ee=$EM.split(" ")).length-1,$EL=[],$E_=0;$E_<$Ec;$E_++)$EL.push($Ee[$E_]," ");0<=$Ec&&$EL.push($Ee[$Ec]),this._text.drawWords=$EL}var $Eq,$EH=this._text.words;if($EH&&$EH.length===$EL.length)return $EH;null===$EH&&(this._text.words=$EH=[]),$EH.length=$EL.length;var $ET=this.style,$Ex=$ET.font;for($E_=0,$Ec=$EL.length;$E_<$Ec;$E_++){$Eq=$EK.measureText($EL[$E_],$Ex);var $EO=$EH[$E_]=new $EG($EL[$E_],$Eq.width,$Eq.height||$ET.fontSize,$ET);if(1<$EO.char.length&&($EO.charNum=$EO.char),this.href){var $Eu=new $EE;this.addChild($Eu),$EO.setSprite($Eu)}}return $EH},$EM._getWords=function(){if(!$Ef.CharacterCache)return this._getWords2();var $EM=this._text.text;if(!$EM||0===$EM.length)return null;var $Ee,$EL=this._text.words;if($EL&&$EL.length===$EM.length)return $EL;null===$EL&&(this._text.words=$EL=[]),$EL.length=$EM.length;for(var $E_=this.style,$Ec=$E_.font,$Eq=0,$EH=$EM.length;$Eq<$EH;$Eq++)if($Ee=$EK.measureText($EM.charAt($Eq),$Ec)){var $ET=$EL[$Eq]=new $EG($EM.charAt($Eq),$Ee.width,$Ee.height||$E_.fontSize,$E_);if(this.href){var $Ex=new $EE;this.addChild($Ex),$ET.setSprite($Ex)}}else console.warn("_getWords size is null"+$EM.charAt($Eq),$Ec);return $EL},$EM.showLinkSprite=function(){var $EM=this._text.words;if($EM)for(var $Ee,$EL,$E_=[],$Ec=0;$Ec<$EM.length;$Ec++)$EL=$EM[$Ec],($Ee=new $EE).graphics.drawRect(0,0,$EL.width,$EL.height,"#ff0000"),$Ee.width=$EL.width,$Ee.height=$EL.height,this.addChild($Ee),$E_.push($Ee)},$EM._layoutLater=function(){var $EM=this.style;512&$EM._type||($EM.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$EM.block?($Eo.later(this),$EM._type|=512):this.parent&&this.parent._layoutLater())},$EM._setAttributes=function($EM,$Ee){switch($EM){case"style":return void this.style.cssText($Ee);case"class":return void(this.className=$Ee)}$EL.prototype._setAttributes.call(this,$EM,$Ee)},$EM.updateHref=function(){if(null!=this._href){var $EM=this._getWords();if($EM)for(var $Ee,$EL,$E_=0;$E_<$EM.length;$E_++)($EL=($Ee=$EM[$E_]).getSprite())&&($EL.size($Ee.width,$Ee.height),$EL.on("click",this,this.onLinkHandler))}},$EM.onLinkHandler=function($EM){switch($EM.type){case"click":for(var $Ee=this;$Ee;)$Ee.event("link",[this.href]),$Ee=$Ee.parent}},$EM.formatURL=function($EM){return this.URI?$EC.formatURL($EM,this.URI?this.URI.path:null):$EM},$ET(0,$EM,"href",function(){return this._href},function($EM){null!=(this._href=$EM)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$ET(0,$EM,"color",null,function($EM){this.style.color=$EM}),$ET(0,$EM,"onClick",null,function($EM){$E_._runScript("fn=function(event){"+$EM+";}"),this.on("click",this,void 0)}),$ET(0,$EM,"id",null,function($EM){$EW.document.setElementById($EM,this)}),$ET(0,$EM,"innerTEXT",function(){return this._text.text},function($EM){this.text=$EM}),$ET(0,$EM,"style",function(){return this._style}),$ET(0,$EM,"text",function(){return this._text.text},function($EM){this._text==$Ee._EMPTYTEXT?this._text={text:$EM,words:null}:(this._text.text=$EM,this._text.words&&(this._text.words.length=0)),$EV.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$ET(0,$EM,"parent",$EL.prototype._$get_parent,function($EM){if($EM instanceof laya.html.dom.HTMLElement){var $Ee=$EM;this.URI||(this.URI=$Ee.URI),this.style.inherit($Ee.style)}$E_.superSet($EE,this,"parent",$EM)}),$ET(0,$EM,"className",null,function($EM){this.style.attrs($EW.document.styleSheets["."+$EM])}),$Ee.fillWords=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$EM.graphics.clear();for(var $ET=0,$Ex=$Ee.length;$ET<$Ex;$ET++){var $EO=$Ee[$ET];$EM.graphics.fillText($EO.char,$EO.x+$EL,$EO.y+$E_,$Ec,$Eq,"left",$EH)}},$Ee._EMPTYTEXT={text:null,words:null},$Ee}($EE),$Ee=(function($EM){function $Ee(){$Ee.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$EH($Ee,"laya.html.dom.HTMLBrElement",$Ei)}(),function($EM){function $Ee(){this.contextHeight=NaN,this.contextWidth=NaN,$Ee.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$EH($Ee,"laya.html.dom.HTMLDivElement",$EM);var $EL=$Ee.prototype;return $EL.appendHTML=function($EM){$EX.parse(this,$EM,this.URI),this.layout()},$EL._addChildsToLayout=function($Ee){var $EM=this._getWords();if(null==$EM&&0==this._childs.length)return!1;$EM&&$EM.forEach(function($EM){$Ee.push($EM)});for(var $EL=!0,$E_=0,$Ec=this._childs.length;$E_<$Ec;$E_++){var $Eq=this._childs[$E_];$EL?$EL=!1:$Ee.push(null),$Eq._addToLayout($Ee)}return!0},$EL._addToLayout=function($EM){this.layout()},$EL.layout=function(){if(this.style){this.style._type|=512;var $EM=$Eo.layout(this);if($EM){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $Eu);var $Ee=this._$P.mHtmlBounds;$Ee.x=$Ee.y=0,$Ee.width=this.contextWidth=$EM[0],$Ee.height=this.contextHeight=$EM[1],this.setBounds($Ee)}}},$ET(0,$EL,"height",function(){return this._height?this._height:this.contextHeight},$EM.prototype._$set_height),$ET(0,$EL,"innerHTML",null,function($EM){this.destroyChildren(),this.appendHTML($EM)}),$ET(0,$EL,"width",function(){return this._width?this._width:this.contextWidth},function($EM){var $Ee=!1;$Ee=0===$EM?$EM!=this._width:$EM!=this.width,$E_.superSet($Ei,this,"width",$EM),$Ee&&this.layout()}),$Ee}($Ei)),$EW=function($EM){function $Ee(){this.all=new Array,this.styleSheets=$Ex.styleSheets,$Ee.__super.call(this)}$EH($Ee,"laya.html.dom.HTMLDocument",$Ei);var $EL=$Ee.prototype;return $EL.getElementById=function($EM){return this.all[$EM]},$EL.setElementById=function($EM,$Ee){this.all[$EM]=$Ee},$Ec($Ee,["document",function(){return this.document=new $Ee}]),$Ee}();(function($EM){function $Ee(){this._tex=null,this._url=null,this._renderArgs=[],$Ee.__super.call(this),this.style.block=!0}$EH($Ee,"laya.html.dom.HTMLImageElement",$Ei);var $EL=$Ee.prototype;$EL._addToLayout=function($EM){!this._style.absolute&&$EM.push(this)},$EL.render=function($EM,$Ee,$EL){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($Er.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$EM.ctx.drawTexture2($Ee,$EL,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$EL.layaoutCallNative=function(){var $EM=0;if(this._childs&&0<($EM=this._childs.length))for(var $Ee=0;$Ee<$EM;$Ee++)this._childs[$Ee].layaoutCallNative&&this._childs[$Ee].layaoutCallNative()},$ET(0,$EL,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($EM){this._width!==$EM&&(this._width=$EM,this._style.width=$EM,this.repaint())}),$ET(0,$EL,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($EM){this._height!==$EM&&(this._height=$EM,this._style.height=$EM,this.repaint())}),$EL.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$EO.clearCache(this,this._url),this._tex=null),$Ei.prototype.destroy.call(this)},$EL.onloaded=function(){var $EM=this._style;$EM&&!$EM.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$EM&&!$EM.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$EV.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$EL._loadImageComplete=function($EM,$Ee,$EL){if(!this._destroyed)if(null!=$EL)if($EL instanceof ArrayBuffer){var $E_=new DataView($EL);new laya.webgl.resource.WebGLImage(new Uint8Array($EL,8),$EM,0,!1,$E_.getUint32(0),$E_.getUint32(4));this.onloaded()}else if($EL instanceof $E$)$EO.imgMgrSet[$EM]=$Ee,$Eq.imgMgrLock($EM,$EO.imgMgrSet[$EM]),this._url=$EM,this._tex=$EL,$EO.keepCache(this,$EM),$EO.cacheRes($EM,this._tex),this.onloaded();else{var $Ec=-1!=$EM.indexOf(".png",$EM.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($EL,$EM,$Ec,!1,$EL.width,$EL.height);this.onloaded()}else this.event("error","Load image failed")},$ET(0,$EL,"src",null,function($EM){($EM=this.formatURL($EM),this._url!=$EM)&&(null!=this._tex&&($EO.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$EM,(this._tex=$EO.getRes($EM))?($EO.keepCache(this,$EM),this.onloaded()):$Eq.imgMgrLoad($EM,this._loadImageComplete.bind(this),2,!1))})})(),function($EM){function $Ee(){this.type=null,$Ee.__super.call(this),this.visible=!1}$EH($Ee,"laya.html.dom.HTMLLinkElement",$EM);var $EL=$Ee.prototype;$EL._onload=function($EM){switch(this.type){case"text/css":$Ex.parseCSS($EM,this.URI)}},$ET(0,$EL,"href",$EM.prototype._$get_href,function($EM){var $Ee=this;$EM=this.formatURL($EM),this.URI=new $EC($EM);var $EL=new $EO;$EL.once("complete",null,function($EM){$Ee._onload($EM)}),$EL.load($EM,"text")}),$Ee._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($Ei),function($EM){function $Ee(){$Ee.__super.call(this),this.visible=!1}$EH($Ee,"laya.html.dom.HTMLStyleElement",$EM),$ET(0,$Ee.prototype,"text",$EM.prototype._$get_text,function($EM){$Ex.parseCSS($EM,null)})}($Ei),function($EM){function $Ee(){$Ee.__super.call(this),this._getCSSStyle().valign="middle"}$EH($Ee,"laya.html.dom.HTMLIframeElement",$EM),$ET(0,$Ee.prototype,"href",$EM.prototype._$get_href,function($EL){var $E_=this;$EL=this.formatURL($EL);var $EM=new $EO;$EM.once("complete",null,function($EM){var $Ee=$E_.URI;$E_.URI=new $EC($EL),$E_.innerHTML=$EM,!$Ee||($E_.URI=$Ee)}),$EM.load($EL,"text")})}($Ee)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($EM,$Ee){"use strict";for(var $EL in Object.defineProperty($Ee,"__esModule",{value:!0}),Laya){var $E_=Laya[$EL];$E_&&$E_.__isclass&&($Ee[$EL]=$E_)}}),function($Ec,$EM,$Er){$Er.un,$Er.uns;var $E_=$Er.static,$Eq=$Er.class,$EH=$Er.getset,$EL=($Er.__newvec,laya.display.Animation),$E$=(laya.utils.Browser,laya.utils.ClassUtils),$ET=laya.filters.ColorFilter,$Ex=laya.utils.Ease,$EO=laya.events.Event,$Eu=(laya.events.EventDispatcher,laya.display.css.Font),$EG=laya.display.FrameAnimation,$Ee=laya.display.Graphics,$EV=laya.utils.Handler,$EE=laya.display.Input,$EK=laya.net.Loader,$Ed=(laya.display.Node,laya.maths.Point),$EC=laya.maths.Rectangle,$EX=laya.renders.Render,$Eo=laya.display.Sprite,$Ei=laya.display.Text,$EW=laya.resource.Texture,$Ey=laya.utils.Tween,$EA=laya.utils.Utils,$EB=laya.utils.WeakObject;$Er.interface("laya.ui.IItem"),$Er.interface("laya.ui.ISelect"),$Er.interface("laya.ui.IRender"),$Er.interface("laya.ui.IComponent"),$Er.interface("laya.ui.IBox","IComponent");var $Ek=function(){function $EM(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $Eq($EM,"laya.ui.LayoutStyle"),$E_($EM,["EMPTY",function(){return this.EMPTY=new $EM}]),$EM}(),$Eh=function(){function $EM(){}return $Eq($EM,"laya.ui.Styles"),$EM.labelColor="#000000",$EM.buttonStateNum=3,$EM.scrollBarMinNum=15,$EM.scrollBarDelayTime=500,$E_($EM,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$EM}(),$Et=function(){function $Ec(){}return $Eq($Ec,"laya.ui.UIUtils"),$Ec.fillArray=function($EM,$Ee,$EL){var $E_=$EM.concat();if($Ee)for(var $Ec=$Ee.split(","),$Eq=0,$EH=Math.min($E_.length,$Ec.length);$Eq<$EH;$Eq++){var $ET=$Ec[$Eq];$E_[$Eq]="true"==$ET||"false"!=$ET&&$ET,null!=$EL&&($E_[$Eq]=$EL($ET))}return $E_},$Ec.toColor=function($EM){return $EA.toHexColor($EM)},$Ec.gray=function($EM,$Ee){void 0===$Ee&&($Ee=!0),$Ee?$Ec.addFilter($EM,$Ec.grayFilter):$Ec.clearFilter($EM,$ET)},$Ec.addFilter=function($EM,$Ee){var $EL=$EM.filters||[];$EL.push($Ee),$EM.filters=$EL},$Ec.clearFilter=function($EM,$Ee){var $EL=$EM.filters;if(null!=$EL&&0<$EL.length){for(var $E_=$EL.length-1;-1<$E_;$E_--){var $Ec=$EL[$E_];$Er.__typeof($Ec,$Ee)&&$EL.splice($E_,1)}$EM.filters=$EL}},$Ec._getReplaceStr=function($EM){return $Ec.escapeSequence[$EM]},$Ec.adptString=function($EM){return $EM.replace(/\\(\w)/g,$Ec._getReplaceStr)},$Ec.getBindFun=function($EM){var $Ee=$Ec._funMap.get($EM);if(null==$Ee){var $EL='"'+$EM+'"',$E_="(function(data){if(data==null)return;with(data){try{\nreturn "+($EL=$EL.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$Ee=$Er._runScript($E_),$Ec._funMap.set($EM,$Ee)}return $Ee},$E_($Ec,["grayFilter",function(){return this.grayFilter=new $ET([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $EB}]),$Ec}(),$ES=function(){function $EM(){}return $Eq($EM,"UIConfig"),$EM.touchScrollEnable=!0,$EM.mouseWheelEnable=!0,$EM.showButtons=!0,$EM.popupBgColor="#000000",$EM.popupBgAlpha=.5,$EM.closeDialogOnSide=!0,$EM}(),$Ep=function($EL){function $EC(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$EC.__super.call(this),this._weakKeys=[]}$Eq($EC,"laya.ui.AutoBitmap",$EL);var $EM=$EC.prototype;return $EM.destroy=function(){if($EK.clearObject(this,this._weakKey),this._weakKeys){for(var $EM=0,$Ee=this._weakKeys.length;$EM<$Ee;++$EM)$EK.clearObject(this,this._weakKeys[$EM]);this._weakKeys=null}$EL.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$EM._setChanged=function(){this._isChanged||(this._isChanged=!0,$Er.timer.callLater(this,this.changeSource))},$EM.changeSource=function(){this._isChanged=!1;var $EM=this._source;if($EM&&$EM.bitmap){var $Ee=this.width,$EL=this.height,$E_=this._sizeGrid,$Ec=$EM.sourceWidth,$Eq=$EM.sourceHeight;if(!$E_||$Ec===$Ee&&$Eq===$EL)this.cleanByTexture($EM,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$Ee,$EL);else{$EK.clearObject(this,this._weakKey),$EM.$_GID||($EM.$_GID=$EA.getGID());var $EH=$EM.$_GID+"."+$Ee+"."+$EL+"."+$E_.join("."),$ET=$EK.findObject($EH);if($EA.isOKCmdList($ET))return this._weakKey=$EH,$EK.keepObject(this,this._weakKey),void(this.cmds=$ET);this.clear();var $Ex,$EO,$Eu=$E_[0],$EG=$E_[1],$EV=$E_[2],$EE=$E_[3],$Ed=$E_[4],$Er=!1;if($Ee==$Ec&&($EE=$EG=0),$EL==$Eq&&($Eu=$EV=0),$Ee<$EE+$EG){var $E$=$Ee;$Er=!0,$Ee=$EE+$EG,this.save(),this.clipRect(0,0,$E$,$EL)}$EE&&$Eu&&($Ex=$EC.getTexture($EM,0,0,$EE,$Eu),$EO=this._weakKeys[0],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[0]=$Ex.weakKey),this.drawTexture($Ex,0,0,$EE,$Eu)):($EK.clearObject(this,$EO),this._weakKeys[0]="")),$EG&&$Eu&&($Ex=$EC.getTexture($EM,$Ec-$EG,0,$EG,$Eu),$EO=this._weakKeys[1],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[1]=$Ex.weakKey),this.drawTexture($Ex,$Ee-$EG,0,$EG,$Eu)):($EK.clearObject(this,$EO),this._weakKeys[1]="")),$EE&&$EV&&($Ex=$EC.getTexture($EM,0,$Eq-$EV,$EE,$EV),$EO=this._weakKeys[2],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[2]=$Ex.weakKey),this.drawTexture($Ex,0,$EL-$EV,$EE,$EV)):($EK.clearObject(this,$EO),this._weakKeys[2]="")),$EG&&$EV&&($Ex=$EC.getTexture($EM,$Ec-$EG,$Eq-$EV,$EG,$EV),$EO=this._weakKeys[3],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[3]=$Ex.weakKey),this.drawTexture($Ex,$Ee-$EG,$EL-$EV,$EG,$EV)):($EK.clearObject(this,$EO),this._weakKeys[3]="")),$Eu&&($Ex=$EC.getTexture($EM,$EE,0,$Ec-$EE-$EG,$Eu),$EO=this._weakKeys[4],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[4]=$Ex.weakKey),this.drawBitmap($Ed,$Ex,$EE,0,$Ee-$EE-$EG,$Eu)):($EK.clearObject(this,$EO),this._weakKeys[4]="")),$EV&&($Ex=$EC.getTexture($EM,$EE,$Eq-$EV,$Ec-$EE-$EG,$EV),$EO=this._weakKeys[5],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[5]=$Ex.weakKey),this.drawBitmap($Ed,$Ex,$EE,$EL-$EV,$Ee-$EE-$EG,$EV)):($EK.clearObject(this,$EO),this._weakKeys[5]="")),$EE&&($Ex=$EC.getTexture($EM,0,$Eu,$EE,$Eq-$Eu-$EV),$EO=this._weakKeys[6],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[6]=$Ex.weakKey),this.drawBitmap($Ed,$Ex,0,$Eu,$EE,$EL-$Eu-$EV)):($EK.clearObject(this,$EO),this._weakKeys[6]="")),$EG&&($Ex=$EC.getTexture($EM,$Ec-$EG,$Eu,$EG,$Eq-$Eu-$EV),$EO=this._weakKeys[7],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[7]=$Ex.weakKey),this.drawBitmap($Ed,$Ex,$Ee-$EG,$Eu,$EG,$EL-$Eu-$EV)):($EK.clearObject(this,$EO),this._weakKeys[7]="")),$Ex=$EC.getTexture($EM,$EE,$Eu,$Ec-$EE-$EG,$Eq-$Eu-$EV),$EO=this._weakKeys[8],$Ex?($EO!=$Ex.weakKey&&($EK.clearObject(this,$EO),$EK.keepObject(this,$Ex.weakKey),this._weakKeys[8]=$Ex.weakKey),this.drawBitmap($Ed,$Ex,$EE,$Eu,$Ee-$EE-$EG,$EL-$Eu-$EV)):($EK.clearObject(this,$EO),this._weakKeys[8]=""),$Er&&this.restore(),this.autoCacheCmd&&!$EX.isConchApp&&($EK.saveObject($EH,this.cmds,null),this._weakKey=$EH,$EK.keepObject(this,this._weakKey))}this._repaint()}},$EM.drawBitmap=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=0),$Ec<.1||$Eq<.1||(!$EM||$Ee.width==$Ec&&$Ee.height==$Eq?this.drawTexture($Ee,$EL,$E_,$Ec,$Eq):this.fillTexture($Ee,$EL,$E_,$Ec,$Eq))},$EM.clear=function($EM){void 0===$EM&&($EM=!0),$EL.prototype.clear.call(this,!1)},$EH(0,$EM,"sizeGrid",function(){return this._sizeGrid},function($EM){this._sizeGrid=$EM,this._setChanged()}),$EH(0,$EM,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($EM){this._width!=$EM&&(this._width=$EM,this._setChanged())}),$EH(0,$EM,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($EM){this._height!=$EM&&(this._height=$EM,this._setChanged())}),$EH(0,$EM,"source",function(){return this._source},function($EM){$EM?(this._source=$EM,this._setChanged()):(this._source=null,this.clear())}),$EC.getTexture=function($EM,$Ee,$EL,$E_,$Ec){$E_<=0&&($E_=1),$Ec<=0&&($Ec=1),$EM.$_GID||($EM.$_GID=$EA.getGID());var $Eq=$EM.$_GID+"."+$Ee+"."+$EL+"."+$E_+"."+$Ec,$EH=$EK.findObject($Eq);if((!$EH||!$EH.source)&&($EH=$EW.createFromTexture($EM,$Ee,$EL,$E_,$Ec))){if($EM.alphaTexture){var $ET=$EM.width/$EM.alphaTexture.width;$EH.alphaTexture=$EW.createFromTexture($EM.alphaTexture,$Ee/$ET,$EL/$ET,$E_/$ET,$Ec/$ET)}$EK.saveObject($Eq,$EH),$EH.weakKey=$Eq}return $EH},$EC}($Ee),$ER=(function($EM){function $Ee(){$Ee.__super.call(this)}$Eq($Ee,"laya.ui.UIEvent",$EO),$Ee.SHOW_TIP="showtip",$Ee.HIDE_TIP="hidetip"}(),function($Ee){function $EM(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$EM.__super.call(this),this._layout=$Ek.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$Eq($EM,"laya.ui.Component",$Ee);var $EL=$EM.prototype;return $Er.imps($EL,{"laya.ui.IComponent":!0}),$EL.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$EL.preinitialize=function(){},$EL.createChildren=function(){},$EL.initialize=function(){},$EL.callLater=function($EM,$Ee){$Er.timer.callLater(this,$EM,$Ee)},$EL.runCallLater=function($EM){$Er.timer.runCallLater(this,$EM)},$EL.commitMeasure=function(){},$EL.changeSize=function(){this.event("resize")},$EL.getLayout=function(){return this._layout===$Ek.EMPTY&&(this._layout=new $Ek),this._layout},$EL._setLayoutEnabled=function($EM){this._layout&&this._layout.enable!=$EM&&(this._layout.enable=$EM,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$EL.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$EL.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$EL.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$EL.resetLayoutX=function(){var $EM=this._layout;if(isNaN($EM.anchorX)||(this.pivotX=$EM.anchorX*this.width),this.layoutEnabled){var $Ee=this.parent;$Ee&&(isNaN($EM.centerX)?isNaN($EM.left)?isNaN($EM.right)||(this.x=Math.round($Ee.width-this.displayWidth-$EM.right+this.pivotX*this.scaleX)):(this.x=Math.round($EM.left+this.pivotX*this.scaleX),isNaN($EM.right)||(this.width=($Ee._width-$EM.left-$EM.right)/(this.scaleX||.01))):this.x=Math.round(.5*($Ee.width-this.displayWidth)+$EM.centerX+this.pivotX*this.scaleX))}},$EL.resetLayoutY=function(){var $EM=this._layout;if(isNaN($EM.anchorY)||(this.pivotY=$EM.anchorY*this.height),this.layoutEnabled){var $Ee=this.parent;$Ee&&(isNaN($EM.centerY)?isNaN($EM.top)?isNaN($EM.bottom)||(this.y=Math.round($Ee.height-this.displayHeight-$EM.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($EM.top+this.pivotY*this.scaleY),isNaN($EM.bottom)||(this.height=($Ee._height-$EM.top-$EM.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($Ee.height-this.displayHeight)+$EM.centerY+this.pivotY*this.scaleY))}},$EL.onMouseOver=function($EM){$Er.stage.event("showtip",this._toolTip)},$EL.onMouseOut=function($EM){$Er.stage.event("hidetip",this._toolTip)},$EH(0,$EL,"displayWidth",function(){return this.width*this.scaleX}),$EH(0,$EL,"width",function(){return this._width?this._width:this.measureWidth},function($EM){this._width!=$EM&&(this._width=$EM,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$EH(0,$EL,"measureWidth",function(){var $EM=0;this.commitMeasure();for(var $Ee=this.numChildren-1;-1<$Ee;$Ee--){var $EL=this.getChildAt($Ee);$EL.visible&&($EM=Math.max($EL.x+$EL.width*$EL.scaleX,$EM))}return $EM}),$EH(0,$EL,"displayHeight",function(){return this.height*this.scaleY}),$EH(0,$EL,"height",function(){return this._height?this._height:this.measureHeight},function($EM){this._height!=$EM&&(this._height=$EM,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$EH(0,$EL,"dataSource",function(){return this._dataSource},function($EM){for(var $Ee in this._dataSource=$EM,this._dataSource)this.hasOwnProperty($Ee)&&"function"!=typeof this[$Ee]&&(this[$Ee]=this._dataSource[$Ee])}),$EH(0,$EL,"scaleY",$Ee.prototype._$get_scaleY,function($EM){$Er.superGet($Eo,this,"scaleY")!=$EM&&($Er.superSet($Eo,this,"scaleY",$EM),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$EH(0,$EL,"measureHeight",function(){var $EM=0;this.commitMeasure();for(var $Ee=this.numChildren-1;-1<$Ee;$Ee--){var $EL=this.getChildAt($Ee);$EL.visible&&($EM=Math.max($EL.y+$EL.height*$EL.scaleY,$EM))}return $EM}),$EH(0,$EL,"scaleX",$Ee.prototype._$get_scaleX,function($EM){$Er.superGet($Eo,this,"scaleX")!=$EM&&($Er.superSet($Eo,this,"scaleX",$EM),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$EH(0,$EL,"top",function(){return this._layout.top},function($EM){$EM!=this._layout.top&&(this.getLayout().top=$EM,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$EH(0,$EL,"bottom",function(){return this._layout.bottom},function($EM){$EM!=this._layout.bottom&&(this.getLayout().bottom=$EM,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$EH(0,$EL,"left",function(){return this._layout.left},function($EM){$EM!=this._layout.left&&(this.getLayout().left=$EM,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$EH(0,$EL,"right",function(){return this._layout.right},function($EM){$EM!=this._layout.right&&(this.getLayout().right=$EM,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$EH(0,$EL,"centerX",function(){return this._layout.centerX},function($EM){$EM!=this._layout.centerX&&(this.getLayout().centerX=$EM,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$EH(0,$EL,"centerY",function(){return this._layout.centerY},function($EM){$EM!=this._layout.centerY&&(this.getLayout().centerY=$EM,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$EH(0,$EL,"anchorX",function(){return this._layout.anchorX},function($EM){$EM!=this._layout.anchorX&&(this.getLayout().anchorX=$EM,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$EH(0,$EL,"anchorY",function(){return this._layout.anchorY},function($EM){$EM!=this._layout.anchorY&&(this.getLayout().anchorY=$EM,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$EH(0,$EL,"tag",function(){return this._tag},function($EM){this._tag=$EM}),$EH(0,$EL,"toolTip",function(){return this._toolTip},function($EM){this._toolTip!=$EM&&(null!=(this._toolTip=$EM)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$EH(0,$EL,"comXml",function(){return this._comXml},function($EM){this._comXml=$EM}),$EH(0,$EL,"gray",function(){return this._gray},function($EM){$EM!==this._gray&&(this._gray=$EM,$Et.gray(this,$EM))}),$EH(0,$EL,"disabled",function(){return this._disabled},function($EM){$EM!==this._disabled&&(this.gray=this._disabled=$EM,this.mouseEnabled=!$EM)}),$EM}($Eo)),$Ea=function($EM){function $Ee(){this.lockLayer=null,this.popupEffect=function($EM){$EM.scale(1,1),$Ey.from($EM,{x:$Er.stage.width/2,y:$Er.stage.height/2,scaleX:0,scaleY:0},300,$Ex.backOut,$EV.create(this,this.doOpen,[$EM]))},this.closeEffect=function($EM,$Ee){$Ey.to($EM,{x:$Er.stage.width/2,y:$Er.stage.height/2,scaleX:0,scaleY:0},300,$Ex.strongOut,$EV.create(this,this.doClose,[$EM,$Ee]))},$Ee.__super.call(this),this.maskLayer=new $Eo,this.popupEffectHandler=$EV.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$EV.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$Er.stage.addChild(this),$Er.stage.on("resize",this,this._onResize),$ES.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$Eq($Ee,"laya.ui.DialogManager",$Eo);var $EL=$Ee.prototype;return $EL._closeOnSide=function(){var $EM=this.getChildAt(this.numChildren-1);$EM instanceof laya.ui.Dialog&&$EM.close("side")},$EL.setLockView=function($EM){this.lockLayer||(this.lockLayer=new $En,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($Er.stage.width,$Er.stage.height)),this.lockLayer.removeChildren(),$EM&&($EM.centerX=$EM.centerY=0,this.lockLayer.addChild($EM))},$EL._onResize=function($EM){var $Ee=this.maskLayer.width=$Er.stage.width,$EL=this.maskLayer.height=$Er.stage.height;this.lockLayer&&this.lockLayer.size($Ee,$EL),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$Ee,$EL,$ES.popupBgColor),this.maskLayer.alpha=$ES.popupBgAlpha;for(var $E_=this.numChildren-1;-1<$E_;$E_--){var $Ec=this.getChildAt($E_);$Ec.popupCenter&&this._centerDialog($Ec)}},$EL._centerDialog=function($EM){$EM.x=Math.round(($Er.stage.width-$EM.width>>1)+$EM.pivotX),$EM.y=Math.round(($Er.stage.height-$EM.height>>1)+$EM.pivotY)},$EL.open=function($EM,$Ee,$EL){void 0===$Ee&&($Ee=!1),void 0===$EL&&($EL=!1),$Ee&&this._closeAll(),$EM.popupCenter&&this._centerDialog($EM),this.addChild($EM),($EM.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$EL&&null!=$EM.popupEffect?$EM.popupEffect.runWith($EM):this.doOpen($EM),this.event("open")},$EL.doOpen=function($EM){$EM.onOpened()},$EL.lock=function($EM){this.lockLayer&&($EM?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$EL.close=function($EM,$Ee,$EL){void 0===$EL&&($EL=!1),$EL&&null!=$EM.closeEffect?$EM.closeEffect.runWith([$EM,$Ee]):this.doClose($EM,$Ee),this.event("close")},$EL.doClose=function($EM,$Ee){$EM.removeSelf(),$EM.isModal&&this._checkMask(),$EM.closeHandler&&$EM.closeHandler.runWith($Ee),$EM.onClosed($Ee)},$EL.closeAll=function(){this._closeAll(),this.event("close")},$EL._closeAll=function(){for(var $EM=this.numChildren-1;-1<$EM;$EM--){var $Ee=this.getChildAt($EM);$Ee&&null!=$Ee.close&&this.doClose($Ee)}},$EL.getDialogsByGroup=function($EM){for(var $Ee=[],$EL=this.numChildren-1;-1<$EL;$EL--){var $E_=this.getChildAt($EL);$E_&&$E_.group===$EM&&$Ee.push($E_)}return $Ee},$EL.closeByGroup=function($EM){for(var $Ee=[],$EL=this.numChildren-1;-1<$EL;$EL--){var $E_=this.getChildAt($EL);$E_&&$E_.group===$EM&&($E_.close(),$Ee.push($E_))}return $Ee},$EL._checkMask=function(){this.maskLayer.removeSelf();for(var $EM=this.numChildren-1;-1<$EM;$EM--){var $Ee=this.getChildAt($EM);if($Ee&&$Ee.isModal)return void this.addChildAt(this.maskLayer,$EM)}},$Ee}(),$En=function($EM){function $Ee(){$Ee.__super.call(this)}$Eq($Ee,"laya.ui.Box",$EM);var $EL=$Ee.prototype;return $Er.imps($EL,{"laya.ui.IBox":!0}),$EH(0,$EL,"dataSource",$EM.prototype._$get_dataSource,function($EM){for(var $Ee in this._dataSource=$EM){var $EL=this.getChildByName($Ee);$EL?$EL.dataSource=$EM[$Ee]:this.hasOwnProperty($Ee)&&"function"!=typeof this[$Ee]&&(this[$Ee]=$EM[$Ee])}}),$Ee}($ER),$El=function($Ee){function $EL($EM,$Ee){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$EL.__super.call(this),this._labelColors=$Eh.buttonLabelColors,this._stateNum=$Eh.buttonStateNum,void 0===$Ee&&($Ee=""),this.skin=$EM,this.label=$Ee}$Eq($EL,"laya.ui.Button",$Ee);var $EM=$EL.prototype;return $Er.imps($EM,{"laya.ui.ISelect":!0}),$EM.destroy=function($EM){this.clearEvent(),$EK.clearCache(this,this._skin),$EK.clearObject(this,this._weakKey),void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($EM),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$EM.clearEvent=function(){this._skin&&$Ec.atalsNotify&&$Ec.atalsNotify.off(this._skin,this,this._setBtnSource)},$EM.createChildren=function(){this.graphics=this._bitmap=new $Ep},$EM.createText=function(){this._text||(this._text=new $Ei,this._text.overflow=$Ei.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$EM.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$EM.onMouse=function($EM){if(!1!==this.toggle||!this._selected)return"click"===$EM.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$EL.stateMap[$EM.type]))},$EM.changeClips=function(){var $EM=$EK.getRes(this._skin);if($EM)if(this._skin&&""!=this._skin){$EK.clearObject(this,this._weakKey);var $Ee=$EM.sourceWidth,$EL=$EM.sourceHeight/this._stateNum;$EM.$_GID||($EM.$_GID=$EA.getGID());var $E_=$EM.$_GID+"-"+this._stateNum,$Ec=$EK.findObject($E_);if($EA.isOkTextureList($Ec)||($Ec=null),$Ec)this._weakKey=$E_,$EK.keepObject(this,this._weakKey),this._sources=$Ec;else{if(this._sources=[],1===this._stateNum)this._sources.push($EM);else for(var $Eq=0;$Eq<this._stateNum;$Eq++){var $EH=$EW.createFromTexture($EM,0,$EL*$Eq,$Ee,$EL);if($EM.alphaTexture){var $ET=$EM.width/$EM.alphaTexture.width;$EH.alphaTexture=$EW.createFromTexture($EM.alphaTexture,0/$ET,$EL*$Eq/$ET,$Ee/$ET,$EL/$ET)}this._sources.push($EH)}$EK.saveObject($E_,this._sources),this._weakKey=$E_,$EK.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$Ee,this._bitmap.height=this._height||$EL,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$Ee)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$EM.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $EM=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$EM]),this.label&&(this._text.color=this._labelColors[$EM],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$EM]))},$EM._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$EH(0,$EM,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($EM){this.createText(),this._text.strokeColor=$EM}),$EH(0,$EM,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$EH(0,$EM,"skin",function(){return this._skin},function($EM){if(this._skin!=$EM)if(this.clearEvent(),$EK.clearCache(this,this._skin),this._skin=$EM,$EK.keepCache(this,this._skin),$EK.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $Ee=$Ec.resAtalsObj&&$Ec.resAtalsObj[this._skin];$Ee?($Ec.atalsNotify&&$Ec.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$Ee.sourceW),0==this.height&&(this.height=$Ee.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),$EM._setBtnSource=function($EM,$Ee){$EM===this._skin&&$Ee&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},$EH(0,$EM,"state",function(){return this._state},function($EM){this._state!=$EM&&(this._state=$EM,this._setStateChanged())}),$EH(0,$EM,"text",function(){return this.createText(),this._text}),$EH(0,$EM,"stateNum",function(){return this._stateNum},function($EM){"string"==typeof $EM&&($EM=parseInt($EM)),this._stateNum!=$EM&&(this._stateNum=$EM<1?1:3<$EM?3:$EM,this.callLater(this.changeClips))}),$EH(0,$EM,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($EM){this._strokeColors=$Et.fillArray($Eh.buttonLabelColors,$EM,String),this._setStateChanged()}),$EH(0,$EM,"labelColors",function(){return this._labelColors.join(",")},function($EM){this._labelColors=$Et.fillArray($Eh.buttonLabelColors,$EM,String),this._setStateChanged()}),$EH(0,$EM,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$EH(0,$EM,"label",function(){return this._text?this._text.text:null},function($EM){(this._text||$EM)&&(this.createText(),this._text.text!=$EM&&($EM&&!this._text.parent&&this.addChild(this._text),this._text.text=($EM+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$EH(0,$EM,"selected",function(){return this._selected},function($EM){this._selected!=$EM&&(this._selected=$EM,this.state=this._selected?2:0,this.event("change"))}),$EH(0,$EM,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($EM){this.createText(),this._text.padding=$Et.fillArray($Eh.labelPadding,$EM,Number)}),$EH(0,$EM,"labelSize",function(){return this.createText(),this._text.fontSize},function($EM){this.createText(),this._text.fontSize=$EM}),$EH(0,$EM,"labelStroke",function(){return this.createText(),this._text.stroke},function($EM){this.createText(),this._text.stroke=$EM}),$EH(0,$EM,"labelBold",function(){return this.createText(),this._text.bold},function($EM){this.createText(),this._text.bold=$EM}),$EH(0,$EM,"labelFont",function(){return this.createText(),this._text.font},function($EM){this.createText(),this._text.font=$EM}),$EH(0,$EM,"labelAlign",function(){return this.createText(),this._text.align},function($EM){this.createText(),this._text.align=$EM}),$EH(0,$EM,"clickHandler",function(){return this._clickHandler},function($EM){this._clickHandler=$EM}),$EH(0,$EM,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($EM){this._bitmap.sizeGrid=$Et.fillArray($Eh.defaultSizeGrid,$EM,Number)}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($ER,this,"width",$EM),this._autoSize&&(this._bitmap.width=$EM,this._text&&(this._text.width=$EM))}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($ER,this,"height",$EM),this._autoSize&&(this._bitmap.height=$EM,this._text&&(this._text.height=$EM))}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)||"string"==typeof $EM?this.label=$EM+"":$Er.superSet($ER,this,"dataSource",$EM)}),$EH(0,$EM,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($EM){this._bitmap._offset=$EM?$Et.fillArray([1,1],$EM,Number):[]}),$E_($EL,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$EL}($ER),$Ef=function($Ee){function $E_($EM,$Ee,$EL){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$E_.__super.call(this),void 0===$Ee&&($Ee=1),void 0===$EL&&($EL=1),this._clipX=$Ee,this._clipY=$EL,this.skin=$EM}$Eq($E_,"laya.ui.Clip",$Ee);var $EM=$E_.prototype;return $EM.destroy=function($EM){this.clearEvent(),this.clearLoad(),$EK.clearCache(this,this._skin),$EK.clearObject(this,this._weakKey),void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$EM.dispose=function(){this.destroy(!0),$Er.loader.clearRes(this._skin)},$EM.createChildren=function(){this.graphics=this._bitmap=new $Ep},$EM._onDisplay=function($EM){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$EM.changeClip=function(){if(this._clipChanged=!1,this._skin){var $EM=$EK.getRes(this._skin);if($EM)this.loadComplete(this._skin,$EM);else{if($Ec.resAtalsObj&&$Ec.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$EV.create(this,this.loadComplete,[this._skin]),this._progress=null,$Er.loader.load(this._skin,this._complete,this._progress)}}},$EM.loadComplete=function($EM,$Ee){if($EM===this._skin&&$Ee){$EK.clearObject(this,this._weakKey);var $EL=this._clipWidth||Math.ceil($Ee.sourceWidth/this._clipX),$E_=this._clipHeight||Math.ceil($Ee.sourceHeight/this._clipY),$Ec=this._skin+$EL+$E_,$Eq=$EK.findObject($Ec);if($EA.isOkTextureList($Eq)||($Eq=null),$Eq)this._weakKey=$Ec,$EK.keepObject(this,this._weakKey),this._sources=$Eq;else{this._sources=[];for(var $EH=0;$EH<this._clipY;$EH++)for(var $ET=0;$ET<this._clipX;$ET++){var $Ex=$EW.createFromTexture($Ee,$EL*$ET,$E_*$EH,$EL,$E_);if($Ee.alphaTexture){var $EO=$Ee.width/$Ee.alphaTexture.width;$Ex.alphaTexture=$EW.createFromTexture($Ee.alphaTexture,$EL*$ET/$EO,$E_*$EH/$EO,$EL/$EO,$E_/$EO)}this._sources.push($Ex)}$EK.saveObject($Ec,this._sources),this._weakKey=$Ec,$EK.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$EM.play=function($EM,$Ee){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=-1),this._isPlaying=!0,this.index=$EM,this._toIndex=$Ee,this._index++,$Er.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$EM._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$EM.stop=function(){this._isPlaying=!1,$Er.timer.clear(this,this._loop),this.event("complete")},$EM._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$EH(0,$EM,"interval",function(){return this._interval},function($EM){this._interval!=$EM&&(this._interval=$EM,this._isPlaying&&this.play())}),$EM.clearEvent=function(){this._skin&&$Ec.atalsNotify&&$Ec.atalsNotify.off(this._skin,this,this._setBtnSource)},$EM.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$Er.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$EH(0,$EM,"skin",function(){return this._skin},function($EM){if(this._skin!=$EM)if(this.clearLoad(),this.clearEvent(),$EK.clearCache(this,this._skin),this._skin=$EM){$EK.keepCache(this,this._skin);var $Ee=$EK.getRes($EM),$EL=$Ec.resAtalsObj&&$Ec.resAtalsObj[this._skin];!$Ee&&$EL?$Ec.atalsNotify&&$Ec.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),$EM._setBtnSource=function($EM,$Ee){$EM===this._skin&&$Ee&&(this.loadComplete($EM,$Ee),this.clearEvent())},$EH(0,$EM,"sources",function(){return this._sources},function($EM){this._sources=$EM,this.index=this._index,this.event("loaded")}),$EH(0,$EM,"clipX",function(){return this._clipX},function($EM){this._clipX=$EM||1,this._setClipChanged()}),$EH(0,$EM,"clipY",function(){return this._clipY},function($EM){this._clipY=$EM||1,this._setClipChanged()}),$EH(0,$EM,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$EH(0,$EM,"clipWidth",function(){return this._clipWidth},function($EM){this._clipWidth=$EM,this._setClipChanged()}),$EH(0,$EM,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($EM){this._bitmap.sizeGrid=$Et.fillArray($Eh.defaultSizeGrid,$EM,Number)}),$EH(0,$EM,"group",function(){return this._group},function($EM){$EM&&this._skin&&$EK.setGroup(this._skin,$EM),this._group=$EM}),$EH(0,$EM,"clipHeight",function(){return this._clipHeight},function($EM){this._clipHeight=$EM,this._setClipChanged()}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($ER,this,"width",$EM),this._bitmap.width=$EM}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($ER,this,"height",$EM),this._bitmap.height=$EM}),$EH(0,$EM,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$EH(0,$EM,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$EH(0,$EM,"index",function(){return this._index},function($EM){this._index=$EM,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$EM]),this.event("change")}),$EH(0,$EM,"autoPlay",function(){return this._autoPlay},function($EM){this._autoPlay!=$EM&&((this._autoPlay=$EM)?this.play():this.stop())}),$EH(0,$EM,"isPlaying",function(){return this._isPlaying},function($EM){this._isPlaying=$EM}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)&&Math.floor($EM)==$EM||"string"==typeof $EM?this.index=parseInt($EM):$Er.superSet($ER,this,"dataSource",$EM)}),$EH(0,$EM,"bitmap",function(){return this._bitmap}),$E_}($ER),$Ej=function($Ee){function $EM(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$EM.__super.call(this)}$Eq($EM,"laya.ui.ColorPicker",$Ee);var $EL=$EM.prototype;return $EL.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._colorPanel&&this._colorPanel.destroy($EM),this._colorButton&&this._colorButton.destroy($EM),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$EL.createChildren=function(){this.addChild(this._colorButton=new $El),this._colorPanel=new $En,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $Eo),this._colorPanel.addChild(this._colorBlock=new $Eo),this._colorPanel.addChild(this._colorInput=new $EE)},$EL.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$EL.onPanelMouseDown=function($EM){$EM.stopPropagation()},$EL.changePanel=function(){this._panelChanged=!1;var $EM=this._colorPanel.graphics;$EM.clear(),$EM.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($EM=this._colorTiles.graphics).clear();for(var $Ee=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$EL=0;$EL<12;$EL++)for(var $E_=0;$E_<20;$E_++){var $Ec=0;$Ec=0===$E_?$Ee[$EL]:1===$E_?0:51*(((3*$EL+$E_/6)%3<<0)+3*($EL/6<<0))<<16|$E_%6*51<<8|($EL<<0)%6*51;var $Eq=$Et.toColor($Ec);this._colors.push($Eq);var $EH=$E_*this._gridSize,$ET=$EL*this._gridSize;$EM.drawRect($EH,$ET,this._gridSize,this._gridSize,$Eq,"#000000")}},$EL.onColorButtonClick=function($EM){this._colorPanel.parent?this.close():this.open()},$EL.open=function(){var $EM=this.localToGlobal(new $Ed),$Ee=$EM.x+this._colorPanel.width<=$Er.stage.width?$EM.x:$Er.stage.width-this._colorPanel.width,$EL=$EM.y+this._colorButton.height;$EL=$EL+this._colorPanel.height<=$Er.stage.height?$EL:$EM.y-this._colorPanel.height,this._colorPanel.pos($Ee,$EL),this._colorPanel.zOrder=1001,$Er._currentStage.addChild(this._colorPanel),$Er.stage.on("mousedown",this,this.removeColorBox)},$EL.close=function(){$Er.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$EL.removeColorBox=function($EM){this.close()},$EL.onColorFieldKeyDown=function($EM){13==$EM.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$EM.stopPropagation())},$EL.onColorInputChange=function($EM){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$EL.onColorTilesClick=function($EM){this.selectedColor=this.getColorByMouse(),this.close()},$EL.onColorTilesMouseMove=function($EM){this._colorInput.focus=!1;var $Ee=this.getColorByMouse();this._colorInput.text=$Ee,this.drawBlock($Ee)},$EL.getColorByMouse=function(){var $EM=this._colorTiles.getMousePoint(),$Ee=Math.floor($EM.x/this._gridSize),$EL=Math.floor($EM.y/this._gridSize);return this._colors[20*$EL+$Ee]},$EL.drawBlock=function($EM){var $Ee=this._colorBlock.graphics;$Ee.clear();var $EL=$EM||"#ffffff";$Ee.drawRect(0,0,50,20,$EL,this._borderColor),$EM||$Ee.drawLine(0,0,50,20,"#ff0000")},$EL.changeColor=function(){var $EM=this.graphics;$EM.clear();var $Ee=this._selectedColor||"#000000";$EM.drawRect(0,0,this._colorButton.width,this._colorButton.height,$Ee)},$EL._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$EH(0,$EL,"inputBgColor",function(){return this._inputBgColor},function($EM){this._inputBgColor=$EM,this._setPanelChanged()}),$EH(0,$EL,"selectedColor",function(){return this._selectedColor},function($EM){this._selectedColor!=$EM&&(this._selectedColor=this._colorInput.text=$EM,this.drawBlock($EM),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$EO.EMPTY.setTo("change",this,this)))}),$EH(0,$EL,"skin",function(){return this._colorButton.skin},function($EM){this._colorButton.skin=$EM,this.changeColor()}),$EH(0,$EL,"bgColor",function(){return this._bgColor},function($EM){this._bgColor=$EM,this._setPanelChanged()}),$EH(0,$EL,"borderColor",function(){return this._borderColor},function($EM){this._borderColor=$EM,this._setPanelChanged()}),$EH(0,$EL,"inputColor",function(){return this._inputColor},function($EM){this._inputColor=$EM,this._setPanelChanged()}),$EM}($ER),$EF=function($Ee){function $EL($EM,$Ee){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$EL.__super.call(this),this._itemColors=$Eh.comboBoxItemColors,this.skin=$EM,this.labels=$Ee}$Eq($EL,"laya.ui.ComboBox",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._button&&this._button.destroy($EM),this._list&&this._list.destroy($EM),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$EM.createChildren=function(){this.addChild(this._button=new $El),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$EM._createList=function(){this._list=new $EZ,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$EM._setListEvent=function($EM){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$EV.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$EM.onListDown=function($EM){$EM.stopPropagation()},$EM.onScrollBarDown=function($EM){$EM.stopPropagation()},$EM.onButtonMouseDown=function($EM){this.callLater(this.switchTo,[!this._isOpen])},$EM.changeList=function(){this._listChanged=!1;var $EM=this.width-2,$Ee=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$EM,height:this._itemHeight,fontSize:this._itemSize,color:$Ee}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$EM.onlistItemMouse=function($EM,$Ee){var $EL=$EM.type;if("mouseover"===$EL||"mouseout"===$EL){if(this._isCustomList)return;var $E_=this._list.getCell($Ee);if(!$E_)return;var $Ec=$E_.getChildByName("label");$Ec&&("mouseover"===$EL?($Ec.bgColor=this._itemColors[0],$Ec.color=this._itemColors[1]):($Ec.bgColor=null,$Ec.color=this._itemColors[2]))}else"click"===$EL&&(this.selectedIndex=$Ee,this.isOpen=!1)},$EM.switchTo=function($EM){this.isOpen=$EM},$EM.changeOpen=function(){this.isOpen=!this._isOpen},$EM.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $EM=this._list.graphics;$EM.clear(),$EM.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $Ee=this._list.array||[],$EL=$Ee.length=0,$E_=this._labels.length;$EL<$E_;$EL++)$Ee.push({label:this._labels[$EL]});this._list.height=this._listHeight,this._list.array=$Ee},$EM.changeSelected=function(){this._button.label=this.selectedLabel},$EM._onStageMouseWheel=function($EM){this._list&&!this._list.contains($EM.target)&&this.removeList(null)},$EM.removeList=function($EM){$Er.stage.off("mousedown",this,this.removeList),$Er.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$EH(0,$EM,"selectedIndex",function(){return this._selectedIndex},function($EM){this._selectedIndex!=$EM&&(this._selectedIndex=$EM,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$EO.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$EH(0,$EM,"measureHeight",function(){return this._button.height}),$EH(0,$EM,"skin",function(){return this._button.skin},function($EM){this._button.skin!=$EM&&(this._button.skin=$EM,this._listChanged=!0)}),$EH(0,$EM,"measureWidth",function(){return this._button.width}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($ER,this,"width",$EM),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$EH(0,$EM,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($EM){this.selectedIndex=this._labels.indexOf($EM)}),$EH(0,$EM,"labels",function(){return this._labels.join(",")},function($EM){0<this._labels.length&&(this.selectedIndex=-1),$EM?this._labels=$EM.split(","):this._labels.length=0,this._itemChanged=!0}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($ER,this,"height",$EM),this._button.height=this._height}),$EH(0,$EM,"selectHandler",function(){return this._selectHandler},function($EM){this._selectHandler=$EM}),$EH(0,$EM,"visibleNum",function(){return this._visibleNum},function($EM){this._visibleNum=$EM,this._listChanged=!0}),$EH(0,$EM,"labelBold",function(){return this._button.text.bold},function($EM){this._button.text.bold=$EM}),$EH(0,$EM,"itemColors",function(){return String(this._itemColors)},function($EM){this._itemColors=$Et.fillArray(this._itemColors,$EM,String),this._listChanged=!0}),$EH(0,$EM,"itemSize",function(){return this._itemSize},function($EM){this._itemSize=$EM,this._listChanged=!0}),$EH(0,$EM,"scrollBar",function(){return this.list.scrollBar}),$EH(0,$EM,"isOpen",function(){return this._isOpen},function($EM){if(this._isOpen!=$EM)if(this._isOpen=$EM,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $Ee=this.localToGlobal($Ed.TEMP.setTo(0,0)),$EL=$Ee.y+this._button.height;$EL=$EL+this._listHeight<=$Er.stage.height?$EL:$Ee.y-this._listHeight,this._list.pos($Ee.x,$EL),this._list.zOrder=1001,$Er._currentStage.addChild(this._list),$Er.stage.once("mousedown",this,this.removeList),$Er.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$EH(0,$EM,"scrollBarSkin",function(){return this._scrollBarSkin},function($EM){this._scrollBarSkin=$EM}),$EH(0,$EM,"sizeGrid",function(){return this._button.sizeGrid},function($EM){this._button.sizeGrid=$EM}),$EH(0,$EM,"button",function(){return this._button}),$EH(0,$EM,"list",function(){return this._list||this._createList(),this._list},function($EM){$EM&&($EM.removeSelf(),this._isCustomList=!0,this._list=$EM,this._setListEvent($EM),this._itemHeight=$EM.getCell(0).height+$EM.spaceY)}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)&&Math.floor($EM)==$EM||"string"==typeof $EM?this.selectedIndex=parseInt($EM):$EM instanceof Array?this.labels=$EM.join(","):$Er.superSet($ER,this,"dataSource",$EM)}),$EH(0,$EM,"labelColors",function(){return this._button.labelColors},function($EM){this._button.labelColors!=$EM&&(this._button.labelColors=$EM)}),$EH(0,$EM,"labelPadding",function(){return this._button.text.padding.join(",")},function($EM){this._button.text.padding=$Et.fillArray($Eh.labelPadding,$EM,Number)}),$EH(0,$EM,"labelSize",function(){return this._button.text.fontSize},function($EM){this._button.text.fontSize=$EM}),$EH(0,$EM,"labelFont",function(){return this._button.text.font},function($EM){this._button.text.font=$EM}),$EH(0,$EM,"stateNum",function(){return this._button.stateNum},function($EM){this._button.stateNum=$EM}),$EL}($ER),$Eg=function($Ee){function $EL($EM){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$EL.__super.call(this),this._showButtons=$ES.showButtons,this._touchScrollEnable=$ES.touchScrollEnable,this._mouseWheelEnable=$ES.mouseWheelEnable,this.skin=$EM,this.max=1}$Eq($EL,"laya.ui.ScrollBar",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),this.stopScroll(),this.target=null,$Ee.prototype.destroy.call(this,$EM),this.upButton&&this.upButton.destroy($EM),this.downButton&&this.downButton.destroy($EM),this.slider&&this.slider.destroy($EM),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$EM.createChildren=function(){this.addChild(this.slider=new $EJ),this.addChild(this.upButton=new $El),this.addChild(this.downButton=new $El)},$EM.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$EM.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$EM.onButtonMouseDown=function($EM){var $Ee=$EM.currentTarget===this.upButton;this.slide($Ee),$Er.timer.once($Eh.scrollBarDelayTime,this,this.startLoop,[$Ee]),$Er.stage.once("mouseup",this,this.onStageMouseUp)},$EM.startLoop=function($EM){$Er.timer.frameLoop(1,this,this.slide,[$EM])},$EM.slide=function($EM){$EM?this.value-=this._scrollSize:this.value+=this._scrollSize},$EM.onStageMouseUp=function($EM){$Er.timer.clear(this,this.startLoop),$Er.timer.clear(this,this.slide)},$EM.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$EM.changeSize=function(){$Ee.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$EM.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$EM.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$EM.setScroll=function($EM,$Ee,$EL){this.runCallLater(this.changeSize),this.slider.setSlider($EM,$Ee,$EL),this.slider.bar.visible=0<$Ee,!this._hide&&this.autoHide&&(this.visible=!1)},$EM.onTargetMouseWheel=function($EM){this.value-=$EM.delta*this._scrollSize,this.target=this._target},$EM.onTargetMouseDown=function($EM){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $Ed),this._lastPoint.setTo($Er.stage.mouseX,$Er.stage.mouseY),$Er.timer.clear(this,this.tweenMove),$Ey.clearTween(this),$Er.stage.once("mouseup",this,this.onStageMouseUp2),$Er.stage.once("mouseout",this,this.onStageMouseUp2),$Er.timer.frameLoop(1,this,this.loop)},$EM.loop=function(){var $EM=$Er.stage.mouseY,$Ee=$Er.stage.mouseX;if(this._lastOffset=this.isVertical?$EM-this._lastPoint.y:$Ee-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$Er.stage._canvasTransform.getScaleY():$Er.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$Ee,this._lastPoint.y=$EM,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$EM.onStageMouseUp2=function($EM){if($Er.stage.off("mouseup",this,this.onStageMouseUp2),$Er.stage.off("mouseout",this,this.onStageMouseUp2),$Er.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$Ey.to(this,{value:this.min},this.elasticBackTime,$Ex.sineOut,$EV.create(this,this.elasticOver)):this._value>this.max&&$Ey.to(this,{value:this.max},this.elasticBackTime,$Ex.sineOut,$EV.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$Er.stage.mouseY-this._lastPoint.y:$Er.stage.mouseX-this._lastPoint.x);for(var $Ee=0,$EL=Math.min(this._offsets.length,3),$E_=0;$E_<$EL;$E_++)$Ee+=this._offsets[this._offsets.length-1-$E_];if(this._lastOffset=$Ee/$EL,($Ee=Math.abs(this._lastOffset))<2)return void this.event("end");60<$Ee&&(this._lastOffset=0<this._lastOffset?60:-60);var $Ec=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$Er.timer.frameLoop(1,this,this.tweenMove,[$Ec])}},$EM.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$Ey.to(this,{alpha:0},500),this.event("end")},$EM.tweenMove=function($EM){this._lastOffset*=this.rollRatio;var $Ee=NaN;if(0<$EM&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$Ee=.5*-(this.min-$EM-this.value),this._lastOffset>$Ee&&(this._lastOffset=$Ee)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$Ee=.5*-(this.max+$EM-this.value),this._lastOffset<$Ee&&(this._lastOffset=$Ee))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($Er.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$Ey.to(this,{value:this.min},this.elasticBackTime,$Ex.sineOut,$EV.create(this,this.elasticOver)):this._value>this.max?$Ey.to(this,{value:this.max},this.elasticBackTime,$Ex.sineOut,$EV.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$Ey.to(this,{alpha:0},500)}},$EM.stopScroll=function(){this.onStageMouseUp2(null),$Er.timer.clear(this,this.tweenMove),$Ey.clearTween(this)},$EH(0,$EM,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$EH(0,$EM,"skin",function(){return this._skin},function($EM){this._skin!=$EM&&(this._skin=$EM,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$EH(0,$EM,"max",function(){return this.slider.max},function($EM){this.slider.max=$EM}),$EH(0,$EM,"showButtons",function(){return this._showButtons},function($EM){this._showButtons=$EM,this.callLater(this.changeScrollBar)}),$EH(0,$EM,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$EH(0,$EM,"min",function(){return this.slider.min},function($EM){this.slider.min=$EM}),$EH(0,$EM,"value",function(){return this._value},function($EM){$EM!==this._value&&(this._value=$EM,this._isElastic||(this.slider._value!=$EM&&(this.slider._value=$EM,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$EH(0,$EM,"isVertical",function(){return this.slider.isVertical},function($EM){this.slider.isVertical=$EM}),$EH(0,$EM,"sizeGrid",function(){return this.slider.sizeGrid},function($EM){this.slider.sizeGrid=$EM}),$EH(0,$EM,"scrollSize",function(){return this._scrollSize},function($EM){this._scrollSize=$EM}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)||"string"==typeof $EM?this.value=Number($EM):$Er.superSet($ER,this,"dataSource",$EM)}),$EH(0,$EM,"thumbPercent",function(){return this._thumbPercent},function($EM){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$EM=1<=$EM?.99:$EM,this._thumbPercent=$EM,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$EM,$Eh.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$EM,$Eh.scrollBarMinNum))}),$EH(0,$EM,"target",function(){return this._target},function($EM){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$EM)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$EH(0,$EM,"hide",function(){return this._hide},function($EM){this._hide=$EM,this.visible=!$EM}),$EH(0,$EM,"touchScrollEnable",function(){return this._touchScrollEnable},function($EM){this._touchScrollEnable=$EM,this.target=this._target}),$EH(0,$EM,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($EM){this._mouseWheelEnable=$EM,this.target=this._target}),$EH(0,$EM,"tick",function(){return this.slider.tick},function($EM){this.slider.tick=$EM}),$EL}($ER),$EJ=function($Ee){function $EL($EM){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$EL.__super.call(this),this.skin=$EM}$Eq($EL,"laya.ui.Slider",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._bg&&this._bg.destroy($EM),this._bar&&this._bar.destroy($EM),this._progress&&this._progress.destroy($EM),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$EM.createChildren=function(){this.addChild(this._bg=new $Ew),this.addChild(this._bar=new $El)},$EM.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$EM.onBarMouseDown=function($EM){this._globalSacle||(this._globalSacle=new $Ed),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$Er.stage.mouseX,this._ty=$Er.stage.mouseY,$Er.stage.on("mousemove",this,this.mouseMove),$Er.stage.once("mouseup",this,this.mouseUp),$Er.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$EM.showValueText=function(){if(this.showLabel){var $EM=laya.ui.Slider.label;this.addChild($EM),$EM.textField.changeText(this._value+""),this.isVertical?($EM.x=this._bar.x+20,$EM.y=.5*(this._bar.height-$EM.height)+this._bar.y):($EM.y=this._bar.y-20,$EM.x=.5*(this._bar.width-$EM.width)+this._bar.x)}},$EM.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$EM.mouseUp=function($EM){$Er.stage.off("mousemove",this,this.mouseMove),$Er.stage.off("mouseup",this,this.mouseUp),$Er.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$EM.mouseMove=function($EM){var $Ee=this._value;this.isVertical?(this._bar.y+=($Er.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($Er.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$Er.stage.mouseX,this._ty=$Er.stage.mouseY;var $EL=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$EL)/$EL,this._value!=$Ee&&this.sendChangeEvent(),this.showValueText()},$EM.sendChangeEvent=function($EM){void 0===$EM&&($EM="change"),this.event($EM),this.changeHandler&&this.changeHandler.runWith(this._value)},$EM.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$EM.changeSize=function(){$Ee.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$EM.setSlider=function($EM,$Ee,$EL){this._value=-1,this._min=$EM,this._max=$EM<$Ee?$Ee:$EM,this.value=$EL<$EM?$EM:$Ee<$EL?$Ee:$EL},$EM.changeValue=function(){var $EM=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$EM)/$EM,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $Ee=this._max-this._min;0===$Ee&&($Ee=1),this.isVertical?(this._bar.y=(this._value-this._min)/$Ee*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$Ee*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$EM.onBgMouseDown=function($EM){var $Ee=this._bg.getMousePoint();this.isVertical?this.value=$Ee.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$Ee.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$EH(0,$EM,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$EH(0,$EM,"skin",function(){return this._skin},function($EM){if(this._skin!=$EM){this._skin=$EM,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $Ee=this._skin.replace(".png","$progress.png");$EK.getRes($Ee)&&(this._progress||(this.addChild(this._progress=new $Ew),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$Ee),this.setBarPoint(),this.callLater(this.changeValue)}}),$EH(0,$EM,"allowClickBack",function(){return this._allowClickBack},function($EM){this._allowClickBack!=$EM&&((this._allowClickBack=$EM)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$EH(0,$EM,"max",function(){return this._max},function($EM){this._max!=$EM&&(this._max=$EM,this.callLater(this.changeValue))}),$EH(0,$EM,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$EH(0,$EM,"tick",function(){return this._tick},function($EM){this._tick!=$EM&&(this._tick=$EM,this.callLater(this.changeValue))}),$EH(0,$EM,"sizeGrid",function(){return this._bg.sizeGrid},function($EM){this._bg.sizeGrid=$EM,this._bar.sizeGrid=$EM,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$EH(0,$EM,"min",function(){return this._min},function($EM){this._min!=$EM&&(this._min=$EM,this.callLater(this.changeValue))}),$EH(0,$EM,"value",function(){return this._value},function($EM){if(this._value!=$EM){var $Ee=this._value;this._value=$EM,this.changeValue(),this._value!=$Ee&&this.sendChangeEvent()}}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)||"string"==typeof $EM?this.value=Number($EM):$Er.superSet($ER,this,"dataSource",$EM)}),$EH(0,$EM,"bar",function(){return this._bar}),$E_($EL,["label",function(){return this.label=new $Eb}]),$EL}($ER),$Ew=function($Ee){function $EL($EM){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$EL.__super.call(this),this.skin=$EM}$Eq($EL,"laya.ui.Image",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$EK.clearCache(this,this._skin)},$EM.dispose=function(){this.destroy(!0),$EK.clearCache(this,this._skin),this.clearEvent()},$EM.createChildren=function(){this.graphics=this._bitmap=new $Ep},$EM.setSource=function($EM,$Ee){$EM===this._skin&&$Ee&&(this.source=$Ee,this.onCompResize(),this.clearEvent())},$EM.clearEvent=function(){this._skin&&$Ec.atalsNotify&&$Ec.atalsNotify.off(this._skin,this,this.setSource)},$EM.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$Er.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$EH(0,$EM,"source",function(){return this._bitmap.source},function($EM){this._bitmap&&(this._bitmap.source=$EM,this.event("loaded"),this.repaint())}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"string"==typeof(this._dataSource=$EM)?this.skin=$EM:$Er.superSet($ER,this,"dataSource",$EM)}),$EH(0,$EM,"measureHeight",function(){return this._bitmap.height}),$EH(0,$EM,"skin",function(){return this._skin},function($EM){if(this._skin!=$EM)if($EK.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$EM){$EK.keepCache(this,this._skin);var $Ee=$EK.getRes($EM),$EL=$Ec.resAtalsObj&&$Ec.resAtalsObj[this._skin];$Ee?(this.source=$Ee,this.onCompResize()):$EL?($Ec.atalsNotify&&$Ec.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$EL.sourceW),0==this.height&&(this.height=$EL.sourceH)):(this._complete=$EV.create(this,this.setSource,[this._skin]),this._progress=null,$Er.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),$EH(0,$EM,"group",function(){return this._group},function($EM){$EM&&this._skin&&$EK.setGroup(this._skin,$EM),this._group=$EM}),$EH(0,$EM,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($EM){this._bitmap.sizeGrid=$Et.fillArray($Eh.defaultSizeGrid,$EM,Number)}),$EH(0,$EM,"measureWidth",function(){return this._bitmap.width}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($ER,this,"width",$EM),this._bitmap.width=0==$EM?1e-7:$EM}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($ER,this,"height",$EM),this._bitmap.height=0==$EM?1e-7:$EM}),$EL}($ER),$Eb=function($Ee){function $EL($EM){this._tf=null,$EL.__super.call(this),void 0===$EM&&($EM=""),$Eu.defaultColor=$Eh.labelColor,this.text=$EM}$Eq($EL,"laya.ui.Label",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._tf=null},$EM.createChildren=function(){this.addChild(this._tf=new $Ei)},$EM.changeText=function($EM){this._tf.changeText($EM)},$EH(0,$EM,"padding",function(){return this._tf.padding.join(",")},function($EM){this._tf.padding=$Et.fillArray($Eh.labelPadding,$EM,Number)}),$EH(0,$EM,"bold",function(){return this._tf.bold},function($EM){this._tf.bold=$EM}),$EH(0,$EM,"align",function(){return this._tf.align},function($EM){this._tf.align=$EM}),$EH(0,$EM,"text",function(){return this._tf.text},function($EM){this._tf.text!=$EM&&($EM&&($EM=$Et.adptString($EM+"")),this._tf.text=$EM,this.event("change"),this._width&&this._height||this.onCompResize())}),$EH(0,$EM,"italic",function(){return this._tf.italic},function($EM){this._tf.italic=$EM}),$EH(0,$EM,"wordWrap",function(){return this._tf.wordWrap},function($EM){this._tf.wordWrap=$EM}),$EH(0,$EM,"font",function(){return this._tf.font},function($EM){this._tf.font=$EM}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)||"string"==typeof $EM?this.text=$EM+"":$Er.superSet($ER,this,"dataSource",$EM)}),$EH(0,$EM,"color",function(){return this._tf.color},function($EM){this._tf.color=$EM}),$EH(0,$EM,"valign",function(){return this._tf.valign},function($EM){this._tf.valign=$EM}),$EH(0,$EM,"leading",function(){return this._tf.leading},function($EM){this._tf.leading=$EM}),$EH(0,$EM,"fontSize",function(){return this._tf.fontSize},function($EM){this._tf.fontSize=$EM}),$EH(0,$EM,"bgColor",function(){return this._tf.bgColor},function($EM){this._tf.bgColor=$EM}),$EH(0,$EM,"borderColor",function(){return this._tf.borderColor},function($EM){this._tf.borderColor=$EM}),$EH(0,$EM,"stroke",function(){return this._tf.stroke},function($EM){this._tf.stroke=$EM}),$EH(0,$EM,"strokeColor",function(){return this._tf.strokeColor},function($EM){this._tf.strokeColor=$EM}),$EH(0,$EM,"textField",function(){return this._tf}),$EH(0,$EM,"measureWidth",function(){return this._tf.width}),$EH(0,$EM,"measureHeight",function(){return this._tf.height}),$EH(0,$EM,"width",function(){return this._width||this._tf.text?$Er.superGet($ER,this,"width"):0},function($EM){$Er.superSet($ER,this,"width",$EM),this._tf.width=$EM}),$EH(0,$EM,"height",function(){return this._height||this._tf.text?$Er.superGet($ER,this,"height"):0},function($EM){$Er.superSet($ER,this,"height",$EM),this._tf.height=$EM}),$EH(0,$EM,"overflow",function(){return this._tf.overflow},function($EM){this._tf.overflow=$EM}),$EH(0,$EM,"underline",function(){return this._tf.underline},function($EM){this._tf.underline=$EM}),$EH(0,$EM,"underlineColor",function(){return this._tf.underlineColor},function($EM){this._tf.underlineColor=$EM}),$EL}($ER),$Em=function($Ee){function $EL($EM){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$EL.__super.call(this),this.skin=$EM}$Eq($EL,"laya.ui.ProgressBar",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._bg&&this._bg.destroy($EM),this._bar&&this._bar.destroy($EM),this._bg=this._bar=null,this.changeHandler=null},$EM.createChildren=function(){this.addChild(this._bg=new $Ew),this.addChild(this._bar=new $Ew)},$EM.changeValue=function(){if(this.sizeGrid){var $EM=this.sizeGrid.split(","),$Ee=Number($EM[3]),$EL=Number($EM[1]),$E_=(this.width-$Ee-$EL)*this._value;this._bar.width=$Ee+$EL+$E_,this._bar.visible=this._bar.width>$Ee+$EL}else this._bar.width=this.width*this._value},$EH(0,$EM,"measureHeight",function(){return this._bg.height}),$EH(0,$EM,"skin",function(){return this._skin},function($EM){this._skin!=$EM&&(this._skin=$EM,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$EH(0,$EM,"measureWidth",function(){return this._bg.width}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($ER,this,"height",$EM),this._bg.height=this._height,this._bar.height=this._height}),$EH(0,$EM,"bar",function(){return this._bar}),$EH(0,$EM,"value",function(){return this._value},function($EM){this._value!=$EM&&($EM=1<$EM?1:$EM<0?0:$EM,this._value=$EM,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($EM))}),$EH(0,$EM,"bg",function(){return this._bg}),$EH(0,$EM,"sizeGrid",function(){return this._bg.sizeGrid},function($EM){this._bg.sizeGrid=this._bar.sizeGrid=$EM}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($ER,this,"width",$EM),this._bg.width=this._width,this.callLater(this.changeValue)}),$EH(0,$EM,"dataSource",$Ee.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)||"string"==typeof $EM?this.value=Number($EM):$Er.superSet($ER,this,"dataSource",$EM)}),$EL}($ER),$Ez=(function($EM){function $EL(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$EL.__super.call(this),this._tipBox=new $ER,this._tipBox.addChild(this._tipText=new $Ei),this._tipText.x=this._tipText.y=5,this._tipText.color=$EL.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$Er.stage.on("showtip",this,this._onStageShowTip),$Er.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$Eq($EL,"laya.ui.TipManager",$ER);var $Ee=$EL.prototype;$Ee._onStageHideTip=function($EM){$Er.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$Ee._onStageShowTip=function($EM){$Er.timer.once($EL.tipDelay,this,this._showTip,[$EM],!0)},$Ee._showTip=function($EM){if("string"==typeof $EM){var $Ee=String($EM);Boolean($Ee)&&this._defaultTipHandler($Ee)}else $EM instanceof laya.utils.Handler?$EM.run():"function"==typeof $EM&&$EM.apply();$Er.stage.on("mousemove",this,this._onStageMouseMove),$Er.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$Ee._onStageMouseDown=function($EM){this.closeAll()},$Ee._onStageMouseMove=function($EM){this._showToStage(this,$EL.offsetX,$EL.offsetY)},$Ee._showToStage=function($EM,$Ee,$EL){void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0);var $E_=$EM.getBounds();$EM.x=$Er.stage.mouseX+$Ee,$EM.y=$Er.stage.mouseY+$EL,$EM.x+$E_.width>$Er.stage.width&&($EM.x-=$E_.width+$Ee),$EM.y+$E_.height>$Er.stage.height&&($EM.y-=$E_.height+$EL)},$Ee.closeAll=function(){$Er.timer.clear(this,this._showTip),$Er.stage.off("mousemove",this,this._onStageMouseMove),$Er.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$Ee.showDislayTip=function($EM){this.addChild($EM),this._showToStage(this),$Er._currentStage.addChild(this)},$Ee._showDefaultTip=function($EM){this._tipText.text=$EM;var $Ee=this._tipBox.graphics;$Ee.clear(),$Ee.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$EL.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$Er._currentStage.addChild(this)},$EH(0,$Ee,"defaultTipHandler",function(){return this._defaultTipHandler},function($EM){this._defaultTipHandler=$EM}),$EL.offsetX=10,$EL.offsetY=15,$EL.tipTextColor="#ffffff",$EL.tipBackColor="#111111",$EL.tipDelay=200}(),function($EM){var $EE;function $Ed(){this._idMap=null,this._aniList=null,this._watchMap={},$Ed.__super.call(this)}$Eq($Ed,"laya.ui.View",$En);var $Ee=$Ed.prototype;return $Ee.createView=function($EM){if($EM.animations&&!this._idMap&&(this._idMap={}),$Ed.createComp($EM,this,this),$EM.animations){var $Ee,$EL,$E_=[],$Ec=$EM.animations,$Eq=0,$EH=$Ec.length;for($Eq=0;$Eq<$EH;$Eq++){switch($Ee=new $EG,$EL=$Ec[$Eq],$Ee._setUp(this._idMap,$EL),(this[$EL.name]=$Ee)._setControlNode(this),$EL.action){case 1:$Ee.play(0,!1);break;case 2:$Ee.play(0,!0)}$E_.push($Ee)}this._aniList=$E_}0<this._width&&null==$EM.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$Ee.onEvent=function($EM,$Ee){},$Ee.loadUI=function($EM){var $Ee=$Ed.uiMap[$EM];$Ee&&this.createView($Ee)},$Ee.destroy=function($EM){void 0===$EM&&($EM=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$EM)},$Ee.changeData=function($EM){var $Ee=this._watchMap[$EM];if($Ee){console.log("change",$EM);for(var $EL=0,$E_=$Ee.length;$EL<$E_;$EL++){$Ee[$EL].exe(this)}}},$Ed._regs=function(){for(var $EM in $Ed.uiClassMap)$E$.regClass($EM,$Ed.uiClassMap[$EM])},$Ed.createComp=function($EM,$Ee,$EL,$E_){if(!($Ee=$Ee||$Ed.getCompInstance($EM)))return console.warn("can not create:"+$EM.type),null;var $Ec=$EM.child;if($Ec)for(var $Eq=$Ee instanceof laya.ui.List,$EH=0,$ET=$Ec.length;$EH<$ET;$EH++){var $Ex=$Ec[$EH];if(!$Ee.hasOwnProperty("itemRender")||"render"!=$Ex.props.name&&"render"!==$Ex.props.renderType)if("Graphic"==$Ex.type)$E$.addGraphicsToSprite($Ex,$Ee);else if($E$.isDrawType($Ex.type))$E$.addGraphicToSprite($Ex,$Ee,!0);else{if($Eq){var $EO=[],$Eu=$Ed.createComp($Ex,null,$EL,$EO);$EO.length&&($Eu._$bindData=$EO)}else $Eu=$Ed.createComp($Ex,null,$EL,$E_);"Script"==$Ex.type?"owner"in $Eu?$Eu.owner=$Ee:"target"in $Eu&&($Eu.target=$Ee):"mask"==$Ex.props.renderType||"mask"==$Ex.props.name?$Ee.mask=$Eu:$Eu instanceof laya.display.Sprite&&$Ee.addChild($Eu)}else $Ee.itemRender=$Ex}var $EG=$EM.props;for(var $EV in $EG){var $EE=$EG[$EV];$Ed.eventDic[$EV]?$EE&&$EL&&$Ee.on($EV,$EL,$EL.onEvent,[$EE]):$Ed.setCompValue($Ee,$EV,$EE,$EL,$E_)}return $Er.__typeof($Ee,"laya.ui.IItem")&&$Ee.initItems(),$EM.compId&&$EL&&$EL._idMap&&($EL._idMap[$EM.compId]=$Ee),$Ee},$Ed.setCompValue=function($EM,$Ee,$EL,$E_,$Ec){if("string"==typeof $EL&&-1<$EL.indexOf("${")){if($Ed._sheet||($Ed._sheet=$E$.getClass("laya.data.Table")),!$Ed._sheet)return void console.warn("Can not find class Sheet");if($Ec)$Ec.push($EM,$Ee,$EL);else if($E_){-1==$EL.indexOf("].")&&($EL=$EL.replace(".","[0]."));var $Eq,$EH,$ET=new $EE($EM,$Ee,$EL);$ET.exe($E_);for(var $Ex=$EL.replace(/\[.*?\]\./g,".");null!=($Eq=$Ed._parseWatchData.exec($Ex));){for(var $EO=$Eq[1];null!=($EH=$Ed._parseKeyWord.exec($EO));){var $Eu=$EH[0],$EG=$E_._watchMap[$Eu]||($E_._watchMap[$Eu]=[]);$EG.push($ET),$Ed._sheet.I.notifer.on($Eu,$E_,$E_.changeData,[$Eu])}($EG=$E_._watchMap[$EO]||($E_._watchMap[$EO]=[])).push($ET),$Ed._sheet.I.notifer.on($EO,$E_,$E_.changeData,[$EO])}}}else if("var"===$Ee&&$E_)$E_[$EL]=$EM;else if("onClick"==$Ee){var $EV=$Er._runScript("(function(){"+$EL+"})");$EM.on("click",$E_,$EV)}else $EM[$Ee]="true"===$EL||"false"!==$EL&&$EL},$Ed.getCompInstance=function($EM){var $Ee,$EL=$EM.props?$EM.props.runtime:null;return $Ee=$EL?$Ed.viewClassMap[$EL]||$Ed.uiClassMap[$EL]||$Er.__classmap[$EL]:$Ed.uiClassMap[$EM.type],$EM.props&&$EM.props.hasOwnProperty("renderType")&&"instance"==$EM.props.renderType?$Ee.instance:$Ee?new $Ee:null},$Ed.regComponent=function($EM,$Ee){$Ed.uiClassMap[$EM]=$Ee,$E$.regClass($EM,$Ee)},$Ed.regViewRuntime=function($EM,$Ee){$Ed.viewClassMap[$EM]=$Ee},$Ed.uiMap={},$Ed.viewClassMap={},$Ed._sheet=null,$E_($Ed,["uiClassMap",function(){return this.uiClassMap={ViewStack:$EMM,LinkButton:$El,TextArea:$EOM,ColorPicker:$Ej,Box:$En,Button:$El,CheckBox:$EQ,Clip:$Ef,ComboBox:$EF,Component:$ER,HScrollBar:$Ev,HSlider:$Es,Image:$Ew,Label:$Eb,List:$EZ,Panel:$EN,ProgressBar:$Em,Radio:$EU,RadioGroup:$ETM,ScrollBar:$Eg,Slider:$EJ,Tab:$ExM,TextInput:$ELM,View:$Ed,VScrollBar:$EeM,VSlider:$E_M,Tree:$EI,HBox:$EqM,VBox:$EHM,Sprite:$Eo,Animation:$EL,Text:$Ei,FontClip:$EP}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$Ed.__init$=function(){$Ed._regs(),$EE=function(){function $EM($EM,$Ee,$EL){this.comp=null,this.prop=null,this.value=null,this.comp=$EM,this.prop=$Ee,this.value=$EL}return $Eq($EM,""),$EM.prototype.exe=function($EM){var $Ee=$Et.getBindFun(this.value);this.comp[this.prop]=$Ee.call(this,$EM)},$EM}()},$Ed}()),$EQ=function($EM){function $EL($EM,$Ee){void 0===$Ee&&($Ee=""),$EL.__super.call(this,$EM,$Ee)}$Eq($EL,"laya.ui.CheckBox",$EM);var $Ee=$EL.prototype;return $Ee.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$Ee.initialize=function(){$EM.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$EH(0,$Ee,"dataSource",$EM.prototype._$get_dataSource,function($EM){"boolean"==typeof(this._dataSource=$EM)?this.selected=$EM:"string"==typeof $EM?this.selected="true"===$EM:$Er.superSet($El,this,"dataSource",$EM)}),$EL}($El),$EY=function($EM){function $Ee(){this._space=0,this._align="none",this._itemChanged=!1,$Ee.__super.call(this)}$Eq($Ee,"laya.ui.LayoutBox",$En);var $EL=$Ee.prototype;return $EL.addChild=function($EM){return $EM.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$EM)},$EL.onResize=function($EM){this._setItemChanged()},$EL.addChildAt=function($EM,$Ee){return $EM.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$EM,$Ee)},$EL.removeChild=function($EM){return $EM.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$EM)},$EL.removeChildAt=function($EM){return this.getChildAt($EM).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$EM)},$EL.refresh=function(){this._setItemChanged()},$EL.changeItems=function(){this._itemChanged=!1},$EL.sortItem=function($EM){$EM&&$EM.sort(function($EM,$Ee){return $EM.y-$Ee.y})},$EL._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$EH(0,$EL,"space",function(){return this._space},function($EM){this._space=$EM,this._setItemChanged()}),$EH(0,$EL,"align",function(){return this._align},function($EM){this._align=$EM,this._setItemChanged()}),$Ee}(),$EP=function($Ee){function $EL($EM,$Ee){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$EL.__super.call(this),$EM&&(this.skin=$EM),$Ee&&(this.sheet=$Ee)}$Eq($EL,"laya.ui.FontClip",$Ee);var $EM=$EL.prototype;return $EM.createChildren=function(){this._bitmap=new $Ep,this.on("loaded",this,this._onClipLoaded)},$EM._onClipLoaded=function(){this.callLater(this.changeValue)},$EM.changeValue=function(){var $EM;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$EM=this._sources[0]))){var $Ee="horizontal"===this._direction;$Ee?(this._wordsW=this._valueArr.length*($EM.sourceWidth+this.spaceX),this._wordsH=$EM.sourceHeight):(this._wordsW=$EM.sourceWidth,this._wordsH=($EM.sourceHeight+this.spaceY)*this._valueArr.length);var $EL=0;if(this._width)switch(this._align){case"center":$EL=.5*(this._width-this._wordsW);break;case"right":$EL=this._width-this._wordsW;break;default:$EL=0}for(var $E_=0,$Ec=this._valueArr.length;$E_<$Ec;$E_++){var $Eq=this._indexMap[this._valueArr.charAt($E_)];this.sources[$Eq]&&($EM=this.sources[$Eq],$Ee?this.graphics.drawTexture($EM,$EL+$E_*($EM.sourceWidth+this.spaceX),0,$EM.sourceWidth,$EM.sourceHeight):this.graphics.drawTexture($EM,0+$EL,$E_*($EM.sourceHeight+this.spaceY),$EM.sourceWidth,$EM.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$EM.destroy=function($EM){void 0===$EM&&($EM=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$Ee.prototype.destroy.call(this,$EM)},$EH(0,$EM,"sheet",function(){return this._sheet},function($EM){$EM+="";var $Ee=(this._sheet=$EM).split(" ");this._clipX=String($Ee[0]).length,this.clipY=$Ee.length,this._indexMap={};for(var $EL=0;$EL<this._clipY;$EL++)for(var $E_=$Ee[$EL].split(""),$Ec=0,$Eq=$E_.length;$Ec<$Eq;$Ec++)this._indexMap[$E_[$Ec]]=$EL*this._clipX+$Ec}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($Ef,this,"height",$EM),this.callLater(this.changeValue)}),$EH(0,$EM,"direction",function(){return this._direction},function($EM){this._direction=$EM,this.callLater(this.changeValue)}),$EH(0,$EM,"value",function(){return this._valueArr?this._valueArr:""},function($EM){$EM+="",this._valueArr=$EM,this.callLater(this.changeValue)}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($Ef,this,"width",$EM),this.callLater(this.changeValue)}),$EH(0,$EM,"spaceX",function(){return this._spaceX},function($EM){this._spaceX=$EM,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$EH(0,$EM,"spaceY",function(){return this._spaceY},function($EM){this._spaceY=$EM,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$EH(0,$EM,"align",function(){return this._align},function($EM){this._align=$EM,this.callLater(this.changeValue)}),$EH(0,$EM,"measureWidth",function(){return this._wordsW}),$EH(0,$EM,"measureHeight",function(){return this._wordsH}),$EL}($Ef),$EZ=function($EM){function $Ee(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $Ed,$Ee.__super.call(this)}$Eq($Ee,"laya.ui.List",$EM);var $EL=$Ee.prototype;return $Er.imps($EL,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$EL.destroy=function($EM){void 0===$EM&&($EM=!0),this._content&&this._content.destroy($EM),this._scrollBar&&this._scrollBar.destroy($EM),laya.ui.Component.prototype.destroy.call(this,$EM),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},$EL.createChildren=function(){this.addChild(this._content=new $En)},$EL.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$Er.superGet($En,this,"cacheAs")),$Er.superSet($En,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$EL.onScrollEnd=function(){$Er.superSet($En,this,"cacheAs",this._$P.cacheAs)},$EL._removePreScrollBar=function(){var $EM=this.removeChildByName("scrollBar");$EM&&$EM.destroy(!0)},$EL.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $EM=this._getOneCell(),$Ee=$EM.width+this._spaceX||1,$EL=$EM.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$Ee):Math.ceil(this._width/$Ee)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$EL):Math.round(this._height/$EL));var $E_=this._width?this._width:$Ee*this.repeatX-this._spaceX,$Ec=this._height?this._height:$EL*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$EL:$Ee,this._cellOffset=this._isVertical?$EL*Math.max(this._repeatY2,this._repeatY)-$Ec-this._spaceY:$Ee*Math.max(this._repeatX2,this._repeatX)-$E_-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$Ec:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$E_),this.setContentSize($E_,$Ec);var $Eq=this._isVertical?this.repeatX:this.repeatY,$EH=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$Eq,$EH),this._createdLine=$EH,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$EL._getOneCell=function(){if(0===this._cells.length){var $EM=this.createItem();if(this._offset.setTo($EM.x,$EM.y),this.cacheContent)return $EM;this._cells.push($EM)}return this._cells[0]},$EL._createItems=function($EM,$Ee,$EL){var $E_=this._content,$Ec=this._getOneCell(),$Eq=$Ec.width+this._spaceX,$EH=$Ec.height+this._spaceY;if(this.cacheContent){var $ET=new $En;$ET.cacheAsBitmap=!0,$ET.pos((this._isVertical?0:$EM)*$Eq,(this._isVertical?$EM:0)*$EH),this._content.addChild($ET),this._content.optimizeScrollRect=!0,$E_=$ET}else{for(var $Ex=[],$EO=this._cells.length-1;-1<$EO;$EO--){var $Eu=this._cells[$EO];$Eu.removeSelf(),$Ex.push($Eu)}this._cells.length=0}for(var $EG=$EM;$EG<$EL;$EG++)for(var $EV=0;$EV<$Ee;$EV++)($Ec=$Ex&&$Ex.length?$Ex.pop():this.createItem()).x=(this._isVertical?$EV:$EG)*$Eq-$E_.x,$Ec.y=(this._isVertical?$EG:$EV)*$EH-$E_.y,$Ec.name="item"+($EG*$Ee+$EV),$E_.addChild($Ec),this.addCell($Ec)},$EL.createItem=function(){var $EM=[];if("function"==typeof this._itemRender)var $Ee=new this._itemRender;else $Ee=$Ez.createComp(this._itemRender,null,null,$EM);if(0==$EM.length&&$Ee._watchMap){var $EL=$Ee._watchMap;for(var $E_ in $EL)for(var $Ec=$EL[$E_],$Eq=0;$Eq<$Ec.length;$Eq++){var $EH=$Ec[$Eq];$EM.push($EH.comp,$EH.prop,$EH.value)}}return $EM.length&&($Ee._$bindData=$EM),$Ee},$EL.addCell=function($EM){$EM.on("click",this,this.onCellMouse),$EM.on("rightclick",this,this.onCellMouse),$EM.on("mouseover",this,this.onCellMouse),$EM.on("mouseout",this,this.onCellMouse),$EM.on("mousedown",this,this.onCellMouse),$EM.on("mouseup",this,this.onCellMouse),this._cells.push($EM)},$EL.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $EM=0,$Ee=$EM=0;$Ee<1e4;$Ee++){var $EL=this.getChildByName("item"+$Ee);if(!$EL)break;this.addCell($EL),$EM++}this.repeatY=$EM}},$EL.setContentSize=function($EM,$Ee){this._content.width=$EM,this._content.height=$Ee,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $EC),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$EM,$Ee),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$EL.onCellMouse=function($EM){"mousedown"===$EM.type&&(this._isMoved=!1);var $Ee=$EM.currentTarget,$EL=this._startIndex+this._cells.indexOf($Ee);$EL<0||("click"===$EM.type||"rightclick"===$EM.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$EL:this.changeCellState($Ee,!0,0):"mouseover"!==$EM.type&&"mouseout"!==$EM.type||this._selectedIndex===$EL||this.changeCellState($Ee,"mouseover"===$EM.type,0),this.mouseHandler&&this.mouseHandler.runWith([$EM,$EL]))},$EL.changeCellState=function($EM,$Ee,$EL){var $E_=$EM.getChildByName("selectBox");$E_&&(this.selectEnable=!0,$E_.visible=$Ee,$E_.index=$EL)},$EL.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$EL.onScrollBarChange=function($EM){this.runCallLater(this.changeCells);var $Ee=this._scrollBar.value,$EL=this._isVertical?this.repeatX:this.repeatY,$E_=this._isVertical?this.repeatY:this.repeatX,$Ec=Math.floor($Ee/this._cellSize);if(this.cacheContent)$EH=$E_+1,this._createdLine-$Ec<$EH&&(this._createItems(this._createdLine,$EL,this._createdLine+$EH),this.renderItems(this._createdLine*$EL,0),this._createdLine+=$EH);else{var $Eq=$Ec*$EL,$EH=0;if($Eq>this._startIndex){$EH=$Eq-this._startIndex;var $ET=!0,$Ex=this._startIndex+$EL*($E_+1);this._isMoved=!0}else $Eq<this._startIndex&&($EH=this._startIndex-$Eq,$ET=!1,$Ex=this._startIndex-1,this._isMoved=!0);for(var $EO=0;$EO<$EH;$EO++){if($ET){var $Eu=this._cells.shift();this._cells[this._cells.length]=$Eu;var $EG=$Ex+$EO}else $Eu=this._cells.pop(),this._cells.unshift($Eu),$EG=$Ex-$EO;var $EV=Math.floor($EG/$EL)*this._cellSize;this._isVertical?$Eu.y=$EV:$Eu.x=$EV,this.renderItem($Eu,$EG)}this._startIndex=$Eq,this.changeSelectStatus()}var $EE=this._content.scrollRect;this._isVertical?($EE.y=$Ee-this._offset.y,$EE.x=-this._offset.x):($EE.y=-this._offset.y,$EE.x=$Ee-this._offset.x),this._content.scrollRect=$EE},$EL.posCell=function($EM,$Ee){if(this._scrollBar){var $EL=this._isVertical?this.repeatX:this.repeatY,$E_=(this._isVertical?this.repeatY:this.repeatX,Math.floor($Ee/$EL)*this._cellSize);this._isVertical?$EM.y=$E_:$EM.x=$E_}},$EL.changeSelectStatus=function(){for(var $EM=0,$Ee=this._cells.length;$EM<$Ee;$EM++)this.changeCellState(this._cells[$EM],this._selectedIndex===this._startIndex+$EM,1)},$EL.renderItems=function($EM,$Ee){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0);for(var $EL=$EM,$E_=$Ee||this._cells.length;$EL<$E_;$EL++)this.renderItem(this._cells[$EL],this._startIndex+$EL);this.changeSelectStatus()},$EL.renderItem=function($EM,$Ee){this._array&&0<=$Ee&&$Ee<this._array.length?($EM.visible=!0,$EM._$bindData?($EM._dataSource=this._array[$Ee],this._bindData($EM,this._array[$Ee])):$EM.dataSource=this._array[$Ee],this.cacheContent||this.posCell($EM,$Ee),this.hasListener("render")&&this.event("render",[$EM,$Ee]),this.renderHandler&&this.renderHandler.runWith([$EM,$Ee])):($EM.visible=!1,$EM.dataSource=null)},$EL._bindData=function($EM,$Ee){for(var $EL=$EM._$bindData,$E_=0,$Ec=$EL.length;$E_<$Ec;$E_++){var $Eq=$EL[$E_++],$EH=$EL[$E_++],$ET=$EL[$E_],$Ex=$Et.getBindFun($ET);$Eq[$EH]=$Ex.call(this,$Ee)}},$EL.refresh=function(){this.array=this._array},$EL.getItem=function($EM){return-1<$EM&&$EM<this._array.length?this._array[$EM]:null},$EL.changeItem=function($EM,$Ee){-1<$EM&&$EM<this._array.length&&(this._array[$EM]=$Ee,$EM>=this._startIndex&&$EM<this._startIndex+this._cells.length&&this.renderItem(this.getCell($EM),$EM))},$EL.setItem=function($EM,$Ee){this.changeItem($EM,$Ee)},$EL.addItem=function($EM){this._array.push($EM),this.array=this._array},$EL.addItemAt=function($EM,$Ee){this._array.splice($Ee,0,$EM),this.array=this._array},$EL.deleteItem=function($EM){this._array.splice($EM,1),this.array=this._array},$EL.getCell=function($EM){return this.runCallLater(this.changeCells),-1<$EM&&this._cells?this._cells[($EM-this._startIndex)%this._cells.length]:null},$EL.scrollTo=function($EM){if(this._scrollBar){var $Ee=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($EM/$Ee)*this._cellSize}else this.startIndex=$EM},$EL.tweenTo=function($EM,$Ee,$EL){if(void 0===$Ee&&($Ee=200),this._scrollBar){var $E_=this._isVertical?this.repeatX:this.repeatY;$Ey.to(this._scrollBar,{value:Math.floor($EM/$E_)*this._cellSize},$Ee,null,$EL,0,!0)}else this.startIndex=$EM,$EL&&$EL.run()},$EL._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$EL.commitMeasure=function(){this.runCallLater(this.changeCells)},$EH(0,$EL,"cacheAs",$EM.prototype._$get_cacheAs,function($EM){$Er.superSet($En,this,"cacheAs",$EM),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$EM?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$EH(0,$EL,"content",function(){return this._content}),$EH(0,$EL,"height",$EM.prototype._$get_height,function($EM){$EM!=this._height&&($Er.superSet($En,this,"height",$EM),this._setCellChanged())}),$EH(0,$EL,"itemRender",function(){return this._itemRender},function($EM){if(this._itemRender!=$EM){this._itemRender=$EM;for(var $Ee=this._cells.length-1;-1<$Ee;$Ee--)this._cells[$Ee].destroy();this._cells.length=0,this._setCellChanged()}}),$EH(0,$EL,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($EM){this._removePreScrollBar();var $Ee=new $EeM;$Ee.name="scrollBar",$Ee.right=0,$EM&&" "!=$EM&&($Ee.skin=$EM),this.scrollBar=$Ee,this.addChild($Ee),this._setCellChanged()}),$EH(0,$EL,"page",function(){return this._page},function($EM){this._page=$EM,this._array&&(this._page=0<$EM?$EM:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$EH(0,$EL,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($EM){this._removePreScrollBar();var $Ee=new $Ev;$Ee.name="scrollBar",$Ee.bottom=0,$EM&&" "!=$EM&&($Ee.skin=$EM),this.scrollBar=$Ee,this.addChild($Ee),this._setCellChanged()}),$EH(0,$EL,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($EM){this._repeatX=$EM,this._setCellChanged()}),$EH(0,$EL,"scrollBar",function(){return this._scrollBar},function($EM){this._scrollBar!=$EM&&(this._scrollBar=$EM)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$EH(0,$EL,"width",$EM.prototype._$get_width,function($EM){$EM!=this._width&&($Er.superSet($En,this,"width",$EM),this._setCellChanged())}),$EH(0,$EL,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($EM){this._repeatY=$EM,this._setCellChanged()}),$EH(0,$EL,"spaceX",function(){return this._spaceX},function($EM){this._spaceX=$EM,this._setCellChanged()}),$EH(0,$EL,"spaceY",function(){return this._spaceY},function($EM){this._spaceY=$EM,this._setCellChanged()}),$EH(0,$EL,"selectedIndex",function(){return this._selectedIndex},function($EM){this._selectedIndex!=$EM&&(this._selectedIndex=$EM,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($EM),this.startIndex=this._startIndex)}),$EH(0,$EL,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($EM){this.selectedIndex=this._array.indexOf($EM)}),$EH(0,$EL,"length",function(){return this._array?this._array.length:0}),$EH(0,$EL,"selection",function(){return this.getCell(this._selectedIndex)},function($EM){this.selectedIndex=this._startIndex+this._cells.indexOf($EM)}),$EH(0,$EL,"startIndex",function(){return this._startIndex},function($EM){this._startIndex=0<$EM?$EM:0,this.callLater(this.renderItems)}),$EH(0,$EL,"array",function(){return this._array},function($EM){this.runCallLater(this.changeCells),this._array=$EM||[];var $Ee=this._array.length;if(this.totalPage=Math.ceil($Ee/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$Ee?this._selectedIndex:$Ee-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $EL=this._isVertical?this.repeatX:this.repeatY,$E_=this._isVertical?this.repeatY:this.repeatX,$Ec=Math.ceil($Ee/$EL);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$E_/$Ec,this._scrollBar.setScroll(0,($Ec-$E_)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$EH(0,$EL,"dataSource",$EM.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)&&Math.floor($EM)==$EM||"string"==typeof $EM?this.selectedIndex=parseInt($EM):$EM instanceof Array?this.array=$EM:$Er.superSet($En,this,"dataSource",$EM)}),$EH(0,$EL,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$Ee}($En),$Ev=function($EM){function $Ee(){$Ee.__super.call(this)}return $Eq($Ee,"laya.ui.HScrollBar",$EM),$Ee.prototype.initialize=function(){$EM.prototype.initialize.call(this),this.slider.isVertical=!1},$Ee}($Eg),$EN=function($EM){function $Ee(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$Ee.__super.call(this),this.width=this.height=100}$Eq($Ee,"laya.ui.Panel",$EM);var $EL=$Ee.prototype;return $EL.destroy=function($EM){void 0===$EM&&($EM=!0),laya.ui.Component.prototype.destroy.call(this,$EM),this._content&&this._content.destroy($EM),this._vScrollBar&&this._vScrollBar.destroy($EM),this._hScrollBar&&this._hScrollBar.destroy($EM),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$EL.destroyChildren=function(){this._content.destroyChildren()},$EL.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $En)},$EL.addChild=function($EM){return $EM.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($EM)},$EL.onResize=function(){this._setScrollChanged()},$EL.addChildAt=function($EM,$Ee){return $EM.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($EM,$Ee)},$EL.removeChild=function($EM){return $EM.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($EM)},$EL.removeChildAt=function($EM){return this.getChildAt($EM).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($EM)},$EL.removeChildren=function($EM,$Ee){return void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=2147483647),this._content.removeChildren($EM,$Ee),this._setScrollChanged(),this},$EL.getChildAt=function($EM){return this._content.getChildAt($EM)},$EL.getChildByName=function($EM){return this._content.getChildByName($EM)},$EL.getChildIndex=function($EM){return this._content.getChildIndex($EM)},$EL.changeScroll=function(){this._scrollChanged=!1;var $EM=this.contentWidth||1,$Ee=this.contentHeight||1,$EL=this._vScrollBar,$E_=this._hScrollBar,$Ec=$EL&&$Ee>this._height,$Eq=$E_&&$EM>this._width,$EH=$Ec?this._width-$EL.width:this._width,$ET=$Eq?this._height-$E_.height:this._height;$EL&&($EL.x=this._width-$EL.width,$EL.y=0,$EL.height=this._height-($Eq?$E_.height:0),$EL.scrollSize=Math.max(.033*this._height,1),$EL.thumbPercent=$ET/$Ee,$EL.setScroll(0,$Ee-$ET,$EL.value)),$E_&&($E_.x=0,$E_.y=this._height-$E_.height,$E_.width=this._width-($Ec?$EL.width:0),$E_.scrollSize=Math.max(.033*this._width,1),$E_.thumbPercent=$EH/$EM,$E_.setScroll(0,$EM-$EH,$E_.value))},$EL.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$EL.setContentSize=function($EM,$Ee){var $EL=this._content;$EL.width=$EM,$EL.height=$Ee,$EL.scrollRect||($EL.scrollRect=new $EC),$EL.scrollRect.setTo(0,0,$EM,$Ee),$EL.scrollRect=$EL.scrollRect},$EL.onScrollBarChange=function($EM){var $Ee=this._content.scrollRect;if($Ee){var $EL=Math.round($EM.value);$EM.isVertical?$Ee.y=$EL:$Ee.x=$EL,this._content.scrollRect=$Ee}},$EL.scrollTo=function($EM,$Ee){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),this.vScrollBar&&(this.vScrollBar.value=$Ee),this.hScrollBar&&(this.hScrollBar.value=$EM)},$EL.refresh=function(){this.changeScroll()},$EL.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$Er.superGet($En,this,"cacheAs")),$Er.superSet($En,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$EL.onScrollEnd=function(){$Er.superSet($En,this,"cacheAs",this._$P.cacheAs)},$EL._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$EH(0,$EL,"numChildren",function(){return this._content.numChildren}),$EH(0,$EL,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($EM){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $Ev),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$EM}),$EH(0,$EL,"contentWidth",function(){for(var $EM=0,$Ee=this._content.numChildren-1;-1<$Ee;$Ee--){var $EL=this._content.getChildAt($Ee);$EM=Math.max($EL.x+$EL.width*$EL.scaleX,$EM)}return $EM}),$EH(0,$EL,"contentHeight",function(){for(var $EM=0,$Ee=this._content.numChildren-1;-1<$Ee;$Ee--){var $EL=this._content.getChildAt($Ee);$EM=Math.max($EL.y+$EL.height*$EL.scaleY,$EM)}return $EM}),$EH(0,$EL,"width",$EM.prototype._$get_width,function($EM){$Er.superSet($En,this,"width",$EM),this._setScrollChanged()}),$EH(0,$EL,"hScrollBar",function(){return this._hScrollBar}),$EH(0,$EL,"content",function(){return this._content}),$EH(0,$EL,"height",$EM.prototype._$get_height,function($EM){$Er.superSet($En,this,"height",$EM),this._setScrollChanged()}),$EH(0,$EL,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($EM){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $EeM),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$EM}),$EH(0,$EL,"vScrollBar",function(){return this._vScrollBar}),$EH(0,$EL,"cacheAs",$EM.prototype._$get_cacheAs,function($EM){$Er.superSet($En,this,"cacheAs",$EM),this._$P.cacheAs=null,"none"!==$EM?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$Ee}($En),$Es=function($EM){function $Ee($EM){$Ee.__super.call(this,$EM),this.isVertical=!1}return $Eq($Ee,"laya.ui.HSlider",$EJ),$Ee}(),$ED=function($EM){function $EL($EM,$Ee){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$EL.__super.call(this),this.skin=$Ee,this.labels=$EM}$Eq($EL,"laya.ui.UIGroup",$EM);var $Ee=$EL.prototype;return $Er.imps($Ee,{"laya.ui.IItem":!0}),$Ee.preinitialize=function(){this.mouseEnabled=!0},$Ee.destroy=function($EM){void 0===$EM&&($EM=!0),laya.ui.Component.prototype.destroy.call(this,$EM),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$Ee.addItem=function($EM,$Ee){void 0===$Ee&&($Ee=!0);var $EL=$EM,$E_=this._items.length;if($EL.name="item"+$E_,this.addChild($EL),this.initItems(),$Ee&&0<$E_){var $Ec=this._items[$E_-1];"horizontal"==this._direction?$EL.x=$Ec.x+$Ec.width+this._space:$EL.y=$Ec.y+$Ec.height+this._space}else $Ee&&($EL.x=0,$EL.y=0);return $E_},$Ee.delItem=function($EM,$Ee){void 0===$Ee&&($Ee=!0);var $EL=this._items.indexOf($EM);if(-1!=$EL){var $E_=$EM;this.removeChild($E_);for(var $Ec=$EL+1,$Eq=this._items.length;$Ec<$Eq;$Ec++){var $EH=this._items[$Ec];$EH.name="item"+($Ec-1),$Ee&&("horizontal"==this._direction?$EH.x-=$E_.width+this._space:$EH.y-=$E_.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $ET;$ET=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$ET}}},$Ee.initItems=function(){this._items||(this._items=[]);for(var $EM=this._items.length=0;$EM<1e4;$EM++){var $Ee=this.getChildByName("item"+$EM);if(null==$Ee)break;this._items.push($Ee),$Ee.selected=$EM===this._selectedIndex,$Ee.clickHandler=$EV.create(this,this.itemClick,[$EM],!1)}},$Ee.itemClick=function($EM){this.selectedIndex=$EM},$Ee.setSelect=function($EM,$Ee){this._items&&-1<$EM&&$EM<this._items.length&&(this._items[$EM].selected=$Ee)},$Ee.createItem=function($EM,$Ee){return null},$Ee.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $EM=0,$Ee=0,$EL=this._items.length;$Ee<$EL;$Ee++){var $E_=this._items[$Ee];this._skin&&($E_.skin=this._skin),this._labelColors&&($E_.labelColors=this._labelColors),this._labelSize&&($E_.labelSize=this._labelSize),this._labelStroke&&($E_.labelStroke=this._labelStroke),this._labelStrokeColor&&($E_.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($E_.strokeColors=this._strokeColors),this._labelBold&&($E_.labelBold=this._labelBold),this._labelPadding&&($E_.labelPadding=this._labelPadding),this._labelAlign&&($E_.labelAlign=this._labelAlign),this._stateNum&&($E_.stateNum=this._stateNum),this._labelFont&&($E_.labelFont=this._labelFont),"horizontal"===this._direction?($E_.y=0,$E_.x=$EM,$EM+=$E_.width+this._space):($E_.x=0,$E_.y=$EM,$EM+=$E_.height+this._space)}this.changeSize()},$Ee.commitMeasure=function(){this.runCallLater(this.changeLabels)},$Ee._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$EH(0,$Ee,"labelStrokeColor",function(){return this._labelStrokeColor},function($EM){this._labelStrokeColor!=$EM&&(this._labelStrokeColor=$EM,this._setLabelChanged())}),$EH(0,$Ee,"skin",function(){return this._skin},function($EM){this._skin!=$EM&&(this._skin=$EM,this._setLabelChanged())}),$EH(0,$Ee,"selectedIndex",function(){return this._selectedIndex},function($EM){this._selectedIndex!=$EM&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$EM,this.setSelect($EM,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$EH(0,$Ee,"labels",function(){return this._labels},function($EM){if(this._labels!=$EM){if(this._labels=$EM,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $Ee=this._labels.split(","),$EL=0,$E_=$Ee.length;$EL<$E_;$EL++){var $Ec=this.createItem(this._skin,$Ee[$EL]);$Ec.name="item"+$EL,this.addChild($Ec)}this.initItems()}}),$EH(0,$Ee,"strokeColors",function(){return this._strokeColors},function($EM){this._strokeColors!=$EM&&(this._strokeColors=$EM,this._setLabelChanged())}),$EH(0,$Ee,"labelColors",function(){return this._labelColors},function($EM){this._labelColors!=$EM&&(this._labelColors=$EM,this._setLabelChanged())}),$EH(0,$Ee,"labelStroke",function(){return this._labelStroke},function($EM){this._labelStroke!=$EM&&(this._labelStroke=$EM,this._setLabelChanged())}),$EH(0,$Ee,"labelSize",function(){return this._labelSize},function($EM){this._labelSize!=$EM&&(this._labelSize=$EM,this._setLabelChanged())}),$EH(0,$Ee,"stateNum",function(){return this._stateNum},function($EM){this._stateNum!=$EM&&(this._stateNum=$EM,this._setLabelChanged())}),$EH(0,$Ee,"labelBold",function(){return this._labelBold},function($EM){this._labelBold!=$EM&&(this._labelBold=$EM,this._setLabelChanged())}),$EH(0,$Ee,"labelFont",function(){return this._labelFont},function($EM){this._labelFont!=$EM&&(this._labelFont=$EM,this._setLabelChanged())}),$EH(0,$Ee,"labelPadding",function(){return this._labelPadding},function($EM){this._labelPadding!=$EM&&(this._labelPadding=$EM,this._setLabelChanged())}),$EH(0,$Ee,"direction",function(){return this._direction},function($EM){this._direction=$EM,this._setLabelChanged()}),$EH(0,$Ee,"space",function(){return this._space},function($EM){this._space=$EM,this._setLabelChanged()}),$EH(0,$Ee,"items",function(){return this._items}),$EH(0,$Ee,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($EM){this.selectedIndex=this._items.indexOf($EM)}),$EH(0,$Ee,"dataSource",$EM.prototype._$get_dataSource,function($EM){"number"==typeof(this._dataSource=$EM)&&Math.floor($EM)==$EM||"string"==typeof $EM?this.selectedIndex=parseInt($EM):$EM instanceof Array?this.labels=$EM.join(","):$Er.superSet($En,this,"dataSource",$EM)}),$EL}($En),$EU=function($Ee){function $EL($EM,$Ee){this._value=null,void 0===$Ee&&($Ee=""),$EL.__super.call(this,$EM,$Ee)}$Eq($EL,"laya.ui.Radio",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._value=null},$EM.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$EM.initialize=function(){$Ee.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$EM.onClick=function($EM){this.selected=!0},$EH(0,$EM,"value",function(){return null!=this._value?this._value:this.label},function($EM){this._value=$EM}),$EL}($El),$EI=function($EM){function $Ee(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$Ee.__super.call(this),this.width=this.height=200}$Eq($Ee,"laya.ui.Tree",$EM);var $EL=$Ee.prototype;return $Er.imps($EL,{"laya.ui.IRender":!0}),$EL.destroy=function($EM){void 0===$EM&&($EM=!0),laya.ui.Component.prototype.destroy.call(this,$EM),this._list&&this._list.destroy($EM),this._list=null,this._source=null,this._renderHandler=null},$EL.createChildren=function(){this.addChild(this._list=new $EZ),this._list.renderHandler=$EV.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$EL.onListChange=function($EM){this.event("change")},$EL.getArray=function(){var $EM,$Ee=[];for(var $EL in this._source)$EM=this._source[$EL],this.getParentOpenStatus($EM)&&($EM.x=this._spaceLeft*this.getDepth($EM),$Ee.push($EM));return $Ee},$EL.getDepth=function($EM,$Ee){return void 0===$Ee&&($Ee=0),null==$EM.nodeParent?$Ee:this.getDepth($EM.nodeParent,$Ee+1)},$EL.getParentOpenStatus=function($EM){var $Ee=$EM.nodeParent;return null==$Ee||!!$Ee.isOpen&&(null==$Ee.nodeParent||this.getParentOpenStatus($Ee))},$EL.renderItem=function($EM,$Ee){var $EL=$EM.dataSource;if($EL){$EM.left=$EL.x;var $E_=$EM.getChildByName("arrow");$E_&&($EL.hasChild?($E_.visible=!0,$E_.index=$EL.isOpen?1:0,$E_.tag=$Ee,$E_.off("click",this,this.onArrowClick),$E_.on("click",this,this.onArrowClick)):$E_.visible=!1);var $Ec=$EM.getChildByName("folder");$Ec&&(2==$Ec.clipY?$Ec.index=$EL.isDirectory?0:1:$Ec.index=$EL.isDirectory?$EL.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$EM,$Ee])}},$EL.onArrowClick=function($EM){var $Ee=$EM.currentTarget.tag;this._list.array[$Ee].isOpen=!this._list.array[$Ee].isOpen,this.event("open"),this._list.array=this.getArray()},$EL.setItemState=function($EM,$Ee){this._list.array[$EM]&&(this._list.array[$EM].isOpen=$Ee,this._list.array=this.getArray())},$EL.fresh=function(){this._list.array=this.getArray(),this.repaint()},$EL.parseXml=function($EM,$Ee,$EL,$E_){var $Ec,$Eq=$EM.childNodes,$EH=$Eq.length;if(!$E_){$Ec={};var $ET,$Ex=$EM.attributes;for(var $EO in $Ex){var $Eu=($ET=$Ex[$EO]).nodeName,$EG=$ET.nodeValue;$Ec[$Eu]="true"==$EG||"false"!=$EG&&$EG}$Ec.nodeParent=$EL,0<$EH&&($Ec.isDirectory=!0),$Ec.hasChild=0<$EH,$Ee.push($Ec)}for(var $EV=0;$EV<$EH;$EV++){var $EE=$Eq[$EV];this.parseXml($EE,$Ee,$Ec,!1)}},$EL.parseOpenStatus=function($EM,$Ee){for(var $EL=0,$E_=$Ee.length;$EL<$E_;$EL++){var $Ec=$Ee[$EL];if($Ec.isDirectory)for(var $Eq=0,$EH=$EM.length;$Eq<$EH;$Eq++){var $ET=$EM[$Eq];if($ET.isDirectory&&this.isSameParent($ET,$Ec)&&$Ec.label==$ET.label){$Ec.isOpen=$ET.isOpen;break}}}},$EL.isSameParent=function($EM,$Ee){return null==$EM.nodeParent&&null==$Ee.nodeParent||null!=$EM.nodeParent&&null!=$Ee.nodeParent&&($EM.nodeParent.label==$Ee.nodeParent.label&&this.isSameParent($EM.nodeParent,$Ee.nodeParent))},$EL.filter=function($EM){if(Boolean($EM)){var $Ee=[];this.getFilterSource(this._source,$Ee,$EM),this._list.array=$Ee}else this._list.array=this.getArray()},$EL.getFilterSource=function($EM,$Ee,$EL){var $E_;for(var $Ec in $EL=$EL.toLocaleLowerCase(),$EM)!($E_=$EM[$Ec]).isDirectory&&-1<String($E_.label).toLowerCase().indexOf($EL)&&($E_.x=0,$Ee.push($E_)),$E_.child&&0<$E_.child.length&&this.getFilterSource($E_.child,$Ee,$EL)},$EH(0,$EL,"spaceBottom",function(){return this._list.spaceY},function($EM){this._list.spaceY=$EM}),$EH(0,$EL,"keepStatus",function(){return this._keepStatus},function($EM){this._keepStatus=$EM}),$EH(0,$EL,"itemRender",function(){return this._list.itemRender},function($EM){this._list.itemRender=$EM}),$EH(0,$EL,"array",function(){return this._list.array},function($EM){this._keepStatus&&this._list.array&&$EM&&this.parseOpenStatus(this._list.array,$EM),this._source=$EM,this._list.array=this.getArray()}),$EH(0,$EL,"mouseHandler",function(){return this._list.mouseHandler},function($EM){this._list.mouseHandler=$EM}),$EH(0,$EL,"dataSource",$EM.prototype._$get_dataSource,function($EM){this._dataSource=$EM,$Er.superSet($En,this,"dataSource",$EM)}),$EH(0,$EL,"source",function(){return this._source}),$EH(0,$EL,"scrollBar",function(){return this._list.scrollBar}),$EH(0,$EL,"list",function(){return this._list}),$EH(0,$EL,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($EM){this._list.vScrollBarSkin=$EM}),$EH(0,$EL,"renderHandler",function(){return this._renderHandler},function($EM){this._renderHandler=$EM}),$EH(0,$EL,"selectedIndex",function(){return this._list.selectedIndex},function($EM){this._list.selectedIndex=$EM}),$EH(0,$EL,"spaceLeft",function(){return this._spaceLeft},function($EM){this._spaceLeft=$EM}),$EH(0,$EL,"selectedItem",function(){return this._list.selectedItem},function($EM){this._list.selectedItem=$EM}),$EH(0,$EL,"width",$EM.prototype._$get_width,function($EM){$Er.superSet($En,this,"width",$EM),this._list.width=$EM}),$EH(0,$EL,"height",$EM.prototype._$get_height,function($EM){$Er.superSet($En,this,"height",$EM),this._list.height=$EM}),$EH(0,$EL,"xml",null,function($EM){var $Ee=[];this.parseXml($EM.childNodes[0],$Ee,null,!0),this.array=$Ee}),$EH(0,$EL,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$Ee}($En),$EMM=function($EM){function $Ee(){this._items=null,this._selectedIndex=0,$Ee.__super.call(this),this._setIndexHandler=$EV.create(this,this.setIndex,null,!1)}$Eq($Ee,"laya.ui.ViewStack",$EM);var $EL=$Ee.prototype;return $Er.imps($EL,{"laya.ui.IItem":!0}),$EL.setItems=function($EM){this.removeChildren();for(var $Ee=0,$EL=0,$E_=$EM.length;$EL<$E_;$EL++){var $Ec=$EM[$EL];$Ec&&($Ec.name="item"+$Ee,this.addChild($Ec),$Ee++)}this.initItems()},$EL.addItem=function($EM){$EM.name="item"+this._items.length,this.addChild($EM),this.initItems()},$EL.initItems=function(){this._items=[];for(var $EM=0;$EM<1e4;$EM++){var $Ee=this.getChildByName("item"+$EM);if(null==$Ee)break;this._items.push($Ee),$Ee.visible=$EM==this._selectedIndex}},$EL.setSelect=function($EM,$Ee){this._items&&-1<$EM&&$EM<this._items.length&&(this._items[$EM].visible=$Ee)},$EL.setIndex=function($EM){this.selectedIndex=$EM},$EH(0,$EL,"dataSource",$EM.prototype._$get_dataSource,function($EM){if("number"==typeof(this._dataSource=$EM)&&Math.floor($EM)==$EM||"string"==typeof $EM)this.selectedIndex=parseInt($EM);else for(var $Ee in this._dataSource)this.hasOwnProperty($Ee)&&(this[$Ee]=this._dataSource[$Ee])}),$EH(0,$EL,"selectedIndex",function(){return this._selectedIndex},function($EM){this._selectedIndex!=$EM&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$EM,this.setSelect(this._selectedIndex,!0))}),$EH(0,$EL,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($EM){this.selectedIndex=this._items.indexOf($EM)}),$EH(0,$EL,"items",function(){return this._items}),$EH(0,$EL,"setIndexHandler",function(){return this._setIndexHandler},function($EM){this._setIndexHandler=$EM}),$Ee}($En),$EeM=function($EM){function $Ee(){$Ee.__super.call(this)}return $Eq($Ee,"laya.ui.VScrollBar",$Eg),$Ee}(),$ELM=function($Ee){function $EL($EM){this._bg=null,this._skin=null,$EL.__super.call(this),void 0===$EM&&($EM=""),this.text=$EM,this.skin=this.skin}$Eq($EL,"laya.ui.TextInput",$Ee);var $EM=$EL.prototype;return $EM.preinitialize=function(){this.mouseEnabled=!0},$EM.destroy=function($EM){$EK.clearCache(this,this._skin),void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._bg&&this._bg.destroy(),this._bg=null},$EM.createChildren=function(){this.addChild(this._tf=new $EE),this._tf.padding=$Eh.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$EM._onFocus=function(){this.event("focus",this)},$EM._onBlur=function(){this.event("blur",this)},$EM._onInput=function(){this.event("input",this)},$EM._onEnter=function(){this.event("enter",this)},$EM.initialize=function(){this.width=128,this.height=22},$EM.select=function(){this._tf.select()},$EM.setSelection=function($EM,$Ee){this._tf.setSelection($EM,$Ee)},$EH(0,$EM,"text",$Ee.prototype._$get_text,function($EM){this._tf.text!=$EM&&($EM+="",this._tf.text=$EM,this.event("change"))}),$EH(0,$EM,"bg",function(){return this._bg},function($EM){this.graphics=this._bg=$EM}),$EH(0,$EM,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($EM){this._tf.inputElementYAdjuster=$EM}),$EH(0,$EM,"multiline",function(){return this._tf.multiline},function($EM){this._tf.multiline=$EM}),$EH(0,$EM,"skin",function(){return this._skin},function($EM){this._skin!=$EM&&($EK.clearCache(this,this._skin),this._skin=$EM,this._bg||(this.graphics=this._bg=new $Ep),$EK.keepCache(this,this._skin),this._bg.source=$EK.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$EH(0,$EM,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($EM){this._bg||(this.graphics=this._bg=new $Ep),this._bg.sizeGrid=$Et.fillArray($Eh.defaultSizeGrid,$EM,Number)}),$EH(0,$EM,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($EM){this._tf.inputElementXAdjuster=$EM}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($Eb,this,"width",$EM),this._bg&&(this._bg.width=$EM)}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($Eb,this,"height",$EM),this._bg&&(this._bg.height=$EM)}),$EH(0,$EM,"editable",function(){return this._tf.editable},function($EM){this._tf.editable=$EM}),$EH(0,$EM,"restrict",function(){return this._tf.restrict},function($EM){this._tf.restrict=$EM}),$EH(0,$EM,"prompt",function(){return this._tf.prompt},function($EM){this._tf.prompt=$EM}),$EH(0,$EM,"promptColor",function(){return this._tf.promptColor},function($EM){this._tf.promptColor=$EM}),$EH(0,$EM,"maxChars",function(){return this._tf.maxChars},function($EM){this._tf.maxChars=$EM}),$EH(0,$EM,"focus",function(){return this._tf.focus},function($EM){this._tf.focus=$EM}),$EH(0,$EM,"type",function(){return this._tf.type},function($EM){this._tf.type=$EM}),$EH(0,$EM,"asPassword",function(){return this._tf.asPassword},function($EM){this._tf.asPassword=$EM}),$EL}($Eb),$E_M=function($EM){function $Ee(){$Ee.__super.call(this)}return $Eq($Ee,"laya.ui.VSlider",$EJ),$Ee}(),$EcM=function($EM){function $E_(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$E_.__super.call(this)}$Eq($E_,"laya.ui.Dialog",$EM);var $Ee=$E_.prototype;return $Ee.initialize=function(){this.popupEffect=$E_.manager.popupEffectHandler,this.closeEffect=$E_.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$Ee._dealDragArea=function(){var $EM=this.getChildByName("drag");$EM&&(this.dragArea=$EM.x+","+$EM.y+","+$EM.width+","+$EM.height,$EM.removeSelf())},$Ee._onClick=function($EM){var $Ee=$EM.target;if($Ee)switch($Ee.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($Ee.name)}},$Ee.show=function($EM,$Ee){void 0===$EM&&($EM=!1),void 0===$Ee&&($Ee=!0),this._open(!1,$EM,$Ee)},$Ee.popup=function($EM,$Ee){void 0===$EM&&($EM=!1),void 0===$Ee&&($Ee=!0),this._open(!0,$EM,$Ee)},$Ee._open=function($EM,$Ee,$EL){$E_.manager.lock(!1),this.isModal=$EM,$E_.manager.open(this,$Ee,$EL)},$Ee.onOpened=function(){},$Ee.close=function($EM,$Ee){void 0===$Ee&&($Ee=!0),$E_.manager.close(this,$EM,$Ee)},$Ee.onClosed=function($EM){},$Ee._onMouseDown=function($EM){var $Ee=this.getMousePoint();this._dragArea.contains($Ee.x,$Ee.y)?this.startDrag():this.stopDrag()},$EH(0,$Ee,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($EM){if($EM){var $Ee=$Et.fillArray([0,0,0,0],$EM,Number);this._dragArea=new $EC($Ee[0],$Ee[1],$Ee[2],$Ee[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$EH(0,$Ee,"isPopup",function(){return null!=this.parent}),$EH(0,$Ee,"zOrder",$EM.prototype._$get_zOrder,function($EM){$Er.superSet($Ez,this,"zOrder",$EM),$E_.manager._checkMask()}),$EH(1,$E_,"manager",function(){return $E_._manager=$E_._manager||new $Ea},function($EM){$E_._manager=$EM}),$E_.setLockView=function($EM){$E_.manager.setLockView($EM)},$E_.lock=function($EM){$E_.manager.lock($EM)},$E_.closeAll=function(){$E_.manager.closeAll()},$E_.getDialogsByGroup=function($EM){return $E_.manager.getDialogsByGroup($EM)},$E_.closeByGroup=function($EM){return $E_.manager.closeByGroup($EM)},$E_.CLOSE="close",$E_.CANCEL="cancel",$E_.SURE="sure",$E_.NO="no",$E_.OK="ok",$E_.YES="yes",$E_._manager=null,$E_}($Ez),$EqM=function($EM){function $Ee(){$Ee.__super.call(this)}$Eq($Ee,"laya.ui.HBox",$EM);var $EL=$Ee.prototype;return $EL.sortItem=function($EM){$EM&&$EM.sort(function($EM,$Ee){return $EM.x-$Ee.x})},$EL.changeItems=function(){this._itemChanged=!1;for(var $EM=[],$Ee=0,$EL=0,$E_=this.numChildren;$EL<$E_;$EL++){var $Ec=this.getChildAt($EL);$Ec&&$Ec.layoutEnabled&&($EM.push($Ec),$Ee=this._height?this._height:Math.max($Ee,$Ec.height*$Ec.scaleY))}this.sortItem($EM);var $Eq=0;for($EL=0,$E_=$EM.length;$EL<$E_;$EL++)($Ec=$EM[$EL]).x=$Eq,$Eq+=$Ec.width*$Ec.scaleX+this._space,"top"==this._align?$Ec.y=0:"middle"==this._align?$Ec.y=.5*($Ee-$Ec.height*$Ec.scaleY):"bottom"==this._align&&($Ec.y=$Ee-$Ec.height*$Ec.scaleY);this.changeSize()},$EH(0,$EL,"height",$EM.prototype._$get_height,function($EM){this._height!=$EM&&($Er.superSet($EY,this,"height",$EM),this.callLater(this.changeItems))}),$Ee.NONE="none",$Ee.TOP="top",$Ee.MIDDLE="middle",$Ee.BOTTOM="bottom",$Ee}($EY),$EHM=function($EM){function $Ee(){$Ee.__super.call(this)}$Eq($Ee,"laya.ui.VBox",$EM);var $EL=$Ee.prototype;return $EL.changeItems=function(){this._itemChanged=!1;for(var $EM=[],$Ee=0,$EL=0,$E_=this.numChildren;$EL<$E_;$EL++){var $Ec=this.getChildAt($EL);$Ec&&$Ec.layoutEnabled&&($EM.push($Ec),$Ee=this._width?this._width:Math.max($Ee,$Ec.width*$Ec.scaleX))}this.sortItem($EM);var $Eq=0;for($EL=0,$E_=$EM.length;$EL<$E_;$EL++)($Ec=$EM[$EL]).y=$Eq,$Eq+=$Ec.height*$Ec.scaleY+this._space,"left"==this._align?$Ec.x=0:"center"==this._align?$Ec.x=.5*($Ee-$Ec.width*$Ec.scaleX):"right"==this._align&&($Ec.x=$Ee-$Ec.width*$Ec.scaleX);this.changeSize()},$EH(0,$EL,"width",$EM.prototype._$get_width,function($EM){this._width!=$EM&&($Er.superSet($EY,this,"width",$EM),this.callLater(this.changeItems))}),$Ee.NONE="none",$Ee.LEFT="left",$Ee.CENTER="center",$Ee.RIGHT="right",$Ee}($EY),$ETM=function($EM){function $Ee(){$Ee.__super.call(this)}return $Eq($Ee,"laya.ui.RadioGroup",$ED),$Ee.prototype.createItem=function($EM,$Ee){return new $EU($EM,$Ee)},$Ee}(),$ExM=function($EM){function $Ee(){$Ee.__super.call(this)}return $Eq($Ee,"laya.ui.Tab",$ED),$Ee.prototype.createItem=function($EM,$Ee){return new $El($EM,$Ee)},$Ee}(),$EOM=function($Ee){function $EL($EM){this._vScrollBar=null,this._hScrollBar=null,void 0===$EM&&($EM=""),$EL.__super.call(this,$EM)}$Eq($EL,"laya.ui.TextArea",$Ee);var $EM=$EL.prototype;return $EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$EM.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$EM.onVBarChanged=function($EM){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$EM.onHBarChanged=function($EM){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$EM.changeScroll=function(){var $EM=this._vScrollBar&&0<this._tf.maxScrollY,$Ee=this._hScrollBar&&0<this._tf.maxScrollX,$EL=$EM?this._width-this._vScrollBar.width:this._width,$E_=$Ee?this._height-this._hScrollBar.height:this._height,$Ec=this._tf.padding||$Eh.labelPadding;this._tf.width=$EL,this._tf.height=$E_,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$Ec[2],this._vScrollBar.y=$Ec[1],this._vScrollBar.height=this._height-($Ee?this._hScrollBar.height:0)-$Ec[1]-$Ec[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$E_/Math.max(this._tf.textHeight,$E_),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$EM),this._hScrollBar&&(this._hScrollBar.x=$Ec[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$Ec[3],this._hScrollBar.width=this._width-($EM?this._vScrollBar.width:0)-$Ec[0]-$Ec[2],this._hScrollBar.scrollSize=Math.max(.033*$EL,1),this._hScrollBar.thumbPercent=$EL/Math.max(this._tf.textWidth,$EL),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$Ee)},$EM.scrollTo=function($EM){this.commitMeasure(),this._tf.scrollY=$EM},$EH(0,$EM,"scrollY",function(){return this._tf.scrollY}),$EH(0,$EM,"width",$Ee.prototype._$get_width,function($EM){$Er.superSet($ELM,this,"width",$EM),this.callLater(this.changeScroll)}),$EH(0,$EM,"hScrollBar",function(){return this._hScrollBar}),$EH(0,$EM,"height",$Ee.prototype._$get_height,function($EM){$Er.superSet($ELM,this,"height",$EM),this.callLater(this.changeScroll)}),$EH(0,$EM,"maxScrollX",function(){return this._tf.maxScrollX}),$EH(0,$EM,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($EM){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $EeM),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$EM}),$EH(0,$EM,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($EM){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $Ev),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$EM}),$EH(0,$EM,"vScrollBar",function(){return this._vScrollBar}),$EH(0,$EM,"maxScrollY",function(){return this._tf.maxScrollY}),$EH(0,$EM,"scrollX",function(){return this._tf.scrollX}),$EL}($ELM);!function($EM){function $Ee(){this._uiView=null,this.isCloseOther=!1,$Ee.__super.call(this)}$Eq($Ee,"laya.ui.AsynDialog",$EcM);var $EL=$Ee.prototype;$EL.createView=function($EM){this._uiView=$EM},$EL._open=function($EM,$Ee,$EL){this.isModal=$EM,this.isCloseOther=$Ee,$EcM.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$EL.onCreated=function(){this.createUI(),this.onOpen()},$EL.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$EL.onOpen=function(){$EcM.manager.open(this,this.isCloseOther),$EcM.manager.lock(!1)},$EL.close=function($EM,$Ee){void 0===$Ee&&($Ee=!0),$EcM.manager.close(this),this.onClose()},$EL.onClose=function(){},$EL.destroy=function($EM){void 0===$EM&&($EM=!0),laya.ui.View.prototype.destroy.call(this,$EM),this._uiView=null,this.onDestroy()},$EL.onDestroy=function(){}}();$Er.__init([$Ez])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($EM,$Ee){"use strict";for(var $EL in Object.defineProperty($Ee,"__esModule",{value:!0}),Laya){var $E_=Laya[$EL];$E_&&$E_.__isclass&&($Ee[$EL]=$E_)}}),function($EV,$EM,$Ei){$Ei.un,$Ei.uns;var $EG=$Ei.static,$EE=$Ei.class,$Ed=$Ei.getset,$E_=$Ei.__newvec,$Eo=laya.maths.Arith,$EH=laya.webgl.atlas.AtlasResourceManager,$EL=laya.webgl.shader.BaseShader,$ER=laya.utils.Browser,$ET=laya.webgl.utils.Buffer,$EW=laya.utils.Byte,$Ec=laya.utils.ClassUtils,$Ex=$Ei.Config,$Eq=(laya.events.Event,laya.events.EventDispatcher),$Eh=laya.utils.Handler,$EC=laya.net.Loader,$Ee=laya.net.LoaderManager,$EO=(laya.maths.MathUtil,laya.display.Node),$Er=laya.renders.Render,$Eu=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$E$=laya.resource.Resource,$EK=laya.utils.RunDriver,$EX=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$Ey=laya.display.Sprite,$EA=laya.utils.Stat,$EB=laya.utils.StringKey,$Et=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$Ek=laya.utils.Utils,$ES=laya.webgl.WebGL,$Ep=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$Ei.interface("laya.d3.core.IClone"),$Ei.interface("laya.d3.graphics.IVertex"),$Ei.interface("laya.d3.core.render.IUpdate"),$Ei.interface("laya.d3.core.scene.ITreeNode"),$Ei.interface("laya.d3.core.render.IRenderable");(function(){function $El(){}$EE($El,"laya.d3.animation.AnimationClipParser01"),$El.READ_DATA=function(){$El._DATA.offset=$El._reader.getUint32(),$El._DATA.size=$El._reader.getUint32()},$El.READ_BLOCK=function(){for(var $EM=$El._BLOCK.count=$El._reader.getUint16(),$Ee=$El._BLOCK.blockStarts=[],$EL=$El._BLOCK.blockLengths=[],$E_=0;$E_<$EM;$E_++)$Ee.push($El._reader.getUint32()),$EL.push($El._reader.getUint32())},$El.READ_STRINGS=function(){var $EM=$El._reader.getUint32(),$Ee=$El._reader.getUint16(),$EL=$El._reader.pos;$El._reader.pos=$EM+$El._DATA.offset;for(var $E_=0;$E_<$Ee;$E_++)$El._strings[$E_]=$El._reader.readUTFString();$El._reader.pos=$EL},$El.parse=function($EM,$Ee){$El._animationClip=$EM;($El._reader=$Ee).__getBuffer();$El.READ_DATA(),$El.READ_BLOCK(),$El.READ_STRINGS();for(var $EL=0,$E_=$El._BLOCK.count;$EL<$E_;$EL++){var $Ec=$Ee.getUint16(),$Eq=$El._strings[$Ec],$EH=$El["READ_"+$Eq];if(null==$EH)throw new Error("model file err,no this function:"+$Ec+" "+$Eq);$EH.call()}},$El.READ_ANIMATIONS=function(){var $EM,$Ee=0,$EL=0,$E_=$El._reader,$Ec=$E_.__getBuffer(),$Eq=[],$EH=$E_.getUint8();for($Eq.length=$EH,$Ee=0;$Ee<$EH;$Ee++)$Eq[$Ee]=$E_.getUint16();var $ET=[],$Ex=$E_.getUint16();for($ET.length=$Ex,$Ee=0;$Ee<$Ex;$Ee++)$ET[$Ee]=$E_.getFloat32();var $EO=$El._animationClip;$EO.name=$El._strings[$E_.getUint16()];var $Eu=$EO._duration=$E_.getFloat32();$EO.islooping=!!$E_.getByte(),$EO._frameRate=$E_.getInt16();var $EG=$E_.getInt16(),$EV=$EO._nodes=new Array;$EV.length=$EG,($EO._publicClipDatas=[]).length=$EG;var $EE=$EO._nodesMap={},$Ed=0,$Er=0;for($Ee=0;$Ee<$EG;$Ee++){$EM=$EV[$Ee]=new $Em;var $E$=$E_.getUint16(),$EC=$EM.path=[];for($EC.length=$E$,$EL=0;$EL<$E$;$EL++)$EC[$EL]=$El._strings[$E_.getUint16()];var $EK=$EC.join("/"),$EX=$EE[$EK];$EX||($EE[$EK]=$EX=[]),$EX.push($EM);var $Eo=$E_.getInt16();-1!==$Eo&&($EM.componentType=$El._strings[$Eo]);var $Ei=$Ew._propertyIndexDic[$El._strings[$E_.getUint16()]];if(null==$Ei)throw new Error("AnimationClipParser01:unknown property name.");var $EW=$Ei<4,$Ey=!$EW||$EW&&""===$EC[0];($EM._cacheProperty=$Ey)?$Ed++:$Er++,$EM.propertyNameID=$Ei;var $EA=$Eq[$E_.getUint8()];$EM.keyFrameWidth=$EA/4;var $EB=$EM.keyFrames=[],$Ek=$EB.length=$E_.getUint16(),$Eh=null,$Et=NaN;for($EL=0;$EL<$Ek;$EL++){var $ES=$EB[$EL]=new $Eb;$Et=$ES.startTime=$ET[$E_.getUint16()];var $Ep=$E_.pos;$ES.inTangent=new Float32Array($Ec.slice($Ep,$Ep+$EA)),$E_.pos+=$EA,$Ep=$E_.pos,$ES.outTangent=new Float32Array($Ec.slice($Ep,$Ep+$EA)),$E_.pos+=$EA,$Ep=$E_.pos,$ES.data=new Float32Array($Ec.slice($Ep,$Ep+$EA)),$E_.pos+=$EA,$Eh&&($Eh.next=$ES,$Eh.duration=$Et-$Eh.startTime),$Eh=$ES}$ES.next=null,$ES.duration=$Eu-$Et}var $ER=$EO._nodeToCachePropertyMap=new Int32Array($EG),$Ea=$EO._cachePropertyMap=new Int32Array($Ed),$En=$EO._unCachePropertyMap=new Int32Array($Er);for($Ed=$Er=0,$Ee=0;$Ee<$EG;$Ee++)($EM=$EV[$Ee])._cacheProperty?($ER[$Ee]=$Ed,$Ea[$Ed++]=$Ee):$En[$Er++]=$Ee},$El._animationClip=null,$El._reader=null,$El._strings=[],$EG($El,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $Eg(){}$EE($Eg,"laya.d3.animation.AnimationClipParser02"),$Eg.READ_DATA=function(){$Eg._DATA.offset=$Eg._reader.getUint32(),$Eg._DATA.size=$Eg._reader.getUint32()},$Eg.READ_BLOCK=function(){for(var $EM=$Eg._BLOCK.count=$Eg._reader.getUint16(),$Ee=$Eg._BLOCK.blockStarts=[],$EL=$Eg._BLOCK.blockLengths=[],$E_=0;$E_<$EM;$E_++)$Ee.push($Eg._reader.getUint32()),$EL.push($Eg._reader.getUint32())},$Eg.READ_STRINGS=function(){var $EM=$Eg._reader.getUint32(),$Ee=$Eg._reader.getUint16(),$EL=$Eg._reader.pos;$Eg._reader.pos=$EM+$Eg._DATA.offset;for(var $E_=0;$E_<$Ee;$E_++)$Eg._strings[$E_]=$Eg._reader.readUTFString();$Eg._reader.pos=$EL},$Eg.parse=function($EM,$Ee){$Eg._animationClip=$EM;($Eg._reader=$Ee).__getBuffer();$Eg.READ_DATA(),$Eg.READ_BLOCK(),$Eg.READ_STRINGS();for(var $EL=0,$E_=$Eg._BLOCK.count;$EL<$E_;$EL++){var $Ec=$Ee.getUint16(),$Eq=$Eg._strings[$Ec],$EH=$Eg["READ_"+$Eq];if(null==$EH)throw new Error("model file err,no this function:"+$Ec+" "+$Eq);$EH.call()}},$Eg.READ_ANIMATIONS=function(){var $EM,$Ee=0,$EL=0,$E_=$Eg._reader,$Ec=$E_.__getBuffer(),$Eq=[],$EH=$E_.getUint8();for($Eq.length=$EH,$Ee=0;$Ee<$EH;$Ee++)$Eq[$Ee]=$E_.getUint16();var $ET=[],$Ex=$E_.getUint16();for($ET.length=$Ex,$Ee=0;$Ee<$Ex;$Ee++)$ET[$Ee]=$E_.getFloat32();var $EO=$Eg._animationClip;$EO.name=$Eg._strings[$E_.getUint16()];var $Eu=$EO._duration=$E_.getFloat32();$EO.islooping=!!$E_.getByte(),$EO._frameRate=$E_.getInt16();var $EG=$E_.getInt16(),$EV=$EO._nodes=new Array;$EV.length=$EG,($EO._publicClipDatas=[]).length=$EG;var $EE=$EO._nodesMap={},$Ed=0,$Er=0;for($Ee=0;$Ee<$EG;$Ee++){$EM=$EV[$Ee]=new $Em;var $E$=$E_.getUint16(),$EC=$EM.path=[];for($EC.length=$E$,$EL=0;$EL<$E$;$EL++)$EC[$EL]=$Eg._strings[$E_.getUint16()];var $EK=$EC.join("/"),$EX=$EE[$EK];$EX||($EE[$EK]=$EX=[]),$EX.push($EM);var $Eo=$E_.getInt16();-1!==$Eo&&($EM.componentType=$Eg._strings[$Eo]);var $Ei=$Ew._propertyIndexDic[$Eg._strings[$E_.getUint16()]];if(null==$Ei)throw new Error("AnimationClipParser02:unknown property name.");var $EW=$Ei<4,$Ey=!$EW||$EW&&""===$EC[0];($EM._cacheProperty=$Ey)?$Ed++:$Er++,$EM.propertyNameID=$Ei;var $EA=$Eq[$E_.getUint8()];$EM.keyFrameWidth=$EA/4;var $EB=$EM.keyFrames=[],$Ek=$EB.length=$E_.getUint16(),$Eh=null,$Et=NaN;for($EL=0;$EL<$Ek;$EL++){var $ES=$EB[$EL]=new $Eb;$Et=$ES.startTime=$ET[$E_.getUint16()];var $Ep=$E_.pos;$ES.inTangent=new Float32Array($Ec.slice($Ep,$Ep+$EA)),$E_.pos+=$EA,$Ep=$E_.pos,$ES.outTangent=new Float32Array($Ec.slice($Ep,$Ep+$EA)),$E_.pos+=$EA,$Ep=$E_.pos,$ES.data=new Float32Array($Ec.slice($Ep,$Ep+$EA)),$E_.pos+=$EA,$Eh&&($Eh.next=$ES,$Eh.duration=$Et-$Eh.startTime),$Eh=$ES}$ES.next=null,$ES.duration=$Eu-$Et}var $ER=$E_.getUint16();for($Ee=0;$Ee<$ER;$Ee++){var $Ea,$En=new $EJ;$En.time=$E_.getFloat32(),$En.eventName=$Eg._strings[$E_.getUint16()];var $El=$E_.getUint16();for(0<$El&&($En.params=$Ea=[]),$EL=0;$EL<$El;$EL++){switch($E_.getByte()){case 0:$Ea.push(!!$E_.getByte());break;case 1:$Ea.push($E_.getInt32());break;case 2:$Ea.push($E_.getFloat32());break;case 3:$Ea.push($Eg._strings[$E_.getUint16()]);break;default:throw new Error("unknown type.")}}$EO.addEvent($En)}var $Ef=$EO._nodeToCachePropertyMap=new Int32Array($EG),$Ej=$EO._cachePropertyMap=new Int32Array($Ed),$EF=$EO._unCachePropertyMap=new Int32Array($Er);for($Ed=$Er=0,$Ee=0;$Ee<$EG;$Ee++)($EM=$EV[$Ee])._cacheProperty?($Ef[$Ee]=$Ed,$Ej[$Ed++]=$Ee):$EF[$Er++]=$Ee},$Eg._animationClip=null,$Eg._reader=null,$Eg._strings=[],$EG($Eg,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $EJ=function(){function $EM(){this.time=NaN,this.eventName=null,this.params=null}return $EE($EM,"laya.d3.animation.AnimationEvent"),$EM}(),$Ew=function(){function $E_(){this._childs=[],this.transform=new $EKe(this)}$EE($E_,"laya.d3.animation.AnimationNode");var $EM=$E_.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.addChild=function($EM){$EM._parent=this,$EM.transform.setParent(this.transform),this._childs.push($EM)},$EM.removeChild=function($EM){var $Ee=this._childs.indexOf($EM);-1!==$Ee&&this._childs.splice($Ee,1)},$EM.getChildByName=function($EM){for(var $Ee=0,$EL=this._childs.length;$Ee<$EL;$Ee++){var $E_=this._childs[$Ee];if($E_.name===$EM)return $E_}return null},$EM.getChildByIndex=function($EM){return this._childs[$EM]},$EM.getChildCount=function(){return this._childs.length},$EM.cloneTo=function($EM){var $Ee=$EM;$Ee.name=this.name;for(var $EL=0,$E_=this._childs.length;$EL<$E_;$EL++){var $Ec=this._childs[$EL],$Eq=$Ec.clone();$Ee.addChild($Eq);var $EH=$Ec.transform,$ET=$Eq.transform;$ET.setLocalPosition($EH.getLocalPosition()),$ET.setLocalRotation($EH.getLocalRotation()),$ET.setLocalScale($EH.getLocalScale()),$ET._localRotationEuler=$EH._localRotationEuler,$ET._setWorldMatrixIgnoreUpdate($EH.getWorldMatrix())}},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$E_.__init__=function(){$E_.registerAnimationNodeProperty("localPosition",$E_._getLocalPosition,$E_._setLocalPosition),$E_.registerAnimationNodeProperty("localRotation",$E_._getLocalRotation,$E_._setLocalRotation),$E_.registerAnimationNodeProperty("localScale",$E_._getLocalScale,$E_._setLocalScale),$E_.registerAnimationNodeProperty("localRotationEuler",$E_._getLocalRotationEuler,$E_._setLocalRotationEuler),$E_.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$E_._getParticleRenderSharedMaterialTintColor,$E_._setParticleRenderSharedMaterialTintColor),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$E_._getMeshRenderSharedMaterialTilingOffset,$E_._setMeshRenderSharedMaterialTilingOffset),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$E_._getMeshRenderSharedMaterialAlbedo,$E_._setMeshRenderSharedMaterialAlbedo),$E_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$E_._getSkinnedMeshRenderSharedMaterialTilingOffset,$E_._setSkinnedMeshRenderSharedMaterialTilingOffset),$E_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$E_._getSkinnedMeshRenderSharedMaterialAlbedo,$E_._setSkinnedMeshRenderSharedMaterialAlbedo),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$E_._getMeshRenderSharedMaterialAlbedo,$E_._setMeshRenderSharedMaterialAlbedo),$E_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$E_._getSkinnedMeshRenderSharedMaterialAlbedo,$E_._setSkinnedMeshRenderSharedMaterialAlbedo),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$E_._getMeshRenderSharedMaterialIntensity,$E_._setMeshRenderSharedMaterialIntensity),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$E_._getMeshRenderSharedMaterialAlpha,$E_._setMeshRenderSharedMaterialAlpha),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$E_._getMeshRenderSharedMaterialAlphaColor,$E_._setMeshRenderSharedMaterialAlphaColor),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$E_._getMeshRenderSharedMaterialBaseColor,$E_._setMeshRenderSharedMaterialBaseColor),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$E_._getMeshRenderSharedMaterialDissolve,$E_._setMeshRenderSharedMaterialDissolve),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$E_._getMeshRenderSharedMaterialDissolveSpeed,$E_._setMeshRenderSharedMaterialDissolveSpeed),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$E_._getMeshRenderSharedMaterialMMultiplier,$E_._setMeshRenderSharedMaterialMMultiplier),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$E_._getMeshRenderSharedMaterialBaseScrollSpeedX,$E_._setMeshRenderSharedMaterialBaseScrollSpeedX),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$E_._getMeshRenderSharedMaterialBaseScrollSpeedY,$E_._setMeshRenderSharedMaterialBaseScrollSpeedY),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$E_._getMeshRenderSharedMaterialSecondScrollSpeedX,$E_._setMeshRenderSharedMaterialSecondScrollSpeedX),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$E_._getMeshRenderSharedMaterialSecondScrollSpeedY,$E_._setMeshRenderSharedMaterialSecondScrollSpeedY),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$E_._getMeshRenderSharedMaterialDetailTilingOffset,$E_._setMeshRenderSharedMaterialDetailTilingOffset),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$E_._getMeshRenderSharedMaterialDissolveTilingOffset,$E_._setMeshRenderSharedMaterialDissolveTilingOffset),$E_.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$E_._getMeshRenderSharedMaterialMaskTilingOffset,$E_._setMeshRenderSharedMaterialMaskTilingOffset)},$E_.registerAnimationNodeProperty=function($EM,$Ee,$EL){if($E_._propertyIndexDic[$EM])throw new Error("AnimationNode: this propertyName has registered.");$E_._propertyIndexDic[$EM]=$E_._propertyIDCounter,$E_._propertyGetFuncs[$E_._propertyIDCounter]=$Ee,$E_._propertySetFuncs[$E_._propertyIDCounter]=$EL,$E_._propertyIDCounter++},$E_._getLocalPosition=function($EM,$Ee){return $EM?$EM.transform.getLocalPosition():$Ee._transform.localPosition.elements},$E_._setLocalPosition=function($EM,$Ee,$EL){if($EM)$EM.transform.setLocalPosition($EL);else{var $E_=$Ee._transform,$Ec=$E_.localPosition;$Ec.elements=$EL,$E_.localPosition=$Ec}},$E_._getLocalRotation=function($EM,$Ee){return $EM?$EM.transform.getLocalRotation():$Ee._transform.localRotation.elements},$E_._setLocalRotation=function($EM,$Ee,$EL){if($EM)$EM.transform.setLocalRotation($EL);else{var $E_=$Ee._transform,$Ec=$E_.localRotation;$Ec.elements=$EL,$E_.localRotation=$Ec}},$E_._getLocalScale=function($EM,$Ee){return $EM?$EM.transform.getLocalScale():$Ee._transform.localScale.elements},$E_._setLocalScale=function($EM,$Ee,$EL){if($EM)$EM.transform.setLocalScale($EL);else{var $E_=$Ee._transform,$Ec=$E_.localScale;$Ec.elements=$EL,$E_.localScale=$Ec}},$E_._getLocalRotationEuler=function($EM,$Ee){return $EM?$EM.transform.getLocalRotationEuler():$Ee._transform.localRotationEuler.elements},$E_._setLocalRotationEuler=function($EM,$Ee,$EL){if($EM)$EM.transform.setLocalRotationEuler($EL);else{var $E_=$Ee._transform,$Ec=$E_.localRotationEuler;$Ec.elements=$EL,$E_.localRotationEuler=$Ec}},$E_._getMeshRenderSharedMaterialTilingOffset=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $Ee.meshRender.sharedMaterial.tilingOffset.elements},$E_._setMeshRenderSharedMaterialTilingOffset=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.meshRender.material).tilingOffset).elements=$EL,$E_.tilingOffset=$Ec)}else($Ec=($E_=$Ee.meshRender.material).tilingOffset).elements=$EL,$E_.tilingOffset=$Ec},$E_._getMeshRenderSharedMaterialAlbedo=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $Ee.meshRender.sharedMaterial.albedoColor.elements},$E_._setMeshRenderSharedMaterialAlbedo=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.meshRender.material).albedoColor).elements=$EL,$E_.albedoColor=$Ec)}else($Ec=($E_=$Ee.meshRender.material).albedoColor).elements=$EL,$E_.albedoColor=$Ec},$E_._getSkinnedMeshRenderSharedMaterialTilingOffset=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $Ee.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$E_._setSkinnedMeshRenderSharedMaterialTilingOffset=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.skinnedMeshRender.material).tilingOffset).elements=$EL,$E_.tilingOffset=$Ec)}else($Ec=($E_=$Ee.skinnedMeshRender.material).tilingOffset).elements=$EL,$E_.tilingOffset=$Ec},$E_._getSkinnedMeshRenderSharedMaterialAlbedo=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $Ee.skinnedMeshRender.sharedMaterial.albedoColor.elements},$E_._setSkinnedMeshRenderSharedMaterialAlbedo=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.skinnedMeshRender.material).albedoColor).elements=$EL,$E_.albedoColor=$Ec)}else($Ec=($E_=$Ee.skinnedMeshRender.material).albedoColor).elements=$EL,$E_.albedoColor=$Ec},$E_._getParticleRenderSharedMaterialTintColor=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.particleRender.sharedMaterial.tintColor.elements:null}return $Ee.particleRender.sharedMaterial.tintColor.elements},$E_._setParticleRenderSharedMaterialTintColor=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.particleRender.material).tintColor).elements=$EL,$E_.tintColor=$Ec)}else($Ec=($E_=$Ee.particleRender.material).tintColor).elements=$EL,$E_.tintColor=$Ec},$E_._getMeshRenderSharedMaterialAlphaColor=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $Ee.meshRender.sharedMaterial.alphaColor.elements},$E_._setMeshRenderSharedMaterialAlphaColor=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.meshRender.material).alphaColor).elements=$EL,$E_.alphaColor=$Ec)}else($Ec=($E_=$Ee.meshRender.material).alphaColor).elements=$EL,$E_.alphaColor=$Ec},$E_._getMeshRenderSharedMaterialBaseColor=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.baseColor.elements:null}return $Ee.meshRender.sharedMaterial.baseColor.elements},$E_._setMeshRenderSharedMaterialBaseColor=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.meshRender.material).baseColor).elements=$EL,$E_.baseColor=$Ec)}else($Ec=($E_=$Ee.meshRender.material).baseColor).elements=$EL,$E_.baseColor=$Ec},$E_._getMeshRenderSharedMaterialDissolve=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.dissolve:0}return $Ee.meshRender.sharedMaterial.dissolve},$E_._setMeshRenderSharedMaterialDissolve=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.dissolve=$EL[0])}else $Ee.meshRender.material.dissolve=$EL[0]},$E_._getMeshRenderSharedMaterialDissolveSpeed=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $Ee.meshRender.sharedMaterial.dissolveSpeed},$E_._setMeshRenderSharedMaterialDissolveSpeed=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.dissolveSpeed=$EL[0])}else $Ee.meshRender.material.dissolveSpeed=$EL[0]},$E_._getMeshRenderSharedMaterialMMultiplier=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.mMultiplier:0}return $Ee.meshRender.sharedMaterial.mMultiplier},$E_._setMeshRenderSharedMaterialMMultiplier=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.mMultiplier=$EL[0])}else $Ee.meshRender.material.mMultiplier=$EL[0]},$E_._getMeshRenderSharedMaterialBaseScrollSpeedX=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $Ee.meshRender.sharedMaterial.baseScrollSpeedX},$E_._setMeshRenderSharedMaterialBaseScrollSpeedX=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.baseScrollSpeedX=$EL[0])}else $Ee.meshRender.material.baseScrollSpeedX=$EL[0]},$E_._getMeshRenderSharedMaterialBaseScrollSpeedY=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $Ee.meshRender.sharedMaterial.baseScrollSpeedY},$E_._setMeshRenderSharedMaterialBaseScrollSpeedY=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.baseScrollSpeedY=$EL[0])}else $Ee.meshRender.material.baseScrollSpeedY=$EL[0]},$E_._getMeshRenderSharedMaterialSecondScrollSpeedX=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $Ee.meshRender.sharedMaterial.secondScrollSpeedX},$E_._setMeshRenderSharedMaterialSecondScrollSpeedX=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.secondScrollSpeedX=$EL[0])}else $Ee.meshRender.material.secondScrollSpeedX=$EL[0]},$E_._getMeshRenderSharedMaterialSecondScrollSpeedY=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $Ee.meshRender.sharedMaterial.secondScrollSpeedY},$E_._setMeshRenderSharedMaterialSecondScrollSpeedY=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.secondScrollSpeedY=$EL[0])}else $Ee.meshRender.material.secondScrollSpeedY=$EL[0]},$E_._getMeshRenderSharedMaterialAlpha=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.alpha:0}return $Ee.meshRender.sharedMaterial.alpha},$E_._setMeshRenderSharedMaterialAlpha=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.alpha=$EL[0])}else $Ee.meshRender.material.alpha=$EL[0]},$E_._getMeshRenderSharedMaterialIntensity=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.intensity:0}return $Ee.meshRender.sharedMaterial.intensity},$E_._setMeshRenderSharedMaterialIntensity=function($EM,$Ee,$EL){if($EM){var $E_=$EM.transform._entity;$E_&&($E_.owner.meshRender.material.intensity=$EL[0])}else $Ee.meshRender.material.intensity=$EL[0]},$E_._getMeshRenderSharedMaterialDetailTilingOffset=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $Ee.meshRender.sharedMaterial.detailTilingOffset.elements},$E_._setMeshRenderSharedMaterialDetailTilingOffset=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.meshRender.material).detailTilingOffset).elements=$EL,$E_.detailTilingOffset=$Ec)}else($Ec=($E_=$Ee.meshRender.material).detailTilingOffset).elements=$EL,$E_.detailTilingOffset=$Ec},$E_._getMeshRenderSharedMaterialDissolveTilingOffset=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $Ee.meshRender.sharedMaterial.dissolveTilingOffset.elements},$E_._setMeshRenderSharedMaterialDissolveTilingOffset=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.meshRender.material).dissolveTilingOffset).elements=$EL,$E_.dissolveTilingOffset=$Ec)}else($Ec=($E_=$Ee.meshRender.material).dissolveTilingOffset).elements=$EL,$E_.dissolveTilingOffset=$Ec},$E_._getMeshRenderSharedMaterialMaskTilingOffset=function($EM,$Ee){if($EM){var $EL=$EM.transform._entity;return $EL?$EL.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $Ee.meshRender.sharedMaterial.maskTilingOffset.elements},$E_._setMeshRenderSharedMaterialMaskTilingOffset=function($EM,$Ee,$EL){var $E_,$Ec;if($EM){var $Eq=$EM.transform._entity;$Eq&&(($Ec=($E_=$Eq.owner.meshRender.material).maskTilingOffset).elements=$EL,$E_.maskTilingOffset=$Ec)}else($Ec=($E_=$Ee.meshRender.material).maskTilingOffset).elements=$EL,$E_.maskTilingOffset=$Ec},$E_._propertyIDCounter=0,$E_._propertyIndexDic={},$E_._propertySetFuncs=[],$E_._propertyGetFuncs=[],$E_}(),$Eb=function(){function $EM(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $EE($EM,"laya.d3.animation.Keyframe"),$EM}(),$Em=function(){function $EM(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $EE($EM,"laya.d3.animation.KeyframeNode"),$EM}(),$Ea=(function(){function $EM(){this._tempVector30=new $EHe,this._tempVector31=new $EHe,this._tempVector32=new $EHe,this._a=new $EHe,this._b=new $EHe,this._c=new $EHe,this._d=new $EHe}$EE($EM,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $Ee=$EM.prototype;$Ee.Init=function($EM,$Ee,$EL,$E_){$EM.cloneTo(this._d),$Ee.cloneTo(this._c),$EHe.scale($EM,2,this._a),$EHe.scale($EL,2,this._tempVector30),$EHe.subtract(this._a,this._tempVector30,this._a),$EHe.add(this._a,$Ee,this._a),$EHe.add(this._a,$E_,this._a),$EHe.scale($EL,3,this._b),$EHe.scale($EM,3,this._tempVector30),$EHe.subtract(this._b,this._tempVector30,this._b),$EHe.subtract(this._b,$E_,this._b),$EHe.scale($Ee,2,this._tempVector30),$EHe.subtract(this._b,this._tempVector30,this._b)},$Ee.Slerp=function($EM,$Ee){$EHe.scale(this._a,$EM*$EM*$EM,this._tempVector30),$EHe.scale(this._b,$EM*$EM,this._tempVector31),$EHe.scale(this._c,$EM,this._tempVector32),$EHe.add(this._tempVector30,this._tempVector31,$Ee),$EHe.add($Ee,this._tempVector32,$Ee),$EHe.add($Ee,this._d,$Ee)}}(),function(){function $Ej($EM,$Ee,$EL,$E_){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$EM,this._h=$Ee,this._minHeight=$EL,this._maxHeight=$E_}$EE($Ej,"laya.d3.core.HeightMap");var $EM=$Ej.prototype;$EM._inBounds=function($EM,$Ee){return 0<=$EM&&$EM<this._h&&0<=$Ee&&$Ee<this._w},$EM.getHeight=function($EM,$Ee){return this._inBounds($EM,$Ee)?this._datas[$EM][$Ee]:NaN},$Ed(0,$EM,"width",function(){return this._w}),$Ed(0,$EM,"height",function(){return this._h}),$Ed(0,$EM,"maxHeight",function(){return this._maxHeight}),$Ed(0,$EM,"minHeight",function(){return this._minHeight}),$Ej.creatFromMesh=function($EM,$Ee,$EL,$E_){for(var $Ec=[],$Eq=[],$EH=$EM.getSubMeshCount(),$ET=0;$ET<$EH;$ET++){for(var $Ex=$EM.getSubMesh($ET),$EO=$Ex._getVertexBuffer(),$Eu=$EO.getData(),$EG=[],$EV=0;$EV<$Eu.length;$EV+=$EO.vertexDeclaration.vertexStride/4){var $EE=new $EHe($Eu[$EV+0],$Eu[$EV+1],$Eu[$EV+2]);$EG.push($EE)}$Ec.push($EG);var $Ed=$Ex._getIndexBuffer();$Eq.push($Ed.getData())}var $Er=$EM.boundingBox,$E$=$Er.min.x,$EC=$Er.min.z,$EK=$Er.max.x,$EX=$Er.max.z,$Eo=$Er.min.y,$Ei=$Er.max.y,$EW=$EK-$E$,$Ey=$EX-$EC,$EA=$E_.elements[0]=$EW/($Ee-1),$EB=$E_.elements[1]=$Ey/($EL-1),$Ek=new $Ej($Ee,$EL,$Eo,$Ei),$Eh=$Ej._tempRay,$Et=$Eh.direction.elements;$Et[0]=0,$Et[1]=-1,$Et[2]=0;var $ES=$Ei+.1;$Eh.origin.elements[1]=$ES;for(var $Ep=0;$Ep<$EL;$Ep++){var $ER=$EC+$Ep*$EB;$Ek._datas[$Ep]=[];for(var $Ea=0;$Ea<$Ee;$Ea++){var $En=$E$+$Ea*$EA,$El=$Eh.origin.elements;$El[0]=$En,$El[2]=$ER;var $Ef=$Ej._getPosition($Eh,$Ec,$Eq);$Ek._datas[$Ep][$Ea]=$Ef===Number.MAX_VALUE?NaN:$ES-$Ef}}return $Ek},$Ej.createFromImage=function($EM,$Ee,$EL){for(var $E_=$EM.width,$Ec=$EM.height,$Eq=new $Ej($E_,$Ec,$Ee,$EL),$EH=($EL-$Ee)/254,$ET=$EM.getPixels(),$Ex=0,$EO=0;$EO<$Ec;$EO++)for(var $Eu=$Eq._datas[$EO]=[],$EG=0;$EG<$E_;$EG++){var $EV=$ET[$Ex++],$EE=$ET[$Ex++],$Ed=$ET[$Ex++],$Er=$ET[$Ex++];$Eu[$EG]=255==$EV&&255==$EE&&255==$Ed&&255==$Er?NaN:($EV+$EE+$Ed)/3*$EH+$Ee}return $Eq},$Ej._getPosition=function($EM,$Ee,$EL){for(var $E_=Number.MAX_VALUE,$Ec=0;$Ec<$Ee.length;$Ec++)for(var $Eq=$Ee[$Ec],$EH=$EL[$Ec],$ET=0;$ET<$EH.length;$ET+=3){var $Ex=$Eq[$EH[$ET+0]],$EO=$Eq[$EH[$ET+1]],$Eu=$Eq[$EH[$ET+2]],$EG=$Ede.rayIntersectsTriangle($EM,$Ex,$EO,$Eu);!isNaN($EG)&&$EG<$E_&&($E_=$EG)}return $E_},$EG($Ej,["_tempRay",function(){return this._tempRay=new $Ece(new $EHe,new $EHe)}])}(),function(){function $Ec(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$EE($Ec,"laya.d3.core.Layer");var $EM=$Ec.prototype;return $EM._binarySearchIndex=function(){for(var $EM=0,$Ee=$Ec._collsionTestList.length-1,$EL=0;$EM<=$Ee;){$EL=Math.floor(($EM+$Ee)/2);var $E_=$Ec._collsionTestList[$EL];if($E_==this._number)return $EL;$E_>this._number?$Ee=$EL-1:$EM=$EL+1}return $EM},$EM._addCollider=function($EM){0===this._colliders.length&&$Ec._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$EM._isRigidbody?(this._colliders.unshift($EM),this._nonRigidbodyOffset++):this._colliders.push($EM)},$EM._removeCollider=function($EM){var $Ee=this._colliders.indexOf($EM);$Ee<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($Ee,1),0===this._colliders.length&&$Ec._collsionTestList.splice($Ec._collsionTestList.indexOf(this._number),1)},$Ed(0,$EM,"number",function(){return this._number}),$Ed(0,$EM,"visible",function(){return this._visible},function($EM){this._visible=$EM,$Ec._visibleLayers=$EM?$Ec._visibleLayers|this.mask:$Ec._visibleLayers&~this.mask}),$Ed(0,$EM,"mask",function(){return this._mask}),$Ed(1,$Ec,"visibleLayers",function(){return $Ec._visibleLayers},function($EM){$Ec._visibleLayers=$EM;for(var $Ee=0,$EL=$Ec._layerList.length;$Ee<$EL;$Ee++){var $E_=$Ec._layerList[$Ee];$E_._visible=0!=($E_._mask&$Ec._visibleLayers)}}),$Ec.__init__=function(){$Ec._layerList.length=31;for(var $EM=0;$EM<31;$EM++){var $Ee=new $Ec;$Ec._layerList[$EM]=$Ee,0===$EM?($Ee.name="Default Layer",$Ee.visible=!0):($Ee.name="Layer-"+$EM,$Ee.visible=!1),$Ee._number=$EM,$Ee._mask=Math.pow(2,$EM)}$Ec.currentCreationLayer=$Ec._layerList[0]},$Ec.getLayerByNumber=function($EM){if($EM<0||30<$EM)throw new Error("无法返回指定Layer，该number超出范围！");return $Ec._layerList[$EM]},$Ec.getLayerByName=function($EM){for(var $Ee=0;$Ee<31;$Ee++)if($Ec._layerList[$Ee].name===$EM)return $Ec._layerList[$Ee];throw new Error("无法返回指定Layer,该name不存在")},$Ec.isVisible=function($EM){return 0!=($EM&$Ec._currentCameraCullingMask&$Ec._visibleLayers)},$Ec._layerList=[],$Ec._visibleLayers=2147483647,$Ec._collsionTestList=[],$Ec._currentCameraCullingMask=2147483647,$Ec.maxCount=31,$Ec.currentCreationLayer=null,$Ec}()),$En=(function(){function $EM($EM,$Ee,$EL){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$EM,this._minCount=$Ee,this._maxCount=$EL}$EE($EM,"laya.d3.core.particleShuriKen.module.Burst");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.cloneTo=function($EM){var $Ee=$EM;$Ee._time=this._time,$Ee._minCount=this._minCount,$Ee._maxCount=this._maxCount},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"time",function(){return this._time}),$Ed(0,$Ee,"minCount",function(){return this._minCount}),$Ed(0,$Ee,"maxCount",function(){return this._maxCount})}(),function(){function $EM($EM){this._color=null,this.enbale=!1,this._color=$EM}$EE($EM,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $Ee=$EM.prototype;$Ee.cloneTo=function($EM){var $Ee=$EM;this._color.cloneTo($Ee._color),$Ee.enbale=this.enbale},$Ee.clone=function(){var $EM;switch(this._color.type){case 0:$EM=$Ef.createByConstant(this._color.constant.clone());break;case 1:$EM=$Ef.createByGradient(this._color.gradient.clone());break;case 2:$EM=$Ef.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$EM=$Ef.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $Ee=new this.constructor($EM);return $Ee.enbale=this.enbale,$Ee},$Ed(0,$Ee,"color",function(){return this._color})}(),function(){function $EM(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$EE($EM,"laya.d3.core.particleShuriKen.module.Emission");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$Ee._destroy=function(){this._bursts=null,this._destroyed=!0},$Ee.getBurstsCount=function(){return this._bursts.length},$Ee.getBurstByIndex=function($EM){return this._bursts[$EM]},$Ee.addBurst=function($EM){var $Ee=this._bursts.length;if(0<$Ee)for(var $EL=0;$EL<$Ee;$EL++)this._bursts[$EL].time>$EM.time&&this._bursts.splice($EL,0,$EM);this._bursts.push($EM)},$Ee.removeBurst=function($EM){var $Ee=this._bursts.indexOf($EM);-1!==$Ee&&this._bursts.splice($Ee,1)},$Ee.removeBurstByIndex=function($EM){this._bursts.splice($EM,1)},$Ee.clearBurst=function(){this._bursts.length=0},$Ee.cloneTo=function($EM){var $Ee=$EM,$EL=$Ee._bursts;$EL.length=this._bursts.length;for(var $E_=0,$Ec=this._bursts.length;$E_<$Ec;$E_++){var $Eq=$EL[$E_];$Eq?this._bursts[$E_].cloneTo($Eq):$EL[$E_]=this._bursts[$E_].clone()}$Ee._emissionRate=this._emissionRate,$Ee.enbale=this.enbale},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"destroyed",function(){return this._destroyed}),$Ed(0,$Ee,"emissionRate",function(){return this._emissionRate},function($EM){if($EM<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$EM})}(),function(){function $E_(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$EE($E_,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $EM=$E_.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.cloneTo=function($EM){var $Ee=$EM;$Ee._type=this._type,$Ee._constant=this._constant,this._overTime.cloneTo($Ee._overTime),$Ee._constantMin=this._constantMin,$Ee._constantMax=this._constantMax,this._overTimeMin.cloneTo($Ee._overTimeMin),this._overTimeMax.cloneTo($Ee._overTimeMax)},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$EM,"frameOverTimeData",function(){return this._overTime}),$Ed(0,$EM,"constant",function(){return this._constant}),$Ed(0,$EM,"type",function(){return this._type}),$Ed(0,$EM,"frameOverTimeDataMin",function(){return this._overTimeMin}),$Ed(0,$EM,"constantMin",function(){return this._constantMin}),$Ed(0,$EM,"frameOverTimeDataMax",function(){return this._overTimeMax}),$Ed(0,$EM,"constantMax",function(){return this._constantMax}),$E_.createByConstant=function($EM){var $Ee=new $E_;return $Ee._type=0,$Ee._constant=$EM,$Ee},$E_.createByOverTime=function($EM){var $Ee=new $E_;return $Ee._type=1,$Ee._overTime=$EM,$Ee},$E_.createByRandomTwoConstant=function($EM,$Ee){var $EL=new $E_;return $EL._type=2,$EL._constantMin=$EM,$EL._constantMax=$Ee,$EL},$E_.createByRandomTwoOverTime=function($EM,$Ee){var $EL=new $E_;return $EL._type=3,$EL._overTimeMin=$EM,$EL._overTimeMax=$Ee,$EL},$E_}()),$El=function(){function $EO(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$EE($EO,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $EM=$EO.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.cloneTo=function($EM){var $Ee=$EM;$Ee._type=this._type,$Ee._separateAxes=this._separateAxes,$Ee._constant=this._constant,this._constantSeparate.cloneTo($Ee._constantSeparate),this._gradient.cloneTo($Ee._gradient),this._gradientX.cloneTo($Ee._gradientX),this._gradientY.cloneTo($Ee._gradientY),this._gradientZ.cloneTo($Ee._gradientZ),$Ee._constantMin=this._constantMin,$Ee._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($Ee._constantMinSeparate),this._constantMaxSeparate.cloneTo($Ee._constantMaxSeparate),this._gradientMin.cloneTo($Ee._gradientMin),this._gradientMax.cloneTo($Ee._gradientMax),this._gradientXMin.cloneTo($Ee._gradientXMin),this._gradientXMax.cloneTo($Ee._gradientXMax),this._gradientYMin.cloneTo($Ee._gradientYMin),this._gradientYMax.cloneTo($Ee._gradientYMax),this._gradientZMin.cloneTo($Ee._gradientZMin),this._gradientZMax.cloneTo($Ee._gradientZMax)},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$EM,"gradientZ",function(){return this._gradientZ}),$Ed(0,$EM,"constant",function(){return this._constant}),$Ed(0,$EM,"gradient",function(){return this._gradient}),$Ed(0,$EM,"separateAxes",function(){return this._separateAxes}),$Ed(0,$EM,"type",function(){return this._type}),$Ed(0,$EM,"constantSeparate",function(){return this._constantSeparate}),$Ed(0,$EM,"gradientX",function(){return this._gradientX}),$Ed(0,$EM,"gradientY",function(){return this._gradientY}),$Ed(0,$EM,"gradientW",function(){return this._gradientW}),$Ed(0,$EM,"gradientMin",function(){return this._gradientMin}),$Ed(0,$EM,"constantMin",function(){return this._constantMin}),$Ed(0,$EM,"gradientMax",function(){return this._gradientMax}),$Ed(0,$EM,"constantMax",function(){return this._constantMax}),$Ed(0,$EM,"gradientWMin",function(){return this._gradientWMin}),$Ed(0,$EM,"constantMinSeparate",function(){return this._constantMinSeparate}),$Ed(0,$EM,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$Ed(0,$EM,"gradientXMin",function(){return this._gradientXMin}),$Ed(0,$EM,"gradientXMax",function(){return this._gradientXMax}),$Ed(0,$EM,"gradientWMax",function(){return this._gradientWMax}),$Ed(0,$EM,"gradientYMin",function(){return this._gradientYMin}),$Ed(0,$EM,"gradientYMax",function(){return this._gradientYMax}),$Ed(0,$EM,"gradientZMin",function(){return this._gradientZMin}),$Ed(0,$EM,"gradientZMax",function(){return this._gradientZMax}),$EO.createByConstant=function($EM){var $Ee=new $EO;return $Ee._type=0,$Ee._separateAxes=!1,$Ee._constant=$EM,$Ee},$EO.createByConstantSeparate=function($EM){var $Ee=new $EO;return $Ee._type=0,$Ee._separateAxes=!0,$Ee._constantSeparate=$EM,$Ee},$EO.createByGradient=function($EM){var $Ee=new $EO;return $Ee._type=1,$Ee._separateAxes=!1,$Ee._gradient=$EM,$Ee},$EO.createByGradientSeparate=function($EM,$Ee,$EL,$E_){var $Ec=new $EO;return $Ec._type=1,$Ec._separateAxes=!0,$Ec._gradientX=$EM,$Ec._gradientY=$Ee,$Ec._gradientZ=$EL,$Ec._gradientW=$E_,$Ec},$EO.createByRandomTwoConstant=function($EM,$Ee){var $EL=new $EO;return $EL._type=2,$EL._separateAxes=!1,$EL._constantMin=$EM,$EL._constantMax=$Ee,$EL},$EO.createByRandomTwoConstantSeparate=function($EM,$Ee){var $EL=new $EO;return $EL._type=2,$EL._separateAxes=!0,$EL._constantMinSeparate=$EM,$EL._constantMaxSeparate=$Ee,$EL},$EO.createByRandomTwoGradient=function($EM,$Ee){var $EL=new $EO;return $EL._type=3,$EL._separateAxes=!1,$EL._gradientMin=$EM,$EL._gradientMax=$Ee,$EL},$EO.createByRandomTwoGradientSeparate=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){var $Ex=new $EO;return $Ex._type=3,$Ex._separateAxes=!0,$Ex._gradientXMin=$EM,$Ex._gradientXMax=$Ee,$Ex._gradientYMin=$EL,$Ex._gradientYMax=$E_,$Ex._gradientZMin=$Ec,$Ex._gradientZMax=$Eq,$Ex._gradientWMin=$EH,$Ex._gradientWMax=$ET,$Ex},$EO}(),$Ef=function(){function $E_(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$EE($E_,"laya.d3.core.particleShuriKen.module.GradientColor");var $EM=$E_.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.cloneTo=function($EM){var $Ee=$EM;$Ee._type=this._type,this._constant.cloneTo($Ee._constant),this._constantMin.cloneTo($Ee._constantMin),this._constantMax.cloneTo($Ee._constantMax),this._gradient.cloneTo($Ee._gradient),this._gradientMin.cloneTo($Ee._gradientMin),this._gradientMax.cloneTo($Ee._gradientMax)},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$EM,"gradient",function(){return this._gradient}),$Ed(0,$EM,"constant",function(){return this._constant}),$Ed(0,$EM,"type",function(){return this._type}),$Ed(0,$EM,"gradientMin",function(){return this._gradientMin}),$Ed(0,$EM,"constantMin",function(){return this._constantMin}),$Ed(0,$EM,"gradientMax",function(){return this._gradientMax}),$Ed(0,$EM,"constantMax",function(){return this._constantMax}),$E_.createByConstant=function($EM){var $Ee=new $E_;return $Ee._type=0,$Ee._constant=$EM,$Ee},$E_.createByGradient=function($EM){var $Ee=new $E_;return $Ee._type=1,$Ee._gradient=$EM,$Ee},$E_.createByRandomTwoConstant=function($EM,$Ee){var $EL=new $E_;return $EL._type=2,$EL._constantMin=$EM,$EL._constantMax=$Ee,$EL},$E_.createByRandomTwoGradient=function($EM,$Ee){var $EL=new $E_;return $EL._type=3,$EL._gradientMin=$EM,$EL._gradientMax=$Ee,$EL},$E_}(),$Ej=(function(){function $EM(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$EE($EM,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.addAlpha=function($EM,$Ee){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$EM&&($EM=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$EM,this._alphaElements[this._alphaCurrentLength++]=$Ee):DEBUG},$Ee.addRGB=function($EM,$Ee){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$EM&&($EM=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$EM,this._rgbElements[this._rgbCurrentLength++]=$Ee.x,this._rgbElements[this._rgbCurrentLength++]=$Ee.y,this._rgbElements[this._rgbCurrentLength++]=$Ee.z):DEBUG},$Ee.cloneTo=function($EM){var $Ee=$EM,$EL=0,$E_=0;$Ee._alphaCurrentLength=this._alphaCurrentLength;var $Ec=$Ee._alphaElements;for($Ec.length=this._alphaElements.length,$EL=0,$E_=this._alphaElements.length;$EL<$E_;$EL++)$Ec[$EL]=this._alphaElements[$EL];$Ee._rgbCurrentLength=this._rgbCurrentLength;var $Eq=$Ee._rgbElements;for($Eq.length=this._rgbElements.length,$EL=0,$E_=this._rgbElements.length;$EL<$E_;$EL++)$Eq[$EL]=this._rgbElements[$EL]},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$Ed(0,$Ee,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $EM(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$EE($EM,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.add=function($EM,$Ee){this._currentLength<8?(6===this._currentLength&&1!==$EM&&($EM=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$EM,this._elements[this._currentLength++]=$Ee):console.log("Warning:data count must lessEqual than 4")},$Ee.cloneTo=function($EM){var $Ee=$EM;$Ee._currentLength=this._currentLength;var $EL=$Ee._elements;$EL.length=this._elements.length;for(var $E_=0,$Ec=this._elements.length;$E_<$Ec;$E_++)$EL[$E_]=this._elements[$E_]},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"gradientCount",function(){return this._currentLength/2})}(),function(){function $EM(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$EE($EM,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.add=function($EM,$Ee){this._currentLength<8?(6===this._currentLength&&1!==$EM&&($EM=1,DEBUG),this._elements[this._currentLength++]=$EM,this._elements[this._currentLength++]=$Ee):DEBUG},$Ee.getKeyByIndex=function($EM){return this._elements[2*$EM]},$Ee.getValueByIndex=function($EM){return this._elements[2*$EM+1]},$Ee.getAverageValue=function(){for(var $EM=0,$Ee=this._currentLength-2;$EM<$Ee;$EM+=2){this._elements[$EM+1];this._elements[$EM+3],this._elements[$EM+2]-this._elements[$EM]}return 0},$Ee.cloneTo=function($EM){var $Ee=$EM;$Ee._currentLength=this._currentLength;var $EL=$Ee._elements;$EL.length=this._elements.length;for(var $E_=0,$Ec=this._elements.length;$E_<$Ec;$E_++)$EL[$E_]=this._elements[$E_]},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"gradientCount",function(){return this._currentLength/2})}(),function(){function $EM(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$EE($EM,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.add=function($EM,$Ee){this._currentLength<8?(6===this._currentLength&&1!==$EM&&($EM=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$EM,this._elements[this._currentLength++]=$Ee.x,this._elements[this._currentLength++]=$Ee.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$Ee.cloneTo=function($EM){var $Ee=$EM;$Ee._currentLength=this._currentLength;var $EL=$Ee._elements;$EL.length=this._elements.length;for(var $E_=0,$Ec=this._elements.length;$E_<$Ec;$E_++)$EL[$E_]=this._elements[$E_]},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"gradientCount",function(){return this._currentLength/3})}(),function(){function $ET(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$EE($ET,"laya.d3.core.particleShuriKen.module.GradientSize");var $EM=$ET.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.getMaxSizeInGradient=function(){var $EM=0,$Ee=0,$EL=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($EM=0,$Ee=this._gradientX.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientX.getValueByIndex($EM));for($EM=0,$Ee=this._gradientY.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientY.getValueByIndex($EM))}else for($EM=0,$Ee=this._gradient.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradient.getValueByIndex($EM));break;case 1:$EL=this._separateAxes?($EL=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$EL=Math.max($EL,this._constantMinSeparate.y),Math.max($EL,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($EM=0,$Ee=this._gradientXMin.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientXMin.getValueByIndex($EM));for($EM=0,$Ee=this._gradientXMax.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientXMax.getValueByIndex($EM));for($EM=0,$Ee=this._gradientYMin.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientYMin.getValueByIndex($EM));for($EM=0,$Ee=this._gradientZMax.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientZMax.getValueByIndex($EM))}else{for($EM=0,$Ee=this._gradientMin.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientMin.getValueByIndex($EM));for($EM=0,$Ee=this._gradientMax.gradientCount;$EM<$Ee;$EM++)$EL=Math.max($EL,this._gradientMax.getValueByIndex($EM))}}return $EL},$EM.cloneTo=function($EM){var $Ee=$EM;$Ee._type=this._type,$Ee._separateAxes=this._separateAxes,this._gradient.cloneTo($Ee._gradient),this._gradientX.cloneTo($Ee._gradientX),this._gradientY.cloneTo($Ee._gradientY),this._gradientZ.cloneTo($Ee._gradientZ),$Ee._constantMin=this._constantMin,$Ee._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($Ee._constantMinSeparate),this._constantMaxSeparate.cloneTo($Ee._constantMaxSeparate),this._gradientMin.cloneTo($Ee._gradientMin),this._gradientMax.cloneTo($Ee._gradientMax),this._gradientXMin.cloneTo($Ee._gradientXMin),this._gradientXMax.cloneTo($Ee._gradientXMax),this._gradientYMin.cloneTo($Ee._gradientYMin),this._gradientYMax.cloneTo($Ee._gradientYMax),this._gradientZMin.cloneTo($Ee._gradientZMin),this._gradientZMax.cloneTo($Ee._gradientZMax)},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$EM,"gradientZ",function(){return this._gradientZ}),$Ed(0,$EM,"gradient",function(){return this._gradient}),$Ed(0,$EM,"separateAxes",function(){return this._separateAxes}),$Ed(0,$EM,"type",function(){return this._type}),$Ed(0,$EM,"gradientMin",function(){return this._gradientMin}),$Ed(0,$EM,"constantMin",function(){return this._constantMin}),$Ed(0,$EM,"gradientX",function(){return this._gradientX}),$Ed(0,$EM,"gradientY",function(){return this._gradientY}),$Ed(0,$EM,"gradientMax",function(){return this._gradientMax}),$Ed(0,$EM,"constantMax",function(){return this._constantMax}),$Ed(0,$EM,"constantMinSeparate",function(){return this._constantMinSeparate}),$Ed(0,$EM,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$Ed(0,$EM,"gradientXMin",function(){return this._gradientXMin}),$Ed(0,$EM,"gradientXMax",function(){return this._gradientXMax}),$Ed(0,$EM,"gradientYMin",function(){return this._gradientYMin}),$Ed(0,$EM,"gradientYMax",function(){return this._gradientYMax}),$Ed(0,$EM,"gradientZMin",function(){return this._gradientZMin}),$Ed(0,$EM,"gradientZMax",function(){return this._gradientZMax}),$ET.createByGradient=function($EM){var $Ee=new $ET;return $Ee._type=0,$Ee._separateAxes=!1,$Ee._gradient=$EM,$Ee},$ET.createByGradientSeparate=function($EM,$Ee,$EL){var $E_=new $ET;return $E_._type=0,$E_._separateAxes=!0,$E_._gradientX=$EM,$E_._gradientY=$Ee,$E_._gradientZ=$EL,$E_},$ET.createByRandomTwoConstant=function($EM,$Ee){var $EL=new $ET;return $EL._type=1,$EL._separateAxes=!1,$EL._constantMin=$EM,$EL._constantMax=$Ee,$EL},$ET.createByRandomTwoConstantSeparate=function($EM,$Ee){var $EL=new $ET;return $EL._type=1,$EL._separateAxes=!0,$EL._constantMinSeparate=$EM,$EL._constantMaxSeparate=$Ee,$EL},$ET.createByRandomTwoGradient=function($EM,$Ee){var $EL=new $ET;return $EL._type=2,$EL._separateAxes=!1,$EL._gradientMin=$EM,$EL._gradientMax=$Ee,$EL},$ET.createByRandomTwoGradientSeparate=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=new $ET;return $EH._type=2,$EH._separateAxes=!0,$EH._gradientXMin=$EM,$EH._gradientXMax=$Ee,$EH._gradientYMin=$EL,$EH._gradientYMax=$E_,$EH._gradientZMin=$Ec,$EH._gradientZMax=$Eq,$EH},$ET}()),$EF=function(){function $ET(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$EE($ET,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $EM=$ET.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.cloneTo=function($EM){var $Ee=$EM;$Ee._type=this._type,this._constant.cloneTo($Ee._constant),this._gradientX.cloneTo($Ee._gradientX),this._gradientY.cloneTo($Ee._gradientY),this._gradientZ.cloneTo($Ee._gradientZ),this._constantMin.cloneTo($Ee._constantMin),this._constantMax.cloneTo($Ee._constantMax),this._gradientXMin.cloneTo($Ee._gradientXMin),this._gradientXMax.cloneTo($Ee._gradientXMax),this._gradientYMin.cloneTo($Ee._gradientYMin),this._gradientYMax.cloneTo($Ee._gradientYMax),this._gradientZMin.cloneTo($Ee._gradientZMin),this._gradientZMax.cloneTo($Ee._gradientZMax)},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$EM,"gradientZ",function(){return this._gradientZ}),$Ed(0,$EM,"constant",function(){return this._constant}),$Ed(0,$EM,"type",function(){return this._type}),$Ed(0,$EM,"gradientXMax",function(){return this._gradientXMax}),$Ed(0,$EM,"constantMin",function(){return this._constantMin}),$Ed(0,$EM,"gradientX",function(){return this._gradientX}),$Ed(0,$EM,"gradientY",function(){return this._gradientY}),$Ed(0,$EM,"gradientXMin",function(){return this._gradientXMin}),$Ed(0,$EM,"constantMax",function(){return this._constantMax}),$Ed(0,$EM,"gradientYMin",function(){return this._gradientYMin}),$Ed(0,$EM,"gradientYMax",function(){return this._gradientYMax}),$Ed(0,$EM,"gradientZMin",function(){return this._gradientZMin}),$Ed(0,$EM,"gradientZMax",function(){return this._gradientZMax}),$ET.createByConstant=function($EM){var $Ee=new $ET;return $Ee._type=0,$Ee._constant=$EM,$Ee},$ET.createByGradient=function($EM,$Ee,$EL){var $E_=new $ET;return $E_._type=1,$E_._gradientX=$EM,$E_._gradientY=$Ee,$E_._gradientZ=$EL,$E_},$ET.createByRandomTwoConstant=function($EM,$Ee){var $EL=new $ET;return $EL._type=2,$EL._constantMin=$EM,$EL._constantMax=$Ee,$EL},$ET.createByRandomTwoGradient=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=new $ET;return $EH._type=3,$EH._gradientXMin=$EM,$EH._gradientXMax=$Ee,$EH._gradientYMin=$EL,$EH._gradientYMax=$E_,$EH._gradientZMin=$Ec,$EH._gradientZMax=$Eq,$EH},$ET}(),$Eg=(function(){function $EM($EM){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$EM}$EE($EM,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.cloneTo=function($EM){var $Ee=$EM;this._angularVelocity.cloneTo($Ee._angularVelocity),$Ee.enbale=this.enbale},$Ee.clone=function(){var $EM;switch(this._angularVelocity.type){case 0:$EM=this._angularVelocity.separateAxes?$El.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$El.createByConstant(this._angularVelocity.constant);break;case 1:$EM=this._angularVelocity.separateAxes?$El.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$El.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$EM=this._angularVelocity.separateAxes?$El.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$El.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$EM=this._angularVelocity.separateAxes?$El.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$El.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $Ee=new this.constructor($EM);return $Ee.enbale=this.enbale,$Ee},$Ed(0,$Ee,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $EM(){this.enable=!1,this.randomDirection=!1}$EE($EM,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee._getShapeBoundBox=function($EM){throw new Error("BaseShape: must override it.")},$Ee._getSpeedBoundBox=function($EM){throw new Error("BaseShape: must override it.")},$Ee.generatePositionAndDirection=function($EM,$Ee,$EL,$E_){throw new Error("BaseShape: must override it.")},$Ee._calculateProceduralBounds=function($EM,$Ee,$EL){this._getShapeBoundBox($EM);var $E_=$EM.min,$Ec=$EM.max;$EHe.multiply($E_,$Ee,$E_),$EHe.multiply($Ec,$Ee,$Ec);var $Eq=new $ENM(new $EHe,new $EHe);this.randomDirection?($Eq.min=new $EHe(-1,-1,-1),$Eq.max=new $EHe(1,1,1)):this._getSpeedBoundBox($Eq);var $EH=new $ENM(new $EHe,new $EHe),$ET=$EH.min,$Ex=$EH.max;$EHe.scale($Eq.min,$EL.y,$ET),$EHe.scale($Eq.max,$EL.y,$Ex),$EHe.add($EM.min,$ET,$ET),$EHe.add($EM.max,$Ex,$Ex),$EHe.min($EM.min,$ET,$EM.min),$EHe.max($EM.max,$ET,$EM.max);var $EO=new $ENM(new $EHe,new $EHe),$Eu=$EO.min,$EG=$EO.max;$EHe.scale($Eq.min,$EL.x,$Eu),$EHe.scale($Eq.max,$EL.x,$EG),$EHe.min($EO.min,$EG,$ET),$EHe.max($EO.min,$EG,$Ex),$EHe.min($EM.min,$ET,$EM.min),$EHe.max($EM.max,$ET,$EM.max)},$Ee.cloneTo=function($EM){$EM.enable=this.enable},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$EM}()),$Ez=function(){function $Eq(){}return $EE($Eq,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$Eq._randomPointUnitArcCircle=function($EM,$Ee,$EL){var $E_=$Ee.elements,$Ec=NaN;$Ec=$EL?$EL.getFloat()*$EM:Math.random()*$EM,$E_[0]=Math.cos($Ec),$E_[1]=Math.sin($Ec)},$Eq._randomPointInsideUnitArcCircle=function($EM,$Ee,$EL){var $E_=$Ee.elements;$Eq._randomPointUnitArcCircle($EM,$Ee,$EL);var $Ec=NaN;$Ec=$EL?Math.pow($EL.getFloat(),.5):Math.pow(Math.random(),.5),$E_[0]=$E_[0]*$Ec,$E_[1]=$E_[1]*$Ec},$Eq._randomPointUnitCircle=function($EM,$Ee){var $EL=$EM.elements,$E_=NaN;$E_=$Ee?$Ee.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$EL[0]=Math.cos($E_),$EL[1]=Math.sin($E_)},$Eq._randomPointInsideUnitCircle=function($EM,$Ee){var $EL=$EM.elements;$Eq._randomPointUnitCircle($EM);var $E_=NaN;$E_=$Ee?Math.pow($Ee.getFloat(),.5):Math.pow(Math.random(),.5),$EL[0]=$EL[0]*$E_,$EL[1]=$EL[1]*$E_},$Eq._randomPointUnitSphere=function($EM,$Ee){var $EL=$EM.elements,$E_=NaN,$Ec=NaN;$Ec=$Ee?($E_=$EL[2]=2*$Ee.getFloat()-1,$Ee.getFloat()*Math.PI*2):($E_=$EL[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $Eq=Math.sqrt(1-$E_*$E_);$EL[0]=$Eq*Math.cos($Ec),$EL[1]=$Eq*Math.sin($Ec)},$Eq._randomPointInsideUnitSphere=function($EM,$Ee){var $EL=$EM.elements;$Eq._randomPointUnitSphere($EM);var $E_=NaN;$E_=$Ee?Math.pow($Ee.getFloat(),1/3):Math.pow(Math.random(),1/3),$EL[0]=$EL[0]*$E_,$EL[1]=$EL[1]*$E_,$EL[2]=$EL[2]*$E_},$Eq._randomPointInsideHalfUnitBox=function($EM,$Ee){var $EL=$EM.elements;$Ee?($EL[0]=$Ee.getFloat()-.5,$EL[1]=$Ee.getFloat()-.5,$EL[2]=$Ee.getFloat()-.5):($EL[0]=Math.random()-.5,$EL[1]=Math.random()-.5,$EL[2]=Math.random()-.5)},$Eq}(),$EQ=(function(){function $EM($EM){this._size=null,this.enbale=!1,this._size=$EM}$EE($EM,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.cloneTo=function($EM){var $Ee=$EM;this._size.cloneTo($Ee._size),$Ee.enbale=this.enbale},$Ee.clone=function(){var $EM;switch(this._size.type){case 0:$EM=this._size.separateAxes?$Ej.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$Ej.createByGradient(this._size.gradient.clone());break;case 1:$EM=this._size.separateAxes?$Ej.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$Ej.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$EM=this._size.separateAxes?$Ej.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$Ej.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $Ee=new this.constructor($EM);return $Ee.enbale=this.enbale,$Ee},$Ed(0,$Ee,"size",function(){return this._size})}(),function(){function $E_(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$EE($E_,"laya.d3.core.particleShuriKen.module.StartFrame");var $EM=$E_.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.cloneTo=function($EM){var $Ee=$EM;$Ee._type=this._type,$Ee._constant=this._constant,$Ee._constantMin=this._constantMin,$Ee._constantMax=this._constantMax},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$EM,"constant",function(){return this._constant}),$Ed(0,$EM,"type",function(){return this._type}),$Ed(0,$EM,"constantMin",function(){return this._constantMin}),$Ed(0,$EM,"constantMax",function(){return this._constantMax}),$E_.createByConstant=function($EM){var $Ee=new $E_;return $Ee._type=0,$Ee._constant=$EM,$Ee},$E_.createByRandomTwoConstant=function($EM,$Ee){var $EL=new $E_;return $EL._type=1,$EL._constantMin=$EM,$EL._constantMax=$Ee,$EL},$E_}()),$EY=(function(){function $EM($EM,$Ee){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $Eqe(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$EM,this._startFrame=$Ee}$EE($EM,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.cloneTo=function($EM){var $Ee=$EM;this.tiles.cloneTo($Ee.tiles),$Ee.type=this.type,$Ee.randomRow=this.randomRow,this._frame.cloneTo($Ee._frame),this._startFrame.cloneTo($Ee._startFrame),$Ee.cycles=this.cycles,$Ee.enableUVChannels=this.enableUVChannels,$Ee.enable=this.enable},$Ee.clone=function(){var $EM,$Ee;switch(this._frame.type){case 0:$EM=$En.createByConstant(this._frame.constant);break;case 1:$EM=$En.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$EM=$En.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$EM=$En.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$Ee=$EQ.createByConstant(this._startFrame.constant);break;case 1:$Ee=$EQ.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $EL=new this.constructor($EM,$Ee);return this.tiles.cloneTo($EL.tiles),$EL.type=this.type,$EL.randomRow=this.randomRow,$EL.cycles=this.cycles,$EL.enableUVChannels=this.enableUVChannels,$EL.enable=this.enable,$EL},$Ed(0,$Ee,"frame",function(){return this._frame}),$Ed(0,$Ee,"startFrame",function(){return this._startFrame})}(),function(){function $EM($EM){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$EM}$EE($EM,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.cloneTo=function($EM){var $Ee=$EM;this._velocity.cloneTo($Ee._velocity),$Ee.enbale=this.enbale,$Ee.space=this.space},$Ee.clone=function(){var $EM;switch(this._velocity.type){case 0:$EM=$EF.createByConstant(this._velocity.constant.clone());break;case 1:$EM=$EF.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$EM=$EF.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$EM=$EF.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $Ee=new this.constructor($EM);return $Ee.enbale=this.enbale,$Ee.space=this.space,$Ee},$Ed(0,$Ee,"velocity",function(){return this._velocity})}(),function(){function $EM(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $EVe,this._vb=$Ege.create($EM._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$EFe.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$Efe.nameKey.getID("LINE"),this._shaderCompile=$EAe._preCompileShader[this._sharderNameID]}$EE($EM,"laya.d3.core.PhasorSpriter3D");var $Ee=$EM.prototype;return $Ee.line=function($EM,$Ee,$EL,$E_){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($EM.x,$EM.y,$EM.z,$Ee.x,$Ee.y,$Ee.z,$Ee.w),this.addVertex($EL.x,$EL.y,$EL.z,$E_.x,$E_.y,$E_.z,$E_.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$Ee.circle=function($EM,$Ee,$EL,$E_,$Ec,$Eq){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$Ee,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$Ee,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$EM,Math.cos(this._tempNumver0)*$EM,0,$EL,$E_,$Ec,$Eq),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$Ee.plane=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$E_/2,this._tempNumver1=$Ec/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($EM-this._tempNumver0,$Ee+this._tempNumver1,$EL,$Eq,$EH,$ET,$Ex),this.addVertex($EM+this._tempNumver0,$Ee+this._tempNumver1,$EL,$Eq,$EH,$ET,$Ex),this.addVertex($EM-this._tempNumver0,$Ee-this._tempNumver1,$EL,$Eq,$EH,$ET,$Ex),this.addVertex($EM+this._tempNumver0,$Ee-this._tempNumver1,$EL,$Eq,$EH,$ET,$Ex),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$Ee.box=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$E_/2,this._tempNumver1=$Ec/2,this._tempNumver2=$Eq/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($EM-this._tempNumver0,$Ee+this._tempNumver1,$EL+this._tempNumver2,$EH,$ET,$Ex,$EO),this.addVertex($EM+this._tempNumver0,$Ee+this._tempNumver1,$EL+this._tempNumver2,$EH,$ET,$Ex,$EO),this.addVertex($EM-this._tempNumver0,$Ee-this._tempNumver1,$EL+this._tempNumver2,$EH,$ET,$Ex,$EO),this.addVertex($EM+this._tempNumver0,$Ee-this._tempNumver1,$EL+this._tempNumver2,$EH,$ET,$Ex,$EO),this.addVertex($EM+this._tempNumver0,$Ee+this._tempNumver1,$EL-this._tempNumver2,$EH,$ET,$Ex,$EO),this.addVertex($EM-this._tempNumver0,$Ee+this._tempNumver1,$EL-this._tempNumver2,$EH,$ET,$Ex,$EO),this.addVertex($EM+this._tempNumver0,$Ee-this._tempNumver1,$EL-this._tempNumver2,$EH,$ET,$Ex,$EO),this.addVertex($EM-this._tempNumver0,$Ee-this._tempNumver1,$EL-this._tempNumver2,$EH,$ET,$Ex,$EO),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$Ee.cone=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$EL+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$EL>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$EL,this.addVertexIndex(0,$Ee,0,$E_,$Ec,$Eq,$EH,this._tempUint0),this.addVertexIndex(0,0,0,$E_,$Ec,$Eq,$EH,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$EL;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($EM*this._tempNumver2,0,$EM*this._tempNumver3,$E_,$Ec,$Eq,$EH,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$EL-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($EM*this._tempNumver2,0,$EM*this._tempNumver3,$E_,$Ec,$Eq,$EH,this._tempUint0+(this._tempInt0+$EL)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$EL-1?this.addIndexes(this._tempUint1+$EL+2):this.addIndexes(this._tempUint1+this._tempInt0+$EL+1),this.addIndexes(this._tempUint1+this._tempInt0+$EL),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$Ee.boundingBoxLine=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($EM,$Ec,$Eq,$EH,$ET,$Ex,$EO),this.addVertex($E_,$Ec,$Eq,$EH,$ET,$Ex,$EO),this.addVertex($EM,$Ee,$Eq,$EH,$ET,$Ex,$EO),this.addVertex($E_,$Ee,$Eq,$EH,$ET,$Ex,$EO),this.addVertex($E_,$Ec,$EL,$EH,$ET,$Ex,$EO),this.addVertex($EM,$Ec,$EL,$EH,$ET,$Ex,$EO),this.addVertex($E_,$Ee,$EL,$EH,$ET,$Ex,$EO),this.addVertex($EM,$Ee,$EL,$EH,$ET,$Ex,$EO),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$Ee.addVertex=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$EM,this._vbData[this._posInVBData+1]=$Ee,this._vbData[this._posInVBData+2]=$EL,this._vbData[this._posInVBData+3]=$E_,this._vbData[this._posInVBData+4]=$Ec,this._vbData[this._posInVBData+5]=$Eq,this._vbData[this._posInVBData+6]=$EH,this._posInVBData+=this._floatSizePerVer,this},$Ee.addVertexIndex=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){return this._hasBegun||this.addVertexIndexException(),this._vbData[$ET]=$EM,this._vbData[$ET+1]=$Ee,this._vbData[$ET+2]=$EL,this._vbData[$ET+3]=$E_,this._vbData[$ET+4]=$Ec,this._vbData[$ET+5]=$Eq,this._vbData[$ET+6]=$EH,($ET+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$ET),this},$Ee.addIndexes=function($EM){var $Ee=arguments;this._hasBegun||this.addVertexIndexException();for(var $EL=0;$EL<$Ee.length;$EL++)this._ibData[this._posInIBData]=$Ee[$EL],this._posInIBData++;return this},$Ee.begin=function($EM,$Ee){return this._hasBegun&&this.beginException0(),1!==$EM&&4!==$EM&&this.beginException1(),this._primitiveType=$EM,this._camera=$Ee,this._hasBegun=!0,this},$Ee.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$Ee.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($EM._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$EA.drawCall++,$ES.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$Ee.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$Ee.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$Ee.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$Ee.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$Ee.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$Ee.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(28,[new $EHM(0,"vector3",0),new $EHM(12,"vector4",1)])}]),$EM}()),$EP=function(){function $EM(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$EM._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $EVe}$EE($EM,"laya.d3.core.render.RenderElement");var $Ee=$EM.prototype;return $Ee.getDynamicBatchBakedVertexs=function($EM){for(var $Ee=this._renderObj._getVertexBuffer($EM),$EL=$Ee.getData().slice(),$E_=$Ee.vertexDeclaration,$Ec=$E_.getVertexElementByUsage(0).offset/4,$Eq=$E_.getVertexElementByUsage(3).offset/4,$EH=this._sprite3D.transform,$ET=$EH.worldMatrix,$Ex=$EH.rotation,$EO=$E_.vertexStride/4,$Eu=0,$EG=$EL.length;$Eu<$EG;$Eu+=$EO){var $EV=$Eu+$Ec,$EE=$Eu+$Eq;$E$e.transformVector3ArrayToVector3ArrayCoordinate($EL,$EV,$ET,$EL,$EV),$E$e.transformVector3ArrayByQuat($EL,$EE,$Ex,$EL,$EE)}return $EL},$Ee.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$Ee._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$Ed(0,$Ee,"id",function(){return this._id}),$Ed(0,$Ee,"renderObj",function(){return this._renderObj},function($EM){this._renderObj!==$EM&&(this._renderObj=$EM)}),$EM._uniqueIDCounter=0,$EM}(),$EZ=function(){function $Ee($EM){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$Ee._uniqueIDCounter,this._needSort=!1,this._scene=$EM,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$EE($Ee,"laya.d3.core.render.RenderQueue");var $EM=$Ee.prototype;return $EM._sortOpaqueFunc=function($EM,$Ee){if($EM._render&&$Ee._render){var $EL=$EM._material.renderQueue-$Ee._material.renderQueue;return 0==$EL?$EM._render._distanceForSort-$Ee._render._distanceForSort:$EL}return 0},$EM._sortAlphaFunc=function($EM,$Ee){if($EM._render&&$Ee._render){var $EL=$EM._material.renderQueue-$Ee._material.renderQueue;return 0==$EL?$Ee._render._distanceForSort-$EM._render._distanceForSort:$EL}return 0},$EM._begainRenderElement=function($EM,$Ee,$EL){return!!$Ee._beforeRender($EM)},$EM._sortAlpha=function($EM){$Ee._cameraPosition=$EM,this._finalElements.sort(this._sortAlphaFunc)},$EM._sortOpaque=function($EM){$Ee._cameraPosition=$EM,this._finalElements.sort(this._sortOpaqueFunc)},$EM._preRender=function($EM){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$EM._render=function($EM,$Ee){for(var $EL,$E_,$Ec,$Eq,$EH,$ET,$Ex=$EA.loopCount,$EO=this._scene,$Eu=$EM.camera,$EG=($Eu.id,!1),$EV=0,$EE=this._finalElements.length;$EV<$EE;$EV++){var $Ed,$Er,$E$,$EC=this._finalElements[$EV];if(null!=$EC._onPreRenderFunction&&$EC._onPreRenderFunction.call($EC._sprite3D,$EM),0===$EC._type){if($EM.owner=$E$=$EC._sprite3D,$EM.renderElement=$EC,$E$._preRenderUpdateComponents($EM),$Ed=$EC.renderObj,$Er=$EC._material,this._begainRenderElement($EM,$Ed,$Er)){if($EL=$Ed._getVertexBuffers(),!($Ec=($E_=$Ed._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$E_.id]){this._errorRecord[$E_.id]=1;var $EK="vertexBuffer:"+("("+$E_._destroyed+","+$E_._released+","+$E_._referenceCount+","+$E_._buffer+")")+", material:"+($Er?$Er.__className+"("+$Er._destroyed+","+$Er._released+")":"null")+", owner:"+($E$?$E$.__className+"("+$E$._destroyed+","+$E$._activeInHierarchy+","+$E$._displayedInStage+")":"null")+", renderObj:"+($Ed?$Ed.__className+"("+$Ed._destroyed+","+$Ed._released+","+$Ed._referenceCount+")":"")+", parent:, url:"+($E$?$E$.url:"")+", disposeStack:"+$E_.disposeStack;$Ei.recordError("报错：unknown vertexDeclaration  "+$EK)}continue}if($EG=($Eq=$EM._shader=$Er._getShader($EO._shaderDefineValue,$Ec.shaderDefineValue,$E$._shaderDefineValue)).bind()||$Ex!==$Eq._uploadLoopCount,$EL){if($Eq._uploadVertexBuffer!==$EL||$EG){for(var $EX=0;$EX<$EL.length;$EX++){var $Eo=$EL[$EX];$Eq.uploadAttributesX($Eo.vertexDeclaration.shaderValues.data,$Eo)}$Eq._uploadVertexBuffer=$EL}}else($Eq._uploadVertexBuffer!==$E_||$EG)&&($Eq.uploadAttributes($Ec.shaderValues.data,null),$Eq._uploadVertexBuffer=$E_);($Eq._uploadScene!==$EO||$EG)&&($Eq.uploadSceneUniforms($EO._shaderValues.data),$Eq._uploadScene=$EO),($Eu!==$Eq._uploadCamera||$Eq._uploadSprite3D!==$E$||$EG)&&($Eq.uploadSpriteUniforms($E$._shaderValues.data),$Eq._uploadSprite3D=$E$),($Eu!==$Eq._uploadCamera||$EG)&&($Eq.uploadCameraUniforms($Eu._shaderValues.data),$Eq._uploadCamera=$Eu),($Eq._uploadMaterial!==$Er||$EG)&&($Er._upload(),$Eq._uploadMaterial=$Er),$EH!==$Er?($Er._setRenderStateBlendDepth(),$Er._setRenderStateFrontFace($Ee,$E$.transform),$EH=$Er,$ET=$E$):$ET!==$E$&&($Er._setRenderStateFrontFace($Ee,$E$.transform),$ET=$E$),$Ed._render($EM),$Eq._uploadLoopCount=$Ex}$E$._postRenderUpdateComponents($EM)}else if(2===$EC._type){$EC.renderObj;$EM.owner=$E$=$EC._sprite3D,$EM.renderElement=$EC,$EM._batchIndexStart=$EC._tempBatchIndexStart,$EM._batchIndexEnd=$EC._tempBatchIndexEnd,$Ed=$EC.renderObj,$Er=$EC._material,this._begainRenderElement($EM,$Ed,$Er)&&($Ec=($E_=$Ed._getVertexBuffer(0)).vertexDeclaration,$EG=($Eq=$EM._shader=$Er._getShader($EO._shaderDefineValue,$Ec.shaderDefineValue,$E$._shaderDefineValue)).bind()||$Ex!==$Eq._uploadLoopCount,($Eq._uploadVertexBuffer!==$E_||$EG)&&($Eq.uploadAttributes($Ec.shaderValues.data,null),$Eq._uploadVertexBuffer=$E_),($Eq._uploadScene!==$EO||$EG)&&($Eq.uploadSceneUniforms($EO._shaderValues.data),$Eq._uploadScene=$EO),($Eu!==$Eq._uploadCamera||$Eq._uploadSprite3D!==$E$||$EG)&&($Eq.uploadSpriteUniforms($E$._shaderValues.data),$Eq._uploadSprite3D=$E$),($Eu!==$Eq._uploadCamera||$EG)&&($Eq.uploadCameraUniforms($Eu._shaderValues.data),$Eq._uploadCamera=$Eu),($Eq._uploadMaterial!==$Er||$EG)&&($Er._upload(),$Eq._uploadMaterial=$Er),$EH!==$Er?($Er._setRenderStateBlendDepth(),$Er._setRenderStateFrontFace($Ee,$E$.transform),$EH=$Er,$ET=$E$):$ET!==$E$&&($Er._setRenderStateFrontFace($Ee,$E$.transform),$ET=$E$),$Ed._render($EM),$Eq._uploadLoopCount=$Ex)}}},$EM._renderShadow=function($EM,$Ee){for(var $EL,$E_,$Ec,$Eq,$EH,$ET=$EA.loopCount,$Ex=this._scene,$EO=$EM.camera,$Eu=!1,$EG=0,$EV=this._finalElements.length;$EG<$EV;$EG++){var $EE,$Ed,$Er,$E$=this._finalElements[$EG];0===$E$._type&&($EM.owner=$Er=$E$._sprite3D,$Ee||$Er._projectionViewWorldUpdateCamera===$EO&&$Er._projectionViewWorldUpdateLoopCount===$EA.loopCount||($Er._render._renderUpdate($EM._projectionViewMatrix),$Er._projectionViewWorldUpdateLoopCount=$EA.loopCount,$Er._projectionViewWorldUpdateCamera=$EO),$EM.renderElement=$E$,$Er._preRenderUpdateComponents($EM),$EE=$E$.renderObj,$Ed=$E$._material,this._begainRenderElement($EM,$EE,null)&&($E_=($EL=$EE._getVertexBuffer(0)).vertexDeclaration,$Eu=($Ec=$EM._shader=$Ed._getShader($Ex._shaderDefineValue,$E_.shaderDefineValue,$Er._shaderDefineValue)).bind()||$ET!==$Ec._uploadLoopCount,($Ec._uploadVertexBuffer!==$EL||$Eu)&&($Ec.uploadAttributes($E_.shaderValues.data,null),$Ec._uploadVertexBuffer=$EL),($EO!==$Ec._uploadCamera||$Ec._uploadSprite3D!==$Er||$Eu)&&($Ec.uploadSpriteUniforms($Er._shaderValues.data),$Ec._uploadSprite3D=$Er),($EO!==$Ec._uploadCamera||$Eu)&&($Ec.uploadCameraUniforms($EO._shaderValues.data),$Ec._uploadCamera=$EO),($Ec._uploadMaterial!==$Ed||$Eu)&&($Ed._upload(),$Ec._uploadMaterial=$Ed),$Ec._uploadRenderElement,$Eq!==$Ed?($Ed._setRenderStateFrontFace(!1,$Er.transform),$Eq=$Ed,$EH=$Er):$EH!==$Er&&($Ed._setRenderStateFrontFace(!1,$Er.transform),$EH=$Er),$EE._render($EM),$Ec._uploadLoopCount=$ET),$Er._postRenderUpdateComponents($EM))}},$EM._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$EM._addRenderElement=function($EM){this._renderElements.push($EM),this._needSort=!0},$EM._addDynamicBatchElement=function($EM){this._dynamicBatchCombineRenderElements.push($EM)},$Ed(0,$EM,"id",function(){return this._id}),$Ee._uniqueIDCounter=0,$Ee._cameraPosition=null,$Ee}(),$Ev=function(){function $EM(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $EE($EM,"laya.d3.core.render.RenderState"),$EM.clientWidth=0,$EM.clientHeight=0,$EM}(),$EN=function(){function $EH($EM,$Ee){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $EDM(new $EHe,0),this._corners=[new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe],this._boundingBoxCenter=new $EHe,this._children=$E_(8),this._objects=[],this._tempBoundBoxCorners=[new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe],this._scene=$EM,this._currentDepth=$Ee}$EE($EH,"laya.d3.core.scene.OctreeNode");var $EM=$EH.prototype;return $Ei.imps($EM,{"laya.d3.core.scene.ITreeNode":!0}),$EM.init=function($EM,$Ee){var $EL=new $EHe,$E_=new $EHe;$EHe.scale($Ee,-.5,$EL),$EHe.scale($Ee,.5,$E_),$EHe.add($EL,$EM,$EL),$EHe.add($E_,$EM,$E_),this.exactBox=new $ENM($EL,$E_),this.relaxBox=new $ENM($EL,$E_)},$EM.addTreeNode=function($EM){1===Collision.boxContainsBox(this._relaxBox,$EM.boundingBox)?this.addNodeDown($EM,0):this.addObject($EM)},$EM.addChild=function($EM){var $Ee=this._children[$EM];if(null==$Ee){$Ee=new $EH(this._scene,this._currentDepth+1),(this._children[$EM]=$Ee)._parent=this,$EHe.subtract(this._exactBox.max,this._exactBox.min,$EH.tempSize),$EHe.multiply($EH.tempSize,$EH._octreeSplit[$EM],$EH.tempCenter),$EHe.add(this._exactBox.min,$EH.tempCenter,$EH.tempCenter),$EHe.scale($EH.tempSize,.25,$EH.tempSize);var $EL=new $EHe,$E_=new $EHe;$EHe.subtract($EH.tempCenter,$EH.tempSize,$EL),$EHe.add($EH.tempCenter,$EH.tempSize,$E_),$Ee.exactBox=new $ENM($EL,$E_),$EHe.scale($EH.tempSize,$EH.relax,$EH.tempSize);var $Ec=new $EHe,$Eq=new $EHe;$EHe.subtract($EH.tempCenter,$EH.tempSize,$Ec),$EHe.add($EH.tempCenter,$EH.tempSize,$Eq),$Ee.relaxBox=new $ENM($Ec,$Eq)}return $Ee},$EM.addObject=function($EM){($EM._treeNode=this)._objects.push($EM)},$EM.removeObject=function($EM){if($EM._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $Ee=this._objects.indexOf($EM);return-1!==$Ee&&(this._objects.splice($Ee,1),!0)},$EM.clearObject=function(){this._objects.length=0},$EM.addNodeUp=function($EM,$Ee){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$EM.boundingBox)?this._parent.addNodeUp($EM,$Ee-1):this.addNodeDown($EM,$Ee)},$EM.addNodeDown=function($EM,$Ee){if($Ee<this._scene.treeLevel){var $EL=this.inChildIndex($EM.boundingBoxCenter),$E_=this.addChild($EL);1===Collision.boxContainsBox($E_._relaxBox,$EM.boundingBox)?$E_.addNodeDown($EM,++$Ee):this.addObject($EM)}else this.addObject($EM)},$EM.inChildIndex=function($EM){return 4*($EM.z<this._boundingBoxCenter.z?0:1)+2*($EM.y<this._boundingBoxCenter.y?0:1)+($EM.x<this._boundingBoxCenter.x?0:1)},$EM.updateObject=function($EM){1===Collision.boxContainsBox(this._relaxBox,$EM.boundingBox)?(this.removeObject($EM),$EM._treeNode=null,this.addNodeDown($EM,this._currentDepth)):this._parent&&(this.removeObject($EM),$EM._treeNode=null,this._parent.addNodeUp($EM,this._currentDepth-1))},$EM.cullingObjects=function($EM,$Ee,$EL,$E_,$Ec){var $Eq,$EH=0,$ET=0,$Ex=0,$EO=this._scene._dynamicBatchManager;for($EH=0,$Eq=this._objects.length;$EH<$Eq;$EH++){var $Eu=this._objects[$EH];if($Ea.isVisible($Eu._owner.layer.mask)&&$Eu.enable){if($Ee&&($EA.treeSpriteCollision+=1,0===$EM.containsBoundSphere($Eu.boundingSphere)))continue;$Eu._renderUpdate($Ec),$Eu._distanceForSort=$EHe.distance($Eu.boundingSphere.center,$E_)+$Eu.sortingFudge;var $EG=$Eu._renderElements;for($ET=0,$Ex=$EG.length;$ET<$Ex;$ET++){var $EV=$EG[$ET],$EE=$EV._staticBatch;if($EE&&$EE._material===$EV._material)$EE._addBatchRenderElement($EV);else{var $Ed=$EV.renderObj;$Ed.triangleCount<10&&1===$Ed._vertexBufferCount&&$Ed._getIndexBuffer()&&$EV._material.renderQueue<2&&$EV._canDynamicBatch&&!$Eu._owner.isStatic?$EO._addPrepareRenderElement($EV):this._scene.getRenderQueue($EV._material.renderQueue)._addRenderElement($EV)}}}}for($EH=0;$EH<8;$EH++){var $Er=this._children[$EH];if(null!=$Er){var $E$=$Ee;if($Ee){var $EC=$EM.containsBoundBox($Er._relaxBox);if($EA.treeNodeCollision+=1,0===$EC)continue;$E$=2===$EC}$Er.cullingObjects($EM,$E$,$EL,$E_,$Ec)}}},$EM.cullingShadowObjects=function($EM,$Ee,$EL,$E_,$Ec){var $Eq,$EH=0,$ET=0,$Ex=0;this._scene._dynamicBatchManager;for($EH=0,$Eq=this._objects.length;$EH<$Eq;$EH++){var $EO=this._objects[$EH];if($EO.castShadow&&$Ea.isVisible($EO._owner.layer.mask)&&$EO.enable){if($EL&&0===$EM[0].containsBoundSphere($EO.boundingSphere))continue;for(var $Eu=1,$EG=$EM.length;$Eu<$EG;$Eu++){var $EV=$Ee[$Eu-1];if(0!==$EM[$Eu].containsBoundSphere($EO.boundingSphere)){var $EE=$EO._renderElements;for($ET=0,$Ex=$EE.length;$ET<$Ex;$ET++)$EV._addRenderElement($EE[$ET])}}}}for($EH=0;$EH<8;$EH++){var $Ed=this._children[$EH];if(null!=$Ed){var $Er=$EL;if($EL){var $E$=$EM[0].containsBoundBox($Ed._relaxBox);if(0===$E$)continue;$Er=2===$E$}$Ed.cullingShadowObjects($EM,$Ee,$Er,$E_,$Ec)}}},$EM.cullingShadowObjectsOnePSSM=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH,$ET=$Ee[0],$Ex=0,$EO=0,$Eu=0;for($Ex=0,$EH=this._objects.length;$Ex<$EH;$Ex++){var $EG=this._objects[$Ex];if($EG.castShadow&&$Ea.isVisible($EG._owner.layer.mask)&&$EG.enable){if($E_&&0===$EM.containsBoundSphere($EG.boundingSphere))continue;$EG._renderUpdate($EL);var $EV=$EG._renderElements;for($EO=0,$Eu=$EV.length;$EO<$Eu;$EO++)$ET._addRenderElement($EV[$EO])}}for($Ex=0;$Ex<8;$Ex++){var $EE=this._children[$Ex];if(null!=$EE){var $Ed=$E_;if($E_){var $Er=$EM.containsBoundBox($EE._relaxBox);if(0===$Er)continue;$Ed=2===$Er}$EE.cullingShadowObjectsOnePSSM($EM,$Ee,$EL,$Ed,$Ec,$Eq)}}},$EM.renderBoudingBox=function($EM){this._renderBoudingBox($EM);for(var $Ee=0;$Ee<8;++$Ee){var $EL=this._children[$Ee];$EL&&$EL.renderBoudingBox($EM)}},$EM.buildAllChild=function($EM){if($EM<this._scene.treeLevel)for(var $Ee=0;$Ee<8;$Ee++){this.addChild($Ee).buildAllChild($EM+1)}},$EM._renderBoudingBox=function($EM){},$Ed(0,$EM,"exactBox",function(){return this._exactBox},function($EM){this._exactBox=$EM,$EHe.add($EM.min,$EM.max,this._boundingBoxCenter),$EHe.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$Ed(0,$EM,"relaxBox",function(){return this._relaxBox},function($EM){(this._relaxBox=$EM).getCorners(this._corners),$EDM.createfromPoints(this._corners,this._boundingSphere)}),$EH.debugMode=!1,$EH.relax=1.15,$EH.CHILDNUM=8,$EG($EH,["tempVector0",function(){return this.tempVector0=new $EHe},"tempSize",function(){return this.tempSize=new $EHe},"tempCenter",function(){return this.tempCenter=new $EHe},"_octreeSplit",function(){return this._octreeSplit=[new $EHe(.25,.25,.25),new $EHe(.75,.25,.25),new $EHe(.25,.75,.25),new $EHe(.75,.75,.25),new $EHe(.25,.25,.75),new $EHe(.75,.25,.75),new $EHe(.25,.75,.75),new $EHe(.75,.75,.75)]}]),$EH}(),$Es=(function(){function $EM(){}$EE($EM,"laya.d3.core.scene.SceneManager")}(),function(){function $EM($EM,$Ee,$EL,$E_){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$EM&&($EM=1),void 0===$Ee&&($Ee=1),void 0===$EL&&($EL=1),void 0===$E_&&($E_=1),this._r=$EM,this._g=$Ee,this._b=$EL,this._a=$E_}return $EE($EM,"laya.d3.core.trail.module.Color",null,"Color$1"),$EM.prototype.cloneTo=function($EM){$EM._r=this._r,$EM._g=this._g,$EM._b=this._b,$EM._a=this._a},$EG($EM,["RED",function(){return this.RED=new $EM(1,0,0,1)},"GREEN",function(){return this.GREEN=new $EM(0,1,0,1)},"BLUE",function(){return this.BLUE=new $EM(0,0,1,1)},"CYAN",function(){return this.CYAN=new $EM(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $EM(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $EM(1,0,1,1)},"GRAY",function(){return this.GRAY=new $EM(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $EM(1,1,1,1)},"BLACK",function(){return this.BLACK=new $EM(0,0,0,1)}]),$EM}()),$ED=(function(){function $EM(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$EE($EM,"laya.d3.core.trail.module.Gradient");var $Ee=$EM.prototype;$Ee.setKeys=function($EM,$Ee){var $EL,$E_;this._colorKeys=$EM;for(var $Ec=this.index=0;$Ec<$EM.length;$Ec++){var $Eq=($EL=$EM[$Ec]).color;this._colorKeyData[this.index++]=$Eq._r,this._colorKeyData[this.index++]=$Eq._g,this._colorKeyData[this.index++]=$Eq._b,this._colorKeyData[this.index++]=$EL.time}this._alphaKeys=$Ee;for(var $EH=this.index=0;$EH<$Ee.length;$EH++)$E_=$Ee[$EH],this._alphaKeyData[this.index++]=$E_.alpha,this._alphaKeyData[this.index++]=$E_.time},$Ee.cloneTo=function($EM){var $Ee=0,$EL=0,$E_=this.colorKeys,$Ec=[];for($Ee=0,$EL=$E_.length;$Ee<$EL;$Ee++){var $Eq=new $EU;$E_[$Ee].cloneTo($Eq),$Ec.push($Eq)}var $EH=this.alphaKeys,$ET=[];for($Ee=0,$EL=$EH.length;$Ee<$EL;$Ee++){var $Ex=new $ED;$EH[$Ee].cloneTo($Ex),$ET.push($Ex)}$EM.setKeys($Ec,$ET)},$Ed(0,$Ee,"mode",function(){return this._mode},function($EM){this._mode=$EM}),$Ed(0,$Ee,"colorKeys",function(){return this._colorKeys},function($EM){this._colorKeys=$EM;for(var $Ee=this.index=0;$Ee<$EM.length;$Ee++){var $EL=$EM[$Ee],$E_=$EL.color;this._colorKeyData[this.index++]=$E_._r,this._colorKeyData[this.index++]=$E_._g,this._colorKeyData[this.index++]=$E_._b,this._colorKeyData[this.index++]=$EL.time}}),$Ed(0,$Ee,"alphaKeys",function(){return this._alphaKeys},function($EM){this._alphaKeys=$EM;for(var $Ee=this.index=0;$Ee<$EM.length;$Ee++){var $EL=$EM[$Ee];this._alphaKeyData[this.index++]=$EL.alpha,this._alphaKeyData[this.index++]=$EL.time}})}(),function(){function $EM($EM,$Ee){this._alpha=NaN,this._time=NaN,void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),this._alpha=$EM,this._time=$Ee}$EE($EM,"laya.d3.core.trail.module.GradientAlphaKey");var $Ee=$EM.prototype;return $Ee.cloneTo=function($EM){$EM.alpha=this.alpha,$EM.time=this.time},$Ed(0,$Ee,"alpha",function(){return this._alpha},function($EM){this._alpha=$EM}),$Ed(0,$Ee,"time",function(){return this._time},function($EM){this._time=$EM}),$EM}()),$EU=function(){function $EM($EM,$Ee){this._color=null,this._time=NaN,void 0===$Ee&&($Ee=0),this._color=$EM||new $Es,this._time=$Ee}$EE($EM,"laya.d3.core.trail.module.GradientColorKey");var $Ee=$EM.prototype;return $Ee.cloneTo=function($EM){this.color.cloneTo($EM.color),$EM.time=this.time},$Ed(0,$Ee,"color",function(){return this._color},function($EM){this._color=$EM}),$Ed(0,$Ee,"time",function(){return this._time},function($EM){this._time=$EM}),$EM}(),$EI=(function(){function $EM(){}$EE($EM,"laya.d3.core.trail.module.GradientMode"),$EM.Blend=0,$EM.Fixed=1}(),function(){function $EM(){}$EE($EM,"laya.d3.core.trail.module.TextureMode"),$EM.Stretch=0,$EM.Tile=1}(),function(){function $EM(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$EE($EM,"laya.d3.core.trail.module.TrailKeyFrame"),$EM.prototype.cloneTo=function($EM){$EM.time=this.time,$EM.inTangent=this.inTangent,$EM.outTangent=this.outTangent,$EM.value=this.value}}(),function(){function $Ee($EM){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $EHe,this._curPosition=new $EHe,this._delVector3=new $EHe,this._lastFixedVertexPosition=new $EHe,this._pointAtoBVector3=new $EHe,this._pointA=new $EHe,this._pointB=new $EHe,this._owner=$EM,this._id=$Ee.renderElementCount++,0==this._id?$EM._owner.transform.position.cloneTo(this._lastPosition):$EM._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $Ege($EI.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $Ege($EI.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$EE($Ee,"laya.d3.core.trail.TrailRenderElement");var $EM=$Ee.prototype;$Ei.imps($EM,{"laya.d3.core.render.IRenderable":!0}),$EM._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$EM._addTrailByFirstPosition=function($EM,$Ee){$EHe.subtract($Ee,$EM,this._delVector3),$EHe.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$EHe.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$EHe.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($EM),$EM.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$EM._addTrailByNextPosition=function($EM){$EHe.subtract($EM,this._lastFixedVertexPosition,this._delVector3),$EHe.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$EHe.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$EHe.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$EHe.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$EUM.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($EM),$EM.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($EM),this._virtualVerticesCount=2)},$EM._updateVerticesByPosition=function($EM){this._pointe=$EM.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$EM._updateVertexBuffer2=function(){var $EM,$Ee=0,$EL=0,$E_=0;for($E_=0,$EM=(this._verticesCount+this._virtualVerticesCount)/2;$E_<$EM;$E_++)$EL=0==this._owner.textureMode?(this._VerticesToTailLength[$E_]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$E_],this._vertices2[$Ee++]=1-$EL,this._vertices2[$Ee++]=1-$EL;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$EM._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$EM._updateDisappear=function(){var $EM,$Ee=0;for($Ee=this._curDisappearIndex,$EM=(this._verticesCount+this._virtualVerticesCount)/2;$Ee<$EM;$Ee++)this._owner._curtime-this._everyGroupVertexBirthTime[$Ee]>=this._owner.time+$EUM.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$EM._beforeRender=function($EM){return this._camera=$EM.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$EHe.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$EM._render=function($EM){this._isDead||($ES.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$EA.drawCall++,$EA.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$EM._getVertexBuffer=function($EM){return void 0===$EM&&($EM=0),0===$EM?this._vertexBuffer1:1===$EM?this._vertexBuffer2:null},$EM._getVertexBuffers=function(){return this._vertexBuffers},$EM._getIndexBuffer=function(){return null},$EM.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$EM._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$Ed(0,$EM,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$Ed(0,$EM,"triangleCount",function(){return 0}),$Ee.renderElementCount=0}(),function(){function $EM(){}$EE($EM,"laya.d3.core.trail.VertexTrail");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration1}),$Ed(1,$EM,"vertexDeclaration1",function(){return $EM._vertexDeclaration1}),$Ed(1,$EM,"vertexDeclaration2",function(){return $EM._vertexDeclaration2}),$EG($EM,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $EqM(32,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",41),new $EHM(24,"single",33),new $EHM(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $EqM(4,[new $EHM(0,"single",38)])}]),$EM}()),$EMM=function(){function $Eo($EM){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$EM}$EE($Eo,"laya.d3.graphics.DynamicBatch");var $EM=$Eo.prototype;return $Ei.imps($EM,{"laya.d3.core.render.IRenderable":!0}),$EM._getVertexBuffer=function($EM){return void 0===$EM&&($EM=0),0===$EM?this._vertexBuffer:null},$EM._getIndexBuffer=function(){return this._indexBuffer},$EM._getCombineRenderElementFromPool=function($EM,$Ee,$EL){var $E_=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $E_||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$E_=new $EP,$E_._sprite3D=new $EZe),$E_._sprite3D._render._renderUpdate($EL),$E_},$EM._getRenderElement=function($EM,$Ee,$EL){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$Eo.maxVertexCount),this._indexDatas=new Uint16Array($Eo.maxIndexCount),this._vertexBuffer=$Ege.create(this._vertexDeclaration,$Eo.maxVertexCount,35048),this._indexBuffer=$EFe.create("ushort",$Eo.maxIndexCount,35048));for(var $E_=this._merageElements.length=0,$Ec=0,$Eq=0,$EH=this._combineRenderElements.length;$Eq<$EH;$Eq++){var $ET=this._combineRenderElements[$Eq],$Ex=$ET.getDynamicBatchBakedVertexs(0),$EO=$ET.getBakedIndices(),$Eu=$ET._sprite3D.transform._isFrontFaceInvert,$EG=$E_/(this._vertexDeclaration.vertexStride/4),$EV=$Ec,$EE=$EV+$EO.length;$ET._tempBatchIndexStart=$EV,$ET._tempBatchIndexEnd=$EE,this._indexDatas.set($EO,$Ec);var $Ed=0;if($Eu)for($Ed=$EV;$Ed<$EE;$Ed+=3){this._indexDatas[$Ed]=$EG+this._indexDatas[$Ed];var $Er=this._indexDatas[$Ed+1],$E$=this._indexDatas[$Ed+2];this._indexDatas[$Ed+1]=$EG+$E$,this._indexDatas[$Ed+2]=$EG+$Er}else for($Ed=$EV;$Ed<$EE;$Ed+=3)this._indexDatas[$Ed]=$EG+this._indexDatas[$Ed],this._indexDatas[$Ed+1]=$EG+this._indexDatas[$Ed+1],this._indexDatas[$Ed+2]=$EG+this._indexDatas[$Ed+2];$Ec+=$EO.length,this._vertexDatas.set($Ex,$E_),$E_+=$Ex.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$Eq=this._combineRenderElementPoolIndex=0,$EH=this._materials.length;$Eq<$EH;$Eq++){var $EC=this._getCombineRenderElementFromPool($EM,$Ee,$EL);$EC._type=2,$EC._staticBatch=null;var $EK=($EC.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$Eq]]._tempBatchIndexStart,$EX=$Eq+1===this._materialToRenderElementsOffsets.length?$Ec:this._combineRenderElements[this._materialToRenderElementsOffsets[$Eq+1]]._tempBatchIndexStart;$EC._tempBatchIndexStart=$EK,$EC._tempBatchIndexEnd=$EX,$EC._material=this._materials[$Eq],this._merageElements.push($EC)}},$EM._addCombineRenderObjTest=function($EM){var $Ee=$EM.renderObj,$EL=this._currentCombineIndexCount+$Ee._getIndexBuffer().indexCount,$E_=this._currentCombineVertexCount+$Ee._getVertexBuffer().vertexCount;return!($Eo.maxVertexCount<$E_||$Eo.maxIndexCount<$EL)},$EM._addCombineRenderObj=function($EM){var $Ee=$EM.renderObj;this._combineRenderElements.push($EM),this._currentCombineIndexCount=this._currentCombineIndexCount+$Ee._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$Ee._getVertexBuffer().vertexCount},$EM._addCombineMaterial=function($EM){this._materials.push($EM)},$EM._addMaterialToRenderElementOffset=function($EM){this._materialToRenderElementsOffsets.push($EM)},$EM._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$EM._addToRenderQueue=function($EM,$Ee,$EL,$E_){this._getRenderElement($Ee,$EL,$E_);for(var $Ec=0,$Eq=this._materials.length;$Ec<$Eq;$Ec++)$EM.getRenderQueue(this._materials[$Ec].renderQueue)._addDynamicBatchElement(this._merageElements[$Ec])},$EM._beforeRender=function($EM){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$EM._render=function($EM){var $Ee=$EM._batchIndexEnd-$EM._batchIndexStart;$ES.mainContext.drawElements(4,$Ee,5123,2*$EM._batchIndexStart),$EA.drawCall++,$EA.trianglesFaces+=$Ee/3},$EM._getVertexBuffers=function(){return null},$Ed(0,$EM,"_vertexBufferCount",function(){return 1}),$Ed(0,$EM,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$Ed(0,$EM,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$Eo.maxVertexCount=2e4,$Eo.maxIndexCount=4e4,$Eo.maxCombineTriangleCount=10,$Eo}(),$EeM=function(){function $Eo(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$EE($Eo,"laya.d3.graphics.DynamicBatchManager");var $EM=$Eo.prototype;return $EM.getDynamicBatch=function($EM,$Ee){var $EL,$E_=$EM.id.toString()+$Ee;return this._dynamicBatches[$E_]?$EL=this._dynamicBatches[$E_]:this._dynamicBatches[$E_]=$EL=new $EMM($EM),$EL},$EM._garbageCollection=function(){for(var $EM in this._dynamicBatches)0===this._dynamicBatches[$EM].combineRenderElementsCount&&delete this._dynamicBatches[$EM]},$EM._addPrepareRenderElement=function($EM){this._prepareDynamicBatchCombineElements.push($EM)},$EM._finishCombineDynamicBatch=function($EM){var $Ee,$EL,$E_;this._prepareDynamicBatchCombineElements.sort($Eo._sortPrepareDynamicBatch);for(var $Ec,$Eq,$EH,$ET,$Ex,$EO=-1,$Eu=!0,$EG=0,$EV=-1,$EE=0,$Ed=this._prepareDynamicBatchCombineElements.length;$EE<$Ed;$EE++){var $Er=($Eq=this._prepareDynamicBatchCombineElements[$EE]).renderObj._getVertexBuffer(0).vertexDeclaration,$E$=$EL!==$Er;$E$&&($EG=0,$EL=$Er);var $EC=$EG!==$EO;if($EC&&($EO=$EG),($E$||$EC)&&($EH=this.getDynamicBatch($Er,$EG),$Ee=null),$Eu)if($EH._addCombineRenderObjTest($Eq)){if($Ee!==($Ec=$Eq._material))$ET&&($EM.getRenderQueue($Ex._material.renderQueue)._addRenderElement($Ex),$Ex=$ET=null,$EV=-1),$ET=$Ec,$EV=$EH.combineRenderElementsCount,$Ex=$Eq,$Ee=$Ec;else if($ET){var $EK=$Ex.renderObj,$EX=$Eq.renderObj;$EK._getVertexBuffer().vertexCount+$EX._getVertexBuffer().vertexCount>$EMM.maxVertexCount||$EK._getIndexBuffer().indexCount+$EX._getIndexBuffer().indexCount>$EMM.maxIndexCount?($EM.getRenderQueue($Ex._material.renderQueue)._addRenderElement($Ex),$ET=$Ec,$EV=$EH.combineRenderElementsCount,$Ex=$Eq):($EH._addCombineMaterial($ET),$EH._addMaterialToRenderElementOffset($EV),$EH._addCombineRenderObj($Ex),$Ex=$ET=null,$EV=-1,$EH._addCombineRenderObj($Eq))}else $EH._addCombineRenderObj($Eq);$Eu=!0}else $ET&&($EM.getRenderQueue($Ex._material.renderQueue)._addRenderElement($Ex),$Ex=$ET=null,$EV=-1),$EG++,$Eu=!1;else $E_=this._prepareDynamicBatchCombineElements[$EE-1],$EH._addMaterialToRenderElementOffset($EH.combineRenderElementsCount),$Ee=$E_._material,$EH._addCombineMaterial($Ee),$EH._addCombineRenderObj($E_),$Eu=!0,$Ee!==($Ec=$Eq._material)?($ET=$Ec,$EV=$EH.combineRenderElementsCount,$Ex=$Eq):$EH._addCombineRenderObj($Eq),$Ee=$Ec}$ET&&($EM.getRenderQueue($Ex._material.renderQueue)._addRenderElement($Ex),$Ex=$ET=null,$EV=-1),this._prepareDynamicBatchCombineElements.length=0},$EM._clearRenderElements=function(){for(var $EM in this._dynamicBatches)this._dynamicBatches[$EM]._clearRenderElements()},$EM._addToRenderQueue=function($EM,$Ee,$EL,$E_){for(var $Ec in this._dynamicBatches){var $Eq=this._dynamicBatches[$Ec];0<$Eq.combineRenderElementsCount&&$Eq._addToRenderQueue($EM,$Ee,$EL,$E_)}},$EM.dispose=function(){this._dynamicBatches=null},$Eo._sortPrepareDynamicBatch=function($EM,$Ee){return $EM._mainSortID-$Ee._mainSortID},$Eo}(),$ELM=function(){function $EM(){}return $EE($EM,"laya.d3.graphics.FrustumCulling"),$EM.renderShadowObjectCulling=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=0,$EH=0,$ET=0,$Ex=0;for($Eq=0,$ET=$EL.length;$Eq<$ET;$Eq++){var $EO=$EL[$Eq];$EO&&$EO._clearRenderElements()}var $Eu,$EG,$EV,$EE=$EM._cullingRenders;if(1<$Ec){for($Eq=0,$ET=$EM._cullingRendersLength;$Eq<$ET;$Eq++)if(($Eu=$EE[$Eq]).castShadow&&$Ea.isVisible($Eu._owner.layer.mask)&&$Eu.enable)for(var $Ed=1,$Er=$Ee.length;$Ed<$Er;$Ed++)if($EG=$EL[$Ed-1],0!==$Ee[$Ed].containsBoundSphere($Eu.boundingSphere))for($EH=0,$Ex=($EV=$Eu._renderElements).length;$EH<$Ex;$EH++)$EG._addRenderElement($EV[$EH])}else for($Eq=0,$ET=$EM._cullingRendersLength;$Eq<$ET;$Eq++)if(($Eu=$EE[$Eq]).castShadow&&$Ea.isVisible($Eu._owner.layer.mask)&&$Eu.enable&&0!==$Ee[0].containsBoundSphere($Eu.boundingSphere))for($Eu._renderUpdate($E_),$EG=$EL[0],$EH=0,$Ex=($EV=$Eu._renderElements).length;$EH<$Ex;$EH++)$EG._addRenderElement($EV[$EH])},$EM.renderShadowObjectCullingOctree=function($EM,$Ee,$EL,$E_,$Ec){for(var $Eq=0,$EH=$EL.length;$Eq<$EH;$Eq++){var $ET=$EL[$Eq];$ET&&$ET._clearRenderElements()}1<$Ec?$EM.treeRoot.cullingShadowObjects($Ee,$EL,!0,0,$EM):$EM.treeRoot.cullingShadowObjectsOnePSSM($Ee[0],$EL,$E_,!0,0,$EM)},$EM.renderObjectCulling=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=0,$ET=0,$Ex=0,$EO=0,$Eu=$Ee._quenes,$EG=$Ee._dynamicBatchManager,$EV=$Ee._cullingRenders;for($EH=0,$ET=$Eu.length;$EH<$ET;$EH++){var $EE=$Eu[$EH];$EE&&$EE._clearRenderElements()}var $Ed=$E_M._staticBatchManagers;for($EH=0,$ET=$Ed.length;$EH<$ET;$EH++)$Ed[$EH]._clearRenderElements();$EG._clearRenderElements();var $Er=$EL.transform.position;for($EH=0,$ET=$Ee._cullingRendersLength;$EH<$ET;$EH++){var $E$=$EV[$EH];if($Ea.isVisible($E$._owner.layer.mask)&&$E$.enable&&0!==$EM.containsBoundSphere($E$.boundingSphere)&&$E$._renderUpdate($Eq)){$E$._distanceForSort=$EHe.distance($E$.boundingSphere.center,$Er)+$E$.sortingFudge;var $EC=$E$._renderElements;for($Ex=0,$EO=$EC.length;$Ex<$EO;$Ex++){var $EK=$EC[$Ex],$EX=$EK._staticBatch;if($EX&&$EX._material===$EK._material)$EX._addBatchRenderElement($EK);else{var $Eo=$EK.renderObj;$Eo.triangleCount<10&&1===$Eo._vertexBufferCount&&$Eo._getIndexBuffer()&&$EK._material.renderQueue<2&&$EK._canDynamicBatch&&!$E$._owner.isStatic?$EG._addPrepareRenderElement($EK):$Ee.getRenderQueue($EK._material.renderQueue)._addRenderElement($EK)}}}}for($EH=0,$ET=$Ed.length;$EH<$ET;$EH++)$Ed[$EH]._addToRenderQueue($Ee,$E_,$Ec,$Eq);$EG._finishCombineDynamicBatch($Ee),$EG._addToRenderQueue($Ee,$E_,$Ec,$Eq)},$EM.renderObjectCullingOctree=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=0,$ET=0,$Ex=$Ee._quenes,$EO=$Ee._dynamicBatchManager;for($EH=0,$ET=$Ex.length;$EH<$ET;$EH++){var $Eu=$Ex[$EH];$Eu&&$Eu._clearRenderElements()}var $EG=$E_M._staticBatchManagers;for($EH=0,$ET=$EG.length;$EH<$ET;$EH++)$EG[$EH]._clearRenderElements();for($EO._clearRenderElements(),$Ee._cullingRenders.length=0,$Ee.treeRoot.cullingObjects($EM,!0,0,$EL.transform.position,$Eq),$EH=0,$ET=$EG.length;$EH<$ET;$EH++)$EG[$EH]._addToRenderQueue($Ee,$E_,$Ec,$Eq);$EO._finishCombineDynamicBatch($Ee),$EO._addToRenderQueue($Ee,$E_,$Ec,$Eq)},$EM.renderObjectCullingNoBoundFrustum=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=0,$EH=0,$ET=0,$Ex=0,$EO=$EM._quenes,$Eu=$EM._dynamicBatchManager,$EG=$EM._cullingRenders;for($Eq=0,$EH=$EO.length;$Eq<$EH;$Eq++){var $EV=$EO[$Eq];$EV&&$EV._clearRenderElements()}var $EE=$E_M._staticBatchManagers;for($Eq=0,$EH=$EE.length;$Eq<$EH;$Eq++)$EE[$Eq]._clearRenderElements();$Eu._clearRenderElements();var $Ed=$Ee.transform.position;for($Eq=0,$EH=$EM._cullingRendersLength;$Eq<$EH;$Eq++){var $Er=$EG[$Eq];if($Ea.isVisible($Er._owner.layer.mask)&&$Er.enable){$Er._renderUpdate($Ec),$Er._distanceForSort=$EHe.distance($Er.boundingSphere.center,$Ed)+$Er.sortingFudge;var $E$=$Er._renderElements;for($ET=0,$Ex=$E$.length;$ET<$Ex;$ET++){var $EC=$E$[$ET],$EK=$EC._staticBatch;if($EK&&$EK._material===$EC._material)$EK._addBatchRenderElement($EC);else{var $EX=$EC.renderObj;$EX.triangleCount<10&&1===$EX._vertexBufferCount&&$EX._getIndexBuffer()&&$EC._material.renderQueue<2&&$EC._canDynamicBatch&&!$Er._owner.isStatic?$Eu._addPrepareRenderElement($EC):$EM.getRenderQueue($EC._material.renderQueue)._addRenderElement($EC)}}}}for($Eq=0,$EH=$EE.length;$Eq<$EH;$Eq++)$EE[$Eq]._addToRenderQueue($EM,$EL,$E_,$Ec);$Eu._finishCombineDynamicBatch($EM),$Eu._addToRenderQueue($EM,$EL,$E_,$Ec)},$EM}(),$E_M=function(){function $Eq(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$EE($Eq,"laya.d3.graphics.StaticBatchManager");var $EM=$Eq.prototype;return $EM._finishInit=function(){for(var $EM in this._staticBatches)this._staticBatches[$EM]._finishInit();this._initBatchRenderElements.length=0},$EM._initStaticBatchs=function($EM){throw new Error("StaticBatchManager:must override this function.")},$EM._addInitBatchSprite=function($EM){for(var $Ee=$EM._render._renderElements,$EL=0,$E_=$Ee.length;$EL<$E_;$EL++)this._initBatchRenderElements.push($Ee[$EL])},$EM._clearRenderElements=function(){for(var $EM in this._staticBatches)this._staticBatches[$EM]._clearRenderElements()},$EM._garbageCollection=function($EM){var $Ee=$EM._staticBatch,$EL=$Ee._initBatchRenderElements,$E_=$EL.indexOf($EM);$EL.splice($E_,1),0===$EL.length&&($Ee.dispose(),delete this._staticBatches[$Ee._key])},$EM._addToRenderQueue=function($EM,$Ee,$EL,$E_){for(var $Ec in this._staticBatches){var $Eq=this._staticBatches[$Ec];0<$Eq._batchRenderElements.length&&$Eq._updateToRenderQueue($EM,$E_)}},$EM.dispose=function(){this._staticBatches=null},$Eq._addToStaticBatchQueue=function($EM){$EM instanceof laya.d3.core.RenderableSprite3D&&$EM._addToInitStaticBatchManager();for(var $Ee=0,$EL=$EM.numChildren;$Ee<$EL;$Ee++)$Eq._addToStaticBatchQueue($EM._childs[$Ee])},$Eq.combine=function($EM,$Ee){var $EL,$E_=0,$Ec=0;if($Ee)for($E_=0,$Ec=$Ee.length;$E_<$Ec;$E_++){$Ee[$E_]._addToInitStaticBatchManager()}else $EM&&$Eq._addToStaticBatchQueue($EM);for($E_=0,$Ec=$Eq._staticBatchManagers.length;$E_<$Ec;$E_++)($EL=$Eq._staticBatchManagers[$E_])._initStaticBatchs($EM),$EL._finishInit()},$Eq._staticBatchManagers=[],$Eq}(),$EcM=function(){function $EM($EM,$Ee,$EL){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$EM,this._manager=$Ee,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$EL}$EE($EM,"laya.d3.graphics.StaticBatch");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$Ee._binarySearch=function($EM){for(var $Ee=0,$EL=this._batchRenderElements.length-1,$E_=0;$Ee<=$EL;)$E_=Math.floor(($Ee+$EL)/2),this._compareBatchRenderElement(this._batchRenderElements[$E_],$EM)?$EL=$E_-1:$Ee=$E_+1;return $Ee},$Ee._compareBatchRenderElement=function($EM,$Ee){throw new Error("StaticBatch:must override this function.")},$Ee._getVertexDecLightMap=function($EM){return $EM===$EFM.vertexDeclaration?$EaM.vertexDeclaration:$EM===$EjM.vertexDeclaration?$ERM.vertexDeclaration:$EM===$EBM.vertexDeclaration?$EoM.vertexDeclaration:$EM===$EbM.vertexDeclaration?null:$EM===$ErM.vertexDeclaration?$E$M.vertexDeclaration:$EM===$EJM.vertexDeclaration?$ElM.vertexDeclaration:$EM===$ESM.vertexDeclaration?$EpM.vertexDeclaration:$EM===$EgM.vertexDeclaration?$EnM.vertexDeclaration:$EM===$EjM.vertexDeclaration?$ERM.vertexDeclaration:$EM===$EkM.vertexDeclaration?$EiM.vertexDeclaration:$EM===$EbM.vertexDeclaration?null:$EM===$ErM.vertexDeclaration?$E$M.vertexDeclaration:$EM===$EwM.vertexDeclaration?$EfM.vertexDeclaration:$EM===$ESM.vertexDeclaration?$EpM.vertexDeclaration:$EM},$Ee._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$Ee._addBatchRenderElement=function($EM){this._batchRenderElements.splice(this._binarySearch($EM),0,$EM)},$Ee._updateToRenderQueue=function($EM,$Ee){this._combineRenderElementPoolIndex=0,this._getRenderElement($EM.getRenderQueue(this._material.renderQueue)._renderElements,$EM,$Ee)},$Ee._getRenderElement=function($EM,$Ee,$EL){throw new Error("StaticBatch:must override this function.")},$Ee._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$Ee._clearRenderElements=function(){this._batchRenderElements.length=0},$Ee.dispose=function(){},$Ee._getVertexBuffer=function($EM){return void 0===$EM&&($EM=0),null},$Ee._getIndexBuffer=function(){return null},$Ee._beforeRender=function($EM){return!0},$Ee._render=function($EM){},$Ee._getVertexBuffers=function(){return null},$Ed(0,$Ee,"_vertexBufferCount",function(){return 1}),$Ed(0,$Ee,"triangleCount",function(){return 0}),$EM.combine=function($EM){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$E_M.combine($EM)},$EM.maxBatchVertexCount=65535,$EM}(),$EqM=function(){function $EH($EM,$Ee){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$EH._uniqueIDCounter,this._id>$EH.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$EH.maxVertexDeclaration);this._shaderValues=new $EVe,this._vertexElementsDic={},this._vertexStride=$EM,this._vertexElements=$Ee;for(var $EL=0;$EL<$Ee.length;$EL++){var $E_=$Ee[$EL],$Ec=$E_.elementUsage;this._vertexElementsDic[$Ec]=$E_;var $Eq=[$EH._getTypeSize($E_.elementFormat)/4,5126,!1,this._vertexStride,$E_.offset];switch(this._shaderValues.setValue($Ec,$Eq),$Ec){case 1:this._addShaderDefine($EAe.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($EAe.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($EAe.SHADERDEFINE_UV1)}}}$EE($EH,"laya.d3.graphics.VertexDeclaration");var $EM=$EH.prototype;return $EM._addShaderDefine=function($EM){this._shaderDefineValue|=$EM},$EM._removeShaderDefine=function($EM){this._shaderDefineValue&=~$EM},$EM.getVertexElements=function(){return this._vertexElements.slice()},$EM.getVertexElementByUsage=function($EM){return this._vertexElementsDic[$EM]},$EM.unBinding=function(){},$Ed(0,$EM,"shaderDefineValue",function(){return this._shaderDefineValue}),$Ed(0,$EM,"id",function(){return this._id}),$Ed(0,$EM,"vertexStride",function(){return this._vertexStride}),$Ed(0,$EM,"shaderValues",function(){return this._shaderValues}),$EH._getTypeSize=function($EM){switch($EM){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$EH.getVertexStride=function($EM){for(var $Ee=0,$EL=0;$EL<$EM.Length;$EL++){var $E_=$EM[$EL],$Ec=$E_.offset+$EH._getTypeSize($E_.elementFormat);$Ee<$Ec&&($Ee=$Ec)}return $Ee},$EH._maxVertexDeclarationBit=1e3,$EH._uniqueIDCounter=1,$EG($EH,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$EH}(),$EHM=function(){function $EM($EM,$Ee,$EL){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$EM,this.elementFormat=$Ee,this.elementUsage=$EL}return $EE($EM,"laya.d3.graphics.VertexElement"),$EM}(),$ETM=(function(){function $EM(){}$EE($EM,"laya.d3.graphics.VertexElementFormat"),$EM.Single="single",$EM.Vector2="vector2",$EM.Vector3="vector3",$EM.Vector4="vector4",$EM.Color="color",$EM.Byte4="byte4",$EM.Short2="short2",$EM.Short4="short4",$EM.NormalizedShort2="normalizedshort2",$EM.NormalizedShort4="normalizedshort4",$EM.HalfVector2="halfvector2",$EM.HalfVector4="halfvector4"}(),function(){function $EM(){}$EE($EM,"laya.d3.graphics.VertexElementUsage"),$EM.POSITION0=0,$EM.COLOR0=1,$EM.TEXTURECOORDINATE0=2,$EM.NORMAL0=3,$EM.BINORMAL0=4,$EM.TANGENT0=5,$EM.BLENDINDICES0=6,$EM.BLENDWEIGHT0=7,$EM.DEPTH0=8,$EM.FOG0=9,$EM.POINTSIZE0=10,$EM.SAMPLE0=11,$EM.TESSELLATEFACTOR0=12,$EM.COLOR1=13,$EM.NEXTTEXTURECOORDINATE0=14,$EM.TEXTURECOORDINATE1=15,$EM.NEXTTEXTURECOORDINATE1=16,$EM.CORNERTEXTURECOORDINATE0=17,$EM.VELOCITY0=18,$EM.STARTCOLOR0=19,$EM.STARTSIZE=20,$EM.AGEADDSCALE0=21,$EM.STARTROTATION=22,$EM.ENDCOLOR0=23,$EM.STARTLIFETIME=24,$EM.TIME0=33,$EM.SHAPEPOSITIONSTARTLIFETIME=30,$EM.DIRECTIONTIME=32,$EM.SIZEROTATION0=27,$EM.RADIUS0=28,$EM.RADIAN0=29,$EM.STARTSPEED=31,$EM.RANDOM0=34,$EM.RANDOM1=35,$EM.SIMULATIONWORLDPOSTION=36,$EM.SIMULATIONWORLDROTATION=37,$EM.TEXTURECOORDINATE0X=38,$EM.TEXTURECOORDINATE0X1=39,$EM.TEXTURECOORDINATE0Y=40,$EM.OFFSETVECTOR=41}(),function(){function $EM($EM,$Ee,$EL){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$EM,this._textureCoordinate0=$Ee,this._time=$EL}$EE($EM,"laya.d3.graphics.VertexGlitter");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"time",function(){return this._time}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(24,[new $EHM(0,"vector3",0),new $EHM(12,"vector2",2),new $EHM(20,"single",33)])}])}(),function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$EM,this._position=$Ee,this._velocity=$EL,this._startColor=$E_,this._endColor=$Ec,this._sizeRotation=$Eq,this._radius=$EH,this._radian=$ET,this._ageAddScale=$Ex,this._time=$EO}$EE($EM,"laya.d3.graphics.VertexParticle");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"endColor",function(){return this._endColor}),$Ed(0,$Ee,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$Ed(0,$Ee,"sizeRotation",function(){return this._sizeRotation}),$Ed(0,$Ee,"velocity",function(){return this._velocity}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"startColor",function(){return this._startColor}),$Ed(0,$Ee,"radius",function(){return this._radius}),$Ed(0,$Ee,"radian",function(){return this._radian}),$Ed(0,$Ee,"ageAddScale",function(){return this._ageAddScale}),$Ed(0,$Ee,"time",function(){return this._time}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(116,[new $EHM(0,"vector4",17),new $EHM(16,"vector3",0),new $EHM(28,"vector3",18),new $EHM(40,"vector4",19),new $EHM(56,"vector4",23),new $EHM(72,"vector3",27),new $EHM(84,"vector2",28),new $EHM(92,"vector4",29),new $EHM(108,"single",24),new $EHM(112,"single",33)])}])}(),function(){function $EM($EM){this._position=null,this._position=$EM}$EE($EM,"laya.d3.graphics.VertexPosition");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(12,[new $EHM(0,"vector3",0)])}]),$EM}()),$ExM=function(){function $EM($EM,$Ee){this._position=null,this._normal=null,this._position=$EM,this._normal=$Ee}$EE($EM,"laya.d3.graphics.VertexPositionNormal");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(24,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3)])}]),$EM}(),$EOM=function(){function $EM($EM,$Ee,$EL){this._position=null,this._normal=null,this._color=null,this._position=$EM,this._normal=$Ee,this._color=$EL}$EE($EM,"laya.d3.graphics.VertexPositionNormalColor");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(40,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1)])}]),$EM}(),$EuM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._blendIndex=$E_,this._blendWeight=$Ec}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorSkin");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(72,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector4",7),new $EHM(56,"vector4",6)])}]),$EM}(),$EGM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._tangent=$E_,this._blendIndex=$Ec,this._blendWeight=$Eq}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(88,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector4",7),new $EHM(56,"vector4",6),new $EHM(72,"vector4",5)])}]),$EM}(),$EVM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._tangent=$E_,this._blendIndex=$Ec,this._blendWeight=$Eq}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(84,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector4",7),new $EHM(56,"vector4",6),new $EHM(72,"vector3",5)])}]),$EM}(),$EEM=function(){function $EM($EM,$Ee,$EL,$E_){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._tangent=$E_}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(56,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector4",5)])}]),$EM}(),$EdM=function(){function $EM($EM,$Ee,$EL,$E_){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._tangent=$E_}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(52,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector3",5)])}]),$EM}(),$ErM=function(){function $EM($EM,$Ee,$EL,$E_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate=$E_}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTexture");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(48,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2)])}]),$EM}(),$E$M=function(){function $EM($EM,$Ee,$EL,$E_,$Ec){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate0=$E_,this._textureCoordinate1=$Ec}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(56,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector2",15)])}]),$EM}(),$ECM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate0=$E_,this._textureCoordinate1=$Ec,this._blendIndex=$Eq,this._blendWeight=$EH}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(88,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector2",15),new $EHM(56,"vector4",7),new $EHM(72,"vector4",6)])}]),$EM}(),$EKM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate0=$E_,this._textureCoordinate1=$Ec,this._tangent=$Eq,this._blendIndex=$EH,this._blendWeight=$ET}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(104,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector2",15),new $EHM(56,"vector4",7),new $EHM(72,"vector4",6),new $EHM(88,"vector4",5)])}]),$EM}(),$EXM=function(){function $EM(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ee.VertexPositionNormalColorTexture0SkinTangent=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate0=$E_,this._textureCoordinate1=$Ec,this._tangent=$Eq,this._blendIndex=$EH,this._blendWeight=$ET},$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(100,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector2",15),new $EHM(56,"vector4",7),new $EHM(72,"vector4",6),new $EHM(88,"vector3",5)])}]),$EM}(),$EoM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate0=$E_,this._textureCoordinate1=$Ec,this._tangent=$Eq}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(72,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector2",15),new $EHM(56,"vector4",5)])}]),$EM}(),$EiM=function(){function $EM(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ee.VertexPositionNormalColorTexture0Tangent=function($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate0=$E_,this._textureCoordinate1=$Ec,this._tangent=$Eq},$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(68,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector2",15),new $EHM(56,"vector3",5)])}]),$EM}(),$EWM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate=$E_,this._blendIndex=$Ec,this._blendWeight=$Eq}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(80,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector4",7),new $EHM(64,"vector4",6)])}]),$EM}(),$EyM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate=$E_,this._tangent=$Ec,this._blendIndex=$Eq,this._blendWeight=$EH}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(96,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector4",7),new $EHM(64,"vector4",6),new $EHM(80,"vector4",5)])}]),$EM}(),$EAM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate=$E_,this._tangent=$Ec,this._blendIndex=$Eq,this._blendWeight=$EH}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(92,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector4",7),new $EHM(64,"vector4",6),new $EHM(80,"vector3",5)])}]),$EM}(),$EBM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate=$E_,this._tangent=$Ec}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(64,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector4",5)])}]),$EM}(),$EkM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._color=$EL,this._textureCoordinate=$E_,this._tangent=$Ec}$EE($EM,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"color",function(){return this._color}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(60,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",1),new $EHM(40,"vector2",2),new $EHM(48,"vector3",5)])}]),$EM}(),$EhM=function(){function $EM($EM,$Ee,$EL){this._position=null,this._normal=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._tangent=$EL}$EE($EM,"laya.d3.graphics.VertexPositionNormalSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(40,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector4",5)])}]),$EM}(),$EtM=function(){function $EM($EM,$Ee,$EL){this._position=null,this._normal=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._tangent=$EL}$EE($EM,"laya.d3.graphics.VertexPositionNormalTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(36,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector3",5)])}]),$EM}(),$ESM=function(){function $EM($EM,$Ee,$EL){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL}$EE($EM,"laya.d3.graphics.VertexPositionNormalTexture");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(32,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2)])}]),$EM}(),$EpM=function(){function $EM($EM,$Ee,$EL,$E_){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate0=$EL,this._textureCoordinate1=$E_}$EE($EM,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(40,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector2",15)])}]),$EM}(),$ERM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate0=$EL,this._textureCoordinate1=$E_,this._blendIndex=$Ec,this._blendWeight=$Eq}$EE($EM,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(72,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector2",15),new $EHM(40,"vector4",7),new $EHM(56,"vector4",6)])}]),$EM}(),$EaM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate0=$EL,this._textureCoordinate1=$E_,this._tangent=$Ec,this._blendIndex=$Eq,this._blendWeight=$EH}$EE($EM,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(88,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector2",15),new $EHM(40,"vector4",7),new $EHM(56,"vector4",6),new $EHM(72,"vector4",5)])}]),$EM}(),$EnM=function(){function $EM(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$EE($EM,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ee.VertexPositionNormalTexture0SkinTangent=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){this._position=$EM,this._normal=$Ee,this._textureCoordinate0=$EL,this._textureCoordinate1=$E_,this._tangent=$Ec,this._blendIndex=$Eq,this._blendWeight=$EH},$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(84,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector2",15),new $EHM(40,"vector4",7),new $EHM(56,"vector4",6),new $EHM(72,"vector3",5)])}]),$EM}(),$ElM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate0=$EL,this._textureCoordinate1=$E_,this._tangent=$Ec}$EE($EM,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(56,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector2",15),new $EHM(40,"vector4",5)])}]),$EM}(),$EfM=function(){function $EM(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$EE($EM,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ee.VertexPositionNormalTexture0Tangent=function($EM,$Ee,$EL,$E_,$Ec){this._position=$EM,this._normal=$Ee,this._textureCoordinate0=$EL,this._textureCoordinate1=$E_,this._tangent=$Ec},$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(52,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector2",15),new $EHM(40,"vector3",5)])}]),$EM}(),$EjM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL,this._blendIndex=$E_,this._blendWeight=$Ec}$EE($EM,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(64,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector4",7),new $EHM(48,"vector4",6)])}]),$EM}(),$EFM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL,this._tangent=$E_,this._blendIndex=$Ec,this._blendWeight=$Eq}$EE($EM,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(80,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector4",7),new $EHM(48,"vector4",6),new $EHM(64,"vector4",5)])}]),$EM}(),$EgM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL,this._tangent=$E_,this._blendIndex=$Ec,this._blendWeight=$Eq}$EE($EM,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(76,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector4",7),new $EHM(48,"vector4",6),new $EHM(64,"vector3",5)])}]),$EM}(),$EJM=function(){function $EM($EM,$Ee,$EL,$E_){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL,this._tangent=$E_}$EE($EM,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(48,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector4",5)])}]),$EM}(),$EwM=function(){function $EM($EM,$Ee,$EL,$E_){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL,this._tangent=$E_}$EE($EM,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(44,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector3",5)])}]),$EM}(),$EbM=function(){function $EM($EM,$Ee,$EL){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL}$EE($EM,"laya.d3.graphics.VertexPositionNTBTexture");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(56,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector3",5),new $EHM(36,"vector3",4),new $EHM(48,"vector2",2)])}]),$EM}(),$EmM=function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate0=$E_,this._textureCoordinate1=$Ec,this._tangent=$Eq,$EL=$EL,this._blendIndex=$EH,this._blendWeight=$ET}$EE($EM,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"tangent",function(){return this._tangent}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(0,$Ee,"textureCoordinate1",function(){return this._textureCoordinate1}),$Ed(0,$Ee,"blendIndex",function(){return this._blendIndex}),$Ed(0,$Ee,"blendWeight",function(){return this._blendWeight}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(96,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector3",5),new $EHM(36,"vector3",4),new $EHM(48,"vector2",2),new $EHM(56,"vector2",15),new $EHM(64,"vector4",7),new $EHM(80,"vector4",6)])}]),$EM}(),$EzM=function(){function $EM($EM,$Ee,$EL){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$EM,this._normal=$Ee,this._textureCoordinate=$EL}$EE($EM,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"textureCoordinate",function(){return this._textureCoordinate}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(88,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector3",5),new $EHM(36,"vector3",4),new $EHM(48,"vector2",2),new $EHM(56,"vector4",7),new $EHM(72,"vector4",6)])}]),$EM}(),$EQM=(function(){function $EM($EM,$Ee,$EL,$E_){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$EM,this._normal=$Ee,this._textureCoord0=$EL,this._textureCoord1=$E_}$EE($EM,"laya.d3.graphics.VertexPositionTerrain");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"normal",function(){return this._normal}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoord0",function(){return this._textureCoord0}),$Ed(0,$Ee,"textureCoord1",function(){return this._textureCoord1}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(40,[new $EHM(0,"vector3",0),new $EHM(12,"vector3",3),new $EHM(24,"vector2",2),new $EHM(32,"vector2",15)])}])}(),function(){function $EM($EM,$Ee){this._position=null,this._textureCoordinate0=null,this._position=$EM,this._textureCoordinate0=$Ee}$EE($EM,"laya.d3.graphics.VertexPositionTexture0");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"position",function(){return this._position}),$Ed(0,$Ee,"textureCoordinate0",function(){return this._textureCoordinate0}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(20,[new $EHM(0,"vector3",0),new $EHM(12,"vector2",2)])}]),$EM}()),$EYM=(function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG,$EV,$EE){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$EM,this._positionStartLifeTime=$Ee,this._velocity=$EL,this._startColor=$E_,this._startSize=$Ec,this._startRotation0=$Eq,this._startRotation1=$EH,this._startRotation2=$ET,this._startLifeTime=$Ex,this._time=$EO,this._startSpeed=$Eu,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$EE}$EE($EM,"laya.d3.graphics.VertexShurikenParticleBillboard");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$Ed(0,$Ee,"random1",function(){return this._randoms1}),$Ed(0,$Ee,"startRotation2",function(){return this._startRotation2}),$Ed(0,$Ee,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$Ed(0,$Ee,"velocity",function(){return this._velocity}),$Ed(0,$Ee,"random0",function(){return this._randoms0}),$Ed(0,$Ee,"startSize",function(){return this._startSize}),$Ed(0,$Ee,"startColor",function(){return this._startColor}),$Ed(0,$Ee,"startRotation0",function(){return this._startRotation0}),$Ed(0,$Ee,"startRotation1",function(){return this._startRotation1}),$Ed(0,$Ee,"startLifeTime",function(){return this._startLifeTime}),$Ed(0,$Ee,"time",function(){return this._time}),$Ed(0,$Ee,"startSpeed",function(){return this._startSpeed}),$Ed(0,$Ee,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(152,[new $EHM(0,"vector4",17),new $EHM(16,"vector4",30),new $EHM(32,"vector4",32),new $EHM(48,"vector4",19),new $EHM(64,"vector3",20),new $EHM(76,"vector3",22),new $EHM(88,"single",31),new $EHM(92,"vector4",34),new $EHM(108,"vector4",35),new $EHM(124,"vector3",36),new $EHM(136,"vector4",37)])}])}(),function(){function $EM($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG,$EV,$EE){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$EM,this._positionStartLifeTime=$Ee,this._velocity=$EL,this._startColor=$E_,this._startSize=$Ec,this._startRotation0=$Eq,this._startRotation1=$EH,this._startRotation2=$ET,this._startLifeTime=$Ex,this._time=$EO,this._startSpeed=$Eu,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$EE}$EE($EM,"laya.d3.graphics.VertexShurikenParticleMesh");var $Ee=$EM.prototype;$Ei.imps($Ee,{"laya.d3.graphics.IVertex":!0}),$Ed(0,$Ee,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$Ed(0,$Ee,"velocity",function(){return this._velocity}),$Ed(0,$Ee,"position",function(){return this._positionStartLifeTime}),$Ed(0,$Ee,"random0",function(){return this._randoms0}),$Ed(0,$Ee,"startSize",function(){return this._startSize}),$Ed(0,$Ee,"startColor",function(){return this._startColor}),$Ed(0,$Ee,"startRotation0",function(){return this._startRotation0}),$Ed(0,$Ee,"startRotation1",function(){return this._startRotation1}),$Ed(0,$Ee,"random1",function(){return this._randoms1}),$Ed(0,$Ee,"startRotation2",function(){return this._startRotation2}),$Ed(0,$Ee,"startLifeTime",function(){return this._startLifeTime}),$Ed(0,$Ee,"time",function(){return this._time}),$Ed(0,$Ee,"startSpeed",function(){return this._startSpeed}),$Ed(0,$Ee,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$Ed(0,$Ee,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$Ed(1,$EM,"vertexDeclaration",function(){return $EM._vertexDeclaration}),$EG($EM,["_vertexDeclaration",function(){return this._vertexDeclaration=new $EqM(172,[new $EHM(0,"vector3",0),new $EHM(12,"vector4",1),new $EHM(28,"vector2",2),new $EHM(36,"vector4",30),new $EHM(52,"vector4",32),new $EHM(68,"vector4",19),new $EHM(84,"vector3",20),new $EHM(96,"vector3",22),new $EHM(108,"single",31),new $EHM(112,"vector4",34),new $EHM(128,"vector4",35),new $EHM(144,"vector3",36),new $EHM(156,"vector4",37)])}])}(),function(){function $EX($EM,$Ee,$EL,$E_,$Ec,$Eq){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$EL,this._materials=$E_,this._subMeshes=$Ec,this._materialMap=$Eq,this._version=$Ee,this._onLoaded($EM)}$EE($EX,"laya.d3.loaders.LoadModelV01");var $EM=$EX.prototype;return $EM._onLoaded=function($EM){this._readData=$EM,this.READ_BLOCK();for(var $Ee=0;$Ee<this._BLOCK.count;$Ee++){var $EL=this._readData.getUint16(),$E_=this._strings[$EL],$Ec=this["READ_"+$E_];if(null==$Ec)throw new Error("model file err,no this function:"+$EL+" "+$E_);if(!$Ec.call(this))break}return this._mesh},$EM.onError=function(){},$EM._readString=function(){return this._strings[this._readData.getUint16()]},$EM.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$EM.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$EM.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $EM=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $Ee=0;$Ee<this._STRINGS.size;$Ee++)this._strings[$Ee]=this._readData.readUTFString();return this._readData.pos=$EM,!0},$EM.READ_MATERIAL=function(){var $EM=this._readData.getUint16(),$Ee=(this._readString(),this._readString());return this._materials[$EM]="null"!==$Ee?$EC.getRes(this._materialMap[$Ee]):new $Ete,!0},$EM.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $EM,$Ee=this._readData.__getBuffer(),$EL=0,$E_=this._readData.getUint32(),$Ec=this._readData.getUint32(),$Eq=(new Float32Array($Ee.slice($E_+this._DATA.offset,$E_+this._DATA.offset+$Ec)),this._readData.getUint32()),$EH=this._readData.getUint32(),$ET=new Float32Array($Ee.slice($Eq+this._DATA.offset,$Eq+this._DATA.offset+$EH));for(this.mesh._inverseBindPoses=[],$EL=0,$EM=$ET.length;$EL<$EM;$EL+=16){var $Ex=new $EMe($ET[$EL+0],$ET[$EL+1],$ET[$EL+2],$ET[$EL+3],$ET[$EL+4],$ET[$EL+5],$ET[$EL+6],$ET[$EL+7],$ET[$EL+8],$ET[$EL+9],$ET[$EL+10],$ET[$EL+11],$ET[$EL+12],$ET[$EL+13],$ET[$EL+14],$ET[$EL+15]);this.mesh._inverseBindPoses.push($Ex)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$EM.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $EM=this._readString();this._shaderAttributes=$EM.match($EX._attrReg);var $Ee=this._readData.getUint32(),$EL=this._readData.getUint32(),$E_=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$Ec=this._readData.getUint32(),$Eq=this._readData.getUint32(),$EH=this._readData.getUint32(),$ET=this._readData.__getBuffer(),$Ex=new $EOe(this._mesh),$EO=this._getVertexDeclaration(),$Eu=$Ege.create($EO,$Ec/$EO.vertexStride,35044,!0),$EG=$E_+this._DATA.offset,$EV=$ET.slice($EG,$EG+$Ec);$Eu.setData(new Float32Array($EV));for(var $EE=($Ex._vertexBuffer=$Eu).vertexDeclaration.getVertexElements(),$Ed=0;$Ed<$EE.length;$Ed++)$Ex._bufferUsage[$EE[$Ed].elementUsage]=$Eu;var $Er=$EFe.create("ushort",$EL/2,35044,!0),$E$=$Ee+this._DATA.offset,$EC=$ET.slice($E$,$E$+$EL);$Er.setData(new Uint16Array($EC)),$Ex._indexBuffer=$Er;var $EK=$ET.slice($Eq+this._DATA.offset,$Eq+this._DATA.offset+$EH);return $Ex._boneIndicesList[0]=new Uint8Array($EK),this._subMeshes.push($Ex),!0},$EM.READ_DATAAREA=function(){return!1},$EM._getVertexDeclaration=function(){for(var $EM,$Ee=!1,$EL=!1,$E_=!1,$Ec=!1,$Eq=!1,$EH=!1,$ET=!1,$Ex=!1,$EO=!1,$Eu=0;$Eu<this._shaderAttributes.length;$Eu+=8)switch(this._shaderAttributes[$Eu]){case"POSITION":$Ee=!0;break;case"NORMAL":$EL=!0;break;case"COLOR":$E_=!0;break;case"UV":$Ec=!0;break;case"UV1":$Eq=!0;break;case"BLENDWEIGHT":$ET=!0;break;case"BLENDINDICES":$Ex=!0;break;case"TANGENT":$EH=!0;break;case"BINORMAL":$EO=!0}return $Ee&&$EL&&$E_&&$Ec&&$Eq&&$ET&&$Ex&&$EH?$EM=$EXM.vertexDeclaration:$Ee&&$EL&&$E_&&$Ec&&$Eq&&$ET&&$Ex?$EM=$ECM.vertexDeclaration:$Ee&&$EL&&$Ec&&$Eq&&$ET&&$Ex&&$EH?$EM=$EnM.vertexDeclaration:$Ee&&$EL&&$Ec&&$Eq&&$ET&&$Ex?$EM=$ERM.vertexDeclaration:$Ee&&$EL&&$E_&&$Ec&&$ET&&$Ex&&$EH?$EM=$EAM.vertexDeclaration:$Ee&&$EL&&$E_&&$Ec&&$ET&&$Ex?$EM=$EWM.vertexDeclaration:$Ee&&$EL&&$EH&&$EO&&$Ec&&$ET&&$Ex?$EM=$EzM.vertexDeclaration:$Ee&&$EL&&$Ec&&$ET&&$Ex&&$EH?$EM=$EgM.vertexDeclaration:$Ee&&$EL&&$Ec&&$ET&&$Ex?$EM=$EjM.vertexDeclaration:$Ee&&$EL&&$E_&&$ET&&$Ex&&$EH?$EM=$EVM.vertexDeclaration:$Ee&&$EL&&$E_&&$ET&&$Ex?$EM=$EuM.vertexDeclaration:$Ee&&$EL&&$E_&&$Ec&&$Eq&&$EH?$EM=$EiM.vertexDeclaration:$Ee&&$EL&&$E_&&$Ec&&$Eq?$EM=$E$M.vertexDeclaration:$Ee&&$EL&&$Ec&&$Eq&&$EH?$EM=$EfM.vertexDeclaration:$Ee&&$EL&&$Ec&&$Eq?$EM=$EpM.vertexDeclaration:$Ee&&$EL&&$E_&&$Ec&&$EH?$EM=$EkM.vertexDeclaration:$Ee&&$EL&&$Ec&&$EH&&$EO?$EM=$EbM.vertexDeclaration:$Ee&&$EL&&$E_&&$Ec?$EM=$ErM.vertexDeclaration:$Ee&&$EL&&$Ec&&$EH?$EM=$EwM.vertexDeclaration:$Ee&&$EL&&$Ec?$EM=$ESM.vertexDeclaration:$Ee&&$EL&&$E_&&$EH?$EM=$EdM.vertexDeclaration:$Ee&&$EL&&$E_&&($EM=$EOM.vertexDeclaration),$EM},$Ed(0,$EM,"mesh",function(){return this._mesh}),$EX._attrReg=new RegExp("(\\w+)|([:,;])","g"),$EX}()),$EPM=function(){function $Ey(){}return $EE($Ey,"laya.d3.loaders.LoadModelV02"),$Ey.parse=function($EM,$Ee,$EL,$E_,$Ec,$Eq){$Ey._mesh=$EL,$Ey._materials=$E_,$Ey._subMeshes=$Ec,$Ey._materialMap=$Eq,$Ey._version=$Ee,$Ey._readData=$EM,$Ey.READ_DATA(),$Ey.READ_BLOCK(),$Ey.READ_STRINGS();for(var $EH=0,$ET=$Ey._BLOCK.count;$EH<$ET;$EH++){$Ey._readData.pos=$Ey._BLOCK.blockStarts[$EH];var $Ex=$Ey._readData.getUint16(),$EO=$Ey._strings[$Ex],$Eu=$Ey["READ_"+$EO];if(null==$Eu)throw new Error("model file err,no this function:"+$Ex+" "+$EO);$Eu.call()}$Ey._strings.length=0,$Ey._readData=null,$Ey._version=null,$Ey._mesh=null,$Ey._materials=null,$Ey._subMeshes=null,$Ey._materialMap=null},$Ey._readString=function(){return $Ey._strings[$Ey._readData.getUint16()]},$Ey.READ_DATA=function(){$Ey._DATA.offset=$Ey._readData.getUint32(),$Ey._DATA.size=$Ey._readData.getUint32()},$Ey.READ_BLOCK=function(){for(var $EM=$Ey._BLOCK.count=$Ey._readData.getUint16(),$Ee=$Ey._BLOCK.blockStarts=[],$EL=$Ey._BLOCK.blockLengths=[],$E_=0;$E_<$EM;$E_++)$Ee.push($Ey._readData.getUint32()),$EL.push($Ey._readData.getUint32())},$Ey.READ_STRINGS=function(){var $EM=$Ey._readData.getUint32(),$Ee=$Ey._readData.getUint16(),$EL=$Ey._readData.pos;$Ey._readData.pos=$EM+$Ey._DATA.offset;for(var $E_=0;$E_<$Ee;$E_++)$Ey._strings[$E_]=$Ey._readData.readUTFString();$Ey._readData.pos=$EL},$Ey.READ_MATERIAL=function(){$Ey._readString(),$Ey._readString();var $EM=$Ey._readString();return""!==$EM&&$Ey._materials.push($EC.getRes($Ey._materialMap[$EM])),!0},$Ey.READ_MESH=function(){$Ey._readString();var $EM,$Ee=$Ey._readData.__getBuffer(),$EL=0,$E_=$Ey._readData.getInt16(),$Ec=$Ey._DATA.offset;for($EL=0;$EL<$E_;$EL++){var $Eq=$Ec+$Ey._readData.getUint32(),$EH=$Ey._readData.getUint32(),$ET=new Float32Array($Ee.slice($Eq,$Eq+$EH)),$Ex=$Ey._readString().match($Ey._attrReg),$EO=$Ey._getVertexDeclaration($Ex),$Eu=$Ege.create($EO,4*$ET.length/$EO.vertexStride,35044,!0);$Eu.setData($ET),$Ey._mesh._vertexBuffers.push($Eu)}var $EG=$Ec+$Ey._readData.getUint32(),$EV=$Ey._readData.getUint32(),$EE=new Uint16Array($Ee.slice($EG,$EG+$EV)),$Ed=$EFe.create("ushort",$EV/2,35044,!0);$Ed.setData($EE),$Ey._mesh._indexBuffer=$Ed;var $Er=$Ey._mesh._boneNames=[],$E$=$Ey._readData.getUint16();for($Er.length=$E$,$EL=0;$EL<$E$;$EL++)$Er[$EL]=$Ey._strings[$Ey._readData.getUint16()];var $EC=$Ey._readData.getUint32(),$EK=$Ey._readData.getUint32(),$EX=(new Float32Array($Ee.slice($Ec+$EC,$Ec+$EC+$EK)),$Ey._readData.getUint32()),$Eo=$Ey._readData.getUint32(),$Ei=new Float32Array($Ee.slice($Ec+$EX,$Ec+$EX+$Eo));for($Ey._mesh._inverseBindPoses=[],$EL=0,$EM=$Ei.length;$EL<$EM;$EL+=16){var $EW=new $EMe($Ei[$EL+0],$Ei[$EL+1],$Ei[$EL+2],$Ei[$EL+3],$Ei[$EL+4],$Ei[$EL+5],$Ei[$EL+6],$Ei[$EL+7],$Ei[$EL+8],$Ei[$EL+9],$Ei[$EL+10],$Ei[$EL+11],$Ei[$EL+12],$Ei[$EL+13],$Ei[$EL+14],$Ei[$EL+15]);$Ey._mesh._inverseBindPoses.push($EW)}return $Ey._mesh._skinnedDatas=new Float32Array(16*$Ei.length),!0},$Ey.READ_SUBMESH=function(){var $EM=$Ey._readData.__getBuffer(),$Ee=new $EOe($Ey._mesh),$EL=$Ey._readData.getInt16(),$E_=$Ey._readData.getUint32(),$Ec=$Ey._readData.getUint32();$Ee._vertexBuffer=$Ey._mesh._vertexBuffers[$EL],$Ee._vertexStart=$E_,$Ee._vertexCount=$Ec;var $Eq=$Ey._readData.getUint32(),$EH=$Ey._readData.getUint32(),$ET=$Ey._mesh._indexBuffer;$Ee._indexBuffer=$ET,$Ee._indexStart=$Eq,$Ee._indexCount=$EH,$Ee._indices=new Uint16Array($ET.getData().buffer,2*$Eq,$EH);var $Ex=$Ey._DATA.offset,$EO=$Ee._subIndexBufferStart,$Eu=$Ee._subIndexBufferCount,$EG=$Ee._boneIndicesList,$EV=$Ey._readData.getUint16();$EO.length=$EV,$Eu.length=$EV,$EG.length=$EV;for(var $EE=0;$EE<$EV;$EE++){$EO[$EE]=$Ey._readData.getUint32(),$Eu[$EE]=$Ey._readData.getUint32();var $Ed=$Ey._readData.getUint32(),$Er=$Ey._readData.getUint32();$Ee._boneIndicesList[$EE]=new Uint8Array($EM.slice($Ex+$Ed,$Ex+$Ed+$Er))}return $Ey._subMeshes.push($Ee),!0},$Ey._getVertexDeclaration=function($EM){for(var $Ee,$EL=!1,$E_=!1,$Ec=!1,$Eq=!1,$EH=!1,$ET=!1,$Ex=!1,$EO=!1,$Eu=!1,$EG=0;$EG<$EM.length;$EG++)switch($EM[$EG]){case"POSITION":$EL=!0;break;case"NORMAL":$E_=!0;break;case"COLOR":$Ec=!0;break;case"UV":$Eq=!0;break;case"UV1":$EH=!0;break;case"BLENDWEIGHT":$Ex=!0;break;case"BLENDINDICES":$EO=!0;break;case"TANGENT":$ET=!0;break;case"BINORMAL":$Eu=!0}return $EL&&$E_&&$Ec&&$Eq&&$EH&&$Ex&&$EO&&$ET?$Ee=$EXM.vertexDeclaration:$EL&&$E_&&$Ec&&$Eq&&$EH&&$Ex&&$EO?$Ee=$ECM.vertexDeclaration:$EL&&$E_&&$Eq&&$EH&&$Ex&&$EO&&$ET?$Ee=$EnM.vertexDeclaration:$EL&&$E_&&$Eq&&$EH&&$Ex&&$EO?$Ee=$ERM.vertexDeclaration:$EL&&$E_&&$Ec&&$Eq&&$Ex&&$EO&&$ET?$Ee=$EAM.vertexDeclaration:$EL&&$E_&&$Ec&&$Eq&&$Ex&&$EO?$Ee=$EWM.vertexDeclaration:$EL&&$E_&&$Eq&&$Ex&&$EO&&$ET?$Ee=$EgM.vertexDeclaration:$EL&&$E_&&$Eq&&$Ex&&$EO?$Ee=$EjM.vertexDeclaration:$EL&&$E_&&$Ec&&$Ex&&$EO&&$ET?$Ee=$EVM.vertexDeclaration:$EL&&$E_&&$Ec&&$Ex&&$EO?$Ee=$EuM.vertexDeclaration:$EL&&$E_&&$Ec&&$Eq&&$EH&&$ET?$Ee=$EiM.vertexDeclaration:$EL&&$E_&&$Ec&&$Eq&&$EH?$Ee=$E$M.vertexDeclaration:$EL&&$E_&&$Eq&&$EH&&$ET?$Ee=$EfM.vertexDeclaration:$EL&&$E_&&$Eq&&$EH?$Ee=$EpM.vertexDeclaration:$EL&&$E_&&$Ec&&$Eq&&$ET?$Ee=$EkM.vertexDeclaration:$EL&&$E_&&$Eq&&$ET&&$Eu?$Ee=$EbM.vertexDeclaration:$EL&&$E_&&$Ec&&$Eq?$Ee=$ErM.vertexDeclaration:$EL&&$E_&&$Eq&&$ET?$Ee=$EwM.vertexDeclaration:$EL&&$E_&&$Eq?$Ee=$ESM.vertexDeclaration:$EL&&$E_&&$Ec&&$ET?$Ee=$EdM.vertexDeclaration:$EL&&$E_&&$Ec&&($Ee=$EOM.vertexDeclaration),$Ee},$Ey._attrReg=new RegExp("(\\w+)|([:,;])","g"),$Ey._strings=[],$Ey._readData=null,$Ey._version=null,$Ey._mesh=null,$Ey._materials=null,$Ey._subMeshes=null,$Ey._materialMap=null,$EG($Ey,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$Ey}(),$EZM=function(){function $EW(){}return $EE($EW,"laya.d3.loaders.LoadModelV03"),$EW.parse=function($EM,$Ee,$EL,$E_,$Ec){$EW._mesh=$EL,$EW._subMeshes=$E_,$EW._materialMap=$Ec,$EW._version=$Ee,$EW._readData=$EM,$EW.READ_DATA(),$EW.READ_BLOCK(),$EW.READ_STRINGS();for(var $Eq=0,$EH=$EW._BLOCK.count;$Eq<$EH;$Eq++){$EW._readData.pos=$EW._BLOCK.blockStarts[$Eq];var $ET=$EW._readData.getUint16(),$Ex=$EW._strings[$ET],$EO=$EW["READ_"+$Ex];if(null==$EO)throw new Error("model file err,no this function:"+$ET+" "+$Ex);$EO.call()}$EW._strings.length=0,$EW._readData=null,$EW._version=null,$EW._mesh=null,$EW._subMeshes=null,$EW._materialMap=null},$EW._readString=function(){return $EW._strings[$EW._readData.getUint16()]},$EW.READ_DATA=function(){$EW._DATA.offset=$EW._readData.getUint32(),$EW._DATA.size=$EW._readData.getUint32()},$EW.READ_BLOCK=function(){for(var $EM=$EW._BLOCK.count=$EW._readData.getUint16(),$Ee=$EW._BLOCK.blockStarts=[],$EL=$EW._BLOCK.blockLengths=[],$E_=0;$E_<$EM;$E_++)$Ee.push($EW._readData.getUint32()),$EL.push($EW._readData.getUint32())},$EW.READ_STRINGS=function(){var $EM=$EW._readData.getUint32(),$Ee=$EW._readData.getUint16(),$EL=$EW._readData.pos;$EW._readData.pos=$EM+$EW._DATA.offset;for(var $E_=0;$E_<$Ee;$E_++)$EW._strings[$E_]=$EW._readData.readUTFString();$EW._readData.pos=$EL},$EW.READ_MESH=function(){var $EM,$Ee=$EW._readString(),$EL=$EW._readData.__getBuffer(),$E_=0,$Ec=$EW._readData.getInt16(),$Eq=$EW._DATA.offset;for($E_=0;$E_<$Ec;$E_++){var $EH,$ET=$Eq+$EW._readData.getUint32(),$Ex=$EW._readData.getUint32(),$EO=new Float32Array($EL.slice($ET,$ET+$Ex)),$Eu=$EW._readString();switch($EW._version){case"LAYAMODEL:03":$EH=$EW._vertexDeclarationMap_Discard[$Eu];break;case"LAYAMODEL:0301":$EH=$EW._vertexDeclarationMap[$Eu];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$EH)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$EW._version+"  bufferAttribute="+$Eu+"  name="+$Ee+"  url="+($EW._mesh?$EW._mesh.url:"null"));var $EG=$Ege.create($EH,4*$EO.length/$EH.vertexStride,35044,!0,$EW._mesh._url+"_"+$E_);$EG.setData($EO),$EW._mesh._vertexBuffers.push($EG)}var $EV=$Eq+$EW._readData.getUint32(),$EE=$EW._readData.getUint32(),$Ed=new Uint16Array($EL.slice($EV,$EV+$EE)),$Er=$EFe.create("ushort",$EE/2,35044,!0,$EW._mesh._url);$Er.setData($Ed),$EW._mesh._indexBuffer=$Er;var $E$=$EW._mesh._boneNames=[],$EC=$EW._readData.getUint16();for($E$.length=$EC,$E_=0;$E_<$EC;$E_++)$E$[$E_]=$EW._strings[$EW._readData.getUint16()];$EW._readData.pos+=8;var $EK=$EW._readData.getUint32(),$EX=$EW._readData.getUint32(),$Eo=new Float32Array($EL.slice($Eq+$EK,$Eq+$EK+$EX));for($EW._mesh._inverseBindPoses=[],$E_=0,$EM=$Eo.length;$E_<$EM;$E_+=16){var $Ei=new $EMe($Eo[$E_+0],$Eo[$E_+1],$Eo[$E_+2],$Eo[$E_+3],$Eo[$E_+4],$Eo[$E_+5],$Eo[$E_+6],$Eo[$E_+7],$Eo[$E_+8],$Eo[$E_+9],$Eo[$E_+10],$Eo[$E_+11],$Eo[$E_+12],$Eo[$E_+13],$Eo[$E_+14],$Eo[$E_+15]);$EW._mesh._inverseBindPoses.push($Ei)}return $EW._mesh._skinnedDatas=new Float32Array(16*$Eo.length),!0},$EW.READ_SUBMESH=function(){var $EM=$EW._readData.__getBuffer(),$Ee=new $EOe($EW._mesh),$EL=$EW._readData.getInt16(),$E_=$EW._readData.getUint32(),$Ec=$EW._readData.getUint32();$Ee._vertexBuffer=$EW._mesh._vertexBuffers[$EL],$Ee._vertexStart=$E_,$Ee._vertexCount=$Ec;var $Eq=$EW._readData.getUint32(),$EH=$EW._readData.getUint32(),$ET=$EW._mesh._indexBuffer;$Ee._indexBuffer=$ET,$Ee._indexStart=$Eq,$Ee._indexCount=$EH,$Ee._indices=new Uint16Array($ET.getData().buffer,2*$Eq,$EH);var $Ex=$EW._DATA.offset,$EO=$Ee._subIndexBufferStart,$Eu=$Ee._subIndexBufferCount,$EG=$Ee._boneIndicesList,$EV=$EW._readData.getUint16();$EO.length=$EV,$Eu.length=$EV,$EG.length=$EV;for(var $EE=0;$EE<$EV;$EE++){$EO[$EE]=$EW._readData.getUint32(),$Eu[$EE]=$EW._readData.getUint32();var $Ed=$EW._readData.getUint32(),$Er=$EW._readData.getUint32();$EG[$EE]=new Uint8Array($EM.slice($Ex+$Ed,$Ex+$Ed+$Er))}return $EW._subMeshes.push($Ee),!0},$EW._strings=[],$EW._readData=null,$EW._version=null,$EW._mesh=null,$EW._subMeshes=null,$EW._materialMap=null,$EG($EW,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$EXM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$ECM.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$EmM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$EnM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$ERM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$EAM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$EWM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$EgM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$EjM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$EVM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$EuM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$EiM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$E$M.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$EfM.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$EpM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$EkM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$EbM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$ErM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$EwM.vertexDeclaration,"POSITION,NORMAL,UV":$ESM.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$EdM.vertexDeclaration,"POSITION,NORMAL,COLOR":$EOM.vertexDeclaration,"POSITION,NORMAL,TANGENT":$EtM.vertexDeclaration,"POSITION,NORMAL":$ExM.vertexDeclaration,"POSITION,UV":$EQM.vertexDeclaration,POSITION:$ETM.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$EKM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$ECM.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$EmM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$EaM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$ERM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$EyM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$EWM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$EFM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$EjM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$EGM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$EuM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$EoM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$E$M.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$ElM.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$EpM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$EBM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$EbM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$ErM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$EJM.vertexDeclaration,"POSITION,NORMAL,UV":$ESM.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$EEM.vertexDeclaration,"POSITION,NORMAL,COLOR":$EOM.vertexDeclaration,"POSITION,NORMAL,TANGENT":$EhM.vertexDeclaration,"POSITION,NORMAL":$ExM.vertexDeclaration,"POSITION,UV":$EQM.vertexDeclaration,POSITION:$ETM.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$EW}(),$EvM=function(){function $ET(){}return $EE($ET,"laya.d3.loaders.MeshReader"),$ET.read=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=new $EW($EM);$Eq.pos=0;var $EH=$Eq.readUTFString();switch($EH){case"LAYAMODEL:01":case"LAYASKINANI:01":$ET._readVersion01($Eq,$EH,$Ee,$EL,$E_,$Ec);break;case"LAYAMODEL:02":$EPM.parse($Eq,$EH,$Ee,$EL,$E_,$Ec);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$EZM.parse($Eq,$EH,$Ee,$E_,$Ec);break;default:throw new Error("MeshReader: unknown mesh version.")}$Ee._setSubMeshes($E_)},$ET._readVersion01=function($EM,$Ee,$EL,$E_,$Ec,$Eq){new $EYM($EM,$Ee,$EL,$E_,$Ec,$Eq)},$ET}(),$ENM=function(){function $EM($EM,$Ee){this.min=null,this.max=null,this.min=$EM,this.max=$Ee}$EE($EM,"laya.d3.math.BoundBox");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.getCorners=function($EM){$EM.length=8;var $Ee=this.min.elements,$EL=this.max.elements,$E_=$Ee[0],$Ec=$Ee[1],$Eq=$Ee[2],$EH=$EL[0],$ET=$EL[1],$Ex=$EL[2];$EM[0]=new $EHe($E_,$ET,$Ex),$EM[1]=new $EHe($EH,$ET,$Ex),$EM[2]=new $EHe($EH,$Ec,$Ex),$EM[3]=new $EHe($E_,$Ec,$Ex),$EM[4]=new $EHe($E_,$ET,$Eq),$EM[5]=new $EHe($EH,$ET,$Eq),$EM[6]=new $EHe($EH,$Ec,$Eq),$EM[7]=new $EHe($E_,$Ec,$Eq)},$Ee.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$Ee.cloneTo=function($EM){var $Ee=$EM;this.min.cloneTo($Ee.min),this.max.cloneTo($Ee.max)},$Ee.clone=function(){var $EM=new this.constructor(new $EHe,new $EHe);return this.cloneTo($EM),$EM},$EM.createfromPoints=function($EM,$Ee){if(null==$EM)throw new Error("points");var $EL=$Ee.min,$E_=$Ee.max,$Ec=$EL.elements;$Ec[0]=Number.MAX_VALUE,$Ec[1]=Number.MAX_VALUE,$Ec[2]=Number.MAX_VALUE;var $Eq=$E_.elements;$Eq[0]=-Number.MAX_VALUE,$Eq[1]=-Number.MAX_VALUE,$Eq[2]=-Number.MAX_VALUE;for(var $EH=0,$ET=$EM.length;$EH<$ET;++$EH)$EHe.min($EL,$EM[$EH],$EL),$EHe.max($E_,$EM[$EH],$E_)},$EM.merge=function($EM,$Ee,$EL){$EHe.min($EM.min,$Ee.min,$EL.min),$EHe.max($EM.max,$Ee.max,$EL.max)},$EM}(),$EsM=function(){function $EO($EM){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$EM,this._near=new $Eee(new $EHe),this._far=new $Eee(new $EHe),this._left=new $Eee(new $EHe),this._right=new $Eee(new $EHe),this._top=new $Eee(new $EHe),this._bottom=new $Eee(new $EHe),$EO._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$EE($EO,"laya.d3.math.BoundFrustum");var $EM=$EO.prototype;return $EM.equalsBoundFrustum=function($EM){return this._matrix.equalsOtherMatrix($EM.matrix)},$EM.equalsObj=function($EM){if($EM instanceof laya.d3.math.BoundFrustum){var $Ee=$EM;return this.equalsBoundFrustum($Ee)}return!1},$EM.getPlane=function($EM){switch($EM){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$EM.getCorners=function($EM){$EO._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($EM[0]),$EO._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($EM[1]),$EO._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($EM[2]),$EO._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($EM[3]),$EO._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($EM[4]),$EO._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($EM[5]),$EO._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($EM[6]),$EO._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($EM[7])},$EM.containsPoint=function($EM){for(var $Ee=$Eee.PlaneIntersectionType_Front,$EL=$Eee.PlaneIntersectionType_Front,$E_=0;$E_<6;$E_++){switch($E_){case 0:$EL=Collision.intersectsPlaneAndPoint(this._near,$EM);break;case 1:$EL=Collision.intersectsPlaneAndPoint(this._far,$EM);break;case 2:$EL=Collision.intersectsPlaneAndPoint(this._left,$EM);break;case 3:$EL=Collision.intersectsPlaneAndPoint(this._right,$EM);break;case 4:$EL=Collision.intersectsPlaneAndPoint(this._top,$EM);break;case 5:$EL=Collision.intersectsPlaneAndPoint(this._bottom,$EM)}switch($EL){case $Eee.PlaneIntersectionType_Back:return 0;case $Eee.PlaneIntersectionType_Intersecting:$Ee=$Eee.PlaneIntersectionType_Intersecting}}switch($Ee){case $Eee.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$EM.containsBoundBox=function($EM){for(var $Ee,$EL=$EO._tempV30,$E_=$EO._tempV31,$Ec=1,$Eq=0;$Eq<6;$Eq++){if($Ee=this.getPlane($Eq),this._getBoxToPlanePVertexNVertex($EM,$Ee.normal,$EL,$E_),Collision.intersectsPlaneAndPoint($Ee,$EL)===$Eee.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($Ee,$E_)===$Eee.PlaneIntersectionType_Back&&($Ec=2)}return $Ec},$EM.containsBoundSphere=function($EM){for(var $Ee=$Eee.PlaneIntersectionType_Front,$EL=$Eee.PlaneIntersectionType_Front,$E_=0;$E_<6;$E_++){switch($E_){case 0:$EL=Collision.intersectsPlaneAndSphere(this._near,$EM);break;case 1:$EL=Collision.intersectsPlaneAndSphere(this._far,$EM);break;case 2:$EL=Collision.intersectsPlaneAndSphere(this._left,$EM);break;case 3:$EL=Collision.intersectsPlaneAndSphere(this._right,$EM);break;case 4:$EL=Collision.intersectsPlaneAndSphere(this._top,$EM);break;case 5:$EL=Collision.intersectsPlaneAndSphere(this._bottom,$EM)}switch($EL){case $Eee.PlaneIntersectionType_Back:return 0;case $Eee.PlaneIntersectionType_Intersecting:$Ee=$Eee.PlaneIntersectionType_Intersecting}}switch($Ee){case $Eee.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$EM._getBoxToPlanePVertexNVertex=function($EM,$Ee,$EL,$E_){var $Ec=$EM.min,$Eq=$Ec.elements,$EH=$EM.max,$ET=$EH.elements,$Ex=$Ee.elements,$EO=$Ex[0],$Eu=$Ex[1],$EG=$Ex[2];$Ec.cloneTo($EL);var $EV=$EL.elements;0<=$EO&&($EV[0]=$ET[0]),0<=$Eu&&($EV[1]=$ET[1]),0<=$EG&&($EV[2]=$ET[2]),$EH.cloneTo($E_);var $EE=$E_.elements;0<=$EO&&($EE[0]=$Eq[0]),0<=$Eu&&($EE[1]=$Eq[1]),0<=$EG&&($EE[2]=$Eq[2])},$Ed(0,$EM,"top",function(){return this._top}),$Ed(0,$EM,"matrix",function(){return this._matrix},function($EM){this._matrix=$EM,$EO._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$Ed(0,$EM,"near",function(){return this._near}),$Ed(0,$EM,"far",function(){return this._far}),$Ed(0,$EM,"left",function(){return this._left}),$Ed(0,$EM,"right",function(){return this._right}),$Ed(0,$EM,"bottom",function(){return this._bottom}),$EO._getPlanesFromMatrix=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){var $ET=$EM.elements,$Ex=$ET[0],$EO=$ET[1],$Eu=$ET[2],$EG=$ET[3],$EV=$ET[4],$EE=$ET[5],$Ed=$ET[6],$Er=$ET[7],$E$=$ET[8],$EC=$ET[9],$EK=$ET[10],$EX=$ET[11],$Eo=$ET[12],$Ei=$ET[13],$EW=$ET[14],$Ey=$ET[15],$EA=$Ee.normal.elements;$EA[0]=$EG+$Eu,$EA[1]=$Er+$Ed,$EA[2]=$EX+$EK,$Ee.distance=$Ey+$EW,$Ee.normalize();var $EB=$EL.normal.elements;$EB[0]=$EG-$Eu,$EB[1]=$Er-$Ed,$EB[2]=$EX-$EK,$EL.distance=$Ey-$EW,$EL.normalize();var $Ek=$E_.normal.elements;$Ek[0]=$EG+$Ex,$Ek[1]=$Er+$EV,$Ek[2]=$EX+$E$,$E_.distance=$Ey+$Eo,$E_.normalize();var $Eh=$Ec.normal.elements;$Eh[0]=$EG-$Ex,$Eh[1]=$Er-$EV,$Eh[2]=$EX-$E$,$Ec.distance=$Ey-$Eo,$Ec.normalize();var $Et=$Eq.normal.elements;$Et[0]=$EG-$EO,$Et[1]=$Er-$EE,$Et[2]=$EX-$EC,$Eq.distance=$Ey-$Ei,$Eq.normalize();var $ES=$EH.normal.elements;$ES[0]=$EG+$EO,$ES[1]=$Er+$EE,$ES[2]=$EX+$EC,$EH.distance=$Ey+$Ei,$EH.normalize()},$EO._get3PlaneInterPoint=function($EM,$Ee,$EL){var $E_=$EM.normal,$Ec=$Ee.normal,$Eq=$EL.normal;$EHe.cross($Ec,$Eq,$EO._tempV30),$EHe.cross($Eq,$E_,$EO._tempV31),$EHe.cross($E_,$Ec,$EO._tempV32);var $EH=$EHe.dot($E_,$EO._tempV30),$ET=$EHe.dot($Ec,$EO._tempV31),$Ex=$EHe.dot($Eq,$EO._tempV32);return $EHe.scale($EO._tempV30,-$EM.distance/$EH,$EO._tempV33),$EHe.scale($EO._tempV31,-$Ee.distance/$ET,$EO._tempV34),$EHe.scale($EO._tempV32,-$EL.distance/$Ex,$EO._tempV35),$EHe.add($EO._tempV33,$EO._tempV34,$EO._tempV36),$EHe.add($EO._tempV35,$EO._tempV36,$EO._tempV37),$EO._tempV37},$EG($EO,["_tempV30",function(){return this._tempV30=new $EHe},"_tempV31",function(){return this._tempV31=new $EHe},"_tempV32",function(){return this._tempV32=new $EHe},"_tempV33",function(){return this._tempV33=new $EHe},"_tempV34",function(){return this._tempV34=new $EHe},"_tempV35",function(){return this._tempV35=new $EHe},"_tempV36",function(){return this._tempV36=new $EHe},"_tempV37",function(){return this._tempV37=new $EHe}]),$EO}(),$EDM=function(){function $Eu($EM,$Ee){this.center=null,this.radius=NaN,this.center=$EM,this.radius=$Ee}$EE($Eu,"laya.d3.math.BoundSphere");var $EM=$Eu.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.toDefault=function(){this.center.toDefault(),this.radius=0},$EM.intersectsRayDistance=function($EM){return Collision.intersectsRayAndSphereRD($EM,this)},$EM.intersectsRayPoint=function($EM,$Ee){return Collision.intersectsRayAndSphereRP($EM,this,$Ee)},$EM.cloneTo=function($EM){var $Ee=$EM;this.center.cloneTo($Ee.center),$Ee.radius=this.radius},$EM.clone=function(){var $EM=new this.constructor(new $EHe,new $EHe);return this.cloneTo($EM),$EM},$Eu.createFromSubPoints=function($EM,$Ee,$EL,$E_){if(null==$EM)throw new Error("points");if($Ee<0||$Ee>=$EM.length)throw new Error("start"+$Ee+"Must be in the range [0, "+($EM.length-1)+"]");if($EL<0||$Ee+$EL>$EM.length)throw new Error("count"+$EL+"Must be in the range <= "+$EM.length+"}");var $Ec=$Ee+$EL,$Eq=$Eu._tempVector3;$Eq.elements[0]=0,$Eq.elements[1]=0,$Eq.elements[2]=0;for(var $EH=$Ee;$EH<$Ec;++$EH)$EHe.add($EM[$EH],$Eq,$Eq);var $ET=$E_.center;$EHe.scale($Eq,1/$EL,$ET);var $Ex=0;for($EH=$Ee;$EH<$Ec;++$EH){var $EO=$EHe.distanceSquared($ET,$EM[$EH]);$Ex<$EO&&($Ex=$EO)}$E_.radius=Math.sqrt($Ex)},$Eu.createfromPoints=function($EM,$Ee){if(null==$EM)throw new Error("points");$Eu.createFromSubPoints($EM,0,$EM.length,$Ee)},$EG($Eu,["_tempVector3",function(){return this._tempVector3=new $EHe}]),$Eu}(),$EUM=(function(){function $EM(){}$EE($EM,"laya.d3.math.ContainmentType"),$EM.Disjoint=0,$EM.Contains=1,$EM.Intersects=2}(),function(){function $EL(){}return $EE($EL,"laya.d3.math.MathUtils3D"),$EL.isZero=function($EM){return Math.abs($EM)<$EL.zeroTolerance},$EL.nearEqual=function($EM,$Ee){return!!$EL.isZero($EM-$Ee)},$EL.fastInvSqrt=function($EM){return $EL.isZero($EM)?$EM:1/Math.sqrt($EM)},$EG($EL,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$EL}()),$EIM=function(){function $Ex(){var $EM=this.elements=new Float32Array(9);$EM[0]=1,$EM[1]=0,$EM[2]=0,$EM[3]=0,$EM[4]=1,$EM[5]=0,$EM[6]=0,$EM[7]=0,$EM[8]=1}$EE($Ex,"laya.d3.math.Matrix3x3");var $EM=$Ex.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.determinant=function(){var $EM=this.elements,$Ee=$EM[0],$EL=$EM[1],$E_=$EM[2],$Ec=$EM[3],$Eq=$EM[4],$EH=$EM[5],$ET=$EM[6],$Ex=$EM[7],$EO=$EM[8];return $Ee*($EO*$Eq-$EH*$Ex)+$EL*(-$EO*$Ec+$EH*$ET)+$E_*($Ex*$Ec-$Eq*$ET)},$EM.translate=function($EM,$Ee){var $EL=$Ee.elements,$E_=this.elements,$Ec=$EM.elements,$Eq=$E_[0],$EH=$E_[1],$ET=$E_[2],$Ex=$E_[3],$EO=$E_[4],$Eu=$E_[5],$EG=$E_[6],$EV=$E_[7],$EE=$E_[8],$Ed=$Ec[0],$Er=$Ec[1];$EL[0]=$Eq,$EL[1]=$EH,$EL[2]=$ET,$EL[3]=$Ex,$EL[4]=$EO,$EL[5]=$Eu,$EL[6]=$Ed*$Eq+$Er*$Ex+$EG,$EL[7]=$Ed*$EH+$Er*$EO+$EV,$EL[8]=$Ed*$ET+$Er*$Eu+$EE},$EM.rotate=function($EM,$Ee){var $EL=$Ee.elements,$E_=this.elements,$Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$E_[3],$Ex=$E_[4],$EO=$E_[5],$Eu=$E_[6],$EG=$E_[7],$EV=$E_[8],$EE=Math.sin($EM),$Ed=Math.cos($EM);$EL[0]=$Ed*$Ec+$EE*$ET,$EL[1]=$Ed*$Eq+$EE*$Ex,$EL[2]=$Ed*$EH+$EE*$EO,$EL[3]=$Ed*$ET-$EE*$Ec,$EL[4]=$Ed*$Ex-$EE*$Eq,$EL[5]=$Ed*$EO-$EE*$EH,$EL[6]=$Eu,$EL[7]=$EG,$EL[8]=$EV},$EM.scale=function($EM,$Ee){var $EL=$Ee.elements,$E_=this.elements,$Ec=$EM.elements,$Eq=$Ec[0],$EH=$Ec[1];$EL[0]=$Eq*$E_[0],$EL[1]=$Eq*$E_[1],$EL[2]=$Eq*$E_[2],$EL[3]=$EH*$E_[3],$EL[4]=$EH*$E_[4],$EL[5]=$EH*$E_[5],$EL[6]=$E_[6],$EL[7]=$E_[7],$EL[8]=$E_[8]},$EM.invert=function($EM){var $Ee=$EM.elements,$EL=this.elements,$E_=$EL[0],$Ec=$EL[1],$Eq=$EL[2],$EH=$EL[3],$ET=$EL[4],$Ex=$EL[5],$EO=$EL[6],$Eu=$EL[7],$EG=$EL[8],$EV=$EG*$ET-$Ex*$Eu,$EE=-$EG*$EH+$Ex*$EO,$Ed=$Eu*$EH-$ET*$EO,$Er=$E_*$EV+$Ec*$EE+$Eq*$Ed;$Er||($EM=null),$Er=1/$Er,$Ee[0]=$EV*$Er,$Ee[1]=(-$EG*$Ec+$Eq*$Eu)*$Er,$Ee[2]=($Ex*$Ec-$Eq*$ET)*$Er,$Ee[3]=$EE*$Er,$Ee[4]=($EG*$E_-$Eq*$EO)*$Er,$Ee[5]=(-$Ex*$E_+$Eq*$EH)*$Er,$Ee[6]=$Ed*$Er,$Ee[7]=(-$Eu*$E_+$Ec*$EO)*$Er,$Ee[8]=($ET*$E_-$Ec*$EH)*$Er},$EM.transpose=function($EM){var $Ee=$EM.elements,$EL=this.elements;if($EM===this){var $E_=$EL[1],$Ec=$EL[2],$Eq=$EL[5];$Ee[1]=$EL[3],$Ee[2]=$EL[6],$Ee[3]=$E_,$Ee[5]=$EL[7],$Ee[6]=$Ec,$Ee[7]=$Eq}else $Ee[0]=$EL[0],$Ee[1]=$EL[3],$Ee[2]=$EL[6],$Ee[3]=$EL[1],$Ee[4]=$EL[4],$Ee[5]=$EL[7],$Ee[6]=$EL[2],$Ee[7]=$EL[5],$Ee[8]=$EL[8]},$EM.identity=function(){var $EM=this.elements;$EM[0]=1,$EM[1]=0,$EM[2]=0,$EM[3]=0,$EM[4]=1,$EM[5]=0,$EM[6]=0,$EM[7]=0,$EM[8]=1},$EM.cloneTo=function($EM){var $Ee,$EL,$E_;if(($EL=this.elements)!==($E_=$EM.elements))for($Ee=0;$Ee<9;++$Ee)$E_[$Ee]=$EL[$Ee]},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ex.createFromTranslation=function($EM,$Ee){$Ee.elements;var $EL=$EM.elements;$Ee[0]=1,$Ee[1]=0,$Ee[2]=0,$Ee[3]=0,$Ee[4]=1,$Ee[5]=0,$Ee[6]=$EL[0],$Ee[7]=$EL[1],$Ee[8]=1},$Ex.createFromRotation=function($EM,$Ee){var $EL=$Ee.elements,$E_=Math.sin($EM),$Ec=Math.cos($EM);$EL[0]=$Ec,$EL[1]=$E_,$EL[2]=0,$EL[3]=-$E_,$EL[4]=$Ec,$EL[5]=0,$EL[6]=0,$EL[7]=0,$EL[8]=1},$Ex.createFromScaling=function($EM,$Ee){var $EL=$Ee.elements,$E_=$EM.elements;$EL[0]=$E_[0],$EL[1]=0,$EL[2]=0,$EL[3]=0,$EL[4]=$E_[1],$EL[5]=0,$EL[6]=0,$EL[7]=0,$EL[8]=1},$Ex.createFromMatrix4x4=function($EM,$Ee){$Ee[0]=$EM[0],$Ee[1]=$EM[1],$Ee[2]=$EM[2],$Ee[3]=$EM[4],$Ee[4]=$EM[5],$Ee[5]=$EM[6],$Ee[6]=$EM[8],$Ee[7]=$EM[9],$Ee[8]=$EM[10]},$Ex.multiply=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements,$EH=$Ec[0],$ET=$Ec[1],$Ex=$Ec[2],$EO=$Ec[3],$Eu=$Ec[4],$EG=$Ec[5],$EV=$Ec[6],$EE=$Ec[7],$Ed=$Ec[8],$Er=$Eq[0],$E$=$Eq[1],$EC=$Eq[2],$EK=$Eq[3],$EX=$Eq[4],$Eo=$Eq[5],$Ei=$Eq[6],$EW=$Eq[7],$Ey=$Eq[8];$E_[0]=$Er*$EH+$E$*$EO+$EC*$EV,$E_[1]=$Er*$ET+$E$*$Eu+$EC*$EE,$E_[2]=$Er*$Ex+$E$*$EG+$EC*$Ed,$E_[3]=$EK*$EH+$EX*$EO+$Eo*$EV,$E_[4]=$EK*$ET+$EX*$Eu+$Eo*$EE,$E_[5]=$EK*$Ex+$EX*$EG+$Eo*$Ed,$E_[6]=$Ei*$EH+$EW*$EO+$Ey*$EV,$E_[7]=$Ei*$ET+$EW*$Eu+$Ey*$EE,$E_[8]=$Ei*$Ex+$EW*$EG+$Ey*$Ed},$Ex.lookAt=function($EM,$Ee,$EL,$E_){$EHe.subtract($EM,$Ee,$Ex._tempV30),$EHe.normalize($Ex._tempV30,$Ex._tempV30),$EHe.cross($EL,$Ex._tempV30,$Ex._tempV31),$EHe.normalize($Ex._tempV31,$Ex._tempV31),$EHe.cross($Ex._tempV30,$Ex._tempV31,$Ex._tempV32);var $Ec=$Ex._tempV30.elements,$Eq=$Ex._tempV31.elements,$EH=$Ex._tempV32.elements,$ET=$E_.elements;$ET[0]=$Eq[0],$ET[3]=$Eq[1],$ET[6]=$Eq[2],$ET[1]=$EH[0],$ET[4]=$EH[1],$ET[7]=$EH[2],$ET[2]=$Ec[0],$ET[5]=$Ec[1],$ET[8]=$Ec[2]},$Ex.DEFAULT=new $Ex,$EG($Ex,["_tempV30",function(){return this._tempV30=new $EHe},"_tempV31",function(){return this._tempV31=new $EHe},"_tempV32",function(){return this._tempV32=new $EHe}]),$Ex}(),$EMe=function(){function $EB($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG,$EV,$EE,$Ed,$Er){void 0===$EM&&($EM=1),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=1),void 0===$EH&&($EH=0),void 0===$ET&&($ET=0),void 0===$Ex&&($Ex=0),void 0===$EO&&($EO=0),void 0===$Eu&&($Eu=1),void 0===$EG&&($EG=0),void 0===$EV&&($EV=0),void 0===$EE&&($EE=0),void 0===$Ed&&($Ed=0),void 0===$Er&&($Er=1);var $E$=this.elements=new Float32Array(16);$E$[0]=$EM,$E$[1]=$Ee,$E$[2]=$EL,$E$[3]=$E_,$E$[4]=$Ec,$E$[5]=$Eq,$E$[6]=$EH,$E$[7]=$ET,$E$[8]=$Ex,$E$[9]=$EO,$E$[10]=$Eu,$E$[11]=$EG,$E$[12]=$EV,$E$[13]=$EE,$E$[14]=$Ed,$E$[15]=$Er}$EE($EB,"laya.d3.math.Matrix4x4");var $EM=$EB.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.getElementByRowColumn=function($EM,$Ee){if($EM<0||3<$EM)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($Ee<0||3<$Ee)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$EM+$Ee]},$EM.setElementByRowColumn=function($EM,$Ee,$EL){if($EM<0||3<$EM)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($Ee<0||3<$Ee)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$EM+$Ee]=$EL},$EM.equalsOtherMatrix=function($EM){var $Ee=this.elements,$EL=$EM.elements;return $EUM.nearEqual($Ee[0],$EL[0])&&$EUM.nearEqual($Ee[1],$EL[1])&&$EUM.nearEqual($Ee[2],$EL[2])&&$EUM.nearEqual($Ee[3],$EL[3])&&$EUM.nearEqual($Ee[4],$EL[4])&&$EUM.nearEqual($Ee[5],$EL[5])&&$EUM.nearEqual($Ee[6],$EL[6])&&$EUM.nearEqual($Ee[7],$EL[7])&&$EUM.nearEqual($Ee[8],$EL[8])&&$EUM.nearEqual($Ee[9],$EL[9])&&$EUM.nearEqual($Ee[10],$EL[10])&&$EUM.nearEqual($Ee[11],$EL[11])&&$EUM.nearEqual($Ee[12],$EL[12])&&$EUM.nearEqual($Ee[13],$EL[13])&&$EUM.nearEqual($Ee[14],$EL[14])&&$EUM.nearEqual($Ee[15],$EL[15])},$EM.decomposeTransRotScale=function($EM,$Ee,$EL){var $E_=$EB._tempMatrix4x4;return this.decomposeTransRotMatScale($EM,$E_,$EL)?($ELe.createFromMatrix4x4($E_,$Ee),!0):($Ee.identity(),!1)},$EM.decomposeTransRotMatScale=function($EM,$Ee,$EL){var $E_=this.elements,$Ec=$EM.elements,$Eq=$Ee.elements,$EH=$EL.elements;$Ec[0]=$E_[12],$Ec[1]=$E_[13],$Ec[2]=$E_[14];var $ET=$E_[0],$Ex=$E_[1],$EO=$E_[2],$Eu=$E_[4],$EG=$E_[5],$EV=$E_[6],$EE=$E_[8],$Ed=$E_[9],$Er=$E_[10],$E$=$EH[0]=Math.sqrt($ET*$ET+$Ex*$Ex+$EO*$EO),$EC=$EH[1]=Math.sqrt($Eu*$Eu+$EG*$EG+$EV*$EV),$EK=$EH[2]=Math.sqrt($EE*$EE+$Ed*$Ed+$Er*$Er);if($EUM.isZero($E$)||$EUM.isZero($EC)||$EUM.isZero($EK))return $Eq[1]=$Eq[2]=$Eq[3]=$Eq[4]=$Eq[6]=$Eq[7]=$Eq[8]=$Eq[9]=$Eq[11]=$Eq[12]=$Eq[13]=$Eq[14]=0,$Eq[0]=$Eq[5]=$Eq[10]=$Eq[15]=1,!1;var $EX=$EB._tempVector0,$Eo=$EX.elements;$Eo[0]=$EE/$EK,$Eo[1]=$Ed/$EK,$Eo[2]=$Er/$EK;var $Ei=$EB._tempVector1,$EW=$Ei.elements;$EW[0]=$ET/$E$,$EW[1]=$Ex/$E$,$EW[2]=$EO/$E$;var $Ey=$EB._tempVector2;$EHe.cross($EX,$Ei,$Ey);var $EA=$EB._tempVector1;return $EHe.cross($Ey,$EX,$EA),$Eq[3]=$Eq[7]=$Eq[11]=$Eq[12]=$Eq[13]=$Eq[14]=0,$Eq[15]=1,$Eq[0]=$EA.x,$Eq[1]=$EA.y,$Eq[2]=$EA.z,$Eq[4]=$Ey.x,$Eq[5]=$Ey.y,$Eq[6]=$Ey.z,$Eq[8]=$EX.x,$Eq[9]=$EX.y,$Eq[10]=$EX.z,$Eq[0]*$ET+$Eq[1]*$Ex+$Eq[2]*$EO<0&&($EH[0]=-$E$),$Eq[4]*$Eu+$Eq[5]*$EG+$Eq[6]*$EV<0&&($EH[1]=-$EC),$Eq[8]*$EE+$Eq[9]*$Ed+$Eq[10]*$Er<0&&($EH[2]=-$EK),!0},$EM.decomposeYawPitchRoll=function($EM){var $Ee=$EM.elements,$EL=Math.asin(-this.elements[9]);$Ee[1]=$EL,Math.cos($EL)>$EUM.zeroTolerance?($Ee[2]=Math.atan2(this.elements[1],this.elements[5]),$Ee[0]=Math.atan2(this.elements[8],this.elements[10])):($Ee[2]=Math.atan2(-this.elements[4],this.elements[0]),$Ee[0]=0)},$EM.normalize=function(){var $EM=this.elements,$Ee=$EM[0],$EL=$EM[1],$E_=$EM[2],$Ec=Math.sqrt($Ee*$Ee+$EL*$EL+$E_*$E_);if(!$Ec)return $EM[0]=0,$EM[1]=0,void($EM[2]=0);1!=$Ec&&($Ec=1/$Ec,$EM[0]=$Ee*$Ec,$EM[1]=$EL*$Ec,$EM[2]=$E_*$Ec)},$EM.transpose=function(){var $EM,$Ee;return $Ee=($EM=this.elements)[1],$EM[1]=$EM[4],$EM[4]=$Ee,$Ee=$EM[2],$EM[2]=$EM[8],$EM[8]=$Ee,$Ee=$EM[3],$EM[3]=$EM[12],$EM[12]=$Ee,$Ee=$EM[6],$EM[6]=$EM[9],$EM[9]=$Ee,$Ee=$EM[7],$EM[7]=$EM[13],$EM[13]=$Ee,$Ee=$EM[11],$EM[11]=$EM[14],$EM[14]=$Ee,this},$EM.invert=function($EM){var $Ee=this.elements,$EL=$EM.elements,$E_=$Ee[0],$Ec=$Ee[1],$Eq=$Ee[2],$EH=$Ee[3],$ET=$Ee[4],$Ex=$Ee[5],$EO=$Ee[6],$Eu=$Ee[7],$EG=$Ee[8],$EV=$Ee[9],$EE=$Ee[10],$Ed=$Ee[11],$Er=$Ee[12],$E$=$Ee[13],$EC=$Ee[14],$EK=$Ee[15],$EX=$E_*$Ex-$Ec*$ET,$Eo=$E_*$EO-$Eq*$ET,$Ei=$E_*$Eu-$EH*$ET,$EW=$Ec*$EO-$Eq*$Ex,$Ey=$Ec*$Eu-$EH*$Ex,$EA=$Eq*$Eu-$EH*$EO,$EB=$EG*$E$-$EV*$Er,$Ek=$EG*$EC-$EE*$Er,$Eh=$EG*$EK-$Ed*$Er,$Et=$EV*$EC-$EE*$E$,$ES=$EV*$EK-$Ed*$E$,$Ep=$EE*$EK-$Ed*$EC,$ER=$EX*$Ep-$Eo*$ES+$Ei*$Et+$EW*$Eh-$Ey*$Ek+$EA*$EB;0!==Math.abs($ER)&&($ER=1/$ER,$EL[0]=($Ex*$Ep-$EO*$ES+$Eu*$Et)*$ER,$EL[1]=($Eq*$ES-$Ec*$Ep-$EH*$Et)*$ER,$EL[2]=($E$*$EA-$EC*$Ey+$EK*$EW)*$ER,$EL[3]=($EE*$Ey-$EV*$EA-$Ed*$EW)*$ER,$EL[4]=($EO*$Eh-$ET*$Ep-$Eu*$Ek)*$ER,$EL[5]=($E_*$Ep-$Eq*$Eh+$EH*$Ek)*$ER,$EL[6]=($EC*$Ei-$Er*$EA-$EK*$Eo)*$ER,$EL[7]=($EG*$EA-$EE*$Ei+$Ed*$Eo)*$ER,$EL[8]=($ET*$ES-$Ex*$Eh+$Eu*$EB)*$ER,$EL[9]=($Ec*$Eh-$E_*$ES-$EH*$EB)*$ER,$EL[10]=($Er*$Ey-$E$*$Ei+$EK*$EX)*$ER,$EL[11]=($EV*$Ei-$EG*$Ey-$Ed*$EX)*$ER,$EL[12]=($Ex*$Ek-$ET*$Et-$EO*$EB)*$ER,$EL[13]=($E_*$Et-$Ec*$Ek+$Eq*$EB)*$ER,$EL[14]=($E$*$Eo-$Er*$EW-$EC*$EX)*$ER,$EL[15]=($EG*$EW-$EV*$Eo+$EE*$EX)*$ER)},$EM.identity=function(){var $EM=this.elements;$EM[1]=$EM[2]=$EM[3]=$EM[4]=$EM[6]=$EM[7]=$EM[8]=$EM[9]=$EM[11]=$EM[12]=$EM[13]=$EM[14]=0,$EM[0]=$EM[5]=$EM[10]=$EM[15]=1},$EM.cloneTo=function($EM){var $Ee,$EL,$E_;if(($EL=this.elements)!==($E_=$EM.elements))for($Ee=0;$Ee<16;++$Ee)$E_[$Ee]=$EL[$Ee]},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$EM.getTranslationVector=function($EM){var $Ee=this.elements,$EL=$EM.elements;$EL[0]=$Ee[12],$EL[1]=$Ee[13],$EL[2]=$Ee[14]},$EM.setTranslationVector=function($EM){var $Ee=this.elements,$EL=$EM.elements;$Ee[12]=$EL[0],$Ee[13]=$EL[1],$Ee[14]=$EL[2]},$EM.getForward=function($EM){var $Ee=this.elements,$EL=$EM.elements;$EL[0]=-$Ee[8],$EL[1]=-$Ee[9],$EL[2]=-$Ee[10]},$EM.setForward=function($EM){var $Ee=this.elements,$EL=$EM.elements;$Ee[8]=-$EL[0],$Ee[9]=-$EL[1],$Ee[10]=-$EL[2]},$EB.createRotationX=function($EM,$Ee){var $EL=$Ee.elements,$E_=Math.sin($EM),$Ec=Math.cos($EM);$EL[1]=$EL[2]=$EL[3]=$EL[4]=$EL[7]=$EL[8]=$EL[11]=$EL[12]=$EL[13]=$EL[14]=0,$EL[0]=$EL[15]=1,$EL[5]=$EL[10]=$Ec,$EL[6]=$E_,$EL[9]=-$E_},$EB.createRotationY=function($EM,$Ee){var $EL=$Ee.elements,$E_=Math.sin($EM),$Ec=Math.cos($EM);$EL[1]=$EL[3]=$EL[4]=$EL[6]=$EL[7]=$EL[9]=$EL[11]=$EL[12]=$EL[13]=$EL[14]=0,$EL[5]=$EL[15]=1,$EL[0]=$EL[10]=$Ec,$EL[2]=-$E_,$EL[8]=$E_},$EB.createRotationZ=function($EM,$Ee){var $EL=$Ee.elements,$E_=Math.sin($EM),$Ec=Math.cos($EM);$EL[2]=$EL[3]=$EL[6]=$EL[7]=$EL[8]=$EL[9]=$EL[11]=$EL[12]=$EL[13]=$EL[14]=0,$EL[10]=$EL[15]=1,$EL[0]=$EL[5]=$Ec,$EL[1]=$E_,$EL[4]=-$E_},$EB.createRotationYawPitchRoll=function($EM,$Ee,$EL,$E_){$ELe.createFromYawPitchRoll($EM,$Ee,$EL,$EB._tempQuaternion),$EB.createRotationQuaternion($EB._tempQuaternion,$E_)},$EB.createRotationAxis=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=Math.cos($Ee),$Ex=Math.sin($Ee),$EO=$Ec*$Ec,$Eu=$Eq*$Eq,$EG=$EH*$EH,$EV=$Ec*$Eq,$EE=$Ec*$EH,$Ed=$Eq*$EH,$Er=$EL.elements;$Er[3]=$Er[7]=$Er[11]=$Er[12]=$Er[13]=$Er[14]=0,$Er[15]=1,$Er[0]=$EO+$ET*(1-$EO),$Er[1]=$EV-$ET*$EV+$Ex*$EH,$Er[2]=$EE-$ET*$EE-$Ex*$Eq,$Er[4]=$EV-$ET*$EV-$Ex*$EH,$Er[5]=$Eu+$ET*(1-$Eu),$Er[6]=$Ed-$ET*$Ed+$Ex*$Ec,$Er[8]=$EE-$ET*$EE+$Ex*$Eq,$Er[9]=$Ed-$ET*$Ed-$Ex*$Ec,$Er[10]=$EG+$ET*(1-$EG)},$EB.createRotationQuaternion=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EL[0],$Eq=$EL[1],$EH=$EL[2],$ET=$EL[3],$Ex=$Ec*$Ec,$EO=$Eq*$Eq,$Eu=$EH*$EH,$EG=$Ec*$Eq,$EV=$EH*$ET,$EE=$EH*$Ec,$Ed=$Eq*$ET,$Er=$Eq*$EH,$E$=$Ec*$ET;$E_[3]=$E_[7]=$E_[11]=$E_[12]=$E_[13]=$E_[14]=0,$E_[15]=1,$E_[0]=1-2*($EO+$Eu),$E_[1]=2*($EG+$EV),$E_[2]=2*($EE-$Ed),$E_[4]=2*($EG-$EV),$E_[5]=1-2*($Eu+$Ex),$E_[6]=2*($Er+$E$),$E_[8]=2*($EE+$Ed),$E_[9]=2*($Er-$E$),$E_[10]=1-2*($EO+$Ex)},$EB.createTranslate=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;$E_[4]=$E_[8]=$E_[1]=$E_[9]=$E_[2]=$E_[6]=$E_[3]=$E_[7]=$E_[11]=0,$E_[0]=$E_[5]=$E_[10]=$E_[15]=1,$E_[12]=$EL[0],$E_[13]=$EL[1],$E_[14]=$EL[2]},$EB.createScaling=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;$E_[0]=$EL[0],$E_[5]=$EL[1],$E_[10]=$EL[2],$E_[1]=$E_[4]=$E_[8]=$E_[12]=$E_[9]=$E_[13]=$E_[2]=$E_[6]=$E_[14]=$E_[3]=$E_[7]=$E_[11]=0,$E_[15]=1},$EB.multiply=function($EM,$Ee,$EL){var $E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu;for($Ec=$EL.elements,$Eq=$EM.elements,$Ec===($EH=$Ee.elements)&&($EH=$EH.slice()),$E_=0;$E_<4;$E_++)$ET=$Eq[$E_],$Ex=$Eq[$E_+4],$EO=$Eq[$E_+8],$Eu=$Eq[$E_+12],$Ec[$E_]=$ET*$EH[0]+$Ex*$EH[1]+$EO*$EH[2]+$Eu*$EH[3],$Ec[$E_+4]=$ET*$EH[4]+$Ex*$EH[5]+$EO*$EH[6]+$Eu*$EH[7],$Ec[$E_+8]=$ET*$EH[8]+$Ex*$EH[9]+$EO*$EH[10]+$Eu*$EH[11],$Ec[$E_+12]=$ET*$EH[12]+$Ex*$EH[13]+$EO*$EH[14]+$Eu*$EH[15]},$EB.createFromQuaternion=function($EM,$Ee){var $EL=$Ee.elements,$E_=$EM.elements,$Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$E_[3],$Ex=$Ec+$Ec,$EO=$Eq+$Eq,$Eu=$EH+$EH,$EG=$Ec*$Ex,$EV=$Eq*$Ex,$EE=$Eq*$EO,$Ed=$EH*$Ex,$Er=$EH*$EO,$E$=$EH*$Eu,$EC=$ET*$Ex,$EK=$ET*$EO,$EX=$ET*$Eu;$EL[0]=1-$EE-$E$,$EL[1]=$EV+$EX,$EL[2]=$Ed-$EK,$EL[3]=0,$EL[4]=$EV-$EX,$EL[5]=1-$EG-$E$,$EL[6]=$Er+$EC,$EL[7]=0,$EL[8]=$Ed+$EK,$EL[9]=$Er-$EC,$EL[10]=1-$EG-$EE,$EL[11]=0,$EL[12]=0,$EL[13]=0,$EL[14]=0,$EL[15]=1},$EB.createAffineTransformation=function($EM,$Ee,$EL,$E_){var $Ec=$EM.elements,$Eq=$Ee.elements,$EH=$EL.elements,$ET=$E_.elements,$Ex=$Eq[0],$EO=$Eq[1],$Eu=$Eq[2],$EG=$Eq[3],$EV=$Ex+$Ex,$EE=$EO+$EO,$Ed=$Eu+$Eu,$Er=$Ex*$EV,$E$=$Ex*$EE,$EC=$Ex*$Ed,$EK=$EO*$EE,$EX=$EO*$Ed,$Eo=$Eu*$Ed,$Ei=$EG*$EV,$EW=$EG*$EE,$Ey=$EG*$Ed,$EA=$EH[0],$EB=$EH[1],$Ek=$EH[2];$ET[0]=(1-($EK+$Eo))*$EA,$ET[1]=($E$+$Ey)*$EA,$ET[2]=($EC-$EW)*$EA,$ET[3]=0,$ET[4]=($E$-$Ey)*$EB,$ET[5]=(1-($Er+$Eo))*$EB,$ET[6]=($EX+$Ei)*$EB,$ET[7]=0,$ET[8]=($EC+$EW)*$Ek,$ET[9]=($EX-$Ei)*$Ek,$ET[10]=(1-($Er+$EK))*$Ek,$ET[11]=0,$ET[12]=$Ec[0],$ET[13]=$Ec[1],$ET[14]=$Ec[2],$ET[15]=1},$EB.createLookAt=function($EM,$Ee,$EL,$E_){var $Ec=$E_.elements,$Eq=$EB._tempVector0,$EH=$EB._tempVector1,$ET=$EB._tempVector2;$EHe.subtract($EM,$Ee,$ET),$EHe.normalize($ET,$ET),$EHe.cross($EL,$ET,$Eq),$EHe.normalize($Eq,$Eq),$EHe.cross($ET,$Eq,$EH),$E_.identity(),$Ec[0]=$Eq.x,$Ec[4]=$Eq.y,$Ec[8]=$Eq.z,$Ec[1]=$EH.x,$Ec[5]=$EH.y,$Ec[9]=$EH.z,$Ec[2]=$ET.x,$Ec[6]=$ET.y,$Ec[10]=$ET.z,$Ec[12]=-$EHe.dot($Eq,$EM),$Ec[13]=-$EHe.dot($EH,$EM),$Ec[14]=-$EHe.dot($ET,$EM)},$EB.createPerspective=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$Ec.elements,$EH=1/Math.tan($EM/2),$ET=1/($EL-$E_);$Eq[0]=$EH/$Ee,$Eq[5]=$EH,$Eq[10]=($E_+$EL)*$ET,$Eq[11]=-1,$Eq[14]=2*$E_*$EL*$ET,$Eq[1]=$Eq[2]=$Eq[3]=$Eq[4]=$Eq[6]=$Eq[7]=$Eq[8]=$Eq[9]=$Eq[12]=$Eq[13]=$Eq[15]=0},$EB.createOrthoOffCenterRH=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){var $ET=$EH.elements,$Ex=1/($EM-$Ee),$EO=1/($EL-$E_),$Eu=1/($Ec-$Eq);$ET[1]=$ET[2]=$ET[3]=$ET[4]=$ET[6]=$ET[7]=$ET[8]=$ET[9]=$ET[11]=0,$ET[15]=1,$ET[0]=-2*$Ex,$ET[5]=-2*$EO,$ET[10]=2*$Eu,$ET[12]=($EM+$Ee)*$Ex,$ET[13]=($E_+$EL)*$EO,$ET[14]=($Eq+$Ec)*$Eu},$EB.translation=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;$E_[0]=$E_[5]=$E_[10]=$E_[15]=1,$E_[12]=$EL[0],$E_[13]=$EL[1],$E_[14]=$EL[2]},$EG($EB,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $EB},"_tempVector0",function(){return this._tempVector0=new $EHe},"_tempVector1",function(){return this._tempVector1=new $EHe},"_tempVector2",function(){return this._tempVector2=new $EHe},"_tempQuaternion",function(){return this._tempQuaternion=new $ELe},"DEFAULT",function(){return this.DEFAULT=new $EB},"ZERO",function(){return this.ZERO=new $EB(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$EB}(),$Eee=(function(){function $EX($EM,$Ee){this.extents=null,this.transformation=null,this.extents=$EM,this.transformation=$Ee}$EE($EX,"laya.d3.math.OrientedBoundBox");var $EM=$EX.prototype;$EM.getCorners=function($EM){var $Ee=$EX._tempV30.elements,$EL=$EX._tempV31.elements,$E_=$EX._tempV32.elements,$Ec=this.extents.elements;$Ee[0]=$Ec[0],$Ee[1]=$Ee[2]=0,$EL[1]=$Ec[1],$EL[0]=$EL[2]=0,$E_[2]=$Ec[2],$E_[0]=$E_[1]=0,$EHe.TransformNormal($EX._tempV30,this.transformation,$EX._tempV30),$EHe.TransformNormal($EX._tempV31,this.transformation,$EX._tempV31),$EHe.TransformNormal($EX._tempV32,this.transformation,$EX._tempV32);var $Eq=$EX._tempV33;this.transformation.getTranslationVector($Eq),$EM.length=8,$EHe.add($Eq,$EX._tempV30,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV32,$EM[0]),$EHe.add($Eq,$EX._tempV30,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV32,$EM[1]),$EHe.subtract($Eq,$EX._tempV30,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV32,$EM[2]),$EHe.subtract($Eq,$EX._tempV30,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV32,$EM[3]),$EHe.add($Eq,$EX._tempV30,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV32,$EM[4]),$EHe.add($Eq,$EX._tempV30,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV32,$EM[5]),$EHe.subtract($Eq,$EX._tempV30,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV32,$EM[6]),$EHe.subtract($Eq,$EX._tempV30,$EX._tempV34),$EHe.subtract($EX._tempV34,$EX._tempV31,$EX._tempV34),$EHe.add($EX._tempV34,$EX._tempV32,$EM[7])},$EM.transform=function($EM){$EMe.multiply(this.transformation,$EM,this.transformation)},$EM.scale=function($EM){$EHe.multiply(this.extents,$EM,this.extents)},$EM.translate=function($EM){this.transformation.getTranslationVector($EX._tempV30),$EHe.add($EX._tempV30,$EM,$EX._tempV31),this.transformation.setTranslationVector($EX._tempV31)},$EM.Size=function($EM){$EHe.scale(this.extents,2,$EM)},$EM.getSize=function($EM){var $Ee=this.extents.elements;$EX._tempV30.x=$Ee[0],$EX._tempV31.y=$Ee[1],$EX._tempV32.z=$Ee[2],$EHe.TransformNormal($EX._tempV30,this.transformation,$EX._tempV30),$EHe.TransformNormal($EX._tempV31,this.transformation,$EX._tempV31),$EHe.TransformNormal($EX._tempV31,this.transformation,$EX._tempV32);var $EL=$EM.elements;$EL[0]=$EHe.scalarLength($EX._tempV30),$EL[1]=$EHe.scalarLength($EX._tempV31),$EL[2]=$EHe.scalarLength($EX._tempV32)},$EM.getSizeSquared=function($EM){var $Ee=this.extents.elements;$EX._tempV30.x=$Ee[0],$EX._tempV31.y=$Ee[1],$EX._tempV32.z=$Ee[2],$EHe.TransformNormal($EX._tempV30,this.transformation,$EX._tempV30),$EHe.TransformNormal($EX._tempV31,this.transformation,$EX._tempV31),$EHe.TransformNormal($EX._tempV31,this.transformation,$EX._tempV32);var $EL=$EM.elements;$EL[0]=$EHe.scalarLengthSquared($EX._tempV30),$EL[1]=$EHe.scalarLengthSquared($EX._tempV31),$EL[2]=$EHe.scalarLengthSquared($EX._tempV32)},$EM.getCenter=function($EM){this.transformation.getTranslationVector($EM)},$EM.containsPoint=function($EM){var $Ee=this.extents.elements,$EL=$Ee[0],$E_=$Ee[1],$Ec=$Ee[2];this.transformation.invert($EX._tempM0),$EHe.transformCoordinate($EM,$EX._tempM0,$EX._tempV30);var $Eq=$EX._tempV30.elements,$EH=Math.abs($Eq[0]),$ET=Math.abs($Eq[1]),$Ex=Math.abs($Eq[2]);return $EUM.nearEqual($EH,$EL)&&$EUM.nearEqual($ET,$E_)&&$EUM.nearEqual($Ex,$Ec)?2:$EH<$EL&&$ET<$E_&&$Ex<$Ec?1:0},$EM.containsPoints=function($EM){var $Ee=this.extents.elements,$EL=$Ee[0],$E_=$Ee[1],$Ec=$Ee[2];this.transformation.invert($EX._tempM0);for(var $Eq=!0,$EH=!1,$ET=0;$ET<$EM.length;$ET++){$EHe.transformCoordinate($EM[$ET],$EX._tempM0,$EX._tempV30);var $Ex=$EX._tempV30.elements,$EO=Math.abs($Ex[0]),$Eu=Math.abs($Ex[1]),$EG=Math.abs($Ex[2]);$EUM.nearEqual($EO,$EL)&&$EUM.nearEqual($Eu,$E_)&&$EUM.nearEqual($EG,$Ec)&&($EH=!0),$EO<$EL&&$Eu<$E_&&$EG<$Ec?$EH=!0:$Eq=!1}return $Eq?1:$EH?2:0},$EM.containsSphere=function($EM,$Ee){void 0===$Ee&&($Ee=!1);var $EL=this.extents.elements,$E_=$EL[0],$Ec=$EL[1],$Eq=$EL[2],$EH=$EM.radius;this.transformation.invert($EX._tempM0),$EHe.transformCoordinate($EM.center,$EX._tempM0,$EX._tempV30);var $ET=NaN;if($ET=$Ee?$EH:($EHe.scale($EHe.UnitX,$EH,$EX._tempV31),$EHe.TransformNormal($EX._tempV31,$EX._tempM0,$EX._tempV31),$EHe.scalarLength($EX._tempV31)),$EHe.scale(this.extents,-1,$EX._tempV32),$EHe.Clamp($EX._tempV30,$EX._tempV32,this.extents,$EX._tempV33),$ET*$ET<$EHe.distanceSquared($EX._tempV30,$EX._tempV33))return 0;var $Ex=$EX._tempV30.elements,$EO=$Ex[0],$Eu=$Ex[1],$EG=$Ex[2],$EV=$EX._tempV32.elements,$EE=$EV[0],$Ed=$EV[1],$Er=$EV[2];return $EE+$ET<=$EO&&$EO<=$E_-$ET&&$ET<$E_-$EE&&$Ed+$ET<=$Eu&&$Eu<=$Ec-$ET&&$ET<$Ec-$Ed&&$Er+$ET<=$EG&&$EG<=$Eq-$ET&&$ET<$Eq-$Er?1:2},$EM.containsOrientedBoundBox=function($EM){var $Ee=0,$EL=0;$EM.getCorners($EX._corners);var $E_=this.containsPoints($EX._corners);if(0!=$E_)return $E_;var $Ec=this.extents.elements;$EM.extents.cloneTo($EX._tempV35);var $Eq=$EX._tempV35.elements;$EX._getRows(this.transformation,$EX._rows1),$EX._getRows($EM.transformation,$EX._rows2);var $EH=NaN;for($Ee=0;$Ee<4;$Ee++)for($EL=0;$EL<4;$EL++)3==$Ee||3==$EL?($EX._tempM0.setElementByRowColumn($Ee,$EL,0),$EX._tempM1.setElementByRowColumn($Ee,$EL,0)):($EH=$EHe.dot($EX._rows1[$Ee],$EX._rows2[$EL]),$EX._tempM0.setElementByRowColumn($Ee,$EL,$EH),$EX._tempM1.setElementByRowColumn($Ee,$EL,Math.abs($EH)));$EM.getCenter($EX._tempV34),this.getCenter($EX._tempV36),$EHe.subtract($EX._tempV34,$EX._tempV36,$EX._tempV30);var $ET=$EX._tempV31.elements;$ET[0]=$EHe.dot($EX._tempV30,$EX._rows1[0]),$ET[1]=$EHe.dot($EX._tempV30,$EX._rows1[1]),$ET[2]=$EHe.dot($EX._tempV30,$EX._rows1[2]);var $Ex=$EX._tempV32.elements,$EO=$EX._tempV33.elements;for($Ee=0;$Ee<3;$Ee++)if($Ex[0]=$EX._tempM1.getElementByRowColumn($Ee,0),$Ex[1]=$EX._tempM1.getElementByRowColumn($Ee,1),$Ex[2]=$EX._tempM1.getElementByRowColumn($Ee,2),$Ec[$Ee]+$EHe.dot($EX._tempV35,$EX._tempV32)<Math.abs($ET[$Ee]))return 0;for($EL=0;$EL<3;$EL++)if($Ex[0]=$EX._tempM1.getElementByRowColumn(0,$EL),$Ex[1]=$EX._tempM1.getElementByRowColumn(1,$EL),$Ex[2]=$EX._tempM1.getElementByRowColumn(2,$EL),$EO[0]=$EX._tempM0.getElementByRowColumn(0,$EL),$EO[1]=$EX._tempM0.getElementByRowColumn(1,$EL),$EO[2]=$EX._tempM0.getElementByRowColumn(2,$EL),$EHe.dot(this.extents,$EX._tempV32)+$Eq[$EL]<Math.abs($EHe.dot($EX._tempV31,$EX._tempV33)))return 0;for($Ee=0;$Ee<3;$Ee++)for($EL=0;$EL<3;$EL++){var $Eu=($Ee+1)%3,$EG=($Ee+2)%3,$EV=($EL+1)%3,$EE=($EL+2)%3;if($Ec[$Eu]*$EX._tempM1.getElementByRowColumn($EG,$EL)+$Ec[$EG]*$EX._tempM1.getElementByRowColumn($Eu,$EL)+($Eq[$EV]*$EX._tempM1.getElementByRowColumn($Ee,$EE)+$Eq[$EE]*$EX._tempM1.getElementByRowColumn($Ee,$EV))<Math.abs($ET[$EG]*$EX._tempM0.getElementByRowColumn($Eu,$EL)-$ET[$Eu]*$EX._tempM0.getElementByRowColumn($EG,$EL)))return 0}return 2},$EM.containsLine=function($EM,$Ee){$EX._corners[0]=$EM,$EX._corners[1]=$Ee;var $EL=this.containsPoints($EX._corners);if(0!=$EL)return $EL;var $E_=this.extents.elements,$Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2];this.transformation.invert($EX._tempM0),$EHe.transformCoordinate($EM,$EX._tempM0,$EX._tempV30),$EHe.transformCoordinate($Ee,$EX._tempM0,$EX._tempV31),$EHe.add($EX._tempV30,$EX._tempV31,$EX._tempV32),$EHe.scale($EX._tempV32,.5,$EX._tempV32),$EHe.subtract($EX._tempV30,$EX._tempV32,$EX._tempV33);var $ET=$EX._tempV33.elements,$Ex=$ET[0],$EO=$ET[1],$Eu=$ET[2],$EG=$EX._tempV34.elements,$EV=$EG[0]=Math.abs($ET[0]),$EE=$EG[1]=Math.abs($ET[1]),$Ed=$EG[2]=Math.abs($ET[2]),$Er=$EX._tempV32.elements,$E$=$Er[0],$EC=$Er[1],$EK=$Er[2];return Math.abs($E$)>$Ec+$EV?0:Math.abs($EC)>$Eq+$EE?0:Math.abs($EK)>$EH+$Ed?0:Math.abs($EC*$Eu-$EK*$EO)>$Eq*$Ed+$EH*$EE?0:Math.abs($E$*$Eu-$EK*$Ex)>$Ec*$Ed+$EH*$EV?0:Math.abs($E$*$EO-$EC*$Ex)>$Ec*$EE+$Eq*$EV?0:2},$EM.containsBoundBox=function($EM){var $Ee=0,$EL=0,$E_=$EM.min,$Ec=$EM.max;$EM.getCorners($EX._corners);var $Eq=this.containsPoints($EX._corners);if(0!=$Eq)return $Eq;$EHe.subtract($Ec,$E_,$EX._tempV30),$EHe.scale($EX._tempV30,.5,$EX._tempV30),$EHe.add($E_,$EX._tempV30,$EX._tempV30),$EHe.subtract($Ec,$EX._tempV30,$EX._tempV31);var $EH=this.extents.elements,$ET=$EX._tempV31.elements;$EX._getRows(this.transformation,$EX._rows1),this.transformation.invert($EX._tempM0);for($Ee=0;$Ee<3;$Ee++)for($EL=0;$EL<3;$EL++)$EX._tempM1.setElementByRowColumn($Ee,$EL,Math.abs($EX._tempM0.getElementByRowColumn($Ee,$EL)));this.getCenter($EX._tempV35),$EHe.subtract($EX._tempV30,$EX._tempV35,$EX._tempV32);var $Ex=$EX._tempV31.elements;$Ex[0]=$EHe.dot($EX._tempV32,$EX._rows1[0]),$Ex[1]=$EHe.dot($EX._tempV32,$EX._rows1[1]),$Ex[2]=$EHe.dot($EX._tempV32,$EX._rows1[2]);var $EO=$EX._tempV33.elements,$Eu=$EX._tempV34.elements;for($Ee=0;$Ee<3;$Ee++)if($EO[0]=$EX._tempM1.getElementByRowColumn($Ee,0),$EO[1]=$EX._tempM1.getElementByRowColumn($Ee,1),$EO[2]=$EX._tempM1.getElementByRowColumn($Ee,2),$EH[$Ee]+$EHe.dot($EX._tempV31,$EX._tempV33)<Math.abs($Ex[$Ee]))return 0;for($EL=0;$EL<3;$EL++)if($EO[0]=$EX._tempM1.getElementByRowColumn(0,$EL),$EO[1]=$EX._tempM1.getElementByRowColumn(1,$EL),$EO[2]=$EX._tempM1.getElementByRowColumn(2,$EL),$Eu[0]=$EX._tempM0.getElementByRowColumn(0,$EL),$Eu[1]=$EX._tempM0.getElementByRowColumn(1,$EL),$Eu[2]=$EX._tempM0.getElementByRowColumn(2,$EL),$EHe.dot(this.extents,$EX._tempV33)+$ET[$EL]<Math.abs($EHe.dot($EX._tempV31,$EX._tempV34)))return 0;for($Ee=0;$Ee<3;$Ee++)for($EL=0;$EL<3;$EL++){var $EG=($Ee+1)%3,$EV=($Ee+2)%3,$EE=($EL+1)%3,$Ed=($EL+2)%3;if($EH[$EG]*$EX._tempM1.getElementByRowColumn($EV,$EL)+$EH[$EV]*$EX._tempM1.getElementByRowColumn($EG,$EL)+($ET[$EE]*$EX._tempM1.getElementByRowColumn($Ee,$Ed)+$ET[$Ed]*$EX._tempM1.getElementByRowColumn($Ee,$EE))<Math.abs($Ex[$EV]*$EX._tempM0.getElementByRowColumn($EG,$EL)-$Ex[$EG]*$EX._tempM0.getElementByRowColumn($EV,$EL)))return 0}return 2},$EM.intersectsRay=function($EM,$Ee){$EHe.scale(this.extents,-1,$EX._tempV30),this.transformation.invert($EX._tempM0),$EHe.TransformNormal($EM.direction,$EX._tempM0,$EX._ray.direction),$EHe.transformCoordinate($EM.origin,$EX._tempM0,$EX._ray.origin),$EX._boxBound1.min=$EX._tempV30,$EX._boxBound1.max=this.extents;var $EL=Collision.intersectsRayAndBoxRP($EX._ray,$EX._boxBound1,$Ee);return-1!==$EL&&$EHe.transformCoordinate($Ee,this.transformation,$Ee),$EL},$EM._getLocalCorners=function($EM){$EM.length=8;var $Ee=this.extents.elements;$EX._tempV30.x=$Ee[0],$EX._tempV31.y=$Ee[1],$EX._tempV32.z=$Ee[2],$EHe.add($EX._tempV30,$EX._tempV31,$EX._tempV33),$EHe.add($EX._tempV33,$EX._tempV32,$EM[0]),$EHe.add($EX._tempV30,$EX._tempV31,$EX._tempV33),$EHe.subtract($EX._tempV33,$EX._tempV32,$EM[1]),$EHe.subtract($EX._tempV31,$EX._tempV30,$EX._tempV33),$EHe.subtract($EX._tempV33,$EX._tempV30,$EM[2]),$EHe.subtract($EX._tempV31,$EX._tempV30,$EX._tempV33),$EHe.add($EX._tempV33,$EX._tempV32,$EM[3]),$EHe.subtract($EX._tempV30,$EX._tempV31,$EX._tempV33),$EHe.add($EX._tempV33,$EX._tempV32,$EM[4]),$EHe.subtract($EX._tempV30,$EX._tempV31,$EX._tempV33),$EHe.subtract($EX._tempV33,$EX._tempV32,$EM[5]),$EHe.scale($EM[0],-1,$EM[6]),$EHe.subtract($EX._tempV32,$EX._tempV30,$EX._tempV33),$EHe.subtract($EX._tempV33,$EX._tempV31,$EM[7])},$EM.equals=function($EM){return this.extents==$EM.extents&&this.transformation==$EM.transformation},$EM.cloneTo=function($EM){var $Ee=$EM;this.extents.cloneTo($Ee.extents),this.transformation.cloneTo($Ee.transformation)},$EX.createByBoundBox=function($EM,$Ee){var $EL=$EM.min,$E_=$EM.max;$EHe.subtract($E_,$EL,$EX._tempV30),$EHe.scale($EX._tempV30,.5,$EX._tempV30),$EHe.add($EL,$EX._tempV30,$EX._tempV31),$EHe.subtract($E_,$EX._tempV31,$EX._tempV32),$EMe.translation($EX._tempV31,$EX._tempM0);var $Ec=$EX._tempV32.clone(),$Eq=$EX._tempM0.clone();$Ee.extents=$Ec,$Ee.transformation=$Eq},$EX.createByMinAndMaxVertex=function($EM,$Ee){return $EHe.subtract($Ee,$EM,$EX._tempV30),$EHe.scale($EX._tempV30,.5,$EX._tempV30),$EHe.add($EM,$EX._tempV30,$EX._tempV31),$EHe.subtract($Ee,$EX._tempV31,$EX._tempV32),$EMe.translation($EX._tempV31,$EX._tempM0),new $EX($EX._tempV32,$EX._tempM0)},$EX._getRows=function($EM,$Ee){$Ee.length=3;var $EL=$EM.elements,$E_=$Ee[0].elements;$E_[0]=$EL[0],$E_[1]=$EL[1],$E_[2]=$EL[2];var $Ec=$Ee[1].elements;$Ec[0]=$EL[4],$Ec[1]=$EL[5],$Ec[2]=$EL[6];var $Eq=$Ee[2].elements;$Eq[0]=$EL[8],$Eq[1]=$EL[9],$Eq[2]=$EL[10]},$EX.getObbtoObbMatrix4x4=function($EM,$Ee,$EL,$E_){var $Ec=$EM.transformation,$Eq=$Ee.transformation;if($EL){$EX._getRows($Ec,$EX._rows1),$EX._getRows($Eq,$EX._rows2);for(var $EH=0;$EH<3;$EH++)for(var $ET=0;$ET<3;$ET++)$E_.setElementByRowColumn($EH,$ET,$EHe.dot($EX._rows2[$EH],$EX._rows1[$ET]));$Ee.getCenter($EX._tempV30),$EM.getCenter($EX._tempV31),$EHe.subtract($EX._tempV30,$EX._tempV31,$EX._tempV32);var $Ex=$E_.elements;$Ex[12]=$EHe.dot($EX._tempV32,$EX._rows1[0]),$Ex[13]=$EHe.dot($EX._tempV32,$EX._rows1[1]),$Ex[14]=$EHe.dot($EX._tempV32,$EX._rows1[2]),$Ex[15]=1}else $Ec.invert($EX._tempM0),$EMe.multiply($Eq,$EX._tempM0,$E_)},$EX.merge=function($EM,$Ee,$EL){var $E_=$EM.extents,$Ec=$EM.transformation;$EX.getObbtoObbMatrix4x4($EM,$Ee,$EL,$EX._tempM0),$Ee._getLocalCorners($EX._corners),$EHe.transformCoordinate($EX._corners[0],$EX._tempM0,$EX._corners[0]),$EHe.transformCoordinate($EX._corners[1],$EX._tempM0,$EX._corners[1]),$EHe.transformCoordinate($EX._corners[2],$EX._tempM0,$EX._corners[2]),$EHe.transformCoordinate($EX._corners[3],$EX._tempM0,$EX._corners[3]),$EHe.transformCoordinate($EX._corners[4],$EX._tempM0,$EX._corners[4]),$EHe.transformCoordinate($EX._corners[5],$EX._tempM0,$EX._corners[5]),$EHe.transformCoordinate($EX._corners[6],$EX._tempM0,$EX._corners[6]),$EHe.transformCoordinate($EX._corners[7],$EX._tempM0,$EX._corners[7]),$EHe.scale($E_,-1,$EX._boxBound1.min),$E_.cloneTo($EX._boxBound1.max),$ENM.createfromPoints($EX._corners,$EX._boxBound2),$ENM.merge($EX._boxBound2,$EX._boxBound1,$EX._boxBound3);var $Eq=$EX._boxBound3.min,$EH=$EX._boxBound3.max;$EHe.subtract($EH,$Eq,$EX._tempV30),$EHe.scale($EX._tempV30,.5,$EX._tempV30),$EHe.add($Eq,$EX._tempV30,$EX._tempV32),$EHe.subtract($EH,$EX._tempV32,$E_),$EHe.transformCoordinate($EX._tempV32,$Ec,$EX._tempV33)},$EG($EX,["_tempV30",function(){return this._tempV30=new $EHe},"_tempV31",function(){return this._tempV31=new $EHe},"_tempV32",function(){return this._tempV32=new $EHe},"_tempV33",function(){return this._tempV33=new $EHe},"_tempV34",function(){return this._tempV34=new $EHe},"_tempV35",function(){return this._tempV35=new $EHe},"_tempV36",function(){return this._tempV36=new $EHe},"_tempM0",function(){return this._tempM0=new $EMe},"_tempM1",function(){return this._tempM1=new $EMe},"_corners",function(){return this._corners=[new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe]},"_rows1",function(){return this._rows1=[new $EHe,new $EHe,new $EHe]},"_rows2",function(){return this._rows2=[new $EHe,new $EHe,new $EHe]},"_ray",function(){return this._ray=new $Ece(new $EHe,new $EHe)},"_boxBound1",function(){return this._boxBound1=new $ENM(new $EHe,new $EHe)},"_boxBound2",function(){return this._boxBound2=new $ENM(new $EHe,new $EHe)},"_boxBound3",function(){return this._boxBound3=new $ENM(new $EHe,new $EHe)}])}(),function(){function $Ei($EM,$Ee){this.normal=null,this.distance=NaN,void 0===$Ee&&($Ee=0),this.normal=$EM,this.distance=$Ee}return $EE($Ei,"laya.d3.math.Plane"),$Ei.prototype.normalize=function(){var $EM=this.normal.elements,$Ee=$EM[0],$EL=$EM[1],$E_=$EM[2],$Ec=1/Math.sqrt($Ee*$Ee+$EL*$EL+$E_*$E_);$EM[0]=$Ee*$Ec,$EM[1]=$EL*$Ec,$EM[2]=$E_*$Ec,this.distance*=$Ec},$Ei.createPlaneBy3P=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$Ee.elements,$Eq=$EL.elements,$EH=$Ec[0]-$E_[0],$ET=$Ec[1]-$E_[1],$Ex=$Ec[2]-$E_[2],$EO=$Eq[0]-$E_[0],$Eu=$Eq[1]-$E_[1],$EG=$Eq[2]-$E_[2],$EV=$ET*$EG-$Ex*$Eu,$EE=$Ex*$EO-$EH*$EG,$Ed=$EH*$Eu-$ET*$EO,$Er=1/Math.sqrt($EV*$EV+$EE*$EE+$Ed*$Ed),$E$=$EV*$Er,$EC=$EE*$Er,$EK=$Ed*$Er,$EX=$Ei._TEMPVec3.elements;$EX[0]=$E$,$EX[1]=$EC,$EX[2]=$EK;var $Eo=-($E$*$E_[0]+$EC*$E_[1]+$EK*$E_[2]);return new $Ei($Ei._TEMPVec3,$Eo)},$Ei.PlaneIntersectionType_Back=0,$Ei.PlaneIntersectionType_Front=1,$Ei.PlaneIntersectionType_Intersecting=2,$EG($Ei,["_TEMPVec3",function(){return this._TEMPVec3=new $EHe}]),$Ei}()),$ELe=function(){function $Ec($EM,$Ee,$EL,$E_){this.elements=new Float32Array(4),void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=1),this.elements[0]=$EM,this.elements[1]=$Ee,this.elements[2]=$EL,this.elements[3]=$E_}$EE($Ec,"laya.d3.math.Quaternion");var $EM=$Ec.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.scaling=function($EM,$Ee){var $EL=$Ee.elements,$E_=this.elements;$EL[0]=$E_[0]*$EM,$EL[1]=$E_[1]*$EM,$EL[2]=$E_[2]*$EM,$EL[3]=$E_[3]*$EM},$EM.normalize=function($EM){var $Ee=$EM.elements,$EL=this.elements,$E_=$EL[0],$Ec=$EL[1],$Eq=$EL[2],$EH=$EL[3],$ET=$E_*$E_+$Ec*$Ec+$Eq*$Eq+$EH*$EH;0<$ET&&($ET=1/Math.sqrt($ET),$Ee[0]=$E_*$ET,$Ee[1]=$Ec*$ET,$Ee[2]=$Eq*$ET,$Ee[3]=$EH*$ET)},$EM.length=function(){var $EM=this.elements,$Ee=$EM[0],$EL=$EM[1],$E_=$EM[2],$Ec=$EM[3];return Math.sqrt($Ee*$Ee+$EL*$EL+$E_*$E_+$Ec*$Ec)},$EM.rotateX=function($EM,$Ee){var $EL=$Ee.elements,$E_=this.elements;$EM*=.5;var $Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$E_[3],$Ex=Math.sin($EM),$EO=Math.cos($EM);$EL[0]=$Ec*$EO+$ET*$Ex,$EL[1]=$Eq*$EO+$EH*$Ex,$EL[2]=$EH*$EO-$Eq*$Ex,$EL[3]=$ET*$EO-$Ec*$Ex},$EM.rotateY=function($EM,$Ee){var $EL=$Ee.elements,$E_=this.elements;$EM*=.5;var $Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$E_[3],$Ex=Math.sin($EM),$EO=Math.cos($EM);$EL[0]=$Ec*$EO-$EH*$Ex,$EL[1]=$Eq*$EO+$ET*$Ex,$EL[2]=$EH*$EO+$Ec*$Ex,$EL[3]=$ET*$EO-$Eq*$Ex},$EM.rotateZ=function($EM,$Ee){var $EL=$Ee.elements,$E_=this.elements;$EM*=.5;var $Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$E_[3],$Ex=Math.sin($EM),$EO=Math.cos($EM);$EL[0]=$Ec*$EO+$Eq*$Ex,$EL[1]=$Eq*$EO-$Ec*$Ex,$EL[2]=$EH*$EO+$ET*$Ex,$EL[3]=$ET*$EO-$EH*$Ex},$EM.getYawPitchRoll=function($EM){$EHe.transformQuat($EHe.ForwardRH,this,$Ec.TEMPVector31),$EHe.transformQuat($EHe.Up,this,$Ec.TEMPVector32);var $Ee=$Ec.TEMPVector32.elements;$Ec.angleTo($EHe.ZERO,$Ec.TEMPVector31,$Ec.TEMPVector33);var $EL=$Ec.TEMPVector33.elements;$EL[0]==Math.PI/2?($EL[1]=$Ec.arcTanAngle($Ee[2],$Ee[0]),$EL[2]=0):$EL[0]==-Math.PI/2?($EL[1]=$Ec.arcTanAngle(-$Ee[2],-$Ee[0]),$EL[2]=0):($EMe.createRotationY(-$EL[1],$Ec.TEMPMatrix0),$EMe.createRotationX(-$EL[0],$Ec.TEMPMatrix1),$EHe.transformCoordinate($Ec.TEMPVector32,$Ec.TEMPMatrix0,$Ec.TEMPVector32),$EHe.transformCoordinate($Ec.TEMPVector32,$Ec.TEMPMatrix1,$Ec.TEMPVector32),$EL[2]=$Ec.arcTanAngle($Ee[1],-$Ee[0])),$EL[1]<=-Math.PI&&($EL[1]=Math.PI),$EL[2]<=-Math.PI&&($EL[2]=Math.PI),$EL[1]>=Math.PI&&$EL[2]>=Math.PI&&($EL[1]=0,$EL[2]=0,$EL[0]=Math.PI-$EL[0]);var $E_=$EM.elements;$E_[0]=$EL[1],$E_[1]=$EL[0],$E_[2]=$EL[2]},$EM.invert=function($EM){var $Ee=$EM.elements,$EL=this.elements,$E_=$EL[0],$Ec=$EL[1],$Eq=$EL[2],$EH=$EL[3],$ET=$E_*$E_+$Ec*$Ec+$Eq*$Eq+$EH*$EH,$Ex=$ET?1/$ET:0;$Ee[0]=-$E_*$Ex,$Ee[1]=-$Ec*$Ex,$Ee[2]=-$Eq*$Ex,$Ee[3]=$EH*$Ex},$EM.identity=function(){var $EM=this.elements;$EM[0]=0,$EM[1]=0,$EM[2]=0,$EM[3]=1},$EM.fromArray=function($EM,$Ee){void 0===$Ee&&($Ee=0),this.elements[0]=$EM[$Ee+0],this.elements[1]=$EM[$Ee+1],this.elements[2]=$EM[$Ee+2],this.elements[3]=$EM[$Ee+3]},$EM.cloneTo=function($EM){var $Ee,$EL,$E_;if(($EL=this.elements)!==($E_=$EM.elements))for($Ee=0;$Ee<4;++$Ee)$E_[$Ee]=$EL[$Ee]},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$EM.equals=function($EM){var $Ee=this.elements,$EL=$EM.elements;return $EUM.nearEqual($Ee[0],$EL[0])&&$EUM.nearEqual($Ee[1],$EL[1])&&$EUM.nearEqual($Ee[2],$EL[2])&&$EUM.nearEqual($Ee[3],$EL[3])},$EM.lengthSquared=function(){var $EM=this.elements[0],$Ee=this.elements[1],$EL=this.elements[2],$E_=this.elements[3];return $EM*$EM+$Ee*$Ee+$EL*$EL+$E_*$E_},$Ed(0,$EM,"x",function(){return this.elements[0]}),$Ed(0,$EM,"y",function(){return this.elements[1]}),$Ed(0,$EM,"z",function(){return this.elements[2]}),$Ed(0,$EM,"w",function(){return this.elements[3]}),$Ec.createFromYawPitchRoll=function($EM,$Ee,$EL,$E_){var $Ec=.5*$EL,$Eq=.5*$Ee,$EH=.5*$EM,$ET=Math.sin($Ec),$Ex=Math.cos($Ec),$EO=Math.sin($Eq),$Eu=Math.cos($Eq),$EG=Math.sin($EH),$EV=Math.cos($EH),$EE=$E_.elements;$EE[0]=$EV*$EO*$Ex+$EG*$Eu*$ET,$EE[1]=$EG*$Eu*$Ex-$EV*$EO*$ET,$EE[2]=$EV*$Eu*$ET-$EG*$EO*$Ex,$EE[3]=$EV*$Eu*$Ex+$EG*$EO*$ET},$Ec.multiply=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$Ee.elements,$Eq=$EL.elements,$EH=$E_[0],$ET=$E_[1],$Ex=$E_[2],$EO=$E_[3],$Eu=$Ec[0],$EG=$Ec[1],$EV=$Ec[2],$EE=$Ec[3],$Ed=$ET*$EV-$Ex*$EG,$Er=$Ex*$Eu-$EH*$EV,$E$=$EH*$EG-$ET*$Eu,$EC=$EH*$Eu+$ET*$EG+$Ex*$EV;$Eq[0]=$EH*$EE+$Eu*$EO+$Ed,$Eq[1]=$ET*$EE+$EG*$EO+$Er,$Eq[2]=$Ex*$EE+$EV*$EO+$E$,$Eq[3]=$EO*$EE-$EC},$Ec.arcTanAngle=function($EM,$Ee){return 0==$EM?1==$Ee?Math.PI/2:-Math.PI/2:0<$EM?Math.atan($Ee/$EM):$EM<0?0<$Ee?Math.atan($Ee/$EM)+Math.PI:Math.atan($Ee/$EM)-Math.PI:0},$Ec.angleTo=function($EM,$Ee,$EL){$EHe.subtract($Ee,$EM,$Ec.TEMPVector30),$EHe.normalize($Ec.TEMPVector30,$Ec.TEMPVector30),$EL.elements[0]=Math.asin($Ec.TEMPVector30.y),$EL.elements[1]=$Ec.arcTanAngle(-$Ec.TEMPVector30.z,-$Ec.TEMPVector30.x)},$Ec.createFromAxisAngle=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements;$Ee*=.5;var $Eq=Math.sin($Ee);$E_[0]=$Eq*$Ec[0],$E_[1]=$Eq*$Ec[1],$E_[2]=$Eq*$Ec[2],$E_[3]=Math.cos($Ee)},$Ec.createFromMatrix3x3=function($EM,$Ee){var $EL,$E_=$Ee.elements,$Ec=$EM.elements,$Eq=$Ec[0]+$Ec[4]+$Ec[8];if(0<$Eq)$EL=Math.sqrt($Eq+1),$E_[3]=.5*$EL,$EL=.5/$EL,$E_[0]=($Ec[5]-$Ec[7])*$EL,$E_[1]=($Ec[6]-$Ec[2])*$EL,$E_[2]=($Ec[1]-$Ec[3])*$EL;else{var $EH=0;$Ec[4]>$Ec[0]&&($EH=1),$Ec[8]>$Ec[3*$EH+$EH]&&($EH=2);var $ET=($EH+1)%3,$Ex=($EH+2)%3;$EL=Math.sqrt($Ec[3*$EH+$EH]-$Ec[3*$ET+$ET]-$Ec[3*$Ex+$Ex]+1),$E_[$EH]=.5*$EL,$EL=.5/$EL,$E_[3]=($Ec[3*$ET+$Ex]-$Ec[3*$Ex+$ET])*$EL,$E_[$ET]=($Ec[3*$ET+$EH]+$Ec[3*$EH+$ET])*$EL,$E_[$Ex]=($Ec[3*$Ex+$EH]+$Ec[3*$EH+$Ex])*$EL}},$Ec.createFromMatrix4x4=function($EM,$Ee){var $EL,$E_,$Ec=$EM.elements,$Eq=$Ee.elements,$EH=$Ec[0]+$Ec[5]+$Ec[10];0<$EH?($EL=Math.sqrt($EH+1),$Eq[3]=.5*$EL,$EL=.5/$EL,$Eq[0]=($Ec[6]-$Ec[9])*$EL,$Eq[1]=($Ec[8]-$Ec[2])*$EL,$Eq[2]=($Ec[1]-$Ec[4])*$EL):$Ec[0]>=$Ec[5]&&$Ec[0]>=$Ec[10]?($E_=.5/($EL=Math.sqrt(1+$Ec[0]-$Ec[5]-$Ec[10])),$Eq[0]=.5*$EL,$Eq[1]=($Ec[1]+$Ec[4])*$E_,$Eq[2]=($Ec[2]+$Ec[8])*$E_,$Eq[3]=($Ec[6]-$Ec[9])*$E_):$Ec[5]>$Ec[10]?($E_=.5/($EL=Math.sqrt(1+$Ec[5]-$Ec[0]-$Ec[10])),$Eq[0]=($Ec[4]+$Ec[1])*$E_,$Eq[1]=.5*$EL,$Eq[2]=($Ec[9]+$Ec[6])*$E_,$Eq[3]=($Ec[8]-$Ec[2])*$E_):($E_=.5/($EL=Math.sqrt(1+$Ec[10]-$Ec[0]-$Ec[5])),$Eq[0]=($Ec[8]+$Ec[2])*$E_,$Eq[1]=($Ec[9]+$Ec[6])*$E_,$Eq[2]=.5*$EL,$Eq[3]=($Ec[1]-$Ec[4])*$E_)},$Ec.slerp=function($EM,$Ee,$EL,$E_){var $Ec,$Eq,$EH,$ET,$Ex,$EO=$EM.elements,$Eu=$Ee.elements,$EG=$E_.elements,$EV=$EO[0],$EE=$EO[1],$Ed=$EO[2],$Er=$EO[3],$E$=$Eu[0],$EC=$Eu[1],$EK=$Eu[2],$EX=$Eu[3];return($Eq=$EV*$E$+$EE*$EC+$Ed*$EK+$Er*$EX)<0&&($Eq=-$Eq,$E$=-$E$,$EC=-$EC,$EK=-$EK,$EX=-$EX),$Ex=1e-6<1-$Eq?($Ec=Math.acos($Eq),$EH=Math.sin($Ec),$ET=Math.sin((1-$EL)*$Ec)/$EH,Math.sin($EL*$Ec)/$EH):($ET=1-$EL,$EL),$EG[0]=$ET*$EV+$Ex*$E$,$EG[1]=$ET*$EE+$Ex*$EC,$EG[2]=$ET*$Ed+$Ex*$EK,$EG[3]=$ET*$Er+$Ex*$EX,$EG},$Ec.lerp=function($EM,$Ee,$EL,$E_){var $Ec=$E_.elements,$Eq=$EM.elements,$EH=$Ee.elements,$ET=$Eq[0],$Ex=$Eq[1],$EO=$Eq[2],$Eu=$Eq[3];$Ec[0]=$ET+$EL*($EH[0]-$ET),$Ec[1]=$Ex+$EL*($EH[1]-$Ex),$Ec[2]=$EO+$EL*($EH[2]-$EO),$Ec[3]=$Eu+$EL*($EH[3]-$Eu)},$Ec.add=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=$Ec[0]+$Eq[0],$E_[1]=$Ec[1]+$Eq[1],$E_[2]=$Ec[2]+$Eq[2],$E_[3]=$Ec[3]+$Eq[3]},$Ec.dot=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;return $EL[0]*$E_[0]+$EL[1]*$E_[1]+$EL[2]*$E_[2]+$EL[3]*$E_[3]},$Ec.rotationLookAt=function($EM,$Ee,$EL){$Ec.lookAt($EHe.ZERO,$EM,$Ee,$EL)},$Ec.lookAt=function($EM,$Ee,$EL,$E_){$EIM.lookAt($EM,$Ee,$EL,$Ec._tempMatrix3x3),$Ec.rotationMatrix($Ec._tempMatrix3x3,$E_)},$Ec.invert=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EM.lengthSquared();$EUM.isZero($Ec)||($Ec=1/$Ec,$E_[0]=-$EL[0]*$Ec,$E_[1]=-$EL[1]*$Ec,$E_[2]=-$EL[2]*$Ec,$E_[3]=$EL[3]*$Ec)},$Ec.rotationMatrix=function($EM,$Ee){var $EL=$EM.elements,$E_=$EL[0],$Ec=$EL[1],$Eq=$EL[2],$EH=$EL[3],$ET=$EL[4],$Ex=$EL[5],$EO=$EL[6],$Eu=$EL[7],$EG=$EL[8],$EV=$Ee.elements,$EE=NaN,$Ed=NaN,$Er=$E_+$ET+$EG;0<$Er?($EE=Math.sqrt($Er+1),$EV[3]=.5*$EE,$EE=.5/$EE,$EV[0]=($Ex-$Eu)*$EE,$EV[1]=($EO-$Eq)*$EE,$EV[2]=($Ec-$EH)*$EE):$ET<=$E_&&$EG<=$E_?($Ed=.5/($EE=Math.sqrt(1+$E_-$ET-$EG)),$EV[0]=.5*$EE,$EV[1]=($Ec+$EH)*$Ed,$EV[2]=($Eq+$EO)*$Ed,$EV[3]=($Ex-$Eu)*$Ed):$EG<$ET?($Ed=.5/($EE=Math.sqrt(1+$ET-$E_-$EG)),$EV[0]=($EH+$Ec)*$Ed,$EV[1]=.5*$EE,$EV[2]=($Eu+$Ex)*$Ed,$EV[3]=($EO-$Eq)*$Ed):($Ed=.5/($EE=Math.sqrt(1+$EG-$E_-$ET)),$EV[0]=($EO+$Eq)*$Ed,$EV[1]=($Eu+$Ex)*$Ed,$EV[2]=.5*$EE,$EV[3]=($Ec-$EH)*$Ed)},$Ec.DEFAULT=new $Ec,$EG($Ec,["TEMPVector30",function(){return this.TEMPVector30=new $EHe},"TEMPVector31",function(){return this.TEMPVector31=new $EHe},"TEMPVector32",function(){return this.TEMPVector32=new $EHe},"TEMPVector33",function(){return this.TEMPVector33=new $EHe},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $EMe},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $EMe},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $EIM},"NAN",function(){return this.NAN=new $Ec(NaN,NaN,NaN,NaN)}]),$Ec}(),$E_e=function(){function $EM($EM){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$EM,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$EE($EM,"laya.d3.math.Rand");var $Ee=$EM.prototype;return $Ee.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$Ee.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$Ee.getSignedFloat=function(){return 2*this.getFloat()-1},$Ed(0,$Ee,"seed",function(){return this.seeds[0]},function($EM){this.seeds[0]=$EM,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$EM.getFloatFromInt=function($EM){return 1/8388607*(8388607&$EM)},$EM.getByteFromInt=function($EM){return(8388607&$EM)>>>15},$EM}(),$Ece=(function(){function $Ec($EM){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($EM instanceof Array)||4!==$EM.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$EM[0],this._state0L=0|$EM[1],this._state1U=0|$EM[2],this._state1L=0|$EM[3]}$EE($Ec,"laya.d3.math.RandX");var $EM=$Ec.prototype;$EM.randomint=function(){var $EM=this._state0U,$Ee=this._state0L,$EL=this._state1U,$E_=this._state1L,$Ec=($E_>>>0)+($Ee>>>0),$Eq=$EL+$EM+($Ec/2>>>31)>>>0,$EH=$Ec>>>0,$ET=0,$Ex=0;$ET=($EM^=$ET=$EM<<23|(-512&$Ee)>>>9)^(this._state0U=$EL),$Ex=($Ee^=$Ex=$Ee<<23)^(this._state0L=$E_);$ET^=$EM>>>18,$Ex^=$Ee>>>18|(262143&$EM)<<14;return $ET^=$EL>>>5,$Ex^=$E_>>>5|(31&$EL)<<27,this._state1U=$ET,this._state1L=$Ex,[$Eq,$EH]},$EM.random=function(){var $EM=this.randomint(),$Ee=$EM[0],$EL=1023<<20|$Ee>>>12,$E_=0|($EM[1]>>>12|(4095&$Ee)<<20);return $Ec._CONVERTION_BUFFER.setUint32(0,$EL,!1),$Ec._CONVERTION_BUFFER.setUint32(4,$E_,!1),$E_e._CONVERTION_BUFFER.getFloat64(0,!1)-1},$EG($Ec,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $E_e([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $EM($EM,$Ee){this.origin=null,this.direction=null,this.origin=$EM,this.direction=$Ee}return $EE($EM,"laya.d3.math.Ray"),$EM}()),$Eqe=function(){function $EM($EM,$Ee){this.elements=new Float32Array(2),void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0);var $EL=this.elements;$EL[0]=$EM,$EL[1]=$Ee}$EE($EM,"laya.d3.math.Vector2");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.fromArray=function($EM,$Ee){void 0===$Ee&&($Ee=0),this.elements[0]=$EM[$Ee+0],this.elements[1]=$EM[$Ee+1]},$Ee.cloneTo=function($EM){var $Ee=$EM.elements,$EL=this.elements;$Ee[0]=$EL[0],$Ee[1]=$EL[1]},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"x",function(){return this.elements[0]},function($EM){this.elements[0]=$EM}),$Ed(0,$Ee,"y",function(){return this.elements[1]},function($EM){this.elements[1]=$EM}),$EM.scale=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements;$E_[0]=$Ec[0]*$Ee,$E_[1]=$Ec[1]*$Ee},$EG($EM,["ZERO",function(){return this.ZERO=new $EM(0,0)},"ONE",function(){return this.ONE=new $EM(1,1)}]),$EM}(),$EHe=function(){function $Eu($EM,$Ee,$EL){this.elements=new Float32Array(3),void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0);var $E_=this.elements;$E_[0]=$EM,$E_[1]=$Ee,$E_[2]=$EL}$EE($Eu,"laya.d3.math.Vector3");var $EM=$Eu.prototype;return $Ei.imps($EM,{"laya.d3.core.IClone":!0}),$EM.fromArray=function($EM,$Ee){void 0===$Ee&&($Ee=0),this.elements[0]=$EM[$Ee+0],this.elements[1]=$EM[$Ee+1],this.elements[2]=$EM[$Ee+2]},$EM.cloneTo=function($EM){var $Ee=$EM.elements,$EL=this.elements;$Ee[0]=$EL[0],$Ee[1]=$EL[1],$Ee[2]=$EL[2]},$EM.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$EM.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$EM.reset=function($EM,$Ee,$EL){this.elements[0]=$EM,this.elements[1]=$Ee,this.elements[2]=$EL},$Ed(0,$EM,"x",function(){return this.elements[0]},function($EM){this.elements[0]=$EM}),$Ed(0,$EM,"y",function(){return this.elements[1]},function($EM){this.elements[1]=$EM}),$Ed(0,$EM,"z",function(){return this.elements[2]},function($EM){this.elements[2]=$EM}),$Eu.distanceSquared=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EL[0]-$E_[0],$Eq=$EL[1]-$E_[1],$EH=$EL[2]-$E_[2];return $Ec*$Ec+$Eq*$Eq+$EH*$EH},$Eu.distance=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EL[0]-$E_[0],$Eq=$EL[1]-$E_[1],$EH=$EL[2]-$E_[2];return Math.sqrt($Ec*$Ec+$Eq*$Eq+$EH*$EH)},$Eu.min=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=Math.min($Ec[0],$Eq[0]),$E_[1]=Math.min($Ec[1],$Eq[1]),$E_[2]=Math.min($Ec[2],$Eq[2])},$Eu.max=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=Math.max($Ec[0],$Eq[0]),$E_[1]=Math.max($Ec[1],$Eq[1]),$E_[2]=Math.max($Ec[2],$Eq[2])},$Eu.transformQuat=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements,$EH=$Ec[0],$ET=$Ec[1],$Ex=$Ec[2],$EO=$Eq[0],$Eu=$Eq[1],$EG=$Eq[2],$EV=$Eq[3],$EE=$EV*$EH+$Eu*$Ex-$EG*$ET,$Ed=$EV*$ET+$EG*$EH-$EO*$Ex,$Er=$EV*$Ex+$EO*$ET-$Eu*$EH,$E$=-$EO*$EH-$Eu*$ET-$EG*$Ex;$E_[0]=$EE*$EV+$E$*-$EO+$Ed*-$EG-$Er*-$Eu,$E_[1]=$Ed*$EV+$E$*-$Eu+$Er*-$EO-$EE*-$EG,$E_[2]=$Er*$EV+$E$*-$EG+$EE*-$Eu-$Ed*-$EO},$Eu.scalarLength=function($EM){var $Ee=$EM.elements,$EL=$Ee[0],$E_=$Ee[1],$Ec=$Ee[2];return Math.sqrt($EL*$EL+$E_*$E_+$Ec*$Ec)},$Eu.scalarLengthSquared=function($EM){var $Ee=$EM.elements,$EL=$Ee[0],$E_=$Ee[1],$Ec=$Ee[2];return $EL*$EL+$E_*$E_+$Ec*$Ec},$Eu.normalize=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EL[0],$Eq=$EL[1],$EH=$EL[2],$ET=$Ec*$Ec+$Eq*$Eq+$EH*$EH;0<$ET&&($ET=1/Math.sqrt($ET),$E_[0]=$EL[0]*$ET,$E_[1]=$EL[1]*$ET,$E_[2]=$EL[2]*$ET)},$Eu.multiply=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=$Ec[0]*$Eq[0],$E_[1]=$Ec[1]*$Eq[1],$E_[2]=$Ec[2]*$Eq[2]},$Eu.scale=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements;$E_[0]=$Ec[0]*$Ee,$E_[1]=$Ec[1]*$Ee,$E_[2]=$Ec[2]*$Ee},$Eu.lerp=function($EM,$Ee,$EL,$E_){var $Ec=$E_.elements,$Eq=$EM.elements,$EH=$Ee.elements,$ET=$Eq[0],$Ex=$Eq[1],$EO=$Eq[2];$Ec[0]=$ET+$EL*($EH[0]-$ET),$Ec[1]=$Ex+$EL*($EH[1]-$Ex),$Ec[2]=$EO+$EL*($EH[2]-$EO)},$Eu.transformV3ToV3=function($EM,$Ee,$EL){var $E_=$Eu._tempVector4;$Eu.transformV3ToV4($EM,$Ee,$E_);var $Ec=$E_.elements,$Eq=$EL.elements;$Eq[0]=$Ec[0],$Eq[1]=$Ec[1],$Eq[2]=$Ec[2]},$Eu.transformV3ToV4=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$Ee.elements,$Ex=$EL.elements;$Ex[0]=$Ec*$ET[0]+$Eq*$ET[4]+$EH*$ET[8]+$ET[12],$Ex[1]=$Ec*$ET[1]+$Eq*$ET[5]+$EH*$ET[9]+$ET[13],$Ex[2]=$Ec*$ET[2]+$Eq*$ET[6]+$EH*$ET[10]+$ET[14],$Ex[3]=$Ec*$ET[3]+$Eq*$ET[7]+$EH*$ET[11]+$ET[15]},$Eu.TransformNormal=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$Ee.elements,$Ex=$EL.elements;$Ex[0]=$Ec*$ET[0]+$Eq*$ET[4]+$EH*$ET[8],$Ex[1]=$Ec*$ET[1]+$Eq*$ET[5]+$EH*$ET[9],$Ex[2]=$Ec*$ET[2]+$Eq*$ET[6]+$EH*$ET[10]},$Eu.transformCoordinate=function($EM,$Ee,$EL){var $E_=$Eu._tempVector4.elements,$Ec=$EM.elements,$Eq=$Ec[0],$EH=$Ec[1],$ET=$Ec[2],$Ex=$Ee.elements;$E_[0]=$Eq*$Ex[0]+$EH*$Ex[4]+$ET*$Ex[8]+$Ex[12],$E_[1]=$Eq*$Ex[1]+$EH*$Ex[5]+$ET*$Ex[9]+$Ex[13],$E_[2]=$Eq*$Ex[2]+$EH*$Ex[6]+$ET*$Ex[10]+$Ex[14],$E_[3]=1/($Eq*$Ex[3]+$EH*$Ex[7]+$ET*$Ex[11]+$Ex[15]);var $EO=$EL.elements;$EO[0]=$E_[0]*$E_[3],$EO[1]=$E_[1]*$E_[3],$EO[2]=$E_[2]*$E_[3]},$Eu.Clamp=function($EM,$Ee,$EL,$E_){var $Ec=$EM.elements,$Eq=$Ec[0],$EH=$Ec[1],$ET=$Ec[2],$Ex=$Ee.elements,$EO=$Ex[0],$Eu=$Ex[1],$EG=$Ex[2],$EV=$EL.elements,$EE=$EV[0],$Ed=$EV[1],$Er=$EV[2],$E$=$E_.elements;$Eq=($Eq=$EE<$Eq?$EE:$Eq)<$EO?$EO:$Eq,$EH=($EH=$Ed<$EH?$Ed:$EH)<$Eu?$Eu:$EH,$ET=($ET=$Er<$ET?$Er:$ET)<$EG?$EG:$ET,$E$[0]=$Eq,$E$[1]=$EH,$E$[2]=$ET},$Eu.add=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=$Ec[0]+$Eq[0],$E_[1]=$Ec[1]+$Eq[1],$E_[2]=$Ec[2]+$Eq[2]},$Eu.subtract=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=$Ec[0]-$Eq[0],$E_[1]=$Ec[1]-$Eq[1],$E_[2]=$Ec[2]-$Eq[2]},$Eu.cross=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$Ee.elements,$Eq=$EL.elements,$EH=$E_[0],$ET=$E_[1],$Ex=$E_[2],$EO=$Ec[0],$Eu=$Ec[1],$EG=$Ec[2];$Eq[0]=$ET*$EG-$Ex*$Eu,$Eq[1]=$Ex*$EO-$EH*$EG,$Eq[2]=$EH*$Eu-$ET*$EO},$Eu.dot=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;return $EL[0]*$E_[0]+$EL[1]*$E_[1]+$EL[2]*$E_[2]},$Eu.equals=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;return $EUM.nearEqual(Math.abs($EL[0]),Math.abs($E_[0]))&&$EUM.nearEqual(Math.abs($EL[1]),Math.abs($E_[1]))&&$EUM.nearEqual(Math.abs($EL[2]),Math.abs($E_[2]))},$Eu.ZERO=new $Eu(0,0,0),$Eu.ONE=new $Eu(1,1,1),$Eu.NegativeUnitX=new $Eu(-1,0,0),$Eu.UnitX=new $Eu(1,0,0),$Eu.UnitY=new $Eu(0,1,0),$Eu.UnitZ=new $Eu(0,0,1),$Eu.ForwardRH=new $Eu(0,0,-1),$Eu.ForwardLH=new $Eu(0,0,1),$Eu.Up=new $Eu(0,1,0),$Eu.NAN=new $Eu(NaN,NaN,NaN),$EG($Eu,["_tempVector4",function(){return this._tempVector4=new $ETe}]),$Eu}(),$ETe=function(){function $EM($EM,$Ee,$EL,$E_){this.elements=new Float32Array(4),void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=0);var $Ec=this.elements;$Ec[0]=$EM,$Ec[1]=$Ee,$Ec[2]=$EL,$Ec[3]=$E_}$EE($EM,"laya.d3.math.Vector4");var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee.fromArray=function($EM,$Ee){void 0===$Ee&&($Ee=0),this.elements[0]=$EM[$Ee+0],this.elements[1]=$EM[$Ee+1],this.elements[2]=$EM[$Ee+2],this.elements[3]=$EM[$Ee+3]},$Ee.cloneTo=function($EM){var $Ee=$EM.elements,$EL=this.elements;$Ee[0]=$EL[0],$Ee[1]=$EL[1],$Ee[2]=$EL[2],$Ee[3]=$EL[3]},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ee.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$Ee.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$Ed(0,$Ee,"x",function(){return this.elements[0]},function($EM){this.elements[0]=$EM}),$Ed(0,$Ee,"y",function(){return this.elements[1]},function($EM){this.elements[1]=$EM}),$Ed(0,$Ee,"z",function(){return this.elements[2]},function($EM){this.elements[2]=$EM}),$Ed(0,$Ee,"w",function(){return this.elements[3]},function($EM){this.elements[3]=$EM}),$EM.lerp=function($EM,$Ee,$EL,$E_){var $Ec=$E_.elements,$Eq=$EM.elements,$EH=$Ee.elements,$ET=$Eq[0],$Ex=$Eq[1],$EO=$Eq[2],$Eu=$Eq[3];$Ec[0]=$ET+$EL*($EH[0]-$ET),$Ec[1]=$Ex+$EL*($EH[1]-$Ex),$Ec[2]=$EO+$EL*($EH[2]-$EO),$Ec[3]=$Eu+$EL*($EH[3]-$Eu)},$EM.transformByM4x4=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$E_[0],$Eq=$E_[1],$EH=$E_[2],$ET=$E_[3],$Ex=$Ee.elements,$EO=$EL.elements;$EO[0]=$Ec*$Ex[0]+$Eq*$Ex[4]+$EH*$Ex[8]+$ET*$Ex[12],$EO[1]=$Ec*$Ex[1]+$Eq*$Ex[5]+$EH*$Ex[9]+$ET*$Ex[13],$EO[2]=$Ec*$Ex[2]+$Eq*$Ex[6]+$EH*$Ex[10]+$ET*$Ex[14],$EO[3]=$Ec*$Ex[3]+$Eq*$Ex[7]+$EH*$Ex[11]+$ET*$Ex[15]},$EM.equals=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;return $EUM.nearEqual(Math.abs($EL[0]),Math.abs($E_[0]))&&$EUM.nearEqual(Math.abs($EL[1]),Math.abs($E_[1]))&&$EUM.nearEqual(Math.abs($EL[2]),Math.abs($E_[2]))&&$EUM.nearEqual(Math.abs($EL[3]),Math.abs($E_[3]))},$EM.normalize=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EM.length();0<$Ec&&($E_[0]=$EL[0]*$Ec,$E_[1]=$EL[1]*$Ec,$E_[2]=$EL[2]*$Ec,$E_[3]=$EL[3]*$Ec)},$EM.add=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=$Ec[0]+$Eq[0],$E_[1]=$Ec[1]+$Eq[1],$E_[2]=$Ec[2]+$Eq[2],$E_[3]=$Ec[3]+$Eq[3]},$EM.subtract=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=$Ec[0]-$Eq[0],$E_[1]=$Ec[1]-$Eq[1],$E_[2]=$Ec[2]-$Eq[2],$E_[3]=$Ec[3]-$Eq[3]},$EM.multiply=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=$Ec[0]*$Eq[0],$E_[1]=$Ec[1]*$Eq[1],$E_[2]=$Ec[2]*$Eq[2],$E_[3]=$Ec[3]*$Eq[3]},$EM.scale=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements;$E_[0]=$Ec[0]*$Ee,$E_[1]=$Ec[1]*$Ee,$E_[2]=$Ec[2]*$Ee,$E_[3]=$Ec[3]*$Ee},$EM.Clamp=function($EM,$Ee,$EL,$E_){var $Ec=$EM.elements,$Eq=$Ec[0],$EH=$Ec[1],$ET=$Ec[2],$Ex=$Ec[3],$EO=$Ee.elements,$Eu=$EO[0],$EG=$EO[1],$EV=$EO[2],$EE=$EO[3],$Ed=$EL.elements,$Er=$Ed[0],$E$=$Ed[1],$EC=$Ed[2],$EK=$Ed[3],$EX=$E_.elements;$Eq=($Eq=$Er<$Eq?$Er:$Eq)<$Eu?$Eu:$Eq,$EH=($EH=$E$<$EH?$E$:$EH)<$EG?$EG:$EH,$ET=($ET=$EC<$ET?$EC:$ET)<$EV?$EV:$ET,$Ex=($Ex=$EK<$Ex?$EK:$Ex)<$EE?$EE:$Ex,$EX[0]=$Eq,$EX[1]=$EH,$EX[2]=$ET,$EX[3]=$Ex},$EM.distanceSquared=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EL[0]-$E_[0],$Eq=$EL[1]-$E_[1],$EH=$EL[2]-$E_[2],$ET=$EL[3]-$E_[3];return $Ec*$Ec+$Eq*$Eq+$EH*$EH+$ET*$ET},$EM.distance=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements,$Ec=$EL[0]-$E_[0],$Eq=$EL[1]-$E_[1],$EH=$EL[2]-$E_[2],$ET=$EL[3]-$E_[3];return Math.sqrt($Ec*$Ec+$Eq*$Eq+$EH*$EH+$ET*$ET)},$EM.dot=function($EM,$Ee){var $EL=$EM.elements,$E_=$Ee.elements;return $EL[0]*$E_[0]+$EL[1]*$E_[1]+$EL[2]*$E_[2]+$EL[3]*$E_[3]},$EM.min=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=Math.min($Ec[0],$Eq[0]),$E_[1]=Math.min($Ec[1],$Eq[1]),$E_[2]=Math.min($Ec[2],$Eq[2]),$E_[3]=Math.min($Ec[3],$Eq[3])},$EM.max=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee.elements;$E_[0]=Math.max($Ec[0],$Eq[0]),$E_[1]=Math.max($Ec[1],$Eq[1]),$E_[2]=Math.max($Ec[2],$Eq[2]),$E_[3]=Math.max($Ec[3],$Eq[3])},$EG($EM,["ZERO",function(){return this.ZERO=new $EM},"ONE",function(){return this.ONE=new $EM(1,1,1,1)},"UnitX",function(){return this.UnitX=new $EM(1,0,0,0)},"UnitY",function(){return this.UnitY=new $EM(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $EM(0,0,1,0)},"UnitW",function(){return this.UnitW=new $EM(0,0,0,1)}]),$EM}(),$Exe=function(){function $Eq($EM,$Ee,$EL,$E_){this.minDepth=0,this.maxDepth=1,this.x=$EM,this.y=$Ee,this.width=$EL,this.height=$E_}$EE($Eq,"laya.d3.math.Viewport");var $EM=$Eq.prototype;return $EM.project=function($EM,$Ee,$EL){$EHe.transformV3ToV3($EM,$Ee,$EL);var $E_=$EM.elements,$Ec=$Ee.elements,$Eq=$EL.elements,$EH=$E_[0]*$Ec[3]+$E_[1]*$Ec[7]+$E_[2]*$Ec[11]+$Ec[15];1!==$EH&&($Eq[0]=$Eq[0]/$EH,$Eq[1]=$Eq[1]/$EH,$Eq[2]=$Eq[2]/$EH),$Eq[0]=.5*($Eq[0]+1)*this.width+this.x,$Eq[1]=.5*(1-$Eq[1])*this.height+this.y,$Eq[2]=$Eq[2]*(this.maxDepth-this.minDepth)+this.minDepth},$EM.unprojectFromMat=function($EM,$Ee,$EL){var $E_=$EM.elements,$Ec=$Ee.elements,$Eq=$EL.elements;$Eq[0]=($E_[0]-this.x)/this.width*2-1,$Eq[1]=-(($E_[1]-this.y)/this.height*2-1);var $EH=(this.maxDepth-this.minDepth)/2;$Eq[2]=($E_[2]-this.minDepth-$EH)/$EH;var $ET=$Eq[0]*$Ec[3]+$Eq[1]*$Ec[7]+$Eq[2]*$Ec[11]+$Ec[15];$EHe.transformV3ToV3($EL,$Ee,$EL),1!==$ET&&($Eq[0]=$Eq[0]/$ET,$Eq[1]=$Eq[1]/$ET,$Eq[2]=$Eq[2]/$ET)},$EM.unprojectFromWVP=function($EM,$Ee,$EL,$E_,$Ec){$EMe.multiply($Ee,$EL,$Eq._tempMatrix4x4),$E_&&$EMe.multiply($Eq._tempMatrix4x4,$E_,$Eq._tempMatrix4x4),$Eq._tempMatrix4x4.invert($Eq._tempMatrix4x4),this.unprojectFromMat($EM,$Eq._tempMatrix4x4,$Ec)},$EG($Eq,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $EMe}]),$Eq}(),$EOe=function(){function $Et($EM){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$EM,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$EE($Et,"laya.d3.resource.models.SubMesh");var $EM=$Et.prototype;return $Ei.imps($EM,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$EM._getVertexBuffer=function($EM){return void 0===$EM&&($EM=0),0===$EM?this._vertexBuffer:null},$EM._getIndexBuffer=function(){return this._indexBuffer},$EM._getStaticBatchBakedVertexs=function($EM,$Ee){var $EL,$E_,$Ec=this._vertexBuffer,$Eq=$Ec.vertexDeclaration,$EH=$Eq.getVertexElementByUsage(0).offset/4,$ET=$Eq.getVertexElementByUsage(3).offset/4,$Ex=$Ee.meshRender.lightmapScaleOffset,$EO=0,$Eu=0,$EG=0,$EV=0,$EE=0,$Ed=0;if($Ex)if($E_=$Eq.getVertexElementByUsage(15))$EG=$Eq.vertexStride/4,$EL=0<this._vertexCount?$Ec.getData().slice(this._vertexStart*$EG,(this._vertexStart+this._vertexCount)*$EG):$Ec.getData().slice(),$EV=$E_.offset/4;else{$EG=($Ed=$Eq.vertexStride/4)+2,$EL=this._vertexCount?new Float32Array(this._vertexCount*($Ec.vertexDeclaration.vertexStride/4+2)):new Float32Array($Ec.vertexCount*($Ec.vertexDeclaration.vertexStride/4+2)),$EV=($EE=$Eq.getVertexElementByUsage(2).offset/4)+2;var $Er=$Ec.getData();for($EO=0,$Eu=$Er.length/$Ed;$EO<$Eu;$EO++){var $E$=0;$E$=0<this._vertexCount?(this._vertexStart+$EO)*$Ed:$EO*$Ed;var $EC=$EO*$EG,$EK=0;for($EK=0;$EK<$EV;$EK++)$EL[$EC+$EK]=$Er[$E$+$EK];for($EK=$EV;$EK<$Ed;$EK++)$EL[$EC+$EK+2]=$Er[$E$+$EK]}}else $EG=$Eq.vertexStride/4,$EL=this._vertexCount?$Ec.getData().slice(this._vertexStart*$EG,(this._vertexStart+this._vertexCount)*$EG):$Ec.getData().slice();if($EM){var $EX=$EM.worldMatrix,$Eo=$Et._tempMatrix4x40;$EX.invert($Eo);var $Ei=$Et._tempMatrix4x41,$EW=$Ee.transform.worldMatrix;$EMe.multiply($Eo,$EW,$Ei)}else $Ei=$Ee.transform.worldMatrix;var $Ey=$Et._tempQuaternion0;for($Ei.decomposeTransRotScale($Et._tempVector30,$Ey,$Et._tempVector31),$EO=0,$Eu=$EL.length/$EG;$EO<$Eu;$EO++){var $EA=$EO*$EG+$EH,$EB=$EO*$EG+$ET;if($E$e.transformVector3ArrayToVector3ArrayCoordinate($EL,$EA,$Ei,$EL,$EA),$E$e.transformVector3ArrayByQuat($EL,$EB,$Ey,$EL,$EB),$Ex){var $Ek=$EO*$EG+$EV;if($E_)$E$e.transformLightingMapTexcoordByUV1Array($EL,$Ek,$Ex,$EL,$Ek);else{var $Eh=$EO*$Ed+$EE;$E$e.transformLightingMapTexcoordByUV0Array($Er,$Eh,$Ex,$EL,$Ek)}}}return $EL},$EM._getVertexBuffers=function(){return null},$EM._beforeRender=function($EM){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$EM._render=function($EM){var $Ee,$EL=0,$E_=$EM.renderElement;if(1<this._indexCount){var $Ec=this._boneIndicesList.length;if(1<$Ec){for(var $Eq=0;$Eq<$Ec;$Eq++)($Ee=$E_._skinAnimationDatas||this._skinAnimationDatas)&&($E_._shaderValue.setValue(0,$Ee[$Eq]),$EM._shader.uploadRenderElementUniforms($E_._shaderValue.data)),$ES.mainContext.drawElements(4,this._subIndexBufferCount[$Eq],5123,2*this._subIndexBufferStart[$Eq]);$EA.drawCall+=$Ec}else($Ee=$E_._skinAnimationDatas||this._skinAnimationDatas)&&($E_._shaderValue.setValue(0,$Ee[0]),$EM._shader.uploadRenderElementUniforms($E_._shaderValue.data)),$ES.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$EA.drawCall++;$EL=this._indexCount}else $EL=this._indexBuffer.indexCount,($Ee=$E_._skinAnimationDatas||this._skinAnimationDatas)&&($E_._shaderValue.setValue(0,$Ee[0]),$EM._shader.uploadRenderElementUniforms($E_._shaderValue.data)),$ES.mainContext.drawElements(4,$EL,5123,0),$EA.drawCall++;$EA.trianglesFaces+=$EL/3},$EM.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$EM.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$Ed(0,$EM,"_vertexBufferCount",function(){return 1}),$Ed(0,$EM,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$EG($Et,["_tempVector30",function(){return this._tempVector30=new $EHe},"_tempVector31",function(){return this._tempVector31=new $EHe},"_tempQuaternion0",function(){return this._tempQuaternion0=new $ELe},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $EMe},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $EMe}]),$Et}(),$Eue=function(){function $EM($EM){this.defineCounter=0,this.defines=null,$EM?(this.defineCounter=$EM.defineCounter,this.defines=$EM.defines.slice()):(this.defineCounter=0,this.defines=[])}return $EE($EM,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$EM.prototype.registerDefine=function($EM){var $Ee=Math.pow(2,this.defineCounter++);return this.defines[$Ee]=$EM,$Ee},$EM}(),$EGe=function(){function $EM(){}return $EE($EM,"laya.d3.shader.ShaderInit3D"),$EM.__init__=function(){var $EM,$Ee;$EAe._globalRegDefine("HIGHPRECISION",$EAe.SHADERDEFINE_HIGHPRECISION),$EAe._globalRegDefine("FOG",$EAe.SHADERDEFINE_FOG),$EAe._globalRegDefine("DIRECTIONLIGHT",$EAe.SHADERDEFINE_DIRECTIONLIGHT),$EAe._globalRegDefine("POINTLIGHT",$EAe.SHADERDEFINE_POINTLIGHT),$EAe._globalRegDefine("SPOTLIGHT",$EAe.SHADERDEFINE_SPOTLIGHT),$EAe._globalRegDefine("UV",$EAe.SHADERDEFINE_UV0),$EAe._globalRegDefine("COLOR",$EAe.SHADERDEFINE_COLOR),$EAe._globalRegDefine("UV1",$EAe.SHADERDEFINE_UV1),$EAe._globalRegDefine("CASTSHADOW",$EEe.SHADERDEFINE_CAST_SHADOW),$EAe._globalRegDefine("SHADOWMAP_PSSM1",$EEe.SHADERDEFINE_SHADOW_PSSM1),$EAe._globalRegDefine("SHADOWMAP_PSSM2",$EEe.SHADERDEFINE_SHADOW_PSSM2),$EAe._globalRegDefine("SHADOWMAP_PSSM3",$EEe.SHADERDEFINE_SHADOW_PSSM3),$EAe._globalRegDefine("SHADOWMAP_PCF_NO",$EEe.SHADERDEFINE_SHADOW_PCF_NO),$EAe._globalRegDefine("SHADOWMAP_PCF1",$EEe.SHADERDEFINE_SHADOW_PCF1),$EAe._globalRegDefine("SHADOWMAP_PCF2",$EEe.SHADERDEFINE_SHADOW_PCF2),$EAe._globalRegDefine("SHADOWMAP_PCF3",$EEe.SHADERDEFINE_SHADOW_PCF3),$EAe._globalRegDefine("DEPTHFOG",$EAe.SAHDERDEFINE_DEPTHFOG),$Efe.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$Efe.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$EM={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$Ee={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $EL=$Efe.nameKey.add("SIMPLE");shaderCompile=$EAe.add($EL,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$EM,$Ee),$Eje.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$Eje.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$Eje.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$Eje.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$Eje.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$Eje.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$Eje.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$Eje.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$Eje.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},$EM}(),$EVe=function(){function $EM(){this._data=null,this._data=[]}$EE($EM,"laya.d3.shader.ValusArray");var $Ee=$EM.prototype;return $Ee.setValue=function($EM,$Ee){this._data[$EM]=$Ee},$Ed(0,$Ee,"data",function(){return this._data}),$EM}(),$EEe=function(){function $EM(){}return $EM.SHADERDEFINE_RECEIVE_SHADOW=1,$EM.SHADERDEFINE_CAST_SHADOW=512,$EM.SHADERDEFINE_SHADOW_PSSM1=1024,$EM.SHADERDEFINE_SHADOW_PSSM2=2048,$EM.SHADERDEFINE_SHADOW_PSSM3=4096,$EM.SHADERDEFINE_SHADOW_PCF_NO=8192,$EM.SHADERDEFINE_SHADOW_PCF1=16384,$EM.SHADERDEFINE_SHADOW_PCF2=32768,$EM.SHADERDEFINE_SHADOW_PCF3=65536,$EM.MAX_PSSM_COUNT=3,$EM}(),$Ede=function(){function $EZ(){}return $EE($EZ,"laya.d3.utils.Picker"),$EZ.calculateCursorRay=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$EM.elements[0],$ET=$EM.elements[1],$Ex=$EZ._tempVector30,$EO=$Ex.elements;$EO[0]=$EH,$EO[1]=$ET,$EO[2]=$Ee.minDepth;var $Eu=$EZ._tempVector31,$EG=$Eu.elements;$EG[0]=$EH,$EG[1]=$ET,$EG[2]=$Ee.maxDepth;var $EV=$Eq.origin,$EE=$EZ._tempVector32;$Ee.unprojectFromWVP($Ex,$EL,$E_,$Ec,$EV),$Ee.unprojectFromWVP($Eu,$EL,$E_,$Ec,$EE);var $Ed=$Eq.direction.elements;$Ed[0]=$EE.x-$EV.x,$Ed[1]=$EE.y-$EV.y,$Ed[2]=$EE.z-$EV.z,$EHe.normalize($Eq.direction,$Eq.direction)},$EZ.rayIntersectsPositionsAndIndices=function($EM,$Ee,$EL,$E_,$Ec){for(var $Eq=$EL.vertexStride/4,$EH=$EL.getVertexElementByUsage(0).offset/4,$ET=Number.MAX_VALUE,$Ex=-1,$EO=-1,$Eu=-1,$EG=0;$EG<$E_.length;$EG+=3){var $EV=$EZ._tempVector35,$EE=$EV.elements,$Ed=$E_[$EG]*$Eq,$Er=$Ed+$EH;$EE[0]=$Ee[$Er],$EE[1]=$Ee[1+$Er],$EE[2]=$Ee[2+$Er];var $E$=$EZ._tempVector36,$EC=$E$.elements,$EK=$E_[$EG+1]*$Eq,$EX=$EK+$EH;$EC[0]=$Ee[$EX],$EC[1]=$Ee[1+$EX],$EC[2]=$Ee[2+$EX];var $Eo=$EZ._tempVector37,$Ei=$Eo.elements,$EW=$E_[$EG+2]*$Eq,$Ey=$EW+$EH;$Ei[0]=$Ee[$Ey],$Ei[1]=$Ee[1+$Ey],$Ei[2]=$Ee[2+$Ey];var $EA=laya.d3.utils.Picker.rayIntersectsTriangle($EM,$EV,$E$,$Eo);!isNaN($EA)&&$EA<$ET&&($ET=$EA,$Ex=$Ed,$EO=$EK,$Eu=$EW)}if($ET===Number.MAX_VALUE)return $Ec.position.toDefault(),$Ec.distance=Number.MAX_VALUE,$Ec.trianglePositions[0].toDefault(),$Ec.trianglePositions[1].toDefault(),$Ec.trianglePositions[2].toDefault(),$Ec.triangleNormals[0].toDefault(),$Ec.triangleNormals[1].toDefault(),$Ec.triangleNormals[2].toDefault(),!1;$Ec.distance=$ET,$EHe.scale($EM.direction,$ET,$Ec.position),$EHe.add($EM.origin,$Ec.position,$Ec.position);var $EB=$Ec.trianglePositions,$Ek=$EB[0],$Eh=$EB[1],$Et=$EB[2],$ES=$Ek.elements,$Ep=$Eh.elements,$ER=$Et.elements,$Ea=$Ex+$EH;$ES[0]=$Ee[$Ea],$ES[1]=$Ee[$Ea+1],$ES[2]=$Ee[$Ea+2];var $En=$EO+$EH;$Ep[0]=$Ee[$En],$Ep[1]=$Ee[$En+1],$Ep[2]=$Ee[$En+2];var $El=$Eu+$EH;$ER[0]=$Ee[$El],$ER[1]=$Ee[$El+1],$ER[2]=$Ee[$El+2];var $Ef=$EL.getVertexElementByUsage(3);if($Ef){var $Ej=$Ef.offset/4,$EF=$Ec.triangleNormals,$Eg=$EF[0],$EJ=$EF[1],$Ew=$EF[2],$Eb=$Eg.elements,$Em=$EJ.elements,$Ez=$Ew.elements,$EQ=$Ex+$Ej;$Eb[0]=$Ee[$EQ],$Eb[1]=$Ee[$EQ+1],$Eb[2]=$Ee[$EQ+2];var $EY=$EO+$Ej;$Em[0]=$Ee[$EY],$Em[1]=$Ee[$EY+1],$Em[2]=$Ee[$EY+2];var $EP=$Eu+$Ej;$Ez[0]=$Ee[$EP],$Ez[1]=$Ee[$EP+1],$Ez[2]=$Ee[$EP+2]}return!0},$EZ.rayIntersectsTriangle=function($EM,$Ee,$EL,$E_){var $Ec=$EZ._tempVector30,$Eq=$EZ._tempVector31;$EHe.subtract($EL,$Ee,$Ec),$EHe.subtract($E_,$Ee,$Eq);var $EH,$ET=$EZ._tempVector32;if($EHe.cross($EM.direction,$Eq,$ET),($EH=$EHe.dot($Ec,$ET))>-Number.MIN_VALUE&&$EH<Number.MIN_VALUE)return Number.NaN;var $Ex,$EO=1/$EH,$Eu=$EZ._tempVector33;if($EHe.subtract($EM.origin,$Ee,$Eu),$Ex=$EHe.dot($Eu,$ET),($Ex*=$EO)<0||1<$Ex)return Number.NaN;var $EG,$EV,$EE=$EZ._tempVector34;return $EHe.cross($Eu,$Ec,$EE),$EG=$EHe.dot($EM.direction,$EE),($EG*=$EO)<0||1<$Ex+$EG?Number.NaN:($EV=$EHe.dot($Eq,$EE),($EV*=$EO)<0?Number.NaN:$EV)},$EG($EZ,["_tempVector30",function(){return this._tempVector30=new $EHe},"_tempVector31",function(){return this._tempVector31=new $EHe},"_tempVector32",function(){return this._tempVector32=new $EHe},"_tempVector33",function(){return this._tempVector33=new $EHe},"_tempVector34",function(){return this._tempVector34=new $EHe},"_tempVector35",function(){return this._tempVector35=new $EHe},"_tempVector36",function(){return this._tempVector36=new $EHe},"_tempVector37",function(){return this._tempVector37=new $EHe}]),$EZ}(),$Ere=(function(){function $EM(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $EHe,new $EHe,new $EHe],this.trianglePositions.length=3,this.triangleNormals=[new $EHe,new $EHe,new $EHe],this.triangleNormals.length=3,this.position=new $EHe}$EE($EM,"laya.d3.utils.RaycastHit"),$EM.prototype.cloneTo=function($EM){$EM.distance=this.distance,this.trianglePositions[0].cloneTo($EM.trianglePositions[0]),this.trianglePositions[1].cloneTo($EM.trianglePositions[1]),this.trianglePositions[2].cloneTo($EM.trianglePositions[2]),this.triangleNormals[0].cloneTo($EM.triangleNormals[0]),this.triangleNormals[1].cloneTo($EM.triangleNormals[1]),this.triangleNormals[2].cloneTo($EM.triangleNormals[2]),this.position.cloneTo($EM.position),$EM.sprite3D=this.sprite3D}}(),function(){function $EM($EM,$Ee){this._width=0,this._height=0,this._width=$EM,this._height=$Ee}$EE($EM,"laya.d3.utils.Size");var $Ee=$EM.prototype;return $Ed(0,$Ee,"width",function(){return-1===this._width?$Ev.clientWidth:this._width}),$Ed(0,$Ee,"height",function(){return-1===this._height?$Ev.clientHeight:this._height}),$Ed(1,$EM,"fullScreen",function(){return new $EM(-1,-1)}),$EM}()),$E$e=function(){function $Ea(){}return $EE($Ea,"laya.d3.utils.Utils3D"),$Ea._rotationTransformScaleSkinAnimation=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG){var $EV,$EE,$Ed,$Er,$E$,$EC=$Ea._tempArray16_0,$EK=$Ea._tempArray16_1,$EX=$Ea._tempArray16_2,$Eo=$E_+$E_,$Ei=$Ec+$Ec,$EW=$Eq+$Eq,$Ey=$E_*$Eo,$EA=$Ec*$Eo,$EB=$Ec*$Ei,$Ek=$Eq*$Eo,$Eh=$Eq*$Ei,$Et=$Eq*$EW,$ES=$EH*$Eo,$Ep=$EH*$Ei,$ER=$EH*$EW;for($EC[15]=1,$EC[0]=1-$EB-$Et,$EC[1]=$EA+$ER,$EC[2]=$Ek-$Ep,$EC[4]=$EA-$ER,$EC[5]=1-$Ey-$Et,$EC[6]=$Eh+$ES,$EC[8]=$Ek+$Ep,$EC[9]=$Eh-$ES,$EC[10]=1-$Ey-$EB,$EK[15]=1,$EK[0]=$ET,$EK[5]=$Ex,$EK[10]=$EO,$EV=0;$EV<4;$EV++)$EE=$EC[$EV],$Ed=$EC[$EV+4],$Er=$EC[$EV+8],$E$=$EC[$EV+12],$EX[$EV]=$EE,$EX[$EV+4]=$Ed,$EX[$EV+8]=$Er,$EX[$EV+12]=$EE*$EM+$Ed*$Ee+$Er*$EL+$E$;for($EV=0;$EV<4;$EV++)$EE=$EX[$EV],$Ed=$EX[$EV+4],$Er=$EX[$EV+8],$E$=$EX[$EV+12],$Eu[$EV+$EG]=$EE*$EK[0]+$Ed*$EK[1]+$Er*$EK[2]+$E$*$EK[3],$Eu[$EV+$EG+4]=$EE*$EK[4]+$Ed*$EK[5]+$Er*$EK[6]+$E$*$EK[7],$Eu[$EV+$EG+8]=$EE*$EK[8]+$Ed*$EK[9]+$Er*$EK[10]+$E$*$EK[11],$Eu[$EV+$EG+12]=$EE*$EK[12]+$Ed*$EK[13]+$Er*$EK[14]+$E$*$EK[15]},$Ea._createNodeByJson=function($EM,$Ee,$EL,$E_){if(!$EL)switch($Ee.type){case"Sprite3D":$EL=new $Ele;break;case"MeshSprite3D":$EL=new $EZe;break;case"SkinnedMeshSprite3D":$EL=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$EL=new ShuriKenParticle3D;break;case"TrailSprite3D":$EL=new TrailSprite3D;break;case"Terrain":$EL=new Terrain;break;case"Camera":$EL=new $EPe;break;case"DirectionLight":$EL=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $Ec=$Ee.props;if($Ec)for(var $Eq in $Ec)$EL[$Eq]=$Ec[$Eq];var $EH=$Ee.customProps;$EH&&($EL instanceof laya.d3.core.Sprite3D?($EL._parseBaseCustomProps($EH),$EL._parseCustomProps($EM,$E_,$EH,$Ee),$EL._parseCustomComponent($EM,$E_,$Ee.components)):$EL._parseCustomProps($EM,$E_,$EH,$Ee));var $ET=$Ee.child;if($ET)for(var $Ex=0,$EO=$ET.length;$Ex<$EO;$Ex++){var $Eu=$Ea._createNodeByJson($EM,$ET[$Ex],null,$E_);$EL.addChild($Eu)}return $EL},$Ea._computeBoneAndAnimationDatasByBindPoseMatrxix=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH,$ET,$Ex=0,$EO=0,$Eu=$EM.length;for($EH=0;$EH<$Eu;$Ex+=$EM[$EH].keyframeWidth,$EO+=16,$EH++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($Ee[$Ex+0],$Ee[$Ex+1],$Ee[$Ex+2],$Ee[$Ex+3],$Ee[$Ex+4],$Ee[$Ex+5],$Ee[$Ex+6],$Ee[$Ex+7],$Ee[$Ex+8],$Ee[$Ex+9],$E_,$EO),0!=$EH&&($ET=16*$EM[$EH].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($E_,$ET,$E_,$EO,$E_,$EO));var $EG=$EL.length;for($EH=0;$EH<$EG;$EH++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($E_,16*$Eq[$EH],$EL[$EH],$Ec,16*$EH)},$Ea._computeAnimationDatasByArrayAndMatrixFast=function($EM,$Ee,$EL,$E_){for(var $Ec=0,$Eq=$EM.length;$Ec<$Eq;$Ec++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Ee,16*$E_[$Ec],$EM[$Ec],$EL,16*$Ec)},$Ea._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($EM,$Ee,$EL,$E_,$Ec){var $Eq,$EH,$ET=0,$Ex=0,$EO=$EM.length;for($Eq=0;$Eq<$EO;$ET+=$EM[$Eq].keyframeWidth,$Ex+=16,$Eq++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($Ee[$ET+7],$Ee[$ET+8],$Ee[$ET+9],$Ee[$ET+3],$Ee[$ET+4],$Ee[$ET+5],$Ee[$ET+6],$Ee[$ET+0],$Ee[$ET+1],$Ee[$ET+2],$E_,$Ex),0!=$Eq&&($EH=16*$EM[$Eq].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($E_,$EH,$E_,$Ex,$E_,$Ex));var $Eu=$EL.length;for($Eq=0;$Eq<$Eu;$Eq++){var $EG=16*$Eq;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($E_,$EG,$EL[$Eq],$Ec,$EG)}},$Ea._computeAnimationDatasByArrayAndMatrixFastOld=function($EM,$Ee,$EL){for(var $E_=$EM.length,$Ec=0;$Ec<$E_;$Ec++){var $Eq=16*$Ec;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Ee,$Eq,$EM[$Ec],$EL,$Eq)}},$Ea._computeRootAnimationData=function($EM,$Ee,$EL){for(var $E_=0,$Ec=0,$Eq=0,$EH=$EM.length;$E_<$EH;$Ec+=$EM[$E_].keyframeWidth,$Eq+=16,$E_++)laya.d3.utils.Utils3D.createAffineTransformationArray($Ee[$Ec+0],$Ee[$Ec+1],$Ee[$Ec+2],$Ee[$Ec+3],$Ee[$Ec+4],$Ee[$Ec+5],$Ee[$Ec+6],$Ee[$Ec+7],$Ee[$Ec+8],$Ee[$Ec+9],$EL,$Eq)},$Ea.transformVector3ArrayByQuat=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EL.elements,$EH=$EM[$Ee],$ET=$EM[$Ee+1],$Ex=$EM[$Ee+2],$EO=$Eq[0],$Eu=$Eq[1],$EG=$Eq[2],$EV=$Eq[3],$EE=$EV*$EH+$Eu*$Ex-$EG*$ET,$Ed=$EV*$ET+$EG*$EH-$EO*$Ex,$Er=$EV*$Ex+$EO*$ET-$Eu*$EH,$E$=-$EO*$EH-$Eu*$ET-$EG*$Ex;$E_[$Ec]=$EE*$EV+$E$*-$EO+$Ed*-$EG-$Er*-$Eu,$E_[$Ec+1]=$Ed*$EV+$E$*-$Eu+$Er*-$EO-$EE*-$EG,$E_[$Ec+2]=$Er*$EV+$E$*-$EG+$EE*-$Eu-$Ed*-$EO},$Ea.mulMatrixByArray=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH,$ET,$Ex,$EO,$Eu;if($Ec===$EL){for($EL=$Ea._tempArray16_3,$EH=0;$EH<16;++$EH)$EL[$EH]=$Ec[$Eq+$EH];$E_=0}for($EH=0;$EH<4;$EH++)$ET=$EM[$Ee+$EH],$Ex=$EM[$Ee+$EH+4],$EO=$EM[$Ee+$EH+8],$Eu=$EM[$Ee+$EH+12],$Ec[$Eq+$EH]=$ET*$EL[$E_+0]+$Ex*$EL[$E_+1]+$EO*$EL[$E_+2]+$Eu*$EL[$E_+3],$Ec[$Eq+$EH+4]=$ET*$EL[$E_+4]+$Ex*$EL[$E_+5]+$EO*$EL[$E_+6]+$Eu*$EL[$E_+7],$Ec[$Eq+$EH+8]=$ET*$EL[$E_+8]+$Ex*$EL[$E_+9]+$EO*$EL[$E_+10]+$Eu*$EL[$E_+11],$Ec[$Eq+$EH+12]=$ET*$EL[$E_+12]+$Ex*$EL[$E_+13]+$EO*$EL[$E_+14]+$Eu*$EL[$E_+15]},$Ea.mulMatrixByArrayFast=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH,$ET,$Ex,$EO,$Eu;for($EH=0;$EH<4;$EH++)$ET=$EM[$Ee+$EH],$Ex=$EM[$Ee+$EH+4],$EO=$EM[$Ee+$EH+8],$Eu=$EM[$Ee+$EH+12],$Ec[$Eq+$EH]=$ET*$EL[$E_+0]+$Ex*$EL[$E_+1]+$EO*$EL[$E_+2]+$Eu*$EL[$E_+3],$Ec[$Eq+$EH+4]=$ET*$EL[$E_+4]+$Ex*$EL[$E_+5]+$EO*$EL[$E_+6]+$Eu*$EL[$E_+7],$Ec[$Eq+$EH+8]=$ET*$EL[$E_+8]+$Ex*$EL[$E_+9]+$EO*$EL[$E_+10]+$Eu*$EL[$E_+11],$Ec[$Eq+$EH+12]=$ET*$EL[$E_+12]+$Ex*$EL[$E_+13]+$EO*$EL[$E_+14]+$Eu*$EL[$E_+15]},$Ea.mulMatrixByArrayAndMatrixFast=function($EM,$Ee,$EL,$E_,$Ec){var $Eq,$EH,$ET,$Ex,$EO,$Eu=$EL.elements,$EG=$Eu[0],$EV=$Eu[1],$EE=$Eu[2],$Ed=$Eu[3],$Er=$Eu[4],$E$=$Eu[5],$EC=$Eu[6],$EK=$Eu[7],$EX=$Eu[8],$Eo=$Eu[9],$Ei=$Eu[10],$EW=$Eu[11],$Ey=$Eu[12],$EA=$Eu[13],$EB=$Eu[14],$Ek=$Eu[15],$Eh=$Ee,$Et=$Ee+4,$ES=$Ee+8,$Ep=$Ee+12,$ER=$Ec,$Ea=$Ec+4,$En=$Ec+8,$El=$Ec+12;for($Eq=0;$Eq<4;$Eq++)$EH=$EM[$Eh+$Eq],$ET=$EM[$Et+$Eq],$Ex=$EM[$ES+$Eq],$EO=$EM[$Ep+$Eq],$E_[$ER+$Eq]=$EH*$EG+$ET*$EV+$Ex*$EE+$EO*$Ed,$E_[$Ea+$Eq]=$EH*$Er+$ET*$E$+$Ex*$EC+$EO*$EK,$E_[$En+$Eq]=$EH*$EX+$ET*$Eo+$Ex*$Ei+$EO*$EW,$E_[$El+$Eq]=$EH*$Ey+$ET*$EA+$Ex*$EB+$EO*$Ek},$Ea.createAffineTransformationArray=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG){var $EV=$E_+$E_,$EE=$Ec+$Ec,$Ed=$Eq+$Eq,$Er=$E_*$EV,$E$=$E_*$EE,$EC=$E_*$Ed,$EK=$Ec*$EE,$EX=$Ec*$Ed,$Eo=$Eq*$Ed,$Ei=$EH*$EV,$EW=$EH*$EE,$Ey=$EH*$Ed;$Eu[$EG+0]=(1-($EK+$Eo))*$ET,$Eu[$EG+1]=($E$+$Ey)*$ET,$Eu[$EG+2]=($EC-$EW)*$ET,$Eu[$EG+3]=0,$Eu[$EG+4]=($E$-$Ey)*$Ex,$Eu[$EG+5]=(1-($Er+$Eo))*$Ex,$Eu[$EG+6]=($EX+$Ei)*$Ex,$Eu[$EG+7]=0,$Eu[$EG+8]=($EC+$EW)*$EO,$Eu[$EG+9]=($EX-$Ei)*$EO,$Eu[$EG+10]=(1-($Er+$EK))*$EO,$Eu[$EG+11]=0,$Eu[$EG+12]=$EM,$Eu[$EG+13]=$Ee,$Eu[$EG+14]=$EL,$Eu[$EG+15]=1},$Ea.transformVector3ArrayToVector3ArrayCoordinate=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$Ea._tempArray4_0,$EH=$EM[$Ee+0],$ET=$EM[$Ee+1],$Ex=$EM[$Ee+2],$EO=$EL.elements;$Eq[0]=$EH*$EO[0]+$ET*$EO[4]+$Ex*$EO[8]+$EO[12],$Eq[1]=$EH*$EO[1]+$ET*$EO[5]+$Ex*$EO[9]+$EO[13],$Eq[2]=$EH*$EO[2]+$ET*$EO[6]+$Ex*$EO[10]+$EO[14],$Eq[3]=1/($EH*$EO[3]+$ET*$EO[7]+$Ex*$EO[11]+$EO[15]),$E_[$Ec+0]=$Eq[0]*$Eq[3],$E_[$Ec+1]=$Eq[1]*$Eq[3],$E_[$Ec+2]=$Eq[2]*$Eq[3]},$Ea.transformLightingMapTexcoordByUV0Array=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EL.elements;$E_[$Ec+0]=$EM[$Ee+0]*$Eq[0]+$Eq[2],$E_[$Ec+1]=($EM[$Ee+1]-1)*$Eq[1]+$Eq[3]},$Ea.transformLightingMapTexcoordByUV1Array=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$EL.elements;$E_[$Ec+0]=$EM[$Ee+0]*$Eq[0]+$Eq[2],$E_[$Ec+1]=1+$EM[$Ee+1]*$Eq[1]+$Eq[3]},$Ea.getURLVerion=function($EM){var $Ee=$EM.indexOf("?");return 0<=$Ee?$EM.substr($Ee):null},$Ea._quaternionCreateFromYawPitchRollArray=function($EM,$Ee,$EL,$E_){var $Ec=.5*$EL,$Eq=.5*$Ee,$EH=.5*$EM,$ET=Math.sin($Ec),$Ex=Math.cos($Ec),$EO=Math.sin($Eq),$Eu=Math.cos($Eq),$EG=Math.sin($EH),$EV=Math.cos($EH);$E_[0]=$EV*$EO*$Ex+$EG*$Eu*$ET,$E_[1]=$EG*$Eu*$Ex-$EV*$EO*$ET,$E_[2]=$EV*$Eu*$ET-$EG*$EO*$Ex,$E_[3]=$EV*$Eu*$Ex+$EG*$EO*$ET},$Ea._createAffineTransformationArray=function($EM,$Ee,$EL,$E_){var $Ec=$Ee[0],$Eq=$Ee[1],$EH=$Ee[2],$ET=$Ee[3],$Ex=$Ec+$Ec,$EO=$Eq+$Eq,$Eu=$EH+$EH,$EG=$Ec*$Ex,$EV=$Ec*$EO,$EE=$Ec*$Eu,$Ed=$Eq*$EO,$Er=$Eq*$Eu,$E$=$EH*$Eu,$EC=$ET*$Ex,$EK=$ET*$EO,$EX=$ET*$Eu,$Eo=$EL[0],$Ei=$EL[1],$EW=$EL[2];$E_[0]=(1-($Ed+$E$))*$Eo,$E_[1]=($EV+$EX)*$Eo,$E_[2]=($EE-$EK)*$Eo,$E_[3]=0,$E_[4]=($EV-$EX)*$Ei,$E_[5]=(1-($EG+$E$))*$Ei,$E_[6]=($Er+$EC)*$Ei,$E_[7]=0,$E_[8]=($EE+$EK)*$EW,$E_[9]=($Er-$EC)*$EW,$E_[10]=(1-($EG+$Ed))*$EW,$E_[11]=0,$E_[12]=$EM[0],$E_[13]=$EM[1],$E_[14]=$EM[2],$E_[15]=1},$Ea._mulMatrixArray=function($EM,$Ee,$EL,$E_){var $Ec,$Eq,$EH,$ET,$Ex,$EO=$Ee.elements,$Eu=$EO[0],$EG=$EO[1],$EV=$EO[2],$EE=$EO[3],$Ed=$EO[4],$Er=$EO[5],$E$=$EO[6],$EC=$EO[7],$EK=$EO[8],$EX=$EO[9],$Eo=$EO[10],$Ei=$EO[11],$EW=$EO[12],$Ey=$EO[13],$EA=$EO[14],$EB=$EO[15],$Ek=$E_,$Eh=$E_+4,$Et=$E_+8,$ES=$E_+12;for($Ec=0;$Ec<4;$Ec++)$Eq=$EM[$Ec],$EH=$EM[$Ec+4],$ET=$EM[$Ec+8],$Ex=$EM[$Ec+12],$EL[$Ek+$Ec]=$Eq*$Eu+$EH*$EG+$ET*$EV+$Ex*$EE,$EL[$Eh+$Ec]=$Eq*$Ed+$EH*$Er+$ET*$E$+$Ex*$EC,$EL[$Et+$Ec]=$Eq*$EK+$EH*$EX+$ET*$Eo+$Ex*$Ei,$EL[$ES+$Ec]=$Eq*$EW+$EH*$Ey+$ET*$EA+$Ex*$EB},$Ea.getYawPitchRoll=function($EM,$Ee){$Ea.transformQuat($EHe.ForwardRH,$EM,$ELe.TEMPVector31),$Ea.transformQuat($EHe.Up,$EM,$ELe.TEMPVector32);var $EL=$ELe.TEMPVector32.elements;$Ea.angleTo($EHe.ZERO,$ELe.TEMPVector31,$ELe.TEMPVector33);var $E_=$ELe.TEMPVector33.elements;$E_[0]==Math.PI/2?($E_[1]=$Ea.arcTanAngle($EL[2],$EL[0]),$E_[2]=0):$E_[0]==-Math.PI/2?($E_[1]=$Ea.arcTanAngle(-$EL[2],-$EL[0]),$E_[2]=0):($EMe.createRotationY(-$E_[1],$ELe.TEMPMatrix0),$EMe.createRotationX(-$E_[0],$ELe.TEMPMatrix1),$EHe.transformCoordinate($ELe.TEMPVector32,$ELe.TEMPMatrix0,$ELe.TEMPVector32),$EHe.transformCoordinate($ELe.TEMPVector32,$ELe.TEMPMatrix1,$ELe.TEMPVector32),$E_[2]=$Ea.arcTanAngle($EL[1],-$EL[0])),$E_[1]<=-Math.PI&&($E_[1]=Math.PI),$E_[2]<=-Math.PI&&($E_[2]=Math.PI),$E_[1]>=Math.PI&&$E_[2]>=Math.PI&&($E_[1]=0,$E_[2]=0,$E_[0]=Math.PI-$E_[0]),$Ee[0]=$E_[1],$Ee[1]=$E_[0],$Ee[2]=$E_[2]},$Ea.arcTanAngle=function($EM,$Ee){return 0==$EM?1==$Ee?Math.PI/2:-Math.PI/2:0<$EM?Math.atan($Ee/$EM):$EM<0?0<$Ee?Math.atan($Ee/$EM)+Math.PI:Math.atan($Ee/$EM)-Math.PI:0},$Ea.angleTo=function($EM,$Ee,$EL){$EHe.subtract($Ee,$EM,$ELe.TEMPVector30),$EHe.normalize($ELe.TEMPVector30,$ELe.TEMPVector30),$EL.elements[0]=Math.asin($ELe.TEMPVector30.y),$EL.elements[1]=$Ea.arcTanAngle(-$ELe.TEMPVector30.z,-$ELe.TEMPVector30.x)},$Ea.transformQuat=function($EM,$Ee,$EL){var $E_=$EL.elements,$Ec=$EM.elements,$Eq=$Ee,$EH=$Ec[0],$ET=$Ec[1],$Ex=$Ec[2],$EO=$Eq[0],$Eu=$Eq[1],$EG=$Eq[2],$EV=$Eq[3],$EE=$EV*$EH+$Eu*$Ex-$EG*$ET,$Ed=$EV*$ET+$EG*$EH-$EO*$Ex,$Er=$EV*$Ex+$EO*$ET-$Eu*$EH,$E$=-$EO*$EH-$Eu*$ET-$EG*$Ex;$E_[0]=$EE*$EV+$E$*-$EO+$Ed*-$EG-$Er*-$Eu,$E_[1]=$Ed*$EV+$E$*-$Eu+$Er*-$EO-$EE*-$EG,$E_[2]=$Er*$EV+$E$*-$EG+$EE*-$Eu-$Ed*-$EO},$Ea.quaterionNormalize=function($EM,$Ee){var $EL=$EM[0],$E_=$EM[1],$Ec=$EM[2],$Eq=$EM[3],$EH=$EL*$EL+$E_*$E_+$Ec*$Ec+$Eq*$Eq;0<$EH&&($EH=1/Math.sqrt($EH),$Ee[0]=$EL*$EH,$Ee[1]=$E_*$EH,$Ee[2]=$Ec*$EH,$Ee[3]=$Eq*$EH)},$Ea.matrix4x4MultiplyFFF=function($EM,$Ee,$EL){var $E_,$Ec,$Eq,$EH,$ET;if($EL===$Ee)for($Ee=new Float32Array(16),$E_=0;$E_<16;++$E_)$Ee[$E_]=$EL[$E_];for($E_=0;$E_<4;$E_++)$Ec=$EM[$E_],$Eq=$EM[$E_+4],$EH=$EM[$E_+8],$ET=$EM[$E_+12],$EL[$E_]=$Ec*$Ee[0]+$Eq*$Ee[1]+$EH*$Ee[2]+$ET*$Ee[3],$EL[$E_+4]=$Ec*$Ee[4]+$Eq*$Ee[5]+$EH*$Ee[6]+$ET*$Ee[7],$EL[$E_+8]=$Ec*$Ee[8]+$Eq*$Ee[9]+$EH*$Ee[10]+$ET*$Ee[11],$EL[$E_+12]=$Ec*$Ee[12]+$Eq*$Ee[13]+$EH*$Ee[14]+$ET*$Ee[15]},$Ea.matrix4x4MultiplyMFM=function($EM,$Ee,$EL){$Ea.matrix4x4MultiplyFFF($EM.elements,$Ee,$EL.elements)},$EG($Ea,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $EHe},"_tempVector3_1",function(){return this._tempVector3_1=new $EHe},"_tempVector3_2",function(){return this._tempVector3_2=new $EHe},"_tempVector3_3",function(){return this._tempVector3_3=new $EHe},"_tempVector3_4",function(){return this._tempVector3_4=new $EHe},"_tempVector3_5",function(){return this._tempVector3_5=new $EHe},"_tempVector3_6",function(){return this._tempVector3_6=new $EHe},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$Ea}(),$ECe=function(){function $Ep(){}return $EE($Ep,"Laya3D"),$Ep._cancelLoadByUrl=function($EM){$Ei.loader.cancelLoadByUrl($EM),$Ep._innerFirstLevelLoaderManager.cancelLoadByUrl($EM),$Ep._innerSecondLevelLoaderManager.cancelLoadByUrl($EM),$Ep._innerThirdLevelLoaderManager.cancelLoadByUrl($EM),$Ep._innerFourthLevelLoaderManager.cancelLoadByUrl($EM)},$Ep._changeWebGLSize=function($EM,$Ee){$ES.onStageResize($EM,$Ee),$Ev.clientWidth=$EM,$Ev.clientHeight=$Ee},$Ep.__init__=function(){var $EM=$Ee.createMap;$EM.lh=[$Ele,"SPRITE3DHIERARCHY"],$EM.ls=[$Ene,"SPRITE3DHIERARCHY"],$EM.lm=[$Ebe,"MESH"],$EM.lmat=[$Eje,"MATERIAL"],$EM.jpg=[$Eze,"nativeimage"],$EM.jpeg=[$Eze,"nativeimage"],$EM.png=[$Eze,"nativeimage"],$EM.pkm=[$Eze,"arraybuffer"],$EM.raw=[$EJe,"arraybuffer"],$EM.mipmaps=[$EJe,"arraybuffer"],$EC.parserMap.SPRITE3DHIERARCHY=$Ep._loadHierarchy,$EC.parserMap.MESH=$Ep._loadMesh,$EC.parserMap.MATERIAL=$Ep._loadMaterial,$EC.parserMap.TEXTURECUBE=$Ep._loadTextureCube,$EC.parserMap.TERRAIN=$Ep._loadTerrain,$Ep._innerFirstLevelLoaderManager.on("error",null,$Ep._eventLoadManagerError),$Ep._innerSecondLevelLoaderManager.on("error",null,$Ep._eventLoadManagerError),$Ep._innerThirdLevelLoaderManager.on("error",null,$Ep._eventLoadManagerError),$Ep._innerFourthLevelLoaderManager.on("error",null,$Ep._eventLoadManagerError)},$Ep.READ_BLOCK=function(){return $Ep._readData.pos+=4,!0},$Ep.READ_DATA=function(){return $Ep._DATA.offset=$Ep._readData.getUint32(),$Ep._DATA.size=$Ep._readData.getUint32(),!0},$Ep.READ_STRINGS=function(){var $EM=[],$Ee={offset:0,size:0};$Ee.offset=$Ep._readData.getUint16(),$Ee.size=$Ep._readData.getUint16();$Ep._readData.pos;$Ep._readData.pos=$Ee.offset+$Ep._DATA.offset;for(var $EL=0;$EL<$Ee.size;$EL++){var $E_=$Ep._readData.readUTFString();-1===$E_.lastIndexOf(".lmat")&&-1===$E_.lastIndexOf(".lpbr")||$EM.push($E_)}return $EM},$Ep.formatRelativePath=function($EM,$Ee){var $EL;if("."===$Ee.charAt(0)){for(var $E_=($EM+$Ee).split("/"),$Ec=0,$Eq=$E_.length;$Ec<$Eq;$Ec++)if(".."==$E_[$Ec]){var $EH=$Ec-1;0<$EH&&".."!==$E_[$EH]&&($E_.splice($EH,2),$Ec-=2)}$EL=$E_.join("/")}else $EL=$EM+$Ee;return null!=$Et.customFormat&&($EL=$Et.customFormat($EL,null)),$EL},$Ep._eventLoadManagerError=function($EM){$Ei.loader.event("error",$EM)},$Ep._addHierarchyInnerUrls=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH=$Ep.formatRelativePath($E_,$Ec);$EL&&($EH+=$EL),$EM.push({url:$EH,clas:$Eq}),$Ee[$Ec]=$EH},$Ep._getSprite3DHierarchyInnerUrls=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){var $ET,$Ex=0,$EO=0;switch($EM.type){case"Scene":var $Eu=$EM.customProps.lightmaps;for($Ex=0,$EO=$Eu.length;$Ex<$EO;$Ex++){var $EG=$Eu[$Ex].replace(".exr",".png");$Ep._addHierarchyInnerUrls($E_,$Ec,$Eq,$EH,$EG,$Eze)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $EV;if($EM.instanceParams)($EV=$EM.instanceParams.loadPath)&&$Ep._addHierarchyInnerUrls($Ee,$Ec,$Eq,$EH,$EV,$Ebe);else{($EV=($ET=$EM.customProps).meshPath)&&$Ep._addHierarchyInnerUrls($Ee,$Ec,$Eq,$EH,$EV,$Ebe);var $EE=$ET.materials;if($EE)for($Ex=0,$EO=$EE.length;$Ex<$EO;$Ex++){for(var $Ed=$EE[$Ex],$Er=$Ed.type.split("."),$E$=$ER.window,$EC=0,$EK=$Er.length;$EC<$EK;++$EC){$E$=$E$[this.clasPaths[$EC]]}if("function"!=typeof $E$)throw"_getSprite3DHierarchyInnerUrls 错误: "+$Ed.type+" 不是类";$Ep._addHierarchyInnerUrls($EL,$Ec,$Eq,$EH,$Ed.path,$E$)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $EX=($ET=$EM.customProps).meshPath;$EX&&$Ep._addHierarchyInnerUrls($Ee,$Ec,$Eq,$EH,$EX,$Ebe);var $Eo=$ET.material;if($Eo){$Er=$Eo.type.split("."),$E$=$ER.window;for($EC=0,$EK=$Er.length;$EC<$EK;++$EC){$E$=$E$[this.clasPaths[$EC]]}$Ep._addHierarchyInnerUrls($EL,$Ec,$Eq,$EH,$Eo.path,$E$)}else{var $Ei=$ET.materialPath;if($Ei)$Ep._addHierarchyInnerUrls($EL,$Ec,$Eq,$EH,$Ei,ShurikenParticleMaterial);else{var $EW=$ET.texturePath;$EW&&$Ep._addHierarchyInnerUrls($E_,$Ec,$Eq,$EH,$EW,$Eze)}}break;case"Terrain":$Ep._addHierarchyInnerUrls($E_,$Ec,$Eq,$EH,$EM.customProps.dataPath,TerrainRes)}var $Ey=$EM.components;for(var $EA in $Ey){var $EB=$Ey[$EA];switch($EA){case"Animator":var $Ek=$EB.avatarPath;if($Ek)$Ep._addHierarchyInnerUrls($E_,$Ec,$Eq,$EH,$Ek,Avatar);else{var $Eh=$EB.avatar;$Eh&&$Ep._addHierarchyInnerUrls($E_,$Ec,$Eq,$EH,$Eh.path,Avatar)}var $Et=$EB.clipPaths;for($Ex=0,$EO=$Et.length;$Ex<$EO;$Ex++)$Ep._addHierarchyInnerUrls($E_,$Ec,$Eq,$EH,$Et[$Ex],AnimationClip)}}var $ES=$EM.child;for($Ex=0,$EO=$ES.length;$Ex<$EO;$Ex++)$Ep._getSprite3DHierarchyInnerUrls($ES[$Ex],$Ee,$EL,$E_,$Ec,$Eq,$EH)},$Ep._loadHierarchy=function($EM){$EM.on("loaded",null,$Ep._onHierarchylhLoaded,[$EM,$EM._class._getGroup()]),$EM.load($EM.url,"json",!1,null,!0)},$Ep._onHierarchylhLoaded=function($EM,$Ee,$EL){if($EM._class.destroyed)$EM.endLoad();else{var $E_=$EM.url,$Ec=$E$e.getURLVerion($E_),$Eq=$Et.getPath($E_),$EH=[],$ET=[],$Ex=[],$EO={};$Ep._getSprite3DHierarchyInnerUrls($EL,$EH,$ET,$Ex,$EO,$Ec,$Eq);var $Eu=$EH.length+$ET.length+$Ex.length,$EG=$Eu+1,$EV=1/$EG;if($Ep._onProcessChange($EM,0,$EV,1),0<$Ex.length){var $EE=$Eu/$EG,$Ed=$Eh.create(null,$Ep._onProcessChange,[$EM,$EV,$EE],!1);$Ep._innerFourthLevelLoaderManager.create($Ex,$Eh.create(null,$Ep._onHierarchyInnerForthLevResouLoaded,[$EM,$Ee,$Ed,$EL,$EO,$EH,$ET,$EV+$EE*$Ex.length,$EE]),$Ed,null,null,1,!0,$Ee)}else $Ep._onHierarchyInnerForthLevResouLoaded($EM,$Ee,null,$EL,$EO,$EH,$ET,$EV,$EE)}},$Ep._onHierarchyInnerForthLevResouLoaded=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){if($EM._class.destroyed)$EM.endLoad();else if($EL&&$EL.recover(),0<$EH.length){var $EO=$Eh.create(null,$Ep._onProcessChange,[$EM,$ET,$Ex],!1);$Ep._innerSecondLevelLoaderManager.create($EH,$Eh.create(null,$Ep._onHierarchyInnerSecondLevResouLoaded,[$EM,$Ee,$EO,$E_,$Ec,$Eq,$ET+$Ex*$EH.length,$Ex]),$EL,null,null,1,!0,$Ee)}else $Ep._onHierarchyInnerSecondLevResouLoaded($EM,$Ee,null,$E_,$Ec,$Eq,$ET,$Ex)},$Ep._onHierarchyInnerSecondLevResouLoaded=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET){if($EM._class.destroyed)$EM.endLoad();else if($EL&&$EL.recover(),0<$Eq.length){var $Ex=$Eh.create(null,$Ep._onProcessChange,[$EM,$EH,$ET],!1);$Ep._innerFirstLevelLoaderManager.create($Eq,$Eh.create(null,$Ep._onHierarchyInnerFirstLevResouLoaded,[$EM,$Ex,$E_,$Ec]),$EL,null,null,1,!0,$Ee)}else $Ep._onHierarchyInnerFirstLevResouLoaded($EM,null,$E_,$Ec)},$Ep._onHierarchyInnerFirstLevResouLoaded=function($EM,$Ee,$EL,$E_){$Ee&&$Ee.recover(),$EM.endLoad([$EL,$E_])},$Ep._loadTerrain=function($EM){$EM.on("loaded",null,$Ep._onTerrainLtLoaded,[$EM,$EM._class._getGroup()]),$EM.load($EM.url,"json",!1,null,!0)},$Ep._onTerrainLtLoaded=function($EM,$Ee,$EL){if($EM._class.destroyed)$EM.endLoad();else{var $E_,$Ec,$Eq=$EM.url,$EH=$E$e.getURLVerion($Eq),$ET=$Et.getPath($Eq),$Ex=[],$EO={},$Eu=0,$EG=0,$EV=$EL.heightData;$E_=$EV.url,$Ec=$Ep.formatRelativePath($ET,$E_),$EH&&($Ec+=$EH),$E_=$EO[$E_]=$Ec;var $EE=$EL.detailTexture;for($Eu=0,$EG=$EE.length;$Eu<$EG;$Eu++)$Ex.push({url:$EE[$Eu].diffuse});var $Ed=$EL.normalMap;for($Eu=0,$EG=$Ed.length;$Eu<$EG;$Eu++)$Ex.push({url:$Ed[$Eu]});var $Er=$EL.alphaMap;for($Eu=0,$EG=$Er.length;$Eu<$EG;$Eu++)$Ex.push({url:$Er[$Eu],params:[!1,!1,6408,!0]});for($Eu=0,$EG=$Ex.length;$Eu<$EG;$Eu++){var $E$=$Ex[$Eu].url;$Ec=$Ep.formatRelativePath($ET,$E$),$EH&&($Ec+=$EH),$Ex[$Eu].url=$Ec,$EO[$E$]=$Ec}var $EC=$Ex.length,$EK=$EC+2,$EX=1/$EK;$Ep._onProcessChange($EM,0,$EX,1);var $Eo={heightMapLoaded:!1,texturesLoaded:!1},$Ei=$Eh.create(null,$Ep._onProcessChange,[$EM,$EX,$EX],!1);$Ep._innerFourthLevelLoaderManager.create($E_,$Eh.create(null,$Ep._onTerrainHeightMapLoaded,[$EM,$Ei,$EL,$EO,$Eo]),$Ei,null,[$EV.numX,$EV.numZ,$EV.bitType,$EV.value],1,!0,$Ee);var $EW=$Eh.create(null,$Ep._onProcessChange,[$EM,2*$EX,$EC/$EK],!1);$Ep._innerFourthLevelLoaderManager.create($Ex,$Eh.create(null,$Ep._onTerrainTexturesLoaded,[$EM,$EW,$EL,$EO,$Eo]),$EW,null,null,1,!0,$Ee)}},$Ep._onTerrainHeightMapLoaded=function($EM,$Ee,$EL,$E_,$Ec){$Ec.heightMapLoaded=!0,$Ec.texturesLoaded&&($EM.endLoad([$EL,$E_]),$Ee.recover())},$Ep._onTerrainTexturesLoaded=function($EM,$Ee,$EL,$E_,$Ec){$Ec.texturesLoaded=!0,$Ec.heightMapLoaded&&($EM.endLoad([$EL,$E_]),$Ee.recover())},$Ep._loadMesh=function($EM){$EM.on("loaded",null,$Ep._onMeshLmLoaded,[$EM,$EM._class._getGroup()]),$EM.load($EM.url,"arraybuffer",!1,null,!0)},$Ep._onMeshLmLoaded=function($EM,$Ee,$EL){if($EM._class.destroyed)$EM.endLoad();else{var $E_,$Ec,$Eq,$EH=$EM.url,$ET=$E$e.getURLVerion($EH),$Ex=$Et.getPath($EH),$EO={},$Eu=0,$EG=0;switch(($Ep._readData=new $EW($EL)).pos=0,$Ep._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $EV=$Ep._readData.getUint32();$Ep._readData.pos=$Ep._readData.pos+4,$EG=$Ep._readData.getUint16(),$Ep._readData.pos=$Ep._readData.pos+8*$EG;var $EE=$Ep._readData.getUint32();for($EG=$Ep._readData.getUint16(),$Ep._readData.pos=$EV+$EE,$E_=[],$Eu=0;$Eu<$EG;$Eu++){var $Ed=$Ep._readData.readUTFString();-1!==$Ed.lastIndexOf(".lmat")&&$E_.push($Ed)}break;default:for($Ep.READ_BLOCK(),$Eu=0;$Eu<2;$Eu++){var $Er=$Ep._readData.getUint16(),$E$=$Ep._strings[$Er],$EC=$Ep["READ_"+$E$];if(null==$EC)throw new Error("model file err,no this function:"+$Er+" "+$E$);1===$Eu?$E_=$EC.call():$EC.call()}}for($Eu=0,$Eq=$E_.length;$Eu<$Eq;$Eu++){var $EK=$E_[$Eu];$Ec=$Ep.formatRelativePath($Ex,$EK),$ET&&($Ec+=$ET),$E_[$Eu]=$Ec,$EO[$EK]=$Ec}if(0<$E_.length){$Ep._onProcessChange($EM,0,.5,1);var $EX=$Eh.create(null,$Ep._onProcessChange,[$EM,.5,.5],!1);$Ep._innerSecondLevelLoaderManager.create($E_,$Eh.create(null,$Ep._onMeshMateialLoaded,[$EM,$EX,$EL,$EO]),$EX,null,null,1,!0,$Ee)}else $EM.endLoad([$EL,$EO])}},$Ep._onMeshMateialLoaded=function($EM,$Ee,$EL,$E_){$EM.endLoad([$EL,$E_]),$Ee.recover()},$Ep._getMaterialTexturePath=function($EM,$Ee,$EL){var $E_=$EM.length-4;return $EM.indexOf(".dds")!=$E_&&$EM.indexOf(".tga")!=$E_&&$EM.indexOf(".exr")!=$E_&&$EM.indexOf(".DDS")!=$E_&&$EM.indexOf(".TGA")!=$E_&&$EM.indexOf(".EXR")!=$E_||($EM=$EM.substr(0,$E_)+".png"),$EM=$Ep.formatRelativePath($EL,$EM),$Ee&&($EM+=$Ee),$EM},$Ep._loadMaterial=function($EM){$EM.on("loaded",null,$Ep._onMaterilLmatLoaded,[$EM,$EM._class._getGroup()]),$EM.load($EM.url,"json",!1,null,!0)},$Ep._onMaterilLmatLoaded=function($EM,$Ee,$EL){if($EM._class.destroyed)$EM.endLoad();else{var $E_,$Ec=$EM.url,$Eq=$E$e.getURLVerion($Ec),$EH=$Et.getPath($Ec),$ET=[],$Ex={},$EO=$EL.customProps,$Eu=$EL.version;if($Eu)switch($Eu){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $EG=$EL.props.textures,$EV=0,$EE=$EG.length;$EV<$EE;$EV++){var $Ed=$EG[$EV],$Er=$Ed.path;if($Er){var $E$=$Er.length-4;$Er.indexOf(".exr")!=$E$&&$Er.indexOf(".EXR")!=$E$||($Er=$Er.substr(0,$E$)+".png"),$E_=$Ep.formatRelativePath($EH,$Er),$Eq&&($E_+=$Eq),$ET.push({url:$E_,params:$Ed.params}),$Ex[$Er]=$E_}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $EC=$EO.diffuseTexture.texture2D;if($EC&&($E_=$Ep._getMaterialTexturePath($EC,$Eq,$EH),$ET.push($E_),$Ex[$EC]=$E_),$EO.normalTexture){var $EK=$EO.normalTexture.texture2D;$EK&&($E_=$Ep._getMaterialTexturePath($EK,$Eq,$EH),$ET.push($E_),$Ex[$EK]=$E_)}if($EO.specularTexture){var $EX=$EO.specularTexture.texture2D;$EX&&($E_=$Ep._getMaterialTexturePath($EX,$Eq,$EH),$ET.push($E_),$Ex[$EX]=$E_)}if($EO.emissiveTexture){var $Eo=$EO.emissiveTexture.texture2D;$Eo&&($E_=$Ep._getMaterialTexturePath($Eo,$Eq,$EH),$ET.push($E_),$Ex[$Eo]=$E_)}if($EO.ambientTexture){var $Ei=$EO.ambientTexture.texture2D;$Ei&&($E_=$Ep._getMaterialTexturePath($Ei,$Eq,$EH),$ET.push($E_),$Ex[$Ei]=$E_)}if($EO.reflectTexture){var $EW=$EO.reflectTexture.texture2D;$EW&&($E_=$Ep._getMaterialTexturePath($EW,$Eq,$EH),$ET.push($E_),$Ex[$EW]=$E_)}}var $Ey=$ET.length,$EA=$Ey+1,$EB=1/$EA;if($Ep._onProcessChange($EM,0,$EB,1),0<$Ey){var $Ek=$Eh.create(null,$Ep._onProcessChange,[$EM,$EB,$Ey/$EA],!1);$Ep._innerFourthLevelLoaderManager.create($ET,$Eh.create(null,$Ep._onMateialTexturesLoaded,[$EM,$Ek,$EL,$Ex]),$Ek,$Eze,null,1,!0,$Ee)}else $Ep._onMateialTexturesLoaded($EM,null,$EL,null)}},$Ep._onMateialTexturesLoaded=function($EM,$Ee,$EL,$E_){$EM.endLoad([$EL,$E_]),$Ee&&$Ee.recover()},$Ep._loadTextureCube=function($EM){$EM.on("loaded",null,$Ep._onTextureCubeLtcLoaded,[$EM]),$EM.load($EM.url,"json",!1,null,!0)},$Ep._onTextureCubeLtcLoaded=function($EM,$Ee){if($EM._class.destroyed)$EM.endLoad();else{var $EL=$Et.getPath($EM.url),$E_=[$Ep.formatRelativePath($EL,$Ee.px),$Ep.formatRelativePath($EL,$Ee.nx),$Ep.formatRelativePath($EL,$Ee.py),$Ep.formatRelativePath($EL,$Ee.ny),$Ep.formatRelativePath($EL,$Ee.pz),$Ep.formatRelativePath($EL,$Ee.nz)];$Ep._onProcessChange($EM,0,1/7,1);var $Ec=$Eh.create(null,$Ep._onProcessChange,[$EM,1/7,6/7],!1);$Ep._innerFourthLevelLoaderManager.load($E_,$Eh.create(null,$Ep._onTextureCubeImagesLoaded,[$EM,$E_,$Ec]),$Ec,"nativeimage")}},$Ep._onTextureCubeImagesLoaded=function($EM,$Ee,$EL){var $E_=[];$E_.length=6;for(var $Ec=0;$Ec<6;$Ec++){var $Eq=$Ee[$Ec];$E_[$Ec]=$EC.getRes($Eq),$EC.clearRes($Eq)}$EM.endLoad($E_),$EL.recover()},$Ep._onProcessChange=function($EM,$Ee,$EL,$E_){($E_=$Ee+$E_*$EL)<1&&$EM.event("progress",$E_)},$Ep.init=function($EM,$Ee,$EL,$E_,$Ec,$Eq){if(void 0===$EL&&($EL=!1),void 0===$E_&&($E_=!1),void 0===$Ec&&($Ec=!0),void 0===$Eq&&($Eq=!0),$EK.update3DLoop=function(){},$EK.cancelLoadByUrl=function($EM){$Ep._cancelLoadByUrl($EM)},$Ex.isAntialias=$EL,$Ex.isAlpha=$E_,$Ex.premultipliedAlpha=$Ec,$Ex.isStencil=$Eq,!$ES.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$EK.changeWebGLSize=$Ep._changeWebGLSize,$Er.is3DMode=!0,$Ei.init($EM,$Ee),$Ea.__init__(),$EGe.__init__(),$EZe.__init__(),$Ew.__init__(),$Ep.__init__(),$EH.maxTextureCount=2,($Ep.debugMode||$EN.debugMode)&&($Ep._debugPhasorSprite=new $EY)},$Ep.HIERARCHY="SPRITE3DHIERARCHY",$Ep.MESH="MESH",$Ep.MATERIAL="MATERIAL",$Ep.PBRMATERIAL="PBRMTL",$Ep.TEXTURECUBE="TEXTURECUBE",$Ep.TERRAIN="TERRAIN",$Ep._readData=null,$Ep._debugPhasorSprite=null,$Ep.debugMode=!1,$EG($Ep,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $Ee},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $Ee},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $Ee},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $Ee}]),$Ep}(),$EKe=function($EM){function $Ec($EM){$Ec.__super.call(this),this._owner=$EM,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$EE($Ec,"laya.d3.animation.AnimationTransform3D",$Eq);var $Ee=$Ec.prototype;return $Ee._getlocalMatrix=function(){return this._localUpdate&&($E$e._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$Ee._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._onWorldTransform()}},$Ee._setWorldMatrixAndUpdate=function($EM){if(this._worldMatrix=$EM,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $Ee=this._getlocalMatrix(),$EL=0;$EL<16;++$EL)this._worldMatrix[$EL]=$Ee[$EL];else $E$e.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$Ee._setWorldMatrixNoUpdate=function($EM){this._worldMatrix=$EM},$Ee._setWorldMatrixIgnoreUpdate=function($EM){this._worldMatrix=$EM,this._worldUpdate=!1},$Ee.getLocalPosition=function(){return this._localPosition},$Ee.setLocalPosition=function($EM){if(this._parent)this._localPosition=$EM,this._localUpdate=!0,this._onWorldTransform();else{var $Ee=this._entity.owner._transform,$EL=this._entity.localPosition,$E_=$EL.elements;$E_[0]=$EM[0],$E_[1]=$EM[1],$E_[2]=$EM[2],$Ee.localPosition=$EL}},$Ee.getLocalRotation=function(){if(this._localQuaternionUpdate){var $EM=this._localRotationEuler;$E$e._quaternionCreateFromYawPitchRollArray($EM[1]/$Ec._angleToRandin,$EM[0]/$Ec._angleToRandin,$EM[2]/$Ec._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$Ee.setLocalRotation=function($EM){if(this._parent)this._localRotation=$EM,$E$e.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $Ee=this._entity.owner._transform,$EL=this._entity.localRotation,$E_=$EL.elements;$E_[0]=$EM[0],$E_[1]=$EM[1],$E_[2]=$EM[2],$E_[3]=$EM[3],$Ee.localRotation=$EL}},$Ee.getLocalScale=function(){return this._localScale},$Ee.setLocalScale=function($EM){if(this._parent)this._localScale=$EM,this._localUpdate=!0,this._onWorldTransform();else{var $Ee=this._entity.owner._transform,$EL=this._entity.localScale,$E_=$EL.elements;$E_[0]=$EM[0],$E_[1]=$EM[1],$E_[2]=$EM[2],$Ee.localScale=$EL}},$Ee.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$E$e.getYawPitchRoll(this._localRotation,$Ec._tempVector3);var $EM=$Ec._tempVector3,$Ee=this._localRotationEuler;$Ee[0]=$EM[1]*$Ec._angleToRandin,$Ee[1]=$EM[0]*$Ec._angleToRandin,$Ee[2]=$EM[2]*$Ec._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$Ee.setLocalRotationEuler=function($EM){if(this._parent)$E$e._quaternionCreateFromYawPitchRollArray($EM[1]/$Ec._angleToRandin,$EM[0]/$Ec._angleToRandin,$EM[2]/$Ec._angleToRandin,this._localRotation),this._localRotationEuler=$EM,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $Ee=this._entity.owner._transform,$EL=this._entity.localRotationEuler,$E_=$EL.elements;$E_[0]=$EM[0],$E_[1]=$EM[1],$E_[2]=$EM[2],$Ee.localRotationEuler=$EL}},$Ee.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$E$e.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $EM=this._getlocalMatrix(),$Ee=0;$Ee<16;++$Ee)this._worldMatrix[$Ee]=$EM[$Ee];this._worldUpdate=!1}return this._worldMatrix},$Ee.setParent=function($EM){if(this._parent!==$EM){if(this._parent){var $Ee=this._parent._childs,$EL=$Ee.indexOf(this);$Ee.splice($EL,1)}$EM&&($EM._childs.push(this),$EM&&this._onWorldTransform()),this._parent=$EM}},$EG($Ec,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$Ec}(),$EXe=function($EM){function $Ee(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$Ee.__super.call(this),this._destroyed=!1,this._id=$Ee._uniqueIDCounter,$Ee._uniqueIDCounter++}$EE($Ee,"laya.d3.component.Component3D",$Eq);var $EL=$Ee.prototype;return $Ei.imps($EL,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$EL._initialize=function($EM){this._owner=$EM,this._enable=!0,this.started=!1,this._load($EM)},$EL._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$EL._load=function($EM){},$EL._start=function($EM){},$EL._update=function($EM){},$EL._lateUpdate=function($EM){},$EL._preRenderUpdate=function($EM){},$EL._postRenderUpdate=function($EM){},$EL._unload=function($EM){this.offAll()},$EL._cloneTo=function($EM){},$Ed(0,$EL,"id",function(){return this._id}),$Ed(0,$EL,"destroyed",function(){return this._destroyed}),$Ed(0,$EL,"owner",function(){return this._owner}),$Ed(0,$EL,"enable",function(){return this._enable},function($EM){this._enable!==$EM&&(this._enable=$EM,this.event("enablechanged",this._enable))}),$Ed(0,$EL,"isSingleton",function(){return $Ee._isSingleton}),$Ee._isSingleton=!0,$Ee._uniqueIDCounter=1,$Ee}(),$Eoe=function($EM){function $Ee(){this._destroyed=!1,$Ee.__super.call(this),this._destroyed=!1}$EE($Ee,"laya.d3.core.GeometryFilter",$Eq);var $EL=$Ee.prototype;return $Ei.imps($EL,{"laya.resource.IDestroy":!0}),$EL._destroy=function(){this.offAll(),this._destroyed=!0},$Ed(0,$EL,"_isAsyncLoaded",function(){return!0}),$Ed(0,$EL,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$Ed(0,$EL,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$Ed(0,$EL,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$Ed(0,$EL,"destroyed",function(){return this._destroyed}),$Ee}(),$Eie=function($EM){function $E_($EM){$E_.__super.call(this),this._id=++$E_._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $ENM(new $EHe,new $EHe),this._boundingBoxCenter=new $EHe,this._boundingSphere=new $EDM(new $EHe,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$EM,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$EE($E_,"laya.d3.core.render.BaseRender",$Eq);var $Ee=$E_.prototype;return $Ei.imps($Ee,{"laya.resource.IDestroy":!0}),$Ee._changeMaterialReference=function($EM,$Ee){$EM&&$EM._removeReference(),$Ee._addReference()},$Ee._getInstanceMaterial=function($EM,$Ee){var $EL=new $EM.constructor;return $EM.cloneTo($EL),$EL.name=$EL.name+"(Instance)",this._materialsInstance[$Ee]=!0,this._changeMaterialReference(this._materials[$Ee],$EL),this._materials[$Ee]=$EL},$Ee._setShaderValuelightMap=function($EM){this._setShaderValueTexture(3,$EM)},$Ee._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$Ee._renderRenderableBoundBox=function(){var $EM=$ECe._debugPhasorSprite,$Ee=this.boundingBox,$EL=$E_._tempBoundBoxCorners;$Ee.getCorners($EL),$EM.line($EL[0],$E_._greenColor,$EL[1],$E_._greenColor),$EM.line($EL[2],$E_._greenColor,$EL[3],$E_._greenColor),$EM.line($EL[4],$E_._greenColor,$EL[5],$E_._greenColor),$EM.line($EL[6],$E_._greenColor,$EL[7],$E_._greenColor),$EM.line($EL[0],$E_._greenColor,$EL[3],$E_._greenColor),$EM.line($EL[1],$E_._greenColor,$EL[2],$E_._greenColor),$EM.line($EL[2],$E_._greenColor,$EL[6],$E_._greenColor),$EM.line($EL[3],$E_._greenColor,$EL[7],$E_._greenColor),$EM.line($EL[0],$E_._greenColor,$EL[4],$E_._greenColor),$EM.line($EL[1],$E_._greenColor,$EL[5],$E_._greenColor),$EM.line($EL[4],$E_._greenColor,$EL[7],$E_._greenColor),$EM.line($EL[5],$E_._greenColor,$EL[6],$E_._greenColor)},$Ee._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$Ee._calculateBoundingBox=function(){throw"BaseRender: must override it."},$Ee._setShaderValueTexture=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee)},$Ee._setShaderValueMatrix4x4=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee?$Ee.elements:null)},$Ee._setShaderValueColor=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee?$Ee.elements:null)},$Ee._setShaderValueBuffer=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee)},$Ee._setShaderValueInt=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee)},$Ee._setShaderValueBool=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee)},$Ee._setShaderValueNumber=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee)},$Ee._setShaderValueVector2=function($EM,$Ee){this._owner._shaderValues.setValue($EM,$Ee?$Ee.elements:null)},$Ee._addShaderDefine=function($EM){this._owner._shaderDefineValue|=$EM},$Ee._removeShaderDefine=function($EM){this._owner._shaderDefineValue&=~$EM},$Ee._renderUpdate=function($EM){return!0},$Ee._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $EM=this._owner.scene;if($EM){var $Ee=$EM.getlightmaps()[this._lightmapIndex];$Ee?(this._addShaderDefine($EYe.SAHDERDEFINE_LIGHTMAP),$Ee.loaded?this._setShaderValuelightMap($Ee):$Ee.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($EYe.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($EYe.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($EYe.SAHDERDEFINE_LIGHTMAP)},$Ee._updateOctreeNode=function(){var $EM=this._treeNode;$EM&&this._octreeNodeNeedChange&&($EM.updateObject(this),this._octreeNodeNeedChange=!1)},$Ee._destroy=function(){this.offAll();var $EM=0,$Ee=0;for($EM=0,$Ee=this._renderElements.length;$EM<$Ee;$EM++)this._renderElements[$EM]._destroy();for($EM=0,$Ee=this._materials.length;$EM<$Ee;$EM++)this._materials[$EM]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$Ed(0,$Ee,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$Ed(0,$Ee,"id",function(){return this._id}),$Ed(0,$Ee,"material",function(){var $EM=this._materials[0];if($EM&&!this._materialsInstance[0]){var $Ee=this._getInstanceMaterial($EM,0);this.event("materialchanged",[this,0,$Ee])}return this._materials[0]},function($EM){this.sharedMaterial=$EM}),$Ed(0,$Ee,"sharedMaterial",function(){return this._materials[0]},function($EM){var $Ee=this._materials[0];$Ee!==$EM&&(this._materials[0]=$EM,this._materialsInstance[0]=!1,this._changeMaterialReference($Ee,$EM),this.event("materialchanged",[this,0,$EM]))}),$Ed(0,$Ee,"lightmapIndex",function(){return this._lightmapIndex},function($EM){this._lightmapIndex=$EM,this._applyLightMapParams()}),$Ed(0,$Ee,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($EM){this._lightmapScaleOffset=$EM,this._setShaderValueColor(2,$EM),this._addShaderDefine($EYe.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$Ed(0,$Ee,"enable",function(){return this._enable},function($EM){this._enable=$EM,this.event("enablechanged",[this,$EM])}),$Ed(0,$Ee,"materials",function(){for(var $EM=0,$Ee=this._materials.length;$EM<$Ee;$EM++)if(!this._materialsInstance[$EM]){var $EL=this._getInstanceMaterial(this._materials[$EM],$EM);this.event("materialchanged",[this,$EM,$EL])}return this._materials.slice()},function($EM){this.sharedMaterials=$EM}),$Ed(0,$Ee,"sharedMaterials",function(){return this._materials.slice()},function($EM){if(!$EM)throw new Error("MeshRender: shadredMaterials value can't be null.");var $Ee=$EM.length;this._materialsInstance.length=$Ee;for(var $EL=0;$EL<$Ee;$EL++){var $E_=this._materials[$EL];$E_!==$EM[$EL]&&(this._materialsInstance[$EL]=!1,this._changeMaterialReference($E_,$EM[$EL]),this.event("materialchanged",[this,$EL,$EM[$EL]]))}this._materials=$EM}),$Ed(0,$Ee,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$Ed(0,$Ee,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $EM=this.boundingBox;$EHe.add($EM.min,$EM.max,this._boundingBoxCenter),$EHe.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$Ed(0,$Ee,"receiveShadow",function(){return this._receiveShadow},function($EM){this._receiveShadow!==$EM&&((this._receiveShadow=$EM)?this._addShaderDefine($EEe.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($EEe.SHADERDEFINE_RECEIVE_SHADOW))}),$Ed(0,$Ee,"destroyed",function(){return this._destroyed}),$E_._uniqueIDCounter=0,$EG($E_,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe,new $EHe]},"_greenColor",function(){return this._greenColor=new $ETe(0,1,0,1)}]),$E_}(),$EWe=function($EM){function $ET($EM){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$ET.__super.call(this),this._localPosition=new $EHe,this._localRotation=new $ELe(0,0,0,1),this._localScale=new $EHe(1,1,1),this._localRotationEuler=new $EHe,this._localMatrix=new $EMe,this._position=new $EHe,this._rotation=new $ELe(0,0,0,1),this._scale=new $EHe(1,1,1),this._worldMatrix=new $EMe,this._forward=new $EHe,this._up=new $EHe,this._right=new $EHe,this._owner=$EM,this._childs=[]}$EE($ET,"laya.d3.core.Transform3D",$Eq);var $Ee=$ET.prototype;return $Ee._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$EMe.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $EM=$ET._tempVector30;$EHe.multiply(this.pivot,this._localScale,$EM);var $Ee=$ET._tempVector31;$EHe.subtract($EM,this.pivot,$Ee);var $EL=$ET._tempVector32,$E_=this.localRotation;$EHe.transformQuat($EM,$E_,$EL),$EHe.subtract($EL,$EM,$EL);var $Ec=$ET._tempVector33;$EHe.subtract(this._localPosition,$Ee,$Ec),$EHe.subtract($Ec,$EL,$Ec),$EMe.createAffineTransformation($Ec,$E_,this._localScale,this._localMatrix)}},$Ee._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._onWorldPositionRotationTransform()}},$Ee._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._onWorldPositionScaleTransform()}},$Ee._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._onWorldPositionTransform()}},$Ee._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._onWorldPositionRotationTransform()}},$Ee._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._onWorldPositionScaleTransform()}},$Ee._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._onWorldTransform()}},$Ee.translate=function($EM,$Ee){void 0===$Ee&&($Ee=!0),$Ee?($EMe.createFromQuaternion(this.localRotation,$ET._tempMatrix0),$EHe.transformCoordinate($EM,$ET._tempMatrix0,$ET._tempVector30),$EHe.add(this.localPosition,$ET._tempVector30,this._localPosition),this.localPosition=this._localPosition):($EHe.add(this.position,$EM,this._position),this.position=this._position)},$Ee.rotate=function($EM,$Ee,$EL){var $E_;void 0===$Ee&&($Ee=!0),void 0===$EL&&($EL=!0),$E_=$EL?$EM:($EHe.scale($EM,Math.PI/180,$ET._tempVector30),$ET._tempVector30),$ELe.createFromYawPitchRoll($E_.y,$E_.x,$E_.z,$ET._tempQuaternion0),$Ee?($ELe.multiply(this._localRotation,$ET._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($ELe.multiply($ET._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$Ee.lookAt=function($EM,$Ee,$EL){void 0===$EL&&($EL=!1);var $E_,$Ec=$EM.elements;if($EL){if($E_=this._localPosition.elements,Math.abs($E_[0]-$Ec[0])<$EUM.zeroTolerance&&Math.abs($E_[1]-$Ec[1])<$EUM.zeroTolerance&&Math.abs($E_[2]-$Ec[2])<$EUM.zeroTolerance)return;$ELe.lookAt(this._localPosition,$EM,$Ee,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $Eq=this.position;if($E_=$Eq.elements,Math.abs($E_[0]-$Ec[0])<$EUM.zeroTolerance&&Math.abs($E_[1]-$Ec[1])<$EUM.zeroTolerance&&Math.abs($E_[2]-$Ec[2])<$EUM.zeroTolerance)return;$ELe.lookAt($Eq,$EM,$Ee,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$Ed(0,$Ee,"_isFrontFaceInvert",function(){var $EM=this.scale,$Ee=$EM.x<0;return $EM.y<0&&($Ee=!$Ee),$EM.z<0&&($Ee=!$Ee),$Ee}),$Ed(0,$Ee,"owner",function(){return this._owner}),$Ed(0,$Ee,"localRotation",function(){if(this._localQuaternionUpdate){var $EM=this._localRotationEuler.elements;$ELe.createFromYawPitchRoll($EM[1]/$ET._angleToRandin,$EM[0]/$ET._angleToRandin,$EM[2]/$ET._angleToRandin,this._localRotation)}return this._localRotation},function($EM){this._localRotation=$EM,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$Ed(0,$Ee,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$EMe.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($EM){null===this._parent?$EM.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$EMe.multiply(this._localMatrix,$EM,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$EM,this._worldUpdate=!1}),$Ed(0,$Ee,"worldNeedUpdate",function(){return this._worldUpdate}),$Ed(0,$Ee,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($EM){this._localMatrix=$EM,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$Ed(0,$Ee,"dummy",function(){return this._dummy},function($EM){this._dummy!==$EM&&(this._dummy&&(this._dummy._entity=null),$EM&&($EM._entity=this),this._dummy=$EM)}),$Ed(0,$Ee,"localPosition",function(){return this._localPosition},function($EM){this._localPosition=$EM,this._localUpdate=!0,this._onWorldPositionTransform()}),$Ed(0,$Ee,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $EM=this._parent.position;$EHe.multiply(this._localPosition,this._parent.scale,$ET._tempVector30),$EHe.transformQuat($ET._tempVector30,this._parent.rotation,$ET._tempVector30),$EHe.add($EM,$ET._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($EM){if(null!=this._parent){$EHe.subtract($EM,this._parent.position,this._localPosition);var $Ee=this._parent.scale.elements,$EL=$Ee[0],$E_=$Ee[1],$Ec=$Ee[2];if(1!==$EL||1!==$E_||1!==$Ec){var $Eq=$ET._tempVector30,$EH=$Eq.elements;$EH[0]=1/$EL,$EH[1]=1/$E_,$EH[2]=1/$Ec,$EHe.multiply(this._localPosition,$Eq,this._localPosition)}this._parent.rotation.invert($ET._tempQuaternion0),$EHe.transformQuat(this._localPosition,$ET._tempQuaternion0,this._localPosition)}else $EM.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$EM,this._positionUpdate=!1}),$Ed(0,$Ee,"localScale",function(){return this._localScale},function($EM){this._localScale=$EM,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$Ed(0,$Ee,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($ET._tempVector30);var $EM=$ET._tempVector30.elements,$Ee=this._localRotationEuler.elements;$Ee[0]=$EM[1]*$ET._angleToRandin,$Ee[1]=$EM[0]*$ET._angleToRandin,$Ee[2]=$EM[2]*$ET._angleToRandin}return this._localRotationEuler},function($EM){this._localRotationEuler=$EM,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$Ed(0,$Ee,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$ELe.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($EM){null!=this._parent?(this._parent.rotation.invert($ET._tempQuaternion0),$ELe.multiply($EM,$ET._tempQuaternion0,this._localRotation)):$EM.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$EM,this._rotationUpdate=!1}),$Ed(0,$Ee,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$EHe.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($EM){if(null!==this._parent){var $Ee=this._parent.scale.elements,$EL=$ET._tempVector30.elements;$EL[0]=1/$Ee[0],$EL[1]=1/$Ee[1],$EL[2]=1/$Ee[2],$EHe.multiply($EM,$ET._tempVector30,this._localScale)}else $EM.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$EM,this._scaleUpdate=!1}),$Ed(0,$Ee,"rotationEuler",null,function($EM){$ELe.createFromYawPitchRoll($EM.y,$EM.x,$EM.z,this._rotation),this.rotation=this._rotation}),$Ed(0,$Ee,"forward",function(){var $EM=this.worldMatrix.elements;return this._forward.elements[0]=-$EM[8],this._forward.elements[1]=-$EM[9],this._forward.elements[2]=-$EM[10],this._forward}),$Ed(0,$Ee,"up",function(){var $EM=this.worldMatrix.elements;return this._up.elements[0]=$EM[4],this._up.elements[1]=$EM[5],this._up.elements[2]=$EM[6],this._up}),$Ed(0,$Ee,"right",function(){var $EM=this.worldMatrix.elements;return this._right.elements[0]=$EM[0],this._right.elements[1]=$EM[1],this._right.elements[2]=$EM[2],this._right}),$Ed(0,$Ee,"parent",function(){return this._parent},function($EM){if(this._parent!==$EM){if(this._parent){var $Ee=this._parent._childs,$EL=$Ee.indexOf(this);$Ee.splice($EL,1)}$EM&&($EM._childs.push(this),$EM&&this._onWorldTransform()),this._parent=$EM}}),$EG($ET,["_tempVector30",function(){return this._tempVector30=new $EHe},"_tempVector31",function(){return this._tempVector31=new $EHe},"_tempVector32",function(){return this._tempVector32=new $EHe},"_tempVector33",function(){return this._tempVector33=new $EHe},"_tempQuaternion0",function(){return this._tempQuaternion0=new $ELe},"_tempMatrix0",function(){return this._tempMatrix0=new $EMe},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$ET}(),$Eye=(function($EM){function $Ee(){this._rotation=0,this._matNeedUpdte=!1,$Ee.__super.call(this),this._matrix=new $EMe,this._offset=new $Eqe,this._tiling=new $Eqe(1,1)}$EE($Ee,"laya.d3.core.TransformUV",$Eq);var $EL=$Ee.prototype;$Ei.imps($EL,{"laya.d3.core.IClone":!0}),$EL._updateMatrix=function(){$Ee._tempOffsetV3.elements[0]=this._offset.x,$Ee._tempOffsetV3.elements[1]=this._offset.y,$ELe.createFromYawPitchRoll(0,0,this._rotation,$Ee._tempRotationQua),$Ee._tempTitlingV3.elements[0]=this._tiling.x,$Ee._tempTitlingV3.elements[1]=this._tiling.y,$EMe.createAffineTransformation($Ee._tempOffsetV3,$Ee._tempRotationQua,$Ee._tempTitlingV3,this._matrix)},$EL.cloneTo=function($EM){$EM._matrix=this._matrix.clone(),$EM._offset=this._offset.clone(),$EM._rotation=this._rotation,$EM._tiling=this._tiling.clone()},$EL.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$EL,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$Ed(0,$EL,"tiling",function(){return this._tiling},function($EM){this._tiling=$EM,this._matNeedUpdte=!0}),$Ed(0,$EL,"offset",function(){return this._offset},function($EM){this._offset=$EM,this._matNeedUpdte=!0}),$Ed(0,$EL,"rotation",function(){return this._rotation},function($EM){this._rotation=$EM,this._matNeedUpdte=!0}),$EG($Ee,["_tempOffsetV3",function(){return this._tempOffsetV3=new $EHe(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $ELe},"_tempTitlingV3",function(){return this._tempTitlingV3=new $EHe(1,1,1)}])}(),function($EL){function $EM(){this.x=NaN,this.y=NaN,this.z=NaN,$EM.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$EE($EM,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$EL);var $Ee=$EM.prototype;$Ee._getShapeBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=.5*-this.x,$Ee[1]=.5*-this.y,$Ee[2]=.5*-this.z;var $EL=$EM.max.elements;$EL[0]=.5*this.x,$EL[1]=.5*this.y,$EL[2]=.5*this.z},$Ee._getSpeedBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=0,$Ee[1]=0,$Ee[2]=0;var $EL=$EM.max.elements;$EL[0]=0,$EL[1]=1,$EL[2]=0},$Ee.generatePositionAndDirection=function($EM,$Ee,$EL,$E_){var $Ec=$EM.elements,$Eq=$Ee.elements;$EL?($EL.seed=$E_[16],$Ez._randomPointInsideHalfUnitBox($EM,$EL),$E_[16]=$EL.seed):$Ez._randomPointInsideHalfUnitBox($EM),$Ec[0]=this.x*$Ec[0],$Ec[1]=this.y*$Ec[1],$Ec[2]=this.z*$Ec[2],this.randomDirection?$EL?($EL.seed=$E_[17],$Ez._randomPointUnitSphere($Ee,$EL),$E_[17]=$EL.seed):$Ez._randomPointUnitSphere($Ee):($Eq[0]=0,$Eq[1]=0,$Eq[2]=1)},$Ee.cloneTo=function($EM){$EL.prototype.cloneTo.call(this,$EM);var $Ee=$EM;$Ee.x=this.x,$Ee.y=this.y,$Ee.z=this.z,$Ee.randomDirection=this.randomDirection}}($Eg),function($EL){function $EH(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$EH.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$EE($EH,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$EL);var $EM=$EH.prototype;$EM._getShapeBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=$Ee[2]=-this.radius,$Ee[1]=0;var $EL=$EM.max.elements;$EL[0]=$EL[2]=this.radius,$EL[1]=0},$EM._getSpeedBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=$Ee[1]=-1,$Ee[2]=0;var $EL=$EM.max.elements;$EL[0]=$EL[1]=1,$EL[2]=0},$EM.generatePositionAndDirection=function($EM,$Ee,$EL,$E_){var $Ec=$EM.elements,$Eq=$EH._tempPositionPoint.elements;$EL?($EL.seed=$E_[16],this.emitFromEdge?$Ez._randomPointUnitArcCircle(this.arc,$EH._tempPositionPoint,$EL):$Ez._randomPointInsideUnitArcCircle(this.arc,$EH._tempPositionPoint,$EL),$E_[16]=$EL.seed):this.emitFromEdge?$Ez._randomPointUnitArcCircle(this.arc,$EH._tempPositionPoint):$Ez._randomPointInsideUnitArcCircle(this.arc,$EH._tempPositionPoint),$Ec[0]=-$Eq[0],$Ec[1]=$Eq[1],$Ec[2]=0,$EHe.scale($EM,this.radius,$EM),this.randomDirection?$EL?($EL.seed=$E_[17],$Ez._randomPointUnitSphere($Ee,$EL),$E_[17]=$EL.seed):$Ez._randomPointUnitSphere($Ee):$EM.cloneTo($Ee)},$EM.cloneTo=function($EM){$EL.prototype.cloneTo.call(this,$EM);var $Ee=$EM;$Ee.radius=this.radius,$Ee.arc=this.arc,$Ee.emitFromEdge=this.emitFromEdge,$Ee.randomDirection=this.randomDirection},$EG($EH,["_tempPositionPoint",function(){return this._tempPositionPoint=new $Eqe}])}($Eg),function($EL){function $EV(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$EV.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$EE($EV,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$EL);var $EM=$EV.prototype;$EM._getShapeBoundBox=function($EM){var $Ee=this.radius+this.length*Math.sin(this.angle),$EL=this.length*Math.cos(this.angle),$E_=$EM.min.elements;$E_[0]=$E_[1]=-$Ee,$E_[2]=0;var $Ec=$EM.max.elements;$Ec[0]=$Ec[1]=$Ee,$Ec[2]=$EL},$EM._getSpeedBoundBox=function($EM){var $Ee=Math.sin(this.angle),$EL=$EM.min.elements;$EL[0]=$EL[1]=-$Ee,$EL[2]=0;var $E_=$EM.max.elements;$E_[0]=$EL[1]=$Ee,$E_[2]=1},$EM.generatePositionAndDirection=function($EM,$Ee,$EL,$E_){var $Ec,$Eq=$EM.elements,$EH=$Ee.elements,$ET=$EV._tempPositionPoint.elements,$Ex=NaN,$EO=NaN,$Eu=Math.cos(this.angle),$EG=Math.sin(this.angle);switch(this.emitType){case 0:$EL?($EL.seed=$E_[16],$Ez._randomPointInsideUnitCircle($EV._tempPositionPoint,$EL),$E_[16]=$EL.seed):$Ez._randomPointInsideUnitCircle($EV._tempPositionPoint),$Ex=$ET[0],$EO=$ET[1],$Eq[0]=$Ex*this.radius,$Eq[1]=$EO*this.radius,$Eq[2]=0,this.randomDirection?($EL?($EL.seed=$E_[17],$Ez._randomPointInsideUnitCircle($EV._tempDirectionPoint,$EL),$E_[17]=$EL.seed):$Ez._randomPointInsideUnitCircle($EV._tempDirectionPoint),$Ec=$EV._tempDirectionPoint.elements,$EH[0]=$Ec[0]*$EG,$EH[1]=$Ec[1]*$EG):($EH[0]=$Ex*$EG,$EH[1]=$EO*$EG),$EH[2]=$Eu;break;case 1:$EL?($EL.seed=$E_[16],$Ez._randomPointUnitCircle($EV._tempPositionPoint,$EL),$E_[16]=$EL.seed):$Ez._randomPointUnitCircle($EV._tempPositionPoint),$Ex=$ET[0],$EO=$ET[1],$Eq[0]=$Ex*this.radius,$Eq[1]=$EO*this.radius,$Eq[2]=0,this.randomDirection?($EL?($EL.seed=$E_[17],$Ez._randomPointInsideUnitCircle($EV._tempDirectionPoint,$EL),$E_[17]=$EL.seed):$Ez._randomPointInsideUnitCircle($EV._tempDirectionPoint),$Ec=$EV._tempDirectionPoint.elements,$EH[0]=$Ec[0]*$EG,$EH[1]=$Ec[1]*$EG):($EH[0]=$Ex*$EG,$EH[1]=$EO*$EG),$EH[2]=$Eu;break;case 2:$EL?($EL.seed=$E_[16],$Ez._randomPointInsideUnitCircle($EV._tempPositionPoint,$EL)):$Ez._randomPointInsideUnitCircle($EV._tempPositionPoint),$Ex=$ET[0],$EO=$ET[1],$Eq[0]=$Ex*this.radius,$Eq[1]=$EO*this.radius,$EH[$Eq[2]=0]=$Ex*$EG,$EH[1]=$EO*$EG,$EH[2]=$Eu,$EHe.normalize($Ee,$Ee),$EL?($EHe.scale($Ee,this.length*$EL.getFloat(),$Ee),$E_[16]=$EL.seed):$EHe.scale($Ee,this.length*Math.random(),$Ee),$EHe.add($EM,$Ee,$EM),this.randomDirection&&($EL?($EL.seed=$E_[17],$Ez._randomPointUnitSphere($Ee,$EL),$E_[17]=$EL.seed):$Ez._randomPointUnitSphere($Ee));break;case 3:$EL?($EL.seed=$E_[16],$Ez._randomPointUnitCircle($EV._tempPositionPoint,$EL)):$Ez._randomPointUnitCircle($EV._tempPositionPoint),$Ex=$ET[0],$EO=$ET[1],$Eq[0]=$Ex*this.radius,$Eq[1]=$EO*this.radius,$EH[$Eq[2]=0]=$Ex*$EG,$EH[1]=$EO*$EG,$EH[2]=$Eu,$EHe.normalize($Ee,$Ee),$EL?($EHe.scale($Ee,this.length*$EL.getFloat(),$Ee),$E_[16]=$EL.seed):$EHe.scale($Ee,this.length*Math.random(),$Ee),$EHe.add($EM,$Ee,$EM),this.randomDirection&&($EL?($EL.seed=$E_[17],$Ez._randomPointUnitSphere($Ee,$EL),$E_[17]=$EL.seed):$Ez._randomPointUnitSphere($Ee));break;default:throw new Error("ConeShape:emitType is invalid.")}},$EM.cloneTo=function($EM){$EL.prototype.cloneTo.call(this,$EM);var $Ee=$EM;$Ee.angle=this.angle,$Ee.radius=this.radius,$Ee.length=this.length,$Ee.emitType=this.emitType,$Ee.randomDirection=this.randomDirection},$EG($EV,["_tempPositionPoint",function(){return this._tempPositionPoint=new $Eqe},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $Eqe}])}($Eg),function($EL){function $EM(){this.radius=NaN,this.emitFromShell=!1,$EM.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$EE($EM,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$EL);var $Ee=$EM.prototype;$Ee._getShapeBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=$Ee[1]=$Ee[2]=-this.radius;var $EL=$EM.max.elements;$EL[0]=$EL[1]=this.radius,$EL[2]=0},$Ee._getSpeedBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=$Ee[1]=-1,$Ee[2]=0;var $EL=$EM.max.elements;$EL[0]=$EL[1]=$EL[2]=1},$Ee.generatePositionAndDirection=function($EM,$Ee,$EL,$E_){var $Ec=$EM.elements;$EL?($EL.seed=$E_[16],this.emitFromShell?$Ez._randomPointUnitSphere($EM,$EL):$Ez._randomPointInsideUnitSphere($EM,$EL),$E_[16]=$EL.seed):this.emitFromShell?$Ez._randomPointUnitSphere($EM):$Ez._randomPointInsideUnitSphere($EM),$EHe.scale($EM,this.radius,$EM);var $Eq=$Ec[2];$Eq<0&&($Ec[2]=-1*$Eq),this.randomDirection?$EL?($EL.seed=$E_[17],$Ez._randomPointUnitSphere($Ee,$EL),$E_[17]=$EL.seed):$Ez._randomPointUnitSphere($Ee):$EM.cloneTo($Ee)},$Ee.cloneTo=function($EM){$EL.prototype.cloneTo.call(this,$EM);var $Ee=$EM;$Ee.radius=this.radius,$Ee.emitFromShell=this.emitFromShell,$Ee.randomDirection=this.randomDirection}}($Eg),function($EL){function $EM(){this.radius=NaN,this.emitFromShell=!1,$EM.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$EE($EM,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$EL);var $Ee=$EM.prototype;$Ee._getShapeBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=$Ee[1]=$Ee[2]=-this.radius;var $EL=$EM.max.elements;$EL[0]=$EL[1]=$EL[2]=this.radius},$Ee._getSpeedBoundBox=function($EM){var $Ee=$EM.min.elements;$Ee[0]=$Ee[1]=$Ee[2]=-1;var $EL=$EM.max.elements;$EL[0]=$EL[1]=$EL[2]=1},$Ee.generatePositionAndDirection=function($EM,$Ee,$EL,$E_){$EL?($EL.seed=$E_[16],this.emitFromShell?$Ez._randomPointUnitSphere($EM,$EL):$Ez._randomPointInsideUnitSphere($EM,$EL),$E_[16]=$EL.seed):this.emitFromShell?$Ez._randomPointUnitSphere($EM):$Ez._randomPointInsideUnitSphere($EM),$EHe.scale($EM,this.radius,$EM),this.randomDirection?$EL?($EL.seed=$E_[17],$Ez._randomPointUnitSphere($Ee,$EL),$E_[17]=$EL.seed):$Ez._randomPointUnitSphere($Ee):$EM.cloneTo($Ee)},$Ee.cloneTo=function($EM){$EL.prototype.cloneTo.call(this,$EM);var $Ee=$EM;$Ee.radius=this.radius,$Ee.emitFromShell=this.emitFromShell,$Ee.randomDirection=this.randomDirection}}($Eg),function($EM){function $Ee(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$Ee.__super.call(this)}return $EE($Ee,"laya.d3.core.render.SubMeshRenderElement",$EP),$Ee}()),$EAe=function($EM){function $E$($EM,$Ee,$EL,$E_,$Ec,$Eq){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$EM,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$EEe.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$EYe.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$EYe.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$Ete.SHADERDEFINE_ALPHATEST]="ALPHATEST";$E$.__super.call(this,$EM,$Ee,$EL,null,{}),this._attributeMap=$E_;var $EH;for($EH in $Ec){var $ET=$Ec[$EH];switch($ET[1]){case 0:this._renderElementUniformMap[$EH]=$ET[0];break;case 1:this._materialUniformMap[$EH]=$ET[0];break;case 2:this._spriteUniformMap[$EH]=$ET[0];break;case 3:this._cameraUniformMap[$EH]=$ET[0];break;case 4:this._sceneUniformMap[$EH]=$ET[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$EE($E$,"laya.d3.shader.ShaderCompile3D",$EX);var $Ee=$E$.prototype;return $Ee._definesToNameDic=function($EM,$Ee){for(var $EL={},$E_=1,$Ec=0;$Ec<32&&!($EM<($E_=1<<$Ec));$Ec++)if($EM&$E_){var $Eq=$Ee[$E_];$Eq&&($EL[$Eq]="")}return $EL},$Ee.withCompile=function($EM,$Ee,$EL,$E_){var $Ec,$Eq,$EH;if($Eq=this.sharders[$EM])if($EH=$Eq[$Ee]){if($Ec=$EH[$EL])return $Ec}else $EH=$Eq[$Ee]=[];else $EH=($Eq=this.sharders[$EM]=[])[$Ee]=[];var $ET,$Ex=this._definesToNameDic($EM,$E$._globalInt2name),$EO=this._definesToNameDic($Ee,this._spriteInt2name),$Eu=this._definesToNameDic($EL,this._materialInt2name),$EG={},$EV="";if($Ex)for($ET in $Ex)$EV+="#define "+$ET+"\n",$EG[$ET]=!0;if($EO)for($ET in $EO)$EV+="#define "+$ET+"\n",$EG[$ET]=!0;if($Eu)for($ET in $Eu)$EV+="#define "+$ET+"\n",$EG[$ET]=!0;var $EE=$Efe.nameKey.getName(this._name)+" compile ("+$EM+","+$Ee+","+$EL+")",$Ed=this._VS.toscript($EG,[]),$Er=this._PS.toscript($EG,[]);$ER.now();if($Ec=$Efe.create($EV+$Ed.join("\n"),$EV+$Er.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$E_,$EE),$EH[$EL]=$Ec,laya.d3.shader.ShaderCompile3D.debugMode)$ER.now();return $Ec},$Ee.precompileShaderWithShaderDefine=function($EM,$Ee,$EL){this.withCompile($EM,$Ee,$EL,!0)},$Ee.addMaterialDefines=function($EM){var $Ee=$EM.defines;for(var $EL in $Ee){var $E_=$Ee[$EL],$Ec=parseInt($EL);this._materialInt2name[$Ec]=$E_,this._materialName2Int[$E_]=$Ec}},$Ee.addSpriteDefines=function($EM){var $Ee=$EM.defines;for(var $EL in $Ee){var $E_=$Ee[$EL],$Ec=parseInt($EL);this._spriteInt2name[$Ec]=$E_,this._spriteName2Int[$E_]=$Ec}},$Ee.getMaterialDefineByName=function($EM){return this._materialName2Int[$EM]},$Ee.registerMaterialDefine=function($EM){var $Ee=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$Ee]=$EM,this._materialName2Int[$EM]=$Ee},$Ee.registerSpriteDefine=function($EM){var $Ee=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$Ee]=$EM,this._spriteName2Int[$EM]=$Ee},$E$._globalRegDefine=function($EM,$Ee){$E$._globalInt2name[$Ee]=$EM},$E$.add=function($EM,$Ee,$EL,$E_,$Ec){return laya.d3.shader.ShaderCompile3D._preCompileShader[$EM]=new $E$($EM,$Ee,$EL,$E_,$Ec,$EX.includes)},$E$.get=function($EM){return laya.d3.shader.ShaderCompile3D._preCompileShader[$Efe.nameKey.getID($EM)]},$E$._preCompileShader={},$E$._globalInt2name=[],$E$.debugMode=!1,$E$.SHADERDEFINE_HIGHPRECISION=1,$E$.SHADERDEFINE_FOG=4,$E$.SHADERDEFINE_DIRECTIONLIGHT=8,$E$.SHADERDEFINE_POINTLIGHT=16,$E$.SHADERDEFINE_SPOTLIGHT=32,$E$.SHADERDEFINE_UV0=64,$E$.SHADERDEFINE_COLOR=128,$E$.SHADERDEFINE_UV1=256,$E$.SAHDERDEFINE_DEPTHFOG=131072,$E$}(),$EBe=function($EM){function $Ed(){$Ed.__super.call(this)}$EE($Ed,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$E_M);var $Ee=$Ed.prototype;return $Ee._getStaticBatch=function($EM,$Ee,$EL,$E_){var $Ec,$Eq;return $Eq=$EM?$EM.id.toString()+$EL.id.toString()+$Ee.id.toString()+$E_.toString():$EL.id.toString()+$Ee.id.toString()+$E_.toString(),this._staticBatches[$Eq]?$Ec=this._staticBatches[$Eq]:this._staticBatches[$Eq]=$Ec=new $Eke($Eq,this,$EM,$Ee,$EL),$Ec},$Ee._initStaticBatchs=function($EM){var $Ee,$EL;this._initBatchRenderElements.sort($Ed._sortPrepareStaticBatch);for(var $E_,$Ec=!1,$Eq=0,$EH=0,$ET=this._initBatchRenderElements.length;$EH<$ET;$EH++){var $Ex,$EO=this._initBatchRenderElements[$EH],$Eu=$EO.renderObj._getVertexBuffer(0);$EO._sprite3D;if($EL===$Eu.vertexDeclaration&&$Ee===$EO._material)if($Ec)$E_._addCombineBatchRenderObjTest($EO)?($Ex=$EO._staticBatch)!==$E_&&($Ex&&$Ex._deleteCombineBatchRenderObj($EO),$E_._addCombineBatchRenderObj($EO)):($Ec=!1,$Eq++);else{var $EG=this._initBatchRenderElements[$EH-1],$EV=$EG.renderObj,$EE=$EO.renderObj;$Ec=!(65535<$EV._getVertexBuffer().vertexCount+$EE._getVertexBuffer().vertexCount)&&($E_=this._getStaticBatch($EM,$EL,$Ee,$Eq),($Ex=$EG._staticBatch)!==$E_&&($Ex&&$Ex._deleteCombineBatchRenderObj($EG),$E_._addCombineBatchRenderObj($EG)),($Ex=$EO._staticBatch)!==$E_&&($Ex&&$Ex._deleteCombineBatchRenderObj($EO),$E_._addCombineBatchRenderObj($EO)),!0)}else $Ec=!1,$Eq=0;$Ee=$EO._material,$EL=$Eu.vertexDeclaration}},$Ed._sortPrepareStaticBatch=function($EM,$Ee){var $EL=$EM._render,$E_=$Ee._render,$Ec=$EL.lightmapIndex-$E_.lightmapIndex;if(0!=$Ec)return $Ec;var $Eq=$EL.receiveShadow-$E_.receiveShadow;if(0!=$Eq)return $Eq;var $EH=$EM._mainSortID-$Ee._mainSortID;return 0==$EH?$EM.renderObj.triangleCount-$Ee.renderObj.triangleCount:$EH},$Ed}(),$Eke=function($EM){function $Eq($EM,$Ee,$EL,$E_,$Ec){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$Eq.__super.call(this,$EM,$Ee,$EL),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$E_,this._material=$Ec}$EE($Eq,"laya.d3.graphics.SubMeshStaticBatch",$EcM);var $Ee=$Eq.prototype;return $Ee._compareBatchRenderElement=function($EM,$Ee){return $EM._batchIndexStart>$Ee._batchIndexStart},$Ee._addCombineBatchRenderObjTest=function($EM){var $Ee=$EM.renderObj._vertexCount;return!(65535<(0<$Ee?this._currentCombineVertexCount+$Ee:this._currentCombineVertexCount+$EM.renderObj._getVertexBuffer().vertexCount))},$Ee._addCombineBatchRenderObj=function($EM){var $Ee=$EM.renderObj,$EL=$Ee._vertexCount;this._initBatchRenderElements.push($EM),$EM._staticBatch=this,0<$EL?(this._currentCombineIndexCount+=$Ee._indexCount,this._currentCombineVertexCount+=$EL):(this._currentCombineIndexCount=this._currentCombineIndexCount+$Ee._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$Ee._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$Ee._deleteCombineBatchRenderObj=function($EM){var $Ee=$EM.renderObj,$EL=this._initBatchRenderElements.indexOf($EM);if(-1!==$EL){this._initBatchRenderElements.splice($EL,1),$EM._staticBatch=null;var $E_=$Ee._vertexCount;0<$E_?(this._currentCombineIndexCount=this._currentCombineIndexCount-$Ee._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$E_):(this._currentCombineIndexCount=this._currentCombineIndexCount-$Ee._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$Ee._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$Ee._finishInit=function(){if(this._needFinishCombine){var $EM=0,$Ee=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $EL=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$E_=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$Ege.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$EFe.create("ushort",this._currentCombineIndexCount,35044);for(var $Ec=0,$Eq=this._initBatchRenderElements.length;$Ec<$Eq;$Ec++){var $EH=this._initBatchRenderElements[$Ec],$ET=$EH.renderObj,$Ex=$ET._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$EH._sprite3D),$EO=$ET.getIndices(),$Eu=$EH._sprite3D.transform._isFrontFaceInvert,$EG=$EM/(this._vertexDeclaration.vertexStride/4)-$ET._vertexStart,$EV=$Ee,$EE=$EV+$EO.length;$EH._batchIndexStart=$EV,$EH._batchIndexEnd=$EE,$E_.set($EO,$Ee);var $Ed=0;if($Eu)for($Ed=$EV;$Ed<$EE;$Ed+=3){$E_[$Ed]=$EG+$E_[$Ed];var $Er=$E_[$Ed+1],$E$=$E_[$Ed+2];$E_[$Ed+1]=$EG+$E$,$E_[$Ed+2]=$EG+$Er}else for($Ed=$EV;$Ed<$EE;$Ed+=3)$E_[$Ed]=$EG+$E_[$Ed],$E_[$Ed+1]=$EG+$E_[$Ed+1],$E_[$Ed+2]=$EG+$E_[$Ed+2];$Ee+=$EO.length,$EL.set($Ex,$EM),$EM+=$Ex.length}this._vertexBuffer.setData($EL),this._indexBuffer.setData($E_),this._needFinishCombine=!1}},$Ee._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $Eye)},$Ee._getRenderElement=function($EM,$Ee,$EL){for(var $E_,$Ec,$Eq=this._batchRenderElements.length,$EH=!0,$ET=0;$ET<$Eq;$ET++){var $Ex,$EO,$Eu=($Ec=this._batchRenderElements[$ET])._sprite3D._render;if(0!==$ET&&($EH=($Ex=($E_=this._batchRenderElements[$ET-1])._sprite3D._render).lightmapIndex!==$Eu.lightmapIndex||$Ex.receiveShadow!==$Eu.receiveShadow||$E_._batchIndexEnd!==$Ec._batchIndexStart),$EH){($EO=this._getCombineRenderElementFromPool()).renderObj=this,$EO._material=this._material,$EO._batchIndexStart=$Ec._batchIndexStart,$EO._batchIndexEnd=$Ec._batchIndexEnd;var $EG=$Eu.lightmapIndex,$EV=$EG+1,$EE=this._batchOwnerIndices[$EV];$EE||($EE=this._batchOwnerIndices[$EV]=[]);var $Ed,$Er=$EE[$Ec._render.receiveShadow?1:0];void 0===$Er?($EE[$Eu.receiveShadow?1:0]=this._batchOwners.length,($Ed=new $EZe(null,"StaticBatchMeshSprite3D"))._scene=$Ee,$Ed._transform=this._rootOwner?this._rootOwner._transform:null,$Ed._render.lightmapIndex=$EG,$Ed._render.receiveShadow=$Ec._render.receiveShadow,this._batchOwners.push($Ed)):$Ed=this._batchOwners[$Er],$Ed._render._renderUpdate($EL),$EO._sprite3D=$Ed,$EM.push($EO)}else $EO._batchIndexEnd=$Ec._batchIndexEnd}},$Ee._beforeRender=function($EM){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Ee._render=function($EM){var $Ee=$EM.renderElement,$EL=$Ee._batchIndexStart,$E_=$Ee._batchIndexEnd-$EL;$ES.mainContext.drawElements(4,$E_,5123,2*$EL),$EA.drawCall++,$EA.trianglesFaces+=$E_/3},$Ee.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$Ee._getVertexBuffer=function($EM){return void 0===$EM&&($EM=0),this._vertexBuffer},$Eq}(),$Ehe=function($EM){function $Ee(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$Ee.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$EE($Ee,"laya.d3.core.ComponentNode",$EO);var $EL=$Ee.prototype;return $EL.addComponent=function($EM){var $Ee,$EL=this._componentsMap.indexOf($EM);if(-1===$EL)$Ee=[],this._componentsMap.push($EM),this._typeComponentsIndices.push($Ee);else if($Ee=this._typeComponentsIndices[$EL],this._components[$Ee[0]].isSingleton)throw new Error("无法单实例创建"+$EM+"组件，"+$EM+"组件已存在！");var $E_=$Ec.getInstance($EM);return $Ee.push(this._components.length),this._components.push($E_),$E_ instanceof laya.d3.component.Script&&this._scripts.push($E_),$E_._initialize(this),$E_},$EL._removeComponent=function($EM,$Ee){var $EL=this._typeComponentsIndices[$EM],$E_=$EL[$Ee],$Ec=this._components[$E_];this._components.splice($E_,1),$Ec instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($Ec),1),$EL.splice($Ee,1),0===$EL.length&&(this._typeComponentsIndices.splice($EM,1),this._componentsMap.splice($EM,1));for(var $Eq=0,$EH=this._componentsMap.length;$Eq<$EH;$Eq++)for(var $ET=($EL=this._typeComponentsIndices[$Eq]).length-1;0<=$ET;$ET--){var $Ex=$EL[$ET];if(!($E_<$Ex))break;$EL[$ET]=--$Ex}$Ec._destroy()},$EL.getComponentByType=function($EM,$Ee){void 0===$Ee&&($Ee=0);var $EL=this._componentsMap.indexOf($EM);return-1===$EL?null:this._components[this._typeComponentsIndices[$EL][$Ee]]},$EL.getComponentsByType=function($EM,$Ee){var $EL=this._componentsMap.indexOf($EM);if(-1!==$EL){var $E_=this._typeComponentsIndices[$EL],$Ec=$E_.length;$Ee.length=$Ec;for(var $Eq=0;$Eq<$Ec;$Eq++)$Ee[$Eq]=this._components[$E_[$Eq]]}else $Ee.length=0},$EL.getComponentByIndex=function($EM){return this._components[$EM]},$EL.removeComponentByType=function($EM,$Ee){void 0===$Ee&&($Ee=0);var $EL=this._componentsMap.indexOf($EM);-1!==$EL&&this._removeComponent($EL,$Ee)},$EL.removeComponentsByType=function($EM){var $Ee=this._componentsMap.indexOf($EM);if(-1!==$Ee)for(var $EL=this._typeComponentsIndices[$Ee],$E_=0,$Ec=$EL.length;$E_<$Ec;$EL.length<$Ec?$Ec--:$E_++)this._removeComponent($Ee,$E_)},$EL.removeAllComponent=function(){for(var $EM=0,$Ee=this._componentsMap.length;$EM<$Ee;this._componentsMap.length<$Ee?$Ee--:$EM++)this.removeComponentsByType(this._componentsMap[$EM])},$EL._updateComponents=function($EM){for(var $Ee=0,$EL=this._components.length;$Ee<$EL;$Ee++){var $E_=this._components[$Ee];!$E_.started&&($E_._start($EM),$E_.started=!0),$E_.enable&&$E_._update($EM)}},$EL._lateUpdateComponents=function($EM){for(var $Ee=0;$Ee<this._components.length;$Ee++){var $EL=this._components[$Ee];!$EL.started&&($EL._start($EM),$EL.started=!0),$EL.enable&&$EL._lateUpdate($EM)}},$EL._preRenderUpdateComponents=function($EM){for(var $Ee=0;$Ee<this._components.length;$Ee++){var $EL=this._components[$Ee];!$EL.started&&($EL._start($EM),$EL.started=!0),$EL.enable&&$EL._preRenderUpdate($EM)}},$EL._postRenderUpdateComponents=function($EM){for(var $Ee=0;$Ee<this._components.length;$Ee++){var $EL=this._components[$Ee];!$EL.started&&($EL._start($EM),$EL.started=!0),$EL.enable&&$EL._postRenderUpdate($EM)}},$Ee}(),$Ete=function($E_){function $EM(){$EM.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $EVe,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $ETe(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$EE($EM,"laya.d3.core.material.BaseMaterial",$E_);var $Ee=$EM.prototype;return $Ei.imps($Ee,{"laya.d3.core.IClone":!0}),$Ee._addShaderDefine=function($EM){this._shaderDefineValue|=$EM},$Ee._removeShaderDefine=function($EM){this._shaderDefineValue&=~$EM},$Ee._addDisablePublicShaderDefine=function($EM){this._disablePublicShaderDefine|=$EM},$Ee._removeDisablePublicShaderDefine=function($EM){this._disablePublicShaderDefine&=~$EM},$Ee._setBuffer=function($EM,$Ee){this._shaderValues.setValue($EM,$Ee),this._values[$EM]=$Ee},$Ee._getBuffer=function($EM){return this._values[$EM]},$Ee._setMatrix4x4=function($EM,$Ee){this._shaderValues.setValue($EM,$Ee?$Ee.elements:null),this._values[$EM]=$Ee},$Ee._getMatrix4x4=function($EM){return this._values[$EM]},$Ee._setInt=function($EM,$Ee){this._shaderValues.setValue($EM,$Ee),this._values[$EM]=$Ee},$Ee._getInt=function($EM){return this._values[$EM]},$Ee._setNumber=function($EM,$Ee){this._shaderValues.setValue($EM,$Ee),this._values[$EM]=$Ee},$Ee._getNumber=function($EM){return this._values[$EM]},$Ee._setBool=function($EM,$Ee){this._shaderValues.setValue($EM,$Ee),this._values[$EM]=$Ee},$Ee._getBool=function($EM){return this._values[$EM]},$Ee._setVector2=function($EM,$Ee){this._shaderValues.setValue($EM,$Ee?$Ee.elements:null),this._values[$EM]=$Ee},$Ee._getVector2=function($EM){return this._values[$EM]},$Ee._setColor=function($EM,$Ee){this._shaderValues.setValue($EM,$Ee?$Ee.elements:null),this._values[$EM]=$Ee},$Ee._getColor=function($EM){return this._values[$EM]},$Ee._setTexture=function($EM,$Ee){var $EL=this._values[$EM];this._values[$EM]=$Ee,this._shaderValues.setValue($EM,$Ee),0<this.referenceCount&&($EL&&$EL._removeReference(),$Ee&&$Ee._addReference())},$Ee._getTexture=function($EM){return this._values[$EM]},$Ee._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$Ee._getShader=function($EM,$Ee,$EL){var $E_=($EM|$Ee)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($E_,$EL,this._shaderDefineValue),this._shader},$Ee._setRenderStateBlendDepth=function(){var $EM=$ES.mainContext;switch($Ep.setDepthMask($EM,this.depthWrite),0===this.depthTest?$Ep.setDepthTest($EM,!1):($Ep.setDepthTest($EM,!0),$Ep.setDepthFunc($EM,this.depthTest)),this.blend){case 0:$Ep.setBlend($EM,!1);break;case 1:$Ep.setBlend($EM,!0),$Ep.setBlendFunc($EM,this.srcBlend,this.dstBlend);break;case 2:$Ep.setBlend($EM,!0)}},$Ee._setRenderStateFrontFace=function($EM,$Ee){var $EL=$ES.mainContext,$E_=0;switch(this.cull){case 0:$Ep.setCullFace($EL,!1);break;case 1:$Ep.setCullFace($EL,!0),$E_=$EM?$Ee&&$Ee._isFrontFaceInvert?2305:2304:$Ee&&$Ee._isFrontFaceInvert?2304:2305,$Ep.setFrontFace($EL,$E_);break;case 2:$Ep.setCullFace($EL,!0),$E_=$EM?$Ee&&$Ee._isFrontFaceInvert?2304:2305:$Ee&&$Ee._isFrontFaceInvert?2305:2304,$Ep.setFrontFace($EL,$E_)}},$Ee.onAsynLoaded=function($EM,$Ee,$EL){var $E_=$Ee[0],$Ec=$Ee[1];switch($E_.version){case"LAYAMATERIAL:01":var $Eq=0,$EH=0,$ET=$E_.props;for(var $Ex in $ET)switch($Ex){case"vectors":var $EO=$ET[$Ex];for($Eq=0,$EH=$EO.length;$Eq<$EH;$Eq++){var $Eu=$EO[$Eq],$EG=$Eu.value;switch($EG.length){case 2:this[$Eu.name]=new $Eqe($EG[0],$EG[1]);break;case 3:this[$Eu.name]=new $EHe($EG[0],$EG[1],$EG[2]);break;case 4:this[$Eu.name]=new $ETe($EG[0],$EG[1],$EG[2],$EG[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $EV=$ET[$Ex];for($Eq=0,$EH=$EV.length;$Eq<$EH;$Eq++){var $EE=$EV[$Eq],$Ed=$EE.path;$Ed&&(this[$EE.name]=$EC.getRes($Ec[$Ed]))}break;case"defines":var $Er=$ET[$Ex];for($Eq=0,$EH=$Er.length;$Eq<$EH;$Eq++){var $E$=this._shaderCompile.getMaterialDefineByName($Er[$Eq]);this._addShaderDefine($E$)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$Ex]=$ET[$Ex];break;case"renderQueue":switch($ET[$Ex]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$Ex]=$ET[$Ex]}break;case"LAYAMATERIAL:02":for($Ex in $ET=$E_.props)switch($Ex){case"vectors":for($Eq=0,$EH=($EO=$ET[$Ex]).length;$Eq<$EH;$Eq++)switch(($EG=($Eu=$EO[$Eq]).value).length){case 2:this[$Eu.name]=new $Eqe($EG[0],$EG[1]);break;case 3:this[$Eu.name]=new $EHe($EG[0],$EG[1],$EG[2]);break;case 4:this[$Eu.name]=new $ETe($EG[0],$EG[1],$EG[2],$EG[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($Eq=0,$EH=($EV=$ET[$Ex]).length;$Eq<$EH;$Eq++)($Ed=($EE=$EV[$Eq]).path)&&(this[$EE.name]=$EC.getRes($Ec[$Ed]));break;case"defines":for($Eq=0,$EH=($Er=$ET[$Ex]).length;$Eq<$EH;$Eq++)$E$=this._shaderCompile.getMaterialDefineByName($Er[$Eq]),this._addShaderDefine($E$);break;default:this[$Ex]=$ET[$Ex]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$Ee._addReference=function(){$E_.prototype._addReference.call(this);for(var $EM=0,$Ee=this._values.length;$EM<$Ee;$EM++){var $EL=this._values[$EM];$EL&&$EL instanceof laya.d3.resource.BaseTexture&&$EL._addReference()}},$Ee._removeReference=function(){$E_.prototype._removeReference.call(this);for(var $EM=0,$Ee=this._values.length;$EM<$Ee;$EM++){var $EL=this._values[$EM];$EL&&$EL instanceof laya.d3.resource.BaseTexture&&$EL._removeReference()}},$Ee.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$Ee.setShaderName=function($EM){var $Ee=$Efe.nameKey.getID($EM);if(-1===$Ee)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$EAe._preCompileShader[$Ee]},$Ee.cloneTo=function($EM){var $Ee=$EM;$Ee.name=this.name,$Ee.cull=this.cull,$Ee.blend=this.blend,$Ee.srcBlend=this.srcBlend,$Ee.dstBlend=this.dstBlend,$Ee.srcBlendRGB=this.srcBlendRGB,$Ee.dstBlendRGB=this.dstBlendRGB,$Ee.srcBlendAlpha=this.srcBlendAlpha,$Ee.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($Ee.blendConstColor),$Ee.blendEquation=this.blendEquation,$Ee.blendEquationRGB=this.blendEquationRGB,$Ee.blendEquationAlpha=this.blendEquationAlpha,$Ee.depthTest=this.depthTest,$Ee.depthWrite=this.depthWrite,$Ee.renderQueue=this.renderQueue,$Ee._shader=this._shader,$Ee._disablePublicShaderDefine=this._disablePublicShaderDefine,$Ee._shaderDefineValue=this._shaderDefineValue;var $EL,$E_=0,$Ec=$Ee._shaderValues;$Ee._shaderValues.data.length=this._shaderValues.data.length;var $Eq=this._values.length,$EH=$Ee._values;for($E_=0,$EL=$EH.length=$Eq;$E_<$EL;$E_++){var $ET=this._values[$E_];if($ET)if("number"==typeof $ET)$EH[$E_]=$ET,$Ec.data[$E_]=$ET;else if("number"==typeof $ET&&Math.floor($ET)==$ET)$EH[$E_]=$ET,$Ec.data[$E_]=$ET;else if("boolean"==typeof $ET)$EH[$E_]=$ET,$Ec.data[$E_]=$ET;else if($ET instanceof laya.d3.math.Vector2){var $Ex=$EH[$E_]||($EH[$E_]=new $Eqe);$ET.cloneTo($Ex),$Ec.data[$E_]=$Ex.elements}else if($ET instanceof laya.d3.math.Vector3){var $EO=$EH[$E_]||($EH[$E_]=new $EHe);$ET.cloneTo($EO),$Ec.data[$E_]=$EO.elements}else if($ET instanceof laya.d3.math.Vector4){var $Eu=$EH[$E_]||($EH[$E_]=new $ETe);$ET.cloneTo($Eu),$Ec.data[$E_]=$Eu.elements}else if($ET instanceof laya.d3.math.Matrix4x4){var $EG=$EH[$E_]||($EH[$E_]=new $EMe);$ET.cloneTo($EG),$Ec.data[$E_]=$EG.elements}else $ET instanceof laya.d3.resource.BaseTexture&&($EH[$E_]=$ET,$Ec.data[$E_]=$ET)}},$Ee.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$Ed(0,$Ee,"alphaTestValue",function(){return this._getNumber(0)},function($EM){this._setNumber(0,$EM)}),$Ed(0,$Ee,"alphaTest",function(){return this._alphaTest},function($EM){(this._alphaTest=$EM)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$EM.__init__=function(){$EM.SHADERDEFINE_ALPHATEST=$EM.shaderDefines.registerDefine("ALPHATEST")},$EM.RENDERQUEUE_OPAQUE=2e3,$EM.RENDERQUEUE_ALPHATEST=2450,$EM.RENDERQUEUE_TRANSPARENT=3e3,$EM.CULL_NONE=0,$EM.CULL_FRONT=1,$EM.CULL_BACK=2,$EM.BLEND_DISABLE=0,$EM.BLEND_ENABLE_ALL=1,$EM.BLEND_ENABLE_SEPERATE=2,$EM.BLENDPARAM_ZERO=0,$EM.BLENDPARAM_ONE=1,$EM.BLENDPARAM_SRC_COLOR=768,$EM.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$EM.BLENDPARAM_DST_COLOR=774,$EM.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$EM.BLENDPARAM_SRC_ALPHA=770,$EM.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$EM.BLENDPARAM_DST_ALPHA=772,$EM.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$EM.BLENDPARAM_SRC_ALPHA_SATURATE=776,$EM.BLENDEQUATION_ADD=0,$EM.BLENDEQUATION_SUBTRACT=1,$EM.BLENDEQUATION_REVERSE_SUBTRACT=2,$EM.DEPTHTEST_OFF=0,$EM.DEPTHTEST_NEVER=512,$EM.DEPTHTEST_LESS=513,$EM.DEPTHTEST_EQUAL=514,$EM.DEPTHTEST_LEQUAL=515,$EM.DEPTHTEST_GREATER=516,$EM.DEPTHTEST_NOTEQUAL=517,$EM.DEPTHTEST_GEQUAL=518,$EM.DEPTHTEST_ALWAYS=519,$EM.SHADERDEFINE_ALPHATEST=1,$EM.ALPHATESTVALUE=0,$EG($EM,["shaderDefines",function(){return this.shaderDefines=new $Eue}]),$EM}($E$),$ESe=function($EM){function $Ee(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$Ee.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$EE($Ee,"laya.d3.resource.BaseTexture",$E$);var $EL=$Ee.prototype;return $Ed(0,$EL,"width",function(){return this._width}),$Ed(0,$EL,"repeat",function(){return this._repeat},function($EM){if(this._repeat!==$EM&&(this._repeat=$EM,this._source)){var $Ee=$ES.mainContext;$Ep.bindTexture($Ee,this._type,this._source),$Eo.isPOT(this._width,this._height)&&this._repeat?($Ee.texParameteri(this._type,10242,10497),$Ee.texParameteri(this._type,10243,10497)):($Ee.texParameteri(this._type,10242,33071),$Ee.texParameteri(this._type,10243,33071))}}),$Ed(0,$EL,"height",function(){return this._height}),$Ed(0,$EL,"magFifter",function(){return this._magFifter},function($EM){(this._magFifter=$EM)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($EM)}),$Ed(0,$EL,"wrapModeV",function(){return this._wrapModeV}),$Ed(0,$EL,"size",function(){return this._size}),$Ed(0,$EL,"wrapModeU",function(){return this._wrapModeU}),$Ed(0,$EL,"mipmap",function(){return this._mipmap},function($EM){this._mipmap=$EM,this._mipmap!=$EM&&this._conchTexture&&this._conchTexture.setMipMap($EM)}),$Ed(0,$EL,"minFifter",function(){return this._minFifter},function($EM){this._minFifter=$EM,this._minFifter!=$EM&&this._conchTexture&&this._conchTexture.setMinFifter($EM)}),$Ed(0,$EL,"format",function(){return this._format}),$Ed(0,$EL,"source",function(){return this.activeResource(),this._source}),$Ed(0,$EL,"defaulteTexture",function(){return $Eme.grayTexture}),$Ee.WARPMODE_REPEAT=0,$Ee.WARPMODE_CLAMP=1,$Ee}(),$Epe=function($EM){function $Ee(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$Ee.__super.call(this),this._boundingBoxCorners=$E_(8,null)}$EE($Ee,"laya.d3.resource.models.BaseMesh",$E$);var $EL=$Ee.prototype;return $EL._getPositions=function(){throw new Error("未Override,请重载该属性！")},$EL._generateBoundingObject=function(){this._boundingSphere=new $EDM(new $EHe,0),$EDM.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $ENM(new $EHe,new $EHe),$ENM.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$EL.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$EL.getRenderElement=function($EM){throw new Error("未Override,请重载该属性！")},$Ed(0,$EL,"subMeshCount",function(){return this._subMeshCount}),$Ed(0,$EL,"boundingBox",function(){return this._boundingBox}),$Ed(0,$EL,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$Ed(0,$EL,"boundingSphere",function(){return this._boundingSphere}),$Ee}(),$ERe=(function($EM){function $Ee(){$Ee.__super.call(this)}$EE($Ee,"laya.d3.component.Script",$EXe);var $EL=$Ee.prototype;$EL.onTriggerEnter=function($EM){},$EL.onTriggerExit=function($EM){},$EL.onTriggerStay=function($EM){},$Ed(0,$EL,"isSingleton",function(){return $Ee._isSingleton}),$Ee._isSingleton=!1}(),function($EM){function $Ee($EM){this._owner=null,this._sharedMesh=null,$Ee.__super.call(this),this._owner=$EM}$EE($Ee,"laya.d3.core.MeshFilter",$EM);var $EL=$Ee.prototype;return $EL._sharedMeshLoaded=function(){this.event("loaded")},$EL._destroy=function(){$EM.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$Ed(0,$EL,"sharedMesh",function(){return this._sharedMesh},function($EM){var $Ee=this._sharedMesh;$Ee&&$Ee._removeReference(),(this._sharedMesh=$EM)._addReference(),this.event("meshchanged",[this,$Ee,$EM]),$EM.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$Ed(0,$EL,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$Ed(0,$EL,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$Ed(0,$EL,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$Ed(0,$EL,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$Ee}($Eoe)),$Eae=function($EM){function $Ee($EM){$Ee.__super.call(this,$EM),$EM.meshFilter.on("meshchanged",this,this._onMeshChanged)}$EE($Ee,"laya.d3.core.MeshRender",$Eie);var $EL=$Ee.prototype;return $EL._onMeshChanged=function($EM,$Ee,$EL){$EL.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$EL.once("loaded",this,this._onMeshLoaed)},$EL._onMeshLoaed=function($EM,$Ee){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$EL._calculateBoundingSphereByInitSphere=function($EM){var $Ee=NaN,$EL=this._owner.transform,$E_=$EL.scale.elements,$Ec=Math.abs($E_[0]),$Eq=Math.abs($E_[1]),$EH=Math.abs($E_[2]);$Ee=$Eq<=$Ec&&$EH<=$Ec?$Ec:$EH<=$Eq?$Eq:$EH,$EHe.transformCoordinate($EM.center,$EL.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$EM.radius*$Ee},$EL._calculateBoundBoxByInitCorners=function($EM){for(var $Ee=this._owner.transform.worldMatrix,$EL=0;$EL<8;$EL++)$EHe.transformCoordinate($EM[$EL],$Ee,$Eie._tempBoundBoxCorners[$EL]);$ENM.createfromPoints($Eie._tempBoundBoxCorners,this._boundingBox)},$EL._calculateBoundingSphere=function(){var $EM=this._owner.meshFilter.sharedMesh;null==$EM||null==$EM.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($EM.boundingSphere)},$EL._calculateBoundingBox=function(){var $EM=this._owner.meshFilter.sharedMesh;null==$EM||null==$EM.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($EM.boundingBoxCorners)},$EL._renderUpdate=function($EM){var $Ee=this._owner.transform;if($Ee){this._setShaderValueMatrix4x4(0,$Ee.worldMatrix);var $EL=this._owner.getProjectionViewWorldMatrix($EM);this._setShaderValueMatrix4x4(1,$EL)}else this._setShaderValueMatrix4x4(0,$EMe.DEFAULT),this._setShaderValueMatrix4x4(1,$EM);return $ECe.debugMode&&this._renderRenderableBoundBox(),!0},$Ee}(),$Ene=function($Ee){function $E_(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$E_.__super.call(this),this._renderState=new $Ev,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $EVe,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $EeM,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $EHe(.7,.7,.7),this.ambientColor=new $EHe(.212,.227,.259),$ES.shaderHighPrecision&&this.addShaderDefine($EAe.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$EE($E_,"laya.d3.core.scene.Scene",$Ee);var $EM=$E_.prototype;return $Ei.imps($EM,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$EM._setUrl=function($EM){this._url=$EM},$EM._getGroup=function(){return this._group},$EM._setGroup=function($EM){this._group=$EM},$EM._display=function(){$Ei.stage._scenes.push(this),$Ei.stage._scenes.sort($E_._sortScenes);for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++){var $EL=this._childs[$EM];$EL.active&&$EL._activeHierarchy()}},$EM._unDisplay=function(){var $EM=$Ei.stage._scenes;$EM.splice($EM.indexOf(this),1);for(var $Ee=0,$EL=this._childs.length;$Ee<$EL;$Ee++){var $E_=this._childs[$Ee];$E_.active&&$E_._inActiveHierarchy()}},$EM._addChild3D=function($EM){$EM.transform._onWorldTransform(),$EM._setBelongScene(this),this.displayedInStage&&$EM.active&&$EM._activeHierarchy()},$EM._removeChild3D=function($EM){$EM.transform.parent=null,this.displayedInStage&&$EM.active&&$EM._inActiveHierarchy(),$EM._setUnBelongScene()},$EM.initOctree=function($EM,$Ee,$EL,$E_,$Ec){void 0===$Ec&&($Ec=6),this.treeSize=new $EHe($EM,$Ee,$EL),this.treeLevel=$Ec,this.treeRoot=new $EN(this,0),this.treeRoot.init($E_,this.treeSize)},$EM._prepareUpdateToRenderState=function($EM,$Ee){$Ee.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$Ee.scene=this},$EM._prepareSceneToRender=function($EM){var $Ee=this._lights.length;if(0<$Ee)for(var $EL=0,$E_=0;$E_<$Ee&&!(this._lights[$E_]._prepareToScene($EM)&&++$EL>=this._enableLightCount);$E_++);},$EM._updateChilds=function($EM){for(var $Ee=0,$EL=this._childs.length;$Ee<$EL;++$Ee)this._childs[$Ee]._update($EM)},$EM._preRenderScene=function($EM,$Ee,$EL){var $E_,$Ec=$Ee._viewMatrix,$Eq=$Ee._projectionMatrix,$EH=$Ee._projectionViewMatrix,$ET=0,$Ex=$Ee.camera;for($Ex.useOcclusionCulling?this.treeRoot?$ELM.renderObjectCullingOctree($EL,this,$Ex,$Ec,$Eq,$EH):$ELM.renderObjectCulling($EL,this,$Ex,$Ec,$Eq,$EH):$ELM.renderObjectCullingNoBoundFrustum(this,$Ex,$Ec,$Eq,$EH),$ET=0,$E_=this._quenes.length;$ET<$E_;$ET++)this._quenes[$ET]&&this._quenes[$ET]._preRender($Ee)},$EM._clear=function($EM,$Ee){var $EL=$Ee._viewport,$E_=$Ee.camera,$Ec=$EL.x,$Eq=$E_.renderTargetSize.height-$EL.y-$EL.height,$EH=$EL.width,$ET=$EL.height;$EM.viewport($Ec,$Eq,$EH,$ET);var $Ex=256,$EO=$E_.renderTarget;switch($E_.clearFlag){case 0:var $Eu=$E_.clearColor;if($Eu){$EM.enable(3089),$EM.scissor($Ec,$Eq,$EH,$ET);var $EG=$Eu.elements;$EM.clearColor($EG[0],$EG[1],$EG[2],$EG[3]),$Ex|=16384}if($EO)switch($Eu||($Ex=16384),$EO.depthStencilFormat){case 33189:$Ex|=256;break;case 36168:$Ex|=1024;break;case 34041:$Ex|=256,$Ex|=1024}$EM.clear($Ex),$Eu&&$EM.disable(3089);break;case 1:case 2:if($EO)switch($Ex=16384,$EO.depthStencilFormat){case 33189:$Ex|=256;break;case 36168:$Ex|=1024;break;case 34041:$Ex|=256,$Ex|=1024}$EM.clear($Ex);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$EM._renderScene=function($EM,$Ee){var $EL,$E_,$Ec=$Ee.camera,$Eq=0;for($Eq=0;$Eq<2;$Eq++)($E_=this._quenes[$Eq])&&($Ec.renderTarget?$E_._render($Ee,!0):$E_._render($Ee,!1));if(1===$Ec.clearFlag){var $EH=$Ec.sky;$EH&&($Ep.setCullFace($EM,!1),$Ep.setDepthFunc($EM,515),$Ep.setDepthMask($EM,!1),$EH._render($Ee),$Ep.setDepthFunc($EM,513),$Ep.setDepthMask($EM,!0))}for($Eq=2,$EL=this._quenes.length;$Eq<$EL;$Eq++)($E_=this._quenes[$Eq])&&($E_._sortAlpha($Ee.camera.transform.position),$Ec.renderTarget?$E_._render($Ee,!0):$E_._render($Ee,!1))},$EM._set3DRenderConfig=function($EM){$EM.disable(3042),$Ep._blend=!1,$EM.blendFunc(770,771),$Ep._sFactor=770,$Ep._dFactor=771,$EM.disable(2929),$Ep._depthTest=!1,$EM.enable(2884),$Ep._cullFace=!0,$EM.depthMask(1),$Ep._depthMask=!0,$EM.frontFace(2304),$Ep._frontFace=2304},$EM._set2DRenderConfig=function($EM){$Ep.setBlend($EM,!0),$Ep.setBlendFunc($EM,1,771),$Ep.setDepthTest($EM,!1),$Ep.setCullFace($EM,!1),$Ep.setDepthMask($EM,!0),$Ep.setFrontFace($EM,2305),$EM.viewport(0,0,$Eu.width,$Eu.height)},$EM._parseCustomProps=function($EM,$Ee,$EL,$E_){var $Ec=$E_.customProps.lightmaps,$Eq=$Ec.length,$EH=this._lightmaps;$EH.length=$Eq;for(var $ET=0;$ET<$Eq;$ET++)$EH[$ET]=$EC.getRes($Ee[$Ec[$ET].replace(".exr",".png")]);this.setlightmaps($EH);var $Ex=$E_.customProps.ambientColor;$Ex&&(this.ambientColor=new $EHe($Ex[0],$Ex[1],$Ex[2]));var $EO=$E_.customProps.fogColor;$EO&&(this.fogColor=new $EHe($EO[0],$EO[1],$EO[2]))},$EM._addLight=function($EM){this._lights.indexOf($EM)<0&&this._lights.push($EM)},$EM._removeLight=function($EM){var $Ee=this._lights.indexOf($EM);0<=$Ee&&this._lights.splice($Ee,1)},$EM._updateScene=function(){var $EM=this._renderState;this._prepareUpdateToRenderState($ES.mainContext,$EM),this._updateComponents($EM),this._updateChilds($EM),this._lateUpdateComponents($EM),this._time+=$EM.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$EM._updateSceneConch=function(){var $EM=this._renderState;this._prepareUpdateToRenderState($ES.mainContext,$EM),this._updateComponents($EM),this._lateUpdateComponents($EM),this._prepareSceneToRender($EM);for(var $Ee=0,$EL=this._cameraPool.length;$Ee<$EL;$Ee++){var $E_=this._cameraPool[$Ee];($EM.camera=$E_)._prepareCameraToRender()}},$EM._preRenderShadow=function($EM,$Ee,$EL,$E_,$Ec){this.treeRoot?$ELM.renderShadowObjectCullingOctree(this,$Ee,$EL,$E_,$Ec):$ELM.renderShadowObjectCulling(this,$Ee,$EL,$E_,$Ec);for(var $Eq=0,$EH=$EL.length;$Eq<$EH;$Eq++)$EL[$Eq]&&$EL[$Eq]._preRender($EM)},$EM._renderShadowMap=function($EM,$Ee,$EL){var $E_=this.parallelSplitShadowMaps[0];$E_._calcAllLightCameraInfo($EL);var $Ec,$Eq,$EH,$ET=$E_.PSSMNum;if(this._preRenderShadow($Ee,$E_._lightCulling,$E_._shadowQuenes,$E_._lightVPMatrix[0],$ET),this.addShaderDefine($EEe.SHADERDEFINE_CAST_SHADOW),1<$ET)for(var $Ex=0;$Ex<$ET;$Ex++)$Ec=$E_.getRenderTarget($Ex+1),$E_.beginRenderTarget($Ex+1),$EM.clearColor(1,1,1,1),$EM.clear(16640),$EM.viewport(0,0,$Ec.width,$Ec.height),$Ee.camera=$EH=$E_.getLightCamera($Ex),$EH._prepareCameraToRender(),$EH._prepareCameraViewProject($EH.viewMatrix,$EH.projectionMatrix),$Ee._projectionViewMatrix=$E_._lightVPMatrix[$Ex+1],($Eq=$E_._shadowQuenes[$Ex])._preRender($Ee),$Eq._renderShadow($Ee,!1),$E_.endRenderTarget($Ex+1);else $Ec=$E_.getRenderTarget(1),$E_.beginRenderTarget(1),$EM.clearColor(1,1,1,1),$EM.clear(16640),$EM.viewport(0,0,$Ec.width,$Ec.height),$Ee.camera=$EH=$E_.getLightCamera(0),$EH._prepareCameraToRender(),$EH._prepareCameraViewProject($EH.viewMatrix,$EH.projectionMatrix),$Ee._projectionViewMatrix=$E_._lightVPMatrix[0],($Eq=$E_._shadowQuenes[0])._preRender($Ee),$Eq._renderShadow($Ee,!0),$E_.endRenderTarget(1);this.removeShaderDefine($EEe.SHADERDEFINE_CAST_SHADOW)},$EM.addTreeNode=function($EM){this.treeRoot.addTreeNode($EM)},$EM.removeTreeNode=function($EM){this.treeSize&&$EM._treeNode&&$EM._treeNode.removeObject($EM)},$EM.setlightmaps=function($EM){this._lightmaps=$EM;for(var $Ee=0,$EL=this._renderableSprite3Ds.length;$Ee<$EL;$Ee++)this._renderableSprite3Ds[$Ee]._render._applyLightMapParams()},$EM.getlightmaps=function(){return this._lightmaps},$EM.addChildAt=function($EM,$Ee){if(!($EM instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($EM&&$EM.__className));if(!$EM||this.destroyed||$EM===this)return $EM;if($EM.zOrder&&this._set$P("hasZorder",!0),0<=$Ee&&$Ee<=this._childs.length){if($EM._parent===this){var $EL=this.getChildIndex($EM);this._childs.splice($EL,1),this._childs.splice($Ee,0,$EM),this.conchModel&&(this.conchModel.removeChild($EM.conchModel),this.conchModel.addChildAt($EM.conchModel,$Ee)),this._childChanged()}else $EM.parent&&$EM.parent.removeChild($EM),this._childs===$EO.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($Ee,0,$EM),this.conchModel&&this.conchModel.addChildAt($EM.conchModel,$Ee),($EM.parent=this)._addChild3D($EM);return $EM}throw new Error("appendChildAt:The index is out of bounds")},$EM.addChild=function($EM){if(!($EM instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$EM||this.destroyed||$EM===this)return $EM;if($EM.zOrder&&this._set$P("hasZorder",!0),$EM._parent===this){var $Ee=this.getChildIndex($EM);$Ee!==this._childs.length-1&&(this._childs.splice($Ee,1),this._childs.push($EM),this.conchModel&&(this.conchModel.removeChild($EM.conchModel),this.conchModel.addChildAt($EM.conchModel,this._childs.length-1)),this._childChanged())}else $EM.parent&&$EM.parent.removeChild($EM),this._childs===$EO.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($EM),this.conchModel&&this.conchModel.addChildAt($EM.conchModel,this._childs.length-1),($EM.parent=this)._childChanged(),this._addChild3D($EM);return $EM},$EM.removeChildAt=function($EM){var $Ee=this.getChildAt($EM);return $Ee&&(this._removeChild3D($Ee),this._childs.splice($EM,1),this.conchModel&&this.conchModel.removeChild($Ee.conchModel),$Ee.parent=null),$Ee},$EM.removeChildren=function($EM,$Ee){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=2147483647),this._childs&&0<this._childs.length){var $EL=this._childs;if(0===$EM&&$Eq<=$Ee){var $E_=$EL;this._childs=$EO.ARRAY_EMPTY}else $E_=$EL.splice($EM,$Ee-$EM);for(var $Ec=0,$Eq=$E_.length;$Ec<$Eq;$Ec++)this._removeChild3D($E_[$Ec]),$E_[$Ec].parent=null,this.conchModel&&this.conchModel.removeChild($E_[$Ec].conchModel)}return this},$EM.addFrustumCullingObject=function($EM){this.treeRoot?this.addTreeNode($EM):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($EM):this._cullingRenders[this._cullingRendersLength]=$EM,$EM._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$EM.removeFrustumCullingObject=function($EM){if(this.treeRoot)this.removeTreeNode($EM);else{this._cullingRendersLength--;var $Ee=$EM._indexInSceneFrustumCullingObjects;if($Ee!==this._cullingRendersLength){var $EL=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$Ee]=$EL)._indexInSceneFrustumCullingObjects=$Ee,$EM._indexInSceneFrustumCullingObjects=-1}}},$EM.getRenderQueue=function($EM){return $EM<3e3?this._quenes[1]||(this._quenes[1]=new $EZ(this)):this._quenes[2]||(this._quenes[2]=new $EZ(this))},$EM.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $EZ(this)},$EM.addShaderDefine=function($EM){this._shaderDefineValue|=$EM},$EM.removeShaderDefine=function($EM){this._shaderDefineValue&=~$EM},$EM.addScript=function($EM){return this._addComponent($EM)},$EM.getScriptByType=function($EM,$Ee){return void 0===$Ee&&($Ee=0),this._getComponentByType($EM,$Ee)},$EM.getScriptsByType=function($EM,$Ee){this._getComponentsByType($EM,$Ee)},$EM.getScriptByIndex=function($EM){return this._getComponentByIndex($EM)},$EM.removeScriptByType=function($EM,$Ee){void 0===$Ee&&($Ee=0),this._removeComponentByType($EM,$Ee)},$EM.removeScriptsByType=function($EM){this._removeComponentByType($EM)},$EM.removeAllScript=function(){this._removeAllComponent()},$EM.render=function($EM,$Ee,$EL){($Er._context.ctx._renderKey=0)<this._childs.length&&$EM.addRenderObject(this)},$EM.renderSubmit=function(){var $EM=$ES.mainContext,$Ee=this._renderState;this._set3DRenderConfig($EM),this._prepareSceneToRender(this._renderState);var $EL,$E_=0,$Ec=0;if($ECe.debugMode||$EN.debugMode)for($E_=0,$Ec=this._cameraPool.length;$E_<$Ec;$E_++)$EL=this._cameraPool[$E_],$ECe._debugPhasorSprite.begin(1,$EL),$EL.activeInHierarchy&&$EL._renderCamera($EM,$Ee,this),$ECe._debugPhasorSprite.end();else for($E_=0,$Ec=this._cameraPool.length;$E_<$Ec;$E_++)($EL=this._cameraPool[$E_]).activeInHierarchy&&$EL._renderCamera($EM,$Ee,this);return this._set2DRenderConfig($EM),1},$EM.onAsynLoaded=function($EM,$Ee,$EL){var $E_=$Ee[0];if("Scene"!==$E_.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $Ec=$Ee[1];$E$e._createNodeByJson(this,$E_,this,$Ec),this.event("hierarchyloaded",[this]),this.__loaded=!0},$EM.destroy=function($EM){void 0===$EM&&($EM=!0),this.destroyed||($Ee.prototype.destroy.call(this,$EM),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$EC.clearRes(this.url),this.loaded||$ECe._cancelLoadByUrl(this.url))},$EM.getRenderType=function(){return 0},$EM.releaseRender=function(){},$EM._addComponent=function($EM){var $Ee,$EL=this._componentsMap.indexOf($EM);if(-1===$EL)$Ee=[],this._componentsMap.push($EM),this._typeComponentsIndices.push($Ee);else if($Ee=this._typeComponentsIndices[$EL],this._components[$Ee[0]].isSingleton)throw new Error("无法单实例创建"+$EM+"组件，"+$EM+"组件已存在！");var $E_=$Ec.getInstance($EM);$Ee.push(this._components.length),this._components.push($E_);return $E_._initialize(this),$E_},$EM._removeComponent=function($EM,$Ee){var $EL=this._typeComponentsIndices[$EM],$E_=$EL[$Ee],$Ec=this._components[$E_];this._components.splice($E_,1),$EL.splice($Ee,1),0===$EL.length&&(this._typeComponentsIndices.splice($EM,1),this._componentsMap.splice($EM,1));for(var $Eq=0,$EH=this._componentsMap.length;$Eq<$EH;$Eq++)for(var $ET=($EL=this._typeComponentsIndices[$Eq]).length-1;0<=$ET;$ET--){var $Ex=$EL[$ET];if(!($E_<$Ex))break;$EL[$ET]=--$Ex}$Ec._destroy()},$EM._getComponentByType=function($EM,$Ee){void 0===$Ee&&($Ee=0);var $EL=this._componentsMap.indexOf($EM);return-1===$EL?null:this._components[this._typeComponentsIndices[$EL][$Ee]]},$EM._getComponentsByType=function($EM,$Ee){var $EL=this._componentsMap.indexOf($EM);if(-1!==$EL){var $E_=this._typeComponentsIndices[$EL],$Ec=$E_.length;$Ee.length=$Ec;for(var $Eq=0;$Eq<$Ec;$Eq++)$Ee[$Eq]=this._components[$E_[$Eq]]}else $Ee.length=0},$EM._getComponentByIndex=function($EM){return this._components[$EM]},$EM._removeComponentByType=function($EM,$Ee){void 0===$Ee&&($Ee=0);var $EL=this._componentsMap.indexOf($EM);-1!==$EL&&this._removeComponent($EL,$Ee)},$EM._removeComponentsByType=function($EM){var $Ee=this._componentsMap.indexOf($EM);if(-1!==$Ee)for(var $EL=this._typeComponentsIndices[$Ee],$E_=0,$Ec=$EL.length;$E_<$Ec;$EL.length<$Ec?$Ec--:$E_++)this._removeComponent($Ee,$E_)},$EM._removeAllComponent=function(){for(var $EM=0,$Ee=this._componentsMap.length;$EM<$Ee;this._componentsMap.length<$Ee?$Ee--:$EM++)this._removeComponentsByType(this._componentsMap[$EM])},$EM._updateComponents=function($EM){for(var $Ee=0,$EL=this._components.length;$Ee<$EL;$Ee++){var $E_=this._components[$Ee];!$E_.started&&($E_._start($EM),$E_.started=!0),$E_.enable&&$E_._update($EM)}},$EM._lateUpdateComponents=function($EM){for(var $Ee=0;$Ee<this._components.length;$Ee++){var $EL=this._components[$Ee];!$EL.started&&($EL._start($EM),$EL.started=!0),$EL.enable&&$EL._lateUpdate($EM)}},$EM._preRenderUpdateComponents=function($EM){for(var $Ee=0;$Ee<this._components.length;$Ee++){var $EL=this._components[$Ee];!$EL.started&&($EL._start($EM),$EL.started=!0),$EL.enable&&$EL._preRenderUpdate($EM)}},$EM._postRenderUpdateComponents=function($EM){for(var $Ee=0;$Ee<this._components.length;$Ee++){var $EL=this._components[$Ee];!$EL.started&&($EL._start($EM),$EL.started=!0),$EL.enable&&$EL._postRenderUpdate($EM)}},$Ed(0,$EM,"_loaded",null,function($EM){this.__loaded=$EM}),$Ed(0,$EM,"fogColor",function(){return this._fogColor},function($EM){this._fogColor=$EM,this._shaderValues.setValue(0,$EM.elements)}),$Ed(0,$EM,"enableFog",function(){return this._enableFog},function($EM){this._enableFog!==$EM&&((this._enableFog=$EM)?(this.addShaderDefine($EAe.SHADERDEFINE_FOG),this.removeShaderDefine($EAe.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($EAe.SHADERDEFINE_FOG))}),$Ed(0,$EM,"url",function(){return this._url}),$Ed(0,$EM,"loaded",function(){return this.__loaded}),$Ed(0,$EM,"enableDepthFog",function(){return this._enableDepthFog},function($EM){this._enableDepthFog!=$EM&&((this._enableDepthFog=$EM)?(this.addShaderDefine($EAe.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($EAe.SHADERDEFINE_FOG)):this.removeShaderDefine($EAe.SAHDERDEFINE_DEPTHFOG))}),$Ed(0,$EM,"fogStart",function(){return this._fogStart},function($EM){this._fogStart=$EM,this._shaderValues.setValue(1,$EM)}),$Ed(0,$EM,"fogRange",function(){return this._fogRange},function($EM){this._fogRange=$EM,this._shaderValues.setValue(2,$EM)}),$Ed(0,$EM,"ambientColor",function(){return this._ambientColor},function($EM){this._ambientColor=$EM,this._shaderValues.setValue(21,$EM.elements)}),$Ed(0,$EM,"scene",function(){return this}),$Ed(0,$EM,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$E_._sortScenes=function($EM,$Ee){if($EM.parent!==$Ei.stage||$Ee.parent!==$Ei.stage)return $EM.parent!==$Ei.stage&&$Ee.parent!==$Ei.stage?$E_._sortScenes($EM.parent,$Ee.parent):$EM.parent===$Ei.stage?-1:1;var $EL=$Ei.stage._childs;return $EL.indexOf($EM)-$EL.indexOf($Ee)},$E_.load=function($EM){return $Ei.loader.create($EM,null,null,$E_)},$E_.FOGCOLOR=0,$E_.FOGSTART=1,$E_.FOGRANGE=2,$E_.LIGHTDIRECTION=3,$E_.LIGHTDIRCOLOR=4,$E_.POINTLIGHTPOS=5,$E_.POINTLIGHTRANGE=6,$E_.POINTLIGHTATTENUATION=7,$E_.POINTLIGHTCOLOR=8,$E_.SPOTLIGHTPOS=9,$E_.SPOTLIGHTDIRECTION=10,$E_.SPOTLIGHTSPOT=11,$E_.SPOTLIGHTRANGE=12,$E_.SPOTLIGHTATTENUATION=13,$E_.SPOTLIGHTCOLOR=14,$E_.SHADOWDISTANCE=15,$E_.SHADOWLIGHTVIEWPROJECT=16,$E_.SHADOWMAPPCFOFFSET=17,$E_.SHADOWMAPTEXTURE1=18,$E_.SHADOWMAPTEXTURE2=19,$E_.SHADOWMAPTEXTURE3=20,$E_.AMBIENTCOLOR=21,$E_.TIME=22,$E_}($Ey),$Ele=function($EM){function $Ee($EM){$Ee.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $EMe,this._shaderValues=new $EVe,this._colliders=[],this._id=++$Ee._uniqueIDCounter,this._transform=new $EWe(this),this.name=$EM||"Sprite3D-"+$Ee._nameNumberCounter++,this.layer=$Ea.currentCreationLayer,this.active=!0}$EE($Ee,"laya.d3.core.Sprite3D",$Ehe);var $EL=$Ee.prototype;return $Ei.imps($EL,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$EL._setUrl=function($EM){this._url=$EM},$EL._getGroup=function(){return this._group},$EL._setGroup=function($EM){this._group=$EM},$EL._addChild3D=function($EM){$EM.transform.parent=this.transform,this._hierarchyAnimator&&(!$EM._hierarchyAnimator&&$EM._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($EM,!0,[$EM.name])),this._scene&&($EM._setBelongScene(this._scene),this._activeInHierarchy&&$EM._active&&$EM._activeHierarchy())},$EL._removeChild3D=function($EM){$EM.transform.parent=null,this._scene&&(this._activeInHierarchy&&$EM._active&&$EM._inActiveHierarchy(),$EM._setUnBelongScene()),this._hierarchyAnimator&&($EM._hierarchyAnimator==this._hierarchyAnimator&&$EM._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($EM,!1,[$EM.name]))},$EL._parseBaseCustomProps=function($EM){var $Ee=this.transform.localPosition;$EM.translate?($Ee.fromArray($EM.translate),$Ee.x*=100,$Ee.y*=100,$Ee.z*=100):$Ee.elements.fill(0),this.transform.localPosition=$Ee;var $EL=this.transform.localRotation;$EM.rotation?$EL.fromArray($EM.rotation):$EL.fromArray([0,0,0,-1]),this.transform.localRotation=$EL;var $E_=this.transform.localScale;$EM.scale?$E_.fromArray($EM.scale):$E_.elements.fill(1),this.transform.localScale=$E_;var $Ec=$EM.layer;null!=$Ec&&(this.layer=$Ea.getLayerByNumber($Ec))},$EL._parseCustomComponent=function($EM,$Ee,$EL){for(var $E_ in $EL){var $Ec=$EL[$E_];switch($E_){case"Animator":var $Eq=this.addComponent(Animator);if($Ec.avatarPath)$Eq.avatar=$EC.getRes($Ee[$Ec.avatarPath]);else{var $EH=$Ec.avatar;if($EH){$Eq.avatar=$EC.getRes($Ee[$EH.path]);var $ET=$EH.linkSprites;$ET&&$EM.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$Eq,$ET])}}for(var $Ex=$Ec.clipPaths,$EO=$Ex.length,$Eu=0;$Eu<$EO;$Eu++)$Eq.addClip($EC.getRes($Ee[$Ex[$Eu]]));$Eq.clip=$EC.getRes($Ee[$Ex[0]]);var $EG=$Ec.playOnWake;void 0!==$EG&&($Eq.playOnWake=$EG);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $EV=this.addComponent(SphereCollider);$EV.isTrigger=$Ec.isTrigger;var $EE=$EV.center;$EE.fromArray($Ec.center),$EV.center=$EE,$EV.radius=$Ec.radius;break;case"BoxCollider":var $Ed=this.addComponent(BoxCollider);$Ed.isTrigger=$Ec.isTrigger,$Ed.center.fromArray($Ec.center);var $Er=$Ed.size;$Er.fromArray($Ec.size),$Ed.size=$Er;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$EL._onRootNodeHierarchyLoaded=function($EM,$Ee){for(var $EL in $Ee){for(var $E_=this,$Ec=$Ee[$EL],$Eq=0,$EH=$Ec.length;$Eq<$EH;$Eq++){var $ET=$Ec[$Eq];if(""===$ET)break;if(!($E_=$E_.getChildByName($ET)))break}$E_&&$EM.linkSprite3DToAvatarNode($EL,$E_)}},$EL._setHierarchyAnimator=function($EM,$Ee){this._changeHierarchyAnimator($EM);for(var $EL=0,$E_=this._childs.length;$EL<$E_;$EL++){var $Ec=this._childs[$EL];$Ec._hierarchyAnimator==$Ee&&$Ec._setHierarchyAnimator($EM,$Ee)}},$EL._clearHierarchyAnimator=function($EM,$Ee){this._changeHierarchyAnimator($Ee);for(var $EL=0,$E_=this._childs.length;$EL<$E_;$EL++){var $Ec=this._childs[$EL];$Ec._hierarchyAnimator==$EM&&$Ec._clearHierarchyAnimator($EM,$Ee)}},$EL._getAnimatorToLinkSprite3D=function($EM,$Ee,$EL){var $E_=this.getComponentByType(Animator);if($E_&&($E_.avatar?$E_.avatar._version||$EM._setAnimatorToLinkAvatar($E_,$Ee):$EM._setAnimatorToLinkSprite3DNoAvatar($E_,$Ee,$EL)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$EL.unshift(this._parent.name);var $Ec=this._parent;$Ec._hierarchyAnimator&&$Ec._getAnimatorToLinkSprite3D($EM,$Ee,$EL)}},$EL._setAnimatorToLinkSprite3DNoAvatar=function($EM,$Ee,$EL){var $E_=0,$Ec=0;for($E_=0,$Ec=$EM.getClipCount();$E_<$Ec;$E_++)$EM._handleSpriteOwnersBySprite($E_,$Ee,$EL,this);for($E_=0,$Ec=this._childs.length;$E_<$Ec;$E_++){var $Eq=this._childs[$E_],$EH=$EL.length;$EL.push($Eq.name),$Eq._setAnimatorToLinkSprite3DNoAvatar($EM,$Ee,$EL),$EL.splice($EH,1)}},$EL._changeHierarchyAnimator=function($EM){this._hierarchyAnimator=$EM},$EL._isLinkSpriteToAnimationNode=function($EM,$Ee,$EL){var $E_=$EM._avatarNodes.indexOf($Ee),$Ec=$EM._cacheSpriteToNodesMap;if($EL)this._transform.dummy=$Ee.transform,$EM._cacheNodesToSpriteMap[$E_]=$Ec.length,$Ec.push($E_);else{this._transform.dummy=null;var $Eq=$EM._cacheNodesToSpriteMap[$E_];$EM._cacheNodesToSpriteMap[$E_]=null,$Ec.splice($Eq,1)}},$EL._setBelongScene=function($EM){this._scene=$EM;for(var $Ee=0,$EL=this._childs.length;$Ee<$EL;$Ee++)this._childs[$Ee]._setBelongScene($EM)},$EL._setUnBelongScene=function(){this._scene=null;for(var $EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++)this._childs[$EM]._setUnBelongScene()},$EL._activeHierarchy=function(){var $EM=0,$Ee=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$EM=0,$Ee=this._colliders.length;$EM<$Ee;$EM++)this._layer._addCollider(this._colliders[$EM]);for(this.event("activeinhierarchychanged",!0),$EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++){var $EL=this._childs[$EM];$EL._active&&$EL._activeHierarchy()}},$EL._inActiveHierarchy=function(){var $EM=0,$Ee=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$EM=0,$Ee=this._colliders.length;$EM<$Ee;$EM++){var $EL=this._colliders[$EM];$EL._clearCollsionMap(),this._layer._removeCollider($EL)}for(this.event("activeinhierarchychanged",!1),$EM=0,$Ee=this._childs.length;$EM<$Ee;$EM++){var $E_=this._childs[$EM];$E_._active&&$E_._inActiveHierarchy()}},$EL.addComponent=function($EM){var $Ee,$EL=this._componentsMap.indexOf($EM);if(-1===$EL)$Ee=[],this._componentsMap.push($EM),this._typeComponentsIndices.push($Ee);else if($Ee=this._typeComponentsIndices[$EL],this._components[$Ee[0]].isSingleton)throw new Error("无法单实例创建"+$EM+"组件，"+$EM+"组件已存在！");var $E_=$Ec.getInstance($EM);return $Ee.push(this._components.length),this._components.push($E_),$E_ instanceof laya.d3.component.Script&&this._scripts.push($E_),$E_._initialize(this),$E_},$EL._removeComponent=function($EM,$Ee){var $EL,$E_=0,$Ec=this._typeComponentsIndices[$EM],$Eq=$Ec[$Ee],$EH=this._components[$Eq];for($EH instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($EH),1),$Ec.splice($Ee,1),0===$Ec.length&&(this._typeComponentsIndices.splice($EM,1),this._componentsMap.splice($EM,1)),$E_=0,$EL=this._componentsMap.length;$E_<$EL;$E_++)for(var $ET=($Ec=this._typeComponentsIndices[$E_]).length-1;0<=$ET;$ET--){var $Ex=$Ec[$ET];if(!($Eq<$Ex))break;$Ec[$ET]=--$Ex}$EH._destroy()},$EL._clearSelfRenderObjects=function(){},$EL._addSelfRenderObjects=function(){},$EL._parseCustomProps=function($EM,$Ee,$EL,$E_){},$EL._updateChilds=function($EM){var $Ee=this._childs.length;if(0!==$Ee)for(var $EL=0;$EL<$Ee;++$EL)this._childs[$EL]._update($EM)},$EL._getSortID=function($EM,$Ee){return 1e3*$Ee.id+$EM._getVertexBuffer().vertexDeclaration.id},$EL._update=function($EM){($EM.owner=this)._activeInHierarchy&&(this._updateComponents($EM),this._lateUpdateComponents($EM),$EA.spriteCount++,this._childs.length&&this._updateChilds($EM))},$EL.getProjectionViewWorldMatrix=function($EM){return $EMe.multiply($EM,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$EL.loadHierarchy=function($EM){this.addChild(laya.d3.core.Sprite3D.load($EM))},$EL.addChildAt=function($EM,$Ee){if(!($EM instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$EM||this.destroyed||$EM===this)return $EM;if($EM.zOrder&&this._set$P("hasZorder",!0),0<=$Ee&&$Ee<=this._childs.length){if($EM._parent===this){var $EL=this.getChildIndex($EM);this._childs.splice($EL,1),this._childs.splice($Ee,0,$EM),this.conchModel&&(this.conchModel.removeChild($EM.conchModel),this.conchModel.addChildAt($EM.conchModel,$Ee)),this._childChanged()}else $EM.parent&&$EM.parent.removeChild($EM),this._childs===$EO.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($Ee,0,$EM),this.conchModel&&this.conchModel.addChildAt($EM.conchModel,$Ee),($EM.parent=this)._addChild3D($EM);return $EM}throw new Error("appendChildAt:The index is out of bounds")},$EL.addChild=function($EM){if(!($EM instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$EM||this.destroyed||$EM===this)return $EM;if($EM.zOrder&&this._set$P("hasZorder",!0),$EM._parent===this){var $Ee=this.getChildIndex($EM);$Ee!==this._childs.length-1&&(this._childs.splice($Ee,1),this._childs.push($EM),this.conchModel&&(this.conchModel.removeChild($EM.conchModel),this.conchModel.addChildAt($EM.conchModel,this._childs.length-1)),this._childChanged())}else $EM.parent&&$EM.parent.removeChild($EM),this._childs===$EO.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($EM),this.conchModel&&this.conchModel.addChildAt($EM.conchModel,this._childs.length-1),($EM.parent=this)._childChanged(),this._addChild3D($EM);return $EM},$EL.removeChildAt=function($EM){var $Ee=this.getChildAt($EM);return $Ee&&(this._removeChild3D($Ee),this._childs.splice($EM,1),this.conchModel&&this.conchModel.removeChild($Ee.conchModel),$Ee.parent=null),$Ee},$EL.removeChildren=function($EM,$Ee){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=2147483647),this._childs&&0<this._childs.length){var $EL=this._childs;if(0===$EM&&$Eq<=$Ee){var $E_=$EL;this._childs=$EO.ARRAY_EMPTY}else $E_=$EL.splice($EM,$Ee-$EM);for(var $Ec=0,$Eq=$E_.length;$Ec<$Eq;$Ec++)this._removeChild3D($E_[$Ec]),$E_[$Ec].parent=null,this.conchModel&&this.conchModel.removeChild($E_[$Ec].conchModel)}return this},$EL.onAsynLoaded=function($EM,$Ee,$EL){var $E_=$Ee[0];if("Sprite3D"!==$E_.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $Ec=$Ee[1];$E$e._createNodeByJson(this,$E_,this,$Ec),this.event("hierarchyloaded",[this]),this.__loaded=!0},$EL.cloneTo=function($EM){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $Ee=$EM;$Ee.name=this.name,$Ee._destroyed=this._destroyed,$Ee.timer=this.timer,$Ee._$P=this._$P,$Ee.active=this._active;var $EL=$Ee.transform.localPosition;this.transform.localPosition.cloneTo($EL),$Ee.transform.localPosition=$EL;var $E_=$Ee.transform.localRotation;this.transform.localRotation.cloneTo($E_),$Ee.transform.localRotation=$E_;var $Ec=$Ee.transform.localScale;this.transform.localScale.cloneTo($Ec),$Ee.transform.localScale=$Ec,$Ee.isStatic=this.isStatic;var $Eq=0,$EH=0;for($Eq=0,$EH=this._componentsMap.length;$Eq<$EH;$Eq++){var $ET=$Ee.addComponent(this._componentsMap[$Eq]);this._components[$Eq]._cloneTo($ET)}for($Eq=0,$EH=this._childs.length;$Eq<$EH;$Eq++)$Ee.addChild(this._childs[$Eq].clone());var $Ex=$Ee.getComponentByType(Animator);if($Ex){var $EO=$Ex._linkSpritesData;if($EO)for(var $Eu in $EO){for(var $EG=$EO[$Eu],$EV=$Ee,$EE=0,$Ed=$EG.length;$EE<$Ed&&($EV=$EV.getChildByName($EG[$EE]));$EE++);if($EV){var $Er=$Ex._avatarNodeMap[$Eu];$EV._isLinkSpriteToAnimationNode($Ex,$Er,!0)}}}},$EL.clone=function(){var $EM=new this.constructor;return this.cloneTo($EM),$EM},$EL.destroy=function($EM){if(void 0===$EM&&($EM=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$EM);var $Ee,$EL=0;for($EL=0,$Ee=this._components.length;$EL<$Ee;$EL++)this._components[$EL]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$EC.clearRes(this.url),this.loaded||$ECe._cancelLoadByUrl(this.url)}},$EL._handleSpriteToAvatar=function($EM,$Ee){$EM._avatarNodes;var $EL=$EM._avatarNodeMap[this.name];$EL&&$EL.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($EM,$EL,$Ee)},$EL._setAnimatorToLinkAvatar=function($EM,$Ee){this._handleSpriteToAvatar($EM,$Ee);for(var $EL=0,$E_=this._childs.length;$EL<$E_;$EL++){this._childs[$EL]._setAnimatorToLinkAvatar($EM,$Ee)}},$Ed(0,$EL,"activeInHierarchy",function(){return this._activeInHierarchy}),$Ed(0,$EL,"_loaded",null,function($EM){this.__loaded=$EM}),$Ed(0,$EL,"active",function(){return this._active},function($EM){this._active!==$EM&&(this._active=$EM,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($EM?this._activeHierarchy():this._inActiveHierarchy()))}),$Ed(0,$EL,"componentsCount",function(){return this._components.length}),$Ed(0,$EL,"loaded",function(){return this.__loaded}),$Ed(0,$EL,"id",function(){return this._id}),$Ed(0,$EL,"url",function(){return this._url}),$Ed(0,$EL,"layer",function(){return this._layer},function($EM){if(this._layer!==$EM){if(!$EM)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $Ee=0,$EL=this._colliders.length;if(this._layer)for($Ee=0;$Ee<$EL;$Ee++)this._layer._removeCollider(this._colliders[$Ee]);for($Ee=0;$Ee<$EL;$Ee++)$EM._addCollider(this._colliders[$Ee])}this._layer=$EM,this.event("layerchanged",$EM)}}),$Ed(0,$EL,"scene",function(){return this._scene}),$Ed(0,$EL,"transform",function(){return this._transform}),$Ee.instantiate=function($EM,$Ee,$EL,$E_,$Ec){void 0===$EL&&($EL=!0);var $Eq=$EM.clone();$Ee&&$Ee.addChild($Eq);var $EH=$Eq.transform;if($EL){var $ET=$EH.worldMatrix;$EM.transform.worldMatrix.cloneTo($ET),$EH.worldMatrix=$ET}else $E_&&($EH.position=$E_),$Ec&&($EH.rotation=$Ec);return $Eq},$Ee.load=function($EM){return $Ei.loader.create($EM,null,null,$Ee)},$Ee.WORLDMATRIX=0,$Ee.MVPMATRIX=1,$Ee._uniqueIDCounter=0,$Ee._nameNumberCounter=0,$Ee}(),$Efe=function($EM){function $Eu($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$Eu.__super.call(this),!$EM||!$Ee)throw"Shader Error";this._id=++$Eu._count,this._vs=$EM,this._ps=$Ee,this._attributeMap=$EL,this._sceneUniformMap=$E_,this._cameraUniformMap=$Ec,this._spriteUniformMap=$Eq,this._materialUniformMap=$EH,this._renderElementUniformMap=$ET,this._precompile=$Ex,this._define=$EO,this._precompile&&$Eu.extCompileObj&&$Eu.extCompileFunc?$Eu.extCompileFunc.call($Eu.extCompileObj,$EM,$Ee,$EO):this.recreateResource()}$EE($Eu,"laya.d3.shader.Shader3D",$EL);var $Ee=$Eu.prototype;return $Ee.recreateResource=function(){$ER.now();this._compile(),this.completeCreate(),this.memorySize=0},$Ee.disposeResource=function(){$ES.mainContext.deleteShader(this._vshader),$ES.mainContext.deleteShader(this._pshader),$ES.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$Ee._compile=function(){if(!$ES.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $EM=[this._vs,this._ps],$Ee=$ES.mainContext;if(this._program=$Ee.createProgram(),this._vshader=$Eu._createShader($Ee,$EM[0],35633),this._pshader=$Eu._createShader($Ee,$EM[1],35632),$Ee.attachShader(this._program,this._vshader),$Ee.attachShader(this._program,this._pshader),$Ee.linkProgram(this._program),!$Er.isConchApp&&$EAe.debugMode&&!$Ee.getProgramParameter(this._program,35714))throw $Ee.getProgramInfoLog(this._program);var $EL,$E_=0,$Ec=0,$Eq=0;for($Eq=$Er.isConchApp?$Ee.getProgramParameterEx(this._vs,this._ps,"",35721):$Ee.getProgramParameter(this._program,35721),$E_=0;$E_<$Eq;$E_++){var $EH=null;$EL={vartype:"attribute",ivartype:0,attrib:$EH=$Er.isConchApp?$Ee.getActiveAttribEx(this._vs,this._ps,"",$E_):$Ee.getActiveAttrib(this._program,$E_),location:$Ee.getAttribLocation(this._program,$EH.name),name:$EH.name,type:$EH.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($EL)}var $ET=0;for($ET=$Er.isConchApp?$Ee.getProgramParameterEx(this._vs,this._ps,"",35718):$Ee.getProgramParameter(this._program,35718),$E_=0;$E_<$ET;$E_++){var $Ex=null;$Ex=$Er.isConchApp?$Ee.getActiveUniformEx(this._vs,this._ps,"",$E_):$Ee.getActiveUniform(this._program,$E_),0<($EL={vartype:"uniform",ivartype:1,attrib:$EH,location:$Ee.getUniformLocation(this._program,$Ex.name),name:$Ex.name,type:$Ex.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($EL.name=$EL.name.substr(0,$EL.name.length-3),$EL.isArray=!0,$EL.location=$Ee.getUniformLocation(this._program,$EL.name)),this._uniformParams.push($EL)}for($E_=0,$Ec=this._attributeParams.length;$E_<$Ec;$E_++)($EL=this._attributeParams[$E_]).indexOfParams=$E_,$EL.index=1,$EL.value=[$EL.location,null],$EL.codename=$EL.name,$EL.name=null!=this._attributeMap[$EL.codename]?this._attributeMap[$EL.codename]:$EL.codename,this._attributeParamsMap.push($EL.name),this._attributeParamsMap.push($EL),$EL._this=this,$EL.uploadedValue=[],$EL.fun=this._attribute;for($E_=0,$Ec=this._uniformParams.length;$E_<$Ec;$E_++)switch(($EL=this._uniformParams[$E_]).indexOfParams=$E_,$EL.index=1,$EL.value=[$EL.location,null],$EL.codename=$EL.name,null!=this._sceneUniformMap[$EL.codename]?($EL.name=this._sceneUniformMap[$EL.codename],this._sceneUniformParamsMap.push($EL.name),this._sceneUniformParamsMap.push($EL)):null!=this._cameraUniformMap[$EL.codename]?($EL.name=this._cameraUniformMap[$EL.codename],this._cameraUniformParamsMap.push($EL.name),this._cameraUniformParamsMap.push($EL)):null!=this._spriteUniformMap[$EL.codename]?($EL.name=this._spriteUniformMap[$EL.codename],this._spriteUniformParamsMap.push($EL.name),this._spriteUniformParamsMap.push($EL)):null!=this._materialUniformMap[$EL.codename]?($EL.name=this._materialUniformMap[$EL.codename],this._materialUniformParamsMap.push($EL.name),this._materialUniformParamsMap.push($EL)):null!=this._renderElementUniformMap[$EL.codename]?($EL.name=this._renderElementUniformMap[$EL.codename],this._renderElementUniformParamsMap.push($EL.name),this._renderElementUniformParamsMap.push($EL)):console.log("Shader:can't find uinform name:"+$EL.codename+" in shader file."),$EL._this=this,$EL.uploadedValue=[],$EL.type){case 5124:$EL.fun=$EL.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$EL.fun=$EL.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$EL.fun=$EL.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$EL.fun=$EL.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$EL.fun=$EL.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$EL.fun=this._uniform_sampler2D;break;case 35680:$EL.fun=this._uniform_samplerCube;break;case 35676:$EL.fun=this._uniformMatrix4fv;break;case 35670:$EL.fun=this._uniform1i;break;case 35674:$EL.fun=this._uinformMatrix2fv;break;case 35675:$EL.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$Ee._attribute=function($EM,$Ee){var $EL=$ES.mainContext,$E_=$ET._enableAtributes,$Ec=$EM.location;return $E_[$Ec]||$EL.enableVertexAttribArray($Ec),$EL.vertexAttribPointer($Ec,$Ee[0],$Ee[1],$Ee[2],$Ee[3],$Ee[4]),$E_[$Ec]=$ET._bindVertexBuffer,1},$Ee._uniform1f=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee?($ES.mainContext.uniform1f($EM.location,$EL[0]=$Ee),1):0},$Ee._uniform1fv=function($EM,$Ee){if($Ee.length<4){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($ES.mainContext.uniform1fv($EM.location,$Ee),$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3],1):0}return $ES.mainContext.uniform1fv($EM.location,$Ee),1},$Ee._uniform_vec2=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]?($ES.mainContext.uniform2f($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1]),1):0},$Ee._uniform_vec2v=function($EM,$Ee){if($Ee.length<2){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($ES.mainContext.uniform2fv($EM.location,$Ee),$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3],1):0}return $ES.mainContext.uniform2fv($EM.location,$Ee),1},$Ee._uniform_vec3=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]?($ES.mainContext.uniform3f($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2]),1):0},$Ee._uniform_vec3v=function($EM,$Ee){return $ES.mainContext.uniform3fv($EM.location,$Ee),1},$Ee._uniform_vec4=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($ES.mainContext.uniform4f($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3]),1):0},$Ee._uniform_vec4v=function($EM,$Ee){return $ES.mainContext.uniform4fv($EM.location,$Ee),1},$Ee._uniformMatrix2fv=function($EM,$Ee){return $ES.mainContext.uniformMatrix2fv($EM.location,!1,$Ee),1},$Ee._uniformMatrix3fv=function($EM,$Ee){return $ES.mainContext.uniformMatrix3fv($EM.location,!1,$Ee),1},$Ee._uniformMatrix4fv=function($EM,$Ee){return $ES.mainContext.uniformMatrix4fv($EM.location,!1,$Ee),1},$Ee._uinformMatrix2fv=function($EM,$Ee){return $ES.mainContext.uniformMatrix2fv($EM.location,!1,$Ee),1},$Ee._uinformMatrix3fv=function($EM,$Ee){return $ES.mainContext.uniformMatrix3fv($EM.location,!1,$Ee),1},$Ee._uniform1i=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee?($ES.mainContext.uniform1i($EM.location,$EL[0]=$Ee),1):0},$Ee._uniform1iv=function($EM,$Ee){return $ES.mainContext.uniform1iv($EM.location,$Ee),1},$Ee._uniform_ivec2=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]?($ES.mainContext.uniform2i($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1]),1):0},$Ee._uniform_ivec2v=function($EM,$Ee){return $ES.mainContext.uniform2iv($EM.location,$Ee),1},$Ee._uniform_vec3i=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]?($ES.mainContext.uniform3i($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2]),1):0},$Ee._uniform_vec3vi=function($EM,$Ee){return $ES.mainContext.uniform3iv($EM.location,$Ee),1},$Ee._uniform_vec4i=function($EM,$Ee){var $EL=$EM.uploadedValue;return $EL[0]!==$Ee[0]||$EL[1]!==$Ee[1]||$EL[2]!==$Ee[2]||$EL[3]!==$Ee[3]?($ES.mainContext.uniform4i($EM.location,$EL[0]=$Ee[0],$EL[1]=$Ee[1],$EL[2]=$Ee[2],$EL[3]=$Ee[3]),1):0},$Ee._uniform_vec4vi=function($EM,$Ee){return $ES.mainContext.uniform4iv($EM.location,$Ee),1},$Ee._uniform_sampler2D=function($EM,$Ee){var $EL=$Ee.source||$Ee.defaulteTexture.source,$E_=$ES.mainContext,$Ec=$EM.uploadedValue;if(null!=$Ec[0])return $E_.activeTexture($Eu._TEXTURES[$Ec[0]]),$EL&&$Ep.bindTexture($E_,3553,$EL),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $Ec[0]=this._curActTexIndex,$E_.uniform1i($EM.location,this._curActTexIndex),$E_.activeTexture($Eu._TEXTURES[this._curActTexIndex]),$EL&&$Ep.bindTexture($E_,3553,$EL),this._curActTexIndex++,1},$Ee._uniform_samplerCube=function($EM,$Ee){var $EL=$Ee.source||$Ee.defaulteTexture.source,$E_=$ES.mainContext,$Ec=$EM.uploadedValue;if(null!=$Ec[0])return $E_.activeTexture($Eu._TEXTURES[$Ec[0]]),$EL?$Ep.bindTexture($E_,34067,$EL):$Ep.bindTexture($E_,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $Ec[0]=this._curActTexIndex,$E_.uniform1i($EM.location,this._curActTexIndex),$E_.activeTexture($Eu._TEXTURES[this._curActTexIndex]),$EL?$Ep.bindTexture($E_,34067,$EL):$Ep.bindTexture($E_,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$Ee._noSetValue=function($EM){console.log("no....:"+$EM.name)},$Ee.bind=function(){return $EL.activeShader=this,($EL.bindShader=this).activeResource(),$Ep.UseProgram(this._program)},$Ee.uploadAttributes=function($EM,$Ee){for(var $EL,$E_,$Ec=0,$Eq=0,$EH=this._attributeParamsMap.length;$Eq<$EH;$Eq+=2)$E_=this._attributeParamsMap[$Eq+1],null!=($EL=$EM[this._attributeParamsMap[$Eq]])&&($Ee&&$Ee[$E_.name]&&$Ee[$E_.name].bind(),$Ec+=$E_.fun.call(this,$E_,$EL));$EA.shaderCall+=$Ec},$Ee.uploadAttributesX=function($EM,$Ee){for(var $EL,$E_,$Ec=0,$Eq=0,$EH=this._attributeParamsMap.length;$Eq<$EH;$Eq+=2)$E_=this._attributeParamsMap[$Eq+1],null!=($EL=$EM[this._attributeParamsMap[$Eq]])&&($Ee._bind(),$Ec+=$E_.fun.call(this,$E_,$EL));$EA.shaderCall+=$Ec},$Ee.uploadSceneUniforms=function($EM){for(var $Ee,$EL,$E_=0,$Ec=0,$Eq=this._sceneUniformParamsMap.length;$Ec<$Eq;$Ec+=2)$EL=this._sceneUniformParamsMap[$Ec+1],null!=($Ee=$EM[this._sceneUniformParamsMap[$Ec]])&&($E_+=$EL.fun.call(this,$EL,$Ee));$EA.shaderCall+=$E_},$Ee.uploadCameraUniforms=function($EM){for(var $Ee,$EL,$E_=0,$Ec=0,$Eq=this._cameraUniformParamsMap.length;$Ec<$Eq;$Ec+=2)$EL=this._cameraUniformParamsMap[$Ec+1],null!=($Ee=$EM[this._cameraUniformParamsMap[$Ec]])&&($E_+=$EL.fun.call(this,$EL,$Ee));$EA.shaderCall+=$E_},$Ee.uploadSpriteUniforms=function($EM){for(var $Ee,$EL,$E_=0,$Ec=0,$Eq=this._spriteUniformParamsMap.length;$Ec<$Eq;$Ec+=2)$EL=this._spriteUniformParamsMap[$Ec+1],null!=($Ee=$EM[this._spriteUniformParamsMap[$Ec]])&&($E_+=$EL.fun.call(this,$EL,$Ee));$EA.shaderCall+=$E_},$Ee.uploadMaterialUniforms=function($EM){for(var $Ee,$EL,$E_=0,$Ec=0,$Eq=this._materialUniformParamsMap.length;$Ec<$Eq;$Ec+=2)$EL=this._materialUniformParamsMap[$Ec+1],null!=($Ee=$EM[this._materialUniformParamsMap[$Ec]])&&($E_+=$EL.fun.call(this,$EL,$Ee));$EA.shaderCall+=$E_},$Ee.uploadRenderElementUniforms=function($EM){for(var $Ee,$EL,$E_=0,$Ec=0,$Eq=this._renderElementUniformParamsMap.length;$Ec<$Eq;$Ec+=2)$EL=this._renderElementUniformParamsMap[$Ec+1],null!=($Ee=$EM[this._renderElementUniformParamsMap[$Ec]])&&($E_+=$EL.fun.call(this,$EL,$Ee));$EA.shaderCall+=$E_},$Eu.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){return new $Eu($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO)},$Eu.addInclude=function($EM,$Ee){$EX.addInclude($EM,$Ee)},$Eu._createShader=function($EM,$Ee,$EL){var $E_=$EM.createShader($EL);if($EM.shaderSource($E_,$Ee),$EM.compileShader($E_),$EAe.debugMode&&!$EM.getShaderParameter($E_,35713))throw $EM.getShaderInfoLog($E_);return $E_},$Eu.PERIOD_RENDERELEMENT=0,$Eu.PERIOD_MATERIAL=1,$Eu.PERIOD_SPRITE=2,$Eu.PERIOD_CAMERA=3,$Eu.PERIOD_SCENE=4,$Eu._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$Eu._count=0,$Eu._preCompile=!1,$Eu.extCompileFunc=null,$Eu.extCompileObj=null,$EG($Eu,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $EB}]),$Eu}(),$Eje=function($ET){function $Ex(){this._transformUV=null,$Ex.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $EHe(.6,.6,.6)),this._setColor(10,new $EHe(1,1,1)),this._setColor(11,new $ETe(1,1,1,8)),this._setColor(12,new $EHe(1,1,1)),this._setColor(7,new $ETe(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $ETe(1,1,0,0)),this.renderMode=1}$EE($Ex,"laya.d3.core.material.StandardMaterial",$ET);var $EM=$Ex.prototype;return $EM.disableLight=function(){this._addDisablePublicShaderDefine($EAe.SHADERDEFINE_POINTLIGHT|$EAe.SHADERDEFINE_SPOTLIGHT|$EAe.SHADERDEFINE_DIRECTIONLIGHT)},$EM.disableFog=function(){this._addDisablePublicShaderDefine($EAe.SHADERDEFINE_FOG)},$EM.onAsynLoaded=function($EM,$Ee,$EL){var $E_=$Ee[0];if($E_.version)$ET.prototype.onAsynLoaded.call(this,$EM,$Ee,$EL);else{var $Ec=$Ee[1],$Eq=$E_.props;for(var $EH in $Eq)this[$EH]=$Eq[$EH];$Ex._parseStandardMaterial($Ec,this,$E_),this._endLoaded()}},$EM.cloneTo=function($EM){$ET.prototype.cloneTo.call(this,$EM);var $Ee=$EM;this._transformUV&&($Ee._transformUV=this._transformUV.clone())},$Ed(0,$EM,"ambientColor",function(){return this._getColor(9)},function($EM){this._setColor(9,$EM)}),$Ed(0,$EM,"ambientTexture",function(){return this._getTexture(5)},function($EM){$EM?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$EM)}),$Ed(0,$EM,"renderMode",null,function($EM){switch($EM){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($Ex.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($EM)}),$Ed(0,$EM,"reflectColor",function(){return this._getColor(12)},function($EM){this._setColor(12,$EM)}),$Ed(0,$EM,"tilingOffset",function(){return this._getColor(15)},function($EM){if($EM){var $Ee=$EM.elements;1!=$Ee[0]||1!=$Ee[1]||0!=$Ee[2]||0!=$Ee[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$EM)}),$Ed(0,$EM,"albedo",function(){return this._getColor(7)},function($EM){this._setColor(7,$EM)}),$Ed(0,$EM,"diffuseColor",function(){return this._getColor(10)},function($EM){this._setColor(10,$EM)}),$Ed(0,$EM,"albedoColor",function(){return this._getColor(7)},function($EM){this._setColor(7,$EM)}),$Ed(0,$EM,"specularColor",function(){return this._getColor(11)},function($EM){this._setColor(11,$EM)}),$Ed(0,$EM,"diffuseTexture",function(){return this._getTexture(1)},function($EM){$EM?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$EM)}),$Ed(0,$EM,"normalTexture",function(){return this._getTexture(2)},function($EM){$EM?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$EM)}),$Ed(0,$EM,"specularTexture",function(){return this._getTexture(3)},function($EM){$EM?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$EM)}),$Ed(0,$EM,"emissiveTexture",function(){return this._getTexture(4)},function($EM){$EM?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$EM)}),$Ed(0,$EM,"reflectTexture",function(){return this._getTexture(6)},function($EM){$EM?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$EM)}),$Ed(0,$EM,"transformUV",function(){return this._transformUV},function($EM){this._transformUV=$EM,this._setMatrix4x4(13,$EM.matrix),$EM?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$EM.matrix.elements,0)}),$Ex.__init__=function(){$Ex.SHADERDEFINE_DIFFUSEMAP=$Ex.shaderDefines.registerDefine("DIFFUSEMAP"),$Ex.SHADERDEFINE_NORMALMAP=$Ex.shaderDefines.registerDefine("NORMALMAP"),$Ex.SHADERDEFINE_SPECULARMAP=$Ex.shaderDefines.registerDefine("SPECULARMAP"),$Ex.SHADERDEFINE_EMISSIVEMAP=$Ex.shaderDefines.registerDefine("EMISSIVEMAP"),$Ex.SHADERDEFINE_AMBIENTMAP=$Ex.shaderDefines.registerDefine("AMBIENTMAP"),$Ex.SHADERDEFINE_REFLECTMAP=$Ex.shaderDefines.registerDefine("REFLECTMAP"),$Ex.SHADERDEFINE_UVTRANSFORM=$Ex.shaderDefines.registerDefine("UVTRANSFORM"),$Ex.SHADERDEFINE_TILINGOFFSET=$Ex.shaderDefines.registerDefine("TILINGOFFSET"),$Ex.SHADERDEFINE_ADDTIVEFOG=$Ex.shaderDefines.registerDefine("ADDTIVEFOG")},$Ex.load=function($EM){return $Ei.loader.create($EM,null,null,$Ex)},$Ex._parseStandardMaterial=function($EM,$Ee,$EL){var $E_=$EL.customProps,$Ec=$E_.ambientColor;$Ee.ambientColor=new $EHe($Ec[0],$Ec[1],$Ec[2]);var $Eq=$E_.diffuseColor;$Ee.diffuseColor=new $EHe($Eq[0],$Eq[1],$Eq[2]);var $EH=$E_.specularColor;$Ee.specularColor=new $ETe($EH[0],$EH[1],$EH[2],$EH[3]);var $ET=$E_.reflectColor;$Ee.reflectColor=new $EHe($ET[0],$ET[1],$ET[2]);var $Ex=$E_.albedoColor;$Ex&&($Ee.albedo=new $ETe($Ex[0],$Ex[1],$Ex[2],$Ex[3]));var $EO=$E_.diffuseTexture.texture2D;$EO&&($Ee.diffuseTexture=$EC.getRes($EM[$EO]));var $Eu=$E_.normalTexture.texture2D;$Eu&&($Ee.normalTexture=$EC.getRes($EM[$Eu]));var $EG=$E_.specularTexture.texture2D;$EG&&($Ee.specularTexture=$EC.getRes($EM[$EG]));var $EV=$E_.emissiveTexture.texture2D;$EV&&($Ee.emissiveTexture=$EC.getRes($EM[$EV]));var $EE=$E_.ambientTexture.texture2D;$EE&&($Ee.ambientTexture=$EC.getRes($EM[$EE]));var $Ed=$E_.reflectTexture.texture2D;$Ed&&($Ee.reflectTexture=$EC.getRes($EM[$Ed]))},$Ex.RENDERMODE_OPAQUE=1,$Ex.RENDERMODE_OPAQUEDOUBLEFACE=2,$Ex.RENDERMODE_CUTOUT=3,$Ex.RENDERMODE_CUTOUTDOUBLEFACE=4,$Ex.RENDERMODE_TRANSPARENT=13,$Ex.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$Ex.RENDERMODE_ADDTIVE=15,$Ex.RENDERMODE_ADDTIVEDOUBLEFACE=16,$Ex.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$Ex.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$Ex.RENDERMODE_DEPTHREAD_ADDTIVE=7,$Ex.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$Ex.RENDERMODE_NONDEPTH_TRANSPARENT=9,$Ex.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$Ex.RENDERMODE_NONDEPTH_ADDTIVE=11,$Ex.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$Ex.SHADERDEFINE_DIFFUSEMAP=0,$Ex.SHADERDEFINE_NORMALMAP=0,$Ex.SHADERDEFINE_SPECULARMAP=0,$Ex.SHADERDEFINE_EMISSIVEMAP=0,$Ex.SHADERDEFINE_AMBIENTMAP=0,$Ex.SHADERDEFINE_REFLECTMAP=0,$Ex.SHADERDEFINE_UVTRANSFORM=0,$Ex.SHADERDEFINE_TILINGOFFSET=0,$Ex.SHADERDEFINE_ADDTIVEFOG=0,$Ex.DIFFUSETEXTURE=1,$Ex.NORMALTEXTURE=2,$Ex.SPECULARTEXTURE=3,$Ex.EMISSIVETEXTURE=4,$Ex.AMBIENTTEXTURE=5,$Ex.REFLECTTEXTURE=6,$Ex.ALBEDO=7,$Ex.UVANIAGE=8,$Ex.MATERIALAMBIENT=9,$Ex.MATERIALDIFFUSE=10,$Ex.MATERIALSPECULAR=11,$Ex.MATERIALREFLECT=12,$Ex.UVMATRIX=13,$Ex.UVAGE=14,$Ex.TILINGOFFSET=15,$EG($Ex,["defaultMaterial",function(){var $EM=new $Ex;return $EM.lock=!0,this.defaultMaterial=$EM},"shaderDefines",function(){return this.shaderDefines=new $Eue($Ete.shaderDefines)}]),$Ex}($Ete),$EFe=function($EM){function $EH($EM,$Ee,$EL,$E_,$Ec){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$EL&&($EL=35044),void 0===$E_&&($E_=!1),$EH.__super.call(this),this._indexType=$EM,this._indexCount=$Ee,this._bufferUsage=$EL,this._bufferType=34963,this._canRead=$E_;var $Eq;if("ushort"==$EM)this._indexTypeByteCount=2;else{if("ubyte"!=$EM)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$Eq=this._indexTypeByteCount*$Ee,this._byteLength=$Eq,this._bind(),$ET._gl.bufferData(this._bufferType,$Eq,this._bufferUsage),this.uri=$Ec,$E_?("ushort"==$EM?this._buffer=new Uint16Array($Ee):"ubyte"==$EM&&(this._buffer=new Uint8Array($Ee)),this.memorySize=2*$Eq):this.memorySize=$Eq}$EE($EH,"laya.d3.graphics.IndexBuffer3D",$EM);var $Ee=$EH.prototype;return $Ee.setData=function($EM,$Ee,$EL,$E_){void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=4294967295);var $Ec=0;if("ushort"==this._indexType?($Ec=2,0===$EL&&4294967295===$E_||($EM=new Uint16Array($EM.buffer,$EL*$Ec,$E_))):"ubyte"==this._indexType&&($Ec=1,0===$EL&&4294967295===$E_||($EM=new Uint8Array($EM.buffer,$EL*$Ec,$E_))),this._bind(),$ET._gl.bufferSubData(this._bufferType,$Ee*$Ec,$EM),this._canRead)if(0!==$Ee||0!==$EL||4294967295!==$E_){var $Eq=this._buffer.length-$Ee;$Eq<$E_&&($E_=$Eq);for(var $EH=0;$EH<$E_;$EH++)this._buffer[$Ee+$EH]=$EM[$EH]}else this._buffer=$EM},$Ee.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$Ee.disposeResource=function(){$EM.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$Ed(0,$Ee,"indexType",function(){return this._indexType}),$Ed(0,$Ee,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$Ed(0,$Ee,"indexCount",function(){return this._indexCount}),$Ed(0,$Ee,"canRead",function(){return this._canRead}),$EH.INDEXTYPE_UBYTE="ubyte",$EH.INDEXTYPE_USHORT="ushort",$EH.create=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$EL&&($EL=35044),void 0===$E_&&($E_=!1),new $EH($EM,$Ee,$EL,$E_,$Ec)},$EH}($ET),$Ege=function($Eq){function $EH($EM,$Ee,$EL,$E_,$Ec){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$E_&&($E_=!1),$EH.__super.call(this),this._vertexDeclaration=$EM,this._vertexCount=$Ee,this._bufferUsage=$EL,this._bufferType=34962,this._canRead=$E_,this.uri=$Ec,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$Ee,this._bind(),$ET._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$E_&&(this._buffer=new Float32Array(this._byteLength/4))}$EE($EH,"laya.d3.graphics.VertexBuffer3D",$Eq);var $EM=$EH.prototype;return $EM.bindWithIndexBuffer=function($EM){$EM&&$EM._bind(),this._bind()},$EM.setData=function($EM,$Ee,$EL,$E_){if(void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=4294967295),0===$EL&&4294967295===$E_||($EM=new Float32Array($EM.buffer,4*$EL,$E_)),this._bind(),$ET._gl.bufferSubData(this._bufferType,4*$Ee,$EM),this._canRead)if(0!==$Ee||0!==$EL||4294967295!==$E_){var $Ec=this._buffer.length-$Ee;$Ec<$E_&&($E_=$Ec);for(var $Eq=0;$Eq<$E_;$Eq++)this._buffer[$Ee+$Eq]=$EM[$Eq]}else this._buffer=$EM},$EM.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$EM.disposeResource=function(){for(var $EM=$ES.mainContext,$Ee=this._vertexDeclaration.getVertexElements(),$EL=$ET._enableAtributes,$E_=0,$Ec=$Ee.length;$E_<$Ec;$E_++)$EL[$E_]===this._glBuffer&&($EM.disableVertexAttribArray($E_),$EL[$E_]=null);$Eq.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$Ed(0,$EM,"vertexDeclaration",function(){return this._vertexDeclaration}),$Ed(0,$EM,"vertexCount",function(){return this._vertexCount}),$Ed(0,$EM,"canRead",function(){return this._canRead}),$EH.create=function($EM,$Ee,$EL,$E_,$Ec){return void 0===$EL&&($EL=35044),void 0===$E_&&($E_=!1),new $EH($EM,$Ee,$EL,$E_,$Ec)},$EH}($ET),$EJe=function($EM){function $EX(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$EX.__super.call(this),this._type=3553}$EE($EX,"laya.d3.resource.DataTexture2D",$ESe);var $Ee=$EX.prototype;return $Ee.genDebugMipmaps=function(){var $EM=[];return $EM.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$EM.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$EM.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$EM.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$EM.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$EM.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$EM.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$EM.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$EM.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$EM.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$EM},$Ee._onTextureLoaded=function($EM){},$Ee._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $EM=$ES.mainContext,$Ee=this._source=$EM.createTexture(),$EL=this._width,$E_=this._height,$Ec=$Ep.curBindTexTarget,$Eq=$Ep.curBindTexValue,$EH=!1;if($Ep.bindTexture($EM,this._type,$Ee),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $ET=0;$EM.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $Ex=0;$Ex<this._mipmaps.length;$Ex++){if(this._mipmaps[$Ex].byteLength!=$EO*$Eu*4)throw"mipmap size error  level:"+$Ex;$EM.texSubImage2D(this._type,0,$EX.simLodRect[$ET++],$EX.simLodRect[$ET++],$EX.simLodRect[$ET++],$EX.simLodRect[$ET++],6408,5121,new Uint8Array(this._mipmaps[$Ex]))}this.minFifter=9729,this.magFifter=9729}else{var $EO=this._width,$Eu=this._height;for($ET=0,$EM.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$Ex=0;$Ex<this._mipmaps.length;$Ex++){if(this._mipmaps[$Ex].byteLength!=$EO*$Eu*4)throw"mipmap size error  level:"+$Ex;$EM.texImage2D(this._type,$Ex,6408,$EO,$Eu,0,6408,5121,new Uint8Array(this._mipmaps[$Ex])),($EO/=2)<1&&($EO=1),($Eu/=2)<1&&($Eu=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$EM.pixelStorei($EM.UNPACK_ALIGNMENT,1),$EM.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $EG=0,$EV=!1,$EE=!1;this._buffer.byteLength==4*$EL*$E_?($EG=6408,$EV=!0):this._buffer.byteLength==3*$EL*$E_?($EG=6407,$EE=!0):$EG=this._format,$EV||$EE?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$EE&&$EM.pixelStorei($EM.UNPACK_ALIGNMENT,1),$EM.texImage2D(this._type,0,$EG,$EL,$E_,0,$EG,5121,this._buffer)):$EM&&$EG==$EM.ALPHA?($EM.texImage2D(3553,0,$EG,$EL,$E_,0,$EG,$EM.UNSIGNED_BYTE,this._buffer),$EH=!0):0!=$EG&&($EM.compressedTexImage2D(3553,0,$EG,$EL,$E_,0,this._buffer),$EH=!0)}var $Ed=this._minFifter,$Er=this._magFifter,$E$=0==this._wrapModeU?10497:33071,$EC=0==this._wrapModeV?10497:33071,$EK=$Eo.isPOT($EL,$E_);$EK?(this._mipmap||this._mipmaps?-1!==$Ed||($Ed=9987):-1!==$Ed||($Ed=9729),-1!==$Er||($Er=9729),$EM.texParameteri(this._type,10241,$Ed),$EM.texParameteri(this._type,10240,$Er),$EM.texParameteri(this._type,10242,$E$),$EM.texParameteri(this._type,10243,$EC),this._mipmap&&$EM.generateMipmap(this._type)):(-1!==$Ed||($Ed=9729),-1!==$Er||($Er=9729),$EM.texParameteri(this._type,10241,$Ed),$EM.texParameteri(this._type,10240,$Er),$EM.texParameteri(this._type,10242,33071),$EM.texParameteri(this._type,10243,33071)),$Ec&&$Eq&&$Ep.bindTexture($EM,$Ec,$Eq),this.memorySize=$EH?this._buffer.length:$EK?$EL*$E_*4*(1+1/3):$EL*$E_*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$Ee.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$Ee.onAsynLoaded=function($EM,$Ee,$EL){var $E_;$EL&&($E_=$EL[0].call(this,$Ee)),$E_&&(this._width=$E_.width,this._height=$E_.height,this._buffer=$E_.data),this._src=$EM,this._size=new $Ere(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$Ee.getPixels=function(){return new Uint8Array(this._buffer)},$Ee.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($ES.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$Ed(0,$Ee,"src",function(){return this._src}),$EX.create=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){if(void 0===$E_&&($E_=9729),void 0===$Ec&&($Ec=9729),void 0===$Eq&&($Eq=!0),!$EM||$EM.byteLength<$Ee*$EL*4)throw"DataTexture2D create error";var $ET=new $EX;return $ET.uri=$EH,$ET._buffer=$EM,$ET._width=$Ee,$ET._height=$EL,$ET._mipmap=$Eq,$ET._magFifter=$E_,$ET._minFifter=$Ec,$ET._size=new $Ere($ET._width,$ET._height),$ET._conchTexture?alert("怎么给runtime传递datatexture数据"):$ET.activeResource(),$ET},$EX.load=function($EM,$Ee,$EL,$E_,$Ec){if(void 0===$Ee&&($Ee=0),void 0===$EL&&($EL=0),void 0===$E_&&($E_=9729),void 0===$Ec&&($Ec=9729),"mipmaps"===$Ek.getFileExtension($EM)){var $Eq=$Ei.loader.create($EM,null,null,$EX,[function($EM){this._mipmaps=[];var $Ee=new Uint32Array($EM);this._width=$Ee[0];var $EL=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$EL=1024),this._width!=$EL)throw"现在只支持512x256的环境贴图。当前的是"+$Ee[0];this._height=$Ee[1];for(var $E_=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$Ec=this._height,$Eq=8;;){var $EH=$E_*$Ec*4;if($Eq+$EH>$EM.byteLength)throw"load mipmaps data size error ";var $ET=new Uint8Array($EM,$Eq,$EH);if(this._mipmaps.push($ET),$Eq+=$EH,1==$E_&&1==$Ec)break;($E_/=2)<1&&($E_=1),($Ec/=2)<1&&($Ec=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$Eq.simLodInfo=new Float32Array(40);for(var $EH=0;$EH<$Eq.simLodInfo.length;)$Eq.simLodInfo[$EH]=($EX.simLodRect[$EH]+.5)/1024,$EH++,$Eq.simLodInfo[$EH]=($EX.simLodRect[$EH]+.5)/256,$EH++,$Eq.simLodInfo[$EH]=Math.max($EX.simLodRect[$EH]-1,.1)/1024,$EH++,$Eq.simLodInfo[$EH]=Math.max($EX.simLodRect[$EH]-1.5,.1)/256,$EH++}return $Eq}if("number"==typeof $Ee)return $Ei.loader.create($EM,null,null,$EX,[function($EM){return this._width=$Ee,this._height=$EL,this._buffer=$EM,null}]);if("function"==typeof $Ee)return $Ei.loader.create($EM,null,null,$EX,[$Ee]);throw new Error("unknown params.")},$EX.lodasatlas=!1,$EG($EX,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$EX}(),$Ewe=function($EM){function $Ee(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$Ee.__super.call(this)}$EE($Ee,"laya.d3.resource.models.PrimitiveMesh",$Epe);var $EL=$Ee.prototype;return $Ei.imps($EL,{"laya.d3.core.render.IRenderable":!0}),$EL._getVertexBuffer=function($EM){return void 0===$EM&&($EM=0),0===$EM?this._vertexBuffer:null},$EL._getVertexBuffers=function(){return null},$EL._getIndexBuffer=function(){return this._indexBuffer},$EL._getPositions=function(){var $EM,$Ee=[],$EL=this._vertexBuffer.vertexDeclaration.getVertexElements(),$E_=0;for($E_=0;$E_<$EL.length;$E_++){var $Ec=$EL[$E_];if("vector3"===$Ec.elementFormat&&0===$Ec.elementUsage){$EM=$Ec;break}}var $Eq=this._vertexBuffer.getData();for($E_=0;$E_<$Eq.length;$E_+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $EH=$E_+$EM.offset/4,$ET=new $EHe($Eq[$EH+0],$Eq[$EH+1],$Eq[$EH+2]);$Ee.push($ET)}return $Ee},$EL.getRenderElement=function($EM){return this},$EL.getRenderElementsCount=function(){return 1},$EL.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$EL._beforeRender=function($EM){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$EL._render=function($EM){$ES.mainContext.drawElements(4,this._numberIndices,5123,0),$EA.drawCall++,$EA.trianglesFaces+=this._numberIndices/3},$Ed(0,$EL,"_vertexBufferCount",function(){return 1}),$Ed(0,$EL,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$Ee}(),$Ebe=function($EM){function $Ee(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$Ee.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$EE($Ee,"laya.d3.resource.models.Mesh",$Epe);var $EL=$Ee.prototype;return $EL._getPositions=function(){var $EM,$Ee,$EL,$E_,$Ec,$Eq=[],$EH=0,$ET=0,$Ex=0;if(0!==this._vertexBuffers.length){var $EO=this._vertexBuffers.length;for($EH=0;$EH<$EO;$EH++){for($EL=($EM=this._vertexBuffers[$EH]).vertexDeclaration.getVertexElements(),$ET=0;$ET<$EL.length;$ET++)if("vector3"===($E_=$EL[$ET]).elementFormat&&0===$E_.elementUsage){$Ee=$E_;break}for($Ec=$EM.getData(),$ET=0;$ET<$Ec.length;$ET+=$EM.vertexDeclaration.vertexStride/4)$Ex=$ET+$Ee.offset/4,$Eq.push(new $EHe($Ec[$Ex+0],$Ec[$Ex+1],$Ec[$Ex+2]))}}else{var $Eu=this._subMeshes.length;for($EH=0;$EH<$Eu;$EH++){for($EL=($EM=this._subMeshes[$EH]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$ET=0;$ET<$EL.length;$ET++)if("vector3"===($E_=$EL[$ET]).elementFormat&&0===$E_.elementUsage){$Ee=$E_;break}for($Ec=$EM.getData(),$ET=0;$ET<$Ec.length;$ET+=$EM.vertexDeclaration.vertexStride/4)$Ex=$ET+$Ee.offset/4,$Eq.push(new $EHe($Ec[$Ex+0],$Ec[$Ex+1],$Ec[$Ex+2]))}}return $Eq},$EL._setSubMeshes=function($EM){this._subMeshes=$EM,this._subMeshCount=$EM.length;for(var $Ee=0;$Ee<this._subMeshCount;$Ee++)$EM[$Ee]._indexInMesh=$Ee;this._positions=this._getPositions(),this._generateBoundingObject()},$EL.onAsynLoaded=function($EM,$Ee,$EL){var $E_=$Ee[0],$Ec=$Ee[1];$EvM.read($E_,this,this._materials,this._subMeshes,$Ec),this.completeCreate(),this._endLoaded()},$EL.getSubMesh=function($EM){return this._subMeshes[$EM]},$EL.getSubMeshCount=function(){return this._subMeshes.length},$EL.getRenderElementsCount=function(){return this._subMeshes.length},$EL.getRenderElement=function($EM){return this._subMeshes[$EM]},$EL.disposeResource=function(){for(var $EM=0;$EM<this._subMeshes.length;$EM++)this._subMeshes[$EM].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$Ed(0,$EL,"materials",function(){return this._materials.slice()}),$Ed(0,$EL,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$Ee.load=function($EM){return $Ei.loader.create($EM,null,null,$Ee)},$Ee}(),$Eme=(function($EM){function $EO($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$EL&&($EL=6408),void 0===$E_&&($E_=5121),void 0===$Ec&&($Ec=33189),void 0===$Eq&&($Eq=!1),void 0===$EH&&($EH=!1),void 0===$ET&&($ET=-1),void 0===$Ex&&($Ex=-1),$EO.__super.call(this),this._type=3553,this._width=$EM,this._height=$Ee,this._size=new $Ere($EM,$Ee),this._surfaceFormat=$EL,this._surfaceType=$E_,this._depthStencilFormat=$Ec,$Er.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$Eq,this._repeat=$EH,this._minFifter=$ET,this._magFifter=$Ex,this.activeResource(),this._alreadyResolved=!0}$EE($EO,"laya.d3.resource.RenderTexture",$ESe);var $Ee=$EO.prototype;$Ee.recreateResource=function(){var $EM=$ES.mainContext;this._frameBuffer=$EM.createFramebuffer(),this._source=$EM.createTexture();var $Ee=$Ep.curBindTexTarget,$EL=$Ep.curBindTexValue;$Ep.bindTexture($EM,this._type,this._source),$EM.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $E_=this._minFifter,$Ec=this._magFifter,$Eq=this._repeat?10497:33071;if($Eo.isPOT(this._width,this._height)?(this._mipmap?-1!==$E_||($E_=9987):-1!==$E_||($E_=9729),-1!==$Ec||($Ec=9729),$EM.texParameteri(this._type,10241,$E_),$EM.texParameteri(this._type,10240,$Ec),$EM.texParameteri(this._type,10242,$Eq),$EM.texParameteri(this._type,10243,$Eq),this._mipmap&&$EM.generateMipmap(this._type)):(-1!==$E_||($E_=9729),-1!==$Ec||($Ec=9729),$EM.texParameteri(this._type,10241,$E_),$EM.texParameteri(this._type,10240,$Ec),$EM.texParameteri(this._type,10242,33071),$EM.texParameteri(this._type,10243,33071)),$Ee&&$EL&&$Ep.bindTexture($EM,$Ee,$EL),$EM.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$EM.createRenderbuffer(),$EM.bindRenderbuffer(36161,this._depthStencilBuffer),$EM.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$EM.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$EM.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$EM.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$EM.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$EM.framebufferTexture2D(36160,36064,3553,this._source,0),$EM.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$Ee.start=function(){$ES.mainContext.bindFramebuffer(36160,this.frameBuffer),($EO._currentRenderTarget=this)._alreadyResolved=!1},$Ee.end=function(){$ES.mainContext.bindFramebuffer(36160,null),$EO._currentRenderTarget=null,this._alreadyResolved=!0},$Ee.getData=function($EM,$Ee,$EL,$E_){var $Ec=$ES.mainContext;if($Ec.bindFramebuffer(36160,this._frameBuffer),!(36053===$Ec.checkFramebufferStatus(36160)))return $Ec.bindFramebuffer(36160,null),null;var $Eq=new Uint8Array(this._width*this._height*4);return $Ec.readPixels($EM,$Ee,$EL,$E_,this._surfaceFormat,this._surfaceType,$Eq),$Ec.bindFramebuffer(36160,null),$Eq},$Ee.disposeResource=function(){if(this._frameBuffer){var $EM=$ES.mainContext;$EM.deleteTexture(this._source),$EM.deleteFramebuffer(this._frameBuffer),$EM.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$Ed(0,$Ee,"surfaceFormat",function(){return this._surfaceFormat}),$Ed(0,$Ee,"surfaceType",function(){return this._surfaceType}),$Ed(0,$Ee,"depthStencilFormat",function(){return this._depthStencilFormat}),$Ed(0,$Ee,"source",function(){return this._alreadyResolved?$Ei.superGet($ESe,this,"source"):null}),$Ed(0,$Ee,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$Ed(0,$Ee,"frameBuffer",function(){return this._frameBuffer}),$EO._currentRenderTarget=null}(),function($EM){function $Ee($EM){this._color=null,this._pixels=null,$Ee.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $Ere(this.width,this.height),this._color=$EM,this._pixels=new Uint8Array([255*$EM.x,255*$EM.y,255*$EM.z,255*$EM.w]),this.uri="SolidColorTexture2D_"+this.id}$EE($Ee,"laya.d3.resource.SolidColorTexture2D",$ESe);var $EL=$Ee.prototype;return $EL._createWebGlTexture=function(){var $EM=$ES.mainContext,$Ee=this._source=$EM.createTexture(),$EL=this._width,$E_=this._height,$Ec=$Ep.curBindTexTarget,$Eq=$Ep.curBindTexValue;$Ep.bindTexture($EM,this._type,$Ee),$EM.texImage2D(this._type,0,6408,$EL,$E_,0,6408,5121,this._pixels);var $EH=this._minFifter,$ET=this._magFifter,$Ex=this._repeat?10497:33071,$EO=$Eo.isPOT($EL,$E_);$EO?(this._mipmap?-1!==$EH||($EH=9987):-1!==$EH||($EH=9729),-1!==$ET||($ET=9729),$EM.texParameteri(this._type,10241,$EH),$EM.texParameteri(this._type,10240,$ET),$EM.texParameteri(this._type,10242,$Ex),$EM.texParameteri(this._type,10243,$Ex),this._mipmap&&$EM.generateMipmap(this._type)):(-1!==$EH||($EH=9729),-1!==$ET||($ET=9729),$EM.texParameteri(this._type,10241,$EH),$EM.texParameteri(this._type,10240,$ET),$EM.texParameteri(this._type,10242,33071),$EM.texParameteri(this._type,10243,33071)),$Ec&&$Eq&&$Ep.bindTexture($EM,$Ec,$Eq),this.memorySize=$EO?$EL*$E_*4*(1+1/3):$EL*$E_*4},$EL.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$EL.disposeResource=function(){this._source&&($ES.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$EG($Ee,["magentaTexture",function(){var $EM=new $Ee(new $ETe(1,0,1,1));return $EM.lock=!0,this.magentaTexture=$EM},"grayTexture",function(){var $EM=new $Ee(new $ETe(.5,.5,.5,1));return $EM.lock=!0,this.grayTexture=$EM}]),$Ee}()),$Eze=function($EM){function $Ec($EM,$Ee,$EL,$E_){this._canRead=!1,this._image=null,this._pixels=null,void 0===$EM&&($EM=!1),void 0===$Ee&&($Ee=!0),void 0===$EL&&($EL=6408),void 0===$E_&&($E_=!0),$Ec.__super.call(this),this._type=3553,this._repeat=$Ee,this._canRead=$EM,this._format=$EL,this._mipmap=$E_}$EE($Ec,"laya.d3.resource.Texture2D",$ESe);var $Ee=$Ec.prototype;return $Ee._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $EM=$ES.mainContext,$Ee=this._source=$EM.createTexture(),$EL=this._width,$E_=this._height,$Ec=$Ep.curBindTexTarget,$Eq=$Ep.curBindTexValue;switch($Ep.bindTexture($EM,this._type,$Ee),this._format){case 6407:case 6408:this._canRead?$EM.texImage2D(this._type,0,this._format,$EL,$E_,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?$EM.texImage2D(this._type,0,this._image._format,$EL,$E_,0,this._image._format,5121,this._image.atlasSource):$EM.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $ES.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$EM.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $EH=this._minFifter,$ET=this._magFifter,$Ex=this._repeat?10497:33071,$EO=0==this._wrapModeU?10497:33071,$Eu=0==this._wrapModeV?10497:33071,$EG=$Eo.isPOT($EL,$E_);$EG?(this._mipmap?-1!==$EH||($EH=9987):-1!==$EH||($EH=9729),-1!==$ET||($ET=9729),$EM.texParameteri(this._type,10241,$EH),$EM.texParameteri(this._type,10240,$ET),$EM.texParameteri(this._type,10242,$Ex),$EM.texParameteri(this._type,10243,$Ex),$EM.texParameteri(this._type,10242,$EO),$EM.texParameteri(this._type,10243,$Eu),this._mipmap&&$EM.generateMipmap(this._type)):(-1!==$EH||($EH=9729),-1!==$ET||($ET=9729),$EM.texParameteri(this._type,10241,$EH),$EM.texParameteri(this._type,10240,$ET),$EM.texParameteri(this._type,10242,33071),$EM.texParameteri(this._type,10243,33071)),$Ec&&$Eq&&$Ep.bindTexture($EM,$Ec,$Eq),this._image.onload=null,this._image=null,this.memorySize=$EG?$EL*$E_*4*(1+1/3):$EL*$E_*4},$Ee.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$Ee.onAsynLoaded=function($EM,$Ee,$EL){if($EL){var $E_=$EL[0];void 0!==$E_&&(this._canRead=$E_);var $Ec=$EL[1];void 0!==$Ec&&(this._repeat=$Ec);var $Eq=$EL[2];void 0!==$Eq&&(this._format=$Eq);var $EH=$EL[3];void 0!==$EH&&(this._mipmap=$EH);var $ET=$EL.wrapModeU;void 0!==$ET&&(this._wrapModeU=$ET);var $Ex=$EL.wrapModeV;void 0!==$Ex&&(this._wrapModeV=$Ex)}switch(this._format){case 6407:case 6408:var $EO=(this._image=$Ee).width,$Eu=$Ee.height;this._width=$EO,this._height=$Eu,this._size=new $Ere($EO,$Eu),this._canRead&&($Er.isConchApp?$Ee instanceof $EV.HTMLElement&&(this._pixels=new Uint8Array($Ee.getImageData(0,0,$EO,$Eu))):($ER.canvas.size($EO,$Eu),$ER.canvas.clear(),$ER.context.drawImage($Ee,0,0,$EO,$Eu),this._pixels=new Uint8Array($ER.context.getImageData(0,0,$EO,$Eu).data.buffer)));break;case $ES.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $EG=new $EW($Ee);$EG.readUTFBytes(4),$EG.readUTFBytes(2),$EG.getInt16();$EG.endian="bigEndian",this._width=$EG.getInt16(),this._height=$EG.getInt16(),this._size=new $Ere(this._width,this._height);$EG.getInt16(),$EG.getInt16();this._image=new Uint8Array($Ee,$EG.pos)}this.recreateResource(),this._endLoaded()},$Ee.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$Ee.disposeResource=function(){this._source&&($ES.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$Ed(0,$Ee,"_src",function(){return this.url}),$Ed(0,$Ee,"src",function(){return this.url}),$Ec.load=function($EM){return $Ei.loader.create($EM,null,null,$Ec)},$Ec}(),$EQe=function($Ee){function $EL($EM,$Ee){$EL.__super.call(this),void 0===$EM&&($EM=.3),void 0===$Ee&&($Ee=1e3),this._tempVector3=new $EHe,this._position=new $EHe,this._up=new $EHe,this._forward=new $EHe,this._right=new $EHe,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$Ere.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$EM,this._farPlane=$Ee,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$Ei.stage.on("resize",this,this._onScreenSizeChanged)}$EE($EL,"laya.d3.core.BaseCamera",$Ee);var $EM=$EL.prototype;return $EM._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $EM=this.scene._cameraPool,$Ee=$EM.length-1,$EL=0;$EL<$Ee;$EL++)if($EM[$EL].renderingOrder>$EM[$Ee].renderingOrder){var $E_=$EM[$EL];$EM[$EL]=$EM[$Ee],$EM[$Ee]=$E_}},$EM._calculateProjectionMatrix=function(){},$EM._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$EM._prepareCameraToRender=function(){$Ea._currentCameraCullingMask=this.cullingMask;var $EM=this._shaderValues;$EM.setValue(0,this.transform.position.elements),$EM.setValue(5,this.forward.elements),$EM.setValue(6,this.up.elements)},$EM._prepareCameraViewProject=function($EM,$Ee){var $EL=this._shaderValues;$EL.setValue(1,$EM.elements),$EL.setValue(2,$Ee.elements)},$EM._renderCamera=function($EM,$Ee,$EL){},$EM.addLayer=function($EM){29!==$EM.number&&30!=$EM.number&&(this.cullingMask=this.cullingMask|$EM.mask)},$EM.removeLayer=function($EM){29!==$EM.number&&30!=$EM.number&&(this.cullingMask=this.cullingMask&~$EM.mask)},$EM.addAllLayers=function(){this.cullingMask=2147483647},$EM.removeAllLayers=function(){this.cullingMask=0|$Ea.getLayerByNumber(29).mask|$Ea.getLayerByNumber(30).mask},$EM.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$EM.moveForward=function($EM){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$EM,this.transform.translate(this._tempVector3)},$EM.moveRight=function($EM){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$EM,this.transform.translate(this._tempVector3)},$EM.moveVertical=function($EM){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$EM,this.transform.translate(this._tempVector3,!1)},$EM._addSelfRenderObjects=function(){var $EM=this.scene._cameraPool,$Ee=$EM.length;if(0<$Ee){for(var $EL=$Ee-1;0<=$EL;$EL--)if(this.renderingOrder<=$EM[$EL].renderingOrder){$EM.splice($EL+1,0,this);break}}else $EM.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$EM._clearSelfRenderObjects=function(){var $EM=this.scene._cameraPool;$EM.splice($EM.indexOf(this),1)},$EM.destroy=function($EM){void 0===$EM&&($EM=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$Ei.stage.off("resize",this,this._onScreenSizeChanged),$Ee.prototype.destroy.call(this,$EM)},$Ed(0,$EM,"sky",function(){return this._sky},function($EM){(this._sky=$EM)._ownerCamera=this}),$Ed(0,$EM,"forward",function(){var $EM=this.transform.worldMatrix.elements,$Ee=this._forward.elements;return $Ee[0]=-$EM[8],$Ee[1]=-$EM[9],$Ee[2]=-$EM[10],this._forward}),$Ed(0,$EM,"position",function(){var $EM=this.transform.worldMatrix.elements,$Ee=this._position.elements;return $Ee[0]=$EM[12],$Ee[1]=$EM[13],$Ee[2]=$EM[14],this._position}),$Ed(0,$EM,"renderTarget",function(){return this._renderTarget},function($EM){null!=(this._renderTarget=$EM)&&(this._renderTargetSize=$EM.size)}),$Ed(0,$EM,"up",function(){var $EM=this.transform.worldMatrix.elements,$Ee=this._up.elements;return $Ee[0]=$EM[4],$Ee[1]=$EM[5],$Ee[2]=$EM[6],this._up}),$Ed(0,$EM,"right",function(){var $EM=this.transform.worldMatrix.elements,$Ee=this._right.elements;return $Ee[0]=$EM[0],$Ee[1]=$EM[1],$Ee[2]=$EM[2],this._right}),$Ed(0,$EM,"renderTargetSize",function(){return this._renderTargetSize},function($EM){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$EM,this._calculateProjectionMatrix()}),$Ed(0,$EM,"fieldOfView",function(){return this._fieldOfView},function($EM){this._fieldOfView=$EM,this._calculateProjectionMatrix()}),$Ed(0,$EM,"nearPlane",function(){return this._nearPlane},function($EM){this._nearPlane=$EM,this._calculateProjectionMatrix()}),$Ed(0,$EM,"farPlane",function(){return this._farPlane},function($EM){this._farPlane=$EM,this._calculateProjectionMatrix()}),$Ed(0,$EM,"orthographic",function(){return this._orthographic},function($EM){this._orthographic=$EM,this._calculateProjectionMatrix()}),$Ed(0,$EM,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($EM){this._orthographicVerticalSize=$EM,this._calculateProjectionMatrix()}),$Ed(0,$EM,"renderingOrder",function(){return this._renderingOrder},function($EM){this._renderingOrder=$EM,this._sortCamerasByRenderingOrder()}),$EL.CAMERAPOS=0,$EL.VIEWMATRIX=1,$EL.PROJECTMATRIX=2,$EL.VPMATRIX=3,$EL.VPMATRIX_NO_TRANSLATE=4,$EL.CAMERADIRECTION=5,$EL.CAMERAUP=6,$EL.ENVIRONMENTDIFFUSE=7,$EL.ENVIRONMENTSPECULAR=8,$EL.SIMLODINFO=9,$EL.DIFFUSEIRRADMATR=10,$EL.DIFFUSEIRRADMATG=11,$EL.DIFFUSEIRRADMATB=12,$EL.HDREXPOSURE=13,$EL.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$EL.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$EL.CLEARFLAG_SOLIDCOLOR=0,$EL.CLEARFLAG_SKY=1,$EL.CLEARFLAG_DEPTHONLY=2,$EL.CLEARFLAG_NONE=3,$EG($EL,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $EMe(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $EMe},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $EMe}]),$EL}($Ele),$EYe=function($EL){function $Ee($EM){this._render=null,this._geometryFilter=null,$Ee.__super.call(this,$EM)}$EE($Ee,"laya.d3.core.RenderableSprite3D",$EL);var $EM=$Ee.prototype;return $EM._addToInitStaticBatchManager=function(){},$EM._setBelongScene=function($EM){$EL.prototype._setBelongScene.call(this,$EM),$EM._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$EM._setUnBelongScene=function(){var $EM=this._scene._renderableSprite3Ds,$Ee=$EM.indexOf(this);$EM.splice($Ee,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$EL.prototype._setUnBelongScene.call(this)},$EM._update=function($EM){($EM.owner=this)._activeInHierarchy&&(this._updateComponents($EM),this._render._updateOctreeNode(),this._lateUpdateComponents($EM),$EA.spriteCount++,this._childs.length&&this._updateChilds($EM))},$EM.destroy=function($EM){void 0===$EM&&($EM=!0),$EL.prototype.destroy.call(this,$EM),this._render._destroy(),this._render=null},$Ee.__init__=function(){$Ee.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$Ee.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$Ee.SAHDERDEFINE_LIGHTMAP=$Ee.shaderDefines.registerDefine("LIGHTMAP")},$Ee.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$Ee.SAHDERDEFINE_LIGHTMAP=4,$Ee.LIGHTMAPSCALEOFFSET=2,$Ee.LIGHTMAP=3,$EG($Ee,["shaderDefines",function(){return this.shaderDefines=new $Eue}]),$Ee}($Ele),$EPe=(function($EM){function $E_($EM,$Ee,$EL){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$EM&&($EM=1),void 0===$Ee&&($Ee=1),void 0===$EL&&($EL=1),$E_.__super.call(this),this._long=$EM,this._width=$Ee,this._height=$EL,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$EE($E_,"laya.d3.resource.models.BoxMesh",$Ewe);var $Ee=$E_.prototype;$Ee.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $EM=$ESM.vertexDeclaration,$Ee=($EM.vertexStride,this._long/2),$EL=this._height/2,$E_=this._width/2,$Ec=new Float32Array([-$Ee,$EL,-$E_,0,1,0,0,0,$Ee,$EL,-$E_,0,1,0,1,0,$Ee,$EL,$E_,0,1,0,1,1,-$Ee,$EL,$E_,0,1,0,0,1,-$Ee,-$EL,-$E_,0,-1,0,0,1,$Ee,-$EL,-$E_,0,-1,0,1,1,$Ee,-$EL,$E_,0,-1,0,1,0,-$Ee,-$EL,$E_,0,-1,0,0,0,-$Ee,$EL,-$E_,-1,0,0,0,0,-$Ee,$EL,$E_,-1,0,0,1,0,-$Ee,-$EL,$E_,-1,0,0,1,1,-$Ee,-$EL,-$E_,-1,0,0,0,1,$Ee,$EL,-$E_,1,0,0,1,0,$Ee,$EL,$E_,1,0,0,0,0,$Ee,-$EL,$E_,1,0,0,0,1,$Ee,-$EL,-$E_,1,0,0,1,1,-$Ee,$EL,$E_,0,0,1,0,0,$Ee,$EL,$E_,0,0,1,1,0,$Ee,-$EL,$E_,0,0,1,1,1,-$Ee,-$EL,$E_,0,0,1,0,1,-$Ee,$EL,-$E_,0,0,-1,1,0,$Ee,$EL,-$E_,0,0,-1,0,0,$Ee,-$EL,-$E_,0,0,-1,0,1,-$Ee,-$EL,-$E_,0,0,-1,1,1]),$Eq=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $Ege($EM,this._numberVertices,35044,!0),this._indexBuffer=new $EFe("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($Ec),this._indexBuffer.setData($Eq),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$Ed(0,$Ee,"long",function(){return this._long},function($EM){this._long!==$EM&&(this._long=$EM,this.releaseResource(),this.activeResource())}),$Ed(0,$Ee,"width",function(){return this._width},function($EM){this._width!==$EM&&(this._width=$EM,this.releaseResource(),this.activeResource())}),$Ed(0,$Ee,"height",function(){return this._height},function($EM){this._height!==$EM&&(this._height=$EM,this.releaseResource(),this.activeResource())})}(),function($EM){function $EH($EM,$Ee,$EL){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=.3),void 0===$EL&&($EL=1e3),this._viewMatrix=new $EMe,this._projectionMatrix=new $EMe,this._projectionViewMatrix=new $EMe,this._viewport=new $Exe(0,0,0,0),this._normalizedViewport=new $Exe(0,0,1,1),this._aspectRatio=$EM,this._boundFrustumUpdate=!0,this._boundFrustum=new $EsM($EMe.DEFAULT),$EH.__super.call(this,$Ee,$EL),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$EE($EH,"laya.d3.core.Camera",$EQe);var $Ee=$EH.prototype;return $Ee._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$Ee._parseCustomProps=function($EM,$Ee,$EL,$E_){var $Ec=$EL.clearColor;this.clearColor=new $ETe($Ec[0],$Ec[1],$Ec[2],$Ec[3]);var $Eq=$EL.viewport;this.normalizedViewport=new $Exe($Eq[0],$Eq[1],$Eq[2],$Eq[3])},$Ee._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $EM=this.orthographicVerticalSize*this.aspectRatio*.5,$Ee=.5*this.orthographicVerticalSize;$EMe.createOrthoOffCenterRH(-$EM,$EM,-$Ee,$Ee,this.nearPlane,this.farPlane,this._projectionMatrix)}else $EMe.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$Ee._update=function($EM){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$EM)},$Ee._renderCamera=function($EM,$Ee,$EL){var $E_,$Ec;$EL.parallelSplitShadowMaps[0]&&$EL._renderShadowMap($EM,$Ee,this),($Ee.camera=this)._prepareCameraToRender(),$EL._preRenderUpdateComponents($Ee),$E_=$Ee._viewMatrix=this.viewMatrix;var $Eq=this._renderTarget;$Eq?($Eq.start(),$EMe.multiply($EQe._invertYScaleMatrix,this._projectionMatrix,$EQe._invertYProjectionMatrix),$EMe.multiply($EQe._invertYScaleMatrix,this.projectionViewMatrix,$EQe._invertYProjectionViewMatrix),$Ec=$Ee._projectionMatrix=$EQe._invertYProjectionMatrix,$Ee._projectionViewMatrix=$EQe._invertYProjectionViewMatrix):($Ec=$Ee._projectionMatrix=this._projectionMatrix,$Ee._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($E_,$Ec),$Ee._viewport=this.viewport,$EL._preRenderScene($EM,$Ee,this.boundFrustum),$EL._clear($EM,$Ee),$EL._renderScene($EM,$Ee),$EL._postRenderUpdateComponents($Ee),$Eq&&$Eq.end()},$Ee.viewportPointToRay=function($EM,$Ee){$Ede.calculateCursorRay($EM,this.viewport,this._projectionMatrix,this.viewMatrix,null,$Ee)},$Ee.normalizedViewportPointToRay=function($EM,$Ee){var $EL=$EH._tempVector20,$E_=this.viewport,$Ec=$EM.elements,$Eq=$EL.elements;$Eq[0]=$Ec[0]*$E_.width,$Eq[1]=$Ec[1]*$E_.height,$Ede.calculateCursorRay($EL,this.viewport,this._projectionMatrix,this.viewMatrix,null,$Ee)},$Ee.worldToViewportPoint=function($EM,$Ee){$EMe.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($EM,this._projectionViewMatrix,$Ee);var $EL=$Ee.elements;$EL[0]=$EL[0]/$Ei.stage.clientScaleX,$EL[1]=$EL[1]/$Ei.stage.clientScaleY},$Ee.worldToNormalizedViewportPoint=function($EM,$Ee){$EMe.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($EM,this._projectionViewMatrix,$Ee);var $EL=$Ee.elements;$EL[0]=$EL[0]/$Ei.stage.clientScaleX,$EL[1]=$EL[1]/$Ei.stage.clientScaleY},$Ee.convertScreenCoordToOrthographicCoord=function($EM,$Ee){if(this._orthographic){var $EL=$Ev.clientWidth,$E_=$Ev.clientHeight,$Ec=this.orthographicVerticalSize*this.aspectRatio/$EL,$Eq=this.orthographicVerticalSize/$E_,$EH=$EM.elements,$ET=$Ee.elements;return $ET[0]=(-$EL/2+$EH[0])*$Ec,$ET[1]=($E_/2-$EH[1])*$Eq,$ET[2]=(this.nearPlane-this.farPlane)*($EH[2]+1)/2-this.nearPlane,$EHe.transformCoordinate($Ee,this.transform.worldMatrix,$Ee),!0}return!1},$Ed(0,$Ee,"projectionViewMatrix",function(){return $EMe.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$Ed(0,$Ee,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $EM=this.viewport;return $EM.width/$EM.height},function($EM){if($EM<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$EM,this._calculateProjectionMatrix()}),$Ed(0,$Ee,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$Ed(0,$Ee,"needViewport",function(){var $EM=this.normalizedViewport;return 0===$EM.x&&0===$EM.y&&1===$EM.width&&1===$EM.height}),$Ed(0,$Ee,"viewport",function(){if(this._viewportExpressedInClipSpace){var $EM=this._normalizedViewport,$Ee=this.renderTargetSize,$EL=$Ee.width,$E_=$Ee.height;this._viewport.x=$EM.x*$EL,this._viewport.y=$EM.y*$E_,this._viewport.width=$EM.width*$EL,this._viewport.height=$EM.height*$E_}return this._viewport},function($EM){if(null!=this.renderTarget&&($EM.x<0||$EM.y<0||0==$EM.width||0==$EM.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$EM,this._calculateProjectionMatrix()}),$Ed(0,$Ee,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $EM=this._viewport,$Ee=this.renderTargetSize,$EL=$Ee.width,$E_=$Ee.height;this._normalizedViewport.x=$EM.x/$EL,this._normalizedViewport.y=$EM.y/$E_,this._normalizedViewport.width=$EM.width/$EL,this._normalizedViewport.height=$EM.height/$E_}return this._normalizedViewport},function($EM){$EM.x<0&&($EM.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$EM.y<0&&($EM.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$EM.x+$EM.width&&($EM.width=1-$EM.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$EM.y+$EM.height&&($EM.height=1-$EM.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$EM,this._calculateProjectionMatrix()}),$Ed(0,$Ee,"projectionMatrix",function(){return this._projectionMatrix},function($EM){this._projectionMatrix=$EM,this._useUserProjectionMatrix=!0}),$Ed(0,$Ee,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$EG($EH,["_tempVector20",function(){return this._tempVector20=new $Eqe}]),$EH}()),$EZe=function($EL){function $E_($EM,$Ee){$E_.__super.call(this,$Ee),this._geometryFilter=new $ERe(this),this._render=new $Eae(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$EM&&(this._geometryFilter.sharedMesh=$EM)instanceof laya.d3.resource.models.Mesh&&($EM.loaded?this._render.sharedMaterials=$EM.materials:$EM.once("loaded",this,this._applyMeshMaterials))}$EE($E_,"laya.d3.core.MeshSprite3D",$EL);var $EM=$E_.prototype;return $EM._changeRenderObjectByMesh=function($EM){var $Ee=this._render._renderElements,$EL=$Ee[$EM];$EL||($EL=$Ee[$EM]=new $Eye),$EL._render=this._render;var $E_=this._render.sharedMaterials[$EM];$E_||($E_=$Eje.defaultMaterial);var $Ec=this._geometryFilter.sharedMesh.getRenderElement($EM);return $EL._mainSortID=this._getSortID($Ec,$E_),$EL._sprite3D=this,$EL.renderObj=$Ec,$EL._material=$E_,$EL},$EM._changeRenderObjectByMaterial=function($EM,$Ee){var $EL=this._render._renderElements[$EM];$Ee||($Ee=$Eje.defaultMaterial);var $E_=this._geometryFilter.sharedMesh.getRenderElement($EM);return $EL._mainSortID=this._getSortID($E_,$Ee),$EL._sprite3D=this,$EL.renderObj=$E_,$EL._material=$Ee,$EL},$EM._changeRenderObjectsByMesh=function(){var $EM=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$EM;for(var $Ee=0;$Ee<$EM;$Ee++)this._changeRenderObjectByMesh($Ee)},$EM._onMeshChanged=function($EM){var $Ee=$EM.sharedMesh;$Ee.loaded?this._changeRenderObjectsByMesh():$Ee.once("loaded",this,this._onMeshLoaded)},$EM._onMeshLoaded=function($EM){$EM===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$EM._onMaterialChanged=function($EM,$Ee,$EL){$Ee<this._render._renderElements.length&&this._changeRenderObjectByMaterial($Ee,$EL)},$EM._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$EM._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$EM._parseCustomProps=function($EM,$Ee,$EL,$E_){var $Ec=this.meshRender,$Eq=$EL.lightmapIndex;null!=$Eq&&($Ec.lightmapIndex=$Eq);var $EH,$ET,$Ex=$EL.lightmapScaleOffset;if($Ex&&($Ec.lightmapScaleOffset=new $ETe($Ex[0],$Ex[1],$Ex[2],$Ex[3])),$E_.instanceParams)($EH=$E_.instanceParams.loadPath)&&($ET=$EC.getRes($Ee[$EH]),(this.meshFilter.sharedMesh=$ET).loaded?$Ec.sharedMaterials=$ET.materials:$ET.once("loaded",this,this._applyMeshMaterials));else{($EH=$EL.meshPath)&&($ET=$EC.getRes($Ee[$EH]),this.meshFilter.sharedMesh=$ET);var $EO=$EL.materials;if($EO){var $Eu=$Ec.sharedMaterials,$EG=$EO.length;$Eu.length=$EG;for(var $EV=0;$EV<$EG;$EV++)$Eu[$EV]=$EC.getRes($Ee[$EO[$EV].path]);$Ec.sharedMaterials=$Eu}}},$EM._applyMeshMaterials=function($EM){for(var $Ee=this._render.sharedMaterials,$EL=$EM.materials,$E_=0,$Ec=$EL.length;$E_<$Ec;$E_++)$Ee[$E_]||($Ee[$E_]=$EL[$E_]);this._render.sharedMaterials=$Ee},$EM._addToInitStaticBatchManager=function(){$E_._staticBatchManager._addInitBatchSprite(this)},$EM.cloneTo=function($EM){var $Ee=$EM;$Ee._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $EL=this._render,$E_=$Ee._render;$E_.enable=$EL.enable,$E_.sharedMaterials=$EL.sharedMaterials,$E_.castShadow=$EL.castShadow;var $Ec=$EL.lightmapScaleOffset;$Ec&&($E_.lightmapScaleOffset=$Ec.clone()),$E_.lightmapIndex=$EL.lightmapIndex,$E_.receiveShadow=$EL.receiveShadow,$E_.sortingFudge=$EL.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$EM)},$EM.destroy=function($EM){if(void 0===$EM&&($EM=!0),!this.destroyed){var $Ee=this.meshFilter.sharedMesh;null!=$Ee&&($Ee.loaded||$Ee.off("loaded",this,this._applyMeshMaterials)),$EL.prototype.destroy.call(this,$EM),this._geometryFilter._destroy()}},$Ed(0,$EM,"meshFilter",function(){return this._geometryFilter}),$Ed(0,$EM,"meshRender",function(){return this._render}),$E_.__init__=function(){$E_M._staticBatchManagers.push($E_._staticBatchManager)},$E_.load=function($EM){return $Ei.loader.create($EM,null,null,$E_)},$EG($E_,["_staticBatchManager",function(){return this._staticBatchManager=new $EBe}]),$E_}($EYe)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($EM,$Ee){"use strict";for(var $EL in Object.defineProperty($Ee,"__esModule",{value:!0}),Laya){var $E_=Laya[$EL];$E_&&$E_.__isclass&&($Ee[$EL]=$E_)}}),function($EM,$Ee,$EcM){$EcM.un,$EcM.uns;var $EL=$EcM.static,$E_=$EcM.class,$Eq=$EcM.getset,$Er=$EcM.__newvec,$ET=laya.maths.Bezier,$EG=laya.utils.Browser,$ESM=laya.utils.Byte,$Ec=(laya.events.Event,laya.events.EventDispatcher),$EH=laya.display.Graphics,$Ex=(laya.resource.HTMLCanvas,laya.utils.Handler),$EO=laya.net.Loader,$EV=laya.maths.MathUtil,$EpM=laya.maths.Matrix,$E$=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$Eu=(laya.renders.RenderContext,laya.resource.Resource),$EE=laya.utils.RunDriver,$EqM=laya.display.Sprite,$Ed=laya.utils.Stat,$ERM=laya.resource.Texture,$EC=(laya.net.URL,laya.utils.Utils),$Ep=function(){function $EM(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $E_($EM,"laya.ani.AnimationContent"),$EM}(),$ER=function(){function $EM(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $E_($EM,"laya.ani.AnimationNodeContent"),$EM}(),$EX=function(){function $EM(){}return $E_($EM,"laya.ani.AnimationParser01"),$EM.parse=function($EM,$Ee){var $EL=$Ee.__getBuffer(),$E_=0,$Ec=0,$Eq=0,$EH=0,$ET=0,$Ex=0,$EO=0,$Eu=$Ee.readUTFString();$EM._aniClassName=$Eu;var $EG,$EV=$Ee.readUTFString().split("\n"),$EE=$Ee.getUint8(),$Ed=$Ee.getUint32(),$Er=$Ee.getUint32();0<$Ed&&($EG=$EL.slice($Ed,$Er));var $E$=new $ESM($EG);for(0<$Er&&($EM._publicExtData=$EL.slice($Er,$EL.byteLength)),$EM._useParent=!!$Ee.getUint8(),$EM._anis.length=$EE,$E_=0;$E_<$EE;$E_++){var $EC=$EM._anis[$E_]=new $Ep;$EC.nodes=new Array;var $EK=$EC.name=$EV[$Ee.getUint16()];$EM._aniMap[$EK]=$E_,$EC.bone3DMap={},$EC.playTime=$Ee.getFloat32(),$EC.playTime<=0&&console.error("播放时间不能为0  url="+$EM.url+" name="+$EC.name);var $EX=$EC.nodes.length=$Ee.getUint8();for($Ec=$EC.totalKeyframeDatasLength=0;$Ec<$EX;$Ec++){var $Eo=$EC.nodes[$Ec]=new $ER;$Eo.childs=[];var $Ei=$Ee.getInt16();0<=$Ei&&($Eo.name=$EV[$Ei],$EC.bone3DMap[$Eo.name]=$Ec),$Eo.keyFrame=new Array,$Eo.parentIndex=$Ee.getInt16(),-1==$Eo.parentIndex?$Eo.parent=null:$Eo.parent=$EC.nodes[$Eo.parentIndex],$Eo.lerpType=$Ee.getUint8();var $EW=$Ee.getUint32();$E$.pos=$EW;var $Ey=$Eo.keyframeWidth=$E$.getUint16();if($EC.totalKeyframeDatasLength+=$Ey,0===$Eo.lerpType||1===$Eo.lerpType)for($Eo.interpolationMethod=[],$Eo.interpolationMethod.length=$Ey,$Eq=0;$Eq<$Ey;$Eq++)$Eo.interpolationMethod[$Eq]=$El.interpolation[$E$.getUint8()];null!=$Eo.parent&&$Eo.parent.childs.push($Eo);var $EA=$Ee.getUint16();0<$EA&&($Eo.extenData=$EL.slice($Ee.pos,$Ee.pos+$EA),$Ee.pos+=$EA);var $EB,$Ek=$Ee.getUint16(),$Eh=0;for($Eq=0,$EH=$Eo.keyFrame.length=$Ek;$Eq<$EH;$Eq++){if(($EB=$Eo.keyFrame[$Eq]=new $Ea).duration=$Ee.getFloat32(),$EB.startTime=$Eh,2===$Eo.lerpType){$EB.interpolationData=[];var $Et,$ES=$Ee.getUint8();switch($Et=$Ee.getFloat32()){case 254:for($EB.interpolationData.length=$Ey,$EO=0;$EO<$Ey;$EO++)$EB.interpolationData[$EO]=0;break;case 255:for($EB.interpolationData.length=$Ey,$EO=0;$EO<$Ey;$EO++)$EB.interpolationData[$EO]=5;break;default:for($EB.interpolationData.push($Et),$Ex=1;$Ex<$ES;$Ex++)$EB.interpolationData.push($Ee.getFloat32())}}for($EB.data=new Float32Array($Ey),$ET=0;$ET<$Ey;$ET++)$EB.data[$ET]=$Ee.getFloat32(),-1e-8<$EB.data[$ET]&&$EB.data[$ET]<1e-8&&($EB.data[$ET]=0);$Eh+=$EB.duration}$EB.startTime=$EC.playTime,$Eo.playTime=$EC.playTime,$EM._calculateKeyFrame($Eo,$Ek,$Ey)}}},$EM}(),$Eo=function(){function $Ei(){}return $E_($Ei,"laya.ani.AnimationParser02"),$Ei.READ_DATA=function(){$Ei._DATA.offset=$Ei._reader.getUint32(),$Ei._DATA.size=$Ei._reader.getUint32()},$Ei.READ_BLOCK=function(){for(var $EM=$Ei._BLOCK.count=$Ei._reader.getUint16(),$Ee=$Ei._BLOCK.blockStarts=[],$EL=$Ei._BLOCK.blockLengths=[],$E_=0;$E_<$EM;$E_++)$Ee.push($Ei._reader.getUint32()),$EL.push($Ei._reader.getUint32())},$Ei.READ_STRINGS=function(){var $EM=$Ei._reader.getUint32(),$Ee=$Ei._reader.getUint16(),$EL=$Ei._reader.pos;$Ei._reader.pos=$EM+$Ei._DATA.offset;for(var $E_=0;$E_<$Ee;$E_++)$Ei._strings[$E_]=$Ei._reader.readUTFString();$Ei._reader.pos=$EL},$Ei.parse=function($EM,$Ee){$Ei._templet=$EM;($Ei._reader=$Ee).__getBuffer();$Ei.READ_DATA(),$Ei.READ_BLOCK(),$Ei.READ_STRINGS();for(var $EL=0,$E_=$Ei._BLOCK.count;$EL<$E_;$EL++){var $Ec=$Ee.getUint16(),$Eq=$Ei._strings[$Ec],$EH=$Ei["READ_"+$Eq];if(null==$EH)throw new Error("model file err,no this function:"+$Ec+" "+$Eq);$EH.call()}},$Ei.READ_ANIMATIONS=function(){var $EM=$Ei._reader,$Ee=$EM.__getBuffer(),$EL=0,$E_=0,$Ec=0,$Eq=0,$EH=$EM.getUint16(),$ET=[];for($ET.length=$EH,$EL=0;$EL<$EH;$EL++)$ET[$EL]=$El.interpolation[$EM.getByte()];var $Ex=$EM.getUint8();for($Ei._templet._anis.length=$Ex,$EL=0;$EL<$Ex;$EL++){var $EO=$Ei._templet._anis[$EL]={};$EO.nodes=new Array;var $Eu=$EO.name=$Ei._strings[$EM.getUint16()];$Ei._templet._aniMap[$Eu]=$EL,$EO.bone3DMap={},$EO.playTime=$EM.getFloat32();var $EG=$EO.nodes.length=$EM.getInt16();for($E_=$EO.totalKeyframeDatasLength=0;$E_<$EG;$E_++){var $EV=$EO.nodes[$E_]={};$EV.keyframeWidth=$EH,$EV.childs=[];var $EE=$EM.getUint16();0<=$EE&&($EV.name=$Ei._strings[$EE],$EO.bone3DMap[$EV.name]=$E_),$EV.keyFrame=new Array,$EV.parentIndex=$EM.getInt16(),-1==$EV.parentIndex?$EV.parent=null:$EV.parent=$EO.nodes[$EV.parentIndex],$EO.totalKeyframeDatasLength+=$EH,$EV.interpolationMethod=$ET,null!=$EV.parent&&$EV.parent.childs.push($EV);var $Ed=$EM.getUint16(),$Er=null,$E$=null;for($Ec=0,$Eq=$EV.keyFrame.length=$Ed;$Ec<$Eq;$Ec++){($Er=$EV.keyFrame[$Ec]={}).startTime=$EM.getFloat32(),$E$&&($E$.duration=$Er.startTime-$E$.startTime);var $EC=$Ei._DATA.offset,$EK=$EM.getUint32(),$EX=4*$EH,$Eo=$Ee.slice($EC+$EK,$EC+$EK+$EX);$Er.data=new Float32Array($Eo),$E$=$Er}$Er.duration=0,$EV.playTime=$EO.playTime,$Ei._templet._calculateKeyFrame($EV,$Ed,$EH)}}},$Ei._templet=null,$Ei._reader=null,$Ei._strings=[],$EL($Ei,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$Ei}(),$EaM=(function(){function $EM(){}$E_($EM,"laya.ani.AnimationState"),$EM.stopped=0,$EM.paused=1,$EM.playing=2}(),function(){function $Ec(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $EYM,this.resultMatrix=new $EpM,this._children=[]}$E_($Ec,"laya.ani.bone.Bone");var $EM=$Ec.prototype;return $EM.setTempMatrix=function($EM){this._tempMatrix=$EM;var $Ee,$EL=0;for($EL=0,$Ee=this._children.length;$EL<$Ee;$EL++)this._children[$EL].setTempMatrix(this._tempMatrix)},$EM.update=function($EM){var $Ee;if(this.rotation=this.transform.skX,$EM)$Ee=this.resultTransform.getMatrix(),$EpM.mul($Ee,$EM,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$Ee=this.resultTransform.getMatrix(),$EpM.mul($Ee,this.parentBone.resultMatrix,this.resultMatrix);else{var $EL=this.parentBone,$E_=NaN,$Ec=NaN,$Eq=NaN,$EH=this.parentBone.resultMatrix;$Ee=this.resultTransform.getMatrix();var $ET=$EH.a*$Ee.tx+$EH.c*$Ee.ty+$EH.tx,$Ex=$EH.b*$Ee.tx+$EH.d*$Ee.ty+$EH.ty,$EO=new $EpM;this.inheritRotation?($E_=Math.atan2($EL.resultMatrix.b,$EL.resultMatrix.a),$Ec=Math.cos($E_),$Eq=Math.sin($E_),$EO.setTo($Ec,$Eq,-$Eq,$Ec,0,0),$EpM.mul(this._tempMatrix,$EO,$EpM.TEMP),$EpM.TEMP.copyTo($EO),$Ee=this.resultTransform.getMatrix(),$EpM.mul($Ee,$EO,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$Ee=this.resultTransform.getMatrix(),$EpM.TEMP.identity(),$EpM.TEMP.d=this.d,$EpM.mul($Ee,$EpM.TEMP,this.resultMatrix)),this.resultMatrix.tx=$ET,this.resultMatrix.ty=$Ex}else($Ee=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $Eu,$EG=0;for($EG=0,$Eu=this._children.length;$EG<$Eu;$EG++)this._children[$EG].update()},$EM.updateChild=function(){var $EM,$Ee=0;for($Ee=0,$EM=this._children.length;$Ee<$EM;$Ee++)this._children[$Ee].update()},$EM.setRotation=function($EM){this._sprite&&(this._sprite.rotation=180*$EM/Math.PI)},$EM.updateDraw=function($EM,$Ee){$Ec.ShowBones&&!$Ec.ShowBones[this.name]||(this._sprite||(this._sprite=new $EqM,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$EcM.stage.addChild(this._sprite)),this._sprite.x=$EM+this.resultMatrix.tx,this._sprite.y=$Ee+this.resultMatrix.ty);var $EL,$E_=0;for($E_=0,$EL=this._children.length;$E_<$EL;$E_++)this._children[$E_].updateDraw($EM,$Ee)},$EM.addChild=function($EM){this._children.push($EM),$EM.parentBone=this},$EM.findBone=function($EM){if(this.name==$EM)return this;var $Ee,$EL,$E_=0;for($E_=0,$Ee=this._children.length;$E_<$Ee;$E_++)if($EL=this._children[$E_].findBone($EM))return $EL;return null},$EM.localToWorld=function($EM){var $Ee=$EM[0],$EL=$EM[1];$EM[0]=$Ee*this.resultMatrix.a+$EL*this.resultMatrix.c+this.resultMatrix.tx,$EM[1]=$Ee*this.resultMatrix.b+$EL*this.resultMatrix.d+this.resultMatrix.ty},$Ec.ShowBones={},$Ec}()),$EnM=function(){function $Er(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$E_($Er,"laya.ani.bone.BoneSlot");var $EM=$Er.prototype;return $EM.showSlotData=function($EM,$Ee){void 0===$Ee&&($Ee=!0),this.currSlotData=$EM,$Ee&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$EM.showDisplayByName=function($EM){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($EM))},$EM.replaceDisplayByName=function($EM,$Ee){if(this.currSlotData){var $EL;$EL=this.currSlotData.getDisplayByName($EM);var $E_;$E_=this.currSlotData.getDisplayByName($Ee),this.replaceDisplayByIndex($EL,$E_)}},$EM.replaceDisplayByIndex=function($EM,$Ee){this.currSlotData&&(this._replaceDic[$EM]=$Ee,this.displayIndex==$EM&&this.showDisplayByIndex($EM))},$EM.showDisplayByIndex=function($EM){if(null!=this._replaceDic[$EM]&&($EM=this._replaceDic[$EM]),this.currSlotData&&-1<$EM&&$EM<this.currSlotData.displayArr.length){if(this.displayIndex=$EM,this.currDisplayData=this.currSlotData.displayArr[$EM],this.currDisplayData){var $Ee=this.currDisplayData.name;this.currTexture=this.templet.getTexture($Ee),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$E$.isConchApp||$E$.isConchApp&&"0.9.15"<$EqM.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$EM.replaceSkin=function($EM){this._diyTexture=$EM,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$EM.setParentMatrix=function($EM){this._parentMatrix=$EM},$EM.draw=function($EM,$Ee,$EL,$E_){if(void 0===$EL&&($EL=!1),void 0===$E_&&($E_=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $Ec,$Eq=this.currTexture;switch(this._diyTexture&&($Eq=this._diyTexture),this.currDisplayData.type){case 0:if($EM){var $EH=this.getDisplayMatrix();if(this._parentMatrix){var $ET=!1;if($EH){var $Ex;if($EpM.mul($EH,this._parentMatrix,$EpM.TEMP),$Ex=$EL?(null==this._resultMatrix&&(this._resultMatrix=new $EpM),this._resultMatrix):new $EpM,!$E$.isWebGL&&this.currDisplayData.uvs||$E$.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $EO=$Er._tempMatrix;$EO.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($EO.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($ET=!0,$EO.rotate(-Math.PI/2)),$EpM.mul($EO,$EpM.TEMP,$Ex)}else $EpM.TEMP.copyTo($Ex);$ET?$EM.drawTexture($Eq,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$Ex):$EM.drawTexture($Eq,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$Ex)}}}break;case 1:if(null==($Ec=$EL?(null==this._skinSprite&&(this._skinSprite=$Er.createSkinMesh()),this._skinSprite):$Er.createSkinMesh()))return;var $Eu;if(null==this.currDisplayData.bones){var $EG,$EV=this.currDisplayData.weights;this.deformData&&($EV=this.deformData),$EG=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$Ey.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$Ey.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$EV;this.currDisplayData.triangles.length;$Eu=this.currDisplayData.triangles,$Ec.init2($Eq,null,$Eu,this._mVerticleArr,$EG);var $EE,$Ed=this.getDisplayMatrix();if(this._parentMatrix)if($Ed)$EpM.mul($Ed,this._parentMatrix,$EpM.TEMP),$EE=$EL?(null==this._resultMatrix&&(this._resultMatrix=new $EpM),this._resultMatrix):new $EpM,$EpM.TEMP.copyTo($EE),$Ec.transform=$EE}else this.skinMesh($Ee,$Ec,$E_);$EM.drawSkin($Ec);break;case 2:if(null==($Ec=$EL?(null==this._skinSprite&&(this._skinSprite=$Er.createSkinMesh()),this._skinSprite):$Er.createSkinMesh()))return;this.skinMesh($Ee,$Ec,$E_),$EM.drawSkin($Ec)}}},$EM.skinMesh=function($EM,$Ee,$EL){var $E_,$Ec=this.currTexture,$Eq=this.currDisplayData.bones;$E_=this._diyTexture?($Ec=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$Ey.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$Ey.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $EH,$ET,$Ex=this.currDisplayData.weights,$EO=this.currDisplayData.triangles,$Eu=0,$EG=0,$EV=0,$EE=NaN,$Ed=NaN,$Er=0,$E$=0,$EC=[],$EK=0,$EX=0;if(this.deformData&&0<this.deformData.length){var $Eo=0;for($EK=0,$EX=$Eq.length;$EK<$EX;){for($EV=$Eq[$EK++]+$EK,$EG=$Eu=0;$EK<$EV;$EK++)$ET=$EM[$Eq[$EK]],$EE=$Ex[$Er]+this.deformData[$Eo++],$Ed=$Ex[$Er+1]+this.deformData[$Eo++],$E$=$Ex[$Er+2],$Eu+=($EE*$ET.a+$Ed*$ET.c+$ET.tx)*$E$,$EG+=($EE*$ET.b+$Ed*$ET.d+$ET.ty)*$E$,$Er+=3;$EC.push($Eu,$EG)}}else for($EK=0,$EX=$Eq.length;$EK<$EX;){for($EV=$Eq[$EK++]+$EK,$EG=$Eu=0;$EK<$EV;$EK++)$ET=$EM[$Eq[$EK]],$EE=$Ex[$Er],$Ed=$Ex[$Er+1],$E$=$Ex[$Er+2],$Eu+=($EE*$ET.a+$Ed*$ET.c+$ET.tx)*$E$,$EG+=($EE*$ET.b+$Ed*$ET.d+$ET.ty)*$E$,$Er+=3;$EC.push($Eu,$EG)}this._mVerticleArr=$EC,$EH=$EO,$Ee.init2($Ec,null,$EH,this._mVerticleArr,$E_)},$EM.drawBonePoint=function($EM){$EM&&this._parentMatrix&&$EM.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$EM.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$EM.getMatrix=function(){return this._resultMatrix},$EM.copy=function(){var $EM=new $Er;return $EM.type="copy",$EM.name=this.name,$EM.attachmentName=this.attachmentName,$EM.srcDisplayIndex=this.srcDisplayIndex,$EM.parent=this.parent,$EM.displayIndex=this.displayIndex,$EM.templet=this.templet,$EM.currSlotData=this.currSlotData,$EM.currTexture=this.currTexture,$EM.currDisplayData=this.currDisplayData,$EM},$Er.createSkinMesh=function(){return $E$.isWebGL||$E$.isConchApp?$EE.skinAniSprite():($E$.isWebGL,null)},$EL($Er,["_tempMatrix",function(){return this._tempMatrix=new $EpM}]),$Er}(),$ElM=function(){function $EM(){this.skinName=null,this.deformSlotDataList=[]}return $E_($EM,"laya.ani.bone.DeformAniData"),$EM}(),$EfM=function(){function $EM(){this.deformSlotDisplayList=[]}return $E_($EM,"laya.ani.bone.DeformSlotData"),$EM}(),$EjM=function(){function $EM(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$E_($EM,"laya.ani.bone.DeformSlotDisplayData");var $Ee=$EM.prototype;return $Ee.binarySearch1=function($EM,$Ee){var $EL=0,$E_=$EM.length-2;if(0==$E_)return 1;for(var $Ec=$E_>>>1;;){if($EM[Math.floor($Ec+1)]<=$Ee?$EL=$Ec+1:$E_=$Ec,$EL==$E_)return $EL+1;$Ec=$EL+$E_>>>1}return 0},$Ee.apply=function($EM,$Ee,$EL){if(void 0===$EL&&($EL=1),$EM+=.05,!(this.timeList.length<=0)){var $E_=0;if(!($EM<this.timeList[0])){var $Ec=this.vectices[0].length,$Eq=[],$EH=this.binarySearch1(this.timeList,$EM);if(this.frameIndex=$EH,$EM>=this.timeList[this.timeList.length-1]){var $ET=this.vectices[this.vectices.length-1];if($EL<1)for($E_=0;$E_<$Ec;$E_++)$Eq[$E_]+=($ET[$E_]-$Eq[$E_])*$EL;else for($E_=0;$E_<$Ec;$E_++)$Eq[$E_]=$ET[$E_];this.deformData=$Eq}else{this.tweenKeyList[this.frameIndex];var $Ex=this.vectices[this.frameIndex-1],$EO=this.vectices[this.frameIndex],$Eu=this.timeList[this.frameIndex-1],$EG=this.timeList[this.frameIndex];$EL=this.tweenKeyList[$EH-1]?($EM-$Eu)/($EG-$Eu):0;var $EV=NaN;for($E_=0;$E_<$Ec;$E_++)$EV=$Ex[$E_],$Eq[$E_]=$EV+($EO[$E_]-$EV)*$EL;this.deformData=$Eq}}}},$EM}(),$EFM=function(){function $EM(){this.time=NaN,this.drawOrder=[]}return $E_($EM,"laya.ani.bone.DrawOrderData"),$EM}(),$EgM=function(){function $EM(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $E_($EM,"laya.ani.bone.EventData"),$EM}(),$EK=function(){function $E_M($EM,$Ee){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$EM,this._targetBone=$Ee[$EM.targetBoneIndex],this.isSpine=$EM.isSpine,null==this._bones&&(this._bones=[]);for(var $EL=this._bones.length=0,$E_=$EM.boneIndexs.length;$EL<$E_;$EL++)this._bones.push($Ee[$EM.boneIndexs[$EL]]);this.name=$EM.name,this.mix=$EM.mix,this.bendDirection=$EM.bendDirection}$E_($E_M,"laya.ani.bone.IkConstraint");var $EM=$E_M.prototype;return $EM.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$EM._applyIk1=function($EM,$Ee,$EL,$E_){var $Ec=$EM.parentBone,$Eq=1/($Ec.resultMatrix.a*$Ec.resultMatrix.d-$Ec.resultMatrix.b*$Ec.resultMatrix.c),$EH=$Ee-$Ec.resultMatrix.tx,$ET=$EL-$Ec.resultMatrix.ty,$Ex=($EH*$Ec.resultMatrix.d-$ET*$Ec.resultMatrix.c)*$Eq-$EM.transform.x,$EO=($ET*$Ec.resultMatrix.a-$EH*$Ec.resultMatrix.b)*$Eq-$EM.transform.y,$Eu=Math.atan2($EO,$Ex)*$E_M.radDeg-0-$EM.transform.skX;$EM.transform.scX<0&&($Eu+=180),180<$Eu?$Eu-=360:$Eu<-180&&($Eu+=360),$EM.transform.skX=$EM.transform.skY=$EM.transform.skX+$Eu*$E_,$EM.update()},$EM.updatePos=function($EM,$Ee){this._sp&&this._sp.pos($EM,$Ee)},$EM._applyIk2=function($EM,$Ee,$EL,$E_,$Ec,$Eq){if(0!=$Eq){var $EH=$EM.resultTransform.x,$ET=$EM.resultTransform.y,$Ex=$EM.transform.scX,$EO=$EM.transform.scY,$Eu=$Ee.transform.scX,$EG=0,$EV=0,$EE=0;$EE=$Ex<0?($Ex=-$Ex,$EG=180,-1):($EG=0,1),$EO<0&&($EO=-$EO,$EE=-$EE),$EV=$Eu<0?($Eu=-$Eu,180):0;var $Ed=$Ee.resultTransform.x,$Er=NaN,$E$=NaN,$EC=NaN,$EK=$EM.resultMatrix.a,$EX=$EM.resultMatrix.c,$Eo=$EM.resultMatrix.b,$Ei=$EM.resultMatrix.d,$EW=Math.abs($Ex-$EO)<=1e-4;$EC=$EW?($E$=$EK*$Ed+$EX*($Er=$Ee.resultTransform.y)+$EM.resultMatrix.tx,$Eo*$Ed+$Ei*$Er+$EM.resultMatrix.ty):($Er=0,$E$=$EK*$Ed+$EM.resultMatrix.tx,$Eo*$Ed+$EM.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $EqM,$EcM.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($EL,$E_,15,"#ffff00"),this._sp.graphics.drawCircle($E$,$EC,15,"#ff00ff")),$EM.setRotation(Math.atan2($EC-$EM.resultMatrix.ty,$E$-$EM.resultMatrix.tx));var $Ey=$EM.parentBone;$EK=$Ey.resultMatrix.a,$EX=$Ey.resultMatrix.c,$Eo=$Ey.resultMatrix.b;var $EA=1/($EK*($Ei=$Ey.resultMatrix.d)-$EX*$Eo),$EB=$EL-$Ey.resultMatrix.tx,$Ek=$E_-$Ey.resultMatrix.ty,$Eh=($EB*$Ei-$Ek*$EX)*$EA-$EH,$Et=($Ek*$EK-$EB*$Eo)*$EA-$ET,$ES=(($EB=$E$-$Ey.resultMatrix.tx)*$Ei-($Ek=$EC-$Ey.resultMatrix.ty)*$EX)*$EA-$EH,$Ep=($Ek*$EK-$EB*$Eo)*$EA-$ET,$ER=Math.sqrt($ES*$ES+$Ep*$Ep),$Ea=$Ee.length*$Eu,$En=NaN,$El=NaN;if($EW){var $Ef=($Eh*$Eh+$Et*$Et-$ER*$ER-($Ea*=$Ex)*$Ea)/(2*$ER*$Ea);$Ef<-1?$Ef=-1:1<$Ef&&($Ef=1),$El=Math.acos($Ef)*$Ec,$EK=$ER+$Ea*$Ef,$EX=$Ea*Math.sin($El),$En=Math.atan2($Et*$EK-$Eh*$EX,$Eh*$EK+$Et*$EX)}else{var $Ej=($EK=$Ex*$Ea)*$EK,$EF=($EX=$EO*$Ea)*$EX,$Eg=$Eh*$Eh+$Et*$Et,$EJ=Math.atan2($Et,$Eh),$Ew=-2*$EF*$ER,$Eb=$EF-$Ej;if(0<($Ei=$Ew*$Ew-4*$Eb*($Eo=$EF*$ER*$ER+$Ej*$Eg-$Ej*$EF))){var $Em=Math.sqrt($Ei);$Ew<0&&($Em=-$Em);var $Ez=($Em=-($Ew+$Em)/2)/$Eb,$EQ=$Eo/$Em,$EY=Math.abs($Ez)<Math.abs($EQ)?$Ez:$EQ;$EY*$EY<=$Eg&&($Ek=Math.sqrt($Eg-$EY*$EY)*$Ec,$En=$EJ-Math.atan2($Ek,$EY),$El=Math.atan2($Ek/$EO,($EY-$ER)/$Ex))}var $EP=0,$EZ=Number.MAX_VALUE,$Ev=0,$EN=0,$Es=0,$ED=0,$EU=0,$EI=0;$ED<($Ei=($EB=$ER+$EK)*$EB)&&($Es=0,$ED=$Ei,$EU=$EB),($Ei=($EB=$ER-$EK)*$EB)<$EZ&&($EP=Math.PI,$EZ=$Ei,$Ev=$EB);var $EMM=Math.acos(-$EK*$ER/($Ej-$EF));($Ei=($EB=$EK*Math.cos($EMM)+$ER)*$EB+($Ek=$EX*Math.sin($EMM))*$Ek)<$EZ&&($EP=$EMM,$EZ=$Ei,$Ev=$EB,$EN=$Ek),$ED<$Ei&&($Es=$EMM,$ED=$Ei,$EU=$EB,$EI=$Ek),$El=$Eg<=($EZ+$ED)/2?($En=$EJ-Math.atan2($EN*$Ec,$Ev),$EP*$Ec):($En=$EJ-Math.atan2($EI*$Ec,$EU),$Es*$Ec)}var $EeM=Math.atan2($Er,$Ed)*$EE,$ELM=$EM.resultTransform.skX;180<($En=($En-$EeM)*$E_M.radDeg+$EG-$ELM)?$En-=360:$En<-180&&($En+=360),$EM.resultTransform.x=$EH,$EM.resultTransform.y=$ET,$EM.resultTransform.skX=$EM.resultTransform.skY=$ELM+$En*$Eq,$ELM=$Ee.resultTransform.skX,180<($El=(($El+$EeM)*$E_M.radDeg-0)*$EE+$EV-($ELM%=360))?$El-=360:$El<-180&&($El+=360),$Ee.resultTransform.x=$Ed,$Ee.resultTransform.y=$Er,$Ee.resultTransform.skX=$Ee.resultTransform.skY=$Ee.resultTransform.skY+$El*$Eq,$EM.update()}},$EM._applyIk3=function($EM,$Ee,$EL,$E_,$Ec,$Eq){if(0!=$Eq){var $EH,$ET,$Ex=$Ee.resultMatrix.a*$Ee.length,$EO=$Ee.resultMatrix.b*$Ee.length,$Eu=$Ex*$Ex+$EO*$EO,$EG=Math.sqrt($Eu),$EV=$EM.resultMatrix.tx,$EE=$EM.resultMatrix.ty,$Ed=$Ee.resultMatrix.tx,$Er=$Ee.resultMatrix.ty,$E$=$Ed-$EV,$EC=$Er-$EE,$EK=$E$*$E$+$EC*$EC,$EX=Math.sqrt($EK),$Eo=($E$=$EL-$EM.resultMatrix.tx)*$E$+($EC=$E_-$EM.resultMatrix.ty)*$EC,$Ei=Math.sqrt($Eo);if($EG+$EX<=$Ei||$Ei+$EG<=$EX||$Ei+$EX<=$EG){var $EW=NaN;$Ed=$EV+($EW=$EG+$EX<=$Ei?1:-1)*($EL-$EV)*$EX/$Ei,$Er=$EE+$EW*($E_-$EE)*$EX/$Ei}else{var $Ey=($EK-$Eu+$Eo)/(2*$Eo),$EA=Math.sqrt($EK-$Ey*$Ey*$Eo)/$Ei,$EB=$EV+$E$*$Ey,$Ek=$EE+$EC*$Ey,$Eh=-$EC*$EA,$Et=$E$*$EA;$Er=0<$Ec?($Ed=$EB-$Eh,$Ek-$Et):($Ed=$EB+$Eh,$Ek+$Et)}$EH=$Ed,$ET=$Er,this.isDebug&&(this._sp||(this._sp=new $EqM,$EcM.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($EV,$EE,15,"#ff00ff"),this._sp.graphics.drawCircle($EL,$E_,15,"#ffff00"),this._sp.graphics.drawCircle($EH,$ET,15,"#ff00ff"));var $ES,$Ep;$ES=Math.atan2($ET-$EM.resultMatrix.ty,$EH-$EM.resultMatrix.tx),$EM.setRotation($ES),($Ep=$E_M._tempMatrix).identity(),$Ep.rotate($ES),$Ep.scale($EM.resultMatrix.getScaleX(),$EM.resultMatrix.getScaleY()),$Ep.translate($EM.resultMatrix.tx,$EM.resultMatrix.ty),$Ep.copyTo($EM.resultMatrix),$EM.updateChild();var $ER,$Ea;$ER=Math.atan2($E_-$ET,$EL-$EH),$Ee.setRotation($ER),($Ea=$E_M._tempMatrix).identity(),$Ea.rotate($ER),$Ea.scale($Ee.resultMatrix.getScaleX(),$Ee.resultMatrix.getScaleY()),$Ea.translate($EH,$ET),$Ep.copyTo($Ee.resultMatrix),$Ee.updateChild()}},$EL($E_M,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $EpM}]),$E_M}(),$EJM=function(){function $EM(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $E_($EM,"laya.ani.bone.IkConstraintData"),$EM}(),$Ei=function(){function $Ea($EM,$Ee){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$EM,this.position=$EM.position,this.spacing=$EM.spacing,this.rotateMix=$EM.rotateMix,this.translateMix=$EM.translateMix,this.bones=[];for(var $EL=this.data.bones,$E_=0,$Ec=$EL.length;$E_<$Ec;$E_++)this.bones.push($Ee[$EL[$E_]])}$E_($Ea,"laya.ani.bone.PathConstraint");var $EM=$Ea.prototype;return $EM.apply=function($EM,$Ee){if(this.target){var $EL=this.translateMix,$E_=this.translateMix,$Ec=0<$E_,$Eq=this.data.spacingMode,$EH="length"==$Eq,$ET=this.data.rotateMode,$Ex="tangent"==$ET,$EO="chainScale"==$ET,$Eu=[],$EG=this.bones.length,$EV=$Ex?$EG:$EG+1,$EE=[];(this._spaces=$EE)[0]=this.position;var $Ed=this.spacing;if($EO||$EH)for(var $Er=0,$E$=$EV-1;$Er<$E$;){var $EC=this.bones[$Er],$EK=$EC.length,$EX=$EK*$EC.resultMatrix.a,$Eo=$EK*$EC.resultMatrix.b;$EK=Math.sqrt($EX*$EX+$Eo*$Eo),$EO&&($Eu[$Er]=$EK),$EE[++$Er]=$EH?Math.max(0,$EK+$Ed):$Ed}else for($Er=1;$Er<$EV;$Er++)$EE[$Er]=$Ed;var $Ei=this.computeWorldPositions(this.target,$EM,$Ee,$EV,$Ex,"percent"==this.data.positionMode,"percent"==$Eq);if(this._debugKey){for($Er=0;$Er<$Ei.length;$Er++)$Ee.drawCircle($Ei[$Er++],$Ei[$Er++],5,"#00ff00");var $EW=[];for($Er=0;$Er<$Ei.length;$Er++)$EW.push($Ei[$Er++],$Ei[$Er++]);$Ee.drawLines(0,0,$EW,"#ff0000")}var $Ey=$Ei[0],$EA=$Ei[1],$EB=this.data.offsetRotation,$Ek="chain"==$ET&&0==$EB,$Eh=NaN;for($Er=0,$Eh=3;$Er<$EG;$Er++,$Eh+=3){($EC=this.bones[$Er]).resultMatrix.tx+=($Ey-$EC.resultMatrix.tx)*$EL,$EC.resultMatrix.ty+=($EA-$EC.resultMatrix.ty)*$EL;var $Et=($EX=$Ei[$Eh])-$Ey,$ES=($Eo=$Ei[$Eh+1])-$EA;if($EO&&0!=($EK=$Eu[$Er])){var $Ep=(Math.sqrt($Et*$Et+$ES*$ES)/$EK-1)*$E_+1;$EC.resultMatrix.a*=$Ep,$EC.resultMatrix.c*=$Ep}if($Ey=$EX,$EA=$Eo,$Ec){var $ER=$EC.resultMatrix.a,$Ea=$EC.resultMatrix.c,$En=$EC.resultMatrix.b,$El=$EC.resultMatrix.d,$Ef=NaN,$Ej=NaN,$EF=NaN;$Ef=$Ex?$Ei[$Eh-1]:0==$EE[$Er+1]?$Ei[$Eh+2]:Math.atan2($ES,$Et),$Ef-=Math.atan2($En,$ER)-$EB/180*Math.PI,$Ek&&($Ej=Math.cos($Ef),$EF=Math.sin($Ef),$Ey+=(($EK=$EC.length)*($Ej*$ER-$EF*$En)-$Et)*$E_,$EA+=($EK*($EF*$ER+$Ej*$En)-$ES)*$E_),$Ef>Math.PI?$Ef-=2*Math.PI:$Ef<-Math.PI&&($Ef+=2*Math.PI),$Ef*=$E_,$Ej=Math.cos($Ef),$EF=Math.sin($Ef),$EC.resultMatrix.a=$Ej*$ER-$EF*$En,$EC.resultMatrix.c=$Ej*$Ea-$EF*$El,$EC.resultMatrix.b=$EF*$ER+$Ej*$En,$EC.resultMatrix.d=$EF*$Ea+$Ej*$El}}}},$EM.computeWorldVertices2=function($EM,$Ee,$EL,$E_,$Ec,$Eq){var $EH,$ET,$Ex=$EM.currDisplayData.bones,$EO=$EM.currDisplayData.weights,$Eu=$EM.currDisplayData.triangles,$EG=0,$EV=0,$EE=0,$Ed=0,$Er=0,$E$=0,$EC=0,$EK=0,$EX=0,$Eo=0,$Ei=0;if(null!=$Ex){for($EG=0;$EG<$EL;$EG+=2)$EV+=($Ed=$Ex[$EV])+1,$EE+=$Ed;var $EW=$Ee;for($Er=$Eq,$E$=3*$EE;$Er<$E_;$Er+=2){for($EK=$EC=0,$Ed=$Ex[$EV++],$Ed+=$EV;$EV<$Ed;$EV++,$E$+=3){$EH=$EW[$Ex[$EV]].resultMatrix,$EX=$EO[$E$],$Eo=$EO[$E$+1];var $Ey=$EO[$E$+2];$EC+=($EX*$EH.a+$Eo*$EH.c+$EH.tx)*$Ey,$EK+=($EX*$EH.b+$Eo*$EH.d+$EH.ty)*$Ey}$Ec[$Er]=$EC,$Ec[$Er+1]=$EK}}else{var $EA,$EB;if($Eu||($Eu=$EO),$EM.deformData&&($Eu=$EM.deformData),$EA=$EM.parent,$Ee)for($Ei=$Ee.length,$EG=0;$EG<$Ei;$EG++)if($Ee[$EG].name==$EA){$ET=$Ee[$EG];break}$ET&&($EB=$ET.resultMatrix),$EB||($EB=$Ea._tempMt);var $Ek=$EB.tx,$Eh=$EB.ty,$Et=$EB.a,$ES=$EB.b,$Ep=$EB.c,$ER=$EB.d;for($ET&&($ER*=$ET.d),$EV=$EL,$Er=$Eq;$Er<$E_;$EV+=2,$Er+=2)$EX=$Eu[$EV],$Eo=$Eu[$EV+1],$Ec[$Er]=$EX*$Et+$Eo*$ES+$Ek,$Ec[$Er+1]=-($EX*$Ep+$Eo*$ER+$Eh)}},$EM.computeWorldPositions=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH){$EM.currDisplayData.bones,$EM.currDisplayData.weights,$EM.currDisplayData.triangles;var $ET=[],$Ex=0,$EO=$EM.currDisplayData.verLen,$Eu=this.position,$EG=this._spaces,$EV=[],$EE=[],$Ed=$EO/6,$Er=-1,$E$=NaN,$EC=0,$EK=0,$EX=NaN,$Eo=NaN,$Ei=NaN,$EW=NaN;if($Ed--,$EO-=4,this.computeWorldVertices2($EM,$Ee,2,$EO,$ET,0),this._debugKey)for($Ex=0;$Ex<$ET.length;)$EL.drawCircle($ET[$Ex++],$ET[$Ex++],10,"#ff0000");$EV=$ET,this._curves.length=$Ed;var $Ey=this._curves,$EA=$EV[$E$=0],$EB=$EV[1],$Ek=0,$Eh=0,$Et=0,$ES=0,$Ep=0,$ER=0,$Ea=NaN,$En=NaN,$El=NaN,$Ef=NaN,$Ej=NaN,$EF=NaN,$Eg=NaN,$EJ=NaN,$Ew=0;for($Ex=0,$Ew=2;$Ex<$Ed;$Ex++,$Ew+=6)$Ek=$EV[$Ew],$Eh=$EV[$Ew+1],$Et=$EV[$Ew+2],$ES=$EV[$Ew+3],$Ej=2*($Ea=.1875*($EA-2*$Ek+$Et))+($El=.09375*(3*($Ek-$Et)-$EA+($Ep=$EV[$Ew+4]))),$EF=2*($En=.1875*($EB-2*$Eh+$ES))+($Ef=.09375*(3*($Eh-$ES)-$EB+($ER=$EV[$Ew+5]))),$Eg=.75*($Ek-$EA)+$Ea+.16666667*$El,$EJ=.75*($Eh-$EB)+$En+.16666667*$Ef,$E$+=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Eg+=$Ej,$EJ+=$EF,$Ej+=$El,$EF+=$Ef,$E$+=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Eg+=$Ej,$EJ+=$EF,$E$+=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Eg+=$Ej+$El,$EJ+=$EF+$Ef,$E$+=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Ey[$Ex]=$E$,$EA=$Ep,$EB=$ER;if($Eq&&($Eu*=$E$),$EH)for($Ex=0;$Ex<$E_;$Ex++)$EG[$Ex]*=$E$;var $Eb=this._segments,$Em=0,$Ez=0;for($Ez=$EK=$EC=$Ex=0;$Ex<$E_;$Ex++,$EC+=3)if(($EX=$Eu+=$Eo=$EG[$Ex])<0)this.addBeforePosition($EX,$EV,0,$EE,$EC);else if($E$<$EX)this.addAfterPosition($EX-$E$,$EV,$EO-4,$EE,$EC);else{for(;;$EK++)if(!(($EW=$Ey[$EK])<$EX)){0==$EK?$EX/=$EW:$EX=($EX-($Ei=$Ey[$EK-1]))/($EW-$Ei);break}if($EK!=$Er){var $EQ=6*($Er=$EK);for($EA=$EV[$EQ],$EB=$EV[$EQ+1],$Ek=$EV[$EQ+2],$Eh=$EV[$EQ+3],$Et=$EV[$EQ+4],$ES=$EV[$EQ+5],$Ej=2*($Ea=.03*($EA-2*$Ek+$Et))+($El=.006*(3*($Ek-$Et)-$EA+($Ep=$EV[$EQ+6]))),$EF=2*($En=.03*($EB-2*$Eh+$ES))+($Ef=.006*(3*($Eh-$ES)-$EB+($ER=$EV[$EQ+7]))),$Eg=.3*($Ek-$EA)+$Ea+.16666667*$El,$EJ=.3*($Eh-$EB)+$En+.16666667*$Ef,$Em=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Eb[0]=$Em,$EQ=1;$EQ<8;$EQ++)$Eg+=$Ej,$EJ+=$EF,$Ej+=$El,$EF+=$Ef,$Em+=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Eb[$EQ]=$Em;$Eg+=$Ej,$EJ+=$EF,$Em+=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Eb[8]=$Em,$Eg+=$Ej+$El,$EJ+=$EF+$Ef,$Em+=Math.sqrt($Eg*$Eg+$EJ*$EJ),$Eb[9]=$Em,$Ez=0}for($EX*=$Em;;$Ez++)if(!(($EW=$Eb[$Ez])<$EX)){0==$Ez?$EX/=$EW:$EX=$Ez+($EX-($Ei=$Eb[$Ez-1]))/($EW-$Ei);break}this.addCurvePosition(.1*$EX,$EA,$EB,$Ek,$Eh,$Et,$ES,$Ep,$ER,$EE,$EC,$Ec||0<$Ex&&0==$Eo)}return $EE},$EM.addBeforePosition=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$Ee[$EL],$EH=$Ee[$EL+1],$ET=$Ee[$EL+2]-$Eq,$Ex=$Ee[$EL+3]-$EH,$EO=Math.atan2($Ex,$ET);$E_[$Ec]=$Eq+$EM*Math.cos($EO),$E_[$Ec+1]=$EH+$EM*Math.sin($EO),$E_[$Ec+2]=$EO},$EM.addAfterPosition=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$Ee[$EL+2],$EH=$Ee[$EL+3],$ET=$Eq-$Ee[$EL],$Ex=$EH-$Ee[$EL+1],$EO=Math.atan2($Ex,$ET);$E_[$Ec]=$Eq+$EM*Math.cos($EO),$E_[$Ec+1]=$EH+$EM*Math.sin($EO),$E_[$Ec+2]=$EO},$EM.addCurvePosition=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu,$EG){0==$EM&&($EM=1e-4);var $EV=$EM*$EM,$EE=$EV*$EM,$Ed=1-$EM,$Er=$Ed*$Ed,$E$=$Er*$Ed,$EC=$Ed*$EM,$EK=3*$EC,$EX=$Ed*$EK,$Eo=$EK*$EM,$Ei=$Ee*$E$+$E_*$EX+$Eq*$Eo+$ET*$EE,$EW=$EL*$E$+$Ec*$EX+$EH*$Eo+$Ex*$EE;$EO[$Eu]=$Ei,$EO[$Eu+1]=$EW,$EO[$Eu+2]=$EG?Math.atan2($EW-($EL*$Er+$Ec*$EC*2+$EH*$EV),$Ei-($Ee*$Er+$E_*$EC*2+$Eq*$EV)):0},$Ea.NONE=-1,$Ea.BEFORE=-2,$Ea.AFTER=-3,$EL($Ea,["_tempMt",function(){return this._tempMt=new $EpM}]),$Ea}(),$EwM=function(){function $EM(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $E_($EM,"laya.ani.bone.PathConstraintData"),$EM}(),$EbM=function(){function $EM(){this.name=null,this.slotArr=[]}return $E_($EM,"laya.ani.bone.SkinData"),$EM}(),$EmM=function(){function $EM(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$E_($EM,"laya.ani.bone.SkinSlotDisplayData");var $Ee=$EM.prototype;return $Ee.createTexture=function($EM){return this.texture||(this.texture=new $ERM($EM.bitmap,this.uvs),$EM.bitmap.alphaTexture&&(this.texture.alphaTexture=new $ERM($EM.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$EM.height,this.texture.height=$EM.width,this.texture.offsetX=-$EM.offsetX,this.texture.offsetY=-$EM.offsetY,this.texture.sourceWidth=$EM.sourceHeight,this.texture.sourceHeight=$EM.sourceWidth):(this.texture.width=$EM.width,this.texture.height=$EM.height,this.texture.offsetX=-$EM.offsetX,this.texture.offsetY=-$EM.offsetY,this.texture.sourceWidth=$EM.sourceWidth,this.texture.sourceHeight=$EM.sourceHeight),$E$.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$Ee.destory=function(){this.texture&&this.texture.destroy()},$EM}(),$EzM=function(){function $EM(){this.name=null,this.displayArr=[]}return $E_($EM,"laya.ani.bone.SlotData"),$EM.prototype.getDisplayByName=function($EM){for(var $Ee=0,$EL=this.displayArr.length;$Ee<$EL;$Ee++)if(this.displayArr[$Ee].attachmentName==$EM)return $Ee;return-1},$EM}(),$EW=function(){function $EM($EM,$Ee){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$Er(2,0),this._data=$EM,null==this._bones&&(this._bones=[]),this.target=$Ee[$EM.targetIndex];var $EL,$E_=0;for($E_=0,$EL=$EM.boneIndexs.length;$E_<$EL;$E_++)this._bones.push($Ee[$EM.boneIndexs[$E_]]);this.rotateMix=$EM.rotateMix,this.translateMix=$EM.translateMix,this.scaleMix=$EM.scaleMix,this.shearMix=$EM.shearMix}return $E_($EM,"laya.ani.bone.TfConstraint"),$EM.prototype.apply=function(){for(var $EM,$Ee=this.target.resultMatrix.a,$EL=this.target.resultMatrix.b,$E_=this.target.resultMatrix.c,$Ec=this.target.resultMatrix.d,$Eq=0,$EH=this._bones.length;$Eq<$EH;$Eq++){if($EM=this._bones[$Eq],0<this.rotateMix){var $ET=$EM.resultMatrix.a,$Ex=$EM.resultMatrix.b,$EO=$EM.resultMatrix.c,$Eu=$EM.resultMatrix.d,$EG=Math.atan2($E_,$Ee)-Math.atan2($EO,$ET)+this._data.offsetRotation*Math.PI/180;$EG>Math.PI?$EG-=2*Math.PI:$EG<-Math.PI&&($EG+=2*Math.PI),$EG*=this.rotateMix;var $EV=Math.cos($EG),$EE=Math.sin($EG);$EM.resultMatrix.a=$EV*$ET-$EE*$EO,$EM.resultMatrix.b=$EV*$Ex-$EE*$Eu,$EM.resultMatrix.c=$EE*$ET+$EV*$EO,$EM.resultMatrix.d=$EE*$Ex+$EV*$Eu}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$EM.resultMatrix.tx+=(this._temp[0]-$EM.resultMatrix.tx)*this.translateMix,$EM.resultMatrix.ty+=(this._temp[1]-$EM.resultMatrix.ty)*this.translateMix,$EM.updateChild()),0<this.scaleMix){var $Ed=Math.sqrt($EM.resultMatrix.a*$EM.resultMatrix.a+$EM.resultMatrix.c*$EM.resultMatrix.c),$Er=Math.sqrt($Ee*$Ee+$E_*$E_),$E$=1e-5<$Ed?($Ed+($Er-$Ed+this._data.offsetScaleX)*this.scaleMix)/$Ed:0;$EM.resultMatrix.a*=$E$,$EM.resultMatrix.c*=$E$,$Ed=Math.sqrt($EM.resultMatrix.b*$EM.resultMatrix.b+$EM.resultMatrix.d*$EM.resultMatrix.d),$Er=Math.sqrt($EL*$EL+$Ec*$Ec),$E$=1e-5<$Ed?($Ed+($Er-$Ed+this._data.offsetScaleY)*this.scaleMix)/$Ed:0,$EM.resultMatrix.b*=$E$,$EM.resultMatrix.d*=$E$}if(0<this.shearMix){$Ex=$EM.resultMatrix.b,$Eu=$EM.resultMatrix.d;var $EC=Math.atan2($Eu,$Ex);($EG=Math.atan2($Ec,$EL)-Math.atan2($E_,$Ee)-($EC-Math.atan2($EM.resultMatrix.c,$EM.resultMatrix.a)))>Math.PI?$EG-=2*Math.PI:$EG<-Math.PI&&($EG+=2*Math.PI),$EG=$EC+($EG+this._data.offsetShearY*Math.PI/180)*this.shearMix,$E$=Math.sqrt($Ex*$Ex+$Eu*$Eu),$EM.resultMatrix.b=Math.cos($EG)*$E$,$EM.resultMatrix.d=Math.sin($EG)*$E$}}},$EM}(),$EQM=function(){function $EM(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $E_($EM,"laya.ani.bone.TfConstraintData"),$EM}(),$EYM=function(){function $EM(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$E_($EM,"laya.ani.bone.Transform");var $Ee=$EM.prototype;return $Ee.initData=function($EM){null!=$EM.x&&(this.x=$EM.x),null!=$EM.y&&(this.y=$EM.y),null!=$EM.skX&&(this.skX=$EM.skX),null!=$EM.skY&&(this.skY=$EM.skY),null!=$EM.scX&&(this.scX=$EM.scX),null!=$EM.scY&&(this.scY=$EM.scY)},$Ee.getMatrix=function(){var $EM;return($EM=this.mMatrix?this.mMatrix:this.mMatrix=new $EpM).identity(),$EM.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($EM,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$EM.rotate(this.skX*Math.PI/180),$EM.translate(this.x,this.y),$EM},$Ee.skew=function($EM,$Ee,$EL){var $E_=Math.sin($EL),$Ec=Math.cos($EL),$Eq=Math.sin($Ee),$EH=Math.cos($Ee);return $EM.setTo($EM.a*$EH-$EM.b*$E_,$EM.a*$Eq+$EM.b*$Ec,$EM.c*$EH-$EM.d*$E_,$EM.c*$Eq+$EM.d*$Ec,$EM.tx*$EH-$EM.ty*$E_,$EM.tx*$Eq+$EM.ty*$Ec),$EM},$EM}(),$Ey=function(){function $EM(){}return $E_($EM,"laya.ani.bone.UVTools"),$EM.getRelativeUV=function($EM,$Ee,$EL){var $E_=$EM[0],$Ec=$EM[2]-$EM[0],$Eq=$EM[1],$EH=$EM[5]-$EM[1];$EL||($EL=[]),$EL.length=$Ee.length;var $ET,$Ex=0;$ET=$EL.length;var $EO=1/$Ec,$Eu=1/$EH;for($Ex=0;$Ex<$ET;$Ex+=2)$EL[$Ex]=($Ee[$Ex]-$E_)*$EO,$EL[$Ex+1]=($Ee[$Ex+1]-$Eq)*$Eu;return $EL},$EM.getAbsoluteUV=function($EM,$Ee,$EL){if(0==$EM[0]&&0==$EM[1]&&1==$EM[4]&&1==$EM[5])return $EL?($EC.copyArray($EL,$Ee),$EL):$Ee;var $E_=$EM[0],$Ec=$EM[2]-$EM[0],$Eq=$EM[1],$EH=$EM[5]-$EM[1];$EL||($EL=[]),$EL.length=$Ee.length;var $ET,$Ex=0;for($ET=$EL.length,$Ex=0;$Ex<$ET;$Ex+=2)$EL[$Ex]=$Ee[$Ex]*$Ec+$E_,$EL[$Ex+1]=$Ee[$Ex+1]*$EH+$Eq;return $EL},$EM}(),$Ea=function(){function $EM(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $E_($EM,"laya.ani.KeyFramesContent"),$EM}(),$EA=function(){function $Eu(){}return $E_($Eu,"laya.ani.math.BezierLerp"),$Eu.getBezierRate=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$Eu._getBezierParamKey($Ee,$EL,$E_,$Ec),$EH=100*$Eq+$EM;if($Eu._bezierResultCache[$EH])return $Eu._bezierResultCache[$EH];var $ET,$Ex=$Eu._getBezierPoints($Ee,$EL,$E_,$Ec,$Eq),$EO=0;for($ET=$Ex.length,$EO=0;$EO<$ET;$EO+=2)if($EM<=$Ex[$EO])return $Eu._bezierResultCache[$EH]=$Ex[$EO+1],$Ex[$EO+1];return $Eu._bezierResultCache[$EH]=1},$Eu._getBezierParamKey=function($EM,$Ee,$EL,$E_){return 100*(100*(100*(100*$EM+$Ee)+$EL)+$E_)},$Eu._getBezierPoints=function($EM,$Ee,$EL,$E_,$Ec){return $Eu._bezierPointsCache[$Ec]?$Eu._bezierPointsCache[$Ec]:($Eq=[0,0,$EM,$Ee,$EL,$E_,1,1],$EH=(new $ET).getBezierPoints($Eq,100,3),$Eu._bezierPointsCache[$Ec]=$EH);var $Eq,$EH},$Eu._bezierResultCache={},$Eu._bezierPointsCache={},$Eu}(),$EB=function($EM){function $Ee(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$Ee.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$E_($Ee,"laya.ani.AnimationPlayer",$Ec);var $EL=$Ee.prototype;return $EcM.imps($EL,{"laya.resource.IDestroy":!0}),$EL._onTempletLoadedComputeFullKeyframeIndices=function($EM,$Ee,$EL){this._templet===$EL&&this._cachePlayRate===$EM&&this._cacheFrameRate===$Ee&&this._computeFullKeyframeIndices()},$EL._computeFullKeyframeIndices=function(){for(var $EM=this._fullFrames=[],$Ee=this._templet,$EL=this._cacheFrameRateInterval*this._cachePlayRate,$E_=0,$Ec=$Ee.getAnimationCount();$E_<$Ec;$E_++){for(var $Eq=[],$EH=0,$ET=$Ee.getAnimation($E_).nodes.length;$EH<$ET;$EH++){for(var $Ex=$Ee.getAnimation($E_).nodes[$EH],$EO=Math.floor($Ex.playTime/$EL+.01),$Eu=new Uint16Array($EO+1),$EG=-1,$EV=0,$EE=$Ex.keyFrame.length;$EV<$EE;$EV++){var $Ed=$Ex.keyFrame[$EV],$Er=$Ed.startTime,$E$=$Er+$Ed.duration+$EL;do{for(var $EC=Math.floor($Er/$EL+.5),$EK=$EG+1;$EK<$EC;$EK++)$Eu[$EK]=$EV;$Eu[$EG=$EC]=$EV,$Er+=$EL}while($Er<=$E$)}$Eq.push($Eu)}$EM.push($Eq)}},$EL._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$EL._calculatePlayDuration=function(){if(0!==this.state){var $EM=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$EM),this._playEnd>$EM&&(this._playEnd=$EM),this._playDuration=this._playEnd-this._playStart}},$EL._setPlayParams=function($EM,$Ee){this._currentTime=$EM,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$Ee+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$Ee},$EL._setPlayParamsWhenStop=function($EM,$Ee){this._currentTime=$EM,this._currentKeyframeIndex=Math.max(Math.floor($EM/$Ee+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$Ee,this._currentAnimationClipIndex=-1},$EL._update=function($EM){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $Ee=this._cacheFrameRateInterval*this._cachePlayRate,$EL=0;this._startUpdateLoopCount!==$Ed.loopCount&&($EL=$EM*this.playbackRate,this._elapsedPlaybackTime+=$EL);var $E_=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$E_)return this._setPlayParamsWhenStop($E_,$Ee),void this.event("stopped");if($EL+=this._currentTime,0<$E_)if($E_<=$EL)do{if($EL-=$E_,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($E_,$Ee),this._stopWhenCircleFinish=!1,void this.event("stopped");$EL<$E_&&(this._setPlayParams($EL,$Ee),this.event("complete"))}while($E_<=$EL);else this._setPlayParams($EL,$Ee);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($E_,$Ee),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$EL._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$EL.play=function($EM,$Ee,$EL,$E_,$Ec){if(void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=1),void 0===$EL&&($EL=2147483647),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($EL<0||$E_<0||$Ec<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$Ec&&$Ec<$E_)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$Ee,this._overallDuration=$EL,this._playStart=$E_,this._playEnd=$Ec,this._paused=!1,this._currentAnimationClipIndex=$EM,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$Ed.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$EL.playByFrame=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$EM&&($EM=0),void 0===$Ee&&($Ee=1),void 0===$EL&&($EL=2147483647),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=30);var $EH=1e3/$Eq;this.play($EM,$Ee,$EL,$E_*$EH,$Ec*$EH)},$EL.stop=function($EM){void 0===$EM&&($EM=!0),$EM?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$Eq(0,$EL,"playEnd",function(){return this._playEnd}),$Eq(0,$EL,"templet",function(){return this._templet},function($EM){0===!this.state&&this.stop(!0),this._templet!==$EM&&((this._templet=$EM).loaded?this._computeFullKeyframeIndices():$EM.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$Eq(0,$EL,"playStart",function(){return this._playStart}),$Eq(0,$EL,"playDuration",function(){return this._playDuration}),$Eq(0,$EL,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$Eq(0,$EL,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$Eq(0,$EL,"overallDuration",function(){return this._overallDuration}),$Eq(0,$EL,"currentFrameTime",function(){return this._currentFrameTime}),$Eq(0,$EL,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$Eq(0,$EL,"currentPlayTime",function(){return this._currentTime+this._playStart}),$Eq(0,$EL,"cachePlayRate",function(){return this._cachePlayRate},function($EM){this._cachePlayRate!==$EM&&(this._cachePlayRate=$EM,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$EM,this._cacheFrameRate])))}),$Eq(0,$EL,"cacheFrameRate",function(){return this._cacheFrameRate},function($EM){this._cacheFrameRate!==$EM&&(this._cacheFrameRate=$EM,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$EM])))}),$Eq(0,$EL,"currentTime",null,function($EM){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($EM<this._playStart||$EM>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$Ed.loopCount;var $Ee=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$EM,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$Ee),0),this._currentFrameTime=this._currentKeyframeIndex*$Ee}}),$Eq(0,$EL,"paused",function(){return this._paused},function($EM){(this._paused=$EM)&&this.event("paused")}),$Eq(0,$EL,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$Eq(0,$EL,"destroyed",function(){return this._destroyed}),$Ee}(),$En=function($EM){function $Ee(){$Ee.__super.call(this),$E$.isConchNode&&(this.drawSkin=function($EM){$EM.transform||($EM.transform=$EpM.EMPTY),this._addCmd([$EM]),this.setSkinMesh&&this.setSkinMesh($EM._ps,$EM.mVBData,$EM.mEleNum,0,$EM.mTexture,$EM.transform)})}return $E_($Ee,"laya.ani.GraphicsAni",$EH),$Ee.prototype.drawSkin=function($EM){var $Ee=[$EM];this._saveToCmd($E$._context._drawSkin,$Ee)},$Ee.create=function(){return $Ee._caches.pop()||new $Ee},$Ee.recycle=function($EM){$EM.clear(),$Ee._caches.push($EM)},$Ee._caches=[],$Ee}(),$El=function($EM){function $EK(){this._aniMap={},this.unfixedLastAniIndex=-1,$EK.__super.call(this),this._anis=new Array}$E_($EK,"laya.ani.AnimationTemplet",$Eu);var $Ee=$EK.prototype;return $Ee.parse=function($EM){var $Ee=new $ESM($EM);this._aniVersion=$Ee.readUTFString(),$EX.parse(this,$Ee)},$Ee._calculateKeyFrame=function($EM,$Ee,$EL){var $E_=$EM.keyFrame;$E_[$Ee]=$E_[0];for(var $Ec=0;$Ec<$Ee;$Ec++){var $Eq=$E_[$Ec];$Eq.nextData=0===$Eq.duration?$Eq.data:$E_[$Ec+1].data}$E_.length--},$Ee.onAsynLoaded=function($EM,$Ee,$EL){var $E_=new $ESM($Ee);switch(this._aniVersion=$E_.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$Eo.parse(this,$E_);break;default:$EX.parse(this,$E_)}this._endLoaded()},$Ee.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$Ee.getAnimationCount=function(){return this._anis.length},$Ee.getAnimation=function($EM){return this._anis[$EM]},$Ee.getAniDuration=function($EM){return this._anis[$EM].playTime},$Ee.getNodes=function($EM){return this._anis[$EM].nodes},$Ee.getNodeIndexWithName=function($EM,$Ee){return this._anis[$EM].bone3DMap[$Ee]},$Ee.getNodeCount=function($EM){return this._anis[$EM].nodes.length},$Ee.getTotalkeyframesLength=function($EM){return this._anis[$EM].totalKeyframeDatasLength},$Ee.getPublicExtData=function(){return this._publicExtData},$Ee.getAnimationDataWithCache=function($EM,$Ee,$EL,$E_){var $Ec=$Ee[$EL];if($Ec){var $Eq=$Ec[$EM];return $Eq?$Eq[$E_]:null}return null},$Ee.setAnimationDataWithCache=function($EM,$Ee,$EL,$E_,$Ec){var $Eq=$Ee[$EL]||($Ee[$EL]={});($Eq[$EM]||($Eq[$EM]=[]))[$E_]=$Ec},$Ee.getOriginalData=function($EM,$Ee,$EL,$E_,$Ec){for(var $Eq=this._anis[$EM].nodes,$EH=0,$ET=0,$Ex=$Eq.length,$EO=0;$ET<$Ex;$ET++){var $Eu,$EG=$Eq[$ET];$Eu=$EG.keyFrame[$EL[$ET][$E_]],$EG.dataOffset=$EO;var $EV=$Ec-$Eu.startTime,$EE=$EG.lerpType;if($EE)switch($EE){case 0:case 1:for($EH=0;$EH<$EG.keyframeWidth;)$EH+=$EG.interpolationMethod[$EH]($EG,$EH,$Ee,$EO+$EH,$Eu.data,$EV,null,$Eu.duration,$Eu.nextData);break;case 2:var $Ed=$Eu.interpolationData,$Er=$Ed.length,$E$=0;for($EH=0;$EH<$Er;){var $EC=$Ed[$EH];switch($EC){case 6:case 7:$EH+=$EK.interpolation[$EC]($EG,$E$,$Ee,$EO+$E$,$Eu.data,$EV,null,$Eu.duration,$Eu.nextData,$Ed,$EH+1);break;default:$EH+=$EK.interpolation[$EC]($EG,$E$,$Ee,$EO+$E$,$Eu.data,$EV,null,$Eu.duration,$Eu.nextData)}$E$++}}else for($EH=0;$EH<$EG.keyframeWidth;)$EH+=$EG.interpolationMethod[$EH]($EG,$EH,$Ee,$EO+$EH,$Eu.data,$EV,null,$Eu.duration,$Eu.nextData);$EO+=$EG.keyframeWidth}},$Ee.getNodesCurrentFrameIndex=function($EM,$Ee){var $EL=this._anis[$EM].nodes;$EM!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($EL.length),this.unfixedCurrentTimes=new Float32Array($EL.length),this.unfixedLastAniIndex=$EM);for(var $E_=0,$Ec=$EL.length;$E_<$Ec;$E_++){var $Eq=$EL[$E_];for($Ee<this.unfixedCurrentTimes[$E_]&&(this.unfixedCurrentFrameIndexes[$E_]=0),this.unfixedCurrentTimes[$E_]=$Ee;this.unfixedCurrentFrameIndexes[$E_]<$Eq.keyFrame.length&&!($Eq.keyFrame[this.unfixedCurrentFrameIndexes[$E_]].startTime>this.unfixedCurrentTimes[$E_]);)this.unfixedCurrentFrameIndexes[$E_]++;this.unfixedCurrentFrameIndexes[$E_]--}return this.unfixedCurrentFrameIndexes},$Ee.getOriginalDataUnfixedRate=function($EM,$Ee,$EL){var $E_=this._anis[$EM].nodes;$EM!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($E_.length),this.unfixedCurrentTimes=new Float32Array($E_.length),this.unfixedKeyframes=$Er($E_.length),this.unfixedLastAniIndex=$EM);for(var $Ec=0,$Eq=0,$EH=$E_.length,$ET=0;$Eq<$EH;$Eq++){var $Ex=$E_[$Eq];for($EL<this.unfixedCurrentTimes[$Eq]&&(this.unfixedCurrentFrameIndexes[$Eq]=0),this.unfixedCurrentTimes[$Eq]=$EL;this.unfixedCurrentFrameIndexes[$Eq]<$Ex.keyFrame.length&&!($Ex.keyFrame[this.unfixedCurrentFrameIndexes[$Eq]].startTime>this.unfixedCurrentTimes[$Eq]);)this.unfixedKeyframes[$Eq]=$Ex.keyFrame[this.unfixedCurrentFrameIndexes[$Eq]],this.unfixedCurrentFrameIndexes[$Eq]++;var $EO=this.unfixedKeyframes[$Eq];$Ex.dataOffset=$ET;var $Eu=$EL-$EO.startTime;if($Ex.lerpType)switch($Ex.lerpType){case 0:case 1:for($Ec=0;$Ec<$Ex.keyframeWidth;)$Ec+=$Ex.interpolationMethod[$Ec]($Ex,$Ec,$Ee,$ET+$Ec,$EO.data,$Eu,null,$EO.duration,$EO.nextData);break;case 2:var $EG=$EO.interpolationData,$EV=$EG.length,$EE=0;for($Ec=0;$Ec<$EV;){var $Ed=$EG[$Ec];switch($Ed){case 6:case 7:$Ec+=$EK.interpolation[$Ed]($Ex,$EE,$Ee,$ET+$EE,$EO.data,$Eu,null,$EO.duration,$EO.nextData,$EG,$Ec+1);break;default:$Ec+=$EK.interpolation[$Ed]($Ex,$EE,$Ee,$ET+$EE,$EO.data,$Eu,null,$EO.duration,$EO.nextData)}$EE++}}else for($Ec=0;$Ec<$Ex.keyframeWidth;)$Ec+=$Ex.interpolationMethod[$Ec]($Ex,$Ec,$Ee,$ET+$Ec,$EO.data,$Eu,null,$EO.duration,$EO.nextData);$ET+=$Ex.keyframeWidth}},$EK._LinearInterpolation_0=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){var $Eu=0===$ET?0:$Eq/$ET;return $EL[$E_]=(1-$Eu)*$Ec[$Ee]+$Eu*$Ex[$Ee],1},$EK._QuaternionInterpolation_1=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){var $Eu=0===$ET?0:$Eq/$ET;return $EV.slerpQuaternionArray($Ec,$Ee,$Ex,$Ee,$Eu,$EL,$E_),4},$EK._AngleInterpolation_2=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){return 0},$EK._RadiansInterpolation_3=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){return 0},$EK._Matrix4x4Interpolation_4=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){for(var $Eu=0;$Eu<16;$Eu++,$Ee++)$EL[$E_+$Eu]=$Ec[$Ee]+$Eq*$EH[$Ee];return 16},$EK._NoInterpolation_5=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO){return $EL[$E_]=$Ec[$Ee],1},$EK._BezierInterpolation_6=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu){return void 0===$Eu&&($Eu=0),$EL[$E_]=$Ec[$Ee]+($Ex[$Ee]-$Ec[$Ee])*$EA.getBezierRate($Eq/$ET,$EO[$Eu],$EO[$Eu+1],$EO[$Eu+2],$EO[$Eu+3]),5},$EK._BezierInterpolation_7=function($EM,$Ee,$EL,$E_,$Ec,$Eq,$EH,$ET,$Ex,$EO,$Eu){return void 0===$Eu&&($Eu=0),$EL[$E_]=$EO[$Eu+4]+$EO[$Eu+5]*$EA.getBezierRate((.001*$Eq+$EO[$Eu+6])/$EO[$Eu+7],$EO[$Eu],$EO[$Eu+1],$EO[$Eu+2],$EO[$Eu+3]),9},$EK.load=function($EM){return $EcM.loader.create($EM,null,null,$EK)},$EK.interpolation=[$EK._LinearInterpolation_0,$EK._QuaternionInterpolation_1,$EK._AngleInterpolation_2,$EK._RadiansInterpolation_3,$EK._Matrix4x4Interpolation_4,$EK._NoInterpolation_5,$EK._BezierInterpolation_6,$EK._BezierInterpolation_7],$EK}(),$Ek=function($Ee){function $EL($EM,$Ee){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$EL.__super.call(this),void 0===$Ee&&($Ee=0),$EM&&this.init($EM,$Ee)}$E_($EL,"laya.ani.bone.Skeleton",$Ee);var $EM=$EL.prototype;return $EM.init=function($EM,$Ee){void 0===$Ee&&($Ee=0);var $EL,$E_,$Ec,$Eq=0,$EH=0;if(1==$Ee)for(this._graphicsCache=[],$Eq=0,$EH=$EM.getAnimationCount();$Eq<$EH;$Eq++)this._graphicsCache.push([]);if(this._yReverseMatrix=$EM.yReverseMatrix,this._aniMode=$Ee,this._templet=$EM,this._player=new $EB,this._player.cacheFrameRate=$EM.rate,this._player.templet=$EM,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$EM.mBoneArr,this._rootBone=$EM.mRootBone,this._aniSectionDic=$EM.aniSectionDic,0<$EM.ikArr.length)for(this._ikArr=[],$Eq=0,$EH=$EM.ikArr.length;$Eq<$EH;$Eq++)this._ikArr.push(new $EK($EM.ikArr[$Eq],this._boneList));if(0<$EM.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$Eq=0,$EH=$EM.pathArr.length;$Eq<$EH;$Eq++)$EL=$EM.pathArr[$Eq],$E_=new $Ei($EL,this._boneList),($Ec=this._boneSlotDic[$EL.name])&&(($E_=new $Ei($EL,this._boneList)).target=$Ec),this._pathDic[$EL.name]=$E_;if(0<$EM.tfArr.length)for(this._tfArr=[],$Eq=0,$EH=$EM.tfArr.length;$Eq<$EH;$Eq++)this._tfArr.push(new $EW($EM.tfArr[$Eq],this._boneList));if(0<$EM.skinDataArray.length){var $ET=this._templet.skinDataArray[this._skinIndex];this._skinName=$ET.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$EM.load=function($EM,$Ee,$EL){},$EM._onLoaded=function(){},$EM._parseComplete=function(){var $EM=$Eh.TEMPLET_DICTIONARY[this._aniPath];$EM&&(this.init($EM,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$EM._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$EM._onPlay=function(){this.event("played")},$EM._onStop=function(){var $EM,$Ee=this._templet.eventAniArr[this._aniClipIndex];if($Ee&&this._eventIndex<$Ee.length)for(;this._eventIndex<$Ee.length;this._eventIndex++)($EM=$Ee[this._eventIndex]).time>=this._player.playStart&&$EM.time<=this._player.playEnd&&this.event("label",$EM);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$EM._onPause=function(){this.event("paused")},$EM._parseSrcBoneMatrix=function(){var $EM=0,$Ee=0;for($Ee=this._templet.srcBoneMatrixArr.length,$EM=0;$EM<$Ee;$EM++)this._boneMatrixArray.push(new $EpM);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $EL,$E_,$Ec=this._templet.boneSlotArray;for($EM=0,$Ee=$Ec.length;$EM<$Ee;$EM++)$EL=$Ec[$EM],null==($E_=this._bindBoneBoneSlotDic[$EL.parent])&&(this._bindBoneBoneSlotDic[$EL.parent]=$E_=[]),this._boneSlotDic[$EL.name]=$EL=$EL.copy(),$E_.push($EL),this._boneSlotArray.push($EL)}},$EM._emitMissedEvents=function($EM,$Ee,$EL){void 0===$EL&&($EL=0);var $E_=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($E_){var $Ec,$Eq,$EH=0;for($Ec=$E_.length,$EH=$EL;$EH<$Ec;$EH++)($Eq=$E_[$EH]).time>=this._player.playStart&&$Eq.time<=this._player.playEnd&&this.event("label",$Eq)}},$EM._update=function($EM){if(void 0===$EM&&($EM=!0),!(this._pause||$EM&&this._indexControl)){var $Ee=this.timer.currTimer,$EL=this._player.currentKeyframeIndex,$E_=$Ee-this._lastTime;if($EM?this._player._update($E_):$EL=-1,this._lastTime=$Ee,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$E_&&this._clipIndex==$EL&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $Ec;this._lastUpdateAniClipIndex=this._aniClipIndex,$EL>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $Eq,$EH=this._templet.eventAniArr[this._aniClipIndex];if($EH&&this._eventIndex<$EH.length&&(($Ec=$EH[this._eventIndex]).time>=this._player.playStart&&$Ec.time<=this._player.playEnd?this._player.currentPlayTime>=$Ec.time&&(this.event("label",$Ec),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($Eq=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$Eq&&(this.graphics=$Eq));var $ET=0,$Ex=0;for($Ex=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$Ex-1)&&0<$Ex;)$Ex--;if($Ex<this._clipIndex)for($ET=$Ex;$ET<this._clipIndex;$ET++)this._createGraphics($ET)}else if(1==this._aniMode){if($Eq=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$Eq&&(this.graphics=$Eq));for($Ex=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$Ex-1)&&0<$Ex;)$Ex--;if($Ex<this._clipIndex)for($ET=$Ex;$ET<this._clipIndex;$ET++)this._createGraphics($ET)}this._createGraphics()}}},$EM._createGraphics=function($EM){void 0===$EM&&($EM=-1),-1==$EM&&($EM=this._clipIndex);var $Ee,$EL,$E_=$EM*this._player.cacheFrameRateInterval,$Ec=this._templet.drawOrderAniArr[this._aniClipIndex];if($Ec&&0<$Ec.length)for(this._drawOrderIndex=0,$Ee=$Ec[this._drawOrderIndex];$E_>=$Ee.time&&(this._drawOrder=$Ee.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$Ec.length));)$Ee=$Ec[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$En.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$En.create(),$EL=this.graphics;var $Eq=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$EM,$E_);var $EH,$ET,$Ex,$EO,$Eu=this._aniSectionDic[this._aniClipIndex],$EG=0,$EV=0,$EE=0,$Ed=0,$Er=0,$E$=this._templet.srcBoneMatrixArr.length;for($Er=$Eu[$EV=0];$EV<$E$;$EV++)$EO=this._boneList[$EV],$Ex=this._templet.srcBoneMatrixArr[$EV],$EO.resultTransform.scX=$Ex.scX*this._curOriginalData[$EG++],$EO.resultTransform.skX=$Ex.skX+this._curOriginalData[$EG++],$EO.resultTransform.skY=$Ex.skY+this._curOriginalData[$EG++],$EO.resultTransform.scY=$Ex.scY*this._curOriginalData[$EG++],$EO.resultTransform.x=$Ex.x+this._curOriginalData[$EG++],$EO.resultTransform.y=$Ex.y+this._curOriginalData[$EG++],8===this._templet.tMatrixDataLen&&($EO.resultTransform.skewX=$Ex.skewX+this._curOriginalData[$EG++],$EO.resultTransform.skewY=$Ex.skewY+this._curOriginalData[$EG++]);var $EC,$EK={},$EX={};for($Er+=$Eu[1];$EV<$Er;$EV++)$EK[($EC=$Eq[$EV]).name]=this._curOriginalData[$EG++],$EX[$EC.name]=this._curOriginalData[$EG++],this._curOriginalData[$EG++],this._curOriginalData[$EG++],this._curOriginalData[$EG++],this._curOriginalData[$EG++];var $Eo,$Ei,$EW={},$Ey={};for($Er+=$Eu[2];$EV<$Er;$EV++)$EW[($EC=$Eq[$EV]).name]=this._curOriginalData[$EG++],$Ey[$EC.name]=this._curOriginalData[$EG++],this._curOriginalData[$EG++],this._curOriginalData[$EG++],this._curOriginalData[$EG++],this._curOriginalData[$EG++];if(this._pathDic)for($Er+=$Eu[3];$EV<$Er;$EV++){if($EC=$Eq[$EV],$Eo=this._pathDic[$EC.name])switch(new $ESM($EC.extenData).getByte()){case 1:$Eo.position=this._curOriginalData[$EG++];break;case 2:$Eo.spacing=this._curOriginalData[$EG++];break;case 3:$Eo.rotateMix=this._curOriginalData[$EG++],$Eo.translateMix=this._curOriginalData[$EG++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($EpM.TEMP.identity()),this._ikArr)for($EV=0,$Er=this._ikArr.length;$EV<$Er;$EV++)$Ei=this._ikArr[$EV],$EW.hasOwnProperty($Ei.name)&&($Ei.bendDirection=$EW[$Ei.name]),$Ey.hasOwnProperty($Ei.name)&&($Ei.mix=$Ey[$Ei.name]),$Ei.apply();if(this._pathDic)for(var $EA in this._pathDic)($Eo=this._pathDic[$EA]).apply(this._boneList,$EL);if(this._tfArr)for($EV=0,$Ed=this._tfArr.length;$EV<$Ed;$EV++)this._tfArr[$EV].apply();for($EV=0,$Ed=this._boneList.length;$EV<$Ed;$EV++)if($EO=this._boneList[$EV],$ET=this._bindBoneBoneSlotDic[$EO.name],$EO.resultMatrix.copyTo(this._boneMatrixArray[$EV]),$ET)for($EE=0,$Er=$ET.length;$EE<$Er;$EE++)($EH=$ET[$EE])&&$EH.setParentMatrix($EO.resultMatrix);var $EB,$Ek,$Eh,$Et,$ES={},$Ep=this._templet.deformAniArr;if($Ep&&0<$Ep.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$EV=0,$Er=this._boneSlotArray.length;$EV<$Er;$EV++)($EH=this._boneSlotArray[$EV]).deformData=null;var $ER,$Ea=$Ep[this._aniClipIndex];for($ER in $EB=$Ea.default,this._setDeform($EB,$ES,this._boneSlotArray,$E_),$Ea)"default"!=$ER&&$ER!=this._skinName&&($EB=$Ea[$ER],this._setDeform($EB,$ES,this._boneSlotArray,$E_));$EB=$Ea[this._skinName],this._setDeform($EB,$ES,this._boneSlotArray,$E_)}if(this._drawOrder)for($EV=0,$Er=this._drawOrder.length;$EV<$Er;$EV++)$Ek=$EK[($EH=this._boneSlotArray[this._drawOrder[$EV]]).name],$Eh=$EX[$EH.name],isNaN($Eh)||($EL.save(),$EL.alpha($Eh)),isNaN($Ek)||-2==$Ek||(this._templet.attachmentNames?$EH.showDisplayByName(this._templet.attachmentNames[$Ek]):$EH.showDisplayByIndex($Ek)),$ES[this._drawOrder[$EV]]?($Et=$ES[this._drawOrder[$EV]],$EH.currDisplayData&&$Et[$EH.currDisplayData.attachmentName]?$EH.deformData=$Et[$EH.currDisplayData.attachmentName]:$EH.deformData=null):$EH.deformData=null,isNaN($Eh)?$EH.draw($EL,this._boneMatrixArray,2==this._aniMode):$EH.draw($EL,this._boneMatrixArray,2==this._aniMode,$Eh),isNaN($Eh)||$EL.restore();else for($EV=0,$Er=this._boneSlotArray.length;$EV<$Er;$EV++)$Ek=$EK[($EH=this._boneSlotArray[$EV]).name],$Eh=$EX[$EH.name],isNaN($Eh)||($EL.save(),$EL.alpha($Eh)),isNaN($Ek)||-2==$Ek||(this._templet.attachmentNames?$EH.showDisplayByName(this._templet.attachmentNames[$Ek]):$EH.showDisplayByIndex($Ek)),$ES[$EV]?($Et=$ES[$EV],$EH.currDisplayData&&$Et[$EH.currDisplayData.attachmentName]?$EH.deformData=$Et[$EH.currDisplayData.attachmentName]:$EH.deformData=null):$EH.deformData=null,isNaN($Eh)?$EH.draw($EL,this._boneMatrixArray,2==this._aniMode):$EH.draw($EL,this._boneMatrixArray,2==this._aniMode,$Eh),isNaN($Eh)||$EL.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$EM,$EL):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$EM,$EL)},$EM._setDeform=function($EM,$Ee,$EL,$E_){if($EM){var $Ec,$Eq,$EH,$ET=0,$Ex=0,$EO=0;if($EM)for($ET=0,$Ex=$EM.deformSlotDataList.length;$ET<$Ex;$ET++)for($Ec=$EM.deformSlotDataList[$ET],$EO=0;$EO<$Ec.deformSlotDisplayList.length;$EO++)$EH=$EL[($Eq=$Ec.deformSlotDisplayList[$EO]).slotIndex],$Eq.apply($E_,$EH),$Ee[$Eq.slotIndex]||($Ee[$Eq.slotIndex]={}),$Ee[$Eq.slotIndex][$Eq.attachment]=$Eq.deformData}},$EM.getAnimNum=function(){return this._templet.getAnimationCount()},$EM.getAniNameByIndex=function($EM){return this._templet.getAniNameByIndex($EM)},$EM.getSlotByName=function($EM){return this._boneSlotDic[$EM]},$EM.showSkinByName=function($EM,$Ee){void 0===$Ee&&($Ee=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($EM),$Ee)},$EM.showSkinByIndex=function($EM,$Ee){void 0===$Ee&&($Ee=!0);for(var $EL=0;$EL<this._boneSlotArray.length;$EL++)this._boneSlotArray[$EL].showSlotData(null,$Ee);if(this._templet.showSkinByIndex(this._boneSlotDic,$EM,$Ee)){var $E_=this._templet.skinDataArray[$EM];this._skinIndex=$EM,this._skinName=$E_.name}this._clearCache()},$EM.showSlotSkinByIndex=function($EM,$Ee){if(0!=this._aniMode){var $EL=this.getSlotByName($EM);$EL&&$EL.showDisplayByIndex($Ee),this._clearCache()}},$EM.showSlotSkinByName=function($EM,$Ee){if(0!=this._aniMode){var $EL=this.getSlotByName($EM);$EL&&$EL.showDisplayByName($Ee),this._clearCache()}},$EM.replaceSlotSkinName=function($EM,$Ee,$EL){if(0!=this._aniMode){var $E_=this.getSlotByName($EM);$E_&&$E_.replaceDisplayByName($Ee,$EL),this._clearCache()}},$EM.replaceSlotSkinByIndex=function($EM,$Ee,$EL){if(0!=this._aniMode){var $E_=this.getSlotByName($EM);$E_&&$E_.replaceDisplayByIndex($Ee,$EL),this._clearCache()}},$EM.setSlotSkin=function($EM,$Ee){if(0!=this._aniMode){var $EL=this.getSlotByName($EM);$EL&&$EL.replaceSkin($Ee),this._clearCache()}},$EM._clearCache=function(){if(1==this._aniMode)for(var $EM=0,$Ee=this._graphicsCache.length;$EM<$Ee;$EM++){for(var $EL=0,$E_=this._graphicsCache[$EM].length;$EL<$E_;$EL++){var $Ec=this._graphicsCache[$EM][$EL];$Ec!=this.graphics&&$En.recycle($Ec)}this._graphicsCache[$EM].length=0}},$EM.play=function($EM,$Ee,$EL,$E_,$Ec,$Eq){void 0===$EL&&($EL=!0),void 0===$E_&&($E_=0),void 0===$Ec&&($Ec=0),void 0===$Eq&&($Eq=!0),this._indexControl=!1;var $EH=-1,$ET=NaN;if($ET=$Ee?2147483647:0,"string"==typeof $EM)for(var $Ex=0,$EO=this._templet.getAnimationCount();$Ex<$EO;$Ex++){var $Eu=this._templet.getAnimation($Ex);if($Eu&&$EM==$Eu.name){$EH=$Ex;break}}else $EH=$EM;-1<$EH&&$EH<this.getAnimNum()&&(this._aniClipIndex=$EH,($EL||this._pause||this._currAniIndex!=$EH)&&(this._currAniIndex=$EH,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($EH)),this._drawOrder=null,this._eventIndex=0,this._player.play($EH,this._player.playbackRate,$ET,$E_,$Ec),$Eq&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$EG.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$EM.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$EM.playbackRate=function($EM){this._player&&(this._player.playbackRate=$EM)},$EM.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$EM.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$EG.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$EM._getGrahicsDataWithCache=function($EM,$Ee){return this._graphicsCache[$EM][$Ee]},$EM._setGrahicsDataWithCache=function($EM,$Ee,$EL){this._graphicsCache[$EM][$Ee]=$EL},$EM.destroy=function($EM){void 0===$EM&&($EM=!0),$Ee.prototype.destroy.call(this,$EM),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$Eq(0,$EM,"url",function(){return this._aniPath},function($EM){this.load($EM)}),$Eq(0,$EM,"index",function(){return this._index},function($EM){this.player&&(this._index=$EM,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$Eq(0,$EM,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$Eq(0,$EM,"templet",function(){return this._templet}),$Eq(0,$EM,"player",function(){return this._player}),$EL.useSimpleMeshInCanvas=!1,$EL}($EqM),$Eh=function($Ee){function $Ec(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$Ec.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$E_($Ec,"laya.ani.bone.Templet",$Ee);var $EM=$Ec.prototype;return $EM.getLoadList=function(){return this._loadList},$EM.loadAni=function($EM){this._skBufferUrl=$EM,$EcM.loader.load($EM,$Ex.create(this,this.onComplete),null,"arraybuffer")},$EM.onComplete=function($EM){if(this._isDestroyed)this.destroy();else{var $Ee=$EO.getRes(this._skBufferUrl);$Ee?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$Ee)):this.event("error","load failed:"+this._skBufferUrl)}},$EM.parseData=function($EM,$Ee,$EL){void 0===$EL&&($EL=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$EM,this._mainTexture&&$E$.isWebGL&&$EM.bitmap&&($EM.bitmap.enableMerageInAtlas=!1),this._rate=$EL,this.parse($Ee)},$EM.buildArmature=function($EM){return void 0===$EM&&($EM=0),new $Ek(this,$EM)},$EM.parse=function($EM){$Ee.prototype.parse.call(this,$EM),this._endLoaded(),this._aniVersion!=$Ec.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$Ec.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$EM._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $EM=0;this._loadList=[];var $Ee,$EL=new $ESM(this.getPublicExtData()),$E_=0,$Ec=0,$Eq=0,$EH=$EL.getInt32(),$ET=$EL.readUTFString(),$Ex=$ET.split("\n");for($EM=0;$EM<$EH;$EM++)$Ee=this._path+$Ex[2*$EM],$ET=$Ex[2*$EM+1],$EL.getFloat32(),$EL.getFloat32(),$E_=$EL.getFloat32(),$Ec=$EL.getFloat32(),$Eq=$EL.getFloat32(),isNaN($Eq)?0:$Eq,$Eq=$EL.getFloat32(),isNaN($Eq)?0:$Eq,$Eq=$EL.getFloat32(),isNaN($Eq)?$E_:$Eq,$Eq=$EL.getFloat32(),isNaN($Eq)?$Ec:$Eq,-1==this._loadList.indexOf($Ee)&&this._loadList.push($Ee);this.event("inited",this)}},$EM._textureComplete=function(){for(var $EM,$Ee,$EL=0,$E_=this._loadList.length;$EL<$E_;$EL++)$Ee=this._loadList[$EL],$EM=this._textureDic[$Ee]=$EO.getRes($Ee),$E$.isWebGL&&$EM&&$EM.bitmap&&($EM.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$EM._parsePublicExtData=function(){var $EM=0,$Ee=0,$EL=0,$E_=0,$Ec=0;for($EM=0,$Ec=this.getAnimationCount();$EM<$Ec;$EM++)this._graphicsCache.push([]);var $Eq;$Eq="Dragon"!=this._aniClassName;var $EH,$ET,$Ex=new $ESM(this.getPublicExtData()),$EO=0,$Eu=0,$EG=0,$EV=0,$EE=0,$Ed=0,$Er=0,$E$=0,$EC=0,$EK=$Ex.getInt32(),$EX=$Ex.readUTFString(),$Eo=$EX.split("\n");for($EM=0;$EM<$EK;$EM++){if($EH=this._mainTexture,$ET=this._path+$Eo[2*$EM],$EX=$Eo[2*$EM+1],null==this._mainTexture&&($EH=this._textureDic[$ET]),!$EH)return this.event("error",this),void(this.isParseFail=!0);$EO=$Ex.getFloat32(),$Eu=$Ex.getFloat32(),$EG=$Ex.getFloat32(),$EV=$Ex.getFloat32(),$EC=$Ex.getFloat32(),$EE=isNaN($EC)?0:$EC,$EC=$Ex.getFloat32(),$Ed=isNaN($EC)?0:$EC,$EC=$Ex.getFloat32(),$Er=isNaN($EC)?$EG:$EC,$EC=$Ex.getFloat32(),$E$=isNaN($EC)?$EV:$EC,this.subTextureDic[$EX]=$ERM.create($EH,$EO,$Eu,$EG,$EV,-$EE,-$Ed,$Er,$E$),$EH.alphaTexture&&(this.subTextureDic[$EX].alphaTexture=$ERM.create($EH.alphaTexture,$EO,$Eu,$EG,$EV,-$EE,-$Ed,$Er,$E$))}this._mainTexture=$EH;var $Ei,$EW,$Ey,$EA,$EB,$Ek=$Ex.getUint16();for($EM=0;$EM<$Ek;$EM++)($Ei=[]).push($Ex.getUint16()),$Ei.push($Ex.getUint16()),$Ei.push($Ex.getUint16()),$Ei.push($Ex.getUint16()),this.aniSectionDic[$EM]=$Ei;var $Eh,$Et=$Ex.getInt16(),$ES={};for($EM=0;$EM<$Et;$EM++)$EW=new $EaM,0==$EM?$Eh=$EW:$EW.root=$Eh,$EW.d=$Eq?-1:1,$EA=$Ex.readUTFString(),$EB=$Ex.readUTFString(),$EW.length=$Ex.getFloat32(),1==$Ex.getByte()&&($EW.inheritRotation=!1),1==$Ex.getByte()&&($EW.inheritScale=!1),$EW.name=$EA,$EB&&(($Ey=$ES[$EB])?$Ey.addChild($EW):this.mRootBone=$EW),$ES[$EA]=$EW,this.mBoneArr.push($EW);this.tMatrixDataLen=$Ex.getUint16();var $Ep,$ER,$Ea=$Ex.getUint16(),$En=Math.floor($Ea/this.tMatrixDataLen),$El=this.srcBoneMatrixArr;for($EM=0;$EM<$En;$EM++)($Ep=new $EYM).scX=$Ex.getFloat32(),$Ep.skX=$Ex.getFloat32(),$Ep.skY=$Ex.getFloat32(),$Ep.scY=$Ex.getFloat32(),$Ep.x=$Ex.getFloat32(),$Ep.y=$Ex.getFloat32(),8===this.tMatrixDataLen&&($Ep.skewX=$Ex.getFloat32(),$Ep.skewY=$Ex.getFloat32()),$El.push($Ep),($EW=this.mBoneArr[$EM]).transform=$Ep;var $Ef,$Ej=$Ex.getUint16(),$EF=0;for($EM=0;$EM<$Ej;$EM++){for($ER=new $EJM,$EF=$Ex.getUint16(),$Ee=0;$Ee<$EF;$Ee++)$ER.boneNames.push($Ex.readUTFString()),$ER.boneIndexs.push($Ex.getInt16());$ER.name=$Ex.readUTFString(),$ER.targetBoneName=$Ex.readUTFString(),$ER.targetBoneIndex=$Ex.getInt16(),$ER.bendDirection=$Ex.getFloat32(),$ER.mix=$Ex.getFloat32(),$ER.isSpine=$Eq,this.ikArr.push($ER)}var $Eg,$EJ=$Ex.getUint16(),$Ew=0;for($EM=0;$EM<$EJ;$EM++){for($Ef=new $EQM,$Ew=$Ex.getUint16(),$Ee=0;$Ee<$Ew;$Ee++)$Ef.boneIndexs.push($Ex.getInt16());$Ef.name=$Ex.getUTFString(),$Ef.targetIndex=$Ex.getInt16(),$Ef.rotateMix=$Ex.getFloat32(),$Ef.translateMix=$Ex.getFloat32(),$Ef.scaleMix=$Ex.getFloat32(),$Ef.shearMix=$Ex.getFloat32(),$Ef.offsetRotation=$Ex.getFloat32(),$Ef.offsetX=$Ex.getFloat32(),$Ef.offsetY=$Ex.getFloat32(),$Ef.offsetScaleX=$Ex.getFloat32(),$Ef.offsetScaleY=$Ex.getFloat32(),$Ef.offsetShearY=$Ex.getFloat32(),this.tfArr.push($Ef)}var $Eb=$Ex.getUint16(),$Em=0;for($EM=0;$EM<$Eb;$EM++){for(($Eg=new $EwM).name=$Ex.readUTFString(),$Em=$Ex.getUint16(),$Ee=0;$Ee<$Em;$Ee++)$Eg.bones.push($Ex.getInt16());$Eg.target=$Ex.readUTFString(),$Eg.positionMode=$Ex.readUTFString(),$Eg.spacingMode=$Ex.readUTFString(),$Eg.rotateMode=$Ex.readUTFString(),$Eg.offsetRotation=$Ex.getFloat32(),$Eg.position=$Ex.getFloat32(),$Eg.spacing=$Ex.getFloat32(),$Eg.rotateMix=$Ex.getFloat32(),$Eg.translateMix=$Ex.getFloat32(),this.pathArr.push($Eg)}var $Ez,$EQ,$EY,$EP,$EZ,$Ev=0,$EN=0,$Es=0,$ED=NaN,$EU=0,$EI=$Ex.getInt16();for($EM=0;$EM<$EI;$EM++){var $EMM=$Ex.getUint8(),$EeM={};this.deformAniArr.push($EeM);for(var $ELM=0;$ELM<$EMM;$ELM++)for(($Ez=new $ElM).skinName=$Ex.getUTFString(),$EeM[$Ez.skinName]=$Ez,$Ev=$Ex.getInt16(),$Ee=0;$Ee<$Ev;$Ee++)for($EQ=new $EfM,$Ez.deformSlotDataList.push($EQ),$EN=$Ex.getInt16(),$EL=0;$EL<$EN;$EL++)for($EY=new $EjM,$EQ.deformSlotDisplayList.push($EY),$EY.slotIndex=$Ex.getInt16(),$EY.attachment=$Ex.getUTFString(),$Es=$Ex.getInt16(),$E_=0;$E_<$Es;$E_++)for(1==$Ex.getByte()?$EY.tweenKeyList.push(!0):$EY.tweenKeyList.push(!1),$ED=$Ex.getFloat32(),$EY.timeList.push($ED),$EP=[],$EY.vectices.push($EP),$EU=$Ex.getInt16(),$Ec=0;$Ec<$EU;$Ec++)$EP.push($Ex.getFloat32())}var $E_M,$EcM,$EqM=$Ex.getInt16(),$EHM=0,$ETM=0;for($EM=0;$EM<$EqM;$EM++){for($EHM=$Ex.getInt16(),$EZ=[],$Ee=0;$Ee<$EHM;$Ee++){for(($E_M=new $EFM).time=$Ex.getFloat32(),$ETM=$Ex.getInt16(),$EL=0;$EL<$ETM;$EL++)$E_M.drawOrder.push($Ex.getInt16());$EZ.push($E_M)}this.drawOrderAniArr.push($EZ)}var $ExM,$EOM=$Ex.getInt16(),$EuM=0;for($EM=0;$EM<$EOM;$EM++){for($EuM=$Ex.getInt16(),$EcM=[],$Ee=0;$Ee<$EuM;$Ee++)($ExM=new $EgM).name=$Ex.getUTFString(),$ExM.intValue=$Ex.getInt32(),$ExM.floatValue=$Ex.getFloat32(),$ExM.stringValue=$Ex.getUTFString(),$ExM.time=$Ex.getFloat32(),$EcM.push($ExM);this.eventAniArr.push($EcM)}var $EGM=$Ex.getInt16();if(0<$EGM)for(this.attachmentNames=[],$EM=0;$EM<$EGM;$EM++)this.attachmentNames.push($Ex.getUTFString());var $EVM,$EEM,$EdM=$Ex.getInt16();for($EM=0;$EM<$EdM;$EM++)($EVM=new $EnM).name=$Ex.readUTFString(),$EVM.parent=$Ex.readUTFString(),$EVM.attachmentName=$Ex.readUTFString(),$EVM.srcDisplayIndex=$EVM.displayIndex=$Ex.getInt16(),($EVM.templet=this).boneSlotDic[$EVM.name]=$EVM,null==($EEM=this.bindBoneBoneSlotDic[$EVM.parent])&&(this.bindBoneBoneSlotDic[$EVM.parent]=$EEM=[]),$EEM.push($EVM),this.boneSlotArray.push($EVM);var $ErM,$E$M,$ECM,$EKM=$Ex.readUTFString().split("\n"),$EXM=0,$EoM=$Ex.getUint8(),$EiM=0,$EWM=0,$EyM=0,$EAM=0,$EBM=0,$EkM=0,$EhM=0;for($EM=0;$EM<$EoM;$EM++){for(($ErM=new $EbM).name=$EKM[$EXM++],$EiM=$Ex.getUint8(),$Ee=0;$Ee<$EiM;$Ee++){for(($E$M=new $EzM).name=$EKM[$EXM++],$EVM=this.boneSlotDic[$E$M.name],$EWM=$Ex.getUint8(),$EL=0;$EL<$EWM;$EL++){if($ECM=new $EmM,this.skinSlotDisplayDataArr.push($ECM),$ECM.name=$EKM[$EXM++],$ECM.attachmentName=$EKM[$EXM++],$ECM.transform=new $EYM,$ECM.transform.scX=$Ex.getFloat32(),$ECM.transform.skX=$Ex.getFloat32(),$ECM.transform.skY=$Ex.getFloat32(),$ECM.transform.scY=$Ex.getFloat32(),$ECM.transform.x=$Ex.getFloat32(),$ECM.transform.y=$Ex.getFloat32(),$E$M.displayArr.push($ECM),$ECM.width=$Ex.getFloat32(),$ECM.height=$Ex.getFloat32(),$ECM.type=$Ex.getUint8(),$ECM.verLen=$Ex.getUint16(),0<($Et=$Ex.getUint16()))for($ECM.bones=[],$E_=0;$E_<$Et;$E_++){var $EtM=$Ex.getUint16();$ECM.bones.push($EtM)}if(0<($EyM=$Ex.getUint16()))for($ECM.uvs=[],$E_=0;$E_<$EyM;$E_++)$ECM.uvs.push($Ex.getFloat32());if(0<($EAM=$Ex.getUint16()))for($ECM.weights=[],$E_=0;$E_<$EAM;$E_++)$ECM.weights.push($Ex.getFloat32());if(0<($EBM=$Ex.getUint16()))for($ECM.triangles=[],$E_=0;$E_<$EBM;$E_++)$ECM.triangles.push($Ex.getUint16());if(0<($EkM=$Ex.getUint16()))for($ECM.vertices=[],$E_=0;$E_<$EkM;$E_++)$ECM.vertices.push($Ex.getFloat32());if(0<($EhM=$Ex.getUint16()))for($ECM.lengths=[],$E_=0;$E_<$EhM;$E_++)$ECM.lengths.push($Ex.getFloat32())}$ErM.slotArr.push($E$M)}this.skinDic[$ErM.name]=$ErM,this.skinDataArray.push($ErM)}1==$Ex.getUint8()?(this.yReverseMatrix=new $EpM(1,0,0,-1,0,0),$Eh&&$Eh.setTempMatrix(this.yReverseMatrix)):$Eh&&$Eh.setTempMatrix(new $EpM),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$EM.getTexture=function($EM){var $Ee=this.subTextureDic[$EM];return $Ee||($Ee=this.subTextureDic[$EM.substr(0,$EM.length-1)]),null==$Ee?this._mainTexture:$Ee},$EM.showSkinByIndex=function($EM,$Ee,$EL){if(void 0===$EL&&($EL=!0),$Ee<0&&$Ee>=this.skinDataArray.length)return!1;var $E_,$Ec,$Eq=0,$EH=0,$ET=this.skinDataArray[$Ee];if($ET){for($Eq=0,$EH=$ET.slotArr.length;$Eq<$EH;$Eq++)($Ec=$ET.slotArr[$Eq])&&($E_=$EM[$Ec.name])&&($E_.showSlotData($Ec,$EL),$EL&&"undefined"!=$E_.attachmentName&&"null"!=$E_.attachmentName?$E_.showDisplayByName($E_.attachmentName):$E_.showDisplayByIndex($E_.displayIndex));return!0}return!1},$EM.getSkinIndexByName=function($EM){for(var $Ee=0,$EL=this.skinDataArray.length;$Ee<$EL;$Ee++)if(this.skinDataArray[$Ee].name==$EM)return $Ee;return-1},$EM.getGrahicsDataWithCache=function($EM,$Ee){return this._graphicsCache[$EM][$Ee]},$EM.setGrahicsDataWithCache=function($EM,$Ee,$EL){this._graphicsCache[$EM][$Ee]=$EL},$EM.destroy=function(){var $EM;for(var $Ee in this._isDestroyed=!0,this.subTextureDic)($EM=this.subTextureDic[$Ee])&&$EM.destroy();for($Ee in this._textureDic)($EM=this._textureDic[$Ee])&&$EM.destroy();for(var $EL=0,$E_=this.skinSlotDisplayDataArr.length;$EL<$E_;$EL++)this.skinSlotDisplayDataArr[$EL].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $Ec.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$EM.getAniNameByIndex=function($EM){var $Ee=this.getAnimation($EM);return $Ee?$Ee.name:null},$Eq(0,$EM,"rate",function(){return this._rate},function($EM){this._rate=$EM}),$Ec.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$Ec.TEMPLET_DICTIONARY=null,$Ec}($El)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($EM,$Ee){"use strict";for(var $EL in Object.defineProperty($Ee,"__esModule",{value:!0}),Laya){var $E_=Laya[$EL];$E_&&$E_.__isclass&&($Ee[$EL]=$E_)}});