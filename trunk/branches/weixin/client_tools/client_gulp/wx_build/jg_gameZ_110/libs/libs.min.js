var Laya=window.Laya=function($i,$x){var $F={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($x,$I){return 1==arguments.length?$F.__presubstr.call(this,$x):$F.__presubstr.call(this,$x,0<$I?$I:this.length+$I)},__init:function($x){$x.forEach(function($x){$x.__init$&&$x.__init$()})},__isClass:function($x){return $x&&($x.__isclass||$x==Object||$x==String||$x==Array)},__newvec:function($x,$I){var $z=[];$z.length=$x;for(var $k=0;$k<$x;$k++)$z[$k]=$I;return $z},__extend:function($x,$I){for(var $z in $I)if($I.hasOwnProperty($z)){var $k=Object.getOwnPropertyDescriptor($I,$z),$l=$k.get,$n=$k.set;$l||$n?$l&&$n?Object.defineProperty($x,$z,$k):($l&&Object.defineProperty($x,$z,$l),$n&&Object.defineProperty($x,$z,$n)):$x[$z]=$I[$z]}function $a(){$F.un(this,"constructor",$x)}$a.prototype=$I.prototype,$x.prototype=new $a,$F.un($x.prototype,"__imps",$F.__copy({},$I.prototype.__imps))},__copy:function($x,$I){if(!$I)return null;for(var $z in $x=$x||{},$I)$x[$z]=$I[$z];return $x},__package:function($x,$I){if(!$F.__packages[$x]){$F.__packages[$x]=!0;var $z=$i,$k=$x.split(".");if(1<$k.length)for(var $l=0,$n=$k.length-1;$l<$n;$l++){var $a=$z[$k[$l]];$z=$a||($z[$k[$l]]={})}$z[$k[$k.length-1]]||($z[$k[$k.length-1]]=$I||{})}},__hasOwnProperty:function($x,$I){return $I=$I||this,Object.hasOwnProperty.call($I,$x)||function $x($I,$z){if(Object.hasOwnProperty.call($z.prototype,$I))return!0;var $k=$z.prototype.__super;return null==$k?null:$x($I,$k)}($x,$I.__class)},__typeof:function($x,$I){if(!$x||!$I)return!1;if($I===String)return"string"==typeof $x;if($I===Number)return"number"==typeof $x;if($I.__interface__)$I=$I.__interface__;else if("string"!=typeof $I)return $x instanceof $I;return $x.__imps&&$x.__imps[$I]||$x.__class==$I},__as:function($x,$I){return this.__typeof($x,$I)?$x:null},__int:function($x){return $x?parseInt($x):0},interface:function($x,$I){$F.__package($x,{});var $z=$F.__internals,$k=$z[$x]=$z[$x]||{self:$x};if($I){var $l=$I.split(",");$k.extend=[];for(var $n=0;$n<$l.length;$n++){var $a=$l[$n];$z[$a]=$z[$a]||{self:$a},$k.extend.push($z[$a])}}var $$=$i,$w=$x.split(".");for($n=0;$n<$w.length-1;$n++)$$=$$[$w[$n]];$$[$w[$w.length-1]]={__interface__:$x}},class:function($x,$I,$z,$k){if($z&&$F.__extend($x,$z),$I)if($F.__package($I,$x),$F.__classmap[$I]=$x,0<$I.indexOf(".")){if(0==$I.indexOf("laya.")){var $l=$I.split(".");$k=$k||$l[$l.length-1],$F[$k]&&console.log("Warning!,this class["+$k+"] already exist:",$F[$k]),$F[$k]=$x}}else"Main"==$I?$i.Main=$x:"MainWX"==$I?$i.MainWX=$x:($F[$I]&&console.log("Error!,this class["+$I+"] already exist:",$F[$I]),$F[$I]=$x);var $n=$F.un,$a=$x.prototype;$n($a,"hasOwnProperty",$F.__hasOwnProperty),$n($a,"__class",$x),$n($a,"__super",$z),$n($a,"__className",$I),$n($x,"__super",$z),$n($x,"__className",$I),$n($x,"__isclass",!0),$n($x,"super",function($x){this.__super.call($x)})},imps:function($x,$I){if(!$I)return null;var $l=$x.__imps||$F.un($x,"__imps",{});function $n($x){var $I,$z;if(($I=$F.__internals[$x])&&($l[$x]=!0,$z=$I.extend))for(var $k=0;$k<$z.length;$k++)$n($z[$k].self)}for(var $z in $I)$n($z)},superSet:function($x,$I,$z,$k){var $l=$x.prototype["_$set_"+$z];$l&&$l.call($I,$k)},superGet:function($x,$I,$z){var $k=$x.prototype["_$get_"+$z];return $k?$k.call($I):null},getset:function($x,$I,$z,$k,$l){$x?($k&&($I["_$GET_"+$z]=$k),$l&&($I["_$SET_"+$z]=$l)):($k&&$F.un($I,"_$get_"+$z,$k),$l&&$F.un($I,"_$set_"+$z,$l)),$k&&$l?Object.defineProperty($I,$z,{get:$k,set:$l,enumerable:!1,configurable:!0}):($k&&Object.defineProperty($I,$z,{get:$k,enumerable:!1,configurable:!0}),$l&&Object.defineProperty($I,$z,{set:$l,enumerable:!1,configurable:!0}))},static:function($z,$k){for(var $l=0,$x=$k.length;$l<$x;$l+=2)if("length"==$k[$l])$z.length=$k[$l+1].call($z);else{function $I(){var $I=$k[$l],$x=$k[$l+1];Object.defineProperty($z,$I,{get:function(){return delete this[$I],this[$I]=$x.call(this)},set:function($x){delete this[$I],this[$I]=$x},enumerable:!0,configurable:!0})}$I()}},un:function($x,$I,$z){return $z||($z=$x[$I]),$F.__propun.value=$z,Object.defineProperty($x,$I,$F.__propun),$z},uns:function($I,$x){$x.forEach(function($x){$F.un($I,$x)})}};return $i.console=$i.console||{log:function(){}},$i.trace=$i.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$F}(window,document);!function($x,$I,$z){$z.un,$z.uns,$z.static,$z.class,$z.getset,$z.__newvec}(window,document,Laya),function($_,$I,$v){$v.un,$v.uns;var $w=$v.static,$N=$v.class,$F=$v.getset;$v.__newvec;$v.interface("laya.runtime.IMarket"),$v.interface("laya.filters.IFilter"),$v.interface("laya.display.ILayout"),$v.interface("laya.resource.IDispose"),$v.interface("laya.runtime.IPlatform"),$v.interface("laya.resource.IDestroy"),$v.interface("laya.runtime.IConchNode"),$v.interface("laya.filters.IFilterAction"),$v.interface("laya.runtime.ICPlatformClass"),$v.interface("laya.resource.ICreateResource"),$v.interface("laya.runtime.IConchRenderObject"),$v.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $Z=function(){function $n(){}return $N($n,"laya.utils.RunDriver"),$n.FILTER_ACTIONS=[],$n.pixelRatio=-1,$n._charSizeTestDiv=null,$n.now=function(){return Date.now()},$n.getWindow=function(){return $_},$n.getPixelRatio=function(){if($n.pixelRatio<0){var $x=$W.context,$I=$x.backingStorePixelRatio||$x.webkitBackingStorePixelRatio||$x.mozBackingStorePixelRatio||$x.msBackingStorePixelRatio||$x.oBackingStorePixelRatio||$x.backingStorePixelRatio||1;($n.pixelRatio=($W.window.devicePixelRatio||1)/$I)<1&&($n.pixelRatio=1)}return $n.pixelRatio},$n.getIncludeStr=function($x){return null},$n.createShaderCondition=function($x){var $I="(function() {return "+$x+";})";return $v._runScript($I)},$n.fontMap=[],$n.measureText=function($x,$I){var $z=$n.hanzi.test($x);if($z&&$n.fontMap[$I])return $n.fontMap[$I];var $k=$W.context;$k.font=$I;var $l=$k.measureText($x);return $l||($l={width:16,height:16}),$z&&($n.fontMap[$I]=$l),$l},$n.getWebGLContext=function($x){},$n.beginFlush=function(){},$n.endFinish=function(){},$n.addToAtlas=null,$n.flashFlushImage=function($x){},$n.drawToCanvas=function($x,$I,$z,$k,$l,$n){var $a=$mx.create("2D"),$$=new $t($z,$k,$a);return $Y.renders[$I]._fun($x,$$,$l,$n),$a},$n.createParticleTemplate2D=null,$n.createGLTextur=null,$n.createWebGLContext2D=null,$n.changeWebGLSize=function($x,$I){},$n.createRenderSprite=function($x,$I){return new $Y($x,$I)},$n.createFilterAction=function($x){return new $a},$n.createGraphics=function(){return new $T},$n.clear=function($x){$j._context.ctx.clear()},$n.cancelLoadByUrl=function($x){},$n.clearAtlas=function($x){},$n.isAtlas=function($x){return!1},$n.addTextureToAtlas=function($x){},$n.getTexturePixels=function($x,$I,$z,$k,$l){return null},$n.skinAniSprite=function(){return null},$n.update3DLoop=function(){},$w($n,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$n}(),$k=($F(1,$v,"alertGlobalError",null,function($x){var $n=0;$W.window.onerror=$x?function($x,$I,$z,$k,$l){$n++<5&&$l&&alert($l.stack||$l)}:null}),$v.init=function($x,$I,$z){for(var $k=[],$l=2,$n=arguments.length;$l<$n;$l++)$k.push(arguments[$l]);if(!$v._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$v._arrayBufferSlice),$v._isinit=!0,$W.__init__(),$c.__init__(),$T.__init__(),$v.timer=new $u,$v.scaleTimer=new $u,$v.loader=new $wx,$Q.__init__(),$l=0;for(var $a=$k.length;$l<$a;$l++)$k[$l].enable&&$k[$l].enable();return $R.__init__(),$$.__init__(),$V.__init__(),$o.beginCheck(),$v._currentStage=$v.stage=new $Dx,$v.stage.conchModel&&$v.stage.conchModel.setRootNode(),$v._getUrlPath(),$v.render=new $j(0,0),$v.stage.size($x,$I),$Y.__init__(),$b.__init__(),$s.instance.__init__($v.stage,$j.canvas),$Cx.__init__(),$S.autoStopMusic=!0,$E.__init__(),$j.canvas}},$v._getUrlPath=function(){var $x=$W.window.location,$I=$x.pathname;$I=$I&&":"==$I.charAt(2)?$I.substring(1):$I,$d.rootPath=$d.basePath=$d.getPath("file:"==$x.protocol?$I:$x.protocol+"//"+$x.host+$x.pathname)},$v._arrayBufferSlice=function($x,$I){var $z=new Uint8Array(this,$x,$I-$x),$k=new Uint8Array($z.length);return $k.set($z),$k.buffer},$v._runScript=function($x){return $W.window[$v._evcode]($x)},$v.stage=null,$v.timer=null,$v.scaleTimer=null,$v.loader=null,$v.version="1.8.6",$v.render=null,$v._currentStage=null,$v._isinit=!1,$v.isDebug=!1,$v.MiniAdpter={init:function(){$_.navigator&&$_.navigator.userAgent&&-1<$_.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$w($v,["conchMarket",function(){return this.conchMarket=$_.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$_.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $x(){}return $N($x,"Config"),$x.WebGLTextCacheCount=500,$x.atlasEnable=!1,$x.showCanvasMark=!1,$x.animationInterval=50,$x.isAntialias=!1,$x.isAlpha=!1,$x.premultipliedAlpha=!0,$x.isStencil=!0,$x.preserveDrawingBuffer=!1,$x}()),$i=function(){function $i(){this._events=null}$N($i,"laya.events.EventDispatcher");var $x=$i.prototype;return $x.hasListener=function($x){return!!(this._events&&this._events[$x])},$x.getListener=function($x){return this._events?this._events[$x]:null},$x.event=function($x,$I){if(!this._events||!this._events[$x])return!1;var $z=this._events[$x];if($z.lock)$z.queue||($z.queue=[]),$z.queue.push($I);else{var $k;for($z.lock=!0,$z.cursor=$z.head;$z.cursor;)($k=$z.cursor).recover?($z.head=$z.tail=$z.cursor=null,console.error("node is recover："+$k.id)):($z.cursor=$k.next,$k.once&&$i.delNode($z,$k),$k.method&&(null!=$I?$k.args?$k.method.apply($k.caller,$k.args.concat($I)):$I instanceof Array?$k.method.apply($k.caller,$I):$k.caller?$k.method.call($k.caller,$I):$v.recordError("事件派发错误","node.caller:"+$k.caller+"node.method:"+$k.method+"data:"+$I+"node.prev"+$k.prev):$k.method.apply($k.caller,$k.args)),$k.once&&$i.recoverHandler($k));$z.lock=!1,!$z.head&&this._events&&this._events[$x]==$z&&delete this._events[$x],$z.queue&&$z.queue.length&&this.event($x,$z.queue.shift())}return!0},$x.on=function($x,$I,$z,$k){return this._createListener($x,$I,$z,$k,!1)},$x.once=function($x,$I,$z,$k){return this._createListener($x,$I,$z,$k,!0)},$x._createListener=function($x,$I,$z,$k,$l,$n){void 0===$n&&($n=!0),$n&&this.off($x,$I,$z,$l);var $a=$i.createHandler($I||this,$z,$k,$l);this._events||(this._events={});var $$=this._events,$w=$$[$x];return $w?$w.tail?($a.prev=$w.tail,$w.tail.next=$a,$w.tail=$a):$w.head=$w.tail=$a:$$[$x]={head:$a,tail:$a,cursor:null,lock:!1},this},$x.off=function($x,$I,$z,$k){if(void 0===$k&&($k=!1),!this._events||!this._events[$x])return this;for(var $l=this._events[$x],$n=$l.head;$n;){if((!$I||$n.caller===$I)&&$n.method===$z&&(!$k||$n.once)){$i.delNode($l,$n),$l.cursor==$n&&($l.cursor=$n.next),$i.recoverHandler($n);break}$n=$n.next}return this},$x.offAll=function($x){var $I=this._events;if(!$I)return this;if($x)this._recoverHandlers($I[$x]),delete $I[$x];else{for(var $z in $I)this._recoverHandlers($I[$z]);this._events=null}return this},$x._recoverHandlers=function($x){if($x){for(var $I=$x.head;$I;){$i.delNode($x,$I);var $z=$I.next;$i.recoverHandler($I),$I=$z}$x.cursor=null}},$x.isMouseEvent=function($x){return $i.MOUSE_EVENTS[$x]},$i.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$i.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$i.delNode=function($x,$I){$I.prev?$I.prev.next=$I.next:$x.head=$I.next,$I.next?$I.next.prev=$I.prev:$x.tail=$I.prev},$i.createHandler=function($x,$I,$z,$k){var $l=500<$i._freeHandler.length?$i._freeHandler.shift():null;if($l)if($l.recover)$l.recover=!1,$l.caller=$x,$l.method=$I,$l.args=$z,$l.once=$k;else{var $n="";try{arguments.propertyIsEnumerable.caller}catch($x){$n=$x.stack}var $a=$l.caller?($l.caller.__proto__&&$l.caller.__proto__.constructor&&$l.caller.__proto__.constructor.name)+"|"+$l.caller.__className+"|"+$l.caller.name:"",$$=$l.method?$l.method.name:"";$v.recordError("EventDispatcher重复创建","caller="+$a+"  method="+$$+"  stack="+$n),$l={id:++$i._nodeCount,caller:$x,method:$I,args:$z,once:$k,recover:!1}}else $l={id:++$i._nodeCount,caller:$x,method:$I,args:$z,once:$k,recover:!1};return $l.prev=$l.next=null,$l},$i.recoverHandler=function($x){if($x.recover){if($i._errorCount<5){$i._errorCount++;var $I="";try{arguments.propertyIsEnumerable.caller}catch($x){$I=$x.stack}var $z=$x.caller?($x.caller.__proto__&&$x.caller.__proto__.constructor&&$x.caller.__proto__.constructor.name)+"|"+$x.caller.__className+"|"+$x.caller.name:"",$k=$x.method?$x.method.name:"";$v.recordError("EventDispatcher重复回收","id="+$x.id+"  caller="+$z+"  method="+$k+"  stack="+$I)}$x.caller=$x.method=$x.args=$x.prev=null}else $x.recover=!0,$x.caller=$x.method=$x.args=$x.prev=$x.next=null,$i._freeHandler&&$i._freeHandler.length<3e3&&$i._freeHandler.push($x)},$i._freeHandler=[],$i._nodeCount=0,$i._errorCount=0,$i}(),$f=function(){function $l($x,$I,$z,$k){this.once=!1,void(this._id=0)===$k&&($k=!1),this.setTo($x,$I,$z,$k)}$N($l,"laya.utils.Handler");var $x=$l.prototype;return $x.setTo=function($x,$I,$z,$k){return this._id=$l._gid++,this.caller=$x,this.method=$I,this.args=$z,this.once=$k,this},$x.run=function(){if(null==this.method)return null;var $x=this._id,$I=this.method.apply(this.caller,this.args);return this._id===$x&&this.once&&this.recover(),$I},$x.runWith=function($x){if(null==this.method)return null;var $I=this._id;if(null==$x)var $z=this.method.apply(this.caller,this.args);else $z=this.args||$x.unshift?this.args?this.method.apply(this.caller,this.args.concat($x)):this.method.apply(this.caller,$x):this.method.call(this.caller,$x);return this._id===$I&&this.once&&this.recover(),$z},$x.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$x.recover=function(){0<this._id&&(this._id=0,this.clear())},$l.create=function($x,$I,$z,$k){return void 0===$k&&($k=!0),new $l($x,$I,$z,$k)},$l._gid=1,$l}(),$O=function(){function $x(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$N($x,"laya.display.BitmapFont");var $I=$x.prototype;return $I.loadFont=function($x,$I){this._path=$x,this._complete=$I,$v.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$f.create(this,this.onLoaded))},$I.onLoaded=function(){this.parseFont($$x.getRes(this._path),$$x.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$I.parseFont=function($x,$I){if(null!=$x&&null!=$I){this._texture=$I;var $z=$x.getElementsByTagName("info");if(!$z[0].getAttributeNode)return this.parseFont2($x,$I);this.fontSize=parseInt($z[0].getAttributeNode("size").nodeValue);var $k,$l=$z[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($l[0]),parseInt($l[1]),parseInt($l[2]),parseInt($l[3])],$k=$x.getElementsByTagName("char");var $n=0;for($n=0;$n<$k.length;$n++){var $a=$k[$n],$$=parseInt($a.getAttributeNode("id").nodeValue),$w=parseInt($a.getAttributeNode("xoffset").nodeValue)/1,$i=parseInt($a.getAttributeNode("yoffset").nodeValue)/1,$F=parseInt($a.getAttributeNode("xadvance").nodeValue)/1,$b=new $K;$b.x=parseInt($a.getAttributeNode("x").nodeValue),$b.y=parseInt($a.getAttributeNode("y").nodeValue),$b.width=parseInt($a.getAttributeNode("width").nodeValue),$b.height=parseInt($a.getAttributeNode("height").nodeValue);var $T=$Fx.create($I,$b.x,$b.y,$b.width,$b.height,$w,$i);this._maxWidth=Math.max(this._maxWidth,$F+this.letterSpacing),this._fontCharDic[$$]=$T,this._fontWidthMap[$$]=$F}}},$I.parseFont2=function($x,$I){if(null!=$x&&null!=$I){this._texture=$I;var $z=$x.getElementsByTagName("info");this.fontSize=parseInt($z[0].attributes.size.nodeValue);var $k=$z[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($k[0]),parseInt($k[1]),parseInt($k[2]),parseInt($k[3])];var $l=$x.getElementsByTagName("char"),$n=0;for($n=0;$n<$l.length;$n++){var $a=$l[$n].attributes,$$=parseInt($a.id.nodeValue),$w=parseInt($a.xoffset.nodeValue)/1,$i=parseInt($a.yoffset.nodeValue)/1,$F=parseInt($a.xadvance.nodeValue)/1,$b=new $K;$b.x=parseInt($a.x.nodeValue),$b.y=parseInt($a.y.nodeValue),$b.width=parseInt($a.width.nodeValue),$b.height=parseInt($a.height.nodeValue);var $T=$Fx.create($I,$b.x,$b.y,$b.width,$b.height,$w,$i);this._maxWidth=Math.max(this._maxWidth,$F+this.letterSpacing),this._fontCharDic[$$]=$T,this._fontWidthMap[$$]=$F}}},$I.getCharTexture=function($x){return this._fontCharDic[$x.charCodeAt(0)]},$I.destroy=function(){if(this._texture){for(var $x in this._fontCharDic){var $I=this._fontCharDic[$x];$I&&$I.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$I.setSpaceWidth=function($x){this._spaceWidth=$x},$I.getCharWidth=function($x){var $I=$x.charCodeAt(0);return this._fontWidthMap[$I]?this._fontWidthMap[$I]+this.letterSpacing:" "==$x?this._spaceWidth+this.letterSpacing:0},$I.getTextWidth=function($x){for(var $I=0,$z=0,$k=$x.length;$z<$k;$z++)$I+=this.getCharWidth($x.charAt($z));return $I},$I.getMaxWidth=function(){return this._maxWidth},$I.getMaxHeight=function(){return this.fontSize},$I.drawText=function($x,$I,$z,$k,$l,$n){var $a,$$=this.getTextWidth($x),$w=0;"center"===$l&&($w=($n-$$)/2),"right"===$l&&($w=$n-$$);for(var $i=0,$F=0,$b=$x.length;$F<$b;$F++)($a=this.getCharTexture($x.charAt($F)))&&($I.graphics.drawTexture($a,$z+$i+$w,$k),$i+=this.getCharWidth($x.charAt($F)))},$x}(),$$=function(){function $z(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$z._TF_EMPTY}$N($z,"laya.display.css.Style");var $x=$z.prototype;return $x.getTransform=function(){return this._tf},$x.setTransform=function($x){this._tf="none"!==$x&&$x?$x:$z._TF_EMPTY},$x.setTranslateX=function($x){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.translateX=$x},$x.setTranslateY=function($x){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.translateY=$x},$x.setScaleX=function($x){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.scaleX=$x},$x.setScale=function($x,$I){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.scaleX=$x,this._tf.scaleY=$I},$x.setScaleY=function($x){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.scaleY=$x},$x.setRotate=function($x){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.rotate=$x},$x.setSkewX=function($x){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.skewX=$x},$x.setSkewY=function($x){this._tf===$z._TF_EMPTY&&(this._tf=new $l),this._tf.skewY=$x},$x.destroy=function(){this.scrollRect=null},$x.render=function($x,$I,$z,$k){},$x.getCSSStyle=function(){return $Ix.EMPTY},$x._enableLayout=function(){return!1},$F(0,$x,"scaleX",function(){return this._tf.scaleX},function($x){this.setScaleX($x)}),$F(0,$x,"transform",function(){return this.getTransform()},function($x){this.setTransform($x)}),$F(0,$x,"translateX",function(){return this._tf.translateX},function($x){this.setTranslateX($x)}),$F(0,$x,"translateY",function(){return this._tf.translateY},function($x){this.setTranslateY($x)}),$F(0,$x,"scaleY",function(){return this._tf.scaleY},function($x){this.setScaleY($x)}),$F(0,$x,"block",function(){return 0!=(1&this._type)}),$F(0,$x,"skewY",function(){return this._tf.skewY},function($x){this.setSkewY($x)}),$F(0,$x,"rotate",function(){return this._tf.rotate},function($x){this.setRotate($x)}),$F(0,$x,"skewX",function(){return this._tf.skewX},function($x){this.setSkewX($x)}),$F(0,$x,"paddingLeft",function(){return 0}),$F(0,$x,"paddingTop",function(){return 0}),$F(0,$x,"absolute",function(){return!0}),$z.__init__=function(){$z._TF_EMPTY=new $l,$z.EMPTY=new $z},$z.EMPTY=null,$z._TF_EMPTY=null,$z}(),$R=function(){function $I($x){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$h.create($I.defaultColor),this.family=$I.defaultFamily,this.stroke=$I._STROKE,this.size=$I.defaultSize,$x&&$x!==$I.EMPTY&&$x.copyTo(this)}$N($I,"laya.display.css.Font");var $x=$I.prototype;return $x.set=function($x){this._text=null;for(var $I=$x.split(" "),$z=0,$k=$I.length;$z<$k;$z++){var $l=$I[$z];switch($l){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$l.indexOf("px")&&(this.size=parseInt($l),this.family=$I[$z+1],$z++)}},$x.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$x.copyTo=function($x){$x._type=this._type,$x._text=this._text,$x._weight=this._weight,$x._color=this._color,$x.family=this.family,$x.stroke=this.stroke!=$I._STROKE?this.stroke.slice():$I._STROKE,$x.indent=this.indent,$x.size=this.size},$F(0,$x,"password",function(){return 0!=(1024&this._type)},function($x){$x?this._type|=1024:this._type&=-1025}),$F(0,$x,"color",function(){return this._color.strColor},function($x){this._color=$h.create($x)}),$F(0,$x,"italic",function(){return 0!=(512&this._type)},function($x){$x?this._type|=512:this._type&=-513}),$F(0,$x,"bold",function(){return 0!=(2048&this._type)},function($x){$x?this._type|=2048:this._type&=-2049}),$F(0,$x,"weight",function(){return""+this._weight},function($x){var $I=0;switch($x){case"normal":break;case"bold":this.bold=!0,$I=700;break;case"bolder":$I=800;break;case"lighter":$I=100;break;default:$I=parseInt($x)}this._weight=$I,this._text=null}),$F(0,$x,"decoration",function(){return this._decoration?this._decoration.value:null},function($x){var $I=$x.split(" ");switch(this._decoration||(this._decoration={}),$I[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$I[0]}$I[1]&&(this._decoration.color=$h.create($I)),this._decoration.value=$x}),$I.__init__=function(){$I.EMPTY=new $I(null)},$I.EMPTY=null,$I.defaultColor="#000000",$I.defaultSize=12,$I.defaultFamily="Arial",$I.defaultFont="12px Arial",$I._STROKE=[0,"#000000"],$I._ITALIC=512,$I._PASSWORD=1024,$I._BOLD=2048,$I}(),$l=function(){function $x(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $N($x,"laya.display.css.TransformInfo"),$x}(),$T=function(){function $b(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$j.isConchNode){this._nativeObj=new $_._conchGraphics,this.id=this._nativeObj.conchID}}$N($b,"laya.display.Graphics");var $x=$b.prototype;return $x.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$x.clear=function($x){void 0===$x&&($x=!1);var $I=0,$z=0;if($x){var $k=this._one;if(this._cmds){for($z=this._cmds.length,$I=0;$I<$z;$I++)!($k=this._cmds[$I])||$k.callee!==$j._context._drawTexture&&$k.callee!==$j._context._drawTextureWithTransform||($k[0]=null,$b._cache.push($k));this._cmds.length=0}else $k&&(!$k||$k.callee!==$j._context._drawTexture&&$k.callee!==$j._context._drawTextureWithTransform||($k[0]=null,$b._cache.push($k)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($I=0,$z=this._vectorgraphArray.length;$I<$z;$I++)$M.getInstance().deleteShape(this._vectorgraphArray[$I]);this._vectorgraphArray.length=0}},$x._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$x._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $z,this._graphicBounds._graphics=this)},$x._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$x._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$x.getBounds=function($x){return void 0===$x&&($x=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($x)},$x.getBoundPoints=function($x){return void 0===$x&&($x=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($x)},$x._addCmd=function($x){this._cmds=this._cmds||[],$x.callee=$x.shift(),this._cmds.push($x)},$x.setFilters=function($x){this._saveToCmd($j._context._setFilters,$x)},$x.drawTexture=function($x,$I,$z,$k,$l,$n,$a){if(void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$a&&($a=1),!$x||$a<.01)return null;$k||($k=$x.sourceWidth),$l||($l=$x.sourceHeight),$a=$a<0?0:1<$a?1:$a;var $$,$w=!$j.isWebGL&&($W.onFirefox||$W.onEdge||$W.onIE||$W.onSafari)?.5:0,$i=$k/$x.sourceWidth,$F=$l/$x.sourceHeight;return $k=$x.width*$i,$l=$x.height*$F,$x.loaded&&($k<=0||$l<=0)?null:($I+=$x.offsetX*$i,$z+=$x.offsetY*$F,this._sp&&(this._sp._renderType|=512),$I-=$w,$z-=$w,$k+=2*$w,$l+=2*$w,$b._cache.length?(($$=$b._cache.pop())[0]=$x,$$[1]=$I,$$[2]=$z,$$[3]=$k,$$[4]=$l,$$[5]=$n,$$[6]=$a):$$=[$x,$I,$z,$k,$l,$n,$a],$$.callee=$n||1!=$a?$j._context._drawTextureWithTransform:$j._context._drawTexture,null!=this._one||$n||1!=$a?this._saveToCmd($$.callee,$$):(this._one=$$,this._render=this._renderOneImg),$x.loaded||$x.once("loaded",this,this._textureLoaded,[$x,$$]),this._repaint(),$$)},$x.cleanByTexture=function($x,$I,$z,$k,$l){if(void 0===$k&&($k=0),void 0===$l&&($l=0),!$x)return this.clear();if(this._one&&this._render===this._renderOneImg){$k||($k=$x.sourceWidth),$l||($l=$x.sourceHeight);var $n=$k/$x.sourceWidth,$a=$l/$x.sourceHeight;$k=$x.width*$n,$l=$x.height*$a,$I+=$x.offsetX*$n,$z+=$x.offsetY*$a,this._one[0]=$x,this._one[1]=$I,this._one[2]=$z,this._one[3]=$k,this._one[4]=$l,this._repaint()}else this.clear(),$x&&this.drawTexture($x,$I,$z,$k,$l)},$x.drawTextures=function($x,$I){$x&&this._saveToCmd($j._context._drawTextures,[$x,$I])},$x.fillTexture=function($x,$I,$z,$k,$l,$n,$a){if(void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$n&&($n="repeat"),$x){var $$=[$x,$I,$z,$k,$l,$n,$a||$L.EMPTY,{}];$x.loaded||$x.once("loaded",this,this._textureLoaded,[$x,$$]),this._saveToCmd($j._context._fillTexture,$$)}},$x._textureLoaded=function($x,$I){$I[3]=$I[3]||$x.width,$I[4]=$I[4]||$x.height,this._repaint()},$x.fillCircle=function($x,$I,$z,$k,$l,$n,$a){$z.bitmap.enableMerageInAtlas=!1;var $$=new Float32Array(2*($a+1)),$w=new Float32Array(2*($a+1)),$i=new Uint16Array(3*$a),$F=2*Math.PI/$a,$b=0;$$[0]=$k,$$[1]=$l,$w[0]=$k/$z.width,$w[1]=$l/$z.height;for(var $T=2,$_=0;$_<$a;$_++){var $R=$n*Math.cos($b)+$k,$s=$n*Math.sin($b)+$l;$$[$T]=$R,$$[$T+1]=$s,$w[$T]=$R/$z.width,$w[$T+1]=$s/$z.height,$b+=$F,$T+=2}for($_=$T=0;$_<$a;$_++)$i[$T++]=0,$i[$T++]=$_+1,$i[$T++]=$a+1<=$_+2?1:$_+2;this.drawTriangles($z,$x,$I,$$,$w,$i)},$x.drawTriangles=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){void 0===$$&&($$=1),this._saveToCmd($j._context.drawTriangles,[$x,$I,$z,$k,$l,$n,$a,$$,$w,$i])},$x._saveToCmd=function($x,$I){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$I,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($I)),$I.callee=$x,this._repaint(),$I},$x.clipRect=function($x,$I,$z,$k){this._saveToCmd($j._context._clipRect,[$x,$I,$z,$k])},$x.fillText=function($x,$I,$z,$k,$l,$n,$a){void 0===$a&&($a=0),this._saveToCmd($j._context._fillText,[$x,$I,$z,$k||$R.defaultFont,$l,$n])},$x.fillBorderText=function($x,$I,$z,$k,$l,$n,$a,$$){this._saveToCmd($j._context._fillBorderText,[$x,$I,$z,$k||$R.defaultFont,$l,$n,$a,$$])},$x.strokeText=function($x,$I,$z,$k,$l,$n,$a){this._saveToCmd($j._context._strokeText,[$x,$I,$z,$k||$R.defaultFont,$l,$n,$a])},$x.alpha=function($x){$x=$x<0?0:1<$x?1:$x,this._saveToCmd($j._context._alpha,[$x])},$x.setAlpha=function($x){$x=$x<0?0:1<$x?1:$x,this._saveToCmd($j._context._setAlpha,[$x])},$x.transform=function($x,$I,$z){void 0===$I&&($I=0),void 0===$z&&($z=0),this._saveToCmd($j._context._transform,[$x,$I,$z])},$x.rotate=function($x,$I,$z){void 0===$I&&($I=0),void 0===$z&&($z=0),this._saveToCmd($j._context._rotate,[$x,$I,$z])},$x.scale=function($x,$I,$z,$k){void 0===$z&&($z=0),void 0===$k&&($k=0),this._saveToCmd($j._context._scale,[$x,$I,$z,$k])},$x.translate=function($x,$I){this._saveToCmd($j._context._translate,[$x,$I])},$x.save=function(){this._saveToCmd($j._context._save,[])},$x.restore=function(){this._saveToCmd($j._context._restore,[])},$x.replaceText=function($x){this._repaint();var $I=this._cmds;if($I){for(var $z=$I.length-1;-1<$z;$z--)if(this._isTextCmd($I[$z].callee))return $I[$z][0].toUpperCase?$I[$z][0]=$x:$I[$z][0].setText($x),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$x:this._one[0].setText($x),!0;return!1},$x._isTextCmd=function($x){return $x===$j._context._fillText||$x===$j._context._fillBorderText||$x===$j._context._strokeText},$x.replaceTextColor=function($x){this._repaint();var $I=this._cmds;if($I)for(var $z=$I.length-1;-1<$z;$z--)this._isTextCmd($I[$z].callee)&&($I[$z][4]=$x,$I[$z][0].toUpperCase||($I[$z][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$x,this._one[0].toUpperCase||(this._one[0].changed=!0))},$x.loadImage=function($x,$I,$z,$k,$l,$n){var $a=this;void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=0),void 0===$l&&($l=0);var $$=$$x.getRes($x);function $w($x){$x&&($a.drawTexture($x,$I,$z,$k,$l),null!=$n&&$n.call($a._sp,$x))}$$?$w($$):$v.loader.load($x,$f.create(null,$w),null,"image")},$x._renderEmpty=function($x,$I,$z,$k){},$x._renderAll=function($x,$I,$z,$k){for(var $l,$n=this._cmds,$a=0,$$=$n.length;$a<$$;$a++)($l=$n[$a]).callee.call($I,$z,$k,$l)},$x._renderOne=function($x,$I,$z,$k){this._one.callee.call($I,$z,$k,this._one)},$x._renderOneImg=function($x,$I,$z,$k){this._one.callee.call($I,$z,$k,this._one),2305!==$x._renderType&&($x._renderType|=1)},$x.drawLine=function($x,$I,$z,$k,$l,$n){void 0===$n&&($n=1);var $a=0;$j.isWebGL&&($a=$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($a));var $$=$n%2==0?0:.5,$w=[$x+$$,$I+$$,$z+$$,$k+$$,$l,$n,$a];this._saveToCmd($j._context._drawLine,$w)},$x.drawLines=function($x,$I,$z,$k,$l){void 0===$l&&($l=1);var $n=0;if($z&&!($z.length<4)){$j.isWebGL&&($n=$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($n));var $a=$l%2==0?0:.5,$$=[$x+$a,$I+$a,$z,$k,$l,$n];this._saveToCmd($j._context._drawLines,$$)}},$x.drawCurves=function($x,$I,$z,$k,$l){void 0===$l&&($l=1);var $n=[$x,$I,$z,$k,$l];this._saveToCmd($j._context._drawCurves,$n)},$x.drawRect=function($x,$I,$z,$k,$l,$n,$a){void 0===$a&&($a=1);var $$=$n?$a/2:0,$w=$n?$a:0,$i=[$x+$$,$I+$$,$z-$w,$k-$w,$l,$n,$a];this._saveToCmd($j._context._drawRect,$i)},$x.drawCircle=function($x,$I,$z,$k,$l,$n){void 0===$n&&($n=1);var $a=$l?$n/2:0,$$=0;$j.isWebGL&&($$=$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($$));var $w=[$x,$I,$z-$a,$k,$l,$n,$$];this._saveToCmd($j._context._drawCircle,$w)},$x.drawPie=function($x,$I,$z,$k,$l,$n,$a,$$){void 0===$$&&($$=1);var $w=$a?$$/2:0,$i=$a?$$:0,$F=0;$j.isWebGL&&($F=$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($F));var $b=[$x+$w,$I+$w,$z-$i,$k,$l,$n,$a,$$,$F];$b[3]=$g.toRadian($k),$b[4]=$g.toRadian($l),this._saveToCmd($j._context._drawPie,$b)},$x.drawPoly=function($x,$I,$z,$k,$l,$n){void 0===$n&&($n=1);var $a=0,$$=!1;$j.isWebGL&&($a=$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($a),$$=!(6<$z.length));var $w=$l?$n%2==0?0:.5:0,$i=[$x+$w,$I+$w,$z,$k,$l,$n,$a,$$];this._saveToCmd($j._context._drawPoly,$i)},$x.drawPath=function($x,$I,$z,$k,$l){var $n=[$x,$I,$z,$k,$l];this._saveToCmd($j._context._drawPath,$n)},$F(0,$x,"cmds",function(){return this._cmds},function($x){this._sp&&(this._sp._renderType|=512),this._cmds=$x,this._render=this._renderAll,this._repaint()}),$b.__init__=function(){if($j.isConchNode){for(var $x=laya.display.Graphics.prototype,$I=$W.window.ConchGraphics.prototype,$z=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$k=0,$l=$z.length;$k<=$l;$k++){var $n=$z[$k];$x[$n]=$I[$n]}$x._saveToCmd=null,$I.drawImageS&&($x.drawTextures=function($x,$I){if($x&&$x.loaded&&$x.bitmap&&$x.source){var $z=$x.uv,$k=$x.bitmap.width,$l=$x.bitmap.height;this.drawImageS($x.bitmap.source,$z[0]*$k,$z[1]*$l,($z[2]-$z[0])*$k,($z[5]-$z[3])*$l,$x.offsetX,$x.offsetY,$x.width,$x.height,$I)}}),$x.drawTexture=function($x,$I,$z,$k,$l,$n,$a){if(void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$a&&($a=1),$x)if($x.loaded){if($x.loaded&&$x.bitmap&&$x.source&&($k||($k=$x.sourceWidth),$l||($l=$x.sourceHeight),$a=$a<0?0:1<$a?1:$a,$k=$k-$x.sourceWidth+$x.width,$l=$l-$x.sourceHeight+$x.height,!($k<=0||$l<=0))){$I+=$x.offsetX,$z+=$x.offsetY;var $$=$x.uv,$w=$x.bitmap.width,$i=$x.bitmap.height;$$[4]<$$[0]&&$$[5]<$$[1]?this.drawImageM($x.bitmap.source,$$[4]*$w,$$[5]*$i,($$[0]-$$[4])*$w,($$[1]-$$[5])*$i,$I,$z,$k,$l,$n,$a):this.drawImageM($x.bitmap.source,$$[0]*$w,$$[1]*$i,($$[2]-$$[0])*$w,($$[5]-$$[3])*$i,$I,$z,$k,$l,$n,$a),this._repaint()}}else $x.once("loaded",this,function(){this.drawTexture($x,$I,$z,$k,$l,$n)})},$x.fillTexture=function($x,$I,$z,$k,$l,$n,$a){if(void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$n&&($n="repeat"),$x&&$x.loaded){var $$,$w=$j._context.ctx,$i=$x.bitmap.width,$F=$x.bitmap.height,$b=$x.uv;$$=$x.uv!=$Fx.DEF_UV?$w.createPattern($x.bitmap.source,$n,$b[0]*$i,$b[1]*$F,($b[2]-$b[0])*$i,($b[5]-$b[3])*$F):$w.createPattern($x.bitmap.source,$n);var $T=0,$_=0;$a&&($I+=$a.x%$x.width,$z+=$a.y%$x.height,$T-=$a.x%$x.width,$_-=$a.y%$x.height),this._fillImage($$,$I,$z,$T,$_,$k,$l)}}}},$b._cache=[],$b}(),$z=function(){function $m(){this._cacheBoundsType=!1}$N($m,"laya.display.GraphicsBounds");var $x=$m.prototype;return $x.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$x.reset=function(){this._temp&&(this._temp.length=0)},$x.getBounds=function($x){return void 0===$x&&($x=!1),(!this._bounds||!this._temp||this._temp.length<1||$x!=this._cacheBoundsType)&&(this._bounds=$K._getWrapRec(this.getBoundPoints($x),this._bounds)),this._cacheBoundsType=$x,this._bounds},$x.getBoundPoints=function($x){return void 0===$x&&($x=!1),(!this._temp||this._temp.length<1||$x!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($x)),this._cacheBoundsType=$x,this._rstBoundPoints=$g.copyArray(this._rstBoundPoints,this._temp)},$x._getCmdPoints=function($x){void 0===$x&&($x=!1);var $I,$z,$k=$j._context,$l=this._graphics.cmds;if(($I=this._temp||(this._temp=[])).length=0,$l||null==this._graphics._one||($m._tempCmds.length=0,$m._tempCmds.push(this._graphics._one),$l=$m._tempCmds),!$l)return $I;($z=$m._tempMatrixArrays).length=0;var $n=$m._initMatrix;$n.identity();for(var $a,$$,$w=$m._tempMatrix,$i=NaN,$F=NaN,$b=NaN,$T=NaN,$_=NaN,$R=NaN,$s=0,$N=$l.length;$s<$N;$s++)if(($a=$l[$s]).callee)switch($a.callee){case $k._save:case 7:$z.push($n),$n=$n.clone();break;case $k._restore:case 8:$n=$z.pop();break;case $k._scale:case 5:$w.identity(),$w.translate(-$a[2],-$a[3]),$w.scale($a[0],$a[1]),$w.translate($a[2],$a[3]),this._switchMatrix($n,$w);break;case $k._rotate:case 3:$w.identity(),$w.translate(-$a[1],-$a[2]),$w.rotate($a[0]),$w.translate($a[1],$a[2]),this._switchMatrix($n,$w);break;case $k._translate:case 6:$w.identity(),$w.translate($a[0],$a[1]),this._switchMatrix($n,$w);break;case $k._transform:case 4:$w.identity(),$w.translate(-$a[1],-$a[2]),$w.concat($a[0]),$w.translate($a[1],$a[2]),this._switchMatrix($n,$w);break;case 16:case 24:$m._addPointArrToRst($I,$K._getBoundPointS($a[0],$a[1],$a[2],$a[3]),$n);break;case 17:$n.copyTo($w),$w.concat($a[4]),$m._addPointArrToRst($I,$K._getBoundPointS($a[0],$a[1],$a[2],$a[3]),$w);break;case $k._drawTexture:$$=$a[0],$x?$a[3]&&$a[4]?$m._addPointArrToRst($I,$K._getBoundPointS($a[1],$a[2],$a[3],$a[4]),$n):($$=$a[0],$m._addPointArrToRst($I,$K._getBoundPointS($a[1],$a[2],$$.width,$$.height),$n)):($i=($a[3]||$$.sourceWidth)/$$.width,$F=($a[4]||$$.sourceHeight)/$$.height,$b=$i*$$.sourceWidth,$T=$F*$$.sourceHeight,$_=0<$$.offsetX?$$.offsetX:0,$R=0<$$.offsetY?$$.offsetY:0,$_*=$i,$R*=$F,$m._addPointArrToRst($I,$K._getBoundPointS($a[1]-$_,$a[2]-$R,$b,$T),$n));break;case $k._fillTexture:$a[3]&&$a[4]?$m._addPointArrToRst($I,$K._getBoundPointS($a[1],$a[2],$a[3],$a[4]),$n):($$=$a[0],$m._addPointArrToRst($I,$K._getBoundPointS($a[1],$a[2],$$.width,$$.height),$n));break;case $k._drawTextureWithTransform:var $D;$D=$a[5]?($n.copyTo($w),$w.concat($a[5]),$w):$n,$x?$a[3]&&$a[4]?$m._addPointArrToRst($I,$K._getBoundPointS($a[1],$a[2],$a[3],$a[4]),$D):($$=$a[0],$m._addPointArrToRst($I,$K._getBoundPointS($a[1],$a[2],$$.width,$$.height),$D)):($$=$a[0],$i=($a[3]||$$.sourceWidth)/$$.width,$F=($a[4]||$$.sourceHeight)/$$.height,$b=$i*$$.sourceWidth,$T=$F*$$.sourceHeight,$_=0<$$.offsetX?$$.offsetX:0,$R=0<$$.offsetY?$$.offsetY:0,$_*=$i,$R*=$F,$m._addPointArrToRst($I,$K._getBoundPointS($a[1]-$_,$a[2]-$R,$b,$T),$D));break;case $k._drawRect:case 13:$m._addPointArrToRst($I,$K._getBoundPointS($a[0],$a[1],$a[2],$a[3]),$n);break;case $k._drawCircle:case $k._fillCircle:case 14:$m._addPointArrToRst($I,$K._getBoundPointS($a[0]-$a[2],$a[1]-$a[2],$a[2]+$a[2],$a[2]+$a[2]),$n);break;case $k._drawLine:case 20:$m._tempPoints.length=0;var $f;$f=.5*$a[5],$a[0]==$a[2]?$m._tempPoints.push($a[0]+$f,$a[1],$a[2]+$f,$a[3],$a[0]-$f,$a[1],$a[2]-$f,$a[3]):$a[1]==$a[3]?$m._tempPoints.push($a[0],$a[1]+$f,$a[2],$a[3]+$f,$a[0],$a[1]-$f,$a[2],$a[3]-$f):$m._tempPoints.push($a[0],$a[1],$a[2],$a[3]),$m._addPointArrToRst($I,$m._tempPoints,$n);break;case $k._drawCurves:case 22:$m._addPointArrToRst($I,$y.I.getBezierPoints($a[2]),$n,$a[0],$a[1]);break;case $k._drawPoly:case $k._drawLines:case 18:$m._addPointArrToRst($I,$a[2],$n,$a[0],$a[1]);break;case $k._drawPath:case 19:$m._addPointArrToRst($I,this._getPathPoints($a[2]),$n,$a[0],$a[1]);break;case $k._drawPie:case 15:$m._addPointArrToRst($I,this._getPiePoints($a[0],$a[1],$a[2],$a[3],$a[4]),$n)}return 200<$I.length?$I=$g.copyArray($I,$K._getWrapRec($I)._getBoundPoints()):8<$I.length&&($I=$C.scanPList($I)),$I},$x._switchMatrix=function($x,$I){$I.concat($x),$I.copyTo($x)},$x._getPiePoints=function($x,$I,$z,$k,$l){var $n=$m._tempPoints;$m._tempPoints.length=0,$n.push($x,$I);var $a=($l-$k)%(2*Math.PI)/10,$$=NaN,$w=$k;for($$=0;$$<=10;$$++)$n.push($x+$z*Math.cos($w),$I+$z*Math.sin($w)),$w+=$a;return $n},$x._getPathPoints=function($x){var $I,$z,$k=0,$l=$m._tempPoints;for($l.length=0,$I=$x.length,$k=0;$k<$I;$k++)1<($z=$x[$k]).length&&($l.push($z[1],$z[2]),3<$z.length&&$l.push($z[3],$z[4]));return $l},$m._addPointArrToRst=function($x,$I,$z,$k,$l){void 0===$k&&($k=0),void 0===$l&&($l=0);var $n,$a=0;for($n=$I.length,$a=0;$a<$n;$a+=2)$m._addPointToRst($x,$I[$a]+$k,$I[$a+1]+$l,$z)},$m._addPointToRst=function($x,$I,$z,$k){var $l=$L.TEMP;$l.setTo($I||0,$z||0),$k.transformPoint($l),$x.push($l.x,$l.y)},$m._tempPoints=[],$m._tempMatrixArrays=[],$m._tempCmds=[],$w($m,["_tempMatrix",function(){return this._tempMatrix=new $U},"_initMatrix",function(){return this._initMatrix=new $U}]),$m}(),$n=function(){function $x(){}$N($x,"laya.events.Event");var $I=$x.prototype;return $I.setTo=function($x,$I,$z){return this.type=$x,this.currentTarget=$I,this.target=$z,this},$I.stopPropagation=function(){this._stoped=!0},$F(0,$I,"stageY",function(){return $v.stage.mouseY}),$F(0,$I,"charCode",function(){return this.nativeEvent.charCode}),$F(0,$I,"touches",function(){var $x=this.nativeEvent.touches;if($x)for(var $I=$v.stage,$z=0,$k=$x.length;$z<$k;$z++){var $l=$x[$z],$n=$L.TEMP;$n.setTo($l.clientX,$l.clientY),$I._canvasTransform.invertTransformPoint($n),$I.transform.invertTransformPoint($n),$l.stageX=$n.x,$l.stageY=$n.y}return $x}),$F(0,$I,"keyLocation",function(){return this.nativeEvent.keyLocation}),$F(0,$I,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$F(0,$I,"altKey",function(){return this.nativeEvent.altKey}),$F(0,$I,"shiftKey",function(){return this.nativeEvent.shiftKey}),$F(0,$I,"stageX",function(){return $v.stage.mouseX}),$x.EMPTY=new $x,$x.MOUSE_DOWN="mousedown",$x.MOUSE_UP="mouseup",$x.CLICK="click",$x.RIGHT_MOUSE_DOWN="rightmousedown",$x.RIGHT_MOUSE_UP="rightmouseup",$x.RIGHT_CLICK="rightclick",$x.MOUSE_MOVE="mousemove",$x.MOUSE_OVER="mouseover",$x.MOUSE_OUT="mouseout",$x.MOUSE_WHEEL="mousewheel",$x.ROLL_OVER="mouseover",$x.ROLL_OUT="mouseout",$x.DOUBLE_CLICK="doubleclick",$x.CHANGE="change",$x.CHANGED="changed",$x.RESIZE="resize",$x.ADDED="added",$x.REMOVED="removed",$x.DISPLAY="display",$x.UNDISPLAY="undisplay",$x.ERROR="error",$x.COMPLETE="complete",$x.LOADED="loaded",$x.INITED="inited",$x.PROGRESS="progress",$x.INPUT="input",$x.RENDER="render",$x.OPEN="open",$x.MESSAGE="message",$x.CLOSE="close",$x.KEY_DOWN="keydown",$x.KEY_PRESS="keypress",$x.KEY_UP="keyup",$x.FRAME="enterframe",$x.DRAG_START="dragstart",$x.DRAG_MOVE="dragmove",$x.DRAG_END="dragend",$x.ENTER="enter",$x.SELECT="select",$x.BLUR="blur",$x.FOCUS="focus",$x.VISIBILITY_CHANGE="visibilitychange",$x.FOCUS_CHANGE="focuschange",$x.PLAYED="played",$x.PAUSED="paused",$x.STOPPED="stopped",$x.START="start",$x.END="end",$x.ENABLE_CHANGED="enablechanged",$x.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$x.COMPONENT_ADDED="componentadded",$x.COMPONENT_REMOVED="componentremoved",$x.LAYER_CHANGED="layerchanged",$x.HIERARCHY_LOADED="hierarchyloaded",$x.RECOVERED="recovered",$x.RELEASED="released",$x.LINK="link",$x.LABEL="label",$x.FULL_SCREEN_CHANGE="fullscreenchange",$x.DEVICE_LOST="devicelost",$x.MESH_CHANGED="meshchanged",$x.MATERIAL_CHANGED="materialchanged",$x.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$x.ANIMATION_CHANGED="animationchanged",$x.TRIGGER_ENTER="triggerenter",$x.TRIGGER_STAY="triggerstay",$x.TRIGGER_EXIT="triggerexit",$x.TRAIL_FILTER_CHANGE="trailfilterchange",$x.DOMINO_FILTER_CHANGE="dominofilterchange",$x}(),$b=(function(){function $x(){}$N($x,"laya.events.Keyboard"),$x.NUMBER_0=48,$x.NUMBER_1=49,$x.NUMBER_2=50,$x.NUMBER_3=51,$x.NUMBER_4=52,$x.NUMBER_5=53,$x.NUMBER_6=54,$x.NUMBER_7=55,$x.NUMBER_8=56,$x.NUMBER_9=57,$x.A=65,$x.B=66,$x.C=67,$x.D=68,$x.E=69,$x.F=70,$x.G=71,$x.H=72,$x.I=73,$x.J=74,$x.K=75,$x.L=76,$x.M=77,$x.N=78,$x.O=79,$x.P=80,$x.Q=81,$x.R=82,$x.S=83,$x.T=84,$x.U=85,$x.V=86,$x.W=87,$x.X=88,$x.Y=89,$x.Z=90,$x.F1=112,$x.F2=113,$x.F3=114,$x.F4=115,$x.F5=116,$x.F6=117,$x.F7=118,$x.F8=119,$x.F9=120,$x.F10=121,$x.F11=122,$x.F12=123,$x.F13=124,$x.F14=125,$x.F15=126,$x.NUMPAD=21,$x.NUMPAD_0=96,$x.NUMPAD_1=97,$x.NUMPAD_2=98,$x.NUMPAD_3=99,$x.NUMPAD_4=100,$x.NUMPAD_5=101,$x.NUMPAD_6=102,$x.NUMPAD_7=103,$x.NUMPAD_8=104,$x.NUMPAD_9=105,$x.NUMPAD_ADD=107,$x.NUMPAD_DECIMAL=110,$x.NUMPAD_DIVIDE=111,$x.NUMPAD_ENTER=108,$x.NUMPAD_MULTIPLY=106,$x.NUMPAD_SUBTRACT=109,$x.SEMICOLON=186,$x.EQUAL=187,$x.COMMA=188,$x.MINUS=189,$x.PERIOD=190,$x.SLASH=191,$x.BACKQUOTE=192,$x.LEFTBRACKET=219,$x.BACKSLASH=220,$x.RIGHTBRACKET=221,$x.QUOTE=222,$x.ALTERNATE=18,$x.BACKSPACE=8,$x.CAPS_LOCK=20,$x.COMMAND=15,$x.CONTROL=17,$x.DELETE=46,$x.ENTER=13,$x.ESCAPE=27,$x.PAGE_UP=33,$x.PAGE_DOWN=34,$x.END=35,$x.HOME=36,$x.LEFT=37,$x.UP=38,$x.RIGHT=39,$x.DOWN=40,$x.SHIFT=16,$x.SPACE=32,$x.TAB=9,$x.INSERT=45}(),function(){function $l(){}return $N($l,"laya.events.KeyBoardManager"),$l.__init__=function(){$l._addEvent("keydown"),$l._addEvent("keypress"),$l._addEvent("keyup")},$l._addEvent=function($I){$W.document.addEventListener($I,function($x){laya.events.KeyBoardManager._dispatch($x,$I)},!0)},$l._dispatch=function($x,$I){if($l.enabled){$l._event._stoped=!1,$l._event.nativeEvent=$x,$l._event.keyCode=$x.keyCode||$x.which||$x.charCode,"keydown"===$I?$l._pressKeys[$l._event.keyCode]=!0:"keyup"===$I&&($l._pressKeys[$l._event.keyCode]=null);for(var $z=$v.stage.focus&&null!=$v.stage.focus.event&&$v.stage.focus.displayedInStage?$v.stage.focus:$v.stage,$k=$z;$k;)$k.event($I,$l._event.setTo($I,$k,$z)),$k=$k.parent}},$l.hasKeyDown=function($x){return $l._pressKeys[$x]},$l._pressKeys={},$l.enabled=!0,$w($l,["_event",function(){return this._event=new $n}]),$l}()),$s=(function(){function $x(){}$N($x,"laya.events.KeyLocation"),$x.STANDARD=0,$x.LEFT=1,$x.RIGHT=2,$x.NUM_PAD=3}(),function(){function $F(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$W.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $n,this._matrix=new $U,this._point=new $L,this._rect=new $K,this._prePoint=new $L,this._curTouchID=NaN}$N($F,"laya.events.MouseManager");var $x=$F.prototype;return $x.__init__=function($x,$I){var $z=this;this._stage=$x;var $k=this,$l=this._eventList;$I.oncontextmenu=function($x){if($F.enabled)return!1},$I.addEventListener("mousedown",function($x){$F.enabled&&($W.onIE||$x.preventDefault(),$l.push($x),$k.mouseDownTime=$W.now())}),$I.addEventListener("mouseup",function($x){$F.enabled&&($x.preventDefault(),$l.push($x),$k.mouseDownTime=-$W.now())},!0),$I.addEventListener("mousemove",function($x){if($F.enabled){$x.preventDefault();var $I=$W.now();if($I-$k._lastMoveTimer<10)return;$k._lastMoveTimer=$I,$l.push($x)}},!0),$I.addEventListener("mouseout",function($x){$F.enabled&&$l.push($x)}),$I.addEventListener("mouseover",function($x){$F.enabled&&$l.push($x)}),$I.addEventListener("touchstart",function($x){$F.enabled&&($l.push($x),$F._isFirstTouch||$Cx.isInputting||$x.preventDefault(),$k.mouseDownTime=$W.now())}),$I.addEventListener("touchend",function($x){$F.enabled?($F._isFirstTouch||$Cx.isInputting||$x.preventDefault(),$F._isFirstTouch=!1,$l.push($x),$k.mouseDownTime=-$W.now()):$z._curTouchID=NaN},!0),$I.addEventListener("touchmove",function($x){$F.enabled&&($x.preventDefault(),$l.push($x))},!0),$I.addEventListener("touchcancel",function($x){$F.enabled?($x.preventDefault(),$l.push($x)):$z._curTouchID=NaN},!0),$I.addEventListener("mousewheel",function($x){$F.enabled&&$l.push($x)}),$I.addEventListener("DOMMouseScroll",function($x){$F.enabled&&$l.push($x)})},$x.initEvent=function($x,$I){var $z;this._event._stoped=!1,this._event.nativeEvent=$I||$x,this._target=null,this._point.setTo($x.pageX||$x.clientX,$x.pageY||$x.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$x.identifier||0,this._tTouchID=this._event.touchId,($z=$D.I._event)._stoped=!1,$z.nativeEvent=this._event.nativeEvent,$z.touchId=this._event.touchId},$x.checkMouseWheel=function($x){this._event.delta=$x.wheelDelta?.025*$x.wheelDelta:-$x.detail;for(var $I=$D.I.getLastOvers(),$z=0,$k=$I.length;$z<$k;$z++){var $l=$I[$z];$l.event("mousewheel",this._event.setTo("mousewheel",$l,this._target))}},$x.onMouseMove=function($x){$D.I.onMouseMove($x,this._tTouchID)},$x.onMouseDown=function($x){if($Cx.isInputting&&$v.stage.focus&&$v.stage.focus.focus&&!$v.stage.focus.contains(this._target)){var $I=$v.stage.focus._tf||$v.stage.focus,$z=$x._tf||$x;$z instanceof laya.display.Input&&$z.multiline==$I.multiline?$I._focusOut():$I.focus=!1}$D.I.onMouseDown($x,this._tTouchID,this._isLeftMouse)},$x.onMouseUp=function($x){$D.I.onMouseUp($x,this._tTouchID,this._isLeftMouse)},$x.check=function($x,$I,$z,$k){this._point.setTo($I,$z),$x.fromParentPoint(this._point),$I=this._point.x,$z=this._point.y;var $l=$x.scrollRect;if($l&&(this._rect.setTo($l.x,$l.y,$l.width,$l.height),!this._rect.contains($I,$z)))return!1;if(!this.disableMouseEvent){if($x.hitTestPrior&&!$x.mouseThrough&&!this.hitTest($x,$I,$z))return!1;for(var $n=$x._childs.length-1;-1<$n;$n--){var $a=$x._childs[$n];if(!$a.destroyed&&$a.mouseEnabled&&$a.visible&&this.check($a,$I,$z,$k))return!0}}var $$=!(!$x.hitTestPrior||$x.mouseThrough||this.disableMouseEvent)||this.hitTest($x,$I,$z);return $$?(this._target=$x,$k.call(this,$x)):$k===this.onMouseUp&&$x===this._stage&&(this._target=this._stage,$k.call(this,this._target)),$$},$x.hitTest=function($x,$I,$z){var $k=!1;if($x.scrollRect&&($I-=$x.scrollRect.x,$z-=$x.scrollRect.y),$x.hitArea instanceof laya.utils.HitArea)return $x.hitArea.isHit($I,$z);if(0<$x.width&&0<$x.height||$x.mouseThrough||$x.hitArea)if($x.mouseThrough)$k=$x.getGraphicBounds().contains($I,$z);else{var $l=this._rect;$x.hitArea?$l=$x.hitArea:$l.setTo(0,0,$x.width,$x.height),$k=$l.contains($I,$z)}return $k},$x.runEvent=function(){var $x=this._eventList.length;if($x){var $I=this;$I.mouseEventTime=$W.now();var $z,$k=0,$l=0,$n=0;try{for(;$k<$x;){var $a=this._eventList[$k];switch("mousemove"!==$a.type&&(this._prePoint.x=this._prePoint.y=-1e6),$a.type){case"mousedown":this._touchIDs[0]=this._id++,$F._isTouchRespond?$F._isTouchRespond=!1:($I._isLeftMouse=0===$a.button,$I.initEvent($a),$I.check($I._stage,$I.mouseX,$I.mouseY,$I.onMouseDown));break;case"mouseup":$I._isLeftMouse=0===$a.button,$I.initEvent($a),$I.check($I._stage,$I.mouseX,$I.mouseY,$I.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$a.clientX)+Math.abs(this._prePoint.y-$a.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$a.clientX,this._prePoint.y=$a.clientY,$I.initEvent($a),$I.check($I._stage,$I.mouseX,$I.mouseY,$I.onMouseMove));break;case"touchstart":$F._isTouchRespond=!0,$I._isLeftMouse=!0;var $$=$a.changedTouches;for($l=0,$n=$$.length;$l<$n;$l++)$z=$$[$l],($F.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$z.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$z.identifier]=this._id++,$I.initEvent($z,$a),$I.check($I._stage,$I.mouseX,$I.mouseY,$I.onMouseDown));break;case"touchend":case"touchcancel":$F._isTouchRespond=!0,$I._isLeftMouse=!0;var $w=$a.changedTouches;for($l=0,$n=$w.length;$l<$n;$l++)if($z=$w[$l],$F.multiTouchEnabled||$z.identifier==this._curTouchID){this._curTouchID=NaN,$I.initEvent($z,$a);$I.check($I._stage,$I.mouseX,$I.mouseY,$I.onMouseUp)||$I.onMouseUp(null)}break;case"touchmove":var $i=$a.changedTouches;for($l=0,$n=$i.length;$l<$n;$l++)$z=$i[$l],($F.multiTouchEnabled||$z.identifier==this._curTouchID)&&($I.initEvent($z,$a),$I.check($I._stage,$I.mouseX,$I.mouseY,$I.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$I.checkMouseWheel($a);break;case"mouseout":$D.I.stageMouseOut();break;case"mouseover":$I._stage.event("mouseover",$I._event.setTo("mouseover",$I._stage,$I._stage))}$k++}}catch($x){throw this._eventList.length=0,$x}this._eventList.length=0}},$F.enabled=!0,$F.multiTouchEnabled=!0,$F._isTouchRespond=!1,$F._isFirstTouch=!0,$w($F,["instance",function(){return this.instance=new $F}]),$F}()),$D=function(){function $R(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $n}$N($R,"laya.events.TouchManager");var $x=$R.prototype;return $x._clearTempArrs=function(){$R._oldArr.length=0,$R._newArr.length=0,$R._tEleArr.length=0},$x.getTouchFromArr=function($x,$I){var $z,$k,$l=0;for($z=$I.length,$l=0;$l<$z;$l++)if(($k=$I[$l]).id==$x)return $k;return null},$x.removeTouchFromArr=function($x,$I){var $z=0;for($z=$I.length-1;0<=$z;$z--)$I[$z].id==$x&&$I.splice($z,1)},$x.createTouchO=function($x,$I){var $z;return($z=$H.getItem("TouchData")||{}).id=$I,$z.tar=$x,$z},$x.onMouseDown=function($x,$I,$z){var $k,$l,$n,$a;(void 0===$z&&($z=!1),this.enable)&&($k=this.getTouchFromArr($I,this.preOvers),$n=this.getEles($x,null,$R._tEleArr),$k?$k.tar=$x:($l=this.createTouchO($x,$I),this.preOvers.push($l)),$W.onMobile&&this.sendEvents($n,"mouseover",$I),$a=$z?this.preDowns:this.preRightDowns,($k=this.getTouchFromArr($I,$a))?$k.tar=$x:($l=this.createTouchO($x,$I),$a.push($l)),this.sendEvents($n,$z?"mousedown":"rightmousedown",$I),this._clearTempArrs())},$x.sendEvents=function($x,$I,$z){void 0===$z&&($z=0);var $k,$l,$n,$a=0;for($k=$x.length,this._event._stoped=!1,$l=$x[0],$a=0;$a<$k;$a++){if(($n=$x[$a]).destroyed)return;if($n.event($I,this._event.setTo($I,$n,$l)),this._event._stoped)break}},$x.getEles=function($x,$I,$z){for($z?$z.length=0:$z=[];$x&&$x!=$I;)$z.push($x),$x=$x.parent;return $z},$x.checkMouseOutAndOverOfMove=function($x,$I,$z){if(void 0===$z&&($z=0),$I!=$x){var $k,$l,$n=0,$a=0;if($I.contains($x))$l=this.getEles($x,$I,$R._tEleArr),this.sendEvents($l,"mouseover",$z);else if($x.contains($I))$l=this.getEles($I,$x,$R._tEleArr),this.sendEvents($l,"mouseout",$z);else{var $$,$w;($l=$R._tEleArr).length=0,$$=this.getEles($I,null,$R._oldArr),$w=this.getEles($x,null,$R._newArr),$a=$$.length;var $i=0;for($n=0;$n<$a;$n++){if($k=$$[$n],0<=($i=$w.indexOf($k))){$w.splice($i,$w.length-$i);break}$l.push($k)}0<$l.length&&this.sendEvents($l,"mouseout",$z),0<$w.length&&this.sendEvents($w,"mouseover",$z)}}},$x.onMouseMove=function($x,$I){var $z,$k;this.enable&&(($z=this.getTouchFromArr($I,this.preOvers))?(this.checkMouseOutAndOverOfMove($x,$z.tar),$z.tar=$x,$k=this.getEles($x,null,$R._tEleArr)):($k=this.getEles($x,null,$R._tEleArr),this.sendEvents($k,"mouseover",$I),this.preOvers.push(this.createTouchO($x,$I))),this.sendEvents($k,"mousemove",$I),this._clearTempArrs())},$x.getLastOvers=function(){return($R._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$R._tEleArr):($R._tEleArr.push($v.stage),$R._tEleArr)},$x.stageMouseOut=function(){var $x;$x=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($x,"mouseout",0)},$x.onMouseUp=function($x,$I,$z){if(void 0===$z&&($z=!1),this.enable){var $k,$l,$n,$a,$$,$w,$i=0,$F=0,$b=$W.onMobile;if($l=this.getEles($x,null,$R._tEleArr),this.sendEvents($l,$z?"mouseup":"rightmouseup",$I),$w=$z?this.preDowns:this.preRightDowns,$k=this.getTouchFromArr($I,$w)){var $T,$_=$W.now();if($T=$_-this._lastClickTime<300,this._lastClickTime=$_,$x==$k.tar)$$=$l;else for($n=this.getEles($k.tar,null,$R._oldArr),($$=$R._newArr).length=0,$F=$n.length,$i=0;$i<$F;$i++)$a=$n[$i],0<=$l.indexOf($a)&&$$.push($a);0<$$.length&&this.sendEvents($$,$z?"click":"rightclick",$I),$z&&$T&&this.sendEvents($$,"doubleclick",$I),this.removeTouchFromArr($I,$w),$k.tar=null,$H.recover("TouchData",$k)}else;($k=this.getTouchFromArr($I,this.preOvers))&&$b&&(($$=this.getEles($k.tar,null,$$))&&0<$$.length&&this.sendEvents($$,"mouseout",$I),this.removeTouchFromArr($I,this.preOvers),$k.tar=null,$H.recover("TouchData",$k)),this._clearTempArrs()}},$R._oldArr=[],$R._newArr=[],$R._tEleArr=[],$w($R,["I",function(){return this.I=new $R}]),$R}(),$m=function(){function $x(){this._action=null}$N($x,"laya.filters.Filter");var $I=$x.prototype;return $v.imps($I,{"laya.filters.IFilter":!0}),$I.callNative=function($x){},$F(0,$I,"type",function(){return-1}),$F(0,$I,"action",function(){return this._action}),$x.BLUR=16,$x.COLOR=32,$x.GLOW=8,$x._filterStart=null,$x._filterEnd=null,$x._EndTarget=null,$x._recycleScope=null,$x._filter=null,$x._useSrc=null,$x._endSrc=null,$x._useOut=null,$x._endOut=null,$x}(),$a=function(){function $x(){this.data=null}$N($x,"laya.filters.ColorFilterAction");var $I=$x.prototype;return $v.imps($I,{"laya.filters.IFilterAction":!0}),$I.apply=function($x){var $I=$x.ctx.ctx,$z=$x.ctx.ctx.canvas;if(0==$z.width||0==$z.height)return $z;for(var $k,$l=$I.getImageData(0,0,$z.width,$z.height),$n=$l.data,$a=0,$$=$n.length;$a<$$;$a+=4)$k=this.getColor($n[$a],$n[$a+1],$n[$a+2],$n[$a+3]),0!=$n[$a+3]&&($n[$a]=$k[0],$n[$a+1]=$k[1],$n[$a+2]=$k[2],$n[$a+3]=$k[3]);return $I.putImageData($l,0,0),$x},$I.getColor=function($x,$I,$z,$k){var $l=[];if(this.data._mat&&this.data._alpha){var $n=this.data._mat,$a=this.data._alpha;$l[0]=$n[0]*$x+$n[1]*$I+$n[2]*$z+$n[3]*$k+$a[0],$l[1]=$n[4]*$x+$n[5]*$I+$n[6]*$z+$n[7]*$k+$a[1],$l[2]=$n[8]*$x+$n[9]*$I+$n[10]*$z+$n[11]*$k+$a[2],$l[3]=$n[12]*$x+$n[13]*$I+$n[14]*$z+$n[15]*$k+$a[3]}return $l},$x}(),$y=(function(){function $x(){}$N($x,"laya.maths.Arith"),$x.formatR=function($x){return $x>Math.PI&&($x-=2*Math.PI),$x<-Math.PI&&($x+=2*Math.PI),$x},$x.isPOT=function($x,$I){return 0<$x&&0==($x&$x-1)&&0<$I&&0==($I&$I-1)},$x.setMatToArray=function($x,$I){$x.a,$x.b,$x.c,$x.d,$x.tx,$x.ty,$I[0]=$x.a,$I[1]=$x.b,$I[4]=$x.c,$I[5]=$x.d,$I[12]=$x.tx,$I[13]=$x.ty}}(),function(){function $x(){this._controlPoints=[new $L,new $L,new $L],this._calFun=this.getPoint2}$N($x,"laya.maths.Bezier");var $I=$x.prototype;return $I._switchPoint=function($x,$I){var $z=this._controlPoints.shift();$z.setTo($x,$I),this._controlPoints.push($z)},$I.getPoint2=function($x,$I){var $z=this._controlPoints[0],$k=this._controlPoints[1],$l=this._controlPoints[2],$n=Math.pow(1-$x,2)*$z.x+2*$x*(1-$x)*$k.x+Math.pow($x,2)*$l.x,$a=Math.pow(1-$x,2)*$z.y+2*$x*(1-$x)*$k.y+Math.pow($x,2)*$l.y;$I.push($n,$a)},$I.getPoint3=function($x,$I){var $z=this._controlPoints[0],$k=this._controlPoints[1],$l=this._controlPoints[2],$n=this._controlPoints[3],$a=Math.pow(1-$x,3)*$z.x+3*$k.x*$x*(1-$x)*(1-$x)+3*$l.x*$x*$x*(1-$x)+$n.x*Math.pow($x,3),$$=Math.pow(1-$x,3)*$z.y+3*$k.y*$x*(1-$x)*(1-$x)+3*$l.y*$x*$x*(1-$x)+$n.y*Math.pow($x,3);$I.push($a,$$)},$I.insertPoints=function($x,$I){var $z,$k=NaN;for($z=1/($x=0<$x?$x:5),$k=0;$k<=1;$k+=$z)this._calFun($k,$I)},$I.getBezierPoints=function($x,$I,$z){void 0===$I&&($I=5),void 0===$z&&($z=2);var $k,$l,$n=0;if(($k=$x.length)<2*($z+1))return[];switch($l=[],$z){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$z;)this._controlPoints.push(new $L);for($n=0;$n<2*$z;$n+=2)this._switchPoint($x[$n],$x[$n+1]);for($n=2*$z;$n<$k;$n+=2)this._switchPoint($x[$n],$x[$n+1]),$n/2%$z==0&&this.insertPoints($I,$l);return $l},$w($x,["I",function(){return this.I=new $x}]),$x}()),$C=function(){function $i(){}return $N($i,"laya.maths.GrahamScan"),$i.multiply=function($x,$I,$z){return($x.x-$z.x)*($I.y-$z.y)-($I.x-$z.x)*($x.y-$z.y)},$i.dis=function($x,$I){return($x.x-$I.x)*($x.x-$I.x)+($x.y-$I.y)*($x.y-$I.y)},$i._getPoints=function($x,$I,$z){for(void 0===$I&&($I=!1),$i._mPointList||($i._mPointList=[]);$i._mPointList.length<$x;)$i._mPointList.push(new $L);return $z||($z=[]),$z.length=0,$I?$i.getFrom($z,$i._mPointList,$x):$i.getFromR($z,$i._mPointList,$x),$z},$i.getFrom=function($x,$I,$z){var $k=0;for($k=0;$k<$z;$k++)$x.push($I[$k]);return $x},$i.getFromR=function($x,$I,$z){var $k=0;for($k=0;$k<$z;$k++)$x.push($I.pop());return $x},$i.pListToPointList=function($x,$I){void 0===$I&&($I=!1);var $z=0,$k=$x.length/2,$l=$i._getPoints($k,$I,$i._tempPointList);for($z=0;$z<$k;$z++)$l[$z].setTo($x[$z+$z],$x[$z+$z+1]);return $l},$i.pointListToPlist=function($x){var $I,$z=0,$k=$x.length,$l=$i._temPList;for($z=$l.length=0;$z<$k;$z++)$I=$x[$z],$l.push($I.x,$I.y);return $l},$i.scanPList=function($x){return $g.copyArray($x,$i.pointListToPlist($i.scan($i.pListToPointList($x,!0))))},$i.scan=function($x){var $I,$z,$k,$l=0,$n=0,$a=0,$$=$x.length,$w={};for(($z=$i._temArr).length=0,$l=($$=$x.length)-1;0<=$l;$l--)$k=($I=$x[$l]).x+"_"+$I.y,$w.hasOwnProperty($k)||($w[$k]=!0,$z.push($I));for($$=$z.length,$g.copyArray($x,$z),$l=1;$l<$$;$l++)($x[$l].y<$x[$a].y||$x[$l].y==$x[$a].y&&$x[$l].x<$x[$a].x)&&($a=$l);for($I=$x[0],$x[0]=$x[$a],$x[$a]=$I,$l=1;$l<$$-1;$l++){for($n=($a=$l)+1;$n<$$;$n++)(0<$i.multiply($x[$n],$x[$a],$x[0])||0==$i.multiply($x[$n],$x[$a],$x[0])&&$i.dis($x[0],$x[$n])<$i.dis($x[0],$x[$a]))&&($a=$n);$I=$x[$l],$x[$l]=$x[$a],$x[$a]=$I}if(($z=$i._temArr).length=0,$x.length<3)return $g.copyArray($z,$x);for($z.push($x[0],$x[1],$x[2]),$l=3;$l<$$;$l++){for(;2<=$z.length&&0<=$i.multiply($x[$l],$z[$z.length-1],$z[$z.length-2]);)$z.pop();$x[$l]&&$z.push($x[$l])}return $z},$i._mPointList=null,$i._tempPointList=[],$i._temPList=[],$i._temArr=[],$i}(),$P=function(){function $l(){}return $N($l,"laya.maths.MathUtil"),$l.subtractVector3=function($x,$I,$z){$z[0]=$x[0]-$I[0],$z[1]=$x[1]-$I[1],$z[2]=$x[2]-$I[2]},$l.lerp=function($x,$I,$z){return $x*(1-$z)+$I*$z},$l.scaleVector3=function($x,$I,$z){$z[0]=$x[0]*$I,$z[1]=$x[1]*$I,$z[2]=$x[2]*$I},$l.lerpVector3=function($x,$I,$z,$k){var $l=$x[0],$n=$x[1],$a=$x[2];$k[0]=$l+$z*($I[0]-$l),$k[1]=$n+$z*($I[1]-$n),$k[2]=$a+$z*($I[2]-$a)},$l.lerpVector4=function($x,$I,$z,$k){var $l=$x[0],$n=$x[1],$a=$x[2],$$=$x[3];$k[0]=$l+$z*($I[0]-$l),$k[1]=$n+$z*($I[1]-$n),$k[2]=$a+$z*($I[2]-$a),$k[3]=$$+$z*($I[3]-$$)},$l.slerpQuaternionArray=function($x,$I,$z,$k,$l,$n,$a){var $$,$w,$i,$F,$b,$T=$x[$I+0],$_=$x[$I+1],$R=$x[$I+2],$s=$x[$I+3],$N=$z[$k+0],$D=$z[$k+1],$f=$z[$k+2],$m=$z[$k+3];return($w=$T*$N+$_*$D+$R*$f+$s*$m)<0&&($w=-$w,$N=-$N,$D=-$D,$f=-$f,$m=-$m),$b=1e-6<1-$w?($$=Math.acos($w),$i=Math.sin($$),$F=Math.sin((1-$l)*$$)/$i,Math.sin($l*$$)/$i):($F=1-$l,$l),$n[$a+0]=$F*$T+$b*$N,$n[$a+1]=$F*$_+$b*$D,$n[$a+2]=$F*$R+$b*$f,$n[$a+3]=$F*$s+$b*$m,$n},$l.getRotation=function($x,$I,$z,$k){return Math.atan2($k-$I,$z-$x)/Math.PI*180},$l.sortBigFirst=function($x,$I){return $x==$I?0:$x<$I?1:-1},$l.sortSmallFirst=function($x,$I){return $x==$I?0:$x<$I?-1:1},$l.sortNumBigFirst=function($x,$I){return parseFloat($I)-parseFloat($x)},$l.sortNumSmallFirst=function($x,$I){return parseFloat($x)-parseFloat($I)},$l.sortByKey=function($z,$x,$I){var $k;return void 0===$x&&($x=!1),void 0===$I&&($I=!0),$k=$x?$I?$l.sortNumBigFirst:$l.sortBigFirst:$I?$l.sortNumSmallFirst:$l.sortSmallFirst,function($x,$I){return $k($x[$z],$I[$z])}},$l}(),$U=function(){function $z($x,$I,$z,$k,$l,$n){this.inPool=!1,this.bTransform=!1,void 0===$x&&($x=1),void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=1),void 0===$l&&($l=0),void 0===$n&&($n=0),this.a=$x,this.b=$I,this.c=$z,this.d=$k,this.tx=$l,this.ty=$n,this._checkTransform()}$N($z,"laya.maths.Matrix");var $x=$z.prototype;return $x.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$x._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$x.setTranslate=function($x,$I){return this.tx=$x,this.ty=$I,this},$x.translate=function($x,$I){return this.tx+=$x,this.ty+=$I,this},$x.scale=function($x,$I){this.a*=$x,this.d*=$I,this.c*=$x,this.b*=$I,this.tx*=$x,this.ty*=$I,this.bTransform=!0},$x.rotate=function($x){var $I=Math.cos($x),$z=Math.sin($x),$k=this.a,$l=this.c,$n=this.tx;this.a=$k*$I-this.b*$z,this.b=$k*$z+this.b*$I,this.c=$l*$I-this.d*$z,this.d=$l*$z+this.d*$I,this.tx=$n*$I-this.ty*$z,this.ty=$n*$z+this.ty*$I,this.bTransform=!0},$x.skew=function($x,$I){var $z=Math.tan($x),$k=Math.tan($I),$l=this.a,$n=this.b;return this.a+=$k*this.c,this.b+=$k*this.d,this.c+=$z*$l,this.d+=$z*$n,this},$x.invertTransformPoint=function($x){var $I=this.a,$z=this.b,$k=this.c,$l=this.d,$n=this.tx,$a=$I*$l-$z*$k,$$=$l/$a,$w=-$z/$a,$i=-$k/$a,$F=$I/$a,$b=($k*this.ty-$l*$n)/$a,$T=-($I*this.ty-$z*$n)/$a;return $x.setTo($$*$x.x+$i*$x.y+$b,$w*$x.x+$F*$x.y+$T)},$x.transformPoint=function($x){return $x.setTo(this.a*$x.x+this.c*$x.y+this.tx,this.b*$x.x+this.d*$x.y+this.ty)},$x.transformPointN=function($x){return $x.setTo(this.a*$x.x+this.c*$x.y,this.b*$x.x+this.d*$x.y)},$x.transformPointArray=function($x,$I){for(var $z=$x.length,$k=0;$k<$z;$k+=2){var $l=$x[$k],$n=$x[$k+1];$I[$k]=this.a*$l+this.c*$n+this.tx,$I[$k+1]=this.b*$l+this.d*$n+this.ty}return $I},$x.transformPointArrayScale=function($x,$I){for(var $z=$x.length,$k=0;$k<$z;$k+=2){var $l=$x[$k],$n=$x[$k+1];$I[$k]=this.a*$l+this.c*$n,$I[$k+1]=this.b*$l+this.d*$n}return $I},$x.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$x.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$x.invert=function(){var $x=this.a,$I=this.b,$z=this.c,$k=this.d,$l=this.tx,$n=$x*$k-$I*$z;return this.a=$k/$n,this.b=-$I/$n,this.c=-$z/$n,this.d=$x/$n,this.tx=($z*this.ty-$k*$l)/$n,this.ty=-($x*this.ty-$I*$l)/$n,this},$x.setTo=function($x,$I,$z,$k,$l,$n){return this.a=$x,this.b=$I,this.c=$z,this.d=$k,this.tx=$l,this.ty=$n,this},$x.concat=function($x){var $I=this.a,$z=this.c,$k=this.tx;return this.a=$I*$x.a+this.b*$x.c,this.b=$I*$x.b+this.b*$x.d,this.c=$z*$x.a+this.d*$x.c,this.d=$z*$x.b+this.d*$x.d,this.tx=$k*$x.a+this.ty*$x.c+$x.tx,this.ty=$k*$x.b+this.ty*$x.d+$x.ty,this},$x.scaleEx=function($x,$I){var $z=this.a,$k=this.b,$l=this.c,$n=this.d;0!==$k||0!==$l?(this.a=$x*$z,this.b=$x*$k,this.c=$I*$l):(this.a=$x*$z,this.b=0*$n,this.c=0*$z),this.d=$I*$n,this.bTransform=!0},$x.rotateEx=function($x){var $I=Math.cos($x),$z=Math.sin($x),$k=this.a,$l=this.b,$n=this.c,$a=this.d;0!==$l||0!==$n?(this.a=$I*$k+$z*$n,this.b=$I*$l+$z*$a,this.c=-$z*$k+$I*$n,this.d=-$z*$l+$I*$a):(this.a=$I*$k,this.b=$z*$a,this.c=-$z*$k,this.d=$I*$a),this.bTransform=!0},$x.clone=function(){var $x=$z.create();return $x.a=this.a,$x.b=this.b,$x.c=this.c,$x.d=this.d,$x.tx=this.tx,$x.ty=this.ty,$x.bTransform=this.bTransform,$x},$x.copyTo=function($x){return $x.a=this.a,$x.b=this.b,$x.c=this.c,$x.d=this.d,$x.tx=this.tx,$x.ty=this.ty,$x.bTransform=this.bTransform,$x},$x.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$x.destroy=function(){if(!this.inPool){var $x=$z._cache;this.inPool=!0,$x._length||($x._length=0),($x[$x._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$z.mul=function($x,$I,$z){var $k=$x.a,$l=$x.b,$n=$x.c,$a=$x.d,$$=$x.tx,$w=$x.ty,$i=$I.a,$F=$I.b,$b=$I.c,$T=$I.d,$_=$I.tx,$R=$I.ty;return 0!==$F||0!==$b?($z.a=$k*$i+$l*$b,$z.b=$k*$F+$l*$T,$z.c=$n*$i+$a*$b,$z.d=$n*$F+$a*$T,$z.tx=$i*$$+$b*$w+$_,$z.ty=$F*$$+$T*$w+$R):($z.a=$k*$i,$z.b=$l*$T,$z.c=$n*$i,$z.d=$a*$T,$z.tx=$i*$$+$_,$z.ty=$T*$w+$R),$z},$z.mul16=function($x,$I,$z){var $k=$x.a,$l=$x.b,$n=$x.c,$a=$x.d,$$=$x.tx,$w=$x.ty,$i=$I.a,$F=$I.b,$b=$I.c,$T=$I.d,$_=$I.tx,$R=$I.ty;return 0!==$F||0!==$b?($z[0]=$k*$i+$l*$b,$z[1]=$k*$F+$l*$T,$z[4]=$n*$i+$a*$b,$z[5]=$n*$F+$a*$T,$z[12]=$i*$$+$b*$w+$_,$z[13]=$F*$$+$T*$w+$R):($z[0]=$k*$i,$z[1]=$l*$T,$z[4]=$n*$i,$z[5]=$a*$T,$z[12]=$i*$$+$_,$z[13]=$T*$w+$R),$z},$z.mulPre=function($x,$I,$z,$k,$l,$n,$a,$$){var $w=$x.a,$i=$x.b,$F=$x.c,$b=$x.d,$T=$x.tx,$_=$x.ty;return 0!==$z||0!==$k?($$.a=$w*$I+$i*$k,$$.b=$w*$z+$i*$l,$$.c=$F*$I+$b*$k,$$.d=$F*$z+$b*$l,$$.tx=$I*$T+$k*$_+$n,$$.ty=$z*$T+$l*$_+$a):($$.a=$w*$I,$$.b=$i*$l,$$.c=$F*$I,$$.d=$b*$l,$$.tx=$I*$T+$n,$$.ty=$l*$_+$a),$$},$z.mulPos=function($x,$I,$z,$k,$l,$n,$a,$$){var $w=$x.a,$i=$x.b,$F=$x.c,$b=$x.d,$T=$x.tx,$_=$x.ty;return 0!==$i||0!==$F?($$.a=$I*$w+$z*$F,$$.b=$I*$i+$z*$b,$$.c=$k*$w+$l*$F,$$.d=$k*$i+$l*$b,$$.tx=$w*$n+$F*$a+$T,$$.ty=$i*$n+$b*$a+$_):($$.a=$I*$w,$$.b=$z*$b,$$.c=$k*$w,$$.d=$l*$b,$$.tx=$w*$n+$T,$$.ty=$b*$a+$_),$$},$z.preMul=function($x,$I,$z){var $k=$x.a,$l=$x.b,$n=$x.c,$a=$x.d,$$=$I.a,$w=$I.b,$i=$I.c,$F=$I.d,$b=$I.tx,$T=$I.ty;return $z.a=$$*$k,$z.b=$z.c=0,$z.d=$F*$a,$z.tx=$b*$k+$x.tx,$z.ty=$T*$a+$x.ty,0===$w&&0===$i&&0===$l&&0===$n||($z.a+=$w*$n,$z.d+=$i*$l,$z.b+=$$*$l+$w*$a,$z.c+=$i*$k+$F*$n,$z.tx+=$T*$n,$z.ty+=$b*$l),$z},$z.preMulXY=function($x,$I,$z,$k){var $l=$x.a,$n=$x.b,$a=$x.c,$$=$x.d;return $k.a=$l,$k.b=$n,$k.c=$a,$k.d=$$,$k.tx=$I*$l+$x.tx+$z*$a,$k.ty=$z*$$+$x.ty+$I*$n,$k},$z.create=function(){var $x=$z._cache,$I=$x._length?$x[--$x._length]:new $z;return $I.inPool=!1,$I},$z.EMPTY=new $z,$z.TEMP=new $z,$z._cache=[],$z}(),$L=function(){function $x($x,$I){void 0===$x&&($x=0),void 0===$I&&($I=0),this.x=$x,this.y=$I}$N($x,"laya.maths.Point");var $I=$x.prototype;return $I.setTo=function($x,$I){return this.x=$x,this.y=$I,this},$I.distance=function($x,$I){return Math.sqrt((this.x-$x)*(this.x-$x)+(this.y-$I)*(this.y-$I))},$I.toString=function(){return this.x+","+this.y},$I.normalize=function(){var $x=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$x){var $I=1/$x;this.x*=$I,this.y*=$I}},$x.TEMP=new $x,$x.EMPTY=new $x,$x}(),$K=function(){function $i($x,$I,$z,$k){void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=0),this.x=$x,this.y=$I,this.width=$z,this.height=$k}$N($i,"laya.maths.Rectangle");var $x=$i.prototype;return $x.setTo=function($x,$I,$z,$k){return this.x=$x,this.y=$I,this.width=$z,this.height=$k,this},$x.copyFrom=function($x){return this.x=$x.x,this.y=$x.y,this.width=$x.width,this.height=$x.height,this},$x.contains=function($x,$I){return!(this.width<=0||this.height<=0)&&($x>=this.x&&$x<this.right&&$I>=this.y&&$I<this.bottom)},$x.intersects=function($x){return!($x.x>this.x+this.width||$x.x+$x.width<this.x||$x.y>this.y+this.height||$x.y+$x.height<this.y)},$x.intersection=function($x,$I){return this.intersects($x)?($I||($I=new $i),$I.x=Math.max(this.x,$x.x),$I.y=Math.max(this.y,$x.y),$I.width=Math.min(this.right,$x.right)-$I.x,$I.height=Math.min(this.bottom,$x.bottom)-$I.y,$I):null},$x.union=function($x,$I){return $I||($I=new $i),this.clone($I),$x.width<=0||$x.height<=0?$I:($I.addPoint($x.x,$x.y),$I.addPoint($x.right,$x.bottom),this)},$x.clone=function($x){return $x||($x=new $i),$x.x=this.x,$x.y=this.y,$x.width=this.width,$x.height=this.height,$x},$x.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$x.equals=function($x){return!(!$x||$x.x!==this.x||$x.y!==this.y||$x.width!==this.width||$x.height!==this.height)},$x.addPoint=function($x,$I){return this.x>$x&&(this.width+=this.x-$x,this.x=$x),this.y>$I&&(this.height+=this.y-$I,this.y=$I),this.width<$x-this.x&&(this.width=$x-this.x),this.height<$I-this.y&&(this.height=$I-this.y),this},$x._getBoundPoints=function(){var $x=$i._temB;return($x.length=0)==this.width||0==this.height||$x.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$x},$x.isEmpty=function(){return this.width<=0||this.height<=0},$F(0,$x,"right",function(){return this.x+this.width}),$F(0,$x,"bottom",function(){return this.y+this.height}),$i._getBoundPointS=function($x,$I,$z,$k){var $l=$i._temA;return($l.length=0)==$z||0==$k||$l.push($x,$I,$x+$z,$I,$x,$I+$k,$x+$z,$I+$k),$l},$i._getWrapRec=function($x,$I){if(!$x||$x.length<1)return $I?$I.setTo(0,0,0,0):$i.TEMP.setTo(0,0,0,0);$I=$I||new $i;var $z,$k,$l,$n,$a,$$=$x.length,$w=$L.TEMP;for($l=$a=-($k=$n=99999),$z=0;$z<$$;$z+=2)$w.x=$x[$z],$w.y=$x[$z+1],$k=$k<$w.x?$k:$w.x,$n=$n<$w.y?$n:$w.y,$l=$l>$w.x?$l:$w.x,$a=$a>$w.y?$a:$w.y;return $I.setTo($k,$n,$l-$k,$a-$n)},$i.EMPTY=new $i,$i.TEMP=new $i,$i._temB=[],$i._temA=[],$i}(),$S=function(){function $w(){}return $N($w,"laya.media.SoundManager"),$F(1,$w,"useAudioMusic",function(){return $w._useAudioMusic},function($x){$w._useAudioMusic=$x,$w._musicClass=$x?$zx:null}),$F(1,$w,"autoStopMusic",function(){return $w._autoStopMusic},function($x){$v.stage.off("blur",null,$w._stageOnBlur),$v.stage.off("focus",null,$w._stageOnFocus),$v.stage.off("visibilitychange",null,$w._visibilityChange),($w._autoStopMusic=$x)&&($v.stage.on("blur",null,$w._stageOnBlur),$v.stage.on("focus",null,$w._stageOnFocus),$v.stage.on("visibilitychange",null,$w._visibilityChange))}),$F(1,$w,"muted",function(){return $w._muted},function($x){$x!=$w._muted&&($x&&$w.stopAllSound(),$w.musicMuted=$x,$w._muted=$x)}),$F(1,$w,"musicMuted",function(){return $w._musicMuted},function($x){$x!=$w._musicMuted&&($x?($w._tMusic&&$w._musicChannel&&!$w._musicChannel.isStopped?$w._musicChannel.pause():$w._musicChannel=null,$w._musicMuted=$x):($w._musicMuted=$x,$w._tMusic&&$w._musicChannel&&$w._musicChannel.resume()))}),$F(1,$w,"soundMuted",function(){return $w._soundMuted},function($x){$w._soundMuted=$x}),$w.addChannel=function($x){0<=$w._channels.indexOf($x)||($w._channels.push($x),$w.autoReleaseSound&&0!=$w._notUsedCount&&$w._notUsedUrls[$x.url]&&(delete $w._notUsedUrls[$x.url],0==--$w._notUsedCount&&$v.timer.clear($w,$w.disposeSoundIfNotUsed)))},$w.removeChannel=function($x){var $I=$w._channels,$z=$I.indexOf($x);if(-1!=$z&&($I.splice($z,1),$w.autoReleaseSound)){var $k=$x.url,$l=$w.defaultIntervals[$k]||2e4;if(0<$l){var $n=!0;for($z=$I.length-1;0<=$z;$z--)if($I[$z].url==$k){$n=!1;break}$n&&($w._notUsedUrls[$k]=Date.now()+$l,0==$w._notUsedCount++&&$v.timer.loop(1e4,$w,$w.disposeSoundIfNotUsed))}}},$w.disposeSoundIfNotUsed=function(){var $x=$w._notUsedUrls;if(0!=$w._notUsedCount){var $I=Date.now();for(var $z in $x)$I>=$x[$z]&&(delete $x[$z],--$w._notUsedCount,$w.destroySound($z));if(0!=$w._notUsedCount)return}$v.timer.clear($w,$w.disposeSoundIfNotUsed)},$w._visibilityChange=function(){$v.stage.isVisibility?$w._stageOnFocus():$w._stageOnBlur()},$w._stageOnBlur=function(){$w._isActive=!1,$w._musicChannel&&($w._musicChannel.isStopped||($w._blurPaused=!0,$w._musicChannel.pause())),$w.stopAllSound(),$v.stage.once("mousedown",null,$w._stageOnFocus)},$w._recoverWebAudio=function(){$nx.ctx&&"running"!=$nx.ctx.state&&$nx.ctx.resume&&$nx.ctx.resume()},$w._stageOnFocus=function(){if($w._isActive=!0,$w._recoverWebAudio(),$v.stage.off("mousedown",null,$w._stageOnFocus),$w._blurPaused){var $x=$w._musicChannel;$x&&$w._music&&$x.isStopped&&($w._blurPaused=!1,$w._music._disposed?$w.playMusic($x.url,$x.loops,$x.startHandler,$x.completeHandler,$x.startTime):$x.audioBuffer?$x.resume():$w._music.play($x.startTime,$x.loops,$x.startHandler,$x))}},$w.playSound=function($x,$I,$z,$k,$l,$n){if(void 0===$I&&($I=1),void 0===$n&&($n=0),!$x)return null;if($w._muted)return null;if($w._recoverWebAudio(),$x==$w._tMusic){if($w._musicMuted)return null}else{if(!$w._isActive)return null;if($w._soundMuted)return null}var $a,$$=$w._pool[$x];return $l||($l=$w._soundClass),$$||(($$=new $l).load($x),$w._pool[$x]=$$),($a=$$.play($n,$I,$z))?($x==$w._tMusic&&($w._music=$$,$w._isActive||($w._blurPaused=!0,$a.pause())),$a.url=$x,$a.volume=$x==$w._tMusic?$w.musicVolume:$w.soundVolume,$a.completeHandler=$k,$a):null},$w.destroySound=function($x){var $I=$w._pool[$x];$I&&(delete $w._pool[$x],$I.dispose())},$w.playMusic=function($x,$I,$z,$k,$l){return void 0===$I&&($I=0),void 0===$l&&($l=0),$w._tMusic=$x,$w._musicChannel&&$w._musicChannel.stop(),$w._musicChannel=$w.playSound($x,$I,$z,$k,null,$l)},$w.stopSound=function($x){for(var $I,$z=$w._channels.length-1;0<=$z;$z--)($I=$w._channels[$z]).url==$x&&$I.stop()},$w.stopAll=function(){$w._tMusic=null;var $x=0;for($x=$w._channels.length-1;0<=$x;$x--)$w._channels[$x].stop()},$w.stopAllSound=function(){var $x,$I=0;for($I=$w._channels.length-1;0<=$I;$I--)($x=$w._channels[$I]).url!=$w._tMusic&&$x.stop()},$w.stopMusic=function(){$w._musicChannel&&$w._musicChannel.stop(),$w._tMusic=null},$w.setSoundVolume=function($x,$I){if($I)$w._setVolume($I,$x);else{$w.soundVolume=$x;var $z,$k=0;for($k=$w._channels.length-1;0<=$k;$k--)($z=$w._channels[$k]).url!=$w._tMusic&&($z.volume=$x)}},$w.setMusicVolume=function($x){$w.musicVolume=$x,$w._setVolume($w._tMusic,$x)},$w._setVolume=function($x,$I){for(var $z,$k=$w._channels.length-1;0<=$k;$k--)($z=$w._channels[$k]).url==$x&&($z.volume=$I)},$w.musicVolume=1,$w.soundVolume=1,$w.playbackRate=1,$w._useAudioMusic=!0,$w._muted=!1,$w._soundMuted=!1,$w._musicMuted=!1,$w._tMusic=null,$w._musicChannel=null,$w._music=null,$w._channels=[],$w._autoStopMusic=!1,$w._blurPaused=!1,$w._isActive=!0,$w._soundClass=null,$w._musicClass=null,$w.autoReleaseSound=!0,$w._pool={},$w.defaultIntervals={},$w._notUsedUrls={},$w._notUsedCount=0,$w}(),$E=function(){var $x;function $z(){}return $N($z,"laya.net.LocalStorage"),$z.__init__=function(){$z._baseClass||($z._baseClass=$x).init(),$z.items=$z._baseClass.items,$z.support=$z._baseClass.support},$z.setItem=function($x,$I){$z._baseClass.setItem($x,$I)},$z.getItem=function($x){return $z._baseClass.getItem($x)},$z.setJSON=function($x,$I){$z._baseClass.setJSON($x,$I)},$z.getJSON=function($x){return $z._baseClass.getJSON($x)},$z.removeItem=function($x){$z._baseClass.removeItem($x)},$z.clear=function(){$z._baseClass.clear()},$z._baseClass=null,$z.items=null,$z.support=!1,$z.__init$=function(){$x=function(){function $z(){}return $N($z,""),$z.init=function(){try{$z.support=!0,$z.items=$_.localStorage,$z.setItem("laya","1"),$z.removeItem("laya")}catch($x){$z.support=!1}$z.support||console.log("LocalStorage is not supprot or browser is private mode.")},$z.setItem=function($x,$I){try{$z.support&&$z.items.setItem($x,$I)}catch($x){console.warn("set localStorage failed",$x)}},$z.getItem=function($x){return $z.support?$z.items.getItem($x):null},$z.setJSON=function($x,$I){try{$z.support&&$z.items.setItem($x,JSON.stringify($I))}catch($x){console.warn("set localStorage failed",$x)}},$z.getJSON=function($x){return JSON.parse($z.support?$z.items.getItem($x):null)},$z.removeItem=function($x){$z.support&&$z.items.removeItem($x)},$z.clear=function(){$z.support&&$z.items.clear()},$z.items=null,$z.support=!1,$z}()},$z}(),$X=(function(){function $k(){}$N($k,"laya.net.ResourceVersion"),$k.enable=function($x,$I,$z){void 0===$z&&($z=2),laya.net.ResourceVersion.type=$z,$v.loader.load($x,$f.create(null,$k.onManifestLoaded,[$I]),null,"json"),$d.customFormat=$k.addVersionPrefix},$k.onManifestLoaded=function($x,$I){$k.manifest=$I,$x.run(),$I||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$k.addVersionPrefix=function($x){return $k.manifest&&$k.manifest[$x]?2==$k.type?$k.manifest[$x]:$k.manifest[$x]+"/"+$x:$x},$k.FOLDER_VERSION=1,$k.FILENAME_VERSION=2,$k.manifest=null,$k.type=1}(),function(){function $x(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$N($x,"laya.net.TTFLoader");var $I=$x.prototype;return $I.load=function($x){var $I=(this._url=$x).split(".ttf")[0].split("/");this.fontName=$I[$I.length-1],$W.window.conch?this._loadConch():$W.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$I._loadConch=function(){this._http=new $ax,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$I._onHttpLoaded=function($x){$W.window.conch.setFontFaceFromBuffer(this.fontName,$x),this._clearHttp(),this._complete()},$I._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$I._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$I._complete=function(){$v.timer.clear(this,this._complete),$v.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$I._checkComplete=function(){$Z.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$I._loadWithFontFace=function(){var $x=new $W.window.FontFace(this.fontName,"url('"+this._url+"')");$W.window.document.fonts.add($x);var $I=this;$x.loaded.then(function(){$I._complete()}),$x.load()},$I._createDiv=function(){this._div=$W.createElement("div"),this._div.innerHTML="laya";var $x=this._div.style;$x.fontFamily=this.fontName,$x.position="absolute",$x.left="-100px",$x.top="-100px",$W.document.body.appendChild(this._div)},$I._loadWithCSS=function(){var $x=this,$I=$W.createElement("style");$I.type="text/css",$W.document.body.appendChild($I),$I.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$Z.measureText("LayaTTFFont",this._fontTxt).width;var $z=this;$I.onload=function(){$v.timer.once(1e4,$z,$x._complete)},$v.timer.loop(20,this,this._checkComplete),this._createDiv()},$x._testString="LayaTTFFont",$x}()),$d=function(){function $k($x){this._url=null,this._path=null,this._url=$k.formatURL($x),this._path=$k.getPath($x)}$N($k,"laya.net.URL");var $x=$k.prototype;return $F(0,$x,"path",function(){return this._path}),$F(0,$x,"url",function(){return this._url}),$k.formatURL=function($x,$I){if(!$x)return"null path";if(0<$x.indexOf(":"))return $x;null!=$k.customFormat&&($x=$k.customFormat($x,$I));var $z=$x.charAt(0);if("."===$z)return $k.formatRelativePath(($I||$k.basePath)+$x);if("~"===$z)return $k.rootPath+$x.substring(1);if("d"===$z){if(0===$x.indexOf("data:image"))return $x}else if("/"===$z)return $x;return($I||$k.basePath)+$x},$k.formatRelativePath=function($x){for(var $I=$x.split("/"),$z=0,$k=$I.length;$z<$k;$z++)".."==$I[$z]&&($I.splice($z-1,2),$z-=2);return $I.join("/")},$k.isAbsolute=function($x){return 0<$x.indexOf(":")||"/"==$x.charAt(0)},$k.getPath=function($x){var $I=$x.lastIndexOf("/");return 0<$I?$x.substr(0,$I+1):""},$k.getFileName=function($x){var $I=$x.lastIndexOf("/");return 0<$I?$x.substr($I+1):$x},$k.version={},$k.basePath="",$k.rootPath="",$k.customFormat=function($x){var $I=$k.version[$x];return!$j.isConchApp&&$I&&($x+="?v="+$I),$x},$k}(),$j=function(){function $l($x,$I){this._timeId=0;var $z=$l._mainCanvas.source.style;$z.position="absolute",$z.top=$z.left="0px",$z.background="#000000",$l._mainCanvas.source.id="layaCanvas";var $k=laya.renders.Render.isWebGL;$l._mainCanvas.source.width=$x,$l._mainCanvas.source.height=$I,$k&&$l.WebGL.init($l._mainCanvas,$x,$I),$W.container.appendChild($l._mainCanvas.source),($l._context=new $t($x,$I,$k?null:$l._mainCanvas)).ctx.setIsMainContext(),$W.window.requestAnimationFrame(function $x($I){$W.window.requestAnimationFrame($x);$v.stage._loop($I)}),$v.stage.on("visibilitychange",this,this._onVisibilitychange)}$N($l,"laya.renders.Render");var $x=$l.prototype;return $x._onVisibilitychange=function(){$v.stage.isVisibility?0!=this._timeId&&$W.window.clearInterval(this._timeId):this._timeId=$W.window.setInterval(this._enterFrame,1e3)},$x._enterFrame=function($x){$v.stage._loop(0)},$F(1,$l,"context",function(){return $l._context}),$F(1,$l,"canvas",function(){return $l._mainCanvas.source}),$l._context=null,$l._mainCanvas=null,$l.WebGL=null,$l.isConchNode=!1,$l.isConchApp=!1,$l.isConchWebGL=!1,$l.isWebGL=!1,$l.is3DMode=!1,$l.optimizeTextureMemory=function($x,$I){return!0},$l.__init$=function(){$_.ConchRenderType=$_.ConchRenderType||1,$_.ConchRenderType|=$_.conch?4:0,$l.isConchNode=5==(5&$_.ConchRenderType),$l.isConchApp=4==(4&$_.ConchRenderType),$l.isConchWebGL=6==$_.ConchRenderType},$l}(),$t=function(){function $a($x,$I,$z){this.x=0,this.y=0,this._drawTexture=function($x,$I,$z){$z[0].loaded&&this.ctx.drawTexture($z[0],$z[1],$z[2],$z[3],$z[4],$x,$I)},this._fillTexture=function($x,$I,$z){$z[0].loaded&&this.ctx.fillTexture($z[0],$z[1]+$x,$z[2]+$I,$z[3],$z[4],$z[5],$z[6],$z[7])},this._drawTextureWithTransform=function($x,$I,$z){$z[0].loaded&&this.ctx.drawTextureWithTransform($z[0],$z[1],$z[2],$z[3],$z[4],$z[5],$x,$I,$z[6])},this._fillQuadrangle=function($x,$I,$z){this.ctx.fillQuadrangle($z[0],$z[1],$z[2],$z[3],$z[4])},this._drawRect=function($x,$I,$z){var $k=this.ctx;null!=$z[4]&&($k.fillStyle=$z[4],$k.fillRect($x+$z[0],$I+$z[1],$z[2],$z[3],null)),null!=$z[5]&&($k.strokeStyle=$z[5],$k.lineWidth=$z[6],$k.strokeRect($x+$z[0],$I+$z[1],$z[2],$z[3],$z[6]))},this._drawPie=function($x,$I,$z){var $k=this.ctx;$j.isWebGL&&$k.setPathId($z[8]),$k.beginPath(),$j.isWebGL?($k.movePath($z[0]+$x,$z[1]+$I),$k.moveTo(0,0)):$k.moveTo($x+$z[0],$I+$z[1]),$k.arc($x+$z[0],$I+$z[1],$z[2],$z[3],$z[4]),$k.closePath(),this._fillAndStroke($z[5],$z[6],$z[7],!0)},this._clipRect=function($x,$I,$z){this.ctx.clipRect($x+$z[0],$I+$z[1],$z[2],$z[3])},this._fillRect=function($x,$I,$z){this.ctx.fillRect($x+$z[0],$I+$z[1],$z[2],$z[3],$z[4])},this._drawCircle=function($x,$I,$z){var $k=this.ctx;$j.isWebGL&&$k.setPathId($z[6]),$p.drawCall++,$k.beginPath(),$j.isWebGL&&$k.movePath($z[0]+$x,$z[1]+$I),$k.arc($z[0]+$x,$z[1]+$I,$z[2],0,$a.PI2),$k.closePath(),this._fillAndStroke($z[3],$z[4],$z[5],!0)},this._fillCircle=function($x,$I,$z){$p.drawCall++;var $k=this.ctx;$k.beginPath(),$k.fillStyle=$z[3],$k.arc($z[0]+$x,$z[1]+$I,$z[2],0,$a.PI2),$k.fill()},this._setShader=function($x,$I,$z){this.ctx.setShader($z[0])},this._drawLine=function($x,$I,$z){var $k=this.ctx;$j.isWebGL&&$k.setPathId($z[6]),$k.beginPath(),$k.strokeStyle=$z[4],$k.lineWidth=$z[5],$j.isWebGL?($k.movePath($x,$I),$k.moveTo($z[0],$z[1]),$k.lineTo($z[2],$z[3])):($k.moveTo($x+$z[0],$I+$z[1]),$k.lineTo($x+$z[2],$I+$z[3])),$k.stroke()},this._drawLines=function($x,$I,$z){var $k=this.ctx;$j.isWebGL&&$k.setPathId($z[5]),$k.beginPath(),$x+=$z[0],$I+=$z[1],$j.isWebGL&&$k.movePath($x,$I),$k.strokeStyle=$z[3],$k.lineWidth=$z[4];var $l=$z[2],$n=2,$a=$l.length;if($j.isWebGL)for($k.moveTo($l[0],$l[1]);$n<$a;)$k.lineTo($l[$n++],$l[$n++]);else for($k.moveTo($x+$l[0],$I+$l[1]);$n<$a;)$k.lineTo($x+$l[$n++],$I+$l[$n++]);$k.stroke()},this._drawLinesWebGL=function($x,$I,$z){this.ctx.drawLines($x+this.x+$z[0],$I+this.y+$z[1],$z[2],$z[3],$z[4])},this._drawCurves=function($x,$I,$z){this.ctx.drawCurves($x,$I,$z)},this._draw=function($x,$I,$z){$z[0].call(null,this,$x,$I)},this._transformByMatrix=function($x,$I,$z){this.ctx.transformByMatrix($z[0])},this._setTransform=function($x,$I,$z){this.ctx.setTransform($z[0],$z[1],$z[2],$z[3],$z[4],$z[5])},this._setTransformByMatrix=function($x,$I,$z){this.ctx.setTransformByMatrix($z[0])},this._save=function($x,$I,$z){this.ctx.save()},this._restore=function($x,$I,$z){this.ctx.restore()},this._translate=function($x,$I,$z){this.ctx.translate($z[0],$z[1])},this._transform=function($x,$I,$z){this.ctx.translate($z[1]+$x,$z[2]+$I);var $k=$z[0];this.ctx.transform($k.a,$k.b,$k.c,$k.d,$k.tx,$k.ty),this.ctx.translate(-$x-$z[1],-$I-$z[2])},this._rotate=function($x,$I,$z){this.ctx.translate($z[1]+$x,$z[2]+$I),this.ctx.rotate($z[0]),this.ctx.translate(-$x-$z[1],-$I-$z[2])},this._scale=function($x,$I,$z){this.ctx.translate($z[2]+$x,$z[3]+$I),this.ctx.scale($z[0],$z[1]),this.ctx.translate(-$x-$z[2],-$I-$z[3])},this._alpha=function($x,$I,$z){this.ctx.globalAlpha*=$z[0]},this._setAlpha=function($x,$I,$z){this.ctx.globalAlpha=$z[0]},this._fillText=function($x,$I,$z){this.ctx.fillText($z[0],$z[1]+$x,$z[2]+$I,$z[3],$z[4],$z[5])},this._strokeText=function($x,$I,$z){this.ctx.strokeText($z[0],$z[1]+$x,$z[2]+$I,$z[3],$z[4],$z[5],$z[6])},this._fillBorderText=function($x,$I,$z){this.ctx.fillBorderText($z[0],$z[1]+$x,$z[2]+$I,$z[3],$z[4],$z[5],$z[6],$z[7])},this._blendMode=function($x,$I,$z){this.ctx.globalCompositeOperation=$z[0]},this._beginClip=function($x,$I,$z){this.ctx.beginClip&&this.ctx.beginClip($x+$z[0],$I+$z[1],$z[2],$z[3])},this._setIBVB=function($x,$I,$z){this.ctx.setIBVB($z[0]+$x,$z[1]+$I,$z[2],$z[3],$z[4],$z[5],$z[6],$z[7])},this._fillTrangles=function($x,$I,$z){this.ctx.fillTrangles($z[0],$z[1]+$x,$z[2]+$I,$z[3],$z[4])},this._drawPath=function($x,$I,$z){var $k=this.ctx;$j.isWebGL&&$k.setPathId(-1),$k.beginPath(),$x+=$z[0],$I+=$z[1],$j.isWebGL&&$k.movePath($x,$I);for(var $l=$z[2],$n=0,$a=$l.length;$n<$a;$n++){var $$=$l[$n];switch($$[0]){case"moveTo":$j.isWebGL?$k.moveTo($$[1],$$[2]):$k.moveTo($x+$$[1],$I+$$[2]);break;case"lineTo":$j.isWebGL?$k.lineTo($$[1],$$[2]):$k.lineTo($x+$$[1],$I+$$[2]);break;case"arcTo":$j.isWebGL?$k.arcTo($$[1],$$[2],$$[3],$$[4],$$[5]):$k.arcTo($x+$$[1],$I+$$[2],$x+$$[3],$I+$$[4],$$[5]);break;case"closePath":$k.closePath()}}var $w=$z[3];null!=$w&&($k.fillStyle=$w.fillStyle,$k.fill());var $i=$z[4];null!=$i&&($k.strokeStyle=$i.strokeStyle,$k.lineWidth=$i.lineWidth||1,$k.lineJoin=$i.lineJoin,$k.lineCap=$i.lineCap,$k.miterLimit=$i.miterLimit,$k.stroke())},this.drawPoly=function($x,$I,$z){this.ctx.drawPoly($x+this.x+$z[0],$I+this.y+$z[1],$z[2],$z[3],$z[4],$z[5],$z[6])},this._drawPoly=function($x,$I,$z){var $k=this.ctx,$l=$z[2],$n=2,$a=$l.length;if($j.isWebGL)for($k.setPathId($z[6]),$k.beginPath(),$x+=$z[0],$I+=$z[1],$k.movePath($x,$I),$k.moveTo($l[0],$l[1]);$n<$a;)$k.lineTo($l[$n++],$l[$n++]);else for($k.beginPath(),$x+=$z[0],$I+=$z[1],$k.moveTo($x+$l[0],$I+$l[1]);$n<$a;)$k.lineTo($x+$l[$n++],$I+$l[$n++]);$k.closePath(),this._fillAndStroke($z[3],$z[4],$z[5],$z[7])},this._drawSkin=function($x,$I,$z){var $k=$z[0];if($k){var $l=this.ctx;$k.render($l,$x,$I)}},this._drawParticle=function($x,$I,$z){this.ctx.drawParticle($x+this.x,$I+this.y,$z[0])},this._setFilters=function($x,$I,$z){this.ctx.setFilters($z)},$z?this.ctx=$z.getContext("2d"):($z=$mx.create("3D"),this.ctx=$Z.createWebGLContext2D($z),$z._setContext(this.ctx)),$z.size($x,$I),this.canvas=$z}$N($a,"laya.renders.RenderContext");var $x=$a.prototype;return $x.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$x.drawTexture=function($x,$I,$z,$k,$l){$x.loaded&&this.ctx.drawTexture($x,$I,$z,$k,$l,this.x,this.y)},$x._drawTextures=function($x,$I,$z){$z[0].loaded&&this.ctx.drawTextures($z[0],$z[1],$x+this.x,$I+this.y)},$x.drawTextureWithTransform=function($x,$I,$z,$k,$l,$n,$a){$x.loaded&&this.ctx.drawTextureWithTransform($x,$I,$z,$k,$l,$n,this.x,this.y,$a)},$x.fillQuadrangle=function($x,$I,$z,$k,$l){this.ctx.fillQuadrangle($x,$I,$z,$k,$l)},$x.drawCanvas=function($x,$I,$z,$k,$l){this.ctx.drawCanvas($x,$I+this.x,$z+this.y,$k,$l)},$x.drawRect=function($x,$I,$z,$k,$l,$n){void 0===$n&&($n=1);var $a=this.ctx;$a.strokeStyle=$l,$a.lineWidth=$n,$a.strokeRect($x+this.x,$I+this.y,$z,$k,$n)},$x._fillAndStroke=function($x,$I,$z,$k){void 0===$k&&($k=!1);var $l=this.ctx;null!=$x&&($l.fillStyle=$x,$j.isWebGL?$l.fill($k):$l.fill()),null!=$I&&0<$z&&($l.strokeStyle=$I,$l.lineWidth=$z,$l.stroke())},$x.clipRect=function($x,$I,$z,$k){this.ctx.clipRect($x+this.x,$I+this.y,$z,$k)},$x.fillRect=function($x,$I,$z,$k,$l){this.ctx.fillRect($x+this.x,$I+this.y,$z,$k,$l)},$x.drawCircle=function($x,$I,$z,$k,$l){void 0===$l&&($l=1),$p.drawCall++;var $n=this.ctx;$n.beginPath(),$n.strokeStyle=$k,$n.lineWidth=$l,$n.arc($x+this.x,$I+this.y,$z,0,$a.PI2),$n.stroke()},$x.drawTriangles=function($x,$I,$z){if($j.isWebGL)this.ctx.drawTriangles($z[0],$x+$z[1],$I+$z[2],$z[3],$z[4],$z[5],$z[6],$z[7],$z[8],$z[9]);else{var $k=$z[5],$l=0,$n=$k.length,$a=this.ctx;for($l=0;$l<$n;$l+=3){var $$=2*$k[$l],$w=2*$k[$l+1],$i=2*$k[$l+2];$a.drawTriangle($z[0],$z[3],$z[4],$$,$w,$i,$z[6],!0)}}},$x.fillCircle=function($x,$I,$z,$k){$p.drawCall++;var $l=this.ctx;$l.beginPath(),$l.fillStyle=$k,$l.arc($x+this.x,$I+this.y,$z,0,$a.PI2),$l.fill()},$x.setShader=function($x){this.ctx.setShader($x)},$x.drawLine=function($x,$I,$z,$k,$l,$n){void 0===$n&&($n=1);var $a=this.ctx;$a.beginPath(),$a.strokeStyle=$l,$a.lineWidth=$n,$a.moveTo(this.x+$x,this.y+$I),$a.lineTo(this.x+$z,this.y+$k),$a.stroke()},$x.clear=function(){this.ctx.clear()},$x.transformByMatrix=function($x){this.ctx.transformByMatrix($x)},$x.setTransform=function($x,$I,$z,$k,$l,$n){this.ctx.setTransform($x,$I,$z,$k,$l,$n)},$x.setTransformByMatrix=function($x){this.ctx.setTransformByMatrix($x)},$x.save=function(){this.ctx.save()},$x.restore=function(){this.ctx.restore()},$x.translate=function($x,$I){this.ctx.translate($x,$I)},$x.transform=function($x,$I,$z,$k,$l,$n){this.ctx.transform($x,$I,$z,$k,$l,$n)},$x.rotate=function($x){this.ctx.rotate($x)},$x.scale=function($x,$I){this.ctx.scale($x,$I)},$x.alpha=function($x){this.ctx.globalAlpha*=$x},$x.setAlpha=function($x){this.ctx.globalAlpha=$x},$x.fillWords=function($x,$I,$z,$k,$l,$n){void 0===$n&&($n=0),this.ctx.fillWords($x,$I,$z,$k,$l,$n)},$x.fillBorderWords=function($x,$I,$z,$k,$l,$n,$a){this.ctx.fillBorderWords($x,$I,$z,$k,$l,$n,$a)},$x.fillText=function($x,$I,$z,$k,$l,$n){this.ctx.fillText($x,$I+this.x,$z+this.y,$k,$l,$n)},$x.strokeText=function($x,$I,$z,$k,$l,$n,$a){this.ctx.strokeText($x,$I+this.x,$z+this.y,$k,$l,$n,$a)},$x.blendMode=function($x){this.ctx.globalCompositeOperation=$x},$x.flush=function(){this.ctx.flush&&this.ctx.flush()},$x.addRenderObject=function($x){this.ctx.addRenderObject($x)},$x.beginClip=function($x,$I,$z,$k){this.ctx.beginClip&&this.ctx.beginClip($x,$I,$z,$k)},$x.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$x.fillTrangles=function($x,$I,$z){this.ctx.fillTrangles($z[0],$z[1],$z[2],$z[3],4<$z.length?$z[4]:null)},$a.PI2=2*Math.PI,$a}(),$Y=function(){function $a($x,$I){switch(this._next=$I||$a.NORENDER,$x){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$m._filter);case 69905:return void(this._fun=$a._initRenderFun)}this.onCreate($x)}$N($a,"laya.renders.RenderSprite");var $x=$a.prototype;return $x.onCreate=function($x){},$x._style=function($x,$I,$z,$k){$x._style.render($x,$I,$z,$k);var $l=this._next;$l._fun.call($l,$x,$I,$z,$k)},$x._no=function($x,$I,$z,$k){},$x._custom=function($x,$I,$z,$k){$x.customRender($I,$z,$k);var $l=$x._style._tf;this._next._fun.call(this._next,$x,$I,$z-$l.translateX,$k-$l.translateY)},$x._clip=function($x,$I,$z,$k){var $l=this._next;if($l!=$a.NORENDER){var $n=$x._style.scrollRect;$I.ctx.save(),$I.ctx.clipRect($z,$k,$n.width,$n.height),$l._fun.call($l,$x,$I,$z-$n.x,$k-$n.y),$I.ctx.restore()}},$x._blend=function($x,$I,$z,$k){var $l=$x._style;$l.blendMode&&($I.ctx.globalCompositeOperation=$l.blendMode);var $n=this._next;$n._fun.call($n,$x,$I,$z,$k),$I.ctx.globalCompositeOperation="source-over"},$x._mask=function($x,$I,$z,$k){var $l=this._next;$l._fun.call($l,$x,$I,$z,$k);var $n=$x.mask;$n&&($I.ctx.globalCompositeOperation="destination-in",(0<$n.numChildren||!$n.graphics._isOnlyOne())&&($n.cacheAsBitmap=!0),$n.render($I,$z-$x.pivotX,$k-$x.pivotY)),$I.ctx.globalCompositeOperation="source-over"},$x._graphics=function($x,$I,$z,$k){var $l=$x._style._tf;$x._graphics&&$x._graphics._render($x,$I,$z-$l.translateX,$k-$l.translateY);var $n=this._next;$n._fun.call($n,$x,$I,$z,$k)},$x._image=function($x,$I,$z,$k){var $l=$x._style;$I.ctx.drawTexture2($z,$k,$l._tf.translateX,$l._tf.translateY,$x.transform,$l.alpha,$l.blendMode,$x._graphics._one)},$x._image2=function($x,$I,$z,$k){var $l=$x._style._tf;$I.ctx.drawTexture2($z,$k,$l.translateX,$l.translateY,$x.transform,1,null,$x._graphics._one)},$x._alpha=function($x,$I,$z,$k){var $l;if(.01<($l=$x._style.alpha)||$x._needRepaint()){var $n=$I.ctx.globalAlpha;$I.ctx.globalAlpha*=$l;var $a=this._next;$a._fun.call($a,$x,$I,$z,$k),$I.ctx.globalAlpha=$n}},$x._transform=function($x,$I,$z,$k){var $l=$x.transform,$n=this._next;$l&&$n!=$a.NORENDER?($I.save(),$I.transform($l.a,$l.b,$l.c,$l.d,$l.tx+$z,$l.ty+$k),$n._fun.call($n,$x,$I,0,0),$I.restore()):$n._fun.call($n,$x,$I,$z,$k)},$x._childs=function($x,$I,$z,$k){var $l=$x._style,$n=$l._tf;if($z=$z-$n.translateX+$l.paddingLeft,$k=$k-$n.translateY+$l.paddingTop,$l._calculation){var $a=$x._getWords();if($a){var $$=$l;$$&&($$.stroke?$I.fillBorderWords($a,$z,$k,$$.font,$$.color,$$.strokeColor,$$.stroke):$I.fillWords($a,$z,$k,$$.font,$$.color,"none"!=$$.textDecoration&&$$.underLine?1:0))}}var $w,$i=$x._childs,$F=$i.length;if($x.viewport||$x.optimizeScrollRect&&$x._style.scrollRect){var $b=$x.viewport||$x._style.scrollRect,$T=$b.x,$_=$b.y,$R=$b.right,$s=$b.bottom,$N=NaN,$D=NaN;for($f=0;$f<$F;++$f)($w=$i[$f]).visible&&($N=$w._x)<$R&&$N+$w.width>$T&&($D=$w._y)<$s&&$D+$w.height>$_&&$w.render($I,$z,$k)}else for(var $f=0;$f<$F;++$f)($w=$i[$f])._style.visible&&$w.render($I,$z,$k)},$x._canvas=function($x,$I,$z,$k){var $l=$x._$P.cacheCanvas;if($l){"bitmap"===$l.type?$p.canvasBitmap++:$p.canvasNormal++;var $n=$l.ctx;if($x._needRepaint()||!$n)this._canvas_repaint($x,$I,$z,$k);else{var $a=$l._cacheRec;$I.drawCanvas($n.canvas,$z+$a.x,$k+$a.y,$a.width,$a.height)}}else this._next._fun.call(this._next,$x,$I,$z,$k)},$x._canvas_repaint=function($x,$I,$z,$k){var $l=$x._$P.cacheCanvas,$n=this._next;if($l){var $a,$$,$w,$i,$F=$l.ctx,$b=$x._needRepaint()||!$F,$T=$l.type;if("bitmap"===$T?$p.canvasBitmap++:$p.canvasNormal++,$b){var $_,$R;$l._cacheRec||($l._cacheRec=new $K),$j.isWebGL&&"bitmap"!==$T?$l._cacheRec.setTo(-$x.pivotX,-$x.pivotY,1,1):(($i=$x.getSelfBounds()).x=$i.x-$x.pivotX,$i.y=$i.y-$x.pivotY,$i.x=$i.x-16,$i.y=$i.y-16,$i.width=$i.width+32,$i.height=$i.height+32,$i.x=Math.floor($i.x+$z)-$z,$i.y=Math.floor($i.y+$k)-$k,$i.width=Math.floor($i.width),$i.height=Math.floor($i.height),$l._cacheRec.copyFrom($i)),$i=$l._cacheRec;var $s,$N=$j.isWebGL?1:$W.pixelRatio*$v.stage.clientScaleX,$D=$j.isWebGL?1:$W.pixelRatio*$v.stage.clientScaleY;if(!$j.isWebGL){var $f,$m=1,$y=1;for($f=$x;$f&&$f!=$v.stage;)$m*=$f.scaleX,$y*=$f.scaleY,$f=$f.parent;$j.isWebGL?($m<1&&($N*=$m),$y<1&&($D*=$y)):(1<$m&&($N*=$m),1<$y&&($D*=$y))}if($x.scrollRect){var $C=$x.scrollRect;$i.x-=$C.x,$i.y-=$C.y}if($_=$i.width*$N,$R=$i.height*$D,$$=$i.x,$w=$i.y,$j.isWebGL&&"bitmap"===$T&&(2048<$_||2048<$R))return console.warn("cache bitmap size larger than 2048,cache ignored"),$l.ctx&&($H.recover("RenderContext",$l.ctx),$l.ctx.canvas.size(0,0),$l.ctx=null),void $n._fun.call($n,$x,$I,$z,$k);if($F||($F=$l.ctx=$H.getItem("RenderContext")||new $t($_,$R,$mx.create("AUTO"))),$F.ctx.sprite=$x,($a=$F.canvas).clear(),($a.width!=$_||$a.height!=$R)&&$a.size($_,$R),"bitmap"===$T?$a.context.asBitmap=!0:"normal"===$T&&($a.context.asBitmap=!1),1!=$N||1!=$D){var $P=$F.ctx;$P.save(),$P.scale($N,$D),!$j.isConchWebGL&&$j.isConchApp&&($s=$x._$P.cf)&&$P.setFilterMatrix&&$P.setFilterMatrix($s._mat,$s._alpha),$n._fun.call($n,$x,$F,-$$,-$w),$P.restore(),$j.isConchApp&&!$j.isConchWebGL||$x._applyFilters()}else $P=$F.ctx,!$j.isConchWebGL&&$j.isConchApp&&($s=$x._$P.cf)&&$P.setFilterMatrix&&$P.setFilterMatrix($s._mat,$s._alpha),$n._fun.call($n,$x,$F,-$$,-$w),$j.isConchApp&&!$j.isConchWebGL||$x._applyFilters();$x._$P.staticCache&&($l.reCache=!1),$p.canvasReCache++}else $$=($i=$l._cacheRec).x,$w=$i.y,$a=$F.canvas;$I.drawCanvas($a,$z+$$,$k+$w,$i.width,$i.height)}else $n._fun.call($n,$x,$F,$z,$k)},$a.__init__=function(){var $x,$I,$z=0;for($I=$Z.createRenderSprite(69905,null),$x=$a.renders.length=4096,$z=0;$z<$x;$z++)$a.renders[$z]=$I;$a.renders[0]=$Z.createRenderSprite(0,null),function($x,$I){for(var $z=0,$k=0;$k<$x.length;$k++)$z|=$x[$k],$a.renders[$z]=$I}([1,512,4,2],new $a(1,null)),$a.renders[513]=$Z.createRenderSprite(513,null),$a.renders[517]=new $a(517,null)},$a._initRenderFun=function($x,$I,$z,$k){var $l=$x._renderType;($a.renders[$l]=$a._getTypeRender($l))._fun($x,$I,$z,$k)},$a._getTypeRender=function($x){for(var $I=null,$z=2048;1<$z;)$z&$x&&($I=$Z.createRenderSprite($z,$I)),$z>>=1;return $I},$a.IMAGE=1,$a.ALPHA=2,$a.TRANSFORM=4,$a.BLEND=8,$a.CANVAS=16,$a.FILTERS=32,$a.MASK=64,$a.CLIP=128,$a.STYLE=256,$a.GRAPHICS=512,$a.CUSTOM=1024,$a.CHILDS=2048,$a.INIT=69905,$a.renders=[],$a.NORENDER=new $a(0,null),$a}(),$c=function(){function $$(){this._repaint=!1}$N($$,"laya.resource.Context");var $x=$$.prototype;return $x.replaceReset=function(){var $x,$I,$z=0;for($x=$$.replaceKeys.length,$z=0;$z<$x;$z++)$I=$$.replaceKeys[$z],this[$$.newKeys[$z]]=this[$I]},$x.replaceResotre=function(){this.__restore(),this.__reset()},$x.setIsMainContext=function(){},$x.drawTextures=function($x,$I,$z,$k){$p.drawCall+=$I.length/2;for(var $l=$x.width,$n=$x.height,$a=0,$$=$I.length;$a<$$;$a+=2)this.drawTexture($x,$I[$a],$I[$a+1],$l,$n,$z,$k)},$x.drawCanvas=function($x,$I,$z,$k,$l){$p.drawCall++,this.drawImage($x.source,$I,$z,$k,$l)},$x.fillRect=function($x,$I,$z,$k,$l){$p.drawCall++,$l&&(this.fillStyle=$l),this.__fillRect($x,$I,$z,$k)},$x.fillText=function($x,$I,$z,$k,$l,$n){$p.drawCall++,3<arguments.length&&null!=$k&&(this.font=$k,this.fillStyle=$l,this.textAlign=$n,this.textBaseline="top"),this.__fillText($x,$I,$z)},$x.fillBorderText=function($x,$I,$z,$k,$l,$n,$a,$$){$p.drawCall++,this.font=$k,this.fillStyle=$l,this.textBaseline="top",this.strokeStyle=$n,this.lineWidth=$a,this.textAlign=$$,this.__strokeText($x,$I,$z),this.__fillText($x,$I,$z)},$x.strokeText=function($x,$I,$z,$k,$l,$n,$a){$p.drawCall++,3<arguments.length&&null!=$k&&(this.font=$k,this.strokeStyle=$l,this.lineWidth=$n,this.textAlign=$a,this.textBaseline="top"),this.__strokeText($x,$I,$z)},$x.transformByMatrix=function($x){this.transform($x.a,$x.b,$x.c,$x.d,$x.tx,$x.ty)},$x.setTransformByMatrix=function($x){this.setTransform($x.a,$x.b,$x.c,$x.d,$x.tx,$x.ty)},$x.clipRect=function($x,$I,$z,$k){$p.drawCall++,this.beginPath(),this.rect($x,$I,$z,$k),this.clip()},$x.drawTexture=function($x,$I,$z,$k,$l,$n,$a){$p.drawCall++;var $$=$x.uv,$w=$x.bitmap.width,$i=$x.bitmap.height;this.drawImage($x.source,$$[0]*$w,$$[1]*$i,($$[2]-$$[0])*$w,($$[5]-$$[3])*$i,$I+$n,$z+$a,$k,$l)},$x.drawTextureWithTransform=function($x,$I,$z,$k,$l,$n,$a,$$,$w){$p.drawCall++;var $i=$x.uv,$F=$x.bitmap.width,$b=$x.bitmap.height;this.save(),1!=$w&&(this.globalAlpha*=$w),$n?(this.transform($n.a,$n.b,$n.c,$n.d,$n.tx+$a,$n.ty+$$),this.drawImage($x.source,$i[0]*$F,$i[1]*$b,($i[2]-$i[0])*$F,($i[5]-$i[3])*$b,$I,$z,$k,$l)):this.drawImage($x.source,$i[0]*$F,$i[1]*$b,($i[2]-$i[0])*$F,($i[5]-$i[3])*$b,$I+$a,$z+$$,$k,$l),this.restore()},$x.drawTexture2=function($x,$I,$z,$k,$l,$n,$a,$$){var $w=$$[0];if($w.loaded&&$w.bitmap&&$w.source){$p.drawCall++;var $i=1!==$n;if($i){var $F=this.globalAlpha;this.globalAlpha*=$n}var $b=$w.uv,$T=$w.bitmap.width,$_=$w.bitmap.height;$l?(this.save(),this.transform($l.a,$l.b,$l.c,$l.d,$l.tx+$x,$l.ty+$I),this.drawImage($w.source,$b[0]*$T,$b[1]*$_,($b[2]-$b[0])*$T,($b[5]-$b[3])*$_,$$[1]-$z,$$[2]-$k,$$[3],$$[4]),this.restore()):this.drawImage($w.source,$b[0]*$T,$b[1]*$_,($b[2]-$b[0])*$T,($b[5]-$b[3])*$_,$$[1]-$z+$x,$$[2]-$k+$I,$$[3],$$[4]),$i&&(this.globalAlpha=$F)}},$x.fillTexture=function($x,$I,$z,$k,$l,$n,$a,$$){if(!$$.pat){if($x.uv!=$Fx.DEF_UV){var $w=new $mx("2D");$w.getContext("2d"),$w.size($x.width,$x.height),$w.context.drawTexture($x,0,0,$x.width,$x.height,0,0),$x=new $Fx($w)}$$.pat=this.createPattern($x.bitmap.source,$n)}var $i=$I,$F=$z,$b=0,$T=0;$a&&($i+=$a.x%$x.width,$F+=$a.y%$x.height,$b-=$a.x%$x.width,$T-=$a.y%$x.height),this.translate($i,$F),this.fillRect($b,$T,$k,$l,$$.pat),this.translate(-$i,-$F)},$x.drawTriangle=function($x,$I,$z,$k,$l,$n,$a,$$){var $w=$x.bitmap,$i=$w.source,$F=$x.width,$b=$x.height,$T=$w.width,$_=$w.height,$R=$z[$k]*$T,$s=$z[$l]*$T,$N=$z[$n]*$T,$D=$z[$k+1]*$_,$f=$z[$l+1]*$_,$m=$z[$n+1]*$_,$y=$I[$k],$C=$I[$l],$P=$I[$n],$v=$I[$k+1],$L=$I[$l+1],$K=$I[$n+1];if($$){var $E=($y+$C+$P)/3,$O=($v+$L+$K)/3,$S=$y-$E,$Z=$v-$O,$U=Math.sqrt($S*$S+$Z*$Z);$y=$E+$S/$U*($U+1),$v=$O+$Z/$U*($U+1),$Z=$L-$O,$C=$E+($S=$C-$E)/($U=Math.sqrt($S*$S+$Z*$Z))*($U+1),$L=$O+$Z/$U*($U+1),$Z=$K-$O,$P=$E+($S=$P-$E)/($U=Math.sqrt($S*$S+$Z*$Z))*($U+1),$K=$O+$Z/$U*($U+1)}this.save(),$a&&this.transform($a.a,$a.b,$a.c,$a.d,$a.tx,$a.ty),this.beginPath(),this.moveTo($y,$v),this.lineTo($C,$L),this.lineTo($P,$K),this.closePath(),this.clip();var $X=1/($R*$f+$D*$N+$s*$m-$f*$N-$D*$s-$R*$m),$d=$y*$f+$D*$P+$C*$m-$f*$P-$D*$C-$y*$m,$j=$R*$C+$y*$N+$s*$P-$C*$N-$y*$s-$R*$P,$t=$R*$f*$P+$D*$C*$N+$y*$s*$m-$y*$f*$N-$D*$s*$P-$R*$C*$m,$Y=$v*$f+$D*$K+$L*$m-$f*$K-$D*$L-$v*$m,$c=$R*$L+$v*$N+$s*$K-$L*$N-$v*$s-$R*$K,$V=$R*$f*$K+$D*$L*$N+$v*$s*$m-$v*$f*$N-$D*$s*$K-$R*$L*$m;this.transform($d*$X,$Y*$X,$j*$X,$c*$X,$t*$X,$V*$X),this.drawImage($i,$x.uv[0]*$T,$x.uv[1]*$_,$F,$b,$x.uv[0]*$T,$x.uv[1]*$_,$F,$b),this.restore()},$x.flush=function(){return 0},$x.fillWords=function($x,$I,$z,$k,$l,$n){$k&&(this.font=$k),$l&&(this.fillStyle=$l);this.textBaseline="top",this.textAlign="left";for(var $a=0,$$=$x.length;$a<$$;$a++){var $w=$x[$a];if(this.__fillText($w.char,$w.x+$I,$w.y+$z),1===$n){var $i=$w.height,$F=.5*$w.style.letterSpacing;$F||($F=0),this.beginPath(),this.strokeStyle=$l,this.lineWidth=1,this.moveTo($I+$w.x-$F+.5,$z+$w.y+$i+.5),this.lineTo($I+$w.x+$w.width+$F+.5,$z+$w.y+$i+.5),this.stroke()}}},$x.fillBorderWords=function($x,$I,$z,$k,$l,$n,$a){$k&&(this.font=$k),$l&&(this.fillStyle=$l),this.textBaseline="top",this.lineWidth=$a,this.textAlign="left",this.strokeStyle=$n;for(var $$=0,$w=$x.length;$$<$w;$$++){var $i=$x[$$];this.__strokeText($i.char,$i.x+$I,$i.y+$z),this.__fillText($i.char,$i.x+$I,$i.y+$z)}},$x.destroy=function(){this.canvas.width=this.canvas.height=0},$x.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$x.drawCurves=function($x,$I,$z){this.beginPath(),this.strokeStyle=$z[3],this.lineWidth=$z[4];var $k=$z[2];$x+=$z[0],$I+=$z[1],this.moveTo($x+$k[0],$I+$k[1]);for(var $l=2,$n=$k.length;$l<$n;)this.quadraticCurveTo($x+$k[$l++],$I+$k[$l++],$x+$k[$l++],$I+$k[$l++]);this.stroke()},$$.__init__=function($I){var $z=laya.resource.Context.prototype;if(!($I=$I||CanvasRenderingContext2D.prototype).inited){$I.inited=!0,$I.__fillText=$I.fillText,$I.__fillRect=$I.fillRect,$I.__strokeText=$I.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($x){$I[$x]=$z[$x]})}},$$.replaceCanvasGetSet=function($x,$I){var $z=Object.getOwnPropertyDescriptor($x,$I);if(!$z||!$z.configurable)return!1;var $k,$l={};for($k in $z)"set"!=$k&&($l[$k]=$z[$k]);var $n=$z.set;return $l.set=function($x){$n.call(this,$x);var $I=this.getContext("2d");$I&&"__reset"in $I&&$I.__reset()},Object.defineProperty($x,$I,$l),!0},$$.replaceGetSet=function($x,$I){var $z=Object.getOwnPropertyDescriptor($x,$I);if(!$z||!$z.configurable)return!1;var $k,$l={};for($k in $z)"set"!=$k&&($l[$k]=$z[$k]);var $n=$z.set,$a="___"+$I+"__";return $$.newKeys.push($a),$l.set=function($x){$x!=this[$a]&&(this[$a]=$x,$n.call(this,$x))},Object.defineProperty($x,$I,$l),!0},$$._default=new $$,$$.newKeys=[],$w($$,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$$}(),$V=function(){function $n($x){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$n._uniqueIDCounter,this._name=$x||"Content Manager",$n._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$n._resourceManagers.push(this),this._resources=[],this._records={}}$N($n,"laya.resource.ResourceManager");var $x=$n.prototype;return $v.imps($x,{"laya.resource.IDispose":!0}),$x.getResourceByIndex=function($x){return this._resources[$x]},$x.getResourcesLength=function(){return this._resources.length},$x.addResource=function($x){return $x.resourceManager&&$x.resourceManager.removeResource($x),-1===this._resources.indexOf($x)&&(($x._resourceManager=this)._resources.push($x),this.addRecord($x.uri,$x.__className,$x.memorySize),this.addSize($x.memorySize),!0)},$x.removeResource=function($x){var $I=this._resources.indexOf($x);return-1!==$I&&(this._resources.splice($I,1),$x._resourceManager=null,this._memorySize-=$x.memorySize,this.addRecord($x.uri,$x.__className,-$x.memorySize),!0)},$x.unload=function(){for(var $x=this._resources.slice(0,this._resources.length),$I=0;$I<$x.length;$I++){$x[$I].destroy()}$x.length=0},$x.dispose=function(){if(this===$n._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$n._resourceManagers.splice($n._resourceManagers.indexOf(this),1),$n._isResourceManagersSorted=!1;for(var $x=this._resources.slice(0,this._resources.length),$I=0;$I<$x.length;$I++){var $z=$x[$I];$z.resourceManager.removeResource($z),$z.destroy()}$x.length=0},$x.addSize=function($x){$x&&(this.autoRelease&&0<$x&&this._memorySize+$x>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$x)},$x.addRecord=function($x,$I,$z){DEBUG&&$z&&!$x&&console.error($x,$I,$z)},$x.garbageCollection=function($x){var $I=this._resources;($I=$I.slice()).sort(function($x,$I){if(!$x||!$I)throw new Error("a或b不能为空！");return $x.released&&$I.released?0:$x.released?1:$I.released?-1:$x._lastUseFrameCount-$I._lastUseFrameCount});for(var $z=$p.loopCount,$k=0,$l=$I.length;$k<$l;$k++){var $n=$I[$k];if(!(1<$z-$n._lastUseFrameCount))return void(this._memorySize>=$x&&(this._isOverflow=!0));if($n.releaseResource(),this._memorySize<$x)return void(this._isOverflow=!1)}},$F(0,$x,"id",function(){return this._id}),$F(0,$x,"name",function(){return this._name},function($x){!$x&&""===$x||this._name===$x||(this._name=$x,$n._isResourceManagersSorted=!1)}),$F(0,$x,"memorySize",function(){return this._memorySize}),$F(0,$x,"records",function(){return this._records}),$F(1,$n,"systemResourceManager",function(){return $n._systemResourceManager}),$n.__init__=function(){$n.currentResourceManager=$n.systemResourceManager},$n.getLoadedResourceManagerByIndex=function($x){return $n._resourceManagers[$x]},$n.getLoadedResourceManagersCount=function(){return $n._resourceManagers.length},$n.recreateContentManagers=function($x){void 0===$x&&($x=!1);for(var $I=$n.currentResourceManager,$z=0;$z<$n._resourceManagers.length;$z++){$n.currentResourceManager=$n._resourceManagers[$z];for(var $k=0;$k<$n.currentResourceManager._resources.length;$k++)$n.currentResourceManager._resources[$k].releaseResource($x),$n.currentResourceManager._resources[$k].activeResource($x)}$n.currentResourceManager=$I},$n.releaseContentManagers=function($x){void 0===$x&&($x=!1);for(var $I=$n.currentResourceManager,$z=0;$z<$n._resourceManagers.length;$z++){$n.currentResourceManager=$n._resourceManagers[$z];for(var $k=0;$k<$n.currentResourceManager._resources.length;$k++){var $l=$n.currentResourceManager._resources[$k];!$l.released&&$l.releaseResource($x)}}$n.currentResourceManager=$I},$n._uniqueIDCounter=0,$n._isResourceManagersSorted=!1,$n._resourceManagers=[],$w($n,["_systemResourceManager",function(){return this._systemResourceManager=new $n("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$n._systemResourceManager}]),$n}(),$W=(function(){function $x(){}$N($x,"laya.system.System"),$x.changeDefinition=function($x,$I){$v[$x]=$I;var $z=$x+"=classObj";$v._runScript($z)},$x.__init__=function(){$j.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $z(){}return $N($z,"laya.utils.Browser"),$F(1,$z,"pixelRatio",function(){return $z.__init__(),-1<$z.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$Z.getPixelRatio()}),$F(1,$z,"height",function(){return $z.__init__(),($v.stage&&$v.stage.canvasRotation?$z.clientWidth:$z.clientHeight)*$z.pixelRatio}),$F(1,$z,"clientWidth",function(){return $z.__init__(),$z.window.innerWidth||$z.document.body.clientWidth}),$F(1,$z,"window",function(){return $z.__init__(),$z._window}),$F(1,$z,"clientHeight",function(){return $z.__init__(),$z.window.innerHeight||$z.document.body.clientHeight||$z.document.documentElement.clientHeight}),$F(1,$z,"width",function(){return $z.__init__(),($v.stage&&$v.stage.canvasRotation?$z.clientHeight:$z.clientWidth)*$z.pixelRatio}),$F(1,$z,"container",function(){return $z.__init__(),$z._container||(($z._container=$z.createElement("div")).id="layaContainer",$z.document.body.appendChild($z._container)),$z._container},function($x){$z._container=$x}),$F(1,$z,"document",function(){return $z.__init__(),$z._document}),$z.__init__=function(){if(!$z._window){$z._window=$Z.getWindow(),$z._document=$z.window.document,$z._window.addEventListener("message",function($x){laya.utils.Browser._onMessage($x)},!1),$z.document.__createElement=$z.document.createElement,$_.requestAnimationFrame=$_.requestAnimationFrame||$_.webkitRequestAnimationFrame||$_.mozRequestAnimationFrame||$_.oRequestAnimationFrame||$_.msRequestAnimationFrame||function($x){return $_.setTimeout($x,1e3/60)};var $x=$_.document.body.style;$x["-webkit-user-select"]="none",$x["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$z.userAgent=$z.window.navigator.userAgent,$z.onIOS=!!($z.u=$z.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$z.onMobile=-1<$z.u.indexOf("Mobile"),$z.onIPhone=-1<$z.u.indexOf("iPhone"),$z.onMac=-1<$z.u.indexOf("Mac OS X"),$z.onIPad=-1<$z.u.indexOf("iPad"),$z.onAndroid=-1<$z.u.indexOf("Android")||-1<$z.u.indexOf("Adr"),$z.onWP=-1<$z.u.indexOf("Windows Phone"),$z.onQQBrowser=-1<$z.u.indexOf("QQBrowser"),$z.onMQQBrowser=-1<$z.u.indexOf("MQQBrowser")||-1<$z.u.indexOf("Mobile")&&-1<$z.u.indexOf("QQ"),$z.onIE=!!$z.window.ActiveXObject||"ActiveXObject"in $z.window,$z.onWeiXin=-1<$z.u.indexOf("MicroMessenger"),$z.onPC=!$z.onMobile,$z.onSafari=-1<$z.u.indexOf("Safari"),$z.onFirefox=-1<$z.u.indexOf("Firefox"),$z.onEdge=-1<$z.u.indexOf("Edge"),$z.onMiniGame=-1<$z.u.indexOf("MiniGame"),$z.onLimixiu=-1<$z.u.indexOf("limixiu"),$z.httpProtocol="http:"==$z.window.location.protocol,$z.onMiniGame&&null==$z.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$z.webAudioEnabled=!!($z.window.AudioContext||$z.window.webkitAudioContext||$z.window.mozAudioContext),$z.soundType=$z.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$lx=$z.webAudioEnabled?$nx:$zx,$z.webAudioEnabled&&$nx.initWebAudio(),$zx._initMusicAudio(),$z.enableTouch="ontouchstart"in $_||$_.DocumentTouch&&$I instanceof DocumentTouch,$_.focus(),$S._soundClass=$lx,$S._musicClass=$zx,$j._mainCanvas=$j._mainCanvas||$mx.create("2D"),$z.canvas||($z.canvas=$mx.create("2D"),$z.context=$z.canvas.getContext("2d"))}},$z._onMessage=function($x){if($x.data&&"size"==$x.data.name){if($z.window.innerWidth=$x.data.width,$z.window.innerHeight=$x.data.height,$z.window.__innerHeight=$x.data.clientHeight,!$z.document.createEvent)return void console.warn("no document.createEvent");var $I=$z.document.createEvent("HTMLEvents");return $I.initEvent("resize",!1,!1),void $z.window.dispatchEvent($I)}},$z.createElement=function($x){return $z.__init__(),$z.document.__createElement($x)},$z.getElementById=function($x){return $z.__init__(),$z.document.getElementById($x)},$z.removeElement=function($x){$x&&$x.parentNode&&$x.parentNode.removeChild($x)},$z.now=function(){return $Z.now()},$z._window=null,$z._document=null,$z._container=null,$z.userAgent=null,$z.u=null,$z.onIOS=!1,$z.onMac=!1,$z.onMobile=!1,$z.onIPhone=!1,$z.onIPad=!1,$z.onAndroid=!1,$z.onWP=!1,$z.onQQBrowser=!1,$z.onMQQBrowser=!1,$z.onSafari=!1,$z.onFirefox=!1,$z.onEdge=!1,$z.onIE=!1,$z.onWeiXin=!1,$z.onMiniGame=!1,$z.onLimixiu=!1,$z.onPC=!1,$z.httpProtocol=!1,$z.webAudioEnabled=!1,$z.soundType=null,$z.enableTouch=!1,$z.canvas=null,$z.context=null,$z.__init$=function(){},$z}()),$q=function(){function $I($x){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$x?(this._u8d_=new Uint8Array($x),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$N($I,"laya.utils.Byte");var $x=$I.prototype;return $x.___resizeBuffer=function($I){try{var $x=new Uint8Array($I);null!=this._u8d_&&(this._u8d_.length<=$I?$x.set(this._u8d_):$x.set(this._u8d_.subarray(0,$I))),this._u8d_=$x,this._d_=new DataView($x.buffer)}catch($x){throw"___resizeBuffer err:"+$I}},$x.getString=function(){return this.rUTF(this.getUint16())},$x.getFloat32Array=function($x,$I){var $z=$x+$I;$z=$z>this._length?this._length:$z;var $k=new Float32Array(this._d_.buffer.slice($x,$z));return this._pos_=$z,$k},$x.getUint8Array=function($x,$I){var $z=$x+$I;$z=$z>this._length?this._length:$z;var $k=new Uint8Array(this._d_.buffer.slice($x,$z));return this._pos_=$z,$k},$x.getInt16Array=function($x,$I){var $z=$x+$I;$z=$z>this._length?this._length:$z;var $k=new Int16Array(this._d_.buffer.slice($x,$z));return this._pos_=$z,$k},$x.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $x=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$x},$x.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $x=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$x},$x.writeFloat32=function($x){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$x,this._xd_),this._pos_+=4},$x.writeFloat64=function($x){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$x,this._xd_),this._pos_+=8},$x.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $x=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$x},$x.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $x=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$x},$x.writeInt32=function($x){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$x,this._xd_),this._pos_+=4},$x.writeUint32=function($x){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$x,this._xd_),this._pos_+=4},$x.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $x=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$x},$x.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $x=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$x},$x.writeUint16=function($x){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$x,this._xd_),this._pos_+=2},$x.writeInt16=function($x){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$x,this._xd_),this._pos_+=2},$x.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$x.writeUint8=function($x){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$x),this._pos_++},$x._getUInt8=function($x){return this._d_.getUint8($x)},$x._getUint16=function($x){return this._d_.getUint16($x,this._xd_)},$x._getMatrix=function(){return new $U(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$x.rUTF=function($x){for(var $I=[],$z=this._pos_+$x,$k=0,$l=0,$n=0,$a=String.fromCharCode,$$=this._u8d_;this._pos_<$z;)($k=$$[this._pos_++])<128?0!=$k&&$I.push($a($k)):$k<224?$I.push($a((63&$k)<<6|127&$$[this._pos_++])):$k<240?($l=$$[this._pos_++],$I.push($a((31&$k)<<12|(127&$l)<<6|127&$$[this._pos_++]))):($l=$$[this._pos_++],$n=$$[this._pos_++],$I.push($a((15&$k)<<18|(127&$l)<<12|$n<<6&127|127&$$[this._pos_++]))),0;return $I.join("")},$x.getCustomString=function($x){for(var $I=[],$z=0,$k=0,$l=0,$n=String.fromCharCode,$a=this._u8d_;0<$x;)if(($k=$a[this._pos_])<128)$I.push($n($k)),this._pos_++,$x--;else for($z=$k-128,this._pos_++,$x-=$z;0<$z;)$k=$a[this._pos_++],$l=$a[this._pos_++],$I.push($n($l<<8|$k)),$z--;return $I.join("")},$x.clear=function(){this._pos_=0,this.length=0},$x.__getBuffer=function(){return this._d_.buffer},$x.writeUTFBytes=function($x){for(var $I=0,$z=($x+="").length;$I<$z;$I++){var $k=$x.charCodeAt($I);$k<=127?this.writeByte($k):$k<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$k>>6,128|63&$k],this._pos_),this._pos_+=2):$k<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$k>>12,128|$k>>6&63,128|63&$k],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$k>>18,128|$k>>12&63,128|$k>>6&63,128|63&$k],this._pos_),this._pos_+=4)}},$x.writeUTFString=function($x){var $I=this.pos;this.writeUint16(1),this.writeUTFBytes($x);var $z=this.pos-$I-2;if(65536<=$z)throw"writeUTFString byte len more than 65536";this._d_.setUint16($I,$z,this._xd_)},$x.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$x.getUTFString=function(){return this.readUTFString()},$x.readUTFBytes=function($x){if(void 0===$x&&($x=-1),0==$x)return"";var $I=this.bytesAvailable;if($I<$x)throw"readUTFBytes error - Out of bounds";return $x=0<$x?$x:$I,this.rUTF($x)},$x.getUTFBytes=function($x){return void 0===$x&&($x=-1),this.readUTFBytes($x)},$x.writeByte=function($x){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$x),this._pos_+=1},$x.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$x.getByte=function(){return this.readByte()},$x.ensureWrite=function($x){this._length<$x&&(this._length=$x),this._allocated_<$x&&(this.length=$x)},$x.writeArrayBuffer=function($x,$I,$z){if(void 0===$I&&($I=0),void 0===$z&&($z=0),$I<0||$z<0)throw"writeArrayBuffer error - Out of bounds";0==$z&&($z=$x.byteLength-$I),this.ensureWrite(this._pos_+$z);var $k=new Uint8Array($x);this._u8d_.set($k.subarray($I,$I+$z),this._pos_),this._pos_+=$z},$F(0,$x,"buffer",function(){var $x=this._d_.buffer;return $x.byteLength==this.length?$x:$x.slice(0,this.length)}),$F(0,$x,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($x){this._xd_="littleEndian"==$x}),$F(0,$x,"length",function(){return this._length},function($x){this._allocated_<$x?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($x,2*this._allocated_))):this._allocated_>$x&&this.___resizeBuffer(this._allocated_=$x),this._length=$x}),$F(0,$x,"pos",function(){return this._pos_},function($x){this._pos_=$x}),$F(0,$x,"bytesAvailable",function(){return this._length-this._pos_}),$I.getSystemEndian=function(){if(!$I._sysEndian){var $x=new ArrayBuffer(2);new DataView($x).setInt16(0,256,!0),$I._sysEndian=256===new Int16Array($x)[0]?"littleEndian":"bigEndian"}return $I._sysEndian},$I.BIG_ENDIAN="bigEndian",$I.LITTLE_ENDIAN="littleEndian",$I._sysEndian=null,$I}(),$o=function(){function $l(){}return $N($l,"laya.utils.CacheManager"),$l.regCacheByFunction=function($x,$I){var $z;$l.unRegCacheByFunction($x,$I),$z={tryDispose:$x,getCacheList:$I},$l._cacheList.push($z)},$l.unRegCacheByFunction=function($x,$I){var $z,$k=0;for($z=$l._cacheList.length,$k=0;$k<$z;$k++)if($l._cacheList[$k].tryDispose==$x&&$l._cacheList[$k].getCacheList==$I)return void $l._cacheList.splice($k,1)},$l.forceDispose=function(){var $x=0,$I=$l._cacheList.length;for($x=0;$x<$I;$x++)$l._cacheList[$x].tryDispose(!0)},$l.beginCheck=function($x){void 0===$x&&($x=15e3),$v.timer.loop($x,null,$l._checkLoop)},$l.stopCheck=function(){$v.timer.clear(null,$l._checkLoop)},$l._checkLoop=function(){var $x=$l._cacheList;if(!($x.length<1)){var $I,$z=$W.now(),$k=0;for($I=$k=$x.length;0<$k&&($x[$l._index=++$l._index%$I].tryDispose(!1),!($W.now()-$z>$l.loopTimeLimit));)$k--}},$l.loopTimeLimit=2,$l._cacheList=[],$l._index=0,$l}(),$J=function(){function $_(){}return $N($_,"laya.utils.ClassUtils"),$_.regClass=function($x,$I){$_._classMap[$x]=$I},$_.getRegClass=function($x){return $_._classMap[$x]},$_.getInstance=function($x){var $I=$_.getClass($x);return $I?new $I:(console.warn("[error] Undefined class:",$x),null)},$_.createByJson=function($x,$I,$z,$k,$l){"string"==typeof $x&&($x=JSON.parse($x));var $n=$x.props;if(!$I&&!($I=$l?$l.runWith($x):$_.getInstance($n.runtime||$x.type)))return null;var $a=$x.child;if($a)for(var $$=0,$w=$a.length;$$<$w;$$++){var $i=$a[$$];if("render"!==$i.props.name&&"render"!==$i.props.renderType||!$I._$set_itemRender)if("Graphic"==$i.type)$_.addGraphicsToSprite($i,$I);else if($_.isDrawType($i.type))$_.addGraphicToSprite($i,$I,!0);else{var $F=$_.createByJson($i,null,$z,$k,$l);"Script"==$i.type?$F.hasOwnProperty("owner")?$F.owner=$I:$F.hasOwnProperty("target")&&($F.target=$I):"mask"==$i.props.renderType?$I.mask=$F:$I.addChild($F)}else $I.itemRender=$i}if($n)for(var $b in $n){var $T=$n[$b];"var"===$b&&$z?$z[$T]=$I:$T instanceof Array&&"function"==typeof $I[$b]?$I[$b].apply($I,$T):$I[$b]=$T}return $k&&$x.customProps&&$k.runWith([$I,$x]),$I.created&&$I.created(),$I},$_.addGraphicsToSprite=function($x,$I){var $z;if(($z=$x.child)&&!($z.length<1)){var $k;$k=$_._getGraphicsFromSprite($x,$I);var $l=0,$n=0;$x.props&&($l=$_._getObjVar($x.props,"x",0),$n=$_._getObjVar($x.props,"y",0)),0!=$l&&0!=$n&&$k.translate($l,$n);var $a,$$=0;for($a=$z.length,$$=0;$$<$a;$$++)$_._addGraphicToGraphics($z[$$],$k);0!=$l&&0!=$n&&$k.translate(-$l,-$n)}},$_.addGraphicToSprite=function($x,$I,$z){var $k;void 0===$z&&($z=!1),$k=$z?$_._getGraphicsFromSprite($x,$I):$I.graphics,$_._addGraphicToGraphics($x,$k)},$_._getGraphicsFromSprite=function($x,$I){var $z,$k;if(!$x||!$x.props)return $I.graphics;switch($k=$x.props.renderType){case"hit":case"unHit":var $l;$I.hitArea||($I.hitArea=new $A),($l=$I.hitArea)[$k]||($l[$k]=new $T),$z=$l[$k]}return $z||($z=$I.graphics),$z},$_._getTransformData=function($x){var $I;($x.hasOwnProperty("pivotX")||$x.hasOwnProperty("pivotY"))&&($I=$I||new $U).translate(-$_._getObjVar($x,"pivotX",0),-$_._getObjVar($x,"pivotY",0));var $z=$_._getObjVar($x,"scaleX",1),$k=$_._getObjVar($x,"scaleY",1),$l=$_._getObjVar($x,"rotation",0);$_._getObjVar($x,"skewX",0),$_._getObjVar($x,"skewY",0);return 1==$z&&1==$k&&0==$l||(($I=$I||new $U).scale($z,$k),$I.rotate(.0174532922222222*$l)),$I},$_._addGraphicToGraphics=function($x,$I){var $z,$k;if(($z=$x.props)&&($k=$_.DrawTypeDic[$x.type])){var $l,$n;$l=$I;var $a=$_._getParams($z,$k[1],$k[2],$k[3]);(($n=$_._tM)||1!=$_._alpha)&&($l.save(),$n&&$l.transform($n),1!=$_._alpha&&$l.alpha($_._alpha)),$l[$k[0]].apply($l,$a),($n||1!=$_._alpha)&&$l.restore()}},$_._adptLineData=function($x){return $x[2]=parseFloat($x[0])+parseFloat($x[2]),$x[3]=parseFloat($x[1])+parseFloat($x[3]),$x},$_._adptTextureData=function($x){return $x[0]=$$x.getRes($x[0]),$x},$_._adptLinesData=function($x){return $x[2]=$_._getPointListByStr($x[2]),$x},$_.isDrawType=function($x){return"Image"!=$x&&$_.DrawTypeDic.hasOwnProperty($x)},$_._getParams=function($x,$I,$z,$k){var $l;void 0===$z&&($z=0),($l=$_._temParam).length=$I.length;var $n,$a,$$=0;for($n=$I.length,$$=0;$$<$n;$$++)$l[$$]=$_._getObjVar($x,$I[$$][0],$I[$$][1]);return $_._alpha=$_._getObjVar($x,"alpha",1),$a=$_._getTransformData($x),$_._tM=$a?($z||($z=0),$a.translate($l[$z],$l[$z+1]),$l[$z]=$l[$z+1]=0,$a):null,$k&&$_[$k]&&($l=$_[$k]($l)),$l},$_._getPointListByStr=function($x){var $I,$z,$k=0;for($z=($I=$x.split(",")).length,$k=0;$k<$z;$k++)$I[$k]=parseFloat($I[$k]);return $I},$_._getObjVar=function($x,$I,$z){return $x.hasOwnProperty($I)?$x[$I]:$z},$_._temParam=[],$_._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$_.getClass=function($x){var $I=$_._classMap[$x]||$x;return"string"==typeof $I?$v.__classmap[$I]:$I},$_._tM=null,$_._alpha=NaN,$w($_,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$_}(),$h=function(){function $n($x){if(this._color=[],"string"==typeof $x){null===(this.strColor=$x)&&($x="#000000"),"#"==$x.charAt(0)&&($x=$x.substr(1));var $I=$x.length;if(3==$I||4==$I){for(var $z="",$k=0;$k<$I;$k++)$z+=$x[$k]+$x[$k];$x=$z}var $l=this.numColor=parseInt($x,16);if(8==$x.length)return void(this._color=[parseInt($x.substr(0,2),16)/255,((16711680&$l)>>16)/255,((65280&$l)>>8)/255,(255&$l)/255])}else $l=this.numColor=$x,this.strColor=$g.toHexColor($l);this._color=[((16711680&$l)>>16)/255,((65280&$l)>>8)/255,(255&$l)/255,1],this._color.__id=++$n._COLODID}return $N($n,"laya.utils.Color"),$n._initDefault=function(){for(var $x in $n._DEFAULT={},$n._COLOR_MAP)$n._SAVE[$x]=$n._DEFAULT[$x]=new $n($n._COLOR_MAP[$x]);return $n._DEFAULT},$n._initSaveMap=function(){for(var $x in $n._SAVE_SIZE=0,$n._SAVE={},$n._DEFAULT)$n._SAVE[$x]=$n._DEFAULT[$x]},$n.create=function($x){var $I=$n._SAVE[$x+""];return null!=$I?$I:($n._SAVE_SIZE<1e3||$n._initSaveMap(),$n._SAVE[$x+""]=new $n($x))},$n._SAVE={},$n._SAVE_SIZE=0,$n._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$n._DEFAULT=$n._initDefault(),$n._COLODID=1,$n}(),$B=(function(){function $x(){this._values=[],this._keys=[]}$N($x,"laya.utils.Dictionary");var $I=$x.prototype;$I.set=function($x,$I){var $z=this.indexOf($x);0<=$z?this._values[$z]=$I:(this._keys.push($x),this._values.push($I))},$I.indexOf=function($x){var $I=this._keys.indexOf($x);return 0<=$I?$I:($x="string"==typeof $x?Number($x):"number"==typeof $x?$x.toString():$x,this._keys.indexOf($x))},$I.get=function($x){var $I=this.indexOf($x);return $I<0?null:this._values[$I]},$I.remove=function($x){var $I=this.indexOf($x);return 0<=$I&&(this._keys.splice($I,1),this._values.splice($I,1),!0)},$I.clear=function(){this._values.length=0,this._keys.length=0},$F(0,$I,"values",function(){return this._values}),$F(0,$I,"keys",function(){return this._keys})}(),function(){function $x(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$N($x,"laya.utils.Dragging");var $I=$x.prototype;return $I.start=function($x,$I,$z,$k,$l,$n,$a,$$){void 0===$$&&($$=.92),this.clearTimer(),this.target=$x,this.area=$I,this.hasInertia=$z,this.elasticDistance=$I?$k:0,this.elasticBackTime=$l,this.data=$n,this._disableMouseEvent=$a,this.ratio=$$,1!=$x.globalScaleX||1!=$x.globalScaleY?this._parent=$x.parent:this._parent=$v.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$v.stage.on("mouseup",this,this.onStageMouseUp),$v.stage.on("mouseout",this,this.onStageMouseUp),$v.timer.frameLoop(1,this,this.loop)},$I.clearTimer=function(){$v.timer.clear(this,this.loop),$v.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$I.stop=function(){this._dragging&&($s.instance.disableMouseEvent=!1,$v.stage.off("mouseup",this,this.onStageMouseUp),$v.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$I.loop=function(){var $x=this._parent.getMousePoint(),$I=$x.x,$z=$x.y,$k=$I-this._lastX,$l=$z-this._lastY;if(this._clickOnly){if(!(1<Math.abs($k*$v.stage._canvasTransform.getScaleX())||1<Math.abs($l*$v.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$s.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($k,$l);0==$k&&0==$l||(this._lastX=$I,this._lastY=$z,this.target.x+=$k*this._elasticRateX,this.target.y+=$l*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$I.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $x=this.area.x-this.target.x;else $x=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$x/this.elasticDistance),this.target.y<this.area.y)var $I=this.area.y-this.target.y;else $I=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$I/this.elasticDistance)}},$I.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$I.onStageMouseUp=function($x){if($s.instance.disableMouseEvent=!1,$v.stage.off("mouseup",this,this.onStageMouseUp),$v.stage.off("mouseout",this,this.onStageMouseUp),$v.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $I=this._offsets.length,$z=Math.min($I,6),$k=this._offsets.length-$z,$l=$I-1;$k<$l;$l--)this._offsetY+=this._offsets[$l--],this._offsetX+=this._offsets[$l];this._offsetX=this._offsetX/$z*2,this._offsetY=this._offsetY/$z*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$v.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$I.checkElastic=function(){var $x=NaN,$I=NaN;if(this.target.x<this.area.x?$x=this.area.x:this.target.x>this.area.x+this.area.width&&($x=this.area.x+this.area.width),this.target.y<this.area.y?$I=this.area.y:this.target.y>this.area.y+this.area.height&&($I=this.area.y+this.area.height),isNaN($x)&&isNaN($I))this.clear();else{var $z={};isNaN($x)||($z.x=$x),isNaN($I)||($z.y=$I),this._tween=$r.to(this.target,$z,this.elasticBackTime,$e.sineOut,$f.create(this,this.clear),0,!1,!1)}},$I.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($v.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$I.clear=function(){if(this.target){this.clearTimer();var $x=this.target;this.target=null,this._parent=null,$x.event("dragend",this.data)}},$x}()),$e=function(){function $$(){}return $N($$,"laya.utils.Ease"),$$.linearNone=function($x,$I,$z,$k){return $z*$x/$k+$I},$$.linearIn=function($x,$I,$z,$k){return $z*$x/$k+$I},$$.linearInOut=function($x,$I,$z,$k){return $z*$x/$k+$I},$$.linearOut=function($x,$I,$z,$k){return $z*$x/$k+$I},$$.bounceIn=function($x,$I,$z,$k){return $z-$$.bounceOut($k-$x,0,$z,$k)+$I},$$.bounceInOut=function($x,$I,$z,$k){return $x<.5*$k?.5*$$.bounceIn(2*$x,0,$z,$k)+$I:.5*$$.bounceOut(2*$x-$k,0,$z,$k)+.5*$z+$I},$$.bounceOut=function($x,$I,$z,$k){return($x/=$k)<1/2.75?$z*(7.5625*$x*$x)+$I:$x<2/2.75?$z*(7.5625*($x-=1.5/2.75)*$x+.75)+$I:$x<2.5/2.75?$z*(7.5625*($x-=2.25/2.75)*$x+.9375)+$I:$z*(7.5625*($x-=2.625/2.75)*$x+.984375)+$I},$$.backIn=function($x,$I,$z,$k,$l){return void 0===$l&&($l=1.70158),$z*($x/=$k)*$x*(($l+1)*$x-$l)+$I},$$.backInOut=function($x,$I,$z,$k,$l){return void 0===$l&&($l=1.70158),($x/=.5*$k)<1?.5*$z*($x*$x*((1+($l*=1.525))*$x-$l))+$I:$z/2*(($x-=2)*$x*((1+($l*=1.525))*$x+$l)+2)+$I},$$.backOut=function($x,$I,$z,$k,$l){return void 0===$l&&($l=1.70158),$z*(($x=$x/$k-1)*$x*(($l+1)*$x+$l)+1)+$I},$$.elasticIn=function($x,$I,$z,$k,$l,$n){var $a;return void 0===$l&&($l=0),void 0===$n&&($n=0),0==$x?$I:1==($x/=$k)?$I+$z:($n||($n=.3*$k),$a=!$l||0<$z&&$l<$z||$z<0&&$l<-$z?($l=$z,$n/4):$n/$$.PI2*Math.asin($z/$l),-$l*Math.pow(2,10*($x-=1))*Math.sin(($x*$k-$a)*$$.PI2/$n)+$I)},$$.elasticInOut=function($x,$I,$z,$k,$l,$n){var $a;return void 0===$l&&($l=0),void 0===$n&&($n=0),0==$x?$I:2==($x/=.5*$k)?$I+$z:($n||($n=$k*(.3*1.5)),$a=!$l||0<$z&&$l<$z||$z<0&&$l<-$z?($l=$z,$n/4):$n/$$.PI2*Math.asin($z/$l),$x<1?$l*Math.pow(2,10*($x-=1))*Math.sin(($x*$k-$a)*$$.PI2/$n)*-.5+$I:$l*Math.pow(2,-10*($x-=1))*Math.sin(($x*$k-$a)*$$.PI2/$n)*.5+$z+$I)},$$.elasticOut=function($x,$I,$z,$k,$l,$n){var $a;return void 0===$l&&($l=0),void 0===$n&&($n=0),0==$x?$I:1==($x/=$k)?$I+$z:($n||($n=.3*$k),$a=!$l||0<$z&&$l<$z||$z<0&&$l<-$z?($l=$z,$n/4):$n/$$.PI2*Math.asin($z/$l),$l*Math.pow(2,-10*$x)*Math.sin(($x*$k-$a)*$$.PI2/$n)+$z+$I)},$$.strongIn=function($x,$I,$z,$k){return $z*($x/=$k)*$x*$x*$x*$x+$I},$$.strongInOut=function($x,$I,$z,$k){return($x/=.5*$k)<1?.5*$z*$x*$x*$x*$x*$x+$I:.5*$z*(($x-=2)*$x*$x*$x*$x+2)+$I},$$.strongOut=function($x,$I,$z,$k){return $z*(($x=$x/$k-1)*$x*$x*$x*$x+1)+$I},$$.sineInOut=function($x,$I,$z,$k){return.5*-$z*(Math.cos(Math.PI*$x/$k)-1)+$I},$$.sineIn=function($x,$I,$z,$k){return-$z*Math.cos($x/$k*$$.HALF_PI)+$z+$I},$$.sineOut=function($x,$I,$z,$k){return $z*Math.sin($x/$k*$$.HALF_PI)+$I},$$.quintIn=function($x,$I,$z,$k){return $z*($x/=$k)*$x*$x*$x*$x+$I},$$.quintInOut=function($x,$I,$z,$k){return($x/=.5*$k)<1?.5*$z*$x*$x*$x*$x*$x+$I:.5*$z*(($x-=2)*$x*$x*$x*$x+2)+$I},$$.quintOut=function($x,$I,$z,$k){return $z*(($x=$x/$k-1)*$x*$x*$x*$x+1)+$I},$$.quartIn=function($x,$I,$z,$k){return $z*($x/=$k)*$x*$x*$x+$I},$$.quartInOut=function($x,$I,$z,$k){return($x/=.5*$k)<1?.5*$z*$x*$x*$x*$x+$I:.5*-$z*(($x-=2)*$x*$x*$x-2)+$I},$$.quartOut=function($x,$I,$z,$k){return-$z*(($x=$x/$k-1)*$x*$x*$x-1)+$I},$$.cubicIn=function($x,$I,$z,$k){return $z*($x/=$k)*$x*$x+$I},$$.cubicInOut=function($x,$I,$z,$k){return($x/=.5*$k)<1?.5*$z*$x*$x*$x+$I:.5*$z*(($x-=2)*$x*$x+2)+$I},$$.cubicOut=function($x,$I,$z,$k){return $z*(($x=$x/$k-1)*$x*$x+1)+$I},$$.quadIn=function($x,$I,$z,$k){return $z*($x/=$k)*$x+$I},$$.quadInOut=function($x,$I,$z,$k){return($x/=.5*$k)<1?.5*$z*$x*$x+$I:.5*-$z*(--$x*($x-2)-1)+$I},$$.quadOut=function($x,$I,$z,$k){return-$z*($x/=$k)*($x-2)+$I},$$.expoIn=function($x,$I,$z,$k){return 0==$x?$I:$z*Math.pow(2,10*($x/$k-1))+$I-.001*$z},$$.expoInOut=function($x,$I,$z,$k){return 0==$x?$I:$x==$k?$I+$z:($x/=.5*$k)<1?.5*$z*Math.pow(2,10*($x-1))+$I:.5*$z*(2-Math.pow(2,-10*--$x))+$I},$$.expoOut=function($x,$I,$z,$k){return $x==$k?$I+$z:$z*(1-Math.pow(2,-10*$x/$k))+$I},$$.circIn=function($x,$I,$z,$k){return-$z*(Math.sqrt(1-($x/=$k)*$x)-1)+$I},$$.circInOut=function($x,$I,$z,$k){return($x/=.5*$k)<1?.5*-$z*(Math.sqrt(1-$x*$x)-1)+$I:.5*$z*(Math.sqrt(1-($x-=2)*$x)+1)+$I},$$.circOut=function($x,$I,$z,$k){return $z*Math.sqrt(1-($x=$x/$k-1)*$x)+$I},$$.HALF_PI=.5*Math.PI,$$.PI2=2*Math.PI,$$}(),$A=function(){function $b(){this._hit=null,this._unHit=null}$N($b,"laya.utils.HitArea");var $x=$b.prototype;return $x.isHit=function($x,$I){return!!$b.isHitGraphic($x,$I,this.hit)&&!$b.isHitGraphic($x,$I,this.unHit)},$x.contains=function($x,$I){return this.isHit($x,$I)},$F(0,$x,"hit",function(){return this._hit||(this._hit=new $T),this._hit},function($x){this._hit=$x}),$F(0,$x,"unHit",function(){return this._unHit||(this._unHit=new $T),this._unHit},function($x){this._unHit=$x}),$b.isHitGraphic=function($x,$I,$z){if(!$z)return!1;var $k;if(!($k=$z.cmds)&&$z._one&&(($k=$b._cmds).length=1,$k[0]=$z._one),!$k)return!1;var $l,$n,$a=0;for($l=$k.length,$a=0;$a<$l;$a++)if($n=$k[$a]){var $$=$j._context;switch($n.callee){case $$._translate:case 6:$x-=$n[0],$I-=$n[1]}if($b.isHitCmd($x,$I,$n))return!0}return!1},$b.isHitCmd=function($x,$I,$z){if(!$z)return!1;var $k=$j._context,$l=!1;switch($z.callee){case $k._drawRect:case 13:$b._rec.setTo($z[0],$z[1],$z[2],$z[3]),$l=$b._rec.contains($x,$I);break;case $k._drawCircle:case $k._fillCircle:case 14:$l=($x-=$z[0])*$x+($I-=$z[1])*$I<$z[2]*$z[2];break;case $k._drawPoly:case 18:$x-=$z[0],$I-=$z[1],$l=$b.ptInPolygon($x,$I,$z[2])}return $l},$b.ptInPolygon=function($x,$I,$z){var $k;($k=$b._ptPoint).setTo($x,$I);var $l,$n=0,$a=NaN,$$=NaN,$w=NaN,$i=NaN;$l=$z.length;for(var $F=0;$F<$l;$F+=2){if($a=$z[$F],$$=$z[$F+1],$w=$z[($F+2)%$l],$$!=($i=$z[($F+3)%$l]))if(!($k.y<Math.min($$,$i)))if(!($k.y>=Math.max($$,$i)))($k.y-$$)*($w-$a)/($i-$$)+$a>$k.x&&$n++}return $n%2==1},$b._cmds=[],$w($b,["_rec",function(){return this._rec=new $K},"_ptPoint",function(){return this._ptPoint=new $L}]),$b}(),$H=(function(){function $l($x,$I,$z,$k){this.char=$x,this.charNum=$x.charCodeAt(0),this._x=this._y=0,this.width=$I,this.height=$z,this.style=$k,this.isWord=!$l._isWordRegExp.test($x)}$N($l,"laya.utils.HTMLChar");var $x=$l.prototype;$v.imps($x,{"laya.display.ILayout":!0}),$x.setSprite=function($x){this._sprite=$x},$x.getSprite=function(){return this._sprite},$x._isChar=function(){return!0},$x._getCSSStyle=function(){return this.style},$F(0,$x,"width",function(){return this._w},function($x){this._w=$x}),$F(0,$x,"x",function(){return this._x},function($x){this._sprite&&(this._sprite.x=$x),this._x=$x}),$F(0,$x,"y",function(){return this._y},function($x){this._sprite&&(this._sprite.y=$x),this._y=$x}),$F(0,$x,"height",function(){return this._h},function($x){this._h=$x}),$l._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $I(){}$N($I,"laya.utils.Log"),$I.enable=function(){$I._logdiv||($I._logdiv=$W.window.document.createElement("div"),$W.window.document.body.appendChild($I._logdiv),$I._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$I.toggle=function(){var $x=$I._logdiv.style;"1px"==$x.width?$x.width=$x.height="50%":$x.width=$x.height="1px"},$I.print=function($x){$I._logdiv&&($I.maxCount<=$I._count&&$I.clear(),$I._count++,$I._logdiv.innerText+=$x+"\n",$I._logdiv.scrollTop=$I._logdiv.scrollHeight)},$I.clear=function(){$I._logdiv.innerText="",$I._count=0},$I._logdiv=null,$I._count=0,$I.maxCount=20}(),function(){function $I(){}$N($I,"laya.utils.Mouse"),$F(1,$I,"cursor",function(){return $I._style.cursor},function($x){$I._style.cursor=$x}),$I.hide=function(){"none"!=$I.cursor&&($I._preCursor=$I.cursor,$I.cursor="none")},$I.show=function(){"none"==$I.cursor&&($I.cursor=$I._preCursor?$I._preCursor:"auto")},$I._preCursor=null,$w($I,["_style",function(){return this._style=$W.document.body.style}])}(),function(){function $n(){}return $N($n,"laya.utils.Pool"),$n.getPoolBySign=function($x){return $n._poolDic[$x]||($n._poolDic[$x]=[])},$n.clearBySign=function($x){$n._poolDic[$x]&&($n._poolDic[$x].length=0)},$n.recover=function($x,$I){$I.__InPool||($I.__InPool=!0,$n.getPoolBySign($x).push($I))},$n.getItemByClass=function($x,$I){var $z=$n.getPoolBySign($x),$k=$z.length?$z.pop():new $I;return $k.__InPool=!1,$k},$n.getItemByCreateFun=function($x,$I,$z){var $k=$n.getPoolBySign($x),$l=$k.length?$k.pop():$I.call($z);return $l.__InPool=!1,$l},$n.getItem=function($x){var $I=$n.getPoolBySign($x),$z=$I.length?$I.pop():null;return $z&&($z.__InPool=!1),$z},$n._poolDic={},$n.InPoolSign="__InPool",$n}()),$p=function(){function $w(){}return $N($w,"laya.utils.Stat"),$F(1,$w,"onclick",null,function($x){$w._sp&&$w._sp.on("click",$w._sp,$x),$w._canvas&&($w._canvas.source.onclick=$x,$w._canvas.source.style.pointerEvents="")}),$w.show=function($x,$I,$z){if(void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),!$j.isConchApp||$j.isConchWebGL){if($j.isConchWebGL||$W.onMiniGame||$W.onLimixiu||($w._useCanvas=!0),$w._show=!0,$w._fpsData.length=60,$w._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$w._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$w._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$w._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$j.isWebGL)if($w._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$j.is3DMode){if($w._view[0].title="FPS(3D)",$w._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$w._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$w._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$z){var $k=8;$w._view[$k++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$w._view[$k++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$w._view[$k++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$w._view[$k++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$w._view[$k++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$w._view[$k++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$w._view[$k++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$w._view[$k++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$w._view[$k++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$z){$k=8;$w._view[$k++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$w._view[$k++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$w._view[$k++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$w._view[$k++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$w._view[$k++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$w._view[$k++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$w._view[$k++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $w._view[0].title="FPS(WebGL)",$w._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $w._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$w._useCanvas?$w.createUIPre($x,$I):$w.createUI($x,$I),$w.enable()}else $W.window.conch.showFPS&&$W.window.conch.showFPS($x,$I)},$w.createUIPre=function($x,$I){var $z=$W.pixelRatio;$w._width=170*$z,$w._vx=75*$z,$w._height=$z*(12*$w._view.length+3*$z)+4,$w._fontSize=12*$z;for(var $k=0;$k<$w._view.length;$k++)$w._view[$k].x=4,$w._view[$k].y=$k*$w._fontSize+2*$z;$w._canvas||(($w._canvas=new $mx("2D")).size($w._width,$w._height),($w._ctx=$w._canvas.getContext("2d")).textBaseline="top",$w._ctx.font=$w._fontSize+"px Sans-serif",$w._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$x+"px;top:"+$I+"px;width:"+$w._width/$z+"px;height:"+$w._height/$z+"px;"),$w._first=!0,$w.loop(),$w._first=!1,$W.container.appendChild($w._canvas.source)},$w.createUI=function($x,$I){var $z=$w._sp,$k=$W.pixelRatio;$z||($z=new $bx,($w._leftText=new $Nx).pos(5,5),$w._leftText.color="#ffffff",$z.addChild($w._leftText),($w._txt=new $Nx).pos(80*$k,5),$w._txt.color="#ffffff",$z.addChild($w._txt),$w._sp=$z),$z.pos($x,$I);for(var $l="",$n=0;$n<$w._view.length;$n++){$l+=$w._view[$n].title+"\n"}$w._leftText.text=$l;var $a=170*$k,$$=$k*(12*$w._view.length+3*$k)+4;$w._txt.fontSize=$w._fontSize*$k,$w._leftText.fontSize=$w._fontSize*$k,$z.size($a,$$),$z.graphics.clear(),$z.graphics.setAlpha(.5),$z.graphics.drawRect(0,0,$a,$$,"#999999"),$z.graphics.setAlpha(1),$w.loop()},$w.enable=function(){$v.timer.frameLoop(1,$w,$w.loop)},$w.hide=function(){$w._show=!1,$v.timer.clear($w,$w.loop),$w._canvas&&$W.removeElement($w._canvas.source)},$w.clear=function(){$w.trianglesFaces=$w.drawCall=$w.shaderCall=$w.spriteCount=$w.spriteRenderUseCacheCount=$w.treeNodeCollision=$w.treeSpriteCollision=$w.canvasNormal=$w.canvasBitmap=$w.canvasReCache=0},$w.loop=function(){$w._count++;var $x=$W.now();if(!($x-$w._timer<1e3)){var $I=$w._count;if($w.FPS=Math.round(1e3*$I/($x-$w._timer)),$w._show){$w.trianglesFaces=Math.round($w.trianglesFaces/$I),$w.spriteCount=$w._useCanvas?($w.drawCall=Math.round($w.drawCall/$I)-2,$w.shaderCall=Math.round($w.shaderCall/$I),Math.round($w.spriteCount/$I)-1):($w.drawCall=Math.round($w.drawCall/$I)-2,$w.shaderCall=Math.round($w.shaderCall/$I)-4,Math.round($w.spriteCount/$I)-4),$w.spriteRenderUseCacheCount=Math.round($w.spriteRenderUseCacheCount/$I),$w.canvasNormal=Math.round($w.canvasNormal/$I),$w.canvasBitmap=Math.round($w.canvasBitmap/$I),$w.canvasReCache=Math.ceil($w.canvasReCache/$I),$w.treeNodeCollision=Math.round($w.treeNodeCollision/$I),$w.treeSpriteCollision=Math.round($w.treeSpriteCollision/$I);var $z=0<$w.FPS?Math.floor(1e3/$w.FPS).toString():" ";$w._fpsStr=$w.FPS+($w.renderSlow?" slow":"")+" "+$z,$w._spriteStr=$w.spriteCount+($w.spriteRenderUseCacheCount?"/"+$w.spriteRenderUseCacheCount:""),$w._canvasStr=$w.canvasReCache+"/"+$w.canvasNormal+"/"+$w.canvasBitmap,$w.currentMemorySize=$V.systemResourceManager.memorySize,$w._useCanvas?$w.renderInfoPre():$w.renderInfo(),$w.clear()}$w._count=0,$w._timer=$x}},$w.renderInfoPre=function(){if($w._canvas){var $x=$w._ctx;$x.clearRect($w._first?0:$w._vx,0,$w._width,$w._height);for(var $I=$j.WebGL.mainContext,$z=0;$z<$w._view.length;$z++){var $k=$w._view[$z];$w._first&&($x.fillStyle="white",$x.fillText($k.title,$k.x,$k.y,null,null,null)),$x.fillStyle=$k.color;var $l=-1;if(($k=$w._view[$z]).varying){if($I)switch($k.varying){case 1:$l=$I.getParameter($I[$k.value]);break;case 2:$l=$I.getExtension($k.value)}}else $l=$w[$k.value];"M"==$k.units&&($l=Math.floor($l/1048576*100)/100+" M"),"K"==$k.units&&($l=Math.floor($l/1024*100)/100+" K"),"string"==$k.units&&($l=$l.match(/\d+\.?\d/i)),$x.fillText($l+"",$k.x+$w._vx,$k.y,null,null,null)}}},$w.renderInfo=function(){for(var $x="",$I=$j.WebGL.mainContext,$z=0;$z<$w._view.length;$z++){var $k=$w._view[$z],$l=-1;if($k.varying){if($I)switch($k.varying){case 1:$l=$I.getParameter($I[$k.value]);break;case 2:$l=$I.getExtension($k.value)}}else $l=$w[$k.value];"M"==$k.units&&($l=Math.floor($l/1048576*100)/100+" M"),"K"==$k.units&&($l=Math.floor($l/1024*100)/100+" K"),"string"==$k.units&&($l=$l.match(/\d+\.?\d/i)),$x+=$l+"\n"}$w._txt.text=$x},$w.FPS=0,$w.loopCount=0,$w.shaderCall=0,$w.drawCall=0,$w.trianglesFaces=0,$w.spriteCount=0,$w.spriteRenderUseCacheCount=0,$w.treeNodeCollision=0,$w.treeSpriteCollision=0,$w.canvasNormal=0,$w.canvasBitmap=0,$w.canvasReCache=0,$w.renderSlow=!1,$w.currentMemorySize=0,$w._fpsStr=null,$w._canvasStr=null,$w._spriteStr=null,$w._fpsData=[],$w._timer=0,$w._count=0,$w._view=[],$w._fontSize=12,$w._txt=null,$w._leftText=null,$w._sp=null,$w._show=!1,$w._useCanvas=!1,$w._canvas=null,$w._ctx=null,$w._first=!1,$w._vx=NaN,$w._width=0,$w._height=100,$w}(),$u=(function(){function $x(){this._strsToID={},this._idToStrs=[],this._length=0}$N($x,"laya.utils.StringKey");var $I=$x.prototype;$I.add=function($x){var $I=this._strsToID[$x];return null!=$I?$I:(this._idToStrs[this._length]=$x,this._strsToID[$x]=this._length++)},$I.getID=function($x){var $I=this._strsToID[$x];return null==$I?-1:$I},$I.getName=function($x){var $I=this._idToStrs[$x];return null==$I?void 0:$I}}(),function(){var $i;function $x(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$N($x,"laya.utils.Timer");var $I=$x.prototype;return $I._init=function(){$v.timer&&$v.timer.frameLoop(1,this,this._update)},$I._now=function(){return Date.now()},$I._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $x=this.currFrame=this.currFrame+this.scale,$I=this._now();this._delta=($I-this._lastTimer)*this.scale;var $z=this.currTimer=this.currTimer+this._delta;$v.isDebug&&6e4<Math.abs($I-this._lastTimer)&&console.error("系统时间错误！"+($I-this._lastTimer)),this._lastTimer=$I;var $k=this._handlers;for($a=this._count=0,$$=$k.length;$a<$$;$a++)if(null!==($w=$k[$a]).method){var $l=$w.userFrame?$x:$z;if($l>=$w.exeTime)if($w.repeat)if($w.jumpFrame)for(;$l>=$w.exeTime;)$w.exeTime+=$w.delay,$w.run(!1);else $w.exeTime+=$w.delay,$w.run(!1),$l>$w.exeTime&&($w.exeTime+=Math.ceil(($l-$w.exeTime)/$w.delay)*$w.delay);else $w.run(!0)}else this._count++;(30<this._count||$x%200==0)&&this._clearHandlers();for(var $n=this._laters,$a=0,$$=$n.length-1;$a<=$$;$a++){var $w=$n[$a];this._isIgnoreRecover($w)||(null!==$w.method&&(delete this._map[$w.key],$w.run(!1)),this._recoverHandler($w)),$a===$$&&($$=$n.length-1)}$n.length=0}},$I._clearHandlers=function(){for(var $x=this._handlers,$I=0,$z=$x.length;$I<$z;$I++){var $k=$x[$I];null!==$k.method?this._temp.push($k):this._isIgnoreRecover($k)?this._temp.push($k):this._recoverHandler($k)}this._handlers=this._temp,this._temp=$x,this._temp.length=0},$I._recoverHandler=function($x){this._map[$x.key]==$x&&delete this._map[$x.key],$x.recover()},$I._create=function($x,$I,$z,$k,$l,$n,$a,$$){if(!$z)return $l.apply($k,$n),null;if($a){var $w=this._getHandler($k,$l);if($w)return $w.repeat=$I,$w.userFrame=$x,$w.delay=$z,$w.ignoreRecover=$$,$w.caller=$k,$w.method=$l,$w.args=$n,$w.exeTime=$z+($x?this.currFrame:this.currTimer+this._now()-this._lastTimer),$w}return($w=$i.create()).repeat=$I,$w.userFrame=$x,$w.delay=$z,$w.ignoreRecover=$$,$w.caller=$k,$w.method=$l,$w.args=$n,$w.exeTime=$z+($x?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($w),this._handlers.push($w),$w},$I._indexHandler=function($x){var $I=$x.caller,$z=$x.method,$k=$I?$I.$_GID||($I.$_GID=$g.getGID()):0,$l=$z.$_TID||($z.$_TID=this._mid++);$x.key=$k+"_"+$l,this._map[$x.key]=$x},$I.once=function($x,$I,$z,$k,$l){void 0===$l&&($l=!0),this._create(!1,!1,$x,$I,$z,$k,$l,!1)},$I.loop=function($x,$I,$z,$k,$l,$n,$a){void 0===$l&&($l=!0),void 0===$n&&($n=!1),void 0===$a&&($a=!1);var $$=this._create(!1,!0,$x,$I,$z,$k,$l,$a);$$&&($$.jumpFrame=$n)},$I.frameOnce=function($x,$I,$z,$k,$l){void 0===$l&&($l=!0),this._create(!0,!1,$x,$I,$z,$k,$l,!1)},$I.frameLoop=function($x,$I,$z,$k,$l,$n){void 0===$l&&($l=!0),void 0===$n&&($n=!1),this._create(!0,!0,$x,$I,$z,$k,$l,$n)},$I.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$i._freeCount},$I.clear=function($x,$I){var $z=this._getHandler($x,$I);return!(!$z||this._isIgnoreRecover($z))&&(delete this._map[$z.key],$z.key=null,$z.clear(),!0)},$I.clearAll=function($x){if($x)for(var $I=0,$z=this._handlers.length;$I<$z;$I++){var $k=this._handlers[$I];$k.caller===$x&&(this._isIgnoreRecover($k)||(delete this._map[$k.key],$k.key=null,$k.clear()))}},$I._getHandler=function($x,$I){var $z=$x?$x.$_GID||($x.$_GID=$g.getGID()):0,$k=$I.$_TID||($I.$_TID=this._mid++);return this._map[$z+"_"+$k]},$I._isIgnoreRecover=function($x){if($x.ignoreRecover||$x.caller&&"IgnoreRecover"==$x.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $I="";try{arguments.propertyIsEnumerable.caller}catch($x){$I=$x.stack}$v.recordError("报错：核心定时器销毁忽略  "+$I)}return!0}return!1},$I.hasHandler=function($x,$I){return this._map[$x.$_GID+"_"+$I.$_TID]},$I.callLater=function($x,$I,$z){if(null==this._getHandler($x,$I)){var $k=$i.create();$k.caller=$x,$k.method=$I,$k.args=$z,this._indexHandler($k),this._laters.push($k)}},$I.runCallLater=function($x,$I){var $z=this._getHandler($x,$I);$z&&null!=$z.method&&(this._isIgnoreRecover($z)||(delete this._map[$z.key],$z.run(!0)))},$I.runTimer=function($x,$I){this.runCallLater($x,$I)},$F(0,$I,"delta",function(){return this._delta}),$x.__init$=function(){$i=function(){function $I(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$N($I,"");var $x=$I.prototype;return $x.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$x.recover=function(){this.clear(),this.args=$I._freeHandler,$I._freeHandler=this,$I._freeCount++},$x.run=function($x){var $I=this.caller;if($I&&$I.destroyed)return this.clear();var $z=this.method,$k=this.args;$x&&this.clear(),null!=$z&&($k?$z.apply($I,$k):$z.call($I))},$I._freeHandler=null,$I._freeCount=0,$I.create=function(){var $x=$I._freeHandler;return $x?($I._freeHandler=$x.args,--$I._freeCount,$x.args=null,$x):new $I},$I}()},$x}()),$r=function(){function $b(){this.gid=0}$N($b,"laya.utils.Tween");var $x=$b.prototype;return $x.to=function($x,$I,$z,$k,$l,$n,$a){return void 0===$n&&($n=0),void 0===$a&&($a=!1),this._create($x,$I,$z,$k,$l,$n,$a,!0,!1,!0)},$x.from=function($x,$I,$z,$k,$l,$n,$a){return void 0===$n&&($n=0),void 0===$a&&($a=!1),this._create($x,$I,$z,$k,$l,$n,$a,!1,!1,!0)},$x._create=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){if(!$x)throw new Error("Tween:target is null");this._target=$x,this._duration=$z,this._ease=$k||$I.ease||$b.easeNone,this._complete=$l||$I.complete,this._delay=$n,this._props=[],this._usedTimer=0,this._startTimer=$W.now(),this._usedPool=$w,this._delayParam=null,this.update=$I.update;var $F=$x.$_GID||($x.$_GID=$g.getGID());return $b.tweenMap[$F]?($a&&$b.clearTween($x),$b.tweenMap[$F].push(this)):$b.tweenMap[$F]=[this],$i?$n<=0?this.firstStart($x,$I,$$):(this._delayParam=[$x,$I,$$],$v.scaleTimer.once($n,this,this.firstStart,this._delayParam)):this._initProps($x,$I,$$),this},$x.firstStart=function($x,$I,$z){this._delayParam=null,$x.destroyed?this.clear():(this._initProps($x,$I,$z),this._beginLoop())},$x._initProps=function($x,$I,$z){for(var $k in $I)if("number"==typeof $x[$k]){var $l=$z?$x[$k]:$I[$k],$n=$z?$I[$k]:$x[$k];this._props.push([$k,$l,$n-$l]),$z||($x[$k]=$l)}},$x._beginLoop=function(){$v.scaleTimer.frameLoop(1,this,this._doEase)},$x._doEase=function(){this._updateEase($W.now())},$x._updateEase=function($x){var $I=this._target;if($I){if($I.destroyed)return $b.clearTween($I);var $z=this._usedTimer=$x-this._startTimer-this._delay;if(!($z<0)){if($z>=this._duration)return this.complete();for(var $k=0<$z?this._ease($z,0,1,this._duration):0,$l=this._props,$n=0,$a=$l.length;$n<$a;$n++){var $$=$l[$n];$I[$$[0]]=$$[1]+$k*$$[2]}this.update&&this.update.run()}}},$x.complete=function(){if(this._target){$v.scaleTimer.runTimer(this,this.firstStart);for(var $x=this._target,$I=this._props,$z=this._complete,$k=0,$l=$I.length;$k<$l;$k++){var $n=$I[$k];$x[$n[0]]=$n[1]+$n[2]}this.update&&this.update.run(),this.clear(),$z&&$z.run()}},$x.pause=function(){$v.scaleTimer.clear(this,this._beginLoop),$v.scaleTimer.clear(this,this._doEase),$v.scaleTimer.clear(this,this.firstStart);var $x;($x=$W.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$x)},$x.setStartTime=function($x){this._startTimer=$x},$x.clear=function(){this._target&&(this._remove(),this._clear())},$x._clear=function(){this.pause(),$v.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$H.recover("tween",this))},$x.recover=function(){this._usedPool=!0,this._clear()},$x._remove=function(){var $x=$b.tweenMap[this._target.$_GID];if($x)for(var $I=0,$z=$x.length;$I<$z;$I++)if($x[$I]===this){$x.splice($I,1);break}},$x.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$W.now(),this._delayParam)$v.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $x=this._props,$I=0,$z=$x.length;$I<$z;$I++){var $k=$x[$I];this._target[$k[0]]=$k[1]}$v.scaleTimer.once(this._delay,this,this._beginLoop)}},$x.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$W.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$v.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$F(0,$x,"progress",null,function($x){var $I=$x*this._duration;this._startTimer=$W.now()-this._delay-$I}),$b.to=function($x,$I,$z,$k,$l,$n,$a,$$){return void 0===$n&&($n=0),void 0===$a&&($a=!1),void 0===$$&&($$=!0),$H.getItemByClass("tween",$b)._create($x,$I,$z,$k,$l,$n,$a,!0,$$,!0)},$b.from=function($x,$I,$z,$k,$l,$n,$a,$$){return void 0===$n&&($n=0),void 0===$a&&($a=!1),void 0===$$&&($$=!0),$H.getItemByClass("tween",$b)._create($x,$I,$z,$k,$l,$n,$a,!1,$$,!0)},$b.clearAll=function($x){if($x&&$x.$_GID){var $I=$b.tweenMap[$x.$_GID];if($I){for(var $z=0,$k=$I.length;$z<$k;$z++)$I[$z]._clear();$I.length=0}}},$b.clear=function($x){$x.clear()},$b.clearTween=function($x){$b.clearAll($x)},$b.easeNone=function($x,$I,$z,$k){return $z*$x/$k+$I},$b.tweenMap={},$b}(),$g=function(){function $$(){}return $N($$,"laya.utils.Utils"),$$.toRadian=function($x){return $x*$$._pi2},$$.toAngle=function($x){return $x*$$._pi},$$.toHexColor=function($x){if($x<0||isNaN($x))return null;for(var $I=$x.toString(16);$I.length<6;)$I="0"+$I;return"#"+$I},$$.getGID=function(){return $$._gid++},$$.concatArray=function($x,$I){if(!$I)return $x;if(!$x)return $I;var $z=0,$k=$I.length;for($z=0;$z<$k;$z++)$x.push($I[$z]);return $x},$$.clearArray=function($x){return $x&&($x.length=0),$x},$$.copyArray=function($x,$I){if($x||($x=[]),!$I)return $x;$x.length=$I.length;var $z=0,$k=$I.length;for($z=0;$z<$k;$z++)$x[$z]=$I[$z];return $x},$$.getGlobalRecByPoints=function($x,$I,$z,$k,$l){var $n,$a;return $n=new $L($I,$z),$n=$x.localToGlobal($n),$a=new $L($k,$l),$a=$x.localToGlobal($a),$K._getWrapRec([$n.x,$n.y,$a.x,$a.y])},$$.getGlobalPosAndScale=function($x){return $$.getGlobalRecByPoints($x,0,0,1,1)},$$.bind=function($x,$I){return $x.bind($I)},$$.measureText=function($x,$I){return $Z.measureText($x,$I)},$$.contextMeasureText=function($x){var $I=$W.context.measureText($x);return $I||($I={width:16,height:16}),$I},$$.updateOrder=function($x){if(!$x||$x.length<2)return!1;for(var $I,$z=1,$k=0,$l=$x.length,$n=NaN;$z<$l;){for($I=$x[$k=$z],$n=$x[$k]._zOrder;-1<--$k&&$x[$k]._zOrder>$n;)$x[$k+1]=$x[$k];$x[$k+1]=$I,$z++}var $a=$I.parent.conchModel;if($a)if(null!=$a.updateZOrder)$a.updateZOrder();else{for($z=0;$z<$l;$z++)$a.removeChild($x[$z].conchModel);for($z=0;$z<$l;$z++)$a.addChildAt($x[$z].conchModel,$z)}return!0},$$.transPointList=function($x,$I,$z){var $k=0,$l=$x.length;for($k=0;$k<$l;$k+=2)$x[$k]+=$I,$x[$k+1]+=$z},$$.parseInt=function($x,$I){void 0===$I&&($I=0);var $z=$W.window.parseInt($x,$I);return isNaN($z)?0:$z},$$.getFileExtension=function($x){$$._extReg.lastIndex=$x.lastIndexOf(".");var $I=$$._extReg.exec($x);return $I&&1<$I.length?$I[1].toLowerCase():null},$$.getTransformRelativeToWindow=function($x,$I,$z){var $k=$v.stage,$l=laya.utils.Utils.getGlobalPosAndScale($x),$n=$k._canvasTransform.clone(),$a=$n.tx,$$=$n.ty;$n.rotate(-Math.PI/180*$v.stage.canvasDegree),$n.scale($v.stage.clientScaleX,$v.stage.clientScaleY);var $w=$v.stage.canvasDegree%180!=0,$i=NaN,$F=NaN;$w?($i=$z+$l.y,$F=$I+$l.x,$i*=$n.d,$F*=$n.a,90==$v.stage.canvasDegree?($i=$a-$i,$F+=$$):($i+=$a,$F=$$-$F)):($i=$I+$l.x,$F=$z+$l.y,$i*=$n.a,$F*=$n.d,$i+=$a,$F+=$$);var $b=NaN,$T=NaN;return $T=$w?($b=$n.d*$l.height,$n.a*$l.width):($b=$n.a*$l.width,$n.d*$l.height),{x:$i,y:$F,scaleX:$b,scaleY:$T}},$$.fitDOMElementInArea=function($x,$I,$z,$k,$l,$n){$x._fitLayaAirInitialized||($x._fitLayaAirInitialized=!0,$x.style.transformOrigin=$x.style.webKittransformOrigin="left top",$x.style.position="absolute");var $a=$$.getTransformRelativeToWindow($I,$z,$k);$x.style.transform=$x.style.webkitTransform="scale("+$a.scaleX+","+$a.scaleY+") rotate("+$v.stage.canvasDegree+"deg)",$x.style.width=$l+"px",$x.style.height=$n+"px",$x.style.left=$a.x+"px",$x.style.top=$a.y+"px"},$$.isOkTextureList=function($x){if(!$x)return!1;var $I,$z=0,$k=$x.length;for($z=0;$z<$k;$z++)if(!($I=$x[$z])||!$I.source)return!1;return!0},$$.isOKCmdList=function($x){if(!$x)return!1;var $I,$z,$k=0,$l=$x.length,$n=$j._context;for($k=0;$k<$l;$k++)switch(($I=$x[$k]).callee){case $n._drawTexture:case $n._fillTexture:case $n._drawTextureWithTransform:if(!($z=$I[0])||!$z.source)return!1}return!0},$$._gid=1,$$._pi=180/Math.PI,$$._pi2=Math.PI/180,$$._extReg=/\.(\w+)\??/g,$$.parseXMLFromString=function($x){var $I;if($x=$x.replace(/>\s+</g,"><"),-1<($I=(new DOMParser).parseFromString($x,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($I.firstChild.firstChild.textContent+",  "+$x);return $I},$$}(),$M=function(){function $x(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$j.isWebGL&&$o.regCacheByFunction($g.bind(this.startDispose,this),$g.bind(this.getCacheList,this))}$N($x,"laya.utils.VectorGraphManager");var $I=$x.prototype;return $I.getId=function(){return this._id++},$I.addShape=function($x,$I){this.shapeDic[$x]=$I,this.useDic[$x]||(this.useDic[$x]=!0)},$I.addLine=function($x,$I){this.shapeLineDic[$x]=$I,this.shapeLineDic[$x]||(this.shapeLineDic[$x]=!0)},$I.getShape=function($x){this._checkKey&&null!=this.useDic[$x]&&(this.useDic[$x]=!0)},$I.deleteShape=function($x){this.shapeDic[$x]&&(this.shapeDic[$x]=null,delete this.shapeDic[$x]),this.shapeLineDic[$x]&&(this.shapeLineDic[$x]=null,delete this.shapeLineDic[$x]),null!=this.useDic[$x]&&delete this.useDic[$x]},$I.getCacheList=function(){var $x,$I=[];for($x in this.shapeDic)$I.push(this.shapeDic[$x]);for($x in this.shapeLineDic)$I.push(this.shapeLineDic[$x]);return $I},$I.startDispose=function($x){var $I;for($I in this.useDic)this.useDic[$I]=!1;this._checkKey=!0},$I.endDispose=function(){if(this._checkKey){var $x;for($x in this.useDic)this.useDic[$x]||this.deleteShape($x);this._checkKey=!1}},$x.getInstance=function(){return $x.instance=$x.instance||new $x},$x.instance=null,$x}(),$Q=function(){function $k(){this._obj=null,this._obj=$k.supportWeakMap?new $W.window.WeakMap:{},$k.supportWeakMap||$k._maps.push(this)}$N($k,"laya.utils.WeakObject");var $x=$k.prototype;return $x.set=function($x,$I){if(null!=$x)if($k.supportWeakMap){var $z=$x;"string"!=typeof $x&&"number"!=typeof $x||($z=$k._keys[$x])||($z=$k._keys[$x]={k:$x}),this._obj.set($z,$I)}else"string"==typeof $x||"number"==typeof $x?this._obj[$x]=$I:($x.$_GID||($x.$_GID=$g.getGID()),this._obj[$x.$_GID]=$I)},$x.get=function($x){if(null==$x)return null;if($k.supportWeakMap){var $I="string"==typeof $x||"number"==typeof $x?$k._keys[$x]:$x;return $I?this._obj.get($I):null}return"string"==typeof $x||"number"==typeof $x?this._obj[$x]:this._obj[$x.$_GID]},$x.del=function($x){if(null!=$x)if($k.supportWeakMap){var $I="string"==typeof $x||"number"==typeof $x?$k._keys[$x]:$x;if(!$I)return;this._obj.delete($I)}else"string"==typeof $x||"number"==typeof $x?delete this._obj[$x]:delete this._obj[this._obj.$_GID]},$x.has=function($x){if(null==$x)return!1;if($k.supportWeakMap){var $I="string"==typeof $x||"number"==typeof $x?$k._keys[$x]:$x;return this._obj.has($I)}return"string"==typeof $x||"number"==typeof $x?null!=this._obj[$x]:null!=this._obj[this._obj.$_GID]},$k.__init__=function(){($k.supportWeakMap=null!=$W.window.WeakMap)||$v.timer.loop($k.delInterval,null,$k.clearCache)},$k.clearCache=function(){for(var $x=0,$I=$k._maps.length;$x<$I;$x++){$k._maps[$x]._obj={}}},$k.supportWeakMap=!1,$k.delInterval=3e5,$k._keys={},$k._maps=[],$w($k,["I",function(){return this.I=new $k}]),$k}(),$G=function(){function $x(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$N($x,"laya.utils.WordText");var $I=$x.prototype;return $I.setText=function($x){this.changed=!0,this._text=$x},$I.toString=function(){return this._text},$I.charCodeAt=function($x){return this._text?this._text.charCodeAt($x):NaN},$I.charAt=function($x){return this._text?this._text.charAt($x):null},$F(0,$I,"length",function(){return this._text?this._text.length:0}),$x}(),$xx=function($x){function $a(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$a.__super.call(this),this._childs=$a.ARRAY_EMPTY,this._$P=$a.PROP_EMPTY,this.timer=$v.scaleTimer,this.conchModel=$j.isConchNode?this.createConchModel():null}$N($a,"laya.display.Node",$i);var $I=$a.prototype;return $I._setBit=function($x,$I){1==$x&&(this._getBit($x)!=$I&&this._updateDisplayedInstage());$I?this._bits|=$x:this._bits&=~$x},$I._getBit=function($x){return 0!=(this._bits&$x)},$I._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$I._setUpNoticeType=function($x){var $I=this;for($I._setBit($x,!0),$I=$I.parent;$I;){if($I._getBit($x))return;$I._setBit($x,!0),$I=$I.parent}},$I.on=function($x,$I,$z,$k){return"display"!==$x&&"undisplay"!==$x||this._getBit(1)||this._setUpNoticeType(1),this._createListener($x,$I,$z,$k,!1)},$I.once=function($x,$I,$z,$k){return"display"!==$x&&"undisplay"!==$x||this._getBit(1)||this._setUpNoticeType(1),this._createListener($x,$I,$z,$k,!0)},$I.createConchModel=function(){return null},$I.destroy=function($x){void 0===$x&&($x=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($x?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$I.destroyChildren=function(){if(this._childs)for(var $x=this._childs.length-1;-1<$x;$x--)this._childs[$x].destroy(!0)},$I.addChild=function($x){if(!$x||this.destroyed||$x===this)return $x;if($x.zOrder&&this._set$P("hasZorder",!0),$x._parent===this){var $I=this.getChildIndex($x);$I!==this._childs.length-1&&(this._childs.splice($I,1),this._childs.push($x),this.conchModel&&(this.conchModel.removeChild($x.conchModel),this.conchModel.addChildAt($x.conchModel,this._childs.length-1)),this._childChanged())}else $x.parent&&$x.parent.removeChild($x),this._childs===$a.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($x),this.conchModel&&this.conchModel.addChildAt($x.conchModel,this._childs.length-1),($x.parent=this)._childChanged();return $x},$I.addChildren=function($x){for(var $I=arguments,$z=0,$k=$I.length;$z<$k;)this.addChild($I[$z++])},$I.addChildAt=function($x,$I){if(!$x||this.destroyed||$x===this)return $x;if($x.zOrder&&this._set$P("hasZorder",!0),0<=$I&&$I<=this._childs.length){if($x._parent===this){var $z=this.getChildIndex($x);this._childs.splice($z,1),this._childs.splice($I,0,$x),this.conchModel&&(this.conchModel.removeChild($x.conchModel),this.conchModel.addChildAt($x.conchModel,$I)),this._childChanged()}else $x.parent&&$x.parent.removeChild($x),this._childs===$a.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($I,0,$x),this.conchModel&&this.conchModel.addChildAt($x.conchModel,$I),$x.parent=this;return $x}throw new Error("appendChildAt:The index is out of bounds")},$I.getChildIndex=function($x){return this._childs.indexOf($x)},$I.getChildByName=function($x){var $I=this._childs;if($I)for(var $z=0,$k=$I.length;$z<$k;$z++){var $l=$I[$z];if($l.name===$x)return $l}return null},$I._get$P=function($x){return this._$P[$x]},$I._set$P=function($x,$I){return this.destroyed||(this._$P===$a.PROP_EMPTY&&(this._$P={}),this._$P[$x]=$I),$I},$I.getChildAt=function($x){return this._childs[$x]},$I.setChildIndex=function($x,$I){var $z=this._childs;if($I<0||$I>=$z.length)throw new Error("setChildIndex:The index is out of bounds.");var $k=this.getChildIndex($x);if($k<0)throw new Error("setChildIndex:node is must child of this object.");return $z.splice($k,1),$z.splice($I,0,$x),this.conchModel&&(this.conchModel.removeChild($x.conchModel),this.conchModel.addChildAt($x.conchModel,$I)),this._childChanged(),$x},$I._childChanged=function($x){},$I.removeChild=function($x){if(!this._childs)return $x;var $I=this._childs.indexOf($x);return this.removeChildAt($I)},$I.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$I.removeChildByName=function($x){var $I=this.getChildByName($x);return $I&&this.removeChild($I),$I},$I.removeChildAt=function($x){var $I=this.getChildAt($x);if($I){for(var $z=this._childs.length-1,$k=$x;$k<$z;++$k)this._childs[$k]=this._childs[$k+1];this._childs.length=$z,this.conchModel&&this.conchModel.removeChild($I.conchModel),$I.parent=null}return $I},$I.removeChildren=function($x,$I){if(void 0===$x&&($x=0),void 0===$I&&($I=2147483647),this._childs&&0<this._childs.length){var $z=this._childs;if(0===$x&&$n<=$I){var $k=$z;this._childs=$a.ARRAY_EMPTY}else $k=$z.splice($x,$I-$x);for(var $l=0,$n=$k.length;$l<$n;$l++)$k[$l].parent=null,this.conchModel&&this.conchModel.removeChild($k[$l].conchModel)}return this},$I.replaceChild=function($x,$I){var $z=this._childs.indexOf($I);return-1<$z?(this._childs.splice($z,1,$x),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($x.conchModel,$z)),$I.parent=null,$x.parent=this,$x):null},$I._updateDisplayedInstage=function(){var $x;$x=this;var $I=$v.stage;for(this._displayedInStage=!1;$x;){if($x._getBit(1)){this._displayedInStage=$x._displayedInStage;break}if($x==$I||$x._displayedInStage){this._displayedInStage=!0;break}$x=$x.parent}},$I._setDisplay=function($x){this._displayedInStage!==$x&&((this._displayedInStage=$x)?this.event("display"):this.event("undisplay"))},$I._displayChild=function($x,$I){var $z=$x._childs;if($z)for(var $k=0;$k<$z.length;$k++){var $l=$z[$k];$l&&$l._getBit(1)&&(0<$l._childs.length?this._displayChild($l,$I):$l._setDisplay($I))}$x._setDisplay($I)},$I.contains=function($x){if($x===this)return!0;for(;$x;){if($x.parent===this)return!0;$x=$x.parent}return!1},$I.timerLoop=function($x,$I,$z,$k,$l,$n){void 0===$l&&($l=!0),void 0===$n&&($n=!1),this.timer.loop($x,$I,$z,$k,$l,$n)},$I.timerOnce=function($x,$I,$z,$k,$l){void 0===$l&&($l=!0),this.timer._create(!1,!1,$x,$I,$z,$k,$l)},$I.frameLoop=function($x,$I,$z,$k,$l){void 0===$l&&($l=!0),this.timer._create(!0,!0,$x,$I,$z,$k,$l)},$I.frameOnce=function($x,$I,$z,$k,$l){void 0===$l&&($l=!0),this.timer._create(!0,!1,$x,$I,$z,$k,$l)},$I.clearTimer=function($x,$I){this.timer.clear($x,$I)},$F(0,$I,"numChildren",function(){return this._childs.length}),$F(0,$I,"destroyed",function(){return this._destroyed}),$F(0,$I,"parent",function(){return this._parent},function($x){this._parent!==$x&&($x?(this._parent=$x,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$x.displayedInStage&&this._displayChild(this,!0)),$x._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$x))}),$F(0,$I,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$a.ARRAY_EMPTY=[],$a.PROP_EMPTY={},$a.NOTICE_DISPLAY=1,$a.MOUSEENABLE=2,$a}(),$Ix=function($x){function $T($x){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$T.__super.call(this),this._padding=$T._PADDING,this._spacing=$T._SPACING,this._aligns=$T._ALIGNS,this._font=$R.EMPTY,this._ower=$x}$N($T,"laya.display.css.CSSStyle",$x);var $I=$T.prototype;return $I.destroy=function(){this._ower=null,this._font=null,this._rect=null},$I.inherit=function($x){this._font=$x._font,this._spacing=$x._spacing===$T._SPACING?$T._SPACING:$x._spacing.slice(),this.lineHeight=$x.lineHeight},$I._widthAuto=function(){return 0!=(262144&this._type)},$I.widthed=function($x){return 0!=(8&this._type)},$I._calculation=function($x,$I){if($I.indexOf("%")<0)return!1;var $k=this._ower,$l=$k.parent,$n=this._rect;function $a($x,$I,$z){return $x*$z[0]+$I*$z[1]+$z[2]}function $z($x){var $I=$l.width,$z=$k.width;$n.width&&($k.width=$a($I,$z,$n.width)),$n.height&&($k.height=$a($I,$z,$n.height)),$n.left&&($k.x=$a($I,$z,$n.left)),$n.top&&($k.y=$a($I,$z,$n.top))}null===$n&&($l._getCSSStyle()._type|=524288,$l.on("resize",this,$z),this._rect=$n={input:{}});var $$=$I.split(" ");return $$[0]=parseFloat($$[0])/100,1==$$.length?$$[1]=$$[2]=0:($$[1]=parseFloat($$[1])/100,$$[2]=parseFloat($$[2])),$n[$x]=$$,$n.input[$x]=$I,$z(),!0},$I.heighted=function($x){return 0!=(8192&this._type)},$I.size=function($x,$I){var $z=this._ower,$k=!1;-1!==$x&&$x!=this._ower.width&&(this._type|=8,this._ower.width=$x,$k=!0),-1!==$I&&$I!=this._ower.height&&(this._type|=8192,this._ower.height=$I,$k=!0),$k&&($z._layoutLater(),524288&this._type&&$z.event("resize",this))},$I._getAlign=function(){return this._aligns[0]},$I._getValign=function(){return this._aligns[1]},$I._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$I._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $R(this._font))},$I.render=function($x,$I,$z,$k){var $l=$x.width,$n=$x.height;$z-=$x.pivotX,$k-=$x.pivotY,this._bgground&&null!=this._bgground.color&&$I.ctx.fillRect($z,$k,$l,$n,this._bgground.color),this._border&&this._border.color&&$I.drawRect($z,$k,$l,$n,this._border.color.strColor,this._border.size)},$I.getCSSStyle=function(){return this},$I.cssText=function($x){this.attrs($T.parseOneCSS($x,";"))},$I.attrs=function($x){if($x)for(var $I=0,$z=$x.length;$I<$z;$I++){var $k=$x[$I];this[$k[0]]=$k[1]}},$I.setTransform=function($x){"none"===$x?this._tf=$$._TF_EMPTY:this.attrs($T.parseOneCSS($x,","))},$I.translate=function($x,$I){this._tf===$$._TF_EMPTY&&(this._tf=new $l),this._tf.translateX=$x,this._tf.translateY=$I},$I.scale=function($x,$I){this._tf===$$._TF_EMPTY&&(this._tf=new $l),this._tf.scaleX=$x,this._tf.scaleY=$I},$I._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$F(0,$I,"block",$x.prototype._$get_block,function($x){$x?this._type|=1:this._type&=-2}),$F(0,$I,"valign",function(){return $T._valigndef[this._aligns[1]]},function($x){this._aligns===$T._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$T._valigndef[$x]}),$F(0,$I,"height",null,function($x){if(this._type|=8192,"string"==typeof $x){if(this._calculation("height",$x))return;$x=parseInt($x)}this.size(-1,$x)}),$F(0,$I,"width",null,function($x){if(this._type|=8,"string"==typeof $x){var $I=$x.indexOf("auto");if(0<=$I&&(this._type|=262144,$x=$x.substr(0,$I)),this._calculation("width",$x))return;$x=parseInt($x)}this.size($x,-1)}),$F(0,$I,"fontWeight",function(){return this._font.weight},function($x){this._createFont().weight=$x}),$F(0,$I,"left",null,function($x){var $I=this._ower;if("string"==typeof $x){if("center"===$x?$x="50% -50% 0":"right"===$x&&($x="100% -100% 0"),this._calculation("left",$x))return;$x=parseInt($x)}$I.x=$x}),$F(0,$I,"_translate",null,function($x){this.translate($x[0],$x[1])}),$F(0,$I,"absolute",function(){return 0!=(4&this._type)}),$F(0,$I,"top",null,function($x){var $I=this._ower;if("string"==typeof $x){if("middle"===$x?$x="50% -50% 0":"bottom"===$x&&($x="100% -100% 0"),this._calculation("top",$x))return;$x=parseInt($x)}$I.y=$x}),$F(0,$I,"align",function(){return $T._aligndef[this._aligns[0]]},function($x){this._aligns===$T._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$T._aligndef[$x]}),$F(0,$I,"bold",function(){return this._font.bold},function($x){this._createFont().bold=$x}),$F(0,$I,"padding",function(){return this._padding},function($x){this._padding=$x}),$F(0,$I,"leading",function(){return this._spacing[1]},function($x){"string"==typeof $x&&($x=parseInt($x+"")),this._spacing===$T._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$x}),$F(0,$I,"lineElement",function(){return 0!=(65536&this._type)},function($x){$x?this._type|=65536:this._type&=-65537}),$F(0,$I,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($x){this.lineElement=!1,"right"===$x?this._type|=32768:this._type&=-32769}),$F(0,$I,"textDecoration",function(){return this._font.decoration},function($x){this._createFont().decoration=$x}),$F(0,$I,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($x){"nowrap"===$x&&(this._type|=131072),"none"===$x&&(this._type&=-131073)}),$F(0,$I,"background",null,function($x){$x?(this._bgground||(this._bgground={}),this._bgground.color=$x,this._ower.conchModel&&this._ower.conchModel.bgColor($x),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$F(0,$I,"wordWrap",function(){return 0==(131072&this._type)},function($x){$x?this._type&=-131073:this._type|=131072}),$F(0,$I,"color",function(){return this._font.color},function($x){this._createFont().color=$x}),$F(0,$I,"password",function(){return this._font.password},function($x){this._createFont().password=$x}),$F(0,$I,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($x){"none"===$x?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$x),this._ower.conchModel&&this._ower.conchModel.bgColor($x),this._ower._renderType|=256}),$F(0,$I,"font",function(){return this._font.toString()},function($x){this._createFont().set($x)}),$F(0,$I,"weight",null,function($x){this._createFont().weight=$x}),$F(0,$I,"letterSpacing",function(){return this._spacing[0]},function($x){"string"==typeof $x&&($x=parseInt($x+"")),this._spacing===$T._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$x}),$F(0,$I,"fontSize",function(){return this._font.size},function($x){this._createFont().size=$x}),$F(0,$I,"italic",function(){return this._font.italic},function($x){this._createFont().italic=$x}),$F(0,$I,"fontFamily",function(){return this._font.family},function($x){this._createFont().family=$x}),$F(0,$I,"stroke",function(){return this._font.stroke[0]},function($x){this._createFont().stroke===$R._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$x}),$F(0,$I,"strokeColor",function(){return this._font.stroke[1]},function($x){this._createFont().stroke===$R._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$x}),$F(0,$I,"border",function(){return this._border?this._border.value:""},function($x){if("none"!=$x){this._border||(this._border={});var $I=(this._border.value=$x).split(" ");if(this._border.color=$h.create($I[$I.length-1]),1==$I.length)return this._border.size=1,void(this._border.type="solid");var $z=0;0<$I[0].indexOf("px")?(this._border.size=parseInt($I[0]),$z++):this._border.size=1,this._border.type=$I[$z],this._ower._renderType|=256}else this._border=null}),$F(0,$I,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($x){$x?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$x?null:$h.create($x),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$F(0,$I,"position",function(){return 4&this._type?"absolute":""},function($x){"absolute"==$x?this._type|=4:this._type&=-5}),$F(0,$I,"display",null,function($x){switch($x){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$F(0,$I,"paddingLeft",function(){return this.padding[3]}),$F(0,$I,"paddingTop",function(){return this.padding[0]}),$F(0,$I,"_scale",null,function($x){this._ower.scale($x[0],$x[1])}),$F(0,$I,"_rotate",null,function($x){this._ower.rotation=$x}),$T.parseOneCSS=function($x,$I){for(var $z,$k=[],$l=$x.split($I),$n=0,$a=$l.length;$n<$a;$n++){var $$=$l[$n],$w=$$.indexOf(":"),$i=$$.substr(0,$w).replace(/^\s+|\s+$/g,"");if(0!=$i.length){var $F=$$.substr($w+1).replace(/^\s+|\s+$/g,""),$b=[$i,$F];switch($i){case"italic":case"bold":$b[1]="true"==$F;break;case"line-height":$b[0]="lineHeight",$b[1]=parseInt($F);break;case"font-size":$b[0]="fontSize",$b[1]=parseInt($F);break;case"padding":1<($z=$F.split(" ")).length||($z[1]=$z[2]=$z[3]=$z[0]),$b[1]=[parseInt($z[0]),parseInt($z[1]),parseInt($z[2]),parseInt($z[3])];break;case"rotate":$b[0]="_rotate",$b[1]=parseFloat($F);break;case"scale":$z=$F.split(" "),$b[0]="_scale",$b[1]=[parseFloat($z[0]),parseFloat($z[1])];break;case"translate":$z=$F.split(" "),$b[0]="_translate",$b[1]=[parseInt($z[0]),parseInt($z[1])];break;default:($b[0]=$T._CSSTOVALUE[$i])||($b[0]=$i)}$k.push($b)}}return $k},$T.parseCSS=function($x,$I){for(var $z;null!=($z=$T._parseCSSRegExp.exec($x));)$T.styleSheets[$z[1]]=$T.parseOneCSS($z[2],";")},$T.EMPTY=new $T(null),$T._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$T._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$T._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$T._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$T.styleSheets={},$T.ALIGN_CENTER=1,$T.ALIGN_RIGHT=2,$T.VALIGN_MIDDLE=1,$T.VALIGN_BOTTOM=2,$T._CSS_BLOCK=1,$T._DISPLAY_NONE=2,$T._ABSOLUTE=4,$T._WIDTH_SET=8,$T._PADDING=[0,0,0,0],$T._RECT=[-1,-1,-1,-1],$T._SPACING=[0,0],$T._ALIGNS=[0,0,0],$T.ADDLAYOUTED=512,$T._NEWFONT=4096,$T._HEIGHT_SET=8192,$T._BACKGROUND_SET=16384,$T._FLOAT_RIGHT=32768,$T._LINE_ELEMENT=65536,$T._NOWARP=131072,$T._WIDTHAUTO=262144,$T._LISTERRESZIE=524288,$T}($$),$zx=function($x){function $a(){this.url=null,this.audio=null,this.loaded=!1,$a.__super.call(this)}$N($a,"laya.media.h5audio.AudioSound",$i);var $I=$a.prototype;return $I.dispose=function(){var $x=$a._audioCache[this.url];$x&&($x.src="",delete $a._audioCache[this.url])},$I.load=function($x){var $I;if($x=$d.formatURL($x),(this.url=$x)==$S._tMusic?($a._initMusicAudio(),($I=$a._musicAudio).src!=$x&&($a._audioCache[$I.src]=null,$I=null)):$I=$a._audioCache[$x],$I&&2<=$I.readyState)this.event("complete");else{$I||($I=$x==$S._tMusic?($a._initMusicAudio(),$a._musicAudio):$W.createElement("audio"),($a._audioCache[$x]=$I).src=$x),$I.addEventListener("canplaythrough",$k),$I.addEventListener("error",$l);var $z=this;(this.audio=$I).load?$I.load():$l()}function $k(){$n(),$z.loaded=!0,$z.event("complete")}function $l(){$I.load=null,$n(),$z.event("error")}function $n(){$I.removeEventListener("canplaythrough",$k),$I.removeEventListener("error",$l)}},$I.play=function($x,$I,$z){if(void 0===$x&&($x=0),void 0===$I&&($I=0),!this.url)return null;var $k,$l;if(!($k=this.url==$S._tMusic?$a._musicAudio:$a._audioCache[this.url]))return null;$l=$H.getItem("audio:"+this.url),$j.isConchApp?$l||(($l=$W.createElement("audio")).src=this.url):this.url==$S._tMusic?($a._initMusicAudio(),($l=$a._musicAudio).src=this.url):$l=$l||$k.cloneNode(!0);var $n=new $Tx($l);return $n.url=this.url,$n.loops=$I,$n.startTime=$x,$n.startHandler=$z,$n.play(!1),$S.addChannel($n),$n},$F(0,$I,"duration",function(){var $x;return($x=$a._audioCache[this.url])?$x.duration:0}),$a._initMusicAudio=function(){$a._musicAudio||($a._musicAudio||($a._musicAudio=$W.createElement("audio")),$j.isConchApp||$W.document.addEventListener("mousedown",$a._makeMusicOK))},$a._makeMusicOK=function(){$W.document.removeEventListener("mousedown",$a._makeMusicOK),$a._musicAudio.src?$a._musicAudio.play():($a._musicAudio.src="",$a._musicAudio.load())},$a._audioCache={},$a._musicAudio=null,$a}(),$kx=function($x){function $I(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$I.__super.call(this)}$N($I,"laya.media.SoundChannel",$i);var $z=$I.prototype;return $z.play=function(){},$z.stop=function(){},$z.pause=function(){},$z.resume=function(){},$z.__runComplete=function($x){$x&&$x.run()},$F(0,$z,"volume",function(){return 1},function($x){}),$F(0,$z,"position",function(){return 0}),$F(0,$z,"duration",function(){return 0}),$I}(),$lx=function($x){function $I(){$I.__super.call(this)}$N($I,"laya.media.Sound",$i);var $z=$I.prototype;return $z.load=function($x){},$z.play=function($x,$I,$z){return void 0===$x&&($x=0),void 0===$I&&($I=0),null},$z.dispose=function(){},$F(0,$z,"duration",function(){return 0}),$I}(),$nx=function($x){function $l(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$l.__super.call(this)}$N($l,"laya.media.webaudio.WebAudioSound",$i);var $I=$l.prototype;return $I.load=function($x){this.url=$x,this.audioBuffer=$l._dataCache[$x],this.audioBuffer?this._loaded(this.audioBuffer):($l.e.on("loaded:"+$x,this,this._loaded),$l.e.on("err:"+$x,this,this._err),$l.__loadingSound[$x]||($l.__loadingSound[$x]=!0,$v.loader.load($x,$f.create(this,this.onloaded),null,$$x.BUFFER,4,!1,null,!0)))},$I.onloaded=function($x){$x||this._err(),this._disposed?this._removeLoadEvents():(this.data=$x,$l.buffs.push({buffer:this.data,url:this.url}),$l.decode())},$I._err=function(){if(this._removeLoadEvents(),$l.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $x,$I,$z,$k=0;for($x=($I=this.__toPlays).length,$k=0;$k<$x;$k++)($z=$I[$k])[3]&&!$z[3].isStopped&&$z[3].event("error");this.__toPlays.length=0}},$I._loaded=function($x){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$x,this.loaded=!0,this.event("complete"))},$I._removeLoadEvents=function(){$l.e.off("loaded:"+this.url,this,this._loaded),$l.e.off("err:"+this.url,this,this._err)},$I.__playAfterLoaded=function(){if(this.__toPlays){var $x,$I,$z,$k=0;for($x=($I=this.__toPlays).length,$k=0;$k<$x;$k++)($z=$I[$k])[3]&&!$z[3].isStopped&&this.play($z[0],$z[1],$z[2],$z[3]);this.__toPlays.length=0}},$I.play=function($x,$I,$z,$k){return void 0===$x&&($x=0),void 0===$I&&($I=0),$k=$k||new $_x,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$x,$I,$z,$k]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$k.url=this.url,$k.loops=$I,$k.audioBuffer=this.audioBuffer,$k.startTime=$x,$k.startHandler=$z,$k.play(!1),$S.addChannel($k),$k},$I.dispose=function(){this._disposed=!0,delete $l._dataCache[this.url],delete $l.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$F(0,$I,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$l.decode=function(){if(!($l.buffs.length<=0||$l.isDecoding))if($l.isDecoding=!0,($l.tInfo=$l.buffs.shift())&&$l.tInfo.buffer&&$l.tInfo.buffer.byteLength)try{$l.ctx.decodeAudioData($l.tInfo.buffer,$l._done,$l._fail)}catch($x){console.error("decodeAudioData error  byteLength:"+$l.tInfo.buffer.byteLength+"  url:"+$l.tInfo.url)}else $l._fail()},$l._done=function($x){$l.e.event("loaded:"+$l.tInfo.url,$x),$l._dataCache[$l.tInfo.url]=$x,$l.isDecoding=!1,$l.decode()},$l._fail=function(){$l.e.event("err:"+$l.tInfo.url,null),$l.isDecoding=!1,$l.decode()},$l._playEmptySound=function(){if(null!=$l.ctx){if($l._emptySource&&($l._emptySource.stop(),$l._emptySource.disconnect(0),!$_x._tryCleanFailed))try{$l._emptySource.buffer=null}catch($x){$_x._tryCleanFailed=!0}var $x=$l.ctx.createBufferSource();$x.buffer=$l._miniBuffer,$x.connect($l.ctx.destination),$x.start(0,0,0),$l._emptySource=$x}},$l._unlock=function(){$l._unlocked||($l._playEmptySound(),"running"==$l.ctx.state?($W.document.removeEventListener("mousedown",$l._unlock,!0),$W.document.removeEventListener("touchend",$l._unlock,!0),$W.document.removeEventListener("touchstart",$l._unlock,!0),$l._unlocked=!0):"suspended"==$l.ctx.state&&$S._recoverWebAudio())},$l.initWebAudio=function(){"running"!=$l.ctx.state&&($l._unlock(),$W.document.addEventListener("mousedown",$l._unlock,!0),$W.document.addEventListener("touchend",$l._unlock,!0),$W.document.addEventListener("touchstart",$l._unlock,!0))},$l._emptySource=null,$l._dataCache={},$l.buffs=[],$l.isDecoding=!1,$l._unlocked=!1,$l.tInfo=null,$l.__loadingSound={},$w($l,["window",function(){return this.window=$W.window},"webAudioEnabled",function(){return this.webAudioEnabled=$l.window.AudioContext||$l.window.webkitAudioContext||$l.window.mozAudioContext},"ctx",function(){return this.ctx=$l.webAudioEnabled?new($l.window.AudioContext||$l.window.webkitAudioContext||$l.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$l.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $i}]),$l}(),$ax=function($x){function $I(){this._responseType=null,this._data=null,$I.__super.call(this),this._http=new $W.window.XMLHttpRequest}$N($I,"laya.net.HttpRequest",$i);var $z=$I.prototype;return $z.send=function($x,$I,$z,$k,$l){void 0===$z&&($z="get"),void 0===$k&&($k="text"),this._responseType=$k,this._data=null;var $n=this,$a=this._http;if($a.open($z,$x,!0),$l)for(var $$=0;$$<$l.length;$$++)$a.setRequestHeader($l[$$++],$l[$$]);else $j.isConchApp||($I&&"string"!=typeof $I?$a.setRequestHeader("Content-Type","application/json"):$a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$a.responseType="arraybuffer"!==$k?"text":"arraybuffer",$a.onerror=function($x){$n._onError($x)},$a.onabort=function($x){$n._onAbort($x)},$a.onprogress=function($x){$n._onProgress($x)},$a.onload=function($x){$n._onLoad($x)},$a.send($I)},$z._onProgress=function($x){$x&&$x.lengthComputable&&this.event("progress",$x.loaded/$x.total)},$z._onAbort=function($x){this.error("Request was aborted by user")},$z._onError=function($x){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$z._onLoad=function($x){var $I=this._http,$z=void 0!==$I.status?$I.status:200;200===$z||204===$z||0===$z?this.complete():this.error("["+$I.status+"]"+$I.statusText+":"+$I.responseURL)},$z.error=function($x){this.clear(),this.event("error",$x)},$z.complete=function(){this.clear();var $I=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$g.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($x){$I=!1,this.error($x.message)}$I&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$z.clear=function(){var $x=this._http;$x.onerror=$x.onabort=$x.onprogress=$x.onload=null},$F(0,$z,"url",function(){return this._http.responseURL}),$F(0,$z,"http",function(){return this._http}),$F(0,$z,"data",function(){return this._data}),$I}(),$$x=function($x){function $E(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$E.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1,this._base64=!1}$N($E,"laya.net.Loader",$i);var $I=$E.prototype;return $I.load=function($x,$I,$z,$k,$l){if($x&&""!=$x||console.error("Loader 加载的url不合法 "+$x),void 0===$z&&($z=!0),void 0===$l&&($l=!1),this._url=$x,this._base64=!1,0===$x.indexOf("data:image")?(this._base64=!0,this._type=$I="image"):this._type=$I||($I=this.getTypeFromUrl($x)),this._cache=$z,this._data=null,!$l&&$E.loadedMap[$x])return this._data=$E.loadedMap[$x],this.event("progress",1),void this.event("complete",this._data);if($k&&$E.setGroup($x,$k),null!=$E.parserMap[$I])return this._customParse=!0,void($E.parserMap[$I]instanceof laya.utils.Handler?$E.parserMap[$I].runWith(this):$E.parserMap[$I].call(null,this));if("image"===$I||"htmlimage"===$I||"nativeimage"===$I)return this._loadImage($x);if("ttf"===$I)return this._loadTTF($x);switch($I){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$I}$E.preLoadedMap[$x]?this.onLoaded($E.preLoadedMap[$x]):$_.resMgrLoad($x,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$I.getTypeFromUrl=function($x){var $I=$g.getFileExtension($x);return $I?$E.typeMap[$I]:(console.warn("Not recognize the resources suffix",$x),"text")},$I._loadTTF=function($x){$x=$d.formatURL($x);var $I=new $X;$I.complete=$f.create(this,this.onLoaded),$I.load($x)},$I._loadBase64Image=function($I){$I=$d.formatURL($I);var $z,$x=this;function $k(){$z.onload=null,$z.onerror=null,delete $E.imgCache[$I]}function $l(){$k(),$x.onLoaded($z)}function $n(){$k(),$x.event("error","Load image failed")}"nativeimage"===this._type?(($z=new $W.window.Image).crossOrigin="",$z.onload=$l,$z.onerror=$n,$z.src=$I,$E.imgCache[$I]=$z):new $Px.create($I,{onload:$l,onerror:$n,onCreate:function($x){$z=$x,$E.imgCache[$I]=$x}})},$I._loadImage=function($x){this._base64?this._loadBase64Image($x):$_.imgMgrLoad($x,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$I._loadImageComplete=function($x,$I,$z){if(null!=$z)if($z instanceof ArrayBuffer){var $k=new DataView($z),$l=new laya.webgl.resource.WebGLImage(new Uint8Array($z,8),$x,0,!1,$k.getUint32(0),$k.getUint32(4));this.onLoaded($l)}else if($z instanceof $Fx)$E.imgMgrSet[$x]=$I,$_.imgMgrLock($x,$E.imgMgrSet[$x]),this._url=$x,this.complete($z);else{var $n=-1!=$x.indexOf(".png",$x.length-4)?6408:6407;$l=new laya.webgl.resource.WebGLImage($z,$x,$n,!1,$z.width,$z.height);this.onLoaded($l)}else this.event("error","Load image failed")},$I.imageCancel=function($x,$I,$z){$_.imgMgrCancel&&$_.imgMgrCancel($x,this._onImageCallback)},$I._loadSound=function($x){var $I=new $S._soundClass,$z=this;function $k(){$I.offAll()}$I.on("complete",this,function(){$k(),$z.onLoaded($I)}),$I.on("error",this,function(){$k(),$I.dispose(),$z.event("error","Load sound failed")}),$I.load($x)},$I.onProgress=function($x){"atlas"===this._type?this.event("progress",.3*$x):this.event("progress",$x)},$I.onError=function($x){this.event("error",$x)},$I._loadedComplete=function($x,$I,$z){if(null!=$z)switch(this._type){case"atlas":case"plf":case"json":var $k=new $q($z);this.onLoaded(JSON.parse($k.readUTFBytes()));break;case"font":$k=new $q($z);this.onLoaded($g.parseXMLFromString($k.readUTFBytes()));break;default:this.onLoaded($z)}else this.event("error",$x)},$I.onLoaded=function($x){var $I=this._type;if("plf"==$I)this.parsePLFData($x),this.complete($x);else if("image"===$I){var $z=new $Fx($x);$z.url=this._url,this.complete($z)}else if("sound"===$I||"htmlimage"===$I||"nativeimage"===$I)this.complete($x);else if("atlas"===$I){if(!$x.src&&!$x._setContext){if(!this._data){if((this._data=$x).meta&&$x.meta.image)for(var $k=$x.meta.image.split(","),$l=0<=this._url.indexOf("/")?"/":"\\",$n=this._url.lastIndexOf($l),$a=0<=$n?this._url.substr(0,$n+1):"",$$=0,$w=$k.length;$$<$w;$$++)$k[$$]=$a+$k[$$];else $k=[this._url.replace(".json",".png")];$k.reverse(),$x.toLoads=$k,$x.pics=[]}return this.event("progress",.3+1/$k.length*.6),this._loadImage($k.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($x),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $i=this._data.frames,$F=this._url.split("?")[0],$b=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$F.substring(0,$F.lastIndexOf("."))+"/",$T=this._data.pics,$_=$d.formatURL(this._url),$R=$E.atlasMap[$_]||($E.atlasMap[$_]=[]);$R.dir=$b;var $s=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $N in $s=parseFloat(this._data.meta.scale),$i){var $D,$f=$i[$N],$m=$T[$f.frame.idx?$f.frame.idx:0],$y=$d.formatURL($b+$N);$m.scaleRate=$s,$D=$Fx.create($m,$f.frame.x,$f.frame.y,$f.frame.w,$f.frame.h,$f.spriteSourceSize.x,$f.spriteSourceSize.y,$f.sourceSize.w,$f.sourceSize.h),$E.cacheRes($y,$D),$E.keepCache(this._url,$b+$N),$D.url=$y,$R.push($y)}else for($N in $i)$m=$T[($f=$i[$N]).frame.idx?$f.frame.idx:0],$y=$d.formatURL($b+$N),$E.cacheRes($y,$Fx.create($m,$f.frame.x,$f.frame.y,$f.frame.w,$f.frame.h,$f.spriteSourceSize.x,$f.spriteSourceSize.y,$f.sourceSize.w,$f.sourceSize.h)),$E.loadedMap[$y].url=$y,$E.keepCache(this._url,$b+$N),$R.push($y);delete this._data.pics,this.complete(this._data)}else if("font"==$I){if(!$x.src)return this._data=$x,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $C=new $O;$C.parseFont(this._data,$x);var $P=this._url.split(".fnt")[0].split("/"),$v=$P[$P.length-1];$Nx.registerBitmapFont($v,$C),this._data=$C,this.complete(this._data)}else if("pkm"==$I){var $L=$Px.create($x,this._url),$K=new $Fx($L);$K.url=this._url,this.complete($K)}else this.complete($x)},$I.parsePLFData=function($x){var $I,$z,$k;for($I in $x)switch($k=$x[$I],$I){case"json":case"text":for($z in $k)$E.preLoadedMap[$d.formatURL($z)]=$k[$z];break;default:for($z in $k)$E.preLoadedMap[$d.formatURL($z)]=$k[$z]}},$I.complete=function($x){this._data=$x,this._customParse?this.event("loaded",$x instanceof Array?[$x]:$x):($E._loaders.push(this),$E._isWorking||$E.checkNext())},$I.endLoad=function($x){$x&&(this._data=$x),this._cache&&$E.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$F(0,$I,"url",function(){return this._url}),$F(0,$I,"data",function(){return this._data}),$F(0,$I,"cache",function(){return this._cache}),$F(0,$I,"type",function(){return this._type}),$E.checkNext=function(){$E._isWorking=!0;for(var $x=$W.now();$E._startIndex<$E._loaders.length;)if($W.now(),$E._loaders[$E._startIndex].endLoad(),$E._startIndex++,$W.now()-$x>$E.maxTimeOut)return console.warn("loader callback cost a long time:"+($W.now()-$x)+" url="+$E._loaders[$E._startIndex-1].url),void $v.timer.frameOnce(1,null,$E.checkNext);$E._loaders.length=0,$E._startIndex=0,$E._isWorking=!1},$E.clearRes=function($x,$I){if(null!=$x){void 0===$I&&($I=!1),$x=$d.formatURL($x);var $z=$E.getAtlas($x);if($z){for(var $k=0,$l=$z.length;$k<$l;$k++){var $n=$z[$k],$a=$E.getRes($n);delete $E.loadedMap[$n],$E.clearCache($x.substring($d.basePath.length),$n.substring($d.basePath.length)),$a&&$a.destroy($I)}$z.length=0,delete $E.atlasMap[$x],delete $E.loadedMap[$x]}else{var $$=$E.loadedMap[$x];$$&&(delete $E.loadedMap[$x],$$ instanceof laya.resource.Texture&&$$.bitmap&&$$.destroy($I))}}},$E.clearTextureRes=function($x){$x=$d.formatURL($x);var $I=laya.net.Loader.getAtlas($x),$z=$I&&0<$I.length?laya.net.Loader.getRes($I[0]):laya.net.Loader.getRes($x);$z&&$z.bitmap&&($j.isConchApp&&!$j.isConchWebGL?$z.bitmap.source.releaseTexture&&$z.bitmap.source.releaseTexture():null==$z.bitmap._atlaser&&$z.bitmap.releaseResource(!0))},$E.getRes=function($x){return $E.loadedMap[$d.formatURL($x)]},$E.getAtlas=function($x){return $E.atlasMap[$d.formatURL($x)]},$E.cacheRes=function($x,$I){$x=$d.formatURL($x),null!=$E.loadedMap[$x]?console.warn("Resources already exist,is repeated loading:",$x):$E.loadedMap[$x]=$I},$E.setGroup=function($x,$I){$E.groupMap[$I]||($E.groupMap[$I]=[]),$E.groupMap[$I].push($x)},$E.clearResByGroup=function($x){if($E.groupMap[$x]){var $I=$E.groupMap[$x],$z=0,$k=$I.length;for($z=0;$z<$k;$z++)$E.clearRes($I[$z]);$I.length=0}},$E.keepCache=function($x,$I){if($x&&$I){var $z=$E.cacheSet[$I];$z?-1==$z.indexOf($x)&&$z.push($x):$E.cacheSet[$I]=[$x]}},$E.clearCache=function($x,$I){if($x&&$I){var $z=$E.cacheSet[$I];if($z){var $k=$z.indexOf($x);if(-1!==$k){var $l=$z.length-1;0==$l?(delete $E.cacheSet[$I],0<$E.imgMgrSet[$I]?$_.imgMgrFree($I,$E.imgMgrSet[$I]):$E.clearRes($I,!0)):($z[$k]=$z[$l],$z.length=$l)}}}},$E.saveObject=function($x,$I,$z){if($I&&$x){var $k=$E.objectSet[$x];$k?(console.warn("Loader.saveObject: "+$x),$k[0]=$I,$k[1]=$z):$E.objectSet[$x]=[$I,$z,[]]}},$E.findObject=function($x){if($x){var $I=$E.objectSet[$x];if($I)return $I[0]}return null},$E.keepObject=function($x,$I){if($x&&$I){var $z=$E.objectSet[$I];$z&&-1===$z[2].indexOf($x)&&$z[2].push($x)}},$E.clearObject=function($x,$I){if($x&&$I){var $z=$E.objectSet[$I];if($z){var $k=$z[2],$l=$k.indexOf($x);if(-1!==$l){var $n=$k.length-1;0==$n?(delete $E.objectSet[$I],$z[1]&&$z[1].call(null,$z[0])):($k[$l]=$k[$n],$k.length=$n)}}}},$E.TEXT="text",$E.JSON="json",$E.XML="xml",$E.BUFFER="arraybuffer",$E.IMAGE="image",$E.SOUND="sound",$E.ATLAS="atlas",$E.FONT="font",$E.TTF="ttf",$E.PLF="plf",$E.PKM="pkm",$E.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$E.parserMap={},$E.groupMap={},$E.maxTimeOut=100,$E.loadedMap={},$E.preLoadedMap={},$E.atlasMap={},$E._loaders=[],$E._isWorking=!1,$E._startIndex=0,$E.imgCache={},$E.cacheSet={},$E.objectSet={},$E.imgMgrSet={},$E}(),$wx=function($x){var $T;function $_(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$_.__super.call(this);for(var $x=0;$x<this._maxPriority;$x++)this._resInfos[$x]=[]}$N($_,"laya.net.LoaderManager",$i);var $I=$_.prototype;return $I.create=function($x,$z,$I,$k,$l,$n,$a,$$){if(null==$n&&($n=2),null==$a&&($a=!0),$x instanceof Array){var $w=$x,$i=$w.length,$F=0;if($I)var $b=$f.create($I.caller,$I.method,$I.args,!1);for(var $T=0;$T<$i;$T++){var $_=$w[$T];"string"==typeof $_&&($_=$w[$T]={url:$_}),$_.progress=0}for($T=0;$T<$i;$T++){$_=$w[$T];var $R=$I?$f.create(null,$D,[$_],!1):null,$s=$I||$z?$f.create(null,$N,[$_]):null;this._create($_.url,$s,$R,$_.clas||$k,$_.params||$l,null!=$_.priority&&0<=$_.priority?$_.priority:$n,$a,$_.group||$$)}function $N($x,$I){$F++,$x.progress=1,$F===$i&&$z&&$z.run()}function $D($x,$I){$x.progress=$I;for(var $z=0,$k=0;$k<$i;$k++){$z+=$w[$k].progress}var $l=$z/$i;$b.runWith($l)}return!0}return this._create($x,$z,$I,$k,$l,$n,$a,$$)},$I._create=function($I,$z,$x,$k,$l,$n,$a,$$){$I&&""!=$I||console.error("加载的url不合法 "+$I),null==$n&&($n=2),null==$a&&($a=!0);var $w=$d.formatURL($I),$i=this.getRes($w);if($i)!$i.hasOwnProperty("loaded")||$i.loaded?($x&&$x.runWith(1),$z&&$z.run()):$z&&$v.loader._createListener($I,$z.caller,$z.method,$z.args,!0,!1);else{var $F=$g.getFileExtension($I),$b=$_.createMap[$F];if(!$b)throw new Error("LoaderManager:unknown file("+$I+") extension with: "+$F+".");$k||($k=$b[0]);var $T=$b[1];if("atlas"==$F)this.load($I,$z,$x,$T,$n,$a);else{$k===$Fx&&($T="htmlimage"),($i=$k?new $k:null).hasOwnProperty("_loaded")&&($i._loaded=!1),$i._setUrl($I),$$&&$i._setGroup($$),this._createLoad($i,$I,$f.create(null,function($x){$i&&!$i.destroyed&&$x&&$i.onAsynLoaded.call($i,$I,$x,$l),$z&&$z.run();$v.loader.event($I)}),$x,$T,$n,!1,$$,!0),$a&&this.cacheRes($w,$i)}}return $i},$I.load=function($x,$I,$z,$k,$l,$n,$a,$$){$x&&""!=$x||console.error("加载的url不合法 "+$x);var $w=this;if(null==$l&&($l=2),null==$n&&($n=!0),void 0===$$&&($$=!1),$x instanceof Array)return this._loadAssets($x,$I,$z,$k,$l,$n,$a);var $i=$$x.getRes($x);if(null!=$i)$v.timer.frameOnce(1,null,function(){$z&&$z.runWith(1),$I&&$I.runWith($i),$w._loaderCount||$w.event("complete")});else{var $F=$_._resMap[$x];$F?($I&&$F._createListener("complete",$I.caller,$I.method,$I.args,!1,!1),$z&&$F._createListener("progress",$z.caller,$z.method,$z.args,!1,!1)):(($F=this._infoPool.length?this._infoPool.pop():new $T).url=$x,$F.clas=null,$F.type=$k,$F.cache=$n,$F.group=$a,$F.ignoreCache=$$,$F.priority=$l,$I&&$F.on("complete",$I.caller,$I.method,$I.args),$z&&$F.on("progress",$z.caller,$z.method,$z.args),$_._resMap[$x]=$F,$l=$l<this._maxPriority?0<=$l?$l:0:this._maxPriority-1,this._resInfos[$l].push($F),this._next())}return this},$I.cancel=function($x,$I,$z){if($i=$_._resMap[$x]){$I&&$i.off("complete",$I.caller,$I.method,!1),$z&&$i.off("progress",$z.caller,$z.method,!1);var $k=$i.getListener("complete"),$l=$i.getListener("progress");if(!($k&&$k.head||$l&&$l.head)){if($i.loader){var $n=$i.loader;$n.imageCancel($x),$n.offAll(),$n._data=null,$n._customParse=!1,$n._url=null,$n._class=null,$n._type=null,this._loaders.push($n),this._loaderCount--,delete this._loaderMap[$i.url]}for(var $a=0;$a<this._maxPriority;$a++)for(var $$=this._resInfos[$a],$w=$$.length-1;-1<$w;$w--){var $i;($i=$$[$w])&&$i.url===$x&&($$[$w]=null,$i.destroy(),$i.offAll(),this._infoPool.push($i))}delete $_._resMap[$x],this._next()}}},$I._createLoad=function($x,$I,$z,$k,$l,$n,$a,$$,$w){var $i=this;if(null==$n&&($n=2),null==$a&&($a=!0),void 0===$w&&($w=!1),$I instanceof Array)return this._loadAssets($I,$z,$k,$l,$n,$a,$$);var $F=$$x.getRes($I);if(null!=$F)$v.timer.frameOnce(1,null,function(){$k&&$k.runWith(1),$z&&$z.runWith($F),$i._loaderCount||$i.event("complete")});else{var $b=$_._resMap[$I];$b?($z&&$b._createListener("complete",$z.caller,$z.method,$z.args,!1,!1),$k&&$b._createListener("progress",$k.caller,$k.method,$k.args,!1,!1)):(($b=this._infoPool.length?this._infoPool.pop():new $T).url=$I,$b.clas=$x,$b.type=$l,$b.cache=$a,$b.group=$$,$b.ignoreCache=$w,$b.priority=$n,$z&&$b.on("complete",$z.caller,$z.method,$z.args),$k&&$b.on("progress",$k.caller,$k.method,$k.args),$_._resMap[$I]=$b,$n=$n<this._maxPriority?0<=$n?$n:0:this._maxPriority-1,this._resInfos[$n].push($b),this._next())}return this},$I._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $x=0;$x<this._maxPriority;$x++)for(var $I=this._resInfos[$x];0<$I.length;){var $z=$I.shift();if($z)return this._doLoad($z)}this._loaderCount||this.event("complete")}},$I._doLoad=function($I){var $z=this._loaders.length?this._loaders.pop():new $$x;this._loaderCount++,(this._loaderMap[$I.url]=$z).on("complete",null,$l),$z.on("progress",null,function($x){$I.event("progress",$x)}),$z.on("error",null,function($x){$l(null)}),$I.loader=$z;var $k=this;function $l($x){$z.offAll(),$z._data=null,$z._customParse=!1,$z._url=null,$z._class=null,$z._type=null,$k._loaders.push($z),$k._loaderCount--,delete $k._loaderMap[$I.url],$k._endLoad($I,$x instanceof Array?[$x]:$x),$k._next()}$z._class=$I.clas,1<=$I.priority?($z.priority=$I.priority,$z.realTime=!1):($z.priority=0,$z.realTime=!0),$z.load($I.url,$I.type,$I.cache,$I.group,$I.ignoreCache)},$I._endLoad=function($x,$I){var $z=$x.url;if(null==$I){var $k=this._failRes[$z]||0;if($k<this.retryNum)return console.warn("[warn]Retry to load:",$z),this._failRes[$z]=$k+1,void $v.timer.once(this.retryDelay,this,this._addReTry,[$x],!1);console.warn("[error]Failed to load:",$z),this.event("error",$z)}this._failRes[$z]&&(this._failRes[$z]=0),delete $_._resMap[$z],$x.event("complete",$I),$x.destroy(),$x.offAll(),this._infoPool.push($x)},$I._addReTry=function($x){this._resInfos[this._maxPriority-1].push($x),this._next()},$I.clearRes=function($x,$I){void 0===$I&&($I=!1),$$x.clearRes($x,$I)},$I.getRes=function($x){return $$x.getRes($x)},$I.cacheRes=function($x,$I){$$x.cacheRes($x,$I)},$I.clearTextureRes=function($x){$$x.clearTextureRes($x)},$I.setGroup=function($x,$I){$$x.setGroup($x,$I)},$I.clearResByGroup=function($x){$$x.clearResByGroup($x)},$I.clearUnLoaded=function(){for(var $x=0;$x<this._maxPriority;$x++){for(var $I=this._resInfos[$x],$z=$I.length-1;-1<$z;$z--){var $k=$I[$z];$k&&($k.destroy(),$k.offAll(),this._infoPool.push($k))}$I.length=0}this._loaderCount=0,$_._resMap={}},$I.cancelLoadByUrls=function($x){if($x)for(var $I=0,$z=$x.length;$I<$z;$I++)this.cancelLoadByUrl($x[$I])},$I.cancelLoadByUrl=function($x){for(var $I=0;$I<this._maxPriority;$I++)for(var $z=this._resInfos[$I],$k=$z.length-1;-1<$k;$k--){var $l=$z[$k];$l&&$l.url===$x&&($z[$k]=null,$l.destroy(),$l.offAll(),this._infoPool.push($l))}$_._resMap[$x]&&delete $_._resMap[$x]},$I._loadAssets=function($x,$z,$a,$I,$k,$l,$n){null==$k&&($k=2),null==$l&&($l=!0);for(var $$=$x.length,$w=0,$i=0,$F=[],$b=!0,$T=0;$T<$$;$T++){var $_=$x[$T];if(!$_)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$x);"string"==typeof $_&&($_={url:$_,type:$I,size:1,priority:$k}),$_.size||($_.size=1),$_.progress=0,$i+=$_.size,$F.push($_);var $R=$a?$f.create(null,$D,[$_],!1):null,$s=$z||$a?$f.create(null,$N,[$_]):null;this.load($_.url,$s,$R,$_.type,null!=$_.priority&&0<=$_.priority?$_.priority:2,$l,$_.group||$n)}function $N($x,$I){$w++,$x.progress=1,$I||($b=!1),$w===$$&&$z&&$z.runWith($b)}function $D($x,$I){if(null!=$a){$x.progress=$I;for(var $z=0,$k=0;$k<$F.length;$k++){var $l=$F[$k];$z+=$l.size*$l.progress}var $n=$z/$i;$a.runWith($n)}}return this},$_.cacheRes=function($x,$I){$$x.cacheRes($x,$I)},$_._resMap={},$w($_,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$_.__init$=function(){$T=function($x){function $I(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$I.__super.call(this)}return $N($I,"",$i),$I.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},$I}()},$_}(),$ix=(function($x){function $l($x){$l.__super.call(this),$x||($x=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $I=0,$z=0,$k=0;$k<20;$k++)$k%5!=4?this._mat[$I++]=$x[$k]:this._alpha[$z++]=$x[$k];this._action=$Z.createFilterAction(32),this._action.data=this}$N($l,"laya.filters.ColorFilter",$m);var $I=$l.prototype;$v.imps($I,{"laya.filters.IFilter":!0}),$I.callNative=function($x){$x._$P.cf=this;$x.conchModel&&$x.conchModel.setFilterMatrix&&$x.conchModel.setFilterMatrix(this._mat,this._alpha)},$F(0,$I,"type",function(){return 32}),$F(0,$I,"action",function(){return this._action})}(),function($x){function $k($x,$I,$z){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$I&&($I=0),$k.__super.call(this),this._byteClass=$z||$q,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$x&&0<$I&&$I<65535&&this.connect($x,$I)}$N($k,"laya.net.Socket",$i);var $I=$k.prototype;$I.connect=function($x,$I){var $z="ws://"+$x+":"+$I;$z="https:"==$W.window.location.protocol?"wss://"+$x+":"+$I:"ws://"+$x+":"+$I,this.connectByUrl($z)},$I.connectByUrl=function($x){var $I=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $W.window.WebSocket($x,this.protocols):this._socket=new $W.window.WebSocket($x),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($x){$I._onOpen($x)},this._socket.onmessage=function($x){$I._onMessage($x)},this._socket.onclose=function($x){$I._onClose($x)},this._socket.onerror=function($x){$I._onError($x)}},$I.cleanSocket=function(){try{this._socket.close()}catch($x){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$I.close=function(){if(null!=this._socket)try{this._socket.close()}catch($x){}},$I._onOpen=function($x){this._connected=!0,this.event("open",$x)},$I._onMessage=function($x){if($x&&$x.data){var $I=$x.data;if(this.disableInput&&$I)this.event("message",$I);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $z=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$I&&("string"==typeof $I?this._input.writeUTFBytes($I):this._input.writeArrayBuffer($I),this._addInputPosition=this._input.pos,this._input.pos=$z),this.event("message",$I)}}},$I._onClose=function($x){this._connected=!1,this.event("close",$x)},$I._onError=function($x){this.event("error",$x)},$I.send=function($x){this._socket.send($x)},$I.flush=function(){if(this._output&&0<this._output.length){var $I;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($x){$I=$x}this._output.endian=this.endian,this._output.clear(),$I&&this.event("error",$I)}},$F(0,$I,"input",function(){return this._input}),$F(0,$I,"output",function(){return this._output}),$F(0,$I,"connected",function(){return this._connected}),$F(0,$I,"endian",function(){return this._endian},function($x){this._endian=$x,null!=this._input&&(this._input.endian=$x),null!=this._output&&(this._output.endian=$x)}),$k.LITTLE_ENDIAN="littleEndian",$k.BIG_ENDIAN="bigEndian"}(),function($x){function $$(){$$.__super.call(this),this._$1__id=++$$._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($$._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$V.currentResourceManager&&$V.currentResourceManager.addResource(this)}$N($$,"laya.resource.Resource",$i);var $I=$$.prototype;return $v.imps($I,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$I._setUrl=function($x){var $I;this._url!==$x&&(this._url&&(($I=$$._urlResourcesMap[this._url]).splice($I.indexOf(this),1),0===$I.length&&delete $$._urlResourcesMap[this._url]),$x&&(($I=$$._urlResourcesMap[$x])||($$._urlResourcesMap[$x]=$I=[]),$I.push(this)),this._url=$x)},$I._getGroup=function(){return this._group},$I._setGroup=function($x){var $I;this._group!==$x&&(this._group&&(($I=$$._groupResourcesMap[this._group]).splice($I.indexOf(this),1),0===$I.length&&delete $$._groupResourcesMap[this._group]),$x&&(($I=$$._groupResourcesMap[$x])||($$._groupResourcesMap[$x]=$I=[]),$I.push(this)),this._group=$x)},$I._addReference=function(){this._referenceCount++},$I._removeReference=function(){this._referenceCount--},$I._clearReference=function(){this._referenceCount=0},$I._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$I.recreateResource=function(){this.completeCreate()},$I.disposeResource=function(){},$I.activeResource=function($x){void 0===$x&&($x=!1),this._lastUseFrameCount=$p.loopCount,!this._destroyed&&this.__loaded&&(this._released||$x)&&this.recreateResource()},$I.releaseResource=function($x){return void 0===$x&&($x=!0),!(!$x&&this.lock)&&(!(this._released&&!$x)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$I.onAsynLoaded=function($x,$I,$z){throw new Error("Resource: must override this function!")},$I.destroy=function(){var $x;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $$._idResourcesMap[this.id],this._url&&(($x=$$._urlResourcesMap[this._url])&&($x.splice($x.indexOf(this),1),0===$x.length&&delete $$._urlResourcesMap[this.url]),$$x.clearRes(this._url),this.__loaded||$Z.cancelLoadByUrl(this._url)),this._group&&(($x=$$._groupResourcesMap[this._group]).splice($x.indexOf(this),1),0===$x.length&&delete $$._groupResourcesMap[this.url]))},$I.completeCreate=function(){this._released=!1,this.event("recovered",this)},$I.dispose=function(){this.destroy()},$F(0,$I,"memorySize",function(){return this._memorySize},function($x){var $I=$x-this._memorySize;this._memorySize=$x,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$I),this.resourceManager&&this.resourceManager.addSize($I)}),$F(0,$I,"_loaded",null,function($x){this.__loaded=$x}),$F(0,$I,"loaded",function(){return this.__loaded}),$F(0,$I,"id",function(){return this._$1__id}),$F(0,$I,"destroyed",function(){return this._destroyed}),$F(0,$I,"group",function(){return this._getGroup()},function($x){this._setGroup($x)}),$F(0,$I,"resourceManager",function(){return this._resourceManager}),$F(0,$I,"url",function(){return this._url}),$F(0,$I,"released",function(){return this._released}),$F(0,$I,"referenceCount",function(){return this._referenceCount}),$$.getResourceByID=function($x){return $$._idResourcesMap[$x]},$$.getResourceByURL=function($x,$I){return void 0===$I&&($I=0),null==$$._urlResourcesMap[$x]?null:$$._urlResourcesMap[$x][$I]},$$.getResourceCountByURL=function($x){return $$._urlResourcesMap[$x].length},$$.destroyUnusedResources=function($x){var $I;if($x){var $z=$$._groupResourcesMap[$x];if($z)for(var $k=$z.slice(),$l=0,$n=$k.length;$l<$n;$l++)($I=$k[$l]).lock||0!==$I._referenceCount||$I.destroy()}else for(var $a in $$._idResourcesMap)($I=$$._idResourcesMap[$a]).lock||0!==$I._referenceCount||$I.destroy()},$$._uniqueIDCounter=0,$$._idResourcesMap={},$$._urlResourcesMap={},$$._groupResourcesMap={},$$}()),$Fx=function($x){function $E($x,$I){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$E.__super.call(this),$x&&null!=$x._addReference&&$x._addReference(),this.setTo($x,$I)}$N($E,"laya.resource.Texture",$i);var $I=$E.prototype;return $I._setUrl=function($x){this.url=$x},$I.setTo=function($x,$I){if($x instanceof $_.HTMLElement){var $z=$mx.create("2D",$x);this.bitmap=$z}else this.bitmap=$x;if(this.uv=$I||$E.DEF_UV,$x){this._w=$x.width,this._h=$x.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $k=this;if(this._loaded)$Z.addToAtlas&&$Z.addToAtlas($k);else{var $l=$x;$l instanceof laya.resource.HTMLImage&&$l.image&&$l.image.addEventListener("load",function($x){$Z.addToAtlas&&$Z.addToAtlas($k)},!1)}}},$I.active=function(){this.bitmap&&this.bitmap.activeResource()},$I.destroy=function($x){if(void 0===$x&&($x=!1),this.alphaTexture&&(this.alphaTexture.destroy($x),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $I=this.bitmap;$x?($j.isConchApp&&$I.source&&$I.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$I.dispose(),$I._clearReference()):($I._removeReference(),0==$I.referenceCount&&($j.isConchApp&&$I.source&&$I.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$I.dispose())),this.url&&this===$v.loader.getRes(this.url)&&$v.loader.clearRes(this.url,$x),this._loaded=!1}},$I.load=function($x){var $I=this;this._loaded=!1,$x=$d.customFormat($x);var $z=this.bitmap||(this.bitmap=$Px.create($x));$z.uri=$x,$z&&$z._addReference();var $k=this;$z.onload=function(){$z.onload=null,$k._loaded=!0,$I.sourceWidth=$I._w=$z.width,$I.sourceHeight=$I._h=$z.height,$k.event("loaded",this),$Z.addToAtlas&&$Z.addToAtlas($k)}},$I.addTextureToAtlas=function($x){$Z.addTextureToAtlas(this)},$I.getPixels=function($x,$I,$z,$k){if($j.isConchApp){var $l=this.bitmap;if($l.source&&$l.source.getImageData){var $n=$l.source.getImageData($x,$I,$z,$k),$a=new Uint8Array($n);return Array.from($a)}return null}return $j.isWebGL?$Z.getTexturePixels(this,$x,$I,$z,$k):($W.canvas.size($z,$k),$W.canvas.clear(),$W.context.drawTexture(this,-$x,-$I,this.width,this.height,0,0),$W.context.getImageData(0,0,$z,$k).data)},$I.onAsynLoaded=function($x,$I){if($I){if("function"!=typeof $I._addReference)throw new Error("bitmap._addReference is not a function. "+$I.className+" "+typeof $I._addReference+" "+$I.constructor);$I._addReference()}this.setTo($I,this.uv),this._loaded&&this.event("loaded",this)},$F(0,$I,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$F(0,$I,"loaded",function(){return this._loaded}),$F(0,$I,"released",function(){return!this.bitmap||this.bitmap.released}),$F(0,$I,"width",function(){return this._w?this._w:this.uv&&this.uv!==$E.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($x){this._w=$x,this.sourceWidth||(this.sourceWidth=$x)}),$F(0,$I,"repeat",function(){return!$j.isWebGL||!this.bitmap||this.bitmap.repeat},function($x){$x&&$j.isWebGL&&this.bitmap&&(this.bitmap.repeat=$x)&&(this.bitmap.enableMerageInAtlas=!1)}),$F(0,$I,"height",function(){return this._h?this._h:this.uv&&this.uv!==$E.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($x){this._h=$x,this.sourceHeight||(this.sourceHeight=$x)}),$F(0,$I,"isLinearSampling",function(){return!$j.isWebGL||9728!=this.bitmap.minFifter},function($x){!$x&&$j.isWebGL&&($x||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$E.moveUV=function($x,$I,$z){for(var $k=0;$k<8;$k+=2)$z[$k]+=$x,$z[$k+1]+=$I;return $z},$E.create=function($x,$I,$z,$k,$l,$n,$a,$$,$w){void 0===$n&&($n=0),void 0===$a&&($a=0),void 0===$$&&($$=0),void 0===$w&&($w=0);var $i=$x instanceof laya.resource.Texture,$F=$i?$x.uv:$E.DEF_UV,$b=$i?$x.bitmap:$x,$T=$Z.isAtlas($b);if($T){var $_=$b._atlaser,$R=$x._atlasID;if(-1==$R)throw new Error("create texture error");$b=$_._inAtlasTextureBitmapValue[$R],$F=$_._inAtlasTextureOriUVValue[$R]}var $s=new $E($b,null);if(!$b)return null;$b.width&&$I+$k>$b.width&&($k=$b.width-$I),$b.height&&$z+$l>$b.height&&($l=$b.height-$z),$s.width=$k,$s.height=$l,$s.offsetX=$n,$s.offsetY=$a,$s.sourceWidth=$$||$k,$s.sourceHeight=$w||$l;var $N=1/$b.width,$D=1/$b.height;$I*=$N,$z*=$D,$k*=$N,$l*=$D;var $f=$s.uv[0],$m=$s.uv[1],$y=$s.uv[4],$C=$s.uv[5],$P=$y-$f,$v=$C-$m,$L=$E.moveUV($F[0],$F[1],[$I,$z,$I+$k,$z,$I+$k,$z+$l,$I,$z+$l]);$s.uv=[$f+$L[0]*$P,$m+$L[1]*$v,$y-(1-$L[2])*$P,$m+$L[3]*$v,$y-(1-$L[4])*$P,$C-(1-$L[5])*$v,$f+$L[6]*$P,$C-(1-$L[7])*$v],$T&&$s.addTextureToAtlas();var $K=$b.scaleRate;return $K&&1!=$K?($s.sourceWidth/=$K,$s.sourceHeight/=$K,$s.width/=$K,$s.height/=$K,$s.scaleRate=$K,$s.offsetX/=$K,$s.offsetY/=$K):$s.scaleRate=1,$s},$E.createFromTexture=function($x,$I,$z,$k,$l){var $n=$x.scaleRate;1!=$n&&($I*=$n,$z*=$n,$k*=$n,$l*=$n);var $a=$K.TEMP.setTo($I-$x.offsetX,$z-$x.offsetY,$k,$l),$$=$a.intersection($E._rect1.setTo(0,0,$x.width,$x.height),$E._rect2);if(!$$)return null;var $w=$E.create($x,$$.x,$$.y,$$.width,$$.height,$$.x-$a.x,$$.y-$a.y,$k,$l);if($w.bitmap&&$w.bitmap._removeReference)return $w.bitmap._removeReference(),$w;var $i="bitmap:"+($w.bitmap?$w.bitmap.constructor?$w.bitmap.constructor.name:$w.bitmap.__className:"")+", url:"+($x.url+" | "+($w.bitmap?$w.bitmap.url:$x.url))+", x="+$I+",y="+$z+",width="+$k+",height="+$l+", result="+($$?$$.x+","+$$.y+","+$$.width+","+$$.height:"null")+", rect="+$a.x+","+$a.y+","+$a.width+","+$a.height;throw new Error("报错：bitmap._removeReference is not a function  "+$i)},$E.DEF_UV=[0,0,1,0,1,1,0,1],$E.INV_UV=[0,1,1,1,1,0,0,0],$E._rect1=new $K,$E._rect2=new $K,$E}(),$x=function($x){var $$;function $n(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$n.__super.call(this)}$N($n,"laya.utils.TimeLine",$i);var $I=$n.prototype;return $I.to=function($x,$I,$z,$k,$l){return void 0===$l&&($l=0),this._create($x,$I,$z,$k,$l,!0)},$I.from=function($x,$I,$z,$k,$l){return void 0===$l&&($l=0),this._create($x,$I,$z,$k,$l,!1)},$I._create=function($x,$I,$z,$k,$l,$n){var $a=$H.getItemByClass("tweenData",$$);return $a.isTo=$n,$a.type=0,$a.target=$x,$a.duration=$z,$a.data=$I,$a.startTime=this._startTime+$l,$a.endTime=$a.startTime+$a.duration,$a.ease=$k,this._startTime=Math.max($a.endTime,this._startTime),this._tweenDataList.push($a),this._startTimeSort=!0,this._endTimeSort=!0,this},$I.addLabel=function($x,$I){var $z=$H.getItemByClass("tweenData",$$);return $z.type=1,$z.data=$x,$z.endTime=$z.startTime=this._startTime+$I,this._labelDic||(this._labelDic={}),this._labelDic[$x]=$z,this._tweenDataList.push($z),this},$I.removeLabel=function($x){if(this._labelDic&&this._labelDic[$x]){var $I=this._labelDic[$x];if($I){var $z=this._tweenDataList.indexOf($I);-1<$z&&this._tweenDataList.splice($z,1)}delete this._labelDic[$x]}},$I.gotoTime=function($x){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $I,$z,$k,$l;for(var $n in this._firstTweenDic)if($z=this._firstTweenDic[$n])for(var $a in $z)$z.diyTarget.hasOwnProperty($a)&&($z.diyTarget[$a]=$z[$a]);for($n in this._tweenDic)($I=this._tweenDic[$n]).clear(),delete this._tweenDic[$n];if(this._index=0,this._gidIndex=0,this._currTime=$x,this._lastTime=$W.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$k=this._tweenDataList.concat(),$k.sort(function($x,$I){return $x.endTime>$I.endTime?1:$x.endTime<$I.endTime?-1:0})}else $k=this._endTweenDataList;for(var $$=0,$w=$k.length;$$<$w;$$++)if(0==($l=$k[$$]).type){if(!($x>=$l.endTime))break;this._index=Math.max(this._index,$$+1);var $i=$l.data;if($l.isTo)for(var $F in $i)$l.target[$F]=$i[$F]}for($$=0,$w=this._tweenDataList.length;$$<$w;$$++)0==($l=this._tweenDataList[$$]).type&&$x>=$l.startTime&&$x<$l.endTime&&(this._index=Math.max(this._index,$$+1),this._gidIndex++,($I=$H.getItemByClass("tween",$r))._create($l.target,$l.data,$l.duration,$l.ease,$f.create(this,this._animComplete,[this._gidIndex]),0,!1,$l.isTo,!0,!1),$I.setStartTime(this._currTime-($x-$l.startTime)),$I._updateEase(this._currTime),$I.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$I)}},$I.gotoLabel=function($x){if(null!=this._labelDic){var $I=this._labelDic[$x];$I&&this.gotoTime($I.startTime)}},$I.pause=function(){$v.timer.clear(this,this._update)},$I.resume=function(){this.play(this._currTime,this._loopKey)},$I.play=function($x,$I){if(void 0===$x&&($x=0),void 0===$I&&($I=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($x,$I){return $x.startTime>$I.startTime?1:$x.startTime<$I.startTime?-1:0});for(var $z=0,$k=this._tweenDataList.length;$z<$k;$z++){var $l=this._tweenDataList[$z];if(null!=$l&&0==$l.type){var $n=$l.target,$a=$n.$_GID||($n.$_GID=$g.getGID()),$$=null;for(var $w in null==this._firstTweenDic[$a]?(($$={}).diyTarget=$n,this._firstTweenDic[$a]=$$):$$=this._firstTweenDic[$a],$l.data)null==$$[$w]&&($$[$w]=$n[$w])}}}"string"==typeof $x?this.gotoLabel($x):this.gotoTime($x),this._loopKey=$I,this._lastTime=$W.now(),$v.timer.frameLoop(1,this,this._update)}},$I._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $x in this._tweenDic)($I=this._tweenDic[$x]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $I,$z=$W.now(),$k=$z-this._lastTime,$l=this._currTime+=$k*this.scale;for($x in this._lastTime=$z,this._tweenDic)($I=this._tweenDic[$x])._updateEase($l);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $n=this._tweenDataList[this._index];$l>=$n.startTime&&(this._index++,0==$n.type?(this._gidIndex++,($I=$H.getItemByClass("tween",$r))._create($n.target,$n.data,$n.duration,$n.ease,$f.create(this,this._animComplete,[this._gidIndex]),0,!1,$n.isTo,!0,!1),$I.setStartTime($l),$I.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$I)._updateEase($l)):this.event("label",$n.data))}},$I._animComplete=function($x){this._tweenDic[$x]&&delete this._tweenDic[$x]},$I._complete=function(){this.event("complete")},$I.reset=function(){var $x;if(this._labelDic)for($x in this._labelDic)delete this._labelDic[$x];for($x in this._tweenDic)this._tweenDic[$x].clear(),delete this._tweenDic[$x];for($x in this._firstTweenDic)delete this._firstTweenDic[$x];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $I,$z=0;for($I=this._tweenDataList.length,$z=0;$z<$I;$z++)this._tweenDataList[$z]&&this._tweenDataList[$z].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$v.timer.clear(this,this._update)},$I.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$F(0,$I,"index",function(){return this._frameIndex},function($x){this._frameIndex=$x,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$F(0,$I,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$n.to=function($x,$I,$z,$k,$l){return void 0===$l&&($l=0),(new $n).to($x,$I,$z,$k,$l)},$n.from=function($x,$I,$z,$k,$l){return void 0===$l&&($l=0),(new $n).from($x,$I,$z,$k,$l)},$n.__init$=function(){$$=function(){function $x(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $N($x,""),$x.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$H.recover("tweenData",this)},$x}()},$n}(),$bx=function($l){function $z(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$z.__super.call(this),this._style=$$.EMPTY}$N($z,"laya.display.Sprite",$l);var $x=$z.prototype;return $v.imps($x,{"laya.display.ILayout":!0}),$x.createConchModel=function(){return new ConchNode},$x.destroy=function($x){if(void 0===$x&&($x=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $I=this.mask;$I&&(this.mask=null,$I.destroy($x))}$l.prototype.destroy.call(this,$x),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$x.updateZOrder=function(){$g.updateOrder(this._childs)&&this.repaint()},$x.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$x.setBounds=function($x){this._set$P("uBounds",$x)},$x.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $K),$K._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$x.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $K),$K._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$x._boundPointsToParent=function($x){void 0===$x&&($x=!1);var $I=0,$z=0;this._style&&($I=this._style._tf.translateX,$z=this._style._tf.translateY,$x=$x||0!==this._style._tf.rotate,this._style.scrollRect&&($I+=this._style.scrollRect.x,$z+=this._style.scrollRect.y));var $k=this._getBoundPointsM($x);if(!$k||$k.length<1)return $k;if(8!=$k.length&&($k=$x?$C.scanPList($k):$K._getWrapRec($k,$K.TEMP)._getBoundPoints()),!this.transform)return $g.transPointList($k,this._x-$I,this._y-$z),$k;var $l=$L.TEMP,$n=0,$a=$k.length;for($n=0;$n<$a;$n+=2)$l.x=$k[$n],$l.y=$k[$n+1],this.toParentPoint($l),$k[$n]=$l.x,$k[$n+1]=$l.y;return $k},$x.getGraphicBounds=function($x){return void 0===$x&&($x=!1),this._graphics?this._graphics.getBounds($x):$K.TEMP.setTo(0,0,0,0)},$x._getBoundPointsM=function($x){if(void 0===$x&&($x=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $I=$g.clearArray(this._$P.temBM),$z=$K.TEMP;return $z.copyFrom(this.scrollRect),$g.concatArray($I,$z._getBoundPoints()),$I}for(var $k,$l,$n,$a=this._graphics?this._graphics.getBoundPoints():$g.clearArray(this._$P.temBM),$$=0,$w=($n=this._childs).length;$$<$w;$$++)($k=$n[$$])instanceof laya.display.Sprite&&1==$k.visible&&($l=$k._boundPointsToParent($x))&&($a=$a?$g.concatArray($a,$l):$l);return $a},$x.getStyle=function(){return this._style===$$.EMPTY&&(this._style=new $$),this._style},$x.setStyle=function($x){this._style=$x},$x._adjustTransform=function(){this._tfChanged=!1;var $x,$I=this._style._tf,$z=$I.scaleX,$k=$I.scaleY;if($I.rotate||1!==$z||1!==$k||$I.skewX||$I.skewY){($x=this._transform||(this._transform=$U.create())).bTransform=!0;var $l=.0174532922222222*($I.rotate-$I.skewX),$n=.0174532922222222*($I.rotate+$I.skewY),$a=Math.cos($n),$$=Math.sin($n),$w=Math.sin($l),$i=Math.cos($l);return $x.a=$z*$a,$x.b=$z*$$,$x.c=-$k*$w,$x.d=$k*$i,$x.tx=$x.ty=0,$x}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$x},$x.pos=function($x,$I,$z){if(void 0===$z&&($z=!1),this._x!==$x||this._y!==$I){if(this.destroyed)return this;if($z){this._x=$x,this._y=$I,this.conchModel&&this.conchModel.pos(this._x,this._y);var $k=this._parent;$k&&0===$k._repaint&&($k._repaint=1,$k.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$x,this.y=$I}return this},$x.pivot=function($x,$I){return this.pivotX=$x,this.pivotY=$I,this},$x.size=function($x,$I){return this.width=$x,this.height=$I,this},$x.scale=function($x,$I,$z){void 0===$z&&($z=!1);var $k=this.getStyle(),$l=$k._tf;if($l.scaleX!=$x||$l.scaleY!=$I){if(this.destroyed)return this;if($z){$k.setScale($x,$I),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($x,$I),this._renderType|=4;var $n=this._parent;$n&&0===$n._repaint&&($n._repaint=1,$n.parentRepaint())}else this.scaleX=$x,this.scaleY=$I}return this},$x.skew=function($x,$I){return this.skewX=$x,this.skewY=$I,this},$x.render=function($x,$I,$z){$p.spriteCount++,$Y.renders[this._renderType]._fun(this,$x,$I+this._x,$z+this._y),this._repaint=0},$x.drawToCanvas=function($x,$I,$z,$k){if($j.isConchNode){var $l=$mx.create("2D");return new $t($x,$I,$l).ctx.setCanvasType(1),this.conchModel.drawToCanvas($l.source,$z,$k),$l}return $Z.drawToCanvas(this,this._renderType,$x,$I,$z,$k)},$x.customRender=function($x,$I,$z){this._renderType|=1024},$x._applyFilters=function(){var $x;if(!$j.isWebGL&&(($x=this._$P.filters)&&!($x.length<1)))for(var $I=0,$z=$x.length;$I<$z;$I++)$x[$I].action.apply(this._$P.cacheCanvas)},$x._isHaveGlowFilter=function(){var $x,$I=0;if(this.filters)for($I=0;$I<this.filters.length;$I++)if(8==this.filters[$I].type)return!0;for($I=0,$x=this._childs.length;$I<$x;$I++)if(this._childs[$I]._isHaveGlowFilter())return!0;return!1},$x.localToGlobal=function($x,$I){void 0===$I&&($I=!1),!0===$I&&($x=new $L($x.x,$x.y));for(var $z=this;$z&&$z!=$v.stage;)$x=$z.toParentPoint($x),$z=$z.parent;return $x},$x.globalToLocal=function($x,$I){void 0===$I&&($I=!1),$I&&($x=new $L($x.x,$x.y));for(var $z=this,$k=[];$z&&$z!=$v.stage;)$k.push($z),$z=$z.parent;for(var $l=$k.length-1;0<=$l;)$x=($z=$k[$l]).fromParentPoint($x),$l--;return $x},$x.toParentPoint=function($x){if(!$x)return $x;$x.x-=this.pivotX,$x.y-=this.pivotY,this.transform&&this._transform.transformPoint($x),$x.x+=this._x,$x.y+=this._y;var $I=this._style.scrollRect;return $I&&($x.x-=$I.x,$x.y-=$I.y),$x},$x.fromParentPoint=function($x){if(!$x)return $x;$x.x-=this._x,$x.y-=this._y;var $I=this._style.scrollRect;return $I&&($x.x+=$I.x,$x.y+=$I.y),this.transform&&this._transform.invertTransformPoint($x),$x.x+=this.pivotX,$x.y+=this.pivotY,$x},$x.on=function($x,$I,$z,$k){return 1!==this._mouseEnableState&&this.isMouseEvent($x)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($x,$I,$z,$k,!1)):$l.prototype.on.call(this,$x,$I,$z,$k)},$x.once=function($x,$I,$z,$k){return 1!==this._mouseEnableState&&this.isMouseEvent($x)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($x,$I,$z,$k,!0)):$l.prototype.once.call(this,$x,$I,$z,$k)},$x._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $x=this;for($x=$x.parent;$x&&1!==$x._mouseEnableState&&!$x._getBit(2);)$x.mouseEnabled=!0,$x._setBit(2,!0),$x=$x.parent}},$x.loadImage=function($x,$I,$z,$k,$l,$n){var $a=this;return void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=0),void 0===$l&&($l=0),this.graphics.loadImage($x,$I,$z,$k,$l,function($x){$a.destroyed||($a.size($I+($k||$x.width),$z+($l||$x.height)),$a.repaint(),$n&&$n.runWith($x))}),this},$x.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$x._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$x._childChanged=function($x){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$x&&this._get$P("hasZorder")&&$v.timer.callLater(this,this.updateZOrder),this.repaint()},$x.parentRepaint=function(){var $x=this._parent;$x&&0===$x._repaint&&($x._repaint=1,$x.parentRepaint())},$x.startDrag=function($x,$I,$z,$k,$l,$n,$a){void 0===$I&&($I=!1),void 0===$z&&($z=0),void 0===$k&&($k=300),void 0===$n&&($n=!1),void 0===$a&&($a=.92),this._$P.dragging||this._set$P("dragging",new $B),this._$P.dragging.start(this,$x,$I,$z,$k,$l,$n,$a)},$x.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$x._releaseMem=function(){if(this._$P){var $x=this._$P.cacheCanvas;$x&&$x.ctx&&($H.recover("RenderContext",$x.ctx),$x.ctx.canvas.size(0,0),$x.ctx=null);var $I=this._$P._filterCache;$I&&($I.destroy(),$I.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$x._setDisplay=function($x){$x||this._releaseMem(),$l.prototype._setDisplay.call(this,$x)},$x.hitTestPoint=function($x,$I){var $z=this.globalToLocal($L.TEMP.setTo($x,$I));return $x=$z.x,$I=$z.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$K.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($x,$I)},$x.getMousePoint=function(){return this.globalToLocal($L.TEMP.setTo($v.stage.mouseX,$v.stage.mouseY))},$x._getWords=function(){return null},$x._addChildsToLayout=function($x){var $I=this._getWords();if(null==$I&&0==this._childs.length)return!1;if($I)for(var $z=0,$k=$I.length;$z<$k;$z++)$x.push($I[$z]);$z=0;for(var $l=this._childs.length;$z<$l;++$z){var $n=this._childs[$z];$n._style._enableLayout()&&$n._addToLayout($x)}return!0},$x._addToLayout=function($x){this._style.absolute||(this._style.block?$x.push(this):this._addChildsToLayout($x)&&(this.x=this.y=0))},$x._isChar=function(){return!1},$x._getCSSStyle=function(){return this._style.getCSSStyle()},$x._setAttributes=function($x,$I){switch($x){case"x":this.x=parseFloat($I);break;case"y":this.y=parseFloat($I);break;case"width":this.width=parseFloat($I);break;case"height":this.height=parseFloat($I);break;default:this[$x]=$I}},$x._layoutLater=function(){this.parent&&this.parent._layoutLater()},$F(0,$x,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($x){this._optimizeScrollRect!=$x&&(this._optimizeScrollRect=$x,this.conchModel&&this.conchModel.optimizeScrollRect($x))}),$F(0,$x,"customRenderEnable",null,function($x){if($x&&(this._renderType|=1024,$j.isConchNode)){$z.CustomList.push(this);var $I=new $mx("2d");$I._setContext(new CanvasRenderingContext2D),this.customContext=new $t(0,0,$I),$I.context.setCanvasType&&$I.context.setCanvasType(2),this.conchModel.custom($I.context)}}),$F(0,$x,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($x){this.cacheAs=$x?this._$P.hasFilter?"none":"normal":"none"}),$F(0,$x,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($x){var $I=this._$P.cacheCanvas;if($x!==($I?$I.type:"none")){if("none"!==$x)this._getBit(1)||this._setUpNoticeType(1),$I||($I=this._set$P("cacheCanvas",$H.getItemByClass("cacheCanvas",Object))),$I.type=$x,$I.reCache=!0,this._renderType|=16,"bitmap"==$x&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($I){var $z=$I;$z&&$z.ctx&&($H.recover("RenderContext",$z.ctx),$z.ctx.canvas.size(0,0),$z.ctx=null),$H.recover("cacheCanvas",$I)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$F(0,$x,"zOrder",function(){return this._zOrder},function($x){this._zOrder!=$x&&(this._zOrder=$x,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($x),this._parent&&($x&&this._parent._set$P("hasZorder",!0),$v.timer.callLater(this._parent,this.updateZOrder)))}),$F(0,$x,"rotation",function(){return this._style._tf.rotate},function($x){var $I=this.getStyle();if($I._tf.rotate!==$x){$I.setRotate($x),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($x),this._renderType|=4;var $z=this._parent;$z&&0===$z._repaint&&($z._repaint=1,$z.parentRepaint())}}),$F(0,$x,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($x){this._width!==$x&&(this._width=$x,this.conchModel&&this.conchModel.size($x,this._height),this.repaint())}),$F(0,$x,"x",function(){return this._x},function($x){if(this._x!==$x){if(this.destroyed)return;this._x=$x,this.conchModel&&this.conchModel.pos($x,this._y);var $I=this._parent;$I&&0===$I._repaint&&($I._repaint=1,$I.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$F(0,$x,"globalScaleY",function(){for(var $x=1,$I=this;$I&&$I!==$v.stage;)$x*=$I.scaleY,$I=$I.parent;return $x}),$F(0,$x,"hitArea",function(){return this._$P.hitArea},function($x){this._set$P("hitArea",$x)}),$F(0,$x,"staticCache",function(){return this._$P.staticCache},function($x){this._set$P("staticCache",$x),$x||this.reCache()}),$F(0,$x,"texture",function(){return this._texture},function($x){this._texture!=$x&&(this._texture=$x,this.graphics.cleanByTexture($x,0,0))}),$F(0,$x,"y",function(){return this._y},function($x){if(this._y!==$x){if(this.destroyed)return;this._y=$x,this.conchModel&&this.conchModel.pos(this._x,$x);var $I=this._parent;$I&&0===$I._repaint&&($I._repaint=1,$I.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$F(0,$x,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($x){this._height!==$x&&(this._height=$x,this.conchModel&&this.conchModel.size(this._width,$x),this.repaint())}),$F(0,$x,"blendMode",function(){return this._style.blendMode},function($x){this.getStyle().blendMode=$x,this.conchModel&&this.conchModel.blendMode($x),$x&&"source-over"!=$x?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$F(0,$x,"scaleX",function(){return this._style._tf.scaleX},function($x){var $I=this.getStyle();if($I._tf.scaleX!==$x){$I.setScaleX($x),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($x,$I._tf.scaleY),this._renderType|=4;var $z=this._parent;$z&&0===$z._repaint&&($z._repaint=1,$z.parentRepaint())}}),$F(0,$x,"scaleY",function(){return this._style._tf.scaleY},function($x){var $I=this.getStyle();if($I._tf.scaleY!==$x){$I.setScaleY($x),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($I._tf.scaleX,$x),this._renderType|=4;var $z=this._parent;$z&&0===$z._repaint&&($z._repaint=1,$z.parentRepaint())}}),$F(0,$x,"stage",function(){return $v.stage}),$F(0,$x,"skewX",function(){return this._style._tf.skewX},function($x){var $I=this.getStyle();if($I._tf.skewX!==$x){$I.setSkewX($x),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($x,$I._tf.skewY),this._renderType|=4;var $z=this._parent;$z&&0===$z._repaint&&($z._repaint=1,$z.parentRepaint())}}),$F(0,$x,"scrollRect",function(){return this._style.scrollRect},function($x){this.getStyle().scrollRect=$x,this.repaint(),$x?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($x.x,$x.y,$x.width,$x.height)):(this._renderType&=-129,this.conchModel&&($z.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$F(0,$x,"skewY",function(){return this._style._tf.skewY},function($x){var $I=this.getStyle();if($I._tf.skewY!==$x){$I.setSkewY($x),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($I._tf.skewX,$x),this._renderType|=4;var $z=this._parent;$z&&0===$z._repaint&&($z._repaint=1,$z.parentRepaint())}}),$F(0,$x,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($x){this._tfChanged=!1,(this._transform=$x)&&(this._x=$x.tx,this._y=$x.ty,$x.tx=$x.ty=0,this.conchModel&&this.conchModel.transform($x.a,$x.b,$x.c,$x.d,this._x,this._y)),$x?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$F(0,$x,"pivotX",function(){return this._style._tf.translateX},function($x){this.getStyle().setTranslateX($x),this.conchModel&&this.conchModel.pivot($x,this._style._tf.translateY),this.repaint()}),$F(0,$x,"pivotY",function(){return this._style._tf.translateY},function($x){this.getStyle().setTranslateY($x),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$x),this.repaint()}),$F(0,$x,"alpha",function(){return this._style.alpha},function($x){this._style&&this._style.alpha!==$x&&($x=$x<0?0:1<$x?1:$x,this.getStyle().alpha=$x,this.conchModel&&this.conchModel.alpha($x),1!==$x?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$F(0,$x,"visible",function(){return this._style.visible},function($x){this._style&&this._style.visible!==$x&&(this.getStyle().visible=$x,this.conchModel&&this.conchModel.visible($x),this.parentRepaint())}),$F(0,$x,"graphics",function(){return this._graphics||(this.graphics=$Z.createGraphics())},function($x){this._graphics&&(this._graphics._sp=null),(this._graphics=$x)?(this._renderType&=-2,this._renderType|=512,($x._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($z.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$F(0,$x,"filters",function(){return this._$P.filters},function($x){$x&&0===$x.length&&($x=null),this._$P.filters!=$x&&(this._set$P("filters",$x?$x.slice():null),$j.isConchApp&&(this.conchModel&&($z.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$j.isWebGL&&($x&&$x.length?this._renderType|=32:this._renderType&=-33),$x&&0<$x.length?(this._getBit(1)||this._setUpNoticeType(1),$j.isWebGL&&1==$x.length&&$x[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($j.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$F(0,$x,"parent",$l.prototype._$get_parent,function($x){$v.superSet($xx,this,"parent",$x),$x&&this._getBit(2)&&this._$2__onDisplay()}),$F(0,$x,"mask",function(){return this._$P._mask},function($x){$x&&this.mask&&this.mask._$P.maskParent||($x?(this.cacheAs="bitmap",this._set$P("_mask",$x),$x._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$x),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($x?$x.conchModel:null),this._renderType|=64,this.parentRepaint())}),$F(0,$x,"mouseEnabled",function(){return 1<this._mouseEnableState},function($x){this._mouseEnableState=$x?2:1}),$F(0,$x,"globalScaleX",function(){for(var $x=1,$I=this;$I&&$I!==$v.stage;)$x*=$I.scaleX,$I=$I.parent;return $x}),$F(0,$x,"mouseX",function(){return this.getMousePoint().x}),$F(0,$x,"mouseY",function(){return this.getMousePoint().y}),$z.fromImage=function($x){return(new $z).loadImage($x)},$z._cachePool=[],$z.CustomList=[],$w($z,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$_.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$z}($xx),$Tx=function($x){function $I($x){this._audio=null,this._onEnd=null,this._resumePlay=null,$I.__super.call(this),this._onEnd=$g.bind(this.__onEnd,this),this._resumePlay=$g.bind(this.__resumePlay,this),$x.addEventListener("ended",this._onEnd),this._audio=$x}$N($I,"laya.media.h5audio.AudioSoundChannel",$kx);var $z=$I.prototype;return $z.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($v.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$z.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$W.container.appendChild(this._audio),this._audio.play()}catch($x){this.event("error")}},$z.play=function($x){this.isStopped=!1;try{this._audio.playbackRate=$S.playbackRate,this._audio.currentTime=this.startTime}catch($x){return void this._audio.addEventListener("canplay",this._resumePlay)}$S.addChannel(this),$W.container.appendChild(this._audio),!$x&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$z.stop=function(){this.isStopped=!0,$S.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$j.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$W.onIE||this._audio!=$zx._musicAudio&&$H.recover("audio:"+this.url,this._audio),$W.removeElement(this._audio),this._audio=null)},$z.pause=function(){this.isStopped=!0,$S.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$z.resume=function(){this._audio&&(this.isStopped=!1,$S.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$F(0,$z,"position",function(){return this._audio?this._audio.currentTime:0}),$F(0,$z,"duration",function(){return this._audio?this._audio.duration:0}),$F(0,$z,"volume",function(){return this._audio?this._audio.volume:1},function($x){this._audio&&(this._audio.volume=$x)}),$I}(),$_x=function($x){function $I(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$nx.ctx,$I.__super.call(this),this._onPlayEnd=$g.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$N($I,"laya.media.webaudio.WebAudioSoundChannel",$kx);var $z=$I.prototype;return $z.play=function($x){if($S.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $I=this.context,$z=this.gain,$k=$I.createBufferSource();(this.bufferSource=$k).buffer=this.audioBuffer,$k.connect($z),$z&&$z.disconnect(),$z.connect($I.destination),$k.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$W.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($k.loop=!0),$k.playbackRate.setTargetAtTime?$k.playbackRate.setTargetAtTime($S.playbackRate,this.context.currentTime,.1):$k.playbackRate.value=$S.playbackRate,$k.start(0,this.startTime),!$x&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$z.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($v.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$z._clearBufferSource=function(){if(this.bufferSource){var $x=this.bufferSource;$x.stop?$x.stop(0):$x.noteOff(0),$x.disconnect(0),$x.onended=null,$I._tryCleanFailed||this._tryClearBuffer($x),this.bufferSource=null}},$z._tryClearBuffer=function($x){try{$x.buffer=null}catch($x){$I._tryCleanFailed=!0}},$z.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$S.removeChannel(this),this.startHandler=null,this.completeHandler=null},$z.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$S.removeChannel(this)},$z.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$F(0,$z,"position",function(){return this.bufferSource?($W.now()-this._startTime)/1e3+this.startTime:0}),$F(0,$z,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$F(0,$z,"volume",function(){return this._volume},function($x){this.isStopped||(this._volume=$x,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($x,this.context.currentTime,.1):this.gain.gain.value=$x)}),$I._tryCleanFailed=!1,$I}(),$Rx=function($x){function $I(){$I.__super.call(this),this._w=0,this._h=0}$N($I,"laya.resource.Bitmap",$ix);var $z=$I.prototype;return $F(0,$z,"width",function(){return this._w}),$F(0,$z,"height",function(){return this._h}),$F(0,$z,"source",function(){return this._source}),$I}(),$sx=function($I){function $x(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$x.__super.call(this),this._interval=$k.animationInterval,this._setUpNoticeType(1)}$N($x,"laya.display.AnimationPlayerBase",$I);var $z=$x.prototype;return $z.play=function($x,$I,$z,$k){void 0===$x&&($x=0),void 0===$I&&($I=!0),void 0===$z&&($z=""),void 0===$k&&($k=!0),this._isPlaying=!0,this.index="string"==typeof $x?this._getFrameByLabel($x):$x,this.loop=$I,this._actionName=$z,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$z._getFrameByLabel=function($x){var $I=0;for($I=0;$I<this._count;$I++)if(this._labels[$I]&&0<=this._labels[$I].indexOf($x))return $I;return 0},$z._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$z._setControlNode=function($x){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$x)&&$x!=this&&($x.on("display",this,this._checkResumePlaying),$x.on("undisplay",this,this._checkResumePlaying))},$z._setDisplay=function($x){$I.prototype._setDisplay.call(this,$x),this._checkResumePlaying()},$z._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$z.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$z.addLabel=function($x,$I){this._labels||(this._labels={}),this._labels[$I]||(this._labels[$I]=[]),this._labels[$I].push($x)},$z.removeLabel=function($x){if($x){if(this._labels)for(var $I in this._labels)this._removeLabelFromLabelList(this._labels[$I],$x)}else this._labels=null},$z._removeLabelFromLabelList=function($x,$I){if($x)for(var $z=$x.length-1;0<=$z;$z--)$x[$z]==$I&&$x.splice($z,1)},$z.gotoAndStop=function($x){this.index="string"==typeof $x?this._getFrameByLabel($x):$x,this.stop()},$z._displayToIndex=function($x){},$z.clear=function(){this.stop(),this._labels=null},$F(0,$z,"interval",function(){return this._interval},function($x){this._interval!=$x&&(this._frameRateChanged=!0,this._interval=$x,this._isPlaying&&0<$x&&this.timerLoop($x,this,this._frameLoop,null,!0,!0))}),$F(0,$z,"isPlaying",function(){return this._isPlaying}),$F(0,$z,"index",function(){return this._index},function($x){if(this._index=$x,this._displayToIndex($x),this._labels&&this._labels[$x])for(var $I=this._labels[$x],$z=0,$k=$I.length;$z<$k;$z++)this.event("label",$I[$z])}),$F(0,$z,"count",function(){return this._count}),$x.WRAP_POSITIVE=0,$x.WRAP_REVERSE=1,$x.WRAP_PINGPONG=2,$x}($bx),$Nx=function($I){function $s(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$s.__super.call(this),this.overflow=$s.VISIBLE,this._style=new $Ix(this),this._style.wordWrap=!1}$N($s,"laya.display.Text",$I);var $x=$s.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$x._getBoundPointsM=function($x){void 0===$x&&($x=!1);var $I=$K.TEMP;return $I.setTo(0,0,this.width,this.height),$I._getBoundPoints()},$x.getGraphicBounds=function($x){void 0===$x&&($x=!1);var $I=$K.TEMP;return $I.setTo(0,0,this.width,this.height),$I},$x._getCSSStyle=function(){return this._style},$x.lang=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F){if($x=$s.langPacks&&$s.langPacks[$x]?$s.langPacks[$x]:$x,arguments.length<2)this._text=$x;else{for(var $b=0,$T=arguments.length;$b<$T;$b++)$x=$x.replace("{"+$b+"}",arguments[$b+1]);this._text=$x}},$x._isPassWordMode=function(){var $x=this._style.password;return"prompt"in this&&this.prompt==this._text&&($x=!1),$x},$x._getPassWordTxt=function($x){var $I;$I="";for(var $z=$x.length;0<$z;$z--)$I+="●";return $I},$x.renderText=function($x,$I){var $z=this.graphics;$z.clear(!0);var $k=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($W.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$W.context.font=$k;var $l=this.padding,$n=$l[3],$a="left",$$=this._lines,$w=this.leading+this._charSize.height,$i=this._currBitmapFont;$i&&($w=this.leading+$i.getMaxHeight());var $F=$l[0];if(!$i&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($a="right",$n=this._width-$l[1]):"center"==this.align&&($a="center",$n=.5*this._width+$l[3]-$l[1])),0<this._height){var $b=this._textHeight>this._height?"top":this.valign;"middle"===$b?$F=.5*(this._height-$I*$w)+$l[0]-$l[2]:"bottom"===$b&&($F=this._height-$I*$w-$l[2])}var $T=this._style;if($i&&$i.autoScaleSize)var $_=$i.fontSize/this.fontSize;if(this._clipPoint)if($z.save(),$i&&$i.autoScaleSize){var $R=0,$s=0;$R=this._width?this._width-$l[3]-$l[1]:this._textWidth,$s=this._height?this._height-$l[0]-$l[2]:this._textHeight,$R*=$_,$s*=$_,$z.clipRect($l[3],$l[0],$R,$s)}else $z.clipRect($l[3],$l[0],this._width?this._width-$l[3]-$l[1]:this._textWidth,this._height?this._height-$l[0]-$l[2]:this._textHeight);var $N=$T.password;"prompt"in this&&this.prompt==this._text&&($N=!1);for(var $D=0,$f=0,$m=Math.min(this._lines.length,$I+$x)||1,$y=$x;$y<$m;$y++){var $C,$P=$$[$y];if($N){var $v=$P.length;$P="";for(var $L=$v;0<$L;$L--)$P+="●"}if($D=$n-(this._clipPoint?this._clipPoint.x:0),$f=$F+$w*$y-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($a,$D,$f,$y),$i){var $K=this.width;$i.autoScaleSize&&($K=this.width*$_),$i.drawText($P,this,$D,$f,this.align,$K)}else $j.isWebGL?(this._words||(this._words=[]),($C=this._words.length>$y-$x?this._words[$y-$x]:new $G).setText($P)):$C=$P,$T.stroke?$z.fillBorderText($C,$D,$f,$k,this.color,$T.strokeColor,$T.stroke,$a):$z.fillText($C,$D,$f,$k,this.color,$a)}if($i&&$i.autoScaleSize){var $E=1/$_;this.scale($E,$E)}this._clipPoint&&$z.restore(),this._startX=$n,this._startY=$F},$x.drawUnderline=function($x,$I,$z,$k){var $l=this._lineWidths[$k];switch($x){case"center":$I-=$l/2;break;case"right":$I-=$l}$z+=this._charSize.height,this._graphics.drawLine($I,$z,$I+$l,$z,this.underlineColor||this.color,1)},$x.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$W.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $L(0,0)):this._clipPoint=null;var $x=this._lines.length;if(this.overflow!=$s.VISIBLE){var $I=this.overflow==$s.HIDDEN?Math.floor:Math.ceil;$x=Math.min($x,$I((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $z=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($z,$x),this.repaint()},$x.evalTextSize=function(){var $x,$I=NaN;$x=Math.max.apply(this,this._lineWidths),$I=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$x==this._textWidth&&$I==this._textHeight||(this._textWidth=$x,this._textHeight=$I,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$x.checkEnabledViewportOrNot=function(){return this.overflow==$s.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$x.changeText=function($x){this._text!==$x&&(this.lang($x+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$x.parseLines=function($x){var $I=this.wordWrap||this.overflow==$s.HIDDEN;if($I)var $z=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $k=$g.contextMeasureText($s._testWord);$j.isConchApp&&0===$k.width&&0===$k.height&&($k=$g.contextMeasureText("W")),this._charSize.width=$k.width,this._charSize.height=$k.height||this.fontSize}for(var $l=$x.replace(/\r\n/g,"\n").split("\n"),$n=0,$a=$l.length;$n<$a;$n++){var $$=$l[$n];$I?this.parseLine($$,$z):(this._lineWidths.push(this.getTextWidth($$)),this._lines.push($$))}},$x.parseLine=function($x,$I){$W.context;var $z,$k=this._lines,$l=0,$n=NaN,$a=NaN,$$=0;if(($n=this.getTextWidth($x))<=$I)return $k.push($x),void this._lineWidths.push($n);if($s.WordSplitStr&&0==new RegExp($s.WordSplitStr,"g").test($x))return $k.push($x),void this._lineWidths.push($n);$n=this._charSize.width,0==($l=Math.floor($I/$n))&&($l=1),$a=$n=this.getTextWidth($x.substring(0,$l));for(var $w=$l,$i=$x.length;$w<$i;$w++)if($I<($a+=$n=this.getTextWidth($x.charAt($w))))if(this.wordWrap){var $F=$x.substring($$,$w);if($s.WordSplitArr){var $b=-1,$T=0;for($T=0;$T<$s.WordSplitArr.length;$T++)$b=Math.max($b,$F.lastIndexOf($s.WordSplitArr[$T]));if(-1==$b){var $_=$x.substring($$,$x.length);for($T=0;$T<$s.WordSplitArr.length;$T++){var $R=$_.indexOf($s.WordSplitArr[$T]);$b=0<=$b?0<=$R?Math.min($b,$R):$b:$R}$F=-1==$b?($w=$x.length,$_):($w=$b+1+$$,$x.substring($$,$w))}else $w=$b+1+$$,$F=$x.substring($$,$w);$k.push($F),this._lineWidths.push(this.getTextWidth($k[$k.length-1])),$a=0,$$=$w}else{if($F.charCodeAt($F.length-1)<255?($z=/(?:\w|-)+$/.exec($F))&&($w=$z.index+$$,0==$z.index?$w+=$F.length:$F=$x.substring($$,$w)):$s.RightToLeft&&($z=/([\u0600-\u06FF])+$/.exec($F))&&($w=$z.index+$$,0==$z.index?$w+=$F.length:$F=$x.substring($$,$w)),$k.push($F),this._lineWidths.push($a-$n),!(($$=$w)+$l<$i)){$k.push($x.substring($$,$i)),this._lineWidths.push(this.getTextWidth($k[$k.length-1])),$$=-1;break}$w+=$l,$a=$n=this.getTextWidth($x.substring($$,$w)),$w--}}else if(this.overflow==$s.HIDDEN)return $k.push($x.substring(0,$w)),void this._lineWidths.push(this.getTextWidth($k[$k.length-1]));this.wordWrap&&-1!=$$&&$$<$i&&($k.push($x.substring($$,$i)),this._lineWidths.push(this.getTextWidth($k[$k.length-1])))},$x.getTextWidth=function($x){return this._currBitmapFont?this._currBitmapFont.getTextWidth($x):$g.contextMeasureText($x).width},$x.getWordWrapWidth=function(){var $x=this.padding,$I=NaN;return($I=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($I=this.wordWrap?100:$W.width),$I<=0&&($I=100),$I-$x[3]-$x[1]},$x.getCharPoint=function($x,$I){this._isChanged&&$v.timer.runCallLater(this,this.typeset);for(var $z=0,$k=this._lines,$l=0,$n=0,$a=$k.length;$n<$a;$n++){if($x<($z+=$k[$n].length)){var $$=$n;break}$l=$z}var $w=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$W.context.font=$w;var $i=this.getTextWidth(this._text.substring($l,$x));return($I||new $L).setTo(this._startX+$i-(this._clipPoint?this._clipPoint.x:0),this._startY+$$*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$F(0,$x,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($x){$x!=this._width&&($v.superSet($bx,this,"width",$x),this.isChanged=!0)}),$F(0,$x,"textWidth",function(){return this._isChanged&&$v.timer.runCallLater(this,this.typeset),this._textWidth}),$F(0,$x,"height",function(){return this._height?this._height:this.textHeight},function($x){$x!=this._height&&($v.superSet($bx,this,"height",$x),this.isChanged=!0)}),$F(0,$x,"textHeight",function(){return this._isChanged&&$v.timer.runCallLater(this,this.typeset),this._textHeight}),$F(0,$x,"padding",function(){return this._getCSSStyle().padding},function($x){this._getCSSStyle().padding=$x,this.isChanged=!0}),$F(0,$x,"bold",function(){return this._getCSSStyle().bold},function($x){this._getCSSStyle().bold=$x,this.isChanged=!0}),$F(0,$x,"text",function(){return this._text||""},function($x){this._text!==$x&&(this.lang($x+""),this.isChanged=!0,this.event("change"))}),$F(0,$x,"color",function(){return this._getCSSStyle().color},function($x){this._getCSSStyle().color!=$x&&(this._getCSSStyle().color=$x,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$F(0,$x,"font",function(){return this._getCSSStyle().fontFamily},function($x){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$s._bitmapFonts&&$s._bitmapFonts[$x]&&(this._currBitmapFont=$s._bitmapFonts[$x]),this._getCSSStyle().fontFamily=$x,this.isChanged=!0}),$F(0,$x,"fontSize",function(){return this._getCSSStyle().fontSize},function($x){this._getCSSStyle().fontSize=$x,this.isChanged=!0}),$F(0,$x,"italic",function(){return this._getCSSStyle().italic},function($x){this._getCSSStyle().italic=$x,this.isChanged=!0}),$F(0,$x,"align",function(){return this._getCSSStyle().align},function($x){this._getCSSStyle().align=$x,this.isChanged=!0}),$F(0,$x,"valign",function(){return this._getCSSStyle().valign},function($x){this._getCSSStyle().valign=$x,this.isChanged=!0}),$F(0,$x,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($x){this._getCSSStyle().wordWrap=$x,this.isChanged=!0}),$F(0,$x,"leading",function(){return this._getCSSStyle().leading},function($x){this._getCSSStyle().leading=$x,this.isChanged=!0}),$F(0,$x,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($x){this._getCSSStyle().backgroundColor=$x,this.isChanged=!0}),$F(0,$x,"borderColor",function(){return this._getCSSStyle().borderColor},function($x){this._getCSSStyle().borderColor=$x,this.isChanged=!0}),$F(0,$x,"stroke",function(){return this._getCSSStyle().stroke},function($x){this._getCSSStyle().stroke=$x,this.isChanged=!0}),$F(0,$x,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($x){this._getCSSStyle().strokeColor=$x,this.isChanged=!0}),$F(0,$x,"isChanged",null,function($x){this._isChanged!==$x&&(this._isChanged=$x)&&$v.timer.callLater(this,this.typeset)}),$F(0,$x,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($x){if(!(this.overflow!=$s.SCROLL||this.textWidth<this._width)&&this._clipPoint){$x=$x<this.padding[3]?this.padding[3]:$x;var $I=this._textWidth-this._width;$x=$I<$x?$I:$x;var $z=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$x,this.renderText(this._lastVisibleLineIndex,$z)}}),$F(0,$x,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($x){if(!(this.overflow!=$s.SCROLL||this.textHeight<this._height)&&this._clipPoint){$x=$x<this.padding[0]?this.padding[0]:$x;var $I=this._textHeight-this._height,$z=($x=$I<$x?$I:$x)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$z;var $k=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$x,this.renderText($z,$k)}}),$F(0,$x,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$F(0,$x,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$F(0,$x,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$F(0,$x,"underlineColor",function(){return this._underlineColor},function($x){this._underlineColor=$x,this._isChanged=!0,this.typeset()}),$s.registerBitmapFont=function($x,$I){$s._bitmapFonts||($s._bitmapFonts={}),$s._bitmapFonts[$x]=$I},$s.unregisterBitmapFont=function($x,$I){if(void 0===$I&&($I=!0),$s._bitmapFonts&&$s._bitmapFonts[$x]){var $z=$s._bitmapFonts[$x];$I&&$z.destroy(),delete $s._bitmapFonts[$x]}},$s.setTextRightToLeft=function(){var $x;($x=$W.canvas.source.style).display="none",$x.position="absolute",$x.direction="rtl",$j._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$W.document.body.appendChild($W.canvas.source)},$s.supportFont=function($x){$W.context.font="10px sans-serif";var $I=$g.contextMeasureText("abcji").width;$W.context.font="10px "+$x;var $z=$g.contextMeasureText("abcji").width;return console.log($I,$z),$I!==$z},$s._testWord="游",$s.langPacks=null,$s.VISIBLE="visible",$s.SCROLL="scroll",$s.HIDDEN="hidden",$s.CharacterCache=!0,$s.RightToLeft=!1,$s.WordSplitArr=null,$s.WordSplitStr=null,$s._bitmapFonts=null,$w($s,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$s}($bx),$Dx=function($T){function $a(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$a.__super.call(this),this.offset=new $L,this._canvasTransform=new $U,this._previousOrientation=$W.window.orientation;var $I=this;this.transform=$U.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0,this._lastStamp=0;var $x=$W.window,$z=this;$x.addEventListener("focus",function(){$I._isFocused=!0,$z.event("focus"),$z.event("focuschange")}),$x.addEventListener("blur",function(){$I._isFocused=!1,$z.event("blur"),$z.event("focuschange"),$z._isInputting()&&($Cx.inputElement.target.focus=!1)});var $k="visibilityState",$l="visibilitychange",$n=$x.document;void 0!==$n.hidden?($l="visibilitychange",$k="visibilityState"):void 0!==$n.mozHidden?($l="mozvisibilitychange",$k="mozVisibilityState"):void 0!==$n.msHidden?($l="msvisibilitychange",$k="msVisibilityState"):void 0!==$n.webkitHidden&&($l="webkitvisibilitychange",$k="webkitVisibilityState"),$x.document.addEventListener($l,function(){"hidden"==$W.document[$k]?$z._setStageVisible(!1):$z._setStageVisible(!0)}),$x.document.addEventListener("qbrowserVisibilityChange",function($x){$z._setStageVisible(!$x.hidden)}),$x.addEventListener("resize",function(){var $x=$W.window.orientation;null!=$x&&$x!=$I._previousOrientation&&$z._isInputting()&&($Cx.inputElement.target.focus=!1),$I._previousOrientation=$x,$z._isInputting()||$z._resetCanvas()}),$x.addEventListener("orientationchange",function($x){$z._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$W.onMobile&&this.on("mousedown",this,this._onmouseMove)}$N($a,"laya.display.Stage",$T);var $x=$a.prototype;return $x._setStageVisible=function($x){this._isVisibility!=$x&&(this._isVisibility=$x,this._isVisibility||this._isInputting()&&($Cx.inputElement.target.focus=!1),this.event("visibilitychange"))},$x._isInputting=function(){return $W.onMobile&&$Cx.isInputting},$x._changeCanvasSize=function(){this.setScreenSize($W.clientWidth*$W.pixelRatio,$W.clientHeight*$W.pixelRatio)},$x._resetCanvas=function(){if(this.screenAdaptationEnabled){var $x=$j._mainCanvas;$x.source.style;$x.size(1,1),$v.timer.once(100,this,this._changeCanvasSize)}},$x.setScreenSize=function($x,$I){var $z=!1;if("none"!==this._screenMode&&($z=($x/$I<1?"vertical":"horizontal")!==this._screenMode)){var $k=$I;$I=$x,$x=$k}this.canvasRotation=$z;var $l=$j._mainCanvas,$n=$l.source.style,$a=this._canvasTransform.identity(),$$=this._scaleMode,$w=$x/this.designWidth,$i=$I/this.designHeight,$F=this.designWidth,$b=this.designHeight,$T=$x,$_=$I,$R=$W.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$$){case"noscale":$w=$i=1,$T=this.designWidth,$_=this.designHeight;break;case"showall":$w=$i=Math.min($w,$i),$F=$T=Math.round(this.designWidth*$w),$b=$_=Math.round(this.designHeight*$i);break;case"noborder":$w=$i=Math.max($w,$i),$T=Math.round(this.designWidth*$w),$_=Math.round(this.designHeight*$i);break;case"full":$w=$i=1,this._width=$F=$x,this._height=$b=$I;break;case"fixedwidth":$i=$w,this._height=$b=Math.round($I/$w);break;case"fixedheight":$w=$i,this._width=$F=Math.round($x/$i);break;case"fixedauto":$x/$I<this.designWidth/this.designHeight?($i=$w,this._height=$b=Math.round($I/$w)):($w=$i,this._width=$F=Math.round($x/$i))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$F=$F+1&2147483646,$b=$b+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$w*=this.scaleX,$i*=this.scaleY,1===$w&&1===$i?this.transform.identity():(this.transform.a=this._formatData($w/($T/$F)),this.transform.d=this._formatData($i/($_/$b)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$l.size($F,$b),$Z.changeWebGLSize($F,$b),$a.scale($T/$F/$R,$_/$b/$R),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($x-$T)/$R:this.offset.x=.5*($x-$T)/$R,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($I-$_)/$R:this.offset.y=.5*($I-$_)/$R,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$a.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$z&&("horizontal"===this._screenMode?($a.rotate(Math.PI/2),$a.translate($I/$R,0),this.canvasDegree=90):($a.rotate(-Math.PI/2),$a.translate(0,$x/$R),this.canvasDegree=-90)),$a.a=this._formatData($a.a),$a.d=this._formatData($a.d),$a.tx=this._formatData($a.tx),$a.ty=this._formatData($a.ty),$n.transformOrigin=$n.webkitTransformOrigin=$n.msTransformOrigin=$n.mozTransformOrigin=$n.oTransformOrigin="0px 0px 0px",$n.transform=$n.webkitTransform=$n.msTransform=$n.mozTransform=$n.oTransform="matrix("+$a.toString()+")",$a.translate(parseInt($n.left)||0,parseInt($n.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$x._formatData=function($x){return Math.abs($x)<1e-6?0:Math.abs(1-$x)<.001?0<$x?1:-1:$x},$x.getMousePoint=function(){return $L.TEMP.setTo(this.mouseX,this.mouseY)},$x.repaint=function(){this._repaint=1},$x.parentRepaint=function(){},$x._loop=function($x){return this.render($j.context,0,0,$x),!0},$x._onmouseMove=function($x){this._mouseMoveTime=$W.now()},$x.getTimeFromFrameStart=function(){return $W.now()-this._frameStartTime},$x.render=function($x,$I,$z,$k){if(!(3!=$_.ENV&&0<$k&&$k-this._lastStamp<16)){if(this._lastStamp=$k,"sleep"===this._frameRate&&!$j.isConchApp){var $l=$W.now();if(!(200<=$l-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($p.loopCount++,$s.instance.runEvent(),$v.timer._update()));this._frameStartTime=$l}if(this._renderCount++,$j.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$W.now();var $n="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$a=this._renderCount%2==0;if($p.renderSlow=!$n,$n||$a||$j.isConchApp){var $$;$p.loopCount++,$s.instance.runEvent(),$v.timer._update(),$Z.update3DLoop();var $w=0,$i=0;if($j.isConchNode)for($w=0,$i=this._scenes.length;$w<$i;$w++)($$=this._scenes[$w])&&$$._updateSceneConch();else for($w=0,$i=this._scenes.length;$w<$i;$w++)($$=this._scenes[$w])&&$$._updateScene();if($j.isConchNode){var $F=$bx.CustomList;for($w=0,$i=$F.length;$w<$i;$w++){var $b=$F[$w];$b.customRender($b.customContext,0,0)}return}}$j.isConchNode||this.renderingEnabled&&($n||!$a||$j.isConchWebGL)&&($j.isWebGL?$j.WebGL.mainContext&&!$j.WebGL.mainContext.isContextLost()&&($x.clear(),$T.prototype.render.call(this,$x,$I,$z),$p._show&&$p._sp&&$p._sp.render($x,$I,$z),$Z.clear(this._bgColor),$Z.beginFlush(),$x.flush(),$Z.endFinish(),$M.instance&&$M.getInstance().endDispose()):($Z.clear(this._bgColor),$T.prototype.render.call(this,$x,$I,$z),$p._show&&$p._sp&&$p._sp.render($x,$I,$z)))}else this._renderCount%5==0&&($p.loopCount++,$s.instance.runEvent(),$v.timer._update())}},$x._requestFullscreen=function(){var $x=$W.document.documentElement;$x.requestFullscreen?$x.requestFullscreen():$x.mozRequestFullScreen?$x.mozRequestFullScreen():$x.webkitRequestFullscreen?$x.webkitRequestFullscreen():$x.msRequestFullscreen&&$x.msRequestFullscreen()},$x._fullScreenChanged=function(){$v.stage.event("fullscreenchange")},$x.exitFullscreen=function(){var $x=$W.document;$x.exitFullscreen?$x.exitFullscreen():$x.mozCancelFullScreen?$x.mozCancelFullScreen():$x.webkitExitFullscreen&&$x.webkitExitFullscreen()},$F(0,$x,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$F(0,$x,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$F(0,$x,"frameRate",function(){return this._frameRate},function($x){if(this._frameRate=$x,$j.isConchApp)switch(this._frameRate){case"slow":$W.window.conch&&$W.window.conchConfig.setSlowFrame&&$W.window.conchConfig.setSlowFrame(!0);break;case"fast":$W.window.conch&&$W.window.conchConfig.setSlowFrame&&$W.window.conchConfig.setSlowFrame(!1);break;case"mouse":$W.window.conch&&$W.window.conchConfig.setMouseFrame&&$W.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$W.window.conch&&$W.window.conchConfig.setLimitFPS&&$W.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$F(0,$x,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$F(0,$x,"width",$T.prototype._$get_width,function($x){this.designWidth=$x,$v.superSet($bx,this,"width",$x),$v.timer.callLater(this,this._changeCanvasSize)}),$F(0,$x,"alignH",function(){return this._alignH},function($x){this._alignH=$x,$v.timer.callLater(this,this._changeCanvasSize)}),$F(0,$x,"isFocused",function(){return this._isFocused}),$F(0,$x,"height",$T.prototype._$get_height,function($x){this.designHeight=$x,$v.superSet($bx,this,"height",$x),$v.timer.callLater(this,this._changeCanvasSize)}),$F(0,$x,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$U.create()},$T.prototype._$set_transform),$F(0,$x,"isVisibility",function(){return this._isVisibility}),$F(0,$x,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$F(0,$x,"scaleMode",function(){return this._scaleMode},function($x){this._scaleMode=$x,$v.timer.callLater(this,this._changeCanvasSize)}),$F(0,$x,"alignV",function(){return this._alignV},function($x){this._alignV=$x,$v.timer.callLater(this,this._changeCanvasSize)}),$F(0,$x,"bgColor",function(){return this._bgColor},function($x){this._bgColor=$x,this.conchModel&&this.conchModel.bgColor($x),$j.isWebGL&&($x?$a._wgColor=$h.create($x)._color:$W.onMiniGame||($a._wgColor=null)),$W.onLimixiu?$a._wgColor=$h.create($x)._color:$j.canvas.style.background=$x||"none"}),$F(0,$x,"mouseX",function(){return Math.round($s.instance.mouseX/this.clientScaleX)}),$F(0,$x,"mouseY",function(){return Math.round($s.instance.mouseY/this.clientScaleY)}),$F(0,$x,"screenMode",function(){return this._screenMode},function($x){this._screenMode=$x}),$F(0,$x,"visible",$T.prototype._$get_visible,function($x){this.visible!==$x&&($v.superSet($bx,this,"visible",$x),$j._mainCanvas.source.style.visibility=$x?"visible":"hidden")}),$F(0,$x,"fullScreenEnabled",null,function($x){var $I=$W.document,$z=$j.canvas;$x?($z.addEventListener("mousedown",this._requestFullscreen),$z.addEventListener("touchstart",this._requestFullscreen),$I.addEventListener("fullscreenchange",this._fullScreenChanged),$I.addEventListener("mozfullscreenchange",this._fullScreenChanged),$I.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$I.addEventListener("msfullscreenchange",this._fullScreenChanged)):($z.removeEventListener("mousedown",this._requestFullscreen),$z.removeEventListener("touchstart",this._requestFullscreen),$I.removeEventListener("fullscreenchange",this._fullScreenChanged),$I.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$I.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$I.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$a.SCALE_NOSCALE="noscale",$a.SCALE_EXACTFIT="exactfit",$a.SCALE_SHOWALL="showall",$a.SCALE_NOBORDER="noborder",$a.SCALE_FULL="full",$a.SCALE_FIXED_WIDTH="fixedwidth",$a.SCALE_FIXED_HEIGHT="fixedheight",$a.SCALE_FIXED_AUTO="fixedauto",$a.ALIGN_LEFT="left",$a.ALIGN_RIGHT="right",$a.ALIGN_CENTER="center",$a.ALIGN_TOP="top",$a.ALIGN_MIDDLE="middle",$a.ALIGN_BOTTOM="bottom",$a.SCREEN_NONE="none",$a.SCREEN_HORIZONTAL="horizontal",$a.SCREEN_VERTICAL="vertical",$a.FRAME_FAST="fast",$a.FRAME_SLOW="slow",$a.FRAME_MOUSE="mouse",$a.FRAME_SLEEP="sleep",$a.FRAME_MOUSE_THREDHOLD=2e3,$w($a,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$a}($bx),$fx=(function($x){function $I(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$I.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$N($I,"laya.media.SoundNode",$bx);var $z=$I.prototype;$z._onParentChange=function(){this.target=this.parent},$z.play=function($x,$I){void 0===$x&&($x=1),isNaN($x)&&($x=1),this.url&&(this.stop(),this._channel=$S.playSound(this.url,$x,null,$I))},$z.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$z._setPlayAction=function($x,$I,$z,$k){void 0===$k&&($k=!0),this[$z]&&$x&&($k?$x.on($I,this,this[$z]):$x.off($I,this,this[$z]))},$z._setPlayActions=function($x,$I,$z,$k){if(void 0===$k&&($k=!0),$x&&$I){var $l,$n=$I.split(","),$a=0;for($l=$n.length,$a=0;$a<$l;$a++)this._setPlayAction($x,$n[$a],$z,$k)}},$F(0,$z,"playEvent",null,function($x){(this._playEvents=$x)&&this._tar&&this._setPlayActions(this._tar,$x,"play")}),$F(0,$z,"target",null,function($x){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$x,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$F(0,$z,"stopEvent",null,function($x){(this._stopEvents=$x)&&this._tar&&this._setPlayActions(this._tar,$x,"stop")})}(),function($x){function $I(){this._src=null,this._onload=null,this._onerror=null,$I.__super.call(this)}$N($I,"laya.resource.FileBitmap",$Rx);var $z=$I.prototype;return $F(0,$z,"src",function(){return this._src},function($x){this._src=$x}),$F(0,$z,"onload",null,function($x){}),$F(0,$z,"onerror",null,function($x){}),$I}()),$mx=function($x){function $z($x,$I){this._is2D=!1,$z.__super.call(this);var $k=this;if(this._source=this,"2D"===$x||"AUTO"===$x&&!$j.isWebGL){this._is2D=!0,this._source=$I||$W.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $l=this;$l.getContext=function($x,$I){if($k._ctx)return $k._ctx;var $z=$k._ctx=$k._source.getContext($x,$I);return $z&&($z._canvas=$l,$j.isFlash||$W.onLimixiu||($z.size=function($x,$I){})),$z}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$N($z,"laya.resource.HTMLCanvas",$Rx);var $I=$z.prototype;return $I.clear=function(){this._ctx&&this._ctx.clear()},$I.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$I.release=function(){},$I._setContext=function($x){this._ctx=$x},$I.getContext=function($x,$I){return this._ctx?this._ctx:this._ctx=$z._createContext(this)},$I.getMemSize=function(){return 0},$I.size=function($x,$I){(this._w!=$x||this._h!=$I||this._source&&(this._source.width!=$x||this._source.height!=$I))&&(this._w=$x,this._h=$I,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($x,$I),this._source&&(this._source.height=$I,this._source.width=$x))},$I.getCanvas=function(){return this._source},$I.toBase64=function($x,$I,$z){if(this._source)if($j.isConchApp&&this._source.toBase64)this._source.toBase64($x,$I,$z);else{var $k=this._source.toDataURL($x,$I);$z.call(this,$k)}},$F(0,$I,"context",function(){return this._ctx}),$F(0,$I,"asBitmap",null,function($x){}),$z.create=function($x,$I){return new $z($x,$I)},$z.TYPE2D="2D",$z.TYPE3D="3D",$z.TYPEAUTO="AUTO",$z._createContext=null,$z}(),$yx=(function($x){function $w($x,$I,$z,$k,$l,$n,$a,$$){throw $w.__super.call(this),new Error("不允许new！")}$N($w,"laya.resource.HTMLSubImage",$Rx),$w.create=function($x,$I,$z,$k,$l,$n,$a,$$){return void 0===$$&&($$=!1),new $w($x,$I,$z,$k,$l,$n,$a,$$)}}(),function($x){function $b(){this._frames=null,this._url=null,$b.__super.call(this),this._setControlNode(this)}$N($b,"laya.display.Animation",$x);var $I=$b.prototype;$I.destroy=function($x){void 0===$x&&($x=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$x),this._frames=null,this._labels=null},$I.play=function($x,$I,$z,$k){void 0===$x&&($x=0),void 0===$I&&($I=!0),void 0===$z&&($z=""),void 0===$k&&($k=!0),$z&&this._setFramesFromCache($z,$k),this._isPlaying=!0,this.index="string"==typeof $x?this._getFrameByLabel($x):$x,this.loop=$I,this._actionName=$z,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$I._setFramesFromCache=function($x,$I){var $z;return void 0===$I&&($I=!1),this._url&&($x=this._url+"#"+$x),$x&&$b.framesMap[$x]?(($z=$b.framesMap[$x])instanceof Array?(this._frames=$b.framesMap[$x],this._count=this._frames.length):($z.nodeRoot&&($b.framesMap[$x]=this._parseGraphicAnimationByData($z),$z=$b.framesMap[$x]),this._frames=$z.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$z.interval),this._labels=this._copyLabels($z.labels)),!0):($I&&console.log("ani not found:",$x),!1)},$I._copyLabels=function($x){if(!$x)return null;var $I,$z;for($z in $I={},$x)$I[$z]=$g.copyArray([],$x[$z]);return $I},$I._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$x.prototype._frameLoop.call(this)},$I._displayToIndex=function($x){this._frames&&(this.graphics=this._frames[$x])},$I.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$I.loadImages=function($x,$I){return void 0===$I&&($I=""),this._url="",this._setFramesFromCache($I)||(this.frames=$b.framesMap[$I]?$b.framesMap[$I]:$b.createFrames($x,$I)),this},$I.loadAtlas=function($I,$z,$k){void 0===$k&&($k=""),this._url="";var $l=this;function $x($x){$I===$x&&($l.frames=$b.framesMap[$k]?$b.framesMap[$k]:$b.createFrames($I,$k),$z&&$z.run())}return $l._setFramesFromCache($k)||($$x.getAtlas($I)?$x($I):$v.loader.load($I,$f.create(null,$x,[$I]),null,"atlas")),this},$I.loadAnimation=function($x,$I,$z){this._url=$x;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$I&&$I.run()):!$z||$$x.getAtlas($z)?this._loadAnimationData($x,$I,$z):$v.loader.load($z,$f.create(this,this._loadAnimationData,[$x,$I,$z]),null,"atlas"),this},$I._loadAnimationData=function($$,$w,$x){var $i=this;if(!$x||$$x.getAtlas($x)){var $F=this;$$x.getRes($$)?$I($$):$v.loader.load($$,$f.create(null,$I,[$$]),null,"json"),$$x.clearRes($$)}else console.warn("atlas load fail:"+$x);function $I($x){if($$x.getRes($x)&&$$===$x){var $I;if($b.framesMap[$$+"#"])$F._setFramesFromCache($i._actionName,!0),$i.index=0,$i._checkResumePlaying();else{var $z=$F._parseGraphicAnimation($$x.getRes($$));if(!$z)return;var $k,$l=$z.animationList,$n=0,$a=$l.length;for($n=0;$n<$a;$n++)$I=$l[$n],$b.framesMap[$$+"#"+$I.name]=$I,$k||($k=$I);$k&&($b.framesMap[$$+"#"]=$k,$F._setFramesFromCache($i._actionName,!0),$i.index=0),$i._checkResumePlaying()}$w&&$w.run()}}},$I._parseGraphicAnimation=function($x){return $vx.parseAnimationData($x)},$I._parseGraphicAnimationByData=function($x){return $vx.parseAnimationByData($x)},$F(0,$I,"frames",function(){return this._frames},function($x){(this._frames=$x)&&(this._count=$x.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$F(0,$I,"autoPlay",null,function($x){$x?this.play():this.stop()}),$F(0,$I,"source",null,function($x){-1<$x.indexOf(".ani")?this.loadAnimation($x):-1<$x.indexOf(".json")||-1<$x.indexOf("als")||-1<$x.indexOf("atlas")?this.loadAtlas($x):this.loadImages($x.split(","))}),$F(0,$I,"autoAnimation",null,function($x){this.play(0,!0,$x,!1)}),$b.createFrames=function($x,$I){var $z,$k,$l=0,$n=0;if("string"==typeof $x){var $a=$$x.getAtlas($x);if($a&&$a.length)for($z=[],$l=0,$n=$a.length;$l<$n;$l++)($k=new $Z.createGraphics).drawTexture($$x.getRes($a[$l]),0,0),$z.push($k)}else if($x instanceof Array)for($z=[],$l=0,$n=$x.length;$l<$n;$l++)($k=new $Z.createGraphics).loadImage($x[$l],0,0),$z.push($k);return $I&&($b.framesMap[$I]=$z),$z},$b.clearCache=function($x){var $I,$z=$b.framesMap,$k=$x+"#";for($I in $z)$I!==$x&&0!=$I.indexOf($k)||delete $b.framesMap[$I]},$b.framesMap={}}($sx),function($x){function $n(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$n.__super.call(this),null==$n._sortIndexFun&&($n._sortIndexFun=$P.sortByKey("index",!1,!0))}$N($n,"laya.display.FrameAnimation",$x);var $I=$n.prototype;return $I._setUp=function($x,$I){this._labels=null,this._animationNewFrames=null,this._targetDic=$x,this._animationData=$I,this.interval=1e3/$I.frameRate,$I.parsed?(this._count=$I.count,this._labels=$I.labels,this._animationNewFrames=$I.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$I.parsed=!0,$I.labels=this._labels,$I.count=this._count,$I.animationNewFrames=this._animationNewFrames},$I.clear=function(){$x.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$I._displayToIndex=function($x){if(this._animationData){$x<0&&($x=0),$x>this._count&&($x=this._count);var $I=this._animationData.nodes,$z=0,$k=$I.length;for($z=0;$z<$k;$z++)this._displayNodeToFrame($I[$z],$x)}},$I._displayNodeToFrame=function($x,$I,$z){$z||($z=this._targetDic);var $k=$z[$x.target];if($k){var $l,$n,$a,$$=$x.frames,$w=$x.keys,$i=0,$F=$w.length;for($i=0;$i<$F;$i++)$a=($n=$$[$l=$w[$i]]).length>$I?$n[$I]:$n[$n.length-1],$k[$l]=$a}},$I._calculateDatas=function(){if(this._animationData){var $x,$I=this._animationData.nodes,$z=0,$k=$I.length;for($z=this._count=0;$z<$k;$z++)$x=$I[$z],this._calculateNodeKeyFrames($x);this._count+=1}},$I._calculateNodeKeyFrames=function($x){var $I,$z,$k=$x.keyframes,$l=$x.target;for($I in $x.frames||($x.frames={}),$x.keys?$x.keys.length=0:$x.keys=[],$x.initValues||($x.initValues={}),$k)$z=$k[$I],$x.frames[$I]||($x.frames[$I]=[]),this._targetDic&&this._targetDic[$l]&&($x.initValues[$I]=this._targetDic[$l][$I]),$z.sort($n._sortIndexFun),$x.keys.push($I),this._calculateNodePropFrames($z,$x.frames[$I],$I,$l)},$I.resetToInitState=function(){if(this._targetDic&&this._animationData){var $x,$I,$z=this._animationData.nodes,$k=0,$l=$z.length;for($k=0;$k<$l;$k++)if($I=($x=$z[$k]).initValues){var $n,$a=this._targetDic[$x.target];if($a)for($n in $I)$a[$n]=$I[$n]}}},$I._calculateNodePropFrames=function($x,$I,$z,$k){var $l=0,$n=$x.length-1;if(0<$n){for($I.length=$x[$n].index+1,$l=0;$l<$n;$l++)this._dealKeyFrame($x[$l]),this._calculateFrameValues($x[$l],$x[$l+1],$I);this._dealKeyFrame($x[$l])}0==$n&&($I[$x[0].index]=$x[0].value,this._animationNewFrames&&(this._animationNewFrames[$x[0].index]=!0))},$I._dealKeyFrame=function($x){$x.label&&""!=$x.label&&this.addLabel($x.label,$x.index)},$I._calculateFrameValues=function($x,$I,$z){var $k,$l=0,$n=$x.index,$a=$I.index,$$=$x.value,$w=$I.value-$x.value,$i=$a-$n;if($a>this._count&&(this._count=$a),$x.tween)for(null==($k=$e[$x.tweenMethod])&&($k=$e.linearNone),$l=$n;$l<$a;$l++)$z[$l]=$k($l-$n,$$,$w,$i),this._animationNewFrames&&(this._animationNewFrames[$l]=!0);else for($l=$n;$l<$a;$l++)$z[$l]=$$;this._animationNewFrames&&(this._animationNewFrames[$x.index]=!0,this._animationNewFrames[$I.index]=!0),$z[$I.index]=$I.value},$n._sortIndexFun=null,$n}($sx)),$Cx=function($I){function $n(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$n.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$Nx.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$N($n,"laya.display.Input",$I);var $x=$n.prototype;return $x.setSelection=function($x,$I){this.focus=!0,laya.display.Input.inputElement.selectionStart=$x,laya.display.Input.inputElement.selectionEnd=$I},$x._onUnDisplay=function($x){this.focus=!1},$x._onMouseDown=function($x){this.focus=!0},$x._syncInputTransform=function(){var $x=this.nativeInput,$I=$g.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$z=this._width-this.padding[1]-this.padding[3],$k=this._height-this.padding[0]-this.padding[2];if($j.isConchApp)$x.setScale($I.scaleX,$I.scaleY),$x.setSize($z,$k),$x.setPos($I.x,$I.y);else{var $l=1===$W.scroll_input_top;$l&&$x.style.backgroundColor&&($x.style.backgroundColor=null),$n.inputContainer.style.transform=$n.inputContainer.style.webkitTransform="scale("+$I.scaleX+","+$I.scaleY+") rotate("+$v.stage.canvasDegree+"deg)",$x.style.width=$l?"720px":$z+"px",$x.style.height=$k+"px",$n.inputContainer.style.left=$l?"0px":$I.x+"px",$n.inputContainer.style.top=$l?"0px":$I.y+"px"}},$x.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$x._setInputMethod=function(){$n.input.parentElement&&$n.inputContainer.removeChild($n.input),$n.area.parentElement&&$n.inputContainer.removeChild($n.area),$n.inputElement=this._multiline?$n.area:$n.input,$n.inputContainer.appendChild($n.inputElement),$Nx.RightToLeft&&($n.inputElement.style.direction="rtl")},$x._focusIn=function(){laya.display.Input.isInputting=!0;var $x=this.nativeInput;this._focus=!0;var $I=$x.style;$I.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$x.readOnly=!this._editable,$j.isConchApp&&($x.setType(this._type),$x.setForbidEdit(!this._editable)),$x.maxLength=this._maxChars;this.padding;if($x.type=this._type,$x.value=this._content,$x.placeholder=this._prompt,$v.stage.off("keydown",this,this._onKeyDown),$v.stage.on("keydown",this,this._onKeyDown),($v.stage.focus=this).event("focus"),$W.onPC&&$x.focus(),!$W.onMiniGame){this._text;this._text=null}this.typeset(),$x.setColor(this._originColor),$x.setFontSize(this.fontSize),$x.setFontFace($W.onIPhone&&$Nx._fontFamilyMap[this.font]||this.font),$j.isConchApp&&$x.setMultiAble&&$x.setMultiAble(this._multiline),$I.lineHeight=this.leading+this.fontSize+"px",$I.fontStyle=this.italic?"italic":"normal",$I.fontWeight=this.bold?"bold":"normal",$I.textAlign=this.align,$I.padding="0 0",this._syncInputTransform(),!$j.isConchApp&&$W.onPC&&$v.timer.frameLoop(1,this,this._syncInputTransform)},$x._setPromptColor=function(){($n.promptStyleDOM=$W.getElementById("promptStyle"))||(($n.promptStyleDOM=$W.createElement("style")).setAttribute("id","promptStyle"),$W.document.head.appendChild($n.promptStyleDOM)),$n.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$x._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($v.superSet($Nx,this,"text",this._content),$v.superSet($Nx,this,"color",this._originColor)):($v.superSet($Nx,this,"text",this._prompt),$v.superSet($Nx,this,"color",this._promptColor)),$v.stage.off("keydown",this,this._onKeyDown),$v.stage.focus=null,this.event("blur"),$j.isConchApp&&this.nativeInput.blur(),$W.onPC&&$v.timer.clear(this,this._syncInputTransform)},$x._onKeyDown=function($x){13===$x.keyCode&&($W.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$x.changeText=function($x){this._content=$x,this._focus?(this.nativeInput.value=$x||"",this.event("change")):$I.prototype.changeText.call(this,$x)},$F(0,$x,"color",$I.prototype._$get_color,function($x){this._focus&&this.nativeInput.setColor($x),$v.superSet($Nx,this,"color",this._content?$x:this._promptColor),this._originColor=$x}),$F(0,$x,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($x){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$F(0,$x,"multiline",function(){return this._multiline},function($x){this._multiline=$x,this.valign=$x?"top":"middle"}),$F(0,$x,"maxChars",function(){return this._maxChars},function($x){$x<=0&&($x=1e5),this._maxChars=$x}),$F(0,$x,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($x){$v.superSet($Nx,this,"color",this._originColor),$x+="",this._focus?(this.nativeInput.value=$x||"",this.event("change")):(this._multiline||($x=$x.replace(/\r?\n/g,"")),(this._content=$x)?$v.superSet($Nx,this,"text",$x):($v.superSet($Nx,this,"text",this._prompt),$v.superSet($Nx,this,"color",this.promptColor)))}),$F(0,$x,"nativeInput",function(){return this._multiline?$n.area:$n.input}),$F(0,$x,"prompt",function(){return this._prompt},function($x){!this._text&&$x&&$v.superSet($Nx,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$v.superSet($Nx,this,"text",this._text==this._prompt?$x:this._text):$v.superSet($Nx,this,"text",$x),this._prompt=$Nx.langPacks&&$Nx.langPacks[$x]?$Nx.langPacks[$x]:$x}),$F(0,$x,"focus",function(){return this._focus},function($x){var $I=this.nativeInput;this._focus!==$x&&($x?($I.target?$I.target._focusOut():this._setInputMethod(),($I.target=this)._focusIn()):($I.target=null,this._focusOut(),$W.document.body.scrollTop=0,$I.blur(),$j.isConchApp?$I.setPos(-1e4,-1e4):$n.inputContainer.contains($I)&&$n.inputContainer.removeChild($I)))}),$F(0,$x,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($x){$x?(-1<($x="[^"+$x+"]").indexOf("^^")&&($x=$x.replace("^^","")),this._restrictPattern=new RegExp($x,"g")):this._restrictPattern=null}),$F(0,$x,"editable",function(){return this._editable},function($x){this._editable=$x,$j.isConchApp&&$n.input.setForbidEdit(!$x)}),$F(0,$x,"promptColor",function(){return this._promptColor},function($x){this._promptColor=$x,this._content||$v.superSet($Nx,this,"color",$x)}),$F(0,$x,"type",function(){return this._type},function($x){this._getCSSStyle().password="password"==$x,this._type=$x,$j.isConchApp&&this.nativeInput.setType($x)}),$F(0,$x,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($x){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$F(0,$x,"asPassword",function(){return this._getCSSStyle().password},function($x){this._getCSSStyle().password=$x,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$n.__init__=function(){$n._createInputElement(),$W.onMobile&&$j.canvas.addEventListener($n.IOS_IFRAME?$W.onMiniGame?"touchend":"click":"touchend",$n._popupInputMethod)},$n._popupInputMethod=function($x){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$n._createInputElement=function(){$n._initInput($n.area=$W.createElement("textarea")),$n._initInput($n.input=$W.createElement("input")),($n.inputContainer=$W.createElement("div")).style.position="absolute",$n.inputContainer.style.zIndex=1e5,$W.container.appendChild($n.inputContainer),$n.inputContainer.setPos=function($x,$I){$n.inputContainer.style.left=$x+"px",$n.inputContainer.style.top=$I+"px"}},$n._initInput=function($I){var $x=$I.style;$x.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$x.resize="none",$x.backgroundColor="transparent",$x.border="none",$x.outline="none",$x.zIndex=1,$I.addEventListener("input",$n._processInputting),$I.addEventListener("mousemove",$n._stopEvent),$I.addEventListener("mousedown",$n._stopEvent),$I.addEventListener("touchmove",$n._stopEvent),$I.setFontFace=function($x){$I.style.fontFamily=$x},$j.isConchApp||($I.setColor=function($x){$I.style.color=$x},$I.setFontSize=function($x){$I.style.fontSize=$x+"px"})},$n._processInputting=function($x){var $I=laya.display.Input.inputElement.target;if($I){var $z=laya.display.Input.inputElement.value;$I._restrictPattern&&($z=$z.replace(/\u2006|\x27/g,""),$I._restrictPattern.test($z)&&($z=$z.replace($I._restrictPattern,""),laya.display.Input.inputElement.value=$z)),$I._text=$z,$I.event("input")}},$n._stopEvent=function($x){"touchmove"==$x.type&&$x.preventDefault(),$x.stopPropagation&&$x.stopPropagation()},$n.TYPE_TEXT="text",$n.TYPE_PASSWORD="password",$n.TYPE_EMAIL="email",$n.TYPE_URL="url",$n.TYPE_NUMBER="number",$n.TYPE_RANGE="range",$n.TYPE_DATE="date",$n.TYPE_MONTH="month",$n.TYPE_WEEK="week",$n.TYPE_TIME="time",$n.TYPE_DATE_TIME="datetime",$n.TYPE_DATE_TIME_LOCAL="datetime-local",$n.TYPE_SEARCH="search",$n.input=null,$n.area=null,$n.inputElement=null,$n.inputContainer=null,$n.confirmButton=null,$n.promptStyleDOM=null,$n.inputHeight=45,$n.isInputting=!1,$n.stageMatrix=null,$w($n,["IOS_IFRAME",function(){return this.IOS_IFRAME=$W.onIOS&&$W.window.top!=$W.window.self}]),$n}($Nx),$Px=function($x){function $z($x,$I){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$z.__super.call(this),$x&&this._init_($x,$I)}$N($z,"laya.resource.HTMLImage",$fx);var $I=$z.prototype;return $I._init_=function($x,$I){this._src=$x,this._source=new $W.window.Image,$I&&($I.onload&&(this.onload=$I.onload),$I.onerror&&(this.onerror=$I.onerror),$I.onCreate&&$I.onCreate(this)),0!=$x.indexOf("data:image")&&(this._source.crossOrigin=""),$x&&(this._source.src=$x)},$I.recreateResource=function(){var $x=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $I=this;this._source=new $W.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($I._needReleaseAgain)return $I._needReleaseAgain=!1,$I._source.onload=null,void($I._source=null);$I._source.onload=null,$I.memorySize=$x._w*$x._h*4,$I._recreateLock=!1,$I.completeCreate()},this._source.src=this._src}},$I.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$I.onresize=function(){this._w=this._source.width,this._h=this._source.height},$F(0,$I,"onload",null,function($x){var $I=this;this._onload=$x,this._source&&(this._source.onload=null!=this._onload?function(){$I.onresize(),$I._onload()}:null)}),$F(0,$I,"onerror",null,function($x){var $I=this;this._onerror=$x,this._source&&(this._source.onerror=null!=this._onerror?function(){$I._onerror()}:null)}),$F(0,$I,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($x){this._enableMerageInAtlas=$x,$j.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$x)}),$z.create=function($x,$I){return new $z($x,$I)},$z}(),$vx=(function($n){function $x(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$x.__super.call(this)}$N($x,"laya.display.EffectAnimation",$n);var $I=$x.prototype;$I._onOtherBegin=function($x){$x!=this&&this.stop()},$I.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$I._onPlayAction=function(){this.play(0,!1)},$I.play=function($x,$I,$z,$k){void 0===$x&&($x=0),void 0===$I&&($I=!0),void 0===$z&&($z=""),void 0===$k&&($k=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$x,$I,$z,$k))},$I._recordInitData=function(){if(this._aniKeys){var $x,$I,$z=0;for($x=this._aniKeys.length,$z=0;$z<$x;$z++)$I=this._aniKeys[$z],this._initData[$I]=this._target[$I]}},$I._displayToIndex=function($x){if(this._animationData){$x<0&&($x=0),$x>this._count&&($x=this._count);var $I=this._animationData.nodes,$z=0,$k=$I.length;for($k=1<$k?1:$k,$z=0;$z<$k;$z++)this._displayNodeToFrame($I[$z],$x)}},$I._displayNodeToFrame=function($x,$I,$z){if(this._target){var $k;$k=this._target;var $l,$n,$a,$$,$w=$x.frames,$i=$x.keys,$F=0,$b=$i.length;$$=$x.secondFrames;var $T,$_,$R,$s,$N=0;for($F=0;$F<$b;$F++)$n=$w[$l=$i[$F]],$a=-1==($N=$$[$l])?this._initData[$l]:$I<$N?($R=($_=$x.keyframes[$l])[0]).tween?(null==($T=$e[$R.tweenMethod])&&($T=$e.linearNone),$s=$_[1],$T($I,this._initData[$l],$s.value-this._initData[$l],$s.index)):this._initData[$l]:$n.length>$I?$n[$I]:$n[$n.length-1],$k[$l]=$a}},$I._calculateNodeKeyFrames=function($x){$n.prototype._calculateNodeKeyFrames.call(this,$x);var $I,$z,$k,$l=$x.keyframes;$x.target;for($I in $k={},$x.secondFrames=$k,$l)($z=$l[$I]).length<=1?$k[$I]=-1:$k[$I]=$z[1].index},$F(0,$I,"target",function(){return this._target},function($x){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$x,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$F(0,$I,"playEvent",null,function($x){(this._playEvents=$x)&&this.addEvent()}),$F(0,$I,"effectData",null,function($x){var $I;$x&&(($I=$x.animations)&&$I[0]&&(this._setUp({},$I[0]),$I[0].nodes&&$I[0].nodes[0]&&(this._aniKeys=$I[0].nodes[0].keys)))}),$F(0,$I,"effectClass",null,function($x){var $I,$z;(this._effectClass=$J.getClass($x),this._effectClass)&&(($I=this._effectClass.uiView)&&($z=$I.animations)&&$z[0]&&(this._setUp({},$z[0]),$z[0].nodes&&$z[0].nodes[0]&&(this._aniKeys=$z[0].nodes[0].keys)))}),$x.EffectAnimationBegin="effectanimationbegin"}($yx),function($I){var $O;function $S(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$S.__super.call(this)}$N($S,"laya.utils.GraphicAnimation",$I);var $x=$S.prototype;return $x._parseNodeList=function($x){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$x.compId]=$x.props,$x.compId&&this._nodeList.push($x.compId);var $I=$x.child;if($I){var $z=0,$k=$I.length;for($z=0;$z<$k;$z++)this._parseNodeList($I[$z])}},$x._calGraphicData=function($x){var $I;if(this._setUp(null,$x),this._createGraphicData(),this._nodeIDAniDic)for($I in this._nodeIDAniDic)this._nodeIDAniDic[$I]=null},$x._createGraphicData=function(){var $x,$I=[],$z=0,$k=this.count,$l=this._animationNewFrames;for($l||($l=[]),$z=0;$z<$k;$z++)!$l[$z]&&$x||($x=this._createFrameGraphic($z)),$I.push($x);this._gList=$I},$x._createFrameGraphic=function($x){var $I=$Z.createGraphics();return $S._rootMatrix||($S._rootMatrix=new $U),this._updateNodeGraphic(this._rootNode,$x,$S._rootMatrix,$I),$I},$x._updateNodeGraphic=function($x,$I,$z,$k,$l){var $n;void 0===$l&&($l=1);var $a,$$,$w,$i=($n=this._nodeGDic[$x.compId]=this._getNodeGraphicData($x.compId,$I,this._nodeGDic[$x.compId])).alpha*$l;if(!($i<.01)&&($n.resultTransform||($n.resultTransform=$U.create()),$a=$n.resultTransform,$U.mul($n.transform,$z,$a),$n.skin&&($$=this._getTextureByUrl($n.skin))&&($a._checkTransform()?($k.drawTexture($$,0,0,$n.width,$n.height,$a,$i),$n.resultTransform=null):$k.drawTexture($$,$a.tx,$a.ty,$n.width,$n.height,null,$i)),$w=$x.child)){var $F,$b=0;for($F=$w.length,$b=0;$b<$F;$b++)this._updateNodeGraphic($w[$b],$I,$a,$k,$i)}},$x._updateNoChilds=function($x,$I){if($x.skin){var $z=this._getTextureByUrl($x.skin);if($z){var $k=$x.transform;$k._checkTransform();!$k.bTransform?$I.drawTexture($z,$k.tx,$k.ty,$x.width,$x.height,null,$x.alpha):$I.drawTexture($z,0,0,$x.width,$x.height,$k.clone(),$x.alpha)}}},$x._updateNodeGraphic2=function($x,$I,$z){var $k;if($k=this._nodeGDic[$x.compId]=this._getNodeGraphicData($x.compId,$I,this._nodeGDic[$x.compId]),$x.child){var $l=$k.transform;$l._checkTransform();var $n,$a;$a=($n=!$l.bTransform)&&(0!=$l.tx||0!=$l.ty);var $$,$w,$i;if(($$=$l.bTransform||1!=$k.alpha)&&$z.save(),1!=$k.alpha&&$z.alpha($k.alpha),$n?$a&&$z.translate($l.tx,$l.ty):$z.transform($l.clone()),$w=$x.child,$k.skin&&($i=this._getTextureByUrl($k.skin))&&$z.drawTexture($i,0,0,$k.width,$k.height),$w){var $F,$b=0;for($F=$w.length,$b=0;$b<$F;$b++)this._updateNodeGraphic2($w[$b],$I,$z)}$$?$z.restore():$n?$a&&$z.translate(-$l.tx,-$l.ty):$z.transform($l.clone().invert())}else this._updateNoChilds($k,$z)},$x._calculateNodeKeyFrames=function($x){$I.prototype._calculateNodeKeyFrames.call(this,$x),this._nodeIDAniDic[$x.target]=$x},$x.getNodeDataByID=function($x){return this._nodeIDAniDic[$x]},$x._getParams=function($x,$I,$z,$k){var $l=$S._temParam;$l.length=$I.length;var $n=0,$a=$I.length;for($n=0;$n<$a;$n++)$l[$n]=this._getObjVar($x,$I[$n][0],$z,$I[$n][1],$k);return $l},$x._getObjVar=function($x,$I,$z,$k,$l){if($x.hasOwnProperty($I)){var $n=$x[$I];if($z>=$n.length&&($z=$n.length-1),null!=$x[$I][$z])return $x[$I][$z]}return $l.hasOwnProperty($I)?$l[$I]:$k},$x._getNodeGraphicData=function($x,$I,$z){$z||($z=$O.create()),$z.transform?$z.transform.identity():$z.transform=$U.create();var $k=this.getNodeDataByID($x);if(!$k)return $z;var $l,$n,$a=$k.frames,$$=this._getParams($a,$S._drawTextureCmd,$I,this._nodeDefaultProps[$x]),$w=$$[0],$i=NaN,$F=NaN,$b=$$[5],$T=$$[6],$_=$$[13],$R=$$[14],$s=$$[7],$N=$$[8],$D=$$[9],$f=$$[11],$m=$$[12];$i=$$[3],$F=$$[4],0!=$i&&0!=$F||($w=null),-1==$i&&($i=0),-1==$F&&($F=0),$z.skin=$w,$z.width=$i,$z.height=$F,$w&&(($l=this._getTextureByUrl($w))?($i||($i=$l.sourceWidth),$F||($F=$l.sourceHeight)):console.warn("lost skin:",$w,",you may load pics first")),$z.alpha=$$[10],$n=$z.transform,0!=$_&&($b=$_*$i),0!=$R&&($T=$R*$F),0==$b&&0==$T||$n.translate(-$b,-$T);var $y=null;if($D||1!==$s||1!==$N||$f||$m){($y=$S._tempMt).identity(),$y.bTransform=!0;var $C=.0174532922222222*($D-$f),$P=.0174532922222222*($D+$m),$v=Math.cos($P),$L=Math.sin($P),$K=Math.sin($C),$E=Math.cos($C);$y.a=$s*$v,$y.b=$s*$L,$y.c=-$N*$K,$y.d=$N*$E,$y.tx=$y.ty=0}return $y&&($n=$U.mul($n,$y,$n)),$n.translate($$[1],$$[2]),$z},$x._getTextureByUrl=function($x){return $$x.getRes($x)},$x.setAniData=function($x,$I){if($x.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$x,this._parseNodeList($x);var $z,$k={},$l=[],$n=$x.animations,$a=0,$$=$n.length;for($a=0;$a<$$;$a++)if($z=$n[$a],this._labels=null,(!$I||$I==$z.name)&&$z){try{this._calGraphicData($z)}catch($x){console.warn("parse animation fail:"+$z.name+",empty animation created"),this._gList=[]}var $w={};$w.interval=1e3/$z.frameRate,$w.frames=this._gList,$w.labels=this._labels,$w.name=$z.name,$l.push($w),$k[$z.name]=$w}this.animationList=$l,this.animationDic=$k}$S._temParam.length=0},$x.parseByData=function($x){var $I,$z;$I=$x.nodeRoot,$z=$x.aniO,delete $x.nodeRoot,delete $x.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$I,this._parseNodeList($I),this._labels=null;try{this._calGraphicData($z)}catch($x){console.warn("parse animation fail:"+$z.name+",empty animation created"),this._gList=[]}var $k=$x;return $k.interval=1e3/$z.frameRate,$k.frames=this._gList,$k.labels=this._labels,$k.name=$z.name,$k},$x.setUpAniData=function($x){if($x.animations){var $I,$z={},$k=[],$l=$x.animations,$n=0,$a=$l.length;for($n=0;$n<$a;$n++)if($I=$l[$n]){var $$={};$$.name=$I.name,$$.aniO=$I,$$.nodeRoot=$x,$k.push($$),$z[$I.name]=$$}this.animationList=$k,this.animationDic=$z}},$x._clear=function(){var $x,$I;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($x in this._nodeGDic)($I=this._nodeGDic[$x])&&$I.recover();this._nodeGDic=null},$S.parseAnimationByData=function($x){var $I;return $S._I||($S._I=new $S),$I=$S._I.parseByData($x),$S._I._clear(),$I},$S.parseAnimationData=function($x){var $I;return $S._I||($S._I=new $S),$S._I.setUpAniData($x),($I={}).animationList=$S._I.animationList,$I.animationDic=$S._I.animationDic,$S._I._clear(),$I},$S._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$S._temParam=[],$S._I=null,$S._rootMatrix=null,$w($S,["_tempMt",function(){return this._tempMt=new $U}]),$S.__init$=function(){$O=function(){function $x(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $N($x,""),$x.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$H.recover("GraphicNode",this)},$x.create=function(){return $H.getItemByClass("GraphicNode",$x)},$x}()},$S}($yx));$v.__init([$i,$wx,$j,$W,$u,$E,$x,$vx])}(window,document,Laya),function($x,$I,$z){$z.un,$z.uns,$z.static;var $k=$z.class;$z.getset,$z.__newvec;new(function(){function $x(){}return $k($x,"LayaMain"),$x}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($x,$I){"use strict";for(var $z in Object.defineProperty($I,"__esModule",{value:!0}),Laya){var $k=Laya[$z];$k&&$k.__isclass&&($I[$z]=$k)}}),function($l,$x,$P){$P.un,$P.uns;var $a=$P.static,$T=$P.class,$k=$P.getset,$n=$P.__newvec,$F=laya.maths.Arith,$b=laya.maths.Bezier,$z=laya.resource.Bitmap,$_=laya.utils.Browser,$w=laya.utils.Byte,$R=laya.utils.Color,$v=(laya.filters.ColorFilter,$P.Config),$$=laya.resource.Context,$L=(laya.events.Event,laya.filters.Filter),$i=laya.display.Graphics,$s=laya.resource.HTMLCanvas,$N=(laya.utils.HTMLChar,laya.resource.HTMLImage),$I=laya.resource.HTMLSubImage,$K=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$E=laya.maths.Point,$O=laya.maths.Rectangle,$D=laya.renders.Render,$f=(laya.renders.RenderContext,laya.renders.RenderSprite),$m=laya.resource.Resource,$y=laya.resource.ResourceManager,$C=laya.utils.RunDriver,$S=laya.display.Sprite,$Z=laya.display.Stage,$U=laya.utils.Stat,$X=laya.utils.StringKey,$d=(laya.display.css.Style,laya.system.System),$j=laya.display.Text,$t=laya.resource.Texture,$Y=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$c=laya.utils.VectorGraphManager;laya.utils.WordText;$P.interface("laya.webgl.shapes.IShape"),$P.interface("laya.webgl.submit.ISubmit"),$P.interface("laya.webgl.text.ICharSegment"),$P.interface("laya.webgl.canvas.save.ISaveData"),$P.interface("laya.webgl.resource.IMergeAtlasBitmap"),$P.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $V=function(){function $x(){}$T($x,"laya.filters.webgl.FilterActionGL");var $I=$x.prototype;return $P.imps($I,{"laya.filters.IFilterActionGL":!0}),$I.setValue=function($x){},$I.setValueMix=function($x){},$I.apply3d=function($x,$I,$z,$k,$l){return null},$I.apply=function($x){return null},$k(0,$I,"typeMix",function(){return 0}),$x}(),$W=function(){function $x(){}return $T($x,"laya.webgl.shader.ShaderValue"),$x}(),$q=function(){var $k,$l;function $x($x,$I,$z){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $l,void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),this._cells=null,this._rowInfo=null,this._init($x,$I),this._atlasID=$z}$T($x,"laya.webgl.atlas.AtlasGrid");var $I=$x.prototype;return $I.getAltasID=function(){return this._atlasID},$I.setAltasID=function($x){0<=$x&&(this._atlasID=$x)},$I.addTex=function($x,$I,$z){var $k=this._get($I,$z);return 0==$k.ret||(this._fill($k.x,$k.y,$I,$z,$x),this._texCount++),$k},$I._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$I._init=function($x,$I){if(this._width=$x,this._height=$I,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$n(this._height);for(var $z=0;$z<this._height;$z++)this._rowInfo[$z]=new $k;return this._clear(),!0},$I._get=function($x,$I){var $z=new $J;if($x>=this._failSize.width&&$I>=this._failSize.height)return $z;for(var $k=-1,$l=-1,$n=this._width,$a=this._height,$$=this._cells,$w=0;$w<$a;$w++)if(!(this._rowInfo[$w].spaceCount<$x))for(var $i=0;$i<$n;){var $F=3*($w*$n+$i);if(0!=$$[$F]||$$[1+$F]<$x||$$[2+$F]<$I)$i+=$$[1+$F];else{$k=$i,$l=$w;for(var $b=0;$b<$x;$b++)if($$[3*$b+$F+2]<$I){$k=-1;break}if(!($k<0))return $z.ret=!0,$z.x=$k,$z.y=$l,$z;$i+=$$[1+$F]}}return $z},$I._fill=function($x,$I,$z,$k,$l){var $n=this._width,$a=this._height;this._check($x+$z<=$n&&$I+$k<=$a);for(var $$=$I;$$<$k+$I;++$$){this._check(this._rowInfo[$$].spaceCount>=$z),this._rowInfo[$$].spaceCount-=$z;for(var $w=0;$w<$z;$w++){var $i=3*($x+$$*$n+$w);this._check(0==this._cells[$i]),this._cells[$i]=$l,this._cells[1+$i]=$z,this._cells[2+$i]=$k}}if(0<$x)for($$=0;$$<$k;++$$){var $F=0;for($w=$x-1;0<=$w&&0==this._cells[3*(($I+$$)*$n+$w)];--$w,++$F);for($w=$F;0<$w;--$w)this._cells[3*(($I+$$)*$n+$x-$w)+1]=$w,this._check(0<$w)}if(0<$I)for($w=$x;$w<$x+$z;++$w){for($F=0,$$=$I-1;0<=$$&&0==this._cells[3*($w+$$*$n)];--$$,$F++);for($$=$F;0<$$;--$$)this._cells[3*($w+($I-$$)*$n)+2]=$$,this._check(0<$$)}},$I._check=function($x){0==$x&&console.log("xtexMerger 错误啦")},$I._clear=function(){for(var $x=this._texCount=0;$x<this._height;$x++)this._rowInfo[$x].spaceCount=this._width;for(var $I=0;$I<this._height;$I++)for(var $z=0;$z<this._width;$z++){var $k=3*($I*this._width+$z);this._cells[$k]=0,this._cells[1+$k]=this._width-$z,this._cells[2+$k]=this._width-$I}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$x.__init$=function(){$k=function(){function $x(){this.spaceCount=0}return $T($x,""),$x}(),$l=function(){function $x(){this.width=0,this.height=0}return $T($x,""),$x}()},$x}(),$o=function(){function $D($x,$I,$z,$k){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$x,this._height=$I,this._gridSize=$z,this._maxAtlaserCount=$k,this._gridNumX=$x/$z,this._gridNumY=$I/$z,this._curAtlasIndex=0,this._atlaserArray=[]}$T($D,"laya.webgl.atlas.AtlasResourceManager");var $x=$D.prototype;return $x.setAtlasParam=function($x,$I,$z,$k){if(1==this._setAtlasParam)return $D._sid_=0,this._width=$x,this._height=$I,this._gridSize=$z,this._maxAtlaserCount=$k,this._gridNumX=$x/$z,this._gridNumY=$I/$z,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$x.pushData=function($x){var $I,$z=$x.bitmap,$k=-1,$l=null,$n=0,$a=0;for($n=0,$I=this._atlaserArray.length;$n<$I&&($a=(this._curAtlasIndex+$n)%$I,-1==($k=($l=this._atlaserArray[$a]).findBitmapIsExist($z)));$n++);if(-1!=$k){var $$=$l.InAtlasWebGLImagesOffsetValue[$k];return $R=$$[0],$s=$$[1],$l.addToAtlas($x,$R,$s),!0}this._setAtlasParam=!1;for(var $w=Math.ceil(($x.bitmap.width+2)/this._gridSize),$i=Math.ceil(($x.bitmap.height+2)/this._gridSize),$F=!1,$b=0;$b<2;$b++){var $T=this._maxAtlaserCount;for($n=0;$n<$T;$n++){$a=(this._curAtlasIndex+$n)%$T,this._atlaserArray.length-1>=$a||this._atlaserArray.push(new $Ox(this._gridNumX,this._gridNumY,this._width,this._height,$D._sid_++));var $_=this._atlaserArray[$a],$R=0,$s=0,$N=$_.addTex(1,$w,$i);if($N.ret){$R=$N.x*this._gridSize+1,$s=$N.y*this._gridSize+1,$z.lock=!0,$_.addToAtlasTexture($z,$R,$s),$_.addToAtlas($x,$R,$s),$F=!0,this._curAtlasIndex=$a;break}}if($F)break;this._atlaserArray.push(new $Ox(this._gridNumX,this._gridNumY,this._width,this._height,$D._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $F||console.log(">>>AtlasManager pushData error"),$F},$x.addToAtlas=function($x){laya.webgl.atlas.AtlasResourceManager.instance.pushData($x)},$x.garbageCollection=function(){if(!0===this._needGC){for(var $x=this._atlaserArray.length-this._maxAtlaserCount,$I=0;$I<$x;$I++)this._atlaserArray[$I].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$x),this._atlaserArray.splice(0,$x),this._needGC=!1}return!0},$x.freeAll=function(){for(var $x=0,$I=this._atlaserArray.length;$x<$I;$x++)this._atlaserArray[$x].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$x.getAtlaserCount=function(){return this._atlaserArray.length},$x.getAtlaserByIndex=function($x){return this._atlaserArray[$x]},$k(1,$D,"instance",function(){return $D._Instance||($D._Instance=new $D(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$D._Instance}),$k(1,$D,"enabled",function(){return $v.atlasEnable}),$k(1,$D,"atlasLimitWidth",function(){return $D._atlasLimitWidth},function($x){$D._atlasLimitWidth=$x}),$k(1,$D,"atlasLimitHeight",function(){return $D._atlasLimitHeight},function($x){$D._atlasLimitHeight=$x}),$D._enable=function(){$v.atlasEnable=!0},$D._disable=function(){$v.atlasEnable=!1},$D.__init__=function(){$D.atlasTextureWidth=2048,$D.atlasTextureHeight=2048,$D.maxTextureCount=6,$D.atlasLimitWidth=512,$D.atlasLimitHeight=512},$D._atlasLimitWidth=0,$D._atlasLimitHeight=0,$D.gridSize=16,$D.atlasTextureWidth=0,$D.atlasTextureHeight=0,$D.maxTextureCount=0,$D._atlasRestore=0,$D.BOARDER_TYPE_NO=0,$D.BOARDER_TYPE_RIGHT=1,$D.BOARDER_TYPE_LEFT=2,$D.BOARDER_TYPE_BOTTOM=4,$D.BOARDER_TYPE_TOP=8,$D.BOARDER_TYPE_ALL=15,$D._sid_=0,$D._Instance=null,$D}(),$J=function(){function $x(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $T($x,"laya.webgl.atlas.MergeFillInfo"),$x}(),$h=function(){function $I(){}return $T($I,"laya.webgl.canvas.BlendMode"),$I._init_=function($x){$I.fns=[$I.BlendNormal,$I.BlendAdd,$I.BlendMultiply,$I.BlendScreen,$I.BlendOverlay,$I.BlendLight,$I.BlendMask,$I.BlendDestinationOut],$I.targetFns=[$I.BlendNormalTarget,$I.BlendAddTarget,$I.BlendMultiplyTarget,$I.BlendScreenTarget,$I.BlendOverlayTarget,$I.BlendLightTarget,$I.BlendMask,$I.BlendDestinationOut]},$I.BlendNormal=function($x){$x.blendFunc(1,771)},$I.BlendAdd=function($x){$x.blendFunc(1,772)},$I.BlendMultiply=function($x){$x.blendFunc(774,771)},$I.BlendScreen=function($x){$x.blendFunc(1,1)},$I.BlendOverlay=function($x){$x.blendFunc(1,769)},$I.BlendLight=function($x){$x.blendFunc(1,1)},$I.BlendNormalTarget=function($x){$x.blendFunc(1,771)},$I.BlendAddTarget=function($x){$x.blendFunc(1,772)},$I.BlendMultiplyTarget=function($x){$x.blendFunc(774,771)},$I.BlendScreenTarget=function($x){$x.blendFunc(1,1)},$I.BlendOverlayTarget=function($x){$x.blendFunc(1,769)},$I.BlendLightTarget=function($x){$x.blendFunc(1,1)},$I.BlendMask=function($x){$x.blendFunc(0,770)},$I.BlendDestinationOut=function($x){$x.blendFunc(0,0)},$I.activeBlendFunction=null,$I.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$I.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$I.NORMAL="normal",$I.ADD="add",$I.MULTIPLY="multiply",$I.SCREEN="screen",$I.LIGHT="light",$I.OVERLAY="overlay",$I.DESTINATIONOUT="destination-out",$I.fns=[],$I.targetFns=[],$I}(),$B=function(){function $z($x){this._color=$R.create("black"),this.setValue($x)}$T($z,"laya.webgl.canvas.DrawStyle");var $x=$z.prototype;return $x.setValue=function($x){if($x){if("string"==typeof $x)return void(this._color=$R.create($x));if($x instanceof laya.utils.Color)return void(this._color=$x)}},$x.reset=function(){this._color=$R.create("black")},$x.equal=function($x){return"string"==typeof $x?this._color.strColor===$x:$x instanceof laya.utils.Color&&this._color.numColor===$x.numColor},$x.toColorStr=function(){return this._color.strColor},$z.create=function($x){var $I;if($x&&("string"==typeof $x?$I=$R.create($x):$x instanceof laya.utils.Color&&($I=$x),$I))return $I._drawStyle||($I._drawStyle=new $z($x));return laya.webgl.canvas.DrawStyle.DEFAULT},$a($z,["DEFAULT",function(){return this.DEFAULT=new $z("#000000")}]),$z}(),$e=function(){function $x(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$yx.mainContext;this.ib=$Qx.create(35048),this.vb=$Gx.create(5)}$T($x,"laya.webgl.canvas.Path");var $I=$x.prototype;return $I.addPoint=function($x,$I){this.tempArray.push($x,$I)},$I.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$I.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$I.polygon=function($x,$I,$z,$k,$l,$n){var $a;return this.geomatrys.push(this._curGeomatry=$a=new $Xx($x,$I,$z,$k,$l,$n)),$k||($a.fill=!1),null==$n&&($a.borderWidth=0),$a},$I.setGeomtry=function($x){this.geomatrys.push(this._curGeomatry=$x)},$I.drawLine=function($x,$I,$z,$k,$l){var $n;return this.closePath?this.geomatrys.push(this._curGeomatry=$n=new $Ux($x,$I,$z,$k,$l)):this.geomatrys.push(this._curGeomatry=$n=new $Zx($x,$I,$z,$k,$l)),$n.fill=!1,$n},$I.update=function(){var $x=this.ib._byteLength,$I=this.geomatrys.length;this.offset=$x;for(var $z=this.geoStart;$z<$I;$z++)this.geomatrys[$z].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$I,this.count=(this.ib._byteLength-$x)/$sx.BYTES_PIDX},$I.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$I.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$x}(),$A=function(){function $$(){}$T($$,"laya.webgl.canvas.save.SaveBase");var $x=$$.prototype;return $P.imps($x,{"laya.webgl.canvas.save.ISaveData":!0}),$x.isSaveMark=function(){return!1},$x.restore=function($x){this._dataObj[this._valueName]=this._value,($$._cache[$$._cache._length++]=this)._newSubmit&&($x._curSubmit=$nx.RENDERBASE,$x._renderKey=0)},$$._createArray=function(){var $x=[];return $x._length=0,$x},$$._init=function(){var $x=$$._namemap={};return $x[1]="ALPHA",$x[2]="fillStyle",$x[8]="font",$x[256]="lineWidth",$x[512]="strokeStyle",$x[8192]="_mergeID",$x[1024]=$x[2048]=$x[4096]=[],$x[16384]="textBaseline",$x[32768]="textAlign",$x[65536]="_nBlendType",$x[1048576]="shader",$x[2097152]="filters",$x},$$.save=function($x,$I,$z,$k){if(($x._saveMark._saveuse&$I)!==$I){$x._saveMark._saveuse|=$I;var $l=$$._cache,$n=0<$l._length?$l[--$l._length]:new $$;$n._value=$z[$n._valueName=$$._namemap[$I]],$n._dataObj=$z,$n._newSubmit=$k;var $a=$x._save;$a[$a._length++]=$n}},$$._cache=laya.webgl.canvas.save.SaveBase._createArray(),$$._namemap=$$._init(),$$}(),$H=function(){function $n(){this._clipRect=new $O}$T($n,"laya.webgl.canvas.save.SaveClipRect");var $x=$n.prototype;return $P.imps($x,{"laya.webgl.canvas.save.ISaveData":!0}),$x.isSaveMark=function(){return!1},$x.restore=function($x){$x._clipRect=this._clipSaveRect,($n._cache[$n._cache._length++]=this)._submitScissor.submitLength=$x._submits._length-this._submitScissor.submitIndex,$x._curSubmit=$nx.RENDERBASE,$x._renderKey=0},$n.save=function($x,$I){if(131072!=(131072&$x._saveMark._saveuse)){$x._saveMark._saveuse|=131072;var $z=$n._cache,$k=0<$z._length?$z[--$z._length]:new $n;$k._clipSaveRect=$x._clipRect,$x._clipRect=$k._clipRect.copyFrom($x._clipRect),$k._submitScissor=$I;var $l=$x._save;$l[$l._length++]=$k}},$a($n,["_cache",function(){return this._cache=$A._createArray()}]),$n}(),$p=function(){function $_(){this._contextX=0,this._contextY=0,this._clipRect=new $O,this._rect=new $O,this._matrix=new $K}$T($_,"laya.webgl.canvas.save.SaveClipRectStencil");var $x=$_.prototype;return $P.imps($x,{"laya.webgl.canvas.save.ISaveData":!0}),$x.isSaveMark=function(){return!1},$x.restore=function($x){$Fx.restore($x,this._rect,this._saveMatrix,this._contextX,this._contextY),$x._clipRect=this._clipSaveRect,$x._curMat=this._saveMatrix,$x._x=this._contextX,$x._y=this._contextY,$_._cache[$_._cache._length++]=this,$x._curSubmit=$nx.RENDERBASE},$_.save=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){if(262144!=(262144&$x._saveMark._saveuse)){$x._saveMark._saveuse|=262144;var $F=$_._cache,$b=0<$F._length?$F[--$F._length]:new $_;$b._clipSaveRect=$x._clipRect,$b._clipRect.setTo($a,$$,$w,$i),$x._clipRect=$b._clipRect,$b._rect.x=$z,$b._rect.y=$k,$b._rect.width=$l,$b._rect.height=$n,$b._contextX=$x._x,$b._contextY=$x._y,$b._saveMatrix=$x._curMat,$x._curMat.copyTo($b._matrix),$x._curMat=$b._matrix,$b._submitStencil=$I;var $T=$x._save;$T[$T._length++]=$b}},$a($_,["_cache",function(){return this._cache=$A._createArray()}]),$_}(),$u=function(){function $k(){this._saveuse=0}$T($k,"laya.webgl.canvas.save.SaveMark");var $x=$k.prototype;return $P.imps($x,{"laya.webgl.canvas.save.ISaveData":!0}),$x.isSaveMark=function(){return!0},$x.restore=function($x){$x._saveMark=this._preSaveMark,$k._no[$k._no._length++]=this},$k.Create=function($x){var $I=$k._no,$z=0<$I._length?$I[--$I._length]:new $k;return $z._saveuse=0,$z._preSaveMark=$x._saveMark,$x._saveMark=$z},$a($k,["_no",function(){return this._no=$A._createArray()}]),$k}(),$r=function(){function $n(){this._matrix=new $K}$T($n,"laya.webgl.canvas.save.SaveTransform");var $x=$n.prototype;return $P.imps($x,{"laya.webgl.canvas.save.ISaveData":!0}),$x.isSaveMark=function(){return!1},$x.restore=function($x){$x._curMat=this._savematrix,$n._no[$n._no._length++]=this},$n.save=function($x){var $I=$x._saveMark;if(2048!=(2048&$I._saveuse)){$I._saveuse|=2048;var $z=$n._no,$k=0<$z._length?$z[--$z._length]:new $n;$k._savematrix=$x._curMat,$x._curMat=$x._curMat.copyTo($k._matrix);var $l=$x._save;$l[$l._length++]=$k}},$a($n,["_no",function(){return this._no=$A._createArray()}]),$n}(),$g=function(){function $l(){}$T($l,"laya.webgl.canvas.save.SaveTranslate");var $x=$l.prototype;return $P.imps($x,{"laya.webgl.canvas.save.ISaveData":!0}),$x.isSaveMark=function(){return!1},$x.restore=function($x){$x._curMat;$x._x=this._x,$x._y=this._y,$l._no[$l._no._length++]=this},$l.save=function($x){var $I=$l._no,$z=0<$I._length?$I[--$I._length]:new $l;$z._x=$x._x,$z._y=$x._y;var $k=$x._save;$k[$k._length++]=$z},$a($l,["_no",function(){return this._no=$A._createArray()}]),$l}(),$M=function(){function $x(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $O}$T($x,"laya.webgl.resource.RenderTargetMAX");var $I=$x.prototype;return $I.setSP=function($x){this._sp=$x},$I.size=function($x,$I){var $z=this;this._width!==$x||this._height!==$I?(this.repaint=!0,this._width=$x,this._height=$I,this.target?this.target.size($x,$I):this.target=$cx.create($x,$I),this.target.hasListener("recovered")||this.target.on("recovered",this,function($x){$P.timer.callLater($z._sp,$z._sp.repaint)})):this.target.size($x,$I)},$I._flushToTarget=function($x,$I){if(!$I._destroy){var $z=$fx.worldScissorTest,$k=$fx.worldClipRect;$fx.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$fx.worldScissorTest=!1,$yx.mainContext.disable(3089);var $l=$fx.worldAlpha,$n=$fx.worldMatrix4,$a=$fx.worldMatrix,$$=$fx.worldFilters,$w=$fx.worldShaderDefines;if($fx.worldMatrix=$K.EMPTY,$fx.restoreTempArray(),$fx.worldMatrix4=$fx.TEMPMAT4_ARRAY,$fx.worldAlpha=1,$fx.worldFilters=null,$fx.worldShaderDefines=null,$Yx.activeShader=null,$I.start(),$v.showCanvasMark?$I.clear(0,1,0,.3):$I.clear(0,0,0,0),$x.flush(),$I.end(),$Yx.activeShader=null,$fx.worldAlpha=$l,$fx.worldMatrix4=$n,$fx.worldMatrix=$a,$fx.worldFilters=$$,$fx.worldShaderDefines=$w,$fx.worldScissorTest=$z){var $i=$fx.height-$k.y-$k.height;$yx.mainContext.scissor($k.x,$i,$k.width,$k.height),$yx.mainContext.enable(3089)}$fx.worldClipRect=$k}},$I.flush=function($x){this.repaint&&(this._flushToTarget($x,this.target),this.repaint=!1)},$I.drawTo=function($x,$I,$z,$k,$l){$x.drawTexture(this.target.getTexture(),$I,$z,$k,$l,0,0)},$I.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$x}(),$Q=function(){function $x(){this.ALPHA=1,this.shaderType=0,this.defines=new $Sx}return $T($x,"laya.webgl.shader.d2.Shader2D"),$x.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$x.__init__=function(){var $x,$I;$ux.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$ux.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$ux.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$ux.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$ux.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$ux.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$ux.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$ux.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$x="attribute vec4 position;\n",$x+="attribute vec2 texcoord;\n",$x+="uniform vec2 size;\n\n",$x+="#ifdef WORLDMAT\n",$x+="  uniform mat4 mmat;\n",$x+="#endif\n",$x+="varying vec2 v_texcoord;\n",$x+="void main() {\n",$x+="  #ifdef WORLDMAT\n",$x+="  vec4 pos=mmat*position;\n",$x+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",$x+="  #else\n",$x+="  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n",$x+="  #endif\n\n",$x+="  v_texcoord = texcoord;\n",$x+="}",$I="precision mediump float;\n",$I+="varying vec2 v_texcoord;\n",$I+="uniform sampler2D texture;\n\n",$I+="#ifdef COLORMUL\n",$I+="  uniform vec4 colorMul;\n",$I+="#endif\n\n",$I+="#ifdef TXTALPHA\n",$I+="  uniform sampler2D texture1;\n",$I+="#endif\n\n",$I+="uniform float alpha;\n",$I+='#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n',$I+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',$I+='#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n',$I+='#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\n',$I+="void main() {\n",$I+="   vec4 color= texture2D(texture, v_texcoord);\n\n",$I+="   #ifdef TXTCOMPRESS\n",$I+="      color.rgb *= color.a;\n",$I+="   #endif\n\n",$I+="   #ifdef TXTALPHA\n",$I+="      color.rgba *= texture2D(texture1, v_texcoord).a;\n",$I+="   #endif\n\n",$I+="   color.a*=alpha;\n",$I+="   color.rgb*=alpha;\n",$I+="   #ifdef COLORMUL\n",$I+="      color.rgba *= colorMul;\n",$I+="   #endif\n\n",$I+="   gl_FragColor=color;\n",$I+='   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";\n',$I+='   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n',$I+='   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',$I+='   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n',$I+="}",$ux.preCompile2D(0,1,$x,$I,null),$x="attribute vec4 position;\n",$x+="uniform vec2 size;\n",$x+="uniform mat4 mmat;\n",$x+="void main() {\n",$x+="  vec4 pos=mmat*position;\n",$x+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",$x+="}",$I="precision mediump float;\n",$I+="uniform vec4 color;\n",$I+="uniform float alpha;\n",$I+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',$I+="void main() {\n",$I+="\t vec4 a = vec4(color.r, color.g, color.b, color.a);\n",$I+="\t a.w = alpha;\n",$I+="\t a.xyz *= alpha;\n",$I+="\t gl_FragColor = a;\n",$I+='\t #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',$I+="}",$ux.preCompile2D(0,2,$x,$I,null),$x="attribute vec4 position;\n",$x+="attribute vec3 a_color;\n",$x+="uniform mat4 mmat;\n",$x+="uniform mat4 u_mmat2;\n",$x+="uniform vec2 u_pos;\n",$x+="uniform vec2 size;\n",$x+="varying vec3 color;\n",$x+="void main(){\n",$x+="  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n",$x+="  vec4 pos=mmat*u_mmat2*tPos;\n",$x+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",$x+="  color=a_color;\n",$x+="}",$I="precision mediump float;\n",$I+="varying vec3 color;\n",$I+="uniform float alpha;\n",$I+="void main(){\n",$I+="  gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n",$I+="\t gl_FragColor.rgb*=alpha;\n",$I+="}",$ux.preCompile2D(0,4,$x,$I,null),$x="attribute vec4 position;\n",$x+="attribute vec2 texcoord;\n",$x+="uniform vec2 size;\n\n",$x+="#ifdef WORLDMAT\n",$x+="  uniform mat4 mmat;\n",$x+="#endif\n",$x+="varying vec2 v_texcoord;\n",$x+="void main() {\n",$x+="  #ifdef WORLDMAT\n",$x+="    vec4 pos=mmat*position;\n",$x+="    gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",$x+="  #else\n",$x+="    gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n",$x+="  #endif\n\n",$x+="  v_texcoord = texcoord;\n",$x+="}",$I="#ifdef FSHIGHPRECISION\n",$I+="   precision highp float;\n",$I+="#else\n",$I+="   precision mediump float;\n",$I+="#endif\n",$I+="varying vec2 v_texcoord;\n",$I+="uniform sampler2D texture;\n\n",$I+="#ifdef TXTALPHA\n",$I+="   uniform sampler2D texture1;\n",$I+="#endif\n\n",$I+="uniform float alpha;\n",$I+="uniform vec4 u_TexRange;\n",$I+="uniform vec2 u_offset;\n",$I+='#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n',$I+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',$I+='#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n',$I+='#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\n',$I+="void main() {\n",$I+="   vec2 newTexCoord;\n",$I+="   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n",$I+="   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n",$I+="   vec4 color= texture2D(texture, newTexCoord);\n\n",$I+="   #ifdef TXTALPHA\n",$I+="      color.a = texture2D(texture1, newTexCoord).a;\n",$I+="   #endif\n\n",$I+="   color.a*=alpha;\n",$I+="   gl_FragColor=color;\n",$I+='   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";\n',$I+='   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n',$I+='   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',$I+='   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n',$I+="}",$ux.preCompile2D(0,256,$x,$I,null),$x="attribute vec2 position;\n",$x+="attribute vec2 texcoord;\n",$x+="attribute vec4 color;\n",$x+="uniform vec2 size;\n",$x+="uniform float offsetX;\n",$x+="uniform float offsetY;\n",$x+="uniform mat4 mmat;\n",$x+="uniform mat4 u_mmat2;\n",$x+="varying vec2 v_texcoord;\n",$x+="varying vec4 v_color;\n",$x+="void main() {\n",$x+="  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n",$x+="  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",$x+="  v_color = color;\n",$x+="  v_color.rgb *= v_color.a;\n",$x+="  v_texcoord = texcoord;  \n",$x+="}",$I="precision mediump float;\n",$I+="varying vec2 v_texcoord;\n",$I+="varying vec4 v_color;\n",$I+="uniform sampler2D texture;\n\n",$I+="#ifdef TXTALPHA\n",$I+="  uniform sampler2D texture1;\n",$I+="#endif\n\n",$I+="uniform float alpha;\n",$I+="void main() {\n",$I+="\t vec4 t_color = texture2D(texture, v_texcoord);\n\n",$I+="  #ifdef TXTALPHA\n",$I+="    t_color.a = texture2D(texture1, v_texcoord).a;\n",$I+="  #endif\n\n",$I+="\t gl_FragColor = t_color.rgba * v_color;\n",$I+="\t gl_FragColor *= alpha;\n",$I+="}",$ux.preCompile2D(0,512,$x,$I,null)},$x}(),$G=function(){function $I($x,$I,$z){this._value=0,this._name2int=$x,this._int2name=$I,this._int2nameMap=$z}$T($I,"laya.webgl.shader.ShaderDefines");var $x=$I.prototype;return $x.add=function($x){return"string"==typeof $x&&($x=this._name2int[$x]),this._value|=$x,this._value},$x.addInt=function($x){return this._value|=$x,this._value},$x.remove=function($x){return"string"==typeof $x&&($x=this._name2int[$x]),this._value&=~$x,this._value},$x.isDefine=function($x){return(this._value&$x)===$x},$x.getValue=function(){return this._value},$x.setValue=function($x){this._value=$x},$x.toNameDic=function(){var $x=this._int2nameMap[this._value];return $x||$I._toText(this._value,this._int2name,this._int2nameMap)},$I._reg=function($x,$I,$z,$k){$k[$z[$x]=$I]=$x},$I._toText=function($x,$I,$z){var $k=$z[$x];if($k)return $k;for(var $l={},$n=1,$a=0;$a<32&&!($x<($n=1<<$a));$a++)if($x&$n){var $$=$I[$n];$$&&($l[$$]="")}return $z[$x]=$l},$I._toInt=function($x,$I){for(var $z=$x.split("."),$k=0,$l=0,$n=$z.length;$l<$n;$l++){var $a=$I[$z[$l]];if(!$a)throw new Error("Defines to int err:"+$x+"/"+$z[$l]);$k|=$a}return $k},$I}(),$xx=function(){function $a(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $K}$T($a,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $x=$a.prototype;return $x.init=function($x,$I,$z){if($I)this._vs=$I;else{this._vs=[];var $k=$x.width,$l=$x.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($k,0,1,0,1,1,1,1),this._vs.push($k,$l,1,1,1,1,1,1),this._vs.push(0,$l,0,1,1,1,1,1)}$z?this._ps=$z:($a._defaultPS||($a._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$a._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$x},$x.init2=function($x,$I,$z,$k,$l){this.transform&&(this.transform=null),$z?this._ps=$z:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$k,this._uvs=$l,this.mEleNum=this._ps.length,this.mTexture=$x,($D.isConchNode||$D.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$x._initMyData=function(){var $x=0,$I=0,$z=4*this._verticles.length;this._vs=$a._tempVS;var $k=!1;if($D.isConchNode||$D.isConchApp?(this._vs.length=$z,$k=!0):this._vs.length<$z&&(this._vs.length=$z,$k=!0),$a._tVSLen=$z,$k)for(;$x<$z;)this._vs[$x]=this._verticles[$I],this._vs[$x+1]=this._verticles[$I+1],this._vs[$x+2]=this._uvs[$I],this._vs[$x+3]=this._uvs[$I+1],this._vs[$x+4]=1,this._vs[$x+5]=1,this._vs[$x+6]=1,this._vs[$x+7]=1,$x+=8,$I+=2;else for(;$x<$z;)this._vs[$x]=this._verticles[$I],this._vs[$x+1]=this._verticles[$I+1],this._vs[$x+2]=this._uvs[$I],this._vs[$x+3]=this._uvs[$I+1],$x+=8,$I+=2},$x.getData2=function($x,$I,$z){var $k;this.mVBBuffer=$x,this.mIBBuffer=$I,this._initMyData(),$x.appendEx2(this._vs,Float32Array,$a._tVSLen,4),this._indexStart=$I._byteLength,($k=$a._tempIB).length<this._ps.length&&($k.length=this._ps.length);for(var $l=0,$n=this._ps.length;$l<$n;$l++)$k[$l]=this._ps[$l]+$z;$I.appendEx2($k,Uint16Array,this._ps.length,2)},$x.getData=function($x,$I,$z){if(this.mVBBuffer=$x,this.mIBBuffer=$I,$x.append(this.mVBData),this._indexStart=$I._byteLength,this.mIBData.start!=$z){for(var $k=0,$l=this._ps.length;$k<$l;$k++)this.mIBData[$k]=this._ps[$k]+$z;this.mIBData.start=$z}$I.append(this.mIBData)},$x.render=function($x,$I,$z){if($D.isWebGL&&this.mTexture){$x._renderKey=0,$x._shader2D.glTexture=null,$Ix.getInstance().addSkinMesh(this);var $k=$nx.createShape($x,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$Lx.create(512,0));this.transform||(this.transform=$K.EMPTY),this.transform.translate($I,$z),$K.mul(this.transform,$x._curMat,this._tempMatrix),this.transform.translate(-$I,-$z);var $l=$k.shaderValue,$n=$l.u_mmat2||$fx.getMatrArray();$fx.mat2MatArray(this._tempMatrix,$n),$l.textureHost=this.mTexture,$l.offsetX=0,$l.offsetY=0,$l.u_mmat2=$n,$l.ALPHA=$x._shader2D.ALPHA,$x._submits[$x._submits._length++]=$k}else $D.isConchApp&&this.mTexture&&(this.transform||(this.transform=$K.EMPTY),$x.setSkinMesh&&$x.setSkinMesh($I,$z,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$a._tempVS=[],$a._tempIB=[],$a._defaultPS=null,$a._tVSLen=0,$a}(),$Ix=function(){function $x(){this.ib=null,this.vb=null;$yx.mainContext;this.ib=$Qx.create(35048),this.vb=$Gx.create(8)}$T($x,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $I=$x.prototype;return $I.addSkinMesh=function($x){$x.getData2(this.vb,this.ib,this.vb._byteLength/32)},$I.reset=function(){this.vb.clear(),this.ib.clear()},$x.getInstance=function(){return $x.instance=$x.instance||new $x},$x.instance=null,$x}(),$zx=function(){function $x($x,$I,$z,$k,$l,$n,$a,$$,$w){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$w&&($w=0),this.x=$x,this.y=$I,this.width=$z,this.height=$k,this.edges=$l,this.color=$n,this.borderWidth=$a,this.borderColor=$$}$T($x,"laya.webgl.shapes.BasePoly");var $I=$x.prototype;return $P.imps($I,{"laya.webgl.shapes.IShape":!0}),$I.getData=function($x,$I,$z){},$I.rebuild=function($x){},$I.setMatrix=function($x){},$I.needUpdate=function($x){return!0},$I.sector=function($x,$I,$z){var $k=this.x,$l=this.y,$n=this.edges,$a=(this.r1-this.r0)/$n,$$=this.width,$w=this.height,$i=this.color,$F=($i>>16&255)/255,$b=($i>>8&255)/255,$T=(255&$i)/255;$x.push($k,$l,$F,$b,$T);for(var $_=0;$_<$n+1;$_++)$x.push($k+Math.sin($a*$_+this.r0)*$$,$l+Math.cos($a*$_+this.r0)*$w),$x.push($F,$b,$T);for($_=0;$_<$n;$_++)$I.push($z,$z+$_+1,$z+$_+2)},$I.createLine2=function($x,$I,$z,$k,$l,$n){var $a,$$,$w,$i,$F,$b,$T,$_,$R,$s,$N,$D,$f,$m,$y,$C,$P,$v,$L,$K,$E=$x.concat(),$O=$l,$S=this.borderColor,$Z=($S>>16&255)/255,$U=($S>>8&255)/255,$X=(255&$S)/255,$d=$E.length/2,$j=$k,$t=$z/2;$w=$E[0],$i=$E[1],$s=$w-($F=$E[2]),$R=($R=-($i-($b=$E[3])))/($K=Math.sqrt($R*$R+$s*$s))*$t,$s=$s/$K*$t,$O.push($w-$R+this.x,$i-$s+this.y,$Z,$U,$X,$w+$R+this.x,$i+$s+this.y,$Z,$U,$X);for(var $Y=1;$Y<$d-1;$Y++)$w=$E[2*($Y-1)],$i=$E[2*($Y-1)+1],$F=$E[2*$Y],$b=$E[2*$Y+1],$T=$E[2*($Y+1)],$_=$E[2*($Y+1)+1],$s=$w-$F,$D=$F-$T,$y=(-($R=($R=-($i-$b))/($K=Math.sqrt($R*$R+$s*$s))*$t)+$w)*(-($s=$s/$K*$t)+$b)-(-$R+$F)*(-$s+$i),$v=(-($N=($N=-($b-$_))/($K=Math.sqrt($N*$N+$D*$D))*$t)+$T)*(-($D=$D/$K*$t)+$b)-(-$N+$F)*(-$D+$_),$L=($f=-$s+$i-(-$s+$b))*($P=-$N+$F-(-$N+$T))-($C=-$D+$_-(-$D+$b))*($m=-$R+$F-(-$R+$w)),Math.abs($L)<.1?($L+=10.1,$O.push($F-$R+this.x,$b-$s+this.y,$Z,$U,$X,$F+$R+this.x,$b+$s+this.y,$Z,$U,$X)):((($a=($m*$v-$P*$y)/$L)-$F)*($a-$F)+(($$=($C*$y-$f*$v)/$L)-$b)+($$-$b),$O.push($a+this.x,$$+this.y,$Z,$U,$X,$F-($a-$F)+this.x,$b-($$-$b)+this.y,$Z,$U,$X));$w=$E[$E.length-4],$i=$E[$E.length-3],$s=$w-($F=$E[$E.length-2]),$R=($R=-($i-($b=$E[$E.length-1])))/($K=Math.sqrt($R*$R+$s*$s))*$t,$s=$s/$K*$t,$O.push($F-$R+this.x,$b-$s+this.y,$Z,$U,$X,$F+$R+this.x,$b+$s+this.y,$Z,$U,$X);var $c=$n;for($Y=1;$Y<$c;$Y++)$I.push($j+2*($Y-1),$j+2*($Y-1)+1,$j+2*$Y+1,$j+2*$Y+1,$j+2*$Y,$j+2*($Y-1));return $O},$I.createLine=function($x,$I,$z,$k){var $l=$x.concat(),$n=$x,$a=this.borderColor,$$=($a>>16&255)/255,$w=($a>>8&255)/255,$i=(255&$a)/255;$l.splice(0,5);var $F,$b,$T,$_,$R,$s,$N,$D,$f,$m,$y,$C,$P,$v,$L,$K,$E,$O,$S,$Z,$U=$l.length/5,$X=$k,$d=$z/2;$T=$l[0],$_=$l[1],$m=$T-($R=$l[5]),$f=($f=-($_-($s=$l[6])))/($Z=Math.sqrt($f*$f+$m*$m))*$d,$m=$m/$Z*$d,$n.push($T-$f,$_-$m,$$,$w,$i,$T+$f,$_+$m,$$,$w,$i);for(var $j=1;$j<$U-1;$j++)$T=$l[5*($j-1)],$_=$l[5*($j-1)+1],$R=$l[5*$j],$s=$l[5*$j+1],$N=$l[5*($j+1)],$D=$l[5*($j+1)+1],$m=$T-$R,$C=$R-$N,$L=(-($f=($f=-($_-$s))/($Z=Math.sqrt($f*$f+$m*$m))*$d)+$T)*(-($m=$m/$Z*$d)+$s)-(-$f+$R)*(-$m+$_),$O=(-($y=($y=-($s-$D))/($Z=Math.sqrt($y*$y+$C*$C))*$d)+$N)*(-($C=$C/$Z*$d)+$s)-(-$y+$R)*(-$C+$D),$S=($P=-$m+$_-(-$m+$s))*($E=-$y+$R-(-$y+$N))-($K=-$C+$D-(-$C+$s))*($v=-$f+$R-(-$f+$T)),Math.abs($S)<.1?($S+=10.1,$n.push($R-$f,$s-$m,$$,$w,$i,$R+$f,$s+$m,$$,$w,$i)):((($F=($v*$O-$E*$L)/$S)-$R)*($F-$R)+(($b=($K*$L-$P*$O)/$S)-$s)+($b-$s),$n.push($F,$b,$$,$w,$i,$R-($F-$R),$s-($b-$s),$$,$w,$i));$T=$l[$l.length-10],$_=$l[$l.length-9],$m=$T-($R=$l[$l.length-5]),$f=($f=-($_-($s=$l[$l.length-4])))/($Z=Math.sqrt($f*$f+$m*$m))*$d,$m=$m/$Z*$d,$n.push($R-$f,$s-$m,$$,$w,$i,$R+$f,$s+$m,$$,$w,$i);var $t=this.edges+1;for($j=1;$j<$t;$j++)$I.push($X+2*($j-1),$X+2*($j-1)+1,$X+2*$j+1,$X+2*$j+1,$X+2*$j,$X+2*($j-1));return $n},$I.createLoopLine=function($x,$I,$z,$k,$l,$n){var $a=$x.concat(),$$=$l||$x,$w=this.borderColor,$i=($w>>16&255)/255,$F=($w>>8&255)/255,$b=(255&$w)/255;$a.splice(0,5);var $T=[$a[0],$a[1]],$_=[$a[$a.length-5],$a[$a.length-4]],$R=$_[0]+.5*($T[0]-$_[0]),$s=$_[1]+.5*($T[1]-$_[1]);$a.unshift($R,$s,0,0,0),$a.push($R,$s,0,0,0);var $N,$D,$f,$m,$y,$C,$P,$v,$L,$K,$E,$O,$S,$Z,$U,$X,$d,$j,$t,$Y,$c=$a.length/5,$V=$k,$W=$z/2;$f=$a[0],$m=$a[1],$K=$f-($y=$a[5]),$L=($L=-($m-($C=$a[6])))/($Y=Math.sqrt($L*$L+$K*$K))*$W,$K=$K/$Y*$W,$$.push($f-$L,$m-$K,$i,$F,$b,$f+$L,$m+$K,$i,$F,$b);for(var $q=1;$q<$c-1;$q++)$f=$a[5*($q-1)],$m=$a[5*($q-1)+1],$y=$a[5*$q],$C=$a[5*$q+1],$P=$a[5*($q+1)],$v=$a[5*($q+1)+1],$K=$f-$y,$O=$y-$P,$U=(-($L=($L=-($m-$C))/($Y=Math.sqrt($L*$L+$K*$K))*$W)+$f)*(-($K=$K/$Y*$W)+$C)-(-$L+$y)*(-$K+$m),$j=(-($E=($E=-($C-$v))/($Y=Math.sqrt($E*$E+$O*$O))*$W)+$P)*(-($O=$O/$Y*$W)+$C)-(-$E+$y)*(-$O+$v),$t=($S=-$K+$m-(-$K+$C))*($d=-$E+$y-(-$E+$P))-($X=-$O+$v-(-$O+$C))*($Z=-$L+$y-(-$L+$f)),Math.abs($t)<.1?($t+=10.1,$$.push($y-$L,$C-$K,$i,$F,$b,$y+$L,$C+$K,$i,$F,$b)):((($N=($Z*$j-$d*$U)/$t)-$y)*($N-$y)+(($D=($X*$U-$S*$j)/$t)-$C)+($D-$C),$$.push($N,$D,$i,$F,$b,$y-($N-$y),$C-($D-$C),$i,$F,$b));$n&&($I=$n);var $o=this.edges+1;for($q=1;$q<$o;$q++)$I.push($V+2*($q-1),$V+2*($q-1)+1,$V+2*$q+1,$V+2*$q+1,$V+2*$q,$V+2*($q-1));return $I.push($V+2*($q-1),$V+2*($q-1)+1,$V+1,$V+1,$V,$V+2*($q-1)),$$},$x}(),$kx=function(){function $s(){}return $T($s,"laya.webgl.shapes.Earcut"),$s.earcut=function($x,$I,$z){$z=$z||2;var $k,$l,$n,$a,$$,$w,$i,$F=$I&&$I.length,$b=$F?$I[0]*$z:$x.length,$T=$s.linkedList($x,0,$b,$z,!0),$_=[];if(!$T)return $_;if($F&&($T=$s.eliminateHoles($x,$I,$T,$z)),$x.length>80*$z){$k=$n=$x[0],$l=$a=$x[1];for(var $R=$z;$R<$b;$R+=$z)($$=$x[$R])<$k&&($k=$$),($w=$x[$R+1])<$l&&($l=$w),$n<$$&&($n=$$),$a<$w&&($a=$w);$i=0!==($i=Math.max($n-$k,$a-$l))?1/$i:0}return $s.earcutLinked($T,$_,$z,$k,$l,$i),$_},$s.linkedList=function($x,$I,$z,$k,$l){var $n,$a;if($l===0<$s.signedArea($x,$I,$z,$k))for($n=$I;$n<$z;$n+=$k)$a=$s.insertNode($n,$x[$n],$x[$n+1],$a);else for($n=$z-$k;$I<=$n;$n-=$k)$a=$s.insertNode($n,$x[$n],$x[$n+1],$a);return $a&&$s.equals($a,$a.next)&&($s.removeNode($a),$a=$a.next),$a},$s.filterPoints=function($x,$I){if(!$x)return $x;$I||($I=$x);var $z,$k=$x;do{if($z=!1,$k.steiner||!$s.equals($k,$k.next)&&0!==$s.area($k.prev,$k,$k.next))$k=$k.next;else{if($s.removeNode($k),($k=$I=$k.prev)===$k.next)break;$z=!0}}while($z||$k!==$I);return $I},$s.earcutLinked=function($x,$I,$z,$k,$l,$n,$a){if($x){!$a&&$n&&$s.indexCurve($x,$k,$l,$n);for(var $$,$w,$i=$x;$x.prev!==$x.next;)if($$=$x.prev,$w=$x.next,$n?$s.isEarHashed($x,$k,$l,$n):$s.isEar($x))$I.push($$.i/$z),$I.push($x.i/$z),$I.push($w.i/$z),$s.removeNode($x),$x=$w.next,$i=$w.next;else if(($x=$w)===$i){$a?1===$a?($x=$s.cureLocalIntersections($x,$I,$z),$s.earcutLinked($x,$I,$z,$k,$l,$n,2)):2===$a&&$s.splitEarcut($x,$I,$z,$k,$l,$n):$s.earcutLinked($s.filterPoints($x,null),$I,$z,$k,$l,$n,1);break}}},$s.isEar=function($x){var $I=$x.prev,$z=$x,$k=$x.next;if(0<=$s.area($I,$z,$k))return!1;for(var $l=$x.next.next;$l!==$x.prev;){if($s.pointInTriangle($I.x,$I.y,$z.x,$z.y,$k.x,$k.y,$l.x,$l.y)&&0<=$s.area($l.prev,$l,$l.next))return!1;$l=$l.next}return!0},$s.isEarHashed=function($x,$I,$z,$k){var $l=$x.prev,$n=$x,$a=$x.next;if(0<=$s.area($l,$n,$a))return!1;for(var $$=$l.x<$n.x?$l.x<$a.x?$l.x:$a.x:$n.x<$a.x?$n.x:$a.x,$w=$l.y<$n.y?$l.y<$a.y?$l.y:$a.y:$n.y<$a.y?$n.y:$a.y,$i=$l.x>$n.x?$l.x>$a.x?$l.x:$a.x:$n.x>$a.x?$n.x:$a.x,$F=$l.y>$n.y?$l.y>$a.y?$l.y:$a.y:$n.y>$a.y?$n.y:$a.y,$b=$s.zOrder($$,$w,$I,$z,$k),$T=$s.zOrder($i,$F,$I,$z,$k),$_=$x.nextZ;$_&&$_.z<=$T;){if($_!==$x.prev&&$_!==$x.next&&$s.pointInTriangle($l.x,$l.y,$n.x,$n.y,$a.x,$a.y,$_.x,$_.y)&&0<=$s.area($_.prev,$_,$_.next))return!1;$_=$_.nextZ}for($_=$x.prevZ;$_&&$_.z>=$b;){if($_!==$x.prev&&$_!==$x.next&&$s.pointInTriangle($l.x,$l.y,$n.x,$n.y,$a.x,$a.y,$_.x,$_.y)&&0<=$s.area($_.prev,$_,$_.next))return!1;$_=$_.prevZ}return!0},$s.cureLocalIntersections=function($x,$I,$z){var $k=$x;do{var $l=$k.prev,$n=$k.next.next;!$s.equals($l,$n)&&$s.intersects($l,$k,$k.next,$n)&&$s.locallyInside($l,$n)&&$s.locallyInside($n,$l)&&($I.push($l.i/$z),$I.push($k.i/$z),$I.push($n.i/$z),$s.removeNode($k),$s.removeNode($k.next),$k=$x=$n),$k=$k.next}while($k!==$x);return $k},$s.splitEarcut=function($x,$I,$z,$k,$l,$n){var $a=$x;do{for(var $$=$a.next.next;$$!==$a.prev;){if($a.i!==$$.i&&$s.isValidDiagonal($a,$$)){var $w=$s.splitPolygon($a,$$);return $a=$s.filterPoints($a,$a.next),$w=$s.filterPoints($w,$w.next),$s.earcutLinked($a,$I,$z,$k,$l,$n),void $s.earcutLinked($w,$I,$z,$k,$l,$n)}$$=$$.next}$a=$a.next}while($a!==$x)},$s.eliminateHoles=function($x,$I,$z,$k){var $l,$n,$a,$$,$w,$i=[];for($l=0,$n=$I.length;$l<$n;$l++)$a=$I[$l]*$k,$$=$l<$n-1?$I[$l+1]*$k:$x.length,($w=$s.linkedList($x,$a,$$,$k,!1))===$w.next&&($w.steiner=!0),$i.push($s.getLeftmost($w));for($i.sort($s.compareX),$l=0;$l<$i.length;$l++)$s.eliminateHole($i[$l],$z),$z=$s.filterPoints($z,$z.next);return $z},$s.compareX=function($x,$I){return $x.x-$I.x},$s.eliminateHole=function($x,$I){if($I=$s.findHoleBridge($x,$I)){var $z=$s.splitPolygon($I,$x);$s.filterPoints($z,$z.next)}},$s.findHoleBridge=function($x,$I){var $z,$k=$I,$l=$x.x,$n=$x.y,$a=-1/0;do{if($n<=$k.y&&$n>=$k.next.y&&$k.next.y!==$k.y){var $$=$k.x+($n-$k.y)*($k.next.x-$k.x)/($k.next.y-$k.y);if($$<=$l&&$a<$$){if(($a=$$)===$l){if($n===$k.y)return $k;if($n===$k.next.y)return $k.next}$z=$k.x<$k.next.x?$k:$k.next}}$k=$k.next}while($k!==$I);if(!$z)return null;if($l===$a)return $z.prev;var $w,$i=$z,$F=$z.x,$b=$z.y,$T=1/0;for($k=$z.next;$k!==$i;)$l>=$k.x&&$k.x>=$F&&$l!==$k.x&&$s.pointInTriangle($n<$b?$l:$a,$n,$F,$b,$n<$b?$a:$l,$n,$k.x,$k.y)&&(($w=Math.abs($n-$k.y)/($l-$k.x))<$T||$w===$T&&$k.x>$z.x)&&$s.locallyInside($k,$x)&&($z=$k,$T=$w),$k=$k.next;return $z},$s.indexCurve=function($x,$I,$z,$k){for(var $l=$x;null===$l.z&&($l.z=$s.zOrder($l.x,$l.y,$I,$z,$k)),$l.prevZ=$l.prev,$l.nextZ=$l.next,($l=$l.next)!==$x;);$l.prevZ.nextZ=null,$l.prevZ=null,$s.sortLinked($l)},$s.sortLinked=function($x){var $I,$z,$k,$l,$n,$a,$$,$w,$i=1;do{for($z=$x,$n=$x=null,$a=0;$z;){for($a++,$k=$z,$I=$$=0;$I<$i&&($$++,$k=$k.nextZ);$I++);for($w=$i;0<$$||0<$w&&$k;)0!==$$&&(0===$w||!$k||$z.z<=$k.z)?($z=($l=$z).nextZ,$$--):($k=($l=$k).nextZ,$w--),$n?$n.nextZ=$l:$x=$l,$l.prevZ=$n,$n=$l;$z=$k}$n.nextZ=null,$i*=2}while(1<$a);return $x},$s.zOrder=function($x,$I,$z,$k,$l){return($x=1431655765&(($x=858993459&(($x=252645135&(($x=16711935&(($x=32767*($x-$z)*$l)|$x<<8))|$x<<4))|$x<<2))|$x<<1))|($I=1431655765&(($I=858993459&(($I=252645135&(($I=16711935&(($I=32767*($I-$k)*$l)|$I<<8))|$I<<4))|$I<<2))|$I<<1))<<1},$s.getLeftmost=function($x){for(var $I=$x,$z=$x;$I.x<$z.x&&($z=$I),($I=$I.next)!==$x;);return $z},$s.pointInTriangle=function($x,$I,$z,$k,$l,$n,$a,$$){return 0<=($l-$a)*($I-$$)-($x-$a)*($n-$$)&&0<=($x-$a)*($k-$$)-($z-$a)*($I-$$)&&0<=($z-$a)*($n-$$)-($l-$a)*($k-$$)},$s.isValidDiagonal=function($x,$I){return $x.next.i!==$I.i&&$x.prev.i!==$I.i&&!$s.intersectsPolygon($x,$I)&&$s.locallyInside($x,$I)&&$s.locallyInside($I,$x)&&$s.middleInside($x,$I)},$s.area=function($x,$I,$z){return($I.y-$x.y)*($z.x-$I.x)-($I.x-$x.x)*($z.y-$I.y)},$s.equals=function($x,$I){return $x.x===$I.x&&$x.y===$I.y},$s.intersects=function($x,$I,$z,$k){return!!($s.equals($x,$I)&&$s.equals($z,$k)||$s.equals($x,$k)&&$s.equals($z,$I))||0<$s.area($x,$I,$z)!=0<$s.area($x,$I,$k)&&0<$s.area($z,$k,$x)!=0<$s.area($z,$k,$I)},$s.intersectsPolygon=function($x,$I){var $z=$x;do{if($z.i!==$x.i&&$z.next.i!==$x.i&&$z.i!==$I.i&&$z.next.i!==$I.i&&$s.intersects($z,$z.next,$x,$I))return!0;$z=$z.next}while($z!==$x);return!1},$s.locallyInside=function($x,$I){return $s.area($x.prev,$x,$x.next)<0?0<=$s.area($x,$I,$x.next)&&0<=$s.area($x,$x.prev,$I):$s.area($x,$I,$x.prev)<0||$s.area($x,$x.next,$I)<0},$s.middleInside=function($x,$I){for(var $z=$x,$k=!1,$l=($x.x+$I.x)/2,$n=($x.y+$I.y)/2;$z.y>$n!=$z.next.y>$n&&$z.next.y!==$z.y&&$l<($z.next.x-$z.x)*($n-$z.y)/($z.next.y-$z.y)+$z.x&&($k=!$k),($z=$z.next)!==$x;);return $k},$s.splitPolygon=function($x,$I){var $z=new $lx($x.i,$x.x,$x.y),$k=new $lx($I.i,$I.x,$I.y),$l=$x.next,$n=$I.prev;return($x.next=$I).prev=$x,($z.next=$l).prev=$z,($k.next=$z).prev=$k,($n.next=$k).prev=$n,$k},$s.insertNode=function($x,$I,$z,$k){var $l=new $lx($x,$I,$z);return $k?($l.next=$k.next,($l.prev=$k).next.prev=$l,$k.next=$l):($l.prev=$l).next=$l,$l},$s.removeNode=function($x){$x.next.prev=$x.prev,$x.prev.next=$x.next,$x.prevZ&&($x.prevZ.nextZ=$x.nextZ),$x.nextZ&&($x.nextZ.prevZ=$x.prevZ)},$s.signedArea=function($x,$I,$z,$k){for(var $l=0,$n=$I,$a=$z-$k;$n<$z;$n+=$k)$l+=($x[$a]-$x[$n])*($x[$n+1]+$x[$a+1]),$a=$n;return $l},$s}(),$lx=function(){function $x($x,$I,$z){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$x,this.x=$I,this.y=$z,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $T($x,"laya.webgl.shapes.EarcutNode"),$x}(),$nx=(function(){function $x($x,$I,$z,$k,$l,$n,$a){this.lineWidth=$x,this.lineColor=$I,this.lineAlpha=$z,this.fillColor=$k,this.fillAlpha=$l,this.shape=$a,this.fill=$n}$T($x,"laya.webgl.shapes.GeometryData");var $I=$x.prototype;$I.clone=function(){return new $x(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$I.getIndexData=function(){return null},$I.getVertexData=function(){return null},$I.destroy=function(){this.shape=null}}(),function(){function $x($x){if($x instanceof Float32Array)this.points=$x;else if($x instanceof Array){$x.length;this.points=new Float32Array($x)}}$T($x,"laya.webgl.shapes.Vertex");var $I=$x.prototype;$P.imps($I,{"laya.webgl.shapes.IShape":!0}),$I.getData=function($x,$I,$z){},$I.needUpdate=function($x){return!1},$I.rebuild=function($x){},$I.setMatrix=function($x){}}(),function(){function $w($x){void 0===$x&&($x=1e4),this._renderType=$x}$T($w,"laya.webgl.submit.Submit");var $x=$w.prototype;return $P.imps($x,{"laya.webgl.submit.ISubmit":!0}),$x.releaseRender=function(){var $x=$w._cache;($x[$x._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$x.getRenderType=function(){return this._renderType},$x.renderSubmit=function(){if(0===this._numEle)return 1;var $x=this.shaderValue.textureHost;if($x){var $I=$x.source;if(!$x.bitmap||!$I)return 1;this.shaderValue.texture=$I,$x.alphaTexture&&$x.alphaTexture.source&&(this.shaderValue.texture1=$x.alphaTexture.source)}this._vb.bind_upload(this._ib);var $z=$yx.mainContext;return this.shaderValue.upload(),$h.activeBlendFunction!==this._blendFn&&($z.enable(3042),this._blendFn($z),$h.activeBlendFunction=this._blendFn),$U.drawCall++,$U.trianglesFaces+=this._numEle/3,$z.drawElements(4,this._numEle,5123,this._startIdx),1},$w.__init__=function(){var $x=$w.RENDERBASE=new $w(-1);$x.shaderValue=new $Lx(0,0),$x.shaderValue.ALPHA=-1234},$w.createSubmit=function($x,$I,$z,$k,$l){var $n=$w._cache._length?$w._cache[--$w._cache._length]:new $w;null==$z&&(($z=$n._selfVb||($n._selfVb=$Gx.create(-1))).clear(),$k=0),$n._ib=$I,$n._vb=$z,$n._startIdx=$k*$sx.BYTES_PIDX,$n._numEle=0;var $a=$x._nBlendType;$n._blendFn=$x._targets?$h.targetFns[$a]:$h.fns[$a],$n.shaderValue=$l,$n.shaderValue.setValue($x._shader2D);var $$=$x._shader2D.filters;return $$&&$n.shaderValue.setFilters($$),$n},$w.createShape=function($x,$I,$z,$k,$l,$n){var $a=$w._cache._length?$w._cache[--$w._cache._length]:new $w;$a._ib=$I,$a._vb=$z,$a._numEle=$k,$a._startIdx=$l,$a.shaderValue=$n,$a.shaderValue.setValue($x._shader2D);var $$=$x._nBlendType;return $a._blendFn=$x._targets?$h.targetFns[$$]:$h.fns[$$],$a},$w.TYPE_2D=1e4,$w.TYPE_CANVAS=10003,$w.TYPE_CMDSETRT=10004,$w.TYPE_CUSTOM=10005,$w.TYPE_BLURRT=10006,$w.TYPE_CMDDESTORYPRERT=10007,$w.TYPE_DISABLESTENCIL=10008,$w.TYPE_OTHERIBVB=10009,$w.TYPE_PRIMITIVE=10010,$w.TYPE_RT=10011,$w.TYPE_BLUR_RT=10012,$w.TYPE_TARGET=10013,$w.TYPE_CHANGE_VALUE=10014,$w.TYPE_SHAPE=10015,$w.TYPE_TEXTURE=10016,$w.TYPE_FILLTEXTURE=10017,$w.RENDERBASE=null,$w._cache=(($w._cache=[])._length=0,$w._cache),$w}()),$ax=function(){function $k(){this.fun=null,this.args=null}$T($k,"laya.webgl.submit.SubmitCMD");var $x=$k.prototype;return $P.imps($x,{"laya.webgl.submit.ISubmit":!0}),$x.renderSubmit=function(){return this.fun.apply(null,this.args),1},$x.getRenderType=function(){return 0},$x.releaseRender=function(){var $x=$k._cache;$x[$x._length++]=this},$k.create=function($x,$I){var $z=$k._cache._length?$k._cache[--$k._cache._length]:new $k;return $z.fun=$I,$z.args=$x,$z},$k._cache=(($k._cache=[])._length=0,$k._cache),$k}(),$$x=function(){function $I(){this.variables={}}$T($I,"laya.webgl.submit.SubmitCMDScope");var $x=$I.prototype;return $x.getValue=function($x){return this.variables[$x]},$x.addValue=function($x,$I){return this.variables[$x]=$I},$x.setValue=function($x,$I){return this.variables.hasOwnProperty($x)?this.variables[$x]=$I:null},$x.clear=function(){for(var $x in this.variables)delete this.variables[$x]},$x.recycle=function(){this.clear(),$I.POOL.push(this)},$I.create=function(){var $x=$I.POOL.pop();return $x||($x=new $I),$x},$I.POOL=[],$I}(),$wx=function(){function $b(){this.offset=0,this.startIndex=0,this._mat=$K.create()}$T($b,"laya.webgl.submit.SubmitOtherIBVB");var $x=$b.prototype;return $P.imps($x,{"laya.webgl.submit.ISubmit":!0}),$x.releaseRender=function(){var $x=$b._cache;($x[$x._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$x.getRenderType=function(){return 10009},$x.renderSubmit=function(){var $x=this._shaderValue.textureHost;if($x){var $I=$x.source;if(!$x.bitmap||!$I)return 1;this._shaderValue.texture=$I}this._vb.bind_upload(this._ib);var $z=$fx.worldMatrix4,$k=$K.TEMP;$K.mulPre(this._mat,$z[0],$z[1],$z[4],$z[5],$z[12],$z[13],$k);var $l=$fx.worldMatrix4=$b.tempMatrix4;$l[0]=$k.a,$l[1]=$k.b,$l[4]=$k.c,$l[5]=$k.d,$l[12]=$k.tx,$l[13]=$k.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $n=$yx.mainContext;return $h.activeBlendFunction!==this._blendFn&&($n.enable(3042),this._blendFn($n),$h.activeBlendFunction=this._blendFn),$U.drawCall++,$U.trianglesFaces+=this._numEle/3,$n.drawElements(4,this._numEle,5123,this.startIndex),$fx.worldMatrix4=$z,$Yx.activeShader=null,1},$b.create=function($x,$I,$z,$k,$l,$n,$a,$$,$w){void 0===$w&&($w=0);var $i=$b._cache._length?$b._cache[--$b._cache._length]:new $b;$i._ib=$z,$i._vb=$I,$i._numEle=$k,$i._shader=$l,$i._shaderValue=$n;var $F=$x._nBlendType;switch($i._blendFn=$x._targets?$h.targetFns[$F]:$h.fns[$F],$w){case 0:$i.offset=0,$i.startIndex=$$/($sx.BYTES_PE*$I.vertexStride)*1.5,$i.startIndex*=$sx.BYTES_PIDX;break;case 1:$i.startIndex=$a,$i.offset=$$}return $i},$b._cache=(($b._cache=[])._length=0,$b._cache),$b.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$b}(),$ix=function(){function $z(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $O,this.screenRect=new $O}$T($z,"laya.webgl.submit.SubmitScissor");var $x=$z.prototype;return $P.imps($x,{"laya.webgl.submit.ISubmit":!0}),$x._scissor=function($x,$I,$z,$k){var $l=$fx.worldMatrix4,$n=$l[0],$a=$l[5],$$=$l[12],$w=$l[13];if($k*=$a,($z*=$n)<1||$k<1)return!1;var $i=($x=$x*$n+$$)+$z,$F=($I=$I*$a+$w)+$k;$x<0&&($z=$i-($x=0)),$I<0&&($k=$F-($I=0));var $b=$fx.worldClipRect;if($x=Math.max($x,$b.x),$I=Math.max($I,$b.y),$z=Math.min($i,$b.right)-$x,$k=Math.min($F,$b.bottom)-$I,$z<1||$k<1)return!1;var $T=$fx.worldScissorTest;return this.screenRect.copyFrom($b),$b.x=$x,$b.y=$I,$b.width=$z,$b.height=$k,$fx.worldScissorTest=!0,$I=$fx.height-$I-$k,$yx.mainContext.scissor($x,$I,$z,$k),$yx.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$T?($I=$fx.height-this.screenRect.y-this.screenRect.height,$yx.mainContext.scissor(this.screenRect.x,$I,this.screenRect.width,this.screenRect.height),$yx.mainContext.enable(3089)):($yx.mainContext.disable(3089),$fx.worldScissorTest=!1),$b.copyFrom(this.screenRect),!0},$x._scissorWithTagart=function($x,$I,$z,$k){if($z<1||$k<1)return!1;var $l=$x+$z,$n=$I+$k;$x<0&&($z=$l-($x=0)),$I<0&&($k=$n-($I=0));var $a=$fx.worldClipRect;if($x=Math.max($x,$a.x),$I=Math.max($I,$a.y),$z=Math.min($l,$a.right)-$x,$k=Math.min($n,$a.bottom)-$I,$z<1||$k<1)return!1;var $$=$fx.worldScissorTest;return this.screenRect.copyFrom($a),$fx.worldScissorTest=!0,$a.x=$x,$a.y=$I,$a.width=$z,$a.height=$k,$I=$fx.height-$I-$k,$yx.mainContext.scissor($x,$I,$z,$k),$yx.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$$?($I=$fx.height-this.screenRect.y-this.screenRect.height,$yx.mainContext.scissor(this.screenRect.x,$I,this.screenRect.width,this.screenRect.height),$yx.mainContext.enable(3089)):($yx.mainContext.disable(3089),$fx.worldScissorTest=!1),$a.copyFrom(this.screenRect),!0},$x.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$x.getRenderType=function(){return 0},$x.releaseRender=function(){var $x=$z._cache;($x[$x._length++]=this).context=null},$z.create=function($x){var $I=$z._cache._length?$z._cache[--$z._cache._length]:new $z;return $I.context=$x,$I},$z._cache=(($z._cache=[])._length=0,$z._cache),$z}(),$Fx=function(){function $w(){this.step=0,this.blendMode=null,this.level=0}$T($w,"laya.webgl.submit.SubmitStencil");var $x=$w.prototype;return $P.imps($x,{"laya.webgl.submit.ISubmit":!0}),$x.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$x.getRenderType=function(){return 0},$x.releaseRender=function(){var $x=$w._cache;$x[$x._length++]=this},$x.do1=function(){var $x=$yx.mainContext;$x.enable(2960),$x.clear(1024),$x.colorMask(!1,!1,!1,!1),$x.stencilFunc(514,this.level,255),$x.stencilOp(7680,7680,7682)},$x.do2=function(){var $x=$yx.mainContext;$x.stencilFunc(514,this.level+1,255),$x.colorMask(!0,!0,!0,!0),$x.stencilOp(7680,7680,7680)},$x.do3=function(){var $x=$yx.mainContext;$x.colorMask(!0,!0,!0,!0),$x.stencilOp(7680,7680,7680),$x.clear(1024),$x.disable(2960)},$x.do4=function(){var $x=$yx.mainContext;0==this.level&&($x.enable(2960),$x.clear(1024)),$x.colorMask(!1,!1,!1,!1),$x.stencilFunc(519,0,255),$x.stencilOp(7680,7680,7682)},$x.do5=function(){var $x=$yx.mainContext;$x.stencilFunc(514,this.level,255),$x.colorMask(!0,!0,!0,!0),$x.stencilOp(7680,7680,7680)},$x.do6=function(){var $x=$yx.mainContext;$h.targetFns[$h.TOINT[this.blendMode]]($x)},$x.do7=function(){var $x=$yx.mainContext;$x.colorMask(!1,!1,!1,!1),$x.stencilOp(7680,7680,7683)},$x.do8=function(){var $x=$yx.mainContext;$x.colorMask(!0,!0,!0,!0),$x.stencilFunc(514,this.level,255),$x.stencilOp(7680,7680,7680)},$w.restore=function($x,$I,$z,$k,$l){var $n;if(($x._renderKey=0)<$w._mask&&$w._mask--,0==$w._mask)$n=laya.webgl.submit.SubmitStencil.create(3),$x.addRenderObject($n),$x._curSubmit=$nx.RENDERBASE;else{$n=laya.webgl.submit.SubmitStencil.create(7),$x.addRenderObject($n);var $a=$x._vb;$a._byteLength;if($Nx.fillRectImgVb($a,null,$I.x,$I.y,$I.width,$I.height,$t.DEF_UV,$z,$k,$l,0,0)){$x._shader2D.glTexture=null;var $$=$x._curSubmit=$nx.createSubmit($x,$x._ib,$a,($a._byteLength-64)/32*3,$Lx.create(2,0));$$.shaderValue.ALPHA=1,$x._submits[$x._submits._length++]=$$,$x._curSubmit._numEle+=6,$x._curSubmit=$nx.RENDERBASE}else alert("clipRect calc stencil rect error");$n=laya.webgl.submit.SubmitStencil.create(8),$x.addRenderObject($n)}},$w.restore2=function($x,$I){var $z;($x._renderKey=0)<$w._mask&&$w._mask--,0==$w._mask?($z=laya.webgl.submit.SubmitStencil.create(3),$x.addRenderObject($z),$x._curSubmit=$nx.RENDERBASE):($z=laya.webgl.submit.SubmitStencil.create(7),$x.addRenderObject($z),$x._submits[$x._submits._length++]=$I,$z=laya.webgl.submit.SubmitStencil.create(8),$x.addRenderObject($z))},$w.create=function($x){var $I=$w._cache._length?$w._cache[--$w._cache._length]:new $w;return 5==($I.step=$x)&&++$w._mask,$I.level=$w._mask,$I},$w._cache=(($w._cache=[])._length=0,$w._cache),$w._mask=0,$w}(),$bx=function(){function $$(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$T($$,"laya.webgl.submit.SubmitTarget");var $x=$$.prototype;return $P.imps($x,{"laya.webgl.submit.ISubmit":!0}),$x.renderSubmit=function(){this._vb.bind_upload(this._ib);var $x=this.scope.getValue(this.proName);return $x&&(this.shaderValue.texture=$x.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$x.width,$x.height]),this.shaderValue.upload(),this.blend(),$U.drawCall++,$U.trianglesFaces+=this._numEle/3,$yx.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$x.blend=function(){if($h.activeBlendFunction!==$h.fns[this.blendType]){var $x=$yx.mainContext;$x.enable(3042),$h.fns[this.blendType]($x),$h.activeBlendFunction=$h.fns[this.blendType]}},$x.getRenderType=function(){return 0},$x.releaseRender=function(){var $x=$$._cache;($x[$x._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$$.create=function($x,$I,$z,$k,$l,$n){var $a=$$._cache._length?$$._cache[--$$._cache._length]:new $$;return $a._ib=$I,$a._vb=$z,$a.proName=$n,$a._startIdx=$k*$sx.BYTES_PIDX,$a._numEle=0,$a.blendType=$x._nBlendType,$a.shaderValue=$l,$a.shaderValue.setValue($x._shader2D),$a},$$._cache=(($$._cache=[])._length=0,$$._cache),$$}(),$Tx=function(){function $x(){this._sourceStr=null}$T($x,"laya.webgl.text.CharSegment");var $I=$x.prototype;return $P.imps($I,{"laya.webgl.text.ICharSegment":!0}),$I.textToSpit=function($x){this._sourceStr=$x},$I.getChar=function($x){return this._sourceStr.charAt($x)},$I.getCharCode=function($x){return this._sourceStr.charCodeAt($x)},$I.length=function(){return this._sourceStr.length},$x}(),$_x=function(){var $x;function $U(){}return $T($U,"laya.webgl.text.DrawText"),$U.__init__=function(){$U._charsTemp=new Array,$U._drawValue=new $x,$U._charSeg=new $Tx},$U.customCharSeg=function($x){$U._charSeg=$x},$U.getChar=function($x,$I,$z){var $k=$Ax.createOneChar($x,$z);return-1!=$I&&($U._charsCache[$I]=$k),$k},$U._drawSlow=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b,$T,$_,$R){var $s,$N,$D=$U._drawValue.value($n,$$,$w,$i,$T,$_,$R),$f=0,$m=0,$y=$U._charsTemp,$C=0,$P=NaN;if($k)for($y.length=$k.length,$f=0,$m=$k.length;$f<$m;$f++)($N=$k[$f])&&($P=$N.charNum+$D.txtID,$y[$f]=$s=$U._charsCache[$P]||$U.getChar($N.char,$P,$D),$s.active());else{var $v=$z instanceof laya.utils.WordText?$z.toString():$z;if($j.CharacterCache){$U._charSeg.textToSpit($v);var $L=$U._charSeg.length();for($f=0,$m=$y.length=$L;$f<$m;$f++)$P=$U._charSeg.getCharCode($f)+$D.txtID,$y[$f]=$s=$U._charsCache[$P]||$U.getChar($U._charSeg.getChar($f),$P,$D),$s.active(),$C+=$s.cw}else $y.length=0,($s=$U.getChar($v,-1,$D)).active(),$C+=$s.cw,$y[0]=$s}var $K=0;null!==$a&&"left"!==$a&&($K=-("center"==$a?$C/2:$C));var $E,$O,$S=NaN,$Z=0;if($k)for($f=0,$m=$y.length;$f<$m;$f++)$s=$y[$f],$N=$k[$f],$s&&$N&&!$s.isSpace&&($S=$s.borderSize,$E=$s.texture,$I._drawText($E,$F+$K+$N.x*$T-$S,$b+$N.y*$_-$S,$E.width,$E.height,$l,0,0,0,0));else{for($f=0,$m=$y.length;$f<$m;$f++)($s=$y[$f])&&!$s.isSpace&&($S=$s.borderSize,$E=$s.texture,$I._drawText($E,$F+$K-$S,$b-$S,$E.width,$E.height,$l,0,0,0,0),$x&&(($O=$x[$Z++])||($O=$x[$Z-1]=[]),$O[0]=$E,$O[1]=$K-$S,$O[2]=-$S)),$K+=$s.cw;$x&&($x.length=$Z)}},$U._drawFast=function($x,$I,$z,$k,$l){for(var $n,$a,$$=0,$w=$x.length;$$<$w;$$++)($n=($a=$x[$$])[0]).active(),$I._drawText($n,$k+$a[1],$l+$a[2],$n.width,$n.height,$z,0,0,0,0)},$U.drawText=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b){if(void 0===$b&&($b=0),!($I&&0===$I.length||$z&&0===$z.length)){var $T=$k.a,$_=$k.d;(0!==$k.b||0!==$k.c)&&($T=$_=1);var $R=1!==$T||1!==$_;if($R&&$P.stage.transform){var $s=$P.stage.transform;$R=$s.a===$T&&$s.d===$_}else $R=!1;if($R){var $N=($k=$k.copyTo($vx._tmpMatrix)).tx,$D=$k.ty;$k.scale(1/$T,1/$_),$k._checkTransform(),$i*=$T,$F*=$_,$i+=$N-$k.tx,$F+=$D-$k.ty}else $T=$_=1;if($z)$U._drawSlow(null,$x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$T,$_,$b);else{if(null===$I.toUpperCase){var $f=$T+1e5*$_,$m=$I;return void($m.changed||$m.id!==$f?($m.id=$f,$m.changed=!1,$U._drawSlow($m.save,$x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$T,$_,$b)):$U._drawFast($m.save,$x,$k,$i,$F))}var $y=$I+$l.toString()+$a+$$+$w+$T+$_+$n,$C=$U._textsCache[$y];$j.CharacterCache?$C?$U._drawFast($C,$x,$k,$i,$F):($U._textsCache.__length||($U._textsCache.__length=0),$U._textsCache.__length>$v.WebGLTextCacheCount&&(($U._textsCache={}).__length=0,$U._curPoolIndex=0),$U._textCachesPool[$U._curPoolIndex]?($C=$U._textsCache[$y]=$U._textCachesPool[$U._curPoolIndex]).length=0:$U._textCachesPool[$U._curPoolIndex]=$C=$U._textsCache[$y]=[],$U._textsCache.__length++,$U._curPoolIndex++,$U._drawSlow($C,$x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$T,$_,$b)):$U._drawSlow($C,$x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$T,$_,$b)}}},$U._charsTemp=null,$U._textCachesPool=[],$U._curPoolIndex=0,$U._charsCache={},$U._textsCache={},$U._drawValue=null,$U.d=[],$U._charSeg=null,$U.__init$=function(){$x=function(){function $w(){}return $T($w,""),$w.prototype.value=function($x,$I,$z,$k,$l,$n,$a){this.font=$x,this.fillColor=$I,this.borderColor=$z,this.lineWidth=$k,this.scaleX=$l,this.scaleY=$n,this.underLine=$a;var $$=$x.toString()+$l+$n+$k+($I?$I.toLowerCase():" ")+($z?$z.toLowerCase():" ")+$a;return this.txtID=$w._keymap[$$],this.txtID||(this.txtID=1e-7*++$w._keymapCount,$w._keymap[$$]=this.txtID),this},$w.clear=function(){$w._keymap={},$w._keymapCount=1},$w._keymap={},$w._keymapCount=1,$w}()},$U}(),$Rx=function(){function $l($x){this._index=0,this._size=14,this._italic=-2,$l._cache2=$l._cache2||[],this.setFont($x||"14px Arial")}$T($l,"laya.webgl.text.FontInContext");var $x=$l.prototype;return $x.setFont=function($x){var $I=$l._cache2[$x];if($I)this._words=$I[0],this._size=$I[1];else{this._words=$x.split(" ");for(var $z=0,$k=this._words.length;$z<$k;$z++)if(0<this._words[$z].indexOf("px")){this._index=$z;break}this._size=parseInt(this._words[this._index]),$l._cache2[$x]=[this._words,this._size]}this._text=null,this._italic=-2},$x.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$x.hasType=function($x){for(var $I=0,$z=this._words.length;$I<$z;$I++)if(this._words[$I]===$x)return $I;return-1},$x.removeType=function($x){for(var $I=0,$z=this._words.length;$I<$z;$I++)if(this._words[$I]===$x){this._words.splice($I,1),this._index>$I&&this._index--;break}this._text=null,this._italic=-2},$x.copyTo=function($x){return $x._text=this._text,$x._size=this._size,$x._index=this._index,$x._words=this._words.slice(),$x._italic=-2,$x},$x.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$k(0,$x,"size",function(){return this._size},function($x){this._size=$x,this._words[this._index]=$x+"px",this._text=null}),$l.create=function($x){var $I=$l._cache[$x];return $I||($I=$l._cache[$x]=new $l($x))},$l.EMPTY=new $l,$l._cache={},$l._cache2=null,$l}(),$sx=function(){function $x(){}return $T($x,"laya.webgl.utils.CONST3D2D"),$x.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$x.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$x.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$x._TMPARRAY=[],$x._OFFSETX=0,$x._OFFSETY=0,$a($x,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$x}(),$Nx=function(){function $R(){}return $T($R,"laya.webgl.utils.GlUtils"),$R.make2DProjection=function($x,$I,$z){return[2/$x,0,0,0,0,-2/$I,0,0,0,0,2/$z,0,-1,1,0,1]},$R.fillIBQuadrangle=function($x,$I){if(65535/4<$I)throw Error("IBQuadrangle count:"+$I+" must<:"+Math.floor(65535/4));$I=Math.floor($I),$x._resizeBuffer(6*($I+1)*2,!1),$x.byteLength=$x.bufferLength;for(var $z=$x.getUint16Array(),$k=0,$l=0;$l<$I;$l++)$z[$k++]=4*$l,$z[$k++]=4*$l+2,$z[$k++]=4*$l+1,$z[$k++]=4*$l,$z[$k++]=4*$l+3,$z[$k++]=4*$l+2;return $x.setNeedUpload(),!0},$R.expandIBQuadrangle=function($x,$I){$x.bufferLength>=6*$I*2||$R.fillIBQuadrangle($x,$I)},$R.mathCeilPowerOfTwo=function($x){return $x--,$x|=$x>>1,$x|=$x>>2,$x|=$x>>4,$x|=$x>>8,$x|=$x>>16,++$x},$R.fillQuadrangleImgVb=function($x,$I,$z,$k,$l,$n,$a,$$){var $w=16+($x._byteLength>>2);$x.byteLength=$w<<2;var $i=$x.getFloat32Array();$i[($w-=16)+2]=$l[0],$i[$w+3]=$l[1],$i[$w+6]=$l[2],$i[$w+7]=$l[3],$i[$w+10]=$l[4],$i[$w+11]=$l[5],$i[$w+14]=$l[6],$i[$w+15]=$l[7];var $F=$n.a,$b=$n.b,$T=$n.c,$_=$n.d;if(1!==$F||0!==$b||0!==$T||1!==$_){$n.bTransform=!0;var $R=$n.tx+$a,$s=$n.ty+$$;$i[$w]=($k[0]+$I)*$F+($k[1]+$z)*$T+$R,$i[$w+1]=($k[0]+$I)*$b+($k[1]+$z)*$_+$s,$i[$w+4]=($k[2]+$I)*$F+($k[3]+$z)*$T+$R,$i[$w+5]=($k[2]+$I)*$b+($k[3]+$z)*$_+$s,$i[$w+8]=($k[4]+$I)*$F+($k[5]+$z)*$T+$R,$i[$w+9]=($k[4]+$I)*$b+($k[5]+$z)*$_+$s,$i[$w+12]=($k[6]+$I)*$F+($k[7]+$z)*$T+$R,$i[$w+13]=($k[6]+$I)*$b+($k[7]+$z)*$_+$s}else $n.bTransform=!1,$I+=$n.tx+$a,$z+=$n.ty+$$,$i[$w]=$I+$k[0],$i[$w+1]=$z+$k[1],$i[$w+4]=$I+$k[2],$i[$w+5]=$z+$k[3],$i[$w+8]=$I+$k[4],$i[$w+9]=$z+$k[5],$i[$w+12]=$I+$k[6],$i[$w+13]=$z+$k[7];return $x._upload=!0},$R.fillTranglesVB=function($x,$I,$z,$k,$l,$n,$a){var $$=($x._byteLength>>2)+$k.length;$x.byteLength=$$<<2;var $w=$x.getFloat32Array();$$-=$k.length;for(var $i=$k.length,$F=$l.a,$b=$l.b,$T=$l.c,$_=$l.d,$R=0;$R<$i;$R+=4)if($w[$$+$R+2]=$k[$R+2],$w[$$+$R+3]=$k[$R+3],1!==$F||0!==$b||0!==$T||1!==$_){$l.bTransform=!0;var $s=$l.tx+$n,$N=$l.ty+$a;$w[$$+$R]=($k[$R]+$I)*$F+($k[$R+1]+$z)*$T+$s,$w[$$+$R+1]=($k[$R]+$I)*$b+($k[$R+1]+$z)*$_+$N}else $l.bTransform=!1,$I+=$l.tx+$n,$z+=$l.ty+$a,$w[$$+$R]=$I+$k[$R],$w[$$+$R+1]=$z+$k[$R+1];return $x._upload=!0},$R.copyPreImgVb=function($x,$I,$z){var $k=$x._byteLength>>2;$x.byteLength=$k+16<<2;for(var $l=$x.getFloat32Array(),$n=0,$a=$k-16;$n<4;$n++)$l[$k]=$l[$a]+$I,++$a,$l[++$k]=$l[$a]+$z,++$a,$l[++$k]=$l[$a],++$a,$l[++$k]=$l[$a],++$k,++$a;$x._upload=!0},$R.fillRectImgVb=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b,$T){void 0===$T&&($T=!1);var $_,$R,$s,$N,$D,$f,$m,$y,$C,$P,$v,$L,$K,$E,$O,$S,$Z=1,$U=$$.a,$X=$$.b,$d=$$.c,$j=$$.d,$t=$I&&$I.width<99999999;if(1!==$U||0!==$X||0!==$d||1!==$j?($$.bTransform=!0,0===$X&&0===$d&&($Z=23,$C=$l+$z,$P=$n+$k,$_=$U*$z+($v=$$.tx+$w),$s=$U*$C+$v,$R=$j*$k+($L=$$.ty+$i),$N=$j*$P+$L)):($Z=23,$$.bTransform=!1,$s=($_=$z+$$.tx+$w)+$l,$N=($R=$k+$$.ty+$i)+$n),$t&&($D=$I.x,$f=$I.y,$m=$I.width+$D,$y=$I.height+$f),1!==$Z){if(Math.min($_,$s)>=$m)return!1;if(Math.min($R,$N)>=$y)return!1;if(Math.max($s,$_)<=$D)return!1;if(Math.max($N,$R)<=$f)return!1}var $Y=$x._byteLength>>2;$x.byteLength=16+$Y<<2;var $c=$x.getFloat32Array();switch($c[2+$Y]=$a[0],$c[3+$Y]=$a[1],$c[6+$Y]=$a[2],$c[7+$Y]=$a[3],$c[10+$Y]=$a[4],$c[11+$Y]=$a[5],$c[14+$Y]=$a[6],$c[15+$Y]=$a[7],$Z){case 1:$v=$$.tx+$w,$L=$$.ty+$i;var $V=$U*$z,$W=$d*$k,$q=$j*$k,$o=$X*$z,$J=$U*($C=$l+$z),$h=$d*($P=$n+$k),$B=$j*$P,$e=$X*$C;$T?($K=$V+$W+$v,$O=Math.round($K)-$K,$E=$q+$o+$L,$S=Math.round($E)-$E,$c[$Y]=$K+$O,$c[1+$Y]=$E+$S,$c[4+$Y]=$J+$W+$v+$O,$c[5+$Y]=$q+$e+$L+$S,$c[8+$Y]=$J+$h+$v+$O,$c[9+$Y]=$B+$e+$L+$S,$c[12+$Y]=$V+$h+$v+$O,$c[13+$Y]=$B+$o+$L+$S):($c[$Y]=$V+$W+$v,$c[1+$Y]=$q+$o+$L,$c[4+$Y]=$J+$W+$v,$c[5+$Y]=$q+$e+$L,$c[8+$Y]=$J+$h+$v,$c[9+$Y]=$B+$e+$L,$c[12+$Y]=$V+$h+$v,$c[13+$Y]=$B+$o+$L);break;case 23:$T?($K=$_+$F,$O=Math.round($K)-$K,$E=$R,$S=Math.round($E)-$E,$c[$Y]=$K+$O,$c[1+$Y]=$E+$S,$c[4+$Y]=$s+$F+$O,$c[5+$Y]=$R+$S,$c[8+$Y]=$s+$O,$c[9+$Y]=$N+$S,$c[12+$Y]=$_+$O,$c[13+$Y]=$N+$S):($c[$Y]=$_+$F,$c[1+$Y]=$R,$c[4+$Y]=$s+$F,$c[5+$Y]=$R,$c[8+$Y]=$s,$c[9+$Y]=$N,$c[12+$Y]=$_,$c[13+$Y]=$N)}return $x._upload=!0},$R.fillLineVb=function($x,$I,$z,$k,$l,$n,$a,$$){var $w=.5*$a,$i=$R._fillLineArray,$F=-($k-$n),$b=$z-$l,$T=Math.sqrt($F*$F+$b*$b);$F/=$T,$b/=$T,$F*=$w,$b*=$w,$i[0]=$z-$F,$i[1]=$k-$b,$i[4]=$z+$F,$i[5]=$k+$b,$i[8]=$l+$F,$i[9]=$n+$b,$i[12]=$l-$F,$i[13]=$n-$b,$$&&$$.transformPointArray($i,$i);var $_=16+($x._byteLength>>2);return $x.byteLength=$_<<2,$x.insertData($i,$_-16),!0},$R._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$R}(),$Dx=(function(){function $w(){}$T($w,"laya.webgl.utils.MatirxArray"),$w.ArrayMul=function($x,$I,$z){if($x)if($I)for(var $k=NaN,$l=NaN,$n=NaN,$a=NaN,$$=0;$$<4;$$++)$k=$x[$$],$l=$x[$$+4],$n=$x[$$+8],$a=$x[$$+12],$z[$$]=$k*$I[0]+$l*$I[1]+$n*$I[2]+$a*$I[3],$z[$$+4]=$k*$I[4]+$l*$I[5]+$n*$I[6]+$a*$I[7],$z[$$+8]=$k*$I[8]+$l*$I[9]+$n*$I[10]+$a*$I[11],$z[$$+12]=$k*$I[12]+$l*$I[13]+$n*$I[14]+$a*$I[15];else $w.copyArray($x,$z);else $w.copyArray($I,$z)},$w.copyArray=function($x,$I){if($x&&$I)for(var $z=0;$z<$x.length;$z++)$I[$z]=$x[$z]}}(),function(){function $I($x,$I,$z){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$x,this._vb=new $Gx($x,35048),$I&&this._vb._resizeBuffer($I,!1),this._ib=new $Qx,$z&&this._ib._resizeBuffer($z,!1)}$T($I,"laya.webgl.utils.Mesh2D");var $x=$I.prototype;return $x.cloneWithNewVB=function(){var $x=new $I(this._stride,0,0);return $x._ib=this._ib,$x._quadNum=this._quadNum,$x._attribInfo=this._attribInfo,$x},$x.cloneWithNewVBIB=function(){var $x=new $I(this._stride,0,0);return $x._attribInfo=this._attribInfo,$x},$x.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$x.getVBR=function(){return this._vb},$x.getIBR=function(){return this._ib},$x.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$x.createQuadIB=function($x){this._quadNum=$x,this._ib._resizeBuffer(6*$x*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $I=this._ib.getUint16Array(),$z=0,$k=0,$l=0;$l<$x;$l++)$I[$z++]=$k,$I[$z++]=$k+2,$I[$z++]=$k+1,$I[$z++]=$k,$I[$z++]=$k+3,$I[$z++]=$k+2,$k+=4;this._ib.setNeedUpload()},$x.setAttributes=function($x){if(this._attribInfo=$x,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$x.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$x.releaseMesh=function(){},$x.destroy=function(){},$x.clearVB=function(){this._vb.clear()},$I._gvaoid=0,$I}()),$fx=function(){function $l(){}return $T($l,"laya.webgl.utils.RenderState2D"),$l.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$l.mat2MatArray=function($x,$I){var $z=$x,$k=$I;return $k[0]=$z.a,$k[1]=$z.b,$k[2]=$l.EMPTYMAT4_ARRAY[2],$k[3]=$l.EMPTYMAT4_ARRAY[3],$k[4]=$z.c,$k[5]=$z.d,$k[6]=$l.EMPTYMAT4_ARRAY[6],$k[7]=$l.EMPTYMAT4_ARRAY[7],$k[8]=$l.EMPTYMAT4_ARRAY[8],$k[9]=$l.EMPTYMAT4_ARRAY[9],$k[10]=$l.EMPTYMAT4_ARRAY[10],$k[11]=$l.EMPTYMAT4_ARRAY[11],$k[12]=$z.tx,$k[13]=$z.ty,$k[14]=$l.EMPTYMAT4_ARRAY[14],$k[15]=$l.EMPTYMAT4_ARRAY[15],$I},$l.restoreTempArray=function(){$l.TEMPMAT4_ARRAY[0]=1,$l.TEMPMAT4_ARRAY[1]=0,$l.TEMPMAT4_ARRAY[4]=0,$l.TEMPMAT4_ARRAY[5]=1,$l.TEMPMAT4_ARRAY[12]=0,$l.TEMPMAT4_ARRAY[13]=0},$l.clear=function(){$l.worldScissorTest=!1,$l.worldShaderDefines=null,$l.worldFilters=null,$l.worldAlpha=1,$l.worldClipRect.x=$l.worldClipRect.y=0,$l.worldClipRect.width=$l.width,$l.worldClipRect.height=$l.height,$l.curRenderTarget=null},$l._MAXSIZE=99999999,$l.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$l.worldMatrix4=$l.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$l.worldAlpha=1,$l.worldScissorTest=!1,$l.worldFilters=null,$l.worldShaderDefines=null,$l.curRenderTarget=null,$l.width=0,$l.height=0,$a($l,["worldMatrix",function(){return this.worldMatrix=new $K},"worldClipRect",function(){return this.worldClipRect=new $O(0,0,99999999,99999999)}]),$l}(),$mx=function(){var $f,$z;function $m($x,$I,$z,$k,$l){var $n=this;function $a($x){var $I=[],$z=new $f($I);return $n._compileToTree($z,$x.split("\n"),0,$I,$l),$z}var $$=$_.now();this._VS=$a($I),this._PS=$a($z),this._nameMap=$k,2<$_.now()-$$&&console.log("ShaderCompile use time:"+($_.now()-$$)+"  size:"+$I.length+"/"+$z.length)}$T($m,"laya.webgl.utils.ShaderCompile");var $x=$m.prototype;return $x._compileToTree=function($x,$I,$z,$k,$l){var $n,$a,$$,$w,$i,$F,$b,$T=0,$_=0,$R=0,$s=0;for($_=$z;$_<$I.length;$_++)if(!(($$=$I[$_]).length<1)&&0!==($T=$$.indexOf("//"))){if(0<=$T&&($$=$$.substr(0,$T)),$n=$b||new $f($k),$b=null,$n.text=$$,$n.noCompile=!0,0<=($T=$$.indexOf("#"))){for($w="#",$s=$T+1,$R=$$.length;$s<$R;$s++){var $N=$$.charAt($s);if(" "===$N||"\t"===$N||"\r"===$N||"\n"===$N||"?"===$N)break;$w+=$N}switch($n.name=$w){case"#ifdef":case"#ifndef":if($n.src=$$,$n.noCompile=null!=$$.match(/[!&|()=<>]/),$n.noCompile?console.log("function():Boolean{return "+$$.substr($T+$n.name.length)+"}"):($F=$$.replace(/^\s*/,"").split(/\s+/),$n.setCondition($F[1],"#ifdef"===$w?1:2),$n.text="//"+$n.text),$n.setParent($x),$x=$n,$l)for($F=$$.substr($s).split($m._splitToWordExps3),$s=0;$s<$F.length;$s++)($$=$F[$s]).length&&($l[$$]=!0);continue;case"#if":if($n.src=$$,$n.noCompile=!0,$n.setParent($x),$x=$n,$l)for($F=$$.substr($s).split($m._splitToWordExps3),$s=0;$s<$F.length;$s++)($$=$F[$s]).length&&"defined"!=$$&&($l[$$]=!0);continue;case"#else":$n.src=$$,$a=($x=$x.parent).childs[$x.childs.length-1],$n.noCompile=$a.noCompile,$n.noCompile||($n.condition=$a.condition,$n.conditionType=1==$a.conditionType?2:1,$n.text="//"+$n.text+" "+$a.text+" "+$n.conditionType),$n.setParent($x),$x=$n;continue;case"#endif":$a=($x=$x.parent).childs[$x.childs.length-1],$n.noCompile=$a.noCompile,$n.noCompile||($n.text="//"+$n.text),$n.setParent($x);continue;case"#include":$F=$m.splitToWords($$,null);var $D=$m.includes[$F[1]];if(!$D)throw"ShaderCompile error no this include file:"+$F[1];if(($T=$F[0].indexOf("?"))<0){$n.setParent($x),$$=$D.getWith("with"==$F[2]?$F[3]:null),this._compileToTree($n,$$.split("\n"),0,$k,$l),$n.text="";continue}$n.setCondition($F[0].substr($T+1),1),$n.text=$D.getWith("with"==$F[2]?$F[3]:null);break;case"#import":$i=($F=$m.splitToWords($$,null))[1],$k.push({node:$n,file:$m.includes[$i],ofs:$n.text.length});continue}}else{if(($a=$x.childs[$x.childs.length-1])&&!$a.name){0<$k.length&&$m.splitToWords($$,$a),$b=$n,$a.text+="\n"+$$;continue}0<$k.length&&$m.splitToWords($$,$n)}$n.setParent($x)}},$x.createShader=function($x,$I,$z){var $k={},$l="";if($x)for(var $n in $x)$l+="#define "+$n+"\n",$k[$n]=!0;var $a=this._VS.toscript($k,[]),$$=this._PS.toscript($k,[]);return($z||$ux.create)($l+$a.join("\n"),$l+$$.join("\n"),$I,this._nameMap)},$m._parseOne=function($x,$I,$z,$k,$l,$n){var $a={type:$m.shaderParamsMap[$z[$k+1]],name:$z[$k+2],size:isNaN(parseInt($z[$k+3]))?1:parseInt($z[$k+3])};return $n&&("attribute"==$l?$x.push($a):$I.push($a)),":"==$z[$k+3]&&($a.type=$z[$k+4],$k+=2),$k+=2},$m.addInclude=function($x,$I){if(!$I||0===$I.length)throw new Error("add shader include file err:"+$x);if($m.includes[$x])throw new Error("add shader include file err, has add:"+$x);$m.includes[$x]=new $z($I)},$m.preGetParams=function($x,$I){var $z=[$x,$I],$k={},$l=[],$n=[],$a={},$$=[];$k.attributes=$l,$k.uniforms=$n,$k.defines=$a;for(var $w=0,$i=0,$F=0;$F<2;$F++){$z[$F]=$z[$F].replace($m._removeAnnotation,"");var $b,$T=$z[$F].match($m._reg);for($w=0,$i=$T.length;$w<$i;$w++){var $_=$T[$w];if("attribute"==$_||"uniform"==$_)$w=$m._parseOne($l,$n,$T,$w,$_,!0);else{if("#define"==$_){$$[$_=$T[++$w]]=1;continue}if("#ifdef"==$_){$a[$b=$T[++$w]]=$a[$b]||[];for($w++;$w<$i;$w++)if("attribute"==($_=$T[$w])||"uniform"==$_)$w=$m._parseOne($l,$n,$T,$w,$_,$$[$b]);else if("#else"==$_)for($w++;$w<$i;$w++)if("attribute"==($_=$T[$w])||"uniform"==$_)$w=$m._parseOne($l,$n,$T,$w,$_,!$$[$b]);else if("#endif"==$_)break}}}}return $k},$m.splitToWords=function($x,$I){for(var $z,$k,$l=[],$n=-1,$a=0,$$=$x.length;$a<$$;$a++)if($z=$x.charAt($a),0<=" \t=+-*/&%!<>()'\",;".indexOf($z)){if(0<=$n&&1<$a-$n&&($k=$x.substr($n,$a-$n),$l.push($k)),'"'==$z||"'"==$z){var $w=$x.indexOf($z,$a+1);if($w<0)throw"Sharder err:"+$x;$l.push($x.substr($a+1,$w-$a-1)),$a=$w,$n=-1;continue}"("==$z&&$I&&0<$l.length&&($k=$l[$l.length-1]+";","vec4;main;".indexOf($k)<0&&($I.useFuns+=$k)),$n=-1}else $n<0&&($n=$a);return $n<$$&&1<$$-$n&&($k=$x.substr($n,$$-$n),$l.push($k)),$l},$m.IFDEF_NO=0,$m.IFDEF_YES=1,$m.IFDEF_ELSE=2,$m.IFDEF_PARENT=3,$m._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$m._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$m._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$m.includes={},$a($m,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$m.__init$=function(){$f=function(){function $z($x){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$x}$T($z,"");var $x=$z.prototype;return $x.setParent=function($x){$x.childs.push(this),this.z=$x.z+1,this.parent=$x},$x.setCondition=function($x,$I){$x&&(this.conditionType=$I,$x=$x.replace(/(\s*$)/g,""),this.condition=function(){return this[$x]},this.condition.__condition=$x)},$x.toscript=function($x,$I){return this._toscript($x,$I,++$z.__id)},$x._toscript=function($k,$l,$n){if(this.childs.length<1&&!this.text)return $l;$l.length;if(this.condition){var $x=!!this.condition.call($k);if(2===this.conditionType&&($x=!$x),!$x)return $l}if(this.text&&$l.push(this.text),0<this.childs.length&&this.childs.forEach(function($x,$I,$z){$x._toscript($k,$l,$n)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $I,$z=0,$a=this.includefiles.length;$z<$a;$z++)this.includefiles[$z].curUseID!=$n&&0<($I=this.includefiles[$z].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$z].curUseID=$n,$l[0]=$I+$l[0]);return $l},$z.__id=1,$z}(),$z=function(){function $x($x){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$x;for(var $I=0,$z=0,$k=0;!(($I=$x.indexOf("#begin",$I))<0);){for($k=$I+5;!(($k=$x.indexOf("#end",$k))<0)&&"i"===$x.charAt($k+4);)$k+=5;if($k<0)throw"add include err,no #end:"+$x;$z=$x.indexOf("\n",$I);var $l=$m.splitToWords($x.substr($I,$z-$I),null);"code"==$l[1]?this.codes[$l[2]]=$x.substr($z+1,$k-$z-1):"function"==$l[1]&&($z=$x.indexOf("function",$I),$z+="function".length,this.funs[$l[3]]=$x.substr($z+1,$k-$z-1),this.funnames+=$l[3]+";"),$I=$k+1}}$T($x,"");var $I=$x.prototype;return $I.getWith=function($x){var $I=$x?this.codes[$x]:this.script;if(!$I)throw"get with error:"+$x;return $I},$I.getFunsScript=function($x){var $I="";for(var $z in this.funs)0<=$x.indexOf($z+";")&&($I+=this.funs[$z]);return $I},$x}()},$m}(),$yx=function(){function $a(){}return $T($a,"laya.webgl.WebGL"),$a._uint8ArraySlice=function(){for(var $x=this.length,$I=new Uint8Array(this.length),$z=0;$z<$x;$z++)$I[$z]=this[$z];return $I},$a._float32ArraySlice=function(){for(var $x=this.length,$I=new Float32Array(this.length),$z=0;$z<$x;$z++)$I[$z]=this[$z];return $I},$a._uint16ArraySlice=function($x){var $I,$z=arguments,$k=0,$l=0;if(0===$z.length)for($k=this.length,$I=new Uint16Array($k),$l=0;$l<$k;$l++)$I[$l]=this[$l];else if(2===$z.length){var $n=$z[0],$a=$z[1];if($n<$a)for($k=$a-$n,$I=new Uint16Array($k),$l=$n;$l<$a;$l++)$I[$l-$n]=this[$l];else $I=new Uint16Array(0)}return $I},$a.expandContext=function(){var $x=$$.prototype,$I=CanvasRenderingContext2D.prototype;$I.fillTrangles=$x.fillTrangles,$rx.__int__(null),$I.setIBVB=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){void 0===$w&&($w=0),void 0===$i&&($i=0),null===$z&&(this._ib=this._ib||$Qx.QuadrangleIB,$z=this._ib,$Nx.expandIBQuadrangle($z,$k._byteLength/64+8)),this._setIBVB($x,$I,$z,$k,$l,$n,$a,$$,$w,$i)},$I.fillTrangles=function($x,$I,$z,$k,$l){this._curMat=this._curMat||$K.create(),this._vb=this._vb||$Gx.create(),this._ib||(this._ib=$Qx.create(),$Nx.fillIBQuadrangle(this._ib,$a/4));var $n=this._vb,$a=$k.length>>4;$Nx.fillTranglesVB($n,$I,$z,$k,$l||this._curMat,0,0),$Nx.expandIBQuadrangle(this._ib,$n._byteLength/64+8);var $$=new $Lx(1,0);$$.textureHost=$x;var $w=new $Mx("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$n._vertType=3,this._setIBVB($I,$z,this._ib,$n,6*$a,$l,$w,$$,0,0)}},$a.enable=function(){if($_.__init__(),$D.isConchApp&&!$D.isConchWebGL)return $C.skinAniSprite=function(){return new $xx},$a.expandContext(),!1;if($C.getWebGLContext=function($x){for(var $I,$z=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$k=0;$k<$z.length;$k++){try{$I=$x.getContext($z[$k],{stencil:$v.isStencil,alpha:$v.isAlpha,antialias:$v.isAntialias,premultipliedAlpha:$v.premultipliedAlpha,preserveDrawingBuffer:$v.preserveDrawingBuffer})}catch($x){}if($I)return $I}return null},null==($a.mainContext=$a.mainContext||$C.getWebGLContext($D._mainCanvas)))return!1;if($D.isWebGL)return!0;$N.create=function($x,$I){return new $xI($x,$I)},$I.create=function($x,$I,$z,$k,$l,$n,$a){return new $px($x,$I,$z,$k,$l,$n,$a)},$D.WebGL=$a,$D.isWebGL=!0,$_x.__init__(),$C.createRenderSprite=function($x,$I){return new $Kx($x,$I)},$C.createWebGLContext2D=function($x){return new $vx($x)},$C.changeWebGLSize=function($x,$I){laya.webgl.WebGL.onStageResize($x,$I)},$C.createGraphics=function(){return new $Px};var $x=$C.createFilterAction;return $C.createFilterAction=$x||function($x){return new $Ex},$C.clear=function($x){$fx.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $I=$D.context.ctx,$z=0==$I._submits._length||$v.preserveDrawingBuffer?$R.create($x)._color:$Z._wgColor;$z&&$I.clearBG($z[0],$z[1],$z[2],$z[3]),$fx.clear()},$C.addToAtlas=function($x,$I){void 0===$I&&($I=!1);var $z=$x.bitmap;$D.optimizeTextureMemory($x.url,$x)?$P.__typeof($z,"laya.webgl.resource.IMergeAtlasBitmap")&&$z.allowMerageInAtlas&&$z.on("recovered",$x,$x.addTextureToAtlas):$z.enableMerageInAtlas=!1},$C.isAtlas=function($x){return $x instanceof laya.webgl.atlas.AtlasWebGLCanvas},$o._enable(),$C.beginFlush=function(){for(var $x=$o.instance,$I=$x.getAtlaserCount(),$z=0;$z<$I;$z++){var $k=$x.getAtlaserByIndex($z).texture;$k._flashCacheImageNeedFlush&&$C.flashFlushImage($k)}},$C.drawToCanvas=function($x,$I,$z,$k,$l,$n){($z<=0||$k<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$z|=0,$k|=0,$l|=0,$n|=0;var $a=$cx.create($z,$k,6408,5121,0,!1);$a.start(),$a.clear(0,0,0,0),$D.context.clear(),$f.renders[$I]._fun($x,$D.context,$l,$fx.height-$k+$n),$D.context.flush(),$a.end();var $$=$a.getData(0,0,$z,$k);if($a.recycle(),$$.byteLength==$z*$k*4){var $w=new $ex;$w._canvas=$_.createElement("canvas"),$w.size($z,$k);var $i=$w._canvas.getContext("2d");$_.canvas.size($z,$k);var $F=$_.context,$b=$F.createImageData($z,$k);return $b.data.set(new Uint8ClampedArray($$.buffer)),$w._imgData=$b,$F.putImageData($b,0,0),$i.save(),$i.translate(0,$k),$i.scale(1,-1),$i.drawImage($_.canvas.source,0,0),$i.restore(),$w}console.log("drawToCanvas error: w:"+$z+",h:"+$k+",datalen:"+$$.byteLength)},$C.createFilterAction=function($x){var $I;switch($x){case 32:$I=new $Ex}return $I},$C.addTextureToAtlas=function($x){$x._uvID++,$o._atlasRestore++,$x.bitmap.enableMerageInAtlas&&$o.instance.addToAtlas($x)},$C.getTexturePixels=function($x,$I,$z,$k,$l){$D.context.ctx.clear();var $n=new $S;$n.graphics.drawTexture($x,-$I,-$z);var $a=$cx.create($k,$l);$a.start(),$a.clear(0,0,0,0),$n.render($D.context,0,0),$D.context.ctx.flush(),$a.end();for(var $$=$a.getData(0,0,$k,$l),$w=[],$i=0,$F=$l-1;0<=$F;$F--)for(var $b=0;$b<$k;$b++)$i=4*($F*$k+$b),$w.push($$[$i]),$w.push($$[$i+1]),$w.push($$[$i+2]),$w.push($$[$i+3]);return $w},$C.skinAniSprite=function(){return new $xx},$s.create=function($x,$I){var $z=new $ex;return $z._imgData=$I,$z.flipY=!1,$z},$L._filterStart=function($x,$I,$z,$k,$l){var $n=$x.getValue("bounds"),$a=$cx.create($n.width,$n.height);if($a.start(),$a.clear(0,0,0,0),$x.addValue("src",$a),$x.addValue("ScissorTest",$fx.worldScissorTest),$fx.worldScissorTest){var $$=new $O;$$.copyFrom($z.ctx._clipRect),$x.addValue("clipRect",$$),$fx.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$L._filterEnd=function($x,$I,$z,$k,$l){var $n=$x.getValue("bounds");$x.getValue("src").end();var $a=$cx.create($n.width,$n.height);$a.start(),$a.clear(0,0,0,0),$x.addValue("out",$a),$I._set$P("_filterCache",$a),$I._set$P("_isHaveGlowFilter",$x.getValue("_isHaveGlowFilter"))},$L._EndTarget=function($x,$I){if($x.getValue("src").recycle(),$x.getValue("out").end(),$x.getValue("ScissorTest")){$fx.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$I.ctx.save();var $z=$x.getValue("clipRect");$I.ctx.clipRect($z.x,$z.y,$z.width,$z.height)}},$L._useSrc=function($x){var $I=$x.getValue("out");$I.end(),($I=$x.getValue("src")).start(),$I.clear(0,0,0,0)},$L._endSrc=function($x){$x.getValue("src").end()},$L._useOut=function($x){var $I=$x.getValue("src");$I.end(),($I=$x.getValue("out")).start(),$I.clear(0,0,0,0)},$L._endOut=function($x){$x.getValue("out").end()},$L._recycleScope=function($x){$x.recycle()},$L._filter=function($x,$I,$z,$k){var $l=this._next;if($l){var $n,$a,$$=$x.filters,$w=$$.length;if(1==$w&&32==$$[0].type)return $I.ctx.save(),$I.ctx.setFilters([$$[0]]),$l._fun.call($l,$x,$I,$z,$k),void $I.ctx.restore();var $i=$$x.create(),$F=$E.TEMP,$b=$I.ctx._getTransformMatrix(),$T=$K.create();$b.copyTo($T);var $_=0,$R=0,$s=!1,$N=$x._$P._filterCache?$x._$P._filterCache:null;if(!$N||$x._repaint){$s=$x._isHaveGlowFilter(),$i.addValue("_isHaveGlowFilter",$s),$s&&($_=50,$R=25),($a=new $O).copyFrom($x.getSelfBounds()),$a.x+=$x.x,$a.y+=$x.y,$a.x-=$x.pivotX+4,$a.y-=$x.pivotY+4;var $D=$a.x,$f=$a.y;if($a.width+=$_+8,$a.height+=$_+8,$F.x=$a.x*$T.a+$a.y*$T.c,$F.y=$a.y*$T.d+$a.x*$T.b,$a.x=$F.x,$a.y=$F.y,$F.x=$a.width*$T.a+$a.height*$T.c,$F.y=$a.height*$T.d+$a.width*$T.b,$a.width=$F.x,$a.height=$F.y,$a.width<=0||$a.height<=0)return;$N&&$N.recycle(),$i.addValue("bounds",$a);var $m=$ax.create([$i,$x,$I,0,0],$L._filterStart);$I.addRenderObject($m),$I.ctx._renderKey=0,$I.ctx._shader2D.glTexture=null;var $y=$x.x-$D+$R,$C=$x.y-$f+$R;$l._fun.call($l,$x,$I,$y,$C),$m=$ax.create([$i,$x,$I,0,0],$L._filterEnd),$I.addRenderObject($m);for(var $P=0;$P<$w;$P++){0!=$P&&($m=$ax.create([$i],$L._useSrc),$I.addRenderObject($m),$n=$Lx.create(1,0),$K.TEMP.identity(),$I.ctx.drawTarget($i,0,0,$a.width,$a.height,$K.TEMP,"out",$n,null,$h.TOINT.overlay),$m=$ax.create([$i],$L._useOut),$I.addRenderObject($m)),$$[$P].action.apply3d($i,$x,$I,0,0)}$m=$ax.create([$i,$I],$L._EndTarget),$I.addRenderObject($m)}else{if(($s=!!$x._$P._isHaveGlowFilter&&$x._$P._isHaveGlowFilter)&&($_=50,$R=25),($a=$x.getBounds()).width<=0||$a.height<=0)return;$a.width+=$_,$a.height+=$_,$F.x=$a.x*$T.a+$a.y*$T.c,$F.y=$a.y*$T.d+$a.x*$T.b,$a.x=$F.x,$a.y=$F.y,$F.x=$a.width*$T.a+$a.height*$T.c,$F.y=$a.height*$T.d+$a.width*$T.b,$a.width=$F.x,$a.height=$F.y,$i.addValue("out",$N)}$z=$z-$R-$x.x,$k=$k-$R-$x.y,$F.setTo($z,$k),$T.transformPoint($F),$z=$F.x+$a.x,$k=$F.y+$a.y,$n=$Lx.create(1,0),$K.TEMP.identity(),$I.ctx.drawTarget($i,$z,$k,$a.width,$a.height,$K.TEMP,"out",$n,null,$h.TOINT.overlay),$m=$ax.create([$i],$L._recycleScope),$I.addRenderObject($m),$T.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$a._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$a._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$a._uint8ArraySlice),!0},$a.onStageResize=function($x,$I){null!=$a.mainContext&&($a.mainContext.viewport(0,0,$x,$I),$fx.width=$x,$fx.height=$I)},$a.onInvalidGLRes=function(){$o.instance.freeAll(),$y.releaseContentManagers(!0),$a.doNodeRepaint($P.stage),$a.mainContext.viewport(0,0,$fx.width,$fx.height),$P.stage.event("devicelost")},$a.doNodeRepaint=function($x){0==$x.numChildren&&$x.repaint();for(var $I=0;$I<$x.numChildren;$I++)$a.doNodeRepaint($x.getChildAt($I))},$a.init=function($x,$I,$z){$a.mainCanvas=$x,$s._createContext=function($x){return new $vx($x)},$ex._createContext=function($x){return new $vx($x)};var $k=laya.webgl.WebGL.mainContext;if(null!=$k.getShaderPrecisionFormat){var $l=$k.getShaderPrecisionFormat(35633,36338),$n=$k.getShaderPrecisionFormat(35632,36338);$a.shaderHighPrecision=!(!$l.precision||!$n.precision)}else $a.shaderHighPrecision=!1;if($a.compressAstc=$k.getExtension("WEBGL_compressed_texture_astc"),$a.compressAtc=$k.getExtension("WEBGL_compressed_texture_atc"),$a.compressEtc=$k.getExtension("WEBGL_compressed_texture_etc"),$a.compressEtc1=$k.getExtension("WEBGL_compressed_texture_etc1"),$a.compressPvrtc=$k.getExtension("WEBGL_compressed_texture_pvrtc"),$a.compressS3tc=$k.getExtension("WEBGL_compressed_texture_s3tc"),$a.compressS3tc_srgb=$k.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$a.compressAstc=$a.compressAstc?$a.compressAstc:{},$a.compressAtc=$a.compressAtc?$a.compressAtc:{},$a.compressEtc=$a.compressEtc?$a.compressEtc:{},$a.compressEtc1=$a.compressEtc1?$a.compressEtc1:{},$a.compressPvrtc=$a.compressPvrtc?$a.compressPvrtc:{},$a.compressS3tc=$a.compressS3tc?$a.compressS3tc:{},$a.compressS3tc_srgb=$a.compressS3tc_srgb?$a.compressS3tc_srgb:{},$k.deleteTexture1=$k.deleteTexture,$k.deleteTexture=function($x){$x==$Cx.curBindTexValue&&($Cx.curBindTexValue=null),$k.deleteTexture1($x)},$a.onStageResize($I,$z),null==$a.mainContext)throw new Error("webGL getContext err!");$d.__init__(),$o.__init__(),$Sx.__init__(),$nx.__init__(),$vx.__init__(),$Lx.__init__(),$Q.__init__(),$rx.__int__($k),$h._init_($k),$D.isConchApp&&conch.setOnInvalidGLRes($a.onInvalidGLRes)},$a.mainCanvas=null,$a.antialias=!0,$a.shaderHighPrecision=!1,$a._bg_null=[0,0,0,0],$a}(),$Cx=function(){function $k(){}return $T($k,"laya.webgl.WebGLContext"),$k.UseProgram=function($x){return $k._useProgram!==$x&&($yx.mainContext.useProgram($x),$k._useProgram=$x,!0)},$k.setDepthTest=function($x,$I){$I!==$k._depthTest&&(($k._depthTest=$I)?$x.enable(2929):$x.disable(2929))},$k.setDepthMask=function($x,$I){$I!==$k._depthMask&&($k._depthMask=$I,$x.depthMask($I))},$k.setDepthFunc=function($x,$I){$I!==$k._depthFunc&&($k._depthFunc=$I,$x.depthFunc($I))},$k.setBlend=function($x,$I){$I!==$k._blend&&(($k._blend=$I)?$x.enable(3042):$x.disable(3042))},$k.setBlendFunc=function($x,$I,$z){($I!==$k._sFactor||$z!==$k._dFactor)&&($k._sFactor=$I,$k._dFactor=$z,$x.blendFunc($I,$z))},$k.setCullFace=function($x,$I){$I!==$k._cullFace&&(($k._cullFace=$I)?$x.enable(2884):$x.disable(2884))},$k.setFrontFace=function($x,$I){$I!==$k._frontFace&&($k._frontFace=$I,$x.frontFace($I))},$k.bindTexture=function($x,$I,$z){$x.bindTexture($I,$z),$k.curBindTexTarget=$I,$k.curBindTexValue=$z},$k.DEPTH_BUFFER_BIT=256,$k.STENCIL_BUFFER_BIT=1024,$k.COLOR_BUFFER_BIT=16384,$k.POINTS=0,$k.LINES=1,$k.LINE_LOOP=2,$k.LINE_STRIP=3,$k.TRIANGLES=4,$k.TRIANGLE_STRIP=5,$k.TRIANGLE_FAN=6,$k.ZERO=0,$k.ONE=1,$k.SRC_COLOR=768,$k.ONE_MINUS_SRC_COLOR=769,$k.SRC_ALPHA=770,$k.ONE_MINUS_SRC_ALPHA=771,$k.DST_ALPHA=772,$k.ONE_MINUS_DST_ALPHA=773,$k.DST_COLOR=774,$k.ONE_MINUS_DST_COLOR=775,$k.SRC_ALPHA_SATURATE=776,$k.FUNC_ADD=32774,$k.BLEND_EQUATION=32777,$k.BLEND_EQUATION_RGB=32777,$k.BLEND_EQUATION_ALPHA=34877,$k.FUNC_SUBTRACT=32778,$k.FUNC_REVERSE_SUBTRACT=32779,$k.BLEND_DST_RGB=32968,$k.BLEND_SRC_RGB=32969,$k.BLEND_DST_ALPHA=32970,$k.BLEND_SRC_ALPHA=32971,$k.CONSTANT_COLOR=32769,$k.ONE_MINUS_CONSTANT_COLOR=32770,$k.CONSTANT_ALPHA=32771,$k.ONE_MINUS_CONSTANT_ALPHA=32772,$k.BLEND_COLOR=32773,$k.ARRAY_BUFFER=34962,$k.ELEMENT_ARRAY_BUFFER=34963,$k.ARRAY_BUFFER_BINDING=34964,$k.ELEMENT_ARRAY_BUFFER_BINDING=34965,$k.STREAM_DRAW=35040,$k.STATIC_DRAW=35044,$k.DYNAMIC_DRAW=35048,$k.BUFFER_SIZE=34660,$k.BUFFER_USAGE=34661,$k.CURRENT_VERTEX_ATTRIB=34342,$k.FRONT=1028,$k.BACK=1029,$k.CULL_FACE=2884,$k.FRONT_AND_BACK=1032,$k.BLEND=3042,$k.DITHER=3024,$k.STENCIL_TEST=2960,$k.DEPTH_TEST=2929,$k.SCISSOR_TEST=3089,$k.POLYGON_OFFSET_FILL=32823,$k.SAMPLE_ALPHA_TO_COVERAGE=32926,$k.SAMPLE_COVERAGE=32928,$k.NO_ERROR=0,$k.INVALID_ENUM=1280,$k.INVALID_VALUE=1281,$k.INVALID_OPERATION=1282,$k.OUT_OF_MEMORY=1285,$k.CW=2304,$k.CCW=2305,$k.LINE_WIDTH=2849,$k.ALIASED_POINT_SIZE_RANGE=33901,$k.ALIASED_LINE_WIDTH_RANGE=33902,$k.CULL_FACE_MODE=2885,$k.FRONT_FACE=2886,$k.DEPTH_RANGE=2928,$k.DEPTH_WRITEMASK=2930,$k.DEPTH_CLEAR_VALUE=2931,$k.DEPTH_FUNC=2932,$k.STENCIL_CLEAR_VALUE=2961,$k.STENCIL_FUNC=2962,$k.STENCIL_FAIL=2964,$k.STENCIL_PASS_DEPTH_FAIL=2965,$k.STENCIL_PASS_DEPTH_PASS=2966,$k.STENCIL_REF=2967,$k.STENCIL_VALUE_MASK=2963,$k.STENCIL_WRITEMASK=2968,$k.STENCIL_BACK_FUNC=34816,$k.STENCIL_BACK_FAIL=34817,$k.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$k.STENCIL_BACK_PASS_DEPTH_PASS=34819,$k.STENCIL_BACK_REF=36003,$k.STENCIL_BACK_VALUE_MASK=36004,$k.STENCIL_BACK_WRITEMASK=36005,$k.VIEWPORT=2978,$k.SCISSOR_BOX=3088,$k.COLOR_CLEAR_VALUE=3106,$k.COLOR_WRITEMASK=3107,$k.UNPACK_ALIGNMENT=3317,$k.PACK_ALIGNMENT=3333,$k.MAX_TEXTURE_SIZE=3379,$k.MAX_VIEWPORT_DIMS=3386,$k.SUBPIXEL_BITS=3408,$k.RED_BITS=3410,$k.GREEN_BITS=3411,$k.BLUE_BITS=3412,$k.ALPHA_BITS=3413,$k.DEPTH_BITS=3414,$k.STENCIL_BITS=3415,$k.POLYGON_OFFSET_UNITS=10752,$k.POLYGON_OFFSET_FACTOR=32824,$k.TEXTURE_BINDING_2D=32873,$k.SAMPLE_BUFFERS=32936,$k.SAMPLES=32937,$k.SAMPLE_COVERAGE_VALUE=32938,$k.SAMPLE_COVERAGE_INVERT=32939,$k.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$k.COMPRESSED_TEXTURE_FORMATS=34467,$k.DONT_CARE=4352,$k.FASTEST=4353,$k.NICEST=4354,$k.GENERATE_MIPMAP_HINT=33170,$k.BYTE=5120,$k.UNSIGNED_BYTE=5121,$k.SHORT=5122,$k.UNSIGNED_SHORT=5123,$k.INT=5124,$k.UNSIGNED_INT=5125,$k.FLOAT=5126,$k.DEPTH_COMPONENT=6402,$k.ALPHA=6406,$k.RGB=6407,$k.RGBA=6408,$k.LUMINANCE=6409,$k.LUMINANCE_ALPHA=6410,$k.UNSIGNED_SHORT_4_4_4_4=32819,$k.UNSIGNED_SHORT_5_5_5_1=32820,$k.UNSIGNED_SHORT_5_6_5=33635,$k.FRAGMENT_SHADER=35632,$k.VERTEX_SHADER=35633,$k.MAX_VERTEX_ATTRIBS=34921,$k.MAX_VERTEX_UNIFORM_VECTORS=36347,$k.MAX_VARYING_VECTORS=36348,$k.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$k.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$k.MAX_TEXTURE_IMAGE_UNITS=34930,$k.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$k.SHADER_TYPE=35663,$k.DELETE_STATUS=35712,$k.LINK_STATUS=35714,$k.VALIDATE_STATUS=35715,$k.ATTACHED_SHADERS=35717,$k.ACTIVE_UNIFORMS=35718,$k.ACTIVE_ATTRIBUTES=35721,$k.SHADING_LANGUAGE_VERSION=35724,$k.CURRENT_PROGRAM=35725,$k.NEVER=512,$k.LESS=513,$k.EQUAL=514,$k.LEQUAL=515,$k.GREATER=516,$k.NOTEQUAL=517,$k.GEQUAL=518,$k.ALWAYS=519,$k.KEEP=7680,$k.REPLACE=7681,$k.INCR=7682,$k.DECR=7683,$k.INVERT=5386,$k.INCR_WRAP=34055,$k.DECR_WRAP=34056,$k.VENDOR=7936,$k.RENDERER=7937,$k.VERSION=7938,$k.NEAREST=9728,$k.LINEAR=9729,$k.NEAREST_MIPMAP_NEAREST=9984,$k.LINEAR_MIPMAP_NEAREST=9985,$k.NEAREST_MIPMAP_LINEAR=9986,$k.LINEAR_MIPMAP_LINEAR=9987,$k.TEXTURE_MAG_FILTER=10240,$k.TEXTURE_MIN_FILTER=10241,$k.TEXTURE_WRAP_S=10242,$k.TEXTURE_WRAP_T=10243,$k.TEXTURE_2D=3553,$k.TEXTURE=5890,$k.TEXTURE_CUBE_MAP=34067,$k.TEXTURE_BINDING_CUBE_MAP=34068,$k.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$k.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$k.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$k.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$k.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$k.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$k.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$k.TEXTURE0=33984,$k.TEXTURE1=33985,$k.TEXTURE2=33986,$k.TEXTURE3=33987,$k.TEXTURE4=33988,$k.TEXTURE5=33989,$k.TEXTURE6=33990,$k.TEXTURE7=33991,$k.TEXTURE8=33992,$k.TEXTURE9=33993,$k.TEXTURE10=33994,$k.TEXTURE11=33995,$k.TEXTURE12=33996,$k.TEXTURE13=33997,$k.TEXTURE14=33998,$k.TEXTURE15=33999,$k.TEXTURE16=34e3,$k.TEXTURE17=34001,$k.TEXTURE18=34002,$k.TEXTURE19=34003,$k.TEXTURE20=34004,$k.TEXTURE21=34005,$k.TEXTURE22=34006,$k.TEXTURE23=34007,$k.TEXTURE24=34008,$k.TEXTURE25=34009,$k.TEXTURE26=34010,$k.TEXTURE27=34011,$k.TEXTURE28=34012,$k.TEXTURE29=34013,$k.TEXTURE30=34014,$k.TEXTURE31=34015,$k.ACTIVE_TEXTURE=34016,$k.REPEAT=10497,$k.CLAMP_TO_EDGE=33071,$k.MIRRORED_REPEAT=33648,$k.FLOAT_VEC2=35664,$k.FLOAT_VEC3=35665,$k.FLOAT_VEC4=35666,$k.INT_VEC2=35667,$k.INT_VEC3=35668,$k.INT_VEC4=35669,$k.BOOL=35670,$k.BOOL_VEC2=35671,$k.BOOL_VEC3=35672,$k.BOOL_VEC4=35673,$k.FLOAT_MAT2=35674,$k.FLOAT_MAT3=35675,$k.FLOAT_MAT4=35676,$k.SAMPLER_2D=35678,$k.SAMPLER_CUBE=35680,$k.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$k.VERTEX_ATTRIB_ARRAY_SIZE=34339,$k.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$k.VERTEX_ATTRIB_ARRAY_TYPE=34341,$k.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$k.VERTEX_ATTRIB_ARRAY_POINTER=34373,$k.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$k.COMPILE_STATUS=35713,$k.LOW_FLOAT=36336,$k.MEDIUM_FLOAT=36337,$k.HIGH_FLOAT=36338,$k.LOW_INT=36339,$k.MEDIUM_INT=36340,$k.HIGH_INT=36341,$k.FRAMEBUFFER=36160,$k.RENDERBUFFER=36161,$k.RGBA4=32854,$k.RGB5_A1=32855,$k.RGB565=36194,$k.DEPTH_COMPONENT16=33189,$k.STENCIL_INDEX=6401,$k.STENCIL_INDEX8=36168,$k.DEPTH_STENCIL=34041,$k.RENDERBUFFER_WIDTH=36162,$k.RENDERBUFFER_HEIGHT=36163,$k.RENDERBUFFER_INTERNAL_FORMAT=36164,$k.RENDERBUFFER_RED_SIZE=36176,$k.RENDERBUFFER_GREEN_SIZE=36177,$k.RENDERBUFFER_BLUE_SIZE=36178,$k.RENDERBUFFER_ALPHA_SIZE=36179,$k.RENDERBUFFER_DEPTH_SIZE=36180,$k.RENDERBUFFER_STENCIL_SIZE=36181,$k.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$k.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$k.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$k.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$k.COLOR_ATTACHMENT0=36064,$k.DEPTH_ATTACHMENT=36096,$k.STENCIL_ATTACHMENT=36128,$k.DEPTH_STENCIL_ATTACHMENT=33306,$k.NONE=0,$k.FRAMEBUFFER_COMPLETE=36053,$k.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$k.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$k.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$k.FRAMEBUFFER_UNSUPPORTED=36061,$k.FRAMEBUFFER_BINDING=36006,$k.RENDERBUFFER_BINDING=36007,$k.MAX_RENDERBUFFER_SIZE=34024,$k.INVALID_FRAMEBUFFER_OPERATION=1286,$k.UNPACK_FLIP_Y_WEBGL=37440,$k.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$k.CONTEXT_LOST_WEBGL=37442,$k.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$k.BROWSER_DEFAULT_WEBGL=37444,$k._useProgram=null,$k._depthTest=!0,$k._depthMask=!0,$k._blend=!1,$k._cullFace=!1,$k.curBindTexTarget=null,$k.curBindTexValue=null,$a($k,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$k}(),$Px=function($x){function $I(){$I.__super.call(this)}$T($I,"laya.webgl.display.GraphicsGL",$i);var $z=$I.prototype;return $z.setShader=function($x){this._saveToCmd($D.context._setShader,[$x])},$z.setIBVB=function($x,$I,$z,$k,$l,$n){this._saveToCmd($D.context._setIBVB,[$x,$I,$z,$k,$l,$n])},$z.drawParticle=function($x,$I,$z){var $k=$C.createParticleTemplate2D($z);$k.x=$x,$k.y=$I,this._saveToCmd($D.context._drawParticle,[$k])},$I}(),$vx=function($x){var $z;function $q($x){this._x=0,this._y=0,this._id=++$q._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$q.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$q.MAXCLIPRECT,this.mOutPoint,this._canvas=$x,this._canvas._addReference(),$q._contextcount++,$D.isFlash?(this._ib=$Qx.create(35044),$Nx.fillIBQuadrangle(this._ib,16)):this._ib=$Qx.QuadrangleIB,this.clear()}$T($q,"laya.webgl.canvas.WebGLContext2D",$$);var $I=$q.prototype;return $I.setIsMainContext=function(){this._isMain=!0},$I.clearBG=function($x,$I,$z,$k){var $l=$yx.mainContext;$l.clearColor($x,$I,$z,$k),$l.clear(16384)},$I._getSubmits=function(){return this._submits},$I._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $x=0,$I=this._submits._length;$x<$I;$x++)this._submits[$x].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$I.destroy=function(){--$q._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$Qx.QuadrangleIB&&this._ib.releaseResource()},$I.clear=function(){this._submits||(this._other=$z.DEFAULT,this._curMat=$K.create(),this._vb=$Gx.create(-1),this._submits=[],this._save=[$u.Create(this)],this._save.length=10,this._shader2D=new $Q,this._triangleMesh=$tx.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$z.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$q.MAXCLIPRECT,this._curSubmit=$nx.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$B.DEFAULT;for(var $x=0,$I=this._submits._length;$x<$I;$x++)this._submits[$x].releaseRender(),this._submits[$x]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$I.size=function($x,$I){if(this._width!=$x||this._height!=$I)if(0==$x||0==$I){0!=this._vb._byteLength&&(this._width=$x,this._height=$I,this._vb.clear(),this._vb.upload());for(var $z=0,$k=this._submits._length;$z<$k;$z++)this._submits[$z].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$x,this._height=$I,this._targets&&this._targets.size($x,$I),this._canvas.memorySize-=this._canvas.memorySize;0===$x&&0===$I&&this._releaseMem()},$I._getTransformMatrix=function(){return this._curMat},$I.translate=function($x,$I){0===$x&&0===$I||($g.save(this),this._curMat.bTransform&&($r.save(this),this._curMat.transformPointN($E.TEMP.setTo($x,$I)),$x=$E.TEMP.x,$I=$E.TEMP.y),this._x+=$x,this._y+=$I)},$I.save=function(){this._save[this._save._length++]=$u.Create(this)},$I.restore=function(){var $x=this._save._length;if(!($x<1))for(var $I=$x-1;0<=$I;$I--){var $z=this._save[$I];if($z.restore(this),$z.isSaveMark())return void(this._save._length=$I)}},$I._fillText=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){void 0===$i&&($i=0);var $F=this._shader2D,$b=this._curSubmit.shaderValue,$T=$l?$Rx.create($l):this._other.font;if($o.enabled)$F.ALPHA!==$b.ALPHA&&($F.glTexture=null),$_x.drawText(this,$x,$I,this._curMat,$T,$w||this._other.textAlign,$n,$a,$$,$z,$k,$i);else{this._shader2D.defines.getValue();var $_=$n?$R.create($n)._color:$F.colorAdd;$F.ALPHA===$b.ALPHA&&$_===$F.colorAdd&&$b.colorAdd===$F.colorAdd||($F.glTexture=null,$F.colorAdd=$_),$_x.drawText(this,$x,$I,this._curMat,$T,$w||this._other.textAlign,$n,$a,$$,$z,$k,$i)}},$I.fillWords=function($x,$I,$z,$k,$l,$n){this._fillText(null,$x,$I,$z,$k,$l,null,-1,null,$n)},$I.fillBorderWords=function($x,$I,$z,$k,$l,$n,$a){this._fillBorderText(null,$x,$I,$z,$k,$l,$n,$a,null)},$I.fillText=function($x,$I,$z,$k,$l,$n){this._fillText($x,null,$I,$z,$k,$l,null,-1,$n)},$I.strokeText=function($x,$I,$z,$k,$l,$n,$a){this._fillText($x,null,$I,$z,$k,null,$l,$n||1,$a)},$I.fillBorderText=function($x,$I,$z,$k,$l,$n,$a,$$){this._fillBorderText($x,null,$I,$z,$k,$l,$n,$a,$$)},$I._fillBorderText=function($x,$I,$z,$k,$l,$n,$a,$$,$w){if(!$o.enabled)return this._fillText($x,$I,$z,$k,$l,null,$a,$$||1,$w),void this._fillText($x,$I,$z,$k,$l,$n,null,-1,$w);var $i=this._shader2D,$F=this._curSubmit.shaderValue;$i.ALPHA!==$F.ALPHA&&($i.glTexture=null);var $b=$l?($q._fontTemp.setFont($l),$q._fontTemp):this._other.font;$_x.drawText(this,$x,$I,this._curMat,$b,$w||this._other.textAlign,$n,$a,$$||1,$z,$k,0)},$I.fillRect=function($x,$I,$z,$k,$l){var $n=this._vb;if($Nx.fillRectImgVb($n,this._clipRect,$x,$I,$z,$k,$t.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $a=this._shader2D.fillStyle;$l&&(this._shader2D.fillStyle=$B.create($l));var $$=this._shader2D,$w=this._curSubmit.shaderValue;if($$.fillStyle!==$w.fillStyle||$$.ALPHA!==$w.ALPHA){$$.glTexture=null;var $i=this._curSubmit=$nx.createSubmit(this,this._ib,$n,($n._byteLength-64)/32*3,$Lx.create(2,0));$i.shaderValue.color=$$.fillStyle._color._color,$i.shaderValue.ALPHA=$$.ALPHA,this._submits[this._submits._length++]=$i}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$a}},$I.fillTexture=function($x,$I,$z,$k,$l,$n,$a,$$){if($x.loaded&&$x.bitmap&&$x.source){var $w=this._vb,$i=$x.bitmap.width,$F=$x.bitmap.height,$b=$x.uv,$T=$a.x%$x.width,$_=$a.y%$x.height;if($i!=$$.w||$F!=$$.h){if(!$$.w&&!$$.h)switch($$.oy=$$.ox=0,$n){case"repeat":$$.width=$k,$$.height=$l;break;case"repeat-x":$$.width=$k,$_<0?$x.height+$_>$l?$$.height=$l:$$.height=$x.height+$_:($$.oy=$_,$x.height+$_>$l?$$.height=$l-$_:$$.height=$x.height);break;case"repeat-y":$T<0?$x.width+$T>$k?$$.width=$k:$$.width=$x.width+$T:($$.ox=$T,$x.width+$T>$k?$$.width=$k-$T:$$.width=$x.width),$$.height=$l;break;case"no-repeat":$T<0?$x.width+$T>$k?$$.width=$k:$$.width=$x.width+$T:($$.ox=$T,$x.width+$T>$k?$$.width=$k-$T:$$.width=$x.width),$_<0?$x.height+$_>$l?$$.height=$l:$$.height=$x.height+$_:($$.oy=$_,$x.height+$_>$l?$$.height=$l-$_:$$.height=$x.height);break;default:$$.width=$k,$$.height=$l}$$.w=$i,$$.h=$F,$$.uv=[0,0,$$.width/$i,0,$$.width/$i,$$.height/$F,0,$$.height/$F]}if($I+=$$.ox,$z+=$$.oy,$T-=$$.ox,$_-=$$.oy,$Nx.fillRectImgVb($w,this._clipRect,$I,$z,$$.width,$$.height,$$.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $R=$jx.create(this,this._ib,$w,($w._byteLength-64)/32*3,$Lx.create(256,0)),$s=(this._submits[this._submits._length++]=$R).shaderValue;$s.textureHost=$x;var $N=$b[0]*$i,$D=$b[1]*$F,$f=($b[2]-$b[0])*$i,$m=($b[5]-$b[3])*$F,$y=-$T/$i,$C=-$_/$F;$s.u_TexRange[0]=$N/$i,$s.u_TexRange[1]=$f/$i,$s.u_TexRange[2]=$D/$F,$s.u_TexRange[3]=$m/$F,$s.u_offset[0]=$y,$s.u_offset[1]=$C,$o.enabled&&!this._isMain&&$R.addTexture($x,($w._byteLength>>2)-16),(this._curSubmit=$R)._renderType=10017,$R._numEle+=6}}else this.sprite&&$P.timer.callLater(this,this._repaintSprite)},$I.setShader=function($x){$A.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$x},$I.setFilters=function($x){$A.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$x,this._curSubmit=$nx.RENDERBASE,this._renderKey=0,this._drawCount++},$I.drawTexture=function($x,$I,$z,$k,$l,$n,$a){this._drawTextureM($x,$I,$z,$k,$l,$n,$a,null,1)},$I.addTextureVb=function($x,$I,$z){var $k=this._curSubmit._vb||this._vb,$l=$k._byteLength>>2;$k.byteLength=$l+16<<2;for(var $n=$k.getFloat32Array(),$a=0;$a<16;$a+=4)$n[$l++]=$x[$a]+$I,$n[$l++]=$x[$a+1]+$z,$n[$l++]=$x[$a+2],$n[$l++]=$x[$a+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$k._upload=!0},$I.willDrawTexture=function($x,$I){if(!($x.loaded&&$x.bitmap&&$x.source))return this.sprite&&$P.timer.callLater(this,this._repaintSprite),0;var $z=$x.bitmap,$k=$z.id+this._shader2D.ALPHA*$I+10016;if($k==this._renderKey)return $k;var $l=this._shader2D,$n=$l.ALPHA,$a=this._curSubmit.shaderValue;$l.ALPHA*=$I,this._renderKey=$k,this._drawCount++,$l.glTexture=$z;var $$=this._vb,$w=null,$i=$$._byteLength/32*3,$F=$a.textureHost&&$a.textureHost==$x&&$a.textureHost.alphaTexture==$x.alphaTexture;return $w=$jx.create(this,this._ib,$$,$i,$Lx.create(1,0)),(this._submits[this._submits._length++]=$w).shaderValue.textureHost=$x,$w._renderType=10016,$w._preIsSameTextureShader=10016===this._curSubmit._renderType&&$l.ALPHA===$a.ALPHA&&$F,this._curSubmit=$w,$l.ALPHA=$n,$k},$I.drawTextures=function($x,$I,$z,$k){if($x.loaded&&$x.bitmap&&$x.source){var $l=this._clipRect;if(this._clipRect=$q.MAXCLIPRECT,this._drawTextureM($x,$I[0],$I[1],$x.width,$x.height,$z,$k,null,1)){if(this._clipRect=$l,$U.drawCall++,!($I.length<4)){for(var $n=this._curSubmit._vb||this._vb,$a=this._curMat.a,$$=this._curMat.d,$w=2,$i=$I.length;$w<$i;$w+=2)$Nx.copyPreImgVb($n,($I[$w]-$I[$w-2])*$a,($I[$w+1]-$I[$w-1])*$$),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$P.timer.callLater(this,this._repaintSprite)},$I._drawTextureM=function($x,$I,$z,$k,$l,$n,$a,$$,$w){if(!$x.loaded||!$x.source)return this.sprite&&$P.timer.callLater(this,this._repaintSprite),!1;var $i=this._curSubmit._vb||this._vb,$F=$x.bitmap;$I+=$n,$z+=$a,this._drawCount++;var $b=$F.id+this._shader2D.ALPHA*$w+10016;if($b!=this._renderKey){this._renderKey=$b;var $T=this._curSubmit.shaderValue,$_=this._shader2D,$R=$_.ALPHA;$_.ALPHA*=$w,$_.glTexture=$F;var $s=this._vb,$N=null,$D=$s._byteLength/32*3,$f=$T.textureHost&&$T.textureHost==$x&&$T.textureHost.alphaTexture==$x.alphaTexture;$N=$jx.create(this,this._ib,$s,$D,$Lx.create(1,0)),(this._submits[this._submits._length++]=$N).shaderValue.textureHost=$x,$N._renderType=10016,$N._preIsSameTextureShader=10016===this._curSubmit._renderType&&$_.ALPHA===$T.ALPHA&&$f,this._curSubmit=$N,$i=this._curSubmit._vb||this._vb,$_.ALPHA=$R}return!!$Nx.fillRectImgVb($i,this._clipRect,$I,$z,$k||$x.width,$l||$x.height,$x.uv,$$||this._curMat,this._x,this._y,0,0)&&($o.enabled&&!this._isMain&&this._curSubmit.addTexture($x,($i._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$I._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$I._drawText=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){var $F=$x.bitmap;this._drawCount++;var $b=$F.id+this._shader2D.ALPHA+10016;if($b!=this._renderKey){this._renderKey=$b;var $T=this._curSubmit.shaderValue,$_=this._shader2D;$_.glTexture=$F;var $R=this._vb,$s=null,$N=$R._byteLength/32*3,$D=$T.textureHost&&$T.textureHost==$x&&$T.textureHost.alphaTexture==$x.alphaTexture;($s=$o.enabled?$jx.create(this,this._ib,$R,$N,$Lx.create(1,0)):$jx.create(this,this._ib,$R,$N,$gx.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$_.ALPHA===$T.ALPHA&&$D,(this._submits[this._submits._length++]=$s).shaderValue.textureHost=$x,$s._renderType=10016,this._curSubmit=$s}$x.active();var $f=this._curSubmit._vb||this._vb;$Nx.fillRectImgVb($f,this._clipRect,$I+$a,$z+$$,$k||$x.width,$l||$x.height,$x.uv,$n||this._curMat,this._x,this._y,$w,$i,!0)&&($o.enabled&&!this._isMain&&this._curSubmit.addTexture($x,($f._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$I.drawTextureWithTransform=function($x,$I,$z,$k,$l,$n,$a,$$,$w){if($n){var $i=this._curMat,$F=this._x,$b=this._y;(0!==$a||0!==$$)&&(this._x=$a*$i.a+$$*$i.c,this._y=$$*$i.d+$a*$i.b),$n&&$i.bTransform?($K.mul($n,$i,$q._tmpMatrix),($n=$q._tmpMatrix)._checkTransform()):(this._x+=$i.tx,this._y+=$i.ty),this._drawTextureM($x,$I,$z,$k,$l,0,0,$n,$w),this._x=$F,this._y=$b}else this._drawTextureM($x,$I,$z,$k,$l,$a,$$,null,$w)},$I.fillQuadrangle=function($x,$I,$z,$k,$l){var $n=this._curSubmit,$a=this._vb,$$=this._shader2D,$w=$n.shaderValue;if(this._renderKey=0,$x.bitmap){var $i=$x.bitmap;$$.glTexture==$i&&$$.ALPHA===$w.ALPHA||($$.glTexture=$i,($n=this._curSubmit=$nx.createSubmit(this,this._ib,$a,$a._byteLength/32*3,$Lx.create(1,0))).shaderValue.glTexture=$i,this._submits[this._submits._length++]=$n),$Nx.fillQuadrangleImgVb($a,$I,$z,$k,$x.uv,$l||this._curMat,this._x,this._y)}else $n.shaderValue.fillStyle&&$n.shaderValue.fillStyle.equal($x)&&$$.ALPHA===$w.ALPHA||($$.glTexture=null,($n=this._curSubmit=$nx.createSubmit(this,this._ib,$a,$a._byteLength/32*3,$Lx.create(2,0))).shaderValue.defines.add(2),$n.shaderValue.fillStyle=$B.create($x),this._submits[this._submits._length++]=$n),$Nx.fillQuadrangleImgVb($a,$I,$z,$k,$t.DEF_UV,$l||this._curMat,this._x,this._y);$n._numEle+=6},$I.drawTexture2=function($x,$I,$z,$k,$l,$n,$a,$$){if(0!=$n){var $w=this._curMat;if(this._x=$x*$w.a+$I*$w.c,this._y=$I*$w.d+$x*$w.b,$l&&($l=$w.bTransform||$l.bTransform?($K.mul($l,$w,$q._tmpMatrix),$q._tmpMatrix):(this._x+=$l.tx+$w.tx,this._y+=$l.ty+$w.ty,$K.EMPTY)),1!==$n||$a){var $i=this._shader2D.ALPHA,$F=this._nBlendType;this._shader2D.ALPHA=$n,$a&&(this._nBlendType=$h.TOINT($a)),this._drawTextureM($$[0],$$[1]-$z,$$[2]-$k,$$[3],$$[4],0,0,$l,1),this._shader2D.ALPHA=$i,this._nBlendType=$F}else this._drawTextureM($$[0],$$[1]-$z,$$[2]-$k,$$[3],$$[4],0,0,$l,1);this._x=this._y=0}},$I.drawCanvas=function($x,$I,$z,$k,$l){var $n=$x.context;if(this._renderKey=0,$n._targets)this._submits[this._submits._length++]=$dx.create($n,0,null),this._curSubmit=$nx.RENDERBASE,$n._targets.drawTo(this,$I,$z,$k,$l);else{var $a=this._submits[this._submits._length++]=$dx.create($n,this._shader2D.ALPHA,this._shader2D.filters),$$=$k/$x.width,$w=$l/$x.height,$i=$a._matrix;this._curMat.copyTo($i),1!=$$&&1!=$w&&$i.scale($$,$w);var $F=$i.tx,$b=$i.ty;$i.tx=$i.ty=0,$i.transformPoint($E.TEMP.setTo($I,$z)),$i.translate($E.TEMP.x+$F,$E.TEMP.y+$b),this._curSubmit=$nx.RENDERBASE}$v.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$n._targets?"yellow":"green",this.strokeRect($I-1,$z-1,$k+2,$l+2,1),this.strokeRect($I,$z,$k,$l,1),this.restore())},$I.drawTarget=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){void 0===$i&&($i=-1);var $F=this._vb;if($Nx.fillRectImgVb($F,this._clipRect,$I,$z,$k,$l,$w||$t.DEF_UV,$n||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $b=this._curSubmit=$bx.create(this,this._ib,$F,($F._byteLength-64)/32*3,$$,$a);$b.blendType=-1==$i?this._nBlendType:$i,$b.scope=$x,this._submits[this._submits._length++]=$b,this._curSubmit._numEle+=6}},$I.mixRGBandAlpha=function($x){return this._mixRGBandAlpha($x,this._shader2D.ALPHA)},$I._mixRGBandAlpha=function($x,$I){var $z=(4278190080&$x)>>>24;return 0!=$z?$z*=$I:$z=255*$I,16777215&$x|$z<<24},$I.drawTriangles=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){if(!$x.loaded||!$x.source)return this.sprite&&$P.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$x.bitmap;var $F=this._mixRGBandAlpha(4294967295,$$),$b=($k.length,$n.length);this._renderKey=-1;var $T=this._curSubmit=$jx.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$Lx.create(1,0));return $T.shaderValue.textureHost=$x,$T._renderType=10016,this._submits[this._submits._length++]=$T,$a?($q._tmpMatrix.a=$a.a,$q._tmpMatrix.b=$a.b,$q._tmpMatrix.c=$a.c,$q._tmpMatrix.d=$a.d,$q._tmpMatrix.tx=$a.tx+$I,$q._tmpMatrix.ty=$a.ty+$z,$K.mul($q._tmpMatrix,this._curMat,$q._tmpMatrix)):($q._tmpMatrix.a=this._curMat.a,$q._tmpMatrix.b=this._curMat.b,$q._tmpMatrix.c=this._curMat.c,$q._tmpMatrix.d=this._curMat.d,$q._tmpMatrix.tx=this._curMat.tx+$I,$q._tmpMatrix.ty=this._curMat.ty+$z),this._triangleMesh.addData($k,$l,$n,$q._tmpMatrix,$F,this),this._curSubmit._numEle+=$b,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$I.transform=function($x,$I,$z,$k,$l,$n){$r.save(this),$K.mul($K.TEMP.setTo($x,$I,$z,$k,$l,$n),this._curMat,this._curMat),this._curMat._checkTransform()},$I.setTransformByMatrix=function($x){$x.copyTo(this._curMat)},$I.transformByMatrix=function($x){$r.save(this),$K.mul($x,this._curMat,this._curMat),this._curMat._checkTransform()},$I.rotate=function($x){$r.save(this),this._curMat.rotateEx($x)},$I.scale=function($x,$I){$r.save(this),this._curMat.scaleEx($x,$I)},$I.clipRect=function($x,$I,$z,$k){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $l=$Fx.create(4);this.addRenderObject($l);var $n=this._vb,$a=$n._byteLength>>2;if($Nx.fillRectImgVb($n,null,$x,$I,$z,$k,$t.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $$=this._curSubmit=$nx.createSubmit(this,this._ib,$n,($n._byteLength-64)/32*3,$Lx.create(2,0));$$.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$$,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $w=$Fx.create(5);this.addRenderObject($w);var $i=$n.getFloat32Array(),$F=Math.min(Math.min(Math.min($i[0+$a],$i[4+$a]),$i[8+$a]),$i[12+$a]),$b=Math.max(Math.max(Math.max($i[0+$a],$i[4+$a]),$i[8+$a]),$i[12+$a]),$T=Math.min(Math.min(Math.min($i[1+$a],$i[5+$a]),$i[9+$a]),$i[13+$a]),$_=Math.max(Math.max(Math.max($i[1+$a],$i[5+$a]),$i[9+$a]),$i[13+$a]);$p.save(this,$w,$x,$I,$z,$k,$F,$T,$b-$F,$_-$T),this._curSubmit=$nx.RENDERBASE}else{$z*=this._curMat.a,$k*=this._curMat.d;var $R=$E.TEMP;this._curMat.transformPoint($R.setTo($x,$I)),$z<0&&($R.x=$R.x+$z,$z=-$z),$k<0&&($R.y=$R.y+$k,$k=-$k),this._renderKey=0;var $s=this._curSubmit=$ix.create(this);(this._submits[this._submits._length++]=$s).submitIndex=this._submits._length,$s.submitLength=9999999,$H.save(this,$s);var $N=this._clipRect,$D=$N.x,$f=$N.y,$m=$R.x+$z,$y=$R.y+$k;$D<$R.x&&($N.x=$R.x),$f<$R.y&&($N.y=$R.y),$N.width=Math.min($m,$D+$N.width)-$N.x,$N.height=Math.min($y,$f+$N.height)-$N.y,this._shader2D.glTexture=null,$s.clipRect.copyFrom($N),this._curSubmit=$nx.RENDERBASE}},$I.setIBVB=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F){if(void 0===$w&&($w=0),void 0===$i&&($i=0),void 0===$F&&($F=0),null===$z){if($D.isFlash){var $b=$k;$b._selfIB||($b._selfIB=$Qx.create(35044)),$b._selfIB.clear(),$z=$b._selfIB}else $z=this._ib;$Nx.expandIBQuadrangle($z,$k._byteLength/(4*$k.vertexStride*4))}if(!$$||!$a)throw Error("setIBVB must input:shader shaderValues");var $T=$wx.create(this,$k,$z,$l,$a,$$,$w,$i,$F);$n||($n=$K.EMPTY),$n.translate($x,$I),$K.mul($n,this._curMat,$T._mat),$n.translate(-$x,-$I),this._submits[this._submits._length++]=$T,this._curSubmit=$nx.RENDERBASE,this._renderKey=0},$I.addRenderObject=function($x){this._submits[this._submits._length++]=$x},$I.fillTrangles=function($x,$I,$z,$k,$l){var $n=this._curSubmit,$a=this._vb,$$=this._shader2D,$w=$n.shaderValue,$i=$k.length>>4,$F=$x.bitmap;this._renderKey=0,$$.glTexture==$F&&$$.ALPHA===$w.ALPHA||(($n=this._curSubmit=$nx.createSubmit(this,this._ib,$a,$a._byteLength/32*3,$Lx.create(1,0))).shaderValue.textureHost=$x,this._submits[this._submits._length++]=$n),$Nx.fillTranglesVB($a,$I,$z,$k,$l||this._curMat,this._x,this._y),$n._numEle+=6*$i},$I.submitElement=function($x,$I){var $z=this._submits;for($I<0&&($I=$z._length);$x<$I;)$x+=$z[$x].renderSubmit()},$I.finish=function(){$yx.mainContext.finish()},$I.flush=function(){var $x=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($x>this._ib.bufferLength/12&&$Nx.expandIBQuadrangle(this._ib,$x),!this._isMain&&$o.enabled&&$o._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$o._atlasRestore;for(var $I=this._submits,$z=0,$k=$I._length;$z<$k;$z++){var $l=$I[$z];10016===$l.getRenderType()&&$l.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$Ix.instance&&$Ix.getInstance().reset();var $n;for($z=0,$n=this.meshlist.length;$z<$n;$z++){var $a=this.meshlist[$z];$a.canReuse?$a.releaseMesh():$a.destroy()}return this.meshlist.length=0,this._curSubmit=$nx.RENDERBASE,this._renderKey=0,this._triangleMesh=$tx.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$I.setPathId=function($x){if(this.mId=$x,-1!=this.mId){this.mHaveKey=!1;var $I=$c.getInstance();$I.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$I.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$I.movePath=function($x,$I){var $z=$x,$k=$I;$x=this._curMat.a*$z+this._curMat.c*$k+this._curMat.tx,$I=this._curMat.b*$z+this._curMat.d*$k+this._curMat.ty,this.mX+=$x,this.mY+=$I},$I.beginPath=function(){var $x=this._getPath();$x.tempArray.length=0,$x.closePath=!1,this.mX=0,this.mY=0},$I.closePath=function(){this._path.closePath=!0},$I.fill=function($x){void 0===$x&&($x=!1);var $I=this._getPath();this.drawPoly(0,0,$I.tempArray,this.fillStyle._color.numColor,0,0,$x)},$I.stroke=function(){var $x=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$x.drawLine(0,0,$x.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $I=$c.getInstance().shapeLineDic[this.mId];$I.rebuild($x.tempArray),$x.setGeomtry($I)}else $c.getInstance().addLine(this.mId,$x.drawLine(0,0,$x.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$x.update();var $z=[this.mX,this.mY],$k=$nx.createShape(this,$x.ib,$x.vb,$x.count,$x.offset,$Lx.create(4,0));$k.shaderValue.ALPHA=this._shader2D.ALPHA,$k.shaderValue.u_pos=$z,$k.shaderValue.u_mmat2=$fx.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$k,this._renderKey=-1}},$I.line=function($x,$I,$z,$k,$l,$n){var $a=this._curSubmit,$$=this._vb;if($Nx.fillLineVb($$,this._clipRect,$x,$I,$z,$k,$l,$n)){this._renderKey=0;var $w=this._shader2D,$i=$a.shaderValue;$w.strokeStyle===$i.strokeStyle&&$w.ALPHA===$i.ALPHA||($w.glTexture=null,($a=this._curSubmit=$nx.createSubmit(this,this._ib,$$,($$._byteLength-64)/32*3,$Lx.create(2,0))).shaderValue.strokeStyle=$w.strokeStyle,$a.shaderValue.mainID=2,$a.shaderValue.ALPHA=$w.ALPHA,this._submits[this._submits._length++]=$a),$a._numEle+=6}},$I.moveTo=function($x,$I,$z){void 0===$z&&($z=!0);var $k=this._getPath();if($z){var $l=$x,$n=$I;$x=this._curMat.a*$l+this._curMat.c*$n,$I=this._curMat.b*$l+this._curMat.d*$n}$k.addPoint($x,$I)},$I.lineTo=function($x,$I,$z){void 0===$z&&($z=!0);var $k=this._getPath();if($z){var $l=$x,$n=$I;$x=this._curMat.a*$l+this._curMat.c*$n,$I=this._curMat.b*$l+this._curMat.d*$n}$k.addPoint($x,$I)},$I.drawCurves=function($x,$I,$z){this.setPathId(-1),this.beginPath(),this.strokeStyle=$z[3],this.lineWidth=$z[4];var $k=$z[2];$x+=$z[0],$I+=$z[1],this.movePath($x,$I),this.moveTo($k[0],$k[1]);for(var $l=2,$n=$k.length;$l<$n;)this.quadraticCurveTo($k[$l++],$k[$l++],$k[$l++],$k[$l++]);this.stroke()},$I.arcTo=function($x,$I,$z,$k,$l){if(-1==this.mId||!this.mHaveKey){var $n=0,$a=0,$$=0,$w=this._getPath();this._curMat.copyTo($q._tmpMatrix),$q._tmpMatrix.tx=$q._tmpMatrix.ty=0,$q._tempPoint.setTo($w.getEndPointX(),$w.getEndPointY()),$q._tmpMatrix.invertTransformPoint($q._tempPoint);var $i=$q._tempPoint.x-$x,$F=$q._tempPoint.y-$I,$b=Math.sqrt($i*$i+$F*$F);if(!($b<=1e-6)){var $T=$i/$b,$_=$F/$b,$R=$z-$x,$s=$k-$I,$N=$R*$R+$s*$s,$D=Math.sqrt($N);if(!($D<=1e-6)){var $f=$R/$D,$m=$s/$D,$y=$T+$f,$C=$_+$m,$P=Math.sqrt($y*$y+$C*$C);if(!($P<=1e-6)){var $v=$y/$P,$L=$C/$P,$K=Math.acos($v*$T+$L*$_),$E=Math.PI/2-$K,$O=($b=$l/Math.tan($E))*$T+$x,$S=$b*$_+$I,$Z=Math.sqrt($b*$b+$l*$l),$U=$x+$v*$Z,$X=$I+$L*$Z,$d=0,$j=0;if(0<=$T*$m-$_*$f){var $t=2*$E/$q.SEGNUM;$d=Math.sin($t),$j=Math.cos($t)}else $t=2*-$E/$q.SEGNUM,$d=Math.sin($t),$j=Math.cos($t);$a=this._curMat.a*$O+this._curMat.c*$S,$$=this._curMat.b*$O+this._curMat.d*$S,$a==this._path.getEndPointX()&&$$==this._path.getEndPointY()||$w.addPoint($a,$$);var $Y=$O-$U,$c=$S-$X;for($n=0;$n<$q.SEGNUM;$n++){var $V=$Y*$j+$c*$d,$W=-$Y*$d+$c*$j;$a=$V+$U,$$=$W+$X,$x=this._curMat.a*$a+this._curMat.c*$$,$$=$I=this._curMat.b*$a+this._curMat.d*$$,($a=$x)==this._path.getEndPointX()&&$$==this._path.getEndPointY()||$w.addPoint($a,$$),$Y=$V,$c=$W}}}}}},$I.arc=function($x,$I,$z,$k,$l,$n,$a){if(void 0===$n&&($n=!1),void 0===$a&&($a=!0),-1!=this.mId){var $$=$c.getInstance().shapeDic[this.mId];if($$&&this.mHaveKey&&!$$.needUpdate(this._curMat))return;$I=$x=0}var $w,$i=0,$F=0,$b=0,$T=0,$_=0,$R=0,$s=0;if($F=$l-$k,$n)if(Math.abs($F)>=2*Math.PI)$F=2*-Math.PI;else for(;0<$F;)$F-=2*Math.PI;else if(Math.abs($F)>=2*Math.PI)$F=2*Math.PI;else for(;$F<0;)$F+=2*Math.PI;$w=$F/($s=$z<101?Math.max(10,$F*$z/5):$z<201?Math.max(10,$F*$z/20):Math.max(10,$F*$z/40))/2,$b=Math.abs(4/3*(1-Math.cos($w))/Math.sin($w)),$n&&($b=-$b);var $N=this._getPath(),$D=NaN,$f=NaN;for($R=0;$R<=$s;$R++)$i=$k+$F*($R/$s),$T=$x+Math.cos($i)*$z,$_=$I+Math.sin($i)*$z,$a&&($D=$T,$f=$_,$T=this._curMat.a*$D+this._curMat.c*$f,$_=this._curMat.b*$D+this._curMat.d*$f),$T==this._path.getEndPointX()&&$_==this._path.getEndPointY()||$N.addPoint($T,$_);$T=$x+Math.cos($l)*$z,$_=$I+Math.sin($l)*$z,$a&&($D=$T,$f=$_,$T=this._curMat.a*$D+this._curMat.c*$f,$_=this._curMat.b*$D+this._curMat.d*$f),$T==this._path.getEndPointX()&&$_==this._path.getEndPointY()||$N.addPoint($T,$_)},$I.quadraticCurveTo=function($x,$I,$z,$k){var $l=$b.I,$n=$z,$a=$k;$z=this._curMat.a*$n+this._curMat.c*$a,$k=this._curMat.b*$n+this._curMat.d*$a,$n=$x,$a=$I,$x=this._curMat.a*$n+this._curMat.c*$a,$I=this._curMat.b*$n+this._curMat.d*$a;for(var $$=$l.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$x,$I,$z,$k],30,2),$w=0,$i=$$.length/2;$w<$i;$w++)this.lineTo($$[2*$w],$$[2*$w+1],!1);this.lineTo($z,$k,!1)},$I.rect=function($x,$I,$z,$k){this._other=this._other.make(),this._other.path||(this._other.path=new $e),this._other.path.rect($x,$I,$z,$k)},$I.strokeRect=function($x,$I,$z,$k,$l){var $n=.5*$l;this.line($x-$n,$I,$x+$z+$n,$I,$l,this._curMat),this.line($x+$z,$I,$x+$z,$I+$k,$l,this._curMat),this.line($x,$I,$x,$I+$k,$l,this._curMat),this.line($x-$n,$I+$k,$x+$z+$n,$I+$k,$l,this._curMat)},$I.clip=function(){},$I.drawPoly=function($x,$I,$z,$k,$l,$n,$a){void 0===$a&&($a=!1),this._renderKey=0,this._shader2D.glTexture=null;var $$=this._getPath();if(-1==this.mId)$$.polygon($x,$I,$z,$k,$l||1,$n);else if(this.mHaveKey){var $w=$c.getInstance().shapeDic[this.mId];$w.setMatrix(this._curMat),$w.rebuild($$.tempArray),$$.setGeomtry($w)}else{var $i=$$.polygon($x,$I,$z,$k,$l||1,$n);$c.getInstance().addShape(this.mId,$i),$i.setMatrix(this._curMat)}$$.update();var $F,$b=[this.mX,this.mY];if(($F=$nx.createShape(this,$$.ib,$$.vb,$$.count,$$.offset,$Lx.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$F.shaderValue.u_pos=$b,$F.shaderValue.u_mmat2=$fx.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$F,0<$l){if(this.mHaveLineKey){var $T=$c.getInstance().shapeLineDic[this.mId];$T.rebuild($$.tempArray),$$.setGeomtry($T)}else $c.getInstance().addShape(this.mId,$$.drawLine($x,$I,$z,$l,$n));$$.update(),($F=$nx.createShape(this,$$.ib,$$.vb,$$.count,$$.offset,$Lx.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$F.shaderValue.u_mmat2=$fx.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$F}},$I.drawParticle=function($x,$I,$z){$z.x=$x,$z.y=$I,this._submits[this._submits._length++]=$z},$I._getPath=function(){return this._path||(this._path=new $e)},$k(0,$I,"globalCompositeOperation",function(){return $h.NAMES[this._nBlendType]},function($x){var $I=$h.TOINT[$x];null==$I||this._nBlendType===$I||($A.save(this,65536,this,!0),this._curSubmit=$nx.RENDERBASE,this._renderKey=0,this._nBlendType=$I)}),$k(0,$I,"strokeStyle",function(){return this._shader2D.strokeStyle},function($x){this._shader2D.strokeStyle.equal($x)||($A.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$B.create($x))}),$k(0,$I,"globalAlpha",function(){return this._shader2D.ALPHA},function($x){($x=Math.floor(1e3*$x)/1e3)!=this._shader2D.ALPHA&&($A.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$x)}),$k(0,$I,"asBitmap",null,function($x){if($x){if(this._targets||(this._targets=new $M),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$k(0,$I,"fillStyle",function(){return this._shader2D.fillStyle},function($x){this._shader2D.fillStyle.equal($x)||($A.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$B.create($x))}),$k(0,$I,"textAlign",function(){return this._other.textAlign},function($x){this._other.textAlign===$x||(this._other=this._other.make(),$A.save(this,32768,this._other,!1),this._other.textAlign=$x)}),$k(0,$I,"lineWidth",function(){return this._other.lineWidth},function($x){this._other.lineWidth===$x||(this._other=this._other.make(),$A.save(this,256,this._other,!1),this._other.lineWidth=$x)}),$k(0,$I,"textBaseline",function(){return this._other.textBaseline},function($x){this._other.textBaseline===$x||(this._other=this._other.make(),$A.save(this,16384,this._other,!1),this._other.textBaseline=$x)}),$k(0,$I,"font",null,function($x){$x!=this._other.font.toString()&&(this._other=this._other.make(),$A.save(this,8,this._other,!1),this._other.font===$Rx.EMPTY?this._other.font=new $Rx($x):this._other.font.setFont($x))}),$q.__init__=function(){$z.DEFAULT=new $z},$q._tempPoint=new $E,$q._SUBMITVBSIZE=32e3,$q._MAXSIZE=99999999,$q._RECTVBSIZE=16,$q.MAXCLIPRECT=new $O(0,0,99999999,99999999),$q._COUNT=0,$q._tmpMatrix=new $K,$q.SEGNUM=32,$q._contextcount=0,$a($q,["_fontTemp",function(){return this._fontTemp=new $Rx},"_drawStyleTemp",function(){return this._drawStyleTemp=new $B(null)}]),$q.__init$=function(){$z=function(){function $x(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$Rx.EMPTY}$T($x,"");var $I=$x.prototype;return $I.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$Rx.EMPTY},$I.make=function(){return this===$x.DEFAULT?new $x:this},$x.DEFAULT=null,$x}()},$q}(),$Lx=function($x){function $k($x,$I){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$k.__super.call(this),this.defines=new $Sx,this.position=$k._POSITION,this.mainID=$x,this.subID=$I,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.colorMul=$l.ShieldColor?$R.create($l.ShieldColor)._color:null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$x|$I,this._inClassCache=$k._cache[this._cacheID],0<$x&&!this._inClassCache&&(this._inClassCache=$k._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$T($k,"laya.webgl.shader.d2.value.Value2D",$W);var $I=$k.prototype;return $I.setValue=function($x){},$I.refresh=function(){var $x=this.size;return $x[0]=$fx.width,$x[1]=$fx.height,this.alpha=this.ALPHA*$fx.worldAlpha,this.mmat=$fx.worldMatrix4,this},$I._ShaderWithCompile=function(){return $ux.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$Mx.create)},$I._withWorldShaderDefines=function(){var $x=$fx.worldShaderDefines,$I=$ux.sharders[this.mainID|this.defines._value|$x.getValue()];if(!$I){var $z,$k={};for($z in this.defines.toNameDic())$k[$z]="";for($z in $x.toNameDic())$k[$z]="";$I=$ux.withCompile2D(0,this.mainID,$k,this.mainID|this.defines._value|$x.getValue(),$Mx.create)}var $l=$fx.worldFilters;if(!$l)return $I;for(var $n,$a=$l.length,$$=0;$$<$a;$$++)($n=$l[$$])&&$n.action.setValue(this);return $I},$I.upload=function(){var $x=$fx;this.alpha=this.ALPHA*$x.worldAlpha,$fx.worldMatrix4!==$fx.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$l.ShieldColor&&!this.colorMul?this.colorMul=$l.ShieldColor?$R.create($l.ShieldColor)._color:null:!$l.ShieldColor&&this.colorMul&&(this.colorMul=null),this.colorMul?this.defines.add(16384):this.defines.remove(16384),$yx.shaderHighPrecision&&this.defines.add(1024);var $I,$z=$x.worldShaderDefines?this._withWorldShaderDefines():$ux.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$x.width,this.size[1]=$x.height,this.mmat=$x.worldMatrix4,$Yx.activeShader!==$z?$z._shaderValueWidth!==$x.width||$z._shaderValueHeight!==$x.height?($z._shaderValueWidth=$x.width,$z._shaderValueHeight=$x.height):$I=$z._params2dQuick2||$z._make2dQuick2():$z._shaderValueWidth!==$x.width||$z._shaderValueHeight!==$x.height?($z._shaderValueWidth=$x.width,$z._shaderValueHeight=$x.height):$I=$z._params2dQuick1||$z._make2dQuick1(),$z.upload(this,$I)},$I.setFilters=function($x){if(this.filters=$x)for(var $I,$z=$x.length,$k=0;$k<$z;$k++)($I=$x[$k])&&(this.defines.add($I.type),$I.action.setValue(this))},$I.clear=function(){this.defines.setValue(this.subID)},$I.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$k._initone=function($x,$I){$k._typeClass[$x]=$I,$k._cache[$x]=[],$k._cache[$x]._length=0},$k.__init__=function(){$k._POSITION=[2,5126,!1,4*$sx.BYTES_PE,0],$k._TEXCOORD=[2,5126,!1,4*$sx.BYTES_PE,2*$sx.BYTES_PE],$k._initone(2,$qx),$k._initone(4,$hx),$k._initone(256,$ox),$k._initone(512,$Wx),$k._initone(1,$Jx),$k._initone(65,$gx),$k._initone(9,$Jx)},$k.create=function($x,$I){var $z=$k._cache[$x|$I];return $z._length?$z[--$z._length]:new $k._typeClass[$x|$I]($I)},$k._POSITION=null,$k._TEXCOORD=null,$k._cache=[],$k._typeClass=[],$k.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$k}(),$Kx=function($x){function $N($x,$I){$N.__super.call(this,$x,$I)}$T($N,"laya.webgl.utils.RenderSprite3D",$f);var $I=$N.prototype;return $I.onCreate=function($x){switch($x){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$I._mask=function($x,$I,$z,$k){var $l,$n,$a=this._next,$$=$x.mask;if($$){$I.ctx.save();var $w=$I.ctx.globalCompositeOperation,$i=new $O;if($i.copyFrom($$.getBounds()),$i.width=Math.round($i.width),$i.height=Math.round($i.height),$i.x=Math.round($i.x),$i.y=Math.round($i.y),0<$i.width&&0<$i.height){var $F=$x._style._tf,$b=$$x.create();$b.addValue("bounds",$i),$l=$ax.create([$b,$I],laya.webgl.utils.RenderSprite3D.tmpTarget),$I.addRenderObject($l),$$.render($I,-$i.x,-$i.y),$l=$ax.create([$b],laya.webgl.utils.RenderSprite3D.endTmpTarget),$I.addRenderObject($l),$I.ctx.save(),$I.clipRect($z-$F.translateX+$i.x,$k-$F.translateY+$i.y,$i.width,$i.height),$a._fun.call($a,$x,$I,$z,$k),$I.ctx.restore(),$n=$Fx.create(6),$w=$I.ctx.globalCompositeOperation,$n.blendMode="mask",$I.addRenderObject($n),$K.TEMP.identity();var $T=$Lx.create(1,0),$_=$t.INV_UV,$R=$i.width,$s=$i.height;($i.width<32||$i.height<32)&&(($_=$N.tempUV)[0]=0,$_[1]=0,$_[2]=32<=$i.width?1:$i.width/32,$_[3]=0,$_[4]=32<=$i.width?1:$i.width/32,$_[5]=32<=$i.height?1:$i.height/32,$_[6]=0,$_[7]=32<=$i.height?1:$i.height/32,$i.width=32<=$i.width?$i.width:32,$i.height=32<=$i.height?$i.height:32,$_[1]*=-1,$_[3]*=-1,$_[5]*=-1,$_[7]*=-1,$_[1]+=1,$_[3]+=1,$_[5]+=1,$_[7]+=1),$I.ctx.drawTarget($b,$z+$i.x-$F.translateX,$k+$i.y-$F.translateY,$R,$s,$K.TEMP,"tmpTarget",$T,$_,6),$l=$ax.create([$b],laya.webgl.utils.RenderSprite3D.recycleTarget),$I.addRenderObject($l),($n=$Fx.create(6)).blendMode=$w,$I.addRenderObject($n)}$I.ctx.restore()}else $a._fun.call($a,$x,$I,$z,$k)},$I._blend=function($x,$I,$z,$k){var $l=$x._style,$n=this._next;$l.blendMode?($I.ctx.save(),$I.ctx.globalCompositeOperation=$l.blendMode,$n._fun.call($n,$x,$I,$z,$k),$I.ctx.restore()):$n._fun.call($n,$x,$I,$z,$k)},$I._transform=function($x,$I,$z,$k){var $l=$x.transform,$n=this._next;if($l&&$n!=$f.NORENDER){var $a=$I.ctx;$x._style;$l.tx=$z,$l.ty=$k;var $$=$a._getTransformMatrix(),$w=$$.clone();$K.mul($l,$$,$$),$$._checkTransform(),$l.tx=$l.ty=0,$n._fun.call($n,$x,$I,0,0),$w.copyTo($$),$w.destroy()}else $n._fun.call($n,$x,$I,$z,$k)},$N.tmpTarget=function($x,$I){var $z=$x.getValue("bounds"),$k=$cx.create($z.width,$z.height);$k.start(),$k.clear(0,0,0,0),$x.addValue("tmpTarget",$k)},$N.endTmpTarget=function($x){$x.getValue("tmpTarget").end()},$N.recycleTarget=function($x){$x.getValue("tmpTarget").recycle(),$x.recycle()},$a($N,["tempUV",function(){return this.tempUV=new Array(8)}]),$N}(),$Ex=function($x){function $I(){this.data=null,$I.__super.call(this)}$T($I,"laya.filters.webgl.ColorFilterActionGL",$V);var $z=$I.prototype;return $P.imps($z,{"laya.filters.IFilterActionGL":!0}),$z.setValue=function($x){$x.colorMat=this.data._mat,$x.colorAlpha=this.data._alpha},$z.apply3d=function($x,$I,$z,$k,$l){var $n=$x.getValue("bounds"),$a=$Lx.create(1,0);$a.setFilters([this.data]);var $$=$K.TEMP;$$.identity(),$z.ctx.drawTarget($x,0,0,$n.width,$n.height,$$,"src",$a)},$I}(),$Ox=function($x){function $n($x,$I,$z,$k,$l){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$n.__super.call(this,$x,$I,$l),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $Bx,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$z,this._atlasCanvas.height=$k,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$T($n,"laya.webgl.atlas.Atlaser",$q);var $I=$n.prototype;return $I.computeUVinAtlasTexture=function($x,$I,$z,$k){var $l=$o.atlasTextureWidth,$n=$o.atlasTextureHeight,$a=$z/$l,$$=$k/$n,$w=($z+$x.bitmap.width)/$l,$i=($k+$x.bitmap.height)/$n,$F=$x.bitmap.width/$l,$b=$x.bitmap.height/$n;$x.uv=[$a+$I[0]*$F,$$+$I[1]*$b,$w-(1-$I[2])*$F,$$+$I[3]*$b,$w-(1-$I[4])*$F,$i-(1-$I[5])*$b,$a+$I[6]*$F,$i-(1-$I[7])*$b]},$I.findBitmapIsExist=function($x){if($x instanceof laya.webgl.resource.WebGLImage){var $I=$x,$z=$I.url,$k=this._InAtlasWebGLImagesKey[$z||$I.id];if($k)return $k.offsetInfoID}return-1},$I.addToAtlasTexture=function($x,$I,$z){if($x instanceof laya.webgl.resource.WebGLImage){var $k=$x,$l=$k.url;this._InAtlasWebGLImagesKey[$l||$k.id]={bitmap:$x,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$I,$z])}this._atlasCanvas.texSubImage2D($I,$z,$x.atlasSource),$x.clearAtlasSource()},$I.addToAtlas=function($x,$I,$z){$x._atlasID=this._inAtlasTextureKey.length;var $k=$x.uv.slice(),$l=$x.bitmap;this._inAtlasTextureKey.push($x),this._inAtlasTextureOriUVValue.push($k),this._inAtlasTextureBitmapValue.push($l),this.computeUVinAtlasTexture($x,$k,$I,$z),$x.bitmap=this._atlasCanvas},$I.clear=function(){for(var $x=0,$I=this._inAtlasTextureKey.length;$x<$I;$x++)this._inAtlasTextureKey[$x].bitmap=this._inAtlasTextureBitmapValue[$x],this._inAtlasTextureKey[$x].uv=this._inAtlasTextureOriUVValue[$x],this._inAtlasTextureKey[$x]._atlasID=-1,this._inAtlasTextureKey[$x].bitmap.lock=!1,this._inAtlasTextureKey[$x].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$I.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$k(0,$I,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$k(0,$I,"texture",function(){return this._atlasCanvas}),$k(0,$I,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$n}(),$Sx=function($x){function $z(){$z.__super.call(this,$z.__name2int,$z.__int2name,$z.__int2nameMap)}return $T($z,"laya.webgl.shader.d2.ShaderDefines2D",$G),$z.__init__=function(){$z.reg("TEXTURE2D",1),$z.reg("COLOR2D",2),$z.reg("PRIMITIVE",4),$z.reg("GLOW_FILTER",8),$z.reg("BLUR_FILTER",16),$z.reg("COLOR_FILTER",32),$z.reg("COLOR_ADD",64),$z.reg("WORLDMAT",128),$z.reg("FILLTEXTURE",256),$z.reg("FSHIGHPRECISION",1024),$z.reg("TXTALPHA",2048),$z.reg("TXTCOMPRESS",4096),$z.reg("COLORMUL",16384)},$z.reg=function($x,$I){$G._reg($x,$I,$z.__name2int,$z.__int2name)},$z.toText=function($x,$I,$z){return $G._toText($x,$I,$z)},$z.toInt=function($x){return $G._toInt($x,$z.__name2int)},$z.TEXTURE2D=1,$z.COLOR2D=2,$z.PRIMITIVE=4,$z.FILTERGLOW=8,$z.FILTERBLUR=16,$z.FILTERCOLOR=32,$z.COLORADD=64,$z.WORLDMAT=128,$z.FILLTEXTURE=256,$z.SKINMESH=512,$z.SHADERDEFINE_FSHIGHPRECISION=1024,$z.TXTALPHA=2048,$z.TXTCOMPRESS=4096,$z.COLORMUL=16384,$z.__name2int={},$z.__int2name=[],$z.__int2nameMap=[],$z}(),$Zx=(function($x){function $$($x,$I,$z,$k,$l,$n,$a){$$.__super.call(this,$x,$I,$z,$k,40,$l,$n,$a)}$T($$,"laya.webgl.shapes.Ellipse",$zx)}(),function($x){function $n($x,$I,$z,$k,$l){this._points=[],this.rebuild($z),$n.__super.call(this,$x,$I,0,0,0,$l,$k,$l,0)}$T($n,"laya.webgl.shapes.Line",$zx);var $I=$n.prototype;return $I.rebuild=function($x){var $I=$x.length;$I!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($I/2-1)),this.mFloat32Array=new Float32Array(5*$I)),this._points.length=0;for(var $z=NaN,$k=NaN,$l=-1,$n=-1,$a=$x.length/2,$$=0;$$<$a;$$++)$z=$x[2*$$],$k=$x[2*$$+1],(.01<Math.abs($l-$z)||.01<Math.abs($n-$k))&&this._points.push($z,$k),$l=$z,$n=$k},$I.getData=function($x,$I,$z){var $k=[],$l=[];0<this.borderWidth&&this.createLine2(this._points,$k,this.borderWidth,$z,$l,this._points.length/2),this.mUint16Array.set($k,0),this.mFloat32Array.set($l,0),$x.append(this.mUint16Array),$I.append(this.mFloat32Array)},$n}()),$Ux=function($x){function $b($x,$I,$z,$k,$l){this._points=[];for(var $n=NaN,$a=NaN,$$=-1,$w=-1,$i=$z.length/2-1,$F=0;$F<$i;$F++)$n=$z[2*$F],$a=$z[2*$F+1],(.01<Math.abs($$-$n)||.01<Math.abs($w-$a))&&this._points.push($n,$a),$$=$n,$w=$a;$n=$z[2*$i],$a=$z[2*$i+1],$$=this._points[0],$w=this._points[1],(.01<Math.abs($$-$n)||.01<Math.abs($w-$a))&&this._points.push($n,$a),$b.__super.call(this,$x,$I,0,0,this._points.length/2,0,$k,$l)}$T($b,"laya.webgl.shapes.LoopLine",$zx);var $I=$b.prototype;return $I.getData=function($x,$I,$z){if(0<this.borderWidth){for(var $k=this.color,$l=($k>>16&255)/255,$n=($k>>8&255)/255,$a=(255&$k)/255,$$=[],$w=0,$i=0,$F=[],$b=Math.floor(this._points.length/2),$T=0;$T<$b;$T++)$w=this._points[2*$T],$i=this._points[2*$T+1],$$.push(this.x+$w,this.y+$i,$l,$n,$a);this.createLoopLine($$,$F,this.borderWidth,$z+$$.length/5),$x.append(new Uint16Array($F)),$I.append(new Float32Array($$))}},$I.createLoopLine=function($x,$I,$z,$k,$l,$n){$x.length;var $a=$x.concat(),$$=$l||$x,$w=this.borderColor,$i=($w>>16&255)/255,$F=($w>>8&255)/255,$b=(255&$w)/255,$T=[$a[0],$a[1]],$_=[$a[$a.length-5],$a[$a.length-4]],$R=$_[0]+.5*($T[0]-$_[0]),$s=$_[1]+.5*($T[1]-$_[1]);$a.unshift($R,$s,0,0,0),$a.push($R,$s,0,0,0);var $N,$D,$f,$m,$y,$C,$P,$v,$L,$K,$E,$O,$S,$Z,$U,$X,$d,$j,$t,$Y,$c=$a.length/5,$V=$k,$W=$z/2;$f=$a[0],$m=$a[1],$K=$f-($y=$a[5]),$L=($L=-($m-($C=$a[6])))/($Y=Math.sqrt($L*$L+$K*$K))*$W,$K=$K/$Y*$W,$$.push($f-$L,$m-$K,$i,$F,$b,$f+$L,$m+$K,$i,$F,$b);for(var $q=1;$q<$c-1;$q++)$f=$a[5*($q-1)],$m=$a[5*($q-1)+1],$y=$a[5*$q],$C=$a[5*$q+1],$P=$a[5*($q+1)],$v=$a[5*($q+1)+1],$K=$f-$y,$O=$y-$P,$U=(-($L=($L=-($m-$C))/($Y=Math.sqrt($L*$L+$K*$K))*$W)+$f)*(-($K=$K/$Y*$W)+$C)-(-$L+$y)*(-$K+$m),$j=(-($E=($E=-($C-$v))/($Y=Math.sqrt($E*$E+$O*$O))*$W)+$P)*(-($O=$O/$Y*$W)+$C)-(-$E+$y)*(-$O+$v),$t=($S=-$K+$m-(-$K+$C))*($d=-$E+$y-(-$E+$P))-($X=-$O+$v-(-$O+$C))*($Z=-$L+$y-(-$L+$f)),Math.abs($t)<.1?($t+=10.1,$$.push($y-$L,$C-$K,$i,$F,$b,$y+$L,$C+$K,$i,$F,$b)):((($N=($Z*$j-$d*$U)/$t)-$y)*($N-$y)+(($D=($X*$U-$S*$j)/$t)-$C)+($D-$C),$$.push($N,$D,$i,$F,$b,$y-($N-$y),$C-($D-$C),$i,$F,$b));$n&&($I=$n);var $o=this.edges+1;for($q=1;$q<$o;$q++)$I.push($V+2*($q-1),$V+2*($q-1)+1,$V+2*$q+1,$V+2*$q+1,$V+2*$q,$V+2*($q-1));return $I.push($V+2*($q-1),$V+2*($q-1)+1,$V+1,$V+1,$V,$V+2*($q-1)),$$},$b}(),$Xx=function($x){function $a($x,$I,$z,$k,$l,$n){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$K.create(),this._points=$z.slice(0,$z.length),$a.__super.call(this,$x,$I,0,0,this._points.length/2,$k,$l,$n)}$T($a,"laya.webgl.shapes.Polygon",$zx);var $I=$a.prototype;return $I.rebuild=function($x){this._repaint||(this._points.length=0,this._points=this._points.concat($x))},$I.setMatrix=function($x){$x.copyTo(this._mat)},$I.needUpdate=function($x){return this._repaint=this._mat.a==$x.a&&this._mat.b==$x.b&&this._mat.c==$x.c&&this._mat.d==$x.d&&this._mat.tx==$x.tx&&this._mat.ty==$x.ty,!this._repaint},$I.getData=function($x,$I,$z){var $k,$l=0,$n=this._points,$a=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$z){for(this._start=$z,$k=[],$a=this.earcutTriangles.length,$l=0;$l<$a;$l++)$k.push(this.earcutTriangles[$l]+$z);this.mUint16Array=new Uint16Array($k)}}else{this._start=$z,$k=[];var $$=[],$w=[],$i=this.color,$F=($i>>16&255)/255,$b=($i>>8&255)/255,$T=(255&$i)/255;for($a=Math.floor($n.length/2),$l=0;$l<$a;$l++)$$.push(this.x+$n[2*$l],this.y+$n[2*$l+1],$F,$b,$T),$w.push(this.x+$n[2*$l],this.y+$n[2*$l+1]);for(this.earcutTriangles=$kx.earcut($w,null,2),$a=this.earcutTriangles.length,$l=0;$l<$a;$l++)$k.push(this.earcutTriangles[$l]+$z);this.mUint16Array=new Uint16Array($k),this.mFloat32Array=new Float32Array($$)}$x.append(this.mUint16Array),$I.append(this.mFloat32Array)},$a}(),$dx=function($x){function $n(){this._matrix=new $K,this._matrix4=$sx.defaultMatrix4.concat(),$n.__super.call(this,1e4),this.shaderValue=new $Lx(0,0)}$T($n,"laya.webgl.submit.SubmitCanvas",$nx);var $I=$n.prototype;return $I.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $x=$fx.worldAlpha,$I=$fx.worldMatrix4,$z=$fx.worldMatrix,$k=$fx.worldFilters,$l=$fx.worldShaderDefines,$n=this.shaderValue,$a=this._matrix,$$=this._matrix4,$w=$K.TEMP;return $K.mul($a,$z,$w),$$[0]=$w.a,$$[1]=$w.b,$$[4]=$w.c,$$[5]=$w.d,$$[12]=$w.tx,$$[13]=$w.ty,$fx.worldMatrix=$w.clone(),$fx.worldMatrix4=$$,$fx.worldAlpha=$fx.worldAlpha*$n.alpha,$n.filters&&$n.filters.length&&($fx.worldFilters=$n.filters,$fx.worldShaderDefines=$n.defines),this._ctx_src.flush(),$fx.worldAlpha=$x,$fx.worldMatrix4=$I,$fx.worldMatrix.destroy(),$fx.worldMatrix=$z,$fx.worldFilters=$k,$fx.worldShaderDefines=$l,1},$I.releaseRender=function(){var $x=$n._cache;this._ctx_src=null,$x[$x._length++]=this},$I.getRenderType=function(){return 10003},$n.create=function($x,$I,$z){var $k=$n._cache._length?$n._cache[--$n._cache._length]:new $n;$k._ctx_src=$x;var $l=$k.shaderValue;return $l.alpha=$I,$l.defines.setValue(0),$z&&$z.length&&$l.setFilters($z),$k},$n._cache=(($n._cache=[])._length=0,$n._cache),$n}(),$jx=function($x){function $i($x){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$x&&($x=1e4),$i.__super.call(this,$x)}$T($i,"laya.webgl.submit.SubmitTexture",$nx);var $I=$i.prototype;return $I.releaseRender=function(){var $x=$i._cache;($x[$x._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$I.addTexture=function($x,$I){this._texsID[this._texs.length]=$x._uvID,this._texs.push($x),this._vbPos.push($I)},$I.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $x=this.shaderValue.textureHost.bitmap;if(null!==$x)for(var $I=this._vb.getFloat32Array(),$z=0,$k=this._texs.length;$z<$k;$z++){var $l=this._texs[$z];$l.active();var $n=$l.uv;if(this._texsID[$z]!==$l._uvID){this._texsID[$z]=$l._uvID;var $a=this._vbPos[$z];$I[$a+2]=$n[0],$I[$a+3]=$n[1],$I[$a+6]=$n[2],$I[$a+7]=$n[3],$I[$a+10]=$n[4],$I[$a+11]=$n[5],$I[$a+14]=$n[6],$I[$a+15]=$n[7],this._vb.setNeedUpload()}$l.bitmap!==$x&&(this._isSameTexture=!1)}}},$I.renderSubmit=function(){if(0===this._numEle)return $i._shaderSet=!1,1;var $x=this.shaderValue.textureHost;if($x){var $I=$x.source;if(!$x.bitmap||!$I)return $i._shaderSet=!1,1;this.shaderValue.texture=$I,$x.alphaTexture&&$x.alphaTexture.source&&(this.shaderValue.texture1=$x.alphaTexture.source)}this._vb.bind_upload(this._ib);var $z=$yx.mainContext;if($h.activeBlendFunction!==this._blendFn&&($z.enable(3042),this._blendFn($z),$h.activeBlendFunction=this._blendFn),$U.drawCall++,$U.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$Yx.activeShader&&$i._shaderSet?($Yx.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$Yx.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$i._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $k=$x.bitmap,$l=0,$n=$Yx.activeShader,$a=0,$$=this._texs.length;$a<$$;$a++){var $w=this._texs[$a];$w.bitmap===$k&&$a+1!==$$||($n.uploadTexture2D($w.source),$z.drawElements(4,6*($a-$l+1),5123,this._startIdx+6*$l*$sx.BYTES_PIDX),$k=$w.bitmap,$l=$a)}else $z.drawElements(4,this._numEle,5123,this._startIdx);return 1},$i.create=function($x,$I,$z,$k,$l){var $n=$i._cache._length?$i._cache[--$i._cache._length]:new $i;null==$z&&(($z=$n._selfVb||($n._selfVb=$Gx.create(-1))).clear(),$k=0),$n._ib=$I,$n._vb=$z,$n._startIdx=$k*$sx.BYTES_PIDX,$n._numEle=0;var $a=$x._nBlendType;$n._blendFn=$x._targets?$h.targetFns[$a]:$h.fns[$a],$n.shaderValue=$l,$n.shaderValue.setValue($x._shader2D);var $$=$x._shader2D.filters;return $$&&$n.shaderValue.setFilters($$),$n},$i._cache=(($i._cache=[])._length=0,$i._cache),$i._shaderSet=!0,$i}(),$tx=function($x){function $D(){$D.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$T($D,"laya.webgl.utils.MeshTexture",$Dx);var $I=$D.prototype;return $I.addData=function($x,$I,$z,$k,$l,$n){for(var $a=$x.length/2,$$=this._vb.needSize($a*$D.const_stride)>>2,$w=this._vb.getFloat32Array(),$i=0,$F=0;$F<$a;$F++){var $b=$x[$i],$T=$x[$i+1],$_=$b*$k.a+$T*$k.c+$k.tx,$R=$b*$k.b+$T*$k.d+$k.ty;$w[$$++]=$_,$w[$$++]=$R,$w[$$++]=$I[$i],$w[$$++]=$I[$i+1],$i+=2}this._vb.setNeedUpload();var $s=this.vertNum;if(0<$s){($a=$z.length)>$D.tmpIdx.length&&($D.tmpIdx=new Uint16Array($a));for(var $N=0;$N<$a;$N++)$D.tmpIdx[$N]=$z[$N]+$s;this._ib.appendU16Array($D.tmpIdx,$z.length)}else this._ib.append($z);this._ib.setNeedUpload(),this.vertNum+=$a,this.indexNum+=$z.length},$I.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$I.destroy=function(){this._ib.destroy(),this._vb.destroy()},$D.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $D},$D.const_stride=16,$D._POOL=[],$a($D,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$D}(),$Yx=function($x){function $I(){$I.__super.call(this),this.lock=!0}return $T($I,"laya.webgl.shader.BaseShader",$m),$I.activeShader=null,$I.bindShader=null,$I}(),$cx=function($I){function $F($x,$I,$z,$k,$l,$n,$a,$$,$w){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$z&&($z=6408),void 0===$k&&($k=5121),void 0===$l&&($l=34041),void 0===$n&&($n=!1),void 0===$a&&($a=!1),void 0===$$&&($$=-1),void 0===$w&&($w=-1),this._type=1,this._w=$x,this._h=$I,this._surfaceFormat=$z,this._surfaceType=$k,this._depthStencilFormat=$l,$D.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$n,this._repeat=$a,this._minFifter=$$,this._magFifter=$w,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$F.__super.call(this,this.bitmap,$t.INV_UV)}$T($F,"laya.webgl.resource.RenderTarget2D",$I);var $x=$F.prototype;return $P.imps($x,{"laya.resource.IDispose":!0}),$x.getType=function(){return this._type},$x.getTexture=function(){return this},$x.size=function($x,$I){this._w==$x&&this._h==$I||(this._w=$x,this._h=$I,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$x.release=function(){this.destroy()},$x.recycle=function(){$F.POOL.push(this)},$x.start=function(){var $x=$yx.mainContext;return this._preRenderTarget=$fx.curRenderTarget,$fx.curRenderTarget=this,$x.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($x.viewport(0,0,this._w,this._h),this._svWidth=$fx.width,this._svHeight=$fx.height,$fx.width=this._w,$fx.height=this._h,$Yx.activeShader=null),this},$x.clear=function($x,$I,$z,$k){void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=1);var $l=$yx.mainContext;$l.clearColor($x,$I,$z,$k);var $n=16384;switch(this._depthStencilFormat){case 33189:$n|=256;break;case 36168:$n|=1024;break;case 34041:$n|=256,$n|=1024}$l.clear($n)},$x.end=function(){var $x=$yx.mainContext;$x.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$fx.curRenderTarget=this._preRenderTarget,1==this._type?($x.viewport(0,0,this._svWidth,this._svHeight),$fx.width=this._svWidth,$fx.height=this._svHeight,$Yx.activeShader=null):$x.viewport(0,0,$P.stage.width,$P.stage.height)},$x.getData=function($x,$I,$z,$k){var $l=$yx.mainContext;if($l.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$l.checkFramebufferStatus(36160)))return $l.bindFramebuffer(36160,null),null;var $n=new Uint8Array(this._w*this._h*4);return $l.readPixels($x,$I,$z,$k,this._surfaceFormat,this._surfaceType,$n),$l.bindFramebuffer(36160,null),$n},$x.destroy=function($x){void 0===$x&&($x=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$I.prototype.destroy.call(this))},$x.dispose=function(){},$x._createWebGLRenderTarget=function(){this.bitmap=new $Hx(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($x){this.event("recovered")})},$k(0,$x,"surfaceFormat",function(){return this._surfaceFormat}),$k(0,$x,"magFifter",function(){return this._magFifter}),$k(0,$x,"surfaceType",function(){return this._surfaceType}),$k(0,$x,"mipMap",function(){return this._mipMap}),$k(0,$x,"depthStencilFormat",function(){return this._depthStencilFormat}),$k(0,$x,"minFifter",function(){return this._minFifter}),$k(0,$x,"source",function(){return this._alreadyResolved?$P.superGet($t,this,"source"):null}),$F.create=function($x,$I,$z,$k,$l,$n,$a,$$,$w){void 0===$z&&($z=6408),void 0===$k&&($k=5121),void 0===$l&&($l=34041),void 0===$n&&($n=!1),void 0===$a&&($a=!1),void 0===$$&&($$=-1),void 0===$w&&($w=-1);var $i=$F.POOL.pop();return $i||($i=new $F($x,$I)),$i.bitmap&&$i._w==$x&&$i._h==$I&&$i._surfaceFormat==$z&&$i._surfaceType==$k&&$i._depthStencilFormat==$l&&$i._mipMap==$n&&$i._repeat==$a&&$i._minFifter==$$&&$i._magFifter==$w||($i._w=$x,$i._h=$I,$i._surfaceFormat=$z,$i._surfaceType=$k,$i._depthStencilFormat=$l,$D.isConchWebGL&&34041===$i._depthStencilFormat&&($i._depthStencilFormat=33189),$i._mipMap=$n,$i._repeat=$a,$i._minFifter=$$,$i._magFifter=$w,$i.release(),$i._createWebGLRenderTarget()),$i},$F.TYPE2D=1,$F.TYPE3D=2,$F.POOL=[],$F}($t),$Vx=function($x){function $I(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$I.__super.call(this),$I._gl=$yx.mainContext}$T($I,"laya.webgl.utils.Buffer",$m);var $z=$I.prototype;return $z._bind=function(){this.activeResource(),$I._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($I._bindVertexBuffer=this._glBuffer),$I._gl.bindBuffer(this._bufferType,$I._bindActive[this._bufferType]=this._glBuffer),$Yx.activeShader=null)},$z.recreateResource=function(){this._glBuffer||(this._glBuffer=$I._gl.createBuffer()),this.completeCreate()},$z.disposeResource=function(){this._glBuffer&&($yx.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$k(0,$z,"bufferUsage",function(){return this._bufferUsage}),$I._gl=null,$I._bindActive={},$I._bindVertexBuffer=null,$I._enableAtributes=[],$I}(),$Wx=function($x){function $z($x){this.texcoord=null,this.offsetX=300,this.offsetY=0,$z.__super.call(this,512,0);var $I=8*$sx.BYTES_PE;this.position=[2,5126,!1,$I,0],this.texcoord=[2,5126,!1,$I,2*$sx.BYTES_PE],this.color=[4,5126,!1,$I,4*$sx.BYTES_PE]}return $T($z,"laya.webgl.shader.d2.skinAnishader.SkinSV",$Lx),$z}(),$qx=function($x){function $I($x){$I.__super.call(this,2,0),this.color=[]}return $T($I,"laya.webgl.shader.d2.value.Color2dSV",$Lx),$I.prototype.setValue=function($x){$x.fillStyle&&(this.color=$x.fillStyle._color._color),$x.strokeStyle&&(this.color=$x.strokeStyle._color._color)},$I}(),$ox=function($x){function $I($x){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$Lx._TEXCOORD,$I.__super.call(this,256,0)}$T($I,"laya.webgl.shader.d2.value.FillTextureSV",$Lx);var $z=$I.prototype;return $z.setValue=function($x){this.ALPHA=$x.ALPHA,$x.filters&&this.setFilters($x.filters)},$z.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$I}(),$Jx=function($x){function $I($x){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$Lx._TEXCOORD,void 0===$x&&($x=0),$I.__super.call(this,1,$x)}$T($I,"laya.webgl.shader.d2.value.TextureSV",$Lx);var $z=$I.prototype;return $z.setValue=function($x){this.ALPHA=$x.ALPHA,$x.filters&&this.setFilters($x.filters)},$z.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$I}(),$hx=function($x){function $I($x){this.a_color=null,this.u_pos=[0,0],$I.__super.call(this,4,0),this.position=[2,5126,!1,5*$sx.BYTES_PE,0],this.a_color=[3,5126,!1,5*$sx.BYTES_PE,2*$sx.BYTES_PE]}return $T($I,"laya.webgl.shader.d2.value.PrimitiveSV",$Lx),$I}(),$Bx=function($x){function $I(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$I.__super.call(this)}$T($I,"laya.webgl.atlas.AtlasWebGLCanvas",$x);var $z=$I.prototype;return $z.recreateResource=function(){var $x=$yx.mainContext,$I=this._source=$x.createTexture(),$z=$Cx.curBindTexTarget,$k=$Cx.curBindTexValue;$Cx.bindTexture($x,3553,$I),$x.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$x.texParameteri(3553,10241,9729),$x.texParameteri(3553,10240,9729),$x.texParameteri(3553,10242,33071),$x.texParameteri(3553,10243,33071),$z&&$k&&$Cx.bindTexture($x,$z,$k),this.memorySize=this._w*this._h*4,this.completeCreate()},$z.disposeResource=function(){this._source&&($yx.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$z.texSubImage2D=function($x,$I,$z){if($D.isFlash){this._flashCacheImage||(this._flashCacheImage=$N.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $k=$z.bitmapdata;this._flashCacheImage._image.copyPixels($k,0,0,$k.width,$k.height,$x,$I),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $l=$yx.mainContext,$n=$Cx.curBindTexTarget,$a=$Cx.curBindTexValue;$Cx.bindTexture($l,3553,this._source),$l.pixelStorei(37441,!0),0<=$x-1&&$l.texSubImage2D(3553,0,$x-1,$I,6408,5121,$z),$x+1<=this._w&&$l.texSubImage2D(3553,0,$x+1,$I,6408,5121,$z),0<=$I-1&&$l.texSubImage2D(3553,0,$x,$I-1,6408,5121,$z),$I+1<=this._h&&$l.texSubImage2D(3553,0,$x,$I+1,6408,5121,$z),$l.texSubImage2D(3553,0,$x,$I,6408,5121,$z),$l.pixelStorei(37441,!1),$n&&$a&&$Cx.bindTexture($l,$n,$a)}},$z.texSubImage2DPixel=function($x,$I,$z,$k,$l){var $n=$yx.mainContext,$a=$Cx.curBindTexTarget,$$=$Cx.curBindTexValue;$Cx.bindTexture($n,3553,this._source);var $w=new Uint8Array($l.data);$n.pixelStorei(37441,!0),$n.texSubImage2D(3553,0,$x,$I,$z,$k,6408,5121,$w),$n.pixelStorei(37441,!1),$a&&$$&&$Cx.bindTexture($n,$a,$$)},$k(0,$z,"width",$x.prototype._$get_width,function($x){this._w=$x}),$k(0,$z,"height",$x.prototype._$get_height,function($x){this._h=$x}),$I}($z),$ex=function($x){function $l(){this.flipY=!0,this.alwaysChange=!1,$l.__super.call(this)}$T($l,"laya.webgl.resource.WebGLCanvas",$z);var $I=$l.prototype;return $I.getCanvas=function(){return this._canvas},$I.clear=function(){this._ctx&&this._ctx.clear()},$I.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$I._setContext=function($x){this._ctx=$x},$I.getContext=function($x,$I){return this._ctx?this._ctx:this._ctx=$l._createContext(this)},$I.size=function($x,$I){this._w==$x&&this._h==$I||(this._w=$x,this._h=$I,this._ctx&&this._ctx.size($x,$I),this._canvas&&(this._canvas.height=$I,this._canvas.width=$x))},$I.activeResource=function($x){void 0===$x&&($x=!1),this._source||this.recreateResource()},$I.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$I.disposeResource=function(){this._source&&!this.iscpuSource&&($yx.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$I.createWebGlTexture=function(){var $x=$yx.mainContext;this._canvas;var $I=this._source=$x.createTexture();this.iscpuSource=!1;var $z=$Cx.curBindTexTarget,$k=$Cx.curBindTexValue;$Cx.bindTexture($x,3553,$I),$x.pixelStorei(37440,this.flipY?1:0),$l.premulAlpha&&$x.pixelStorei(37441,!0),$x.texImage2D(3553,0,6408,6408,5121,this._imgData),$l.premulAlpha&&$x.pixelStorei(37441,!1),$x.texParameteri(3553,10240,9729),$x.texParameteri(3553,10241,9729),$x.texParameteri(3553,10242,33071),$x.texParameteri(3553,10243,33071),$x.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$z&&$k&&$Cx.bindTexture($x,$z,$k)},$I.reloadCanvasData=function(){var $x=$yx.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $I=$Cx.curBindTexTarget,$z=$Cx.curBindTexValue;$Cx.bindTexture($x,3553,this._source),$l.premulAlpha&&$x.pixelStorei(37441,!0),$x.texImage2D(3553,0,6408,6408,5121,this._imgData),$l.premulAlpha&&$x.pixelStorei(37441,!1),$x.pixelStorei(37440,0),$I&&$z&&$Cx.bindTexture($x,$I,$z)},$I.texSubImage2D=function($x,$I,$z){var $k=$yx.mainContext,$l=$Cx.curBindTexTarget,$n=$Cx.curBindTexValue;$Cx.bindTexture($k,3553,this._source),$k.pixelStorei(37441,!0),$k.texSubImage2D(3553,0,$I,$z,6408,5121,$x._source),$k.pixelStorei(37441,!1),$l&&$n&&$Cx.bindTexture($k,$l,$n)},$I.toBase64=function($x,$I,$z){var $k=null;this._canvas&&($k=this._canvas.toDataURL($x,$I)),$z.call(this,$k)},$k(0,$I,"context",function(){return this._ctx}),$k(0,$I,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$k(0,$I,"asBitmap",null,function($x){this._ctx&&(this._ctx.asBitmap=$x)}),$l._createContext=null,$l.premulAlpha=!1,$l}(),$Ax=function($x){function $n($x,$I){this.CborderSize=12,$n.__super.call(this),this.char=$x,this.isSpace=" "===$x,this.xs=$I.scaleX,this.ys=$I.scaleY,this.font=$I.font.toString(),this.fontSize=$I.font.size,this.fillColor=$I.fillColor,this.borderColor=$I.borderColor,this.lineWidth=$I.lineWidth,this.underLine=$I.underLine;var $z,$k=$D.isConchApp;$k?(($z=ConchTextCanvas)._source=ConchTextCanvas,$z._source.canvas=ConchTextCanvas):$z=$_.canvas.source,this.canvas=$z,this._enableMerageInAtlas=!0,this._ctx=$k?$z:this.canvas.getContext("2d",void 0);var $l=$Y.measureText(this.char,this.font);this.cw=$l.width*this.xs,this.ch=($l.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $t(this)}$T($n,"laya.webgl.resource.WebGLCharImage",$z);var $I=$n.prototype;return $P.imps($I,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$I.active=function(){this.texture.active()},$I.recreateResource=function(){var $x=$D.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$x){var $I=this.fontSize;1==this.xs&&1==this.ys||($I=parseInt($I*(this.xs>this.ys?this.xs:this.ys)+""));var $z="normal 100 "+this.font;$z=$z.replace($n._fontSizeReg,$I),this.borderColor&&($z+=" 1 "+this.borderColor),this._ctx.font=$z,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$j.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $k=this._ctx.measureText(this.char);$k||($k={width:16});var $l=$k.width+1;this._ctx.lineTo($l,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$I.onresize=function($x,$I){this._w=$x,this._h=$I,this._allowMerageInAtlas=!0},$I.clearAtlasSource=function(){},$k(0,$I,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$k(0,$I,"atlasSource",function(){return this.canvas}),$k(0,$I,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($x){this._enableMerageInAtlas=$x}),$n.createOneChar=function($x,$I){return new $n($x,$I)},$n._fontSizeReg=new RegExp("\\d+(?=px)","g"),$n}(),$Hx=function($x){function $i($x,$I,$z,$k,$l,$n,$a,$$,$w){void 0===$z&&($z=6408),void 0===$k&&($k=5121),void 0===$l&&($l=34041),void 0===$n&&($n=!1),void 0===$a&&($a=!1),void 0===$$&&($$=-1),void 0===$w&&($w=1),$i.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$x,this._h=$I,this._surfaceFormat=$z,this._surfaceType=$k,this._depthStencilFormat=$l,this._mipMap=$n,this._repeat=$a,this._minFifter=$$,this._magFifter=$w}$T($i,"laya.webgl.resource.WebGLRenderTarget",$z);var $I=$i.prototype;return $I.recreateResource=function(){var $x=$yx.mainContext;this._frameBuffer||(this._frameBuffer=$x.createFramebuffer()),this._source||(this._source=$x.createTexture());var $I=$Cx.curBindTexTarget,$z=$Cx.curBindTexValue;$Cx.bindTexture($x,3553,this._source),$x.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $k=this._minFifter,$l=this._magFifter,$n=this._repeat?10497:33071,$a=$F.isPOT(this._w,this._h);if($a?(this._mipMap?-1!==$k||($k=9987):-1!==$k||($k=9729),-1!==$l||($l=9729),$x.texParameteri(3553,10241,$k),$x.texParameteri(3553,10240,$l),$x.texParameteri(3553,10242,$n),$x.texParameteri(3553,10243,$n),this._mipMap&&$x.generateMipmap(3553)):(-1!==$k||($k=9729),-1!==$l||($l=9729),$x.texParameteri(3553,10241,$k),$x.texParameteri(3553,10240,$l),$x.texParameteri(3553,10242,33071),$x.texParameteri(3553,10243,33071)),$x.bindFramebuffer(36160,this._frameBuffer),$x.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$x.createRenderbuffer()),$x.bindRenderbuffer(36161,this._depthStencilBuffer),$x.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$x.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$x.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$x.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$x.bindFramebuffer(36160,null),$I&&$z&&$Cx.bindTexture($x,$I,$z),$x.bindRenderbuffer(36161,null),$a&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$I.disposeResource=function(){this._frameBuffer&&($yx.mainContext.deleteTexture(this._source),$yx.mainContext.deleteFramebuffer(this._frameBuffer),$yx.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},$k(0,$I,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$k(0,$I,"frameBuffer",function(){return this._frameBuffer}),$i}(),$px=function($x){function $$($x,$I,$z,$k,$l,$n,$a){this.offsetX=0,this.offsetY=0,$$.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$n,this.canvas=$x,this._ctx=$x.getContext("2d",void 0),this._w=$k,this._h=$l,this.offsetX=$I,this.offsetY=$z,this.src=$a,this._enableMerageInAtlas=!0,$o.enabled&&this._w<$o.atlasLimitWidth&&this._h<$o.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$T($$,"laya.webgl.resource.WebGLSubImage",$z);var $I=$$.prototype;return $P.imps($I,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$I.size=function($x,$I){this._w=$x,this._h=$I,this._ctx&&this._ctx.size($x,$I),this.canvas&&(this.canvas.height=$I,this.canvas.width=$x)},$I.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$I.createWebGlTexture=function(){var $x=$yx.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $I=this._source=$x.createTexture(),$z=$Cx.curBindTexTarget,$k=$Cx.curBindTexValue;$Cx.bindTexture($x,3553,$I),$x.pixelStorei(37441,!0),$x.texImage2D(3553,0,6408,6408,5121,this.canvas),$x.pixelStorei(37441,!1);var $l=this.minFifter,$n=this.magFifter,$a=this.repeat?10497:33071,$$=$F.isPOT(this.width,this.height);$$?(this.mipmap?-1!==$l||($l=9987):-1!==$l||($l=9729),-1!==$n||($n=9729),$x.texParameteri(3553,10240,$n),$x.texParameteri(3553,10241,$l),$x.texParameteri(3553,10242,$a),$x.texParameteri(3553,10243,$a),this.mipmap&&$x.generateMipmap(3553)):(-1!==$l||($l=9729),-1!==$n||($n=9729),$x.texParameteri(3553,10241,$l),$x.texParameteri(3553,10240,$n),$x.texParameteri(3553,10242,33071),$x.texParameteri(3553,10243,33071)),$z&&$k&&$Cx.bindTexture($x,$z,$k),this.canvas=null,$$&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$I.disposeResource=function(){$o.enabled&&this._allowMerageInAtlas||!this._source||($yx.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$I.clearAtlasSource=function(){},$k(0,$I,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$k(0,$I,"atlasSource",function(){return this.canvas}),$k(0,$I,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($x){this._allowMerageInAtlas=$x}),$$}(),$ux=function($x){function $i($x,$I,$z,$k){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$i.__super.call(this),!$x||!$I)throw"Shader Error";this._id=++$i._count,this._vs=$x,this._ps=$I,this._nameMap=$k||{},null!=$z&&($i.sharders[$z]=this)}$T($i,"laya.webgl.shader.Shader",$Yx);var $I=$i.prototype;return $I.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$I.disposeResource=function(){$yx.mainContext.deleteShader(this._vshader),$yx.mainContext.deleteShader(this._pshader),$yx.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$I._compile=function(){if(!$yx.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $x=[this._vs,this._ps],$I=$yx.mainContext;if(this._program=$I.createProgram(),this._vshader=$i._createShader($I,$x[0],35633),this._pshader=$i._createShader($I,$x[1],35632),$I.attachShader(this._program,this._vshader),$I.attachShader(this._program,this._pshader),$I.linkProgram(this._program),!$D.isConchApp&&!$I.getProgramParameter(this._program,35714))throw $I.getProgramInfoLog(this._program);var $z,$k,$l=0,$n=0;for($n=$D.isConchApp?$I.getProgramParameterEx(this._vs,this._ps,"",35721):$I.getProgramParameter(this._program,35721),$l=0;$l<$n;$l++){var $a=null;$z={vartype:"attribute",glfun:null,ivartype:0,attrib:$a=$D.isConchApp?$I.getActiveAttribEx(this._vs,this._ps,"",$l):$I.getActiveAttrib(this._program,$l),location:$I.getAttribLocation(this._program,$a.name),name:$a.name,type:$a.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($z)}var $$=0;for($$=$D.isConchApp?$I.getProgramParameterEx(this._vs,this._ps,"",35718):$I.getProgramParameter(this._program,35718),$l=0;$l<$$;$l++){var $w=null;$w=$D.isConchApp?$I.getActiveUniformEx(this._vs,this._ps,"",$l):$I.getActiveUniform(this._program,$l),0<($z={vartype:"uniform",glfun:null,ivartype:1,attrib:$a,location:$I.getUniformLocation(this._program,$w.name),name:$w.name,type:$w.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($z.name=$z.name.substr(0,$z.name.length-3),$z.isArray=!0,$z.location=$I.getUniformLocation(this._program,$z.name)),this._params.push($z)}for($l=0,$k=this._params.length;$l<$k;$l++)if(($z=this._params[$l]).indexOfParams=$l,$z.index=1,$z.value=[$z.location,null],$z.codename=$z.name,$z.name=this._nameMap[$z.codename]?this._nameMap[$z.codename]:$z.codename,(this._paramsMap[$z.name]=$z)._this=this,$z.uploadedValue=[],"attribute"!==$z.vartype)switch($z.type){case 5124:$z.fun=$z.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$z.fun=$z.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$z.fun=$z.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$z.fun=$z.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$z.fun=$z.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$z.fun=this._uniform_sampler2D;break;case 35680:$z.fun=this._uniform_samplerCube;break;case 35676:$z.glfun=$I.uniformMatrix4fv,$z.fun=this._uniformMatrix4fv;break;case 35670:$z.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $z.fun=this._attribute}},$I.getUniform=function($x){return this._paramsMap[$x]},$I._attribute=function($x,$I){var $z=$yx.mainContext,$k=$Vx._enableAtributes,$l=$x.location;return $k[$l]||$z.enableVertexAttribArray($l),$z.vertexAttribPointer($l,$I[0],$I[1],$I[2],$I[3],$I[4]+this._offset),$k[$l]=$Vx._bindVertexBuffer,1},$I._uniform1f=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I?($yx.mainContext.uniform1f($x.location,$z[0]=$I),1):0},$I._uniform1fv=function($x,$I){if($I.length<4){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($yx.mainContext.uniform1fv($x.location,$I),$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3],1):0}return $yx.mainContext.uniform1fv($x.location,$I),1},$I._uniform_vec2=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]?($yx.mainContext.uniform2f($x.location,$z[0]=$I[0],$z[1]=$I[1]),1):0},$I._uniform_vec2v=function($x,$I){if($I.length<2){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($yx.mainContext.uniform2fv($x.location,$I),$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3],1):0}return $yx.mainContext.uniform2fv($x.location,$I),1},$I._uniform_vec3=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]?($yx.mainContext.uniform3f($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2]),1):0},$I._uniform_vec3v=function($x,$I){return $yx.mainContext.uniform3fv($x.location,$I),1},$I._uniform_vec4=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($yx.mainContext.uniform4f($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3]),1):0},$I._uniform_vec4v=function($x,$I){return $yx.mainContext.uniform4fv($x.location,$I),1},$I._uniformMatrix2fv=function($x,$I){return $yx.mainContext.uniformMatrix2fv($x.location,!1,$I),1},$I._uniformMatrix3fv=function($x,$I){return $yx.mainContext.uniformMatrix3fv($x.location,!1,$I),1},$I._uniformMatrix4fv=function($x,$I){return $yx.mainContext.uniformMatrix4fv($x.location,!1,$I),1},$I._uniform1i=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I?($yx.mainContext.uniform1i($x.location,$z[0]=$I),1):0},$I._uniform1iv=function($x,$I){return $yx.mainContext.uniform1iv($x.location,$I),1},$I._uniform_ivec2=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]?($yx.mainContext.uniform2i($x.location,$z[0]=$I[0],$z[1]=$I[1]),1):0},$I._uniform_ivec2v=function($x,$I){return $yx.mainContext.uniform2iv($x.location,$I),1},$I._uniform_vec3i=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]?($yx.mainContext.uniform3i($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2]),1):0},$I._uniform_vec3vi=function($x,$I){return $yx.mainContext.uniform3iv($x.location,$I),1},$I._uniform_vec4i=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($yx.mainContext.uniform4i($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3]),1):0},$I._uniform_vec4vi=function($x,$I){return $yx.mainContext.uniform4iv($x.location,$I),1},$I._uniform_sampler2D=function($x,$I){var $z=$yx.mainContext,$k=$x.uploadedValue;return null==$k[0]?($k[0]=this._curActTexIndex,$z.uniform1i($x.location,this._curActTexIndex),$z.activeTexture($i._TEXTURES[this._curActTexIndex]),$Cx.bindTexture($z,3553,$I),this._curActTexIndex++,1):($z.activeTexture($i._TEXTURES[$k[0]]),$Cx.bindTexture($z,3553,$I),0)},$I._uniform_samplerCube=function($x,$I){var $z=$yx.mainContext,$k=$x.uploadedValue;return null==$k[0]?($k[0]=this._curActTexIndex,$z.uniform1i($x.location,this._curActTexIndex),$z.activeTexture($i._TEXTURES[this._curActTexIndex]),$Cx.bindTexture($z,34067,$I),this._curActTexIndex++,1):($z.activeTexture($i._TEXTURES[$k[0]]),$Cx.bindTexture($z,34067,$I),0)},$I._noSetValue=function($x){console.log("no....:"+$x.name)},$I.uploadOne=function($x,$I){this.activeResource(),$Cx.UseProgram(this._program);var $z=this._paramsMap[$x];$z.fun.call(this,$z,$I)},$I.uploadTexture2D=function($x){$U.shaderCall++;var $I=$yx.mainContext;$I.activeTexture(33984),$Cx.bindTexture($I,3553,$x)},$I.uploadTexture2D1=function($x){$U.shaderCall++;var $I=$yx.mainContext;$I.activeTexture(33985),$Cx.bindTexture($I,3553,$x)},$I.upload=function($x,$I){$Yx.activeShader=$Yx.bindShader=this,this._lastUseFrameCount===$U.loopCount||this.activeResource(),$Cx.UseProgram(this._program),this._reCompile?($I=this._params,this._reCompile=!1):$I=$I||this._params;$yx.mainContext;for(var $z,$k,$l=$I.length,$n=0,$a=0;$a<$l;$a++)null!==($k=$x[($z=$I[$a]).name])&&($n+=$z.fun.call(this,$z,$k));$U.shaderCall+=$n},$I.uploadArray=function($x,$I,$z){$Yx.activeShader=this,($Yx.bindShader=this).activeResource(),$Cx.UseProgram(this._program);this._params;for(var $k,$l,$n=0,$a=$I-2;0<=$a;$a-=2)($l=this._paramsMap[$x[$a]])&&null!=($k=$x[$a+1])&&($z&&$z[$l.name]&&$z[$l.name].bind(),$n+=$l.fun.call(this,$l,$k));$U.shaderCall+=$n},$I.getParams=function(){return this._params},$i.getShader=function($x){return $i.sharders[$x]},$i.create=function($x,$I,$z,$k){return new $i($x,$I,$z,$k)},$i.withCompile=function($x,$I,$z,$k){if($z&&$i.sharders[$z])return $i.sharders[$z];var $l=$i._preCompileShader[2e-4*$x];if(!$l)throw new Error("withCompile shader err!"+$x);return $l.createShader($I,$z,$k)},$i.withCompile2D=function($x,$I,$z,$k,$l){if($k&&$i.sharders[$k])return $i.sharders[$k];var $n=$i._preCompileShader[2e-4*$x+$I];if(!$n)throw new Error("withCompile shader err!"+$x+" "+$I);return $n.createShader($z,$k,$l)},$i.addInclude=function($x,$I){$mx.addInclude($x,$I)},$i.preCompile=function($x,$I,$z,$k){var $l=2e-4*$x;$i._preCompileShader[$l]=new $mx($l,$I,$z,$k)},$i.preCompile2D=function($x,$I,$z,$k,$l){var $n=2e-4*$x+$I;$i._preCompileShader[$n]=new $mx($n,$z,$k,$l)},$i._createShader=function($x,$I,$z){var $k=$x.createShader($z);return $x.shaderSource($k,$I),$x.compileShader($k),$k},$i._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$i._count=0,$i._preCompileShader={},$i.SHADERNAME2ID=2e-4,$i.sharders=(($i.sharders=[]).length=32,$i.sharders),$a($i,["nameKey",function(){return this.nameKey=new $X}]),$i}(),$rx=function($x){function $I(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$I.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$T($I,"laya.webgl.utils.Buffer2D",$x);var $z=$I.prototype;return $z.needSize=function($x){var $I=this._byteLength;if($x){var $z=this._byteLength+$x;$z<=this._buffer.byteLength||this._resizeBuffer($z<<1,!0),this._byteLength=$z}return $I},$z._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$U.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$Vx._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$Vx._gl.bufferSubData(this._bufferType,0,this._buffer)},$z._bufferSubData=function($x,$I,$z){if(void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$U.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$Vx._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$I||$z){var $k=this._buffer.slice($I,$z);$Vx._gl.bufferSubData(this._bufferType,$x,$k)}else $Vx._gl.bufferSubData(this._bufferType,$x,this._buffer)},$z._checkArrayUse=function(){},$z._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$z._bind_subUpload=function($x,$I,$z){return void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($x,$I,$z),!0)},$z._resizeBuffer=function($x,$I){if($x<this._buffer.byteLength)return this;if(this.memorySize=$x,$I&&this._buffer&&0<this._buffer.byteLength){var $z=new ArrayBuffer($x);new Uint8Array($z).set(new Uint8Array(this._buffer),0),this._buffer=$z}else this._buffer=new ArrayBuffer($x);return this._checkArrayUse(),this._upload=!0,this},$z.append=function($x){this._upload=!0;var $I,$z;$I=$x.byteLength,$x instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$I,!0),$z=new Uint8Array(this._buffer,this._byteLength)):$x instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$I,!0),$z=new Uint16Array(this._buffer,this._byteLength)):$x instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$I,!0),$z=new Float32Array(this._buffer,this._byteLength)),$z.set($x,0),this._byteLength+=$I,this._checkArrayUse()},$z.appendU16Array=function($x,$I){this._resizeBuffer(this._byteLength+2*$I,!0);for(var $z=new Uint16Array(this._buffer,this._byteLength,$I),$k=0;$k<$I;$k++)$z[$k]=$x[$k];this._byteLength+=2*$I,this._checkArrayUse()},$z.appendEx=function($x,$I){this._upload=!0;var $z;$z=$x.byteLength,this._resizeBuffer(this._byteLength+$z,!0),new $I(this._buffer,this._byteLength).set($x,0),this._byteLength+=$z,this._checkArrayUse()},$z.appendEx2=function($x,$I,$z,$k){void 0===$k&&($k=1),this._upload=!0;var $l,$n;$l=$z*$k,this._resizeBuffer(this._byteLength+$l,!0),$n=new $I(this._buffer,this._byteLength);var $a=0;for($a=0;$a<$z;$a++)$n[$a]=$x[$a];this._byteLength+=$l,this._checkArrayUse()},$z.getBuffer=function(){return this._buffer},$z.setNeedUpload=function(){this._upload=!0},$z.getNeedUpload=function(){return this._upload},$z.upload=function(){var $x=this._bind_upload();return $Vx._gl.bindBuffer(this._bufferType,null),$Vx._bindActive[this._bufferType]=null,$Yx.activeShader=null,$x},$z.subUpload=function($x,$I,$z){void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0);var $k=this._bind_subUpload();return $Vx._gl.bindBuffer(this._bufferType,null),$Vx._bindActive[this._bufferType]=null,$Yx.activeShader=null,$k},$z.disposeResource=function(){$x.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$z.clear=function(){this._byteLength=0,this._upload=!0},$k(0,$z,"bufferLength",function(){return this._buffer.byteLength}),$k(0,$z,"byteLength",null,function($x){this._byteLength!==$x&&($x<=this._buffer.byteLength||this._resizeBuffer(2*$x+256,!0),this._byteLength=$x)}),$I.__int__=function($x){$Qx.QuadrangleIB=$Qx.create(35044),$Nx.fillIBQuadrangle($Qx.QuadrangleIB,16)},$I.FLOAT32=4,$I.SHORT=2,$I}($Vx),$gx=(function($I){function $z($x){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$z.__super.call(this,9)}$T($z,"laya.webgl.shader.d2.value.GlowSV",$I);var $x=$z.prototype;$x.setValue=function($x){$I.prototype.setValue.call(this,$x)},$x.clear=function(){$I.prototype.clear.call(this)}}($Jx),function($x){function $I($x){$I.__super.call(this,64),this.defines.add(64)}$T($I,"laya.webgl.shader.d2.value.TextSV",$x);var $z=$I.prototype;return $z.release=function(){($I.pool[$I._length++]=this).clear()},$z.clear=function(){$x.prototype.clear.call(this)},$I.create=function(){return $I._length?$I.pool[--$I._length]:new $I(null)},$I.pool=[],$I._length=0,$I}($Jx)),$Mx=function($x){function $l($x,$I,$z,$k){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$l.__super.call(this,$x,$I,$z,$k)}$T($l,"laya.webgl.shader.d2.Shader2X",$x);var $I=$l.prototype;return $I.upload2dQuick1=function($x){this.upload($x,this._params2dQuick1||this._make2dQuick1())},$I._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $x,$I=this._params,$z=0,$k=$I.length;$z<$k;$z++)$x=$I[$z],($D.isFlash||"size"!==$x.name&&"position"!==$x.name&&"texcoord"!==$x.name)&&this._params2dQuick1.push($x)}return this._params2dQuick1},$I.disposeResource=function(){$x.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$I.upload2dQuick2=function($x){this.upload($x,this._params2dQuick2||this._make2dQuick2())},$I._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $x,$I=this._params,$z=0,$k=$I.length;$z<$k;$z++)$x=$I[$z],($D.isFlash||"size"!==$x.name)&&this._params2dQuick2.push($x)}return this._params2dQuick2},$l.create=function($x,$I,$z,$k){return new $l($x,$I,$z,$k)},$l}($ux),$Qx=function($x){function $I($x){this._uint8Array=null,this._uint16Array=null,void 0===$x&&($x=35044),$I.__super.call(this),this._bufferUsage=$x,this._bufferType=34963,$D.isFlash||(this._buffer=new ArrayBuffer(8))}$T($I,"laya.webgl.utils.IndexBuffer2D",$rx);var $z=$I.prototype;return $z._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$z.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$z.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$z.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$I.QuadrangleIB=null,$I.create=function($x){return void 0===$x&&($x=35044),new $I($x)},$I}(),$Gx=function($x){function $z($x,$I){this._floatArray32=null,this._vertexStride=0,$z.__super.call(this),this._vertexStride=$x,this._bufferUsage=$I,this._bufferType=34962,$D.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$T($z,"laya.webgl.utils.VertexBuffer2D",$x);var $I=$z.prototype;return $I.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$I.bind=function($x){$x&&$x._bind(),this._bind()},$I.insertData=function($x,$I){this.getFloat32Array().set($x,$I),this._upload=!0},$I.bind_upload=function($x){$x._bind_upload()||$x._bind(),this._bind_upload()||this._bind()},$I._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$I.disposeResource=function(){$x.prototype.disposeResource.call(this)},$I.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$k(0,$I,"vertexStride",function(){return this._vertexStride}),$z.create=function($x,$I){return void 0===$I&&($I=35048),new $z($x,$I)},$z}($rx),$xI=function($x){function $$($x,$I,$z,$k,$l,$n){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$z&&($z=6408),void 0===$k&&($k=!0),$$.__super.call(this,$x,$I),$x){if(this._format=$z,this._mipmap=$k,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $x)this._url=$x,this._src=$x,this._image=new $_.window.Image,$I&&($I.onload&&(this.onload=$I.onload),$I.onerror&&(this.onerror=$I.onerror),$I.onCreate&&$I.onCreate(this)),this._image.crossOrigin=$x&&0==$x.indexOf("data:")?null:"",$x&&(this._image.src=$x);else if($x instanceof ArrayBuffer){this._src=$I,this._url=this._src;var $a=new $w($x);$a.readUTFBytes(4),$a.readUTFBytes(2),$a.getInt16();$a.endian="bigEndian",this._w=$a.getInt16(),this._h=$a.getInt16();$a.getInt16(),$a.getInt16();this._image=new Uint8Array($x,$a.pos),this._format=$yx.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$o.enabled&&this._w<$o.atlasLimitWidth&&this._h<$o.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($x instanceof Uint8Array))return this._src=$I,this._url=this._src,this._image=$x.source||$x,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$I,this._url=this._src,this._w=$l,this._h=$n,this._image=$x,this._format=0===$z?$x.byteLength/($l*$n)==4?6408:6407:$z}this._$5__enableMerageInAtlas=!0}}$T($$,"laya.webgl.resource.WebGLImage",$N);var $I=$$.prototype;return $P.imps($I,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$I._init_=function($x,$I){},$I._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $x=$yx.mainContext,$I=this._source=$x.createTexture(),$z=$Cx.curBindTexTarget,$k=$Cx.curBindTexValue;$Cx.bindTexture($x,3553,$I);var $l=this.minFifter,$n=this.magFifter,$a=this.repeat?10497:33071,$$=$F.isPOT(this._w,this._h),$w=!1;switch($$?(this.mipmap?-1!==$l||($l=9987):-1!==$l||($l=9729),-1!==$n||($n=9729),$x.texParameteri(3553,10241,$l),$x.texParameteri(3553,10240,$n),$x.texParameteri(3553,10242,$a),$x.texParameteri(3553,10243,$a),this.mipmap&&$x.generateMipmap(3553)):(-1!==$l||($l=9729),-1!==$n||($n=9729),$x.texParameteri(3553,10241,$l),$x.texParameteri(3553,10240,$n),$x.texParameteri(3553,10242,33071),$x.texParameteri(3553,10243,33071)),$x.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$x.pixelStorei($x.UNPACK_ALIGNMENT,1),$x.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$x.pixelStorei($x.UNPACK_ALIGNMENT,1),$x.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$w=!0,$x.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $yx.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$w=!0,$x.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$x.pixelStorei(37441,!1),$z&&$k&&$Cx.bindTexture($x,$z,$k),this.uri||(this.uri=this._url),$w?this.memorySize=this._image.length:$$&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$I.recreateResource=function(){var $x=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $I=this;this._image=new $_.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($I._needReleaseAgain)return $I._needReleaseAgain=!1,$I._image.onload=null,void($I._image=null);$I._allowMerageInAtlas&&$I._enableMerageInAtlas?($x.memorySize=0,$x._recreateLock=!1):$I._createWebGlTexture(),$I.completeCreate()},this._image.src=this._src}},$I.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$yx.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$I.onresize=function(){this._w=this._image.width,this._h=this._image.height,$o.enabled&&this._w<$o.atlasLimitWidth&&this._h<$o.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$I.clearAtlasSource=function(){this._image=null},$k(0,$I,"format",function(){return this._format}),$k(0,$I,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($x){this._$5__enableMerageInAtlas=$x}),$k(0,$I,"mipmap",function(){return this._mipmap}),$k(0,$I,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$k(0,$I,"atlasSource",function(){return this._image}),$k(0,$I,"onload",null,function($x){var $I=this;this._onload=$x,this._image&&(this._image.onload=null!=this._onload?function(){$I.onresize(),$I._onload()}:null)}),$k(0,$I,"onerror",null,function($x){var $I=this;this._onerror=$x,this._image&&(this._image.onerror=null!=this._onerror?function(){$I._onerror()}:null)}),$$}();$P.__init([$_x,$q,$vx,$mx])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($x,$I){"use strict";for(var $z in Object.defineProperty($I,"__esModule",{value:!0}),Laya){var $k=Laya[$z];$k&&$k.__isclass&&($I[$z]=$k)}}),function($n,$x,$B){$B.un,$B.uns;var $k=$B.static,$l=$B.class,$a=$B.getset,$$=($B.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$R=laya.utils.ClassUtils,$b=(laya.events.Event,laya.utils.HTMLChar),$w=laya.net.Loader,$i=(laya.display.Node,laya.maths.Rectangle),$F=laya.renders.Render,$T=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$_=laya.utils.Stat,$e=laya.display.Text,$s=laya.resource.Texture,$N=laya.net.URL,$D=laya.utils.Utils,$f=function(){function $_(){}return $l($_,"laya.html.utils.HTMLParse"),$_.parse=function($x,$I,$z){$I=($I="<root>"+($I=$I.replace(/<br>/g,"<br/>"))+"</root>").replace($_.spacePattern,$_.char255);var $k=$D.parseXMLFromString($I);$_._parseXML($x,$k.childNodes[0].childNodes,$z)},$_._parseXML=function($x,$I,$z,$k){var $l=0,$n=0;if($I.join||$I.item)for($l=0,$n=$I.length;$l<$n;++$l)$_._parseXML($x,$I[$l],$z,$k);else{var $a,$$,$w;if(3==$I.nodeType)return void($x instanceof laya.html.dom.HTMLDivElement?(null==$I.nodeName&&($I.nodeName="#text"),$$=$I.nodeName.toLowerCase(),0<($w=$I.textContent.replace(/^\s+|\s+$/g,"")).length&&($a=$R.getInstance($$))&&($x.addChild($a),$a.innerTEXT=$w.replace($_.char255AndOneSpacePattern," "))):0<($w=$I.textContent.replace(/^\s+|\s+$/g,"")).length&&($x.innerTEXT=$w.replace($_.char255AndOneSpacePattern," ")));if("#comment"==($$=$I.nodeName.toLowerCase()))return;if($a=$R.getInstance($$)){($a=$x.addChild($a)).URI=$z,$a.href=$k;var $i=$I.attributes;if($i&&0<$i.length)for($l=0,$n=$i.length;$l<$n;++$l){var $F=$i[$l],$b=$F.nodeName,$T=$F.value;$a._setAttributes($b,$T)}$_._parseXML($a,$I.childNodes,$z,$a.href)}else $_._parseXML($x,$I.childNodes,$z,$k)}},$_.char255=String.fromCharCode(255),$_.spacePattern=/&nbsp;|&#160;/g,$_.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$_}(),$m=function(){function $h(){}return $l($h,"laya.html.utils.Layout"),$h.later=function($x){null==$h._will&&($h._will=[],$B.stage.frameLoop(1,null,function(){if(!($h._will.length<1)){for(var $x=0;$x<$h._will.length;$x++)laya.html.utils.Layout.layout($h._will[$x]);$h._will.length=0}})),$h._will.push($x)},$h.layout=function($x){if(!$x||!$x._style)return null;if(0==(512&$x._style._type))return null;$x.getStyle()._type&=-513;var $I=$h._multiLineLayout($x);return $F.isConchApp&&$x.layaoutCallNative&&$x.layaoutCallNative(),$I},$h._multiLineLayout=function($x){if($e.RightToLeft)return $h._multiLineLayout2($x);var $I=new Array;$x._addChildsToLayout($I);var $z,$k,$l,$n,$a,$$=0,$w=$I.length,$i=$x._getCSSStyle(),$F=$i.letterSpacing,$b=$i.leading,$T=$i.lineHeight,$_=$i._widthAuto()||!$i.wordWrap,$R=$_?999999:$x.width,$s=($x.height,0),$N=$i.italic?$i.fontSize/3:0,$D=$i._getAlign(),$f=$i._getValign(),$m=0!==$f||0!==$D||0!=$T,$y=0,$C=0,$P=0,$v=0,$L=new Array,$K=$L[0]=new $A,$E=!1,$O=!1;$K.h=0,$i.italic&&($R-=$i.fontSize/3);var $S=0,$Z=!0;function $U(){$K.y=$C,$C+=$K.h+$b,0==$K.h&&($C+=$T),$K.mWidth=$S,$S=0,$K=new $A,$L.push($K),$K.h=0,$E=!($Z=!($y=0))}if($e.WordSplitArr&&$e.WordSplitArr.length){var $X,$d=[],$j=[],$t=0,$Y=0,$c=0;for($$=0;$$<$w;$$++)if($X=$I[$$],$j.push($X),$X?($c+=$Y=$X instanceof laya.html.dom.HTMLBrElement?0:$X._isChar()?$X.width+$F:($l=$X._getCSSStyle().padding,$X.width*$X._style._tf.scaleX+$l[1]+$l[3]+$F),$t+=$Y,$X&&$X instanceof laya.html.dom.HTMLBrElement||$X&&"\n"===$X.char||$$==$w-1?($d.push($j),$j=[],$c=0):-1!=$B.Text.WordSplitArr.indexOf($X.char)&&($d.push($j),$j=[],$c=0)):($c+=$h.DIV_ELEMENT_PADDING,$t+=$h.DIV_ELEMENT_PADDING),$X&&$X instanceof laya.html.dom.HTMLBrElement||$X&&"\n"===$X.char||$$==$w-1||$R<$t){$t=$c;for(var $V=0;$V<$d.length;$V++)for(var $W=0;$W<$d[$V].length;$W++)null!=($z=$d[$V][$W])?($Z=!1,$z instanceof laya.html.dom.HTMLBrElement?$K.y=$C:($z._isChar()?(($n=$z).isWord?$K.wordStartIndex=$K.elements.length:($P=$n.width+$n.style.letterSpacing,$S+=$n.width),$P=$n.width+$F,$v=$n.height,$K.minTextHeight=Math.min($K.minTextHeight,$z.height)):($k=$z._getCSSStyle(),$a=$z,$l=$k.padding,0===$k._getCssFloat()||($m=!0),$E=$O||$k.lineElement,$P=$a.width*$a._style._tf.scaleX+$l[1]+$l[3]+$F,$v=$a.height*$a._style._tf.scaleY+$l[0]+$l[2]),$K.elements.push($z),$K.h=Math.max($K.h,$v),$z.x=$y,$z.y=$C,$y+=$P,$K.w=$y-$F,$K.y=$C,$s=Math.max($y+$N,$s))):($Z||($y+=$h.DIV_ELEMENT_PADDING),$K.wordStartIndex=$K.elements.length);$d=[],$$<$w-1&&$U()}}else for($$=0;$$<$w;$$++)if(null!=($z=$I[$$]))if($Z=!1,$z instanceof laya.html.dom.HTMLBrElement)$U(),$K.y=$C;else{if($z._isChar()){if(($n=$z).isWord)$E=$O||"\n"===$n.char,$K.wordStartIndex=$K.elements.length;else{if($P=$n.width+$n.style.letterSpacing,0<$L.length&&$R<$y+$P&&0<$K.wordStartIndex){var $q;$q=$K.elements.length-$K.wordStartIndex+1,$K.elements.length=$K.wordStartIndex,$$-=$q,$U();continue}$E=!1,$S+=$n.width}$P=$n.width+$F,$v=$n.height,$O=!1,($E=$E||$R<$y+$P)&&$U(),$K.minTextHeight=Math.min($K.minTextHeight,$z.height)}else $k=$z._getCSSStyle(),$a=$z,$l=$k.padding,0===$k._getCssFloat()||($m=!0),$E=$O||$k.lineElement,$P=$a.width*$a._style._tf.scaleX+$l[1]+$l[3]+$F,$v=$a.height*$a._style._tf.scaleY+$l[0]+$l[2],$O=$k.lineElement,($E=$E||$R<$y+$P&&$k.wordWrap)&&$U();$K.elements.push($z),$K.h=Math.max($K.h,$v),$z.x=$y,$z.y=$C,$y+=$P,$K.w=$y-$F,$K.y=$C,$s=Math.max($y+$N,$s)}else $Z||($y+=$h.DIV_ELEMENT_PADDING),$K.wordStartIndex=$K.elements.length;if($C=$K.y+$K.h,$m){var $o=0,$J=$R;for($_&&0<$x.width&&($J=$x.width),$$=0,$w=$L.length;$$<$w;$$++)$L[$$].updatePos(0,$J,$$,$o,$D,$f,$T),$o+=Math.max($T,$L[$$].h+$b);$C=$o}return $_&&($x.width=$s),$C>$x.height&&($x.height=$C),[$s,$C]},$h._multiLineLayout2=function($x){var $I=new Array;$x._addChildsToLayout($I);var $z,$k,$l,$n,$a,$$=0,$w=$I.length,$i=$x._getCSSStyle(),$F=$i.letterSpacing,$b=$i.leading,$T=$i.lineHeight,$_=$i._widthAuto()||!$i.wordWrap,$R=$_?999999:$x.width,$s=($x.height,0),$N=$i.italic?$i.fontSize/3:0,$D=2-$i._getAlign(),$f=$i._getValign(),$m=0!==$f||0!=$D||0!=$T,$y=0,$C=0,$P=0,$v=0,$L=new Array,$K=$L[0]=new $A,$E=!1,$O=!1;$K.h=0,$i.italic&&($R-=$i.fontSize/3);var $S=0,$Z=!0;function $U(){$K.y=$C,$C+=$K.h+$b,0==$K.h&&($C+=$T),$K.mWidth=$S,$S=0,$K=new $A,$L.push($K),$K.h=0,$E=!($Z=!($y=0))}if($e.WordSplitArr&&$e.WordSplitArr.length){var $X,$d=[],$j=[],$t=0,$Y=0,$c=0;for($$=0;$$<$w;$$++)if($X=$I[$$],$j.push($X),$X?($c+=$Y=$X instanceof laya.html.dom.HTMLBrElement?0:$X._isChar()?$X.width+$F:($l=$X._getCSSStyle().padding,$X.width*$X._style._tf.scaleX+$l[1]+$l[3]+$F),$t+=$Y,$X&&$X instanceof laya.html.dom.HTMLBrElement||$X&&"\n"===$X.char||$$==$w-1?($d.push($j),$j=[],$c=0):-1!=$B.Text.WordSplitArr.indexOf($X.char)&&($d.push($j),$j=[],$c=0)):($c+=$h.DIV_ELEMENT_PADDING,$t+=$h.DIV_ELEMENT_PADDING),$X&&$X instanceof laya.html.dom.HTMLBrElement||$X&&"\n"===$X.char||$$==$w-1||$R<$t){$t=$c;for(var $V=0;$V<$d.length;$V++)for(var $W=0;$W<$d[$V].length;$W++)null!=($z=$d[$V][$W])?($Z=!1,$z instanceof laya.html.dom.HTMLBrElement?$K.y=$C:($z._isChar()?(($n=$z).isWord?$K.wordStartIndex=$K.elements.length:($P=$n.width+$n.style.letterSpacing,$S+=$n.width),$P=$n.width+$F,$v=$n.height,$K.minTextHeight=Math.min($K.minTextHeight,$z.height)):($k=$z._getCSSStyle(),$a=$z,$l=$k.padding,0===$k._getCssFloat()||($m=!0),$E=$O||$k.lineElement,$P=$a.width*$a._style._tf.scaleX+$l[1]+$l[3]+$F,$v=$a.height*$a._style._tf.scaleY+$l[0]+$l[2]),$K.elements.push($z),$K.h=Math.max($K.h,$v),$z.x=$y,$z.y=$C,$y+=$P,$K.w=$y-$F,$K.y=$C,$s=Math.max($y+$N,$s))):($Z||($y+=$h.DIV_ELEMENT_PADDING),$K.wordStartIndex=$K.elements.length);$d=[],$$<$w-1&&$U()}}else for($$=0;$$<$w;$$++)if(null!=($z=$I[$$]))if($Z=!1,$z instanceof laya.html.dom.HTMLBrElement)$U(),$K.y=$C;else{if($z._isChar()){if(($n=$z).isWord)$E=$O||"\n"===$n.char,$K.wordStartIndex=$K.elements.length;else{if(0<$L.length&&$R<$y+$P&&0<$K.wordStartIndex){var $q;$q=$K.elements.length-$K.wordStartIndex+1,$K.elements.length=$K.wordStartIndex,$$-=$q,$U();continue}$E=!1,$S+=$n.width}$P=$n.width+$F,$v=$n.height,$O=!1,($E=$E||$R<$y+$P)&&$U(),$K.minTextHeight=Math.min($K.minTextHeight,$z.height)}else $k=$z._getCSSStyle(),$a=$z,$l=$k.padding,0===$k._getCssFloat()||($m=!0),$E=$O||$k.lineElement,$P=$a.width*$a._style._tf.scaleX+$l[1]+$l[3]+$F,$v=$a.height*$a._style._tf.scaleY+$l[0]+$l[2],$O=$k.lineElement,($E=$E||$R<$y+$P&&$k.wordWrap)&&$U();$K.elements.push($z),$K.h=Math.max($K.h,$v),$z.x=$y,$z.y=$C,$y+=$P,$K.w=$y-$F,$K.y=$C,$s=Math.max($y+$N,$s)}else $Z||($y+=$h.DIV_ELEMENT_PADDING),$K.wordStartIndex=$K.elements.length;if($C=$K.y+$K.h,$m){var $o=0,$J=$R;for($$=0,$w=$L.length;$$<$w;$$++)$L[$$].updatePos(0,$J,$$,$o,$D,$f,$T),$o+=Math.max($T,$L[$$].h+$b);$C=$o}for($_&&($x.width=$s),$C>$x.height&&($x.height=$C),$$=0,$w=$L.length;$$<$w;$$++)$L[$$].revertOrder($R);return[$s,$C]},$h._will=null,$h.DIV_ELEMENT_PADDING=0,$h}(),$A=function(){function $x(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$l($x,"laya.html.utils.LayoutLine");var $I=$x.prototype;return $I.updatePos=function($x,$I,$z,$k,$l,$n,$a){var $$,$w=0;0<this.elements.length&&($w=($$=this.elements[this.elements.length-1]).x+$$.width-this.elements[0].x);var $i=0,$F=NaN;1===$l&&($i=($I-$w)/2),2===$l&&($i=$I-$w),0===$a||0!=$n||($n=1);for(var $b=0,$T=this.elements.length;$b<$T;$b++){var $_=($$=this.elements[$b])._getCSSStyle();switch(0!==$i&&($$.x+=$i),$_._getValign()){case 0:$$.y=$k;break;case 1:var $R=0;99999!=this.minTextHeight&&($R=this.minTextHeight);var $s=($R+$a)/2;$s=Math.max($s,this.h),$F=(laya.html.dom.HTMLImageElement,$k+$s-$$.height),$$.y=$F;break;case 2:$$.y=$k+($a-$$.height)}}},$I.revertOrder=function($x){var $I;if(0<this.elements.length){var $z,$k=0;for($z=this.elements.length,$k=0;$k<$z;$k++)($I=this.elements[$k]).x=$x-$I.x-$I.width}},$x}(),$y=function($z){function $I(){this.URI=null,this._href=null,$I.__super.call(this),this._text=$I._EMPTYTEXT,this.setStyle(new $$(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$l($I,"laya.html.dom.HTMLElement",$z);var $x=$I.prototype;return $x.layaoutCallNative=function(){var $x=0;if(this._childs&&0<($x=this._childs.length))for(var $I=0;$I<$x;$I++)this._childs[$I].layaoutCallNative&&this._childs[$I].layaoutCallNative();var $z=this._getWords();$z?laya.html.dom.HTMLElement.fillWords(this,$z,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$x.appendChild=function($x){return this.addChild($x)},$x._getWords2=function(){var $x=this._text.text;if(!$x||0===$x.length)return null;var $I,$z,$k=0,$l=0;if(this._text.drawWords)$z=this._text.drawWords;else{for($l=($I=$x.split(" ")).length-1,$z=[],$k=0;$k<$l;$k++)$z.push($I[$k]," ");0<=$l&&$z.push($I[$l]),this._text.drawWords=$z}var $n,$a=this._text.words;if($a&&$a.length===$z.length)return $a;null===$a&&(this._text.words=$a=[]),$a.length=$z.length;var $$=this.style,$w=$$.font;for($k=0,$l=$z.length;$k<$l;$k++){$n=$D.measureText($z[$k],$w);var $i=$a[$k]=new $b($z[$k],$n.width,$n.height||$$.fontSize,$$);if(1<$i.char.length&&($i.charNum=$i.char),this.href){var $F=new $T;this.addChild($F),$i.setSprite($F)}}return $a},$x._getWords=function(){if(!$e.CharacterCache)return this._getWords2();var $x=this._text.text;if(!$x||0===$x.length)return null;var $I,$z=this._text.words;if($z&&$z.length===$x.length)return $z;null===$z&&(this._text.words=$z=[]),$z.length=$x.length;for(var $k=this.style,$l=$k.font,$n=0,$a=$x.length;$n<$a;$n++)if($I=$D.measureText($x.charAt($n),$l)){var $$=$z[$n]=new $b($x.charAt($n),$I.width,$I.height||$k.fontSize,$k);if(this.href){var $w=new $T;this.addChild($w),$$.setSprite($w)}}else console.warn("_getWords size is null"+$x.charAt($n),$l);return $z},$x.showLinkSprite=function(){var $x=this._text.words;if($x)for(var $I,$z,$k=[],$l=0;$l<$x.length;$l++)$z=$x[$l],($I=new $T).graphics.drawRect(0,0,$z.width,$z.height,"#ff0000"),$I.width=$z.width,$I.height=$z.height,this.addChild($I),$k.push($I)},$x._layoutLater=function(){var $x=this.style;512&$x._type||($x.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$x.block?($m.later(this),$x._type|=512):this.parent&&this.parent._layoutLater())},$x._setAttributes=function($x,$I){switch($x){case"style":return void this.style.cssText($I);case"class":return void(this.className=$I)}$z.prototype._setAttributes.call(this,$x,$I)},$x.updateHref=function(){if(null!=this._href){var $x=this._getWords();if($x)for(var $I,$z,$k=0;$k<$x.length;$k++)($z=($I=$x[$k]).getSprite())&&($z.size($I.width,$I.height),$z.on("click",this,this.onLinkHandler))}},$x.onLinkHandler=function($x){switch($x.type){case"click":for(var $I=this;$I;)$I.event("link",[this.href]),$I=$I.parent}},$x.formatURL=function($x){return this.URI?$N.formatURL($x,this.URI?this.URI.path:null):$x},$a(0,$x,"href",function(){return this._href},function($x){null!=(this._href=$x)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$a(0,$x,"color",null,function($x){this.style.color=$x}),$a(0,$x,"onClick",null,function($x){$B._runScript("fn=function(event){"+$x+";}"),this.on("click",this,void 0)}),$a(0,$x,"id",null,function($x){$C.document.setElementById($x,this)}),$a(0,$x,"innerTEXT",function(){return this._text.text},function($x){this.text=$x}),$a(0,$x,"style",function(){return this._style}),$a(0,$x,"text",function(){return this._text.text},function($x){this._text==$I._EMPTYTEXT?this._text={text:$x,words:null}:(this._text.text=$x,this._text.words&&(this._text.words.length=0)),$F.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$a(0,$x,"parent",$z.prototype._$get_parent,function($x){if($x instanceof laya.html.dom.HTMLElement){var $I=$x;this.URI||(this.URI=$I.URI),this.style.inherit($I.style)}$B.superSet($T,this,"parent",$x)}),$a(0,$x,"className",null,function($x){this.style.attrs($C.document.styleSheets["."+$x])}),$I.fillWords=function($x,$I,$z,$k,$l,$n,$a){$x.graphics.clear();for(var $$=0,$w=$I.length;$$<$w;$$++){var $i=$I[$$];$x.graphics.fillText($i.char,$i.x+$z,$i.y+$k,$l,$n,"left",$a)}},$I._EMPTYTEXT={text:null,words:null},$I}($T),$I=(function($x){function $I(){$I.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$l($I,"laya.html.dom.HTMLBrElement",$y)}(),function($x){function $I(){this.contextHeight=NaN,this.contextWidth=NaN,$I.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$l($I,"laya.html.dom.HTMLDivElement",$x);var $z=$I.prototype;return $z.appendHTML=function($x){$f.parse(this,$x,this.URI),this.layout()},$z._addChildsToLayout=function($I){var $x=this._getWords();if(null==$x&&0==this._childs.length)return!1;$x&&$x.forEach(function($x){$I.push($x)});for(var $z=!0,$k=0,$l=this._childs.length;$k<$l;$k++){var $n=this._childs[$k];$z?$z=!1:$I.push(null),$n._addToLayout($I)}return!0},$z._addToLayout=function($x){this.layout()},$z.layout=function(){if(this.style){this.style._type|=512;var $x=$m.layout(this);if($x){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $i);var $I=this._$P.mHtmlBounds;$I.x=$I.y=0,$I.width=this.contextWidth=$x[0],$I.height=this.contextHeight=$x[1],this.setBounds($I)}}},$a(0,$z,"height",function(){return this._height?this._height:this.contextHeight},$x.prototype._$set_height),$a(0,$z,"innerHTML",null,function($x){this.destroyChildren(),this.appendHTML($x)}),$a(0,$z,"width",function(){return this._width?this._width:this.contextWidth},function($x){var $I=!1;$I=0===$x?$x!=this._width:$x!=this.width,$B.superSet($y,this,"width",$x),$I&&this.layout()}),$I}($y)),$C=function($x){function $I(){this.all=new Array,this.styleSheets=$$.styleSheets,$I.__super.call(this)}$l($I,"laya.html.dom.HTMLDocument",$y);var $z=$I.prototype;return $z.getElementById=function($x){return this.all[$x]},$z.setElementById=function($x,$I){this.all[$x]=$I},$k($I,["document",function(){return this.document=new $I}]),$I}();(function($x){function $I(){this._tex=null,this._url=null,this._renderArgs=[],$I.__super.call(this),this.style.block=!0}$l($I,"laya.html.dom.HTMLImageElement",$y);var $z=$I.prototype;$z._addToLayout=function($x){!this._style.absolute&&$x.push(this)},$z.render=function($x,$I,$z){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($_.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$x.ctx.drawTexture2($I,$z,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$z.layaoutCallNative=function(){var $x=0;if(this._childs&&0<($x=this._childs.length))for(var $I=0;$I<$x;$I++)this._childs[$I].layaoutCallNative&&this._childs[$I].layaoutCallNative()},$a(0,$z,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($x){this._width!==$x&&(this._width=$x,this._style.width=$x,this.repaint())}),$a(0,$z,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($x){this._height!==$x&&(this._height=$x,this._style.height=$x,this.repaint())}),$z.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$w.clearCache(this,this._url),this._tex=null),$y.prototype.destroy.call(this)},$z.onloaded=function(){var $x=this._style;$x&&!$x.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$x&&!$x.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$F.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$z._loadImageComplete=function($x,$I,$z){if(!this._destroyed)if(null!=$z)if($z instanceof ArrayBuffer){var $k=new DataView($z);new laya.webgl.resource.WebGLImage(new Uint8Array($z,8),$x,0,!1,$k.getUint32(0),$k.getUint32(4));this.onloaded()}else if($z instanceof $s)$w.imgMgrSet[$x]=$I,$n.imgMgrLock($x,$w.imgMgrSet[$x]),this._url=$x,this._tex=$z,$w.keepCache(this,$x),$w.cacheRes($x,this._tex),this.onloaded();else{var $l=-1!=$x.indexOf(".png",$x.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($z,$x,$l,!1,$z.width,$z.height);this.onloaded()}else this.event("error","Load image failed")},$a(0,$z,"src",null,function($x){($x=this.formatURL($x),this._url!=$x)&&(null!=this._tex&&($w.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$x,(this._tex=$w.getRes($x))?($w.keepCache(this,$x),this.onloaded()):$n.imgMgrLoad($x,this._loadImageComplete.bind(this),2,!1))})})(),function($x){function $I(){this.type=null,$I.__super.call(this),this.visible=!1}$l($I,"laya.html.dom.HTMLLinkElement",$x);var $z=$I.prototype;$z._onload=function($x){switch(this.type){case"text/css":$$.parseCSS($x,this.URI)}},$a(0,$z,"href",$x.prototype._$get_href,function($x){var $I=this;$x=this.formatURL($x),this.URI=new $N($x);var $z=new $w;$z.once("complete",null,function($x){$I._onload($x)}),$z.load($x,"text")}),$I._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($y),function($x){function $I(){$I.__super.call(this),this.visible=!1}$l($I,"laya.html.dom.HTMLStyleElement",$x),$a(0,$I.prototype,"text",$x.prototype._$get_text,function($x){$$.parseCSS($x,null)})}($y),function($x){function $I(){$I.__super.call(this),this._getCSSStyle().valign="middle"}$l($I,"laya.html.dom.HTMLIframeElement",$x),$a(0,$I.prototype,"href",$x.prototype._$get_href,function($z){var $k=this;$z=this.formatURL($z);var $x=new $w;$x.once("complete",null,function($x){var $I=$k.URI;$k.URI=new $N($z),$k.innerHTML=$x,!$I||($k.URI=$I)}),$x.load($z,"text")})}($I)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($x,$I){"use strict";for(var $z in Object.defineProperty($I,"__esModule",{value:!0}),Laya){var $k=Laya[$z];$k&&$k.__isclass&&($I[$z]=$k)}}),function($l,$x,$s){$s.un,$s.uns;var $k=$s.static,$n=$s.class,$a=$s.getset,$z=($s.__newvec,laya.display.Animation),$N=(laya.utils.Browser,laya.utils.ClassUtils),$$=laya.filters.ColorFilter,$w=laya.utils.Ease,$i=laya.events.Event,$F=(laya.events.EventDispatcher,laya.display.css.Font),$b=laya.display.FrameAnimation,$I=laya.display.Graphics,$T=laya.utils.Handler,$_=laya.display.Input,$f=laya.net.Loader,$R=(laya.display.Node,laya.maths.Point),$D=laya.maths.Rectangle,$m=laya.renders.Render,$y=laya.display.Sprite,$C=laya.display.Text,$P=laya.resource.Texture,$v=laya.utils.Tween,$L=laya.utils.Utils,$K=laya.utils.WeakObject;$s.interface("laya.ui.IItem"),$s.interface("laya.ui.ISelect"),$s.interface("laya.ui.IRender"),$s.interface("laya.ui.IComponent"),$s.interface("laya.ui.IBox","IComponent");var $E=function(){function $x(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $n($x,"laya.ui.LayoutStyle"),$k($x,["EMPTY",function(){return this.EMPTY=new $x}]),$x}(),$O=function(){function $x(){}return $n($x,"laya.ui.Styles"),$x.labelColor="#000000",$x.buttonStateNum=3,$x.scrollBarMinNum=15,$x.scrollBarDelayTime=500,$k($x,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$x}(),$S=function(){function $l(){}return $n($l,"laya.ui.UIUtils"),$l.fillArray=function($x,$I,$z){var $k=$x.concat();if($I)for(var $l=$I.split(","),$n=0,$a=Math.min($k.length,$l.length);$n<$a;$n++){var $$=$l[$n];$k[$n]="true"==$$||"false"!=$$&&$$,null!=$z&&($k[$n]=$z($$))}return $k},$l.toColor=function($x){return $L.toHexColor($x)},$l.gray=function($x,$I){void 0===$I&&($I=!0),$I?$l.addFilter($x,$l.grayFilter):$l.clearFilter($x,$$)},$l.addFilter=function($x,$I){var $z=$x.filters||[];$z.push($I),$x.filters=$z},$l.clearFilter=function($x,$I){var $z=$x.filters;if(null!=$z&&0<$z.length){for(var $k=$z.length-1;-1<$k;$k--){var $l=$z[$k];$s.__typeof($l,$I)&&$z.splice($k,1)}$x.filters=$z}},$l._getReplaceStr=function($x){return $l.escapeSequence[$x]},$l.adptString=function($x){return $x.replace(/\\(\w)/g,$l._getReplaceStr)},$l.getBindFun=function($x){var $I=$l._funMap.get($x);if(null==$I){var $z='"'+$x+'"',$k="(function(data){if(data==null)return;with(data){try{\nreturn "+($z=$z.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$I=$s._runScript($k),$l._funMap.set($x,$I)}return $I},$k($l,["grayFilter",function(){return this.grayFilter=new $$([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $K}]),$l}(),$Z=function(){function $x(){}return $n($x,"UIConfig"),$x.touchScrollEnable=!0,$x.mouseWheelEnable=!0,$x.showButtons=!0,$x.popupBgColor="#000000",$x.popupBgAlpha=.5,$x.closeDialogOnSide=!0,$x}(),$U=function($z){function $D(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$D.__super.call(this),this._weakKeys=[]}$n($D,"laya.ui.AutoBitmap",$z);var $x=$D.prototype;return $x.destroy=function(){if($f.clearObject(this,this._weakKey),this._weakKeys){for(var $x=0,$I=this._weakKeys.length;$x<$I;++$x)$f.clearObject(this,this._weakKeys[$x]);this._weakKeys=null}$z.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$x._setChanged=function(){this._isChanged||(this._isChanged=!0,$s.timer.callLater(this,this.changeSource))},$x.changeSource=function(){this._isChanged=!1;var $x=this._source;if($x&&$x.bitmap){var $I=this.width,$z=this.height,$k=this._sizeGrid,$l=$x.sourceWidth,$n=$x.sourceHeight;if(!$k||$l===$I&&$n===$z)this.cleanByTexture($x,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$I,$z);else{$f.clearObject(this,this._weakKey),$x.$_GID||($x.$_GID=$L.getGID());var $a=$x.$_GID+"."+$I+"."+$z+"."+$k.join("."),$$=$f.findObject($a);if($L.isOKCmdList($$))return this._weakKey=$a,$f.keepObject(this,this._weakKey),void(this.cmds=$$);this.clear();var $w,$i,$F=$k[0],$b=$k[1],$T=$k[2],$_=$k[3],$R=$k[4],$s=!1;if($I==$l&&($_=$b=0),$z==$n&&($F=$T=0),$I<$_+$b){var $N=$I;$s=!0,$I=$_+$b,this.save(),this.clipRect(0,0,$N,$z)}$_&&$F&&($w=$D.getTexture($x,0,0,$_,$F),$i=this._weakKeys[0],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[0]=$w.weakKey),this.drawTexture($w,0,0,$_,$F)):($f.clearObject(this,$i),this._weakKeys[0]="")),$b&&$F&&($w=$D.getTexture($x,$l-$b,0,$b,$F),$i=this._weakKeys[1],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[1]=$w.weakKey),this.drawTexture($w,$I-$b,0,$b,$F)):($f.clearObject(this,$i),this._weakKeys[1]="")),$_&&$T&&($w=$D.getTexture($x,0,$n-$T,$_,$T),$i=this._weakKeys[2],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[2]=$w.weakKey),this.drawTexture($w,0,$z-$T,$_,$T)):($f.clearObject(this,$i),this._weakKeys[2]="")),$b&&$T&&($w=$D.getTexture($x,$l-$b,$n-$T,$b,$T),$i=this._weakKeys[3],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[3]=$w.weakKey),this.drawTexture($w,$I-$b,$z-$T,$b,$T)):($f.clearObject(this,$i),this._weakKeys[3]="")),$F&&($w=$D.getTexture($x,$_,0,$l-$_-$b,$F),$i=this._weakKeys[4],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[4]=$w.weakKey),this.drawBitmap($R,$w,$_,0,$I-$_-$b,$F)):($f.clearObject(this,$i),this._weakKeys[4]="")),$T&&($w=$D.getTexture($x,$_,$n-$T,$l-$_-$b,$T),$i=this._weakKeys[5],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[5]=$w.weakKey),this.drawBitmap($R,$w,$_,$z-$T,$I-$_-$b,$T)):($f.clearObject(this,$i),this._weakKeys[5]="")),$_&&($w=$D.getTexture($x,0,$F,$_,$n-$F-$T),$i=this._weakKeys[6],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[6]=$w.weakKey),this.drawBitmap($R,$w,0,$F,$_,$z-$F-$T)):($f.clearObject(this,$i),this._weakKeys[6]="")),$b&&($w=$D.getTexture($x,$l-$b,$F,$b,$n-$F-$T),$i=this._weakKeys[7],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[7]=$w.weakKey),this.drawBitmap($R,$w,$I-$b,$F,$b,$z-$F-$T)):($f.clearObject(this,$i),this._weakKeys[7]="")),$w=$D.getTexture($x,$_,$F,$l-$_-$b,$n-$F-$T),$i=this._weakKeys[8],$w?($i!=$w.weakKey&&($f.clearObject(this,$i),$f.keepObject(this,$w.weakKey),this._weakKeys[8]=$w.weakKey),this.drawBitmap($R,$w,$_,$F,$I-$_-$b,$z-$F-$T)):($f.clearObject(this,$i),this._weakKeys[8]=""),$s&&this.restore(),this.autoCacheCmd&&!$m.isConchApp&&($f.saveObject($a,this.cmds,null),this._weakKey=$a,$f.keepObject(this,this._weakKey))}this._repaint()}},$x.drawBitmap=function($x,$I,$z,$k,$l,$n){void 0===$l&&($l=0),void 0===$n&&($n=0),$l<.1||$n<.1||(!$x||$I.width==$l&&$I.height==$n?this.drawTexture($I,$z,$k,$l,$n):this.fillTexture($I,$z,$k,$l,$n))},$x.clear=function($x){void 0===$x&&($x=!0),$z.prototype.clear.call(this,!1)},$a(0,$x,"sizeGrid",function(){return this._sizeGrid},function($x){this._sizeGrid=$x,this._setChanged()}),$a(0,$x,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($x){this._width!=$x&&(this._width=$x,this._setChanged())}),$a(0,$x,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($x){this._height!=$x&&(this._height=$x,this._setChanged())}),$a(0,$x,"source",function(){return this._source},function($x){$x?(this._source=$x,this._setChanged()):(this._source=null,this.clear())}),$D.getTexture=function($x,$I,$z,$k,$l){$k<=0&&($k=1),$l<=0&&($l=1),$x.$_GID||($x.$_GID=$L.getGID());var $n=$x.$_GID+"."+$I+"."+$z+"."+$k+"."+$l,$a=$f.findObject($n);if((!$a||!$a.source)&&($a=$P.createFromTexture($x,$I,$z,$k,$l))){if($x.alphaTexture){var $$=$x.width/$x.alphaTexture.width;$a.alphaTexture=$P.createFromTexture($x.alphaTexture,$I/$$,$z/$$,$k/$$,$l/$$)}$f.saveObject($n,$a),$a.weakKey=$n}return $a},$D}($I),$X=(function($x){function $I(){$I.__super.call(this)}$n($I,"laya.ui.UIEvent",$i),$I.SHOW_TIP="showtip",$I.HIDE_TIP="hidetip"}(),function($I){function $x(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$x.__super.call(this),this._layout=$E.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$n($x,"laya.ui.Component",$I);var $z=$x.prototype;return $s.imps($z,{"laya.ui.IComponent":!0}),$z.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$z.preinitialize=function(){},$z.createChildren=function(){},$z.initialize=function(){},$z.callLater=function($x,$I){$s.timer.callLater(this,$x,$I)},$z.runCallLater=function($x){$s.timer.runCallLater(this,$x)},$z.commitMeasure=function(){},$z.changeSize=function(){this.event("resize")},$z.getLayout=function(){return this._layout===$E.EMPTY&&(this._layout=new $E),this._layout},$z._setLayoutEnabled=function($x){this._layout&&this._layout.enable!=$x&&(this._layout.enable=$x,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$z.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$z.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$z.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$z.resetLayoutX=function(){var $x=this._layout;if(isNaN($x.anchorX)||(this.pivotX=$x.anchorX*this.width),this.layoutEnabled){var $I=this.parent;$I&&(isNaN($x.centerX)?isNaN($x.left)?isNaN($x.right)||(this.x=Math.round($I.width-this.displayWidth-$x.right+this.pivotX*this.scaleX)):(this.x=Math.round($x.left+this.pivotX*this.scaleX),isNaN($x.right)||(this.width=($I._width-$x.left-$x.right)/(this.scaleX||.01))):this.x=Math.round(.5*($I.width-this.displayWidth)+$x.centerX+this.pivotX*this.scaleX))}},$z.resetLayoutY=function(){var $x=this._layout;if(isNaN($x.anchorY)||(this.pivotY=$x.anchorY*this.height),this.layoutEnabled){var $I=this.parent;$I&&(isNaN($x.centerY)?isNaN($x.top)?isNaN($x.bottom)||(this.y=Math.round($I.height-this.displayHeight-$x.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($x.top+this.pivotY*this.scaleY),isNaN($x.bottom)||(this.height=($I._height-$x.top-$x.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($I.height-this.displayHeight)+$x.centerY+this.pivotY*this.scaleY))}},$z.onMouseOver=function($x){$s.stage.event("showtip",this._toolTip)},$z.onMouseOut=function($x){$s.stage.event("hidetip",this._toolTip)},$a(0,$z,"displayWidth",function(){return this.width*this.scaleX}),$a(0,$z,"width",function(){return this._width?this._width:this.measureWidth},function($x){this._width!=$x&&(this._width=$x,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$a(0,$z,"measureWidth",function(){var $x=0;this.commitMeasure();for(var $I=this.numChildren-1;-1<$I;$I--){var $z=this.getChildAt($I);$z.visible&&($x=Math.max($z.x+$z.width*$z.scaleX,$x))}return $x}),$a(0,$z,"displayHeight",function(){return this.height*this.scaleY}),$a(0,$z,"height",function(){return this._height?this._height:this.measureHeight},function($x){this._height!=$x&&(this._height=$x,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$a(0,$z,"dataSource",function(){return this._dataSource},function($x){for(var $I in this._dataSource=$x,this._dataSource)this.hasOwnProperty($I)&&"function"!=typeof this[$I]&&(this[$I]=this._dataSource[$I])}),$a(0,$z,"scaleY",$I.prototype._$get_scaleY,function($x){$s.superGet($y,this,"scaleY")!=$x&&($s.superSet($y,this,"scaleY",$x),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$a(0,$z,"measureHeight",function(){var $x=0;this.commitMeasure();for(var $I=this.numChildren-1;-1<$I;$I--){var $z=this.getChildAt($I);$z.visible&&($x=Math.max($z.y+$z.height*$z.scaleY,$x))}return $x}),$a(0,$z,"scaleX",$I.prototype._$get_scaleX,function($x){$s.superGet($y,this,"scaleX")!=$x&&($s.superSet($y,this,"scaleX",$x),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$a(0,$z,"top",function(){return this._layout.top},function($x){$x!=this._layout.top&&(this.getLayout().top=$x,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$a(0,$z,"bottom",function(){return this._layout.bottom},function($x){$x!=this._layout.bottom&&(this.getLayout().bottom=$x,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$a(0,$z,"left",function(){return this._layout.left},function($x){$x!=this._layout.left&&(this.getLayout().left=$x,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$a(0,$z,"right",function(){return this._layout.right},function($x){$x!=this._layout.right&&(this.getLayout().right=$x,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$a(0,$z,"centerX",function(){return this._layout.centerX},function($x){$x!=this._layout.centerX&&(this.getLayout().centerX=$x,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$a(0,$z,"centerY",function(){return this._layout.centerY},function($x){$x!=this._layout.centerY&&(this.getLayout().centerY=$x,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$a(0,$z,"anchorX",function(){return this._layout.anchorX},function($x){$x!=this._layout.anchorX&&(this.getLayout().anchorX=$x,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$a(0,$z,"anchorY",function(){return this._layout.anchorY},function($x){$x!=this._layout.anchorY&&(this.getLayout().anchorY=$x,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$a(0,$z,"tag",function(){return this._tag},function($x){this._tag=$x}),$a(0,$z,"toolTip",function(){return this._toolTip},function($x){this._toolTip!=$x&&(null!=(this._toolTip=$x)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$a(0,$z,"comXml",function(){return this._comXml},function($x){this._comXml=$x}),$a(0,$z,"gray",function(){return this._gray},function($x){$x!==this._gray&&(this._gray=$x,$S.gray(this,$x))}),$a(0,$z,"disabled",function(){return this._disabled},function($x){$x!==this._disabled&&(this.gray=this._disabled=$x,this.mouseEnabled=!$x)}),$x}($y)),$d=function($x){function $I(){this.lockLayer=null,this.popupEffect=function($x){$x.scale(1,1),$v.from($x,{x:$s.stage.width/2,y:$s.stage.height/2,scaleX:0,scaleY:0},300,$w.backOut,$T.create(this,this.doOpen,[$x]))},this.closeEffect=function($x,$I){$v.to($x,{x:$s.stage.width/2,y:$s.stage.height/2,scaleX:0,scaleY:0},300,$w.strongOut,$T.create(this,this.doClose,[$x,$I]))},$I.__super.call(this),this.maskLayer=new $y,this.popupEffectHandler=$T.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$T.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$s.stage.addChild(this),$s.stage.on("resize",this,this._onResize),$Z.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$n($I,"laya.ui.DialogManager",$y);var $z=$I.prototype;return $z._closeOnSide=function(){var $x=this.getChildAt(this.numChildren-1);$x instanceof laya.ui.Dialog&&$x.close("side")},$z.setLockView=function($x){this.lockLayer||(this.lockLayer=new $j,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($s.stage.width,$s.stage.height)),this.lockLayer.removeChildren(),$x&&($x.centerX=$x.centerY=0,this.lockLayer.addChild($x))},$z._onResize=function($x){var $I=this.maskLayer.width=$s.stage.width,$z=this.maskLayer.height=$s.stage.height;this.lockLayer&&this.lockLayer.size($I,$z),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$I,$z,$Z.popupBgColor),this.maskLayer.alpha=$Z.popupBgAlpha;for(var $k=this.numChildren-1;-1<$k;$k--){var $l=this.getChildAt($k);$l.popupCenter&&this._centerDialog($l)}},$z._centerDialog=function($x){$x.x=Math.round(($s.stage.width-$x.width>>1)+$x.pivotX),$x.y=Math.round(($s.stage.height-$x.height>>1)+$x.pivotY)},$z.open=function($x,$I,$z){void 0===$I&&($I=!1),void 0===$z&&($z=!1),$I&&this._closeAll(),$x.popupCenter&&this._centerDialog($x),this.addChild($x),($x.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$z&&null!=$x.popupEffect?$x.popupEffect.runWith($x):this.doOpen($x),this.event("open")},$z.doOpen=function($x){$x.onOpened()},$z.lock=function($x){this.lockLayer&&($x?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$z.close=function($x,$I,$z){void 0===$z&&($z=!1),$z&&null!=$x.closeEffect?$x.closeEffect.runWith([$x,$I]):this.doClose($x,$I),this.event("close")},$z.doClose=function($x,$I){$x.removeSelf(),$x.isModal&&this._checkMask(),$x.closeHandler&&$x.closeHandler.runWith($I),$x.onClosed($I)},$z.closeAll=function(){this._closeAll(),this.event("close")},$z._closeAll=function(){for(var $x=this.numChildren-1;-1<$x;$x--){var $I=this.getChildAt($x);$I&&null!=$I.close&&this.doClose($I)}},$z.getDialogsByGroup=function($x){for(var $I=[],$z=this.numChildren-1;-1<$z;$z--){var $k=this.getChildAt($z);$k&&$k.group===$x&&$I.push($k)}return $I},$z.closeByGroup=function($x){for(var $I=[],$z=this.numChildren-1;-1<$z;$z--){var $k=this.getChildAt($z);$k&&$k.group===$x&&($k.close(),$I.push($k))}return $I},$z._checkMask=function(){this.maskLayer.removeSelf();for(var $x=this.numChildren-1;-1<$x;$x--){var $I=this.getChildAt($x);if($I&&$I.isModal)return void this.addChildAt(this.maskLayer,$x)}},$I}(),$j=function($x){function $I(){$I.__super.call(this)}$n($I,"laya.ui.Box",$x);var $z=$I.prototype;return $s.imps($z,{"laya.ui.IBox":!0}),$a(0,$z,"dataSource",$x.prototype._$get_dataSource,function($x){for(var $I in this._dataSource=$x){var $z=this.getChildByName($I);$z?$z.dataSource=$x[$I]:this.hasOwnProperty($I)&&"function"!=typeof this[$I]&&(this[$I]=$x[$I])}}),$I}($X),$t=function($I){function $z($x,$I){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$z.__super.call(this),this._labelColors=$O.buttonLabelColors,this._stateNum=$O.buttonStateNum,void 0===$I&&($I=""),this.skin=$x,this.label=$I}$n($z,"laya.ui.Button",$I);var $x=$z.prototype;return $s.imps($x,{"laya.ui.ISelect":!0}),$x.destroy=function($x){this.clearEvent(),$f.clearCache(this,this._skin),$f.clearObject(this,this._weakKey),void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($x),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$x.clearEvent=function(){this._skin&&$l.atalsNotify&&$l.atalsNotify.off(this._skin,this,this._setBtnSource)},$x.createChildren=function(){this.graphics=this._bitmap=new $U},$x.createText=function(){this._text||(this._text=new $C,this._text.overflow=$C.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$x.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$x.onMouse=function($x){if(!1!==this.toggle||!this._selected)return"click"===$x.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$z.stateMap[$x.type]))},$x.changeClips=function(){var $x=$f.getRes(this._skin);if($x)if(this._skin&&""!=this._skin){$f.clearObject(this,this._weakKey);var $I=$x.sourceWidth,$z=$x.sourceHeight/this._stateNum;$x.$_GID||($x.$_GID=$L.getGID());var $k=$x.$_GID+"-"+this._stateNum,$l=$f.findObject($k);if($L.isOkTextureList($l)||($l=null),$l)this._weakKey=$k,$f.keepObject(this,this._weakKey),this._sources=$l;else{if(this._sources=[],1===this._stateNum)this._sources.push($x);else for(var $n=0;$n<this._stateNum;$n++){var $a=$P.createFromTexture($x,0,$z*$n,$I,$z);if($x.alphaTexture){var $$=$x.width/$x.alphaTexture.width;$a.alphaTexture=$P.createFromTexture($x.alphaTexture,0/$$,$z*$n/$$,$I/$$,$z/$$)}this._sources.push($a)}$f.saveObject($k,this._sources),this._weakKey=$k,$f.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$I,this._bitmap.height=this._height||$z,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$I)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$x.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $x=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$x]),this.label&&(this._text.color=this._labelColors[$x],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$x]))},$x._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$a(0,$x,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($x){this.createText(),this._text.strokeColor=$x}),$a(0,$x,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$a(0,$x,"skin",function(){return this._skin},function($x){if(this._skin!=$x)if(this.clearEvent(),$f.clearCache(this,this._skin),this._skin=$x,$f.keepCache(this,this._skin),$f.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $I=$l.resAtalsObj&&$l.resAtalsObj[this._skin];$I?($l.atalsNotify&&$l.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$I.sourceW),0==this.height&&(this.height=$I.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),$x._setBtnSource=function($x,$I){$x===this._skin&&$I&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},$a(0,$x,"state",function(){return this._state},function($x){this._state!=$x&&(this._state=$x,this._setStateChanged())}),$a(0,$x,"text",function(){return this.createText(),this._text}),$a(0,$x,"stateNum",function(){return this._stateNum},function($x){"string"==typeof $x&&($x=parseInt($x)),this._stateNum!=$x&&(this._stateNum=$x<1?1:3<$x?3:$x,this.callLater(this.changeClips))}),$a(0,$x,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($x){this._strokeColors=$S.fillArray($O.buttonLabelColors,$x,String),this._setStateChanged()}),$a(0,$x,"labelColors",function(){return this._labelColors.join(",")},function($x){this._labelColors=$S.fillArray($O.buttonLabelColors,$x,String),this._setStateChanged()}),$a(0,$x,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$a(0,$x,"label",function(){return this._text?this._text.text:null},function($x){(this._text||$x)&&(this.createText(),this._text.text!=$x&&($x&&!this._text.parent&&this.addChild(this._text),this._text.text=($x+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$a(0,$x,"selected",function(){return this._selected},function($x){this._selected!=$x&&(this._selected=$x,this.state=this._selected?2:0,this.event("change"))}),$a(0,$x,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($x){this.createText(),this._text.padding=$S.fillArray($O.labelPadding,$x,Number)}),$a(0,$x,"labelSize",function(){return this.createText(),this._text.fontSize},function($x){this.createText(),this._text.fontSize=$x}),$a(0,$x,"labelStroke",function(){return this.createText(),this._text.stroke},function($x){this.createText(),this._text.stroke=$x}),$a(0,$x,"labelBold",function(){return this.createText(),this._text.bold},function($x){this.createText(),this._text.bold=$x}),$a(0,$x,"labelFont",function(){return this.createText(),this._text.font},function($x){this.createText(),this._text.font=$x}),$a(0,$x,"labelAlign",function(){return this.createText(),this._text.align},function($x){this.createText(),this._text.align=$x}),$a(0,$x,"clickHandler",function(){return this._clickHandler},function($x){this._clickHandler=$x}),$a(0,$x,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($x){this._bitmap.sizeGrid=$S.fillArray($O.defaultSizeGrid,$x,Number)}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($X,this,"width",$x),this._autoSize&&(this._bitmap.width=$x,this._text&&(this._text.width=$x))}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($X,this,"height",$x),this._autoSize&&(this._bitmap.height=$x,this._text&&(this._text.height=$x))}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)||"string"==typeof $x?this.label=$x+"":$s.superSet($X,this,"dataSource",$x)}),$a(0,$x,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($x){this._bitmap._offset=$x?$S.fillArray([1,1],$x,Number):[]}),$k($z,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$z}($X),$Y=function($I){function $k($x,$I,$z){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$k.__super.call(this),void 0===$I&&($I=1),void 0===$z&&($z=1),this._clipX=$I,this._clipY=$z,this.skin=$x}$n($k,"laya.ui.Clip",$I);var $x=$k.prototype;return $x.destroy=function($x){this.clearEvent(),this.clearLoad(),$f.clearCache(this,this._skin),$f.clearObject(this,this._weakKey),void 0===$x&&($x=!0),$I.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$x.dispose=function(){this.destroy(!0),$s.loader.clearRes(this._skin)},$x.createChildren=function(){this.graphics=this._bitmap=new $U},$x._onDisplay=function($x){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$x.changeClip=function(){if(this._clipChanged=!1,this._skin){var $x=$f.getRes(this._skin);if($x)this.loadComplete(this._skin,$x);else{if($l.resAtalsObj&&$l.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$T.create(this,this.loadComplete,[this._skin]),this._progress=null,$s.loader.load(this._skin,this._complete,this._progress)}}},$x.loadComplete=function($x,$I){if($x===this._skin&&$I){$f.clearObject(this,this._weakKey);var $z=this._clipWidth||Math.ceil($I.sourceWidth/this._clipX),$k=this._clipHeight||Math.ceil($I.sourceHeight/this._clipY),$l=this._skin+$z+$k,$n=$f.findObject($l);if($L.isOkTextureList($n)||($n=null),$n)this._weakKey=$l,$f.keepObject(this,this._weakKey),this._sources=$n;else{this._sources=[];for(var $a=0;$a<this._clipY;$a++)for(var $$=0;$$<this._clipX;$$++){var $w=$P.createFromTexture($I,$z*$$,$k*$a,$z,$k);if($I.alphaTexture){var $i=$I.width/$I.alphaTexture.width;$w.alphaTexture=$P.createFromTexture($I.alphaTexture,$z*$$/$i,$k*$a/$i,$z/$i,$k/$i)}this._sources.push($w)}$f.saveObject($l,this._sources),this._weakKey=$l,$f.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$x.play=function($x,$I){void 0===$x&&($x=0),void 0===$I&&($I=-1),this._isPlaying=!0,this.index=$x,this._toIndex=$I,this._index++,$s.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$x._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$x.stop=function(){this._isPlaying=!1,$s.timer.clear(this,this._loop),this.event("complete")},$x._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$a(0,$x,"interval",function(){return this._interval},function($x){this._interval!=$x&&(this._interval=$x,this._isPlaying&&this.play())}),$x.clearEvent=function(){this._skin&&$l.atalsNotify&&$l.atalsNotify.off(this._skin,this,this._setBtnSource)},$x.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$s.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$a(0,$x,"skin",function(){return this._skin},function($x){if(this._skin!=$x)if(this.clearLoad(),this.clearEvent(),$f.clearCache(this,this._skin),this._skin=$x){$f.keepCache(this,this._skin);var $I=$f.getRes($x),$z=$l.resAtalsObj&&$l.resAtalsObj[this._skin];!$I&&$z?$l.atalsNotify&&$l.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),$x._setBtnSource=function($x,$I){$x===this._skin&&$I&&(this.loadComplete($x,$I),this.clearEvent())},$a(0,$x,"sources",function(){return this._sources},function($x){this._sources=$x,this.index=this._index,this.event("loaded")}),$a(0,$x,"clipX",function(){return this._clipX},function($x){this._clipX=$x||1,this._setClipChanged()}),$a(0,$x,"clipY",function(){return this._clipY},function($x){this._clipY=$x||1,this._setClipChanged()}),$a(0,$x,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$a(0,$x,"clipWidth",function(){return this._clipWidth},function($x){this._clipWidth=$x,this._setClipChanged()}),$a(0,$x,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($x){this._bitmap.sizeGrid=$S.fillArray($O.defaultSizeGrid,$x,Number)}),$a(0,$x,"group",function(){return this._group},function($x){$x&&this._skin&&$f.setGroup(this._skin,$x),this._group=$x}),$a(0,$x,"clipHeight",function(){return this._clipHeight},function($x){this._clipHeight=$x,this._setClipChanged()}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($X,this,"width",$x),this._bitmap.width=$x}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($X,this,"height",$x),this._bitmap.height=$x}),$a(0,$x,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$a(0,$x,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$a(0,$x,"index",function(){return this._index},function($x){this._index=$x,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$x]),this.event("change")}),$a(0,$x,"autoPlay",function(){return this._autoPlay},function($x){this._autoPlay!=$x&&((this._autoPlay=$x)?this.play():this.stop())}),$a(0,$x,"isPlaying",function(){return this._isPlaying},function($x){this._isPlaying=$x}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)&&Math.floor($x)==$x||"string"==typeof $x?this.index=parseInt($x):$s.superSet($X,this,"dataSource",$x)}),$a(0,$x,"bitmap",function(){return this._bitmap}),$k}($X),$c=function($I){function $x(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$x.__super.call(this)}$n($x,"laya.ui.ColorPicker",$I);var $z=$x.prototype;return $z.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._colorPanel&&this._colorPanel.destroy($x),this._colorButton&&this._colorButton.destroy($x),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$z.createChildren=function(){this.addChild(this._colorButton=new $t),this._colorPanel=new $j,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $y),this._colorPanel.addChild(this._colorBlock=new $y),this._colorPanel.addChild(this._colorInput=new $_)},$z.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$z.onPanelMouseDown=function($x){$x.stopPropagation()},$z.changePanel=function(){this._panelChanged=!1;var $x=this._colorPanel.graphics;$x.clear(),$x.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($x=this._colorTiles.graphics).clear();for(var $I=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$z=0;$z<12;$z++)for(var $k=0;$k<20;$k++){var $l=0;$l=0===$k?$I[$z]:1===$k?0:51*(((3*$z+$k/6)%3<<0)+3*($z/6<<0))<<16|$k%6*51<<8|($z<<0)%6*51;var $n=$S.toColor($l);this._colors.push($n);var $a=$k*this._gridSize,$$=$z*this._gridSize;$x.drawRect($a,$$,this._gridSize,this._gridSize,$n,"#000000")}},$z.onColorButtonClick=function($x){this._colorPanel.parent?this.close():this.open()},$z.open=function(){var $x=this.localToGlobal(new $R),$I=$x.x+this._colorPanel.width<=$s.stage.width?$x.x:$s.stage.width-this._colorPanel.width,$z=$x.y+this._colorButton.height;$z=$z+this._colorPanel.height<=$s.stage.height?$z:$x.y-this._colorPanel.height,this._colorPanel.pos($I,$z),this._colorPanel.zOrder=1001,$s._currentStage.addChild(this._colorPanel),$s.stage.on("mousedown",this,this.removeColorBox)},$z.close=function(){$s.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$z.removeColorBox=function($x){this.close()},$z.onColorFieldKeyDown=function($x){13==$x.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$x.stopPropagation())},$z.onColorInputChange=function($x){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$z.onColorTilesClick=function($x){this.selectedColor=this.getColorByMouse(),this.close()},$z.onColorTilesMouseMove=function($x){this._colorInput.focus=!1;var $I=this.getColorByMouse();this._colorInput.text=$I,this.drawBlock($I)},$z.getColorByMouse=function(){var $x=this._colorTiles.getMousePoint(),$I=Math.floor($x.x/this._gridSize),$z=Math.floor($x.y/this._gridSize);return this._colors[20*$z+$I]},$z.drawBlock=function($x){var $I=this._colorBlock.graphics;$I.clear();var $z=$x||"#ffffff";$I.drawRect(0,0,50,20,$z,this._borderColor),$x||$I.drawLine(0,0,50,20,"#ff0000")},$z.changeColor=function(){var $x=this.graphics;$x.clear();var $I=this._selectedColor||"#000000";$x.drawRect(0,0,this._colorButton.width,this._colorButton.height,$I)},$z._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$a(0,$z,"inputBgColor",function(){return this._inputBgColor},function($x){this._inputBgColor=$x,this._setPanelChanged()}),$a(0,$z,"selectedColor",function(){return this._selectedColor},function($x){this._selectedColor!=$x&&(this._selectedColor=this._colorInput.text=$x,this.drawBlock($x),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$i.EMPTY.setTo("change",this,this)))}),$a(0,$z,"skin",function(){return this._colorButton.skin},function($x){this._colorButton.skin=$x,this.changeColor()}),$a(0,$z,"bgColor",function(){return this._bgColor},function($x){this._bgColor=$x,this._setPanelChanged()}),$a(0,$z,"borderColor",function(){return this._borderColor},function($x){this._borderColor=$x,this._setPanelChanged()}),$a(0,$z,"inputColor",function(){return this._inputColor},function($x){this._inputColor=$x,this._setPanelChanged()}),$x}($X),$V=function($I){function $z($x,$I){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$z.__super.call(this),this._itemColors=$O.comboBoxItemColors,this.skin=$x,this.labels=$I}$n($z,"laya.ui.ComboBox",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._button&&this._button.destroy($x),this._list&&this._list.destroy($x),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$x.createChildren=function(){this.addChild(this._button=new $t),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$x._createList=function(){this._list=new $p,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$x._setListEvent=function($x){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$T.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$x.onListDown=function($x){$x.stopPropagation()},$x.onScrollBarDown=function($x){$x.stopPropagation()},$x.onButtonMouseDown=function($x){this.callLater(this.switchTo,[!this._isOpen])},$x.changeList=function(){this._listChanged=!1;var $x=this.width-2,$I=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$x,height:this._itemHeight,fontSize:this._itemSize,color:$I}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$x.onlistItemMouse=function($x,$I){var $z=$x.type;if("mouseover"===$z||"mouseout"===$z){if(this._isCustomList)return;var $k=this._list.getCell($I);if(!$k)return;var $l=$k.getChildByName("label");$l&&("mouseover"===$z?($l.bgColor=this._itemColors[0],$l.color=this._itemColors[1]):($l.bgColor=null,$l.color=this._itemColors[2]))}else"click"===$z&&(this.selectedIndex=$I,this.isOpen=!1)},$x.switchTo=function($x){this.isOpen=$x},$x.changeOpen=function(){this.isOpen=!this._isOpen},$x.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $x=this._list.graphics;$x.clear(),$x.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $I=this._list.array||[],$z=$I.length=0,$k=this._labels.length;$z<$k;$z++)$I.push({label:this._labels[$z]});this._list.height=this._listHeight,this._list.array=$I},$x.changeSelected=function(){this._button.label=this.selectedLabel},$x._onStageMouseWheel=function($x){this._list&&!this._list.contains($x.target)&&this.removeList(null)},$x.removeList=function($x){$s.stage.off("mousedown",this,this.removeList),$s.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$a(0,$x,"selectedIndex",function(){return this._selectedIndex},function($x){this._selectedIndex!=$x&&(this._selectedIndex=$x,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$i.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$a(0,$x,"measureHeight",function(){return this._button.height}),$a(0,$x,"skin",function(){return this._button.skin},function($x){this._button.skin!=$x&&(this._button.skin=$x,this._listChanged=!0)}),$a(0,$x,"measureWidth",function(){return this._button.width}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($X,this,"width",$x),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$a(0,$x,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($x){this.selectedIndex=this._labels.indexOf($x)}),$a(0,$x,"labels",function(){return this._labels.join(",")},function($x){0<this._labels.length&&(this.selectedIndex=-1),$x?this._labels=$x.split(","):this._labels.length=0,this._itemChanged=!0}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($X,this,"height",$x),this._button.height=this._height}),$a(0,$x,"selectHandler",function(){return this._selectHandler},function($x){this._selectHandler=$x}),$a(0,$x,"visibleNum",function(){return this._visibleNum},function($x){this._visibleNum=$x,this._listChanged=!0}),$a(0,$x,"labelBold",function(){return this._button.text.bold},function($x){this._button.text.bold=$x}),$a(0,$x,"itemColors",function(){return String(this._itemColors)},function($x){this._itemColors=$S.fillArray(this._itemColors,$x,String),this._listChanged=!0}),$a(0,$x,"itemSize",function(){return this._itemSize},function($x){this._itemSize=$x,this._listChanged=!0}),$a(0,$x,"scrollBar",function(){return this.list.scrollBar}),$a(0,$x,"isOpen",function(){return this._isOpen},function($x){if(this._isOpen!=$x)if(this._isOpen=$x,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $I=this.localToGlobal($R.TEMP.setTo(0,0)),$z=$I.y+this._button.height;$z=$z+this._listHeight<=$s.stage.height?$z:$I.y-this._listHeight,this._list.pos($I.x,$z),this._list.zOrder=1001,$s._currentStage.addChild(this._list),$s.stage.once("mousedown",this,this.removeList),$s.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$a(0,$x,"scrollBarSkin",function(){return this._scrollBarSkin},function($x){this._scrollBarSkin=$x}),$a(0,$x,"sizeGrid",function(){return this._button.sizeGrid},function($x){this._button.sizeGrid=$x}),$a(0,$x,"button",function(){return this._button}),$a(0,$x,"list",function(){return this._list||this._createList(),this._list},function($x){$x&&($x.removeSelf(),this._isCustomList=!0,this._list=$x,this._setListEvent($x),this._itemHeight=$x.getCell(0).height+$x.spaceY)}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)&&Math.floor($x)==$x||"string"==typeof $x?this.selectedIndex=parseInt($x):$x instanceof Array?this.labels=$x.join(","):$s.superSet($X,this,"dataSource",$x)}),$a(0,$x,"labelColors",function(){return this._button.labelColors},function($x){this._button.labelColors!=$x&&(this._button.labelColors=$x)}),$a(0,$x,"labelPadding",function(){return this._button.text.padding.join(",")},function($x){this._button.text.padding=$S.fillArray($O.labelPadding,$x,Number)}),$a(0,$x,"labelSize",function(){return this._button.text.fontSize},function($x){this._button.text.fontSize=$x}),$a(0,$x,"labelFont",function(){return this._button.text.font},function($x){this._button.text.font=$x}),$a(0,$x,"stateNum",function(){return this._button.stateNum},function($x){this._button.stateNum=$x}),$z}($X),$W=function($I){function $z($x){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$z.__super.call(this),this._showButtons=$Z.showButtons,this._touchScrollEnable=$Z.touchScrollEnable,this._mouseWheelEnable=$Z.mouseWheelEnable,this.skin=$x,this.max=1}$n($z,"laya.ui.ScrollBar",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),this.stopScroll(),this.target=null,$I.prototype.destroy.call(this,$x),this.upButton&&this.upButton.destroy($x),this.downButton&&this.downButton.destroy($x),this.slider&&this.slider.destroy($x),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$x.createChildren=function(){this.addChild(this.slider=new $q),this.addChild(this.upButton=new $t),this.addChild(this.downButton=new $t)},$x.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$x.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$x.onButtonMouseDown=function($x){var $I=$x.currentTarget===this.upButton;this.slide($I),$s.timer.once($O.scrollBarDelayTime,this,this.startLoop,[$I]),$s.stage.once("mouseup",this,this.onStageMouseUp)},$x.startLoop=function($x){$s.timer.frameLoop(1,this,this.slide,[$x])},$x.slide=function($x){$x?this.value-=this._scrollSize:this.value+=this._scrollSize},$x.onStageMouseUp=function($x){$s.timer.clear(this,this.startLoop),$s.timer.clear(this,this.slide)},$x.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$x.changeSize=function(){$I.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$x.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$x.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$x.setScroll=function($x,$I,$z){this.runCallLater(this.changeSize),this.slider.setSlider($x,$I,$z),this.slider.bar.visible=0<$I,!this._hide&&this.autoHide&&(this.visible=!1)},$x.onTargetMouseWheel=function($x){this.value-=$x.delta*this._scrollSize,this.target=this._target},$x.onTargetMouseDown=function($x){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $R),this._lastPoint.setTo($s.stage.mouseX,$s.stage.mouseY),$s.timer.clear(this,this.tweenMove),$v.clearTween(this),$s.stage.once("mouseup",this,this.onStageMouseUp2),$s.stage.once("mouseout",this,this.onStageMouseUp2),$s.timer.frameLoop(1,this,this.loop)},$x.loop=function(){var $x=$s.stage.mouseY,$I=$s.stage.mouseX;if(this._lastOffset=this.isVertical?$x-this._lastPoint.y:$I-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$s.stage._canvasTransform.getScaleY():$s.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$I,this._lastPoint.y=$x,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$x.onStageMouseUp2=function($x){if($s.stage.off("mouseup",this,this.onStageMouseUp2),$s.stage.off("mouseout",this,this.onStageMouseUp2),$s.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$v.to(this,{value:this.min},this.elasticBackTime,$w.sineOut,$T.create(this,this.elasticOver)):this._value>this.max&&$v.to(this,{value:this.max},this.elasticBackTime,$w.sineOut,$T.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$s.stage.mouseY-this._lastPoint.y:$s.stage.mouseX-this._lastPoint.x);for(var $I=0,$z=Math.min(this._offsets.length,3),$k=0;$k<$z;$k++)$I+=this._offsets[this._offsets.length-1-$k];if(this._lastOffset=$I/$z,($I=Math.abs(this._lastOffset))<2)return void this.event("end");60<$I&&(this._lastOffset=0<this._lastOffset?60:-60);var $l=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$s.timer.frameLoop(1,this,this.tweenMove,[$l])}},$x.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$v.to(this,{alpha:0},500),this.event("end")},$x.tweenMove=function($x){this._lastOffset*=this.rollRatio;var $I=NaN;if(0<$x&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$I=.5*-(this.min-$x-this.value),this._lastOffset>$I&&(this._lastOffset=$I)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$I=.5*-(this.max+$x-this.value),this._lastOffset<$I&&(this._lastOffset=$I))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($s.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$v.to(this,{value:this.min},this.elasticBackTime,$w.sineOut,$T.create(this,this.elasticOver)):this._value>this.max?$v.to(this,{value:this.max},this.elasticBackTime,$w.sineOut,$T.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$v.to(this,{alpha:0},500)}},$x.stopScroll=function(){this.onStageMouseUp2(null),$s.timer.clear(this,this.tweenMove),$v.clearTween(this)},$a(0,$x,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$a(0,$x,"skin",function(){return this._skin},function($x){this._skin!=$x&&(this._skin=$x,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$a(0,$x,"max",function(){return this.slider.max},function($x){this.slider.max=$x}),$a(0,$x,"showButtons",function(){return this._showButtons},function($x){this._showButtons=$x,this.callLater(this.changeScrollBar)}),$a(0,$x,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$a(0,$x,"min",function(){return this.slider.min},function($x){this.slider.min=$x}),$a(0,$x,"value",function(){return this._value},function($x){$x!==this._value&&(this._value=$x,this._isElastic||(this.slider._value!=$x&&(this.slider._value=$x,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$a(0,$x,"isVertical",function(){return this.slider.isVertical},function($x){this.slider.isVertical=$x}),$a(0,$x,"sizeGrid",function(){return this.slider.sizeGrid},function($x){this.slider.sizeGrid=$x}),$a(0,$x,"scrollSize",function(){return this._scrollSize},function($x){this._scrollSize=$x}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)||"string"==typeof $x?this.value=Number($x):$s.superSet($X,this,"dataSource",$x)}),$a(0,$x,"thumbPercent",function(){return this._thumbPercent},function($x){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$x=1<=$x?.99:$x,this._thumbPercent=$x,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$x,$O.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$x,$O.scrollBarMinNum))}),$a(0,$x,"target",function(){return this._target},function($x){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$x)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$a(0,$x,"hide",function(){return this._hide},function($x){this._hide=$x,this.visible=!$x}),$a(0,$x,"touchScrollEnable",function(){return this._touchScrollEnable},function($x){this._touchScrollEnable=$x,this.target=this._target}),$a(0,$x,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($x){this._mouseWheelEnable=$x,this.target=this._target}),$a(0,$x,"tick",function(){return this.slider.tick},function($x){this.slider.tick=$x}),$z}($X),$q=function($I){function $z($x){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$z.__super.call(this),this.skin=$x}$n($z,"laya.ui.Slider",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._bg&&this._bg.destroy($x),this._bar&&this._bar.destroy($x),this._progress&&this._progress.destroy($x),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$x.createChildren=function(){this.addChild(this._bg=new $o),this.addChild(this._bar=new $t)},$x.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$x.onBarMouseDown=function($x){this._globalSacle||(this._globalSacle=new $R),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$s.stage.mouseX,this._ty=$s.stage.mouseY,$s.stage.on("mousemove",this,this.mouseMove),$s.stage.once("mouseup",this,this.mouseUp),$s.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$x.showValueText=function(){if(this.showLabel){var $x=laya.ui.Slider.label;this.addChild($x),$x.textField.changeText(this._value+""),this.isVertical?($x.x=this._bar.x+20,$x.y=.5*(this._bar.height-$x.height)+this._bar.y):($x.y=this._bar.y-20,$x.x=.5*(this._bar.width-$x.width)+this._bar.x)}},$x.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$x.mouseUp=function($x){$s.stage.off("mousemove",this,this.mouseMove),$s.stage.off("mouseup",this,this.mouseUp),$s.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$x.mouseMove=function($x){var $I=this._value;this.isVertical?(this._bar.y+=($s.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($s.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$s.stage.mouseX,this._ty=$s.stage.mouseY;var $z=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$z)/$z,this._value!=$I&&this.sendChangeEvent(),this.showValueText()},$x.sendChangeEvent=function($x){void 0===$x&&($x="change"),this.event($x),this.changeHandler&&this.changeHandler.runWith(this._value)},$x.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$x.changeSize=function(){$I.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$x.setSlider=function($x,$I,$z){this._value=-1,this._min=$x,this._max=$x<$I?$I:$x,this.value=$z<$x?$x:$I<$z?$I:$z},$x.changeValue=function(){var $x=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$x)/$x,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $I=this._max-this._min;0===$I&&($I=1),this.isVertical?(this._bar.y=(this._value-this._min)/$I*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$I*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$x.onBgMouseDown=function($x){var $I=this._bg.getMousePoint();this.isVertical?this.value=$I.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$I.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$a(0,$x,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$a(0,$x,"skin",function(){return this._skin},function($x){if(this._skin!=$x){this._skin=$x,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $I=this._skin.replace(".png","$progress.png");$f.getRes($I)&&(this._progress||(this.addChild(this._progress=new $o),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$I),this.setBarPoint(),this.callLater(this.changeValue)}}),$a(0,$x,"allowClickBack",function(){return this._allowClickBack},function($x){this._allowClickBack!=$x&&((this._allowClickBack=$x)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$a(0,$x,"max",function(){return this._max},function($x){this._max!=$x&&(this._max=$x,this.callLater(this.changeValue))}),$a(0,$x,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$a(0,$x,"tick",function(){return this._tick},function($x){this._tick!=$x&&(this._tick=$x,this.callLater(this.changeValue))}),$a(0,$x,"sizeGrid",function(){return this._bg.sizeGrid},function($x){this._bg.sizeGrid=$x,this._bar.sizeGrid=$x,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$a(0,$x,"min",function(){return this._min},function($x){this._min!=$x&&(this._min=$x,this.callLater(this.changeValue))}),$a(0,$x,"value",function(){return this._value},function($x){if(this._value!=$x){var $I=this._value;this._value=$x,this.changeValue(),this._value!=$I&&this.sendChangeEvent()}}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)||"string"==typeof $x?this.value=Number($x):$s.superSet($X,this,"dataSource",$x)}),$a(0,$x,"bar",function(){return this._bar}),$k($z,["label",function(){return this.label=new $J}]),$z}($X),$o=function($I){function $z($x){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$z.__super.call(this),this.skin=$x}$n($z,"laya.ui.Image",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$f.clearCache(this,this._skin)},$x.dispose=function(){this.destroy(!0),$f.clearCache(this,this._skin),this.clearEvent()},$x.createChildren=function(){this.graphics=this._bitmap=new $U},$x.setSource=function($x,$I){this.destroyed||$x===this._skin&&$I&&(this.source=$I,this.onCompResize(),this.clearEvent())},$x.clearEvent=function(){this._skin&&$l.atalsNotify&&$l.atalsNotify.off(this._skin,this,this.setSource)},$x.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$s.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$a(0,$x,"source",function(){return this._bitmap.source},function($x){this._bitmap&&(this._bitmap.source=$x,this.event("loaded"),this.repaint())}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"string"==typeof(this._dataSource=$x)?this.skin=$x:$s.superSet($X,this,"dataSource",$x)}),$a(0,$x,"measureHeight",function(){return this._bitmap.height}),$a(0,$x,"skin",function(){return this._skin},function($x){if(this._skin!=$x)if($f.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$x){$f.keepCache(this,this._skin);var $I=$f.getRes($x),$z=$l.resAtalsObj&&$l.resAtalsObj[this._skin];$I?(this.source=$I,this.onCompResize()):$z?($l.atalsNotify&&$l.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$z.sourceW),0==this.height&&(this.height=$z.sourceH)):(this._complete=$T.create(this,this.setSource,[this._skin]),this._progress=null,$s.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),$a(0,$x,"group",function(){return this._group},function($x){$x&&this._skin&&$f.setGroup(this._skin,$x),this._group=$x}),$a(0,$x,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($x){this._bitmap.sizeGrid=$S.fillArray($O.defaultSizeGrid,$x,Number)}),$a(0,$x,"measureWidth",function(){return this._bitmap.width}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($X,this,"width",$x),this._bitmap.width=0==$x?1e-7:$x}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($X,this,"height",$x),this._bitmap.height=0==$x?1e-7:$x}),$z}($X),$J=function($I){function $z($x){this._tf=null,$z.__super.call(this),void 0===$x&&($x=""),$F.defaultColor=$O.labelColor,this.text=$x}$n($z,"laya.ui.Label",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._tf=null},$x.createChildren=function(){this.addChild(this._tf=new $C)},$x.changeText=function($x){this._tf.changeText($x)},$a(0,$x,"padding",function(){return this._tf.padding.join(",")},function($x){this._tf.padding=$S.fillArray($O.labelPadding,$x,Number)}),$a(0,$x,"bold",function(){return this._tf.bold},function($x){this._tf.bold=$x}),$a(0,$x,"align",function(){return this._tf.align},function($x){this._tf.align=$x}),$a(0,$x,"text",function(){return this._tf.text},function($x){this._tf.text!=$x&&($x&&($x=$S.adptString($x+"")),this._tf.text=$x,this.event("change"),this._width&&this._height||this.onCompResize())}),$a(0,$x,"italic",function(){return this._tf.italic},function($x){this._tf.italic=$x}),$a(0,$x,"wordWrap",function(){return this._tf.wordWrap},function($x){this._tf.wordWrap=$x}),$a(0,$x,"font",function(){return this._tf.font},function($x){this._tf.font=$x}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)||"string"==typeof $x?this.text=$x+"":$s.superSet($X,this,"dataSource",$x)}),$a(0,$x,"color",function(){return this._tf.color},function($x){this._tf.color=$x}),$a(0,$x,"valign",function(){return this._tf.valign},function($x){this._tf.valign=$x}),$a(0,$x,"leading",function(){return this._tf.leading},function($x){this._tf.leading=$x}),$a(0,$x,"fontSize",function(){return this._tf.fontSize},function($x){this._tf.fontSize=$x}),$a(0,$x,"bgColor",function(){return this._tf.bgColor},function($x){this._tf.bgColor=$x}),$a(0,$x,"borderColor",function(){return this._tf.borderColor},function($x){this._tf.borderColor=$x}),$a(0,$x,"stroke",function(){return this._tf.stroke},function($x){this._tf.stroke=$x}),$a(0,$x,"strokeColor",function(){return this._tf.strokeColor},function($x){this._tf.strokeColor=$x}),$a(0,$x,"textField",function(){return this._tf}),$a(0,$x,"measureWidth",function(){return this._tf.width}),$a(0,$x,"measureHeight",function(){return this._tf.height}),$a(0,$x,"width",function(){return this._width||this._tf.text?$s.superGet($X,this,"width"):0},function($x){$s.superSet($X,this,"width",$x),this._tf.width=$x}),$a(0,$x,"height",function(){return this._height||this._tf.text?$s.superGet($X,this,"height"):0},function($x){$s.superSet($X,this,"height",$x),this._tf.height=$x}),$a(0,$x,"overflow",function(){return this._tf.overflow},function($x){this._tf.overflow=$x}),$a(0,$x,"underline",function(){return this._tf.underline},function($x){this._tf.underline=$x}),$a(0,$x,"underlineColor",function(){return this._tf.underlineColor},function($x){this._tf.underlineColor=$x}),$z}($X),$h=function($I){function $z($x){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$z.__super.call(this),this.skin=$x}$n($z,"laya.ui.ProgressBar",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._bg&&this._bg.destroy($x),this._bar&&this._bar.destroy($x),this._bg=this._bar=null,this.changeHandler=null},$x.createChildren=function(){this.addChild(this._bg=new $o),this.addChild(this._bar=new $o)},$x.changeValue=function(){if(this.sizeGrid){var $x=this.sizeGrid.split(","),$I=Number($x[3]),$z=Number($x[1]),$k=(this.width-$I-$z)*this._value;this._bar.width=$I+$z+$k,this._bar.visible=this._bar.width>$I+$z}else this._bar.width=this.width*this._value},$a(0,$x,"measureHeight",function(){return this._bg.height}),$a(0,$x,"skin",function(){return this._skin},function($x){this._skin!=$x&&(this._skin=$x,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$a(0,$x,"measureWidth",function(){return this._bg.width}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($X,this,"height",$x),this._bg.height=this._height,this._bar.height=this._height}),$a(0,$x,"bar",function(){return this._bar}),$a(0,$x,"value",function(){return this._value},function($x){this._value!=$x&&($x=1<$x?1:$x<0?0:$x,this._value=$x,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($x))}),$a(0,$x,"bg",function(){return this._bg}),$a(0,$x,"sizeGrid",function(){return this._bg.sizeGrid},function($x){this._bg.sizeGrid=this._bar.sizeGrid=$x}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($X,this,"width",$x),this._bg.width=this._width,this.callLater(this.changeValue)}),$a(0,$x,"dataSource",$I.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)||"string"==typeof $x?this.value=Number($x):$s.superSet($X,this,"dataSource",$x)}),$z}($X),$B=(function($x){function $z(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$z.__super.call(this),this._tipBox=new $X,this._tipBox.addChild(this._tipText=new $C),this._tipText.x=this._tipText.y=5,this._tipText.color=$z.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$s.stage.on("showtip",this,this._onStageShowTip),$s.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$n($z,"laya.ui.TipManager",$X);var $I=$z.prototype;$I._onStageHideTip=function($x){$s.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$I._onStageShowTip=function($x){$s.timer.once($z.tipDelay,this,this._showTip,[$x],!0)},$I._showTip=function($x){if("string"==typeof $x){var $I=String($x);Boolean($I)&&this._defaultTipHandler($I)}else $x instanceof laya.utils.Handler?$x.run():"function"==typeof $x&&$x.apply();$s.stage.on("mousemove",this,this._onStageMouseMove),$s.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$I._onStageMouseDown=function($x){this.closeAll()},$I._onStageMouseMove=function($x){this._showToStage(this,$z.offsetX,$z.offsetY)},$I._showToStage=function($x,$I,$z){void 0===$I&&($I=0),void 0===$z&&($z=0);var $k=$x.getBounds();$x.x=$s.stage.mouseX+$I,$x.y=$s.stage.mouseY+$z,$x.x+$k.width>$s.stage.width&&($x.x-=$k.width+$I),$x.y+$k.height>$s.stage.height&&($x.y-=$k.height+$z)},$I.closeAll=function(){$s.timer.clear(this,this._showTip),$s.stage.off("mousemove",this,this._onStageMouseMove),$s.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$I.showDislayTip=function($x){this.addChild($x),this._showToStage(this),$s._currentStage.addChild(this)},$I._showDefaultTip=function($x){this._tipText.text=$x;var $I=this._tipBox.graphics;$I.clear(),$I.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$z.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$s._currentStage.addChild(this)},$a(0,$I,"defaultTipHandler",function(){return this._defaultTipHandler},function($x){this._defaultTipHandler=$x}),$z.offsetX=10,$z.offsetY=15,$z.tipTextColor="#ffffff",$z.tipBackColor="#111111",$z.tipDelay=200}(),function($x){var $_;function $R(){this._idMap=null,this._aniList=null,this._watchMap={},$R.__super.call(this)}$n($R,"laya.ui.View",$j);var $I=$R.prototype;return $I.createView=function($x){if($x.animations&&!this._idMap&&(this._idMap={}),$R.createComp($x,this,this),$x.animations){var $I,$z,$k=[],$l=$x.animations,$n=0,$a=$l.length;for($n=0;$n<$a;$n++){switch($I=new $b,$z=$l[$n],$I._setUp(this._idMap,$z),(this[$z.name]=$I)._setControlNode(this),$z.action){case 1:$I.play(0,!1);break;case 2:$I.play(0,!0)}$k.push($I)}this._aniList=$k}0<this._width&&null==$x.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$I.onEvent=function($x,$I){},$I.loadUI=function($x){var $I=$R.uiMap[$x];$I&&this.createView($I)},$I.destroy=function($x){void 0===$x&&($x=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$x)},$I.changeData=function($x){var $I=this._watchMap[$x];if($I){console.log("change",$x);for(var $z=0,$k=$I.length;$z<$k;$z++){$I[$z].exe(this)}}},$R._regs=function(){for(var $x in $R.uiClassMap)$N.regClass($x,$R.uiClassMap[$x])},$R.createComp=function($x,$I,$z,$k){if(!($I=$I||$R.getCompInstance($x)))return console.warn("can not create:"+$x.type),null;var $l=$x.child;if($l)for(var $n=$I instanceof laya.ui.List,$a=0,$$=$l.length;$a<$$;$a++){var $w=$l[$a];if(!$I.hasOwnProperty("itemRender")||"render"!=$w.props.name&&"render"!==$w.props.renderType)if("Graphic"==$w.type)$N.addGraphicsToSprite($w,$I);else if($N.isDrawType($w.type))$N.addGraphicToSprite($w,$I,!0);else{if($n){var $i=[],$F=$R.createComp($w,null,$z,$i);$i.length&&($F._$bindData=$i)}else $F=$R.createComp($w,null,$z,$k);"Script"==$w.type?"owner"in $F?$F.owner=$I:"target"in $F&&($F.target=$I):"mask"==$w.props.renderType||"mask"==$w.props.name?$I.mask=$F:$F instanceof laya.display.Sprite&&$I.addChild($F)}else $I.itemRender=$w}var $b=$x.props;for(var $T in $b){var $_=$b[$T];$R.eventDic[$T]?$_&&$z&&$I.on($T,$z,$z.onEvent,[$_]):$R.setCompValue($I,$T,$_,$z,$k)}return $s.__typeof($I,"laya.ui.IItem")&&$I.initItems(),$x.compId&&$z&&$z._idMap&&($z._idMap[$x.compId]=$I),$I},$R.setCompValue=function($x,$I,$z,$k,$l){if("string"==typeof $z&&-1<$z.indexOf("${")){if($R._sheet||($R._sheet=$N.getClass("laya.data.Table")),!$R._sheet)return void console.warn("Can not find class Sheet");if($l)$l.push($x,$I,$z);else if($k){-1==$z.indexOf("].")&&($z=$z.replace(".","[0]."));var $n,$a,$$=new $_($x,$I,$z);$$.exe($k);for(var $w=$z.replace(/\[.*?\]\./g,".");null!=($n=$R._parseWatchData.exec($w));){for(var $i=$n[1];null!=($a=$R._parseKeyWord.exec($i));){var $F=$a[0],$b=$k._watchMap[$F]||($k._watchMap[$F]=[]);$b.push($$),$R._sheet.I.notifer.on($F,$k,$k.changeData,[$F])}($b=$k._watchMap[$i]||($k._watchMap[$i]=[])).push($$),$R._sheet.I.notifer.on($i,$k,$k.changeData,[$i])}}}else if("var"===$I&&$k)$k[$z]=$x;else if("onClick"==$I){var $T=$s._runScript("(function(){"+$z+"})");$x.on("click",$k,$T)}else $x[$I]="true"===$z||"false"!==$z&&$z},$R.getCompInstance=function($x){var $I,$z=$x.props?$x.props.runtime:null;return $I=$z?$R.viewClassMap[$z]||$R.uiClassMap[$z]||$s.__classmap[$z]:$R.uiClassMap[$x.type],$x.props&&$x.props.hasOwnProperty("renderType")&&"instance"==$x.props.renderType?$I.instance:$I?new $I:null},$R.regComponent=function($x,$I){$R.uiClassMap[$x]=$I,$N.regClass($x,$I)},$R.regViewRuntime=function($x,$I){$R.viewClassMap[$x]=$I},$R.uiMap={},$R.viewClassMap={},$R._sheet=null,$k($R,["uiClassMap",function(){return this.uiClassMap={ViewStack:$xx,LinkButton:$t,TextArea:$ix,ColorPicker:$c,Box:$j,Button:$t,CheckBox:$e,Clip:$Y,ComboBox:$V,Component:$X,HScrollBar:$u,HSlider:$g,Image:$o,Label:$J,List:$p,Panel:$r,ProgressBar:$h,Radio:$Q,RadioGroup:$$x,ScrollBar:$W,Slider:$q,Tab:$wx,TextInput:$zx,View:$R,VScrollBar:$Ix,VSlider:$kx,Tree:$G,HBox:$nx,VBox:$ax,Sprite:$y,Animation:$z,Text:$C,FontClip:$H}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$R.__init$=function(){$R._regs(),$_=function(){function $x($x,$I,$z){this.comp=null,this.prop=null,this.value=null,this.comp=$x,this.prop=$I,this.value=$z}return $n($x,""),$x.prototype.exe=function($x){var $I=$S.getBindFun(this.value);this.comp[this.prop]=$I.call(this,$x)},$x}()},$R}()),$e=function($x){function $z($x,$I){void 0===$I&&($I=""),$z.__super.call(this,$x,$I)}$n($z,"laya.ui.CheckBox",$x);var $I=$z.prototype;return $I.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$I.initialize=function(){$x.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$a(0,$I,"dataSource",$x.prototype._$get_dataSource,function($x){"boolean"==typeof(this._dataSource=$x)?this.selected=$x:"string"==typeof $x?this.selected="true"===$x:$s.superSet($t,this,"dataSource",$x)}),$z}($t),$A=function($x){function $I(){this._space=0,this._align="none",this._itemChanged=!1,$I.__super.call(this)}$n($I,"laya.ui.LayoutBox",$j);var $z=$I.prototype;return $z.addChild=function($x){return $x.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$x)},$z.onResize=function($x){this._setItemChanged()},$z.addChildAt=function($x,$I){return $x.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$x,$I)},$z.removeChild=function($x){return $x.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$x)},$z.removeChildAt=function($x){return this.getChildAt($x).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$x)},$z.refresh=function(){this._setItemChanged()},$z.changeItems=function(){this._itemChanged=!1},$z.sortItem=function($x){$x&&$x.sort(function($x,$I){return $x.y-$I.y})},$z._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$a(0,$z,"space",function(){return this._space},function($x){this._space=$x,this._setItemChanged()}),$a(0,$z,"align",function(){return this._align},function($x){this._align=$x,this._setItemChanged()}),$I}(),$H=function($I){function $z($x,$I){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$z.__super.call(this),$x&&(this.skin=$x),$I&&(this.sheet=$I)}$n($z,"laya.ui.FontClip",$I);var $x=$z.prototype;return $x.createChildren=function(){this._bitmap=new $U,this.on("loaded",this,this._onClipLoaded)},$x._onClipLoaded=function(){this.callLater(this.changeValue)},$x.changeValue=function(){var $x;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$x=this._sources[0]))){var $I="horizontal"===this._direction;$I?(this._wordsW=this._valueArr.length*($x.sourceWidth+this.spaceX),this._wordsH=$x.sourceHeight):(this._wordsW=$x.sourceWidth,this._wordsH=($x.sourceHeight+this.spaceY)*this._valueArr.length);var $z=0;if(this._width)switch(this._align){case"center":$z=.5*(this._width-this._wordsW);break;case"right":$z=this._width-this._wordsW;break;default:$z=0}for(var $k=0,$l=this._valueArr.length;$k<$l;$k++){var $n=this._indexMap[this._valueArr.charAt($k)];this.sources[$n]&&($x=this.sources[$n],$I?this.graphics.drawTexture($x,$z+$k*($x.sourceWidth+this.spaceX),0,$x.sourceWidth,$x.sourceHeight):this.graphics.drawTexture($x,0+$z,$k*($x.sourceHeight+this.spaceY),$x.sourceWidth,$x.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$x.destroy=function($x){void 0===$x&&($x=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$I.prototype.destroy.call(this,$x)},$a(0,$x,"sheet",function(){return this._sheet},function($x){$x+="";var $I=(this._sheet=$x).split(" ");this._clipX=String($I[0]).length,this.clipY=$I.length,this._indexMap={};for(var $z=0;$z<this._clipY;$z++)for(var $k=$I[$z].split(""),$l=0,$n=$k.length;$l<$n;$l++)this._indexMap[$k[$l]]=$z*this._clipX+$l}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($Y,this,"height",$x),this.callLater(this.changeValue)}),$a(0,$x,"direction",function(){return this._direction},function($x){this._direction=$x,this.callLater(this.changeValue)}),$a(0,$x,"value",function(){return this._valueArr?this._valueArr:""},function($x){$x+="",this._valueArr=$x,this.callLater(this.changeValue)}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($Y,this,"width",$x),this.callLater(this.changeValue)}),$a(0,$x,"spaceX",function(){return this._spaceX},function($x){this._spaceX=$x,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$a(0,$x,"spaceY",function(){return this._spaceY},function($x){this._spaceY=$x,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$a(0,$x,"align",function(){return this._align},function($x){this._align=$x,this.callLater(this.changeValue)}),$a(0,$x,"measureWidth",function(){return this._wordsW}),$a(0,$x,"measureHeight",function(){return this._wordsH}),$z}($Y),$p=function($x){function $I(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $R,$I.__super.call(this)}$n($I,"laya.ui.List",$x);var $z=$I.prototype;return $s.imps($z,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$z.destroy=function($x){void 0===$x&&($x=!0),this._content&&this._content.destroy($x),this._scrollBar&&this._scrollBar.destroy($x),laya.ui.Component.prototype.destroy.call(this,$x),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},$z.createChildren=function(){this.addChild(this._content=new $j)},$z.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$s.superGet($j,this,"cacheAs")),$s.superSet($j,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$z.onScrollEnd=function(){$s.superSet($j,this,"cacheAs",this._$P.cacheAs)},$z._removePreScrollBar=function(){var $x=this.removeChildByName("scrollBar");$x&&$x.destroy(!0)},$z.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $x=this._getOneCell(),$I=$x.width+this._spaceX||1,$z=$x.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$I):Math.ceil(this._width/$I)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$z):Math.round(this._height/$z));var $k=this._width?this._width:$I*this.repeatX-this._spaceX,$l=this._height?this._height:$z*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$z:$I,this._cellOffset=this._isVertical?$z*Math.max(this._repeatY2,this._repeatY)-$l-this._spaceY:$I*Math.max(this._repeatX2,this._repeatX)-$k-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$l:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$k),this.setContentSize($k,$l);var $n=this._isVertical?this.repeatX:this.repeatY,$a=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$n,$a),this._createdLine=$a,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$z._getOneCell=function(){if(0===this._cells.length){var $x=this.createItem();if(this._offset.setTo($x.x,$x.y),this.cacheContent)return $x;this._cells.push($x)}return this._cells[0]},$z._createItems=function($x,$I,$z){var $k=this._content,$l=this._getOneCell(),$n=$l.width+this._spaceX,$a=$l.height+this._spaceY;if(this.cacheContent){var $$=new $j;$$.cacheAsBitmap=!0,$$.pos((this._isVertical?0:$x)*$n,(this._isVertical?$x:0)*$a),this._content.addChild($$),this._content.optimizeScrollRect=!0,$k=$$}else{for(var $w=[],$i=this._cells.length-1;-1<$i;$i--){var $F=this._cells[$i];$F.removeSelf(),$w.push($F)}this._cells.length=0}for(var $b=$x;$b<$z;$b++)for(var $T=0;$T<$I;$T++)($l=$w&&$w.length?$w.pop():this.createItem()).x=(this._isVertical?$T:$b)*$n-$k.x,$l.y=(this._isVertical?$b:$T)*$a-$k.y,$l.name="item"+($b*$I+$T),$k.addChild($l),this.addCell($l)},$z.createItem=function(){var $x=[];if("function"==typeof this._itemRender)var $I=new this._itemRender;else $I=$B.createComp(this._itemRender,null,null,$x);if(0==$x.length&&$I._watchMap){var $z=$I._watchMap;for(var $k in $z)for(var $l=$z[$k],$n=0;$n<$l.length;$n++){var $a=$l[$n];$x.push($a.comp,$a.prop,$a.value)}}return $x.length&&($I._$bindData=$x),$I},$z.addCell=function($x){$x.on("click",this,this.onCellMouse),$x.on("rightclick",this,this.onCellMouse),$x.on("mouseover",this,this.onCellMouse),$x.on("mouseout",this,this.onCellMouse),$x.on("mousedown",this,this.onCellMouse),$x.on("mouseup",this,this.onCellMouse),this._cells.push($x)},$z.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $x=0,$I=$x=0;$I<1e4;$I++){var $z=this.getChildByName("item"+$I);if(!$z)break;this.addCell($z),$x++}this.repeatY=$x}},$z.setContentSize=function($x,$I){this._content.width=$x,this._content.height=$I,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $D),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$x,$I),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$z.onCellMouse=function($x){"mousedown"===$x.type&&(this._isMoved=!1);var $I=$x.currentTarget,$z=this._startIndex+this._cells.indexOf($I);$z<0||("click"===$x.type||"rightclick"===$x.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$z:this.changeCellState($I,!0,0):"mouseover"!==$x.type&&"mouseout"!==$x.type||this._selectedIndex===$z||this.changeCellState($I,"mouseover"===$x.type,0),this.mouseHandler&&this.mouseHandler.runWith([$x,$z]))},$z.changeCellState=function($x,$I,$z){var $k=$x.getChildByName("selectBox");$k&&(this.selectEnable=!0,$k.visible=$I,$k.index=$z)},$z.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$z.onScrollBarChange=function($x){this.runCallLater(this.changeCells);var $I=this._scrollBar.value,$z=this._isVertical?this.repeatX:this.repeatY,$k=this._isVertical?this.repeatY:this.repeatX,$l=Math.floor($I/this._cellSize);if(this.cacheContent)$a=$k+1,this._createdLine-$l<$a&&(this._createItems(this._createdLine,$z,this._createdLine+$a),this.renderItems(this._createdLine*$z,0),this._createdLine+=$a);else{var $n=$l*$z,$a=0;if($n>this._startIndex){$a=$n-this._startIndex;var $$=!0,$w=this._startIndex+$z*($k+1);this._isMoved=!0}else $n<this._startIndex&&($a=this._startIndex-$n,$$=!1,$w=this._startIndex-1,this._isMoved=!0);for(var $i=0;$i<$a;$i++){if($$){var $F=this._cells.shift();this._cells[this._cells.length]=$F;var $b=$w+$i}else $F=this._cells.pop(),this._cells.unshift($F),$b=$w-$i;var $T=Math.floor($b/$z)*this._cellSize;this._isVertical?$F.y=$T:$F.x=$T,this.renderItem($F,$b)}this._startIndex=$n,this.changeSelectStatus()}var $_=this._content.scrollRect;this._isVertical?($_.y=$I-this._offset.y,$_.x=-this._offset.x):($_.y=-this._offset.y,$_.x=$I-this._offset.x),this._content.scrollRect=$_},$z.posCell=function($x,$I){if(this._scrollBar){var $z=this._isVertical?this.repeatX:this.repeatY,$k=(this._isVertical?this.repeatY:this.repeatX,Math.floor($I/$z)*this._cellSize);this._isVertical?$x.y=$k:$x.x=$k}},$z.changeSelectStatus=function(){for(var $x=0,$I=this._cells.length;$x<$I;$x++)this.changeCellState(this._cells[$x],this._selectedIndex===this._startIndex+$x,1)},$z.renderItems=function($x,$I){void 0===$x&&($x=0),void 0===$I&&($I=0);for(var $z=$x,$k=$I||this._cells.length;$z<$k;$z++)this.renderItem(this._cells[$z],this._startIndex+$z);this.changeSelectStatus(),this._twDone=!0},$z.renderItem=function($x,$I){if(this._array&&0<=$I&&$I<this._array.length)$x.visible=!0,$x._$bindData?($x._dataSource=this._array[$I],this._bindData($x,this._array[$I])):$x.dataSource=this._array[$I],this.cacheContent||this.posCell($x,$I),this.hasListener("render")&&this.event("render",[$x,$I]),this.renderHandler&&this.renderHandler.runWith([$x,$I]),this.renderTwHandler&&this.renderTwHandler.runWith([$x,$I]);else if($x)$x.visible=!1,$x.dataSource=null;else{var $z=$l.GlobalData;$z&&$z.throwError&&$z.throwError("找不到cell","_itemRender为:"+this._itemRender)}},$z._bindData=function($x,$I){for(var $z=$x._$bindData,$k=0,$l=$z.length;$k<$l;$k++){var $n=$z[$k++],$a=$z[$k++],$$=$z[$k],$w=$S.getBindFun($$);$n[$a]=$w.call(this,$I)}},$z.refresh=function(){this.array=this._array},$z.getItem=function($x){return-1<$x&&$x<this._array.length?this._array[$x]:null},$z.changeItem=function($x,$I){-1<$x&&$x<this._array.length&&(this._array[$x]=$I,$x>=this._startIndex&&$x<this._startIndex+this._cells.length&&this.renderItem(this.getCell($x),$x))},$z.setItem=function($x,$I){this.changeItem($x,$I)},$z.addItem=function($x){this._array.push($x),this.array=this._array},$z.addItemAt=function($x,$I){this._array.splice($I,0,$x),this.array=this._array},$z.deleteItem=function($x){this._array.splice($x,1),this.array=this._array},$z.getCell=function($x){return this.runCallLater(this.changeCells),-1<$x&&this._cells?this._cells[($x-this._startIndex)%this._cells.length]:null},$z.scrollTo=function($x){if(this._scrollBar){var $I=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($x/$I)*this._cellSize}else this.startIndex=$x},$z.tweenTo=function($x,$I,$z){if(void 0===$I&&($I=200),this._scrollBar){var $k=this._isVertical?this.repeatX:this.repeatY;$v.to(this._scrollBar,{value:Math.floor($x/$k)*this._cellSize},$I,null,$z,0,!0)}else this.startIndex=$x,$z&&$z.run()},$z._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$z.commitMeasure=function(){this.runCallLater(this.changeCells)},$a(0,$z,"cacheAs",$x.prototype._$get_cacheAs,function($x){$s.superSet($j,this,"cacheAs",$x),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$x?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$a(0,$z,"content",function(){return this._content}),$a(0,$z,"height",$x.prototype._$get_height,function($x){$x!=this._height&&($s.superSet($j,this,"height",$x),this._setCellChanged())}),$a(0,$z,"itemRender",function(){return this._itemRender},function($x){if(this._itemRender!=$x){this._itemRender=$x;for(var $I=this._cells.length-1;-1<$I;$I--)this._cells[$I].destroy();this._cells.length=0,this._setCellChanged()}}),$a(0,$z,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($x){this._removePreScrollBar();var $I=new $Ix;$I.name="scrollBar",$I.right=0,$x&&" "!=$x&&($I.skin=$x),this.scrollBar=$I,this.addChild($I),this._setCellChanged()}),$a(0,$z,"page",function(){return this._page},function($x){this._page=$x,this._array&&(this._page=0<$x?$x:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$a(0,$z,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($x){this._removePreScrollBar();var $I=new $u;$I.name="scrollBar",$I.bottom=0,$x&&" "!=$x&&($I.skin=$x),this.scrollBar=$I,this.addChild($I),this._setCellChanged()}),$a(0,$z,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($x){this._repeatX=$x,this._setCellChanged()}),$a(0,$z,"scrollBar",function(){return this._scrollBar},function($x){this._scrollBar!=$x&&(this._scrollBar=$x)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$a(0,$z,"width",$x.prototype._$get_width,function($x){$x!=this._width&&($s.superSet($j,this,"width",$x),this._setCellChanged())}),$a(0,$z,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($x){this._repeatY=$x,this._setCellChanged()}),$a(0,$z,"spaceX",function(){return this._spaceX},function($x){this._spaceX=$x,this._setCellChanged()}),$a(0,$z,"spaceY",function(){return this._spaceY},function($x){this._spaceY=$x,this._setCellChanged()}),$a(0,$z,"selectedIndex",function(){return this._selectedIndex},function($x){this._selectedIndex!=$x&&(this._selectedIndex=$x,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($x),this.startIndex=this._startIndex)}),$a(0,$z,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($x){this.selectedIndex=this._array.indexOf($x)}),$a(0,$z,"length",function(){return this._array?this._array.length:0}),$a(0,$z,"selection",function(){return this.getCell(this._selectedIndex)},function($x){this.selectedIndex=this._startIndex+this._cells.indexOf($x)}),$a(0,$z,"startIndex",function(){return this._startIndex},function($x){this._startIndex=0<$x?$x:0,this.callLater(this.renderItems)}),$a(0,$z,"twSwitch",function(){return this._twSwitch},function($x){this._twSwitch=$x}),$a(0,$z,"twDone",function(){return this._twDone},function($x){this._twDone=$x}),$a(0,$z,"array",function(){return this._array},function($x){this.runCallLater(this.changeCells),this._array=$x||[];var $I=this._array.length;if(this.totalPage=Math.ceil($I/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$I?this._selectedIndex:$I-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $z=this._isVertical?this.repeatX:this.repeatY,$k=this._isVertical?this.repeatY:this.repeatX,$l=Math.ceil($I/$z);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$k/$l,this._scrollBar.setScroll(0,($l-$k)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$a(0,$z,"dataSource",$x.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)&&Math.floor($x)==$x||"string"==typeof $x?this.selectedIndex=parseInt($x):$x instanceof Array?this.array=$x:$s.superSet($j,this,"dataSource",$x)}),$a(0,$z,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$I}($j),$u=function($x){function $I(){$I.__super.call(this)}return $n($I,"laya.ui.HScrollBar",$x),$I.prototype.initialize=function(){$x.prototype.initialize.call(this),this.slider.isVertical=!1},$I}($W),$r=function($x){function $I(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$I.__super.call(this),this.width=this.height=100}$n($I,"laya.ui.Panel",$x);var $z=$I.prototype;return $z.destroy=function($x){void 0===$x&&($x=!0),laya.ui.Component.prototype.destroy.call(this,$x),this._content&&this._content.destroy($x),this._vScrollBar&&this._vScrollBar.destroy($x),this._hScrollBar&&this._hScrollBar.destroy($x),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$z.destroyChildren=function(){this._content.destroyChildren()},$z.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $j)},$z.addChild=function($x){return $x.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($x)},$z.onResize=function(){this._setScrollChanged()},$z.addChildAt=function($x,$I){return $x.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($x,$I)},$z.removeChild=function($x){return $x.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($x)},$z.removeChildAt=function($x){return this.getChildAt($x).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($x)},$z.removeChildren=function($x,$I){return void 0===$x&&($x=0),void 0===$I&&($I=2147483647),this._content.removeChildren($x,$I),this._setScrollChanged(),this},$z.getChildAt=function($x){return this._content.getChildAt($x)},$z.getChildByName=function($x){return this._content.getChildByName($x)},$z.getChildIndex=function($x){return this._content.getChildIndex($x)},$z.changeScroll=function(){this._scrollChanged=!1;var $x=this.contentWidth||1,$I=this.contentHeight||1,$z=this._vScrollBar,$k=this._hScrollBar,$l=$z&&$I>this._height,$n=$k&&$x>this._width,$a=$l?this._width-$z.width:this._width,$$=$n?this._height-$k.height:this._height;$z&&($z.x=this._width-$z.width,$z.y=0,$z.height=this._height-($n?$k.height:0),$z.scrollSize=Math.max(.033*this._height,1),$z.thumbPercent=$$/$I,$z.setScroll(0,$I-$$,$z.value)),$k&&($k.x=0,$k.y=this._height-$k.height,$k.width=this._width-($l?$z.width:0),$k.scrollSize=Math.max(.033*this._width,1),$k.thumbPercent=$a/$x,$k.setScroll(0,$x-$a,$k.value))},$z.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$z.setContentSize=function($x,$I){var $z=this._content;$z.width=$x,$z.height=$I,$z.scrollRect||($z.scrollRect=new $D),$z.scrollRect.setTo(0,0,$x,$I),$z.scrollRect=$z.scrollRect},$z.onScrollBarChange=function($x){var $I=this._content.scrollRect;if($I){var $z=Math.round($x.value);$x.isVertical?$I.y=$z:$I.x=$z,this._content.scrollRect=$I}},$z.scrollTo=function($x,$I){void 0===$x&&($x=0),void 0===$I&&($I=0),this.vScrollBar&&(this.vScrollBar.value=$I),this.hScrollBar&&(this.hScrollBar.value=$x)},$z.refresh=function(){this.changeScroll()},$z.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$s.superGet($j,this,"cacheAs")),$s.superSet($j,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$z.onScrollEnd=function(){$s.superSet($j,this,"cacheAs",this._$P.cacheAs)},$z._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$a(0,$z,"numChildren",function(){return this._content.numChildren}),$a(0,$z,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($x){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $u),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$x}),$a(0,$z,"contentWidth",function(){for(var $x=0,$I=this._content.numChildren-1;-1<$I;$I--){var $z=this._content.getChildAt($I);$x=Math.max($z.x+$z.width*$z.scaleX,$x)}return $x}),$a(0,$z,"contentHeight",function(){for(var $x=0,$I=this._content.numChildren-1;-1<$I;$I--){var $z=this._content.getChildAt($I);$x=Math.max($z.y+$z.height*$z.scaleY,$x)}return $x}),$a(0,$z,"width",$x.prototype._$get_width,function($x){$s.superSet($j,this,"width",$x),this._setScrollChanged()}),$a(0,$z,"hScrollBar",function(){return this._hScrollBar}),$a(0,$z,"content",function(){return this._content}),$a(0,$z,"height",$x.prototype._$get_height,function($x){$s.superSet($j,this,"height",$x),this._setScrollChanged()}),$a(0,$z,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($x){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $Ix),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$x}),$a(0,$z,"vScrollBar",function(){return this._vScrollBar}),$a(0,$z,"cacheAs",$x.prototype._$get_cacheAs,function($x){$s.superSet($j,this,"cacheAs",$x),this._$P.cacheAs=null,"none"!==$x?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$I}($j),$g=function($x){function $I($x){$I.__super.call(this,$x),this.isVertical=!1}return $n($I,"laya.ui.HSlider",$q),$I}(),$M=function($x){function $z($x,$I){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$z.__super.call(this),this.skin=$I,this.labels=$x}$n($z,"laya.ui.UIGroup",$x);var $I=$z.prototype;return $s.imps($I,{"laya.ui.IItem":!0}),$I.preinitialize=function(){this.mouseEnabled=!0},$I.destroy=function($x){void 0===$x&&($x=!0),laya.ui.Component.prototype.destroy.call(this,$x),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$I.addItem=function($x,$I){void 0===$I&&($I=!0);var $z=$x,$k=this._items.length;if($z.name="item"+$k,this.addChild($z),this.initItems(),$I&&0<$k){var $l=this._items[$k-1];"horizontal"==this._direction?$z.x=$l.x+$l.width+this._space:$z.y=$l.y+$l.height+this._space}else $I&&($z.x=0,$z.y=0);return $k},$I.delItem=function($x,$I){void 0===$I&&($I=!0);var $z=this._items.indexOf($x);if(-1!=$z){var $k=$x;this.removeChild($k);for(var $l=$z+1,$n=this._items.length;$l<$n;$l++){var $a=this._items[$l];$a.name="item"+($l-1),$I&&("horizontal"==this._direction?$a.x-=$k.width+this._space:$a.y-=$k.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $$;$$=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$$}}},$I.initItems=function(){this._items||(this._items=[]);for(var $x=this._items.length=0;$x<1e4;$x++){var $I=this.getChildByName("item"+$x);if(null==$I)break;this._items.push($I),$I.selected=$x===this._selectedIndex,$I.clickHandler=$T.create(this,this.itemClick,[$x],!1)}},$I.itemClick=function($x){this.selectedIndex=$x},$I.setSelect=function($x,$I){this._items&&-1<$x&&$x<this._items.length&&(this._items[$x].selected=$I)},$I.createItem=function($x,$I){return null},$I.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $x=0,$I=0,$z=this._items.length;$I<$z;$I++){var $k=this._items[$I];this._skin&&($k.skin=this._skin),this._labelColors&&($k.labelColors=this._labelColors),this._labelSize&&($k.labelSize=this._labelSize),this._labelStroke&&($k.labelStroke=this._labelStroke),this._labelStrokeColor&&($k.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($k.strokeColors=this._strokeColors),this._labelBold&&($k.labelBold=this._labelBold),this._labelPadding&&($k.labelPadding=this._labelPadding),this._labelAlign&&($k.labelAlign=this._labelAlign),this._stateNum&&($k.stateNum=this._stateNum),this._labelFont&&($k.labelFont=this._labelFont),"horizontal"===this._direction?($k.y=0,$k.x=$x,$x+=$k.width+this._space):($k.x=0,$k.y=$x,$x+=$k.height+this._space)}this.changeSize()},$I.commitMeasure=function(){this.runCallLater(this.changeLabels)},$I._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$a(0,$I,"labelStrokeColor",function(){return this._labelStrokeColor},function($x){this._labelStrokeColor!=$x&&(this._labelStrokeColor=$x,this._setLabelChanged())}),$a(0,$I,"skin",function(){return this._skin},function($x){this._skin!=$x&&(this._skin=$x,this._setLabelChanged())}),$a(0,$I,"selectedIndex",function(){return this._selectedIndex},function($x){this._selectedIndex!=$x&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$x,this.setSelect($x,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$a(0,$I,"labels",function(){return this._labels},function($x){if(this._labels!=$x){if(this._labels=$x,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $I=this._labels.split(","),$z=0,$k=$I.length;$z<$k;$z++){var $l=this.createItem(this._skin,$I[$z]);$l.name="item"+$z,this.addChild($l)}this.initItems()}}),$a(0,$I,"strokeColors",function(){return this._strokeColors},function($x){this._strokeColors!=$x&&(this._strokeColors=$x,this._setLabelChanged())}),$a(0,$I,"labelColors",function(){return this._labelColors},function($x){this._labelColors!=$x&&(this._labelColors=$x,this._setLabelChanged())}),$a(0,$I,"labelStroke",function(){return this._labelStroke},function($x){this._labelStroke!=$x&&(this._labelStroke=$x,this._setLabelChanged())}),$a(0,$I,"labelSize",function(){return this._labelSize},function($x){this._labelSize!=$x&&(this._labelSize=$x,this._setLabelChanged())}),$a(0,$I,"stateNum",function(){return this._stateNum},function($x){this._stateNum!=$x&&(this._stateNum=$x,this._setLabelChanged())}),$a(0,$I,"labelBold",function(){return this._labelBold},function($x){this._labelBold!=$x&&(this._labelBold=$x,this._setLabelChanged())}),$a(0,$I,"labelFont",function(){return this._labelFont},function($x){this._labelFont!=$x&&(this._labelFont=$x,this._setLabelChanged())}),$a(0,$I,"labelPadding",function(){return this._labelPadding},function($x){this._labelPadding!=$x&&(this._labelPadding=$x,this._setLabelChanged())}),$a(0,$I,"direction",function(){return this._direction},function($x){this._direction=$x,this._setLabelChanged()}),$a(0,$I,"space",function(){return this._space},function($x){this._space=$x,this._setLabelChanged()}),$a(0,$I,"items",function(){return this._items}),$a(0,$I,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($x){this.selectedIndex=this._items.indexOf($x)}),$a(0,$I,"dataSource",$x.prototype._$get_dataSource,function($x){"number"==typeof(this._dataSource=$x)&&Math.floor($x)==$x||"string"==typeof $x?this.selectedIndex=parseInt($x):$x instanceof Array?this.labels=$x.join(","):$s.superSet($j,this,"dataSource",$x)}),$z}($j),$Q=function($I){function $z($x,$I){this._value=null,void 0===$I&&($I=""),$z.__super.call(this,$x,$I)}$n($z,"laya.ui.Radio",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._value=null},$x.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$x.initialize=function(){$I.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$x.onClick=function($x){this.selected=!0},$a(0,$x,"value",function(){return null!=this._value?this._value:this.label},function($x){this._value=$x}),$z}($t),$G=function($x){function $I(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$I.__super.call(this),this.width=this.height=200}$n($I,"laya.ui.Tree",$x);var $z=$I.prototype;return $s.imps($z,{"laya.ui.IRender":!0}),$z.destroy=function($x){void 0===$x&&($x=!0),laya.ui.Component.prototype.destroy.call(this,$x),this._list&&this._list.destroy($x),this._list=null,this._source=null,this._renderHandler=null},$z.createChildren=function(){this.addChild(this._list=new $p),this._list.renderHandler=$T.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$z.onListChange=function($x){this.event("change")},$z.getArray=function(){var $x,$I=[];for(var $z in this._source)$x=this._source[$z],this.getParentOpenStatus($x)&&($x.x=this._spaceLeft*this.getDepth($x),$I.push($x));return $I},$z.getDepth=function($x,$I){return void 0===$I&&($I=0),null==$x.nodeParent?$I:this.getDepth($x.nodeParent,$I+1)},$z.getParentOpenStatus=function($x){var $I=$x.nodeParent;return null==$I||!!$I.isOpen&&(null==$I.nodeParent||this.getParentOpenStatus($I))},$z.renderItem=function($x,$I){var $z=$x.dataSource;if($z){$x.left=$z.x;var $k=$x.getChildByName("arrow");$k&&($z.hasChild?($k.visible=!0,$k.index=$z.isOpen?1:0,$k.tag=$I,$k.off("click",this,this.onArrowClick),$k.on("click",this,this.onArrowClick)):$k.visible=!1);var $l=$x.getChildByName("folder");$l&&(2==$l.clipY?$l.index=$z.isDirectory?0:1:$l.index=$z.isDirectory?$z.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$x,$I])}},$z.onArrowClick=function($x){var $I=$x.currentTarget.tag;this._list.array[$I].isOpen=!this._list.array[$I].isOpen,this.event("open"),this._list.array=this.getArray()},$z.setItemState=function($x,$I){this._list.array[$x]&&(this._list.array[$x].isOpen=$I,this._list.array=this.getArray())},$z.fresh=function(){this._list.array=this.getArray(),this.repaint()},$z.parseXml=function($x,$I,$z,$k){var $l,$n=$x.childNodes,$a=$n.length;if(!$k){$l={};var $$,$w=$x.attributes;for(var $i in $w){var $F=($$=$w[$i]).nodeName,$b=$$.nodeValue;$l[$F]="true"==$b||"false"!=$b&&$b}$l.nodeParent=$z,0<$a&&($l.isDirectory=!0),$l.hasChild=0<$a,$I.push($l)}for(var $T=0;$T<$a;$T++){var $_=$n[$T];this.parseXml($_,$I,$l,!1)}},$z.parseOpenStatus=function($x,$I){for(var $z=0,$k=$I.length;$z<$k;$z++){var $l=$I[$z];if($l.isDirectory)for(var $n=0,$a=$x.length;$n<$a;$n++){var $$=$x[$n];if($$.isDirectory&&this.isSameParent($$,$l)&&$l.label==$$.label){$l.isOpen=$$.isOpen;break}}}},$z.isSameParent=function($x,$I){return null==$x.nodeParent&&null==$I.nodeParent||null!=$x.nodeParent&&null!=$I.nodeParent&&($x.nodeParent.label==$I.nodeParent.label&&this.isSameParent($x.nodeParent,$I.nodeParent))},$z.filter=function($x){if(Boolean($x)){var $I=[];this.getFilterSource(this._source,$I,$x),this._list.array=$I}else this._list.array=this.getArray()},$z.getFilterSource=function($x,$I,$z){var $k;for(var $l in $z=$z.toLocaleLowerCase(),$x)!($k=$x[$l]).isDirectory&&-1<String($k.label).toLowerCase().indexOf($z)&&($k.x=0,$I.push($k)),$k.child&&0<$k.child.length&&this.getFilterSource($k.child,$I,$z)},$a(0,$z,"spaceBottom",function(){return this._list.spaceY},function($x){this._list.spaceY=$x}),$a(0,$z,"keepStatus",function(){return this._keepStatus},function($x){this._keepStatus=$x}),$a(0,$z,"itemRender",function(){return this._list.itemRender},function($x){this._list.itemRender=$x}),$a(0,$z,"array",function(){return this._list.array},function($x){this._keepStatus&&this._list.array&&$x&&this.parseOpenStatus(this._list.array,$x),this._source=$x,this._list.array=this.getArray()}),$a(0,$z,"mouseHandler",function(){return this._list.mouseHandler},function($x){this._list.mouseHandler=$x}),$a(0,$z,"dataSource",$x.prototype._$get_dataSource,function($x){this._dataSource=$x,$s.superSet($j,this,"dataSource",$x)}),$a(0,$z,"source",function(){return this._source}),$a(0,$z,"scrollBar",function(){return this._list.scrollBar}),$a(0,$z,"list",function(){return this._list}),$a(0,$z,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($x){this._list.vScrollBarSkin=$x}),$a(0,$z,"renderHandler",function(){return this._renderHandler},function($x){this._renderHandler=$x}),$a(0,$z,"selectedIndex",function(){return this._list.selectedIndex},function($x){this._list.selectedIndex=$x}),$a(0,$z,"spaceLeft",function(){return this._spaceLeft},function($x){this._spaceLeft=$x}),$a(0,$z,"selectedItem",function(){return this._list.selectedItem},function($x){this._list.selectedItem=$x}),$a(0,$z,"width",$x.prototype._$get_width,function($x){$s.superSet($j,this,"width",$x),this._list.width=$x}),$a(0,$z,"height",$x.prototype._$get_height,function($x){$s.superSet($j,this,"height",$x),this._list.height=$x}),$a(0,$z,"xml",null,function($x){var $I=[];this.parseXml($x.childNodes[0],$I,null,!0),this.array=$I}),$a(0,$z,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$I}($j),$xx=function($x){function $I(){this._items=null,this._selectedIndex=0,$I.__super.call(this),this._setIndexHandler=$T.create(this,this.setIndex,null,!1)}$n($I,"laya.ui.ViewStack",$x);var $z=$I.prototype;return $s.imps($z,{"laya.ui.IItem":!0}),$z.setItems=function($x){this.removeChildren();for(var $I=0,$z=0,$k=$x.length;$z<$k;$z++){var $l=$x[$z];$l&&($l.name="item"+$I,this.addChild($l),$I++)}this.initItems()},$z.addItem=function($x){$x.name="item"+this._items.length,this.addChild($x),this.initItems()},$z.initItems=function(){this._items=[];for(var $x=0;$x<1e4;$x++){var $I=this.getChildByName("item"+$x);if(null==$I)break;this._items.push($I),$I.visible=$x==this._selectedIndex}},$z.setSelect=function($x,$I){this._items&&-1<$x&&$x<this._items.length&&(this._items[$x].visible=$I)},$z.setIndex=function($x){this.selectedIndex=$x},$a(0,$z,"dataSource",$x.prototype._$get_dataSource,function($x){if("number"==typeof(this._dataSource=$x)&&Math.floor($x)==$x||"string"==typeof $x)this.selectedIndex=parseInt($x);else for(var $I in this._dataSource)this.hasOwnProperty($I)&&(this[$I]=this._dataSource[$I])}),$a(0,$z,"selectedIndex",function(){return this._selectedIndex},function($x){this._selectedIndex!=$x&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$x,this.setSelect(this._selectedIndex,!0))}),$a(0,$z,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($x){this.selectedIndex=this._items.indexOf($x)}),$a(0,$z,"items",function(){return this._items}),$a(0,$z,"setIndexHandler",function(){return this._setIndexHandler},function($x){this._setIndexHandler=$x}),$I}($j),$Ix=function($x){function $I(){$I.__super.call(this)}return $n($I,"laya.ui.VScrollBar",$W),$I}(),$zx=function($I){function $z($x){this._bg=null,this._skin=null,$z.__super.call(this),void 0===$x&&($x=""),this.text=$x,this.skin=this.skin}$n($z,"laya.ui.TextInput",$I);var $x=$z.prototype;return $x.preinitialize=function(){this.mouseEnabled=!0},$x.destroy=function($x){$f.clearCache(this,this._skin),void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._bg&&this._bg.destroy(),this._bg=null},$x.createChildren=function(){this.addChild(this._tf=new $_),this._tf.padding=$O.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$x._onFocus=function(){this.event("focus",this)},$x._onBlur=function(){this.event("blur",this)},$x._onInput=function(){this.event("input",this)},$x._onEnter=function(){this.event("enter",this)},$x.initialize=function(){this.width=128,this.height=22},$x.select=function(){this._tf.select()},$x.setSelection=function($x,$I){this._tf.setSelection($x,$I)},$a(0,$x,"text",$I.prototype._$get_text,function($x){this._tf.text!=$x&&($x+="",this._tf.text=$x,this.event("change"))}),$a(0,$x,"bg",function(){return this._bg},function($x){this.graphics=this._bg=$x}),$a(0,$x,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($x){this._tf.inputElementYAdjuster=$x}),$a(0,$x,"multiline",function(){return this._tf.multiline},function($x){this._tf.multiline=$x}),$a(0,$x,"skin",function(){return this._skin},function($x){this._skin!=$x&&($f.clearCache(this,this._skin),this._skin=$x,this._bg||(this.graphics=this._bg=new $U),$f.keepCache(this,this._skin),this._bg.source=$f.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$a(0,$x,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($x){this._bg||(this.graphics=this._bg=new $U),this._bg.sizeGrid=$S.fillArray($O.defaultSizeGrid,$x,Number)}),$a(0,$x,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($x){this._tf.inputElementXAdjuster=$x}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($J,this,"width",$x),this._bg&&(this._bg.width=$x)}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($J,this,"height",$x),this._bg&&(this._bg.height=$x)}),$a(0,$x,"editable",function(){return this._tf.editable},function($x){this._tf.editable=$x}),$a(0,$x,"restrict",function(){return this._tf.restrict},function($x){this._tf.restrict=$x}),$a(0,$x,"prompt",function(){return this._tf.prompt},function($x){this._tf.prompt=$x}),$a(0,$x,"promptColor",function(){return this._tf.promptColor},function($x){this._tf.promptColor=$x}),$a(0,$x,"maxChars",function(){return this._tf.maxChars},function($x){this._tf.maxChars=$x}),$a(0,$x,"focus",function(){return this._tf.focus},function($x){this._tf.focus=$x}),$a(0,$x,"type",function(){return this._tf.type},function($x){this._tf.type=$x}),$a(0,$x,"asPassword",function(){return this._tf.asPassword},function($x){this._tf.asPassword=$x}),$z}($J),$kx=function($x){function $I(){$I.__super.call(this)}return $n($I,"laya.ui.VSlider",$q),$I}(),$lx=function($x){function $k(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$k.__super.call(this)}$n($k,"laya.ui.Dialog",$x);var $I=$k.prototype;return $I.initialize=function(){this.popupEffect=$k.manager.popupEffectHandler,this.closeEffect=$k.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$I._dealDragArea=function(){var $x=this.getChildByName("drag");$x&&(this.dragArea=$x.x+","+$x.y+","+$x.width+","+$x.height,$x.removeSelf())},$I._onClick=function($x){var $I=$x.target;if($I)switch($I.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($I.name)}},$I.show=function($x,$I){void 0===$x&&($x=!1),void 0===$I&&($I=!0),this._open(!1,$x,$I)},$I.popup=function($x,$I){void 0===$x&&($x=!1),void 0===$I&&($I=!0),this._open(!0,$x,$I)},$I._open=function($x,$I,$z){$k.manager.lock(!1),this.isModal=$x,$k.manager.open(this,$I,$z)},$I.onOpened=function(){},$I.close=function($x,$I){void 0===$I&&($I=!0),$k.manager.close(this,$x,$I)},$I.onClosed=function($x){},$I._onMouseDown=function($x){var $I=this.getMousePoint();this._dragArea.contains($I.x,$I.y)?this.startDrag():this.stopDrag()},$a(0,$I,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($x){if($x){var $I=$S.fillArray([0,0,0,0],$x,Number);this._dragArea=new $D($I[0],$I[1],$I[2],$I[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$a(0,$I,"isPopup",function(){return null!=this.parent}),$a(0,$I,"zOrder",$x.prototype._$get_zOrder,function($x){$s.superSet($B,this,"zOrder",$x),$k.manager._checkMask()}),$a(1,$k,"manager",function(){return $k._manager=$k._manager||new $d},function($x){$k._manager=$x}),$k.setLockView=function($x){$k.manager.setLockView($x)},$k.lock=function($x){$k.manager.lock($x)},$k.closeAll=function(){$k.manager.closeAll()},$k.getDialogsByGroup=function($x){return $k.manager.getDialogsByGroup($x)},$k.closeByGroup=function($x){return $k.manager.closeByGroup($x)},$k.CLOSE="close",$k.CANCEL="cancel",$k.SURE="sure",$k.NO="no",$k.OK="ok",$k.YES="yes",$k._manager=null,$k}($B),$nx=function($x){function $I(){$I.__super.call(this)}$n($I,"laya.ui.HBox",$x);var $z=$I.prototype;return $z.sortItem=function($x){$x&&$x.sort(function($x,$I){return $x.x-$I.x})},$z.changeItems=function(){this._itemChanged=!1;for(var $x=[],$I=0,$z=0,$k=this.numChildren;$z<$k;$z++){var $l=this.getChildAt($z);$l&&$l.layoutEnabled&&($x.push($l),$I=this._height?this._height:Math.max($I,$l.height*$l.scaleY))}this.sortItem($x);var $n=0;for($z=0,$k=$x.length;$z<$k;$z++)($l=$x[$z]).x=$n,$n+=$l.width*$l.scaleX+this._space,"top"==this._align?$l.y=0:"middle"==this._align?$l.y=.5*($I-$l.height*$l.scaleY):"bottom"==this._align&&($l.y=$I-$l.height*$l.scaleY);this.changeSize()},$a(0,$z,"height",$x.prototype._$get_height,function($x){this._height!=$x&&($s.superSet($A,this,"height",$x),this.callLater(this.changeItems))}),$I.NONE="none",$I.TOP="top",$I.MIDDLE="middle",$I.BOTTOM="bottom",$I}($A),$ax=function($x){function $I(){$I.__super.call(this)}$n($I,"laya.ui.VBox",$x);var $z=$I.prototype;return $z.changeItems=function(){this._itemChanged=!1;for(var $x=[],$I=0,$z=0,$k=this.numChildren;$z<$k;$z++){var $l=this.getChildAt($z);$l&&$l.layoutEnabled&&($x.push($l),$I=this._width?this._width:Math.max($I,$l.width*$l.scaleX))}this.sortItem($x);var $n=0;for($z=0,$k=$x.length;$z<$k;$z++)($l=$x[$z]).y=$n,$n+=$l.height*$l.scaleY+this._space,"left"==this._align?$l.x=0:"center"==this._align?$l.x=.5*($I-$l.width*$l.scaleX):"right"==this._align&&($l.x=$I-$l.width*$l.scaleX);this.changeSize()},$a(0,$z,"width",$x.prototype._$get_width,function($x){this._width!=$x&&($s.superSet($A,this,"width",$x),this.callLater(this.changeItems))}),$I.NONE="none",$I.LEFT="left",$I.CENTER="center",$I.RIGHT="right",$I}($A),$$x=function($x){function $I(){$I.__super.call(this)}return $n($I,"laya.ui.RadioGroup",$M),$I.prototype.createItem=function($x,$I){return new $Q($x,$I)},$I}(),$wx=function($x){function $I(){$I.__super.call(this)}return $n($I,"laya.ui.Tab",$M),$I.prototype.createItem=function($x,$I){return new $t($x,$I)},$I}(),$ix=function($I){function $z($x){this._vScrollBar=null,this._hScrollBar=null,void 0===$x&&($x=""),$z.__super.call(this,$x)}$n($z,"laya.ui.TextArea",$I);var $x=$z.prototype;return $x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$x.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$x.onVBarChanged=function($x){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$x.onHBarChanged=function($x){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$x.changeScroll=function(){var $x=this._vScrollBar&&0<this._tf.maxScrollY,$I=this._hScrollBar&&0<this._tf.maxScrollX,$z=$x?this._width-this._vScrollBar.width:this._width,$k=$I?this._height-this._hScrollBar.height:this._height,$l=this._tf.padding||$O.labelPadding;this._tf.width=$z,this._tf.height=$k,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$l[2],this._vScrollBar.y=$l[1],this._vScrollBar.height=this._height-($I?this._hScrollBar.height:0)-$l[1]-$l[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$k/Math.max(this._tf.textHeight,$k),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$x),this._hScrollBar&&(this._hScrollBar.x=$l[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$l[3],this._hScrollBar.width=this._width-($x?this._vScrollBar.width:0)-$l[0]-$l[2],this._hScrollBar.scrollSize=Math.max(.033*$z,1),this._hScrollBar.thumbPercent=$z/Math.max(this._tf.textWidth,$z),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$I)},$x.scrollTo=function($x){this.commitMeasure(),this._tf.scrollY=$x},$a(0,$x,"scrollY",function(){return this._tf.scrollY}),$a(0,$x,"width",$I.prototype._$get_width,function($x){$s.superSet($zx,this,"width",$x),this.callLater(this.changeScroll)}),$a(0,$x,"hScrollBar",function(){return this._hScrollBar}),$a(0,$x,"height",$I.prototype._$get_height,function($x){$s.superSet($zx,this,"height",$x),this.callLater(this.changeScroll)}),$a(0,$x,"maxScrollX",function(){return this._tf.maxScrollX}),$a(0,$x,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($x){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $Ix),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$x}),$a(0,$x,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($x){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $u),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$x}),$a(0,$x,"vScrollBar",function(){return this._vScrollBar}),$a(0,$x,"maxScrollY",function(){return this._tf.maxScrollY}),$a(0,$x,"scrollX",function(){return this._tf.scrollX}),$z}($zx);!function($x){function $I(){this._uiView=null,this.isCloseOther=!1,$I.__super.call(this)}$n($I,"laya.ui.AsynDialog",$lx);var $z=$I.prototype;$z.createView=function($x){this._uiView=$x},$z._open=function($x,$I,$z){this.isModal=$x,this.isCloseOther=$I,$lx.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$z.onCreated=function(){this.createUI(),this.onOpen()},$z.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$z.onOpen=function(){$lx.manager.open(this,this.isCloseOther),$lx.manager.lock(!1)},$z.close=function($x,$I){void 0===$I&&($I=!0),$lx.manager.close(this),this.onClose()},$z.onClose=function(){},$z.destroy=function($x){void 0===$x&&($x=!0),laya.ui.View.prototype.destroy.call(this,$x),this._uiView=null,this.onDestroy()},$z.onDestroy=function(){}}();$s.__init([$B])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($x,$I){"use strict";for(var $z in Object.defineProperty($I,"__esModule",{value:!0}),Laya){var $k=Laya[$z];$k&&$k.__isclass&&($I[$z]=$k)}}),function($T,$x,$C){$C.un,$C.uns;var $b=$C.static,$_=$C.class,$R=$C.getset,$k=$C.__newvec,$y=laya.maths.Arith,$a=laya.webgl.atlas.AtlasResourceManager,$z=laya.webgl.shader.BaseShader,$X=laya.utils.Browser,$$=laya.webgl.utils.Buffer,$P=laya.utils.Byte,$l=laya.utils.ClassUtils,$w=$C.Config,$n=(laya.events.Event,laya.events.EventDispatcher),$O=laya.utils.Handler,$D=laya.net.Loader,$I=laya.net.LoaderManager,$i=(laya.maths.MathUtil,laya.display.Node),$s=laya.renders.Render,$F=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$N=laya.resource.Resource,$f=laya.utils.RunDriver,$m=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$v=laya.display.Sprite,$L=laya.utils.Stat,$K=laya.utils.StringKey,$S=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$E=laya.utils.Utils,$Z=laya.webgl.WebGL,$U=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$C.interface("laya.d3.core.IClone"),$C.interface("laya.d3.graphics.IVertex"),$C.interface("laya.d3.core.render.IUpdate"),$C.interface("laya.d3.core.scene.ITreeNode"),$C.interface("laya.d3.core.render.IRenderable");(function(){function $t(){}$_($t,"laya.d3.animation.AnimationClipParser01"),$t.READ_DATA=function(){$t._DATA.offset=$t._reader.getUint32(),$t._DATA.size=$t._reader.getUint32()},$t.READ_BLOCK=function(){for(var $x=$t._BLOCK.count=$t._reader.getUint16(),$I=$t._BLOCK.blockStarts=[],$z=$t._BLOCK.blockLengths=[],$k=0;$k<$x;$k++)$I.push($t._reader.getUint32()),$z.push($t._reader.getUint32())},$t.READ_STRINGS=function(){var $x=$t._reader.getUint32(),$I=$t._reader.getUint16(),$z=$t._reader.pos;$t._reader.pos=$x+$t._DATA.offset;for(var $k=0;$k<$I;$k++)$t._strings[$k]=$t._reader.readUTFString();$t._reader.pos=$z},$t.parse=function($x,$I){$t._animationClip=$x;($t._reader=$I).__getBuffer();$t.READ_DATA(),$t.READ_BLOCK(),$t.READ_STRINGS();for(var $z=0,$k=$t._BLOCK.count;$z<$k;$z++){var $l=$I.getUint16(),$n=$t._strings[$l],$a=$t["READ_"+$n];if(null==$a)throw new Error("model file err,no this function:"+$l+" "+$n);$a.call()}},$t.READ_ANIMATIONS=function(){var $x,$I=0,$z=0,$k=$t._reader,$l=$k.__getBuffer(),$n=[],$a=$k.getUint8();for($n.length=$a,$I=0;$I<$a;$I++)$n[$I]=$k.getUint16();var $$=[],$w=$k.getUint16();for($$.length=$w,$I=0;$I<$w;$I++)$$[$I]=$k.getFloat32();var $i=$t._animationClip;$i.name=$t._strings[$k.getUint16()];var $F=$i._duration=$k.getFloat32();$i.islooping=!!$k.getByte(),$i._frameRate=$k.getInt16();var $b=$k.getInt16(),$T=$i._nodes=new Array;$T.length=$b,($i._publicClipDatas=[]).length=$b;var $_=$i._nodesMap={},$R=0,$s=0;for($I=0;$I<$b;$I++){$x=$T[$I]=new $h;var $N=$k.getUint16(),$D=$x.path=[];for($D.length=$N,$z=0;$z<$N;$z++)$D[$z]=$t._strings[$k.getUint16()];var $f=$D.join("/"),$m=$_[$f];$m||($_[$f]=$m=[]),$m.push($x);var $y=$k.getInt16();-1!==$y&&($x.componentType=$t._strings[$y]);var $C=$o._propertyIndexDic[$t._strings[$k.getUint16()]];if(null==$C)throw new Error("AnimationClipParser01:unknown property name.");var $P=$C<4,$v=!$P||$P&&""===$D[0];($x._cacheProperty=$v)?$R++:$s++,$x.propertyNameID=$C;var $L=$n[$k.getUint8()];$x.keyFrameWidth=$L/4;var $K=$x.keyFrames=[],$E=$K.length=$k.getUint16(),$O=null,$S=NaN;for($z=0;$z<$E;$z++){var $Z=$K[$z]=new $J;$S=$Z.startTime=$$[$k.getUint16()];var $U=$k.pos;$Z.inTangent=new Float32Array($l.slice($U,$U+$L)),$k.pos+=$L,$U=$k.pos,$Z.outTangent=new Float32Array($l.slice($U,$U+$L)),$k.pos+=$L,$U=$k.pos,$Z.data=new Float32Array($l.slice($U,$U+$L)),$k.pos+=$L,$O&&($O.next=$Z,$O.duration=$S-$O.startTime),$O=$Z}$Z.next=null,$Z.duration=$F-$S}var $X=$i._nodeToCachePropertyMap=new Int32Array($b),$d=$i._cachePropertyMap=new Int32Array($R),$j=$i._unCachePropertyMap=new Int32Array($s);for($R=$s=0,$I=0;$I<$b;$I++)($x=$T[$I])._cacheProperty?($X[$I]=$R,$d[$R++]=$I):$j[$s++]=$I},$t._animationClip=null,$t._reader=null,$t._strings=[],$b($t,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $W(){}$_($W,"laya.d3.animation.AnimationClipParser02"),$W.READ_DATA=function(){$W._DATA.offset=$W._reader.getUint32(),$W._DATA.size=$W._reader.getUint32()},$W.READ_BLOCK=function(){for(var $x=$W._BLOCK.count=$W._reader.getUint16(),$I=$W._BLOCK.blockStarts=[],$z=$W._BLOCK.blockLengths=[],$k=0;$k<$x;$k++)$I.push($W._reader.getUint32()),$z.push($W._reader.getUint32())},$W.READ_STRINGS=function(){var $x=$W._reader.getUint32(),$I=$W._reader.getUint16(),$z=$W._reader.pos;$W._reader.pos=$x+$W._DATA.offset;for(var $k=0;$k<$I;$k++)$W._strings[$k]=$W._reader.readUTFString();$W._reader.pos=$z},$W.parse=function($x,$I){$W._animationClip=$x;($W._reader=$I).__getBuffer();$W.READ_DATA(),$W.READ_BLOCK(),$W.READ_STRINGS();for(var $z=0,$k=$W._BLOCK.count;$z<$k;$z++){var $l=$I.getUint16(),$n=$W._strings[$l],$a=$W["READ_"+$n];if(null==$a)throw new Error("model file err,no this function:"+$l+" "+$n);$a.call()}},$W.READ_ANIMATIONS=function(){var $x,$I=0,$z=0,$k=$W._reader,$l=$k.__getBuffer(),$n=[],$a=$k.getUint8();for($n.length=$a,$I=0;$I<$a;$I++)$n[$I]=$k.getUint16();var $$=[],$w=$k.getUint16();for($$.length=$w,$I=0;$I<$w;$I++)$$[$I]=$k.getFloat32();var $i=$W._animationClip;$i.name=$W._strings[$k.getUint16()];var $F=$i._duration=$k.getFloat32();$i.islooping=!!$k.getByte(),$i._frameRate=$k.getInt16();var $b=$k.getInt16(),$T=$i._nodes=new Array;$T.length=$b,($i._publicClipDatas=[]).length=$b;var $_=$i._nodesMap={},$R=0,$s=0;for($I=0;$I<$b;$I++){$x=$T[$I]=new $h;var $N=$k.getUint16(),$D=$x.path=[];for($D.length=$N,$z=0;$z<$N;$z++)$D[$z]=$W._strings[$k.getUint16()];var $f=$D.join("/"),$m=$_[$f];$m||($_[$f]=$m=[]),$m.push($x);var $y=$k.getInt16();-1!==$y&&($x.componentType=$W._strings[$y]);var $C=$o._propertyIndexDic[$W._strings[$k.getUint16()]];if(null==$C)throw new Error("AnimationClipParser02:unknown property name.");var $P=$C<4,$v=!$P||$P&&""===$D[0];($x._cacheProperty=$v)?$R++:$s++,$x.propertyNameID=$C;var $L=$n[$k.getUint8()];$x.keyFrameWidth=$L/4;var $K=$x.keyFrames=[],$E=$K.length=$k.getUint16(),$O=null,$S=NaN;for($z=0;$z<$E;$z++){var $Z=$K[$z]=new $J;$S=$Z.startTime=$$[$k.getUint16()];var $U=$k.pos;$Z.inTangent=new Float32Array($l.slice($U,$U+$L)),$k.pos+=$L,$U=$k.pos,$Z.outTangent=new Float32Array($l.slice($U,$U+$L)),$k.pos+=$L,$U=$k.pos,$Z.data=new Float32Array($l.slice($U,$U+$L)),$k.pos+=$L,$O&&($O.next=$Z,$O.duration=$S-$O.startTime),$O=$Z}$Z.next=null,$Z.duration=$F-$S}var $X=$k.getUint16();for($I=0;$I<$X;$I++){var $d,$j=new $q;$j.time=$k.getFloat32(),$j.eventName=$W._strings[$k.getUint16()];var $t=$k.getUint16();for(0<$t&&($j.params=$d=[]),$z=0;$z<$t;$z++){switch($k.getByte()){case 0:$d.push(!!$k.getByte());break;case 1:$d.push($k.getInt32());break;case 2:$d.push($k.getFloat32());break;case 3:$d.push($W._strings[$k.getUint16()]);break;default:throw new Error("unknown type.")}}$i.addEvent($j)}var $Y=$i._nodeToCachePropertyMap=new Int32Array($b),$c=$i._cachePropertyMap=new Int32Array($R),$V=$i._unCachePropertyMap=new Int32Array($s);for($R=$s=0,$I=0;$I<$b;$I++)($x=$T[$I])._cacheProperty?($Y[$I]=$R,$c[$R++]=$I):$V[$s++]=$I},$W._animationClip=null,$W._reader=null,$W._strings=[],$b($W,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $q=function(){function $x(){this.time=NaN,this.eventName=null,this.params=null}return $_($x,"laya.d3.animation.AnimationEvent"),$x}(),$o=function(){function $k(){this._childs=[],this.transform=new $fI(this)}$_($k,"laya.d3.animation.AnimationNode");var $x=$k.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.addChild=function($x){$x._parent=this,$x.transform.setParent(this.transform),this._childs.push($x)},$x.removeChild=function($x){var $I=this._childs.indexOf($x);-1!==$I&&this._childs.splice($I,1)},$x.getChildByName=function($x){for(var $I=0,$z=this._childs.length;$I<$z;$I++){var $k=this._childs[$I];if($k.name===$x)return $k}return null},$x.getChildByIndex=function($x){return this._childs[$x]},$x.getChildCount=function(){return this._childs.length},$x.cloneTo=function($x){var $I=$x;$I.name=this.name;for(var $z=0,$k=this._childs.length;$z<$k;$z++){var $l=this._childs[$z],$n=$l.clone();$I.addChild($n);var $a=$l.transform,$$=$n.transform;$$.setLocalPosition($a.getLocalPosition()),$$.setLocalRotation($a.getLocalRotation()),$$.setLocalScale($a.getLocalScale()),$$._localRotationEuler=$a._localRotationEuler,$$._setWorldMatrixIgnoreUpdate($a.getWorldMatrix())}},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$k.__init__=function(){$k.registerAnimationNodeProperty("localPosition",$k._getLocalPosition,$k._setLocalPosition),$k.registerAnimationNodeProperty("localRotation",$k._getLocalRotation,$k._setLocalRotation),$k.registerAnimationNodeProperty("localScale",$k._getLocalScale,$k._setLocalScale),$k.registerAnimationNodeProperty("localRotationEuler",$k._getLocalRotationEuler,$k._setLocalRotationEuler),$k.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$k._getParticleRenderSharedMaterialTintColor,$k._setParticleRenderSharedMaterialTintColor),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$k._getMeshRenderSharedMaterialTilingOffset,$k._setMeshRenderSharedMaterialTilingOffset),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$k._getMeshRenderSharedMaterialAlbedo,$k._setMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$k._getSkinnedMeshRenderSharedMaterialTilingOffset,$k._setSkinnedMeshRenderSharedMaterialTilingOffset),$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$k._getSkinnedMeshRenderSharedMaterialAlbedo,$k._setSkinnedMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$k._getMeshRenderSharedMaterialAlbedo,$k._setMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$k._getSkinnedMeshRenderSharedMaterialAlbedo,$k._setSkinnedMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$k._getMeshRenderSharedMaterialIntensity,$k._setMeshRenderSharedMaterialIntensity),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$k._getMeshRenderSharedMaterialAlpha,$k._setMeshRenderSharedMaterialAlpha),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$k._getMeshRenderSharedMaterialAlphaColor,$k._setMeshRenderSharedMaterialAlphaColor),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$k._getMeshRenderSharedMaterialBaseColor,$k._setMeshRenderSharedMaterialBaseColor),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$k._getMeshRenderSharedMaterialDissolve,$k._setMeshRenderSharedMaterialDissolve),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$k._getMeshRenderSharedMaterialDissolveSpeed,$k._setMeshRenderSharedMaterialDissolveSpeed),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$k._getMeshRenderSharedMaterialMMultiplier,$k._setMeshRenderSharedMaterialMMultiplier),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$k._getMeshRenderSharedMaterialBaseScrollSpeedX,$k._setMeshRenderSharedMaterialBaseScrollSpeedX),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$k._getMeshRenderSharedMaterialBaseScrollSpeedY,$k._setMeshRenderSharedMaterialBaseScrollSpeedY),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$k._getMeshRenderSharedMaterialSecondScrollSpeedX,$k._setMeshRenderSharedMaterialSecondScrollSpeedX),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$k._getMeshRenderSharedMaterialSecondScrollSpeedY,$k._setMeshRenderSharedMaterialSecondScrollSpeedY),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$k._getMeshRenderSharedMaterialDetailTilingOffset,$k._setMeshRenderSharedMaterialDetailTilingOffset),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$k._getMeshRenderSharedMaterialDissolveTilingOffset,$k._setMeshRenderSharedMaterialDissolveTilingOffset),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$k._getMeshRenderSharedMaterialMaskTilingOffset,$k._setMeshRenderSharedMaterialMaskTilingOffset)},$k.registerAnimationNodeProperty=function($x,$I,$z){if($k._propertyIndexDic[$x])throw new Error("AnimationNode: this propertyName has registered.");$k._propertyIndexDic[$x]=$k._propertyIDCounter,$k._propertyGetFuncs[$k._propertyIDCounter]=$I,$k._propertySetFuncs[$k._propertyIDCounter]=$z,$k._propertyIDCounter++},$k._getLocalPosition=function($x,$I){return $x?$x.transform.getLocalPosition():$I._transform.localPosition.elements},$k._setLocalPosition=function($x,$I,$z){if($x)$x.transform.setLocalPosition($z);else{var $k=$I._transform,$l=$k.localPosition;$l.elements=$z,$k.localPosition=$l}},$k._getLocalRotation=function($x,$I){return $x?$x.transform.getLocalRotation():$I._transform.localRotation.elements},$k._setLocalRotation=function($x,$I,$z){if($x)$x.transform.setLocalRotation($z);else{var $k=$I._transform,$l=$k.localRotation;$l.elements=$z,$k.localRotation=$l}},$k._getLocalScale=function($x,$I){return $x?$x.transform.getLocalScale():$I._transform.localScale.elements},$k._setLocalScale=function($x,$I,$z){if($x)$x.transform.setLocalScale($z);else{var $k=$I._transform,$l=$k.localScale;$l.elements=$z,$k.localScale=$l}},$k._getLocalRotationEuler=function($x,$I){return $x?$x.transform.getLocalRotationEuler():$I._transform.localRotationEuler.elements},$k._setLocalRotationEuler=function($x,$I,$z){if($x)$x.transform.setLocalRotationEuler($z);else{var $k=$I._transform,$l=$k.localRotationEuler;$l.elements=$z,$k.localRotationEuler=$l}},$k._getMeshRenderSharedMaterialTilingOffset=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $I.meshRender.sharedMaterial.tilingOffset.elements},$k._setMeshRenderSharedMaterialTilingOffset=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.meshRender.material).tilingOffset).elements=$z,$k.tilingOffset=$l)}else($l=($k=$I.meshRender.material).tilingOffset).elements=$z,$k.tilingOffset=$l},$k._getMeshRenderSharedMaterialAlbedo=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $I.meshRender.sharedMaterial.albedoColor.elements},$k._setMeshRenderSharedMaterialAlbedo=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.meshRender.material).albedoColor).elements=$z,$k.albedoColor=$l)}else($l=($k=$I.meshRender.material).albedoColor).elements=$z,$k.albedoColor=$l},$k._getSkinnedMeshRenderSharedMaterialTilingOffset=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $I.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$k._setSkinnedMeshRenderSharedMaterialTilingOffset=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.skinnedMeshRender.material).tilingOffset).elements=$z,$k.tilingOffset=$l)}else($l=($k=$I.skinnedMeshRender.material).tilingOffset).elements=$z,$k.tilingOffset=$l},$k._getSkinnedMeshRenderSharedMaterialAlbedo=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $I.skinnedMeshRender.sharedMaterial.albedoColor.elements},$k._setSkinnedMeshRenderSharedMaterialAlbedo=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.skinnedMeshRender.material).albedoColor).elements=$z,$k.albedoColor=$l)}else($l=($k=$I.skinnedMeshRender.material).albedoColor).elements=$z,$k.albedoColor=$l},$k._getParticleRenderSharedMaterialTintColor=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.particleRender.sharedMaterial.tintColor.elements:null}return $I.particleRender.sharedMaterial.tintColor.elements},$k._setParticleRenderSharedMaterialTintColor=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.particleRender.material).tintColor).elements=$z,$k.tintColor=$l)}else($l=($k=$I.particleRender.material).tintColor).elements=$z,$k.tintColor=$l},$k._getMeshRenderSharedMaterialAlphaColor=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $I.meshRender.sharedMaterial.alphaColor.elements},$k._setMeshRenderSharedMaterialAlphaColor=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.meshRender.material).alphaColor).elements=$z,$k.alphaColor=$l)}else($l=($k=$I.meshRender.material).alphaColor).elements=$z,$k.alphaColor=$l},$k._getMeshRenderSharedMaterialBaseColor=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.baseColor.elements:null}return $I.meshRender.sharedMaterial.baseColor.elements},$k._setMeshRenderSharedMaterialBaseColor=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.meshRender.material).baseColor).elements=$z,$k.baseColor=$l)}else($l=($k=$I.meshRender.material).baseColor).elements=$z,$k.baseColor=$l},$k._getMeshRenderSharedMaterialDissolve=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.dissolve:0}return $I.meshRender.sharedMaterial.dissolve},$k._setMeshRenderSharedMaterialDissolve=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.dissolve=$z[0])}else $I.meshRender.material.dissolve=$z[0]},$k._getMeshRenderSharedMaterialDissolveSpeed=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $I.meshRender.sharedMaterial.dissolveSpeed},$k._setMeshRenderSharedMaterialDissolveSpeed=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.dissolveSpeed=$z[0])}else $I.meshRender.material.dissolveSpeed=$z[0]},$k._getMeshRenderSharedMaterialMMultiplier=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.mMultiplier:0}return $I.meshRender.sharedMaterial.mMultiplier},$k._setMeshRenderSharedMaterialMMultiplier=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.mMultiplier=$z[0])}else $I.meshRender.material.mMultiplier=$z[0]},$k._getMeshRenderSharedMaterialBaseScrollSpeedX=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $I.meshRender.sharedMaterial.baseScrollSpeedX},$k._setMeshRenderSharedMaterialBaseScrollSpeedX=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.baseScrollSpeedX=$z[0])}else $I.meshRender.material.baseScrollSpeedX=$z[0]},$k._getMeshRenderSharedMaterialBaseScrollSpeedY=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $I.meshRender.sharedMaterial.baseScrollSpeedY},$k._setMeshRenderSharedMaterialBaseScrollSpeedY=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.baseScrollSpeedY=$z[0])}else $I.meshRender.material.baseScrollSpeedY=$z[0]},$k._getMeshRenderSharedMaterialSecondScrollSpeedX=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $I.meshRender.sharedMaterial.secondScrollSpeedX},$k._setMeshRenderSharedMaterialSecondScrollSpeedX=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.secondScrollSpeedX=$z[0])}else $I.meshRender.material.secondScrollSpeedX=$z[0]},$k._getMeshRenderSharedMaterialSecondScrollSpeedY=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $I.meshRender.sharedMaterial.secondScrollSpeedY},$k._setMeshRenderSharedMaterialSecondScrollSpeedY=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.secondScrollSpeedY=$z[0])}else $I.meshRender.material.secondScrollSpeedY=$z[0]},$k._getMeshRenderSharedMaterialAlpha=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.alpha:0}return $I.meshRender.sharedMaterial.alpha},$k._setMeshRenderSharedMaterialAlpha=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.alpha=$z[0])}else $I.meshRender.material.alpha=$z[0]},$k._getMeshRenderSharedMaterialIntensity=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.intensity:0}return $I.meshRender.sharedMaterial.intensity},$k._setMeshRenderSharedMaterialIntensity=function($x,$I,$z){if($x){var $k=$x.transform._entity;$k&&($k.owner.meshRender.material.intensity=$z[0])}else $I.meshRender.material.intensity=$z[0]},$k._getMeshRenderSharedMaterialDetailTilingOffset=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $I.meshRender.sharedMaterial.detailTilingOffset.elements},$k._setMeshRenderSharedMaterialDetailTilingOffset=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.meshRender.material).detailTilingOffset).elements=$z,$k.detailTilingOffset=$l)}else($l=($k=$I.meshRender.material).detailTilingOffset).elements=$z,$k.detailTilingOffset=$l},$k._getMeshRenderSharedMaterialDissolveTilingOffset=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $I.meshRender.sharedMaterial.dissolveTilingOffset.elements},$k._setMeshRenderSharedMaterialDissolveTilingOffset=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.meshRender.material).dissolveTilingOffset).elements=$z,$k.dissolveTilingOffset=$l)}else($l=($k=$I.meshRender.material).dissolveTilingOffset).elements=$z,$k.dissolveTilingOffset=$l},$k._getMeshRenderSharedMaterialMaskTilingOffset=function($x,$I){if($x){var $z=$x.transform._entity;return $z?$z.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $I.meshRender.sharedMaterial.maskTilingOffset.elements},$k._setMeshRenderSharedMaterialMaskTilingOffset=function($x,$I,$z){var $k,$l;if($x){var $n=$x.transform._entity;$n&&(($l=($k=$n.owner.meshRender.material).maskTilingOffset).elements=$z,$k.maskTilingOffset=$l)}else($l=($k=$I.meshRender.material).maskTilingOffset).elements=$z,$k.maskTilingOffset=$l},$k._propertyIDCounter=0,$k._propertyIndexDic={},$k._propertySetFuncs=[],$k._propertyGetFuncs=[],$k}(),$J=function(){function $x(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $_($x,"laya.d3.animation.Keyframe"),$x}(),$h=function(){function $x(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $_($x,"laya.d3.animation.KeyframeNode"),$x}(),$d=(function(){function $x(){this._tempVector30=new $aI,this._tempVector31=new $aI,this._tempVector32=new $aI,this._a=new $aI,this._b=new $aI,this._c=new $aI,this._d=new $aI}$_($x,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $I=$x.prototype;$I.Init=function($x,$I,$z,$k){$x.cloneTo(this._d),$I.cloneTo(this._c),$aI.scale($x,2,this._a),$aI.scale($z,2,this._tempVector30),$aI.subtract(this._a,this._tempVector30,this._a),$aI.add(this._a,$I,this._a),$aI.add(this._a,$k,this._a),$aI.scale($z,3,this._b),$aI.scale($x,3,this._tempVector30),$aI.subtract(this._b,this._tempVector30,this._b),$aI.subtract(this._b,$k,this._b),$aI.scale($I,2,this._tempVector30),$aI.subtract(this._b,this._tempVector30,this._b)},$I.Slerp=function($x,$I){$aI.scale(this._a,$x*$x*$x,this._tempVector30),$aI.scale(this._b,$x*$x,this._tempVector31),$aI.scale(this._c,$x,this._tempVector32),$aI.add(this._tempVector30,this._tempVector31,$I),$aI.add($I,this._tempVector32,$I),$aI.add($I,this._d,$I)}}(),function(){function $c($x,$I,$z,$k){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$x,this._h=$I,this._minHeight=$z,this._maxHeight=$k}$_($c,"laya.d3.core.HeightMap");var $x=$c.prototype;$x._inBounds=function($x,$I){return 0<=$x&&$x<this._h&&0<=$I&&$I<this._w},$x.getHeight=function($x,$I){return this._inBounds($x,$I)?this._datas[$x][$I]:NaN},$R(0,$x,"width",function(){return this._w}),$R(0,$x,"height",function(){return this._h}),$R(0,$x,"maxHeight",function(){return this._maxHeight}),$R(0,$x,"minHeight",function(){return this._minHeight}),$c.creatFromMesh=function($x,$I,$z,$k){for(var $l=[],$n=[],$a=$x.getSubMeshCount(),$$=0;$$<$a;$$++){for(var $w=$x.getSubMesh($$),$i=$w._getVertexBuffer(),$F=$i.getData(),$b=[],$T=0;$T<$F.length;$T+=$i.vertexDeclaration.vertexStride/4){var $_=new $aI($F[$T+0],$F[$T+1],$F[$T+2]);$b.push($_)}$l.push($b);var $R=$w._getIndexBuffer();$n.push($R.getData())}var $s=$x.boundingBox,$N=$s.min.x,$D=$s.min.z,$f=$s.max.x,$m=$s.max.z,$y=$s.min.y,$C=$s.max.y,$P=$f-$N,$v=$m-$D,$L=$k.elements[0]=$P/($I-1),$K=$k.elements[1]=$v/($z-1),$E=new $c($I,$z,$y,$C),$O=$c._tempRay,$S=$O.direction.elements;$S[0]=0,$S[1]=-1,$S[2]=0;var $Z=$C+.1;$O.origin.elements[1]=$Z;for(var $U=0;$U<$z;$U++){var $X=$D+$U*$K;$E._datas[$U]=[];for(var $d=0;$d<$I;$d++){var $j=$N+$d*$L,$t=$O.origin.elements;$t[0]=$j,$t[2]=$X;var $Y=$c._getPosition($O,$l,$n);$E._datas[$U][$d]=$Y===Number.MAX_VALUE?NaN:$Z-$Y}}return $E},$c.createFromImage=function($x,$I,$z){for(var $k=$x.width,$l=$x.height,$n=new $c($k,$l,$I,$z),$a=($z-$I)/254,$$=$x.getPixels(),$w=0,$i=0;$i<$l;$i++)for(var $F=$n._datas[$i]=[],$b=0;$b<$k;$b++){var $T=$$[$w++],$_=$$[$w++],$R=$$[$w++],$s=$$[$w++];$F[$b]=255==$T&&255==$_&&255==$R&&255==$s?NaN:($T+$_+$R)/3*$a+$I}return $n},$c._getPosition=function($x,$I,$z){for(var $k=Number.MAX_VALUE,$l=0;$l<$I.length;$l++)for(var $n=$I[$l],$a=$z[$l],$$=0;$$<$a.length;$$+=3){var $w=$n[$a[$$+0]],$i=$n[$a[$$+1]],$F=$n[$a[$$+2]],$b=$RI.rayIntersectsTriangle($x,$w,$i,$F);!isNaN($b)&&$b<$k&&($k=$b)}return $k},$b($c,["_tempRay",function(){return this._tempRay=new $lI(new $aI,new $aI)}])}(),function(){function $l(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$_($l,"laya.d3.core.Layer");var $x=$l.prototype;return $x._binarySearchIndex=function(){for(var $x=0,$I=$l._collsionTestList.length-1,$z=0;$x<=$I;){$z=Math.floor(($x+$I)/2);var $k=$l._collsionTestList[$z];if($k==this._number)return $z;$k>this._number?$I=$z-1:$x=$z+1}return $x},$x._addCollider=function($x){0===this._colliders.length&&$l._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$x._isRigidbody?(this._colliders.unshift($x),this._nonRigidbodyOffset++):this._colliders.push($x)},$x._removeCollider=function($x){var $I=this._colliders.indexOf($x);$I<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($I,1),0===this._colliders.length&&$l._collsionTestList.splice($l._collsionTestList.indexOf(this._number),1)},$R(0,$x,"number",function(){return this._number}),$R(0,$x,"visible",function(){return this._visible},function($x){this._visible=$x,$l._visibleLayers=$x?$l._visibleLayers|this.mask:$l._visibleLayers&~this.mask}),$R(0,$x,"mask",function(){return this._mask}),$R(1,$l,"visibleLayers",function(){return $l._visibleLayers},function($x){$l._visibleLayers=$x;for(var $I=0,$z=$l._layerList.length;$I<$z;$I++){var $k=$l._layerList[$I];$k._visible=0!=($k._mask&$l._visibleLayers)}}),$l.__init__=function(){$l._layerList.length=31;for(var $x=0;$x<31;$x++){var $I=new $l;$l._layerList[$x]=$I,0===$x?($I.name="Default Layer",$I.visible=!0):($I.name="Layer-"+$x,$I.visible=!1),$I._number=$x,$I._mask=Math.pow(2,$x)}$l.currentCreationLayer=$l._layerList[0]},$l.getLayerByNumber=function($x){if($x<0||30<$x)throw new Error("无法返回指定Layer，该number超出范围！");return $l._layerList[$x]},$l.getLayerByName=function($x){for(var $I=0;$I<31;$I++)if($l._layerList[$I].name===$x)return $l._layerList[$I];throw new Error("无法返回指定Layer,该name不存在")},$l.isVisible=function($x){return 0!=($x&$l._currentCameraCullingMask&$l._visibleLayers)},$l._layerList=[],$l._visibleLayers=2147483647,$l._collsionTestList=[],$l._currentCameraCullingMask=2147483647,$l.maxCount=31,$l.currentCreationLayer=null,$l}()),$j=(function(){function $x($x,$I,$z){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$x,this._minCount=$I,this._maxCount=$z}$_($x,"laya.d3.core.particleShuriKen.module.Burst");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($x){var $I=$x;$I._time=this._time,$I._minCount=this._minCount,$I._maxCount=this._maxCount},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"time",function(){return this._time}),$R(0,$I,"minCount",function(){return this._minCount}),$R(0,$I,"maxCount",function(){return this._maxCount})}(),function(){function $x($x){this._color=null,this.enbale=!1,this._color=$x}$_($x,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $I=$x.prototype;$I.cloneTo=function($x){var $I=$x;this._color.cloneTo($I._color),$I.enbale=this.enbale},$I.clone=function(){var $x;switch(this._color.type){case 0:$x=$Y.createByConstant(this._color.constant.clone());break;case 1:$x=$Y.createByGradient(this._color.gradient.clone());break;case 2:$x=$Y.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$x=$Y.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $I=new this.constructor($x);return $I.enbale=this.enbale,$I},$R(0,$I,"color",function(){return this._color})}(),function(){function $x(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$_($x,"laya.d3.core.particleShuriKen.module.Emission");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$I._destroy=function(){this._bursts=null,this._destroyed=!0},$I.getBurstsCount=function(){return this._bursts.length},$I.getBurstByIndex=function($x){return this._bursts[$x]},$I.addBurst=function($x){var $I=this._bursts.length;if(0<$I)for(var $z=0;$z<$I;$z++)this._bursts[$z].time>$x.time&&this._bursts.splice($z,0,$x);this._bursts.push($x)},$I.removeBurst=function($x){var $I=this._bursts.indexOf($x);-1!==$I&&this._bursts.splice($I,1)},$I.removeBurstByIndex=function($x){this._bursts.splice($x,1)},$I.clearBurst=function(){this._bursts.length=0},$I.cloneTo=function($x){var $I=$x,$z=$I._bursts;$z.length=this._bursts.length;for(var $k=0,$l=this._bursts.length;$k<$l;$k++){var $n=$z[$k];$n?this._bursts[$k].cloneTo($n):$z[$k]=this._bursts[$k].clone()}$I._emissionRate=this._emissionRate,$I.enbale=this.enbale},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"destroyed",function(){return this._destroyed}),$R(0,$I,"emissionRate",function(){return this._emissionRate},function($x){if($x<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$x})}(),function(){function $k(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$_($k,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $x=$k.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.cloneTo=function($x){var $I=$x;$I._type=this._type,$I._constant=this._constant,this._overTime.cloneTo($I._overTime),$I._constantMin=this._constantMin,$I._constantMax=this._constantMax,this._overTimeMin.cloneTo($I._overTimeMin),this._overTimeMax.cloneTo($I._overTimeMax)},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$x,"frameOverTimeData",function(){return this._overTime}),$R(0,$x,"constant",function(){return this._constant}),$R(0,$x,"type",function(){return this._type}),$R(0,$x,"frameOverTimeDataMin",function(){return this._overTimeMin}),$R(0,$x,"constantMin",function(){return this._constantMin}),$R(0,$x,"frameOverTimeDataMax",function(){return this._overTimeMax}),$R(0,$x,"constantMax",function(){return this._constantMax}),$k.createByConstant=function($x){var $I=new $k;return $I._type=0,$I._constant=$x,$I},$k.createByOverTime=function($x){var $I=new $k;return $I._type=1,$I._overTime=$x,$I},$k.createByRandomTwoConstant=function($x,$I){var $z=new $k;return $z._type=2,$z._constantMin=$x,$z._constantMax=$I,$z},$k.createByRandomTwoOverTime=function($x,$I){var $z=new $k;return $z._type=3,$z._overTimeMin=$x,$z._overTimeMax=$I,$z},$k}()),$t=function(){function $i(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$_($i,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $x=$i.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.cloneTo=function($x){var $I=$x;$I._type=this._type,$I._separateAxes=this._separateAxes,$I._constant=this._constant,this._constantSeparate.cloneTo($I._constantSeparate),this._gradient.cloneTo($I._gradient),this._gradientX.cloneTo($I._gradientX),this._gradientY.cloneTo($I._gradientY),this._gradientZ.cloneTo($I._gradientZ),$I._constantMin=this._constantMin,$I._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($I._constantMinSeparate),this._constantMaxSeparate.cloneTo($I._constantMaxSeparate),this._gradientMin.cloneTo($I._gradientMin),this._gradientMax.cloneTo($I._gradientMax),this._gradientXMin.cloneTo($I._gradientXMin),this._gradientXMax.cloneTo($I._gradientXMax),this._gradientYMin.cloneTo($I._gradientYMin),this._gradientYMax.cloneTo($I._gradientYMax),this._gradientZMin.cloneTo($I._gradientZMin),this._gradientZMax.cloneTo($I._gradientZMax)},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$x,"gradientZ",function(){return this._gradientZ}),$R(0,$x,"constant",function(){return this._constant}),$R(0,$x,"gradient",function(){return this._gradient}),$R(0,$x,"separateAxes",function(){return this._separateAxes}),$R(0,$x,"type",function(){return this._type}),$R(0,$x,"constantSeparate",function(){return this._constantSeparate}),$R(0,$x,"gradientX",function(){return this._gradientX}),$R(0,$x,"gradientY",function(){return this._gradientY}),$R(0,$x,"gradientW",function(){return this._gradientW}),$R(0,$x,"gradientMin",function(){return this._gradientMin}),$R(0,$x,"constantMin",function(){return this._constantMin}),$R(0,$x,"gradientMax",function(){return this._gradientMax}),$R(0,$x,"constantMax",function(){return this._constantMax}),$R(0,$x,"gradientWMin",function(){return this._gradientWMin}),$R(0,$x,"constantMinSeparate",function(){return this._constantMinSeparate}),$R(0,$x,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$R(0,$x,"gradientXMin",function(){return this._gradientXMin}),$R(0,$x,"gradientXMax",function(){return this._gradientXMax}),$R(0,$x,"gradientWMax",function(){return this._gradientWMax}),$R(0,$x,"gradientYMin",function(){return this._gradientYMin}),$R(0,$x,"gradientYMax",function(){return this._gradientYMax}),$R(0,$x,"gradientZMin",function(){return this._gradientZMin}),$R(0,$x,"gradientZMax",function(){return this._gradientZMax}),$i.createByConstant=function($x){var $I=new $i;return $I._type=0,$I._separateAxes=!1,$I._constant=$x,$I},$i.createByConstantSeparate=function($x){var $I=new $i;return $I._type=0,$I._separateAxes=!0,$I._constantSeparate=$x,$I},$i.createByGradient=function($x){var $I=new $i;return $I._type=1,$I._separateAxes=!1,$I._gradient=$x,$I},$i.createByGradientSeparate=function($x,$I,$z,$k){var $l=new $i;return $l._type=1,$l._separateAxes=!0,$l._gradientX=$x,$l._gradientY=$I,$l._gradientZ=$z,$l._gradientW=$k,$l},$i.createByRandomTwoConstant=function($x,$I){var $z=new $i;return $z._type=2,$z._separateAxes=!1,$z._constantMin=$x,$z._constantMax=$I,$z},$i.createByRandomTwoConstantSeparate=function($x,$I){var $z=new $i;return $z._type=2,$z._separateAxes=!0,$z._constantMinSeparate=$x,$z._constantMaxSeparate=$I,$z},$i.createByRandomTwoGradient=function($x,$I){var $z=new $i;return $z._type=3,$z._separateAxes=!1,$z._gradientMin=$x,$z._gradientMax=$I,$z},$i.createByRandomTwoGradientSeparate=function($x,$I,$z,$k,$l,$n,$a,$$){var $w=new $i;return $w._type=3,$w._separateAxes=!0,$w._gradientXMin=$x,$w._gradientXMax=$I,$w._gradientYMin=$z,$w._gradientYMax=$k,$w._gradientZMin=$l,$w._gradientZMax=$n,$w._gradientWMin=$a,$w._gradientWMax=$$,$w},$i}(),$Y=function(){function $k(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$_($k,"laya.d3.core.particleShuriKen.module.GradientColor");var $x=$k.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.cloneTo=function($x){var $I=$x;$I._type=this._type,this._constant.cloneTo($I._constant),this._constantMin.cloneTo($I._constantMin),this._constantMax.cloneTo($I._constantMax),this._gradient.cloneTo($I._gradient),this._gradientMin.cloneTo($I._gradientMin),this._gradientMax.cloneTo($I._gradientMax)},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$x,"gradient",function(){return this._gradient}),$R(0,$x,"constant",function(){return this._constant}),$R(0,$x,"type",function(){return this._type}),$R(0,$x,"gradientMin",function(){return this._gradientMin}),$R(0,$x,"constantMin",function(){return this._constantMin}),$R(0,$x,"gradientMax",function(){return this._gradientMax}),$R(0,$x,"constantMax",function(){return this._constantMax}),$k.createByConstant=function($x){var $I=new $k;return $I._type=0,$I._constant=$x,$I},$k.createByGradient=function($x){var $I=new $k;return $I._type=1,$I._gradient=$x,$I},$k.createByRandomTwoConstant=function($x,$I){var $z=new $k;return $z._type=2,$z._constantMin=$x,$z._constantMax=$I,$z},$k.createByRandomTwoGradient=function($x,$I){var $z=new $k;return $z._type=3,$z._gradientMin=$x,$z._gradientMax=$I,$z},$k}(),$c=(function(){function $x(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$_($x,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.addAlpha=function($x,$I){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$x&&($x=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$x,this._alphaElements[this._alphaCurrentLength++]=$I):DEBUG},$I.addRGB=function($x,$I){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$x&&($x=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$x,this._rgbElements[this._rgbCurrentLength++]=$I.x,this._rgbElements[this._rgbCurrentLength++]=$I.y,this._rgbElements[this._rgbCurrentLength++]=$I.z):DEBUG},$I.cloneTo=function($x){var $I=$x,$z=0,$k=0;$I._alphaCurrentLength=this._alphaCurrentLength;var $l=$I._alphaElements;for($l.length=this._alphaElements.length,$z=0,$k=this._alphaElements.length;$z<$k;$z++)$l[$z]=this._alphaElements[$z];$I._rgbCurrentLength=this._rgbCurrentLength;var $n=$I._rgbElements;for($n.length=this._rgbElements.length,$z=0,$k=this._rgbElements.length;$z<$k;$z++)$n[$z]=this._rgbElements[$z]},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$R(0,$I,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $x(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$_($x,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.add=function($x,$I){this._currentLength<8?(6===this._currentLength&&1!==$x&&($x=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$x,this._elements[this._currentLength++]=$I):console.log("Warning:data count must lessEqual than 4")},$I.cloneTo=function($x){var $I=$x;$I._currentLength=this._currentLength;var $z=$I._elements;$z.length=this._elements.length;for(var $k=0,$l=this._elements.length;$k<$l;$k++)$z[$k]=this._elements[$k]},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"gradientCount",function(){return this._currentLength/2})}(),function(){function $x(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$_($x,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.add=function($x,$I){this._currentLength<8?(6===this._currentLength&&1!==$x&&($x=1,DEBUG),this._elements[this._currentLength++]=$x,this._elements[this._currentLength++]=$I):DEBUG},$I.getKeyByIndex=function($x){return this._elements[2*$x]},$I.getValueByIndex=function($x){return this._elements[2*$x+1]},$I.getAverageValue=function(){for(var $x=0,$I=this._currentLength-2;$x<$I;$x+=2){this._elements[$x+1];this._elements[$x+3],this._elements[$x+2]-this._elements[$x]}return 0},$I.cloneTo=function($x){var $I=$x;$I._currentLength=this._currentLength;var $z=$I._elements;$z.length=this._elements.length;for(var $k=0,$l=this._elements.length;$k<$l;$k++)$z[$k]=this._elements[$k]},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"gradientCount",function(){return this._currentLength/2})}(),function(){function $x(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$_($x,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.add=function($x,$I){this._currentLength<8?(6===this._currentLength&&1!==$x&&($x=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$x,this._elements[this._currentLength++]=$I.x,this._elements[this._currentLength++]=$I.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$I.cloneTo=function($x){var $I=$x;$I._currentLength=this._currentLength;var $z=$I._elements;$z.length=this._elements.length;for(var $k=0,$l=this._elements.length;$k<$l;$k++)$z[$k]=this._elements[$k]},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"gradientCount",function(){return this._currentLength/3})}(),function(){function $$(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$_($$,"laya.d3.core.particleShuriKen.module.GradientSize");var $x=$$.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.getMaxSizeInGradient=function(){var $x=0,$I=0,$z=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($x=0,$I=this._gradientX.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientX.getValueByIndex($x));for($x=0,$I=this._gradientY.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientY.getValueByIndex($x))}else for($x=0,$I=this._gradient.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradient.getValueByIndex($x));break;case 1:$z=this._separateAxes?($z=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$z=Math.max($z,this._constantMinSeparate.y),Math.max($z,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($x=0,$I=this._gradientXMin.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientXMin.getValueByIndex($x));for($x=0,$I=this._gradientXMax.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientXMax.getValueByIndex($x));for($x=0,$I=this._gradientYMin.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientYMin.getValueByIndex($x));for($x=0,$I=this._gradientZMax.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientZMax.getValueByIndex($x))}else{for($x=0,$I=this._gradientMin.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientMin.getValueByIndex($x));for($x=0,$I=this._gradientMax.gradientCount;$x<$I;$x++)$z=Math.max($z,this._gradientMax.getValueByIndex($x))}}return $z},$x.cloneTo=function($x){var $I=$x;$I._type=this._type,$I._separateAxes=this._separateAxes,this._gradient.cloneTo($I._gradient),this._gradientX.cloneTo($I._gradientX),this._gradientY.cloneTo($I._gradientY),this._gradientZ.cloneTo($I._gradientZ),$I._constantMin=this._constantMin,$I._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($I._constantMinSeparate),this._constantMaxSeparate.cloneTo($I._constantMaxSeparate),this._gradientMin.cloneTo($I._gradientMin),this._gradientMax.cloneTo($I._gradientMax),this._gradientXMin.cloneTo($I._gradientXMin),this._gradientXMax.cloneTo($I._gradientXMax),this._gradientYMin.cloneTo($I._gradientYMin),this._gradientYMax.cloneTo($I._gradientYMax),this._gradientZMin.cloneTo($I._gradientZMin),this._gradientZMax.cloneTo($I._gradientZMax)},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$x,"gradientZ",function(){return this._gradientZ}),$R(0,$x,"gradient",function(){return this._gradient}),$R(0,$x,"separateAxes",function(){return this._separateAxes}),$R(0,$x,"type",function(){return this._type}),$R(0,$x,"gradientMin",function(){return this._gradientMin}),$R(0,$x,"constantMin",function(){return this._constantMin}),$R(0,$x,"gradientX",function(){return this._gradientX}),$R(0,$x,"gradientY",function(){return this._gradientY}),$R(0,$x,"gradientMax",function(){return this._gradientMax}),$R(0,$x,"constantMax",function(){return this._constantMax}),$R(0,$x,"constantMinSeparate",function(){return this._constantMinSeparate}),$R(0,$x,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$R(0,$x,"gradientXMin",function(){return this._gradientXMin}),$R(0,$x,"gradientXMax",function(){return this._gradientXMax}),$R(0,$x,"gradientYMin",function(){return this._gradientYMin}),$R(0,$x,"gradientYMax",function(){return this._gradientYMax}),$R(0,$x,"gradientZMin",function(){return this._gradientZMin}),$R(0,$x,"gradientZMax",function(){return this._gradientZMax}),$$.createByGradient=function($x){var $I=new $$;return $I._type=0,$I._separateAxes=!1,$I._gradient=$x,$I},$$.createByGradientSeparate=function($x,$I,$z){var $k=new $$;return $k._type=0,$k._separateAxes=!0,$k._gradientX=$x,$k._gradientY=$I,$k._gradientZ=$z,$k},$$.createByRandomTwoConstant=function($x,$I){var $z=new $$;return $z._type=1,$z._separateAxes=!1,$z._constantMin=$x,$z._constantMax=$I,$z},$$.createByRandomTwoConstantSeparate=function($x,$I){var $z=new $$;return $z._type=1,$z._separateAxes=!0,$z._constantMinSeparate=$x,$z._constantMaxSeparate=$I,$z},$$.createByRandomTwoGradient=function($x,$I){var $z=new $$;return $z._type=2,$z._separateAxes=!1,$z._gradientMin=$x,$z._gradientMax=$I,$z},$$.createByRandomTwoGradientSeparate=function($x,$I,$z,$k,$l,$n){var $a=new $$;return $a._type=2,$a._separateAxes=!0,$a._gradientXMin=$x,$a._gradientXMax=$I,$a._gradientYMin=$z,$a._gradientYMax=$k,$a._gradientZMin=$l,$a._gradientZMax=$n,$a},$$}()),$V=function(){function $$(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$_($$,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $x=$$.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.cloneTo=function($x){var $I=$x;$I._type=this._type,this._constant.cloneTo($I._constant),this._gradientX.cloneTo($I._gradientX),this._gradientY.cloneTo($I._gradientY),this._gradientZ.cloneTo($I._gradientZ),this._constantMin.cloneTo($I._constantMin),this._constantMax.cloneTo($I._constantMax),this._gradientXMin.cloneTo($I._gradientXMin),this._gradientXMax.cloneTo($I._gradientXMax),this._gradientYMin.cloneTo($I._gradientYMin),this._gradientYMax.cloneTo($I._gradientYMax),this._gradientZMin.cloneTo($I._gradientZMin),this._gradientZMax.cloneTo($I._gradientZMax)},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$x,"gradientZ",function(){return this._gradientZ}),$R(0,$x,"constant",function(){return this._constant}),$R(0,$x,"type",function(){return this._type}),$R(0,$x,"gradientXMax",function(){return this._gradientXMax}),$R(0,$x,"constantMin",function(){return this._constantMin}),$R(0,$x,"gradientX",function(){return this._gradientX}),$R(0,$x,"gradientY",function(){return this._gradientY}),$R(0,$x,"gradientXMin",function(){return this._gradientXMin}),$R(0,$x,"constantMax",function(){return this._constantMax}),$R(0,$x,"gradientYMin",function(){return this._gradientYMin}),$R(0,$x,"gradientYMax",function(){return this._gradientYMax}),$R(0,$x,"gradientZMin",function(){return this._gradientZMin}),$R(0,$x,"gradientZMax",function(){return this._gradientZMax}),$$.createByConstant=function($x){var $I=new $$;return $I._type=0,$I._constant=$x,$I},$$.createByGradient=function($x,$I,$z){var $k=new $$;return $k._type=1,$k._gradientX=$x,$k._gradientY=$I,$k._gradientZ=$z,$k},$$.createByRandomTwoConstant=function($x,$I){var $z=new $$;return $z._type=2,$z._constantMin=$x,$z._constantMax=$I,$z},$$.createByRandomTwoGradient=function($x,$I,$z,$k,$l,$n){var $a=new $$;return $a._type=3,$a._gradientXMin=$x,$a._gradientXMax=$I,$a._gradientYMin=$z,$a._gradientYMax=$k,$a._gradientZMin=$l,$a._gradientZMax=$n,$a},$$}(),$W=(function(){function $x($x){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$x}$_($x,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($x){var $I=$x;this._angularVelocity.cloneTo($I._angularVelocity),$I.enbale=this.enbale},$I.clone=function(){var $x;switch(this._angularVelocity.type){case 0:$x=this._angularVelocity.separateAxes?$t.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$t.createByConstant(this._angularVelocity.constant);break;case 1:$x=this._angularVelocity.separateAxes?$t.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$t.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$x=this._angularVelocity.separateAxes?$t.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$t.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$x=this._angularVelocity.separateAxes?$t.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$t.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $I=new this.constructor($x);return $I.enbale=this.enbale,$I},$R(0,$I,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $x(){this.enable=!1,this.randomDirection=!1}$_($x,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $I=$x.prototype;return $C.imps($I,{"laya.d3.core.IClone":!0}),$I._getShapeBoundBox=function($x){throw new Error("BaseShape: must override it.")},$I._getSpeedBoundBox=function($x){throw new Error("BaseShape: must override it.")},$I.generatePositionAndDirection=function($x,$I,$z,$k){throw new Error("BaseShape: must override it.")},$I._calculateProceduralBounds=function($x,$I,$z){this._getShapeBoundBox($x);var $k=$x.min,$l=$x.max;$aI.multiply($k,$I,$k),$aI.multiply($l,$I,$l);var $n=new $rx(new $aI,new $aI);this.randomDirection?($n.min=new $aI(-1,-1,-1),$n.max=new $aI(1,1,1)):this._getSpeedBoundBox($n);var $a=new $rx(new $aI,new $aI),$$=$a.min,$w=$a.max;$aI.scale($n.min,$z.y,$$),$aI.scale($n.max,$z.y,$w),$aI.add($x.min,$$,$$),$aI.add($x.max,$w,$w),$aI.min($x.min,$$,$x.min),$aI.max($x.max,$$,$x.max);var $i=new $rx(new $aI,new $aI),$F=$i.min,$b=$i.max;$aI.scale($n.min,$z.x,$F),$aI.scale($n.max,$z.x,$b),$aI.min($i.min,$b,$$),$aI.max($i.min,$b,$w),$aI.min($x.min,$$,$x.min),$aI.max($x.max,$$,$x.max)},$I.cloneTo=function($x){$x.enable=this.enable},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$x}()),$B=function(){function $n(){}return $_($n,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$n._randomPointUnitArcCircle=function($x,$I,$z){var $k=$I.elements,$l=NaN;$l=$z?$z.getFloat()*$x:Math.random()*$x,$k[0]=Math.cos($l),$k[1]=Math.sin($l)},$n._randomPointInsideUnitArcCircle=function($x,$I,$z){var $k=$I.elements;$n._randomPointUnitArcCircle($x,$I,$z);var $l=NaN;$l=$z?Math.pow($z.getFloat(),.5):Math.pow(Math.random(),.5),$k[0]=$k[0]*$l,$k[1]=$k[1]*$l},$n._randomPointUnitCircle=function($x,$I){var $z=$x.elements,$k=NaN;$k=$I?$I.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$z[0]=Math.cos($k),$z[1]=Math.sin($k)},$n._randomPointInsideUnitCircle=function($x,$I){var $z=$x.elements;$n._randomPointUnitCircle($x);var $k=NaN;$k=$I?Math.pow($I.getFloat(),.5):Math.pow(Math.random(),.5),$z[0]=$z[0]*$k,$z[1]=$z[1]*$k},$n._randomPointUnitSphere=function($x,$I){var $z=$x.elements,$k=NaN,$l=NaN;$l=$I?($k=$z[2]=2*$I.getFloat()-1,$I.getFloat()*Math.PI*2):($k=$z[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $n=Math.sqrt(1-$k*$k);$z[0]=$n*Math.cos($l),$z[1]=$n*Math.sin($l)},$n._randomPointInsideUnitSphere=function($x,$I){var $z=$x.elements;$n._randomPointUnitSphere($x);var $k=NaN;$k=$I?Math.pow($I.getFloat(),1/3):Math.pow(Math.random(),1/3),$z[0]=$z[0]*$k,$z[1]=$z[1]*$k,$z[2]=$z[2]*$k},$n._randomPointInsideHalfUnitBox=function($x,$I){var $z=$x.elements;$I?($z[0]=$I.getFloat()-.5,$z[1]=$I.getFloat()-.5,$z[2]=$I.getFloat()-.5):($z[0]=Math.random()-.5,$z[1]=Math.random()-.5,$z[2]=Math.random()-.5)},$n}(),$e=(function(){function $x($x){this._size=null,this.enbale=!1,this._size=$x}$_($x,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($x){var $I=$x;this._size.cloneTo($I._size),$I.enbale=this.enbale},$I.clone=function(){var $x;switch(this._size.type){case 0:$x=this._size.separateAxes?$c.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$c.createByGradient(this._size.gradient.clone());break;case 1:$x=this._size.separateAxes?$c.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$c.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$x=this._size.separateAxes?$c.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$c.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $I=new this.constructor($x);return $I.enbale=this.enbale,$I},$R(0,$I,"size",function(){return this._size})}(),function(){function $k(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$_($k,"laya.d3.core.particleShuriKen.module.StartFrame");var $x=$k.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.cloneTo=function($x){var $I=$x;$I._type=this._type,$I._constant=this._constant,$I._constantMin=this._constantMin,$I._constantMax=this._constantMax},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$x,"constant",function(){return this._constant}),$R(0,$x,"type",function(){return this._type}),$R(0,$x,"constantMin",function(){return this._constantMin}),$R(0,$x,"constantMax",function(){return this._constantMax}),$k.createByConstant=function($x){var $I=new $k;return $I._type=0,$I._constant=$x,$I},$k.createByRandomTwoConstant=function($x,$I){var $z=new $k;return $z._type=1,$z._constantMin=$x,$z._constantMax=$I,$z},$k}()),$A=(function(){function $x($x,$I){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $nI(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$x,this._startFrame=$I}$_($x,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($x){var $I=$x;this.tiles.cloneTo($I.tiles),$I.type=this.type,$I.randomRow=this.randomRow,this._frame.cloneTo($I._frame),this._startFrame.cloneTo($I._startFrame),$I.cycles=this.cycles,$I.enableUVChannels=this.enableUVChannels,$I.enable=this.enable},$I.clone=function(){var $x,$I;switch(this._frame.type){case 0:$x=$j.createByConstant(this._frame.constant);break;case 1:$x=$j.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$x=$j.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$x=$j.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$I=$e.createByConstant(this._startFrame.constant);break;case 1:$I=$e.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $z=new this.constructor($x,$I);return this.tiles.cloneTo($z.tiles),$z.type=this.type,$z.randomRow=this.randomRow,$z.cycles=this.cycles,$z.enableUVChannels=this.enableUVChannels,$z.enable=this.enable,$z},$R(0,$I,"frame",function(){return this._frame}),$R(0,$I,"startFrame",function(){return this._startFrame})}(),function(){function $x($x){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$x}$_($x,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $I=$x.prototype;$C.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($x){var $I=$x;this._velocity.cloneTo($I._velocity),$I.enbale=this.enbale,$I.space=this.space},$I.clone=function(){var $x;switch(this._velocity.type){case 0:$x=$V.createByConstant(this._velocity.constant.clone());break;case 1:$x=$V.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$x=$V.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$x=$V.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $I=new this.constructor($x);return $I.enbale=this.enbale,$I.space=this.space,$I},$R(0,$I,"velocity",function(){return this._velocity})}(),function(){function $x(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $TI,this._vb=$WI.create($x._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$VI.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$YI.nameKey.getID("LINE"),this._shaderCompile=$LI._preCompileShader[this._sharderNameID]}$_($x,"laya.d3.core.PhasorSpriter3D");var $I=$x.prototype;return $I.line=function($x,$I,$z,$k){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($x.x,$x.y,$x.z,$I.x,$I.y,$I.z,$I.w),this.addVertex($z.x,$z.y,$z.z,$k.x,$k.y,$k.z,$k.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$I.circle=function($x,$I,$z,$k,$l,$n){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$I,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$I,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$x,Math.cos(this._tempNumver0)*$x,0,$z,$k,$l,$n),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$I.plane=function($x,$I,$z,$k,$l,$n,$a,$$,$w){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$k/2,this._tempNumver1=$l/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($x-this._tempNumver0,$I+this._tempNumver1,$z,$n,$a,$$,$w),this.addVertex($x+this._tempNumver0,$I+this._tempNumver1,$z,$n,$a,$$,$w),this.addVertex($x-this._tempNumver0,$I-this._tempNumver1,$z,$n,$a,$$,$w),this.addVertex($x+this._tempNumver0,$I-this._tempNumver1,$z,$n,$a,$$,$w),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$I.box=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$k/2,this._tempNumver1=$l/2,this._tempNumver2=$n/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($x-this._tempNumver0,$I+this._tempNumver1,$z+this._tempNumver2,$a,$$,$w,$i),this.addVertex($x+this._tempNumver0,$I+this._tempNumver1,$z+this._tempNumver2,$a,$$,$w,$i),this.addVertex($x-this._tempNumver0,$I-this._tempNumver1,$z+this._tempNumver2,$a,$$,$w,$i),this.addVertex($x+this._tempNumver0,$I-this._tempNumver1,$z+this._tempNumver2,$a,$$,$w,$i),this.addVertex($x+this._tempNumver0,$I+this._tempNumver1,$z-this._tempNumver2,$a,$$,$w,$i),this.addVertex($x-this._tempNumver0,$I+this._tempNumver1,$z-this._tempNumver2,$a,$$,$w,$i),this.addVertex($x+this._tempNumver0,$I-this._tempNumver1,$z-this._tempNumver2,$a,$$,$w,$i),this.addVertex($x-this._tempNumver0,$I-this._tempNumver1,$z-this._tempNumver2,$a,$$,$w,$i),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$I.cone=function($x,$I,$z,$k,$l,$n,$a){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$z+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$z>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$z,this.addVertexIndex(0,$I,0,$k,$l,$n,$a,this._tempUint0),this.addVertexIndex(0,0,0,$k,$l,$n,$a,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$z;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($x*this._tempNumver2,0,$x*this._tempNumver3,$k,$l,$n,$a,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$z-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($x*this._tempNumver2,0,$x*this._tempNumver3,$k,$l,$n,$a,this._tempUint0+(this._tempInt0+$z)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$z-1?this.addIndexes(this._tempUint1+$z+2):this.addIndexes(this._tempUint1+this._tempInt0+$z+1),this.addIndexes(this._tempUint1+this._tempInt0+$z),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$I.boundingBoxLine=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($x,$l,$n,$a,$$,$w,$i),this.addVertex($k,$l,$n,$a,$$,$w,$i),this.addVertex($x,$I,$n,$a,$$,$w,$i),this.addVertex($k,$I,$n,$a,$$,$w,$i),this.addVertex($k,$l,$z,$a,$$,$w,$i),this.addVertex($x,$l,$z,$a,$$,$w,$i),this.addVertex($k,$I,$z,$a,$$,$w,$i),this.addVertex($x,$I,$z,$a,$$,$w,$i),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$I.addVertex=function($x,$I,$z,$k,$l,$n,$a){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$x,this._vbData[this._posInVBData+1]=$I,this._vbData[this._posInVBData+2]=$z,this._vbData[this._posInVBData+3]=$k,this._vbData[this._posInVBData+4]=$l,this._vbData[this._posInVBData+5]=$n,this._vbData[this._posInVBData+6]=$a,this._posInVBData+=this._floatSizePerVer,this},$I.addVertexIndex=function($x,$I,$z,$k,$l,$n,$a,$$){return this._hasBegun||this.addVertexIndexException(),this._vbData[$$]=$x,this._vbData[$$+1]=$I,this._vbData[$$+2]=$z,this._vbData[$$+3]=$k,this._vbData[$$+4]=$l,this._vbData[$$+5]=$n,this._vbData[$$+6]=$a,($$+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$$),this},$I.addIndexes=function($x){var $I=arguments;this._hasBegun||this.addVertexIndexException();for(var $z=0;$z<$I.length;$z++)this._ibData[this._posInIBData]=$I[$z],this._posInIBData++;return this},$I.begin=function($x,$I){return this._hasBegun&&this.beginException0(),1!==$x&&4!==$x&&this.beginException1(),this._primitiveType=$x,this._camera=$I,this._hasBegun=!0,this},$I.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$I.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($x._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$L.drawCall++,$Z.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$I.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$I.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$I.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$I.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$I.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$I.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(28,[new $ax(0,"vector3",0),new $ax(12,"vector4",1)])}]),$x}()),$H=function(){function $x(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$x._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $TI}$_($x,"laya.d3.core.render.RenderElement");var $I=$x.prototype;return $I.getDynamicBatchBakedVertexs=function($x){for(var $I=this._renderObj._getVertexBuffer($x),$z=$I.getData().slice(),$k=$I.vertexDeclaration,$l=$k.getVertexElementByUsage(0).offset/4,$n=$k.getVertexElementByUsage(3).offset/4,$a=this._sprite3D.transform,$$=$a.worldMatrix,$w=$a.rotation,$i=$k.vertexStride/4,$F=0,$b=$z.length;$F<$b;$F+=$i){var $T=$F+$l,$_=$F+$n;$NI.transformVector3ArrayToVector3ArrayCoordinate($z,$T,$$,$z,$T),$NI.transformVector3ArrayByQuat($z,$_,$w,$z,$_)}return $z},$I.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$I._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$R(0,$I,"id",function(){return this._id}),$R(0,$I,"renderObj",function(){return this._renderObj},function($x){this._renderObj!==$x&&(this._renderObj=$x)}),$x._uniqueIDCounter=0,$x}(),$p=function(){function $I($x){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$I._uniqueIDCounter,this._needSort=!1,this._scene=$x,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$_($I,"laya.d3.core.render.RenderQueue");var $x=$I.prototype;return $x._sortOpaqueFunc=function($x,$I){if($x._render&&$I._render){var $z=$x._material.renderQueue-$I._material.renderQueue;return 0==$z?$x._material.constructor&&$I._material.constructor&&$x._material.constructor.name&&$I._material.constructor.name&&$x._material.constructor.name==$x._material.constructor.name&&$x._sprite3D&&$I._sprite3D&&$x._sprite3D.name&&$I._sprite3D.name&&$x._sprite3D.name===$I._sprite3D.name?0:$x._render._distanceForSort-$I._render._distanceForSort:$z}return 0},$x._sortAlphaFunc=function($x,$I){if($x._render&&$I._render){var $z=$x._material.renderQueue-$I._material.renderQueue;return 0==$z?$x._material.constructor&&$I._material.constructor&&$x._material.constructor.name&&$I._material.constructor.name&&$x._material.constructor.name==$x._material.constructor.name&&$x._sprite3D&&$I._sprite3D&&$x._sprite3D.name&&$I._sprite3D.name&&$x._sprite3D.name===$I._sprite3D.name?0:$I._render._distanceForSort-$x._render._distanceForSort:$z}return 0},$x._begainRenderElement=function($x,$I,$z){return!!$I._beforeRender($x)},$x._sortAlpha=function($x){$I._cameraPosition=$x,this._finalElements.sort(this._sortAlphaFunc)},$x._sortOpaque=function($x){$I._cameraPosition=$x,this._finalElements.sort(this._sortOpaqueFunc)},$x._preRender=function($x){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$x._render=function($x,$I){for(var $z,$k,$l,$n,$a,$$,$w=$L.loopCount,$i=this._scene,$F=$x.camera,$b=($F.id,!1),$T=0,$_=this._finalElements.length;$T<$_;$T++){var $R,$s,$N,$D=this._finalElements[$T];if(null!=$D._onPreRenderFunction&&$D._onPreRenderFunction.call($D._sprite3D,$x),0===$D._type){if($x.owner=$N=$D._sprite3D,$x.renderElement=$D,$N._preRenderUpdateComponents($x),$R=$D.renderObj,$s=$D._material,this._begainRenderElement($x,$R,$s)){if($z=$R._getVertexBuffers(),!($l=($k=$R._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$k.id]){this._errorRecord[$k.id]=1;var $f="vertexBuffer:"+("("+$k._destroyed+","+$k._released+","+$k._referenceCount+","+$k._buffer+")")+", material:"+($s?$s.__className+"("+$s._destroyed+","+$s._released+")":"null")+", owner:"+($N?$N.__className+"("+$N._destroyed+","+$N._activeInHierarchy+","+$N._displayedInStage+")":"null")+", renderObj:"+($R?$R.__className+"("+$R._destroyed+","+$R._released+","+$R._referenceCount+")":"")+", parent:, url:"+($N?$N.url:"")+", disposeStack:"+$k.disposeStack;$C.recordError("报错：unknown vertexDeclaration  "+$f)}continue}if($b=($n=$x._shader=$s._getShader($i._shaderDefineValue,$l.shaderDefineValue,$N._shaderDefineValue)).bind()||$w!==$n._uploadLoopCount,$z){if($n._uploadVertexBuffer!==$z||$b){for(var $m=0;$m<$z.length;$m++){var $y=$z[$m];$n.uploadAttributesX($y.vertexDeclaration.shaderValues.data,$y)}$n._uploadVertexBuffer=$z}}else($n._uploadVertexBuffer!==$k||$b)&&($n.uploadAttributes($l.shaderValues.data,null),$n._uploadVertexBuffer=$k);($n._uploadScene!==$i||$b)&&($n.uploadSceneUniforms($i._shaderValues.data),$n._uploadScene=$i),($F!==$n._uploadCamera||$n._uploadSprite3D!==$N||$b)&&($n.uploadSpriteUniforms($N._shaderValues.data),$n._uploadSprite3D=$N),($F!==$n._uploadCamera||$b)&&($n.uploadCameraUniforms($F._shaderValues.data),$n._uploadCamera=$F),($n._uploadMaterial!==$s||$b)&&($s._upload(),$n._uploadMaterial=$s),$a!==$s?($s._setRenderStateBlendDepth(),$s._setRenderStateFrontFace($I,$N.transform),$a=$s,$$=$N):$$!==$N&&($s._setRenderStateFrontFace($I,$N.transform),$$=$N),$R._render($x),$n._uploadLoopCount=$w}$N._postRenderUpdateComponents($x)}else if(2===$D._type){$D.renderObj;$x.owner=$N=$D._sprite3D,$x.renderElement=$D,$x._batchIndexStart=$D._tempBatchIndexStart,$x._batchIndexEnd=$D._tempBatchIndexEnd,$R=$D.renderObj,$s=$D._material,this._begainRenderElement($x,$R,$s)&&($l=($k=$R._getVertexBuffer(0)).vertexDeclaration,$b=($n=$x._shader=$s._getShader($i._shaderDefineValue,$l.shaderDefineValue,$N._shaderDefineValue)).bind()||$w!==$n._uploadLoopCount,($n._uploadVertexBuffer!==$k||$b)&&($n.uploadAttributes($l.shaderValues.data,null),$n._uploadVertexBuffer=$k),($n._uploadScene!==$i||$b)&&($n.uploadSceneUniforms($i._shaderValues.data),$n._uploadScene=$i),($F!==$n._uploadCamera||$n._uploadSprite3D!==$N||$b)&&($n.uploadSpriteUniforms($N._shaderValues.data),$n._uploadSprite3D=$N),($F!==$n._uploadCamera||$b)&&($n.uploadCameraUniforms($F._shaderValues.data),$n._uploadCamera=$F),($n._uploadMaterial!==$s||$b)&&($s._upload(),$n._uploadMaterial=$s),$a!==$s?($s._setRenderStateBlendDepth(),$s._setRenderStateFrontFace($I,$N.transform),$a=$s,$$=$N):$$!==$N&&($s._setRenderStateFrontFace($I,$N.transform),$$=$N),$R._render($x),$n._uploadLoopCount=$w)}}},$x._renderShadow=function($x,$I){for(var $z,$k,$l,$n,$a,$$=$L.loopCount,$w=this._scene,$i=$x.camera,$F=!1,$b=0,$T=this._finalElements.length;$b<$T;$b++){var $_,$R,$s,$N=this._finalElements[$b];0===$N._type&&($x.owner=$s=$N._sprite3D,$I||$s._projectionViewWorldUpdateCamera===$i&&$s._projectionViewWorldUpdateLoopCount===$L.loopCount||($s._render._renderUpdate($x._projectionViewMatrix),$s._projectionViewWorldUpdateLoopCount=$L.loopCount,$s._projectionViewWorldUpdateCamera=$i),$x.renderElement=$N,$s._preRenderUpdateComponents($x),$_=$N.renderObj,$R=$N._material,this._begainRenderElement($x,$_,null)&&($k=($z=$_._getVertexBuffer(0)).vertexDeclaration,$F=($l=$x._shader=$R._getShader($w._shaderDefineValue,$k.shaderDefineValue,$s._shaderDefineValue)).bind()||$$!==$l._uploadLoopCount,($l._uploadVertexBuffer!==$z||$F)&&($l.uploadAttributes($k.shaderValues.data,null),$l._uploadVertexBuffer=$z),($i!==$l._uploadCamera||$l._uploadSprite3D!==$s||$F)&&($l.uploadSpriteUniforms($s._shaderValues.data),$l._uploadSprite3D=$s),($i!==$l._uploadCamera||$F)&&($l.uploadCameraUniforms($i._shaderValues.data),$l._uploadCamera=$i),($l._uploadMaterial!==$R||$F)&&($R._upload(),$l._uploadMaterial=$R),$l._uploadRenderElement,$n!==$R?($R._setRenderStateFrontFace(!1,$s.transform),$n=$R,$a=$s):$a!==$s&&($R._setRenderStateFrontFace(!1,$s.transform),$a=$s),$_._render($x),$l._uploadLoopCount=$$),$s._postRenderUpdateComponents($x))}},$x._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$x._addRenderElement=function($x){this._renderElements.push($x),this._needSort=!0},$x._addDynamicBatchElement=function($x){this._dynamicBatchCombineRenderElements.push($x)},$R(0,$x,"id",function(){return this._id}),$I._uniqueIDCounter=0,$I._cameraPosition=null,$I}(),$u=function(){function $x(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $_($x,"laya.d3.core.render.RenderState"),$x.clientWidth=0,$x.clientHeight=0,$x}(),$r=function(){function $a($x,$I){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $Mx(new $aI,0),this._corners=[new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI],this._boundingBoxCenter=new $aI,this._children=$k(8),this._objects=[],this._tempBoundBoxCorners=[new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI],this._scene=$x,this._currentDepth=$I}$_($a,"laya.d3.core.scene.OctreeNode");var $x=$a.prototype;return $C.imps($x,{"laya.d3.core.scene.ITreeNode":!0}),$x.init=function($x,$I){var $z=new $aI,$k=new $aI;$aI.scale($I,-.5,$z),$aI.scale($I,.5,$k),$aI.add($z,$x,$z),$aI.add($k,$x,$k),this.exactBox=new $rx($z,$k),this.relaxBox=new $rx($z,$k)},$x.addTreeNode=function($x){1===Collision.boxContainsBox(this._relaxBox,$x.boundingBox)?this.addNodeDown($x,0):this.addObject($x)},$x.addChild=function($x){var $I=this._children[$x];if(null==$I){$I=new $a(this._scene,this._currentDepth+1),(this._children[$x]=$I)._parent=this,$aI.subtract(this._exactBox.max,this._exactBox.min,$a.tempSize),$aI.multiply($a.tempSize,$a._octreeSplit[$x],$a.tempCenter),$aI.add(this._exactBox.min,$a.tempCenter,$a.tempCenter),$aI.scale($a.tempSize,.25,$a.tempSize);var $z=new $aI,$k=new $aI;$aI.subtract($a.tempCenter,$a.tempSize,$z),$aI.add($a.tempCenter,$a.tempSize,$k),$I.exactBox=new $rx($z,$k),$aI.scale($a.tempSize,$a.relax,$a.tempSize);var $l=new $aI,$n=new $aI;$aI.subtract($a.tempCenter,$a.tempSize,$l),$aI.add($a.tempCenter,$a.tempSize,$n),$I.relaxBox=new $rx($l,$n)}return $I},$x.addObject=function($x){($x._treeNode=this)._objects.push($x)},$x.removeObject=function($x){if($x._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $I=this._objects.indexOf($x);return-1!==$I&&(this._objects.splice($I,1),!0)},$x.clearObject=function(){this._objects.length=0},$x.addNodeUp=function($x,$I){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$x.boundingBox)?this._parent.addNodeUp($x,$I-1):this.addNodeDown($x,$I)},$x.addNodeDown=function($x,$I){if($I<this._scene.treeLevel){var $z=this.inChildIndex($x.boundingBoxCenter),$k=this.addChild($z);1===Collision.boxContainsBox($k._relaxBox,$x.boundingBox)?$k.addNodeDown($x,++$I):this.addObject($x)}else this.addObject($x)},$x.inChildIndex=function($x){return 4*($x.z<this._boundingBoxCenter.z?0:1)+2*($x.y<this._boundingBoxCenter.y?0:1)+($x.x<this._boundingBoxCenter.x?0:1)},$x.updateObject=function($x){1===Collision.boxContainsBox(this._relaxBox,$x.boundingBox)?(this.removeObject($x),$x._treeNode=null,this.addNodeDown($x,this._currentDepth)):this._parent&&(this.removeObject($x),$x._treeNode=null,this._parent.addNodeUp($x,this._currentDepth-1))},$x.cullingObjects=function($x,$I,$z,$k,$l){var $n,$a=0,$$=0,$w=0,$i=this._scene._dynamicBatchManager;for($a=0,$n=this._objects.length;$a<$n;$a++){var $F=this._objects[$a];if($d.isVisible($F._owner.layer.mask)&&$F.enable){if($I&&($L.treeSpriteCollision+=1,0===$x.containsBoundSphere($F.boundingSphere)))continue;$F._renderUpdate($l),$F._distanceForSort=$aI.distance($F.boundingSphere.center,$k)+$F.sortingFudge;var $b=$F._renderElements;for($$=0,$w=$b.length;$$<$w;$$++){var $T=$b[$$],$_=$T._staticBatch;if($_&&$_._material===$T._material)$_._addBatchRenderElement($T);else{var $R=$T.renderObj;$R.triangleCount<10&&1===$R._vertexBufferCount&&$R._getIndexBuffer()&&$T._material.renderQueue<2&&$T._canDynamicBatch&&!$F._owner.isStatic?$i._addPrepareRenderElement($T):this._scene.getRenderQueue($T._material.renderQueue)._addRenderElement($T)}}}}for($a=0;$a<8;$a++){var $s=this._children[$a];if(null!=$s){var $N=$I;if($I){var $D=$x.containsBoundBox($s._relaxBox);if($L.treeNodeCollision+=1,0===$D)continue;$N=2===$D}$s.cullingObjects($x,$N,$z,$k,$l)}}},$x.cullingShadowObjects=function($x,$I,$z,$k,$l){var $n,$a=0,$$=0,$w=0;this._scene._dynamicBatchManager;for($a=0,$n=this._objects.length;$a<$n;$a++){var $i=this._objects[$a];if($i.castShadow&&$d.isVisible($i._owner.layer.mask)&&$i.enable){if($z&&0===$x[0].containsBoundSphere($i.boundingSphere))continue;for(var $F=1,$b=$x.length;$F<$b;$F++){var $T=$I[$F-1];if(0!==$x[$F].containsBoundSphere($i.boundingSphere)){var $_=$i._renderElements;for($$=0,$w=$_.length;$$<$w;$$++)$T._addRenderElement($_[$$])}}}}for($a=0;$a<8;$a++){var $R=this._children[$a];if(null!=$R){var $s=$z;if($z){var $N=$x[0].containsBoundBox($R._relaxBox);if(0===$N)continue;$s=2===$N}$R.cullingShadowObjects($x,$I,$s,$k,$l)}}},$x.cullingShadowObjectsOnePSSM=function($x,$I,$z,$k,$l,$n){var $a,$$=$I[0],$w=0,$i=0,$F=0;for($w=0,$a=this._objects.length;$w<$a;$w++){var $b=this._objects[$w];if($b.castShadow&&$d.isVisible($b._owner.layer.mask)&&$b.enable){if($k&&0===$x.containsBoundSphere($b.boundingSphere))continue;$b._renderUpdate($z);var $T=$b._renderElements;for($i=0,$F=$T.length;$i<$F;$i++)$$._addRenderElement($T[$i])}}for($w=0;$w<8;$w++){var $_=this._children[$w];if(null!=$_){var $R=$k;if($k){var $s=$x.containsBoundBox($_._relaxBox);if(0===$s)continue;$R=2===$s}$_.cullingShadowObjectsOnePSSM($x,$I,$z,$R,$l,$n)}}},$x.renderBoudingBox=function($x){this._renderBoudingBox($x);for(var $I=0;$I<8;++$I){var $z=this._children[$I];$z&&$z.renderBoudingBox($x)}},$x.buildAllChild=function($x){if($x<this._scene.treeLevel)for(var $I=0;$I<8;$I++){this.addChild($I).buildAllChild($x+1)}},$x._renderBoudingBox=function($x){},$R(0,$x,"exactBox",function(){return this._exactBox},function($x){this._exactBox=$x,$aI.add($x.min,$x.max,this._boundingBoxCenter),$aI.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$R(0,$x,"relaxBox",function(){return this._relaxBox},function($x){(this._relaxBox=$x).getCorners(this._corners),$Mx.createfromPoints(this._corners,this._boundingSphere)}),$a.debugMode=!1,$a.relax=1.15,$a.CHILDNUM=8,$b($a,["tempVector0",function(){return this.tempVector0=new $aI},"tempSize",function(){return this.tempSize=new $aI},"tempCenter",function(){return this.tempCenter=new $aI},"_octreeSplit",function(){return this._octreeSplit=[new $aI(.25,.25,.25),new $aI(.75,.25,.25),new $aI(.25,.75,.25),new $aI(.75,.75,.25),new $aI(.25,.25,.75),new $aI(.75,.25,.75),new $aI(.25,.75,.75),new $aI(.75,.75,.75)]}]),$a}(),$g=(function(){function $x(){}$_($x,"laya.d3.core.scene.SceneManager")}(),function(){function $x($x,$I,$z,$k){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$x&&($x=1),void 0===$I&&($I=1),void 0===$z&&($z=1),void 0===$k&&($k=1),this._r=$x,this._g=$I,this._b=$z,this._a=$k}return $_($x,"laya.d3.core.trail.module.Color",null,"Color$1"),$x.prototype.cloneTo=function($x){$x._r=this._r,$x._g=this._g,$x._b=this._b,$x._a=this._a},$b($x,["RED",function(){return this.RED=new $x(1,0,0,1)},"GREEN",function(){return this.GREEN=new $x(0,1,0,1)},"BLUE",function(){return this.BLUE=new $x(0,0,1,1)},"CYAN",function(){return this.CYAN=new $x(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $x(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $x(1,0,1,1)},"GRAY",function(){return this.GRAY=new $x(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $x(1,1,1,1)},"BLACK",function(){return this.BLACK=new $x(0,0,0,1)}]),$x}()),$M=(function(){function $x(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$_($x,"laya.d3.core.trail.module.Gradient");var $I=$x.prototype;$I.setKeys=function($x,$I){var $z,$k;this._colorKeys=$x;for(var $l=this.index=0;$l<$x.length;$l++){var $n=($z=$x[$l]).color;this._colorKeyData[this.index++]=$n._r,this._colorKeyData[this.index++]=$n._g,this._colorKeyData[this.index++]=$n._b,this._colorKeyData[this.index++]=$z.time}this._alphaKeys=$I;for(var $a=this.index=0;$a<$I.length;$a++)$k=$I[$a],this._alphaKeyData[this.index++]=$k.alpha,this._alphaKeyData[this.index++]=$k.time},$I.cloneTo=function($x){var $I=0,$z=0,$k=this.colorKeys,$l=[];for($I=0,$z=$k.length;$I<$z;$I++){var $n=new $Q;$k[$I].cloneTo($n),$l.push($n)}var $a=this.alphaKeys,$$=[];for($I=0,$z=$a.length;$I<$z;$I++){var $w=new $M;$a[$I].cloneTo($w),$$.push($w)}$x.setKeys($l,$$)},$R(0,$I,"mode",function(){return this._mode},function($x){this._mode=$x}),$R(0,$I,"colorKeys",function(){return this._colorKeys},function($x){this._colorKeys=$x;for(var $I=this.index=0;$I<$x.length;$I++){var $z=$x[$I],$k=$z.color;this._colorKeyData[this.index++]=$k._r,this._colorKeyData[this.index++]=$k._g,this._colorKeyData[this.index++]=$k._b,this._colorKeyData[this.index++]=$z.time}}),$R(0,$I,"alphaKeys",function(){return this._alphaKeys},function($x){this._alphaKeys=$x;for(var $I=this.index=0;$I<$x.length;$I++){var $z=$x[$I];this._alphaKeyData[this.index++]=$z.alpha,this._alphaKeyData[this.index++]=$z.time}})}(),function(){function $x($x,$I){this._alpha=NaN,this._time=NaN,void 0===$x&&($x=0),void 0===$I&&($I=0),this._alpha=$x,this._time=$I}$_($x,"laya.d3.core.trail.module.GradientAlphaKey");var $I=$x.prototype;return $I.cloneTo=function($x){$x.alpha=this.alpha,$x.time=this.time},$R(0,$I,"alpha",function(){return this._alpha},function($x){this._alpha=$x}),$R(0,$I,"time",function(){return this._time},function($x){this._time=$x}),$x}()),$Q=function(){function $x($x,$I){this._color=null,this._time=NaN,void 0===$I&&($I=0),this._color=$x||new $g,this._time=$I}$_($x,"laya.d3.core.trail.module.GradientColorKey");var $I=$x.prototype;return $I.cloneTo=function($x){this.color.cloneTo($x.color),$x.time=this.time},$R(0,$I,"color",function(){return this._color},function($x){this._color=$x}),$R(0,$I,"time",function(){return this._time},function($x){this._time=$x}),$x}(),$G=(function(){function $x(){}$_($x,"laya.d3.core.trail.module.GradientMode"),$x.Blend=0,$x.Fixed=1}(),function(){function $x(){}$_($x,"laya.d3.core.trail.module.TextureMode"),$x.Stretch=0,$x.Tile=1}(),function(){function $x(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$_($x,"laya.d3.core.trail.module.TrailKeyFrame"),$x.prototype.cloneTo=function($x){$x.time=this.time,$x.inTangent=this.inTangent,$x.outTangent=this.outTangent,$x.value=this.value}}(),function(){function $I($x){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $aI,this._curPosition=new $aI,this._delVector3=new $aI,this._lastFixedVertexPosition=new $aI,this._pointAtoBVector3=new $aI,this._pointA=new $aI,this._pointB=new $aI,this._owner=$x,this._id=$I.renderElementCount++,0==this._id?$x._owner.transform.position.cloneTo(this._lastPosition):$x._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $WI($G.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $WI($G.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$_($I,"laya.d3.core.trail.TrailRenderElement");var $x=$I.prototype;$C.imps($x,{"laya.d3.core.render.IRenderable":!0}),$x._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$x._addTrailByFirstPosition=function($x,$I){$aI.subtract($I,$x,this._delVector3),$aI.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$aI.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$aI.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($x),$x.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$x._addTrailByNextPosition=function($x){$aI.subtract($x,this._lastFixedVertexPosition,this._delVector3),$aI.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$aI.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$aI.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$aI.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$Qx.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($x),$x.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($x),this._virtualVerticesCount=2)},$x._updateVerticesByPosition=function($x){this._pointe=$x.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$x._updateVertexBuffer2=function(){var $x,$I=0,$z=0,$k=0;for($k=0,$x=(this._verticesCount+this._virtualVerticesCount)/2;$k<$x;$k++)$z=0==this._owner.textureMode?(this._VerticesToTailLength[$k]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$k],this._vertices2[$I++]=1-$z,this._vertices2[$I++]=1-$z;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$x._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$x._updateDisappear=function(){var $x,$I=0;for($I=this._curDisappearIndex,$x=(this._verticesCount+this._virtualVerticesCount)/2;$I<$x;$I++)this._owner._curtime-this._everyGroupVertexBirthTime[$I]>=this._owner.time+$Qx.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$x._beforeRender=function($x){return this._camera=$x.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$aI.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$x._render=function($x){this._isDead||($Z.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$L.drawCall++,$L.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$x._getVertexBuffer=function($x){return void 0===$x&&($x=0),0===$x?this._vertexBuffer1:1===$x?this._vertexBuffer2:null},$x._getVertexBuffers=function(){return this._vertexBuffers},$x._getIndexBuffer=function(){return null},$x.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$x._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$R(0,$x,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$R(0,$x,"triangleCount",function(){return 0}),$I.renderElementCount=0}(),function(){function $x(){}$_($x,"laya.d3.core.trail.VertexTrail");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration1}),$R(1,$x,"vertexDeclaration1",function(){return $x._vertexDeclaration1}),$R(1,$x,"vertexDeclaration2",function(){return $x._vertexDeclaration2}),$b($x,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $nx(32,[new $ax(0,"vector3",0),new $ax(12,"vector3",41),new $ax(24,"single",33),new $ax(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $nx(4,[new $ax(0,"single",38)])}]),$x}()),$xx=function(){function $y($x){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$x}$_($y,"laya.d3.graphics.DynamicBatch");var $x=$y.prototype;return $C.imps($x,{"laya.d3.core.render.IRenderable":!0}),$x._getVertexBuffer=function($x){return void 0===$x&&($x=0),0===$x?this._vertexBuffer:null},$x._getIndexBuffer=function(){return this._indexBuffer},$x._getCombineRenderElementFromPool=function($x,$I,$z){var $k=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $k||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$k=new $H,$k._sprite3D=new $pI),$k._sprite3D._render._renderUpdate($z),$k},$x._getRenderElement=function($x,$I,$z){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$y.maxVertexCount),this._indexDatas=new Uint16Array($y.maxIndexCount),this._vertexBuffer=$WI.create(this._vertexDeclaration,$y.maxVertexCount,35048),this._indexBuffer=$VI.create("ushort",$y.maxIndexCount,35048));for(var $k=this._merageElements.length=0,$l=0,$n=0,$a=this._combineRenderElements.length;$n<$a;$n++){var $$=this._combineRenderElements[$n],$w=$$.getDynamicBatchBakedVertexs(0),$i=$$.getBakedIndices(),$F=$$._sprite3D.transform._isFrontFaceInvert,$b=$k/(this._vertexDeclaration.vertexStride/4),$T=$l,$_=$T+$i.length;$$._tempBatchIndexStart=$T,$$._tempBatchIndexEnd=$_,this._indexDatas.set($i,$l);var $R=0;if($F)for($R=$T;$R<$_;$R+=3){this._indexDatas[$R]=$b+this._indexDatas[$R];var $s=this._indexDatas[$R+1],$N=this._indexDatas[$R+2];this._indexDatas[$R+1]=$b+$N,this._indexDatas[$R+2]=$b+$s}else for($R=$T;$R<$_;$R+=3)this._indexDatas[$R]=$b+this._indexDatas[$R],this._indexDatas[$R+1]=$b+this._indexDatas[$R+1],this._indexDatas[$R+2]=$b+this._indexDatas[$R+2];$l+=$i.length,this._vertexDatas.set($w,$k),$k+=$w.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$n=this._combineRenderElementPoolIndex=0,$a=this._materials.length;$n<$a;$n++){var $D=this._getCombineRenderElementFromPool($x,$I,$z);$D._type=2,$D._staticBatch=null;var $f=($D.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$n]]._tempBatchIndexStart,$m=$n+1===this._materialToRenderElementsOffsets.length?$l:this._combineRenderElements[this._materialToRenderElementsOffsets[$n+1]]._tempBatchIndexStart;$D._tempBatchIndexStart=$f,$D._tempBatchIndexEnd=$m,$D._material=this._materials[$n],this._merageElements.push($D)}},$x._addCombineRenderObjTest=function($x){var $I=$x.renderObj,$z=this._currentCombineIndexCount+$I._getIndexBuffer().indexCount,$k=this._currentCombineVertexCount+$I._getVertexBuffer().vertexCount;return!($y.maxVertexCount<$k||$y.maxIndexCount<$z)},$x._addCombineRenderObj=function($x){var $I=$x.renderObj;this._combineRenderElements.push($x),this._currentCombineIndexCount=this._currentCombineIndexCount+$I._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$I._getVertexBuffer().vertexCount},$x._addCombineMaterial=function($x){this._materials.push($x)},$x._addMaterialToRenderElementOffset=function($x){this._materialToRenderElementsOffsets.push($x)},$x._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$x._addToRenderQueue=function($x,$I,$z,$k){this._getRenderElement($I,$z,$k);for(var $l=0,$n=this._materials.length;$l<$n;$l++)$x.getRenderQueue(this._materials[$l].renderQueue)._addDynamicBatchElement(this._merageElements[$l])},$x._beforeRender=function($x){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$x._render=function($x){var $I=$x._batchIndexEnd-$x._batchIndexStart;$Z.mainContext.drawElements(4,$I,5123,2*$x._batchIndexStart),$L.drawCall++,$L.trianglesFaces+=$I/3},$x._getVertexBuffers=function(){return null},$R(0,$x,"_vertexBufferCount",function(){return 1}),$R(0,$x,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$R(0,$x,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$y.maxVertexCount=2e4,$y.maxIndexCount=4e4,$y.maxCombineTriangleCount=10,$y}(),$Ix=function(){function $y(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$_($y,"laya.d3.graphics.DynamicBatchManager");var $x=$y.prototype;return $x.getDynamicBatch=function($x,$I){var $z,$k=$x.id.toString()+$I;return this._dynamicBatches[$k]?$z=this._dynamicBatches[$k]:this._dynamicBatches[$k]=$z=new $xx($x),$z},$x._garbageCollection=function(){for(var $x in this._dynamicBatches)0===this._dynamicBatches[$x].combineRenderElementsCount&&delete this._dynamicBatches[$x]},$x._addPrepareRenderElement=function($x){this._prepareDynamicBatchCombineElements.push($x)},$x._finishCombineDynamicBatch=function($x){var $I,$z,$k;this._prepareDynamicBatchCombineElements.sort($y._sortPrepareDynamicBatch);for(var $l,$n,$a,$$,$w,$i=-1,$F=!0,$b=0,$T=-1,$_=0,$R=this._prepareDynamicBatchCombineElements.length;$_<$R;$_++){var $s=($n=this._prepareDynamicBatchCombineElements[$_]).renderObj._getVertexBuffer(0).vertexDeclaration,$N=$z!==$s;$N&&($b=0,$z=$s);var $D=$b!==$i;if($D&&($i=$b),($N||$D)&&($a=this.getDynamicBatch($s,$b),$I=null),$F)if($a._addCombineRenderObjTest($n)){if($I!==($l=$n._material))$$&&($x.getRenderQueue($w._material.renderQueue)._addRenderElement($w),$w=$$=null,$T=-1),$$=$l,$T=$a.combineRenderElementsCount,$w=$n,$I=$l;else if($$){var $f=$w.renderObj,$m=$n.renderObj;$f._getVertexBuffer().vertexCount+$m._getVertexBuffer().vertexCount>$xx.maxVertexCount||$f._getIndexBuffer().indexCount+$m._getIndexBuffer().indexCount>$xx.maxIndexCount?($x.getRenderQueue($w._material.renderQueue)._addRenderElement($w),$$=$l,$T=$a.combineRenderElementsCount,$w=$n):($a._addCombineMaterial($$),$a._addMaterialToRenderElementOffset($T),$a._addCombineRenderObj($w),$w=$$=null,$T=-1,$a._addCombineRenderObj($n))}else $a._addCombineRenderObj($n);$F=!0}else $$&&($x.getRenderQueue($w._material.renderQueue)._addRenderElement($w),$w=$$=null,$T=-1),$b++,$F=!1;else $k=this._prepareDynamicBatchCombineElements[$_-1],$a._addMaterialToRenderElementOffset($a.combineRenderElementsCount),$I=$k._material,$a._addCombineMaterial($I),$a._addCombineRenderObj($k),$F=!0,$I!==($l=$n._material)?($$=$l,$T=$a.combineRenderElementsCount,$w=$n):$a._addCombineRenderObj($n),$I=$l}$$&&($x.getRenderQueue($w._material.renderQueue)._addRenderElement($w),$w=$$=null,$T=-1),this._prepareDynamicBatchCombineElements.length=0},$x._clearRenderElements=function(){for(var $x in this._dynamicBatches)this._dynamicBatches[$x]._clearRenderElements()},$x._addToRenderQueue=function($x,$I,$z,$k){for(var $l in this._dynamicBatches){var $n=this._dynamicBatches[$l];0<$n.combineRenderElementsCount&&$n._addToRenderQueue($x,$I,$z,$k)}},$x.dispose=function(){this._dynamicBatches=null},$y._sortPrepareDynamicBatch=function($x,$I){return $x._mainSortID-$I._mainSortID},$y}(),$zx=function(){function $x(){}return $_($x,"laya.d3.graphics.FrustumCulling"),$x.renderShadowObjectCulling=function($x,$I,$z,$k,$l){var $n=0,$a=0,$$=0,$w=0;for($n=0,$$=$z.length;$n<$$;$n++){var $i=$z[$n];$i&&$i._clearRenderElements()}var $F,$b,$T,$_=$x._cullingRenders;if(1<$l){for($n=0,$$=$x._cullingRendersLength;$n<$$;$n++)if(($F=$_[$n]).castShadow&&$d.isVisible($F._owner.layer.mask)&&$F.enable)for(var $R=1,$s=$I.length;$R<$s;$R++)if($b=$z[$R-1],0!==$I[$R].containsBoundSphere($F.boundingSphere))for($a=0,$w=($T=$F._renderElements).length;$a<$w;$a++)$b._addRenderElement($T[$a])}else for($n=0,$$=$x._cullingRendersLength;$n<$$;$n++)if(($F=$_[$n]).castShadow&&$d.isVisible($F._owner.layer.mask)&&$F.enable&&0!==$I[0].containsBoundSphere($F.boundingSphere))for($F._renderUpdate($k),$b=$z[0],$a=0,$w=($T=$F._renderElements).length;$a<$w;$a++)$b._addRenderElement($T[$a])},$x.renderShadowObjectCullingOctree=function($x,$I,$z,$k,$l){for(var $n=0,$a=$z.length;$n<$a;$n++){var $$=$z[$n];$$&&$$._clearRenderElements()}1<$l?$x.treeRoot.cullingShadowObjects($I,$z,!0,0,$x):$x.treeRoot.cullingShadowObjectsOnePSSM($I[0],$z,$k,!0,0,$x)},$x.renderObjectCulling=function($x,$I,$z,$k,$l,$n){var $a=0,$$=0,$w=0,$i=0,$F=$I._quenes,$b=$I._dynamicBatchManager,$T=$I._cullingRenders;for($a=0,$$=$F.length;$a<$$;$a++){var $_=$F[$a];$_&&$_._clearRenderElements()}var $R=$kx._staticBatchManagers;for($a=0,$$=$R.length;$a<$$;$a++)$R[$a]._clearRenderElements();$b._clearRenderElements();var $s=$z.transform.position;for($a=0,$$=$I._cullingRendersLength;$a<$$;$a++){var $N=$T[$a];if($d.isVisible($N._owner.layer.mask)&&$N.enable&&0!==$x.containsBoundSphere($N.boundingSphere)&&$N._renderUpdate($n)){$N._distanceForSort=$aI.distance($N.boundingSphere.center,$s)+$N.sortingFudge;var $D=$N._renderElements;for($w=0,$i=$D.length;$w<$i;$w++){var $f=$D[$w],$m=$f._staticBatch;if($m&&$m._material===$f._material)$m._addBatchRenderElement($f);else{var $y=$f.renderObj;$y.triangleCount<10&&1===$y._vertexBufferCount&&$y._getIndexBuffer()&&$f._material.renderQueue<2&&$f._canDynamicBatch&&!$N._owner.isStatic?$b._addPrepareRenderElement($f):$I.getRenderQueue($f._material.renderQueue)._addRenderElement($f)}}}}for($a=0,$$=$R.length;$a<$$;$a++)$R[$a]._addToRenderQueue($I,$k,$l,$n);$b._finishCombineDynamicBatch($I),$b._addToRenderQueue($I,$k,$l,$n)},$x.renderObjectCullingOctree=function($x,$I,$z,$k,$l,$n){var $a=0,$$=0,$w=$I._quenes,$i=$I._dynamicBatchManager;for($a=0,$$=$w.length;$a<$$;$a++){var $F=$w[$a];$F&&$F._clearRenderElements()}var $b=$kx._staticBatchManagers;for($a=0,$$=$b.length;$a<$$;$a++)$b[$a]._clearRenderElements();for($i._clearRenderElements(),$I._cullingRenders.length=0,$I.treeRoot.cullingObjects($x,!0,0,$z.transform.position,$n),$a=0,$$=$b.length;$a<$$;$a++)$b[$a]._addToRenderQueue($I,$k,$l,$n);$i._finishCombineDynamicBatch($I),$i._addToRenderQueue($I,$k,$l,$n)},$x.renderObjectCullingNoBoundFrustum=function($x,$I,$z,$k,$l){var $n=0,$a=0,$$=0,$w=0,$i=$x._quenes,$F=$x._dynamicBatchManager,$b=$x._cullingRenders;for($n=0,$a=$i.length;$n<$a;$n++){var $T=$i[$n];$T&&$T._clearRenderElements()}var $_=$kx._staticBatchManagers;for($n=0,$a=$_.length;$n<$a;$n++)$_[$n]._clearRenderElements();$F._clearRenderElements();var $R=$I.transform.position;for($n=0,$a=$x._cullingRendersLength;$n<$a;$n++){var $s=$b[$n];if($d.isVisible($s._owner.layer.mask)&&$s.enable){$s._renderUpdate($l),$s._distanceForSort=$aI.distance($s.boundingSphere.center,$R)+$s.sortingFudge;var $N=$s._renderElements;for($$=0,$w=$N.length;$$<$w;$$++){var $D=$N[$$],$f=$D._staticBatch;if($f&&$f._material===$D._material)$f._addBatchRenderElement($D);else{var $m=$D.renderObj;$m.triangleCount<10&&1===$m._vertexBufferCount&&$m._getIndexBuffer()&&$D._material.renderQueue<2&&$D._canDynamicBatch&&!$s._owner.isStatic?$F._addPrepareRenderElement($D):$x.getRenderQueue($D._material.renderQueue)._addRenderElement($D)}}}}for($n=0,$a=$_.length;$n<$a;$n++)$_[$n]._addToRenderQueue($x,$z,$k,$l);$F._finishCombineDynamicBatch($x),$F._addToRenderQueue($x,$z,$k,$l)},$x}(),$kx=function(){function $n(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$_($n,"laya.d3.graphics.StaticBatchManager");var $x=$n.prototype;return $x._finishInit=function(){for(var $x in this._staticBatches)this._staticBatches[$x]._finishInit();this._initBatchRenderElements.length=0},$x._initStaticBatchs=function($x){throw new Error("StaticBatchManager:must override this function.")},$x._addInitBatchSprite=function($x){for(var $I=$x._render._renderElements,$z=0,$k=$I.length;$z<$k;$z++)this._initBatchRenderElements.push($I[$z])},$x._clearRenderElements=function(){for(var $x in this._staticBatches)this._staticBatches[$x]._clearRenderElements()},$x._garbageCollection=function($x){var $I=$x._staticBatch,$z=$I._initBatchRenderElements,$k=$z.indexOf($x);$z.splice($k,1),0===$z.length&&($I.dispose(),delete this._staticBatches[$I._key])},$x._addToRenderQueue=function($x,$I,$z,$k){for(var $l in this._staticBatches){var $n=this._staticBatches[$l];0<$n._batchRenderElements.length&&$n._updateToRenderQueue($x,$k)}},$x.dispose=function(){this._staticBatches=null},$n._addToStaticBatchQueue=function($x){$x instanceof laya.d3.core.RenderableSprite3D&&$x._addToInitStaticBatchManager();for(var $I=0,$z=$x.numChildren;$I<$z;$I++)$n._addToStaticBatchQueue($x._childs[$I])},$n.combine=function($x,$I){var $z,$k=0,$l=0;if($I)for($k=0,$l=$I.length;$k<$l;$k++){$I[$k]._addToInitStaticBatchManager()}else $x&&$n._addToStaticBatchQueue($x);for($k=0,$l=$n._staticBatchManagers.length;$k<$l;$k++)($z=$n._staticBatchManagers[$k])._initStaticBatchs($x),$z._finishInit()},$n._staticBatchManagers=[],$n}(),$lx=function(){function $x($x,$I,$z){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$x,this._manager=$I,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$z}$_($x,"laya.d3.graphics.StaticBatch");var $I=$x.prototype;return $C.imps($I,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$I._binarySearch=function($x){for(var $I=0,$z=this._batchRenderElements.length-1,$k=0;$I<=$z;)$k=Math.floor(($I+$z)/2),this._compareBatchRenderElement(this._batchRenderElements[$k],$x)?$z=$k-1:$I=$k+1;return $I},$I._compareBatchRenderElement=function($x,$I){throw new Error("StaticBatch:must override this function.")},$I._getVertexDecLightMap=function($x){return $x===$Vx.vertexDeclaration?$dx.vertexDeclaration:$x===$cx.vertexDeclaration?$Xx.vertexDeclaration:$x===$Kx.vertexDeclaration?$yx.vertexDeclaration:$x===$Jx.vertexDeclaration?null:$x===$sx.vertexDeclaration?$Nx.vertexDeclaration:$x===$qx.vertexDeclaration?$tx.vertexDeclaration:$x===$Zx.vertexDeclaration?$Ux.vertexDeclaration:$x===$Wx.vertexDeclaration?$jx.vertexDeclaration:$x===$cx.vertexDeclaration?$Xx.vertexDeclaration:$x===$Ex.vertexDeclaration?$Cx.vertexDeclaration:$x===$Jx.vertexDeclaration?null:$x===$sx.vertexDeclaration?$Nx.vertexDeclaration:$x===$ox.vertexDeclaration?$Yx.vertexDeclaration:$x===$Zx.vertexDeclaration?$Ux.vertexDeclaration:$x},$I._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$I._addBatchRenderElement=function($x){this._batchRenderElements.splice(this._binarySearch($x),0,$x)},$I._updateToRenderQueue=function($x,$I){this._combineRenderElementPoolIndex=0,this._getRenderElement($x.getRenderQueue(this._material.renderQueue)._renderElements,$x,$I)},$I._getRenderElement=function($x,$I,$z){throw new Error("StaticBatch:must override this function.")},$I._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$I._clearRenderElements=function(){this._batchRenderElements.length=0},$I.dispose=function(){},$I._getVertexBuffer=function($x){return void 0===$x&&($x=0),null},$I._getIndexBuffer=function(){return null},$I._beforeRender=function($x){return!0},$I._render=function($x){},$I._getVertexBuffers=function(){return null},$R(0,$I,"_vertexBufferCount",function(){return 1}),$R(0,$I,"triangleCount",function(){return 0}),$x.combine=function($x){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$kx.combine($x)},$x.maxBatchVertexCount=65535,$x}(),$nx=function(){function $a($x,$I){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$a._uniqueIDCounter,this._id>$a.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$a.maxVertexDeclaration);this._shaderValues=new $TI,this._vertexElementsDic={},this._vertexStride=$x,this._vertexElements=$I;for(var $z=0;$z<$I.length;$z++){var $k=$I[$z],$l=$k.elementUsage;this._vertexElementsDic[$l]=$k;var $n=[$a._getTypeSize($k.elementFormat)/4,5126,!1,this._vertexStride,$k.offset];switch(this._shaderValues.setValue($l,$n),$l){case 1:this._addShaderDefine($LI.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($LI.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($LI.SHADERDEFINE_UV1)}}}$_($a,"laya.d3.graphics.VertexDeclaration");var $x=$a.prototype;return $x._addShaderDefine=function($x){this._shaderDefineValue|=$x},$x._removeShaderDefine=function($x){this._shaderDefineValue&=~$x},$x.getVertexElements=function(){return this._vertexElements.slice()},$x.getVertexElementByUsage=function($x){return this._vertexElementsDic[$x]},$x.unBinding=function(){},$R(0,$x,"shaderDefineValue",function(){return this._shaderDefineValue}),$R(0,$x,"id",function(){return this._id}),$R(0,$x,"vertexStride",function(){return this._vertexStride}),$R(0,$x,"shaderValues",function(){return this._shaderValues}),$a._getTypeSize=function($x){switch($x){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$a.getVertexStride=function($x){for(var $I=0,$z=0;$z<$x.Length;$z++){var $k=$x[$z],$l=$k.offset+$a._getTypeSize($k.elementFormat);$I<$l&&($I=$l)}return $I},$a._maxVertexDeclarationBit=1e3,$a._uniqueIDCounter=1,$b($a,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$a}(),$ax=function(){function $x($x,$I,$z){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$x,this.elementFormat=$I,this.elementUsage=$z}return $_($x,"laya.d3.graphics.VertexElement"),$x}(),$$x=(function(){function $x(){}$_($x,"laya.d3.graphics.VertexElementFormat"),$x.Single="single",$x.Vector2="vector2",$x.Vector3="vector3",$x.Vector4="vector4",$x.Color="color",$x.Byte4="byte4",$x.Short2="short2",$x.Short4="short4",$x.NormalizedShort2="normalizedshort2",$x.NormalizedShort4="normalizedshort4",$x.HalfVector2="halfvector2",$x.HalfVector4="halfvector4"}(),function(){function $x(){}$_($x,"laya.d3.graphics.VertexElementUsage"),$x.POSITION0=0,$x.COLOR0=1,$x.TEXTURECOORDINATE0=2,$x.NORMAL0=3,$x.BINORMAL0=4,$x.TANGENT0=5,$x.BLENDINDICES0=6,$x.BLENDWEIGHT0=7,$x.DEPTH0=8,$x.FOG0=9,$x.POINTSIZE0=10,$x.SAMPLE0=11,$x.TESSELLATEFACTOR0=12,$x.COLOR1=13,$x.NEXTTEXTURECOORDINATE0=14,$x.TEXTURECOORDINATE1=15,$x.NEXTTEXTURECOORDINATE1=16,$x.CORNERTEXTURECOORDINATE0=17,$x.VELOCITY0=18,$x.STARTCOLOR0=19,$x.STARTSIZE=20,$x.AGEADDSCALE0=21,$x.STARTROTATION=22,$x.ENDCOLOR0=23,$x.STARTLIFETIME=24,$x.TIME0=33,$x.SHAPEPOSITIONSTARTLIFETIME=30,$x.DIRECTIONTIME=32,$x.SIZEROTATION0=27,$x.RADIUS0=28,$x.RADIAN0=29,$x.STARTSPEED=31,$x.RANDOM0=34,$x.RANDOM1=35,$x.SIMULATIONWORLDPOSTION=36,$x.SIMULATIONWORLDROTATION=37,$x.TEXTURECOORDINATE0X=38,$x.TEXTURECOORDINATE0X1=39,$x.TEXTURECOORDINATE0Y=40,$x.OFFSETVECTOR=41}(),function(){function $x($x,$I,$z){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$x,this._textureCoordinate0=$I,this._time=$z}$_($x,"laya.d3.graphics.VertexGlitter");var $I=$x.prototype;$C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate0}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"time",function(){return this._time}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(24,[new $ax(0,"vector3",0),new $ax(12,"vector2",2),new $ax(20,"single",33)])}])}(),function(){function $x($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$x,this._position=$I,this._velocity=$z,this._startColor=$k,this._endColor=$l,this._sizeRotation=$n,this._radius=$a,this._radian=$$,this._ageAddScale=$w,this._time=$i}$_($x,"laya.d3.graphics.VertexParticle");var $I=$x.prototype;$C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"endColor",function(){return this._endColor}),$R(0,$I,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$R(0,$I,"sizeRotation",function(){return this._sizeRotation}),$R(0,$I,"velocity",function(){return this._velocity}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"startColor",function(){return this._startColor}),$R(0,$I,"radius",function(){return this._radius}),$R(0,$I,"radian",function(){return this._radian}),$R(0,$I,"ageAddScale",function(){return this._ageAddScale}),$R(0,$I,"time",function(){return this._time}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(116,[new $ax(0,"vector4",17),new $ax(16,"vector3",0),new $ax(28,"vector3",18),new $ax(40,"vector4",19),new $ax(56,"vector4",23),new $ax(72,"vector3",27),new $ax(84,"vector2",28),new $ax(92,"vector4",29),new $ax(108,"single",24),new $ax(112,"single",33)])}])}(),function(){function $x($x){this._position=null,this._position=$x}$_($x,"laya.d3.graphics.VertexPosition");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(12,[new $ax(0,"vector3",0)])}]),$x}()),$wx=function(){function $x($x,$I){this._position=null,this._normal=null,this._position=$x,this._normal=$I}$_($x,"laya.d3.graphics.VertexPositionNormal");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(24,[new $ax(0,"vector3",0),new $ax(12,"vector3",3)])}]),$x}(),$ix=function(){function $x($x,$I,$z){this._position=null,this._normal=null,this._color=null,this._position=$x,this._normal=$I,this._color=$z}$_($x,"laya.d3.graphics.VertexPositionNormalColor");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(40,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1)])}]),$x}(),$Fx=function(){function $x($x,$I,$z,$k,$l){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$x,this._normal=$I,this._color=$z,this._blendIndex=$k,this._blendWeight=$l}$_($x,"laya.d3.graphics.VertexPositionNormalColorSkin");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(72,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector4",7),new $ax(56,"vector4",6)])}]),$x}(),$bx=function(){function $x($x,$I,$z,$k,$l,$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._tangent=$k,this._blendIndex=$l,this._blendWeight=$n}$_($x,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(88,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector4",7),new $ax(56,"vector4",6),new $ax(72,"vector4",5)])}]),$x}(),$Tx=function(){function $x($x,$I,$z,$k,$l,$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._tangent=$k,this._blendIndex=$l,this._blendWeight=$n}$_($x,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(84,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector4",7),new $ax(56,"vector4",6),new $ax(72,"vector3",5)])}]),$x}(),$_x=function(){function $x($x,$I,$z,$k){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._tangent=$k}$_($x,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(56,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector4",5)])}]),$x}(),$Rx=function(){function $x($x,$I,$z,$k){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._tangent=$k}$_($x,"laya.d3.graphics.VertexPositionNormalColorTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(52,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector3",5)])}]),$x}(),$sx=function(){function $x($x,$I,$z,$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate=$k}$_($x,"laya.d3.graphics.VertexPositionNormalColorTexture");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(48,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2)])}]),$x}(),$Nx=function(){function $x($x,$I,$z,$k,$l){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate0=$k,this._textureCoordinate1=$l}$_($x,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(56,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector2",15)])}]),$x}(),$Dx=function(){function $x($x,$I,$z,$k,$l,$n,$a){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate0=$k,this._textureCoordinate1=$l,this._blendIndex=$n,this._blendWeight=$a}$_($x,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(88,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector2",15),new $ax(56,"vector4",7),new $ax(72,"vector4",6)])}]),$x}(),$fx=function(){function $x($x,$I,$z,$k,$l,$n,$a,$$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate0=$k,this._textureCoordinate1=$l,this._tangent=$n,this._blendIndex=$a,this._blendWeight=$$}$_($x,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(104,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector2",15),new $ax(56,"vector4",7),new $ax(72,"vector4",6),new $ax(88,"vector4",5)])}]),$x}(),$mx=function(){function $x(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$_($x,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$I.VertexPositionNormalColorTexture0SkinTangent=function($x,$I,$z,$k,$l,$n,$a,$$){this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate0=$k,this._textureCoordinate1=$l,this._tangent=$n,this._blendIndex=$a,this._blendWeight=$$},$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(100,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector2",15),new $ax(56,"vector4",7),new $ax(72,"vector4",6),new $ax(88,"vector3",5)])}]),$x}(),$yx=function(){function $x($x,$I,$z,$k,$l,$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate0=$k,this._textureCoordinate1=$l,this._tangent=$n}$_($x,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(72,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector2",15),new $ax(56,"vector4",5)])}]),$x}(),$Cx=function(){function $x(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$_($x,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$I.VertexPositionNormalColorTexture0Tangent=function($x,$I,$z,$k,$l,$n){this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate0=$k,this._textureCoordinate1=$l,this._tangent=$n},$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(68,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector2",15),new $ax(56,"vector3",5)])}]),$x}(),$Px=function(){function $x($x,$I,$z,$k,$l,$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate=$k,this._blendIndex=$l,this._blendWeight=$n}$_($x,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(80,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector4",7),new $ax(64,"vector4",6)])}]),$x}(),$vx=function(){function $x($x,$I,$z,$k,$l,$n,$a){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate=$k,this._tangent=$l,this._blendIndex=$n,this._blendWeight=$a}$_($x,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(96,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector4",7),new $ax(64,"vector4",6),new $ax(80,"vector4",5)])}]),$x}(),$Lx=function(){function $x($x,$I,$z,$k,$l,$n,$a){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate=$k,this._tangent=$l,this._blendIndex=$n,this._blendWeight=$a}$_($x,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(92,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector4",7),new $ax(64,"vector4",6),new $ax(80,"vector3",5)])}]),$x}(),$Kx=function(){function $x($x,$I,$z,$k,$l){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate=$k,this._tangent=$l}$_($x,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(64,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector4",5)])}]),$x}(),$Ex=function(){function $x($x,$I,$z,$k,$l){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$x,this._normal=$I,this._color=$z,this._textureCoordinate=$k,this._tangent=$l}$_($x,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"color",function(){return this._color}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(60,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",1),new $ax(40,"vector2",2),new $ax(48,"vector3",5)])}]),$x}(),$Ox=function(){function $x($x,$I,$z){this._position=null,this._normal=null,this._tangent=null,this._position=$x,this._normal=$I,this._tangent=$z}$_($x,"laya.d3.graphics.VertexPositionNormalSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(40,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector4",5)])}]),$x}(),$Sx=function(){function $x($x,$I,$z){this._position=null,this._normal=null,this._tangent=null,this._position=$x,this._normal=$I,this._tangent=$z}$_($x,"laya.d3.graphics.VertexPositionNormalTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(36,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector3",5)])}]),$x}(),$Zx=function(){function $x($x,$I,$z){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z}$_($x,"laya.d3.graphics.VertexPositionNormalTexture");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(32,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2)])}]),$x}(),$Ux=function(){function $x($x,$I,$z,$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$x,this._normal=$I,this._textureCoordinate0=$z,this._textureCoordinate1=$k}$_($x,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(40,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector2",15)])}]),$x}(),$Xx=function(){function $x($x,$I,$z,$k,$l,$n){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$x,this._normal=$I,this._textureCoordinate0=$z,this._textureCoordinate1=$k,this._blendIndex=$l,this._blendWeight=$n}$_($x,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(72,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector2",15),new $ax(40,"vector4",7),new $ax(56,"vector4",6)])}]),$x}(),$dx=function(){function $x($x,$I,$z,$k,$l,$n,$a){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._textureCoordinate0=$z,this._textureCoordinate1=$k,this._tangent=$l,this._blendIndex=$n,this._blendWeight=$a}$_($x,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(88,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector2",15),new $ax(40,"vector4",7),new $ax(56,"vector4",6),new $ax(72,"vector4",5)])}]),$x}(),$jx=function(){function $x(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$_($x,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$I.VertexPositionNormalTexture0SkinTangent=function($x,$I,$z,$k,$l,$n,$a){this._position=$x,this._normal=$I,this._textureCoordinate0=$z,this._textureCoordinate1=$k,this._tangent=$l,this._blendIndex=$n,this._blendWeight=$a},$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(84,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector2",15),new $ax(40,"vector4",7),new $ax(56,"vector4",6),new $ax(72,"vector3",5)])}]),$x}(),$tx=function(){function $x($x,$I,$z,$k,$l){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$x,this._normal=$I,this._textureCoordinate0=$z,this._textureCoordinate1=$k,this._tangent=$l}$_($x,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(56,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector2",15),new $ax(40,"vector4",5)])}]),$x}(),$Yx=function(){function $x(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$_($x,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$I.VertexPositionNormalTexture0Tangent=function($x,$I,$z,$k,$l){this._position=$x,this._normal=$I,this._textureCoordinate0=$z,this._textureCoordinate1=$k,this._tangent=$l},$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(52,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector2",15),new $ax(40,"vector3",5)])}]),$x}(),$cx=function(){function $x($x,$I,$z,$k,$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z,this._blendIndex=$k,this._blendWeight=$l}$_($x,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(64,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector4",7),new $ax(48,"vector4",6)])}]),$x}(),$Vx=function(){function $x($x,$I,$z,$k,$l,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z,this._tangent=$k,this._blendIndex=$l,this._blendWeight=$n}$_($x,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(80,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector4",7),new $ax(48,"vector4",6),new $ax(64,"vector4",5)])}]),$x}(),$Wx=function(){function $x($x,$I,$z,$k,$l,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z,this._tangent=$k,this._blendIndex=$l,this._blendWeight=$n}$_($x,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(76,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector4",7),new $ax(48,"vector4",6),new $ax(64,"vector3",5)])}]),$x}(),$qx=function(){function $x($x,$I,$z,$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z,this._tangent=$k}$_($x,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(48,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector4",5)])}]),$x}(),$ox=function(){function $x($x,$I,$z,$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z,this._tangent=$k}$_($x,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(44,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector3",5)])}]),$x}(),$Jx=function(){function $x($x,$I,$z){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z}$_($x,"laya.d3.graphics.VertexPositionNTBTexture");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(56,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector3",5),new $ax(36,"vector3",4),new $ax(48,"vector2",2)])}]),$x}(),$hx=function(){function $x($x,$I,$z,$k,$l,$n,$a,$$){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$x,this._normal=$I,this._textureCoordinate0=$k,this._textureCoordinate1=$l,this._tangent=$n,$z=$z,this._blendIndex=$a,this._blendWeight=$$}$_($x,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"tangent",function(){return this._tangent}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(0,$I,"textureCoordinate1",function(){return this._textureCoordinate1}),$R(0,$I,"blendIndex",function(){return this._blendIndex}),$R(0,$I,"blendWeight",function(){return this._blendWeight}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(96,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector3",5),new $ax(36,"vector3",4),new $ax(48,"vector2",2),new $ax(56,"vector2",15),new $ax(64,"vector4",7),new $ax(80,"vector4",6)])}]),$x}(),$Bx=function(){function $x($x,$I,$z){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$x,this._normal=$I,this._textureCoordinate=$z}$_($x,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"textureCoordinate",function(){return this._textureCoordinate}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(88,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector3",5),new $ax(36,"vector3",4),new $ax(48,"vector2",2),new $ax(56,"vector4",7),new $ax(72,"vector4",6)])}]),$x}(),$ex=(function(){function $x($x,$I,$z,$k){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$x,this._normal=$I,this._textureCoord0=$z,this._textureCoord1=$k}$_($x,"laya.d3.graphics.VertexPositionTerrain");var $I=$x.prototype;$C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"normal",function(){return this._normal}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoord0",function(){return this._textureCoord0}),$R(0,$I,"textureCoord1",function(){return this._textureCoord1}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(40,[new $ax(0,"vector3",0),new $ax(12,"vector3",3),new $ax(24,"vector2",2),new $ax(32,"vector2",15)])}])}(),function(){function $x($x,$I){this._position=null,this._textureCoordinate0=null,this._position=$x,this._textureCoordinate0=$I}$_($x,"laya.d3.graphics.VertexPositionTexture0");var $I=$x.prototype;return $C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"position",function(){return this._position}),$R(0,$I,"textureCoordinate0",function(){return this._textureCoordinate0}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(20,[new $ax(0,"vector3",0),new $ax(12,"vector2",2)])}]),$x}()),$Ax=(function(){function $x($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b,$T,$_){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$x,this._positionStartLifeTime=$I,this._velocity=$z,this._startColor=$k,this._startSize=$l,this._startRotation0=$n,this._startRotation1=$a,this._startRotation2=$$,this._startLifeTime=$w,this._time=$i,this._startSpeed=$F,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$_}$_($x,"laya.d3.graphics.VertexShurikenParticleBillboard");var $I=$x.prototype;$C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$R(0,$I,"random1",function(){return this._randoms1}),$R(0,$I,"startRotation2",function(){return this._startRotation2}),$R(0,$I,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$R(0,$I,"velocity",function(){return this._velocity}),$R(0,$I,"random0",function(){return this._randoms0}),$R(0,$I,"startSize",function(){return this._startSize}),$R(0,$I,"startColor",function(){return this._startColor}),$R(0,$I,"startRotation0",function(){return this._startRotation0}),$R(0,$I,"startRotation1",function(){return this._startRotation1}),$R(0,$I,"startLifeTime",function(){return this._startLifeTime}),$R(0,$I,"time",function(){return this._time}),$R(0,$I,"startSpeed",function(){return this._startSpeed}),$R(0,$I,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(152,[new $ax(0,"vector4",17),new $ax(16,"vector4",30),new $ax(32,"vector4",32),new $ax(48,"vector4",19),new $ax(64,"vector3",20),new $ax(76,"vector3",22),new $ax(88,"single",31),new $ax(92,"vector4",34),new $ax(108,"vector4",35),new $ax(124,"vector3",36),new $ax(136,"vector4",37)])}])}(),function(){function $x($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b,$T,$_){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$x,this._positionStartLifeTime=$I,this._velocity=$z,this._startColor=$k,this._startSize=$l,this._startRotation0=$n,this._startRotation1=$a,this._startRotation2=$$,this._startLifeTime=$w,this._time=$i,this._startSpeed=$F,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$_}$_($x,"laya.d3.graphics.VertexShurikenParticleMesh");var $I=$x.prototype;$C.imps($I,{"laya.d3.graphics.IVertex":!0}),$R(0,$I,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$R(0,$I,"velocity",function(){return this._velocity}),$R(0,$I,"position",function(){return this._positionStartLifeTime}),$R(0,$I,"random0",function(){return this._randoms0}),$R(0,$I,"startSize",function(){return this._startSize}),$R(0,$I,"startColor",function(){return this._startColor}),$R(0,$I,"startRotation0",function(){return this._startRotation0}),$R(0,$I,"startRotation1",function(){return this._startRotation1}),$R(0,$I,"random1",function(){return this._randoms1}),$R(0,$I,"startRotation2",function(){return this._startRotation2}),$R(0,$I,"startLifeTime",function(){return this._startLifeTime}),$R(0,$I,"time",function(){return this._time}),$R(0,$I,"startSpeed",function(){return this._startSpeed}),$R(0,$I,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$R(0,$I,"vertexDeclaration",function(){return $x._vertexDeclaration}),$R(1,$x,"vertexDeclaration",function(){return $x._vertexDeclaration}),$b($x,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nx(172,[new $ax(0,"vector3",0),new $ax(12,"vector4",1),new $ax(28,"vector2",2),new $ax(36,"vector4",30),new $ax(52,"vector4",32),new $ax(68,"vector4",19),new $ax(84,"vector3",20),new $ax(96,"vector3",22),new $ax(108,"single",31),new $ax(112,"vector4",34),new $ax(128,"vector4",35),new $ax(144,"vector3",36),new $ax(156,"vector4",37)])}])}(),function(){function $m($x,$I,$z,$k,$l,$n){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$z,this._materials=$k,this._subMeshes=$l,this._materialMap=$n,this._version=$I,this._onLoaded($x)}$_($m,"laya.d3.loaders.LoadModelV01");var $x=$m.prototype;return $x._onLoaded=function($x){this._readData=$x,this.READ_BLOCK();for(var $I=0;$I<this._BLOCK.count;$I++){var $z=this._readData.getUint16(),$k=this._strings[$z],$l=this["READ_"+$k];if(null==$l)throw new Error("model file err,no this function:"+$z+" "+$k);if(!$l.call(this))break}return this._mesh},$x.onError=function(){},$x._readString=function(){return this._strings[this._readData.getUint16()]},$x.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$x.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$x.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $x=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $I=0;$I<this._STRINGS.size;$I++)this._strings[$I]=this._readData.readUTFString();return this._readData.pos=$x,!0},$x.READ_MATERIAL=function(){var $x=this._readData.getUint16(),$I=(this._readString(),this._readString());return this._materials[$x]="null"!==$I?$D.getRes(this._materialMap[$I]):new $SI,!0},$x.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $x,$I=this._readData.__getBuffer(),$z=0,$k=this._readData.getUint32(),$l=this._readData.getUint32(),$n=(new Float32Array($I.slice($k+this._DATA.offset,$k+this._DATA.offset+$l)),this._readData.getUint32()),$a=this._readData.getUint32(),$$=new Float32Array($I.slice($n+this._DATA.offset,$n+this._DATA.offset+$a));for(this.mesh._inverseBindPoses=[],$z=0,$x=$$.length;$z<$x;$z+=16){var $w=new $xI($$[$z+0],$$[$z+1],$$[$z+2],$$[$z+3],$$[$z+4],$$[$z+5],$$[$z+6],$$[$z+7],$$[$z+8],$$[$z+9],$$[$z+10],$$[$z+11],$$[$z+12],$$[$z+13],$$[$z+14],$$[$z+15]);this.mesh._inverseBindPoses.push($w)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$x.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $x=this._readString();this._shaderAttributes=$x.match($m._attrReg);var $I=this._readData.getUint32(),$z=this._readData.getUint32(),$k=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$l=this._readData.getUint32(),$n=this._readData.getUint32(),$a=this._readData.getUint32(),$$=this._readData.__getBuffer(),$w=new $iI(this._mesh),$i=this._getVertexDeclaration(),$F=$WI.create($i,$l/$i.vertexStride,35044,!0),$b=$k+this._DATA.offset,$T=$$.slice($b,$b+$l);$F.setData(new Float32Array($T));for(var $_=($w._vertexBuffer=$F).vertexDeclaration.getVertexElements(),$R=0;$R<$_.length;$R++)$w._bufferUsage[$_[$R].elementUsage]=$F;var $s=$VI.create("ushort",$z/2,35044,!0),$N=$I+this._DATA.offset,$D=$$.slice($N,$N+$z);$s.setData(new Uint16Array($D)),$w._indexBuffer=$s;var $f=$$.slice($n+this._DATA.offset,$n+this._DATA.offset+$a);return $w._boneIndicesList[0]=new Uint8Array($f),this._subMeshes.push($w),!0},$x.READ_DATAAREA=function(){return!1},$x._getVertexDeclaration=function(){for(var $x,$I=!1,$z=!1,$k=!1,$l=!1,$n=!1,$a=!1,$$=!1,$w=!1,$i=!1,$F=0;$F<this._shaderAttributes.length;$F+=8)switch(this._shaderAttributes[$F]){case"POSITION":$I=!0;break;case"NORMAL":$z=!0;break;case"COLOR":$k=!0;break;case"UV":$l=!0;break;case"UV1":$n=!0;break;case"BLENDWEIGHT":$$=!0;break;case"BLENDINDICES":$w=!0;break;case"TANGENT":$a=!0;break;case"BINORMAL":$i=!0}return $I&&$z&&$k&&$l&&$n&&$$&&$w&&$a?$x=$mx.vertexDeclaration:$I&&$z&&$k&&$l&&$n&&$$&&$w?$x=$Dx.vertexDeclaration:$I&&$z&&$l&&$n&&$$&&$w&&$a?$x=$jx.vertexDeclaration:$I&&$z&&$l&&$n&&$$&&$w?$x=$Xx.vertexDeclaration:$I&&$z&&$k&&$l&&$$&&$w&&$a?$x=$Lx.vertexDeclaration:$I&&$z&&$k&&$l&&$$&&$w?$x=$Px.vertexDeclaration:$I&&$z&&$a&&$i&&$l&&$$&&$w?$x=$Bx.vertexDeclaration:$I&&$z&&$l&&$$&&$w&&$a?$x=$Wx.vertexDeclaration:$I&&$z&&$l&&$$&&$w?$x=$cx.vertexDeclaration:$I&&$z&&$k&&$$&&$w&&$a?$x=$Tx.vertexDeclaration:$I&&$z&&$k&&$$&&$w?$x=$Fx.vertexDeclaration:$I&&$z&&$k&&$l&&$n&&$a?$x=$Cx.vertexDeclaration:$I&&$z&&$k&&$l&&$n?$x=$Nx.vertexDeclaration:$I&&$z&&$l&&$n&&$a?$x=$Yx.vertexDeclaration:$I&&$z&&$l&&$n?$x=$Ux.vertexDeclaration:$I&&$z&&$k&&$l&&$a?$x=$Ex.vertexDeclaration:$I&&$z&&$l&&$a&&$i?$x=$Jx.vertexDeclaration:$I&&$z&&$k&&$l?$x=$sx.vertexDeclaration:$I&&$z&&$l&&$a?$x=$ox.vertexDeclaration:$I&&$z&&$l?$x=$Zx.vertexDeclaration:$I&&$z&&$k&&$a?$x=$Rx.vertexDeclaration:$I&&$z&&$k&&($x=$ix.vertexDeclaration),$x},$R(0,$x,"mesh",function(){return this._mesh}),$m._attrReg=new RegExp("(\\w+)|([:,;])","g"),$m}()),$Hx=function(){function $v(){}return $_($v,"laya.d3.loaders.LoadModelV02"),$v.parse=function($x,$I,$z,$k,$l,$n){$v._mesh=$z,$v._materials=$k,$v._subMeshes=$l,$v._materialMap=$n,$v._version=$I,$v._readData=$x,$v.READ_DATA(),$v.READ_BLOCK(),$v.READ_STRINGS();for(var $a=0,$$=$v._BLOCK.count;$a<$$;$a++){$v._readData.pos=$v._BLOCK.blockStarts[$a];var $w=$v._readData.getUint16(),$i=$v._strings[$w],$F=$v["READ_"+$i];if(null==$F)throw new Error("model file err,no this function:"+$w+" "+$i);$F.call()}$v._strings.length=0,$v._readData=null,$v._version=null,$v._mesh=null,$v._materials=null,$v._subMeshes=null,$v._materialMap=null},$v._readString=function(){return $v._strings[$v._readData.getUint16()]},$v.READ_DATA=function(){$v._DATA.offset=$v._readData.getUint32(),$v._DATA.size=$v._readData.getUint32()},$v.READ_BLOCK=function(){for(var $x=$v._BLOCK.count=$v._readData.getUint16(),$I=$v._BLOCK.blockStarts=[],$z=$v._BLOCK.blockLengths=[],$k=0;$k<$x;$k++)$I.push($v._readData.getUint32()),$z.push($v._readData.getUint32())},$v.READ_STRINGS=function(){var $x=$v._readData.getUint32(),$I=$v._readData.getUint16(),$z=$v._readData.pos;$v._readData.pos=$x+$v._DATA.offset;for(var $k=0;$k<$I;$k++)$v._strings[$k]=$v._readData.readUTFString();$v._readData.pos=$z},$v.READ_MATERIAL=function(){$v._readString(),$v._readString();var $x=$v._readString();return""!==$x&&$v._materials.push($D.getRes($v._materialMap[$x])),!0},$v.READ_MESH=function(){$v._readString();var $x,$I=$v._readData.__getBuffer(),$z=0,$k=$v._readData.getInt16(),$l=$v._DATA.offset;for($z=0;$z<$k;$z++){var $n=$l+$v._readData.getUint32(),$a=$v._readData.getUint32(),$$=new Float32Array($I.slice($n,$n+$a)),$w=$v._readString().match($v._attrReg),$i=$v._getVertexDeclaration($w),$F=$WI.create($i,4*$$.length/$i.vertexStride,35044,!0);$F.setData($$),$v._mesh._vertexBuffers.push($F)}var $b=$l+$v._readData.getUint32(),$T=$v._readData.getUint32(),$_=new Uint16Array($I.slice($b,$b+$T)),$R=$VI.create("ushort",$T/2,35044,!0);$R.setData($_),$v._mesh._indexBuffer=$R;var $s=$v._mesh._boneNames=[],$N=$v._readData.getUint16();for($s.length=$N,$z=0;$z<$N;$z++)$s[$z]=$v._strings[$v._readData.getUint16()];var $D=$v._readData.getUint32(),$f=$v._readData.getUint32(),$m=(new Float32Array($I.slice($l+$D,$l+$D+$f)),$v._readData.getUint32()),$y=$v._readData.getUint32(),$C=new Float32Array($I.slice($l+$m,$l+$m+$y));for($v._mesh._inverseBindPoses=[],$z=0,$x=$C.length;$z<$x;$z+=16){var $P=new $xI($C[$z+0],$C[$z+1],$C[$z+2],$C[$z+3],$C[$z+4],$C[$z+5],$C[$z+6],$C[$z+7],$C[$z+8],$C[$z+9],$C[$z+10],$C[$z+11],$C[$z+12],$C[$z+13],$C[$z+14],$C[$z+15]);$v._mesh._inverseBindPoses.push($P)}return $v._mesh._skinnedDatas=new Float32Array(16*$C.length),!0},$v.READ_SUBMESH=function(){var $x=$v._readData.__getBuffer(),$I=new $iI($v._mesh),$z=$v._readData.getInt16(),$k=$v._readData.getUint32(),$l=$v._readData.getUint32();$I._vertexBuffer=$v._mesh._vertexBuffers[$z],$I._vertexStart=$k,$I._vertexCount=$l;var $n=$v._readData.getUint32(),$a=$v._readData.getUint32(),$$=$v._mesh._indexBuffer;$I._indexBuffer=$$,$I._indexStart=$n,$I._indexCount=$a,$I._indices=new Uint16Array($$.getData().buffer,2*$n,$a);var $w=$v._DATA.offset,$i=$I._subIndexBufferStart,$F=$I._subIndexBufferCount,$b=$I._boneIndicesList,$T=$v._readData.getUint16();$i.length=$T,$F.length=$T,$b.length=$T;for(var $_=0;$_<$T;$_++){$i[$_]=$v._readData.getUint32(),$F[$_]=$v._readData.getUint32();var $R=$v._readData.getUint32(),$s=$v._readData.getUint32();$I._boneIndicesList[$_]=new Uint8Array($x.slice($w+$R,$w+$R+$s))}return $v._subMeshes.push($I),!0},$v._getVertexDeclaration=function($x){for(var $I,$z=!1,$k=!1,$l=!1,$n=!1,$a=!1,$$=!1,$w=!1,$i=!1,$F=!1,$b=0;$b<$x.length;$b++)switch($x[$b]){case"POSITION":$z=!0;break;case"NORMAL":$k=!0;break;case"COLOR":$l=!0;break;case"UV":$n=!0;break;case"UV1":$a=!0;break;case"BLENDWEIGHT":$w=!0;break;case"BLENDINDICES":$i=!0;break;case"TANGENT":$$=!0;break;case"BINORMAL":$F=!0}return $z&&$k&&$l&&$n&&$a&&$w&&$i&&$$?$I=$mx.vertexDeclaration:$z&&$k&&$l&&$n&&$a&&$w&&$i?$I=$Dx.vertexDeclaration:$z&&$k&&$n&&$a&&$w&&$i&&$$?$I=$jx.vertexDeclaration:$z&&$k&&$n&&$a&&$w&&$i?$I=$Xx.vertexDeclaration:$z&&$k&&$l&&$n&&$w&&$i&&$$?$I=$Lx.vertexDeclaration:$z&&$k&&$l&&$n&&$w&&$i?$I=$Px.vertexDeclaration:$z&&$k&&$n&&$w&&$i&&$$?$I=$Wx.vertexDeclaration:$z&&$k&&$n&&$w&&$i?$I=$cx.vertexDeclaration:$z&&$k&&$l&&$w&&$i&&$$?$I=$Tx.vertexDeclaration:$z&&$k&&$l&&$w&&$i?$I=$Fx.vertexDeclaration:$z&&$k&&$l&&$n&&$a&&$$?$I=$Cx.vertexDeclaration:$z&&$k&&$l&&$n&&$a?$I=$Nx.vertexDeclaration:$z&&$k&&$n&&$a&&$$?$I=$Yx.vertexDeclaration:$z&&$k&&$n&&$a?$I=$Ux.vertexDeclaration:$z&&$k&&$l&&$n&&$$?$I=$Ex.vertexDeclaration:$z&&$k&&$n&&$$&&$F?$I=$Jx.vertexDeclaration:$z&&$k&&$l&&$n?$I=$sx.vertexDeclaration:$z&&$k&&$n&&$$?$I=$ox.vertexDeclaration:$z&&$k&&$n?$I=$Zx.vertexDeclaration:$z&&$k&&$l&&$$?$I=$Rx.vertexDeclaration:$z&&$k&&$l&&($I=$ix.vertexDeclaration),$I},$v._attrReg=new RegExp("(\\w+)|([:,;])","g"),$v._strings=[],$v._readData=null,$v._version=null,$v._mesh=null,$v._materials=null,$v._subMeshes=null,$v._materialMap=null,$b($v,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$v}(),$px=function(){function $P(){}return $_($P,"laya.d3.loaders.LoadModelV03"),$P.parse=function($x,$I,$z,$k,$l){$P._mesh=$z,$P._subMeshes=$k,$P._materialMap=$l,$P._version=$I,$P._readData=$x,$P.READ_DATA(),$P.READ_BLOCK(),$P.READ_STRINGS();for(var $n=0,$a=$P._BLOCK.count;$n<$a;$n++){$P._readData.pos=$P._BLOCK.blockStarts[$n];var $$=$P._readData.getUint16(),$w=$P._strings[$$],$i=$P["READ_"+$w];if(null==$i)throw new Error("model file err,no this function:"+$$+" "+$w);$i.call()}$P._strings.length=0,$P._readData=null,$P._version=null,$P._mesh=null,$P._subMeshes=null,$P._materialMap=null},$P._readString=function(){return $P._strings[$P._readData.getUint16()]},$P.READ_DATA=function(){$P._DATA.offset=$P._readData.getUint32(),$P._DATA.size=$P._readData.getUint32()},$P.READ_BLOCK=function(){for(var $x=$P._BLOCK.count=$P._readData.getUint16(),$I=$P._BLOCK.blockStarts=[],$z=$P._BLOCK.blockLengths=[],$k=0;$k<$x;$k++)$I.push($P._readData.getUint32()),$z.push($P._readData.getUint32())},$P.READ_STRINGS=function(){var $x=$P._readData.getUint32(),$I=$P._readData.getUint16(),$z=$P._readData.pos;$P._readData.pos=$x+$P._DATA.offset;for(var $k=0;$k<$I;$k++)$P._strings[$k]=$P._readData.readUTFString();$P._readData.pos=$z},$P.READ_MESH=function(){var $x,$I=$P._readString(),$z=$P._readData.__getBuffer(),$k=0,$l=$P._readData.getInt16(),$n=$P._DATA.offset;for($k=0;$k<$l;$k++){var $a,$$=$n+$P._readData.getUint32(),$w=$P._readData.getUint32(),$i=new Float32Array($z.slice($$,$$+$w)),$F=$P._readString();switch($P._version){case"LAYAMODEL:03":$a=$P._vertexDeclarationMap_Discard[$F];break;case"LAYAMODEL:0301":$a=$P._vertexDeclarationMap[$F];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$a)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$P._version+"  bufferAttribute="+$F+"  name="+$I+"  url="+($P._mesh?$P._mesh.url:"null"));var $b=$WI.create($a,4*$i.length/$a.vertexStride,35044,!0,$P._mesh._url+"_"+$k);$b.setData($i),$P._mesh._vertexBuffers.push($b)}var $T=$n+$P._readData.getUint32(),$_=$P._readData.getUint32(),$R=new Uint16Array($z.slice($T,$T+$_)),$s=$VI.create("ushort",$_/2,35044,!0,$P._mesh._url);$s.setData($R),$P._mesh._indexBuffer=$s;var $N=$P._mesh._boneNames=[],$D=$P._readData.getUint16();for($N.length=$D,$k=0;$k<$D;$k++)$N[$k]=$P._strings[$P._readData.getUint16()];$P._readData.pos+=8;var $f=$P._readData.getUint32(),$m=$P._readData.getUint32(),$y=new Float32Array($z.slice($n+$f,$n+$f+$m));for($P._mesh._inverseBindPoses=[],$k=0,$x=$y.length;$k<$x;$k+=16){var $C=new $xI($y[$k+0],$y[$k+1],$y[$k+2],$y[$k+3],$y[$k+4],$y[$k+5],$y[$k+6],$y[$k+7],$y[$k+8],$y[$k+9],$y[$k+10],$y[$k+11],$y[$k+12],$y[$k+13],$y[$k+14],$y[$k+15]);$P._mesh._inverseBindPoses.push($C)}return $P._mesh._skinnedDatas=new Float32Array(16*$y.length),!0},$P.READ_SUBMESH=function(){var $x=$P._readData.__getBuffer(),$I=new $iI($P._mesh),$z=$P._readData.getInt16(),$k=$P._readData.getUint32(),$l=$P._readData.getUint32();$I._vertexBuffer=$P._mesh._vertexBuffers[$z],$I._vertexStart=$k,$I._vertexCount=$l;var $n=$P._readData.getUint32(),$a=$P._readData.getUint32(),$$=$P._mesh._indexBuffer;$I._indexBuffer=$$,$I._indexStart=$n,$I._indexCount=$a,$I._indices=new Uint16Array($$.getData().buffer,2*$n,$a);var $w=$P._DATA.offset,$i=$I._subIndexBufferStart,$F=$I._subIndexBufferCount,$b=$I._boneIndicesList,$T=$P._readData.getUint16();$i.length=$T,$F.length=$T,$b.length=$T;for(var $_=0;$_<$T;$_++){$i[$_]=$P._readData.getUint32(),$F[$_]=$P._readData.getUint32();var $R=$P._readData.getUint32(),$s=$P._readData.getUint32();$b[$_]=new Uint8Array($x.slice($w+$R,$w+$R+$s))}return $P._subMeshes.push($I),!0},$P._strings=[],$P._readData=null,$P._version=null,$P._mesh=null,$P._subMeshes=null,$P._materialMap=null,$b($P,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$mx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Dx.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$hx.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$jx.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Xx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Lx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Px.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Wx.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$cx.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$Tx.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$Fx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$Cx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$Nx.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$Yx.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Ux.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$Ex.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Jx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$sx.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$ox.vertexDeclaration,"POSITION,NORMAL,UV":$Zx.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$Rx.vertexDeclaration,"POSITION,NORMAL,COLOR":$ix.vertexDeclaration,"POSITION,NORMAL,TANGENT":$Sx.vertexDeclaration,"POSITION,NORMAL":$wx.vertexDeclaration,"POSITION,UV":$ex.vertexDeclaration,POSITION:$$x.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$fx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Dx.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$hx.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$dx.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Xx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$vx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Px.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Vx.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$cx.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$bx.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$Fx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$yx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$Nx.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$tx.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Ux.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$Kx.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Jx.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$sx.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$qx.vertexDeclaration,"POSITION,NORMAL,UV":$Zx.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$_x.vertexDeclaration,"POSITION,NORMAL,COLOR":$ix.vertexDeclaration,"POSITION,NORMAL,TANGENT":$Ox.vertexDeclaration,"POSITION,NORMAL":$wx.vertexDeclaration,"POSITION,UV":$ex.vertexDeclaration,POSITION:$$x.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$P}(),$ux=function(){function $$(){}return $_($$,"laya.d3.loaders.MeshReader"),$$.read=function($x,$I,$z,$k,$l){var $n=new $P($x);$n.pos=0;var $a=$n.readUTFString();switch($a){case"LAYAMODEL:01":case"LAYASKINANI:01":$$._readVersion01($n,$a,$I,$z,$k,$l);break;case"LAYAMODEL:02":$Hx.parse($n,$a,$I,$z,$k,$l);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$px.parse($n,$a,$I,$k,$l);break;default:throw new Error("MeshReader: unknown mesh version.")}$I._setSubMeshes($k)},$$._readVersion01=function($x,$I,$z,$k,$l,$n){new $Ax($x,$I,$z,$k,$l,$n)},$$}(),$rx=function(){function $x($x,$I){this.min=null,this.max=null,this.min=$x,this.max=$I}$_($x,"laya.d3.math.BoundBox");var $I=$x.prototype;return $C.imps($I,{"laya.d3.core.IClone":!0}),$I.getCorners=function($x){$x.length=8;var $I=this.min.elements,$z=this.max.elements,$k=$I[0],$l=$I[1],$n=$I[2],$a=$z[0],$$=$z[1],$w=$z[2];$x[0]=new $aI($k,$$,$w),$x[1]=new $aI($a,$$,$w),$x[2]=new $aI($a,$l,$w),$x[3]=new $aI($k,$l,$w),$x[4]=new $aI($k,$$,$n),$x[5]=new $aI($a,$$,$n),$x[6]=new $aI($a,$l,$n),$x[7]=new $aI($k,$l,$n)},$I.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$I.cloneTo=function($x){var $I=$x;this.min.cloneTo($I.min),this.max.cloneTo($I.max)},$I.clone=function(){var $x=new this.constructor(new $aI,new $aI);return this.cloneTo($x),$x},$x.createfromPoints=function($x,$I){if(null==$x)throw new Error("points");var $z=$I.min,$k=$I.max,$l=$z.elements;$l[0]=Number.MAX_VALUE,$l[1]=Number.MAX_VALUE,$l[2]=Number.MAX_VALUE;var $n=$k.elements;$n[0]=-Number.MAX_VALUE,$n[1]=-Number.MAX_VALUE,$n[2]=-Number.MAX_VALUE;for(var $a=0,$$=$x.length;$a<$$;++$a)$aI.min($z,$x[$a],$z),$aI.max($k,$x[$a],$k)},$x.merge=function($x,$I,$z){$aI.min($x.min,$I.min,$z.min),$aI.max($x.max,$I.max,$z.max)},$x}(),$gx=function(){function $i($x){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$x,this._near=new $II(new $aI),this._far=new $II(new $aI),this._left=new $II(new $aI),this._right=new $II(new $aI),this._top=new $II(new $aI),this._bottom=new $II(new $aI),$i._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$_($i,"laya.d3.math.BoundFrustum");var $x=$i.prototype;return $x.equalsBoundFrustum=function($x){return this._matrix.equalsOtherMatrix($x.matrix)},$x.equalsObj=function($x){if($x instanceof laya.d3.math.BoundFrustum){var $I=$x;return this.equalsBoundFrustum($I)}return!1},$x.getPlane=function($x){switch($x){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$x.getCorners=function($x){$i._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($x[0]),$i._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($x[1]),$i._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($x[2]),$i._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($x[3]),$i._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($x[4]),$i._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($x[5]),$i._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($x[6]),$i._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($x[7])},$x.containsPoint=function($x){for(var $I=$II.PlaneIntersectionType_Front,$z=$II.PlaneIntersectionType_Front,$k=0;$k<6;$k++){switch($k){case 0:$z=Collision.intersectsPlaneAndPoint(this._near,$x);break;case 1:$z=Collision.intersectsPlaneAndPoint(this._far,$x);break;case 2:$z=Collision.intersectsPlaneAndPoint(this._left,$x);break;case 3:$z=Collision.intersectsPlaneAndPoint(this._right,$x);break;case 4:$z=Collision.intersectsPlaneAndPoint(this._top,$x);break;case 5:$z=Collision.intersectsPlaneAndPoint(this._bottom,$x)}switch($z){case $II.PlaneIntersectionType_Back:return 0;case $II.PlaneIntersectionType_Intersecting:$I=$II.PlaneIntersectionType_Intersecting}}switch($I){case $II.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$x.containsBoundBox=function($x){for(var $I,$z=$i._tempV30,$k=$i._tempV31,$l=1,$n=0;$n<6;$n++){if($I=this.getPlane($n),this._getBoxToPlanePVertexNVertex($x,$I.normal,$z,$k),Collision.intersectsPlaneAndPoint($I,$z)===$II.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($I,$k)===$II.PlaneIntersectionType_Back&&($l=2)}return $l},$x.containsBoundSphere=function($x){for(var $I=$II.PlaneIntersectionType_Front,$z=$II.PlaneIntersectionType_Front,$k=0;$k<6;$k++){switch($k){case 0:$z=Collision.intersectsPlaneAndSphere(this._near,$x);break;case 1:$z=Collision.intersectsPlaneAndSphere(this._far,$x);break;case 2:$z=Collision.intersectsPlaneAndSphere(this._left,$x);break;case 3:$z=Collision.intersectsPlaneAndSphere(this._right,$x);break;case 4:$z=Collision.intersectsPlaneAndSphere(this._top,$x);break;case 5:$z=Collision.intersectsPlaneAndSphere(this._bottom,$x)}switch($z){case $II.PlaneIntersectionType_Back:return 0;case $II.PlaneIntersectionType_Intersecting:$I=$II.PlaneIntersectionType_Intersecting}}switch($I){case $II.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$x._getBoxToPlanePVertexNVertex=function($x,$I,$z,$k){var $l=$x.min,$n=$l.elements,$a=$x.max,$$=$a.elements,$w=$I.elements,$i=$w[0],$F=$w[1],$b=$w[2];$l.cloneTo($z);var $T=$z.elements;0<=$i&&($T[0]=$$[0]),0<=$F&&($T[1]=$$[1]),0<=$b&&($T[2]=$$[2]),$a.cloneTo($k);var $_=$k.elements;0<=$i&&($_[0]=$n[0]),0<=$F&&($_[1]=$n[1]),0<=$b&&($_[2]=$n[2])},$R(0,$x,"top",function(){return this._top}),$R(0,$x,"matrix",function(){return this._matrix},function($x){this._matrix=$x,$i._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$R(0,$x,"near",function(){return this._near}),$R(0,$x,"far",function(){return this._far}),$R(0,$x,"left",function(){return this._left}),$R(0,$x,"right",function(){return this._right}),$R(0,$x,"bottom",function(){return this._bottom}),$i._getPlanesFromMatrix=function($x,$I,$z,$k,$l,$n,$a){var $$=$x.elements,$w=$$[0],$i=$$[1],$F=$$[2],$b=$$[3],$T=$$[4],$_=$$[5],$R=$$[6],$s=$$[7],$N=$$[8],$D=$$[9],$f=$$[10],$m=$$[11],$y=$$[12],$C=$$[13],$P=$$[14],$v=$$[15],$L=$I.normal.elements;$L[0]=$b+$F,$L[1]=$s+$R,$L[2]=$m+$f,$I.distance=$v+$P,$I.normalize();var $K=$z.normal.elements;$K[0]=$b-$F,$K[1]=$s-$R,$K[2]=$m-$f,$z.distance=$v-$P,$z.normalize();var $E=$k.normal.elements;$E[0]=$b+$w,$E[1]=$s+$T,$E[2]=$m+$N,$k.distance=$v+$y,$k.normalize();var $O=$l.normal.elements;$O[0]=$b-$w,$O[1]=$s-$T,$O[2]=$m-$N,$l.distance=$v-$y,$l.normalize();var $S=$n.normal.elements;$S[0]=$b-$i,$S[1]=$s-$_,$S[2]=$m-$D,$n.distance=$v-$C,$n.normalize();var $Z=$a.normal.elements;$Z[0]=$b+$i,$Z[1]=$s+$_,$Z[2]=$m+$D,$a.distance=$v+$C,$a.normalize()},$i._get3PlaneInterPoint=function($x,$I,$z){var $k=$x.normal,$l=$I.normal,$n=$z.normal;$aI.cross($l,$n,$i._tempV30),$aI.cross($n,$k,$i._tempV31),$aI.cross($k,$l,$i._tempV32);var $a=$aI.dot($k,$i._tempV30),$$=$aI.dot($l,$i._tempV31),$w=$aI.dot($n,$i._tempV32);return $aI.scale($i._tempV30,-$x.distance/$a,$i._tempV33),$aI.scale($i._tempV31,-$I.distance/$$,$i._tempV34),$aI.scale($i._tempV32,-$z.distance/$w,$i._tempV35),$aI.add($i._tempV33,$i._tempV34,$i._tempV36),$aI.add($i._tempV35,$i._tempV36,$i._tempV37),$i._tempV37},$b($i,["_tempV30",function(){return this._tempV30=new $aI},"_tempV31",function(){return this._tempV31=new $aI},"_tempV32",function(){return this._tempV32=new $aI},"_tempV33",function(){return this._tempV33=new $aI},"_tempV34",function(){return this._tempV34=new $aI},"_tempV35",function(){return this._tempV35=new $aI},"_tempV36",function(){return this._tempV36=new $aI},"_tempV37",function(){return this._tempV37=new $aI}]),$i}(),$Mx=function(){function $F($x,$I){this.center=null,this.radius=NaN,this.center=$x,this.radius=$I}$_($F,"laya.d3.math.BoundSphere");var $x=$F.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.toDefault=function(){this.center.toDefault(),this.radius=0},$x.intersectsRayDistance=function($x){return Collision.intersectsRayAndSphereRD($x,this)},$x.intersectsRayPoint=function($x,$I){return Collision.intersectsRayAndSphereRP($x,this,$I)},$x.cloneTo=function($x){var $I=$x;this.center.cloneTo($I.center),$I.radius=this.radius},$x.clone=function(){var $x=new this.constructor(new $aI,new $aI);return this.cloneTo($x),$x},$F.createFromSubPoints=function($x,$I,$z,$k){if(null==$x)throw new Error("points");if($I<0||$I>=$x.length)throw new Error("start"+$I+"Must be in the range [0, "+($x.length-1)+"]");if($z<0||$I+$z>$x.length)throw new Error("count"+$z+"Must be in the range <= "+$x.length+"}");var $l=$I+$z,$n=$F._tempVector3;$n.elements[0]=0,$n.elements[1]=0,$n.elements[2]=0;for(var $a=$I;$a<$l;++$a)$aI.add($x[$a],$n,$n);var $$=$k.center;$aI.scale($n,1/$z,$$);var $w=0;for($a=$I;$a<$l;++$a){var $i=$aI.distanceSquared($$,$x[$a]);$w<$i&&($w=$i)}$k.radius=Math.sqrt($w)},$F.createfromPoints=function($x,$I){if(null==$x)throw new Error("points");$F.createFromSubPoints($x,0,$x.length,$I)},$b($F,["_tempVector3",function(){return this._tempVector3=new $aI}]),$F}(),$Qx=(function(){function $x(){}$_($x,"laya.d3.math.ContainmentType"),$x.Disjoint=0,$x.Contains=1,$x.Intersects=2}(),function(){function $z(){}return $_($z,"laya.d3.math.MathUtils3D"),$z.isZero=function($x){return Math.abs($x)<$z.zeroTolerance},$z.nearEqual=function($x,$I){return!!$z.isZero($x-$I)},$z.fastInvSqrt=function($x){return $z.isZero($x)?$x:1/Math.sqrt($x)},$b($z,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$z}()),$Gx=function(){function $w(){var $x=this.elements=new Float32Array(9);$x[0]=1,$x[1]=0,$x[2]=0,$x[3]=0,$x[4]=1,$x[5]=0,$x[6]=0,$x[7]=0,$x[8]=1}$_($w,"laya.d3.math.Matrix3x3");var $x=$w.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.determinant=function(){var $x=this.elements,$I=$x[0],$z=$x[1],$k=$x[2],$l=$x[3],$n=$x[4],$a=$x[5],$$=$x[6],$w=$x[7],$i=$x[8];return $I*($i*$n-$a*$w)+$z*(-$i*$l+$a*$$)+$k*($w*$l-$n*$$)},$x.translate=function($x,$I){var $z=$I.elements,$k=this.elements,$l=$x.elements,$n=$k[0],$a=$k[1],$$=$k[2],$w=$k[3],$i=$k[4],$F=$k[5],$b=$k[6],$T=$k[7],$_=$k[8],$R=$l[0],$s=$l[1];$z[0]=$n,$z[1]=$a,$z[2]=$$,$z[3]=$w,$z[4]=$i,$z[5]=$F,$z[6]=$R*$n+$s*$w+$b,$z[7]=$R*$a+$s*$i+$T,$z[8]=$R*$$+$s*$F+$_},$x.rotate=function($x,$I){var $z=$I.elements,$k=this.elements,$l=$k[0],$n=$k[1],$a=$k[2],$$=$k[3],$w=$k[4],$i=$k[5],$F=$k[6],$b=$k[7],$T=$k[8],$_=Math.sin($x),$R=Math.cos($x);$z[0]=$R*$l+$_*$$,$z[1]=$R*$n+$_*$w,$z[2]=$R*$a+$_*$i,$z[3]=$R*$$-$_*$l,$z[4]=$R*$w-$_*$n,$z[5]=$R*$i-$_*$a,$z[6]=$F,$z[7]=$b,$z[8]=$T},$x.scale=function($x,$I){var $z=$I.elements,$k=this.elements,$l=$x.elements,$n=$l[0],$a=$l[1];$z[0]=$n*$k[0],$z[1]=$n*$k[1],$z[2]=$n*$k[2],$z[3]=$a*$k[3],$z[4]=$a*$k[4],$z[5]=$a*$k[5],$z[6]=$k[6],$z[7]=$k[7],$z[8]=$k[8]},$x.invert=function($x){var $I=$x.elements,$z=this.elements,$k=$z[0],$l=$z[1],$n=$z[2],$a=$z[3],$$=$z[4],$w=$z[5],$i=$z[6],$F=$z[7],$b=$z[8],$T=$b*$$-$w*$F,$_=-$b*$a+$w*$i,$R=$F*$a-$$*$i,$s=$k*$T+$l*$_+$n*$R;$s||($x=null),$s=1/$s,$I[0]=$T*$s,$I[1]=(-$b*$l+$n*$F)*$s,$I[2]=($w*$l-$n*$$)*$s,$I[3]=$_*$s,$I[4]=($b*$k-$n*$i)*$s,$I[5]=(-$w*$k+$n*$a)*$s,$I[6]=$R*$s,$I[7]=(-$F*$k+$l*$i)*$s,$I[8]=($$*$k-$l*$a)*$s},$x.transpose=function($x){var $I=$x.elements,$z=this.elements;if($x===this){var $k=$z[1],$l=$z[2],$n=$z[5];$I[1]=$z[3],$I[2]=$z[6],$I[3]=$k,$I[5]=$z[7],$I[6]=$l,$I[7]=$n}else $I[0]=$z[0],$I[1]=$z[3],$I[2]=$z[6],$I[3]=$z[1],$I[4]=$z[4],$I[5]=$z[7],$I[6]=$z[2],$I[7]=$z[5],$I[8]=$z[8]},$x.identity=function(){var $x=this.elements;$x[0]=1,$x[1]=0,$x[2]=0,$x[3]=0,$x[4]=1,$x[5]=0,$x[6]=0,$x[7]=0,$x[8]=1},$x.cloneTo=function($x){var $I,$z,$k;if(($z=this.elements)!==($k=$x.elements))for($I=0;$I<9;++$I)$k[$I]=$z[$I]},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$w.createFromTranslation=function($x,$I){$I.elements;var $z=$x.elements;$I[0]=1,$I[1]=0,$I[2]=0,$I[3]=0,$I[4]=1,$I[5]=0,$I[6]=$z[0],$I[7]=$z[1],$I[8]=1},$w.createFromRotation=function($x,$I){var $z=$I.elements,$k=Math.sin($x),$l=Math.cos($x);$z[0]=$l,$z[1]=$k,$z[2]=0,$z[3]=-$k,$z[4]=$l,$z[5]=0,$z[6]=0,$z[7]=0,$z[8]=1},$w.createFromScaling=function($x,$I){var $z=$I.elements,$k=$x.elements;$z[0]=$k[0],$z[1]=0,$z[2]=0,$z[3]=0,$z[4]=$k[1],$z[5]=0,$z[6]=0,$z[7]=0,$z[8]=1},$w.createFromMatrix4x4=function($x,$I){$I[0]=$x[0],$I[1]=$x[1],$I[2]=$x[2],$I[3]=$x[4],$I[4]=$x[5],$I[5]=$x[6],$I[6]=$x[8],$I[7]=$x[9],$I[8]=$x[10]},$w.multiply=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements,$a=$l[0],$$=$l[1],$w=$l[2],$i=$l[3],$F=$l[4],$b=$l[5],$T=$l[6],$_=$l[7],$R=$l[8],$s=$n[0],$N=$n[1],$D=$n[2],$f=$n[3],$m=$n[4],$y=$n[5],$C=$n[6],$P=$n[7],$v=$n[8];$k[0]=$s*$a+$N*$i+$D*$T,$k[1]=$s*$$+$N*$F+$D*$_,$k[2]=$s*$w+$N*$b+$D*$R,$k[3]=$f*$a+$m*$i+$y*$T,$k[4]=$f*$$+$m*$F+$y*$_,$k[5]=$f*$w+$m*$b+$y*$R,$k[6]=$C*$a+$P*$i+$v*$T,$k[7]=$C*$$+$P*$F+$v*$_,$k[8]=$C*$w+$P*$b+$v*$R},$w.lookAt=function($x,$I,$z,$k){$aI.subtract($x,$I,$w._tempV30),$aI.normalize($w._tempV30,$w._tempV30),$aI.cross($z,$w._tempV30,$w._tempV31),$aI.normalize($w._tempV31,$w._tempV31),$aI.cross($w._tempV30,$w._tempV31,$w._tempV32);var $l=$w._tempV30.elements,$n=$w._tempV31.elements,$a=$w._tempV32.elements,$$=$k.elements;$$[0]=$n[0],$$[3]=$n[1],$$[6]=$n[2],$$[1]=$a[0],$$[4]=$a[1],$$[7]=$a[2],$$[2]=$l[0],$$[5]=$l[1],$$[8]=$l[2]},$w.DEFAULT=new $w,$b($w,["_tempV30",function(){return this._tempV30=new $aI},"_tempV31",function(){return this._tempV31=new $aI},"_tempV32",function(){return this._tempV32=new $aI}]),$w}(),$xI=function(){function $K($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b,$T,$_,$R,$s){void 0===$x&&($x=1),void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$n&&($n=1),void 0===$a&&($a=0),void 0===$$&&($$=0),void 0===$w&&($w=0),void 0===$i&&($i=0),void 0===$F&&($F=1),void 0===$b&&($b=0),void 0===$T&&($T=0),void 0===$_&&($_=0),void 0===$R&&($R=0),void 0===$s&&($s=1);var $N=this.elements=new Float32Array(16);$N[0]=$x,$N[1]=$I,$N[2]=$z,$N[3]=$k,$N[4]=$l,$N[5]=$n,$N[6]=$a,$N[7]=$$,$N[8]=$w,$N[9]=$i,$N[10]=$F,$N[11]=$b,$N[12]=$T,$N[13]=$_,$N[14]=$R,$N[15]=$s}$_($K,"laya.d3.math.Matrix4x4");var $x=$K.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.getElementByRowColumn=function($x,$I){if($x<0||3<$x)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($I<0||3<$I)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$x+$I]},$x.setElementByRowColumn=function($x,$I,$z){if($x<0||3<$x)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($I<0||3<$I)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$x+$I]=$z},$x.equalsOtherMatrix=function($x){var $I=this.elements,$z=$x.elements;return $Qx.nearEqual($I[0],$z[0])&&$Qx.nearEqual($I[1],$z[1])&&$Qx.nearEqual($I[2],$z[2])&&$Qx.nearEqual($I[3],$z[3])&&$Qx.nearEqual($I[4],$z[4])&&$Qx.nearEqual($I[5],$z[5])&&$Qx.nearEqual($I[6],$z[6])&&$Qx.nearEqual($I[7],$z[7])&&$Qx.nearEqual($I[8],$z[8])&&$Qx.nearEqual($I[9],$z[9])&&$Qx.nearEqual($I[10],$z[10])&&$Qx.nearEqual($I[11],$z[11])&&$Qx.nearEqual($I[12],$z[12])&&$Qx.nearEqual($I[13],$z[13])&&$Qx.nearEqual($I[14],$z[14])&&$Qx.nearEqual($I[15],$z[15])},$x.decomposeTransRotScale=function($x,$I,$z){var $k=$K._tempMatrix4x4;return this.decomposeTransRotMatScale($x,$k,$z)?($zI.createFromMatrix4x4($k,$I),!0):($I.identity(),!1)},$x.decomposeTransRotMatScale=function($x,$I,$z){var $k=this.elements,$l=$x.elements,$n=$I.elements,$a=$z.elements;$l[0]=$k[12],$l[1]=$k[13],$l[2]=$k[14];var $$=$k[0],$w=$k[1],$i=$k[2],$F=$k[4],$b=$k[5],$T=$k[6],$_=$k[8],$R=$k[9],$s=$k[10],$N=$a[0]=Math.sqrt($$*$$+$w*$w+$i*$i),$D=$a[1]=Math.sqrt($F*$F+$b*$b+$T*$T),$f=$a[2]=Math.sqrt($_*$_+$R*$R+$s*$s);if($Qx.isZero($N)||$Qx.isZero($D)||$Qx.isZero($f))return $n[1]=$n[2]=$n[3]=$n[4]=$n[6]=$n[7]=$n[8]=$n[9]=$n[11]=$n[12]=$n[13]=$n[14]=0,$n[0]=$n[5]=$n[10]=$n[15]=1,!1;var $m=$K._tempVector0,$y=$m.elements;$y[0]=$_/$f,$y[1]=$R/$f,$y[2]=$s/$f;var $C=$K._tempVector1,$P=$C.elements;$P[0]=$$/$N,$P[1]=$w/$N,$P[2]=$i/$N;var $v=$K._tempVector2;$aI.cross($m,$C,$v);var $L=$K._tempVector1;return $aI.cross($v,$m,$L),$n[3]=$n[7]=$n[11]=$n[12]=$n[13]=$n[14]=0,$n[15]=1,$n[0]=$L.x,$n[1]=$L.y,$n[2]=$L.z,$n[4]=$v.x,$n[5]=$v.y,$n[6]=$v.z,$n[8]=$m.x,$n[9]=$m.y,$n[10]=$m.z,$n[0]*$$+$n[1]*$w+$n[2]*$i<0&&($a[0]=-$N),$n[4]*$F+$n[5]*$b+$n[6]*$T<0&&($a[1]=-$D),$n[8]*$_+$n[9]*$R+$n[10]*$s<0&&($a[2]=-$f),!0},$x.decomposeYawPitchRoll=function($x){var $I=$x.elements,$z=Math.asin(-this.elements[9]);$I[1]=$z,Math.cos($z)>$Qx.zeroTolerance?($I[2]=Math.atan2(this.elements[1],this.elements[5]),$I[0]=Math.atan2(this.elements[8],this.elements[10])):($I[2]=Math.atan2(-this.elements[4],this.elements[0]),$I[0]=0)},$x.normalize=function(){var $x=this.elements,$I=$x[0],$z=$x[1],$k=$x[2],$l=Math.sqrt($I*$I+$z*$z+$k*$k);if(!$l)return $x[0]=0,$x[1]=0,void($x[2]=0);1!=$l&&($l=1/$l,$x[0]=$I*$l,$x[1]=$z*$l,$x[2]=$k*$l)},$x.transpose=function(){var $x,$I;return $I=($x=this.elements)[1],$x[1]=$x[4],$x[4]=$I,$I=$x[2],$x[2]=$x[8],$x[8]=$I,$I=$x[3],$x[3]=$x[12],$x[12]=$I,$I=$x[6],$x[6]=$x[9],$x[9]=$I,$I=$x[7],$x[7]=$x[13],$x[13]=$I,$I=$x[11],$x[11]=$x[14],$x[14]=$I,this},$x.invert=function($x){var $I=this.elements,$z=$x.elements,$k=$I[0],$l=$I[1],$n=$I[2],$a=$I[3],$$=$I[4],$w=$I[5],$i=$I[6],$F=$I[7],$b=$I[8],$T=$I[9],$_=$I[10],$R=$I[11],$s=$I[12],$N=$I[13],$D=$I[14],$f=$I[15],$m=$k*$w-$l*$$,$y=$k*$i-$n*$$,$C=$k*$F-$a*$$,$P=$l*$i-$n*$w,$v=$l*$F-$a*$w,$L=$n*$F-$a*$i,$K=$b*$N-$T*$s,$E=$b*$D-$_*$s,$O=$b*$f-$R*$s,$S=$T*$D-$_*$N,$Z=$T*$f-$R*$N,$U=$_*$f-$R*$D,$X=$m*$U-$y*$Z+$C*$S+$P*$O-$v*$E+$L*$K;0!==Math.abs($X)&&($X=1/$X,$z[0]=($w*$U-$i*$Z+$F*$S)*$X,$z[1]=($n*$Z-$l*$U-$a*$S)*$X,$z[2]=($N*$L-$D*$v+$f*$P)*$X,$z[3]=($_*$v-$T*$L-$R*$P)*$X,$z[4]=($i*$O-$$*$U-$F*$E)*$X,$z[5]=($k*$U-$n*$O+$a*$E)*$X,$z[6]=($D*$C-$s*$L-$f*$y)*$X,$z[7]=($b*$L-$_*$C+$R*$y)*$X,$z[8]=($$*$Z-$w*$O+$F*$K)*$X,$z[9]=($l*$O-$k*$Z-$a*$K)*$X,$z[10]=($s*$v-$N*$C+$f*$m)*$X,$z[11]=($T*$C-$b*$v-$R*$m)*$X,$z[12]=($w*$E-$$*$S-$i*$K)*$X,$z[13]=($k*$S-$l*$E+$n*$K)*$X,$z[14]=($N*$y-$s*$P-$D*$m)*$X,$z[15]=($b*$P-$T*$y+$_*$m)*$X)},$x.identity=function(){var $x=this.elements;$x[1]=$x[2]=$x[3]=$x[4]=$x[6]=$x[7]=$x[8]=$x[9]=$x[11]=$x[12]=$x[13]=$x[14]=0,$x[0]=$x[5]=$x[10]=$x[15]=1},$x.cloneTo=function($x){var $I,$z,$k;if(($z=this.elements)!==($k=$x.elements))for($I=0;$I<16;++$I)$k[$I]=$z[$I]},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$x.getTranslationVector=function($x){var $I=this.elements,$z=$x.elements;$z[0]=$I[12],$z[1]=$I[13],$z[2]=$I[14]},$x.setTranslationVector=function($x){var $I=this.elements,$z=$x.elements;$I[12]=$z[0],$I[13]=$z[1],$I[14]=$z[2]},$x.getForward=function($x){var $I=this.elements,$z=$x.elements;$z[0]=-$I[8],$z[1]=-$I[9],$z[2]=-$I[10]},$x.setForward=function($x){var $I=this.elements,$z=$x.elements;$I[8]=-$z[0],$I[9]=-$z[1],$I[10]=-$z[2]},$K.createRotationX=function($x,$I){var $z=$I.elements,$k=Math.sin($x),$l=Math.cos($x);$z[1]=$z[2]=$z[3]=$z[4]=$z[7]=$z[8]=$z[11]=$z[12]=$z[13]=$z[14]=0,$z[0]=$z[15]=1,$z[5]=$z[10]=$l,$z[6]=$k,$z[9]=-$k},$K.createRotationY=function($x,$I){var $z=$I.elements,$k=Math.sin($x),$l=Math.cos($x);$z[1]=$z[3]=$z[4]=$z[6]=$z[7]=$z[9]=$z[11]=$z[12]=$z[13]=$z[14]=0,$z[5]=$z[15]=1,$z[0]=$z[10]=$l,$z[2]=-$k,$z[8]=$k},$K.createRotationZ=function($x,$I){var $z=$I.elements,$k=Math.sin($x),$l=Math.cos($x);$z[2]=$z[3]=$z[6]=$z[7]=$z[8]=$z[9]=$z[11]=$z[12]=$z[13]=$z[14]=0,$z[10]=$z[15]=1,$z[0]=$z[5]=$l,$z[1]=$k,$z[4]=-$k},$K.createRotationYawPitchRoll=function($x,$I,$z,$k){$zI.createFromYawPitchRoll($x,$I,$z,$K._tempQuaternion),$K.createRotationQuaternion($K._tempQuaternion,$k)},$K.createRotationAxis=function($x,$I,$z){var $k=$x.elements,$l=$k[0],$n=$k[1],$a=$k[2],$$=Math.cos($I),$w=Math.sin($I),$i=$l*$l,$F=$n*$n,$b=$a*$a,$T=$l*$n,$_=$l*$a,$R=$n*$a,$s=$z.elements;$s[3]=$s[7]=$s[11]=$s[12]=$s[13]=$s[14]=0,$s[15]=1,$s[0]=$i+$$*(1-$i),$s[1]=$T-$$*$T+$w*$a,$s[2]=$_-$$*$_-$w*$n,$s[4]=$T-$$*$T-$w*$a,$s[5]=$F+$$*(1-$F),$s[6]=$R-$$*$R+$w*$l,$s[8]=$_-$$*$_+$w*$n,$s[9]=$R-$$*$R-$w*$l,$s[10]=$b+$$*(1-$b)},$K.createRotationQuaternion=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$z[0],$n=$z[1],$a=$z[2],$$=$z[3],$w=$l*$l,$i=$n*$n,$F=$a*$a,$b=$l*$n,$T=$a*$$,$_=$a*$l,$R=$n*$$,$s=$n*$a,$N=$l*$$;$k[3]=$k[7]=$k[11]=$k[12]=$k[13]=$k[14]=0,$k[15]=1,$k[0]=1-2*($i+$F),$k[1]=2*($b+$T),$k[2]=2*($_-$R),$k[4]=2*($b-$T),$k[5]=1-2*($F+$w),$k[6]=2*($s+$N),$k[8]=2*($_+$R),$k[9]=2*($s-$N),$k[10]=1-2*($i+$w)},$K.createTranslate=function($x,$I){var $z=$x.elements,$k=$I.elements;$k[4]=$k[8]=$k[1]=$k[9]=$k[2]=$k[6]=$k[3]=$k[7]=$k[11]=0,$k[0]=$k[5]=$k[10]=$k[15]=1,$k[12]=$z[0],$k[13]=$z[1],$k[14]=$z[2]},$K.createScaling=function($x,$I){var $z=$x.elements,$k=$I.elements;$k[0]=$z[0],$k[5]=$z[1],$k[10]=$z[2],$k[1]=$k[4]=$k[8]=$k[12]=$k[9]=$k[13]=$k[2]=$k[6]=$k[14]=$k[3]=$k[7]=$k[11]=0,$k[15]=1},$K.multiply=function($x,$I,$z){var $k,$l,$n,$a,$$,$w,$i,$F;for($l=$z.elements,$n=$x.elements,$l===($a=$I.elements)&&($a=$a.slice()),$k=0;$k<4;$k++)$$=$n[$k],$w=$n[$k+4],$i=$n[$k+8],$F=$n[$k+12],$l[$k]=$$*$a[0]+$w*$a[1]+$i*$a[2]+$F*$a[3],$l[$k+4]=$$*$a[4]+$w*$a[5]+$i*$a[6]+$F*$a[7],$l[$k+8]=$$*$a[8]+$w*$a[9]+$i*$a[10]+$F*$a[11],$l[$k+12]=$$*$a[12]+$w*$a[13]+$i*$a[14]+$F*$a[15]},$K.createFromQuaternion=function($x,$I){var $z=$I.elements,$k=$x.elements,$l=$k[0],$n=$k[1],$a=$k[2],$$=$k[3],$w=$l+$l,$i=$n+$n,$F=$a+$a,$b=$l*$w,$T=$n*$w,$_=$n*$i,$R=$a*$w,$s=$a*$i,$N=$a*$F,$D=$$*$w,$f=$$*$i,$m=$$*$F;$z[0]=1-$_-$N,$z[1]=$T+$m,$z[2]=$R-$f,$z[3]=0,$z[4]=$T-$m,$z[5]=1-$b-$N,$z[6]=$s+$D,$z[7]=0,$z[8]=$R+$f,$z[9]=$s-$D,$z[10]=1-$b-$_,$z[11]=0,$z[12]=0,$z[13]=0,$z[14]=0,$z[15]=1},$K.createAffineTransformation=function($x,$I,$z,$k){var $l=$x.elements,$n=$I.elements,$a=$z.elements,$$=$k.elements,$w=$n[0],$i=$n[1],$F=$n[2],$b=$n[3],$T=$w+$w,$_=$i+$i,$R=$F+$F,$s=$w*$T,$N=$w*$_,$D=$w*$R,$f=$i*$_,$m=$i*$R,$y=$F*$R,$C=$b*$T,$P=$b*$_,$v=$b*$R,$L=$a[0],$K=$a[1],$E=$a[2];$$[0]=(1-($f+$y))*$L,$$[1]=($N+$v)*$L,$$[2]=($D-$P)*$L,$$[3]=0,$$[4]=($N-$v)*$K,$$[5]=(1-($s+$y))*$K,$$[6]=($m+$C)*$K,$$[7]=0,$$[8]=($D+$P)*$E,$$[9]=($m-$C)*$E,$$[10]=(1-($s+$f))*$E,$$[11]=0,$$[12]=$l[0],$$[13]=$l[1],$$[14]=$l[2],$$[15]=1},$K.createLookAt=function($x,$I,$z,$k){var $l=$k.elements,$n=$K._tempVector0,$a=$K._tempVector1,$$=$K._tempVector2;$aI.subtract($x,$I,$$),$aI.normalize($$,$$),$aI.cross($z,$$,$n),$aI.normalize($n,$n),$aI.cross($$,$n,$a),$k.identity(),$l[0]=$n.x,$l[4]=$n.y,$l[8]=$n.z,$l[1]=$a.x,$l[5]=$a.y,$l[9]=$a.z,$l[2]=$$.x,$l[6]=$$.y,$l[10]=$$.z,$l[12]=-$aI.dot($n,$x),$l[13]=-$aI.dot($a,$x),$l[14]=-$aI.dot($$,$x)},$K.createPerspective=function($x,$I,$z,$k,$l){var $n=$l.elements,$a=1/Math.tan($x/2),$$=1/($z-$k);$n[0]=$a/$I,$n[5]=$a,$n[10]=($k+$z)*$$,$n[11]=-1,$n[14]=2*$k*$z*$$,$n[1]=$n[2]=$n[3]=$n[4]=$n[6]=$n[7]=$n[8]=$n[9]=$n[12]=$n[13]=$n[15]=0},$K.createOrthoOffCenterRH=function($x,$I,$z,$k,$l,$n,$a){var $$=$a.elements,$w=1/($x-$I),$i=1/($z-$k),$F=1/($l-$n);$$[1]=$$[2]=$$[3]=$$[4]=$$[6]=$$[7]=$$[8]=$$[9]=$$[11]=0,$$[15]=1,$$[0]=-2*$w,$$[5]=-2*$i,$$[10]=2*$F,$$[12]=($x+$I)*$w,$$[13]=($k+$z)*$i,$$[14]=($n+$l)*$F},$K.translation=function($x,$I){var $z=$x.elements,$k=$I.elements;$k[0]=$k[5]=$k[10]=$k[15]=1,$k[12]=$z[0],$k[13]=$z[1],$k[14]=$z[2]},$b($K,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $K},"_tempVector0",function(){return this._tempVector0=new $aI},"_tempVector1",function(){return this._tempVector1=new $aI},"_tempVector2",function(){return this._tempVector2=new $aI},"_tempQuaternion",function(){return this._tempQuaternion=new $zI},"DEFAULT",function(){return this.DEFAULT=new $K},"ZERO",function(){return this.ZERO=new $K(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$K}(),$II=(function(){function $m($x,$I){this.extents=null,this.transformation=null,this.extents=$x,this.transformation=$I}$_($m,"laya.d3.math.OrientedBoundBox");var $x=$m.prototype;$x.getCorners=function($x){var $I=$m._tempV30.elements,$z=$m._tempV31.elements,$k=$m._tempV32.elements,$l=this.extents.elements;$I[0]=$l[0],$I[1]=$I[2]=0,$z[1]=$l[1],$z[0]=$z[2]=0,$k[2]=$l[2],$k[0]=$k[1]=0,$aI.TransformNormal($m._tempV30,this.transformation,$m._tempV30),$aI.TransformNormal($m._tempV31,this.transformation,$m._tempV31),$aI.TransformNormal($m._tempV32,this.transformation,$m._tempV32);var $n=$m._tempV33;this.transformation.getTranslationVector($n),$x.length=8,$aI.add($n,$m._tempV30,$m._tempV34),$aI.add($m._tempV34,$m._tempV31,$m._tempV34),$aI.add($m._tempV34,$m._tempV32,$x[0]),$aI.add($n,$m._tempV30,$m._tempV34),$aI.add($m._tempV34,$m._tempV31,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV32,$x[1]),$aI.subtract($n,$m._tempV30,$m._tempV34),$aI.add($m._tempV34,$m._tempV31,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV32,$x[2]),$aI.subtract($n,$m._tempV30,$m._tempV34),$aI.add($m._tempV34,$m._tempV31,$m._tempV34),$aI.add($m._tempV34,$m._tempV32,$x[3]),$aI.add($n,$m._tempV30,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV31,$m._tempV34),$aI.add($m._tempV34,$m._tempV32,$x[4]),$aI.add($n,$m._tempV30,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV31,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV32,$x[5]),$aI.subtract($n,$m._tempV30,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV31,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV32,$x[6]),$aI.subtract($n,$m._tempV30,$m._tempV34),$aI.subtract($m._tempV34,$m._tempV31,$m._tempV34),$aI.add($m._tempV34,$m._tempV32,$x[7])},$x.transform=function($x){$xI.multiply(this.transformation,$x,this.transformation)},$x.scale=function($x){$aI.multiply(this.extents,$x,this.extents)},$x.translate=function($x){this.transformation.getTranslationVector($m._tempV30),$aI.add($m._tempV30,$x,$m._tempV31),this.transformation.setTranslationVector($m._tempV31)},$x.Size=function($x){$aI.scale(this.extents,2,$x)},$x.getSize=function($x){var $I=this.extents.elements;$m._tempV30.x=$I[0],$m._tempV31.y=$I[1],$m._tempV32.z=$I[2],$aI.TransformNormal($m._tempV30,this.transformation,$m._tempV30),$aI.TransformNormal($m._tempV31,this.transformation,$m._tempV31),$aI.TransformNormal($m._tempV31,this.transformation,$m._tempV32);var $z=$x.elements;$z[0]=$aI.scalarLength($m._tempV30),$z[1]=$aI.scalarLength($m._tempV31),$z[2]=$aI.scalarLength($m._tempV32)},$x.getSizeSquared=function($x){var $I=this.extents.elements;$m._tempV30.x=$I[0],$m._tempV31.y=$I[1],$m._tempV32.z=$I[2],$aI.TransformNormal($m._tempV30,this.transformation,$m._tempV30),$aI.TransformNormal($m._tempV31,this.transformation,$m._tempV31),$aI.TransformNormal($m._tempV31,this.transformation,$m._tempV32);var $z=$x.elements;$z[0]=$aI.scalarLengthSquared($m._tempV30),$z[1]=$aI.scalarLengthSquared($m._tempV31),$z[2]=$aI.scalarLengthSquared($m._tempV32)},$x.getCenter=function($x){this.transformation.getTranslationVector($x)},$x.containsPoint=function($x){var $I=this.extents.elements,$z=$I[0],$k=$I[1],$l=$I[2];this.transformation.invert($m._tempM0),$aI.transformCoordinate($x,$m._tempM0,$m._tempV30);var $n=$m._tempV30.elements,$a=Math.abs($n[0]),$$=Math.abs($n[1]),$w=Math.abs($n[2]);return $Qx.nearEqual($a,$z)&&$Qx.nearEqual($$,$k)&&$Qx.nearEqual($w,$l)?2:$a<$z&&$$<$k&&$w<$l?1:0},$x.containsPoints=function($x){var $I=this.extents.elements,$z=$I[0],$k=$I[1],$l=$I[2];this.transformation.invert($m._tempM0);for(var $n=!0,$a=!1,$$=0;$$<$x.length;$$++){$aI.transformCoordinate($x[$$],$m._tempM0,$m._tempV30);var $w=$m._tempV30.elements,$i=Math.abs($w[0]),$F=Math.abs($w[1]),$b=Math.abs($w[2]);$Qx.nearEqual($i,$z)&&$Qx.nearEqual($F,$k)&&$Qx.nearEqual($b,$l)&&($a=!0),$i<$z&&$F<$k&&$b<$l?$a=!0:$n=!1}return $n?1:$a?2:0},$x.containsSphere=function($x,$I){void 0===$I&&($I=!1);var $z=this.extents.elements,$k=$z[0],$l=$z[1],$n=$z[2],$a=$x.radius;this.transformation.invert($m._tempM0),$aI.transformCoordinate($x.center,$m._tempM0,$m._tempV30);var $$=NaN;if($$=$I?$a:($aI.scale($aI.UnitX,$a,$m._tempV31),$aI.TransformNormal($m._tempV31,$m._tempM0,$m._tempV31),$aI.scalarLength($m._tempV31)),$aI.scale(this.extents,-1,$m._tempV32),$aI.Clamp($m._tempV30,$m._tempV32,this.extents,$m._tempV33),$$*$$<$aI.distanceSquared($m._tempV30,$m._tempV33))return 0;var $w=$m._tempV30.elements,$i=$w[0],$F=$w[1],$b=$w[2],$T=$m._tempV32.elements,$_=$T[0],$R=$T[1],$s=$T[2];return $_+$$<=$i&&$i<=$k-$$&&$$<$k-$_&&$R+$$<=$F&&$F<=$l-$$&&$$<$l-$R&&$s+$$<=$b&&$b<=$n-$$&&$$<$n-$s?1:2},$x.containsOrientedBoundBox=function($x){var $I=0,$z=0;$x.getCorners($m._corners);var $k=this.containsPoints($m._corners);if(0!=$k)return $k;var $l=this.extents.elements;$x.extents.cloneTo($m._tempV35);var $n=$m._tempV35.elements;$m._getRows(this.transformation,$m._rows1),$m._getRows($x.transformation,$m._rows2);var $a=NaN;for($I=0;$I<4;$I++)for($z=0;$z<4;$z++)3==$I||3==$z?($m._tempM0.setElementByRowColumn($I,$z,0),$m._tempM1.setElementByRowColumn($I,$z,0)):($a=$aI.dot($m._rows1[$I],$m._rows2[$z]),$m._tempM0.setElementByRowColumn($I,$z,$a),$m._tempM1.setElementByRowColumn($I,$z,Math.abs($a)));$x.getCenter($m._tempV34),this.getCenter($m._tempV36),$aI.subtract($m._tempV34,$m._tempV36,$m._tempV30);var $$=$m._tempV31.elements;$$[0]=$aI.dot($m._tempV30,$m._rows1[0]),$$[1]=$aI.dot($m._tempV30,$m._rows1[1]),$$[2]=$aI.dot($m._tempV30,$m._rows1[2]);var $w=$m._tempV32.elements,$i=$m._tempV33.elements;for($I=0;$I<3;$I++)if($w[0]=$m._tempM1.getElementByRowColumn($I,0),$w[1]=$m._tempM1.getElementByRowColumn($I,1),$w[2]=$m._tempM1.getElementByRowColumn($I,2),$l[$I]+$aI.dot($m._tempV35,$m._tempV32)<Math.abs($$[$I]))return 0;for($z=0;$z<3;$z++)if($w[0]=$m._tempM1.getElementByRowColumn(0,$z),$w[1]=$m._tempM1.getElementByRowColumn(1,$z),$w[2]=$m._tempM1.getElementByRowColumn(2,$z),$i[0]=$m._tempM0.getElementByRowColumn(0,$z),$i[1]=$m._tempM0.getElementByRowColumn(1,$z),$i[2]=$m._tempM0.getElementByRowColumn(2,$z),$aI.dot(this.extents,$m._tempV32)+$n[$z]<Math.abs($aI.dot($m._tempV31,$m._tempV33)))return 0;for($I=0;$I<3;$I++)for($z=0;$z<3;$z++){var $F=($I+1)%3,$b=($I+2)%3,$T=($z+1)%3,$_=($z+2)%3;if($l[$F]*$m._tempM1.getElementByRowColumn($b,$z)+$l[$b]*$m._tempM1.getElementByRowColumn($F,$z)+($n[$T]*$m._tempM1.getElementByRowColumn($I,$_)+$n[$_]*$m._tempM1.getElementByRowColumn($I,$T))<Math.abs($$[$b]*$m._tempM0.getElementByRowColumn($F,$z)-$$[$F]*$m._tempM0.getElementByRowColumn($b,$z)))return 0}return 2},$x.containsLine=function($x,$I){$m._corners[0]=$x,$m._corners[1]=$I;var $z=this.containsPoints($m._corners);if(0!=$z)return $z;var $k=this.extents.elements,$l=$k[0],$n=$k[1],$a=$k[2];this.transformation.invert($m._tempM0),$aI.transformCoordinate($x,$m._tempM0,$m._tempV30),$aI.transformCoordinate($I,$m._tempM0,$m._tempV31),$aI.add($m._tempV30,$m._tempV31,$m._tempV32),$aI.scale($m._tempV32,.5,$m._tempV32),$aI.subtract($m._tempV30,$m._tempV32,$m._tempV33);var $$=$m._tempV33.elements,$w=$$[0],$i=$$[1],$F=$$[2],$b=$m._tempV34.elements,$T=$b[0]=Math.abs($$[0]),$_=$b[1]=Math.abs($$[1]),$R=$b[2]=Math.abs($$[2]),$s=$m._tempV32.elements,$N=$s[0],$D=$s[1],$f=$s[2];return Math.abs($N)>$l+$T?0:Math.abs($D)>$n+$_?0:Math.abs($f)>$a+$R?0:Math.abs($D*$F-$f*$i)>$n*$R+$a*$_?0:Math.abs($N*$F-$f*$w)>$l*$R+$a*$T?0:Math.abs($N*$i-$D*$w)>$l*$_+$n*$T?0:2},$x.containsBoundBox=function($x){var $I=0,$z=0,$k=$x.min,$l=$x.max;$x.getCorners($m._corners);var $n=this.containsPoints($m._corners);if(0!=$n)return $n;$aI.subtract($l,$k,$m._tempV30),$aI.scale($m._tempV30,.5,$m._tempV30),$aI.add($k,$m._tempV30,$m._tempV30),$aI.subtract($l,$m._tempV30,$m._tempV31);var $a=this.extents.elements,$$=$m._tempV31.elements;$m._getRows(this.transformation,$m._rows1),this.transformation.invert($m._tempM0);for($I=0;$I<3;$I++)for($z=0;$z<3;$z++)$m._tempM1.setElementByRowColumn($I,$z,Math.abs($m._tempM0.getElementByRowColumn($I,$z)));this.getCenter($m._tempV35),$aI.subtract($m._tempV30,$m._tempV35,$m._tempV32);var $w=$m._tempV31.elements;$w[0]=$aI.dot($m._tempV32,$m._rows1[0]),$w[1]=$aI.dot($m._tempV32,$m._rows1[1]),$w[2]=$aI.dot($m._tempV32,$m._rows1[2]);var $i=$m._tempV33.elements,$F=$m._tempV34.elements;for($I=0;$I<3;$I++)if($i[0]=$m._tempM1.getElementByRowColumn($I,0),$i[1]=$m._tempM1.getElementByRowColumn($I,1),$i[2]=$m._tempM1.getElementByRowColumn($I,2),$a[$I]+$aI.dot($m._tempV31,$m._tempV33)<Math.abs($w[$I]))return 0;for($z=0;$z<3;$z++)if($i[0]=$m._tempM1.getElementByRowColumn(0,$z),$i[1]=$m._tempM1.getElementByRowColumn(1,$z),$i[2]=$m._tempM1.getElementByRowColumn(2,$z),$F[0]=$m._tempM0.getElementByRowColumn(0,$z),$F[1]=$m._tempM0.getElementByRowColumn(1,$z),$F[2]=$m._tempM0.getElementByRowColumn(2,$z),$aI.dot(this.extents,$m._tempV33)+$$[$z]<Math.abs($aI.dot($m._tempV31,$m._tempV34)))return 0;for($I=0;$I<3;$I++)for($z=0;$z<3;$z++){var $b=($I+1)%3,$T=($I+2)%3,$_=($z+1)%3,$R=($z+2)%3;if($a[$b]*$m._tempM1.getElementByRowColumn($T,$z)+$a[$T]*$m._tempM1.getElementByRowColumn($b,$z)+($$[$_]*$m._tempM1.getElementByRowColumn($I,$R)+$$[$R]*$m._tempM1.getElementByRowColumn($I,$_))<Math.abs($w[$T]*$m._tempM0.getElementByRowColumn($b,$z)-$w[$b]*$m._tempM0.getElementByRowColumn($T,$z)))return 0}return 2},$x.intersectsRay=function($x,$I){$aI.scale(this.extents,-1,$m._tempV30),this.transformation.invert($m._tempM0),$aI.TransformNormal($x.direction,$m._tempM0,$m._ray.direction),$aI.transformCoordinate($x.origin,$m._tempM0,$m._ray.origin),$m._boxBound1.min=$m._tempV30,$m._boxBound1.max=this.extents;var $z=Collision.intersectsRayAndBoxRP($m._ray,$m._boxBound1,$I);return-1!==$z&&$aI.transformCoordinate($I,this.transformation,$I),$z},$x._getLocalCorners=function($x){$x.length=8;var $I=this.extents.elements;$m._tempV30.x=$I[0],$m._tempV31.y=$I[1],$m._tempV32.z=$I[2],$aI.add($m._tempV30,$m._tempV31,$m._tempV33),$aI.add($m._tempV33,$m._tempV32,$x[0]),$aI.add($m._tempV30,$m._tempV31,$m._tempV33),$aI.subtract($m._tempV33,$m._tempV32,$x[1]),$aI.subtract($m._tempV31,$m._tempV30,$m._tempV33),$aI.subtract($m._tempV33,$m._tempV30,$x[2]),$aI.subtract($m._tempV31,$m._tempV30,$m._tempV33),$aI.add($m._tempV33,$m._tempV32,$x[3]),$aI.subtract($m._tempV30,$m._tempV31,$m._tempV33),$aI.add($m._tempV33,$m._tempV32,$x[4]),$aI.subtract($m._tempV30,$m._tempV31,$m._tempV33),$aI.subtract($m._tempV33,$m._tempV32,$x[5]),$aI.scale($x[0],-1,$x[6]),$aI.subtract($m._tempV32,$m._tempV30,$m._tempV33),$aI.subtract($m._tempV33,$m._tempV31,$x[7])},$x.equals=function($x){return this.extents==$x.extents&&this.transformation==$x.transformation},$x.cloneTo=function($x){var $I=$x;this.extents.cloneTo($I.extents),this.transformation.cloneTo($I.transformation)},$m.createByBoundBox=function($x,$I){var $z=$x.min,$k=$x.max;$aI.subtract($k,$z,$m._tempV30),$aI.scale($m._tempV30,.5,$m._tempV30),$aI.add($z,$m._tempV30,$m._tempV31),$aI.subtract($k,$m._tempV31,$m._tempV32),$xI.translation($m._tempV31,$m._tempM0);var $l=$m._tempV32.clone(),$n=$m._tempM0.clone();$I.extents=$l,$I.transformation=$n},$m.createByMinAndMaxVertex=function($x,$I){return $aI.subtract($I,$x,$m._tempV30),$aI.scale($m._tempV30,.5,$m._tempV30),$aI.add($x,$m._tempV30,$m._tempV31),$aI.subtract($I,$m._tempV31,$m._tempV32),$xI.translation($m._tempV31,$m._tempM0),new $m($m._tempV32,$m._tempM0)},$m._getRows=function($x,$I){$I.length=3;var $z=$x.elements,$k=$I[0].elements;$k[0]=$z[0],$k[1]=$z[1],$k[2]=$z[2];var $l=$I[1].elements;$l[0]=$z[4],$l[1]=$z[5],$l[2]=$z[6];var $n=$I[2].elements;$n[0]=$z[8],$n[1]=$z[9],$n[2]=$z[10]},$m.getObbtoObbMatrix4x4=function($x,$I,$z,$k){var $l=$x.transformation,$n=$I.transformation;if($z){$m._getRows($l,$m._rows1),$m._getRows($n,$m._rows2);for(var $a=0;$a<3;$a++)for(var $$=0;$$<3;$$++)$k.setElementByRowColumn($a,$$,$aI.dot($m._rows2[$a],$m._rows1[$$]));$I.getCenter($m._tempV30),$x.getCenter($m._tempV31),$aI.subtract($m._tempV30,$m._tempV31,$m._tempV32);var $w=$k.elements;$w[12]=$aI.dot($m._tempV32,$m._rows1[0]),$w[13]=$aI.dot($m._tempV32,$m._rows1[1]),$w[14]=$aI.dot($m._tempV32,$m._rows1[2]),$w[15]=1}else $l.invert($m._tempM0),$xI.multiply($n,$m._tempM0,$k)},$m.merge=function($x,$I,$z){var $k=$x.extents,$l=$x.transformation;$m.getObbtoObbMatrix4x4($x,$I,$z,$m._tempM0),$I._getLocalCorners($m._corners),$aI.transformCoordinate($m._corners[0],$m._tempM0,$m._corners[0]),$aI.transformCoordinate($m._corners[1],$m._tempM0,$m._corners[1]),$aI.transformCoordinate($m._corners[2],$m._tempM0,$m._corners[2]),$aI.transformCoordinate($m._corners[3],$m._tempM0,$m._corners[3]),$aI.transformCoordinate($m._corners[4],$m._tempM0,$m._corners[4]),$aI.transformCoordinate($m._corners[5],$m._tempM0,$m._corners[5]),$aI.transformCoordinate($m._corners[6],$m._tempM0,$m._corners[6]),$aI.transformCoordinate($m._corners[7],$m._tempM0,$m._corners[7]),$aI.scale($k,-1,$m._boxBound1.min),$k.cloneTo($m._boxBound1.max),$rx.createfromPoints($m._corners,$m._boxBound2),$rx.merge($m._boxBound2,$m._boxBound1,$m._boxBound3);var $n=$m._boxBound3.min,$a=$m._boxBound3.max;$aI.subtract($a,$n,$m._tempV30),$aI.scale($m._tempV30,.5,$m._tempV30),$aI.add($n,$m._tempV30,$m._tempV32),$aI.subtract($a,$m._tempV32,$k),$aI.transformCoordinate($m._tempV32,$l,$m._tempV33)},$b($m,["_tempV30",function(){return this._tempV30=new $aI},"_tempV31",function(){return this._tempV31=new $aI},"_tempV32",function(){return this._tempV32=new $aI},"_tempV33",function(){return this._tempV33=new $aI},"_tempV34",function(){return this._tempV34=new $aI},"_tempV35",function(){return this._tempV35=new $aI},"_tempV36",function(){return this._tempV36=new $aI},"_tempM0",function(){return this._tempM0=new $xI},"_tempM1",function(){return this._tempM1=new $xI},"_corners",function(){return this._corners=[new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI]},"_rows1",function(){return this._rows1=[new $aI,new $aI,new $aI]},"_rows2",function(){return this._rows2=[new $aI,new $aI,new $aI]},"_ray",function(){return this._ray=new $lI(new $aI,new $aI)},"_boxBound1",function(){return this._boxBound1=new $rx(new $aI,new $aI)},"_boxBound2",function(){return this._boxBound2=new $rx(new $aI,new $aI)},"_boxBound3",function(){return this._boxBound3=new $rx(new $aI,new $aI)}])}(),function(){function $C($x,$I){this.normal=null,this.distance=NaN,void 0===$I&&($I=0),this.normal=$x,this.distance=$I}return $_($C,"laya.d3.math.Plane"),$C.prototype.normalize=function(){var $x=this.normal.elements,$I=$x[0],$z=$x[1],$k=$x[2],$l=1/Math.sqrt($I*$I+$z*$z+$k*$k);$x[0]=$I*$l,$x[1]=$z*$l,$x[2]=$k*$l,this.distance*=$l},$C.createPlaneBy3P=function($x,$I,$z){var $k=$x.elements,$l=$I.elements,$n=$z.elements,$a=$l[0]-$k[0],$$=$l[1]-$k[1],$w=$l[2]-$k[2],$i=$n[0]-$k[0],$F=$n[1]-$k[1],$b=$n[2]-$k[2],$T=$$*$b-$w*$F,$_=$w*$i-$a*$b,$R=$a*$F-$$*$i,$s=1/Math.sqrt($T*$T+$_*$_+$R*$R),$N=$T*$s,$D=$_*$s,$f=$R*$s,$m=$C._TEMPVec3.elements;$m[0]=$N,$m[1]=$D,$m[2]=$f;var $y=-($N*$k[0]+$D*$k[1]+$f*$k[2]);return new $C($C._TEMPVec3,$y)},$C.PlaneIntersectionType_Back=0,$C.PlaneIntersectionType_Front=1,$C.PlaneIntersectionType_Intersecting=2,$b($C,["_TEMPVec3",function(){return this._TEMPVec3=new $aI}]),$C}()),$zI=function(){function $l($x,$I,$z,$k){this.elements=new Float32Array(4),void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=1),this.elements[0]=$x,this.elements[1]=$I,this.elements[2]=$z,this.elements[3]=$k}$_($l,"laya.d3.math.Quaternion");var $x=$l.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.scaling=function($x,$I){var $z=$I.elements,$k=this.elements;$z[0]=$k[0]*$x,$z[1]=$k[1]*$x,$z[2]=$k[2]*$x,$z[3]=$k[3]*$x},$x.normalize=function($x){var $I=$x.elements,$z=this.elements,$k=$z[0],$l=$z[1],$n=$z[2],$a=$z[3],$$=$k*$k+$l*$l+$n*$n+$a*$a;0<$$&&($$=1/Math.sqrt($$),$I[0]=$k*$$,$I[1]=$l*$$,$I[2]=$n*$$,$I[3]=$a*$$)},$x.length=function(){var $x=this.elements,$I=$x[0],$z=$x[1],$k=$x[2],$l=$x[3];return Math.sqrt($I*$I+$z*$z+$k*$k+$l*$l)},$x.rotateX=function($x,$I){var $z=$I.elements,$k=this.elements;$x*=.5;var $l=$k[0],$n=$k[1],$a=$k[2],$$=$k[3],$w=Math.sin($x),$i=Math.cos($x);$z[0]=$l*$i+$$*$w,$z[1]=$n*$i+$a*$w,$z[2]=$a*$i-$n*$w,$z[3]=$$*$i-$l*$w},$x.rotateY=function($x,$I){var $z=$I.elements,$k=this.elements;$x*=.5;var $l=$k[0],$n=$k[1],$a=$k[2],$$=$k[3],$w=Math.sin($x),$i=Math.cos($x);$z[0]=$l*$i-$a*$w,$z[1]=$n*$i+$$*$w,$z[2]=$a*$i+$l*$w,$z[3]=$$*$i-$n*$w},$x.rotateZ=function($x,$I){var $z=$I.elements,$k=this.elements;$x*=.5;var $l=$k[0],$n=$k[1],$a=$k[2],$$=$k[3],$w=Math.sin($x),$i=Math.cos($x);$z[0]=$l*$i+$n*$w,$z[1]=$n*$i-$l*$w,$z[2]=$a*$i+$$*$w,$z[3]=$$*$i-$a*$w},$x.getYawPitchRoll=function($x){$aI.transformQuat($aI.ForwardRH,this,$l.TEMPVector31),$aI.transformQuat($aI.Up,this,$l.TEMPVector32);var $I=$l.TEMPVector32.elements;$l.angleTo($aI.ZERO,$l.TEMPVector31,$l.TEMPVector33);var $z=$l.TEMPVector33.elements;$z[0]==Math.PI/2?($z[1]=$l.arcTanAngle($I[2],$I[0]),$z[2]=0):$z[0]==-Math.PI/2?($z[1]=$l.arcTanAngle(-$I[2],-$I[0]),$z[2]=0):($xI.createRotationY(-$z[1],$l.TEMPMatrix0),$xI.createRotationX(-$z[0],$l.TEMPMatrix1),$aI.transformCoordinate($l.TEMPVector32,$l.TEMPMatrix0,$l.TEMPVector32),$aI.transformCoordinate($l.TEMPVector32,$l.TEMPMatrix1,$l.TEMPVector32),$z[2]=$l.arcTanAngle($I[1],-$I[0])),$z[1]<=-Math.PI&&($z[1]=Math.PI),$z[2]<=-Math.PI&&($z[2]=Math.PI),$z[1]>=Math.PI&&$z[2]>=Math.PI&&($z[1]=0,$z[2]=0,$z[0]=Math.PI-$z[0]);var $k=$x.elements;$k[0]=$z[1],$k[1]=$z[0],$k[2]=$z[2]},$x.invert=function($x){var $I=$x.elements,$z=this.elements,$k=$z[0],$l=$z[1],$n=$z[2],$a=$z[3],$$=$k*$k+$l*$l+$n*$n+$a*$a,$w=$$?1/$$:0;$I[0]=-$k*$w,$I[1]=-$l*$w,$I[2]=-$n*$w,$I[3]=$a*$w},$x.identity=function(){var $x=this.elements;$x[0]=0,$x[1]=0,$x[2]=0,$x[3]=1},$x.fromArray=function($x,$I){void 0===$I&&($I=0),this.elements[0]=$x[$I+0],this.elements[1]=$x[$I+1],this.elements[2]=$x[$I+2],this.elements[3]=$x[$I+3]},$x.cloneTo=function($x){var $I,$z,$k;if(($z=this.elements)!==($k=$x.elements))for($I=0;$I<4;++$I)$k[$I]=$z[$I]},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$x.equals=function($x){var $I=this.elements,$z=$x.elements;return $Qx.nearEqual($I[0],$z[0])&&$Qx.nearEqual($I[1],$z[1])&&$Qx.nearEqual($I[2],$z[2])&&$Qx.nearEqual($I[3],$z[3])},$x.lengthSquared=function(){var $x=this.elements[0],$I=this.elements[1],$z=this.elements[2],$k=this.elements[3];return $x*$x+$I*$I+$z*$z+$k*$k},$R(0,$x,"x",function(){return this.elements[0]}),$R(0,$x,"y",function(){return this.elements[1]}),$R(0,$x,"z",function(){return this.elements[2]}),$R(0,$x,"w",function(){return this.elements[3]}),$l.createFromYawPitchRoll=function($x,$I,$z,$k){var $l=.5*$z,$n=.5*$I,$a=.5*$x,$$=Math.sin($l),$w=Math.cos($l),$i=Math.sin($n),$F=Math.cos($n),$b=Math.sin($a),$T=Math.cos($a),$_=$k.elements;$_[0]=$T*$i*$w+$b*$F*$$,$_[1]=$b*$F*$w-$T*$i*$$,$_[2]=$T*$F*$$-$b*$i*$w,$_[3]=$T*$F*$w+$b*$i*$$},$l.multiply=function($x,$I,$z){var $k=$x.elements,$l=$I.elements,$n=$z.elements,$a=$k[0],$$=$k[1],$w=$k[2],$i=$k[3],$F=$l[0],$b=$l[1],$T=$l[2],$_=$l[3],$R=$$*$T-$w*$b,$s=$w*$F-$a*$T,$N=$a*$b-$$*$F,$D=$a*$F+$$*$b+$w*$T;$n[0]=$a*$_+$F*$i+$R,$n[1]=$$*$_+$b*$i+$s,$n[2]=$w*$_+$T*$i+$N,$n[3]=$i*$_-$D},$l.arcTanAngle=function($x,$I){return 0==$x?1==$I?Math.PI/2:-Math.PI/2:0<$x?Math.atan($I/$x):$x<0?0<$I?Math.atan($I/$x)+Math.PI:Math.atan($I/$x)-Math.PI:0},$l.angleTo=function($x,$I,$z){$aI.subtract($I,$x,$l.TEMPVector30),$aI.normalize($l.TEMPVector30,$l.TEMPVector30),$z.elements[0]=Math.asin($l.TEMPVector30.y),$z.elements[1]=$l.arcTanAngle(-$l.TEMPVector30.z,-$l.TEMPVector30.x)},$l.createFromAxisAngle=function($x,$I,$z){var $k=$z.elements,$l=$x.elements;$I*=.5;var $n=Math.sin($I);$k[0]=$n*$l[0],$k[1]=$n*$l[1],$k[2]=$n*$l[2],$k[3]=Math.cos($I)},$l.createFromMatrix3x3=function($x,$I){var $z,$k=$I.elements,$l=$x.elements,$n=$l[0]+$l[4]+$l[8];if(0<$n)$z=Math.sqrt($n+1),$k[3]=.5*$z,$z=.5/$z,$k[0]=($l[5]-$l[7])*$z,$k[1]=($l[6]-$l[2])*$z,$k[2]=($l[1]-$l[3])*$z;else{var $a=0;$l[4]>$l[0]&&($a=1),$l[8]>$l[3*$a+$a]&&($a=2);var $$=($a+1)%3,$w=($a+2)%3;$z=Math.sqrt($l[3*$a+$a]-$l[3*$$+$$]-$l[3*$w+$w]+1),$k[$a]=.5*$z,$z=.5/$z,$k[3]=($l[3*$$+$w]-$l[3*$w+$$])*$z,$k[$$]=($l[3*$$+$a]+$l[3*$a+$$])*$z,$k[$w]=($l[3*$w+$a]+$l[3*$a+$w])*$z}},$l.createFromMatrix4x4=function($x,$I){var $z,$k,$l=$x.elements,$n=$I.elements,$a=$l[0]+$l[5]+$l[10];0<$a?($z=Math.sqrt($a+1),$n[3]=.5*$z,$z=.5/$z,$n[0]=($l[6]-$l[9])*$z,$n[1]=($l[8]-$l[2])*$z,$n[2]=($l[1]-$l[4])*$z):$l[0]>=$l[5]&&$l[0]>=$l[10]?($k=.5/($z=Math.sqrt(1+$l[0]-$l[5]-$l[10])),$n[0]=.5*$z,$n[1]=($l[1]+$l[4])*$k,$n[2]=($l[2]+$l[8])*$k,$n[3]=($l[6]-$l[9])*$k):$l[5]>$l[10]?($k=.5/($z=Math.sqrt(1+$l[5]-$l[0]-$l[10])),$n[0]=($l[4]+$l[1])*$k,$n[1]=.5*$z,$n[2]=($l[9]+$l[6])*$k,$n[3]=($l[8]-$l[2])*$k):($k=.5/($z=Math.sqrt(1+$l[10]-$l[0]-$l[5])),$n[0]=($l[8]+$l[2])*$k,$n[1]=($l[9]+$l[6])*$k,$n[2]=.5*$z,$n[3]=($l[1]-$l[4])*$k)},$l.slerp=function($x,$I,$z,$k){var $l,$n,$a,$$,$w,$i=$x.elements,$F=$I.elements,$b=$k.elements,$T=$i[0],$_=$i[1],$R=$i[2],$s=$i[3],$N=$F[0],$D=$F[1],$f=$F[2],$m=$F[3];return($n=$T*$N+$_*$D+$R*$f+$s*$m)<0&&($n=-$n,$N=-$N,$D=-$D,$f=-$f,$m=-$m),$w=1e-6<1-$n?($l=Math.acos($n),$a=Math.sin($l),$$=Math.sin((1-$z)*$l)/$a,Math.sin($z*$l)/$a):($$=1-$z,$z),$b[0]=$$*$T+$w*$N,$b[1]=$$*$_+$w*$D,$b[2]=$$*$R+$w*$f,$b[3]=$$*$s+$w*$m,$b},$l.lerp=function($x,$I,$z,$k){var $l=$k.elements,$n=$x.elements,$a=$I.elements,$$=$n[0],$w=$n[1],$i=$n[2],$F=$n[3];$l[0]=$$+$z*($a[0]-$$),$l[1]=$w+$z*($a[1]-$w),$l[2]=$i+$z*($a[2]-$i),$l[3]=$F+$z*($a[3]-$F)},$l.add=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=$l[0]+$n[0],$k[1]=$l[1]+$n[1],$k[2]=$l[2]+$n[2],$k[3]=$l[3]+$n[3]},$l.dot=function($x,$I){var $z=$x.elements,$k=$I.elements;return $z[0]*$k[0]+$z[1]*$k[1]+$z[2]*$k[2]+$z[3]*$k[3]},$l.rotationLookAt=function($x,$I,$z){$l.lookAt($aI.ZERO,$x,$I,$z)},$l.lookAt=function($x,$I,$z,$k){$Gx.lookAt($x,$I,$z,$l._tempMatrix3x3),$l.rotationMatrix($l._tempMatrix3x3,$k)},$l.invert=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$x.lengthSquared();$Qx.isZero($l)||($l=1/$l,$k[0]=-$z[0]*$l,$k[1]=-$z[1]*$l,$k[2]=-$z[2]*$l,$k[3]=$z[3]*$l)},$l.rotationMatrix=function($x,$I){var $z=$x.elements,$k=$z[0],$l=$z[1],$n=$z[2],$a=$z[3],$$=$z[4],$w=$z[5],$i=$z[6],$F=$z[7],$b=$z[8],$T=$I.elements,$_=NaN,$R=NaN,$s=$k+$$+$b;0<$s?($_=Math.sqrt($s+1),$T[3]=.5*$_,$_=.5/$_,$T[0]=($w-$F)*$_,$T[1]=($i-$n)*$_,$T[2]=($l-$a)*$_):$$<=$k&&$b<=$k?($R=.5/($_=Math.sqrt(1+$k-$$-$b)),$T[0]=.5*$_,$T[1]=($l+$a)*$R,$T[2]=($n+$i)*$R,$T[3]=($w-$F)*$R):$b<$$?($R=.5/($_=Math.sqrt(1+$$-$k-$b)),$T[0]=($a+$l)*$R,$T[1]=.5*$_,$T[2]=($F+$w)*$R,$T[3]=($i-$n)*$R):($R=.5/($_=Math.sqrt(1+$b-$k-$$)),$T[0]=($i+$n)*$R,$T[1]=($F+$w)*$R,$T[2]=.5*$_,$T[3]=($l-$a)*$R)},$l.DEFAULT=new $l,$b($l,["TEMPVector30",function(){return this.TEMPVector30=new $aI},"TEMPVector31",function(){return this.TEMPVector31=new $aI},"TEMPVector32",function(){return this.TEMPVector32=new $aI},"TEMPVector33",function(){return this.TEMPVector33=new $aI},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $xI},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $xI},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $Gx},"NAN",function(){return this.NAN=new $l(NaN,NaN,NaN,NaN)}]),$l}(),$kI=function(){function $x($x){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$x,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$_($x,"laya.d3.math.Rand");var $I=$x.prototype;return $I.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$I.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$I.getSignedFloat=function(){return 2*this.getFloat()-1},$R(0,$I,"seed",function(){return this.seeds[0]},function($x){this.seeds[0]=$x,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$x.getFloatFromInt=function($x){return 1/8388607*(8388607&$x)},$x.getByteFromInt=function($x){return(8388607&$x)>>>15},$x}(),$lI=(function(){function $l($x){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($x instanceof Array)||4!==$x.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$x[0],this._state0L=0|$x[1],this._state1U=0|$x[2],this._state1L=0|$x[3]}$_($l,"laya.d3.math.RandX");var $x=$l.prototype;$x.randomint=function(){var $x=this._state0U,$I=this._state0L,$z=this._state1U,$k=this._state1L,$l=($k>>>0)+($I>>>0),$n=$z+$x+($l/2>>>31)>>>0,$a=$l>>>0,$$=0,$w=0;$$=($x^=$$=$x<<23|(-512&$I)>>>9)^(this._state0U=$z),$w=($I^=$w=$I<<23)^(this._state0L=$k);$$^=$x>>>18,$w^=$I>>>18|(262143&$x)<<14;return $$^=$z>>>5,$w^=$k>>>5|(31&$z)<<27,this._state1U=$$,this._state1L=$w,[$n,$a]},$x.random=function(){var $x=this.randomint(),$I=$x[0],$z=1023<<20|$I>>>12,$k=0|($x[1]>>>12|(4095&$I)<<20);return $l._CONVERTION_BUFFER.setUint32(0,$z,!1),$l._CONVERTION_BUFFER.setUint32(4,$k,!1),$kI._CONVERTION_BUFFER.getFloat64(0,!1)-1},$b($l,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $kI([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $x($x,$I){this.origin=null,this.direction=null,this.origin=$x,this.direction=$I}return $_($x,"laya.d3.math.Ray"),$x}()),$nI=function(){function $x($x,$I){this.elements=new Float32Array(2),void 0===$x&&($x=0),void 0===$I&&($I=0);var $z=this.elements;$z[0]=$x,$z[1]=$I}$_($x,"laya.d3.math.Vector2");var $I=$x.prototype;return $C.imps($I,{"laya.d3.core.IClone":!0}),$I.fromArray=function($x,$I){void 0===$I&&($I=0),this.elements[0]=$x[$I+0],this.elements[1]=$x[$I+1]},$I.cloneTo=function($x){var $I=$x.elements,$z=this.elements;$I[0]=$z[0],$I[1]=$z[1]},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"x",function(){return this.elements[0]},function($x){this.elements[0]=$x}),$R(0,$I,"y",function(){return this.elements[1]},function($x){this.elements[1]=$x}),$x.scale=function($x,$I,$z){var $k=$z.elements,$l=$x.elements;$k[0]=$l[0]*$I,$k[1]=$l[1]*$I},$b($x,["ZERO",function(){return this.ZERO=new $x(0,0)},"ONE",function(){return this.ONE=new $x(1,1)}]),$x}(),$aI=function(){function $F($x,$I,$z){this.elements=new Float32Array(3),void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0);var $k=this.elements;$k[0]=$x,$k[1]=$I,$k[2]=$z}$_($F,"laya.d3.math.Vector3");var $x=$F.prototype;return $C.imps($x,{"laya.d3.core.IClone":!0}),$x.fromArray=function($x,$I){void 0===$I&&($I=0),this.elements[0]=$x[$I+0],this.elements[1]=$x[$I+1],this.elements[2]=$x[$I+2]},$x.cloneTo=function($x){var $I=$x.elements,$z=this.elements;$I[0]=$z[0],$I[1]=$z[1],$I[2]=$z[2]},$x.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$x.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$x.reset=function($x,$I,$z){this.elements[0]=$x,this.elements[1]=$I,this.elements[2]=$z},$R(0,$x,"x",function(){return this.elements[0]},function($x){this.elements[0]=$x}),$R(0,$x,"y",function(){return this.elements[1]},function($x){this.elements[1]=$x}),$R(0,$x,"z",function(){return this.elements[2]},function($x){this.elements[2]=$x}),$F.distanceSquared=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$z[0]-$k[0],$n=$z[1]-$k[1],$a=$z[2]-$k[2];return $l*$l+$n*$n+$a*$a},$F.distance=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$z[0]-$k[0],$n=$z[1]-$k[1],$a=$z[2]-$k[2];return Math.sqrt($l*$l+$n*$n+$a*$a)},$F.min=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=Math.min($l[0],$n[0]),$k[1]=Math.min($l[1],$n[1]),$k[2]=Math.min($l[2],$n[2])},$F.max=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=Math.max($l[0],$n[0]),$k[1]=Math.max($l[1],$n[1]),$k[2]=Math.max($l[2],$n[2])},$F.transformQuat=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements,$a=$l[0],$$=$l[1],$w=$l[2],$i=$n[0],$F=$n[1],$b=$n[2],$T=$n[3],$_=$T*$a+$F*$w-$b*$$,$R=$T*$$+$b*$a-$i*$w,$s=$T*$w+$i*$$-$F*$a,$N=-$i*$a-$F*$$-$b*$w;$k[0]=$_*$T+$N*-$i+$R*-$b-$s*-$F,$k[1]=$R*$T+$N*-$F+$s*-$i-$_*-$b,$k[2]=$s*$T+$N*-$b+$_*-$F-$R*-$i},$F.scalarLength=function($x){var $I=$x.elements,$z=$I[0],$k=$I[1],$l=$I[2];return Math.sqrt($z*$z+$k*$k+$l*$l)},$F.scalarLengthSquared=function($x){var $I=$x.elements,$z=$I[0],$k=$I[1],$l=$I[2];return $z*$z+$k*$k+$l*$l},$F.normalize=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$z[0],$n=$z[1],$a=$z[2],$$=$l*$l+$n*$n+$a*$a;0<$$&&($$=1/Math.sqrt($$),$k[0]=$z[0]*$$,$k[1]=$z[1]*$$,$k[2]=$z[2]*$$)},$F.multiply=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=$l[0]*$n[0],$k[1]=$l[1]*$n[1],$k[2]=$l[2]*$n[2]},$F.scale=function($x,$I,$z){var $k=$z.elements,$l=$x.elements;$k[0]=$l[0]*$I,$k[1]=$l[1]*$I,$k[2]=$l[2]*$I},$F.lerp=function($x,$I,$z,$k){var $l=$k.elements,$n=$x.elements,$a=$I.elements,$$=$n[0],$w=$n[1],$i=$n[2];$l[0]=$$+$z*($a[0]-$$),$l[1]=$w+$z*($a[1]-$w),$l[2]=$i+$z*($a[2]-$i)},$F.transformV3ToV3=function($x,$I,$z){var $k=$F._tempVector4;$F.transformV3ToV4($x,$I,$k);var $l=$k.elements,$n=$z.elements;$n[0]=$l[0],$n[1]=$l[1],$n[2]=$l[2]},$F.transformV3ToV4=function($x,$I,$z){var $k=$x.elements,$l=$k[0],$n=$k[1],$a=$k[2],$$=$I.elements,$w=$z.elements;$w[0]=$l*$$[0]+$n*$$[4]+$a*$$[8]+$$[12],$w[1]=$l*$$[1]+$n*$$[5]+$a*$$[9]+$$[13],$w[2]=$l*$$[2]+$n*$$[6]+$a*$$[10]+$$[14],$w[3]=$l*$$[3]+$n*$$[7]+$a*$$[11]+$$[15]},$F.TransformNormal=function($x,$I,$z){var $k=$x.elements,$l=$k[0],$n=$k[1],$a=$k[2],$$=$I.elements,$w=$z.elements;$w[0]=$l*$$[0]+$n*$$[4]+$a*$$[8],$w[1]=$l*$$[1]+$n*$$[5]+$a*$$[9],$w[2]=$l*$$[2]+$n*$$[6]+$a*$$[10]},$F.transformCoordinate=function($x,$I,$z){var $k=$F._tempVector4.elements,$l=$x.elements,$n=$l[0],$a=$l[1],$$=$l[2],$w=$I.elements;$k[0]=$n*$w[0]+$a*$w[4]+$$*$w[8]+$w[12],$k[1]=$n*$w[1]+$a*$w[5]+$$*$w[9]+$w[13],$k[2]=$n*$w[2]+$a*$w[6]+$$*$w[10]+$w[14],$k[3]=1/($n*$w[3]+$a*$w[7]+$$*$w[11]+$w[15]);var $i=$z.elements;$i[0]=$k[0]*$k[3],$i[1]=$k[1]*$k[3],$i[2]=$k[2]*$k[3]},$F.Clamp=function($x,$I,$z,$k){var $l=$x.elements,$n=$l[0],$a=$l[1],$$=$l[2],$w=$I.elements,$i=$w[0],$F=$w[1],$b=$w[2],$T=$z.elements,$_=$T[0],$R=$T[1],$s=$T[2],$N=$k.elements;$n=($n=$_<$n?$_:$n)<$i?$i:$n,$a=($a=$R<$a?$R:$a)<$F?$F:$a,$$=($$=$s<$$?$s:$$)<$b?$b:$$,$N[0]=$n,$N[1]=$a,$N[2]=$$},$F.add=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=$l[0]+$n[0],$k[1]=$l[1]+$n[1],$k[2]=$l[2]+$n[2]},$F.subtract=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=$l[0]-$n[0],$k[1]=$l[1]-$n[1],$k[2]=$l[2]-$n[2]},$F.cross=function($x,$I,$z){var $k=$x.elements,$l=$I.elements,$n=$z.elements,$a=$k[0],$$=$k[1],$w=$k[2],$i=$l[0],$F=$l[1],$b=$l[2];$n[0]=$$*$b-$w*$F,$n[1]=$w*$i-$a*$b,$n[2]=$a*$F-$$*$i},$F.dot=function($x,$I){var $z=$x.elements,$k=$I.elements;return $z[0]*$k[0]+$z[1]*$k[1]+$z[2]*$k[2]},$F.equals=function($x,$I){var $z=$x.elements,$k=$I.elements;return $Qx.nearEqual(Math.abs($z[0]),Math.abs($k[0]))&&$Qx.nearEqual(Math.abs($z[1]),Math.abs($k[1]))&&$Qx.nearEqual(Math.abs($z[2]),Math.abs($k[2]))},$F.ZERO=new $F(0,0,0),$F.ONE=new $F(1,1,1),$F.NegativeUnitX=new $F(-1,0,0),$F.UnitX=new $F(1,0,0),$F.UnitY=new $F(0,1,0),$F.UnitZ=new $F(0,0,1),$F.ForwardRH=new $F(0,0,-1),$F.ForwardLH=new $F(0,0,1),$F.Up=new $F(0,1,0),$F.NAN=new $F(NaN,NaN,NaN),$b($F,["_tempVector4",function(){return this._tempVector4=new $$I}]),$F}(),$$I=function(){function $x($x,$I,$z,$k){this.elements=new Float32Array(4),void 0===$x&&($x=0),void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=0);var $l=this.elements;$l[0]=$x,$l[1]=$I,$l[2]=$z,$l[3]=$k}$_($x,"laya.d3.math.Vector4");var $I=$x.prototype;return $C.imps($I,{"laya.d3.core.IClone":!0}),$I.fromArray=function($x,$I){void 0===$I&&($I=0),this.elements[0]=$x[$I+0],this.elements[1]=$x[$I+1],this.elements[2]=$x[$I+2],this.elements[3]=$x[$I+3]},$I.cloneTo=function($x){var $I=$x.elements,$z=this.elements;$I[0]=$z[0],$I[1]=$z[1],$I[2]=$z[2],$I[3]=$z[3]},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$I.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$I.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$R(0,$I,"x",function(){return this.elements[0]},function($x){this.elements[0]=$x}),$R(0,$I,"y",function(){return this.elements[1]},function($x){this.elements[1]=$x}),$R(0,$I,"z",function(){return this.elements[2]},function($x){this.elements[2]=$x}),$R(0,$I,"w",function(){return this.elements[3]},function($x){this.elements[3]=$x}),$x.lerp=function($x,$I,$z,$k){var $l=$k.elements,$n=$x.elements,$a=$I.elements,$$=$n[0],$w=$n[1],$i=$n[2],$F=$n[3];$l[0]=$$+$z*($a[0]-$$),$l[1]=$w+$z*($a[1]-$w),$l[2]=$i+$z*($a[2]-$i),$l[3]=$F+$z*($a[3]-$F)},$x.transformByM4x4=function($x,$I,$z){var $k=$x.elements,$l=$k[0],$n=$k[1],$a=$k[2],$$=$k[3],$w=$I.elements,$i=$z.elements;$i[0]=$l*$w[0]+$n*$w[4]+$a*$w[8]+$$*$w[12],$i[1]=$l*$w[1]+$n*$w[5]+$a*$w[9]+$$*$w[13],$i[2]=$l*$w[2]+$n*$w[6]+$a*$w[10]+$$*$w[14],$i[3]=$l*$w[3]+$n*$w[7]+$a*$w[11]+$$*$w[15]},$x.equals=function($x,$I){var $z=$x.elements,$k=$I.elements;return $Qx.nearEqual(Math.abs($z[0]),Math.abs($k[0]))&&$Qx.nearEqual(Math.abs($z[1]),Math.abs($k[1]))&&$Qx.nearEqual(Math.abs($z[2]),Math.abs($k[2]))&&$Qx.nearEqual(Math.abs($z[3]),Math.abs($k[3]))},$x.normalize=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$x.length();0<$l&&($k[0]=$z[0]*$l,$k[1]=$z[1]*$l,$k[2]=$z[2]*$l,$k[3]=$z[3]*$l)},$x.add=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=$l[0]+$n[0],$k[1]=$l[1]+$n[1],$k[2]=$l[2]+$n[2],$k[3]=$l[3]+$n[3]},$x.subtract=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=$l[0]-$n[0],$k[1]=$l[1]-$n[1],$k[2]=$l[2]-$n[2],$k[3]=$l[3]-$n[3]},$x.multiply=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=$l[0]*$n[0],$k[1]=$l[1]*$n[1],$k[2]=$l[2]*$n[2],$k[3]=$l[3]*$n[3]},$x.scale=function($x,$I,$z){var $k=$z.elements,$l=$x.elements;$k[0]=$l[0]*$I,$k[1]=$l[1]*$I,$k[2]=$l[2]*$I,$k[3]=$l[3]*$I},$x.Clamp=function($x,$I,$z,$k){var $l=$x.elements,$n=$l[0],$a=$l[1],$$=$l[2],$w=$l[3],$i=$I.elements,$F=$i[0],$b=$i[1],$T=$i[2],$_=$i[3],$R=$z.elements,$s=$R[0],$N=$R[1],$D=$R[2],$f=$R[3],$m=$k.elements;$n=($n=$s<$n?$s:$n)<$F?$F:$n,$a=($a=$N<$a?$N:$a)<$b?$b:$a,$$=($$=$D<$$?$D:$$)<$T?$T:$$,$w=($w=$f<$w?$f:$w)<$_?$_:$w,$m[0]=$n,$m[1]=$a,$m[2]=$$,$m[3]=$w},$x.distanceSquared=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$z[0]-$k[0],$n=$z[1]-$k[1],$a=$z[2]-$k[2],$$=$z[3]-$k[3];return $l*$l+$n*$n+$a*$a+$$*$$},$x.distance=function($x,$I){var $z=$x.elements,$k=$I.elements,$l=$z[0]-$k[0],$n=$z[1]-$k[1],$a=$z[2]-$k[2],$$=$z[3]-$k[3];return Math.sqrt($l*$l+$n*$n+$a*$a+$$*$$)},$x.dot=function($x,$I){var $z=$x.elements,$k=$I.elements;return $z[0]*$k[0]+$z[1]*$k[1]+$z[2]*$k[2]+$z[3]*$k[3]},$x.min=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=Math.min($l[0],$n[0]),$k[1]=Math.min($l[1],$n[1]),$k[2]=Math.min($l[2],$n[2]),$k[3]=Math.min($l[3],$n[3])},$x.max=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I.elements;$k[0]=Math.max($l[0],$n[0]),$k[1]=Math.max($l[1],$n[1]),$k[2]=Math.max($l[2],$n[2]),$k[3]=Math.max($l[3],$n[3])},$b($x,["ZERO",function(){return this.ZERO=new $x},"ONE",function(){return this.ONE=new $x(1,1,1,1)},"UnitX",function(){return this.UnitX=new $x(1,0,0,0)},"UnitY",function(){return this.UnitY=new $x(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $x(0,0,1,0)},"UnitW",function(){return this.UnitW=new $x(0,0,0,1)}]),$x}(),$wI=function(){function $n($x,$I,$z,$k){this.minDepth=0,this.maxDepth=1,this.x=$x,this.y=$I,this.width=$z,this.height=$k}$_($n,"laya.d3.math.Viewport");var $x=$n.prototype;return $x.project=function($x,$I,$z){$aI.transformV3ToV3($x,$I,$z);var $k=$x.elements,$l=$I.elements,$n=$z.elements,$a=$k[0]*$l[3]+$k[1]*$l[7]+$k[2]*$l[11]+$l[15];1!==$a&&($n[0]=$n[0]/$a,$n[1]=$n[1]/$a,$n[2]=$n[2]/$a),$n[0]=.5*($n[0]+1)*this.width+this.x,$n[1]=.5*(1-$n[1])*this.height+this.y,$n[2]=$n[2]*(this.maxDepth-this.minDepth)+this.minDepth},$x.unprojectFromMat=function($x,$I,$z){var $k=$x.elements,$l=$I.elements,$n=$z.elements;$n[0]=($k[0]-this.x)/this.width*2-1,$n[1]=-(($k[1]-this.y)/this.height*2-1);var $a=(this.maxDepth-this.minDepth)/2;$n[2]=($k[2]-this.minDepth-$a)/$a;var $$=$n[0]*$l[3]+$n[1]*$l[7]+$n[2]*$l[11]+$l[15];$aI.transformV3ToV3($z,$I,$z),1!==$$&&($n[0]=$n[0]/$$,$n[1]=$n[1]/$$,$n[2]=$n[2]/$$)},$x.unprojectFromWVP=function($x,$I,$z,$k,$l){$xI.multiply($I,$z,$n._tempMatrix4x4),$k&&$xI.multiply($n._tempMatrix4x4,$k,$n._tempMatrix4x4),$n._tempMatrix4x4.invert($n._tempMatrix4x4),this.unprojectFromMat($x,$n._tempMatrix4x4,$l)},$b($n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $xI}]),$n}(),$iI=function(){function $S($x){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$x,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$_($S,"laya.d3.resource.models.SubMesh");var $x=$S.prototype;return $C.imps($x,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$x._getVertexBuffer=function($x){return void 0===$x&&($x=0),0===$x?this._vertexBuffer:null},$x._getIndexBuffer=function(){return this._indexBuffer},$x._getStaticBatchBakedVertexs=function($x,$I){var $z,$k,$l=this._vertexBuffer,$n=$l.vertexDeclaration,$a=$n.getVertexElementByUsage(0).offset/4,$$=$n.getVertexElementByUsage(3).offset/4,$w=$I.meshRender.lightmapScaleOffset,$i=0,$F=0,$b=0,$T=0,$_=0,$R=0;if($w)if($k=$n.getVertexElementByUsage(15))$b=$n.vertexStride/4,$z=0<this._vertexCount?$l.getData().slice(this._vertexStart*$b,(this._vertexStart+this._vertexCount)*$b):$l.getData().slice(),$T=$k.offset/4;else{$b=($R=$n.vertexStride/4)+2,$z=this._vertexCount?new Float32Array(this._vertexCount*($l.vertexDeclaration.vertexStride/4+2)):new Float32Array($l.vertexCount*($l.vertexDeclaration.vertexStride/4+2)),$T=($_=$n.getVertexElementByUsage(2).offset/4)+2;var $s=$l.getData();for($i=0,$F=$s.length/$R;$i<$F;$i++){var $N=0;$N=0<this._vertexCount?(this._vertexStart+$i)*$R:$i*$R;var $D=$i*$b,$f=0;for($f=0;$f<$T;$f++)$z[$D+$f]=$s[$N+$f];for($f=$T;$f<$R;$f++)$z[$D+$f+2]=$s[$N+$f]}}else $b=$n.vertexStride/4,$z=this._vertexCount?$l.getData().slice(this._vertexStart*$b,(this._vertexStart+this._vertexCount)*$b):$l.getData().slice();if($x){var $m=$x.worldMatrix,$y=$S._tempMatrix4x40;$m.invert($y);var $C=$S._tempMatrix4x41,$P=$I.transform.worldMatrix;$xI.multiply($y,$P,$C)}else $C=$I.transform.worldMatrix;var $v=$S._tempQuaternion0;for($C.decomposeTransRotScale($S._tempVector30,$v,$S._tempVector31),$i=0,$F=$z.length/$b;$i<$F;$i++){var $L=$i*$b+$a,$K=$i*$b+$$;if($NI.transformVector3ArrayToVector3ArrayCoordinate($z,$L,$C,$z,$L),$NI.transformVector3ArrayByQuat($z,$K,$v,$z,$K),$w){var $E=$i*$b+$T;if($k)$NI.transformLightingMapTexcoordByUV1Array($z,$E,$w,$z,$E);else{var $O=$i*$R+$_;$NI.transformLightingMapTexcoordByUV0Array($s,$O,$w,$z,$E)}}}return $z},$x._getVertexBuffers=function(){return null},$x._beforeRender=function($x){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$x._render=function($x){var $I,$z=0,$k=$x.renderElement;if(1<this._indexCount){var $l=this._boneIndicesList.length;if(1<$l){for(var $n=0;$n<$l;$n++)($I=$k._skinAnimationDatas||this._skinAnimationDatas)&&($k._shaderValue.setValue(0,$I[$n]),$x._shader.uploadRenderElementUniforms($k._shaderValue.data)),$Z.mainContext.drawElements(4,this._subIndexBufferCount[$n],5123,2*this._subIndexBufferStart[$n]);$L.drawCall+=$l}else($I=$k._skinAnimationDatas||this._skinAnimationDatas)&&($k._shaderValue.setValue(0,$I[0]),$x._shader.uploadRenderElementUniforms($k._shaderValue.data)),$Z.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$L.drawCall++;$z=this._indexCount}else $z=this._indexBuffer.indexCount,($I=$k._skinAnimationDatas||this._skinAnimationDatas)&&($k._shaderValue.setValue(0,$I[0]),$x._shader.uploadRenderElementUniforms($k._shaderValue.data)),$Z.mainContext.drawElements(4,$z,5123,0),$L.drawCall++;$L.trianglesFaces+=$z/3},$x.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$x.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$R(0,$x,"_vertexBufferCount",function(){return 1}),$R(0,$x,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$b($S,["_tempVector30",function(){return this._tempVector30=new $aI},"_tempVector31",function(){return this._tempVector31=new $aI},"_tempQuaternion0",function(){return this._tempQuaternion0=new $zI},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $xI},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $xI}]),$S}(),$FI=function(){function $x($x){this.defineCounter=0,this.defines=null,$x?(this.defineCounter=$x.defineCounter,this.defines=$x.defines.slice()):(this.defineCounter=0,this.defines=[])}return $_($x,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$x.prototype.registerDefine=function($x){var $I=Math.pow(2,this.defineCounter++);return this.defines[$I]=$x,$I},$x}(),$bI=function(){function $x(){}return $_($x,"laya.d3.shader.ShaderInit3D"),$x.__init__=function(){var $x,$I;$LI._globalRegDefine("HIGHPRECISION",$LI.SHADERDEFINE_HIGHPRECISION),$LI._globalRegDefine("FOG",$LI.SHADERDEFINE_FOG),$LI._globalRegDefine("DIRECTIONLIGHT",$LI.SHADERDEFINE_DIRECTIONLIGHT),$LI._globalRegDefine("POINTLIGHT",$LI.SHADERDEFINE_POINTLIGHT),$LI._globalRegDefine("SPOTLIGHT",$LI.SHADERDEFINE_SPOTLIGHT),$LI._globalRegDefine("UV",$LI.SHADERDEFINE_UV0),$LI._globalRegDefine("COLOR",$LI.SHADERDEFINE_COLOR),$LI._globalRegDefine("UV1",$LI.SHADERDEFINE_UV1),$LI._globalRegDefine("CASTSHADOW",$_I.SHADERDEFINE_CAST_SHADOW),$LI._globalRegDefine("SHADOWMAP_PSSM1",$_I.SHADERDEFINE_SHADOW_PSSM1),$LI._globalRegDefine("SHADOWMAP_PSSM2",$_I.SHADERDEFINE_SHADOW_PSSM2),$LI._globalRegDefine("SHADOWMAP_PSSM3",$_I.SHADERDEFINE_SHADOW_PSSM3),$LI._globalRegDefine("SHADOWMAP_PCF_NO",$_I.SHADERDEFINE_SHADOW_PCF_NO),$LI._globalRegDefine("SHADOWMAP_PCF1",$_I.SHADERDEFINE_SHADOW_PCF1),$LI._globalRegDefine("SHADOWMAP_PCF2",$_I.SHADERDEFINE_SHADOW_PCF2),$LI._globalRegDefine("SHADOWMAP_PCF3",$_I.SHADERDEFINE_SHADOW_PCF3),$LI._globalRegDefine("DEPTHFOG",$LI.SAHDERDEFINE_DEPTHFOG),$YI.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$YI.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$x={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$I={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $z=$YI.nameKey.add("SIMPLE");var $k=$LI.add($z,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$x,$I);$cI.SHADERDEFINE_DIFFUSEMAP=$k.registerMaterialDefine("DIFFUSEMAP"),$cI.SHADERDEFINE_NORMALMAP=$k.registerMaterialDefine("NORMALMAP"),$cI.SHADERDEFINE_SPECULARMAP=$k.registerMaterialDefine("SPECULARMAP"),$cI.SHADERDEFINE_EMISSIVEMAP=$k.registerMaterialDefine("EMISSIVEMAP"),$cI.SHADERDEFINE_AMBIENTMAP=$k.registerMaterialDefine("AMBIENTMAP"),$cI.SHADERDEFINE_REFLECTMAP=$k.registerMaterialDefine("REFLECTMAP"),$cI.SHADERDEFINE_UVTRANSFORM=$k.registerMaterialDefine("UVTRANSFORM"),$cI.SHADERDEFINE_TILINGOFFSET=$k.registerMaterialDefine("TILINGOFFSET"),$cI.SHADERDEFINE_ADDTIVEFOG=$k.registerMaterialDefine("ADDTIVEFOG")},$x}(),$TI=function(){function $x(){this._data=null,this._data=[]}$_($x,"laya.d3.shader.ValusArray");var $I=$x.prototype;return $I.setValue=function($x,$I){this._data[$x]=$I},$R(0,$I,"data",function(){return this._data}),$x}(),$_I=function(){function $x(){}return $x.SHADERDEFINE_RECEIVE_SHADOW=1,$x.SHADERDEFINE_CAST_SHADOW=512,$x.SHADERDEFINE_SHADOW_PSSM1=1024,$x.SHADERDEFINE_SHADOW_PSSM2=2048,$x.SHADERDEFINE_SHADOW_PSSM3=4096,$x.SHADERDEFINE_SHADOW_PCF_NO=8192,$x.SHADERDEFINE_SHADOW_PCF1=16384,$x.SHADERDEFINE_SHADOW_PCF2=32768,$x.SHADERDEFINE_SHADOW_PCF3=65536,$x.MAX_PSSM_COUNT=3,$x}(),$RI=function(){function $p(){}return $_($p,"laya.d3.utils.Picker"),$p.calculateCursorRay=function($x,$I,$z,$k,$l,$n){var $a=$x.elements[0],$$=$x.elements[1],$w=$p._tempVector30,$i=$w.elements;$i[0]=$a,$i[1]=$$,$i[2]=$I.minDepth;var $F=$p._tempVector31,$b=$F.elements;$b[0]=$a,$b[1]=$$,$b[2]=$I.maxDepth;var $T=$n.origin,$_=$p._tempVector32;$I.unprojectFromWVP($w,$z,$k,$l,$T),$I.unprojectFromWVP($F,$z,$k,$l,$_);var $R=$n.direction.elements;$R[0]=$_.x-$T.x,$R[1]=$_.y-$T.y,$R[2]=$_.z-$T.z,$aI.normalize($n.direction,$n.direction)},$p.rayIntersectsPositionsAndIndices=function($x,$I,$z,$k,$l){for(var $n=$z.vertexStride/4,$a=$z.getVertexElementByUsage(0).offset/4,$$=Number.MAX_VALUE,$w=-1,$i=-1,$F=-1,$b=0;$b<$k.length;$b+=3){var $T=$p._tempVector35,$_=$T.elements,$R=$k[$b]*$n,$s=$R+$a;$_[0]=$I[$s],$_[1]=$I[1+$s],$_[2]=$I[2+$s];var $N=$p._tempVector36,$D=$N.elements,$f=$k[$b+1]*$n,$m=$f+$a;$D[0]=$I[$m],$D[1]=$I[1+$m],$D[2]=$I[2+$m];var $y=$p._tempVector37,$C=$y.elements,$P=$k[$b+2]*$n,$v=$P+$a;$C[0]=$I[$v],$C[1]=$I[1+$v],$C[2]=$I[2+$v];var $L=laya.d3.utils.Picker.rayIntersectsTriangle($x,$T,$N,$y);!isNaN($L)&&$L<$$&&($$=$L,$w=$R,$i=$f,$F=$P)}if($$===Number.MAX_VALUE)return $l.position.toDefault(),$l.distance=Number.MAX_VALUE,$l.trianglePositions[0].toDefault(),$l.trianglePositions[1].toDefault(),$l.trianglePositions[2].toDefault(),$l.triangleNormals[0].toDefault(),$l.triangleNormals[1].toDefault(),$l.triangleNormals[2].toDefault(),!1;$l.distance=$$,$aI.scale($x.direction,$$,$l.position),$aI.add($x.origin,$l.position,$l.position);var $K=$l.trianglePositions,$E=$K[0],$O=$K[1],$S=$K[2],$Z=$E.elements,$U=$O.elements,$X=$S.elements,$d=$w+$a;$Z[0]=$I[$d],$Z[1]=$I[$d+1],$Z[2]=$I[$d+2];var $j=$i+$a;$U[0]=$I[$j],$U[1]=$I[$j+1],$U[2]=$I[$j+2];var $t=$F+$a;$X[0]=$I[$t],$X[1]=$I[$t+1],$X[2]=$I[$t+2];var $Y=$z.getVertexElementByUsage(3);if($Y){var $c=$Y.offset/4,$V=$l.triangleNormals,$W=$V[0],$q=$V[1],$o=$V[2],$J=$W.elements,$h=$q.elements,$B=$o.elements,$e=$w+$c;$J[0]=$I[$e],$J[1]=$I[$e+1],$J[2]=$I[$e+2];var $A=$i+$c;$h[0]=$I[$A],$h[1]=$I[$A+1],$h[2]=$I[$A+2];var $H=$F+$c;$B[0]=$I[$H],$B[1]=$I[$H+1],$B[2]=$I[$H+2]}return!0},$p.rayIntersectsTriangle=function($x,$I,$z,$k){var $l=$p._tempVector30,$n=$p._tempVector31;$aI.subtract($z,$I,$l),$aI.subtract($k,$I,$n);var $a,$$=$p._tempVector32;if($aI.cross($x.direction,$n,$$),($a=$aI.dot($l,$$))>-Number.MIN_VALUE&&$a<Number.MIN_VALUE)return Number.NaN;var $w,$i=1/$a,$F=$p._tempVector33;if($aI.subtract($x.origin,$I,$F),$w=$aI.dot($F,$$),($w*=$i)<0||1<$w)return Number.NaN;var $b,$T,$_=$p._tempVector34;return $aI.cross($F,$l,$_),$b=$aI.dot($x.direction,$_),($b*=$i)<0||1<$w+$b?Number.NaN:($T=$aI.dot($n,$_),($T*=$i)<0?Number.NaN:$T)},$b($p,["_tempVector30",function(){return this._tempVector30=new $aI},"_tempVector31",function(){return this._tempVector31=new $aI},"_tempVector32",function(){return this._tempVector32=new $aI},"_tempVector33",function(){return this._tempVector33=new $aI},"_tempVector34",function(){return this._tempVector34=new $aI},"_tempVector35",function(){return this._tempVector35=new $aI},"_tempVector36",function(){return this._tempVector36=new $aI},"_tempVector37",function(){return this._tempVector37=new $aI}]),$p}(),$sI=(function(){function $x(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $aI,new $aI,new $aI],this.trianglePositions.length=3,this.triangleNormals=[new $aI,new $aI,new $aI],this.triangleNormals.length=3,this.position=new $aI}$_($x,"laya.d3.utils.RaycastHit"),$x.prototype.cloneTo=function($x){$x.distance=this.distance,this.trianglePositions[0].cloneTo($x.trianglePositions[0]),this.trianglePositions[1].cloneTo($x.trianglePositions[1]),this.trianglePositions[2].cloneTo($x.trianglePositions[2]),this.triangleNormals[0].cloneTo($x.triangleNormals[0]),this.triangleNormals[1].cloneTo($x.triangleNormals[1]),this.triangleNormals[2].cloneTo($x.triangleNormals[2]),this.position.cloneTo($x.position),$x.sprite3D=this.sprite3D}}(),function(){function $x($x,$I){this._width=0,this._height=0,this._width=$x,this._height=$I}$_($x,"laya.d3.utils.Size");var $I=$x.prototype;return $R(0,$I,"width",function(){return-1===this._width?$u.clientWidth:this._width}),$R(0,$I,"height",function(){return-1===this._height?$u.clientHeight:this._height}),$R(1,$x,"fullScreen",function(){return new $x(-1,-1)}),$x}()),$NI=function(){function $d(){}return $_($d,"laya.d3.utils.Utils3D"),$d._rotationTransformScaleSkinAnimation=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b){var $T,$_,$R,$s,$N,$D=$d._tempArray16_0,$f=$d._tempArray16_1,$m=$d._tempArray16_2,$y=$k+$k,$C=$l+$l,$P=$n+$n,$v=$k*$y,$L=$l*$y,$K=$l*$C,$E=$n*$y,$O=$n*$C,$S=$n*$P,$Z=$a*$y,$U=$a*$C,$X=$a*$P;for($D[15]=1,$D[0]=1-$K-$S,$D[1]=$L+$X,$D[2]=$E-$U,$D[4]=$L-$X,$D[5]=1-$v-$S,$D[6]=$O+$Z,$D[8]=$E+$U,$D[9]=$O-$Z,$D[10]=1-$v-$K,$f[15]=1,$f[0]=$$,$f[5]=$w,$f[10]=$i,$T=0;$T<4;$T++)$_=$D[$T],$R=$D[$T+4],$s=$D[$T+8],$N=$D[$T+12],$m[$T]=$_,$m[$T+4]=$R,$m[$T+8]=$s,$m[$T+12]=$_*$x+$R*$I+$s*$z+$N;for($T=0;$T<4;$T++)$_=$m[$T],$R=$m[$T+4],$s=$m[$T+8],$N=$m[$T+12],$F[$T+$b]=$_*$f[0]+$R*$f[1]+$s*$f[2]+$N*$f[3],$F[$T+$b+4]=$_*$f[4]+$R*$f[5]+$s*$f[6]+$N*$f[7],$F[$T+$b+8]=$_*$f[8]+$R*$f[9]+$s*$f[10]+$N*$f[11],$F[$T+$b+12]=$_*$f[12]+$R*$f[13]+$s*$f[14]+$N*$f[15]},$d._createNodeByJson=function($x,$I,$z,$k){if(!$z)switch($I.type){case"Sprite3D":$z=new $tI;break;case"MeshSprite3D":$z=new $pI;break;case"SkinnedMeshSprite3D":$z=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$z=new ShuriKenParticle3D;break;case"TrailSprite3D":$z=new TrailSprite3D;break;case"Terrain":$z=new Terrain;break;case"Camera":$z=new $HI;break;case"DirectionLight":$z=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $l=$I.props;if($l)for(var $n in $l)$z[$n]=$l[$n];var $a=$I.customProps;$a&&($z instanceof laya.d3.core.Sprite3D?($z._parseBaseCustomProps($a),$z._parseCustomProps($x,$k,$a,$I),$z._parseCustomComponent($x,$k,$I.components)):$z._parseCustomProps($x,$k,$a,$I));var $$=$I.child;if($$)for(var $w=0,$i=$$.length;$w<$i;$w++){var $F=$d._createNodeByJson($x,$$[$w],null,$k);$z.addChild($F)}return $z},$d._computeBoneAndAnimationDatasByBindPoseMatrxix=function($x,$I,$z,$k,$l,$n){var $a,$$,$w=0,$i=0,$F=$x.length;for($a=0;$a<$F;$w+=$x[$a].keyframeWidth,$i+=16,$a++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($I[$w+0],$I[$w+1],$I[$w+2],$I[$w+3],$I[$w+4],$I[$w+5],$I[$w+6],$I[$w+7],$I[$w+8],$I[$w+9],$k,$i),0!=$a&&($$=16*$x[$a].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($k,$$,$k,$i,$k,$i));var $b=$z.length;for($a=0;$a<$b;$a++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($k,16*$n[$a],$z[$a],$l,16*$a)},$d._computeAnimationDatasByArrayAndMatrixFast=function($x,$I,$z,$k){for(var $l=0,$n=$x.length;$l<$n;$l++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($I,16*$k[$l],$x[$l],$z,16*$l)},$d._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($x,$I,$z,$k,$l){var $n,$a,$$=0,$w=0,$i=$x.length;for($n=0;$n<$i;$$+=$x[$n].keyframeWidth,$w+=16,$n++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($I[$$+7],$I[$$+8],$I[$$+9],$I[$$+3],$I[$$+4],$I[$$+5],$I[$$+6],$I[$$+0],$I[$$+1],$I[$$+2],$k,$w),0!=$n&&($a=16*$x[$n].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($k,$a,$k,$w,$k,$w));var $F=$z.length;for($n=0;$n<$F;$n++){var $b=16*$n;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($k,$b,$z[$n],$l,$b)}},$d._computeAnimationDatasByArrayAndMatrixFastOld=function($x,$I,$z){for(var $k=$x.length,$l=0;$l<$k;$l++){var $n=16*$l;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($I,$n,$x[$l],$z,$n)}},$d._computeRootAnimationData=function($x,$I,$z){for(var $k=0,$l=0,$n=0,$a=$x.length;$k<$a;$l+=$x[$k].keyframeWidth,$n+=16,$k++)laya.d3.utils.Utils3D.createAffineTransformationArray($I[$l+0],$I[$l+1],$I[$l+2],$I[$l+3],$I[$l+4],$I[$l+5],$I[$l+6],$I[$l+7],$I[$l+8],$I[$l+9],$z,$n)},$d.transformVector3ArrayByQuat=function($x,$I,$z,$k,$l){var $n=$z.elements,$a=$x[$I],$$=$x[$I+1],$w=$x[$I+2],$i=$n[0],$F=$n[1],$b=$n[2],$T=$n[3],$_=$T*$a+$F*$w-$b*$$,$R=$T*$$+$b*$a-$i*$w,$s=$T*$w+$i*$$-$F*$a,$N=-$i*$a-$F*$$-$b*$w;$k[$l]=$_*$T+$N*-$i+$R*-$b-$s*-$F,$k[$l+1]=$R*$T+$N*-$F+$s*-$i-$_*-$b,$k[$l+2]=$s*$T+$N*-$b+$_*-$F-$R*-$i},$d.mulMatrixByArray=function($x,$I,$z,$k,$l,$n){var $a,$$,$w,$i,$F;if($l===$z){for($z=$d._tempArray16_3,$a=0;$a<16;++$a)$z[$a]=$l[$n+$a];$k=0}for($a=0;$a<4;$a++)$$=$x[$I+$a],$w=$x[$I+$a+4],$i=$x[$I+$a+8],$F=$x[$I+$a+12],$l[$n+$a]=$$*$z[$k+0]+$w*$z[$k+1]+$i*$z[$k+2]+$F*$z[$k+3],$l[$n+$a+4]=$$*$z[$k+4]+$w*$z[$k+5]+$i*$z[$k+6]+$F*$z[$k+7],$l[$n+$a+8]=$$*$z[$k+8]+$w*$z[$k+9]+$i*$z[$k+10]+$F*$z[$k+11],$l[$n+$a+12]=$$*$z[$k+12]+$w*$z[$k+13]+$i*$z[$k+14]+$F*$z[$k+15]},$d.mulMatrixByArrayFast=function($x,$I,$z,$k,$l,$n){var $a,$$,$w,$i,$F;for($a=0;$a<4;$a++)$$=$x[$I+$a],$w=$x[$I+$a+4],$i=$x[$I+$a+8],$F=$x[$I+$a+12],$l[$n+$a]=$$*$z[$k+0]+$w*$z[$k+1]+$i*$z[$k+2]+$F*$z[$k+3],$l[$n+$a+4]=$$*$z[$k+4]+$w*$z[$k+5]+$i*$z[$k+6]+$F*$z[$k+7],$l[$n+$a+8]=$$*$z[$k+8]+$w*$z[$k+9]+$i*$z[$k+10]+$F*$z[$k+11],$l[$n+$a+12]=$$*$z[$k+12]+$w*$z[$k+13]+$i*$z[$k+14]+$F*$z[$k+15]},$d.mulMatrixByArrayAndMatrixFast=function($x,$I,$z,$k,$l){var $n,$a,$$,$w,$i,$F=$z.elements,$b=$F[0],$T=$F[1],$_=$F[2],$R=$F[3],$s=$F[4],$N=$F[5],$D=$F[6],$f=$F[7],$m=$F[8],$y=$F[9],$C=$F[10],$P=$F[11],$v=$F[12],$L=$F[13],$K=$F[14],$E=$F[15],$O=$I,$S=$I+4,$Z=$I+8,$U=$I+12,$X=$l,$d=$l+4,$j=$l+8,$t=$l+12;for($n=0;$n<4;$n++)$a=$x[$O+$n],$$=$x[$S+$n],$w=$x[$Z+$n],$i=$x[$U+$n],$k[$X+$n]=$a*$b+$$*$T+$w*$_+$i*$R,$k[$d+$n]=$a*$s+$$*$N+$w*$D+$i*$f,$k[$j+$n]=$a*$m+$$*$y+$w*$C+$i*$P,$k[$t+$n]=$a*$v+$$*$L+$w*$K+$i*$E},$d.createAffineTransformationArray=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b){var $T=$k+$k,$_=$l+$l,$R=$n+$n,$s=$k*$T,$N=$k*$_,$D=$k*$R,$f=$l*$_,$m=$l*$R,$y=$n*$R,$C=$a*$T,$P=$a*$_,$v=$a*$R;$F[$b+0]=(1-($f+$y))*$$,$F[$b+1]=($N+$v)*$$,$F[$b+2]=($D-$P)*$$,$F[$b+3]=0,$F[$b+4]=($N-$v)*$w,$F[$b+5]=(1-($s+$y))*$w,$F[$b+6]=($m+$C)*$w,$F[$b+7]=0,$F[$b+8]=($D+$P)*$i,$F[$b+9]=($m-$C)*$i,$F[$b+10]=(1-($s+$f))*$i,$F[$b+11]=0,$F[$b+12]=$x,$F[$b+13]=$I,$F[$b+14]=$z,$F[$b+15]=1},$d.transformVector3ArrayToVector3ArrayCoordinate=function($x,$I,$z,$k,$l){var $n=$d._tempArray4_0,$a=$x[$I+0],$$=$x[$I+1],$w=$x[$I+2],$i=$z.elements;$n[0]=$a*$i[0]+$$*$i[4]+$w*$i[8]+$i[12],$n[1]=$a*$i[1]+$$*$i[5]+$w*$i[9]+$i[13],$n[2]=$a*$i[2]+$$*$i[6]+$w*$i[10]+$i[14],$n[3]=1/($a*$i[3]+$$*$i[7]+$w*$i[11]+$i[15]),$k[$l+0]=$n[0]*$n[3],$k[$l+1]=$n[1]*$n[3],$k[$l+2]=$n[2]*$n[3]},$d.transformLightingMapTexcoordByUV0Array=function($x,$I,$z,$k,$l){var $n=$z.elements;$k[$l+0]=$x[$I+0]*$n[0]+$n[2],$k[$l+1]=($x[$I+1]-1)*$n[1]+$n[3]},$d.transformLightingMapTexcoordByUV1Array=function($x,$I,$z,$k,$l){var $n=$z.elements;$k[$l+0]=$x[$I+0]*$n[0]+$n[2],$k[$l+1]=1+$x[$I+1]*$n[1]+$n[3]},$d.getURLVerion=function($x){var $I=$x.indexOf("?");return 0<=$I?$x.substr($I):null},$d._quaternionCreateFromYawPitchRollArray=function($x,$I,$z,$k){var $l=.5*$z,$n=.5*$I,$a=.5*$x,$$=Math.sin($l),$w=Math.cos($l),$i=Math.sin($n),$F=Math.cos($n),$b=Math.sin($a),$T=Math.cos($a);$k[0]=$T*$i*$w+$b*$F*$$,$k[1]=$b*$F*$w-$T*$i*$$,$k[2]=$T*$F*$$-$b*$i*$w,$k[3]=$T*$F*$w+$b*$i*$$},$d._createAffineTransformationArray=function($x,$I,$z,$k){var $l=$I[0],$n=$I[1],$a=$I[2],$$=$I[3],$w=$l+$l,$i=$n+$n,$F=$a+$a,$b=$l*$w,$T=$l*$i,$_=$l*$F,$R=$n*$i,$s=$n*$F,$N=$a*$F,$D=$$*$w,$f=$$*$i,$m=$$*$F,$y=$z[0],$C=$z[1],$P=$z[2];$k[0]=(1-($R+$N))*$y,$k[1]=($T+$m)*$y,$k[2]=($_-$f)*$y,$k[3]=0,$k[4]=($T-$m)*$C,$k[5]=(1-($b+$N))*$C,$k[6]=($s+$D)*$C,$k[7]=0,$k[8]=($_+$f)*$P,$k[9]=($s-$D)*$P,$k[10]=(1-($b+$R))*$P,$k[11]=0,$k[12]=$x[0],$k[13]=$x[1],$k[14]=$x[2],$k[15]=1},$d._mulMatrixArray=function($x,$I,$z,$k){var $l,$n,$a,$$,$w,$i=$I.elements,$F=$i[0],$b=$i[1],$T=$i[2],$_=$i[3],$R=$i[4],$s=$i[5],$N=$i[6],$D=$i[7],$f=$i[8],$m=$i[9],$y=$i[10],$C=$i[11],$P=$i[12],$v=$i[13],$L=$i[14],$K=$i[15],$E=$k,$O=$k+4,$S=$k+8,$Z=$k+12;for($l=0;$l<4;$l++)$n=$x[$l],$a=$x[$l+4],$$=$x[$l+8],$w=$x[$l+12],$z[$E+$l]=$n*$F+$a*$b+$$*$T+$w*$_,$z[$O+$l]=$n*$R+$a*$s+$$*$N+$w*$D,$z[$S+$l]=$n*$f+$a*$m+$$*$y+$w*$C,$z[$Z+$l]=$n*$P+$a*$v+$$*$L+$w*$K},$d.getYawPitchRoll=function($x,$I){$d.transformQuat($aI.ForwardRH,$x,$zI.TEMPVector31),$d.transformQuat($aI.Up,$x,$zI.TEMPVector32);var $z=$zI.TEMPVector32.elements;$d.angleTo($aI.ZERO,$zI.TEMPVector31,$zI.TEMPVector33);var $k=$zI.TEMPVector33.elements;$k[0]==Math.PI/2?($k[1]=$d.arcTanAngle($z[2],$z[0]),$k[2]=0):$k[0]==-Math.PI/2?($k[1]=$d.arcTanAngle(-$z[2],-$z[0]),$k[2]=0):($xI.createRotationY(-$k[1],$zI.TEMPMatrix0),$xI.createRotationX(-$k[0],$zI.TEMPMatrix1),$aI.transformCoordinate($zI.TEMPVector32,$zI.TEMPMatrix0,$zI.TEMPVector32),$aI.transformCoordinate($zI.TEMPVector32,$zI.TEMPMatrix1,$zI.TEMPVector32),$k[2]=$d.arcTanAngle($z[1],-$z[0])),$k[1]<=-Math.PI&&($k[1]=Math.PI),$k[2]<=-Math.PI&&($k[2]=Math.PI),$k[1]>=Math.PI&&$k[2]>=Math.PI&&($k[1]=0,$k[2]=0,$k[0]=Math.PI-$k[0]),$I[0]=$k[1],$I[1]=$k[0],$I[2]=$k[2]},$d.arcTanAngle=function($x,$I){return 0==$x?1==$I?Math.PI/2:-Math.PI/2:0<$x?Math.atan($I/$x):$x<0?0<$I?Math.atan($I/$x)+Math.PI:Math.atan($I/$x)-Math.PI:0},$d.angleTo=function($x,$I,$z){$aI.subtract($I,$x,$zI.TEMPVector30),$aI.normalize($zI.TEMPVector30,$zI.TEMPVector30),$z.elements[0]=Math.asin($zI.TEMPVector30.y),$z.elements[1]=$d.arcTanAngle(-$zI.TEMPVector30.z,-$zI.TEMPVector30.x)},$d.transformQuat=function($x,$I,$z){var $k=$z.elements,$l=$x.elements,$n=$I,$a=$l[0],$$=$l[1],$w=$l[2],$i=$n[0],$F=$n[1],$b=$n[2],$T=$n[3],$_=$T*$a+$F*$w-$b*$$,$R=$T*$$+$b*$a-$i*$w,$s=$T*$w+$i*$$-$F*$a,$N=-$i*$a-$F*$$-$b*$w;$k[0]=$_*$T+$N*-$i+$R*-$b-$s*-$F,$k[1]=$R*$T+$N*-$F+$s*-$i-$_*-$b,$k[2]=$s*$T+$N*-$b+$_*-$F-$R*-$i},$d.quaterionNormalize=function($x,$I){var $z=$x[0],$k=$x[1],$l=$x[2],$n=$x[3],$a=$z*$z+$k*$k+$l*$l+$n*$n;0<$a&&($a=1/Math.sqrt($a),$I[0]=$z*$a,$I[1]=$k*$a,$I[2]=$l*$a,$I[3]=$n*$a)},$d.matrix4x4MultiplyFFF=function($x,$I,$z){var $k,$l,$n,$a,$$;if($z===$I)for($I=new Float32Array(16),$k=0;$k<16;++$k)$I[$k]=$z[$k];for($k=0;$k<4;$k++)$l=$x[$k],$n=$x[$k+4],$a=$x[$k+8],$$=$x[$k+12],$z[$k]=$l*$I[0]+$n*$I[1]+$a*$I[2]+$$*$I[3],$z[$k+4]=$l*$I[4]+$n*$I[5]+$a*$I[6]+$$*$I[7],$z[$k+8]=$l*$I[8]+$n*$I[9]+$a*$I[10]+$$*$I[11],$z[$k+12]=$l*$I[12]+$n*$I[13]+$a*$I[14]+$$*$I[15]},$d.matrix4x4MultiplyMFM=function($x,$I,$z){$d.matrix4x4MultiplyFFF($x.elements,$I,$z.elements)},$b($d,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $aI},"_tempVector3_1",function(){return this._tempVector3_1=new $aI},"_tempVector3_2",function(){return this._tempVector3_2=new $aI},"_tempVector3_3",function(){return this._tempVector3_3=new $aI},"_tempVector3_4",function(){return this._tempVector3_4=new $aI},"_tempVector3_5",function(){return this._tempVector3_5=new $aI},"_tempVector3_6",function(){return this._tempVector3_6=new $aI},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$d}(),$DI=function(){function $U(){}return $_($U,"Laya3D"),$U._cancelLoadByUrl=function($x){$C.loader.cancelLoadByUrl($x),$U._innerFirstLevelLoaderManager.cancelLoadByUrl($x),$U._innerSecondLevelLoaderManager.cancelLoadByUrl($x),$U._innerThirdLevelLoaderManager.cancelLoadByUrl($x),$U._innerFourthLevelLoaderManager.cancelLoadByUrl($x)},$U._changeWebGLSize=function($x,$I){$Z.onStageResize($x,$I),$u.clientWidth=$x,$u.clientHeight=$I},$U.__init__=function(){var $x=$I.createMap;$x.lh=[$tI,"SPRITE3DHIERARCHY"],$x.ls=[$jI,"SPRITE3DHIERARCHY"],$x.lm=[$JI,"MESH"],$x.lmat=[$cI,"MATERIAL"],$x.jpg=[$BI,"nativeimage"],$x.jpeg=[$BI,"nativeimage"],$x.png=[$BI,"nativeimage"],$x.pkm=[$BI,"arraybuffer"],$x.raw=[$qI,"arraybuffer"],$x.mipmaps=[$qI,"arraybuffer"],$D.parserMap.SPRITE3DHIERARCHY=$U._loadHierarchy,$D.parserMap.MESH=$U._loadMesh,$D.parserMap.MATERIAL=$U._loadMaterial,$D.parserMap.TEXTURECUBE=$U._loadTextureCube,$D.parserMap.TERRAIN=$U._loadTerrain,$U._innerFirstLevelLoaderManager.on("error",null,$U._eventLoadManagerError),$U._innerSecondLevelLoaderManager.on("error",null,$U._eventLoadManagerError),$U._innerThirdLevelLoaderManager.on("error",null,$U._eventLoadManagerError),$U._innerFourthLevelLoaderManager.on("error",null,$U._eventLoadManagerError)},$U.READ_BLOCK=function(){return $U._readData.pos+=4,!0},$U.READ_DATA=function(){return $U._DATA.offset=$U._readData.getUint32(),$U._DATA.size=$U._readData.getUint32(),!0},$U.READ_STRINGS=function(){var $x=[],$I={offset:0,size:0};$I.offset=$U._readData.getUint16(),$I.size=$U._readData.getUint16();$U._readData.pos;$U._readData.pos=$I.offset+$U._DATA.offset;for(var $z=0;$z<$I.size;$z++){var $k=$U._readData.readUTFString();-1===$k.lastIndexOf(".lmat")&&-1===$k.lastIndexOf(".lpbr")||$x.push($k)}return $x},$U.formatRelativePath=function($x,$I){var $z;if("."===$I.charAt(0)){for(var $k=($x+$I).split("/"),$l=0,$n=$k.length;$l<$n;$l++)if(".."==$k[$l]){var $a=$l-1;0<$a&&".."!==$k[$a]&&($k.splice($a,2),$l-=2)}$z=$k.join("/")}else $z=$x+$I;return null!=$S.customFormat&&($z=$S.customFormat($z,null)),$z},$U._eventLoadManagerError=function($x){$C.loader.event("error",$x)},$U._addHierarchyInnerUrls=function($x,$I,$z,$k,$l,$n){var $a=$U.formatRelativePath($k,$l);$z&&($a+=$z),$x.push({url:$a,clas:$n}),$I[$l]=$a},$U._getSprite3DHierarchyInnerUrls=function($x,$I,$z,$k,$l,$n,$a){var $$,$w=0,$i=0;switch($x.type){case"Scene":var $F=$x.customProps.lightmaps;for($w=0,$i=$F.length;$w<$i;$w++){var $b=$F[$w].replace(".exr",".png");$U._addHierarchyInnerUrls($k,$l,$n,$a,$b,$BI)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $T;if($x.instanceParams)($T=$x.instanceParams.loadPath)&&$U._addHierarchyInnerUrls($I,$l,$n,$a,$T,$JI);else{($T=($$=$x.customProps).meshPath)&&$U._addHierarchyInnerUrls($I,$l,$n,$a,$T,$JI);var $_=$$.materials;if($_)for($w=0,$i=$_.length;$w<$i;$w++){for(var $R=$_[$w],$s=$R.type.split("."),$N=$X.window,$D=0,$f=$s.length;$D<$f;++$D){$N=$N[this.clasPaths[$D]]}if("function"!=typeof $N)throw"_getSprite3DHierarchyInnerUrls 错误: "+$R.type+" 不是类";$U._addHierarchyInnerUrls($z,$l,$n,$a,$R.path,$N)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $m=($$=$x.customProps).meshPath;$m&&$U._addHierarchyInnerUrls($I,$l,$n,$a,$m,$JI);var $y=$$.material;if($y){$s=$y.type.split("."),$N=$X.window;for($D=0,$f=$s.length;$D<$f;++$D){$N=$N[this.clasPaths[$D]]}$U._addHierarchyInnerUrls($z,$l,$n,$a,$y.path,$N)}else{var $C=$$.materialPath;if($C)$U._addHierarchyInnerUrls($z,$l,$n,$a,$C,ShurikenParticleMaterial);else{var $P=$$.texturePath;$P&&$U._addHierarchyInnerUrls($k,$l,$n,$a,$P,$BI)}}break;case"Terrain":$U._addHierarchyInnerUrls($k,$l,$n,$a,$x.customProps.dataPath,TerrainRes)}var $v=$x.components;for(var $L in $v){var $K=$v[$L];switch($L){case"Animator":var $E=$K.avatarPath;if($E)$U._addHierarchyInnerUrls($k,$l,$n,$a,$E,Avatar);else{var $O=$K.avatar;$O&&$U._addHierarchyInnerUrls($k,$l,$n,$a,$O.path,Avatar)}var $S=$K.clipPaths;for($w=0,$i=$S.length;$w<$i;$w++)$U._addHierarchyInnerUrls($k,$l,$n,$a,$S[$w],AnimationClip)}}var $Z=$x.child;for($w=0,$i=$Z.length;$w<$i;$w++)$U._getSprite3DHierarchyInnerUrls($Z[$w],$I,$z,$k,$l,$n,$a)},$U._loadHierarchy=function($x){$x.on("loaded",null,$U._onHierarchylhLoaded,[$x,$x._class._getGroup()]),$x.load($x.url,"json",!1,null,!0)},$U._onHierarchylhLoaded=function($x,$I,$z){if($x._class.destroyed)$x.endLoad();else{var $k=$x.url,$l=$NI.getURLVerion($k),$n=$S.getPath($k),$a=[],$$=[],$w=[],$i={};$U._getSprite3DHierarchyInnerUrls($z,$a,$$,$w,$i,$l,$n);var $F=$a.length+$$.length+$w.length,$b=$F+1,$T=1/$b;if($U._onProcessChange($x,0,$T,1),0<$w.length){var $_=$F/$b,$R=$O.create(null,$U._onProcessChange,[$x,$T,$_],!1);$U._innerFourthLevelLoaderManager.create($w,$O.create(null,$U._onHierarchyInnerForthLevResouLoaded,[$x,$I,$R,$z,$i,$a,$$,$T+$_*$w.length,$_]),$R,null,null,1,!0,$I)}else $U._onHierarchyInnerForthLevResouLoaded($x,$I,null,$z,$i,$a,$$,$T,$_)}},$U._onHierarchyInnerForthLevResouLoaded=function($x,$I,$z,$k,$l,$n,$a,$$,$w){if($x._class.destroyed)$x.endLoad();else if($z&&$z.recover(),0<$a.length){var $i=$O.create(null,$U._onProcessChange,[$x,$$,$w],!1);$U._innerSecondLevelLoaderManager.create($a,$O.create(null,$U._onHierarchyInnerSecondLevResouLoaded,[$x,$I,$i,$k,$l,$n,$$+$w*$a.length,$w]),$z,null,null,1,!0,$I)}else $U._onHierarchyInnerSecondLevResouLoaded($x,$I,null,$k,$l,$n,$$,$w)},$U._onHierarchyInnerSecondLevResouLoaded=function($x,$I,$z,$k,$l,$n,$a,$$){if($x._class.destroyed)$x.endLoad();else if($z&&$z.recover(),0<$n.length){var $w=$O.create(null,$U._onProcessChange,[$x,$a,$$],!1);$U._innerFirstLevelLoaderManager.create($n,$O.create(null,$U._onHierarchyInnerFirstLevResouLoaded,[$x,$w,$k,$l]),$z,null,null,1,!0,$I)}else $U._onHierarchyInnerFirstLevResouLoaded($x,null,$k,$l)},$U._onHierarchyInnerFirstLevResouLoaded=function($x,$I,$z,$k){$I&&$I.recover(),$x.endLoad([$z,$k])},$U._loadTerrain=function($x){$x.on("loaded",null,$U._onTerrainLtLoaded,[$x,$x._class._getGroup()]),$x.load($x.url,"json",!1,null,!0)},$U._onTerrainLtLoaded=function($x,$I,$z){if($x._class.destroyed)$x.endLoad();else{var $k,$l,$n=$x.url,$a=$NI.getURLVerion($n),$$=$S.getPath($n),$w=[],$i={},$F=0,$b=0,$T=$z.heightData;$k=$T.url,$l=$U.formatRelativePath($$,$k),$a&&($l+=$a),$k=$i[$k]=$l;var $_=$z.detailTexture;for($F=0,$b=$_.length;$F<$b;$F++)$w.push({url:$_[$F].diffuse});var $R=$z.normalMap;for($F=0,$b=$R.length;$F<$b;$F++)$w.push({url:$R[$F]});var $s=$z.alphaMap;for($F=0,$b=$s.length;$F<$b;$F++)$w.push({url:$s[$F],params:[!1,!1,6408,!0]});for($F=0,$b=$w.length;$F<$b;$F++){var $N=$w[$F].url;$l=$U.formatRelativePath($$,$N),$a&&($l+=$a),$w[$F].url=$l,$i[$N]=$l}var $D=$w.length,$f=$D+2,$m=1/$f;$U._onProcessChange($x,0,$m,1);var $y={heightMapLoaded:!1,texturesLoaded:!1},$C=$O.create(null,$U._onProcessChange,[$x,$m,$m],!1);$U._innerFourthLevelLoaderManager.create($k,$O.create(null,$U._onTerrainHeightMapLoaded,[$x,$C,$z,$i,$y]),$C,null,[$T.numX,$T.numZ,$T.bitType,$T.value],1,!0,$I);var $P=$O.create(null,$U._onProcessChange,[$x,2*$m,$D/$f],!1);$U._innerFourthLevelLoaderManager.create($w,$O.create(null,$U._onTerrainTexturesLoaded,[$x,$P,$z,$i,$y]),$P,null,null,1,!0,$I)}},$U._onTerrainHeightMapLoaded=function($x,$I,$z,$k,$l){$l.heightMapLoaded=!0,$l.texturesLoaded&&($x.endLoad([$z,$k]),$I.recover())},$U._onTerrainTexturesLoaded=function($x,$I,$z,$k,$l){$l.texturesLoaded=!0,$l.heightMapLoaded&&($x.endLoad([$z,$k]),$I.recover())},$U._loadMesh=function($x){$x.on("loaded",null,$U._onMeshLmLoaded,[$x,$x._class._getGroup()]),$x.load($x.url,"arraybuffer",!1,null,!0)},$U._onMeshLmLoaded=function($x,$I,$z){if($x._class.destroyed)$x.endLoad();else{var $k,$l,$n,$a=$x.url,$$=$NI.getURLVerion($a),$w=$S.getPath($a),$i={},$F=0,$b=0;switch(($U._readData=new $P($z)).pos=0,$U._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $T=$U._readData.getUint32();$U._readData.pos=$U._readData.pos+4,$b=$U._readData.getUint16(),$U._readData.pos=$U._readData.pos+8*$b;var $_=$U._readData.getUint32();for($b=$U._readData.getUint16(),$U._readData.pos=$T+$_,$k=[],$F=0;$F<$b;$F++){var $R=$U._readData.readUTFString();-1!==$R.lastIndexOf(".lmat")&&$k.push($R)}break;default:for($U.READ_BLOCK(),$F=0;$F<2;$F++){var $s=$U._readData.getUint16(),$N=$U._strings[$s],$D=$U["READ_"+$N];if(null==$D)throw new Error("model file err,no this function:"+$s+" "+$N);1===$F?$k=$D.call():$D.call()}}for($F=0,$n=$k.length;$F<$n;$F++){var $f=$k[$F];$l=$U.formatRelativePath($w,$f),$$&&($l+=$$),$k[$F]=$l,$i[$f]=$l}if(0<$k.length){$U._onProcessChange($x,0,.5,1);var $m=$O.create(null,$U._onProcessChange,[$x,.5,.5],!1);$U._innerSecondLevelLoaderManager.create($k,$O.create(null,$U._onMeshMateialLoaded,[$x,$m,$z,$i]),$m,null,null,1,!0,$I)}else $x.endLoad([$z,$i])}},$U._onMeshMateialLoaded=function($x,$I,$z,$k){$x.endLoad([$z,$k]),$I.recover()},$U._getMaterialTexturePath=function($x,$I,$z){var $k=$x.length-4;return $x.indexOf(".dds")!=$k&&$x.indexOf(".tga")!=$k&&$x.indexOf(".exr")!=$k&&$x.indexOf(".DDS")!=$k&&$x.indexOf(".TGA")!=$k&&$x.indexOf(".EXR")!=$k||($x=$x.substr(0,$k)+".png"),$x=$U.formatRelativePath($z,$x),$I&&($x+=$I),$x},$U._loadMaterial=function($x){$x.on("loaded",null,$U._onMaterilLmatLoaded,[$x,$x._class._getGroup()]),$x.load($x.url,"json",!1,null,!0)},$U._onMaterilLmatLoaded=function($x,$I,$z){if($x._class.destroyed)$x.endLoad();else{var $k,$l=$x.url,$n=$NI.getURLVerion($l),$a=$S.getPath($l),$$=[],$w={},$i=$z.customProps,$F=$z.version;if($F)switch($F){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $b=$z.props.textures,$T=0,$_=$b.length;$T<$_;$T++){var $R=$b[$T],$s=$R.path;if($s){var $N=$s.length-4;$s.indexOf(".exr")!=$N&&$s.indexOf(".EXR")!=$N||($s=$s.substr(0,$N)+".png"),$k=$U.formatRelativePath($a,$s),$n&&($k+=$n),$$.push({url:$k,params:$R.params}),$w[$s]=$k}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $D=$i.diffuseTexture.texture2D;if($D&&($k=$U._getMaterialTexturePath($D,$n,$a),$$.push($k),$w[$D]=$k),$i.normalTexture){var $f=$i.normalTexture.texture2D;$f&&($k=$U._getMaterialTexturePath($f,$n,$a),$$.push($k),$w[$f]=$k)}if($i.specularTexture){var $m=$i.specularTexture.texture2D;$m&&($k=$U._getMaterialTexturePath($m,$n,$a),$$.push($k),$w[$m]=$k)}if($i.emissiveTexture){var $y=$i.emissiveTexture.texture2D;$y&&($k=$U._getMaterialTexturePath($y,$n,$a),$$.push($k),$w[$y]=$k)}if($i.ambientTexture){var $C=$i.ambientTexture.texture2D;$C&&($k=$U._getMaterialTexturePath($C,$n,$a),$$.push($k),$w[$C]=$k)}if($i.reflectTexture){var $P=$i.reflectTexture.texture2D;$P&&($k=$U._getMaterialTexturePath($P,$n,$a),$$.push($k),$w[$P]=$k)}}var $v=$$.length,$L=$v+1,$K=1/$L;if($U._onProcessChange($x,0,$K,1),0<$v){var $E=$O.create(null,$U._onProcessChange,[$x,$K,$v/$L],!1);$U._innerFourthLevelLoaderManager.create($$,$O.create(null,$U._onMateialTexturesLoaded,[$x,$E,$z,$w]),$E,$BI,null,1,!0,$I)}else $U._onMateialTexturesLoaded($x,null,$z,null)}},$U._onMateialTexturesLoaded=function($x,$I,$z,$k){$x.endLoad([$z,$k]),$I&&$I.recover()},$U._loadTextureCube=function($x){$x.on("loaded",null,$U._onTextureCubeLtcLoaded,[$x]),$x.load($x.url,"json",!1,null,!0)},$U._onTextureCubeLtcLoaded=function($x,$I){if($x._class.destroyed)$x.endLoad();else{var $z=$S.getPath($x.url),$k=[$U.formatRelativePath($z,$I.px),$U.formatRelativePath($z,$I.nx),$U.formatRelativePath($z,$I.py),$U.formatRelativePath($z,$I.ny),$U.formatRelativePath($z,$I.pz),$U.formatRelativePath($z,$I.nz)];$U._onProcessChange($x,0,1/7,1);var $l=$O.create(null,$U._onProcessChange,[$x,1/7,6/7],!1);$U._innerFourthLevelLoaderManager.load($k,$O.create(null,$U._onTextureCubeImagesLoaded,[$x,$k,$l]),$l,"nativeimage")}},$U._onTextureCubeImagesLoaded=function($x,$I,$z){var $k=[];$k.length=6;for(var $l=0;$l<6;$l++){var $n=$I[$l];$k[$l]=$D.getRes($n),$D.clearRes($n)}$x.endLoad($k),$z.recover()},$U._onProcessChange=function($x,$I,$z,$k){($k=$I+$k*$z)<1&&$x.event("progress",$k)},$U.init=function($x,$I,$z,$k,$l,$n){if(void 0===$z&&($z=!1),void 0===$k&&($k=!1),void 0===$l&&($l=!0),void 0===$n&&($n=!0),$f.update3DLoop=function(){},$f.cancelLoadByUrl=function($x){$U._cancelLoadByUrl($x)},$w.isAntialias=$z,$w.isAlpha=$k,$w.premultipliedAlpha=$l,$w.isStencil=$n,!$Z.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$f.changeWebGLSize=$U._changeWebGLSize,$s.is3DMode=!0,$C.init($x,$I),$d.__init__(),$bI.__init__(),$pI.__init__(),$o.__init__(),$U.__init__(),$a.maxTextureCount=2,($U.debugMode||$r.debugMode)&&($U._debugPhasorSprite=new $A)},$U.HIERARCHY="SPRITE3DHIERARCHY",$U.MESH="MESH",$U.MATERIAL="MATERIAL",$U.PBRMATERIAL="PBRMTL",$U.TEXTURECUBE="TEXTURECUBE",$U.TERRAIN="TERRAIN",$U._readData=null,$U._debugPhasorSprite=null,$U.debugMode=!1,$b($U,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $I},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $I},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $I},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $I}]),$U}(),$fI=function($x){function $l($x){$l.__super.call(this),this._owner=$x,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$_($l,"laya.d3.animation.AnimationTransform3D",$n);var $I=$l.prototype;return $I._getlocalMatrix=function(){return this._localUpdate&&($NI._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$I._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._onWorldTransform()}},$I._setWorldMatrixAndUpdate=function($x){if(this._worldMatrix=$x,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $I=this._getlocalMatrix(),$z=0;$z<16;++$z)this._worldMatrix[$z]=$I[$z];else $NI.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$I._setWorldMatrixNoUpdate=function($x){this._worldMatrix=$x},$I._setWorldMatrixIgnoreUpdate=function($x){this._worldMatrix=$x,this._worldUpdate=!1},$I.getLocalPosition=function(){return this._localPosition},$I.setLocalPosition=function($x){if(this._parent)this._localPosition=$x,this._localUpdate=!0,this._onWorldTransform();else{var $I=this._entity.owner._transform,$z=this._entity.localPosition,$k=$z.elements;$k[0]=$x[0],$k[1]=$x[1],$k[2]=$x[2],$I.localPosition=$z}},$I.getLocalRotation=function(){if(this._localQuaternionUpdate){var $x=this._localRotationEuler;$NI._quaternionCreateFromYawPitchRollArray($x[1]/$l._angleToRandin,$x[0]/$l._angleToRandin,$x[2]/$l._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$I.setLocalRotation=function($x){if(this._parent)this._localRotation=$x,$NI.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $I=this._entity.owner._transform,$z=this._entity.localRotation,$k=$z.elements;$k[0]=$x[0],$k[1]=$x[1],$k[2]=$x[2],$k[3]=$x[3],$I.localRotation=$z}},$I.getLocalScale=function(){return this._localScale},$I.setLocalScale=function($x){if(this._parent)this._localScale=$x,this._localUpdate=!0,this._onWorldTransform();else{var $I=this._entity.owner._transform,$z=this._entity.localScale,$k=$z.elements;$k[0]=$x[0],$k[1]=$x[1],$k[2]=$x[2],$I.localScale=$z}},$I.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$NI.getYawPitchRoll(this._localRotation,$l._tempVector3);var $x=$l._tempVector3,$I=this._localRotationEuler;$I[0]=$x[1]*$l._angleToRandin,$I[1]=$x[0]*$l._angleToRandin,$I[2]=$x[2]*$l._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$I.setLocalRotationEuler=function($x){if(this._parent)$NI._quaternionCreateFromYawPitchRollArray($x[1]/$l._angleToRandin,$x[0]/$l._angleToRandin,$x[2]/$l._angleToRandin,this._localRotation),this._localRotationEuler=$x,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $I=this._entity.owner._transform,$z=this._entity.localRotationEuler,$k=$z.elements;$k[0]=$x[0],$k[1]=$x[1],$k[2]=$x[2],$I.localRotationEuler=$z}},$I.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$NI.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $x=this._getlocalMatrix(),$I=0;$I<16;++$I)this._worldMatrix[$I]=$x[$I];this._worldUpdate=!1}return this._worldMatrix},$I.setParent=function($x){if(this._parent!==$x){if(this._parent){var $I=this._parent._childs,$z=$I.indexOf(this);$I.splice($z,1)}$x&&($x._childs.push(this),$x&&this._onWorldTransform()),this._parent=$x}},$b($l,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$l}(),$mI=function($x){function $I(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$I.__super.call(this),this._destroyed=!1,this._id=$I._uniqueIDCounter,$I._uniqueIDCounter++}$_($I,"laya.d3.component.Component3D",$n);var $z=$I.prototype;return $C.imps($z,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$z._initialize=function($x){this._owner=$x,this._enable=!0,this.started=!1,this._load($x)},$z._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$z._load=function($x){},$z._start=function($x){},$z._update=function($x){},$z._lateUpdate=function($x){},$z._preRenderUpdate=function($x){},$z._postRenderUpdate=function($x){},$z._unload=function($x){this.offAll()},$z._cloneTo=function($x){},$R(0,$z,"id",function(){return this._id}),$R(0,$z,"destroyed",function(){return this._destroyed}),$R(0,$z,"owner",function(){return this._owner}),$R(0,$z,"enable",function(){return this._enable},function($x){this._enable!==$x&&(this._enable=$x,this.event("enablechanged",this._enable))}),$R(0,$z,"isSingleton",function(){return $I._isSingleton}),$I._isSingleton=!0,$I._uniqueIDCounter=1,$I}(),$yI=function($x){function $I(){this._destroyed=!1,$I.__super.call(this),this._destroyed=!1}$_($I,"laya.d3.core.GeometryFilter",$n);var $z=$I.prototype;return $C.imps($z,{"laya.resource.IDestroy":!0}),$z._destroy=function(){this.offAll(),this._destroyed=!0},$R(0,$z,"_isAsyncLoaded",function(){return!0}),$R(0,$z,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$R(0,$z,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$R(0,$z,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$R(0,$z,"destroyed",function(){return this._destroyed}),$I}(),$CI=function($x){function $k($x){$k.__super.call(this),this._id=++$k._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $rx(new $aI,new $aI),this._boundingBoxCenter=new $aI,this._boundingSphere=new $Mx(new $aI,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$x,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$_($k,"laya.d3.core.render.BaseRender",$n);var $I=$k.prototype;return $C.imps($I,{"laya.resource.IDestroy":!0}),$I._changeMaterialReference=function($x,$I){$x&&$x._removeReference(),$I._addReference()},$I._getInstanceMaterial=function($x,$I){var $z=new $x.constructor;return $x.cloneTo($z),$z.name=$z.name+"(Instance)",this._materialsInstance[$I]=!0,this._changeMaterialReference(this._materials[$I],$z),this._materials[$I]=$z},$I._setShaderValuelightMap=function($x){this._setShaderValueTexture(3,$x)},$I._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$I._renderRenderableBoundBox=function(){var $x=$DI._debugPhasorSprite,$I=this.boundingBox,$z=$k._tempBoundBoxCorners;$I.getCorners($z),$x.line($z[0],$k._greenColor,$z[1],$k._greenColor),$x.line($z[2],$k._greenColor,$z[3],$k._greenColor),$x.line($z[4],$k._greenColor,$z[5],$k._greenColor),$x.line($z[6],$k._greenColor,$z[7],$k._greenColor),$x.line($z[0],$k._greenColor,$z[3],$k._greenColor),$x.line($z[1],$k._greenColor,$z[2],$k._greenColor),$x.line($z[2],$k._greenColor,$z[6],$k._greenColor),$x.line($z[3],$k._greenColor,$z[7],$k._greenColor),$x.line($z[0],$k._greenColor,$z[4],$k._greenColor),$x.line($z[1],$k._greenColor,$z[5],$k._greenColor),$x.line($z[4],$k._greenColor,$z[7],$k._greenColor),$x.line($z[5],$k._greenColor,$z[6],$k._greenColor)},$I._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$I._calculateBoundingBox=function(){throw"BaseRender: must override it."},$I._setShaderValueTexture=function($x,$I){this._owner._shaderValues.setValue($x,$I)},$I._setShaderValueMatrix4x4=function($x,$I){this._owner._shaderValues.setValue($x,$I?$I.elements:null)},$I._setShaderValueColor=function($x,$I){this._owner._shaderValues.setValue($x,$I?$I.elements:null)},$I._setShaderValueBuffer=function($x,$I){this._owner._shaderValues.setValue($x,$I)},$I._setShaderValueInt=function($x,$I){this._owner._shaderValues.setValue($x,$I)},$I._setShaderValueBool=function($x,$I){this._owner._shaderValues.setValue($x,$I)},$I._setShaderValueNumber=function($x,$I){this._owner._shaderValues.setValue($x,$I)},$I._setShaderValueVector2=function($x,$I){this._owner._shaderValues.setValue($x,$I?$I.elements:null)},$I._addShaderDefine=function($x){this._owner._shaderDefineValue|=$x},$I._removeShaderDefine=function($x){this._owner._shaderDefineValue&=~$x},$I._renderUpdate=function($x){return!0},$I._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $x=this._owner.scene;if($x){var $I=$x.getlightmaps()[this._lightmapIndex];$I?(this._addShaderDefine($AI.SAHDERDEFINE_LIGHTMAP),$I.loaded?this._setShaderValuelightMap($I):$I.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($AI.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($AI.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($AI.SAHDERDEFINE_LIGHTMAP)},$I._updateOctreeNode=function(){var $x=this._treeNode;$x&&this._octreeNodeNeedChange&&($x.updateObject(this),this._octreeNodeNeedChange=!1)},$I._destroy=function(){this.offAll();var $x=0,$I=0;for($x=0,$I=this._renderElements.length;$x<$I;$x++)this._renderElements[$x]._destroy();for($x=0,$I=this._materials.length;$x<$I;$x++)this._materials[$x]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$R(0,$I,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$R(0,$I,"id",function(){return this._id}),$R(0,$I,"material",function(){var $x=this._materials[0];if($x&&!this._materialsInstance[0]){var $I=this._getInstanceMaterial($x,0);this.event("materialchanged",[this,0,$I])}return this._materials[0]},function($x){this.sharedMaterial=$x}),$R(0,$I,"sharedMaterial",function(){return this._materials[0]},function($x){var $I=this._materials[0];$I!==$x&&(this._materials[0]=$x,this._materialsInstance[0]=!1,this._changeMaterialReference($I,$x),this.event("materialchanged",[this,0,$x]))}),$R(0,$I,"lightmapIndex",function(){return this._lightmapIndex},function($x){this._lightmapIndex=$x,this._applyLightMapParams()}),$R(0,$I,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($x){this._lightmapScaleOffset=$x,this._setShaderValueColor(2,$x),this._addShaderDefine($AI.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$R(0,$I,"enable",function(){return this._enable},function($x){this._enable=$x,this.event("enablechanged",[this,$x])}),$R(0,$I,"materials",function(){for(var $x=0,$I=this._materials.length;$x<$I;$x++)if(!this._materialsInstance[$x]){var $z=this._getInstanceMaterial(this._materials[$x],$x);this.event("materialchanged",[this,$x,$z])}return this._materials.slice()},function($x){this.sharedMaterials=$x}),$R(0,$I,"sharedMaterials",function(){return this._materials.slice()},function($x){if(!$x)throw new Error("MeshRender: shadredMaterials value can't be null.");var $I=$x.length;this._materialsInstance.length=$I;for(var $z=0;$z<$I;$z++){var $k=this._materials[$z];$k!==$x[$z]&&(this._materialsInstance[$z]=!1,this._changeMaterialReference($k,$x[$z]),this.event("materialchanged",[this,$z,$x[$z]]))}this._materials=$x}),$R(0,$I,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$R(0,$I,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $x=this.boundingBox;$aI.add($x.min,$x.max,this._boundingBoxCenter),$aI.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$R(0,$I,"receiveShadow",function(){return this._receiveShadow},function($x){this._receiveShadow!==$x&&((this._receiveShadow=$x)?this._addShaderDefine($_I.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($_I.SHADERDEFINE_RECEIVE_SHADOW))}),$R(0,$I,"destroyed",function(){return this._destroyed}),$k._uniqueIDCounter=0,$b($k,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI,new $aI]},"_greenColor",function(){return this._greenColor=new $$I(0,1,0,1)}]),$k}(),$PI=function($x){function $$($x){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$$.__super.call(this),this._localPosition=new $aI,this._localRotation=new $zI(0,0,0,1),this._localScale=new $aI(1,1,1),this._localRotationEuler=new $aI,this._localMatrix=new $xI,this._position=new $aI,this._rotation=new $zI(0,0,0,1),this._scale=new $aI(1,1,1),this._worldMatrix=new $xI,this._forward=new $aI,this._up=new $aI,this._right=new $aI,this._owner=$x,this._childs=[]}$_($$,"laya.d3.core.Transform3D",$n);var $I=$$.prototype;return $I._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$xI.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $x=$$._tempVector30;$aI.multiply(this.pivot,this._localScale,$x);var $I=$$._tempVector31;$aI.subtract($x,this.pivot,$I);var $z=$$._tempVector32,$k=this.localRotation;$aI.transformQuat($x,$k,$z),$aI.subtract($z,$x,$z);var $l=$$._tempVector33;$aI.subtract(this._localPosition,$I,$l),$aI.subtract($l,$z,$l),$xI.createAffineTransformation($l,$k,this._localScale,this._localMatrix)}},$I._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._onWorldPositionRotationTransform()}},$I._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._onWorldPositionScaleTransform()}},$I._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._onWorldPositionTransform()}},$I._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._onWorldPositionRotationTransform()}},$I._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._onWorldPositionScaleTransform()}},$I._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._onWorldTransform()}},$I.translate=function($x,$I){void 0===$I&&($I=!0),$I?($xI.createFromQuaternion(this.localRotation,$$._tempMatrix0),$aI.transformCoordinate($x,$$._tempMatrix0,$$._tempVector30),$aI.add(this.localPosition,$$._tempVector30,this._localPosition),this.localPosition=this._localPosition):($aI.add(this.position,$x,this._position),this.position=this._position)},$I.rotate=function($x,$I,$z){var $k;void 0===$I&&($I=!0),void 0===$z&&($z=!0),$k=$z?$x:($aI.scale($x,Math.PI/180,$$._tempVector30),$$._tempVector30),$zI.createFromYawPitchRoll($k.y,$k.x,$k.z,$$._tempQuaternion0),$I?($zI.multiply(this._localRotation,$$._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($zI.multiply($$._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$I.lookAt=function($x,$I,$z){void 0===$z&&($z=!1);var $k,$l=$x.elements;if($z){if($k=this._localPosition.elements,Math.abs($k[0]-$l[0])<$Qx.zeroTolerance&&Math.abs($k[1]-$l[1])<$Qx.zeroTolerance&&Math.abs($k[2]-$l[2])<$Qx.zeroTolerance)return;$zI.lookAt(this._localPosition,$x,$I,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $n=this.position;if($k=$n.elements,Math.abs($k[0]-$l[0])<$Qx.zeroTolerance&&Math.abs($k[1]-$l[1])<$Qx.zeroTolerance&&Math.abs($k[2]-$l[2])<$Qx.zeroTolerance)return;$zI.lookAt($n,$x,$I,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$R(0,$I,"_isFrontFaceInvert",function(){var $x=this.scale,$I=$x.x<0;return $x.y<0&&($I=!$I),$x.z<0&&($I=!$I),$I}),$R(0,$I,"owner",function(){return this._owner}),$R(0,$I,"localRotation",function(){if(this._localQuaternionUpdate){var $x=this._localRotationEuler.elements;$zI.createFromYawPitchRoll($x[1]/$$._angleToRandin,$x[0]/$$._angleToRandin,$x[2]/$$._angleToRandin,this._localRotation)}return this._localRotation},function($x){this._localRotation=$x,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$R(0,$I,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$xI.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($x){null===this._parent?$x.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$xI.multiply(this._localMatrix,$x,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$x,this._worldUpdate=!1}),$R(0,$I,"worldNeedUpdate",function(){return this._worldUpdate}),$R(0,$I,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($x){this._localMatrix=$x,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$R(0,$I,"dummy",function(){return this._dummy},function($x){this._dummy!==$x&&(this._dummy&&(this._dummy._entity=null),$x&&($x._entity=this),this._dummy=$x)}),$R(0,$I,"localPosition",function(){return this._localPosition},function($x){this._localPosition=$x,this._localUpdate=!0,this._onWorldPositionTransform()}),$R(0,$I,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $x=this._parent.position;$aI.multiply(this._localPosition,this._parent.scale,$$._tempVector30),$aI.transformQuat($$._tempVector30,this._parent.rotation,$$._tempVector30),$aI.add($x,$$._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($x){if(null!=this._parent){$aI.subtract($x,this._parent.position,this._localPosition);var $I=this._parent.scale.elements,$z=$I[0],$k=$I[1],$l=$I[2];if(1!==$z||1!==$k||1!==$l){var $n=$$._tempVector30,$a=$n.elements;$a[0]=1/$z,$a[1]=1/$k,$a[2]=1/$l,$aI.multiply(this._localPosition,$n,this._localPosition)}this._parent.rotation.invert($$._tempQuaternion0),$aI.transformQuat(this._localPosition,$$._tempQuaternion0,this._localPosition)}else $x.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$x,this._positionUpdate=!1}),$R(0,$I,"localScale",function(){return this._localScale},function($x){this._localScale=$x,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$R(0,$I,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($$._tempVector30);var $x=$$._tempVector30.elements,$I=this._localRotationEuler.elements;$I[0]=$x[1]*$$._angleToRandin,$I[1]=$x[0]*$$._angleToRandin,$I[2]=$x[2]*$$._angleToRandin}return this._localRotationEuler},function($x){this._localRotationEuler=$x,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$R(0,$I,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$zI.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($x){null!=this._parent?(this._parent.rotation.invert($$._tempQuaternion0),$zI.multiply($x,$$._tempQuaternion0,this._localRotation)):$x.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$x,this._rotationUpdate=!1}),$R(0,$I,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$aI.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($x){if(null!==this._parent){var $I=this._parent.scale.elements,$z=$$._tempVector30.elements;$z[0]=1/$I[0],$z[1]=1/$I[1],$z[2]=1/$I[2],$aI.multiply($x,$$._tempVector30,this._localScale)}else $x.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$x,this._scaleUpdate=!1}),$R(0,$I,"rotationEuler",null,function($x){$zI.createFromYawPitchRoll($x.y,$x.x,$x.z,this._rotation),this.rotation=this._rotation}),$R(0,$I,"forward",function(){var $x=this.worldMatrix.elements;return this._forward.elements[0]=-$x[8],this._forward.elements[1]=-$x[9],this._forward.elements[2]=-$x[10],this._forward}),$R(0,$I,"up",function(){var $x=this.worldMatrix.elements;return this._up.elements[0]=$x[4],this._up.elements[1]=$x[5],this._up.elements[2]=$x[6],this._up}),$R(0,$I,"right",function(){var $x=this.worldMatrix.elements;return this._right.elements[0]=$x[0],this._right.elements[1]=$x[1],this._right.elements[2]=$x[2],this._right}),$R(0,$I,"parent",function(){return this._parent},function($x){if(this._parent!==$x){if(this._parent){var $I=this._parent._childs,$z=$I.indexOf(this);$I.splice($z,1)}$x&&($x._childs.push(this),$x&&this._onWorldTransform()),this._parent=$x}}),$b($$,["_tempVector30",function(){return this._tempVector30=new $aI},"_tempVector31",function(){return this._tempVector31=new $aI},"_tempVector32",function(){return this._tempVector32=new $aI},"_tempVector33",function(){return this._tempVector33=new $aI},"_tempQuaternion0",function(){return this._tempQuaternion0=new $zI},"_tempMatrix0",function(){return this._tempMatrix0=new $xI},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$$}(),$vI=(function($x){function $I(){this._rotation=0,this._matNeedUpdte=!1,$I.__super.call(this),this._matrix=new $xI,this._offset=new $nI,this._tiling=new $nI(1,1)}$_($I,"laya.d3.core.TransformUV",$n);var $z=$I.prototype;$C.imps($z,{"laya.d3.core.IClone":!0}),$z._updateMatrix=function(){$I._tempOffsetV3.elements[0]=this._offset.x,$I._tempOffsetV3.elements[1]=this._offset.y,$zI.createFromYawPitchRoll(0,0,this._rotation,$I._tempRotationQua),$I._tempTitlingV3.elements[0]=this._tiling.x,$I._tempTitlingV3.elements[1]=this._tiling.y,$xI.createAffineTransformation($I._tempOffsetV3,$I._tempRotationQua,$I._tempTitlingV3,this._matrix)},$z.cloneTo=function($x){$x._matrix=this._matrix.clone(),$x._offset=this._offset.clone(),$x._rotation=this._rotation,$x._tiling=this._tiling.clone()},$z.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$z,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$R(0,$z,"tiling",function(){return this._tiling},function($x){this._tiling=$x,this._matNeedUpdte=!0}),$R(0,$z,"offset",function(){return this._offset},function($x){this._offset=$x,this._matNeedUpdte=!0}),$R(0,$z,"rotation",function(){return this._rotation},function($x){this._rotation=$x,this._matNeedUpdte=!0}),$b($I,["_tempOffsetV3",function(){return this._tempOffsetV3=new $aI(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $zI},"_tempTitlingV3",function(){return this._tempTitlingV3=new $aI(1,1,1)}])}(),function($z){function $x(){this.x=NaN,this.y=NaN,this.z=NaN,$x.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$_($x,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$z);var $I=$x.prototype;$I._getShapeBoundBox=function($x){var $I=$x.min.elements;$I[0]=.5*-this.x,$I[1]=.5*-this.y,$I[2]=.5*-this.z;var $z=$x.max.elements;$z[0]=.5*this.x,$z[1]=.5*this.y,$z[2]=.5*this.z},$I._getSpeedBoundBox=function($x){var $I=$x.min.elements;$I[0]=0,$I[1]=0,$I[2]=0;var $z=$x.max.elements;$z[0]=0,$z[1]=1,$z[2]=0},$I.generatePositionAndDirection=function($x,$I,$z,$k){var $l=$x.elements,$n=$I.elements;$z?($z.seed=$k[16],$B._randomPointInsideHalfUnitBox($x,$z),$k[16]=$z.seed):$B._randomPointInsideHalfUnitBox($x),$l[0]=this.x*$l[0],$l[1]=this.y*$l[1],$l[2]=this.z*$l[2],this.randomDirection?$z?($z.seed=$k[17],$B._randomPointUnitSphere($I,$z),$k[17]=$z.seed):$B._randomPointUnitSphere($I):($n[0]=0,$n[1]=0,$n[2]=1)},$I.cloneTo=function($x){$z.prototype.cloneTo.call(this,$x);var $I=$x;$I.x=this.x,$I.y=this.y,$I.z=this.z,$I.randomDirection=this.randomDirection}}($W),function($z){function $a(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$a.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$_($a,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$z);var $x=$a.prototype;$x._getShapeBoundBox=function($x){var $I=$x.min.elements;$I[0]=$I[2]=-this.radius,$I[1]=0;var $z=$x.max.elements;$z[0]=$z[2]=this.radius,$z[1]=0},$x._getSpeedBoundBox=function($x){var $I=$x.min.elements;$I[0]=$I[1]=-1,$I[2]=0;var $z=$x.max.elements;$z[0]=$z[1]=1,$z[2]=0},$x.generatePositionAndDirection=function($x,$I,$z,$k){var $l=$x.elements,$n=$a._tempPositionPoint.elements;$z?($z.seed=$k[16],this.emitFromEdge?$B._randomPointUnitArcCircle(this.arc,$a._tempPositionPoint,$z):$B._randomPointInsideUnitArcCircle(this.arc,$a._tempPositionPoint,$z),$k[16]=$z.seed):this.emitFromEdge?$B._randomPointUnitArcCircle(this.arc,$a._tempPositionPoint):$B._randomPointInsideUnitArcCircle(this.arc,$a._tempPositionPoint),$l[0]=-$n[0],$l[1]=$n[1],$l[2]=0,$aI.scale($x,this.radius,$x),this.randomDirection?$z?($z.seed=$k[17],$B._randomPointUnitSphere($I,$z),$k[17]=$z.seed):$B._randomPointUnitSphere($I):$x.cloneTo($I)},$x.cloneTo=function($x){$z.prototype.cloneTo.call(this,$x);var $I=$x;$I.radius=this.radius,$I.arc=this.arc,$I.emitFromEdge=this.emitFromEdge,$I.randomDirection=this.randomDirection},$b($a,["_tempPositionPoint",function(){return this._tempPositionPoint=new $nI}])}($W),function($z){function $T(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$T.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$_($T,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$z);var $x=$T.prototype;$x._getShapeBoundBox=function($x){var $I=this.radius+this.length*Math.sin(this.angle),$z=this.length*Math.cos(this.angle),$k=$x.min.elements;$k[0]=$k[1]=-$I,$k[2]=0;var $l=$x.max.elements;$l[0]=$l[1]=$I,$l[2]=$z},$x._getSpeedBoundBox=function($x){var $I=Math.sin(this.angle),$z=$x.min.elements;$z[0]=$z[1]=-$I,$z[2]=0;var $k=$x.max.elements;$k[0]=$z[1]=$I,$k[2]=1},$x.generatePositionAndDirection=function($x,$I,$z,$k){var $l,$n=$x.elements,$a=$I.elements,$$=$T._tempPositionPoint.elements,$w=NaN,$i=NaN,$F=Math.cos(this.angle),$b=Math.sin(this.angle);switch(this.emitType){case 0:$z?($z.seed=$k[16],$B._randomPointInsideUnitCircle($T._tempPositionPoint,$z),$k[16]=$z.seed):$B._randomPointInsideUnitCircle($T._tempPositionPoint),$w=$$[0],$i=$$[1],$n[0]=$w*this.radius,$n[1]=$i*this.radius,$n[2]=0,this.randomDirection?($z?($z.seed=$k[17],$B._randomPointInsideUnitCircle($T._tempDirectionPoint,$z),$k[17]=$z.seed):$B._randomPointInsideUnitCircle($T._tempDirectionPoint),$l=$T._tempDirectionPoint.elements,$a[0]=$l[0]*$b,$a[1]=$l[1]*$b):($a[0]=$w*$b,$a[1]=$i*$b),$a[2]=$F;break;case 1:$z?($z.seed=$k[16],$B._randomPointUnitCircle($T._tempPositionPoint,$z),$k[16]=$z.seed):$B._randomPointUnitCircle($T._tempPositionPoint),$w=$$[0],$i=$$[1],$n[0]=$w*this.radius,$n[1]=$i*this.radius,$n[2]=0,this.randomDirection?($z?($z.seed=$k[17],$B._randomPointInsideUnitCircle($T._tempDirectionPoint,$z),$k[17]=$z.seed):$B._randomPointInsideUnitCircle($T._tempDirectionPoint),$l=$T._tempDirectionPoint.elements,$a[0]=$l[0]*$b,$a[1]=$l[1]*$b):($a[0]=$w*$b,$a[1]=$i*$b),$a[2]=$F;break;case 2:$z?($z.seed=$k[16],$B._randomPointInsideUnitCircle($T._tempPositionPoint,$z)):$B._randomPointInsideUnitCircle($T._tempPositionPoint),$w=$$[0],$i=$$[1],$n[0]=$w*this.radius,$n[1]=$i*this.radius,$a[$n[2]=0]=$w*$b,$a[1]=$i*$b,$a[2]=$F,$aI.normalize($I,$I),$z?($aI.scale($I,this.length*$z.getFloat(),$I),$k[16]=$z.seed):$aI.scale($I,this.length*Math.random(),$I),$aI.add($x,$I,$x),this.randomDirection&&($z?($z.seed=$k[17],$B._randomPointUnitSphere($I,$z),$k[17]=$z.seed):$B._randomPointUnitSphere($I));break;case 3:$z?($z.seed=$k[16],$B._randomPointUnitCircle($T._tempPositionPoint,$z)):$B._randomPointUnitCircle($T._tempPositionPoint),$w=$$[0],$i=$$[1],$n[0]=$w*this.radius,$n[1]=$i*this.radius,$a[$n[2]=0]=$w*$b,$a[1]=$i*$b,$a[2]=$F,$aI.normalize($I,$I),$z?($aI.scale($I,this.length*$z.getFloat(),$I),$k[16]=$z.seed):$aI.scale($I,this.length*Math.random(),$I),$aI.add($x,$I,$x),this.randomDirection&&($z?($z.seed=$k[17],$B._randomPointUnitSphere($I,$z),$k[17]=$z.seed):$B._randomPointUnitSphere($I));break;default:throw new Error("ConeShape:emitType is invalid.")}},$x.cloneTo=function($x){$z.prototype.cloneTo.call(this,$x);var $I=$x;$I.angle=this.angle,$I.radius=this.radius,$I.length=this.length,$I.emitType=this.emitType,$I.randomDirection=this.randomDirection},$b($T,["_tempPositionPoint",function(){return this._tempPositionPoint=new $nI},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $nI}])}($W),function($z){function $x(){this.radius=NaN,this.emitFromShell=!1,$x.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$_($x,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$z);var $I=$x.prototype;$I._getShapeBoundBox=function($x){var $I=$x.min.elements;$I[0]=$I[1]=$I[2]=-this.radius;var $z=$x.max.elements;$z[0]=$z[1]=this.radius,$z[2]=0},$I._getSpeedBoundBox=function($x){var $I=$x.min.elements;$I[0]=$I[1]=-1,$I[2]=0;var $z=$x.max.elements;$z[0]=$z[1]=$z[2]=1},$I.generatePositionAndDirection=function($x,$I,$z,$k){var $l=$x.elements;$z?($z.seed=$k[16],this.emitFromShell?$B._randomPointUnitSphere($x,$z):$B._randomPointInsideUnitSphere($x,$z),$k[16]=$z.seed):this.emitFromShell?$B._randomPointUnitSphere($x):$B._randomPointInsideUnitSphere($x),$aI.scale($x,this.radius,$x);var $n=$l[2];$n<0&&($l[2]=-1*$n),this.randomDirection?$z?($z.seed=$k[17],$B._randomPointUnitSphere($I,$z),$k[17]=$z.seed):$B._randomPointUnitSphere($I):$x.cloneTo($I)},$I.cloneTo=function($x){$z.prototype.cloneTo.call(this,$x);var $I=$x;$I.radius=this.radius,$I.emitFromShell=this.emitFromShell,$I.randomDirection=this.randomDirection}}($W),function($z){function $x(){this.radius=NaN,this.emitFromShell=!1,$x.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$_($x,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$z);var $I=$x.prototype;$I._getShapeBoundBox=function($x){var $I=$x.min.elements;$I[0]=$I[1]=$I[2]=-this.radius;var $z=$x.max.elements;$z[0]=$z[1]=$z[2]=this.radius},$I._getSpeedBoundBox=function($x){var $I=$x.min.elements;$I[0]=$I[1]=$I[2]=-1;var $z=$x.max.elements;$z[0]=$z[1]=$z[2]=1},$I.generatePositionAndDirection=function($x,$I,$z,$k){$z?($z.seed=$k[16],this.emitFromShell?$B._randomPointUnitSphere($x,$z):$B._randomPointInsideUnitSphere($x,$z),$k[16]=$z.seed):this.emitFromShell?$B._randomPointUnitSphere($x):$B._randomPointInsideUnitSphere($x),$aI.scale($x,this.radius,$x),this.randomDirection?$z?($z.seed=$k[17],$B._randomPointUnitSphere($I,$z),$k[17]=$z.seed):$B._randomPointUnitSphere($I):$x.cloneTo($I)},$I.cloneTo=function($x){$z.prototype.cloneTo.call(this,$x);var $I=$x;$I.radius=this.radius,$I.emitFromShell=this.emitFromShell,$I.randomDirection=this.randomDirection}}($W),function($x){function $I(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$I.__super.call(this)}return $_($I,"laya.d3.core.render.SubMeshRenderElement",$H),$I}()),$LI=function($x){function $N($x,$I,$z,$k,$l,$n){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$x,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$_I.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$AI.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$AI.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$SI.SHADERDEFINE_ALPHATEST]="ALPHATEST";$N.__super.call(this,$x,$I,$z,null,{}),this._attributeMap=$k;var $a;for($a in $l){var $$=$l[$a];switch($$[1]){case 0:this._renderElementUniformMap[$a]=$$[0];break;case 1:this._materialUniformMap[$a]=$$[0];break;case 2:this._spriteUniformMap[$a]=$$[0];break;case 3:this._cameraUniformMap[$a]=$$[0];break;case 4:this._sceneUniformMap[$a]=$$[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$_($N,"laya.d3.shader.ShaderCompile3D",$m);var $I=$N.prototype;return $I._definesToNameDic=function($x,$I){for(var $z={},$k=1,$l=0;$l<32&&!($x<($k=1<<$l));$l++)if($x&$k){var $n=$I[$k];$n&&($z[$n]="")}return $z},$I.withCompile=function($x,$I,$z,$k){var $l,$n,$a;if($n=this.sharders[$x])if($a=$n[$I]){if($l=$a[$z])return $l}else $a=$n[$I]=[];else $a=($n=this.sharders[$x]=[])[$I]=[];var $$,$w=this._definesToNameDic($x,$N._globalInt2name),$i=this._definesToNameDic($I,this._spriteInt2name),$F=this._definesToNameDic($z,this._materialInt2name),$b={},$T="";if($w)for($$ in $w)$T+="#define "+$$+"\n",$b[$$]=!0;if($i)for($$ in $i)$T+="#define "+$$+"\n",$b[$$]=!0;if($F)for($$ in $F)$T+="#define "+$$+"\n",$b[$$]=!0;var $_=$YI.nameKey.getName(this._name)+" compile ("+$x+","+$I+","+$z+")",$R=this._VS.toscript($b,[]),$s=this._PS.toscript($b,[]);$X.now();if($l=$YI.create($T+$R.join("\n"),$T+$s.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$k,$_),$a[$z]=$l,laya.d3.shader.ShaderCompile3D.debugMode)$X.now();return $l},$I.precompileShaderWithShaderDefine=function($x,$I,$z){this.withCompile($x,$I,$z,!0)},$I.addMaterialDefines=function($x){var $I=$x.defines;for(var $z in $I){var $k=$I[$z],$l=parseInt($z);this._materialInt2name[$l]=$k,this._materialName2Int[$k]=$l}},$I.addSpriteDefines=function($x){var $I=$x.defines;for(var $z in $I){var $k=$I[$z],$l=parseInt($z);this._spriteInt2name[$l]=$k,this._spriteName2Int[$k]=$l}},$I.getMaterialDefineByName=function($x){return this._materialName2Int[$x]},$I.registerMaterialDefine=function($x){var $I=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$I]=$x,this._materialName2Int[$x]=$I},$I.registerSpriteDefine=function($x){var $I=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$I]=$x,this._spriteName2Int[$x]=$I},$N._globalRegDefine=function($x,$I){$N._globalInt2name[$I]=$x},$N.add=function($x,$I,$z,$k,$l){return laya.d3.shader.ShaderCompile3D._preCompileShader[$x]=new $N($x,$I,$z,$k,$l,$m.includes)},$N.get=function($x){return laya.d3.shader.ShaderCompile3D._preCompileShader[$YI.nameKey.getID($x)]},$N._preCompileShader={},$N._globalInt2name=[],$N.debugMode=!1,$N.SHADERDEFINE_HIGHPRECISION=1,$N.SHADERDEFINE_FOG=4,$N.SHADERDEFINE_DIRECTIONLIGHT=8,$N.SHADERDEFINE_POINTLIGHT=16,$N.SHADERDEFINE_SPOTLIGHT=32,$N.SHADERDEFINE_UV0=64,$N.SHADERDEFINE_COLOR=128,$N.SHADERDEFINE_UV1=256,$N.SAHDERDEFINE_DEPTHFOG=131072,$N}(),$KI=function($x){function $R(){$R.__super.call(this)}$_($R,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$kx);var $I=$R.prototype;return $I._getStaticBatch=function($x,$I,$z,$k){var $l,$n;return $n=$x?$x.id.toString()+$z.id.toString()+$I.id.toString()+$k.toString():$z.id.toString()+$I.id.toString()+$k.toString(),this._staticBatches[$n]?$l=this._staticBatches[$n]:this._staticBatches[$n]=$l=new $EI($n,this,$x,$I,$z),$l},$I._initStaticBatchs=function($x){var $I,$z;this._initBatchRenderElements.sort($R._sortPrepareStaticBatch);for(var $k,$l=!1,$n=0,$a=0,$$=this._initBatchRenderElements.length;$a<$$;$a++){var $w,$i=this._initBatchRenderElements[$a],$F=$i.renderObj._getVertexBuffer(0);$i._sprite3D;if($z===$F.vertexDeclaration&&$I===$i._material)if($l)$k._addCombineBatchRenderObjTest($i)?($w=$i._staticBatch)!==$k&&($w&&$w._deleteCombineBatchRenderObj($i),$k._addCombineBatchRenderObj($i)):($l=!1,$n++);else{var $b=this._initBatchRenderElements[$a-1],$T=$b.renderObj,$_=$i.renderObj;$l=!(65535<$T._getVertexBuffer().vertexCount+$_._getVertexBuffer().vertexCount)&&($k=this._getStaticBatch($x,$z,$I,$n),($w=$b._staticBatch)!==$k&&($w&&$w._deleteCombineBatchRenderObj($b),$k._addCombineBatchRenderObj($b)),($w=$i._staticBatch)!==$k&&($w&&$w._deleteCombineBatchRenderObj($i),$k._addCombineBatchRenderObj($i)),!0)}else $l=!1,$n=0;$I=$i._material,$z=$F.vertexDeclaration}},$R._sortPrepareStaticBatch=function($x,$I){var $z=$x._render,$k=$I._render,$l=$z.lightmapIndex-$k.lightmapIndex;if(0!=$l)return $l;var $n=$z.receiveShadow-$k.receiveShadow;if(0!=$n)return $n;var $a=$x._mainSortID-$I._mainSortID;return 0==$a?$x.renderObj.triangleCount-$I.renderObj.triangleCount:$a},$R}(),$EI=function($x){function $n($x,$I,$z,$k,$l){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$n.__super.call(this,$x,$I,$z),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$k,this._material=$l}$_($n,"laya.d3.graphics.SubMeshStaticBatch",$lx);var $I=$n.prototype;return $I._compareBatchRenderElement=function($x,$I){return $x._batchIndexStart>$I._batchIndexStart},$I._addCombineBatchRenderObjTest=function($x){var $I=$x.renderObj._vertexCount;return!(65535<(0<$I?this._currentCombineVertexCount+$I:this._currentCombineVertexCount+$x.renderObj._getVertexBuffer().vertexCount))},$I._addCombineBatchRenderObj=function($x){var $I=$x.renderObj,$z=$I._vertexCount;this._initBatchRenderElements.push($x),$x._staticBatch=this,0<$z?(this._currentCombineIndexCount+=$I._indexCount,this._currentCombineVertexCount+=$z):(this._currentCombineIndexCount=this._currentCombineIndexCount+$I._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$I._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$I._deleteCombineBatchRenderObj=function($x){var $I=$x.renderObj,$z=this._initBatchRenderElements.indexOf($x);if(-1!==$z){this._initBatchRenderElements.splice($z,1),$x._staticBatch=null;var $k=$I._vertexCount;0<$k?(this._currentCombineIndexCount=this._currentCombineIndexCount-$I._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$k):(this._currentCombineIndexCount=this._currentCombineIndexCount-$I._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$I._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$I._finishInit=function(){if(this._needFinishCombine){var $x=0,$I=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $z=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$k=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$WI.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$VI.create("ushort",this._currentCombineIndexCount,35044);for(var $l=0,$n=this._initBatchRenderElements.length;$l<$n;$l++){var $a=this._initBatchRenderElements[$l],$$=$a.renderObj,$w=$$._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$a._sprite3D),$i=$$.getIndices(),$F=$a._sprite3D.transform._isFrontFaceInvert,$b=$x/(this._vertexDeclaration.vertexStride/4)-$$._vertexStart,$T=$I,$_=$T+$i.length;$a._batchIndexStart=$T,$a._batchIndexEnd=$_,$k.set($i,$I);var $R=0;if($F)for($R=$T;$R<$_;$R+=3){$k[$R]=$b+$k[$R];var $s=$k[$R+1],$N=$k[$R+2];$k[$R+1]=$b+$N,$k[$R+2]=$b+$s}else for($R=$T;$R<$_;$R+=3)$k[$R]=$b+$k[$R],$k[$R+1]=$b+$k[$R+1],$k[$R+2]=$b+$k[$R+2];$I+=$i.length,$z.set($w,$x),$x+=$w.length}this._vertexBuffer.setData($z),this._indexBuffer.setData($k),this._needFinishCombine=!1}},$I._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $vI)},$I._getRenderElement=function($x,$I,$z){for(var $k,$l,$n=this._batchRenderElements.length,$a=!0,$$=0;$$<$n;$$++){var $w,$i,$F=($l=this._batchRenderElements[$$])._sprite3D._render;if(0!==$$&&($a=($w=($k=this._batchRenderElements[$$-1])._sprite3D._render).lightmapIndex!==$F.lightmapIndex||$w.receiveShadow!==$F.receiveShadow||$k._batchIndexEnd!==$l._batchIndexStart),$a){($i=this._getCombineRenderElementFromPool()).renderObj=this,$i._material=this._material,$i._batchIndexStart=$l._batchIndexStart,$i._batchIndexEnd=$l._batchIndexEnd;var $b=$F.lightmapIndex,$T=$b+1,$_=this._batchOwnerIndices[$T];$_||($_=this._batchOwnerIndices[$T]=[]);var $R,$s=$_[$l._render.receiveShadow?1:0];void 0===$s?($_[$F.receiveShadow?1:0]=this._batchOwners.length,($R=new $pI(null,"StaticBatchMeshSprite3D"))._scene=$I,$R._transform=this._rootOwner?this._rootOwner._transform:null,$R._render.lightmapIndex=$b,$R._render.receiveShadow=$l._render.receiveShadow,this._batchOwners.push($R)):$R=this._batchOwners[$s],$R._render._renderUpdate($z),$i._sprite3D=$R,$x.push($i)}else $i._batchIndexEnd=$l._batchIndexEnd}},$I._beforeRender=function($x){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$I._render=function($x){var $I=$x.renderElement,$z=$I._batchIndexStart,$k=$I._batchIndexEnd-$z;$Z.mainContext.drawElements(4,$k,5123,2*$z),$L.drawCall++,$L.trianglesFaces+=$k/3},$I.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$I._getVertexBuffer=function($x){return void 0===$x&&($x=0),this._vertexBuffer},$n}(),$OI=function($x){function $I(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$I.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$_($I,"laya.d3.core.ComponentNode",$i);var $z=$I.prototype;return $z.addComponent=function($x){var $I,$z=this._componentsMap.indexOf($x);if(-1===$z)$I=[],this._componentsMap.push($x),this._typeComponentsIndices.push($I);else if($I=this._typeComponentsIndices[$z],this._components[$I[0]].isSingleton)throw new Error("无法单实例创建"+$x+"组件，"+$x+"组件已存在！");var $k=$l.getInstance($x);return $I.push(this._components.length),this._components.push($k),$k instanceof laya.d3.component.Script&&this._scripts.push($k),$k._initialize(this),$k},$z._removeComponent=function($x,$I){var $z=this._typeComponentsIndices[$x],$k=$z[$I],$l=this._components[$k];this._components.splice($k,1),$l instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($l),1),$z.splice($I,1),0===$z.length&&(this._typeComponentsIndices.splice($x,1),this._componentsMap.splice($x,1));for(var $n=0,$a=this._componentsMap.length;$n<$a;$n++)for(var $$=($z=this._typeComponentsIndices[$n]).length-1;0<=$$;$$--){var $w=$z[$$];if(!($k<$w))break;$z[$$]=--$w}$l._destroy()},$z.getComponentByType=function($x,$I){void 0===$I&&($I=0);var $z=this._componentsMap.indexOf($x);return-1===$z?null:this._components[this._typeComponentsIndices[$z][$I]]},$z.getComponentsByType=function($x,$I){var $z=this._componentsMap.indexOf($x);if(-1!==$z){var $k=this._typeComponentsIndices[$z],$l=$k.length;$I.length=$l;for(var $n=0;$n<$l;$n++)$I[$n]=this._components[$k[$n]]}else $I.length=0},$z.getComponentByIndex=function($x){return this._components[$x]},$z.removeComponentByType=function($x,$I){void 0===$I&&($I=0);var $z=this._componentsMap.indexOf($x);-1!==$z&&this._removeComponent($z,$I)},$z.removeComponentsByType=function($x){var $I=this._componentsMap.indexOf($x);if(-1!==$I)for(var $z=this._typeComponentsIndices[$I],$k=0,$l=$z.length;$k<$l;$z.length<$l?$l--:$k++)this._removeComponent($I,$k)},$z.removeAllComponent=function(){for(var $x=0,$I=this._componentsMap.length;$x<$I;this._componentsMap.length<$I?$I--:$x++)this.removeComponentsByType(this._componentsMap[$x])},$z._updateComponents=function($x){for(var $I=0,$z=this._components.length;$I<$z;$I++){var $k=this._components[$I];!$k.started&&($k._start($x),$k.started=!0),$k.enable&&$k._update($x)}},$z._lateUpdateComponents=function($x){for(var $I=0;$I<this._components.length;$I++){var $z=this._components[$I];!$z.started&&($z._start($x),$z.started=!0),$z.enable&&$z._lateUpdate($x)}},$z._preRenderUpdateComponents=function($x){for(var $I=0;$I<this._components.length;$I++){var $z=this._components[$I];!$z.started&&($z._start($x),$z.started=!0),$z.enable&&$z._preRenderUpdate($x)}},$z._postRenderUpdateComponents=function($x){for(var $I=0;$I<this._components.length;$I++){var $z=this._components[$I];!$z.started&&($z._start($x),$z.started=!0),$z.enable&&$z._postRenderUpdate($x)}},$I}(),$SI=function($k){function $x(){$x.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $TI,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $$I(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$_($x,"laya.d3.core.material.BaseMaterial",$k);var $I=$x.prototype;return $C.imps($I,{"laya.d3.core.IClone":!0}),$I._addShaderDefine=function($x){this._shaderDefineValue|=$x},$I._removeShaderDefine=function($x){this._shaderDefineValue&=~$x},$I._addDisablePublicShaderDefine=function($x){this._disablePublicShaderDefine|=$x},$I._removeDisablePublicShaderDefine=function($x){this._disablePublicShaderDefine&=~$x},$I._setBuffer=function($x,$I){this._shaderValues.setValue($x,$I),this._values[$x]=$I},$I._getBuffer=function($x){return this._values[$x]},$I._setMatrix4x4=function($x,$I){this._shaderValues.setValue($x,$I?$I.elements:null),this._values[$x]=$I},$I._getMatrix4x4=function($x){return this._values[$x]},$I._setInt=function($x,$I){this._shaderValues.setValue($x,$I),this._values[$x]=$I},$I._getInt=function($x){return this._values[$x]},$I._setNumber=function($x,$I){this._shaderValues.setValue($x,$I),this._values[$x]=$I},$I._getNumber=function($x){return this._values[$x]},$I._setBool=function($x,$I){this._shaderValues.setValue($x,$I),this._values[$x]=$I},$I._getBool=function($x){return this._values[$x]},$I._setVector2=function($x,$I){this._shaderValues.setValue($x,$I?$I.elements:null),this._values[$x]=$I},$I._getVector2=function($x){return this._values[$x]},$I._setColor=function($x,$I){this._shaderValues.setValue($x,$I?$I.elements:null),this._values[$x]=$I},$I._getColor=function($x){return this._values[$x]},$I._setTexture=function($x,$I){var $z=this._values[$x];this._values[$x]=$I,this._shaderValues.setValue($x,$I),0<this.referenceCount&&($z&&$z._removeReference(),$I&&$I._addReference())},$I._getTexture=function($x){return this._values[$x]},$I._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$I._getShader=function($x,$I,$z){var $k=($x|$I)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($k,$z,this._shaderDefineValue),this._shader},$I._setRenderStateBlendDepth=function(){var $x=$Z.mainContext;switch($U.setDepthMask($x,this.depthWrite),0===this.depthTest?$U.setDepthTest($x,!1):($U.setDepthTest($x,!0),$U.setDepthFunc($x,this.depthTest)),this.blend){case 0:$U.setBlend($x,!1);break;case 1:$U.setBlend($x,!0),$U.setBlendFunc($x,this.srcBlend,this.dstBlend);break;case 2:$U.setBlend($x,!0)}},$I._setRenderStateFrontFace=function($x,$I){var $z=$Z.mainContext,$k=0;switch(this.cull){case 0:$U.setCullFace($z,!1);break;case 1:$U.setCullFace($z,!0),$k=$x?$I&&$I._isFrontFaceInvert?2305:2304:$I&&$I._isFrontFaceInvert?2304:2305,$U.setFrontFace($z,$k);break;case 2:$U.setCullFace($z,!0),$k=$x?$I&&$I._isFrontFaceInvert?2304:2305:$I&&$I._isFrontFaceInvert?2305:2304,$U.setFrontFace($z,$k)}},$I.onAsynLoaded=function($x,$I,$z){var $k=$I[0],$l=$I[1];switch($k.version){case"LAYAMATERIAL:01":var $n=0,$a=0,$$=$k.props;for(var $w in $$)switch($w){case"vectors":var $i=$$[$w];for($n=0,$a=$i.length;$n<$a;$n++){var $F=$i[$n],$b=$F.value;switch($b.length){case 2:this[$F.name]=new $nI($b[0],$b[1]);break;case 3:this[$F.name]=new $aI($b[0],$b[1],$b[2]);break;case 4:this[$F.name]=new $$I($b[0],$b[1],$b[2],$b[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $T=$$[$w];for($n=0,$a=$T.length;$n<$a;$n++){var $_=$T[$n],$R=$_.path;$R&&(this[$_.name]=$D.getRes($l[$R]))}break;case"defines":var $s=$$[$w];for($n=0,$a=$s.length;$n<$a;$n++){var $N=this._shaderCompile.getMaterialDefineByName($s[$n]);this._addShaderDefine($N)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$w]=$$[$w];break;case"renderQueue":switch($$[$w]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$w]=$$[$w]}break;case"LAYAMATERIAL:02":for($w in $$=$k.props)switch($w){case"vectors":for($n=0,$a=($i=$$[$w]).length;$n<$a;$n++)switch(($b=($F=$i[$n]).value).length){case 2:this[$F.name]=new $nI($b[0],$b[1]);break;case 3:this[$F.name]=new $aI($b[0],$b[1],$b[2]);break;case 4:this[$F.name]=new $$I($b[0],$b[1],$b[2],$b[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($n=0,$a=($T=$$[$w]).length;$n<$a;$n++)($R=($_=$T[$n]).path)&&(this[$_.name]=$D.getRes($l[$R]));break;case"defines":for($n=0,$a=($s=$$[$w]).length;$n<$a;$n++)$N=this._shaderCompile.getMaterialDefineByName($s[$n]),this._addShaderDefine($N);break;default:this[$w]=$$[$w]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$I._addReference=function(){$k.prototype._addReference.call(this);for(var $x=0,$I=this._values.length;$x<$I;$x++){var $z=this._values[$x];$z&&$z instanceof laya.d3.resource.BaseTexture&&$z._addReference()}},$I._removeReference=function(){$k.prototype._removeReference.call(this);for(var $x=0,$I=this._values.length;$x<$I;$x++){var $z=this._values[$x];$z&&$z instanceof laya.d3.resource.BaseTexture&&$z._removeReference()}},$I.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$I.setShaderName=function($x){var $I=$YI.nameKey.getID($x);if(-1===$I)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$LI._preCompileShader[$I]},$I.cloneTo=function($x){var $I=$x;$I.name=this.name,$I.cull=this.cull,$I.blend=this.blend,$I.srcBlend=this.srcBlend,$I.dstBlend=this.dstBlend,$I.srcBlendRGB=this.srcBlendRGB,$I.dstBlendRGB=this.dstBlendRGB,$I.srcBlendAlpha=this.srcBlendAlpha,$I.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($I.blendConstColor),$I.blendEquation=this.blendEquation,$I.blendEquationRGB=this.blendEquationRGB,$I.blendEquationAlpha=this.blendEquationAlpha,$I.depthTest=this.depthTest,$I.depthWrite=this.depthWrite,$I.renderQueue=this.renderQueue,$I._shader=this._shader,$I._disablePublicShaderDefine=this._disablePublicShaderDefine,$I._shaderDefineValue=this._shaderDefineValue;var $z,$k=0,$l=$I._shaderValues;$I._shaderValues.data.length=this._shaderValues.data.length;var $n=this._values.length,$a=$I._values;for($k=0,$z=$a.length=$n;$k<$z;$k++){var $$=this._values[$k];if($$)if("number"==typeof $$)$a[$k]=$$,$l.data[$k]=$$;else if("number"==typeof $$&&Math.floor($$)==$$)$a[$k]=$$,$l.data[$k]=$$;else if("boolean"==typeof $$)$a[$k]=$$,$l.data[$k]=$$;else if($$ instanceof laya.d3.math.Vector2){var $w=$a[$k]||($a[$k]=new $nI);$$.cloneTo($w),$l.data[$k]=$w.elements}else if($$ instanceof laya.d3.math.Vector3){var $i=$a[$k]||($a[$k]=new $aI);$$.cloneTo($i),$l.data[$k]=$i.elements}else if($$ instanceof laya.d3.math.Vector4){var $F=$a[$k]||($a[$k]=new $$I);$$.cloneTo($F),$l.data[$k]=$F.elements}else if($$ instanceof laya.d3.math.Matrix4x4){var $b=$a[$k]||($a[$k]=new $xI);$$.cloneTo($b),$l.data[$k]=$b.elements}else $$ instanceof laya.d3.resource.BaseTexture&&($a[$k]=$$,$l.data[$k]=$$)}},$I.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$R(0,$I,"alphaTestValue",function(){return this._getNumber(0)},function($x){this._setNumber(0,$x)}),$R(0,$I,"alphaTest",function(){return this._alphaTest},function($x){(this._alphaTest=$x)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$x.__init__=function(){$x.SHADERDEFINE_ALPHATEST=$x.shaderDefines.registerDefine("ALPHATEST")},$x.RENDERQUEUE_OPAQUE=2e3,$x.RENDERQUEUE_ALPHATEST=2450,$x.RENDERQUEUE_TRANSPARENT=3e3,$x.CULL_NONE=0,$x.CULL_FRONT=1,$x.CULL_BACK=2,$x.BLEND_DISABLE=0,$x.BLEND_ENABLE_ALL=1,$x.BLEND_ENABLE_SEPERATE=2,$x.BLENDPARAM_ZERO=0,$x.BLENDPARAM_ONE=1,$x.BLENDPARAM_SRC_COLOR=768,$x.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$x.BLENDPARAM_DST_COLOR=774,$x.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$x.BLENDPARAM_SRC_ALPHA=770,$x.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$x.BLENDPARAM_DST_ALPHA=772,$x.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$x.BLENDPARAM_SRC_ALPHA_SATURATE=776,$x.BLENDEQUATION_ADD=0,$x.BLENDEQUATION_SUBTRACT=1,$x.BLENDEQUATION_REVERSE_SUBTRACT=2,$x.DEPTHTEST_OFF=0,$x.DEPTHTEST_NEVER=512,$x.DEPTHTEST_LESS=513,$x.DEPTHTEST_EQUAL=514,$x.DEPTHTEST_LEQUAL=515,$x.DEPTHTEST_GREATER=516,$x.DEPTHTEST_NOTEQUAL=517,$x.DEPTHTEST_GEQUAL=518,$x.DEPTHTEST_ALWAYS=519,$x.SHADERDEFINE_ALPHATEST=1,$x.ALPHATESTVALUE=0,$b($x,["shaderDefines",function(){return this.shaderDefines=new $FI}]),$x}($N),$ZI=function($x){function $I(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$I.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$_($I,"laya.d3.resource.BaseTexture",$N);var $z=$I.prototype;return $R(0,$z,"width",function(){return this._width}),$R(0,$z,"repeat",function(){return this._repeat},function($x){if(this._repeat!==$x&&(this._repeat=$x,this._source)){var $I=$Z.mainContext;$U.bindTexture($I,this._type,this._source),$y.isPOT(this._width,this._height)&&this._repeat?($I.texParameteri(this._type,10242,10497),$I.texParameteri(this._type,10243,10497)):($I.texParameteri(this._type,10242,33071),$I.texParameteri(this._type,10243,33071))}}),$R(0,$z,"height",function(){return this._height}),$R(0,$z,"magFifter",function(){return this._magFifter},function($x){(this._magFifter=$x)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($x)}),$R(0,$z,"wrapModeV",function(){return this._wrapModeV}),$R(0,$z,"size",function(){return this._size}),$R(0,$z,"wrapModeU",function(){return this._wrapModeU}),$R(0,$z,"mipmap",function(){return this._mipmap},function($x){this._mipmap=$x,this._mipmap!=$x&&this._conchTexture&&this._conchTexture.setMipMap($x)}),$R(0,$z,"minFifter",function(){return this._minFifter},function($x){this._minFifter=$x,this._minFifter!=$x&&this._conchTexture&&this._conchTexture.setMinFifter($x)}),$R(0,$z,"format",function(){return this._format}),$R(0,$z,"source",function(){return this.activeResource(),this._source}),$R(0,$z,"defaulteTexture",function(){return $hI.grayTexture}),$I.WARPMODE_REPEAT=0,$I.WARPMODE_CLAMP=1,$I}(),$UI=function($x){function $I(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$I.__super.call(this),this._boundingBoxCorners=$k(8,null)}$_($I,"laya.d3.resource.models.BaseMesh",$N);var $z=$I.prototype;return $z._getPositions=function(){throw new Error("未Override,请重载该属性！")},$z._generateBoundingObject=function(){this._boundingSphere=new $Mx(new $aI,0),$Mx.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $rx(new $aI,new $aI),$rx.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$z.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$z.getRenderElement=function($x){throw new Error("未Override,请重载该属性！")},$R(0,$z,"subMeshCount",function(){return this._subMeshCount}),$R(0,$z,"boundingBox",function(){return this._boundingBox}),$R(0,$z,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$R(0,$z,"boundingSphere",function(){return this._boundingSphere}),$I}(),$XI=(function($x){function $I(){$I.__super.call(this)}$_($I,"laya.d3.component.Script",$mI);var $z=$I.prototype;$z.onTriggerEnter=function($x){},$z.onTriggerExit=function($x){},$z.onTriggerStay=function($x){},$R(0,$z,"isSingleton",function(){return $I._isSingleton}),$I._isSingleton=!1}(),function($x){function $I($x){this._owner=null,this._sharedMesh=null,$I.__super.call(this),this._owner=$x}$_($I,"laya.d3.core.MeshFilter",$x);var $z=$I.prototype;return $z._sharedMeshLoaded=function(){this.event("loaded")},$z._destroy=function(){$x.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$R(0,$z,"sharedMesh",function(){return this._sharedMesh},function($x){var $I=this._sharedMesh;$I&&$I._removeReference(),(this._sharedMesh=$x)._addReference(),this.event("meshchanged",[this,$I,$x]),$x.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$R(0,$z,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$R(0,$z,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$R(0,$z,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$R(0,$z,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$I}($yI)),$dI=function($x){function $I($x){$I.__super.call(this,$x),$x.meshFilter.on("meshchanged",this,this._onMeshChanged)}$_($I,"laya.d3.core.MeshRender",$CI);var $z=$I.prototype;return $z._onMeshChanged=function($x,$I,$z){$z.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$z.once("loaded",this,this._onMeshLoaed)},$z._onMeshLoaed=function($x,$I){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$z._calculateBoundingSphereByInitSphere=function($x){var $I=NaN,$z=this._owner.transform,$k=$z.scale.elements,$l=Math.abs($k[0]),$n=Math.abs($k[1]),$a=Math.abs($k[2]);$I=$n<=$l&&$a<=$l?$l:$a<=$n?$n:$a,$aI.transformCoordinate($x.center,$z.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$x.radius*$I},$z._calculateBoundBoxByInitCorners=function($x){for(var $I=this._owner.transform.worldMatrix,$z=0;$z<8;$z++)$aI.transformCoordinate($x[$z],$I,$CI._tempBoundBoxCorners[$z]);$rx.createfromPoints($CI._tempBoundBoxCorners,this._boundingBox)},$z._calculateBoundingSphere=function(){var $x=this._owner.meshFilter.sharedMesh;null==$x||null==$x.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($x.boundingSphere)},$z._calculateBoundingBox=function(){var $x=this._owner.meshFilter.sharedMesh;null==$x||null==$x.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($x.boundingBoxCorners)},$z._renderUpdate=function($x){var $I=this._owner.transform;if($I){this._setShaderValueMatrix4x4(0,$I.worldMatrix);var $z=this._owner.getProjectionViewWorldMatrix($x);this._setShaderValueMatrix4x4(1,$z)}else this._setShaderValueMatrix4x4(0,$xI.DEFAULT),this._setShaderValueMatrix4x4(1,$x);return $DI.debugMode&&this._renderRenderableBoundBox(),!0},$I}(),$jI=function($I){function $k(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$k.__super.call(this),this._renderState=new $u,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $TI,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $Ix,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $aI(.7,.7,.7),this.ambientColor=new $aI(.212,.227,.259),$Z.shaderHighPrecision&&this.addShaderDefine($LI.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$_($k,"laya.d3.core.scene.Scene",$I);var $x=$k.prototype;return $C.imps($x,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$x._setUrl=function($x){this._url=$x},$x._getGroup=function(){return this._group},$x._setGroup=function($x){this._group=$x},$x._display=function(){$C.stage._scenes.push(this),$C.stage._scenes.sort($k._sortScenes);for(var $x=0,$I=this._childs.length;$x<$I;$x++){var $z=this._childs[$x];$z.active&&$z._activeHierarchy()}},$x._unDisplay=function(){var $x=$C.stage._scenes;$x.splice($x.indexOf(this),1);for(var $I=0,$z=this._childs.length;$I<$z;$I++){var $k=this._childs[$I];$k.active&&$k._inActiveHierarchy()}},$x._addChild3D=function($x){$x.transform._onWorldTransform(),$x._setBelongScene(this),this.displayedInStage&&$x.active&&$x._activeHierarchy()},$x._removeChild3D=function($x){$x.transform.parent=null,this.displayedInStage&&$x.active&&$x._inActiveHierarchy(),$x._setUnBelongScene()},$x.initOctree=function($x,$I,$z,$k,$l){void 0===$l&&($l=6),this.treeSize=new $aI($x,$I,$z),this.treeLevel=$l,this.treeRoot=new $r(this,0),this.treeRoot.init($k,this.treeSize)},$x._prepareUpdateToRenderState=function($x,$I){$I.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$I.scene=this},$x._prepareSceneToRender=function($x){var $I=this._lights.length;if(0<$I)for(var $z=0,$k=0;$k<$I&&!(this._lights[$k]._prepareToScene($x)&&++$z>=this._enableLightCount);$k++);},$x._updateChilds=function($x){for(var $I=0,$z=this._childs.length;$I<$z;++$I)this._childs[$I]._update($x)},$x._preRenderScene=function($x,$I,$z){var $k,$l=$I._viewMatrix,$n=$I._projectionMatrix,$a=$I._projectionViewMatrix,$$=0,$w=$I.camera;for($w.useOcclusionCulling?this.treeRoot?$zx.renderObjectCullingOctree($z,this,$w,$l,$n,$a):$zx.renderObjectCulling($z,this,$w,$l,$n,$a):$zx.renderObjectCullingNoBoundFrustum(this,$w,$l,$n,$a),$$=0,$k=this._quenes.length;$$<$k;$$++)this._quenes[$$]&&this._quenes[$$]._preRender($I)},$x._clear=function($x,$I){var $z=$I._viewport,$k=$I.camera,$l=$z.x,$n=$k.renderTargetSize.height-$z.y-$z.height,$a=$z.width,$$=$z.height;$x.viewport($l,$n,$a,$$);var $w=256,$i=$k.renderTarget;switch($k.clearFlag){case 0:var $F=$k.clearColor;if($F){$x.enable(3089),$x.scissor($l,$n,$a,$$);var $b=$F.elements;$x.clearColor($b[0],$b[1],$b[2],$b[3]),$w|=16384}if($i)switch($F||($w=16384),$i.depthStencilFormat){case 33189:$w|=256;break;case 36168:$w|=1024;break;case 34041:$w|=256,$w|=1024}$x.clear($w),$F&&$x.disable(3089);break;case 1:case 2:if($i)switch($w=16384,$i.depthStencilFormat){case 33189:$w|=256;break;case 36168:$w|=1024;break;case 34041:$w|=256,$w|=1024}$x.clear($w);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$x._renderScene=function($x,$I){var $z,$k,$l=$I.camera,$n=0;for($n=0;$n<2;$n++)($k=this._quenes[$n])&&($l.renderTarget?$k._render($I,!0):$k._render($I,!1));if(1===$l.clearFlag){var $a=$l.sky;$a&&($U.setCullFace($x,!1),$U.setDepthFunc($x,515),$U.setDepthMask($x,!1),$a._render($I),$U.setDepthFunc($x,513),$U.setDepthMask($x,!0))}for($n=2,$z=this._quenes.length;$n<$z;$n++)($k=this._quenes[$n])&&($k._sortAlpha($I.camera.transform.position),$l.renderTarget?$k._render($I,!0):$k._render($I,!1))},$x._set3DRenderConfig=function($x){$x.disable(3042),$U._blend=!1,$x.blendFunc(770,771),$U._sFactor=770,$U._dFactor=771,$x.disable(2929),$U._depthTest=!1,$x.enable(2884),$U._cullFace=!0,$x.depthMask(1),$U._depthMask=!0,$x.frontFace(2304),$U._frontFace=2304},$x._set2DRenderConfig=function($x){$U.setBlend($x,!0),$U.setBlendFunc($x,1,771),$U.setDepthTest($x,!1),$U.setCullFace($x,!1),$U.setDepthMask($x,!0),$U.setFrontFace($x,2305),$x.viewport(0,0,$F.width,$F.height)},$x._parseCustomProps=function($x,$I,$z,$k){var $l=$k.customProps.lightmaps,$n=$l.length,$a=this._lightmaps;$a.length=$n;for(var $$=0;$$<$n;$$++)$a[$$]=$D.getRes($I[$l[$$].replace(".exr",".png")]);this.setlightmaps($a);var $w=$k.customProps.ambientColor;$w&&(this.ambientColor=new $aI($w[0],$w[1],$w[2]));var $i=$k.customProps.fogColor;$i&&(this.fogColor=new $aI($i[0],$i[1],$i[2]))},$x._addLight=function($x){this._lights.indexOf($x)<0&&this._lights.push($x)},$x._removeLight=function($x){var $I=this._lights.indexOf($x);0<=$I&&this._lights.splice($I,1)},$x._updateScene=function(){var $x=this._renderState;this._prepareUpdateToRenderState($Z.mainContext,$x),this._updateComponents($x),this._updateChilds($x),this._lateUpdateComponents($x),this._time+=$x.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$x._updateSceneConch=function(){var $x=this._renderState;this._prepareUpdateToRenderState($Z.mainContext,$x),this._updateComponents($x),this._lateUpdateComponents($x),this._prepareSceneToRender($x);for(var $I=0,$z=this._cameraPool.length;$I<$z;$I++){var $k=this._cameraPool[$I];($x.camera=$k)._prepareCameraToRender()}},$x._preRenderShadow=function($x,$I,$z,$k,$l){this.treeRoot?$zx.renderShadowObjectCullingOctree(this,$I,$z,$k,$l):$zx.renderShadowObjectCulling(this,$I,$z,$k,$l);for(var $n=0,$a=$z.length;$n<$a;$n++)$z[$n]&&$z[$n]._preRender($x)},$x._renderShadowMap=function($x,$I,$z){var $k=this.parallelSplitShadowMaps[0];$k._calcAllLightCameraInfo($z);var $l,$n,$a,$$=$k.PSSMNum;if(this._preRenderShadow($I,$k._lightCulling,$k._shadowQuenes,$k._lightVPMatrix[0],$$),this.addShaderDefine($_I.SHADERDEFINE_CAST_SHADOW),1<$$)for(var $w=0;$w<$$;$w++)$l=$k.getRenderTarget($w+1),$k.beginRenderTarget($w+1),$x.clearColor(1,1,1,1),$x.clear(16640),$x.viewport(0,0,$l.width,$l.height),$I.camera=$a=$k.getLightCamera($w),$a._prepareCameraToRender(),$a._prepareCameraViewProject($a.viewMatrix,$a.projectionMatrix),$I._projectionViewMatrix=$k._lightVPMatrix[$w+1],($n=$k._shadowQuenes[$w])._preRender($I),$n._renderShadow($I,!1),$k.endRenderTarget($w+1);else $l=$k.getRenderTarget(1),$k.beginRenderTarget(1),$x.clearColor(1,1,1,1),$x.clear(16640),$x.viewport(0,0,$l.width,$l.height),$I.camera=$a=$k.getLightCamera(0),$a._prepareCameraToRender(),$a._prepareCameraViewProject($a.viewMatrix,$a.projectionMatrix),$I._projectionViewMatrix=$k._lightVPMatrix[0],($n=$k._shadowQuenes[0])._preRender($I),$n._renderShadow($I,!0),$k.endRenderTarget(1);this.removeShaderDefine($_I.SHADERDEFINE_CAST_SHADOW)},$x.addTreeNode=function($x){this.treeRoot.addTreeNode($x)},$x.removeTreeNode=function($x){this.treeSize&&$x._treeNode&&$x._treeNode.removeObject($x)},$x.setlightmaps=function($x){this._lightmaps=$x;for(var $I=0,$z=this._renderableSprite3Ds.length;$I<$z;$I++)this._renderableSprite3Ds[$I]._render._applyLightMapParams()},$x.getlightmaps=function(){return this._lightmaps},$x.addChildAt=function($x,$I){if(!($x instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($x&&$x.__className));if(!$x||this.destroyed||$x===this)return $x;if($x.zOrder&&this._set$P("hasZorder",!0),0<=$I&&$I<=this._childs.length){if($x._parent===this){var $z=this.getChildIndex($x);this._childs.splice($z,1),this._childs.splice($I,0,$x),this.conchModel&&(this.conchModel.removeChild($x.conchModel),this.conchModel.addChildAt($x.conchModel,$I)),this._childChanged()}else $x.parent&&$x.parent.removeChild($x),this._childs===$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($I,0,$x),this.conchModel&&this.conchModel.addChildAt($x.conchModel,$I),($x.parent=this)._addChild3D($x);return $x}throw new Error("appendChildAt:The index is out of bounds")},$x.addChild=function($x){if(!($x instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$x||this.destroyed||$x===this)return $x;if($x.zOrder&&this._set$P("hasZorder",!0),$x._parent===this){var $I=this.getChildIndex($x);$I!==this._childs.length-1&&(this._childs.splice($I,1),this._childs.push($x),this.conchModel&&(this.conchModel.removeChild($x.conchModel),this.conchModel.addChildAt($x.conchModel,this._childs.length-1)),this._childChanged())}else $x.parent&&$x.parent.removeChild($x),this._childs===$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($x),this.conchModel&&this.conchModel.addChildAt($x.conchModel,this._childs.length-1),($x.parent=this)._childChanged(),this._addChild3D($x);return $x},$x.removeChildAt=function($x){var $I=this.getChildAt($x);return $I&&(this._removeChild3D($I),this._childs.splice($x,1),this.conchModel&&this.conchModel.removeChild($I.conchModel),$I.parent=null),$I},$x.removeChildren=function($x,$I){if(void 0===$x&&($x=0),void 0===$I&&($I=2147483647),this._childs&&0<this._childs.length){var $z=this._childs;if(0===$x&&$n<=$I){var $k=$z;this._childs=$i.ARRAY_EMPTY}else $k=$z.splice($x,$I-$x);for(var $l=0,$n=$k.length;$l<$n;$l++)this._removeChild3D($k[$l]),$k[$l].parent=null,this.conchModel&&this.conchModel.removeChild($k[$l].conchModel)}return this},$x.addFrustumCullingObject=function($x){this.treeRoot?this.addTreeNode($x):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($x):this._cullingRenders[this._cullingRendersLength]=$x,$x._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$x.removeFrustumCullingObject=function($x){if(this.treeRoot)this.removeTreeNode($x);else{this._cullingRendersLength--;var $I=$x._indexInSceneFrustumCullingObjects;if($I!==this._cullingRendersLength){var $z=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$I]=$z)._indexInSceneFrustumCullingObjects=$I,$x._indexInSceneFrustumCullingObjects=-1}}},$x.getRenderQueue=function($x){return $x<3e3?this._quenes[1]||(this._quenes[1]=new $p(this)):this._quenes[2]||(this._quenes[2]=new $p(this))},$x.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $p(this)},$x.addShaderDefine=function($x){this._shaderDefineValue|=$x},$x.removeShaderDefine=function($x){this._shaderDefineValue&=~$x},$x.addScript=function($x){return this._addComponent($x)},$x.getScriptByType=function($x,$I){return void 0===$I&&($I=0),this._getComponentByType($x,$I)},$x.getScriptsByType=function($x,$I){this._getComponentsByType($x,$I)},$x.getScriptByIndex=function($x){return this._getComponentByIndex($x)},$x.removeScriptByType=function($x,$I){void 0===$I&&($I=0),this._removeComponentByType($x,$I)},$x.removeScriptsByType=function($x){this._removeComponentByType($x)},$x.removeAllScript=function(){this._removeAllComponent()},$x.render=function($x,$I,$z){($s._context.ctx._renderKey=0)<this._childs.length&&$x.addRenderObject(this)},$x.renderSubmit=function(){var $x=$Z.mainContext,$I=this._renderState;this._set3DRenderConfig($x),this._prepareSceneToRender(this._renderState);var $z,$k=0,$l=0;if($DI.debugMode||$r.debugMode)for($k=0,$l=this._cameraPool.length;$k<$l;$k++)$z=this._cameraPool[$k],$DI._debugPhasorSprite.begin(1,$z),$z.activeInHierarchy&&$z._renderCamera($x,$I,this),$DI._debugPhasorSprite.end();else for($k=0,$l=this._cameraPool.length;$k<$l;$k++)($z=this._cameraPool[$k]).activeInHierarchy&&$z._renderCamera($x,$I,this);return this._set2DRenderConfig($x),1},$x.onAsynLoaded=function($x,$I,$z){var $k=$I[0];if("Scene"!==$k.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $l=$I[1];$NI._createNodeByJson(this,$k,this,$l),this.event("hierarchyloaded",[this]),this.__loaded=!0},$x.destroy=function($x){void 0===$x&&($x=!0),this.destroyed||($I.prototype.destroy.call(this,$x),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$D.clearRes(this.url),this.loaded||$DI._cancelLoadByUrl(this.url))},$x.getRenderType=function(){return 0},$x.releaseRender=function(){},$x._addComponent=function($x){var $I,$z=this._componentsMap.indexOf($x);if(-1===$z)$I=[],this._componentsMap.push($x),this._typeComponentsIndices.push($I);else if($I=this._typeComponentsIndices[$z],this._components[$I[0]].isSingleton)throw new Error("无法单实例创建"+$x+"组件，"+$x+"组件已存在！");var $k=$l.getInstance($x);$I.push(this._components.length),this._components.push($k);return $k._initialize(this),$k},$x._removeComponent=function($x,$I){var $z=this._typeComponentsIndices[$x],$k=$z[$I],$l=this._components[$k];this._components.splice($k,1),$z.splice($I,1),0===$z.length&&(this._typeComponentsIndices.splice($x,1),this._componentsMap.splice($x,1));for(var $n=0,$a=this._componentsMap.length;$n<$a;$n++)for(var $$=($z=this._typeComponentsIndices[$n]).length-1;0<=$$;$$--){var $w=$z[$$];if(!($k<$w))break;$z[$$]=--$w}$l._destroy()},$x._getComponentByType=function($x,$I){void 0===$I&&($I=0);var $z=this._componentsMap.indexOf($x);return-1===$z?null:this._components[this._typeComponentsIndices[$z][$I]]},$x._getComponentsByType=function($x,$I){var $z=this._componentsMap.indexOf($x);if(-1!==$z){var $k=this._typeComponentsIndices[$z],$l=$k.length;$I.length=$l;for(var $n=0;$n<$l;$n++)$I[$n]=this._components[$k[$n]]}else $I.length=0},$x._getComponentByIndex=function($x){return this._components[$x]},$x._removeComponentByType=function($x,$I){void 0===$I&&($I=0);var $z=this._componentsMap.indexOf($x);-1!==$z&&this._removeComponent($z,$I)},$x._removeComponentsByType=function($x){var $I=this._componentsMap.indexOf($x);if(-1!==$I)for(var $z=this._typeComponentsIndices[$I],$k=0,$l=$z.length;$k<$l;$z.length<$l?$l--:$k++)this._removeComponent($I,$k)},$x._removeAllComponent=function(){for(var $x=0,$I=this._componentsMap.length;$x<$I;this._componentsMap.length<$I?$I--:$x++)this._removeComponentsByType(this._componentsMap[$x])},$x._updateComponents=function($x){for(var $I=0,$z=this._components.length;$I<$z;$I++){var $k=this._components[$I];!$k.started&&($k._start($x),$k.started=!0),$k.enable&&$k._update($x)}},$x._lateUpdateComponents=function($x){for(var $I=0;$I<this._components.length;$I++){var $z=this._components[$I];!$z.started&&($z._start($x),$z.started=!0),$z.enable&&$z._lateUpdate($x)}},$x._preRenderUpdateComponents=function($x){for(var $I=0;$I<this._components.length;$I++){var $z=this._components[$I];!$z.started&&($z._start($x),$z.started=!0),$z.enable&&$z._preRenderUpdate($x)}},$x._postRenderUpdateComponents=function($x){for(var $I=0;$I<this._components.length;$I++){var $z=this._components[$I];!$z.started&&($z._start($x),$z.started=!0),$z.enable&&$z._postRenderUpdate($x)}},$R(0,$x,"_loaded",null,function($x){this.__loaded=$x}),$R(0,$x,"fogColor",function(){return this._fogColor},function($x){this._fogColor=$x,this._shaderValues.setValue(0,$x.elements)}),$R(0,$x,"enableFog",function(){return this._enableFog},function($x){this._enableFog!==$x&&((this._enableFog=$x)?(this.addShaderDefine($LI.SHADERDEFINE_FOG),this.removeShaderDefine($LI.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($LI.SHADERDEFINE_FOG))}),$R(0,$x,"url",function(){return this._url}),$R(0,$x,"loaded",function(){return this.__loaded}),$R(0,$x,"enableDepthFog",function(){return this._enableDepthFog},function($x){this._enableDepthFog!=$x&&((this._enableDepthFog=$x)?(this.addShaderDefine($LI.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($LI.SHADERDEFINE_FOG)):this.removeShaderDefine($LI.SAHDERDEFINE_DEPTHFOG))}),$R(0,$x,"fogStart",function(){return this._fogStart},function($x){this._fogStart=$x,this._shaderValues.setValue(1,$x)}),$R(0,$x,"fogRange",function(){return this._fogRange},function($x){this._fogRange=$x,this._shaderValues.setValue(2,$x)}),$R(0,$x,"ambientColor",function(){return this._ambientColor},function($x){this._ambientColor=$x,this._shaderValues.setValue(21,$x.elements)}),$R(0,$x,"scene",function(){return this}),$R(0,$x,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$k._sortScenes=function($x,$I){if($x.parent!==$C.stage||$I.parent!==$C.stage)return $x.parent!==$C.stage&&$I.parent!==$C.stage?$k._sortScenes($x.parent,$I.parent):$x.parent===$C.stage?-1:1;var $z=$C.stage._childs;return $z.indexOf($x)-$z.indexOf($I)},$k.load=function($x){return $C.loader.create($x,null,null,$k)},$k.FOGCOLOR=0,$k.FOGSTART=1,$k.FOGRANGE=2,$k.LIGHTDIRECTION=3,$k.LIGHTDIRCOLOR=4,$k.POINTLIGHTPOS=5,$k.POINTLIGHTRANGE=6,$k.POINTLIGHTATTENUATION=7,$k.POINTLIGHTCOLOR=8,$k.SPOTLIGHTPOS=9,$k.SPOTLIGHTDIRECTION=10,$k.SPOTLIGHTSPOT=11,$k.SPOTLIGHTRANGE=12,$k.SPOTLIGHTATTENUATION=13,$k.SPOTLIGHTCOLOR=14,$k.SHADOWDISTANCE=15,$k.SHADOWLIGHTVIEWPROJECT=16,$k.SHADOWMAPPCFOFFSET=17,$k.SHADOWMAPTEXTURE1=18,$k.SHADOWMAPTEXTURE2=19,$k.SHADOWMAPTEXTURE3=20,$k.AMBIENTCOLOR=21,$k.TIME=22,$k}($v),$tI=function($x){function $I($x){$I.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $xI,this._shaderValues=new $TI,this._colliders=[],this._id=++$I._uniqueIDCounter,this._transform=new $PI(this),this.name=$x||"Sprite3D-"+$I._nameNumberCounter++,this.layer=$d.currentCreationLayer,this.active=!0}$_($I,"laya.d3.core.Sprite3D",$OI);var $z=$I.prototype;return $C.imps($z,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$z._setUrl=function($x){this._url=$x},$z._getGroup=function(){return this._group},$z._setGroup=function($x){this._group=$x},$z._addChild3D=function($x){$x.transform.parent=this.transform,this._hierarchyAnimator&&(!$x._hierarchyAnimator&&$x._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($x,!0,[$x.name])),this._scene&&($x._setBelongScene(this._scene),this._activeInHierarchy&&$x._active&&$x._activeHierarchy())},$z._removeChild3D=function($x){$x.transform.parent=null,this._scene&&(this._activeInHierarchy&&$x._active&&$x._inActiveHierarchy(),$x._setUnBelongScene()),this._hierarchyAnimator&&($x._hierarchyAnimator==this._hierarchyAnimator&&$x._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($x,!1,[$x.name]))},$z._parseBaseCustomProps=function($x){var $I=this.transform.localPosition;$x.translate?($I.fromArray($x.translate),$I.x*=100,$I.y*=100,$I.z*=100):$I.elements.fill(0),this.transform.localPosition=$I;var $z=this.transform.localRotation;$x.rotation?$z.fromArray($x.rotation):$z.fromArray([0,0,0,-1]),this.transform.localRotation=$z;var $k=this.transform.localScale;$x.scale?$k.fromArray($x.scale):$k.elements.fill(1),this.transform.localScale=$k;var $l=$x.layer;null!=$l&&(this.layer=$d.getLayerByNumber($l))},$z._parseCustomComponent=function($x,$I,$z){for(var $k in $z){var $l=$z[$k];switch($k){case"Animator":var $n=this.addComponent(Animator);if($l.avatarPath)$n.avatar=$D.getRes($I[$l.avatarPath]);else{var $a=$l.avatar;if($a){$n.avatar=$D.getRes($I[$a.path]);var $$=$a.linkSprites;$$&&$x.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$n,$$])}}for(var $w=$l.clipPaths,$i=$w.length,$F=0;$F<$i;$F++)$n.addClip($D.getRes($I[$w[$F]]));$n.clip=$D.getRes($I[$w[0]]);var $b=$l.playOnWake;void 0!==$b&&($n.playOnWake=$b);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $T=this.addComponent(SphereCollider);$T.isTrigger=$l.isTrigger;var $_=$T.center;$_.fromArray($l.center),$T.center=$_,$T.radius=$l.radius;break;case"BoxCollider":var $R=this.addComponent(BoxCollider);$R.isTrigger=$l.isTrigger,$R.center.fromArray($l.center);var $s=$R.size;$s.fromArray($l.size),$R.size=$s;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$z._onRootNodeHierarchyLoaded=function($x,$I){for(var $z in $I){for(var $k=this,$l=$I[$z],$n=0,$a=$l.length;$n<$a;$n++){var $$=$l[$n];if(""===$$)break;if(!($k=$k.getChildByName($$)))break}$k&&$x.linkSprite3DToAvatarNode($z,$k)}},$z._setHierarchyAnimator=function($x,$I){this._changeHierarchyAnimator($x);for(var $z=0,$k=this._childs.length;$z<$k;$z++){var $l=this._childs[$z];$l._hierarchyAnimator==$I&&$l._setHierarchyAnimator($x,$I)}},$z._clearHierarchyAnimator=function($x,$I){this._changeHierarchyAnimator($I);for(var $z=0,$k=this._childs.length;$z<$k;$z++){var $l=this._childs[$z];$l._hierarchyAnimator==$x&&$l._clearHierarchyAnimator($x,$I)}},$z._getAnimatorToLinkSprite3D=function($x,$I,$z){var $k=this.getComponentByType(Animator);if($k&&($k.avatar?$k.avatar._version||$x._setAnimatorToLinkAvatar($k,$I):$x._setAnimatorToLinkSprite3DNoAvatar($k,$I,$z)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$z.unshift(this._parent.name);var $l=this._parent;$l._hierarchyAnimator&&$l._getAnimatorToLinkSprite3D($x,$I,$z)}},$z._setAnimatorToLinkSprite3DNoAvatar=function($x,$I,$z){var $k=0,$l=0;for($k=0,$l=$x.getClipCount();$k<$l;$k++)$x._handleSpriteOwnersBySprite($k,$I,$z,this);for($k=0,$l=this._childs.length;$k<$l;$k++){var $n=this._childs[$k],$a=$z.length;$z.push($n.name),$n._setAnimatorToLinkSprite3DNoAvatar($x,$I,$z),$z.splice($a,1)}},$z._changeHierarchyAnimator=function($x){this._hierarchyAnimator=$x},$z._isLinkSpriteToAnimationNode=function($x,$I,$z){var $k=$x._avatarNodes.indexOf($I),$l=$x._cacheSpriteToNodesMap;if($z)this._transform.dummy=$I.transform,$x._cacheNodesToSpriteMap[$k]=$l.length,$l.push($k);else{this._transform.dummy=null;var $n=$x._cacheNodesToSpriteMap[$k];$x._cacheNodesToSpriteMap[$k]=null,$l.splice($n,1)}},$z._setBelongScene=function($x){this._scene=$x;for(var $I=0,$z=this._childs.length;$I<$z;$I++)this._childs[$I]._setBelongScene($x)},$z._setUnBelongScene=function(){this._scene=null;for(var $x=0,$I=this._childs.length;$x<$I;$x++)this._childs[$x]._setUnBelongScene()},$z._activeHierarchy=function(){var $x=0,$I=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$x=0,$I=this._colliders.length;$x<$I;$x++)this._layer._addCollider(this._colliders[$x]);for(this.event("activeinhierarchychanged",!0),$x=0,$I=this._childs.length;$x<$I;$x++){var $z=this._childs[$x];$z._active&&$z._activeHierarchy()}},$z._inActiveHierarchy=function(){var $x=0,$I=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$x=0,$I=this._colliders.length;$x<$I;$x++){var $z=this._colliders[$x];$z._clearCollsionMap(),this._layer._removeCollider($z)}for(this.event("activeinhierarchychanged",!1),$x=0,$I=this._childs.length;$x<$I;$x++){var $k=this._childs[$x];$k._active&&$k._inActiveHierarchy()}},$z.addComponent=function($x){var $I,$z=this._componentsMap.indexOf($x);if(-1===$z)$I=[],this._componentsMap.push($x),this._typeComponentsIndices.push($I);else if($I=this._typeComponentsIndices[$z],this._components[$I[0]].isSingleton)throw new Error("无法单实例创建"+$x+"组件，"+$x+"组件已存在！");var $k=$l.getInstance($x);return $I.push(this._components.length),this._components.push($k),$k instanceof laya.d3.component.Script&&this._scripts.push($k),$k._initialize(this),$k},$z._removeComponent=function($x,$I){var $z,$k=0,$l=this._typeComponentsIndices[$x],$n=$l[$I],$a=this._components[$n];for($a instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($a),1),$l.splice($I,1),0===$l.length&&(this._typeComponentsIndices.splice($x,1),this._componentsMap.splice($x,1)),$k=0,$z=this._componentsMap.length;$k<$z;$k++)for(var $$=($l=this._typeComponentsIndices[$k]).length-1;0<=$$;$$--){var $w=$l[$$];if(!($n<$w))break;$l[$$]=--$w}$a._destroy()},$z._clearSelfRenderObjects=function(){},$z._addSelfRenderObjects=function(){},$z._parseCustomProps=function($x,$I,$z,$k){},$z._updateChilds=function($x){var $I=this._childs.length;if(0!==$I)for(var $z=0;$z<$I;++$z)this._childs[$z]._update($x)},$z._getSortID=function($x,$I){return 1e3*$I.id+$x._getVertexBuffer().vertexDeclaration.id},$z._update=function($x){($x.owner=this)._activeInHierarchy&&(this._updateComponents($x),this._lateUpdateComponents($x),$L.spriteCount++,this._childs.length&&this._updateChilds($x))},$z.getProjectionViewWorldMatrix=function($x){return $xI.multiply($x,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$z.loadHierarchy=function($x){this.addChild(laya.d3.core.Sprite3D.load($x))},$z.addChildAt=function($x,$I){if(!($x instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$x||this.destroyed||$x===this)return $x;if($x.zOrder&&this._set$P("hasZorder",!0),0<=$I&&$I<=this._childs.length){if($x._parent===this){var $z=this.getChildIndex($x);this._childs.splice($z,1),this._childs.splice($I,0,$x),this.conchModel&&(this.conchModel.removeChild($x.conchModel),this.conchModel.addChildAt($x.conchModel,$I)),this._childChanged()}else $x.parent&&$x.parent.removeChild($x),this._childs===$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($I,0,$x),this.conchModel&&this.conchModel.addChildAt($x.conchModel,$I),($x.parent=this)._addChild3D($x);return $x}throw new Error("appendChildAt:The index is out of bounds")},$z.addChild=function($x){if(!($x instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$x||this.destroyed||$x===this)return $x;if($x.zOrder&&this._set$P("hasZorder",!0),$x._parent===this){var $I=this.getChildIndex($x);$I!==this._childs.length-1&&(this._childs.splice($I,1),this._childs.push($x),this.conchModel&&(this.conchModel.removeChild($x.conchModel),this.conchModel.addChildAt($x.conchModel,this._childs.length-1)),this._childChanged())}else $x.parent&&$x.parent.removeChild($x),this._childs===$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($x),this.conchModel&&this.conchModel.addChildAt($x.conchModel,this._childs.length-1),($x.parent=this)._childChanged(),this._addChild3D($x);return $x},$z.removeChildAt=function($x){var $I=this.getChildAt($x);return $I&&(this._removeChild3D($I),this._childs.splice($x,1),this.conchModel&&this.conchModel.removeChild($I.conchModel),$I.parent=null),$I},$z.removeChildren=function($x,$I){if(void 0===$x&&($x=0),void 0===$I&&($I=2147483647),this._childs&&0<this._childs.length){var $z=this._childs;if(0===$x&&$n<=$I){var $k=$z;this._childs=$i.ARRAY_EMPTY}else $k=$z.splice($x,$I-$x);for(var $l=0,$n=$k.length;$l<$n;$l++)this._removeChild3D($k[$l]),$k[$l].parent=null,this.conchModel&&this.conchModel.removeChild($k[$l].conchModel)}return this},$z.onAsynLoaded=function($x,$I,$z){var $k=$I[0];if("Sprite3D"!==$k.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $l=$I[1];$NI._createNodeByJson(this,$k,this,$l),this.event("hierarchyloaded",[this]),this.__loaded=!0},$z.cloneTo=function($x){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $I=$x;$I.name=this.name,$I._destroyed=this._destroyed,$I.timer=this.timer,$I._$P=this._$P,$I.active=this._active;var $z=$I.transform.localPosition;this.transform.localPosition.cloneTo($z),$I.transform.localPosition=$z;var $k=$I.transform.localRotation;this.transform.localRotation.cloneTo($k),$I.transform.localRotation=$k;var $l=$I.transform.localScale;this.transform.localScale.cloneTo($l),$I.transform.localScale=$l,$I.isStatic=this.isStatic;var $n=0,$a=0;for($n=0,$a=this._componentsMap.length;$n<$a;$n++){var $$=$I.addComponent(this._componentsMap[$n]);this._components[$n]._cloneTo($$)}for($n=0,$a=this._childs.length;$n<$a;$n++)$I.addChild(this._childs[$n].clone());var $w=$I.getComponentByType(Animator);if($w){var $i=$w._linkSpritesData;if($i)for(var $F in $i){for(var $b=$i[$F],$T=$I,$_=0,$R=$b.length;$_<$R&&($T=$T.getChildByName($b[$_]));$_++);if($T){var $s=$w._avatarNodeMap[$F];$T._isLinkSpriteToAnimationNode($w,$s,!0)}}}},$z.clone=function(){var $x=new this.constructor;return this.cloneTo($x),$x},$z.destroy=function($x){if(void 0===$x&&($x=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$x);var $I,$z=0;for($z=0,$I=this._components.length;$z<$I;$z++)this._components[$z]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$D.clearRes(this.url),this.loaded||$DI._cancelLoadByUrl(this.url)}},$z._handleSpriteToAvatar=function($x,$I){$x._avatarNodes;var $z=$x._avatarNodeMap[this.name];$z&&$z.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($x,$z,$I)},$z._setAnimatorToLinkAvatar=function($x,$I){this._handleSpriteToAvatar($x,$I);for(var $z=0,$k=this._childs.length;$z<$k;$z++){this._childs[$z]._setAnimatorToLinkAvatar($x,$I)}},$R(0,$z,"activeInHierarchy",function(){return this._activeInHierarchy}),$R(0,$z,"_loaded",null,function($x){this.__loaded=$x}),$R(0,$z,"active",function(){return this._active},function($x){this._active!==$x&&(this._active=$x,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($x?this._activeHierarchy():this._inActiveHierarchy()))}),$R(0,$z,"componentsCount",function(){return this._components.length}),$R(0,$z,"loaded",function(){return this.__loaded}),$R(0,$z,"id",function(){return this._id}),$R(0,$z,"url",function(){return this._url}),$R(0,$z,"layer",function(){return this._layer},function($x){if(this._layer!==$x){if(!$x)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $I=0,$z=this._colliders.length;if(this._layer)for($I=0;$I<$z;$I++)this._layer._removeCollider(this._colliders[$I]);for($I=0;$I<$z;$I++)$x._addCollider(this._colliders[$I])}this._layer=$x,this.event("layerchanged",$x)}}),$R(0,$z,"scene",function(){return this._scene}),$R(0,$z,"transform",function(){return this._transform}),$I.instantiate=function($x,$I,$z,$k,$l){void 0===$z&&($z=!0);var $n=$x.clone();$I&&$I.addChild($n);var $a=$n.transform;if($z){var $$=$a.worldMatrix;$x.transform.worldMatrix.cloneTo($$),$a.worldMatrix=$$}else $k&&($a.position=$k),$l&&($a.rotation=$l);return $n},$I.load=function($x){return $C.loader.create($x,null,null,$I)},$I.WORLDMATRIX=0,$I.MVPMATRIX=1,$I._uniqueIDCounter=0,$I._nameNumberCounter=0,$I}(),$YI=function($x){function $F($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$F.__super.call(this),!$x||!$I)throw"Shader Error";this._id=++$F._count,this._vs=$x,this._ps=$I,this._attributeMap=$z,this._sceneUniformMap=$k,this._cameraUniformMap=$l,this._spriteUniformMap=$n,this._materialUniformMap=$a,this._renderElementUniformMap=$$,this._precompile=$w,this._define=$i,this._precompile&&$F.extCompileObj&&$F.extCompileFunc?$F.extCompileFunc.call($F.extCompileObj,$x,$I,$i):this.recreateResource()}$_($F,"laya.d3.shader.Shader3D",$z);var $I=$F.prototype;return $I.recreateResource=function(){$X.now();this._compile(),this.completeCreate(),this.memorySize=0},$I.disposeResource=function(){$Z.mainContext.deleteShader(this._vshader),$Z.mainContext.deleteShader(this._pshader),$Z.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$I._compile=function(){if(!$Z.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $x=[this._vs,this._ps],$I=$Z.mainContext;if(this._program=$I.createProgram(),this._vshader=$F._createShader($I,$x[0],35633),this._pshader=$F._createShader($I,$x[1],35632),$I.attachShader(this._program,this._vshader),$I.attachShader(this._program,this._pshader),$I.linkProgram(this._program),!$s.isConchApp&&$LI.debugMode&&!$I.getProgramParameter(this._program,35714))throw $I.getProgramInfoLog(this._program);var $z,$k=0,$l=0,$n=0;for($n=$s.isConchApp?$I.getProgramParameterEx(this._vs,this._ps,"",35721):$I.getProgramParameter(this._program,35721),$k=0;$k<$n;$k++){var $a=null;$z={vartype:"attribute",ivartype:0,attrib:$a=$s.isConchApp?$I.getActiveAttribEx(this._vs,this._ps,"",$k):$I.getActiveAttrib(this._program,$k),location:$I.getAttribLocation(this._program,$a.name),name:$a.name,type:$a.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($z)}var $$=0;for($$=$s.isConchApp?$I.getProgramParameterEx(this._vs,this._ps,"",35718):$I.getProgramParameter(this._program,35718),$k=0;$k<$$;$k++){var $w=null;$w=$s.isConchApp?$I.getActiveUniformEx(this._vs,this._ps,"",$k):$I.getActiveUniform(this._program,$k),0<($z={vartype:"uniform",ivartype:1,attrib:$a,location:$I.getUniformLocation(this._program,$w.name),name:$w.name,type:$w.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($z.name=$z.name.substr(0,$z.name.length-3),$z.isArray=!0,$z.location=$I.getUniformLocation(this._program,$z.name)),this._uniformParams.push($z)}for($k=0,$l=this._attributeParams.length;$k<$l;$k++)($z=this._attributeParams[$k]).indexOfParams=$k,$z.index=1,$z.value=[$z.location,null],$z.codename=$z.name,$z.name=null!=this._attributeMap[$z.codename]?this._attributeMap[$z.codename]:$z.codename,this._attributeParamsMap.push($z.name),this._attributeParamsMap.push($z),$z._this=this,$z.uploadedValue=[],$z.fun=this._attribute;for($k=0,$l=this._uniformParams.length;$k<$l;$k++)switch(($z=this._uniformParams[$k]).indexOfParams=$k,$z.index=1,$z.value=[$z.location,null],$z.codename=$z.name,null!=this._sceneUniformMap[$z.codename]?($z.name=this._sceneUniformMap[$z.codename],this._sceneUniformParamsMap.push($z.name),this._sceneUniformParamsMap.push($z)):null!=this._cameraUniformMap[$z.codename]?($z.name=this._cameraUniformMap[$z.codename],this._cameraUniformParamsMap.push($z.name),this._cameraUniformParamsMap.push($z)):null!=this._spriteUniformMap[$z.codename]?($z.name=this._spriteUniformMap[$z.codename],this._spriteUniformParamsMap.push($z.name),this._spriteUniformParamsMap.push($z)):null!=this._materialUniformMap[$z.codename]?($z.name=this._materialUniformMap[$z.codename],this._materialUniformParamsMap.push($z.name),this._materialUniformParamsMap.push($z)):null!=this._renderElementUniformMap[$z.codename]?($z.name=this._renderElementUniformMap[$z.codename],this._renderElementUniformParamsMap.push($z.name),this._renderElementUniformParamsMap.push($z)):console.log("Shader:can't find uinform name:"+$z.codename+" in shader file."),$z._this=this,$z.uploadedValue=[],$z.type){case 5124:$z.fun=$z.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$z.fun=$z.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$z.fun=$z.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$z.fun=$z.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$z.fun=$z.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$z.fun=this._uniform_sampler2D;break;case 35680:$z.fun=this._uniform_samplerCube;break;case 35676:$z.fun=this._uniformMatrix4fv;break;case 35670:$z.fun=this._uniform1i;break;case 35674:$z.fun=this._uinformMatrix2fv;break;case 35675:$z.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$I._attribute=function($x,$I){var $z=$Z.mainContext,$k=$$._enableAtributes,$l=$x.location;return $k[$l]||$z.enableVertexAttribArray($l),$z.vertexAttribPointer($l,$I[0],$I[1],$I[2],$I[3],$I[4]),$k[$l]=$$._bindVertexBuffer,1},$I._uniform1f=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I?($Z.mainContext.uniform1f($x.location,$z[0]=$I),1):0},$I._uniform1fv=function($x,$I){if($I.length<4){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($Z.mainContext.uniform1fv($x.location,$I),$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3],1):0}return $Z.mainContext.uniform1fv($x.location,$I),1},$I._uniform_vec2=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]?($Z.mainContext.uniform2f($x.location,$z[0]=$I[0],$z[1]=$I[1]),1):0},$I._uniform_vec2v=function($x,$I){if($I.length<2){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($Z.mainContext.uniform2fv($x.location,$I),$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3],1):0}return $Z.mainContext.uniform2fv($x.location,$I),1},$I._uniform_vec3=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]?($Z.mainContext.uniform3f($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2]),1):0},$I._uniform_vec3v=function($x,$I){return $Z.mainContext.uniform3fv($x.location,$I),1},$I._uniform_vec4=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($Z.mainContext.uniform4f($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3]),1):0},$I._uniform_vec4v=function($x,$I){return $Z.mainContext.uniform4fv($x.location,$I),1},$I._uniformMatrix2fv=function($x,$I){return $Z.mainContext.uniformMatrix2fv($x.location,!1,$I),1},$I._uniformMatrix3fv=function($x,$I){return $Z.mainContext.uniformMatrix3fv($x.location,!1,$I),1},$I._uniformMatrix4fv=function($x,$I){return $Z.mainContext.uniformMatrix4fv($x.location,!1,$I),1},$I._uinformMatrix2fv=function($x,$I){return $Z.mainContext.uniformMatrix2fv($x.location,!1,$I),1},$I._uinformMatrix3fv=function($x,$I){return $Z.mainContext.uniformMatrix3fv($x.location,!1,$I),1},$I._uniform1i=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I?($Z.mainContext.uniform1i($x.location,$z[0]=$I),1):0},$I._uniform1iv=function($x,$I){return $Z.mainContext.uniform1iv($x.location,$I),1},$I._uniform_ivec2=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]?($Z.mainContext.uniform2i($x.location,$z[0]=$I[0],$z[1]=$I[1]),1):0},$I._uniform_ivec2v=function($x,$I){return $Z.mainContext.uniform2iv($x.location,$I),1},$I._uniform_vec3i=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]?($Z.mainContext.uniform3i($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2]),1):0},$I._uniform_vec3vi=function($x,$I){return $Z.mainContext.uniform3iv($x.location,$I),1},$I._uniform_vec4i=function($x,$I){var $z=$x.uploadedValue;return $z[0]!==$I[0]||$z[1]!==$I[1]||$z[2]!==$I[2]||$z[3]!==$I[3]?($Z.mainContext.uniform4i($x.location,$z[0]=$I[0],$z[1]=$I[1],$z[2]=$I[2],$z[3]=$I[3]),1):0},$I._uniform_vec4vi=function($x,$I){return $Z.mainContext.uniform4iv($x.location,$I),1},$I._uniform_sampler2D=function($x,$I){var $z=$I.source||$I.defaulteTexture.source,$k=$Z.mainContext,$l=$x.uploadedValue;if(null!=$l[0])return $k.activeTexture($F._TEXTURES[$l[0]]),$z&&$U.bindTexture($k,3553,$z),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $l[0]=this._curActTexIndex,$k.uniform1i($x.location,this._curActTexIndex),$k.activeTexture($F._TEXTURES[this._curActTexIndex]),$z&&$U.bindTexture($k,3553,$z),this._curActTexIndex++,1},$I._uniform_samplerCube=function($x,$I){var $z=$I.source||$I.defaulteTexture.source,$k=$Z.mainContext,$l=$x.uploadedValue;if(null!=$l[0])return $k.activeTexture($F._TEXTURES[$l[0]]),$z?$U.bindTexture($k,34067,$z):$U.bindTexture($k,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $l[0]=this._curActTexIndex,$k.uniform1i($x.location,this._curActTexIndex),$k.activeTexture($F._TEXTURES[this._curActTexIndex]),$z?$U.bindTexture($k,34067,$z):$U.bindTexture($k,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$I._noSetValue=function($x){console.log("no....:"+$x.name)},$I.bind=function(){return $z.activeShader=this,($z.bindShader=this).activeResource(),$U.UseProgram(this._program)},$I.uploadAttributes=function($x,$I){for(var $z,$k,$l=0,$n=0,$a=this._attributeParamsMap.length;$n<$a;$n+=2)$k=this._attributeParamsMap[$n+1],null!=($z=$x[this._attributeParamsMap[$n]])&&($I&&$I[$k.name]&&$I[$k.name].bind(),$l+=$k.fun.call(this,$k,$z));$L.shaderCall+=$l},$I.uploadAttributesX=function($x,$I){for(var $z,$k,$l=0,$n=0,$a=this._attributeParamsMap.length;$n<$a;$n+=2)$k=this._attributeParamsMap[$n+1],null!=($z=$x[this._attributeParamsMap[$n]])&&($I._bind(),$l+=$k.fun.call(this,$k,$z));$L.shaderCall+=$l},$I.uploadSceneUniforms=function($x){for(var $I,$z,$k=0,$l=0,$n=this._sceneUniformParamsMap.length;$l<$n;$l+=2)$z=this._sceneUniformParamsMap[$l+1],null!=($I=$x[this._sceneUniformParamsMap[$l]])&&($k+=$z.fun.call(this,$z,$I));$L.shaderCall+=$k},$I.uploadCameraUniforms=function($x){for(var $I,$z,$k=0,$l=0,$n=this._cameraUniformParamsMap.length;$l<$n;$l+=2)$z=this._cameraUniformParamsMap[$l+1],null!=($I=$x[this._cameraUniformParamsMap[$l]])&&($k+=$z.fun.call(this,$z,$I));$L.shaderCall+=$k},$I.uploadSpriteUniforms=function($x){for(var $I,$z,$k=0,$l=0,$n=this._spriteUniformParamsMap.length;$l<$n;$l+=2)$z=this._spriteUniformParamsMap[$l+1],null!=($I=$x[this._spriteUniformParamsMap[$l]])&&($k+=$z.fun.call(this,$z,$I));$L.shaderCall+=$k},$I.uploadMaterialUniforms=function($x){for(var $I,$z,$k=0,$l=0,$n=this._materialUniformParamsMap.length;$l<$n;$l+=2)$z=this._materialUniformParamsMap[$l+1],null!=($I=$x[this._materialUniformParamsMap[$l]])&&($k+=$z.fun.call(this,$z,$I));$L.shaderCall+=$k},$I.uploadRenderElementUniforms=function($x){for(var $I,$z,$k=0,$l=0,$n=this._renderElementUniformParamsMap.length;$l<$n;$l+=2)$z=this._renderElementUniformParamsMap[$l+1],null!=($I=$x[this._renderElementUniformParamsMap[$l]])&&($k+=$z.fun.call(this,$z,$I));$L.shaderCall+=$k},$F.create=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){return new $F($x,$I,$z,$k,$l,$n,$a,$$,$w,$i)},$F.addInclude=function($x,$I){$m.addInclude($x,$I)},$F._createShader=function($x,$I,$z){var $k=$x.createShader($z);if($x.shaderSource($k,$I),$x.compileShader($k),$LI.debugMode&&!$x.getShaderParameter($k,35713))throw $x.getShaderInfoLog($k);return $k},$F.PERIOD_RENDERELEMENT=0,$F.PERIOD_MATERIAL=1,$F.PERIOD_SPRITE=2,$F.PERIOD_CAMERA=3,$F.PERIOD_SCENE=4,$F._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$F._count=0,$F._preCompile=!1,$F.extCompileFunc=null,$F.extCompileObj=null,$b($F,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $K}]),$F}(),$cI=function($$){function $w(){this._transformUV=null,$w.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $aI(.6,.6,.6)),this._setColor(10,new $aI(1,1,1)),this._setColor(11,new $$I(1,1,1,8)),this._setColor(12,new $aI(1,1,1)),this._setColor(7,new $$I(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $$I(1,1,0,0)),this.renderMode=1}$_($w,"laya.d3.core.material.StandardMaterial",$$);var $x=$w.prototype;return $x.disableLight=function(){this._addDisablePublicShaderDefine($LI.SHADERDEFINE_POINTLIGHT|$LI.SHADERDEFINE_SPOTLIGHT|$LI.SHADERDEFINE_DIRECTIONLIGHT)},$x.disableFog=function(){this._addDisablePublicShaderDefine($LI.SHADERDEFINE_FOG)},$x.onAsynLoaded=function($x,$I,$z){var $k=$I[0];if($k.version)$$.prototype.onAsynLoaded.call(this,$x,$I,$z);else{var $l=$I[1],$n=$k.props;for(var $a in $n)this[$a]=$n[$a];$w._parseStandardMaterial($l,this,$k),this._endLoaded()}},$x.cloneTo=function($x){$$.prototype.cloneTo.call(this,$x);var $I=$x;this._transformUV&&($I._transformUV=this._transformUV.clone())},$R(0,$x,"ambientColor",function(){return this._getColor(9)},function($x){this._setColor(9,$x)}),$R(0,$x,"ambientTexture",function(){return this._getTexture(5)},function($x){$x?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$x)}),$R(0,$x,"renderMode",null,function($x){switch($x){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($w.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($x)}),$R(0,$x,"reflectColor",function(){return this._getColor(12)},function($x){this._setColor(12,$x)}),$R(0,$x,"tilingOffset",function(){return this._getColor(15)},function($x){if($x){var $I=$x.elements;1!=$I[0]||1!=$I[1]||0!=$I[2]||0!=$I[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$x)}),$R(0,$x,"albedo",function(){return this._getColor(7)},function($x){this._setColor(7,$x)}),$R(0,$x,"diffuseColor",function(){return this._getColor(10)},function($x){this._setColor(10,$x)}),$R(0,$x,"albedoColor",function(){return this._getColor(7)},function($x){this._setColor(7,$x)}),$R(0,$x,"specularColor",function(){return this._getColor(11)},function($x){this._setColor(11,$x)}),$R(0,$x,"diffuseTexture",function(){return this._getTexture(1)},function($x){$x?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$x)}),$R(0,$x,"normalTexture",function(){return this._getTexture(2)},function($x){$x?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$x)}),$R(0,$x,"specularTexture",function(){return this._getTexture(3)},function($x){$x?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$x)}),$R(0,$x,"emissiveTexture",function(){return this._getTexture(4)},function($x){$x?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$x)}),$R(0,$x,"reflectTexture",function(){return this._getTexture(6)},function($x){$x?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$x)}),$R(0,$x,"transformUV",function(){return this._transformUV},function($x){this._transformUV=$x,this._setMatrix4x4(13,$x.matrix),$x?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$x.matrix.elements,0)}),$w.__init__=function(){$w.SHADERDEFINE_DIFFUSEMAP=$w.shaderDefines.registerDefine("DIFFUSEMAP"),$w.SHADERDEFINE_NORMALMAP=$w.shaderDefines.registerDefine("NORMALMAP"),$w.SHADERDEFINE_SPECULARMAP=$w.shaderDefines.registerDefine("SPECULARMAP"),$w.SHADERDEFINE_EMISSIVEMAP=$w.shaderDefines.registerDefine("EMISSIVEMAP"),$w.SHADERDEFINE_AMBIENTMAP=$w.shaderDefines.registerDefine("AMBIENTMAP"),$w.SHADERDEFINE_REFLECTMAP=$w.shaderDefines.registerDefine("REFLECTMAP"),$w.SHADERDEFINE_UVTRANSFORM=$w.shaderDefines.registerDefine("UVTRANSFORM"),$w.SHADERDEFINE_TILINGOFFSET=$w.shaderDefines.registerDefine("TILINGOFFSET"),$w.SHADERDEFINE_ADDTIVEFOG=$w.shaderDefines.registerDefine("ADDTIVEFOG")},$w.load=function($x){return $C.loader.create($x,null,null,$w)},$w._parseStandardMaterial=function($x,$I,$z){var $k=$z.customProps,$l=$k.ambientColor;$I.ambientColor=new $aI($l[0],$l[1],$l[2]);var $n=$k.diffuseColor;$I.diffuseColor=new $aI($n[0],$n[1],$n[2]);var $a=$k.specularColor;$I.specularColor=new $$I($a[0],$a[1],$a[2],$a[3]);var $$=$k.reflectColor;$I.reflectColor=new $aI($$[0],$$[1],$$[2]);var $w=$k.albedoColor;$w&&($I.albedo=new $$I($w[0],$w[1],$w[2],$w[3]));var $i=$k.diffuseTexture.texture2D;$i&&($I.diffuseTexture=$D.getRes($x[$i]));var $F=$k.normalTexture.texture2D;$F&&($I.normalTexture=$D.getRes($x[$F]));var $b=$k.specularTexture.texture2D;$b&&($I.specularTexture=$D.getRes($x[$b]));var $T=$k.emissiveTexture.texture2D;$T&&($I.emissiveTexture=$D.getRes($x[$T]));var $_=$k.ambientTexture.texture2D;$_&&($I.ambientTexture=$D.getRes($x[$_]));var $R=$k.reflectTexture.texture2D;$R&&($I.reflectTexture=$D.getRes($x[$R]))},$w.RENDERMODE_OPAQUE=1,$w.RENDERMODE_OPAQUEDOUBLEFACE=2,$w.RENDERMODE_CUTOUT=3,$w.RENDERMODE_CUTOUTDOUBLEFACE=4,$w.RENDERMODE_TRANSPARENT=13,$w.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$w.RENDERMODE_ADDTIVE=15,$w.RENDERMODE_ADDTIVEDOUBLEFACE=16,$w.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$w.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$w.RENDERMODE_DEPTHREAD_ADDTIVE=7,$w.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$w.RENDERMODE_NONDEPTH_TRANSPARENT=9,$w.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$w.RENDERMODE_NONDEPTH_ADDTIVE=11,$w.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$w.SHADERDEFINE_DIFFUSEMAP=0,$w.SHADERDEFINE_NORMALMAP=0,$w.SHADERDEFINE_SPECULARMAP=0,$w.SHADERDEFINE_EMISSIVEMAP=0,$w.SHADERDEFINE_AMBIENTMAP=0,$w.SHADERDEFINE_REFLECTMAP=0,$w.SHADERDEFINE_UVTRANSFORM=0,$w.SHADERDEFINE_TILINGOFFSET=0,$w.SHADERDEFINE_ADDTIVEFOG=0,$w.DIFFUSETEXTURE=1,$w.NORMALTEXTURE=2,$w.SPECULARTEXTURE=3,$w.EMISSIVETEXTURE=4,$w.AMBIENTTEXTURE=5,$w.REFLECTTEXTURE=6,$w.ALBEDO=7,$w.UVANIAGE=8,$w.MATERIALAMBIENT=9,$w.MATERIALDIFFUSE=10,$w.MATERIALSPECULAR=11,$w.MATERIALREFLECT=12,$w.UVMATRIX=13,$w.UVAGE=14,$w.TILINGOFFSET=15,$b($w,["defaultMaterial",function(){var $x=new $w;return $x.lock=!0,this.defaultMaterial=$x},"shaderDefines",function(){return this.shaderDefines=new $FI($SI.shaderDefines)}]),$w}($SI),$VI=function($x){function $a($x,$I,$z,$k,$l){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$z&&($z=35044),void 0===$k&&($k=!1),$a.__super.call(this),this._indexType=$x,this._indexCount=$I,this._bufferUsage=$z,this._bufferType=34963,this._canRead=$k;var $n;if("ushort"==$x)this._indexTypeByteCount=2;else{if("ubyte"!=$x)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$n=this._indexTypeByteCount*$I,this._byteLength=$n,this._bind(),$$._gl.bufferData(this._bufferType,$n,this._bufferUsage),this.uri=$l,$k?("ushort"==$x?this._buffer=new Uint16Array($I):"ubyte"==$x&&(this._buffer=new Uint8Array($I)),this.memorySize=2*$n):this.memorySize=$n}$_($a,"laya.d3.graphics.IndexBuffer3D",$x);var $I=$a.prototype;return $I.setData=function($x,$I,$z,$k){void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=4294967295);var $l=0;if("ushort"==this._indexType?($l=2,0===$z&&4294967295===$k||($x=new Uint16Array($x.buffer,$z*$l,$k))):"ubyte"==this._indexType&&($l=1,0===$z&&4294967295===$k||($x=new Uint8Array($x.buffer,$z*$l,$k))),this._bind(),$$._gl.bufferSubData(this._bufferType,$I*$l,$x),this._canRead)if(0!==$I||0!==$z||4294967295!==$k){var $n=this._buffer.length-$I;$n<$k&&($k=$n);for(var $a=0;$a<$k;$a++)this._buffer[$I+$a]=$x[$a]}else this._buffer=$x},$I.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$I.disposeResource=function(){$x.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$R(0,$I,"indexType",function(){return this._indexType}),$R(0,$I,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$R(0,$I,"indexCount",function(){return this._indexCount}),$R(0,$I,"canRead",function(){return this._canRead}),$a.INDEXTYPE_UBYTE="ubyte",$a.INDEXTYPE_USHORT="ushort",$a.create=function($x,$I,$z,$k,$l){return void 0===$z&&($z=35044),void 0===$k&&($k=!1),new $a($x,$I,$z,$k,$l)},$a}($$),$WI=function($n){function $a($x,$I,$z,$k,$l){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$k&&($k=!1),$a.__super.call(this),this._vertexDeclaration=$x,this._vertexCount=$I,this._bufferUsage=$z,this._bufferType=34962,this._canRead=$k,this.uri=$l,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$I,this._bind(),$$._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$k&&(this._buffer=new Float32Array(this._byteLength/4))}$_($a,"laya.d3.graphics.VertexBuffer3D",$n);var $x=$a.prototype;return $x.bindWithIndexBuffer=function($x){$x&&$x._bind(),this._bind()},$x.setData=function($x,$I,$z,$k){if(void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=4294967295),0===$z&&4294967295===$k||($x=new Float32Array($x.buffer,4*$z,$k)),this._bind(),$$._gl.bufferSubData(this._bufferType,4*$I,$x),this._canRead)if(0!==$I||0!==$z||4294967295!==$k){var $l=this._buffer.length-$I;$l<$k&&($k=$l);for(var $n=0;$n<$k;$n++)this._buffer[$I+$n]=$x[$n]}else this._buffer=$x},$x.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$x.disposeResource=function(){for(var $x=$Z.mainContext,$I=this._vertexDeclaration.getVertexElements(),$z=$$._enableAtributes,$k=0,$l=$I.length;$k<$l;$k++)$z[$k]===this._glBuffer&&($x.disableVertexAttribArray($k),$z[$k]=null);$n.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$R(0,$x,"vertexDeclaration",function(){return this._vertexDeclaration}),$R(0,$x,"vertexCount",function(){return this._vertexCount}),$R(0,$x,"canRead",function(){return this._canRead}),$a.create=function($x,$I,$z,$k,$l){return void 0===$z&&($z=35044),void 0===$k&&($k=!1),new $a($x,$I,$z,$k,$l)},$a}($$),$qI=function($x){function $m(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$m.__super.call(this),this._type=3553}$_($m,"laya.d3.resource.DataTexture2D",$ZI);var $I=$m.prototype;return $I.genDebugMipmaps=function(){var $x=[];return $x.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$x.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$x.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$x.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$x.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$x.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$x.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$x.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$x.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$x.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$x},$I._onTextureLoaded=function($x){},$I._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $x=$Z.mainContext,$I=this._source=$x.createTexture(),$z=this._width,$k=this._height,$l=$U.curBindTexTarget,$n=$U.curBindTexValue,$a=!1;if($U.bindTexture($x,this._type,$I),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $$=0;$x.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $w=0;$w<this._mipmaps.length;$w++){if(this._mipmaps[$w].byteLength!=$i*$F*4)throw"mipmap size error  level:"+$w;$x.texSubImage2D(this._type,0,$m.simLodRect[$$++],$m.simLodRect[$$++],$m.simLodRect[$$++],$m.simLodRect[$$++],6408,5121,new Uint8Array(this._mipmaps[$w]))}this.minFifter=9729,this.magFifter=9729}else{var $i=this._width,$F=this._height;for($$=0,$x.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$w=0;$w<this._mipmaps.length;$w++){if(this._mipmaps[$w].byteLength!=$i*$F*4)throw"mipmap size error  level:"+$w;$x.texImage2D(this._type,$w,6408,$i,$F,0,6408,5121,new Uint8Array(this._mipmaps[$w])),($i/=2)<1&&($i=1),($F/=2)<1&&($F=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$x.pixelStorei($x.UNPACK_ALIGNMENT,1),$x.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $b=0,$T=!1,$_=!1;this._buffer.byteLength==4*$z*$k?($b=6408,$T=!0):this._buffer.byteLength==3*$z*$k?($b=6407,$_=!0):$b=this._format,$T||$_?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$_&&$x.pixelStorei($x.UNPACK_ALIGNMENT,1),$x.texImage2D(this._type,0,$b,$z,$k,0,$b,5121,this._buffer)):$x&&$b==$x.ALPHA?($x.texImage2D(3553,0,$b,$z,$k,0,$b,$x.UNSIGNED_BYTE,this._buffer),$a=!0):0!=$b&&($x.compressedTexImage2D(3553,0,$b,$z,$k,0,this._buffer),$a=!0)}var $R=this._minFifter,$s=this._magFifter,$N=0==this._wrapModeU?10497:33071,$D=0==this._wrapModeV?10497:33071,$f=$y.isPOT($z,$k);$f?(this._mipmap||this._mipmaps?-1!==$R||($R=9987):-1!==$R||($R=9729),-1!==$s||($s=9729),$x.texParameteri(this._type,10241,$R),$x.texParameteri(this._type,10240,$s),$x.texParameteri(this._type,10242,$N),$x.texParameteri(this._type,10243,$D),this._mipmap&&$x.generateMipmap(this._type)):(-1!==$R||($R=9729),-1!==$s||($s=9729),$x.texParameteri(this._type,10241,$R),$x.texParameteri(this._type,10240,$s),$x.texParameteri(this._type,10242,33071),$x.texParameteri(this._type,10243,33071)),$l&&$n&&$U.bindTexture($x,$l,$n),this.memorySize=$a?this._buffer.length:$f?$z*$k*4*(1+1/3):$z*$k*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$I.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$I.onAsynLoaded=function($x,$I,$z){var $k;$z&&($k=$z[0].call(this,$I)),$k&&(this._width=$k.width,this._height=$k.height,this._buffer=$k.data),this._src=$x,this._size=new $sI(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$I.getPixels=function(){return new Uint8Array(this._buffer)},$I.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($Z.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$R(0,$I,"src",function(){return this._src}),$m.create=function($x,$I,$z,$k,$l,$n,$a){if(void 0===$k&&($k=9729),void 0===$l&&($l=9729),void 0===$n&&($n=!0),!$x||$x.byteLength<$I*$z*4)throw"DataTexture2D create error";var $$=new $m;return $$.uri=$a,$$._buffer=$x,$$._width=$I,$$._height=$z,$$._mipmap=$n,$$._magFifter=$k,$$._minFifter=$l,$$._size=new $sI($$._width,$$._height),$$._conchTexture?alert("怎么给runtime传递datatexture数据"):$$.activeResource(),$$},$m.load=function($x,$I,$z,$k,$l){if(void 0===$I&&($I=0),void 0===$z&&($z=0),void 0===$k&&($k=9729),void 0===$l&&($l=9729),"mipmaps"===$E.getFileExtension($x)){var $n=$C.loader.create($x,null,null,$m,[function($x){this._mipmaps=[];var $I=new Uint32Array($x);this._width=$I[0];var $z=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$z=1024),this._width!=$z)throw"现在只支持512x256的环境贴图。当前的是"+$I[0];this._height=$I[1];for(var $k=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$l=this._height,$n=8;;){var $a=$k*$l*4;if($n+$a>$x.byteLength)throw"load mipmaps data size error ";var $$=new Uint8Array($x,$n,$a);if(this._mipmaps.push($$),$n+=$a,1==$k&&1==$l)break;($k/=2)<1&&($k=1),($l/=2)<1&&($l=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$n.simLodInfo=new Float32Array(40);for(var $a=0;$a<$n.simLodInfo.length;)$n.simLodInfo[$a]=($m.simLodRect[$a]+.5)/1024,$a++,$n.simLodInfo[$a]=($m.simLodRect[$a]+.5)/256,$a++,$n.simLodInfo[$a]=Math.max($m.simLodRect[$a]-1,.1)/1024,$a++,$n.simLodInfo[$a]=Math.max($m.simLodRect[$a]-1.5,.1)/256,$a++}return $n}if("number"==typeof $I)return $C.loader.create($x,null,null,$m,[function($x){return this._width=$I,this._height=$z,this._buffer=$x,null}]);if("function"==typeof $I)return $C.loader.create($x,null,null,$m,[$I]);throw new Error("unknown params.")},$m.lodasatlas=!1,$b($m,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$m}(),$oI=function($x){function $I(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$I.__super.call(this)}$_($I,"laya.d3.resource.models.PrimitiveMesh",$UI);var $z=$I.prototype;return $C.imps($z,{"laya.d3.core.render.IRenderable":!0}),$z._getVertexBuffer=function($x){return void 0===$x&&($x=0),0===$x?this._vertexBuffer:null},$z._getVertexBuffers=function(){return null},$z._getIndexBuffer=function(){return this._indexBuffer},$z._getPositions=function(){var $x,$I=[],$z=this._vertexBuffer.vertexDeclaration.getVertexElements(),$k=0;for($k=0;$k<$z.length;$k++){var $l=$z[$k];if("vector3"===$l.elementFormat&&0===$l.elementUsage){$x=$l;break}}var $n=this._vertexBuffer.getData();for($k=0;$k<$n.length;$k+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $a=$k+$x.offset/4,$$=new $aI($n[$a+0],$n[$a+1],$n[$a+2]);$I.push($$)}return $I},$z.getRenderElement=function($x){return this},$z.getRenderElementsCount=function(){return 1},$z.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$z._beforeRender=function($x){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$z._render=function($x){$Z.mainContext.drawElements(4,this._numberIndices,5123,0),$L.drawCall++,$L.trianglesFaces+=this._numberIndices/3},$R(0,$z,"_vertexBufferCount",function(){return 1}),$R(0,$z,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$I}(),$JI=function($x){function $I(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$I.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$_($I,"laya.d3.resource.models.Mesh",$UI);var $z=$I.prototype;return $z._getPositions=function(){var $x,$I,$z,$k,$l,$n=[],$a=0,$$=0,$w=0;if(0!==this._vertexBuffers.length){var $i=this._vertexBuffers.length;for($a=0;$a<$i;$a++){for($z=($x=this._vertexBuffers[$a]).vertexDeclaration.getVertexElements(),$$=0;$$<$z.length;$$++)if("vector3"===($k=$z[$$]).elementFormat&&0===$k.elementUsage){$I=$k;break}for($l=$x.getData(),$$=0;$$<$l.length;$$+=$x.vertexDeclaration.vertexStride/4)$w=$$+$I.offset/4,$n.push(new $aI($l[$w+0],$l[$w+1],$l[$w+2]))}}else{var $F=this._subMeshes.length;for($a=0;$a<$F;$a++){for($z=($x=this._subMeshes[$a]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$$=0;$$<$z.length;$$++)if("vector3"===($k=$z[$$]).elementFormat&&0===$k.elementUsage){$I=$k;break}for($l=$x.getData(),$$=0;$$<$l.length;$$+=$x.vertexDeclaration.vertexStride/4)$w=$$+$I.offset/4,$n.push(new $aI($l[$w+0],$l[$w+1],$l[$w+2]))}}return $n},$z._setSubMeshes=function($x){this._subMeshes=$x,this._subMeshCount=$x.length;for(var $I=0;$I<this._subMeshCount;$I++)$x[$I]._indexInMesh=$I;this._positions=this._getPositions(),this._generateBoundingObject()},$z.onAsynLoaded=function($x,$I,$z){var $k=$I[0],$l=$I[1];$ux.read($k,this,this._materials,this._subMeshes,$l),this.completeCreate(),this._endLoaded()},$z.getSubMesh=function($x){return this._subMeshes[$x]},$z.getSubMeshCount=function(){return this._subMeshes.length},$z.getRenderElementsCount=function(){return this._subMeshes.length},$z.getRenderElement=function($x){return this._subMeshes[$x]},$z.disposeResource=function(){for(var $x=0;$x<this._subMeshes.length;$x++)this._subMeshes[$x].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$R(0,$z,"materials",function(){return this._materials.slice()}),$R(0,$z,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$I.load=function($x){return $C.loader.create($x,null,null,$I)},$I}(),$hI=(function($x){function $i($x,$I,$z,$k,$l,$n,$a,$$,$w){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$z&&($z=6408),void 0===$k&&($k=5121),void 0===$l&&($l=33189),void 0===$n&&($n=!1),void 0===$a&&($a=!1),void 0===$$&&($$=-1),void 0===$w&&($w=-1),$i.__super.call(this),this._type=3553,this._width=$x,this._height=$I,this._size=new $sI($x,$I),this._surfaceFormat=$z,this._surfaceType=$k,this._depthStencilFormat=$l,$s.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$n,this._repeat=$a,this._minFifter=$$,this._magFifter=$w,this.activeResource(),this._alreadyResolved=!0}$_($i,"laya.d3.resource.RenderTexture",$ZI);var $I=$i.prototype;$I.recreateResource=function(){var $x=$Z.mainContext;this._frameBuffer=$x.createFramebuffer(),this._source=$x.createTexture();var $I=$U.curBindTexTarget,$z=$U.curBindTexValue;$U.bindTexture($x,this._type,this._source),$x.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $k=this._minFifter,$l=this._magFifter,$n=this._repeat?10497:33071;if($y.isPOT(this._width,this._height)?(this._mipmap?-1!==$k||($k=9987):-1!==$k||($k=9729),-1!==$l||($l=9729),$x.texParameteri(this._type,10241,$k),$x.texParameteri(this._type,10240,$l),$x.texParameteri(this._type,10242,$n),$x.texParameteri(this._type,10243,$n),this._mipmap&&$x.generateMipmap(this._type)):(-1!==$k||($k=9729),-1!==$l||($l=9729),$x.texParameteri(this._type,10241,$k),$x.texParameteri(this._type,10240,$l),$x.texParameteri(this._type,10242,33071),$x.texParameteri(this._type,10243,33071)),$I&&$z&&$U.bindTexture($x,$I,$z),$x.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$x.createRenderbuffer(),$x.bindRenderbuffer(36161,this._depthStencilBuffer),$x.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$x.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$x.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$x.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$x.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$x.framebufferTexture2D(36160,36064,3553,this._source,0),$x.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$I.start=function(){$Z.mainContext.bindFramebuffer(36160,this.frameBuffer),($i._currentRenderTarget=this)._alreadyResolved=!1},$I.end=function(){$Z.mainContext.bindFramebuffer(36160,null),$i._currentRenderTarget=null,this._alreadyResolved=!0},$I.getData=function($x,$I,$z,$k){var $l=$Z.mainContext;if($l.bindFramebuffer(36160,this._frameBuffer),!(36053===$l.checkFramebufferStatus(36160)))return $l.bindFramebuffer(36160,null),null;var $n=new Uint8Array(this._width*this._height*4);return $l.readPixels($x,$I,$z,$k,this._surfaceFormat,this._surfaceType,$n),$l.bindFramebuffer(36160,null),$n},$I.disposeResource=function(){if(this._frameBuffer){var $x=$Z.mainContext;$x.deleteTexture(this._source),$x.deleteFramebuffer(this._frameBuffer),$x.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$R(0,$I,"surfaceFormat",function(){return this._surfaceFormat}),$R(0,$I,"surfaceType",function(){return this._surfaceType}),$R(0,$I,"depthStencilFormat",function(){return this._depthStencilFormat}),$R(0,$I,"source",function(){return this._alreadyResolved?$C.superGet($ZI,this,"source"):null}),$R(0,$I,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$R(0,$I,"frameBuffer",function(){return this._frameBuffer}),$i._currentRenderTarget=null}(),function($x){function $I($x){this._color=null,this._pixels=null,$I.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $sI(this.width,this.height),this._color=$x,this._pixels=new Uint8Array([255*$x.x,255*$x.y,255*$x.z,255*$x.w]),this.uri="SolidColorTexture2D_"+this.id}$_($I,"laya.d3.resource.SolidColorTexture2D",$ZI);var $z=$I.prototype;return $z._createWebGlTexture=function(){var $x=$Z.mainContext,$I=this._source=$x.createTexture(),$z=this._width,$k=this._height,$l=$U.curBindTexTarget,$n=$U.curBindTexValue;$U.bindTexture($x,this._type,$I),$x.texImage2D(this._type,0,6408,$z,$k,0,6408,5121,this._pixels);var $a=this._minFifter,$$=this._magFifter,$w=this._repeat?10497:33071,$i=$y.isPOT($z,$k);$i?(this._mipmap?-1!==$a||($a=9987):-1!==$a||($a=9729),-1!==$$||($$=9729),$x.texParameteri(this._type,10241,$a),$x.texParameteri(this._type,10240,$$),$x.texParameteri(this._type,10242,$w),$x.texParameteri(this._type,10243,$w),this._mipmap&&$x.generateMipmap(this._type)):(-1!==$a||($a=9729),-1!==$$||($$=9729),$x.texParameteri(this._type,10241,$a),$x.texParameteri(this._type,10240,$$),$x.texParameteri(this._type,10242,33071),$x.texParameteri(this._type,10243,33071)),$l&&$n&&$U.bindTexture($x,$l,$n),this.memorySize=$i?$z*$k*4*(1+1/3):$z*$k*4},$z.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$z.disposeResource=function(){this._source&&($Z.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$b($I,["magentaTexture",function(){var $x=new $I(new $$I(1,0,1,1));return $x.lock=!0,this.magentaTexture=$x},"grayTexture",function(){var $x=new $I(new $$I(.5,.5,.5,1));return $x.lock=!0,this.grayTexture=$x}]),$I}()),$BI=function($x){function $l($x,$I,$z,$k){this._canRead=!1,this._image=null,this._pixels=null,void 0===$x&&($x=!1),void 0===$I&&($I=!0),void 0===$z&&($z=6408),void 0===$k&&($k=!0),$l.__super.call(this),this._type=3553,this._repeat=$I,this._canRead=$x,this._format=$z,this._mipmap=$k}$_($l,"laya.d3.resource.Texture2D",$ZI);var $I=$l.prototype;return $I._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $x=$Z.mainContext,$I=this._source=$x.createTexture(),$z=this._width,$k=this._height,$l=$U.curBindTexTarget,$n=$U.curBindTexValue;switch($U.bindTexture($x,this._type,$I),this._format){case 6407:case 6408:this._canRead?$x.texImage2D(this._type,0,this._format,$z,$k,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$x.texImage2D(this._type,0,this._image._format,$z,$k,0,this._image._format,5121,this._image.atlasSource):$x.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $Z.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$x.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $a=this._minFifter,$$=this._magFifter,$w=this._repeat?10497:33071,$i=0==this._wrapModeU?10497:33071,$F=0==this._wrapModeV?10497:33071,$b=$y.isPOT($z,$k);$b?(this._mipmap?-1!==$a||($a=9987):-1!==$a||($a=9729),-1!==$$||($$=9729),$x.texParameteri(this._type,10241,$a),$x.texParameteri(this._type,10240,$$),$x.texParameteri(this._type,10242,$w),$x.texParameteri(this._type,10243,$w),$x.texParameteri(this._type,10242,$i),$x.texParameteri(this._type,10243,$F),this._mipmap&&$x.generateMipmap(this._type)):(-1!==$a||($a=9729),-1!==$$||($$=9729),$x.texParameteri(this._type,10241,$a),$x.texParameteri(this._type,10240,$$),$x.texParameteri(this._type,10242,33071),$x.texParameteri(this._type,10243,33071)),$l&&$n&&$U.bindTexture($x,$l,$n),this._image.onload=null,this._image=null,this.memorySize=$b?$z*$k*4*(1+1/3):$z*$k*4},$I.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$I.onAsynLoaded=function($x,$I,$z){if($z){var $k=$z[0];void 0!==$k&&(this._canRead=$k);var $l=$z[1];void 0!==$l&&(this._repeat=$l);var $n=$z[2];void 0!==$n&&(this._format=$n);var $a=$z[3];void 0!==$a&&(this._mipmap=$a);var $$=$z.wrapModeU;void 0!==$$&&(this._wrapModeU=$$);var $w=$z.wrapModeV;void 0!==$w&&(this._wrapModeV=$w)}switch(this._format){case 6407:case 6408:var $i=(this._image=$I).width,$F=$I.height;this._width=$i,this._height=$F,this._size=new $sI($i,$F),this._canRead&&($s.isConchApp?$I instanceof $T.HTMLElement&&(this._pixels=new Uint8Array($I.getImageData(0,0,$i,$F))):($X.canvas.size($i,$F),$X.canvas.clear(),$X.context.drawImage($I,0,0,$i,$F),this._pixels=new Uint8Array($X.context.getImageData(0,0,$i,$F).data.buffer)));break;case $Z.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $b=new $P($I);$b.readUTFBytes(4),$b.readUTFBytes(2),$b.getInt16();$b.endian="bigEndian",this._width=$b.getInt16(),this._height=$b.getInt16(),this._size=new $sI(this._width,this._height);$b.getInt16(),$b.getInt16();this._image=new Uint8Array($I,$b.pos)}this.recreateResource(),this._endLoaded()},$I.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$I.disposeResource=function(){this._source&&($Z.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$R(0,$I,"_src",function(){return this.url}),$R(0,$I,"src",function(){return this.url}),$l.load=function($x){return $C.loader.create($x,null,null,$l)},$l}(),$eI=function($I){function $z($x,$I){$z.__super.call(this),void 0===$x&&($x=.3),void 0===$I&&($I=1e3),this._tempVector3=new $aI,this._position=new $aI,this._up=new $aI,this._forward=new $aI,this._right=new $aI,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$sI.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$x,this._farPlane=$I,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$C.stage.on("resize",this,this._onScreenSizeChanged)}$_($z,"laya.d3.core.BaseCamera",$I);var $x=$z.prototype;return $x._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $x=this.scene._cameraPool,$I=$x.length-1,$z=0;$z<$I;$z++)if($x[$z].renderingOrder>$x[$I].renderingOrder){var $k=$x[$z];$x[$z]=$x[$I],$x[$I]=$k}},$x._calculateProjectionMatrix=function(){},$x._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$x._prepareCameraToRender=function(){$d._currentCameraCullingMask=this.cullingMask;var $x=this._shaderValues;$x.setValue(0,this.transform.position.elements),$x.setValue(5,this.forward.elements),$x.setValue(6,this.up.elements)},$x._prepareCameraViewProject=function($x,$I){var $z=this._shaderValues;$z.setValue(1,$x.elements),$z.setValue(2,$I.elements)},$x._renderCamera=function($x,$I,$z){},$x.addLayer=function($x){29!==$x.number&&30!=$x.number&&(this.cullingMask=this.cullingMask|$x.mask)},$x.removeLayer=function($x){29!==$x.number&&30!=$x.number&&(this.cullingMask=this.cullingMask&~$x.mask)},$x.addAllLayers=function(){this.cullingMask=2147483647},$x.removeAllLayers=function(){this.cullingMask=0|$d.getLayerByNumber(29).mask|$d.getLayerByNumber(30).mask},$x.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$x.moveForward=function($x){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$x,this.transform.translate(this._tempVector3)},$x.moveRight=function($x){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$x,this.transform.translate(this._tempVector3)},$x.moveVertical=function($x){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$x,this.transform.translate(this._tempVector3,!1)},$x._addSelfRenderObjects=function(){var $x=this.scene._cameraPool,$I=$x.length;if(0<$I){for(var $z=$I-1;0<=$z;$z--)if(this.renderingOrder<=$x[$z].renderingOrder){$x.splice($z+1,0,this);break}}else $x.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$x._clearSelfRenderObjects=function(){var $x=this.scene._cameraPool;$x.splice($x.indexOf(this),1)},$x.destroy=function($x){void 0===$x&&($x=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$C.stage.off("resize",this,this._onScreenSizeChanged),$I.prototype.destroy.call(this,$x)},$R(0,$x,"sky",function(){return this._sky},function($x){(this._sky=$x)._ownerCamera=this}),$R(0,$x,"forward",function(){var $x=this.transform.worldMatrix.elements,$I=this._forward.elements;return $I[0]=-$x[8],$I[1]=-$x[9],$I[2]=-$x[10],this._forward}),$R(0,$x,"position",function(){var $x=this.transform.worldMatrix.elements,$I=this._position.elements;return $I[0]=$x[12],$I[1]=$x[13],$I[2]=$x[14],this._position}),$R(0,$x,"renderTarget",function(){return this._renderTarget},function($x){null!=(this._renderTarget=$x)&&(this._renderTargetSize=$x.size)}),$R(0,$x,"up",function(){var $x=this.transform.worldMatrix.elements,$I=this._up.elements;return $I[0]=$x[4],$I[1]=$x[5],$I[2]=$x[6],this._up}),$R(0,$x,"right",function(){var $x=this.transform.worldMatrix.elements,$I=this._right.elements;return $I[0]=$x[0],$I[1]=$x[1],$I[2]=$x[2],this._right}),$R(0,$x,"renderTargetSize",function(){return this._renderTargetSize},function($x){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$x,this._calculateProjectionMatrix()}),$R(0,$x,"fieldOfView",function(){return this._fieldOfView},function($x){this._fieldOfView=$x,this._calculateProjectionMatrix()}),$R(0,$x,"nearPlane",function(){return this._nearPlane},function($x){this._nearPlane=$x,this._calculateProjectionMatrix()}),$R(0,$x,"farPlane",function(){return this._farPlane},function($x){this._farPlane=$x,this._calculateProjectionMatrix()}),$R(0,$x,"orthographic",function(){return this._orthographic},function($x){this._orthographic=$x,this._calculateProjectionMatrix()}),$R(0,$x,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($x){this._orthographicVerticalSize=$x,this._calculateProjectionMatrix()}),$R(0,$x,"renderingOrder",function(){return this._renderingOrder},function($x){this._renderingOrder=$x,this._sortCamerasByRenderingOrder()}),$z.CAMERAPOS=0,$z.VIEWMATRIX=1,$z.PROJECTMATRIX=2,$z.VPMATRIX=3,$z.VPMATRIX_NO_TRANSLATE=4,$z.CAMERADIRECTION=5,$z.CAMERAUP=6,$z.ENVIRONMENTDIFFUSE=7,$z.ENVIRONMENTSPECULAR=8,$z.SIMLODINFO=9,$z.DIFFUSEIRRADMATR=10,$z.DIFFUSEIRRADMATG=11,$z.DIFFUSEIRRADMATB=12,$z.HDREXPOSURE=13,$z.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$z.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$z.CLEARFLAG_SOLIDCOLOR=0,$z.CLEARFLAG_SKY=1,$z.CLEARFLAG_DEPTHONLY=2,$z.CLEARFLAG_NONE=3,$b($z,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $xI(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $xI},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $xI}]),$z}($tI),$AI=function($z){function $I($x){this._render=null,this._geometryFilter=null,$I.__super.call(this,$x)}$_($I,"laya.d3.core.RenderableSprite3D",$z);var $x=$I.prototype;return $x._addToInitStaticBatchManager=function(){},$x._setBelongScene=function($x){$z.prototype._setBelongScene.call(this,$x),$x._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$x._setUnBelongScene=function(){var $x=this._scene._renderableSprite3Ds,$I=$x.indexOf(this);$x.splice($I,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$z.prototype._setUnBelongScene.call(this)},$x._update=function($x){($x.owner=this)._activeInHierarchy&&(this._updateComponents($x),this._render._updateOctreeNode(),this._lateUpdateComponents($x),$L.spriteCount++,this._childs.length&&this._updateChilds($x))},$x.destroy=function($x){void 0===$x&&($x=!0),$z.prototype.destroy.call(this,$x),this._render._destroy(),this._render=null},$I.__init__=function(){$I.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$I.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$I.SAHDERDEFINE_LIGHTMAP=$I.shaderDefines.registerDefine("LIGHTMAP")},$I.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$I.SAHDERDEFINE_LIGHTMAP=4,$I.LIGHTMAPSCALEOFFSET=2,$I.LIGHTMAP=3,$b($I,["shaderDefines",function(){return this.shaderDefines=new $FI}]),$I}($tI),$HI=(function($x){function $k($x,$I,$z){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$x&&($x=1),void 0===$I&&($I=1),void 0===$z&&($z=1),$k.__super.call(this),this._long=$x,this._width=$I,this._height=$z,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$_($k,"laya.d3.resource.models.BoxMesh",$oI);var $I=$k.prototype;$I.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $x=$Zx.vertexDeclaration,$I=($x.vertexStride,this._long/2),$z=this._height/2,$k=this._width/2,$l=new Float32Array([-$I,$z,-$k,0,1,0,0,0,$I,$z,-$k,0,1,0,1,0,$I,$z,$k,0,1,0,1,1,-$I,$z,$k,0,1,0,0,1,-$I,-$z,-$k,0,-1,0,0,1,$I,-$z,-$k,0,-1,0,1,1,$I,-$z,$k,0,-1,0,1,0,-$I,-$z,$k,0,-1,0,0,0,-$I,$z,-$k,-1,0,0,0,0,-$I,$z,$k,-1,0,0,1,0,-$I,-$z,$k,-1,0,0,1,1,-$I,-$z,-$k,-1,0,0,0,1,$I,$z,-$k,1,0,0,1,0,$I,$z,$k,1,0,0,0,0,$I,-$z,$k,1,0,0,0,1,$I,-$z,-$k,1,0,0,1,1,-$I,$z,$k,0,0,1,0,0,$I,$z,$k,0,0,1,1,0,$I,-$z,$k,0,0,1,1,1,-$I,-$z,$k,0,0,1,0,1,-$I,$z,-$k,0,0,-1,1,0,$I,$z,-$k,0,0,-1,0,0,$I,-$z,-$k,0,0,-1,0,1,-$I,-$z,-$k,0,0,-1,1,1]),$n=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $WI($x,this._numberVertices,35044,!0),this._indexBuffer=new $VI("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($l),this._indexBuffer.setData($n),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$R(0,$I,"long",function(){return this._long},function($x){this._long!==$x&&(this._long=$x,this.releaseResource(),this.activeResource())}),$R(0,$I,"width",function(){return this._width},function($x){this._width!==$x&&(this._width=$x,this.releaseResource(),this.activeResource())}),$R(0,$I,"height",function(){return this._height},function($x){this._height!==$x&&(this._height=$x,this.releaseResource(),this.activeResource())})}(),function($x){function $l($x,$I,$z,$k){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$x&&($x=10),void 0===$I&&($I=10),void 0===$z&&($z=10),void 0===$k&&($k=10),$l.__super.call(this),this._long=$x,this._width=$I,this._stacks=$z,this._slices=$k,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$_($l,"laya.d3.resource.models.PlaneMesh",$oI);var $I=$l.prototype;$I.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $x=new Uint16Array(this._numberIndices),$I=$Zx.vertexDeclaration,$z=$I.vertexStride/4,$k=new Float32Array(this._numberVertices*$z),$l=this._long/2,$n=this._width/2,$a=this._long/this._stacks,$$=this._width/this._slices,$w=0,$i=0;$i<=this._slices;$i++)for(var $F=0;$F<=this._stacks;$F++)$k[$w++]=$F*$a-$l,$k[$w++]=0,$k[$w++]=$i*$$-$n,$k[$w++]=0,$k[$w++]=1,$k[$w++]=0,$k[$w++]=1*$F/this._stacks,$k[$w++]=1*$i/this._slices;var $b=0;for($i=0;$i<this._slices;$i++)for($F=0;$F<this._stacks;$F++)$x[$b++]=($i+1)*(this._stacks+1)+$F,$x[$b++]=$i*(this._stacks+1)+$F,$x[$b++]=($i+1)*(this._stacks+1)+$F+1,$x[$b++]=$i*(this._stacks+1)+$F,$x[$b++]=$i*(this._stacks+1)+$F+1,$x[$b++]=($i+1)*(this._stacks+1)+$F+1;this._vertexBuffer=new $WI($I,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $VI("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($k),this._indexBuffer.setData($x),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$R(0,$I,"long",function(){return this._long},function($x){this._long!==$x&&(this._long=$x,this.releaseResource(),this.activeResource())}),$R(0,$I,"width",function(){return this._width},function($x){this._width!==$x&&(this._width=$x,this.releaseResource(),this.activeResource())}),$R(0,$I,"stacks",function(){return this._stacks},function($x){this._stacks!==$x&&(this._stacks=$x,this.releaseResource(),this.activeResource())}),$R(0,$I,"slices",function(){return this._slices},function($x){this._slices!==$x&&(this._slices=$x,this.releaseResource(),this.activeResource())})}(),function($x){function $a($x,$I,$z){void 0===$x&&($x=0),void 0===$I&&($I=.3),void 0===$z&&($z=1e3),this._viewMatrix=new $xI,this._projectionMatrix=new $xI,this._projectionViewMatrix=new $xI,this._viewport=new $wI(0,0,0,0),this._normalizedViewport=new $wI(0,0,1,1),this._aspectRatio=$x,this._boundFrustumUpdate=!0,this._boundFrustum=new $gx($xI.DEFAULT),$a.__super.call(this,$I,$z),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$_($a,"laya.d3.core.Camera",$eI);var $I=$a.prototype;return $I._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$I._parseCustomProps=function($x,$I,$z,$k){var $l=$z.clearColor;this.clearColor=new $$I($l[0],$l[1],$l[2],$l[3]);var $n=$z.viewport;this.normalizedViewport=new $wI($n[0],$n[1],$n[2],$n[3])},$I._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $x=this.orthographicVerticalSize*this.aspectRatio*.5,$I=.5*this.orthographicVerticalSize;$xI.createOrthoOffCenterRH(-$x,$x,-$I,$I,this.nearPlane,this.farPlane,this._projectionMatrix)}else $xI.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$I._update=function($x){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$x)},$I._renderCamera=function($x,$I,$z){var $k,$l;$z.parallelSplitShadowMaps[0]&&$z._renderShadowMap($x,$I,this),($I.camera=this)._prepareCameraToRender(),$z._preRenderUpdateComponents($I),$k=$I._viewMatrix=this.viewMatrix;var $n=this._renderTarget;$n?($n.start(),$xI.multiply($eI._invertYScaleMatrix,this._projectionMatrix,$eI._invertYProjectionMatrix),$xI.multiply($eI._invertYScaleMatrix,this.projectionViewMatrix,$eI._invertYProjectionViewMatrix),$l=$I._projectionMatrix=$eI._invertYProjectionMatrix,$I._projectionViewMatrix=$eI._invertYProjectionViewMatrix):($l=$I._projectionMatrix=this._projectionMatrix,$I._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($k,$l),$I._viewport=this.viewport,$z._preRenderScene($x,$I,this.boundFrustum),$z._clear($x,$I),$z._renderScene($x,$I),$z._postRenderUpdateComponents($I),$n&&$n.end()},$I.viewportPointToRay=function($x,$I){$RI.calculateCursorRay($x,this.viewport,this._projectionMatrix,this.viewMatrix,null,$I)},$I.normalizedViewportPointToRay=function($x,$I){var $z=$a._tempVector20,$k=this.viewport,$l=$x.elements,$n=$z.elements;$n[0]=$l[0]*$k.width,$n[1]=$l[1]*$k.height,$RI.calculateCursorRay($z,this.viewport,this._projectionMatrix,this.viewMatrix,null,$I)},$I.worldToViewportPoint=function($x,$I){$xI.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($x,this._projectionViewMatrix,$I);var $z=$I.elements;$z[0]=$z[0]/$C.stage.clientScaleX,$z[1]=$z[1]/$C.stage.clientScaleY},$I.worldToNormalizedViewportPoint=function($x,$I){$xI.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($x,this._projectionViewMatrix,$I);var $z=$I.elements;$z[0]=$z[0]/$C.stage.clientScaleX,$z[1]=$z[1]/$C.stage.clientScaleY},$I.convertScreenCoordToOrthographicCoord=function($x,$I,$z){if(void 0===$z&&($z=!0),this._orthographic){var $k=$u.clientWidth,$l=$u.clientHeight,$n=this.orthographicVerticalSize*this.aspectRatio/$k,$a=this.orthographicVerticalSize/$l,$$=$x.elements,$w=$I.elements;return $w[0]=(-$k/2+$$[0])*$n,$w[1]=($l/2-$$[1])*$a,$w[2]=(this.nearPlane-this.farPlane)*($$[2]+1)/2-this.nearPlane,$z&&$aI.transformCoordinate($I,this.transform.worldMatrix,$I),!0}return!1},$R(0,$I,"projectionViewMatrix",function(){return $xI.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$R(0,$I,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $x=this.viewport;return $x.width/$x.height},function($x){if($x<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$x,this._calculateProjectionMatrix()}),$R(0,$I,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$R(0,$I,"needViewport",function(){var $x=this.normalizedViewport;return 0===$x.x&&0===$x.y&&1===$x.width&&1===$x.height}),$R(0,$I,"viewport",function(){if(this._viewportExpressedInClipSpace){var $x=this._normalizedViewport,$I=this.renderTargetSize,$z=$I.width,$k=$I.height;this._viewport.x=$x.x*$z,this._viewport.y=$x.y*$k,this._viewport.width=$x.width*$z,this._viewport.height=$x.height*$k}return this._viewport},function($x){if(null!=this.renderTarget&&($x.x<0||$x.y<0||0==$x.width||0==$x.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$x,this._calculateProjectionMatrix()}),$R(0,$I,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $x=this._viewport,$I=this.renderTargetSize,$z=$I.width,$k=$I.height;this._normalizedViewport.x=$x.x/$z,this._normalizedViewport.y=$x.y/$k,this._normalizedViewport.width=$x.width/$z,this._normalizedViewport.height=$x.height/$k}return this._normalizedViewport},function($x){$x.x<0&&($x.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$x.y<0&&($x.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$x.x+$x.width&&($x.width=1-$x.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$x.y+$x.height&&($x.height=1-$x.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$x,this._calculateProjectionMatrix()}),$R(0,$I,"projectionMatrix",function(){return this._projectionMatrix},function($x){this._projectionMatrix=$x,this._useUserProjectionMatrix=!0}),$R(0,$I,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$b($a,["_tempVector20",function(){return this._tempVector20=new $nI}]),$a}()),$pI=function($z){function $k($x,$I){$k.__super.call(this,$I),this._geometryFilter=new $XI(this),this._render=new $dI(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$x&&(this._geometryFilter.sharedMesh=$x)instanceof laya.d3.resource.models.Mesh&&($x.loaded?this._render.sharedMaterials=$x.materials:$x.once("loaded",this,this._applyMeshMaterials))}$_($k,"laya.d3.core.MeshSprite3D",$z);var $x=$k.prototype;return $x._changeRenderObjectByMesh=function($x){var $I=this._render._renderElements,$z=$I[$x];$z||($z=$I[$x]=new $vI),$z._render=this._render;var $k=this._render.sharedMaterials[$x];$k||($k=$cI.defaultMaterial);var $l=this._geometryFilter.sharedMesh.getRenderElement($x);return $z._mainSortID=this._getSortID($l,$k),$z._sprite3D=this,$z.renderObj=$l,$z._material=$k,$z},$x._changeRenderObjectByMaterial=function($x,$I){var $z=this._render._renderElements[$x];$I||($I=$cI.defaultMaterial);var $k=this._geometryFilter.sharedMesh.getRenderElement($x);return $z._mainSortID=this._getSortID($k,$I),$z._sprite3D=this,$z.renderObj=$k,$z._material=$I,$z},$x._changeRenderObjectsByMesh=function(){var $x=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$x;for(var $I=0;$I<$x;$I++)this._changeRenderObjectByMesh($I)},$x._onMeshChanged=function($x){var $I=$x.sharedMesh;$I.loaded?this._changeRenderObjectsByMesh():$I.once("loaded",this,this._onMeshLoaded)},$x._onMeshLoaded=function($x){$x===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$x._onMaterialChanged=function($x,$I,$z){$I<this._render._renderElements.length&&this._changeRenderObjectByMaterial($I,$z)},$x._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$x._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$x._parseCustomProps=function($x,$I,$z,$k){var $l=this.meshRender,$n=$z.lightmapIndex;null!=$n&&($l.lightmapIndex=$n);var $a,$$,$w=$z.lightmapScaleOffset;if($w&&($l.lightmapScaleOffset=new $$I($w[0],$w[1],$w[2],$w[3])),$k.instanceParams)($a=$k.instanceParams.loadPath)&&($$=$D.getRes($I[$a]),(this.meshFilter.sharedMesh=$$).loaded?$l.sharedMaterials=$$.materials:$$.once("loaded",this,this._applyMeshMaterials));else{($a=$z.meshPath)&&($$=$D.getRes($I[$a]),this.meshFilter.sharedMesh=$$);var $i=$z.materials;if($i){var $F=$l.sharedMaterials,$b=$i.length;$F.length=$b;for(var $T=0;$T<$b;$T++)$F[$T]=$D.getRes($I[$i[$T].path]);$l.sharedMaterials=$F}}},$x._applyMeshMaterials=function($x){for(var $I=this._render.sharedMaterials,$z=$x.materials,$k=0,$l=$z.length;$k<$l;$k++)$I[$k]||($I[$k]=$z[$k]);this._render.sharedMaterials=$I},$x._addToInitStaticBatchManager=function(){$k._staticBatchManager._addInitBatchSprite(this)},$x.cloneTo=function($x){var $I=$x;$I._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $z=this._render,$k=$I._render;$k.enable=$z.enable,$k.sharedMaterials=$z.sharedMaterials,$k.castShadow=$z.castShadow;var $l=$z.lightmapScaleOffset;$l&&($k.lightmapScaleOffset=$l.clone()),$k.lightmapIndex=$z.lightmapIndex,$k.receiveShadow=$z.receiveShadow,$k.sortingFudge=$z.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$x)},$x.destroy=function($x){if(void 0===$x&&($x=!0),!this.destroyed){var $I=this.meshFilter.sharedMesh;null!=$I&&($I.loaded||$I.off("loaded",this,this._applyMeshMaterials)),$z.prototype.destroy.call(this,$x),this._geometryFilter._destroy()}},$R(0,$x,"meshFilter",function(){return this._geometryFilter}),$R(0,$x,"meshRender",function(){return this._render}),$k.__init__=function(){$kx._staticBatchManagers.push($k._staticBatchManager)},$k.load=function($x){return $C.loader.create($x,null,null,$k)},$b($k,["_staticBatchManager",function(){return this._staticBatchManager=new $KI}]),$k}($AI)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($x,$I){"use strict";for(var $z in Object.defineProperty($I,"__esModule",{value:!0}),Laya){var $k=Laya[$z];$k&&$k.__isclass&&($I[$z]=$k)}}),function($Xx,$x,$lx){$lx.un,$lx.uns;var $I=$lx.static,$k=$lx.class,$n=$lx.getset,$s=$lx.__newvec,$$=laya.maths.Bezier,$b=laya.utils.Browser,$dx=laya.utils.Byte,$l=(laya.events.Event,laya.events.EventDispatcher),$z=laya.display.Graphics,$a=(laya.resource.HTMLCanvas,laya.utils.Handler),$w=laya.net.Loader,$T=laya.maths.MathUtil,$jx=laya.maths.Matrix,$N=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$i=(laya.renders.RenderContext,laya.resource.Resource),$F=laya.utils.RunDriver,$nx=laya.display.Sprite,$_=laya.utils.Stat,$tx=laya.resource.Texture,$R=(laya.net.URL,laya.utils.Utils),$U=function(){function $x(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $k($x,"laya.ani.AnimationContent"),$x}(),$X=function(){function $x(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $k($x,"laya.ani.AnimationNodeContent"),$x}(),$D=function(){function $x(){}return $k($x,"laya.ani.AnimationParser01"),$x.parse=function($x,$I){var $z=$I.__getBuffer(),$k=0,$l=0,$n=0,$a=0,$$=0,$w=0,$i=0,$F=$I.readUTFString();$x._aniClassName=$F;var $b,$T=$I.readUTFString().split("\n"),$_=$I.getUint8(),$R=$I.getUint32(),$s=$I.getUint32();0<$R&&($b=$z.slice($R,$s));var $N=new $dx($b);for(0<$s&&($x._publicExtData=$z.slice($s,$z.byteLength)),$x._useParent=!!$I.getUint8(),$x._anis.length=$_,$k=0;$k<$_;$k++){var $D=$x._anis[$k]=new $U;$D.nodes=new Array;var $f=$D.name=$T[$I.getUint16()];$x._aniMap[$f]=$k,$D.bone3DMap={},$D.playTime=$I.getFloat32(),$D.playTime<=0&&console.error("播放时间不能为0  url="+$x.url+" name="+$D.name);var $m=$D.nodes.length=$I.getUint8();for($l=$D.totalKeyframeDatasLength=0;$l<$m;$l++){var $y=$D.nodes[$l]=new $X;$y.childs=[];var $C=$I.getInt16();0<=$C&&($y.name=$T[$C],$D.bone3DMap[$y.name]=$l),$y.keyFrame=new Array,$y.parentIndex=$I.getInt16(),-1==$y.parentIndex?$y.parent=null:$y.parent=$D.nodes[$y.parentIndex],$y.lerpType=$I.getUint8();var $P=$I.getUint32();$N.pos=$P;var $v=$y.keyframeWidth=$N.getUint16();if($D.totalKeyframeDatasLength+=$v,0===$y.lerpType||1===$y.lerpType)for($y.interpolationMethod=[],$y.interpolationMethod.length=$v,$n=0;$n<$v;$n++)$y.interpolationMethod[$n]=$t.interpolation[$N.getUint8()];null!=$y.parent&&$y.parent.childs.push($y);var $L=$I.getUint16();0<$L&&($y.extenData=$z.slice($I.pos,$I.pos+$L),$I.pos+=$L);var $K,$E=$I.getUint16(),$O=0;for($n=0,$a=$y.keyFrame.length=$E;$n<$a;$n++){if(($K=$y.keyFrame[$n]=new $d).duration=$I.getFloat32(),$K.startTime=$O,2===$y.lerpType){$K.interpolationData=[];var $S,$Z=$I.getUint8();switch($S=$I.getFloat32()){case 254:for($K.interpolationData.length=$v,$i=0;$i<$v;$i++)$K.interpolationData[$i]=0;break;case 255:for($K.interpolationData.length=$v,$i=0;$i<$v;$i++)$K.interpolationData[$i]=5;break;default:for($K.interpolationData.push($S),$w=1;$w<$Z;$w++)$K.interpolationData.push($I.getFloat32())}}for($K.data=new Float32Array($v),$$=0;$$<$v;$$++)$K.data[$$]=$I.getFloat32(),-1e-8<$K.data[$$]&&$K.data[$$]<1e-8&&($K.data[$$]=0);$O+=$K.duration}$K.startTime=$D.playTime,$y.playTime=$D.playTime,$x._calculateKeyFrame($y,$E,$v)}}},$x}(),$m=function(){function $C(){}return $k($C,"laya.ani.AnimationParser02"),$C.READ_DATA=function(){$C._DATA.offset=$C._reader.getUint32(),$C._DATA.size=$C._reader.getUint32()},$C.READ_BLOCK=function(){for(var $x=$C._BLOCK.count=$C._reader.getUint16(),$I=$C._BLOCK.blockStarts=[],$z=$C._BLOCK.blockLengths=[],$k=0;$k<$x;$k++)$I.push($C._reader.getUint32()),$z.push($C._reader.getUint32())},$C.READ_STRINGS=function(){var $x=$C._reader.getUint32(),$I=$C._reader.getUint16(),$z=$C._reader.pos;$C._reader.pos=$x+$C._DATA.offset;for(var $k=0;$k<$I;$k++)$C._strings[$k]=$C._reader.readUTFString();$C._reader.pos=$z},$C.parse=function($x,$I){$C._templet=$x;($C._reader=$I).__getBuffer();$C.READ_DATA(),$C.READ_BLOCK(),$C.READ_STRINGS();for(var $z=0,$k=$C._BLOCK.count;$z<$k;$z++){var $l=$I.getUint16(),$n=$C._strings[$l],$a=$C["READ_"+$n];if(null==$a)throw new Error("model file err,no this function:"+$l+" "+$n);$a.call()}},$C.READ_ANIMATIONS=function(){var $x=$C._reader,$I=$x.__getBuffer(),$z=0,$k=0,$l=0,$n=0,$a=$x.getUint16(),$$=[];for($$.length=$a,$z=0;$z<$a;$z++)$$[$z]=$t.interpolation[$x.getByte()];var $w=$x.getUint8();for($C._templet._anis.length=$w,$z=0;$z<$w;$z++){var $i=$C._templet._anis[$z]={};$i.nodes=new Array;var $F=$i.name=$C._strings[$x.getUint16()];$C._templet._aniMap[$F]=$z,$i.bone3DMap={},$i.playTime=$x.getFloat32();var $b=$i.nodes.length=$x.getInt16();for($k=$i.totalKeyframeDatasLength=0;$k<$b;$k++){var $T=$i.nodes[$k]={};$T.keyframeWidth=$a,$T.childs=[];var $_=$x.getUint16();0<=$_&&($T.name=$C._strings[$_],$i.bone3DMap[$T.name]=$k),$T.keyFrame=new Array,$T.parentIndex=$x.getInt16(),-1==$T.parentIndex?$T.parent=null:$T.parent=$i.nodes[$T.parentIndex],$i.totalKeyframeDatasLength+=$a,$T.interpolationMethod=$$,null!=$T.parent&&$T.parent.childs.push($T);var $R=$x.getUint16(),$s=null,$N=null;for($l=0,$n=$T.keyFrame.length=$R;$l<$n;$l++){($s=$T.keyFrame[$l]={}).startTime=$x.getFloat32(),$N&&($N.duration=$s.startTime-$N.startTime);var $D=$C._DATA.offset,$f=$x.getUint32(),$m=4*$a,$y=$I.slice($D+$f,$D+$f+$m);$s.data=new Float32Array($y),$N=$s}$s.duration=0,$T.playTime=$i.playTime,$C._templet._calculateKeyFrame($T,$R,$a)}}},$C._templet=null,$C._reader=null,$C._strings=[],$I($C,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$C}(),$Yx=(function(){function $x(){}$k($x,"laya.ani.AnimationState"),$x.stopped=0,$x.paused=1,$x.playing=2}(),function(){function $l(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $ux,this.resultMatrix=new $jx,this._children=[]}$k($l,"laya.ani.bone.Bone");var $x=$l.prototype;return $x.setTempMatrix=function($x){this._tempMatrix=$x;var $I,$z=0;for($z=0,$I=this._children.length;$z<$I;$z++)this._children[$z].setTempMatrix(this._tempMatrix)},$x.update=function($x){var $I;if(this.rotation=this.transform.skX,$x)$I=this.resultTransform.getMatrix(),$jx.mul($I,$x,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$I=this.resultTransform.getMatrix(),$jx.mul($I,this.parentBone.resultMatrix,this.resultMatrix);else{var $z=this.parentBone,$k=NaN,$l=NaN,$n=NaN,$a=this.parentBone.resultMatrix;$I=this.resultTransform.getMatrix();var $$=$a.a*$I.tx+$a.c*$I.ty+$a.tx,$w=$a.b*$I.tx+$a.d*$I.ty+$a.ty,$i=new $jx;this.inheritRotation?($k=Math.atan2($z.resultMatrix.b,$z.resultMatrix.a),$l=Math.cos($k),$n=Math.sin($k),$i.setTo($l,$n,-$n,$l,0,0),$jx.mul(this._tempMatrix,$i,$jx.TEMP),$jx.TEMP.copyTo($i),$I=this.resultTransform.getMatrix(),$jx.mul($I,$i,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$I=this.resultTransform.getMatrix(),$jx.TEMP.identity(),$jx.TEMP.d=this.d,$jx.mul($I,$jx.TEMP,this.resultMatrix)),this.resultMatrix.tx=$$,this.resultMatrix.ty=$w}else($I=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $F,$b=0;for($b=0,$F=this._children.length;$b<$F;$b++)this._children[$b].update()},$x.updateChild=function(){var $x,$I=0;for($I=0,$x=this._children.length;$I<$x;$I++)this._children[$I].update()},$x.setRotation=function($x){this._sprite&&(this._sprite.rotation=180*$x/Math.PI)},$x.updateDraw=function($x,$I){$l.ShowBones&&!$l.ShowBones[this.name]||(this._sprite||(this._sprite=new $nx,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$lx.stage.addChild(this._sprite)),this._sprite.x=$x+this.resultMatrix.tx,this._sprite.y=$I+this.resultMatrix.ty);var $z,$k=0;for($k=0,$z=this._children.length;$k<$z;$k++)this._children[$k].updateDraw($x,$I)},$x.addChild=function($x){this._children.push($x),$x.parentBone=this},$x.findBone=function($x){if(this.name==$x)return this;var $I,$z,$k=0;for($k=0,$I=this._children.length;$k<$I;$k++)if($z=this._children[$k].findBone($x))return $z;return null},$x.localToWorld=function($x){var $I=$x[0],$z=$x[1];$x[0]=$I*this.resultMatrix.a+$z*this.resultMatrix.c+this.resultMatrix.tx,$x[1]=$I*this.resultMatrix.b+$z*this.resultMatrix.d+this.resultMatrix.ty},$l.ShowBones={},$l}()),$cx=function(){function $s(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$k($s,"laya.ani.bone.BoneSlot");var $x=$s.prototype;return $x.showSlotData=function($x,$I){void 0===$I&&($I=!0),this.currSlotData=$x,$I&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$x.showDisplayByName=function($x){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($x))},$x.replaceDisplayByName=function($x,$I){if(this.currSlotData){var $z;$z=this.currSlotData.getDisplayByName($x);var $k;$k=this.currSlotData.getDisplayByName($I),this.replaceDisplayByIndex($z,$k)}},$x.replaceDisplayByIndex=function($x,$I){this.currSlotData&&(this._replaceDic[$x]=$I,this.displayIndex==$x&&this.showDisplayByIndex($x))},$x.showDisplayByIndex=function($x){if(null!=this._replaceDic[$x]&&($x=this._replaceDic[$x]),this.currSlotData&&-1<$x&&$x<this.currSlotData.displayArr.length){if(this.displayIndex=$x,this.currDisplayData=this.currSlotData.displayArr[$x],this.currDisplayData){var $I=this.currDisplayData.name;this.currTexture=this.templet.getTexture($I),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$N.isConchApp||$N.isConchApp&&"0.9.15"<$nx.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$x.replaceSkin=function($x){this._diyTexture=$x,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$x.setParentMatrix=function($x){this._parentMatrix=$x},$x.draw=function($x,$I,$z,$k){if(void 0===$z&&($z=!1),void 0===$k&&($k=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $l,$n=this.currTexture;switch(this._diyTexture&&($n=this._diyTexture),this.currDisplayData.type){case 0:if($x){var $a=this.getDisplayMatrix();if(this._parentMatrix){var $$=!1;if($a){var $w;if($jx.mul($a,this._parentMatrix,$jx.TEMP),$w=$z?(null==this._resultMatrix&&(this._resultMatrix=new $jx),this._resultMatrix):new $jx,!$N.isWebGL&&this.currDisplayData.uvs||$N.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $i=$s._tempMatrix;$i.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($i.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($$=!0,$i.rotate(-Math.PI/2)),$jx.mul($i,$jx.TEMP,$w)}else $jx.TEMP.copyTo($w);$$?$x.drawTexture($n,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$w):$x.drawTexture($n,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$w)}}}break;case 1:if(null==($l=$z?(null==this._skinSprite&&(this._skinSprite=$s.createSkinMesh()),this._skinSprite):$s.createSkinMesh()))return;var $F;if(null==this.currDisplayData.bones){var $b,$T=this.currDisplayData.weights;this.deformData&&($T=this.deformData),$b=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$P.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$P.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$T;this.currDisplayData.triangles.length;$F=this.currDisplayData.triangles,$l.init2($n,null,$F,this._mVerticleArr,$b);var $_,$R=this.getDisplayMatrix();if(this._parentMatrix)if($R)$jx.mul($R,this._parentMatrix,$jx.TEMP),$_=$z?(null==this._resultMatrix&&(this._resultMatrix=new $jx),this._resultMatrix):new $jx,$jx.TEMP.copyTo($_),$l.transform=$_}else this.skinMesh($I,$l,$k);$x.drawSkin($l);break;case 2:if(null==($l=$z?(null==this._skinSprite&&(this._skinSprite=$s.createSkinMesh()),this._skinSprite):$s.createSkinMesh()))return;this.skinMesh($I,$l,$k),$x.drawSkin($l)}}},$x.skinMesh=function($x,$I,$z){var $k,$l=this.currTexture,$n=this.currDisplayData.bones;$k=this._diyTexture?($l=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$P.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$P.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $a,$$,$w=this.currDisplayData.weights,$i=this.currDisplayData.triangles,$F=0,$b=0,$T=0,$_=NaN,$R=NaN,$s=0,$N=0,$D=[],$f=0,$m=0;if(this.deformData&&0<this.deformData.length){var $y=0;for($f=0,$m=$n.length;$f<$m;){for($T=$n[$f++]+$f,$b=$F=0;$f<$T;$f++)$$=$x[$n[$f]],$_=$w[$s]+this.deformData[$y++],$R=$w[$s+1]+this.deformData[$y++],$N=$w[$s+2],$F+=($_*$$.a+$R*$$.c+$$.tx)*$N,$b+=($_*$$.b+$R*$$.d+$$.ty)*$N,$s+=3;$D.push($F,$b)}}else for($f=0,$m=$n.length;$f<$m;){for($T=$n[$f++]+$f,$b=$F=0;$f<$T;$f++)$$=$x[$n[$f]],$_=$w[$s],$R=$w[$s+1],$N=$w[$s+2],$F+=($_*$$.a+$R*$$.c+$$.tx)*$N,$b+=($_*$$.b+$R*$$.d+$$.ty)*$N,$s+=3;$D.push($F,$b)}this._mVerticleArr=$D,$a=$i,$I.init2($l,null,$a,this._mVerticleArr,$k)},$x.drawBonePoint=function($x){$x&&this._parentMatrix&&$x.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$x.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$x.getMatrix=function(){return this._resultMatrix},$x.copy=function(){var $x=new $s;return $x.type="copy",$x.name=this.name,$x.attachmentName=this.attachmentName,$x.srcDisplayIndex=this.srcDisplayIndex,$x.parent=this.parent,$x.displayIndex=this.displayIndex,$x.templet=this.templet,$x.currSlotData=this.currSlotData,$x.currTexture=this.currTexture,$x.currDisplayData=this.currDisplayData,$x},$s.createSkinMesh=function(){return $N.isWebGL||$N.isConchApp?$F.skinAniSprite():($N.isWebGL,null)},$I($s,["_tempMatrix",function(){return this._tempMatrix=new $jx}]),$s}(),$Vx=function(){function $x(){this.skinName=null,this.deformSlotDataList=[]}return $k($x,"laya.ani.bone.DeformAniData"),$x}(),$Wx=function(){function $x(){this.deformSlotDisplayList=[]}return $k($x,"laya.ani.bone.DeformSlotData"),$x}(),$qx=function(){function $x(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$k($x,"laya.ani.bone.DeformSlotDisplayData");var $I=$x.prototype;return $I.binarySearch1=function($x,$I){var $z=0,$k=$x.length-2;if(0==$k)return 1;for(var $l=$k>>>1;;){if($x[Math.floor($l+1)]<=$I?$z=$l+1:$k=$l,$z==$k)return $z+1;$l=$z+$k>>>1}return 0},$I.apply=function($x,$I,$z){if(void 0===$z&&($z=1),$x+=.05,!(this.timeList.length<=0)){var $k=0;if(!($x<this.timeList[0])){var $l=this.vectices[0].length,$n=[],$a=this.binarySearch1(this.timeList,$x);if(this.frameIndex=$a,$x>=this.timeList[this.timeList.length-1]){var $$=this.vectices[this.vectices.length-1];if($z<1)for($k=0;$k<$l;$k++)$n[$k]+=($$[$k]-$n[$k])*$z;else for($k=0;$k<$l;$k++)$n[$k]=$$[$k];this.deformData=$n}else{this.tweenKeyList[this.frameIndex];var $w=this.vectices[this.frameIndex-1],$i=this.vectices[this.frameIndex],$F=this.timeList[this.frameIndex-1],$b=this.timeList[this.frameIndex];$z=this.tweenKeyList[$a-1]?($x-$F)/($b-$F):0;var $T=NaN;for($k=0;$k<$l;$k++)$T=$w[$k],$n[$k]=$T+($i[$k]-$T)*$z;this.deformData=$n}}}},$x}(),$ox=function(){function $x(){this.time=NaN,this.drawOrder=[]}return $k($x,"laya.ani.bone.DrawOrderData"),$x}(),$Jx=function(){function $x(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $k($x,"laya.ani.bone.EventData"),$x}(),$f=function(){function $kx($x,$I){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$x,this._targetBone=$I[$x.targetBoneIndex],this.isSpine=$x.isSpine,null==this._bones&&(this._bones=[]);for(var $z=this._bones.length=0,$k=$x.boneIndexs.length;$z<$k;$z++)this._bones.push($I[$x.boneIndexs[$z]]);this.name=$x.name,this.mix=$x.mix,this.bendDirection=$x.bendDirection}$k($kx,"laya.ani.bone.IkConstraint");var $x=$kx.prototype;return $x.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$x._applyIk1=function($x,$I,$z,$k){var $l=$x.parentBone,$n=1/($l.resultMatrix.a*$l.resultMatrix.d-$l.resultMatrix.b*$l.resultMatrix.c),$a=$I-$l.resultMatrix.tx,$$=$z-$l.resultMatrix.ty,$w=($a*$l.resultMatrix.d-$$*$l.resultMatrix.c)*$n-$x.transform.x,$i=($$*$l.resultMatrix.a-$a*$l.resultMatrix.b)*$n-$x.transform.y,$F=Math.atan2($i,$w)*$kx.radDeg-0-$x.transform.skX;$x.transform.scX<0&&($F+=180),180<$F?$F-=360:$F<-180&&($F+=360),$x.transform.skX=$x.transform.skY=$x.transform.skX+$F*$k,$x.update()},$x.updatePos=function($x,$I){this._sp&&this._sp.pos($x,$I)},$x._applyIk2=function($x,$I,$z,$k,$l,$n){if(0!=$n){var $a=$x.resultTransform.x,$$=$x.resultTransform.y,$w=$x.transform.scX,$i=$x.transform.scY,$F=$I.transform.scX,$b=0,$T=0,$_=0;$_=$w<0?($w=-$w,$b=180,-1):($b=0,1),$i<0&&($i=-$i,$_=-$_),$T=$F<0?($F=-$F,180):0;var $R=$I.resultTransform.x,$s=NaN,$N=NaN,$D=NaN,$f=$x.resultMatrix.a,$m=$x.resultMatrix.c,$y=$x.resultMatrix.b,$C=$x.resultMatrix.d,$P=Math.abs($w-$i)<=1e-4;$D=$P?($N=$f*$R+$m*($s=$I.resultTransform.y)+$x.resultMatrix.tx,$y*$R+$C*$s+$x.resultMatrix.ty):($s=0,$N=$f*$R+$x.resultMatrix.tx,$y*$R+$x.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $nx,$lx.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($z,$k,15,"#ffff00"),this._sp.graphics.drawCircle($N,$D,15,"#ff00ff")),$x.setRotation(Math.atan2($D-$x.resultMatrix.ty,$N-$x.resultMatrix.tx));var $v=$x.parentBone;$f=$v.resultMatrix.a,$m=$v.resultMatrix.c,$y=$v.resultMatrix.b;var $L=1/($f*($C=$v.resultMatrix.d)-$m*$y),$K=$z-$v.resultMatrix.tx,$E=$k-$v.resultMatrix.ty,$O=($K*$C-$E*$m)*$L-$a,$S=($E*$f-$K*$y)*$L-$$,$Z=(($K=$N-$v.resultMatrix.tx)*$C-($E=$D-$v.resultMatrix.ty)*$m)*$L-$a,$U=($E*$f-$K*$y)*$L-$$,$X=Math.sqrt($Z*$Z+$U*$U),$d=$I.length*$F,$j=NaN,$t=NaN;if($P){var $Y=($O*$O+$S*$S-$X*$X-($d*=$w)*$d)/(2*$X*$d);$Y<-1?$Y=-1:1<$Y&&($Y=1),$t=Math.acos($Y)*$l,$f=$X+$d*$Y,$m=$d*Math.sin($t),$j=Math.atan2($S*$f-$O*$m,$O*$f+$S*$m)}else{var $c=($f=$w*$d)*$f,$V=($m=$i*$d)*$m,$W=$O*$O+$S*$S,$q=Math.atan2($S,$O),$o=-2*$V*$X,$J=$V-$c;if(0<($C=$o*$o-4*$J*($y=$V*$X*$X+$c*$W-$c*$V))){var $h=Math.sqrt($C);$o<0&&($h=-$h);var $B=($h=-($o+$h)/2)/$J,$e=$y/$h,$A=Math.abs($B)<Math.abs($e)?$B:$e;$A*$A<=$W&&($E=Math.sqrt($W-$A*$A)*$l,$j=$q-Math.atan2($E,$A),$t=Math.atan2($E/$i,($A-$X)/$w))}var $H=0,$p=Number.MAX_VALUE,$u=0,$r=0,$g=0,$M=0,$Q=0,$G=0;$M<($C=($K=$X+$f)*$K)&&($g=0,$M=$C,$Q=$K),($C=($K=$X-$f)*$K)<$p&&($H=Math.PI,$p=$C,$u=$K);var $xx=Math.acos(-$f*$X/($c-$V));($C=($K=$f*Math.cos($xx)+$X)*$K+($E=$m*Math.sin($xx))*$E)<$p&&($H=$xx,$p=$C,$u=$K,$r=$E),$M<$C&&($g=$xx,$M=$C,$Q=$K,$G=$E),$t=$W<=($p+$M)/2?($j=$q-Math.atan2($r*$l,$u),$H*$l):($j=$q-Math.atan2($G*$l,$Q),$g*$l)}var $Ix=Math.atan2($s,$R)*$_,$zx=$x.resultTransform.skX;180<($j=($j-$Ix)*$kx.radDeg+$b-$zx)?$j-=360:$j<-180&&($j+=360),$x.resultTransform.x=$a,$x.resultTransform.y=$$,$x.resultTransform.skX=$x.resultTransform.skY=$zx+$j*$n,$zx=$I.resultTransform.skX,180<($t=(($t+$Ix)*$kx.radDeg-0)*$_+$T-($zx%=360))?$t-=360:$t<-180&&($t+=360),$I.resultTransform.x=$R,$I.resultTransform.y=$s,$I.resultTransform.skX=$I.resultTransform.skY=$I.resultTransform.skY+$t*$n,$x.update()}},$x._applyIk3=function($x,$I,$z,$k,$l,$n){if(0!=$n){var $a,$$,$w=$I.resultMatrix.a*$I.length,$i=$I.resultMatrix.b*$I.length,$F=$w*$w+$i*$i,$b=Math.sqrt($F),$T=$x.resultMatrix.tx,$_=$x.resultMatrix.ty,$R=$I.resultMatrix.tx,$s=$I.resultMatrix.ty,$N=$R-$T,$D=$s-$_,$f=$N*$N+$D*$D,$m=Math.sqrt($f),$y=($N=$z-$x.resultMatrix.tx)*$N+($D=$k-$x.resultMatrix.ty)*$D,$C=Math.sqrt($y);if($b+$m<=$C||$C+$b<=$m||$C+$m<=$b){var $P=NaN;$R=$T+($P=$b+$m<=$C?1:-1)*($z-$T)*$m/$C,$s=$_+$P*($k-$_)*$m/$C}else{var $v=($f-$F+$y)/(2*$y),$L=Math.sqrt($f-$v*$v*$y)/$C,$K=$T+$N*$v,$E=$_+$D*$v,$O=-$D*$L,$S=$N*$L;$s=0<$l?($R=$K-$O,$E-$S):($R=$K+$O,$E+$S)}$a=$R,$$=$s,this.isDebug&&(this._sp||(this._sp=new $nx,$lx.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($T,$_,15,"#ff00ff"),this._sp.graphics.drawCircle($z,$k,15,"#ffff00"),this._sp.graphics.drawCircle($a,$$,15,"#ff00ff"));var $Z,$U;$Z=Math.atan2($$-$x.resultMatrix.ty,$a-$x.resultMatrix.tx),$x.setRotation($Z),($U=$kx._tempMatrix).identity(),$U.rotate($Z),$U.scale($x.resultMatrix.getScaleX(),$x.resultMatrix.getScaleY()),$U.translate($x.resultMatrix.tx,$x.resultMatrix.ty),$U.copyTo($x.resultMatrix),$x.updateChild();var $X,$d;$X=Math.atan2($k-$$,$z-$a),$I.setRotation($X),($d=$kx._tempMatrix).identity(),$d.rotate($X),$d.scale($I.resultMatrix.getScaleX(),$I.resultMatrix.getScaleY()),$d.translate($a,$$),$U.copyTo($I.resultMatrix),$I.updateChild()}},$I($kx,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $jx}]),$kx}(),$hx=function(){function $x(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $k($x,"laya.ani.bone.IkConstraintData"),$x}(),$y=function(){function $d($x,$I){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$x,this.position=$x.position,this.spacing=$x.spacing,this.rotateMix=$x.rotateMix,this.translateMix=$x.translateMix,this.bones=[];for(var $z=this.data.bones,$k=0,$l=$z.length;$k<$l;$k++)this.bones.push($I[$z[$k]])}$k($d,"laya.ani.bone.PathConstraint");var $x=$d.prototype;return $x.apply=function($x,$I){if(this.target){var $z=this.translateMix,$k=this.translateMix,$l=0<$k,$n=this.data.spacingMode,$a="length"==$n,$$=this.data.rotateMode,$w="tangent"==$$,$i="chainScale"==$$,$F=[],$b=this.bones.length,$T=$w?$b:$b+1,$_=[];(this._spaces=$_)[0]=this.position;var $R=this.spacing;if($i||$a)for(var $s=0,$N=$T-1;$s<$N;){var $D=this.bones[$s],$f=$D.length,$m=$f*$D.resultMatrix.a,$y=$f*$D.resultMatrix.b;$f=Math.sqrt($m*$m+$y*$y),$i&&($F[$s]=$f),$_[++$s]=$a?Math.max(0,$f+$R):$R}else for($s=1;$s<$T;$s++)$_[$s]=$R;var $C=this.computeWorldPositions(this.target,$x,$I,$T,$w,"percent"==this.data.positionMode,"percent"==$n);if(this._debugKey){for($s=0;$s<$C.length;$s++)$I.drawCircle($C[$s++],$C[$s++],5,"#00ff00");var $P=[];for($s=0;$s<$C.length;$s++)$P.push($C[$s++],$C[$s++]);$I.drawLines(0,0,$P,"#ff0000")}var $v=$C[0],$L=$C[1],$K=this.data.offsetRotation,$E="chain"==$$&&0==$K,$O=NaN;for($s=0,$O=3;$s<$b;$s++,$O+=3){($D=this.bones[$s]).resultMatrix.tx+=($v-$D.resultMatrix.tx)*$z,$D.resultMatrix.ty+=($L-$D.resultMatrix.ty)*$z;var $S=($m=$C[$O])-$v,$Z=($y=$C[$O+1])-$L;if($i&&0!=($f=$F[$s])){var $U=(Math.sqrt($S*$S+$Z*$Z)/$f-1)*$k+1;$D.resultMatrix.a*=$U,$D.resultMatrix.c*=$U}if($v=$m,$L=$y,$l){var $X=$D.resultMatrix.a,$d=$D.resultMatrix.c,$j=$D.resultMatrix.b,$t=$D.resultMatrix.d,$Y=NaN,$c=NaN,$V=NaN;$Y=$w?$C[$O-1]:0==$_[$s+1]?$C[$O+2]:Math.atan2($Z,$S),$Y-=Math.atan2($j,$X)-$K/180*Math.PI,$E&&($c=Math.cos($Y),$V=Math.sin($Y),$v+=(($f=$D.length)*($c*$X-$V*$j)-$S)*$k,$L+=($f*($V*$X+$c*$j)-$Z)*$k),$Y>Math.PI?$Y-=2*Math.PI:$Y<-Math.PI&&($Y+=2*Math.PI),$Y*=$k,$c=Math.cos($Y),$V=Math.sin($Y),$D.resultMatrix.a=$c*$X-$V*$j,$D.resultMatrix.c=$c*$d-$V*$t,$D.resultMatrix.b=$V*$X+$c*$j,$D.resultMatrix.d=$V*$d+$c*$t}}}},$x.computeWorldVertices2=function($x,$I,$z,$k,$l,$n){var $a,$$,$w=$x.currDisplayData.bones,$i=$x.currDisplayData.weights,$F=$x.currDisplayData.triangles,$b=0,$T=0,$_=0,$R=0,$s=0,$N=0,$D=0,$f=0,$m=0,$y=0,$C=0;if(null!=$w){for($b=0;$b<$z;$b+=2)$T+=($R=$w[$T])+1,$_+=$R;var $P=$I;for($s=$n,$N=3*$_;$s<$k;$s+=2){for($f=$D=0,$R=$w[$T++],$R+=$T;$T<$R;$T++,$N+=3){$a=$P[$w[$T]].resultMatrix,$m=$i[$N],$y=$i[$N+1];var $v=$i[$N+2];$D+=($m*$a.a+$y*$a.c+$a.tx)*$v,$f+=($m*$a.b+$y*$a.d+$a.ty)*$v}$l[$s]=$D,$l[$s+1]=$f}}else{var $L,$K;if($F||($F=$i),$x.deformData&&($F=$x.deformData),$L=$x.parent,$I)for($C=$I.length,$b=0;$b<$C;$b++)if($I[$b].name==$L){$$=$I[$b];break}$$&&($K=$$.resultMatrix),$K||($K=$d._tempMt);var $E=$K.tx,$O=$K.ty,$S=$K.a,$Z=$K.b,$U=$K.c,$X=$K.d;for($$&&($X*=$$.d),$T=$z,$s=$n;$s<$k;$T+=2,$s+=2)$m=$F[$T],$y=$F[$T+1],$l[$s]=$m*$S+$y*$Z+$E,$l[$s+1]=-($m*$U+$y*$X+$O)}},$x.computeWorldPositions=function($x,$I,$z,$k,$l,$n,$a){$x.currDisplayData.bones,$x.currDisplayData.weights,$x.currDisplayData.triangles;var $$=[],$w=0,$i=$x.currDisplayData.verLen,$F=this.position,$b=this._spaces,$T=[],$_=[],$R=$i/6,$s=-1,$N=NaN,$D=0,$f=0,$m=NaN,$y=NaN,$C=NaN,$P=NaN;if($R--,$i-=4,this.computeWorldVertices2($x,$I,2,$i,$$,0),this._debugKey)for($w=0;$w<$$.length;)$z.drawCircle($$[$w++],$$[$w++],10,"#ff0000");$T=$$,this._curves.length=$R;var $v=this._curves,$L=$T[$N=0],$K=$T[1],$E=0,$O=0,$S=0,$Z=0,$U=0,$X=0,$d=NaN,$j=NaN,$t=NaN,$Y=NaN,$c=NaN,$V=NaN,$W=NaN,$q=NaN,$o=0;for($w=0,$o=2;$w<$R;$w++,$o+=6)$E=$T[$o],$O=$T[$o+1],$S=$T[$o+2],$Z=$T[$o+3],$c=2*($d=.1875*($L-2*$E+$S))+($t=.09375*(3*($E-$S)-$L+($U=$T[$o+4]))),$V=2*($j=.1875*($K-2*$O+$Z))+($Y=.09375*(3*($O-$Z)-$K+($X=$T[$o+5]))),$W=.75*($E-$L)+$d+.16666667*$t,$q=.75*($O-$K)+$j+.16666667*$Y,$N+=Math.sqrt($W*$W+$q*$q),$W+=$c,$q+=$V,$c+=$t,$V+=$Y,$N+=Math.sqrt($W*$W+$q*$q),$W+=$c,$q+=$V,$N+=Math.sqrt($W*$W+$q*$q),$W+=$c+$t,$q+=$V+$Y,$N+=Math.sqrt($W*$W+$q*$q),$v[$w]=$N,$L=$U,$K=$X;if($n&&($F*=$N),$a)for($w=0;$w<$k;$w++)$b[$w]*=$N;var $J=this._segments,$h=0,$B=0;for($B=$f=$D=$w=0;$w<$k;$w++,$D+=3)if(($m=$F+=$y=$b[$w])<0)this.addBeforePosition($m,$T,0,$_,$D);else if($N<$m)this.addAfterPosition($m-$N,$T,$i-4,$_,$D);else{for(;;$f++)if(!(($P=$v[$f])<$m)){0==$f?$m/=$P:$m=($m-($C=$v[$f-1]))/($P-$C);break}if($f!=$s){var $e=6*($s=$f);for($L=$T[$e],$K=$T[$e+1],$E=$T[$e+2],$O=$T[$e+3],$S=$T[$e+4],$Z=$T[$e+5],$c=2*($d=.03*($L-2*$E+$S))+($t=.006*(3*($E-$S)-$L+($U=$T[$e+6]))),$V=2*($j=.03*($K-2*$O+$Z))+($Y=.006*(3*($O-$Z)-$K+($X=$T[$e+7]))),$W=.3*($E-$L)+$d+.16666667*$t,$q=.3*($O-$K)+$j+.16666667*$Y,$h=Math.sqrt($W*$W+$q*$q),$J[0]=$h,$e=1;$e<8;$e++)$W+=$c,$q+=$V,$c+=$t,$V+=$Y,$h+=Math.sqrt($W*$W+$q*$q),$J[$e]=$h;$W+=$c,$q+=$V,$h+=Math.sqrt($W*$W+$q*$q),$J[8]=$h,$W+=$c+$t,$q+=$V+$Y,$h+=Math.sqrt($W*$W+$q*$q),$J[9]=$h,$B=0}for($m*=$h;;$B++)if(!(($P=$J[$B])<$m)){0==$B?$m/=$P:$m=$B+($m-($C=$J[$B-1]))/($P-$C);break}this.addCurvePosition(.1*$m,$L,$K,$E,$O,$S,$Z,$U,$X,$_,$D,$l||0<$w&&0==$y)}return $_},$x.addBeforePosition=function($x,$I,$z,$k,$l){var $n=$I[$z],$a=$I[$z+1],$$=$I[$z+2]-$n,$w=$I[$z+3]-$a,$i=Math.atan2($w,$$);$k[$l]=$n+$x*Math.cos($i),$k[$l+1]=$a+$x*Math.sin($i),$k[$l+2]=$i},$x.addAfterPosition=function($x,$I,$z,$k,$l){var $n=$I[$z+2],$a=$I[$z+3],$$=$n-$I[$z],$w=$a-$I[$z+1],$i=Math.atan2($w,$$);$k[$l]=$n+$x*Math.cos($i),$k[$l+1]=$a+$x*Math.sin($i),$k[$l+2]=$i},$x.addCurvePosition=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F,$b){0==$x&&($x=1e-4);var $T=$x*$x,$_=$T*$x,$R=1-$x,$s=$R*$R,$N=$s*$R,$D=$R*$x,$f=3*$D,$m=$R*$f,$y=$f*$x,$C=$I*$N+$k*$m+$n*$y+$$*$_,$P=$z*$N+$l*$m+$a*$y+$w*$_;$i[$F]=$C,$i[$F+1]=$P,$i[$F+2]=$b?Math.atan2($P-($z*$s+$l*$D*2+$a*$T),$C-($I*$s+$k*$D*2+$n*$T)):0},$d.NONE=-1,$d.BEFORE=-2,$d.AFTER=-3,$I($d,["_tempMt",function(){return this._tempMt=new $jx}]),$d}(),$Bx=function(){function $x(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $k($x,"laya.ani.bone.PathConstraintData"),$x}(),$ex=function(){function $x(){this.name=null,this.slotArr=[]}return $k($x,"laya.ani.bone.SkinData"),$x}(),$Ax=function(){function $x(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$k($x,"laya.ani.bone.SkinSlotDisplayData");var $I=$x.prototype;return $I.createTexture=function($x){return this.texture||(this.texture=new $tx($x.bitmap,this.uvs),$x.bitmap.alphaTexture&&(this.texture.alphaTexture=new $tx($x.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$x.height,this.texture.height=$x.width,this.texture.offsetX=-$x.offsetX,this.texture.offsetY=-$x.offsetY,this.texture.sourceWidth=$x.sourceHeight,this.texture.sourceHeight=$x.sourceWidth):(this.texture.width=$x.width,this.texture.height=$x.height,this.texture.offsetX=-$x.offsetX,this.texture.offsetY=-$x.offsetY,this.texture.sourceWidth=$x.sourceWidth,this.texture.sourceHeight=$x.sourceHeight),$N.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$I.destory=function(){this.texture&&this.texture.destroy()},$x}(),$Hx=function(){function $x(){this.name=null,this.displayArr=[]}return $k($x,"laya.ani.bone.SlotData"),$x.prototype.getDisplayByName=function($x){for(var $I=0,$z=this.displayArr.length;$I<$z;$I++)if(this.displayArr[$I].attachmentName==$x)return $I;return-1},$x}(),$C=function(){function $x($x,$I){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$s(2,0),this._data=$x,null==this._bones&&(this._bones=[]),this.target=$I[$x.targetIndex];var $z,$k=0;for($k=0,$z=$x.boneIndexs.length;$k<$z;$k++)this._bones.push($I[$x.boneIndexs[$k]]);this.rotateMix=$x.rotateMix,this.translateMix=$x.translateMix,this.scaleMix=$x.scaleMix,this.shearMix=$x.shearMix}return $k($x,"laya.ani.bone.TfConstraint"),$x.prototype.apply=function(){for(var $x,$I=this.target.resultMatrix.a,$z=this.target.resultMatrix.b,$k=this.target.resultMatrix.c,$l=this.target.resultMatrix.d,$n=0,$a=this._bones.length;$n<$a;$n++){if($x=this._bones[$n],0<this.rotateMix){var $$=$x.resultMatrix.a,$w=$x.resultMatrix.b,$i=$x.resultMatrix.c,$F=$x.resultMatrix.d,$b=Math.atan2($k,$I)-Math.atan2($i,$$)+this._data.offsetRotation*Math.PI/180;$b>Math.PI?$b-=2*Math.PI:$b<-Math.PI&&($b+=2*Math.PI),$b*=this.rotateMix;var $T=Math.cos($b),$_=Math.sin($b);$x.resultMatrix.a=$T*$$-$_*$i,$x.resultMatrix.b=$T*$w-$_*$F,$x.resultMatrix.c=$_*$$+$T*$i,$x.resultMatrix.d=$_*$w+$T*$F}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$x.resultMatrix.tx+=(this._temp[0]-$x.resultMatrix.tx)*this.translateMix,$x.resultMatrix.ty+=(this._temp[1]-$x.resultMatrix.ty)*this.translateMix,$x.updateChild()),0<this.scaleMix){var $R=Math.sqrt($x.resultMatrix.a*$x.resultMatrix.a+$x.resultMatrix.c*$x.resultMatrix.c),$s=Math.sqrt($I*$I+$k*$k),$N=1e-5<$R?($R+($s-$R+this._data.offsetScaleX)*this.scaleMix)/$R:0;$x.resultMatrix.a*=$N,$x.resultMatrix.c*=$N,$R=Math.sqrt($x.resultMatrix.b*$x.resultMatrix.b+$x.resultMatrix.d*$x.resultMatrix.d),$s=Math.sqrt($z*$z+$l*$l),$N=1e-5<$R?($R+($s-$R+this._data.offsetScaleY)*this.scaleMix)/$R:0,$x.resultMatrix.b*=$N,$x.resultMatrix.d*=$N}if(0<this.shearMix){$w=$x.resultMatrix.b,$F=$x.resultMatrix.d;var $D=Math.atan2($F,$w);($b=Math.atan2($l,$z)-Math.atan2($k,$I)-($D-Math.atan2($x.resultMatrix.c,$x.resultMatrix.a)))>Math.PI?$b-=2*Math.PI:$b<-Math.PI&&($b+=2*Math.PI),$b=$D+($b+this._data.offsetShearY*Math.PI/180)*this.shearMix,$N=Math.sqrt($w*$w+$F*$F),$x.resultMatrix.b=Math.cos($b)*$N,$x.resultMatrix.d=Math.sin($b)*$N}}},$x}(),$px=function(){function $x(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $k($x,"laya.ani.bone.TfConstraintData"),$x}(),$ux=function(){function $x(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$k($x,"laya.ani.bone.Transform");var $I=$x.prototype;return $I.initData=function($x){null!=$x.x&&(this.x=$x.x),null!=$x.y&&(this.y=$x.y),null!=$x.skX&&(this.skX=$x.skX),null!=$x.skY&&(this.skY=$x.skY),null!=$x.scX&&(this.scX=$x.scX),null!=$x.scY&&(this.scY=$x.scY)},$I.getMatrix=function(){var $x;return($x=this.mMatrix?this.mMatrix:this.mMatrix=new $jx).identity(),$x.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($x,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$x.rotate(this.skX*Math.PI/180),$x.translate(this.x,this.y),$x},$I.skew=function($x,$I,$z){var $k=Math.sin($z),$l=Math.cos($z),$n=Math.sin($I),$a=Math.cos($I);return $x.setTo($x.a*$a-$x.b*$k,$x.a*$n+$x.b*$l,$x.c*$a-$x.d*$k,$x.c*$n+$x.d*$l,$x.tx*$a-$x.ty*$k,$x.tx*$n+$x.ty*$l),$x},$x}(),$P=function(){function $x(){}return $k($x,"laya.ani.bone.UVTools"),$x.getRelativeUV=function($x,$I,$z){var $k=$x[0],$l=$x[2]-$x[0],$n=$x[1],$a=$x[5]-$x[1];$z||($z=[]),$z.length=$I.length;var $$,$w=0;$$=$z.length;var $i=1/$l,$F=1/$a;for($w=0;$w<$$;$w+=2)$z[$w]=($I[$w]-$k)*$i,$z[$w+1]=($I[$w+1]-$n)*$F;return $z},$x.getAbsoluteUV=function($x,$I,$z){if(0==$x[0]&&0==$x[1]&&1==$x[4]&&1==$x[5])return $z?($R.copyArray($z,$I),$z):$I;var $k=$x[0],$l=$x[2]-$x[0],$n=$x[1],$a=$x[5]-$x[1];$z||($z=[]),$z.length=$I.length;var $$,$w=0;for($$=$z.length,$w=0;$w<$$;$w+=2)$z[$w]=$I[$w]*$l+$k,$z[$w+1]=$I[$w+1]*$a+$n;return $z},$x}(),$d=function(){function $x(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $k($x,"laya.ani.KeyFramesContent"),$x}(),$v=function(){function $F(){}return $k($F,"laya.ani.math.BezierLerp"),$F.getBezierRate=function($x,$I,$z,$k,$l){var $n=$F._getBezierParamKey($I,$z,$k,$l),$a=100*$n+$x;if($F._bezierResultCache[$a])return $F._bezierResultCache[$a];var $$,$w=$F._getBezierPoints($I,$z,$k,$l,$n),$i=0;for($$=$w.length,$i=0;$i<$$;$i+=2)if($x<=$w[$i])return $F._bezierResultCache[$a]=$w[$i+1],$w[$i+1];return $F._bezierResultCache[$a]=1},$F._getBezierParamKey=function($x,$I,$z,$k){return 100*(100*(100*(100*$x+$I)+$z)+$k)},$F._getBezierPoints=function($x,$I,$z,$k,$l){return $F._bezierPointsCache[$l]?$F._bezierPointsCache[$l]:($n=[0,0,$x,$I,$z,$k,1,1],$a=(new $$).getBezierPoints($n,100,3),$F._bezierPointsCache[$l]=$a);var $n,$a},$F._bezierResultCache={},$F._bezierPointsCache={},$F}(),$L=function($x){function $I(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$I.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$k($I,"laya.ani.AnimationPlayer",$l);var $z=$I.prototype;return $lx.imps($z,{"laya.resource.IDestroy":!0}),$z._onTempletLoadedComputeFullKeyframeIndices=function($x,$I,$z){this._templet===$z&&this._cachePlayRate===$x&&this._cacheFrameRate===$I&&this._computeFullKeyframeIndices()},$z._computeFullKeyframeIndices=function(){for(var $x=this._fullFrames=[],$I=this._templet,$z=this._cacheFrameRateInterval*this._cachePlayRate,$k=0,$l=$I.getAnimationCount();$k<$l;$k++){for(var $n=[],$a=0,$$=$I.getAnimation($k).nodes.length;$a<$$;$a++){for(var $w=$I.getAnimation($k).nodes[$a],$i=Math.floor($w.playTime/$z+.01),$F=new Uint16Array($i+1),$b=-1,$T=0,$_=$w.keyFrame.length;$T<$_;$T++){var $R=$w.keyFrame[$T],$s=$R.startTime,$N=$s+$R.duration+$z;do{for(var $D=Math.floor($s/$z+.5),$f=$b+1;$f<$D;$f++)$F[$f]=$T;$F[$b=$D]=$T,$s+=$z}while($s<=$N)}$n.push($F)}$x.push($n)}},$z._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$z._calculatePlayDuration=function(){if(0!==this.state){var $x=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$x),this._playEnd>$x&&(this._playEnd=$x),this._playDuration=this._playEnd-this._playStart}},$z._setPlayParams=function($x,$I){this._currentTime=$x,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$I+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$I},$z._setPlayParamsWhenStop=function($x,$I){this._currentTime=$x,this._currentKeyframeIndex=Math.max(Math.floor($x/$I+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$I,this._currentAnimationClipIndex=-1},$z._update=function($x){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $I=this._cacheFrameRateInterval*this._cachePlayRate,$z=0;this._startUpdateLoopCount!==$_.loopCount&&($z=$x*this.playbackRate,this._elapsedPlaybackTime+=$z);var $k=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$k)return this._setPlayParamsWhenStop($k,$I),void this.event("stopped");if($z+=this._currentTime,0<$k)if($k<=$z)do{if($z-=$k,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($k,$I),this._stopWhenCircleFinish=!1,void this.event("stopped");$z<$k&&(this._setPlayParams($z,$I),this.event("complete"))}while($k<=$z);else this._setPlayParams($z,$I);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($k,$I),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$z._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$z.play=function($x,$I,$z,$k,$l){if(void 0===$x&&($x=0),void 0===$I&&($I=1),void 0===$z&&($z=2147483647),void 0===$k&&($k=0),void 0===$l&&($l=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($z<0||$k<0||$l<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$l&&$l<$k)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$I,this._overallDuration=$z,this._playStart=$k,this._playEnd=$l,this._paused=!1,this._currentAnimationClipIndex=$x,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$_.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$z.playByFrame=function($x,$I,$z,$k,$l,$n){void 0===$x&&($x=0),void 0===$I&&($I=1),void 0===$z&&($z=2147483647),void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$n&&($n=30);var $a=1e3/$n;this.play($x,$I,$z,$k*$a,$l*$a)},$z.stop=function($x){void 0===$x&&($x=!0),$x?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$n(0,$z,"playEnd",function(){return this._playEnd}),$n(0,$z,"templet",function(){return this._templet},function($x){0===!this.state&&this.stop(!0),this._templet!==$x&&((this._templet=$x).loaded?this._computeFullKeyframeIndices():$x.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$n(0,$z,"playStart",function(){return this._playStart}),$n(0,$z,"playDuration",function(){return this._playDuration}),$n(0,$z,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$n(0,$z,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$n(0,$z,"overallDuration",function(){return this._overallDuration}),$n(0,$z,"currentFrameTime",function(){return this._currentFrameTime}),$n(0,$z,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$n(0,$z,"currentPlayTime",function(){return this._currentTime+this._playStart}),$n(0,$z,"cachePlayRate",function(){return this._cachePlayRate},function($x){this._cachePlayRate!==$x&&(this._cachePlayRate=$x,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$x,this._cacheFrameRate])))}),$n(0,$z,"cacheFrameRate",function(){return this._cacheFrameRate},function($x){this._cacheFrameRate!==$x&&(this._cacheFrameRate=$x,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$x])))}),$n(0,$z,"currentTime",null,function($x){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($x<this._playStart||$x>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$_.loopCount;var $I=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$x,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$I),0),this._currentFrameTime=this._currentKeyframeIndex*$I}}),$n(0,$z,"paused",function(){return this._paused},function($x){(this._paused=$x)&&this.event("paused")}),$n(0,$z,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$n(0,$z,"destroyed",function(){return this._destroyed}),$I}(),$j=function($x){function $I(){$I.__super.call(this),$N.isConchNode&&(this.drawSkin=function($x){$x.transform||($x.transform=$jx.EMPTY),this._addCmd([$x]),this.setSkinMesh&&this.setSkinMesh($x._ps,$x.mVBData,$x.mEleNum,0,$x.mTexture,$x.transform)})}return $k($I,"laya.ani.GraphicsAni",$z),$I.prototype.drawSkin=function($x){var $I=[$x];this._saveToCmd($N._context._drawSkin,$I)},$I.create=function(){return $I._caches.pop()||new $I},$I.recycle=function($x){$x.clear(),$I._caches.push($x)},$I._caches=[],$I}(),$t=function($x){function $f(){this._aniMap={},this.unfixedLastAniIndex=-1,$f.__super.call(this),this._anis=new Array}$k($f,"laya.ani.AnimationTemplet",$i);var $I=$f.prototype;return $I.parse=function($x){var $I=new $dx($x);this._aniVersion=$I.readUTFString(),$D.parse(this,$I)},$I._calculateKeyFrame=function($x,$I,$z){var $k=$x.keyFrame;$k[$I]=$k[0];for(var $l=0;$l<$I;$l++){var $n=$k[$l];$n.nextData=0===$n.duration?$n.data:$k[$l+1].data}$k.length--},$I.onAsynLoaded=function($x,$I,$z){var $k=new $dx($I);switch(this._aniVersion=$k.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$m.parse(this,$k);break;default:$D.parse(this,$k)}this._endLoaded()},$I.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$I.getAnimationCount=function(){return this._anis.length},$I.getAnimation=function($x){return this._anis[$x]},$I.getAniDuration=function($x){return this._anis[$x].playTime},$I.getNodes=function($x){return this._anis[$x].nodes},$I.getNodeIndexWithName=function($x,$I){return this._anis[$x].bone3DMap[$I]},$I.getNodeCount=function($x){return this._anis[$x].nodes.length},$I.getTotalkeyframesLength=function($x){return this._anis[$x].totalKeyframeDatasLength},$I.getPublicExtData=function(){return this._publicExtData},$I.getAnimationDataWithCache=function($x,$I,$z,$k){var $l=$I[$z];if($l){var $n=$l[$x];return $n?$n[$k]:null}return null},$I.setAnimationDataWithCache=function($x,$I,$z,$k,$l){var $n=$I[$z]||($I[$z]={});($n[$x]||($n[$x]=[]))[$k]=$l},$I.getOriginalData=function($x,$I,$z,$k,$l){for(var $n=this._anis[$x].nodes,$a=0,$$=0,$w=$n.length,$i=0;$$<$w;$$++){var $F,$b=$n[$$];$F=$b.keyFrame[$z[$$][$k]],$b.dataOffset=$i;var $T=$l-$F.startTime,$_=$b.lerpType;if($_)switch($_){case 0:case 1:for($a=0;$a<$b.keyframeWidth;)$a+=$b.interpolationMethod[$a]($b,$a,$I,$i+$a,$F.data,$T,null,$F.duration,$F.nextData);break;case 2:var $R=$F.interpolationData,$s=$R.length,$N=0;for($a=0;$a<$s;){var $D=$R[$a];switch($D){case 6:case 7:$a+=$f.interpolation[$D]($b,$N,$I,$i+$N,$F.data,$T,null,$F.duration,$F.nextData,$R,$a+1);break;default:$a+=$f.interpolation[$D]($b,$N,$I,$i+$N,$F.data,$T,null,$F.duration,$F.nextData)}$N++}}else for($a=0;$a<$b.keyframeWidth;)$a+=$b.interpolationMethod[$a]($b,$a,$I,$i+$a,$F.data,$T,null,$F.duration,$F.nextData);$i+=$b.keyframeWidth}},$I.getNodesCurrentFrameIndex=function($x,$I){var $z=this._anis[$x].nodes;$x!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($z.length),this.unfixedCurrentTimes=new Float32Array($z.length),this.unfixedLastAniIndex=$x);for(var $k=0,$l=$z.length;$k<$l;$k++){var $n=$z[$k];for($I<this.unfixedCurrentTimes[$k]&&(this.unfixedCurrentFrameIndexes[$k]=0),this.unfixedCurrentTimes[$k]=$I;this.unfixedCurrentFrameIndexes[$k]<$n.keyFrame.length&&!($n.keyFrame[this.unfixedCurrentFrameIndexes[$k]].startTime>this.unfixedCurrentTimes[$k]);)this.unfixedCurrentFrameIndexes[$k]++;this.unfixedCurrentFrameIndexes[$k]--}return this.unfixedCurrentFrameIndexes},$I.getOriginalDataUnfixedRate=function($x,$I,$z){var $k=this._anis[$x].nodes;$x!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($k.length),this.unfixedCurrentTimes=new Float32Array($k.length),this.unfixedKeyframes=$s($k.length),this.unfixedLastAniIndex=$x);for(var $l=0,$n=0,$a=$k.length,$$=0;$n<$a;$n++){var $w=$k[$n];for($z<this.unfixedCurrentTimes[$n]&&(this.unfixedCurrentFrameIndexes[$n]=0),this.unfixedCurrentTimes[$n]=$z;this.unfixedCurrentFrameIndexes[$n]<$w.keyFrame.length&&!($w.keyFrame[this.unfixedCurrentFrameIndexes[$n]].startTime>this.unfixedCurrentTimes[$n]);)this.unfixedKeyframes[$n]=$w.keyFrame[this.unfixedCurrentFrameIndexes[$n]],this.unfixedCurrentFrameIndexes[$n]++;var $i=this.unfixedKeyframes[$n];$w.dataOffset=$$;var $F=$z-$i.startTime;if($w.lerpType)switch($w.lerpType){case 0:case 1:for($l=0;$l<$w.keyframeWidth;)$l+=$w.interpolationMethod[$l]($w,$l,$I,$$+$l,$i.data,$F,null,$i.duration,$i.nextData);break;case 2:var $b=$i.interpolationData,$T=$b.length,$_=0;for($l=0;$l<$T;){var $R=$b[$l];switch($R){case 6:case 7:$l+=$f.interpolation[$R]($w,$_,$I,$$+$_,$i.data,$F,null,$i.duration,$i.nextData,$b,$l+1);break;default:$l+=$f.interpolation[$R]($w,$_,$I,$$+$_,$i.data,$F,null,$i.duration,$i.nextData)}$_++}}else for($l=0;$l<$w.keyframeWidth;)$l+=$w.interpolationMethod[$l]($w,$l,$I,$$+$l,$i.data,$F,null,$i.duration,$i.nextData);$$+=$w.keyframeWidth}},$f._LinearInterpolation_0=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){var $F=0===$$?0:$n/$$;return $z[$k]=(1-$F)*$l[$I]+$F*$w[$I],1},$f._QuaternionInterpolation_1=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){var $F=0===$$?0:$n/$$;return $T.slerpQuaternionArray($l,$I,$w,$I,$F,$z,$k),4},$f._AngleInterpolation_2=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){return 0},$f._RadiansInterpolation_3=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){return 0},$f._Matrix4x4Interpolation_4=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){for(var $F=0;$F<16;$F++,$I++)$z[$k+$F]=$l[$I]+$n*$a[$I];return 16},$f._NoInterpolation_5=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){return $z[$k]=$l[$I],1},$f._BezierInterpolation_6=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F){return void 0===$F&&($F=0),$z[$k]=$l[$I]+($w[$I]-$l[$I])*$v.getBezierRate($n/$$,$i[$F],$i[$F+1],$i[$F+2],$i[$F+3]),5},$f._BezierInterpolation_7=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i,$F){return void 0===$F&&($F=0),$z[$k]=$i[$F+4]+$i[$F+5]*$v.getBezierRate((.001*$n+$i[$F+6])/$i[$F+7],$i[$F],$i[$F+1],$i[$F+2],$i[$F+3]),9},$f.load=function($x){return $lx.loader.create($x,null,null,$f)},$f.interpolation=[$f._LinearInterpolation_0,$f._QuaternionInterpolation_1,$f._AngleInterpolation_2,$f._RadiansInterpolation_3,$f._Matrix4x4Interpolation_4,$f._NoInterpolation_5,$f._BezierInterpolation_6,$f._BezierInterpolation_7],$f}(),$K=function($I){function $z($x,$I){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$z.__super.call(this),void 0===$I&&($I=0),$x&&this.init($x,$I)}$k($z,"laya.ani.bone.Skeleton",$I);var $x=$z.prototype;return $x.init=function($x,$I){void 0===$I&&($I=0);var $z,$k,$l,$n=0,$a=0;if(1==$I)for(this._graphicsCache=[],$n=0,$a=$x.getAnimationCount();$n<$a;$n++)this._graphicsCache.push([]);if(this._yReverseMatrix=$x.yReverseMatrix,this._aniMode=$I,this._templet=$x,this._player=new $L,this._player.cacheFrameRate=$x.rate,this._player.templet=$x,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$x.mBoneArr,this._rootBone=$x.mRootBone,this._aniSectionDic=$x.aniSectionDic,0<$x.ikArr.length)for(this._ikArr=[],$n=0,$a=$x.ikArr.length;$n<$a;$n++)this._ikArr.push(new $f($x.ikArr[$n],this._boneList));if(0<$x.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$n=0,$a=$x.pathArr.length;$n<$a;$n++)$z=$x.pathArr[$n],$k=new $y($z,this._boneList),($l=this._boneSlotDic[$z.name])&&(($k=new $y($z,this._boneList)).target=$l),this._pathDic[$z.name]=$k;if(0<$x.tfArr.length)for(this._tfArr=[],$n=0,$a=$x.tfArr.length;$n<$a;$n++)this._tfArr.push(new $C($x.tfArr[$n],this._boneList));if(0<$x.skinDataArray.length){var $$=this._templet.skinDataArray[this._skinIndex];this._skinName=$$.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$x.load=function($x,$I,$z){},$x._onLoaded=function(){},$x._parseComplete=function(){var $x=$E.TEMPLET_DICTIONARY[this._aniPath];$x&&(this.init($x,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$x._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$x._onPlay=function(){this.event("played")},$x._onStop=function(){var $x,$I=this._templet.eventAniArr[this._aniClipIndex];if($I&&this._eventIndex<$I.length)for(;this._eventIndex<$I.length;this._eventIndex++)($x=$I[this._eventIndex]).time>=this._player.playStart&&$x.time<=this._player.playEnd&&this.event("label",$x);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$x._onPause=function(){this.event("paused")},$x._parseSrcBoneMatrix=function(){var $x=0,$I=0;for($I=this._templet.srcBoneMatrixArr.length,$x=0;$x<$I;$x++)this._boneMatrixArray.push(new $jx);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $z,$k,$l=this._templet.boneSlotArray;for($x=0,$I=$l.length;$x<$I;$x++)$z=$l[$x],null==($k=this._bindBoneBoneSlotDic[$z.parent])&&(this._bindBoneBoneSlotDic[$z.parent]=$k=[]),this._boneSlotDic[$z.name]=$z=$z.copy(),$k.push($z),this._boneSlotArray.push($z)}},$x._emitMissedEvents=function($x,$I,$z){void 0===$z&&($z=0);var $k=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($k){var $l,$n,$a=0;for($l=$k.length,$a=$z;$a<$l;$a++)($n=$k[$a]).time>=this._player.playStart&&$n.time<=this._player.playEnd&&this.event("label",$n)}},$x._update=function($x){if(void 0===$x&&($x=!0),!(this._pause||$x&&this._indexControl)){var $I=this.timer.currTimer,$z=this._player.currentKeyframeIndex,$k=$I-this._lastTime;if($x?this._player._update($k):$z=-1,this._lastTime=$I,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$k&&this._clipIndex==$z&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $l;this._lastUpdateAniClipIndex=this._aniClipIndex,$z>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $n,$a=this._templet.eventAniArr[this._aniClipIndex];if($a&&this._eventIndex<$a.length&&(($l=$a[this._eventIndex]).time>=this._player.playStart&&$l.time<=this._player.playEnd?this._player.currentPlayTime>=$l.time&&(this.event("label",$l),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($n=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$n&&(this.graphics=$n));var $$=0,$w=0;for($w=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$w-1)&&0<$w;)$w--;if($w<this._clipIndex)for($$=$w;$$<this._clipIndex;$$++)this._createGraphics($$)}else if(1==this._aniMode){if($n=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$n&&(this.graphics=$n));for($w=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$w-1)&&0<$w;)$w--;if($w<this._clipIndex)for($$=$w;$$<this._clipIndex;$$++)this._createGraphics($$)}this._createGraphics()}}},$x._createGraphics=function($x){void 0===$x&&($x=-1),-1==$x&&($x=this._clipIndex);var $I,$z,$k=$x*this._player.cacheFrameRateInterval,$l=this._templet.drawOrderAniArr[this._aniClipIndex];if($l&&0<$l.length)for(this._drawOrderIndex=0,$I=$l[this._drawOrderIndex];$k>=$I.time&&(this._drawOrder=$I.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$l.length));)$I=$l[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$j.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$j.create(),$z=this.graphics;var $n=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$x,$k);var $a,$$,$w,$i,$F=this._aniSectionDic[this._aniClipIndex],$b=0,$T=0,$_=0,$R=0,$s=0,$N=this._templet.srcBoneMatrixArr.length;for($s=$F[$T=0];$T<$N;$T++)$i=this._boneList[$T],$w=this._templet.srcBoneMatrixArr[$T],$i.resultTransform.scX=$w.scX*this._curOriginalData[$b++],$i.resultTransform.skX=$w.skX+this._curOriginalData[$b++],$i.resultTransform.skY=$w.skY+this._curOriginalData[$b++],$i.resultTransform.scY=$w.scY*this._curOriginalData[$b++],$i.resultTransform.x=$w.x+this._curOriginalData[$b++],$i.resultTransform.y=$w.y+this._curOriginalData[$b++],8===this._templet.tMatrixDataLen&&($i.resultTransform.skewX=$w.skewX+this._curOriginalData[$b++],$i.resultTransform.skewY=$w.skewY+this._curOriginalData[$b++]);var $D,$f={},$m={};for($s+=$F[1];$T<$s;$T++)$f[($D=$n[$T]).name]=this._curOriginalData[$b++],$m[$D.name]=this._curOriginalData[$b++],this._curOriginalData[$b++],this._curOriginalData[$b++],this._curOriginalData[$b++],this._curOriginalData[$b++];var $y,$C,$P={},$v={};for($s+=$F[2];$T<$s;$T++)$P[($D=$n[$T]).name]=this._curOriginalData[$b++],$v[$D.name]=this._curOriginalData[$b++],this._curOriginalData[$b++],this._curOriginalData[$b++],this._curOriginalData[$b++],this._curOriginalData[$b++];if(this._pathDic)for($s+=$F[3];$T<$s;$T++){if($D=$n[$T],$y=this._pathDic[$D.name])switch(new $dx($D.extenData).getByte()){case 1:$y.position=this._curOriginalData[$b++];break;case 2:$y.spacing=this._curOriginalData[$b++];break;case 3:$y.rotateMix=this._curOriginalData[$b++],$y.translateMix=this._curOriginalData[$b++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($jx.TEMP.identity()),this._ikArr)for($T=0,$s=this._ikArr.length;$T<$s;$T++)$C=this._ikArr[$T],$P.hasOwnProperty($C.name)&&($C.bendDirection=$P[$C.name]),$v.hasOwnProperty($C.name)&&($C.mix=$v[$C.name]),$C.apply();if(this._pathDic)for(var $L in this._pathDic)($y=this._pathDic[$L]).apply(this._boneList,$z);if(this._tfArr)for($T=0,$R=this._tfArr.length;$T<$R;$T++)this._tfArr[$T].apply();for($T=0,$R=this._boneList.length;$T<$R;$T++)if($i=this._boneList[$T],$$=this._bindBoneBoneSlotDic[$i.name],$i.resultMatrix.copyTo(this._boneMatrixArray[$T]),$$)for($_=0,$s=$$.length;$_<$s;$_++)($a=$$[$_])&&$a.setParentMatrix($i.resultMatrix);var $K,$E,$O,$S,$Z={},$U=this._templet.deformAniArr;if($U&&0<$U.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$T=0,$s=this._boneSlotArray.length;$T<$s;$T++)($a=this._boneSlotArray[$T]).deformData=null;var $X,$d=$U[this._aniClipIndex];for($X in $K=$d.default,this._setDeform($K,$Z,this._boneSlotArray,$k),$d)"default"!=$X&&$X!=this._skinName&&($K=$d[$X],this._setDeform($K,$Z,this._boneSlotArray,$k));$K=$d[this._skinName],this._setDeform($K,$Z,this._boneSlotArray,$k)}if(this._drawOrder)for($T=0,$s=this._drawOrder.length;$T<$s;$T++)$E=$f[($a=this._boneSlotArray[this._drawOrder[$T]]).name],$O=$m[$a.name],isNaN($O)||($z.save(),$z.alpha($O)),isNaN($E)||-2==$E||(this._templet.attachmentNames?$a.showDisplayByName(this._templet.attachmentNames[$E]):$a.showDisplayByIndex($E)),$Z[this._drawOrder[$T]]?($S=$Z[this._drawOrder[$T]],$a.currDisplayData&&$S[$a.currDisplayData.attachmentName]?$a.deformData=$S[$a.currDisplayData.attachmentName]:$a.deformData=null):$a.deformData=null,isNaN($O)?$a.draw($z,this._boneMatrixArray,2==this._aniMode):$a.draw($z,this._boneMatrixArray,2==this._aniMode,$O),isNaN($O)||$z.restore();else for($T=0,$s=this._boneSlotArray.length;$T<$s;$T++)$E=$f[($a=this._boneSlotArray[$T]).name],$O=$m[$a.name],isNaN($O)||($z.save(),$z.alpha($O)),isNaN($E)||-2==$E||(this._templet.attachmentNames?$a.showDisplayByName(this._templet.attachmentNames[$E]):$a.showDisplayByIndex($E)),$Z[$T]?($S=$Z[$T],$a.currDisplayData&&$S[$a.currDisplayData.attachmentName]?$a.deformData=$S[$a.currDisplayData.attachmentName]:$a.deformData=null):$a.deformData=null,isNaN($O)?$a.draw($z,this._boneMatrixArray,2==this._aniMode):$a.draw($z,this._boneMatrixArray,2==this._aniMode,$O),isNaN($O)||$z.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$x,$z):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$x,$z)},$x._setDeform=function($x,$I,$z,$k){if($x){var $l,$n,$a,$$=0,$w=0,$i=0;if($x)for($$=0,$w=$x.deformSlotDataList.length;$$<$w;$$++)for($l=$x.deformSlotDataList[$$],$i=0;$i<$l.deformSlotDisplayList.length;$i++)$a=$z[($n=$l.deformSlotDisplayList[$i]).slotIndex],$n.apply($k,$a),$I[$n.slotIndex]||($I[$n.slotIndex]={}),$I[$n.slotIndex][$n.attachment]=$n.deformData}},$x.getAnimNum=function(){return this._templet.getAnimationCount()},$x.getAniNameByIndex=function($x){return this._templet.getAniNameByIndex($x)},$x.getSlotByName=function($x){return this._boneSlotDic[$x]},$x.showSkinByName=function($x,$I){void 0===$I&&($I=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($x),$I)},$x.showSkinByIndex=function($x,$I){void 0===$I&&($I=!0);for(var $z=0;$z<this._boneSlotArray.length;$z++)this._boneSlotArray[$z].showSlotData(null,$I);if(this._templet.showSkinByIndex(this._boneSlotDic,$x,$I)){var $k=this._templet.skinDataArray[$x];this._skinIndex=$x,this._skinName=$k.name}this._clearCache()},$x.showSlotSkinByIndex=function($x,$I){if(0!=this._aniMode){var $z=this.getSlotByName($x);$z&&$z.showDisplayByIndex($I),this._clearCache()}},$x.showSlotSkinByName=function($x,$I){if(0!=this._aniMode){var $z=this.getSlotByName($x);$z&&$z.showDisplayByName($I),this._clearCache()}},$x.replaceSlotSkinName=function($x,$I,$z){if(0!=this._aniMode){var $k=this.getSlotByName($x);$k&&$k.replaceDisplayByName($I,$z),this._clearCache()}},$x.replaceSlotSkinByIndex=function($x,$I,$z){if(0!=this._aniMode){var $k=this.getSlotByName($x);$k&&$k.replaceDisplayByIndex($I,$z),this._clearCache()}},$x.setSlotSkin=function($x,$I){if(0!=this._aniMode){var $z=this.getSlotByName($x);$z&&$z.replaceSkin($I),this._clearCache()}},$x._clearCache=function(){if(1==this._aniMode)for(var $x=0,$I=this._graphicsCache.length;$x<$I;$x++){for(var $z=0,$k=this._graphicsCache[$x].length;$z<$k;$z++){var $l=this._graphicsCache[$x][$z];$l!=this.graphics&&$j.recycle($l)}this._graphicsCache[$x].length=0}},$x.play=function($x,$I,$z,$k,$l,$n){void 0===$z&&($z=!0),void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$n&&($n=!0),this._indexControl=!1;var $a=-1,$$=NaN;if($$=$I?2147483647:0,"string"==typeof $x)for(var $w=0,$i=this._templet.getAnimationCount();$w<$i;$w++){var $F=this._templet.getAnimation($w);if($F&&$x==$F.name){$a=$w;break}}else $a=$x;-1<$a&&$a<this.getAnimNum()&&(this._aniClipIndex=$a,($z||this._pause||this._currAniIndex!=$a)&&(this._currAniIndex=$a,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($a)),this._drawOrder=null,this._eventIndex=0,this._player.play($a,this._player.playbackRate,$$,$k,$l),$n&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$b.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$x.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$x.playbackRate=function($x){this._player&&(this._player.playbackRate=$x)},$x.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$x.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$b.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$x._getGrahicsDataWithCache=function($x,$I){return this._graphicsCache[$x][$I]},$x._setGrahicsDataWithCache=function($x,$I,$z){this._graphicsCache[$x][$I]=$z},$x.destroy=function($x){void 0===$x&&($x=!0),$I.prototype.destroy.call(this,$x),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$n(0,$x,"url",function(){return this._aniPath},function($x){this.load($x)}),$n(0,$x,"index",function(){return this._index},function($x){this.player&&(this._index=$x,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$n(0,$x,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$n(0,$x,"templet",function(){return this._templet}),$n(0,$x,"player",function(){return this._player}),$z.useSimpleMeshInCanvas=!1,$z}($nx),$E=function($I){function $l(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$l.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$k($l,"laya.ani.bone.Templet",$I);var $x=$l.prototype;return $x.getLoadList=function(){return this._loadList},$x.loadAni=function($x){this._skBufferUrl=$x,$lx.loader.load($x,$a.create(this,this.onComplete),null,"arraybuffer")},$x.onComplete=function($x){if(this._isDestroyed)this.destroy();else{var $I=$w.getRes(this._skBufferUrl);$I?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$I)):this.event("error","load failed:"+this._skBufferUrl)}},$x.parseData=function($x,$I,$z){void 0===$z&&($z=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$x,this._mainTexture&&$N.isWebGL&&$x.bitmap&&($x.bitmap.enableMerageInAtlas=!1),this._rate=$z,this.parse($I)},$x.buildArmature=function($x){return void 0===$x&&($x=0),new $K(this,$x)},$x.parse=function($x){$I.prototype.parse.call(this,$x),this._endLoaded(),this._aniVersion!=$l.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$l.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$x._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $x=0;this._loadList=[];var $I,$z=new $dx(this.getPublicExtData()),$k=0,$l=0,$n=0,$a=$z.getInt32(),$$=$z.readUTFString(),$w=$$.split("\n");for($x=0;$x<$a;$x++)$I=this._path+$w[2*$x],$$=$w[2*$x+1],$z.getFloat32(),$z.getFloat32(),$k=$z.getFloat32(),$l=$z.getFloat32(),$n=$z.getFloat32(),isNaN($n)?0:$n,$n=$z.getFloat32(),isNaN($n)?0:$n,$n=$z.getFloat32(),isNaN($n)?$k:$n,$n=$z.getFloat32(),isNaN($n)?$l:$n,-1==this._loadList.indexOf($I)&&this._loadList.push($I);this.event("inited",this)}},$x._textureComplete=function(){for(var $x,$I,$z=0,$k=this._loadList.length;$z<$k;$z++)$I=this._loadList[$z],$x=this._textureDic[$I]=$w.getRes($I),$N.isWebGL&&$x&&$x.bitmap&&($x.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$x._parsePublicExtData=function(){var $x=0,$I=0,$z=0,$k=0,$l=0;for($x=0,$l=this.getAnimationCount();$x<$l;$x++)this._graphicsCache.push([]);var $n;$n="Dragon"!=this._aniClassName;var $a,$$,$w=new $dx(this.getPublicExtData()),$i=0,$F=0,$b=0,$T=0,$_=0,$R=0,$s=0,$N=0,$D=0,$f=$w.getInt32(),$m=$w.readUTFString(),$y=$m.split("\n");for($x=0;$x<$f;$x++){if($a=this._mainTexture,$$=this._path+$y[2*$x],$m=$y[2*$x+1],null==this._mainTexture&&($a=this._textureDic[$$]),!$a)return this.event("error",this),void(this.isParseFail=!0);$i=$w.getFloat32(),$F=$w.getFloat32(),$b=$w.getFloat32(),$T=$w.getFloat32(),$D=$w.getFloat32(),$_=isNaN($D)?0:$D,$D=$w.getFloat32(),$R=isNaN($D)?0:$D,$D=$w.getFloat32(),$s=isNaN($D)?$b:$D,$D=$w.getFloat32(),$N=isNaN($D)?$T:$D;var $C=$tx.create($a,$i,$F,$b,$T,-$_,-$R,$s,$N);if(!$C){var $P=$Xx.GlobalData;return void($P&&$P.throwError&&$P.throwError("Texture.create失败","tTextureName："+$m))}this.subTextureDic[$m]=$C,$a.alphaTexture&&(this.subTextureDic[$m].alphaTexture=$tx.create($a.alphaTexture,$i,$F,$b,$T,-$_,-$R,$s,$N))}this._mainTexture=$a;var $v,$L,$K,$E,$O,$S=$w.getUint16();for($x=0;$x<$S;$x++)($v=[]).push($w.getUint16()),$v.push($w.getUint16()),$v.push($w.getUint16()),$v.push($w.getUint16()),this.aniSectionDic[$x]=$v;var $Z,$U=$w.getInt16(),$X={};for($x=0;$x<$U;$x++)$L=new $Yx,0==$x?$Z=$L:$L.root=$Z,$L.d=$n?-1:1,$E=$w.readUTFString(),$O=$w.readUTFString(),$L.length=$w.getFloat32(),1==$w.getByte()&&($L.inheritRotation=!1),1==$w.getByte()&&($L.inheritScale=!1),$L.name=$E,$O&&(($K=$X[$O])?$K.addChild($L):this.mRootBone=$L),$X[$E]=$L,this.mBoneArr.push($L);this.tMatrixDataLen=$w.getUint16();var $d,$j,$t=$w.getUint16(),$Y=Math.floor($t/this.tMatrixDataLen),$c=this.srcBoneMatrixArr;for($x=0;$x<$Y;$x++)($d=new $ux).scX=$w.getFloat32(),$d.skX=$w.getFloat32(),$d.skY=$w.getFloat32(),$d.scY=$w.getFloat32(),$d.x=$w.getFloat32(),$d.y=$w.getFloat32(),8===this.tMatrixDataLen&&($d.skewX=$w.getFloat32(),$d.skewY=$w.getFloat32()),$c.push($d),($L=this.mBoneArr[$x]).transform=$d;var $V,$W=$w.getUint16(),$q=0;for($x=0;$x<$W;$x++){for($j=new $hx,$q=$w.getUint16(),$I=0;$I<$q;$I++)$j.boneNames.push($w.readUTFString()),$j.boneIndexs.push($w.getInt16());$j.name=$w.readUTFString(),$j.targetBoneName=$w.readUTFString(),$j.targetBoneIndex=$w.getInt16(),$j.bendDirection=$w.getFloat32(),$j.mix=$w.getFloat32(),$j.isSpine=$n,this.ikArr.push($j)}var $o,$J=$w.getUint16(),$h=0;for($x=0;$x<$J;$x++){for($V=new $px,$h=$w.getUint16(),$I=0;$I<$h;$I++)$V.boneIndexs.push($w.getInt16());$V.name=$w.getUTFString(),$V.targetIndex=$w.getInt16(),$V.rotateMix=$w.getFloat32(),$V.translateMix=$w.getFloat32(),$V.scaleMix=$w.getFloat32(),$V.shearMix=$w.getFloat32(),$V.offsetRotation=$w.getFloat32(),$V.offsetX=$w.getFloat32(),$V.offsetY=$w.getFloat32(),$V.offsetScaleX=$w.getFloat32(),$V.offsetScaleY=$w.getFloat32(),$V.offsetShearY=$w.getFloat32(),this.tfArr.push($V)}var $B=$w.getUint16(),$e=0;for($x=0;$x<$B;$x++){for(($o=new $Bx).name=$w.readUTFString(),$e=$w.getUint16(),$I=0;$I<$e;$I++)$o.bones.push($w.getInt16());$o.target=$w.readUTFString(),$o.positionMode=$w.readUTFString(),$o.spacingMode=$w.readUTFString(),$o.rotateMode=$w.readUTFString(),$o.offsetRotation=$w.getFloat32(),$o.position=$w.getFloat32(),$o.spacing=$w.getFloat32(),$o.rotateMix=$w.getFloat32(),$o.translateMix=$w.getFloat32(),this.pathArr.push($o)}var $A,$H,$p,$u,$r,$g=0,$M=0,$Q=0,$G=NaN,$xx=0,$Ix=$w.getInt16();for($x=0;$x<$Ix;$x++){var $zx=$w.getUint8(),$kx={};this.deformAniArr.push($kx);for(var $lx=0;$lx<$zx;$lx++)for(($A=new $Vx).skinName=$w.getUTFString(),$kx[$A.skinName]=$A,$g=$w.getInt16(),$I=0;$I<$g;$I++)for($H=new $Wx,$A.deformSlotDataList.push($H),$M=$w.getInt16(),$z=0;$z<$M;$z++)for($p=new $qx,$H.deformSlotDisplayList.push($p),$p.slotIndex=$w.getInt16(),$p.attachment=$w.getUTFString(),$Q=$w.getInt16(),$k=0;$k<$Q;$k++)for(1==$w.getByte()?$p.tweenKeyList.push(!0):$p.tweenKeyList.push(!1),$G=$w.getFloat32(),$p.timeList.push($G),$u=[],$p.vectices.push($u),$xx=$w.getInt16(),$l=0;$l<$xx;$l++)$u.push($w.getFloat32())}var $nx,$ax,$$x=$w.getInt16(),$wx=0,$ix=0;for($x=0;$x<$$x;$x++){for($wx=$w.getInt16(),$r=[],$I=0;$I<$wx;$I++){for(($nx=new $ox).time=$w.getFloat32(),$ix=$w.getInt16(),$z=0;$z<$ix;$z++)$nx.drawOrder.push($w.getInt16());$r.push($nx)}this.drawOrderAniArr.push($r)}var $Fx,$bx=$w.getInt16(),$Tx=0;for($x=0;$x<$bx;$x++){for($Tx=$w.getInt16(),$ax=[],$I=0;$I<$Tx;$I++)($Fx=new $Jx).name=$w.getUTFString(),$Fx.intValue=$w.getInt32(),$Fx.floatValue=$w.getFloat32(),$Fx.stringValue=$w.getUTFString(),$Fx.time=$w.getFloat32(),$ax.push($Fx);this.eventAniArr.push($ax)}var $_x=$w.getInt16();if(0<$_x)for(this.attachmentNames=[],$x=0;$x<$_x;$x++)this.attachmentNames.push($w.getUTFString());var $Rx,$sx,$Nx=$w.getInt16();for($x=0;$x<$Nx;$x++)($Rx=new $cx).name=$w.readUTFString(),$Rx.parent=$w.readUTFString(),$Rx.attachmentName=$w.readUTFString(),$Rx.srcDisplayIndex=$Rx.displayIndex=$w.getInt16(),($Rx.templet=this).boneSlotDic[$Rx.name]=$Rx,null==($sx=this.bindBoneBoneSlotDic[$Rx.parent])&&(this.bindBoneBoneSlotDic[$Rx.parent]=$sx=[]),$sx.push($Rx),this.boneSlotArray.push($Rx);var $Dx,$fx,$mx,$yx=$w.readUTFString().split("\n"),$Cx=0,$Px=$w.getUint8(),$vx=0,$Lx=0,$Kx=0,$Ex=0,$Ox=0,$Sx=0,$Zx=0;for($x=0;$x<$Px;$x++){for(($Dx=new $ex).name=$yx[$Cx++],$vx=$w.getUint8(),$I=0;$I<$vx;$I++){for(($fx=new $Hx).name=$yx[$Cx++],$Rx=this.boneSlotDic[$fx.name],$Lx=$w.getUint8(),$z=0;$z<$Lx;$z++){if($mx=new $Ax,this.skinSlotDisplayDataArr.push($mx),$mx.name=$yx[$Cx++],$mx.attachmentName=$yx[$Cx++],$mx.transform=new $ux,$mx.transform.scX=$w.getFloat32(),$mx.transform.skX=$w.getFloat32(),$mx.transform.skY=$w.getFloat32(),$mx.transform.scY=$w.getFloat32(),$mx.transform.x=$w.getFloat32(),$mx.transform.y=$w.getFloat32(),$fx.displayArr.push($mx),$mx.width=$w.getFloat32(),$mx.height=$w.getFloat32(),$mx.type=$w.getUint8(),$mx.verLen=$w.getUint16(),0<($U=$w.getUint16()))for($mx.bones=[],$k=0;$k<$U;$k++){var $Ux=$w.getUint16();$mx.bones.push($Ux)}if(0<($Kx=$w.getUint16()))for($mx.uvs=[],$k=0;$k<$Kx;$k++)$mx.uvs.push($w.getFloat32());if(0<($Ex=$w.getUint16()))for($mx.weights=[],$k=0;$k<$Ex;$k++)$mx.weights.push($w.getFloat32());if(0<($Ox=$w.getUint16()))for($mx.triangles=[],$k=0;$k<$Ox;$k++)$mx.triangles.push($w.getUint16());if(0<($Sx=$w.getUint16()))for($mx.vertices=[],$k=0;$k<$Sx;$k++)$mx.vertices.push($w.getFloat32());if(0<($Zx=$w.getUint16()))for($mx.lengths=[],$k=0;$k<$Zx;$k++)$mx.lengths.push($w.getFloat32())}$Dx.slotArr.push($fx)}this.skinDic[$Dx.name]=$Dx,this.skinDataArray.push($Dx)}1==$w.getUint8()?(this.yReverseMatrix=new $jx(1,0,0,-1,0,0),$Z&&$Z.setTempMatrix(this.yReverseMatrix)):$Z&&$Z.setTempMatrix(new $jx),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$x.getTexture=function($x){var $I=this.subTextureDic[$x];return $I||($I=this.subTextureDic[$x.substr(0,$x.length-1)]),null==$I?this._mainTexture:$I},$x.showSkinByIndex=function($x,$I,$z){if(void 0===$z&&($z=!0),$I<0&&$I>=this.skinDataArray.length)return!1;var $k,$l,$n=0,$a=0,$$=this.skinDataArray[$I];if($$){for($n=0,$a=$$.slotArr.length;$n<$a;$n++)($l=$$.slotArr[$n])&&($k=$x[$l.name])&&($k.showSlotData($l,$z),$z&&"undefined"!=$k.attachmentName&&"null"!=$k.attachmentName?$k.showDisplayByName($k.attachmentName):$k.showDisplayByIndex($k.displayIndex));return!0}return!1},$x.getSkinIndexByName=function($x){for(var $I=0,$z=this.skinDataArray.length;$I<$z;$I++)if(this.skinDataArray[$I].name==$x)return $I;return-1},$x.getGrahicsDataWithCache=function($x,$I){return this._graphicsCache[$x][$I]},$x.setGrahicsDataWithCache=function($x,$I,$z){this._graphicsCache[$x][$I]=$z},$x.destroy=function(){var $x;for(var $I in this._isDestroyed=!0,this.subTextureDic)($x=this.subTextureDic[$I])&&$x.destroy();for($I in this._textureDic)($x=this._textureDic[$I])&&$x.destroy();for(var $z=0,$k=this.skinSlotDisplayDataArr.length;$z<$k;$z++)this.skinSlotDisplayDataArr[$z].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $l.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$x.getAniNameByIndex=function($x){var $I=this.getAnimation($x);return $I?$I.name:null},$n(0,$x,"rate",function(){return this._rate},function($x){this._rate=$x}),$l.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$l.TEMPLET_DICTIONARY=null,$l}($t)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($x,$I){"use strict";for(var $z in Object.defineProperty($I,"__esModule",{value:!0}),Laya){var $k=Laya[$z];$k&&$k.__isclass&&($I[$z]=$k)}}),function($x,$I){"object"==typeof exports&&"object"==typeof module?window?window.Matter=$I():module.exports=$I():"function"==typeof define&&define.amd?define("Matter",[],$I):"object"==typeof exports?exports.Matter=$I():$x.Matter=$I()}(this,function(){return function($z){var $k={};function $l($x){if($k[$x])return $k[$x].exports;var $I=$k[$x]={i:$x,l:!1,exports:{}};return $z[$x].call($I.exports,$I,$I.exports,$l),$I.l=!0,$I.exports}return $l.m=$z,$l.c=$k,$l.d=function($x,$I,$z){$l.o($x,$I)||Object.defineProperty($x,$I,{enumerable:!0,get:$z})},$l.r=function($x){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty($x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty($x,"__esModule",{value:!0})},$l.t=function($I,$x){if(1&$x&&($I=$l($I)),8&$x)return $I;if(4&$x&&"object"==typeof $I&&$I&&$I.__esModule)return $I;var $z=Object.create(null);if($l.r($z),Object.defineProperty($z,"default",{enumerable:!0,value:$I}),2&$x&&"string"!=typeof $I)for(var $k in $I)$l.d($z,$k,function($x){return $I[$x]}.bind(null,$k));return $z},$l.n=function($x){var $I=$x&&$x.__esModule?function(){return $x.default}:function(){return $x};return $l.d($I,"a",$I),$I},$l.o=function($x,$I){return Object.prototype.hasOwnProperty.call($x,$I)},$l.p="",$l($l.s=21)}([function($x,$I){var $w={};$x.exports=$w,function(){$w._nextId=0,$w._seed=0,$w._nowStartTime=+new Date,$w._warnedOnce={},$w._decomp=null,$w.extend=function($x,$I){var $z,$k;$k="boolean"==typeof $I?($z=2,$I):($z=1,!0);for(var $l=$z;$l<arguments.length;$l++){var $n=arguments[$l];if($n)for(var $a in $n)$k&&$n[$a]&&$n[$a].constructor===Object?$x[$a]&&$x[$a].constructor!==Object?$x[$a]=$n[$a]:($x[$a]=$x[$a]||{},$w.extend($x[$a],$k,$n[$a])):$x[$a]=$n[$a]}return $x},$w.clone=function($x,$I){return $w.extend({},$I,$x)},$w.keys=function($x){if(Object.keys)return Object.keys($x);var $I=[];for(var $z in $x)$I.push($z);return $I},$w.values=function($x){var $I=[];if(Object.keys){for(var $z=Object.keys($x),$k=0;$k<$z.length;$k++)$I.push($x[$z[$k]]);return $I}for(var $l in $x)$I.push($x[$l]);return $I},$w.get=function($x,$I,$z,$k){$I=$I.split(".").slice($z,$k);for(var $l=0;$l<$I.length;$l+=1)$x=$x[$I[$l]];return $x},$w.set=function($x,$I,$z,$k,$l){var $n=$I.split(".").slice($k,$l);return $w.get($x,$I,0,-1)[$n[$n.length-1]]=$z},$w.shuffle=function($x){for(var $I=$x.length-1;0<$I;$I--){var $z=Math.floor($w.random()*($I+1)),$k=$x[$I];$x[$I]=$x[$z],$x[$z]=$k}return $x},$w.choose=function($x){return $x[Math.floor($w.random()*$x.length)]},$w.isElement=function($x){return"undefined"!=typeof HTMLElement?$x instanceof HTMLElement:!!($x&&$x.nodeType&&$x.nodeName)},$w.isArray=function($x){return"[object Array]"===Object.prototype.toString.call($x)},$w.isFunction=function($x){return"function"==typeof $x},$w.isPlainObject=function($x){return"object"==typeof $x&&$x.constructor===Object},$w.isString=function($x){return"[object String]"===toString.call($x)},$w.clamp=function($x,$I,$z){return $x<$I?$I:$z<$x?$z:$x},$w.sign=function($x){return $x<0?-1:1},$w.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-$w._nowStartTime},$w.random=function($x,$I){return $I=void 0!==$I?$I:1,($x=void 0!==$x?$x:0)+$z()*($I-$x)};var $z=function(){return $w._seed=(9301*$w._seed+49297)%233280,$w._seed/233280};$w.colorToNumber=function($x){return 3==($x=$x.replace("#","")).length&&($x=$x.charAt(0)+$x.charAt(0)+$x.charAt(1)+$x.charAt(1)+$x.charAt(2)+$x.charAt(2)),parseInt($x,16)},$w.logLevel=1,$w.log=function(){console&&0<$w.logLevel&&$w.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},$w.info=function(){console&&0<$w.logLevel&&$w.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},$w.warn=function(){console&&0<$w.logLevel&&$w.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},$w.warnOnce=function(){var $x=Array.prototype.slice.call(arguments).join(" ");$w._warnedOnce[$x]||($w.warn($x),$w._warnedOnce[$x]=!0)},$w.deprecated=function($x,$I,$z){$x[$I]=$w.chain(function(){$w.warnOnce("🔅 deprecated 🔅",$z)},$x[$I])},$w.nextId=function(){return $w._nextId++},$w.indexOf=function($x,$I){if($x.indexOf)return $x.indexOf($I);for(var $z=0;$z<$x.length;$z++)if($x[$z]===$I)return $z;return-1},$w.map=function($x,$I){if($x.map)return $x.map($I);for(var $z=[],$k=0;$k<$x.length;$k+=1)$z.push($I($x[$k]));return $z},$w.topologicalSort=function($x){var $I=[],$z=[],$k=[];for(var $l in $x)$z[$l]||$k[$l]||$w._topologicalSort($l,$z,$k,$x,$I);return $I},$w._topologicalSort=function($x,$I,$z,$k,$l){var $n=$k[$x]||[];$z[$x]=!0;for(var $a=0;$a<$n.length;$a+=1){var $$=$n[$a];$z[$$]||($I[$$]||$w._topologicalSort($$,$I,$z,$k,$l))}$z[$x]=!1,$I[$x]=!0,$l.push($x)},$w.chain=function(){for(var $n=[],$x=0;$x<arguments.length;$x+=1){var $I=arguments[$x];$I._chained?$n.push.apply($n,$I._chained):$n.push($I)}function $z(){for(var $x,$I=new Array(arguments.length),$z=0,$k=arguments.length;$z<$k;$z++)$I[$z]=arguments[$z];for($z=0;$z<$n.length;$z+=1){var $l=$n[$z].apply($x,$I);void 0!==$l&&($x=$l)}return $x}return $z._chained=$n,$z},$w.chainPathBefore=function($x,$I,$z){return $w.set($x,$I,$w.chain($z,$w.get($x,$I)))},$w.chainPathAfter=function($x,$I,$z){return $w.set($x,$I,$w.chain($w.get($x,$I),$z))},$w.setDecomp=function($x){$w._decomp=$x},$w.getDecomp=function(){var $I=$w._decomp;try{$I||"undefined"==typeof window||($I=window.decomp),$I||"undefined"==typeof global||($I=global.decomp)}catch($x){$I=null}return $I}}()},function($x,$I){var $z={};($x.exports=$z).create=function($x){var $I={min:{x:0,y:0},max:{x:0,y:0}};return $x&&$z.update($I,$x),$I},$z.update=function($x,$I,$z){$x.min.x=1/0,$x.max.x=-1/0,$x.min.y=1/0,$x.max.y=-1/0;for(var $k=0;$k<$I.length;$k++){var $l=$I[$k];$l.x>$x.max.x&&($x.max.x=$l.x),$l.x<$x.min.x&&($x.min.x=$l.x),$l.y>$x.max.y&&($x.max.y=$l.y),$l.y<$x.min.y&&($x.min.y=$l.y)}$z&&(0<$z.x?$x.max.x+=$z.x:$x.min.x+=$z.x,0<$z.y?$x.max.y+=$z.y:$x.min.y+=$z.y)},$z.contains=function($x,$I){return $I.x>=$x.min.x&&$I.x<=$x.max.x&&$I.y>=$x.min.y&&$I.y<=$x.max.y},$z.overlaps=function($x,$I){return $x.min.x<=$I.max.x&&$x.max.x>=$I.min.x&&$x.max.y>=$I.min.y&&$x.min.y<=$I.max.y},$z.translate=function($x,$I){$x.min.x+=$I.x,$x.max.x+=$I.x,$x.min.y+=$I.y,$x.max.y+=$I.y},$z.shift=function($x,$I){var $z=$x.max.x-$x.min.x,$k=$x.max.y-$x.min.y;$x.min.x=$I.x,$x.max.x=$I.x+$z,$x.min.y=$I.y,$x.max.y=$I.y+$k}},function($x,$I){var $z={};($x.exports=$z).create=function($x,$I){return{x:$x||0,y:$I||0}},$z.clone=function($x){return{x:$x.x,y:$x.y}},$z.magnitude=function($x){return Math.sqrt($x.x*$x.x+$x.y*$x.y)},$z.magnitudeSquared=function($x){return $x.x*$x.x+$x.y*$x.y},$z.rotate=function($x,$I,$z){var $k=Math.cos($I),$l=Math.sin($I);$z||($z={});var $n=$x.x*$k-$x.y*$l;return $z.y=$x.x*$l+$x.y*$k,$z.x=$n,$z},$z.rotateAbout=function($x,$I,$z,$k){var $l=Math.cos($I),$n=Math.sin($I);$k||($k={});var $a=$z.x+(($x.x-$z.x)*$l-($x.y-$z.y)*$n);return $k.y=$z.y+(($x.x-$z.x)*$n+($x.y-$z.y)*$l),$k.x=$a,$k},$z.normalise=function($x){var $I=$z.magnitude($x);return 0===$I?{x:0,y:0}:{x:$x.x/$I,y:$x.y/$I}},$z.dot=function($x,$I){return $x.x*$I.x+$x.y*$I.y},$z.cross=function($x,$I){return $x.x*$I.y-$x.y*$I.x},$z.cross3=function($x,$I,$z){return($I.x-$x.x)*($z.y-$x.y)-($I.y-$x.y)*($z.x-$x.x)},$z.add=function($x,$I,$z){return $z||($z={}),$z.x=$x.x+$I.x,$z.y=$x.y+$I.y,$z},$z.sub=function($x,$I,$z){return $z||($z={}),$z.x=$x.x-$I.x,$z.y=$x.y-$I.y,$z},$z.mult=function($x,$I){return{x:$x.x*$I,y:$x.y*$I}},$z.div=function($x,$I){return{x:$x.x/$I,y:$x.y/$I}},$z.perp=function($x,$I){return{x:($I=!0===$I?-1:1)*-$x.y,y:$I*$x.x}},$z.neg=function($x){return{x:-$x.x,y:-$x.y}},$z.angle=function($x,$I){return Math.atan2($I.y-$x.y,$I.x-$x.x)},$z._temp=[$z.create(),$z.create(),$z.create(),$z.create(),$z.create(),$z.create()]},function($x,$I,$z){var $$={};$x.exports=$$;var $y=$z(2),$C=$z(0);$$.create=function($x,$I){for(var $z=[],$k=0;$k<$x.length;$k++){var $l=$x[$k],$n={x:$l.x,y:$l.y,index:$k,body:$I,isInternal:!1};$z.push($n)}return $z},$$.fromPath=function($x,$I){var $k=[];return $x.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,function($x,$I,$z){$k.push({x:parseFloat($I),y:parseFloat($z)})}),$$.create($k,$I)},$$.centre=function($x){for(var $I,$z,$k,$l=$$.area($x,!0),$n={x:0,y:0},$a=0;$a<$x.length;$a++)$k=($a+1)%$x.length,$I=$y.cross($x[$a],$x[$k]),$z=$y.mult($y.add($x[$a],$x[$k]),$I),$n=$y.add($n,$z);return $y.div($n,6*$l)},$$.mean=function($x){for(var $I={x:0,y:0},$z=0;$z<$x.length;$z++)$I.x+=$x[$z].x,$I.y+=$x[$z].y;return $y.div($I,$x.length)},$$.area=function($x,$I){for(var $z=0,$k=$x.length-1,$l=0;$l<$x.length;$l++)$z+=($x[$k].x-$x[$l].x)*($x[$k].y+$x[$l].y),$k=$l;return $I?$z/2:Math.abs($z)/2},$$.inertia=function($x,$I){for(var $z,$k,$l=0,$n=0,$a=$x,$$=0;$$<$a.length;$$++)$k=($$+1)%$a.length,$l+=($z=Math.abs($y.cross($a[$k],$a[$$])))*($y.dot($a[$k],$a[$k])+$y.dot($a[$k],$a[$$])+$y.dot($a[$$],$a[$$])),$n+=$z;return $I/6*($l/$n)},$$.translate=function($x,$I,$z){$z=void 0!==$z?$z:1;var $k,$l=$x.length,$n=$I.x*$z,$a=$I.y*$z;for($k=0;$k<$l;$k++)$x[$k].x+=$n,$x[$k].y+=$a;return $x},$$.rotate=function($x,$I,$z){if(0!==$I){var $k,$l,$n,$a,$$=Math.cos($I),$w=Math.sin($I),$i=$z.x,$F=$z.y,$b=$x.length;for($a=0;$a<$b;$a++)$l=($k=$x[$a]).x-$i,$n=$k.y-$F,$k.x=$i+($l*$$-$n*$w),$k.y=$F+($l*$w+$n*$$);return $x}},$$.contains=function($x,$I){for(var $z,$k=$I.x,$l=$I.y,$n=$x.length,$a=$x[$n-1],$$=0;$$<$n;$$++){if($z=$x[$$],0<($k-$a.x)*($z.y-$a.y)+($l-$a.y)*($a.x-$z.x))return!1;$a=$z}return!0},$$.scale=function($x,$I,$z,$k){if(1===$I&&1===$z)return $x;var $l,$n;$k=$k||$$.centre($x);for(var $a=0;$a<$x.length;$a++)$l=$x[$a],$n=$y.sub($l,$k),$x[$a].x=$k.x+$n.x*$I,$x[$a].y=$k.y+$n.y*$z;return $x},$$.chamfer=function($x,$I,$z,$k,$l){$I="number"==typeof $I?[$I]:$I||[8],$z=void 0!==$z?$z:-1,$k=$k||2,$l=$l||14;for(var $n=[],$a=0;$a<$x.length;$a++){var $$=$x[0<=$a-1?$a-1:$x.length-1],$w=$x[$a],$i=$x[($a+1)%$x.length],$F=$I[$a<$I.length?$a:$I.length-1];if(0!==$F){var $b=$y.normalise({x:$w.y-$$.y,y:$$.x-$w.x}),$T=$y.normalise({x:$i.y-$w.y,y:$w.x-$i.x}),$_=Math.sqrt(2*Math.pow($F,2)),$R=$y.mult($C.clone($b),$F),$s=$y.normalise($y.mult($y.add($b,$T),.5)),$N=$y.sub($w,$y.mult($s,$_)),$D=$z;-1===$z&&($D=1.75*Math.pow($F,.32)),($D=$C.clamp($D,$k,$l))%2==1&&($D+=1);for(var $f=Math.acos($y.dot($b,$T))/$D,$m=0;$m<$D;$m++)$n.push($y.add($y.rotate($R,$f*$m),$N))}else $n.push($w)}return $n},$$.clockwiseSort=function($x){var $z=$$.mean($x);return $x.sort(function($x,$I){return $y.angle($z,$x)-$y.angle($z,$I)}),$x},$$.isConvex=function($x){var $I,$z,$k,$l,$n=0,$a=$x.length;if($a<3)return null;for($I=0;$I<$a;$I++)if($k=($I+2)%$a,$l=($x[$z=($I+1)%$a].x-$x[$I].x)*($x[$k].y-$x[$z].y),($l-=($x[$z].y-$x[$I].y)*($x[$k].x-$x[$z].x))<0?$n|=1:0<$l&&($n|=2),3===$n)return!1;return 0!==$n||null},$$.hull=function($x){var $I,$z,$k=[],$l=[];for(($x=$x.slice(0)).sort(function($x,$I){var $z=$x.x-$I.x;return 0!=$z?$z:$x.y-$I.y}),$z=0;$z<$x.length;$z+=1){for($I=$x[$z];2<=$l.length&&$y.cross3($l[$l.length-2],$l[$l.length-1],$I)<=0;)$l.pop();$l.push($I)}for($z=$x.length-1;0<=$z;$z-=1){for($I=$x[$z];2<=$k.length&&$y.cross3($k[$k.length-2],$k[$k.length-1],$I)<=0;)$k.pop();$k.push($I)}return $k.pop(),$l.pop(),$k.concat($l)}},function($x,$I,$z){var $k={};$x.exports=$k;var $F=$z(0);$k.on=function($x,$I,$z){for(var $k,$l=$I.split(" "),$n=0;$n<$l.length;$n++)$k=$l[$n],$x.events=$x.events||{},$x.events[$k]=$x.events[$k]||[],$x.events[$k].push($z);return $z},$k.off=function($x,$I,$z){if($I){"function"==typeof $I&&($z=$I,$I=$F.keys($x.events).join(" "));for(var $k=$I.split(" "),$l=0;$l<$k.length;$l++){var $n=$x.events[$k[$l]],$a=[];if($z&&$n)for(var $$=0;$$<$n.length;$$++)$n[$$]!==$z&&$a.push($n[$$]);$x.events[$k[$l]]=$a}}else $x.events={}},$k.trigger=function($x,$I,$z){var $k,$l,$n,$a,$$=$x.events;if($$&&0<$F.keys($$).length){$z||($z={}),$k=$I.split(" ");for(var $w=0;$w<$k.length;$w++)if($n=$$[$l=$k[$w]]){($a=$F.clone($z,!1)).name=$l,$a.source=$x;for(var $i=0;$i<$n.length;$i++)$n[$i].apply($x,[$a])}}}},function($x,$I,$z){var $b={};$x.exports=$b;var $a=$z(4),$n=$z(0),$$=$z(1),$T=$z(6);$b.create=function($x){return $n.extend({id:$n.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},$x)},$b.setModified=function($x,$I,$z,$k){if(($x.isModified=$I)&&$x.cache&&($x.cache.allBodies=null,$x.cache.allConstraints=null,$x.cache.allComposites=null),$z&&$x.parent&&$b.setModified($x.parent,$I,$z,$k),$k)for(var $l=0;$l<$x.composites.length;$l++){var $n=$x.composites[$l];$b.setModified($n,$I,$z,$k)}},$b.add=function($x,$I){var $z=[].concat($I);$a.trigger($x,"beforeAdd",{object:$I});for(var $k=0;$k<$z.length;$k++){var $l=$z[$k];switch($l.type){case"body":if($l.parent!==$l){$n.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}$b.addBody($x,$l);break;case"constraint":$b.addConstraint($x,$l);break;case"composite":$b.addComposite($x,$l);break;case"mouseConstraint":$b.addConstraint($x,$l.constraint)}}return $a.trigger($x,"afterAdd",{object:$I}),$x},$b.remove=function($x,$I,$z){var $k=[].concat($I);$a.trigger($x,"beforeRemove",{object:$I});for(var $l=0;$l<$k.length;$l++){var $n=$k[$l];switch($n.type){case"body":$b.removeBody($x,$n,$z);break;case"constraint":$b.removeConstraint($x,$n,$z);break;case"composite":$b.removeComposite($x,$n,$z);break;case"mouseConstraint":$b.removeConstraint($x,$n.constraint)}}return $a.trigger($x,"afterRemove",{object:$I}),$x},$b.addComposite=function($x,$I){return $x.composites.push($I),$I.parent=$x,$b.setModified($x,!0,!0,!1),$x},$b.removeComposite=function($x,$I,$z){var $k=$n.indexOf($x.composites,$I);if(-1!==$k&&$b.removeCompositeAt($x,$k),$z)for(var $l=0;$l<$x.composites.length;$l++)$b.removeComposite($x.composites[$l],$I,!0);return $x},$b.removeCompositeAt=function($x,$I){return $x.composites.splice($I,1),$b.setModified($x,!0,!0,!1),$x},$b.addBody=function($x,$I){return $x.bodies.push($I),$b.setModified($x,!0,!0,!1),$x},$b.removeBody=function($x,$I,$z){var $k=$n.indexOf($x.bodies,$I);if(-1!==$k&&$b.removeBodyAt($x,$k),$z)for(var $l=0;$l<$x.composites.length;$l++)$b.removeBody($x.composites[$l],$I,!0);return $x},$b.removeBodyAt=function($x,$I){return $x.bodies.splice($I,1),$b.setModified($x,!0,!0,!1),$x},$b.addConstraint=function($x,$I){return $x.constraints.push($I),$b.setModified($x,!0,!0,!1),$x},$b.removeConstraint=function($x,$I,$z){var $k=$n.indexOf($x.constraints,$I);if(-1!==$k&&$b.removeConstraintAt($x,$k),$z)for(var $l=0;$l<$x.composites.length;$l++)$b.removeConstraint($x.composites[$l],$I,!0);return $x},$b.removeConstraintAt=function($x,$I){return $x.constraints.splice($I,1),$b.setModified($x,!0,!0,!1),$x},$b.clear=function($x,$I,$z){if($z)for(var $k=0;$k<$x.composites.length;$k++)$b.clear($x.composites[$k],$I,!0);return $I?$x.bodies=$x.bodies.filter(function($x){return $x.isStatic}):$x.bodies.length=0,$x.constraints.length=0,$x.composites.length=0,$b.setModified($x,!0,!0,!1),$x},$b.allBodies=function($x){if($x.cache&&$x.cache.allBodies)return $x.cache.allBodies;for(var $I=[].concat($x.bodies),$z=0;$z<$x.composites.length;$z++)$I=$I.concat($b.allBodies($x.composites[$z]));return $x.cache&&($x.cache.allBodies=$I),$I},$b.allConstraints=function($x){if($x.cache&&$x.cache.allConstraints)return $x.cache.allConstraints;for(var $I=[].concat($x.constraints),$z=0;$z<$x.composites.length;$z++)$I=$I.concat($b.allConstraints($x.composites[$z]));return $x.cache&&($x.cache.allConstraints=$I),$I},$b.allComposites=function($x){if($x.cache&&$x.cache.allComposites)return $x.cache.allComposites;for(var $I=[].concat($x.composites),$z=0;$z<$x.composites.length;$z++)$I=$I.concat($b.allComposites($x.composites[$z]));return $x.cache&&($x.cache.allComposites=$I),$I},$b.get=function($x,$I,$z){var $k,$l;switch($z){case"body":$k=$b.allBodies($x);break;case"constraint":$k=$b.allConstraints($x);break;case"composite":$k=$b.allComposites($x).concat($x)}return $k?0===($l=$k.filter(function($x){return $x.id.toString()===$I.toString()})).length?null:$l[0]:null},$b.move=function($x,$I,$z){return $b.remove($x,$I),$b.add($z,$I),$x},$b.rebase=function($x){for(var $I=$b.allBodies($x).concat($b.allConstraints($x)).concat($b.allComposites($x)),$z=0;$z<$I.length;$z++)$I[$z].id=$n.nextId();return $x},$b.translate=function($x,$I,$z){for(var $k=$z?$b.allBodies($x):$x.bodies,$l=0;$l<$k.length;$l++)$T.translate($k[$l],$I);return $x},$b.rotate=function($x,$I,$z,$k){for(var $l=Math.cos($I),$n=Math.sin($I),$a=$k?$b.allBodies($x):$x.bodies,$$=0;$$<$a.length;$$++){var $w=$a[$$],$i=$w.position.x-$z.x,$F=$w.position.y-$z.y;$T.setPosition($w,{x:$z.x+($i*$l-$F*$n),y:$z.y+($i*$n+$F*$l)}),$T.rotate($w,$I)}return $x},$b.scale=function($x,$I,$z,$k,$l){for(var $n=$l?$b.allBodies($x):$x.bodies,$a=0;$a<$n.length;$a++){var $$=$n[$a],$w=$$.position.x-$k.x,$i=$$.position.y-$k.y;$T.setPosition($$,{x:$k.x+$w*$I,y:$k.y+$i*$z}),$T.scale($$,$I,$z)}return $x},$b.bounds=function($x){for(var $I=$b.allBodies($x),$z=[],$k=0;$k<$I.length;$k+=1){var $l=$I[$k];$z.push($l.bounds.min,$l.bounds.max)}return $$.create($z)}},function($x,$I,$z){var $i={};$x.exports=$i;var $F=$z(3),$b=$z(2),$l=$z(7),$n=($z(16),$z(0)),$T=$z(1),$_=$z(11);!function(){$i._inertiaScale=4,$i._nextCollidingGroupId=1,$i._nextNonCollidingGroupId=-1,$i._nextCategory=1,$i.create=function($x){var $I={id:$n.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:$F.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},$z=$n.extend($I,$x);return $k($z,$x),$z},$i.nextGroup=function($x){return $x?$i._nextNonCollidingGroupId--:$i._nextCollidingGroupId++},$i.nextCategory=function(){return $i._nextCategory=$i._nextCategory<<1,$i._nextCategory};var $k=function($x,$I){$I=$I||{},$i.set($x,{bounds:$x.bounds||$T.create($x.vertices),positionPrev:$x.positionPrev||$b.clone($x.position),anglePrev:$x.anglePrev||$x.angle,vertices:$x.vertices,parts:$x.parts||[$x],isStatic:$x.isStatic,isSleeping:$x.isSleeping,parent:$x.parent||$x}),$F.rotate($x.vertices,$x.angle,$x.position),$_.rotate($x.axes,$x.angle),$T.update($x.bounds,$x.vertices,$x.velocity),$i.set($x,{axes:$I.axes||$x.axes,area:$I.area||$x.area,mass:$I.mass||$x.mass,inertia:$I.inertia||$x.inertia});var $z=$x.isStatic?"#14151f":$n.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),$k=$x.isStatic?"#555":"#ccc",$l=$x.isStatic&&null===$x.render.fillStyle?1:0;$x.render.fillStyle=$x.render.fillStyle||$z,$x.render.strokeStyle=$x.render.strokeStyle||$k,$x.render.lineWidth=$x.render.lineWidth||$l,$x.render.sprite.xOffset+=-($x.bounds.min.x-$x.position.x)/($x.bounds.max.x-$x.bounds.min.x),$x.render.sprite.yOffset+=-($x.bounds.min.y-$x.position.y)/($x.bounds.max.y-$x.bounds.min.y)};$i.set=function($x,$I,$z){var $k;for($k in"string"==typeof $I&&($k=$I,($I={})[$k]=$z),$I)if(Object.prototype.hasOwnProperty.call($I,$k))switch($z=$I[$k],$k){case"isStatic":$i.setStatic($x,$z);break;case"isSleeping":$l.set($x,$z);break;case"mass":$i.setMass($x,$z);break;case"density":$i.setDensity($x,$z);break;case"inertia":$i.setInertia($x,$z);break;case"vertices":$i.setVertices($x,$z);break;case"position":$i.setPosition($x,$z);break;case"angle":$i.setAngle($x,$z);break;case"velocity":$i.setVelocity($x,$z);break;case"angularVelocity":$i.setAngularVelocity($x,$z);break;case"parts":$i.setParts($x,$z);break;case"centre":$i.setCentre($x,$z);break;default:$x[$k]=$z}},$i.setStatic=function($x,$I){for(var $z=0;$z<$x.parts.length;$z++){var $k=$x.parts[$z];($k.isStatic=$I)?($k._original={restitution:$k.restitution,friction:$k.friction,mass:$k.mass,inertia:$k.inertia,density:$k.density,inverseMass:$k.inverseMass,inverseInertia:$k.inverseInertia},$k.restitution=0,$k.friction=1,$k.mass=$k.inertia=$k.density=1/0,$k.inverseMass=$k.inverseInertia=0,$k.positionPrev.x=$k.position.x,$k.positionPrev.y=$k.position.y,$k.anglePrev=$k.angle,$k.angularVelocity=0,$k.speed=0,$k.angularSpeed=0,$k.motion=0):$k._original&&($k.restitution=$k._original.restitution,$k.friction=$k._original.friction,$k.mass=$k._original.mass,$k.inertia=$k._original.inertia,$k.density=$k._original.density,$k.inverseMass=$k._original.inverseMass,$k.inverseInertia=$k._original.inverseInertia,$k._original=null)}},$i.setMass=function($x,$I){var $z=$x.inertia/($x.mass/6);$x.inertia=$I/6*$z,$x.inverseInertia=1/$x.inertia,$x.mass=$I,$x.inverseMass=1/$x.mass,$x.density=$x.mass/$x.area},$i.setDensity=function($x,$I){$i.setMass($x,$I*$x.area),$x.density=$I},$i.setInertia=function($x,$I){$x.inertia=$I,$x.inverseInertia=1/$x.inertia},$i.setVertices=function($x,$I){$I[0].body===$x?$x.vertices=$I:$x.vertices=$F.create($I,$x),$x.axes=$_.fromVertices($x.vertices),$x.area=$F.area($x.vertices),$i.setMass($x,$x.density*$x.area);var $z=$F.centre($x.vertices);$F.translate($x.vertices,$z,-1),$i.setInertia($x,$i._inertiaScale*$F.inertia($x.vertices,$x.mass)),$F.translate($x.vertices,$x.position),$T.update($x.bounds,$x.vertices,$x.velocity)},$i.setParts=function($x,$I,$z){var $k;for($I=$I.slice(0),$x.parts.length=0,$x.parts.push($x),$x.parent=$x,$k=0;$k<$I.length;$k++){var $l=$I[$k];$l!==$x&&($l.parent=$x).parts.push($l)}if(1!==$x.parts.length){if($z=void 0===$z||$z){var $n=[];for($k=0;$k<$I.length;$k++)$n=$n.concat($I[$k].vertices);$F.clockwiseSort($n);var $a=$F.hull($n),$$=$F.centre($a);$i.setVertices($x,$a),$F.translate($x.vertices,$$)}var $w=$i._totalProperties($x);$x.area=$w.area,($x.parent=$x).position.x=$w.centre.x,$x.position.y=$w.centre.y,$x.positionPrev.x=$w.centre.x,$x.positionPrev.y=$w.centre.y,$i.setMass($x,$w.mass),$i.setInertia($x,$w.inertia),$i.setPosition($x,$w.centre)}},$i.setCentre=function($x,$I,$z){$z?($x.positionPrev.x+=$I.x,$x.positionPrev.y+=$I.y,$x.position.x+=$I.x,$x.position.y+=$I.y):($x.positionPrev.x=$I.x-($x.position.x-$x.positionPrev.x),$x.positionPrev.y=$I.y-($x.position.y-$x.positionPrev.y),$x.position.x=$I.x,$x.position.y=$I.y)},$i.setPosition=function($x,$I){var $z=$b.sub($I,$x.position);$x.positionPrev.x+=$z.x,$x.positionPrev.y+=$z.y;for(var $k=0;$k<$x.parts.length;$k++){var $l=$x.parts[$k];$l.position.x+=$z.x,$l.position.y+=$z.y,$F.translate($l.vertices,$z),$T.update($l.bounds,$l.vertices,$x.velocity)}},$i.setAngle=function($x,$I){var $z=$I-$x.angle;$x.anglePrev+=$z;for(var $k=0;$k<$x.parts.length;$k++){var $l=$x.parts[$k];$l.angle+=$z,$F.rotate($l.vertices,$z,$x.position),$_.rotate($l.axes,$z),$T.update($l.bounds,$l.vertices,$x.velocity),0<$k&&$b.rotateAbout($l.position,$z,$x.position,$l.position)}},$i.setVelocity=function($x,$I){$x.positionPrev.x=$x.position.x-$I.x,$x.positionPrev.y=$x.position.y-$I.y,$x.velocity.x=$I.x,$x.velocity.y=$I.y,$x.speed=$b.magnitude($x.velocity)},$i.setAngularVelocity=function($x,$I){$x.anglePrev=$x.angle-$I,$x.angularVelocity=$I,$x.angularSpeed=Math.abs($x.angularVelocity)},$i.translate=function($x,$I){$i.setPosition($x,$b.add($x.position,$I))},$i.rotate=function($x,$I,$z){if($z){var $k=Math.cos($I),$l=Math.sin($I),$n=$x.position.x-$z.x,$a=$x.position.y-$z.y;$i.setPosition($x,{x:$z.x+($n*$k-$a*$l),y:$z.y+($n*$l+$a*$k)}),$i.setAngle($x,$x.angle+$I)}else $i.setAngle($x,$x.angle+$I)},$i.scale=function($x,$I,$z,$k){var $l=0,$n=0;$k=$k||$x.position;for(var $a=0;$a<$x.parts.length;$a++){var $$=$x.parts[$a];$F.scale($$.vertices,$I,$z,$k),$$.axes=$_.fromVertices($$.vertices),$$.area=$F.area($$.vertices),$i.setMass($$,$x.density*$$.area),$F.translate($$.vertices,{x:-$$.position.x,y:-$$.position.y}),$i.setInertia($$,$i._inertiaScale*$F.inertia($$.vertices,$$.mass)),$F.translate($$.vertices,{x:$$.position.x,y:$$.position.y}),0<$a&&($l+=$$.area,$n+=$$.inertia),$$.position.x=$k.x+($$.position.x-$k.x)*$I,$$.position.y=$k.y+($$.position.y-$k.y)*$z,$T.update($$.bounds,$$.vertices,$x.velocity)}1<$x.parts.length&&($x.area=$l,$x.isStatic||($i.setMass($x,$x.density*$l),$i.setInertia($x,$n))),$x.circleRadius&&($I===$z?$x.circleRadius*=$I:$x.circleRadius=null)},$i.update=function($x,$I,$z,$k){var $l=Math.pow($I*$z*$x.timeScale,2),$n=1-$x.frictionAir*$z*$x.timeScale,$a=$x.position.x-$x.positionPrev.x,$$=$x.position.y-$x.positionPrev.y;$x.velocity.x=$a*$n*$k+$x.force.x/$x.mass*$l,$x.velocity.y=$$*$n*$k+$x.force.y/$x.mass*$l,$x.positionPrev.x=$x.position.x,$x.positionPrev.y=$x.position.y,$x.position.x+=$x.velocity.x,$x.position.y+=$x.velocity.y,$x.angularVelocity=($x.angle-$x.anglePrev)*$n*$k+$x.torque/$x.inertia*$l,$x.anglePrev=$x.angle,$x.angle+=$x.angularVelocity,$x.speed=$b.magnitude($x.velocity),$x.angularSpeed=Math.abs($x.angularVelocity);for(var $w=0;$w<$x.parts.length;$w++){var $i=$x.parts[$w];$F.translate($i.vertices,$x.velocity),0<$w&&($i.position.x+=$x.velocity.x,$i.position.y+=$x.velocity.y),0!==$x.angularVelocity&&($F.rotate($i.vertices,$x.angularVelocity,$x.position),$_.rotate($i.axes,$x.angularVelocity),0<$w&&$b.rotateAbout($i.position,$x.angularVelocity,$x.position,$i.position)),$T.update($i.bounds,$i.vertices,$x.velocity)}},$i.applyForce=function($x,$I,$z){$x.force.x+=$z.x,$x.force.y+=$z.y;var $k=$I.x-$x.position.x,$l=$I.y-$x.position.y;$x.torque+=$k*$z.y-$l*$z.x},$i._totalProperties=function($x){for(var $I={mass:0,area:0,inertia:0,centre:{x:0,y:0}},$z=1===$x.parts.length?0:1;$z<$x.parts.length;$z++){var $k=$x.parts[$z],$l=$k.mass!==1/0?$k.mass:1;$I.mass+=$l,$I.area+=$k.area,$I.inertia+=$k.inertia,$I.centre=$b.add($I.centre,$b.mult($k.position,$l))}return $I.centre=$b.div($I.centre,$I.mass),$I}}()},function($x,$I,$z){var $F={};$x.exports=$F;var $k=$z(4);$F._motionWakeThreshold=.18,$F._motionSleepThreshold=.08,$F._minBias=.9,$F.update=function($x,$I){for(var $z=$I*$I*$I,$k=0;$k<$x.length;$k++){var $l=$x[$k],$n=$l.speed*$l.speed+$l.angularSpeed*$l.angularSpeed;if(0===$l.force.x&&0===$l.force.y){var $a=Math.min($l.motion,$n),$$=Math.max($l.motion,$n);$l.motion=$F._minBias*$a+(1-$F._minBias)*$$,0<$l.sleepThreshold&&$l.motion<$F._motionSleepThreshold*$z?($l.sleepCounter+=1,$l.sleepCounter>=$l.sleepThreshold&&$F.set($l,!0)):0<$l.sleepCounter&&($l.sleepCounter-=1)}else $F.set($l,!1)}},$F.afterCollisions=function($x,$I){for(var $z=$I*$I*$I,$k=0;$k<$x.length;$k++){var $l=$x[$k];if($l.isActive){var $n=$l.collision,$a=$n.bodyA.parent,$$=$n.bodyB.parent;if(!($a.isSleeping&&$$.isSleeping||$a.isStatic||$$.isStatic)&&($a.isSleeping||$$.isSleeping)){var $w=$a.isSleeping&&!$a.isStatic?$a:$$,$i=$w===$a?$$:$a;!$w.isStatic&&$i.motion>$F._motionWakeThreshold*$z&&$F.set($w,!1)}}}},$F.set=function($x,$I){var $z=$x.isSleeping;$I?($x.isSleeping=!0,$x.sleepCounter=$x.sleepThreshold,$x.positionImpulse.x=0,$x.positionImpulse.y=0,$x.positionPrev.x=$x.position.x,$x.positionPrev.y=$x.position.y,$x.anglePrev=$x.angle,$x.speed=0,$x.angularSpeed=0,$x.motion=0,$z||$k.trigger($x,"sleepStart")):($x.isSleeping=!1,$x.sleepCounter=0,$z&&$k.trigger($x,"sleepEnd"))}},function($x,$I,$z){var $R={};$x.exports=$R;var $N,$s,$D,$f=$z(3),$m=$z(9);$N=[],$s={overlap:0,axis:null},$D={overlap:0,axis:null},$R.create=function($x,$I){return{pair:null,collided:!1,bodyA:$x,bodyB:$I,parentA:$x.parent,parentB:$I.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},$R.collides=function($x,$I,$z){if($R._overlapAxes($s,$x.vertices,$I.vertices,$x.axes),$s.overlap<=0)return null;if($R._overlapAxes($D,$I.vertices,$x.vertices,$I.axes),$D.overlap<=0)return null;var $k,$l,$n=$z&&$z.table[$m.id($x,$I)];$n?$k=$n.collision:(($k=$R.create($x,$I)).collided=!0,$k.bodyA=$x.id<$I.id?$x:$I,$k.bodyB=$x.id<$I.id?$I:$x,$k.parentA=$k.bodyA.parent,$k.parentB=$k.bodyB.parent),$x=$k.bodyA,$I=$k.bodyB,$l=$s.overlap<$D.overlap?$s:$D;var $a=$k.normal,$$=$k.supports,$w=$l.axis,$i=$w.x,$F=$w.y;$i*($I.position.x-$x.position.x)+$F*($I.position.y-$x.position.y)<0?($a.x=$i,$a.y=$F):($a.x=-$i,$a.y=-$F),$k.tangent.x=-$a.y,$k.tangent.y=$a.x,$k.depth=$l.overlap,$k.penetration.x=$a.x*$k.depth,$k.penetration.y=$a.y*$k.depth;var $b=$R._findSupports($x,$I,$a,1),$T=0;if($f.contains($x.vertices,$b[0])&&($$[$T++]=$b[0]),$f.contains($x.vertices,$b[1])&&($$[$T++]=$b[1]),$T<2){var $_=$R._findSupports($I,$x,$a,-1);$f.contains($I.vertices,$_[0])&&($$[$T++]=$_[0]),$T<2&&$f.contains($I.vertices,$_[1])&&($$[$T++]=$_[1])}return 0===$T&&($$[$T++]=$b[0]),$$.length=$T,$k},$R._overlapAxes=function($x,$I,$z,$k){var $l,$n,$a,$$,$w,$i,$F=$I.length,$b=$z.length,$T=$I[0].x,$_=$I[0].y,$R=$z[0].x,$s=$z[0].y,$N=$k.length,$D=Number.MAX_VALUE,$f=0;for($w=0;$w<$N;$w++){var $m=$k[$w],$y=$m.x,$C=$m.y,$P=$T*$y+$_*$C,$v=$R*$y+$s*$C,$L=$P,$K=$v;for($i=1;$i<$F;$i+=1)$L<($$=$I[$i].x*$y+$I[$i].y*$C)?$L=$$:$$<$P&&($P=$$);for($i=1;$i<$b;$i+=1)$K<($$=$z[$i].x*$y+$z[$i].y*$C)?$K=$$:$$<$v&&($v=$$);if(($l=($n=$L-$v)<($a=$K-$P)?$n:$a)<$D&&($f=$w,($D=$l)<=0))break}$x.axis=$k[$f],$x.overlap=$D},$R._projectToAxis=function($x,$I,$z){for(var $k=$I[0].x*$z.x+$I[0].y*$z.y,$l=$k,$n=1;$n<$I.length;$n+=1){var $a=$I[$n].x*$z.x+$I[$n].y*$z.y;$l<$a?$l=$a:$a<$k&&($k=$a)}$x.min=$k,$x.max=$l},$R._findSupports=function($x,$I,$z,$k){var $l,$n,$a,$$,$w,$i=$I.vertices,$F=$i.length,$b=$x.position.x,$T=$x.position.y,$_=$z.x*$k,$R=$z.y*$k,$s=Number.MAX_VALUE;for($w=0;$w<$F;$w+=1)($$=$_*($b-($n=$i[$w]).x)+$R*($T-$n.y))<$s&&($s=$$,$l=$n);return $s=$_*($b-($a=$i[($F+$l.index-1)%$F]).x)+$R*($T-$a.y),$_*($b-($n=$i[($l.index+1)%$F]).x)+$R*($T-$n.y)<$s?($N[0]=$l,$N[1]=$n):($N[0]=$l,$N[1]=$a),$N}},function($x,$I,$z){var $n={};$x.exports=$n;var $_=$z(17);$n.create=function($x,$I){var $z=$x.bodyA,$k=$x.bodyB,$l={id:$n.id($z,$k),bodyA:$z,bodyB:$k,collision:$x,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:$z.isSensor||$k.isSensor,timeCreated:$I,timeUpdated:$I,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return $n.update($l,$x,$I),$l},$n.update=function($x,$I,$z){var $k=$x.contacts,$l=$I.supports,$n=$x.activeContacts,$a=$I.parentA,$$=$I.parentB,$w=$a.vertices.length;$x.isActive=!0,$x.timeUpdated=$z,$x.collision=$I,$x.separation=$I.depth,$x.inverseMass=$a.inverseMass+$$.inverseMass,$x.friction=$a.friction<$$.friction?$a.friction:$$.friction,$x.frictionStatic=$a.frictionStatic>$$.frictionStatic?$a.frictionStatic:$$.frictionStatic,$x.restitution=$a.restitution>$$.restitution?$a.restitution:$$.restitution,$x.slop=$a.slop>$$.slop?$a.slop:$$.slop,$I.pair=$x;for(var $i=$n.length=0;$i<$l.length;$i++){var $F=$l[$i],$b=$F.body===$a?$F.index:$w+$F.index,$T=$k[$b];$T?$n.push($T):$n.push($k[$b]=$_.create($F))}},$n.setActive=function($x,$I,$z){$I?($x.isActive=!0,$x.timeUpdated=$z):($x.isActive=!1,$x.activeContacts.length=0)},$n.id=function($x,$I){return $x.id<$I.id?"A"+$x.id+"B"+$I.id:"A"+$I.id+"B"+$x.id}},function($x,$I,$z){var $C={};$x.exports=$C;var $a=$z(3),$P=$z(2),$$=$z(7),$w=$z(1),$i=$z(11),$F=$z(0);$C._warming=.4,$C._torqueDampen=1,$C._minLength=1e-6,$C.create=function($x){var $I=$x;$I.bodyA&&!$I.pointA&&($I.pointA={x:0,y:0}),$I.bodyB&&!$I.pointB&&($I.pointB={x:0,y:0});var $z=$I.bodyA?$P.add($I.bodyA.position,$I.pointA):$I.pointA,$k=$I.bodyB?$P.add($I.bodyB.position,$I.pointB):$I.pointB,$l=$P.magnitude($P.sub($z,$k));$I.length=void 0!==$I.length?$I.length:$l,$I.id=$I.id||$F.nextId(),$I.label=$I.label||"Constraint",$I.type="constraint",$I.stiffness=$I.stiffness||(0<$I.length?1:.7),$I.damping=$I.damping||0,$I.angularStiffness=$I.angularStiffness||0,$I.angleA=$I.bodyA?$I.bodyA.angle:$I.angleA,$I.angleB=$I.bodyB?$I.bodyB.angle:$I.angleB,$I.plugin={};var $n={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===$I.length&&.1<$I.stiffness?($n.type="pin",$n.anchors=!1):$I.stiffness<.9&&($n.type="spring"),$I.render=$F.extend($n,$I.render),$I},$C.preSolveAll=function($x){for(var $I=0;$I<$x.length;$I+=1){var $z=$x[$I],$k=$z.constraintImpulse;$z.isStatic||0===$k.x&&0===$k.y&&0===$k.angle||($z.position.x+=$k.x,$z.position.y+=$k.y,$z.angle+=$k.angle)}},$C.solveAll=function($x,$I){for(var $z=0;$z<$x.length;$z+=1){var $k=$x[$z],$l=!$k.bodyA||$k.bodyA&&$k.bodyA.isStatic,$n=!$k.bodyB||$k.bodyB&&$k.bodyB.isStatic;($l||$n)&&$C.solve($x[$z],$I)}for($z=0;$z<$x.length;$z+=1)$l=!($k=$x[$z]).bodyA||$k.bodyA&&$k.bodyA.isStatic,$n=!$k.bodyB||$k.bodyB&&$k.bodyB.isStatic,$l||$n||$C.solve($x[$z],$I)},$C.solve=function($x,$I){var $z=$x.bodyA,$k=$x.bodyB,$l=$x.pointA,$n=$x.pointB;if($z||$k){$z&&!$z.isStatic&&($P.rotate($l,$z.angle-$x.angleA,$l),$x.angleA=$z.angle),$k&&!$k.isStatic&&($P.rotate($n,$k.angle-$x.angleB,$n),$x.angleB=$k.angle);var $a=$l,$$=$n;if($z&&($a=$P.add($z.position,$l)),$k&&($$=$P.add($k.position,$n)),$a&&$$){var $w=$P.sub($a,$$),$i=$P.magnitude($w);$i<$C._minLength&&($i=$C._minLength);var $F,$b,$T,$_,$R,$s=($i-$x.length)/$i,$N=$x.stiffness<1?$x.stiffness*$I:$x.stiffness,$D=$P.mult($w,$s*$N),$f=($z?$z.inverseMass:0)+($k?$k.inverseMass:0),$m=$f+(($z?$z.inverseInertia:0)+($k?$k.inverseInertia:0));if($x.damping){var $y=$P.create();$T=$P.div($w,$i),$R=$P.sub($k&&$P.sub($k.position,$k.positionPrev)||$y,$z&&$P.sub($z.position,$z.positionPrev)||$y),$_=$P.dot($T,$R)}$z&&!$z.isStatic&&($b=$z.inverseMass/$f,$z.constraintImpulse.x-=$D.x*$b,$z.constraintImpulse.y-=$D.y*$b,$z.position.x-=$D.x*$b,$z.position.y-=$D.y*$b,$x.damping&&($z.positionPrev.x-=$x.damping*$T.x*$_*$b,$z.positionPrev.y-=$x.damping*$T.y*$_*$b),$F=$P.cross($l,$D)/$m*$C._torqueDampen*$z.inverseInertia*(1-$x.angularStiffness),$z.constraintImpulse.angle-=$F,$z.angle-=$F),$k&&!$k.isStatic&&($b=$k.inverseMass/$f,$k.constraintImpulse.x+=$D.x*$b,$k.constraintImpulse.y+=$D.y*$b,$k.position.x+=$D.x*$b,$k.position.y+=$D.y*$b,$x.damping&&($k.positionPrev.x+=$x.damping*$T.x*$_*$b,$k.positionPrev.y+=$x.damping*$T.y*$_*$b),$F=$P.cross($n,$D)/$m*$C._torqueDampen*$k.inverseInertia*(1-$x.angularStiffness),$k.constraintImpulse.angle+=$F,$k.angle+=$F)}}},$C.postSolveAll=function($x){for(var $I=0;$I<$x.length;$I++){var $z=$x[$I],$k=$z.constraintImpulse;if(!($z.isStatic||0===$k.x&&0===$k.y&&0===$k.angle)){$$.set($z,!1);for(var $l=0;$l<$z.parts.length;$l++){var $n=$z.parts[$l];$a.translate($n.vertices,$k),0<$l&&($n.position.x+=$k.x,$n.position.y+=$k.y),0!==$k.angle&&($a.rotate($n.vertices,$k.angle,$z.position),$i.rotate($n.axes,$k.angle),0<$l&&$P.rotateAbout($n.position,$k.angle,$z.position,$n.position)),$w.update($n.bounds,$n.vertices,$z.velocity)}$k.angle*=$C._warming,$k.x*=$C._warming,$k.y*=$C._warming}}},$C.pointAWorld=function($x){return{x:($x.bodyA?$x.bodyA.position.x:0)+$x.pointA.x,y:($x.bodyA?$x.bodyA.position.y:0)+$x.pointA.y}},$C.pointBWorld=function($x){return{x:($x.bodyB?$x.bodyB.position.x:0)+$x.pointB.x,y:($x.bodyB?$x.bodyB.position.y:0)+$x.pointB.y}}},function($x,$I,$z){var $k={};$x.exports=$k;var $a=$z(2),$$=$z(0);$k.fromVertices=function($x){for(var $I={},$z=0;$z<$x.length;$z++){var $k=($z+1)%$x.length,$l=$a.normalise({x:$x[$k].y-$x[$z].y,y:$x[$z].x-$x[$k].x}),$n=0===$l.y?1/0:$l.x/$l.y;$I[$n=$n.toFixed(3).toString()]=$l}return $$.values($I)},$k.rotate=function($x,$I){if(0!==$I)for(var $z=Math.cos($I),$k=Math.sin($I),$l=0;$l<$x.length;$l++){var $n,$a=$x[$l];$n=$a.x*$z-$a.y*$k,$a.y=$a.x*$k+$a.y*$z,$a.x=$n}}},function($x,$I,$z){var $R={};$x.exports=$R;var $S=$z(3),$Z=$z(0),$U=$z(6),$X=$z(1),$d=$z(2);$R.rectangle=function($x,$I,$z,$k,$l){$l=$l||{};var $n={label:"Rectangle Body",position:{x:$x,y:$I},vertices:$S.fromPath("L 0 0 L "+$z+" 0 L "+$z+" "+$k+" L 0 "+$k)};if($l.chamfer){var $a=$l.chamfer;$n.vertices=$S.chamfer($n.vertices,$a.radius,$a.quality,$a.qualityMin,$a.qualityMax),delete $l.chamfer}return $U.create($Z.extend({},$n,$l))},$R.trapezoid=function($x,$I,$z,$k,$l,$n){$n=$n||{};var $a,$$=$z*($l*=.5),$w=$$+(1-2*$l)*$z,$i=$w+$$;$a=$l<.5?"L 0 0 L "+$$+" "+-$k+" L "+$w+" "+-$k+" L "+$i+" 0":"L 0 0 L "+$w+" "+-$k+" L "+$i+" 0";var $F={label:"Trapezoid Body",position:{x:$x,y:$I},vertices:$S.fromPath($a)};if($n.chamfer){var $b=$n.chamfer;$F.vertices=$S.chamfer($F.vertices,$b.radius,$b.quality,$b.qualityMin,$b.qualityMax),delete $n.chamfer}return $U.create($Z.extend({},$F,$n))},$R.circle=function($x,$I,$z,$k,$l){$k=$k||{};var $n={label:"Circle Body",circleRadius:$z};$l=$l||25;var $a=Math.ceil(Math.max(10,Math.min($l,$z)));return $a%2==1&&($a+=1),$R.polygon($x,$I,$a,$z,$Z.extend({},$n,$k))},$R.polygon=function($x,$I,$z,$k,$l){if($l=$l||{},$z<3)return $R.circle($x,$I,$k,$l);for(var $n=2*Math.PI/$z,$a="",$$=.5*$n,$w=0;$w<$z;$w+=1){var $i=$$+$w*$n,$F=Math.cos($i)*$k,$b=Math.sin($i)*$k;$a+="L "+$F.toFixed(3)+" "+$b.toFixed(3)+" "}var $T={label:"Polygon Body",position:{x:$x,y:$I},vertices:$S.fromPath($a)};if($l.chamfer){var $_=$l.chamfer;$T.vertices=$S.chamfer($T.vertices,$_.radius,$_.quality,$_.qualityMin,$_.qualityMax),delete $l.chamfer}return $U.create($Z.extend({},$T,$l))},$R.fromVertices=function($x,$I,$z,$k,$l,$n,$a,$$){var $w,$i,$F,$b,$T,$_,$R,$s,$N,$D,$f=$Z.getDecomp();for($w=Boolean($f&&$f.quickDecomp),$k=$k||{},$F=[],$l=void 0!==$l&&$l,$n=void 0!==$n?$n:.01,$a=void 0!==$a?$a:10,$$=void 0!==$$?$$:.01,$Z.isArray($z[0])||($z=[$z]),$N=0;$N<$z.length;$N+=1)if($T=$z[$N],!($b=$S.isConvex($T))&&!$w&&$Z.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),$b||!$w)$T=$b?$S.clockwiseSort($T):$S.hull($T),$F.push({position:{x:$x,y:$I},vertices:$T});else{var $m=$T.map(function($x){return[$x.x,$x.y]});$f.makeCCW($m),!1!==$n&&$f.removeCollinearPoints($m,$n),!1!==$$&&$f.removeDuplicatePoints&&$f.removeDuplicatePoints($m,$$);var $y=$f.quickDecomp($m);for($_=0;$_<$y.length;$_++){var $C=$y[$_].map(function($x){return{x:$x[0],y:$x[1]}});0<$a&&$S.area($C)<$a||$F.push({position:$S.centre($C),vertices:$C})}}for($_=0;$_<$F.length;$_++)$F[$_]=$U.create($Z.extend($F[$_],$k));if($l)for($_=0;$_<$F.length;$_++){var $P=$F[$_];for($R=$_+1;$R<$F.length;$R++){var $v=$F[$R];if($X.overlaps($P.bounds,$v.bounds)){var $L=$P.vertices,$K=$v.vertices;for($s=0;$s<$P.vertices.length;$s++)for($D=0;$D<$v.vertices.length;$D++){var $E=$d.magnitudeSquared($d.sub($L[($s+1)%$L.length],$K[$D])),$O=$d.magnitudeSquared($d.sub($L[$s],$K[($D+1)%$K.length]));$E<5&&$O<5&&($L[$s].isInternal=!0,$K[$D].isInternal=!0)}}}}return 1<$F.length?($i=$U.create($Z.extend({parts:$F.slice(0)},$k)),$U.setPosition($i,{x:$x,y:$I}),$i):$F[0]}},function($x,$I,$z){var $k={};$x.exports=$k;var $l=$z(0);$k.create=function($x){var $z={};return $x||$l.log("Mouse.create: element was undefined, defaulting to document.body","warn"),$z.element=$x||document.body,$z.absolute={x:0,y:0},$z.position={x:0,y:0},$z.mousedownPosition={x:0,y:0},$z.mouseupPosition={x:0,y:0},$z.mouseoutPosition={x:0,y:0},$z.offset={x:0,y:0},$z.scale={x:1,y:1},$z.wheelDelta=0,$z.button=-1,$z.pixelRatio=parseInt($z.element.getAttribute("data-pixel-ratio"),10)||1,$z.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mouseout:null,mousewheel:null},$z.mousemove=function($x){var $I=$k._getRelativeMousePosition($x,$z.element,$z.pixelRatio);$x.changedTouches&&($z.button=0,$x.preventDefault()),$z.absolute.x=$I.x,$z.absolute.y=$I.y,$z.position.x=$z.absolute.x*$z.scale.x+$z.offset.x,$z.position.y=$z.absolute.y*$z.scale.y+$z.offset.y,$z.sourceEvents.mousemove=$x},$z.mousedown=function($x){var $I=$k._getRelativeMousePosition($x,$z.element,$z.pixelRatio);$x.changedTouches?($z.button=0,$x.preventDefault()):$z.button=$x.button,$z.absolute.x=$I.x,$z.absolute.y=$I.y,$z.position.x=$z.absolute.x*$z.scale.x+$z.offset.x,$z.position.y=$z.absolute.y*$z.scale.y+$z.offset.y,$z.mousedownPosition.x=$z.position.x,$z.mousedownPosition.y=$z.position.y,$z.sourceEvents.mousedown=$x},$z.mouseup=function($x){var $I=$k._getRelativeMousePosition($x,$z.element,$z.pixelRatio);$x.changedTouches&&$x.preventDefault(),$z.button=-1,$z.absolute.x=$I.x,$z.absolute.y=$I.y,$z.position.x=$z.absolute.x*$z.scale.x+$z.offset.x,$z.position.y=$z.absolute.y*$z.scale.y+$z.offset.y,$z.mouseupPosition.x=$z.position.x,$z.mouseupPosition.y=$z.position.y,$z.sourceEvents.mouseup=$x},$z.mouseout=function($x){var $I=$k._getRelativeMousePosition($x,$z.element,$z.pixelRatio);$x.changedTouches&&$x.preventDefault(),$z.button=-1,$z.absolute.x=$I.x,$z.absolute.y=$I.y,$z.position.x=$z.absolute.x*$z.scale.x+$z.offset.x,$z.position.y=$z.absolute.y*$z.scale.y+$z.offset.y,$z.mouseoutPosition.x=$z.position.x,$z.mouseoutPosition.y=$z.position.y,$z.sourceEvents.mouseout=$x},$z.mousewheel=function($x){$z.wheelDelta=Math.max(-1,Math.min(1,$x.wheelDelta||-$x.detail)),$x.preventDefault()},$k.setElement($z,$z.element),$z},$k.setElement=function($x,$I){($x.element=$I).addEventListener("mousemove",$x.mousemove),$I.addEventListener("mousedown",$x.mousedown),$I.addEventListener("mouseup",$x.mouseup),$I.addEventListener("mouseout",$x.mouseout),$I.addEventListener("mousewheel",$x.mousewheel),$I.addEventListener("DOMMouseScroll",$x.mousewheel),$I.addEventListener("touchmove",$x.mousemove),$I.addEventListener("touchstart",$x.mousedown),$I.addEventListener("touchend",$x.mouseup),$I.addEventListener("touchcancel",$x.mouseup)},$k.clearSourceEvents=function($x){$x.sourceEvents.mousemove=null,$x.sourceEvents.mousedown=null,$x.sourceEvents.mouseup=null,$x.sourceEvents.mouseout=null,$x.sourceEvents.mousewheel=null,$x.wheelDelta=0},$k.setOffset=function($x,$I){$x.offset.x=$I.x,$x.offset.y=$I.y,$x.position.x=$x.absolute.x*$x.scale.x+$x.offset.x,$x.position.y=$x.absolute.y*$x.scale.y+$x.offset.y},$k.setScale=function($x,$I){$x.scale.x=$I.x,$x.scale.y=$I.y,$x.position.x=$x.absolute.x*$x.scale.x+$x.offset.x,$x.position.y=$x.absolute.y*$x.scale.y+$x.offset.y},$k._getRelativeMousePosition=function($x,$I,$z){var $k,$l,$n=$I.getBoundingClientRect(),$a=document.documentElement||document.body.parentNode||document.body,$$=void 0!==window.pageXOffset?window.pageXOffset:$a.scrollLeft,$w=void 0!==window.pageYOffset?window.pageYOffset:$a.scrollTop,$i=$x.changedTouches;$$=$$||0,$w=$w||0,$l=$i?($k=$i[0].pageX-$n.left-$$,$i[0].pageY-$n.top-$w):($k=$x.pageX-$n.left-$$,$x.pageY-$n.top-$w);var $F=$I.clientWidth||$I.width,$b=$I.clientHeight||$I.height;return{x:$k/($F/($I.width||$F)*$z),y:$l/($b/($I.height||$b)*$z)}}},function($x,$I,$z){var $E={};$x.exports=$E;var $k=$z(0),$O=$z(8);$E.create=function($x){return $k.extend({bodies:[],pairs:null},$x)},$E.setBodies=function($x,$I){$x.bodies=$I.slice(0)},$E.clear=function($x){$x.bodies=[]},$E.collisions=function($x){var $I,$z,$k=[],$l=$x.pairs,$n=$x.bodies,$a=$n.length,$$=$E.canCollide,$w=$O.collides;for($n.sort($E._compareBoundsX),$I=0;$I<$a;$I++){var $i=$n[$I],$F=$i.bounds,$b=$i.bounds.max.x,$T=$i.bounds.max.y,$_=$i.bounds.min.y,$R=$i.isStatic||$i.isSleeping,$s=$i.parts.length,$N=1===$s;for($z=$I+1;$z<$a;$z++){var $D=$n[$z];if(($K=$D.bounds).min.x>$b)break;if(!($T<$K.min.y||$_>$K.max.y)&&(!$R||!$D.isStatic&&!$D.isSleeping)&&$$($i.collisionFilter,$D.collisionFilter)){var $f=$D.parts.length;if($N&&1===$f)($v=$w($i,$D,$l))&&$k.push($v);else for(var $m=1<$f?1:0,$y=1<$s?1:0;$y<$s;$y++)for(var $C=$i.parts[$y],$P=($F=$C.bounds,$m);$P<$f;$P++){var $v,$L=$D.parts[$P],$K=$L.bounds;$F.min.x>$K.max.x||$F.max.x<$K.min.x||$F.max.y<$K.min.y||$F.min.y>$K.max.y||($v=$w($C,$L,$l))&&$k.push($v)}}}}return $k},$E.canCollide=function($x,$I){return $x.group===$I.group&&0!==$x.group?0<$x.group:0!=($x.mask&$I.category)&&0!=($I.mask&$x.category)},$E._compareBoundsX=function($x,$I){return $x.bounds.min.x-$I.bounds.min.x}},function($x,$I,$z){var $$={};$x.exports=$$;var $w=$z(0);$$._registry={},$$.register=function($x){if($$.isPlugin($x)||$w.warn("Plugin.register:",$$.toString($x),"does not implement all required fields."),$x.name in $$._registry){var $I=$$._registry[$x.name],$z=$$.versionParse($x.version).number,$k=$$.versionParse($I.version).number;$k<$z?($w.warn("Plugin.register:",$$.toString($I),"was upgraded to",$$.toString($x)),$$._registry[$x.name]=$x):$z<$k?$w.warn("Plugin.register:",$$.toString($I),"can not be downgraded to",$$.toString($x)):$x!==$I&&$w.warn("Plugin.register:",$$.toString($x),"is already registered to different plugin object")}else $$._registry[$x.name]=$x;return $x},$$.resolve=function($x){return $$._registry[$$.dependencyParse($x).name]},$$.toString=function($x){return"string"==typeof $x?$x:($x.name||"anonymous")+"@"+($x.version||$x.range||"0.0.0")},$$.isPlugin=function($x){return $x&&$x.name&&$x.version&&$x.install},$$.isUsed=function($x,$I){return-1<$x.used.indexOf($I)},$$.isFor=function($x,$I){var $z=$x.for&&$$.dependencyParse($x.for);return!$x.for||$I.name===$z.name&&$$.versionSatisfies($I.version,$z.range)},$$.use=function($x,$I){if($x.uses=($x.uses||[]).concat($I||[]),0!==$x.uses.length){for(var $z=$$.dependencies($x),$k=$w.topologicalSort($z),$l=[],$n=0;$n<$k.length;$n+=1)if($k[$n]!==$x.name){var $a=$$.resolve($k[$n]);$a?$$.isUsed($x,$a.name)||($$.isFor($a,$x)||($w.warn("Plugin.use:",$$.toString($a),"is for",$a.for,"but installed on",$$.toString($x)+"."),$a._warned=!0),$a.install?$a.install($x):($w.warn("Plugin.use:",$$.toString($a),"does not specify an install function."),$a._warned=!0),$a._warned?($l.push("🔶 "+$$.toString($a)),delete $a._warned):$l.push("✅ "+$$.toString($a)),$x.used.push($a.name)):$l.push("❌ "+$k[$n])}0<$l.length&&$w.info($l.join("  "))}else $w.warn("Plugin.use:",$$.toString($x),"does not specify any dependencies to install.")},$$.dependencies=function($k,$x){var $l=$$.dependencyParse($k),$I=$l.name;if(!($I in($x=$x||{}))){$k=$$.resolve($k)||$k,$x[$I]=$w.map($k.uses||[],function($x){$$.isPlugin($x)&&$$.register($x);var $I=$$.dependencyParse($x),$z=$$.resolve($x);return $z&&!$$.versionSatisfies($z.version,$I.range)?($w.warn("Plugin.dependencies:",$$.toString($z),"does not satisfy",$$.toString($I),"used by",$$.toString($l)+"."),$z._warned=!0,$k._warned=!0):$z||($w.warn("Plugin.dependencies:",$$.toString($x),"used by",$$.toString($l),"could not be resolved."),$k._warned=!0),$I.name});for(var $z=0;$z<$x[$I].length;$z+=1)$$.dependencies($x[$I][$z],$x);return $x}},$$.dependencyParse=function($x){return $w.isString($x)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test($x)||$w.warn("Plugin.dependencyParse:",$x,"is not a valid dependency string."),{name:$x.split("@")[0],range:$x.split("@")[1]||"*"}):{name:$x.name,range:$x.range||$x.version}},$$.versionParse=function($x){var $I=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;$I.test($x)||$w.warn("Plugin.versionParse:",$x,"is not a valid version or range.");var $z=$I.exec($x),$k=Number($z[4]),$l=Number($z[5]),$n=Number($z[6]);return{isRange:Boolean($z[1]||$z[2]),version:$z[3],range:$x,operator:$z[1]||$z[2]||"",major:$k,minor:$l,patch:$n,parts:[$k,$l,$n],prerelease:$z[7],number:1e8*$k+1e4*$l+$n}},$$.versionSatisfies=function($x,$I){$I=$I||"*";var $z=$$.versionParse($I),$k=$$.versionParse($x);if($z.isRange){if("*"===$z.operator||"*"===$x)return!0;if(">"===$z.operator)return $k.number>$z.number;if(">="===$z.operator)return $k.number>=$z.number;if("~"===$z.operator)return $k.major===$z.major&&$k.minor===$z.minor&&$k.patch>=$z.patch;if("^"===$z.operator)return 0<$z.major?$k.major===$z.major&&$k.number>=$z.number:0<$z.minor?$k.minor===$z.minor&&$k.patch>=$z.patch:$k.patch===$z.patch}return $x===$I||"*"===$x}},function($x,$I,$z){var $v={};$x.exports=$v;var $L=$z(0),$K=$z(5),$E=$z(1),$O=$z(4),$S=$z(2),$Z=$z(13);!function(){$v._goodFps=30,$v._goodDelta=1e3/60,$v.create=function($x){var $I={controller:$v,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!$x.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},$z=$L.extend($I,$x);return $z.canvas&&($z.canvas.width=$z.options.width||$z.canvas.width,$z.canvas.height=$z.options.height||$z.canvas.height),$z.mouse=$x.mouse,$z.engine=$x.engine,$z.canvas=$z.canvas||$k($z.options.width,$z.options.height),$z.context=$z.canvas.getContext("2d"),$z.textures={},$z.bounds=$z.bounds||{min:{x:0,y:0},max:{x:$z.canvas.width,y:$z.canvas.height}},$z.options.showBroadphase=!1,1!==$z.options.pixelRatio&&$v.setPixelRatio($z,$z.options.pixelRatio),$L.isElement($z.element)?$z.element.appendChild($z.canvas):$z.canvas.parentNode||$L.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),$z},$v.run=function($x){Laya.timer.clear(this,$v.loop),Laya.timer.frameLoop(1,this,$v.loop,[$x])},$v.loop=function($x){var $I=$L.now();$z($x,$I),$v.world($x,$I),($x.options.showStats||$x.options.showDebug)&&$v.stats($x,$x.context,$I),($x.options.showPerformance||$x.options.showDebug)&&$v.performance($x,$x.context,$I)},$v.stop=function($x){Laya.timer.clear(this,$v.loop)},$v.setPixelRatio=function($x,$I){var $z=$x.options,$k=$x.canvas;"auto"===$I&&($I=$l($k)),$z.pixelRatio=$I,$k.setAttribute("data-pixel-ratio",$I),$k.width=$z.width*$I,$k.height=$z.height*$I,$k.style.width=$z.width+"px",$k.style.height=$z.height+"px"},$v.lookAt=function($x,$I,$z,$k){$k=void 0===$k||$k,$I=$L.isArray($I)?$I:[$I],$z=$z||{x:0,y:0};for(var $l={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},$n=0;$n<$I.length;$n+=1){var $a=$I[$n],$$=$a.bounds?$a.bounds.min:$a.min||$a.position||$a,$w=$a.bounds?$a.bounds.max:$a.max||$a.position||$a;$$&&$w&&($$.x<$l.min.x&&($l.min.x=$$.x),$w.x>$l.max.x&&($l.max.x=$w.x),$$.y<$l.min.y&&($l.min.y=$$.y),$w.y>$l.max.y&&($l.max.y=$w.y))}var $i=$l.max.x-$l.min.x+2*$z.x,$F=$l.max.y-$l.min.y+2*$z.y,$b=$x.canvas.height,$T=$x.canvas.width/$b,$_=$i/$F,$R=1,$s=1;$T<$_?$s=$_/$T:$R=$T/$_,$x.options.hasBounds=!0,$x.bounds.min.x=$l.min.x,$x.bounds.max.x=$l.min.x+$i*$R,$x.bounds.min.y=$l.min.y,$x.bounds.max.y=$l.min.y+$F*$s,$k&&($x.bounds.min.x+=.5*$i-$i*$R*.5,$x.bounds.max.x+=.5*$i-$i*$R*.5,$x.bounds.min.y+=.5*$F-$F*$s*.5,$x.bounds.max.y+=.5*$F-$F*$s*.5),$x.bounds.min.x-=$z.x,$x.bounds.max.x-=$z.x,$x.bounds.min.y-=$z.y,$x.bounds.max.y-=$z.y,$x.mouse&&($Z.setScale($x.mouse,{x:($x.bounds.max.x-$x.bounds.min.x)/$x.canvas.width,y:($x.bounds.max.y-$x.bounds.min.y)/$x.canvas.height}),$Z.setOffset($x.mouse,$x.bounds.min))},$v.startViewTransform=function($x){var $I=$x.bounds.max.x-$x.bounds.min.x,$z=$x.bounds.max.y-$x.bounds.min.y,$k=$I/$x.options.width,$l=$z/$x.options.height;$x.context.setTransform($x.options.pixelRatio/$k,0,0,$x.options.pixelRatio/$l,0,0),$x.context.translate(-$x.bounds.min.x,-$x.bounds.min.y)},$v.endViewTransform=function($x){$x.context.setTransform($x.options.pixelRatio,0,0,$x.options.pixelRatio,0,0)},$v.world=function($x,$I){var $z,$k=$L.now(),$l=$x.engine,$n=$l.world,$a=$x.canvas,$$=$x.context,$w=$x.options,$i=$x.timing,$F=$K.allBodies($n),$b=$K.allConstraints($n),$T=$w.wireframes?$w.wireframeBackground:$w.background,$_=[],$R=[],$s={timestamp:$l.timing.timestamp};if($O.trigger($x,"beforeRender",$s),$x.currentBackground!==$T&&$P($x,$T),$$.globalCompositeOperation="source-in",$$.fillStyle="transparent",$$.fillRect(0,0,$a.width,$a.height),$$.globalCompositeOperation="source-over",$w.hasBounds){for($z=0;$z<$F.length;$z++){var $N=$F[$z];$E.overlaps($N.bounds,$x.bounds)&&$_.push($N)}for($z=0;$z<$b.length;$z++){var $D=$b[$z],$f=$D.bodyA,$m=$D.bodyB,$y=$D.pointA,$C=$D.pointB;$f&&($y=$S.add($f.position,$D.pointA)),$m&&($C=$S.add($m.position,$D.pointB)),$y&&$C&&(($E.contains($x.bounds,$y)||$E.contains($x.bounds,$C))&&$R.push($D))}$v.startViewTransform($x),$x.mouse&&($Z.setScale($x.mouse,{x:($x.bounds.max.x-$x.bounds.min.x)/$x.options.width,y:($x.bounds.max.y-$x.bounds.min.y)/$x.options.height}),$Z.setOffset($x.mouse,$x.bounds.min))}else $R=$b,$_=$F,1!==$x.options.pixelRatio&&$x.context.setTransform($x.options.pixelRatio,0,0,$x.options.pixelRatio,0,0);!$w.wireframes||$l.enableSleeping&&$w.showSleeping?$v.bodies($x,$_,$$):($w.showConvexHulls&&$v.bodyConvexHulls($x,$_,$$),$v.bodyWireframes($x,$_,$$)),$w.showBounds&&$v.bodyBounds($x,$_,$$),($w.showAxes||$w.showAngleIndicator)&&$v.bodyAxes($x,$_,$$),$w.showPositions&&$v.bodyPositions($x,$_,$$),$w.showVelocity&&$v.bodyVelocity($x,$_,$$),$w.showIds&&$v.bodyIds($x,$_,$$),$w.showSeparations&&$v.separations($x,$l.pairs.list,$$),$w.showCollisions&&$v.collisions($x,$l.pairs.list,$$),$w.showVertexNumbers&&$v.vertexNumbers($x,$_,$$),$w.showMousePosition&&$v.mousePosition($x,$x.mouse,$$),$v.constraints($R,$$),$w.hasBounds&&$v.endViewTransform($x),$O.trigger($x,"afterRender",$s),$i.lastElapsed=$L.now()-$k},$v.stats=function($x,$I,$z){for(var $k=$x.engine,$l=$k.world,$n=$K.allBodies($l),$a=0,$$=0,$w=0;$w<$n.length;$w+=1)$a+=$n[$w].parts.length;var $i={Part:$a,Body:$n.length,Cons:$K.allConstraints($l).length,Comp:$K.allComposites($l).length,Pair:$k.pairs.list.length};for(var $F in $I.fillStyle="#0e0f19",$I.fillRect($$,0,302.5,44),$I.font="12px Arial",$I.textBaseline="top",$I.textAlign="right",$i){var $b=$i[$F];$I.fillStyle="#aaa",$I.fillText($F,$$+55,8),$I.fillStyle="#eee",$I.fillText($b,$$+55,26),$$+=55}},$v.performance=function($x,$I){var $z=$x.engine,$k=$x.timing,$l=$k.deltaHistory,$n=$k.elapsedHistory,$a=$k.timestampElapsedHistory,$$=$k.engineDeltaHistory,$w=$k.engineElapsedHistory,$i=$z.timing.lastDelta,$F=$N($l),$b=$N($n),$T=$N($$),$_=$N($w),$R=$N($a)/$F||0,$s=1e3/$F||0;$I.fillStyle="#0e0f19",$I.fillRect(0,50,370,34),$v.status($I,10,69,60,4,$l.length,Math.round($s)+" fps",$s/$v._goodFps,function($x){return $l[$x]/$F-1}),$v.status($I,82,69,60,4,$$.length,$i.toFixed(2)+" dt",$v._goodDelta/$i,function($x){return $$[$x]/$T-1}),$v.status($I,154,69,60,4,$w.length,$_.toFixed(2)+" ut",1-$_/$v._goodFps,function($x){return $w[$x]/$_-1}),$v.status($I,226,69,60,4,$n.length,$b.toFixed(2)+" rt",1-$b/$v._goodFps,function($x){return $n[$x]/$b-1}),$v.status($I,298,69,60,4,$a.length,$R.toFixed(2)+" x",$R*$R*$R,function($x){return($a[$x]/$l[$x]/$R||0)-1})},$v.status=function($x,$I,$z,$k,$l,$n,$a,$$,$w){$x.strokeStyle="#888",$x.fillStyle="#444",$x.lineWidth=1,$x.fillRect($I,$z+7,$k,1),$x.beginPath(),$x.moveTo($I,$z+7-$l*$L.clamp(.4*$w(0),-2,2));for(var $i=0;$i<$k;$i+=1)$x.lineTo($I+$i,$z+7-($i<$n?$l*$L.clamp(.4*$w($i),-2,2):0));$x.stroke(),$x.fillStyle="hsl("+$L.clamp(25+95*$$,0,120)+",100%,60%)",$x.fillRect($I,$z-7,4,4),$x.font="12px Arial",$x.textBaseline="middle",$x.textAlign="right",$x.fillStyle="#eee",$x.fillText($a,$I+$k,$z-5)},$v.constraints=function($x,$I){for(var $z=$I,$k=0;$k<$x.length;$k++){var $l=$x[$k];if($l.render.visible&&$l.pointA&&$l.pointB){var $n,$a,$$=$l.bodyA,$w=$l.bodyB;if($n=$$?$S.add($$.position,$l.pointA):$l.pointA,"pin"===$l.render.type)$z.beginPath(),$z.arc($n.x,$n.y,3,0,2*Math.PI),$z.closePath();else{if($a=$w?$S.add($w.position,$l.pointB):$l.pointB,$z.beginPath(),$z.moveTo($n.x,$n.y),"spring"===$l.render.type)for(var $i,$F=$S.sub($a,$n),$b=$S.perp($S.normalise($F)),$T=Math.ceil($L.clamp($l.length/5,12,20)),$_=1;$_<$T;$_+=1)$i=$_%2==0?1:-1,$z.lineTo($n.x+$F.x*($_/$T)+$b.x*$i*4,$n.y+$F.y*($_/$T)+$b.y*$i*4);$z.lineTo($a.x,$a.y)}$l.render.lineWidth&&($z.lineWidth=$l.render.lineWidth,$z.strokeStyle=$l.render.strokeStyle,$z.stroke()),$l.render.anchors&&($z.fillStyle=$l.render.strokeStyle,$z.beginPath(),$z.arc($n.x,$n.y,3,0,2*Math.PI),$z.arc($a.x,$a.y,3,0,2*Math.PI),$z.closePath(),$z.fill())}}},$v.bodies=function($x,$I,$z){var $k,$l,$n,$a,$$=$z,$w=($x.engine,$x.options),$i=$w.showInternalEdges||!$w.wireframes;for($n=0;$n<$I.length;$n++)if(($k=$I[$n]).render.visible)for($a=1<$k.parts.length?1:0;$a<$k.parts.length;$a++)if(($l=$k.parts[$a]).render.visible){if($w.showSleeping&&$k.isSleeping?$$.globalAlpha=.5*$l.render.opacity:1!==$l.render.opacity&&($$.globalAlpha=$l.render.opacity),$l.render.sprite&&$l.render.sprite.texture&&!$w.wireframes){var $F=$l.render.sprite,$b=$_($x,$F.texture);$$.translate($l.position.x,$l.position.y),$$.rotate($l.angle),$$.drawImage($b,$b.width*-$F.xOffset*$F.xScale,$b.height*-$F.yOffset*$F.yScale,$b.width*$F.xScale,$b.height*$F.yScale),$$.rotate(-$l.angle),$$.translate(-$l.position.x,-$l.position.y)}else{if($l.circleRadius)$$.beginPath(),$$.arc($l.position.x,$l.position.y,$l.circleRadius,0,2*Math.PI);else{$$.beginPath(),$$.moveTo($l.vertices[0].x,$l.vertices[0].y);for(var $T=1;$T<$l.vertices.length;$T++)!$l.vertices[$T-1].isInternal||$i?$$.lineTo($l.vertices[$T].x,$l.vertices[$T].y):$$.moveTo($l.vertices[$T].x,$l.vertices[$T].y),$l.vertices[$T].isInternal&&!$i&&$$.moveTo($l.vertices[($T+1)%$l.vertices.length].x,$l.vertices[($T+1)%$l.vertices.length].y);$$.lineTo($l.vertices[0].x,$l.vertices[0].y),$$.closePath()}$w.wireframes?($$.lineWidth=1,$$.strokeStyle="#bbb",$$.stroke()):($$.fillStyle=$l.render.fillStyle,$l.render.lineWidth&&($$.lineWidth=$l.render.lineWidth,$$.strokeStyle=$l.render.strokeStyle,$$.stroke()),$$.fill())}$$.globalAlpha=1}},$v.bodyWireframes=function($x,$I,$z){var $k,$l,$n,$a,$$,$w=$z,$i=$x.options.showInternalEdges;for($w.beginPath(),$n=0;$n<$I.length;$n++)if(($k=$I[$n]).render.visible)for($$=1<$k.parts.length?1:0;$$<$k.parts.length;$$++){for($l=$k.parts[$$],$w.moveTo($l.vertices[0].x,$l.vertices[0].y),$a=1;$a<$l.vertices.length;$a++)!$l.vertices[$a-1].isInternal||$i?$w.lineTo($l.vertices[$a].x,$l.vertices[$a].y):$w.moveTo($l.vertices[$a].x,$l.vertices[$a].y),$l.vertices[$a].isInternal&&!$i&&$w.moveTo($l.vertices[($a+1)%$l.vertices.length].x,$l.vertices[($a+1)%$l.vertices.length].y);$w.lineTo($l.vertices[0].x,$l.vertices[0].y)}$w.lineWidth=1,$w.strokeStyle="#bbb",$w.stroke()},$v.bodyConvexHulls=function($x,$I,$z){var $k,$l,$n,$a=$z;for($a.beginPath(),$l=0;$l<$I.length;$l++)if(($k=$I[$l]).render.visible&&1!==$k.parts.length){for($a.moveTo($k.vertices[0].x,$k.vertices[0].y),$n=1;$n<$k.vertices.length;$n++)$a.lineTo($k.vertices[$n].x,$k.vertices[$n].y);$a.lineTo($k.vertices[0].x,$k.vertices[0].y)}$a.lineWidth=1,$a.strokeStyle="rgba(255,255,255,0.2)",$a.stroke()},$v.vertexNumbers=function($x,$I,$z){var $k,$l,$n,$a=$z;for($k=0;$k<$I.length;$k++){var $$=$I[$k].parts;for($n=1<$$.length?1:0;$n<$$.length;$n++){var $w=$$[$n];for($l=0;$l<$w.vertices.length;$l++)$a.fillStyle="rgba(255,255,255,0.2)",$a.fillText($k+"_"+$l,$w.position.x+.8*($w.vertices[$l].x-$w.position.x),$w.position.y+.8*($w.vertices[$l].y-$w.position.y))}}},$v.mousePosition=function($x,$I,$z){var $k=$z;$k.fillStyle="rgba(255,255,255,0.8)",$k.fillText($I.position.x+"  "+$I.position.y,$I.position.x+5,$I.position.y-5)},$v.bodyBounds=function($x,$I,$z){var $k=$z,$l=($x.engine,$x.options);$k.beginPath();for(var $n=0;$n<$I.length;$n++){if($I[$n].render.visible)for(var $a=$I[$n].parts,$$=1<$a.length?1:0;$$<$a.length;$$++){var $w=$a[$$];$k.rect($w.bounds.min.x,$w.bounds.min.y,$w.bounds.max.x-$w.bounds.min.x,$w.bounds.max.y-$w.bounds.min.y)}}$l.wireframes?$k.strokeStyle="rgba(255,255,255,0.08)":$k.strokeStyle="rgba(0,0,0,0.1)",$k.lineWidth=1,$k.stroke()},$v.bodyAxes=function($x,$I,$z){var $k,$l,$n,$a,$$=$z,$w=($x.engine,$x.options);for($$.beginPath(),$l=0;$l<$I.length;$l++){var $i=$I[$l],$F=$i.parts;if($i.render.visible)if($w.showAxes)for($n=1<$F.length?1:0;$n<$F.length;$n++)for($k=$F[$n],$a=0;$a<$k.axes.length;$a++){var $b=$k.axes[$a];$$.moveTo($k.position.x,$k.position.y),$$.lineTo($k.position.x+20*$b.x,$k.position.y+20*$b.y)}else for($n=1<$F.length?1:0;$n<$F.length;$n++)for($k=$F[$n],$a=0;$a<$k.axes.length;$a++)$$.moveTo($k.position.x,$k.position.y),$$.lineTo(($k.vertices[0].x+$k.vertices[$k.vertices.length-1].x)/2,($k.vertices[0].y+$k.vertices[$k.vertices.length-1].y)/2)}$w.wireframes?($$.strokeStyle="indianred",$$.lineWidth=1):($$.strokeStyle="rgba(255, 255, 255, 0.4)",$$.globalCompositeOperation="overlay",$$.lineWidth=2),$$.stroke(),$$.globalCompositeOperation="source-over"},$v.bodyPositions=function($x,$I,$z){var $k,$l,$n,$a,$$=$z,$w=($x.engine,$x.options);for($$.beginPath(),$n=0;$n<$I.length;$n++)if(($k=$I[$n]).render.visible)for($a=0;$a<$k.parts.length;$a++)$l=$k.parts[$a],$$.arc($l.position.x,$l.position.y,3,0,2*Math.PI,!1),$$.closePath();for($w.wireframes?$$.fillStyle="indianred":$$.fillStyle="rgba(0,0,0,0.5)",$$.fill(),$$.beginPath(),$n=0;$n<$I.length;$n++)($k=$I[$n]).render.visible&&($$.arc($k.positionPrev.x,$k.positionPrev.y,2,0,2*Math.PI,!1),$$.closePath());$$.fillStyle="rgba(255,165,0,0.8)",$$.fill()},$v.bodyVelocity=function($x,$I,$z){var $k=$z;$k.beginPath();for(var $l=0;$l<$I.length;$l++){var $n=$I[$l];$n.render.visible&&($k.moveTo($n.position.x,$n.position.y),$k.lineTo($n.position.x+2*($n.position.x-$n.positionPrev.x),$n.position.y+2*($n.position.y-$n.positionPrev.y)))}$k.lineWidth=3,$k.strokeStyle="cornflowerblue",$k.stroke()},$v.bodyIds=function($x,$I,$z){var $k,$l,$n=$z;for($k=0;$k<$I.length;$k++)if($I[$k].render.visible){var $a=$I[$k].parts;for($l=1<$a.length?1:0;$l<$a.length;$l++){var $$=$a[$l];$n.font="12px Arial",$n.fillStyle="rgba(255,255,255,0.5)",$n.fillText($$.id,$$.position.x+10,$$.position.y-10)}}},$v.collisions=function($x,$I,$z){var $k,$l,$n,$a,$$=$z,$w=$x.options;for($$.beginPath(),$n=0;$n<$I.length;$n++)if(($k=$I[$n]).isActive)for($l=$k.collision,$a=0;$a<$k.activeContacts.length;$a++){var $i=$k.activeContacts[$a].vertex;$$.rect($i.x-1.5,$i.y-1.5,3.5,3.5)}for($w.wireframes?$$.fillStyle="rgba(255,255,255,0.7)":$$.fillStyle="orange",$$.fill(),$$.beginPath(),$n=0;$n<$I.length;$n++)if(($k=$I[$n]).isActive&&($l=$k.collision,0<$k.activeContacts.length)){var $F=$k.activeContacts[0].vertex.x,$b=$k.activeContacts[0].vertex.y;2===$k.activeContacts.length&&($F=($k.activeContacts[0].vertex.x+$k.activeContacts[1].vertex.x)/2,$b=($k.activeContacts[0].vertex.y+$k.activeContacts[1].vertex.y)/2),$l.bodyB===$l.supports[0].body||!0===$l.bodyA.isStatic?$$.moveTo($F-8*$l.normal.x,$b-8*$l.normal.y):$$.moveTo($F+8*$l.normal.x,$b+8*$l.normal.y),$$.lineTo($F,$b)}$w.wireframes?$$.strokeStyle="rgba(255,165,0,0.7)":$$.strokeStyle="orange",$$.lineWidth=1,$$.stroke()},$v.separations=function($x,$I,$z){var $k,$l,$n,$a,$$,$w=$z,$i=$x.options;for($w.beginPath(),$$=0;$$<$I.length;$$++)if(($k=$I[$$]).isActive){$n=($l=$k.collision).bodyA;var $F=1;($a=$l.bodyB).isStatic||$n.isStatic||($F=.5),$a.isStatic&&($F=0),$w.moveTo($a.position.x,$a.position.y),$w.lineTo($a.position.x-$l.penetration.x*$F,$a.position.y-$l.penetration.y*$F),$F=1,$a.isStatic||$n.isStatic||($F=.5),$n.isStatic&&($F=0),$w.moveTo($n.position.x,$n.position.y),$w.lineTo($n.position.x+$l.penetration.x*$F,$n.position.y+$l.penetration.y*$F)}$i.wireframes?$w.strokeStyle="rgba(255,165,0,0.5)":$w.strokeStyle="orange",$w.stroke()},$v.inspector=function($x,$I){$x.engine;var $z,$k=$x.selected,$l=$x.render,$n=$l.options;if($n.hasBounds){var $a=$l.bounds.max.x-$l.bounds.min.x,$$=$l.bounds.max.y-$l.bounds.min.y,$w=$a/$l.options.width,$i=$$/$l.options.height;$I.scale(1/$w,1/$i),$I.translate(-$l.bounds.min.x,-$l.bounds.min.y)}for(var $F=0;$F<$k.length;$F++){var $b=$k[$F].data;switch($I.translate(.5,.5),$I.lineWidth=1,$I.strokeStyle="rgba(255,165,0,0.9)",$I.setLineDash([1,2]),$b.type){case"body":$z=$b.bounds,$I.beginPath(),$I.rect(Math.floor($z.min.x-3),Math.floor($z.min.y-3),Math.floor($z.max.x-$z.min.x+6),Math.floor($z.max.y-$z.min.y+6)),$I.closePath(),$I.stroke();break;case"constraint":var $T=$b.pointA;$b.bodyA&&($T=$b.pointB),$I.beginPath(),$I.arc($T.x,$T.y,10,0,2*Math.PI),$I.closePath(),$I.stroke()}$I.setLineDash([]),$I.translate(-.5,-.5)}null!==$x.selectStart&&($I.translate(.5,.5),$I.lineWidth=1,$I.strokeStyle="rgba(255,165,0,0.6)",$I.fillStyle="rgba(255,165,0,0.1)",$z=$x.selectBounds,$I.beginPath(),$I.rect(Math.floor($z.min.x),Math.floor($z.min.y),Math.floor($z.max.x-$z.min.x),Math.floor($z.max.y-$z.min.y)),$I.closePath(),$I.stroke(),$I.fill(),$I.translate(-.5,-.5)),$n.hasBounds&&$I.setTransform(1,0,0,1,0,0)};var $z=function($x,$I){var $z=$x.engine,$k=$x.timing,$l=$k.historySize,$n=$z.timing.timestamp;$k.delta=$I-$k.lastTime||$v._goodDelta,$k.lastTime=$I,$k.timestampElapsed=$n-$k.lastTimestamp||0,$k.lastTimestamp=$n,$k.deltaHistory.unshift($k.delta),$k.deltaHistory.length=Math.min($k.deltaHistory.length,$l),$k.engineDeltaHistory.unshift($z.timing.lastDelta),$k.engineDeltaHistory.length=Math.min($k.engineDeltaHistory.length,$l),$k.timestampElapsedHistory.unshift($k.timestampElapsed),$k.timestampElapsedHistory.length=Math.min($k.timestampElapsedHistory.length,$l),$k.engineElapsedHistory.unshift($z.timing.lastElapsed),$k.engineElapsedHistory.length=Math.min($k.engineElapsedHistory.length,$l),$k.elapsedHistory.unshift($k.lastElapsed),$k.elapsedHistory.length=Math.min($k.elapsedHistory.length,$l)},$N=function($x){for(var $I=0,$z=0;$z<$x.length;$z+=1)$I+=$x[$z];return $I/$x.length||0},$k=function($x,$I){var $z=document.createElement("canvas");return $z.width=$x,$z.height=$I,$z.oncontextmenu=function(){return!1},$z.onselectstart=function(){return!1},$z},$l=function($x){var $I=$x.getContext("2d");return(window.devicePixelRatio||1)/($I.webkitBackingStorePixelRatio||$I.mozBackingStorePixelRatio||$I.msBackingStorePixelRatio||$I.oBackingStorePixelRatio||$I.backingStorePixelRatio||1)},$_=function($x,$I){var $z=$x.textures[$I];return $z||(($z=$x.textures[$I]=new Image).src=$I,$z)},$P=function($x,$I){var $z=$I;/(jpg|gif|png)$/.test($I)&&($z="url("+$I+")"),$x.canvas.style.background=$z,$x.canvas.style.backgroundSize="contain",$x.currentBackground=$I}}()},function($x,$I){var $z={};($x.exports=$z).create=function($x){return{vertex:$x,normalImpulse:0,tangentImpulse:0}}},function($x,$I,$z){var $R={};$x.exports=$R;var $s=$z(7),$N=$z(19),$D=$z(14),$f=$z(20),$m=$z(4),$y=$z(5),$C=$z(10),$P=$z(0),$$=$z(6);$R.create=function($x){$x=$x||{};var $I=$P.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},$x);return $I.world=$x.world||$y.create({label:"World"}),$I.pairs=$x.pairs||$f.create(),$I.detector=$x.detector||$D.create(),$I.grid={buckets:[]},$I.world.gravity=$I.gravity,$I.broadphase=$I.grid,$I.metrics={},$I},$R.update=function($x,$I,$z){var $k=$P.now();$I=$I||1e3/60,$z=$z||1;var $l,$n=$x.world,$a=$x.detector,$$=$x.pairs,$w=$x.timing,$i=$w.timestamp;$w.timestamp+=$I*$w.timeScale,$w.lastDelta=$I*$w.timeScale;var $F={timestamp:$w.timestamp};$m.trigger($x,"beforeUpdate",$F);var $b=$y.allBodies($n),$T=$y.allConstraints($n);for($n.isModified&&$D.setBodies($a,$b),$n.isModified&&$y.setModified($n,!1,!1,!0),$x.enableSleeping&&$s.update($b,$w.timeScale),$R._bodiesApplyGravity($b,$x.gravity),$R._bodiesUpdate($b,$I,$w.timeScale,$z,$n.bounds),$C.preSolveAll($b),$l=0;$l<$x.constraintIterations;$l++)$C.solveAll($T,$w.timeScale);$C.postSolveAll($b),$a.pairs=$x.pairs;var $_=$D.collisions($a);for($f.update($$,$_,$i),$x.enableSleeping&&$s.afterCollisions($$.list,$w.timeScale),0<$$.collisionStart.length&&$m.trigger($x,"collisionStart",{pairs:$$.collisionStart}),$N.preSolvePosition($$.list),$l=0;$l<$x.positionIterations;$l++)$N.solvePosition($$.list,$w.timeScale);for($N.postSolvePosition($b),$C.preSolveAll($b),$l=0;$l<$x.constraintIterations;$l++)$C.solveAll($T,$w.timeScale);for($C.postSolveAll($b),$N.preSolveVelocity($$.list),$l=0;$l<$x.velocityIterations;$l++)$N.solveVelocity($$.list,$w.timeScale);return 0<$$.collisionActive.length&&$m.trigger($x,"collisionActive",{pairs:$$.collisionActive}),0<$$.collisionEnd.length&&$m.trigger($x,"collisionEnd",{pairs:$$.collisionEnd}),$R._bodiesClearForces($b),$m.trigger($x,"afterUpdate",$F),$x.timing.lastElapsed=$P.now()-$k,$x},$R.merge=function($x,$I){if($P.extend($x,$I),$I.world){$x.world=$I.world,$R.clear($x);for(var $z=$y.allBodies($x.world),$k=0;$k<$z.length;$k++){var $l=$z[$k];$s.set($l,!1),$l.id=$P.nextId()}}},$R.clear=function($x){$f.clear($x.pairs),$D.clear($x.detector)},$R._bodiesClearForces=function($x){for(var $I=0;$I<$x.length;$I++){var $z=$x[$I];$z.force.x=0,$z.force.y=0,$z.torque=0}},$R._bodiesApplyGravity=function($x,$I){var $z=void 0!==$I.scale?$I.scale:.001;if((0!==$I.x||0!==$I.y)&&0!==$z)for(var $k=0;$k<$x.length;$k++){var $l=$x[$k];$l.isStatic||$l.isSleeping||($l.force.y+=$l.mass*$I.y*$z,$l.force.x+=$l.mass*$I.x*$z)}},$R._bodiesUpdate=function($x,$I,$z,$k,$l){for(var $n=0;$n<$x.length;$n++){var $a=$x[$n];$a.isStatic||$a.isSleeping||$$.update($a,$I,$z,$k)}}},function($x,$I,$z){var $g={};$x.exports=$g;var $_=$z(3),$R=$z(1);$g._restingThresh=4,$g._restingThreshTangent=6,$g._positionDampen=.9,$g._positionWarming=.8,$g._frictionNormalMultiplier=5,$g.preSolvePosition=function($x){var $I,$z,$k,$l=$x.length;for($I=0;$I<$l;$I++)($z=$x[$I]).isActive&&($k=$z.activeContacts.length,$z.collision.parentA.totalContacts+=$k,$z.collision.parentB.totalContacts+=$k)},$g.solvePosition=function($x,$I){var $z,$k,$l,$n,$a,$$,$w,$i,$F=$g._positionDampen,$b=$x.length;for($z=0;$z<$b;$z++)($k=$x[$z]).isActive&&!$k.isSensor&&($n=($l=$k.collision).parentA,$a=$l.parentB,$$=$l.normal,$k.separation=$$.x*($a.positionImpulse.x+$l.penetration.x-$n.positionImpulse.x)+$$.y*($a.positionImpulse.y+$l.penetration.y-$n.positionImpulse.y));for($z=0;$z<$b;$z++)($k=$x[$z]).isActive&&!$k.isSensor&&($n=($l=$k.collision).parentA,$a=$l.parentB,$$=$l.normal,$i=($k.separation-$k.slop)*$I,($n.isStatic||$a.isStatic)&&($i*=2),$n.isStatic||$n.isSleeping||($w=$F/$n.totalContacts,$n.positionImpulse.x+=$$.x*$i*$w,$n.positionImpulse.y+=$$.y*$i*$w),$a.isStatic||$a.isSleeping||($w=$F/$a.totalContacts,$a.positionImpulse.x-=$$.x*$i*$w,$a.positionImpulse.y-=$$.y*$i*$w))},$g.postSolvePosition=function($x){for(var $I=$g._positionWarming,$z=$x.length,$k=$_.translate,$l=$R.update,$n=0;$n<$z;$n++){var $a=$x[$n],$$=$a.positionImpulse,$w=$$.x,$i=$$.y,$F=$a.velocity;if(($a.totalContacts=0)!==$w||0!==$i){for(var $b=0;$b<$a.parts.length;$b++){var $T=$a.parts[$b];$k($T.vertices,$$),$l($T.bounds,$T.vertices,$F),$T.position.x+=$w,$T.position.y+=$i}$a.positionPrev.x+=$w,$a.positionPrev.y+=$i,$w*$F.x+$i*$F.y<0?($$.x=0,$$.y=0):($$.x*=$I,$$.y*=$I)}}},$g.preSolveVelocity=function($x){var $I,$z,$k=$x.length;for($I=0;$I<$k;$I++){var $l=$x[$I];if($l.isActive&&!$l.isSensor){var $n=$l.activeContacts,$a=$n.length,$$=$l.collision,$w=$$.parentA,$i=$$.parentB,$F=$$.normal,$b=$$.tangent;for($z=0;$z<$a;$z++){var $T=$n[$z],$_=$T.vertex,$R=$T.normalImpulse,$s=$T.tangentImpulse;if(0!==$R||0!==$s){var $N=$F.x*$R+$b.x*$s,$D=$F.y*$R+$b.y*$s;$w.isStatic||$w.isSleeping||($w.positionPrev.x+=$N*$w.inverseMass,$w.positionPrev.y+=$D*$w.inverseMass,$w.anglePrev+=$w.inverseInertia*(($_.x-$w.position.x)*$D-($_.y-$w.position.y)*$N)),$i.isStatic||$i.isSleeping||($i.positionPrev.x-=$N*$i.inverseMass,$i.positionPrev.y-=$D*$i.inverseMass,$i.anglePrev-=$i.inverseInertia*(($_.x-$i.position.x)*$D-($_.y-$i.position.y)*$N))}}}}},$g.solveVelocity=function($x,$I){var $z,$k,$l,$n,$a=$I*$I,$$=$g._restingThresh*$a,$w=$g._frictionNormalMultiplier,$i=$g._restingThreshTangent*$a,$F=Number.MAX_VALUE,$b=$x.length;for($l=0;$l<$b;$l++){var $T=$x[$l];if($T.isActive&&!$T.isSensor){var $_=$T.collision,$R=$_.parentA,$s=$_.parentB,$N=$R.velocity,$D=$s.velocity,$f=$_.normal.x,$m=$_.normal.y,$y=$_.tangent.x,$C=$_.tangent.y,$P=$T.activeContacts,$v=$P.length,$L=1/$v,$K=$R.inverseMass+$s.inverseMass,$E=$T.friction*$T.frictionStatic*$w*$a;for($N.x=$R.position.x-$R.positionPrev.x,$N.y=$R.position.y-$R.positionPrev.y,$D.x=$s.position.x-$s.positionPrev.x,$D.y=$s.position.y-$s.positionPrev.y,$R.angularVelocity=$R.angle-$R.anglePrev,$s.angularVelocity=$s.angle-$s.anglePrev,$n=0;$n<$v;$n++){var $O=$P[$n],$S=$O.vertex,$Z=$S.x-$R.position.x,$U=$S.y-$R.position.y,$X=$S.x-$s.position.x,$d=$S.y-$s.position.y,$j=$N.x-$U*$R.angularVelocity,$t=$N.y+$Z*$R.angularVelocity,$Y=$j-($D.x-$d*$s.angularVelocity),$c=$t-($D.y+$X*$s.angularVelocity),$V=$f*$Y+$m*$c,$W=$y*$Y+$C*$c,$q=$T.separation+$V,$o=Math.min($q,1),$J=($o=$q<0?0:$o)*$E;$J<$W||$J<-$W?($k=0<$W?$W:-$W,($z=$T.friction*(0<$W?1:-1)*$a)<-$k?$z=-$k:$k<$z&&($z=$k)):($z=$W,$k=$F);var $h=$Z*$m-$U*$f,$B=$X*$m-$d*$f,$e=$L/($K+$R.inverseInertia*$h*$h+$s.inverseInertia*$B*$B),$A=(1+$T.restitution)*$V*$e;if($z*=$e,$$<$V*$V&&$V<0)$O.normalImpulse=0;else{var $H=$O.normalImpulse;$O.normalImpulse+=$A,$O.normalImpulse=Math.min($O.normalImpulse,0),$A=$O.normalImpulse-$H}if($i<$W*$W)$O.tangentImpulse=0;else{var $p=$O.tangentImpulse;$O.tangentImpulse+=$z,$O.tangentImpulse<-$k&&($O.tangentImpulse=-$k),$O.tangentImpulse>$k&&($O.tangentImpulse=$k),$z=$O.tangentImpulse-$p}var $u=$f*$A+$y*$z,$r=$m*$A+$C*$z;$R.isStatic||$R.isSleeping||($R.positionPrev.x+=$u*$R.inverseMass,$R.positionPrev.y+=$r*$R.inverseMass,$R.anglePrev+=($Z*$r-$U*$u)*$R.inverseInertia),$s.isStatic||$s.isSleeping||($s.positionPrev.x-=$u*$s.inverseMass,$s.positionPrev.y-=$r*$s.inverseMass,$s.anglePrev-=($X*$r-$d*$u)*$s.inverseInertia)}}}}},function($x,$I,$z){var $k={};$x.exports=$k;var $s=$z(9),$l=$z(0);$k.create=function($x){return $l.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},$x)},$k.update=function($x,$I,$z){var $k,$l,$n,$a,$$=$x.list,$w=$$.length,$i=$x.table,$F=$I.length,$b=$x.collisionStart,$T=$x.collisionEnd,$_=$x.collisionActive;for($b.length=0,$T.length=0,$a=$_.length=0;$a<$w;$a++)$$[$a].confirmedActive=!1;for($a=0;$a<$F;$a++)($n=($k=$I[$a]).pair)?($n.isActive?$_.push($n):$b.push($n),$s.update($n,$k,$z),$n.confirmedActive=!0):($i[($n=$s.create($k,$z)).id]=$n,$b.push($n),$$.push($n));var $R=[];for($w=$$.length,$a=0;$a<$w;$a++)($n=$$[$a]).confirmedActive||($s.setActive($n,!1,$z),$T.push($n),$n.collision.bodyA.isSleeping||$n.collision.bodyB.isSleeping||$R.push($a));for($a=0;$a<$R.length;$a++)$n=$$[$l=$R[$a]-$a],$$.splice($l,1),delete $i[$n.id]},$k.clear=function($x){return $x.table={},$x.list.length=0,$x.collisionStart.length=0,$x.collisionActive.length=0,$x.collisionEnd.length=0,$x}},function($x,$I,$z){var $k=$x.exports=$z(22);$k.Axes=$z(11),$k.Bodies=$z(12),$k.Body=$z(6),$k.Bounds=$z(1),$k.Collision=$z(8),$k.Common=$z(0),$k.Composite=$z(5),$k.Composites=$z(23),$k.Constraint=$z(10),$k.Contact=$z(17),$k.Detector=$z(14),$k.Engine=$z(18),$k.Events=$z(4),$k.Grid=$z(24),$k.Mouse=$z(13),$k.MouseConstraint=$z(25),$k.Pair=$z(9),$k.Pairs=$z(20),$k.Plugin=$z(15),$k.Query=$z(26),$k.Render=$z(16),$k.Resolver=$z(19),$k.Runner=$z(27),$k.SAT=$z(28),$k.Sleeping=$z(7),$k.Svg=$z(29),$k.Vector=$z(2),$k.Vertices=$z(3),$k.World=$z(30),$k.Engine.run=$k.Runner.run,$k.Common.deprecated($k.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function($x,$I,$z){var $k={};$x.exports=$k;var $l=$z(15),$n=$z(0);$k.name="matter-js",$k.version="0.18.0",$k.uses=[],$k.used=[],$k.use=function(){$l.use($k,Array.prototype.slice.call(arguments))},$k.before=function($x,$I){return $x=$x.replace(/^Matter./,""),$n.chainPathBefore($k,$x,$I)},$k.after=function($x,$I){return $x=$x.replace(/^Matter./,""),$n.chainPathAfter($k,$x,$I)}},function($x,$I,$z){var $_={};$x.exports=$_;var $f=$z(5),$s=$z(10),$N=$z(0),$m=$z(6),$R=$z(12),$k=$N.deprecated;$_.stack=function($x,$I,$z,$k,$l,$n,$a){for(var $$,$w=$f.create({label:"Stack"}),$i=$x,$F=$I,$b=0,$T=0;$T<$k;$T++){for(var $_=0,$R=0;$R<$z;$R++){var $s=$a($i,$F,$R,$T,$$,$b);if($s){var $N=$s.bounds.max.y-$s.bounds.min.y,$D=$s.bounds.max.x-$s.bounds.min.x;$_<$N&&($_=$N),$m.translate($s,{x:.5*$D,y:.5*$N}),$i=$s.bounds.max.x+$l,$f.addBody($w,$s),$$=$s,$b+=1}else $i+=$l}$F+=$_+$n,$i=$x}return $w},$_.chain=function($x,$I,$z,$k,$l,$n){for(var $a=$x.bodies,$$=1;$$<$a.length;$$++){var $w=$a[$$-1],$i=$a[$$],$F=$w.bounds.max.y-$w.bounds.min.y,$b=$w.bounds.max.x-$w.bounds.min.x,$T=$i.bounds.max.y-$i.bounds.min.y,$_={bodyA:$w,pointA:{x:$b*$I,y:$F*$z},bodyB:$i,pointB:{x:($i.bounds.max.x-$i.bounds.min.x)*$k,y:$T*$l}},$R=$N.extend($_,$n);$f.addConstraint($x,$s.create($R))}return $x.label+=" Chain",$x},$_.mesh=function($x,$I,$z,$k,$l){var $n,$a,$$,$w,$i,$F=$x.bodies;for($n=0;$n<$z;$n++){for($a=1;$a<$I;$a++)$$=$F[$a-1+$n*$I],$w=$F[$a+$n*$I],$f.addConstraint($x,$s.create($N.extend({bodyA:$$,bodyB:$w},$l)));if(0<$n)for($a=0;$a<$I;$a++)$$=$F[$a+($n-1)*$I],$w=$F[$a+$n*$I],$f.addConstraint($x,$s.create($N.extend({bodyA:$$,bodyB:$w},$l))),$k&&0<$a&&($i=$F[$a-1+($n-1)*$I],$f.addConstraint($x,$s.create($N.extend({bodyA:$i,bodyB:$w},$l)))),$k&&$a<$I-1&&($i=$F[$a+1+($n-1)*$I],$f.addConstraint($x,$s.create($N.extend({bodyA:$i,bodyB:$w},$l))))}return $x.label+=" Mesh",$x},$_.pyramid=function($w,$x,$i,$F,$b,$I,$T){return $_.stack($w,$x,$i,$F,$b,$I,function($x,$I,$z,$k,$l,$n){var $a=Math.min($F,Math.ceil($i/2)),$$=$l?$l.bounds.max.x-$l.bounds.min.x:0;if(!($a<$k||$z<($k=$a-$k)||$i-1-$k<$z))return 1===$n&&$m.translate($l,{x:($z+($i%2==1?1:-1))*$$,y:0}),$T($w+($l?$z*$$:0)+$z*$b,$I,$z,$k,$l,$n)})},$_.newtonsCradle=function($x,$I,$z,$k,$l){for(var $n=$f.create({label:"Newtons Cradle"}),$a=0;$a<$z;$a++){var $$=$R.circle($x+$a*(1.9*$k),$I+$l,$k,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),$w=$s.create({pointA:{x:$x+$a*(1.9*$k),y:$I},bodyB:$$});$f.addBody($n,$$),$f.addConstraint($n,$w)}return $n},$k($_,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),$_.car=function($x,$I,$z,$k,$l){var $n=$m.nextGroup(!0),$a=.5*-$z+20,$$=.5*$z-20,$w=$f.create({label:"Car"}),$i=$R.rectangle($x,$I,$z,$k,{collisionFilter:{group:$n},chamfer:{radius:.5*$k},density:2e-4}),$F=$R.circle($x+$a,$I+0,$l,{collisionFilter:{group:$n},friction:.8}),$b=$R.circle($x+$$,$I+0,$l,{collisionFilter:{group:$n},friction:.8}),$T=$s.create({bodyB:$i,pointB:{x:$a,y:0},bodyA:$F,stiffness:1,length:0}),$_=$s.create({bodyB:$i,pointB:{x:$$,y:0},bodyA:$b,stiffness:1,length:0});return $f.addBody($w,$i),$f.addBody($w,$F),$f.addBody($w,$b),$f.addConstraint($w,$T),$f.addConstraint($w,$_),$w},$k($_,"car","Composites.car ➤ moved to car example"),$_.softBody=function($x,$I,$z,$k,$l,$n,$a,$$,$w,$i){$w=$N.extend({inertia:1/0},$w),$i=$N.extend({stiffness:.2,render:{type:"line",anchors:!1}},$i);var $F=$_.stack($x,$I,$z,$k,$l,$n,function($x,$I){return $R.circle($x,$I,$$,$w)});return $_.mesh($F,$z,$k,$a,$i),$F.label="Soft Body",$F},$k($_,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")},function($x,$I,$z){var $D={};$x.exports=$D;var $F=$z(9),$w=$z(0),$k=$w.deprecated;$D.create=function($x){return $w.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},$x)},$D.update=function($x,$I,$z,$k){var $l,$n,$a,$$,$w,$i=$z.world,$F=$x.buckets,$b=!1;for($l=0;$l<$I.length;$l++){var $T=$I[$l];if((!$T.isSleeping||$k)&&(!$i.bounds||!($T.bounds.max.x<$i.bounds.min.x||$T.bounds.min.x>$i.bounds.max.x||$T.bounds.max.y<$i.bounds.min.y||$T.bounds.min.y>$i.bounds.max.y))){var $_=$D._getRegion($x,$T);if(!$T.region||$_.id!==$T.region.id||$k){$T.region&&!$k||($T.region=$_);var $R=$D._regionUnion($_,$T.region);for($n=$R.startCol;$n<=$R.endCol;$n++)for($a=$R.startRow;$a<=$R.endRow;$a++){$$=$F[$w=$D._getBucketId($n,$a)];var $s=$n>=$_.startCol&&$n<=$_.endCol&&$a>=$_.startRow&&$a<=$_.endRow,$N=$n>=$T.region.startCol&&$n<=$T.region.endCol&&$a>=$T.region.startRow&&$a<=$T.region.endRow;!$s&&$N&&$N&&$$&&$D._bucketRemoveBody($x,$$,$T),($T.region===$_||$s&&!$N||$k)&&($$||($$=$D._createBucket($F,$w)),$D._bucketAddBody($x,$$,$T))}$T.region=$_,$b=!0}}}$b&&($x.pairsList=$D._createActivePairsList($x))},$k($D,"update","Grid.update ➤ replaced by Matter.Detector"),$D.clear=function($x){$x.buckets={},$x.pairs={},$x.pairsList=[]},$k($D,"clear","Grid.clear ➤ replaced by Matter.Detector"),$D._regionUnion=function($x,$I){var $z=Math.min($x.startCol,$I.startCol),$k=Math.max($x.endCol,$I.endCol),$l=Math.min($x.startRow,$I.startRow),$n=Math.max($x.endRow,$I.endRow);return $D._createRegion($z,$k,$l,$n)},$D._getRegion=function($x,$I){var $z=$I.bounds,$k=Math.floor($z.min.x/$x.bucketWidth),$l=Math.floor($z.max.x/$x.bucketWidth),$n=Math.floor($z.min.y/$x.bucketHeight),$a=Math.floor($z.max.y/$x.bucketHeight);return $D._createRegion($k,$l,$n,$a)},$D._createRegion=function($x,$I,$z,$k){return{id:$x+","+$I+","+$z+","+$k,startCol:$x,endCol:$I,startRow:$z,endRow:$k}},$D._getBucketId=function($x,$I){return"C"+$x+"R"+$I},$D._createBucket=function($x,$I){return $x[$I]=[]},$D._bucketAddBody=function($x,$I,$z){var $k,$l=$x.pairs,$n=$F.id,$a=$I.length;for($k=0;$k<$a;$k++){var $$=$I[$k];if(!($z.id===$$.id||$z.isStatic&&$$.isStatic)){var $w=$n($z,$$),$i=$l[$w];$i?$i[2]+=1:$l[$w]=[$z,$$,1]}}$I.push($z)},$D._bucketRemoveBody=function($x,$I,$z){var $k,$l=$x.pairs,$n=$F.id;$I.splice($w.indexOf($I,$z),1);var $a=$I.length;for($k=0;$k<$a;$k++){var $$=$l[$n($z,$I[$k])];$$&&($$[2]-=1)}},$D._createActivePairsList=function($x){var $I,$z,$k=$x.pairs,$l=$w.keys($k),$n=$l.length,$a=[];for($z=0;$z<$n;$z++)0<($I=$k[$l[$z]])[2]?$a.push($I):delete $k[$l[$z]];return $a}},function($x,$I,$z){var $n={};$x.exports=$n;var $w=$z(3),$i=$z(7),$a=$z(13),$F=$z(4),$b=$z(14),$$=$z(10),$T=$z(5),$_=$z(0),$R=$z(1);$n.create=function($I,$x){var $z=($I?$I.mouse:null)||($x?$x.mouse:null);$z||($I&&$I.render&&$I.render.canvas?$z=$a.create($I.render.canvas):$x&&$x.element?$z=$a.create($x.element):($z=$a.create(),$_.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var $k={type:"mouseConstraint",mouse:$z,element:null,body:null,constraint:$$.create({label:"Mouse Constraint",pointA:$z.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},$l=$_.extend($k,$x);return $F.on($I,"beforeUpdate",function(){var $x=$T.allBodies($I.world);$n.update($l,$x),$n._triggerEvents($l)}),$l},$n.update=function($x,$I){var $z=$x.mouse,$k=$x.constraint,$l=$x.body;if(0===$z.button){if($k.bodyB)$i.set($k.bodyB,!1),$k.pointA=$z.position;else for(var $n=0;$n<$I.length;$n++)if($l=$I[$n],$R.contains($l.bounds,$z.position)&&$b.canCollide($l.collisionFilter,$x.collisionFilter))for(var $a=1<$l.parts.length?1:0;$a<$l.parts.length;$a++){var $$=$l.parts[$a];if($w.contains($$.vertices,$z.position)){$k.pointA=$z.position,$k.bodyB=$x.body=$l,$k.pointB={x:$z.position.x-$l.position.x,y:$z.position.y-$l.position.y},$k.angleB=$l.angle,$i.set($l,!1),$F.trigger($x,"startdrag",{mouse:$z,body:$l});break}}}else $k.bodyB=$x.body=null,$k.pointB=null,$l&&$F.trigger($x,"enddrag",{mouse:$z,body:$l})},$n._triggerEvents=function($x){var $I=$x.mouse,$z=$I.sourceEvents;$z.mousemove&&$F.trigger($x,"mousemove",{mouse:$I}),$z.mousedown&&$F.trigger($x,"mousedown",{mouse:$I}),$z.mouseup&&$F.trigger($x,"mouseup",{mouse:$I}),$z.mouseout&&$F.trigger($x,"mouseout",{mouse:$I}),$a.clearSourceEvents($I)}},function($x,$I,$z){var $T={};$x.exports=$T;var $_=$z(2),$R=$z(8),$s=$z(1),$N=$z(12),$$=$z(3);$T.collides=function($x,$I){for(var $z=[],$k=$I.length,$l=$x.bounds,$n=$R.collides,$a=$s.overlaps,$$=0;$$<$k;$$++){var $w=$I[$$],$i=$w.parts.length,$F=1===$i?0:1;if($a($w.bounds,$l))for(var $b=$F;$b<$i;$b++){var $T=$w.parts[$b];if($a($T.bounds,$l)){var $_=$n($T,$x);if($_){$z.push($_);break}}}}return $z},$T.ray=function($x,$I,$z,$k){$k=$k||1e-100;for(var $l=$_.angle($I,$z),$n=$_.magnitude($_.sub($I,$z)),$a=.5*($z.x+$I.x),$$=.5*($z.y+$I.y),$w=$N.rectangle($a,$$,$n,$k,{angle:$l}),$i=$T.collides($w,$x),$F=0;$F<$i.length;$F+=1){var $b=$i[$F];$b.body=$b.bodyB=$b.bodyA}return $i},$T.region=function($x,$I,$z){for(var $k=[],$l=0;$l<$x.length;$l++){var $n=$x[$l],$a=$s.overlaps($n.bounds,$I);($a&&!$z||!$a&&$z)&&$k.push($n)}return $k},$T.point=function($x,$I){for(var $z=[],$k=0;$k<$x.length;$k++){var $l=$x[$k];if($s.contains($l.bounds,$I))for(var $n=1===$l.parts.length?0:1;$n<$l.parts.length;$n++){var $a=$l.parts[$n];if($s.contains($a.bounds,$I)&&$$.contains($a.vertices,$I)){$z.push($l);break}}}return $z}},function($x,$I,$z){var $k={};$x.exports=$k;var $$=$z(4),$w=$z(18),$l=$z(0);$k.create=function($x){var $I=$l.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},$x);return $I.delta=$I.delta||1e3/$I.fps,$I.deltaMin=$I.deltaMin||1e3/$I.fps,$I.deltaMax=$I.deltaMax||1e3/(.5*$I.fps),$I.fps=1e3/$I.delta,$I},$k.run=function($x,$I){return void 0!==$x.positionIterations&&($I=$x,$x=$k.create()),Laya.timer.clear(this,$k.render),Laya.timer.frameLoop(1,this,$k.render,[$x,$I]),$x},$k.render=function($x,$I){$x.enabled&&$k.tick($x,$I,$l.now())},$k.tick=function($x,$I,$z){var $k,$l=$I.timing,$n=1,$a={timestamp:$l.timestamp};$$.trigger($x,"beforeTick",$a),$x.isFixed?$k=$x.delta:($k=$z-$x.timePrev||$x.delta,$x.timePrev=$z,$x.deltaHistory.push($k),$x.deltaHistory=$x.deltaHistory.slice(-$x.deltaSampleSize),$n=($k=($k=($k=Math.min.apply(null,$x.deltaHistory))<$x.deltaMin?$x.deltaMin:$k)>$x.deltaMax?$x.deltaMax:$k)/$x.delta,$x.delta=$k),0!==$x.timeScalePrev&&($n*=$l.timeScale/$x.timeScalePrev),0===$l.timeScale&&($n=0),$x.timeScalePrev=$l.timeScale,$x.correction=$n,$x.frameCounter+=1,1e3<=$z-$x.counterTimestamp&&($x.fps=$x.frameCounter*(($z-$x.counterTimestamp)/1e3),$x.counterTimestamp=$z,$x.frameCounter=0),$$.trigger($x,"tick",$a),$$.trigger($x,"beforeUpdate",$a),$w.update($I,$k,$n),$$.trigger($x,"afterUpdate",$a),$$.trigger($x,"afterTick",$a)},$k.stop=function($x){Laya.timer.clear(this,$k.render)},$k.start=function($x,$I){$k.run($x,$I)}},function($x,$I,$z){var $k={};$x.exports=$k;var $l=$z(8),$n=$z(0).deprecated;$k.collides=function($x,$I){return $l.collides($x,$I)},$n($k,"collides","SAT.collides ➤ replaced by Collision.collides")},function($x,$I,$z){var $m={};$x.exports=$m;$z(1);var $y=$z(0);$m.pathToVertices=function($x,$I){"undefined"==typeof window||"SVGPathSeg"in window||$y.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var $z,$k,$l,$n,$a,$$,$w,$i,$F,$b,$T,$_=[],$R=0,$s=0,$N=0;function $D($x,$I,$z){var $k=$z%2==1&&1<$z;if(!$F||$x!=$F.x||$I!=$F.y){$T=$F&&$k?($b=$F.x,$F.y):$b=0;var $l={x:$b+$x,y:$T+$I};!$k&&$F||($F=$l),$_.push($l),$s=$b+$x,$N=$T+$I}}function $f($x){var $I=$x.pathSegTypeAsLetter.toUpperCase();if("Z"!==$I){switch($I){case"M":case"L":case"T":case"C":case"S":case"Q":$s=$x.x,$N=$x.y;break;case"H":$s=$x.x;break;case"V":$N=$x.y}$D($s,$N,$x.pathSegType)}}for($I=$I||15,$m._svgPathToAbsolute($x),$l=$x.getTotalLength(),$$=[],$z=0;$z<$x.pathSegList.numberOfItems;$z+=1)$$.push($x.pathSegList.getItem($z));for($w=$$.concat();$R<$l;){if(($a=$$[$x.getPathSegAtLength($R)])!=$i){for(;$w.length&&$w[0]!=$a;)$f($w.shift());$i=$a}switch($a.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":$n=$x.getPointAtLength($R),$D($n.x,$n.y,0)}$R+=$I}for($z=0,$k=$w.length;$z<$k;++$z)$f($w[$z]);return $_},$m._svgPathToAbsolute=function($x){for(var $I,$z,$k,$l,$n,$a,$$=$x.pathSegList,$w=0,$i=0,$F=$$.numberOfItems,$b=0;$b<$F;++$b){var $T=$$.getItem($b),$_=$T.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test($_))"x"in $T&&($w=$T.x),"y"in $T&&($i=$T.y);else switch("x1"in $T&&($k=$w+$T.x1),"x2"in $T&&($n=$w+$T.x2),"y1"in $T&&($l=$i+$T.y1),"y2"in $T&&($a=$i+$T.y2),"x"in $T&&($w+=$T.x),"y"in $T&&($i+=$T.y),$_){case"m":$$.replaceItem($x.createSVGPathSegMovetoAbs($w,$i),$b);break;case"l":$$.replaceItem($x.createSVGPathSegLinetoAbs($w,$i),$b);break;case"h":$$.replaceItem($x.createSVGPathSegLinetoHorizontalAbs($w),$b);break;case"v":$$.replaceItem($x.createSVGPathSegLinetoVerticalAbs($i),$b);break;case"c":$$.replaceItem($x.createSVGPathSegCurvetoCubicAbs($w,$i,$k,$l,$n,$a),$b);break;case"s":$$.replaceItem($x.createSVGPathSegCurvetoCubicSmoothAbs($w,$i,$n,$a),$b);break;case"q":$$.replaceItem($x.createSVGPathSegCurvetoQuadraticAbs($w,$i,$k,$l),$b);break;case"t":$$.replaceItem($x.createSVGPathSegCurvetoQuadraticSmoothAbs($w,$i),$b);break;case"a":$$.replaceItem($x.createSVGPathSegArcAbs($w,$i,$T.r1,$T.r2,$T.angle,$T.largeArcFlag,$T.sweepFlag),$b);break;case"z":case"Z":$w=$I,$i=$z}"M"!=$_&&"m"!=$_||($I=$w,$z=$i)}}},function($x,$I,$z){var $k={};$x.exports=$k;var $l=$z(5);$z(0);$k.create=$l.create,$k.add=$l.add,$k.remove=$l.remove,$k.clear=$l.clear,$k.addComposite=$l.addComposite,$k.addBody=$l.addBody,$k.addConstraint=$l.addConstraint}])}),function($x){if("object"==typeof exports&&"undefined"!=typeof module)window?window.decomp=$x():module.exports=$x();else if("function"==typeof define&&define.amd)define([],$x);else{var $I;"undefined"!=typeof window?$I=window:"undefined"!=typeof global?$I=global:"undefined"!=typeof self&&($I=self),$I.decomp=$x()}}(function(){return function $l($n,$a,$$){function $w($z,$x){if(!$a[$z]){if(!$n[$z]){var $I="function"==typeof require&&require;if(!$x&&$I)return $I($z,!0);if($i)return $i($z,!0);throw new Error("Cannot find module '"+$z+"'")}var $k=$a[$z]={exports:{}};$n[$z][0].call($k.exports,function($x){var $I=$n[$z][1][$x];return $w($I||$x)},$k,$k.exports,$l,$n,$a,$$)}return $a[$z].exports}for(var $i="function"==typeof require&&require,$x=0;$x<$$.length;$x++)$w($$[$x]);return $w}({1:[function($x,$I,$z){function $w($x,$I,$z){$z=$z||0;var $k,$l,$n,$a,$$,$w,$i,$F=[0,0];return $k=$x[1][1]-$x[0][1],$l=$x[0][0]-$x[1][0],$n=$k*$x[0][0]+$l*$x[0][1],$a=$I[1][1]-$I[0][1],$$=$I[0][0]-$I[1][0],$w=$a*$I[0][0]+$$*$I[0][1],$N($i=$k*$$-$a*$l,0,$z)||($F[0]=($$*$n-$l*$w)/$i,$F[1]=($k*$w-$a*$n)/$i),$F}function $l($x,$I,$z,$k){var $l=$I[0]-$x[0],$n=$I[1]-$x[1],$a=$k[0]-$z[0],$$=$k[1]-$z[1];if($a*$n-$$*$l==0)return!1;var $w=($l*($z[1]-$x[1])+$n*($x[0]-$z[0]))/($a*$n-$$*$l),$i=($a*($x[1]-$z[1])+$$*($z[0]-$x[0]))/($$*$l-$a*$n);return 0<=$w&&$w<=1&&0<=$i&&$i<=1}function $i($x,$I,$z){return($I[0]-$x[0])*($z[1]-$x[1])-($z[0]-$x[0])*($I[1]-$x[1])}function $L($x,$I,$z){return 0<$i($x,$I,$z)}function $K($x,$I,$z){return 0<=$i($x,$I,$z)}function $E($x,$I,$z){return $i($x,$I,$z)<0}function $O($x,$I,$z){return $i($x,$I,$z)<=0}$I.exports={decomp:function($x){var $I=function $x($I){var $z=[],$k=[],$l=[],$n=[];var $a=Number.MAX_VALUE;for(var $$=0;$$<$I.length;++$$)if($X($I,$$))for(var $w=0;$w<$I.length;++$w)if($R($I,$$,$w)){$k=$x($s($I,$$,$w,$n)),$l=$x($s($I,$w,$$,$n));for(var $i=0;$i<$l.length;$i++)$k.push($l[$i]);$k.length<$a&&($a=($z=$k).length,$z.push([$Z($I,$$),$Z($I,$w)]))}return $z}($x);return 0<$I.length?function $x($I,$z){if(0===$z.length)return[$I];{if($z instanceof Array&&$z.length&&$z[0]instanceof Array&&2===$z[0].length&&$z[0][0]instanceof Array){for(var $k=[$I],$l=0;$l<$z.length;$l++)for(var $n=$z[$l],$a=0;$a<$k.length;$a++){var $$=$k[$a],$w=$x($$,$n);if($w){$k.splice($a,1),$k.push($w[0],$w[1]);break}}return $k}var $n=$z,$l=$I.indexOf($n[0]),$a=$I.indexOf($n[1]);return-1!==$l&&-1!==$a&&[$s($I,$l,$a),$s($I,$a,$l)]}}($x,$I):[$x]},quickDecomp:function $x($I,$z,$k,$l,$n,$a,$$){$a=$a||100;$$=$$||0;$n=$n||25;$z=void 0!==$z?$z:[];$k=$k||[];$l=$l||[];var $w=[0,0],$i=[0,0],$F=[0,0];var $b=0,$T=0,$_=0,$R=0;var $s=0,$N=0,$D=0;var $f=[],$m=[];var $y=$I,$C=$I;if($C.length<3)return $z;$$++;if($a<$$)return console.warn("quickDecomp: max level ("+$a+") reached."),$z;for(var $P=0;$P<$I.length;++$P)if($X($y,$P)){$k.push($y[$P]),$b=$T=Number.MAX_VALUE;for(var $v=0;$v<$I.length;++$v)$L($Z($y,$P-1),$Z($y,$P),$Z($y,$v))&&$O($Z($y,$P-1),$Z($y,$P),$Z($y,$v-1))&&($F=$j($Z($y,$P-1),$Z($y,$P),$Z($y,$v),$Z($y,$v-1)),$E($Z($y,$P+1),$Z($y,$P),$F)&&($_=$S($y[$P],$F))<$T&&($T=$_,$i=$F,$N=$v)),$L($Z($y,$P+1),$Z($y,$P),$Z($y,$v+1))&&$O($Z($y,$P+1),$Z($y,$P),$Z($y,$v))&&($F=$j($Z($y,$P+1),$Z($y,$P),$Z($y,$v),$Z($y,$v+1)),$L($Z($y,$P-1),$Z($y,$P),$F)&&($_=$S($y[$P],$F))<$b&&($b=$_,$w=$F,$s=$v));if($N===($s+1)%$I.length)$F[0]=($i[0]+$w[0])/2,$F[1]=($i[1]+$w[1])/2,$l.push($F),$P<$s?($U($f,$y,$P,$s+1),$f.push($F),$m.push($F),0!==$N&&$U($m,$y,$N,$y.length),$U($m,$y,0,$P+1)):(0!==$P&&$U($f,$y,$P,$y.length),$U($f,$y,0,$s+1),$f.push($F),$m.push($F),$U($m,$y,$N,$P+1));else{if($s<$N&&($s+=$I.length),$R=Number.MAX_VALUE,$s<$N)return $z;for(var $v=$N;$v<=$s;++$v)$K($Z($y,$P-1),$Z($y,$P),$Z($y,$v))&&$O($Z($y,$P+1),$Z($y,$P),$Z($y,$v))&&($_=$S($Z($y,$P),$Z($y,$v)))<$R&&$d($y,$P,$v)&&($R=$_,$D=$v%$I.length);$P<$D?($U($f,$y,$P,$D+1),0!==$D&&$U($m,$y,$D,$C.length),$U($m,$y,0,$P+1)):(0!==$P&&$U($f,$y,$P,$C.length),$U($f,$y,0,$D+1),$U($m,$y,$D,$P+1))}return $f.length<$m.length?($x($f,$z,$k,$l,$n,$a,$$),$x($m,$z,$k,$l,$n,$a,$$)):($x($m,$z,$k,$l,$n,$a,$$),$x($f,$z,$k,$l,$n,$a,$$)),$z}$z.push($I);return $z},isSimple:function($x){var $I,$z=$x;for($I=0;$I<$z.length-1;$I++)for(var $k=0;$k<$I-1;$k++)if($l($z[$I],$z[$I+1],$z[$k],$z[$k+1]))return!1;for($I=1;$I<$z.length-2;$I++)if($l($z[0],$z[$z.length-1],$z[$I],$z[$I+1]))return!1;return!0},removeCollinearPoints:function($x,$I){for(var $z=0,$k=$x.length-1;3<$x.length&&0<=$k;--$k)$n($Z($x,$k-1),$Z($x,$k),$Z($x,$k+1),$I)&&($x.splice($k%$x.length,1),$z++);return $z},removeDuplicatePoints:function($x,$I){for(var $z=$x.length-1;1<=$z;--$z)for(var $k=$x[$z],$l=$z-1;0<=$l;--$l)$n=$k,$a=$x[$l],$$=$I,$N($n[0],$a[0],$$)&&$N($n[1],$a[1],$$)&&$x.splice($z,1);var $n,$a,$$},makeCCW:function($x){for(var $I=0,$z=$x,$k=1;$k<$x.length;++$k)($z[$k][1]<$z[$I][1]||$z[$k][1]===$z[$I][1]&&$z[$k][0]>$z[$I][0])&&($I=$k);return!$L($Z($x,$I-1),$Z($x,$I),$Z($x,$I+1))&&(function($x){for(var $I=[],$z=$x.length,$k=0;$k!==$z;$k++)$I.push($x.pop());for(var $k=0;$k!==$z;$k++)$x[$k]=$I[$k]}($x),!0)}};var $F=[],$b=[];function $n($x,$I,$z,$k){if($k){var $l=$F,$n=$b;$l[0]=$I[0]-$x[0],$l[1]=$I[1]-$x[1],$n[0]=$z[0]-$I[0],$n[1]=$z[1]-$I[1];var $a=$l[0]*$n[0]+$l[1]*$n[1],$$=Math.sqrt($l[0]*$l[0]+$l[1]*$l[1]),$w=Math.sqrt($n[0]*$n[0]+$n[1]*$n[1]);return Math.acos($a/($$*$w))<$k}return 0===$i($x,$I,$z)}function $S($x,$I){var $z=$I[0]-$x[0],$k=$I[1]-$x[1];return $z*$z+$k*$k}function $Z($x,$I){var $z=$x.length;return $x[$I<0?$I%$z+$z:$I%$z]}function $U($x,$I,$z,$k){for(var $l=$z;$l<$k;$l++)$x.push($I[$l])}function $X($x,$I){return $E($Z($x,$I-1),$Z($x,$I),$Z($x,$I+1))}var $T=[],$_=[];function $R($x,$I,$z){var $k,$l,$n=$T,$a=$_;if($K($Z($x,$I+1),$Z($x,$I),$Z($x,$z))&&$O($Z($x,$I-1),$Z($x,$I),$Z($x,$z)))return!1;$l=$S($Z($x,$I),$Z($x,$z));for(var $$=0;$$!==$x.length;++$$)if(($$+1)%$x.length!==$I&&$$!==$I&&$K($Z($x,$I),$Z($x,$z),$Z($x,$$+1))&&$O($Z($x,$I),$Z($x,$z),$Z($x,$$))&&($n[0]=$Z($x,$I),$n[1]=$Z($x,$z),$a[0]=$Z($x,$$),$a[1]=$Z($x,$$+1),$k=$w($n,$a),$S($Z($x,$I),$k)<$l))return!1;return!0}function $d($x,$I,$z){for(var $k=0;$k!==$x.length;++$k)if($k!==$I&&$k!==$z&&($k+1)%$x.length!==$I&&($k+1)%$x.length!==$z&&$l($Z($x,$I),$Z($x,$z),$Z($x,$k),$Z($x,$k+1)))return!1;return!0}function $s($x,$I,$z,$k){var $l=$k||[];if(function($x){$x.length=0}($l),$I<$z)for(var $n=$I;$n<=$z;$n++)$l.push($x[$n]);else{for($n=0;$n<=$z;$n++)$l.push($x[$n]);for($n=$I;$n<$x.length;$n++)$l.push($x[$n])}return $l}function $j($x,$I,$z,$k,$l){$l=$l||0;var $n=$I[1]-$x[1],$a=$x[0]-$I[0],$$=$n*$x[0]+$a*$x[1],$w=$k[1]-$z[1],$i=$z[0]-$k[0],$F=$w*$z[0]+$i*$z[1],$b=$n*$i-$w*$a;return $N($b,0,$l)?[0,0]:[($i*$$-$a*$F)/$b,($n*$F-$w*$$)/$b]}function $N($x,$I,$z){return $z=$z||0,Math.abs($x-$I)<=$z}},{}]},{},[1])(1)}),function(){var $f={},$k=Matter.Common,$m=Matter.Composite,$y=Matter.Bounds,$I=Matter.Events,$C=(Matter.Grid,Matter.Vector);$f.create=function($x){var $I={controller:$f,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#fafafa",wireframeBackground:"#222222",hasBounds:!!$x.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},$z=$k.extend($I,$x);return $z.mouse=$x.mouse,$z.engine=$x.engine,$z.container=$z.container||Laya.stage,$z.bounds=$z.bounds||{min:{x:0,y:0},max:{x:$z.width,y:$z.height}},$z},$f.run=function($x){Laya.timer.frameLoop(1,this,$f.world,[$x]),$I.on($x.engine.world,"afterRemove",$f.onRemoveSprite)},$f.stop=function($x){Laya.timer.clear(this,$f.world),$I.off($x.engine.world,"afterRemove",$f.onRemoveSprite)},$f.onRemoveSprite=function($x){var $I=$x.object.layaSprite;$I&&$I.parent&&$I.parent.removeChild($I)},$f.world=function($x){var $I,$z=$x.engine.world,$k=($x.renderer,$x.container),$l=$x.options,$n=$m.allBodies($z),$a=$m.allConstraints($z),$$=[];$l.wireframes?$f.setBackground($x,$l.wireframeBackground):$f.setBackground($x,$l.background);var $w=$x.bounds.max.x-$x.bounds.min.x,$i=$x.bounds.max.y-$x.bounds.min.y,$F=$w/$x.options.width,$b=$i/$x.options.height;if($l.hasBounds){for($I=0;$I<$n.length;$I++){var $T=$n[$I];$T.render.sprite.visible=$y.overlaps($T.bounds,$x.bounds)}for($I=0;$I<$a.length;$I++){var $_=$a[$I],$R=$_.bodyA,$s=$_.bodyB,$N=$_.pointA,$D=$_.pointB;$R&&($N=$C.add($R.position,$_.pointA)),$s&&($D=$C.add($s.position,$_.pointB)),$N&&$D&&(($y.contains($x.bounds,$N)||$y.contains($x.bounds,$D))&&$$.push($_))}$k.scale(1/$F,1/$b),$k.pos(-$x.bounds.min.x*(1/$F),-$x.bounds.min.y*(1/$b))}else $$=$a;for($I=0;$I<$n.length;$I++)$f.body($x,$n[$I]);for($I=0;$I<$$.length;$I++)$f.constraint($x,$$[$I])},$f.setBackground=function($x,$I){if($x.currentBackground!==$I){var $z=$I.indexOf&&-1!==$I.indexOf("#");$x.container.graphics.clear(),$z?$x.container.bgColor=$I:($x.container.loadImage($I),$x.container.bgColor="#FFFFFF"),$x.currentBackground=$I}},$f.body=function($x,$I){$x.engine;var $z=$I.render;if($z.visible){if($z.sprite&&$z.sprite.texture){$I.id;var $k=$I.layaSprite,$l=$x.container;$k||($k=$I.layaSprite=$w($x,$I),$I.effPendant&&!$I.effPendant.parent&&$k.addChild($I.effPendant)),$l.contains($k)||$l.addChild($k),$k.x=$I.position.x,$k.y=$I.position.y,$k.rotation=180*$I.angle/Math.PI,$k.scaleX=$z.sprite.xScale||1,$k.scaleY=$z.sprite.yScale||1,$k.width=$z.sprite.width,$k.height=$z.sprite.height,$z.sprite.sizeGrid&&($k.sizeGrid=$z.sprite.sizeGrid)}else{$I.id,$k=$I.layaSprite,$l=$x.container;$k||(($k=$I.layaSprite=$i($x,$I)).initialAngle=$I.angle,$I.effPendant&&!$I.effPendant.parent&&$k.addChild($I.effPendant)),$l.contains($k)||$l.addChild($k),$k.x=$I.position.x,$k.y=$I.position.y,$k.rotation=180*($I.angle-$k.initialAngle)/Math.PI}var $n=$I.text;if($n){var $a=$k.lbl;$a||(($a=$k.lbl=new Laya.Label).fontSize=30,$a.anchorX=.5,$a.anchorY=.5,$a.color=$I.textClr?$I.textClr:"#ffffff",$a.strokeColor="#000000",$a.stroke=2,$a.centerX=0,$a.centerY=0,$k.addChild($a),void 0!==$I.shapeType&&(0===$I.shapeType&&($a.centerX=-10),2===$I.shapeType&&($a.rotation=-$k.rotation)),$a.text=$n+"",$I.lbl=$a)}if($I.pendant&&!$k.pendantSpr){var $$=new Laya.Image;$$.skin=$I.pendant,$k.addChild($$),$k.pendantSpr=$$}}};var $w=function($x,$I){var $z=$I.render.sprite.texture,$k=new Laya.Image;return $k.skin=$z,$k.pivotX=$I.render.sprite.xOffset,$k.pivotY=$I.render.sprite.yOffset,$k},$i=function($x,$I){var $z,$k,$l,$n,$a=$I.render,$$=$x.options,$w=new Laya.Sprite,$i=$w.graphics;$i.clear();for(var $F=1<$I.parts.length?1:0;$F<$I.parts.length;$F++){$n=$I.parts[$F];var $b=[];$l=$$.wireframes?($z=null,$k="#bbbbbb",1):($z=$a.fillStyle,$k=$a.strokeStyle,$a.lineWidth),$b.push($n.vertices[0].x-$I.position.x,$n.vertices[0].y-$I.position.y);for(var $T=1;$T<$n.vertices.length;$T++)$b.push($n.vertices[$T].x-$I.position.x,$n.vertices[$T].y-$I.position.y);$b.push($n.vertices[0].x-$I.position.x,$n.vertices[0].y-$I.position.y),$i.drawPoly(0,0,$b,$z,$k,$l),($$.showAngleIndicator||$$.showAxes)&&($l=1,$k=$$.wireframes?"#CD5C5C":$a.strokeStyle,$i.drawLine($n.position.x-$I.position.x,$n.position.y-$I.position.y,($n.vertices[0].x+$n.vertices[$n.vertices.length-1].x)/2-$I.position.x,($n.vertices[0].y+$n.vertices[$n.vertices.length-1].y)/2-$I.position.y))}return $w};$f.constraint=function($x,$I){$x.engine;var $z=$I.bodyA,$k=$I.bodyB,$l=$I.pointA,$n=$I.pointB,$a=$x.container,$$=$I.render,$w=($I.id,$I.layaSprite);$w||($w=$I.layaSprite=new Laya.Sprite);var $i,$F,$b,$T,$_=$w.graphics;$$.visible&&$I.pointA&&$I.pointB?($a.contains($w)||$a.addChild($w),$_.clear(),$F=$z?($i=$z.position.x+$l.x,$z.position.y+$l.y):($i=$l.x,$l.y),$T=$k?($b=$k.position.x+$n.x,$k.position.y+$n.y):($b=$n.x,$n.y),$_.drawLine($i,$F,$b,$T,$$.strokeStyle,$$.lineWidth)):$_.clear()},window.LayaRender=$f}();