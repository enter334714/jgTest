var Laya=window.Laya=function(Fj,Fa){var Fm={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(Fa,Fb){return 1==arguments.length?Fm.__presubstr.call(this,Fa):Fm.__presubstr.call(this,Fa,0<Fb?Fb:this.length+Fb)},__init:function(Fa){Fa.forEach(function(Fa){Fa.__init$&&Fa.__init$()})},__isClass:function(Fa){return Fa&&(Fa.__isclass||Fa==Object||Fa==String||Fa==Array)},__newvec:function(Fa,Fb){var Fc=[];Fc.length=Fa;for(var Fd=0;Fd<Fa;Fd++)Fc[Fd]=Fb;return Fc},__extend:function(Fa,Fb){for(var Fc in Fb)if(Fb.hasOwnProperty(Fc)){var Fd=Object.getOwnPropertyDescriptor(Fb,Fc),Fe=Fd.get,Ff=Fd.set;Fe||Ff?Fe&&Ff?Object.defineProperty(Fa,Fc,Fd):(Fe&&Object.defineProperty(Fa,Fc,Fe),Ff&&Object.defineProperty(Fa,Fc,Ff)):Fa[Fc]=Fb[Fc]}function Fg(){Fm.un(this,"constructor",Fa)}Fg.prototype=Fb.prototype,Fa.prototype=new Fg,Fm.un(Fa.prototype,"__imps",Fm.__copy({},Fb.prototype.__imps))},__copy:function(Fa,Fb){if(!Fb)return null;for(var Fc in Fa=Fa||{},Fb)Fa[Fc]=Fb[Fc];return Fa},__package:function(Fa,Fb){if(!Fm.__packages[Fa]){Fm.__packages[Fa]=!0;var Fc=Fj,Fd=Fa.split(".");if(1<Fd.length)for(var Fe=0,Ff=Fd.length-1;Fe<Ff;Fe++){var Fg=Fc[Fd[Fe]];Fc=Fg||(Fc[Fd[Fe]]={})}Fc[Fd[Fd.length-1]]||(Fc[Fd[Fd.length-1]]=Fb||{})}},__hasOwnProperty:function(Fa,Fb){return Fb=Fb||this,Object.hasOwnProperty.call(Fb,Fa)||function Fa(Fb,Fc){if(Object.hasOwnProperty.call(Fc.prototype,Fb))return!0;var Fd=Fc.prototype.__super;return null==Fd?null:Fa(Fb,Fd)}(Fa,Fb.__class)},__typeof:function(Fa,Fb){if(!Fa||!Fb)return!1;if(Fb===String)return"string"==typeof Fa;if(Fb===Number)return"number"==typeof Fa;if(Fb.__interface__)Fb=Fb.__interface__;else if("string"!=typeof Fb)return Fa instanceof Fb;return Fa.__imps&&Fa.__imps[Fb]||Fa.__class==Fb},__as:function(Fa,Fb){return this.__typeof(Fa,Fb)?Fa:null},__int:function(Fa){return Fa?parseInt(Fa):0},interface:function(Fa,Fb){Fm.__package(Fa,{});var Fc=Fm.__internals,Fd=Fc[Fa]=Fc[Fa]||{self:Fa};if(Fb){var Fe=Fb.split(",");Fd.extend=[];for(var Ff=0;Ff<Fe.length;Ff++){var Fg=Fe[Ff];Fc[Fg]=Fc[Fg]||{self:Fg},Fd.extend.push(Fc[Fg])}}var Fh=Fj,Fi=Fa.split(".");for(Ff=0;Ff<Fi.length-1;Ff++)Fh=Fh[Fi[Ff]];Fh[Fi[Fi.length-1]]={__interface__:Fa}},class:function(Fa,Fb,Fc,Fd){if(Fc&&Fm.__extend(Fa,Fc),Fb)if(Fm.__package(Fb,Fa),Fm.__classmap[Fb]=Fa,0<Fb.indexOf(".")){if(0==Fb.indexOf("laya.")){var Fe=Fb.split(".");Fd=Fd||Fe[Fe.length-1],Fm[Fd]&&console.log("Warning!,this class["+Fd+"] already exist:",Fm[Fd]),Fm[Fd]=Fa}}else"Main"==Fb?Fj.Main=Fa:"MainWX"==Fb?Fj.MainWX=Fa:(Fm[Fb]&&console.log("Error!,this class["+Fb+"] already exist:",Fm[Fb]),Fm[Fb]=Fa);var Ff=Fm.un,Fg=Fa.prototype;Ff(Fg,"hasOwnProperty",Fm.__hasOwnProperty),Ff(Fg,"__class",Fa),Ff(Fg,"__super",Fc),Ff(Fg,"__className",Fb),Ff(Fa,"__super",Fc),Ff(Fa,"__className",Fb),Ff(Fa,"__isclass",!0),Ff(Fa,"super",function(Fa){this.__super.call(Fa)})},imps:function(Fa,Fb){if(!Fb)return null;var Fe=Fa.__imps||Fm.un(Fa,"__imps",{});function Ff(Fa){var Fb,Fc;if((Fb=Fm.__internals[Fa])&&(Fe[Fa]=!0,Fc=Fb.extend))for(var Fd=0;Fd<Fc.length;Fd++)Ff(Fc[Fd].self)}for(var Fc in Fb)Ff(Fc)},superSet:function(Fa,Fb,Fc,Fd){var Fe=Fa.prototype["_$set_"+Fc];Fe&&Fe.call(Fb,Fd)},superGet:function(Fa,Fb,Fc){var Fd=Fa.prototype["_$get_"+Fc];return Fd?Fd.call(Fb):null},getset:function(Fa,Fb,Fc,Fd,Fe){Fa?(Fd&&(Fb["_$GET_"+Fc]=Fd),Fe&&(Fb["_$SET_"+Fc]=Fe)):(Fd&&Fm.un(Fb,"_$get_"+Fc,Fd),Fe&&Fm.un(Fb,"_$set_"+Fc,Fe)),Fd&&Fe?Object.defineProperty(Fb,Fc,{get:Fd,set:Fe,enumerable:!1,configurable:!0}):(Fd&&Object.defineProperty(Fb,Fc,{get:Fd,enumerable:!1,configurable:!0}),Fe&&Object.defineProperty(Fb,Fc,{set:Fe,enumerable:!1,configurable:!0}))},static:function(Fc,Fd){for(var Fe=0,Fa=Fd.length;Fe<Fa;Fe+=2)if("length"==Fd[Fe])Fc.length=Fd[Fe+1].call(Fc);else{function Fb(){var Fb=Fd[Fe],Fa=Fd[Fe+1];Object.defineProperty(Fc,Fb,{get:function(){return delete this[Fb],this[Fb]=Fa.call(this)},set:function(Fa){delete this[Fb],this[Fb]=Fa},enumerable:!0,configurable:!0})}Fb()}},un:function(Fa,Fb,Fc){return Fc||(Fc=Fa[Fb]),Fm.__propun.value=Fc,Object.defineProperty(Fa,Fb,Fm.__propun),Fc},uns:function(Fb,Fa){Fa.forEach(function(Fa){Fm.un(Fb,Fa)})}};return Fj.console=Fj.console||{log:function(){}},Fj.trace=Fj.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),Fm}(window,document);!function(Fa,Fb,Fc){Fc.un,Fc.uns,Fc.static,Fc.class,Fc.getset,Fc.__newvec}(window,document,Laya),function(Fg,Fb,Fz){Fz.un,Fz.uns;var Fi=Fz.static,Fr=Fz.class,Fm=Fz.getset;Fz.__newvec;Fz.interface("laya.runtime.IMarket"),Fz.interface("laya.filters.IFilter"),Fz.interface("laya.display.ILayout"),Fz.interface("laya.resource.IDispose"),Fz.interface("laya.runtime.IPlatform"),Fz.interface("laya.resource.IDestroy"),Fz.interface("laya.runtime.IConchNode"),Fz.interface("laya.filters.IFilterAction"),Fz.interface("laya.runtime.ICPlatformClass"),Fz.interface("laya.resource.ICreateResource"),Fz.interface("laya.runtime.IConchRenderObject"),Fz.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var FF=function(){function Ff(){}return Fr(Ff,"laya.utils.RunDriver"),Ff.FILTER_ACTIONS=[],Ff.pixelRatio=-1,Ff._charSizeTestDiv=null,Ff.now=function(){return Date.now()},Ff.getWindow=function(){return Fg},Ff.getPixelRatio=function(){if(Ff.pixelRatio<0){var Fa=FO.context,Fb=Fa.backingStorePixelRatio||Fa.webkitBackingStorePixelRatio||Fa.mozBackingStorePixelRatio||Fa.msBackingStorePixelRatio||Fa.oBackingStorePixelRatio||Fa.backingStorePixelRatio||1;(Ff.pixelRatio=(FO.window.devicePixelRatio||1)/Fb)<1&&(Ff.pixelRatio=1)}return Ff.pixelRatio},Ff.getIncludeStr=function(Fa){return null},Ff.createShaderCondition=function(Fa){var Fb="(function() {return "+Fa+";})";return Fz._runScript(Fb)},Ff.fontMap=[],Ff.measureText=function(Fa,Fb){var Fc=Ff.hanzi.test(Fa);if(Fc&&Ff.fontMap[Fb])return Ff.fontMap[Fb];var Fd=FO.context;Fd.font=Fb;var Fe=Fd.measureText(Fa);return Fe||(Fe={width:16,height:16}),Fc&&(Ff.fontMap[Fb]=Fe),Fe},Ff.getWebGLContext=function(Fa){},Ff.beginFlush=function(){},Ff.endFinish=function(){},Ff.addToAtlas=null,Ff.flashFlushImage=function(Fa){},Ff.drawToCanvas=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=Fva.create("2D"),Fh=new FK(Fc,Fd,Fg);return FL.renders[Fb]._fun(Fa,Fh,Fe,Ff),Fg},Ff.createParticleTemplate2D=null,Ff.createGLTextur=null,Ff.createWebGLContext2D=null,Ff.changeWebGLSize=function(Fa,Fb){},Ff.createRenderSprite=function(Fa,Fb){return new FL(Fa,Fb)},Ff.createFilterAction=function(Fa){return new Fv},Ff.createGraphics=function(){return new Fo},Ff.clear=function(Fa){FJ._context.ctx.clear()},Ff.cancelLoadByUrl=function(Fa){},Ff.clearAtlas=function(Fa){},Ff.isAtlas=function(Fa){return!1},Ff.addTextureToAtlas=function(Fa){},Ff.getTexturePixels=function(Fa,Fb,Fc,Fd,Fe){return null},Ff.skinAniSprite=function(){return null},Ff.update3DLoop=function(){},Fi(Ff,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),Ff}(),Fd=(Fm(1,Fz,"alertGlobalError",null,function(Fa){var Ff=0;FO.window.onerror=Fa?function(Fa,Fb,Fc,Fd,Fe){Ff++<5&&Fe&&alert(Fe.stack||Fe)}:null}),Fz.init=function(Fa,Fb,Fc){for(var Fd=[],Fe=2,Ff=arguments.length;Fe<Ff;Fe++)Fd.push(arguments[Fe]);if(!Fz._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=Fz._arrayBufferSlice),Fz._isinit=!0,FO.__init__(),FM.__init__(),Fo.__init__(),Fz.timer=new FY,Fz.scaleTimer=new FY,Fz.loader=new Fia,Fk.__init__(),Fe=0;for(var Fg=Fd.length;Fe<Fg;Fe++)Fd[Fe].enable&&Fd[Fe].enable();return Fp.__init__(),Fh.__init__(),FN.__init__(),FQ.beginCheck(),Fz._currentStage=Fz.stage=new Fta,Fz.stage.conchModel&&Fz.stage.conchModel.setRootNode(),Fz._getUrlPath(),Fz.render=new FJ(0,0),Fz.stage.size(Fa,Fb),FL.__init__(),Fn.__init__(),Fq.instance.__init__(Fz.stage,FJ.canvas),Fxa.__init__(),FE.autoStopMusic=!0,FC.__init__(),FJ.canvas}},Fz._getUrlPath=function(){var Fa=FO.window.location,Fb=Fa.pathname;Fb=Fb&&":"==Fb.charAt(2)?Fb.substring(1):Fb,FI.rootPath=FI.basePath=FI.getPath("file:"==Fa.protocol?Fb:Fa.protocol+"//"+Fa.host+Fa.pathname)},Fz._arrayBufferSlice=function(Fa,Fb){var Fc=new Uint8Array(this,Fa,Fb-Fa),Fd=new Uint8Array(Fc.length);return Fd.set(Fc),Fd.buffer},Fz._runScript=function(Fa){return FO.window[Fz._evcode](Fa)},Fz.stage=null,Fz.timer=null,Fz.scaleTimer=null,Fz.loader=null,Fz.version="1.8.6",Fz.render=null,Fz._currentStage=null,Fz._isinit=!1,Fz.isDebug=!1,Fz.MiniAdpter={init:function(){Fg.navigator&&Fg.navigator.userAgent&&-1<Fg.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},Fi(Fz,["conchMarket",function(){return this.conchMarket=Fg.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=Fg.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function Fa(){}return Fr(Fa,"Config"),Fa.WebGLTextCacheCount=500,Fa.atlasEnable=!1,Fa.showCanvasMark=!1,Fa.animationInterval=50,Fa.isAntialias=!1,Fa.isAlpha=!1,Fa.premultipliedAlpha=!0,Fa.isStencil=!0,Fa.preserveDrawingBuffer=!1,Fa}()),Fj=function(){function Fj(){this._events=null}Fr(Fj,"laya.events.EventDispatcher");var Fa=Fj.prototype;return Fa.hasListener=function(Fa){return!!(this._events&&this._events[Fa])},Fa.event=function(Fa,Fb){if(!this._events||!this._events[Fa])return!1;var Fc=this._events[Fa];if(Fc.lock)Fc.queue||(Fc.queue=[]),Fc.queue.push(Fb);else{var Fd;for(Fc.lock=!0,Fc.cursor=Fc.head;Fc.cursor;)Fd=Fc.cursor,Fc.cursor=Fd.next,Fd.once&&Fj.delNode(Fc,Fd),null!=Fb?Fd.args?Fd.method.apply(Fd.caller,Fd.args.concat(Fb)):Fb instanceof Array?Fd.method.apply(Fd.caller,Fb):Fd.method.call(Fd.caller,Fb):Fd.method.apply(Fd.caller,Fd.args),Fd.once&&Fj.recoverHandler(Fd);Fc.lock=!1,!Fc.head&&this._events&&this._events[Fa]==Fc&&delete this._events[Fa],Fc.queue&&Fc.queue.length&&this.event(Fa,Fc.queue.shift())}return!0},Fa.on=function(Fa,Fb,Fc,Fd){return this._createListener(Fa,Fb,Fc,Fd,!1)},Fa.once=function(Fa,Fb,Fc,Fd){return this._createListener(Fa,Fb,Fc,Fd,!0)},Fa._createListener=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Ff&&(Ff=!0),Ff&&this.off(Fa,Fb,Fc,Fe);var Fg=Fj.createHandler(Fb||this,Fc,Fd,Fe);this._events||(this._events={});var Fh=this._events,Fi=Fh[Fa];return Fi?Fi.tail?(Fg.prev=Fi.tail,Fi.tail.next=Fg,Fi.tail=Fg):Fi.head=Fi.tail=Fg:Fh[Fa]={head:Fg,tail:Fg,cursor:null,lock:!1},this},Fa.off=function(Fa,Fb,Fc,Fd){if(void 0===Fd&&(Fd=!1),!this._events||!this._events[Fa])return this;for(var Fe=this._events[Fa],Ff=Fe.head;Ff;){if((!Fb||Ff.caller===Fb)&&Ff.method===Fc&&(!Fd||Ff.once)){Fj.delNode(Fe,Ff),Fe.cursor==Ff&&(Fe.cursor=Ff.next),Fj.recoverHandler(Ff);break}Ff=Ff.next}return Fe.head||delete this._events[Fa],this},Fa.offAll=function(Fa){var Fb=this._events;if(!Fb)return this;if(Fa)this._recoverHandlers(Fb[Fa]),delete Fb[Fa];else{for(var Fc in Fb)this._recoverHandlers(Fb[Fc]);this._events=null}return this},Fa._recoverHandlers=function(Fa){if(Fa){for(var Fb=Fa.head;Fb;){Fj.delNode(Fa,Fb);var Fc=Fb.next;Fj.recoverHandler(Fb),Fb=Fc}Fa.cursor=null}},Fa.isMouseEvent=function(Fa){return Fj.MOUSE_EVENTS[Fa]},Fj.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},Fj.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},Fj.delNode=function(Fa,Fb){Fb.prev?Fb.prev.next=Fb.next:Fa.head=Fb.next,Fb.next?Fb.next.prev=Fb.prev:Fa.tail=Fb.prev},Fj.createHandler=function(Fa,Fb,Fc,Fd){var Fe=Fj._freeHandler;return Fe?(Fj._freeCount--,Fj._freeHandler=Fe.next,Fe.caller=Fa,Fe.method=Fb,Fe.args=Fc,Fe.once=Fd):Fe={caller:Fa,method:Fb,args:Fc,once:Fd},Fe.prev=Fe.next=null,Fe},Fj.recoverHandler=function(Fa){Fa.caller=Fa.method=Fa.args=Fa.prev=null,Fa.next=Fj._freeHandler,Fj._freeHandler=Fa,Fj._freeCount++},Fj._freeHandler=null,Fj._freeCount=0,Fj}(),Fu=function(){function Fe(Fa,Fb,Fc,Fd){this.once=!1,void(this._id=0)===Fd&&(Fd=!1),this.setTo(Fa,Fb,Fc,Fd)}Fr(Fe,"laya.utils.Handler");var Fa=Fe.prototype;return Fa.setTo=function(Fa,Fb,Fc,Fd){return this._id=Fe._gid++,this.caller=Fa,this.method=Fb,this.args=Fc,this.once=Fd,this},Fa.run=function(){if(null==this.method)return null;var Fa=this._id,Fb=this.method.apply(this.caller,this.args);return this._id===Fa&&this.once&&this.recover(),Fb},Fa.runWith=function(Fa){if(null==this.method)return null;var Fb=this._id;if(null==Fa)var Fc=this.method.apply(this.caller,this.args);else Fc=this.args||Fa.unshift?this.args?this.method.apply(this.caller,this.args.concat(Fa)):this.method.apply(this.caller,Fa):this.method.call(this.caller,Fa);return this._id===Fb&&this.once&&this.recover(),Fc},Fa.clear=function(){return this.caller=null,this.method=null,this.args=null,this},Fa.recover=function(){0<this._id&&(this._id=0,this.clear())},Fe.create=function(Fa,Fb,Fc,Fd){return void 0===Fd&&(Fd=!0),new Fe(Fa,Fb,Fc,Fd)},Fe._gid=1,Fe}(),FD=function(){function Fa(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}Fr(Fa,"laya.display.BitmapFont");var Fb=Fa.prototype;return Fb.loadFont=function(Fa,Fb){this._path=Fa,this._complete=Fb,Fz.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],Fu.create(this,this.onLoaded))},Fb.onLoaded=function(){this.parseFont(Fha.getRes(this._path),Fha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},Fb.parseFont=function(Fa,Fb){if(null!=Fa&&null!=Fb){this._texture=Fb;var Fc=Fa.getElementsByTagName("info");if(!Fc[0].getAttributeNode)return this.parseFont2(Fa,Fb);this.fontSize=parseInt(Fc[0].getAttributeNode("size").nodeValue);var Fd,Fe=Fc[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(Fe[0]),parseInt(Fe[1]),parseInt(Fe[2]),parseInt(Fe[3])],Fd=Fa.getElementsByTagName("char");var Ff=0;for(Ff=0;Ff<Fd.length;Ff++){var Fg=Fd[Ff],Fh=parseInt(Fg.getAttributeNode("id").nodeValue),Fi=parseInt(Fg.getAttributeNode("xoffset").nodeValue)/1,Fj=parseInt(Fg.getAttributeNode("yoffset").nodeValue)/1,Fm=parseInt(Fg.getAttributeNode("xadvance").nodeValue)/1,Fn=new FB;Fn.x=parseInt(Fg.getAttributeNode("x").nodeValue),Fn.y=parseInt(Fg.getAttributeNode("y").nodeValue),Fn.width=parseInt(Fg.getAttributeNode("width").nodeValue),Fn.height=parseInt(Fg.getAttributeNode("height").nodeValue);var Fo=Fma.create(Fb,Fn.x,Fn.y,Fn.width,Fn.height,Fi,Fj);this._maxWidth=Math.max(this._maxWidth,Fm+this.letterSpacing),this._fontCharDic[Fh]=Fo,this._fontWidthMap[Fh]=Fm}}},Fb.parseFont2=function(Fa,Fb){if(null!=Fa&&null!=Fb){this._texture=Fb;var Fc=Fa.getElementsByTagName("info");this.fontSize=parseInt(Fc[0].attributes.size.nodeValue);var Fd=Fc[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(Fd[0]),parseInt(Fd[1]),parseInt(Fd[2]),parseInt(Fd[3])];var Fe=Fa.getElementsByTagName("char"),Ff=0;for(Ff=0;Ff<Fe.length;Ff++){var Fg=Fe[Ff].attributes,Fh=parseInt(Fg.id.nodeValue),Fi=parseInt(Fg.xoffset.nodeValue)/1,Fj=parseInt(Fg.yoffset.nodeValue)/1,Fm=parseInt(Fg.xadvance.nodeValue)/1,Fn=new FB;Fn.x=parseInt(Fg.x.nodeValue),Fn.y=parseInt(Fg.y.nodeValue),Fn.width=parseInt(Fg.width.nodeValue),Fn.height=parseInt(Fg.height.nodeValue);var Fo=Fma.create(Fb,Fn.x,Fn.y,Fn.width,Fn.height,Fi,Fj);this._maxWidth=Math.max(this._maxWidth,Fm+this.letterSpacing),this._fontCharDic[Fh]=Fo,this._fontWidthMap[Fh]=Fm}}},Fb.getCharTexture=function(Fa){return this._fontCharDic[Fa.charCodeAt(0)]},Fb.destroy=function(){if(this._texture){for(var Fa in this._fontCharDic){var Fb=this._fontCharDic[Fa];Fb&&Fb.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},Fb.setSpaceWidth=function(Fa){this._spaceWidth=Fa},Fb.getCharWidth=function(Fa){var Fb=Fa.charCodeAt(0);return this._fontWidthMap[Fb]?this._fontWidthMap[Fb]+this.letterSpacing:" "==Fa?this._spaceWidth+this.letterSpacing:0},Fb.getTextWidth=function(Fa){for(var Fb=0,Fc=0,Fd=Fa.length;Fc<Fd;Fc++)Fb+=this.getCharWidth(Fa.charAt(Fc));return Fb},Fb.getMaxWidth=function(){return this._maxWidth},Fb.getMaxHeight=function(){return this.fontSize},Fb.drawText=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg,Fh=this.getTextWidth(Fa),Fi=0;"center"===Fe&&(Fi=(Ff-Fh)/2),"right"===Fe&&(Fi=Ff-Fh);for(var Fj=0,Fm=0,Fn=Fa.length;Fm<Fn;Fm++)(Fg=this.getCharTexture(Fa.charAt(Fm)))&&(Fb.graphics.drawTexture(Fg,Fc+Fj+Fi,Fd),Fj+=this.getCharWidth(Fa.charAt(Fm)))},Fa}(),Fh=function(){function Fc(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=Fc._TF_EMPTY}Fr(Fc,"laya.display.css.Style");var Fa=Fc.prototype;return Fa.getTransform=function(){return this._tf},Fa.setTransform=function(Fa){this._tf="none"!==Fa&&Fa?Fa:Fc._TF_EMPTY},Fa.setTranslateX=function(Fa){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.translateX=Fa},Fa.setTranslateY=function(Fa){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.translateY=Fa},Fa.setScaleX=function(Fa){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.scaleX=Fa},Fa.setScale=function(Fa,Fb){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.scaleX=Fa,this._tf.scaleY=Fb},Fa.setScaleY=function(Fa){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.scaleY=Fa},Fa.setRotate=function(Fa){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.rotate=Fa},Fa.setSkewX=function(Fa){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.skewX=Fa},Fa.setSkewY=function(Fa){this._tf===Fc._TF_EMPTY&&(this._tf=new Fe),this._tf.skewY=Fa},Fa.destroy=function(){this.scrollRect=null},Fa.render=function(Fa,Fb,Fc,Fd){},Fa.getCSSStyle=function(){return Fba.EMPTY},Fa._enableLayout=function(){return!1},Fm(0,Fa,"scaleX",function(){return this._tf.scaleX},function(Fa){this.setScaleX(Fa)}),Fm(0,Fa,"transform",function(){return this.getTransform()},function(Fa){this.setTransform(Fa)}),Fm(0,Fa,"translateX",function(){return this._tf.translateX},function(Fa){this.setTranslateX(Fa)}),Fm(0,Fa,"translateY",function(){return this._tf.translateY},function(Fa){this.setTranslateY(Fa)}),Fm(0,Fa,"scaleY",function(){return this._tf.scaleY},function(Fa){this.setScaleY(Fa)}),Fm(0,Fa,"block",function(){return 0!=(1&this._type)}),Fm(0,Fa,"skewY",function(){return this._tf.skewY},function(Fa){this.setSkewY(Fa)}),Fm(0,Fa,"rotate",function(){return this._tf.rotate},function(Fa){this.setRotate(Fa)}),Fm(0,Fa,"skewX",function(){return this._tf.skewX},function(Fa){this.setSkewX(Fa)}),Fm(0,Fa,"paddingLeft",function(){return 0}),Fm(0,Fa,"paddingTop",function(){return 0}),Fm(0,Fa,"absolute",function(){return!0}),Fc.__init__=function(){Fc._TF_EMPTY=new Fe,Fc.EMPTY=new Fc},Fc.EMPTY=null,Fc._TF_EMPTY=null,Fc}(),Fp=function(){function Fb(Fa){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=FS.create(Fb.defaultColor),this.family=Fb.defaultFamily,this.stroke=Fb._STROKE,this.size=Fb.defaultSize,Fa&&Fa!==Fb.EMPTY&&Fa.copyTo(this)}Fr(Fb,"laya.display.css.Font");var Fa=Fb.prototype;return Fa.set=function(Fa){this._text=null;for(var Fb=Fa.split(" "),Fc=0,Fd=Fb.length;Fc<Fd;Fc++){var Fe=Fb[Fc];switch(Fe){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<Fe.indexOf("px")&&(this.size=parseInt(Fe),this.family=Fb[Fc+1],Fc++)}},Fa.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},Fa.copyTo=function(Fa){Fa._type=this._type,Fa._text=this._text,Fa._weight=this._weight,Fa._color=this._color,Fa.family=this.family,Fa.stroke=this.stroke!=Fb._STROKE?this.stroke.slice():Fb._STROKE,Fa.indent=this.indent,Fa.size=this.size},Fm(0,Fa,"password",function(){return 0!=(1024&this._type)},function(Fa){Fa?this._type|=1024:this._type&=-1025}),Fm(0,Fa,"color",function(){return this._color.strColor},function(Fa){this._color=FS.create(Fa)}),Fm(0,Fa,"italic",function(){return 0!=(512&this._type)},function(Fa){Fa?this._type|=512:this._type&=-513}),Fm(0,Fa,"bold",function(){return 0!=(2048&this._type)},function(Fa){Fa?this._type|=2048:this._type&=-2049}),Fm(0,Fa,"weight",function(){return""+this._weight},function(Fa){var Fb=0;switch(Fa){case"normal":break;case"bold":this.bold=!0,Fb=700;break;case"bolder":Fb=800;break;case"lighter":Fb=100;break;default:Fb=parseInt(Fa)}this._weight=Fb,this._text=null}),Fm(0,Fa,"decoration",function(){return this._decoration?this._decoration.value:null},function(Fa){var Fb=Fa.split(" ");switch(this._decoration||(this._decoration={}),Fb[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=Fb[0]}Fb[1]&&(this._decoration.color=FS.create(Fb)),this._decoration.value=Fa}),Fb.__init__=function(){Fb.EMPTY=new Fb(null)},Fb.EMPTY=null,Fb.defaultColor="#000000",Fb.defaultSize=12,Fb.defaultFamily="Arial",Fb.defaultFont="12px Arial",Fb._STROKE=[0,"#000000"],Fb._ITALIC=512,Fb._PASSWORD=1024,Fb._BOLD=2048,Fb}(),Fe=function(){function Fa(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return Fr(Fa,"laya.display.css.TransformInfo"),Fa}(),Fo=function(){function Fn(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,FJ.isConchNode){this._nativeObj=new Fg._conchGraphics,this.id=this._nativeObj.conchID}}Fr(Fn,"laya.display.Graphics");var Fa=Fn.prototype;return Fa.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},Fa.clear=function(Fa){void 0===Fa&&(Fa=!1);var Fb=0,Fc=0;if(Fa){var Fd=this._one;if(this._cmds){for(Fc=this._cmds.length,Fb=0;Fb<Fc;Fb++)!(Fd=this._cmds[Fb])||Fd.callee!==FJ._context._drawTexture&&Fd.callee!==FJ._context._drawTextureWithTransform||(Fd[0]=null,Fn._cache.push(Fd));this._cmds.length=0}else Fd&&(!Fd||Fd.callee!==FJ._context._drawTexture&&Fd.callee!==FJ._context._drawTextureWithTransform||(Fd[0]=null,Fn._cache.push(Fd)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(Fb=0,Fc=this._vectorgraphArray.length;Fb<Fc;Fb++)F_.getInstance().deleteShape(this._vectorgraphArray[Fb]);this._vectorgraphArray.length=0}},Fa._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},Fa._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new Fc,this._graphicBounds._graphics=this)},Fa._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},Fa._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},Fa.getBounds=function(Fa){return void 0===Fa&&(Fa=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(Fa)},Fa.getBoundPoints=function(Fa){return void 0===Fa&&(Fa=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(Fa)},Fa._addCmd=function(Fa){this._cmds=this._cmds||[],Fa.callee=Fa.shift(),this._cmds.push(Fa)},Fa.setFilters=function(Fa){this._saveToCmd(FJ._context._setFilters,Fa)},Fa.drawTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){if(void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),void 0===Fg&&(Fg=1),!Fa||Fg<.01)return null;Fd||(Fd=Fa.sourceWidth),Fe||(Fe=Fa.sourceHeight),Fg=Fg<0?0:1<Fg?1:Fg;var Fh,Fi=!FJ.isWebGL&&(FO.onFirefox||FO.onEdge||FO.onIE||FO.onSafari)?.5:0,Fj=Fd/Fa.sourceWidth,Fm=Fe/Fa.sourceHeight;return Fd=Fa.width*Fj,Fe=Fa.height*Fm,Fa.loaded&&(Fd<=0||Fe<=0)?null:(Fb+=Fa.offsetX*Fj,Fc+=Fa.offsetY*Fm,this._sp&&(this._sp._renderType|=512),Fb-=Fi,Fc-=Fi,Fd+=2*Fi,Fe+=2*Fi,Fn._cache.length?((Fh=Fn._cache.pop())[0]=Fa,Fh[1]=Fb,Fh[2]=Fc,Fh[3]=Fd,Fh[4]=Fe,Fh[5]=Ff,Fh[6]=Fg):Fh=[Fa,Fb,Fc,Fd,Fe,Ff,Fg],Fh.callee=Ff||1!=Fg?FJ._context._drawTextureWithTransform:FJ._context._drawTexture,null!=this._one||Ff||1!=Fg?this._saveToCmd(Fh.callee,Fh):(this._one=Fh,this._render=this._renderOneImg),Fa.loaded||Fa.once("loaded",this,this._textureLoaded,[Fa,Fh]),this._repaint(),Fh)},Fa.cleanByTexture=function(Fa,Fb,Fc,Fd,Fe){if(void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),!Fa)return this.clear();if(this._one&&this._render===this._renderOneImg){Fd||(Fd=Fa.sourceWidth),Fe||(Fe=Fa.sourceHeight);var Ff=Fd/Fa.sourceWidth,Fg=Fe/Fa.sourceHeight;Fd=Fa.width*Ff,Fe=Fa.height*Fg,Fb+=Fa.offsetX*Ff,Fc+=Fa.offsetY*Fg,this._one[0]=Fa,this._one[1]=Fb,this._one[2]=Fc,this._one[3]=Fd,this._one[4]=Fe,this._repaint()}else this.clear(),Fa&&this.drawTexture(Fa,Fb,Fc,Fd,Fe)},Fa.drawTextures=function(Fa,Fb){Fa&&this._saveToCmd(FJ._context._drawTextures,[Fa,Fb])},Fa.fillTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){if(void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),void 0===Ff&&(Ff="repeat"),Fa){var Fh=[Fa,Fb,Fc,Fd,Fe,Ff,Fg||FA.EMPTY,{}];Fa.loaded||Fa.once("loaded",this,this._textureLoaded,[Fa,Fh]),this._saveToCmd(FJ._context._fillTexture,Fh)}},Fa._textureLoaded=function(Fa,Fb){Fb[3]=Fb[3]||Fa.width,Fb[4]=Fb[4]||Fa.height,this._repaint()},Fa.fillCircle=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){Fc.bitmap.enableMerageInAtlas=!1;var Fh=new Float32Array(2*(Fg+1)),Fi=new Float32Array(2*(Fg+1)),Fj=new Uint16Array(3*Fg),Fm=2*Math.PI/Fg,Fn=0;Fh[0]=Fd,Fh[1]=Fe,Fi[0]=Fd/Fc.width,Fi[1]=Fe/Fc.height;for(var Fo=2,Fp=0;Fp<Fg;Fp++){var Fq=Ff*Math.cos(Fn)+Fd,Fr=Ff*Math.sin(Fn)+Fe;Fh[Fo]=Fq,Fh[Fo+1]=Fr,Fi[Fo]=Fq/Fc.width,Fi[Fo+1]=Fr/Fc.height,Fn+=Fm,Fo+=2}for(Fp=Fo=0;Fp<Fg;Fp++)Fj[Fo++]=0,Fj[Fo++]=Fp+1,Fj[Fo++]=Fg+1<=Fp+2?1:Fp+2;this.drawTriangles(Fc,Fa,Fb,Fh,Fi,Fj)},Fa.drawTriangles=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){void 0===Fh&&(Fh=1),this._saveToCmd(FJ._context.drawTriangles,[Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj])},Fa._saveToCmd=function(Fa,Fb){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=Fb,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(Fb)),Fb.callee=Fa,this._repaint(),Fb},Fa.clipRect=function(Fa,Fb,Fc,Fd){this._saveToCmd(FJ._context._clipRect,[Fa,Fb,Fc,Fd])},Fa.fillText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){void 0===Fg&&(Fg=0),this._saveToCmd(FJ._context._fillText,[Fa,Fb,Fc,Fd||Fp.defaultFont,Fe,Ff])},Fa.fillBorderText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){this._saveToCmd(FJ._context._fillBorderText,[Fa,Fb,Fc,Fd||Fp.defaultFont,Fe,Ff,Fg,Fh])},Fa.strokeText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._saveToCmd(FJ._context._strokeText,[Fa,Fb,Fc,Fd||Fp.defaultFont,Fe,Ff,Fg])},Fa.alpha=function(Fa){Fa=Fa<0?0:1<Fa?1:Fa,this._saveToCmd(FJ._context._alpha,[Fa])},Fa.setAlpha=function(Fa){Fa=Fa<0?0:1<Fa?1:Fa,this._saveToCmd(FJ._context._setAlpha,[Fa])},Fa.transform=function(Fa,Fb,Fc){void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),this._saveToCmd(FJ._context._transform,[Fa,Fb,Fc])},Fa.rotate=function(Fa,Fb,Fc){void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),this._saveToCmd(FJ._context._rotate,[Fa,Fb,Fc])},Fa.scale=function(Fa,Fb,Fc,Fd){void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0),this._saveToCmd(FJ._context._scale,[Fa,Fb,Fc,Fd])},Fa.translate=function(Fa,Fb){this._saveToCmd(FJ._context._translate,[Fa,Fb])},Fa.save=function(){this._saveToCmd(FJ._context._save,[])},Fa.restore=function(){this._saveToCmd(FJ._context._restore,[])},Fa.replaceText=function(Fa){this._repaint();var Fb=this._cmds;if(Fb){for(var Fc=Fb.length-1;-1<Fc;Fc--)if(this._isTextCmd(Fb[Fc].callee))return Fb[Fc][0].toUpperCase?Fb[Fc][0]=Fa:Fb[Fc][0].setText(Fa),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=Fa:this._one[0].setText(Fa),!0;return!1},Fa._isTextCmd=function(Fa){return Fa===FJ._context._fillText||Fa===FJ._context._fillBorderText||Fa===FJ._context._strokeText},Fa.replaceTextColor=function(Fa){this._repaint();var Fb=this._cmds;if(Fb)for(var Fc=Fb.length-1;-1<Fc;Fc--)this._isTextCmd(Fb[Fc].callee)&&(Fb[Fc][4]=Fa,Fb[Fc][0].toUpperCase||(Fb[Fc][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=Fa,this._one[0].toUpperCase||(this._one[0].changed=!0))},Fa.loadImage=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=this;void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0);var Fh=Fha.getRes(Fa);function Fi(Fa){Fa&&(Fg.drawTexture(Fa,Fb,Fc,Fd,Fe),null!=Ff&&Ff.call(Fg._sp,Fa))}Fh?Fi(Fh):Fz.loader.load(Fa,Fu.create(null,Fi),null,"image")},Fa._renderEmpty=function(Fa,Fb,Fc,Fd){},Fa._renderAll=function(Fa,Fb,Fc,Fd){for(var Fe,Ff=this._cmds,Fg=0,Fh=Ff.length;Fg<Fh;Fg++)(Fe=Ff[Fg]).callee.call(Fb,Fc,Fd,Fe)},Fa._renderOne=function(Fa,Fb,Fc,Fd){this._one.callee.call(Fb,Fc,Fd,this._one)},Fa._renderOneImg=function(Fa,Fb,Fc,Fd){this._one.callee.call(Fb,Fc,Fd,this._one),2305!==Fa._renderType&&(Fa._renderType|=1)},Fa.drawLine=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Ff&&(Ff=1);var Fg=0;FJ.isWebGL&&(Fg=F_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Fg));var Fh=Ff%2==0?0:.5,Fi=[Fa+Fh,Fb+Fh,Fc+Fh,Fd+Fh,Fe,Ff,Fg];this._saveToCmd(FJ._context._drawLine,Fi)},Fa.drawLines=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=1);var Ff=0;if(Fc&&!(Fc.length<4)){FJ.isWebGL&&(Ff=F_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Ff));var Fg=Fe%2==0?0:.5,Fh=[Fa+Fg,Fb+Fg,Fc,Fd,Fe,Ff];this._saveToCmd(FJ._context._drawLines,Fh)}},Fa.drawCurves=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=1);var Ff=[Fa,Fb,Fc,Fd,Fe];this._saveToCmd(FJ._context._drawCurves,Ff)},Fa.drawRect=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){void 0===Fg&&(Fg=1);var Fh=Ff?Fg/2:0,Fi=Ff?Fg:0,Fj=[Fa+Fh,Fb+Fh,Fc-Fi,Fd-Fi,Fe,Ff,Fg];this._saveToCmd(FJ._context._drawRect,Fj)},Fa.drawCircle=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Ff&&(Ff=1);var Fg=Fe?Ff/2:0,Fh=0;FJ.isWebGL&&(Fh=F_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Fh));var Fi=[Fa,Fb,Fc-Fg,Fd,Fe,Ff,Fh];this._saveToCmd(FJ._context._drawCircle,Fi)},Fa.drawPie=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){void 0===Fh&&(Fh=1);var Fi=Fg?Fh/2:0,Fj=Fg?Fh:0,Fm=0;FJ.isWebGL&&(Fm=F_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Fm));var Fn=[Fa+Fi,Fb+Fi,Fc-Fj,Fd,Fe,Ff,Fg,Fh,Fm];Fn[3]=F$.toRadian(Fd),Fn[4]=F$.toRadian(Fe),this._saveToCmd(FJ._context._drawPie,Fn)},Fa.drawPoly=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Ff&&(Ff=1);var Fg=0,Fh=!1;FJ.isWebGL&&(Fg=F_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Fg),Fh=!(6<Fc.length));var Fi=Fe?Ff%2==0?0:.5:0,Fj=[Fa+Fi,Fb+Fi,Fc,Fd,Fe,Ff,Fg,Fh];this._saveToCmd(FJ._context._drawPoly,Fj)},Fa.drawPath=function(Fa,Fb,Fc,Fd,Fe){var Ff=[Fa,Fb,Fc,Fd,Fe];this._saveToCmd(FJ._context._drawPath,Ff)},Fm(0,Fa,"cmds",function(){return this._cmds},function(Fa){this._sp&&(this._sp._renderType|=512),this._cmds=Fa,this._render=this._renderAll,this._repaint()}),Fn.__init__=function(){if(FJ.isConchNode){for(var Fa=laya.display.Graphics.prototype,Fb=FO.window.ConchGraphics.prototype,Fc=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],Fd=0,Fe=Fc.length;Fd<=Fe;Fd++){var Ff=Fc[Fd];Fa[Ff]=Fb[Ff]}Fa._saveToCmd=null,Fb.drawImageS&&(Fa.drawTextures=function(Fa,Fb){if(Fa&&Fa.loaded&&Fa.bitmap&&Fa.source){var Fc=Fa.uv,Fd=Fa.bitmap.width,Fe=Fa.bitmap.height;this.drawImageS(Fa.bitmap.source,Fc[0]*Fd,Fc[1]*Fe,(Fc[2]-Fc[0])*Fd,(Fc[5]-Fc[3])*Fe,Fa.offsetX,Fa.offsetY,Fa.width,Fa.height,Fb)}}),Fa.drawTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){if(void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),void 0===Fg&&(Fg=1),Fa)if(Fa.loaded){if(Fa.loaded&&Fa.bitmap&&Fa.source&&(Fd||(Fd=Fa.sourceWidth),Fe||(Fe=Fa.sourceHeight),Fg=Fg<0?0:1<Fg?1:Fg,Fd=Fd-Fa.sourceWidth+Fa.width,Fe=Fe-Fa.sourceHeight+Fa.height,!(Fd<=0||Fe<=0))){Fb+=Fa.offsetX,Fc+=Fa.offsetY;var Fh=Fa.uv,Fi=Fa.bitmap.width,Fj=Fa.bitmap.height;Fh[4]<Fh[0]&&Fh[5]<Fh[1]?this.drawImageM(Fa.bitmap.source,Fh[4]*Fi,Fh[5]*Fj,(Fh[0]-Fh[4])*Fi,(Fh[1]-Fh[5])*Fj,Fb,Fc,Fd,Fe,Ff,Fg):this.drawImageM(Fa.bitmap.source,Fh[0]*Fi,Fh[1]*Fj,(Fh[2]-Fh[0])*Fi,(Fh[5]-Fh[3])*Fj,Fb,Fc,Fd,Fe,Ff,Fg),this._repaint()}}else Fa.once("loaded",this,function(){this.drawTexture(Fa,Fb,Fc,Fd,Fe,Ff)})},Fa.fillTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){if(void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),void 0===Ff&&(Ff="repeat"),Fa&&Fa.loaded){var Fh,Fi=FJ._context.ctx,Fj=Fa.bitmap.width,Fm=Fa.bitmap.height,Fn=Fa.uv;Fh=Fa.uv!=Fma.DEF_UV?Fi.createPattern(Fa.bitmap.source,Ff,Fn[0]*Fj,Fn[1]*Fm,(Fn[2]-Fn[0])*Fj,(Fn[5]-Fn[3])*Fm):Fi.createPattern(Fa.bitmap.source,Ff);var Fo=0,Fp=0;Fg&&(Fb+=Fg.x%Fa.width,Fc+=Fg.y%Fa.height,Fo-=Fg.x%Fa.width,Fp-=Fg.y%Fa.height),this._fillImage(Fh,Fb,Fc,Fo,Fp,Fd,Fe)}}}},Fn._cache=[],Fn}(),Fc=function(){function Fv(){this._cacheBoundsType=!1}Fr(Fv,"laya.display.GraphicsBounds");var Fa=Fv.prototype;return Fa.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},Fa.reset=function(){this._temp&&(this._temp.length=0)},Fa.getBounds=function(Fa){return void 0===Fa&&(Fa=!1),(!this._bounds||!this._temp||this._temp.length<1||Fa!=this._cacheBoundsType)&&(this._bounds=FB._getWrapRec(this.getBoundPoints(Fa),this._bounds)),this._cacheBoundsType=Fa,this._bounds},Fa.getBoundPoints=function(Fa){return void 0===Fa&&(Fa=!1),(!this._temp||this._temp.length<1||Fa!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(Fa)),this._cacheBoundsType=Fa,this._rstBoundPoints=F$.copyArray(this._rstBoundPoints,this._temp)},Fa._getCmdPoints=function(Fa){void 0===Fa&&(Fa=!1);var Fb,Fc,Fd=FJ._context,Fe=this._graphics.cmds;if((Fb=this._temp||(this._temp=[])).length=0,Fe||null==this._graphics._one||(Fv._tempCmds.length=0,Fv._tempCmds.push(this._graphics._one),Fe=Fv._tempCmds),!Fe)return Fb;(Fc=Fv._tempMatrixArrays).length=0;var Ff=Fv._initMatrix;Ff.identity();for(var Fg,Fh,Fi=Fv._tempMatrix,Fj=NaN,Fm=NaN,Fn=NaN,Fo=NaN,Fp=NaN,Fq=NaN,Fr=0,Fs=Fe.length;Fr<Fs;Fr++)if((Fg=Fe[Fr]).callee)switch(Fg.callee){case Fd._save:case 7:Fc.push(Ff),Ff=Ff.clone();break;case Fd._restore:case 8:Ff=Fc.pop();break;case Fd._scale:case 5:Fi.identity(),Fi.translate(-Fg[2],-Fg[3]),Fi.scale(Fg[0],Fg[1]),Fi.translate(Fg[2],Fg[3]),this._switchMatrix(Ff,Fi);break;case Fd._rotate:case 3:Fi.identity(),Fi.translate(-Fg[1],-Fg[2]),Fi.rotate(Fg[0]),Fi.translate(Fg[1],Fg[2]),this._switchMatrix(Ff,Fi);break;case Fd._translate:case 6:Fi.identity(),Fi.translate(Fg[0],Fg[1]),this._switchMatrix(Ff,Fi);break;case Fd._transform:case 4:Fi.identity(),Fi.translate(-Fg[1],-Fg[2]),Fi.concat(Fg[0]),Fi.translate(Fg[1],Fg[2]),this._switchMatrix(Ff,Fi);break;case 16:case 24:Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[0],Fg[1],Fg[2],Fg[3]),Ff);break;case 17:Ff.copyTo(Fi),Fi.concat(Fg[4]),Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[0],Fg[1],Fg[2],Fg[3]),Fi);break;case Fd._drawTexture:Fh=Fg[0],Fa?Fg[3]&&Fg[4]?Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1],Fg[2],Fg[3],Fg[4]),Ff):(Fh=Fg[0],Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1],Fg[2],Fh.width,Fh.height),Ff)):(Fj=(Fg[3]||Fh.sourceWidth)/Fh.width,Fm=(Fg[4]||Fh.sourceHeight)/Fh.height,Fn=Fj*Fh.sourceWidth,Fo=Fm*Fh.sourceHeight,Fp=0<Fh.offsetX?Fh.offsetX:0,Fq=0<Fh.offsetY?Fh.offsetY:0,Fp*=Fj,Fq*=Fm,Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1]-Fp,Fg[2]-Fq,Fn,Fo),Ff));break;case Fd._fillTexture:Fg[3]&&Fg[4]?Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1],Fg[2],Fg[3],Fg[4]),Ff):(Fh=Fg[0],Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1],Fg[2],Fh.width,Fh.height),Ff));break;case Fd._drawTextureWithTransform:var Ft;Ft=Fg[5]?(Ff.copyTo(Fi),Fi.concat(Fg[5]),Fi):Ff,Fa?Fg[3]&&Fg[4]?Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1],Fg[2],Fg[3],Fg[4]),Ft):(Fh=Fg[0],Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1],Fg[2],Fh.width,Fh.height),Ft)):(Fh=Fg[0],Fj=(Fg[3]||Fh.sourceWidth)/Fh.width,Fm=(Fg[4]||Fh.sourceHeight)/Fh.height,Fn=Fj*Fh.sourceWidth,Fo=Fm*Fh.sourceHeight,Fp=0<Fh.offsetX?Fh.offsetX:0,Fq=0<Fh.offsetY?Fh.offsetY:0,Fp*=Fj,Fq*=Fm,Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[1]-Fp,Fg[2]-Fq,Fn,Fo),Ft));break;case Fd._drawRect:case 13:Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[0],Fg[1],Fg[2],Fg[3]),Ff);break;case Fd._drawCircle:case Fd._fillCircle:case 14:Fv._addPointArrToRst(Fb,FB._getBoundPointS(Fg[0]-Fg[2],Fg[1]-Fg[2],Fg[2]+Fg[2],Fg[2]+Fg[2]),Ff);break;case Fd._drawLine:case 20:Fv._tempPoints.length=0;var Fu;Fu=.5*Fg[5],Fg[0]==Fg[2]?Fv._tempPoints.push(Fg[0]+Fu,Fg[1],Fg[2]+Fu,Fg[3],Fg[0]-Fu,Fg[1],Fg[2]-Fu,Fg[3]):Fg[1]==Fg[3]?Fv._tempPoints.push(Fg[0],Fg[1]+Fu,Fg[2],Fg[3]+Fu,Fg[0],Fg[1]-Fu,Fg[2],Fg[3]-Fu):Fv._tempPoints.push(Fg[0],Fg[1],Fg[2],Fg[3]),Fv._addPointArrToRst(Fb,Fv._tempPoints,Ff);break;case Fd._drawCurves:case 22:Fv._addPointArrToRst(Fb,Fw.I.getBezierPoints(Fg[2]),Ff,Fg[0],Fg[1]);break;case Fd._drawPoly:case Fd._drawLines:case 18:Fv._addPointArrToRst(Fb,Fg[2],Ff,Fg[0],Fg[1]);break;case Fd._drawPath:case 19:Fv._addPointArrToRst(Fb,this._getPathPoints(Fg[2]),Ff,Fg[0],Fg[1]);break;case Fd._drawPie:case 15:Fv._addPointArrToRst(Fb,this._getPiePoints(Fg[0],Fg[1],Fg[2],Fg[3],Fg[4]),Ff)}return 200<Fb.length?Fb=F$.copyArray(Fb,FB._getWrapRec(Fb)._getBoundPoints()):8<Fb.length&&(Fb=Fx.scanPList(Fb)),Fb},Fa._switchMatrix=function(Fa,Fb){Fb.concat(Fa),Fb.copyTo(Fa)},Fa._getPiePoints=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fv._tempPoints;Fv._tempPoints.length=0,Ff.push(Fa,Fb);var Fg=(Fe-Fd)%(2*Math.PI)/10,Fh=NaN,Fi=Fd;for(Fh=0;Fh<=10;Fh++)Ff.push(Fa+Fc*Math.cos(Fi),Fb+Fc*Math.sin(Fi)),Fi+=Fg;return Ff},Fa._getPathPoints=function(Fa){var Fb,Fc,Fd=0,Fe=Fv._tempPoints;for(Fe.length=0,Fb=Fa.length,Fd=0;Fd<Fb;Fd++)1<(Fc=Fa[Fd]).length&&(Fe.push(Fc[1],Fc[2]),3<Fc.length&&Fe.push(Fc[3],Fc[4]));return Fe},Fv._addPointArrToRst=function(Fa,Fb,Fc,Fd,Fe){void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0);var Ff,Fg=0;for(Ff=Fb.length,Fg=0;Fg<Ff;Fg+=2)Fv._addPointToRst(Fa,Fb[Fg]+Fd,Fb[Fg+1]+Fe,Fc)},Fv._addPointToRst=function(Fa,Fb,Fc,Fd){var Fe=FA.TEMP;Fe.setTo(Fb||0,Fc||0),Fd.transformPoint(Fe),Fa.push(Fe.x,Fe.y)},Fv._tempPoints=[],Fv._tempMatrixArrays=[],Fv._tempCmds=[],Fi(Fv,["_tempMatrix",function(){return this._tempMatrix=new FG},"_initMatrix",function(){return this._initMatrix=new FG}]),Fv}(),Ff=function(){function Fa(){}Fr(Fa,"laya.events.Event");var Fb=Fa.prototype;return Fb.setTo=function(Fa,Fb,Fc){return this.type=Fa,this.currentTarget=Fb,this.target=Fc,this},Fb.stopPropagation=function(){this._stoped=!0},Fm(0,Fb,"stageY",function(){return Fz.stage.mouseY}),Fm(0,Fb,"charCode",function(){return this.nativeEvent.charCode}),Fm(0,Fb,"touches",function(){var Fa=this.nativeEvent.touches;if(Fa)for(var Fb=Fz.stage,Fc=0,Fd=Fa.length;Fc<Fd;Fc++){var Fe=Fa[Fc],Ff=FA.TEMP;Ff.setTo(Fe.clientX,Fe.clientY),Fb._canvasTransform.invertTransformPoint(Ff),Fb.transform.invertTransformPoint(Ff),Fe.stageX=Ff.x,Fe.stageY=Ff.y}return Fa}),Fm(0,Fb,"keyLocation",function(){return this.nativeEvent.keyLocation}),Fm(0,Fb,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),Fm(0,Fb,"altKey",function(){return this.nativeEvent.altKey}),Fm(0,Fb,"shiftKey",function(){return this.nativeEvent.shiftKey}),Fm(0,Fb,"stageX",function(){return Fz.stage.mouseX}),Fa.EMPTY=new Fa,Fa.MOUSE_DOWN="mousedown",Fa.MOUSE_UP="mouseup",Fa.CLICK="click",Fa.RIGHT_MOUSE_DOWN="rightmousedown",Fa.RIGHT_MOUSE_UP="rightmouseup",Fa.RIGHT_CLICK="rightclick",Fa.MOUSE_MOVE="mousemove",Fa.MOUSE_OVER="mouseover",Fa.MOUSE_OUT="mouseout",Fa.MOUSE_WHEEL="mousewheel",Fa.ROLL_OVER="mouseover",Fa.ROLL_OUT="mouseout",Fa.DOUBLE_CLICK="doubleclick",Fa.CHANGE="change",Fa.CHANGED="changed",Fa.RESIZE="resize",Fa.ADDED="added",Fa.REMOVED="removed",Fa.DISPLAY="display",Fa.UNDISPLAY="undisplay",Fa.ERROR="error",Fa.COMPLETE="complete",Fa.LOADED="loaded",Fa.INITED="inited",Fa.PROGRESS="progress",Fa.INPUT="input",Fa.RENDER="render",Fa.OPEN="open",Fa.MESSAGE="message",Fa.CLOSE="close",Fa.KEY_DOWN="keydown",Fa.KEY_PRESS="keypress",Fa.KEY_UP="keyup",Fa.FRAME="enterframe",Fa.DRAG_START="dragstart",Fa.DRAG_MOVE="dragmove",Fa.DRAG_END="dragend",Fa.ENTER="enter",Fa.SELECT="select",Fa.BLUR="blur",Fa.FOCUS="focus",Fa.VISIBILITY_CHANGE="visibilitychange",Fa.FOCUS_CHANGE="focuschange",Fa.PLAYED="played",Fa.PAUSED="paused",Fa.STOPPED="stopped",Fa.START="start",Fa.END="end",Fa.ENABLE_CHANGED="enablechanged",Fa.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",Fa.COMPONENT_ADDED="componentadded",Fa.COMPONENT_REMOVED="componentremoved",Fa.LAYER_CHANGED="layerchanged",Fa.HIERARCHY_LOADED="hierarchyloaded",Fa.RECOVERED="recovered",Fa.RELEASED="released",Fa.LINK="link",Fa.LABEL="label",Fa.FULL_SCREEN_CHANGE="fullscreenchange",Fa.DEVICE_LOST="devicelost",Fa.MESH_CHANGED="meshchanged",Fa.MATERIAL_CHANGED="materialchanged",Fa.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",Fa.ANIMATION_CHANGED="animationchanged",Fa.TRIGGER_ENTER="triggerenter",Fa.TRIGGER_STAY="triggerstay",Fa.TRIGGER_EXIT="triggerexit",Fa.TRAIL_FILTER_CHANGE="trailfilterchange",Fa.DOMINO_FILTER_CHANGE="dominofilterchange",Fa}(),Fn=(function(){function Fa(){}Fr(Fa,"laya.events.Keyboard"),Fa.NUMBER_0=48,Fa.NUMBER_1=49,Fa.NUMBER_2=50,Fa.NUMBER_3=51,Fa.NUMBER_4=52,Fa.NUMBER_5=53,Fa.NUMBER_6=54,Fa.NUMBER_7=55,Fa.NUMBER_8=56,Fa.NUMBER_9=57,Fa.A=65,Fa.B=66,Fa.C=67,Fa.D=68,Fa.E=69,Fa.F=70,Fa.G=71,Fa.H=72,Fa.I=73,Fa.J=74,Fa.K=75,Fa.L=76,Fa.M=77,Fa.N=78,Fa.O=79,Fa.P=80,Fa.Q=81,Fa.R=82,Fa.S=83,Fa.T=84,Fa.U=85,Fa.V=86,Fa.W=87,Fa.X=88,Fa.Y=89,Fa.Z=90,Fa.F1=112,Fa.F2=113,Fa.F3=114,Fa.F4=115,Fa.F5=116,Fa.F6=117,Fa.F7=118,Fa.F8=119,Fa.F9=120,Fa.F10=121,Fa.F11=122,Fa.F12=123,Fa.F13=124,Fa.F14=125,Fa.F15=126,Fa.NUMPAD=21,Fa.NUMPAD_0=96,Fa.NUMPAD_1=97,Fa.NUMPAD_2=98,Fa.NUMPAD_3=99,Fa.NUMPAD_4=100,Fa.NUMPAD_5=101,Fa.NUMPAD_6=102,Fa.NUMPAD_7=103,Fa.NUMPAD_8=104,Fa.NUMPAD_9=105,Fa.NUMPAD_ADD=107,Fa.NUMPAD_DECIMAL=110,Fa.NUMPAD_DIVIDE=111,Fa.NUMPAD_ENTER=108,Fa.NUMPAD_MULTIPLY=106,Fa.NUMPAD_SUBTRACT=109,Fa.SEMICOLON=186,Fa.EQUAL=187,Fa.COMMA=188,Fa.MINUS=189,Fa.PERIOD=190,Fa.SLASH=191,Fa.BACKQUOTE=192,Fa.LEFTBRACKET=219,Fa.BACKSLASH=220,Fa.RIGHTBRACKET=221,Fa.QUOTE=222,Fa.ALTERNATE=18,Fa.BACKSPACE=8,Fa.CAPS_LOCK=20,Fa.COMMAND=15,Fa.CONTROL=17,Fa.DELETE=46,Fa.ENTER=13,Fa.ESCAPE=27,Fa.PAGE_UP=33,Fa.PAGE_DOWN=34,Fa.END=35,Fa.HOME=36,Fa.LEFT=37,Fa.UP=38,Fa.RIGHT=39,Fa.DOWN=40,Fa.SHIFT=16,Fa.SPACE=32,Fa.TAB=9,Fa.INSERT=45}(),function(){function Fe(){}return Fr(Fe,"laya.events.KeyBoardManager"),Fe.__init__=function(){Fe._addEvent("keydown"),Fe._addEvent("keypress"),Fe._addEvent("keyup")},Fe._addEvent=function(Fb){FO.document.addEventListener(Fb,function(Fa){laya.events.KeyBoardManager._dispatch(Fa,Fb)},!0)},Fe._dispatch=function(Fa,Fb){if(Fe.enabled){Fe._event._stoped=!1,Fe._event.nativeEvent=Fa,Fe._event.keyCode=Fa.keyCode||Fa.which||Fa.charCode,"keydown"===Fb?Fe._pressKeys[Fe._event.keyCode]=!0:"keyup"===Fb&&(Fe._pressKeys[Fe._event.keyCode]=null);for(var Fc=Fz.stage.focus&&null!=Fz.stage.focus.event&&Fz.stage.focus.displayedInStage?Fz.stage.focus:Fz.stage,Fd=Fc;Fd;)Fd.event(Fb,Fe._event.setTo(Fb,Fd,Fc)),Fd=Fd.parent}},Fe.hasKeyDown=function(Fa){return Fe._pressKeys[Fa]},Fe._pressKeys={},Fe.enabled=!0,Fi(Fe,["_event",function(){return this._event=new Ff}]),Fe}()),Fq=(function(){function Fa(){}Fr(Fa,"laya.events.KeyLocation"),Fa.STANDARD=0,Fa.LEFT=1,Fa.RIGHT=2,Fa.NUM_PAD=3}(),function(){function Fm(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=FO.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new Ff,this._matrix=new FG,this._point=new FA,this._rect=new FB,this._prePoint=new FA,this._curTouchID=NaN}Fr(Fm,"laya.events.MouseManager");var Fa=Fm.prototype;return Fa.__init__=function(Fa,Fb){var Fc=this;this._stage=Fa;var Fd=this,Fe=this._eventList;Fb.oncontextmenu=function(Fa){if(Fm.enabled)return!1},Fb.addEventListener("mousedown",function(Fa){Fm.enabled&&(FO.onIE||Fa.preventDefault(),Fe.push(Fa),Fd.mouseDownTime=FO.now())}),Fb.addEventListener("mouseup",function(Fa){Fm.enabled&&(Fa.preventDefault(),Fe.push(Fa),Fd.mouseDownTime=-FO.now())},!0),Fb.addEventListener("mousemove",function(Fa){if(Fm.enabled){Fa.preventDefault();var Fb=FO.now();if(Fb-Fd._lastMoveTimer<10)return;Fd._lastMoveTimer=Fb,Fe.push(Fa)}},!0),Fb.addEventListener("mouseout",function(Fa){Fm.enabled&&Fe.push(Fa)}),Fb.addEventListener("mouseover",function(Fa){Fm.enabled&&Fe.push(Fa)}),Fb.addEventListener("touchstart",function(Fa){Fm.enabled&&(Fe.push(Fa),Fm._isFirstTouch||Fxa.isInputting||Fa.preventDefault(),Fd.mouseDownTime=FO.now())}),Fb.addEventListener("touchend",function(Fa){Fm.enabled?(Fm._isFirstTouch||Fxa.isInputting||Fa.preventDefault(),Fm._isFirstTouch=!1,Fe.push(Fa),Fd.mouseDownTime=-FO.now()):Fc._curTouchID=NaN},!0),Fb.addEventListener("touchmove",function(Fa){Fm.enabled&&(Fa.preventDefault(),Fe.push(Fa))},!0),Fb.addEventListener("touchcancel",function(Fa){Fm.enabled?(Fa.preventDefault(),Fe.push(Fa)):Fc._curTouchID=NaN},!0),Fb.addEventListener("mousewheel",function(Fa){Fm.enabled&&Fe.push(Fa)}),Fb.addEventListener("DOMMouseScroll",function(Fa){Fm.enabled&&Fe.push(Fa)})},Fa.initEvent=function(Fa,Fb){var Fc;this._event._stoped=!1,this._event.nativeEvent=Fb||Fa,this._target=null,this._point.setTo(Fa.pageX||Fa.clientX,Fa.pageY||Fa.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=Fa.identifier||0,this._tTouchID=this._event.touchId,(Fc=Fs.I._event)._stoped=!1,Fc.nativeEvent=this._event.nativeEvent,Fc.touchId=this._event.touchId},Fa.checkMouseWheel=function(Fa){this._event.delta=Fa.wheelDelta?.025*Fa.wheelDelta:-Fa.detail;for(var Fb=Fs.I.getLastOvers(),Fc=0,Fd=Fb.length;Fc<Fd;Fc++){var Fe=Fb[Fc];Fe.event("mousewheel",this._event.setTo("mousewheel",Fe,this._target))}},Fa.onMouseMove=function(Fa){Fs.I.onMouseMove(Fa,this._tTouchID)},Fa.onMouseDown=function(Fa){if(Fxa.isInputting&&Fz.stage.focus&&Fz.stage.focus.focus&&!Fz.stage.focus.contains(this._target)){var Fb=Fz.stage.focus._tf||Fz.stage.focus,Fc=Fa._tf||Fa;Fc instanceof laya.display.Input&&Fc.multiline==Fb.multiline?Fb._focusOut():Fb.focus=!1}Fs.I.onMouseDown(Fa,this._tTouchID,this._isLeftMouse)},Fa.onMouseUp=function(Fa){Fs.I.onMouseUp(Fa,this._tTouchID,this._isLeftMouse)},Fa.check=function(Fa,Fb,Fc,Fd){this._point.setTo(Fb,Fc),Fa.fromParentPoint(this._point),Fb=this._point.x,Fc=this._point.y;var Fe=Fa.scrollRect;if(Fe&&(this._rect.setTo(Fe.x,Fe.y,Fe.width,Fe.height),!this._rect.contains(Fb,Fc)))return!1;if(!this.disableMouseEvent){if(Fa.hitTestPrior&&!Fa.mouseThrough&&!this.hitTest(Fa,Fb,Fc))return!1;for(var Ff=Fa._childs.length-1;-1<Ff;Ff--){var Fg=Fa._childs[Ff];if(!Fg.destroyed&&Fg.mouseEnabled&&Fg.visible&&this.check(Fg,Fb,Fc,Fd))return!0}}var Fh=!(!Fa.hitTestPrior||Fa.mouseThrough||this.disableMouseEvent)||this.hitTest(Fa,Fb,Fc);return Fh?(this._target=Fa,Fd.call(this,Fa)):Fd===this.onMouseUp&&Fa===this._stage&&(this._target=this._stage,Fd.call(this,this._target)),Fh},Fa.hitTest=function(Fa,Fb,Fc){var Fd=!1;if(Fa.scrollRect&&(Fb-=Fa.scrollRect.x,Fc-=Fa.scrollRect.y),Fa.hitArea instanceof laya.utils.HitArea)return Fa.hitArea.isHit(Fb,Fc);if(0<Fa.width&&0<Fa.height||Fa.mouseThrough||Fa.hitArea)if(Fa.mouseThrough)Fd=Fa.getGraphicBounds().contains(Fb,Fc);else{var Fe=this._rect;Fa.hitArea?Fe=Fa.hitArea:Fe.setTo(0,0,Fa.width,Fa.height),Fd=Fe.contains(Fb,Fc)}return Fd},Fa.runEvent=function(){var Fa=this._eventList.length;if(Fa){var Fb=this;Fb.mouseEventTime=FO.now();var Fc,Fd=0,Fe=0,Ff=0;try{for(;Fd<Fa;){var Fg=this._eventList[Fd];switch("mousemove"!==Fg.type&&(this._prePoint.x=this._prePoint.y=-1e6),Fg.type){case"mousedown":this._touchIDs[0]=this._id++,Fm._isTouchRespond?Fm._isTouchRespond=!1:(Fb._isLeftMouse=0===Fg.button,Fb.initEvent(Fg),Fb.check(Fb._stage,Fb.mouseX,Fb.mouseY,Fb.onMouseDown));break;case"mouseup":Fb._isLeftMouse=0===Fg.button,Fb.initEvent(Fg),Fb.check(Fb._stage,Fb.mouseX,Fb.mouseY,Fb.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-Fg.clientX)+Math.abs(this._prePoint.y-Fg.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=Fg.clientX,this._prePoint.y=Fg.clientY,Fb.initEvent(Fg),Fb.check(Fb._stage,Fb.mouseX,Fb.mouseY,Fb.onMouseMove));break;case"touchstart":Fm._isTouchRespond=!0,Fb._isLeftMouse=!0;var Fh=Fg.changedTouches;for(Fe=0,Ff=Fh.length;Fe<Ff;Fe++)Fc=Fh[Fe],(Fm.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=Fc.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[Fc.identifier]=this._id++,Fb.initEvent(Fc,Fg),Fb.check(Fb._stage,Fb.mouseX,Fb.mouseY,Fb.onMouseDown));break;case"touchend":case"touchcancel":Fm._isTouchRespond=!0,Fb._isLeftMouse=!0;var Fi=Fg.changedTouches;for(Fe=0,Ff=Fi.length;Fe<Ff;Fe++)if(Fc=Fi[Fe],Fm.multiTouchEnabled||Fc.identifier==this._curTouchID){this._curTouchID=NaN,Fb.initEvent(Fc,Fg);Fb.check(Fb._stage,Fb.mouseX,Fb.mouseY,Fb.onMouseUp)||Fb.onMouseUp(null)}break;case"touchmove":var Fj=Fg.changedTouches;for(Fe=0,Ff=Fj.length;Fe<Ff;Fe++)Fc=Fj[Fe],(Fm.multiTouchEnabled||Fc.identifier==this._curTouchID)&&(Fb.initEvent(Fc,Fg),Fb.check(Fb._stage,Fb.mouseX,Fb.mouseY,Fb.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":Fb.checkMouseWheel(Fg);break;case"mouseout":Fs.I.stageMouseOut();break;case"mouseover":Fb._stage.event("mouseover",Fb._event.setTo("mouseover",Fb._stage,Fb._stage))}Fd++}}catch(Fa){throw this._eventList.length=0,Fa}this._eventList.length=0}},Fm.enabled=!0,Fm.multiTouchEnabled=!0,Fm._isTouchRespond=!1,Fm._isFirstTouch=!0,Fi(Fm,["instance",function(){return this.instance=new Fm}]),Fm}()),Fs=function(){function Fq(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new Ff}Fr(Fq,"laya.events.TouchManager");var Fa=Fq.prototype;return Fa._clearTempArrs=function(){Fq._oldArr.length=0,Fq._newArr.length=0,Fq._tEleArr.length=0},Fa.getTouchFromArr=function(Fa,Fb){var Fc,Fd,Fe=0;for(Fc=Fb.length,Fe=0;Fe<Fc;Fe++)if((Fd=Fb[Fe]).id==Fa)return Fd;return null},Fa.removeTouchFromArr=function(Fa,Fb){var Fc=0;for(Fc=Fb.length-1;0<=Fc;Fc--)Fb[Fc].id==Fa&&Fb.splice(Fc,1)},Fa.createTouchO=function(Fa,Fb){var Fc;return(Fc=FW.getItem("TouchData")||{}).id=Fb,Fc.tar=Fa,Fc},Fa.onMouseDown=function(Fa,Fb,Fc){var Fd,Fe,Ff,Fg;(void 0===Fc&&(Fc=!1),this.enable)&&(Fd=this.getTouchFromArr(Fb,this.preOvers),Ff=this.getEles(Fa,null,Fq._tEleArr),Fd?Fd.tar=Fa:(Fe=this.createTouchO(Fa,Fb),this.preOvers.push(Fe)),FO.onMobile&&this.sendEvents(Ff,"mouseover",Fb),Fg=Fc?this.preDowns:this.preRightDowns,(Fd=this.getTouchFromArr(Fb,Fg))?Fd.tar=Fa:(Fe=this.createTouchO(Fa,Fb),Fg.push(Fe)),this.sendEvents(Ff,Fc?"mousedown":"rightmousedown",Fb),this._clearTempArrs())},Fa.sendEvents=function(Fa,Fb,Fc){void 0===Fc&&(Fc=0);var Fd,Fe,Ff,Fg=0;for(Fd=Fa.length,this._event._stoped=!1,Fe=Fa[0],Fg=0;Fg<Fd;Fg++){if((Ff=Fa[Fg]).destroyed)return;if(Ff.event(Fb,this._event.setTo(Fb,Ff,Fe)),this._event._stoped)break}},Fa.getEles=function(Fa,Fb,Fc){for(Fc?Fc.length=0:Fc=[];Fa&&Fa!=Fb;)Fc.push(Fa),Fa=Fa.parent;return Fc},Fa.checkMouseOutAndOverOfMove=function(Fa,Fb,Fc){if(void 0===Fc&&(Fc=0),Fb!=Fa){var Fd,Fe,Ff=0,Fg=0;if(Fb.contains(Fa))Fe=this.getEles(Fa,Fb,Fq._tEleArr),this.sendEvents(Fe,"mouseover",Fc);else if(Fa.contains(Fb))Fe=this.getEles(Fb,Fa,Fq._tEleArr),this.sendEvents(Fe,"mouseout",Fc);else{var Fh,Fi;(Fe=Fq._tEleArr).length=0,Fh=this.getEles(Fb,null,Fq._oldArr),Fi=this.getEles(Fa,null,Fq._newArr),Fg=Fh.length;var Fj=0;for(Ff=0;Ff<Fg;Ff++){if(Fd=Fh[Ff],0<=(Fj=Fi.indexOf(Fd))){Fi.splice(Fj,Fi.length-Fj);break}Fe.push(Fd)}0<Fe.length&&this.sendEvents(Fe,"mouseout",Fc),0<Fi.length&&this.sendEvents(Fi,"mouseover",Fc)}}},Fa.onMouseMove=function(Fa,Fb){var Fc,Fd;this.enable&&((Fc=this.getTouchFromArr(Fb,this.preOvers))?(this.checkMouseOutAndOverOfMove(Fa,Fc.tar),Fc.tar=Fa,Fd=this.getEles(Fa,null,Fq._tEleArr)):(Fd=this.getEles(Fa,null,Fq._tEleArr),this.sendEvents(Fd,"mouseover",Fb),this.preOvers.push(this.createTouchO(Fa,Fb))),this.sendEvents(Fd,"mousemove",Fb),this._clearTempArrs())},Fa.getLastOvers=function(){return(Fq._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,Fq._tEleArr):(Fq._tEleArr.push(Fz.stage),Fq._tEleArr)},Fa.stageMouseOut=function(){var Fa;Fa=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(Fa,"mouseout",0)},Fa.onMouseUp=function(Fa,Fb,Fc){if(void 0===Fc&&(Fc=!1),this.enable){var Fd,Fe,Ff,Fg,Fh,Fi,Fj=0,Fm=0,Fn=FO.onMobile;if(Fe=this.getEles(Fa,null,Fq._tEleArr),this.sendEvents(Fe,Fc?"mouseup":"rightmouseup",Fb),Fi=Fc?this.preDowns:this.preRightDowns,Fd=this.getTouchFromArr(Fb,Fi)){var Fo,Fp=FO.now();if(Fo=Fp-this._lastClickTime<300,this._lastClickTime=Fp,Fa==Fd.tar)Fh=Fe;else for(Ff=this.getEles(Fd.tar,null,Fq._oldArr),(Fh=Fq._newArr).length=0,Fm=Ff.length,Fj=0;Fj<Fm;Fj++)Fg=Ff[Fj],0<=Fe.indexOf(Fg)&&Fh.push(Fg);0<Fh.length&&this.sendEvents(Fh,Fc?"click":"rightclick",Fb),Fc&&Fo&&this.sendEvents(Fh,"doubleclick",Fb),this.removeTouchFromArr(Fb,Fi),Fd.tar=null,FW.recover("TouchData",Fd)}else;(Fd=this.getTouchFromArr(Fb,this.preOvers))&&Fn&&((Fh=this.getEles(Fd.tar,null,Fh))&&0<Fh.length&&this.sendEvents(Fh,"mouseout",Fb),this.removeTouchFromArr(Fb,this.preOvers),Fd.tar=null,FW.recover("TouchData",Fd)),this._clearTempArrs()}},Fq._oldArr=[],Fq._newArr=[],Fq._tEleArr=[],Fi(Fq,["I",function(){return this.I=new Fq}]),Fq}(),Ft=function(){function Fa(){this._action=null}Fr(Fa,"laya.filters.Filter");var Fb=Fa.prototype;return Fz.imps(Fb,{"laya.filters.IFilter":!0}),Fb.callNative=function(Fa){},Fm(0,Fb,"type",function(){return-1}),Fm(0,Fb,"action",function(){return this._action}),Fa.BLUR=16,Fa.COLOR=32,Fa.GLOW=8,Fa._filterStart=null,Fa._filterEnd=null,Fa._EndTarget=null,Fa._recycleScope=null,Fa._filter=null,Fa._useSrc=null,Fa._endSrc=null,Fa._useOut=null,Fa._endOut=null,Fa}(),Fv=function(){function Fa(){this.data=null}Fr(Fa,"laya.filters.ColorFilterAction");var Fb=Fa.prototype;return Fz.imps(Fb,{"laya.filters.IFilterAction":!0}),Fb.apply=function(Fa){var Fb=Fa.ctx.ctx,Fc=Fa.ctx.ctx.canvas;if(0==Fc.width||0==Fc.height)return Fc;for(var Fd,Fe=Fb.getImageData(0,0,Fc.width,Fc.height),Ff=Fe.data,Fg=0,Fh=Ff.length;Fg<Fh;Fg+=4)Fd=this.getColor(Ff[Fg],Ff[Fg+1],Ff[Fg+2],Ff[Fg+3]),0!=Ff[Fg+3]&&(Ff[Fg]=Fd[0],Ff[Fg+1]=Fd[1],Ff[Fg+2]=Fd[2],Ff[Fg+3]=Fd[3]);return Fb.putImageData(Fe,0,0),Fa},Fb.getColor=function(Fa,Fb,Fc,Fd){var Fe=[];if(this.data._mat&&this.data._alpha){var Ff=this.data._mat,Fg=this.data._alpha;Fe[0]=Ff[0]*Fa+Ff[1]*Fb+Ff[2]*Fc+Ff[3]*Fd+Fg[0],Fe[1]=Ff[4]*Fa+Ff[5]*Fb+Ff[6]*Fc+Ff[7]*Fd+Fg[1],Fe[2]=Ff[8]*Fa+Ff[9]*Fb+Ff[10]*Fc+Ff[11]*Fd+Fg[2],Fe[3]=Ff[12]*Fa+Ff[13]*Fb+Ff[14]*Fc+Ff[15]*Fd+Fg[3]}return Fe},Fa}(),Fw=(function(){function Fa(){}Fr(Fa,"laya.maths.Arith"),Fa.formatR=function(Fa){return Fa>Math.PI&&(Fa-=2*Math.PI),Fa<-Math.PI&&(Fa+=2*Math.PI),Fa},Fa.isPOT=function(Fa,Fb){return 0<Fa&&0==(Fa&Fa-1)&&0<Fb&&0==(Fb&Fb-1)},Fa.setMatToArray=function(Fa,Fb){Fa.a,Fa.b,Fa.c,Fa.d,Fa.tx,Fa.ty,Fb[0]=Fa.a,Fb[1]=Fa.b,Fb[4]=Fa.c,Fb[5]=Fa.d,Fb[12]=Fa.tx,Fb[13]=Fa.ty}}(),function(){function Fa(){this._controlPoints=[new FA,new FA,new FA],this._calFun=this.getPoint2}Fr(Fa,"laya.maths.Bezier");var Fb=Fa.prototype;return Fb._switchPoint=function(Fa,Fb){var Fc=this._controlPoints.shift();Fc.setTo(Fa,Fb),this._controlPoints.push(Fc)},Fb.getPoint2=function(Fa,Fb){var Fc=this._controlPoints[0],Fd=this._controlPoints[1],Fe=this._controlPoints[2],Ff=Math.pow(1-Fa,2)*Fc.x+2*Fa*(1-Fa)*Fd.x+Math.pow(Fa,2)*Fe.x,Fg=Math.pow(1-Fa,2)*Fc.y+2*Fa*(1-Fa)*Fd.y+Math.pow(Fa,2)*Fe.y;Fb.push(Ff,Fg)},Fb.getPoint3=function(Fa,Fb){var Fc=this._controlPoints[0],Fd=this._controlPoints[1],Fe=this._controlPoints[2],Ff=this._controlPoints[3],Fg=Math.pow(1-Fa,3)*Fc.x+3*Fd.x*Fa*(1-Fa)*(1-Fa)+3*Fe.x*Fa*Fa*(1-Fa)+Ff.x*Math.pow(Fa,3),Fh=Math.pow(1-Fa,3)*Fc.y+3*Fd.y*Fa*(1-Fa)*(1-Fa)+3*Fe.y*Fa*Fa*(1-Fa)+Ff.y*Math.pow(Fa,3);Fb.push(Fg,Fh)},Fb.insertPoints=function(Fa,Fb){var Fc,Fd=NaN;for(Fc=1/(Fa=0<Fa?Fa:5),Fd=0;Fd<=1;Fd+=Fc)this._calFun(Fd,Fb)},Fb.getBezierPoints=function(Fa,Fb,Fc){void 0===Fb&&(Fb=5),void 0===Fc&&(Fc=2);var Fd,Fe,Ff=0;if((Fd=Fa.length)<2*(Fc+1))return[];switch(Fe=[],Fc){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=Fc;)this._controlPoints.push(new FA);for(Ff=0;Ff<2*Fc;Ff+=2)this._switchPoint(Fa[Ff],Fa[Ff+1]);for(Ff=2*Fc;Ff<Fd;Ff+=2)this._switchPoint(Fa[Ff],Fa[Ff+1]),Ff/2%Fc==0&&this.insertPoints(Fb,Fe);return Fe},Fi(Fa,["I",function(){return this.I=new Fa}]),Fa}()),Fx=function(){function Fj(){}return Fr(Fj,"laya.maths.GrahamScan"),Fj.multiply=function(Fa,Fb,Fc){return(Fa.x-Fc.x)*(Fb.y-Fc.y)-(Fb.x-Fc.x)*(Fa.y-Fc.y)},Fj.dis=function(Fa,Fb){return(Fa.x-Fb.x)*(Fa.x-Fb.x)+(Fa.y-Fb.y)*(Fa.y-Fb.y)},Fj._getPoints=function(Fa,Fb,Fc){for(void 0===Fb&&(Fb=!1),Fj._mPointList||(Fj._mPointList=[]);Fj._mPointList.length<Fa;)Fj._mPointList.push(new FA);return Fc||(Fc=[]),Fc.length=0,Fb?Fj.getFrom(Fc,Fj._mPointList,Fa):Fj.getFromR(Fc,Fj._mPointList,Fa),Fc},Fj.getFrom=function(Fa,Fb,Fc){var Fd=0;for(Fd=0;Fd<Fc;Fd++)Fa.push(Fb[Fd]);return Fa},Fj.getFromR=function(Fa,Fb,Fc){var Fd=0;for(Fd=0;Fd<Fc;Fd++)Fa.push(Fb.pop());return Fa},Fj.pListToPointList=function(Fa,Fb){void 0===Fb&&(Fb=!1);var Fc=0,Fd=Fa.length/2,Fe=Fj._getPoints(Fd,Fb,Fj._tempPointList);for(Fc=0;Fc<Fd;Fc++)Fe[Fc].setTo(Fa[Fc+Fc],Fa[Fc+Fc+1]);return Fe},Fj.pointListToPlist=function(Fa){var Fb,Fc=0,Fd=Fa.length,Fe=Fj._temPList;for(Fc=Fe.length=0;Fc<Fd;Fc++)Fb=Fa[Fc],Fe.push(Fb.x,Fb.y);return Fe},Fj.scanPList=function(Fa){return F$.copyArray(Fa,Fj.pointListToPlist(Fj.scan(Fj.pListToPointList(Fa,!0))))},Fj.scan=function(Fa){var Fb,Fc,Fd,Fe=0,Ff=0,Fg=0,Fh=Fa.length,Fi={};for((Fc=Fj._temArr).length=0,Fe=(Fh=Fa.length)-1;0<=Fe;Fe--)Fd=(Fb=Fa[Fe]).x+"_"+Fb.y,Fi.hasOwnProperty(Fd)||(Fi[Fd]=!0,Fc.push(Fb));for(Fh=Fc.length,F$.copyArray(Fa,Fc),Fe=1;Fe<Fh;Fe++)(Fa[Fe].y<Fa[Fg].y||Fa[Fe].y==Fa[Fg].y&&Fa[Fe].x<Fa[Fg].x)&&(Fg=Fe);for(Fb=Fa[0],Fa[0]=Fa[Fg],Fa[Fg]=Fb,Fe=1;Fe<Fh-1;Fe++){for(Ff=(Fg=Fe)+1;Ff<Fh;Ff++)(0<Fj.multiply(Fa[Ff],Fa[Fg],Fa[0])||0==Fj.multiply(Fa[Ff],Fa[Fg],Fa[0])&&Fj.dis(Fa[0],Fa[Ff])<Fj.dis(Fa[0],Fa[Fg]))&&(Fg=Ff);Fb=Fa[Fe],Fa[Fe]=Fa[Fg],Fa[Fg]=Fb}if((Fc=Fj._temArr).length=0,Fa.length<3)return F$.copyArray(Fc,Fa);for(Fc.push(Fa[0],Fa[1],Fa[2]),Fe=3;Fe<Fh;Fe++){for(;2<=Fc.length&&0<=Fj.multiply(Fa[Fe],Fc[Fc.length-1],Fc[Fc.length-2]);)Fc.pop();Fa[Fe]&&Fc.push(Fa[Fe])}return Fc},Fj._mPointList=null,Fj._tempPointList=[],Fj._temPList=[],Fj._temArr=[],Fj}(),Fy=function(){function Fe(){}return Fr(Fe,"laya.maths.MathUtil"),Fe.subtractVector3=function(Fa,Fb,Fc){Fc[0]=Fa[0]-Fb[0],Fc[1]=Fa[1]-Fb[1],Fc[2]=Fa[2]-Fb[2]},Fe.lerp=function(Fa,Fb,Fc){return Fa*(1-Fc)+Fb*Fc},Fe.scaleVector3=function(Fa,Fb,Fc){Fc[0]=Fa[0]*Fb,Fc[1]=Fa[1]*Fb,Fc[2]=Fa[2]*Fb},Fe.lerpVector3=function(Fa,Fb,Fc,Fd){var Fe=Fa[0],Ff=Fa[1],Fg=Fa[2];Fd[0]=Fe+Fc*(Fb[0]-Fe),Fd[1]=Ff+Fc*(Fb[1]-Ff),Fd[2]=Fg+Fc*(Fb[2]-Fg)},Fe.lerpVector4=function(Fa,Fb,Fc,Fd){var Fe=Fa[0],Ff=Fa[1],Fg=Fa[2],Fh=Fa[3];Fd[0]=Fe+Fc*(Fb[0]-Fe),Fd[1]=Ff+Fc*(Fb[1]-Ff),Fd[2]=Fg+Fc*(Fb[2]-Fg),Fd[3]=Fh+Fc*(Fb[3]-Fh)},Fe.slerpQuaternionArray=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){var Fh,Fi,Fj,Fm,Fn,Fo=Fa[Fb+0],Fp=Fa[Fb+1],Fq=Fa[Fb+2],Fr=Fa[Fb+3],Fs=Fc[Fd+0],Ft=Fc[Fd+1],Fu=Fc[Fd+2],Fv=Fc[Fd+3];return(Fi=Fo*Fs+Fp*Ft+Fq*Fu+Fr*Fv)<0&&(Fi=-Fi,Fs=-Fs,Ft=-Ft,Fu=-Fu,Fv=-Fv),Fn=1e-6<1-Fi?(Fh=Math.acos(Fi),Fj=Math.sin(Fh),Fm=Math.sin((1-Fe)*Fh)/Fj,Math.sin(Fe*Fh)/Fj):(Fm=1-Fe,Fe),Ff[Fg+0]=Fm*Fo+Fn*Fs,Ff[Fg+1]=Fm*Fp+Fn*Ft,Ff[Fg+2]=Fm*Fq+Fn*Fu,Ff[Fg+3]=Fm*Fr+Fn*Fv,Ff},Fe.getRotation=function(Fa,Fb,Fc,Fd){return Math.atan2(Fd-Fb,Fc-Fa)/Math.PI*180},Fe.sortBigFirst=function(Fa,Fb){return Fa==Fb?0:Fa<Fb?1:-1},Fe.sortSmallFirst=function(Fa,Fb){return Fa==Fb?0:Fa<Fb?-1:1},Fe.sortNumBigFirst=function(Fa,Fb){return parseFloat(Fb)-parseFloat(Fa)},Fe.sortNumSmallFirst=function(Fa,Fb){return parseFloat(Fa)-parseFloat(Fb)},Fe.sortByKey=function(Fc,Fa,Fb){var Fd;return void 0===Fa&&(Fa=!1),void 0===Fb&&(Fb=!0),Fd=Fa?Fb?Fe.sortNumBigFirst:Fe.sortBigFirst:Fb?Fe.sortNumSmallFirst:Fe.sortSmallFirst,function(Fa,Fb){return Fd(Fa[Fc],Fb[Fc])}},Fe}(),FG=function(){function Fc(Fa,Fb,Fc,Fd,Fe,Ff){this.inPool=!1,this.bTransform=!1,void 0===Fa&&(Fa=1),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=1),void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=0),this.a=Fa,this.b=Fb,this.c=Fc,this.d=Fd,this.tx=Fe,this.ty=Ff,this._checkTransform()}Fr(Fc,"laya.maths.Matrix");var Fa=Fc.prototype;return Fa.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},Fa._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},Fa.setTranslate=function(Fa,Fb){return this.tx=Fa,this.ty=Fb,this},Fa.translate=function(Fa,Fb){return this.tx+=Fa,this.ty+=Fb,this},Fa.scale=function(Fa,Fb){this.a*=Fa,this.d*=Fb,this.c*=Fa,this.b*=Fb,this.tx*=Fa,this.ty*=Fb,this.bTransform=!0},Fa.rotate=function(Fa){var Fb=Math.cos(Fa),Fc=Math.sin(Fa),Fd=this.a,Fe=this.c,Ff=this.tx;this.a=Fd*Fb-this.b*Fc,this.b=Fd*Fc+this.b*Fb,this.c=Fe*Fb-this.d*Fc,this.d=Fe*Fc+this.d*Fb,this.tx=Ff*Fb-this.ty*Fc,this.ty=Ff*Fc+this.ty*Fb,this.bTransform=!0},Fa.skew=function(Fa,Fb){var Fc=Math.tan(Fa),Fd=Math.tan(Fb),Fe=this.a,Ff=this.b;return this.a+=Fd*this.c,this.b+=Fd*this.d,this.c+=Fc*Fe,this.d+=Fc*Ff,this},Fa.invertTransformPoint=function(Fa){var Fb=this.a,Fc=this.b,Fd=this.c,Fe=this.d,Ff=this.tx,Fg=Fb*Fe-Fc*Fd,Fh=Fe/Fg,Fi=-Fc/Fg,Fj=-Fd/Fg,Fm=Fb/Fg,Fn=(Fd*this.ty-Fe*Ff)/Fg,Fo=-(Fb*this.ty-Fc*Ff)/Fg;return Fa.setTo(Fh*Fa.x+Fj*Fa.y+Fn,Fi*Fa.x+Fm*Fa.y+Fo)},Fa.transformPoint=function(Fa){return Fa.setTo(this.a*Fa.x+this.c*Fa.y+this.tx,this.b*Fa.x+this.d*Fa.y+this.ty)},Fa.transformPointN=function(Fa){return Fa.setTo(this.a*Fa.x+this.c*Fa.y,this.b*Fa.x+this.d*Fa.y)},Fa.transformPointArray=function(Fa,Fb){for(var Fc=Fa.length,Fd=0;Fd<Fc;Fd+=2){var Fe=Fa[Fd],Ff=Fa[Fd+1];Fb[Fd]=this.a*Fe+this.c*Ff+this.tx,Fb[Fd+1]=this.b*Fe+this.d*Ff+this.ty}return Fb},Fa.transformPointArrayScale=function(Fa,Fb){for(var Fc=Fa.length,Fd=0;Fd<Fc;Fd+=2){var Fe=Fa[Fd],Ff=Fa[Fd+1];Fb[Fd]=this.a*Fe+this.c*Ff,Fb[Fd+1]=this.b*Fe+this.d*Ff}return Fb},Fa.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},Fa.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},Fa.invert=function(){var Fa=this.a,Fb=this.b,Fc=this.c,Fd=this.d,Fe=this.tx,Ff=Fa*Fd-Fb*Fc;return this.a=Fd/Ff,this.b=-Fb/Ff,this.c=-Fc/Ff,this.d=Fa/Ff,this.tx=(Fc*this.ty-Fd*Fe)/Ff,this.ty=-(Fa*this.ty-Fb*Fe)/Ff,this},Fa.setTo=function(Fa,Fb,Fc,Fd,Fe,Ff){return this.a=Fa,this.b=Fb,this.c=Fc,this.d=Fd,this.tx=Fe,this.ty=Ff,this},Fa.concat=function(Fa){var Fb=this.a,Fc=this.c,Fd=this.tx;return this.a=Fb*Fa.a+this.b*Fa.c,this.b=Fb*Fa.b+this.b*Fa.d,this.c=Fc*Fa.a+this.d*Fa.c,this.d=Fc*Fa.b+this.d*Fa.d,this.tx=Fd*Fa.a+this.ty*Fa.c+Fa.tx,this.ty=Fd*Fa.b+this.ty*Fa.d+Fa.ty,this},Fa.scaleEx=function(Fa,Fb){var Fc=this.a,Fd=this.b,Fe=this.c,Ff=this.d;0!==Fd||0!==Fe?(this.a=Fa*Fc,this.b=Fa*Fd,this.c=Fb*Fe):(this.a=Fa*Fc,this.b=0*Ff,this.c=0*Fc),this.d=Fb*Ff,this.bTransform=!0},Fa.rotateEx=function(Fa){var Fb=Math.cos(Fa),Fc=Math.sin(Fa),Fd=this.a,Fe=this.b,Ff=this.c,Fg=this.d;0!==Fe||0!==Ff?(this.a=Fb*Fd+Fc*Ff,this.b=Fb*Fe+Fc*Fg,this.c=-Fc*Fd+Fb*Ff,this.d=-Fc*Fe+Fb*Fg):(this.a=Fb*Fd,this.b=Fc*Fg,this.c=-Fc*Fd,this.d=Fb*Fg),this.bTransform=!0},Fa.clone=function(){var Fa=Fc.create();return Fa.a=this.a,Fa.b=this.b,Fa.c=this.c,Fa.d=this.d,Fa.tx=this.tx,Fa.ty=this.ty,Fa.bTransform=this.bTransform,Fa},Fa.copyTo=function(Fa){return Fa.a=this.a,Fa.b=this.b,Fa.c=this.c,Fa.d=this.d,Fa.tx=this.tx,Fa.ty=this.ty,Fa.bTransform=this.bTransform,Fa},Fa.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},Fa.destroy=function(){if(!this.inPool){var Fa=Fc._cache;this.inPool=!0,Fa._length||(Fa._length=0),(Fa[Fa._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},Fc.mul=function(Fa,Fb,Fc){var Fd=Fa.a,Fe=Fa.b,Ff=Fa.c,Fg=Fa.d,Fh=Fa.tx,Fi=Fa.ty,Fj=Fb.a,Fm=Fb.b,Fn=Fb.c,Fo=Fb.d,Fp=Fb.tx,Fq=Fb.ty;return 0!==Fm||0!==Fn?(Fc.a=Fd*Fj+Fe*Fn,Fc.b=Fd*Fm+Fe*Fo,Fc.c=Ff*Fj+Fg*Fn,Fc.d=Ff*Fm+Fg*Fo,Fc.tx=Fj*Fh+Fn*Fi+Fp,Fc.ty=Fm*Fh+Fo*Fi+Fq):(Fc.a=Fd*Fj,Fc.b=Fe*Fo,Fc.c=Ff*Fj,Fc.d=Fg*Fo,Fc.tx=Fj*Fh+Fp,Fc.ty=Fo*Fi+Fq),Fc},Fc.mul16=function(Fa,Fb,Fc){var Fd=Fa.a,Fe=Fa.b,Ff=Fa.c,Fg=Fa.d,Fh=Fa.tx,Fi=Fa.ty,Fj=Fb.a,Fm=Fb.b,Fn=Fb.c,Fo=Fb.d,Fp=Fb.tx,Fq=Fb.ty;return 0!==Fm||0!==Fn?(Fc[0]=Fd*Fj+Fe*Fn,Fc[1]=Fd*Fm+Fe*Fo,Fc[4]=Ff*Fj+Fg*Fn,Fc[5]=Ff*Fm+Fg*Fo,Fc[12]=Fj*Fh+Fn*Fi+Fp,Fc[13]=Fm*Fh+Fo*Fi+Fq):(Fc[0]=Fd*Fj,Fc[1]=Fe*Fo,Fc[4]=Ff*Fj,Fc[5]=Fg*Fo,Fc[12]=Fj*Fh+Fp,Fc[13]=Fo*Fi+Fq),Fc},Fc.mulPre=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){var Fi=Fa.a,Fj=Fa.b,Fm=Fa.c,Fn=Fa.d,Fo=Fa.tx,Fp=Fa.ty;return 0!==Fc||0!==Fd?(Fh.a=Fi*Fb+Fj*Fd,Fh.b=Fi*Fc+Fj*Fe,Fh.c=Fm*Fb+Fn*Fd,Fh.d=Fm*Fc+Fn*Fe,Fh.tx=Fb*Fo+Fd*Fp+Ff,Fh.ty=Fc*Fo+Fe*Fp+Fg):(Fh.a=Fi*Fb,Fh.b=Fj*Fe,Fh.c=Fm*Fb,Fh.d=Fn*Fe,Fh.tx=Fb*Fo+Ff,Fh.ty=Fe*Fp+Fg),Fh},Fc.mulPos=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){var Fi=Fa.a,Fj=Fa.b,Fm=Fa.c,Fn=Fa.d,Fo=Fa.tx,Fp=Fa.ty;return 0!==Fj||0!==Fm?(Fh.a=Fb*Fi+Fc*Fm,Fh.b=Fb*Fj+Fc*Fn,Fh.c=Fd*Fi+Fe*Fm,Fh.d=Fd*Fj+Fe*Fn,Fh.tx=Fi*Ff+Fm*Fg+Fo,Fh.ty=Fj*Ff+Fn*Fg+Fp):(Fh.a=Fb*Fi,Fh.b=Fc*Fn,Fh.c=Fd*Fi,Fh.d=Fe*Fn,Fh.tx=Fi*Ff+Fo,Fh.ty=Fn*Fg+Fp),Fh},Fc.preMul=function(Fa,Fb,Fc){var Fd=Fa.a,Fe=Fa.b,Ff=Fa.c,Fg=Fa.d,Fh=Fb.a,Fi=Fb.b,Fj=Fb.c,Fm=Fb.d,Fn=Fb.tx,Fo=Fb.ty;return Fc.a=Fh*Fd,Fc.b=Fc.c=0,Fc.d=Fm*Fg,Fc.tx=Fn*Fd+Fa.tx,Fc.ty=Fo*Fg+Fa.ty,0===Fi&&0===Fj&&0===Fe&&0===Ff||(Fc.a+=Fi*Ff,Fc.d+=Fj*Fe,Fc.b+=Fh*Fe+Fi*Fg,Fc.c+=Fj*Fd+Fm*Ff,Fc.tx+=Fo*Ff,Fc.ty+=Fn*Fe),Fc},Fc.preMulXY=function(Fa,Fb,Fc,Fd){var Fe=Fa.a,Ff=Fa.b,Fg=Fa.c,Fh=Fa.d;return Fd.a=Fe,Fd.b=Ff,Fd.c=Fg,Fd.d=Fh,Fd.tx=Fb*Fe+Fa.tx+Fc*Fg,Fd.ty=Fc*Fh+Fa.ty+Fb*Ff,Fd},Fc.create=function(){var Fa=Fc._cache,Fb=Fa._length?Fa[--Fa._length]:new Fc;return Fb.inPool=!1,Fb},Fc.EMPTY=new Fc,Fc.TEMP=new Fc,Fc._cache=[],Fc}(),FA=function(){function Fa(Fa,Fb){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),this.x=Fa,this.y=Fb}Fr(Fa,"laya.maths.Point");var Fb=Fa.prototype;return Fb.setTo=function(Fa,Fb){return this.x=Fa,this.y=Fb,this},Fb.distance=function(Fa,Fb){return Math.sqrt((this.x-Fa)*(this.x-Fa)+(this.y-Fb)*(this.y-Fb))},Fb.toString=function(){return this.x+","+this.y},Fb.normalize=function(){var Fa=Math.sqrt(this.x*this.x+this.y*this.y);if(0<Fa){var Fb=1/Fa;this.x*=Fb,this.y*=Fb}},Fa.TEMP=new Fa,Fa.EMPTY=new Fa,Fa}(),FB=function(){function Fj(Fa,Fb,Fc,Fd){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0),this.x=Fa,this.y=Fb,this.width=Fc,this.height=Fd}Fr(Fj,"laya.maths.Rectangle");var Fa=Fj.prototype;return Fa.setTo=function(Fa,Fb,Fc,Fd){return this.x=Fa,this.y=Fb,this.width=Fc,this.height=Fd,this},Fa.copyFrom=function(Fa){return this.x=Fa.x,this.y=Fa.y,this.width=Fa.width,this.height=Fa.height,this},Fa.contains=function(Fa,Fb){return!(this.width<=0||this.height<=0)&&(Fa>=this.x&&Fa<this.right&&Fb>=this.y&&Fb<this.bottom)},Fa.intersects=function(Fa){return!(Fa.x>this.x+this.width||Fa.x+Fa.width<this.x||Fa.y>this.y+this.height||Fa.y+Fa.height<this.y)},Fa.intersection=function(Fa,Fb){return this.intersects(Fa)?(Fb||(Fb=new Fj),Fb.x=Math.max(this.x,Fa.x),Fb.y=Math.max(this.y,Fa.y),Fb.width=Math.min(this.right,Fa.right)-Fb.x,Fb.height=Math.min(this.bottom,Fa.bottom)-Fb.y,Fb):null},Fa.union=function(Fa,Fb){return Fb||(Fb=new Fj),this.clone(Fb),Fa.width<=0||Fa.height<=0?Fb:(Fb.addPoint(Fa.x,Fa.y),Fb.addPoint(Fa.right,Fa.bottom),this)},Fa.clone=function(Fa){return Fa||(Fa=new Fj),Fa.x=this.x,Fa.y=this.y,Fa.width=this.width,Fa.height=this.height,Fa},Fa.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},Fa.equals=function(Fa){return!(!Fa||Fa.x!==this.x||Fa.y!==this.y||Fa.width!==this.width||Fa.height!==this.height)},Fa.addPoint=function(Fa,Fb){return this.x>Fa&&(this.width+=this.x-Fa,this.x=Fa),this.y>Fb&&(this.height+=this.y-Fb,this.y=Fb),this.width<Fa-this.x&&(this.width=Fa-this.x),this.height<Fb-this.y&&(this.height=Fb-this.y),this},Fa._getBoundPoints=function(){var Fa=Fj._temB;return(Fa.length=0)==this.width||0==this.height||Fa.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),Fa},Fa.isEmpty=function(){return this.width<=0||this.height<=0},Fm(0,Fa,"right",function(){return this.x+this.width}),Fm(0,Fa,"bottom",function(){return this.y+this.height}),Fj._getBoundPointS=function(Fa,Fb,Fc,Fd){var Fe=Fj._temA;return(Fe.length=0)==Fc||0==Fd||Fe.push(Fa,Fb,Fa+Fc,Fb,Fa,Fb+Fd,Fa+Fc,Fb+Fd),Fe},Fj._getWrapRec=function(Fa,Fb){if(!Fa||Fa.length<1)return Fb?Fb.setTo(0,0,0,0):Fj.TEMP.setTo(0,0,0,0);Fb=Fb||new Fj;var Fc,Fd,Fe,Ff,Fg,Fh=Fa.length,Fi=FA.TEMP;for(Fe=Fg=-(Fd=Ff=99999),Fc=0;Fc<Fh;Fc+=2)Fi.x=Fa[Fc],Fi.y=Fa[Fc+1],Fd=Fd<Fi.x?Fd:Fi.x,Ff=Ff<Fi.y?Ff:Fi.y,Fe=Fe>Fi.x?Fe:Fi.x,Fg=Fg>Fi.y?Fg:Fi.y;return Fb.setTo(Fd,Ff,Fe-Fd,Fg-Ff)},Fj.EMPTY=new Fj,Fj.TEMP=new Fj,Fj._temB=[],Fj._temA=[],Fj}(),FE=function(){function Fi(){}return Fr(Fi,"laya.media.SoundManager"),Fm(1,Fi,"useAudioMusic",function(){return Fi._useAudioMusic},function(Fa){Fi._useAudioMusic=Fa,Fi._musicClass=Fa?Fca:null}),Fm(1,Fi,"autoStopMusic",function(){return Fi._autoStopMusic},function(Fa){Fz.stage.off("blur",null,Fi._stageOnBlur),Fz.stage.off("focus",null,Fi._stageOnFocus),Fz.stage.off("visibilitychange",null,Fi._visibilityChange),(Fi._autoStopMusic=Fa)&&(Fz.stage.on("blur",null,Fi._stageOnBlur),Fz.stage.on("focus",null,Fi._stageOnFocus),Fz.stage.on("visibilitychange",null,Fi._visibilityChange))}),Fm(1,Fi,"muted",function(){return Fi._muted},function(Fa){Fa!=Fi._muted&&(Fa&&Fi.stopAllSound(),Fi.musicMuted=Fa,Fi._muted=Fa)}),Fm(1,Fi,"musicMuted",function(){return Fi._musicMuted},function(Fa){Fa!=Fi._musicMuted&&(Fa?(Fi._tMusic&&Fi._musicChannel&&!Fi._musicChannel.isStopped?Fi._musicChannel.pause():Fi._musicChannel=null,Fi._musicMuted=Fa):(Fi._musicMuted=Fa,Fi._tMusic&&Fi._musicChannel&&Fi._musicChannel.resume()))}),Fm(1,Fi,"soundMuted",function(){return Fi._soundMuted},function(Fa){Fi._soundMuted=Fa}),Fi.addChannel=function(Fa){0<=Fi._channels.indexOf(Fa)||(Fi._channels.push(Fa),Fi.autoReleaseSound&&0!=Fi._notUsedCount&&Fi._notUsedUrls[Fa.url]&&(delete Fi._notUsedUrls[Fa.url],0==--Fi._notUsedCount&&Fz.timer.clear(Fi,Fi.disposeSoundIfNotUsed)))},Fi.removeChannel=function(Fa){var Fb=Fi._channels,Fc=Fb.indexOf(Fa);if(-1!=Fc&&(Fb.splice(Fc,1),Fi.autoReleaseSound)){var Fd=Fa.url,Fe=Fi.defaultIntervals[Fd]||2e4;if(0<Fe){var Ff=!0;for(Fc=Fb.length-1;0<=Fc;Fc--)if(Fb[Fc].url==Fd){Ff=!1;break}Ff&&(Fi._notUsedUrls[Fd]=Date.now()+Fe,0==Fi._notUsedCount++&&Fz.timer.loop(1e4,Fi,Fi.disposeSoundIfNotUsed))}}},Fi.disposeSoundIfNotUsed=function(){var Fa=Fi._notUsedUrls;if(0!=Fi._notUsedCount){var Fb=Date.now();for(var Fc in Fa)Fb>=Fa[Fc]&&(delete Fa[Fc],--Fi._notUsedCount,Fi.destroySound(Fc));if(0!=Fi._notUsedCount)return}Fz.timer.clear(Fi,Fi.disposeSoundIfNotUsed)},Fi._visibilityChange=function(){Fz.stage.isVisibility?Fi._stageOnFocus():Fi._stageOnBlur()},Fi._stageOnBlur=function(){Fi._isActive=!1,Fi._musicChannel&&(Fi._musicChannel.isStopped||(Fi._blurPaused=!0,Fi._musicChannel.pause())),Fi.stopAllSound(),Fz.stage.once("mousedown",null,Fi._stageOnFocus)},Fi._recoverWebAudio=function(){Ffa.ctx&&"running"!=Ffa.ctx.state&&Ffa.ctx.resume&&Ffa.ctx.resume()},Fi._stageOnFocus=function(){if(Fi._isActive=!0,Fi._recoverWebAudio(),Fz.stage.off("mousedown",null,Fi._stageOnFocus),Fi._blurPaused){var Fa=Fi._musicChannel;Fa&&Fi._music&&Fa.isStopped&&(Fi._blurPaused=!1,Fi._music._disposed?Fi.playMusic(Fa.url,Fa.loops,Fa.startHandler,Fa.completeHandler,Fa.startTime):Fa.audioBuffer?Fa.resume():Fi._music.play(Fa.startTime,Fa.loops,Fa.startHandler,Fa))}},Fi.playSound=function(Fa,Fb,Fc,Fd,Fe,Ff){if(void 0===Fb&&(Fb=1),void 0===Ff&&(Ff=0),!Fa)return null;if(Fi._muted)return null;if(Fi._recoverWebAudio(),Fa==Fi._tMusic){if(Fi._musicMuted)return null}else{if(!Fi._isActive)return null;if(Fi._soundMuted)return null}var Fg,Fh=Fi._pool[Fa];return Fe||(Fe=Fi._soundClass),Fh||((Fh=new Fe).load(Fa),Fi._pool[Fa]=Fh),(Fg=Fh.play(Ff,Fb,Fc))?(Fa==Fi._tMusic&&(Fi._music=Fh,Fi._isActive||(Fi._blurPaused=!0,Fg.pause())),Fg.url=Fa,Fg.volume=Fa==Fi._tMusic?Fi.musicVolume:Fi.soundVolume,Fg.completeHandler=Fd,Fg):null},Fi.destroySound=function(Fa){var Fb=Fi._pool[Fa];Fb&&(delete Fi._pool[Fa],Fb.dispose())},Fi.playMusic=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fb&&(Fb=0),void 0===Fe&&(Fe=0),Fi._tMusic=Fa,Fi._musicChannel&&Fi._musicChannel.stop(),Fi._musicChannel=Fi.playSound(Fa,Fb,Fc,Fd,null,Fe)},Fi.stopSound=function(Fa){for(var Fb,Fc=Fi._channels.length-1;0<=Fc;Fc--)(Fb=Fi._channels[Fc]).url==Fa&&Fb.stop()},Fi.stopAll=function(){Fi._tMusic=null;var Fa=0;for(Fa=Fi._channels.length-1;0<=Fa;Fa--)Fi._channels[Fa].stop()},Fi.stopAllSound=function(){var Fa,Fb=0;for(Fb=Fi._channels.length-1;0<=Fb;Fb--)(Fa=Fi._channels[Fb]).url!=Fi._tMusic&&Fa.stop()},Fi.stopMusic=function(){Fi._musicChannel&&Fi._musicChannel.stop(),Fi._tMusic=null},Fi.setSoundVolume=function(Fa,Fb){if(Fb)Fi._setVolume(Fb,Fa);else{Fi.soundVolume=Fa;var Fc,Fd=0;for(Fd=Fi._channels.length-1;0<=Fd;Fd--)(Fc=Fi._channels[Fd]).url!=Fi._tMusic&&(Fc.volume=Fa)}},Fi.setMusicVolume=function(Fa){Fi.musicVolume=Fa,Fi._setVolume(Fi._tMusic,Fa)},Fi._setVolume=function(Fa,Fb){for(var Fc,Fd=Fi._channels.length-1;0<=Fd;Fd--)(Fc=Fi._channels[Fd]).url==Fa&&(Fc.volume=Fb)},Fi.musicVolume=1,Fi.soundVolume=1,Fi.playbackRate=1,Fi._useAudioMusic=!0,Fi._muted=!1,Fi._soundMuted=!1,Fi._musicMuted=!1,Fi._tMusic=null,Fi._musicChannel=null,Fi._music=null,Fi._channels=[],Fi._autoStopMusic=!1,Fi._blurPaused=!1,Fi._isActive=!0,Fi._soundClass=null,Fi._musicClass=null,Fi.autoReleaseSound=!0,Fi._pool={},Fi.defaultIntervals={},Fi._notUsedUrls={},Fi._notUsedCount=0,Fi}(),FC=function(){var Fa;function Fc(){}return Fr(Fc,"laya.net.LocalStorage"),Fc.__init__=function(){Fc._baseClass||(Fc._baseClass=Fa).init(),Fc.items=Fc._baseClass.items,Fc.support=Fc._baseClass.support},Fc.setItem=function(Fa,Fb){Fc._baseClass.setItem(Fa,Fb)},Fc.getItem=function(Fa){return Fc._baseClass.getItem(Fa)},Fc.setJSON=function(Fa,Fb){Fc._baseClass.setJSON(Fa,Fb)},Fc.getJSON=function(Fa){return Fc._baseClass.getJSON(Fa)},Fc.removeItem=function(Fa){Fc._baseClass.removeItem(Fa)},Fc.clear=function(){Fc._baseClass.clear()},Fc._baseClass=null,Fc.items=null,Fc.support=!1,Fc.__init$=function(){Fa=function(){function Fc(){}return Fr(Fc,""),Fc.init=function(){try{Fc.support=!0,Fc.items=Fg.localStorage,Fc.setItem("laya","1"),Fc.removeItem("laya")}catch(Fa){Fc.support=!1}Fc.support||console.log("LocalStorage is not supprot or browser is private mode.")},Fc.setItem=function(Fa,Fb){try{Fc.support&&Fc.items.setItem(Fa,Fb)}catch(Fa){console.warn("set localStorage failed",Fa)}},Fc.getItem=function(Fa){return Fc.support?Fc.items.getItem(Fa):null},Fc.setJSON=function(Fa,Fb){try{Fc.support&&Fc.items.setItem(Fa,JSON.stringify(Fb))}catch(Fa){console.warn("set localStorage failed",Fa)}},Fc.getJSON=function(Fa){return JSON.parse(Fc.support?Fc.items.getItem(Fa):null)},Fc.removeItem=function(Fa){Fc.support&&Fc.items.removeItem(Fa)},Fc.clear=function(){Fc.support&&Fc.items.clear()},Fc.items=null,Fc.support=!1,Fc}()},Fc}(),FH=(function(){function Fd(){}Fr(Fd,"laya.net.ResourceVersion"),Fd.enable=function(Fa,Fb,Fc){void 0===Fc&&(Fc=2),laya.net.ResourceVersion.type=Fc,Fz.loader.load(Fa,Fu.create(null,Fd.onManifestLoaded,[Fb]),null,"json"),FI.customFormat=Fd.addVersionPrefix},Fd.onManifestLoaded=function(Fa,Fb){Fd.manifest=Fb,Fa.run(),Fb||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},Fd.addVersionPrefix=function(Fa){return Fd.manifest&&Fd.manifest[Fa]?2==Fd.type?Fd.manifest[Fa]:Fd.manifest[Fa]+"/"+Fa:Fa},Fd.FOLDER_VERSION=1,Fd.FILENAME_VERSION=2,Fd.manifest=null,Fd.type=1}(),function(){function Fa(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}Fr(Fa,"laya.net.TTFLoader");var Fb=Fa.prototype;return Fb.load=function(Fa){var Fb=(this._url=Fa).split(".ttf")[0].split("/");this.fontName=Fb[Fb.length-1],FO.window.conch?this._loadConch():FO.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},Fb._loadConch=function(){this._http=new Fga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},Fb._onHttpLoaded=function(Fa){FO.window.conch.setFontFaceFromBuffer(this.fontName,Fa),this._clearHttp(),this._complete()},Fb._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},Fb._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},Fb._complete=function(){Fz.timer.clear(this,this._complete),Fz.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},Fb._checkComplete=function(){FF.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},Fb._loadWithFontFace=function(){var Fa=new FO.window.FontFace(this.fontName,"url('"+this._url+"')");FO.window.document.fonts.add(Fa);var Fb=this;Fa.loaded.then(function(){Fb._complete()}),Fa.load()},Fb._createDiv=function(){this._div=FO.createElement("div"),this._div.innerHTML="laya";var Fa=this._div.style;Fa.fontFamily=this.fontName,Fa.position="absolute",Fa.left="-100px",Fa.top="-100px",FO.document.body.appendChild(this._div)},Fb._loadWithCSS=function(){var Fa=this,Fb=FO.createElement("style");Fb.type="text/css",FO.document.body.appendChild(Fb),Fb.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=FF.measureText("LayaTTFFont",this._fontTxt).width;var Fc=this;Fb.onload=function(){Fz.timer.once(1e4,Fc,Fa._complete)},Fz.timer.loop(20,this,this._checkComplete),this._createDiv()},Fa._testString="LayaTTFFont",Fa}()),FI=function(){function Fd(Fa){this._url=null,this._path=null,this._url=Fd.formatURL(Fa),this._path=Fd.getPath(Fa)}Fr(Fd,"laya.net.URL");var Fa=Fd.prototype;return Fm(0,Fa,"path",function(){return this._path}),Fm(0,Fa,"url",function(){return this._url}),Fd.formatURL=function(Fa,Fb){if(!Fa)return"null path";if(0<Fa.indexOf(":"))return Fa;null!=Fd.customFormat&&(Fa=Fd.customFormat(Fa,Fb));var Fc=Fa.charAt(0);if("."===Fc)return Fd.formatRelativePath((Fb||Fd.basePath)+Fa);if("~"===Fc)return Fd.rootPath+Fa.substring(1);if("d"===Fc){if(0===Fa.indexOf("data:image"))return Fa}else if("/"===Fc)return Fa;return(Fb||Fd.basePath)+Fa},Fd.formatRelativePath=function(Fa){for(var Fb=Fa.split("/"),Fc=0,Fd=Fb.length;Fc<Fd;Fc++)".."==Fb[Fc]&&(Fb.splice(Fc-1,2),Fc-=2);return Fb.join("/")},Fd.isAbsolute=function(Fa){return 0<Fa.indexOf(":")||"/"==Fa.charAt(0)},Fd.getPath=function(Fa){var Fb=Fa.lastIndexOf("/");return 0<Fb?Fa.substr(0,Fb+1):""},Fd.getFileName=function(Fa){var Fb=Fa.lastIndexOf("/");return 0<Fb?Fa.substr(Fb+1):Fa},Fd.version={},Fd.basePath="",Fd.rootPath="",Fd.customFormat=function(Fa){var Fb=Fd.version[Fa];return!FJ.isConchApp&&Fb&&(Fa+="?v="+Fb),Fa},Fd}(),FJ=function(){function Fe(Fa,Fb){this._timeId=0;var Fc=Fe._mainCanvas.source.style;Fc.position="absolute",Fc.top=Fc.left="0px",Fc.background="#000000",Fe._mainCanvas.source.id="layaCanvas";var Fd=laya.renders.Render.isWebGL;Fe._mainCanvas.source.width=Fa,Fe._mainCanvas.source.height=Fb,Fd&&Fe.WebGL.init(Fe._mainCanvas,Fa,Fb),FO.container.appendChild(Fe._mainCanvas.source),(Fe._context=new FK(Fa,Fb,Fd?null:Fe._mainCanvas)).ctx.setIsMainContext(),FO.window.requestAnimationFrame(function Fa(Fb){FO.window.requestAnimationFrame(Fa);Fz.stage._loop()}),Fz.stage.on("visibilitychange",this,this._onVisibilitychange)}Fr(Fe,"laya.renders.Render");var Fa=Fe.prototype;return Fa._onVisibilitychange=function(){Fz.stage.isVisibility?0!=this._timeId&&FO.window.clearInterval(this._timeId):this._timeId=FO.window.setInterval(this._enterFrame,1e3)},Fa._enterFrame=function(Fa){Fz.stage._loop()},Fm(1,Fe,"context",function(){return Fe._context}),Fm(1,Fe,"canvas",function(){return Fe._mainCanvas.source}),Fe._context=null,Fe._mainCanvas=null,Fe.WebGL=null,Fe.isConchNode=!1,Fe.isConchApp=!1,Fe.isConchWebGL=!1,Fe.isWebGL=!1,Fe.is3DMode=!1,Fe.optimizeTextureMemory=function(Fa,Fb){return!0},Fe.__init$=function(){Fg.ConchRenderType=Fg.ConchRenderType||1,Fg.ConchRenderType|=Fg.conch?4:0,Fe.isConchNode=5==(5&Fg.ConchRenderType),Fe.isConchApp=4==(4&Fg.ConchRenderType),Fe.isConchWebGL=6==Fg.ConchRenderType},Fe}(),FK=function(){function Fg(Fa,Fb,Fc){this.x=0,this.y=0,this._drawTexture=function(Fa,Fb,Fc){Fc[0].loaded&&this.ctx.drawTexture(Fc[0],Fc[1],Fc[2],Fc[3],Fc[4],Fa,Fb)},this._fillTexture=function(Fa,Fb,Fc){Fc[0].loaded&&this.ctx.fillTexture(Fc[0],Fc[1]+Fa,Fc[2]+Fb,Fc[3],Fc[4],Fc[5],Fc[6],Fc[7])},this._drawTextureWithTransform=function(Fa,Fb,Fc){Fc[0].loaded&&this.ctx.drawTextureWithTransform(Fc[0],Fc[1],Fc[2],Fc[3],Fc[4],Fc[5],Fa,Fb,Fc[6])},this._fillQuadrangle=function(Fa,Fb,Fc){this.ctx.fillQuadrangle(Fc[0],Fc[1],Fc[2],Fc[3],Fc[4])},this._drawRect=function(Fa,Fb,Fc){var Fd=this.ctx;null!=Fc[4]&&(Fd.fillStyle=Fc[4],Fd.fillRect(Fa+Fc[0],Fb+Fc[1],Fc[2],Fc[3],null)),null!=Fc[5]&&(Fd.strokeStyle=Fc[5],Fd.lineWidth=Fc[6],Fd.strokeRect(Fa+Fc[0],Fb+Fc[1],Fc[2],Fc[3],Fc[6]))},this._drawPie=function(Fa,Fb,Fc){var Fd=this.ctx;FJ.isWebGL&&Fd.setPathId(Fc[8]),Fd.beginPath(),FJ.isWebGL?(Fd.movePath(Fc[0]+Fa,Fc[1]+Fb),Fd.moveTo(0,0)):Fd.moveTo(Fa+Fc[0],Fb+Fc[1]),Fd.arc(Fa+Fc[0],Fb+Fc[1],Fc[2],Fc[3],Fc[4]),Fd.closePath(),this._fillAndStroke(Fc[5],Fc[6],Fc[7],!0)},this._clipRect=function(Fa,Fb,Fc){this.ctx.clipRect(Fa+Fc[0],Fb+Fc[1],Fc[2],Fc[3])},this._fillRect=function(Fa,Fb,Fc){this.ctx.fillRect(Fa+Fc[0],Fb+Fc[1],Fc[2],Fc[3],Fc[4])},this._drawCircle=function(Fa,Fb,Fc){var Fd=this.ctx;FJ.isWebGL&&Fd.setPathId(Fc[6]),FX.drawCall++,Fd.beginPath(),FJ.isWebGL&&Fd.movePath(Fc[0]+Fa,Fc[1]+Fb),Fd.arc(Fc[0]+Fa,Fc[1]+Fb,Fc[2],0,Fg.PI2),Fd.closePath(),this._fillAndStroke(Fc[3],Fc[4],Fc[5],!0)},this._fillCircle=function(Fa,Fb,Fc){FX.drawCall++;var Fd=this.ctx;Fd.beginPath(),Fd.fillStyle=Fc[3],Fd.arc(Fc[0]+Fa,Fc[1]+Fb,Fc[2],0,Fg.PI2),Fd.fill()},this._setShader=function(Fa,Fb,Fc){this.ctx.setShader(Fc[0])},this._drawLine=function(Fa,Fb,Fc){var Fd=this.ctx;FJ.isWebGL&&Fd.setPathId(Fc[6]),Fd.beginPath(),Fd.strokeStyle=Fc[4],Fd.lineWidth=Fc[5],FJ.isWebGL?(Fd.movePath(Fa,Fb),Fd.moveTo(Fc[0],Fc[1]),Fd.lineTo(Fc[2],Fc[3])):(Fd.moveTo(Fa+Fc[0],Fb+Fc[1]),Fd.lineTo(Fa+Fc[2],Fb+Fc[3])),Fd.stroke()},this._drawLines=function(Fa,Fb,Fc){var Fd=this.ctx;FJ.isWebGL&&Fd.setPathId(Fc[5]),Fd.beginPath(),Fa+=Fc[0],Fb+=Fc[1],FJ.isWebGL&&Fd.movePath(Fa,Fb),Fd.strokeStyle=Fc[3],Fd.lineWidth=Fc[4];var Fe=Fc[2],Ff=2,Fg=Fe.length;if(FJ.isWebGL)for(Fd.moveTo(Fe[0],Fe[1]);Ff<Fg;)Fd.lineTo(Fe[Ff++],Fe[Ff++]);else for(Fd.moveTo(Fa+Fe[0],Fb+Fe[1]);Ff<Fg;)Fd.lineTo(Fa+Fe[Ff++],Fb+Fe[Ff++]);Fd.stroke()},this._drawLinesWebGL=function(Fa,Fb,Fc){this.ctx.drawLines(Fa+this.x+Fc[0],Fb+this.y+Fc[1],Fc[2],Fc[3],Fc[4])},this._drawCurves=function(Fa,Fb,Fc){this.ctx.drawCurves(Fa,Fb,Fc)},this._draw=function(Fa,Fb,Fc){Fc[0].call(null,this,Fa,Fb)},this._transformByMatrix=function(Fa,Fb,Fc){this.ctx.transformByMatrix(Fc[0])},this._setTransform=function(Fa,Fb,Fc){this.ctx.setTransform(Fc[0],Fc[1],Fc[2],Fc[3],Fc[4],Fc[5])},this._setTransformByMatrix=function(Fa,Fb,Fc){this.ctx.setTransformByMatrix(Fc[0])},this._save=function(Fa,Fb,Fc){this.ctx.save()},this._restore=function(Fa,Fb,Fc){this.ctx.restore()},this._translate=function(Fa,Fb,Fc){this.ctx.translate(Fc[0],Fc[1])},this._transform=function(Fa,Fb,Fc){this.ctx.translate(Fc[1]+Fa,Fc[2]+Fb);var Fd=Fc[0];this.ctx.transform(Fd.a,Fd.b,Fd.c,Fd.d,Fd.tx,Fd.ty),this.ctx.translate(-Fa-Fc[1],-Fb-Fc[2])},this._rotate=function(Fa,Fb,Fc){this.ctx.translate(Fc[1]+Fa,Fc[2]+Fb),this.ctx.rotate(Fc[0]),this.ctx.translate(-Fa-Fc[1],-Fb-Fc[2])},this._scale=function(Fa,Fb,Fc){this.ctx.translate(Fc[2]+Fa,Fc[3]+Fb),this.ctx.scale(Fc[0],Fc[1]),this.ctx.translate(-Fa-Fc[2],-Fb-Fc[3])},this._alpha=function(Fa,Fb,Fc){this.ctx.globalAlpha*=Fc[0]},this._setAlpha=function(Fa,Fb,Fc){this.ctx.globalAlpha=Fc[0]},this._fillText=function(Fa,Fb,Fc){this.ctx.fillText(Fc[0],Fc[1]+Fa,Fc[2]+Fb,Fc[3],Fc[4],Fc[5])},this._strokeText=function(Fa,Fb,Fc){this.ctx.strokeText(Fc[0],Fc[1]+Fa,Fc[2]+Fb,Fc[3],Fc[4],Fc[5],Fc[6])},this._fillBorderText=function(Fa,Fb,Fc){this.ctx.fillBorderText(Fc[0],Fc[1]+Fa,Fc[2]+Fb,Fc[3],Fc[4],Fc[5],Fc[6],Fc[7])},this._blendMode=function(Fa,Fb,Fc){this.ctx.globalCompositeOperation=Fc[0]},this._beginClip=function(Fa,Fb,Fc){this.ctx.beginClip&&this.ctx.beginClip(Fa+Fc[0],Fb+Fc[1],Fc[2],Fc[3])},this._setIBVB=function(Fa,Fb,Fc){this.ctx.setIBVB(Fc[0]+Fa,Fc[1]+Fb,Fc[2],Fc[3],Fc[4],Fc[5],Fc[6],Fc[7])},this._fillTrangles=function(Fa,Fb,Fc){this.ctx.fillTrangles(Fc[0],Fc[1]+Fa,Fc[2]+Fb,Fc[3],Fc[4])},this._drawPath=function(Fa,Fb,Fc){var Fd=this.ctx;FJ.isWebGL&&Fd.setPathId(-1),Fd.beginPath(),Fa+=Fc[0],Fb+=Fc[1],FJ.isWebGL&&Fd.movePath(Fa,Fb);for(var Fe=Fc[2],Ff=0,Fg=Fe.length;Ff<Fg;Ff++){var Fh=Fe[Ff];switch(Fh[0]){case"moveTo":FJ.isWebGL?Fd.moveTo(Fh[1],Fh[2]):Fd.moveTo(Fa+Fh[1],Fb+Fh[2]);break;case"lineTo":FJ.isWebGL?Fd.lineTo(Fh[1],Fh[2]):Fd.lineTo(Fa+Fh[1],Fb+Fh[2]);break;case"arcTo":FJ.isWebGL?Fd.arcTo(Fh[1],Fh[2],Fh[3],Fh[4],Fh[5]):Fd.arcTo(Fa+Fh[1],Fb+Fh[2],Fa+Fh[3],Fb+Fh[4],Fh[5]);break;case"closePath":Fd.closePath()}}var Fi=Fc[3];null!=Fi&&(Fd.fillStyle=Fi.fillStyle,Fd.fill());var Fj=Fc[4];null!=Fj&&(Fd.strokeStyle=Fj.strokeStyle,Fd.lineWidth=Fj.lineWidth||1,Fd.lineJoin=Fj.lineJoin,Fd.lineCap=Fj.lineCap,Fd.miterLimit=Fj.miterLimit,Fd.stroke())},this.drawPoly=function(Fa,Fb,Fc){this.ctx.drawPoly(Fa+this.x+Fc[0],Fb+this.y+Fc[1],Fc[2],Fc[3],Fc[4],Fc[5],Fc[6])},this._drawPoly=function(Fa,Fb,Fc){var Fd=this.ctx,Fe=Fc[2],Ff=2,Fg=Fe.length;if(FJ.isWebGL)for(Fd.setPathId(Fc[6]),Fd.beginPath(),Fa+=Fc[0],Fb+=Fc[1],Fd.movePath(Fa,Fb),Fd.moveTo(Fe[0],Fe[1]);Ff<Fg;)Fd.lineTo(Fe[Ff++],Fe[Ff++]);else for(Fd.beginPath(),Fa+=Fc[0],Fb+=Fc[1],Fd.moveTo(Fa+Fe[0],Fb+Fe[1]);Ff<Fg;)Fd.lineTo(Fa+Fe[Ff++],Fb+Fe[Ff++]);Fd.closePath(),this._fillAndStroke(Fc[3],Fc[4],Fc[5],Fc[7])},this._drawSkin=function(Fa,Fb,Fc){var Fd=Fc[0];if(Fd){var Fe=this.ctx;Fd.render(Fe,Fa,Fb)}},this._drawParticle=function(Fa,Fb,Fc){this.ctx.drawParticle(Fa+this.x,Fb+this.y,Fc[0])},this._setFilters=function(Fa,Fb,Fc){this.ctx.setFilters(Fc)},Fc?this.ctx=Fc.getContext("2d"):(Fc=Fva.create("3D"),this.ctx=FF.createWebGLContext2D(Fc),Fc._setContext(this.ctx)),Fc.size(Fa,Fb),this.canvas=Fc}Fr(Fg,"laya.renders.RenderContext");var Fa=Fg.prototype;return Fa.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},Fa.drawTexture=function(Fa,Fb,Fc,Fd,Fe){Fa.loaded&&this.ctx.drawTexture(Fa,Fb,Fc,Fd,Fe,this.x,this.y)},Fa._drawTextures=function(Fa,Fb,Fc){Fc[0].loaded&&this.ctx.drawTextures(Fc[0],Fc[1],Fa+this.x,Fb+this.y)},Fa.drawTextureWithTransform=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){Fa.loaded&&this.ctx.drawTextureWithTransform(Fa,Fb,Fc,Fd,Fe,Ff,this.x,this.y,Fg)},Fa.fillQuadrangle=function(Fa,Fb,Fc,Fd,Fe){this.ctx.fillQuadrangle(Fa,Fb,Fc,Fd,Fe)},Fa.drawCanvas=function(Fa,Fb,Fc,Fd,Fe){this.ctx.drawCanvas(Fa,Fb+this.x,Fc+this.y,Fd,Fe)},Fa.drawRect=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Ff&&(Ff=1);var Fg=this.ctx;Fg.strokeStyle=Fe,Fg.lineWidth=Ff,Fg.strokeRect(Fa+this.x,Fb+this.y,Fc,Fd,Ff)},Fa._fillAndStroke=function(Fa,Fb,Fc,Fd){void 0===Fd&&(Fd=!1);var Fe=this.ctx;null!=Fa&&(Fe.fillStyle=Fa,FJ.isWebGL?Fe.fill(Fd):Fe.fill()),null!=Fb&&0<Fc&&(Fe.strokeStyle=Fb,Fe.lineWidth=Fc,Fe.stroke())},Fa.clipRect=function(Fa,Fb,Fc,Fd){this.ctx.clipRect(Fa+this.x,Fb+this.y,Fc,Fd)},Fa.fillRect=function(Fa,Fb,Fc,Fd,Fe){this.ctx.fillRect(Fa+this.x,Fb+this.y,Fc,Fd,Fe)},Fa.drawCircle=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=1),FX.drawCall++;var Ff=this.ctx;Ff.beginPath(),Ff.strokeStyle=Fd,Ff.lineWidth=Fe,Ff.arc(Fa+this.x,Fb+this.y,Fc,0,Fg.PI2),Ff.stroke()},Fa.drawTriangles=function(Fa,Fb,Fc){if(FJ.isWebGL)this.ctx.drawTriangles(Fc[0],Fa+Fc[1],Fb+Fc[2],Fc[3],Fc[4],Fc[5],Fc[6],Fc[7],Fc[8],Fc[9]);else{var Fd=Fc[5],Fe=0,Ff=Fd.length,Fg=this.ctx;for(Fe=0;Fe<Ff;Fe+=3){var Fh=2*Fd[Fe],Fi=2*Fd[Fe+1],Fj=2*Fd[Fe+2];Fg.drawTriangle(Fc[0],Fc[3],Fc[4],Fh,Fi,Fj,Fc[6],!0)}}},Fa.fillCircle=function(Fa,Fb,Fc,Fd){FX.drawCall++;var Fe=this.ctx;Fe.beginPath(),Fe.fillStyle=Fd,Fe.arc(Fa+this.x,Fb+this.y,Fc,0,Fg.PI2),Fe.fill()},Fa.setShader=function(Fa){this.ctx.setShader(Fa)},Fa.drawLine=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Ff&&(Ff=1);var Fg=this.ctx;Fg.beginPath(),Fg.strokeStyle=Fe,Fg.lineWidth=Ff,Fg.moveTo(this.x+Fa,this.y+Fb),Fg.lineTo(this.x+Fc,this.y+Fd),Fg.stroke()},Fa.clear=function(){this.ctx.clear()},Fa.transformByMatrix=function(Fa){this.ctx.transformByMatrix(Fa)},Fa.setTransform=function(Fa,Fb,Fc,Fd,Fe,Ff){this.ctx.setTransform(Fa,Fb,Fc,Fd,Fe,Ff)},Fa.setTransformByMatrix=function(Fa){this.ctx.setTransformByMatrix(Fa)},Fa.save=function(){this.ctx.save()},Fa.restore=function(){this.ctx.restore()},Fa.translate=function(Fa,Fb){this.ctx.translate(Fa,Fb)},Fa.transform=function(Fa,Fb,Fc,Fd,Fe,Ff){this.ctx.transform(Fa,Fb,Fc,Fd,Fe,Ff)},Fa.rotate=function(Fa){this.ctx.rotate(Fa)},Fa.scale=function(Fa,Fb){this.ctx.scale(Fa,Fb)},Fa.alpha=function(Fa){this.ctx.globalAlpha*=Fa},Fa.setAlpha=function(Fa){this.ctx.globalAlpha=Fa},Fa.fillWords=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Ff&&(Ff=0),this.ctx.fillWords(Fa,Fb,Fc,Fd,Fe,Ff)},Fa.fillBorderWords=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this.ctx.fillBorderWords(Fa,Fb,Fc,Fd,Fe,Ff,Fg)},Fa.fillText=function(Fa,Fb,Fc,Fd,Fe,Ff){this.ctx.fillText(Fa,Fb+this.x,Fc+this.y,Fd,Fe,Ff)},Fa.strokeText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this.ctx.strokeText(Fa,Fb+this.x,Fc+this.y,Fd,Fe,Ff,Fg)},Fa.blendMode=function(Fa){this.ctx.globalCompositeOperation=Fa},Fa.flush=function(){this.ctx.flush&&this.ctx.flush()},Fa.addRenderObject=function(Fa){this.ctx.addRenderObject(Fa)},Fa.beginClip=function(Fa,Fb,Fc,Fd){this.ctx.beginClip&&this.ctx.beginClip(Fa,Fb,Fc,Fd)},Fa.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},Fa.fillTrangles=function(Fa,Fb,Fc){this.ctx.fillTrangles(Fc[0],Fc[1],Fc[2],Fc[3],4<Fc.length?Fc[4]:null)},Fg.PI2=2*Math.PI,Fg}(),FL=function(){function Fg(Fa,Fb){switch(this._next=Fb||Fg.NORENDER,Fa){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=Ft._filter);case 69905:return void(this._fun=Fg._initRenderFun)}this.onCreate(Fa)}Fr(Fg,"laya.renders.RenderSprite");var Fa=Fg.prototype;return Fa.onCreate=function(Fa){},Fa._style=function(Fa,Fb,Fc,Fd){Fa._style.render(Fa,Fb,Fc,Fd);var Fe=this._next;Fe._fun.call(Fe,Fa,Fb,Fc,Fd)},Fa._no=function(Fa,Fb,Fc,Fd){},Fa._custom=function(Fa,Fb,Fc,Fd){Fa.customRender(Fb,Fc,Fd);var Fe=Fa._style._tf;this._next._fun.call(this._next,Fa,Fb,Fc-Fe.translateX,Fd-Fe.translateY)},Fa._clip=function(Fa,Fb,Fc,Fd){var Fe=this._next;if(Fe!=Fg.NORENDER){var Ff=Fa._style.scrollRect;Fb.ctx.save(),Fb.ctx.clipRect(Fc,Fd,Ff.width,Ff.height),Fe._fun.call(Fe,Fa,Fb,Fc-Ff.x,Fd-Ff.y),Fb.ctx.restore()}},Fa._blend=function(Fa,Fb,Fc,Fd){var Fe=Fa._style;Fe.blendMode&&(Fb.ctx.globalCompositeOperation=Fe.blendMode);var Ff=this._next;Ff._fun.call(Ff,Fa,Fb,Fc,Fd),Fb.ctx.globalCompositeOperation="source-over"},Fa._mask=function(Fa,Fb,Fc,Fd){var Fe=this._next;Fe._fun.call(Fe,Fa,Fb,Fc,Fd);var Ff=Fa.mask;Ff&&(Fb.ctx.globalCompositeOperation="destination-in",(0<Ff.numChildren||!Ff.graphics._isOnlyOne())&&(Ff.cacheAsBitmap=!0),Ff.render(Fb,Fc-Fa.pivotX,Fd-Fa.pivotY)),Fb.ctx.globalCompositeOperation="source-over"},Fa._graphics=function(Fa,Fb,Fc,Fd){var Fe=Fa._style._tf;Fa._graphics&&Fa._graphics._render(Fa,Fb,Fc-Fe.translateX,Fd-Fe.translateY);var Ff=this._next;Ff._fun.call(Ff,Fa,Fb,Fc,Fd)},Fa._image=function(Fa,Fb,Fc,Fd){var Fe=Fa._style;Fb.ctx.drawTexture2(Fc,Fd,Fe._tf.translateX,Fe._tf.translateY,Fa.transform,Fe.alpha,Fe.blendMode,Fa._graphics._one)},Fa._image2=function(Fa,Fb,Fc,Fd){var Fe=Fa._style._tf;Fb.ctx.drawTexture2(Fc,Fd,Fe.translateX,Fe.translateY,Fa.transform,1,null,Fa._graphics._one)},Fa._alpha=function(Fa,Fb,Fc,Fd){var Fe;if(.01<(Fe=Fa._style.alpha)||Fa._needRepaint()){var Ff=Fb.ctx.globalAlpha;Fb.ctx.globalAlpha*=Fe;var Fg=this._next;Fg._fun.call(Fg,Fa,Fb,Fc,Fd),Fb.ctx.globalAlpha=Ff}},Fa._transform=function(Fa,Fb,Fc,Fd){var Fe=Fa.transform,Ff=this._next;Fe&&Ff!=Fg.NORENDER?(Fb.save(),Fb.transform(Fe.a,Fe.b,Fe.c,Fe.d,Fe.tx+Fc,Fe.ty+Fd),Ff._fun.call(Ff,Fa,Fb,0,0),Fb.restore()):Ff._fun.call(Ff,Fa,Fb,Fc,Fd)},Fa._childs=function(Fa,Fb,Fc,Fd){var Fe=Fa._style,Ff=Fe._tf;if(Fc=Fc-Ff.translateX+Fe.paddingLeft,Fd=Fd-Ff.translateY+Fe.paddingTop,Fe._calculation){var Fg=Fa._getWords();if(Fg){var Fh=Fe;Fh&&(Fh.stroke?Fb.fillBorderWords(Fg,Fc,Fd,Fh.font,Fh.color,Fh.strokeColor,Fh.stroke):Fb.fillWords(Fg,Fc,Fd,Fh.font,Fh.color,"none"!=Fh.textDecoration&&Fh.underLine?1:0))}}var Fi,Fj=Fa._childs,Fm=Fj.length;if(Fa.viewport||Fa.optimizeScrollRect&&Fa._style.scrollRect){var Fn=Fa.viewport||Fa._style.scrollRect,Fo=Fn.x,Fp=Fn.y,Fq=Fn.right,Fr=Fn.bottom,Fs=NaN,Ft=NaN;for(Fu=0;Fu<Fm;++Fu)(Fi=Fj[Fu]).visible&&(Fs=Fi._x)<Fq&&Fs+Fi.width>Fo&&(Ft=Fi._y)<Fr&&Ft+Fi.height>Fp&&Fi.render(Fb,Fc,Fd)}else for(var Fu=0;Fu<Fm;++Fu)(Fi=Fj[Fu])._style.visible&&Fi.render(Fb,Fc,Fd)},Fa._canvas=function(Fa,Fb,Fc,Fd){var Fe=Fa._$P.cacheCanvas;if(Fe){"bitmap"===Fe.type?FX.canvasBitmap++:FX.canvasNormal++;var Ff=Fe.ctx;if(Fa._needRepaint()||!Ff)this._canvas_repaint(Fa,Fb,Fc,Fd);else{var Fg=Fe._cacheRec;Fb.drawCanvas(Ff.canvas,Fc+Fg.x,Fd+Fg.y,Fg.width,Fg.height)}}else this._next._fun.call(this._next,Fa,Fb,Fc,Fd)},Fa._canvas_repaint=function(Fa,Fb,Fc,Fd){var Fe=Fa._$P.cacheCanvas,Ff=this._next;if(Fe){var Fg,Fh,Fi,Fj,Fm=Fe.ctx,Fn=Fa._needRepaint()||!Fm,Fo=Fe.type;if("bitmap"===Fo?FX.canvasBitmap++:FX.canvasNormal++,Fn){var Fp,Fq;Fe._cacheRec||(Fe._cacheRec=new FB),FJ.isWebGL&&"bitmap"!==Fo?Fe._cacheRec.setTo(-Fa.pivotX,-Fa.pivotY,1,1):((Fj=Fa.getSelfBounds()).x=Fj.x-Fa.pivotX,Fj.y=Fj.y-Fa.pivotY,Fj.x=Fj.x-16,Fj.y=Fj.y-16,Fj.width=Fj.width+32,Fj.height=Fj.height+32,Fj.x=Math.floor(Fj.x+Fc)-Fc,Fj.y=Math.floor(Fj.y+Fd)-Fd,Fj.width=Math.floor(Fj.width),Fj.height=Math.floor(Fj.height),Fe._cacheRec.copyFrom(Fj)),Fj=Fe._cacheRec;var Fr,Fs=FJ.isWebGL?1:FO.pixelRatio*Fz.stage.clientScaleX,Ft=FJ.isWebGL?1:FO.pixelRatio*Fz.stage.clientScaleY;if(!FJ.isWebGL){var Fu,Fv=1,Fw=1;for(Fu=Fa;Fu&&Fu!=Fz.stage;)Fv*=Fu.scaleX,Fw*=Fu.scaleY,Fu=Fu.parent;FJ.isWebGL?(Fv<1&&(Fs*=Fv),Fw<1&&(Ft*=Fw)):(1<Fv&&(Fs*=Fv),1<Fw&&(Ft*=Fw))}if(Fa.scrollRect){var Fx=Fa.scrollRect;Fj.x-=Fx.x,Fj.y-=Fx.y}if(Fp=Fj.width*Fs,Fq=Fj.height*Ft,Fh=Fj.x,Fi=Fj.y,FJ.isWebGL&&"bitmap"===Fo&&(2048<Fp||2048<Fq))return console.warn("cache bitmap size larger than 2048,cache ignored"),Fe.ctx&&(FW.recover("RenderContext",Fe.ctx),Fe.ctx.canvas.size(0,0),Fe.ctx=null),void Ff._fun.call(Ff,Fa,Fb,Fc,Fd);if(Fm||(Fm=Fe.ctx=FW.getItem("RenderContext")||new FK(Fp,Fq,Fva.create("AUTO"))),Fm.ctx.sprite=Fa,(Fg=Fm.canvas).clear(),(Fg.width!=Fp||Fg.height!=Fq)&&Fg.size(Fp,Fq),"bitmap"===Fo?Fg.context.asBitmap=!0:"normal"===Fo&&(Fg.context.asBitmap=!1),1!=Fs||1!=Ft){var Fy=Fm.ctx;Fy.save(),Fy.scale(Fs,Ft),!FJ.isConchWebGL&&FJ.isConchApp&&(Fr=Fa._$P.cf)&&Fy.setFilterMatrix&&Fy.setFilterMatrix(Fr._mat,Fr._alpha),Ff._fun.call(Ff,Fa,Fm,-Fh,-Fi),Fy.restore(),FJ.isConchApp&&!FJ.isConchWebGL||Fa._applyFilters()}else Fy=Fm.ctx,!FJ.isConchWebGL&&FJ.isConchApp&&(Fr=Fa._$P.cf)&&Fy.setFilterMatrix&&Fy.setFilterMatrix(Fr._mat,Fr._alpha),Ff._fun.call(Ff,Fa,Fm,-Fh,-Fi),FJ.isConchApp&&!FJ.isConchWebGL||Fa._applyFilters();Fa._$P.staticCache&&(Fe.reCache=!1),FX.canvasReCache++}else Fh=(Fj=Fe._cacheRec).x,Fi=Fj.y,Fg=Fm.canvas;Fb.drawCanvas(Fg,Fc+Fh,Fd+Fi,Fj.width,Fj.height)}else Ff._fun.call(Ff,Fa,Fm,Fc,Fd)},Fg.__init__=function(){var Fa,Fb,Fc=0;for(Fb=FF.createRenderSprite(69905,null),Fa=Fg.renders.length=4096,Fc=0;Fc<Fa;Fc++)Fg.renders[Fc]=Fb;Fg.renders[0]=FF.createRenderSprite(0,null),function(Fa,Fb){for(var Fc=0,Fd=0;Fd<Fa.length;Fd++)Fc|=Fa[Fd],Fg.renders[Fc]=Fb}([1,512,4,2],new Fg(1,null)),Fg.renders[513]=FF.createRenderSprite(513,null),Fg.renders[517]=new Fg(517,null)},Fg._initRenderFun=function(Fa,Fb,Fc,Fd){var Fe=Fa._renderType;(Fg.renders[Fe]=Fg._getTypeRender(Fe))._fun(Fa,Fb,Fc,Fd)},Fg._getTypeRender=function(Fa){for(var Fb=null,Fc=2048;1<Fc;)Fc&Fa&&(Fb=FF.createRenderSprite(Fc,Fb)),Fc>>=1;return Fb},Fg.IMAGE=1,Fg.ALPHA=2,Fg.TRANSFORM=4,Fg.BLEND=8,Fg.CANVAS=16,Fg.FILTERS=32,Fg.MASK=64,Fg.CLIP=128,Fg.STYLE=256,Fg.GRAPHICS=512,Fg.CUSTOM=1024,Fg.CHILDS=2048,Fg.INIT=69905,Fg.renders=[],Fg.NORENDER=new Fg(0,null),Fg}(),FM=function(){function Fh(){this._repaint=!1}Fr(Fh,"laya.resource.Context");var Fa=Fh.prototype;return Fa.replaceReset=function(){var Fa,Fb,Fc=0;for(Fa=Fh.replaceKeys.length,Fc=0;Fc<Fa;Fc++)Fb=Fh.replaceKeys[Fc],this[Fh.newKeys[Fc]]=this[Fb]},Fa.replaceResotre=function(){this.__restore(),this.__reset()},Fa.setIsMainContext=function(){},Fa.drawTextures=function(Fa,Fb,Fc,Fd){FX.drawCall+=Fb.length/2;for(var Fe=Fa.width,Ff=Fa.height,Fg=0,Fh=Fb.length;Fg<Fh;Fg+=2)this.drawTexture(Fa,Fb[Fg],Fb[Fg+1],Fe,Ff,Fc,Fd)},Fa.drawCanvas=function(Fa,Fb,Fc,Fd,Fe){FX.drawCall++,this.drawImage(Fa.source,Fb,Fc,Fd,Fe)},Fa.fillRect=function(Fa,Fb,Fc,Fd,Fe){FX.drawCall++,Fe&&(this.fillStyle=Fe),this.__fillRect(Fa,Fb,Fc,Fd)},Fa.fillText=function(Fa,Fb,Fc,Fd,Fe,Ff){FX.drawCall++,3<arguments.length&&null!=Fd&&(this.font=Fd,this.fillStyle=Fe,this.textAlign=Ff,this.textBaseline="top"),this.__fillText(Fa,Fb,Fc)},Fa.fillBorderText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){FX.drawCall++,this.font=Fd,this.fillStyle=Fe,this.textBaseline="top",this.strokeStyle=Ff,this.lineWidth=Fg,this.textAlign=Fh,this.__strokeText(Fa,Fb,Fc),this.__fillText(Fa,Fb,Fc)},Fa.strokeText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){FX.drawCall++,3<arguments.length&&null!=Fd&&(this.font=Fd,this.strokeStyle=Fe,this.lineWidth=Ff,this.textAlign=Fg,this.textBaseline="top"),this.__strokeText(Fa,Fb,Fc)},Fa.transformByMatrix=function(Fa){this.transform(Fa.a,Fa.b,Fa.c,Fa.d,Fa.tx,Fa.ty)},Fa.setTransformByMatrix=function(Fa){this.setTransform(Fa.a,Fa.b,Fa.c,Fa.d,Fa.tx,Fa.ty)},Fa.clipRect=function(Fa,Fb,Fc,Fd){FX.drawCall++,this.beginPath(),this.rect(Fa,Fb,Fc,Fd),this.clip()},Fa.drawTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){FX.drawCall++;var Fh=Fa.uv,Fi=Fa.bitmap.width,Fj=Fa.bitmap.height;this.drawImage(Fa.source,Fh[0]*Fi,Fh[1]*Fj,(Fh[2]-Fh[0])*Fi,(Fh[5]-Fh[3])*Fj,Fb+Ff,Fc+Fg,Fd,Fe)},Fa.drawTextureWithTransform=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){FX.drawCall++;var Fj=Fa.uv,Fm=Fa.bitmap.width,Fn=Fa.bitmap.height;this.save(),1!=Fi&&(this.globalAlpha*=Fi),Ff?(this.transform(Ff.a,Ff.b,Ff.c,Ff.d,Ff.tx+Fg,Ff.ty+Fh),this.drawImage(Fa.source,Fj[0]*Fm,Fj[1]*Fn,(Fj[2]-Fj[0])*Fm,(Fj[5]-Fj[3])*Fn,Fb,Fc,Fd,Fe)):this.drawImage(Fa.source,Fj[0]*Fm,Fj[1]*Fn,(Fj[2]-Fj[0])*Fm,(Fj[5]-Fj[3])*Fn,Fb+Fg,Fc+Fh,Fd,Fe),this.restore()},Fa.drawTexture2=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){var Fi=Fh[0];if(Fi.loaded&&Fi.bitmap&&Fi.source){FX.drawCall++;var Fj=1!==Ff;if(Fj){var Fm=this.globalAlpha;this.globalAlpha*=Ff}var Fn=Fi.uv,Fo=Fi.bitmap.width,Fp=Fi.bitmap.height;Fe?(this.save(),this.transform(Fe.a,Fe.b,Fe.c,Fe.d,Fe.tx+Fa,Fe.ty+Fb),this.drawImage(Fi.source,Fn[0]*Fo,Fn[1]*Fp,(Fn[2]-Fn[0])*Fo,(Fn[5]-Fn[3])*Fp,Fh[1]-Fc,Fh[2]-Fd,Fh[3],Fh[4]),this.restore()):this.drawImage(Fi.source,Fn[0]*Fo,Fn[1]*Fp,(Fn[2]-Fn[0])*Fo,(Fn[5]-Fn[3])*Fp,Fh[1]-Fc+Fa,Fh[2]-Fd+Fb,Fh[3],Fh[4]),Fj&&(this.globalAlpha=Fm)}},Fa.fillTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){if(!Fh.pat){if(Fa.uv!=Fma.DEF_UV){var Fi=new Fva("2D");Fi.getContext("2d"),Fi.size(Fa.width,Fa.height),Fi.context.drawTexture(Fa,0,0,Fa.width,Fa.height,0,0),Fa=new Fma(Fi)}Fh.pat=this.createPattern(Fa.bitmap.source,Ff)}var Fj=Fb,Fm=Fc,Fn=0,Fo=0;Fg&&(Fj+=Fg.x%Fa.width,Fm+=Fg.y%Fa.height,Fn-=Fg.x%Fa.width,Fo-=Fg.y%Fa.height),this.translate(Fj,Fm),this.fillRect(Fn,Fo,Fd,Fe,Fh.pat),this.translate(-Fj,-Fm)},Fa.drawTriangle=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){var Fi=Fa.bitmap,Fj=Fi.source,Fm=Fa.width,Fn=Fa.height,Fo=Fi.width,Fp=Fi.height,Fq=Fc[Fd]*Fo,Fr=Fc[Fe]*Fo,Fs=Fc[Ff]*Fo,Ft=Fc[Fd+1]*Fp,Fu=Fc[Fe+1]*Fp,Fv=Fc[Ff+1]*Fp,Fw=Fb[Fd],Fx=Fb[Fe],Fy=Fb[Ff],Fz=Fb[Fd+1],FA=Fb[Fe+1],FB=Fb[Ff+1];if(Fh){var FC=(Fw+Fx+Fy)/3,FD=(Fz+FA+FB)/3,FE=Fw-FC,FF=Fz-FD,FG=Math.sqrt(FE*FE+FF*FF);Fw=FC+FE/FG*(FG+1),Fz=FD+FF/FG*(FG+1),FF=FA-FD,Fx=FC+(FE=Fx-FC)/(FG=Math.sqrt(FE*FE+FF*FF))*(FG+1),FA=FD+FF/FG*(FG+1),FF=FB-FD,Fy=FC+(FE=Fy-FC)/(FG=Math.sqrt(FE*FE+FF*FF))*(FG+1),FB=FD+FF/FG*(FG+1)}this.save(),Fg&&this.transform(Fg.a,Fg.b,Fg.c,Fg.d,Fg.tx,Fg.ty),this.beginPath(),this.moveTo(Fw,Fz),this.lineTo(Fx,FA),this.lineTo(Fy,FB),this.closePath(),this.clip();var FH=1/(Fq*Fu+Ft*Fs+Fr*Fv-Fu*Fs-Ft*Fr-Fq*Fv),FI=Fw*Fu+Ft*Fy+Fx*Fv-Fu*Fy-Ft*Fx-Fw*Fv,FJ=Fq*Fx+Fw*Fs+Fr*Fy-Fx*Fs-Fw*Fr-Fq*Fy,FK=Fq*Fu*Fy+Ft*Fx*Fs+Fw*Fr*Fv-Fw*Fu*Fs-Ft*Fr*Fy-Fq*Fx*Fv,FL=Fz*Fu+Ft*FB+FA*Fv-Fu*FB-Ft*FA-Fz*Fv,FM=Fq*FA+Fz*Fs+Fr*FB-FA*Fs-Fz*Fr-Fq*FB,FN=Fq*Fu*FB+Ft*FA*Fs+Fz*Fr*Fv-Fz*Fu*Fs-Ft*Fr*FB-Fq*FA*Fv;this.transform(FI*FH,FL*FH,FJ*FH,FM*FH,FK*FH,FN*FH),this.drawImage(Fj,Fa.uv[0]*Fo,Fa.uv[1]*Fp,Fm,Fn,Fa.uv[0]*Fo,Fa.uv[1]*Fp,Fm,Fn),this.restore()},Fa.flush=function(){return 0},Fa.fillWords=function(Fa,Fb,Fc,Fd,Fe,Ff){Fd&&(this.font=Fd),Fe&&(this.fillStyle=Fe);this.textBaseline="top",this.textAlign="left";for(var Fg=0,Fh=Fa.length;Fg<Fh;Fg++){var Fi=Fa[Fg];if(this.__fillText(Fi.char,Fi.x+Fb,Fi.y+Fc),1===Ff){var Fj=Fi.height,Fm=.5*Fi.style.letterSpacing;Fm||(Fm=0),this.beginPath(),this.strokeStyle=Fe,this.lineWidth=1,this.moveTo(Fb+Fi.x-Fm+.5,Fc+Fi.y+Fj+.5),this.lineTo(Fb+Fi.x+Fi.width+Fm+.5,Fc+Fi.y+Fj+.5),this.stroke()}}},Fa.fillBorderWords=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){Fd&&(this.font=Fd),Fe&&(this.fillStyle=Fe),this.textBaseline="top",this.lineWidth=Fg,this.textAlign="left",this.strokeStyle=Ff;for(var Fh=0,Fi=Fa.length;Fh<Fi;Fh++){var Fj=Fa[Fh];this.__strokeText(Fj.char,Fj.x+Fb,Fj.y+Fc),this.__fillText(Fj.char,Fj.x+Fb,Fj.y+Fc)}},Fa.destroy=function(){this.canvas.width=this.canvas.height=0},Fa.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},Fa.drawCurves=function(Fa,Fb,Fc){this.beginPath(),this.strokeStyle=Fc[3],this.lineWidth=Fc[4];var Fd=Fc[2];Fa+=Fc[0],Fb+=Fc[1],this.moveTo(Fa+Fd[0],Fb+Fd[1]);for(var Fe=2,Ff=Fd.length;Fe<Ff;)this.quadraticCurveTo(Fa+Fd[Fe++],Fb+Fd[Fe++],Fa+Fd[Fe++],Fb+Fd[Fe++]);this.stroke()},Fh.__init__=function(Fb){var Fc=laya.resource.Context.prototype;if(!(Fb=Fb||CanvasRenderingContext2D.prototype).inited){Fb.inited=!0,Fb.__fillText=Fb.fillText,Fb.__fillRect=Fb.fillRect,Fb.__strokeText=Fb.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(Fa){Fb[Fa]=Fc[Fa]})}},Fh.replaceCanvasGetSet=function(Fa,Fb){var Fc=Object.getOwnPropertyDescriptor(Fa,Fb);if(!Fc||!Fc.configurable)return!1;var Fd,Fe={};for(Fd in Fc)"set"!=Fd&&(Fe[Fd]=Fc[Fd]);var Ff=Fc.set;return Fe.set=function(Fa){Ff.call(this,Fa);var Fb=this.getContext("2d");Fb&&"__reset"in Fb&&Fb.__reset()},Object.defineProperty(Fa,Fb,Fe),!0},Fh.replaceGetSet=function(Fa,Fb){var Fc=Object.getOwnPropertyDescriptor(Fa,Fb);if(!Fc||!Fc.configurable)return!1;var Fd,Fe={};for(Fd in Fc)"set"!=Fd&&(Fe[Fd]=Fc[Fd]);var Ff=Fc.set,Fg="___"+Fb+"__";return Fh.newKeys.push(Fg),Fe.set=function(Fa){Fa!=this[Fg]&&(this[Fg]=Fa,Ff.call(this,Fa))},Object.defineProperty(Fa,Fb,Fe),!0},Fh._default=new Fh,Fh.newKeys=[],Fi(Fh,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),Fh}(),FN=function(){function Ff(Fa){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++Ff._uniqueIDCounter,this._name=Fa||"Content Manager",Ff._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,Ff._resourceManagers.push(this),this._resources=[],this._records={}}Fr(Ff,"laya.resource.ResourceManager");var Fa=Ff.prototype;return Fz.imps(Fa,{"laya.resource.IDispose":!0}),Fa.getResourceByIndex=function(Fa){return this._resources[Fa]},Fa.getResourcesLength=function(){return this._resources.length},Fa.addResource=function(Fa){return Fa.resourceManager&&Fa.resourceManager.removeResource(Fa),-1===this._resources.indexOf(Fa)&&((Fa._resourceManager=this)._resources.push(Fa),this.addRecord(Fa.uri,Fa.__className,Fa.memorySize),this.addSize(Fa.memorySize),!0)},Fa.removeResource=function(Fa){var Fb=this._resources.indexOf(Fa);return-1!==Fb&&(this._resources.splice(Fb,1),Fa._resourceManager=null,this._memorySize-=Fa.memorySize,this.addRecord(Fa.uri,Fa.__className,-Fa.memorySize),!0)},Fa.unload=function(){for(var Fa=this._resources.slice(0,this._resources.length),Fb=0;Fb<Fa.length;Fb++){Fa[Fb].destroy()}Fa.length=0},Fa.dispose=function(){if(this===Ff._systemResourceManager)throw new Error("systemResourceManager不能被释放！");Ff._resourceManagers.splice(Ff._resourceManagers.indexOf(this),1),Ff._isResourceManagersSorted=!1;for(var Fa=this._resources.slice(0,this._resources.length),Fb=0;Fb<Fa.length;Fb++){var Fc=Fa[Fb];Fc.resourceManager.removeResource(Fc),Fc.destroy()}Fa.length=0},Fa.addSize=function(Fa){Fa&&(this.autoRelease&&0<Fa&&this._memorySize+Fa>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=Fa)},Fa.addRecord=function(Fa,Fb,Fc){DEBUG&&Fc&&!Fa&&console.error(Fa,Fb,Fc),Fa&&(this._records.hasOwnProperty(Fb+"|"+Fa)||(this._records[Fb+"|"+Fa]=0),this._records[Fb+"|"+Fa]+=Fc,DEBUG&&this._records[Fb+"|"+Fa]<0&&console.error(Fa,Fb,this._records[Fb+"|"+Fa]))},Fa.garbageCollection=function(Fa){var Fb=this._resources;(Fb=Fb.slice()).sort(function(Fa,Fb){if(!Fa||!Fb)throw new Error("a或b不能为空！");return Fa.released&&Fb.released?0:Fa.released?1:Fb.released?-1:Fa._lastUseFrameCount-Fb._lastUseFrameCount});for(var Fc=FX.loopCount,Fd=0,Fe=Fb.length;Fd<Fe;Fd++){var Ff=Fb[Fd];if(!(1<Fc-Ff._lastUseFrameCount))return void(this._memorySize>=Fa&&(this._isOverflow=!0));if(Ff.releaseResource(),this._memorySize<Fa)return void(this._isOverflow=!1)}},Fm(0,Fa,"id",function(){return this._id}),Fm(0,Fa,"name",function(){return this._name},function(Fa){!Fa&&""===Fa||this._name===Fa||(this._name=Fa,Ff._isResourceManagersSorted=!1)}),Fm(0,Fa,"memorySize",function(){return this._memorySize}),Fm(0,Fa,"records",function(){return this._records}),Fm(1,Ff,"systemResourceManager",function(){return Ff._systemResourceManager}),Ff.__init__=function(){Ff.currentResourceManager=Ff.systemResourceManager},Ff.getLoadedResourceManagerByIndex=function(Fa){return Ff._resourceManagers[Fa]},Ff.getLoadedResourceManagersCount=function(){return Ff._resourceManagers.length},Ff.recreateContentManagers=function(Fa){void 0===Fa&&(Fa=!1);for(var Fb=Ff.currentResourceManager,Fc=0;Fc<Ff._resourceManagers.length;Fc++){Ff.currentResourceManager=Ff._resourceManagers[Fc];for(var Fd=0;Fd<Ff.currentResourceManager._resources.length;Fd++)Ff.currentResourceManager._resources[Fd].releaseResource(Fa),Ff.currentResourceManager._resources[Fd].activeResource(Fa)}Ff.currentResourceManager=Fb},Ff.releaseContentManagers=function(Fa){void 0===Fa&&(Fa=!1);for(var Fb=Ff.currentResourceManager,Fc=0;Fc<Ff._resourceManagers.length;Fc++){Ff.currentResourceManager=Ff._resourceManagers[Fc];for(var Fd=0;Fd<Ff.currentResourceManager._resources.length;Fd++){var Fe=Ff.currentResourceManager._resources[Fd];!Fe.released&&Fe.releaseResource(Fa)}}Ff.currentResourceManager=Fb},Ff._uniqueIDCounter=0,Ff._isResourceManagersSorted=!1,Ff._resourceManagers=[],Fi(Ff,["_systemResourceManager",function(){return this._systemResourceManager=new Ff("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=Ff._systemResourceManager}]),Ff}(),FO=(function(){function Fa(){}Fr(Fa,"laya.system.System"),Fa.changeDefinition=function(Fa,Fb){Fz[Fa]=Fb;var Fc=Fa+"=classObj";Fz._runScript(Fc)},Fa.__init__=function(){FJ.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function Fc(){}return Fr(Fc,"laya.utils.Browser"),Fm(1,Fc,"pixelRatio",function(){return Fc.__init__(),-1<Fc.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:FF.getPixelRatio()}),Fm(1,Fc,"height",function(){return Fc.__init__(),(Fz.stage&&Fz.stage.canvasRotation?Fc.clientWidth:Fc.clientHeight)*Fc.pixelRatio}),Fm(1,Fc,"clientWidth",function(){return Fc.__init__(),Fc.window.innerWidth||Fc.document.body.clientWidth}),Fm(1,Fc,"window",function(){return Fc.__init__(),Fc._window}),Fm(1,Fc,"clientHeight",function(){return Fc.__init__(),Fc.window.innerHeight||Fc.document.body.clientHeight||Fc.document.documentElement.clientHeight}),Fm(1,Fc,"width",function(){return Fc.__init__(),(Fz.stage&&Fz.stage.canvasRotation?Fc.clientHeight:Fc.clientWidth)*Fc.pixelRatio}),Fm(1,Fc,"container",function(){return Fc.__init__(),Fc._container||((Fc._container=Fc.createElement("div")).id="layaContainer",Fc.document.body.appendChild(Fc._container)),Fc._container},function(Fa){Fc._container=Fa}),Fm(1,Fc,"document",function(){return Fc.__init__(),Fc._document}),Fc.__init__=function(){if(!Fc._window){Fc._window=FF.getWindow(),Fc._document=Fc.window.document,Fc._window.addEventListener("message",function(Fa){laya.utils.Browser._onMessage(Fa)},!1),Fc.document.__createElement=Fc.document.createElement,Fg.requestAnimationFrame=Fg.requestAnimationFrame||Fg.webkitRequestAnimationFrame||Fg.mozRequestAnimationFrame||Fg.oRequestAnimationFrame||Fg.msRequestAnimationFrame||function(Fa){return Fg.setTimeout(Fa,1e3/60)};var Fa=Fg.document.body.style;Fa["-webkit-user-select"]="none",Fa["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",Fc.userAgent=Fc.window.navigator.userAgent,Fc.onIOS=!!(Fc.u=Fc.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),Fc.onMobile=-1<Fc.u.indexOf("Mobile"),Fc.onIPhone=-1<Fc.u.indexOf("iPhone"),Fc.onMac=-1<Fc.u.indexOf("Mac OS X"),Fc.onIPad=-1<Fc.u.indexOf("iPad"),Fc.onAndroid=-1<Fc.u.indexOf("Android")||-1<Fc.u.indexOf("Adr"),Fc.onWP=-1<Fc.u.indexOf("Windows Phone"),Fc.onQQBrowser=-1<Fc.u.indexOf("QQBrowser"),Fc.onMQQBrowser=-1<Fc.u.indexOf("MQQBrowser")||-1<Fc.u.indexOf("Mobile")&&-1<Fc.u.indexOf("QQ"),Fc.onIE=!!Fc.window.ActiveXObject||"ActiveXObject"in Fc.window,Fc.onWeiXin=-1<Fc.u.indexOf("MicroMessenger"),Fc.onPC=!Fc.onMobile,Fc.onSafari=-1<Fc.u.indexOf("Safari"),Fc.onFirefox=-1<Fc.u.indexOf("Firefox"),Fc.onEdge=-1<Fc.u.indexOf("Edge"),Fc.onMiniGame=-1<Fc.u.indexOf("MiniGame"),Fc.onLimixiu=-1<Fc.u.indexOf("limixiu"),Fc.httpProtocol="http:"==Fc.window.location.protocol,Fc.onMiniGame&&null==Fc.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),Fc.webAudioEnabled=!!(Fc.window.AudioContext||Fc.window.webkitAudioContext||Fc.window.mozAudioContext),Fc.soundType=Fc.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",Fea=Fc.webAudioEnabled?Ffa:Fca,Fc.webAudioEnabled&&Ffa.initWebAudio(),Fca._initMusicAudio(),Fc.enableTouch="ontouchstart"in Fg||Fg.DocumentTouch&&Fb instanceof DocumentTouch,Fg.focus(),FE._soundClass=Fea,FE._musicClass=Fca,FJ._mainCanvas=FJ._mainCanvas||Fva.create("2D"),Fc.canvas||(Fc.canvas=Fva.create("2D"),Fc.context=Fc.canvas.getContext("2d"))}},Fc._onMessage=function(Fa){if(Fa.data&&"size"==Fa.data.name){if(Fc.window.innerWidth=Fa.data.width,Fc.window.innerHeight=Fa.data.height,Fc.window.__innerHeight=Fa.data.clientHeight,!Fc.document.createEvent)return void console.warn("no document.createEvent");var Fb=Fc.document.createEvent("HTMLEvents");return Fb.initEvent("resize",!1,!1),void Fc.window.dispatchEvent(Fb)}},Fc.createElement=function(Fa){return Fc.__init__(),Fc.document.__createElement(Fa)},Fc.getElementById=function(Fa){return Fc.__init__(),Fc.document.getElementById(Fa)},Fc.removeElement=function(Fa){Fa&&Fa.parentNode&&Fa.parentNode.removeChild(Fa)},Fc.now=function(){return FF.now()},Fc._window=null,Fc._document=null,Fc._container=null,Fc.userAgent=null,Fc.u=null,Fc.onIOS=!1,Fc.onMac=!1,Fc.onMobile=!1,Fc.onIPhone=!1,Fc.onIPad=!1,Fc.onAndroid=!1,Fc.onWP=!1,Fc.onQQBrowser=!1,Fc.onMQQBrowser=!1,Fc.onSafari=!1,Fc.onFirefox=!1,Fc.onEdge=!1,Fc.onIE=!1,Fc.onWeiXin=!1,Fc.onMiniGame=!1,Fc.onLimixiu=!1,Fc.onPC=!1,Fc.httpProtocol=!1,Fc.webAudioEnabled=!1,Fc.soundType=null,Fc.enableTouch=!1,Fc.canvas=null,Fc.context=null,Fc.__init$=function(){},Fc}()),FP=function(){function Fb(Fa){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,Fa?(this._u8d_=new Uint8Array(Fa),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}Fr(Fb,"laya.utils.Byte");var Fa=Fb.prototype;return Fa.___resizeBuffer=function(Fb){try{var Fa=new Uint8Array(Fb);null!=this._u8d_&&(this._u8d_.length<=Fb?Fa.set(this._u8d_):Fa.set(this._u8d_.subarray(0,Fb))),this._u8d_=Fa,this._d_=new DataView(Fa.buffer)}catch(Fa){throw"___resizeBuffer err:"+Fb}},Fa.getString=function(){return this.rUTF(this.getUint16())},Fa.getFloat32Array=function(Fa,Fb){var Fc=Fa+Fb;Fc=Fc>this._length?this._length:Fc;var Fd=new Float32Array(this._d_.buffer.slice(Fa,Fc));return this._pos_=Fc,Fd},Fa.getUint8Array=function(Fa,Fb){var Fc=Fa+Fb;Fc=Fc>this._length?this._length:Fc;var Fd=new Uint8Array(this._d_.buffer.slice(Fa,Fc));return this._pos_=Fc,Fd},Fa.getInt16Array=function(Fa,Fb){var Fc=Fa+Fb;Fc=Fc>this._length?this._length:Fc;var Fd=new Int16Array(this._d_.buffer.slice(Fa,Fc));return this._pos_=Fc,Fd},Fa.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var Fa=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,Fa},Fa.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var Fa=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,Fa},Fa.writeFloat32=function(Fa){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,Fa,this._xd_),this._pos_+=4},Fa.writeFloat64=function(Fa){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,Fa,this._xd_),this._pos_+=8},Fa.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var Fa=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,Fa},Fa.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var Fa=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,Fa},Fa.writeInt32=function(Fa){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,Fa,this._xd_),this._pos_+=4},Fa.writeUint32=function(Fa){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,Fa,this._xd_),this._pos_+=4},Fa.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var Fa=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,Fa},Fa.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var Fa=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,Fa},Fa.writeUint16=function(Fa){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,Fa,this._xd_),this._pos_+=2},Fa.writeInt16=function(Fa){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,Fa,this._xd_),this._pos_+=2},Fa.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},Fa.writeUint8=function(Fa){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,Fa),this._pos_++},Fa._getUInt8=function(Fa){return this._d_.getUint8(Fa)},Fa._getUint16=function(Fa){return this._d_.getUint16(Fa,this._xd_)},Fa._getMatrix=function(){return new FG(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},Fa.rUTF=function(Fa){for(var Fb=[],Fc=this._pos_+Fa,Fd=0,Fe=0,Ff=0,Fg=String.fromCharCode,Fh=this._u8d_;this._pos_<Fc;)(Fd=Fh[this._pos_++])<128?0!=Fd&&Fb.push(Fg(Fd)):Fd<224?Fb.push(Fg((63&Fd)<<6|127&Fh[this._pos_++])):Fd<240?(Fe=Fh[this._pos_++],Fb.push(Fg((31&Fd)<<12|(127&Fe)<<6|127&Fh[this._pos_++]))):(Fe=Fh[this._pos_++],Ff=Fh[this._pos_++],Fb.push(Fg((15&Fd)<<18|(127&Fe)<<12|Ff<<6&127|127&Fh[this._pos_++]))),0;return Fb.join("")},Fa.getCustomString=function(Fa){for(var Fb=[],Fc=0,Fd=0,Fe=0,Ff=String.fromCharCode,Fg=this._u8d_;0<Fa;)if((Fd=Fg[this._pos_])<128)Fb.push(Ff(Fd)),this._pos_++,Fa--;else for(Fc=Fd-128,this._pos_++,Fa-=Fc;0<Fc;)Fd=Fg[this._pos_++],Fe=Fg[this._pos_++],Fb.push(Ff(Fe<<8|Fd)),Fc--;return Fb.join("")},Fa.clear=function(){this._pos_=0,this.length=0},Fa.__getBuffer=function(){return this._d_.buffer},Fa.writeUTFBytes=function(Fa){for(var Fb=0,Fc=(Fa+="").length;Fb<Fc;Fb++){var Fd=Fa.charCodeAt(Fb);Fd<=127?this.writeByte(Fd):Fd<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|Fd>>6,128|63&Fd],this._pos_),this._pos_+=2):Fd<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|Fd>>12,128|Fd>>6&63,128|63&Fd],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|Fd>>18,128|Fd>>12&63,128|Fd>>6&63,128|63&Fd],this._pos_),this._pos_+=4)}},Fa.writeUTFString=function(Fa){var Fb=this.pos;this.writeUint16(1),this.writeUTFBytes(Fa);var Fc=this.pos-Fb-2;if(65536<=Fc)throw"writeUTFString byte len more than 65536";this._d_.setUint16(Fb,Fc,this._xd_)},Fa.readUTFString=function(){return this.readUTFBytes(this.getUint16())},Fa.getUTFString=function(){return this.readUTFString()},Fa.readUTFBytes=function(Fa){if(void 0===Fa&&(Fa=-1),0==Fa)return"";var Fb=this.bytesAvailable;if(Fb<Fa)throw"readUTFBytes error - Out of bounds";return Fa=0<Fa?Fa:Fb,this.rUTF(Fa)},Fa.getUTFBytes=function(Fa){return void 0===Fa&&(Fa=-1),this.readUTFBytes(Fa)},Fa.writeByte=function(Fa){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,Fa),this._pos_+=1},Fa.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},Fa.getByte=function(){return this.readByte()},Fa.ensureWrite=function(Fa){this._length<Fa&&(this._length=Fa),this._allocated_<Fa&&(this.length=Fa)},Fa.writeArrayBuffer=function(Fa,Fb,Fc){if(void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),Fb<0||Fc<0)throw"writeArrayBuffer error - Out of bounds";0==Fc&&(Fc=Fa.byteLength-Fb),this.ensureWrite(this._pos_+Fc);var Fd=new Uint8Array(Fa);this._u8d_.set(Fd.subarray(Fb,Fb+Fc),this._pos_),this._pos_+=Fc},Fm(0,Fa,"buffer",function(){var Fa=this._d_.buffer;return Fa.byteLength==this.length?Fa:Fa.slice(0,this.length)}),Fm(0,Fa,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(Fa){this._xd_="littleEndian"==Fa}),Fm(0,Fa,"length",function(){return this._length},function(Fa){this._allocated_<Fa?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(Fa,2*this._allocated_))):this._allocated_>Fa&&this.___resizeBuffer(this._allocated_=Fa),this._length=Fa}),Fm(0,Fa,"pos",function(){return this._pos_},function(Fa){this._pos_=Fa}),Fm(0,Fa,"bytesAvailable",function(){return this._length-this._pos_}),Fb.getSystemEndian=function(){if(!Fb._sysEndian){var Fa=new ArrayBuffer(2);new DataView(Fa).setInt16(0,256,!0),Fb._sysEndian=256===new Int16Array(Fa)[0]?"littleEndian":"bigEndian"}return Fb._sysEndian},Fb.BIG_ENDIAN="bigEndian",Fb.LITTLE_ENDIAN="littleEndian",Fb._sysEndian=null,Fb}(),FQ=function(){function Fe(){}return Fr(Fe,"laya.utils.CacheManager"),Fe.regCacheByFunction=function(Fa,Fb){var Fc;Fe.unRegCacheByFunction(Fa,Fb),Fc={tryDispose:Fa,getCacheList:Fb},Fe._cacheList.push(Fc)},Fe.unRegCacheByFunction=function(Fa,Fb){var Fc,Fd=0;for(Fc=Fe._cacheList.length,Fd=0;Fd<Fc;Fd++)if(Fe._cacheList[Fd].tryDispose==Fa&&Fe._cacheList[Fd].getCacheList==Fb)return void Fe._cacheList.splice(Fd,1)},Fe.forceDispose=function(){var Fa=0,Fb=Fe._cacheList.length;for(Fa=0;Fa<Fb;Fa++)Fe._cacheList[Fa].tryDispose(!0)},Fe.beginCheck=function(Fa){void 0===Fa&&(Fa=15e3),Fz.timer.loop(Fa,null,Fe._checkLoop)},Fe.stopCheck=function(){Fz.timer.clear(null,Fe._checkLoop)},Fe._checkLoop=function(){var Fa=Fe._cacheList;if(!(Fa.length<1)){var Fb,Fc=FO.now(),Fd=0;for(Fb=Fd=Fa.length;0<Fd&&(Fa[Fe._index=++Fe._index%Fb].tryDispose(!1),!(FO.now()-Fc>Fe.loopTimeLimit));)Fd--}},Fe.loopTimeLimit=2,Fe._cacheList=[],Fe._index=0,Fe}(),FR=function(){function Fp(){}return Fr(Fp,"laya.utils.ClassUtils"),Fp.regClass=function(Fa,Fb){Fp._classMap[Fa]=Fb},Fp.getRegClass=function(Fa){return Fp._classMap[Fa]},Fp.getInstance=function(Fa){var Fb=Fp.getClass(Fa);return Fb?new Fb:(console.warn("[error] Undefined class:",Fa),null)},Fp.createByJson=function(Fa,Fb,Fc,Fd,Fe){"string"==typeof Fa&&(Fa=JSON.parse(Fa));var Ff=Fa.props;if(!Fb&&!(Fb=Fe?Fe.runWith(Fa):Fp.getInstance(Ff.runtime||Fa.type)))return null;var Fg=Fa.child;if(Fg)for(var Fh=0,Fi=Fg.length;Fh<Fi;Fh++){var Fj=Fg[Fh];if("render"!==Fj.props.name&&"render"!==Fj.props.renderType||!Fb._$set_itemRender)if("Graphic"==Fj.type)Fp.addGraphicsToSprite(Fj,Fb);else if(Fp.isDrawType(Fj.type))Fp.addGraphicToSprite(Fj,Fb,!0);else{var Fm=Fp.createByJson(Fj,null,Fc,Fd,Fe);"Script"==Fj.type?Fm.hasOwnProperty("owner")?Fm.owner=Fb:Fm.hasOwnProperty("target")&&(Fm.target=Fb):"mask"==Fj.props.renderType?Fb.mask=Fm:Fb.addChild(Fm)}else Fb.itemRender=Fj}if(Ff)for(var Fn in Ff){var Fo=Ff[Fn];"var"===Fn&&Fc?Fc[Fo]=Fb:Fo instanceof Array&&"function"==typeof Fb[Fn]?Fb[Fn].apply(Fb,Fo):Fb[Fn]=Fo}return Fd&&Fa.customProps&&Fd.runWith([Fb,Fa]),Fb.created&&Fb.created(),Fb},Fp.addGraphicsToSprite=function(Fa,Fb){var Fc;if((Fc=Fa.child)&&!(Fc.length<1)){var Fd;Fd=Fp._getGraphicsFromSprite(Fa,Fb);var Fe=0,Ff=0;Fa.props&&(Fe=Fp._getObjVar(Fa.props,"x",0),Ff=Fp._getObjVar(Fa.props,"y",0)),0!=Fe&&0!=Ff&&Fd.translate(Fe,Ff);var Fg,Fh=0;for(Fg=Fc.length,Fh=0;Fh<Fg;Fh++)Fp._addGraphicToGraphics(Fc[Fh],Fd);0!=Fe&&0!=Ff&&Fd.translate(-Fe,-Ff)}},Fp.addGraphicToSprite=function(Fa,Fb,Fc){var Fd;void 0===Fc&&(Fc=!1),Fd=Fc?Fp._getGraphicsFromSprite(Fa,Fb):Fb.graphics,Fp._addGraphicToGraphics(Fa,Fd)},Fp._getGraphicsFromSprite=function(Fa,Fb){var Fc,Fd;if(!Fa||!Fa.props)return Fb.graphics;switch(Fd=Fa.props.renderType){case"hit":case"unHit":var Fe;Fb.hitArea||(Fb.hitArea=new FV),(Fe=Fb.hitArea)[Fd]||(Fe[Fd]=new Fo),Fc=Fe[Fd]}return Fc||(Fc=Fb.graphics),Fc},Fp._getTransformData=function(Fa){var Fb;(Fa.hasOwnProperty("pivotX")||Fa.hasOwnProperty("pivotY"))&&(Fb=Fb||new FG).translate(-Fp._getObjVar(Fa,"pivotX",0),-Fp._getObjVar(Fa,"pivotY",0));var Fc=Fp._getObjVar(Fa,"scaleX",1),Fd=Fp._getObjVar(Fa,"scaleY",1),Fe=Fp._getObjVar(Fa,"rotation",0);Fp._getObjVar(Fa,"skewX",0),Fp._getObjVar(Fa,"skewY",0);return 1==Fc&&1==Fd&&0==Fe||((Fb=Fb||new FG).scale(Fc,Fd),Fb.rotate(.0174532922222222*Fe)),Fb},Fp._addGraphicToGraphics=function(Fa,Fb){var Fc,Fd;if((Fc=Fa.props)&&(Fd=Fp.DrawTypeDic[Fa.type])){var Fe,Ff;Fe=Fb;var Fg=Fp._getParams(Fc,Fd[1],Fd[2],Fd[3]);((Ff=Fp._tM)||1!=Fp._alpha)&&(Fe.save(),Ff&&Fe.transform(Ff),1!=Fp._alpha&&Fe.alpha(Fp._alpha)),Fe[Fd[0]].apply(Fe,Fg),(Ff||1!=Fp._alpha)&&Fe.restore()}},Fp._adptLineData=function(Fa){return Fa[2]=parseFloat(Fa[0])+parseFloat(Fa[2]),Fa[3]=parseFloat(Fa[1])+parseFloat(Fa[3]),Fa},Fp._adptTextureData=function(Fa){return Fa[0]=Fha.getRes(Fa[0]),Fa},Fp._adptLinesData=function(Fa){return Fa[2]=Fp._getPointListByStr(Fa[2]),Fa},Fp.isDrawType=function(Fa){return"Image"!=Fa&&Fp.DrawTypeDic.hasOwnProperty(Fa)},Fp._getParams=function(Fa,Fb,Fc,Fd){var Fe;void 0===Fc&&(Fc=0),(Fe=Fp._temParam).length=Fb.length;var Ff,Fg,Fh=0;for(Ff=Fb.length,Fh=0;Fh<Ff;Fh++)Fe[Fh]=Fp._getObjVar(Fa,Fb[Fh][0],Fb[Fh][1]);return Fp._alpha=Fp._getObjVar(Fa,"alpha",1),Fg=Fp._getTransformData(Fa),Fp._tM=Fg?(Fc||(Fc=0),Fg.translate(Fe[Fc],Fe[Fc+1]),Fe[Fc]=Fe[Fc+1]=0,Fg):null,Fd&&Fp[Fd]&&(Fe=Fp[Fd](Fe)),Fe},Fp._getPointListByStr=function(Fa){var Fb,Fc,Fd=0;for(Fc=(Fb=Fa.split(",")).length,Fd=0;Fd<Fc;Fd++)Fb[Fd]=parseFloat(Fb[Fd]);return Fb},Fp._getObjVar=function(Fa,Fb,Fc){return Fa.hasOwnProperty(Fb)?Fa[Fb]:Fc},Fp._temParam=[],Fp._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},Fp.getClass=function(Fa){var Fb=Fp._classMap[Fa]||Fa;return"string"==typeof Fb?Fz.__classmap[Fb]:Fb},Fp._tM=null,Fp._alpha=NaN,Fi(Fp,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),Fp}(),FS=function(){function Ff(Fa){if(this._color=[],"string"==typeof Fa){null===(this.strColor=Fa)&&(Fa="#000000"),"#"==Fa.charAt(0)&&(Fa=Fa.substr(1));var Fb=Fa.length;if(3==Fb||4==Fb){for(var Fc="",Fd=0;Fd<Fb;Fd++)Fc+=Fa[Fd]+Fa[Fd];Fa=Fc}var Fe=this.numColor=parseInt(Fa,16);if(8==Fa.length)return void(this._color=[parseInt(Fa.substr(0,2),16)/255,((16711680&Fe)>>16)/255,((65280&Fe)>>8)/255,(255&Fe)/255])}else Fe=this.numColor=Fa,this.strColor=F$.toHexColor(Fe);this._color=[((16711680&Fe)>>16)/255,((65280&Fe)>>8)/255,(255&Fe)/255,1],this._color.__id=++Ff._COLODID}return Fr(Ff,"laya.utils.Color"),Ff._initDefault=function(){for(var Fa in Ff._DEFAULT={},Ff._COLOR_MAP)Ff._SAVE[Fa]=Ff._DEFAULT[Fa]=new Ff(Ff._COLOR_MAP[Fa]);return Ff._DEFAULT},Ff._initSaveMap=function(){for(var Fa in Ff._SAVE_SIZE=0,Ff._SAVE={},Ff._DEFAULT)Ff._SAVE[Fa]=Ff._DEFAULT[Fa]},Ff.create=function(Fa){var Fb=Ff._SAVE[Fa+""];return null!=Fb?Fb:(Ff._SAVE_SIZE<1e3||Ff._initSaveMap(),Ff._SAVE[Fa+""]=new Ff(Fa))},Ff._SAVE={},Ff._SAVE_SIZE=0,Ff._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},Ff._DEFAULT=Ff._initDefault(),Ff._COLODID=1,Ff}(),FT=(function(){function Fa(){this._values=[],this._keys=[]}Fr(Fa,"laya.utils.Dictionary");var Fb=Fa.prototype;Fb.set=function(Fa,Fb){var Fc=this.indexOf(Fa);0<=Fc?this._values[Fc]=Fb:(this._keys.push(Fa),this._values.push(Fb))},Fb.indexOf=function(Fa){var Fb=this._keys.indexOf(Fa);return 0<=Fb?Fb:(Fa="string"==typeof Fa?Number(Fa):"number"==typeof Fa?Fa.toString():Fa,this._keys.indexOf(Fa))},Fb.get=function(Fa){var Fb=this.indexOf(Fa);return Fb<0?null:this._values[Fb]},Fb.remove=function(Fa){var Fb=this.indexOf(Fa);return 0<=Fb&&(this._keys.splice(Fb,1),this._values.splice(Fb,1),!0)},Fb.clear=function(){this._values.length=0,this._keys.length=0},Fm(0,Fb,"values",function(){return this._values}),Fm(0,Fb,"keys",function(){return this._keys})}(),function(){function Fa(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}Fr(Fa,"laya.utils.Dragging");var Fb=Fa.prototype;return Fb.start=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){void 0===Fh&&(Fh=.92),this.clearTimer(),this.target=Fa,this.area=Fb,this.hasInertia=Fc,this.elasticDistance=Fb?Fd:0,this.elasticBackTime=Fe,this.data=Ff,this._disableMouseEvent=Fg,this.ratio=Fh,1!=Fa.globalScaleX||1!=Fa.globalScaleY?this._parent=Fa.parent:this._parent=Fz.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,Fz.stage.on("mouseup",this,this.onStageMouseUp),Fz.stage.on("mouseout",this,this.onStageMouseUp),Fz.timer.frameLoop(1,this,this.loop)},Fb.clearTimer=function(){Fz.timer.clear(this,this.loop),Fz.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},Fb.stop=function(){this._dragging&&(Fq.instance.disableMouseEvent=!1,Fz.stage.off("mouseup",this,this.onStageMouseUp),Fz.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},Fb.loop=function(){var Fa=this._parent.getMousePoint(),Fb=Fa.x,Fc=Fa.y,Fd=Fb-this._lastX,Fe=Fc-this._lastY;if(this._clickOnly){if(!(1<Math.abs(Fd*Fz.stage._canvasTransform.getScaleX())||1<Math.abs(Fe*Fz.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),Fq.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(Fd,Fe);0==Fd&&0==Fe||(this._lastX=Fb,this._lastY=Fc,this.target.x+=Fd*this._elasticRateX,this.target.y+=Fe*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},Fb.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var Fa=this.area.x-this.target.x;else Fa=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-Fa/this.elasticDistance),this.target.y<this.area.y)var Fb=this.area.y-this.target.y;else Fb=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-Fb/this.elasticDistance)}},Fb.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},Fb.onStageMouseUp=function(Fa){if(Fq.instance.disableMouseEvent=!1,Fz.stage.off("mouseup",this,this.onStageMouseUp),Fz.stage.off("mouseout",this,this.onStageMouseUp),Fz.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var Fb=this._offsets.length,Fc=Math.min(Fb,6),Fd=this._offsets.length-Fc,Fe=Fb-1;Fd<Fe;Fe--)this._offsetY+=this._offsets[Fe--],this._offsetX+=this._offsets[Fe];this._offsetX=this._offsetX/Fc*2,this._offsetY=this._offsetY/Fc*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),Fz.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},Fb.checkElastic=function(){var Fa=NaN,Fb=NaN;if(this.target.x<this.area.x?Fa=this.area.x:this.target.x>this.area.x+this.area.width&&(Fa=this.area.x+this.area.width),this.target.y<this.area.y?Fb=this.area.y:this.target.y>this.area.y+this.area.height&&(Fb=this.area.y+this.area.height),isNaN(Fa)&&isNaN(Fb))this.clear();else{var Fc={};isNaN(Fa)||(Fc.x=Fa),isNaN(Fb)||(Fc.y=Fb),this._tween=FZ.to(this.target,Fc,this.elasticBackTime,FU.sineOut,Fu.create(this,this.clear),0,!1,!1)}},Fb.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(Fz.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},Fb.clear=function(){if(this.target){this.clearTimer();var Fa=this.target;this.target=null,this._parent=null,Fa.event("dragend",this.data)}},Fa}()),FU=function(){function Fh(){}return Fr(Fh,"laya.utils.Ease"),Fh.linearNone=function(Fa,Fb,Fc,Fd){return Fc*Fa/Fd+Fb},Fh.linearIn=function(Fa,Fb,Fc,Fd){return Fc*Fa/Fd+Fb},Fh.linearInOut=function(Fa,Fb,Fc,Fd){return Fc*Fa/Fd+Fb},Fh.linearOut=function(Fa,Fb,Fc,Fd){return Fc*Fa/Fd+Fb},Fh.bounceIn=function(Fa,Fb,Fc,Fd){return Fc-Fh.bounceOut(Fd-Fa,0,Fc,Fd)+Fb},Fh.bounceInOut=function(Fa,Fb,Fc,Fd){return Fa<.5*Fd?.5*Fh.bounceIn(2*Fa,0,Fc,Fd)+Fb:.5*Fh.bounceOut(2*Fa-Fd,0,Fc,Fd)+.5*Fc+Fb},Fh.bounceOut=function(Fa,Fb,Fc,Fd){return(Fa/=Fd)<1/2.75?Fc*(7.5625*Fa*Fa)+Fb:Fa<2/2.75?Fc*(7.5625*(Fa-=1.5/2.75)*Fa+.75)+Fb:Fa<2.5/2.75?Fc*(7.5625*(Fa-=2.25/2.75)*Fa+.9375)+Fb:Fc*(7.5625*(Fa-=2.625/2.75)*Fa+.984375)+Fb},Fh.backIn=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fe&&(Fe=1.70158),Fc*(Fa/=Fd)*Fa*((Fe+1)*Fa-Fe)+Fb},Fh.backInOut=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fe&&(Fe=1.70158),(Fa/=.5*Fd)<1?.5*Fc*(Fa*Fa*((1+(Fe*=1.525))*Fa-Fe))+Fb:Fc/2*((Fa-=2)*Fa*((1+(Fe*=1.525))*Fa+Fe)+2)+Fb},Fh.backOut=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fe&&(Fe=1.70158),Fc*((Fa=Fa/Fd-1)*Fa*((Fe+1)*Fa+Fe)+1)+Fb},Fh.elasticIn=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg;return void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=0),0==Fa?Fb:1==(Fa/=Fd)?Fb+Fc:(Ff||(Ff=.3*Fd),Fg=!Fe||0<Fc&&Fe<Fc||Fc<0&&Fe<-Fc?(Fe=Fc,Ff/4):Ff/Fh.PI2*Math.asin(Fc/Fe),-Fe*Math.pow(2,10*(Fa-=1))*Math.sin((Fa*Fd-Fg)*Fh.PI2/Ff)+Fb)},Fh.elasticInOut=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg;return void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=0),0==Fa?Fb:2==(Fa/=.5*Fd)?Fb+Fc:(Ff||(Ff=Fd*(.3*1.5)),Fg=!Fe||0<Fc&&Fe<Fc||Fc<0&&Fe<-Fc?(Fe=Fc,Ff/4):Ff/Fh.PI2*Math.asin(Fc/Fe),Fa<1?Fe*Math.pow(2,10*(Fa-=1))*Math.sin((Fa*Fd-Fg)*Fh.PI2/Ff)*-.5+Fb:Fe*Math.pow(2,-10*(Fa-=1))*Math.sin((Fa*Fd-Fg)*Fh.PI2/Ff)*.5+Fc+Fb)},Fh.elasticOut=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg;return void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=0),0==Fa?Fb:1==(Fa/=Fd)?Fb+Fc:(Ff||(Ff=.3*Fd),Fg=!Fe||0<Fc&&Fe<Fc||Fc<0&&Fe<-Fc?(Fe=Fc,Ff/4):Ff/Fh.PI2*Math.asin(Fc/Fe),Fe*Math.pow(2,-10*Fa)*Math.sin((Fa*Fd-Fg)*Fh.PI2/Ff)+Fc+Fb)},Fh.strongIn=function(Fa,Fb,Fc,Fd){return Fc*(Fa/=Fd)*Fa*Fa*Fa*Fa+Fb},Fh.strongInOut=function(Fa,Fb,Fc,Fd){return(Fa/=.5*Fd)<1?.5*Fc*Fa*Fa*Fa*Fa*Fa+Fb:.5*Fc*((Fa-=2)*Fa*Fa*Fa*Fa+2)+Fb},Fh.strongOut=function(Fa,Fb,Fc,Fd){return Fc*((Fa=Fa/Fd-1)*Fa*Fa*Fa*Fa+1)+Fb},Fh.sineInOut=function(Fa,Fb,Fc,Fd){return.5*-Fc*(Math.cos(Math.PI*Fa/Fd)-1)+Fb},Fh.sineIn=function(Fa,Fb,Fc,Fd){return-Fc*Math.cos(Fa/Fd*Fh.HALF_PI)+Fc+Fb},Fh.sineOut=function(Fa,Fb,Fc,Fd){return Fc*Math.sin(Fa/Fd*Fh.HALF_PI)+Fb},Fh.quintIn=function(Fa,Fb,Fc,Fd){return Fc*(Fa/=Fd)*Fa*Fa*Fa*Fa+Fb},Fh.quintInOut=function(Fa,Fb,Fc,Fd){return(Fa/=.5*Fd)<1?.5*Fc*Fa*Fa*Fa*Fa*Fa+Fb:.5*Fc*((Fa-=2)*Fa*Fa*Fa*Fa+2)+Fb},Fh.quintOut=function(Fa,Fb,Fc,Fd){return Fc*((Fa=Fa/Fd-1)*Fa*Fa*Fa*Fa+1)+Fb},Fh.quartIn=function(Fa,Fb,Fc,Fd){return Fc*(Fa/=Fd)*Fa*Fa*Fa+Fb},Fh.quartInOut=function(Fa,Fb,Fc,Fd){return(Fa/=.5*Fd)<1?.5*Fc*Fa*Fa*Fa*Fa+Fb:.5*-Fc*((Fa-=2)*Fa*Fa*Fa-2)+Fb},Fh.quartOut=function(Fa,Fb,Fc,Fd){return-Fc*((Fa=Fa/Fd-1)*Fa*Fa*Fa-1)+Fb},Fh.cubicIn=function(Fa,Fb,Fc,Fd){return Fc*(Fa/=Fd)*Fa*Fa+Fb},Fh.cubicInOut=function(Fa,Fb,Fc,Fd){return(Fa/=.5*Fd)<1?.5*Fc*Fa*Fa*Fa+Fb:.5*Fc*((Fa-=2)*Fa*Fa+2)+Fb},Fh.cubicOut=function(Fa,Fb,Fc,Fd){return Fc*((Fa=Fa/Fd-1)*Fa*Fa+1)+Fb},Fh.quadIn=function(Fa,Fb,Fc,Fd){return Fc*(Fa/=Fd)*Fa+Fb},Fh.quadInOut=function(Fa,Fb,Fc,Fd){return(Fa/=.5*Fd)<1?.5*Fc*Fa*Fa+Fb:.5*-Fc*(--Fa*(Fa-2)-1)+Fb},Fh.quadOut=function(Fa,Fb,Fc,Fd){return-Fc*(Fa/=Fd)*(Fa-2)+Fb},Fh.expoIn=function(Fa,Fb,Fc,Fd){return 0==Fa?Fb:Fc*Math.pow(2,10*(Fa/Fd-1))+Fb-.001*Fc},Fh.expoInOut=function(Fa,Fb,Fc,Fd){return 0==Fa?Fb:Fa==Fd?Fb+Fc:(Fa/=.5*Fd)<1?.5*Fc*Math.pow(2,10*(Fa-1))+Fb:.5*Fc*(2-Math.pow(2,-10*--Fa))+Fb},Fh.expoOut=function(Fa,Fb,Fc,Fd){return Fa==Fd?Fb+Fc:Fc*(1-Math.pow(2,-10*Fa/Fd))+Fb},Fh.circIn=function(Fa,Fb,Fc,Fd){return-Fc*(Math.sqrt(1-(Fa/=Fd)*Fa)-1)+Fb},Fh.circInOut=function(Fa,Fb,Fc,Fd){return(Fa/=.5*Fd)<1?.5*-Fc*(Math.sqrt(1-Fa*Fa)-1)+Fb:.5*Fc*(Math.sqrt(1-(Fa-=2)*Fa)+1)+Fb},Fh.circOut=function(Fa,Fb,Fc,Fd){return Fc*Math.sqrt(1-(Fa=Fa/Fd-1)*Fa)+Fb},Fh.HALF_PI=.5*Math.PI,Fh.PI2=2*Math.PI,Fh}(),FV=function(){function Fn(){this._hit=null,this._unHit=null}Fr(Fn,"laya.utils.HitArea");var Fa=Fn.prototype;return Fa.isHit=function(Fa,Fb){return!!Fn.isHitGraphic(Fa,Fb,this.hit)&&!Fn.isHitGraphic(Fa,Fb,this.unHit)},Fa.contains=function(Fa,Fb){return this.isHit(Fa,Fb)},Fm(0,Fa,"hit",function(){return this._hit||(this._hit=new Fo),this._hit},function(Fa){this._hit=Fa}),Fm(0,Fa,"unHit",function(){return this._unHit||(this._unHit=new Fo),this._unHit},function(Fa){this._unHit=Fa}),Fn.isHitGraphic=function(Fa,Fb,Fc){if(!Fc)return!1;var Fd;if(!(Fd=Fc.cmds)&&Fc._one&&((Fd=Fn._cmds).length=1,Fd[0]=Fc._one),!Fd)return!1;var Fe,Ff,Fg=0;for(Fe=Fd.length,Fg=0;Fg<Fe;Fg++)if(Ff=Fd[Fg]){var Fh=FJ._context;switch(Ff.callee){case Fh._translate:case 6:Fa-=Ff[0],Fb-=Ff[1]}if(Fn.isHitCmd(Fa,Fb,Ff))return!0}return!1},Fn.isHitCmd=function(Fa,Fb,Fc){if(!Fc)return!1;var Fd=FJ._context,Fe=!1;switch(Fc.callee){case Fd._drawRect:case 13:Fn._rec.setTo(Fc[0],Fc[1],Fc[2],Fc[3]),Fe=Fn._rec.contains(Fa,Fb);break;case Fd._drawCircle:case Fd._fillCircle:case 14:Fe=(Fa-=Fc[0])*Fa+(Fb-=Fc[1])*Fb<Fc[2]*Fc[2];break;case Fd._drawPoly:case 18:Fa-=Fc[0],Fb-=Fc[1],Fe=Fn.ptInPolygon(Fa,Fb,Fc[2])}return Fe},Fn.ptInPolygon=function(Fa,Fb,Fc){var Fd;(Fd=Fn._ptPoint).setTo(Fa,Fb);var Fe,Ff=0,Fg=NaN,Fh=NaN,Fi=NaN,Fj=NaN;Fe=Fc.length;for(var Fm=0;Fm<Fe;Fm+=2){if(Fg=Fc[Fm],Fh=Fc[Fm+1],Fi=Fc[(Fm+2)%Fe],Fh!=(Fj=Fc[(Fm+3)%Fe]))if(!(Fd.y<Math.min(Fh,Fj)))if(!(Fd.y>=Math.max(Fh,Fj)))(Fd.y-Fh)*(Fi-Fg)/(Fj-Fh)+Fg>Fd.x&&Ff++}return Ff%2==1},Fn._cmds=[],Fi(Fn,["_rec",function(){return this._rec=new FB},"_ptPoint",function(){return this._ptPoint=new FA}]),Fn}(),FW=(function(){function Fe(Fa,Fb,Fc,Fd){this.char=Fa,this.charNum=Fa.charCodeAt(0),this._x=this._y=0,this.width=Fb,this.height=Fc,this.style=Fd,this.isWord=!Fe._isWordRegExp.test(Fa)}Fr(Fe,"laya.utils.HTMLChar");var Fa=Fe.prototype;Fz.imps(Fa,{"laya.display.ILayout":!0}),Fa.setSprite=function(Fa){this._sprite=Fa},Fa.getSprite=function(){return this._sprite},Fa._isChar=function(){return!0},Fa._getCSSStyle=function(){return this.style},Fm(0,Fa,"width",function(){return this._w},function(Fa){this._w=Fa}),Fm(0,Fa,"x",function(){return this._x},function(Fa){this._sprite&&(this._sprite.x=Fa),this._x=Fa}),Fm(0,Fa,"y",function(){return this._y},function(Fa){this._sprite&&(this._sprite.y=Fa),this._y=Fa}),Fm(0,Fa,"height",function(){return this._h},function(Fa){this._h=Fa}),Fe._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function Fb(){}Fr(Fb,"laya.utils.Log"),Fb.enable=function(){Fb._logdiv||(Fb._logdiv=FO.window.document.createElement("div"),FO.window.document.body.appendChild(Fb._logdiv),Fb._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},Fb.toggle=function(){var Fa=Fb._logdiv.style;"1px"==Fa.width?Fa.width=Fa.height="50%":Fa.width=Fa.height="1px"},Fb.print=function(Fa){Fb._logdiv&&(Fb.maxCount<=Fb._count&&Fb.clear(),Fb._count++,Fb._logdiv.innerText+=Fa+"\n",Fb._logdiv.scrollTop=Fb._logdiv.scrollHeight)},Fb.clear=function(){Fb._logdiv.innerText="",Fb._count=0},Fb._logdiv=null,Fb._count=0,Fb.maxCount=20}(),function(){function Fb(){}Fr(Fb,"laya.utils.Mouse"),Fm(1,Fb,"cursor",function(){return Fb._style.cursor},function(Fa){Fb._style.cursor=Fa}),Fb.hide=function(){"none"!=Fb.cursor&&(Fb._preCursor=Fb.cursor,Fb.cursor="none")},Fb.show=function(){"none"==Fb.cursor&&(Fb.cursor=Fb._preCursor?Fb._preCursor:"auto")},Fb._preCursor=null,Fi(Fb,["_style",function(){return this._style=FO.document.body.style}])}(),function(){function Ff(){}return Fr(Ff,"laya.utils.Pool"),Ff.getPoolBySign=function(Fa){return Ff._poolDic[Fa]||(Ff._poolDic[Fa]=[])},Ff.clearBySign=function(Fa){Ff._poolDic[Fa]&&(Ff._poolDic[Fa].length=0)},Ff.recover=function(Fa,Fb){Fb.__InPool||(Fb.__InPool=!0,Ff.getPoolBySign(Fa).push(Fb))},Ff.getItemByClass=function(Fa,Fb){var Fc=Ff.getPoolBySign(Fa),Fd=Fc.length?Fc.pop():new Fb;return Fd.__InPool=!1,Fd},Ff.getItemByCreateFun=function(Fa,Fb,Fc){var Fd=Ff.getPoolBySign(Fa),Fe=Fd.length?Fd.pop():Fb.call(Fc);return Fe.__InPool=!1,Fe},Ff.getItem=function(Fa){var Fb=Ff.getPoolBySign(Fa),Fc=Fb.length?Fb.pop():null;return Fc&&(Fc.__InPool=!1),Fc},Ff._poolDic={},Ff.InPoolSign="__InPool",Ff}()),FX=function(){function Fi(){}return Fr(Fi,"laya.utils.Stat"),Fm(1,Fi,"onclick",null,function(Fa){Fi._sp&&Fi._sp.on("click",Fi._sp,Fa),Fi._canvas&&(Fi._canvas.source.onclick=Fa,Fi._canvas.source.style.pointerEvents="")}),Fi.show=function(Fa,Fb,Fc){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),!FJ.isConchApp||FJ.isConchWebGL){if(FJ.isConchWebGL||FO.onMiniGame||FO.onLimixiu||(Fi._useCanvas=!0),Fi._show=!0,Fi._fpsData.length=60,Fi._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},Fi._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},Fi._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},Fi._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},FJ.isWebGL)if(Fi._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},FJ.is3DMode){if(Fi._view[0].title="FPS(3D)",Fi._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},Fi._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},Fi._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==Fc){var Fd=8;Fi._view[Fd++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},Fi._view[Fd++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Fi._view[Fd++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},Fi._view[Fd++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Fi._view[Fd++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Fi._view[Fd++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Fi._view[Fd++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Fi._view[Fd++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},Fi._view[Fd++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==Fc){Fd=8;Fi._view[Fd++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},Fi._view[Fd++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},Fi._view[Fd++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},Fi._view[Fd++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},Fi._view[Fd++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},Fi._view[Fd++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},Fi._view[Fd++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else Fi._view[0].title="FPS(WebGL)",Fi._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else Fi._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};Fi._useCanvas?Fi.createUIPre(Fa,Fb):Fi.createUI(Fa,Fb),Fi.enable()}else FO.window.conch.showFPS&&FO.window.conch.showFPS(Fa,Fb)},Fi.createUIPre=function(Fa,Fb){var Fc=FO.pixelRatio;Fi._width=170*Fc,Fi._vx=75*Fc,Fi._height=Fc*(12*Fi._view.length+3*Fc)+4,Fi._fontSize=12*Fc;for(var Fd=0;Fd<Fi._view.length;Fd++)Fi._view[Fd].x=4,Fi._view[Fd].y=Fd*Fi._fontSize+2*Fc;Fi._canvas||((Fi._canvas=new Fva("2D")).size(Fi._width,Fi._height),(Fi._ctx=Fi._canvas.getContext("2d")).textBaseline="top",Fi._ctx.font=Fi._fontSize+"px Sans-serif",Fi._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+Fa+"px;top:"+Fb+"px;width:"+Fi._width/Fc+"px;height:"+Fi._height/Fc+"px;"),Fi._first=!0,Fi.loop(),Fi._first=!1,FO.container.appendChild(Fi._canvas.source)},Fi.createUI=function(Fa,Fb){var Fc=Fi._sp,Fd=FO.pixelRatio;Fc||(Fc=new Fna,(Fi._leftText=new Fsa).pos(5,5),Fi._leftText.color="#ffffff",Fc.addChild(Fi._leftText),(Fi._txt=new Fsa).pos(80*Fd,5),Fi._txt.color="#ffffff",Fc.addChild(Fi._txt),Fi._sp=Fc),Fc.pos(Fa,Fb);for(var Fe="",Ff=0;Ff<Fi._view.length;Ff++){Fe+=Fi._view[Ff].title+"\n"}Fi._leftText.text=Fe;var Fg=170*Fd,Fh=Fd*(12*Fi._view.length+3*Fd)+4;Fi._txt.fontSize=Fi._fontSize*Fd,Fi._leftText.fontSize=Fi._fontSize*Fd,Fc.size(Fg,Fh),Fc.graphics.clear(),Fc.graphics.setAlpha(.5),Fc.graphics.drawRect(0,0,Fg,Fh,"#999999"),Fc.graphics.setAlpha(1),Fi.loop()},Fi.enable=function(){Fz.timer.frameLoop(1,Fi,Fi.loop)},Fi.hide=function(){Fi._show=!1,Fz.timer.clear(Fi,Fi.loop),Fi._canvas&&FO.removeElement(Fi._canvas.source)},Fi.clear=function(){Fi.trianglesFaces=Fi.drawCall=Fi.shaderCall=Fi.spriteCount=Fi.spriteRenderUseCacheCount=Fi.treeNodeCollision=Fi.treeSpriteCollision=Fi.canvasNormal=Fi.canvasBitmap=Fi.canvasReCache=0},Fi.loop=function(){Fi._count++;var Fa=FO.now();if(!(Fa-Fi._timer<1e3)){var Fb=Fi._count;if(Fi.FPS=Math.round(1e3*Fb/(Fa-Fi._timer)),Fi._show){Fi.trianglesFaces=Math.round(Fi.trianglesFaces/Fb),Fi.spriteCount=Fi._useCanvas?(Fi.drawCall=Math.round(Fi.drawCall/Fb)-2,Fi.shaderCall=Math.round(Fi.shaderCall/Fb),Math.round(Fi.spriteCount/Fb)-1):(Fi.drawCall=Math.round(Fi.drawCall/Fb)-2,Fi.shaderCall=Math.round(Fi.shaderCall/Fb)-4,Math.round(Fi.spriteCount/Fb)-4),Fi.spriteRenderUseCacheCount=Math.round(Fi.spriteRenderUseCacheCount/Fb),Fi.canvasNormal=Math.round(Fi.canvasNormal/Fb),Fi.canvasBitmap=Math.round(Fi.canvasBitmap/Fb),Fi.canvasReCache=Math.ceil(Fi.canvasReCache/Fb),Fi.treeNodeCollision=Math.round(Fi.treeNodeCollision/Fb),Fi.treeSpriteCollision=Math.round(Fi.treeSpriteCollision/Fb);var Fc=0<Fi.FPS?Math.floor(1e3/Fi.FPS).toString():" ";Fi._fpsStr=Fi.FPS+(Fi.renderSlow?" slow":"")+" "+Fc,Fi._spriteStr=Fi.spriteCount+(Fi.spriteRenderUseCacheCount?"/"+Fi.spriteRenderUseCacheCount:""),Fi._canvasStr=Fi.canvasReCache+"/"+Fi.canvasNormal+"/"+Fi.canvasBitmap,Fi.currentMemorySize=FN.systemResourceManager.memorySize,Fi._useCanvas?Fi.renderInfoPre():Fi.renderInfo(),Fi.clear()}Fi._count=0,Fi._timer=Fa}},Fi.renderInfoPre=function(){if(Fi._canvas){var Fa=Fi._ctx;Fa.clearRect(Fi._first?0:Fi._vx,0,Fi._width,Fi._height);for(var Fb=FJ.WebGL.mainContext,Fc=0;Fc<Fi._view.length;Fc++){var Fd=Fi._view[Fc];Fi._first&&(Fa.fillStyle="white",Fa.fillText(Fd.title,Fd.x,Fd.y,null,null,null)),Fa.fillStyle=Fd.color;var Fe=-1;if((Fd=Fi._view[Fc]).varying){if(Fb)switch(Fd.varying){case 1:Fe=Fb.getParameter(Fb[Fd.value]);break;case 2:Fe=Fb.getExtension(Fd.value)}}else Fe=Fi[Fd.value];"M"==Fd.units&&(Fe=Math.floor(Fe/1048576*100)/100+" M"),"K"==Fd.units&&(Fe=Math.floor(Fe/1024*100)/100+" K"),"string"==Fd.units&&(Fe=Fe.match(/\d+\.?\d/i)),Fa.fillText(Fe+"",Fd.x+Fi._vx,Fd.y,null,null,null)}}},Fi.renderInfo=function(){for(var Fa="",Fb=FJ.WebGL.mainContext,Fc=0;Fc<Fi._view.length;Fc++){var Fd=Fi._view[Fc],Fe=-1;if(Fd.varying){if(Fb)switch(Fd.varying){case 1:Fe=Fb.getParameter(Fb[Fd.value]);break;case 2:Fe=Fb.getExtension(Fd.value)}}else Fe=Fi[Fd.value];"M"==Fd.units&&(Fe=Math.floor(Fe/1048576*100)/100+" M"),"K"==Fd.units&&(Fe=Math.floor(Fe/1024*100)/100+" K"),"string"==Fd.units&&(Fe=Fe.match(/\d+\.?\d/i)),Fa+=Fe+"\n"}Fi._txt.text=Fa},Fi.FPS=0,Fi.loopCount=0,Fi.shaderCall=0,Fi.drawCall=0,Fi.trianglesFaces=0,Fi.spriteCount=0,Fi.spriteRenderUseCacheCount=0,Fi.treeNodeCollision=0,Fi.treeSpriteCollision=0,Fi.canvasNormal=0,Fi.canvasBitmap=0,Fi.canvasReCache=0,Fi.renderSlow=!1,Fi.currentMemorySize=0,Fi._fpsStr=null,Fi._canvasStr=null,Fi._spriteStr=null,Fi._fpsData=[],Fi._timer=0,Fi._count=0,Fi._view=[],Fi._fontSize=12,Fi._txt=null,Fi._leftText=null,Fi._sp=null,Fi._show=!1,Fi._useCanvas=!1,Fi._canvas=null,Fi._ctx=null,Fi._first=!1,Fi._vx=NaN,Fi._width=0,Fi._height=100,Fi}(),FY=(function(){function Fa(){this._strsToID={},this._idToStrs=[],this._length=0}Fr(Fa,"laya.utils.StringKey");var Fb=Fa.prototype;Fb.add=function(Fa){var Fb=this._strsToID[Fa];return null!=Fb?Fb:(this._idToStrs[this._length]=Fa,this._strsToID[Fa]=this._length++)},Fb.getID=function(Fa){var Fb=this._strsToID[Fa];return null==Fb?-1:Fb},Fb.getName=function(Fa){var Fb=this._idToStrs[Fa];return null==Fb?void 0:Fb}}(),function(){var Fj;function Fa(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}Fr(Fa,"laya.utils.Timer");var Fb=Fa.prototype;return Fb._init=function(){Fz.timer&&Fz.timer.frameLoop(1,this,this._update)},Fb._now=function(){return Date.now()},Fb._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var Fa=this.currFrame=this.currFrame+this.scale,Fb=this._now();this._delta=(Fb-this._lastTimer)*this.scale;var Fc=this.currTimer=this.currTimer+this._delta;Fz.isDebug&&6e4<Math.abs(Fb-this._lastTimer)&&console.error("系统时间错误！"+(Fb-this._lastTimer)),this._lastTimer=Fb;var Fd=this._handlers;for(Fg=this._count=0,Fh=Fd.length;Fg<Fh;Fg++)if(null!==(Fi=Fd[Fg]).method){var Fe=Fi.userFrame?Fa:Fc;if(Fe>=Fi.exeTime)if(Fi.repeat)if(Fi.jumpFrame)for(;Fe>=Fi.exeTime;)Fi.exeTime+=Fi.delay,Fi.run(!1);else Fi.exeTime+=Fi.delay,Fi.run(!1),Fe>Fi.exeTime&&(Fi.exeTime+=Math.ceil((Fe-Fi.exeTime)/Fi.delay)*Fi.delay);else Fi.run(!0)}else this._count++;(30<this._count||Fa%200==0)&&this._clearHandlers();for(var Ff=this._laters,Fg=0,Fh=Ff.length-1;Fg<=Fh;Fg++){var Fi=Ff[Fg];this._isIgnoreRecover(Fi)||(null!==Fi.method&&(delete this._map[Fi.key],Fi.run(!1)),this._recoverHandler(Fi)),Fg===Fh&&(Fh=Ff.length-1)}Ff.length=0}},Fb._clearHandlers=function(){for(var Fa=this._handlers,Fb=0,Fc=Fa.length;Fb<Fc;Fb++){var Fd=Fa[Fb];null!==Fd.method?this._temp.push(Fd):this._isIgnoreRecover(Fd)?this._temp.push(Fd):this._recoverHandler(Fd)}this._handlers=this._temp,this._temp=Fa,this._temp.length=0},Fb._recoverHandler=function(Fa){this._map[Fa.key]==Fa&&delete this._map[Fa.key],Fa.recover()},Fb._create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){if(!Fc)return Fe.apply(Fd,Ff),null;if(Fg){var Fi=this._getHandler(Fd,Fe);if(Fi)return Fi.repeat=Fb,Fi.userFrame=Fa,Fi.delay=Fc,Fi.ignoreRecover=Fh,Fi.caller=Fd,Fi.method=Fe,Fi.args=Ff,Fi.exeTime=Fc+(Fa?this.currFrame:this.currTimer+this._now()-this._lastTimer),Fi}return(Fi=Fj.create()).repeat=Fb,Fi.userFrame=Fa,Fi.delay=Fc,Fi.ignoreRecover=Fh,Fi.caller=Fd,Fi.method=Fe,Fi.args=Ff,Fi.exeTime=Fc+(Fa?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(Fi),this._handlers.push(Fi),Fi},Fb._indexHandler=function(Fa){var Fb=Fa.caller,Fc=Fa.method,Fd=Fb?Fb.$_GID||(Fb.$_GID=F$.getGID()):0,Fe=Fc.$_TID||(Fc.$_TID=this._mid++);Fa.key=Fd+"_"+Fe,this._map[Fa.key]=Fa},Fb.once=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=!0),this._create(!1,!1,Fa,Fb,Fc,Fd,Fe,!1)},Fb.loop=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){void 0===Fe&&(Fe=!0),void 0===Ff&&(Ff=!1),void 0===Fg&&(Fg=!1);var Fh=this._create(!1,!0,Fa,Fb,Fc,Fd,Fe,Fg);Fh&&(Fh.jumpFrame=Ff)},Fb.frameOnce=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=!0),this._create(!0,!1,Fa,Fb,Fc,Fd,Fe,!1)},Fb.frameLoop=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Fe&&(Fe=!0),void 0===Ff&&(Ff=!1),this._create(!0,!0,Fa,Fb,Fc,Fd,Fe,Ff)},Fb.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+Fj._freeCount},Fb.clear=function(Fa,Fb){var Fc=this._getHandler(Fa,Fb);return!(!Fc||this._isIgnoreRecover(Fc))&&(delete this._map[Fc.key],Fc.key=null,Fc.clear(),!0)},Fb.clearAll=function(Fa){if(Fa)for(var Fb=0,Fc=this._handlers.length;Fb<Fc;Fb++){var Fd=this._handlers[Fb];Fd.caller===Fa&&(this._isIgnoreRecover(Fd)||(delete this._map[Fd.key],Fd.key=null,Fd.clear()))}},Fb._getHandler=function(Fa,Fb){var Fc=Fa?Fa.$_GID||(Fa.$_GID=F$.getGID()):0,Fd=Fb.$_TID||(Fb.$_TID=this._mid++);return this._map[Fc+"_"+Fd]},Fb._isIgnoreRecover=function(Fa){if(Fa.ignoreRecover||Fa.caller&&"IgnoreRecover"==Fa.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var Fb="";try{arguments.propertyIsEnumerable.caller}catch(Fa){Fb=Fa.stack}Fz.recordError("报错：核心定时器销毁忽略  "+Fb)}return!0}return!1},Fb.hasHandler=function(Fa,Fb){return this._map[Fa.$_GID+"_"+Fb.$_TID]},Fb.callLater=function(Fa,Fb,Fc){if(null==this._getHandler(Fa,Fb)){var Fd=Fj.create();Fd.caller=Fa,Fd.method=Fb,Fd.args=Fc,this._indexHandler(Fd),this._laters.push(Fd)}},Fb.runCallLater=function(Fa,Fb){var Fc=this._getHandler(Fa,Fb);Fc&&null!=Fc.method&&(this._isIgnoreRecover(Fc)||(delete this._map[Fc.key],Fc.run(!0)))},Fb.runTimer=function(Fa,Fb){this.runCallLater(Fa,Fb)},Fm(0,Fb,"delta",function(){return this._delta}),Fa.__init$=function(){Fj=function(){function Fb(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}Fr(Fb,"");var Fa=Fb.prototype;return Fa.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},Fa.recover=function(){this.clear(),this.args=Fb._freeHandler,Fb._freeHandler=this,Fb._freeCount++},Fa.run=function(Fa){var Fb=this.caller;if(Fb&&Fb.destroyed)return this.clear();var Fc=this.method,Fd=this.args;Fa&&this.clear(),null!=Fc&&(Fd?Fc.apply(Fb,Fd):Fc.call(Fb))},Fb._freeHandler=null,Fb._freeCount=0,Fb.create=function(){var Fa=Fb._freeHandler;return Fa?(Fb._freeHandler=Fa.args,--Fb._freeCount,Fa.args=null,Fa):new Fb},Fb}()},Fa}()),FZ=function(){function Fn(){this.gid=0}Fr(Fn,"laya.utils.Tween");var Fa=Fn.prototype;return Fa.to=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){return void 0===Ff&&(Ff=0),void 0===Fg&&(Fg=!1),this._create(Fa,Fb,Fc,Fd,Fe,Ff,Fg,!0,!1,!0)},Fa.from=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){return void 0===Ff&&(Ff=0),void 0===Fg&&(Fg=!1),this._create(Fa,Fb,Fc,Fd,Fe,Ff,Fg,!1,!1,!0)},Fa._create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){if(!Fa)throw new Error("Tween:target is null");this._target=Fa,this._duration=Fc,this._ease=Fd||Fb.ease||Fn.easeNone,this._complete=Fe||Fb.complete,this._delay=Ff,this._props=[],this._usedTimer=0,this._startTimer=FO.now(),this._usedPool=Fi,this._delayParam=null,this.update=Fb.update;var Fm=Fa.$_GID||(Fa.$_GID=F$.getGID());return Fn.tweenMap[Fm]?(Fg&&Fn.clearTween(Fa),Fn.tweenMap[Fm].push(this)):Fn.tweenMap[Fm]=[this],Fj?Ff<=0?this.firstStart(Fa,Fb,Fh):(this._delayParam=[Fa,Fb,Fh],Fz.scaleTimer.once(Ff,this,this.firstStart,this._delayParam)):this._initProps(Fa,Fb,Fh),this},Fa.firstStart=function(Fa,Fb,Fc){this._delayParam=null,Fa.destroyed?this.clear():(this._initProps(Fa,Fb,Fc),this._beginLoop())},Fa._initProps=function(Fa,Fb,Fc){for(var Fd in Fb)if("number"==typeof Fa[Fd]){var Fe=Fc?Fa[Fd]:Fb[Fd],Ff=Fc?Fb[Fd]:Fa[Fd];this._props.push([Fd,Fe,Ff-Fe]),Fc||(Fa[Fd]=Fe)}},Fa._beginLoop=function(){Fz.scaleTimer.frameLoop(1,this,this._doEase)},Fa._doEase=function(){this._updateEase(FO.now())},Fa._updateEase=function(Fa){var Fb=this._target;if(Fb){if(Fb.destroyed)return Fn.clearTween(Fb);var Fc=this._usedTimer=Fa-this._startTimer-this._delay;if(!(Fc<0)){if(Fc>=this._duration)return this.complete();for(var Fd=0<Fc?this._ease(Fc,0,1,this._duration):0,Fe=this._props,Ff=0,Fg=Fe.length;Ff<Fg;Ff++){var Fh=Fe[Ff];Fb[Fh[0]]=Fh[1]+Fd*Fh[2]}this.update&&this.update.run()}}},Fa.complete=function(){if(this._target){Fz.scaleTimer.runTimer(this,this.firstStart);for(var Fa=this._target,Fb=this._props,Fc=this._complete,Fd=0,Fe=Fb.length;Fd<Fe;Fd++){var Ff=Fb[Fd];Fa[Ff[0]]=Ff[1]+Ff[2]}this.update&&this.update.run(),this.clear(),Fc&&Fc.run()}},Fa.pause=function(){Fz.scaleTimer.clear(this,this._beginLoop),Fz.scaleTimer.clear(this,this._doEase),Fz.scaleTimer.clear(this,this.firstStart);var Fa;(Fa=FO.now()-this._startTimer-this._delay)<0&&(this._usedTimer=Fa)},Fa.setStartTime=function(Fa){this._startTimer=Fa},Fa.clear=function(){this._target&&(this._remove(),this._clear())},Fa._clear=function(){this.pause(),Fz.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,FW.recover("tween",this))},Fa.recover=function(){this._usedPool=!0,this._clear()},Fa._remove=function(){var Fa=Fn.tweenMap[this._target.$_GID];if(Fa)for(var Fb=0,Fc=Fa.length;Fb<Fc;Fb++)if(Fa[Fb]===this){Fa.splice(Fb,1);break}},Fa.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=FO.now(),this._delayParam)Fz.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var Fa=this._props,Fb=0,Fc=Fa.length;Fb<Fc;Fb++){var Fd=Fa[Fb];this._target[Fd[0]]=Fd[1]}Fz.scaleTimer.once(this._delay,this,this._beginLoop)}},Fa.resume=function(){this._usedTimer>=this._duration||(this._startTimer=FO.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?Fz.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},Fm(0,Fa,"progress",null,function(Fa){var Fb=Fa*this._duration;this._startTimer=FO.now()-this._delay-Fb}),Fn.to=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){return void 0===Ff&&(Ff=0),void 0===Fg&&(Fg=!1),void 0===Fh&&(Fh=!0),FW.getItemByClass("tween",Fn)._create(Fa,Fb,Fc,Fd,Fe,Ff,Fg,!0,Fh,!0)},Fn.from=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){return void 0===Ff&&(Ff=0),void 0===Fg&&(Fg=!1),void 0===Fh&&(Fh=!0),FW.getItemByClass("tween",Fn)._create(Fa,Fb,Fc,Fd,Fe,Ff,Fg,!1,Fh,!0)},Fn.clearAll=function(Fa){if(Fa&&Fa.$_GID){var Fb=Fn.tweenMap[Fa.$_GID];if(Fb){for(var Fc=0,Fd=Fb.length;Fc<Fd;Fc++)Fb[Fc]._clear();Fb.length=0}}},Fn.clear=function(Fa){Fa.clear()},Fn.clearTween=function(Fa){Fn.clearAll(Fa)},Fn.easeNone=function(Fa,Fb,Fc,Fd){return Fc*Fa/Fd+Fb},Fn.tweenMap={},Fn}(),F$=function(){function Fh(){}return Fr(Fh,"laya.utils.Utils"),Fh.toRadian=function(Fa){return Fa*Fh._pi2},Fh.toAngle=function(Fa){return Fa*Fh._pi},Fh.toHexColor=function(Fa){if(Fa<0||isNaN(Fa))return null;for(var Fb=Fa.toString(16);Fb.length<6;)Fb="0"+Fb;return"#"+Fb},Fh.getGID=function(){return Fh._gid++},Fh.concatArray=function(Fa,Fb){if(!Fb)return Fa;if(!Fa)return Fb;var Fc=0,Fd=Fb.length;for(Fc=0;Fc<Fd;Fc++)Fa.push(Fb[Fc]);return Fa},Fh.clearArray=function(Fa){return Fa&&(Fa.length=0),Fa},Fh.copyArray=function(Fa,Fb){if(Fa||(Fa=[]),!Fb)return Fa;Fa.length=Fb.length;var Fc=0,Fd=Fb.length;for(Fc=0;Fc<Fd;Fc++)Fa[Fc]=Fb[Fc];return Fa},Fh.getGlobalRecByPoints=function(Fa,Fb,Fc,Fd,Fe){var Ff,Fg;return Ff=new FA(Fb,Fc),Ff=Fa.localToGlobal(Ff),Fg=new FA(Fd,Fe),Fg=Fa.localToGlobal(Fg),FB._getWrapRec([Ff.x,Ff.y,Fg.x,Fg.y])},Fh.getGlobalPosAndScale=function(Fa){return Fh.getGlobalRecByPoints(Fa,0,0,1,1)},Fh.bind=function(Fa,Fb){return Fa.bind(Fb)},Fh.measureText=function(Fa,Fb){return FF.measureText(Fa,Fb)},Fh.contextMeasureText=function(Fa){var Fb=FO.context.measureText(Fa);return Fb||(Fb={width:16,height:16}),Fb},Fh.updateOrder=function(Fa){if(!Fa||Fa.length<2)return!1;for(var Fb,Fc=1,Fd=0,Fe=Fa.length,Ff=NaN;Fc<Fe;){for(Fb=Fa[Fd=Fc],Ff=Fa[Fd]._zOrder;-1<--Fd&&Fa[Fd]._zOrder>Ff;)Fa[Fd+1]=Fa[Fd];Fa[Fd+1]=Fb,Fc++}var Fg=Fb.parent.conchModel;if(Fg)if(null!=Fg.updateZOrder)Fg.updateZOrder();else{for(Fc=0;Fc<Fe;Fc++)Fg.removeChild(Fa[Fc].conchModel);for(Fc=0;Fc<Fe;Fc++)Fg.addChildAt(Fa[Fc].conchModel,Fc)}return!0},Fh.transPointList=function(Fa,Fb,Fc){var Fd=0,Fe=Fa.length;for(Fd=0;Fd<Fe;Fd+=2)Fa[Fd]+=Fb,Fa[Fd+1]+=Fc},Fh.parseInt=function(Fa,Fb){void 0===Fb&&(Fb=0);var Fc=FO.window.parseInt(Fa,Fb);return isNaN(Fc)?0:Fc},Fh.getFileExtension=function(Fa){Fh._extReg.lastIndex=Fa.lastIndexOf(".");var Fb=Fh._extReg.exec(Fa);return Fb&&1<Fb.length?Fb[1].toLowerCase():null},Fh.getTransformRelativeToWindow=function(Fa,Fb,Fc){var Fd=Fz.stage,Fe=laya.utils.Utils.getGlobalPosAndScale(Fa),Ff=Fd._canvasTransform.clone(),Fg=Ff.tx,Fh=Ff.ty;Ff.rotate(-Math.PI/180*Fz.stage.canvasDegree),Ff.scale(Fz.stage.clientScaleX,Fz.stage.clientScaleY);var Fi=Fz.stage.canvasDegree%180!=0,Fj=NaN,Fm=NaN;Fi?(Fj=Fc+Fe.y,Fm=Fb+Fe.x,Fj*=Ff.d,Fm*=Ff.a,90==Fz.stage.canvasDegree?(Fj=Fg-Fj,Fm+=Fh):(Fj+=Fg,Fm=Fh-Fm)):(Fj=Fb+Fe.x,Fm=Fc+Fe.y,Fj*=Ff.a,Fm*=Ff.d,Fj+=Fg,Fm+=Fh);var Fn=NaN,Fo=NaN;return Fo=Fi?(Fn=Ff.d*Fe.height,Ff.a*Fe.width):(Fn=Ff.a*Fe.width,Ff.d*Fe.height),{x:Fj,y:Fm,scaleX:Fn,scaleY:Fo}},Fh.fitDOMElementInArea=function(Fa,Fb,Fc,Fd,Fe,Ff){Fa._fitLayaAirInitialized||(Fa._fitLayaAirInitialized=!0,Fa.style.transformOrigin=Fa.style.webKittransformOrigin="left top",Fa.style.position="absolute");var Fg=Fh.getTransformRelativeToWindow(Fb,Fc,Fd);Fa.style.transform=Fa.style.webkitTransform="scale("+Fg.scaleX+","+Fg.scaleY+") rotate("+Fz.stage.canvasDegree+"deg)",Fa.style.width=Fe+"px",Fa.style.height=Ff+"px",Fa.style.left=Fg.x+"px",Fa.style.top=Fg.y+"px"},Fh.isOkTextureList=function(Fa){if(!Fa)return!1;var Fb,Fc=0,Fd=Fa.length;for(Fc=0;Fc<Fd;Fc++)if(!(Fb=Fa[Fc])||!Fb.source)return!1;return!0},Fh.isOKCmdList=function(Fa){if(!Fa)return!1;var Fb,Fc,Fd=0,Fe=Fa.length,Ff=FJ._context;for(Fd=0;Fd<Fe;Fd++)switch((Fb=Fa[Fd]).callee){case Ff._drawTexture:case Ff._fillTexture:case Ff._drawTextureWithTransform:if(!(Fc=Fb[0])||!Fc.source)return!1}return!0},Fh._gid=1,Fh._pi=180/Math.PI,Fh._pi2=Math.PI/180,Fh._extReg=/\.(\w+)\??/g,Fh.parseXMLFromString=function(Fa){var Fb;if(Fa=Fa.replace(/>\s+</g,"><"),-1<(Fb=(new DOMParser).parseFromString(Fa,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(Fb.firstChild.firstChild.textContent);return Fb},Fh}(),F_=function(){function Fa(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],FJ.isWebGL&&FQ.regCacheByFunction(F$.bind(this.startDispose,this),F$.bind(this.getCacheList,this))}Fr(Fa,"laya.utils.VectorGraphManager");var Fb=Fa.prototype;return Fb.getId=function(){return this._id++},Fb.addShape=function(Fa,Fb){this.shapeDic[Fa]=Fb,this.useDic[Fa]||(this.useDic[Fa]=!0)},Fb.addLine=function(Fa,Fb){this.shapeLineDic[Fa]=Fb,this.shapeLineDic[Fa]||(this.shapeLineDic[Fa]=!0)},Fb.getShape=function(Fa){this._checkKey&&null!=this.useDic[Fa]&&(this.useDic[Fa]=!0)},Fb.deleteShape=function(Fa){this.shapeDic[Fa]&&(this.shapeDic[Fa]=null,delete this.shapeDic[Fa]),this.shapeLineDic[Fa]&&(this.shapeLineDic[Fa]=null,delete this.shapeLineDic[Fa]),null!=this.useDic[Fa]&&delete this.useDic[Fa]},Fb.getCacheList=function(){var Fa,Fb=[];for(Fa in this.shapeDic)Fb.push(this.shapeDic[Fa]);for(Fa in this.shapeLineDic)Fb.push(this.shapeLineDic[Fa]);return Fb},Fb.startDispose=function(Fa){var Fb;for(Fb in this.useDic)this.useDic[Fb]=!1;this._checkKey=!0},Fb.endDispose=function(){if(this._checkKey){var Fa;for(Fa in this.useDic)this.useDic[Fa]||this.deleteShape(Fa);this._checkKey=!1}},Fa.getInstance=function(){return Fa.instance=Fa.instance||new Fa},Fa.instance=null,Fa}(),Fk=function(){function Fd(){this._obj=null,this._obj=Fd.supportWeakMap?new FO.window.WeakMap:{},Fd.supportWeakMap||Fd._maps.push(this)}Fr(Fd,"laya.utils.WeakObject");var Fa=Fd.prototype;return Fa.set=function(Fa,Fb){if(null!=Fa)if(Fd.supportWeakMap){var Fc=Fa;"string"!=typeof Fa&&"number"!=typeof Fa||(Fc=Fd._keys[Fa])||(Fc=Fd._keys[Fa]={k:Fa}),this._obj.set(Fc,Fb)}else"string"==typeof Fa||"number"==typeof Fa?this._obj[Fa]=Fb:(Fa.$_GID||(Fa.$_GID=F$.getGID()),this._obj[Fa.$_GID]=Fb)},Fa.get=function(Fa){if(null==Fa)return null;if(Fd.supportWeakMap){var Fb="string"==typeof Fa||"number"==typeof Fa?Fd._keys[Fa]:Fa;return Fb?this._obj.get(Fb):null}return"string"==typeof Fa||"number"==typeof Fa?this._obj[Fa]:this._obj[Fa.$_GID]},Fa.del=function(Fa){if(null!=Fa)if(Fd.supportWeakMap){var Fb="string"==typeof Fa||"number"==typeof Fa?Fd._keys[Fa]:Fa;if(!Fb)return;this._obj.delete(Fb)}else"string"==typeof Fa||"number"==typeof Fa?delete this._obj[Fa]:delete this._obj[this._obj.$_GID]},Fa.has=function(Fa){if(null==Fa)return!1;if(Fd.supportWeakMap){var Fb="string"==typeof Fa||"number"==typeof Fa?Fd._keys[Fa]:Fa;return this._obj.has(Fb)}return"string"==typeof Fa||"number"==typeof Fa?null!=this._obj[Fa]:null!=this._obj[this._obj.$_GID]},Fd.__init__=function(){(Fd.supportWeakMap=null!=FO.window.WeakMap)||Fz.timer.loop(Fd.delInterval,null,Fd.clearCache)},Fd.clearCache=function(){for(var Fa=0,Fb=Fd._maps.length;Fa<Fb;Fa++){Fd._maps[Fa]._obj={}}},Fd.supportWeakMap=!1,Fd.delInterval=3e5,Fd._keys={},Fd._maps=[],Fi(Fd,["I",function(){return this.I=new Fd}]),Fd}(),Fl=function(){function Fa(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}Fr(Fa,"laya.utils.WordText");var Fb=Fa.prototype;return Fb.setText=function(Fa){this.changed=!0,this._text=Fa},Fb.toString=function(){return this._text},Fb.charCodeAt=function(Fa){return this._text?this._text.charCodeAt(Fa):NaN},Fb.charAt=function(Fa){return this._text?this._text.charAt(Fa):null},Fm(0,Fb,"length",function(){return this._text?this._text.length:0}),Fa}(),Faa=function(Fa){function Fg(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,Fg.__super.call(this),this._childs=Fg.ARRAY_EMPTY,this._$P=Fg.PROP_EMPTY,this.timer=Fz.scaleTimer,this.conchModel=FJ.isConchNode?this.createConchModel():null}Fr(Fg,"laya.display.Node",Fj);var Fb=Fg.prototype;return Fb._setBit=function(Fa,Fb){1==Fa&&(this._getBit(Fa)!=Fb&&this._updateDisplayedInstage());Fb?this._bits|=Fa:this._bits&=~Fa},Fb._getBit=function(Fa){return 0!=(this._bits&Fa)},Fb._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},Fb._setUpNoticeType=function(Fa){var Fb=this;for(Fb._setBit(Fa,!0),Fb=Fb.parent;Fb;){if(Fb._getBit(Fa))return;Fb._setBit(Fa,!0),Fb=Fb.parent}},Fb.on=function(Fa,Fb,Fc,Fd){return"display"!==Fa&&"undisplay"!==Fa||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Fa,Fb,Fc,Fd,!1)},Fb.once=function(Fa,Fb,Fc,Fd){return"display"!==Fa&&"undisplay"!==Fa||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Fa,Fb,Fc,Fd,!0)},Fb.createConchModel=function(){return null},Fb.destroy=function(Fa){void 0===Fa&&(Fa=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(Fa?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},Fb.destroyChildren=function(){if(this._childs)for(var Fa=this._childs.length-1;-1<Fa;Fa--)this._childs[Fa].destroy(!0)},Fb.addChild=function(Fa){if(!Fa||this.destroyed||Fa===this)return Fa;if(Fa.zOrder&&this._set$P("hasZorder",!0),Fa._parent===this){var Fb=this.getChildIndex(Fa);Fb!==this._childs.length-1&&(this._childs.splice(Fb,1),this._childs.push(Fa),this.conchModel&&(this.conchModel.removeChild(Fa.conchModel),this.conchModel.addChildAt(Fa.conchModel,this._childs.length-1)),this._childChanged())}else Fa.parent&&Fa.parent.removeChild(Fa),this._childs===Fg.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Fa),this.conchModel&&this.conchModel.addChildAt(Fa.conchModel,this._childs.length-1),(Fa.parent=this)._childChanged();return Fa},Fb.addChildren=function(Fa){for(var Fb=arguments,Fc=0,Fd=Fb.length;Fc<Fd;)this.addChild(Fb[Fc++])},Fb.addChildAt=function(Fa,Fb){if(!Fa||this.destroyed||Fa===this)return Fa;if(Fa.zOrder&&this._set$P("hasZorder",!0),0<=Fb&&Fb<=this._childs.length){if(Fa._parent===this){var Fc=this.getChildIndex(Fa);this._childs.splice(Fc,1),this._childs.splice(Fb,0,Fa),this.conchModel&&(this.conchModel.removeChild(Fa.conchModel),this.conchModel.addChildAt(Fa.conchModel,Fb)),this._childChanged()}else Fa.parent&&Fa.parent.removeChild(Fa),this._childs===Fg.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Fb,0,Fa),this.conchModel&&this.conchModel.addChildAt(Fa.conchModel,Fb),Fa.parent=this;return Fa}throw new Error("appendChildAt:The index is out of bounds")},Fb.getChildIndex=function(Fa){return this._childs.indexOf(Fa)},Fb.getChildByName=function(Fa){var Fb=this._childs;if(Fb)for(var Fc=0,Fd=Fb.length;Fc<Fd;Fc++){var Fe=Fb[Fc];if(Fe.name===Fa)return Fe}return null},Fb._get$P=function(Fa){return this._$P[Fa]},Fb._set$P=function(Fa,Fb){return this.destroyed||(this._$P===Fg.PROP_EMPTY&&(this._$P={}),this._$P[Fa]=Fb),Fb},Fb.getChildAt=function(Fa){return this._childs[Fa]},Fb.setChildIndex=function(Fa,Fb){var Fc=this._childs;if(Fb<0||Fb>=Fc.length)throw new Error("setChildIndex:The index is out of bounds.");var Fd=this.getChildIndex(Fa);if(Fd<0)throw new Error("setChildIndex:node is must child of this object.");return Fc.splice(Fd,1),Fc.splice(Fb,0,Fa),this.conchModel&&(this.conchModel.removeChild(Fa.conchModel),this.conchModel.addChildAt(Fa.conchModel,Fb)),this._childChanged(),Fa},Fb._childChanged=function(Fa){},Fb.removeChild=function(Fa){if(!this._childs)return Fa;var Fb=this._childs.indexOf(Fa);return this.removeChildAt(Fb)},Fb.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},Fb.removeChildByName=function(Fa){var Fb=this.getChildByName(Fa);return Fb&&this.removeChild(Fb),Fb},Fb.removeChildAt=function(Fa){var Fb=this.getChildAt(Fa);if(Fb){for(var Fc=this._childs.length-1,Fd=Fa;Fd<Fc;++Fd)this._childs[Fd]=this._childs[Fd+1];this._childs.length=Fc,this.conchModel&&this.conchModel.removeChild(Fb.conchModel),Fb.parent=null}return Fb},Fb.removeChildren=function(Fa,Fb){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=2147483647),this._childs&&0<this._childs.length){var Fc=this._childs;if(0===Fa&&Ff<=Fb){var Fd=Fc;this._childs=Fg.ARRAY_EMPTY}else Fd=Fc.splice(Fa,Fb-Fa);for(var Fe=0,Ff=Fd.length;Fe<Ff;Fe++)Fd[Fe].parent=null,this.conchModel&&this.conchModel.removeChild(Fd[Fe].conchModel)}return this},Fb.replaceChild=function(Fa,Fb){var Fc=this._childs.indexOf(Fb);return-1<Fc?(this._childs.splice(Fc,1,Fa),this.conchModel&&(this.conchModel.removeChild(Fb.conchModel),this.conchModel.addChildAt(Fa.conchModel,Fc)),Fb.parent=null,Fa.parent=this,Fa):null},Fb._updateDisplayedInstage=function(){var Fa;Fa=this;var Fb=Fz.stage;for(this._displayedInStage=!1;Fa;){if(Fa._getBit(1)){this._displayedInStage=Fa._displayedInStage;break}if(Fa==Fb||Fa._displayedInStage){this._displayedInStage=!0;break}Fa=Fa.parent}},Fb._setDisplay=function(Fa){this._displayedInStage!==Fa&&((this._displayedInStage=Fa)?this.event("display"):this.event("undisplay"))},Fb._displayChild=function(Fa,Fb){var Fc=Fa._childs;if(Fc)for(var Fd=0;Fd<Fc.length;Fd++){var Fe=Fc[Fd];Fe&&Fe._getBit(1)&&(0<Fe._childs.length?this._displayChild(Fe,Fb):Fe._setDisplay(Fb))}Fa._setDisplay(Fb)},Fb.contains=function(Fa){if(Fa===this)return!0;for(;Fa;){if(Fa.parent===this)return!0;Fa=Fa.parent}return!1},Fb.timerLoop=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Fe&&(Fe=!0),void 0===Ff&&(Ff=!1),this.timer.loop(Fa,Fb,Fc,Fd,Fe,Ff)},Fb.timerOnce=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=!0),this.timer._create(!1,!1,Fa,Fb,Fc,Fd,Fe)},Fb.frameLoop=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=!0),this.timer._create(!0,!0,Fa,Fb,Fc,Fd,Fe)},Fb.frameOnce=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=!0),this.timer._create(!0,!1,Fa,Fb,Fc,Fd,Fe)},Fb.clearTimer=function(Fa,Fb){this.timer.clear(Fa,Fb)},Fm(0,Fb,"numChildren",function(){return this._childs.length}),Fm(0,Fb,"destroyed",function(){return this._destroyed}),Fm(0,Fb,"parent",function(){return this._parent},function(Fa){this._parent!==Fa&&(Fa?(this._parent=Fa,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),Fa.displayedInStage&&this._displayChild(this,!0)),Fa._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=Fa))}),Fm(0,Fb,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),Fg.ARRAY_EMPTY=[],Fg.PROP_EMPTY={},Fg.NOTICE_DISPLAY=1,Fg.MOUSEENABLE=2,Fg}(),Fba=function(Fa){function Fo(Fa){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,Fo.__super.call(this),this._padding=Fo._PADDING,this._spacing=Fo._SPACING,this._aligns=Fo._ALIGNS,this._font=Fp.EMPTY,this._ower=Fa}Fr(Fo,"laya.display.css.CSSStyle",Fa);var Fb=Fo.prototype;return Fb.destroy=function(){this._ower=null,this._font=null,this._rect=null},Fb.inherit=function(Fa){this._font=Fa._font,this._spacing=Fa._spacing===Fo._SPACING?Fo._SPACING:Fa._spacing.slice(),this.lineHeight=Fa.lineHeight},Fb._widthAuto=function(){return 0!=(262144&this._type)},Fb.widthed=function(Fa){return 0!=(8&this._type)},Fb._calculation=function(Fa,Fb){if(Fb.indexOf("%")<0)return!1;var Fd=this._ower,Fe=Fd.parent,Ff=this._rect;function Fg(Fa,Fb,Fc){return Fa*Fc[0]+Fb*Fc[1]+Fc[2]}function Fc(Fa){var Fb=Fe.width,Fc=Fd.width;Ff.width&&(Fd.width=Fg(Fb,Fc,Ff.width)),Ff.height&&(Fd.height=Fg(Fb,Fc,Ff.height)),Ff.left&&(Fd.x=Fg(Fb,Fc,Ff.left)),Ff.top&&(Fd.y=Fg(Fb,Fc,Ff.top))}null===Ff&&(Fe._getCSSStyle()._type|=524288,Fe.on("resize",this,Fc),this._rect=Ff={input:{}});var Fh=Fb.split(" ");return Fh[0]=parseFloat(Fh[0])/100,1==Fh.length?Fh[1]=Fh[2]=0:(Fh[1]=parseFloat(Fh[1])/100,Fh[2]=parseFloat(Fh[2])),Ff[Fa]=Fh,Ff.input[Fa]=Fb,Fc(),!0},Fb.heighted=function(Fa){return 0!=(8192&this._type)},Fb.size=function(Fa,Fb){var Fc=this._ower,Fd=!1;-1!==Fa&&Fa!=this._ower.width&&(this._type|=8,this._ower.width=Fa,Fd=!0),-1!==Fb&&Fb!=this._ower.height&&(this._type|=8192,this._ower.height=Fb,Fd=!0),Fd&&(Fc._layoutLater(),524288&this._type&&Fc.event("resize",this))},Fb._getAlign=function(){return this._aligns[0]},Fb._getValign=function(){return this._aligns[1]},Fb._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},Fb._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new Fp(this._font))},Fb.render=function(Fa,Fb,Fc,Fd){var Fe=Fa.width,Ff=Fa.height;Fc-=Fa.pivotX,Fd-=Fa.pivotY,this._bgground&&null!=this._bgground.color&&Fb.ctx.fillRect(Fc,Fd,Fe,Ff,this._bgground.color),this._border&&this._border.color&&Fb.drawRect(Fc,Fd,Fe,Ff,this._border.color.strColor,this._border.size)},Fb.getCSSStyle=function(){return this},Fb.cssText=function(Fa){this.attrs(Fo.parseOneCSS(Fa,";"))},Fb.attrs=function(Fa){if(Fa)for(var Fb=0,Fc=Fa.length;Fb<Fc;Fb++){var Fd=Fa[Fb];this[Fd[0]]=Fd[1]}},Fb.setTransform=function(Fa){"none"===Fa?this._tf=Fh._TF_EMPTY:this.attrs(Fo.parseOneCSS(Fa,","))},Fb.translate=function(Fa,Fb){this._tf===Fh._TF_EMPTY&&(this._tf=new Fe),this._tf.translateX=Fa,this._tf.translateY=Fb},Fb.scale=function(Fa,Fb){this._tf===Fh._TF_EMPTY&&(this._tf=new Fe),this._tf.scaleX=Fa,this._tf.scaleY=Fb},Fb._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},Fm(0,Fb,"block",Fa.prototype._$get_block,function(Fa){Fa?this._type|=1:this._type&=-2}),Fm(0,Fb,"valign",function(){return Fo._valigndef[this._aligns[1]]},function(Fa){this._aligns===Fo._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=Fo._valigndef[Fa]}),Fm(0,Fb,"height",null,function(Fa){if(this._type|=8192,"string"==typeof Fa){if(this._calculation("height",Fa))return;Fa=parseInt(Fa)}this.size(-1,Fa)}),Fm(0,Fb,"width",null,function(Fa){if(this._type|=8,"string"==typeof Fa){var Fb=Fa.indexOf("auto");if(0<=Fb&&(this._type|=262144,Fa=Fa.substr(0,Fb)),this._calculation("width",Fa))return;Fa=parseInt(Fa)}this.size(Fa,-1)}),Fm(0,Fb,"fontWeight",function(){return this._font.weight},function(Fa){this._createFont().weight=Fa}),Fm(0,Fb,"left",null,function(Fa){var Fb=this._ower;if("string"==typeof Fa){if("center"===Fa?Fa="50% -50% 0":"right"===Fa&&(Fa="100% -100% 0"),this._calculation("left",Fa))return;Fa=parseInt(Fa)}Fb.x=Fa}),Fm(0,Fb,"_translate",null,function(Fa){this.translate(Fa[0],Fa[1])}),Fm(0,Fb,"absolute",function(){return 0!=(4&this._type)}),Fm(0,Fb,"top",null,function(Fa){var Fb=this._ower;if("string"==typeof Fa){if("middle"===Fa?Fa="50% -50% 0":"bottom"===Fa&&(Fa="100% -100% 0"),this._calculation("top",Fa))return;Fa=parseInt(Fa)}Fb.y=Fa}),Fm(0,Fb,"align",function(){return Fo._aligndef[this._aligns[0]]},function(Fa){this._aligns===Fo._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=Fo._aligndef[Fa]}),Fm(0,Fb,"bold",function(){return this._font.bold},function(Fa){this._createFont().bold=Fa}),Fm(0,Fb,"padding",function(){return this._padding},function(Fa){this._padding=Fa}),Fm(0,Fb,"leading",function(){return this._spacing[1]},function(Fa){"string"==typeof Fa&&(Fa=parseInt(Fa+"")),this._spacing===Fo._SPACING&&(this._spacing=[0,0]),this._spacing[1]=Fa}),Fm(0,Fb,"lineElement",function(){return 0!=(65536&this._type)},function(Fa){Fa?this._type|=65536:this._type&=-65537}),Fm(0,Fb,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(Fa){this.lineElement=!1,"right"===Fa?this._type|=32768:this._type&=-32769}),Fm(0,Fb,"textDecoration",function(){return this._font.decoration},function(Fa){this._createFont().decoration=Fa}),Fm(0,Fb,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(Fa){"nowrap"===Fa&&(this._type|=131072),"none"===Fa&&(this._type&=-131073)}),Fm(0,Fb,"background",null,function(Fa){Fa?(this._bgground||(this._bgground={}),this._bgground.color=Fa,this._ower.conchModel&&this._ower.conchModel.bgColor(Fa),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),Fm(0,Fb,"wordWrap",function(){return 0==(131072&this._type)},function(Fa){Fa?this._type&=-131073:this._type|=131072}),Fm(0,Fb,"color",function(){return this._font.color},function(Fa){this._createFont().color=Fa}),Fm(0,Fb,"password",function(){return this._font.password},function(Fa){this._createFont().password=Fa}),Fm(0,Fb,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(Fa){"none"===Fa?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=Fa),this._ower.conchModel&&this._ower.conchModel.bgColor(Fa),this._ower._renderType|=256}),Fm(0,Fb,"font",function(){return this._font.toString()},function(Fa){this._createFont().set(Fa)}),Fm(0,Fb,"weight",null,function(Fa){this._createFont().weight=Fa}),Fm(0,Fb,"letterSpacing",function(){return this._spacing[0]},function(Fa){"string"==typeof Fa&&(Fa=parseInt(Fa+"")),this._spacing===Fo._SPACING&&(this._spacing=[0,0]),this._spacing[0]=Fa}),Fm(0,Fb,"fontSize",function(){return this._font.size},function(Fa){this._createFont().size=Fa}),Fm(0,Fb,"italic",function(){return this._font.italic},function(Fa){this._createFont().italic=Fa}),Fm(0,Fb,"fontFamily",function(){return this._font.family},function(Fa){this._createFont().family=Fa}),Fm(0,Fb,"stroke",function(){return this._font.stroke[0]},function(Fa){this._createFont().stroke===Fp._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=Fa}),Fm(0,Fb,"strokeColor",function(){return this._font.stroke[1]},function(Fa){this._createFont().stroke===Fp._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=Fa}),Fm(0,Fb,"border",function(){return this._border?this._border.value:""},function(Fa){if("none"!=Fa){this._border||(this._border={});var Fb=(this._border.value=Fa).split(" ");if(this._border.color=FS.create(Fb[Fb.length-1]),1==Fb.length)return this._border.size=1,void(this._border.type="solid");var Fc=0;0<Fb[0].indexOf("px")?(this._border.size=parseInt(Fb[0]),Fc++):this._border.size=1,this._border.type=Fb[Fc],this._ower._renderType|=256}else this._border=null}),Fm(0,Fb,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(Fa){Fa?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==Fa?null:FS.create(Fa),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),Fm(0,Fb,"position",function(){return 4&this._type?"absolute":""},function(Fa){"absolute"==Fa?this._type|=4:this._type&=-5}),Fm(0,Fb,"display",null,function(Fa){switch(Fa){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),Fm(0,Fb,"paddingLeft",function(){return this.padding[3]}),Fm(0,Fb,"paddingTop",function(){return this.padding[0]}),Fm(0,Fb,"_scale",null,function(Fa){this._ower.scale(Fa[0],Fa[1])}),Fm(0,Fb,"_rotate",null,function(Fa){this._ower.rotation=Fa}),Fo.parseOneCSS=function(Fa,Fb){for(var Fc,Fd=[],Fe=Fa.split(Fb),Ff=0,Fg=Fe.length;Ff<Fg;Ff++){var Fh=Fe[Ff],Fi=Fh.indexOf(":"),Fj=Fh.substr(0,Fi).replace(/^\s+|\s+$/g,"");if(0!=Fj.length){var Fm=Fh.substr(Fi+1).replace(/^\s+|\s+$/g,""),Fn=[Fj,Fm];switch(Fj){case"italic":case"bold":Fn[1]="true"==Fm;break;case"line-height":Fn[0]="lineHeight",Fn[1]=parseInt(Fm);break;case"font-size":Fn[0]="fontSize",Fn[1]=parseInt(Fm);break;case"padding":1<(Fc=Fm.split(" ")).length||(Fc[1]=Fc[2]=Fc[3]=Fc[0]),Fn[1]=[parseInt(Fc[0]),parseInt(Fc[1]),parseInt(Fc[2]),parseInt(Fc[3])];break;case"rotate":Fn[0]="_rotate",Fn[1]=parseFloat(Fm);break;case"scale":Fc=Fm.split(" "),Fn[0]="_scale",Fn[1]=[parseFloat(Fc[0]),parseFloat(Fc[1])];break;case"translate":Fc=Fm.split(" "),Fn[0]="_translate",Fn[1]=[parseInt(Fc[0]),parseInt(Fc[1])];break;default:(Fn[0]=Fo._CSSTOVALUE[Fj])||(Fn[0]=Fj)}Fd.push(Fn)}}return Fd},Fo.parseCSS=function(Fa,Fb){for(var Fc;null!=(Fc=Fo._parseCSSRegExp.exec(Fa));)Fo.styleSheets[Fc[1]]=Fo.parseOneCSS(Fc[2],";")},Fo.EMPTY=new Fo(null),Fo._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},Fo._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),Fo._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},Fo._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},Fo.styleSheets={},Fo.ALIGN_CENTER=1,Fo.ALIGN_RIGHT=2,Fo.VALIGN_MIDDLE=1,Fo.VALIGN_BOTTOM=2,Fo._CSS_BLOCK=1,Fo._DISPLAY_NONE=2,Fo._ABSOLUTE=4,Fo._WIDTH_SET=8,Fo._PADDING=[0,0,0,0],Fo._RECT=[-1,-1,-1,-1],Fo._SPACING=[0,0],Fo._ALIGNS=[0,0,0],Fo.ADDLAYOUTED=512,Fo._NEWFONT=4096,Fo._HEIGHT_SET=8192,Fo._BACKGROUND_SET=16384,Fo._FLOAT_RIGHT=32768,Fo._LINE_ELEMENT=65536,Fo._NOWARP=131072,Fo._WIDTHAUTO=262144,Fo._LISTERRESZIE=524288,Fo}(Fh),Fca=function(Fa){function Fg(){this.url=null,this.audio=null,this.loaded=!1,Fg.__super.call(this)}Fr(Fg,"laya.media.h5audio.AudioSound",Fj);var Fb=Fg.prototype;return Fb.dispose=function(){var Fa=Fg._audioCache[this.url];Fa&&(Fa.src="",delete Fg._audioCache[this.url])},Fb.load=function(Fa){var Fb;if(Fa=FI.formatURL(Fa),(this.url=Fa)==FE._tMusic?(Fg._initMusicAudio(),(Fb=Fg._musicAudio).src!=Fa&&(Fg._audioCache[Fb.src]=null,Fb=null)):Fb=Fg._audioCache[Fa],Fb&&2<=Fb.readyState)this.event("complete");else{Fb||(Fb=Fa==FE._tMusic?(Fg._initMusicAudio(),Fg._musicAudio):FO.createElement("audio"),(Fg._audioCache[Fa]=Fb).src=Fa),Fb.addEventListener("canplaythrough",Fd),Fb.addEventListener("error",Fe);var Fc=this;(this.audio=Fb).load?Fb.load():Fe()}function Fd(){Ff(),Fc.loaded=!0,Fc.event("complete")}function Fe(){Fb.load=null,Ff(),Fc.event("error")}function Ff(){Fb.removeEventListener("canplaythrough",Fd),Fb.removeEventListener("error",Fe)}},Fb.play=function(Fa,Fb,Fc){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),!this.url)return null;var Fd,Fe;if(!(Fd=this.url==FE._tMusic?Fg._musicAudio:Fg._audioCache[this.url]))return null;Fe=FW.getItem("audio:"+this.url),FJ.isConchApp?Fe||((Fe=FO.createElement("audio")).src=this.url):this.url==FE._tMusic?(Fg._initMusicAudio(),(Fe=Fg._musicAudio).src=this.url):Fe=Fe||Fd.cloneNode(!0);var Ff=new Foa(Fe);return Ff.url=this.url,Ff.loops=Fb,Ff.startTime=Fa,Ff.startHandler=Fc,Ff.play(!1),FE.addChannel(Ff),Ff},Fm(0,Fb,"duration",function(){var Fa;return(Fa=Fg._audioCache[this.url])?Fa.duration:0}),Fg._initMusicAudio=function(){Fg._musicAudio||(Fg._musicAudio||(Fg._musicAudio=FO.createElement("audio")),FJ.isConchApp||FO.document.addEventListener("mousedown",Fg._makeMusicOK))},Fg._makeMusicOK=function(){FO.document.removeEventListener("mousedown",Fg._makeMusicOK),Fg._musicAudio.src?Fg._musicAudio.play():(Fg._musicAudio.src="",Fg._musicAudio.load())},Fg._audioCache={},Fg._musicAudio=null,Fg}(),Fda=function(Fa){function Fb(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,Fb.__super.call(this)}Fr(Fb,"laya.media.SoundChannel",Fj);var Fc=Fb.prototype;return Fc.play=function(){},Fc.stop=function(){},Fc.pause=function(){},Fc.resume=function(){},Fc.__runComplete=function(Fa){Fa&&Fa.run()},Fm(0,Fc,"volume",function(){return 1},function(Fa){}),Fm(0,Fc,"position",function(){return 0}),Fm(0,Fc,"duration",function(){return 0}),Fb}(),Fea=function(Fa){function Fb(){Fb.__super.call(this)}Fr(Fb,"laya.media.Sound",Fj);var Fc=Fb.prototype;return Fc.load=function(Fa){},Fc.play=function(Fa,Fb,Fc){return void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),null},Fc.dispose=function(){},Fm(0,Fc,"duration",function(){return 0}),Fb}(),Ffa=function(Fa){function Fe(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,Fe.__super.call(this)}Fr(Fe,"laya.media.webaudio.WebAudioSound",Fj);var Fb=Fe.prototype;return Fb.load=function(Fa){this.url=Fa,this.audioBuffer=Fe._dataCache[Fa],this.audioBuffer?this._loaded(this.audioBuffer):(Fe.e.on("loaded:"+Fa,this,this._loaded),Fe.e.on("err:"+Fa,this,this._err),Fe.__loadingSound[Fa]||(Fe.__loadingSound[Fa]=!0,Fz.loader.load(Fa,Fu.create(this,this.onloaded),null,Fha.BUFFER,4,!1,null,!0)))},Fb.onloaded=function(Fa){Fa||this._err(),this._disposed?this._removeLoadEvents():(this.data=Fa,Fe.buffs.push({buffer:this.data,url:this.url}),Fe.decode())},Fb._err=function(){if(this._removeLoadEvents(),Fe.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var Fa,Fb,Fc,Fd=0;for(Fa=(Fb=this.__toPlays).length,Fd=0;Fd<Fa;Fd++)(Fc=Fb[Fd])[3]&&!Fc[3].isStopped&&Fc[3].event("error");this.__toPlays.length=0}},Fb._loaded=function(Fa){this._removeLoadEvents(),this._disposed||(this.audioBuffer=Fa,this.loaded=!0,this.event("complete"))},Fb._removeLoadEvents=function(){Fe.e.off("loaded:"+this.url,this,this._loaded),Fe.e.off("err:"+this.url,this,this._err)},Fb.__playAfterLoaded=function(){if(this.__toPlays){var Fa,Fb,Fc,Fd=0;for(Fa=(Fb=this.__toPlays).length,Fd=0;Fd<Fa;Fd++)(Fc=Fb[Fd])[3]&&!Fc[3].isStopped&&this.play(Fc[0],Fc[1],Fc[2],Fc[3]);this.__toPlays.length=0}},Fb.play=function(Fa,Fb,Fc,Fd){return void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),Fd=Fd||new Fpa,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([Fa,Fb,Fc,Fd]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),Fd.url=this.url,Fd.loops=Fb,Fd.audioBuffer=this.audioBuffer,Fd.startTime=Fa,Fd.startHandler=Fc,Fd.play(!1),FE.addChannel(Fd),Fd},Fb.dispose=function(){this._disposed=!0,delete Fe._dataCache[this.url],delete Fe.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},Fm(0,Fb,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Fe.decode=function(){if(!(Fe.buffs.length<=0||Fe.isDecoding))if(Fe.isDecoding=!0,(Fe.tInfo=Fe.buffs.shift())&&Fe.tInfo.buffer&&Fe.tInfo.buffer.byteLength)try{Fe.ctx.decodeAudioData(Fe.tInfo.buffer,Fe._done,Fe._fail)}catch(Fa){console.error("decodeAudioData error  byteLength:"+Fe.tInfo.buffer.byteLength+"  url:"+Fe.tInfo.url)}else Fe._fail()},Fe._done=function(Fa){Fe.e.event("loaded:"+Fe.tInfo.url,Fa),Fe._dataCache[Fe.tInfo.url]=Fa,Fe.isDecoding=!1,Fe.decode()},Fe._fail=function(){Fe.e.event("err:"+Fe.tInfo.url,null),Fe.isDecoding=!1,Fe.decode()},Fe._playEmptySound=function(){if(null!=Fe.ctx){if(Fe._emptySource&&(Fe._emptySource.stop(),Fe._emptySource.disconnect(0),!Fpa._tryCleanFailed))try{Fe._emptySource.buffer=null}catch(Fa){Fpa._tryCleanFailed=!0}var Fa=Fe.ctx.createBufferSource();Fa.buffer=Fe._miniBuffer,Fa.connect(Fe.ctx.destination),Fa.start(0,0,0),Fe._emptySource=Fa}},Fe._unlock=function(){Fe._unlocked||(Fe._playEmptySound(),"running"==Fe.ctx.state?(FO.document.removeEventListener("mousedown",Fe._unlock,!0),FO.document.removeEventListener("touchend",Fe._unlock,!0),FO.document.removeEventListener("touchstart",Fe._unlock,!0),Fe._unlocked=!0):"suspended"==Fe.ctx.state&&FE._recoverWebAudio())},Fe.initWebAudio=function(){"running"!=Fe.ctx.state&&(Fe._unlock(),FO.document.addEventListener("mousedown",Fe._unlock,!0),FO.document.addEventListener("touchend",Fe._unlock,!0),FO.document.addEventListener("touchstart",Fe._unlock,!0))},Fe._emptySource=null,Fe._dataCache={},Fe.buffs=[],Fe.isDecoding=!1,Fe._unlocked=!1,Fe.tInfo=null,Fe.__loadingSound={},Fi(Fe,["window",function(){return this.window=FO.window},"webAudioEnabled",function(){return this.webAudioEnabled=Fe.window.AudioContext||Fe.window.webkitAudioContext||Fe.window.mozAudioContext},"ctx",function(){return this.ctx=Fe.webAudioEnabled?new(Fe.window.AudioContext||Fe.window.webkitAudioContext||Fe.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=Fe.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new Fj}]),Fe}(),Fga=function(Fa){function Fb(){this._responseType=null,this._data=null,Fb.__super.call(this),this._http=new FO.window.XMLHttpRequest}Fr(Fb,"laya.net.HttpRequest",Fj);var Fc=Fb.prototype;return Fc.send=function(Fa,Fb,Fc,Fd,Fe){void 0===Fc&&(Fc="get"),void 0===Fd&&(Fd="text"),this._responseType=Fd,this._data=null;var Ff=this,Fg=this._http;if(Fg.open(Fc,Fa,!0),Fe)for(var Fh=0;Fh<Fe.length;Fh++)Fg.setRequestHeader(Fe[Fh++],Fe[Fh]);else FJ.isConchApp||(Fb&&"string"!=typeof Fb?Fg.setRequestHeader("Content-Type","application/json"):Fg.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));Fg.responseType="arraybuffer"!==Fd?"text":"arraybuffer",Fg.onerror=function(Fa){Ff._onError(Fa)},Fg.onabort=function(Fa){Ff._onAbort(Fa)},Fg.onprogress=function(Fa){Ff._onProgress(Fa)},Fg.onload=function(Fa){Ff._onLoad(Fa)},Fg.send(Fb)},Fc._onProgress=function(Fa){Fa&&Fa.lengthComputable&&this.event("progress",Fa.loaded/Fa.total)},Fc._onAbort=function(Fa){this.error("Request was aborted by user")},Fc._onError=function(Fa){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},Fc._onLoad=function(Fa){var Fb=this._http,Fc=void 0!==Fb.status?Fb.status:200;200===Fc||204===Fc||0===Fc?this.complete():this.error("["+Fb.status+"]"+Fb.statusText+":"+Fb.responseURL)},Fc.error=function(Fa){this.clear(),this.event("error",Fa)},Fc.complete=function(){this.clear();var Fb=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=F$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(Fa){Fb=!1,this.error(Fa.message)}Fb&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},Fc.clear=function(){var Fa=this._http;Fa.onerror=Fa.onabort=Fa.onprogress=Fa.onload=null},Fm(0,Fc,"url",function(){return this._http.responseURL}),Fm(0,Fc,"http",function(){return this._http}),Fm(0,Fc,"data",function(){return this._data}),Fb}(),Fha=function(Fa){function FC(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,FC.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}Fr(FC,"laya.net.Loader",Fj);var Fb=FC.prototype;return Fb.load=function(Fa,Fb,Fc,Fd,Fe){if(Fa&&""!=Fa||console.error("Loader 加载的url不合法 "+Fa),void 0===Fc&&(Fc=!0),void 0===Fe&&(Fe=!1),0===(this._url=Fa).indexOf("data:image")?this._type=Fb="image":this._type=Fb||(Fb=this.getTypeFromUrl(Fa)),this._cache=Fc,this._data=null,!Fe&&FC.loadedMap[Fa])return this._data=FC.loadedMap[Fa],this.event("progress",1),void this.event("complete",this._data);if(Fd&&FC.setGroup(Fa,Fd),null!=FC.parserMap[Fb])return this._customParse=!0,void(FC.parserMap[Fb]instanceof laya.utils.Handler?FC.parserMap[Fb].runWith(this):FC.parserMap[Fb].call(null,this));if("image"===Fb||"htmlimage"===Fb||"nativeimage"===Fb)return this._loadImage(Fa);if("ttf"===Fb)return this._loadTTF(Fa);switch(Fb){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:Fb}FC.preLoadedMap[Fa]?this.onLoaded(FC.preLoadedMap[Fa]):Fg.resMgrLoad(Fa,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},Fb.getTypeFromUrl=function(Fa){var Fb=F$.getFileExtension(Fa);return Fb?FC.typeMap[Fb]:(console.warn("Not recognize the resources suffix",Fa),"text")},Fb._loadTTF=function(Fa){Fa=FI.formatURL(Fa);var Fb=new FH;Fb.complete=Fu.create(this,this.onLoaded),Fb.load(Fa)},Fb._loadImage=function(Fa){Fg.imgMgrLoad(Fa,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},Fb._loadImageComplete=function(Fa,Fb,Fc){if(null!=Fc)if(Fc instanceof ArrayBuffer){var Fd=new DataView(Fc),Fe=new laya.webgl.resource.WebGLImage(new Uint8Array(Fc,8),Fa,0,!1,Fd.getUint32(0),Fd.getUint32(4));this.onLoaded(Fe)}else if(Fc instanceof Fma)FC.imgMgrSet[Fa]=Fb,Fg.imgMgrLock(Fa,FC.imgMgrSet[Fa]),this._url=Fa,this.complete(Fc);else{var Ff=-1!=Fa.indexOf(".png",Fa.length-4)?6408:6407;Fe=new laya.webgl.resource.WebGLImage(Fc,Fa,Ff,!1,Fc.width,Fc.height);this.onLoaded(Fe)}else this.event("error","Load image failed")},Fb.imageCancel=function(Fa,Fb,Fc){Fg.imgMgrCancel(Fa,this._onImageCallback)},Fb._loadSound=function(Fa){var Fb=new FE._soundClass,Fc=this;function Fd(){Fb.offAll()}Fb.on("complete",this,function(){Fd(),Fc.onLoaded(Fb)}),Fb.on("error",this,function(){Fd(),Fb.dispose(),Fc.event("error","Load sound failed")}),Fb.load(Fa)},Fb.onProgress=function(Fa){"atlas"===this._type?this.event("progress",.3*Fa):this.event("progress",Fa)},Fb.onError=function(Fa){this.event("error",Fa)},Fb._loadedComplete=function(Fa,Fb,Fc){if(null!=Fc)switch(this._type){case"atlas":case"plf":case"json":var Fd=new FP(Fc);this.onLoaded(JSON.parse(Fd.readUTFBytes()));break;case"font":Fd=new FP(Fc);this.onLoaded(F$.parseXMLFromString(Fd.readUTFBytes()));break;default:this.onLoaded(Fc)}else this.event("error",Fa)},Fb.onLoaded=function(Fa){var Fb=this._type;if("plf"==Fb)this.parsePLFData(Fa),this.complete(Fa);else if("image"===Fb){var Fc=new Fma(Fa);Fc.url=this._url,this.complete(Fc)}else if("sound"===Fb||"htmlimage"===Fb||"nativeimage"===Fb)this.complete(Fa);else if("atlas"===Fb){if(!Fa.src&&!Fa._setContext){if(!this._data){if((this._data=Fa).meta&&Fa.meta.image)for(var Fd=Fa.meta.image.split(","),Fe=0<=this._url.indexOf("/")?"/":"\\",Ff=this._url.lastIndexOf(Fe),Fg=0<=Ff?this._url.substr(0,Ff+1):"",Fh=0,Fi=Fd.length;Fh<Fi;Fh++)Fd[Fh]=Fg+Fd[Fh];else Fd=[this._url.replace(".json",".png")];Fd.reverse(),Fa.toLoads=Fd,Fa.pics=[]}return this.event("progress",.3+1/Fd.length*.6),this._loadImage(Fd.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(Fa),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var Fj=this._data.frames,Fm=this._url.split("?")[0],Fn=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:Fm.substring(0,Fm.lastIndexOf("."))+"/",Fo=this._data.pics,Fp=FI.formatURL(this._url),Fq=FC.atlasMap[Fp]||(FC.atlasMap[Fp]=[]);Fq.dir=Fn;var Fr=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var Fs in Fr=parseFloat(this._data.meta.scale),Fj){var Ft,Fu=Fj[Fs],Fv=Fo[Fu.frame.idx?Fu.frame.idx:0],Fw=FI.formatURL(Fn+Fs);Fv.scaleRate=Fr,Ft=Fma.create(Fv,Fu.frame.x,Fu.frame.y,Fu.frame.w,Fu.frame.h,Fu.spriteSourceSize.x,Fu.spriteSourceSize.y,Fu.sourceSize.w,Fu.sourceSize.h),FC.cacheRes(Fw,Ft),FC.keepCache(this._url,Fn+Fs),Ft.url=Fw,Fq.push(Fw)}else for(Fs in Fj)Fv=Fo[(Fu=Fj[Fs]).frame.idx?Fu.frame.idx:0],Fw=FI.formatURL(Fn+Fs),FC.cacheRes(Fw,Fma.create(Fv,Fu.frame.x,Fu.frame.y,Fu.frame.w,Fu.frame.h,Fu.spriteSourceSize.x,Fu.spriteSourceSize.y,Fu.sourceSize.w,Fu.sourceSize.h)),FC.loadedMap[Fw].url=Fw,FC.keepCache(this._url,Fn+Fs),Fq.push(Fw);delete this._data.pics,this.complete(this._data)}else if("font"==Fb){if(!Fa.src)return this._data=Fa,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var Fx=new FD;Fx.parseFont(this._data,Fa);var Fy=this._url.split(".fnt")[0].split("/"),Fz=Fy[Fy.length-1];Fsa.registerBitmapFont(Fz,Fx),this._data=Fx,this.complete(this._data)}else if("pkm"==Fb){var FA=Fya.create(Fa,this._url),FB=new Fma(FA);FB.url=this._url,this.complete(FB)}else this.complete(Fa)},Fb.parsePLFData=function(Fa){var Fb,Fc,Fd;for(Fb in Fa)switch(Fd=Fa[Fb],Fb){case"json":case"text":for(Fc in Fd)FC.preLoadedMap[FI.formatURL(Fc)]=Fd[Fc];break;default:for(Fc in Fd)FC.preLoadedMap[FI.formatURL(Fc)]=Fd[Fc]}},Fb.complete=function(Fa){this._data=Fa,this._customParse?this.event("loaded",Fa instanceof Array?[Fa]:Fa):(FC._loaders.push(this),FC._isWorking||FC.checkNext())},Fb.endLoad=function(Fa){Fa&&(this._data=Fa),this._cache&&FC.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},Fm(0,Fb,"url",function(){return this._url}),Fm(0,Fb,"data",function(){return this._data}),Fm(0,Fb,"cache",function(){return this._cache}),Fm(0,Fb,"type",function(){return this._type}),FC.checkNext=function(){FC._isWorking=!0;for(var Fa=FO.now();FC._startIndex<FC._loaders.length;)if(FO.now(),FC._loaders[FC._startIndex].endLoad(),FC._startIndex++,FO.now()-Fa>FC.maxTimeOut)return console.warn("loader callback cost a long time:"+(FO.now()-Fa)+" url="+FC._loaders[FC._startIndex-1].url),void Fz.timer.frameOnce(1,null,FC.checkNext);FC._loaders.length=0,FC._startIndex=0,FC._isWorking=!1},FC.clearRes=function(Fa,Fb){if(null!=Fa){void 0===Fb&&(Fb=!1),Fa=FI.formatURL(Fa);var Fc=FC.getAtlas(Fa);if(Fc){for(var Fd=0,Fe=Fc.length;Fd<Fe;Fd++){var Ff=Fc[Fd],Fg=FC.getRes(Ff);delete FC.loadedMap[Ff],FC.clearCache(Fa.substring(FI.basePath.length),Ff.substring(FI.basePath.length)),Fg&&Fg.destroy(Fb)}Fc.length=0,delete FC.atlasMap[Fa],delete FC.loadedMap[Fa]}else{var Fh=FC.loadedMap[Fa];Fh&&(delete FC.loadedMap[Fa],Fh instanceof laya.resource.Texture&&Fh.bitmap&&Fh.destroy(Fb))}}},FC.clearTextureRes=function(Fa){Fa=FI.formatURL(Fa);var Fb=laya.net.Loader.getAtlas(Fa),Fc=Fb&&0<Fb.length?laya.net.Loader.getRes(Fb[0]):laya.net.Loader.getRes(Fa);Fc&&Fc.bitmap&&(FJ.isConchApp&&!FJ.isConchWebGL?Fc.bitmap.source.releaseTexture&&Fc.bitmap.source.releaseTexture():null==Fc.bitmap._atlaser&&Fc.bitmap.releaseResource(!0))},FC.getRes=function(Fa){return FC.loadedMap[FI.formatURL(Fa)]},FC.getAtlas=function(Fa){return FC.atlasMap[FI.formatURL(Fa)]},FC.cacheRes=function(Fa,Fb){Fa=FI.formatURL(Fa),null!=FC.loadedMap[Fa]?console.warn("Resources already exist,is repeated loading:",Fa):FC.loadedMap[Fa]=Fb},FC.setGroup=function(Fa,Fb){FC.groupMap[Fb]||(FC.groupMap[Fb]=[]),FC.groupMap[Fb].push(Fa)},FC.clearResByGroup=function(Fa){if(FC.groupMap[Fa]){var Fb=FC.groupMap[Fa],Fc=0,Fd=Fb.length;for(Fc=0;Fc<Fd;Fc++)FC.clearRes(Fb[Fc]);Fb.length=0}},FC.keepCache=function(Fa,Fb){if(Fa&&Fb){var Fc=FC.cacheSet[Fb];Fc?-1==Fc.indexOf(Fa)&&Fc.push(Fa):FC.cacheSet[Fb]=[Fa]}},FC.clearCache=function(Fa,Fb){if(Fa&&Fb){var Fc=FC.cacheSet[Fb];if(Fc){var Fd=Fc.indexOf(Fa);if(-1!==Fd){var Fe=Fc.length-1;0==Fe?(delete FC.cacheSet[Fb],0<FC.imgMgrSet[Fb]?Fg.imgMgrFree(Fb,FC.imgMgrSet[Fb]):FC.clearRes(Fb,!0)):(Fc[Fd]=Fc[Fe],Fc.length=Fe)}}}},FC.saveObject=function(Fa,Fb,Fc){if(Fb&&Fa){var Fd=FC.objectSet[Fa];Fd?(console.warn("Loader.saveObject: "+Fa),Fd[0]=Fb,Fd[1]=Fc):FC.objectSet[Fa]=[Fb,Fc,[]]}},FC.findObject=function(Fa){if(Fa){var Fb=FC.objectSet[Fa];if(Fb)return Fb[0]}return null},FC.keepObject=function(Fa,Fb){if(Fa&&Fb){var Fc=FC.objectSet[Fb];Fc&&-1===Fc[2].indexOf(Fa)&&Fc[2].push(Fa)}},FC.clearObject=function(Fa,Fb){if(Fa&&Fb){var Fc=FC.objectSet[Fb];if(Fc){var Fd=Fc[2],Fe=Fd.indexOf(Fa);if(-1!==Fe){var Ff=Fd.length-1;0==Ff?(delete FC.objectSet[Fb],Fc[1]&&Fc[1].call(null,Fc[0])):(Fd[Fe]=Fd[Ff],Fd.length=Ff)}}}},FC.TEXT="text",FC.JSON="json",FC.XML="xml",FC.BUFFER="arraybuffer",FC.IMAGE="image",FC.SOUND="sound",FC.ATLAS="atlas",FC.FONT="font",FC.TTF="ttf",FC.PLF="plf",FC.PKM="pkm",FC.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},FC.parserMap={},FC.groupMap={},FC.maxTimeOut=100,FC.loadedMap={},FC.preLoadedMap={},FC.atlasMap={},FC._loaders=[],FC._isWorking=!1,FC._startIndex=0,FC.imgCache={},FC.cacheSet={},FC.objectSet={},FC.imgMgrSet={},FC}(),Fia=function(Fa){var Fo;function Fp(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},Fp.__super.call(this);for(var Fa=0;Fa<this._maxPriority;Fa++)this._resInfos[Fa]=[]}Fr(Fp,"laya.net.LoaderManager",Fj);var Fb=Fp.prototype;return Fb.create=function(Fa,Fc,Fb,Fd,Fe,Ff,Fg,Fh){if(null==Ff&&(Ff=2),null==Fg&&(Fg=!0),Fa instanceof Array){var Fi=Fa,Fj=Fi.length,Fm=0;if(Fb)var Fn=Fu.create(Fb.caller,Fb.method,Fb.args,!1);for(var Fo=0;Fo<Fj;Fo++){var Fp=Fi[Fo];"string"==typeof Fp&&(Fp=Fi[Fo]={url:Fp}),Fp.progress=0}for(Fo=0;Fo<Fj;Fo++){Fp=Fi[Fo];var Fq=Fb?Fu.create(null,Ft,[Fp],!1):null,Fr=Fb||Fc?Fu.create(null,Fs,[Fp]):null;this._create(Fp.url,Fr,Fq,Fp.clas||Fd,Fp.params||Fe,null!=Fp.priority&&0<=Fp.priority?Fp.priority:Ff,Fg,Fp.group||Fh)}function Fs(Fa,Fb){Fm++,Fa.progress=1,Fm===Fj&&Fc&&Fc.run()}function Ft(Fa,Fb){Fa.progress=Fb;for(var Fc=0,Fd=0;Fd<Fj;Fd++){Fc+=Fi[Fd].progress}var Fe=Fc/Fj;Fn.runWith(Fe)}return!0}return this._create(Fa,Fc,Fb,Fd,Fe,Ff,Fg,Fh)},Fb._create=function(Fb,Fc,Fa,Fd,Fe,Ff,Fg,Fh){Fb&&""!=Fb||console.error("加载的url不合法 "+Fb),null==Ff&&(Ff=2),null==Fg&&(Fg=!0);var Fi=FI.formatURL(Fb),Fj=this.getRes(Fi);if(Fj)!Fj.hasOwnProperty("loaded")||Fj.loaded?(Fa&&Fa.runWith(1),Fc&&Fc.run()):Fc&&Fz.loader._createListener(Fb,Fc.caller,Fc.method,Fc.args,!0,!1);else{var Fm=F$.getFileExtension(Fb),Fn=Fp.createMap[Fm];if(!Fn)throw new Error("LoaderManager:unknown file("+Fb+") extension with: "+Fm+".");Fd||(Fd=Fn[0]);var Fo=Fn[1];if("atlas"==Fm)this.load(Fb,Fc,Fa,Fo,Ff,Fg);else{Fd===Fma&&(Fo="htmlimage"),(Fj=Fd?new Fd:null).hasOwnProperty("_loaded")&&(Fj._loaded=!1),Fj._setUrl(Fb),Fh&&Fj._setGroup(Fh),this._createLoad(Fj,Fb,Fu.create(null,function(Fa){Fj&&!Fj.destroyed&&Fa&&Fj.onAsynLoaded.call(Fj,Fb,Fa,Fe),Fc&&Fc.run();Fz.loader.event(Fb)}),Fa,Fo,Ff,!1,Fh,!0),Fg&&this.cacheRes(Fi,Fj)}}return Fj},Fb.load=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){Fa&&""!=Fa||console.error("加载的url不合法 "+Fa);var Fi=this;if(null==Fe&&(Fe=2),null==Ff&&(Ff=!0),void 0===Fh&&(Fh=!1),Fa instanceof Array)return this._loadAssets(Fa,Fb,Fc,Fd,Fe,Ff,Fg);var Fj=Fha.getRes(Fa);if(null!=Fj)Fz.timer.frameOnce(1,null,function(){Fc&&Fc.runWith(1),Fb&&Fb.runWith(Fj),Fi._loaderCount||Fi.event("complete")});else{var Fm=Fp._resMap[Fa];Fm?(Fb&&Fm._createListener("complete",Fb.caller,Fb.method,Fb.args,!1,!1),Fc&&Fm._createListener("progress",Fc.caller,Fc.method,Fc.args,!1,!1)):((Fm=this._infoPool.length?this._infoPool.pop():new Fo).url=Fa,Fm.clas=null,Fm.type=Fd,Fm.cache=Ff,Fm.group=Fg,Fm.ignoreCache=Fh,Fm.priority=Fe,Fb&&Fm.on("complete",Fb.caller,Fb.method,Fb.args),Fc&&Fm.on("progress",Fc.caller,Fc.method,Fc.args),Fp._resMap[Fa]=Fm,Fe=Fe<this._maxPriority?0<=Fe?Fe:0:this._maxPriority-1,this._resInfos[Fe].push(Fm),this._next())}return this},Fb.cancel=function(Fa,Fb,Fc){if((Fh=Fp._resMap[Fa])&&(Fb&&Fh.off("complete",Fb.caller,Fb.method,Fb.once),Fc&&Fh.off("progress",Fc.caller,Fc.method,Fc.once),!Fh.hasListener("complete")&&!Fh.hasListener("progress"))){if(Fh.loader){var Fd=Fh.loader;Fd.imageCancel(Fa),Fd.offAll(),Fd._data=null,Fd._customParse=!1,this._loaders.push(Fd),this._loaderCount--,delete this._loaderMap[Fh.url]}for(var Fe=0;Fe<this._maxPriority;Fe++)for(var Ff=this._resInfos[Fe],Fg=Ff.length-1;-1<Fg;Fg--){var Fh;(Fh=Ff[Fg])&&Fh.url===Fa&&(Ff[Fg]=null,Fh.destroy(),Fh.offAll(),this._infoPool.push(Fh))}delete Fp._resMap[Fa],this._next()}},Fb._createLoad=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){var Fj=this;if(null==Ff&&(Ff=2),null==Fg&&(Fg=!0),void 0===Fi&&(Fi=!1),Fb instanceof Array)return this._loadAssets(Fb,Fc,Fd,Fe,Ff,Fg,Fh);var Fm=Fha.getRes(Fb);if(null!=Fm)Fz.timer.frameOnce(1,null,function(){Fd&&Fd.runWith(1),Fc&&Fc.runWith(Fm),Fj._loaderCount||Fj.event("complete")});else{var Fn=Fp._resMap[Fb];Fn?(Fc&&Fn._createListener("complete",Fc.caller,Fc.method,Fc.args,!1,!1),Fd&&Fn._createListener("progress",Fd.caller,Fd.method,Fd.args,!1,!1)):((Fn=this._infoPool.length?this._infoPool.pop():new Fo).url=Fb,Fn.clas=Fa,Fn.type=Fe,Fn.cache=Fg,Fn.group=Fh,Fn.ignoreCache=Fi,Fn.priority=Ff,Fc&&Fn.on("complete",Fc.caller,Fc.method,Fc.args),Fd&&Fn.on("progress",Fd.caller,Fd.method,Fd.args),Fp._resMap[Fb]=Fn,Ff=Ff<this._maxPriority?0<=Ff?Ff:0:this._maxPriority-1,this._resInfos[Ff].push(Fn),this._next())}return this},Fb._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var Fa=0;Fa<this._maxPriority;Fa++)for(var Fb=this._resInfos[Fa];0<Fb.length;){var Fc=Fb.shift();if(Fc)return this._doLoad(Fc)}this._loaderCount||this.event("complete")}},Fb._doLoad=function(Fb){var Fc=this._loaders.length?this._loaders.pop():new Fha;this._loaderCount++,(this._loaderMap[Fb.url]=Fc).on("complete",null,Fe),Fc.on("progress",null,function(Fa){Fb.event("progress",Fa)}),Fc.on("error",null,function(Fa){Fe(null)}),Fb.loader=Fc;var Fd=this;function Fe(Fa){Fc.offAll(),Fc._data=null,Fc._customParse=!1,Fd._endLoad(Fb,Fa instanceof Array?[Fa]:Fa),Fd._loaders.push(Fc),Fd._loaderCount--,delete Fd._loaderMap[Fb.url],Fd._next()}Fc._class=Fb.clas,1<=Fb.priority?(Fc.priority=Fb.priority,Fc.realTime=!1):(Fc.priority=0,Fc.realTime=!0),Fc.load(Fb.url,Fb.type,Fb.cache,Fb.group,Fb.ignoreCache)},Fb._endLoad=function(Fa,Fb){var Fc=Fa.url;if(null==Fb){var Fd=this._failRes[Fc]||0;if(Fd<this.retryNum)return console.warn("[warn]Retry to load:",Fc),this._failRes[Fc]=Fd+1,void Fz.timer.once(this.retryDelay,this,this._addReTry,[Fa],!1);console.warn("[error]Failed to load:",Fc),this.event("error",Fc)}this._failRes[Fc]&&(this._failRes[Fc]=0),delete Fp._resMap[Fc],Fa.event("complete",Fb),Fa.destroy(),Fa.offAll(),this._infoPool.push(Fa)},Fb._addReTry=function(Fa){this._resInfos[this._maxPriority-1].push(Fa),this._next()},Fb.clearRes=function(Fa,Fb){void 0===Fb&&(Fb=!1),Fha.clearRes(Fa,Fb)},Fb.getRes=function(Fa){return Fha.getRes(Fa)},Fb.cacheRes=function(Fa,Fb){Fha.cacheRes(Fa,Fb)},Fb.clearTextureRes=function(Fa){Fha.clearTextureRes(Fa)},Fb.setGroup=function(Fa,Fb){Fha.setGroup(Fa,Fb)},Fb.clearResByGroup=function(Fa){Fha.clearResByGroup(Fa)},Fb.clearUnLoaded=function(){for(var Fa=0;Fa<this._maxPriority;Fa++){for(var Fb=this._resInfos[Fa],Fc=Fb.length-1;-1<Fc;Fc--){var Fd=Fb[Fc];Fd&&(Fd.destroy(),Fd.offAll(),this._infoPool.push(Fd))}Fb.length=0}this._loaderCount=0,Fp._resMap={}},Fb.cancelLoadByUrls=function(Fa){if(Fa)for(var Fb=0,Fc=Fa.length;Fb<Fc;Fb++)this.cancelLoadByUrl(Fa[Fb])},Fb.cancelLoadByUrl=function(Fa){for(var Fb=0;Fb<this._maxPriority;Fb++)for(var Fc=this._resInfos[Fb],Fd=Fc.length-1;-1<Fd;Fd--){var Fe=Fc[Fd];Fe&&Fe.url===Fa&&(Fc[Fd]=null,Fe.destroy(),Fe.offAll(),this._infoPool.push(Fe))}Fp._resMap[Fa]&&delete Fp._resMap[Fa]},Fb._loadAssets=function(Fa,Fc,Fg,Fb,Fd,Fe,Ff){null==Fd&&(Fd=2),null==Fe&&(Fe=!0);for(var Fh=Fa.length,Fi=0,Fj=0,Fm=[],Fn=!0,Fo=0;Fo<Fh;Fo++){var Fp=Fa[Fo];if(!Fp)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+Fa);"string"==typeof Fp&&(Fp={url:Fp,type:Fb,size:1,priority:Fd}),Fp.size||(Fp.size=1),Fp.progress=0,Fj+=Fp.size,Fm.push(Fp);var Fq=Fg?Fu.create(null,Ft,[Fp],!1):null,Fr=Fc||Fg?Fu.create(null,Fs,[Fp]):null;this.load(Fp.url,Fr,Fq,Fp.type,null!=Fp.priority&&0<=Fp.priority?Fp.priority:2,Fe,Fp.group||Ff)}function Fs(Fa,Fb){Fi++,Fa.progress=1,Fb||(Fn=!1),Fi===Fh&&Fc&&Fc.runWith(Fn)}function Ft(Fa,Fb){if(null!=Fg){Fa.progress=Fb;for(var Fc=0,Fd=0;Fd<Fm.length;Fd++){var Fe=Fm[Fd];Fc+=Fe.size*Fe.progress}var Ff=Fc/Fj;Fg.runWith(Ff)}}return this},Fp.cacheRes=function(Fa,Fb){Fha.cacheRes(Fa,Fb)},Fp._resMap={},Fi(Fp,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),Fp.__init$=function(){Fo=function(Fa){function Fb(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,Fb.__super.call(this)}return Fr(Fb,"",Fj),Fb.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},Fb}()},Fp}(),Fja=(function(Fa){function Fe(Fa){Fe.__super.call(this),Fa||(Fa=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var Fb=0,Fc=0,Fd=0;Fd<20;Fd++)Fd%5!=4?this._mat[Fb++]=Fa[Fd]:this._alpha[Fc++]=Fa[Fd];this._action=FF.createFilterAction(32),this._action.data=this}Fr(Fe,"laya.filters.ColorFilter",Ft);var Fb=Fe.prototype;Fz.imps(Fb,{"laya.filters.IFilter":!0}),Fb.callNative=function(Fa){Fa._$P.cf=this;Fa.conchModel&&Fa.conchModel.setFilterMatrix&&Fa.conchModel.setFilterMatrix(this._mat,this._alpha)},Fm(0,Fb,"type",function(){return 32}),Fm(0,Fb,"action",function(){return this._action})}(),function(Fa){function Fd(Fa,Fb,Fc){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===Fb&&(Fb=0),Fd.__super.call(this),this._byteClass=Fc||FP,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,Fa&&0<Fb&&Fb<65535&&this.connect(Fa,Fb)}Fr(Fd,"laya.net.Socket",Fj);var Fb=Fd.prototype;Fb.connect=function(Fa,Fb){var Fc="ws://"+Fa+":"+Fb;Fc="https:"==FO.window.location.protocol?"wss://"+Fa+":"+Fb:"ws://"+Fa+":"+Fb,this.connectByUrl(Fc)},Fb.connectByUrl=function(Fa){var Fb=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new FO.window.WebSocket(Fa,this.protocols):this._socket=new FO.window.WebSocket(Fa),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(Fa){Fb._onOpen(Fa)},this._socket.onmessage=function(Fa){Fb._onMessage(Fa)},this._socket.onclose=function(Fa){Fb._onClose(Fa)},this._socket.onerror=function(Fa){Fb._onError(Fa)}},Fb.cleanSocket=function(){try{this._socket.close()}catch(Fa){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},Fb.close=function(){if(null!=this._socket)try{this._socket.close()}catch(Fa){}},Fb._onOpen=function(Fa){this._connected=!0,this.event("open",Fa)},Fb._onMessage=function(Fa){if(Fa&&Fa.data){var Fb=Fa.data;if(this.disableInput&&Fb)this.event("message",Fb);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var Fc=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,Fb&&("string"==typeof Fb?this._input.writeUTFBytes(Fb):this._input.writeArrayBuffer(Fb),this._addInputPosition=this._input.pos,this._input.pos=Fc),this.event("message",Fb)}}},Fb._onClose=function(Fa){this._connected=!1,this.event("close",Fa)},Fb._onError=function(Fa){this.event("error",Fa)},Fb.send=function(Fa){this._socket.send(Fa)},Fb.flush=function(){if(this._output&&0<this._output.length){var Fb;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(Fa){Fb=Fa}this._output.endian=this.endian,this._output.clear(),Fb&&this.event("error",Fb)}},Fm(0,Fb,"input",function(){return this._input}),Fm(0,Fb,"output",function(){return this._output}),Fm(0,Fb,"connected",function(){return this._connected}),Fm(0,Fb,"endian",function(){return this._endian},function(Fa){this._endian=Fa,null!=this._input&&(this._input.endian=Fa),null!=this._output&&(this._output.endian=Fa)}),Fd.LITTLE_ENDIAN="littleEndian",Fd.BIG_ENDIAN="bigEndian"}(),function(Fa){function Fh(){Fh.__super.call(this),this._$1__id=++Fh._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(Fh._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,FN.currentResourceManager&&FN.currentResourceManager.addResource(this)}Fr(Fh,"laya.resource.Resource",Fj);var Fb=Fh.prototype;return Fz.imps(Fb,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),Fb._setUrl=function(Fa){var Fb;this._url!==Fa&&(this._url&&((Fb=Fh._urlResourcesMap[this._url]).splice(Fb.indexOf(this),1),0===Fb.length&&delete Fh._urlResourcesMap[this._url]),Fa&&((Fb=Fh._urlResourcesMap[Fa])||(Fh._urlResourcesMap[Fa]=Fb=[]),Fb.push(this)),this._url=Fa)},Fb._getGroup=function(){return this._group},Fb._setGroup=function(Fa){var Fb;this._group!==Fa&&(this._group&&((Fb=Fh._groupResourcesMap[this._group]).splice(Fb.indexOf(this),1),0===Fb.length&&delete Fh._groupResourcesMap[this._group]),Fa&&((Fb=Fh._groupResourcesMap[Fa])||(Fh._groupResourcesMap[Fa]=Fb=[]),Fb.push(this)),this._group=Fa)},Fb._addReference=function(){this._referenceCount++},Fb._removeReference=function(){this._referenceCount--},Fb._clearReference=function(){this._referenceCount=0},Fb._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},Fb.recreateResource=function(){this.completeCreate()},Fb.disposeResource=function(){},Fb.activeResource=function(Fa){void 0===Fa&&(Fa=!1),this._lastUseFrameCount=FX.loopCount,!this._destroyed&&this.__loaded&&(this._released||Fa)&&this.recreateResource()},Fb.releaseResource=function(Fa){return void 0===Fa&&(Fa=!0),!(!Fa&&this.lock)&&(!(this._released&&!Fa)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},Fb.onAsynLoaded=function(Fa,Fb,Fc){throw new Error("Resource: must override this function!")},Fb.destroy=function(){var Fa;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete Fh._idResourcesMap[this.id],this._url&&((Fa=Fh._urlResourcesMap[this._url])&&(Fa.splice(Fa.indexOf(this),1),0===Fa.length&&delete Fh._urlResourcesMap[this.url]),Fha.clearRes(this._url),this.__loaded||FF.cancelLoadByUrl(this._url)),this._group&&((Fa=Fh._groupResourcesMap[this._group]).splice(Fa.indexOf(this),1),0===Fa.length&&delete Fh._groupResourcesMap[this.url]))},Fb.completeCreate=function(){this._released=!1,this.event("recovered",this)},Fb.dispose=function(){this.destroy()},Fm(0,Fb,"memorySize",function(){return this._memorySize},function(Fa){var Fb=Fa-this._memorySize;this._memorySize=Fa,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,Fb),this.resourceManager&&this.resourceManager.addSize(Fb)}),Fm(0,Fb,"_loaded",null,function(Fa){this.__loaded=Fa}),Fm(0,Fb,"loaded",function(){return this.__loaded}),Fm(0,Fb,"id",function(){return this._$1__id}),Fm(0,Fb,"destroyed",function(){return this._destroyed}),Fm(0,Fb,"group",function(){return this._getGroup()},function(Fa){this._setGroup(Fa)}),Fm(0,Fb,"resourceManager",function(){return this._resourceManager}),Fm(0,Fb,"url",function(){return this._url}),Fm(0,Fb,"released",function(){return this._released}),Fm(0,Fb,"referenceCount",function(){return this._referenceCount}),Fh.getResourceByID=function(Fa){return Fh._idResourcesMap[Fa]},Fh.getResourceByURL=function(Fa,Fb){return void 0===Fb&&(Fb=0),null==Fh._urlResourcesMap[Fa]?null:Fh._urlResourcesMap[Fa][Fb]},Fh.getResourceCountByURL=function(Fa){return Fh._urlResourcesMap[Fa].length},Fh.destroyUnusedResources=function(Fa){var Fb;if(Fa){var Fc=Fh._groupResourcesMap[Fa];if(Fc)for(var Fd=Fc.slice(),Fe=0,Ff=Fd.length;Fe<Ff;Fe++)(Fb=Fd[Fe]).lock||0!==Fb._referenceCount||Fb.destroy()}else for(var Fg in Fh._idResourcesMap)(Fb=Fh._idResourcesMap[Fg]).lock||0!==Fb._referenceCount||Fb.destroy()},Fh._uniqueIDCounter=0,Fh._idResourcesMap={},Fh._urlResourcesMap={},Fh._groupResourcesMap={},Fh}()),Fma=function(Fa){function FC(Fa,Fb){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,FC.__super.call(this),Fa&&null!=Fa._addReference&&Fa._addReference(),this.setTo(Fa,Fb)}Fr(FC,"laya.resource.Texture",Fj);var Fb=FC.prototype;return Fb._setUrl=function(Fa){this.url=Fa},Fb.setTo=function(Fa,Fb){if(Fa instanceof Fg.HTMLElement){var Fc=Fva.create("2D",Fa);this.bitmap=Fc}else this.bitmap=Fa;if(this.uv=Fb||FC.DEF_UV,Fa){this._w=Fa.width,this._h=Fa.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var Fd=this;if(this._loaded)FF.addToAtlas&&FF.addToAtlas(Fd);else{var Fe=Fa;Fe instanceof laya.resource.HTMLImage&&Fe.image&&Fe.image.addEventListener("load",function(Fa){FF.addToAtlas&&FF.addToAtlas(Fd)},!1)}}},Fb.active=function(){this.bitmap&&this.bitmap.activeResource()},Fb.destroy=function(Fa){if(void 0===Fa&&(Fa=!1),this.alphaTexture&&(this.alphaTexture.destroy(Fa),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var Fb=this.bitmap;Fa?(FJ.isConchApp&&Fb.source&&Fb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Fb.dispose(),Fb._clearReference()):(Fb._removeReference(),0==Fb.referenceCount&&(FJ.isConchApp&&Fb.source&&Fb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Fb.dispose())),this.url&&this===Fz.loader.getRes(this.url)&&Fz.loader.clearRes(this.url,Fa),this._loaded=!1}},Fb.load=function(Fa){var Fb=this;this._loaded=!1,Fa=FI.customFormat(Fa);var Fc=this.bitmap||(this.bitmap=Fya.create(Fa));Fc.uri=Fa,Fc&&Fc._addReference();var Fd=this;Fc.onload=function(){Fc.onload=null,Fd._loaded=!0,Fb.sourceWidth=Fb._w=Fc.width,Fb.sourceHeight=Fb._h=Fc.height,Fd.event("loaded",this),FF.addToAtlas&&FF.addToAtlas(Fd)}},Fb.addTextureToAtlas=function(Fa){FF.addTextureToAtlas(this)},Fb.getPixels=function(Fa,Fb,Fc,Fd){if(FJ.isConchApp){var Fe=this.bitmap;if(Fe.source&&Fe.source.getImageData){var Ff=Fe.source.getImageData(Fa,Fb,Fc,Fd),Fg=new Uint8Array(Ff);return Array.from(Fg)}return null}return FJ.isWebGL?FF.getTexturePixels(this,Fa,Fb,Fc,Fd):(FO.canvas.size(Fc,Fd),FO.canvas.clear(),FO.context.drawTexture(this,-Fa,-Fb,this.width,this.height,0,0),FO.context.getImageData(0,0,Fc,Fd).data)},Fb.onAsynLoaded=function(Fa,Fb){if(Fb){if("function"!=typeof Fb._addReference)throw new Error("bitmap._addReference is not a function. "+Fb.className+" "+typeof Fb._addReference+" "+Fb.constructor);Fb._addReference()}this.setTo(Fb,this.uv),this._loaded&&this.event("loaded",this)},Fm(0,Fb,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),Fm(0,Fb,"loaded",function(){return this._loaded}),Fm(0,Fb,"released",function(){return!this.bitmap||this.bitmap.released}),Fm(0,Fb,"width",function(){return this._w?this._w:this.uv&&this.uv!==FC.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(Fa){this._w=Fa,this.sourceWidth||(this.sourceWidth=Fa)}),Fm(0,Fb,"repeat",function(){return!FJ.isWebGL||!this.bitmap||this.bitmap.repeat},function(Fa){Fa&&FJ.isWebGL&&this.bitmap&&(this.bitmap.repeat=Fa)&&(this.bitmap.enableMerageInAtlas=!1)}),Fm(0,Fb,"height",function(){return this._h?this._h:this.uv&&this.uv!==FC.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(Fa){this._h=Fa,this.sourceHeight||(this.sourceHeight=Fa)}),Fm(0,Fb,"isLinearSampling",function(){return!FJ.isWebGL||9728!=this.bitmap.minFifter},function(Fa){!Fa&&FJ.isWebGL&&(Fa||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),FC.moveUV=function(Fa,Fb,Fc){for(var Fd=0;Fd<8;Fd+=2)Fc[Fd]+=Fa,Fc[Fd+1]+=Fb;return Fc},FC.create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){void 0===Ff&&(Ff=0),void 0===Fg&&(Fg=0),void 0===Fh&&(Fh=0),void 0===Fi&&(Fi=0);var Fj=Fa instanceof laya.resource.Texture,Fm=Fj?Fa.uv:FC.DEF_UV,Fn=Fj?Fa.bitmap:Fa,Fo=FF.isAtlas(Fn);if(Fo){var Fp=Fn._atlaser,Fq=Fa._atlasID;if(-1==Fq)throw new Error("create texture error");Fn=Fp._inAtlasTextureBitmapValue[Fq],Fm=Fp._inAtlasTextureOriUVValue[Fq]}var Fr=new FC(Fn,null);Fn.width&&Fb+Fd>Fn.width&&(Fd=Fn.width-Fb),Fn.height&&Fc+Fe>Fn.height&&(Fe=Fn.height-Fc),Fr.width=Fd,Fr.height=Fe,Fr.offsetX=Ff,Fr.offsetY=Fg,Fr.sourceWidth=Fh||Fd,Fr.sourceHeight=Fi||Fe;var Fs=1/Fn.width,Ft=1/Fn.height;Fb*=Fs,Fc*=Ft,Fd*=Fs,Fe*=Ft;var Fu=Fr.uv[0],Fv=Fr.uv[1],Fw=Fr.uv[4],Fx=Fr.uv[5],Fy=Fw-Fu,Fz=Fx-Fv,FA=FC.moveUV(Fm[0],Fm[1],[Fb,Fc,Fb+Fd,Fc,Fb+Fd,Fc+Fe,Fb,Fc+Fe]);Fr.uv=[Fu+FA[0]*Fy,Fv+FA[1]*Fz,Fw-(1-FA[2])*Fy,Fv+FA[3]*Fz,Fw-(1-FA[4])*Fy,Fx-(1-FA[5])*Fz,Fu+FA[6]*Fy,Fx-(1-FA[7])*Fz],Fo&&Fr.addTextureToAtlas();var FB=Fn.scaleRate;return FB&&1!=FB?(Fr.sourceWidth/=FB,Fr.sourceHeight/=FB,Fr.width/=FB,Fr.height/=FB,Fr.scaleRate=FB,Fr.offsetX/=FB,Fr.offsetY/=FB):Fr.scaleRate=1,Fr},FC.createFromTexture=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fa.scaleRate;1!=Ff&&(Fb*=Ff,Fc*=Ff,Fd*=Ff,Fe*=Ff);var Fg=FB.TEMP.setTo(Fb-Fa.offsetX,Fc-Fa.offsetY,Fd,Fe),Fh=Fg.intersection(FC._rect1.setTo(0,0,Fa.width,Fa.height),FC._rect2);if(!Fh)return null;var Fi=FC.create(Fa,Fh.x,Fh.y,Fh.width,Fh.height,Fh.x-Fg.x,Fh.y-Fg.y,Fd,Fe);if(Fi.bitmap&&Fi.bitmap._removeReference)return Fi.bitmap._removeReference(),Fi;var Fj="bitmap:"+(Fi.bitmap?Fi.bitmap.constructor?Fi.bitmap.constructor.name:Fi.bitmap.__className:"")+", url:"+(Fa.url+" | "+(Fi.bitmap?Fi.bitmap.url:Fa.url))+", x="+Fb+",y="+Fc+",width="+Fd+",height="+Fe+", result="+(Fh?Fh.x+","+Fh.y+","+Fh.width+","+Fh.height:"null")+", rect="+Fg.x+","+Fg.y+","+Fg.width+","+Fg.height;throw new Error("报错：bitmap._removeReference is not a function  "+Fj)},FC.DEF_UV=[0,0,1,0,1,1,0,1],FC.INV_UV=[0,1,1,1,1,0,0,0],FC._rect1=new FB,FC._rect2=new FB,FC}(),Fa=function(Fa){var Fh;function Ff(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,Ff.__super.call(this)}Fr(Ff,"laya.utils.TimeLine",Fj);var Fb=Ff.prototype;return Fb.to=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fe&&(Fe=0),this._create(Fa,Fb,Fc,Fd,Fe,!0)},Fb.from=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fe&&(Fe=0),this._create(Fa,Fb,Fc,Fd,Fe,!1)},Fb._create=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=FW.getItemByClass("tweenData",Fh);return Fg.isTo=Ff,Fg.type=0,Fg.target=Fa,Fg.duration=Fc,Fg.data=Fb,Fg.startTime=this._startTime+Fe,Fg.endTime=Fg.startTime+Fg.duration,Fg.ease=Fd,this._startTime=Math.max(Fg.endTime,this._startTime),this._tweenDataList.push(Fg),this._startTimeSort=!0,this._endTimeSort=!0,this},Fb.addLabel=function(Fa,Fb){var Fc=FW.getItemByClass("tweenData",Fh);return Fc.type=1,Fc.data=Fa,Fc.endTime=Fc.startTime=this._startTime+Fb,this._labelDic||(this._labelDic={}),this._labelDic[Fa]=Fc,this._tweenDataList.push(Fc),this},Fb.removeLabel=function(Fa){if(this._labelDic&&this._labelDic[Fa]){var Fb=this._labelDic[Fa];if(Fb){var Fc=this._tweenDataList.indexOf(Fb);-1<Fc&&this._tweenDataList.splice(Fc,1)}delete this._labelDic[Fa]}},Fb.gotoTime=function(Fa){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var Fb,Fc,Fd,Fe;for(var Ff in this._firstTweenDic)if(Fc=this._firstTweenDic[Ff])for(var Fg in Fc)Fc.diyTarget.hasOwnProperty(Fg)&&(Fc.diyTarget[Fg]=Fc[Fg]);for(Ff in this._tweenDic)(Fb=this._tweenDic[Ff]).clear(),delete this._tweenDic[Ff];if(this._index=0,this._gidIndex=0,this._currTime=Fa,this._lastTime=FO.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=Fd=this._tweenDataList.concat(),Fd.sort(function(Fa,Fb){return Fa.endTime>Fb.endTime?1:Fa.endTime<Fb.endTime?-1:0})}else Fd=this._endTweenDataList;for(var Fh=0,Fi=Fd.length;Fh<Fi;Fh++)if(0==(Fe=Fd[Fh]).type){if(!(Fa>=Fe.endTime))break;this._index=Math.max(this._index,Fh+1);var Fj=Fe.data;if(Fe.isTo)for(var Fm in Fj)Fe.target[Fm]=Fj[Fm]}for(Fh=0,Fi=this._tweenDataList.length;Fh<Fi;Fh++)0==(Fe=this._tweenDataList[Fh]).type&&Fa>=Fe.startTime&&Fa<Fe.endTime&&(this._index=Math.max(this._index,Fh+1),this._gidIndex++,(Fb=FW.getItemByClass("tween",FZ))._create(Fe.target,Fe.data,Fe.duration,Fe.ease,Fu.create(this,this._animComplete,[this._gidIndex]),0,!1,Fe.isTo,!0,!1),Fb.setStartTime(this._currTime-(Fa-Fe.startTime)),Fb._updateEase(this._currTime),Fb.gid=this._gidIndex,this._tweenDic[this._gidIndex]=Fb)}},Fb.gotoLabel=function(Fa){if(null!=this._labelDic){var Fb=this._labelDic[Fa];Fb&&this.gotoTime(Fb.startTime)}},Fb.pause=function(){Fz.timer.clear(this,this._update)},Fb.resume=function(){this.play(this._currTime,this._loopKey)},Fb.play=function(Fa,Fb){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(Fa,Fb){return Fa.startTime>Fb.startTime?1:Fa.startTime<Fb.startTime?-1:0});for(var Fc=0,Fd=this._tweenDataList.length;Fc<Fd;Fc++){var Fe=this._tweenDataList[Fc];if(null!=Fe&&0==Fe.type){var Ff=Fe.target,Fg=Ff.$_GID||(Ff.$_GID=F$.getGID()),Fh=null;for(var Fi in null==this._firstTweenDic[Fg]?((Fh={}).diyTarget=Ff,this._firstTweenDic[Fg]=Fh):Fh=this._firstTweenDic[Fg],Fe.data)null==Fh[Fi]&&(Fh[Fi]=Ff[Fi])}}}"string"==typeof Fa?this.gotoLabel(Fa):this.gotoTime(Fa),this._loopKey=Fb,this._lastTime=FO.now(),Fz.timer.frameLoop(1,this,this._update)}},Fb._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var Fa in this._tweenDic)(Fb=this._tweenDic[Fa]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var Fb,Fc=FO.now(),Fd=Fc-this._lastTime,Fe=this._currTime+=Fd*this.scale;for(Fa in this._lastTime=Fc,this._tweenDic)(Fb=this._tweenDic[Fa])._updateEase(Fe);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var Ff=this._tweenDataList[this._index];Fe>=Ff.startTime&&(this._index++,0==Ff.type?(this._gidIndex++,(Fb=FW.getItemByClass("tween",FZ))._create(Ff.target,Ff.data,Ff.duration,Ff.ease,Fu.create(this,this._animComplete,[this._gidIndex]),0,!1,Ff.isTo,!0,!1),Fb.setStartTime(Fe),Fb.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=Fb)._updateEase(Fe)):this.event("label",Ff.data))}},Fb._animComplete=function(Fa){this._tweenDic[Fa]&&delete this._tweenDic[Fa]},Fb._complete=function(){this.event("complete")},Fb.reset=function(){var Fa;if(this._labelDic)for(Fa in this._labelDic)delete this._labelDic[Fa];for(Fa in this._tweenDic)this._tweenDic[Fa].clear(),delete this._tweenDic[Fa];for(Fa in this._firstTweenDic)delete this._firstTweenDic[Fa];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var Fb,Fc=0;for(Fb=this._tweenDataList.length,Fc=0;Fc<Fb;Fc++)this._tweenDataList[Fc]&&this._tweenDataList[Fc].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,Fz.timer.clear(this,this._update)},Fb.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},Fm(0,Fb,"index",function(){return this._frameIndex},function(Fa){this._frameIndex=Fa,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),Fm(0,Fb,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),Ff.to=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fe&&(Fe=0),(new Ff).to(Fa,Fb,Fc,Fd,Fe)},Ff.from=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fe&&(Fe=0),(new Ff).from(Fa,Fb,Fc,Fd,Fe)},Ff.__init$=function(){Fh=function(){function Fa(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return Fr(Fa,""),Fa.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,FW.recover("tweenData",this)},Fa}()},Ff}(),Fna=function(Fe){function Fc(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,Fc.__super.call(this),this._style=Fh.EMPTY}Fr(Fc,"laya.display.Sprite",Fe);var Fa=Fc.prototype;return Fz.imps(Fa,{"laya.display.ILayout":!0}),Fa.createConchModel=function(){return new ConchNode},Fa.destroy=function(Fa){if(void 0===Fa&&(Fa=!0),this._releaseMem(),!this._destroyed){this.filters=null;var Fb=this.mask;Fb&&(this.mask=null,Fb.destroy(Fa))}Fe.prototype.destroy.call(this,Fa),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},Fa.updateZOrder=function(){F$.updateOrder(this._childs)&&this.repaint()},Fa.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},Fa.setBounds=function(Fa){this._set$P("uBounds",Fa)},Fa.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new FB),FB._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},Fa.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new FB),FB._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},Fa._boundPointsToParent=function(Fa){void 0===Fa&&(Fa=!1);var Fb=0,Fc=0;this._style&&(Fb=this._style._tf.translateX,Fc=this._style._tf.translateY,Fa=Fa||0!==this._style._tf.rotate,this._style.scrollRect&&(Fb+=this._style.scrollRect.x,Fc+=this._style.scrollRect.y));var Fd=this._getBoundPointsM(Fa);if(!Fd||Fd.length<1)return Fd;if(8!=Fd.length&&(Fd=Fa?Fx.scanPList(Fd):FB._getWrapRec(Fd,FB.TEMP)._getBoundPoints()),!this.transform)return F$.transPointList(Fd,this._x-Fb,this._y-Fc),Fd;var Fe=FA.TEMP,Ff=0,Fg=Fd.length;for(Ff=0;Ff<Fg;Ff+=2)Fe.x=Fd[Ff],Fe.y=Fd[Ff+1],this.toParentPoint(Fe),Fd[Ff]=Fe.x,Fd[Ff+1]=Fe.y;return Fd},Fa.getGraphicBounds=function(Fa){return void 0===Fa&&(Fa=!1),this._graphics?this._graphics.getBounds(Fa):FB.TEMP.setTo(0,0,0,0)},Fa._getBoundPointsM=function(Fa){if(void 0===Fa&&(Fa=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var Fb=F$.clearArray(this._$P.temBM),Fc=FB.TEMP;return Fc.copyFrom(this.scrollRect),F$.concatArray(Fb,Fc._getBoundPoints()),Fb}for(var Fd,Fe,Ff,Fg=this._graphics?this._graphics.getBoundPoints():F$.clearArray(this._$P.temBM),Fh=0,Fi=(Ff=this._childs).length;Fh<Fi;Fh++)(Fd=Ff[Fh])instanceof laya.display.Sprite&&1==Fd.visible&&(Fe=Fd._boundPointsToParent(Fa))&&(Fg=Fg?F$.concatArray(Fg,Fe):Fe);return Fg},Fa.getStyle=function(){return this._style===Fh.EMPTY&&(this._style=new Fh),this._style},Fa.setStyle=function(Fa){this._style=Fa},Fa._adjustTransform=function(){this._tfChanged=!1;var Fa,Fb=this._style._tf,Fc=Fb.scaleX,Fd=Fb.scaleY;if(Fb.rotate||1!==Fc||1!==Fd||Fb.skewX||Fb.skewY){(Fa=this._transform||(this._transform=FG.create())).bTransform=!0;var Fe=.0174532922222222*(Fb.rotate-Fb.skewX),Ff=.0174532922222222*(Fb.rotate+Fb.skewY),Fg=Math.cos(Ff),Fh=Math.sin(Ff),Fi=Math.sin(Fe),Fj=Math.cos(Fe);return Fa.a=Fc*Fg,Fa.b=Fc*Fh,Fa.c=-Fd*Fi,Fa.d=Fd*Fj,Fa.tx=Fa.ty=0,Fa}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,Fa},Fa.pos=function(Fa,Fb,Fc){if(void 0===Fc&&(Fc=!1),this._x!==Fa||this._y!==Fb){if(this.destroyed)return this;if(Fc){this._x=Fa,this._y=Fb,this.conchModel&&this.conchModel.pos(this._x,this._y);var Fd=this._parent;Fd&&0===Fd._repaint&&(Fd._repaint=1,Fd.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=Fa,this.y=Fb}return this},Fa.pivot=function(Fa,Fb){return this.pivotX=Fa,this.pivotY=Fb,this},Fa.size=function(Fa,Fb){return this.width=Fa,this.height=Fb,this},Fa.scale=function(Fa,Fb,Fc){void 0===Fc&&(Fc=!1);var Fd=this.getStyle(),Fe=Fd._tf;if(Fe.scaleX!=Fa||Fe.scaleY!=Fb){if(this.destroyed)return this;if(Fc){Fd.setScale(Fa,Fb),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Fa,Fb),this._renderType|=4;var Ff=this._parent;Ff&&0===Ff._repaint&&(Ff._repaint=1,Ff.parentRepaint())}else this.scaleX=Fa,this.scaleY=Fb}return this},Fa.skew=function(Fa,Fb){return this.skewX=Fa,this.skewY=Fb,this},Fa.render=function(Fa,Fb,Fc){FX.spriteCount++,FL.renders[this._renderType]._fun(this,Fa,Fb+this._x,Fc+this._y),this._repaint=0},Fa.drawToCanvas=function(Fa,Fb,Fc,Fd){if(FJ.isConchNode){var Fe=Fva.create("2D");return new FK(Fa,Fb,Fe).ctx.setCanvasType(1),this.conchModel.drawToCanvas(Fe.source,Fc,Fd),Fe}return FF.drawToCanvas(this,this._renderType,Fa,Fb,Fc,Fd)},Fa.customRender=function(Fa,Fb,Fc){this._renderType|=1024},Fa._applyFilters=function(){var Fa;if(!FJ.isWebGL&&((Fa=this._$P.filters)&&!(Fa.length<1)))for(var Fb=0,Fc=Fa.length;Fb<Fc;Fb++)Fa[Fb].action.apply(this._$P.cacheCanvas)},Fa._isHaveGlowFilter=function(){var Fa,Fb=0;if(this.filters)for(Fb=0;Fb<this.filters.length;Fb++)if(8==this.filters[Fb].type)return!0;for(Fb=0,Fa=this._childs.length;Fb<Fa;Fb++)if(this._childs[Fb]._isHaveGlowFilter())return!0;return!1},Fa.localToGlobal=function(Fa,Fb){void 0===Fb&&(Fb=!1),!0===Fb&&(Fa=new FA(Fa.x,Fa.y));for(var Fc=this;Fc&&Fc!=Fz.stage;)Fa=Fc.toParentPoint(Fa),Fc=Fc.parent;return Fa},Fa.globalToLocal=function(Fa,Fb){void 0===Fb&&(Fb=!1),Fb&&(Fa=new FA(Fa.x,Fa.y));for(var Fc=this,Fd=[];Fc&&Fc!=Fz.stage;)Fd.push(Fc),Fc=Fc.parent;for(var Fe=Fd.length-1;0<=Fe;)Fa=(Fc=Fd[Fe]).fromParentPoint(Fa),Fe--;return Fa},Fa.toParentPoint=function(Fa){if(!Fa)return Fa;Fa.x-=this.pivotX,Fa.y-=this.pivotY,this.transform&&this._transform.transformPoint(Fa),Fa.x+=this._x,Fa.y+=this._y;var Fb=this._style.scrollRect;return Fb&&(Fa.x-=Fb.x,Fa.y-=Fb.y),Fa},Fa.fromParentPoint=function(Fa){if(!Fa)return Fa;Fa.x-=this._x,Fa.y-=this._y;var Fb=this._style.scrollRect;return Fb&&(Fa.x+=Fb.x,Fa.y+=Fb.y),this.transform&&this._transform.invertTransformPoint(Fa),Fa.x+=this.pivotX,Fa.y+=this.pivotY,Fa},Fa.on=function(Fa,Fb,Fc,Fd){return 1!==this._mouseEnableState&&this.isMouseEvent(Fa)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Fa,Fb,Fc,Fd,!1)):Fe.prototype.on.call(this,Fa,Fb,Fc,Fd)},Fa.once=function(Fa,Fb,Fc,Fd){return 1!==this._mouseEnableState&&this.isMouseEvent(Fa)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Fa,Fb,Fc,Fd,!0)):Fe.prototype.once.call(this,Fa,Fb,Fc,Fd)},Fa._$2__onDisplay=function(){if(1!==this._mouseEnableState){var Fa=this;for(Fa=Fa.parent;Fa&&1!==Fa._mouseEnableState&&!Fa._getBit(2);)Fa.mouseEnabled=!0,Fa._setBit(2,!0),Fa=Fa.parent}},Fa.loadImage=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=this;return void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),this.graphics.loadImage(Fa,Fb,Fc,Fd,Fe,function(Fa){Fg.destroyed||(Fg.size(Fb+(Fd||Fa.width),Fc+(Fe||Fa.height)),Fg.repaint(),Ff&&Ff.runWith(Fa))}),this},Fa.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},Fa._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},Fa._childChanged=function(Fa){this._childs.length?this._renderType|=2048:this._renderType&=-2049,Fa&&this._get$P("hasZorder")&&Fz.timer.callLater(this,this.updateZOrder),this.repaint()},Fa.parentRepaint=function(){var Fa=this._parent;Fa&&0===Fa._repaint&&(Fa._repaint=1,Fa.parentRepaint())},Fa.startDrag=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){void 0===Fb&&(Fb=!1),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=300),void 0===Ff&&(Ff=!1),void 0===Fg&&(Fg=.92),this._$P.dragging||this._set$P("dragging",new FT),this._$P.dragging.start(this,Fa,Fb,Fc,Fd,Fe,Ff,Fg)},Fa.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},Fa._releaseMem=function(){if(this._$P){var Fa=this._$P.cacheCanvas;Fa&&Fa.ctx&&(FW.recover("RenderContext",Fa.ctx),Fa.ctx.canvas.size(0,0),Fa.ctx=null);var Fb=this._$P._filterCache;Fb&&(Fb.destroy(),Fb.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},Fa._setDisplay=function(Fa){Fa||this._releaseMem(),Fe.prototype._setDisplay.call(this,Fa)},Fa.hitTestPoint=function(Fa,Fb){var Fc=this.globalToLocal(FA.TEMP.setTo(Fa,Fb));return Fa=Fc.x,Fb=Fc.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?FB.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(Fa,Fb)},Fa.getMousePoint=function(){return this.globalToLocal(FA.TEMP.setTo(Fz.stage.mouseX,Fz.stage.mouseY))},Fa._getWords=function(){return null},Fa._addChildsToLayout=function(Fa){var Fb=this._getWords();if(null==Fb&&0==this._childs.length)return!1;if(Fb)for(var Fc=0,Fd=Fb.length;Fc<Fd;Fc++)Fa.push(Fb[Fc]);Fc=0;for(var Fe=this._childs.length;Fc<Fe;++Fc){var Ff=this._childs[Fc];Ff._style._enableLayout()&&Ff._addToLayout(Fa)}return!0},Fa._addToLayout=function(Fa){this._style.absolute||(this._style.block?Fa.push(this):this._addChildsToLayout(Fa)&&(this.x=this.y=0))},Fa._isChar=function(){return!1},Fa._getCSSStyle=function(){return this._style.getCSSStyle()},Fa._setAttributes=function(Fa,Fb){switch(Fa){case"x":this.x=parseFloat(Fb);break;case"y":this.y=parseFloat(Fb);break;case"width":this.width=parseFloat(Fb);break;case"height":this.height=parseFloat(Fb);break;default:this[Fa]=Fb}},Fa._layoutLater=function(){this.parent&&this.parent._layoutLater()},Fm(0,Fa,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(Fa){this._optimizeScrollRect!=Fa&&(this._optimizeScrollRect=Fa,this.conchModel&&this.conchModel.optimizeScrollRect(Fa))}),Fm(0,Fa,"customRenderEnable",null,function(Fa){if(Fa&&(this._renderType|=1024,FJ.isConchNode)){Fc.CustomList.push(this);var Fb=new Fva("2d");Fb._setContext(new CanvasRenderingContext2D),this.customContext=new FK(0,0,Fb),Fb.context.setCanvasType&&Fb.context.setCanvasType(2),this.conchModel.custom(Fb.context)}}),Fm(0,Fa,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(Fa){this.cacheAs=Fa?this._$P.hasFilter?"none":"normal":"none"}),Fm(0,Fa,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(Fa){var Fb=this._$P.cacheCanvas;if(Fa!==(Fb?Fb.type:"none")){if("none"!==Fa)this._getBit(1)||this._setUpNoticeType(1),Fb||(Fb=this._set$P("cacheCanvas",FW.getItemByClass("cacheCanvas",Object))),Fb.type=Fa,Fb.reCache=!0,this._renderType|=16,"bitmap"==Fa&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(Fb){var Fc=Fb;Fc&&Fc.ctx&&(FW.recover("RenderContext",Fc.ctx),Fc.ctx.canvas.size(0,0),Fc.ctx=null),FW.recover("cacheCanvas",Fb)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),Fm(0,Fa,"zOrder",function(){return this._zOrder},function(Fa){this._zOrder!=Fa&&(this._zOrder=Fa,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(Fa),this._parent&&(Fa&&this._parent._set$P("hasZorder",!0),Fz.timer.callLater(this._parent,this.updateZOrder)))}),Fm(0,Fa,"rotation",function(){return this._style._tf.rotate},function(Fa){var Fb=this.getStyle();if(Fb._tf.rotate!==Fa){Fb.setRotate(Fa),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(Fa),this._renderType|=4;var Fc=this._parent;Fc&&0===Fc._repaint&&(Fc._repaint=1,Fc.parentRepaint())}}),Fm(0,Fa,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Fa){this._width!==Fa&&(this._width=Fa,this.conchModel&&this.conchModel.size(Fa,this._height),this.repaint())}),Fm(0,Fa,"x",function(){return this._x},function(Fa){if(this._x!==Fa){if(this.destroyed)return;this._x=Fa,this.conchModel&&this.conchModel.pos(Fa,this._y);var Fb=this._parent;Fb&&0===Fb._repaint&&(Fb._repaint=1,Fb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Fm(0,Fa,"globalScaleY",function(){for(var Fa=1,Fb=this;Fb&&Fb!==Fz.stage;)Fa*=Fb.scaleY,Fb=Fb.parent;return Fa}),Fm(0,Fa,"hitArea",function(){return this._$P.hitArea},function(Fa){this._set$P("hitArea",Fa)}),Fm(0,Fa,"staticCache",function(){return this._$P.staticCache},function(Fa){this._set$P("staticCache",Fa),Fa||this.reCache()}),Fm(0,Fa,"texture",function(){return this._texture},function(Fa){this._texture!=Fa&&(this._texture=Fa,this.graphics.cleanByTexture(Fa,0,0))}),Fm(0,Fa,"y",function(){return this._y},function(Fa){if(this._y!==Fa){if(this.destroyed)return;this._y=Fa,this.conchModel&&this.conchModel.pos(this._x,Fa);var Fb=this._parent;Fb&&0===Fb._repaint&&(Fb._repaint=1,Fb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Fm(0,Fa,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Fa){this._height!==Fa&&(this._height=Fa,this.conchModel&&this.conchModel.size(this._width,Fa),this.repaint())}),Fm(0,Fa,"blendMode",function(){return this._style.blendMode},function(Fa){this.getStyle().blendMode=Fa,this.conchModel&&this.conchModel.blendMode(Fa),Fa&&"source-over"!=Fa?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),Fm(0,Fa,"scaleX",function(){return this._style._tf.scaleX},function(Fa){var Fb=this.getStyle();if(Fb._tf.scaleX!==Fa){Fb.setScaleX(Fa),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Fa,Fb._tf.scaleY),this._renderType|=4;var Fc=this._parent;Fc&&0===Fc._repaint&&(Fc._repaint=1,Fc.parentRepaint())}}),Fm(0,Fa,"scaleY",function(){return this._style._tf.scaleY},function(Fa){var Fb=this.getStyle();if(Fb._tf.scaleY!==Fa){Fb.setScaleY(Fa),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Fb._tf.scaleX,Fa),this._renderType|=4;var Fc=this._parent;Fc&&0===Fc._repaint&&(Fc._repaint=1,Fc.parentRepaint())}}),Fm(0,Fa,"stage",function(){return Fz.stage}),Fm(0,Fa,"skewX",function(){return this._style._tf.skewX},function(Fa){var Fb=this.getStyle();if(Fb._tf.skewX!==Fa){Fb.setSkewX(Fa),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Fa,Fb._tf.skewY),this._renderType|=4;var Fc=this._parent;Fc&&0===Fc._repaint&&(Fc._repaint=1,Fc.parentRepaint())}}),Fm(0,Fa,"scrollRect",function(){return this._style.scrollRect},function(Fa){this.getStyle().scrollRect=Fa,this.repaint(),Fa?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(Fa.x,Fa.y,Fa.width,Fa.height)):(this._renderType&=-129,this.conchModel&&(Fc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),Fm(0,Fa,"skewY",function(){return this._style._tf.skewY},function(Fa){var Fb=this.getStyle();if(Fb._tf.skewY!==Fa){Fb.setSkewY(Fa),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Fb._tf.skewX,Fa),this._renderType|=4;var Fc=this._parent;Fc&&0===Fc._repaint&&(Fc._repaint=1,Fc.parentRepaint())}}),Fm(0,Fa,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(Fa){this._tfChanged=!1,(this._transform=Fa)&&(this._x=Fa.tx,this._y=Fa.ty,Fa.tx=Fa.ty=0,this.conchModel&&this.conchModel.transform(Fa.a,Fa.b,Fa.c,Fa.d,this._x,this._y)),Fa?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),Fm(0,Fa,"pivotX",function(){return this._style._tf.translateX},function(Fa){this.getStyle().setTranslateX(Fa),this.conchModel&&this.conchModel.pivot(Fa,this._style._tf.translateY),this.repaint()}),Fm(0,Fa,"pivotY",function(){return this._style._tf.translateY},function(Fa){this.getStyle().setTranslateY(Fa),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,Fa),this.repaint()}),Fm(0,Fa,"alpha",function(){return this._style.alpha},function(Fa){this._style&&this._style.alpha!==Fa&&(Fa=Fa<0?0:1<Fa?1:Fa,this.getStyle().alpha=Fa,this.conchModel&&this.conchModel.alpha(Fa),1!==Fa?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),Fm(0,Fa,"visible",function(){return this._style.visible},function(Fa){this._style&&this._style.visible!==Fa&&(this.getStyle().visible=Fa,this.conchModel&&this.conchModel.visible(Fa),this.parentRepaint())}),Fm(0,Fa,"graphics",function(){return this._graphics||(this.graphics=FF.createGraphics())},function(Fa){this._graphics&&(this._graphics._sp=null),(this._graphics=Fa)?(this._renderType&=-2,this._renderType|=512,(Fa._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(Fc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),Fm(0,Fa,"filters",function(){return this._$P.filters},function(Fa){Fa&&0===Fa.length&&(Fa=null),this._$P.filters!=Fa&&(this._set$P("filters",Fa?Fa.slice():null),FJ.isConchApp&&(this.conchModel&&(Fc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),FJ.isWebGL&&(Fa&&Fa.length?this._renderType|=32:this._renderType&=-33),Fa&&0<Fa.length?(this._getBit(1)||this._setUpNoticeType(1),FJ.isWebGL&&1==Fa.length&&Fa[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(FJ.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),Fm(0,Fa,"parent",Fe.prototype._$get_parent,function(Fa){Fz.superSet(Faa,this,"parent",Fa),Fa&&this._getBit(2)&&this._$2__onDisplay()}),Fm(0,Fa,"mask",function(){return this._$P._mask},function(Fa){Fa&&this.mask&&this.mask._$P.maskParent||(Fa?(this.cacheAs="bitmap",this._set$P("_mask",Fa),Fa._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",Fa),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(Fa?Fa.conchModel:null),this._renderType|=64,this.parentRepaint())}),Fm(0,Fa,"mouseEnabled",function(){return 1<this._mouseEnableState},function(Fa){this._mouseEnableState=Fa?2:1}),Fm(0,Fa,"globalScaleX",function(){for(var Fa=1,Fb=this;Fb&&Fb!==Fz.stage;)Fa*=Fb.scaleX,Fb=Fb.parent;return Fa}),Fm(0,Fa,"mouseX",function(){return this.getMousePoint().x}),Fm(0,Fa,"mouseY",function(){return this.getMousePoint().y}),Fc.fromImage=function(Fa){return(new Fc).loadImage(Fa)},Fc._cachePool=[],Fc.CustomList=[],Fi(Fc,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=Fg.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),Fc}(Faa),Foa=function(Fa){function Fb(Fa){this._audio=null,this._onEnd=null,this._resumePlay=null,Fb.__super.call(this),this._onEnd=F$.bind(this.__onEnd,this),this._resumePlay=F$.bind(this.__resumePlay,this),Fa.addEventListener("ended",this._onEnd),this._audio=Fa}Fr(Fb,"laya.media.h5audio.AudioSoundChannel",Fda);var Fc=Fb.prototype;return Fc.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(Fz.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Fc.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,FO.container.appendChild(this._audio),this._audio.play()}catch(Fa){this.event("error")}},Fc.play=function(Fa){this.isStopped=!1;try{this._audio.playbackRate=FE.playbackRate,this._audio.currentTime=this.startTime}catch(Fa){return void this._audio.addEventListener("canplay",this._resumePlay)}FE.addChannel(this),FO.container.appendChild(this._audio),!Fa&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},Fc.stop=function(){this.isStopped=!0,FE.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&FJ.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),FO.onIE||this._audio!=Fca._musicAudio&&FW.recover("audio:"+this.url,this._audio),FO.removeElement(this._audio),this._audio=null)},Fc.pause=function(){this.isStopped=!0,FE.removeChannel(this),"pause"in this._audio&&this._audio.pause()},Fc.resume=function(){this._audio&&(this.isStopped=!1,FE.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},Fm(0,Fc,"position",function(){return this._audio?this._audio.currentTime:0}),Fm(0,Fc,"duration",function(){return this._audio?this._audio.duration:0}),Fm(0,Fc,"volume",function(){return this._audio?this._audio.volume:1},function(Fa){this._audio&&(this._audio.volume=Fa)}),Fb}(),Fpa=function(Fa){function Fb(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=Ffa.ctx,Fb.__super.call(this),this._onPlayEnd=F$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}Fr(Fb,"laya.media.webaudio.WebAudioSoundChannel",Fda);var Fc=Fb.prototype;return Fc.play=function(Fa){if(FE.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var Fb=this.context,Fc=this.gain,Fd=Fb.createBufferSource();(this.bufferSource=Fd).buffer=this.audioBuffer,Fd.connect(Fc),Fc&&Fc.disconnect(),Fc.connect(Fb.destination),Fd.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=FO.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(Fd.loop=!0),Fd.playbackRate.setTargetAtTime?Fd.playbackRate.setTargetAtTime(FE.playbackRate,this.context.currentTime,.1):Fd.playbackRate.value=FE.playbackRate,Fd.start(0,this.startTime),!Fa&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},Fc.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(Fz.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Fc._clearBufferSource=function(){if(this.bufferSource){var Fa=this.bufferSource;Fa.stop?Fa.stop(0):Fa.noteOff(0),Fa.disconnect(0),Fa.onended=null,Fb._tryCleanFailed||this._tryClearBuffer(Fa),this.bufferSource=null}},Fc._tryClearBuffer=function(Fa){try{Fa.buffer=null}catch(Fa){Fb._tryCleanFailed=!0}},Fc.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,FE.removeChannel(this),this.startHandler=null,this.completeHandler=null},Fc.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,FE.removeChannel(this)},Fc.resume=function(){this.startTime=this._pauseTime,this.play(!1)},Fm(0,Fc,"position",function(){return this.bufferSource?(FO.now()-this._startTime)/1e3+this.startTime:0}),Fm(0,Fc,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Fm(0,Fc,"volume",function(){return this._volume},function(Fa){this.isStopped||(this._volume=Fa,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(Fa,this.context.currentTime,.1):this.gain.gain.value=Fa)}),Fb._tryCleanFailed=!1,Fb}(),Fqa=function(Fa){function Fb(){Fb.__super.call(this),this._w=0,this._h=0}Fr(Fb,"laya.resource.Bitmap",Fja);var Fc=Fb.prototype;return Fm(0,Fc,"width",function(){return this._w}),Fm(0,Fc,"height",function(){return this._h}),Fm(0,Fc,"source",function(){return this._source}),Fb}(),Fra=function(Fb){function Fa(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,Fa.__super.call(this),this._interval=Fd.animationInterval,this._setUpNoticeType(1)}Fr(Fa,"laya.display.AnimationPlayerBase",Fb);var Fc=Fa.prototype;return Fc.play=function(Fa,Fb,Fc,Fd){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=!0),void 0===Fc&&(Fc=""),void 0===Fd&&(Fd=!0),this._isPlaying=!0,this.index="string"==typeof Fa?this._getFrameByLabel(Fa):Fa,this.loop=Fb,this._actionName=Fc,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Fc._getFrameByLabel=function(Fa){var Fb=0;for(Fb=0;Fb<this._count;Fb++)if(this._labels[Fb]&&0<=this._labels[Fb].indexOf(Fa))return Fb;return 0},Fc._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},Fc._setControlNode=function(Fa){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=Fa)&&Fa!=this&&(Fa.on("display",this,this._checkResumePlaying),Fa.on("undisplay",this,this._checkResumePlaying))},Fc._setDisplay=function(Fa){Fb.prototype._setDisplay.call(this,Fa),this._checkResumePlaying()},Fc._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},Fc.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},Fc.addLabel=function(Fa,Fb){this._labels||(this._labels={}),this._labels[Fb]||(this._labels[Fb]=[]),this._labels[Fb].push(Fa)},Fc.removeLabel=function(Fa){if(Fa){if(this._labels)for(var Fb in this._labels)this._removeLabelFromLabelList(this._labels[Fb],Fa)}else this._labels=null},Fc._removeLabelFromLabelList=function(Fa,Fb){if(Fa)for(var Fc=Fa.length-1;0<=Fc;Fc--)Fa[Fc]==Fb&&Fa.splice(Fc,1)},Fc.gotoAndStop=function(Fa){this.index="string"==typeof Fa?this._getFrameByLabel(Fa):Fa,this.stop()},Fc._displayToIndex=function(Fa){},Fc.clear=function(){this.stop(),this._labels=null},Fm(0,Fc,"interval",function(){return this._interval},function(Fa){this._interval!=Fa&&(this._frameRateChanged=!0,this._interval=Fa,this._isPlaying&&0<Fa&&this.timerLoop(Fa,this,this._frameLoop,null,!0,!0))}),Fm(0,Fc,"isPlaying",function(){return this._isPlaying}),Fm(0,Fc,"index",function(){return this._index},function(Fa){if(this._index=Fa,this._displayToIndex(Fa),this._labels&&this._labels[Fa])for(var Fb=this._labels[Fa],Fc=0,Fd=Fb.length;Fc<Fd;Fc++)this.event("label",Fb[Fc])}),Fm(0,Fc,"count",function(){return this._count}),Fa.WRAP_POSITIVE=0,Fa.WRAP_REVERSE=1,Fa.WRAP_PINGPONG=2,Fa}(Fna),Fsa=function(Fb){function Fp(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,Fp.__super.call(this),this.overflow=Fp.VISIBLE,this._style=new Fba(this),this._style.wordWrap=!1}Fr(Fp,"laya.display.Text",Fb);var Fa=Fp.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._lines=null,this._words&&(this._words.length=0,this._words=null)},Fa._getBoundPointsM=function(Fa){void 0===Fa&&(Fa=!1);var Fb=FB.TEMP;return Fb.setTo(0,0,this.width,this.height),Fb._getBoundPoints()},Fa.getGraphicBounds=function(Fa){void 0===Fa&&(Fa=!1);var Fb=FB.TEMP;return Fb.setTo(0,0,this.width,this.height),Fb},Fa._getCSSStyle=function(){return this._style},Fa.lang=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm){if(Fa=Fp.langPacks&&Fp.langPacks[Fa]?Fp.langPacks[Fa]:Fa,arguments.length<2)this._text=Fa;else{for(var Fn=0,Fo=arguments.length;Fn<Fo;Fn++)Fa=Fa.replace("{"+Fn+"}",arguments[Fn+1]);this._text=Fa}},Fa._isPassWordMode=function(){var Fa=this._style.password;return"prompt"in this&&this.prompt==this._text&&(Fa=!1),Fa},Fa._getPassWordTxt=function(Fa){var Fb;Fb="";for(var Fc=Fa.length;0<Fc;Fc--)Fb+="●";return Fb},Fa.renderText=function(Fa,Fb){var Fc=this.graphics;Fc.clear(!0);var Fd=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(FO.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);FO.context.font=Fd;var Fe=this.padding,Ff=Fe[3],Fg="left",Fh=this._lines,Fi=this.leading+this._charSize.height,Fj=this._currBitmapFont;Fj&&(Fi=this.leading+Fj.getMaxHeight());var Fm=Fe[0];if(!Fj&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(Fg="right",Ff=this._width-Fe[1]):"center"==this.align&&(Fg="center",Ff=.5*this._width+Fe[3]-Fe[1])),0<this._height){var Fn=this._textHeight>this._height?"top":this.valign;"middle"===Fn?Fm=.5*(this._height-Fb*Fi)+Fe[0]-Fe[2]:"bottom"===Fn&&(Fm=this._height-Fb*Fi-Fe[2])}var Fo=this._style;if(Fj&&Fj.autoScaleSize)var Fp=Fj.fontSize/this.fontSize;if(this._clipPoint)if(Fc.save(),Fj&&Fj.autoScaleSize){var Fq=0,Fr=0;Fq=this._width?this._width-Fe[3]-Fe[1]:this._textWidth,Fr=this._height?this._height-Fe[0]-Fe[2]:this._textHeight,Fq*=Fp,Fr*=Fp,Fc.clipRect(Fe[3],Fe[0],Fq,Fr)}else Fc.clipRect(Fe[3],Fe[0],this._width?this._width-Fe[3]-Fe[1]:this._textWidth,this._height?this._height-Fe[0]-Fe[2]:this._textHeight);var Fs=Fo.password;"prompt"in this&&this.prompt==this._text&&(Fs=!1);for(var Ft=0,Fu=0,Fv=Math.min(this._lines.length,Fb+Fa)||1,Fw=Fa;Fw<Fv;Fw++){var Fx,Fy=Fh[Fw];if(Fs){var Fz=Fy.length;Fy="";for(var FA=Fz;0<FA;FA--)Fy+="●"}if(Ft=Ff-(this._clipPoint?this._clipPoint.x:0),Fu=Fm+Fi*Fw-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(Fg,Ft,Fu,Fw),Fj){var FB=this.width;Fj.autoScaleSize&&(FB=this.width*Fp),Fj.drawText(Fy,this,Ft,Fu,this.align,FB)}else FJ.isWebGL?(this._words||(this._words=[]),(Fx=this._words.length>Fw-Fa?this._words[Fw-Fa]:new Fl).setText(Fy)):Fx=Fy,Fo.stroke?Fc.fillBorderText(Fx,Ft,Fu,Fd,this.color,Fo.strokeColor,Fo.stroke,Fg):Fc.fillText(Fx,Ft,Fu,Fd,this.color,Fg)}if(Fj&&Fj.autoScaleSize){var FC=1/Fp;this.scale(FC,FC)}this._clipPoint&&Fc.restore(),this._startX=Ff,this._startY=Fm},Fa.drawUnderline=function(Fa,Fb,Fc,Fd){var Fe=this._lineWidths[Fd];switch(Fa){case"center":Fb-=Fe/2;break;case"right":Fb-=Fe}Fc+=this._charSize.height,this._graphics.drawLine(Fb,Fc,Fb+Fe,Fc,this.underlineColor||this.color,1)},Fa.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);FO.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new FA(0,0)):this._clipPoint=null;var Fa=this._lines.length;if(this.overflow!=Fp.VISIBLE){var Fb=this.overflow==Fp.HIDDEN?Math.floor:Math.ceil;Fa=Math.min(Fa,Fb((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var Fc=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(Fc,Fa),this.repaint()},Fa.evalTextSize=function(){var Fa,Fb=NaN;Fa=Math.max.apply(this,this._lineWidths),Fb=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],Fa==this._textWidth&&Fb==this._textHeight||(this._textWidth=Fa,this._textHeight=Fb,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},Fa.checkEnabledViewportOrNot=function(){return this.overflow==Fp.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},Fa.changeText=function(Fa){this._text!==Fa&&(this.lang(Fa+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},Fa.parseLines=function(Fa){var Fb=this.wordWrap||this.overflow==Fp.HIDDEN;if(Fb)var Fc=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var Fd=F$.contextMeasureText(Fp._testWord);FJ.isConchApp&&0===Fd.width&&0===Fd.height&&(Fd=F$.contextMeasureText("W")),this._charSize.width=Fd.width,this._charSize.height=Fd.height||this.fontSize}for(var Fe=Fa.replace(/\r\n/g,"\n").split("\n"),Ff=0,Fg=Fe.length;Ff<Fg;Ff++){var Fh=Fe[Ff];Fb?this.parseLine(Fh,Fc):(this._lineWidths.push(this.getTextWidth(Fh)),this._lines.push(Fh))}},Fa.parseLine=function(Fa,Fb){FO.context;var Fc,Fd=this._lines,Fe=0,Ff=NaN,Fg=NaN,Fh=0;if((Ff=this.getTextWidth(Fa))<=Fb)return Fd.push(Fa),void this._lineWidths.push(Ff);Ff=this._charSize.width,0==(Fe=Math.floor(Fb/Ff))&&(Fe=1),Fg=Ff=this.getTextWidth(Fa.substring(0,Fe));for(var Fi=Fe,Fj=Fa.length;Fi<Fj;Fi++)if(Fb<(Fg+=Ff=this.getTextWidth(Fa.charAt(Fi))))if(this.wordWrap){var Fm=Fa.substring(Fh,Fi);if(Fm.charCodeAt(Fm.length-1)<255?(Fc=/(?:\w|-)+$/.exec(Fm))&&(Fi=Fc.index+Fh,0==Fc.index?Fi+=Fm.length:Fm=Fa.substring(Fh,Fi)):Fp.RightToLeft&&(Fc=/([\u0600-\u06FF])+$/.exec(Fm))&&(Fi=Fc.index+Fh,0==Fc.index?Fi+=Fm.length:Fm=Fa.substring(Fh,Fi)),Fd.push(Fm),this._lineWidths.push(Fg-Ff),!((Fh=Fi)+Fe<Fj)){Fd.push(Fa.substring(Fh,Fj)),this._lineWidths.push(this.getTextWidth(Fd[Fd.length-1])),Fh=-1;break}Fi+=Fe,Fg=Ff=this.getTextWidth(Fa.substring(Fh,Fi)),Fi--}else if(this.overflow==Fp.HIDDEN)return Fd.push(Fa.substring(0,Fi)),void this._lineWidths.push(this.getTextWidth(Fd[Fd.length-1]));this.wordWrap&&-1!=Fh&&(Fd.push(Fa.substring(Fh,Fj)),this._lineWidths.push(this.getTextWidth(Fd[Fd.length-1])))},Fa.getTextWidth=function(Fa){return this._currBitmapFont?this._currBitmapFont.getTextWidth(Fa):F$.contextMeasureText(Fa).width},Fa.getWordWrapWidth=function(){var Fa=this.padding,Fb=NaN;return(Fb=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(Fb=this.wordWrap?100:FO.width),Fb<=0&&(Fb=100),Fb-Fa[3]-Fa[1]},Fa.getCharPoint=function(Fa,Fb){this._isChanged&&Fz.timer.runCallLater(this,this.typeset);for(var Fc=0,Fd=this._lines,Fe=0,Ff=0,Fg=Fd.length;Ff<Fg;Ff++){if(Fa<(Fc+=Fd[Ff].length)){var Fh=Ff;break}Fe=Fc}var Fi=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;FO.context.font=Fi;var Fj=this.getTextWidth(this._text.substring(Fe,Fa));return(Fb||new FA).setTo(this._startX+Fj-(this._clipPoint?this._clipPoint.x:0),this._startY+Fh*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},Fm(0,Fa,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(Fa){Fa!=this._width&&(Fz.superSet(Fna,this,"width",Fa),this.isChanged=!0)}),Fm(0,Fa,"textWidth",function(){return this._isChanged&&Fz.timer.runCallLater(this,this.typeset),this._textWidth}),Fm(0,Fa,"height",function(){return this._height?this._height:this.textHeight},function(Fa){Fa!=this._height&&(Fz.superSet(Fna,this,"height",Fa),this.isChanged=!0)}),Fm(0,Fa,"textHeight",function(){return this._isChanged&&Fz.timer.runCallLater(this,this.typeset),this._textHeight}),Fm(0,Fa,"padding",function(){return this._getCSSStyle().padding},function(Fa){this._getCSSStyle().padding=Fa,this.isChanged=!0}),Fm(0,Fa,"bold",function(){return this._getCSSStyle().bold},function(Fa){this._getCSSStyle().bold=Fa,this.isChanged=!0}),Fm(0,Fa,"text",function(){return this._text||""},function(Fa){this._text!==Fa&&(this.lang(Fa+""),this.isChanged=!0,this.event("change"))}),Fm(0,Fa,"color",function(){return this._getCSSStyle().color},function(Fa){this._getCSSStyle().color!=Fa&&(this._getCSSStyle().color=Fa,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),Fm(0,Fa,"font",function(){return this._getCSSStyle().fontFamily},function(Fa){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),Fp._bitmapFonts&&Fp._bitmapFonts[Fa]&&(this._currBitmapFont=Fp._bitmapFonts[Fa]),this._getCSSStyle().fontFamily=Fa,this.isChanged=!0}),Fm(0,Fa,"fontSize",function(){return this._getCSSStyle().fontSize},function(Fa){this._getCSSStyle().fontSize=Fa,this.isChanged=!0}),Fm(0,Fa,"italic",function(){return this._getCSSStyle().italic},function(Fa){this._getCSSStyle().italic=Fa,this.isChanged=!0}),Fm(0,Fa,"align",function(){return this._getCSSStyle().align},function(Fa){this._getCSSStyle().align=Fa,this.isChanged=!0}),Fm(0,Fa,"valign",function(){return this._getCSSStyle().valign},function(Fa){this._getCSSStyle().valign=Fa,this.isChanged=!0}),Fm(0,Fa,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(Fa){this._getCSSStyle().wordWrap=Fa,this.isChanged=!0}),Fm(0,Fa,"leading",function(){return this._getCSSStyle().leading},function(Fa){this._getCSSStyle().leading=Fa,this.isChanged=!0}),Fm(0,Fa,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(Fa){this._getCSSStyle().backgroundColor=Fa,this.isChanged=!0}),Fm(0,Fa,"borderColor",function(){return this._getCSSStyle().borderColor},function(Fa){this._getCSSStyle().borderColor=Fa,this.isChanged=!0}),Fm(0,Fa,"stroke",function(){return this._getCSSStyle().stroke},function(Fa){this._getCSSStyle().stroke=Fa,this.isChanged=!0}),Fm(0,Fa,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(Fa){this._getCSSStyle().strokeColor=Fa,this.isChanged=!0}),Fm(0,Fa,"isChanged",null,function(Fa){this._isChanged!==Fa&&(this._isChanged=Fa)&&Fz.timer.callLater(this,this.typeset)}),Fm(0,Fa,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(Fa){if(!(this.overflow!=Fp.SCROLL||this.textWidth<this._width)&&this._clipPoint){Fa=Fa<this.padding[3]?this.padding[3]:Fa;var Fb=this._textWidth-this._width;Fa=Fb<Fa?Fb:Fa;var Fc=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=Fa,this.renderText(this._lastVisibleLineIndex,Fc)}}),Fm(0,Fa,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(Fa){if(!(this.overflow!=Fp.SCROLL||this.textHeight<this._height)&&this._clipPoint){Fa=Fa<this.padding[0]?this.padding[0]:Fa;var Fb=this._textHeight-this._height,Fc=(Fa=Fb<Fa?Fb:Fa)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=Fc;var Fd=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=Fa,this.renderText(Fc,Fd)}}),Fm(0,Fa,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),Fm(0,Fa,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),Fm(0,Fa,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),Fm(0,Fa,"underlineColor",function(){return this._underlineColor},function(Fa){this._underlineColor=Fa,this._isChanged=!0,this.typeset()}),Fp.registerBitmapFont=function(Fa,Fb){Fp._bitmapFonts||(Fp._bitmapFonts={}),Fp._bitmapFonts[Fa]=Fb},Fp.unregisterBitmapFont=function(Fa,Fb){if(void 0===Fb&&(Fb=!0),Fp._bitmapFonts&&Fp._bitmapFonts[Fa]){var Fc=Fp._bitmapFonts[Fa];Fb&&Fc.destroy(),delete Fp._bitmapFonts[Fa]}},Fp.setTextRightToLeft=function(){var Fa;(Fa=FO.canvas.source.style).display="none",Fa.position="absolute",Fa.direction="rtl",FJ._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,FO.document.body.appendChild(FO.canvas.source)},Fp.supportFont=function(Fa){FO.context.font="10px sans-serif";var Fb=F$.contextMeasureText("abcji").width;FO.context.font="10px "+Fa;var Fc=F$.contextMeasureText("abcji").width;return console.log(Fb,Fc),Fb!==Fc},Fp._testWord="游",Fp.langPacks=null,Fp.VISIBLE="visible",Fp.SCROLL="scroll",Fp.HIDDEN="hidden",Fp.CharacterCache=!0,Fp.RightToLeft=!1,Fp._bitmapFonts=null,Fi(Fp,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),Fp}(Fna),Fta=function(Fn){function Fg(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",Fg.__super.call(this),this.offset=new FA,this._canvasTransform=new FG,this._previousOrientation=FO.window.orientation;var Fb=this;this.transform=FG.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var Fa=FO.window,Fc=this;Fa.addEventListener("focus",function(){Fb._isFocused=!0,Fc.event("focus"),Fc.event("focuschange")}),Fa.addEventListener("blur",function(){Fb._isFocused=!1,Fc.event("blur"),Fc.event("focuschange"),Fc._isInputting()&&(Fxa.inputElement.target.focus=!1)});var Fd="visibilityState",Fe="visibilitychange",Ff=Fa.document;void 0!==Ff.hidden?(Fe="visibilitychange",Fd="visibilityState"):void 0!==Ff.mozHidden?(Fe="mozvisibilitychange",Fd="mozVisibilityState"):void 0!==Ff.msHidden?(Fe="msvisibilitychange",Fd="msVisibilityState"):void 0!==Ff.webkitHidden&&(Fe="webkitvisibilitychange",Fd="webkitVisibilityState"),Fa.document.addEventListener(Fe,function(){"hidden"==FO.document[Fd]?Fc._setStageVisible(!1):Fc._setStageVisible(!0)}),Fa.document.addEventListener("qbrowserVisibilityChange",function(Fa){Fc._setStageVisible(!Fa.hidden)}),Fa.addEventListener("resize",function(){var Fa=FO.window.orientation;null!=Fa&&Fa!=Fb._previousOrientation&&Fc._isInputting()&&(Fxa.inputElement.target.focus=!1),Fb._previousOrientation=Fa,Fc._isInputting()||Fc._resetCanvas()}),Fa.addEventListener("orientationchange",function(Fa){Fc._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),FO.onMobile&&this.on("mousedown",this,this._onmouseMove)}Fr(Fg,"laya.display.Stage",Fn);var Fa=Fg.prototype;return Fa._setStageVisible=function(Fa){this._isVisibility!=Fa&&(this._isVisibility=Fa,this._isVisibility||this._isInputting()&&(Fxa.inputElement.target.focus=!1),this.event("visibilitychange"))},Fa._isInputting=function(){return FO.onMobile&&Fxa.isInputting},Fa._changeCanvasSize=function(){this.setScreenSize(FO.clientWidth*FO.pixelRatio,FO.clientHeight*FO.pixelRatio)},Fa._resetCanvas=function(){if(this.screenAdaptationEnabled){var Fa=FJ._mainCanvas;Fa.source.style;Fa.size(1,1),Fz.timer.once(100,this,this._changeCanvasSize)}},Fa.setScreenSize=function(Fa,Fb){var Fc=!1;if("none"!==this._screenMode&&(Fc=(Fa/Fb<1?"vertical":"horizontal")!==this._screenMode)){var Fd=Fb;Fb=Fa,Fa=Fd}this.canvasRotation=Fc;var Fe=FJ._mainCanvas,Ff=Fe.source.style,Fg=this._canvasTransform.identity(),Fh=this._scaleMode,Fi=Fa/this.designWidth,Fj=Fb/this.designHeight,Fm=this.designWidth,Fn=this.designHeight,Fo=Fa,Fp=Fb,Fq=FO.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,Fh){case"noscale":Fi=Fj=1,Fo=this.designWidth,Fp=this.designHeight;break;case"showall":Fi=Fj=Math.min(Fi,Fj),Fm=Fo=Math.round(this.designWidth*Fi),Fn=Fp=Math.round(this.designHeight*Fj);break;case"noborder":Fi=Fj=Math.max(Fi,Fj),Fo=Math.round(this.designWidth*Fi),Fp=Math.round(this.designHeight*Fj);break;case"full":Fi=Fj=1,this._width=Fm=Fa,this._height=Fn=Fb;break;case"fixedwidth":Fj=Fi,this._height=Fn=Math.round(Fb/Fi);break;case"fixedheight":Fi=Fj,this._width=Fm=Math.round(Fa/Fj);break;case"fixedauto":Fa/Fb<this.designWidth/this.designHeight?(Fj=Fi,this._height=Fn=Math.round(Fb/Fi)):(Fi=Fj,this._width=Fm=Math.round(Fa/Fj))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,Fm=Fm+1&2147483646,Fn=Fn+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),Fi*=this.scaleX,Fj*=this.scaleY,1===Fi&&1===Fj?this.transform.identity():(this.transform.a=this._formatData(Fi/(Fo/Fm)),this.transform.d=this._formatData(Fj/(Fp/Fn)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),Fe.size(Fm,Fn),FF.changeWebGLSize(Fm,Fn),Fg.scale(Fo/Fm/Fq,Fp/Fn/Fq),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(Fa-Fo)/Fq:this.offset.x=.5*(Fa-Fo)/Fq,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(Fb-Fp)/Fq:this.offset.y=.5*(Fb-Fp)/Fq,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),Fg.translate(this.offset.x,this.offset.y),this.canvasDegree=0,Fc&&("horizontal"===this._screenMode?(Fg.rotate(Math.PI/2),Fg.translate(Fb/Fq,0),this.canvasDegree=90):(Fg.rotate(-Math.PI/2),Fg.translate(0,Fa/Fq),this.canvasDegree=-90)),Fg.a=this._formatData(Fg.a),Fg.d=this._formatData(Fg.d),Fg.tx=this._formatData(Fg.tx),Fg.ty=this._formatData(Fg.ty),Ff.transformOrigin=Ff.webkitTransformOrigin=Ff.msTransformOrigin=Ff.mozTransformOrigin=Ff.oTransformOrigin="0px 0px 0px",Ff.transform=Ff.webkitTransform=Ff.msTransform=Ff.mozTransform=Ff.oTransform="matrix("+Fg.toString()+")",Fg.translate(parseInt(Ff.left)||0,parseInt(Ff.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},Fa._formatData=function(Fa){return Math.abs(Fa)<1e-6?0:Math.abs(1-Fa)<.001?0<Fa?1:-1:Fa},Fa.getMousePoint=function(){return FA.TEMP.setTo(this.mouseX,this.mouseY)},Fa.repaint=function(){this._repaint=1},Fa.parentRepaint=function(){},Fa._loop=function(){return this.render(FJ.context,0,0),!0},Fa._onmouseMove=function(Fa){this._mouseMoveTime=FO.now()},Fa.getTimeFromFrameStart=function(){return FO.now()-this._frameStartTime},Fa.render=function(Fa,Fb,Fc){if("sleep"===this._frameRate&&!FJ.isConchApp){var Fd=FO.now();if(!(1e3<=Fd-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(FX.loopCount++,Fq.instance.runEvent(),Fz.timer._update()));this._frameStartTime=Fd}if(this._renderCount++,FJ.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=FO.now();var Fe="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),Ff=this._renderCount%2==0;if(FX.renderSlow=!Fe,Fe||Ff||FJ.isConchApp){var Fg;FX.loopCount++,Fq.instance.runEvent(),Fz.timer._update(),FF.update3DLoop();var Fh=0,Fi=0;if(FJ.isConchNode)for(Fh=0,Fi=this._scenes.length;Fh<Fi;Fh++)(Fg=this._scenes[Fh])&&Fg._updateSceneConch();else for(Fh=0,Fi=this._scenes.length;Fh<Fi;Fh++)(Fg=this._scenes[Fh])&&Fg._updateScene();if(FJ.isConchNode){var Fj=Fna.CustomList;for(Fh=0,Fi=Fj.length;Fh<Fi;Fh++){var Fm=Fj[Fh];Fm.customRender(Fm.customContext,0,0)}return}}FJ.isConchNode||this.renderingEnabled&&(Fe||!Ff||FJ.isConchWebGL)&&(FJ.isWebGL?FJ.WebGL.mainContext&&!FJ.WebGL.mainContext.isContextLost()&&(Fa.clear(),Fn.prototype.render.call(this,Fa,Fb,Fc),FX._show&&FX._sp&&FX._sp.render(Fa,Fb,Fc),FF.clear(this._bgColor),FF.beginFlush(),Fa.flush(),FF.endFinish(),F_.instance&&F_.getInstance().endDispose()):(FF.clear(this._bgColor),Fn.prototype.render.call(this,Fa,Fb,Fc),FX._show&&FX._sp&&FX._sp.render(Fa,Fb,Fc)))}else this._renderCount%5==0&&(FX.loopCount++,Fq.instance.runEvent(),Fz.timer._update())},Fa._requestFullscreen=function(){var Fa=FO.document.documentElement;Fa.requestFullscreen?Fa.requestFullscreen():Fa.mozRequestFullScreen?Fa.mozRequestFullScreen():Fa.webkitRequestFullscreen?Fa.webkitRequestFullscreen():Fa.msRequestFullscreen&&Fa.msRequestFullscreen()},Fa._fullScreenChanged=function(){Fz.stage.event("fullscreenchange")},Fa.exitFullscreen=function(){var Fa=FO.document;Fa.exitFullscreen?Fa.exitFullscreen():Fa.mozCancelFullScreen?Fa.mozCancelFullScreen():Fa.webkitExitFullscreen&&Fa.webkitExitFullscreen()},Fm(0,Fa,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),Fm(0,Fa,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),Fm(0,Fa,"frameRate",function(){return this._frameRate},function(Fa){if(this._frameRate=Fa,FJ.isConchApp)switch(this._frameRate){case"slow":FO.window.conch&&FO.window.conchConfig.setSlowFrame&&FO.window.conchConfig.setSlowFrame(!0);break;case"fast":FO.window.conch&&FO.window.conchConfig.setSlowFrame&&FO.window.conchConfig.setSlowFrame(!1);break;case"mouse":FO.window.conch&&FO.window.conchConfig.setMouseFrame&&FO.window.conchConfig.setMouseFrame(2e3);break;case"sleep":FO.window.conch&&FO.window.conchConfig.setLimitFPS&&FO.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),Fm(0,Fa,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),Fm(0,Fa,"width",Fn.prototype._$get_width,function(Fa){this.designWidth=Fa,Fz.superSet(Fna,this,"width",Fa),Fz.timer.callLater(this,this._changeCanvasSize)}),Fm(0,Fa,"alignH",function(){return this._alignH},function(Fa){this._alignH=Fa,Fz.timer.callLater(this,this._changeCanvasSize)}),Fm(0,Fa,"isFocused",function(){return this._isFocused}),Fm(0,Fa,"height",Fn.prototype._$get_height,function(Fa){this.designHeight=Fa,Fz.superSet(Fna,this,"height",Fa),Fz.timer.callLater(this,this._changeCanvasSize)}),Fm(0,Fa,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||FG.create()},Fn.prototype._$set_transform),Fm(0,Fa,"isVisibility",function(){return this._isVisibility}),Fm(0,Fa,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),Fm(0,Fa,"scaleMode",function(){return this._scaleMode},function(Fa){this._scaleMode=Fa,Fz.timer.callLater(this,this._changeCanvasSize)}),Fm(0,Fa,"alignV",function(){return this._alignV},function(Fa){this._alignV=Fa,Fz.timer.callLater(this,this._changeCanvasSize)}),Fm(0,Fa,"bgColor",function(){return this._bgColor},function(Fa){this._bgColor=Fa,this.conchModel&&this.conchModel.bgColor(Fa),FJ.isWebGL&&(Fa?Fg._wgColor=FS.create(Fa)._color:FO.onMiniGame||(Fg._wgColor=null)),FO.onLimixiu?Fg._wgColor=FS.create(Fa)._color:FJ.canvas.style.background=Fa||"none"}),Fm(0,Fa,"mouseX",function(){return Math.round(Fq.instance.mouseX/this.clientScaleX)}),Fm(0,Fa,"mouseY",function(){return Math.round(Fq.instance.mouseY/this.clientScaleY)}),Fm(0,Fa,"screenMode",function(){return this._screenMode},function(Fa){this._screenMode=Fa}),Fm(0,Fa,"visible",Fn.prototype._$get_visible,function(Fa){this.visible!==Fa&&(Fz.superSet(Fna,this,"visible",Fa),FJ._mainCanvas.source.style.visibility=Fa?"visible":"hidden")}),Fm(0,Fa,"fullScreenEnabled",null,function(Fa){var Fb=FO.document,Fc=FJ.canvas;Fa?(Fc.addEventListener("mousedown",this._requestFullscreen),Fc.addEventListener("touchstart",this._requestFullscreen),Fb.addEventListener("fullscreenchange",this._fullScreenChanged),Fb.addEventListener("mozfullscreenchange",this._fullScreenChanged),Fb.addEventListener("webkitfullscreenchange",this._fullScreenChanged),Fb.addEventListener("msfullscreenchange",this._fullScreenChanged)):(Fc.removeEventListener("mousedown",this._requestFullscreen),Fc.removeEventListener("touchstart",this._requestFullscreen),Fb.removeEventListener("fullscreenchange",this._fullScreenChanged),Fb.removeEventListener("mozfullscreenchange",this._fullScreenChanged),Fb.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),Fb.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),Fg.SCALE_NOSCALE="noscale",Fg.SCALE_EXACTFIT="exactfit",Fg.SCALE_SHOWALL="showall",Fg.SCALE_NOBORDER="noborder",Fg.SCALE_FULL="full",Fg.SCALE_FIXED_WIDTH="fixedwidth",Fg.SCALE_FIXED_HEIGHT="fixedheight",Fg.SCALE_FIXED_AUTO="fixedauto",Fg.ALIGN_LEFT="left",Fg.ALIGN_RIGHT="right",Fg.ALIGN_CENTER="center",Fg.ALIGN_TOP="top",Fg.ALIGN_MIDDLE="middle",Fg.ALIGN_BOTTOM="bottom",Fg.SCREEN_NONE="none",Fg.SCREEN_HORIZONTAL="horizontal",Fg.SCREEN_VERTICAL="vertical",Fg.FRAME_FAST="fast",Fg.FRAME_SLOW="slow",Fg.FRAME_MOUSE="mouse",Fg.FRAME_SLEEP="sleep",Fg.FRAME_MOUSE_THREDHOLD=2e3,Fi(Fg,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),Fg}(Fna),Fua=(function(Fa){function Fb(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,Fb.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}Fr(Fb,"laya.media.SoundNode",Fna);var Fc=Fb.prototype;Fc._onParentChange=function(){this.target=this.parent},Fc.play=function(Fa,Fb){void 0===Fa&&(Fa=1),isNaN(Fa)&&(Fa=1),this.url&&(this.stop(),this._channel=FE.playSound(this.url,Fa,null,Fb))},Fc.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},Fc._setPlayAction=function(Fa,Fb,Fc,Fd){void 0===Fd&&(Fd=!0),this[Fc]&&Fa&&(Fd?Fa.on(Fb,this,this[Fc]):Fa.off(Fb,this,this[Fc]))},Fc._setPlayActions=function(Fa,Fb,Fc,Fd){if(void 0===Fd&&(Fd=!0),Fa&&Fb){var Fe,Ff=Fb.split(","),Fg=0;for(Fe=Ff.length,Fg=0;Fg<Fe;Fg++)this._setPlayAction(Fa,Ff[Fg],Fc,Fd)}},Fm(0,Fc,"playEvent",null,function(Fa){(this._playEvents=Fa)&&this._tar&&this._setPlayActions(this._tar,Fa,"play")}),Fm(0,Fc,"target",null,function(Fa){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=Fa,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),Fm(0,Fc,"stopEvent",null,function(Fa){(this._stopEvents=Fa)&&this._tar&&this._setPlayActions(this._tar,Fa,"stop")})}(),function(Fa){function Fb(){this._src=null,this._onload=null,this._onerror=null,Fb.__super.call(this)}Fr(Fb,"laya.resource.FileBitmap",Fqa);var Fc=Fb.prototype;return Fm(0,Fc,"src",function(){return this._src},function(Fa){this._src=Fa}),Fm(0,Fc,"onload",null,function(Fa){}),Fm(0,Fc,"onerror",null,function(Fa){}),Fb}()),Fva=function(Fa){function Fc(Fa,Fb){this._is2D=!1,Fc.__super.call(this);var Fd=this;if(this._source=this,"2D"===Fa||"AUTO"===Fa&&!FJ.isWebGL){this._is2D=!0,this._source=Fb||FO.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var Fe=this;Fe.getContext=function(Fa,Fb){if(Fd._ctx)return Fd._ctx;var Fc=Fd._ctx=Fd._source.getContext(Fa,Fb);return Fc&&(Fc._canvas=Fe,FJ.isFlash||FO.onLimixiu||(Fc.size=function(Fa,Fb){})),Fc}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}Fr(Fc,"laya.resource.HTMLCanvas",Fqa);var Fb=Fc.prototype;return Fb.clear=function(){this._ctx&&this._ctx.clear()},Fb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Fb.release=function(){},Fb._setContext=function(Fa){this._ctx=Fa},Fb.getContext=function(Fa,Fb){return this._ctx?this._ctx:this._ctx=Fc._createContext(this)},Fb.getMemSize=function(){return 0},Fb.size=function(Fa,Fb){(this._w!=Fa||this._h!=Fb||this._source&&(this._source.width!=Fa||this._source.height!=Fb))&&(this._w=Fa,this._h=Fb,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(Fa,Fb),this._source&&(this._source.height=Fb,this._source.width=Fa))},Fb.getCanvas=function(){return this._source},Fb.toBase64=function(Fa,Fb,Fc){if(this._source)if(FJ.isConchApp&&this._source.toBase64)this._source.toBase64(Fa,Fb,Fc);else{var Fd=this._source.toDataURL(Fa,Fb);Fc.call(this,Fd)}},Fm(0,Fb,"context",function(){return this._ctx}),Fm(0,Fb,"asBitmap",null,function(Fa){}),Fc.create=function(Fa,Fb){return new Fc(Fa,Fb)},Fc.TYPE2D="2D",Fc.TYPE3D="3D",Fc.TYPEAUTO="AUTO",Fc._createContext=null,Fc}(),Fwa=(function(Fa){function Fi(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){throw Fi.__super.call(this),new Error("不允许new！")}Fr(Fi,"laya.resource.HTMLSubImage",Fqa),Fi.create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){return void 0===Fh&&(Fh=!1),new Fi(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh)}}(),function(Fa){function Fn(){this._frames=null,this._url=null,Fn.__super.call(this),this._setControlNode(this)}Fr(Fn,"laya.display.Animation",Fa);var Fb=Fn.prototype;Fb.destroy=function(Fa){void 0===Fa&&(Fa=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,Fa),this._frames=null,this._labels=null},Fb.play=function(Fa,Fb,Fc,Fd){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=!0),void 0===Fc&&(Fc=""),void 0===Fd&&(Fd=!0),Fc&&this._setFramesFromCache(Fc,Fd),this._isPlaying=!0,this.index="string"==typeof Fa?this._getFrameByLabel(Fa):Fa,this.loop=Fb,this._actionName=Fc,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Fb._setFramesFromCache=function(Fa,Fb){var Fc;return void 0===Fb&&(Fb=!1),this._url&&(Fa=this._url+"#"+Fa),Fa&&Fn.framesMap[Fa]?((Fc=Fn.framesMap[Fa])instanceof Array?(this._frames=Fn.framesMap[Fa],this._count=this._frames.length):(Fc.nodeRoot&&(Fn.framesMap[Fa]=this._parseGraphicAnimationByData(Fc),Fc=Fn.framesMap[Fa]),this._frames=Fc.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=Fc.interval),this._labels=this._copyLabels(Fc.labels)),!0):(Fb&&console.log("ani not found:",Fa),!1)},Fb._copyLabels=function(Fa){if(!Fa)return null;var Fb,Fc;for(Fc in Fb={},Fa)Fb[Fc]=F$.copyArray([],Fa[Fc]);return Fb},Fb._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&Fa.prototype._frameLoop.call(this)},Fb._displayToIndex=function(Fa){this._frames&&(this.graphics=this._frames[Fa])},Fb.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},Fb.loadImages=function(Fa,Fb){return void 0===Fb&&(Fb=""),this._url="",this._setFramesFromCache(Fb)||(this.frames=Fn.framesMap[Fb]?Fn.framesMap[Fb]:Fn.createFrames(Fa,Fb)),this},Fb.loadAtlas=function(Fb,Fc,Fd){void 0===Fd&&(Fd=""),this._url="";var Fe=this;function Fa(Fa){Fb===Fa&&(Fe.frames=Fn.framesMap[Fd]?Fn.framesMap[Fd]:Fn.createFrames(Fb,Fd),Fc&&Fc.run())}return Fe._setFramesFromCache(Fd)||(Fha.getAtlas(Fb)?Fa(Fb):Fz.loader.load(Fb,Fu.create(null,Fa,[Fb]),null,"atlas")),this},Fb.loadAnimation=function(Fa,Fb,Fc){this._url=Fa;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,Fb&&Fb.run()):!Fc||Fha.getAtlas(Fc)?this._loadAnimationData(Fa,Fb,Fc):Fz.loader.load(Fc,Fu.create(this,this._loadAnimationData,[Fa,Fb,Fc]),null,"atlas"),this},Fb._loadAnimationData=function(Fh,Fi,Fa){var Fj=this;if(!Fa||Fha.getAtlas(Fa)){var Fm=this;Fha.getRes(Fh)?Fb(Fh):Fz.loader.load(Fh,Fu.create(null,Fb,[Fh]),null,"json"),Fha.clearRes(Fh)}else console.warn("atlas load fail:"+Fa);function Fb(Fa){if(Fha.getRes(Fa)&&Fh===Fa){var Fb;if(Fn.framesMap[Fh+"#"])Fm._setFramesFromCache(Fj._actionName,!0),Fj.index=0,Fj._checkResumePlaying();else{var Fc=Fm._parseGraphicAnimation(Fha.getRes(Fh));if(!Fc)return;var Fd,Fe=Fc.animationList,Ff=0,Fg=Fe.length;for(Ff=0;Ff<Fg;Ff++)Fb=Fe[Ff],Fn.framesMap[Fh+"#"+Fb.name]=Fb,Fd||(Fd=Fb);Fd&&(Fn.framesMap[Fh+"#"]=Fd,Fm._setFramesFromCache(Fj._actionName,!0),Fj.index=0),Fj._checkResumePlaying()}Fi&&Fi.run()}}},Fb._parseGraphicAnimation=function(Fa){return Fza.parseAnimationData(Fa)},Fb._parseGraphicAnimationByData=function(Fa){return Fza.parseAnimationByData(Fa)},Fm(0,Fb,"frames",function(){return this._frames},function(Fa){(this._frames=Fa)&&(this._count=Fa.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),Fm(0,Fb,"autoPlay",null,function(Fa){Fa?this.play():this.stop()}),Fm(0,Fb,"source",null,function(Fa){-1<Fa.indexOf(".ani")?this.loadAnimation(Fa):-1<Fa.indexOf(".json")||-1<Fa.indexOf("als")||-1<Fa.indexOf("atlas")?this.loadAtlas(Fa):this.loadImages(Fa.split(","))}),Fm(0,Fb,"autoAnimation",null,function(Fa){this.play(0,!0,Fa,!1)}),Fn.createFrames=function(Fa,Fb){var Fc,Fd,Fe=0,Ff=0;if("string"==typeof Fa){var Fg=Fha.getAtlas(Fa);if(Fg&&Fg.length)for(Fc=[],Fe=0,Ff=Fg.length;Fe<Ff;Fe++)(Fd=new FF.createGraphics).drawTexture(Fha.getRes(Fg[Fe]),0,0),Fc.push(Fd)}else if(Fa instanceof Array)for(Fc=[],Fe=0,Ff=Fa.length;Fe<Ff;Fe++)(Fd=new FF.createGraphics).loadImage(Fa[Fe],0,0),Fc.push(Fd);return Fb&&(Fn.framesMap[Fb]=Fc),Fc},Fn.clearCache=function(Fa){var Fb,Fc=Fn.framesMap,Fd=Fa+"#";for(Fb in Fc)Fb!==Fa&&0!=Fb.indexOf(Fd)||delete Fn.framesMap[Fb]},Fn.framesMap={}}(Fra),function(Fa){function Ff(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,Ff.__super.call(this),null==Ff._sortIndexFun&&(Ff._sortIndexFun=Fy.sortByKey("index",!1,!0))}Fr(Ff,"laya.display.FrameAnimation",Fa);var Fb=Ff.prototype;return Fb._setUp=function(Fa,Fb){this._labels=null,this._animationNewFrames=null,this._targetDic=Fa,this._animationData=Fb,this.interval=1e3/Fb.frameRate,Fb.parsed?(this._count=Fb.count,this._labels=Fb.labels,this._animationNewFrames=Fb.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),Fb.parsed=!0,Fb.labels=this._labels,Fb.count=this._count,Fb.animationNewFrames=this._animationNewFrames},Fb.clear=function(){Fa.prototype.clear.call(this),this._targetDic=null,this._animationData=null},Fb._displayToIndex=function(Fa){if(this._animationData){Fa<0&&(Fa=0),Fa>this._count&&(Fa=this._count);var Fb=this._animationData.nodes,Fc=0,Fd=Fb.length;for(Fc=0;Fc<Fd;Fc++)this._displayNodeToFrame(Fb[Fc],Fa)}},Fb._displayNodeToFrame=function(Fa,Fb,Fc){Fc||(Fc=this._targetDic);var Fd=Fc[Fa.target];if(Fd){var Fe,Ff,Fg,Fh=Fa.frames,Fi=Fa.keys,Fj=0,Fm=Fi.length;for(Fj=0;Fj<Fm;Fj++)Fg=(Ff=Fh[Fe=Fi[Fj]]).length>Fb?Ff[Fb]:Ff[Ff.length-1],Fd[Fe]=Fg}},Fb._calculateDatas=function(){if(this._animationData){var Fa,Fb=this._animationData.nodes,Fc=0,Fd=Fb.length;for(Fc=this._count=0;Fc<Fd;Fc++)Fa=Fb[Fc],this._calculateNodeKeyFrames(Fa);this._count+=1}},Fb._calculateNodeKeyFrames=function(Fa){var Fb,Fc,Fd=Fa.keyframes,Fe=Fa.target;for(Fb in Fa.frames||(Fa.frames={}),Fa.keys?Fa.keys.length=0:Fa.keys=[],Fa.initValues||(Fa.initValues={}),Fd)Fc=Fd[Fb],Fa.frames[Fb]||(Fa.frames[Fb]=[]),this._targetDic&&this._targetDic[Fe]&&(Fa.initValues[Fb]=this._targetDic[Fe][Fb]),Fc.sort(Ff._sortIndexFun),Fa.keys.push(Fb),this._calculateNodePropFrames(Fc,Fa.frames[Fb],Fb,Fe)},Fb.resetToInitState=function(){if(this._targetDic&&this._animationData){var Fa,Fb,Fc=this._animationData.nodes,Fd=0,Fe=Fc.length;for(Fd=0;Fd<Fe;Fd++)if(Fb=(Fa=Fc[Fd]).initValues){var Ff,Fg=this._targetDic[Fa.target];if(Fg)for(Ff in Fb)Fg[Ff]=Fb[Ff]}}},Fb._calculateNodePropFrames=function(Fa,Fb,Fc,Fd){var Fe=0,Ff=Fa.length-1;if(0<Ff){for(Fb.length=Fa[Ff].index+1,Fe=0;Fe<Ff;Fe++)this._dealKeyFrame(Fa[Fe]),this._calculateFrameValues(Fa[Fe],Fa[Fe+1],Fb);this._dealKeyFrame(Fa[Fe])}0==Ff&&(Fb[Fa[0].index]=Fa[0].value,this._animationNewFrames&&(this._animationNewFrames[Fa[0].index]=!0))},Fb._dealKeyFrame=function(Fa){Fa.label&&""!=Fa.label&&this.addLabel(Fa.label,Fa.index)},Fb._calculateFrameValues=function(Fa,Fb,Fc){var Fd,Fe=0,Ff=Fa.index,Fg=Fb.index,Fh=Fa.value,Fi=Fb.value-Fa.value,Fj=Fg-Ff;if(Fg>this._count&&(this._count=Fg),Fa.tween)for(null==(Fd=FU[Fa.tweenMethod])&&(Fd=FU.linearNone),Fe=Ff;Fe<Fg;Fe++)Fc[Fe]=Fd(Fe-Ff,Fh,Fi,Fj),this._animationNewFrames&&(this._animationNewFrames[Fe]=!0);else for(Fe=Ff;Fe<Fg;Fe++)Fc[Fe]=Fh;this._animationNewFrames&&(this._animationNewFrames[Fa.index]=!0,this._animationNewFrames[Fb.index]=!0),Fc[Fb.index]=Fb.value},Ff._sortIndexFun=null,Ff}(Fra)),Fxa=function(Fb){function Fe(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",Fe.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=Fsa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}Fr(Fe,"laya.display.Input",Fb);var Fa=Fe.prototype;return Fa.setSelection=function(Fa,Fb){this.focus=!0,laya.display.Input.inputElement.selectionStart=Fa,laya.display.Input.inputElement.selectionEnd=Fb},Fa._onUnDisplay=function(Fa){this.focus=!1},Fa._onMouseDown=function(Fa){this.focus=!0},Fa._syncInputTransform=function(){var Fa=this.nativeInput,Fb=F$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),Fc=this._width-this.padding[1]-this.padding[3],Fd=this._height-this.padding[0]-this.padding[2];FJ.isConchApp?(Fa.setScale(Fb.scaleX,Fb.scaleY),Fa.setSize(Fc,Fd),Fa.setPos(Fb.x,Fb.y)):(Fe.inputContainer.style.transform=Fe.inputContainer.style.webkitTransform="scale("+Fb.scaleX+","+Fb.scaleY+") rotate("+Fz.stage.canvasDegree+"deg)",Fa.style.width=Fc+"px",Fa.style.height=Fd+"px",Fe.inputContainer.style.left=Fb.x+"px",Fe.inputContainer.style.top=Fb.y+"px")},Fa.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},Fa._setInputMethod=function(){Fe.input.parentElement&&Fe.inputContainer.removeChild(Fe.input),Fe.area.parentElement&&Fe.inputContainer.removeChild(Fe.area),Fe.inputElement=this._multiline?Fe.area:Fe.input,Fe.inputContainer.appendChild(Fe.inputElement),Fsa.RightToLeft&&(Fe.inputElement.style.direction="rtl")},Fa._focusIn=function(){laya.display.Input.isInputting=!0;var Fa=this.nativeInput;this._focus=!0;var Fb=Fa.style;Fb.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),Fa.readOnly=!this._editable,FJ.isConchApp&&(Fa.setType(this._type),Fa.setForbidEdit(!this._editable)),Fa.maxLength=this._maxChars;this.padding;if(Fa.type=this._type,Fa.value=this._content,Fa.placeholder=this._prompt,Fz.stage.off("keydown",this,this._onKeyDown),Fz.stage.on("keydown",this,this._onKeyDown),(Fz.stage.focus=this).event("focus"),FO.onPC&&Fa.focus(),!FO.onMiniGame){this._text;this._text=null}this.typeset(),Fa.setColor(this._originColor),Fa.setFontSize(this.fontSize),Fa.setFontFace(FO.onIPhone&&Fsa._fontFamilyMap[this.font]||this.font),FJ.isConchApp&&Fa.setMultiAble&&Fa.setMultiAble(this._multiline),Fb.lineHeight=this.leading+this.fontSize+"px",Fb.fontStyle=this.italic?"italic":"normal",Fb.fontWeight=this.bold?"bold":"normal",Fb.textAlign=this.align,Fb.padding="0 0",this._syncInputTransform(),!FJ.isConchApp&&FO.onPC&&Fz.timer.frameLoop(1,this,this._syncInputTransform)},Fa._setPromptColor=function(){(Fe.promptStyleDOM=FO.getElementById("promptStyle"))||((Fe.promptStyleDOM=FO.createElement("style")).setAttribute("id","promptStyle"),FO.document.head.appendChild(Fe.promptStyleDOM)),Fe.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},Fa._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(Fz.superSet(Fsa,this,"text",this._content),Fz.superSet(Fsa,this,"color",this._originColor)):(Fz.superSet(Fsa,this,"text",this._prompt),Fz.superSet(Fsa,this,"color",this._promptColor)),Fz.stage.off("keydown",this,this._onKeyDown),Fz.stage.focus=null,this.event("blur"),FJ.isConchApp&&this.nativeInput.blur(),FO.onPC&&Fz.timer.clear(this,this._syncInputTransform)},Fa._onKeyDown=function(Fa){13===Fa.keyCode&&(FO.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},Fa.changeText=function(Fa){this._content=Fa,this._focus?(this.nativeInput.value=Fa||"",this.event("change")):Fb.prototype.changeText.call(this,Fa)},Fm(0,Fa,"color",Fb.prototype._$get_color,function(Fa){this._focus&&this.nativeInput.setColor(Fa),Fz.superSet(Fsa,this,"color",this._content?Fa:this._promptColor),this._originColor=Fa}),Fm(0,Fa,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(Fa){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),Fm(0,Fa,"multiline",function(){return this._multiline},function(Fa){this._multiline=Fa,this.valign=Fa?"top":"middle"}),Fm(0,Fa,"maxChars",function(){return this._maxChars},function(Fa){Fa<=0&&(Fa=1e5),this._maxChars=Fa}),Fm(0,Fa,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(Fa){Fz.superSet(Fsa,this,"color",this._originColor),Fa+="",this._focus?(this.nativeInput.value=Fa||"",this.event("change")):(this._multiline||(Fa=Fa.replace(/\r?\n/g,"")),(this._content=Fa)?Fz.superSet(Fsa,this,"text",Fa):(Fz.superSet(Fsa,this,"text",this._prompt),Fz.superSet(Fsa,this,"color",this.promptColor)))}),Fm(0,Fa,"nativeInput",function(){return this._multiline?Fe.area:Fe.input}),Fm(0,Fa,"prompt",function(){return this._prompt},function(Fa){!this._text&&Fa&&Fz.superSet(Fsa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?Fz.superSet(Fsa,this,"text",this._text==this._prompt?Fa:this._text):Fz.superSet(Fsa,this,"text",Fa),this._prompt=Fsa.langPacks&&Fsa.langPacks[Fa]?Fsa.langPacks[Fa]:Fa}),Fm(0,Fa,"focus",function(){return this._focus},function(Fa){var Fb=this.nativeInput;this._focus!==Fa&&(Fa?(Fb.target?Fb.target._focusOut():this._setInputMethod(),(Fb.target=this)._focusIn()):(Fb.target=null,this._focusOut(),FO.document.body.scrollTop=0,Fb.blur(),FJ.isConchApp?Fb.setPos(-1e4,-1e4):Fe.inputContainer.contains(Fb)&&Fe.inputContainer.removeChild(Fb)))}),Fm(0,Fa,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(Fa){Fa?(-1<(Fa="[^"+Fa+"]").indexOf("^^")&&(Fa=Fa.replace("^^","")),this._restrictPattern=new RegExp(Fa,"g")):this._restrictPattern=null}),Fm(0,Fa,"editable",function(){return this._editable},function(Fa){this._editable=Fa,FJ.isConchApp&&Fe.input.setForbidEdit(!Fa)}),Fm(0,Fa,"promptColor",function(){return this._promptColor},function(Fa){this._promptColor=Fa,this._content||Fz.superSet(Fsa,this,"color",Fa)}),Fm(0,Fa,"type",function(){return this._type},function(Fa){this._getCSSStyle().password="password"==Fa,this._type=Fa,FJ.isConchApp&&this.nativeInput.setType(Fa)}),Fm(0,Fa,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(Fa){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),Fm(0,Fa,"asPassword",function(){return this._getCSSStyle().password},function(Fa){this._getCSSStyle().password=Fa,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),Fe.__init__=function(){Fe._createInputElement(),FO.onMobile&&FJ.canvas.addEventListener(Fe.IOS_IFRAME?FO.onMiniGame?"touchend":"click":"touchend",Fe._popupInputMethod)},Fe._popupInputMethod=function(Fa){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},Fe._createInputElement=function(){Fe._initInput(Fe.area=FO.createElement("textarea")),Fe._initInput(Fe.input=FO.createElement("input")),(Fe.inputContainer=FO.createElement("div")).style.position="absolute",Fe.inputContainer.style.zIndex=1e5,FO.container.appendChild(Fe.inputContainer),Fe.inputContainer.setPos=function(Fa,Fb){Fe.inputContainer.style.left=Fa+"px",Fe.inputContainer.style.top=Fb+"px"}},Fe._initInput=function(Fb){var Fa=Fb.style;Fa.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",Fa.resize="none",Fa.backgroundColor="transparent",Fa.border="none",Fa.outline="none",Fa.zIndex=1,Fb.addEventListener("input",Fe._processInputting),Fb.addEventListener("mousemove",Fe._stopEvent),Fb.addEventListener("mousedown",Fe._stopEvent),Fb.addEventListener("touchmove",Fe._stopEvent),Fb.setFontFace=function(Fa){Fb.style.fontFamily=Fa},FJ.isConchApp||(Fb.setColor=function(Fa){Fb.style.color=Fa},Fb.setFontSize=function(Fa){Fb.style.fontSize=Fa+"px"})},Fe._processInputting=function(Fa){var Fb=laya.display.Input.inputElement.target;if(Fb){var Fc=laya.display.Input.inputElement.value;Fb._restrictPattern&&(Fc=Fc.replace(/\u2006|\x27/g,""),Fb._restrictPattern.test(Fc)&&(Fc=Fc.replace(Fb._restrictPattern,""),laya.display.Input.inputElement.value=Fc)),Fb._text=Fc,Fb.event("input")}},Fe._stopEvent=function(Fa){"touchmove"==Fa.type&&Fa.preventDefault(),Fa.stopPropagation&&Fa.stopPropagation()},Fe.TYPE_TEXT="text",Fe.TYPE_PASSWORD="password",Fe.TYPE_EMAIL="email",Fe.TYPE_URL="url",Fe.TYPE_NUMBER="number",Fe.TYPE_RANGE="range",Fe.TYPE_DATE="date",Fe.TYPE_MONTH="month",Fe.TYPE_WEEK="week",Fe.TYPE_TIME="time",Fe.TYPE_DATE_TIME="datetime",Fe.TYPE_DATE_TIME_LOCAL="datetime-local",Fe.TYPE_SEARCH="search",Fe.input=null,Fe.area=null,Fe.inputElement=null,Fe.inputContainer=null,Fe.confirmButton=null,Fe.promptStyleDOM=null,Fe.inputHeight=45,Fe.isInputting=!1,Fe.stageMatrix=null,Fi(Fe,["IOS_IFRAME",function(){return this.IOS_IFRAME=FO.onIOS&&FO.window.top!=FO.window.self}]),Fe}(Fsa),Fya=function(Fa){function Fc(Fa,Fb){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,Fc.__super.call(this),Fa&&this._init_(Fa,Fb)}Fr(Fc,"laya.resource.HTMLImage",Fua);var Fb=Fc.prototype;return Fb._init_=function(Fa,Fb){this._src=Fa,this._source=new FO.window.Image,Fb&&(Fb.onload&&(this.onload=Fb.onload),Fb.onerror&&(this.onerror=Fb.onerror),Fb.onCreate&&Fb.onCreate(this)),0!=Fa.indexOf("data:image")&&(this._source.crossOrigin=""),Fa&&(this._source.src=Fa)},Fb.recreateResource=function(){var Fa=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var Fb=this;this._source=new FO.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(Fb._needReleaseAgain)return Fb._needReleaseAgain=!1,Fb._source.onload=null,void(Fb._source=null);Fb._source.onload=null,Fb.memorySize=Fa._w*Fa._h*4,Fb._recreateLock=!1,Fb.completeCreate()},this._source.src=this._src}},Fb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},Fb.onresize=function(){this._w=this._source.width,this._h=this._source.height},Fm(0,Fb,"onload",null,function(Fa){var Fb=this;this._onload=Fa,this._source&&(this._source.onload=null!=this._onload?function(){Fb.onresize(),Fb._onload()}:null)}),Fm(0,Fb,"onerror",null,function(Fa){var Fb=this;this._onerror=Fa,this._source&&(this._source.onerror=null!=this._onerror?function(){Fb._onerror()}:null)}),Fm(0,Fb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Fa){this._enableMerageInAtlas=Fa,FJ.isConchApp&&this._source&&(this._source.enableMerageInAtlas=Fa)}),Fc.create=function(Fa,Fb){return new Fc(Fa,Fb)},Fc}(),Fza=(function(Ff){function Fa(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,Fa.__super.call(this)}Fr(Fa,"laya.display.EffectAnimation",Ff);var Fb=Fa.prototype;Fb._onOtherBegin=function(Fa){Fa!=this&&this.stop()},Fb.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},Fb._onPlayAction=function(){this.play(0,!1)},Fb.play=function(Fa,Fb,Fc,Fd){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=!0),void 0===Fc&&(Fc=""),void 0===Fd&&(Fd=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,Fa,Fb,Fc,Fd))},Fb._recordInitData=function(){if(this._aniKeys){var Fa,Fb,Fc=0;for(Fa=this._aniKeys.length,Fc=0;Fc<Fa;Fc++)Fb=this._aniKeys[Fc],this._initData[Fb]=this._target[Fb]}},Fb._displayToIndex=function(Fa){if(this._animationData){Fa<0&&(Fa=0),Fa>this._count&&(Fa=this._count);var Fb=this._animationData.nodes,Fc=0,Fd=Fb.length;for(Fd=1<Fd?1:Fd,Fc=0;Fc<Fd;Fc++)this._displayNodeToFrame(Fb[Fc],Fa)}},Fb._displayNodeToFrame=function(Fa,Fb,Fc){if(this._target){var Fd;Fd=this._target;var Fe,Ff,Fg,Fh,Fi=Fa.frames,Fj=Fa.keys,Fm=0,Fn=Fj.length;Fh=Fa.secondFrames;var Fo,Fp,Fq,Fr,Fs=0;for(Fm=0;Fm<Fn;Fm++)Ff=Fi[Fe=Fj[Fm]],Fg=-1==(Fs=Fh[Fe])?this._initData[Fe]:Fb<Fs?(Fq=(Fp=Fa.keyframes[Fe])[0]).tween?(null==(Fo=FU[Fq.tweenMethod])&&(Fo=FU.linearNone),Fr=Fp[1],Fo(Fb,this._initData[Fe],Fr.value-this._initData[Fe],Fr.index)):this._initData[Fe]:Ff.length>Fb?Ff[Fb]:Ff[Ff.length-1],Fd[Fe]=Fg}},Fb._calculateNodeKeyFrames=function(Fa){Ff.prototype._calculateNodeKeyFrames.call(this,Fa);var Fb,Fc,Fd,Fe=Fa.keyframes;Fa.target;for(Fb in Fd={},Fa.secondFrames=Fd,Fe)(Fc=Fe[Fb]).length<=1?Fd[Fb]=-1:Fd[Fb]=Fc[1].index},Fm(0,Fb,"target",function(){return this._target},function(Fa){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=Fa,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),Fm(0,Fb,"playEvent",null,function(Fa){(this._playEvents=Fa)&&this.addEvent()}),Fm(0,Fb,"effectData",null,function(Fa){var Fb;Fa&&((Fb=Fa.animations)&&Fb[0]&&(this._setUp({},Fb[0]),Fb[0].nodes&&Fb[0].nodes[0]&&(this._aniKeys=Fb[0].nodes[0].keys)))}),Fm(0,Fb,"effectClass",null,function(Fa){var Fb,Fc;(this._effectClass=FR.getClass(Fa),this._effectClass)&&((Fb=this._effectClass.uiView)&&(Fc=Fb.animations)&&Fc[0]&&(this._setUp({},Fc[0]),Fc[0].nodes&&Fc[0].nodes[0]&&(this._aniKeys=Fc[0].nodes[0].keys)))}),Fa.EffectAnimationBegin="effectanimationbegin"}(Fwa),function(Fb){var FD;function FE(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,FE.__super.call(this)}Fr(FE,"laya.utils.GraphicAnimation",Fb);var Fa=FE.prototype;return Fa._parseNodeList=function(Fa){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[Fa.compId]=Fa.props,Fa.compId&&this._nodeList.push(Fa.compId);var Fb=Fa.child;if(Fb){var Fc=0,Fd=Fb.length;for(Fc=0;Fc<Fd;Fc++)this._parseNodeList(Fb[Fc])}},Fa._calGraphicData=function(Fa){var Fb;if(this._setUp(null,Fa),this._createGraphicData(),this._nodeIDAniDic)for(Fb in this._nodeIDAniDic)this._nodeIDAniDic[Fb]=null},Fa._createGraphicData=function(){var Fa,Fb=[],Fc=0,Fd=this.count,Fe=this._animationNewFrames;for(Fe||(Fe=[]),Fc=0;Fc<Fd;Fc++)!Fe[Fc]&&Fa||(Fa=this._createFrameGraphic(Fc)),Fb.push(Fa);this._gList=Fb},Fa._createFrameGraphic=function(Fa){var Fb=FF.createGraphics();return FE._rootMatrix||(FE._rootMatrix=new FG),this._updateNodeGraphic(this._rootNode,Fa,FE._rootMatrix,Fb),Fb},Fa._updateNodeGraphic=function(Fa,Fb,Fc,Fd,Fe){var Ff;void 0===Fe&&(Fe=1);var Fg,Fh,Fi,Fj=(Ff=this._nodeGDic[Fa.compId]=this._getNodeGraphicData(Fa.compId,Fb,this._nodeGDic[Fa.compId])).alpha*Fe;if(!(Fj<.01)&&(Ff.resultTransform||(Ff.resultTransform=FG.create()),Fg=Ff.resultTransform,FG.mul(Ff.transform,Fc,Fg),Ff.skin&&(Fh=this._getTextureByUrl(Ff.skin))&&(Fg._checkTransform()?(Fd.drawTexture(Fh,0,0,Ff.width,Ff.height,Fg,Fj),Ff.resultTransform=null):Fd.drawTexture(Fh,Fg.tx,Fg.ty,Ff.width,Ff.height,null,Fj)),Fi=Fa.child)){var Fm,Fn=0;for(Fm=Fi.length,Fn=0;Fn<Fm;Fn++)this._updateNodeGraphic(Fi[Fn],Fb,Fg,Fd,Fj)}},Fa._updateNoChilds=function(Fa,Fb){if(Fa.skin){var Fc=this._getTextureByUrl(Fa.skin);if(Fc){var Fd=Fa.transform;Fd._checkTransform();!Fd.bTransform?Fb.drawTexture(Fc,Fd.tx,Fd.ty,Fa.width,Fa.height,null,Fa.alpha):Fb.drawTexture(Fc,0,0,Fa.width,Fa.height,Fd.clone(),Fa.alpha)}}},Fa._updateNodeGraphic2=function(Fa,Fb,Fc){var Fd;if(Fd=this._nodeGDic[Fa.compId]=this._getNodeGraphicData(Fa.compId,Fb,this._nodeGDic[Fa.compId]),Fa.child){var Fe=Fd.transform;Fe._checkTransform();var Ff,Fg;Fg=(Ff=!Fe.bTransform)&&(0!=Fe.tx||0!=Fe.ty);var Fh,Fi,Fj;if((Fh=Fe.bTransform||1!=Fd.alpha)&&Fc.save(),1!=Fd.alpha&&Fc.alpha(Fd.alpha),Ff?Fg&&Fc.translate(Fe.tx,Fe.ty):Fc.transform(Fe.clone()),Fi=Fa.child,Fd.skin&&(Fj=this._getTextureByUrl(Fd.skin))&&Fc.drawTexture(Fj,0,0,Fd.width,Fd.height),Fi){var Fm,Fn=0;for(Fm=Fi.length,Fn=0;Fn<Fm;Fn++)this._updateNodeGraphic2(Fi[Fn],Fb,Fc)}Fh?Fc.restore():Ff?Fg&&Fc.translate(-Fe.tx,-Fe.ty):Fc.transform(Fe.clone().invert())}else this._updateNoChilds(Fd,Fc)},Fa._calculateNodeKeyFrames=function(Fa){Fb.prototype._calculateNodeKeyFrames.call(this,Fa),this._nodeIDAniDic[Fa.target]=Fa},Fa.getNodeDataByID=function(Fa){return this._nodeIDAniDic[Fa]},Fa._getParams=function(Fa,Fb,Fc,Fd){var Fe=FE._temParam;Fe.length=Fb.length;var Ff=0,Fg=Fb.length;for(Ff=0;Ff<Fg;Ff++)Fe[Ff]=this._getObjVar(Fa,Fb[Ff][0],Fc,Fb[Ff][1],Fd);return Fe},Fa._getObjVar=function(Fa,Fb,Fc,Fd,Fe){if(Fa.hasOwnProperty(Fb)){var Ff=Fa[Fb];if(Fc>=Ff.length&&(Fc=Ff.length-1),null!=Fa[Fb][Fc])return Fa[Fb][Fc]}return Fe.hasOwnProperty(Fb)?Fe[Fb]:Fd},Fa._getNodeGraphicData=function(Fa,Fb,Fc){Fc||(Fc=FD.create()),Fc.transform?Fc.transform.identity():Fc.transform=FG.create();var Fd=this.getNodeDataByID(Fa);if(!Fd)return Fc;var Fe,Ff,Fg=Fd.frames,Fh=this._getParams(Fg,FE._drawTextureCmd,Fb,this._nodeDefaultProps[Fa]),Fi=Fh[0],Fj=NaN,Fm=NaN,Fn=Fh[5],Fo=Fh[6],Fp=Fh[13],Fq=Fh[14],Fr=Fh[7],Fs=Fh[8],Ft=Fh[9],Fu=Fh[11],Fv=Fh[12];Fj=Fh[3],Fm=Fh[4],0!=Fj&&0!=Fm||(Fi=null),-1==Fj&&(Fj=0),-1==Fm&&(Fm=0),Fc.skin=Fi,Fc.width=Fj,Fc.height=Fm,Fi&&((Fe=this._getTextureByUrl(Fi))?(Fj||(Fj=Fe.sourceWidth),Fm||(Fm=Fe.sourceHeight)):console.warn("lost skin:",Fi,",you may load pics first")),Fc.alpha=Fh[10],Ff=Fc.transform,0!=Fp&&(Fn=Fp*Fj),0!=Fq&&(Fo=Fq*Fm),0==Fn&&0==Fo||Ff.translate(-Fn,-Fo);var Fw=null;if(Ft||1!==Fr||1!==Fs||Fu||Fv){(Fw=FE._tempMt).identity(),Fw.bTransform=!0;var Fx=.0174532922222222*(Ft-Fu),Fy=.0174532922222222*(Ft+Fv),Fz=Math.cos(Fy),FA=Math.sin(Fy),FB=Math.sin(Fx),FC=Math.cos(Fx);Fw.a=Fr*Fz,Fw.b=Fr*FA,Fw.c=-Fs*FB,Fw.d=Fs*FC,Fw.tx=Fw.ty=0}return Fw&&(Ff=FG.mul(Ff,Fw,Ff)),Ff.translate(Fh[1],Fh[2]),Fc},Fa._getTextureByUrl=function(Fa){return Fha.getRes(Fa)},Fa.setAniData=function(Fa,Fb){if(Fa.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Fa,this._parseNodeList(Fa);var Fc,Fd={},Fe=[],Ff=Fa.animations,Fg=0,Fh=Ff.length;for(Fg=0;Fg<Fh;Fg++)if(Fc=Ff[Fg],this._labels=null,(!Fb||Fb==Fc.name)&&Fc){try{this._calGraphicData(Fc)}catch(Fa){console.warn("parse animation fail:"+Fc.name+",empty animation created"),this._gList=[]}var Fi={};Fi.interval=1e3/Fc.frameRate,Fi.frames=this._gList,Fi.labels=this._labels,Fi.name=Fc.name,Fe.push(Fi),Fd[Fc.name]=Fi}this.animationList=Fe,this.animationDic=Fd}FE._temParam.length=0},Fa.parseByData=function(Fa){var Fb,Fc;Fb=Fa.nodeRoot,Fc=Fa.aniO,delete Fa.nodeRoot,delete Fa.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Fb,this._parseNodeList(Fb),this._labels=null;try{this._calGraphicData(Fc)}catch(Fa){console.warn("parse animation fail:"+Fc.name+",empty animation created"),this._gList=[]}var Fd=Fa;return Fd.interval=1e3/Fc.frameRate,Fd.frames=this._gList,Fd.labels=this._labels,Fd.name=Fc.name,Fd},Fa.setUpAniData=function(Fa){if(Fa.animations){var Fb,Fc={},Fd=[],Fe=Fa.animations,Ff=0,Fg=Fe.length;for(Ff=0;Ff<Fg;Ff++)if(Fb=Fe[Ff]){var Fh={};Fh.name=Fb.name,Fh.aniO=Fb,Fh.nodeRoot=Fa,Fd.push(Fh),Fc[Fb.name]=Fh}this.animationList=Fd,this.animationDic=Fc}},Fa._clear=function(){var Fa,Fb;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(Fa in this._nodeGDic)(Fb=this._nodeGDic[Fa])&&Fb.recover();this._nodeGDic=null},FE.parseAnimationByData=function(Fa){var Fb;return FE._I||(FE._I=new FE),Fb=FE._I.parseByData(Fa),FE._I._clear(),Fb},FE.parseAnimationData=function(Fa){var Fb;return FE._I||(FE._I=new FE),FE._I.setUpAniData(Fa),(Fb={}).animationList=FE._I.animationList,Fb.animationDic=FE._I.animationDic,FE._I._clear(),Fb},FE._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],FE._temParam=[],FE._I=null,FE._rootMatrix=null,Fi(FE,["_tempMt",function(){return this._tempMt=new FG}]),FE.__init$=function(){FD=function(){function Fa(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return Fr(Fa,""),Fa.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),FW.recover("GraphicNode",this)},Fa.create=function(){return FW.getItemByClass("GraphicNode",Fa)},Fa}()},FE}(Fwa));Fz.__init([Fj,Fia,FJ,FO,FY,FC,Fa,Fza])}(window,document,Laya),function(Fa,Fb,Fc){Fc.un,Fc.uns,Fc.static;var Fd=Fc.class;Fc.getset,Fc.__newvec;new(function(){function Fa(){}return Fd(Fa,"LayaMain"),Fa}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Fa,Fb){"use strict";for(var Fc in Object.defineProperty(Fb,"__esModule",{value:!0}),Laya){var Fd=Laya[Fc];Fd&&Fd.__isclass&&(Fb[Fc]=Fd)}}),function(Fa,Fb,Fy){Fy.un,Fy.uns;var Fg=Fy.static,Fo=Fy.class,Fd=Fy.getset,Ff=Fy.__newvec,Fm=laya.maths.Arith,Fn=laya.maths.Bezier,Fc=laya.resource.Bitmap,Fp=laya.utils.Browser,Fi=laya.utils.Byte,Fq=laya.utils.Color,Fz=(laya.filters.ColorFilter,Fy.Config),Fe=laya.resource.Context,FA=(laya.events.Event,laya.filters.Filter),Fh=laya.display.Graphics,Fj=laya.resource.HTMLCanvas,Fr=(laya.utils.HTMLChar,laya.resource.HTMLImage),Fs=laya.resource.HTMLSubImage,FB=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),FC=laya.maths.Point,FD=laya.maths.Rectangle,Ft=laya.renders.Render,Fu=(laya.renders.RenderContext,laya.renders.RenderSprite),Fv=laya.resource.Resource,Fw=laya.resource.ResourceManager,Fx=laya.utils.RunDriver,FE=laya.display.Sprite,FF=laya.display.Stage,FG=laya.utils.Stat,FH=laya.utils.StringKey,FI=(laya.display.css.Style,laya.system.System),FJ=laya.display.Text,FK=laya.resource.Texture,FL=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),FM=laya.utils.VectorGraphManager;laya.utils.WordText;Fy.interface("laya.webgl.shapes.IShape"),Fy.interface("laya.webgl.submit.ISubmit"),Fy.interface("laya.webgl.text.ICharSegment"),Fy.interface("laya.webgl.canvas.save.ISaveData"),Fy.interface("laya.webgl.resource.IMergeAtlasBitmap"),Fy.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var FN=function(){function Fa(){}Fo(Fa,"laya.filters.webgl.FilterActionGL");var Fb=Fa.prototype;return Fy.imps(Fb,{"laya.filters.IFilterActionGL":!0}),Fb.setValue=function(Fa){},Fb.setValueMix=function(Fa){},Fb.apply3d=function(Fa,Fb,Fc,Fd,Fe){return null},Fb.apply=function(Fa){return null},Fd(0,Fb,"typeMix",function(){return 0}),Fa}(),FO=function(){function Fa(){}return Fo(Fa,"laya.webgl.shader.ShaderValue"),Fa}(),FP=function(){var Fd,Fe;function Fa(Fa,Fb,Fc){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new Fe,void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),this._cells=null,this._rowInfo=null,this._init(Fa,Fb),this._atlasID=Fc}Fo(Fa,"laya.webgl.atlas.AtlasGrid");var Fb=Fa.prototype;return Fb.getAltasID=function(){return this._atlasID},Fb.setAltasID=function(Fa){0<=Fa&&(this._atlasID=Fa)},Fb.addTex=function(Fa,Fb,Fc){var Fd=this._get(Fb,Fc);return 0==Fd.ret||(this._fill(Fd.x,Fd.y,Fb,Fc,Fa),this._texCount++),Fd},Fb._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},Fb._init=function(Fa,Fb){if(this._width=Fa,this._height=Fb,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=Ff(this._height);for(var Fc=0;Fc<this._height;Fc++)this._rowInfo[Fc]=new Fd;return this._clear(),!0},Fb._get=function(Fa,Fb){var Fc=new FR;if(Fa>=this._failSize.width&&Fb>=this._failSize.height)return Fc;for(var Fd=-1,Fe=-1,Ff=this._width,Fg=this._height,Fh=this._cells,Fi=0;Fi<Fg;Fi++)if(!(this._rowInfo[Fi].spaceCount<Fa))for(var Fj=0;Fj<Ff;){var Fm=3*(Fi*Ff+Fj);if(0!=Fh[Fm]||Fh[1+Fm]<Fa||Fh[2+Fm]<Fb)Fj+=Fh[1+Fm];else{Fd=Fj,Fe=Fi;for(var Fn=0;Fn<Fa;Fn++)if(Fh[3*Fn+Fm+2]<Fb){Fd=-1;break}if(!(Fd<0))return Fc.ret=!0,Fc.x=Fd,Fc.y=Fe,Fc;Fj+=Fh[1+Fm]}}return Fc},Fb._fill=function(Fa,Fb,Fc,Fd,Fe){var Ff=this._width,Fg=this._height;this._check(Fa+Fc<=Ff&&Fb+Fd<=Fg);for(var Fh=Fb;Fh<Fd+Fb;++Fh){this._check(this._rowInfo[Fh].spaceCount>=Fc),this._rowInfo[Fh].spaceCount-=Fc;for(var Fi=0;Fi<Fc;Fi++){var Fj=3*(Fa+Fh*Ff+Fi);this._check(0==this._cells[Fj]),this._cells[Fj]=Fe,this._cells[1+Fj]=Fc,this._cells[2+Fj]=Fd}}if(0<Fa)for(Fh=0;Fh<Fd;++Fh){var Fm=0;for(Fi=Fa-1;0<=Fi&&0==this._cells[3*((Fb+Fh)*Ff+Fi)];--Fi,++Fm);for(Fi=Fm;0<Fi;--Fi)this._cells[3*((Fb+Fh)*Ff+Fa-Fi)+1]=Fi,this._check(0<Fi)}if(0<Fb)for(Fi=Fa;Fi<Fa+Fc;++Fi){for(Fm=0,Fh=Fb-1;0<=Fh&&0==this._cells[3*(Fi+Fh*Ff)];--Fh,Fm++);for(Fh=Fm;0<Fh;--Fh)this._cells[3*(Fi+(Fb-Fh)*Ff)+2]=Fh,this._check(0<Fh)}},Fb._check=function(Fa){0==Fa&&console.log("xtexMerger 错误啦")},Fb._clear=function(){for(var Fa=this._texCount=0;Fa<this._height;Fa++)this._rowInfo[Fa].spaceCount=this._width;for(var Fb=0;Fb<this._height;Fb++)for(var Fc=0;Fc<this._width;Fc++){var Fd=3*(Fb*this._width+Fc);this._cells[Fd]=0,this._cells[1+Fd]=this._width-Fc,this._cells[2+Fd]=this._width-Fb}this._failSize.width=this._width+1,this._failSize.height=this._height+1},Fa.__init$=function(){Fd=function(){function Fa(){this.spaceCount=0}return Fo(Fa,""),Fa}(),Fe=function(){function Fa(){this.width=0,this.height=0}return Fo(Fa,""),Fa}()},Fa}(),FQ=function(){function Ft(Fa,Fb,Fc,Fd){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=Fa,this._height=Fb,this._gridSize=Fc,this._maxAtlaserCount=Fd,this._gridNumX=Fa/Fc,this._gridNumY=Fb/Fc,this._curAtlasIndex=0,this._atlaserArray=[]}Fo(Ft,"laya.webgl.atlas.AtlasResourceManager");var Fa=Ft.prototype;return Fa.setAtlasParam=function(Fa,Fb,Fc,Fd){if(1==this._setAtlasParam)return Ft._sid_=0,this._width=Fa,this._height=Fb,this._gridSize=Fc,this._maxAtlaserCount=Fd,this._gridNumX=Fa/Fc,this._gridNumY=Fb/Fc,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},Fa.pushData=function(Fa){var Fb,Fc=Fa.bitmap,Fd=-1,Fe=null,Ff=0,Fg=0;for(Ff=0,Fb=this._atlaserArray.length;Ff<Fb&&(Fg=(this._curAtlasIndex+Ff)%Fb,-1==(Fd=(Fe=this._atlaserArray[Fg]).findBitmapIsExist(Fc)));Ff++);if(-1!=Fd){var Fh=Fe.InAtlasWebGLImagesOffsetValue[Fd];return Fq=Fh[0],Fr=Fh[1],Fe.addToAtlas(Fa,Fq,Fr),!0}this._setAtlasParam=!1;for(var Fi=Math.ceil((Fa.bitmap.width+2)/this._gridSize),Fj=Math.ceil((Fa.bitmap.height+2)/this._gridSize),Fm=!1,Fn=0;Fn<2;Fn++){var Fo=this._maxAtlaserCount;for(Ff=0;Ff<Fo;Ff++){Fg=(this._curAtlasIndex+Ff)%Fo,this._atlaserArray.length-1>=Fg||this._atlaserArray.push(new FDa(this._gridNumX,this._gridNumY,this._width,this._height,Ft._sid_++));var Fp=this._atlaserArray[Fg],Fq=0,Fr=0,Fs=Fp.addTex(1,Fi,Fj);if(Fs.ret){Fq=Fs.x*this._gridSize+1,Fr=Fs.y*this._gridSize+1,Fc.lock=!0,Fp.addToAtlasTexture(Fc,Fq,Fr),Fp.addToAtlas(Fa,Fq,Fr),Fm=!0,this._curAtlasIndex=Fg;break}}if(Fm)break;this._atlaserArray.push(new FDa(this._gridNumX,this._gridNumY,this._width,this._height,Ft._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return Fm||console.log(">>>AtlasManager pushData error"),Fm},Fa.addToAtlas=function(Fa){laya.webgl.atlas.AtlasResourceManager.instance.pushData(Fa)},Fa.garbageCollection=function(){if(!0===this._needGC){for(var Fa=this._atlaserArray.length-this._maxAtlaserCount,Fb=0;Fb<Fa;Fb++)this._atlaserArray[Fb].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+Fa),this._atlaserArray.splice(0,Fa),this._needGC=!1}return!0},Fa.freeAll=function(){for(var Fa=0,Fb=this._atlaserArray.length;Fa<Fb;Fa++)this._atlaserArray[Fa].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},Fa.getAtlaserCount=function(){return this._atlaserArray.length},Fa.getAtlaserByIndex=function(Fa){return this._atlaserArray[Fa]},Fd(1,Ft,"instance",function(){return Ft._Instance||(Ft._Instance=new Ft(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),Ft._Instance}),Fd(1,Ft,"enabled",function(){return Fz.atlasEnable}),Fd(1,Ft,"atlasLimitWidth",function(){return Ft._atlasLimitWidth},function(Fa){Ft._atlasLimitWidth=Fa}),Fd(1,Ft,"atlasLimitHeight",function(){return Ft._atlasLimitHeight},function(Fa){Ft._atlasLimitHeight=Fa}),Ft._enable=function(){Fz.atlasEnable=!0},Ft._disable=function(){Fz.atlasEnable=!1},Ft.__init__=function(){Ft.atlasTextureWidth=2048,Ft.atlasTextureHeight=2048,Ft.maxTextureCount=6,Ft.atlasLimitWidth=512,Ft.atlasLimitHeight=512},Ft._atlasLimitWidth=0,Ft._atlasLimitHeight=0,Ft.gridSize=16,Ft.atlasTextureWidth=0,Ft.atlasTextureHeight=0,Ft.maxTextureCount=0,Ft._atlasRestore=0,Ft.BOARDER_TYPE_NO=0,Ft.BOARDER_TYPE_RIGHT=1,Ft.BOARDER_TYPE_LEFT=2,Ft.BOARDER_TYPE_BOTTOM=4,Ft.BOARDER_TYPE_TOP=8,Ft.BOARDER_TYPE_ALL=15,Ft._sid_=0,Ft._Instance=null,Ft}(),FR=function(){function Fa(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return Fo(Fa,"laya.webgl.atlas.MergeFillInfo"),Fa}(),FS=function(){function Fb(){}return Fo(Fb,"laya.webgl.canvas.BlendMode"),Fb._init_=function(Fa){Fb.fns=[Fb.BlendNormal,Fb.BlendAdd,Fb.BlendMultiply,Fb.BlendScreen,Fb.BlendOverlay,Fb.BlendLight,Fb.BlendMask,Fb.BlendDestinationOut],Fb.targetFns=[Fb.BlendNormalTarget,Fb.BlendAddTarget,Fb.BlendMultiplyTarget,Fb.BlendScreenTarget,Fb.BlendOverlayTarget,Fb.BlendLightTarget,Fb.BlendMask,Fb.BlendDestinationOut]},Fb.BlendNormal=function(Fa){Fa.blendFunc(1,771)},Fb.BlendAdd=function(Fa){Fa.blendFunc(1,772)},Fb.BlendMultiply=function(Fa){Fa.blendFunc(774,771)},Fb.BlendScreen=function(Fa){Fa.blendFunc(1,1)},Fb.BlendOverlay=function(Fa){Fa.blendFunc(1,769)},Fb.BlendLight=function(Fa){Fa.blendFunc(1,1)},Fb.BlendNormalTarget=function(Fa){Fa.blendFunc(1,771)},Fb.BlendAddTarget=function(Fa){Fa.blendFunc(1,772)},Fb.BlendMultiplyTarget=function(Fa){Fa.blendFunc(774,771)},Fb.BlendScreenTarget=function(Fa){Fa.blendFunc(1,1)},Fb.BlendOverlayTarget=function(Fa){Fa.blendFunc(1,769)},Fb.BlendLightTarget=function(Fa){Fa.blendFunc(1,1)},Fb.BlendMask=function(Fa){Fa.blendFunc(0,770)},Fb.BlendDestinationOut=function(Fa){Fa.blendFunc(0,0)},Fb.activeBlendFunction=null,Fb.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],Fb.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},Fb.NORMAL="normal",Fb.ADD="add",Fb.MULTIPLY="multiply",Fb.SCREEN="screen",Fb.LIGHT="light",Fb.OVERLAY="overlay",Fb.DESTINATIONOUT="destination-out",Fb.fns=[],Fb.targetFns=[],Fb}(),FT=function(){function Fc(Fa){this._color=Fq.create("black"),this.setValue(Fa)}Fo(Fc,"laya.webgl.canvas.DrawStyle");var Fa=Fc.prototype;return Fa.setValue=function(Fa){if(Fa){if("string"==typeof Fa)return void(this._color=Fq.create(Fa));if(Fa instanceof laya.utils.Color)return void(this._color=Fa)}},Fa.reset=function(){this._color=Fq.create("black")},Fa.equal=function(Fa){return"string"==typeof Fa?this._color.strColor===Fa:Fa instanceof laya.utils.Color&&this._color.numColor===Fa.numColor},Fa.toColorStr=function(){return this._color.strColor},Fc.create=function(Fa){var Fb;if(Fa&&("string"==typeof Fa?Fb=Fq.create(Fa):Fa instanceof laya.utils.Color&&(Fb=Fa),Fb))return Fb._drawStyle||(Fb._drawStyle=new Fc(Fa));return laya.webgl.canvas.DrawStyle.DEFAULT},Fg(Fc,["DEFAULT",function(){return this.DEFAULT=new Fc("#000000")}]),Fc}(),FU=function(){function Fa(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];Fwa.mainContext;this.ib=Fka.create(35048),this.vb=Fla.create(5)}Fo(Fa,"laya.webgl.canvas.Path");var Fb=Fa.prototype;return Fb.addPoint=function(Fa,Fb){this.tempArray.push(Fa,Fb)},Fb.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},Fb.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},Fb.polygon=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg;return this.geomatrys.push(this._curGeomatry=Fg=new FHa(Fa,Fb,Fc,Fd,Fe,Ff)),Fd||(Fg.fill=!1),null==Ff&&(Fg.borderWidth=0),Fg},Fb.setGeomtry=function(Fa){this.geomatrys.push(this._curGeomatry=Fa)},Fb.drawLine=function(Fa,Fb,Fc,Fd,Fe){var Ff;return this.closePath?this.geomatrys.push(this._curGeomatry=Ff=new FGa(Fa,Fb,Fc,Fd,Fe)):this.geomatrys.push(this._curGeomatry=Ff=new FFa(Fa,Fb,Fc,Fd,Fe)),Ff.fill=!1,Ff},Fb.update=function(){var Fa=this.ib._byteLength,Fb=this.geomatrys.length;this.offset=Fa;for(var Fc=this.geoStart;Fc<Fb;Fc++)this.geomatrys[Fc].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=Fb,this.count=(this.ib._byteLength-Fa)/Fra.BYTES_PIDX},Fb.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},Fb.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},Fa}(),FV=function(){function Fh(){}Fo(Fh,"laya.webgl.canvas.save.SaveBase");var Fa=Fh.prototype;return Fy.imps(Fa,{"laya.webgl.canvas.save.ISaveData":!0}),Fa.isSaveMark=function(){return!1},Fa.restore=function(Fa){this._dataObj[this._valueName]=this._value,(Fh._cache[Fh._cache._length++]=this)._newSubmit&&(Fa._curSubmit=Ffa.RENDERBASE,Fa._renderKey=0)},Fh._createArray=function(){var Fa=[];return Fa._length=0,Fa},Fh._init=function(){var Fa=Fh._namemap={};return Fa[1]="ALPHA",Fa[2]="fillStyle",Fa[8]="font",Fa[256]="lineWidth",Fa[512]="strokeStyle",Fa[8192]="_mergeID",Fa[1024]=Fa[2048]=Fa[4096]=[],Fa[16384]="textBaseline",Fa[32768]="textAlign",Fa[65536]="_nBlendType",Fa[1048576]="shader",Fa[2097152]="filters",Fa},Fh.save=function(Fa,Fb,Fc,Fd){if((Fa._saveMark._saveuse&Fb)!==Fb){Fa._saveMark._saveuse|=Fb;var Fe=Fh._cache,Ff=0<Fe._length?Fe[--Fe._length]:new Fh;Ff._value=Fc[Ff._valueName=Fh._namemap[Fb]],Ff._dataObj=Fc,Ff._newSubmit=Fd;var Fg=Fa._save;Fg[Fg._length++]=Ff}},Fh._cache=laya.webgl.canvas.save.SaveBase._createArray(),Fh._namemap=Fh._init(),Fh}(),FW=function(){function Ff(){this._clipRect=new FD}Fo(Ff,"laya.webgl.canvas.save.SaveClipRect");var Fa=Ff.prototype;return Fy.imps(Fa,{"laya.webgl.canvas.save.ISaveData":!0}),Fa.isSaveMark=function(){return!1},Fa.restore=function(Fa){Fa._clipRect=this._clipSaveRect,(Ff._cache[Ff._cache._length++]=this)._submitScissor.submitLength=Fa._submits._length-this._submitScissor.submitIndex,Fa._curSubmit=Ffa.RENDERBASE,Fa._renderKey=0},Ff.save=function(Fa,Fb){if(131072!=(131072&Fa._saveMark._saveuse)){Fa._saveMark._saveuse|=131072;var Fc=Ff._cache,Fd=0<Fc._length?Fc[--Fc._length]:new Ff;Fd._clipSaveRect=Fa._clipRect,Fa._clipRect=Fd._clipRect.copyFrom(Fa._clipRect),Fd._submitScissor=Fb;var Fe=Fa._save;Fe[Fe._length++]=Fd}},Fg(Ff,["_cache",function(){return this._cache=FV._createArray()}]),Ff}(),FX=function(){function Fp(){this._contextX=0,this._contextY=0,this._clipRect=new FD,this._rect=new FD,this._matrix=new FB}Fo(Fp,"laya.webgl.canvas.save.SaveClipRectStencil");var Fa=Fp.prototype;return Fy.imps(Fa,{"laya.webgl.canvas.save.ISaveData":!0}),Fa.isSaveMark=function(){return!1},Fa.restore=function(Fa){Fma.restore(Fa,this._rect,this._saveMatrix,this._contextX,this._contextY),Fa._clipRect=this._clipSaveRect,Fa._curMat=this._saveMatrix,Fa._x=this._contextX,Fa._y=this._contextY,Fp._cache[Fp._cache._length++]=this,Fa._curSubmit=Ffa.RENDERBASE},Fp.save=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){if(262144!=(262144&Fa._saveMark._saveuse)){Fa._saveMark._saveuse|=262144;var Fm=Fp._cache,Fn=0<Fm._length?Fm[--Fm._length]:new Fp;Fn._clipSaveRect=Fa._clipRect,Fn._clipRect.setTo(Fg,Fh,Fi,Fj),Fa._clipRect=Fn._clipRect,Fn._rect.x=Fc,Fn._rect.y=Fd,Fn._rect.width=Fe,Fn._rect.height=Ff,Fn._contextX=Fa._x,Fn._contextY=Fa._y,Fn._saveMatrix=Fa._curMat,Fa._curMat.copyTo(Fn._matrix),Fa._curMat=Fn._matrix,Fn._submitStencil=Fb;var Fo=Fa._save;Fo[Fo._length++]=Fn}},Fg(Fp,["_cache",function(){return this._cache=FV._createArray()}]),Fp}(),FY=function(){function Fd(){this._saveuse=0}Fo(Fd,"laya.webgl.canvas.save.SaveMark");var Fa=Fd.prototype;return Fy.imps(Fa,{"laya.webgl.canvas.save.ISaveData":!0}),Fa.isSaveMark=function(){return!0},Fa.restore=function(Fa){Fa._saveMark=this._preSaveMark,Fd._no[Fd._no._length++]=this},Fd.Create=function(Fa){var Fb=Fd._no,Fc=0<Fb._length?Fb[--Fb._length]:new Fd;return Fc._saveuse=0,Fc._preSaveMark=Fa._saveMark,Fa._saveMark=Fc},Fg(Fd,["_no",function(){return this._no=FV._createArray()}]),Fd}(),FZ=function(){function Ff(){this._matrix=new FB}Fo(Ff,"laya.webgl.canvas.save.SaveTransform");var Fa=Ff.prototype;return Fy.imps(Fa,{"laya.webgl.canvas.save.ISaveData":!0}),Fa.isSaveMark=function(){return!1},Fa.restore=function(Fa){Fa._curMat=this._savematrix,Ff._no[Ff._no._length++]=this},Ff.save=function(Fa){var Fb=Fa._saveMark;if(2048!=(2048&Fb._saveuse)){Fb._saveuse|=2048;var Fc=Ff._no,Fd=0<Fc._length?Fc[--Fc._length]:new Ff;Fd._savematrix=Fa._curMat,Fa._curMat=Fa._curMat.copyTo(Fd._matrix);var Fe=Fa._save;Fe[Fe._length++]=Fd}},Fg(Ff,["_no",function(){return this._no=FV._createArray()}]),Ff}(),F$=function(){function Fe(){}Fo(Fe,"laya.webgl.canvas.save.SaveTranslate");var Fa=Fe.prototype;return Fy.imps(Fa,{"laya.webgl.canvas.save.ISaveData":!0}),Fa.isSaveMark=function(){return!1},Fa.restore=function(Fa){Fa._curMat;Fa._x=this._x,Fa._y=this._y,Fe._no[Fe._no._length++]=this},Fe.save=function(Fa){var Fb=Fe._no,Fc=0<Fb._length?Fb[--Fb._length]:new Fe;Fc._x=Fa._x,Fc._y=Fa._y;var Fd=Fa._save;Fd[Fd._length++]=Fc},Fg(Fe,["_no",function(){return this._no=FV._createArray()}]),Fe}(),F_=function(){function Fa(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new FD}Fo(Fa,"laya.webgl.resource.RenderTargetMAX");var Fb=Fa.prototype;return Fb.setSP=function(Fa){this._sp=Fa},Fb.size=function(Fa,Fb){var Fc=this;this._width!==Fa||this._height!==Fb?(this.repaint=!0,this._width=Fa,this._height=Fb,this.target?this.target.size(Fa,Fb):this.target=FMa.create(Fa,Fb),this.target.hasListener("recovered")||this.target.on("recovered",this,function(Fa){Fy.timer.callLater(Fc._sp,Fc._sp.repaint)})):this.target.size(Fa,Fb)},Fb._flushToTarget=function(Fa,Fb){if(!Fb._destroy){var Fc=Fua.worldScissorTest,Fd=Fua.worldClipRect;Fua.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,Fua.worldScissorTest=!1,Fwa.mainContext.disable(3089);var Fe=Fua.worldAlpha,Ff=Fua.worldMatrix4,Fg=Fua.worldMatrix,Fh=Fua.worldFilters,Fi=Fua.worldShaderDefines;if(Fua.worldMatrix=FB.EMPTY,Fua.restoreTempArray(),Fua.worldMatrix4=Fua.TEMPMAT4_ARRAY,Fua.worldAlpha=1,Fua.worldFilters=null,Fua.worldShaderDefines=null,FLa.activeShader=null,Fb.start(),Fz.showCanvasMark?Fb.clear(0,1,0,.3):Fb.clear(0,0,0,0),Fa.flush(),Fb.end(),FLa.activeShader=null,Fua.worldAlpha=Fe,Fua.worldMatrix4=Ff,Fua.worldMatrix=Fg,Fua.worldFilters=Fh,Fua.worldShaderDefines=Fi,Fua.worldScissorTest=Fc){var Fj=Fua.height-Fd.y-Fd.height;Fwa.mainContext.scissor(Fd.x,Fj,Fd.width,Fd.height),Fwa.mainContext.enable(3089)}Fua.worldClipRect=Fd}},Fb.flush=function(Fa){this.repaint&&(this._flushToTarget(Fa,this.target),this.repaint=!1)},Fb.drawTo=function(Fa,Fb,Fc,Fd,Fe){Fa.drawTexture(this.target.getTexture(),Fb,Fc,Fd,Fe,0,0)},Fb.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},Fa}(),Fk=function(){function Fa(){this.ALPHA=1,this.shaderType=0,this.defines=new FEa}return Fo(Fa,"laya.webgl.shader.d2.Shader2D"),Fa.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},Fa.__init__=function(){var Fa,Fb;FYa.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),FYa.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),FYa.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),FYa.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),FYa.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),FYa.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),FYa.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),FYa.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),Fa="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Fb='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',FYa.preCompile2D(0,1,Fa,Fb,null),Fa="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",Fb='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',FYa.preCompile2D(0,2,Fa,Fb,null),Fa="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",Fb="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",FYa.preCompile2D(0,4,Fa,Fb,null),Fa="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Fb='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',FYa.preCompile2D(0,256,Fa,Fb,null),Fa="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",Fb="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",FYa.preCompile2D(0,512,Fa,Fb,null)},Fa}(),Fl=function(){function Fb(Fa,Fb,Fc){this._value=0,this._name2int=Fa,this._int2name=Fb,this._int2nameMap=Fc}Fo(Fb,"laya.webgl.shader.ShaderDefines");var Fa=Fb.prototype;return Fa.add=function(Fa){return"string"==typeof Fa&&(Fa=this._name2int[Fa]),this._value|=Fa,this._value},Fa.addInt=function(Fa){return this._value|=Fa,this._value},Fa.remove=function(Fa){return"string"==typeof Fa&&(Fa=this._name2int[Fa]),this._value&=~Fa,this._value},Fa.isDefine=function(Fa){return(this._value&Fa)===Fa},Fa.getValue=function(){return this._value},Fa.setValue=function(Fa){this._value=Fa},Fa.toNameDic=function(){var Fa=this._int2nameMap[this._value];return Fa||Fb._toText(this._value,this._int2name,this._int2nameMap)},Fb._reg=function(Fa,Fb,Fc,Fd){Fd[Fc[Fa]=Fb]=Fa},Fb._toText=function(Fa,Fb,Fc){var Fd=Fc[Fa];if(Fd)return Fd;for(var Fe={},Ff=1,Fg=0;Fg<32&&!(Fa<(Ff=1<<Fg));Fg++)if(Fa&Ff){var Fh=Fb[Ff];Fh&&(Fe[Fh]="")}return Fc[Fa]=Fe},Fb._toInt=function(Fa,Fb){for(var Fc=Fa.split("."),Fd=0,Fe=0,Ff=Fc.length;Fe<Ff;Fe++){var Fg=Fb[Fc[Fe]];if(!Fg)throw new Error("Defines to int err:"+Fa+"/"+Fc[Fe]);Fd|=Fg}return Fd},Fb}(),Faa=function(){function Fg(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new FB}Fo(Fg,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var Fa=Fg.prototype;return Fa.init=function(Fa,Fb,Fc){if(Fb)this._vs=Fb;else{this._vs=[];var Fd=Fa.width,Fe=Fa.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(Fd,0,1,0,1,1,1,1),this._vs.push(Fd,Fe,1,1,1,1,1,1),this._vs.push(0,Fe,0,1,1,1,1,1)}Fc?this._ps=Fc:(Fg._defaultPS||(Fg._defaultPS=[]).push(0,1,3,3,1,2),this._ps=Fg._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=Fa},Fa.init2=function(Fa,Fb,Fc,Fd,Fe){this.transform&&(this.transform=null),Fc?this._ps=Fc:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=Fd,this._uvs=Fe,this.mEleNum=this._ps.length,this.mTexture=Fa,(Ft.isConchNode||Ft.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},Fa._initMyData=function(){var Fa=0,Fb=0,Fc=4*this._verticles.length;this._vs=Fg._tempVS;var Fd=!1;if(Ft.isConchNode||Ft.isConchApp?(this._vs.length=Fc,Fd=!0):this._vs.length<Fc&&(this._vs.length=Fc,Fd=!0),Fg._tVSLen=Fc,Fd)for(;Fa<Fc;)this._vs[Fa]=this._verticles[Fb],this._vs[Fa+1]=this._verticles[Fb+1],this._vs[Fa+2]=this._uvs[Fb],this._vs[Fa+3]=this._uvs[Fb+1],this._vs[Fa+4]=1,this._vs[Fa+5]=1,this._vs[Fa+6]=1,this._vs[Fa+7]=1,Fa+=8,Fb+=2;else for(;Fa<Fc;)this._vs[Fa]=this._verticles[Fb],this._vs[Fa+1]=this._verticles[Fb+1],this._vs[Fa+2]=this._uvs[Fb],this._vs[Fa+3]=this._uvs[Fb+1],Fa+=8,Fb+=2},Fa.getData2=function(Fa,Fb,Fc){var Fd;this.mVBBuffer=Fa,this.mIBBuffer=Fb,this._initMyData(),Fa.appendEx2(this._vs,Float32Array,Fg._tVSLen,4),this._indexStart=Fb._byteLength,(Fd=Fg._tempIB).length<this._ps.length&&(Fd.length=this._ps.length);for(var Fe=0,Ff=this._ps.length;Fe<Ff;Fe++)Fd[Fe]=this._ps[Fe]+Fc;Fb.appendEx2(Fd,Uint16Array,this._ps.length,2)},Fa.getData=function(Fa,Fb,Fc){if(this.mVBBuffer=Fa,this.mIBBuffer=Fb,Fa.append(this.mVBData),this._indexStart=Fb._byteLength,this.mIBData.start!=Fc){for(var Fd=0,Fe=this._ps.length;Fd<Fe;Fd++)this.mIBData[Fd]=this._ps[Fd]+Fc;this.mIBData.start=Fc}Fb.append(this.mIBData)},Fa.render=function(Fa,Fb,Fc){if(Ft.isWebGL&&this.mTexture){Fa._renderKey=0,Fa._shader2D.glTexture=null,Fba.getInstance().addSkinMesh(this);var Fd=Ffa.createShape(Fa,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,FAa.create(512,0));this.transform||(this.transform=FB.EMPTY),this.transform.translate(Fb,Fc),FB.mul(this.transform,Fa._curMat,this._tempMatrix),this.transform.translate(-Fb,-Fc);var Fe=Fd.shaderValue,Ff=Fe.u_mmat2||Fua.getMatrArray();Fua.mat2MatArray(this._tempMatrix,Ff),Fe.textureHost=this.mTexture,Fe.offsetX=0,Fe.offsetY=0,Fe.u_mmat2=Ff,Fe.ALPHA=Fa._shader2D.ALPHA,Fa._submits[Fa._submits._length++]=Fd}else Ft.isConchApp&&this.mTexture&&(this.transform||(this.transform=FB.EMPTY),Fa.setSkinMesh&&Fa.setSkinMesh(Fb,Fc,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},Fg._tempVS=[],Fg._tempIB=[],Fg._defaultPS=null,Fg._tVSLen=0,Fg}(),Fba=function(){function Fa(){this.ib=null,this.vb=null;Fwa.mainContext;this.ib=Fka.create(35048),this.vb=Fla.create(8)}Fo(Fa,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var Fb=Fa.prototype;return Fb.addSkinMesh=function(Fa){Fa.getData2(this.vb,this.ib,this.vb._byteLength/32)},Fb.reset=function(){this.vb.clear(),this.ib.clear()},Fa.getInstance=function(){return Fa.instance=Fa.instance||new Fa},Fa.instance=null,Fa}(),Fca=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===Fi&&(Fi=0),this.x=Fa,this.y=Fb,this.width=Fc,this.height=Fd,this.edges=Fe,this.color=Ff,this.borderWidth=Fg,this.borderColor=Fh}Fo(Fa,"laya.webgl.shapes.BasePoly");var Fb=Fa.prototype;return Fy.imps(Fb,{"laya.webgl.shapes.IShape":!0}),Fb.getData=function(Fa,Fb,Fc){},Fb.rebuild=function(Fa){},Fb.setMatrix=function(Fa){},Fb.needUpdate=function(Fa){return!0},Fb.sector=function(Fa,Fb,Fc){var Fd=this.x,Fe=this.y,Ff=this.edges,Fg=(this.r1-this.r0)/Ff,Fh=this.width,Fi=this.height,Fj=this.color,Fm=(Fj>>16&255)/255,Fn=(Fj>>8&255)/255,Fo=(255&Fj)/255;Fa.push(Fd,Fe,Fm,Fn,Fo);for(var Fp=0;Fp<Ff+1;Fp++)Fa.push(Fd+Math.sin(Fg*Fp+this.r0)*Fh,Fe+Math.cos(Fg*Fp+this.r0)*Fi),Fa.push(Fm,Fn,Fo);for(Fp=0;Fp<Ff;Fp++)Fb.push(Fc,Fc+Fp+1,Fc+Fp+2)},Fb.createLine2=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg,Fh,Fi,Fj,Fm,Fn,Fo,Fp,Fq,Fr,Fs,Ft,Fu,Fv,Fw,Fx,Fy,Fz,FA,FB,FC=Fa.concat(),FD=Fe,FE=this.borderColor,FF=(FE>>16&255)/255,FG=(FE>>8&255)/255,FH=(255&FE)/255,FI=FC.length/2,FJ=Fd,FK=Fc/2;Fi=FC[0],Fj=FC[1],Fr=Fi-(Fm=FC[2]),Fq=(Fq=-(Fj-(Fn=FC[3])))/(FB=Math.sqrt(Fq*Fq+Fr*Fr))*FK,Fr=Fr/FB*FK,FD.push(Fi-Fq+this.x,Fj-Fr+this.y,FF,FG,FH,Fi+Fq+this.x,Fj+Fr+this.y,FF,FG,FH);for(var FL=1;FL<FI-1;FL++)Fi=FC[2*(FL-1)],Fj=FC[2*(FL-1)+1],Fm=FC[2*FL],Fn=FC[2*FL+1],Fo=FC[2*(FL+1)],Fp=FC[2*(FL+1)+1],Fr=Fi-Fm,Ft=Fm-Fo,Fw=(-(Fq=(Fq=-(Fj-Fn))/(FB=Math.sqrt(Fq*Fq+Fr*Fr))*FK)+Fi)*(-(Fr=Fr/FB*FK)+Fn)-(-Fq+Fm)*(-Fr+Fj),Fz=(-(Fs=(Fs=-(Fn-Fp))/(FB=Math.sqrt(Fs*Fs+Ft*Ft))*FK)+Fo)*(-(Ft=Ft/FB*FK)+Fn)-(-Fs+Fm)*(-Ft+Fp),FA=(Fu=-Fr+Fj-(-Fr+Fn))*(Fy=-Fs+Fm-(-Fs+Fo))-(Fx=-Ft+Fp-(-Ft+Fn))*(Fv=-Fq+Fm-(-Fq+Fi)),Math.abs(FA)<.1?(FA+=10.1,FD.push(Fm-Fq+this.x,Fn-Fr+this.y,FF,FG,FH,Fm+Fq+this.x,Fn+Fr+this.y,FF,FG,FH)):(((Fg=(Fv*Fz-Fy*Fw)/FA)-Fm)*(Fg-Fm)+((Fh=(Fx*Fw-Fu*Fz)/FA)-Fn)+(Fh-Fn),FD.push(Fg+this.x,Fh+this.y,FF,FG,FH,Fm-(Fg-Fm)+this.x,Fn-(Fh-Fn)+this.y,FF,FG,FH));Fi=FC[FC.length-4],Fj=FC[FC.length-3],Fr=Fi-(Fm=FC[FC.length-2]),Fq=(Fq=-(Fj-(Fn=FC[FC.length-1])))/(FB=Math.sqrt(Fq*Fq+Fr*Fr))*FK,Fr=Fr/FB*FK,FD.push(Fm-Fq+this.x,Fn-Fr+this.y,FF,FG,FH,Fm+Fq+this.x,Fn+Fr+this.y,FF,FG,FH);var FM=Ff;for(FL=1;FL<FM;FL++)Fb.push(FJ+2*(FL-1),FJ+2*(FL-1)+1,FJ+2*FL+1,FJ+2*FL+1,FJ+2*FL,FJ+2*(FL-1));return FD},Fb.createLine=function(Fa,Fb,Fc,Fd){var Fe=Fa.concat(),Ff=Fa,Fg=this.borderColor,Fh=(Fg>>16&255)/255,Fi=(Fg>>8&255)/255,Fj=(255&Fg)/255;Fe.splice(0,5);var Fm,Fn,Fo,Fp,Fq,Fr,Fs,Ft,Fu,Fv,Fw,Fx,Fy,Fz,FA,FB,FC,FD,FE,FF,FG=Fe.length/5,FH=Fd,FI=Fc/2;Fo=Fe[0],Fp=Fe[1],Fv=Fo-(Fq=Fe[5]),Fu=(Fu=-(Fp-(Fr=Fe[6])))/(FF=Math.sqrt(Fu*Fu+Fv*Fv))*FI,Fv=Fv/FF*FI,Ff.push(Fo-Fu,Fp-Fv,Fh,Fi,Fj,Fo+Fu,Fp+Fv,Fh,Fi,Fj);for(var FJ=1;FJ<FG-1;FJ++)Fo=Fe[5*(FJ-1)],Fp=Fe[5*(FJ-1)+1],Fq=Fe[5*FJ],Fr=Fe[5*FJ+1],Fs=Fe[5*(FJ+1)],Ft=Fe[5*(FJ+1)+1],Fv=Fo-Fq,Fx=Fq-Fs,FA=(-(Fu=(Fu=-(Fp-Fr))/(FF=Math.sqrt(Fu*Fu+Fv*Fv))*FI)+Fo)*(-(Fv=Fv/FF*FI)+Fr)-(-Fu+Fq)*(-Fv+Fp),FD=(-(Fw=(Fw=-(Fr-Ft))/(FF=Math.sqrt(Fw*Fw+Fx*Fx))*FI)+Fs)*(-(Fx=Fx/FF*FI)+Fr)-(-Fw+Fq)*(-Fx+Ft),FE=(Fy=-Fv+Fp-(-Fv+Fr))*(FC=-Fw+Fq-(-Fw+Fs))-(FB=-Fx+Ft-(-Fx+Fr))*(Fz=-Fu+Fq-(-Fu+Fo)),Math.abs(FE)<.1?(FE+=10.1,Ff.push(Fq-Fu,Fr-Fv,Fh,Fi,Fj,Fq+Fu,Fr+Fv,Fh,Fi,Fj)):(((Fm=(Fz*FD-FC*FA)/FE)-Fq)*(Fm-Fq)+((Fn=(FB*FA-Fy*FD)/FE)-Fr)+(Fn-Fr),Ff.push(Fm,Fn,Fh,Fi,Fj,Fq-(Fm-Fq),Fr-(Fn-Fr),Fh,Fi,Fj));Fo=Fe[Fe.length-10],Fp=Fe[Fe.length-9],Fv=Fo-(Fq=Fe[Fe.length-5]),Fu=(Fu=-(Fp-(Fr=Fe[Fe.length-4])))/(FF=Math.sqrt(Fu*Fu+Fv*Fv))*FI,Fv=Fv/FF*FI,Ff.push(Fq-Fu,Fr-Fv,Fh,Fi,Fj,Fq+Fu,Fr+Fv,Fh,Fi,Fj);var FK=this.edges+1;for(FJ=1;FJ<FK;FJ++)Fb.push(FH+2*(FJ-1),FH+2*(FJ-1)+1,FH+2*FJ+1,FH+2*FJ+1,FH+2*FJ,FH+2*(FJ-1));return Ff},Fb.createLoopLine=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=Fa.concat(),Fh=Fe||Fa,Fi=this.borderColor,Fj=(Fi>>16&255)/255,Fm=(Fi>>8&255)/255,Fn=(255&Fi)/255;Fg.splice(0,5);var Fo=[Fg[0],Fg[1]],Fp=[Fg[Fg.length-5],Fg[Fg.length-4]],Fq=Fp[0]+.5*(Fo[0]-Fp[0]),Fr=Fp[1]+.5*(Fo[1]-Fp[1]);Fg.unshift(Fq,Fr,0,0,0),Fg.push(Fq,Fr,0,0,0);var Fs,Ft,Fu,Fv,Fw,Fx,Fy,Fz,FA,FB,FC,FD,FE,FF,FG,FH,FI,FJ,FK,FL,FM=Fg.length/5,FN=Fd,FO=Fc/2;Fu=Fg[0],Fv=Fg[1],FB=Fu-(Fw=Fg[5]),FA=(FA=-(Fv-(Fx=Fg[6])))/(FL=Math.sqrt(FA*FA+FB*FB))*FO,FB=FB/FL*FO,Fh.push(Fu-FA,Fv-FB,Fj,Fm,Fn,Fu+FA,Fv+FB,Fj,Fm,Fn);for(var FP=1;FP<FM-1;FP++)Fu=Fg[5*(FP-1)],Fv=Fg[5*(FP-1)+1],Fw=Fg[5*FP],Fx=Fg[5*FP+1],Fy=Fg[5*(FP+1)],Fz=Fg[5*(FP+1)+1],FB=Fu-Fw,FD=Fw-Fy,FG=(-(FA=(FA=-(Fv-Fx))/(FL=Math.sqrt(FA*FA+FB*FB))*FO)+Fu)*(-(FB=FB/FL*FO)+Fx)-(-FA+Fw)*(-FB+Fv),FJ=(-(FC=(FC=-(Fx-Fz))/(FL=Math.sqrt(FC*FC+FD*FD))*FO)+Fy)*(-(FD=FD/FL*FO)+Fx)-(-FC+Fw)*(-FD+Fz),FK=(FE=-FB+Fv-(-FB+Fx))*(FI=-FC+Fw-(-FC+Fy))-(FH=-FD+Fz-(-FD+Fx))*(FF=-FA+Fw-(-FA+Fu)),Math.abs(FK)<.1?(FK+=10.1,Fh.push(Fw-FA,Fx-FB,Fj,Fm,Fn,Fw+FA,Fx+FB,Fj,Fm,Fn)):(((Fs=(FF*FJ-FI*FG)/FK)-Fw)*(Fs-Fw)+((Ft=(FH*FG-FE*FJ)/FK)-Fx)+(Ft-Fx),Fh.push(Fs,Ft,Fj,Fm,Fn,Fw-(Fs-Fw),Fx-(Ft-Fx),Fj,Fm,Fn));Ff&&(Fb=Ff);var FQ=this.edges+1;for(FP=1;FP<FQ;FP++)Fb.push(FN+2*(FP-1),FN+2*(FP-1)+1,FN+2*FP+1,FN+2*FP+1,FN+2*FP,FN+2*(FP-1));return Fb.push(FN+2*(FP-1),FN+2*(FP-1)+1,FN+1,FN+1,FN,FN+2*(FP-1)),Fh},Fa}(),Fda=function(){function Fr(){}return Fo(Fr,"laya.webgl.shapes.Earcut"),Fr.earcut=function(Fa,Fb,Fc){Fc=Fc||2;var Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm=Fb&&Fb.length,Fn=Fm?Fb[0]*Fc:Fa.length,Fo=Fr.linkedList(Fa,0,Fn,Fc,!0),Fp=[];if(!Fo)return Fp;if(Fm&&(Fo=Fr.eliminateHoles(Fa,Fb,Fo,Fc)),Fa.length>80*Fc){Fd=Ff=Fa[0],Fe=Fg=Fa[1];for(var Fq=Fc;Fq<Fn;Fq+=Fc)(Fh=Fa[Fq])<Fd&&(Fd=Fh),(Fi=Fa[Fq+1])<Fe&&(Fe=Fi),Ff<Fh&&(Ff=Fh),Fg<Fi&&(Fg=Fi);Fj=0!==(Fj=Math.max(Ff-Fd,Fg-Fe))?1/Fj:0}return Fr.earcutLinked(Fo,Fp,Fc,Fd,Fe,Fj),Fp},Fr.linkedList=function(Fa,Fb,Fc,Fd,Fe){var Ff,Fg;if(Fe===0<Fr.signedArea(Fa,Fb,Fc,Fd))for(Ff=Fb;Ff<Fc;Ff+=Fd)Fg=Fr.insertNode(Ff,Fa[Ff],Fa[Ff+1],Fg);else for(Ff=Fc-Fd;Fb<=Ff;Ff-=Fd)Fg=Fr.insertNode(Ff,Fa[Ff],Fa[Ff+1],Fg);return Fg&&Fr.equals(Fg,Fg.next)&&(Fr.removeNode(Fg),Fg=Fg.next),Fg},Fr.filterPoints=function(Fa,Fb){if(!Fa)return Fa;Fb||(Fb=Fa);var Fc,Fd=Fa;do{if(Fc=!1,Fd.steiner||!Fr.equals(Fd,Fd.next)&&0!==Fr.area(Fd.prev,Fd,Fd.next))Fd=Fd.next;else{if(Fr.removeNode(Fd),(Fd=Fb=Fd.prev)===Fd.next)break;Fc=!0}}while(Fc||Fd!==Fb);return Fb},Fr.earcutLinked=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){if(Fa){!Fg&&Ff&&Fr.indexCurve(Fa,Fd,Fe,Ff);for(var Fh,Fi,Fj=Fa;Fa.prev!==Fa.next;)if(Fh=Fa.prev,Fi=Fa.next,Ff?Fr.isEarHashed(Fa,Fd,Fe,Ff):Fr.isEar(Fa))Fb.push(Fh.i/Fc),Fb.push(Fa.i/Fc),Fb.push(Fi.i/Fc),Fr.removeNode(Fa),Fa=Fi.next,Fj=Fi.next;else if((Fa=Fi)===Fj){Fg?1===Fg?(Fa=Fr.cureLocalIntersections(Fa,Fb,Fc),Fr.earcutLinked(Fa,Fb,Fc,Fd,Fe,Ff,2)):2===Fg&&Fr.splitEarcut(Fa,Fb,Fc,Fd,Fe,Ff):Fr.earcutLinked(Fr.filterPoints(Fa,null),Fb,Fc,Fd,Fe,Ff,1);break}}},Fr.isEar=function(Fa){var Fb=Fa.prev,Fc=Fa,Fd=Fa.next;if(0<=Fr.area(Fb,Fc,Fd))return!1;for(var Fe=Fa.next.next;Fe!==Fa.prev;){if(Fr.pointInTriangle(Fb.x,Fb.y,Fc.x,Fc.y,Fd.x,Fd.y,Fe.x,Fe.y)&&0<=Fr.area(Fe.prev,Fe,Fe.next))return!1;Fe=Fe.next}return!0},Fr.isEarHashed=function(Fa,Fb,Fc,Fd){var Fe=Fa.prev,Ff=Fa,Fg=Fa.next;if(0<=Fr.area(Fe,Ff,Fg))return!1;for(var Fh=Fe.x<Ff.x?Fe.x<Fg.x?Fe.x:Fg.x:Ff.x<Fg.x?Ff.x:Fg.x,Fi=Fe.y<Ff.y?Fe.y<Fg.y?Fe.y:Fg.y:Ff.y<Fg.y?Ff.y:Fg.y,Fj=Fe.x>Ff.x?Fe.x>Fg.x?Fe.x:Fg.x:Ff.x>Fg.x?Ff.x:Fg.x,Fm=Fe.y>Ff.y?Fe.y>Fg.y?Fe.y:Fg.y:Ff.y>Fg.y?Ff.y:Fg.y,Fn=Fr.zOrder(Fh,Fi,Fb,Fc,Fd),Fo=Fr.zOrder(Fj,Fm,Fb,Fc,Fd),Fp=Fa.nextZ;Fp&&Fp.z<=Fo;){if(Fp!==Fa.prev&&Fp!==Fa.next&&Fr.pointInTriangle(Fe.x,Fe.y,Ff.x,Ff.y,Fg.x,Fg.y,Fp.x,Fp.y)&&0<=Fr.area(Fp.prev,Fp,Fp.next))return!1;Fp=Fp.nextZ}for(Fp=Fa.prevZ;Fp&&Fp.z>=Fn;){if(Fp!==Fa.prev&&Fp!==Fa.next&&Fr.pointInTriangle(Fe.x,Fe.y,Ff.x,Ff.y,Fg.x,Fg.y,Fp.x,Fp.y)&&0<=Fr.area(Fp.prev,Fp,Fp.next))return!1;Fp=Fp.prevZ}return!0},Fr.cureLocalIntersections=function(Fa,Fb,Fc){var Fd=Fa;do{var Fe=Fd.prev,Ff=Fd.next.next;!Fr.equals(Fe,Ff)&&Fr.intersects(Fe,Fd,Fd.next,Ff)&&Fr.locallyInside(Fe,Ff)&&Fr.locallyInside(Ff,Fe)&&(Fb.push(Fe.i/Fc),Fb.push(Fd.i/Fc),Fb.push(Ff.i/Fc),Fr.removeNode(Fd),Fr.removeNode(Fd.next),Fd=Fa=Ff),Fd=Fd.next}while(Fd!==Fa);return Fd},Fr.splitEarcut=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=Fa;do{for(var Fh=Fg.next.next;Fh!==Fg.prev;){if(Fg.i!==Fh.i&&Fr.isValidDiagonal(Fg,Fh)){var Fi=Fr.splitPolygon(Fg,Fh);return Fg=Fr.filterPoints(Fg,Fg.next),Fi=Fr.filterPoints(Fi,Fi.next),Fr.earcutLinked(Fg,Fb,Fc,Fd,Fe,Ff),void Fr.earcutLinked(Fi,Fb,Fc,Fd,Fe,Ff)}Fh=Fh.next}Fg=Fg.next}while(Fg!==Fa)},Fr.eliminateHoles=function(Fa,Fb,Fc,Fd){var Fe,Ff,Fg,Fh,Fi,Fj=[];for(Fe=0,Ff=Fb.length;Fe<Ff;Fe++)Fg=Fb[Fe]*Fd,Fh=Fe<Ff-1?Fb[Fe+1]*Fd:Fa.length,(Fi=Fr.linkedList(Fa,Fg,Fh,Fd,!1))===Fi.next&&(Fi.steiner=!0),Fj.push(Fr.getLeftmost(Fi));for(Fj.sort(Fr.compareX),Fe=0;Fe<Fj.length;Fe++)Fr.eliminateHole(Fj[Fe],Fc),Fc=Fr.filterPoints(Fc,Fc.next);return Fc},Fr.compareX=function(Fa,Fb){return Fa.x-Fb.x},Fr.eliminateHole=function(Fa,Fb){if(Fb=Fr.findHoleBridge(Fa,Fb)){var Fc=Fr.splitPolygon(Fb,Fa);Fr.filterPoints(Fc,Fc.next)}},Fr.findHoleBridge=function(Fa,Fb){var Fc,Fd=Fb,Fe=Fa.x,Ff=Fa.y,Fg=-1/0;do{if(Ff<=Fd.y&&Ff>=Fd.next.y&&Fd.next.y!==Fd.y){var Fh=Fd.x+(Ff-Fd.y)*(Fd.next.x-Fd.x)/(Fd.next.y-Fd.y);if(Fh<=Fe&&Fg<Fh){if((Fg=Fh)===Fe){if(Ff===Fd.y)return Fd;if(Ff===Fd.next.y)return Fd.next}Fc=Fd.x<Fd.next.x?Fd:Fd.next}}Fd=Fd.next}while(Fd!==Fb);if(!Fc)return null;if(Fe===Fg)return Fc.prev;var Fi,Fj=Fc,Fm=Fc.x,Fn=Fc.y,Fo=1/0;for(Fd=Fc.next;Fd!==Fj;)Fe>=Fd.x&&Fd.x>=Fm&&Fe!==Fd.x&&Fr.pointInTriangle(Ff<Fn?Fe:Fg,Ff,Fm,Fn,Ff<Fn?Fg:Fe,Ff,Fd.x,Fd.y)&&((Fi=Math.abs(Ff-Fd.y)/(Fe-Fd.x))<Fo||Fi===Fo&&Fd.x>Fc.x)&&Fr.locallyInside(Fd,Fa)&&(Fc=Fd,Fo=Fi),Fd=Fd.next;return Fc},Fr.indexCurve=function(Fa,Fb,Fc,Fd){for(var Fe=Fa;null===Fe.z&&(Fe.z=Fr.zOrder(Fe.x,Fe.y,Fb,Fc,Fd)),Fe.prevZ=Fe.prev,Fe.nextZ=Fe.next,(Fe=Fe.next)!==Fa;);Fe.prevZ.nextZ=null,Fe.prevZ=null,Fr.sortLinked(Fe)},Fr.sortLinked=function(Fa){var Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj=1;do{for(Fc=Fa,Ff=Fa=null,Fg=0;Fc;){for(Fg++,Fd=Fc,Fb=Fh=0;Fb<Fj&&(Fh++,Fd=Fd.nextZ);Fb++);for(Fi=Fj;0<Fh||0<Fi&&Fd;)0!==Fh&&(0===Fi||!Fd||Fc.z<=Fd.z)?(Fc=(Fe=Fc).nextZ,Fh--):(Fd=(Fe=Fd).nextZ,Fi--),Ff?Ff.nextZ=Fe:Fa=Fe,Fe.prevZ=Ff,Ff=Fe;Fc=Fd}Ff.nextZ=null,Fj*=2}while(1<Fg);return Fa},Fr.zOrder=function(Fa,Fb,Fc,Fd,Fe){return(Fa=1431655765&((Fa=858993459&((Fa=252645135&((Fa=16711935&((Fa=32767*(Fa-Fc)*Fe)|Fa<<8))|Fa<<4))|Fa<<2))|Fa<<1))|(Fb=1431655765&((Fb=858993459&((Fb=252645135&((Fb=16711935&((Fb=32767*(Fb-Fd)*Fe)|Fb<<8))|Fb<<4))|Fb<<2))|Fb<<1))<<1},Fr.getLeftmost=function(Fa){for(var Fb=Fa,Fc=Fa;Fb.x<Fc.x&&(Fc=Fb),(Fb=Fb.next)!==Fa;);return Fc},Fr.pointInTriangle=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){return 0<=(Fe-Fg)*(Fb-Fh)-(Fa-Fg)*(Ff-Fh)&&0<=(Fa-Fg)*(Fd-Fh)-(Fc-Fg)*(Fb-Fh)&&0<=(Fc-Fg)*(Ff-Fh)-(Fe-Fg)*(Fd-Fh)},Fr.isValidDiagonal=function(Fa,Fb){return Fa.next.i!==Fb.i&&Fa.prev.i!==Fb.i&&!Fr.intersectsPolygon(Fa,Fb)&&Fr.locallyInside(Fa,Fb)&&Fr.locallyInside(Fb,Fa)&&Fr.middleInside(Fa,Fb)},Fr.area=function(Fa,Fb,Fc){return(Fb.y-Fa.y)*(Fc.x-Fb.x)-(Fb.x-Fa.x)*(Fc.y-Fb.y)},Fr.equals=function(Fa,Fb){return Fa.x===Fb.x&&Fa.y===Fb.y},Fr.intersects=function(Fa,Fb,Fc,Fd){return!!(Fr.equals(Fa,Fb)&&Fr.equals(Fc,Fd)||Fr.equals(Fa,Fd)&&Fr.equals(Fc,Fb))||0<Fr.area(Fa,Fb,Fc)!=0<Fr.area(Fa,Fb,Fd)&&0<Fr.area(Fc,Fd,Fa)!=0<Fr.area(Fc,Fd,Fb)},Fr.intersectsPolygon=function(Fa,Fb){var Fc=Fa;do{if(Fc.i!==Fa.i&&Fc.next.i!==Fa.i&&Fc.i!==Fb.i&&Fc.next.i!==Fb.i&&Fr.intersects(Fc,Fc.next,Fa,Fb))return!0;Fc=Fc.next}while(Fc!==Fa);return!1},Fr.locallyInside=function(Fa,Fb){return Fr.area(Fa.prev,Fa,Fa.next)<0?0<=Fr.area(Fa,Fb,Fa.next)&&0<=Fr.area(Fa,Fa.prev,Fb):Fr.area(Fa,Fb,Fa.prev)<0||Fr.area(Fa,Fa.next,Fb)<0},Fr.middleInside=function(Fa,Fb){for(var Fc=Fa,Fd=!1,Fe=(Fa.x+Fb.x)/2,Ff=(Fa.y+Fb.y)/2;Fc.y>Ff!=Fc.next.y>Ff&&Fc.next.y!==Fc.y&&Fe<(Fc.next.x-Fc.x)*(Ff-Fc.y)/(Fc.next.y-Fc.y)+Fc.x&&(Fd=!Fd),(Fc=Fc.next)!==Fa;);return Fd},Fr.splitPolygon=function(Fa,Fb){var Fc=new Fea(Fa.i,Fa.x,Fa.y),Fd=new Fea(Fb.i,Fb.x,Fb.y),Fe=Fa.next,Ff=Fb.prev;return(Fa.next=Fb).prev=Fa,(Fc.next=Fe).prev=Fc,(Fd.next=Fc).prev=Fd,(Ff.next=Fd).prev=Ff,Fd},Fr.insertNode=function(Fa,Fb,Fc,Fd){var Fe=new Fea(Fa,Fb,Fc);return Fd?(Fe.next=Fd.next,(Fe.prev=Fd).next.prev=Fe,Fd.next=Fe):(Fe.prev=Fe).next=Fe,Fe},Fr.removeNode=function(Fa){Fa.next.prev=Fa.prev,Fa.prev.next=Fa.next,Fa.prevZ&&(Fa.prevZ.nextZ=Fa.nextZ),Fa.nextZ&&(Fa.nextZ.prevZ=Fa.prevZ)},Fr.signedArea=function(Fa,Fb,Fc,Fd){for(var Fe=0,Ff=Fb,Fg=Fc-Fd;Ff<Fc;Ff+=Fd)Fe+=(Fa[Fg]-Fa[Ff])*(Fa[Ff+1]+Fa[Fg+1]),Fg=Ff;return Fe},Fr}(),Fea=function(){function Fa(Fa,Fb,Fc){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=Fa,this.x=Fb,this.y=Fc,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Fo(Fa,"laya.webgl.shapes.EarcutNode"),Fa}(),Ffa=(function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this.lineWidth=Fa,this.lineColor=Fb,this.lineAlpha=Fc,this.fillColor=Fd,this.fillAlpha=Fe,this.shape=Fg,this.fill=Ff}Fo(Fa,"laya.webgl.shapes.GeometryData");var Fb=Fa.prototype;Fb.clone=function(){return new Fa(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},Fb.getIndexData=function(){return null},Fb.getVertexData=function(){return null},Fb.destroy=function(){this.shape=null}}(),function(){function Fa(Fa){if(Fa instanceof Float32Array)this.points=Fa;else if(Fa instanceof Array){Fa.length;this.points=new Float32Array(Fa)}}Fo(Fa,"laya.webgl.shapes.Vertex");var Fb=Fa.prototype;Fy.imps(Fb,{"laya.webgl.shapes.IShape":!0}),Fb.getData=function(Fa,Fb,Fc){},Fb.needUpdate=function(Fa){return!1},Fb.rebuild=function(Fa){},Fb.setMatrix=function(Fa){}}(),function(){function Fi(Fa){void 0===Fa&&(Fa=1e4),this._renderType=Fa}Fo(Fi,"laya.webgl.submit.Submit");var Fa=Fi.prototype;return Fy.imps(Fa,{"laya.webgl.submit.ISubmit":!0}),Fa.releaseRender=function(){var Fa=Fi._cache;(Fa[Fa._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Fa.getRenderType=function(){return this._renderType},Fa.renderSubmit=function(){if(0===this._numEle)return 1;var Fa=this.shaderValue.textureHost;if(Fa){var Fb=Fa.source;if(!Fa.bitmap||!Fb)return 1;this.shaderValue.texture=Fb,Fa.alphaTexture&&Fa.alphaTexture.source&&(this.shaderValue.texture1=Fa.alphaTexture.source)}this._vb.bind_upload(this._ib);var Fc=Fwa.mainContext;return this.shaderValue.upload(),FS.activeBlendFunction!==this._blendFn&&(Fc.enable(3042),this._blendFn(Fc),FS.activeBlendFunction=this._blendFn),FG.drawCall++,FG.trianglesFaces+=this._numEle/3,Fc.drawElements(4,this._numEle,5123,this._startIdx),1},Fi.__init__=function(){var Fa=Fi.RENDERBASE=new Fi(-1);Fa.shaderValue=new FAa(0,0),Fa.shaderValue.ALPHA=-1234},Fi.createSubmit=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fi._cache._length?Fi._cache[--Fi._cache._length]:new Fi;null==Fc&&((Fc=Ff._selfVb||(Ff._selfVb=Fla.create(-1))).clear(),Fd=0),Ff._ib=Fb,Ff._vb=Fc,Ff._startIdx=Fd*Fra.BYTES_PIDX,Ff._numEle=0;var Fg=Fa._nBlendType;Ff._blendFn=Fa._targets?FS.targetFns[Fg]:FS.fns[Fg],Ff.shaderValue=Fe,Ff.shaderValue.setValue(Fa._shader2D);var Fh=Fa._shader2D.filters;return Fh&&Ff.shaderValue.setFilters(Fh),Ff},Fi.createShape=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=Fi._cache._length?Fi._cache[--Fi._cache._length]:new Fi;Fg._ib=Fb,Fg._vb=Fc,Fg._numEle=Fd,Fg._startIdx=Fe,Fg.shaderValue=Ff,Fg.shaderValue.setValue(Fa._shader2D);var Fh=Fa._nBlendType;return Fg._blendFn=Fa._targets?FS.targetFns[Fh]:FS.fns[Fh],Fg},Fi.TYPE_2D=1e4,Fi.TYPE_CANVAS=10003,Fi.TYPE_CMDSETRT=10004,Fi.TYPE_CUSTOM=10005,Fi.TYPE_BLURRT=10006,Fi.TYPE_CMDDESTORYPRERT=10007,Fi.TYPE_DISABLESTENCIL=10008,Fi.TYPE_OTHERIBVB=10009,Fi.TYPE_PRIMITIVE=10010,Fi.TYPE_RT=10011,Fi.TYPE_BLUR_RT=10012,Fi.TYPE_TARGET=10013,Fi.TYPE_CHANGE_VALUE=10014,Fi.TYPE_SHAPE=10015,Fi.TYPE_TEXTURE=10016,Fi.TYPE_FILLTEXTURE=10017,Fi.RENDERBASE=null,Fi._cache=((Fi._cache=[])._length=0,Fi._cache),Fi}()),Fga=function(){function Fd(){this.fun=null,this.args=null}Fo(Fd,"laya.webgl.submit.SubmitCMD");var Fa=Fd.prototype;return Fy.imps(Fa,{"laya.webgl.submit.ISubmit":!0}),Fa.renderSubmit=function(){return this.fun.apply(null,this.args),1},Fa.getRenderType=function(){return 0},Fa.releaseRender=function(){var Fa=Fd._cache;Fa[Fa._length++]=this},Fd.create=function(Fa,Fb){var Fc=Fd._cache._length?Fd._cache[--Fd._cache._length]:new Fd;return Fc.fun=Fb,Fc.args=Fa,Fc},Fd._cache=((Fd._cache=[])._length=0,Fd._cache),Fd}(),Fha=function(){function Fb(){this.variables={}}Fo(Fb,"laya.webgl.submit.SubmitCMDScope");var Fa=Fb.prototype;return Fa.getValue=function(Fa){return this.variables[Fa]},Fa.addValue=function(Fa,Fb){return this.variables[Fa]=Fb},Fa.setValue=function(Fa,Fb){return this.variables.hasOwnProperty(Fa)?this.variables[Fa]=Fb:null},Fa.clear=function(){for(var Fa in this.variables)delete this.variables[Fa]},Fa.recycle=function(){this.clear(),Fb.POOL.push(this)},Fb.create=function(){var Fa=Fb.POOL.pop();return Fa||(Fa=new Fb),Fa},Fb.POOL=[],Fb}(),Fia=function(){function Fn(){this.offset=0,this.startIndex=0,this._mat=FB.create()}Fo(Fn,"laya.webgl.submit.SubmitOtherIBVB");var Fa=Fn.prototype;return Fy.imps(Fa,{"laya.webgl.submit.ISubmit":!0}),Fa.releaseRender=function(){var Fa=Fn._cache;(Fa[Fa._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Fa.getRenderType=function(){return 10009},Fa.renderSubmit=function(){var Fa=this._shaderValue.textureHost;if(Fa){var Fb=Fa.source;if(!Fa.bitmap||!Fb)return 1;this._shaderValue.texture=Fb}this._vb.bind_upload(this._ib);var Fc=Fua.worldMatrix4,Fd=FB.TEMP;FB.mulPre(this._mat,Fc[0],Fc[1],Fc[4],Fc[5],Fc[12],Fc[13],Fd);var Fe=Fua.worldMatrix4=Fn.tempMatrix4;Fe[0]=Fd.a,Fe[1]=Fd.b,Fe[4]=Fd.c,Fe[5]=Fd.d,Fe[12]=Fd.tx,Fe[13]=Fd.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var Ff=Fwa.mainContext;return FS.activeBlendFunction!==this._blendFn&&(Ff.enable(3042),this._blendFn(Ff),FS.activeBlendFunction=this._blendFn),FG.drawCall++,FG.trianglesFaces+=this._numEle/3,Ff.drawElements(4,this._numEle,5123,this.startIndex),Fua.worldMatrix4=Fc,FLa.activeShader=null,1},Fn.create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){void 0===Fi&&(Fi=0);var Fj=Fn._cache._length?Fn._cache[--Fn._cache._length]:new Fn;Fj._ib=Fc,Fj._vb=Fb,Fj._numEle=Fd,Fj._shader=Fe,Fj._shaderValue=Ff;var Fm=Fa._nBlendType;switch(Fj._blendFn=Fa._targets?FS.targetFns[Fm]:FS.fns[Fm],Fi){case 0:Fj.offset=0,Fj.startIndex=Fh/(Fra.BYTES_PE*Fb.vertexStride)*1.5,Fj.startIndex*=Fra.BYTES_PIDX;break;case 1:Fj.startIndex=Fg,Fj.offset=Fh}return Fj},Fn._cache=((Fn._cache=[])._length=0,Fn._cache),Fn.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fn}(),Fja=function(){function Fc(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new FD,this.screenRect=new FD}Fo(Fc,"laya.webgl.submit.SubmitScissor");var Fa=Fc.prototype;return Fy.imps(Fa,{"laya.webgl.submit.ISubmit":!0}),Fa._scissor=function(Fa,Fb,Fc,Fd){var Fe=Fua.worldMatrix4,Ff=Fe[0],Fg=Fe[5],Fh=Fe[12],Fi=Fe[13];if(Fd*=Fg,(Fc*=Ff)<1||Fd<1)return!1;var Fj=(Fa=Fa*Ff+Fh)+Fc,Fm=(Fb=Fb*Fg+Fi)+Fd;Fa<0&&(Fc=Fj-(Fa=0)),Fb<0&&(Fd=Fm-(Fb=0));var Fn=Fua.worldClipRect;if(Fa=Math.max(Fa,Fn.x),Fb=Math.max(Fb,Fn.y),Fc=Math.min(Fj,Fn.right)-Fa,Fd=Math.min(Fm,Fn.bottom)-Fb,Fc<1||Fd<1)return!1;var Fo=Fua.worldScissorTest;return this.screenRect.copyFrom(Fn),Fn.x=Fa,Fn.y=Fb,Fn.width=Fc,Fn.height=Fd,Fua.worldScissorTest=!0,Fb=Fua.height-Fb-Fd,Fwa.mainContext.scissor(Fa,Fb,Fc,Fd),Fwa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Fo?(Fb=Fua.height-this.screenRect.y-this.screenRect.height,Fwa.mainContext.scissor(this.screenRect.x,Fb,this.screenRect.width,this.screenRect.height),Fwa.mainContext.enable(3089)):(Fwa.mainContext.disable(3089),Fua.worldScissorTest=!1),Fn.copyFrom(this.screenRect),!0},Fa._scissorWithTagart=function(Fa,Fb,Fc,Fd){if(Fc<1||Fd<1)return!1;var Fe=Fa+Fc,Ff=Fb+Fd;Fa<0&&(Fc=Fe-(Fa=0)),Fb<0&&(Fd=Ff-(Fb=0));var Fg=Fua.worldClipRect;if(Fa=Math.max(Fa,Fg.x),Fb=Math.max(Fb,Fg.y),Fc=Math.min(Fe,Fg.right)-Fa,Fd=Math.min(Ff,Fg.bottom)-Fb,Fc<1||Fd<1)return!1;var Fh=Fua.worldScissorTest;return this.screenRect.copyFrom(Fg),Fua.worldScissorTest=!0,Fg.x=Fa,Fg.y=Fb,Fg.width=Fc,Fg.height=Fd,Fb=Fua.height-Fb-Fd,Fwa.mainContext.scissor(Fa,Fb,Fc,Fd),Fwa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Fh?(Fb=Fua.height-this.screenRect.y-this.screenRect.height,Fwa.mainContext.scissor(this.screenRect.x,Fb,this.screenRect.width,this.screenRect.height),Fwa.mainContext.enable(3089)):(Fwa.mainContext.disable(3089),Fua.worldScissorTest=!1),Fg.copyFrom(this.screenRect),!0},Fa.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},Fa.getRenderType=function(){return 0},Fa.releaseRender=function(){var Fa=Fc._cache;(Fa[Fa._length++]=this).context=null},Fc.create=function(Fa){var Fb=Fc._cache._length?Fc._cache[--Fc._cache._length]:new Fc;return Fb.context=Fa,Fb},Fc._cache=((Fc._cache=[])._length=0,Fc._cache),Fc}(),Fma=function(){function Fi(){this.step=0,this.blendMode=null,this.level=0}Fo(Fi,"laya.webgl.submit.SubmitStencil");var Fa=Fi.prototype;return Fy.imps(Fa,{"laya.webgl.submit.ISubmit":!0}),Fa.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},Fa.getRenderType=function(){return 0},Fa.releaseRender=function(){var Fa=Fi._cache;Fa[Fa._length++]=this},Fa.do1=function(){var Fa=Fwa.mainContext;Fa.enable(2960),Fa.clear(1024),Fa.colorMask(!1,!1,!1,!1),Fa.stencilFunc(514,this.level,255),Fa.stencilOp(7680,7680,7682)},Fa.do2=function(){var Fa=Fwa.mainContext;Fa.stencilFunc(514,this.level+1,255),Fa.colorMask(!0,!0,!0,!0),Fa.stencilOp(7680,7680,7680)},Fa.do3=function(){var Fa=Fwa.mainContext;Fa.colorMask(!0,!0,!0,!0),Fa.stencilOp(7680,7680,7680),Fa.clear(1024),Fa.disable(2960)},Fa.do4=function(){var Fa=Fwa.mainContext;0==this.level&&(Fa.enable(2960),Fa.clear(1024)),Fa.colorMask(!1,!1,!1,!1),Fa.stencilFunc(519,0,255),Fa.stencilOp(7680,7680,7682)},Fa.do5=function(){var Fa=Fwa.mainContext;Fa.stencilFunc(514,this.level,255),Fa.colorMask(!0,!0,!0,!0),Fa.stencilOp(7680,7680,7680)},Fa.do6=function(){var Fa=Fwa.mainContext;FS.targetFns[FS.TOINT[this.blendMode]](Fa)},Fa.do7=function(){var Fa=Fwa.mainContext;Fa.colorMask(!1,!1,!1,!1),Fa.stencilOp(7680,7680,7683)},Fa.do8=function(){var Fa=Fwa.mainContext;Fa.colorMask(!0,!0,!0,!0),Fa.stencilFunc(514,this.level,255),Fa.stencilOp(7680,7680,7680)},Fi.restore=function(Fa,Fb,Fc,Fd,Fe){var Ff;if((Fa._renderKey=0)<Fi._mask&&Fi._mask--,0==Fi._mask)Ff=laya.webgl.submit.SubmitStencil.create(3),Fa.addRenderObject(Ff),Fa._curSubmit=Ffa.RENDERBASE;else{Ff=laya.webgl.submit.SubmitStencil.create(7),Fa.addRenderObject(Ff);var Fg=Fa._vb;Fg._byteLength;if(Fsa.fillRectImgVb(Fg,null,Fb.x,Fb.y,Fb.width,Fb.height,FK.DEF_UV,Fc,Fd,Fe,0,0)){Fa._shader2D.glTexture=null;var Fh=Fa._curSubmit=Ffa.createSubmit(Fa,Fa._ib,Fg,(Fg._byteLength-64)/32*3,FAa.create(2,0));Fh.shaderValue.ALPHA=1,Fa._submits[Fa._submits._length++]=Fh,Fa._curSubmit._numEle+=6,Fa._curSubmit=Ffa.RENDERBASE}else alert("clipRect calc stencil rect error");Ff=laya.webgl.submit.SubmitStencil.create(8),Fa.addRenderObject(Ff)}},Fi.restore2=function(Fa,Fb){var Fc;(Fa._renderKey=0)<Fi._mask&&Fi._mask--,0==Fi._mask?(Fc=laya.webgl.submit.SubmitStencil.create(3),Fa.addRenderObject(Fc),Fa._curSubmit=Ffa.RENDERBASE):(Fc=laya.webgl.submit.SubmitStencil.create(7),Fa.addRenderObject(Fc),Fa._submits[Fa._submits._length++]=Fb,Fc=laya.webgl.submit.SubmitStencil.create(8),Fa.addRenderObject(Fc))},Fi.create=function(Fa){var Fb=Fi._cache._length?Fi._cache[--Fi._cache._length]:new Fi;return 5==(Fb.step=Fa)&&++Fi._mask,Fb.level=Fi._mask,Fb},Fi._cache=((Fi._cache=[])._length=0,Fi._cache),Fi._mask=0,Fi}(),Fna=function(){function Fh(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}Fo(Fh,"laya.webgl.submit.SubmitTarget");var Fa=Fh.prototype;return Fy.imps(Fa,{"laya.webgl.submit.ISubmit":!0}),Fa.renderSubmit=function(){this._vb.bind_upload(this._ib);var Fa=this.scope.getValue(this.proName);return Fa&&(this.shaderValue.texture=Fa.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[Fa.width,Fa.height]),this.shaderValue.upload(),this.blend(),FG.drawCall++,FG.trianglesFaces+=this._numEle/3,Fwa.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},Fa.blend=function(){if(FS.activeBlendFunction!==FS.fns[this.blendType]){var Fa=Fwa.mainContext;Fa.enable(3042),FS.fns[this.blendType](Fa),FS.activeBlendFunction=FS.fns[this.blendType]}},Fa.getRenderType=function(){return 0},Fa.releaseRender=function(){var Fa=Fh._cache;(Fa[Fa._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Fh.create=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=Fh._cache._length?Fh._cache[--Fh._cache._length]:new Fh;return Fg._ib=Fb,Fg._vb=Fc,Fg.proName=Ff,Fg._startIdx=Fd*Fra.BYTES_PIDX,Fg._numEle=0,Fg.blendType=Fa._nBlendType,Fg.shaderValue=Fe,Fg.shaderValue.setValue(Fa._shader2D),Fg},Fh._cache=((Fh._cache=[])._length=0,Fh._cache),Fh}(),Foa=function(){function Fa(){this._sourceStr=null}Fo(Fa,"laya.webgl.text.CharSegment");var Fb=Fa.prototype;return Fy.imps(Fb,{"laya.webgl.text.ICharSegment":!0}),Fb.textToSpit=function(Fa){this._sourceStr=Fa},Fb.getChar=function(Fa){return this._sourceStr.charAt(Fa)},Fb.getCharCode=function(Fa){return this._sourceStr.charCodeAt(Fa)},Fb.length=function(){return this._sourceStr.length},Fa}(),Fpa=function(){var Fa;function FG(){}return Fo(FG,"laya.webgl.text.DrawText"),FG.__init__=function(){FG._charsTemp=new Array,FG._drawValue=new Fa,FG._charSeg=new Foa},FG.customCharSeg=function(Fa){FG._charSeg=Fa},FG.getChar=function(Fa,Fb,Fc){var Fd=FVa.createOneChar(Fa,Fc);return-1!=Fb&&(FG._charsCache[Fb]=Fd),Fd},FG._drawSlow=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn,Fo,Fp,Fq){var Fr,Fs,Ft=FG._drawValue.value(Ff,Fh,Fi,Fj,Fo,Fp,Fq),Fu=0,Fv=0,Fw=FG._charsTemp,Fx=0,Fy=NaN;if(Fd)for(Fw.length=Fd.length,Fu=0,Fv=Fd.length;Fu<Fv;Fu++)(Fs=Fd[Fu])&&(Fy=Fs.charNum+Ft.txtID,Fw[Fu]=Fr=FG._charsCache[Fy]||FG.getChar(Fs.char,Fy,Ft),Fr.active());else{var Fz=Fc instanceof laya.utils.WordText?Fc.toString():Fc;if(FJ.CharacterCache){FG._charSeg.textToSpit(Fz);var FA=FG._charSeg.length();for(Fu=0,Fv=Fw.length=FA;Fu<Fv;Fu++)Fy=FG._charSeg.getCharCode(Fu)+Ft.txtID,Fw[Fu]=Fr=FG._charsCache[Fy]||FG.getChar(FG._charSeg.getChar(Fu),Fy,Ft),Fr.active(),Fx+=Fr.cw}else Fw.length=0,(Fr=FG.getChar(Fz,-1,Ft)).active(),Fx+=Fr.cw,Fw[0]=Fr}var FB=0;null!==Fg&&"left"!==Fg&&(FB=-("center"==Fg?Fx/2:Fx));var FC,FD,FE=NaN,FF=0;if(Fd)for(Fu=0,Fv=Fw.length;Fu<Fv;Fu++)Fr=Fw[Fu],Fs=Fd[Fu],Fr&&Fs&&!Fr.isSpace&&(FE=Fr.borderSize,FC=Fr.texture,Fb._drawText(FC,Fm+FB+Fs.x*Fo-FE,Fn+Fs.y*Fp-FE,FC.width,FC.height,Fe,0,0,0,0));else{for(Fu=0,Fv=Fw.length;Fu<Fv;Fu++)(Fr=Fw[Fu])&&!Fr.isSpace&&(FE=Fr.borderSize,FC=Fr.texture,Fb._drawText(FC,Fm+FB-FE,Fn-FE,FC.width,FC.height,Fe,0,0,0,0),Fa&&((FD=Fa[FF++])||(FD=Fa[FF-1]=[]),FD[0]=FC,FD[1]=FB-FE,FD[2]=-FE)),FB+=Fr.cw;Fa&&(Fa.length=FF)}},FG._drawFast=function(Fa,Fb,Fc,Fd,Fe){for(var Ff,Fg,Fh=0,Fi=Fa.length;Fh<Fi;Fh++)(Ff=(Fg=Fa[Fh])[0]).active(),Fb._drawText(Ff,Fd+Fg[1],Fe+Fg[2],Ff.width,Ff.height,Fc,0,0,0,0)},FG.drawText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn){if(void 0===Fn&&(Fn=0),!(Fb&&0===Fb.length||Fc&&0===Fc.length)){var Fo=Fd.a,Fp=Fd.d;(0!==Fd.b||0!==Fd.c)&&(Fo=Fp=1);var Fq=1!==Fo||1!==Fp;if(Fq&&Fy.stage.transform){var Fr=Fy.stage.transform;Fq=Fr.a===Fo&&Fr.d===Fp}else Fq=!1;if(Fq){var Fs=(Fd=Fd.copyTo(Fza._tmpMatrix)).tx,Ft=Fd.ty;Fd.scale(1/Fo,1/Fp),Fd._checkTransform(),Fj*=Fo,Fm*=Fp,Fj+=Fs-Fd.tx,Fm+=Ft-Fd.ty}else Fo=Fp=1;if(Fc)FG._drawSlow(null,Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fo,Fp,Fn);else{if(null===Fb.toUpperCase){var Fu=Fo+1e5*Fp,Fv=Fb;return void(Fv.changed||Fv.id!==Fu?(Fv.id=Fu,Fv.changed=!1,FG._drawSlow(Fv.save,Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fo,Fp,Fn)):FG._drawFast(Fv.save,Fa,Fd,Fj,Fm))}var Fw=Fb+Fe.toString()+Fg+Fh+Fi+Fo+Fp+Ff,Fx=FG._textsCache[Fw];FJ.CharacterCache?Fx?FG._drawFast(Fx,Fa,Fd,Fj,Fm):(FG._textsCache.__length||(FG._textsCache.__length=0),FG._textsCache.__length>Fz.WebGLTextCacheCount&&((FG._textsCache={}).__length=0,FG._curPoolIndex=0),FG._textCachesPool[FG._curPoolIndex]?(Fx=FG._textsCache[Fw]=FG._textCachesPool[FG._curPoolIndex]).length=0:FG._textCachesPool[FG._curPoolIndex]=Fx=FG._textsCache[Fw]=[],FG._textsCache.__length++,FG._curPoolIndex++,FG._drawSlow(Fx,Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fo,Fp,Fn)):FG._drawSlow(Fx,Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fo,Fp,Fn)}}},FG._charsTemp=null,FG._textCachesPool=[],FG._curPoolIndex=0,FG._charsCache={},FG._textsCache={},FG._drawValue=null,FG.d=[],FG._charSeg=null,FG.__init$=function(){Fa=function(){function Fi(){}return Fo(Fi,""),Fi.prototype.value=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this.font=Fa,this.fillColor=Fb,this.borderColor=Fc,this.lineWidth=Fd,this.scaleX=Fe,this.scaleY=Ff,this.underLine=Fg;var Fh=Fa.toString()+Fe+Ff+Fd+(Fb?Fb.toLowerCase():" ")+(Fc?Fc.toLowerCase():" ")+Fg;return this.txtID=Fi._keymap[Fh],this.txtID||(this.txtID=1e-7*++Fi._keymapCount,Fi._keymap[Fh]=this.txtID),this},Fi.clear=function(){Fi._keymap={},Fi._keymapCount=1},Fi._keymap={},Fi._keymapCount=1,Fi}()},FG}(),Fqa=function(){function Fe(Fa){this._index=0,this._size=14,this._italic=-2,Fe._cache2=Fe._cache2||[],this.setFont(Fa||"14px Arial")}Fo(Fe,"laya.webgl.text.FontInContext");var Fa=Fe.prototype;return Fa.setFont=function(Fa){var Fb=Fe._cache2[Fa];if(Fb)this._words=Fb[0],this._size=Fb[1];else{this._words=Fa.split(" ");for(var Fc=0,Fd=this._words.length;Fc<Fd;Fc++)if(0<this._words[Fc].indexOf("px")){this._index=Fc;break}this._size=parseInt(this._words[this._index]),Fe._cache2[Fa]=[this._words,this._size]}this._text=null,this._italic=-2},Fa.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},Fa.hasType=function(Fa){for(var Fb=0,Fc=this._words.length;Fb<Fc;Fb++)if(this._words[Fb]===Fa)return Fb;return-1},Fa.removeType=function(Fa){for(var Fb=0,Fc=this._words.length;Fb<Fc;Fb++)if(this._words[Fb]===Fa){this._words.splice(Fb,1),this._index>Fb&&this._index--;break}this._text=null,this._italic=-2},Fa.copyTo=function(Fa){return Fa._text=this._text,Fa._size=this._size,Fa._index=this._index,Fa._words=this._words.slice(),Fa._italic=-2,Fa},Fa.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},Fd(0,Fa,"size",function(){return this._size},function(Fa){this._size=Fa,this._words[this._index]=Fa+"px",this._text=null}),Fe.create=function(Fa){var Fb=Fe._cache[Fa];return Fb||(Fb=Fe._cache[Fa]=new Fe(Fa))},Fe.EMPTY=new Fe,Fe._cache={},Fe._cache2=null,Fe}(),Fra=function(){function Fa(){}return Fo(Fa,"laya.webgl.utils.CONST3D2D"),Fa.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fa.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],Fa.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],Fa._TMPARRAY=[],Fa._OFFSETX=0,Fa._OFFSETY=0,Fg(Fa,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),Fa}(),Fsa=function(){function Fq(){}return Fo(Fq,"laya.webgl.utils.GlUtils"),Fq.make2DProjection=function(Fa,Fb,Fc){return[2/Fa,0,0,0,0,-2/Fb,0,0,0,0,2/Fc,0,-1,1,0,1]},Fq.fillIBQuadrangle=function(Fa,Fb){if(65535/4<Fb)throw Error("IBQuadrangle count:"+Fb+" must<:"+Math.floor(65535/4));Fb=Math.floor(Fb),Fa._resizeBuffer(6*(Fb+1)*2,!1),Fa.byteLength=Fa.bufferLength;for(var Fc=Fa.getUint16Array(),Fd=0,Fe=0;Fe<Fb;Fe++)Fc[Fd++]=4*Fe,Fc[Fd++]=4*Fe+2,Fc[Fd++]=4*Fe+1,Fc[Fd++]=4*Fe,Fc[Fd++]=4*Fe+3,Fc[Fd++]=4*Fe+2;return Fa.setNeedUpload(),!0},Fq.expandIBQuadrangle=function(Fa,Fb){Fa.bufferLength>=6*Fb*2||Fq.fillIBQuadrangle(Fa,Fb)},Fq.mathCeilPowerOfTwo=function(Fa){return Fa--,Fa|=Fa>>1,Fa|=Fa>>2,Fa|=Fa>>4,Fa|=Fa>>8,Fa|=Fa>>16,++Fa},Fq.fillQuadrangleImgVb=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){var Fi=16+(Fa._byteLength>>2);Fa.byteLength=Fi<<2;var Fj=Fa.getFloat32Array();Fj[(Fi-=16)+2]=Fe[0],Fj[Fi+3]=Fe[1],Fj[Fi+6]=Fe[2],Fj[Fi+7]=Fe[3],Fj[Fi+10]=Fe[4],Fj[Fi+11]=Fe[5],Fj[Fi+14]=Fe[6],Fj[Fi+15]=Fe[7];var Fm=Ff.a,Fn=Ff.b,Fo=Ff.c,Fp=Ff.d;if(1!==Fm||0!==Fn||0!==Fo||1!==Fp){Ff.bTransform=!0;var Fq=Ff.tx+Fg,Fr=Ff.ty+Fh;Fj[Fi]=(Fd[0]+Fb)*Fm+(Fd[1]+Fc)*Fo+Fq,Fj[Fi+1]=(Fd[0]+Fb)*Fn+(Fd[1]+Fc)*Fp+Fr,Fj[Fi+4]=(Fd[2]+Fb)*Fm+(Fd[3]+Fc)*Fo+Fq,Fj[Fi+5]=(Fd[2]+Fb)*Fn+(Fd[3]+Fc)*Fp+Fr,Fj[Fi+8]=(Fd[4]+Fb)*Fm+(Fd[5]+Fc)*Fo+Fq,Fj[Fi+9]=(Fd[4]+Fb)*Fn+(Fd[5]+Fc)*Fp+Fr,Fj[Fi+12]=(Fd[6]+Fb)*Fm+(Fd[7]+Fc)*Fo+Fq,Fj[Fi+13]=(Fd[6]+Fb)*Fn+(Fd[7]+Fc)*Fp+Fr}else Ff.bTransform=!1,Fb+=Ff.tx+Fg,Fc+=Ff.ty+Fh,Fj[Fi]=Fb+Fd[0],Fj[Fi+1]=Fc+Fd[1],Fj[Fi+4]=Fb+Fd[2],Fj[Fi+5]=Fc+Fd[3],Fj[Fi+8]=Fb+Fd[4],Fj[Fi+9]=Fc+Fd[5],Fj[Fi+12]=Fb+Fd[6],Fj[Fi+13]=Fc+Fd[7];return Fa._upload=!0},Fq.fillTranglesVB=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){var Fh=(Fa._byteLength>>2)+Fd.length;Fa.byteLength=Fh<<2;var Fi=Fa.getFloat32Array();Fh-=Fd.length;for(var Fj=Fd.length,Fm=Fe.a,Fn=Fe.b,Fo=Fe.c,Fp=Fe.d,Fq=0;Fq<Fj;Fq+=4)if(Fi[Fh+Fq+2]=Fd[Fq+2],Fi[Fh+Fq+3]=Fd[Fq+3],1!==Fm||0!==Fn||0!==Fo||1!==Fp){Fe.bTransform=!0;var Fr=Fe.tx+Ff,Fs=Fe.ty+Fg;Fi[Fh+Fq]=(Fd[Fq]+Fb)*Fm+(Fd[Fq+1]+Fc)*Fo+Fr,Fi[Fh+Fq+1]=(Fd[Fq]+Fb)*Fn+(Fd[Fq+1]+Fc)*Fp+Fs}else Fe.bTransform=!1,Fb+=Fe.tx+Ff,Fc+=Fe.ty+Fg,Fi[Fh+Fq]=Fb+Fd[Fq],Fi[Fh+Fq+1]=Fc+Fd[Fq+1];return Fa._upload=!0},Fq.copyPreImgVb=function(Fa,Fb,Fc){var Fd=Fa._byteLength>>2;Fa.byteLength=Fd+16<<2;for(var Fe=Fa.getFloat32Array(),Ff=0,Fg=Fd-16;Ff<4;Ff++)Fe[Fd]=Fe[Fg]+Fb,++Fg,Fe[++Fd]=Fe[Fg]+Fc,++Fg,Fe[++Fd]=Fe[Fg],++Fg,Fe[++Fd]=Fe[Fg],++Fd,++Fg;Fa._upload=!0},Fq.fillRectImgVb=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn,Fo){void 0===Fo&&(Fo=!1);var Fp,Fq,Fr,Fs,Ft,Fu,Fv,Fw,Fx,Fy,Fz,FA,FB,FC,FD,FE,FF=1,FG=Fh.a,FH=Fh.b,FI=Fh.c,FJ=Fh.d,FK=Fb&&Fb.width<99999999;if(1!==FG||0!==FH||0!==FI||1!==FJ?(Fh.bTransform=!0,0===FH&&0===FI&&(FF=23,Fx=Fe+Fc,Fy=Ff+Fd,Fp=FG*Fc+(Fz=Fh.tx+Fi),Fr=FG*Fx+Fz,Fq=FJ*Fd+(FA=Fh.ty+Fj),Fs=FJ*Fy+FA)):(FF=23,Fh.bTransform=!1,Fr=(Fp=Fc+Fh.tx+Fi)+Fe,Fs=(Fq=Fd+Fh.ty+Fj)+Ff),FK&&(Ft=Fb.x,Fu=Fb.y,Fv=Fb.width+Ft,Fw=Fb.height+Fu),1!==FF){if(Math.min(Fp,Fr)>=Fv)return!1;if(Math.min(Fq,Fs)>=Fw)return!1;if(Math.max(Fr,Fp)<=Ft)return!1;if(Math.max(Fs,Fq)<=Fu)return!1}var FL=Fa._byteLength>>2;Fa.byteLength=16+FL<<2;var FM=Fa.getFloat32Array();switch(FM[2+FL]=Fg[0],FM[3+FL]=Fg[1],FM[6+FL]=Fg[2],FM[7+FL]=Fg[3],FM[10+FL]=Fg[4],FM[11+FL]=Fg[5],FM[14+FL]=Fg[6],FM[15+FL]=Fg[7],FF){case 1:Fz=Fh.tx+Fi,FA=Fh.ty+Fj;var FN=FG*Fc,FO=FI*Fd,FP=FJ*Fd,FQ=FH*Fc,FR=FG*(Fx=Fe+Fc),FS=FI*(Fy=Ff+Fd),FT=FJ*Fy,FU=FH*Fx;Fo?(FB=FN+FO+Fz,FD=Math.round(FB)-FB,FC=FP+FQ+FA,FE=Math.round(FC)-FC,FM[FL]=FB+FD,FM[1+FL]=FC+FE,FM[4+FL]=FR+FO+Fz+FD,FM[5+FL]=FP+FU+FA+FE,FM[8+FL]=FR+FS+Fz+FD,FM[9+FL]=FT+FU+FA+FE,FM[12+FL]=FN+FS+Fz+FD,FM[13+FL]=FT+FQ+FA+FE):(FM[FL]=FN+FO+Fz,FM[1+FL]=FP+FQ+FA,FM[4+FL]=FR+FO+Fz,FM[5+FL]=FP+FU+FA,FM[8+FL]=FR+FS+Fz,FM[9+FL]=FT+FU+FA,FM[12+FL]=FN+FS+Fz,FM[13+FL]=FT+FQ+FA);break;case 23:Fo?(FB=Fp+Fm,FD=Math.round(FB)-FB,FC=Fq,FE=Math.round(FC)-FC,FM[FL]=FB+FD,FM[1+FL]=FC+FE,FM[4+FL]=Fr+Fm+FD,FM[5+FL]=Fq+FE,FM[8+FL]=Fr+FD,FM[9+FL]=Fs+FE,FM[12+FL]=Fp+FD,FM[13+FL]=Fs+FE):(FM[FL]=Fp+Fm,FM[1+FL]=Fq,FM[4+FL]=Fr+Fm,FM[5+FL]=Fq,FM[8+FL]=Fr,FM[9+FL]=Fs,FM[12+FL]=Fp,FM[13+FL]=Fs)}return Fa._upload=!0},Fq.fillLineVb=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){var Fi=.5*Fg,Fj=Fq._fillLineArray,Fm=-(Fd-Ff),Fn=Fc-Fe,Fo=Math.sqrt(Fm*Fm+Fn*Fn);Fm/=Fo,Fn/=Fo,Fm*=Fi,Fn*=Fi,Fj[0]=Fc-Fm,Fj[1]=Fd-Fn,Fj[4]=Fc+Fm,Fj[5]=Fd+Fn,Fj[8]=Fe+Fm,Fj[9]=Ff+Fn,Fj[12]=Fe-Fm,Fj[13]=Ff-Fn,Fh&&Fh.transformPointArray(Fj,Fj);var Fp=16+(Fa._byteLength>>2);return Fa.byteLength=Fp<<2,Fa.insertData(Fj,Fp-16),!0},Fq._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Fq}(),Fta=(function(){function Fi(){}Fo(Fi,"laya.webgl.utils.MatirxArray"),Fi.ArrayMul=function(Fa,Fb,Fc){if(Fa)if(Fb)for(var Fd=NaN,Fe=NaN,Ff=NaN,Fg=NaN,Fh=0;Fh<4;Fh++)Fd=Fa[Fh],Fe=Fa[Fh+4],Ff=Fa[Fh+8],Fg=Fa[Fh+12],Fc[Fh]=Fd*Fb[0]+Fe*Fb[1]+Ff*Fb[2]+Fg*Fb[3],Fc[Fh+4]=Fd*Fb[4]+Fe*Fb[5]+Ff*Fb[6]+Fg*Fb[7],Fc[Fh+8]=Fd*Fb[8]+Fe*Fb[9]+Ff*Fb[10]+Fg*Fb[11],Fc[Fh+12]=Fd*Fb[12]+Fe*Fb[13]+Ff*Fb[14]+Fg*Fb[15];else Fi.copyArray(Fa,Fc);else Fi.copyArray(Fb,Fc)},Fi.copyArray=function(Fa,Fb){if(Fa&&Fb)for(var Fc=0;Fc<Fa.length;Fc++)Fb[Fc]=Fa[Fc]}}(),function(){function Fb(Fa,Fb,Fc){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=Fa,this._vb=new Fla(Fa,35048),Fb&&this._vb._resizeBuffer(Fb,!1),this._ib=new Fka,Fc&&this._ib._resizeBuffer(Fc,!1)}Fo(Fb,"laya.webgl.utils.Mesh2D");var Fa=Fb.prototype;return Fa.cloneWithNewVB=function(){var Fa=new Fb(this._stride,0,0);return Fa._ib=this._ib,Fa._quadNum=this._quadNum,Fa._attribInfo=this._attribInfo,Fa},Fa.cloneWithNewVBIB=function(){var Fa=new Fb(this._stride,0,0);return Fa._attribInfo=this._attribInfo,Fa},Fa.getVBW=function(){return this._vb.setNeedUpload(),this._vb},Fa.getVBR=function(){return this._vb},Fa.getIBR=function(){return this._ib},Fa.getIBW=function(){return this._ib.setNeedUpload(),this._ib},Fa.createQuadIB=function(Fa){this._quadNum=Fa,this._ib._resizeBuffer(6*Fa*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var Fb=this._ib.getUint16Array(),Fc=0,Fd=0,Fe=0;Fe<Fa;Fe++)Fb[Fc++]=Fd,Fb[Fc++]=Fd+2,Fb[Fc++]=Fd+1,Fb[Fc++]=Fd,Fb[Fc++]=Fd+3,Fb[Fc++]=Fd+2,Fd+=4;this._ib.setNeedUpload()},Fa.setAttributes=function(Fa){if(this._attribInfo=Fa,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},Fa.getEleNum=function(){return this._ib.getBuffer().byteLength/2},Fa.releaseMesh=function(){},Fa.destroy=function(){},Fa.clearVB=function(){this._vb.clear()},Fb._gvaoid=0,Fb}()),Fua=function(){function Fe(){}return Fo(Fe,"laya.webgl.utils.RenderState2D"),Fe.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Fe.mat2MatArray=function(Fa,Fb){var Fc=Fa,Fd=Fb;return Fd[0]=Fc.a,Fd[1]=Fc.b,Fd[2]=Fe.EMPTYMAT4_ARRAY[2],Fd[3]=Fe.EMPTYMAT4_ARRAY[3],Fd[4]=Fc.c,Fd[5]=Fc.d,Fd[6]=Fe.EMPTYMAT4_ARRAY[6],Fd[7]=Fe.EMPTYMAT4_ARRAY[7],Fd[8]=Fe.EMPTYMAT4_ARRAY[8],Fd[9]=Fe.EMPTYMAT4_ARRAY[9],Fd[10]=Fe.EMPTYMAT4_ARRAY[10],Fd[11]=Fe.EMPTYMAT4_ARRAY[11],Fd[12]=Fc.tx,Fd[13]=Fc.ty,Fd[14]=Fe.EMPTYMAT4_ARRAY[14],Fd[15]=Fe.EMPTYMAT4_ARRAY[15],Fb},Fe.restoreTempArray=function(){Fe.TEMPMAT4_ARRAY[0]=1,Fe.TEMPMAT4_ARRAY[1]=0,Fe.TEMPMAT4_ARRAY[4]=0,Fe.TEMPMAT4_ARRAY[5]=1,Fe.TEMPMAT4_ARRAY[12]=0,Fe.TEMPMAT4_ARRAY[13]=0},Fe.clear=function(){Fe.worldScissorTest=!1,Fe.worldShaderDefines=null,Fe.worldFilters=null,Fe.worldAlpha=1,Fe.worldClipRect.x=Fe.worldClipRect.y=0,Fe.worldClipRect.width=Fe.width,Fe.worldClipRect.height=Fe.height,Fe.curRenderTarget=null},Fe._MAXSIZE=99999999,Fe.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fe.worldMatrix4=Fe.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fe.worldAlpha=1,Fe.worldScissorTest=!1,Fe.worldFilters=null,Fe.worldShaderDefines=null,Fe.curRenderTarget=null,Fe.width=0,Fe.height=0,Fg(Fe,["worldMatrix",function(){return this.worldMatrix=new FB},"worldClipRect",function(){return this.worldClipRect=new FD(0,0,99999999,99999999)}]),Fe}(),Fva=function(){var Fu,Fc;function Fv(Fa,Fb,Fc,Fd,Fe){var Ff=this;function Fg(Fa){var Fb=[],Fc=new Fu(Fb);return Ff._compileToTree(Fc,Fa.split("\n"),0,Fb,Fe),Fc}var Fh=Fp.now();this._VS=Fg(Fb),this._PS=Fg(Fc),this._nameMap=Fd,2<Fp.now()-Fh&&console.log("ShaderCompile use time:"+(Fp.now()-Fh)+"  size:"+Fb.length+"/"+Fc.length)}Fo(Fv,"laya.webgl.utils.ShaderCompile");var Fa=Fv.prototype;return Fa._compileToTree=function(Fa,Fb,Fc,Fd,Fe){var Ff,Fg,Fh,Fi,Fj,Fm,Fn,Fo=0,Fp=0,Fq=0,Fr=0;for(Fp=Fc;Fp<Fb.length;Fp++)if(!((Fh=Fb[Fp]).length<1)&&0!==(Fo=Fh.indexOf("//"))){if(0<=Fo&&(Fh=Fh.substr(0,Fo)),Ff=Fn||new Fu(Fd),Fn=null,Ff.text=Fh,Ff.noCompile=!0,0<=(Fo=Fh.indexOf("#"))){for(Fi="#",Fr=Fo+1,Fq=Fh.length;Fr<Fq;Fr++){var Fs=Fh.charAt(Fr);if(" "===Fs||"\t"===Fs||"\r"===Fs||"\n"===Fs||"?"===Fs)break;Fi+=Fs}switch(Ff.name=Fi){case"#ifdef":case"#ifndef":if(Ff.src=Fh,Ff.noCompile=null!=Fh.match(/[!&|()=<>]/),Ff.noCompile?console.log("function():Boolean{return "+Fh.substr(Fo+Ff.name.length)+"}"):(Fm=Fh.replace(/^\s*/,"").split(/\s+/),Ff.setCondition(Fm[1],"#ifdef"===Fi?1:2),Ff.text="//"+Ff.text),Ff.setParent(Fa),Fa=Ff,Fe)for(Fm=Fh.substr(Fr).split(Fv._splitToWordExps3),Fr=0;Fr<Fm.length;Fr++)(Fh=Fm[Fr]).length&&(Fe[Fh]=!0);continue;case"#if":if(Ff.src=Fh,Ff.noCompile=!0,Ff.setParent(Fa),Fa=Ff,Fe)for(Fm=Fh.substr(Fr).split(Fv._splitToWordExps3),Fr=0;Fr<Fm.length;Fr++)(Fh=Fm[Fr]).length&&"defined"!=Fh&&(Fe[Fh]=!0);continue;case"#else":Ff.src=Fh,Fg=(Fa=Fa.parent).childs[Fa.childs.length-1],Ff.noCompile=Fg.noCompile,Ff.noCompile||(Ff.condition=Fg.condition,Ff.conditionType=1==Fg.conditionType?2:1,Ff.text="//"+Ff.text+" "+Fg.text+" "+Ff.conditionType),Ff.setParent(Fa),Fa=Ff;continue;case"#endif":Fg=(Fa=Fa.parent).childs[Fa.childs.length-1],Ff.noCompile=Fg.noCompile,Ff.noCompile||(Ff.text="//"+Ff.text),Ff.setParent(Fa);continue;case"#include":Fm=Fv.splitToWords(Fh,null);var Ft=Fv.includes[Fm[1]];if(!Ft)throw"ShaderCompile error no this include file:"+Fm[1];if((Fo=Fm[0].indexOf("?"))<0){Ff.setParent(Fa),Fh=Ft.getWith("with"==Fm[2]?Fm[3]:null),this._compileToTree(Ff,Fh.split("\n"),0,Fd,Fe),Ff.text="";continue}Ff.setCondition(Fm[0].substr(Fo+1),1),Ff.text=Ft.getWith("with"==Fm[2]?Fm[3]:null);break;case"#import":Fj=(Fm=Fv.splitToWords(Fh,null))[1],Fd.push({node:Ff,file:Fv.includes[Fj],ofs:Ff.text.length});continue}}else{if((Fg=Fa.childs[Fa.childs.length-1])&&!Fg.name){0<Fd.length&&Fv.splitToWords(Fh,Fg),Fn=Ff,Fg.text+="\n"+Fh;continue}0<Fd.length&&Fv.splitToWords(Fh,Ff)}Ff.setParent(Fa)}},Fa.createShader=function(Fa,Fb,Fc){var Fd={},Fe="";if(Fa)for(var Ff in Fa)Fe+="#define "+Ff+"\n",Fd[Ff]=!0;var Fg=this._VS.toscript(Fd,[]),Fh=this._PS.toscript(Fd,[]);return(Fc||FYa.create)(Fe+Fg.join("\n"),Fe+Fh.join("\n"),Fb,this._nameMap)},Fv._parseOne=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg={type:Fv.shaderParamsMap[Fc[Fd+1]],name:Fc[Fd+2],size:isNaN(parseInt(Fc[Fd+3]))?1:parseInt(Fc[Fd+3])};return Ff&&("attribute"==Fe?Fa.push(Fg):Fb.push(Fg)),":"==Fc[Fd+3]&&(Fg.type=Fc[Fd+4],Fd+=2),Fd+=2},Fv.addInclude=function(Fa,Fb){if(!Fb||0===Fb.length)throw new Error("add shader include file err:"+Fa);if(Fv.includes[Fa])throw new Error("add shader include file err, has add:"+Fa);Fv.includes[Fa]=new Fc(Fb)},Fv.preGetParams=function(Fa,Fb){var Fc=[Fa,Fb],Fd={},Fe=[],Ff=[],Fg={},Fh=[];Fd.attributes=Fe,Fd.uniforms=Ff,Fd.defines=Fg;for(var Fi=0,Fj=0,Fm=0;Fm<2;Fm++){Fc[Fm]=Fc[Fm].replace(Fv._removeAnnotation,"");var Fn,Fo=Fc[Fm].match(Fv._reg);for(Fi=0,Fj=Fo.length;Fi<Fj;Fi++){var Fp=Fo[Fi];if("attribute"==Fp||"uniform"==Fp)Fi=Fv._parseOne(Fe,Ff,Fo,Fi,Fp,!0);else{if("#define"==Fp){Fh[Fp=Fo[++Fi]]=1;continue}if("#ifdef"==Fp){Fg[Fn=Fo[++Fi]]=Fg[Fn]||[];for(Fi++;Fi<Fj;Fi++)if("attribute"==(Fp=Fo[Fi])||"uniform"==Fp)Fi=Fv._parseOne(Fe,Ff,Fo,Fi,Fp,Fh[Fn]);else if("#else"==Fp)for(Fi++;Fi<Fj;Fi++)if("attribute"==(Fp=Fo[Fi])||"uniform"==Fp)Fi=Fv._parseOne(Fe,Ff,Fo,Fi,Fp,!Fh[Fn]);else if("#endif"==Fp)break}}}}return Fd},Fv.splitToWords=function(Fa,Fb){for(var Fc,Fd,Fe=[],Ff=-1,Fg=0,Fh=Fa.length;Fg<Fh;Fg++)if(Fc=Fa.charAt(Fg),0<=" \t=+-*/&%!<>()'\",;".indexOf(Fc)){if(0<=Ff&&1<Fg-Ff&&(Fd=Fa.substr(Ff,Fg-Ff),Fe.push(Fd)),'"'==Fc||"'"==Fc){var Fi=Fa.indexOf(Fc,Fg+1);if(Fi<0)throw"Sharder err:"+Fa;Fe.push(Fa.substr(Fg+1,Fi-Fg-1)),Fg=Fi,Ff=-1;continue}"("==Fc&&Fb&&0<Fe.length&&(Fd=Fe[Fe.length-1]+";","vec4;main;".indexOf(Fd)<0&&(Fb.useFuns+=Fd)),Ff=-1}else Ff<0&&(Ff=Fg);return Ff<Fh&&1<Fh-Ff&&(Fd=Fa.substr(Ff,Fh-Ff),Fe.push(Fd)),Fe},Fv.IFDEF_NO=0,Fv.IFDEF_YES=1,Fv.IFDEF_ELSE=2,Fv.IFDEF_PARENT=3,Fv._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),Fv._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),Fv._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),Fv.includes={},Fg(Fv,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),Fv.__init$=function(){Fu=function(){function Fc(Fa){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=Fa}Fo(Fc,"");var Fa=Fc.prototype;return Fa.setParent=function(Fa){Fa.childs.push(this),this.z=Fa.z+1,this.parent=Fa},Fa.setCondition=function(Fa,Fb){Fa&&(this.conditionType=Fb,Fa=Fa.replace(/(\s*$)/g,""),this.condition=function(){return this[Fa]},this.condition.__condition=Fa)},Fa.toscript=function(Fa,Fb){return this._toscript(Fa,Fb,++Fc.__id)},Fa._toscript=function(Fd,Fe,Ff){if(this.childs.length<1&&!this.text)return Fe;Fe.length;if(this.condition){var Fa=!!this.condition.call(Fd);if(2===this.conditionType&&(Fa=!Fa),!Fa)return Fe}if(this.text&&Fe.push(this.text),0<this.childs.length&&this.childs.forEach(function(Fa,Fb,Fc){Fa._toscript(Fd,Fe,Ff)}),0<this.includefiles.length&&0<this.useFuns.length)for(var Fb,Fc=0,Fg=this.includefiles.length;Fc<Fg;Fc++)this.includefiles[Fc].curUseID!=Ff&&0<(Fb=this.includefiles[Fc].file.getFunsScript(this.useFuns)).length&&(this.includefiles[Fc].curUseID=Ff,Fe[0]=Fb+Fe[0]);return Fe},Fc.__id=1,Fc}(),Fc=function(){function Fa(Fa){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=Fa;for(var Fb=0,Fc=0,Fd=0;!((Fb=Fa.indexOf("#begin",Fb))<0);){for(Fd=Fb+5;!((Fd=Fa.indexOf("#end",Fd))<0)&&"i"===Fa.charAt(Fd+4);)Fd+=5;if(Fd<0)throw"add include err,no #end:"+Fa;Fc=Fa.indexOf("\n",Fb);var Fe=Fv.splitToWords(Fa.substr(Fb,Fc-Fb),null);"code"==Fe[1]?this.codes[Fe[2]]=Fa.substr(Fc+1,Fd-Fc-1):"function"==Fe[1]&&(Fc=Fa.indexOf("function",Fb),Fc+="function".length,this.funs[Fe[3]]=Fa.substr(Fc+1,Fd-Fc-1),this.funnames+=Fe[3]+";"),Fb=Fd+1}}Fo(Fa,"");var Fb=Fa.prototype;return Fb.getWith=function(Fa){var Fb=Fa?this.codes[Fa]:this.script;if(!Fb)throw"get with error:"+Fa;return Fb},Fb.getFunsScript=function(Fa){var Fb="";for(var Fc in this.funs)0<=Fa.indexOf(Fc+";")&&(Fb+=this.funs[Fc]);return Fb},Fa}()},Fv}(),Fwa=function(){function Fg(){}return Fo(Fg,"laya.webgl.WebGL"),Fg._uint8ArraySlice=function(){for(var Fa=this.length,Fb=new Uint8Array(this.length),Fc=0;Fc<Fa;Fc++)Fb[Fc]=this[Fc];return Fb},Fg._float32ArraySlice=function(){for(var Fa=this.length,Fb=new Float32Array(this.length),Fc=0;Fc<Fa;Fc++)Fb[Fc]=this[Fc];return Fb},Fg._uint16ArraySlice=function(Fa){var Fb,Fc=arguments,Fd=0,Fe=0;if(0===Fc.length)for(Fd=this.length,Fb=new Uint16Array(Fd),Fe=0;Fe<Fd;Fe++)Fb[Fe]=this[Fe];else if(2===Fc.length){var Ff=Fc[0],Fg=Fc[1];if(Ff<Fg)for(Fd=Fg-Ff,Fb=new Uint16Array(Fd),Fe=Ff;Fe<Fg;Fe++)Fb[Fe-Ff]=this[Fe];else Fb=new Uint16Array(0)}return Fb},Fg.expandContext=function(){var Fa=Fe.prototype,Fb=CanvasRenderingContext2D.prototype;Fb.fillTrangles=Fa.fillTrangles,FZa.__int__(null),Fb.setIBVB=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){void 0===Fi&&(Fi=0),void 0===Fj&&(Fj=0),null===Fc&&(this._ib=this._ib||Fka.QuadrangleIB,Fc=this._ib,Fsa.expandIBQuadrangle(Fc,Fd._byteLength/64+8)),this._setIBVB(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj)},Fb.fillTrangles=function(Fa,Fb,Fc,Fd,Fe){this._curMat=this._curMat||FB.create(),this._vb=this._vb||Fla.create(),this._ib||(this._ib=Fka.create(),Fsa.fillIBQuadrangle(this._ib,Fg/4));var Ff=this._vb,Fg=Fd.length>>4;Fsa.fillTranglesVB(Ff,Fb,Fc,Fd,Fe||this._curMat,0,0),Fsa.expandIBQuadrangle(this._ib,Ff._byteLength/64+8);var Fh=new FAa(1,0);Fh.textureHost=Fa;var Fi=new F_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");Ff._vertType=3,this._setIBVB(Fb,Fc,this._ib,Ff,6*Fg,Fe,Fi,Fh,0,0)}},Fg.enable=function(){if(Fp.__init__(),Ft.isConchApp&&!Ft.isConchWebGL)return Fx.skinAniSprite=function(){return new Faa},Fg.expandContext(),!1;if(Fx.getWebGLContext=function(Fa){for(var Fb,Fc=["webgl","experimental-webgl","webkit-3d","moz-webgl"],Fd=0;Fd<Fc.length;Fd++){try{Fb=Fa.getContext(Fc[Fd],{stencil:Fz.isStencil,alpha:Fz.isAlpha,antialias:Fz.isAntialias,premultipliedAlpha:Fz.premultipliedAlpha,preserveDrawingBuffer:Fz.preserveDrawingBuffer})}catch(Fa){}if(Fb)return Fb}return null},null==(Fg.mainContext=Fg.mainContext||Fx.getWebGLContext(Ft._mainCanvas)))return!1;if(Ft.isWebGL)return!0;Fr.create=function(Fa,Fb){return new Fab(Fa,Fb)},Fs.create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){return new FXa(Fa,Fb,Fc,Fd,Fe,Ff,Fg)},Ft.WebGL=Fg,Ft.isWebGL=!0,Fpa.__init__(),Fx.createRenderSprite=function(Fa,Fb){return new FBa(Fa,Fb)},Fx.createWebGLContext2D=function(Fa){return new Fza(Fa)},Fx.changeWebGLSize=function(Fa,Fb){laya.webgl.WebGL.onStageResize(Fa,Fb)},Fx.createGraphics=function(){return new Fya};var Fa=Fx.createFilterAction;return Fx.createFilterAction=Fa||function(Fa){return new FCa},Fx.clear=function(Fa){Fua.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var Fb=Ft.context.ctx,Fc=0==Fb._submits._length||Fz.preserveDrawingBuffer?Fq.create(Fa)._color:FF._wgColor;Fc&&Fb.clearBG(Fc[0],Fc[1],Fc[2],Fc[3]),Fua.clear()},Fx.addToAtlas=function(Fa,Fb){void 0===Fb&&(Fb=!1);var Fc=Fa.bitmap;Ft.optimizeTextureMemory(Fa.url,Fa)?Fy.__typeof(Fc,"laya.webgl.resource.IMergeAtlasBitmap")&&Fc.allowMerageInAtlas&&Fc.on("recovered",Fa,Fa.addTextureToAtlas):Fc.enableMerageInAtlas=!1},Fx.isAtlas=function(Fa){return Fa instanceof laya.webgl.atlas.AtlasWebGLCanvas},FQ._enable(),Fx.beginFlush=function(){for(var Fa=FQ.instance,Fb=Fa.getAtlaserCount(),Fc=0;Fc<Fb;Fc++){var Fd=Fa.getAtlaserByIndex(Fc).texture;Fd._flashCacheImageNeedFlush&&Fx.flashFlushImage(Fd)}},Fx.drawToCanvas=function(Fa,Fb,Fc,Fd,Fe,Ff){(Fc<=0||Fd<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),Fc|=0,Fd|=0,Fe|=0,Ff|=0;var Fg=FMa.create(Fc,Fd,6408,5121,0,!1);Fg.start(),Fg.clear(0,0,0,0),Ft.context.clear(),Fu.renders[Fb]._fun(Fa,Ft.context,Fe,Fua.height-Fd+Ff),Ft.context.flush(),Fg.end();var Fh=Fg.getData(0,0,Fc,Fd);if(Fg.recycle(),Fh.byteLength==Fc*Fd*4){var Fi=new FUa;Fi._canvas=Fp.createElement("canvas"),Fi.size(Fc,Fd);var Fj=Fi._canvas.getContext("2d");Fp.canvas.size(Fc,Fd);var Fm=Fp.context,Fn=Fm.createImageData(Fc,Fd);return Fn.data.set(new Uint8ClampedArray(Fh.buffer)),Fi._imgData=Fn,Fm.putImageData(Fn,0,0),Fj.save(),Fj.translate(0,Fd),Fj.scale(1,-1),Fj.drawImage(Fp.canvas.source,0,0),Fj.restore(),Fi}console.log("drawToCanvas error: w:"+Fc+",h:"+Fd+",datalen:"+Fh.byteLength)},Fx.createFilterAction=function(Fa){var Fb;switch(Fa){case 32:Fb=new FCa}return Fb},Fx.addTextureToAtlas=function(Fa){Fa._uvID++,FQ._atlasRestore++,Fa.bitmap.enableMerageInAtlas&&FQ.instance.addToAtlas(Fa)},Fx.getTexturePixels=function(Fa,Fb,Fc,Fd,Fe){Ft.context.ctx.clear();var Ff=new FE;Ff.graphics.drawTexture(Fa,-Fb,-Fc);var Fg=FMa.create(Fd,Fe);Fg.start(),Fg.clear(0,0,0,0),Ff.render(Ft.context,0,0),Ft.context.ctx.flush(),Fg.end();for(var Fh=Fg.getData(0,0,Fd,Fe),Fi=[],Fj=0,Fm=Fe-1;0<=Fm;Fm--)for(var Fn=0;Fn<Fd;Fn++)Fj=4*(Fm*Fd+Fn),Fi.push(Fh[Fj]),Fi.push(Fh[Fj+1]),Fi.push(Fh[Fj+2]),Fi.push(Fh[Fj+3]);return Fi},Fx.skinAniSprite=function(){return new Faa},Fj.create=function(Fa,Fb){var Fc=new FUa;return Fc._imgData=Fb,Fc.flipY=!1,Fc},FA._filterStart=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fa.getValue("bounds"),Fg=FMa.create(Ff.width,Ff.height);if(Fg.start(),Fg.clear(0,0,0,0),Fa.addValue("src",Fg),Fa.addValue("ScissorTest",Fua.worldScissorTest),Fua.worldScissorTest){var Fh=new FD;Fh.copyFrom(Fc.ctx._clipRect),Fa.addValue("clipRect",Fh),Fua.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},FA._filterEnd=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fa.getValue("bounds");Fa.getValue("src").end();var Fg=FMa.create(Ff.width,Ff.height);Fg.start(),Fg.clear(0,0,0,0),Fa.addValue("out",Fg),Fb._set$P("_filterCache",Fg),Fb._set$P("_isHaveGlowFilter",Fa.getValue("_isHaveGlowFilter"))},FA._EndTarget=function(Fa,Fb){if(Fa.getValue("src").recycle(),Fa.getValue("out").end(),Fa.getValue("ScissorTest")){Fua.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),Fb.ctx.save();var Fc=Fa.getValue("clipRect");Fb.ctx.clipRect(Fc.x,Fc.y,Fc.width,Fc.height)}},FA._useSrc=function(Fa){var Fb=Fa.getValue("out");Fb.end(),(Fb=Fa.getValue("src")).start(),Fb.clear(0,0,0,0)},FA._endSrc=function(Fa){Fa.getValue("src").end()},FA._useOut=function(Fa){var Fb=Fa.getValue("src");Fb.end(),(Fb=Fa.getValue("out")).start(),Fb.clear(0,0,0,0)},FA._endOut=function(Fa){Fa.getValue("out").end()},FA._recycleScope=function(Fa){Fa.recycle()},FA._filter=function(Fa,Fb,Fc,Fd){var Fe=this._next;if(Fe){var Ff,Fg,Fh=Fa.filters,Fi=Fh.length;if(1==Fi&&32==Fh[0].type)return Fb.ctx.save(),Fb.ctx.setFilters([Fh[0]]),Fe._fun.call(Fe,Fa,Fb,Fc,Fd),void Fb.ctx.restore();var Fj=Fha.create(),Fm=FC.TEMP,Fn=Fb.ctx._getTransformMatrix(),Fo=FB.create();Fn.copyTo(Fo);var Fp=0,Fq=0,Fr=!1,Fs=Fa._$P._filterCache?Fa._$P._filterCache:null;if(!Fs||Fa._repaint){Fr=Fa._isHaveGlowFilter(),Fj.addValue("_isHaveGlowFilter",Fr),Fr&&(Fp=50,Fq=25),(Fg=new FD).copyFrom(Fa.getSelfBounds()),Fg.x+=Fa.x,Fg.y+=Fa.y,Fg.x-=Fa.pivotX+4,Fg.y-=Fa.pivotY+4;var Ft=Fg.x,Fu=Fg.y;if(Fg.width+=Fp+8,Fg.height+=Fp+8,Fm.x=Fg.x*Fo.a+Fg.y*Fo.c,Fm.y=Fg.y*Fo.d+Fg.x*Fo.b,Fg.x=Fm.x,Fg.y=Fm.y,Fm.x=Fg.width*Fo.a+Fg.height*Fo.c,Fm.y=Fg.height*Fo.d+Fg.width*Fo.b,Fg.width=Fm.x,Fg.height=Fm.y,Fg.width<=0||Fg.height<=0)return;Fs&&Fs.recycle(),Fj.addValue("bounds",Fg);var Fv=Fga.create([Fj,Fa,Fb,0,0],FA._filterStart);Fb.addRenderObject(Fv),Fb.ctx._renderKey=0,Fb.ctx._shader2D.glTexture=null;var Fw=Fa.x-Ft+Fq,Fx=Fa.y-Fu+Fq;Fe._fun.call(Fe,Fa,Fb,Fw,Fx),Fv=Fga.create([Fj,Fa,Fb,0,0],FA._filterEnd),Fb.addRenderObject(Fv);for(var Fy=0;Fy<Fi;Fy++){0!=Fy&&(Fv=Fga.create([Fj],FA._useSrc),Fb.addRenderObject(Fv),Ff=FAa.create(1,0),FB.TEMP.identity(),Fb.ctx.drawTarget(Fj,0,0,Fg.width,Fg.height,FB.TEMP,"out",Ff,null,FS.TOINT.overlay),Fv=Fga.create([Fj],FA._useOut),Fb.addRenderObject(Fv)),Fh[Fy].action.apply3d(Fj,Fa,Fb,0,0)}Fv=Fga.create([Fj,Fb],FA._EndTarget),Fb.addRenderObject(Fv)}else{if((Fr=!!Fa._$P._isHaveGlowFilter&&Fa._$P._isHaveGlowFilter)&&(Fp=50,Fq=25),(Fg=Fa.getBounds()).width<=0||Fg.height<=0)return;Fg.width+=Fp,Fg.height+=Fp,Fm.x=Fg.x*Fo.a+Fg.y*Fo.c,Fm.y=Fg.y*Fo.d+Fg.x*Fo.b,Fg.x=Fm.x,Fg.y=Fm.y,Fm.x=Fg.width*Fo.a+Fg.height*Fo.c,Fm.y=Fg.height*Fo.d+Fg.width*Fo.b,Fg.width=Fm.x,Fg.height=Fm.y,Fj.addValue("out",Fs)}Fc=Fc-Fq-Fa.x,Fd=Fd-Fq-Fa.y,Fm.setTo(Fc,Fd),Fo.transformPoint(Fm),Fc=Fm.x+Fg.x,Fd=Fm.y+Fg.y,Ff=FAa.create(1,0),FB.TEMP.identity(),Fb.ctx.drawTarget(Fj,Fc,Fd,Fg.width,Fg.height,FB.TEMP,"out",Ff,null,FS.TOINT.overlay),Fv=Fga.create([Fj],FA._recycleScope),Fb.addRenderObject(Fv),Fo.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=Fg._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=Fg._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=Fg._uint8ArraySlice),!0},Fg.onStageResize=function(Fa,Fb){null!=Fg.mainContext&&(Fg.mainContext.viewport(0,0,Fa,Fb),Fua.width=Fa,Fua.height=Fb)},Fg.onInvalidGLRes=function(){FQ.instance.freeAll(),Fw.releaseContentManagers(!0),Fg.doNodeRepaint(Fy.stage),Fg.mainContext.viewport(0,0,Fua.width,Fua.height),Fy.stage.event("devicelost")},Fg.doNodeRepaint=function(Fa){0==Fa.numChildren&&Fa.repaint();for(var Fb=0;Fb<Fa.numChildren;Fb++)Fg.doNodeRepaint(Fa.getChildAt(Fb))},Fg.init=function(Fa,Fb,Fc){Fg.mainCanvas=Fa,Fj._createContext=function(Fa){return new Fza(Fa)},FUa._createContext=function(Fa){return new Fza(Fa)};var Fd=laya.webgl.WebGL.mainContext;if(null!=Fd.getShaderPrecisionFormat){var Fe=Fd.getShaderPrecisionFormat(35633,36338),Ff=Fd.getShaderPrecisionFormat(35632,36338);Fg.shaderHighPrecision=!(!Fe.precision||!Ff.precision)}else Fg.shaderHighPrecision=!1;if(Fg.compressAstc=Fd.getExtension("WEBGL_compressed_texture_astc"),Fg.compressAtc=Fd.getExtension("WEBGL_compressed_texture_atc"),Fg.compressEtc=Fd.getExtension("WEBGL_compressed_texture_etc"),Fg.compressEtc1=Fd.getExtension("WEBGL_compressed_texture_etc1"),Fg.compressPvrtc=Fd.getExtension("WEBGL_compressed_texture_pvrtc"),Fg.compressS3tc=Fd.getExtension("WEBGL_compressed_texture_s3tc"),Fg.compressS3tc_srgb=Fd.getExtension("WEBGL_compressed_texture_s3tc_srgb"),Fg.compressAstc=Fg.compressAstc?Fg.compressAstc:{},Fg.compressAtc=Fg.compressAtc?Fg.compressAtc:{},Fg.compressEtc=Fg.compressEtc?Fg.compressEtc:{},Fg.compressEtc1=Fg.compressEtc1?Fg.compressEtc1:{},Fg.compressPvrtc=Fg.compressPvrtc?Fg.compressPvrtc:{},Fg.compressS3tc=Fg.compressS3tc?Fg.compressS3tc:{},Fg.compressS3tc_srgb=Fg.compressS3tc_srgb?Fg.compressS3tc_srgb:{},Fd.deleteTexture1=Fd.deleteTexture,Fd.deleteTexture=function(Fa){Fa==Fxa.curBindTexValue&&(Fxa.curBindTexValue=null),Fd.deleteTexture1(Fa)},Fg.onStageResize(Fb,Fc),null==Fg.mainContext)throw new Error("webGL getContext err!");FI.__init__(),FQ.__init__(),FEa.__init__(),Ffa.__init__(),Fza.__init__(),FAa.__init__(),Fk.__init__(),FZa.__int__(Fd),FS._init_(Fd),Ft.isConchApp&&conch.setOnInvalidGLRes(Fg.onInvalidGLRes)},Fg.mainCanvas=null,Fg.antialias=!0,Fg.shaderHighPrecision=!1,Fg._bg_null=[0,0,0,0],Fg}(),Fxa=function(){function Fd(){}return Fo(Fd,"laya.webgl.WebGLContext"),Fd.UseProgram=function(Fa){return Fd._useProgram!==Fa&&(Fwa.mainContext.useProgram(Fa),Fd._useProgram=Fa,!0)},Fd.setDepthTest=function(Fa,Fb){Fb!==Fd._depthTest&&((Fd._depthTest=Fb)?Fa.enable(2929):Fa.disable(2929))},Fd.setDepthMask=function(Fa,Fb){Fb!==Fd._depthMask&&(Fd._depthMask=Fb,Fa.depthMask(Fb))},Fd.setDepthFunc=function(Fa,Fb){Fb!==Fd._depthFunc&&(Fd._depthFunc=Fb,Fa.depthFunc(Fb))},Fd.setBlend=function(Fa,Fb){Fb!==Fd._blend&&((Fd._blend=Fb)?Fa.enable(3042):Fa.disable(3042))},Fd.setBlendFunc=function(Fa,Fb,Fc){(Fb!==Fd._sFactor||Fc!==Fd._dFactor)&&(Fd._sFactor=Fb,Fd._dFactor=Fc,Fa.blendFunc(Fb,Fc))},Fd.setCullFace=function(Fa,Fb){Fb!==Fd._cullFace&&((Fd._cullFace=Fb)?Fa.enable(2884):Fa.disable(2884))},Fd.setFrontFace=function(Fa,Fb){Fb!==Fd._frontFace&&(Fd._frontFace=Fb,Fa.frontFace(Fb))},Fd.bindTexture=function(Fa,Fb,Fc){Fa.bindTexture(Fb,Fc),Fd.curBindTexTarget=Fb,Fd.curBindTexValue=Fc},Fd.DEPTH_BUFFER_BIT=256,Fd.STENCIL_BUFFER_BIT=1024,Fd.COLOR_BUFFER_BIT=16384,Fd.POINTS=0,Fd.LINES=1,Fd.LINE_LOOP=2,Fd.LINE_STRIP=3,Fd.TRIANGLES=4,Fd.TRIANGLE_STRIP=5,Fd.TRIANGLE_FAN=6,Fd.ZERO=0,Fd.ONE=1,Fd.SRC_COLOR=768,Fd.ONE_MINUS_SRC_COLOR=769,Fd.SRC_ALPHA=770,Fd.ONE_MINUS_SRC_ALPHA=771,Fd.DST_ALPHA=772,Fd.ONE_MINUS_DST_ALPHA=773,Fd.DST_COLOR=774,Fd.ONE_MINUS_DST_COLOR=775,Fd.SRC_ALPHA_SATURATE=776,Fd.FUNC_ADD=32774,Fd.BLEND_EQUATION=32777,Fd.BLEND_EQUATION_RGB=32777,Fd.BLEND_EQUATION_ALPHA=34877,Fd.FUNC_SUBTRACT=32778,Fd.FUNC_REVERSE_SUBTRACT=32779,Fd.BLEND_DST_RGB=32968,Fd.BLEND_SRC_RGB=32969,Fd.BLEND_DST_ALPHA=32970,Fd.BLEND_SRC_ALPHA=32971,Fd.CONSTANT_COLOR=32769,Fd.ONE_MINUS_CONSTANT_COLOR=32770,Fd.CONSTANT_ALPHA=32771,Fd.ONE_MINUS_CONSTANT_ALPHA=32772,Fd.BLEND_COLOR=32773,Fd.ARRAY_BUFFER=34962,Fd.ELEMENT_ARRAY_BUFFER=34963,Fd.ARRAY_BUFFER_BINDING=34964,Fd.ELEMENT_ARRAY_BUFFER_BINDING=34965,Fd.STREAM_DRAW=35040,Fd.STATIC_DRAW=35044,Fd.DYNAMIC_DRAW=35048,Fd.BUFFER_SIZE=34660,Fd.BUFFER_USAGE=34661,Fd.CURRENT_VERTEX_ATTRIB=34342,Fd.FRONT=1028,Fd.BACK=1029,Fd.CULL_FACE=2884,Fd.FRONT_AND_BACK=1032,Fd.BLEND=3042,Fd.DITHER=3024,Fd.STENCIL_TEST=2960,Fd.DEPTH_TEST=2929,Fd.SCISSOR_TEST=3089,Fd.POLYGON_OFFSET_FILL=32823,Fd.SAMPLE_ALPHA_TO_COVERAGE=32926,Fd.SAMPLE_COVERAGE=32928,Fd.NO_ERROR=0,Fd.INVALID_ENUM=1280,Fd.INVALID_VALUE=1281,Fd.INVALID_OPERATION=1282,Fd.OUT_OF_MEMORY=1285,Fd.CW=2304,Fd.CCW=2305,Fd.LINE_WIDTH=2849,Fd.ALIASED_POINT_SIZE_RANGE=33901,Fd.ALIASED_LINE_WIDTH_RANGE=33902,Fd.CULL_FACE_MODE=2885,Fd.FRONT_FACE=2886,Fd.DEPTH_RANGE=2928,Fd.DEPTH_WRITEMASK=2930,Fd.DEPTH_CLEAR_VALUE=2931,Fd.DEPTH_FUNC=2932,Fd.STENCIL_CLEAR_VALUE=2961,Fd.STENCIL_FUNC=2962,Fd.STENCIL_FAIL=2964,Fd.STENCIL_PASS_DEPTH_FAIL=2965,Fd.STENCIL_PASS_DEPTH_PASS=2966,Fd.STENCIL_REF=2967,Fd.STENCIL_VALUE_MASK=2963,Fd.STENCIL_WRITEMASK=2968,Fd.STENCIL_BACK_FUNC=34816,Fd.STENCIL_BACK_FAIL=34817,Fd.STENCIL_BACK_PASS_DEPTH_FAIL=34818,Fd.STENCIL_BACK_PASS_DEPTH_PASS=34819,Fd.STENCIL_BACK_REF=36003,Fd.STENCIL_BACK_VALUE_MASK=36004,Fd.STENCIL_BACK_WRITEMASK=36005,Fd.VIEWPORT=2978,Fd.SCISSOR_BOX=3088,Fd.COLOR_CLEAR_VALUE=3106,Fd.COLOR_WRITEMASK=3107,Fd.UNPACK_ALIGNMENT=3317,Fd.PACK_ALIGNMENT=3333,Fd.MAX_TEXTURE_SIZE=3379,Fd.MAX_VIEWPORT_DIMS=3386,Fd.SUBPIXEL_BITS=3408,Fd.RED_BITS=3410,Fd.GREEN_BITS=3411,Fd.BLUE_BITS=3412,Fd.ALPHA_BITS=3413,Fd.DEPTH_BITS=3414,Fd.STENCIL_BITS=3415,Fd.POLYGON_OFFSET_UNITS=10752,Fd.POLYGON_OFFSET_FACTOR=32824,Fd.TEXTURE_BINDING_2D=32873,Fd.SAMPLE_BUFFERS=32936,Fd.SAMPLES=32937,Fd.SAMPLE_COVERAGE_VALUE=32938,Fd.SAMPLE_COVERAGE_INVERT=32939,Fd.NUM_COMPRESSED_TEXTURE_FORMATS=34466,Fd.COMPRESSED_TEXTURE_FORMATS=34467,Fd.DONT_CARE=4352,Fd.FASTEST=4353,Fd.NICEST=4354,Fd.GENERATE_MIPMAP_HINT=33170,Fd.BYTE=5120,Fd.UNSIGNED_BYTE=5121,Fd.SHORT=5122,Fd.UNSIGNED_SHORT=5123,Fd.INT=5124,Fd.UNSIGNED_INT=5125,Fd.FLOAT=5126,Fd.DEPTH_COMPONENT=6402,Fd.ALPHA=6406,Fd.RGB=6407,Fd.RGBA=6408,Fd.LUMINANCE=6409,Fd.LUMINANCE_ALPHA=6410,Fd.UNSIGNED_SHORT_4_4_4_4=32819,Fd.UNSIGNED_SHORT_5_5_5_1=32820,Fd.UNSIGNED_SHORT_5_6_5=33635,Fd.FRAGMENT_SHADER=35632,Fd.VERTEX_SHADER=35633,Fd.MAX_VERTEX_ATTRIBS=34921,Fd.MAX_VERTEX_UNIFORM_VECTORS=36347,Fd.MAX_VARYING_VECTORS=36348,Fd.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,Fd.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,Fd.MAX_TEXTURE_IMAGE_UNITS=34930,Fd.MAX_FRAGMENT_UNIFORM_VECTORS=36349,Fd.SHADER_TYPE=35663,Fd.DELETE_STATUS=35712,Fd.LINK_STATUS=35714,Fd.VALIDATE_STATUS=35715,Fd.ATTACHED_SHADERS=35717,Fd.ACTIVE_UNIFORMS=35718,Fd.ACTIVE_ATTRIBUTES=35721,Fd.SHADING_LANGUAGE_VERSION=35724,Fd.CURRENT_PROGRAM=35725,Fd.NEVER=512,Fd.LESS=513,Fd.EQUAL=514,Fd.LEQUAL=515,Fd.GREATER=516,Fd.NOTEQUAL=517,Fd.GEQUAL=518,Fd.ALWAYS=519,Fd.KEEP=7680,Fd.REPLACE=7681,Fd.INCR=7682,Fd.DECR=7683,Fd.INVERT=5386,Fd.INCR_WRAP=34055,Fd.DECR_WRAP=34056,Fd.VENDOR=7936,Fd.RENDERER=7937,Fd.VERSION=7938,Fd.NEAREST=9728,Fd.LINEAR=9729,Fd.NEAREST_MIPMAP_NEAREST=9984,Fd.LINEAR_MIPMAP_NEAREST=9985,Fd.NEAREST_MIPMAP_LINEAR=9986,Fd.LINEAR_MIPMAP_LINEAR=9987,Fd.TEXTURE_MAG_FILTER=10240,Fd.TEXTURE_MIN_FILTER=10241,Fd.TEXTURE_WRAP_S=10242,Fd.TEXTURE_WRAP_T=10243,Fd.TEXTURE_2D=3553,Fd.TEXTURE=5890,Fd.TEXTURE_CUBE_MAP=34067,Fd.TEXTURE_BINDING_CUBE_MAP=34068,Fd.TEXTURE_CUBE_MAP_POSITIVE_X=34069,Fd.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,Fd.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,Fd.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,Fd.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,Fd.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,Fd.MAX_CUBE_MAP_TEXTURE_SIZE=34076,Fd.TEXTURE0=33984,Fd.TEXTURE1=33985,Fd.TEXTURE2=33986,Fd.TEXTURE3=33987,Fd.TEXTURE4=33988,Fd.TEXTURE5=33989,Fd.TEXTURE6=33990,Fd.TEXTURE7=33991,Fd.TEXTURE8=33992,Fd.TEXTURE9=33993,Fd.TEXTURE10=33994,Fd.TEXTURE11=33995,Fd.TEXTURE12=33996,Fd.TEXTURE13=33997,Fd.TEXTURE14=33998,Fd.TEXTURE15=33999,Fd.TEXTURE16=34e3,Fd.TEXTURE17=34001,Fd.TEXTURE18=34002,Fd.TEXTURE19=34003,Fd.TEXTURE20=34004,Fd.TEXTURE21=34005,Fd.TEXTURE22=34006,Fd.TEXTURE23=34007,Fd.TEXTURE24=34008,Fd.TEXTURE25=34009,Fd.TEXTURE26=34010,Fd.TEXTURE27=34011,Fd.TEXTURE28=34012,Fd.TEXTURE29=34013,Fd.TEXTURE30=34014,Fd.TEXTURE31=34015,Fd.ACTIVE_TEXTURE=34016,Fd.REPEAT=10497,Fd.CLAMP_TO_EDGE=33071,Fd.MIRRORED_REPEAT=33648,Fd.FLOAT_VEC2=35664,Fd.FLOAT_VEC3=35665,Fd.FLOAT_VEC4=35666,Fd.INT_VEC2=35667,Fd.INT_VEC3=35668,Fd.INT_VEC4=35669,Fd.BOOL=35670,Fd.BOOL_VEC2=35671,Fd.BOOL_VEC3=35672,Fd.BOOL_VEC4=35673,Fd.FLOAT_MAT2=35674,Fd.FLOAT_MAT3=35675,Fd.FLOAT_MAT4=35676,Fd.SAMPLER_2D=35678,Fd.SAMPLER_CUBE=35680,Fd.VERTEX_ATTRIB_ARRAY_ENABLED=34338,Fd.VERTEX_ATTRIB_ARRAY_SIZE=34339,Fd.VERTEX_ATTRIB_ARRAY_STRIDE=34340,Fd.VERTEX_ATTRIB_ARRAY_TYPE=34341,Fd.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,Fd.VERTEX_ATTRIB_ARRAY_POINTER=34373,Fd.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,Fd.COMPILE_STATUS=35713,Fd.LOW_FLOAT=36336,Fd.MEDIUM_FLOAT=36337,Fd.HIGH_FLOAT=36338,Fd.LOW_INT=36339,Fd.MEDIUM_INT=36340,Fd.HIGH_INT=36341,Fd.FRAMEBUFFER=36160,Fd.RENDERBUFFER=36161,Fd.RGBA4=32854,Fd.RGB5_A1=32855,Fd.RGB565=36194,Fd.DEPTH_COMPONENT16=33189,Fd.STENCIL_INDEX=6401,Fd.STENCIL_INDEX8=36168,Fd.DEPTH_STENCIL=34041,Fd.RENDERBUFFER_WIDTH=36162,Fd.RENDERBUFFER_HEIGHT=36163,Fd.RENDERBUFFER_INTERNAL_FORMAT=36164,Fd.RENDERBUFFER_RED_SIZE=36176,Fd.RENDERBUFFER_GREEN_SIZE=36177,Fd.RENDERBUFFER_BLUE_SIZE=36178,Fd.RENDERBUFFER_ALPHA_SIZE=36179,Fd.RENDERBUFFER_DEPTH_SIZE=36180,Fd.RENDERBUFFER_STENCIL_SIZE=36181,Fd.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,Fd.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,Fd.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,Fd.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,Fd.COLOR_ATTACHMENT0=36064,Fd.DEPTH_ATTACHMENT=36096,Fd.STENCIL_ATTACHMENT=36128,Fd.DEPTH_STENCIL_ATTACHMENT=33306,Fd.NONE=0,Fd.FRAMEBUFFER_COMPLETE=36053,Fd.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,Fd.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,Fd.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,Fd.FRAMEBUFFER_UNSUPPORTED=36061,Fd.FRAMEBUFFER_BINDING=36006,Fd.RENDERBUFFER_BINDING=36007,Fd.MAX_RENDERBUFFER_SIZE=34024,Fd.INVALID_FRAMEBUFFER_OPERATION=1286,Fd.UNPACK_FLIP_Y_WEBGL=37440,Fd.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,Fd.CONTEXT_LOST_WEBGL=37442,Fd.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,Fd.BROWSER_DEFAULT_WEBGL=37444,Fd._useProgram=null,Fd._depthTest=!0,Fd._depthMask=!0,Fd._blend=!1,Fd._cullFace=!1,Fd.curBindTexTarget=null,Fd.curBindTexValue=null,Fg(Fd,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),Fd}(),Fya=function(Fa){function Fb(){Fb.__super.call(this)}Fo(Fb,"laya.webgl.display.GraphicsGL",Fh);var Fc=Fb.prototype;return Fc.setShader=function(Fa){this._saveToCmd(Ft.context._setShader,[Fa])},Fc.setIBVB=function(Fa,Fb,Fc,Fd,Fe,Ff){this._saveToCmd(Ft.context._setIBVB,[Fa,Fb,Fc,Fd,Fe,Ff])},Fc.drawParticle=function(Fa,Fb,Fc){var Fd=Fx.createParticleTemplate2D(Fc);Fd.x=Fa,Fd.y=Fb,this._saveToCmd(Ft.context._drawParticle,[Fd])},Fb}(),Fza=function(Fa){var Fc;function FP(Fa){this._x=0,this._y=0,this._id=++FP._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,FP.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=FP.MAXCLIPRECT,this.mOutPoint,this._canvas=Fa,this._canvas._addReference(),FP._contextcount++,Ft.isFlash?(this._ib=Fka.create(35044),Fsa.fillIBQuadrangle(this._ib,16)):this._ib=Fka.QuadrangleIB,this.clear()}Fo(FP,"laya.webgl.canvas.WebGLContext2D",Fe);var Fb=FP.prototype;return Fb.setIsMainContext=function(){this._isMain=!0},Fb.clearBG=function(Fa,Fb,Fc,Fd){var Fe=Fwa.mainContext;Fe.clearColor(Fa,Fb,Fc,Fd),Fe.clear(16384)},Fb._getSubmits=function(){return this._submits},Fb._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var Fa=0,Fb=this._submits._length;Fa<Fb;Fa++)this._submits[Fa].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},Fb.destroy=function(){--FP._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=Fka.QuadrangleIB&&this._ib.releaseResource()},Fb.clear=function(){this._submits||(this._other=Fc.DEFAULT,this._curMat=FB.create(),this._vb=Fla.create(-1),this._submits=[],this._save=[FY.Create(this)],this._save.length=10,this._shader2D=new Fk,this._triangleMesh=FKa.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=Fc.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=FP.MAXCLIPRECT,this._curSubmit=Ffa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=FT.DEFAULT;for(var Fa=0,Fb=this._submits._length;Fa<Fb;Fa++)this._submits[Fa].releaseRender(),this._submits[Fa]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},Fb.size=function(Fa,Fb){if(this._width!=Fa||this._height!=Fb)if(0==Fa||0==Fb){0!=this._vb._byteLength&&(this._width=Fa,this._height=Fb,this._vb.clear(),this._vb.upload());for(var Fc=0,Fd=this._submits._length;Fc<Fd;Fc++)this._submits[Fc].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=Fa,this._height=Fb,this._targets&&this._targets.size(Fa,Fb),this._canvas.memorySize-=this._canvas.memorySize;0===Fa&&0===Fb&&this._releaseMem()},Fb._getTransformMatrix=function(){return this._curMat},Fb.translate=function(Fa,Fb){0===Fa&&0===Fb||(F$.save(this),this._curMat.bTransform&&(FZ.save(this),this._curMat.transformPointN(FC.TEMP.setTo(Fa,Fb)),Fa=FC.TEMP.x,Fb=FC.TEMP.y),this._x+=Fa,this._y+=Fb)},Fb.save=function(){this._save[this._save._length++]=FY.Create(this)},Fb.restore=function(){var Fa=this._save._length;if(!(Fa<1))for(var Fb=Fa-1;0<=Fb;Fb--){var Fc=this._save[Fb];if(Fc.restore(this),Fc.isSaveMark())return void(this._save._length=Fb)}},Fb._fillText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){void 0===Fj&&(Fj=0);var Fm=this._shader2D,Fn=this._curSubmit.shaderValue,Fo=Fe?Fqa.create(Fe):this._other.font;if(FQ.enabled)Fm.ALPHA!==Fn.ALPHA&&(Fm.glTexture=null),Fpa.drawText(this,Fa,Fb,this._curMat,Fo,Fi||this._other.textAlign,Ff,Fg,Fh,Fc,Fd,Fj);else{this._shader2D.defines.getValue();var Fp=Ff?Fq.create(Ff)._color:Fm.colorAdd;Fm.ALPHA===Fn.ALPHA&&Fp===Fm.colorAdd&&Fn.colorAdd===Fm.colorAdd||(Fm.glTexture=null,Fm.colorAdd=Fp),Fpa.drawText(this,Fa,Fb,this._curMat,Fo,Fi||this._other.textAlign,Ff,Fg,Fh,Fc,Fd,Fj)}},Fb.fillWords=function(Fa,Fb,Fc,Fd,Fe,Ff){this._fillText(null,Fa,Fb,Fc,Fd,Fe,null,-1,null,Ff)},Fb.fillBorderWords=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._fillBorderText(null,Fa,Fb,Fc,Fd,Fe,Ff,Fg,null)},Fb.fillText=function(Fa,Fb,Fc,Fd,Fe,Ff){this._fillText(Fa,null,Fb,Fc,Fd,Fe,null,-1,Ff)},Fb.strokeText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._fillText(Fa,null,Fb,Fc,Fd,null,Fe,Ff||1,Fg)},Fb.fillBorderText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){this._fillBorderText(Fa,null,Fb,Fc,Fd,Fe,Ff,Fg,Fh)},Fb._fillBorderText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){if(!FQ.enabled)return this._fillText(Fa,Fb,Fc,Fd,Fe,null,Fg,Fh||1,Fi),void this._fillText(Fa,Fb,Fc,Fd,Fe,Ff,null,-1,Fi);var Fj=this._shader2D,Fm=this._curSubmit.shaderValue;Fj.ALPHA!==Fm.ALPHA&&(Fj.glTexture=null);var Fn=Fe?(FP._fontTemp.setFont(Fe),FP._fontTemp):this._other.font;Fpa.drawText(this,Fa,Fb,this._curMat,Fn,Fi||this._other.textAlign,Ff,Fg,Fh||1,Fc,Fd,0)},Fb.fillRect=function(Fa,Fb,Fc,Fd,Fe){var Ff=this._vb;if(Fsa.fillRectImgVb(Ff,this._clipRect,Fa,Fb,Fc,Fd,FK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Fg=this._shader2D.fillStyle;Fe&&(this._shader2D.fillStyle=FT.create(Fe));var Fh=this._shader2D,Fi=this._curSubmit.shaderValue;if(Fh.fillStyle!==Fi.fillStyle||Fh.ALPHA!==Fi.ALPHA){Fh.glTexture=null;var Fj=this._curSubmit=Ffa.createSubmit(this,this._ib,Ff,(Ff._byteLength-64)/32*3,FAa.create(2,0));Fj.shaderValue.color=Fh.fillStyle._color._color,Fj.shaderValue.ALPHA=Fh.ALPHA,this._submits[this._submits._length++]=Fj}this._curSubmit._numEle+=6,this._shader2D.fillStyle=Fg}},Fb.fillTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){if(Fa.loaded&&Fa.bitmap&&Fa.source){var Fi=this._vb,Fj=Fa.bitmap.width,Fm=Fa.bitmap.height,Fn=Fa.uv,Fo=Fg.x%Fa.width,Fp=Fg.y%Fa.height;if(Fj!=Fh.w||Fm!=Fh.h){if(!Fh.w&&!Fh.h)switch(Fh.oy=Fh.ox=0,Ff){case"repeat":Fh.width=Fd,Fh.height=Fe;break;case"repeat-x":Fh.width=Fd,Fp<0?Fa.height+Fp>Fe?Fh.height=Fe:Fh.height=Fa.height+Fp:(Fh.oy=Fp,Fa.height+Fp>Fe?Fh.height=Fe-Fp:Fh.height=Fa.height);break;case"repeat-y":Fo<0?Fa.width+Fo>Fd?Fh.width=Fd:Fh.width=Fa.width+Fo:(Fh.ox=Fo,Fa.width+Fo>Fd?Fh.width=Fd-Fo:Fh.width=Fa.width),Fh.height=Fe;break;case"no-repeat":Fo<0?Fa.width+Fo>Fd?Fh.width=Fd:Fh.width=Fa.width+Fo:(Fh.ox=Fo,Fa.width+Fo>Fd?Fh.width=Fd-Fo:Fh.width=Fa.width),Fp<0?Fa.height+Fp>Fe?Fh.height=Fe:Fh.height=Fa.height+Fp:(Fh.oy=Fp,Fa.height+Fp>Fe?Fh.height=Fe-Fp:Fh.height=Fa.height);break;default:Fh.width=Fd,Fh.height=Fe}Fh.w=Fj,Fh.h=Fm,Fh.uv=[0,0,Fh.width/Fj,0,Fh.width/Fj,Fh.height/Fm,0,Fh.height/Fm]}if(Fb+=Fh.ox,Fc+=Fh.oy,Fo-=Fh.ox,Fp-=Fh.oy,Fsa.fillRectImgVb(Fi,this._clipRect,Fb,Fc,Fh.width,Fh.height,Fh.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Fq=FJa.create(this,this._ib,Fi,(Fi._byteLength-64)/32*3,FAa.create(256,0)),Fr=(this._submits[this._submits._length++]=Fq).shaderValue;Fr.textureHost=Fa;var Fs=Fn[0]*Fj,Ft=Fn[1]*Fm,Fu=(Fn[2]-Fn[0])*Fj,Fv=(Fn[5]-Fn[3])*Fm,Fw=-Fo/Fj,Fx=-Fp/Fm;Fr.u_TexRange[0]=Fs/Fj,Fr.u_TexRange[1]=Fu/Fj,Fr.u_TexRange[2]=Ft/Fm,Fr.u_TexRange[3]=Fv/Fm,Fr.u_offset[0]=Fw,Fr.u_offset[1]=Fx,FQ.enabled&&!this._isMain&&Fq.addTexture(Fa,(Fi._byteLength>>2)-16),(this._curSubmit=Fq)._renderType=10017,Fq._numEle+=6}}else this.sprite&&Fy.timer.callLater(this,this._repaintSprite)},Fb.setShader=function(Fa){FV.save(this,1048576,this._shader2D,!0),this._shader2D.shader=Fa},Fb.setFilters=function(Fa){FV.save(this,2097152,this._shader2D,!0),this._shader2D.filters=Fa,this._curSubmit=Ffa.RENDERBASE,this._renderKey=0,this._drawCount++},Fb.drawTexture=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._drawTextureM(Fa,Fb,Fc,Fd,Fe,Ff,Fg,null,1)},Fb.addTextureVb=function(Fa,Fb,Fc){var Fd=this._curSubmit._vb||this._vb,Fe=Fd._byteLength>>2;Fd.byteLength=Fe+16<<2;for(var Ff=Fd.getFloat32Array(),Fg=0;Fg<16;Fg+=4)Ff[Fe++]=Fa[Fg]+Fb,Ff[Fe++]=Fa[Fg+1]+Fc,Ff[Fe++]=Fa[Fg+2],Ff[Fe++]=Fa[Fg+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),Fd._upload=!0},Fb.willDrawTexture=function(Fa,Fb){if(!(Fa.loaded&&Fa.bitmap&&Fa.source))return this.sprite&&Fy.timer.callLater(this,this._repaintSprite),0;var Fc=Fa.bitmap,Fd=Fc.id+this._shader2D.ALPHA*Fb+10016;if(Fd==this._renderKey)return Fd;var Fe=this._shader2D,Ff=Fe.ALPHA,Fg=this._curSubmit.shaderValue;Fe.ALPHA*=Fb,this._renderKey=Fd,this._drawCount++,Fe.glTexture=Fc;var Fh=this._vb,Fi=null,Fj=Fh._byteLength/32*3,Fm=Fg.textureHost&&Fg.textureHost==Fa&&Fg.textureHost.alphaTexture==Fa.alphaTexture;return Fi=FJa.create(this,this._ib,Fh,Fj,FAa.create(1,0)),(this._submits[this._submits._length++]=Fi).shaderValue.textureHost=Fa,Fi._renderType=10016,Fi._preIsSameTextureShader=10016===this._curSubmit._renderType&&Fe.ALPHA===Fg.ALPHA&&Fm,this._curSubmit=Fi,Fe.ALPHA=Ff,Fd},Fb.drawTextures=function(Fa,Fb,Fc,Fd){if(Fa.loaded&&Fa.bitmap&&Fa.source){var Fe=this._clipRect;if(this._clipRect=FP.MAXCLIPRECT,this._drawTextureM(Fa,Fb[0],Fb[1],Fa.width,Fa.height,Fc,Fd,null,1)){if(this._clipRect=Fe,FG.drawCall++,!(Fb.length<4)){for(var Ff=this._curSubmit._vb||this._vb,Fg=this._curMat.a,Fh=this._curMat.d,Fi=2,Fj=Fb.length;Fi<Fj;Fi+=2)Fsa.copyPreImgVb(Ff,(Fb[Fi]-Fb[Fi-2])*Fg,(Fb[Fi+1]-Fb[Fi-1])*Fh),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&Fy.timer.callLater(this,this._repaintSprite)},Fb._drawTextureM=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){if(!Fa.loaded||!Fa.source)return this.sprite&&Fy.timer.callLater(this,this._repaintSprite),!1;var Fj=this._curSubmit._vb||this._vb,Fm=Fa.bitmap;Fb+=Ff,Fc+=Fg,this._drawCount++;var Fn=Fm.id+this._shader2D.ALPHA*Fi+10016;if(Fn!=this._renderKey){this._renderKey=Fn;var Fo=this._curSubmit.shaderValue,Fp=this._shader2D,Fq=Fp.ALPHA;Fp.ALPHA*=Fi,Fp.glTexture=Fm;var Fr=this._vb,Fs=null,Ft=Fr._byteLength/32*3,Fu=Fo.textureHost&&Fo.textureHost==Fa&&Fo.textureHost.alphaTexture==Fa.alphaTexture;Fs=FJa.create(this,this._ib,Fr,Ft,FAa.create(1,0)),(this._submits[this._submits._length++]=Fs).shaderValue.textureHost=Fa,Fs._renderType=10016,Fs._preIsSameTextureShader=10016===this._curSubmit._renderType&&Fp.ALPHA===Fo.ALPHA&&Fu,this._curSubmit=Fs,Fj=this._curSubmit._vb||this._vb,Fp.ALPHA=Fq}return!!Fsa.fillRectImgVb(Fj,this._clipRect,Fb,Fc,Fd||Fa.width,Fe||Fa.height,Fa.uv,Fh||this._curMat,this._x,this._y,0,0)&&(FQ.enabled&&!this._isMain&&this._curSubmit.addTexture(Fa,(Fj._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},Fb._repaintSprite=function(){this.sprite&&this.sprite.repaint()},Fb._drawText=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){var Fm=Fa.bitmap;this._drawCount++;var Fn=Fm.id+this._shader2D.ALPHA+10016;if(Fn!=this._renderKey){this._renderKey=Fn;var Fo=this._curSubmit.shaderValue,Fp=this._shader2D;Fp.glTexture=Fm;var Fq=this._vb,Fr=null,Fs=Fq._byteLength/32*3,Ft=Fo.textureHost&&Fo.textureHost==Fa&&Fo.textureHost.alphaTexture==Fa.alphaTexture;(Fr=FQ.enabled?FJa.create(this,this._ib,Fq,Fs,FAa.create(1,0)):FJa.create(this,this._ib,Fq,Fs,F$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&Fp.ALPHA===Fo.ALPHA&&Ft,(this._submits[this._submits._length++]=Fr).shaderValue.textureHost=Fa,Fr._renderType=10016,this._curSubmit=Fr}Fa.active();var Fu=this._curSubmit._vb||this._vb;Fsa.fillRectImgVb(Fu,this._clipRect,Fb+Fg,Fc+Fh,Fd||Fa.width,Fe||Fa.height,Fa.uv,Ff||this._curMat,this._x,this._y,Fi,Fj,!0)&&(FQ.enabled&&!this._isMain&&this._curSubmit.addTexture(Fa,(Fu._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},Fb.drawTextureWithTransform=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){if(Ff){var Fj=this._curMat,Fm=this._x,Fn=this._y;(0!==Fg||0!==Fh)&&(this._x=Fg*Fj.a+Fh*Fj.c,this._y=Fh*Fj.d+Fg*Fj.b),Ff&&Fj.bTransform?(FB.mul(Ff,Fj,FP._tmpMatrix),(Ff=FP._tmpMatrix)._checkTransform()):(this._x+=Fj.tx,this._y+=Fj.ty),this._drawTextureM(Fa,Fb,Fc,Fd,Fe,0,0,Ff,Fi),this._x=Fm,this._y=Fn}else this._drawTextureM(Fa,Fb,Fc,Fd,Fe,Fg,Fh,null,Fi)},Fb.fillQuadrangle=function(Fa,Fb,Fc,Fd,Fe){var Ff=this._curSubmit,Fg=this._vb,Fh=this._shader2D,Fi=Ff.shaderValue;if(this._renderKey=0,Fa.bitmap){var Fj=Fa.bitmap;Fh.glTexture==Fj&&Fh.ALPHA===Fi.ALPHA||(Fh.glTexture=Fj,(Ff=this._curSubmit=Ffa.createSubmit(this,this._ib,Fg,Fg._byteLength/32*3,FAa.create(1,0))).shaderValue.glTexture=Fj,this._submits[this._submits._length++]=Ff),Fsa.fillQuadrangleImgVb(Fg,Fb,Fc,Fd,Fa.uv,Fe||this._curMat,this._x,this._y)}else Ff.shaderValue.fillStyle&&Ff.shaderValue.fillStyle.equal(Fa)&&Fh.ALPHA===Fi.ALPHA||(Fh.glTexture=null,(Ff=this._curSubmit=Ffa.createSubmit(this,this._ib,Fg,Fg._byteLength/32*3,FAa.create(2,0))).shaderValue.defines.add(2),Ff.shaderValue.fillStyle=FT.create(Fa),this._submits[this._submits._length++]=Ff),Fsa.fillQuadrangleImgVb(Fg,Fb,Fc,Fd,FK.DEF_UV,Fe||this._curMat,this._x,this._y);Ff._numEle+=6},Fb.drawTexture2=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){if(0!=Ff){var Fi=this._curMat;if(this._x=Fa*Fi.a+Fb*Fi.c,this._y=Fb*Fi.d+Fa*Fi.b,Fe&&(Fe=Fi.bTransform||Fe.bTransform?(FB.mul(Fe,Fi,FP._tmpMatrix),FP._tmpMatrix):(this._x+=Fe.tx+Fi.tx,this._y+=Fe.ty+Fi.ty,FB.EMPTY)),1!==Ff||Fg){var Fj=this._shader2D.ALPHA,Fm=this._nBlendType;this._shader2D.ALPHA=Ff,Fg&&(this._nBlendType=FS.TOINT(Fg)),this._drawTextureM(Fh[0],Fh[1]-Fc,Fh[2]-Fd,Fh[3],Fh[4],0,0,Fe,1),this._shader2D.ALPHA=Fj,this._nBlendType=Fm}else this._drawTextureM(Fh[0],Fh[1]-Fc,Fh[2]-Fd,Fh[3],Fh[4],0,0,Fe,1);this._x=this._y=0}},Fb.drawCanvas=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fa.context;if(this._renderKey=0,Ff._targets)this._submits[this._submits._length++]=FIa.create(Ff,0,null),this._curSubmit=Ffa.RENDERBASE,Ff._targets.drawTo(this,Fb,Fc,Fd,Fe);else{var Fg=this._submits[this._submits._length++]=FIa.create(Ff,this._shader2D.ALPHA,this._shader2D.filters),Fh=Fd/Fa.width,Fi=Fe/Fa.height,Fj=Fg._matrix;this._curMat.copyTo(Fj),1!=Fh&&1!=Fi&&Fj.scale(Fh,Fi);var Fm=Fj.tx,Fn=Fj.ty;Fj.tx=Fj.ty=0,Fj.transformPoint(FC.TEMP.setTo(Fb,Fc)),Fj.translate(FC.TEMP.x+Fm,FC.TEMP.y+Fn),this._curSubmit=Ffa.RENDERBASE}Fz.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=Ff._targets?"yellow":"green",this.strokeRect(Fb-1,Fc-1,Fd+2,Fe+2,1),this.strokeRect(Fb,Fc,Fd,Fe,1),this.restore())},Fb.drawTarget=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){void 0===Fj&&(Fj=-1);var Fm=this._vb;if(Fsa.fillRectImgVb(Fm,this._clipRect,Fb,Fc,Fd,Fe,Fi||FK.DEF_UV,Ff||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var Fn=this._curSubmit=Fna.create(this,this._ib,Fm,(Fm._byteLength-64)/32*3,Fh,Fg);Fn.blendType=-1==Fj?this._nBlendType:Fj,Fn.scope=Fa,this._submits[this._submits._length++]=Fn,this._curSubmit._numEle+=6}},Fb.mixRGBandAlpha=function(Fa){return this._mixRGBandAlpha(Fa,this._shader2D.ALPHA)},Fb._mixRGBandAlpha=function(Fa,Fb){var Fc=(4278190080&Fa)>>>24;return 0!=Fc?Fc*=Fb:Fc=255*Fb,16777215&Fa|Fc<<24},Fb.drawTriangles=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){if(!Fa.loaded||!Fa.source)return this.sprite&&Fy.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;Fa.bitmap;var Fm=this._mixRGBandAlpha(4294967295,Fh),Fn=(Fd.length,Ff.length);this._renderKey=-1;var Fo=this._curSubmit=FJa.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,FAa.create(1,0));return Fo.shaderValue.textureHost=Fa,Fo._renderType=10016,this._submits[this._submits._length++]=Fo,Fg?(FP._tmpMatrix.a=Fg.a,FP._tmpMatrix.b=Fg.b,FP._tmpMatrix.c=Fg.c,FP._tmpMatrix.d=Fg.d,FP._tmpMatrix.tx=Fg.tx+Fb,FP._tmpMatrix.ty=Fg.ty+Fc,FB.mul(FP._tmpMatrix,this._curMat,FP._tmpMatrix)):(FP._tmpMatrix.a=this._curMat.a,FP._tmpMatrix.b=this._curMat.b,FP._tmpMatrix.c=this._curMat.c,FP._tmpMatrix.d=this._curMat.d,FP._tmpMatrix.tx=this._curMat.tx+Fb,FP._tmpMatrix.ty=this._curMat.ty+Fc),this._triangleMesh.addData(Fd,Fe,Ff,FP._tmpMatrix,Fm,this),this._curSubmit._numEle+=Fn,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},Fb.transform=function(Fa,Fb,Fc,Fd,Fe,Ff){FZ.save(this),FB.mul(FB.TEMP.setTo(Fa,Fb,Fc,Fd,Fe,Ff),this._curMat,this._curMat),this._curMat._checkTransform()},Fb.setTransformByMatrix=function(Fa){Fa.copyTo(this._curMat)},Fb.transformByMatrix=function(Fa){FZ.save(this),FB.mul(Fa,this._curMat,this._curMat),this._curMat._checkTransform()},Fb.rotate=function(Fa){FZ.save(this),this._curMat.rotateEx(Fa)},Fb.scale=function(Fa,Fb){FZ.save(this),this._curMat.scaleEx(Fa,Fb)},Fb.clipRect=function(Fa,Fb,Fc,Fd){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var Fe=Fma.create(4);this.addRenderObject(Fe);var Ff=this._vb,Fg=Ff._byteLength>>2;if(Fsa.fillRectImgVb(Ff,null,Fa,Fb,Fc,Fd,FK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var Fh=this._curSubmit=Ffa.createSubmit(this,this._ib,Ff,(Ff._byteLength-64)/32*3,FAa.create(2,0));Fh.shaderValue.ALPHA=1,this._submits[this._submits._length++]=Fh,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var Fi=Fma.create(5);this.addRenderObject(Fi);var Fj=Ff.getFloat32Array(),Fm=Math.min(Math.min(Math.min(Fj[0+Fg],Fj[4+Fg]),Fj[8+Fg]),Fj[12+Fg]),Fn=Math.max(Math.max(Math.max(Fj[0+Fg],Fj[4+Fg]),Fj[8+Fg]),Fj[12+Fg]),Fo=Math.min(Math.min(Math.min(Fj[1+Fg],Fj[5+Fg]),Fj[9+Fg]),Fj[13+Fg]),Fp=Math.max(Math.max(Math.max(Fj[1+Fg],Fj[5+Fg]),Fj[9+Fg]),Fj[13+Fg]);FX.save(this,Fi,Fa,Fb,Fc,Fd,Fm,Fo,Fn-Fm,Fp-Fo),this._curSubmit=Ffa.RENDERBASE}else{Fc*=this._curMat.a,Fd*=this._curMat.d;var Fq=FC.TEMP;this._curMat.transformPoint(Fq.setTo(Fa,Fb)),Fc<0&&(Fq.x=Fq.x+Fc,Fc=-Fc),Fd<0&&(Fq.y=Fq.y+Fd,Fd=-Fd),this._renderKey=0;var Fr=this._curSubmit=Fja.create(this);(this._submits[this._submits._length++]=Fr).submitIndex=this._submits._length,Fr.submitLength=9999999,FW.save(this,Fr);var Fs=this._clipRect,Ft=Fs.x,Fu=Fs.y,Fv=Fq.x+Fc,Fw=Fq.y+Fd;Ft<Fq.x&&(Fs.x=Fq.x),Fu<Fq.y&&(Fs.y=Fq.y),Fs.width=Math.min(Fv,Ft+Fs.width)-Fs.x,Fs.height=Math.min(Fw,Fu+Fs.height)-Fs.y,this._shader2D.glTexture=null,Fr.clipRect.copyFrom(Fs),this._curSubmit=Ffa.RENDERBASE}},Fb.setIBVB=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm){if(void 0===Fi&&(Fi=0),void 0===Fj&&(Fj=0),void 0===Fm&&(Fm=0),null===Fc){if(Ft.isFlash){var Fn=Fd;Fn._selfIB||(Fn._selfIB=Fka.create(35044)),Fn._selfIB.clear(),Fc=Fn._selfIB}else Fc=this._ib;Fsa.expandIBQuadrangle(Fc,Fd._byteLength/(4*Fd.vertexStride*4))}if(!Fh||!Fg)throw Error("setIBVB must input:shader shaderValues");var Fo=Fia.create(this,Fd,Fc,Fe,Fg,Fh,Fi,Fj,Fm);Ff||(Ff=FB.EMPTY),Ff.translate(Fa,Fb),FB.mul(Ff,this._curMat,Fo._mat),Ff.translate(-Fa,-Fb),this._submits[this._submits._length++]=Fo,this._curSubmit=Ffa.RENDERBASE,this._renderKey=0},Fb.addRenderObject=function(Fa){this._submits[this._submits._length++]=Fa},Fb.fillTrangles=function(Fa,Fb,Fc,Fd,Fe){var Ff=this._curSubmit,Fg=this._vb,Fh=this._shader2D,Fi=Ff.shaderValue,Fj=Fd.length>>4,Fm=Fa.bitmap;this._renderKey=0,Fh.glTexture==Fm&&Fh.ALPHA===Fi.ALPHA||((Ff=this._curSubmit=Ffa.createSubmit(this,this._ib,Fg,Fg._byteLength/32*3,FAa.create(1,0))).shaderValue.textureHost=Fa,this._submits[this._submits._length++]=Ff),Fsa.fillTranglesVB(Fg,Fb,Fc,Fd,Fe||this._curMat,this._x,this._y),Ff._numEle+=6*Fj},Fb.submitElement=function(Fa,Fb){var Fc=this._submits;for(Fb<0&&(Fb=Fc._length);Fa<Fb;)Fa+=Fc[Fa].renderSubmit()},Fb.finish=function(){Fwa.mainContext.finish()},Fb.flush=function(){var Fa=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(Fa>this._ib.bufferLength/12&&Fsa.expandIBQuadrangle(this._ib,Fa),!this._isMain&&FQ.enabled&&FQ._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=FQ._atlasRestore;for(var Fb=this._submits,Fc=0,Fd=Fb._length;Fc<Fd;Fc++){var Fe=Fb[Fc];10016===Fe.getRenderType()&&Fe.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),Fba.instance&&Fba.getInstance().reset();var Ff;for(Fc=0,Ff=this.meshlist.length;Fc<Ff;Fc++){var Fg=this.meshlist[Fc];Fg.canReuse?Fg.releaseMesh():Fg.destroy()}return this.meshlist.length=0,this._curSubmit=Ffa.RENDERBASE,this._renderKey=0,this._triangleMesh=FKa.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},Fb.setPathId=function(Fa){if(this.mId=Fa,-1!=this.mId){this.mHaveKey=!1;var Fb=FM.getInstance();Fb.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,Fb.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},Fb.movePath=function(Fa,Fb){var Fc=Fa,Fd=Fb;Fa=this._curMat.a*Fc+this._curMat.c*Fd+this._curMat.tx,Fb=this._curMat.b*Fc+this._curMat.d*Fd+this._curMat.ty,this.mX+=Fa,this.mY+=Fb},Fb.beginPath=function(){var Fa=this._getPath();Fa.tempArray.length=0,Fa.closePath=!1,this.mX=0,this.mY=0},Fb.closePath=function(){this._path.closePath=!0},Fb.fill=function(Fa){void 0===Fa&&(Fa=!1);var Fb=this._getPath();this.drawPoly(0,0,Fb.tempArray,this.fillStyle._color.numColor,0,0,Fa)},Fb.stroke=function(){var Fa=this._getPath();if(0<this.lineWidth){if(-1==this.mId)Fa.drawLine(0,0,Fa.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var Fb=FM.getInstance().shapeLineDic[this.mId];Fb.rebuild(Fa.tempArray),Fa.setGeomtry(Fb)}else FM.getInstance().addLine(this.mId,Fa.drawLine(0,0,Fa.tempArray,this.lineWidth,this.strokeStyle._color.numColor));Fa.update();var Fc=[this.mX,this.mY],Fd=Ffa.createShape(this,Fa.ib,Fa.vb,Fa.count,Fa.offset,FAa.create(4,0));Fd.shaderValue.ALPHA=this._shader2D.ALPHA,Fd.shaderValue.u_pos=Fc,Fd.shaderValue.u_mmat2=Fua.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=Fd,this._renderKey=-1}},Fb.line=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=this._curSubmit,Fh=this._vb;if(Fsa.fillLineVb(Fh,this._clipRect,Fa,Fb,Fc,Fd,Fe,Ff)){this._renderKey=0;var Fi=this._shader2D,Fj=Fg.shaderValue;Fi.strokeStyle===Fj.strokeStyle&&Fi.ALPHA===Fj.ALPHA||(Fi.glTexture=null,(Fg=this._curSubmit=Ffa.createSubmit(this,this._ib,Fh,(Fh._byteLength-64)/32*3,FAa.create(2,0))).shaderValue.strokeStyle=Fi.strokeStyle,Fg.shaderValue.mainID=2,Fg.shaderValue.ALPHA=Fi.ALPHA,this._submits[this._submits._length++]=Fg),Fg._numEle+=6}},Fb.moveTo=function(Fa,Fb,Fc){void 0===Fc&&(Fc=!0);var Fd=this._getPath();if(Fc){var Fe=Fa,Ff=Fb;Fa=this._curMat.a*Fe+this._curMat.c*Ff,Fb=this._curMat.b*Fe+this._curMat.d*Ff}Fd.addPoint(Fa,Fb)},Fb.lineTo=function(Fa,Fb,Fc){void 0===Fc&&(Fc=!0);var Fd=this._getPath();if(Fc){var Fe=Fa,Ff=Fb;Fa=this._curMat.a*Fe+this._curMat.c*Ff,Fb=this._curMat.b*Fe+this._curMat.d*Ff}Fd.addPoint(Fa,Fb)},Fb.drawCurves=function(Fa,Fb,Fc){this.setPathId(-1),this.beginPath(),this.strokeStyle=Fc[3],this.lineWidth=Fc[4];var Fd=Fc[2];Fa+=Fc[0],Fb+=Fc[1],this.movePath(Fa,Fb),this.moveTo(Fd[0],Fd[1]);for(var Fe=2,Ff=Fd.length;Fe<Ff;)this.quadraticCurveTo(Fd[Fe++],Fd[Fe++],Fd[Fe++],Fd[Fe++]);this.stroke()},Fb.arcTo=function(Fa,Fb,Fc,Fd,Fe){if(-1==this.mId||!this.mHaveKey){var Ff=0,Fg=0,Fh=0,Fi=this._getPath();this._curMat.copyTo(FP._tmpMatrix),FP._tmpMatrix.tx=FP._tmpMatrix.ty=0,FP._tempPoint.setTo(Fi.getEndPointX(),Fi.getEndPointY()),FP._tmpMatrix.invertTransformPoint(FP._tempPoint);var Fj=FP._tempPoint.x-Fa,Fm=FP._tempPoint.y-Fb,Fn=Math.sqrt(Fj*Fj+Fm*Fm);if(!(Fn<=1e-6)){var Fo=Fj/Fn,Fp=Fm/Fn,Fq=Fc-Fa,Fr=Fd-Fb,Fs=Fq*Fq+Fr*Fr,Ft=Math.sqrt(Fs);if(!(Ft<=1e-6)){var Fu=Fq/Ft,Fv=Fr/Ft,Fw=Fo+Fu,Fx=Fp+Fv,Fy=Math.sqrt(Fw*Fw+Fx*Fx);if(!(Fy<=1e-6)){var Fz=Fw/Fy,FA=Fx/Fy,FB=Math.acos(Fz*Fo+FA*Fp),FC=Math.PI/2-FB,FD=(Fn=Fe/Math.tan(FC))*Fo+Fa,FE=Fn*Fp+Fb,FF=Math.sqrt(Fn*Fn+Fe*Fe),FG=Fa+Fz*FF,FH=Fb+FA*FF,FI=0,FJ=0;if(0<=Fo*Fv-Fp*Fu){var FK=2*FC/FP.SEGNUM;FI=Math.sin(FK),FJ=Math.cos(FK)}else FK=2*-FC/FP.SEGNUM,FI=Math.sin(FK),FJ=Math.cos(FK);Fg=this._curMat.a*FD+this._curMat.c*FE,Fh=this._curMat.b*FD+this._curMat.d*FE,Fg==this._path.getEndPointX()&&Fh==this._path.getEndPointY()||Fi.addPoint(Fg,Fh);var FL=FD-FG,FM=FE-FH;for(Ff=0;Ff<FP.SEGNUM;Ff++){var FN=FL*FJ+FM*FI,FO=-FL*FI+FM*FJ;Fg=FN+FG,Fh=FO+FH,Fa=this._curMat.a*Fg+this._curMat.c*Fh,Fh=Fb=this._curMat.b*Fg+this._curMat.d*Fh,(Fg=Fa)==this._path.getEndPointX()&&Fh==this._path.getEndPointY()||Fi.addPoint(Fg,Fh),FL=FN,FM=FO}}}}}},Fb.arc=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){if(void 0===Ff&&(Ff=!1),void 0===Fg&&(Fg=!0),-1!=this.mId){var Fh=FM.getInstance().shapeDic[this.mId];if(Fh&&this.mHaveKey&&!Fh.needUpdate(this._curMat))return;Fb=Fa=0}var Fi,Fj=0,Fm=0,Fn=0,Fo=0,Fp=0,Fq=0,Fr=0;if(Fm=Fe-Fd,Ff)if(Math.abs(Fm)>=2*Math.PI)Fm=2*-Math.PI;else for(;0<Fm;)Fm-=2*Math.PI;else if(Math.abs(Fm)>=2*Math.PI)Fm=2*Math.PI;else for(;Fm<0;)Fm+=2*Math.PI;Fi=Fm/(Fr=Fc<101?Math.max(10,Fm*Fc/5):Fc<201?Math.max(10,Fm*Fc/20):Math.max(10,Fm*Fc/40))/2,Fn=Math.abs(4/3*(1-Math.cos(Fi))/Math.sin(Fi)),Ff&&(Fn=-Fn);var Fs=this._getPath(),Ft=NaN,Fu=NaN;for(Fq=0;Fq<=Fr;Fq++)Fj=Fd+Fm*(Fq/Fr),Fo=Fa+Math.cos(Fj)*Fc,Fp=Fb+Math.sin(Fj)*Fc,Fg&&(Ft=Fo,Fu=Fp,Fo=this._curMat.a*Ft+this._curMat.c*Fu,Fp=this._curMat.b*Ft+this._curMat.d*Fu),Fo==this._path.getEndPointX()&&Fp==this._path.getEndPointY()||Fs.addPoint(Fo,Fp);Fo=Fa+Math.cos(Fe)*Fc,Fp=Fb+Math.sin(Fe)*Fc,Fg&&(Ft=Fo,Fu=Fp,Fo=this._curMat.a*Ft+this._curMat.c*Fu,Fp=this._curMat.b*Ft+this._curMat.d*Fu),Fo==this._path.getEndPointX()&&Fp==this._path.getEndPointY()||Fs.addPoint(Fo,Fp)},Fb.quadraticCurveTo=function(Fa,Fb,Fc,Fd){var Fe=Fn.I,Ff=Fc,Fg=Fd;Fc=this._curMat.a*Ff+this._curMat.c*Fg,Fd=this._curMat.b*Ff+this._curMat.d*Fg,Ff=Fa,Fg=Fb,Fa=this._curMat.a*Ff+this._curMat.c*Fg,Fb=this._curMat.b*Ff+this._curMat.d*Fg;for(var Fh=Fe.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),Fa,Fb,Fc,Fd],30,2),Fi=0,Fj=Fh.length/2;Fi<Fj;Fi++)this.lineTo(Fh[2*Fi],Fh[2*Fi+1],!1);this.lineTo(Fc,Fd,!1)},Fb.rect=function(Fa,Fb,Fc,Fd){this._other=this._other.make(),this._other.path||(this._other.path=new FU),this._other.path.rect(Fa,Fb,Fc,Fd)},Fb.strokeRect=function(Fa,Fb,Fc,Fd,Fe){var Ff=.5*Fe;this.line(Fa-Ff,Fb,Fa+Fc+Ff,Fb,Fe,this._curMat),this.line(Fa+Fc,Fb,Fa+Fc,Fb+Fd,Fe,this._curMat),this.line(Fa,Fb,Fa,Fb+Fd,Fe,this._curMat),this.line(Fa-Ff,Fb+Fd,Fa+Fc+Ff,Fb+Fd,Fe,this._curMat)},Fb.clip=function(){},Fb.drawPoly=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){void 0===Fg&&(Fg=!1),this._renderKey=0,this._shader2D.glTexture=null;var Fh=this._getPath();if(-1==this.mId)Fh.polygon(Fa,Fb,Fc,Fd,Fe||1,Ff);else if(this.mHaveKey){var Fi=FM.getInstance().shapeDic[this.mId];Fi.setMatrix(this._curMat),Fi.rebuild(Fh.tempArray),Fh.setGeomtry(Fi)}else{var Fj=Fh.polygon(Fa,Fb,Fc,Fd,Fe||1,Ff);FM.getInstance().addShape(this.mId,Fj),Fj.setMatrix(this._curMat)}Fh.update();var Fm,Fn=[this.mX,this.mY];if((Fm=Ffa.createShape(this,Fh.ib,Fh.vb,Fh.count,Fh.offset,FAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Fm.shaderValue.u_pos=Fn,Fm.shaderValue.u_mmat2=Fua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Fm,0<Fe){if(this.mHaveLineKey){var Fo=FM.getInstance().shapeLineDic[this.mId];Fo.rebuild(Fh.tempArray),Fh.setGeomtry(Fo)}else FM.getInstance().addShape(this.mId,Fh.drawLine(Fa,Fb,Fc,Fe,Ff));Fh.update(),(Fm=Ffa.createShape(this,Fh.ib,Fh.vb,Fh.count,Fh.offset,FAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Fm.shaderValue.u_mmat2=Fua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Fm}},Fb.drawParticle=function(Fa,Fb,Fc){Fc.x=Fa,Fc.y=Fb,this._submits[this._submits._length++]=Fc},Fb._getPath=function(){return this._path||(this._path=new FU)},Fd(0,Fb,"globalCompositeOperation",function(){return FS.NAMES[this._nBlendType]},function(Fa){var Fb=FS.TOINT[Fa];null==Fb||this._nBlendType===Fb||(FV.save(this,65536,this,!0),this._curSubmit=Ffa.RENDERBASE,this._renderKey=0,this._nBlendType=Fb)}),Fd(0,Fb,"strokeStyle",function(){return this._shader2D.strokeStyle},function(Fa){this._shader2D.strokeStyle.equal(Fa)||(FV.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=FT.create(Fa))}),Fd(0,Fb,"globalAlpha",function(){return this._shader2D.ALPHA},function(Fa){(Fa=Math.floor(1e3*Fa)/1e3)!=this._shader2D.ALPHA&&(FV.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=Fa)}),Fd(0,Fb,"asBitmap",null,function(Fa){if(Fa){if(this._targets||(this._targets=new F_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),Fd(0,Fb,"fillStyle",function(){return this._shader2D.fillStyle},function(Fa){this._shader2D.fillStyle.equal(Fa)||(FV.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=FT.create(Fa))}),Fd(0,Fb,"textAlign",function(){return this._other.textAlign},function(Fa){this._other.textAlign===Fa||(this._other=this._other.make(),FV.save(this,32768,this._other,!1),this._other.textAlign=Fa)}),Fd(0,Fb,"lineWidth",function(){return this._other.lineWidth},function(Fa){this._other.lineWidth===Fa||(this._other=this._other.make(),FV.save(this,256,this._other,!1),this._other.lineWidth=Fa)}),Fd(0,Fb,"textBaseline",function(){return this._other.textBaseline},function(Fa){this._other.textBaseline===Fa||(this._other=this._other.make(),FV.save(this,16384,this._other,!1),this._other.textBaseline=Fa)}),Fd(0,Fb,"font",null,function(Fa){Fa!=this._other.font.toString()&&(this._other=this._other.make(),FV.save(this,8,this._other,!1),this._other.font===Fqa.EMPTY?this._other.font=new Fqa(Fa):this._other.font.setFont(Fa))}),FP.__init__=function(){Fc.DEFAULT=new Fc},FP._tempPoint=new FC,FP._SUBMITVBSIZE=32e3,FP._MAXSIZE=99999999,FP._RECTVBSIZE=16,FP.MAXCLIPRECT=new FD(0,0,99999999,99999999),FP._COUNT=0,FP._tmpMatrix=new FB,FP.SEGNUM=32,FP._contextcount=0,Fg(FP,["_fontTemp",function(){return this._fontTemp=new Fqa},"_drawStyleTemp",function(){return this._drawStyleTemp=new FT(null)}]),FP.__init$=function(){Fc=function(){function Fa(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=Fqa.EMPTY}Fo(Fa,"");var Fb=Fa.prototype;return Fb.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=Fqa.EMPTY},Fb.make=function(){return this===Fa.DEFAULT?new Fa:this},Fa.DEFAULT=null,Fa}()},FP}(),FAa=function(Fa){function Fd(Fa,Fb){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,Fd.__super.call(this),this.defines=new FEa,this.position=Fd._POSITION,this.mainID=Fa,this.subID=Fb,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=Fa|Fb,this._inClassCache=Fd._cache[this._cacheID],0<Fa&&!this._inClassCache&&(this._inClassCache=Fd._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}Fo(Fd,"laya.webgl.shader.d2.value.Value2D",FO);var Fb=Fd.prototype;return Fb.setValue=function(Fa){},Fb.refresh=function(){var Fa=this.size;return Fa[0]=Fua.width,Fa[1]=Fua.height,this.alpha=this.ALPHA*Fua.worldAlpha,this.mmat=Fua.worldMatrix4,this},Fb._ShaderWithCompile=function(){return FYa.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,F_a.create)},Fb._withWorldShaderDefines=function(){var Fa=Fua.worldShaderDefines,Fb=FYa.sharders[this.mainID|this.defines._value|Fa.getValue()];if(!Fb){var Fc,Fd={};for(Fc in this.defines.toNameDic())Fd[Fc]="";for(Fc in Fa.toNameDic())Fd[Fc]="";Fb=FYa.withCompile2D(0,this.mainID,Fd,this.mainID|this.defines._value|Fa.getValue(),F_a.create)}var Fe=Fua.worldFilters;if(!Fe)return Fb;for(var Ff,Fg=Fe.length,Fh=0;Fh<Fg;Fh++)(Ff=Fe[Fh])&&Ff.action.setValue(this);return Fb},Fb.upload=function(){var Fa=Fua;this.alpha=this.ALPHA*Fa.worldAlpha,Fua.worldMatrix4!==Fua.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),Fwa.shaderHighPrecision&&this.defines.add(1024);var Fb,Fc=Fa.worldShaderDefines?this._withWorldShaderDefines():FYa.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=Fa.width,this.size[1]=Fa.height,this.mmat=Fa.worldMatrix4,FLa.activeShader!==Fc?Fc._shaderValueWidth!==Fa.width||Fc._shaderValueHeight!==Fa.height?(Fc._shaderValueWidth=Fa.width,Fc._shaderValueHeight=Fa.height):Fb=Fc._params2dQuick2||Fc._make2dQuick2():Fc._shaderValueWidth!==Fa.width||Fc._shaderValueHeight!==Fa.height?(Fc._shaderValueWidth=Fa.width,Fc._shaderValueHeight=Fa.height):Fb=Fc._params2dQuick1||Fc._make2dQuick1(),Fc.upload(this,Fb)},Fb.setFilters=function(Fa){if(this.filters=Fa)for(var Fb,Fc=Fa.length,Fd=0;Fd<Fc;Fd++)(Fb=Fa[Fd])&&(this.defines.add(Fb.type),Fb.action.setValue(this))},Fb.clear=function(){this.defines.setValue(this.subID)},Fb.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},Fd._initone=function(Fa,Fb){Fd._typeClass[Fa]=Fb,Fd._cache[Fa]=[],Fd._cache[Fa]._length=0},Fd.__init__=function(){Fd._POSITION=[2,5126,!1,4*Fra.BYTES_PE,0],Fd._TEXCOORD=[2,5126,!1,4*Fra.BYTES_PE,2*Fra.BYTES_PE],Fd._initone(2,FPa),Fd._initone(4,FSa),Fd._initone(256,FQa),Fd._initone(512,FOa),Fd._initone(1,FRa),Fd._initone(65,F$a),Fd._initone(9,FRa)},Fd.create=function(Fa,Fb){var Fc=Fd._cache[Fa|Fb];return Fc._length?Fc[--Fc._length]:new Fd._typeClass[Fa|Fb](Fb)},Fd._POSITION=null,Fd._TEXCOORD=null,Fd._cache=[],Fd._typeClass=[],Fd.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fd}(),FBa=function(Fa){function Fs(Fa,Fb){Fs.__super.call(this,Fa,Fb)}Fo(Fs,"laya.webgl.utils.RenderSprite3D",Fu);var Fb=Fs.prototype;return Fb.onCreate=function(Fa){switch(Fa){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},Fb._mask=function(Fa,Fb,Fc,Fd){var Fe,Ff,Fg=this._next,Fh=Fa.mask;if(Fh){Fb.ctx.save();var Fi=Fb.ctx.globalCompositeOperation,Fj=new FD;if(Fj.copyFrom(Fh.getBounds()),Fj.width=Math.round(Fj.width),Fj.height=Math.round(Fj.height),Fj.x=Math.round(Fj.x),Fj.y=Math.round(Fj.y),0<Fj.width&&0<Fj.height){var Fm=Fa._style._tf,Fn=Fha.create();Fn.addValue("bounds",Fj),Fe=Fga.create([Fn,Fb],laya.webgl.utils.RenderSprite3D.tmpTarget),Fb.addRenderObject(Fe),Fh.render(Fb,-Fj.x,-Fj.y),Fe=Fga.create([Fn],laya.webgl.utils.RenderSprite3D.endTmpTarget),Fb.addRenderObject(Fe),Fb.ctx.save(),Fb.clipRect(Fc-Fm.translateX+Fj.x,Fd-Fm.translateY+Fj.y,Fj.width,Fj.height),Fg._fun.call(Fg,Fa,Fb,Fc,Fd),Fb.ctx.restore(),Ff=Fma.create(6),Fi=Fb.ctx.globalCompositeOperation,Ff.blendMode="mask",Fb.addRenderObject(Ff),FB.TEMP.identity();var Fo=FAa.create(1,0),Fp=FK.INV_UV,Fq=Fj.width,Fr=Fj.height;(Fj.width<32||Fj.height<32)&&((Fp=Fs.tempUV)[0]=0,Fp[1]=0,Fp[2]=32<=Fj.width?1:Fj.width/32,Fp[3]=0,Fp[4]=32<=Fj.width?1:Fj.width/32,Fp[5]=32<=Fj.height?1:Fj.height/32,Fp[6]=0,Fp[7]=32<=Fj.height?1:Fj.height/32,Fj.width=32<=Fj.width?Fj.width:32,Fj.height=32<=Fj.height?Fj.height:32,Fp[1]*=-1,Fp[3]*=-1,Fp[5]*=-1,Fp[7]*=-1,Fp[1]+=1,Fp[3]+=1,Fp[5]+=1,Fp[7]+=1),Fb.ctx.drawTarget(Fn,Fc+Fj.x-Fm.translateX,Fd+Fj.y-Fm.translateY,Fq,Fr,FB.TEMP,"tmpTarget",Fo,Fp,6),Fe=Fga.create([Fn],laya.webgl.utils.RenderSprite3D.recycleTarget),Fb.addRenderObject(Fe),(Ff=Fma.create(6)).blendMode=Fi,Fb.addRenderObject(Ff)}Fb.ctx.restore()}else Fg._fun.call(Fg,Fa,Fb,Fc,Fd)},Fb._blend=function(Fa,Fb,Fc,Fd){var Fe=Fa._style,Ff=this._next;Fe.blendMode?(Fb.ctx.save(),Fb.ctx.globalCompositeOperation=Fe.blendMode,Ff._fun.call(Ff,Fa,Fb,Fc,Fd),Fb.ctx.restore()):Ff._fun.call(Ff,Fa,Fb,Fc,Fd)},Fb._transform=function(Fa,Fb,Fc,Fd){var Fe=Fa.transform,Ff=this._next;if(Fe&&Ff!=Fu.NORENDER){var Fg=Fb.ctx;Fa._style;Fe.tx=Fc,Fe.ty=Fd;var Fh=Fg._getTransformMatrix(),Fi=Fh.clone();FB.mul(Fe,Fh,Fh),Fh._checkTransform(),Fe.tx=Fe.ty=0,Ff._fun.call(Ff,Fa,Fb,0,0),Fi.copyTo(Fh),Fi.destroy()}else Ff._fun.call(Ff,Fa,Fb,Fc,Fd)},Fs.tmpTarget=function(Fa,Fb){var Fc=Fa.getValue("bounds"),Fd=FMa.create(Fc.width,Fc.height);Fd.start(),Fd.clear(0,0,0,0),Fa.addValue("tmpTarget",Fd)},Fs.endTmpTarget=function(Fa){Fa.getValue("tmpTarget").end()},Fs.recycleTarget=function(Fa){Fa.getValue("tmpTarget").recycle(),Fa.recycle()},Fg(Fs,["tempUV",function(){return this.tempUV=new Array(8)}]),Fs}(),FCa=function(Fa){function Fb(){this.data=null,Fb.__super.call(this)}Fo(Fb,"laya.filters.webgl.ColorFilterActionGL",FN);var Fc=Fb.prototype;return Fy.imps(Fc,{"laya.filters.IFilterActionGL":!0}),Fc.setValue=function(Fa){Fa.colorMat=this.data._mat,Fa.colorAlpha=this.data._alpha},Fc.apply3d=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fa.getValue("bounds"),Fg=FAa.create(1,0);Fg.setFilters([this.data]);var Fh=FB.TEMP;Fh.identity(),Fc.ctx.drawTarget(Fa,0,0,Ff.width,Ff.height,Fh,"src",Fg)},Fb}(),FDa=function(Fa){function Ff(Fa,Fb,Fc,Fd,Fe){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,Ff.__super.call(this,Fa,Fb,Fe),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new FTa,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=Fc,this._atlasCanvas.height=Fd,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}Fo(Ff,"laya.webgl.atlas.Atlaser",FP);var Fb=Ff.prototype;return Fb.computeUVinAtlasTexture=function(Fa,Fb,Fc,Fd){var Fe=FQ.atlasTextureWidth,Ff=FQ.atlasTextureHeight,Fg=Fc/Fe,Fh=Fd/Ff,Fi=(Fc+Fa.bitmap.width)/Fe,Fj=(Fd+Fa.bitmap.height)/Ff,Fm=Fa.bitmap.width/Fe,Fn=Fa.bitmap.height/Ff;Fa.uv=[Fg+Fb[0]*Fm,Fh+Fb[1]*Fn,Fi-(1-Fb[2])*Fm,Fh+Fb[3]*Fn,Fi-(1-Fb[4])*Fm,Fj-(1-Fb[5])*Fn,Fg+Fb[6]*Fm,Fj-(1-Fb[7])*Fn]},Fb.findBitmapIsExist=function(Fa){if(Fa instanceof laya.webgl.resource.WebGLImage){var Fb=Fa,Fc=Fb.url,Fd=this._InAtlasWebGLImagesKey[Fc||Fb.id];if(Fd)return Fd.offsetInfoID}return-1},Fb.addToAtlasTexture=function(Fa,Fb,Fc){if(Fa instanceof laya.webgl.resource.WebGLImage){var Fd=Fa,Fe=Fd.url;this._InAtlasWebGLImagesKey[Fe||Fd.id]={bitmap:Fa,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([Fb,Fc])}this._atlasCanvas.texSubImage2D(Fb,Fc,Fa.atlasSource),Fa.clearAtlasSource()},Fb.addToAtlas=function(Fa,Fb,Fc){Fa._atlasID=this._inAtlasTextureKey.length;var Fd=Fa.uv.slice(),Fe=Fa.bitmap;this._inAtlasTextureKey.push(Fa),this._inAtlasTextureOriUVValue.push(Fd),this._inAtlasTextureBitmapValue.push(Fe),this.computeUVinAtlasTexture(Fa,Fd,Fb,Fc),Fa.bitmap=this._atlasCanvas},Fb.clear=function(){for(var Fa=0,Fb=this._inAtlasTextureKey.length;Fa<Fb;Fa++)this._inAtlasTextureKey[Fa].bitmap=this._inAtlasTextureBitmapValue[Fa],this._inAtlasTextureKey[Fa].uv=this._inAtlasTextureOriUVValue[Fa],this._inAtlasTextureKey[Fa]._atlasID=-1,this._inAtlasTextureKey[Fa].bitmap.lock=!1,this._inAtlasTextureKey[Fa].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},Fb.dispose=function(){this.clear(),this._atlasCanvas.destroy()},Fd(0,Fb,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),Fd(0,Fb,"texture",function(){return this._atlasCanvas}),Fd(0,Fb,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),Ff}(),FEa=function(Fa){function Fc(){Fc.__super.call(this,Fc.__name2int,Fc.__int2name,Fc.__int2nameMap)}return Fo(Fc,"laya.webgl.shader.d2.ShaderDefines2D",Fl),Fc.__init__=function(){Fc.reg("TEXTURE2D",1),Fc.reg("COLOR2D",2),Fc.reg("PRIMITIVE",4),Fc.reg("GLOW_FILTER",8),Fc.reg("BLUR_FILTER",16),Fc.reg("COLOR_FILTER",32),Fc.reg("COLOR_ADD",64),Fc.reg("WORLDMAT",128),Fc.reg("FILLTEXTURE",256),Fc.reg("FSHIGHPRECISION",1024),Fc.reg("TXTALPHA",2048),Fc.reg("TXTCOMPRESS",4096)},Fc.reg=function(Fa,Fb){Fl._reg(Fa,Fb,Fc.__name2int,Fc.__int2name)},Fc.toText=function(Fa,Fb,Fc){return Fl._toText(Fa,Fb,Fc)},Fc.toInt=function(Fa){return Fl._toInt(Fa,Fc.__name2int)},Fc.TEXTURE2D=1,Fc.COLOR2D=2,Fc.PRIMITIVE=4,Fc.FILTERGLOW=8,Fc.FILTERBLUR=16,Fc.FILTERCOLOR=32,Fc.COLORADD=64,Fc.WORLDMAT=128,Fc.FILLTEXTURE=256,Fc.SKINMESH=512,Fc.SHADERDEFINE_FSHIGHPRECISION=1024,Fc.TXTALPHA=2048,Fc.TXTCOMPRESS=4096,Fc.__name2int={},Fc.__int2name=[],Fc.__int2nameMap=[],Fc}(),FFa=(function(Fa){function Fh(Fa,Fb,Fc,Fd,Fe,Ff,Fg){Fh.__super.call(this,Fa,Fb,Fc,Fd,40,Fe,Ff,Fg)}Fo(Fh,"laya.webgl.shapes.Ellipse",Fca)}(),function(Fa){function Ff(Fa,Fb,Fc,Fd,Fe){this._points=[],this.rebuild(Fc),Ff.__super.call(this,Fa,Fb,0,0,0,Fe,Fd,Fe,0)}Fo(Ff,"laya.webgl.shapes.Line",Fca);var Fb=Ff.prototype;return Fb.rebuild=function(Fa){var Fb=Fa.length;Fb!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(Fb/2-1)),this.mFloat32Array=new Float32Array(5*Fb)),this._points.length=0;for(var Fc=NaN,Fd=NaN,Fe=-1,Ff=-1,Fg=Fa.length/2,Fh=0;Fh<Fg;Fh++)Fc=Fa[2*Fh],Fd=Fa[2*Fh+1],(.01<Math.abs(Fe-Fc)||.01<Math.abs(Ff-Fd))&&this._points.push(Fc,Fd),Fe=Fc,Ff=Fd},Fb.getData=function(Fa,Fb,Fc){var Fd=[],Fe=[];0<this.borderWidth&&this.createLine2(this._points,Fd,this.borderWidth,Fc,Fe,this._points.length/2),this.mUint16Array.set(Fd,0),this.mFloat32Array.set(Fe,0),Fa.append(this.mUint16Array),Fb.append(this.mFloat32Array)},Ff}()),FGa=function(Fa){function Fn(Fa,Fb,Fc,Fd,Fe){this._points=[];for(var Ff=NaN,Fg=NaN,Fh=-1,Fi=-1,Fj=Fc.length/2-1,Fm=0;Fm<Fj;Fm++)Ff=Fc[2*Fm],Fg=Fc[2*Fm+1],(.01<Math.abs(Fh-Ff)||.01<Math.abs(Fi-Fg))&&this._points.push(Ff,Fg),Fh=Ff,Fi=Fg;Ff=Fc[2*Fj],Fg=Fc[2*Fj+1],Fh=this._points[0],Fi=this._points[1],(.01<Math.abs(Fh-Ff)||.01<Math.abs(Fi-Fg))&&this._points.push(Ff,Fg),Fn.__super.call(this,Fa,Fb,0,0,this._points.length/2,0,Fd,Fe)}Fo(Fn,"laya.webgl.shapes.LoopLine",Fca);var Fb=Fn.prototype;return Fb.getData=function(Fa,Fb,Fc){if(0<this.borderWidth){for(var Fd=this.color,Fe=(Fd>>16&255)/255,Ff=(Fd>>8&255)/255,Fg=(255&Fd)/255,Fh=[],Fi=0,Fj=0,Fm=[],Fn=Math.floor(this._points.length/2),Fo=0;Fo<Fn;Fo++)Fi=this._points[2*Fo],Fj=this._points[2*Fo+1],Fh.push(this.x+Fi,this.y+Fj,Fe,Ff,Fg);this.createLoopLine(Fh,Fm,this.borderWidth,Fc+Fh.length/5),Fa.append(new Uint16Array(Fm)),Fb.append(new Float32Array(Fh))}},Fb.createLoopLine=function(Fa,Fb,Fc,Fd,Fe,Ff){Fa.length;var Fg=Fa.concat(),Fh=Fe||Fa,Fi=this.borderColor,Fj=(Fi>>16&255)/255,Fm=(Fi>>8&255)/255,Fn=(255&Fi)/255,Fo=[Fg[0],Fg[1]],Fp=[Fg[Fg.length-5],Fg[Fg.length-4]],Fq=Fp[0]+.5*(Fo[0]-Fp[0]),Fr=Fp[1]+.5*(Fo[1]-Fp[1]);Fg.unshift(Fq,Fr,0,0,0),Fg.push(Fq,Fr,0,0,0);var Fs,Ft,Fu,Fv,Fw,Fx,Fy,Fz,FA,FB,FC,FD,FE,FF,FG,FH,FI,FJ,FK,FL,FM=Fg.length/5,FN=Fd,FO=Fc/2;Fu=Fg[0],Fv=Fg[1],FB=Fu-(Fw=Fg[5]),FA=(FA=-(Fv-(Fx=Fg[6])))/(FL=Math.sqrt(FA*FA+FB*FB))*FO,FB=FB/FL*FO,Fh.push(Fu-FA,Fv-FB,Fj,Fm,Fn,Fu+FA,Fv+FB,Fj,Fm,Fn);for(var FP=1;FP<FM-1;FP++)Fu=Fg[5*(FP-1)],Fv=Fg[5*(FP-1)+1],Fw=Fg[5*FP],Fx=Fg[5*FP+1],Fy=Fg[5*(FP+1)],Fz=Fg[5*(FP+1)+1],FB=Fu-Fw,FD=Fw-Fy,FG=(-(FA=(FA=-(Fv-Fx))/(FL=Math.sqrt(FA*FA+FB*FB))*FO)+Fu)*(-(FB=FB/FL*FO)+Fx)-(-FA+Fw)*(-FB+Fv),FJ=(-(FC=(FC=-(Fx-Fz))/(FL=Math.sqrt(FC*FC+FD*FD))*FO)+Fy)*(-(FD=FD/FL*FO)+Fx)-(-FC+Fw)*(-FD+Fz),FK=(FE=-FB+Fv-(-FB+Fx))*(FI=-FC+Fw-(-FC+Fy))-(FH=-FD+Fz-(-FD+Fx))*(FF=-FA+Fw-(-FA+Fu)),Math.abs(FK)<.1?(FK+=10.1,Fh.push(Fw-FA,Fx-FB,Fj,Fm,Fn,Fw+FA,Fx+FB,Fj,Fm,Fn)):(((Fs=(FF*FJ-FI*FG)/FK)-Fw)*(Fs-Fw)+((Ft=(FH*FG-FE*FJ)/FK)-Fx)+(Ft-Fx),Fh.push(Fs,Ft,Fj,Fm,Fn,Fw-(Fs-Fw),Fx-(Ft-Fx),Fj,Fm,Fn));Ff&&(Fb=Ff);var FQ=this.edges+1;for(FP=1;FP<FQ;FP++)Fb.push(FN+2*(FP-1),FN+2*(FP-1)+1,FN+2*FP+1,FN+2*FP+1,FN+2*FP,FN+2*(FP-1));return Fb.push(FN+2*(FP-1),FN+2*(FP-1)+1,FN+1,FN+1,FN,FN+2*(FP-1)),Fh},Fn}(),FHa=function(Fa){function Fg(Fa,Fb,Fc,Fd,Fe,Ff){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=FB.create(),this._points=Fc.slice(0,Fc.length),Fg.__super.call(this,Fa,Fb,0,0,this._points.length/2,Fd,Fe,Ff)}Fo(Fg,"laya.webgl.shapes.Polygon",Fca);var Fb=Fg.prototype;return Fb.rebuild=function(Fa){this._repaint||(this._points.length=0,this._points=this._points.concat(Fa))},Fb.setMatrix=function(Fa){Fa.copyTo(this._mat)},Fb.needUpdate=function(Fa){return this._repaint=this._mat.a==Fa.a&&this._mat.b==Fa.b&&this._mat.c==Fa.c&&this._mat.d==Fa.d&&this._mat.tx==Fa.tx&&this._mat.ty==Fa.ty,!this._repaint},Fb.getData=function(Fa,Fb,Fc){var Fd,Fe=0,Ff=this._points,Fg=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=Fc){for(this._start=Fc,Fd=[],Fg=this.earcutTriangles.length,Fe=0;Fe<Fg;Fe++)Fd.push(this.earcutTriangles[Fe]+Fc);this.mUint16Array=new Uint16Array(Fd)}}else{this._start=Fc,Fd=[];var Fh=[],Fi=[],Fj=this.color,Fm=(Fj>>16&255)/255,Fn=(Fj>>8&255)/255,Fo=(255&Fj)/255;for(Fg=Math.floor(Ff.length/2),Fe=0;Fe<Fg;Fe++)Fh.push(this.x+Ff[2*Fe],this.y+Ff[2*Fe+1],Fm,Fn,Fo),Fi.push(this.x+Ff[2*Fe],this.y+Ff[2*Fe+1]);for(this.earcutTriangles=Fda.earcut(Fi,null,2),Fg=this.earcutTriangles.length,Fe=0;Fe<Fg;Fe++)Fd.push(this.earcutTriangles[Fe]+Fc);this.mUint16Array=new Uint16Array(Fd),this.mFloat32Array=new Float32Array(Fh)}Fa.append(this.mUint16Array),Fb.append(this.mFloat32Array)},Fg}(),FIa=function(Fa){function Ff(){this._matrix=new FB,this._matrix4=Fra.defaultMatrix4.concat(),Ff.__super.call(this,1e4),this.shaderValue=new FAa(0,0)}Fo(Ff,"laya.webgl.submit.SubmitCanvas",Ffa);var Fb=Ff.prototype;return Fb.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var Fa=Fua.worldAlpha,Fb=Fua.worldMatrix4,Fc=Fua.worldMatrix,Fd=Fua.worldFilters,Fe=Fua.worldShaderDefines,Ff=this.shaderValue,Fg=this._matrix,Fh=this._matrix4,Fi=FB.TEMP;return FB.mul(Fg,Fc,Fi),Fh[0]=Fi.a,Fh[1]=Fi.b,Fh[4]=Fi.c,Fh[5]=Fi.d,Fh[12]=Fi.tx,Fh[13]=Fi.ty,Fua.worldMatrix=Fi.clone(),Fua.worldMatrix4=Fh,Fua.worldAlpha=Fua.worldAlpha*Ff.alpha,Ff.filters&&Ff.filters.length&&(Fua.worldFilters=Ff.filters,Fua.worldShaderDefines=Ff.defines),this._ctx_src.flush(),Fua.worldAlpha=Fa,Fua.worldMatrix4=Fb,Fua.worldMatrix.destroy(),Fua.worldMatrix=Fc,Fua.worldFilters=Fd,Fua.worldShaderDefines=Fe,1},Fb.releaseRender=function(){var Fa=Ff._cache;this._ctx_src=null,Fa[Fa._length++]=this},Fb.getRenderType=function(){return 10003},Ff.create=function(Fa,Fb,Fc){var Fd=Ff._cache._length?Ff._cache[--Ff._cache._length]:new Ff;Fd._ctx_src=Fa;var Fe=Fd.shaderValue;return Fe.alpha=Fb,Fe.defines.setValue(0),Fc&&Fc.length&&Fe.setFilters(Fc),Fd},Ff._cache=((Ff._cache=[])._length=0,Ff._cache),Ff}(),FJa=function(Fa){function Fj(Fa){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===Fa&&(Fa=1e4),Fj.__super.call(this,Fa)}Fo(Fj,"laya.webgl.submit.SubmitTexture",Ffa);var Fb=Fj.prototype;return Fb.releaseRender=function(){var Fa=Fj._cache;(Fa[Fa._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},Fb.addTexture=function(Fa,Fb){this._texsID[this._texs.length]=Fa._uvID,this._texs.push(Fa),this._vbPos.push(Fb)},Fb.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var Fa=this.shaderValue.textureHost.bitmap;if(null!==Fa)for(var Fb=this._vb.getFloat32Array(),Fc=0,Fd=this._texs.length;Fc<Fd;Fc++){var Fe=this._texs[Fc];Fe.active();var Ff=Fe.uv;if(this._texsID[Fc]!==Fe._uvID){this._texsID[Fc]=Fe._uvID;var Fg=this._vbPos[Fc];Fb[Fg+2]=Ff[0],Fb[Fg+3]=Ff[1],Fb[Fg+6]=Ff[2],Fb[Fg+7]=Ff[3],Fb[Fg+10]=Ff[4],Fb[Fg+11]=Ff[5],Fb[Fg+14]=Ff[6],Fb[Fg+15]=Ff[7],this._vb.setNeedUpload()}Fe.bitmap!==Fa&&(this._isSameTexture=!1)}}},Fb.renderSubmit=function(){if(0===this._numEle)return Fj._shaderSet=!1,1;var Fa=this.shaderValue.textureHost;if(Fa){var Fb=Fa.source;if(!Fa.bitmap||!Fb)return Fj._shaderSet=!1,1;this.shaderValue.texture=Fb,Fa.alphaTexture&&Fa.alphaTexture.source&&(this.shaderValue.texture1=Fa.alphaTexture.source)}this._vb.bind_upload(this._ib);var Fc=Fwa.mainContext;if(FS.activeBlendFunction!==this._blendFn&&(Fc.enable(3042),this._blendFn(Fc),FS.activeBlendFunction=this._blendFn),FG.drawCall++,FG.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&FLa.activeShader&&Fj._shaderSet?(FLa.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&FLa.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),Fj._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var Fd=Fa.bitmap,Fe=0,Ff=FLa.activeShader,Fg=0,Fh=this._texs.length;Fg<Fh;Fg++){var Fi=this._texs[Fg];Fi.bitmap===Fd&&Fg+1!==Fh||(Ff.uploadTexture2D(Fi.source),Fc.drawElements(4,6*(Fg-Fe+1),5123,this._startIdx+6*Fe*Fra.BYTES_PIDX),Fd=Fi.bitmap,Fe=Fg)}else Fc.drawElements(4,this._numEle,5123,this._startIdx);return 1},Fj.create=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fj._cache._length?Fj._cache[--Fj._cache._length]:new Fj;null==Fc&&((Fc=Ff._selfVb||(Ff._selfVb=Fla.create(-1))).clear(),Fd=0),Ff._ib=Fb,Ff._vb=Fc,Ff._startIdx=Fd*Fra.BYTES_PIDX,Ff._numEle=0;var Fg=Fa._nBlendType;Ff._blendFn=Fa._targets?FS.targetFns[Fg]:FS.fns[Fg],Ff.shaderValue=Fe,Ff.shaderValue.setValue(Fa._shader2D);var Fh=Fa._shader2D.filters;return Fh&&Ff.shaderValue.setFilters(Fh),Ff},Fj._cache=((Fj._cache=[])._length=0,Fj._cache),Fj._shaderSet=!0,Fj}(),FKa=function(Fa){function Ft(){Ft.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}Fo(Ft,"laya.webgl.utils.MeshTexture",Fta);var Fb=Ft.prototype;return Fb.addData=function(Fa,Fb,Fc,Fd,Fe,Ff){for(var Fg=Fa.length/2,Fh=this._vb.needSize(Fg*Ft.const_stride)>>2,Fi=this._vb.getFloat32Array(),Fj=0,Fm=0;Fm<Fg;Fm++){var Fn=Fa[Fj],Fo=Fa[Fj+1],Fp=Fn*Fd.a+Fo*Fd.c+Fd.tx,Fq=Fn*Fd.b+Fo*Fd.d+Fd.ty;Fi[Fh++]=Fp,Fi[Fh++]=Fq,Fi[Fh++]=Fb[Fj],Fi[Fh++]=Fb[Fj+1],Fj+=2}this._vb.setNeedUpload();var Fr=this.vertNum;if(0<Fr){(Fg=Fc.length)>Ft.tmpIdx.length&&(Ft.tmpIdx=new Uint16Array(Fg));for(var Fs=0;Fs<Fg;Fs++)Ft.tmpIdx[Fs]=Fc[Fs]+Fr;this._ib.appendU16Array(Ft.tmpIdx,Fc.length)}else this._ib.append(Fc);this._ib.setNeedUpload(),this.vertNum+=Fg,this.indexNum+=Fc.length},Fb.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},Fb.destroy=function(){this._ib.destroy(),this._vb.destroy()},Ft.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new Ft},Ft.const_stride=16,Ft._POOL=[],Fg(Ft,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),Ft}(),FLa=function(Fa){function Fb(){Fb.__super.call(this),this.lock=!0}return Fo(Fb,"laya.webgl.shader.BaseShader",Fv),Fb.activeShader=null,Fb.bindShader=null,Fb}(),FMa=function(Fb){function Fm(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===Fc&&(Fc=6408),void 0===Fd&&(Fd=5121),void 0===Fe&&(Fe=34041),void 0===Ff&&(Ff=!1),void 0===Fg&&(Fg=!1),void 0===Fh&&(Fh=-1),void 0===Fi&&(Fi=-1),this._type=1,this._w=Fa,this._h=Fb,this._surfaceFormat=Fc,this._surfaceType=Fd,this._depthStencilFormat=Fe,Ft.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=Ff,this._repeat=Fg,this._minFifter=Fh,this._magFifter=Fi,this._createWebGLRenderTarget(),this.bitmap.lock=!0,Fm.__super.call(this,this.bitmap,FK.INV_UV)}Fo(Fm,"laya.webgl.resource.RenderTarget2D",Fb);var Fa=Fm.prototype;return Fy.imps(Fa,{"laya.resource.IDispose":!0}),Fa.getType=function(){return this._type},Fa.getTexture=function(){return this},Fa.size=function(Fa,Fb){this._w==Fa&&this._h==Fb||(this._w=Fa,this._h=Fb,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},Fa.release=function(){this.destroy()},Fa.recycle=function(){Fm.POOL.push(this)},Fa.start=function(){var Fa=Fwa.mainContext;return this._preRenderTarget=Fua.curRenderTarget,Fua.curRenderTarget=this,Fa.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(Fa.viewport(0,0,this._w,this._h),this._svWidth=Fua.width,this._svHeight=Fua.height,Fua.width=this._w,Fua.height=this._h,FLa.activeShader=null),this},Fa.clear=function(Fa,Fb,Fc,Fd){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=1);var Fe=Fwa.mainContext;Fe.clearColor(Fa,Fb,Fc,Fd);var Ff=16384;switch(this._depthStencilFormat){case 33189:Ff|=256;break;case 36168:Ff|=1024;break;case 34041:Ff|=256,Ff|=1024}Fe.clear(Ff)},Fa.end=function(){var Fa=Fwa.mainContext;Fa.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,Fua.curRenderTarget=this._preRenderTarget,1==this._type?(Fa.viewport(0,0,this._svWidth,this._svHeight),Fua.width=this._svWidth,Fua.height=this._svHeight,FLa.activeShader=null):Fa.viewport(0,0,Fy.stage.width,Fy.stage.height)},Fa.getData=function(Fa,Fb,Fc,Fd){var Fe=Fwa.mainContext;if(Fe.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===Fe.checkFramebufferStatus(36160)))return Fe.bindFramebuffer(36160,null),null;var Ff=new Uint8Array(this._w*this._h*4);return Fe.readPixels(Fa,Fb,Fc,Fd,this._surfaceFormat,this._surfaceType,Ff),Fe.bindFramebuffer(36160,null),Ff},Fa.destroy=function(Fa){void 0===Fa&&(Fa=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,Fb.prototype.destroy.call(this))},Fa.dispose=function(){},Fa._createWebGLRenderTarget=function(){this.bitmap=new FWa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(Fa){this.event("recovered")})},Fd(0,Fa,"surfaceFormat",function(){return this._surfaceFormat}),Fd(0,Fa,"magFifter",function(){return this._magFifter}),Fd(0,Fa,"surfaceType",function(){return this._surfaceType}),Fd(0,Fa,"mipMap",function(){return this._mipMap}),Fd(0,Fa,"depthStencilFormat",function(){return this._depthStencilFormat}),Fd(0,Fa,"minFifter",function(){return this._minFifter}),Fd(0,Fa,"source",function(){return this._alreadyResolved?Fy.superGet(FK,this,"source"):null}),Fm.create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){void 0===Fc&&(Fc=6408),void 0===Fd&&(Fd=5121),void 0===Fe&&(Fe=34041),void 0===Ff&&(Ff=!1),void 0===Fg&&(Fg=!1),void 0===Fh&&(Fh=-1),void 0===Fi&&(Fi=-1);var Fj=Fm.POOL.pop();return Fj||(Fj=new Fm(Fa,Fb)),Fj.bitmap&&Fj._w==Fa&&Fj._h==Fb&&Fj._surfaceFormat==Fc&&Fj._surfaceType==Fd&&Fj._depthStencilFormat==Fe&&Fj._mipMap==Ff&&Fj._repeat==Fg&&Fj._minFifter==Fh&&Fj._magFifter==Fi||(Fj._w=Fa,Fj._h=Fb,Fj._surfaceFormat=Fc,Fj._surfaceType=Fd,Fj._depthStencilFormat=Fe,Ft.isConchWebGL&&34041===Fj._depthStencilFormat&&(Fj._depthStencilFormat=33189),Fj._mipMap=Ff,Fj._repeat=Fg,Fj._minFifter=Fh,Fj._magFifter=Fi,Fj.release(),Fj._createWebGLRenderTarget()),Fj},Fm.TYPE2D=1,Fm.TYPE3D=2,Fm.POOL=[],Fm}(FK),FNa=function(Fa){function Fb(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,Fb.__super.call(this),Fb._gl=Fwa.mainContext}Fo(Fb,"laya.webgl.utils.Buffer",Fv);var Fc=Fb.prototype;return Fc._bind=function(){this.activeResource(),Fb._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(Fb._bindVertexBuffer=this._glBuffer),Fb._gl.bindBuffer(this._bufferType,Fb._bindActive[this._bufferType]=this._glBuffer),FLa.activeShader=null)},Fc.recreateResource=function(){this._glBuffer||(this._glBuffer=Fb._gl.createBuffer()),this.completeCreate()},Fc.disposeResource=function(){this._glBuffer&&(Fwa.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},Fd(0,Fc,"bufferUsage",function(){return this._bufferUsage}),Fb._gl=null,Fb._bindActive={},Fb._bindVertexBuffer=null,Fb._enableAtributes=[],Fb}(),FOa=function(Fa){function Fc(Fa){this.texcoord=null,this.offsetX=300,this.offsetY=0,Fc.__super.call(this,512,0);var Fb=8*Fra.BYTES_PE;this.position=[2,5126,!1,Fb,0],this.texcoord=[2,5126,!1,Fb,2*Fra.BYTES_PE],this.color=[4,5126,!1,Fb,4*Fra.BYTES_PE]}return Fo(Fc,"laya.webgl.shader.d2.skinAnishader.SkinSV",FAa),Fc}(),FPa=function(Fa){function Fb(Fa){Fb.__super.call(this,2,0),this.color=[]}return Fo(Fb,"laya.webgl.shader.d2.value.Color2dSV",FAa),Fb.prototype.setValue=function(Fa){Fa.fillStyle&&(this.color=Fa.fillStyle._color._color),Fa.strokeStyle&&(this.color=Fa.strokeStyle._color._color)},Fb}(),FQa=function(Fa){function Fb(Fa){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=FAa._TEXCOORD,Fb.__super.call(this,256,0)}Fo(Fb,"laya.webgl.shader.d2.value.FillTextureSV",FAa);var Fc=Fb.prototype;return Fc.setValue=function(Fa){this.ALPHA=Fa.ALPHA,Fa.filters&&this.setFilters(Fa.filters)},Fc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Fb}(),FRa=function(Fa){function Fb(Fa){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=FAa._TEXCOORD,void 0===Fa&&(Fa=0),Fb.__super.call(this,1,Fa)}Fo(Fb,"laya.webgl.shader.d2.value.TextureSV",FAa);var Fc=Fb.prototype;return Fc.setValue=function(Fa){this.ALPHA=Fa.ALPHA,Fa.filters&&this.setFilters(Fa.filters)},Fc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Fb}(),FSa=function(Fa){function Fb(Fa){this.a_color=null,this.u_pos=[0,0],Fb.__super.call(this,4,0),this.position=[2,5126,!1,5*Fra.BYTES_PE,0],this.a_color=[3,5126,!1,5*Fra.BYTES_PE,2*Fra.BYTES_PE]}return Fo(Fb,"laya.webgl.shader.d2.value.PrimitiveSV",FAa),Fb}(),FTa=function(Fa){function Fb(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,Fb.__super.call(this)}Fo(Fb,"laya.webgl.atlas.AtlasWebGLCanvas",Fa);var Fc=Fb.prototype;return Fc.recreateResource=function(){var Fa=Fwa.mainContext,Fb=this._source=Fa.createTexture(),Fc=Fxa.curBindTexTarget,Fd=Fxa.curBindTexValue;Fxa.bindTexture(Fa,3553,Fb),Fa.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),Fa.texParameteri(3553,10241,9729),Fa.texParameteri(3553,10240,9729),Fa.texParameteri(3553,10242,33071),Fa.texParameteri(3553,10243,33071),Fc&&Fd&&Fxa.bindTexture(Fa,Fc,Fd),this.memorySize=this._w*this._h*4,this.completeCreate()},Fc.disposeResource=function(){this._source&&(Fwa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Fc.texSubImage2D=function(Fa,Fb,Fc){if(Ft.isFlash){this._flashCacheImage||(this._flashCacheImage=Fr.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var Fd=Fc.bitmapdata;this._flashCacheImage._image.copyPixels(Fd,0,0,Fd.width,Fd.height,Fa,Fb),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var Fe=Fwa.mainContext,Ff=Fxa.curBindTexTarget,Fg=Fxa.curBindTexValue;Fxa.bindTexture(Fe,3553,this._source),Fe.pixelStorei(37441,!0),0<=Fa-1&&Fe.texSubImage2D(3553,0,Fa-1,Fb,6408,5121,Fc),Fa+1<=this._w&&Fe.texSubImage2D(3553,0,Fa+1,Fb,6408,5121,Fc),0<=Fb-1&&Fe.texSubImage2D(3553,0,Fa,Fb-1,6408,5121,Fc),Fb+1<=this._h&&Fe.texSubImage2D(3553,0,Fa,Fb+1,6408,5121,Fc),Fe.texSubImage2D(3553,0,Fa,Fb,6408,5121,Fc),Fe.pixelStorei(37441,!1),Ff&&Fg&&Fxa.bindTexture(Fe,Ff,Fg)}},Fc.texSubImage2DPixel=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fwa.mainContext,Fg=Fxa.curBindTexTarget,Fh=Fxa.curBindTexValue;Fxa.bindTexture(Ff,3553,this._source);var Fi=new Uint8Array(Fe.data);Ff.pixelStorei(37441,!0),Ff.texSubImage2D(3553,0,Fa,Fb,Fc,Fd,6408,5121,Fi),Ff.pixelStorei(37441,!1),Fg&&Fh&&Fxa.bindTexture(Ff,Fg,Fh)},Fd(0,Fc,"width",Fa.prototype._$get_width,function(Fa){this._w=Fa}),Fd(0,Fc,"height",Fa.prototype._$get_height,function(Fa){this._h=Fa}),Fb}(Fc),FUa=function(Fa){function Fe(){this.flipY=!0,this.alwaysChange=!1,Fe.__super.call(this)}Fo(Fe,"laya.webgl.resource.WebGLCanvas",Fc);var Fb=Fe.prototype;return Fb.getCanvas=function(){return this._canvas},Fb.clear=function(){this._ctx&&this._ctx.clear()},Fb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Fb._setContext=function(Fa){this._ctx=Fa},Fb.getContext=function(Fa,Fb){return this._ctx?this._ctx:this._ctx=Fe._createContext(this)},Fb.size=function(Fa,Fb){this._w==Fa&&this._h==Fb||(this._w=Fa,this._h=Fb,this._ctx&&this._ctx.size(Fa,Fb),this._canvas&&(this._canvas.height=Fb,this._canvas.width=Fa))},Fb.activeResource=function(Fa){void 0===Fa&&(Fa=!1),this._source||this.recreateResource()},Fb.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},Fb.disposeResource=function(){this._source&&!this.iscpuSource&&(Fwa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Fb.createWebGlTexture=function(){var Fa=Fwa.mainContext;this._canvas;var Fb=this._source=Fa.createTexture();this.iscpuSource=!1;var Fc=Fxa.curBindTexTarget,Fd=Fxa.curBindTexValue;Fxa.bindTexture(Fa,3553,Fb),Fa.pixelStorei(37440,this.flipY?1:0),Fe.premulAlpha&&Fa.pixelStorei(37441,!0),Fa.texImage2D(3553,0,6408,6408,5121,this._imgData),Fe.premulAlpha&&Fa.pixelStorei(37441,!1),Fa.texParameteri(3553,10240,9729),Fa.texParameteri(3553,10241,9729),Fa.texParameteri(3553,10242,33071),Fa.texParameteri(3553,10243,33071),Fa.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,Fc&&Fd&&Fxa.bindTexture(Fa,Fc,Fd)},Fb.reloadCanvasData=function(){var Fa=Fwa.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var Fb=Fxa.curBindTexTarget,Fc=Fxa.curBindTexValue;Fxa.bindTexture(Fa,3553,this._source),Fe.premulAlpha&&Fa.pixelStorei(37441,!0),Fa.texImage2D(3553,0,6408,6408,5121,this._imgData),Fe.premulAlpha&&Fa.pixelStorei(37441,!1),Fa.pixelStorei(37440,0),Fb&&Fc&&Fxa.bindTexture(Fa,Fb,Fc)},Fb.texSubImage2D=function(Fa,Fb,Fc){var Fd=Fwa.mainContext,Fe=Fxa.curBindTexTarget,Ff=Fxa.curBindTexValue;Fxa.bindTexture(Fd,3553,this._source),Fd.pixelStorei(37441,!0),Fd.texSubImage2D(3553,0,Fb,Fc,6408,5121,Fa._source),Fd.pixelStorei(37441,!1),Fe&&Ff&&Fxa.bindTexture(Fd,Fe,Ff)},Fb.toBase64=function(Fa,Fb,Fc){var Fd=null;this._canvas&&(Fd=this._canvas.toDataURL(Fa,Fb)),Fc.call(this,Fd)},Fd(0,Fb,"context",function(){return this._ctx}),Fd(0,Fb,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),Fd(0,Fb,"asBitmap",null,function(Fa){this._ctx&&(this._ctx.asBitmap=Fa)}),Fe._createContext=null,Fe.premulAlpha=!1,Fe}(),FVa=function(Fa){function Ff(Fa,Fb){this.CborderSize=12,Ff.__super.call(this),this.char=Fa,this.isSpace=" "===Fa,this.xs=Fb.scaleX,this.ys=Fb.scaleY,this.font=Fb.font.toString(),this.fontSize=Fb.font.size,this.fillColor=Fb.fillColor,this.borderColor=Fb.borderColor,this.lineWidth=Fb.lineWidth,this.underLine=Fb.underLine;var Fc,Fd=Ft.isConchApp;Fd?((Fc=ConchTextCanvas)._source=ConchTextCanvas,Fc._source.canvas=ConchTextCanvas):Fc=Fp.canvas.source,this.canvas=Fc,this._enableMerageInAtlas=!0,this._ctx=Fd?Fc:this.canvas.getContext("2d",void 0);var Fe=FL.measureText(this.char,this.font);this.cw=Fe.width*this.xs,this.ch=(Fe.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new FK(this)}Fo(Ff,"laya.webgl.resource.WebGLCharImage",Fc);var Fb=Ff.prototype;return Fy.imps(Fb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Fb.active=function(){this.texture.active()},Fb.recreateResource=function(){var Fa=Ft.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),Fa){var Fb=this.fontSize;1==this.xs&&1==this.ys||(Fb=parseInt(Fb*(this.xs>this.ys?this.xs:this.ys)+""));var Fc="normal 100 "+this.font;Fc=Fc.replace(Ff._fontSizeReg,Fb),this.borderColor&&(Fc+=" 1 "+this.borderColor),this._ctx.font=Fc,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,FJ.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var Fd=this._ctx.measureText(this.char);Fd||(Fd={width:16});var Fe=Fd.width+1;this._ctx.lineTo(Fe,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},Fb.onresize=function(Fa,Fb){this._w=Fa,this._h=Fb,this._allowMerageInAtlas=!0},Fb.clearAtlasSource=function(){},Fd(0,Fb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Fd(0,Fb,"atlasSource",function(){return this.canvas}),Fd(0,Fb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Fa){this._enableMerageInAtlas=Fa}),Ff.createOneChar=function(Fa,Fb){return new Ff(Fa,Fb)},Ff._fontSizeReg=new RegExp("\\d+(?=px)","g"),Ff}(),FWa=function(Fa){function Fj(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){void 0===Fc&&(Fc=6408),void 0===Fd&&(Fd=5121),void 0===Fe&&(Fe=34041),void 0===Ff&&(Ff=!1),void 0===Fg&&(Fg=!1),void 0===Fh&&(Fh=-1),void 0===Fi&&(Fi=1),Fj.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=Fa,this._h=Fb,this._surfaceFormat=Fc,this._surfaceType=Fd,this._depthStencilFormat=Fe,this._mipMap=Ff,this._repeat=Fg,this._minFifter=Fh,this._magFifter=Fi}Fo(Fj,"laya.webgl.resource.WebGLRenderTarget",Fc);var Fb=Fj.prototype;return Fb.recreateResource=function(){var Fa=Fwa.mainContext;this._frameBuffer||(this._frameBuffer=Fa.createFramebuffer()),this._source||(this._source=Fa.createTexture());var Fb=Fxa.curBindTexTarget,Fc=Fxa.curBindTexValue;Fxa.bindTexture(Fa,3553,this._source),Fa.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var Fd=this._minFifter,Fe=this._magFifter,Ff=this._repeat?10497:33071,Fg=Fm.isPOT(this._w,this._h);if(Fg?(this._mipMap?-1!==Fd||(Fd=9987):-1!==Fd||(Fd=9729),-1!==Fe||(Fe=9729),Fa.texParameteri(3553,10241,Fd),Fa.texParameteri(3553,10240,Fe),Fa.texParameteri(3553,10242,Ff),Fa.texParameteri(3553,10243,Ff),this._mipMap&&Fa.generateMipmap(3553)):(-1!==Fd||(Fd=9729),-1!==Fe||(Fe=9729),Fa.texParameteri(3553,10241,Fd),Fa.texParameteri(3553,10240,Fe),Fa.texParameteri(3553,10242,33071),Fa.texParameteri(3553,10243,33071)),Fa.bindFramebuffer(36160,this._frameBuffer),Fa.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=Fa.createRenderbuffer()),Fa.bindRenderbuffer(36161,this._depthStencilBuffer),Fa.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:Fa.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Fa.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Fa.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Fa.bindFramebuffer(36160,null),Fb&&Fc&&Fxa.bindTexture(Fa,Fb,Fc),Fa.bindRenderbuffer(36161,null),Fg&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},Fb.disposeResource=function(){this._frameBuffer&&(Fwa.mainContext.deleteTexture(this._source),Fwa.mainContext.deleteFramebuffer(this._frameBuffer),Fwa.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},Fd(0,Fb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Fd(0,Fb,"frameBuffer",function(){return this._frameBuffer}),Fj}(),FXa=function(Fa){function Fh(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this.offsetX=0,this.offsetY=0,Fh.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=Ff,this.canvas=Fa,this._ctx=Fa.getContext("2d",void 0),this._w=Fd,this._h=Fe,this.offsetX=Fb,this.offsetY=Fc,this.src=Fg,this._enableMerageInAtlas=!0,FQ.enabled&&this._w<FQ.atlasLimitWidth&&this._h<FQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}Fo(Fh,"laya.webgl.resource.WebGLSubImage",Fc);var Fb=Fh.prototype;return Fy.imps(Fb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Fb.size=function(Fa,Fb){this._w=Fa,this._h=Fb,this._ctx&&this._ctx.size(Fa,Fb),this.canvas&&(this.canvas.height=Fb,this.canvas.width=Fa)},Fb.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},Fb.createWebGlTexture=function(){var Fa=Fwa.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var Fb=this._source=Fa.createTexture(),Fc=Fxa.curBindTexTarget,Fd=Fxa.curBindTexValue;Fxa.bindTexture(Fa,3553,Fb),Fa.pixelStorei(37441,!0),Fa.texImage2D(3553,0,6408,6408,5121,this.canvas),Fa.pixelStorei(37441,!1);var Fe=this.minFifter,Ff=this.magFifter,Fg=this.repeat?10497:33071,Fh=Fm.isPOT(this.width,this.height);Fh?(this.mipmap?-1!==Fe||(Fe=9987):-1!==Fe||(Fe=9729),-1!==Ff||(Ff=9729),Fa.texParameteri(3553,10240,Ff),Fa.texParameteri(3553,10241,Fe),Fa.texParameteri(3553,10242,Fg),Fa.texParameteri(3553,10243,Fg),this.mipmap&&Fa.generateMipmap(3553)):(-1!==Fe||(Fe=9729),-1!==Ff||(Ff=9729),Fa.texParameteri(3553,10241,Fe),Fa.texParameteri(3553,10240,Ff),Fa.texParameteri(3553,10242,33071),Fa.texParameteri(3553,10243,33071)),Fc&&Fd&&Fxa.bindTexture(Fa,Fc,Fd),this.canvas=null,Fh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},Fb.disposeResource=function(){FQ.enabled&&this._allowMerageInAtlas||!this._source||(Fwa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Fb.clearAtlasSource=function(){},Fd(0,Fb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Fd(0,Fb,"atlasSource",function(){return this.canvas}),Fd(0,Fb,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(Fa){this._allowMerageInAtlas=Fa}),Fh}(),FYa=function(Fa){function Fj(Fa,Fb,Fc,Fd){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,Fj.__super.call(this),!Fa||!Fb)throw"Shader Error";this._id=++Fj._count,this._vs=Fa,this._ps=Fb,this._nameMap=Fd||{},null!=Fc&&(Fj.sharders[Fc]=this)}Fo(Fj,"laya.webgl.shader.Shader",FLa);var Fb=Fj.prototype;return Fb.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},Fb.disposeResource=function(){Fwa.mainContext.deleteShader(this._vshader),Fwa.mainContext.deleteShader(this._pshader),Fwa.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},Fb._compile=function(){if(!Fwa.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var Fa=[this._vs,this._ps],Fb=Fwa.mainContext;if(this._program=Fb.createProgram(),this._vshader=Fj._createShader(Fb,Fa[0],35633),this._pshader=Fj._createShader(Fb,Fa[1],35632),Fb.attachShader(this._program,this._vshader),Fb.attachShader(this._program,this._pshader),Fb.linkProgram(this._program),!Ft.isConchApp&&!Fb.getProgramParameter(this._program,35714))throw Fb.getProgramInfoLog(this._program);var Fc,Fd,Fe=0,Ff=0;for(Ff=Ft.isConchApp?Fb.getProgramParameterEx(this._vs,this._ps,"",35721):Fb.getProgramParameter(this._program,35721),Fe=0;Fe<Ff;Fe++){var Fg=null;Fc={vartype:"attribute",glfun:null,ivartype:0,attrib:Fg=Ft.isConchApp?Fb.getActiveAttribEx(this._vs,this._ps,"",Fe):Fb.getActiveAttrib(this._program,Fe),location:Fb.getAttribLocation(this._program,Fg.name),name:Fg.name,type:Fg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(Fc)}var Fh=0;for(Fh=Ft.isConchApp?Fb.getProgramParameterEx(this._vs,this._ps,"",35718):Fb.getProgramParameter(this._program,35718),Fe=0;Fe<Fh;Fe++){var Fi=null;Fi=Ft.isConchApp?Fb.getActiveUniformEx(this._vs,this._ps,"",Fe):Fb.getActiveUniform(this._program,Fe),0<(Fc={vartype:"uniform",glfun:null,ivartype:1,attrib:Fg,location:Fb.getUniformLocation(this._program,Fi.name),name:Fi.name,type:Fi.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Fc.name=Fc.name.substr(0,Fc.name.length-3),Fc.isArray=!0,Fc.location=Fb.getUniformLocation(this._program,Fc.name)),this._params.push(Fc)}for(Fe=0,Fd=this._params.length;Fe<Fd;Fe++)if((Fc=this._params[Fe]).indexOfParams=Fe,Fc.index=1,Fc.value=[Fc.location,null],Fc.codename=Fc.name,Fc.name=this._nameMap[Fc.codename]?this._nameMap[Fc.codename]:Fc.codename,(this._paramsMap[Fc.name]=Fc)._this=this,Fc.uploadedValue=[],"attribute"!==Fc.vartype)switch(Fc.type){case 5124:Fc.fun=Fc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Fc.fun=Fc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Fc.fun=Fc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Fc.fun=Fc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Fc.fun=Fc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Fc.fun=this._uniform_sampler2D;break;case 35680:Fc.fun=this._uniform_samplerCube;break;case 35676:Fc.glfun=Fb.uniformMatrix4fv,Fc.fun=this._uniformMatrix4fv;break;case 35670:Fc.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else Fc.fun=this._attribute}},Fb.getUniform=function(Fa){return this._paramsMap[Fa]},Fb._attribute=function(Fa,Fb){var Fc=Fwa.mainContext,Fd=FNa._enableAtributes,Fe=Fa.location;return Fd[Fe]||Fc.enableVertexAttribArray(Fe),Fc.vertexAttribPointer(Fe,Fb[0],Fb[1],Fb[2],Fb[3],Fb[4]+this._offset),Fd[Fe]=FNa._bindVertexBuffer,1},Fb._uniform1f=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb?(Fwa.mainContext.uniform1f(Fa.location,Fc[0]=Fb),1):0},Fb._uniform1fv=function(Fa,Fb){if(Fb.length<4){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(Fwa.mainContext.uniform1fv(Fa.location,Fb),Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3],1):0}return Fwa.mainContext.uniform1fv(Fa.location,Fb),1},Fb._uniform_vec2=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]?(Fwa.mainContext.uniform2f(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1]),1):0},Fb._uniform_vec2v=function(Fa,Fb){if(Fb.length<2){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(Fwa.mainContext.uniform2fv(Fa.location,Fb),Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3],1):0}return Fwa.mainContext.uniform2fv(Fa.location,Fb),1},Fb._uniform_vec3=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]?(Fwa.mainContext.uniform3f(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2]),1):0},Fb._uniform_vec3v=function(Fa,Fb){return Fwa.mainContext.uniform3fv(Fa.location,Fb),1},Fb._uniform_vec4=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(Fwa.mainContext.uniform4f(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3]),1):0},Fb._uniform_vec4v=function(Fa,Fb){return Fwa.mainContext.uniform4fv(Fa.location,Fb),1},Fb._uniformMatrix2fv=function(Fa,Fb){return Fwa.mainContext.uniformMatrix2fv(Fa.location,!1,Fb),1},Fb._uniformMatrix3fv=function(Fa,Fb){return Fwa.mainContext.uniformMatrix3fv(Fa.location,!1,Fb),1},Fb._uniformMatrix4fv=function(Fa,Fb){return Fwa.mainContext.uniformMatrix4fv(Fa.location,!1,Fb),1},Fb._uniform1i=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb?(Fwa.mainContext.uniform1i(Fa.location,Fc[0]=Fb),1):0},Fb._uniform1iv=function(Fa,Fb){return Fwa.mainContext.uniform1iv(Fa.location,Fb),1},Fb._uniform_ivec2=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]?(Fwa.mainContext.uniform2i(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1]),1):0},Fb._uniform_ivec2v=function(Fa,Fb){return Fwa.mainContext.uniform2iv(Fa.location,Fb),1},Fb._uniform_vec3i=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]?(Fwa.mainContext.uniform3i(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2]),1):0},Fb._uniform_vec3vi=function(Fa,Fb){return Fwa.mainContext.uniform3iv(Fa.location,Fb),1},Fb._uniform_vec4i=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(Fwa.mainContext.uniform4i(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3]),1):0},Fb._uniform_vec4vi=function(Fa,Fb){return Fwa.mainContext.uniform4iv(Fa.location,Fb),1},Fb._uniform_sampler2D=function(Fa,Fb){var Fc=Fwa.mainContext,Fd=Fa.uploadedValue;return null==Fd[0]?(Fd[0]=this._curActTexIndex,Fc.uniform1i(Fa.location,this._curActTexIndex),Fc.activeTexture(Fj._TEXTURES[this._curActTexIndex]),Fxa.bindTexture(Fc,3553,Fb),this._curActTexIndex++,1):(Fc.activeTexture(Fj._TEXTURES[Fd[0]]),Fxa.bindTexture(Fc,3553,Fb),0)},Fb._uniform_samplerCube=function(Fa,Fb){var Fc=Fwa.mainContext,Fd=Fa.uploadedValue;return null==Fd[0]?(Fd[0]=this._curActTexIndex,Fc.uniform1i(Fa.location,this._curActTexIndex),Fc.activeTexture(Fj._TEXTURES[this._curActTexIndex]),Fxa.bindTexture(Fc,34067,Fb),this._curActTexIndex++,1):(Fc.activeTexture(Fj._TEXTURES[Fd[0]]),Fxa.bindTexture(Fc,34067,Fb),0)},Fb._noSetValue=function(Fa){console.log("no....:"+Fa.name)},Fb.uploadOne=function(Fa,Fb){this.activeResource(),Fxa.UseProgram(this._program);var Fc=this._paramsMap[Fa];Fc.fun.call(this,Fc,Fb)},Fb.uploadTexture2D=function(Fa){FG.shaderCall++;var Fb=Fwa.mainContext;Fb.activeTexture(33984),Fxa.bindTexture(Fb,3553,Fa)},Fb.uploadTexture2D1=function(Fa){FG.shaderCall++;var Fb=Fwa.mainContext;Fb.activeTexture(33985),Fxa.bindTexture(Fb,3553,Fa)},Fb.upload=function(Fa,Fb){FLa.activeShader=FLa.bindShader=this,this._lastUseFrameCount===FG.loopCount||this.activeResource(),Fxa.UseProgram(this._program),this._reCompile?(Fb=this._params,this._reCompile=!1):Fb=Fb||this._params;Fwa.mainContext;for(var Fc,Fd,Fe=Fb.length,Ff=0,Fg=0;Fg<Fe;Fg++)null!==(Fd=Fa[(Fc=Fb[Fg]).name])&&(Ff+=Fc.fun.call(this,Fc,Fd));FG.shaderCall+=Ff},Fb.uploadArray=function(Fa,Fb,Fc){FLa.activeShader=this,(FLa.bindShader=this).activeResource(),Fxa.UseProgram(this._program);this._params;for(var Fd,Fe,Ff=0,Fg=Fb-2;0<=Fg;Fg-=2)(Fe=this._paramsMap[Fa[Fg]])&&null!=(Fd=Fa[Fg+1])&&(Fc&&Fc[Fe.name]&&Fc[Fe.name].bind(),Ff+=Fe.fun.call(this,Fe,Fd));FG.shaderCall+=Ff},Fb.getParams=function(){return this._params},Fj.getShader=function(Fa){return Fj.sharders[Fa]},Fj.create=function(Fa,Fb,Fc,Fd){return new Fj(Fa,Fb,Fc,Fd)},Fj.withCompile=function(Fa,Fb,Fc,Fd){if(Fc&&Fj.sharders[Fc])return Fj.sharders[Fc];var Fe=Fj._preCompileShader[2e-4*Fa];if(!Fe)throw new Error("withCompile shader err!"+Fa);return Fe.createShader(Fb,Fc,Fd)},Fj.withCompile2D=function(Fa,Fb,Fc,Fd,Fe){if(Fd&&Fj.sharders[Fd])return Fj.sharders[Fd];var Ff=Fj._preCompileShader[2e-4*Fa+Fb];if(!Ff)throw new Error("withCompile shader err!"+Fa+" "+Fb);return Ff.createShader(Fc,Fd,Fe)},Fj.addInclude=function(Fa,Fb){Fva.addInclude(Fa,Fb)},Fj.preCompile=function(Fa,Fb,Fc,Fd){var Fe=2e-4*Fa;Fj._preCompileShader[Fe]=new Fva(Fe,Fb,Fc,Fd)},Fj.preCompile2D=function(Fa,Fb,Fc,Fd,Fe){var Ff=2e-4*Fa+Fb;Fj._preCompileShader[Ff]=new Fva(Ff,Fc,Fd,Fe)},Fj._createShader=function(Fa,Fb,Fc){var Fd=Fa.createShader(Fc);return Fa.shaderSource(Fd,Fb),Fa.compileShader(Fd),Fd},Fj._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],Fj._count=0,Fj._preCompileShader={},Fj.SHADERNAME2ID=2e-4,Fj.sharders=((Fj.sharders=[]).length=32,Fj.sharders),Fg(Fj,["nameKey",function(){return this.nameKey=new FH}]),Fj}(),FZa=function(Fa){function Fb(){this._maxsize=0,this._upload=!0,this._uploadSize=0,Fb.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}Fo(Fb,"laya.webgl.utils.Buffer2D",Fa);var Fc=Fb.prototype;return Fc.needSize=function(Fa){var Fb=this._byteLength;if(Fa){var Fc=this._byteLength+Fa;Fc<=this._buffer.byteLength||this._resizeBuffer(Fc<<1,!0),this._byteLength=Fc}return Fb},Fc._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),FG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,FNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),FNa._gl.bufferSubData(this._bufferType,0,this._buffer)},Fc._bufferSubData=function(Fa,Fb,Fc){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),this._maxsize=Math.max(this._maxsize,this._byteLength),FG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,FNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Fb||Fc){var Fd=this._buffer.slice(Fb,Fc);FNa._gl.bufferSubData(this._bufferType,Fa,Fd)}else FNa._gl.bufferSubData(this._bufferType,Fa,this._buffer)},Fc._checkArrayUse=function(){},Fc._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},Fc._bind_subUpload=function(Fa,Fb,Fc){return void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(Fa,Fb,Fc),!0)},Fc._resizeBuffer=function(Fa,Fb){if(Fa<this._buffer.byteLength)return this;if(this.memorySize=Fa,Fb&&this._buffer&&0<this._buffer.byteLength){var Fc=new ArrayBuffer(Fa);new Uint8Array(Fc).set(new Uint8Array(this._buffer),0),this._buffer=Fc}else this._buffer=new ArrayBuffer(Fa);return this._checkArrayUse(),this._upload=!0,this},Fc.append=function(Fa){this._upload=!0;var Fb,Fc;Fb=Fa.byteLength,Fa instanceof Uint8Array?(this._resizeBuffer(this._byteLength+Fb,!0),Fc=new Uint8Array(this._buffer,this._byteLength)):Fa instanceof Uint16Array?(this._resizeBuffer(this._byteLength+Fb,!0),Fc=new Uint16Array(this._buffer,this._byteLength)):Fa instanceof Float32Array&&(this._resizeBuffer(this._byteLength+Fb,!0),Fc=new Float32Array(this._buffer,this._byteLength)),Fc.set(Fa,0),this._byteLength+=Fb,this._checkArrayUse()},Fc.appendU16Array=function(Fa,Fb){this._resizeBuffer(this._byteLength+2*Fb,!0);for(var Fc=new Uint16Array(this._buffer,this._byteLength,Fb),Fd=0;Fd<Fb;Fd++)Fc[Fd]=Fa[Fd];this._byteLength+=2*Fb,this._checkArrayUse()},Fc.appendEx=function(Fa,Fb){this._upload=!0;var Fc;Fc=Fa.byteLength,this._resizeBuffer(this._byteLength+Fc,!0),new Fb(this._buffer,this._byteLength).set(Fa,0),this._byteLength+=Fc,this._checkArrayUse()},Fc.appendEx2=function(Fa,Fb,Fc,Fd){void 0===Fd&&(Fd=1),this._upload=!0;var Fe,Ff;Fe=Fc*Fd,this._resizeBuffer(this._byteLength+Fe,!0),Ff=new Fb(this._buffer,this._byteLength);var Fg=0;for(Fg=0;Fg<Fc;Fg++)Ff[Fg]=Fa[Fg];this._byteLength+=Fe,this._checkArrayUse()},Fc.getBuffer=function(){return this._buffer},Fc.setNeedUpload=function(){this._upload=!0},Fc.getNeedUpload=function(){return this._upload},Fc.upload=function(){var Fa=this._bind_upload();return FNa._gl.bindBuffer(this._bufferType,null),FNa._bindActive[this._bufferType]=null,FLa.activeShader=null,Fa},Fc.subUpload=function(Fa,Fb,Fc){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0);var Fd=this._bind_subUpload();return FNa._gl.bindBuffer(this._bufferType,null),FNa._bindActive[this._bufferType]=null,FLa.activeShader=null,Fd},Fc.disposeResource=function(){Fa.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},Fc.clear=function(){this._byteLength=0,this._upload=!0},Fd(0,Fc,"bufferLength",function(){return this._buffer.byteLength}),Fd(0,Fc,"byteLength",null,function(Fa){this._byteLength!==Fa&&(Fa<=this._buffer.byteLength||this._resizeBuffer(2*Fa+256,!0),this._byteLength=Fa)}),Fb.__int__=function(Fa){Fka.QuadrangleIB=Fka.create(35044),Fsa.fillIBQuadrangle(Fka.QuadrangleIB,16)},Fb.FLOAT32=4,Fb.SHORT=2,Fb}(FNa),F$a=(function(Fb){function Fc(Fa){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,Fc.__super.call(this,9)}Fo(Fc,"laya.webgl.shader.d2.value.GlowSV",Fb);var Fa=Fc.prototype;Fa.setValue=function(Fa){Fb.prototype.setValue.call(this,Fa)},Fa.clear=function(){Fb.prototype.clear.call(this)}}(FRa),function(Fa){function Fb(Fa){Fb.__super.call(this,64),this.defines.add(64)}Fo(Fb,"laya.webgl.shader.d2.value.TextSV",Fa);var Fc=Fb.prototype;return Fc.release=function(){(Fb.pool[Fb._length++]=this).clear()},Fc.clear=function(){Fa.prototype.clear.call(this)},Fb.create=function(){return Fb._length?Fb.pool[--Fb._length]:new Fb(null)},Fb.pool=[],Fb._length=0,Fb}(FRa)),F_a=function(Fa){function Fe(Fa,Fb,Fc,Fd){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,Fe.__super.call(this,Fa,Fb,Fc,Fd)}Fo(Fe,"laya.webgl.shader.d2.Shader2X",Fa);var Fb=Fe.prototype;return Fb.upload2dQuick1=function(Fa){this.upload(Fa,this._params2dQuick1||this._make2dQuick1())},Fb._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var Fa,Fb=this._params,Fc=0,Fd=Fb.length;Fc<Fd;Fc++)Fa=Fb[Fc],(Ft.isFlash||"size"!==Fa.name&&"position"!==Fa.name&&"texcoord"!==Fa.name)&&this._params2dQuick1.push(Fa)}return this._params2dQuick1},Fb.disposeResource=function(){Fa.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},Fb.upload2dQuick2=function(Fa){this.upload(Fa,this._params2dQuick2||this._make2dQuick2())},Fb._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var Fa,Fb=this._params,Fc=0,Fd=Fb.length;Fc<Fd;Fc++)Fa=Fb[Fc],(Ft.isFlash||"size"!==Fa.name)&&this._params2dQuick2.push(Fa)}return this._params2dQuick2},Fe.create=function(Fa,Fb,Fc,Fd){return new Fe(Fa,Fb,Fc,Fd)},Fe}(FYa),Fka=function(Fa){function Fb(Fa){this._uint8Array=null,this._uint16Array=null,void 0===Fa&&(Fa=35044),Fb.__super.call(this),this._bufferUsage=Fa,this._bufferType=34963,Ft.isFlash||(this._buffer=new ArrayBuffer(8))}Fo(Fb,"laya.webgl.utils.IndexBuffer2D",FZa);var Fc=Fb.prototype;return Fc._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},Fc.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},Fc.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},Fc.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},Fb.QuadrangleIB=null,Fb.create=function(Fa){return void 0===Fa&&(Fa=35044),new Fb(Fa)},Fb}(),Fla=function(Fa){function Fc(Fa,Fb){this._floatArray32=null,this._vertexStride=0,Fc.__super.call(this),this._vertexStride=Fa,this._bufferUsage=Fb,this._bufferType=34962,Ft.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}Fo(Fc,"laya.webgl.utils.VertexBuffer2D",Fa);var Fb=Fc.prototype;return Fb.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},Fb.bind=function(Fa){Fa&&Fa._bind(),this._bind()},Fb.insertData=function(Fa,Fb){this.getFloat32Array().set(Fa,Fb),this._upload=!0},Fb.bind_upload=function(Fa){Fa._bind_upload()||Fa._bind(),this._bind_upload()||this._bind()},Fb._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},Fb.disposeResource=function(){Fa.prototype.disposeResource.call(this)},Fb.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},Fd(0,Fb,"vertexStride",function(){return this._vertexStride}),Fc.create=function(Fa,Fb){return void 0===Fb&&(Fb=35048),new Fc(Fa,Fb)},Fc}(FZa),Fab=function(Fa){function Fh(Fa,Fb,Fc,Fd,Fe,Ff){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===Fc&&(Fc=6408),void 0===Fd&&(Fd=!0),Fh.__super.call(this,Fa,Fb),Fa){if(this._format=Fc,this._mipmap=Fd,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof Fa)this._url=Fa,this._src=Fa,this._image=new Fp.window.Image,Fb&&(Fb.onload&&(this.onload=Fb.onload),Fb.onerror&&(this.onerror=Fb.onerror),Fb.onCreate&&Fb.onCreate(this)),this._image.crossOrigin=Fa&&0==Fa.indexOf("data:")?null:"",Fa&&(this._image.src=Fa);else if(Fa instanceof ArrayBuffer){this._src=Fb,this._url=this._src;var Fg=new Fi(Fa);Fg.readUTFBytes(4),Fg.readUTFBytes(2),Fg.getInt16();Fg.endian="bigEndian",this._w=Fg.getInt16(),this._h=Fg.getInt16();Fg.getInt16(),Fg.getInt16();this._image=new Uint8Array(Fa,Fg.pos),this._format=Fwa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,FQ.enabled&&this._w<FQ.atlasLimitWidth&&this._h<FQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(Fa instanceof Uint8Array))return this._src=Fb,this._url=this._src,this._image=Fa.source||Fa,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=Fb,this._url=this._src,this._w=Fe,this._h=Ff,this._image=Fa,this._format=0===Fc?Fa.byteLength/(Fe*Ff)==4?6408:6407:Fc}this._$5__enableMerageInAtlas=!0}}Fo(Fh,"laya.webgl.resource.WebGLImage",Fr);var Fb=Fh.prototype;return Fy.imps(Fb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Fb._init_=function(Fa,Fb){},Fb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Fa=Fwa.mainContext,Fb=this._source=Fa.createTexture(),Fc=Fxa.curBindTexTarget,Fd=Fxa.curBindTexValue;Fxa.bindTexture(Fa,3553,Fb);var Fe=this.minFifter,Ff=this.magFifter,Fg=this.repeat?10497:33071,Fh=Fm.isPOT(this._w,this._h),Fi=!1;switch(Fh?(this.mipmap?-1!==Fe||(Fe=9987):-1!==Fe||(Fe=9729),-1!==Ff||(Ff=9729),Fa.texParameteri(3553,10241,Fe),Fa.texParameteri(3553,10240,Ff),Fa.texParameteri(3553,10242,Fg),Fa.texParameteri(3553,10243,Fg),this.mipmap&&Fa.generateMipmap(3553)):(-1!==Fe||(Fe=9729),-1!==Ff||(Ff=9729),Fa.texParameteri(3553,10241,Fe),Fa.texParameteri(3553,10240,Ff),Fa.texParameteri(3553,10242,33071),Fa.texParameteri(3553,10243,33071)),Fa.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&Fa.pixelStorei(Fa.UNPACK_ALIGNMENT,1),Fa.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&Fa.pixelStorei(Fa.UNPACK_ALIGNMENT,1),Fa.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:Fi=!0,Fa.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case Fwa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Fi=!0,Fa.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}Fa.pixelStorei(37441,!1),Fc&&Fd&&Fxa.bindTexture(Fa,Fc,Fd),this.uri||(this.uri=this._url),Fi?this.memorySize=this._image.length:Fh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},Fb.recreateResource=function(){var Fa=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var Fb=this;this._image=new Fp.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(Fb._needReleaseAgain)return Fb._needReleaseAgain=!1,Fb._image.onload=null,void(Fb._image=null);Fb._allowMerageInAtlas&&Fb._enableMerageInAtlas?(Fa.memorySize=0,Fa._recreateLock=!1):Fb._createWebGlTexture(),Fb.completeCreate()},this._image.src=this._src}},Fb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&Fwa.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},Fb.onresize=function(){this._w=this._image.width,this._h=this._image.height,FQ.enabled&&this._w<FQ.atlasLimitWidth&&this._h<FQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},Fb.clearAtlasSource=function(){this._image=null},Fd(0,Fb,"format",function(){return this._format}),Fd(0,Fb,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(Fa){this._$5__enableMerageInAtlas=Fa}),Fd(0,Fb,"mipmap",function(){return this._mipmap}),Fd(0,Fb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Fd(0,Fb,"atlasSource",function(){return this._image}),Fd(0,Fb,"onload",null,function(Fa){var Fb=this;this._onload=Fa,this._image&&(this._image.onload=null!=this._onload?function(){Fb.onresize(),Fb._onload()}:null)}),Fd(0,Fb,"onerror",null,function(Fa){var Fb=this;this._onerror=Fa,this._image&&(this._image.onerror=null!=this._onerror?function(){Fb._onerror()}:null)}),Fh}();Fy.__init([Fpa,FP,Fza,Fva])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Fa,Fb){"use strict";for(var Fc in Object.defineProperty(Fb,"__esModule",{value:!0}),Laya){var Fd=Laya[Fc];Fd&&Fd.__isclass&&(Fb[Fc]=Fd)}}),function(Ff,Fa,Fd){Fd.un,Fd.uns;var Fe=Fd.static,Fg=Fd.class,Fh=Fd.getset,Fi=(Fd.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),Fq=laya.utils.ClassUtils,Fn=(laya.events.Event,laya.utils.HTMLChar),Fj=laya.net.Loader,Fm=(laya.display.Node,laya.maths.Rectangle),Fo=laya.renders.Render,Fp=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),Fr=laya.utils.Stat,FL=laya.display.Text,Fs=laya.resource.Texture,Ft=laya.net.URL,Fu=laya.utils.Utils,Fv=function(){function Fp(){}return Fg(Fp,"laya.html.utils.HTMLParse"),Fp.parse=function(Fa,Fb,Fc){Fb=(Fb="<root>"+(Fb=Fb.replace(/<br>/g,"<br/>"))+"</root>").replace(Fp.spacePattern,Fp.char255);var Fd=Fu.parseXMLFromString(Fb);Fp._parseXML(Fa,Fd.childNodes[0].childNodes,Fc)},Fp._parseXML=function(Fa,Fb,Fc,Fd){var Fe=0,Ff=0;if(Fb.join||Fb.item)for(Fe=0,Ff=Fb.length;Fe<Ff;++Fe)Fp._parseXML(Fa,Fb[Fe],Fc,Fd);else{var Fg,Fh,Fi;if(3==Fb.nodeType)return void(Fa instanceof laya.html.dom.HTMLDivElement?(null==Fb.nodeName&&(Fb.nodeName="#text"),Fh=Fb.nodeName.toLowerCase(),0<(Fi=Fb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Fg=Fq.getInstance(Fh))&&(Fa.addChild(Fg),Fg.innerTEXT=Fi.replace(Fp.char255AndOneSpacePattern," "))):0<(Fi=Fb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Fa.innerTEXT=Fi.replace(Fp.char255AndOneSpacePattern," ")));if("#comment"==(Fh=Fb.nodeName.toLowerCase()))return;if(Fg=Fq.getInstance(Fh)){(Fg=Fa.addChild(Fg)).URI=Fc,Fg.href=Fd;var Fj=Fb.attributes;if(Fj&&0<Fj.length)for(Fe=0,Ff=Fj.length;Fe<Ff;++Fe){var Fm=Fj[Fe],Fn=Fm.nodeName,Fo=Fm.value;Fg._setAttributes(Fn,Fo)}Fp._parseXML(Fg,Fb.childNodes,Fc,Fg.href)}else Fp._parseXML(Fa,Fb.childNodes,Fc,Fd)}},Fp.char255=String.fromCharCode(255),Fp.spacePattern=/&nbsp;|&#160;/g,Fp.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),Fp}(),Fw=function(){function FK(){}return Fg(FK,"laya.html.utils.Layout"),FK.later=function(Fa){null==FK._will&&(FK._will=[],Fd.stage.frameLoop(1,null,function(){if(!(FK._will.length<1)){for(var Fa=0;Fa<FK._will.length;Fa++)laya.html.utils.Layout.layout(FK._will[Fa]);FK._will.length=0}})),FK._will.push(Fa)},FK.layout=function(Fa){if(!Fa||!Fa._style)return null;if(0==(512&Fa._style._type))return null;Fa.getStyle()._type&=-513;var Fb=FK._multiLineLayout(Fa);return Fo.isConchApp&&Fa.layaoutCallNative&&Fa.layaoutCallNative(),Fb},FK._multiLineLayout=function(Fa){if(FL.RightToLeft)return FK._multiLineLayout2(Fa);var Fb=new Array;Fa._addChildsToLayout(Fb);var Fc,Fd,Fe,Ff,Fg,Fh=0,Fi=Fb.length,Fj=Fa._getCSSStyle(),Fm=Fj.letterSpacing,Fn=Fj.leading,Fo=Fj.lineHeight,Fp=Fj._widthAuto()||!Fj.wordWrap,Fq=Fp?999999:Fa.width,Fr=(Fa.height,0),Fs=Fj.italic?Fj.fontSize/3:0,Ft=Fj._getAlign(),Fu=Fj._getValign(),Fv=0!==Fu||0!==Ft||0!=Fo,Fw=0,Fx=0,Fy=0,Fz=0,FA=new Array,FB=FA[0]=new FM,FC=!1,FD=!1;FB.h=0,Fj.italic&&(Fq-=Fj.fontSize/3);var FE=0,FF=!0;function FG(){FB.y=Fx,Fx+=FB.h+Fn,0==FB.h&&(Fx+=Fo),FB.mWidth=FE,FE=0,FB=new FM,FA.push(FB),FB.h=0,FC=!(FF=!(Fw=0))}for(Fh=0;Fh<Fi;Fh++)if(null!=(Fc=Fb[Fh]))if(FF=!1,Fc instanceof laya.html.dom.HTMLBrElement)FG(),FB.y=Fx;else{if(Fc._isChar()){if((Ff=Fc).isWord)FC=FD||"\n"===Ff.char,FB.wordStartIndex=FB.elements.length;else{if(Fy=Ff.width+Ff.style.letterSpacin,0<FA.length&&Fq<Fw+Fy&&0<FB.wordStartIndex){var FH;FH=FB.elements.length-FB.wordStartIndex+1,FB.elements.length=FB.wordStartIndex,Fh-=FH,FG();continue}FC=!1,FE+=Ff.width}Fy=Ff.width+Fm,Fz=Ff.height,FD=!1,(FC=FC||Fq<Fw+Fy)&&FG(),FB.minTextHeight=Math.min(FB.minTextHeight,Fc.height)}else Fd=Fc._getCSSStyle(),Fg=Fc,Fe=Fd.padding,0===Fd._getCssFloat()||(Fv=!0),FC=FD||Fd.lineElement,Fy=Fg.width*Fg._style._tf.scaleX+Fe[1]+Fe[3]+Fm,Fz=Fg.height*Fg._style._tf.scaleY+Fe[0]+Fe[2],FD=Fd.lineElement,(FC=FC||Fq<Fw+Fy&&Fd.wordWrap)&&FG();FB.elements.push(Fc),FB.h=Math.max(FB.h,Fz),Fc.x=Fw,Fc.y=Fx,Fw+=Fy,FB.w=Fw-Fm,FB.y=Fx,Fr=Math.max(Fw+Fs,Fr)}else FF||(Fw+=FK.DIV_ELEMENT_PADDING),FB.wordStartIndex=FB.elements.length;if(Fx=FB.y+FB.h,Fv){var FI=0,FJ=Fq;for(Fp&&0<Fa.width&&(FJ=Fa.width),Fh=0,Fi=FA.length;Fh<Fi;Fh++)FA[Fh].updatePos(0,FJ,Fh,FI,Ft,Fu,Fo),FI+=Math.max(Fo,FA[Fh].h+Fn);Fx=FI}return Fp&&(Fa.width=Fr),Fx>Fa.height&&(Fa.height=Fx),[Fr,Fx]},FK._multiLineLayout2=function(Fa){var Fb=new Array;Fa._addChildsToLayout(Fb);var Fc,Fd,Fe,Ff,Fg,Fh=0,Fi=Fb.length,Fj=Fa._getCSSStyle(),Fm=Fj.letterSpacing,Fn=Fj.leading,Fo=Fj.lineHeight,Fp=Fj._widthAuto()||!Fj.wordWrap,Fq=Fp?999999:Fa.width,Fr=(Fa.height,0),Fs=Fj.italic?Fj.fontSize/3:0,Ft=2-Fj._getAlign(),Fu=Fj._getValign(),Fv=0!==Fu||0!=Ft||0!=Fo,Fw=0,Fx=0,Fy=0,Fz=0,FA=new Array,FB=FA[0]=new FM,FC=!1,FD=!1;FB.h=0,Fj.italic&&(Fq-=Fj.fontSize/3);var FE=0,FF=!0;function FG(){FB.y=Fx,Fx+=FB.h+Fn,0==FB.h&&(Fx+=Fo),FB.mWidth=FE,FE=0,FB=new FM,FA.push(FB),FB.h=0,FC=!(FF=!(Fw=0))}for(Fh=0;Fh<Fi;Fh++)if(null!=(Fc=Fb[Fh]))if(FF=!1,Fc instanceof laya.html.dom.HTMLBrElement)FG(),FB.y=Fx;else{if(Fc._isChar()){if((Ff=Fc).isWord)FC=FD||"\n"===Ff.char,FB.wordStartIndex=FB.elements.length;else{if(0<FA.length&&Fq<Fw+Fy&&0<FB.wordStartIndex){var FH;FH=FB.elements.length-FB.wordStartIndex+1,FB.elements.length=FB.wordStartIndex,Fh-=FH,FG();continue}FC=!1,FE+=Ff.width}Fy=Ff.width+Fm,Fz=Ff.height,FD=!1,(FC=FC||Fq<Fw+Fy)&&FG(),FB.minTextHeight=Math.min(FB.minTextHeight,Fc.height)}else Fd=Fc._getCSSStyle(),Fg=Fc,Fe=Fd.padding,0===Fd._getCssFloat()||(Fv=!0),FC=FD||Fd.lineElement,Fy=Fg.width*Fg._style._tf.scaleX+Fe[1]+Fe[3]+Fm,Fz=Fg.height*Fg._style._tf.scaleY+Fe[0]+Fe[2],FD=Fd.lineElement,(FC=FC||Fq<Fw+Fy&&Fd.wordWrap)&&FG();FB.elements.push(Fc),FB.h=Math.max(FB.h,Fz),Fc.x=Fw,Fc.y=Fx,Fw+=Fy,FB.w=Fw-Fm,FB.y=Fx,Fr=Math.max(Fw+Fs,Fr)}else FF||(Fw+=FK.DIV_ELEMENT_PADDING),FB.wordStartIndex=FB.elements.length;if(Fx=FB.y+FB.h,Fv){var FI=0,FJ=Fq;for(Fh=0,Fi=FA.length;Fh<Fi;Fh++)FA[Fh].updatePos(0,FJ,Fh,FI,Ft,Fu,Fo),FI+=Math.max(Fo,FA[Fh].h+Fn);Fx=FI}for(Fp&&(Fa.width=Fr),Fx>Fa.height&&(Fa.height=Fx),Fh=0,Fi=FA.length;Fh<Fi;Fh++)FA[Fh].revertOrder(Fq);return[Fr,Fx]},FK._will=null,FK.DIV_ELEMENT_PADDING=0,FK}(),FM=function(){function Fa(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}Fg(Fa,"laya.html.utils.LayoutLine");var Fb=Fa.prototype;return Fb.updatePos=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){var Fh,Fi=0;0<this.elements.length&&(Fi=(Fh=this.elements[this.elements.length-1]).x+Fh.width-this.elements[0].x);var Fj=0,Fm=NaN;1===Fe&&(Fj=(Fb-Fi)/2),2===Fe&&(Fj=Fb-Fi),0===Fg||0!=Ff||(Ff=1);for(var Fn=0,Fo=this.elements.length;Fn<Fo;Fn++){var Fp=(Fh=this.elements[Fn])._getCSSStyle();switch(0!==Fj&&(Fh.x+=Fj),Fp._getValign()){case 0:Fh.y=Fd;break;case 1:var Fq=0;99999!=this.minTextHeight&&(Fq=this.minTextHeight);var Fr=(Fq+Fg)/2;Fr=Math.max(Fr,this.h),Fm=(laya.html.dom.HTMLImageElement,Fd+Fr-Fh.height),Fh.y=Fm;break;case 2:Fh.y=Fd+(Fg-Fh.height)}}},Fb.revertOrder=function(Fa){var Fb;if(0<this.elements.length){var Fc,Fd=0;for(Fc=this.elements.length,Fd=0;Fd<Fc;Fd++)(Fb=this.elements[Fd]).x=Fa-Fb.x-Fb.width}},Fa}(),Fx=function(Fc){function Fb(){this.URI=null,this._href=null,Fb.__super.call(this),this._text=Fb._EMPTYTEXT,this.setStyle(new Fi(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}Fg(Fb,"laya.html.dom.HTMLElement",Fc);var Fa=Fb.prototype;return Fa.layaoutCallNative=function(){var Fa=0;if(this._childs&&0<(Fa=this._childs.length))for(var Fb=0;Fb<Fa;Fb++)this._childs[Fb].layaoutCallNative&&this._childs[Fb].layaoutCallNative();var Fc=this._getWords();Fc?laya.html.dom.HTMLElement.fillWords(this,Fc,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},Fa.appendChild=function(Fa){return this.addChild(Fa)},Fa._getWords2=function(){var Fa=this._text.text;if(!Fa||0===Fa.length)return null;var Fb,Fc,Fd=0,Fe=0;if(this._text.drawWords)Fc=this._text.drawWords;else{for(Fe=(Fb=Fa.split(" ")).length-1,Fc=[],Fd=0;Fd<Fe;Fd++)Fc.push(Fb[Fd]," ");0<=Fe&&Fc.push(Fb[Fe]),this._text.drawWords=Fc}var Ff,Fg=this._text.words;if(Fg&&Fg.length===Fc.length)return Fg;null===Fg&&(this._text.words=Fg=[]),Fg.length=Fc.length;var Fh=this.style,Fi=Fh.font;for(Fd=0,Fe=Fc.length;Fd<Fe;Fd++){Ff=Fu.measureText(Fc[Fd],Fi);var Fj=Fg[Fd]=new Fn(Fc[Fd],Ff.width,Ff.height||Fh.fontSize,Fh);if(1<Fj.char.length&&(Fj.charNum=Fj.char),this.href){var Fm=new Fp;this.addChild(Fm),Fj.setSprite(Fm)}}return Fg},Fa._getWords=function(){if(!FL.CharacterCache)return this._getWords2();var Fa=this._text.text;if(!Fa||0===Fa.length)return null;var Fb,Fc=this._text.words;if(Fc&&Fc.length===Fa.length)return Fc;null===Fc&&(this._text.words=Fc=[]),Fc.length=Fa.length;for(var Fd=this.style,Fe=Fd.font,Ff=0,Fg=Fa.length;Ff<Fg;Ff++)if(Fb=Fu.measureText(Fa.charAt(Ff),Fe)){var Fh=Fc[Ff]=new Fn(Fa.charAt(Ff),Fb.width,Fb.height||Fd.fontSize,Fd);if(this.href){var Fi=new Fp;this.addChild(Fi),Fh.setSprite(Fi)}}else console.warn("_getWords size is null"+Fa.charAt(Ff),Fe);return Fc},Fa.showLinkSprite=function(){var Fa=this._text.words;if(Fa)for(var Fb,Fc,Fd=[],Fe=0;Fe<Fa.length;Fe++)Fc=Fa[Fe],(Fb=new Fp).graphics.drawRect(0,0,Fc.width,Fc.height,"#ff0000"),Fb.width=Fc.width,Fb.height=Fc.height,this.addChild(Fb),Fd.push(Fb)},Fa._layoutLater=function(){var Fa=this.style;512&Fa._type||(Fa.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&Fa.block?(Fw.later(this),Fa._type|=512):this.parent&&this.parent._layoutLater())},Fa._setAttributes=function(Fa,Fb){switch(Fa){case"style":return void this.style.cssText(Fb);case"class":return void(this.className=Fb)}Fc.prototype._setAttributes.call(this,Fa,Fb)},Fa.updateHref=function(){if(null!=this._href){var Fa=this._getWords();if(Fa)for(var Fb,Fc,Fd=0;Fd<Fa.length;Fd++)(Fc=(Fb=Fa[Fd]).getSprite())&&(Fc.size(Fb.width,Fb.height),Fc.on("click",this,this.onLinkHandler))}},Fa.onLinkHandler=function(Fa){switch(Fa.type){case"click":for(var Fb=this;Fb;)Fb.event("link",[this.href]),Fb=Fb.parent}},Fa.formatURL=function(Fa){return this.URI?Ft.formatURL(Fa,this.URI?this.URI.path:null):Fa},Fh(0,Fa,"href",function(){return this._href},function(Fa){null!=(this._href=Fa)&&(this._getCSSStyle().underLine=1,this.updateHref())}),Fh(0,Fa,"color",null,function(Fa){this.style.color=Fa}),Fh(0,Fa,"onClick",null,function(Fa){Fd._runScript("fn=function(event){"+Fa+";}"),this.on("click",this,void 0)}),Fh(0,Fa,"id",null,function(Fa){Fy.document.setElementById(Fa,this)}),Fh(0,Fa,"innerTEXT",function(){return this._text.text},function(Fa){this.text=Fa}),Fh(0,Fa,"style",function(){return this._style}),Fh(0,Fa,"text",function(){return this._text.text},function(Fa){this._text==Fb._EMPTYTEXT?this._text={text:Fa,words:null}:(this._text.text=Fa,this._text.words&&(this._text.words.length=0)),Fo.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),Fh(0,Fa,"parent",Fc.prototype._$get_parent,function(Fa){if(Fa instanceof laya.html.dom.HTMLElement){var Fb=Fa;this.URI||(this.URI=Fb.URI),this.style.inherit(Fb.style)}Fd.superSet(Fp,this,"parent",Fa)}),Fh(0,Fa,"className",null,function(Fa){this.style.attrs(Fy.document.styleSheets["."+Fa])}),Fb.fillWords=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){Fa.graphics.clear();for(var Fh=0,Fi=Fb.length;Fh<Fi;Fh++){var Fj=Fb[Fh];Fa.graphics.fillText(Fj.char,Fj.x+Fc,Fj.y+Fd,Fe,Ff,"left",Fg)}},Fb._EMPTYTEXT={text:null,words:null},Fb}(Fp),Fb=(function(Fa){function Fb(){Fb.__super.call(this),this.style.lineElement=!0,this.style.block=!0}Fg(Fb,"laya.html.dom.HTMLBrElement",Fx)}(),function(Fa){function Fb(){this.contextHeight=NaN,this.contextWidth=NaN,Fb.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}Fg(Fb,"laya.html.dom.HTMLDivElement",Fa);var Fc=Fb.prototype;return Fc.appendHTML=function(Fa){Fv.parse(this,Fa,this.URI),this.layout()},Fc._addChildsToLayout=function(Fb){var Fa=this._getWords();if(null==Fa&&0==this._childs.length)return!1;Fa&&Fa.forEach(function(Fa){Fb.push(Fa)});for(var Fc=!0,Fd=0,Fe=this._childs.length;Fd<Fe;Fd++){var Ff=this._childs[Fd];Fc?Fc=!1:Fb.push(null),Ff._addToLayout(Fb)}return!0},Fc._addToLayout=function(Fa){this.layout()},Fc.layout=function(){if(this.style){this.style._type|=512;var Fa=Fw.layout(this);if(Fa){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new Fm);var Fb=this._$P.mHtmlBounds;Fb.x=Fb.y=0,Fb.width=this.contextWidth=Fa[0],Fb.height=this.contextHeight=Fa[1],this.setBounds(Fb)}}},Fh(0,Fc,"height",function(){return this._height?this._height:this.contextHeight},Fa.prototype._$set_height),Fh(0,Fc,"innerHTML",null,function(Fa){this.destroyChildren(),this.appendHTML(Fa)}),Fh(0,Fc,"width",function(){return this._width?this._width:this.contextWidth},function(Fa){var Fb=!1;Fb=0===Fa?Fa!=this._width:Fa!=this.width,Fd.superSet(Fx,this,"width",Fa),Fb&&this.layout()}),Fb}(Fx)),Fy=function(Fa){function Fb(){this.all=new Array,this.styleSheets=Fi.styleSheets,Fb.__super.call(this)}Fg(Fb,"laya.html.dom.HTMLDocument",Fx);var Fc=Fb.prototype;return Fc.getElementById=function(Fa){return this.all[Fa]},Fc.setElementById=function(Fa,Fb){this.all[Fa]=Fb},Fe(Fb,["document",function(){return this.document=new Fb}]),Fb}();(function(Fa){function Fb(){this._tex=null,this._url=null,this._renderArgs=[],Fb.__super.call(this),this.style.block=!0}Fg(Fb,"laya.html.dom.HTMLImageElement",Fx);var Fc=Fb.prototype;Fc._addToLayout=function(Fa){!this._style.absolute&&Fa.push(this)},Fc.render=function(Fa,Fb,Fc){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(Fr.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,Fa.ctx.drawTexture2(Fb,Fc,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},Fc.layaoutCallNative=function(){var Fa=0;if(this._childs&&0<(Fa=this._childs.length))for(var Fb=0;Fb<Fa;Fb++)this._childs[Fb].layaoutCallNative&&this._childs[Fb].layaoutCallNative()},Fh(0,Fc,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Fa){this._width!==Fa&&(this._width=Fa,this._style.width=Fa,this.repaint())}),Fh(0,Fc,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Fa){this._height!==Fa&&(this._height=Fa,this._style.height=Fa,this.repaint())}),Fc.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),Fj.clearCache(this,this._url),this._tex=null),Fx.prototype.destroy.call(this)},Fc.onloaded=function(){var Fa=this._style;Fa&&!Fa.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),Fa&&!Fa.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),Fo.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},Fc._loadImageComplete=function(Fa,Fb,Fc){if(!this._destroyed)if(null!=Fc)if(Fc instanceof ArrayBuffer){var Fd=new DataView(Fc);new laya.webgl.resource.WebGLImage(new Uint8Array(Fc,8),Fa,0,!1,Fd.getUint32(0),Fd.getUint32(4));this.onloaded()}else if(Fc instanceof Fs)Fj.imgMgrSet[Fa]=Fb,Ff.imgMgrLock(Fa,Fj.imgMgrSet[Fa]),this._url=Fa,this._tex=Fc,Fj.keepCache(this,Fa),Fj.cacheRes(Fa,this._tex),this.onloaded();else{var Fe=-1!=Fa.indexOf(".png",Fa.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(Fc,Fa,Fe,!1,Fc.width,Fc.height);this.onloaded()}else this.event("error","Load image failed")},Fh(0,Fc,"src",null,function(Fa){(Fa=this.formatURL(Fa),this._url!=Fa)&&(null!=this._tex&&(Fj.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=Fa,(this._tex=Fj.getRes(Fa))?(Fj.keepCache(this,Fa),this.onloaded()):Ff.imgMgrLoad(Fa,this._loadImageComplete.bind(this),2,!1))})})(),function(Fa){function Fb(){this.type=null,Fb.__super.call(this),this.visible=!1}Fg(Fb,"laya.html.dom.HTMLLinkElement",Fa);var Fc=Fb.prototype;Fc._onload=function(Fa){switch(this.type){case"text/css":Fi.parseCSS(Fa,this.URI)}},Fh(0,Fc,"href",Fa.prototype._$get_href,function(Fa){var Fb=this;Fa=this.formatURL(Fa),this.URI=new Ft(Fa);var Fc=new Fj;Fc.once("complete",null,function(Fa){Fb._onload(Fa)}),Fc.load(Fa,"text")}),Fb._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(Fx),function(Fa){function Fb(){Fb.__super.call(this),this.visible=!1}Fg(Fb,"laya.html.dom.HTMLStyleElement",Fa),Fh(0,Fb.prototype,"text",Fa.prototype._$get_text,function(Fa){Fi.parseCSS(Fa,null)})}(Fx),function(Fa){function Fb(){Fb.__super.call(this),this._getCSSStyle().valign="middle"}Fg(Fb,"laya.html.dom.HTMLIframeElement",Fa),Fh(0,Fb.prototype,"href",Fa.prototype._$get_href,function(Fc){var Fd=this;Fc=this.formatURL(Fc);var Fa=new Fj;Fa.once("complete",null,function(Fa){var Fb=Fd.URI;Fd.URI=new Ft(Fc),Fd.innerHTML=Fa,!Fb||(Fd.URI=Fb)}),Fa.load(Fc,"text")})}(Fb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Fa,Fb){"use strict";for(var Fc in Object.defineProperty(Fb,"__esModule",{value:!0}),Laya){var Fd=Laya[Fc];Fd&&Fd.__isclass&&(Fb[Fc]=Fd)}}),function(Fe,Fa,Fr){Fr.un,Fr.uns;var Fd=Fr.static,Ff=Fr.class,Fg=Fr.getset,Fc=(Fr.__newvec,laya.display.Animation),Fs=(laya.utils.Browser,laya.utils.ClassUtils),Fh=laya.filters.ColorFilter,Fi=laya.utils.Ease,Fj=laya.events.Event,Fm=(laya.events.EventDispatcher,laya.display.css.Font),Fn=laya.display.FrameAnimation,Fb=laya.display.Graphics,Fo=laya.utils.Handler,Fp=laya.display.Input,Fu=laya.net.Loader,Fq=(laya.display.Node,laya.maths.Point),Ft=laya.maths.Rectangle,Fv=laya.renders.Render,Fw=laya.display.Sprite,Fx=laya.display.Text,Fy=laya.resource.Texture,Fz=laya.utils.Tween,FA=laya.utils.Utils,FB=laya.utils.WeakObject;Fr.interface("laya.ui.IItem"),Fr.interface("laya.ui.ISelect"),Fr.interface("laya.ui.IRender"),Fr.interface("laya.ui.IComponent"),Fr.interface("laya.ui.IBox","IComponent");var FC=function(){function Fa(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return Ff(Fa,"laya.ui.LayoutStyle"),Fd(Fa,["EMPTY",function(){return this.EMPTY=new Fa}]),Fa}(),FD=function(){function Fa(){}return Ff(Fa,"laya.ui.Styles"),Fa.labelColor="#000000",Fa.buttonStateNum=3,Fa.scrollBarMinNum=15,Fa.scrollBarDelayTime=500,Fd(Fa,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),Fa}(),FE=function(){function Fe(){}return Ff(Fe,"laya.ui.UIUtils"),Fe.fillArray=function(Fa,Fb,Fc){var Fd=Fa.concat();if(Fb)for(var Fe=Fb.split(","),Ff=0,Fg=Math.min(Fd.length,Fe.length);Ff<Fg;Ff++){var Fh=Fe[Ff];Fd[Ff]="true"==Fh||"false"!=Fh&&Fh,null!=Fc&&(Fd[Ff]=Fc(Fh))}return Fd},Fe.toColor=function(Fa){return FA.toHexColor(Fa)},Fe.gray=function(Fa,Fb){void 0===Fb&&(Fb=!0),Fb?Fe.addFilter(Fa,Fe.grayFilter):Fe.clearFilter(Fa,Fh)},Fe.addFilter=function(Fa,Fb){var Fc=Fa.filters||[];Fc.push(Fb),Fa.filters=Fc},Fe.clearFilter=function(Fa,Fb){var Fc=Fa.filters;if(null!=Fc&&0<Fc.length){for(var Fd=Fc.length-1;-1<Fd;Fd--){var Fe=Fc[Fd];Fr.__typeof(Fe,Fb)&&Fc.splice(Fd,1)}Fa.filters=Fc}},Fe._getReplaceStr=function(Fa){return Fe.escapeSequence[Fa]},Fe.adptString=function(Fa){return Fa.replace(/\\(\w)/g,Fe._getReplaceStr)},Fe.getBindFun=function(Fa){var Fb=Fe._funMap.get(Fa);if(null==Fb){var Fc='"'+Fa+'"',Fd="(function(data){if(data==null)return;with(data){try{\nreturn "+(Fc=Fc.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";Fb=Fr._runScript(Fd),Fe._funMap.set(Fa,Fb)}return Fb},Fd(Fe,["grayFilter",function(){return this.grayFilter=new Fh([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new FB}]),Fe}(),FF=function(){function Fa(){}return Ff(Fa,"UIConfig"),Fa.touchScrollEnable=!0,Fa.mouseWheelEnable=!0,Fa.showButtons=!0,Fa.popupBgColor="#000000",Fa.popupBgAlpha=.5,Fa.closeDialogOnSide=!0,Fa}(),FG=function(Fc){function Ft(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,Ft.__super.call(this),this._weakKeys=[]}Ff(Ft,"laya.ui.AutoBitmap",Fc);var Fa=Ft.prototype;return Fa.destroy=function(){if(Fu.clearObject(this,this._weakKey),this._weakKeys){for(var Fa=0,Fb=this._weakKeys.length;Fa<Fb;++Fa)Fu.clearObject(this,this._weakKeys[Fa]);this._weakKeys=null}Fc.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},Fa._setChanged=function(){this._isChanged||(this._isChanged=!0,Fr.timer.callLater(this,this.changeSource))},Fa.changeSource=function(){this._isChanged=!1;var Fa=this._source;if(Fa&&Fa.bitmap){var Fb=this.width,Fc=this.height,Fd=this._sizeGrid,Fe=Fa.sourceWidth,Ff=Fa.sourceHeight;if(!Fd||Fe===Fb&&Ff===Fc)this.cleanByTexture(Fa,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,Fb,Fc);else{Fu.clearObject(this,this._weakKey),Fa.$_GID||(Fa.$_GID=FA.getGID());var Fg=Fa.$_GID+"."+Fb+"."+Fc+"."+Fd.join("."),Fh=Fu.findObject(Fg);if(FA.isOKCmdList(Fh))return this._weakKey=Fg,Fu.keepObject(this,this._weakKey),void(this.cmds=Fh);this.clear();var Fi,Fj,Fm=Fd[0],Fn=Fd[1],Fo=Fd[2],Fp=Fd[3],Fq=Fd[4],Fr=!1;if(Fb==Fe&&(Fp=Fn=0),Fc==Ff&&(Fm=Fo=0),Fb<Fp+Fn){var Fs=Fb;Fr=!0,Fb=Fp+Fn,this.save(),this.clipRect(0,0,Fs,Fc)}Fp&&Fm&&(Fi=Ft.getTexture(Fa,0,0,Fp,Fm),Fj=this._weakKeys[0],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[0]=Fi.weakKey),this.drawTexture(Fi,0,0,Fp,Fm)):(Fu.clearObject(this,Fj),this._weakKeys[0]="")),Fn&&Fm&&(Fi=Ft.getTexture(Fa,Fe-Fn,0,Fn,Fm),Fj=this._weakKeys[1],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[1]=Fi.weakKey),this.drawTexture(Fi,Fb-Fn,0,Fn,Fm)):(Fu.clearObject(this,Fj),this._weakKeys[1]="")),Fp&&Fo&&(Fi=Ft.getTexture(Fa,0,Ff-Fo,Fp,Fo),Fj=this._weakKeys[2],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[2]=Fi.weakKey),this.drawTexture(Fi,0,Fc-Fo,Fp,Fo)):(Fu.clearObject(this,Fj),this._weakKeys[2]="")),Fn&&Fo&&(Fi=Ft.getTexture(Fa,Fe-Fn,Ff-Fo,Fn,Fo),Fj=this._weakKeys[3],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[3]=Fi.weakKey),this.drawTexture(Fi,Fb-Fn,Fc-Fo,Fn,Fo)):(Fu.clearObject(this,Fj),this._weakKeys[3]="")),Fm&&(Fi=Ft.getTexture(Fa,Fp,0,Fe-Fp-Fn,Fm),Fj=this._weakKeys[4],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[4]=Fi.weakKey),this.drawBitmap(Fq,Fi,Fp,0,Fb-Fp-Fn,Fm)):(Fu.clearObject(this,Fj),this._weakKeys[4]="")),Fo&&(Fi=Ft.getTexture(Fa,Fp,Ff-Fo,Fe-Fp-Fn,Fo),Fj=this._weakKeys[5],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[5]=Fi.weakKey),this.drawBitmap(Fq,Fi,Fp,Fc-Fo,Fb-Fp-Fn,Fo)):(Fu.clearObject(this,Fj),this._weakKeys[5]="")),Fp&&(Fi=Ft.getTexture(Fa,0,Fm,Fp,Ff-Fm-Fo),Fj=this._weakKeys[6],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[6]=Fi.weakKey),this.drawBitmap(Fq,Fi,0,Fm,Fp,Fc-Fm-Fo)):(Fu.clearObject(this,Fj),this._weakKeys[6]="")),Fn&&(Fi=Ft.getTexture(Fa,Fe-Fn,Fm,Fn,Ff-Fm-Fo),Fj=this._weakKeys[7],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[7]=Fi.weakKey),this.drawBitmap(Fq,Fi,Fb-Fn,Fm,Fn,Fc-Fm-Fo)):(Fu.clearObject(this,Fj),this._weakKeys[7]="")),Fi=Ft.getTexture(Fa,Fp,Fm,Fe-Fp-Fn,Ff-Fm-Fo),Fj=this._weakKeys[8],Fi?(Fj!=Fi.weakKey&&(Fu.clearObject(this,Fj),Fu.keepObject(this,Fi.weakKey),this._weakKeys[8]=Fi.weakKey),this.drawBitmap(Fq,Fi,Fp,Fm,Fb-Fp-Fn,Fc-Fm-Fo)):(Fu.clearObject(this,Fj),this._weakKeys[8]=""),Fr&&this.restore(),this.autoCacheCmd&&!Fv.isConchApp&&(Fu.saveObject(Fg,this.cmds,null),this._weakKey=Fg,Fu.keepObject(this,this._weakKey))}this._repaint()}},Fa.drawBitmap=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=0),Fe<.1||Ff<.1||(!Fa||Fb.width==Fe&&Fb.height==Ff?this.drawTexture(Fb,Fc,Fd,Fe,Ff):this.fillTexture(Fb,Fc,Fd,Fe,Ff))},Fa.clear=function(Fa){void 0===Fa&&(Fa=!0),Fc.prototype.clear.call(this,!1)},Fg(0,Fa,"sizeGrid",function(){return this._sizeGrid},function(Fa){this._sizeGrid=Fa,this._setChanged()}),Fg(0,Fa,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(Fa){this._width!=Fa&&(this._width=Fa,this._setChanged())}),Fg(0,Fa,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(Fa){this._height!=Fa&&(this._height=Fa,this._setChanged())}),Fg(0,Fa,"source",function(){return this._source},function(Fa){Fa?(this._source=Fa,this._setChanged()):(this._source=null,this.clear())}),Ft.getTexture=function(Fa,Fb,Fc,Fd,Fe){Fd<=0&&(Fd=1),Fe<=0&&(Fe=1),Fa.$_GID||(Fa.$_GID=FA.getGID());var Ff=Fa.$_GID+"."+Fb+"."+Fc+"."+Fd+"."+Fe,Fg=Fu.findObject(Ff);if((!Fg||!Fg.source)&&(Fg=Fy.createFromTexture(Fa,Fb,Fc,Fd,Fe))){if(Fa.alphaTexture){var Fh=Fa.width/Fa.alphaTexture.width;Fg.alphaTexture=Fy.createFromTexture(Fa.alphaTexture,Fb/Fh,Fc/Fh,Fd/Fh,Fe/Fh)}Fu.saveObject(Ff,Fg),Fg.weakKey=Ff}return Fg},Ft}(Fb),FH=(function(Fa){function Fb(){Fb.__super.call(this)}Ff(Fb,"laya.ui.UIEvent",Fj),Fb.SHOW_TIP="showtip",Fb.HIDE_TIP="hidetip"}(),function(Fb){function Fa(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,Fa.__super.call(this),this._layout=FC.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}Ff(Fa,"laya.ui.Component",Fb);var Fc=Fa.prototype;return Fr.imps(Fc,{"laya.ui.IComponent":!0}),Fc.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},Fc.preinitialize=function(){},Fc.createChildren=function(){},Fc.initialize=function(){},Fc.callLater=function(Fa,Fb){Fr.timer.callLater(this,Fa,Fb)},Fc.runCallLater=function(Fa){Fr.timer.runCallLater(this,Fa)},Fc.commitMeasure=function(){},Fc.changeSize=function(){this.event("resize")},Fc.getLayout=function(){return this._layout===FC.EMPTY&&(this._layout=new FC),this._layout},Fc._setLayoutEnabled=function(Fa){this._layout&&this._layout.enable!=Fa&&(this._layout.enable=Fa,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},Fc.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},Fc.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},Fc.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},Fc.resetLayoutX=function(){var Fa=this._layout;if(isNaN(Fa.anchorX)||(this.pivotX=Fa.anchorX*this.width),this.layoutEnabled){var Fb=this.parent;Fb&&(isNaN(Fa.centerX)?isNaN(Fa.left)?isNaN(Fa.right)||(this.x=Math.round(Fb.width-this.displayWidth-Fa.right+this.pivotX*this.scaleX)):(this.x=Math.round(Fa.left+this.pivotX*this.scaleX),isNaN(Fa.right)||(this.width=(Fb._width-Fa.left-Fa.right)/(this.scaleX||.01))):this.x=Math.round(.5*(Fb.width-this.displayWidth)+Fa.centerX+this.pivotX*this.scaleX))}},Fc.resetLayoutY=function(){var Fa=this._layout;if(isNaN(Fa.anchorY)||(this.pivotY=Fa.anchorY*this.height),this.layoutEnabled){var Fb=this.parent;Fb&&(isNaN(Fa.centerY)?isNaN(Fa.top)?isNaN(Fa.bottom)||(this.y=Math.round(Fb.height-this.displayHeight-Fa.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(Fa.top+this.pivotY*this.scaleY),isNaN(Fa.bottom)||(this.height=(Fb._height-Fa.top-Fa.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(Fb.height-this.displayHeight)+Fa.centerY+this.pivotY*this.scaleY))}},Fc.onMouseOver=function(Fa){Fr.stage.event("showtip",this._toolTip)},Fc.onMouseOut=function(Fa){Fr.stage.event("hidetip",this._toolTip)},Fg(0,Fc,"displayWidth",function(){return this.width*this.scaleX}),Fg(0,Fc,"width",function(){return this._width?this._width:this.measureWidth},function(Fa){this._width!=Fa&&(this._width=Fa,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),Fg(0,Fc,"measureWidth",function(){var Fa=0;this.commitMeasure();for(var Fb=this.numChildren-1;-1<Fb;Fb--){var Fc=this.getChildAt(Fb);Fc.visible&&(Fa=Math.max(Fc.x+Fc.width*Fc.scaleX,Fa))}return Fa}),Fg(0,Fc,"displayHeight",function(){return this.height*this.scaleY}),Fg(0,Fc,"height",function(){return this._height?this._height:this.measureHeight},function(Fa){this._height!=Fa&&(this._height=Fa,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),Fg(0,Fc,"dataSource",function(){return this._dataSource},function(Fa){for(var Fb in this._dataSource=Fa,this._dataSource)this.hasOwnProperty(Fb)&&"function"!=typeof this[Fb]&&(this[Fb]=this._dataSource[Fb])}),Fg(0,Fc,"scaleY",Fb.prototype._$get_scaleY,function(Fa){Fr.superGet(Fw,this,"scaleY")!=Fa&&(Fr.superSet(Fw,this,"scaleY",Fa),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),Fg(0,Fc,"measureHeight",function(){var Fa=0;this.commitMeasure();for(var Fb=this.numChildren-1;-1<Fb;Fb--){var Fc=this.getChildAt(Fb);Fc.visible&&(Fa=Math.max(Fc.y+Fc.height*Fc.scaleY,Fa))}return Fa}),Fg(0,Fc,"scaleX",Fb.prototype._$get_scaleX,function(Fa){Fr.superGet(Fw,this,"scaleX")!=Fa&&(Fr.superSet(Fw,this,"scaleX",Fa),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),Fg(0,Fc,"top",function(){return this._layout.top},function(Fa){Fa!=this._layout.top&&(this.getLayout().top=Fa,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Fg(0,Fc,"bottom",function(){return this._layout.bottom},function(Fa){Fa!=this._layout.bottom&&(this.getLayout().bottom=Fa,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Fg(0,Fc,"left",function(){return this._layout.left},function(Fa){Fa!=this._layout.left&&(this.getLayout().left=Fa,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Fg(0,Fc,"right",function(){return this._layout.right},function(Fa){Fa!=this._layout.right&&(this.getLayout().right=Fa,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Fg(0,Fc,"centerX",function(){return this._layout.centerX},function(Fa){Fa!=this._layout.centerX&&(this.getLayout().centerX=Fa,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Fg(0,Fc,"centerY",function(){return this._layout.centerY},function(Fa){Fa!=this._layout.centerY&&(this.getLayout().centerY=Fa,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Fg(0,Fc,"anchorX",function(){return this._layout.anchorX},function(Fa){Fa!=this._layout.anchorX&&(this.getLayout().anchorX=Fa,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Fg(0,Fc,"anchorY",function(){return this._layout.anchorY},function(Fa){Fa!=this._layout.anchorY&&(this.getLayout().anchorY=Fa,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Fg(0,Fc,"tag",function(){return this._tag},function(Fa){this._tag=Fa}),Fg(0,Fc,"toolTip",function(){return this._toolTip},function(Fa){this._toolTip!=Fa&&(null!=(this._toolTip=Fa)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),Fg(0,Fc,"comXml",function(){return this._comXml},function(Fa){this._comXml=Fa}),Fg(0,Fc,"gray",function(){return this._gray},function(Fa){Fa!==this._gray&&(this._gray=Fa,FE.gray(this,Fa))}),Fg(0,Fc,"disabled",function(){return this._disabled},function(Fa){Fa!==this._disabled&&(this.gray=this._disabled=Fa,this.mouseEnabled=!Fa)}),Fa}(Fw)),FI=function(Fa){function Fb(){this.lockLayer=null,this.popupEffect=function(Fa){Fa.scale(1,1),Fz.from(Fa,{x:Fr.stage.width/2,y:Fr.stage.height/2,scaleX:0,scaleY:0},300,Fi.backOut,Fo.create(this,this.doOpen,[Fa]))},this.closeEffect=function(Fa,Fb){Fz.to(Fa,{x:Fr.stage.width/2,y:Fr.stage.height/2,scaleX:0,scaleY:0},300,Fi.strongOut,Fo.create(this,this.doClose,[Fa,Fb]))},Fb.__super.call(this),this.maskLayer=new Fw,this.popupEffectHandler=Fo.create(this,this.popupEffect,null,!1),this.closeEffectHandler=Fo.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,Fr.stage.addChild(this),Fr.stage.on("resize",this,this._onResize),FF.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}Ff(Fb,"laya.ui.DialogManager",Fw);var Fc=Fb.prototype;return Fc._closeOnSide=function(){var Fa=this.getChildAt(this.numChildren-1);Fa instanceof laya.ui.Dialog&&Fa.close("side")},Fc.setLockView=function(Fa){this.lockLayer||(this.lockLayer=new FJ,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(Fr.stage.width,Fr.stage.height)),this.lockLayer.removeChildren(),Fa&&(Fa.centerX=Fa.centerY=0,this.lockLayer.addChild(Fa))},Fc._onResize=function(Fa){var Fb=this.maskLayer.width=Fr.stage.width,Fc=this.maskLayer.height=Fr.stage.height;this.lockLayer&&this.lockLayer.size(Fb,Fc),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,Fb,Fc,FF.popupBgColor),this.maskLayer.alpha=FF.popupBgAlpha;for(var Fd=this.numChildren-1;-1<Fd;Fd--){var Fe=this.getChildAt(Fd);Fe.popupCenter&&this._centerDialog(Fe)}},Fc._centerDialog=function(Fa){Fa.x=Math.round((Fr.stage.width-Fa.width>>1)+Fa.pivotX),Fa.y=Math.round((Fr.stage.height-Fa.height>>1)+Fa.pivotY)},Fc.open=function(Fa,Fb,Fc){void 0===Fb&&(Fb=!1),void 0===Fc&&(Fc=!1),Fb&&this._closeAll(),Fa.popupCenter&&this._centerDialog(Fa),this.addChild(Fa),(Fa.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),Fc&&null!=Fa.popupEffect?Fa.popupEffect.runWith(Fa):this.doOpen(Fa),this.event("open")},Fc.doOpen=function(Fa){Fa.onOpened()},Fc.lock=function(Fa){this.lockLayer&&(Fa?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},Fc.close=function(Fa,Fb,Fc){void 0===Fc&&(Fc=!1),Fc&&null!=Fa.closeEffect?Fa.closeEffect.runWith([Fa,Fb]):this.doClose(Fa,Fb),this.event("close")},Fc.doClose=function(Fa,Fb){Fa.removeSelf(),Fa.isModal&&this._checkMask(),Fa.closeHandler&&Fa.closeHandler.runWith(Fb),Fa.onClosed(Fb)},Fc.closeAll=function(){this._closeAll(),this.event("close")},Fc._closeAll=function(){for(var Fa=this.numChildren-1;-1<Fa;Fa--){var Fb=this.getChildAt(Fa);Fb&&null!=Fb.close&&this.doClose(Fb)}},Fc.getDialogsByGroup=function(Fa){for(var Fb=[],Fc=this.numChildren-1;-1<Fc;Fc--){var Fd=this.getChildAt(Fc);Fd&&Fd.group===Fa&&Fb.push(Fd)}return Fb},Fc.closeByGroup=function(Fa){for(var Fb=[],Fc=this.numChildren-1;-1<Fc;Fc--){var Fd=this.getChildAt(Fc);Fd&&Fd.group===Fa&&(Fd.close(),Fb.push(Fd))}return Fb},Fc._checkMask=function(){this.maskLayer.removeSelf();for(var Fa=this.numChildren-1;-1<Fa;Fa--){var Fb=this.getChildAt(Fa);if(Fb&&Fb.isModal)return void this.addChildAt(this.maskLayer,Fa)}},Fb}(),FJ=function(Fa){function Fb(){Fb.__super.call(this)}Ff(Fb,"laya.ui.Box",Fa);var Fc=Fb.prototype;return Fr.imps(Fc,{"laya.ui.IBox":!0}),Fg(0,Fc,"dataSource",Fa.prototype._$get_dataSource,function(Fa){for(var Fb in this._dataSource=Fa){var Fc=this.getChildByName(Fb);Fc?Fc.dataSource=Fa[Fb]:this.hasOwnProperty(Fb)&&"function"!=typeof this[Fb]&&(this[Fb]=Fa[Fb])}}),Fb}(FH),FK=function(Fb){function Fc(Fa,Fb){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,Fc.__super.call(this),this._labelColors=FD.buttonLabelColors,this._stateNum=FD.buttonStateNum,void 0===Fb&&(Fb=""),this.skin=Fa,this.label=Fb}Ff(Fc,"laya.ui.Button",Fb);var Fa=Fc.prototype;return Fr.imps(Fa,{"laya.ui.ISelect":!0}),Fa.destroy=function(Fa){this.clearEvent(),Fu.clearCache(this,this._skin),Fu.clearObject(this,this._weakKey),void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(Fa),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},Fa.clearEvent=function(){this._skin&&Fe.atalsNotify&&Fe.atalsNotify.off(this._skin,this,this._setBtnSource)},Fa.createChildren=function(){this.graphics=this._bitmap=new FG},Fa.createText=function(){this._text||(this._text=new Fx,this._text.overflow=Fx.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},Fa.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},Fa.onMouse=function(Fa){if(!1!==this.toggle||!this._selected)return"click"===Fa.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=Fc.stateMap[Fa.type]))},Fa.changeClips=function(){var Fa=Fu.getRes(this._skin);if(Fa)if(this._skin&&""!=this._skin){Fu.clearObject(this,this._weakKey);var Fb=Fa.sourceWidth,Fc=Fa.sourceHeight/this._stateNum;Fa.$_GID||(Fa.$_GID=FA.getGID());var Fd=Fa.$_GID+"-"+this._stateNum,Fe=Fu.findObject(Fd);if(FA.isOkTextureList(Fe)||(Fe=null),Fe)this._weakKey=Fd,Fu.keepObject(this,this._weakKey),this._sources=Fe;else{if(this._sources=[],1===this._stateNum)this._sources.push(Fa);else for(var Ff=0;Ff<this._stateNum;Ff++){var Fg=Fy.createFromTexture(Fa,0,Fc*Ff,Fb,Fc);if(Fa.alphaTexture){var Fh=Fa.width/Fa.alphaTexture.width;Fg.alphaTexture=Fy.createFromTexture(Fa.alphaTexture,0/Fh,Fc*Ff/Fh,Fb/Fh,Fc/Fh)}this._sources.push(Fg)}Fu.saveObject(Fd,this._sources),this._weakKey=Fd,Fu.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||Fb,this._bitmap.height=this._height||Fc,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=Fb)}else console.warn("lose skin ",this._skin,this.name,this.__className)},Fa.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var Fa=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[Fa]),this.label&&(this._text.color=this._labelColors[Fa],this._strokeColors&&(this._text.strokeColor=this._strokeColors[Fa]))},Fa._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},Fg(0,Fa,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(Fa){this.createText(),this._text.strokeColor=Fa}),Fg(0,Fa,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),Fg(0,Fa,"skin",function(){return this._skin},function(Fa){if(this._skin!=Fa)if(this.clearEvent(),Fu.clearCache(this,this._skin),this._skin=Fa,Fu.keepCache(this,this._skin),Fu.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var Fb=Fe.resAtalsObj&&Fe.resAtalsObj[this._skin];Fb?(Fe.atalsNotify&&Fe.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=Fb.sourceW),0==this.height&&(this.height=Fb.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),Fa._setBtnSource=function(Fa,Fb){Fa===this._skin&&Fb&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},Fg(0,Fa,"state",function(){return this._state},function(Fa){this._state!=Fa&&(this._state=Fa,this._setStateChanged())}),Fg(0,Fa,"text",function(){return this.createText(),this._text}),Fg(0,Fa,"stateNum",function(){return this._stateNum},function(Fa){"string"==typeof Fa&&(Fa=parseInt(Fa)),this._stateNum!=Fa&&(this._stateNum=Fa<1?1:3<Fa?3:Fa,this.callLater(this.changeClips))}),Fg(0,Fa,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(Fa){this._strokeColors=FE.fillArray(FD.buttonLabelColors,Fa,String),this._setStateChanged()}),Fg(0,Fa,"labelColors",function(){return this._labelColors.join(",")},function(Fa){this._labelColors=FE.fillArray(FD.buttonLabelColors,Fa,String),this._setStateChanged()}),Fg(0,Fa,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),Fg(0,Fa,"label",function(){return this._text?this._text.text:null},function(Fa){(this._text||Fa)&&(this.createText(),this._text.text!=Fa&&(Fa&&!this._text.parent&&this.addChild(this._text),this._text.text=(Fa+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),Fg(0,Fa,"selected",function(){return this._selected},function(Fa){this._selected!=Fa&&(this._selected=Fa,this.state=this._selected?2:0,this.event("change"))}),Fg(0,Fa,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(Fa){this.createText(),this._text.padding=FE.fillArray(FD.labelPadding,Fa,Number)}),Fg(0,Fa,"labelSize",function(){return this.createText(),this._text.fontSize},function(Fa){this.createText(),this._text.fontSize=Fa}),Fg(0,Fa,"labelStroke",function(){return this.createText(),this._text.stroke},function(Fa){this.createText(),this._text.stroke=Fa}),Fg(0,Fa,"labelBold",function(){return this.createText(),this._text.bold},function(Fa){this.createText(),this._text.bold=Fa}),Fg(0,Fa,"labelFont",function(){return this.createText(),this._text.font},function(Fa){this.createText(),this._text.font=Fa}),Fg(0,Fa,"labelAlign",function(){return this.createText(),this._text.align},function(Fa){this.createText(),this._text.align=Fa}),Fg(0,Fa,"clickHandler",function(){return this._clickHandler},function(Fa){this._clickHandler=Fa}),Fg(0,Fa,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Fa){this._bitmap.sizeGrid=FE.fillArray(FD.defaultSizeGrid,Fa,Number)}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(FH,this,"width",Fa),this._autoSize&&(this._bitmap.width=Fa,this._text&&(this._text.width=Fa))}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(FH,this,"height",Fa),this._autoSize&&(this._bitmap.height=Fa,this._text&&(this._text.height=Fa))}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)||"string"==typeof Fa?this.label=Fa+"":Fr.superSet(FH,this,"dataSource",Fa)}),Fg(0,Fa,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(Fa){this._bitmap._offset=Fa?FE.fillArray([1,1],Fa,Number):[]}),Fd(Fc,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),Fc}(FH),FL=function(Fb){function Fd(Fa,Fb,Fc){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,Fd.__super.call(this),void 0===Fb&&(Fb=1),void 0===Fc&&(Fc=1),this._clipX=Fb,this._clipY=Fc,this.skin=Fa}Ff(Fd,"laya.ui.Clip",Fb);var Fa=Fd.prototype;return Fa.destroy=function(Fa){this.clearEvent(),Fu.clearCache(this,this._skin),Fu.clearObject(this,this._weakKey),void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,!0),(this._complete||this._progress)&&Fr.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null,this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},Fa.dispose=function(){this.destroy(!0),Fr.loader.clearRes(this._skin)},Fa.createChildren=function(){this.graphics=this._bitmap=new FG},Fa._onDisplay=function(Fa){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},Fa.changeClip=function(){if(this._clipChanged=!1,this._skin){var Fa=Fu.getRes(this._skin);if(Fa)this.loadComplete(this._skin,Fa);else{if(Fe.resAtalsObj&&Fe.resAtalsObj[this._skin])return;(this._complete||this._progress)&&Fr.loader.cancel(this._skin,this._complete,this._progress),this._complete=Fo.create(this,this.loadComplete,[this._skin],!1),this._progress=null,Fr.loader.load(this._skin,this._complete,this._progress)}}},Fa.loadComplete=function(Fa,Fb){if(Fa===this._skin&&Fb){Fu.clearObject(this,this._weakKey);var Fc=this._clipWidth||Math.ceil(Fb.sourceWidth/this._clipX),Fd=this._clipHeight||Math.ceil(Fb.sourceHeight/this._clipY),Fe=this._skin+Fc+Fd,Ff=Fu.findObject(Fe);if(FA.isOkTextureList(Ff)||(Ff=null),Ff)this._weakKey=Fe,Fu.keepObject(this,this._weakKey),this._sources=Ff;else{this._sources=[];for(var Fg=0;Fg<this._clipY;Fg++)for(var Fh=0;Fh<this._clipX;Fh++){var Fi=Fy.createFromTexture(Fb,Fc*Fh,Fd*Fg,Fc,Fd);if(Fb.alphaTexture){var Fj=Fb.width/Fb.alphaTexture.width;Fi.alphaTexture=Fy.createFromTexture(Fb.alphaTexture,Fc*Fh/Fj,Fd*Fg/Fj,Fc/Fj,Fd/Fj)}this._sources.push(Fi)}Fu.saveObject(Fe,this._sources),this._weakKey=Fe,Fu.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},Fa.play=function(Fa,Fb){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=-1),this._isPlaying=!0,this.index=Fa,this._toIndex=Fb,this._index++,Fr.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},Fa._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},Fa.stop=function(){this._isPlaying=!1,Fr.timer.clear(this,this._loop),this.event("complete")},Fa._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},Fg(0,Fa,"interval",function(){return this._interval},function(Fa){this._interval!=Fa&&(this._interval=Fa,this._isPlaying&&this.play())}),Fa.clearEvent=function(){this._skin&&Fe.atalsNotify&&Fe.atalsNotify.off(this._skin,this,this._setBtnSource)},Fg(0,Fa,"skin",function(){return this._skin},function(Fa){if(this._skin!=Fa)if(this.clearEvent(),Fu.clearCache(this,this._skin),this._skin=Fa){Fu.keepCache(this,this._skin);var Fb=Fu.getRes(Fa),Fc=Fe.resAtalsObj&&Fe.resAtalsObj[this._skin];!Fb&&Fc?Fe.atalsNotify&&Fe.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),Fa._setBtnSource=function(Fa,Fb){Fa===this._skin&&Fb&&(this.loadComplete(Fa,Fb),this.clearEvent())},Fg(0,Fa,"sources",function(){return this._sources},function(Fa){this._sources=Fa,this.index=this._index,this.event("loaded")}),Fg(0,Fa,"clipX",function(){return this._clipX},function(Fa){this._clipX=Fa||1,this._setClipChanged()}),Fg(0,Fa,"clipY",function(){return this._clipY},function(Fa){this._clipY=Fa||1,this._setClipChanged()}),Fg(0,Fa,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),Fg(0,Fa,"clipWidth",function(){return this._clipWidth},function(Fa){this._clipWidth=Fa,this._setClipChanged()}),Fg(0,Fa,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Fa){this._bitmap.sizeGrid=FE.fillArray(FD.defaultSizeGrid,Fa,Number)}),Fg(0,Fa,"group",function(){return this._group},function(Fa){Fa&&this._skin&&Fu.setGroup(this._skin,Fa),this._group=Fa}),Fg(0,Fa,"clipHeight",function(){return this._clipHeight},function(Fa){this._clipHeight=Fa,this._setClipChanged()}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(FH,this,"width",Fa),this._bitmap.width=Fa}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(FH,this,"height",Fa),this._bitmap.height=Fa}),Fg(0,Fa,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),Fg(0,Fa,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),Fg(0,Fa,"index",function(){return this._index},function(Fa){this._index=Fa,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[Fa]),this.event("change")}),Fg(0,Fa,"autoPlay",function(){return this._autoPlay},function(Fa){this._autoPlay!=Fa&&((this._autoPlay=Fa)?this.play():this.stop())}),Fg(0,Fa,"isPlaying",function(){return this._isPlaying},function(Fa){this._isPlaying=Fa}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)&&Math.floor(Fa)==Fa||"string"==typeof Fa?this.index=parseInt(Fa):Fr.superSet(FH,this,"dataSource",Fa)}),Fg(0,Fa,"bitmap",function(){return this._bitmap}),Fd}(FH),FM=function(Fb){function Fa(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,Fa.__super.call(this)}Ff(Fa,"laya.ui.ColorPicker",Fb);var Fc=Fa.prototype;return Fc.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._colorPanel&&this._colorPanel.destroy(Fa),this._colorButton&&this._colorButton.destroy(Fa),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},Fc.createChildren=function(){this.addChild(this._colorButton=new FK),this._colorPanel=new FJ,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new Fw),this._colorPanel.addChild(this._colorBlock=new Fw),this._colorPanel.addChild(this._colorInput=new Fp)},Fc.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},Fc.onPanelMouseDown=function(Fa){Fa.stopPropagation()},Fc.changePanel=function(){this._panelChanged=!1;var Fa=this._colorPanel.graphics;Fa.clear(),Fa.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(Fa=this._colorTiles.graphics).clear();for(var Fb=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],Fc=0;Fc<12;Fc++)for(var Fd=0;Fd<20;Fd++){var Fe=0;Fe=0===Fd?Fb[Fc]:1===Fd?0:51*(((3*Fc+Fd/6)%3<<0)+3*(Fc/6<<0))<<16|Fd%6*51<<8|(Fc<<0)%6*51;var Ff=FE.toColor(Fe);this._colors.push(Ff);var Fg=Fd*this._gridSize,Fh=Fc*this._gridSize;Fa.drawRect(Fg,Fh,this._gridSize,this._gridSize,Ff,"#000000")}},Fc.onColorButtonClick=function(Fa){this._colorPanel.parent?this.close():this.open()},Fc.open=function(){var Fa=this.localToGlobal(new Fq),Fb=Fa.x+this._colorPanel.width<=Fr.stage.width?Fa.x:Fr.stage.width-this._colorPanel.width,Fc=Fa.y+this._colorButton.height;Fc=Fc+this._colorPanel.height<=Fr.stage.height?Fc:Fa.y-this._colorPanel.height,this._colorPanel.pos(Fb,Fc),this._colorPanel.zOrder=1001,Fr._currentStage.addChild(this._colorPanel),Fr.stage.on("mousedown",this,this.removeColorBox)},Fc.close=function(){Fr.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},Fc.removeColorBox=function(Fa){this.close()},Fc.onColorFieldKeyDown=function(Fa){13==Fa.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),Fa.stopPropagation())},Fc.onColorInputChange=function(Fa){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},Fc.onColorTilesClick=function(Fa){this.selectedColor=this.getColorByMouse(),this.close()},Fc.onColorTilesMouseMove=function(Fa){this._colorInput.focus=!1;var Fb=this.getColorByMouse();this._colorInput.text=Fb,this.drawBlock(Fb)},Fc.getColorByMouse=function(){var Fa=this._colorTiles.getMousePoint(),Fb=Math.floor(Fa.x/this._gridSize),Fc=Math.floor(Fa.y/this._gridSize);return this._colors[20*Fc+Fb]},Fc.drawBlock=function(Fa){var Fb=this._colorBlock.graphics;Fb.clear();var Fc=Fa||"#ffffff";Fb.drawRect(0,0,50,20,Fc,this._borderColor),Fa||Fb.drawLine(0,0,50,20,"#ff0000")},Fc.changeColor=function(){var Fa=this.graphics;Fa.clear();var Fb=this._selectedColor||"#000000";Fa.drawRect(0,0,this._colorButton.width,this._colorButton.height,Fb)},Fc._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},Fg(0,Fc,"inputBgColor",function(){return this._inputBgColor},function(Fa){this._inputBgColor=Fa,this._setPanelChanged()}),Fg(0,Fc,"selectedColor",function(){return this._selectedColor},function(Fa){this._selectedColor!=Fa&&(this._selectedColor=this._colorInput.text=Fa,this.drawBlock(Fa),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",Fj.EMPTY.setTo("change",this,this)))}),Fg(0,Fc,"skin",function(){return this._colorButton.skin},function(Fa){this._colorButton.skin=Fa,this.changeColor()}),Fg(0,Fc,"bgColor",function(){return this._bgColor},function(Fa){this._bgColor=Fa,this._setPanelChanged()}),Fg(0,Fc,"borderColor",function(){return this._borderColor},function(Fa){this._borderColor=Fa,this._setPanelChanged()}),Fg(0,Fc,"inputColor",function(){return this._inputColor},function(Fa){this._inputColor=Fa,this._setPanelChanged()}),Fa}(FH),FN=function(Fb){function Fc(Fa,Fb){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,Fc.__super.call(this),this._itemColors=FD.comboBoxItemColors,this.skin=Fa,this.labels=Fb}Ff(Fc,"laya.ui.ComboBox",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._button&&this._button.destroy(Fa),this._list&&this._list.destroy(Fa),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},Fa.createChildren=function(){this.addChild(this._button=new FK),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},Fa._createList=function(){this._list=new FX,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},Fa._setListEvent=function(Fa){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=Fo.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},Fa.onListDown=function(Fa){Fa.stopPropagation()},Fa.onScrollBarDown=function(Fa){Fa.stopPropagation()},Fa.onButtonMouseDown=function(Fa){this.callLater(this.switchTo,[!this._isOpen])},Fa.changeList=function(){this._listChanged=!1;var Fa=this.width-2,Fb=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:Fa,height:this._itemHeight,fontSize:this._itemSize,color:Fb}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},Fa.onlistItemMouse=function(Fa,Fb){var Fc=Fa.type;if("mouseover"===Fc||"mouseout"===Fc){if(this._isCustomList)return;var Fd=this._list.getCell(Fb);if(!Fd)return;var Fe=Fd.getChildByName("label");Fe&&("mouseover"===Fc?(Fe.bgColor=this._itemColors[0],Fe.color=this._itemColors[1]):(Fe.bgColor=null,Fe.color=this._itemColors[2]))}else"click"===Fc&&(this.selectedIndex=Fb,this.isOpen=!1)},Fa.switchTo=function(Fa){this.isOpen=Fa},Fa.changeOpen=function(){this.isOpen=!this._isOpen},Fa.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var Fa=this._list.graphics;Fa.clear(),Fa.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var Fb=this._list.array||[],Fc=Fb.length=0,Fd=this._labels.length;Fc<Fd;Fc++)Fb.push({label:this._labels[Fc]});this._list.height=this._listHeight,this._list.array=Fb},Fa.changeSelected=function(){this._button.label=this.selectedLabel},Fa._onStageMouseWheel=function(Fa){this._list&&!this._list.contains(Fa.target)&&this.removeList(null)},Fa.removeList=function(Fa){Fr.stage.off("mousedown",this,this.removeList),Fr.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},Fg(0,Fa,"selectedIndex",function(){return this._selectedIndex},function(Fa){this._selectedIndex!=Fa&&(this._selectedIndex=Fa,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[Fj.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),Fg(0,Fa,"measureHeight",function(){return this._button.height}),Fg(0,Fa,"skin",function(){return this._button.skin},function(Fa){this._button.skin!=Fa&&(this._button.skin=Fa,this._listChanged=!0)}),Fg(0,Fa,"measureWidth",function(){return this._button.width}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(FH,this,"width",Fa),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),Fg(0,Fa,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(Fa){this.selectedIndex=this._labels.indexOf(Fa)}),Fg(0,Fa,"labels",function(){return this._labels.join(",")},function(Fa){0<this._labels.length&&(this.selectedIndex=-1),Fa?this._labels=Fa.split(","):this._labels.length=0,this._itemChanged=!0}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(FH,this,"height",Fa),this._button.height=this._height}),Fg(0,Fa,"selectHandler",function(){return this._selectHandler},function(Fa){this._selectHandler=Fa}),Fg(0,Fa,"visibleNum",function(){return this._visibleNum},function(Fa){this._visibleNum=Fa,this._listChanged=!0}),Fg(0,Fa,"labelBold",function(){return this._button.text.bold},function(Fa){this._button.text.bold=Fa}),Fg(0,Fa,"itemColors",function(){return String(this._itemColors)},function(Fa){this._itemColors=FE.fillArray(this._itemColors,Fa,String),this._listChanged=!0}),Fg(0,Fa,"itemSize",function(){return this._itemSize},function(Fa){this._itemSize=Fa,this._listChanged=!0}),Fg(0,Fa,"scrollBar",function(){return this.list.scrollBar}),Fg(0,Fa,"isOpen",function(){return this._isOpen},function(Fa){if(this._isOpen!=Fa)if(this._isOpen=Fa,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var Fb=this.localToGlobal(Fq.TEMP.setTo(0,0)),Fc=Fb.y+this._button.height;Fc=Fc+this._listHeight<=Fr.stage.height?Fc:Fb.y-this._listHeight,this._list.pos(Fb.x,Fc),this._list.zOrder=1001,Fr._currentStage.addChild(this._list),Fr.stage.once("mousedown",this,this.removeList),Fr.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),Fg(0,Fa,"scrollBarSkin",function(){return this._scrollBarSkin},function(Fa){this._scrollBarSkin=Fa}),Fg(0,Fa,"sizeGrid",function(){return this._button.sizeGrid},function(Fa){this._button.sizeGrid=Fa}),Fg(0,Fa,"button",function(){return this._button}),Fg(0,Fa,"list",function(){return this._list||this._createList(),this._list},function(Fa){Fa&&(Fa.removeSelf(),this._isCustomList=!0,this._list=Fa,this._setListEvent(Fa),this._itemHeight=Fa.getCell(0).height+Fa.spaceY)}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)&&Math.floor(Fa)==Fa||"string"==typeof Fa?this.selectedIndex=parseInt(Fa):Fa instanceof Array?this.labels=Fa.join(","):Fr.superSet(FH,this,"dataSource",Fa)}),Fg(0,Fa,"labelColors",function(){return this._button.labelColors},function(Fa){this._button.labelColors!=Fa&&(this._button.labelColors=Fa)}),Fg(0,Fa,"labelPadding",function(){return this._button.text.padding.join(",")},function(Fa){this._button.text.padding=FE.fillArray(FD.labelPadding,Fa,Number)}),Fg(0,Fa,"labelSize",function(){return this._button.text.fontSize},function(Fa){this._button.text.fontSize=Fa}),Fg(0,Fa,"labelFont",function(){return this._button.text.font},function(Fa){this._button.text.font=Fa}),Fg(0,Fa,"stateNum",function(){return this._button.stateNum},function(Fa){this._button.stateNum=Fa}),Fc}(FH),FO=function(Fb){function Fc(Fa){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,Fc.__super.call(this),this._showButtons=FF.showButtons,this._touchScrollEnable=FF.touchScrollEnable,this._mouseWheelEnable=FF.mouseWheelEnable,this.skin=Fa,this.max=1}Ff(Fc,"laya.ui.ScrollBar",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),this.stopScroll(),this.target=null,Fb.prototype.destroy.call(this,Fa),this.upButton&&this.upButton.destroy(Fa),this.downButton&&this.downButton.destroy(Fa),this.slider&&this.slider.destroy(Fa),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},Fa.createChildren=function(){this.addChild(this.slider=new FP),this.addChild(this.upButton=new FK),this.addChild(this.downButton=new FK)},Fa.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},Fa.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},Fa.onButtonMouseDown=function(Fa){var Fb=Fa.currentTarget===this.upButton;this.slide(Fb),Fr.timer.once(FD.scrollBarDelayTime,this,this.startLoop,[Fb]),Fr.stage.once("mouseup",this,this.onStageMouseUp)},Fa.startLoop=function(Fa){Fr.timer.frameLoop(1,this,this.slide,[Fa])},Fa.slide=function(Fa){Fa?this.value-=this._scrollSize:this.value+=this._scrollSize},Fa.onStageMouseUp=function(Fa){Fr.timer.clear(this,this.startLoop),Fr.timer.clear(this,this.slide)},Fa.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},Fa.changeSize=function(){Fb.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},Fa.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},Fa.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},Fa.setScroll=function(Fa,Fb,Fc){this.runCallLater(this.changeSize),this.slider.setSlider(Fa,Fb,Fc),this.slider.bar.visible=0<Fb,!this._hide&&this.autoHide&&(this.visible=!1)},Fa.onTargetMouseWheel=function(Fa){this.value-=Fa.delta*this._scrollSize,this.target=this._target},Fa.onTargetMouseDown=function(Fa){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new Fq),this._lastPoint.setTo(Fr.stage.mouseX,Fr.stage.mouseY),Fr.timer.clear(this,this.tweenMove),Fz.clearTween(this),Fr.stage.once("mouseup",this,this.onStageMouseUp2),Fr.stage.once("mouseout",this,this.onStageMouseUp2),Fr.timer.frameLoop(1,this,this.loop)},Fa.loop=function(){var Fa=Fr.stage.mouseY,Fb=Fr.stage.mouseX;if(this._lastOffset=this.isVertical?Fa-this._lastPoint.y:Fb-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?Fr.stage._canvasTransform.getScaleY():Fr.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=Fb,this._lastPoint.y=Fa,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},Fa.onStageMouseUp2=function(Fa){if(Fr.stage.off("mouseup",this,this.onStageMouseUp2),Fr.stage.off("mouseout",this,this.onStageMouseUp2),Fr.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?Fz.to(this,{value:this.min},this.elasticBackTime,Fi.sineOut,Fo.create(this,this.elasticOver)):this._value>this.max&&Fz.to(this,{value:this.max},this.elasticBackTime,Fi.sineOut,Fo.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?Fr.stage.mouseY-this._lastPoint.y:Fr.stage.mouseX-this._lastPoint.x);for(var Fb=0,Fc=Math.min(this._offsets.length,3),Fd=0;Fd<Fc;Fd++)Fb+=this._offsets[this._offsets.length-1-Fd];if(this._lastOffset=Fb/Fc,(Fb=Math.abs(this._lastOffset))<2)return void this.event("end");60<Fb&&(this._lastOffset=0<this._lastOffset?60:-60);var Fe=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));Fr.timer.frameLoop(1,this,this.tweenMove,[Fe])}},Fa.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&Fz.to(this,{alpha:0},500),this.event("end")},Fa.tweenMove=function(Fa){this._lastOffset*=this.rollRatio;var Fb=NaN;if(0<Fa&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,Fb=.5*-(this.min-Fa-this.value),this._lastOffset>Fb&&(this._lastOffset=Fb)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,Fb=.5*-(this.max+Fa-this.value),this._lastOffset<Fb&&(this._lastOffset=Fb))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(Fr.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?Fz.to(this,{value:this.min},this.elasticBackTime,Fi.sineOut,Fo.create(this,this.elasticOver)):this._value>this.max?Fz.to(this,{value:this.max},this.elasticBackTime,Fi.sineOut,Fo.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&Fz.to(this,{alpha:0},500)}},Fa.stopScroll=function(){this.onStageMouseUp2(null),Fr.timer.clear(this,this.tweenMove),Fz.clearTween(this)},Fg(0,Fa,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),Fg(0,Fa,"skin",function(){return this._skin},function(Fa){this._skin!=Fa&&(this._skin=Fa,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),Fg(0,Fa,"max",function(){return this.slider.max},function(Fa){this.slider.max=Fa}),Fg(0,Fa,"showButtons",function(){return this._showButtons},function(Fa){this._showButtons=Fa,this.callLater(this.changeScrollBar)}),Fg(0,Fa,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),Fg(0,Fa,"min",function(){return this.slider.min},function(Fa){this.slider.min=Fa}),Fg(0,Fa,"value",function(){return this._value},function(Fa){Fa!==this._value&&(this._value=Fa,this._isElastic||(this.slider._value!=Fa&&(this.slider._value=Fa,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),Fg(0,Fa,"isVertical",function(){return this.slider.isVertical},function(Fa){this.slider.isVertical=Fa}),Fg(0,Fa,"sizeGrid",function(){return this.slider.sizeGrid},function(Fa){this.slider.sizeGrid=Fa}),Fg(0,Fa,"scrollSize",function(){return this._scrollSize},function(Fa){this._scrollSize=Fa}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)||"string"==typeof Fa?this.value=Number(Fa):Fr.superSet(FH,this,"dataSource",Fa)}),Fg(0,Fa,"thumbPercent",function(){return this._thumbPercent},function(Fa){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),Fa=1<=Fa?.99:Fa,this._thumbPercent=Fa,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*Fa,FD.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*Fa,FD.scrollBarMinNum))}),Fg(0,Fa,"target",function(){return this._target},function(Fa){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=Fa)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),Fg(0,Fa,"hide",function(){return this._hide},function(Fa){this._hide=Fa,this.visible=!Fa}),Fg(0,Fa,"touchScrollEnable",function(){return this._touchScrollEnable},function(Fa){this._touchScrollEnable=Fa,this.target=this._target}),Fg(0,Fa,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(Fa){this._mouseWheelEnable=Fa,this.target=this._target}),Fg(0,Fa,"tick",function(){return this.slider.tick},function(Fa){this.slider.tick=Fa}),Fc}(FH),FP=function(Fb){function Fc(Fa){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,Fc.__super.call(this),this.skin=Fa}Ff(Fc,"laya.ui.Slider",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._bg&&this._bg.destroy(Fa),this._bar&&this._bar.destroy(Fa),this._progress&&this._progress.destroy(Fa),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},Fa.createChildren=function(){this.addChild(this._bg=new FQ),this.addChild(this._bar=new FK)},Fa.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},Fa.onBarMouseDown=function(Fa){this._globalSacle||(this._globalSacle=new Fq),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=Fr.stage.mouseX,this._ty=Fr.stage.mouseY,Fr.stage.on("mousemove",this,this.mouseMove),Fr.stage.once("mouseup",this,this.mouseUp),Fr.stage.once("mouseout",this,this.mouseUp),this.showValueText()},Fa.showValueText=function(){if(this.showLabel){var Fa=laya.ui.Slider.label;this.addChild(Fa),Fa.textField.changeText(this._value+""),this.isVertical?(Fa.x=this._bar.x+20,Fa.y=.5*(this._bar.height-Fa.height)+this._bar.y):(Fa.y=this._bar.y-20,Fa.x=.5*(this._bar.width-Fa.width)+this._bar.x)}},Fa.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},Fa.mouseUp=function(Fa){Fr.stage.off("mousemove",this,this.mouseMove),Fr.stage.off("mouseup",this,this.mouseUp),Fr.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},Fa.mouseMove=function(Fa){var Fb=this._value;this.isVertical?(this._bar.y+=(Fr.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(Fr.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=Fr.stage.mouseX,this._ty=Fr.stage.mouseY;var Fc=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Fc)/Fc,this._value!=Fb&&this.sendChangeEvent(),this.showValueText()},Fa.sendChangeEvent=function(Fa){void 0===Fa&&(Fa="change"),this.event(Fa),this.changeHandler&&this.changeHandler.runWith(this._value)},Fa.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},Fa.changeSize=function(){Fb.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},Fa.setSlider=function(Fa,Fb,Fc){this._value=-1,this._min=Fa,this._max=Fa<Fb?Fb:Fa,this.value=Fc<Fa?Fa:Fb<Fc?Fb:Fc},Fa.changeValue=function(){var Fa=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Fa)/Fa,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var Fb=this._max-this._min;0===Fb&&(Fb=1),this.isVertical?(this._bar.y=(this._value-this._min)/Fb*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/Fb*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},Fa.onBgMouseDown=function(Fa){var Fb=this._bg.getMousePoint();this.isVertical?this.value=Fb.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=Fb.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},Fg(0,Fa,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),Fg(0,Fa,"skin",function(){return this._skin},function(Fa){if(this._skin!=Fa){this._skin=Fa,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var Fb=this._skin.replace(".png","$progress.png");Fu.getRes(Fb)&&(this._progress||(this.addChild(this._progress=new FQ),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=Fb),this.setBarPoint(),this.callLater(this.changeValue)}}),Fg(0,Fa,"allowClickBack",function(){return this._allowClickBack},function(Fa){this._allowClickBack!=Fa&&((this._allowClickBack=Fa)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),Fg(0,Fa,"max",function(){return this._max},function(Fa){this._max!=Fa&&(this._max=Fa,this.callLater(this.changeValue))}),Fg(0,Fa,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),Fg(0,Fa,"tick",function(){return this._tick},function(Fa){this._tick!=Fa&&(this._tick=Fa,this.callLater(this.changeValue))}),Fg(0,Fa,"sizeGrid",function(){return this._bg.sizeGrid},function(Fa){this._bg.sizeGrid=Fa,this._bar.sizeGrid=Fa,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),Fg(0,Fa,"min",function(){return this._min},function(Fa){this._min!=Fa&&(this._min=Fa,this.callLater(this.changeValue))}),Fg(0,Fa,"value",function(){return this._value},function(Fa){if(this._value!=Fa){var Fb=this._value;this._value=Fa,this.changeValue(),this._value!=Fb&&this.sendChangeEvent()}}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)||"string"==typeof Fa?this.value=Number(Fa):Fr.superSet(FH,this,"dataSource",Fa)}),Fg(0,Fa,"bar",function(){return this._bar}),Fd(Fc,["label",function(){return this.label=new FR}]),Fc}(FH),FQ=function(Fb){function Fc(Fa){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,Fc.__super.call(this),this.skin=Fa}Ff(Fc,"laya.ui.Image",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,!0),(this._complete||this._progress)&&Fr.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null,this._bitmap&&this._bitmap.destroy(),this._bitmap=null,Fu.clearCache(this,this._skin),this.clearEvent()},Fa.dispose=function(){this.destroy(!0),Fu.clearCache(this,this._skin),this.clearEvent()},Fa.createChildren=function(){this.graphics=this._bitmap=new FG},Fa.setSource=function(Fa,Fb){Fa===this._skin&&Fb&&(this.source=Fb,this.onCompResize(),this.clearEvent())},Fa.clearEvent=function(){this._skin&&Fe.atalsNotify&&Fe.atalsNotify.off(this._skin,this,this.setSource)},Fg(0,Fa,"source",function(){return this._bitmap.source},function(Fa){this._bitmap&&(this._bitmap.source=Fa,this.event("loaded"),this.repaint())}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"string"==typeof(this._dataSource=Fa)?this.skin=Fa:Fr.superSet(FH,this,"dataSource",Fa)}),Fg(0,Fa,"measureHeight",function(){return this._bitmap.height}),Fg(0,Fa,"skin",function(){return this._skin},function(Fa){if(this._skin!=Fa)if(Fu.clearCache(this,this._skin),this.clearEvent(),this._skin=Fa){Fu.keepCache(this,this._skin);var Fb=Fu.getRes(Fa),Fc=Fe.resAtalsObj&&Fe.resAtalsObj[this._skin];Fb?(this.source=Fb,this.onCompResize()):Fc?(Fe.atalsNotify&&Fe.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=Fc.sourceW),0==this.height&&(this.height=Fc.sourceH)):((this._complete||this._progress)&&Fr.loader.cancel(this._skin,this._complete,this._progress),this._complete=Fo.create(this,this.setSource,[this._skin],!1),this._progress=null,Fr.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),Fg(0,Fa,"group",function(){return this._group},function(Fa){Fa&&this._skin&&Fu.setGroup(this._skin,Fa),this._group=Fa}),Fg(0,Fa,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Fa){this._bitmap.sizeGrid=FE.fillArray(FD.defaultSizeGrid,Fa,Number)}),Fg(0,Fa,"measureWidth",function(){return this._bitmap.width}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(FH,this,"width",Fa),this._bitmap.width=0==Fa?1e-7:Fa}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(FH,this,"height",Fa),this._bitmap.height=0==Fa?1e-7:Fa}),Fc}(FH),FR=function(Fb){function Fc(Fa){this._tf=null,Fc.__super.call(this),void 0===Fa&&(Fa=""),Fm.defaultColor=FD.labelColor,this.text=Fa}Ff(Fc,"laya.ui.Label",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._tf=null},Fa.createChildren=function(){this.addChild(this._tf=new Fx)},Fa.changeText=function(Fa){this._tf.changeText(Fa)},Fg(0,Fa,"padding",function(){return this._tf.padding.join(",")},function(Fa){this._tf.padding=FE.fillArray(FD.labelPadding,Fa,Number)}),Fg(0,Fa,"bold",function(){return this._tf.bold},function(Fa){this._tf.bold=Fa}),Fg(0,Fa,"align",function(){return this._tf.align},function(Fa){this._tf.align=Fa}),Fg(0,Fa,"text",function(){return this._tf.text},function(Fa){this._tf.text!=Fa&&(Fa&&(Fa=FE.adptString(Fa+"")),this._tf.text=Fa,this.event("change"),this._width&&this._height||this.onCompResize())}),Fg(0,Fa,"italic",function(){return this._tf.italic},function(Fa){this._tf.italic=Fa}),Fg(0,Fa,"wordWrap",function(){return this._tf.wordWrap},function(Fa){this._tf.wordWrap=Fa}),Fg(0,Fa,"font",function(){return this._tf.font},function(Fa){this._tf.font=Fa}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)||"string"==typeof Fa?this.text=Fa+"":Fr.superSet(FH,this,"dataSource",Fa)}),Fg(0,Fa,"color",function(){return this._tf.color},function(Fa){this._tf.color=Fa}),Fg(0,Fa,"valign",function(){return this._tf.valign},function(Fa){this._tf.valign=Fa}),Fg(0,Fa,"leading",function(){return this._tf.leading},function(Fa){this._tf.leading=Fa}),Fg(0,Fa,"fontSize",function(){return this._tf.fontSize},function(Fa){this._tf.fontSize=Fa}),Fg(0,Fa,"bgColor",function(){return this._tf.bgColor},function(Fa){this._tf.bgColor=Fa}),Fg(0,Fa,"borderColor",function(){return this._tf.borderColor},function(Fa){this._tf.borderColor=Fa}),Fg(0,Fa,"stroke",function(){return this._tf.stroke},function(Fa){this._tf.stroke=Fa}),Fg(0,Fa,"strokeColor",function(){return this._tf.strokeColor},function(Fa){this._tf.strokeColor=Fa}),Fg(0,Fa,"textField",function(){return this._tf}),Fg(0,Fa,"measureWidth",function(){return this._tf.width}),Fg(0,Fa,"measureHeight",function(){return this._tf.height}),Fg(0,Fa,"width",function(){return this._width||this._tf.text?Fr.superGet(FH,this,"width"):0},function(Fa){Fr.superSet(FH,this,"width",Fa),this._tf.width=Fa}),Fg(0,Fa,"height",function(){return this._height||this._tf.text?Fr.superGet(FH,this,"height"):0},function(Fa){Fr.superSet(FH,this,"height",Fa),this._tf.height=Fa}),Fg(0,Fa,"overflow",function(){return this._tf.overflow},function(Fa){this._tf.overflow=Fa}),Fg(0,Fa,"underline",function(){return this._tf.underline},function(Fa){this._tf.underline=Fa}),Fg(0,Fa,"underlineColor",function(){return this._tf.underlineColor},function(Fa){this._tf.underlineColor=Fa}),Fc}(FH),FS=function(Fb){function Fc(Fa){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,Fc.__super.call(this),this.skin=Fa}Ff(Fc,"laya.ui.ProgressBar",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._bg&&this._bg.destroy(Fa),this._bar&&this._bar.destroy(Fa),this._bg=this._bar=null,this.changeHandler=null},Fa.createChildren=function(){this.addChild(this._bg=new FQ),this.addChild(this._bar=new FQ)},Fa.changeValue=function(){if(this.sizeGrid){var Fa=this.sizeGrid.split(","),Fb=Number(Fa[3]),Fc=Number(Fa[1]),Fd=(this.width-Fb-Fc)*this._value;this._bar.width=Fb+Fc+Fd,this._bar.visible=this._bar.width>Fb+Fc}else this._bar.width=this.width*this._value},Fg(0,Fa,"measureHeight",function(){return this._bg.height}),Fg(0,Fa,"skin",function(){return this._skin},function(Fa){this._skin!=Fa&&(this._skin=Fa,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),Fg(0,Fa,"measureWidth",function(){return this._bg.width}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(FH,this,"height",Fa),this._bg.height=this._height,this._bar.height=this._height}),Fg(0,Fa,"bar",function(){return this._bar}),Fg(0,Fa,"value",function(){return this._value},function(Fa){this._value!=Fa&&(Fa=1<Fa?1:Fa<0?0:Fa,this._value=Fa,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(Fa))}),Fg(0,Fa,"bg",function(){return this._bg}),Fg(0,Fa,"sizeGrid",function(){return this._bg.sizeGrid},function(Fa){this._bg.sizeGrid=this._bar.sizeGrid=Fa}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(FH,this,"width",Fa),this._bg.width=this._width,this.callLater(this.changeValue)}),Fg(0,Fa,"dataSource",Fb.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)||"string"==typeof Fa?this.value=Number(Fa):Fr.superSet(FH,this,"dataSource",Fa)}),Fc}(FH),FT=(function(Fa){function Fc(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,Fc.__super.call(this),this._tipBox=new FH,this._tipBox.addChild(this._tipText=new Fx),this._tipText.x=this._tipText.y=5,this._tipText.color=Fc.tipTextColor,this._defaultTipHandler=this._showDefaultTip,Fr.stage.on("showtip",this,this._onStageShowTip),Fr.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}Ff(Fc,"laya.ui.TipManager",FH);var Fb=Fc.prototype;Fb._onStageHideTip=function(Fa){Fr.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},Fb._onStageShowTip=function(Fa){Fr.timer.once(Fc.tipDelay,this,this._showTip,[Fa],!0)},Fb._showTip=function(Fa){if("string"==typeof Fa){var Fb=String(Fa);Boolean(Fb)&&this._defaultTipHandler(Fb)}else Fa instanceof laya.utils.Handler?Fa.run():"function"==typeof Fa&&Fa.apply();Fr.stage.on("mousemove",this,this._onStageMouseMove),Fr.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},Fb._onStageMouseDown=function(Fa){this.closeAll()},Fb._onStageMouseMove=function(Fa){this._showToStage(this,Fc.offsetX,Fc.offsetY)},Fb._showToStage=function(Fa,Fb,Fc){void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0);var Fd=Fa.getBounds();Fa.x=Fr.stage.mouseX+Fb,Fa.y=Fr.stage.mouseY+Fc,Fa.x+Fd.width>Fr.stage.width&&(Fa.x-=Fd.width+Fb),Fa.y+Fd.height>Fr.stage.height&&(Fa.y-=Fd.height+Fc)},Fb.closeAll=function(){Fr.timer.clear(this,this._showTip),Fr.stage.off("mousemove",this,this._onStageMouseMove),Fr.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},Fb.showDislayTip=function(Fa){this.addChild(Fa),this._showToStage(this),Fr._currentStage.addChild(this)},Fb._showDefaultTip=function(Fa){this._tipText.text=Fa;var Fb=this._tipBox.graphics;Fb.clear(),Fb.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,Fc.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),Fr._currentStage.addChild(this)},Fg(0,Fb,"defaultTipHandler",function(){return this._defaultTipHandler},function(Fa){this._defaultTipHandler=Fa}),Fc.offsetX=10,Fc.offsetY=15,Fc.tipTextColor="#ffffff",Fc.tipBackColor="#111111",Fc.tipDelay=200}(),function(Fa){var Fp;function Fq(){this._idMap=null,this._aniList=null,this._watchMap={},Fq.__super.call(this)}Ff(Fq,"laya.ui.View",FJ);var Fb=Fq.prototype;return Fb.createView=function(Fa){if(Fa.animations&&!this._idMap&&(this._idMap={}),Fq.createComp(Fa,this,this),Fa.animations){var Fb,Fc,Fd=[],Fe=Fa.animations,Ff=0,Fg=Fe.length;for(Ff=0;Ff<Fg;Ff++){switch(Fb=new Fn,Fc=Fe[Ff],Fb._setUp(this._idMap,Fc),(this[Fc.name]=Fb)._setControlNode(this),Fc.action){case 1:Fb.play(0,!1);break;case 2:Fb.play(0,!0)}Fd.push(Fb)}this._aniList=Fd}0<this._width&&null==Fa.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},Fb.onEvent=function(Fa,Fb){},Fb.loadUI=function(Fa){var Fb=Fq.uiMap[Fa];Fb&&this.createView(Fb)},Fb.destroy=function(Fa){void 0===Fa&&(Fa=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,Fa)},Fb.changeData=function(Fa){var Fb=this._watchMap[Fa];if(Fb){console.log("change",Fa);for(var Fc=0,Fd=Fb.length;Fc<Fd;Fc++){Fb[Fc].exe(this)}}},Fq._regs=function(){for(var Fa in Fq.uiClassMap)Fs.regClass(Fa,Fq.uiClassMap[Fa])},Fq.createComp=function(Fa,Fb,Fc,Fd){if(!(Fb=Fb||Fq.getCompInstance(Fa)))return console.warn("can not create:"+Fa.type),null;var Fe=Fa.child;if(Fe)for(var Ff=Fb instanceof laya.ui.List,Fg=0,Fh=Fe.length;Fg<Fh;Fg++){var Fi=Fe[Fg];if(!Fb.hasOwnProperty("itemRender")||"render"!=Fi.props.name&&"render"!==Fi.props.renderType)if("Graphic"==Fi.type)Fs.addGraphicsToSprite(Fi,Fb);else if(Fs.isDrawType(Fi.type))Fs.addGraphicToSprite(Fi,Fb,!0);else{if(Ff){var Fj=[],Fm=Fq.createComp(Fi,null,Fc,Fj);Fj.length&&(Fm._$bindData=Fj)}else Fm=Fq.createComp(Fi,null,Fc,Fd);"Script"==Fi.type?"owner"in Fm?Fm.owner=Fb:"target"in Fm&&(Fm.target=Fb):"mask"==Fi.props.renderType||"mask"==Fi.props.name?Fb.mask=Fm:Fm instanceof laya.display.Sprite&&Fb.addChild(Fm)}else Fb.itemRender=Fi}var Fn=Fa.props;for(var Fo in Fn){var Fp=Fn[Fo];Fq.eventDic[Fo]?Fp&&Fc&&Fb.on(Fo,Fc,Fc.onEvent,[Fp]):Fq.setCompValue(Fb,Fo,Fp,Fc,Fd)}return Fr.__typeof(Fb,"laya.ui.IItem")&&Fb.initItems(),Fa.compId&&Fc&&Fc._idMap&&(Fc._idMap[Fa.compId]=Fb),Fb},Fq.setCompValue=function(Fa,Fb,Fc,Fd,Fe){if("string"==typeof Fc&&-1<Fc.indexOf("${")){if(Fq._sheet||(Fq._sheet=Fs.getClass("laya.data.Table")),!Fq._sheet)return void console.warn("Can not find class Sheet");if(Fe)Fe.push(Fa,Fb,Fc);else if(Fd){-1==Fc.indexOf("].")&&(Fc=Fc.replace(".","[0]."));var Ff,Fg,Fh=new Fp(Fa,Fb,Fc);Fh.exe(Fd);for(var Fi=Fc.replace(/\[.*?\]\./g,".");null!=(Ff=Fq._parseWatchData.exec(Fi));){for(var Fj=Ff[1];null!=(Fg=Fq._parseKeyWord.exec(Fj));){var Fm=Fg[0],Fn=Fd._watchMap[Fm]||(Fd._watchMap[Fm]=[]);Fn.push(Fh),Fq._sheet.I.notifer.on(Fm,Fd,Fd.changeData,[Fm])}(Fn=Fd._watchMap[Fj]||(Fd._watchMap[Fj]=[])).push(Fh),Fq._sheet.I.notifer.on(Fj,Fd,Fd.changeData,[Fj])}}}else if("var"===Fb&&Fd)Fd[Fc]=Fa;else if("onClick"==Fb){var Fo=Fr._runScript("(function(){"+Fc+"})");Fa.on("click",Fd,Fo)}else Fa[Fb]="true"===Fc||"false"!==Fc&&Fc},Fq.getCompInstance=function(Fa){var Fb,Fc=Fa.props?Fa.props.runtime:null;return Fb=Fc?Fq.viewClassMap[Fc]||Fq.uiClassMap[Fc]||Fr.__classmap[Fc]:Fq.uiClassMap[Fa.type],Fa.props&&Fa.props.hasOwnProperty("renderType")&&"instance"==Fa.props.renderType?Fb.instance:Fb?new Fb:null},Fq.regComponent=function(Fa,Fb){Fq.uiClassMap[Fa]=Fb,Fs.regClass(Fa,Fb)},Fq.regViewRuntime=function(Fa,Fb){Fq.viewClassMap[Fa]=Fb},Fq.uiMap={},Fq.viewClassMap={},Fq._sheet=null,Fd(Fq,["uiClassMap",function(){return this.uiClassMap={ViewStack:Faa,LinkButton:FK,TextArea:Fja,ColorPicker:FM,Box:FJ,Button:FK,CheckBox:FU,Clip:FL,ComboBox:FN,Component:FH,HScrollBar:FY,HSlider:F$,Image:FQ,Label:FR,List:FX,Panel:FZ,ProgressBar:FS,Radio:Fk,RadioGroup:Fha,ScrollBar:FO,Slider:FP,Tab:Fia,TextInput:Fca,View:Fq,VScrollBar:Fba,VSlider:Fda,Tree:Fl,HBox:Ffa,VBox:Fga,Sprite:Fw,Animation:Fc,Text:Fx,FontClip:FW}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),Fq.__init$=function(){Fq._regs(),Fp=function(){function Fa(Fa,Fb,Fc){this.comp=null,this.prop=null,this.value=null,this.comp=Fa,this.prop=Fb,this.value=Fc}return Ff(Fa,""),Fa.prototype.exe=function(Fa){var Fb=FE.getBindFun(this.value);this.comp[this.prop]=Fb.call(this,Fa)},Fa}()},Fq}()),FU=function(Fa){function Fc(Fa,Fb){void 0===Fb&&(Fb=""),Fc.__super.call(this,Fa,Fb)}Ff(Fc,"laya.ui.CheckBox",Fa);var Fb=Fc.prototype;return Fb.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},Fb.initialize=function(){Fa.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},Fg(0,Fb,"dataSource",Fa.prototype._$get_dataSource,function(Fa){"boolean"==typeof(this._dataSource=Fa)?this.selected=Fa:"string"==typeof Fa?this.selected="true"===Fa:Fr.superSet(FK,this,"dataSource",Fa)}),Fc}(FK),FV=function(Fa){function Fb(){this._space=0,this._align="none",this._itemChanged=!1,Fb.__super.call(this)}Ff(Fb,"laya.ui.LayoutBox",FJ);var Fc=Fb.prototype;return Fc.addChild=function(Fa){return Fa.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,Fa)},Fc.onResize=function(Fa){this._setItemChanged()},Fc.addChildAt=function(Fa,Fb){return Fa.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,Fa,Fb)},Fc.removeChild=function(Fa){return Fa.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,Fa)},Fc.removeChildAt=function(Fa){return this.getChildAt(Fa).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,Fa)},Fc.refresh=function(){this._setItemChanged()},Fc.changeItems=function(){this._itemChanged=!1},Fc.sortItem=function(Fa){Fa&&Fa.sort(function(Fa,Fb){return Fa.y-Fb.y})},Fc._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},Fg(0,Fc,"space",function(){return this._space},function(Fa){this._space=Fa,this._setItemChanged()}),Fg(0,Fc,"align",function(){return this._align},function(Fa){this._align=Fa,this._setItemChanged()}),Fb}(),FW=function(Fb){function Fc(Fa,Fb){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,Fc.__super.call(this),Fa&&(this.skin=Fa),Fb&&(this.sheet=Fb)}Ff(Fc,"laya.ui.FontClip",Fb);var Fa=Fc.prototype;return Fa.createChildren=function(){this._bitmap=new FG,this.on("loaded",this,this._onClipLoaded)},Fa._onClipLoaded=function(){this.callLater(this.changeValue)},Fa.changeValue=function(){var Fa;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),Fa=this._sources[0]))){var Fb="horizontal"===this._direction;Fb?(this._wordsW=this._valueArr.length*(Fa.sourceWidth+this.spaceX),this._wordsH=Fa.sourceHeight):(this._wordsW=Fa.sourceWidth,this._wordsH=(Fa.sourceHeight+this.spaceY)*this._valueArr.length);var Fc=0;if(this._width)switch(this._align){case"center":Fc=.5*(this._width-this._wordsW);break;case"right":Fc=this._width-this._wordsW;break;default:Fc=0}for(var Fd=0,Fe=this._valueArr.length;Fd<Fe;Fd++){var Ff=this._indexMap[this._valueArr.charAt(Fd)];this.sources[Ff]&&(Fa=this.sources[Ff],Fb?this.graphics.drawTexture(Fa,Fc+Fd*(Fa.sourceWidth+this.spaceX),0,Fa.sourceWidth,Fa.sourceHeight):this.graphics.drawTexture(Fa,0+Fc,Fd*(Fa.sourceHeight+this.spaceY),Fa.sourceWidth,Fa.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),Fb.prototype.destroy.call(this,Fa)},Fg(0,Fa,"sheet",function(){return this._sheet},function(Fa){Fa+="";var Fb=(this._sheet=Fa).split(" ");this._clipX=String(Fb[0]).length,this.clipY=Fb.length,this._indexMap={};for(var Fc=0;Fc<this._clipY;Fc++)for(var Fd=Fb[Fc].split(""),Fe=0,Ff=Fd.length;Fe<Ff;Fe++)this._indexMap[Fd[Fe]]=Fc*this._clipX+Fe}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(FL,this,"height",Fa),this.callLater(this.changeValue)}),Fg(0,Fa,"direction",function(){return this._direction},function(Fa){this._direction=Fa,this.callLater(this.changeValue)}),Fg(0,Fa,"value",function(){return this._valueArr?this._valueArr:""},function(Fa){Fa+="",this._valueArr=Fa,this.callLater(this.changeValue)}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(FL,this,"width",Fa),this.callLater(this.changeValue)}),Fg(0,Fa,"spaceX",function(){return this._spaceX},function(Fa){this._spaceX=Fa,"horizontal"===this._direction&&this.callLater(this.changeValue)}),Fg(0,Fa,"spaceY",function(){return this._spaceY},function(Fa){this._spaceY=Fa,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),Fg(0,Fa,"align",function(){return this._align},function(Fa){this._align=Fa,this.callLater(this.changeValue)}),Fg(0,Fa,"measureWidth",function(){return this._wordsW}),Fg(0,Fa,"measureHeight",function(){return this._wordsH}),Fc}(FL),FX=function(Fa){function Fb(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new Fq,Fb.__super.call(this)}Ff(Fb,"laya.ui.List",Fa);var Fc=Fb.prototype;return Fr.imps(Fc,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),Fc.destroy=function(Fa){void 0===Fa&&(Fa=!0),this._content&&this._content.destroy(Fa),this._scrollBar&&this._scrollBar.destroy(Fa),laya.ui.Component.prototype.destroy.call(this,Fa),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},Fc.createChildren=function(){this.addChild(this._content=new FJ)},Fc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Fr.superGet(FJ,this,"cacheAs")),Fr.superSet(FJ,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},Fc.onScrollEnd=function(){Fr.superSet(FJ,this,"cacheAs",this._$P.cacheAs)},Fc._removePreScrollBar=function(){var Fa=this.removeChildByName("scrollBar");Fa&&Fa.destroy(!0)},Fc.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var Fa=this._getOneCell(),Fb=Fa.width+this._spaceX||1,Fc=Fa.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/Fb):Math.ceil(this._width/Fb)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/Fc):Math.round(this._height/Fc));var Fd=this._width?this._width:Fb*this.repeatX-this._spaceX,Fe=this._height?this._height:Fc*this.repeatY-this._spaceY;this._cellSize=this._isVertical?Fc:Fb,this._cellOffset=this._isVertical?Fc*Math.max(this._repeatY2,this._repeatY)-Fe-this._spaceY:Fb*Math.max(this._repeatX2,this._repeatX)-Fd-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=Fe:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=Fd),this.setContentSize(Fd,Fe);var Ff=this._isVertical?this.repeatX:this.repeatY,Fg=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,Ff,Fg),this._createdLine=Fg,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},Fc._getOneCell=function(){if(0===this._cells.length){var Fa=this.createItem();if(this._offset.setTo(Fa.x,Fa.y),this.cacheContent)return Fa;this._cells.push(Fa)}return this._cells[0]},Fc._createItems=function(Fa,Fb,Fc){var Fd=this._content,Fe=this._getOneCell(),Ff=Fe.width+this._spaceX,Fg=Fe.height+this._spaceY;if(this.cacheContent){var Fh=new FJ;Fh.cacheAsBitmap=!0,Fh.pos((this._isVertical?0:Fa)*Ff,(this._isVertical?Fa:0)*Fg),this._content.addChild(Fh),this._content.optimizeScrollRect=!0,Fd=Fh}else{for(var Fi=[],Fj=this._cells.length-1;-1<Fj;Fj--){var Fm=this._cells[Fj];Fm.removeSelf(),Fi.push(Fm)}this._cells.length=0}for(var Fn=Fa;Fn<Fc;Fn++)for(var Fo=0;Fo<Fb;Fo++)(Fe=Fi&&Fi.length?Fi.pop():this.createItem()).x=(this._isVertical?Fo:Fn)*Ff-Fd.x,Fe.y=(this._isVertical?Fn:Fo)*Fg-Fd.y,Fe.name="item"+(Fn*Fb+Fo),Fd.addChild(Fe),this.addCell(Fe)},Fc.createItem=function(){var Fa=[];if("function"==typeof this._itemRender)var Fb=new this._itemRender;else Fb=FT.createComp(this._itemRender,null,null,Fa);if(0==Fa.length&&Fb._watchMap){var Fc=Fb._watchMap;for(var Fd in Fc)for(var Fe=Fc[Fd],Ff=0;Ff<Fe.length;Ff++){var Fg=Fe[Ff];Fa.push(Fg.comp,Fg.prop,Fg.value)}}return Fa.length&&(Fb._$bindData=Fa),Fb},Fc.addCell=function(Fa){Fa.on("click",this,this.onCellMouse),Fa.on("rightclick",this,this.onCellMouse),Fa.on("mouseover",this,this.onCellMouse),Fa.on("mouseout",this,this.onCellMouse),Fa.on("mousedown",this,this.onCellMouse),Fa.on("mouseup",this,this.onCellMouse),this._cells.push(Fa)},Fc.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var Fa=0,Fb=Fa=0;Fb<1e4;Fb++){var Fc=this.getChildByName("item"+Fb);if(!Fc)break;this.addCell(Fc),Fa++}this.repeatY=Fa}},Fc.setContentSize=function(Fa,Fb){this._content.width=Fa,this._content.height=Fb,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new Ft),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,Fa,Fb),this._content.scrollRect=this._content.scrollRect),this.event("resize")},Fc.onCellMouse=function(Fa){"mousedown"===Fa.type&&(this._isMoved=!1);var Fb=Fa.currentTarget,Fc=this._startIndex+this._cells.indexOf(Fb);Fc<0||("click"===Fa.type||"rightclick"===Fa.type?this.selectEnable&&!this._isMoved?this.selectedIndex=Fc:this.changeCellState(Fb,!0,0):"mouseover"!==Fa.type&&"mouseout"!==Fa.type||this._selectedIndex===Fc||this.changeCellState(Fb,"mouseover"===Fa.type,0),this.mouseHandler&&this.mouseHandler.runWith([Fa,Fc]))},Fc.changeCellState=function(Fa,Fb,Fc){var Fd=Fa.getChildByName("selectBox");Fd&&(this.selectEnable=!0,Fd.visible=Fb,Fd.index=Fc)},Fc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},Fc.onScrollBarChange=function(Fa){this.runCallLater(this.changeCells);var Fb=this._scrollBar.value,Fc=this._isVertical?this.repeatX:this.repeatY,Fd=this._isVertical?this.repeatY:this.repeatX,Fe=Math.floor(Fb/this._cellSize);if(this.cacheContent)Fg=Fd+1,this._createdLine-Fe<Fg&&(this._createItems(this._createdLine,Fc,this._createdLine+Fg),this.renderItems(this._createdLine*Fc,0),this._createdLine+=Fg);else{var Ff=Fe*Fc,Fg=0;if(Ff>this._startIndex){Fg=Ff-this._startIndex;var Fh=!0,Fi=this._startIndex+Fc*(Fd+1);this._isMoved=!0}else Ff<this._startIndex&&(Fg=this._startIndex-Ff,Fh=!1,Fi=this._startIndex-1,this._isMoved=!0);for(var Fj=0;Fj<Fg;Fj++){if(Fh){var Fm=this._cells.shift();this._cells[this._cells.length]=Fm;var Fn=Fi+Fj}else Fm=this._cells.pop(),this._cells.unshift(Fm),Fn=Fi-Fj;var Fo=Math.floor(Fn/Fc)*this._cellSize;this._isVertical?Fm.y=Fo:Fm.x=Fo,this.renderItem(Fm,Fn)}this._startIndex=Ff,this.changeSelectStatus()}var Fp=this._content.scrollRect;this._isVertical?(Fp.y=Fb-this._offset.y,Fp.x=-this._offset.x):(Fp.y=-this._offset.y,Fp.x=Fb-this._offset.x),this._content.scrollRect=Fp},Fc.posCell=function(Fa,Fb){if(this._scrollBar){var Fc=this._isVertical?this.repeatX:this.repeatY,Fd=(this._isVertical?this.repeatY:this.repeatX,Math.floor(Fb/Fc)*this._cellSize);this._isVertical?Fa.y=Fd:Fa.x=Fd}},Fc.changeSelectStatus=function(){for(var Fa=0,Fb=this._cells.length;Fa<Fb;Fa++)this.changeCellState(this._cells[Fa],this._selectedIndex===this._startIndex+Fa,1)},Fc.renderItems=function(Fa,Fb){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0);for(var Fc=Fa,Fd=Fb||this._cells.length;Fc<Fd;Fc++)this.renderItem(this._cells[Fc],this._startIndex+Fc);this.changeSelectStatus()},Fc.renderItem=function(Fa,Fb){this._array&&0<=Fb&&Fb<this._array.length?(Fa.visible=!0,Fa._$bindData?(Fa._dataSource=this._array[Fb],this._bindData(Fa,this._array[Fb])):Fa.dataSource=this._array[Fb],this.cacheContent||this.posCell(Fa,Fb),this.hasListener("render")&&this.event("render",[Fa,Fb]),this.renderHandler&&this.renderHandler.runWith([Fa,Fb])):(Fa.visible=!1,Fa.dataSource=null)},Fc._bindData=function(Fa,Fb){for(var Fc=Fa._$bindData,Fd=0,Fe=Fc.length;Fd<Fe;Fd++){var Ff=Fc[Fd++],Fg=Fc[Fd++],Fh=Fc[Fd],Fi=FE.getBindFun(Fh);Ff[Fg]=Fi.call(this,Fb)}},Fc.refresh=function(){this.array=this._array},Fc.getItem=function(Fa){return-1<Fa&&Fa<this._array.length?this._array[Fa]:null},Fc.changeItem=function(Fa,Fb){-1<Fa&&Fa<this._array.length&&(this._array[Fa]=Fb,Fa>=this._startIndex&&Fa<this._startIndex+this._cells.length&&this.renderItem(this.getCell(Fa),Fa))},Fc.setItem=function(Fa,Fb){this.changeItem(Fa,Fb)},Fc.addItem=function(Fa){this._array.push(Fa),this.array=this._array},Fc.addItemAt=function(Fa,Fb){this._array.splice(Fb,0,Fa),this.array=this._array},Fc.deleteItem=function(Fa){this._array.splice(Fa,1),this.array=this._array},Fc.getCell=function(Fa){return this.runCallLater(this.changeCells),-1<Fa&&this._cells?this._cells[(Fa-this._startIndex)%this._cells.length]:null},Fc.scrollTo=function(Fa){if(this._scrollBar){var Fb=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(Fa/Fb)*this._cellSize}else this.startIndex=Fa},Fc.tweenTo=function(Fa,Fb,Fc){if(void 0===Fb&&(Fb=200),this._scrollBar){var Fd=this._isVertical?this.repeatX:this.repeatY;Fz.to(this._scrollBar,{value:Math.floor(Fa/Fd)*this._cellSize},Fb,null,Fc,0,!0)}else this.startIndex=Fa,Fc&&Fc.run()},Fc._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},Fc.commitMeasure=function(){this.runCallLater(this.changeCells)},Fg(0,Fc,"cacheAs",Fa.prototype._$get_cacheAs,function(Fa){Fr.superSet(FJ,this,"cacheAs",Fa),this._scrollBar&&(this._$P.cacheAs=null,"none"!==Fa?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),Fg(0,Fc,"content",function(){return this._content}),Fg(0,Fc,"height",Fa.prototype._$get_height,function(Fa){Fa!=this._height&&(Fr.superSet(FJ,this,"height",Fa),this._setCellChanged())}),Fg(0,Fc,"itemRender",function(){return this._itemRender},function(Fa){if(this._itemRender!=Fa){this._itemRender=Fa;for(var Fb=this._cells.length-1;-1<Fb;Fb--)this._cells[Fb].destroy();this._cells.length=0,this._setCellChanged()}}),Fg(0,Fc,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Fa){this._removePreScrollBar();var Fb=new Fba;Fb.name="scrollBar",Fb.right=0,Fa&&" "!=Fa&&(Fb.skin=Fa),this.scrollBar=Fb,this.addChild(Fb),this._setCellChanged()}),Fg(0,Fc,"page",function(){return this._page},function(Fa){this._page=Fa,this._array&&(this._page=0<Fa?Fa:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),Fg(0,Fc,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Fa){this._removePreScrollBar();var Fb=new FY;Fb.name="scrollBar",Fb.bottom=0,Fa&&" "!=Fa&&(Fb.skin=Fa),this.scrollBar=Fb,this.addChild(Fb),this._setCellChanged()}),Fg(0,Fc,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(Fa){this._repeatX=Fa,this._setCellChanged()}),Fg(0,Fc,"scrollBar",function(){return this._scrollBar},function(Fa){this._scrollBar!=Fa&&(this._scrollBar=Fa)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),Fg(0,Fc,"width",Fa.prototype._$get_width,function(Fa){Fa!=this._width&&(Fr.superSet(FJ,this,"width",Fa),this._setCellChanged())}),Fg(0,Fc,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(Fa){this._repeatY=Fa,this._setCellChanged()}),Fg(0,Fc,"spaceX",function(){return this._spaceX},function(Fa){this._spaceX=Fa,this._setCellChanged()}),Fg(0,Fc,"spaceY",function(){return this._spaceY},function(Fa){this._spaceY=Fa,this._setCellChanged()}),Fg(0,Fc,"selectedIndex",function(){return this._selectedIndex},function(Fa){this._selectedIndex!=Fa&&(this._selectedIndex=Fa,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(Fa),this.startIndex=this._startIndex)}),Fg(0,Fc,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(Fa){this.selectedIndex=this._array.indexOf(Fa)}),Fg(0,Fc,"length",function(){return this._array?this._array.length:0}),Fg(0,Fc,"selection",function(){return this.getCell(this._selectedIndex)},function(Fa){this.selectedIndex=this._startIndex+this._cells.indexOf(Fa)}),Fg(0,Fc,"startIndex",function(){return this._startIndex},function(Fa){this._startIndex=0<Fa?Fa:0,this.callLater(this.renderItems)}),Fg(0,Fc,"array",function(){return this._array},function(Fa){this.runCallLater(this.changeCells),this._array=Fa||[];var Fb=this._array.length;if(this.totalPage=Math.ceil(Fb/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<Fb?this._selectedIndex:Fb-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var Fc=this._isVertical?this.repeatX:this.repeatY,Fd=this._isVertical?this.repeatY:this.repeatX,Fe=Math.ceil(Fb/Fc);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=Fd/Fe,this._scrollBar.setScroll(0,(Fe-Fd)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),Fg(0,Fc,"dataSource",Fa.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)&&Math.floor(Fa)==Fa||"string"==typeof Fa?this.selectedIndex=parseInt(Fa):Fa instanceof Array?this.array=Fa:Fr.superSet(FJ,this,"dataSource",Fa)}),Fg(0,Fc,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),Fb}(FJ),FY=function(Fa){function Fb(){Fb.__super.call(this)}return Ff(Fb,"laya.ui.HScrollBar",Fa),Fb.prototype.initialize=function(){Fa.prototype.initialize.call(this),this.slider.isVertical=!1},Fb}(FO),FZ=function(Fa){function Fb(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,Fb.__super.call(this),this.width=this.height=100}Ff(Fb,"laya.ui.Panel",Fa);var Fc=Fb.prototype;return Fc.destroy=function(Fa){void 0===Fa&&(Fa=!0),laya.ui.Component.prototype.destroy.call(this,Fa),this._content&&this._content.destroy(Fa),this._vScrollBar&&this._vScrollBar.destroy(Fa),this._hScrollBar&&this._hScrollBar.destroy(Fa),this._vScrollBar=null,this._hScrollBar=null,this._content=null},Fc.destroyChildren=function(){this._content.destroyChildren()},Fc.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new FJ)},Fc.addChild=function(Fa){return Fa.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(Fa)},Fc.onResize=function(){this._setScrollChanged()},Fc.addChildAt=function(Fa,Fb){return Fa.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(Fa,Fb)},Fc.removeChild=function(Fa){return Fa.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(Fa)},Fc.removeChildAt=function(Fa){return this.getChildAt(Fa).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(Fa)},Fc.removeChildren=function(Fa,Fb){return void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=2147483647),this._content.removeChildren(Fa,Fb),this._setScrollChanged(),this},Fc.getChildAt=function(Fa){return this._content.getChildAt(Fa)},Fc.getChildByName=function(Fa){return this._content.getChildByName(Fa)},Fc.getChildIndex=function(Fa){return this._content.getChildIndex(Fa)},Fc.changeScroll=function(){this._scrollChanged=!1;var Fa=this.contentWidth||1,Fb=this.contentHeight||1,Fc=this._vScrollBar,Fd=this._hScrollBar,Fe=Fc&&Fb>this._height,Ff=Fd&&Fa>this._width,Fg=Fe?this._width-Fc.width:this._width,Fh=Ff?this._height-Fd.height:this._height;Fc&&(Fc.x=this._width-Fc.width,Fc.y=0,Fc.height=this._height-(Ff?Fd.height:0),Fc.scrollSize=Math.max(.033*this._height,1),Fc.thumbPercent=Fh/Fb,Fc.setScroll(0,Fb-Fh,Fc.value)),Fd&&(Fd.x=0,Fd.y=this._height-Fd.height,Fd.width=this._width-(Fe?Fc.width:0),Fd.scrollSize=Math.max(.033*this._width,1),Fd.thumbPercent=Fg/Fa,Fd.setScroll(0,Fa-Fg,Fd.value))},Fc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},Fc.setContentSize=function(Fa,Fb){var Fc=this._content;Fc.width=Fa,Fc.height=Fb,Fc.scrollRect||(Fc.scrollRect=new Ft),Fc.scrollRect.setTo(0,0,Fa,Fb),Fc.scrollRect=Fc.scrollRect},Fc.onScrollBarChange=function(Fa){var Fb=this._content.scrollRect;if(Fb){var Fc=Math.round(Fa.value);Fa.isVertical?Fb.y=Fc:Fb.x=Fc,this._content.scrollRect=Fb}},Fc.scrollTo=function(Fa,Fb){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),this.vScrollBar&&(this.vScrollBar.value=Fb),this.hScrollBar&&(this.hScrollBar.value=Fa)},Fc.refresh=function(){this.changeScroll()},Fc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Fr.superGet(FJ,this,"cacheAs")),Fr.superSet(FJ,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},Fc.onScrollEnd=function(){Fr.superSet(FJ,this,"cacheAs",this._$P.cacheAs)},Fc._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},Fg(0,Fc,"numChildren",function(){return this._content.numChildren}),Fg(0,Fc,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Fa){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new FY),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=Fa}),Fg(0,Fc,"contentWidth",function(){for(var Fa=0,Fb=this._content.numChildren-1;-1<Fb;Fb--){var Fc=this._content.getChildAt(Fb);Fa=Math.max(Fc.x+Fc.width*Fc.scaleX,Fa)}return Fa}),Fg(0,Fc,"contentHeight",function(){for(var Fa=0,Fb=this._content.numChildren-1;-1<Fb;Fb--){var Fc=this._content.getChildAt(Fb);Fa=Math.max(Fc.y+Fc.height*Fc.scaleY,Fa)}return Fa}),Fg(0,Fc,"width",Fa.prototype._$get_width,function(Fa){Fr.superSet(FJ,this,"width",Fa),this._setScrollChanged()}),Fg(0,Fc,"hScrollBar",function(){return this._hScrollBar}),Fg(0,Fc,"content",function(){return this._content}),Fg(0,Fc,"height",Fa.prototype._$get_height,function(Fa){Fr.superSet(FJ,this,"height",Fa),this._setScrollChanged()}),Fg(0,Fc,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Fa){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new Fba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=Fa}),Fg(0,Fc,"vScrollBar",function(){return this._vScrollBar}),Fg(0,Fc,"cacheAs",Fa.prototype._$get_cacheAs,function(Fa){Fr.superSet(FJ,this,"cacheAs",Fa),this._$P.cacheAs=null,"none"!==Fa?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),Fb}(FJ),F$=function(Fa){function Fb(Fa){Fb.__super.call(this,Fa),this.isVertical=!1}return Ff(Fb,"laya.ui.HSlider",FP),Fb}(),F_=function(Fa){function Fc(Fa,Fb){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,Fc.__super.call(this),this.skin=Fb,this.labels=Fa}Ff(Fc,"laya.ui.UIGroup",Fa);var Fb=Fc.prototype;return Fr.imps(Fb,{"laya.ui.IItem":!0}),Fb.preinitialize=function(){this.mouseEnabled=!0},Fb.destroy=function(Fa){void 0===Fa&&(Fa=!0),laya.ui.Component.prototype.destroy.call(this,Fa),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},Fb.addItem=function(Fa,Fb){void 0===Fb&&(Fb=!0);var Fc=Fa,Fd=this._items.length;if(Fc.name="item"+Fd,this.addChild(Fc),this.initItems(),Fb&&0<Fd){var Fe=this._items[Fd-1];"horizontal"==this._direction?Fc.x=Fe.x+Fe.width+this._space:Fc.y=Fe.y+Fe.height+this._space}else Fb&&(Fc.x=0,Fc.y=0);return Fd},Fb.delItem=function(Fa,Fb){void 0===Fb&&(Fb=!0);var Fc=this._items.indexOf(Fa);if(-1!=Fc){var Fd=Fa;this.removeChild(Fd);for(var Fe=Fc+1,Ff=this._items.length;Fe<Ff;Fe++){var Fg=this._items[Fe];Fg.name="item"+(Fe-1),Fb&&("horizontal"==this._direction?Fg.x-=Fd.width+this._space:Fg.y-=Fd.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var Fh;Fh=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=Fh}}},Fb.initItems=function(){this._items||(this._items=[]);for(var Fa=this._items.length=0;Fa<1e4;Fa++){var Fb=this.getChildByName("item"+Fa);if(null==Fb)break;this._items.push(Fb),Fb.selected=Fa===this._selectedIndex,Fb.clickHandler=Fo.create(this,this.itemClick,[Fa],!1)}},Fb.itemClick=function(Fa){this.selectedIndex=Fa},Fb.setSelect=function(Fa,Fb){this._items&&-1<Fa&&Fa<this._items.length&&(this._items[Fa].selected=Fb)},Fb.createItem=function(Fa,Fb){return null},Fb.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var Fa=0,Fb=0,Fc=this._items.length;Fb<Fc;Fb++){var Fd=this._items[Fb];this._skin&&(Fd.skin=this._skin),this._labelColors&&(Fd.labelColors=this._labelColors),this._labelSize&&(Fd.labelSize=this._labelSize),this._labelStroke&&(Fd.labelStroke=this._labelStroke),this._labelStrokeColor&&(Fd.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(Fd.strokeColors=this._strokeColors),this._labelBold&&(Fd.labelBold=this._labelBold),this._labelPadding&&(Fd.labelPadding=this._labelPadding),this._labelAlign&&(Fd.labelAlign=this._labelAlign),this._stateNum&&(Fd.stateNum=this._stateNum),this._labelFont&&(Fd.labelFont=this._labelFont),"horizontal"===this._direction?(Fd.y=0,Fd.x=Fa,Fa+=Fd.width+this._space):(Fd.x=0,Fd.y=Fa,Fa+=Fd.height+this._space)}this.changeSize()},Fb.commitMeasure=function(){this.runCallLater(this.changeLabels)},Fb._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},Fg(0,Fb,"labelStrokeColor",function(){return this._labelStrokeColor},function(Fa){this._labelStrokeColor!=Fa&&(this._labelStrokeColor=Fa,this._setLabelChanged())}),Fg(0,Fb,"skin",function(){return this._skin},function(Fa){this._skin!=Fa&&(this._skin=Fa,this._setLabelChanged())}),Fg(0,Fb,"selectedIndex",function(){return this._selectedIndex},function(Fa){this._selectedIndex!=Fa&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Fa,this.setSelect(Fa,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),Fg(0,Fb,"labels",function(){return this._labels},function(Fa){if(this._labels!=Fa){if(this._labels=Fa,this.removeChildren(),this._setLabelChanged(),this._labels)for(var Fb=this._labels.split(","),Fc=0,Fd=Fb.length;Fc<Fd;Fc++){var Fe=this.createItem(this._skin,Fb[Fc]);Fe.name="item"+Fc,this.addChild(Fe)}this.initItems()}}),Fg(0,Fb,"strokeColors",function(){return this._strokeColors},function(Fa){this._strokeColors!=Fa&&(this._strokeColors=Fa,this._setLabelChanged())}),Fg(0,Fb,"labelColors",function(){return this._labelColors},function(Fa){this._labelColors!=Fa&&(this._labelColors=Fa,this._setLabelChanged())}),Fg(0,Fb,"labelStroke",function(){return this._labelStroke},function(Fa){this._labelStroke!=Fa&&(this._labelStroke=Fa,this._setLabelChanged())}),Fg(0,Fb,"labelSize",function(){return this._labelSize},function(Fa){this._labelSize!=Fa&&(this._labelSize=Fa,this._setLabelChanged())}),Fg(0,Fb,"stateNum",function(){return this._stateNum},function(Fa){this._stateNum!=Fa&&(this._stateNum=Fa,this._setLabelChanged())}),Fg(0,Fb,"labelBold",function(){return this._labelBold},function(Fa){this._labelBold!=Fa&&(this._labelBold=Fa,this._setLabelChanged())}),Fg(0,Fb,"labelFont",function(){return this._labelFont},function(Fa){this._labelFont!=Fa&&(this._labelFont=Fa,this._setLabelChanged())}),Fg(0,Fb,"labelPadding",function(){return this._labelPadding},function(Fa){this._labelPadding!=Fa&&(this._labelPadding=Fa,this._setLabelChanged())}),Fg(0,Fb,"direction",function(){return this._direction},function(Fa){this._direction=Fa,this._setLabelChanged()}),Fg(0,Fb,"space",function(){return this._space},function(Fa){this._space=Fa,this._setLabelChanged()}),Fg(0,Fb,"items",function(){return this._items}),Fg(0,Fb,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Fa){this.selectedIndex=this._items.indexOf(Fa)}),Fg(0,Fb,"dataSource",Fa.prototype._$get_dataSource,function(Fa){"number"==typeof(this._dataSource=Fa)&&Math.floor(Fa)==Fa||"string"==typeof Fa?this.selectedIndex=parseInt(Fa):Fa instanceof Array?this.labels=Fa.join(","):Fr.superSet(FJ,this,"dataSource",Fa)}),Fc}(FJ),Fk=function(Fb){function Fc(Fa,Fb){this._value=null,void 0===Fb&&(Fb=""),Fc.__super.call(this,Fa,Fb)}Ff(Fc,"laya.ui.Radio",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._value=null},Fa.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},Fa.initialize=function(){Fb.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},Fa.onClick=function(Fa){this.selected=!0},Fg(0,Fa,"value",function(){return null!=this._value?this._value:this.label},function(Fa){this._value=Fa}),Fc}(FK),Fl=function(Fa){function Fb(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,Fb.__super.call(this),this.width=this.height=200}Ff(Fb,"laya.ui.Tree",Fa);var Fc=Fb.prototype;return Fr.imps(Fc,{"laya.ui.IRender":!0}),Fc.destroy=function(Fa){void 0===Fa&&(Fa=!0),laya.ui.Component.prototype.destroy.call(this,Fa),this._list&&this._list.destroy(Fa),this._list=null,this._source=null,this._renderHandler=null},Fc.createChildren=function(){this.addChild(this._list=new FX),this._list.renderHandler=Fo.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},Fc.onListChange=function(Fa){this.event("change")},Fc.getArray=function(){var Fa,Fb=[];for(var Fc in this._source)Fa=this._source[Fc],this.getParentOpenStatus(Fa)&&(Fa.x=this._spaceLeft*this.getDepth(Fa),Fb.push(Fa));return Fb},Fc.getDepth=function(Fa,Fb){return void 0===Fb&&(Fb=0),null==Fa.nodeParent?Fb:this.getDepth(Fa.nodeParent,Fb+1)},Fc.getParentOpenStatus=function(Fa){var Fb=Fa.nodeParent;return null==Fb||!!Fb.isOpen&&(null==Fb.nodeParent||this.getParentOpenStatus(Fb))},Fc.renderItem=function(Fa,Fb){var Fc=Fa.dataSource;if(Fc){Fa.left=Fc.x;var Fd=Fa.getChildByName("arrow");Fd&&(Fc.hasChild?(Fd.visible=!0,Fd.index=Fc.isOpen?1:0,Fd.tag=Fb,Fd.off("click",this,this.onArrowClick),Fd.on("click",this,this.onArrowClick)):Fd.visible=!1);var Fe=Fa.getChildByName("folder");Fe&&(2==Fe.clipY?Fe.index=Fc.isDirectory?0:1:Fe.index=Fc.isDirectory?Fc.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([Fa,Fb])}},Fc.onArrowClick=function(Fa){var Fb=Fa.currentTarget.tag;this._list.array[Fb].isOpen=!this._list.array[Fb].isOpen,this.event("open"),this._list.array=this.getArray()},Fc.setItemState=function(Fa,Fb){this._list.array[Fa]&&(this._list.array[Fa].isOpen=Fb,this._list.array=this.getArray())},Fc.fresh=function(){this._list.array=this.getArray(),this.repaint()},Fc.parseXml=function(Fa,Fb,Fc,Fd){var Fe,Ff=Fa.childNodes,Fg=Ff.length;if(!Fd){Fe={};var Fh,Fi=Fa.attributes;for(var Fj in Fi){var Fm=(Fh=Fi[Fj]).nodeName,Fn=Fh.nodeValue;Fe[Fm]="true"==Fn||"false"!=Fn&&Fn}Fe.nodeParent=Fc,0<Fg&&(Fe.isDirectory=!0),Fe.hasChild=0<Fg,Fb.push(Fe)}for(var Fo=0;Fo<Fg;Fo++){var Fp=Ff[Fo];this.parseXml(Fp,Fb,Fe,!1)}},Fc.parseOpenStatus=function(Fa,Fb){for(var Fc=0,Fd=Fb.length;Fc<Fd;Fc++){var Fe=Fb[Fc];if(Fe.isDirectory)for(var Ff=0,Fg=Fa.length;Ff<Fg;Ff++){var Fh=Fa[Ff];if(Fh.isDirectory&&this.isSameParent(Fh,Fe)&&Fe.label==Fh.label){Fe.isOpen=Fh.isOpen;break}}}},Fc.isSameParent=function(Fa,Fb){return null==Fa.nodeParent&&null==Fb.nodeParent||null!=Fa.nodeParent&&null!=Fb.nodeParent&&(Fa.nodeParent.label==Fb.nodeParent.label&&this.isSameParent(Fa.nodeParent,Fb.nodeParent))},Fc.filter=function(Fa){if(Boolean(Fa)){var Fb=[];this.getFilterSource(this._source,Fb,Fa),this._list.array=Fb}else this._list.array=this.getArray()},Fc.getFilterSource=function(Fa,Fb,Fc){var Fd;for(var Fe in Fc=Fc.toLocaleLowerCase(),Fa)!(Fd=Fa[Fe]).isDirectory&&-1<String(Fd.label).toLowerCase().indexOf(Fc)&&(Fd.x=0,Fb.push(Fd)),Fd.child&&0<Fd.child.length&&this.getFilterSource(Fd.child,Fb,Fc)},Fg(0,Fc,"spaceBottom",function(){return this._list.spaceY},function(Fa){this._list.spaceY=Fa}),Fg(0,Fc,"keepStatus",function(){return this._keepStatus},function(Fa){this._keepStatus=Fa}),Fg(0,Fc,"itemRender",function(){return this._list.itemRender},function(Fa){this._list.itemRender=Fa}),Fg(0,Fc,"array",function(){return this._list.array},function(Fa){this._keepStatus&&this._list.array&&Fa&&this.parseOpenStatus(this._list.array,Fa),this._source=Fa,this._list.array=this.getArray()}),Fg(0,Fc,"mouseHandler",function(){return this._list.mouseHandler},function(Fa){this._list.mouseHandler=Fa}),Fg(0,Fc,"dataSource",Fa.prototype._$get_dataSource,function(Fa){this._dataSource=Fa,Fr.superSet(FJ,this,"dataSource",Fa)}),Fg(0,Fc,"source",function(){return this._source}),Fg(0,Fc,"scrollBar",function(){return this._list.scrollBar}),Fg(0,Fc,"list",function(){return this._list}),Fg(0,Fc,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(Fa){this._list.vScrollBarSkin=Fa}),Fg(0,Fc,"renderHandler",function(){return this._renderHandler},function(Fa){this._renderHandler=Fa}),Fg(0,Fc,"selectedIndex",function(){return this._list.selectedIndex},function(Fa){this._list.selectedIndex=Fa}),Fg(0,Fc,"spaceLeft",function(){return this._spaceLeft},function(Fa){this._spaceLeft=Fa}),Fg(0,Fc,"selectedItem",function(){return this._list.selectedItem},function(Fa){this._list.selectedItem=Fa}),Fg(0,Fc,"width",Fa.prototype._$get_width,function(Fa){Fr.superSet(FJ,this,"width",Fa),this._list.width=Fa}),Fg(0,Fc,"height",Fa.prototype._$get_height,function(Fa){Fr.superSet(FJ,this,"height",Fa),this._list.height=Fa}),Fg(0,Fc,"xml",null,function(Fa){var Fb=[];this.parseXml(Fa.childNodes[0],Fb,null,!0),this.array=Fb}),Fg(0,Fc,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),Fb}(FJ),Faa=function(Fa){function Fb(){this._items=null,this._selectedIndex=0,Fb.__super.call(this),this._setIndexHandler=Fo.create(this,this.setIndex,null,!1)}Ff(Fb,"laya.ui.ViewStack",Fa);var Fc=Fb.prototype;return Fr.imps(Fc,{"laya.ui.IItem":!0}),Fc.setItems=function(Fa){this.removeChildren();for(var Fb=0,Fc=0,Fd=Fa.length;Fc<Fd;Fc++){var Fe=Fa[Fc];Fe&&(Fe.name="item"+Fb,this.addChild(Fe),Fb++)}this.initItems()},Fc.addItem=function(Fa){Fa.name="item"+this._items.length,this.addChild(Fa),this.initItems()},Fc.initItems=function(){this._items=[];for(var Fa=0;Fa<1e4;Fa++){var Fb=this.getChildByName("item"+Fa);if(null==Fb)break;this._items.push(Fb),Fb.visible=Fa==this._selectedIndex}},Fc.setSelect=function(Fa,Fb){this._items&&-1<Fa&&Fa<this._items.length&&(this._items[Fa].visible=Fb)},Fc.setIndex=function(Fa){this.selectedIndex=Fa},Fg(0,Fc,"dataSource",Fa.prototype._$get_dataSource,function(Fa){if("number"==typeof(this._dataSource=Fa)&&Math.floor(Fa)==Fa||"string"==typeof Fa)this.selectedIndex=parseInt(Fa);else for(var Fb in this._dataSource)this.hasOwnProperty(Fb)&&(this[Fb]=this._dataSource[Fb])}),Fg(0,Fc,"selectedIndex",function(){return this._selectedIndex},function(Fa){this._selectedIndex!=Fa&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Fa,this.setSelect(this._selectedIndex,!0))}),Fg(0,Fc,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Fa){this.selectedIndex=this._items.indexOf(Fa)}),Fg(0,Fc,"items",function(){return this._items}),Fg(0,Fc,"setIndexHandler",function(){return this._setIndexHandler},function(Fa){this._setIndexHandler=Fa}),Fb}(FJ),Fba=function(Fa){function Fb(){Fb.__super.call(this)}return Ff(Fb,"laya.ui.VScrollBar",FO),Fb}(),Fca=function(Fb){function Fc(Fa){this._bg=null,this._skin=null,Fc.__super.call(this),void 0===Fa&&(Fa=""),this.text=Fa,this.skin=this.skin}Ff(Fc,"laya.ui.TextInput",Fb);var Fa=Fc.prototype;return Fa.preinitialize=function(){this.mouseEnabled=!0},Fa.destroy=function(Fa){Fu.clearCache(this,this._skin),void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._bg&&this._bg.destroy(),this._bg=null},Fa.createChildren=function(){this.addChild(this._tf=new Fp),this._tf.padding=FD.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},Fa._onFocus=function(){this.event("focus",this)},Fa._onBlur=function(){this.event("blur",this)},Fa._onInput=function(){this.event("input",this)},Fa._onEnter=function(){this.event("enter",this)},Fa.initialize=function(){this.width=128,this.height=22},Fa.select=function(){this._tf.select()},Fa.setSelection=function(Fa,Fb){this._tf.setSelection(Fa,Fb)},Fg(0,Fa,"text",Fb.prototype._$get_text,function(Fa){this._tf.text!=Fa&&(Fa+="",this._tf.text=Fa,this.event("change"))}),Fg(0,Fa,"bg",function(){return this._bg},function(Fa){this.graphics=this._bg=Fa}),Fg(0,Fa,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(Fa){this._tf.inputElementYAdjuster=Fa}),Fg(0,Fa,"multiline",function(){return this._tf.multiline},function(Fa){this._tf.multiline=Fa}),Fg(0,Fa,"skin",function(){return this._skin},function(Fa){this._skin!=Fa&&(Fu.clearCache(this,this._skin),this._skin=Fa,this._bg||(this.graphics=this._bg=new FG),Fu.keepCache(this,this._skin),this._bg.source=Fu.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),Fg(0,Fa,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(Fa){this._bg||(this.graphics=this._bg=new FG),this._bg.sizeGrid=FE.fillArray(FD.defaultSizeGrid,Fa,Number)}),Fg(0,Fa,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(Fa){this._tf.inputElementXAdjuster=Fa}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(FR,this,"width",Fa),this._bg&&(this._bg.width=Fa)}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(FR,this,"height",Fa),this._bg&&(this._bg.height=Fa)}),Fg(0,Fa,"editable",function(){return this._tf.editable},function(Fa){this._tf.editable=Fa}),Fg(0,Fa,"restrict",function(){return this._tf.restrict},function(Fa){this._tf.restrict=Fa}),Fg(0,Fa,"prompt",function(){return this._tf.prompt},function(Fa){this._tf.prompt=Fa}),Fg(0,Fa,"promptColor",function(){return this._tf.promptColor},function(Fa){this._tf.promptColor=Fa}),Fg(0,Fa,"maxChars",function(){return this._tf.maxChars},function(Fa){this._tf.maxChars=Fa}),Fg(0,Fa,"focus",function(){return this._tf.focus},function(Fa){this._tf.focus=Fa}),Fg(0,Fa,"type",function(){return this._tf.type},function(Fa){this._tf.type=Fa}),Fg(0,Fa,"asPassword",function(){return this._tf.asPassword},function(Fa){this._tf.asPassword=Fa}),Fc}(FR),Fda=function(Fa){function Fb(){Fb.__super.call(this)}return Ff(Fb,"laya.ui.VSlider",FP),Fb}(),Fea=function(Fa){function Fd(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,Fd.__super.call(this)}Ff(Fd,"laya.ui.Dialog",Fa);var Fb=Fd.prototype;return Fb.initialize=function(){this.popupEffect=Fd.manager.popupEffectHandler,this.closeEffect=Fd.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},Fb._dealDragArea=function(){var Fa=this.getChildByName("drag");Fa&&(this.dragArea=Fa.x+","+Fa.y+","+Fa.width+","+Fa.height,Fa.removeSelf())},Fb._onClick=function(Fa){var Fb=Fa.target;if(Fb)switch(Fb.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(Fb.name)}},Fb.show=function(Fa,Fb){void 0===Fa&&(Fa=!1),void 0===Fb&&(Fb=!0),this._open(!1,Fa,Fb)},Fb.popup=function(Fa,Fb){void 0===Fa&&(Fa=!1),void 0===Fb&&(Fb=!0),this._open(!0,Fa,Fb)},Fb._open=function(Fa,Fb,Fc){Fd.manager.lock(!1),this.isModal=Fa,Fd.manager.open(this,Fb,Fc)},Fb.onOpened=function(){},Fb.close=function(Fa,Fb){void 0===Fb&&(Fb=!0),Fd.manager.close(this,Fa,Fb)},Fb.onClosed=function(Fa){},Fb._onMouseDown=function(Fa){var Fb=this.getMousePoint();this._dragArea.contains(Fb.x,Fb.y)?this.startDrag():this.stopDrag()},Fg(0,Fb,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(Fa){if(Fa){var Fb=FE.fillArray([0,0,0,0],Fa,Number);this._dragArea=new Ft(Fb[0],Fb[1],Fb[2],Fb[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),Fg(0,Fb,"isPopup",function(){return null!=this.parent}),Fg(0,Fb,"zOrder",Fa.prototype._$get_zOrder,function(Fa){Fr.superSet(FT,this,"zOrder",Fa),Fd.manager._checkMask()}),Fg(1,Fd,"manager",function(){return Fd._manager=Fd._manager||new FI},function(Fa){Fd._manager=Fa}),Fd.setLockView=function(Fa){Fd.manager.setLockView(Fa)},Fd.lock=function(Fa){Fd.manager.lock(Fa)},Fd.closeAll=function(){Fd.manager.closeAll()},Fd.getDialogsByGroup=function(Fa){return Fd.manager.getDialogsByGroup(Fa)},Fd.closeByGroup=function(Fa){return Fd.manager.closeByGroup(Fa)},Fd.CLOSE="close",Fd.CANCEL="cancel",Fd.SURE="sure",Fd.NO="no",Fd.OK="ok",Fd.YES="yes",Fd._manager=null,Fd}(FT),Ffa=function(Fa){function Fb(){Fb.__super.call(this)}Ff(Fb,"laya.ui.HBox",Fa);var Fc=Fb.prototype;return Fc.sortItem=function(Fa){Fa&&Fa.sort(function(Fa,Fb){return Fa.x-Fb.x})},Fc.changeItems=function(){this._itemChanged=!1;for(var Fa=[],Fb=0,Fc=0,Fd=this.numChildren;Fc<Fd;Fc++){var Fe=this.getChildAt(Fc);Fe&&Fe.layoutEnabled&&(Fa.push(Fe),Fb=this._height?this._height:Math.max(Fb,Fe.height*Fe.scaleY))}this.sortItem(Fa);var Ff=0;for(Fc=0,Fd=Fa.length;Fc<Fd;Fc++)(Fe=Fa[Fc]).x=Ff,Ff+=Fe.width*Fe.scaleX+this._space,"top"==this._align?Fe.y=0:"middle"==this._align?Fe.y=.5*(Fb-Fe.height*Fe.scaleY):"bottom"==this._align&&(Fe.y=Fb-Fe.height*Fe.scaleY);this.changeSize()},Fg(0,Fc,"height",Fa.prototype._$get_height,function(Fa){this._height!=Fa&&(Fr.superSet(FV,this,"height",Fa),this.callLater(this.changeItems))}),Fb.NONE="none",Fb.TOP="top",Fb.MIDDLE="middle",Fb.BOTTOM="bottom",Fb}(FV),Fga=function(Fa){function Fb(){Fb.__super.call(this)}Ff(Fb,"laya.ui.VBox",Fa);var Fc=Fb.prototype;return Fc.changeItems=function(){this._itemChanged=!1;for(var Fa=[],Fb=0,Fc=0,Fd=this.numChildren;Fc<Fd;Fc++){var Fe=this.getChildAt(Fc);Fe&&Fe.layoutEnabled&&(Fa.push(Fe),Fb=this._width?this._width:Math.max(Fb,Fe.width*Fe.scaleX))}this.sortItem(Fa);var Ff=0;for(Fc=0,Fd=Fa.length;Fc<Fd;Fc++)(Fe=Fa[Fc]).y=Ff,Ff+=Fe.height*Fe.scaleY+this._space,"left"==this._align?Fe.x=0:"center"==this._align?Fe.x=.5*(Fb-Fe.width*Fe.scaleX):"right"==this._align&&(Fe.x=Fb-Fe.width*Fe.scaleX);this.changeSize()},Fg(0,Fc,"width",Fa.prototype._$get_width,function(Fa){this._width!=Fa&&(Fr.superSet(FV,this,"width",Fa),this.callLater(this.changeItems))}),Fb.NONE="none",Fb.LEFT="left",Fb.CENTER="center",Fb.RIGHT="right",Fb}(FV),Fha=function(Fa){function Fb(){Fb.__super.call(this)}return Ff(Fb,"laya.ui.RadioGroup",F_),Fb.prototype.createItem=function(Fa,Fb){return new Fk(Fa,Fb)},Fb}(),Fia=function(Fa){function Fb(){Fb.__super.call(this)}return Ff(Fb,"laya.ui.Tab",F_),Fb.prototype.createItem=function(Fa,Fb){return new FK(Fa,Fb)},Fb}(),Fja=function(Fb){function Fc(Fa){this._vScrollBar=null,this._hScrollBar=null,void 0===Fa&&(Fa=""),Fc.__super.call(this,Fa)}Ff(Fc,"laya.ui.TextArea",Fb);var Fa=Fc.prototype;return Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},Fa.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},Fa.onVBarChanged=function(Fa){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},Fa.onHBarChanged=function(Fa){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},Fa.changeScroll=function(){var Fa=this._vScrollBar&&0<this._tf.maxScrollY,Fb=this._hScrollBar&&0<this._tf.maxScrollX,Fc=Fa?this._width-this._vScrollBar.width:this._width,Fd=Fb?this._height-this._hScrollBar.height:this._height,Fe=this._tf.padding||FD.labelPadding;this._tf.width=Fc,this._tf.height=Fd,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-Fe[2],this._vScrollBar.y=Fe[1],this._vScrollBar.height=this._height-(Fb?this._hScrollBar.height:0)-Fe[1]-Fe[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=Fd/Math.max(this._tf.textHeight,Fd),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=Fa),this._hScrollBar&&(this._hScrollBar.x=Fe[0],this._hScrollBar.y=this._height-this._hScrollBar.height-Fe[3],this._hScrollBar.width=this._width-(Fa?this._vScrollBar.width:0)-Fe[0]-Fe[2],this._hScrollBar.scrollSize=Math.max(.033*Fc,1),this._hScrollBar.thumbPercent=Fc/Math.max(this._tf.textWidth,Fc),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=Fb)},Fa.scrollTo=function(Fa){this.commitMeasure(),this._tf.scrollY=Fa},Fg(0,Fa,"scrollY",function(){return this._tf.scrollY}),Fg(0,Fa,"width",Fb.prototype._$get_width,function(Fa){Fr.superSet(Fca,this,"width",Fa),this.callLater(this.changeScroll)}),Fg(0,Fa,"hScrollBar",function(){return this._hScrollBar}),Fg(0,Fa,"height",Fb.prototype._$get_height,function(Fa){Fr.superSet(Fca,this,"height",Fa),this.callLater(this.changeScroll)}),Fg(0,Fa,"maxScrollX",function(){return this._tf.maxScrollX}),Fg(0,Fa,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Fa){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new Fba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=Fa}),Fg(0,Fa,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Fa){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new FY),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=Fa}),Fg(0,Fa,"vScrollBar",function(){return this._vScrollBar}),Fg(0,Fa,"maxScrollY",function(){return this._tf.maxScrollY}),Fg(0,Fa,"scrollX",function(){return this._tf.scrollX}),Fc}(Fca);!function(Fa){function Fb(){this._uiView=null,this.isCloseOther=!1,Fb.__super.call(this)}Ff(Fb,"laya.ui.AsynDialog",Fea);var Fc=Fb.prototype;Fc.createView=function(Fa){this._uiView=Fa},Fc._open=function(Fa,Fb,Fc){this.isModal=Fa,this.isCloseOther=Fb,Fea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},Fc.onCreated=function(){this.createUI(),this.onOpen()},Fc.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},Fc.onOpen=function(){Fea.manager.open(this,this.isCloseOther),Fea.manager.lock(!1)},Fc.close=function(Fa,Fb){void 0===Fb&&(Fb=!0),Fea.manager.close(this),this.onClose()},Fc.onClose=function(){},Fc.destroy=function(Fa){void 0===Fa&&(Fa=!0),laya.ui.View.prototype.destroy.call(this,Fa),this._uiView=null,this.onDestroy()},Fc.onDestroy=function(){}}();Fr.__init([FT])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Fa,Fb){"use strict";for(var Fc in Object.defineProperty(Fb,"__esModule",{value:!0}),Laya){var Fd=Laya[Fc];Fd&&Fd.__isclass&&(Fb[Fc]=Fd)}}),function(Fo,Fa,Fx){Fx.un,Fx.uns;var Fn=Fx.static,Fp=Fx.class,Fq=Fx.getset,Fd=Fx.__newvec,Fw=laya.maths.Arith,Fg=laya.webgl.atlas.AtlasResourceManager,Fc=laya.webgl.shader.BaseShader,FH=laya.utils.Browser,Fh=laya.webgl.utils.Buffer,Fy=laya.utils.Byte,Fe=laya.utils.ClassUtils,Fi=Fx.Config,Ff=(laya.events.Event,laya.events.EventDispatcher),FD=laya.utils.Handler,Ft=laya.net.Loader,Fb=laya.net.LoaderManager,Fj=(laya.maths.MathUtil,laya.display.Node),Fr=laya.renders.Render,Fm=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),Fs=laya.resource.Resource,Fu=laya.utils.RunDriver,Fv=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),Fz=laya.display.Sprite,FA=laya.utils.Stat,FB=laya.utils.StringKey,FE=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),FC=laya.utils.Utils,FF=laya.webgl.WebGL,FG=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;Fx.interface("laya.d3.core.IClone"),Fx.interface("laya.d3.graphics.IVertex"),Fx.interface("laya.d3.core.render.IUpdate"),Fx.interface("laya.d3.core.scene.ITreeNode"),Fx.interface("laya.d3.core.render.IRenderable");(function(){function FK(){}Fp(FK,"laya.d3.animation.AnimationClipParser01"),FK.READ_DATA=function(){FK._DATA.offset=FK._reader.getUint32(),FK._DATA.size=FK._reader.getUint32()},FK.READ_BLOCK=function(){for(var Fa=FK._BLOCK.count=FK._reader.getUint16(),Fb=FK._BLOCK.blockStarts=[],Fc=FK._BLOCK.blockLengths=[],Fd=0;Fd<Fa;Fd++)Fb.push(FK._reader.getUint32()),Fc.push(FK._reader.getUint32())},FK.READ_STRINGS=function(){var Fa=FK._reader.getUint32(),Fb=FK._reader.getUint16(),Fc=FK._reader.pos;FK._reader.pos=Fa+FK._DATA.offset;for(var Fd=0;Fd<Fb;Fd++)FK._strings[Fd]=FK._reader.readUTFString();FK._reader.pos=Fc},FK.parse=function(Fa,Fb){FK._animationClip=Fa;(FK._reader=Fb).__getBuffer();FK.READ_DATA(),FK.READ_BLOCK(),FK.READ_STRINGS();for(var Fc=0,Fd=FK._BLOCK.count;Fc<Fd;Fc++){var Fe=Fb.getUint16(),Ff=FK._strings[Fe],Fg=FK["READ_"+Ff];if(null==Fg)throw new Error("model file err,no this function:"+Fe+" "+Ff);Fg.call()}},FK.READ_ANIMATIONS=function(){var Fa,Fb=0,Fc=0,Fd=FK._reader,Fe=Fd.__getBuffer(),Ff=[],Fg=Fd.getUint8();for(Ff.length=Fg,Fb=0;Fb<Fg;Fb++)Ff[Fb]=Fd.getUint16();var Fh=[],Fi=Fd.getUint16();for(Fh.length=Fi,Fb=0;Fb<Fi;Fb++)Fh[Fb]=Fd.getFloat32();var Fj=FK._animationClip;Fj.name=FK._strings[Fd.getUint16()];var Fm=Fj._duration=Fd.getFloat32();Fj.islooping=!!Fd.getByte(),Fj._frameRate=Fd.getInt16();var Fn=Fd.getInt16(),Fo=Fj._nodes=new Array;Fo.length=Fn,(Fj._publicClipDatas=[]).length=Fn;var Fp=Fj._nodesMap={},Fq=0,Fr=0;for(Fb=0;Fb<Fn;Fb++){Fa=Fo[Fb]=new FS;var Fs=Fd.getUint16(),Ft=Fa.path=[];for(Ft.length=Fs,Fc=0;Fc<Fs;Fc++)Ft[Fc]=FK._strings[Fd.getUint16()];var Fu=Ft.join("/"),Fv=Fp[Fu];Fv||(Fp[Fu]=Fv=[]),Fv.push(Fa);var Fw=Fd.getInt16();-1!==Fw&&(Fa.componentType=FK._strings[Fw]);var Fx=FQ._propertyIndexDic[FK._strings[Fd.getUint16()]];if(null==Fx)throw new Error("AnimationClipParser01:unknown property name.");var Fy=Fx<4,Fz=!Fy||Fy&&""===Ft[0];(Fa._cacheProperty=Fz)?Fq++:Fr++,Fa.propertyNameID=Fx;var FA=Ff[Fd.getUint8()];Fa.keyFrameWidth=FA/4;var FB=Fa.keyFrames=[],FC=FB.length=Fd.getUint16(),FD=null,FE=NaN;for(Fc=0;Fc<FC;Fc++){var FF=FB[Fc]=new FR;FE=FF.startTime=Fh[Fd.getUint16()];var FG=Fd.pos;FF.inTangent=new Float32Array(Fe.slice(FG,FG+FA)),Fd.pos+=FA,FG=Fd.pos,FF.outTangent=new Float32Array(Fe.slice(FG,FG+FA)),Fd.pos+=FA,FG=Fd.pos,FF.data=new Float32Array(Fe.slice(FG,FG+FA)),Fd.pos+=FA,FD&&(FD.next=FF,FD.duration=FE-FD.startTime),FD=FF}FF.next=null,FF.duration=Fm-FE}var FH=Fj._nodeToCachePropertyMap=new Int32Array(Fn),FI=Fj._cachePropertyMap=new Int32Array(Fq),FJ=Fj._unCachePropertyMap=new Int32Array(Fr);for(Fq=Fr=0,Fb=0;Fb<Fn;Fb++)(Fa=Fo[Fb])._cacheProperty?(FH[Fb]=Fq,FI[Fq++]=Fb):FJ[Fr++]=Fb},FK._animationClip=null,FK._reader=null,FK._strings=[],Fn(FK,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function FO(){}Fp(FO,"laya.d3.animation.AnimationClipParser02"),FO.READ_DATA=function(){FO._DATA.offset=FO._reader.getUint32(),FO._DATA.size=FO._reader.getUint32()},FO.READ_BLOCK=function(){for(var Fa=FO._BLOCK.count=FO._reader.getUint16(),Fb=FO._BLOCK.blockStarts=[],Fc=FO._BLOCK.blockLengths=[],Fd=0;Fd<Fa;Fd++)Fb.push(FO._reader.getUint32()),Fc.push(FO._reader.getUint32())},FO.READ_STRINGS=function(){var Fa=FO._reader.getUint32(),Fb=FO._reader.getUint16(),Fc=FO._reader.pos;FO._reader.pos=Fa+FO._DATA.offset;for(var Fd=0;Fd<Fb;Fd++)FO._strings[Fd]=FO._reader.readUTFString();FO._reader.pos=Fc},FO.parse=function(Fa,Fb){FO._animationClip=Fa;(FO._reader=Fb).__getBuffer();FO.READ_DATA(),FO.READ_BLOCK(),FO.READ_STRINGS();for(var Fc=0,Fd=FO._BLOCK.count;Fc<Fd;Fc++){var Fe=Fb.getUint16(),Ff=FO._strings[Fe],Fg=FO["READ_"+Ff];if(null==Fg)throw new Error("model file err,no this function:"+Fe+" "+Ff);Fg.call()}},FO.READ_ANIMATIONS=function(){var Fa,Fb=0,Fc=0,Fd=FO._reader,Fe=Fd.__getBuffer(),Ff=[],Fg=Fd.getUint8();for(Ff.length=Fg,Fb=0;Fb<Fg;Fb++)Ff[Fb]=Fd.getUint16();var Fh=[],Fi=Fd.getUint16();for(Fh.length=Fi,Fb=0;Fb<Fi;Fb++)Fh[Fb]=Fd.getFloat32();var Fj=FO._animationClip;Fj.name=FO._strings[Fd.getUint16()];var Fm=Fj._duration=Fd.getFloat32();Fj.islooping=!!Fd.getByte(),Fj._frameRate=Fd.getInt16();var Fn=Fd.getInt16(),Fo=Fj._nodes=new Array;Fo.length=Fn,(Fj._publicClipDatas=[]).length=Fn;var Fp=Fj._nodesMap={},Fq=0,Fr=0;for(Fb=0;Fb<Fn;Fb++){Fa=Fo[Fb]=new FS;var Fs=Fd.getUint16(),Ft=Fa.path=[];for(Ft.length=Fs,Fc=0;Fc<Fs;Fc++)Ft[Fc]=FO._strings[Fd.getUint16()];var Fu=Ft.join("/"),Fv=Fp[Fu];Fv||(Fp[Fu]=Fv=[]),Fv.push(Fa);var Fw=Fd.getInt16();-1!==Fw&&(Fa.componentType=FO._strings[Fw]);var Fx=FQ._propertyIndexDic[FO._strings[Fd.getUint16()]];if(null==Fx)throw new Error("AnimationClipParser02:unknown property name.");var Fy=Fx<4,Fz=!Fy||Fy&&""===Ft[0];(Fa._cacheProperty=Fz)?Fq++:Fr++,Fa.propertyNameID=Fx;var FA=Ff[Fd.getUint8()];Fa.keyFrameWidth=FA/4;var FB=Fa.keyFrames=[],FC=FB.length=Fd.getUint16(),FD=null,FE=NaN;for(Fc=0;Fc<FC;Fc++){var FF=FB[Fc]=new FR;FE=FF.startTime=Fh[Fd.getUint16()];var FG=Fd.pos;FF.inTangent=new Float32Array(Fe.slice(FG,FG+FA)),Fd.pos+=FA,FG=Fd.pos,FF.outTangent=new Float32Array(Fe.slice(FG,FG+FA)),Fd.pos+=FA,FG=Fd.pos,FF.data=new Float32Array(Fe.slice(FG,FG+FA)),Fd.pos+=FA,FD&&(FD.next=FF,FD.duration=FE-FD.startTime),FD=FF}FF.next=null,FF.duration=Fm-FE}var FH=Fd.getUint16();for(Fb=0;Fb<FH;Fb++){var FI,FJ=new FP;FJ.time=Fd.getFloat32(),FJ.eventName=FO._strings[Fd.getUint16()];var FK=Fd.getUint16();for(0<FK&&(FJ.params=FI=[]),Fc=0;Fc<FK;Fc++){switch(Fd.getByte()){case 0:FI.push(!!Fd.getByte());break;case 1:FI.push(Fd.getInt32());break;case 2:FI.push(Fd.getFloat32());break;case 3:FI.push(FO._strings[Fd.getUint16()]);break;default:throw new Error("unknown type.")}}Fj.addEvent(FJ)}var FL=Fj._nodeToCachePropertyMap=new Int32Array(Fn),FM=Fj._cachePropertyMap=new Int32Array(Fq),FN=Fj._unCachePropertyMap=new Int32Array(Fr);for(Fq=Fr=0,Fb=0;Fb<Fn;Fb++)(Fa=Fo[Fb])._cacheProperty?(FL[Fb]=Fq,FM[Fq++]=Fb):FN[Fr++]=Fb},FO._animationClip=null,FO._reader=null,FO._strings=[],Fn(FO,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var FP=function(){function Fa(){this.time=NaN,this.eventName=null,this.params=null}return Fp(Fa,"laya.d3.animation.AnimationEvent"),Fa}(),FQ=function(){function Fd(){this._childs=[],this.transform=new Fub(this)}Fp(Fd,"laya.d3.animation.AnimationNode");var Fa=Fd.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.addChild=function(Fa){Fa._parent=this,Fa.transform.setParent(this.transform),this._childs.push(Fa)},Fa.removeChild=function(Fa){var Fb=this._childs.indexOf(Fa);-1!==Fb&&this._childs.splice(Fb,1)},Fa.getChildByName=function(Fa){for(var Fb=0,Fc=this._childs.length;Fb<Fc;Fb++){var Fd=this._childs[Fb];if(Fd.name===Fa)return Fd}return null},Fa.getChildByIndex=function(Fa){return this._childs[Fa]},Fa.getChildCount=function(){return this._childs.length},Fa.cloneTo=function(Fa){var Fb=Fa;Fb.name=this.name;for(var Fc=0,Fd=this._childs.length;Fc<Fd;Fc++){var Fe=this._childs[Fc],Ff=Fe.clone();Fb.addChild(Ff);var Fg=Fe.transform,Fh=Ff.transform;Fh.setLocalPosition(Fg.getLocalPosition()),Fh.setLocalRotation(Fg.getLocalRotation()),Fh.setLocalScale(Fg.getLocalScale()),Fh._localRotationEuler=Fg._localRotationEuler,Fh._setWorldMatrixIgnoreUpdate(Fg.getWorldMatrix())}},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fd.__init__=function(){Fd.registerAnimationNodeProperty("localPosition",Fd._getLocalPosition,Fd._setLocalPosition),Fd.registerAnimationNodeProperty("localRotation",Fd._getLocalRotation,Fd._setLocalRotation),Fd.registerAnimationNodeProperty("localScale",Fd._getLocalScale,Fd._setLocalScale),Fd.registerAnimationNodeProperty("localRotationEuler",Fd._getLocalRotationEuler,Fd._setLocalRotationEuler),Fd.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",Fd._getParticleRenderSharedMaterialTintColor,Fd._setParticleRenderSharedMaterialTintColor),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",Fd._getMeshRenderSharedMaterialTilingOffset,Fd._setMeshRenderSharedMaterialTilingOffset),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",Fd._getMeshRenderSharedMaterialAlbedo,Fd._setMeshRenderSharedMaterialAlbedo),Fd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",Fd._getSkinnedMeshRenderSharedMaterialTilingOffset,Fd._setSkinnedMeshRenderSharedMaterialTilingOffset),Fd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",Fd._getSkinnedMeshRenderSharedMaterialAlbedo,Fd._setSkinnedMeshRenderSharedMaterialAlbedo),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",Fd._getMeshRenderSharedMaterialAlbedo,Fd._setMeshRenderSharedMaterialAlbedo),Fd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",Fd._getSkinnedMeshRenderSharedMaterialAlbedo,Fd._setSkinnedMeshRenderSharedMaterialAlbedo),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",Fd._getMeshRenderSharedMaterialIntensity,Fd._setMeshRenderSharedMaterialIntensity),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",Fd._getMeshRenderSharedMaterialAlpha,Fd._setMeshRenderSharedMaterialAlpha),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",Fd._getMeshRenderSharedMaterialAlphaColor,Fd._setMeshRenderSharedMaterialAlphaColor),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",Fd._getMeshRenderSharedMaterialBaseColor,Fd._setMeshRenderSharedMaterialBaseColor),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",Fd._getMeshRenderSharedMaterialDissolve,Fd._setMeshRenderSharedMaterialDissolve),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",Fd._getMeshRenderSharedMaterialDissolveSpeed,Fd._setMeshRenderSharedMaterialDissolveSpeed),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",Fd._getMeshRenderSharedMaterialMMultiplier,Fd._setMeshRenderSharedMaterialMMultiplier),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",Fd._getMeshRenderSharedMaterialBaseScrollSpeedX,Fd._setMeshRenderSharedMaterialBaseScrollSpeedX),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",Fd._getMeshRenderSharedMaterialBaseScrollSpeedY,Fd._setMeshRenderSharedMaterialBaseScrollSpeedY),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",Fd._getMeshRenderSharedMaterialSecondScrollSpeedX,Fd._setMeshRenderSharedMaterialSecondScrollSpeedX),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",Fd._getMeshRenderSharedMaterialSecondScrollSpeedY,Fd._setMeshRenderSharedMaterialSecondScrollSpeedY),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",Fd._getMeshRenderSharedMaterialDetailTilingOffset,Fd._setMeshRenderSharedMaterialDetailTilingOffset),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",Fd._getMeshRenderSharedMaterialDissolveTilingOffset,Fd._setMeshRenderSharedMaterialDissolveTilingOffset),Fd.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",Fd._getMeshRenderSharedMaterialMaskTilingOffset,Fd._setMeshRenderSharedMaterialMaskTilingOffset)},Fd.registerAnimationNodeProperty=function(Fa,Fb,Fc){if(Fd._propertyIndexDic[Fa])throw new Error("AnimationNode: this propertyName has registered.");Fd._propertyIndexDic[Fa]=Fd._propertyIDCounter,Fd._propertyGetFuncs[Fd._propertyIDCounter]=Fb,Fd._propertySetFuncs[Fd._propertyIDCounter]=Fc,Fd._propertyIDCounter++},Fd._getLocalPosition=function(Fa,Fb){return Fa?Fa.transform.getLocalPosition():Fb._transform.localPosition.elements},Fd._setLocalPosition=function(Fa,Fb,Fc){if(Fa)Fa.transform.setLocalPosition(Fc);else{var Fd=Fb._transform,Fe=Fd.localPosition;Fe.elements=Fc,Fd.localPosition=Fe}},Fd._getLocalRotation=function(Fa,Fb){return Fa?Fa.transform.getLocalRotation():Fb._transform.localRotation.elements},Fd._setLocalRotation=function(Fa,Fb,Fc){if(Fa)Fa.transform.setLocalRotation(Fc);else{var Fd=Fb._transform,Fe=Fd.localRotation;Fe.elements=Fc,Fd.localRotation=Fe}},Fd._getLocalScale=function(Fa,Fb){return Fa?Fa.transform.getLocalScale():Fb._transform.localScale.elements},Fd._setLocalScale=function(Fa,Fb,Fc){if(Fa)Fa.transform.setLocalScale(Fc);else{var Fd=Fb._transform,Fe=Fd.localScale;Fe.elements=Fc,Fd.localScale=Fe}},Fd._getLocalRotationEuler=function(Fa,Fb){return Fa?Fa.transform.getLocalRotationEuler():Fb._transform.localRotationEuler.elements},Fd._setLocalRotationEuler=function(Fa,Fb,Fc){if(Fa)Fa.transform.setLocalRotationEuler(Fc);else{var Fd=Fb._transform,Fe=Fd.localRotationEuler;Fe.elements=Fc,Fd.localRotationEuler=Fe}},Fd._getMeshRenderSharedMaterialTilingOffset=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return Fb.meshRender.sharedMaterial.tilingOffset.elements},Fd._setMeshRenderSharedMaterialTilingOffset=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.meshRender.material).tilingOffset).elements=Fc,Fd.tilingOffset=Fe)}else(Fe=(Fd=Fb.meshRender.material).tilingOffset).elements=Fc,Fd.tilingOffset=Fe},Fd._getMeshRenderSharedMaterialAlbedo=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.albedoColor.elements:null}return Fb.meshRender.sharedMaterial.albedoColor.elements},Fd._setMeshRenderSharedMaterialAlbedo=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.meshRender.material).albedoColor).elements=Fc,Fd.albedoColor=Fe)}else(Fe=(Fd=Fb.meshRender.material).albedoColor).elements=Fc,Fd.albedoColor=Fe},Fd._getSkinnedMeshRenderSharedMaterialTilingOffset=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return Fb.skinnedMeshRender.sharedMaterial.tilingOffset.elements},Fd._setSkinnedMeshRenderSharedMaterialTilingOffset=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.skinnedMeshRender.material).tilingOffset).elements=Fc,Fd.tilingOffset=Fe)}else(Fe=(Fd=Fb.skinnedMeshRender.material).tilingOffset).elements=Fc,Fd.tilingOffset=Fe},Fd._getSkinnedMeshRenderSharedMaterialAlbedo=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return Fb.skinnedMeshRender.sharedMaterial.albedoColor.elements},Fd._setSkinnedMeshRenderSharedMaterialAlbedo=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.skinnedMeshRender.material).albedoColor).elements=Fc,Fd.albedoColor=Fe)}else(Fe=(Fd=Fb.skinnedMeshRender.material).albedoColor).elements=Fc,Fd.albedoColor=Fe},Fd._getParticleRenderSharedMaterialTintColor=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.particleRender.sharedMaterial.tintColor.elements:null}return Fb.particleRender.sharedMaterial.tintColor.elements},Fd._setParticleRenderSharedMaterialTintColor=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.particleRender.material).tintColor).elements=Fc,Fd.tintColor=Fe)}else(Fe=(Fd=Fb.particleRender.material).tintColor).elements=Fc,Fd.tintColor=Fe},Fd._getMeshRenderSharedMaterialAlphaColor=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.alphaColor.elements:null}return Fb.meshRender.sharedMaterial.alphaColor.elements},Fd._setMeshRenderSharedMaterialAlphaColor=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.meshRender.material).alphaColor).elements=Fc,Fd.alphaColor=Fe)}else(Fe=(Fd=Fb.meshRender.material).alphaColor).elements=Fc,Fd.alphaColor=Fe},Fd._getMeshRenderSharedMaterialBaseColor=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.baseColor.elements:null}return Fb.meshRender.sharedMaterial.baseColor.elements},Fd._setMeshRenderSharedMaterialBaseColor=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.meshRender.material).baseColor).elements=Fc,Fd.baseColor=Fe)}else(Fe=(Fd=Fb.meshRender.material).baseColor).elements=Fc,Fd.baseColor=Fe},Fd._getMeshRenderSharedMaterialDissolve=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.dissolve:0}return Fb.meshRender.sharedMaterial.dissolve},Fd._setMeshRenderSharedMaterialDissolve=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.dissolve=Fc[0])}else Fb.meshRender.material.dissolve=Fc[0]},Fd._getMeshRenderSharedMaterialDissolveSpeed=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.dissolveSpeed:0}return Fb.meshRender.sharedMaterial.dissolveSpeed},Fd._setMeshRenderSharedMaterialDissolveSpeed=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.dissolveSpeed=Fc[0])}else Fb.meshRender.material.dissolveSpeed=Fc[0]},Fd._getMeshRenderSharedMaterialMMultiplier=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.mMultiplier:0}return Fb.meshRender.sharedMaterial.mMultiplier},Fd._setMeshRenderSharedMaterialMMultiplier=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.mMultiplier=Fc[0])}else Fb.meshRender.material.mMultiplier=Fc[0]},Fd._getMeshRenderSharedMaterialBaseScrollSpeedX=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return Fb.meshRender.sharedMaterial.baseScrollSpeedX},Fd._setMeshRenderSharedMaterialBaseScrollSpeedX=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.baseScrollSpeedX=Fc[0])}else Fb.meshRender.material.baseScrollSpeedX=Fc[0]},Fd._getMeshRenderSharedMaterialBaseScrollSpeedY=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return Fb.meshRender.sharedMaterial.baseScrollSpeedY},Fd._setMeshRenderSharedMaterialBaseScrollSpeedY=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.baseScrollSpeedY=Fc[0])}else Fb.meshRender.material.baseScrollSpeedY=Fc[0]},Fd._getMeshRenderSharedMaterialSecondScrollSpeedX=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return Fb.meshRender.sharedMaterial.secondScrollSpeedX},Fd._setMeshRenderSharedMaterialSecondScrollSpeedX=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.secondScrollSpeedX=Fc[0])}else Fb.meshRender.material.secondScrollSpeedX=Fc[0]},Fd._getMeshRenderSharedMaterialSecondScrollSpeedY=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return Fb.meshRender.sharedMaterial.secondScrollSpeedY},Fd._setMeshRenderSharedMaterialSecondScrollSpeedY=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.secondScrollSpeedY=Fc[0])}else Fb.meshRender.material.secondScrollSpeedY=Fc[0]},Fd._getMeshRenderSharedMaterialAlpha=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.alpha:0}return Fb.meshRender.sharedMaterial.alpha},Fd._setMeshRenderSharedMaterialAlpha=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.alpha=Fc[0])}else Fb.meshRender.material.alpha=Fc[0]},Fd._getMeshRenderSharedMaterialIntensity=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.intensity:0}return Fb.meshRender.sharedMaterial.intensity},Fd._setMeshRenderSharedMaterialIntensity=function(Fa,Fb,Fc){if(Fa){var Fd=Fa.transform._entity;Fd&&(Fd.owner.meshRender.material.intensity=Fc[0])}else Fb.meshRender.material.intensity=Fc[0]},Fd._getMeshRenderSharedMaterialDetailTilingOffset=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return Fb.meshRender.sharedMaterial.detailTilingOffset.elements},Fd._setMeshRenderSharedMaterialDetailTilingOffset=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.meshRender.material).detailTilingOffset).elements=Fc,Fd.detailTilingOffset=Fe)}else(Fe=(Fd=Fb.meshRender.material).detailTilingOffset).elements=Fc,Fd.detailTilingOffset=Fe},Fd._getMeshRenderSharedMaterialDissolveTilingOffset=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return Fb.meshRender.sharedMaterial.dissolveTilingOffset.elements},Fd._setMeshRenderSharedMaterialDissolveTilingOffset=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.meshRender.material).dissolveTilingOffset).elements=Fc,Fd.dissolveTilingOffset=Fe)}else(Fe=(Fd=Fb.meshRender.material).dissolveTilingOffset).elements=Fc,Fd.dissolveTilingOffset=Fe},Fd._getMeshRenderSharedMaterialMaskTilingOffset=function(Fa,Fb){if(Fa){var Fc=Fa.transform._entity;return Fc?Fc.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return Fb.meshRender.sharedMaterial.maskTilingOffset.elements},Fd._setMeshRenderSharedMaterialMaskTilingOffset=function(Fa,Fb,Fc){var Fd,Fe;if(Fa){var Ff=Fa.transform._entity;Ff&&((Fe=(Fd=Ff.owner.meshRender.material).maskTilingOffset).elements=Fc,Fd.maskTilingOffset=Fe)}else(Fe=(Fd=Fb.meshRender.material).maskTilingOffset).elements=Fc,Fd.maskTilingOffset=Fe},Fd._propertyIDCounter=0,Fd._propertyIndexDic={},Fd._propertySetFuncs=[],Fd._propertyGetFuncs=[],Fd}(),FR=function(){function Fa(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return Fp(Fa,"laya.d3.animation.Keyframe"),Fa}(),FS=function(){function Fa(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return Fp(Fa,"laya.d3.animation.KeyframeNode"),Fa}(),FI=(function(){function Fa(){this._tempVector30=new Fgb,this._tempVector31=new Fgb,this._tempVector32=new Fgb,this._a=new Fgb,this._b=new Fgb,this._c=new Fgb,this._d=new Fgb}Fp(Fa,"laya.d3.core.glitter.SplineCurvePositionVelocity");var Fb=Fa.prototype;Fb.Init=function(Fa,Fb,Fc,Fd){Fa.cloneTo(this._d),Fb.cloneTo(this._c),Fgb.scale(Fa,2,this._a),Fgb.scale(Fc,2,this._tempVector30),Fgb.subtract(this._a,this._tempVector30,this._a),Fgb.add(this._a,Fb,this._a),Fgb.add(this._a,Fd,this._a),Fgb.scale(Fc,3,this._b),Fgb.scale(Fa,3,this._tempVector30),Fgb.subtract(this._b,this._tempVector30,this._b),Fgb.subtract(this._b,Fd,this._b),Fgb.scale(Fb,2,this._tempVector30),Fgb.subtract(this._b,this._tempVector30,this._b)},Fb.Slerp=function(Fa,Fb){Fgb.scale(this._a,Fa*Fa*Fa,this._tempVector30),Fgb.scale(this._b,Fa*Fa,this._tempVector31),Fgb.scale(this._c,Fa,this._tempVector32),Fgb.add(this._tempVector30,this._tempVector31,Fb),Fgb.add(Fb,this._tempVector32,Fb),Fgb.add(Fb,this._d,Fb)}}(),function(){function FM(Fa,Fb,Fc,Fd){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=Fa,this._h=Fb,this._minHeight=Fc,this._maxHeight=Fd}Fp(FM,"laya.d3.core.HeightMap");var Fa=FM.prototype;Fa._inBounds=function(Fa,Fb){return 0<=Fa&&Fa<this._h&&0<=Fb&&Fb<this._w},Fa.getHeight=function(Fa,Fb){return this._inBounds(Fa,Fb)?this._datas[Fa][Fb]:NaN},Fq(0,Fa,"width",function(){return this._w}),Fq(0,Fa,"height",function(){return this._h}),Fq(0,Fa,"maxHeight",function(){return this._maxHeight}),Fq(0,Fa,"minHeight",function(){return this._minHeight}),FM.creatFromMesh=function(Fa,Fb,Fc,Fd){for(var Fe=[],Ff=[],Fg=Fa.getSubMeshCount(),Fh=0;Fh<Fg;Fh++){for(var Fi=Fa.getSubMesh(Fh),Fj=Fi._getVertexBuffer(),Fm=Fj.getData(),Fn=[],Fo=0;Fo<Fm.length;Fo+=Fj.vertexDeclaration.vertexStride/4){var Fp=new Fgb(Fm[Fo+0],Fm[Fo+1],Fm[Fo+2]);Fn.push(Fp)}Fe.push(Fn);var Fq=Fi._getIndexBuffer();Ff.push(Fq.getData())}var Fr=Fa.boundingBox,Fs=Fr.min.x,Ft=Fr.min.z,Fu=Fr.max.x,Fv=Fr.max.z,Fw=Fr.min.y,Fx=Fr.max.y,Fy=Fu-Fs,Fz=Fv-Ft,FA=Fd.elements[0]=Fy/(Fb-1),FB=Fd.elements[1]=Fz/(Fc-1),FC=new FM(Fb,Fc,Fw,Fx),FD=FM._tempRay,FE=FD.direction.elements;FE[0]=0,FE[1]=-1,FE[2]=0;var FF=Fx+.1;FD.origin.elements[1]=FF;for(var FG=0;FG<Fc;FG++){var FH=Ft+FG*FB;FC._datas[FG]=[];for(var FI=0;FI<Fb;FI++){var FJ=Fs+FI*FA,FK=FD.origin.elements;FK[0]=FJ,FK[2]=FH;var FL=FM._getPosition(FD,Fe,Ff);FC._datas[FG][FI]=FL===Number.MAX_VALUE?NaN:FF-FL}}return FC},FM.createFromImage=function(Fa,Fb,Fc){for(var Fd=Fa.width,Fe=Fa.height,Ff=new FM(Fd,Fe,Fb,Fc),Fg=(Fc-Fb)/254,Fh=Fa.getPixels(),Fi=0,Fj=0;Fj<Fe;Fj++)for(var Fm=Ff._datas[Fj]=[],Fn=0;Fn<Fd;Fn++){var Fo=Fh[Fi++],Fp=Fh[Fi++],Fq=Fh[Fi++],Fr=Fh[Fi++];Fm[Fn]=255==Fo&&255==Fp&&255==Fq&&255==Fr?NaN:(Fo+Fp+Fq)/3*Fg+Fb}return Ff},FM._getPosition=function(Fa,Fb,Fc){for(var Fd=Number.MAX_VALUE,Fe=0;Fe<Fb.length;Fe++)for(var Ff=Fb[Fe],Fg=Fc[Fe],Fh=0;Fh<Fg.length;Fh+=3){var Fi=Ff[Fg[Fh+0]],Fj=Ff[Fg[Fh+1]],Fm=Ff[Fg[Fh+2]],Fn=Fqb.rayIntersectsTriangle(Fa,Fi,Fj,Fm);!isNaN(Fn)&&Fn<Fd&&(Fd=Fn)}return Fd},Fn(FM,["_tempRay",function(){return this._tempRay=new Feb(new Fgb,new Fgb)}])}(),function(){function Fe(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}Fp(Fe,"laya.d3.core.Layer");var Fa=Fe.prototype;return Fa._binarySearchIndex=function(){for(var Fa=0,Fb=Fe._collsionTestList.length-1,Fc=0;Fa<=Fb;){Fc=Math.floor((Fa+Fb)/2);var Fd=Fe._collsionTestList[Fc];if(Fd==this._number)return Fc;Fd>this._number?Fb=Fc-1:Fa=Fc+1}return Fa},Fa._addCollider=function(Fa){0===this._colliders.length&&Fe._collsionTestList.splice(this._binarySearchIndex(),0,this._number),Fa._isRigidbody?(this._colliders.unshift(Fa),this._nonRigidbodyOffset++):this._colliders.push(Fa)},Fa._removeCollider=function(Fa){var Fb=this._colliders.indexOf(Fa);Fb<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(Fb,1),0===this._colliders.length&&Fe._collsionTestList.splice(Fe._collsionTestList.indexOf(this._number),1)},Fq(0,Fa,"number",function(){return this._number}),Fq(0,Fa,"visible",function(){return this._visible},function(Fa){this._visible=Fa,Fe._visibleLayers=Fa?Fe._visibleLayers|this.mask:Fe._visibleLayers&~this.mask}),Fq(0,Fa,"mask",function(){return this._mask}),Fq(1,Fe,"visibleLayers",function(){return Fe._visibleLayers},function(Fa){Fe._visibleLayers=Fa;for(var Fb=0,Fc=Fe._layerList.length;Fb<Fc;Fb++){var Fd=Fe._layerList[Fb];Fd._visible=0!=(Fd._mask&Fe._visibleLayers)}}),Fe.__init__=function(){Fe._layerList.length=31;for(var Fa=0;Fa<31;Fa++){var Fb=new Fe;Fe._layerList[Fa]=Fb,0===Fa?(Fb.name="Default Layer",Fb.visible=!0):(Fb.name="Layer-"+Fa,Fb.visible=!1),Fb._number=Fa,Fb._mask=Math.pow(2,Fa)}Fe.currentCreationLayer=Fe._layerList[0]},Fe.getLayerByNumber=function(Fa){if(Fa<0||30<Fa)throw new Error("无法返回指定Layer，该number超出范围！");return Fe._layerList[Fa]},Fe.getLayerByName=function(Fa){for(var Fb=0;Fb<31;Fb++)if(Fe._layerList[Fb].name===Fa)return Fe._layerList[Fb];throw new Error("无法返回指定Layer,该name不存在")},Fe.isVisible=function(Fa){return 0!=(Fa&Fe._currentCameraCullingMask&Fe._visibleLayers)},Fe._layerList=[],Fe._visibleLayers=2147483647,Fe._collsionTestList=[],Fe._currentCameraCullingMask=2147483647,Fe.maxCount=31,Fe.currentCreationLayer=null,Fe}()),FJ=(function(){function Fa(Fa,Fb,Fc){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=Fa,this._minCount=Fb,this._maxCount=Fc}Fp(Fa,"laya.d3.core.particleShuriKen.module.Burst");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.cloneTo=function(Fa){var Fb=Fa;Fb._time=this._time,Fb._minCount=this._minCount,Fb._maxCount=this._maxCount},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"time",function(){return this._time}),Fq(0,Fb,"minCount",function(){return this._minCount}),Fq(0,Fb,"maxCount",function(){return this._maxCount})}(),function(){function Fa(Fa){this._color=null,this.enbale=!1,this._color=Fa}Fp(Fa,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var Fb=Fa.prototype;Fb.cloneTo=function(Fa){var Fb=Fa;this._color.cloneTo(Fb._color),Fb.enbale=this.enbale},Fb.clone=function(){var Fa;switch(this._color.type){case 0:Fa=FL.createByConstant(this._color.constant.clone());break;case 1:Fa=FL.createByGradient(this._color.gradient.clone());break;case 2:Fa=FL.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:Fa=FL.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var Fb=new this.constructor(Fa);return Fb.enbale=this.enbale,Fb},Fq(0,Fb,"color",function(){return this._color})}(),function(){function Fa(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}Fp(Fa,"laya.d3.core.particleShuriKen.module.Emission");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),Fb._destroy=function(){this._bursts=null,this._destroyed=!0},Fb.getBurstsCount=function(){return this._bursts.length},Fb.getBurstByIndex=function(Fa){return this._bursts[Fa]},Fb.addBurst=function(Fa){var Fb=this._bursts.length;if(0<Fb)for(var Fc=0;Fc<Fb;Fc++)this._bursts[Fc].time>Fa.time&&this._bursts.splice(Fc,0,Fa);this._bursts.push(Fa)},Fb.removeBurst=function(Fa){var Fb=this._bursts.indexOf(Fa);-1!==Fb&&this._bursts.splice(Fb,1)},Fb.removeBurstByIndex=function(Fa){this._bursts.splice(Fa,1)},Fb.clearBurst=function(){this._bursts.length=0},Fb.cloneTo=function(Fa){var Fb=Fa,Fc=Fb._bursts;Fc.length=this._bursts.length;for(var Fd=0,Fe=this._bursts.length;Fd<Fe;Fd++){var Ff=Fc[Fd];Ff?this._bursts[Fd].cloneTo(Ff):Fc[Fd]=this._bursts[Fd].clone()}Fb._emissionRate=this._emissionRate,Fb.enbale=this.enbale},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"destroyed",function(){return this._destroyed}),Fq(0,Fb,"emissionRate",function(){return this._emissionRate},function(Fa){if(Fa<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=Fa})}(),function(){function Fd(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}Fp(Fd,"laya.d3.core.particleShuriKen.module.FrameOverTime");var Fa=Fd.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.cloneTo=function(Fa){var Fb=Fa;Fb._type=this._type,Fb._constant=this._constant,this._overTime.cloneTo(Fb._overTime),Fb._constantMin=this._constantMin,Fb._constantMax=this._constantMax,this._overTimeMin.cloneTo(Fb._overTimeMin),this._overTimeMax.cloneTo(Fb._overTimeMax)},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fa,"frameOverTimeData",function(){return this._overTime}),Fq(0,Fa,"constant",function(){return this._constant}),Fq(0,Fa,"type",function(){return this._type}),Fq(0,Fa,"frameOverTimeDataMin",function(){return this._overTimeMin}),Fq(0,Fa,"constantMin",function(){return this._constantMin}),Fq(0,Fa,"frameOverTimeDataMax",function(){return this._overTimeMax}),Fq(0,Fa,"constantMax",function(){return this._constantMax}),Fd.createByConstant=function(Fa){var Fb=new Fd;return Fb._type=0,Fb._constant=Fa,Fb},Fd.createByOverTime=function(Fa){var Fb=new Fd;return Fb._type=1,Fb._overTime=Fa,Fb},Fd.createByRandomTwoConstant=function(Fa,Fb){var Fc=new Fd;return Fc._type=2,Fc._constantMin=Fa,Fc._constantMax=Fb,Fc},Fd.createByRandomTwoOverTime=function(Fa,Fb){var Fc=new Fd;return Fc._type=3,Fc._overTimeMin=Fa,Fc._overTimeMax=Fb,Fc},Fd}()),FK=function(){function Fj(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}Fp(Fj,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var Fa=Fj.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.cloneTo=function(Fa){var Fb=Fa;Fb._type=this._type,Fb._separateAxes=this._separateAxes,Fb._constant=this._constant,this._constantSeparate.cloneTo(Fb._constantSeparate),this._gradient.cloneTo(Fb._gradient),this._gradientX.cloneTo(Fb._gradientX),this._gradientY.cloneTo(Fb._gradientY),this._gradientZ.cloneTo(Fb._gradientZ),Fb._constantMin=this._constantMin,Fb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Fb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Fb._constantMaxSeparate),this._gradientMin.cloneTo(Fb._gradientMin),this._gradientMax.cloneTo(Fb._gradientMax),this._gradientXMin.cloneTo(Fb._gradientXMin),this._gradientXMax.cloneTo(Fb._gradientXMax),this._gradientYMin.cloneTo(Fb._gradientYMin),this._gradientYMax.cloneTo(Fb._gradientYMax),this._gradientZMin.cloneTo(Fb._gradientZMin),this._gradientZMax.cloneTo(Fb._gradientZMax)},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fa,"gradientZ",function(){return this._gradientZ}),Fq(0,Fa,"constant",function(){return this._constant}),Fq(0,Fa,"gradient",function(){return this._gradient}),Fq(0,Fa,"separateAxes",function(){return this._separateAxes}),Fq(0,Fa,"type",function(){return this._type}),Fq(0,Fa,"constantSeparate",function(){return this._constantSeparate}),Fq(0,Fa,"gradientX",function(){return this._gradientX}),Fq(0,Fa,"gradientY",function(){return this._gradientY}),Fq(0,Fa,"gradientW",function(){return this._gradientW}),Fq(0,Fa,"gradientMin",function(){return this._gradientMin}),Fq(0,Fa,"constantMin",function(){return this._constantMin}),Fq(0,Fa,"gradientMax",function(){return this._gradientMax}),Fq(0,Fa,"constantMax",function(){return this._constantMax}),Fq(0,Fa,"gradientWMin",function(){return this._gradientWMin}),Fq(0,Fa,"constantMinSeparate",function(){return this._constantMinSeparate}),Fq(0,Fa,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Fq(0,Fa,"gradientXMin",function(){return this._gradientXMin}),Fq(0,Fa,"gradientXMax",function(){return this._gradientXMax}),Fq(0,Fa,"gradientWMax",function(){return this._gradientWMax}),Fq(0,Fa,"gradientYMin",function(){return this._gradientYMin}),Fq(0,Fa,"gradientYMax",function(){return this._gradientYMax}),Fq(0,Fa,"gradientZMin",function(){return this._gradientZMin}),Fq(0,Fa,"gradientZMax",function(){return this._gradientZMax}),Fj.createByConstant=function(Fa){var Fb=new Fj;return Fb._type=0,Fb._separateAxes=!1,Fb._constant=Fa,Fb},Fj.createByConstantSeparate=function(Fa){var Fb=new Fj;return Fb._type=0,Fb._separateAxes=!0,Fb._constantSeparate=Fa,Fb},Fj.createByGradient=function(Fa){var Fb=new Fj;return Fb._type=1,Fb._separateAxes=!1,Fb._gradient=Fa,Fb},Fj.createByGradientSeparate=function(Fa,Fb,Fc,Fd){var Fe=new Fj;return Fe._type=1,Fe._separateAxes=!0,Fe._gradientX=Fa,Fe._gradientY=Fb,Fe._gradientZ=Fc,Fe._gradientW=Fd,Fe},Fj.createByRandomTwoConstant=function(Fa,Fb){var Fc=new Fj;return Fc._type=2,Fc._separateAxes=!1,Fc._constantMin=Fa,Fc._constantMax=Fb,Fc},Fj.createByRandomTwoConstantSeparate=function(Fa,Fb){var Fc=new Fj;return Fc._type=2,Fc._separateAxes=!0,Fc._constantMinSeparate=Fa,Fc._constantMaxSeparate=Fb,Fc},Fj.createByRandomTwoGradient=function(Fa,Fb){var Fc=new Fj;return Fc._type=3,Fc._separateAxes=!1,Fc._gradientMin=Fa,Fc._gradientMax=Fb,Fc},Fj.createByRandomTwoGradientSeparate=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){var Fi=new Fj;return Fi._type=3,Fi._separateAxes=!0,Fi._gradientXMin=Fa,Fi._gradientXMax=Fb,Fi._gradientYMin=Fc,Fi._gradientYMax=Fd,Fi._gradientZMin=Fe,Fi._gradientZMax=Ff,Fi._gradientWMin=Fg,Fi._gradientWMax=Fh,Fi},Fj}(),FL=function(){function Fd(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}Fp(Fd,"laya.d3.core.particleShuriKen.module.GradientColor");var Fa=Fd.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.cloneTo=function(Fa){var Fb=Fa;Fb._type=this._type,this._constant.cloneTo(Fb._constant),this._constantMin.cloneTo(Fb._constantMin),this._constantMax.cloneTo(Fb._constantMax),this._gradient.cloneTo(Fb._gradient),this._gradientMin.cloneTo(Fb._gradientMin),this._gradientMax.cloneTo(Fb._gradientMax)},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fa,"gradient",function(){return this._gradient}),Fq(0,Fa,"constant",function(){return this._constant}),Fq(0,Fa,"type",function(){return this._type}),Fq(0,Fa,"gradientMin",function(){return this._gradientMin}),Fq(0,Fa,"constantMin",function(){return this._constantMin}),Fq(0,Fa,"gradientMax",function(){return this._gradientMax}),Fq(0,Fa,"constantMax",function(){return this._constantMax}),Fd.createByConstant=function(Fa){var Fb=new Fd;return Fb._type=0,Fb._constant=Fa,Fb},Fd.createByGradient=function(Fa){var Fb=new Fd;return Fb._type=1,Fb._gradient=Fa,Fb},Fd.createByRandomTwoConstant=function(Fa,Fb){var Fc=new Fd;return Fc._type=2,Fc._constantMin=Fa,Fc._constantMax=Fb,Fc},Fd.createByRandomTwoGradient=function(Fa,Fb){var Fc=new Fd;return Fc._type=3,Fc._gradientMin=Fa,Fc._gradientMax=Fb,Fc},Fd}(),FM=(function(){function Fa(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}Fp(Fa,"laya.d3.core.particleShuriKen.module.GradientDataColor");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.addAlpha=function(Fa,Fb){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==Fa&&(Fa=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=Fa,this._alphaElements[this._alphaCurrentLength++]=Fb):DEBUG},Fb.addRGB=function(Fa,Fb){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==Fa&&(Fa=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=Fa,this._rgbElements[this._rgbCurrentLength++]=Fb.x,this._rgbElements[this._rgbCurrentLength++]=Fb.y,this._rgbElements[this._rgbCurrentLength++]=Fb.z):DEBUG},Fb.cloneTo=function(Fa){var Fb=Fa,Fc=0,Fd=0;Fb._alphaCurrentLength=this._alphaCurrentLength;var Fe=Fb._alphaElements;for(Fe.length=this._alphaElements.length,Fc=0,Fd=this._alphaElements.length;Fc<Fd;Fc++)Fe[Fc]=this._alphaElements[Fc];Fb._rgbCurrentLength=this._rgbCurrentLength;var Ff=Fb._rgbElements;for(Ff.length=this._rgbElements.length,Fc=0,Fd=this._rgbElements.length;Fc<Fd;Fc++)Ff[Fc]=this._rgbElements[Fc]},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),Fq(0,Fb,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function Fa(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Fp(Fa,"laya.d3.core.particleShuriKen.module.GradientDataInt");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.add=function(Fa,Fb){this._currentLength<8?(6===this._currentLength&&1!==Fa&&(Fa=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Fa,this._elements[this._currentLength++]=Fb):console.log("Warning:data count must lessEqual than 4")},Fb.cloneTo=function(Fa){var Fb=Fa;Fb._currentLength=this._currentLength;var Fc=Fb._elements;Fc.length=this._elements.length;for(var Fd=0,Fe=this._elements.length;Fd<Fe;Fd++)Fc[Fd]=this._elements[Fd]},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Fa(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Fp(Fa,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.add=function(Fa,Fb){this._currentLength<8?(6===this._currentLength&&1!==Fa&&(Fa=1,DEBUG),this._elements[this._currentLength++]=Fa,this._elements[this._currentLength++]=Fb):DEBUG},Fb.getKeyByIndex=function(Fa){return this._elements[2*Fa]},Fb.getValueByIndex=function(Fa){return this._elements[2*Fa+1]},Fb.getAverageValue=function(){for(var Fa=0,Fb=this._currentLength-2;Fa<Fb;Fa+=2){this._elements[Fa+1];this._elements[Fa+3],this._elements[Fa+2]-this._elements[Fa]}return 0},Fb.cloneTo=function(Fa){var Fb=Fa;Fb._currentLength=this._currentLength;var Fc=Fb._elements;Fc.length=this._elements.length;for(var Fd=0,Fe=this._elements.length;Fd<Fe;Fd++)Fc[Fd]=this._elements[Fd]},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Fa(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}Fp(Fa,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.add=function(Fa,Fb){this._currentLength<8?(6===this._currentLength&&1!==Fa&&(Fa=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Fa,this._elements[this._currentLength++]=Fb.x,this._elements[this._currentLength++]=Fb.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},Fb.cloneTo=function(Fa){var Fb=Fa;Fb._currentLength=this._currentLength;var Fc=Fb._elements;Fc.length=this._elements.length;for(var Fd=0,Fe=this._elements.length;Fd<Fe;Fd++)Fc[Fd]=this._elements[Fd]},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"gradientCount",function(){return this._currentLength/3})}(),function(){function Fh(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Fp(Fh,"laya.d3.core.particleShuriKen.module.GradientSize");var Fa=Fh.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.getMaxSizeInGradient=function(){var Fa=0,Fb=0,Fc=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(Fa=0,Fb=this._gradientX.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientX.getValueByIndex(Fa));for(Fa=0,Fb=this._gradientY.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientY.getValueByIndex(Fa))}else for(Fa=0,Fb=this._gradient.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradient.getValueByIndex(Fa));break;case 1:Fc=this._separateAxes?(Fc=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),Fc=Math.max(Fc,this._constantMinSeparate.y),Math.max(Fc,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(Fa=0,Fb=this._gradientXMin.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientXMin.getValueByIndex(Fa));for(Fa=0,Fb=this._gradientXMax.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientXMax.getValueByIndex(Fa));for(Fa=0,Fb=this._gradientYMin.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientYMin.getValueByIndex(Fa));for(Fa=0,Fb=this._gradientZMax.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientZMax.getValueByIndex(Fa))}else{for(Fa=0,Fb=this._gradientMin.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientMin.getValueByIndex(Fa));for(Fa=0,Fb=this._gradientMax.gradientCount;Fa<Fb;Fa++)Fc=Math.max(Fc,this._gradientMax.getValueByIndex(Fa))}}return Fc},Fa.cloneTo=function(Fa){var Fb=Fa;Fb._type=this._type,Fb._separateAxes=this._separateAxes,this._gradient.cloneTo(Fb._gradient),this._gradientX.cloneTo(Fb._gradientX),this._gradientY.cloneTo(Fb._gradientY),this._gradientZ.cloneTo(Fb._gradientZ),Fb._constantMin=this._constantMin,Fb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Fb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Fb._constantMaxSeparate),this._gradientMin.cloneTo(Fb._gradientMin),this._gradientMax.cloneTo(Fb._gradientMax),this._gradientXMin.cloneTo(Fb._gradientXMin),this._gradientXMax.cloneTo(Fb._gradientXMax),this._gradientYMin.cloneTo(Fb._gradientYMin),this._gradientYMax.cloneTo(Fb._gradientYMax),this._gradientZMin.cloneTo(Fb._gradientZMin),this._gradientZMax.cloneTo(Fb._gradientZMax)},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fa,"gradientZ",function(){return this._gradientZ}),Fq(0,Fa,"gradient",function(){return this._gradient}),Fq(0,Fa,"separateAxes",function(){return this._separateAxes}),Fq(0,Fa,"type",function(){return this._type}),Fq(0,Fa,"gradientMin",function(){return this._gradientMin}),Fq(0,Fa,"constantMin",function(){return this._constantMin}),Fq(0,Fa,"gradientX",function(){return this._gradientX}),Fq(0,Fa,"gradientY",function(){return this._gradientY}),Fq(0,Fa,"gradientMax",function(){return this._gradientMax}),Fq(0,Fa,"constantMax",function(){return this._constantMax}),Fq(0,Fa,"constantMinSeparate",function(){return this._constantMinSeparate}),Fq(0,Fa,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Fq(0,Fa,"gradientXMin",function(){return this._gradientXMin}),Fq(0,Fa,"gradientXMax",function(){return this._gradientXMax}),Fq(0,Fa,"gradientYMin",function(){return this._gradientYMin}),Fq(0,Fa,"gradientYMax",function(){return this._gradientYMax}),Fq(0,Fa,"gradientZMin",function(){return this._gradientZMin}),Fq(0,Fa,"gradientZMax",function(){return this._gradientZMax}),Fh.createByGradient=function(Fa){var Fb=new Fh;return Fb._type=0,Fb._separateAxes=!1,Fb._gradient=Fa,Fb},Fh.createByGradientSeparate=function(Fa,Fb,Fc){var Fd=new Fh;return Fd._type=0,Fd._separateAxes=!0,Fd._gradientX=Fa,Fd._gradientY=Fb,Fd._gradientZ=Fc,Fd},Fh.createByRandomTwoConstant=function(Fa,Fb){var Fc=new Fh;return Fc._type=1,Fc._separateAxes=!1,Fc._constantMin=Fa,Fc._constantMax=Fb,Fc},Fh.createByRandomTwoConstantSeparate=function(Fa,Fb){var Fc=new Fh;return Fc._type=1,Fc._separateAxes=!0,Fc._constantMinSeparate=Fa,Fc._constantMaxSeparate=Fb,Fc},Fh.createByRandomTwoGradient=function(Fa,Fb){var Fc=new Fh;return Fc._type=2,Fc._separateAxes=!1,Fc._gradientMin=Fa,Fc._gradientMax=Fb,Fc},Fh.createByRandomTwoGradientSeparate=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=new Fh;return Fg._type=2,Fg._separateAxes=!0,Fg._gradientXMin=Fa,Fg._gradientXMax=Fb,Fg._gradientYMin=Fc,Fg._gradientYMax=Fd,Fg._gradientZMin=Fe,Fg._gradientZMax=Ff,Fg},Fh}()),FN=function(){function Fh(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Fp(Fh,"laya.d3.core.particleShuriKen.module.GradientVelocity");var Fa=Fh.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.cloneTo=function(Fa){var Fb=Fa;Fb._type=this._type,this._constant.cloneTo(Fb._constant),this._gradientX.cloneTo(Fb._gradientX),this._gradientY.cloneTo(Fb._gradientY),this._gradientZ.cloneTo(Fb._gradientZ),this._constantMin.cloneTo(Fb._constantMin),this._constantMax.cloneTo(Fb._constantMax),this._gradientXMin.cloneTo(Fb._gradientXMin),this._gradientXMax.cloneTo(Fb._gradientXMax),this._gradientYMin.cloneTo(Fb._gradientYMin),this._gradientYMax.cloneTo(Fb._gradientYMax),this._gradientZMin.cloneTo(Fb._gradientZMin),this._gradientZMax.cloneTo(Fb._gradientZMax)},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fa,"gradientZ",function(){return this._gradientZ}),Fq(0,Fa,"constant",function(){return this._constant}),Fq(0,Fa,"type",function(){return this._type}),Fq(0,Fa,"gradientXMax",function(){return this._gradientXMax}),Fq(0,Fa,"constantMin",function(){return this._constantMin}),Fq(0,Fa,"gradientX",function(){return this._gradientX}),Fq(0,Fa,"gradientY",function(){return this._gradientY}),Fq(0,Fa,"gradientXMin",function(){return this._gradientXMin}),Fq(0,Fa,"constantMax",function(){return this._constantMax}),Fq(0,Fa,"gradientYMin",function(){return this._gradientYMin}),Fq(0,Fa,"gradientYMax",function(){return this._gradientYMax}),Fq(0,Fa,"gradientZMin",function(){return this._gradientZMin}),Fq(0,Fa,"gradientZMax",function(){return this._gradientZMax}),Fh.createByConstant=function(Fa){var Fb=new Fh;return Fb._type=0,Fb._constant=Fa,Fb},Fh.createByGradient=function(Fa,Fb,Fc){var Fd=new Fh;return Fd._type=1,Fd._gradientX=Fa,Fd._gradientY=Fb,Fd._gradientZ=Fc,Fd},Fh.createByRandomTwoConstant=function(Fa,Fb){var Fc=new Fh;return Fc._type=2,Fc._constantMin=Fa,Fc._constantMax=Fb,Fc},Fh.createByRandomTwoGradient=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=new Fh;return Fg._type=3,Fg._gradientXMin=Fa,Fg._gradientXMax=Fb,Fg._gradientYMin=Fc,Fg._gradientYMax=Fd,Fg._gradientZMin=Fe,Fg._gradientZMax=Ff,Fg},Fh}(),FO=(function(){function Fa(Fa){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=Fa}Fp(Fa,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.cloneTo=function(Fa){var Fb=Fa;this._angularVelocity.cloneTo(Fb._angularVelocity),Fb.enbale=this.enbale},Fb.clone=function(){var Fa;switch(this._angularVelocity.type){case 0:Fa=this._angularVelocity.separateAxes?FK.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):FK.createByConstant(this._angularVelocity.constant);break;case 1:Fa=this._angularVelocity.separateAxes?FK.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):FK.createByGradient(this._angularVelocity.gradient.clone());break;case 2:Fa=this._angularVelocity.separateAxes?FK.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):FK.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:Fa=this._angularVelocity.separateAxes?FK.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):FK.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var Fb=new this.constructor(Fa);return Fb.enbale=this.enbale,Fb},Fq(0,Fb,"angularVelocity",function(){return this._angularVelocity})}(),function(){function Fa(){this.enable=!1,this.randomDirection=!1}Fp(Fa,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb._getShapeBoundBox=function(Fa){throw new Error("BaseShape: must override it.")},Fb._getSpeedBoundBox=function(Fa){throw new Error("BaseShape: must override it.")},Fb.generatePositionAndDirection=function(Fa,Fb,Fc,Fd){throw new Error("BaseShape: must override it.")},Fb._calculateProceduralBounds=function(Fa,Fb,Fc){this._getShapeBoundBox(Fa);var Fd=Fa.min,Fe=Fa.max;Fgb.multiply(Fd,Fb,Fd),Fgb.multiply(Fe,Fb,Fe);var Ff=new FZa(new Fgb,new Fgb);this.randomDirection?(Ff.min=new Fgb(-1,-1,-1),Ff.max=new Fgb(1,1,1)):this._getSpeedBoundBox(Ff);var Fg=new FZa(new Fgb,new Fgb),Fh=Fg.min,Fi=Fg.max;Fgb.scale(Ff.min,Fc.y,Fh),Fgb.scale(Ff.max,Fc.y,Fi),Fgb.add(Fa.min,Fh,Fh),Fgb.add(Fa.max,Fi,Fi),Fgb.min(Fa.min,Fh,Fa.min),Fgb.max(Fa.max,Fh,Fa.max);var Fj=new FZa(new Fgb,new Fgb),Fm=Fj.min,Fn=Fj.max;Fgb.scale(Ff.min,Fc.x,Fm),Fgb.scale(Ff.max,Fc.x,Fn),Fgb.min(Fj.min,Fn,Fh),Fgb.max(Fj.min,Fn,Fi),Fgb.min(Fa.min,Fh,Fa.min),Fgb.max(Fa.max,Fh,Fa.max)},Fb.cloneTo=function(Fa){Fa.enable=this.enable},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fa}()),FT=function(){function Ff(){}return Fp(Ff,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),Ff._randomPointUnitArcCircle=function(Fa,Fb,Fc){var Fd=Fb.elements,Fe=NaN;Fe=Fc?Fc.getFloat()*Fa:Math.random()*Fa,Fd[0]=Math.cos(Fe),Fd[1]=Math.sin(Fe)},Ff._randomPointInsideUnitArcCircle=function(Fa,Fb,Fc){var Fd=Fb.elements;Ff._randomPointUnitArcCircle(Fa,Fb,Fc);var Fe=NaN;Fe=Fc?Math.pow(Fc.getFloat(),.5):Math.pow(Math.random(),.5),Fd[0]=Fd[0]*Fe,Fd[1]=Fd[1]*Fe},Ff._randomPointUnitCircle=function(Fa,Fb){var Fc=Fa.elements,Fd=NaN;Fd=Fb?Fb.getFloat()*Math.PI*2:Math.random()*Math.PI*2,Fc[0]=Math.cos(Fd),Fc[1]=Math.sin(Fd)},Ff._randomPointInsideUnitCircle=function(Fa,Fb){var Fc=Fa.elements;Ff._randomPointUnitCircle(Fa);var Fd=NaN;Fd=Fb?Math.pow(Fb.getFloat(),.5):Math.pow(Math.random(),.5),Fc[0]=Fc[0]*Fd,Fc[1]=Fc[1]*Fd},Ff._randomPointUnitSphere=function(Fa,Fb){var Fc=Fa.elements,Fd=NaN,Fe=NaN;Fe=Fb?(Fd=Fc[2]=2*Fb.getFloat()-1,Fb.getFloat()*Math.PI*2):(Fd=Fc[2]=2*Math.random()-1,Math.random()*Math.PI*2);var Ff=Math.sqrt(1-Fd*Fd);Fc[0]=Ff*Math.cos(Fe),Fc[1]=Ff*Math.sin(Fe)},Ff._randomPointInsideUnitSphere=function(Fa,Fb){var Fc=Fa.elements;Ff._randomPointUnitSphere(Fa);var Fd=NaN;Fd=Fb?Math.pow(Fb.getFloat(),1/3):Math.pow(Math.random(),1/3),Fc[0]=Fc[0]*Fd,Fc[1]=Fc[1]*Fd,Fc[2]=Fc[2]*Fd},Ff._randomPointInsideHalfUnitBox=function(Fa,Fb){var Fc=Fa.elements;Fb?(Fc[0]=Fb.getFloat()-.5,Fc[1]=Fb.getFloat()-.5,Fc[2]=Fb.getFloat()-.5):(Fc[0]=Math.random()-.5,Fc[1]=Math.random()-.5,Fc[2]=Math.random()-.5)},Ff}(),FU=(function(){function Fa(Fa){this._size=null,this.enbale=!1,this._size=Fa}Fp(Fa,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.cloneTo=function(Fa){var Fb=Fa;this._size.cloneTo(Fb._size),Fb.enbale=this.enbale},Fb.clone=function(){var Fa;switch(this._size.type){case 0:Fa=this._size.separateAxes?FM.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):FM.createByGradient(this._size.gradient.clone());break;case 1:Fa=this._size.separateAxes?FM.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):FM.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:Fa=this._size.separateAxes?FM.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):FM.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var Fb=new this.constructor(Fa);return Fb.enbale=this.enbale,Fb},Fq(0,Fb,"size",function(){return this._size})}(),function(){function Fd(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}Fp(Fd,"laya.d3.core.particleShuriKen.module.StartFrame");var Fa=Fd.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.cloneTo=function(Fa){var Fb=Fa;Fb._type=this._type,Fb._constant=this._constant,Fb._constantMin=this._constantMin,Fb._constantMax=this._constantMax},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fa,"constant",function(){return this._constant}),Fq(0,Fa,"type",function(){return this._type}),Fq(0,Fa,"constantMin",function(){return this._constantMin}),Fq(0,Fa,"constantMax",function(){return this._constantMax}),Fd.createByConstant=function(Fa){var Fb=new Fd;return Fb._type=0,Fb._constant=Fa,Fb},Fd.createByRandomTwoConstant=function(Fa,Fb){var Fc=new Fd;return Fc._type=1,Fc._constantMin=Fa,Fc._constantMax=Fb,Fc},Fd}()),FV=(function(){function Fa(Fa,Fb){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new Ffb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=Fa,this._startFrame=Fb}Fp(Fa,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.cloneTo=function(Fa){var Fb=Fa;this.tiles.cloneTo(Fb.tiles),Fb.type=this.type,Fb.randomRow=this.randomRow,this._frame.cloneTo(Fb._frame),this._startFrame.cloneTo(Fb._startFrame),Fb.cycles=this.cycles,Fb.enableUVChannels=this.enableUVChannels,Fb.enable=this.enable},Fb.clone=function(){var Fa,Fb;switch(this._frame.type){case 0:Fa=FJ.createByConstant(this._frame.constant);break;case 1:Fa=FJ.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:Fa=FJ.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:Fa=FJ.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:Fb=FU.createByConstant(this._startFrame.constant);break;case 1:Fb=FU.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var Fc=new this.constructor(Fa,Fb);return this.tiles.cloneTo(Fc.tiles),Fc.type=this.type,Fc.randomRow=this.randomRow,Fc.cycles=this.cycles,Fc.enableUVChannels=this.enableUVChannels,Fc.enable=this.enable,Fc},Fq(0,Fb,"frame",function(){return this._frame}),Fq(0,Fb,"startFrame",function(){return this._startFrame})}(),function(){function Fa(Fa){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=Fa}Fp(Fa,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.cloneTo=function(Fa){var Fb=Fa;this._velocity.cloneTo(Fb._velocity),Fb.enbale=this.enbale,Fb.space=this.space},Fb.clone=function(){var Fa;switch(this._velocity.type){case 0:Fa=FN.createByConstant(this._velocity.constant.clone());break;case 1:Fa=FN.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:Fa=FN.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:Fa=FN.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var Fb=new this.constructor(Fa);return Fb.enbale=this.enbale,Fb.space=this.space,Fb},Fq(0,Fb,"velocity",function(){return this._velocity})}(),function(){function Fa(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new Fob,this._vb=FOb.create(Fa._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=FNb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=FLb.nameKey.getID("LINE"),this._shaderCompile=FAb._preCompileShader[this._sharderNameID]}Fp(Fa,"laya.d3.core.PhasorSpriter3D");var Fb=Fa.prototype;return Fb.line=function(Fa,Fb,Fc,Fd){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Fa.x,Fa.y,Fa.z,Fb.x,Fb.y,Fb.z,Fb.w),this.addVertex(Fc.x,Fc.y,Fc.z,Fd.x,Fd.y,Fd.z,Fd.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},Fb.circle=function(Fa,Fb,Fc,Fd,Fe,Ff){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*Fb,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/Fb,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*Fa,Math.cos(this._tempNumver0)*Fa,0,Fc,Fd,Fe,Ff),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},Fb.plane=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=Fd/2,this._tempNumver1=Fe/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Fa-this._tempNumver0,Fb+this._tempNumver1,Fc,Ff,Fg,Fh,Fi),this.addVertex(Fa+this._tempNumver0,Fb+this._tempNumver1,Fc,Ff,Fg,Fh,Fi),this.addVertex(Fa-this._tempNumver0,Fb-this._tempNumver1,Fc,Ff,Fg,Fh,Fi),this.addVertex(Fa+this._tempNumver0,Fb-this._tempNumver1,Fc,Ff,Fg,Fh,Fi),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},Fb.box=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=Fd/2,this._tempNumver1=Fe/2,this._tempNumver2=Ff/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Fa-this._tempNumver0,Fb+this._tempNumver1,Fc+this._tempNumver2,Fg,Fh,Fi,Fj),this.addVertex(Fa+this._tempNumver0,Fb+this._tempNumver1,Fc+this._tempNumver2,Fg,Fh,Fi,Fj),this.addVertex(Fa-this._tempNumver0,Fb-this._tempNumver1,Fc+this._tempNumver2,Fg,Fh,Fi,Fj),this.addVertex(Fa+this._tempNumver0,Fb-this._tempNumver1,Fc+this._tempNumver2,Fg,Fh,Fi,Fj),this.addVertex(Fa+this._tempNumver0,Fb+this._tempNumver1,Fc-this._tempNumver2,Fg,Fh,Fi,Fj),this.addVertex(Fa-this._tempNumver0,Fb+this._tempNumver1,Fc-this._tempNumver2,Fg,Fh,Fi,Fj),this.addVertex(Fa+this._tempNumver0,Fb-this._tempNumver1,Fc-this._tempNumver2,Fg,Fh,Fi,Fj),this.addVertex(Fa-this._tempNumver0,Fb-this._tempNumver1,Fc-this._tempNumver2,Fg,Fh,Fi,Fj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},Fb.cone=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*Fc+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*Fc>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/Fc,this.addVertexIndex(0,Fb,0,Fd,Fe,Ff,Fg,this._tempUint0),this.addVertexIndex(0,0,0,Fd,Fe,Ff,Fg,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<Fc;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(Fa*this._tempNumver2,0,Fa*this._tempNumver3,Fd,Fe,Ff,Fg,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==Fc-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(Fa*this._tempNumver2,0,Fa*this._tempNumver3,Fd,Fe,Ff,Fg,this._tempUint0+(this._tempInt0+Fc)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==Fc-1?this.addIndexes(this._tempUint1+Fc+2):this.addIndexes(this._tempUint1+this._tempInt0+Fc+1),this.addIndexes(this._tempUint1+this._tempInt0+Fc),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},Fb.boundingBoxLine=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Fa,Fe,Ff,Fg,Fh,Fi,Fj),this.addVertex(Fd,Fe,Ff,Fg,Fh,Fi,Fj),this.addVertex(Fa,Fb,Ff,Fg,Fh,Fi,Fj),this.addVertex(Fd,Fb,Ff,Fg,Fh,Fi,Fj),this.addVertex(Fd,Fe,Fc,Fg,Fh,Fi,Fj),this.addVertex(Fa,Fe,Fc,Fg,Fh,Fi,Fj),this.addVertex(Fd,Fb,Fc,Fg,Fh,Fi,Fj),this.addVertex(Fa,Fb,Fc,Fg,Fh,Fi,Fj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},Fb.addVertex=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=Fa,this._vbData[this._posInVBData+1]=Fb,this._vbData[this._posInVBData+2]=Fc,this._vbData[this._posInVBData+3]=Fd,this._vbData[this._posInVBData+4]=Fe,this._vbData[this._posInVBData+5]=Ff,this._vbData[this._posInVBData+6]=Fg,this._posInVBData+=this._floatSizePerVer,this},Fb.addVertexIndex=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){return this._hasBegun||this.addVertexIndexException(),this._vbData[Fh]=Fa,this._vbData[Fh+1]=Fb,this._vbData[Fh+2]=Fc,this._vbData[Fh+3]=Fd,this._vbData[Fh+4]=Fe,this._vbData[Fh+5]=Ff,this._vbData[Fh+6]=Fg,(Fh+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=Fh),this},Fb.addIndexes=function(Fa){var Fb=arguments;this._hasBegun||this.addVertexIndexException();for(var Fc=0;Fc<Fb.length;Fc++)this._ibData[this._posInIBData]=Fb[Fc],this._posInIBData++;return this},Fb.begin=function(Fa,Fb){return this._hasBegun&&this.beginException0(),1!==Fa&&4!==Fa&&this.beginException1(),this._primitiveType=Fa,this._camera=Fb,this._hasBegun=!0,this},Fb.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},Fb.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(Fa._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),FA.drawCall++,FF.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},Fb.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},Fb.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},Fb.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},Fb.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},Fb.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},Fb.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(28,[new Fga(0,"vector3",0),new Fga(12,"vector4",1)])}]),Fa}()),FW=function(){function Fa(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++Fa._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new Fob}Fp(Fa,"laya.d3.core.render.RenderElement");var Fb=Fa.prototype;return Fb.getDynamicBatchBakedVertexs=function(Fa){for(var Fb=this._renderObj._getVertexBuffer(Fa),Fc=Fb.getData().slice(),Fd=Fb.vertexDeclaration,Fe=Fd.getVertexElementByUsage(0).offset/4,Ff=Fd.getVertexElementByUsage(3).offset/4,Fg=this._sprite3D.transform,Fh=Fg.worldMatrix,Fi=Fg.rotation,Fj=Fd.vertexStride/4,Fm=0,Fn=Fc.length;Fm<Fn;Fm+=Fj){var Fo=Fm+Fe,Fp=Fm+Ff;Fsb.transformVector3ArrayToVector3ArrayCoordinate(Fc,Fo,Fh,Fc,Fo),Fsb.transformVector3ArrayByQuat(Fc,Fp,Fi,Fc,Fp)}return Fc},Fb.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},Fb._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},Fq(0,Fb,"id",function(){return this._id}),Fq(0,Fb,"renderObj",function(){return this._renderObj},function(Fa){this._renderObj!==Fa&&(this._renderObj=Fa)}),Fa._uniqueIDCounter=0,Fa}(),FX=function(){function Fb(Fa){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++Fb._uniqueIDCounter,this._needSort=!1,this._scene=Fa,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}Fp(Fb,"laya.d3.core.render.RenderQueue");var Fa=Fb.prototype;return Fa._sortOpaqueFunc=function(Fa,Fb){if(Fa._render&&Fb._render){var Fc=Fa._material.renderQueue-Fb._material.renderQueue;return 0==Fc?Fa._render._distanceForSort-Fb._render._distanceForSort:Fc}return 0},Fa._sortAlphaFunc=function(Fa,Fb){if(Fa._render&&Fb._render){var Fc=Fa._material.renderQueue-Fb._material.renderQueue;return 0==Fc?Fb._render._distanceForSort-Fa._render._distanceForSort:Fc}return 0},Fa._begainRenderElement=function(Fa,Fb,Fc){return!!Fb._beforeRender(Fa)},Fa._sortAlpha=function(Fa){Fb._cameraPosition=Fa,this._finalElements.sort(this._sortAlphaFunc)},Fa._sortOpaque=function(Fa){Fb._cameraPosition=Fa,this._finalElements.sort(this._sortOpaqueFunc)},Fa._preRender=function(Fa){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},Fa._render=function(Fa,Fb){for(var Fc,Fd,Fe,Ff,Fg,Fh,Fi=FA.loopCount,Fj=this._scene,Fm=Fa.camera,Fn=(Fm.id,!1),Fo=0,Fp=this._finalElements.length;Fo<Fp;Fo++){var Fq,Fr,Fs,Ft=this._finalElements[Fo];if(null!=Ft._onPreRenderFunction&&Ft._onPreRenderFunction.call(Ft._sprite3D,Fa),0===Ft._type){if(Fa.owner=Fs=Ft._sprite3D,Fa.renderElement=Ft,Fs._preRenderUpdateComponents(Fa),Fq=Ft.renderObj,Fr=Ft._material,this._begainRenderElement(Fa,Fq,Fr)){if(Fc=Fq._getVertexBuffers(),!(Fe=(Fd=Fq._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[Fd.id]){this._errorRecord[Fd.id]=1;var Fu="vertexBuffer:"+("("+Fd._destroyed+","+Fd._released+","+Fd._referenceCount+","+Fd._buffer+")")+", material:"+(Fr?Fr.__className+"("+Fr._destroyed+","+Fr._released+")":"null")+", owner:"+(Fs?Fs.__className+"("+Fs._destroyed+","+Fs._activeInHierarchy+","+Fs._displayedInStage+")":"null")+", renderObj:"+(Fq?Fq.__className+"("+Fq._destroyed+","+Fq._released+","+Fq._referenceCount+")":"")+", parent:, url:"+(Fs?Fs.url:"")+", disposeStack:"+Fd.disposeStack;Fx.recordError("报错：unknown vertexDeclaration  "+Fu)}continue}if(Fn=(Ff=Fa._shader=Fr._getShader(Fj._shaderDefineValue,Fe.shaderDefineValue,Fs._shaderDefineValue)).bind()||Fi!==Ff._uploadLoopCount,Fc){if(Ff._uploadVertexBuffer!==Fc||Fn){for(var Fv=0;Fv<Fc.length;Fv++){var Fw=Fc[Fv];Ff.uploadAttributesX(Fw.vertexDeclaration.shaderValues.data,Fw)}Ff._uploadVertexBuffer=Fc}}else(Ff._uploadVertexBuffer!==Fd||Fn)&&(Ff.uploadAttributes(Fe.shaderValues.data,null),Ff._uploadVertexBuffer=Fd);(Ff._uploadScene!==Fj||Fn)&&(Ff.uploadSceneUniforms(Fj._shaderValues.data),Ff._uploadScene=Fj),(Fm!==Ff._uploadCamera||Ff._uploadSprite3D!==Fs||Fn)&&(Ff.uploadSpriteUniforms(Fs._shaderValues.data),Ff._uploadSprite3D=Fs),(Fm!==Ff._uploadCamera||Fn)&&(Ff.uploadCameraUniforms(Fm._shaderValues.data),Ff._uploadCamera=Fm),(Ff._uploadMaterial!==Fr||Fn)&&(Fr._upload(),Ff._uploadMaterial=Fr),Fg!==Fr?(Fr._setRenderStateBlendDepth(),Fr._setRenderStateFrontFace(Fb,Fs.transform),Fg=Fr,Fh=Fs):Fh!==Fs&&(Fr._setRenderStateFrontFace(Fb,Fs.transform),Fh=Fs),Fq._render(Fa),Ff._uploadLoopCount=Fi}Fs._postRenderUpdateComponents(Fa)}else if(2===Ft._type){Ft.renderObj;Fa.owner=Fs=Ft._sprite3D,Fa.renderElement=Ft,Fa._batchIndexStart=Ft._tempBatchIndexStart,Fa._batchIndexEnd=Ft._tempBatchIndexEnd,Fq=Ft.renderObj,Fr=Ft._material,this._begainRenderElement(Fa,Fq,Fr)&&(Fe=(Fd=Fq._getVertexBuffer(0)).vertexDeclaration,Fn=(Ff=Fa._shader=Fr._getShader(Fj._shaderDefineValue,Fe.shaderDefineValue,Fs._shaderDefineValue)).bind()||Fi!==Ff._uploadLoopCount,(Ff._uploadVertexBuffer!==Fd||Fn)&&(Ff.uploadAttributes(Fe.shaderValues.data,null),Ff._uploadVertexBuffer=Fd),(Ff._uploadScene!==Fj||Fn)&&(Ff.uploadSceneUniforms(Fj._shaderValues.data),Ff._uploadScene=Fj),(Fm!==Ff._uploadCamera||Ff._uploadSprite3D!==Fs||Fn)&&(Ff.uploadSpriteUniforms(Fs._shaderValues.data),Ff._uploadSprite3D=Fs),(Fm!==Ff._uploadCamera||Fn)&&(Ff.uploadCameraUniforms(Fm._shaderValues.data),Ff._uploadCamera=Fm),(Ff._uploadMaterial!==Fr||Fn)&&(Fr._upload(),Ff._uploadMaterial=Fr),Fg!==Fr?(Fr._setRenderStateBlendDepth(),Fr._setRenderStateFrontFace(Fb,Fs.transform),Fg=Fr,Fh=Fs):Fh!==Fs&&(Fr._setRenderStateFrontFace(Fb,Fs.transform),Fh=Fs),Fq._render(Fa),Ff._uploadLoopCount=Fi)}}},Fa._renderShadow=function(Fa,Fb){for(var Fc,Fd,Fe,Ff,Fg,Fh=FA.loopCount,Fi=this._scene,Fj=Fa.camera,Fm=!1,Fn=0,Fo=this._finalElements.length;Fn<Fo;Fn++){var Fp,Fq,Fr,Fs=this._finalElements[Fn];0===Fs._type&&(Fa.owner=Fr=Fs._sprite3D,Fb||Fr._projectionViewWorldUpdateCamera===Fj&&Fr._projectionViewWorldUpdateLoopCount===FA.loopCount||(Fr._render._renderUpdate(Fa._projectionViewMatrix),Fr._projectionViewWorldUpdateLoopCount=FA.loopCount,Fr._projectionViewWorldUpdateCamera=Fj),Fa.renderElement=Fs,Fr._preRenderUpdateComponents(Fa),Fp=Fs.renderObj,Fq=Fs._material,this._begainRenderElement(Fa,Fp,null)&&(Fd=(Fc=Fp._getVertexBuffer(0)).vertexDeclaration,Fm=(Fe=Fa._shader=Fq._getShader(Fi._shaderDefineValue,Fd.shaderDefineValue,Fr._shaderDefineValue)).bind()||Fh!==Fe._uploadLoopCount,(Fe._uploadVertexBuffer!==Fc||Fm)&&(Fe.uploadAttributes(Fd.shaderValues.data,null),Fe._uploadVertexBuffer=Fc),(Fj!==Fe._uploadCamera||Fe._uploadSprite3D!==Fr||Fm)&&(Fe.uploadSpriteUniforms(Fr._shaderValues.data),Fe._uploadSprite3D=Fr),(Fj!==Fe._uploadCamera||Fm)&&(Fe.uploadCameraUniforms(Fj._shaderValues.data),Fe._uploadCamera=Fj),(Fe._uploadMaterial!==Fq||Fm)&&(Fq._upload(),Fe._uploadMaterial=Fq),Fe._uploadRenderElement,Ff!==Fq?(Fq._setRenderStateFrontFace(!1,Fr.transform),Ff=Fq,Fg=Fr):Fg!==Fr&&(Fq._setRenderStateFrontFace(!1,Fr.transform),Fg=Fr),Fp._render(Fa),Fe._uploadLoopCount=Fh),Fr._postRenderUpdateComponents(Fa))}},Fa._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},Fa._addRenderElement=function(Fa){this._renderElements.push(Fa),this._needSort=!0},Fa._addDynamicBatchElement=function(Fa){this._dynamicBatchCombineRenderElements.push(Fa)},Fq(0,Fa,"id",function(){return this._id}),Fb._uniqueIDCounter=0,Fb._cameraPosition=null,Fb}(),FY=function(){function Fa(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return Fp(Fa,"laya.d3.core.render.RenderState"),Fa.clientWidth=0,Fa.clientHeight=0,Fa}(),FZ=function(){function Fg(Fa,Fb){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new F_a(new Fgb,0),this._corners=[new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb],this._boundingBoxCenter=new Fgb,this._children=Fd(8),this._objects=[],this._tempBoundBoxCorners=[new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb],this._scene=Fa,this._currentDepth=Fb}Fp(Fg,"laya.d3.core.scene.OctreeNode");var Fa=Fg.prototype;return Fx.imps(Fa,{"laya.d3.core.scene.ITreeNode":!0}),Fa.init=function(Fa,Fb){var Fc=new Fgb,Fd=new Fgb;Fgb.scale(Fb,-.5,Fc),Fgb.scale(Fb,.5,Fd),Fgb.add(Fc,Fa,Fc),Fgb.add(Fd,Fa,Fd),this.exactBox=new FZa(Fc,Fd),this.relaxBox=new FZa(Fc,Fd)},Fa.addTreeNode=function(Fa){1===Collision.boxContainsBox(this._relaxBox,Fa.boundingBox)?this.addNodeDown(Fa,0):this.addObject(Fa)},Fa.addChild=function(Fa){var Fb=this._children[Fa];if(null==Fb){Fb=new Fg(this._scene,this._currentDepth+1),(this._children[Fa]=Fb)._parent=this,Fgb.subtract(this._exactBox.max,this._exactBox.min,Fg.tempSize),Fgb.multiply(Fg.tempSize,Fg._octreeSplit[Fa],Fg.tempCenter),Fgb.add(this._exactBox.min,Fg.tempCenter,Fg.tempCenter),Fgb.scale(Fg.tempSize,.25,Fg.tempSize);var Fc=new Fgb,Fd=new Fgb;Fgb.subtract(Fg.tempCenter,Fg.tempSize,Fc),Fgb.add(Fg.tempCenter,Fg.tempSize,Fd),Fb.exactBox=new FZa(Fc,Fd),Fgb.scale(Fg.tempSize,Fg.relax,Fg.tempSize);var Fe=new Fgb,Ff=new Fgb;Fgb.subtract(Fg.tempCenter,Fg.tempSize,Fe),Fgb.add(Fg.tempCenter,Fg.tempSize,Ff),Fb.relaxBox=new FZa(Fe,Ff)}return Fb},Fa.addObject=function(Fa){(Fa._treeNode=this)._objects.push(Fa)},Fa.removeObject=function(Fa){if(Fa._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var Fb=this._objects.indexOf(Fa);return-1!==Fb&&(this._objects.splice(Fb,1),!0)},Fa.clearObject=function(){this._objects.length=0},Fa.addNodeUp=function(Fa,Fb){this._parent&&1!==Collision.boxContainsBox(this._exactBox,Fa.boundingBox)?this._parent.addNodeUp(Fa,Fb-1):this.addNodeDown(Fa,Fb)},Fa.addNodeDown=function(Fa,Fb){if(Fb<this._scene.treeLevel){var Fc=this.inChildIndex(Fa.boundingBoxCenter),Fd=this.addChild(Fc);1===Collision.boxContainsBox(Fd._relaxBox,Fa.boundingBox)?Fd.addNodeDown(Fa,++Fb):this.addObject(Fa)}else this.addObject(Fa)},Fa.inChildIndex=function(Fa){return 4*(Fa.z<this._boundingBoxCenter.z?0:1)+2*(Fa.y<this._boundingBoxCenter.y?0:1)+(Fa.x<this._boundingBoxCenter.x?0:1)},Fa.updateObject=function(Fa){1===Collision.boxContainsBox(this._relaxBox,Fa.boundingBox)?(this.removeObject(Fa),Fa._treeNode=null,this.addNodeDown(Fa,this._currentDepth)):this._parent&&(this.removeObject(Fa),Fa._treeNode=null,this._parent.addNodeUp(Fa,this._currentDepth-1))},Fa.cullingObjects=function(Fa,Fb,Fc,Fd,Fe){var Ff,Fg=0,Fh=0,Fi=0,Fj=this._scene._dynamicBatchManager;for(Fg=0,Ff=this._objects.length;Fg<Ff;Fg++){var Fm=this._objects[Fg];if(FI.isVisible(Fm._owner.layer.mask)&&Fm.enable){if(Fb&&(FA.treeSpriteCollision+=1,0===Fa.containsBoundSphere(Fm.boundingSphere)))continue;Fm._renderUpdate(Fe),Fm._distanceForSort=Fgb.distance(Fm.boundingSphere.center,Fd)+Fm.sortingFudge;var Fn=Fm._renderElements;for(Fh=0,Fi=Fn.length;Fh<Fi;Fh++){var Fo=Fn[Fh],Fp=Fo._staticBatch;if(Fp&&Fp._material===Fo._material)Fp._addBatchRenderElement(Fo);else{var Fq=Fo.renderObj;Fq.triangleCount<10&&1===Fq._vertexBufferCount&&Fq._getIndexBuffer()&&Fo._material.renderQueue<2&&Fo._canDynamicBatch&&!Fm._owner.isStatic?Fj._addPrepareRenderElement(Fo):this._scene.getRenderQueue(Fo._material.renderQueue)._addRenderElement(Fo)}}}}for(Fg=0;Fg<8;Fg++){var Fr=this._children[Fg];if(null!=Fr){var Fs=Fb;if(Fb){var Ft=Fa.containsBoundBox(Fr._relaxBox);if(FA.treeNodeCollision+=1,0===Ft)continue;Fs=2===Ft}Fr.cullingObjects(Fa,Fs,Fc,Fd,Fe)}}},Fa.cullingShadowObjects=function(Fa,Fb,Fc,Fd,Fe){var Ff,Fg=0,Fh=0,Fi=0;this._scene._dynamicBatchManager;for(Fg=0,Ff=this._objects.length;Fg<Ff;Fg++){var Fj=this._objects[Fg];if(Fj.castShadow&&FI.isVisible(Fj._owner.layer.mask)&&Fj.enable){if(Fc&&0===Fa[0].containsBoundSphere(Fj.boundingSphere))continue;for(var Fm=1,Fn=Fa.length;Fm<Fn;Fm++){var Fo=Fb[Fm-1];if(0!==Fa[Fm].containsBoundSphere(Fj.boundingSphere)){var Fp=Fj._renderElements;for(Fh=0,Fi=Fp.length;Fh<Fi;Fh++)Fo._addRenderElement(Fp[Fh])}}}}for(Fg=0;Fg<8;Fg++){var Fq=this._children[Fg];if(null!=Fq){var Fr=Fc;if(Fc){var Fs=Fa[0].containsBoundBox(Fq._relaxBox);if(0===Fs)continue;Fr=2===Fs}Fq.cullingShadowObjects(Fa,Fb,Fr,Fd,Fe)}}},Fa.cullingShadowObjectsOnePSSM=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg,Fh=Fb[0],Fi=0,Fj=0,Fm=0;for(Fi=0,Fg=this._objects.length;Fi<Fg;Fi++){var Fn=this._objects[Fi];if(Fn.castShadow&&FI.isVisible(Fn._owner.layer.mask)&&Fn.enable){if(Fd&&0===Fa.containsBoundSphere(Fn.boundingSphere))continue;Fn._renderUpdate(Fc);var Fo=Fn._renderElements;for(Fj=0,Fm=Fo.length;Fj<Fm;Fj++)Fh._addRenderElement(Fo[Fj])}}for(Fi=0;Fi<8;Fi++){var Fp=this._children[Fi];if(null!=Fp){var Fq=Fd;if(Fd){var Fr=Fa.containsBoundBox(Fp._relaxBox);if(0===Fr)continue;Fq=2===Fr}Fp.cullingShadowObjectsOnePSSM(Fa,Fb,Fc,Fq,Fe,Ff)}}},Fa.renderBoudingBox=function(Fa){this._renderBoudingBox(Fa);for(var Fb=0;Fb<8;++Fb){var Fc=this._children[Fb];Fc&&Fc.renderBoudingBox(Fa)}},Fa.buildAllChild=function(Fa){if(Fa<this._scene.treeLevel)for(var Fb=0;Fb<8;Fb++){this.addChild(Fb).buildAllChild(Fa+1)}},Fa._renderBoudingBox=function(Fa){},Fq(0,Fa,"exactBox",function(){return this._exactBox},function(Fa){this._exactBox=Fa,Fgb.add(Fa.min,Fa.max,this._boundingBoxCenter),Fgb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),Fq(0,Fa,"relaxBox",function(){return this._relaxBox},function(Fa){(this._relaxBox=Fa).getCorners(this._corners),F_a.createfromPoints(this._corners,this._boundingSphere)}),Fg.debugMode=!1,Fg.relax=1.15,Fg.CHILDNUM=8,Fn(Fg,["tempVector0",function(){return this.tempVector0=new Fgb},"tempSize",function(){return this.tempSize=new Fgb},"tempCenter",function(){return this.tempCenter=new Fgb},"_octreeSplit",function(){return this._octreeSplit=[new Fgb(.25,.25,.25),new Fgb(.75,.25,.25),new Fgb(.25,.75,.25),new Fgb(.75,.75,.25),new Fgb(.25,.25,.75),new Fgb(.75,.25,.75),new Fgb(.25,.75,.75),new Fgb(.75,.75,.75)]}]),Fg}(),F$=(function(){function Fa(){}Fp(Fa,"laya.d3.core.scene.SceneManager")}(),function(){function Fa(Fa,Fb,Fc,Fd){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===Fa&&(Fa=1),void 0===Fb&&(Fb=1),void 0===Fc&&(Fc=1),void 0===Fd&&(Fd=1),this._r=Fa,this._g=Fb,this._b=Fc,this._a=Fd}return Fp(Fa,"laya.d3.core.trail.module.Color",null,"Color$1"),Fa.prototype.cloneTo=function(Fa){Fa._r=this._r,Fa._g=this._g,Fa._b=this._b,Fa._a=this._a},Fn(Fa,["RED",function(){return this.RED=new Fa(1,0,0,1)},"GREEN",function(){return this.GREEN=new Fa(0,1,0,1)},"BLUE",function(){return this.BLUE=new Fa(0,0,1,1)},"CYAN",function(){return this.CYAN=new Fa(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new Fa(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new Fa(1,0,1,1)},"GRAY",function(){return this.GRAY=new Fa(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new Fa(1,1,1,1)},"BLACK",function(){return this.BLACK=new Fa(0,0,0,1)}]),Fa}()),F_=(function(){function Fa(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}Fp(Fa,"laya.d3.core.trail.module.Gradient");var Fb=Fa.prototype;Fb.setKeys=function(Fa,Fb){var Fc,Fd;this._colorKeys=Fa;for(var Fe=this.index=0;Fe<Fa.length;Fe++){var Ff=(Fc=Fa[Fe]).color;this._colorKeyData[this.index++]=Ff._r,this._colorKeyData[this.index++]=Ff._g,this._colorKeyData[this.index++]=Ff._b,this._colorKeyData[this.index++]=Fc.time}this._alphaKeys=Fb;for(var Fg=this.index=0;Fg<Fb.length;Fg++)Fd=Fb[Fg],this._alphaKeyData[this.index++]=Fd.alpha,this._alphaKeyData[this.index++]=Fd.time},Fb.cloneTo=function(Fa){var Fb=0,Fc=0,Fd=this.colorKeys,Fe=[];for(Fb=0,Fc=Fd.length;Fb<Fc;Fb++){var Ff=new Fk;Fd[Fb].cloneTo(Ff),Fe.push(Ff)}var Fg=this.alphaKeys,Fh=[];for(Fb=0,Fc=Fg.length;Fb<Fc;Fb++){var Fi=new F_;Fg[Fb].cloneTo(Fi),Fh.push(Fi)}Fa.setKeys(Fe,Fh)},Fq(0,Fb,"mode",function(){return this._mode},function(Fa){this._mode=Fa}),Fq(0,Fb,"colorKeys",function(){return this._colorKeys},function(Fa){this._colorKeys=Fa;for(var Fb=this.index=0;Fb<Fa.length;Fb++){var Fc=Fa[Fb],Fd=Fc.color;this._colorKeyData[this.index++]=Fd._r,this._colorKeyData[this.index++]=Fd._g,this._colorKeyData[this.index++]=Fd._b,this._colorKeyData[this.index++]=Fc.time}}),Fq(0,Fb,"alphaKeys",function(){return this._alphaKeys},function(Fa){this._alphaKeys=Fa;for(var Fb=this.index=0;Fb<Fa.length;Fb++){var Fc=Fa[Fb];this._alphaKeyData[this.index++]=Fc.alpha,this._alphaKeyData[this.index++]=Fc.time}})}(),function(){function Fa(Fa,Fb){this._alpha=NaN,this._time=NaN,void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),this._alpha=Fa,this._time=Fb}Fp(Fa,"laya.d3.core.trail.module.GradientAlphaKey");var Fb=Fa.prototype;return Fb.cloneTo=function(Fa){Fa.alpha=this.alpha,Fa.time=this.time},Fq(0,Fb,"alpha",function(){return this._alpha},function(Fa){this._alpha=Fa}),Fq(0,Fb,"time",function(){return this._time},function(Fa){this._time=Fa}),Fa}()),Fk=function(){function Fa(Fa,Fb){this._color=null,this._time=NaN,void 0===Fb&&(Fb=0),this._color=Fa||new F$,this._time=Fb}Fp(Fa,"laya.d3.core.trail.module.GradientColorKey");var Fb=Fa.prototype;return Fb.cloneTo=function(Fa){this.color.cloneTo(Fa.color),Fa.time=this.time},Fq(0,Fb,"color",function(){return this._color},function(Fa){this._color=Fa}),Fq(0,Fb,"time",function(){return this._time},function(Fa){this._time=Fa}),Fa}(),Fl=(function(){function Fa(){}Fp(Fa,"laya.d3.core.trail.module.GradientMode"),Fa.Blend=0,Fa.Fixed=1}(),function(){function Fa(){}Fp(Fa,"laya.d3.core.trail.module.TextureMode"),Fa.Stretch=0,Fa.Tile=1}(),function(){function Fa(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}Fp(Fa,"laya.d3.core.trail.module.TrailKeyFrame"),Fa.prototype.cloneTo=function(Fa){Fa.time=this.time,Fa.inTangent=this.inTangent,Fa.outTangent=this.outTangent,Fa.value=this.value}}(),function(){function Fb(Fa){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new Fgb,this._curPosition=new Fgb,this._delVector3=new Fgb,this._lastFixedVertexPosition=new Fgb,this._pointAtoBVector3=new Fgb,this._pointA=new Fgb,this._pointB=new Fgb,this._owner=Fa,this._id=Fb.renderElementCount++,0==this._id?Fa._owner.transform.position.cloneTo(this._lastPosition):Fa._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new FOb(Fl.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new FOb(Fl.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}Fp(Fb,"laya.d3.core.trail.TrailRenderElement");var Fa=Fb.prototype;Fx.imps(Fa,{"laya.d3.core.render.IRenderable":!0}),Fa._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},Fa._addTrailByFirstPosition=function(Fa,Fb){Fgb.subtract(Fb,Fa,this._delVector3),Fgb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Fgb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Fgb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(Fa),Fa.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},Fa._addTrailByNextPosition=function(Fa){Fgb.subtract(Fa,this._lastFixedVertexPosition,this._delVector3),Fgb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Fgb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Fgb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=Fgb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=Fka.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(Fa),Fa.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(Fa),this._virtualVerticesCount=2)},Fa._updateVerticesByPosition=function(Fa){this._pointe=Fa.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},Fa._updateVertexBuffer2=function(){var Fa,Fb=0,Fc=0,Fd=0;for(Fd=0,Fa=(this._verticesCount+this._virtualVerticesCount)/2;Fd<Fa;Fd++)Fc=0==this._owner.textureMode?(this._VerticesToTailLength[Fd]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[Fd],this._vertices2[Fb++]=1-Fc,this._vertices2[Fb++]=1-Fc;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},Fa._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},Fa._updateDisappear=function(){var Fa,Fb=0;for(Fb=this._curDisappearIndex,Fa=(this._verticesCount+this._virtualVerticesCount)/2;Fb<Fa;Fb++)this._owner._curtime-this._everyGroupVertexBirthTime[Fb]>=this._owner.time+Fka.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},Fa._beforeRender=function(Fa){return this._camera=Fa.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),Fgb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},Fa._render=function(Fa){this._isDead||(FF.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),FA.drawCall++,FA.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},Fa._getVertexBuffer=function(Fa){return void 0===Fa&&(Fa=0),0===Fa?this._vertexBuffer1:1===Fa?this._vertexBuffer2:null},Fa._getVertexBuffers=function(){return this._vertexBuffers},Fa._getIndexBuffer=function(){return null},Fa.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},Fa._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},Fq(0,Fa,"_vertexBufferCount",function(){return this._vertexBuffers.length}),Fq(0,Fa,"triangleCount",function(){return 0}),Fb.renderElementCount=0}(),function(){function Fa(){}Fp(Fa,"laya.d3.core.trail.VertexTrail");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration1}),Fq(1,Fa,"vertexDeclaration1",function(){return Fa._vertexDeclaration1}),Fq(1,Fa,"vertexDeclaration2",function(){return Fa._vertexDeclaration2}),Fn(Fa,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new Ffa(32,[new Fga(0,"vector3",0),new Fga(12,"vector3",41),new Fga(24,"single",33),new Fga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new Ffa(4,[new Fga(0,"single",38)])}]),Fa}()),Faa=function(){function Fw(Fa){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=Fa}Fp(Fw,"laya.d3.graphics.DynamicBatch");var Fa=Fw.prototype;return Fx.imps(Fa,{"laya.d3.core.render.IRenderable":!0}),Fa._getVertexBuffer=function(Fa){return void 0===Fa&&(Fa=0),0===Fa?this._vertexBuffer:null},Fa._getIndexBuffer=function(){return this._indexBuffer},Fa._getCombineRenderElementFromPool=function(Fa,Fb,Fc){var Fd=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return Fd||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=Fd=new FW,Fd._sprite3D=new FXb),Fd._sprite3D._render._renderUpdate(Fc),Fd},Fa._getRenderElement=function(Fa,Fb,Fc){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*Fw.maxVertexCount),this._indexDatas=new Uint16Array(Fw.maxIndexCount),this._vertexBuffer=FOb.create(this._vertexDeclaration,Fw.maxVertexCount,35048),this._indexBuffer=FNb.create("ushort",Fw.maxIndexCount,35048));for(var Fd=this._merageElements.length=0,Fe=0,Ff=0,Fg=this._combineRenderElements.length;Ff<Fg;Ff++){var Fh=this._combineRenderElements[Ff],Fi=Fh.getDynamicBatchBakedVertexs(0),Fj=Fh.getBakedIndices(),Fm=Fh._sprite3D.transform._isFrontFaceInvert,Fn=Fd/(this._vertexDeclaration.vertexStride/4),Fo=Fe,Fp=Fo+Fj.length;Fh._tempBatchIndexStart=Fo,Fh._tempBatchIndexEnd=Fp,this._indexDatas.set(Fj,Fe);var Fq=0;if(Fm)for(Fq=Fo;Fq<Fp;Fq+=3){this._indexDatas[Fq]=Fn+this._indexDatas[Fq];var Fr=this._indexDatas[Fq+1],Fs=this._indexDatas[Fq+2];this._indexDatas[Fq+1]=Fn+Fs,this._indexDatas[Fq+2]=Fn+Fr}else for(Fq=Fo;Fq<Fp;Fq+=3)this._indexDatas[Fq]=Fn+this._indexDatas[Fq],this._indexDatas[Fq+1]=Fn+this._indexDatas[Fq+1],this._indexDatas[Fq+2]=Fn+this._indexDatas[Fq+2];Fe+=Fj.length,this._vertexDatas.set(Fi,Fd),Fd+=Fi.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),Ff=this._combineRenderElementPoolIndex=0,Fg=this._materials.length;Ff<Fg;Ff++){var Ft=this._getCombineRenderElementFromPool(Fa,Fb,Fc);Ft._type=2,Ft._staticBatch=null;var Fu=(Ft.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[Ff]]._tempBatchIndexStart,Fv=Ff+1===this._materialToRenderElementsOffsets.length?Fe:this._combineRenderElements[this._materialToRenderElementsOffsets[Ff+1]]._tempBatchIndexStart;Ft._tempBatchIndexStart=Fu,Ft._tempBatchIndexEnd=Fv,Ft._material=this._materials[Ff],this._merageElements.push(Ft)}},Fa._addCombineRenderObjTest=function(Fa){var Fb=Fa.renderObj,Fc=this._currentCombineIndexCount+Fb._getIndexBuffer().indexCount,Fd=this._currentCombineVertexCount+Fb._getVertexBuffer().vertexCount;return!(Fw.maxVertexCount<Fd||Fw.maxIndexCount<Fc)},Fa._addCombineRenderObj=function(Fa){var Fb=Fa.renderObj;this._combineRenderElements.push(Fa),this._currentCombineIndexCount=this._currentCombineIndexCount+Fb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Fb._getVertexBuffer().vertexCount},Fa._addCombineMaterial=function(Fa){this._materials.push(Fa)},Fa._addMaterialToRenderElementOffset=function(Fa){this._materialToRenderElementsOffsets.push(Fa)},Fa._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},Fa._addToRenderQueue=function(Fa,Fb,Fc,Fd){this._getRenderElement(Fb,Fc,Fd);for(var Fe=0,Ff=this._materials.length;Fe<Ff;Fe++)Fa.getRenderQueue(this._materials[Fe].renderQueue)._addDynamicBatchElement(this._merageElements[Fe])},Fa._beforeRender=function(Fa){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Fa._render=function(Fa){var Fb=Fa._batchIndexEnd-Fa._batchIndexStart;FF.mainContext.drawElements(4,Fb,5123,2*Fa._batchIndexStart),FA.drawCall++,FA.trianglesFaces+=Fb/3},Fa._getVertexBuffers=function(){return null},Fq(0,Fa,"_vertexBufferCount",function(){return 1}),Fq(0,Fa,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Fq(0,Fa,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),Fw.maxVertexCount=2e4,Fw.maxIndexCount=4e4,Fw.maxCombineTriangleCount=10,Fw}(),Fba=function(){function Fw(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}Fp(Fw,"laya.d3.graphics.DynamicBatchManager");var Fa=Fw.prototype;return Fa.getDynamicBatch=function(Fa,Fb){var Fc,Fd=Fa.id.toString()+Fb;return this._dynamicBatches[Fd]?Fc=this._dynamicBatches[Fd]:this._dynamicBatches[Fd]=Fc=new Faa(Fa),Fc},Fa._garbageCollection=function(){for(var Fa in this._dynamicBatches)0===this._dynamicBatches[Fa].combineRenderElementsCount&&delete this._dynamicBatches[Fa]},Fa._addPrepareRenderElement=function(Fa){this._prepareDynamicBatchCombineElements.push(Fa)},Fa._finishCombineDynamicBatch=function(Fa){var Fb,Fc,Fd;this._prepareDynamicBatchCombineElements.sort(Fw._sortPrepareDynamicBatch);for(var Fe,Ff,Fg,Fh,Fi,Fj=-1,Fm=!0,Fn=0,Fo=-1,Fp=0,Fq=this._prepareDynamicBatchCombineElements.length;Fp<Fq;Fp++){var Fr=(Ff=this._prepareDynamicBatchCombineElements[Fp]).renderObj._getVertexBuffer(0).vertexDeclaration,Fs=Fc!==Fr;Fs&&(Fn=0,Fc=Fr);var Ft=Fn!==Fj;if(Ft&&(Fj=Fn),(Fs||Ft)&&(Fg=this.getDynamicBatch(Fr,Fn),Fb=null),Fm)if(Fg._addCombineRenderObjTest(Ff)){if(Fb!==(Fe=Ff._material))Fh&&(Fa.getRenderQueue(Fi._material.renderQueue)._addRenderElement(Fi),Fi=Fh=null,Fo=-1),Fh=Fe,Fo=Fg.combineRenderElementsCount,Fi=Ff,Fb=Fe;else if(Fh){var Fu=Fi.renderObj,Fv=Ff.renderObj;Fu._getVertexBuffer().vertexCount+Fv._getVertexBuffer().vertexCount>Faa.maxVertexCount||Fu._getIndexBuffer().indexCount+Fv._getIndexBuffer().indexCount>Faa.maxIndexCount?(Fa.getRenderQueue(Fi._material.renderQueue)._addRenderElement(Fi),Fh=Fe,Fo=Fg.combineRenderElementsCount,Fi=Ff):(Fg._addCombineMaterial(Fh),Fg._addMaterialToRenderElementOffset(Fo),Fg._addCombineRenderObj(Fi),Fi=Fh=null,Fo=-1,Fg._addCombineRenderObj(Ff))}else Fg._addCombineRenderObj(Ff);Fm=!0}else Fh&&(Fa.getRenderQueue(Fi._material.renderQueue)._addRenderElement(Fi),Fi=Fh=null,Fo=-1),Fn++,Fm=!1;else Fd=this._prepareDynamicBatchCombineElements[Fp-1],Fg._addMaterialToRenderElementOffset(Fg.combineRenderElementsCount),Fb=Fd._material,Fg._addCombineMaterial(Fb),Fg._addCombineRenderObj(Fd),Fm=!0,Fb!==(Fe=Ff._material)?(Fh=Fe,Fo=Fg.combineRenderElementsCount,Fi=Ff):Fg._addCombineRenderObj(Ff),Fb=Fe}Fh&&(Fa.getRenderQueue(Fi._material.renderQueue)._addRenderElement(Fi),Fi=Fh=null,Fo=-1),this._prepareDynamicBatchCombineElements.length=0},Fa._clearRenderElements=function(){for(var Fa in this._dynamicBatches)this._dynamicBatches[Fa]._clearRenderElements()},Fa._addToRenderQueue=function(Fa,Fb,Fc,Fd){for(var Fe in this._dynamicBatches){var Ff=this._dynamicBatches[Fe];0<Ff.combineRenderElementsCount&&Ff._addToRenderQueue(Fa,Fb,Fc,Fd)}},Fa.dispose=function(){this._dynamicBatches=null},Fw._sortPrepareDynamicBatch=function(Fa,Fb){return Fa._mainSortID-Fb._mainSortID},Fw}(),Fca=function(){function Fa(){}return Fp(Fa,"laya.d3.graphics.FrustumCulling"),Fa.renderShadowObjectCulling=function(Fa,Fb,Fc,Fd,Fe){var Ff=0,Fg=0,Fh=0,Fi=0;for(Ff=0,Fh=Fc.length;Ff<Fh;Ff++){var Fj=Fc[Ff];Fj&&Fj._clearRenderElements()}var Fm,Fn,Fo,Fp=Fa._cullingRenders;if(1<Fe){for(Ff=0,Fh=Fa._cullingRendersLength;Ff<Fh;Ff++)if((Fm=Fp[Ff]).castShadow&&FI.isVisible(Fm._owner.layer.mask)&&Fm.enable)for(var Fq=1,Fr=Fb.length;Fq<Fr;Fq++)if(Fn=Fc[Fq-1],0!==Fb[Fq].containsBoundSphere(Fm.boundingSphere))for(Fg=0,Fi=(Fo=Fm._renderElements).length;Fg<Fi;Fg++)Fn._addRenderElement(Fo[Fg])}else for(Ff=0,Fh=Fa._cullingRendersLength;Ff<Fh;Ff++)if((Fm=Fp[Ff]).castShadow&&FI.isVisible(Fm._owner.layer.mask)&&Fm.enable&&0!==Fb[0].containsBoundSphere(Fm.boundingSphere))for(Fm._renderUpdate(Fd),Fn=Fc[0],Fg=0,Fi=(Fo=Fm._renderElements).length;Fg<Fi;Fg++)Fn._addRenderElement(Fo[Fg])},Fa.renderShadowObjectCullingOctree=function(Fa,Fb,Fc,Fd,Fe){for(var Ff=0,Fg=Fc.length;Ff<Fg;Ff++){var Fh=Fc[Ff];Fh&&Fh._clearRenderElements()}1<Fe?Fa.treeRoot.cullingShadowObjects(Fb,Fc,!0,0,Fa):Fa.treeRoot.cullingShadowObjectsOnePSSM(Fb[0],Fc,Fd,!0,0,Fa)},Fa.renderObjectCulling=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=0,Fh=0,Fi=0,Fj=0,Fm=Fb._quenes,Fn=Fb._dynamicBatchManager,Fo=Fb._cullingRenders;for(Fg=0,Fh=Fm.length;Fg<Fh;Fg++){var Fp=Fm[Fg];Fp&&Fp._clearRenderElements()}var Fq=Fda._staticBatchManagers;for(Fg=0,Fh=Fq.length;Fg<Fh;Fg++)Fq[Fg]._clearRenderElements();Fn._clearRenderElements();var Fr=Fc.transform.position;for(Fg=0,Fh=Fb._cullingRendersLength;Fg<Fh;Fg++){var Fs=Fo[Fg];if(FI.isVisible(Fs._owner.layer.mask)&&Fs.enable&&0!==Fa.containsBoundSphere(Fs.boundingSphere)&&Fs._renderUpdate(Ff)){Fs._distanceForSort=Fgb.distance(Fs.boundingSphere.center,Fr)+Fs.sortingFudge;var Ft=Fs._renderElements;for(Fi=0,Fj=Ft.length;Fi<Fj;Fi++){var Fu=Ft[Fi],Fv=Fu._staticBatch;if(Fv&&Fv._material===Fu._material)Fv._addBatchRenderElement(Fu);else{var Fw=Fu.renderObj;Fw.triangleCount<10&&1===Fw._vertexBufferCount&&Fw._getIndexBuffer()&&Fu._material.renderQueue<2&&Fu._canDynamicBatch&&!Fs._owner.isStatic?Fn._addPrepareRenderElement(Fu):Fb.getRenderQueue(Fu._material.renderQueue)._addRenderElement(Fu)}}}}for(Fg=0,Fh=Fq.length;Fg<Fh;Fg++)Fq[Fg]._addToRenderQueue(Fb,Fd,Fe,Ff);Fn._finishCombineDynamicBatch(Fb),Fn._addToRenderQueue(Fb,Fd,Fe,Ff)},Fa.renderObjectCullingOctree=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=0,Fh=0,Fi=Fb._quenes,Fj=Fb._dynamicBatchManager;for(Fg=0,Fh=Fi.length;Fg<Fh;Fg++){var Fm=Fi[Fg];Fm&&Fm._clearRenderElements()}var Fn=Fda._staticBatchManagers;for(Fg=0,Fh=Fn.length;Fg<Fh;Fg++)Fn[Fg]._clearRenderElements();for(Fj._clearRenderElements(),Fb._cullingRenders.length=0,Fb.treeRoot.cullingObjects(Fa,!0,0,Fc.transform.position,Ff),Fg=0,Fh=Fn.length;Fg<Fh;Fg++)Fn[Fg]._addToRenderQueue(Fb,Fd,Fe,Ff);Fj._finishCombineDynamicBatch(Fb),Fj._addToRenderQueue(Fb,Fd,Fe,Ff)},Fa.renderObjectCullingNoBoundFrustum=function(Fa,Fb,Fc,Fd,Fe){var Ff=0,Fg=0,Fh=0,Fi=0,Fj=Fa._quenes,Fm=Fa._dynamicBatchManager,Fn=Fa._cullingRenders;for(Ff=0,Fg=Fj.length;Ff<Fg;Ff++){var Fo=Fj[Ff];Fo&&Fo._clearRenderElements()}var Fp=Fda._staticBatchManagers;for(Ff=0,Fg=Fp.length;Ff<Fg;Ff++)Fp[Ff]._clearRenderElements();Fm._clearRenderElements();var Fq=Fb.transform.position;for(Ff=0,Fg=Fa._cullingRendersLength;Ff<Fg;Ff++){var Fr=Fn[Ff];if(FI.isVisible(Fr._owner.layer.mask)&&Fr.enable){Fr._renderUpdate(Fe),Fr._distanceForSort=Fgb.distance(Fr.boundingSphere.center,Fq)+Fr.sortingFudge;var Fs=Fr._renderElements;for(Fh=0,Fi=Fs.length;Fh<Fi;Fh++){var Ft=Fs[Fh],Fu=Ft._staticBatch;if(Fu&&Fu._material===Ft._material)Fu._addBatchRenderElement(Ft);else{var Fv=Ft.renderObj;Fv.triangleCount<10&&1===Fv._vertexBufferCount&&Fv._getIndexBuffer()&&Ft._material.renderQueue<2&&Ft._canDynamicBatch&&!Fr._owner.isStatic?Fm._addPrepareRenderElement(Ft):Fa.getRenderQueue(Ft._material.renderQueue)._addRenderElement(Ft)}}}}for(Ff=0,Fg=Fp.length;Ff<Fg;Ff++)Fp[Ff]._addToRenderQueue(Fa,Fc,Fd,Fe);Fm._finishCombineDynamicBatch(Fa),Fm._addToRenderQueue(Fa,Fc,Fd,Fe)},Fa}(),Fda=function(){function Ff(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}Fp(Ff,"laya.d3.graphics.StaticBatchManager");var Fa=Ff.prototype;return Fa._finishInit=function(){for(var Fa in this._staticBatches)this._staticBatches[Fa]._finishInit();this._initBatchRenderElements.length=0},Fa._initStaticBatchs=function(Fa){throw new Error("StaticBatchManager:must override this function.")},Fa._addInitBatchSprite=function(Fa){for(var Fb=Fa._render._renderElements,Fc=0,Fd=Fb.length;Fc<Fd;Fc++)this._initBatchRenderElements.push(Fb[Fc])},Fa._clearRenderElements=function(){for(var Fa in this._staticBatches)this._staticBatches[Fa]._clearRenderElements()},Fa._garbageCollection=function(Fa){var Fb=Fa._staticBatch,Fc=Fb._initBatchRenderElements,Fd=Fc.indexOf(Fa);Fc.splice(Fd,1),0===Fc.length&&(Fb.dispose(),delete this._staticBatches[Fb._key])},Fa._addToRenderQueue=function(Fa,Fb,Fc,Fd){for(var Fe in this._staticBatches){var Ff=this._staticBatches[Fe];0<Ff._batchRenderElements.length&&Ff._updateToRenderQueue(Fa,Fd)}},Fa.dispose=function(){this._staticBatches=null},Ff._addToStaticBatchQueue=function(Fa){Fa instanceof laya.d3.core.RenderableSprite3D&&Fa._addToInitStaticBatchManager();for(var Fb=0,Fc=Fa.numChildren;Fb<Fc;Fb++)Ff._addToStaticBatchQueue(Fa._childs[Fb])},Ff.combine=function(Fa,Fb){var Fc,Fd=0,Fe=0;if(Fb)for(Fd=0,Fe=Fb.length;Fd<Fe;Fd++){Fb[Fd]._addToInitStaticBatchManager()}else Fa&&Ff._addToStaticBatchQueue(Fa);for(Fd=0,Fe=Ff._staticBatchManagers.length;Fd<Fe;Fd++)(Fc=Ff._staticBatchManagers[Fd])._initStaticBatchs(Fa),Fc._finishInit()},Ff._staticBatchManagers=[],Ff}(),Fea=function(){function Fa(Fa,Fb,Fc){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=Fa,this._manager=Fb,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=Fc}Fp(Fa,"laya.d3.graphics.StaticBatch");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Fb._binarySearch=function(Fa){for(var Fb=0,Fc=this._batchRenderElements.length-1,Fd=0;Fb<=Fc;)Fd=Math.floor((Fb+Fc)/2),this._compareBatchRenderElement(this._batchRenderElements[Fd],Fa)?Fc=Fd-1:Fb=Fd+1;return Fb},Fb._compareBatchRenderElement=function(Fa,Fb){throw new Error("StaticBatch:must override this function.")},Fb._getVertexDecLightMap=function(Fa){return Fa===FNa.vertexDeclaration?FIa.vertexDeclaration:Fa===FMa.vertexDeclaration?FHa.vertexDeclaration:Fa===FBa.vertexDeclaration?Fwa.vertexDeclaration:Fa===FRa.vertexDeclaration?null:Fa===Fra.vertexDeclaration?Fsa.vertexDeclaration:Fa===FPa.vertexDeclaration?FKa.vertexDeclaration:Fa===FFa.vertexDeclaration?FGa.vertexDeclaration:Fa===FOa.vertexDeclaration?FJa.vertexDeclaration:Fa===FMa.vertexDeclaration?FHa.vertexDeclaration:Fa===FCa.vertexDeclaration?Fxa.vertexDeclaration:Fa===FRa.vertexDeclaration?null:Fa===Fra.vertexDeclaration?Fsa.vertexDeclaration:Fa===FQa.vertexDeclaration?FLa.vertexDeclaration:Fa===FFa.vertexDeclaration?FGa.vertexDeclaration:Fa},Fb._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},Fb._addBatchRenderElement=function(Fa){this._batchRenderElements.splice(this._binarySearch(Fa),0,Fa)},Fb._updateToRenderQueue=function(Fa,Fb){this._combineRenderElementPoolIndex=0,this._getRenderElement(Fa.getRenderQueue(this._material.renderQueue)._renderElements,Fa,Fb)},Fb._getRenderElement=function(Fa,Fb,Fc){throw new Error("StaticBatch:must override this function.")},Fb._finishInit=function(){throw new Error("StaticBatch:must override this function.")},Fb._clearRenderElements=function(){this._batchRenderElements.length=0},Fb.dispose=function(){},Fb._getVertexBuffer=function(Fa){return void 0===Fa&&(Fa=0),null},Fb._getIndexBuffer=function(){return null},Fb._beforeRender=function(Fa){return!0},Fb._render=function(Fa){},Fb._getVertexBuffers=function(){return null},Fq(0,Fb,"_vertexBufferCount",function(){return 1}),Fq(0,Fb,"triangleCount",function(){return 0}),Fa.combine=function(Fa){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),Fda.combine(Fa)},Fa.maxBatchVertexCount=65535,Fa}(),Ffa=function(){function Fg(Fa,Fb){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++Fg._uniqueIDCounter,this._id>Fg.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",Fg.maxVertexDeclaration);this._shaderValues=new Fob,this._vertexElementsDic={},this._vertexStride=Fa,this._vertexElements=Fb;for(var Fc=0;Fc<Fb.length;Fc++){var Fd=Fb[Fc],Fe=Fd.elementUsage;this._vertexElementsDic[Fe]=Fd;var Ff=[Fg._getTypeSize(Fd.elementFormat)/4,5126,!1,this._vertexStride,Fd.offset];switch(this._shaderValues.setValue(Fe,Ff),Fe){case 1:this._addShaderDefine(FAb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(FAb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(FAb.SHADERDEFINE_UV1)}}}Fp(Fg,"laya.d3.graphics.VertexDeclaration");var Fa=Fg.prototype;return Fa._addShaderDefine=function(Fa){this._shaderDefineValue|=Fa},Fa._removeShaderDefine=function(Fa){this._shaderDefineValue&=~Fa},Fa.getVertexElements=function(){return this._vertexElements.slice()},Fa.getVertexElementByUsage=function(Fa){return this._vertexElementsDic[Fa]},Fa.unBinding=function(){},Fq(0,Fa,"shaderDefineValue",function(){return this._shaderDefineValue}),Fq(0,Fa,"id",function(){return this._id}),Fq(0,Fa,"vertexStride",function(){return this._vertexStride}),Fq(0,Fa,"shaderValues",function(){return this._shaderValues}),Fg._getTypeSize=function(Fa){switch(Fa){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},Fg.getVertexStride=function(Fa){for(var Fb=0,Fc=0;Fc<Fa.Length;Fc++){var Fd=Fa[Fc],Fe=Fd.offset+Fg._getTypeSize(Fd.elementFormat);Fb<Fe&&(Fb=Fe)}return Fb},Fg._maxVertexDeclarationBit=1e3,Fg._uniqueIDCounter=1,Fn(Fg,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),Fg}(),Fga=function(){function Fa(Fa,Fb,Fc){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=Fa,this.elementFormat=Fb,this.elementUsage=Fc}return Fp(Fa,"laya.d3.graphics.VertexElement"),Fa}(),Fha=(function(){function Fa(){}Fp(Fa,"laya.d3.graphics.VertexElementFormat"),Fa.Single="single",Fa.Vector2="vector2",Fa.Vector3="vector3",Fa.Vector4="vector4",Fa.Color="color",Fa.Byte4="byte4",Fa.Short2="short2",Fa.Short4="short4",Fa.NormalizedShort2="normalizedshort2",Fa.NormalizedShort4="normalizedshort4",Fa.HalfVector2="halfvector2",Fa.HalfVector4="halfvector4"}(),function(){function Fa(){}Fp(Fa,"laya.d3.graphics.VertexElementUsage"),Fa.POSITION0=0,Fa.COLOR0=1,Fa.TEXTURECOORDINATE0=2,Fa.NORMAL0=3,Fa.BINORMAL0=4,Fa.TANGENT0=5,Fa.BLENDINDICES0=6,Fa.BLENDWEIGHT0=7,Fa.DEPTH0=8,Fa.FOG0=9,Fa.POINTSIZE0=10,Fa.SAMPLE0=11,Fa.TESSELLATEFACTOR0=12,Fa.COLOR1=13,Fa.NEXTTEXTURECOORDINATE0=14,Fa.TEXTURECOORDINATE1=15,Fa.NEXTTEXTURECOORDINATE1=16,Fa.CORNERTEXTURECOORDINATE0=17,Fa.VELOCITY0=18,Fa.STARTCOLOR0=19,Fa.STARTSIZE=20,Fa.AGEADDSCALE0=21,Fa.STARTROTATION=22,Fa.ENDCOLOR0=23,Fa.STARTLIFETIME=24,Fa.TIME0=33,Fa.SHAPEPOSITIONSTARTLIFETIME=30,Fa.DIRECTIONTIME=32,Fa.SIZEROTATION0=27,Fa.RADIUS0=28,Fa.RADIAN0=29,Fa.STARTSPEED=31,Fa.RANDOM0=34,Fa.RANDOM1=35,Fa.SIMULATIONWORLDPOSTION=36,Fa.SIMULATIONWORLDROTATION=37,Fa.TEXTURECOORDINATE0X=38,Fa.TEXTURECOORDINATE0X1=39,Fa.TEXTURECOORDINATE0Y=40,Fa.OFFSETVECTOR=41}(),function(){function Fa(Fa,Fb,Fc){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=Fa,this._textureCoordinate0=Fb,this._time=Fc}Fp(Fa,"laya.d3.graphics.VertexGlitter");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate0}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"time",function(){return this._time}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(24,[new Fga(0,"vector3",0),new Fga(12,"vector2",2),new Fga(20,"single",33)])}])}(),function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=Fa,this._position=Fb,this._velocity=Fc,this._startColor=Fd,this._endColor=Fe,this._sizeRotation=Ff,this._radius=Fg,this._radian=Fh,this._ageAddScale=Fi,this._time=Fj}Fp(Fa,"laya.d3.graphics.VertexParticle");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"endColor",function(){return this._endColor}),Fq(0,Fb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Fq(0,Fb,"sizeRotation",function(){return this._sizeRotation}),Fq(0,Fb,"velocity",function(){return this._velocity}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"startColor",function(){return this._startColor}),Fq(0,Fb,"radius",function(){return this._radius}),Fq(0,Fb,"radian",function(){return this._radian}),Fq(0,Fb,"ageAddScale",function(){return this._ageAddScale}),Fq(0,Fb,"time",function(){return this._time}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(116,[new Fga(0,"vector4",17),new Fga(16,"vector3",0),new Fga(28,"vector3",18),new Fga(40,"vector4",19),new Fga(56,"vector4",23),new Fga(72,"vector3",27),new Fga(84,"vector2",28),new Fga(92,"vector4",29),new Fga(108,"single",24),new Fga(112,"single",33)])}])}(),function(){function Fa(Fa){this._position=null,this._position=Fa}Fp(Fa,"laya.d3.graphics.VertexPosition");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(12,[new Fga(0,"vector3",0)])}]),Fa}()),Fia=function(){function Fa(Fa,Fb){this._position=null,this._normal=null,this._position=Fa,this._normal=Fb}Fp(Fa,"laya.d3.graphics.VertexPositionNormal");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(24,[new Fga(0,"vector3",0),new Fga(12,"vector3",3)])}]),Fa}(),Fja=function(){function Fa(Fa,Fb,Fc){this._position=null,this._normal=null,this._color=null,this._position=Fa,this._normal=Fb,this._color=Fc}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColor");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(40,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1)])}]),Fa}(),Fma=function(){function Fa(Fa,Fb,Fc,Fd,Fe){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._blendIndex=Fd,this._blendWeight=Fe}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorSkin");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(72,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector4",7),new Fga(56,"vector4",6)])}]),Fa}(),Fna=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._tangent=Fd,this._blendIndex=Fe,this._blendWeight=Ff}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(88,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector4",7),new Fga(56,"vector4",6),new Fga(72,"vector4",5)])}]),Fa}(),Foa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._tangent=Fd,this._blendIndex=Fe,this._blendWeight=Ff}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(84,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector4",7),new Fga(56,"vector4",6),new Fga(72,"vector3",5)])}]),Fa}(),Fpa=function(){function Fa(Fa,Fb,Fc,Fd){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._tangent=Fd}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(56,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector4",5)])}]),Fa}(),Fqa=function(){function Fa(Fa,Fb,Fc,Fd){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._tangent=Fd}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(52,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector3",5)])}]),Fa}(),Fra=function(){function Fa(Fa,Fb,Fc,Fd){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate=Fd}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTexture");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(48,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2)])}]),Fa}(),Fsa=function(){function Fa(Fa,Fb,Fc,Fd,Fe){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate0=Fd,this._textureCoordinate1=Fe}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(56,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector2",15)])}]),Fa}(),Fta=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate0=Fd,this._textureCoordinate1=Fe,this._blendIndex=Ff,this._blendWeight=Fg}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(88,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector2",15),new Fga(56,"vector4",7),new Fga(72,"vector4",6)])}]),Fa}(),Fua=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate0=Fd,this._textureCoordinate1=Fe,this._tangent=Ff,this._blendIndex=Fg,this._blendWeight=Fh}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(104,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector2",15),new Fga(56,"vector4",7),new Fga(72,"vector4",6),new Fga(88,"vector4",5)])}]),Fa}(),Fva=function(){function Fa(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fb.VertexPositionNormalColorTexture0SkinTangent=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate0=Fd,this._textureCoordinate1=Fe,this._tangent=Ff,this._blendIndex=Fg,this._blendWeight=Fh},Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(100,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector2",15),new Fga(56,"vector4",7),new Fga(72,"vector4",6),new Fga(88,"vector3",5)])}]),Fa}(),Fwa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate0=Fd,this._textureCoordinate1=Fe,this._tangent=Ff}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(72,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector2",15),new Fga(56,"vector4",5)])}]),Fa}(),Fxa=function(){function Fa(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fb.VertexPositionNormalColorTexture0Tangent=function(Fa,Fb,Fc,Fd,Fe,Ff){this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate0=Fd,this._textureCoordinate1=Fe,this._tangent=Ff},Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(68,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector2",15),new Fga(56,"vector3",5)])}]),Fa}(),Fya=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate=Fd,this._blendIndex=Fe,this._blendWeight=Ff}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(80,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector4",7),new Fga(64,"vector4",6)])}]),Fa}(),Fza=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate=Fd,this._tangent=Fe,this._blendIndex=Ff,this._blendWeight=Fg}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(96,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector4",7),new Fga(64,"vector4",6),new Fga(80,"vector4",5)])}]),Fa}(),FAa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate=Fd,this._tangent=Fe,this._blendIndex=Ff,this._blendWeight=Fg}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(92,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector4",7),new Fga(64,"vector4",6),new Fga(80,"vector3",5)])}]),Fa}(),FBa=function(){function Fa(Fa,Fb,Fc,Fd,Fe){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate=Fd,this._tangent=Fe}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(64,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector4",5)])}]),Fa}(),FCa=function(){function Fa(Fa,Fb,Fc,Fd,Fe){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._color=Fc,this._textureCoordinate=Fd,this._tangent=Fe}Fp(Fa,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"color",function(){return this._color}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(60,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",1),new Fga(40,"vector2",2),new Fga(48,"vector3",5)])}]),Fa}(),FDa=function(){function Fa(Fa,Fb,Fc){this._position=null,this._normal=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._tangent=Fc}Fp(Fa,"laya.d3.graphics.VertexPositionNormalSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(40,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector4",5)])}]),Fa}(),FEa=function(){function Fa(Fa,Fb,Fc){this._position=null,this._normal=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._tangent=Fc}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(36,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector3",5)])}]),Fa}(),FFa=function(){function Fa(Fa,Fb,Fc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTexture");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(32,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2)])}]),Fa}(),FGa=function(){function Fa(Fa,Fb,Fc,Fd){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Fa,this._normal=Fb,this._textureCoordinate0=Fc,this._textureCoordinate1=Fd}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(40,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector2",15)])}]),Fa}(),FHa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Fa,this._normal=Fb,this._textureCoordinate0=Fc,this._textureCoordinate1=Fd,this._blendIndex=Fe,this._blendWeight=Ff}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(72,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector2",15),new Fga(40,"vector4",7),new Fga(56,"vector4",6)])}]),Fa}(),FIa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._textureCoordinate0=Fc,this._textureCoordinate1=Fd,this._tangent=Fe,this._blendIndex=Ff,this._blendWeight=Fg}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(88,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector2",15),new Fga(40,"vector4",7),new Fga(56,"vector4",6),new Fga(72,"vector4",5)])}]),Fa}(),FJa=function(){function Fa(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fb.VertexPositionNormalTexture0SkinTangent=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){this._position=Fa,this._normal=Fb,this._textureCoordinate0=Fc,this._textureCoordinate1=Fd,this._tangent=Fe,this._blendIndex=Ff,this._blendWeight=Fg},Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(84,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector2",15),new Fga(40,"vector4",7),new Fga(56,"vector4",6),new Fga(72,"vector3",5)])}]),Fa}(),FKa=function(){function Fa(Fa,Fb,Fc,Fd,Fe){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._textureCoordinate0=Fc,this._textureCoordinate1=Fd,this._tangent=Fe}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(56,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector2",15),new Fga(40,"vector4",5)])}]),Fa}(),FLa=function(){function Fa(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fb.VertexPositionNormalTexture0Tangent=function(Fa,Fb,Fc,Fd,Fe){this._position=Fa,this._normal=Fb,this._textureCoordinate0=Fc,this._textureCoordinate1=Fd,this._tangent=Fe},Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(52,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector2",15),new Fga(40,"vector3",5)])}]),Fa}(),FMa=function(){function Fa(Fa,Fb,Fc,Fd,Fe){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc,this._blendIndex=Fd,this._blendWeight=Fe}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTextureSkin");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(64,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector4",7),new Fga(48,"vector4",6)])}]),Fa}(),FNa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc,this._tangent=Fd,this._blendIndex=Fe,this._blendWeight=Ff}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(80,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector4",7),new Fga(48,"vector4",6),new Fga(64,"vector4",5)])}]),Fa}(),FOa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc,this._tangent=Fd,this._blendIndex=Fe,this._blendWeight=Ff}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(76,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector4",7),new Fga(48,"vector4",6),new Fga(64,"vector3",5)])}]),Fa}(),FPa=function(){function Fa(Fa,Fb,Fc,Fd){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc,this._tangent=Fd}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(48,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector4",5)])}]),Fa}(),FQa=function(){function Fa(Fa,Fb,Fc,Fd){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc,this._tangent=Fd}Fp(Fa,"laya.d3.graphics.VertexPositionNormalTextureTangent");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(44,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector3",5)])}]),Fa}(),FRa=function(){function Fa(Fa,Fb,Fc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc}Fp(Fa,"laya.d3.graphics.VertexPositionNTBTexture");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(56,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector3",5),new Fga(36,"vector3",4),new Fga(48,"vector2",2)])}]),Fa}(),FSa=function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=Fa,this._normal=Fb,this._textureCoordinate0=Fd,this._textureCoordinate1=Fe,this._tangent=Ff,Fc=Fc,this._blendIndex=Fg,this._blendWeight=Fh}Fp(Fa,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"tangent",function(){return this._tangent}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(0,Fb,"textureCoordinate1",function(){return this._textureCoordinate1}),Fq(0,Fb,"blendIndex",function(){return this._blendIndex}),Fq(0,Fb,"blendWeight",function(){return this._blendWeight}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(96,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector3",5),new Fga(36,"vector3",4),new Fga(48,"vector2",2),new Fga(56,"vector2",15),new Fga(64,"vector4",7),new Fga(80,"vector4",6)])}]),Fa}(),FTa=function(){function Fa(Fa,Fb,Fc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Fa,this._normal=Fb,this._textureCoordinate=Fc}Fp(Fa,"laya.d3.graphics.VertexPositionNTBTextureSkin");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"textureCoordinate",function(){return this._textureCoordinate}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(88,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector3",5),new Fga(36,"vector3",4),new Fga(48,"vector2",2),new Fga(56,"vector4",7),new Fga(72,"vector4",6)])}]),Fa}(),FUa=(function(){function Fa(Fa,Fb,Fc,Fd){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=Fa,this._normal=Fb,this._textureCoord0=Fc,this._textureCoord1=Fd}Fp(Fa,"laya.d3.graphics.VertexPositionTerrain");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"normal",function(){return this._normal}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoord0",function(){return this._textureCoord0}),Fq(0,Fb,"textureCoord1",function(){return this._textureCoord1}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(40,[new Fga(0,"vector3",0),new Fga(12,"vector3",3),new Fga(24,"vector2",2),new Fga(32,"vector2",15)])}])}(),function(){function Fa(Fa,Fb){this._position=null,this._textureCoordinate0=null,this._position=Fa,this._textureCoordinate0=Fb}Fp(Fa,"laya.d3.graphics.VertexPositionTexture0");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"position",function(){return this._position}),Fq(0,Fb,"textureCoordinate0",function(){return this._textureCoordinate0}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(20,[new Fga(0,"vector3",0),new Fga(12,"vector2",2)])}]),Fa}()),FVa=(function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn,Fo,Fp){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Fa,this._positionStartLifeTime=Fb,this._velocity=Fc,this._startColor=Fd,this._startSize=Fe,this._startRotation0=Ff,this._startRotation1=Fg,this._startRotation2=Fh,this._startLifeTime=Fi,this._time=Fj,this._startSpeed=Fm,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Fp}Fp(Fa,"laya.d3.graphics.VertexShurikenParticleBillboard");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Fq(0,Fb,"random1",function(){return this._randoms1}),Fq(0,Fb,"startRotation2",function(){return this._startRotation2}),Fq(0,Fb,"positionStartLifeTime",function(){return this._positionStartLifeTime}),Fq(0,Fb,"velocity",function(){return this._velocity}),Fq(0,Fb,"random0",function(){return this._randoms0}),Fq(0,Fb,"startSize",function(){return this._startSize}),Fq(0,Fb,"startColor",function(){return this._startColor}),Fq(0,Fb,"startRotation0",function(){return this._startRotation0}),Fq(0,Fb,"startRotation1",function(){return this._startRotation1}),Fq(0,Fb,"startLifeTime",function(){return this._startLifeTime}),Fq(0,Fb,"time",function(){return this._time}),Fq(0,Fb,"startSpeed",function(){return this._startSpeed}),Fq(0,Fb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(152,[new Fga(0,"vector4",17),new Fga(16,"vector4",30),new Fga(32,"vector4",32),new Fga(48,"vector4",19),new Fga(64,"vector3",20),new Fga(76,"vector3",22),new Fga(88,"single",31),new Fga(92,"vector4",34),new Fga(108,"vector4",35),new Fga(124,"vector3",36),new Fga(136,"vector4",37)])}])}(),function(){function Fa(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn,Fo,Fp){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Fa,this._positionStartLifeTime=Fb,this._velocity=Fc,this._startColor=Fd,this._startSize=Fe,this._startRotation0=Ff,this._startRotation1=Fg,this._startRotation2=Fh,this._startLifeTime=Fi,this._time=Fj,this._startSpeed=Fm,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Fp}Fp(Fa,"laya.d3.graphics.VertexShurikenParticleMesh");var Fb=Fa.prototype;Fx.imps(Fb,{"laya.d3.graphics.IVertex":!0}),Fq(0,Fb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Fq(0,Fb,"velocity",function(){return this._velocity}),Fq(0,Fb,"position",function(){return this._positionStartLifeTime}),Fq(0,Fb,"random0",function(){return this._randoms0}),Fq(0,Fb,"startSize",function(){return this._startSize}),Fq(0,Fb,"startColor",function(){return this._startColor}),Fq(0,Fb,"startRotation0",function(){return this._startRotation0}),Fq(0,Fb,"startRotation1",function(){return this._startRotation1}),Fq(0,Fb,"random1",function(){return this._randoms1}),Fq(0,Fb,"startRotation2",function(){return this._startRotation2}),Fq(0,Fb,"startLifeTime",function(){return this._startLifeTime}),Fq(0,Fb,"time",function(){return this._time}),Fq(0,Fb,"startSpeed",function(){return this._startSpeed}),Fq(0,Fb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Fq(0,Fb,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fq(1,Fa,"vertexDeclaration",function(){return Fa._vertexDeclaration}),Fn(Fa,["_vertexDeclaration",function(){return this._vertexDeclaration=new Ffa(172,[new Fga(0,"vector3",0),new Fga(12,"vector4",1),new Fga(28,"vector2",2),new Fga(36,"vector4",30),new Fga(52,"vector4",32),new Fga(68,"vector4",19),new Fga(84,"vector3",20),new Fga(96,"vector3",22),new Fga(108,"single",31),new Fga(112,"vector4",34),new Fga(128,"vector4",35),new Fga(144,"vector3",36),new Fga(156,"vector4",37)])}])}(),function(){function Fv(Fa,Fb,Fc,Fd,Fe,Ff){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=Fc,this._materials=Fd,this._subMeshes=Fe,this._materialMap=Ff,this._version=Fb,this._onLoaded(Fa)}Fp(Fv,"laya.d3.loaders.LoadModelV01");var Fa=Fv.prototype;return Fa._onLoaded=function(Fa){this._readData=Fa,this.READ_BLOCK();for(var Fb=0;Fb<this._BLOCK.count;Fb++){var Fc=this._readData.getUint16(),Fd=this._strings[Fc],Fe=this["READ_"+Fd];if(null==Fe)throw new Error("model file err,no this function:"+Fc+" "+Fd);if(!Fe.call(this))break}return this._mesh},Fa.onError=function(){},Fa._readString=function(){return this._strings[this._readData.getUint16()]},Fa.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},Fa.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},Fa.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var Fa=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var Fb=0;Fb<this._STRINGS.size;Fb++)this._strings[Fb]=this._readData.readUTFString();return this._readData.pos=Fa,!0},Fa.READ_MATERIAL=function(){var Fa=this._readData.getUint16(),Fb=(this._readString(),this._readString());return this._materials[Fa]="null"!==Fb?Ft.getRes(this._materialMap[Fb]):new FEb,!0},Fa.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var Fa,Fb=this._readData.__getBuffer(),Fc=0,Fd=this._readData.getUint32(),Fe=this._readData.getUint32(),Ff=(new Float32Array(Fb.slice(Fd+this._DATA.offset,Fd+this._DATA.offset+Fe)),this._readData.getUint32()),Fg=this._readData.getUint32(),Fh=new Float32Array(Fb.slice(Ff+this._DATA.offset,Ff+this._DATA.offset+Fg));for(this.mesh._inverseBindPoses=[],Fc=0,Fa=Fh.length;Fc<Fa;Fc+=16){var Fi=new Fab(Fh[Fc+0],Fh[Fc+1],Fh[Fc+2],Fh[Fc+3],Fh[Fc+4],Fh[Fc+5],Fh[Fc+6],Fh[Fc+7],Fh[Fc+8],Fh[Fc+9],Fh[Fc+10],Fh[Fc+11],Fh[Fc+12],Fh[Fc+13],Fh[Fc+14],Fh[Fc+15]);this.mesh._inverseBindPoses.push(Fi)}break;default:throw new Error("LoadModel:unknown version.")}return!0},Fa.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var Fa=this._readString();this._shaderAttributes=Fa.match(Fv._attrReg);var Fb=this._readData.getUint32(),Fc=this._readData.getUint32(),Fd=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),Fe=this._readData.getUint32(),Ff=this._readData.getUint32(),Fg=this._readData.getUint32(),Fh=this._readData.__getBuffer(),Fi=new Fjb(this._mesh),Fj=this._getVertexDeclaration(),Fm=FOb.create(Fj,Fe/Fj.vertexStride,35044,!0),Fn=Fd+this._DATA.offset,Fo=Fh.slice(Fn,Fn+Fe);Fm.setData(new Float32Array(Fo));for(var Fp=(Fi._vertexBuffer=Fm).vertexDeclaration.getVertexElements(),Fq=0;Fq<Fp.length;Fq++)Fi._bufferUsage[Fp[Fq].elementUsage]=Fm;var Fr=FNb.create("ushort",Fc/2,35044,!0),Fs=Fb+this._DATA.offset,Ft=Fh.slice(Fs,Fs+Fc);Fr.setData(new Uint16Array(Ft)),Fi._indexBuffer=Fr;var Fu=Fh.slice(Ff+this._DATA.offset,Ff+this._DATA.offset+Fg);return Fi._boneIndicesList[0]=new Uint8Array(Fu),this._subMeshes.push(Fi),!0},Fa.READ_DATAAREA=function(){return!1},Fa._getVertexDeclaration=function(){for(var Fa,Fb=!1,Fc=!1,Fd=!1,Fe=!1,Ff=!1,Fg=!1,Fh=!1,Fi=!1,Fj=!1,Fm=0;Fm<this._shaderAttributes.length;Fm+=8)switch(this._shaderAttributes[Fm]){case"POSITION":Fb=!0;break;case"NORMAL":Fc=!0;break;case"COLOR":Fd=!0;break;case"UV":Fe=!0;break;case"UV1":Ff=!0;break;case"BLENDWEIGHT":Fh=!0;break;case"BLENDINDICES":Fi=!0;break;case"TANGENT":Fg=!0;break;case"BINORMAL":Fj=!0}return Fb&&Fc&&Fd&&Fe&&Ff&&Fh&&Fi&&Fg?Fa=Fva.vertexDeclaration:Fb&&Fc&&Fd&&Fe&&Ff&&Fh&&Fi?Fa=Fta.vertexDeclaration:Fb&&Fc&&Fe&&Ff&&Fh&&Fi&&Fg?Fa=FJa.vertexDeclaration:Fb&&Fc&&Fe&&Ff&&Fh&&Fi?Fa=FHa.vertexDeclaration:Fb&&Fc&&Fd&&Fe&&Fh&&Fi&&Fg?Fa=FAa.vertexDeclaration:Fb&&Fc&&Fd&&Fe&&Fh&&Fi?Fa=Fya.vertexDeclaration:Fb&&Fc&&Fg&&Fj&&Fe&&Fh&&Fi?Fa=FTa.vertexDeclaration:Fb&&Fc&&Fe&&Fh&&Fi&&Fg?Fa=FOa.vertexDeclaration:Fb&&Fc&&Fe&&Fh&&Fi?Fa=FMa.vertexDeclaration:Fb&&Fc&&Fd&&Fh&&Fi&&Fg?Fa=Foa.vertexDeclaration:Fb&&Fc&&Fd&&Fh&&Fi?Fa=Fma.vertexDeclaration:Fb&&Fc&&Fd&&Fe&&Ff&&Fg?Fa=Fxa.vertexDeclaration:Fb&&Fc&&Fd&&Fe&&Ff?Fa=Fsa.vertexDeclaration:Fb&&Fc&&Fe&&Ff&&Fg?Fa=FLa.vertexDeclaration:Fb&&Fc&&Fe&&Ff?Fa=FGa.vertexDeclaration:Fb&&Fc&&Fd&&Fe&&Fg?Fa=FCa.vertexDeclaration:Fb&&Fc&&Fe&&Fg&&Fj?Fa=FRa.vertexDeclaration:Fb&&Fc&&Fd&&Fe?Fa=Fra.vertexDeclaration:Fb&&Fc&&Fe&&Fg?Fa=FQa.vertexDeclaration:Fb&&Fc&&Fe?Fa=FFa.vertexDeclaration:Fb&&Fc&&Fd&&Fg?Fa=Fqa.vertexDeclaration:Fb&&Fc&&Fd&&(Fa=Fja.vertexDeclaration),Fa},Fq(0,Fa,"mesh",function(){return this._mesh}),Fv._attrReg=new RegExp("(\\w+)|([:,;])","g"),Fv}()),FWa=function(){function Fz(){}return Fp(Fz,"laya.d3.loaders.LoadModelV02"),Fz.parse=function(Fa,Fb,Fc,Fd,Fe,Ff){Fz._mesh=Fc,Fz._materials=Fd,Fz._subMeshes=Fe,Fz._materialMap=Ff,Fz._version=Fb,Fz._readData=Fa,Fz.READ_DATA(),Fz.READ_BLOCK(),Fz.READ_STRINGS();for(var Fg=0,Fh=Fz._BLOCK.count;Fg<Fh;Fg++){Fz._readData.pos=Fz._BLOCK.blockStarts[Fg];var Fi=Fz._readData.getUint16(),Fj=Fz._strings[Fi],Fm=Fz["READ_"+Fj];if(null==Fm)throw new Error("model file err,no this function:"+Fi+" "+Fj);Fm.call()}Fz._strings.length=0,Fz._readData=null,Fz._version=null,Fz._mesh=null,Fz._materials=null,Fz._subMeshes=null,Fz._materialMap=null},Fz._readString=function(){return Fz._strings[Fz._readData.getUint16()]},Fz.READ_DATA=function(){Fz._DATA.offset=Fz._readData.getUint32(),Fz._DATA.size=Fz._readData.getUint32()},Fz.READ_BLOCK=function(){for(var Fa=Fz._BLOCK.count=Fz._readData.getUint16(),Fb=Fz._BLOCK.blockStarts=[],Fc=Fz._BLOCK.blockLengths=[],Fd=0;Fd<Fa;Fd++)Fb.push(Fz._readData.getUint32()),Fc.push(Fz._readData.getUint32())},Fz.READ_STRINGS=function(){var Fa=Fz._readData.getUint32(),Fb=Fz._readData.getUint16(),Fc=Fz._readData.pos;Fz._readData.pos=Fa+Fz._DATA.offset;for(var Fd=0;Fd<Fb;Fd++)Fz._strings[Fd]=Fz._readData.readUTFString();Fz._readData.pos=Fc},Fz.READ_MATERIAL=function(){Fz._readString(),Fz._readString();var Fa=Fz._readString();return""!==Fa&&Fz._materials.push(Ft.getRes(Fz._materialMap[Fa])),!0},Fz.READ_MESH=function(){Fz._readString();var Fa,Fb=Fz._readData.__getBuffer(),Fc=0,Fd=Fz._readData.getInt16(),Fe=Fz._DATA.offset;for(Fc=0;Fc<Fd;Fc++){var Ff=Fe+Fz._readData.getUint32(),Fg=Fz._readData.getUint32(),Fh=new Float32Array(Fb.slice(Ff,Ff+Fg)),Fi=Fz._readString().match(Fz._attrReg),Fj=Fz._getVertexDeclaration(Fi),Fm=FOb.create(Fj,4*Fh.length/Fj.vertexStride,35044,!0);Fm.setData(Fh),Fz._mesh._vertexBuffers.push(Fm)}var Fn=Fe+Fz._readData.getUint32(),Fo=Fz._readData.getUint32(),Fp=new Uint16Array(Fb.slice(Fn,Fn+Fo)),Fq=FNb.create("ushort",Fo/2,35044,!0);Fq.setData(Fp),Fz._mesh._indexBuffer=Fq;var Fr=Fz._mesh._boneNames=[],Fs=Fz._readData.getUint16();for(Fr.length=Fs,Fc=0;Fc<Fs;Fc++)Fr[Fc]=Fz._strings[Fz._readData.getUint16()];var Ft=Fz._readData.getUint32(),Fu=Fz._readData.getUint32(),Fv=(new Float32Array(Fb.slice(Fe+Ft,Fe+Ft+Fu)),Fz._readData.getUint32()),Fw=Fz._readData.getUint32(),Fx=new Float32Array(Fb.slice(Fe+Fv,Fe+Fv+Fw));for(Fz._mesh._inverseBindPoses=[],Fc=0,Fa=Fx.length;Fc<Fa;Fc+=16){var Fy=new Fab(Fx[Fc+0],Fx[Fc+1],Fx[Fc+2],Fx[Fc+3],Fx[Fc+4],Fx[Fc+5],Fx[Fc+6],Fx[Fc+7],Fx[Fc+8],Fx[Fc+9],Fx[Fc+10],Fx[Fc+11],Fx[Fc+12],Fx[Fc+13],Fx[Fc+14],Fx[Fc+15]);Fz._mesh._inverseBindPoses.push(Fy)}return Fz._mesh._skinnedDatas=new Float32Array(16*Fx.length),!0},Fz.READ_SUBMESH=function(){var Fa=Fz._readData.__getBuffer(),Fb=new Fjb(Fz._mesh),Fc=Fz._readData.getInt16(),Fd=Fz._readData.getUint32(),Fe=Fz._readData.getUint32();Fb._vertexBuffer=Fz._mesh._vertexBuffers[Fc],Fb._vertexStart=Fd,Fb._vertexCount=Fe;var Ff=Fz._readData.getUint32(),Fg=Fz._readData.getUint32(),Fh=Fz._mesh._indexBuffer;Fb._indexBuffer=Fh,Fb._indexStart=Ff,Fb._indexCount=Fg,Fb._indices=new Uint16Array(Fh.getData().buffer,2*Ff,Fg);var Fi=Fz._DATA.offset,Fj=Fb._subIndexBufferStart,Fm=Fb._subIndexBufferCount,Fn=Fb._boneIndicesList,Fo=Fz._readData.getUint16();Fj.length=Fo,Fm.length=Fo,Fn.length=Fo;for(var Fp=0;Fp<Fo;Fp++){Fj[Fp]=Fz._readData.getUint32(),Fm[Fp]=Fz._readData.getUint32();var Fq=Fz._readData.getUint32(),Fr=Fz._readData.getUint32();Fb._boneIndicesList[Fp]=new Uint8Array(Fa.slice(Fi+Fq,Fi+Fq+Fr))}return Fz._subMeshes.push(Fb),!0},Fz._getVertexDeclaration=function(Fa){for(var Fb,Fc=!1,Fd=!1,Fe=!1,Ff=!1,Fg=!1,Fh=!1,Fi=!1,Fj=!1,Fm=!1,Fn=0;Fn<Fa.length;Fn++)switch(Fa[Fn]){case"POSITION":Fc=!0;break;case"NORMAL":Fd=!0;break;case"COLOR":Fe=!0;break;case"UV":Ff=!0;break;case"UV1":Fg=!0;break;case"BLENDWEIGHT":Fi=!0;break;case"BLENDINDICES":Fj=!0;break;case"TANGENT":Fh=!0;break;case"BINORMAL":Fm=!0}return Fc&&Fd&&Fe&&Ff&&Fg&&Fi&&Fj&&Fh?Fb=Fva.vertexDeclaration:Fc&&Fd&&Fe&&Ff&&Fg&&Fi&&Fj?Fb=Fta.vertexDeclaration:Fc&&Fd&&Ff&&Fg&&Fi&&Fj&&Fh?Fb=FJa.vertexDeclaration:Fc&&Fd&&Ff&&Fg&&Fi&&Fj?Fb=FHa.vertexDeclaration:Fc&&Fd&&Fe&&Ff&&Fi&&Fj&&Fh?Fb=FAa.vertexDeclaration:Fc&&Fd&&Fe&&Ff&&Fi&&Fj?Fb=Fya.vertexDeclaration:Fc&&Fd&&Ff&&Fi&&Fj&&Fh?Fb=FOa.vertexDeclaration:Fc&&Fd&&Ff&&Fi&&Fj?Fb=FMa.vertexDeclaration:Fc&&Fd&&Fe&&Fi&&Fj&&Fh?Fb=Foa.vertexDeclaration:Fc&&Fd&&Fe&&Fi&&Fj?Fb=Fma.vertexDeclaration:Fc&&Fd&&Fe&&Ff&&Fg&&Fh?Fb=Fxa.vertexDeclaration:Fc&&Fd&&Fe&&Ff&&Fg?Fb=Fsa.vertexDeclaration:Fc&&Fd&&Ff&&Fg&&Fh?Fb=FLa.vertexDeclaration:Fc&&Fd&&Ff&&Fg?Fb=FGa.vertexDeclaration:Fc&&Fd&&Fe&&Ff&&Fh?Fb=FCa.vertexDeclaration:Fc&&Fd&&Ff&&Fh&&Fm?Fb=FRa.vertexDeclaration:Fc&&Fd&&Fe&&Ff?Fb=Fra.vertexDeclaration:Fc&&Fd&&Ff&&Fh?Fb=FQa.vertexDeclaration:Fc&&Fd&&Ff?Fb=FFa.vertexDeclaration:Fc&&Fd&&Fe&&Fh?Fb=Fqa.vertexDeclaration:Fc&&Fd&&Fe&&(Fb=Fja.vertexDeclaration),Fb},Fz._attrReg=new RegExp("(\\w+)|([:,;])","g"),Fz._strings=[],Fz._readData=null,Fz._version=null,Fz._mesh=null,Fz._materials=null,Fz._subMeshes=null,Fz._materialMap=null,Fn(Fz,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Fz}(),FXa=function(){function Fy(){}return Fp(Fy,"laya.d3.loaders.LoadModelV03"),Fy.parse=function(Fa,Fb,Fc,Fd,Fe){Fy._mesh=Fc,Fy._subMeshes=Fd,Fy._materialMap=Fe,Fy._version=Fb,Fy._readData=Fa,Fy.READ_DATA(),Fy.READ_BLOCK(),Fy.READ_STRINGS();for(var Ff=0,Fg=Fy._BLOCK.count;Ff<Fg;Ff++){Fy._readData.pos=Fy._BLOCK.blockStarts[Ff];var Fh=Fy._readData.getUint16(),Fi=Fy._strings[Fh],Fj=Fy["READ_"+Fi];if(null==Fj)throw new Error("model file err,no this function:"+Fh+" "+Fi);Fj.call()}Fy._strings.length=0,Fy._readData=null,Fy._version=null,Fy._mesh=null,Fy._subMeshes=null,Fy._materialMap=null},Fy._readString=function(){return Fy._strings[Fy._readData.getUint16()]},Fy.READ_DATA=function(){Fy._DATA.offset=Fy._readData.getUint32(),Fy._DATA.size=Fy._readData.getUint32()},Fy.READ_BLOCK=function(){for(var Fa=Fy._BLOCK.count=Fy._readData.getUint16(),Fb=Fy._BLOCK.blockStarts=[],Fc=Fy._BLOCK.blockLengths=[],Fd=0;Fd<Fa;Fd++)Fb.push(Fy._readData.getUint32()),Fc.push(Fy._readData.getUint32())},Fy.READ_STRINGS=function(){var Fa=Fy._readData.getUint32(),Fb=Fy._readData.getUint16(),Fc=Fy._readData.pos;Fy._readData.pos=Fa+Fy._DATA.offset;for(var Fd=0;Fd<Fb;Fd++)Fy._strings[Fd]=Fy._readData.readUTFString();Fy._readData.pos=Fc},Fy.READ_MESH=function(){var Fa,Fb=Fy._readString(),Fc=Fy._readData.__getBuffer(),Fd=0,Fe=Fy._readData.getInt16(),Ff=Fy._DATA.offset;for(Fd=0;Fd<Fe;Fd++){var Fg,Fh=Ff+Fy._readData.getUint32(),Fi=Fy._readData.getUint32(),Fj=new Float32Array(Fc.slice(Fh,Fh+Fi)),Fm=Fy._readString();switch(Fy._version){case"LAYAMODEL:03":Fg=Fy._vertexDeclarationMap_Discard[Fm];break;case"LAYAMODEL:0301":Fg=Fy._vertexDeclarationMap[Fm];break;default:throw new Error("LoadModelV03: unknown version.")}if(!Fg)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+Fy._version+"  bufferAttribute="+Fm+"  name="+Fb+"  url="+(Fy._mesh?Fy._mesh.url:"null"));var Fn=FOb.create(Fg,4*Fj.length/Fg.vertexStride,35044,!0,Fy._mesh._url+"_"+Fd);Fn.setData(Fj),Fy._mesh._vertexBuffers.push(Fn)}var Fo=Ff+Fy._readData.getUint32(),Fp=Fy._readData.getUint32(),Fq=new Uint16Array(Fc.slice(Fo,Fo+Fp)),Fr=FNb.create("ushort",Fp/2,35044,!0,Fy._mesh._url);Fr.setData(Fq),Fy._mesh._indexBuffer=Fr;var Fs=Fy._mesh._boneNames=[],Ft=Fy._readData.getUint16();for(Fs.length=Ft,Fd=0;Fd<Ft;Fd++)Fs[Fd]=Fy._strings[Fy._readData.getUint16()];Fy._readData.pos+=8;var Fu=Fy._readData.getUint32(),Fv=Fy._readData.getUint32(),Fw=new Float32Array(Fc.slice(Ff+Fu,Ff+Fu+Fv));for(Fy._mesh._inverseBindPoses=[],Fd=0,Fa=Fw.length;Fd<Fa;Fd+=16){var Fx=new Fab(Fw[Fd+0],Fw[Fd+1],Fw[Fd+2],Fw[Fd+3],Fw[Fd+4],Fw[Fd+5],Fw[Fd+6],Fw[Fd+7],Fw[Fd+8],Fw[Fd+9],Fw[Fd+10],Fw[Fd+11],Fw[Fd+12],Fw[Fd+13],Fw[Fd+14],Fw[Fd+15]);Fy._mesh._inverseBindPoses.push(Fx)}return Fy._mesh._skinnedDatas=new Float32Array(16*Fw.length),!0},Fy.READ_SUBMESH=function(){var Fa=Fy._readData.__getBuffer(),Fb=new Fjb(Fy._mesh),Fc=Fy._readData.getInt16(),Fd=Fy._readData.getUint32(),Fe=Fy._readData.getUint32();Fb._vertexBuffer=Fy._mesh._vertexBuffers[Fc],Fb._vertexStart=Fd,Fb._vertexCount=Fe;var Ff=Fy._readData.getUint32(),Fg=Fy._readData.getUint32(),Fh=Fy._mesh._indexBuffer;Fb._indexBuffer=Fh,Fb._indexStart=Ff,Fb._indexCount=Fg,Fb._indices=new Uint16Array(Fh.getData().buffer,2*Ff,Fg);var Fi=Fy._DATA.offset,Fj=Fb._subIndexBufferStart,Fm=Fb._subIndexBufferCount,Fn=Fb._boneIndicesList,Fo=Fy._readData.getUint16();Fj.length=Fo,Fm.length=Fo,Fn.length=Fo;for(var Fp=0;Fp<Fo;Fp++){Fj[Fp]=Fy._readData.getUint32(),Fm[Fp]=Fy._readData.getUint32();var Fq=Fy._readData.getUint32(),Fr=Fy._readData.getUint32();Fn[Fp]=new Uint8Array(Fa.slice(Fi+Fq,Fi+Fq+Fr))}return Fy._subMeshes.push(Fb),!0},Fy._strings=[],Fy._readData=null,Fy._version=null,Fy._mesh=null,Fy._subMeshes=null,Fy._materialMap=null,Fn(Fy,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Fva.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Fta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":FSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":FJa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":FHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":FAa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Fya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":FOa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":FMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Foa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Fma.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Fxa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Fsa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":FLa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":FGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":FCa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":FRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Fra.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":FQa.vertexDeclaration,"POSITION,NORMAL,UV":FFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Fqa.vertexDeclaration,"POSITION,NORMAL,COLOR":Fja.vertexDeclaration,"POSITION,NORMAL,TANGENT":FEa.vertexDeclaration,"POSITION,NORMAL":Fia.vertexDeclaration,"POSITION,UV":FUa.vertexDeclaration,POSITION:Fha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Fua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Fta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":FSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":FIa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":FHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Fza.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Fya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":FNa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":FMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Fna.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Fma.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Fwa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Fsa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":FKa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":FGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":FBa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":FRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Fra.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":FPa.vertexDeclaration,"POSITION,NORMAL,UV":FFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Fpa.vertexDeclaration,"POSITION,NORMAL,COLOR":Fja.vertexDeclaration,"POSITION,NORMAL,TANGENT":FDa.vertexDeclaration,"POSITION,NORMAL":Fia.vertexDeclaration,"POSITION,UV":FUa.vertexDeclaration,POSITION:Fha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Fy}(),FYa=function(){function Fh(){}return Fp(Fh,"laya.d3.loaders.MeshReader"),Fh.read=function(Fa,Fb,Fc,Fd,Fe){var Ff=new Fy(Fa);Ff.pos=0;var Fg=Ff.readUTFString();switch(Fg){case"LAYAMODEL:01":case"LAYASKINANI:01":Fh._readVersion01(Ff,Fg,Fb,Fc,Fd,Fe);break;case"LAYAMODEL:02":FWa.parse(Ff,Fg,Fb,Fc,Fd,Fe);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":FXa.parse(Ff,Fg,Fb,Fd,Fe);break;default:throw new Error("MeshReader: unknown mesh version.")}Fb._setSubMeshes(Fd)},Fh._readVersion01=function(Fa,Fb,Fc,Fd,Fe,Ff){new FVa(Fa,Fb,Fc,Fd,Fe,Ff)},Fh}(),FZa=function(){function Fa(Fa,Fb){this.min=null,this.max=null,this.min=Fa,this.max=Fb}Fp(Fa,"laya.d3.math.BoundBox");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.getCorners=function(Fa){Fa.length=8;var Fb=this.min.elements,Fc=this.max.elements,Fd=Fb[0],Fe=Fb[1],Ff=Fb[2],Fg=Fc[0],Fh=Fc[1],Fi=Fc[2];Fa[0]=new Fgb(Fd,Fh,Fi),Fa[1]=new Fgb(Fg,Fh,Fi),Fa[2]=new Fgb(Fg,Fe,Fi),Fa[3]=new Fgb(Fd,Fe,Fi),Fa[4]=new Fgb(Fd,Fh,Ff),Fa[5]=new Fgb(Fg,Fh,Ff),Fa[6]=new Fgb(Fg,Fe,Ff),Fa[7]=new Fgb(Fd,Fe,Ff)},Fb.toDefault=function(){this.min.toDefault(),this.max.toDefault()},Fb.cloneTo=function(Fa){var Fb=Fa;this.min.cloneTo(Fb.min),this.max.cloneTo(Fb.max)},Fb.clone=function(){var Fa=new this.constructor(new Fgb,new Fgb);return this.cloneTo(Fa),Fa},Fa.createfromPoints=function(Fa,Fb){if(null==Fa)throw new Error("points");var Fc=Fb.min,Fd=Fb.max,Fe=Fc.elements;Fe[0]=Number.MAX_VALUE,Fe[1]=Number.MAX_VALUE,Fe[2]=Number.MAX_VALUE;var Ff=Fd.elements;Ff[0]=-Number.MAX_VALUE,Ff[1]=-Number.MAX_VALUE,Ff[2]=-Number.MAX_VALUE;for(var Fg=0,Fh=Fa.length;Fg<Fh;++Fg)Fgb.min(Fc,Fa[Fg],Fc),Fgb.max(Fd,Fa[Fg],Fd)},Fa.merge=function(Fa,Fb,Fc){Fgb.min(Fa.min,Fb.min,Fc.min),Fgb.max(Fa.max,Fb.max,Fc.max)},Fa}(),F$a=function(){function Fj(Fa){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=Fa,this._near=new Fbb(new Fgb),this._far=new Fbb(new Fgb),this._left=new Fbb(new Fgb),this._right=new Fbb(new Fgb),this._top=new Fbb(new Fgb),this._bottom=new Fbb(new Fgb),Fj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}Fp(Fj,"laya.d3.math.BoundFrustum");var Fa=Fj.prototype;return Fa.equalsBoundFrustum=function(Fa){return this._matrix.equalsOtherMatrix(Fa.matrix)},Fa.equalsObj=function(Fa){if(Fa instanceof laya.d3.math.BoundFrustum){var Fb=Fa;return this.equalsBoundFrustum(Fb)}return!1},Fa.getPlane=function(Fa){switch(Fa){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},Fa.getCorners=function(Fa){Fj._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(Fa[0]),Fj._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(Fa[1]),Fj._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(Fa[2]),Fj._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(Fa[3]),Fj._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(Fa[4]),Fj._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(Fa[5]),Fj._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(Fa[6]),Fj._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(Fa[7])},Fa.containsPoint=function(Fa){for(var Fb=Fbb.PlaneIntersectionType_Front,Fc=Fbb.PlaneIntersectionType_Front,Fd=0;Fd<6;Fd++){switch(Fd){case 0:Fc=Collision.intersectsPlaneAndPoint(this._near,Fa);break;case 1:Fc=Collision.intersectsPlaneAndPoint(this._far,Fa);break;case 2:Fc=Collision.intersectsPlaneAndPoint(this._left,Fa);break;case 3:Fc=Collision.intersectsPlaneAndPoint(this._right,Fa);break;case 4:Fc=Collision.intersectsPlaneAndPoint(this._top,Fa);break;case 5:Fc=Collision.intersectsPlaneAndPoint(this._bottom,Fa)}switch(Fc){case Fbb.PlaneIntersectionType_Back:return 0;case Fbb.PlaneIntersectionType_Intersecting:Fb=Fbb.PlaneIntersectionType_Intersecting}}switch(Fb){case Fbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Fa.containsBoundBox=function(Fa){for(var Fb,Fc=Fj._tempV30,Fd=Fj._tempV31,Fe=1,Ff=0;Ff<6;Ff++){if(Fb=this.getPlane(Ff),this._getBoxToPlanePVertexNVertex(Fa,Fb.normal,Fc,Fd),Collision.intersectsPlaneAndPoint(Fb,Fc)===Fbb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(Fb,Fd)===Fbb.PlaneIntersectionType_Back&&(Fe=2)}return Fe},Fa.containsBoundSphere=function(Fa){for(var Fb=Fbb.PlaneIntersectionType_Front,Fc=Fbb.PlaneIntersectionType_Front,Fd=0;Fd<6;Fd++){switch(Fd){case 0:Fc=Collision.intersectsPlaneAndSphere(this._near,Fa);break;case 1:Fc=Collision.intersectsPlaneAndSphere(this._far,Fa);break;case 2:Fc=Collision.intersectsPlaneAndSphere(this._left,Fa);break;case 3:Fc=Collision.intersectsPlaneAndSphere(this._right,Fa);break;case 4:Fc=Collision.intersectsPlaneAndSphere(this._top,Fa);break;case 5:Fc=Collision.intersectsPlaneAndSphere(this._bottom,Fa)}switch(Fc){case Fbb.PlaneIntersectionType_Back:return 0;case Fbb.PlaneIntersectionType_Intersecting:Fb=Fbb.PlaneIntersectionType_Intersecting}}switch(Fb){case Fbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Fa._getBoxToPlanePVertexNVertex=function(Fa,Fb,Fc,Fd){var Fe=Fa.min,Ff=Fe.elements,Fg=Fa.max,Fh=Fg.elements,Fi=Fb.elements,Fj=Fi[0],Fm=Fi[1],Fn=Fi[2];Fe.cloneTo(Fc);var Fo=Fc.elements;0<=Fj&&(Fo[0]=Fh[0]),0<=Fm&&(Fo[1]=Fh[1]),0<=Fn&&(Fo[2]=Fh[2]),Fg.cloneTo(Fd);var Fp=Fd.elements;0<=Fj&&(Fp[0]=Ff[0]),0<=Fm&&(Fp[1]=Ff[1]),0<=Fn&&(Fp[2]=Ff[2])},Fq(0,Fa,"top",function(){return this._top}),Fq(0,Fa,"matrix",function(){return this._matrix},function(Fa){this._matrix=Fa,Fj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),Fq(0,Fa,"near",function(){return this._near}),Fq(0,Fa,"far",function(){return this._far}),Fq(0,Fa,"left",function(){return this._left}),Fq(0,Fa,"right",function(){return this._right}),Fq(0,Fa,"bottom",function(){return this._bottom}),Fj._getPlanesFromMatrix=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){var Fh=Fa.elements,Fi=Fh[0],Fj=Fh[1],Fm=Fh[2],Fn=Fh[3],Fo=Fh[4],Fp=Fh[5],Fq=Fh[6],Fr=Fh[7],Fs=Fh[8],Ft=Fh[9],Fu=Fh[10],Fv=Fh[11],Fw=Fh[12],Fx=Fh[13],Fy=Fh[14],Fz=Fh[15],FA=Fb.normal.elements;FA[0]=Fn+Fm,FA[1]=Fr+Fq,FA[2]=Fv+Fu,Fb.distance=Fz+Fy,Fb.normalize();var FB=Fc.normal.elements;FB[0]=Fn-Fm,FB[1]=Fr-Fq,FB[2]=Fv-Fu,Fc.distance=Fz-Fy,Fc.normalize();var FC=Fd.normal.elements;FC[0]=Fn+Fi,FC[1]=Fr+Fo,FC[2]=Fv+Fs,Fd.distance=Fz+Fw,Fd.normalize();var FD=Fe.normal.elements;FD[0]=Fn-Fi,FD[1]=Fr-Fo,FD[2]=Fv-Fs,Fe.distance=Fz-Fw,Fe.normalize();var FE=Ff.normal.elements;FE[0]=Fn-Fj,FE[1]=Fr-Fp,FE[2]=Fv-Ft,Ff.distance=Fz-Fx,Ff.normalize();var FF=Fg.normal.elements;FF[0]=Fn+Fj,FF[1]=Fr+Fp,FF[2]=Fv+Ft,Fg.distance=Fz+Fx,Fg.normalize()},Fj._get3PlaneInterPoint=function(Fa,Fb,Fc){var Fd=Fa.normal,Fe=Fb.normal,Ff=Fc.normal;Fgb.cross(Fe,Ff,Fj._tempV30),Fgb.cross(Ff,Fd,Fj._tempV31),Fgb.cross(Fd,Fe,Fj._tempV32);var Fg=Fgb.dot(Fd,Fj._tempV30),Fh=Fgb.dot(Fe,Fj._tempV31),Fi=Fgb.dot(Ff,Fj._tempV32);return Fgb.scale(Fj._tempV30,-Fa.distance/Fg,Fj._tempV33),Fgb.scale(Fj._tempV31,-Fb.distance/Fh,Fj._tempV34),Fgb.scale(Fj._tempV32,-Fc.distance/Fi,Fj._tempV35),Fgb.add(Fj._tempV33,Fj._tempV34,Fj._tempV36),Fgb.add(Fj._tempV35,Fj._tempV36,Fj._tempV37),Fj._tempV37},Fn(Fj,["_tempV30",function(){return this._tempV30=new Fgb},"_tempV31",function(){return this._tempV31=new Fgb},"_tempV32",function(){return this._tempV32=new Fgb},"_tempV33",function(){return this._tempV33=new Fgb},"_tempV34",function(){return this._tempV34=new Fgb},"_tempV35",function(){return this._tempV35=new Fgb},"_tempV36",function(){return this._tempV36=new Fgb},"_tempV37",function(){return this._tempV37=new Fgb}]),Fj}(),F_a=function(){function Fm(Fa,Fb){this.center=null,this.radius=NaN,this.center=Fa,this.radius=Fb}Fp(Fm,"laya.d3.math.BoundSphere");var Fa=Fm.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.toDefault=function(){this.center.toDefault(),this.radius=0},Fa.intersectsRayDistance=function(Fa){return Collision.intersectsRayAndSphereRD(Fa,this)},Fa.intersectsRayPoint=function(Fa,Fb){return Collision.intersectsRayAndSphereRP(Fa,this,Fb)},Fa.cloneTo=function(Fa){var Fb=Fa;this.center.cloneTo(Fb.center),Fb.radius=this.radius},Fa.clone=function(){var Fa=new this.constructor(new Fgb,new Fgb);return this.cloneTo(Fa),Fa},Fm.createFromSubPoints=function(Fa,Fb,Fc,Fd){if(null==Fa)throw new Error("points");if(Fb<0||Fb>=Fa.length)throw new Error("start"+Fb+"Must be in the range [0, "+(Fa.length-1)+"]");if(Fc<0||Fb+Fc>Fa.length)throw new Error("count"+Fc+"Must be in the range <= "+Fa.length+"}");var Fe=Fb+Fc,Ff=Fm._tempVector3;Ff.elements[0]=0,Ff.elements[1]=0,Ff.elements[2]=0;for(var Fg=Fb;Fg<Fe;++Fg)Fgb.add(Fa[Fg],Ff,Ff);var Fh=Fd.center;Fgb.scale(Ff,1/Fc,Fh);var Fi=0;for(Fg=Fb;Fg<Fe;++Fg){var Fj=Fgb.distanceSquared(Fh,Fa[Fg]);Fi<Fj&&(Fi=Fj)}Fd.radius=Math.sqrt(Fi)},Fm.createfromPoints=function(Fa,Fb){if(null==Fa)throw new Error("points");Fm.createFromSubPoints(Fa,0,Fa.length,Fb)},Fn(Fm,["_tempVector3",function(){return this._tempVector3=new Fgb}]),Fm}(),Fka=(function(){function Fa(){}Fp(Fa,"laya.d3.math.ContainmentType"),Fa.Disjoint=0,Fa.Contains=1,Fa.Intersects=2}(),function(){function Fc(){}return Fp(Fc,"laya.d3.math.MathUtils3D"),Fc.isZero=function(Fa){return Math.abs(Fa)<Fc.zeroTolerance},Fc.nearEqual=function(Fa,Fb){return!!Fc.isZero(Fa-Fb)},Fc.fastInvSqrt=function(Fa){return Fc.isZero(Fa)?Fa:1/Math.sqrt(Fa)},Fn(Fc,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),Fc}()),Fla=function(){function Fi(){var Fa=this.elements=new Float32Array(9);Fa[0]=1,Fa[1]=0,Fa[2]=0,Fa[3]=0,Fa[4]=1,Fa[5]=0,Fa[6]=0,Fa[7]=0,Fa[8]=1}Fp(Fi,"laya.d3.math.Matrix3x3");var Fa=Fi.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.determinant=function(){var Fa=this.elements,Fb=Fa[0],Fc=Fa[1],Fd=Fa[2],Fe=Fa[3],Ff=Fa[4],Fg=Fa[5],Fh=Fa[6],Fi=Fa[7],Fj=Fa[8];return Fb*(Fj*Ff-Fg*Fi)+Fc*(-Fj*Fe+Fg*Fh)+Fd*(Fi*Fe-Ff*Fh)},Fa.translate=function(Fa,Fb){var Fc=Fb.elements,Fd=this.elements,Fe=Fa.elements,Ff=Fd[0],Fg=Fd[1],Fh=Fd[2],Fi=Fd[3],Fj=Fd[4],Fm=Fd[5],Fn=Fd[6],Fo=Fd[7],Fp=Fd[8],Fq=Fe[0],Fr=Fe[1];Fc[0]=Ff,Fc[1]=Fg,Fc[2]=Fh,Fc[3]=Fi,Fc[4]=Fj,Fc[5]=Fm,Fc[6]=Fq*Ff+Fr*Fi+Fn,Fc[7]=Fq*Fg+Fr*Fj+Fo,Fc[8]=Fq*Fh+Fr*Fm+Fp},Fa.rotate=function(Fa,Fb){var Fc=Fb.elements,Fd=this.elements,Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fd[3],Fi=Fd[4],Fj=Fd[5],Fm=Fd[6],Fn=Fd[7],Fo=Fd[8],Fp=Math.sin(Fa),Fq=Math.cos(Fa);Fc[0]=Fq*Fe+Fp*Fh,Fc[1]=Fq*Ff+Fp*Fi,Fc[2]=Fq*Fg+Fp*Fj,Fc[3]=Fq*Fh-Fp*Fe,Fc[4]=Fq*Fi-Fp*Ff,Fc[5]=Fq*Fj-Fp*Fg,Fc[6]=Fm,Fc[7]=Fn,Fc[8]=Fo},Fa.scale=function(Fa,Fb){var Fc=Fb.elements,Fd=this.elements,Fe=Fa.elements,Ff=Fe[0],Fg=Fe[1];Fc[0]=Ff*Fd[0],Fc[1]=Ff*Fd[1],Fc[2]=Ff*Fd[2],Fc[3]=Fg*Fd[3],Fc[4]=Fg*Fd[4],Fc[5]=Fg*Fd[5],Fc[6]=Fd[6],Fc[7]=Fd[7],Fc[8]=Fd[8]},Fa.invert=function(Fa){var Fb=Fa.elements,Fc=this.elements,Fd=Fc[0],Fe=Fc[1],Ff=Fc[2],Fg=Fc[3],Fh=Fc[4],Fi=Fc[5],Fj=Fc[6],Fm=Fc[7],Fn=Fc[8],Fo=Fn*Fh-Fi*Fm,Fp=-Fn*Fg+Fi*Fj,Fq=Fm*Fg-Fh*Fj,Fr=Fd*Fo+Fe*Fp+Ff*Fq;Fr||(Fa=null),Fr=1/Fr,Fb[0]=Fo*Fr,Fb[1]=(-Fn*Fe+Ff*Fm)*Fr,Fb[2]=(Fi*Fe-Ff*Fh)*Fr,Fb[3]=Fp*Fr,Fb[4]=(Fn*Fd-Ff*Fj)*Fr,Fb[5]=(-Fi*Fd+Ff*Fg)*Fr,Fb[6]=Fq*Fr,Fb[7]=(-Fm*Fd+Fe*Fj)*Fr,Fb[8]=(Fh*Fd-Fe*Fg)*Fr},Fa.transpose=function(Fa){var Fb=Fa.elements,Fc=this.elements;if(Fa===this){var Fd=Fc[1],Fe=Fc[2],Ff=Fc[5];Fb[1]=Fc[3],Fb[2]=Fc[6],Fb[3]=Fd,Fb[5]=Fc[7],Fb[6]=Fe,Fb[7]=Ff}else Fb[0]=Fc[0],Fb[1]=Fc[3],Fb[2]=Fc[6],Fb[3]=Fc[1],Fb[4]=Fc[4],Fb[5]=Fc[7],Fb[6]=Fc[2],Fb[7]=Fc[5],Fb[8]=Fc[8]},Fa.identity=function(){var Fa=this.elements;Fa[0]=1,Fa[1]=0,Fa[2]=0,Fa[3]=0,Fa[4]=1,Fa[5]=0,Fa[6]=0,Fa[7]=0,Fa[8]=1},Fa.cloneTo=function(Fa){var Fb,Fc,Fd;if((Fc=this.elements)!==(Fd=Fa.elements))for(Fb=0;Fb<9;++Fb)Fd[Fb]=Fc[Fb]},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fi.createFromTranslation=function(Fa,Fb){Fb.elements;var Fc=Fa.elements;Fb[0]=1,Fb[1]=0,Fb[2]=0,Fb[3]=0,Fb[4]=1,Fb[5]=0,Fb[6]=Fc[0],Fb[7]=Fc[1],Fb[8]=1},Fi.createFromRotation=function(Fa,Fb){var Fc=Fb.elements,Fd=Math.sin(Fa),Fe=Math.cos(Fa);Fc[0]=Fe,Fc[1]=Fd,Fc[2]=0,Fc[3]=-Fd,Fc[4]=Fe,Fc[5]=0,Fc[6]=0,Fc[7]=0,Fc[8]=1},Fi.createFromScaling=function(Fa,Fb){var Fc=Fb.elements,Fd=Fa.elements;Fc[0]=Fd[0],Fc[1]=0,Fc[2]=0,Fc[3]=0,Fc[4]=Fd[1],Fc[5]=0,Fc[6]=0,Fc[7]=0,Fc[8]=1},Fi.createFromMatrix4x4=function(Fa,Fb){Fb[0]=Fa[0],Fb[1]=Fa[1],Fb[2]=Fa[2],Fb[3]=Fa[4],Fb[4]=Fa[5],Fb[5]=Fa[6],Fb[6]=Fa[8],Fb[7]=Fa[9],Fb[8]=Fa[10]},Fi.multiply=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements,Fg=Fe[0],Fh=Fe[1],Fi=Fe[2],Fj=Fe[3],Fm=Fe[4],Fn=Fe[5],Fo=Fe[6],Fp=Fe[7],Fq=Fe[8],Fr=Ff[0],Fs=Ff[1],Ft=Ff[2],Fu=Ff[3],Fv=Ff[4],Fw=Ff[5],Fx=Ff[6],Fy=Ff[7],Fz=Ff[8];Fd[0]=Fr*Fg+Fs*Fj+Ft*Fo,Fd[1]=Fr*Fh+Fs*Fm+Ft*Fp,Fd[2]=Fr*Fi+Fs*Fn+Ft*Fq,Fd[3]=Fu*Fg+Fv*Fj+Fw*Fo,Fd[4]=Fu*Fh+Fv*Fm+Fw*Fp,Fd[5]=Fu*Fi+Fv*Fn+Fw*Fq,Fd[6]=Fx*Fg+Fy*Fj+Fz*Fo,Fd[7]=Fx*Fh+Fy*Fm+Fz*Fp,Fd[8]=Fx*Fi+Fy*Fn+Fz*Fq},Fi.lookAt=function(Fa,Fb,Fc,Fd){Fgb.subtract(Fa,Fb,Fi._tempV30),Fgb.normalize(Fi._tempV30,Fi._tempV30),Fgb.cross(Fc,Fi._tempV30,Fi._tempV31),Fgb.normalize(Fi._tempV31,Fi._tempV31),Fgb.cross(Fi._tempV30,Fi._tempV31,Fi._tempV32);var Fe=Fi._tempV30.elements,Ff=Fi._tempV31.elements,Fg=Fi._tempV32.elements,Fh=Fd.elements;Fh[0]=Ff[0],Fh[3]=Ff[1],Fh[6]=Ff[2],Fh[1]=Fg[0],Fh[4]=Fg[1],Fh[7]=Fg[2],Fh[2]=Fe[0],Fh[5]=Fe[1],Fh[8]=Fe[2]},Fi.DEFAULT=new Fi,Fn(Fi,["_tempV30",function(){return this._tempV30=new Fgb},"_tempV31",function(){return this._tempV31=new Fgb},"_tempV32",function(){return this._tempV32=new Fgb}]),Fi}(),Fab=function(){function FB(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn,Fo,Fp,Fq,Fr){void 0===Fa&&(Fa=1),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=1),void 0===Fg&&(Fg=0),void 0===Fh&&(Fh=0),void 0===Fi&&(Fi=0),void 0===Fj&&(Fj=0),void 0===Fm&&(Fm=1),void 0===Fn&&(Fn=0),void 0===Fo&&(Fo=0),void 0===Fp&&(Fp=0),void 0===Fq&&(Fq=0),void 0===Fr&&(Fr=1);var Fs=this.elements=new Float32Array(16);Fs[0]=Fa,Fs[1]=Fb,Fs[2]=Fc,Fs[3]=Fd,Fs[4]=Fe,Fs[5]=Ff,Fs[6]=Fg,Fs[7]=Fh,Fs[8]=Fi,Fs[9]=Fj,Fs[10]=Fm,Fs[11]=Fn,Fs[12]=Fo,Fs[13]=Fp,Fs[14]=Fq,Fs[15]=Fr}Fp(FB,"laya.d3.math.Matrix4x4");var Fa=FB.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.getElementByRowColumn=function(Fa,Fb){if(Fa<0||3<Fa)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Fb<0||3<Fb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*Fa+Fb]},Fa.setElementByRowColumn=function(Fa,Fb,Fc){if(Fa<0||3<Fa)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Fb<0||3<Fb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*Fa+Fb]=Fc},Fa.equalsOtherMatrix=function(Fa){var Fb=this.elements,Fc=Fa.elements;return Fka.nearEqual(Fb[0],Fc[0])&&Fka.nearEqual(Fb[1],Fc[1])&&Fka.nearEqual(Fb[2],Fc[2])&&Fka.nearEqual(Fb[3],Fc[3])&&Fka.nearEqual(Fb[4],Fc[4])&&Fka.nearEqual(Fb[5],Fc[5])&&Fka.nearEqual(Fb[6],Fc[6])&&Fka.nearEqual(Fb[7],Fc[7])&&Fka.nearEqual(Fb[8],Fc[8])&&Fka.nearEqual(Fb[9],Fc[9])&&Fka.nearEqual(Fb[10],Fc[10])&&Fka.nearEqual(Fb[11],Fc[11])&&Fka.nearEqual(Fb[12],Fc[12])&&Fka.nearEqual(Fb[13],Fc[13])&&Fka.nearEqual(Fb[14],Fc[14])&&Fka.nearEqual(Fb[15],Fc[15])},Fa.decomposeTransRotScale=function(Fa,Fb,Fc){var Fd=FB._tempMatrix4x4;return this.decomposeTransRotMatScale(Fa,Fd,Fc)?(Fcb.createFromMatrix4x4(Fd,Fb),!0):(Fb.identity(),!1)},Fa.decomposeTransRotMatScale=function(Fa,Fb,Fc){var Fd=this.elements,Fe=Fa.elements,Ff=Fb.elements,Fg=Fc.elements;Fe[0]=Fd[12],Fe[1]=Fd[13],Fe[2]=Fd[14];var Fh=Fd[0],Fi=Fd[1],Fj=Fd[2],Fm=Fd[4],Fn=Fd[5],Fo=Fd[6],Fp=Fd[8],Fq=Fd[9],Fr=Fd[10],Fs=Fg[0]=Math.sqrt(Fh*Fh+Fi*Fi+Fj*Fj),Ft=Fg[1]=Math.sqrt(Fm*Fm+Fn*Fn+Fo*Fo),Fu=Fg[2]=Math.sqrt(Fp*Fp+Fq*Fq+Fr*Fr);if(Fka.isZero(Fs)||Fka.isZero(Ft)||Fka.isZero(Fu))return Ff[1]=Ff[2]=Ff[3]=Ff[4]=Ff[6]=Ff[7]=Ff[8]=Ff[9]=Ff[11]=Ff[12]=Ff[13]=Ff[14]=0,Ff[0]=Ff[5]=Ff[10]=Ff[15]=1,!1;var Fv=FB._tempVector0,Fw=Fv.elements;Fw[0]=Fp/Fu,Fw[1]=Fq/Fu,Fw[2]=Fr/Fu;var Fx=FB._tempVector1,Fy=Fx.elements;Fy[0]=Fh/Fs,Fy[1]=Fi/Fs,Fy[2]=Fj/Fs;var Fz=FB._tempVector2;Fgb.cross(Fv,Fx,Fz);var FA=FB._tempVector1;return Fgb.cross(Fz,Fv,FA),Ff[3]=Ff[7]=Ff[11]=Ff[12]=Ff[13]=Ff[14]=0,Ff[15]=1,Ff[0]=FA.x,Ff[1]=FA.y,Ff[2]=FA.z,Ff[4]=Fz.x,Ff[5]=Fz.y,Ff[6]=Fz.z,Ff[8]=Fv.x,Ff[9]=Fv.y,Ff[10]=Fv.z,Ff[0]*Fh+Ff[1]*Fi+Ff[2]*Fj<0&&(Fg[0]=-Fs),Ff[4]*Fm+Ff[5]*Fn+Ff[6]*Fo<0&&(Fg[1]=-Ft),Ff[8]*Fp+Ff[9]*Fq+Ff[10]*Fr<0&&(Fg[2]=-Fu),!0},Fa.decomposeYawPitchRoll=function(Fa){var Fb=Fa.elements,Fc=Math.asin(-this.elements[9]);Fb[1]=Fc,Math.cos(Fc)>Fka.zeroTolerance?(Fb[2]=Math.atan2(this.elements[1],this.elements[5]),Fb[0]=Math.atan2(this.elements[8],this.elements[10])):(Fb[2]=Math.atan2(-this.elements[4],this.elements[0]),Fb[0]=0)},Fa.normalize=function(){var Fa=this.elements,Fb=Fa[0],Fc=Fa[1],Fd=Fa[2],Fe=Math.sqrt(Fb*Fb+Fc*Fc+Fd*Fd);if(!Fe)return Fa[0]=0,Fa[1]=0,void(Fa[2]=0);1!=Fe&&(Fe=1/Fe,Fa[0]=Fb*Fe,Fa[1]=Fc*Fe,Fa[2]=Fd*Fe)},Fa.transpose=function(){var Fa,Fb;return Fb=(Fa=this.elements)[1],Fa[1]=Fa[4],Fa[4]=Fb,Fb=Fa[2],Fa[2]=Fa[8],Fa[8]=Fb,Fb=Fa[3],Fa[3]=Fa[12],Fa[12]=Fb,Fb=Fa[6],Fa[6]=Fa[9],Fa[9]=Fb,Fb=Fa[7],Fa[7]=Fa[13],Fa[13]=Fb,Fb=Fa[11],Fa[11]=Fa[14],Fa[14]=Fb,this},Fa.invert=function(Fa){var Fb=this.elements,Fc=Fa.elements,Fd=Fb[0],Fe=Fb[1],Ff=Fb[2],Fg=Fb[3],Fh=Fb[4],Fi=Fb[5],Fj=Fb[6],Fm=Fb[7],Fn=Fb[8],Fo=Fb[9],Fp=Fb[10],Fq=Fb[11],Fr=Fb[12],Fs=Fb[13],Ft=Fb[14],Fu=Fb[15],Fv=Fd*Fi-Fe*Fh,Fw=Fd*Fj-Ff*Fh,Fx=Fd*Fm-Fg*Fh,Fy=Fe*Fj-Ff*Fi,Fz=Fe*Fm-Fg*Fi,FA=Ff*Fm-Fg*Fj,FB=Fn*Fs-Fo*Fr,FC=Fn*Ft-Fp*Fr,FD=Fn*Fu-Fq*Fr,FE=Fo*Ft-Fp*Fs,FF=Fo*Fu-Fq*Fs,FG=Fp*Fu-Fq*Ft,FH=Fv*FG-Fw*FF+Fx*FE+Fy*FD-Fz*FC+FA*FB;0!==Math.abs(FH)&&(FH=1/FH,Fc[0]=(Fi*FG-Fj*FF+Fm*FE)*FH,Fc[1]=(Ff*FF-Fe*FG-Fg*FE)*FH,Fc[2]=(Fs*FA-Ft*Fz+Fu*Fy)*FH,Fc[3]=(Fp*Fz-Fo*FA-Fq*Fy)*FH,Fc[4]=(Fj*FD-Fh*FG-Fm*FC)*FH,Fc[5]=(Fd*FG-Ff*FD+Fg*FC)*FH,Fc[6]=(Ft*Fx-Fr*FA-Fu*Fw)*FH,Fc[7]=(Fn*FA-Fp*Fx+Fq*Fw)*FH,Fc[8]=(Fh*FF-Fi*FD+Fm*FB)*FH,Fc[9]=(Fe*FD-Fd*FF-Fg*FB)*FH,Fc[10]=(Fr*Fz-Fs*Fx+Fu*Fv)*FH,Fc[11]=(Fo*Fx-Fn*Fz-Fq*Fv)*FH,Fc[12]=(Fi*FC-Fh*FE-Fj*FB)*FH,Fc[13]=(Fd*FE-Fe*FC+Ff*FB)*FH,Fc[14]=(Fs*Fw-Fr*Fy-Ft*Fv)*FH,Fc[15]=(Fn*Fy-Fo*Fw+Fp*Fv)*FH)},Fa.identity=function(){var Fa=this.elements;Fa[1]=Fa[2]=Fa[3]=Fa[4]=Fa[6]=Fa[7]=Fa[8]=Fa[9]=Fa[11]=Fa[12]=Fa[13]=Fa[14]=0,Fa[0]=Fa[5]=Fa[10]=Fa[15]=1},Fa.cloneTo=function(Fa){var Fb,Fc,Fd;if((Fc=this.elements)!==(Fd=Fa.elements))for(Fb=0;Fb<16;++Fb)Fd[Fb]=Fc[Fb]},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fa.getTranslationVector=function(Fa){var Fb=this.elements,Fc=Fa.elements;Fc[0]=Fb[12],Fc[1]=Fb[13],Fc[2]=Fb[14]},Fa.setTranslationVector=function(Fa){var Fb=this.elements,Fc=Fa.elements;Fb[12]=Fc[0],Fb[13]=Fc[1],Fb[14]=Fc[2]},Fa.getForward=function(Fa){var Fb=this.elements,Fc=Fa.elements;Fc[0]=-Fb[8],Fc[1]=-Fb[9],Fc[2]=-Fb[10]},Fa.setForward=function(Fa){var Fb=this.elements,Fc=Fa.elements;Fb[8]=-Fc[0],Fb[9]=-Fc[1],Fb[10]=-Fc[2]},FB.createRotationX=function(Fa,Fb){var Fc=Fb.elements,Fd=Math.sin(Fa),Fe=Math.cos(Fa);Fc[1]=Fc[2]=Fc[3]=Fc[4]=Fc[7]=Fc[8]=Fc[11]=Fc[12]=Fc[13]=Fc[14]=0,Fc[0]=Fc[15]=1,Fc[5]=Fc[10]=Fe,Fc[6]=Fd,Fc[9]=-Fd},FB.createRotationY=function(Fa,Fb){var Fc=Fb.elements,Fd=Math.sin(Fa),Fe=Math.cos(Fa);Fc[1]=Fc[3]=Fc[4]=Fc[6]=Fc[7]=Fc[9]=Fc[11]=Fc[12]=Fc[13]=Fc[14]=0,Fc[5]=Fc[15]=1,Fc[0]=Fc[10]=Fe,Fc[2]=-Fd,Fc[8]=Fd},FB.createRotationZ=function(Fa,Fb){var Fc=Fb.elements,Fd=Math.sin(Fa),Fe=Math.cos(Fa);Fc[2]=Fc[3]=Fc[6]=Fc[7]=Fc[8]=Fc[9]=Fc[11]=Fc[12]=Fc[13]=Fc[14]=0,Fc[10]=Fc[15]=1,Fc[0]=Fc[5]=Fe,Fc[1]=Fd,Fc[4]=-Fd},FB.createRotationYawPitchRoll=function(Fa,Fb,Fc,Fd){Fcb.createFromYawPitchRoll(Fa,Fb,Fc,FB._tempQuaternion),FB.createRotationQuaternion(FB._tempQuaternion,Fd)},FB.createRotationAxis=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Math.cos(Fb),Fi=Math.sin(Fb),Fj=Fe*Fe,Fm=Ff*Ff,Fn=Fg*Fg,Fo=Fe*Ff,Fp=Fe*Fg,Fq=Ff*Fg,Fr=Fc.elements;Fr[3]=Fr[7]=Fr[11]=Fr[12]=Fr[13]=Fr[14]=0,Fr[15]=1,Fr[0]=Fj+Fh*(1-Fj),Fr[1]=Fo-Fh*Fo+Fi*Fg,Fr[2]=Fp-Fh*Fp-Fi*Ff,Fr[4]=Fo-Fh*Fo-Fi*Fg,Fr[5]=Fm+Fh*(1-Fm),Fr[6]=Fq-Fh*Fq+Fi*Fe,Fr[8]=Fp-Fh*Fp+Fi*Ff,Fr[9]=Fq-Fh*Fq-Fi*Fe,Fr[10]=Fn+Fh*(1-Fn)},FB.createRotationQuaternion=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fc[0],Ff=Fc[1],Fg=Fc[2],Fh=Fc[3],Fi=Fe*Fe,Fj=Ff*Ff,Fm=Fg*Fg,Fn=Fe*Ff,Fo=Fg*Fh,Fp=Fg*Fe,Fq=Ff*Fh,Fr=Ff*Fg,Fs=Fe*Fh;Fd[3]=Fd[7]=Fd[11]=Fd[12]=Fd[13]=Fd[14]=0,Fd[15]=1,Fd[0]=1-2*(Fj+Fm),Fd[1]=2*(Fn+Fo),Fd[2]=2*(Fp-Fq),Fd[4]=2*(Fn-Fo),Fd[5]=1-2*(Fm+Fi),Fd[6]=2*(Fr+Fs),Fd[8]=2*(Fp+Fq),Fd[9]=2*(Fr-Fs),Fd[10]=1-2*(Fj+Fi)},FB.createTranslate=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;Fd[4]=Fd[8]=Fd[1]=Fd[9]=Fd[2]=Fd[6]=Fd[3]=Fd[7]=Fd[11]=0,Fd[0]=Fd[5]=Fd[10]=Fd[15]=1,Fd[12]=Fc[0],Fd[13]=Fc[1],Fd[14]=Fc[2]},FB.createScaling=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;Fd[0]=Fc[0],Fd[5]=Fc[1],Fd[10]=Fc[2],Fd[1]=Fd[4]=Fd[8]=Fd[12]=Fd[9]=Fd[13]=Fd[2]=Fd[6]=Fd[14]=Fd[3]=Fd[7]=Fd[11]=0,Fd[15]=1},FB.multiply=function(Fa,Fb,Fc){var Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm;for(Fe=Fc.elements,Ff=Fa.elements,Fe===(Fg=Fb.elements)&&(Fg=Fg.slice()),Fd=0;Fd<4;Fd++)Fh=Ff[Fd],Fi=Ff[Fd+4],Fj=Ff[Fd+8],Fm=Ff[Fd+12],Fe[Fd]=Fh*Fg[0]+Fi*Fg[1]+Fj*Fg[2]+Fm*Fg[3],Fe[Fd+4]=Fh*Fg[4]+Fi*Fg[5]+Fj*Fg[6]+Fm*Fg[7],Fe[Fd+8]=Fh*Fg[8]+Fi*Fg[9]+Fj*Fg[10]+Fm*Fg[11],Fe[Fd+12]=Fh*Fg[12]+Fi*Fg[13]+Fj*Fg[14]+Fm*Fg[15]},FB.createFromQuaternion=function(Fa,Fb){var Fc=Fb.elements,Fd=Fa.elements,Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fd[3],Fi=Fe+Fe,Fj=Ff+Ff,Fm=Fg+Fg,Fn=Fe*Fi,Fo=Ff*Fi,Fp=Ff*Fj,Fq=Fg*Fi,Fr=Fg*Fj,Fs=Fg*Fm,Ft=Fh*Fi,Fu=Fh*Fj,Fv=Fh*Fm;Fc[0]=1-Fp-Fs,Fc[1]=Fo+Fv,Fc[2]=Fq-Fu,Fc[3]=0,Fc[4]=Fo-Fv,Fc[5]=1-Fn-Fs,Fc[6]=Fr+Ft,Fc[7]=0,Fc[8]=Fq+Fu,Fc[9]=Fr-Ft,Fc[10]=1-Fn-Fp,Fc[11]=0,Fc[12]=0,Fc[13]=0,Fc[14]=0,Fc[15]=1},FB.createAffineTransformation=function(Fa,Fb,Fc,Fd){var Fe=Fa.elements,Ff=Fb.elements,Fg=Fc.elements,Fh=Fd.elements,Fi=Ff[0],Fj=Ff[1],Fm=Ff[2],Fn=Ff[3],Fo=Fi+Fi,Fp=Fj+Fj,Fq=Fm+Fm,Fr=Fi*Fo,Fs=Fi*Fp,Ft=Fi*Fq,Fu=Fj*Fp,Fv=Fj*Fq,Fw=Fm*Fq,Fx=Fn*Fo,Fy=Fn*Fp,Fz=Fn*Fq,FA=Fg[0],FB=Fg[1],FC=Fg[2];Fh[0]=(1-(Fu+Fw))*FA,Fh[1]=(Fs+Fz)*FA,Fh[2]=(Ft-Fy)*FA,Fh[3]=0,Fh[4]=(Fs-Fz)*FB,Fh[5]=(1-(Fr+Fw))*FB,Fh[6]=(Fv+Fx)*FB,Fh[7]=0,Fh[8]=(Ft+Fy)*FC,Fh[9]=(Fv-Fx)*FC,Fh[10]=(1-(Fr+Fu))*FC,Fh[11]=0,Fh[12]=Fe[0],Fh[13]=Fe[1],Fh[14]=Fe[2],Fh[15]=1},FB.createLookAt=function(Fa,Fb,Fc,Fd){var Fe=Fd.elements,Ff=FB._tempVector0,Fg=FB._tempVector1,Fh=FB._tempVector2;Fgb.subtract(Fa,Fb,Fh),Fgb.normalize(Fh,Fh),Fgb.cross(Fc,Fh,Ff),Fgb.normalize(Ff,Ff),Fgb.cross(Fh,Ff,Fg),Fd.identity(),Fe[0]=Ff.x,Fe[4]=Ff.y,Fe[8]=Ff.z,Fe[1]=Fg.x,Fe[5]=Fg.y,Fe[9]=Fg.z,Fe[2]=Fh.x,Fe[6]=Fh.y,Fe[10]=Fh.z,Fe[12]=-Fgb.dot(Ff,Fa),Fe[13]=-Fgb.dot(Fg,Fa),Fe[14]=-Fgb.dot(Fh,Fa)},FB.createPerspective=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fe.elements,Fg=1/Math.tan(Fa/2),Fh=1/(Fc-Fd);Ff[0]=Fg/Fb,Ff[5]=Fg,Ff[10]=(Fd+Fc)*Fh,Ff[11]=-1,Ff[14]=2*Fd*Fc*Fh,Ff[1]=Ff[2]=Ff[3]=Ff[4]=Ff[6]=Ff[7]=Ff[8]=Ff[9]=Ff[12]=Ff[13]=Ff[15]=0},FB.createOrthoOffCenterRH=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){var Fh=Fg.elements,Fi=1/(Fa-Fb),Fj=1/(Fc-Fd),Fm=1/(Fe-Ff);Fh[1]=Fh[2]=Fh[3]=Fh[4]=Fh[6]=Fh[7]=Fh[8]=Fh[9]=Fh[11]=0,Fh[15]=1,Fh[0]=-2*Fi,Fh[5]=-2*Fj,Fh[10]=2*Fm,Fh[12]=(Fa+Fb)*Fi,Fh[13]=(Fd+Fc)*Fj,Fh[14]=(Ff+Fe)*Fm},FB.translation=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;Fd[0]=Fd[5]=Fd[10]=Fd[15]=1,Fd[12]=Fc[0],Fd[13]=Fc[1],Fd[14]=Fc[2]},Fn(FB,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new FB},"_tempVector0",function(){return this._tempVector0=new Fgb},"_tempVector1",function(){return this._tempVector1=new Fgb},"_tempVector2",function(){return this._tempVector2=new Fgb},"_tempQuaternion",function(){return this._tempQuaternion=new Fcb},"DEFAULT",function(){return this.DEFAULT=new FB},"ZERO",function(){return this.ZERO=new FB(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),FB}(),Fbb=(function(){function Fv(Fa,Fb){this.extents=null,this.transformation=null,this.extents=Fa,this.transformation=Fb}Fp(Fv,"laya.d3.math.OrientedBoundBox");var Fa=Fv.prototype;Fa.getCorners=function(Fa){var Fb=Fv._tempV30.elements,Fc=Fv._tempV31.elements,Fd=Fv._tempV32.elements,Fe=this.extents.elements;Fb[0]=Fe[0],Fb[1]=Fb[2]=0,Fc[1]=Fe[1],Fc[0]=Fc[2]=0,Fd[2]=Fe[2],Fd[0]=Fd[1]=0,Fgb.TransformNormal(Fv._tempV30,this.transformation,Fv._tempV30),Fgb.TransformNormal(Fv._tempV31,this.transformation,Fv._tempV31),Fgb.TransformNormal(Fv._tempV32,this.transformation,Fv._tempV32);var Ff=Fv._tempV33;this.transformation.getTranslationVector(Ff),Fa.length=8,Fgb.add(Ff,Fv._tempV30,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV32,Fa[0]),Fgb.add(Ff,Fv._tempV30,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV32,Fa[1]),Fgb.subtract(Ff,Fv._tempV30,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV32,Fa[2]),Fgb.subtract(Ff,Fv._tempV30,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV32,Fa[3]),Fgb.add(Ff,Fv._tempV30,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV32,Fa[4]),Fgb.add(Ff,Fv._tempV30,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV32,Fa[5]),Fgb.subtract(Ff,Fv._tempV30,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV32,Fa[6]),Fgb.subtract(Ff,Fv._tempV30,Fv._tempV34),Fgb.subtract(Fv._tempV34,Fv._tempV31,Fv._tempV34),Fgb.add(Fv._tempV34,Fv._tempV32,Fa[7])},Fa.transform=function(Fa){Fab.multiply(this.transformation,Fa,this.transformation)},Fa.scale=function(Fa){Fgb.multiply(this.extents,Fa,this.extents)},Fa.translate=function(Fa){this.transformation.getTranslationVector(Fv._tempV30),Fgb.add(Fv._tempV30,Fa,Fv._tempV31),this.transformation.setTranslationVector(Fv._tempV31)},Fa.Size=function(Fa){Fgb.scale(this.extents,2,Fa)},Fa.getSize=function(Fa){var Fb=this.extents.elements;Fv._tempV30.x=Fb[0],Fv._tempV31.y=Fb[1],Fv._tempV32.z=Fb[2],Fgb.TransformNormal(Fv._tempV30,this.transformation,Fv._tempV30),Fgb.TransformNormal(Fv._tempV31,this.transformation,Fv._tempV31),Fgb.TransformNormal(Fv._tempV31,this.transformation,Fv._tempV32);var Fc=Fa.elements;Fc[0]=Fgb.scalarLength(Fv._tempV30),Fc[1]=Fgb.scalarLength(Fv._tempV31),Fc[2]=Fgb.scalarLength(Fv._tempV32)},Fa.getSizeSquared=function(Fa){var Fb=this.extents.elements;Fv._tempV30.x=Fb[0],Fv._tempV31.y=Fb[1],Fv._tempV32.z=Fb[2],Fgb.TransformNormal(Fv._tempV30,this.transformation,Fv._tempV30),Fgb.TransformNormal(Fv._tempV31,this.transformation,Fv._tempV31),Fgb.TransformNormal(Fv._tempV31,this.transformation,Fv._tempV32);var Fc=Fa.elements;Fc[0]=Fgb.scalarLengthSquared(Fv._tempV30),Fc[1]=Fgb.scalarLengthSquared(Fv._tempV31),Fc[2]=Fgb.scalarLengthSquared(Fv._tempV32)},Fa.getCenter=function(Fa){this.transformation.getTranslationVector(Fa)},Fa.containsPoint=function(Fa){var Fb=this.extents.elements,Fc=Fb[0],Fd=Fb[1],Fe=Fb[2];this.transformation.invert(Fv._tempM0),Fgb.transformCoordinate(Fa,Fv._tempM0,Fv._tempV30);var Ff=Fv._tempV30.elements,Fg=Math.abs(Ff[0]),Fh=Math.abs(Ff[1]),Fi=Math.abs(Ff[2]);return Fka.nearEqual(Fg,Fc)&&Fka.nearEqual(Fh,Fd)&&Fka.nearEqual(Fi,Fe)?2:Fg<Fc&&Fh<Fd&&Fi<Fe?1:0},Fa.containsPoints=function(Fa){var Fb=this.extents.elements,Fc=Fb[0],Fd=Fb[1],Fe=Fb[2];this.transformation.invert(Fv._tempM0);for(var Ff=!0,Fg=!1,Fh=0;Fh<Fa.length;Fh++){Fgb.transformCoordinate(Fa[Fh],Fv._tempM0,Fv._tempV30);var Fi=Fv._tempV30.elements,Fj=Math.abs(Fi[0]),Fm=Math.abs(Fi[1]),Fn=Math.abs(Fi[2]);Fka.nearEqual(Fj,Fc)&&Fka.nearEqual(Fm,Fd)&&Fka.nearEqual(Fn,Fe)&&(Fg=!0),Fj<Fc&&Fm<Fd&&Fn<Fe?Fg=!0:Ff=!1}return Ff?1:Fg?2:0},Fa.containsSphere=function(Fa,Fb){void 0===Fb&&(Fb=!1);var Fc=this.extents.elements,Fd=Fc[0],Fe=Fc[1],Ff=Fc[2],Fg=Fa.radius;this.transformation.invert(Fv._tempM0),Fgb.transformCoordinate(Fa.center,Fv._tempM0,Fv._tempV30);var Fh=NaN;if(Fh=Fb?Fg:(Fgb.scale(Fgb.UnitX,Fg,Fv._tempV31),Fgb.TransformNormal(Fv._tempV31,Fv._tempM0,Fv._tempV31),Fgb.scalarLength(Fv._tempV31)),Fgb.scale(this.extents,-1,Fv._tempV32),Fgb.Clamp(Fv._tempV30,Fv._tempV32,this.extents,Fv._tempV33),Fh*Fh<Fgb.distanceSquared(Fv._tempV30,Fv._tempV33))return 0;var Fi=Fv._tempV30.elements,Fj=Fi[0],Fm=Fi[1],Fn=Fi[2],Fo=Fv._tempV32.elements,Fp=Fo[0],Fq=Fo[1],Fr=Fo[2];return Fp+Fh<=Fj&&Fj<=Fd-Fh&&Fh<Fd-Fp&&Fq+Fh<=Fm&&Fm<=Fe-Fh&&Fh<Fe-Fq&&Fr+Fh<=Fn&&Fn<=Ff-Fh&&Fh<Ff-Fr?1:2},Fa.containsOrientedBoundBox=function(Fa){var Fb=0,Fc=0;Fa.getCorners(Fv._corners);var Fd=this.containsPoints(Fv._corners);if(0!=Fd)return Fd;var Fe=this.extents.elements;Fa.extents.cloneTo(Fv._tempV35);var Ff=Fv._tempV35.elements;Fv._getRows(this.transformation,Fv._rows1),Fv._getRows(Fa.transformation,Fv._rows2);var Fg=NaN;for(Fb=0;Fb<4;Fb++)for(Fc=0;Fc<4;Fc++)3==Fb||3==Fc?(Fv._tempM0.setElementByRowColumn(Fb,Fc,0),Fv._tempM1.setElementByRowColumn(Fb,Fc,0)):(Fg=Fgb.dot(Fv._rows1[Fb],Fv._rows2[Fc]),Fv._tempM0.setElementByRowColumn(Fb,Fc,Fg),Fv._tempM1.setElementByRowColumn(Fb,Fc,Math.abs(Fg)));Fa.getCenter(Fv._tempV34),this.getCenter(Fv._tempV36),Fgb.subtract(Fv._tempV34,Fv._tempV36,Fv._tempV30);var Fh=Fv._tempV31.elements;Fh[0]=Fgb.dot(Fv._tempV30,Fv._rows1[0]),Fh[1]=Fgb.dot(Fv._tempV30,Fv._rows1[1]),Fh[2]=Fgb.dot(Fv._tempV30,Fv._rows1[2]);var Fi=Fv._tempV32.elements,Fj=Fv._tempV33.elements;for(Fb=0;Fb<3;Fb++)if(Fi[0]=Fv._tempM1.getElementByRowColumn(Fb,0),Fi[1]=Fv._tempM1.getElementByRowColumn(Fb,1),Fi[2]=Fv._tempM1.getElementByRowColumn(Fb,2),Fe[Fb]+Fgb.dot(Fv._tempV35,Fv._tempV32)<Math.abs(Fh[Fb]))return 0;for(Fc=0;Fc<3;Fc++)if(Fi[0]=Fv._tempM1.getElementByRowColumn(0,Fc),Fi[1]=Fv._tempM1.getElementByRowColumn(1,Fc),Fi[2]=Fv._tempM1.getElementByRowColumn(2,Fc),Fj[0]=Fv._tempM0.getElementByRowColumn(0,Fc),Fj[1]=Fv._tempM0.getElementByRowColumn(1,Fc),Fj[2]=Fv._tempM0.getElementByRowColumn(2,Fc),Fgb.dot(this.extents,Fv._tempV32)+Ff[Fc]<Math.abs(Fgb.dot(Fv._tempV31,Fv._tempV33)))return 0;for(Fb=0;Fb<3;Fb++)for(Fc=0;Fc<3;Fc++){var Fm=(Fb+1)%3,Fn=(Fb+2)%3,Fo=(Fc+1)%3,Fp=(Fc+2)%3;if(Fe[Fm]*Fv._tempM1.getElementByRowColumn(Fn,Fc)+Fe[Fn]*Fv._tempM1.getElementByRowColumn(Fm,Fc)+(Ff[Fo]*Fv._tempM1.getElementByRowColumn(Fb,Fp)+Ff[Fp]*Fv._tempM1.getElementByRowColumn(Fb,Fo))<Math.abs(Fh[Fn]*Fv._tempM0.getElementByRowColumn(Fm,Fc)-Fh[Fm]*Fv._tempM0.getElementByRowColumn(Fn,Fc)))return 0}return 2},Fa.containsLine=function(Fa,Fb){Fv._corners[0]=Fa,Fv._corners[1]=Fb;var Fc=this.containsPoints(Fv._corners);if(0!=Fc)return Fc;var Fd=this.extents.elements,Fe=Fd[0],Ff=Fd[1],Fg=Fd[2];this.transformation.invert(Fv._tempM0),Fgb.transformCoordinate(Fa,Fv._tempM0,Fv._tempV30),Fgb.transformCoordinate(Fb,Fv._tempM0,Fv._tempV31),Fgb.add(Fv._tempV30,Fv._tempV31,Fv._tempV32),Fgb.scale(Fv._tempV32,.5,Fv._tempV32),Fgb.subtract(Fv._tempV30,Fv._tempV32,Fv._tempV33);var Fh=Fv._tempV33.elements,Fi=Fh[0],Fj=Fh[1],Fm=Fh[2],Fn=Fv._tempV34.elements,Fo=Fn[0]=Math.abs(Fh[0]),Fp=Fn[1]=Math.abs(Fh[1]),Fq=Fn[2]=Math.abs(Fh[2]),Fr=Fv._tempV32.elements,Fs=Fr[0],Ft=Fr[1],Fu=Fr[2];return Math.abs(Fs)>Fe+Fo?0:Math.abs(Ft)>Ff+Fp?0:Math.abs(Fu)>Fg+Fq?0:Math.abs(Ft*Fm-Fu*Fj)>Ff*Fq+Fg*Fp?0:Math.abs(Fs*Fm-Fu*Fi)>Fe*Fq+Fg*Fo?0:Math.abs(Fs*Fj-Ft*Fi)>Fe*Fp+Ff*Fo?0:2},Fa.containsBoundBox=function(Fa){var Fb=0,Fc=0,Fd=Fa.min,Fe=Fa.max;Fa.getCorners(Fv._corners);var Ff=this.containsPoints(Fv._corners);if(0!=Ff)return Ff;Fgb.subtract(Fe,Fd,Fv._tempV30),Fgb.scale(Fv._tempV30,.5,Fv._tempV30),Fgb.add(Fd,Fv._tempV30,Fv._tempV30),Fgb.subtract(Fe,Fv._tempV30,Fv._tempV31);var Fg=this.extents.elements,Fh=Fv._tempV31.elements;Fv._getRows(this.transformation,Fv._rows1),this.transformation.invert(Fv._tempM0);for(Fb=0;Fb<3;Fb++)for(Fc=0;Fc<3;Fc++)Fv._tempM1.setElementByRowColumn(Fb,Fc,Math.abs(Fv._tempM0.getElementByRowColumn(Fb,Fc)));this.getCenter(Fv._tempV35),Fgb.subtract(Fv._tempV30,Fv._tempV35,Fv._tempV32);var Fi=Fv._tempV31.elements;Fi[0]=Fgb.dot(Fv._tempV32,Fv._rows1[0]),Fi[1]=Fgb.dot(Fv._tempV32,Fv._rows1[1]),Fi[2]=Fgb.dot(Fv._tempV32,Fv._rows1[2]);var Fj=Fv._tempV33.elements,Fm=Fv._tempV34.elements;for(Fb=0;Fb<3;Fb++)if(Fj[0]=Fv._tempM1.getElementByRowColumn(Fb,0),Fj[1]=Fv._tempM1.getElementByRowColumn(Fb,1),Fj[2]=Fv._tempM1.getElementByRowColumn(Fb,2),Fg[Fb]+Fgb.dot(Fv._tempV31,Fv._tempV33)<Math.abs(Fi[Fb]))return 0;for(Fc=0;Fc<3;Fc++)if(Fj[0]=Fv._tempM1.getElementByRowColumn(0,Fc),Fj[1]=Fv._tempM1.getElementByRowColumn(1,Fc),Fj[2]=Fv._tempM1.getElementByRowColumn(2,Fc),Fm[0]=Fv._tempM0.getElementByRowColumn(0,Fc),Fm[1]=Fv._tempM0.getElementByRowColumn(1,Fc),Fm[2]=Fv._tempM0.getElementByRowColumn(2,Fc),Fgb.dot(this.extents,Fv._tempV33)+Fh[Fc]<Math.abs(Fgb.dot(Fv._tempV31,Fv._tempV34)))return 0;for(Fb=0;Fb<3;Fb++)for(Fc=0;Fc<3;Fc++){var Fn=(Fb+1)%3,Fo=(Fb+2)%3,Fp=(Fc+1)%3,Fq=(Fc+2)%3;if(Fg[Fn]*Fv._tempM1.getElementByRowColumn(Fo,Fc)+Fg[Fo]*Fv._tempM1.getElementByRowColumn(Fn,Fc)+(Fh[Fp]*Fv._tempM1.getElementByRowColumn(Fb,Fq)+Fh[Fq]*Fv._tempM1.getElementByRowColumn(Fb,Fp))<Math.abs(Fi[Fo]*Fv._tempM0.getElementByRowColumn(Fn,Fc)-Fi[Fn]*Fv._tempM0.getElementByRowColumn(Fo,Fc)))return 0}return 2},Fa.intersectsRay=function(Fa,Fb){Fgb.scale(this.extents,-1,Fv._tempV30),this.transformation.invert(Fv._tempM0),Fgb.TransformNormal(Fa.direction,Fv._tempM0,Fv._ray.direction),Fgb.transformCoordinate(Fa.origin,Fv._tempM0,Fv._ray.origin),Fv._boxBound1.min=Fv._tempV30,Fv._boxBound1.max=this.extents;var Fc=Collision.intersectsRayAndBoxRP(Fv._ray,Fv._boxBound1,Fb);return-1!==Fc&&Fgb.transformCoordinate(Fb,this.transformation,Fb),Fc},Fa._getLocalCorners=function(Fa){Fa.length=8;var Fb=this.extents.elements;Fv._tempV30.x=Fb[0],Fv._tempV31.y=Fb[1],Fv._tempV32.z=Fb[2],Fgb.add(Fv._tempV30,Fv._tempV31,Fv._tempV33),Fgb.add(Fv._tempV33,Fv._tempV32,Fa[0]),Fgb.add(Fv._tempV30,Fv._tempV31,Fv._tempV33),Fgb.subtract(Fv._tempV33,Fv._tempV32,Fa[1]),Fgb.subtract(Fv._tempV31,Fv._tempV30,Fv._tempV33),Fgb.subtract(Fv._tempV33,Fv._tempV30,Fa[2]),Fgb.subtract(Fv._tempV31,Fv._tempV30,Fv._tempV33),Fgb.add(Fv._tempV33,Fv._tempV32,Fa[3]),Fgb.subtract(Fv._tempV30,Fv._tempV31,Fv._tempV33),Fgb.add(Fv._tempV33,Fv._tempV32,Fa[4]),Fgb.subtract(Fv._tempV30,Fv._tempV31,Fv._tempV33),Fgb.subtract(Fv._tempV33,Fv._tempV32,Fa[5]),Fgb.scale(Fa[0],-1,Fa[6]),Fgb.subtract(Fv._tempV32,Fv._tempV30,Fv._tempV33),Fgb.subtract(Fv._tempV33,Fv._tempV31,Fa[7])},Fa.equals=function(Fa){return this.extents==Fa.extents&&this.transformation==Fa.transformation},Fa.cloneTo=function(Fa){var Fb=Fa;this.extents.cloneTo(Fb.extents),this.transformation.cloneTo(Fb.transformation)},Fv.createByBoundBox=function(Fa,Fb){var Fc=Fa.min,Fd=Fa.max;Fgb.subtract(Fd,Fc,Fv._tempV30),Fgb.scale(Fv._tempV30,.5,Fv._tempV30),Fgb.add(Fc,Fv._tempV30,Fv._tempV31),Fgb.subtract(Fd,Fv._tempV31,Fv._tempV32),Fab.translation(Fv._tempV31,Fv._tempM0);var Fe=Fv._tempV32.clone(),Ff=Fv._tempM0.clone();Fb.extents=Fe,Fb.transformation=Ff},Fv.createByMinAndMaxVertex=function(Fa,Fb){return Fgb.subtract(Fb,Fa,Fv._tempV30),Fgb.scale(Fv._tempV30,.5,Fv._tempV30),Fgb.add(Fa,Fv._tempV30,Fv._tempV31),Fgb.subtract(Fb,Fv._tempV31,Fv._tempV32),Fab.translation(Fv._tempV31,Fv._tempM0),new Fv(Fv._tempV32,Fv._tempM0)},Fv._getRows=function(Fa,Fb){Fb.length=3;var Fc=Fa.elements,Fd=Fb[0].elements;Fd[0]=Fc[0],Fd[1]=Fc[1],Fd[2]=Fc[2];var Fe=Fb[1].elements;Fe[0]=Fc[4],Fe[1]=Fc[5],Fe[2]=Fc[6];var Ff=Fb[2].elements;Ff[0]=Fc[8],Ff[1]=Fc[9],Ff[2]=Fc[10]},Fv.getObbtoObbMatrix4x4=function(Fa,Fb,Fc,Fd){var Fe=Fa.transformation,Ff=Fb.transformation;if(Fc){Fv._getRows(Fe,Fv._rows1),Fv._getRows(Ff,Fv._rows2);for(var Fg=0;Fg<3;Fg++)for(var Fh=0;Fh<3;Fh++)Fd.setElementByRowColumn(Fg,Fh,Fgb.dot(Fv._rows2[Fg],Fv._rows1[Fh]));Fb.getCenter(Fv._tempV30),Fa.getCenter(Fv._tempV31),Fgb.subtract(Fv._tempV30,Fv._tempV31,Fv._tempV32);var Fi=Fd.elements;Fi[12]=Fgb.dot(Fv._tempV32,Fv._rows1[0]),Fi[13]=Fgb.dot(Fv._tempV32,Fv._rows1[1]),Fi[14]=Fgb.dot(Fv._tempV32,Fv._rows1[2]),Fi[15]=1}else Fe.invert(Fv._tempM0),Fab.multiply(Ff,Fv._tempM0,Fd)},Fv.merge=function(Fa,Fb,Fc){var Fd=Fa.extents,Fe=Fa.transformation;Fv.getObbtoObbMatrix4x4(Fa,Fb,Fc,Fv._tempM0),Fb._getLocalCorners(Fv._corners),Fgb.transformCoordinate(Fv._corners[0],Fv._tempM0,Fv._corners[0]),Fgb.transformCoordinate(Fv._corners[1],Fv._tempM0,Fv._corners[1]),Fgb.transformCoordinate(Fv._corners[2],Fv._tempM0,Fv._corners[2]),Fgb.transformCoordinate(Fv._corners[3],Fv._tempM0,Fv._corners[3]),Fgb.transformCoordinate(Fv._corners[4],Fv._tempM0,Fv._corners[4]),Fgb.transformCoordinate(Fv._corners[5],Fv._tempM0,Fv._corners[5]),Fgb.transformCoordinate(Fv._corners[6],Fv._tempM0,Fv._corners[6]),Fgb.transformCoordinate(Fv._corners[7],Fv._tempM0,Fv._corners[7]),Fgb.scale(Fd,-1,Fv._boxBound1.min),Fd.cloneTo(Fv._boxBound1.max),FZa.createfromPoints(Fv._corners,Fv._boxBound2),FZa.merge(Fv._boxBound2,Fv._boxBound1,Fv._boxBound3);var Ff=Fv._boxBound3.min,Fg=Fv._boxBound3.max;Fgb.subtract(Fg,Ff,Fv._tempV30),Fgb.scale(Fv._tempV30,.5,Fv._tempV30),Fgb.add(Ff,Fv._tempV30,Fv._tempV32),Fgb.subtract(Fg,Fv._tempV32,Fd),Fgb.transformCoordinate(Fv._tempV32,Fe,Fv._tempV33)},Fn(Fv,["_tempV30",function(){return this._tempV30=new Fgb},"_tempV31",function(){return this._tempV31=new Fgb},"_tempV32",function(){return this._tempV32=new Fgb},"_tempV33",function(){return this._tempV33=new Fgb},"_tempV34",function(){return this._tempV34=new Fgb},"_tempV35",function(){return this._tempV35=new Fgb},"_tempV36",function(){return this._tempV36=new Fgb},"_tempM0",function(){return this._tempM0=new Fab},"_tempM1",function(){return this._tempM1=new Fab},"_corners",function(){return this._corners=[new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb]},"_rows1",function(){return this._rows1=[new Fgb,new Fgb,new Fgb]},"_rows2",function(){return this._rows2=[new Fgb,new Fgb,new Fgb]},"_ray",function(){return this._ray=new Feb(new Fgb,new Fgb)},"_boxBound1",function(){return this._boxBound1=new FZa(new Fgb,new Fgb)},"_boxBound2",function(){return this._boxBound2=new FZa(new Fgb,new Fgb)},"_boxBound3",function(){return this._boxBound3=new FZa(new Fgb,new Fgb)}])}(),function(){function Fx(Fa,Fb){this.normal=null,this.distance=NaN,void 0===Fb&&(Fb=0),this.normal=Fa,this.distance=Fb}return Fp(Fx,"laya.d3.math.Plane"),Fx.prototype.normalize=function(){var Fa=this.normal.elements,Fb=Fa[0],Fc=Fa[1],Fd=Fa[2],Fe=1/Math.sqrt(Fb*Fb+Fc*Fc+Fd*Fd);Fa[0]=Fb*Fe,Fa[1]=Fc*Fe,Fa[2]=Fd*Fe,this.distance*=Fe},Fx.createPlaneBy3P=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fb.elements,Ff=Fc.elements,Fg=Fe[0]-Fd[0],Fh=Fe[1]-Fd[1],Fi=Fe[2]-Fd[2],Fj=Ff[0]-Fd[0],Fm=Ff[1]-Fd[1],Fn=Ff[2]-Fd[2],Fo=Fh*Fn-Fi*Fm,Fp=Fi*Fj-Fg*Fn,Fq=Fg*Fm-Fh*Fj,Fr=1/Math.sqrt(Fo*Fo+Fp*Fp+Fq*Fq),Fs=Fo*Fr,Ft=Fp*Fr,Fu=Fq*Fr,Fv=Fx._TEMPVec3.elements;Fv[0]=Fs,Fv[1]=Ft,Fv[2]=Fu;var Fw=-(Fs*Fd[0]+Ft*Fd[1]+Fu*Fd[2]);return new Fx(Fx._TEMPVec3,Fw)},Fx.PlaneIntersectionType_Back=0,Fx.PlaneIntersectionType_Front=1,Fx.PlaneIntersectionType_Intersecting=2,Fn(Fx,["_TEMPVec3",function(){return this._TEMPVec3=new Fgb}]),Fx}()),Fcb=function(){function Fe(Fa,Fb,Fc,Fd){this.elements=new Float32Array(4),void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=1),this.elements[0]=Fa,this.elements[1]=Fb,this.elements[2]=Fc,this.elements[3]=Fd}Fp(Fe,"laya.d3.math.Quaternion");var Fa=Fe.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.scaling=function(Fa,Fb){var Fc=Fb.elements,Fd=this.elements;Fc[0]=Fd[0]*Fa,Fc[1]=Fd[1]*Fa,Fc[2]=Fd[2]*Fa,Fc[3]=Fd[3]*Fa},Fa.normalize=function(Fa){var Fb=Fa.elements,Fc=this.elements,Fd=Fc[0],Fe=Fc[1],Ff=Fc[2],Fg=Fc[3],Fh=Fd*Fd+Fe*Fe+Ff*Ff+Fg*Fg;0<Fh&&(Fh=1/Math.sqrt(Fh),Fb[0]=Fd*Fh,Fb[1]=Fe*Fh,Fb[2]=Ff*Fh,Fb[3]=Fg*Fh)},Fa.length=function(){var Fa=this.elements,Fb=Fa[0],Fc=Fa[1],Fd=Fa[2],Fe=Fa[3];return Math.sqrt(Fb*Fb+Fc*Fc+Fd*Fd+Fe*Fe)},Fa.rotateX=function(Fa,Fb){var Fc=Fb.elements,Fd=this.elements;Fa*=.5;var Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fd[3],Fi=Math.sin(Fa),Fj=Math.cos(Fa);Fc[0]=Fe*Fj+Fh*Fi,Fc[1]=Ff*Fj+Fg*Fi,Fc[2]=Fg*Fj-Ff*Fi,Fc[3]=Fh*Fj-Fe*Fi},Fa.rotateY=function(Fa,Fb){var Fc=Fb.elements,Fd=this.elements;Fa*=.5;var Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fd[3],Fi=Math.sin(Fa),Fj=Math.cos(Fa);Fc[0]=Fe*Fj-Fg*Fi,Fc[1]=Ff*Fj+Fh*Fi,Fc[2]=Fg*Fj+Fe*Fi,Fc[3]=Fh*Fj-Ff*Fi},Fa.rotateZ=function(Fa,Fb){var Fc=Fb.elements,Fd=this.elements;Fa*=.5;var Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fd[3],Fi=Math.sin(Fa),Fj=Math.cos(Fa);Fc[0]=Fe*Fj+Ff*Fi,Fc[1]=Ff*Fj-Fe*Fi,Fc[2]=Fg*Fj+Fh*Fi,Fc[3]=Fh*Fj-Fg*Fi},Fa.getYawPitchRoll=function(Fa){Fgb.transformQuat(Fgb.ForwardRH,this,Fe.TEMPVector31),Fgb.transformQuat(Fgb.Up,this,Fe.TEMPVector32);var Fb=Fe.TEMPVector32.elements;Fe.angleTo(Fgb.ZERO,Fe.TEMPVector31,Fe.TEMPVector33);var Fc=Fe.TEMPVector33.elements;Fc[0]==Math.PI/2?(Fc[1]=Fe.arcTanAngle(Fb[2],Fb[0]),Fc[2]=0):Fc[0]==-Math.PI/2?(Fc[1]=Fe.arcTanAngle(-Fb[2],-Fb[0]),Fc[2]=0):(Fab.createRotationY(-Fc[1],Fe.TEMPMatrix0),Fab.createRotationX(-Fc[0],Fe.TEMPMatrix1),Fgb.transformCoordinate(Fe.TEMPVector32,Fe.TEMPMatrix0,Fe.TEMPVector32),Fgb.transformCoordinate(Fe.TEMPVector32,Fe.TEMPMatrix1,Fe.TEMPVector32),Fc[2]=Fe.arcTanAngle(Fb[1],-Fb[0])),Fc[1]<=-Math.PI&&(Fc[1]=Math.PI),Fc[2]<=-Math.PI&&(Fc[2]=Math.PI),Fc[1]>=Math.PI&&Fc[2]>=Math.PI&&(Fc[1]=0,Fc[2]=0,Fc[0]=Math.PI-Fc[0]);var Fd=Fa.elements;Fd[0]=Fc[1],Fd[1]=Fc[0],Fd[2]=Fc[2]},Fa.invert=function(Fa){var Fb=Fa.elements,Fc=this.elements,Fd=Fc[0],Fe=Fc[1],Ff=Fc[2],Fg=Fc[3],Fh=Fd*Fd+Fe*Fe+Ff*Ff+Fg*Fg,Fi=Fh?1/Fh:0;Fb[0]=-Fd*Fi,Fb[1]=-Fe*Fi,Fb[2]=-Ff*Fi,Fb[3]=Fg*Fi},Fa.identity=function(){var Fa=this.elements;Fa[0]=0,Fa[1]=0,Fa[2]=0,Fa[3]=1},Fa.fromArray=function(Fa,Fb){void 0===Fb&&(Fb=0),this.elements[0]=Fa[Fb+0],this.elements[1]=Fa[Fb+1],this.elements[2]=Fa[Fb+2],this.elements[3]=Fa[Fb+3]},Fa.cloneTo=function(Fa){var Fb,Fc,Fd;if((Fc=this.elements)!==(Fd=Fa.elements))for(Fb=0;Fb<4;++Fb)Fd[Fb]=Fc[Fb]},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fa.equals=function(Fa){var Fb=this.elements,Fc=Fa.elements;return Fka.nearEqual(Fb[0],Fc[0])&&Fka.nearEqual(Fb[1],Fc[1])&&Fka.nearEqual(Fb[2],Fc[2])&&Fka.nearEqual(Fb[3],Fc[3])},Fa.lengthSquared=function(){var Fa=this.elements[0],Fb=this.elements[1],Fc=this.elements[2],Fd=this.elements[3];return Fa*Fa+Fb*Fb+Fc*Fc+Fd*Fd},Fq(0,Fa,"x",function(){return this.elements[0]}),Fq(0,Fa,"y",function(){return this.elements[1]}),Fq(0,Fa,"z",function(){return this.elements[2]}),Fq(0,Fa,"w",function(){return this.elements[3]}),Fe.createFromYawPitchRoll=function(Fa,Fb,Fc,Fd){var Fe=.5*Fc,Ff=.5*Fb,Fg=.5*Fa,Fh=Math.sin(Fe),Fi=Math.cos(Fe),Fj=Math.sin(Ff),Fm=Math.cos(Ff),Fn=Math.sin(Fg),Fo=Math.cos(Fg),Fp=Fd.elements;Fp[0]=Fo*Fj*Fi+Fn*Fm*Fh,Fp[1]=Fn*Fm*Fi-Fo*Fj*Fh,Fp[2]=Fo*Fm*Fh-Fn*Fj*Fi,Fp[3]=Fo*Fm*Fi+Fn*Fj*Fh},Fe.multiply=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fb.elements,Ff=Fc.elements,Fg=Fd[0],Fh=Fd[1],Fi=Fd[2],Fj=Fd[3],Fm=Fe[0],Fn=Fe[1],Fo=Fe[2],Fp=Fe[3],Fq=Fh*Fo-Fi*Fn,Fr=Fi*Fm-Fg*Fo,Fs=Fg*Fn-Fh*Fm,Ft=Fg*Fm+Fh*Fn+Fi*Fo;Ff[0]=Fg*Fp+Fm*Fj+Fq,Ff[1]=Fh*Fp+Fn*Fj+Fr,Ff[2]=Fi*Fp+Fo*Fj+Fs,Ff[3]=Fj*Fp-Ft},Fe.arcTanAngle=function(Fa,Fb){return 0==Fa?1==Fb?Math.PI/2:-Math.PI/2:0<Fa?Math.atan(Fb/Fa):Fa<0?0<Fb?Math.atan(Fb/Fa)+Math.PI:Math.atan(Fb/Fa)-Math.PI:0},Fe.angleTo=function(Fa,Fb,Fc){Fgb.subtract(Fb,Fa,Fe.TEMPVector30),Fgb.normalize(Fe.TEMPVector30,Fe.TEMPVector30),Fc.elements[0]=Math.asin(Fe.TEMPVector30.y),Fc.elements[1]=Fe.arcTanAngle(-Fe.TEMPVector30.z,-Fe.TEMPVector30.x)},Fe.createFromAxisAngle=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements;Fb*=.5;var Ff=Math.sin(Fb);Fd[0]=Ff*Fe[0],Fd[1]=Ff*Fe[1],Fd[2]=Ff*Fe[2],Fd[3]=Math.cos(Fb)},Fe.createFromMatrix3x3=function(Fa,Fb){var Fc,Fd=Fb.elements,Fe=Fa.elements,Ff=Fe[0]+Fe[4]+Fe[8];if(0<Ff)Fc=Math.sqrt(Ff+1),Fd[3]=.5*Fc,Fc=.5/Fc,Fd[0]=(Fe[5]-Fe[7])*Fc,Fd[1]=(Fe[6]-Fe[2])*Fc,Fd[2]=(Fe[1]-Fe[3])*Fc;else{var Fg=0;Fe[4]>Fe[0]&&(Fg=1),Fe[8]>Fe[3*Fg+Fg]&&(Fg=2);var Fh=(Fg+1)%3,Fi=(Fg+2)%3;Fc=Math.sqrt(Fe[3*Fg+Fg]-Fe[3*Fh+Fh]-Fe[3*Fi+Fi]+1),Fd[Fg]=.5*Fc,Fc=.5/Fc,Fd[3]=(Fe[3*Fh+Fi]-Fe[3*Fi+Fh])*Fc,Fd[Fh]=(Fe[3*Fh+Fg]+Fe[3*Fg+Fh])*Fc,Fd[Fi]=(Fe[3*Fi+Fg]+Fe[3*Fg+Fi])*Fc}},Fe.createFromMatrix4x4=function(Fa,Fb){var Fc,Fd,Fe=Fa.elements,Ff=Fb.elements,Fg=Fe[0]+Fe[5]+Fe[10];0<Fg?(Fc=Math.sqrt(Fg+1),Ff[3]=.5*Fc,Fc=.5/Fc,Ff[0]=(Fe[6]-Fe[9])*Fc,Ff[1]=(Fe[8]-Fe[2])*Fc,Ff[2]=(Fe[1]-Fe[4])*Fc):Fe[0]>=Fe[5]&&Fe[0]>=Fe[10]?(Fd=.5/(Fc=Math.sqrt(1+Fe[0]-Fe[5]-Fe[10])),Ff[0]=.5*Fc,Ff[1]=(Fe[1]+Fe[4])*Fd,Ff[2]=(Fe[2]+Fe[8])*Fd,Ff[3]=(Fe[6]-Fe[9])*Fd):Fe[5]>Fe[10]?(Fd=.5/(Fc=Math.sqrt(1+Fe[5]-Fe[0]-Fe[10])),Ff[0]=(Fe[4]+Fe[1])*Fd,Ff[1]=.5*Fc,Ff[2]=(Fe[9]+Fe[6])*Fd,Ff[3]=(Fe[8]-Fe[2])*Fd):(Fd=.5/(Fc=Math.sqrt(1+Fe[10]-Fe[0]-Fe[5])),Ff[0]=(Fe[8]+Fe[2])*Fd,Ff[1]=(Fe[9]+Fe[6])*Fd,Ff[2]=.5*Fc,Ff[3]=(Fe[1]-Fe[4])*Fd)},Fe.slerp=function(Fa,Fb,Fc,Fd){var Fe,Ff,Fg,Fh,Fi,Fj=Fa.elements,Fm=Fb.elements,Fn=Fd.elements,Fo=Fj[0],Fp=Fj[1],Fq=Fj[2],Fr=Fj[3],Fs=Fm[0],Ft=Fm[1],Fu=Fm[2],Fv=Fm[3];return(Ff=Fo*Fs+Fp*Ft+Fq*Fu+Fr*Fv)<0&&(Ff=-Ff,Fs=-Fs,Ft=-Ft,Fu=-Fu,Fv=-Fv),Fi=1e-6<1-Ff?(Fe=Math.acos(Ff),Fg=Math.sin(Fe),Fh=Math.sin((1-Fc)*Fe)/Fg,Math.sin(Fc*Fe)/Fg):(Fh=1-Fc,Fc),Fn[0]=Fh*Fo+Fi*Fs,Fn[1]=Fh*Fp+Fi*Ft,Fn[2]=Fh*Fq+Fi*Fu,Fn[3]=Fh*Fr+Fi*Fv,Fn},Fe.lerp=function(Fa,Fb,Fc,Fd){var Fe=Fd.elements,Ff=Fa.elements,Fg=Fb.elements,Fh=Ff[0],Fi=Ff[1],Fj=Ff[2],Fm=Ff[3];Fe[0]=Fh+Fc*(Fg[0]-Fh),Fe[1]=Fi+Fc*(Fg[1]-Fi),Fe[2]=Fj+Fc*(Fg[2]-Fj),Fe[3]=Fm+Fc*(Fg[3]-Fm)},Fe.add=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Fe[0]+Ff[0],Fd[1]=Fe[1]+Ff[1],Fd[2]=Fe[2]+Ff[2],Fd[3]=Fe[3]+Ff[3]},Fe.dot=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;return Fc[0]*Fd[0]+Fc[1]*Fd[1]+Fc[2]*Fd[2]+Fc[3]*Fd[3]},Fe.rotationLookAt=function(Fa,Fb,Fc){Fe.lookAt(Fgb.ZERO,Fa,Fb,Fc)},Fe.lookAt=function(Fa,Fb,Fc,Fd){Fla.lookAt(Fa,Fb,Fc,Fe._tempMatrix3x3),Fe.rotationMatrix(Fe._tempMatrix3x3,Fd)},Fe.invert=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fa.lengthSquared();Fka.isZero(Fe)||(Fe=1/Fe,Fd[0]=-Fc[0]*Fe,Fd[1]=-Fc[1]*Fe,Fd[2]=-Fc[2]*Fe,Fd[3]=Fc[3]*Fe)},Fe.rotationMatrix=function(Fa,Fb){var Fc=Fa.elements,Fd=Fc[0],Fe=Fc[1],Ff=Fc[2],Fg=Fc[3],Fh=Fc[4],Fi=Fc[5],Fj=Fc[6],Fm=Fc[7],Fn=Fc[8],Fo=Fb.elements,Fp=NaN,Fq=NaN,Fr=Fd+Fh+Fn;0<Fr?(Fp=Math.sqrt(Fr+1),Fo[3]=.5*Fp,Fp=.5/Fp,Fo[0]=(Fi-Fm)*Fp,Fo[1]=(Fj-Ff)*Fp,Fo[2]=(Fe-Fg)*Fp):Fh<=Fd&&Fn<=Fd?(Fq=.5/(Fp=Math.sqrt(1+Fd-Fh-Fn)),Fo[0]=.5*Fp,Fo[1]=(Fe+Fg)*Fq,Fo[2]=(Ff+Fj)*Fq,Fo[3]=(Fi-Fm)*Fq):Fn<Fh?(Fq=.5/(Fp=Math.sqrt(1+Fh-Fd-Fn)),Fo[0]=(Fg+Fe)*Fq,Fo[1]=.5*Fp,Fo[2]=(Fm+Fi)*Fq,Fo[3]=(Fj-Ff)*Fq):(Fq=.5/(Fp=Math.sqrt(1+Fn-Fd-Fh)),Fo[0]=(Fj+Ff)*Fq,Fo[1]=(Fm+Fi)*Fq,Fo[2]=.5*Fp,Fo[3]=(Fe-Fg)*Fq)},Fe.DEFAULT=new Fe,Fn(Fe,["TEMPVector30",function(){return this.TEMPVector30=new Fgb},"TEMPVector31",function(){return this.TEMPVector31=new Fgb},"TEMPVector32",function(){return this.TEMPVector32=new Fgb},"TEMPVector33",function(){return this.TEMPVector33=new Fgb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new Fab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new Fab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new Fla},"NAN",function(){return this.NAN=new Fe(NaN,NaN,NaN,NaN)}]),Fe}(),Fdb=function(){function Fa(Fa){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=Fa,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}Fp(Fa,"laya.d3.math.Rand");var Fb=Fa.prototype;return Fb.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},Fb.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},Fb.getSignedFloat=function(){return 2*this.getFloat()-1},Fq(0,Fb,"seed",function(){return this.seeds[0]},function(Fa){this.seeds[0]=Fa,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),Fa.getFloatFromInt=function(Fa){return 1/8388607*(8388607&Fa)},Fa.getByteFromInt=function(Fa){return(8388607&Fa)>>>15},Fa}(),Feb=(function(){function Fe(Fa){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(Fa instanceof Array)||4!==Fa.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|Fa[0],this._state0L=0|Fa[1],this._state1U=0|Fa[2],this._state1L=0|Fa[3]}Fp(Fe,"laya.d3.math.RandX");var Fa=Fe.prototype;Fa.randomint=function(){var Fa=this._state0U,Fb=this._state0L,Fc=this._state1U,Fd=this._state1L,Fe=(Fd>>>0)+(Fb>>>0),Ff=Fc+Fa+(Fe/2>>>31)>>>0,Fg=Fe>>>0,Fh=0,Fi=0;Fh=(Fa^=Fh=Fa<<23|(-512&Fb)>>>9)^(this._state0U=Fc),Fi=(Fb^=Fi=Fb<<23)^(this._state0L=Fd);Fh^=Fa>>>18,Fi^=Fb>>>18|(262143&Fa)<<14;return Fh^=Fc>>>5,Fi^=Fd>>>5|(31&Fc)<<27,this._state1U=Fh,this._state1L=Fi,[Ff,Fg]},Fa.random=function(){var Fa=this.randomint(),Fb=Fa[0],Fc=1023<<20|Fb>>>12,Fd=0|(Fa[1]>>>12|(4095&Fb)<<20);return Fe._CONVERTION_BUFFER.setUint32(0,Fc,!1),Fe._CONVERTION_BUFFER.setUint32(4,Fd,!1),Fdb._CONVERTION_BUFFER.getFloat64(0,!1)-1},Fn(Fe,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new Fdb([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function Fa(Fa,Fb){this.origin=null,this.direction=null,this.origin=Fa,this.direction=Fb}return Fp(Fa,"laya.d3.math.Ray"),Fa}()),Ffb=function(){function Fa(Fa,Fb){this.elements=new Float32Array(2),void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0);var Fc=this.elements;Fc[0]=Fa,Fc[1]=Fb}Fp(Fa,"laya.d3.math.Vector2");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.fromArray=function(Fa,Fb){void 0===Fb&&(Fb=0),this.elements[0]=Fa[Fb+0],this.elements[1]=Fa[Fb+1]},Fb.cloneTo=function(Fa){var Fb=Fa.elements,Fc=this.elements;Fb[0]=Fc[0],Fb[1]=Fc[1]},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"x",function(){return this.elements[0]},function(Fa){this.elements[0]=Fa}),Fq(0,Fb,"y",function(){return this.elements[1]},function(Fa){this.elements[1]=Fa}),Fa.scale=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements;Fd[0]=Fe[0]*Fb,Fd[1]=Fe[1]*Fb},Fn(Fa,["ZERO",function(){return this.ZERO=new Fa(0,0)},"ONE",function(){return this.ONE=new Fa(1,1)}]),Fa}(),Fgb=function(){function Fm(Fa,Fb,Fc){this.elements=new Float32Array(3),void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0);var Fd=this.elements;Fd[0]=Fa,Fd[1]=Fb,Fd[2]=Fc}Fp(Fm,"laya.d3.math.Vector3");var Fa=Fm.prototype;return Fx.imps(Fa,{"laya.d3.core.IClone":!0}),Fa.fromArray=function(Fa,Fb){void 0===Fb&&(Fb=0),this.elements[0]=Fa[Fb+0],this.elements[1]=Fa[Fb+1],this.elements[2]=Fa[Fb+2]},Fa.cloneTo=function(Fa){var Fb=Fa.elements,Fc=this.elements;Fb[0]=Fc[0],Fb[1]=Fc[1],Fb[2]=Fc[2]},Fa.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fa.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},Fa.reset=function(Fa,Fb,Fc){this.elements[0]=Fa,this.elements[1]=Fb,this.elements[2]=Fc},Fq(0,Fa,"x",function(){return this.elements[0]},function(Fa){this.elements[0]=Fa}),Fq(0,Fa,"y",function(){return this.elements[1]},function(Fa){this.elements[1]=Fa}),Fq(0,Fa,"z",function(){return this.elements[2]},function(Fa){this.elements[2]=Fa}),Fm.distanceSquared=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fc[0]-Fd[0],Ff=Fc[1]-Fd[1],Fg=Fc[2]-Fd[2];return Fe*Fe+Ff*Ff+Fg*Fg},Fm.distance=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fc[0]-Fd[0],Ff=Fc[1]-Fd[1],Fg=Fc[2]-Fd[2];return Math.sqrt(Fe*Fe+Ff*Ff+Fg*Fg)},Fm.min=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Math.min(Fe[0],Ff[0]),Fd[1]=Math.min(Fe[1],Ff[1]),Fd[2]=Math.min(Fe[2],Ff[2])},Fm.max=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Math.max(Fe[0],Ff[0]),Fd[1]=Math.max(Fe[1],Ff[1]),Fd[2]=Math.max(Fe[2],Ff[2])},Fm.transformQuat=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements,Fg=Fe[0],Fh=Fe[1],Fi=Fe[2],Fj=Ff[0],Fm=Ff[1],Fn=Ff[2],Fo=Ff[3],Fp=Fo*Fg+Fm*Fi-Fn*Fh,Fq=Fo*Fh+Fn*Fg-Fj*Fi,Fr=Fo*Fi+Fj*Fh-Fm*Fg,Fs=-Fj*Fg-Fm*Fh-Fn*Fi;Fd[0]=Fp*Fo+Fs*-Fj+Fq*-Fn-Fr*-Fm,Fd[1]=Fq*Fo+Fs*-Fm+Fr*-Fj-Fp*-Fn,Fd[2]=Fr*Fo+Fs*-Fn+Fp*-Fm-Fq*-Fj},Fm.scalarLength=function(Fa){var Fb=Fa.elements,Fc=Fb[0],Fd=Fb[1],Fe=Fb[2];return Math.sqrt(Fc*Fc+Fd*Fd+Fe*Fe)},Fm.scalarLengthSquared=function(Fa){var Fb=Fa.elements,Fc=Fb[0],Fd=Fb[1],Fe=Fb[2];return Fc*Fc+Fd*Fd+Fe*Fe},Fm.normalize=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fc[0],Ff=Fc[1],Fg=Fc[2],Fh=Fe*Fe+Ff*Ff+Fg*Fg;0<Fh&&(Fh=1/Math.sqrt(Fh),Fd[0]=Fc[0]*Fh,Fd[1]=Fc[1]*Fh,Fd[2]=Fc[2]*Fh)},Fm.multiply=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Fe[0]*Ff[0],Fd[1]=Fe[1]*Ff[1],Fd[2]=Fe[2]*Ff[2]},Fm.scale=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements;Fd[0]=Fe[0]*Fb,Fd[1]=Fe[1]*Fb,Fd[2]=Fe[2]*Fb},Fm.lerp=function(Fa,Fb,Fc,Fd){var Fe=Fd.elements,Ff=Fa.elements,Fg=Fb.elements,Fh=Ff[0],Fi=Ff[1],Fj=Ff[2];Fe[0]=Fh+Fc*(Fg[0]-Fh),Fe[1]=Fi+Fc*(Fg[1]-Fi),Fe[2]=Fj+Fc*(Fg[2]-Fj)},Fm.transformV3ToV3=function(Fa,Fb,Fc){var Fd=Fm._tempVector4;Fm.transformV3ToV4(Fa,Fb,Fd);var Fe=Fd.elements,Ff=Fc.elements;Ff[0]=Fe[0],Ff[1]=Fe[1],Ff[2]=Fe[2]},Fm.transformV3ToV4=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fb.elements,Fi=Fc.elements;Fi[0]=Fe*Fh[0]+Ff*Fh[4]+Fg*Fh[8]+Fh[12],Fi[1]=Fe*Fh[1]+Ff*Fh[5]+Fg*Fh[9]+Fh[13],Fi[2]=Fe*Fh[2]+Ff*Fh[6]+Fg*Fh[10]+Fh[14],Fi[3]=Fe*Fh[3]+Ff*Fh[7]+Fg*Fh[11]+Fh[15]},Fm.TransformNormal=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fb.elements,Fi=Fc.elements;Fi[0]=Fe*Fh[0]+Ff*Fh[4]+Fg*Fh[8],Fi[1]=Fe*Fh[1]+Ff*Fh[5]+Fg*Fh[9],Fi[2]=Fe*Fh[2]+Ff*Fh[6]+Fg*Fh[10]},Fm.transformCoordinate=function(Fa,Fb,Fc){var Fd=Fm._tempVector4.elements,Fe=Fa.elements,Ff=Fe[0],Fg=Fe[1],Fh=Fe[2],Fi=Fb.elements;Fd[0]=Ff*Fi[0]+Fg*Fi[4]+Fh*Fi[8]+Fi[12],Fd[1]=Ff*Fi[1]+Fg*Fi[5]+Fh*Fi[9]+Fi[13],Fd[2]=Ff*Fi[2]+Fg*Fi[6]+Fh*Fi[10]+Fi[14],Fd[3]=1/(Ff*Fi[3]+Fg*Fi[7]+Fh*Fi[11]+Fi[15]);var Fj=Fc.elements;Fj[0]=Fd[0]*Fd[3],Fj[1]=Fd[1]*Fd[3],Fj[2]=Fd[2]*Fd[3]},Fm.Clamp=function(Fa,Fb,Fc,Fd){var Fe=Fa.elements,Ff=Fe[0],Fg=Fe[1],Fh=Fe[2],Fi=Fb.elements,Fj=Fi[0],Fm=Fi[1],Fn=Fi[2],Fo=Fc.elements,Fp=Fo[0],Fq=Fo[1],Fr=Fo[2],Fs=Fd.elements;Ff=(Ff=Fp<Ff?Fp:Ff)<Fj?Fj:Ff,Fg=(Fg=Fq<Fg?Fq:Fg)<Fm?Fm:Fg,Fh=(Fh=Fr<Fh?Fr:Fh)<Fn?Fn:Fh,Fs[0]=Ff,Fs[1]=Fg,Fs[2]=Fh},Fm.add=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Fe[0]+Ff[0],Fd[1]=Fe[1]+Ff[1],Fd[2]=Fe[2]+Ff[2]},Fm.subtract=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Fe[0]-Ff[0],Fd[1]=Fe[1]-Ff[1],Fd[2]=Fe[2]-Ff[2]},Fm.cross=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fb.elements,Ff=Fc.elements,Fg=Fd[0],Fh=Fd[1],Fi=Fd[2],Fj=Fe[0],Fm=Fe[1],Fn=Fe[2];Ff[0]=Fh*Fn-Fi*Fm,Ff[1]=Fi*Fj-Fg*Fn,Ff[2]=Fg*Fm-Fh*Fj},Fm.dot=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;return Fc[0]*Fd[0]+Fc[1]*Fd[1]+Fc[2]*Fd[2]},Fm.equals=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;return Fka.nearEqual(Math.abs(Fc[0]),Math.abs(Fd[0]))&&Fka.nearEqual(Math.abs(Fc[1]),Math.abs(Fd[1]))&&Fka.nearEqual(Math.abs(Fc[2]),Math.abs(Fd[2]))},Fm.ZERO=new Fm(0,0,0),Fm.ONE=new Fm(1,1,1),Fm.NegativeUnitX=new Fm(-1,0,0),Fm.UnitX=new Fm(1,0,0),Fm.UnitY=new Fm(0,1,0),Fm.UnitZ=new Fm(0,0,1),Fm.ForwardRH=new Fm(0,0,-1),Fm.ForwardLH=new Fm(0,0,1),Fm.Up=new Fm(0,1,0),Fm.NAN=new Fm(NaN,NaN,NaN),Fn(Fm,["_tempVector4",function(){return this._tempVector4=new Fhb}]),Fm}(),Fhb=function(){function Fa(Fa,Fb,Fc,Fd){this.elements=new Float32Array(4),void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=0);var Fe=this.elements;Fe[0]=Fa,Fe[1]=Fb,Fe[2]=Fc,Fe[3]=Fd}Fp(Fa,"laya.d3.math.Vector4");var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb.fromArray=function(Fa,Fb){void 0===Fb&&(Fb=0),this.elements[0]=Fa[Fb+0],this.elements[1]=Fa[Fb+1],this.elements[2]=Fa[Fb+2],this.elements[3]=Fa[Fb+3]},Fb.cloneTo=function(Fa){var Fb=Fa.elements,Fc=this.elements;Fb[0]=Fc[0],Fb[1]=Fc[1],Fb[2]=Fc[2],Fb[3]=Fc[3]},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fb.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},Fb.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},Fq(0,Fb,"x",function(){return this.elements[0]},function(Fa){this.elements[0]=Fa}),Fq(0,Fb,"y",function(){return this.elements[1]},function(Fa){this.elements[1]=Fa}),Fq(0,Fb,"z",function(){return this.elements[2]},function(Fa){this.elements[2]=Fa}),Fq(0,Fb,"w",function(){return this.elements[3]},function(Fa){this.elements[3]=Fa}),Fa.lerp=function(Fa,Fb,Fc,Fd){var Fe=Fd.elements,Ff=Fa.elements,Fg=Fb.elements,Fh=Ff[0],Fi=Ff[1],Fj=Ff[2],Fm=Ff[3];Fe[0]=Fh+Fc*(Fg[0]-Fh),Fe[1]=Fi+Fc*(Fg[1]-Fi),Fe[2]=Fj+Fc*(Fg[2]-Fj),Fe[3]=Fm+Fc*(Fg[3]-Fm)},Fa.transformByM4x4=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fd[0],Ff=Fd[1],Fg=Fd[2],Fh=Fd[3],Fi=Fb.elements,Fj=Fc.elements;Fj[0]=Fe*Fi[0]+Ff*Fi[4]+Fg*Fi[8]+Fh*Fi[12],Fj[1]=Fe*Fi[1]+Ff*Fi[5]+Fg*Fi[9]+Fh*Fi[13],Fj[2]=Fe*Fi[2]+Ff*Fi[6]+Fg*Fi[10]+Fh*Fi[14],Fj[3]=Fe*Fi[3]+Ff*Fi[7]+Fg*Fi[11]+Fh*Fi[15]},Fa.equals=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;return Fka.nearEqual(Math.abs(Fc[0]),Math.abs(Fd[0]))&&Fka.nearEqual(Math.abs(Fc[1]),Math.abs(Fd[1]))&&Fka.nearEqual(Math.abs(Fc[2]),Math.abs(Fd[2]))&&Fka.nearEqual(Math.abs(Fc[3]),Math.abs(Fd[3]))},Fa.normalize=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fa.length();0<Fe&&(Fd[0]=Fc[0]*Fe,Fd[1]=Fc[1]*Fe,Fd[2]=Fc[2]*Fe,Fd[3]=Fc[3]*Fe)},Fa.add=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Fe[0]+Ff[0],Fd[1]=Fe[1]+Ff[1],Fd[2]=Fe[2]+Ff[2],Fd[3]=Fe[3]+Ff[3]},Fa.subtract=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Fe[0]-Ff[0],Fd[1]=Fe[1]-Ff[1],Fd[2]=Fe[2]-Ff[2],Fd[3]=Fe[3]-Ff[3]},Fa.multiply=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Fe[0]*Ff[0],Fd[1]=Fe[1]*Ff[1],Fd[2]=Fe[2]*Ff[2],Fd[3]=Fe[3]*Ff[3]},Fa.scale=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements;Fd[0]=Fe[0]*Fb,Fd[1]=Fe[1]*Fb,Fd[2]=Fe[2]*Fb,Fd[3]=Fe[3]*Fb},Fa.Clamp=function(Fa,Fb,Fc,Fd){var Fe=Fa.elements,Ff=Fe[0],Fg=Fe[1],Fh=Fe[2],Fi=Fe[3],Fj=Fb.elements,Fm=Fj[0],Fn=Fj[1],Fo=Fj[2],Fp=Fj[3],Fq=Fc.elements,Fr=Fq[0],Fs=Fq[1],Ft=Fq[2],Fu=Fq[3],Fv=Fd.elements;Ff=(Ff=Fr<Ff?Fr:Ff)<Fm?Fm:Ff,Fg=(Fg=Fs<Fg?Fs:Fg)<Fn?Fn:Fg,Fh=(Fh=Ft<Fh?Ft:Fh)<Fo?Fo:Fh,Fi=(Fi=Fu<Fi?Fu:Fi)<Fp?Fp:Fi,Fv[0]=Ff,Fv[1]=Fg,Fv[2]=Fh,Fv[3]=Fi},Fa.distanceSquared=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fc[0]-Fd[0],Ff=Fc[1]-Fd[1],Fg=Fc[2]-Fd[2],Fh=Fc[3]-Fd[3];return Fe*Fe+Ff*Ff+Fg*Fg+Fh*Fh},Fa.distance=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements,Fe=Fc[0]-Fd[0],Ff=Fc[1]-Fd[1],Fg=Fc[2]-Fd[2],Fh=Fc[3]-Fd[3];return Math.sqrt(Fe*Fe+Ff*Ff+Fg*Fg+Fh*Fh)},Fa.dot=function(Fa,Fb){var Fc=Fa.elements,Fd=Fb.elements;return Fc[0]*Fd[0]+Fc[1]*Fd[1]+Fc[2]*Fd[2]+Fc[3]*Fd[3]},Fa.min=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Math.min(Fe[0],Ff[0]),Fd[1]=Math.min(Fe[1],Ff[1]),Fd[2]=Math.min(Fe[2],Ff[2]),Fd[3]=Math.min(Fe[3],Ff[3])},Fa.max=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb.elements;Fd[0]=Math.max(Fe[0],Ff[0]),Fd[1]=Math.max(Fe[1],Ff[1]),Fd[2]=Math.max(Fe[2],Ff[2]),Fd[3]=Math.max(Fe[3],Ff[3])},Fn(Fa,["ZERO",function(){return this.ZERO=new Fa},"ONE",function(){return this.ONE=new Fa(1,1,1,1)},"UnitX",function(){return this.UnitX=new Fa(1,0,0,0)},"UnitY",function(){return this.UnitY=new Fa(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new Fa(0,0,1,0)},"UnitW",function(){return this.UnitW=new Fa(0,0,0,1)}]),Fa}(),Fib=function(){function Ff(Fa,Fb,Fc,Fd){this.minDepth=0,this.maxDepth=1,this.x=Fa,this.y=Fb,this.width=Fc,this.height=Fd}Fp(Ff,"laya.d3.math.Viewport");var Fa=Ff.prototype;return Fa.project=function(Fa,Fb,Fc){Fgb.transformV3ToV3(Fa,Fb,Fc);var Fd=Fa.elements,Fe=Fb.elements,Ff=Fc.elements,Fg=Fd[0]*Fe[3]+Fd[1]*Fe[7]+Fd[2]*Fe[11]+Fe[15];1!==Fg&&(Ff[0]=Ff[0]/Fg,Ff[1]=Ff[1]/Fg,Ff[2]=Ff[2]/Fg),Ff[0]=.5*(Ff[0]+1)*this.width+this.x,Ff[1]=.5*(1-Ff[1])*this.height+this.y,Ff[2]=Ff[2]*(this.maxDepth-this.minDepth)+this.minDepth},Fa.unprojectFromMat=function(Fa,Fb,Fc){var Fd=Fa.elements,Fe=Fb.elements,Ff=Fc.elements;Ff[0]=(Fd[0]-this.x)/this.width*2-1,Ff[1]=-((Fd[1]-this.y)/this.height*2-1);var Fg=(this.maxDepth-this.minDepth)/2;Ff[2]=(Fd[2]-this.minDepth-Fg)/Fg;var Fh=Ff[0]*Fe[3]+Ff[1]*Fe[7]+Ff[2]*Fe[11]+Fe[15];Fgb.transformV3ToV3(Fc,Fb,Fc),1!==Fh&&(Ff[0]=Ff[0]/Fh,Ff[1]=Ff[1]/Fh,Ff[2]=Ff[2]/Fh)},Fa.unprojectFromWVP=function(Fa,Fb,Fc,Fd,Fe){Fab.multiply(Fb,Fc,Ff._tempMatrix4x4),Fd&&Fab.multiply(Ff._tempMatrix4x4,Fd,Ff._tempMatrix4x4),Ff._tempMatrix4x4.invert(Ff._tempMatrix4x4),this.unprojectFromMat(Fa,Ff._tempMatrix4x4,Fe)},Fn(Ff,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Fab}]),Ff}(),Fjb=function(){function FE(Fa){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=Fa,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}Fp(FE,"laya.d3.resource.models.SubMesh");var Fa=FE.prototype;return Fx.imps(Fa,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Fa._getVertexBuffer=function(Fa){return void 0===Fa&&(Fa=0),0===Fa?this._vertexBuffer:null},Fa._getIndexBuffer=function(){return this._indexBuffer},Fa._getStaticBatchBakedVertexs=function(Fa,Fb){var Fc,Fd,Fe=this._vertexBuffer,Ff=Fe.vertexDeclaration,Fg=Ff.getVertexElementByUsage(0).offset/4,Fh=Ff.getVertexElementByUsage(3).offset/4,Fi=Fb.meshRender.lightmapScaleOffset,Fj=0,Fm=0,Fn=0,Fo=0,Fp=0,Fq=0;if(Fi)if(Fd=Ff.getVertexElementByUsage(15))Fn=Ff.vertexStride/4,Fc=0<this._vertexCount?Fe.getData().slice(this._vertexStart*Fn,(this._vertexStart+this._vertexCount)*Fn):Fe.getData().slice(),Fo=Fd.offset/4;else{Fn=(Fq=Ff.vertexStride/4)+2,Fc=this._vertexCount?new Float32Array(this._vertexCount*(Fe.vertexDeclaration.vertexStride/4+2)):new Float32Array(Fe.vertexCount*(Fe.vertexDeclaration.vertexStride/4+2)),Fo=(Fp=Ff.getVertexElementByUsage(2).offset/4)+2;var Fr=Fe.getData();for(Fj=0,Fm=Fr.length/Fq;Fj<Fm;Fj++){var Fs=0;Fs=0<this._vertexCount?(this._vertexStart+Fj)*Fq:Fj*Fq;var Ft=Fj*Fn,Fu=0;for(Fu=0;Fu<Fo;Fu++)Fc[Ft+Fu]=Fr[Fs+Fu];for(Fu=Fo;Fu<Fq;Fu++)Fc[Ft+Fu+2]=Fr[Fs+Fu]}}else Fn=Ff.vertexStride/4,Fc=this._vertexCount?Fe.getData().slice(this._vertexStart*Fn,(this._vertexStart+this._vertexCount)*Fn):Fe.getData().slice();if(Fa){var Fv=Fa.worldMatrix,Fw=FE._tempMatrix4x40;Fv.invert(Fw);var Fx=FE._tempMatrix4x41,Fy=Fb.transform.worldMatrix;Fab.multiply(Fw,Fy,Fx)}else Fx=Fb.transform.worldMatrix;var Fz=FE._tempQuaternion0;for(Fx.decomposeTransRotScale(FE._tempVector30,Fz,FE._tempVector31),Fj=0,Fm=Fc.length/Fn;Fj<Fm;Fj++){var FA=Fj*Fn+Fg,FB=Fj*Fn+Fh;if(Fsb.transformVector3ArrayToVector3ArrayCoordinate(Fc,FA,Fx,Fc,FA),Fsb.transformVector3ArrayByQuat(Fc,FB,Fz,Fc,FB),Fi){var FC=Fj*Fn+Fo;if(Fd)Fsb.transformLightingMapTexcoordByUV1Array(Fc,FC,Fi,Fc,FC);else{var FD=Fj*Fq+Fp;Fsb.transformLightingMapTexcoordByUV0Array(Fr,FD,Fi,Fc,FC)}}}return Fc},Fa._getVertexBuffers=function(){return null},Fa._beforeRender=function(Fa){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Fa._render=function(Fa){var Fb,Fc=0,Fd=Fa.renderElement;if(1<this._indexCount){var Fe=this._boneIndicesList.length;if(1<Fe){for(var Ff=0;Ff<Fe;Ff++)(Fb=Fd._skinAnimationDatas||this._skinAnimationDatas)&&(Fd._shaderValue.setValue(0,Fb[Ff]),Fa._shader.uploadRenderElementUniforms(Fd._shaderValue.data)),FF.mainContext.drawElements(4,this._subIndexBufferCount[Ff],5123,2*this._subIndexBufferStart[Ff]);FA.drawCall+=Fe}else(Fb=Fd._skinAnimationDatas||this._skinAnimationDatas)&&(Fd._shaderValue.setValue(0,Fb[0]),Fa._shader.uploadRenderElementUniforms(Fd._shaderValue.data)),FF.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),FA.drawCall++;Fc=this._indexCount}else Fc=this._indexBuffer.indexCount,(Fb=Fd._skinAnimationDatas||this._skinAnimationDatas)&&(Fd._shaderValue.setValue(0,Fb[0]),Fa._shader.uploadRenderElementUniforms(Fd._shaderValue.data)),FF.mainContext.drawElements(4,Fc,5123,0),FA.drawCall++;FA.trianglesFaces+=Fc/3},Fa.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},Fa.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},Fq(0,Fa,"_vertexBufferCount",function(){return 1}),Fq(0,Fa,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Fn(FE,["_tempVector30",function(){return this._tempVector30=new Fgb},"_tempVector31",function(){return this._tempVector31=new Fgb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Fcb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Fab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Fab}]),FE}(),Fmb=function(){function Fa(Fa){this.defineCounter=0,this.defines=null,Fa?(this.defineCounter=Fa.defineCounter,this.defines=Fa.defines.slice()):(this.defineCounter=0,this.defines=[])}return Fp(Fa,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),Fa.prototype.registerDefine=function(Fa){var Fb=Math.pow(2,this.defineCounter++);return this.defines[Fb]=Fa,Fb},Fa}(),Fnb=function(){function Fa(){}return Fp(Fa,"laya.d3.shader.ShaderInit3D"),Fa.__init__=function(){var Fa,Fb;FAb._globalRegDefine("HIGHPRECISION",FAb.SHADERDEFINE_HIGHPRECISION),FAb._globalRegDefine("FOG",FAb.SHADERDEFINE_FOG),FAb._globalRegDefine("DIRECTIONLIGHT",FAb.SHADERDEFINE_DIRECTIONLIGHT),FAb._globalRegDefine("POINTLIGHT",FAb.SHADERDEFINE_POINTLIGHT),FAb._globalRegDefine("SPOTLIGHT",FAb.SHADERDEFINE_SPOTLIGHT),FAb._globalRegDefine("UV",FAb.SHADERDEFINE_UV0),FAb._globalRegDefine("COLOR",FAb.SHADERDEFINE_COLOR),FAb._globalRegDefine("UV1",FAb.SHADERDEFINE_UV1),FAb._globalRegDefine("CASTSHADOW",Fpb.SHADERDEFINE_CAST_SHADOW),FAb._globalRegDefine("SHADOWMAP_PSSM1",Fpb.SHADERDEFINE_SHADOW_PSSM1),FAb._globalRegDefine("SHADOWMAP_PSSM2",Fpb.SHADERDEFINE_SHADOW_PSSM2),FAb._globalRegDefine("SHADOWMAP_PSSM3",Fpb.SHADERDEFINE_SHADOW_PSSM3),FAb._globalRegDefine("SHADOWMAP_PCF_NO",Fpb.SHADERDEFINE_SHADOW_PCF_NO),FAb._globalRegDefine("SHADOWMAP_PCF1",Fpb.SHADERDEFINE_SHADOW_PCF1),FAb._globalRegDefine("SHADOWMAP_PCF2",Fpb.SHADERDEFINE_SHADOW_PCF2),FAb._globalRegDefine("SHADOWMAP_PCF3",Fpb.SHADERDEFINE_SHADOW_PCF3),FAb._globalRegDefine("DEPTHFOG",FAb.SAHDERDEFINE_DEPTHFOG),FLb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),FLb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),Fa={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},Fb={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var Fc=FLb.nameKey.add("SIMPLE");shaderCompile=FAb.add(Fc,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',Fa,Fb),FMb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),FMb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),FMb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),FMb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),FMb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),FMb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),FMb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),FMb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),FMb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},Fa}(),Fob=function(){function Fa(){this._data=null,this._data=[]}Fp(Fa,"laya.d3.shader.ValusArray");var Fb=Fa.prototype;return Fb.setValue=function(Fa,Fb){this._data[Fa]=Fb},Fq(0,Fb,"data",function(){return this._data}),Fa}(),Fpb=function(){function Fa(){}return Fa.SHADERDEFINE_RECEIVE_SHADOW=1,Fa.SHADERDEFINE_CAST_SHADOW=512,Fa.SHADERDEFINE_SHADOW_PSSM1=1024,Fa.SHADERDEFINE_SHADOW_PSSM2=2048,Fa.SHADERDEFINE_SHADOW_PSSM3=4096,Fa.SHADERDEFINE_SHADOW_PCF_NO=8192,Fa.SHADERDEFINE_SHADOW_PCF1=16384,Fa.SHADERDEFINE_SHADOW_PCF2=32768,Fa.SHADERDEFINE_SHADOW_PCF3=65536,Fa.MAX_PSSM_COUNT=3,Fa}(),Fqb=function(){function FX(){}return Fp(FX,"laya.d3.utils.Picker"),FX.calculateCursorRay=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=Fa.elements[0],Fh=Fa.elements[1],Fi=FX._tempVector30,Fj=Fi.elements;Fj[0]=Fg,Fj[1]=Fh,Fj[2]=Fb.minDepth;var Fm=FX._tempVector31,Fn=Fm.elements;Fn[0]=Fg,Fn[1]=Fh,Fn[2]=Fb.maxDepth;var Fo=Ff.origin,Fp=FX._tempVector32;Fb.unprojectFromWVP(Fi,Fc,Fd,Fe,Fo),Fb.unprojectFromWVP(Fm,Fc,Fd,Fe,Fp);var Fq=Ff.direction.elements;Fq[0]=Fp.x-Fo.x,Fq[1]=Fp.y-Fo.y,Fq[2]=Fp.z-Fo.z,Fgb.normalize(Ff.direction,Ff.direction)},FX.rayIntersectsPositionsAndIndices=function(Fa,Fb,Fc,Fd,Fe){for(var Ff=Fc.vertexStride/4,Fg=Fc.getVertexElementByUsage(0).offset/4,Fh=Number.MAX_VALUE,Fi=-1,Fj=-1,Fm=-1,Fn=0;Fn<Fd.length;Fn+=3){var Fo=FX._tempVector35,Fp=Fo.elements,Fq=Fd[Fn]*Ff,Fr=Fq+Fg;Fp[0]=Fb[Fr],Fp[1]=Fb[1+Fr],Fp[2]=Fb[2+Fr];var Fs=FX._tempVector36,Ft=Fs.elements,Fu=Fd[Fn+1]*Ff,Fv=Fu+Fg;Ft[0]=Fb[Fv],Ft[1]=Fb[1+Fv],Ft[2]=Fb[2+Fv];var Fw=FX._tempVector37,Fx=Fw.elements,Fy=Fd[Fn+2]*Ff,Fz=Fy+Fg;Fx[0]=Fb[Fz],Fx[1]=Fb[1+Fz],Fx[2]=Fb[2+Fz];var FA=laya.d3.utils.Picker.rayIntersectsTriangle(Fa,Fo,Fs,Fw);!isNaN(FA)&&FA<Fh&&(Fh=FA,Fi=Fq,Fj=Fu,Fm=Fy)}if(Fh===Number.MAX_VALUE)return Fe.position.toDefault(),Fe.distance=Number.MAX_VALUE,Fe.trianglePositions[0].toDefault(),Fe.trianglePositions[1].toDefault(),Fe.trianglePositions[2].toDefault(),Fe.triangleNormals[0].toDefault(),Fe.triangleNormals[1].toDefault(),Fe.triangleNormals[2].toDefault(),!1;Fe.distance=Fh,Fgb.scale(Fa.direction,Fh,Fe.position),Fgb.add(Fa.origin,Fe.position,Fe.position);var FB=Fe.trianglePositions,FC=FB[0],FD=FB[1],FE=FB[2],FF=FC.elements,FG=FD.elements,FH=FE.elements,FI=Fi+Fg;FF[0]=Fb[FI],FF[1]=Fb[FI+1],FF[2]=Fb[FI+2];var FJ=Fj+Fg;FG[0]=Fb[FJ],FG[1]=Fb[FJ+1],FG[2]=Fb[FJ+2];var FK=Fm+Fg;FH[0]=Fb[FK],FH[1]=Fb[FK+1],FH[2]=Fb[FK+2];var FL=Fc.getVertexElementByUsage(3);if(FL){var FM=FL.offset/4,FN=Fe.triangleNormals,FO=FN[0],FP=FN[1],FQ=FN[2],FR=FO.elements,FS=FP.elements,FT=FQ.elements,FU=Fi+FM;FR[0]=Fb[FU],FR[1]=Fb[FU+1],FR[2]=Fb[FU+2];var FV=Fj+FM;FS[0]=Fb[FV],FS[1]=Fb[FV+1],FS[2]=Fb[FV+2];var FW=Fm+FM;FT[0]=Fb[FW],FT[1]=Fb[FW+1],FT[2]=Fb[FW+2]}return!0},FX.rayIntersectsTriangle=function(Fa,Fb,Fc,Fd){var Fe=FX._tempVector30,Ff=FX._tempVector31;Fgb.subtract(Fc,Fb,Fe),Fgb.subtract(Fd,Fb,Ff);var Fg,Fh=FX._tempVector32;if(Fgb.cross(Fa.direction,Ff,Fh),(Fg=Fgb.dot(Fe,Fh))>-Number.MIN_VALUE&&Fg<Number.MIN_VALUE)return Number.NaN;var Fi,Fj=1/Fg,Fm=FX._tempVector33;if(Fgb.subtract(Fa.origin,Fb,Fm),Fi=Fgb.dot(Fm,Fh),(Fi*=Fj)<0||1<Fi)return Number.NaN;var Fn,Fo,Fp=FX._tempVector34;return Fgb.cross(Fm,Fe,Fp),Fn=Fgb.dot(Fa.direction,Fp),(Fn*=Fj)<0||1<Fi+Fn?Number.NaN:(Fo=Fgb.dot(Ff,Fp),(Fo*=Fj)<0?Number.NaN:Fo)},Fn(FX,["_tempVector30",function(){return this._tempVector30=new Fgb},"_tempVector31",function(){return this._tempVector31=new Fgb},"_tempVector32",function(){return this._tempVector32=new Fgb},"_tempVector33",function(){return this._tempVector33=new Fgb},"_tempVector34",function(){return this._tempVector34=new Fgb},"_tempVector35",function(){return this._tempVector35=new Fgb},"_tempVector36",function(){return this._tempVector36=new Fgb},"_tempVector37",function(){return this._tempVector37=new Fgb}]),FX}(),Frb=(function(){function Fa(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new Fgb,new Fgb,new Fgb],this.trianglePositions.length=3,this.triangleNormals=[new Fgb,new Fgb,new Fgb],this.triangleNormals.length=3,this.position=new Fgb}Fp(Fa,"laya.d3.utils.RaycastHit"),Fa.prototype.cloneTo=function(Fa){Fa.distance=this.distance,this.trianglePositions[0].cloneTo(Fa.trianglePositions[0]),this.trianglePositions[1].cloneTo(Fa.trianglePositions[1]),this.trianglePositions[2].cloneTo(Fa.trianglePositions[2]),this.triangleNormals[0].cloneTo(Fa.triangleNormals[0]),this.triangleNormals[1].cloneTo(Fa.triangleNormals[1]),this.triangleNormals[2].cloneTo(Fa.triangleNormals[2]),this.position.cloneTo(Fa.position),Fa.sprite3D=this.sprite3D}}(),function(){function Fa(Fa,Fb){this._width=0,this._height=0,this._width=Fa,this._height=Fb}Fp(Fa,"laya.d3.utils.Size");var Fb=Fa.prototype;return Fq(0,Fb,"width",function(){return-1===this._width?FY.clientWidth:this._width}),Fq(0,Fb,"height",function(){return-1===this._height?FY.clientHeight:this._height}),Fq(1,Fa,"fullScreen",function(){return new Fa(-1,-1)}),Fa}()),Fsb=function(){function FI(){}return Fp(FI,"laya.d3.utils.Utils3D"),FI._rotationTransformScaleSkinAnimation=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn){var Fo,Fp,Fq,Fr,Fs,Ft=FI._tempArray16_0,Fu=FI._tempArray16_1,Fv=FI._tempArray16_2,Fw=Fd+Fd,Fx=Fe+Fe,Fy=Ff+Ff,Fz=Fd*Fw,FA=Fe*Fw,FB=Fe*Fx,FC=Ff*Fw,FD=Ff*Fx,FE=Ff*Fy,FF=Fg*Fw,FG=Fg*Fx,FH=Fg*Fy;for(Ft[15]=1,Ft[0]=1-FB-FE,Ft[1]=FA+FH,Ft[2]=FC-FG,Ft[4]=FA-FH,Ft[5]=1-Fz-FE,Ft[6]=FD+FF,Ft[8]=FC+FG,Ft[9]=FD-FF,Ft[10]=1-Fz-FB,Fu[15]=1,Fu[0]=Fh,Fu[5]=Fi,Fu[10]=Fj,Fo=0;Fo<4;Fo++)Fp=Ft[Fo],Fq=Ft[Fo+4],Fr=Ft[Fo+8],Fs=Ft[Fo+12],Fv[Fo]=Fp,Fv[Fo+4]=Fq,Fv[Fo+8]=Fr,Fv[Fo+12]=Fp*Fa+Fq*Fb+Fr*Fc+Fs;for(Fo=0;Fo<4;Fo++)Fp=Fv[Fo],Fq=Fv[Fo+4],Fr=Fv[Fo+8],Fs=Fv[Fo+12],Fm[Fo+Fn]=Fp*Fu[0]+Fq*Fu[1]+Fr*Fu[2]+Fs*Fu[3],Fm[Fo+Fn+4]=Fp*Fu[4]+Fq*Fu[5]+Fr*Fu[6]+Fs*Fu[7],Fm[Fo+Fn+8]=Fp*Fu[8]+Fq*Fu[9]+Fr*Fu[10]+Fs*Fu[11],Fm[Fo+Fn+12]=Fp*Fu[12]+Fq*Fu[13]+Fr*Fu[14]+Fs*Fu[15]},FI._createNodeByJson=function(Fa,Fb,Fc,Fd){if(!Fc)switch(Fb.type){case"Sprite3D":Fc=new FKb;break;case"MeshSprite3D":Fc=new FXb;break;case"SkinnedMeshSprite3D":Fc=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":Fc=new ShuriKenParticle3D;break;case"TrailSprite3D":Fc=new TrailSprite3D;break;case"Terrain":Fc=new Terrain;break;case"Camera":Fc=new FWb;break;case"DirectionLight":Fc=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var Fe=Fb.props;if(Fe)for(var Ff in Fe)Fc[Ff]=Fe[Ff];var Fg=Fb.customProps;Fg&&(Fc instanceof laya.d3.core.Sprite3D?(Fc._parseBaseCustomProps(Fg),Fc._parseCustomProps(Fa,Fd,Fg,Fb),Fc._parseCustomComponent(Fa,Fd,Fb.components)):Fc._parseCustomProps(Fa,Fd,Fg,Fb));var Fh=Fb.child;if(Fh)for(var Fi=0,Fj=Fh.length;Fi<Fj;Fi++){var Fm=FI._createNodeByJson(Fa,Fh[Fi],null,Fd);Fc.addChild(Fm)}return Fc},FI._computeBoneAndAnimationDatasByBindPoseMatrxix=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg,Fh,Fi=0,Fj=0,Fm=Fa.length;for(Fg=0;Fg<Fm;Fi+=Fa[Fg].keyframeWidth,Fj+=16,Fg++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Fb[Fi+0],Fb[Fi+1],Fb[Fi+2],Fb[Fi+3],Fb[Fi+4],Fb[Fi+5],Fb[Fi+6],Fb[Fi+7],Fb[Fi+8],Fb[Fi+9],Fd,Fj),0!=Fg&&(Fh=16*Fa[Fg].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Fd,Fh,Fd,Fj,Fd,Fj));var Fn=Fc.length;for(Fg=0;Fg<Fn;Fg++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Fd,16*Ff[Fg],Fc[Fg],Fe,16*Fg)},FI._computeAnimationDatasByArrayAndMatrixFast=function(Fa,Fb,Fc,Fd){for(var Fe=0,Ff=Fa.length;Fe<Ff;Fe++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Fb,16*Fd[Fe],Fa[Fe],Fc,16*Fe)},FI._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(Fa,Fb,Fc,Fd,Fe){var Ff,Fg,Fh=0,Fi=0,Fj=Fa.length;for(Ff=0;Ff<Fj;Fh+=Fa[Ff].keyframeWidth,Fi+=16,Ff++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Fb[Fh+7],Fb[Fh+8],Fb[Fh+9],Fb[Fh+3],Fb[Fh+4],Fb[Fh+5],Fb[Fh+6],Fb[Fh+0],Fb[Fh+1],Fb[Fh+2],Fd,Fi),0!=Ff&&(Fg=16*Fa[Ff].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Fd,Fg,Fd,Fi,Fd,Fi));var Fm=Fc.length;for(Ff=0;Ff<Fm;Ff++){var Fn=16*Ff;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Fd,Fn,Fc[Ff],Fe,Fn)}},FI._computeAnimationDatasByArrayAndMatrixFastOld=function(Fa,Fb,Fc){for(var Fd=Fa.length,Fe=0;Fe<Fd;Fe++){var Ff=16*Fe;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Fb,Ff,Fa[Fe],Fc,Ff)}},FI._computeRootAnimationData=function(Fa,Fb,Fc){for(var Fd=0,Fe=0,Ff=0,Fg=Fa.length;Fd<Fg;Fe+=Fa[Fd].keyframeWidth,Ff+=16,Fd++)laya.d3.utils.Utils3D.createAffineTransformationArray(Fb[Fe+0],Fb[Fe+1],Fb[Fe+2],Fb[Fe+3],Fb[Fe+4],Fb[Fe+5],Fb[Fe+6],Fb[Fe+7],Fb[Fe+8],Fb[Fe+9],Fc,Ff)},FI.transformVector3ArrayByQuat=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fc.elements,Fg=Fa[Fb],Fh=Fa[Fb+1],Fi=Fa[Fb+2],Fj=Ff[0],Fm=Ff[1],Fn=Ff[2],Fo=Ff[3],Fp=Fo*Fg+Fm*Fi-Fn*Fh,Fq=Fo*Fh+Fn*Fg-Fj*Fi,Fr=Fo*Fi+Fj*Fh-Fm*Fg,Fs=-Fj*Fg-Fm*Fh-Fn*Fi;Fd[Fe]=Fp*Fo+Fs*-Fj+Fq*-Fn-Fr*-Fm,Fd[Fe+1]=Fq*Fo+Fs*-Fm+Fr*-Fj-Fp*-Fn,Fd[Fe+2]=Fr*Fo+Fs*-Fn+Fp*-Fm-Fq*-Fj},FI.mulMatrixByArray=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg,Fh,Fi,Fj,Fm;if(Fe===Fc){for(Fc=FI._tempArray16_3,Fg=0;Fg<16;++Fg)Fc[Fg]=Fe[Ff+Fg];Fd=0}for(Fg=0;Fg<4;Fg++)Fh=Fa[Fb+Fg],Fi=Fa[Fb+Fg+4],Fj=Fa[Fb+Fg+8],Fm=Fa[Fb+Fg+12],Fe[Ff+Fg]=Fh*Fc[Fd+0]+Fi*Fc[Fd+1]+Fj*Fc[Fd+2]+Fm*Fc[Fd+3],Fe[Ff+Fg+4]=Fh*Fc[Fd+4]+Fi*Fc[Fd+5]+Fj*Fc[Fd+6]+Fm*Fc[Fd+7],Fe[Ff+Fg+8]=Fh*Fc[Fd+8]+Fi*Fc[Fd+9]+Fj*Fc[Fd+10]+Fm*Fc[Fd+11],Fe[Ff+Fg+12]=Fh*Fc[Fd+12]+Fi*Fc[Fd+13]+Fj*Fc[Fd+14]+Fm*Fc[Fd+15]},FI.mulMatrixByArrayFast=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg,Fh,Fi,Fj,Fm;for(Fg=0;Fg<4;Fg++)Fh=Fa[Fb+Fg],Fi=Fa[Fb+Fg+4],Fj=Fa[Fb+Fg+8],Fm=Fa[Fb+Fg+12],Fe[Ff+Fg]=Fh*Fc[Fd+0]+Fi*Fc[Fd+1]+Fj*Fc[Fd+2]+Fm*Fc[Fd+3],Fe[Ff+Fg+4]=Fh*Fc[Fd+4]+Fi*Fc[Fd+5]+Fj*Fc[Fd+6]+Fm*Fc[Fd+7],Fe[Ff+Fg+8]=Fh*Fc[Fd+8]+Fi*Fc[Fd+9]+Fj*Fc[Fd+10]+Fm*Fc[Fd+11],Fe[Ff+Fg+12]=Fh*Fc[Fd+12]+Fi*Fc[Fd+13]+Fj*Fc[Fd+14]+Fm*Fc[Fd+15]},FI.mulMatrixByArrayAndMatrixFast=function(Fa,Fb,Fc,Fd,Fe){var Ff,Fg,Fh,Fi,Fj,Fm=Fc.elements,Fn=Fm[0],Fo=Fm[1],Fp=Fm[2],Fq=Fm[3],Fr=Fm[4],Fs=Fm[5],Ft=Fm[6],Fu=Fm[7],Fv=Fm[8],Fw=Fm[9],Fx=Fm[10],Fy=Fm[11],Fz=Fm[12],FA=Fm[13],FB=Fm[14],FC=Fm[15],FD=Fb,FE=Fb+4,FF=Fb+8,FG=Fb+12,FH=Fe,FI=Fe+4,FJ=Fe+8,FK=Fe+12;for(Ff=0;Ff<4;Ff++)Fg=Fa[FD+Ff],Fh=Fa[FE+Ff],Fi=Fa[FF+Ff],Fj=Fa[FG+Ff],Fd[FH+Ff]=Fg*Fn+Fh*Fo+Fi*Fp+Fj*Fq,Fd[FI+Ff]=Fg*Fr+Fh*Fs+Fi*Ft+Fj*Fu,Fd[FJ+Ff]=Fg*Fv+Fh*Fw+Fi*Fx+Fj*Fy,Fd[FK+Ff]=Fg*Fz+Fh*FA+Fi*FB+Fj*FC},FI.createAffineTransformationArray=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn){var Fo=Fd+Fd,Fp=Fe+Fe,Fq=Ff+Ff,Fr=Fd*Fo,Fs=Fd*Fp,Ft=Fd*Fq,Fu=Fe*Fp,Fv=Fe*Fq,Fw=Ff*Fq,Fx=Fg*Fo,Fy=Fg*Fp,Fz=Fg*Fq;Fm[Fn+0]=(1-(Fu+Fw))*Fh,Fm[Fn+1]=(Fs+Fz)*Fh,Fm[Fn+2]=(Ft-Fy)*Fh,Fm[Fn+3]=0,Fm[Fn+4]=(Fs-Fz)*Fi,Fm[Fn+5]=(1-(Fr+Fw))*Fi,Fm[Fn+6]=(Fv+Fx)*Fi,Fm[Fn+7]=0,Fm[Fn+8]=(Ft+Fy)*Fj,Fm[Fn+9]=(Fv-Fx)*Fj,Fm[Fn+10]=(1-(Fr+Fu))*Fj,Fm[Fn+11]=0,Fm[Fn+12]=Fa,Fm[Fn+13]=Fb,Fm[Fn+14]=Fc,Fm[Fn+15]=1},FI.transformVector3ArrayToVector3ArrayCoordinate=function(Fa,Fb,Fc,Fd,Fe){var Ff=FI._tempArray4_0,Fg=Fa[Fb+0],Fh=Fa[Fb+1],Fi=Fa[Fb+2],Fj=Fc.elements;Ff[0]=Fg*Fj[0]+Fh*Fj[4]+Fi*Fj[8]+Fj[12],Ff[1]=Fg*Fj[1]+Fh*Fj[5]+Fi*Fj[9]+Fj[13],Ff[2]=Fg*Fj[2]+Fh*Fj[6]+Fi*Fj[10]+Fj[14],Ff[3]=1/(Fg*Fj[3]+Fh*Fj[7]+Fi*Fj[11]+Fj[15]),Fd[Fe+0]=Ff[0]*Ff[3],Fd[Fe+1]=Ff[1]*Ff[3],Fd[Fe+2]=Ff[2]*Ff[3]},FI.transformLightingMapTexcoordByUV0Array=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fc.elements;Fd[Fe+0]=Fa[Fb+0]*Ff[0]+Ff[2],Fd[Fe+1]=(Fa[Fb+1]-1)*Ff[1]+Ff[3]},FI.transformLightingMapTexcoordByUV1Array=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fc.elements;Fd[Fe+0]=Fa[Fb+0]*Ff[0]+Ff[2],Fd[Fe+1]=1+Fa[Fb+1]*Ff[1]+Ff[3]},FI.getURLVerion=function(Fa){var Fb=Fa.indexOf("?");return 0<=Fb?Fa.substr(Fb):null},FI._quaternionCreateFromYawPitchRollArray=function(Fa,Fb,Fc,Fd){var Fe=.5*Fc,Ff=.5*Fb,Fg=.5*Fa,Fh=Math.sin(Fe),Fi=Math.cos(Fe),Fj=Math.sin(Ff),Fm=Math.cos(Ff),Fn=Math.sin(Fg),Fo=Math.cos(Fg);Fd[0]=Fo*Fj*Fi+Fn*Fm*Fh,Fd[1]=Fn*Fm*Fi-Fo*Fj*Fh,Fd[2]=Fo*Fm*Fh-Fn*Fj*Fi,Fd[3]=Fo*Fm*Fi+Fn*Fj*Fh},FI._createAffineTransformationArray=function(Fa,Fb,Fc,Fd){var Fe=Fb[0],Ff=Fb[1],Fg=Fb[2],Fh=Fb[3],Fi=Fe+Fe,Fj=Ff+Ff,Fm=Fg+Fg,Fn=Fe*Fi,Fo=Fe*Fj,Fp=Fe*Fm,Fq=Ff*Fj,Fr=Ff*Fm,Fs=Fg*Fm,Ft=Fh*Fi,Fu=Fh*Fj,Fv=Fh*Fm,Fw=Fc[0],Fx=Fc[1],Fy=Fc[2];Fd[0]=(1-(Fq+Fs))*Fw,Fd[1]=(Fo+Fv)*Fw,Fd[2]=(Fp-Fu)*Fw,Fd[3]=0,Fd[4]=(Fo-Fv)*Fx,Fd[5]=(1-(Fn+Fs))*Fx,Fd[6]=(Fr+Ft)*Fx,Fd[7]=0,Fd[8]=(Fp+Fu)*Fy,Fd[9]=(Fr-Ft)*Fy,Fd[10]=(1-(Fn+Fq))*Fy,Fd[11]=0,Fd[12]=Fa[0],Fd[13]=Fa[1],Fd[14]=Fa[2],Fd[15]=1},FI._mulMatrixArray=function(Fa,Fb,Fc,Fd){var Fe,Ff,Fg,Fh,Fi,Fj=Fb.elements,Fm=Fj[0],Fn=Fj[1],Fo=Fj[2],Fp=Fj[3],Fq=Fj[4],Fr=Fj[5],Fs=Fj[6],Ft=Fj[7],Fu=Fj[8],Fv=Fj[9],Fw=Fj[10],Fx=Fj[11],Fy=Fj[12],Fz=Fj[13],FA=Fj[14],FB=Fj[15],FC=Fd,FD=Fd+4,FE=Fd+8,FF=Fd+12;for(Fe=0;Fe<4;Fe++)Ff=Fa[Fe],Fg=Fa[Fe+4],Fh=Fa[Fe+8],Fi=Fa[Fe+12],Fc[FC+Fe]=Ff*Fm+Fg*Fn+Fh*Fo+Fi*Fp,Fc[FD+Fe]=Ff*Fq+Fg*Fr+Fh*Fs+Fi*Ft,Fc[FE+Fe]=Ff*Fu+Fg*Fv+Fh*Fw+Fi*Fx,Fc[FF+Fe]=Ff*Fy+Fg*Fz+Fh*FA+Fi*FB},FI.getYawPitchRoll=function(Fa,Fb){FI.transformQuat(Fgb.ForwardRH,Fa,Fcb.TEMPVector31),FI.transformQuat(Fgb.Up,Fa,Fcb.TEMPVector32);var Fc=Fcb.TEMPVector32.elements;FI.angleTo(Fgb.ZERO,Fcb.TEMPVector31,Fcb.TEMPVector33);var Fd=Fcb.TEMPVector33.elements;Fd[0]==Math.PI/2?(Fd[1]=FI.arcTanAngle(Fc[2],Fc[0]),Fd[2]=0):Fd[0]==-Math.PI/2?(Fd[1]=FI.arcTanAngle(-Fc[2],-Fc[0]),Fd[2]=0):(Fab.createRotationY(-Fd[1],Fcb.TEMPMatrix0),Fab.createRotationX(-Fd[0],Fcb.TEMPMatrix1),Fgb.transformCoordinate(Fcb.TEMPVector32,Fcb.TEMPMatrix0,Fcb.TEMPVector32),Fgb.transformCoordinate(Fcb.TEMPVector32,Fcb.TEMPMatrix1,Fcb.TEMPVector32),Fd[2]=FI.arcTanAngle(Fc[1],-Fc[0])),Fd[1]<=-Math.PI&&(Fd[1]=Math.PI),Fd[2]<=-Math.PI&&(Fd[2]=Math.PI),Fd[1]>=Math.PI&&Fd[2]>=Math.PI&&(Fd[1]=0,Fd[2]=0,Fd[0]=Math.PI-Fd[0]),Fb[0]=Fd[1],Fb[1]=Fd[0],Fb[2]=Fd[2]},FI.arcTanAngle=function(Fa,Fb){return 0==Fa?1==Fb?Math.PI/2:-Math.PI/2:0<Fa?Math.atan(Fb/Fa):Fa<0?0<Fb?Math.atan(Fb/Fa)+Math.PI:Math.atan(Fb/Fa)-Math.PI:0},FI.angleTo=function(Fa,Fb,Fc){Fgb.subtract(Fb,Fa,Fcb.TEMPVector30),Fgb.normalize(Fcb.TEMPVector30,Fcb.TEMPVector30),Fc.elements[0]=Math.asin(Fcb.TEMPVector30.y),Fc.elements[1]=FI.arcTanAngle(-Fcb.TEMPVector30.z,-Fcb.TEMPVector30.x)},FI.transformQuat=function(Fa,Fb,Fc){var Fd=Fc.elements,Fe=Fa.elements,Ff=Fb,Fg=Fe[0],Fh=Fe[1],Fi=Fe[2],Fj=Ff[0],Fm=Ff[1],Fn=Ff[2],Fo=Ff[3],Fp=Fo*Fg+Fm*Fi-Fn*Fh,Fq=Fo*Fh+Fn*Fg-Fj*Fi,Fr=Fo*Fi+Fj*Fh-Fm*Fg,Fs=-Fj*Fg-Fm*Fh-Fn*Fi;Fd[0]=Fp*Fo+Fs*-Fj+Fq*-Fn-Fr*-Fm,Fd[1]=Fq*Fo+Fs*-Fm+Fr*-Fj-Fp*-Fn,Fd[2]=Fr*Fo+Fs*-Fn+Fp*-Fm-Fq*-Fj},FI.quaterionNormalize=function(Fa,Fb){var Fc=Fa[0],Fd=Fa[1],Fe=Fa[2],Ff=Fa[3],Fg=Fc*Fc+Fd*Fd+Fe*Fe+Ff*Ff;0<Fg&&(Fg=1/Math.sqrt(Fg),Fb[0]=Fc*Fg,Fb[1]=Fd*Fg,Fb[2]=Fe*Fg,Fb[3]=Ff*Fg)},FI.matrix4x4MultiplyFFF=function(Fa,Fb,Fc){var Fd,Fe,Ff,Fg,Fh;if(Fc===Fb)for(Fb=new Float32Array(16),Fd=0;Fd<16;++Fd)Fb[Fd]=Fc[Fd];for(Fd=0;Fd<4;Fd++)Fe=Fa[Fd],Ff=Fa[Fd+4],Fg=Fa[Fd+8],Fh=Fa[Fd+12],Fc[Fd]=Fe*Fb[0]+Ff*Fb[1]+Fg*Fb[2]+Fh*Fb[3],Fc[Fd+4]=Fe*Fb[4]+Ff*Fb[5]+Fg*Fb[6]+Fh*Fb[7],Fc[Fd+8]=Fe*Fb[8]+Ff*Fb[9]+Fg*Fb[10]+Fh*Fb[11],Fc[Fd+12]=Fe*Fb[12]+Ff*Fb[13]+Fg*Fb[14]+Fh*Fb[15]},FI.matrix4x4MultiplyMFM=function(Fa,Fb,Fc){FI.matrix4x4MultiplyFFF(Fa.elements,Fb,Fc.elements)},Fn(FI,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new Fgb},"_tempVector3_1",function(){return this._tempVector3_1=new Fgb},"_tempVector3_2",function(){return this._tempVector3_2=new Fgb},"_tempVector3_3",function(){return this._tempVector3_3=new Fgb},"_tempVector3_4",function(){return this._tempVector3_4=new Fgb},"_tempVector3_5",function(){return this._tempVector3_5=new Fgb},"_tempVector3_6",function(){return this._tempVector3_6=new Fgb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),FI}(),Ftb=function(){function FG(){}return Fp(FG,"Laya3D"),FG._cancelLoadByUrl=function(Fa){Fx.loader.cancelLoadByUrl(Fa),FG._innerFirstLevelLoaderManager.cancelLoadByUrl(Fa),FG._innerSecondLevelLoaderManager.cancelLoadByUrl(Fa),FG._innerThirdLevelLoaderManager.cancelLoadByUrl(Fa),FG._innerFourthLevelLoaderManager.cancelLoadByUrl(Fa)},FG._changeWebGLSize=function(Fa,Fb){FF.onStageResize(Fa,Fb),FY.clientWidth=Fa,FY.clientHeight=Fb},FG.__init__=function(){var Fa=Fb.createMap;Fa.lh=[FKb,"SPRITE3DHIERARCHY"],Fa.ls=[FJb,"SPRITE3DHIERARCHY"],Fa.lm=[FRb,"MESH"],Fa.lmat=[FMb,"MATERIAL"],Fa.jpg=[FTb,"nativeimage"],Fa.jpeg=[FTb,"nativeimage"],Fa.png=[FTb,"nativeimage"],Fa.pkm=[FTb,"arraybuffer"],Fa.raw=[FPb,"arraybuffer"],Fa.mipmaps=[FPb,"arraybuffer"],Ft.parserMap.SPRITE3DHIERARCHY=FG._loadHierarchy,Ft.parserMap.MESH=FG._loadMesh,Ft.parserMap.MATERIAL=FG._loadMaterial,Ft.parserMap.TEXTURECUBE=FG._loadTextureCube,Ft.parserMap.TERRAIN=FG._loadTerrain,FG._innerFirstLevelLoaderManager.on("error",null,FG._eventLoadManagerError),FG._innerSecondLevelLoaderManager.on("error",null,FG._eventLoadManagerError),FG._innerThirdLevelLoaderManager.on("error",null,FG._eventLoadManagerError),FG._innerFourthLevelLoaderManager.on("error",null,FG._eventLoadManagerError)},FG.READ_BLOCK=function(){return FG._readData.pos+=4,!0},FG.READ_DATA=function(){return FG._DATA.offset=FG._readData.getUint32(),FG._DATA.size=FG._readData.getUint32(),!0},FG.READ_STRINGS=function(){var Fa=[],Fb={offset:0,size:0};Fb.offset=FG._readData.getUint16(),Fb.size=FG._readData.getUint16();FG._readData.pos;FG._readData.pos=Fb.offset+FG._DATA.offset;for(var Fc=0;Fc<Fb.size;Fc++){var Fd=FG._readData.readUTFString();-1===Fd.lastIndexOf(".lmat")&&-1===Fd.lastIndexOf(".lpbr")||Fa.push(Fd)}return Fa},FG.formatRelativePath=function(Fa,Fb){var Fc;if("."===Fb.charAt(0)){for(var Fd=(Fa+Fb).split("/"),Fe=0,Ff=Fd.length;Fe<Ff;Fe++)if(".."==Fd[Fe]){var Fg=Fe-1;0<Fg&&".."!==Fd[Fg]&&(Fd.splice(Fg,2),Fe-=2)}Fc=Fd.join("/")}else Fc=Fa+Fb;return null!=FE.customFormat&&(Fc=FE.customFormat(Fc,null)),Fc},FG._eventLoadManagerError=function(Fa){Fx.loader.event("error",Fa)},FG._addHierarchyInnerUrls=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg=FG.formatRelativePath(Fd,Fe);Fc&&(Fg+=Fc),Fa.push({url:Fg,clas:Ff}),Fb[Fe]=Fg},FG._getSprite3DHierarchyInnerUrls=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){var Fh,Fi=0,Fj=0;switch(Fa.type){case"Scene":var Fm=Fa.customProps.lightmaps;for(Fi=0,Fj=Fm.length;Fi<Fj;Fi++){var Fn=Fm[Fi].replace(".exr",".png");FG._addHierarchyInnerUrls(Fd,Fe,Ff,Fg,Fn,FTb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var Fo;if(Fa.instanceParams)(Fo=Fa.instanceParams.loadPath)&&FG._addHierarchyInnerUrls(Fb,Fe,Ff,Fg,Fo,FRb);else{(Fo=(Fh=Fa.customProps).meshPath)&&FG._addHierarchyInnerUrls(Fb,Fe,Ff,Fg,Fo,FRb);var Fp=Fh.materials;if(Fp)for(Fi=0,Fj=Fp.length;Fi<Fj;Fi++){for(var Fq=Fp[Fi],Fr=Fq.type.split("."),Fs=FH.window,Ft=0,Fu=Fr.length;Ft<Fu;++Ft){Fs=Fs[this.clasPaths[Ft]]}if("function"!=typeof Fs)throw"_getSprite3DHierarchyInnerUrls 错误: "+Fq.type+" 不是类";FG._addHierarchyInnerUrls(Fc,Fe,Ff,Fg,Fq.path,Fs)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var Fv=(Fh=Fa.customProps).meshPath;Fv&&FG._addHierarchyInnerUrls(Fb,Fe,Ff,Fg,Fv,FRb);var Fw=Fh.material;if(Fw){Fr=Fw.type.split("."),Fs=FH.window;for(Ft=0,Fu=Fr.length;Ft<Fu;++Ft){Fs=Fs[this.clasPaths[Ft]]}FG._addHierarchyInnerUrls(Fc,Fe,Ff,Fg,Fw.path,Fs)}else{var Fx=Fh.materialPath;if(Fx)FG._addHierarchyInnerUrls(Fc,Fe,Ff,Fg,Fx,ShurikenParticleMaterial);else{var Fy=Fh.texturePath;Fy&&FG._addHierarchyInnerUrls(Fd,Fe,Ff,Fg,Fy,FTb)}}break;case"Terrain":FG._addHierarchyInnerUrls(Fd,Fe,Ff,Fg,Fa.customProps.dataPath,TerrainRes)}var Fz=Fa.components;for(var FA in Fz){var FB=Fz[FA];switch(FA){case"Animator":var FC=FB.avatarPath;if(FC)FG._addHierarchyInnerUrls(Fd,Fe,Ff,Fg,FC,Avatar);else{var FD=FB.avatar;FD&&FG._addHierarchyInnerUrls(Fd,Fe,Ff,Fg,FD.path,Avatar)}var FE=FB.clipPaths;for(Fi=0,Fj=FE.length;Fi<Fj;Fi++)FG._addHierarchyInnerUrls(Fd,Fe,Ff,Fg,FE[Fi],AnimationClip)}}var FF=Fa.child;for(Fi=0,Fj=FF.length;Fi<Fj;Fi++)FG._getSprite3DHierarchyInnerUrls(FF[Fi],Fb,Fc,Fd,Fe,Ff,Fg)},FG._loadHierarchy=function(Fa){Fa.on("loaded",null,FG._onHierarchylhLoaded,[Fa,Fa._class._getGroup()]),Fa.load(Fa.url,"json",!1,null,!0)},FG._onHierarchylhLoaded=function(Fa,Fb,Fc){if(Fa._class.destroyed)Fa.endLoad();else{var Fd=Fa.url,Fe=Fsb.getURLVerion(Fd),Ff=FE.getPath(Fd),Fg=[],Fh=[],Fi=[],Fj={};FG._getSprite3DHierarchyInnerUrls(Fc,Fg,Fh,Fi,Fj,Fe,Ff);var Fm=Fg.length+Fh.length+Fi.length,Fn=Fm+1,Fo=1/Fn;if(FG._onProcessChange(Fa,0,Fo,1),0<Fi.length){var Fp=Fm/Fn,Fq=FD.create(null,FG._onProcessChange,[Fa,Fo,Fp],!1);FG._innerFourthLevelLoaderManager.create(Fi,FD.create(null,FG._onHierarchyInnerForthLevResouLoaded,[Fa,Fb,Fq,Fc,Fj,Fg,Fh,Fo+Fp*Fi.length,Fp]),Fq,null,null,1,!0,Fb)}else FG._onHierarchyInnerForthLevResouLoaded(Fa,Fb,null,Fc,Fj,Fg,Fh,Fo,Fp)}},FG._onHierarchyInnerForthLevResouLoaded=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){if(Fa._class.destroyed)Fa.endLoad();else if(Fc&&Fc.recover(),0<Fg.length){var Fj=FD.create(null,FG._onProcessChange,[Fa,Fh,Fi],!1);FG._innerSecondLevelLoaderManager.create(Fg,FD.create(null,FG._onHierarchyInnerSecondLevResouLoaded,[Fa,Fb,Fj,Fd,Fe,Ff,Fh+Fi*Fg.length,Fi]),Fc,null,null,1,!0,Fb)}else FG._onHierarchyInnerSecondLevResouLoaded(Fa,Fb,null,Fd,Fe,Ff,Fh,Fi)},FG._onHierarchyInnerSecondLevResouLoaded=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh){if(Fa._class.destroyed)Fa.endLoad();else if(Fc&&Fc.recover(),0<Ff.length){var Fi=FD.create(null,FG._onProcessChange,[Fa,Fg,Fh],!1);FG._innerFirstLevelLoaderManager.create(Ff,FD.create(null,FG._onHierarchyInnerFirstLevResouLoaded,[Fa,Fi,Fd,Fe]),Fc,null,null,1,!0,Fb)}else FG._onHierarchyInnerFirstLevResouLoaded(Fa,null,Fd,Fe)},FG._onHierarchyInnerFirstLevResouLoaded=function(Fa,Fb,Fc,Fd){Fb&&Fb.recover(),Fa.endLoad([Fc,Fd])},FG._loadTerrain=function(Fa){Fa.on("loaded",null,FG._onTerrainLtLoaded,[Fa,Fa._class._getGroup()]),Fa.load(Fa.url,"json",!1,null,!0)},FG._onTerrainLtLoaded=function(Fa,Fb,Fc){if(Fa._class.destroyed)Fa.endLoad();else{var Fd,Fe,Ff=Fa.url,Fg=Fsb.getURLVerion(Ff),Fh=FE.getPath(Ff),Fi=[],Fj={},Fm=0,Fn=0,Fo=Fc.heightData;Fd=Fo.url,Fe=FG.formatRelativePath(Fh,Fd),Fg&&(Fe+=Fg),Fd=Fj[Fd]=Fe;var Fp=Fc.detailTexture;for(Fm=0,Fn=Fp.length;Fm<Fn;Fm++)Fi.push({url:Fp[Fm].diffuse});var Fq=Fc.normalMap;for(Fm=0,Fn=Fq.length;Fm<Fn;Fm++)Fi.push({url:Fq[Fm]});var Fr=Fc.alphaMap;for(Fm=0,Fn=Fr.length;Fm<Fn;Fm++)Fi.push({url:Fr[Fm],params:[!1,!1,6408,!0]});for(Fm=0,Fn=Fi.length;Fm<Fn;Fm++){var Fs=Fi[Fm].url;Fe=FG.formatRelativePath(Fh,Fs),Fg&&(Fe+=Fg),Fi[Fm].url=Fe,Fj[Fs]=Fe}var Ft=Fi.length,Fu=Ft+2,Fv=1/Fu;FG._onProcessChange(Fa,0,Fv,1);var Fw={heightMapLoaded:!1,texturesLoaded:!1},Fx=FD.create(null,FG._onProcessChange,[Fa,Fv,Fv],!1);FG._innerFourthLevelLoaderManager.create(Fd,FD.create(null,FG._onTerrainHeightMapLoaded,[Fa,Fx,Fc,Fj,Fw]),Fx,null,[Fo.numX,Fo.numZ,Fo.bitType,Fo.value],1,!0,Fb);var Fy=FD.create(null,FG._onProcessChange,[Fa,2*Fv,Ft/Fu],!1);FG._innerFourthLevelLoaderManager.create(Fi,FD.create(null,FG._onTerrainTexturesLoaded,[Fa,Fy,Fc,Fj,Fw]),Fy,null,null,1,!0,Fb)}},FG._onTerrainHeightMapLoaded=function(Fa,Fb,Fc,Fd,Fe){Fe.heightMapLoaded=!0,Fe.texturesLoaded&&(Fa.endLoad([Fc,Fd]),Fb.recover())},FG._onTerrainTexturesLoaded=function(Fa,Fb,Fc,Fd,Fe){Fe.texturesLoaded=!0,Fe.heightMapLoaded&&(Fa.endLoad([Fc,Fd]),Fb.recover())},FG._loadMesh=function(Fa){Fa.on("loaded",null,FG._onMeshLmLoaded,[Fa,Fa._class._getGroup()]),Fa.load(Fa.url,"arraybuffer",!1,null,!0)},FG._onMeshLmLoaded=function(Fa,Fb,Fc){if(Fa._class.destroyed)Fa.endLoad();else{var Fd,Fe,Ff,Fg=Fa.url,Fh=Fsb.getURLVerion(Fg),Fi=FE.getPath(Fg),Fj={},Fm=0,Fn=0;switch((FG._readData=new Fy(Fc)).pos=0,FG._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var Fo=FG._readData.getUint32();FG._readData.pos=FG._readData.pos+4,Fn=FG._readData.getUint16(),FG._readData.pos=FG._readData.pos+8*Fn;var Fp=FG._readData.getUint32();for(Fn=FG._readData.getUint16(),FG._readData.pos=Fo+Fp,Fd=[],Fm=0;Fm<Fn;Fm++){var Fq=FG._readData.readUTFString();-1!==Fq.lastIndexOf(".lmat")&&Fd.push(Fq)}break;default:for(FG.READ_BLOCK(),Fm=0;Fm<2;Fm++){var Fr=FG._readData.getUint16(),Fs=FG._strings[Fr],Ft=FG["READ_"+Fs];if(null==Ft)throw new Error("model file err,no this function:"+Fr+" "+Fs);1===Fm?Fd=Ft.call():Ft.call()}}for(Fm=0,Ff=Fd.length;Fm<Ff;Fm++){var Fu=Fd[Fm];Fe=FG.formatRelativePath(Fi,Fu),Fh&&(Fe+=Fh),Fd[Fm]=Fe,Fj[Fu]=Fe}if(0<Fd.length){FG._onProcessChange(Fa,0,.5,1);var Fv=FD.create(null,FG._onProcessChange,[Fa,.5,.5],!1);FG._innerSecondLevelLoaderManager.create(Fd,FD.create(null,FG._onMeshMateialLoaded,[Fa,Fv,Fc,Fj]),Fv,null,null,1,!0,Fb)}else Fa.endLoad([Fc,Fj])}},FG._onMeshMateialLoaded=function(Fa,Fb,Fc,Fd){Fa.endLoad([Fc,Fd]),Fb.recover()},FG._getMaterialTexturePath=function(Fa,Fb,Fc){var Fd=Fa.length-4;return Fa.indexOf(".dds")!=Fd&&Fa.indexOf(".tga")!=Fd&&Fa.indexOf(".exr")!=Fd&&Fa.indexOf(".DDS")!=Fd&&Fa.indexOf(".TGA")!=Fd&&Fa.indexOf(".EXR")!=Fd||(Fa=Fa.substr(0,Fd)+".png"),Fa=FG.formatRelativePath(Fc,Fa),Fb&&(Fa+=Fb),Fa},FG._loadMaterial=function(Fa){Fa.on("loaded",null,FG._onMaterilLmatLoaded,[Fa,Fa._class._getGroup()]),Fa.load(Fa.url,"json",!1,null,!0)},FG._onMaterilLmatLoaded=function(Fa,Fb,Fc){if(Fa._class.destroyed)Fa.endLoad();else{var Fd,Fe=Fa.url,Ff=Fsb.getURLVerion(Fe),Fg=FE.getPath(Fe),Fh=[],Fi={},Fj=Fc.customProps,Fm=Fc.version;if(Fm)switch(Fm){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var Fn=Fc.props.textures,Fo=0,Fp=Fn.length;Fo<Fp;Fo++){var Fq=Fn[Fo],Fr=Fq.path;if(Fr){var Fs=Fr.length-4;Fr.indexOf(".exr")!=Fs&&Fr.indexOf(".EXR")!=Fs||(Fr=Fr.substr(0,Fs)+".png"),Fd=FG.formatRelativePath(Fg,Fr),Ff&&(Fd+=Ff),Fh.push({url:Fd,params:Fq.params}),Fi[Fr]=Fd}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var Ft=Fj.diffuseTexture.texture2D;if(Ft&&(Fd=FG._getMaterialTexturePath(Ft,Ff,Fg),Fh.push(Fd),Fi[Ft]=Fd),Fj.normalTexture){var Fu=Fj.normalTexture.texture2D;Fu&&(Fd=FG._getMaterialTexturePath(Fu,Ff,Fg),Fh.push(Fd),Fi[Fu]=Fd)}if(Fj.specularTexture){var Fv=Fj.specularTexture.texture2D;Fv&&(Fd=FG._getMaterialTexturePath(Fv,Ff,Fg),Fh.push(Fd),Fi[Fv]=Fd)}if(Fj.emissiveTexture){var Fw=Fj.emissiveTexture.texture2D;Fw&&(Fd=FG._getMaterialTexturePath(Fw,Ff,Fg),Fh.push(Fd),Fi[Fw]=Fd)}if(Fj.ambientTexture){var Fx=Fj.ambientTexture.texture2D;Fx&&(Fd=FG._getMaterialTexturePath(Fx,Ff,Fg),Fh.push(Fd),Fi[Fx]=Fd)}if(Fj.reflectTexture){var Fy=Fj.reflectTexture.texture2D;Fy&&(Fd=FG._getMaterialTexturePath(Fy,Ff,Fg),Fh.push(Fd),Fi[Fy]=Fd)}}var Fz=Fh.length,FA=Fz+1,FB=1/FA;if(FG._onProcessChange(Fa,0,FB,1),0<Fz){var FC=FD.create(null,FG._onProcessChange,[Fa,FB,Fz/FA],!1);FG._innerFourthLevelLoaderManager.create(Fh,FD.create(null,FG._onMateialTexturesLoaded,[Fa,FC,Fc,Fi]),FC,FTb,null,1,!0,Fb)}else FG._onMateialTexturesLoaded(Fa,null,Fc,null)}},FG._onMateialTexturesLoaded=function(Fa,Fb,Fc,Fd){Fa.endLoad([Fc,Fd]),Fb&&Fb.recover()},FG._loadTextureCube=function(Fa){Fa.on("loaded",null,FG._onTextureCubeLtcLoaded,[Fa]),Fa.load(Fa.url,"json",!1,null,!0)},FG._onTextureCubeLtcLoaded=function(Fa,Fb){if(Fa._class.destroyed)Fa.endLoad();else{var Fc=FE.getPath(Fa.url),Fd=[FG.formatRelativePath(Fc,Fb.px),FG.formatRelativePath(Fc,Fb.nx),FG.formatRelativePath(Fc,Fb.py),FG.formatRelativePath(Fc,Fb.ny),FG.formatRelativePath(Fc,Fb.pz),FG.formatRelativePath(Fc,Fb.nz)];FG._onProcessChange(Fa,0,1/7,1);var Fe=FD.create(null,FG._onProcessChange,[Fa,1/7,6/7],!1);FG._innerFourthLevelLoaderManager.load(Fd,FD.create(null,FG._onTextureCubeImagesLoaded,[Fa,Fd,Fe]),Fe,"nativeimage")}},FG._onTextureCubeImagesLoaded=function(Fa,Fb,Fc){var Fd=[];Fd.length=6;for(var Fe=0;Fe<6;Fe++){var Ff=Fb[Fe];Fd[Fe]=Ft.getRes(Ff),Ft.clearRes(Ff)}Fa.endLoad(Fd),Fc.recover()},FG._onProcessChange=function(Fa,Fb,Fc,Fd){(Fd=Fb+Fd*Fc)<1&&Fa.event("progress",Fd)},FG.init=function(Fa,Fb,Fc,Fd,Fe,Ff){if(void 0===Fc&&(Fc=!1),void 0===Fd&&(Fd=!1),void 0===Fe&&(Fe=!0),void 0===Ff&&(Ff=!0),Fu.update3DLoop=function(){},Fu.cancelLoadByUrl=function(Fa){FG._cancelLoadByUrl(Fa)},Fi.isAntialias=Fc,Fi.isAlpha=Fd,Fi.premultipliedAlpha=Fe,Fi.isStencil=Ff,!FF.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");Fu.changeWebGLSize=FG._changeWebGLSize,Fr.is3DMode=!0,Fx.init(Fa,Fb),FI.__init__(),Fnb.__init__(),FXb.__init__(),FQ.__init__(),FG.__init__(),Fg.maxTextureCount=2,(FG.debugMode||FZ.debugMode)&&(FG._debugPhasorSprite=new FV)},FG.HIERARCHY="SPRITE3DHIERARCHY",FG.MESH="MESH",FG.MATERIAL="MATERIAL",FG.PBRMATERIAL="PBRMTL",FG.TEXTURECUBE="TEXTURECUBE",FG.TERRAIN="TERRAIN",FG._readData=null,FG._debugPhasorSprite=null,FG.debugMode=!1,Fn(FG,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new Fb},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new Fb},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new Fb},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new Fb}]),FG}(),Fub=function(Fa){function Fe(Fa){Fe.__super.call(this),this._owner=Fa,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}Fp(Fe,"laya.d3.animation.AnimationTransform3D",Ff);var Fb=Fe.prototype;return Fb._getlocalMatrix=function(){return this._localUpdate&&(Fsb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},Fb._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._onWorldTransform()}},Fb._setWorldMatrixAndUpdate=function(Fa){if(this._worldMatrix=Fa,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var Fb=this._getlocalMatrix(),Fc=0;Fc<16;++Fc)this._worldMatrix[Fc]=Fb[Fc];else Fsb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},Fb._setWorldMatrixNoUpdate=function(Fa){this._worldMatrix=Fa},Fb._setWorldMatrixIgnoreUpdate=function(Fa){this._worldMatrix=Fa,this._worldUpdate=!1},Fb.getLocalPosition=function(){return this._localPosition},Fb.setLocalPosition=function(Fa){if(this._parent)this._localPosition=Fa,this._localUpdate=!0,this._onWorldTransform();else{var Fb=this._entity.owner._transform,Fc=this._entity.localPosition,Fd=Fc.elements;Fd[0]=Fa[0],Fd[1]=Fa[1],Fd[2]=Fa[2],Fb.localPosition=Fc}},Fb.getLocalRotation=function(){if(this._localQuaternionUpdate){var Fa=this._localRotationEuler;Fsb._quaternionCreateFromYawPitchRollArray(Fa[1]/Fe._angleToRandin,Fa[0]/Fe._angleToRandin,Fa[2]/Fe._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},Fb.setLocalRotation=function(Fa){if(this._parent)this._localRotation=Fa,Fsb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Fb=this._entity.owner._transform,Fc=this._entity.localRotation,Fd=Fc.elements;Fd[0]=Fa[0],Fd[1]=Fa[1],Fd[2]=Fa[2],Fd[3]=Fa[3],Fb.localRotation=Fc}},Fb.getLocalScale=function(){return this._localScale},Fb.setLocalScale=function(Fa){if(this._parent)this._localScale=Fa,this._localUpdate=!0,this._onWorldTransform();else{var Fb=this._entity.owner._transform,Fc=this._entity.localScale,Fd=Fc.elements;Fd[0]=Fa[0],Fd[1]=Fa[1],Fd[2]=Fa[2],Fb.localScale=Fc}},Fb.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){Fsb.getYawPitchRoll(this._localRotation,Fe._tempVector3);var Fa=Fe._tempVector3,Fb=this._localRotationEuler;Fb[0]=Fa[1]*Fe._angleToRandin,Fb[1]=Fa[0]*Fe._angleToRandin,Fb[2]=Fa[2]*Fe._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},Fb.setLocalRotationEuler=function(Fa){if(this._parent)Fsb._quaternionCreateFromYawPitchRollArray(Fa[1]/Fe._angleToRandin,Fa[0]/Fe._angleToRandin,Fa[2]/Fe._angleToRandin,this._localRotation),this._localRotationEuler=Fa,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Fb=this._entity.owner._transform,Fc=this._entity.localRotationEuler,Fd=Fc.elements;Fd[0]=Fa[0],Fd[1]=Fa[1],Fd[2]=Fa[2],Fb.localRotationEuler=Fc}},Fb.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)Fsb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var Fa=this._getlocalMatrix(),Fb=0;Fb<16;++Fb)this._worldMatrix[Fb]=Fa[Fb];this._worldUpdate=!1}return this._worldMatrix},Fb.setParent=function(Fa){if(this._parent!==Fa){if(this._parent){var Fb=this._parent._childs,Fc=Fb.indexOf(this);Fb.splice(Fc,1)}Fa&&(Fa._childs.push(this),Fa&&this._onWorldTransform()),this._parent=Fa}},Fn(Fe,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Fe}(),Fvb=function(Fa){function Fb(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,Fb.__super.call(this),this._destroyed=!1,this._id=Fb._uniqueIDCounter,Fb._uniqueIDCounter++}Fp(Fb,"laya.d3.component.Component3D",Ff);var Fc=Fb.prototype;return Fx.imps(Fc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),Fc._initialize=function(Fa){this._owner=Fa,this._enable=!0,this.started=!1,this._load(Fa)},Fc._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},Fc._load=function(Fa){},Fc._start=function(Fa){},Fc._update=function(Fa){},Fc._lateUpdate=function(Fa){},Fc._preRenderUpdate=function(Fa){},Fc._postRenderUpdate=function(Fa){},Fc._unload=function(Fa){this.offAll()},Fc._cloneTo=function(Fa){},Fq(0,Fc,"id",function(){return this._id}),Fq(0,Fc,"destroyed",function(){return this._destroyed}),Fq(0,Fc,"owner",function(){return this._owner}),Fq(0,Fc,"enable",function(){return this._enable},function(Fa){this._enable!==Fa&&(this._enable=Fa,this.event("enablechanged",this._enable))}),Fq(0,Fc,"isSingleton",function(){return Fb._isSingleton}),Fb._isSingleton=!0,Fb._uniqueIDCounter=1,Fb}(),Fwb=function(Fa){function Fb(){this._destroyed=!1,Fb.__super.call(this),this._destroyed=!1}Fp(Fb,"laya.d3.core.GeometryFilter",Ff);var Fc=Fb.prototype;return Fx.imps(Fc,{"laya.resource.IDestroy":!0}),Fc._destroy=function(){this.offAll(),this._destroyed=!0},Fq(0,Fc,"_isAsyncLoaded",function(){return!0}),Fq(0,Fc,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),Fq(0,Fc,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),Fq(0,Fc,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),Fq(0,Fc,"destroyed",function(){return this._destroyed}),Fb}(),Fxb=function(Fa){function Fd(Fa){Fd.__super.call(this),this._id=++Fd._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new FZa(new Fgb,new Fgb),this._boundingBoxCenter=new Fgb,this._boundingSphere=new F_a(new Fgb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=Fa,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}Fp(Fd,"laya.d3.core.render.BaseRender",Ff);var Fb=Fd.prototype;return Fx.imps(Fb,{"laya.resource.IDestroy":!0}),Fb._changeMaterialReference=function(Fa,Fb){Fa&&Fa._removeReference(),Fb._addReference()},Fb._getInstanceMaterial=function(Fa,Fb){var Fc=new Fa.constructor;return Fa.cloneTo(Fc),Fc.name=Fc.name+"(Instance)",this._materialsInstance[Fb]=!0,this._changeMaterialReference(this._materials[Fb],Fc),this._materials[Fb]=Fc},Fb._setShaderValuelightMap=function(Fa){this._setShaderValueTexture(3,Fa)},Fb._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},Fb._renderRenderableBoundBox=function(){var Fa=Ftb._debugPhasorSprite,Fb=this.boundingBox,Fc=Fd._tempBoundBoxCorners;Fb.getCorners(Fc),Fa.line(Fc[0],Fd._greenColor,Fc[1],Fd._greenColor),Fa.line(Fc[2],Fd._greenColor,Fc[3],Fd._greenColor),Fa.line(Fc[4],Fd._greenColor,Fc[5],Fd._greenColor),Fa.line(Fc[6],Fd._greenColor,Fc[7],Fd._greenColor),Fa.line(Fc[0],Fd._greenColor,Fc[3],Fd._greenColor),Fa.line(Fc[1],Fd._greenColor,Fc[2],Fd._greenColor),Fa.line(Fc[2],Fd._greenColor,Fc[6],Fd._greenColor),Fa.line(Fc[3],Fd._greenColor,Fc[7],Fd._greenColor),Fa.line(Fc[0],Fd._greenColor,Fc[4],Fd._greenColor),Fa.line(Fc[1],Fd._greenColor,Fc[5],Fd._greenColor),Fa.line(Fc[4],Fd._greenColor,Fc[7],Fd._greenColor),Fa.line(Fc[5],Fd._greenColor,Fc[6],Fd._greenColor)},Fb._calculateBoundingSphere=function(){throw"BaseRender: must override it."},Fb._calculateBoundingBox=function(){throw"BaseRender: must override it."},Fb._setShaderValueTexture=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb)},Fb._setShaderValueMatrix4x4=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb?Fb.elements:null)},Fb._setShaderValueColor=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb?Fb.elements:null)},Fb._setShaderValueBuffer=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb)},Fb._setShaderValueInt=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb)},Fb._setShaderValueBool=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb)},Fb._setShaderValueNumber=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb)},Fb._setShaderValueVector2=function(Fa,Fb){this._owner._shaderValues.setValue(Fa,Fb?Fb.elements:null)},Fb._addShaderDefine=function(Fa){this._owner._shaderDefineValue|=Fa},Fb._removeShaderDefine=function(Fa){this._owner._shaderDefineValue&=~Fa},Fb._renderUpdate=function(Fa){return!0},Fb._applyLightMapParams=function(){if(0<=this._lightmapIndex){var Fa=this._owner.scene;if(Fa){var Fb=Fa.getlightmaps()[this._lightmapIndex];Fb?(this._addShaderDefine(FVb.SAHDERDEFINE_LIGHTMAP),Fb.loaded?this._setShaderValuelightMap(Fb):Fb.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(FVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(FVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(FVb.SAHDERDEFINE_LIGHTMAP)},Fb._updateOctreeNode=function(){var Fa=this._treeNode;Fa&&this._octreeNodeNeedChange&&(Fa.updateObject(this),this._octreeNodeNeedChange=!1)},Fb._destroy=function(){this.offAll();var Fa=0,Fb=0;for(Fa=0,Fb=this._renderElements.length;Fa<Fb;Fa++)this._renderElements[Fa]._destroy();for(Fa=0,Fb=this._materials.length;Fa<Fb;Fa++)this._materials[Fa]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},Fq(0,Fb,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),Fq(0,Fb,"id",function(){return this._id}),Fq(0,Fb,"material",function(){var Fa=this._materials[0];if(Fa&&!this._materialsInstance[0]){var Fb=this._getInstanceMaterial(Fa,0);this.event("materialchanged",[this,0,Fb])}return this._materials[0]},function(Fa){this.sharedMaterial=Fa}),Fq(0,Fb,"sharedMaterial",function(){return this._materials[0]},function(Fa){var Fb=this._materials[0];Fb!==Fa&&(this._materials[0]=Fa,this._materialsInstance[0]=!1,this._changeMaterialReference(Fb,Fa),this.event("materialchanged",[this,0,Fa]))}),Fq(0,Fb,"lightmapIndex",function(){return this._lightmapIndex},function(Fa){this._lightmapIndex=Fa,this._applyLightMapParams()}),Fq(0,Fb,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(Fa){this._lightmapScaleOffset=Fa,this._setShaderValueColor(2,Fa),this._addShaderDefine(FVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),Fq(0,Fb,"enable",function(){return this._enable},function(Fa){this._enable=Fa,this.event("enablechanged",[this,Fa])}),Fq(0,Fb,"materials",function(){for(var Fa=0,Fb=this._materials.length;Fa<Fb;Fa++)if(!this._materialsInstance[Fa]){var Fc=this._getInstanceMaterial(this._materials[Fa],Fa);this.event("materialchanged",[this,Fa,Fc])}return this._materials.slice()},function(Fa){this.sharedMaterials=Fa}),Fq(0,Fb,"sharedMaterials",function(){return this._materials.slice()},function(Fa){if(!Fa)throw new Error("MeshRender: shadredMaterials value can't be null.");var Fb=Fa.length;this._materialsInstance.length=Fb;for(var Fc=0;Fc<Fb;Fc++){var Fd=this._materials[Fc];Fd!==Fa[Fc]&&(this._materialsInstance[Fc]=!1,this._changeMaterialReference(Fd,Fa[Fc]),this.event("materialchanged",[this,Fc,Fa[Fc]]))}this._materials=Fa}),Fq(0,Fb,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),Fq(0,Fb,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var Fa=this.boundingBox;Fgb.add(Fa.min,Fa.max,this._boundingBoxCenter),Fgb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),Fq(0,Fb,"receiveShadow",function(){return this._receiveShadow},function(Fa){this._receiveShadow!==Fa&&((this._receiveShadow=Fa)?this._addShaderDefine(Fpb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(Fpb.SHADERDEFINE_RECEIVE_SHADOW))}),Fq(0,Fb,"destroyed",function(){return this._destroyed}),Fd._uniqueIDCounter=0,Fn(Fd,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb,new Fgb]},"_greenColor",function(){return this._greenColor=new Fhb(0,1,0,1)}]),Fd}(),Fyb=function(Fa){function Fh(Fa){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,Fh.__super.call(this),this._localPosition=new Fgb,this._localRotation=new Fcb(0,0,0,1),this._localScale=new Fgb(1,1,1),this._localRotationEuler=new Fgb,this._localMatrix=new Fab,this._position=new Fgb,this._rotation=new Fcb(0,0,0,1),this._scale=new Fgb(1,1,1),this._worldMatrix=new Fab,this._forward=new Fgb,this._up=new Fgb,this._right=new Fgb,this._owner=Fa,this._childs=[]}Fp(Fh,"laya.d3.core.Transform3D",Ff);var Fb=Fh.prototype;return Fb._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)Fab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var Fa=Fh._tempVector30;Fgb.multiply(this.pivot,this._localScale,Fa);var Fb=Fh._tempVector31;Fgb.subtract(Fa,this.pivot,Fb);var Fc=Fh._tempVector32,Fd=this.localRotation;Fgb.transformQuat(Fa,Fd,Fc),Fgb.subtract(Fc,Fa,Fc);var Fe=Fh._tempVector33;Fgb.subtract(this._localPosition,Fb,Fe),Fgb.subtract(Fe,Fc,Fe),Fab.createAffineTransformation(Fe,Fd,this._localScale,this._localMatrix)}},Fb._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._onWorldPositionRotationTransform()}},Fb._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._onWorldPositionScaleTransform()}},Fb._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._onWorldPositionTransform()}},Fb._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._onWorldPositionRotationTransform()}},Fb._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._onWorldPositionScaleTransform()}},Fb._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._onWorldTransform()}},Fb.translate=function(Fa,Fb){void 0===Fb&&(Fb=!0),Fb?(Fab.createFromQuaternion(this.localRotation,Fh._tempMatrix0),Fgb.transformCoordinate(Fa,Fh._tempMatrix0,Fh._tempVector30),Fgb.add(this.localPosition,Fh._tempVector30,this._localPosition),this.localPosition=this._localPosition):(Fgb.add(this.position,Fa,this._position),this.position=this._position)},Fb.rotate=function(Fa,Fb,Fc){var Fd;void 0===Fb&&(Fb=!0),void 0===Fc&&(Fc=!0),Fd=Fc?Fa:(Fgb.scale(Fa,Math.PI/180,Fh._tempVector30),Fh._tempVector30),Fcb.createFromYawPitchRoll(Fd.y,Fd.x,Fd.z,Fh._tempQuaternion0),Fb?(Fcb.multiply(this._localRotation,Fh._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(Fcb.multiply(Fh._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},Fb.lookAt=function(Fa,Fb,Fc){void 0===Fc&&(Fc=!1);var Fd,Fe=Fa.elements;if(Fc){if(Fd=this._localPosition.elements,Math.abs(Fd[0]-Fe[0])<Fka.zeroTolerance&&Math.abs(Fd[1]-Fe[1])<Fka.zeroTolerance&&Math.abs(Fd[2]-Fe[2])<Fka.zeroTolerance)return;Fcb.lookAt(this._localPosition,Fa,Fb,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var Ff=this.position;if(Fd=Ff.elements,Math.abs(Fd[0]-Fe[0])<Fka.zeroTolerance&&Math.abs(Fd[1]-Fe[1])<Fka.zeroTolerance&&Math.abs(Fd[2]-Fe[2])<Fka.zeroTolerance)return;Fcb.lookAt(Ff,Fa,Fb,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},Fq(0,Fb,"_isFrontFaceInvert",function(){var Fa=this.scale,Fb=Fa.x<0;return Fa.y<0&&(Fb=!Fb),Fa.z<0&&(Fb=!Fb),Fb}),Fq(0,Fb,"owner",function(){return this._owner}),Fq(0,Fb,"localRotation",function(){if(this._localQuaternionUpdate){var Fa=this._localRotationEuler.elements;Fcb.createFromYawPitchRoll(Fa[1]/Fh._angleToRandin,Fa[0]/Fh._angleToRandin,Fa[2]/Fh._angleToRandin,this._localRotation)}return this._localRotation},function(Fa){this._localRotation=Fa,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Fq(0,Fb,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?Fab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(Fa){null===this._parent?Fa.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Fab.multiply(this._localMatrix,Fa,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=Fa,this._worldUpdate=!1}),Fq(0,Fb,"worldNeedUpdate",function(){return this._worldUpdate}),Fq(0,Fb,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(Fa){this._localMatrix=Fa,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),Fq(0,Fb,"dummy",function(){return this._dummy},function(Fa){this._dummy!==Fa&&(this._dummy&&(this._dummy._entity=null),Fa&&(Fa._entity=this),this._dummy=Fa)}),Fq(0,Fb,"localPosition",function(){return this._localPosition},function(Fa){this._localPosition=Fa,this._localUpdate=!0,this._onWorldPositionTransform()}),Fq(0,Fb,"position",function(){if(this._positionUpdate){if(null!=this._parent){var Fa=this._parent.position;Fgb.multiply(this._localPosition,this._parent.scale,Fh._tempVector30),Fgb.transformQuat(Fh._tempVector30,this._parent.rotation,Fh._tempVector30),Fgb.add(Fa,Fh._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(Fa){if(null!=this._parent){Fgb.subtract(Fa,this._parent.position,this._localPosition);var Fb=this._parent.scale.elements,Fc=Fb[0],Fd=Fb[1],Fe=Fb[2];if(1!==Fc||1!==Fd||1!==Fe){var Ff=Fh._tempVector30,Fg=Ff.elements;Fg[0]=1/Fc,Fg[1]=1/Fd,Fg[2]=1/Fe,Fgb.multiply(this._localPosition,Ff,this._localPosition)}this._parent.rotation.invert(Fh._tempQuaternion0),Fgb.transformQuat(this._localPosition,Fh._tempQuaternion0,this._localPosition)}else Fa.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=Fa,this._positionUpdate=!1}),Fq(0,Fb,"localScale",function(){return this._localScale},function(Fa){this._localScale=Fa,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),Fq(0,Fb,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(Fh._tempVector30);var Fa=Fh._tempVector30.elements,Fb=this._localRotationEuler.elements;Fb[0]=Fa[1]*Fh._angleToRandin,Fb[1]=Fa[0]*Fh._angleToRandin,Fb[2]=Fa[2]*Fh._angleToRandin}return this._localRotationEuler},function(Fa){this._localRotationEuler=Fa,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Fq(0,Fb,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?Fcb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(Fa){null!=this._parent?(this._parent.rotation.invert(Fh._tempQuaternion0),Fcb.multiply(Fa,Fh._tempQuaternion0,this._localRotation)):Fa.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=Fa,this._rotationUpdate=!1}),Fq(0,Fb,"scale",function(){return this._scaleUpdate&&(null!==this._parent?Fgb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(Fa){if(null!==this._parent){var Fb=this._parent.scale.elements,Fc=Fh._tempVector30.elements;Fc[0]=1/Fb[0],Fc[1]=1/Fb[1],Fc[2]=1/Fb[2],Fgb.multiply(Fa,Fh._tempVector30,this._localScale)}else Fa.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=Fa,this._scaleUpdate=!1}),Fq(0,Fb,"rotationEuler",null,function(Fa){Fcb.createFromYawPitchRoll(Fa.y,Fa.x,Fa.z,this._rotation),this.rotation=this._rotation}),Fq(0,Fb,"forward",function(){var Fa=this.worldMatrix.elements;return this._forward.elements[0]=-Fa[8],this._forward.elements[1]=-Fa[9],this._forward.elements[2]=-Fa[10],this._forward}),Fq(0,Fb,"up",function(){var Fa=this.worldMatrix.elements;return this._up.elements[0]=Fa[4],this._up.elements[1]=Fa[5],this._up.elements[2]=Fa[6],this._up}),Fq(0,Fb,"right",function(){var Fa=this.worldMatrix.elements;return this._right.elements[0]=Fa[0],this._right.elements[1]=Fa[1],this._right.elements[2]=Fa[2],this._right}),Fq(0,Fb,"parent",function(){return this._parent},function(Fa){if(this._parent!==Fa){if(this._parent){var Fb=this._parent._childs,Fc=Fb.indexOf(this);Fb.splice(Fc,1)}Fa&&(Fa._childs.push(this),Fa&&this._onWorldTransform()),this._parent=Fa}}),Fn(Fh,["_tempVector30",function(){return this._tempVector30=new Fgb},"_tempVector31",function(){return this._tempVector31=new Fgb},"_tempVector32",function(){return this._tempVector32=new Fgb},"_tempVector33",function(){return this._tempVector33=new Fgb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Fcb},"_tempMatrix0",function(){return this._tempMatrix0=new Fab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Fh}(),Fzb=(function(Fa){function Fb(){this._rotation=0,this._matNeedUpdte=!1,Fb.__super.call(this),this._matrix=new Fab,this._offset=new Ffb,this._tiling=new Ffb(1,1)}Fp(Fb,"laya.d3.core.TransformUV",Ff);var Fc=Fb.prototype;Fx.imps(Fc,{"laya.d3.core.IClone":!0}),Fc._updateMatrix=function(){Fb._tempOffsetV3.elements[0]=this._offset.x,Fb._tempOffsetV3.elements[1]=this._offset.y,Fcb.createFromYawPitchRoll(0,0,this._rotation,Fb._tempRotationQua),Fb._tempTitlingV3.elements[0]=this._tiling.x,Fb._tempTitlingV3.elements[1]=this._tiling.y,Fab.createAffineTransformation(Fb._tempOffsetV3,Fb._tempRotationQua,Fb._tempTitlingV3,this._matrix)},Fc.cloneTo=function(Fa){Fa._matrix=this._matrix.clone(),Fa._offset=this._offset.clone(),Fa._rotation=this._rotation,Fa._tiling=this._tiling.clone()},Fc.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fc,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),Fq(0,Fc,"tiling",function(){return this._tiling},function(Fa){this._tiling=Fa,this._matNeedUpdte=!0}),Fq(0,Fc,"offset",function(){return this._offset},function(Fa){this._offset=Fa,this._matNeedUpdte=!0}),Fq(0,Fc,"rotation",function(){return this._rotation},function(Fa){this._rotation=Fa,this._matNeedUpdte=!0}),Fn(Fb,["_tempOffsetV3",function(){return this._tempOffsetV3=new Fgb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new Fcb},"_tempTitlingV3",function(){return this._tempTitlingV3=new Fgb(1,1,1)}])}(),function(Fc){function Fa(){this.x=NaN,this.y=NaN,this.z=NaN,Fa.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}Fp(Fa,"laya.d3.core.particleShuriKen.module.shape.BoxShape",Fc);var Fb=Fa.prototype;Fb._getShapeBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=.5*-this.x,Fb[1]=.5*-this.y,Fb[2]=.5*-this.z;var Fc=Fa.max.elements;Fc[0]=.5*this.x,Fc[1]=.5*this.y,Fc[2]=.5*this.z},Fb._getSpeedBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=0,Fb[1]=0,Fb[2]=0;var Fc=Fa.max.elements;Fc[0]=0,Fc[1]=1,Fc[2]=0},Fb.generatePositionAndDirection=function(Fa,Fb,Fc,Fd){var Fe=Fa.elements,Ff=Fb.elements;Fc?(Fc.seed=Fd[16],FT._randomPointInsideHalfUnitBox(Fa,Fc),Fd[16]=Fc.seed):FT._randomPointInsideHalfUnitBox(Fa),Fe[0]=this.x*Fe[0],Fe[1]=this.y*Fe[1],Fe[2]=this.z*Fe[2],this.randomDirection?Fc?(Fc.seed=Fd[17],FT._randomPointUnitSphere(Fb,Fc),Fd[17]=Fc.seed):FT._randomPointUnitSphere(Fb):(Ff[0]=0,Ff[1]=0,Ff[2]=1)},Fb.cloneTo=function(Fa){Fc.prototype.cloneTo.call(this,Fa);var Fb=Fa;Fb.x=this.x,Fb.y=this.y,Fb.z=this.z,Fb.randomDirection=this.randomDirection}}(FO),function(Fc){function Fg(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,Fg.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}Fp(Fg,"laya.d3.core.particleShuriKen.module.shape.CircleShape",Fc);var Fa=Fg.prototype;Fa._getShapeBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=Fb[2]=-this.radius,Fb[1]=0;var Fc=Fa.max.elements;Fc[0]=Fc[2]=this.radius,Fc[1]=0},Fa._getSpeedBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=Fb[1]=-1,Fb[2]=0;var Fc=Fa.max.elements;Fc[0]=Fc[1]=1,Fc[2]=0},Fa.generatePositionAndDirection=function(Fa,Fb,Fc,Fd){var Fe=Fa.elements,Ff=Fg._tempPositionPoint.elements;Fc?(Fc.seed=Fd[16],this.emitFromEdge?FT._randomPointUnitArcCircle(this.arc,Fg._tempPositionPoint,Fc):FT._randomPointInsideUnitArcCircle(this.arc,Fg._tempPositionPoint,Fc),Fd[16]=Fc.seed):this.emitFromEdge?FT._randomPointUnitArcCircle(this.arc,Fg._tempPositionPoint):FT._randomPointInsideUnitArcCircle(this.arc,Fg._tempPositionPoint),Fe[0]=-Ff[0],Fe[1]=Ff[1],Fe[2]=0,Fgb.scale(Fa,this.radius,Fa),this.randomDirection?Fc?(Fc.seed=Fd[17],FT._randomPointUnitSphere(Fb,Fc),Fd[17]=Fc.seed):FT._randomPointUnitSphere(Fb):Fa.cloneTo(Fb)},Fa.cloneTo=function(Fa){Fc.prototype.cloneTo.call(this,Fa);var Fb=Fa;Fb.radius=this.radius,Fb.arc=this.arc,Fb.emitFromEdge=this.emitFromEdge,Fb.randomDirection=this.randomDirection},Fn(Fg,["_tempPositionPoint",function(){return this._tempPositionPoint=new Ffb}])}(FO),function(Fc){function Fo(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,Fo.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}Fp(Fo,"laya.d3.core.particleShuriKen.module.shape.ConeShape",Fc);var Fa=Fo.prototype;Fa._getShapeBoundBox=function(Fa){var Fb=this.radius+this.length*Math.sin(this.angle),Fc=this.length*Math.cos(this.angle),Fd=Fa.min.elements;Fd[0]=Fd[1]=-Fb,Fd[2]=0;var Fe=Fa.max.elements;Fe[0]=Fe[1]=Fb,Fe[2]=Fc},Fa._getSpeedBoundBox=function(Fa){var Fb=Math.sin(this.angle),Fc=Fa.min.elements;Fc[0]=Fc[1]=-Fb,Fc[2]=0;var Fd=Fa.max.elements;Fd[0]=Fc[1]=Fb,Fd[2]=1},Fa.generatePositionAndDirection=function(Fa,Fb,Fc,Fd){var Fe,Ff=Fa.elements,Fg=Fb.elements,Fh=Fo._tempPositionPoint.elements,Fi=NaN,Fj=NaN,Fm=Math.cos(this.angle),Fn=Math.sin(this.angle);switch(this.emitType){case 0:Fc?(Fc.seed=Fd[16],FT._randomPointInsideUnitCircle(Fo._tempPositionPoint,Fc),Fd[16]=Fc.seed):FT._randomPointInsideUnitCircle(Fo._tempPositionPoint),Fi=Fh[0],Fj=Fh[1],Ff[0]=Fi*this.radius,Ff[1]=Fj*this.radius,Ff[2]=0,this.randomDirection?(Fc?(Fc.seed=Fd[17],FT._randomPointInsideUnitCircle(Fo._tempDirectionPoint,Fc),Fd[17]=Fc.seed):FT._randomPointInsideUnitCircle(Fo._tempDirectionPoint),Fe=Fo._tempDirectionPoint.elements,Fg[0]=Fe[0]*Fn,Fg[1]=Fe[1]*Fn):(Fg[0]=Fi*Fn,Fg[1]=Fj*Fn),Fg[2]=Fm;break;case 1:Fc?(Fc.seed=Fd[16],FT._randomPointUnitCircle(Fo._tempPositionPoint,Fc),Fd[16]=Fc.seed):FT._randomPointUnitCircle(Fo._tempPositionPoint),Fi=Fh[0],Fj=Fh[1],Ff[0]=Fi*this.radius,Ff[1]=Fj*this.radius,Ff[2]=0,this.randomDirection?(Fc?(Fc.seed=Fd[17],FT._randomPointInsideUnitCircle(Fo._tempDirectionPoint,Fc),Fd[17]=Fc.seed):FT._randomPointInsideUnitCircle(Fo._tempDirectionPoint),Fe=Fo._tempDirectionPoint.elements,Fg[0]=Fe[0]*Fn,Fg[1]=Fe[1]*Fn):(Fg[0]=Fi*Fn,Fg[1]=Fj*Fn),Fg[2]=Fm;break;case 2:Fc?(Fc.seed=Fd[16],FT._randomPointInsideUnitCircle(Fo._tempPositionPoint,Fc)):FT._randomPointInsideUnitCircle(Fo._tempPositionPoint),Fi=Fh[0],Fj=Fh[1],Ff[0]=Fi*this.radius,Ff[1]=Fj*this.radius,Fg[Ff[2]=0]=Fi*Fn,Fg[1]=Fj*Fn,Fg[2]=Fm,Fgb.normalize(Fb,Fb),Fc?(Fgb.scale(Fb,this.length*Fc.getFloat(),Fb),Fd[16]=Fc.seed):Fgb.scale(Fb,this.length*Math.random(),Fb),Fgb.add(Fa,Fb,Fa),this.randomDirection&&(Fc?(Fc.seed=Fd[17],FT._randomPointUnitSphere(Fb,Fc),Fd[17]=Fc.seed):FT._randomPointUnitSphere(Fb));break;case 3:Fc?(Fc.seed=Fd[16],FT._randomPointUnitCircle(Fo._tempPositionPoint,Fc)):FT._randomPointUnitCircle(Fo._tempPositionPoint),Fi=Fh[0],Fj=Fh[1],Ff[0]=Fi*this.radius,Ff[1]=Fj*this.radius,Fg[Ff[2]=0]=Fi*Fn,Fg[1]=Fj*Fn,Fg[2]=Fm,Fgb.normalize(Fb,Fb),Fc?(Fgb.scale(Fb,this.length*Fc.getFloat(),Fb),Fd[16]=Fc.seed):Fgb.scale(Fb,this.length*Math.random(),Fb),Fgb.add(Fa,Fb,Fa),this.randomDirection&&(Fc?(Fc.seed=Fd[17],FT._randomPointUnitSphere(Fb,Fc),Fd[17]=Fc.seed):FT._randomPointUnitSphere(Fb));break;default:throw new Error("ConeShape:emitType is invalid.")}},Fa.cloneTo=function(Fa){Fc.prototype.cloneTo.call(this,Fa);var Fb=Fa;Fb.angle=this.angle,Fb.radius=this.radius,Fb.length=this.length,Fb.emitType=this.emitType,Fb.randomDirection=this.randomDirection},Fn(Fo,["_tempPositionPoint",function(){return this._tempPositionPoint=new Ffb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new Ffb}])}(FO),function(Fc){function Fa(){this.radius=NaN,this.emitFromShell=!1,Fa.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Fp(Fa,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",Fc);var Fb=Fa.prototype;Fb._getShapeBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=Fb[1]=Fb[2]=-this.radius;var Fc=Fa.max.elements;Fc[0]=Fc[1]=this.radius,Fc[2]=0},Fb._getSpeedBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=Fb[1]=-1,Fb[2]=0;var Fc=Fa.max.elements;Fc[0]=Fc[1]=Fc[2]=1},Fb.generatePositionAndDirection=function(Fa,Fb,Fc,Fd){var Fe=Fa.elements;Fc?(Fc.seed=Fd[16],this.emitFromShell?FT._randomPointUnitSphere(Fa,Fc):FT._randomPointInsideUnitSphere(Fa,Fc),Fd[16]=Fc.seed):this.emitFromShell?FT._randomPointUnitSphere(Fa):FT._randomPointInsideUnitSphere(Fa),Fgb.scale(Fa,this.radius,Fa);var Ff=Fe[2];Ff<0&&(Fe[2]=-1*Ff),this.randomDirection?Fc?(Fc.seed=Fd[17],FT._randomPointUnitSphere(Fb,Fc),Fd[17]=Fc.seed):FT._randomPointUnitSphere(Fb):Fa.cloneTo(Fb)},Fb.cloneTo=function(Fa){Fc.prototype.cloneTo.call(this,Fa);var Fb=Fa;Fb.radius=this.radius,Fb.emitFromShell=this.emitFromShell,Fb.randomDirection=this.randomDirection}}(FO),function(Fc){function Fa(){this.radius=NaN,this.emitFromShell=!1,Fa.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Fp(Fa,"laya.d3.core.particleShuriKen.module.shape.SphereShape",Fc);var Fb=Fa.prototype;Fb._getShapeBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=Fb[1]=Fb[2]=-this.radius;var Fc=Fa.max.elements;Fc[0]=Fc[1]=Fc[2]=this.radius},Fb._getSpeedBoundBox=function(Fa){var Fb=Fa.min.elements;Fb[0]=Fb[1]=Fb[2]=-1;var Fc=Fa.max.elements;Fc[0]=Fc[1]=Fc[2]=1},Fb.generatePositionAndDirection=function(Fa,Fb,Fc,Fd){Fc?(Fc.seed=Fd[16],this.emitFromShell?FT._randomPointUnitSphere(Fa,Fc):FT._randomPointInsideUnitSphere(Fa,Fc),Fd[16]=Fc.seed):this.emitFromShell?FT._randomPointUnitSphere(Fa):FT._randomPointInsideUnitSphere(Fa),Fgb.scale(Fa,this.radius,Fa),this.randomDirection?Fc?(Fc.seed=Fd[17],FT._randomPointUnitSphere(Fb,Fc),Fd[17]=Fc.seed):FT._randomPointUnitSphere(Fb):Fa.cloneTo(Fb)},Fb.cloneTo=function(Fa){Fc.prototype.cloneTo.call(this,Fa);var Fb=Fa;Fb.radius=this.radius,Fb.emitFromShell=this.emitFromShell,Fb.randomDirection=this.randomDirection}}(FO),function(Fa){function Fb(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,Fb.__super.call(this)}return Fp(Fb,"laya.d3.core.render.SubMeshRenderElement",FW),Fb}()),FAb=function(Fa){function Fs(Fa,Fb,Fc,Fd,Fe,Ff){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=Fa,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[Fpb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[FVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[FVb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[FEb.SHADERDEFINE_ALPHATEST]="ALPHATEST";Fs.__super.call(this,Fa,Fb,Fc,null,{}),this._attributeMap=Fd;var Fg;for(Fg in Fe){var Fh=Fe[Fg];switch(Fh[1]){case 0:this._renderElementUniformMap[Fg]=Fh[0];break;case 1:this._materialUniformMap[Fg]=Fh[0];break;case 2:this._spriteUniformMap[Fg]=Fh[0];break;case 3:this._cameraUniformMap[Fg]=Fh[0];break;case 4:this._sceneUniformMap[Fg]=Fh[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}Fp(Fs,"laya.d3.shader.ShaderCompile3D",Fv);var Fb=Fs.prototype;return Fb._definesToNameDic=function(Fa,Fb){for(var Fc={},Fd=1,Fe=0;Fe<32&&!(Fa<(Fd=1<<Fe));Fe++)if(Fa&Fd){var Ff=Fb[Fd];Ff&&(Fc[Ff]="")}return Fc},Fb.withCompile=function(Fa,Fb,Fc,Fd){var Fe,Ff,Fg;if(Ff=this.sharders[Fa])if(Fg=Ff[Fb]){if(Fe=Fg[Fc])return Fe}else Fg=Ff[Fb]=[];else Fg=(Ff=this.sharders[Fa]=[])[Fb]=[];var Fh,Fi=this._definesToNameDic(Fa,Fs._globalInt2name),Fj=this._definesToNameDic(Fb,this._spriteInt2name),Fm=this._definesToNameDic(Fc,this._materialInt2name),Fn={},Fo="";if(Fi)for(Fh in Fi)Fo+="#define "+Fh+"\n",Fn[Fh]=!0;if(Fj)for(Fh in Fj)Fo+="#define "+Fh+"\n",Fn[Fh]=!0;if(Fm)for(Fh in Fm)Fo+="#define "+Fh+"\n",Fn[Fh]=!0;var Fp=FLb.nameKey.getName(this._name)+" compile ("+Fa+","+Fb+","+Fc+")",Fq=this._VS.toscript(Fn,[]),Fr=this._PS.toscript(Fn,[]);FH.now();if(Fe=FLb.create(Fo+Fq.join("\n"),Fo+Fr.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,Fd,Fp),Fg[Fc]=Fe,laya.d3.shader.ShaderCompile3D.debugMode)FH.now();return Fe},Fb.precompileShaderWithShaderDefine=function(Fa,Fb,Fc){this.withCompile(Fa,Fb,Fc,!0)},Fb.addMaterialDefines=function(Fa){var Fb=Fa.defines;for(var Fc in Fb){var Fd=Fb[Fc],Fe=parseInt(Fc);this._materialInt2name[Fe]=Fd,this._materialName2Int[Fd]=Fe}},Fb.addSpriteDefines=function(Fa){var Fb=Fa.defines;for(var Fc in Fb){var Fd=Fb[Fc],Fe=parseInt(Fc);this._spriteInt2name[Fe]=Fd,this._spriteName2Int[Fd]=Fe}},Fb.getMaterialDefineByName=function(Fa){return this._materialName2Int[Fa]},Fb.registerMaterialDefine=function(Fa){var Fb=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[Fb]=Fa,this._materialName2Int[Fa]=Fb},Fb.registerSpriteDefine=function(Fa){var Fb=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[Fb]=Fa,this._spriteName2Int[Fa]=Fb},Fs._globalRegDefine=function(Fa,Fb){Fs._globalInt2name[Fb]=Fa},Fs.add=function(Fa,Fb,Fc,Fd,Fe){return laya.d3.shader.ShaderCompile3D._preCompileShader[Fa]=new Fs(Fa,Fb,Fc,Fd,Fe,Fv.includes)},Fs.get=function(Fa){return laya.d3.shader.ShaderCompile3D._preCompileShader[FLb.nameKey.getID(Fa)]},Fs._preCompileShader={},Fs._globalInt2name=[],Fs.debugMode=!1,Fs.SHADERDEFINE_HIGHPRECISION=1,Fs.SHADERDEFINE_FOG=4,Fs.SHADERDEFINE_DIRECTIONLIGHT=8,Fs.SHADERDEFINE_POINTLIGHT=16,Fs.SHADERDEFINE_SPOTLIGHT=32,Fs.SHADERDEFINE_UV0=64,Fs.SHADERDEFINE_COLOR=128,Fs.SHADERDEFINE_UV1=256,Fs.SAHDERDEFINE_DEPTHFOG=131072,Fs}(),FBb=function(Fa){function Fq(){Fq.__super.call(this)}Fp(Fq,"laya.d3.graphics.MeshSprite3DStaticBatchManager",Fda);var Fb=Fq.prototype;return Fb._getStaticBatch=function(Fa,Fb,Fc,Fd){var Fe,Ff;return Ff=Fa?Fa.id.toString()+Fc.id.toString()+Fb.id.toString()+Fd.toString():Fc.id.toString()+Fb.id.toString()+Fd.toString(),this._staticBatches[Ff]?Fe=this._staticBatches[Ff]:this._staticBatches[Ff]=Fe=new FCb(Ff,this,Fa,Fb,Fc),Fe},Fb._initStaticBatchs=function(Fa){var Fb,Fc;this._initBatchRenderElements.sort(Fq._sortPrepareStaticBatch);for(var Fd,Fe=!1,Ff=0,Fg=0,Fh=this._initBatchRenderElements.length;Fg<Fh;Fg++){var Fi,Fj=this._initBatchRenderElements[Fg],Fm=Fj.renderObj._getVertexBuffer(0);Fj._sprite3D;if(Fc===Fm.vertexDeclaration&&Fb===Fj._material)if(Fe)Fd._addCombineBatchRenderObjTest(Fj)?(Fi=Fj._staticBatch)!==Fd&&(Fi&&Fi._deleteCombineBatchRenderObj(Fj),Fd._addCombineBatchRenderObj(Fj)):(Fe=!1,Ff++);else{var Fn=this._initBatchRenderElements[Fg-1],Fo=Fn.renderObj,Fp=Fj.renderObj;Fe=!(65535<Fo._getVertexBuffer().vertexCount+Fp._getVertexBuffer().vertexCount)&&(Fd=this._getStaticBatch(Fa,Fc,Fb,Ff),(Fi=Fn._staticBatch)!==Fd&&(Fi&&Fi._deleteCombineBatchRenderObj(Fn),Fd._addCombineBatchRenderObj(Fn)),(Fi=Fj._staticBatch)!==Fd&&(Fi&&Fi._deleteCombineBatchRenderObj(Fj),Fd._addCombineBatchRenderObj(Fj)),!0)}else Fe=!1,Ff=0;Fb=Fj._material,Fc=Fm.vertexDeclaration}},Fq._sortPrepareStaticBatch=function(Fa,Fb){var Fc=Fa._render,Fd=Fb._render,Fe=Fc.lightmapIndex-Fd.lightmapIndex;if(0!=Fe)return Fe;var Ff=Fc.receiveShadow-Fd.receiveShadow;if(0!=Ff)return Ff;var Fg=Fa._mainSortID-Fb._mainSortID;return 0==Fg?Fa.renderObj.triangleCount-Fb.renderObj.triangleCount:Fg},Fq}(),FCb=function(Fa){function Ff(Fa,Fb,Fc,Fd,Fe){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,Ff.__super.call(this,Fa,Fb,Fc),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=Fd,this._material=Fe}Fp(Ff,"laya.d3.graphics.SubMeshStaticBatch",Fea);var Fb=Ff.prototype;return Fb._compareBatchRenderElement=function(Fa,Fb){return Fa._batchIndexStart>Fb._batchIndexStart},Fb._addCombineBatchRenderObjTest=function(Fa){var Fb=Fa.renderObj._vertexCount;return!(65535<(0<Fb?this._currentCombineVertexCount+Fb:this._currentCombineVertexCount+Fa.renderObj._getVertexBuffer().vertexCount))},Fb._addCombineBatchRenderObj=function(Fa){var Fb=Fa.renderObj,Fc=Fb._vertexCount;this._initBatchRenderElements.push(Fa),Fa._staticBatch=this,0<Fc?(this._currentCombineIndexCount+=Fb._indexCount,this._currentCombineVertexCount+=Fc):(this._currentCombineIndexCount=this._currentCombineIndexCount+Fb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Fb._getVertexBuffer().vertexCount),this._needFinishCombine=!0},Fb._deleteCombineBatchRenderObj=function(Fa){var Fb=Fa.renderObj,Fc=this._initBatchRenderElements.indexOf(Fa);if(-1!==Fc){this._initBatchRenderElements.splice(Fc,1),Fa._staticBatch=null;var Fd=Fb._vertexCount;0<Fd?(this._currentCombineIndexCount=this._currentCombineIndexCount-Fb._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Fd):(this._currentCombineIndexCount=this._currentCombineIndexCount-Fb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Fb._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},Fb._finishInit=function(){if(this._needFinishCombine){var Fa=0,Fb=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var Fc=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),Fd=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=FOb.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=FNb.create("ushort",this._currentCombineIndexCount,35044);for(var Fe=0,Ff=this._initBatchRenderElements.length;Fe<Ff;Fe++){var Fg=this._initBatchRenderElements[Fe],Fh=Fg.renderObj,Fi=Fh._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,Fg._sprite3D),Fj=Fh.getIndices(),Fm=Fg._sprite3D.transform._isFrontFaceInvert,Fn=Fa/(this._vertexDeclaration.vertexStride/4)-Fh._vertexStart,Fo=Fb,Fp=Fo+Fj.length;Fg._batchIndexStart=Fo,Fg._batchIndexEnd=Fp,Fd.set(Fj,Fb);var Fq=0;if(Fm)for(Fq=Fo;Fq<Fp;Fq+=3){Fd[Fq]=Fn+Fd[Fq];var Fr=Fd[Fq+1],Fs=Fd[Fq+2];Fd[Fq+1]=Fn+Fs,Fd[Fq+2]=Fn+Fr}else for(Fq=Fo;Fq<Fp;Fq+=3)Fd[Fq]=Fn+Fd[Fq],Fd[Fq+1]=Fn+Fd[Fq+1],Fd[Fq+2]=Fn+Fd[Fq+2];Fb+=Fj.length,Fc.set(Fi,Fa),Fa+=Fi.length}this._vertexBuffer.setData(Fc),this._indexBuffer.setData(Fd),this._needFinishCombine=!1}},Fb._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new Fzb)},Fb._getRenderElement=function(Fa,Fb,Fc){for(var Fd,Fe,Ff=this._batchRenderElements.length,Fg=!0,Fh=0;Fh<Ff;Fh++){var Fi,Fj,Fm=(Fe=this._batchRenderElements[Fh])._sprite3D._render;if(0!==Fh&&(Fg=(Fi=(Fd=this._batchRenderElements[Fh-1])._sprite3D._render).lightmapIndex!==Fm.lightmapIndex||Fi.receiveShadow!==Fm.receiveShadow||Fd._batchIndexEnd!==Fe._batchIndexStart),Fg){(Fj=this._getCombineRenderElementFromPool()).renderObj=this,Fj._material=this._material,Fj._batchIndexStart=Fe._batchIndexStart,Fj._batchIndexEnd=Fe._batchIndexEnd;var Fn=Fm.lightmapIndex,Fo=Fn+1,Fp=this._batchOwnerIndices[Fo];Fp||(Fp=this._batchOwnerIndices[Fo]=[]);var Fq,Fr=Fp[Fe._render.receiveShadow?1:0];void 0===Fr?(Fp[Fm.receiveShadow?1:0]=this._batchOwners.length,(Fq=new FXb(null,"StaticBatchMeshSprite3D"))._scene=Fb,Fq._transform=this._rootOwner?this._rootOwner._transform:null,Fq._render.lightmapIndex=Fn,Fq._render.receiveShadow=Fe._render.receiveShadow,this._batchOwners.push(Fq)):Fq=this._batchOwners[Fr],Fq._render._renderUpdate(Fc),Fj._sprite3D=Fq,Fa.push(Fj)}else Fj._batchIndexEnd=Fe._batchIndexEnd}},Fb._beforeRender=function(Fa){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Fb._render=function(Fa){var Fb=Fa.renderElement,Fc=Fb._batchIndexStart,Fd=Fb._batchIndexEnd-Fc;FF.mainContext.drawElements(4,Fd,5123,2*Fc),FA.drawCall++,FA.trianglesFaces+=Fd/3},Fb.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},Fb._getVertexBuffer=function(Fa){return void 0===Fa&&(Fa=0),this._vertexBuffer},Ff}(),FDb=function(Fa){function Fb(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,Fb.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}Fp(Fb,"laya.d3.core.ComponentNode",Fj);var Fc=Fb.prototype;return Fc.addComponent=function(Fa){var Fb,Fc=this._componentsMap.indexOf(Fa);if(-1===Fc)Fb=[],this._componentsMap.push(Fa),this._typeComponentsIndices.push(Fb);else if(Fb=this._typeComponentsIndices[Fc],this._components[Fb[0]].isSingleton)throw new Error("无法单实例创建"+Fa+"组件，"+Fa+"组件已存在！");var Fd=Fe.getInstance(Fa);return Fb.push(this._components.length),this._components.push(Fd),Fd instanceof laya.d3.component.Script&&this._scripts.push(Fd),Fd._initialize(this),Fd},Fc._removeComponent=function(Fa,Fb){var Fc=this._typeComponentsIndices[Fa],Fd=Fc[Fb],Fe=this._components[Fd];this._components.splice(Fd,1),Fe instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Fe),1),Fc.splice(Fb,1),0===Fc.length&&(this._typeComponentsIndices.splice(Fa,1),this._componentsMap.splice(Fa,1));for(var Ff=0,Fg=this._componentsMap.length;Ff<Fg;Ff++)for(var Fh=(Fc=this._typeComponentsIndices[Ff]).length-1;0<=Fh;Fh--){var Fi=Fc[Fh];if(!(Fd<Fi))break;Fc[Fh]=--Fi}Fe._destroy()},Fc.getComponentByType=function(Fa,Fb){void 0===Fb&&(Fb=0);var Fc=this._componentsMap.indexOf(Fa);return-1===Fc?null:this._components[this._typeComponentsIndices[Fc][Fb]]},Fc.getComponentsByType=function(Fa,Fb){var Fc=this._componentsMap.indexOf(Fa);if(-1!==Fc){var Fd=this._typeComponentsIndices[Fc],Fe=Fd.length;Fb.length=Fe;for(var Ff=0;Ff<Fe;Ff++)Fb[Ff]=this._components[Fd[Ff]]}else Fb.length=0},Fc.getComponentByIndex=function(Fa){return this._components[Fa]},Fc.removeComponentByType=function(Fa,Fb){void 0===Fb&&(Fb=0);var Fc=this._componentsMap.indexOf(Fa);-1!==Fc&&this._removeComponent(Fc,Fb)},Fc.removeComponentsByType=function(Fa){var Fb=this._componentsMap.indexOf(Fa);if(-1!==Fb)for(var Fc=this._typeComponentsIndices[Fb],Fd=0,Fe=Fc.length;Fd<Fe;Fc.length<Fe?Fe--:Fd++)this._removeComponent(Fb,Fd)},Fc.removeAllComponent=function(){for(var Fa=0,Fb=this._componentsMap.length;Fa<Fb;this._componentsMap.length<Fb?Fb--:Fa++)this.removeComponentsByType(this._componentsMap[Fa])},Fc._updateComponents=function(Fa){for(var Fb=0,Fc=this._components.length;Fb<Fc;Fb++){var Fd=this._components[Fb];!Fd.started&&(Fd._start(Fa),Fd.started=!0),Fd.enable&&Fd._update(Fa)}},Fc._lateUpdateComponents=function(Fa){for(var Fb=0;Fb<this._components.length;Fb++){var Fc=this._components[Fb];!Fc.started&&(Fc._start(Fa),Fc.started=!0),Fc.enable&&Fc._lateUpdate(Fa)}},Fc._preRenderUpdateComponents=function(Fa){for(var Fb=0;Fb<this._components.length;Fb++){var Fc=this._components[Fb];!Fc.started&&(Fc._start(Fa),Fc.started=!0),Fc.enable&&Fc._preRenderUpdate(Fa)}},Fc._postRenderUpdateComponents=function(Fa){for(var Fb=0;Fb<this._components.length;Fb++){var Fc=this._components[Fb];!Fc.started&&(Fc._start(Fa),Fc.started=!0),Fc.enable&&Fc._postRenderUpdate(Fa)}},Fb}(),FEb=function(Fd){function Fa(){Fa.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new Fob,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new Fhb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}Fp(Fa,"laya.d3.core.material.BaseMaterial",Fd);var Fb=Fa.prototype;return Fx.imps(Fb,{"laya.d3.core.IClone":!0}),Fb._addShaderDefine=function(Fa){this._shaderDefineValue|=Fa},Fb._removeShaderDefine=function(Fa){this._shaderDefineValue&=~Fa},Fb._addDisablePublicShaderDefine=function(Fa){this._disablePublicShaderDefine|=Fa},Fb._removeDisablePublicShaderDefine=function(Fa){this._disablePublicShaderDefine&=~Fa},Fb._setBuffer=function(Fa,Fb){this._shaderValues.setValue(Fa,Fb),this._values[Fa]=Fb},Fb._getBuffer=function(Fa){return this._values[Fa]},Fb._setMatrix4x4=function(Fa,Fb){this._shaderValues.setValue(Fa,Fb?Fb.elements:null),this._values[Fa]=Fb},Fb._getMatrix4x4=function(Fa){return this._values[Fa]},Fb._setInt=function(Fa,Fb){this._shaderValues.setValue(Fa,Fb),this._values[Fa]=Fb},Fb._getInt=function(Fa){return this._values[Fa]},Fb._setNumber=function(Fa,Fb){this._shaderValues.setValue(Fa,Fb),this._values[Fa]=Fb},Fb._getNumber=function(Fa){return this._values[Fa]},Fb._setBool=function(Fa,Fb){this._shaderValues.setValue(Fa,Fb),this._values[Fa]=Fb},Fb._getBool=function(Fa){return this._values[Fa]},Fb._setVector2=function(Fa,Fb){this._shaderValues.setValue(Fa,Fb?Fb.elements:null),this._values[Fa]=Fb},Fb._getVector2=function(Fa){return this._values[Fa]},Fb._setColor=function(Fa,Fb){this._shaderValues.setValue(Fa,Fb?Fb.elements:null),this._values[Fa]=Fb},Fb._getColor=function(Fa){return this._values[Fa]},Fb._setTexture=function(Fa,Fb){var Fc=this._values[Fa];this._values[Fa]=Fb,this._shaderValues.setValue(Fa,Fb),0<this.referenceCount&&(Fc&&Fc._removeReference(),Fb&&Fb._addReference())},Fb._getTexture=function(Fa){return this._values[Fa]},Fb._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},Fb._getShader=function(Fa,Fb,Fc){var Fd=(Fa|Fb)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(Fd,Fc,this._shaderDefineValue),this._shader},Fb._setRenderStateBlendDepth=function(){var Fa=FF.mainContext;switch(FG.setDepthMask(Fa,this.depthWrite),0===this.depthTest?FG.setDepthTest(Fa,!1):(FG.setDepthTest(Fa,!0),FG.setDepthFunc(Fa,this.depthTest)),this.blend){case 0:FG.setBlend(Fa,!1);break;case 1:FG.setBlend(Fa,!0),FG.setBlendFunc(Fa,this.srcBlend,this.dstBlend);break;case 2:FG.setBlend(Fa,!0)}},Fb._setRenderStateFrontFace=function(Fa,Fb){var Fc=FF.mainContext,Fd=0;switch(this.cull){case 0:FG.setCullFace(Fc,!1);break;case 1:FG.setCullFace(Fc,!0),Fd=Fa?Fb&&Fb._isFrontFaceInvert?2305:2304:Fb&&Fb._isFrontFaceInvert?2304:2305,FG.setFrontFace(Fc,Fd);break;case 2:FG.setCullFace(Fc,!0),Fd=Fa?Fb&&Fb._isFrontFaceInvert?2304:2305:Fb&&Fb._isFrontFaceInvert?2305:2304,FG.setFrontFace(Fc,Fd)}},Fb.onAsynLoaded=function(Fa,Fb,Fc){var Fd=Fb[0],Fe=Fb[1];switch(Fd.version){case"LAYAMATERIAL:01":var Ff=0,Fg=0,Fh=Fd.props;for(var Fi in Fh)switch(Fi){case"vectors":var Fj=Fh[Fi];for(Ff=0,Fg=Fj.length;Ff<Fg;Ff++){var Fm=Fj[Ff],Fn=Fm.value;switch(Fn.length){case 2:this[Fm.name]=new Ffb(Fn[0],Fn[1]);break;case 3:this[Fm.name]=new Fgb(Fn[0],Fn[1],Fn[2]);break;case 4:this[Fm.name]=new Fhb(Fn[0],Fn[1],Fn[2],Fn[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var Fo=Fh[Fi];for(Ff=0,Fg=Fo.length;Ff<Fg;Ff++){var Fp=Fo[Ff],Fq=Fp.path;Fq&&(this[Fp.name]=Ft.getRes(Fe[Fq]))}break;case"defines":var Fr=Fh[Fi];for(Ff=0,Fg=Fr.length;Ff<Fg;Ff++){var Fs=this._shaderCompile.getMaterialDefineByName(Fr[Ff]);this._addShaderDefine(Fs)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[Fi]=Fh[Fi];break;case"renderQueue":switch(Fh[Fi]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[Fi]=Fh[Fi]}break;case"LAYAMATERIAL:02":for(Fi in Fh=Fd.props)switch(Fi){case"vectors":for(Ff=0,Fg=(Fj=Fh[Fi]).length;Ff<Fg;Ff++)switch((Fn=(Fm=Fj[Ff]).value).length){case 2:this[Fm.name]=new Ffb(Fn[0],Fn[1]);break;case 3:this[Fm.name]=new Fgb(Fn[0],Fn[1],Fn[2]);break;case 4:this[Fm.name]=new Fhb(Fn[0],Fn[1],Fn[2],Fn[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(Ff=0,Fg=(Fo=Fh[Fi]).length;Ff<Fg;Ff++)(Fq=(Fp=Fo[Ff]).path)&&(this[Fp.name]=Ft.getRes(Fe[Fq]));break;case"defines":for(Ff=0,Fg=(Fr=Fh[Fi]).length;Ff<Fg;Ff++)Fs=this._shaderCompile.getMaterialDefineByName(Fr[Ff]),this._addShaderDefine(Fs);break;default:this[Fi]=Fh[Fi]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},Fb._addReference=function(){Fd.prototype._addReference.call(this);for(var Fa=0,Fb=this._values.length;Fa<Fb;Fa++){var Fc=this._values[Fa];Fc&&Fc instanceof laya.d3.resource.BaseTexture&&Fc._addReference()}},Fb._removeReference=function(){Fd.prototype._removeReference.call(this);for(var Fa=0,Fb=this._values.length;Fa<Fb;Fa++){var Fc=this._values[Fa];Fc&&Fc instanceof laya.d3.resource.BaseTexture&&Fc._removeReference()}},Fb.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},Fb.setShaderName=function(Fa){var Fb=FLb.nameKey.getID(Fa);if(-1===Fb)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=FAb._preCompileShader[Fb]},Fb.cloneTo=function(Fa){var Fb=Fa;Fb.name=this.name,Fb.cull=this.cull,Fb.blend=this.blend,Fb.srcBlend=this.srcBlend,Fb.dstBlend=this.dstBlend,Fb.srcBlendRGB=this.srcBlendRGB,Fb.dstBlendRGB=this.dstBlendRGB,Fb.srcBlendAlpha=this.srcBlendAlpha,Fb.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(Fb.blendConstColor),Fb.blendEquation=this.blendEquation,Fb.blendEquationRGB=this.blendEquationRGB,Fb.blendEquationAlpha=this.blendEquationAlpha,Fb.depthTest=this.depthTest,Fb.depthWrite=this.depthWrite,Fb.renderQueue=this.renderQueue,Fb._shader=this._shader,Fb._disablePublicShaderDefine=this._disablePublicShaderDefine,Fb._shaderDefineValue=this._shaderDefineValue;var Fc,Fd=0,Fe=Fb._shaderValues;Fb._shaderValues.data.length=this._shaderValues.data.length;var Ff=this._values.length,Fg=Fb._values;for(Fd=0,Fc=Fg.length=Ff;Fd<Fc;Fd++){var Fh=this._values[Fd];if(Fh)if("number"==typeof Fh)Fg[Fd]=Fh,Fe.data[Fd]=Fh;else if("number"==typeof Fh&&Math.floor(Fh)==Fh)Fg[Fd]=Fh,Fe.data[Fd]=Fh;else if("boolean"==typeof Fh)Fg[Fd]=Fh,Fe.data[Fd]=Fh;else if(Fh instanceof laya.d3.math.Vector2){var Fi=Fg[Fd]||(Fg[Fd]=new Ffb);Fh.cloneTo(Fi),Fe.data[Fd]=Fi.elements}else if(Fh instanceof laya.d3.math.Vector3){var Fj=Fg[Fd]||(Fg[Fd]=new Fgb);Fh.cloneTo(Fj),Fe.data[Fd]=Fj.elements}else if(Fh instanceof laya.d3.math.Vector4){var Fm=Fg[Fd]||(Fg[Fd]=new Fhb);Fh.cloneTo(Fm),Fe.data[Fd]=Fm.elements}else if(Fh instanceof laya.d3.math.Matrix4x4){var Fn=Fg[Fd]||(Fg[Fd]=new Fab);Fh.cloneTo(Fn),Fe.data[Fd]=Fn.elements}else Fh instanceof laya.d3.resource.BaseTexture&&(Fg[Fd]=Fh,Fe.data[Fd]=Fh)}},Fb.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fq(0,Fb,"alphaTestValue",function(){return this._getNumber(0)},function(Fa){this._setNumber(0,Fa)}),Fq(0,Fb,"alphaTest",function(){return this._alphaTest},function(Fa){(this._alphaTest=Fa)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),Fa.__init__=function(){Fa.SHADERDEFINE_ALPHATEST=Fa.shaderDefines.registerDefine("ALPHATEST")},Fa.RENDERQUEUE_OPAQUE=2e3,Fa.RENDERQUEUE_ALPHATEST=2450,Fa.RENDERQUEUE_TRANSPARENT=3e3,Fa.CULL_NONE=0,Fa.CULL_FRONT=1,Fa.CULL_BACK=2,Fa.BLEND_DISABLE=0,Fa.BLEND_ENABLE_ALL=1,Fa.BLEND_ENABLE_SEPERATE=2,Fa.BLENDPARAM_ZERO=0,Fa.BLENDPARAM_ONE=1,Fa.BLENDPARAM_SRC_COLOR=768,Fa.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,Fa.BLENDPARAM_DST_COLOR=774,Fa.BLENDPARAM_ONE_MINUS_DST_COLOR=775,Fa.BLENDPARAM_SRC_ALPHA=770,Fa.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,Fa.BLENDPARAM_DST_ALPHA=772,Fa.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,Fa.BLENDPARAM_SRC_ALPHA_SATURATE=776,Fa.BLENDEQUATION_ADD=0,Fa.BLENDEQUATION_SUBTRACT=1,Fa.BLENDEQUATION_REVERSE_SUBTRACT=2,Fa.DEPTHTEST_OFF=0,Fa.DEPTHTEST_NEVER=512,Fa.DEPTHTEST_LESS=513,Fa.DEPTHTEST_EQUAL=514,Fa.DEPTHTEST_LEQUAL=515,Fa.DEPTHTEST_GREATER=516,Fa.DEPTHTEST_NOTEQUAL=517,Fa.DEPTHTEST_GEQUAL=518,Fa.DEPTHTEST_ALWAYS=519,Fa.SHADERDEFINE_ALPHATEST=1,Fa.ALPHATESTVALUE=0,Fn(Fa,["shaderDefines",function(){return this.shaderDefines=new Fmb}]),Fa}(Fs),FFb=function(Fa){function Fb(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,Fb.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}Fp(Fb,"laya.d3.resource.BaseTexture",Fs);var Fc=Fb.prototype;return Fq(0,Fc,"width",function(){return this._width}),Fq(0,Fc,"repeat",function(){return this._repeat},function(Fa){if(this._repeat!==Fa&&(this._repeat=Fa,this._source)){var Fb=FF.mainContext;FG.bindTexture(Fb,this._type,this._source),Fw.isPOT(this._width,this._height)&&this._repeat?(Fb.texParameteri(this._type,10242,10497),Fb.texParameteri(this._type,10243,10497)):(Fb.texParameteri(this._type,10242,33071),Fb.texParameteri(this._type,10243,33071))}}),Fq(0,Fc,"height",function(){return this._height}),Fq(0,Fc,"magFifter",function(){return this._magFifter},function(Fa){(this._magFifter=Fa)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(Fa)}),Fq(0,Fc,"wrapModeV",function(){return this._wrapModeV}),Fq(0,Fc,"size",function(){return this._size}),Fq(0,Fc,"wrapModeU",function(){return this._wrapModeU}),Fq(0,Fc,"mipmap",function(){return this._mipmap},function(Fa){this._mipmap=Fa,this._mipmap!=Fa&&this._conchTexture&&this._conchTexture.setMipMap(Fa)}),Fq(0,Fc,"minFifter",function(){return this._minFifter},function(Fa){this._minFifter=Fa,this._minFifter!=Fa&&this._conchTexture&&this._conchTexture.setMinFifter(Fa)}),Fq(0,Fc,"format",function(){return this._format}),Fq(0,Fc,"source",function(){return this.activeResource(),this._source}),Fq(0,Fc,"defaulteTexture",function(){return FSb.grayTexture}),Fb.WARPMODE_REPEAT=0,Fb.WARPMODE_CLAMP=1,Fb}(),FGb=function(Fa){function Fb(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,Fb.__super.call(this),this._boundingBoxCorners=Fd(8,null)}Fp(Fb,"laya.d3.resource.models.BaseMesh",Fs);var Fc=Fb.prototype;return Fc._getPositions=function(){throw new Error("未Override,请重载该属性！")},Fc._generateBoundingObject=function(){this._boundingSphere=new F_a(new Fgb,0),F_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new FZa(new Fgb,new Fgb),FZa.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},Fc.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},Fc.getRenderElement=function(Fa){throw new Error("未Override,请重载该属性！")},Fq(0,Fc,"subMeshCount",function(){return this._subMeshCount}),Fq(0,Fc,"boundingBox",function(){return this._boundingBox}),Fq(0,Fc,"boundingBoxCorners",function(){return this._boundingBoxCorners}),Fq(0,Fc,"boundingSphere",function(){return this._boundingSphere}),Fb}(),FHb=(function(Fa){function Fb(){Fb.__super.call(this)}Fp(Fb,"laya.d3.component.Script",Fvb);var Fc=Fb.prototype;Fc.onTriggerEnter=function(Fa){},Fc.onTriggerExit=function(Fa){},Fc.onTriggerStay=function(Fa){},Fq(0,Fc,"isSingleton",function(){return Fb._isSingleton}),Fb._isSingleton=!1}(),function(Fa){function Fb(Fa){this._owner=null,this._sharedMesh=null,Fb.__super.call(this),this._owner=Fa}Fp(Fb,"laya.d3.core.MeshFilter",Fa);var Fc=Fb.prototype;return Fc._sharedMeshLoaded=function(){this.event("loaded")},Fc._destroy=function(){Fa.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},Fq(0,Fc,"sharedMesh",function(){return this._sharedMesh},function(Fa){var Fb=this._sharedMesh;Fb&&Fb._removeReference(),(this._sharedMesh=Fa)._addReference(),this.event("meshchanged",[this,Fb,Fa]),Fa.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),Fq(0,Fc,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),Fq(0,Fc,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),Fq(0,Fc,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),Fq(0,Fc,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),Fb}(Fwb)),FIb=function(Fa){function Fb(Fa){Fb.__super.call(this,Fa),Fa.meshFilter.on("meshchanged",this,this._onMeshChanged)}Fp(Fb,"laya.d3.core.MeshRender",Fxb);var Fc=Fb.prototype;return Fc._onMeshChanged=function(Fa,Fb,Fc){Fc.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:Fc.once("loaded",this,this._onMeshLoaed)},Fc._onMeshLoaed=function(Fa,Fb){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},Fc._calculateBoundingSphereByInitSphere=function(Fa){var Fb=NaN,Fc=this._owner.transform,Fd=Fc.scale.elements,Fe=Math.abs(Fd[0]),Ff=Math.abs(Fd[1]),Fg=Math.abs(Fd[2]);Fb=Ff<=Fe&&Fg<=Fe?Fe:Fg<=Ff?Ff:Fg,Fgb.transformCoordinate(Fa.center,Fc.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=Fa.radius*Fb},Fc._calculateBoundBoxByInitCorners=function(Fa){for(var Fb=this._owner.transform.worldMatrix,Fc=0;Fc<8;Fc++)Fgb.transformCoordinate(Fa[Fc],Fb,Fxb._tempBoundBoxCorners[Fc]);FZa.createfromPoints(Fxb._tempBoundBoxCorners,this._boundingBox)},Fc._calculateBoundingSphere=function(){var Fa=this._owner.meshFilter.sharedMesh;null==Fa||null==Fa.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(Fa.boundingSphere)},Fc._calculateBoundingBox=function(){var Fa=this._owner.meshFilter.sharedMesh;null==Fa||null==Fa.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(Fa.boundingBoxCorners)},Fc._renderUpdate=function(Fa){var Fb=this._owner.transform;if(Fb){this._setShaderValueMatrix4x4(0,Fb.worldMatrix);var Fc=this._owner.getProjectionViewWorldMatrix(Fa);this._setShaderValueMatrix4x4(1,Fc)}else this._setShaderValueMatrix4x4(0,Fab.DEFAULT),this._setShaderValueMatrix4x4(1,Fa);return Ftb.debugMode&&this._renderRenderableBoundBox(),!0},Fb}(),FJb=function(Fb){function Fd(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,Fd.__super.call(this),this._renderState=new FY,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new Fob,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new Fba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new Fgb(.7,.7,.7),this.ambientColor=new Fgb(.212,.227,.259),FF.shaderHighPrecision&&this.addShaderDefine(FAb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}Fp(Fd,"laya.d3.core.scene.Scene",Fb);var Fa=Fd.prototype;return Fx.imps(Fa,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),Fa._setUrl=function(Fa){this._url=Fa},Fa._getGroup=function(){return this._group},Fa._setGroup=function(Fa){this._group=Fa},Fa._display=function(){Fx.stage._scenes.push(this),Fx.stage._scenes.sort(Fd._sortScenes);for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++){var Fc=this._childs[Fa];Fc.active&&Fc._activeHierarchy()}},Fa._unDisplay=function(){var Fa=Fx.stage._scenes;Fa.splice(Fa.indexOf(this),1);for(var Fb=0,Fc=this._childs.length;Fb<Fc;Fb++){var Fd=this._childs[Fb];Fd.active&&Fd._inActiveHierarchy()}},Fa._addChild3D=function(Fa){Fa.transform._onWorldTransform(),Fa._setBelongScene(this),this.displayedInStage&&Fa.active&&Fa._activeHierarchy()},Fa._removeChild3D=function(Fa){Fa.transform.parent=null,this.displayedInStage&&Fa.active&&Fa._inActiveHierarchy(),Fa._setUnBelongScene()},Fa.initOctree=function(Fa,Fb,Fc,Fd,Fe){void 0===Fe&&(Fe=6),this.treeSize=new Fgb(Fa,Fb,Fc),this.treeLevel=Fe,this.treeRoot=new FZ(this,0),this.treeRoot.init(Fd,this.treeSize)},Fa._prepareUpdateToRenderState=function(Fa,Fb){Fb.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,Fb.scene=this},Fa._prepareSceneToRender=function(Fa){var Fb=this._lights.length;if(0<Fb)for(var Fc=0,Fd=0;Fd<Fb&&!(this._lights[Fd]._prepareToScene(Fa)&&++Fc>=this._enableLightCount);Fd++);},Fa._updateChilds=function(Fa){for(var Fb=0,Fc=this._childs.length;Fb<Fc;++Fb)this._childs[Fb]._update(Fa)},Fa._preRenderScene=function(Fa,Fb,Fc){var Fd,Fe=Fb._viewMatrix,Ff=Fb._projectionMatrix,Fg=Fb._projectionViewMatrix,Fh=0,Fi=Fb.camera;for(Fi.useOcclusionCulling?this.treeRoot?Fca.renderObjectCullingOctree(Fc,this,Fi,Fe,Ff,Fg):Fca.renderObjectCulling(Fc,this,Fi,Fe,Ff,Fg):Fca.renderObjectCullingNoBoundFrustum(this,Fi,Fe,Ff,Fg),Fh=0,Fd=this._quenes.length;Fh<Fd;Fh++)this._quenes[Fh]&&this._quenes[Fh]._preRender(Fb)},Fa._clear=function(Fa,Fb){var Fc=Fb._viewport,Fd=Fb.camera,Fe=Fc.x,Ff=Fd.renderTargetSize.height-Fc.y-Fc.height,Fg=Fc.width,Fh=Fc.height;Fa.viewport(Fe,Ff,Fg,Fh);var Fi=256,Fj=Fd.renderTarget;switch(Fd.clearFlag){case 0:var Fm=Fd.clearColor;if(Fm){Fa.enable(3089),Fa.scissor(Fe,Ff,Fg,Fh);var Fn=Fm.elements;Fa.clearColor(Fn[0],Fn[1],Fn[2],Fn[3]),Fi|=16384}if(Fj)switch(Fm||(Fi=16384),Fj.depthStencilFormat){case 33189:Fi|=256;break;case 36168:Fi|=1024;break;case 34041:Fi|=256,Fi|=1024}Fa.clear(Fi),Fm&&Fa.disable(3089);break;case 1:case 2:if(Fj)switch(Fi=16384,Fj.depthStencilFormat){case 33189:Fi|=256;break;case 36168:Fi|=1024;break;case 34041:Fi|=256,Fi|=1024}Fa.clear(Fi);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},Fa._renderScene=function(Fa,Fb){var Fc,Fd,Fe=Fb.camera,Ff=0;for(Ff=0;Ff<2;Ff++)(Fd=this._quenes[Ff])&&(Fe.renderTarget?Fd._render(Fb,!0):Fd._render(Fb,!1));if(1===Fe.clearFlag){var Fg=Fe.sky;Fg&&(FG.setCullFace(Fa,!1),FG.setDepthFunc(Fa,515),FG.setDepthMask(Fa,!1),Fg._render(Fb),FG.setDepthFunc(Fa,513),FG.setDepthMask(Fa,!0))}for(Ff=2,Fc=this._quenes.length;Ff<Fc;Ff++)(Fd=this._quenes[Ff])&&(Fd._sortAlpha(Fb.camera.transform.position),Fe.renderTarget?Fd._render(Fb,!0):Fd._render(Fb,!1))},Fa._set3DRenderConfig=function(Fa){Fa.disable(3042),FG._blend=!1,Fa.blendFunc(770,771),FG._sFactor=770,FG._dFactor=771,Fa.disable(2929),FG._depthTest=!1,Fa.enable(2884),FG._cullFace=!0,Fa.depthMask(1),FG._depthMask=!0,Fa.frontFace(2304),FG._frontFace=2304},Fa._set2DRenderConfig=function(Fa){FG.setBlend(Fa,!0),FG.setBlendFunc(Fa,1,771),FG.setDepthTest(Fa,!1),FG.setCullFace(Fa,!1),FG.setDepthMask(Fa,!0),FG.setFrontFace(Fa,2305),Fa.viewport(0,0,Fm.width,Fm.height)},Fa._parseCustomProps=function(Fa,Fb,Fc,Fd){var Fe=Fd.customProps.lightmaps,Ff=Fe.length,Fg=this._lightmaps;Fg.length=Ff;for(var Fh=0;Fh<Ff;Fh++)Fg[Fh]=Ft.getRes(Fb[Fe[Fh].replace(".exr",".png")]);this.setlightmaps(Fg);var Fi=Fd.customProps.ambientColor;Fi&&(this.ambientColor=new Fgb(Fi[0],Fi[1],Fi[2]));var Fj=Fd.customProps.fogColor;Fj&&(this.fogColor=new Fgb(Fj[0],Fj[1],Fj[2]))},Fa._addLight=function(Fa){this._lights.indexOf(Fa)<0&&this._lights.push(Fa)},Fa._removeLight=function(Fa){var Fb=this._lights.indexOf(Fa);0<=Fb&&this._lights.splice(Fb,1)},Fa._updateScene=function(){var Fa=this._renderState;this._prepareUpdateToRenderState(FF.mainContext,Fa),this._updateComponents(Fa),this._updateChilds(Fa),this._lateUpdateComponents(Fa),this._time+=Fa.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},Fa._updateSceneConch=function(){var Fa=this._renderState;this._prepareUpdateToRenderState(FF.mainContext,Fa),this._updateComponents(Fa),this._lateUpdateComponents(Fa),this._prepareSceneToRender(Fa);for(var Fb=0,Fc=this._cameraPool.length;Fb<Fc;Fb++){var Fd=this._cameraPool[Fb];(Fa.camera=Fd)._prepareCameraToRender()}},Fa._preRenderShadow=function(Fa,Fb,Fc,Fd,Fe){this.treeRoot?Fca.renderShadowObjectCullingOctree(this,Fb,Fc,Fd,Fe):Fca.renderShadowObjectCulling(this,Fb,Fc,Fd,Fe);for(var Ff=0,Fg=Fc.length;Ff<Fg;Ff++)Fc[Ff]&&Fc[Ff]._preRender(Fa)},Fa._renderShadowMap=function(Fa,Fb,Fc){var Fd=this.parallelSplitShadowMaps[0];Fd._calcAllLightCameraInfo(Fc);var Fe,Ff,Fg,Fh=Fd.PSSMNum;if(this._preRenderShadow(Fb,Fd._lightCulling,Fd._shadowQuenes,Fd._lightVPMatrix[0],Fh),this.addShaderDefine(Fpb.SHADERDEFINE_CAST_SHADOW),1<Fh)for(var Fi=0;Fi<Fh;Fi++)Fe=Fd.getRenderTarget(Fi+1),Fd.beginRenderTarget(Fi+1),Fa.clearColor(1,1,1,1),Fa.clear(16640),Fa.viewport(0,0,Fe.width,Fe.height),Fb.camera=Fg=Fd.getLightCamera(Fi),Fg._prepareCameraToRender(),Fg._prepareCameraViewProject(Fg.viewMatrix,Fg.projectionMatrix),Fb._projectionViewMatrix=Fd._lightVPMatrix[Fi+1],(Ff=Fd._shadowQuenes[Fi])._preRender(Fb),Ff._renderShadow(Fb,!1),Fd.endRenderTarget(Fi+1);else Fe=Fd.getRenderTarget(1),Fd.beginRenderTarget(1),Fa.clearColor(1,1,1,1),Fa.clear(16640),Fa.viewport(0,0,Fe.width,Fe.height),Fb.camera=Fg=Fd.getLightCamera(0),Fg._prepareCameraToRender(),Fg._prepareCameraViewProject(Fg.viewMatrix,Fg.projectionMatrix),Fb._projectionViewMatrix=Fd._lightVPMatrix[0],(Ff=Fd._shadowQuenes[0])._preRender(Fb),Ff._renderShadow(Fb,!0),Fd.endRenderTarget(1);this.removeShaderDefine(Fpb.SHADERDEFINE_CAST_SHADOW)},Fa.addTreeNode=function(Fa){this.treeRoot.addTreeNode(Fa)},Fa.removeTreeNode=function(Fa){this.treeSize&&Fa._treeNode&&Fa._treeNode.removeObject(Fa)},Fa.setlightmaps=function(Fa){this._lightmaps=Fa;for(var Fb=0,Fc=this._renderableSprite3Ds.length;Fb<Fc;Fb++)this._renderableSprite3Ds[Fb]._render._applyLightMapParams()},Fa.getlightmaps=function(){return this._lightmaps},Fa.addChildAt=function(Fa,Fb){if(!(Fa instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(Fa&&Fa.__className));if(!Fa||this.destroyed||Fa===this)return Fa;if(Fa.zOrder&&this._set$P("hasZorder",!0),0<=Fb&&Fb<=this._childs.length){if(Fa._parent===this){var Fc=this.getChildIndex(Fa);this._childs.splice(Fc,1),this._childs.splice(Fb,0,Fa),this.conchModel&&(this.conchModel.removeChild(Fa.conchModel),this.conchModel.addChildAt(Fa.conchModel,Fb)),this._childChanged()}else Fa.parent&&Fa.parent.removeChild(Fa),this._childs===Fj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Fb,0,Fa),this.conchModel&&this.conchModel.addChildAt(Fa.conchModel,Fb),(Fa.parent=this)._addChild3D(Fa);return Fa}throw new Error("appendChildAt:The index is out of bounds")},Fa.addChild=function(Fa){if(!(Fa instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Fa||this.destroyed||Fa===this)return Fa;if(Fa.zOrder&&this._set$P("hasZorder",!0),Fa._parent===this){var Fb=this.getChildIndex(Fa);Fb!==this._childs.length-1&&(this._childs.splice(Fb,1),this._childs.push(Fa),this.conchModel&&(this.conchModel.removeChild(Fa.conchModel),this.conchModel.addChildAt(Fa.conchModel,this._childs.length-1)),this._childChanged())}else Fa.parent&&Fa.parent.removeChild(Fa),this._childs===Fj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Fa),this.conchModel&&this.conchModel.addChildAt(Fa.conchModel,this._childs.length-1),(Fa.parent=this)._childChanged(),this._addChild3D(Fa);return Fa},Fa.removeChildAt=function(Fa){var Fb=this.getChildAt(Fa);return Fb&&(this._removeChild3D(Fb),this._childs.splice(Fa,1),this.conchModel&&this.conchModel.removeChild(Fb.conchModel),Fb.parent=null),Fb},Fa.removeChildren=function(Fa,Fb){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=2147483647),this._childs&&0<this._childs.length){var Fc=this._childs;if(0===Fa&&Ff<=Fb){var Fd=Fc;this._childs=Fj.ARRAY_EMPTY}else Fd=Fc.splice(Fa,Fb-Fa);for(var Fe=0,Ff=Fd.length;Fe<Ff;Fe++)this._removeChild3D(Fd[Fe]),Fd[Fe].parent=null,this.conchModel&&this.conchModel.removeChild(Fd[Fe].conchModel)}return this},Fa.addFrustumCullingObject=function(Fa){this.treeRoot?this.addTreeNode(Fa):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(Fa):this._cullingRenders[this._cullingRendersLength]=Fa,Fa._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},Fa.removeFrustumCullingObject=function(Fa){if(this.treeRoot)this.removeTreeNode(Fa);else{this._cullingRendersLength--;var Fb=Fa._indexInSceneFrustumCullingObjects;if(Fb!==this._cullingRendersLength){var Fc=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[Fb]=Fc)._indexInSceneFrustumCullingObjects=Fb,Fa._indexInSceneFrustumCullingObjects=-1}}},Fa.getRenderQueue=function(Fa){return Fa<3e3?this._quenes[1]||(this._quenes[1]=new FX(this)):this._quenes[2]||(this._quenes[2]=new FX(this))},Fa.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new FX(this)},Fa.addShaderDefine=function(Fa){this._shaderDefineValue|=Fa},Fa.removeShaderDefine=function(Fa){this._shaderDefineValue&=~Fa},Fa.addScript=function(Fa){return this._addComponent(Fa)},Fa.getScriptByType=function(Fa,Fb){return void 0===Fb&&(Fb=0),this._getComponentByType(Fa,Fb)},Fa.getScriptsByType=function(Fa,Fb){this._getComponentsByType(Fa,Fb)},Fa.getScriptByIndex=function(Fa){return this._getComponentByIndex(Fa)},Fa.removeScriptByType=function(Fa,Fb){void 0===Fb&&(Fb=0),this._removeComponentByType(Fa,Fb)},Fa.removeScriptsByType=function(Fa){this._removeComponentByType(Fa)},Fa.removeAllScript=function(){this._removeAllComponent()},Fa.render=function(Fa,Fb,Fc){(Fr._context.ctx._renderKey=0)<this._childs.length&&Fa.addRenderObject(this)},Fa.renderSubmit=function(){var Fa=FF.mainContext,Fb=this._renderState;this._set3DRenderConfig(Fa),this._prepareSceneToRender(this._renderState);var Fc,Fd=0,Fe=0;if(Ftb.debugMode||FZ.debugMode)for(Fd=0,Fe=this._cameraPool.length;Fd<Fe;Fd++)Fc=this._cameraPool[Fd],Ftb._debugPhasorSprite.begin(1,Fc),Fc.activeInHierarchy&&Fc._renderCamera(Fa,Fb,this),Ftb._debugPhasorSprite.end();else for(Fd=0,Fe=this._cameraPool.length;Fd<Fe;Fd++)(Fc=this._cameraPool[Fd]).activeInHierarchy&&Fc._renderCamera(Fa,Fb,this);return this._set2DRenderConfig(Fa),1},Fa.onAsynLoaded=function(Fa,Fb,Fc){var Fd=Fb[0];if("Scene"!==Fd.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var Fe=Fb[1];Fsb._createNodeByJson(this,Fd,this,Fe),this.event("hierarchyloaded",[this]),this.__loaded=!0},Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),this.destroyed||(Fb.prototype.destroy.call(this,Fa),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,Ft.clearRes(this.url),this.loaded||Ftb._cancelLoadByUrl(this.url))},Fa.getRenderType=function(){return 0},Fa.releaseRender=function(){},Fa._addComponent=function(Fa){var Fb,Fc=this._componentsMap.indexOf(Fa);if(-1===Fc)Fb=[],this._componentsMap.push(Fa),this._typeComponentsIndices.push(Fb);else if(Fb=this._typeComponentsIndices[Fc],this._components[Fb[0]].isSingleton)throw new Error("无法单实例创建"+Fa+"组件，"+Fa+"组件已存在！");var Fd=Fe.getInstance(Fa);Fb.push(this._components.length),this._components.push(Fd);return Fd._initialize(this),Fd},Fa._removeComponent=function(Fa,Fb){var Fc=this._typeComponentsIndices[Fa],Fd=Fc[Fb],Fe=this._components[Fd];this._components.splice(Fd,1),Fc.splice(Fb,1),0===Fc.length&&(this._typeComponentsIndices.splice(Fa,1),this._componentsMap.splice(Fa,1));for(var Ff=0,Fg=this._componentsMap.length;Ff<Fg;Ff++)for(var Fh=(Fc=this._typeComponentsIndices[Ff]).length-1;0<=Fh;Fh--){var Fi=Fc[Fh];if(!(Fd<Fi))break;Fc[Fh]=--Fi}Fe._destroy()},Fa._getComponentByType=function(Fa,Fb){void 0===Fb&&(Fb=0);var Fc=this._componentsMap.indexOf(Fa);return-1===Fc?null:this._components[this._typeComponentsIndices[Fc][Fb]]},Fa._getComponentsByType=function(Fa,Fb){var Fc=this._componentsMap.indexOf(Fa);if(-1!==Fc){var Fd=this._typeComponentsIndices[Fc],Fe=Fd.length;Fb.length=Fe;for(var Ff=0;Ff<Fe;Ff++)Fb[Ff]=this._components[Fd[Ff]]}else Fb.length=0},Fa._getComponentByIndex=function(Fa){return this._components[Fa]},Fa._removeComponentByType=function(Fa,Fb){void 0===Fb&&(Fb=0);var Fc=this._componentsMap.indexOf(Fa);-1!==Fc&&this._removeComponent(Fc,Fb)},Fa._removeComponentsByType=function(Fa){var Fb=this._componentsMap.indexOf(Fa);if(-1!==Fb)for(var Fc=this._typeComponentsIndices[Fb],Fd=0,Fe=Fc.length;Fd<Fe;Fc.length<Fe?Fe--:Fd++)this._removeComponent(Fb,Fd)},Fa._removeAllComponent=function(){for(var Fa=0,Fb=this._componentsMap.length;Fa<Fb;this._componentsMap.length<Fb?Fb--:Fa++)this._removeComponentsByType(this._componentsMap[Fa])},Fa._updateComponents=function(Fa){for(var Fb=0,Fc=this._components.length;Fb<Fc;Fb++){var Fd=this._components[Fb];!Fd.started&&(Fd._start(Fa),Fd.started=!0),Fd.enable&&Fd._update(Fa)}},Fa._lateUpdateComponents=function(Fa){for(var Fb=0;Fb<this._components.length;Fb++){var Fc=this._components[Fb];!Fc.started&&(Fc._start(Fa),Fc.started=!0),Fc.enable&&Fc._lateUpdate(Fa)}},Fa._preRenderUpdateComponents=function(Fa){for(var Fb=0;Fb<this._components.length;Fb++){var Fc=this._components[Fb];!Fc.started&&(Fc._start(Fa),Fc.started=!0),Fc.enable&&Fc._preRenderUpdate(Fa)}},Fa._postRenderUpdateComponents=function(Fa){for(var Fb=0;Fb<this._components.length;Fb++){var Fc=this._components[Fb];!Fc.started&&(Fc._start(Fa),Fc.started=!0),Fc.enable&&Fc._postRenderUpdate(Fa)}},Fq(0,Fa,"_loaded",null,function(Fa){this.__loaded=Fa}),Fq(0,Fa,"fogColor",function(){return this._fogColor},function(Fa){this._fogColor=Fa,this._shaderValues.setValue(0,Fa.elements)}),Fq(0,Fa,"enableFog",function(){return this._enableFog},function(Fa){this._enableFog!==Fa&&((this._enableFog=Fa)?(this.addShaderDefine(FAb.SHADERDEFINE_FOG),this.removeShaderDefine(FAb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(FAb.SHADERDEFINE_FOG))}),Fq(0,Fa,"url",function(){return this._url}),Fq(0,Fa,"loaded",function(){return this.__loaded}),Fq(0,Fa,"enableDepthFog",function(){return this._enableDepthFog},function(Fa){this._enableDepthFog!=Fa&&((this._enableDepthFog=Fa)?(this.addShaderDefine(FAb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(FAb.SHADERDEFINE_FOG)):this.removeShaderDefine(FAb.SAHDERDEFINE_DEPTHFOG))}),Fq(0,Fa,"fogStart",function(){return this._fogStart},function(Fa){this._fogStart=Fa,this._shaderValues.setValue(1,Fa)}),Fq(0,Fa,"fogRange",function(){return this._fogRange},function(Fa){this._fogRange=Fa,this._shaderValues.setValue(2,Fa)}),Fq(0,Fa,"ambientColor",function(){return this._ambientColor},function(Fa){this._ambientColor=Fa,this._shaderValues.setValue(21,Fa.elements)}),Fq(0,Fa,"scene",function(){return this}),Fq(0,Fa,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),Fd._sortScenes=function(Fa,Fb){if(Fa.parent!==Fx.stage||Fb.parent!==Fx.stage)return Fa.parent!==Fx.stage&&Fb.parent!==Fx.stage?Fd._sortScenes(Fa.parent,Fb.parent):Fa.parent===Fx.stage?-1:1;var Fc=Fx.stage._childs;return Fc.indexOf(Fa)-Fc.indexOf(Fb)},Fd.load=function(Fa){return Fx.loader.create(Fa,null,null,Fd)},Fd.FOGCOLOR=0,Fd.FOGSTART=1,Fd.FOGRANGE=2,Fd.LIGHTDIRECTION=3,Fd.LIGHTDIRCOLOR=4,Fd.POINTLIGHTPOS=5,Fd.POINTLIGHTRANGE=6,Fd.POINTLIGHTATTENUATION=7,Fd.POINTLIGHTCOLOR=8,Fd.SPOTLIGHTPOS=9,Fd.SPOTLIGHTDIRECTION=10,Fd.SPOTLIGHTSPOT=11,Fd.SPOTLIGHTRANGE=12,Fd.SPOTLIGHTATTENUATION=13,Fd.SPOTLIGHTCOLOR=14,Fd.SHADOWDISTANCE=15,Fd.SHADOWLIGHTVIEWPROJECT=16,Fd.SHADOWMAPPCFOFFSET=17,Fd.SHADOWMAPTEXTURE1=18,Fd.SHADOWMAPTEXTURE2=19,Fd.SHADOWMAPTEXTURE3=20,Fd.AMBIENTCOLOR=21,Fd.TIME=22,Fd}(Fz),FKb=function(Fa){function Fb(Fa){Fb.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new Fab,this._shaderValues=new Fob,this._colliders=[],this._id=++Fb._uniqueIDCounter,this._transform=new Fyb(this),this.name=Fa||"Sprite3D-"+Fb._nameNumberCounter++,this.layer=FI.currentCreationLayer,this.active=!0}Fp(Fb,"laya.d3.core.Sprite3D",FDb);var Fc=Fb.prototype;return Fx.imps(Fc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),Fc._setUrl=function(Fa){this._url=Fa},Fc._getGroup=function(){return this._group},Fc._setGroup=function(Fa){this._group=Fa},Fc._addChild3D=function(Fa){Fa.transform.parent=this.transform,this._hierarchyAnimator&&(!Fa._hierarchyAnimator&&Fa._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Fa,!0,[Fa.name])),this._scene&&(Fa._setBelongScene(this._scene),this._activeInHierarchy&&Fa._active&&Fa._activeHierarchy())},Fc._removeChild3D=function(Fa){Fa.transform.parent=null,this._scene&&(this._activeInHierarchy&&Fa._active&&Fa._inActiveHierarchy(),Fa._setUnBelongScene()),this._hierarchyAnimator&&(Fa._hierarchyAnimator==this._hierarchyAnimator&&Fa._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Fa,!1,[Fa.name]))},Fc._parseBaseCustomProps=function(Fa){var Fb=this.transform.localPosition;Fa.translate?(Fb.fromArray(Fa.translate),Fb.x*=100,Fb.y*=100,Fb.z*=100):Fb.elements.fill(0),this.transform.localPosition=Fb;var Fc=this.transform.localRotation;Fa.rotation?Fc.fromArray(Fa.rotation):Fc.fromArray([0,0,0,-1]),this.transform.localRotation=Fc;var Fd=this.transform.localScale;Fa.scale?Fd.fromArray(Fa.scale):Fd.elements.fill(1),this.transform.localScale=Fd;var Fe=Fa.layer;null!=Fe&&(this.layer=FI.getLayerByNumber(Fe))},Fc._parseCustomComponent=function(Fa,Fb,Fc){for(var Fd in Fc){var Fe=Fc[Fd];switch(Fd){case"Animator":var Ff=this.addComponent(Animator);if(Fe.avatarPath)Ff.avatar=Ft.getRes(Fb[Fe.avatarPath]);else{var Fg=Fe.avatar;if(Fg){Ff.avatar=Ft.getRes(Fb[Fg.path]);var Fh=Fg.linkSprites;Fh&&Fa.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[Ff,Fh])}}for(var Fi=Fe.clipPaths,Fj=Fi.length,Fm=0;Fm<Fj;Fm++)Ff.addClip(Ft.getRes(Fb[Fi[Fm]]));Ff.clip=Ft.getRes(Fb[Fi[0]]);var Fn=Fe.playOnWake;void 0!==Fn&&(Ff.playOnWake=Fn);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var Fo=this.addComponent(SphereCollider);Fo.isTrigger=Fe.isTrigger;var Fp=Fo.center;Fp.fromArray(Fe.center),Fo.center=Fp,Fo.radius=Fe.radius;break;case"BoxCollider":var Fq=this.addComponent(BoxCollider);Fq.isTrigger=Fe.isTrigger,Fq.center.fromArray(Fe.center);var Fr=Fq.size;Fr.fromArray(Fe.size),Fq.size=Fr;break;case"MeshCollider":this.addComponent(MeshCollider)}}},Fc._onRootNodeHierarchyLoaded=function(Fa,Fb){for(var Fc in Fb){for(var Fd=this,Fe=Fb[Fc],Ff=0,Fg=Fe.length;Ff<Fg;Ff++){var Fh=Fe[Ff];if(""===Fh)break;if(!(Fd=Fd.getChildByName(Fh)))break}Fd&&Fa.linkSprite3DToAvatarNode(Fc,Fd)}},Fc._setHierarchyAnimator=function(Fa,Fb){this._changeHierarchyAnimator(Fa);for(var Fc=0,Fd=this._childs.length;Fc<Fd;Fc++){var Fe=this._childs[Fc];Fe._hierarchyAnimator==Fb&&Fe._setHierarchyAnimator(Fa,Fb)}},Fc._clearHierarchyAnimator=function(Fa,Fb){this._changeHierarchyAnimator(Fb);for(var Fc=0,Fd=this._childs.length;Fc<Fd;Fc++){var Fe=this._childs[Fc];Fe._hierarchyAnimator==Fa&&Fe._clearHierarchyAnimator(Fa,Fb)}},Fc._getAnimatorToLinkSprite3D=function(Fa,Fb,Fc){var Fd=this.getComponentByType(Animator);if(Fd&&(Fd.avatar?Fd.avatar._version||Fa._setAnimatorToLinkAvatar(Fd,Fb):Fa._setAnimatorToLinkSprite3DNoAvatar(Fd,Fb,Fc)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){Fc.unshift(this._parent.name);var Fe=this._parent;Fe._hierarchyAnimator&&Fe._getAnimatorToLinkSprite3D(Fa,Fb,Fc)}},Fc._setAnimatorToLinkSprite3DNoAvatar=function(Fa,Fb,Fc){var Fd=0,Fe=0;for(Fd=0,Fe=Fa.getClipCount();Fd<Fe;Fd++)Fa._handleSpriteOwnersBySprite(Fd,Fb,Fc,this);for(Fd=0,Fe=this._childs.length;Fd<Fe;Fd++){var Ff=this._childs[Fd],Fg=Fc.length;Fc.push(Ff.name),Ff._setAnimatorToLinkSprite3DNoAvatar(Fa,Fb,Fc),Fc.splice(Fg,1)}},Fc._changeHierarchyAnimator=function(Fa){this._hierarchyAnimator=Fa},Fc._isLinkSpriteToAnimationNode=function(Fa,Fb,Fc){var Fd=Fa._avatarNodes.indexOf(Fb),Fe=Fa._cacheSpriteToNodesMap;if(Fc)this._transform.dummy=Fb.transform,Fa._cacheNodesToSpriteMap[Fd]=Fe.length,Fe.push(Fd);else{this._transform.dummy=null;var Ff=Fa._cacheNodesToSpriteMap[Fd];Fa._cacheNodesToSpriteMap[Fd]=null,Fe.splice(Ff,1)}},Fc._setBelongScene=function(Fa){this._scene=Fa;for(var Fb=0,Fc=this._childs.length;Fb<Fc;Fb++)this._childs[Fb]._setBelongScene(Fa)},Fc._setUnBelongScene=function(){this._scene=null;for(var Fa=0,Fb=this._childs.length;Fa<Fb;Fa++)this._childs[Fa]._setUnBelongScene()},Fc._activeHierarchy=function(){var Fa=0,Fb=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),Fa=0,Fb=this._colliders.length;Fa<Fb;Fa++)this._layer._addCollider(this._colliders[Fa]);for(this.event("activeinhierarchychanged",!0),Fa=0,Fb=this._childs.length;Fa<Fb;Fa++){var Fc=this._childs[Fa];Fc._active&&Fc._activeHierarchy()}},Fc._inActiveHierarchy=function(){var Fa=0,Fb=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),Fa=0,Fb=this._colliders.length;Fa<Fb;Fa++){var Fc=this._colliders[Fa];Fc._clearCollsionMap(),this._layer._removeCollider(Fc)}for(this.event("activeinhierarchychanged",!1),Fa=0,Fb=this._childs.length;Fa<Fb;Fa++){var Fd=this._childs[Fa];Fd._active&&Fd._inActiveHierarchy()}},Fc.addComponent=function(Fa){var Fb,Fc=this._componentsMap.indexOf(Fa);if(-1===Fc)Fb=[],this._componentsMap.push(Fa),this._typeComponentsIndices.push(Fb);else if(Fb=this._typeComponentsIndices[Fc],this._components[Fb[0]].isSingleton)throw new Error("无法单实例创建"+Fa+"组件，"+Fa+"组件已存在！");var Fd=Fe.getInstance(Fa);return Fb.push(this._components.length),this._components.push(Fd),Fd instanceof laya.d3.component.Script&&this._scripts.push(Fd),Fd._initialize(this),Fd},Fc._removeComponent=function(Fa,Fb){var Fc,Fd=0,Fe=this._typeComponentsIndices[Fa],Ff=Fe[Fb],Fg=this._components[Ff];for(Fg instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Fg),1),Fe.splice(Fb,1),0===Fe.length&&(this._typeComponentsIndices.splice(Fa,1),this._componentsMap.splice(Fa,1)),Fd=0,Fc=this._componentsMap.length;Fd<Fc;Fd++)for(var Fh=(Fe=this._typeComponentsIndices[Fd]).length-1;0<=Fh;Fh--){var Fi=Fe[Fh];if(!(Ff<Fi))break;Fe[Fh]=--Fi}Fg._destroy()},Fc._clearSelfRenderObjects=function(){},Fc._addSelfRenderObjects=function(){},Fc._parseCustomProps=function(Fa,Fb,Fc,Fd){},Fc._updateChilds=function(Fa){var Fb=this._childs.length;if(0!==Fb)for(var Fc=0;Fc<Fb;++Fc)this._childs[Fc]._update(Fa)},Fc._getSortID=function(Fa,Fb){return 1e3*Fb.id+Fa._getVertexBuffer().vertexDeclaration.id},Fc._update=function(Fa){(Fa.owner=this)._activeInHierarchy&&(this._updateComponents(Fa),this._lateUpdateComponents(Fa),FA.spriteCount++,this._childs.length&&this._updateChilds(Fa))},Fc.getProjectionViewWorldMatrix=function(Fa){return Fab.multiply(Fa,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},Fc.loadHierarchy=function(Fa){this.addChild(laya.d3.core.Sprite3D.load(Fa))},Fc.addChildAt=function(Fa,Fb){if(!(Fa instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Fa||this.destroyed||Fa===this)return Fa;if(Fa.zOrder&&this._set$P("hasZorder",!0),0<=Fb&&Fb<=this._childs.length){if(Fa._parent===this){var Fc=this.getChildIndex(Fa);this._childs.splice(Fc,1),this._childs.splice(Fb,0,Fa),this.conchModel&&(this.conchModel.removeChild(Fa.conchModel),this.conchModel.addChildAt(Fa.conchModel,Fb)),this._childChanged()}else Fa.parent&&Fa.parent.removeChild(Fa),this._childs===Fj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Fb,0,Fa),this.conchModel&&this.conchModel.addChildAt(Fa.conchModel,Fb),(Fa.parent=this)._addChild3D(Fa);return Fa}throw new Error("appendChildAt:The index is out of bounds")},Fc.addChild=function(Fa){if(!(Fa instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Fa||this.destroyed||Fa===this)return Fa;if(Fa.zOrder&&this._set$P("hasZorder",!0),Fa._parent===this){var Fb=this.getChildIndex(Fa);Fb!==this._childs.length-1&&(this._childs.splice(Fb,1),this._childs.push(Fa),this.conchModel&&(this.conchModel.removeChild(Fa.conchModel),this.conchModel.addChildAt(Fa.conchModel,this._childs.length-1)),this._childChanged())}else Fa.parent&&Fa.parent.removeChild(Fa),this._childs===Fj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Fa),this.conchModel&&this.conchModel.addChildAt(Fa.conchModel,this._childs.length-1),(Fa.parent=this)._childChanged(),this._addChild3D(Fa);return Fa},Fc.removeChildAt=function(Fa){var Fb=this.getChildAt(Fa);return Fb&&(this._removeChild3D(Fb),this._childs.splice(Fa,1),this.conchModel&&this.conchModel.removeChild(Fb.conchModel),Fb.parent=null),Fb},Fc.removeChildren=function(Fa,Fb){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=2147483647),this._childs&&0<this._childs.length){var Fc=this._childs;if(0===Fa&&Ff<=Fb){var Fd=Fc;this._childs=Fj.ARRAY_EMPTY}else Fd=Fc.splice(Fa,Fb-Fa);for(var Fe=0,Ff=Fd.length;Fe<Ff;Fe++)this._removeChild3D(Fd[Fe]),Fd[Fe].parent=null,this.conchModel&&this.conchModel.removeChild(Fd[Fe].conchModel)}return this},Fc.onAsynLoaded=function(Fa,Fb,Fc){var Fd=Fb[0];if("Sprite3D"!==Fd.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var Fe=Fb[1];Fsb._createNodeByJson(this,Fd,this,Fe),this.event("hierarchyloaded",[this]),this.__loaded=!0},Fc.cloneTo=function(Fa){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var Fb=Fa;Fb.name=this.name,Fb._destroyed=this._destroyed,Fb.timer=this.timer,Fb._$P=this._$P,Fb.active=this._active;var Fc=Fb.transform.localPosition;this.transform.localPosition.cloneTo(Fc),Fb.transform.localPosition=Fc;var Fd=Fb.transform.localRotation;this.transform.localRotation.cloneTo(Fd),Fb.transform.localRotation=Fd;var Fe=Fb.transform.localScale;this.transform.localScale.cloneTo(Fe),Fb.transform.localScale=Fe,Fb.isStatic=this.isStatic;var Ff=0,Fg=0;for(Ff=0,Fg=this._componentsMap.length;Ff<Fg;Ff++){var Fh=Fb.addComponent(this._componentsMap[Ff]);this._components[Ff]._cloneTo(Fh)}for(Ff=0,Fg=this._childs.length;Ff<Fg;Ff++)Fb.addChild(this._childs[Ff].clone());var Fi=Fb.getComponentByType(Animator);if(Fi){var Fj=Fi._linkSpritesData;if(Fj)for(var Fm in Fj){for(var Fn=Fj[Fm],Fo=Fb,Fp=0,Fq=Fn.length;Fp<Fq&&(Fo=Fo.getChildByName(Fn[Fp]));Fp++);if(Fo){var Fr=Fi._avatarNodeMap[Fm];Fo._isLinkSpriteToAnimationNode(Fi,Fr,!0)}}}},Fc.clone=function(){var Fa=new this.constructor;return this.cloneTo(Fa),Fa},Fc.destroy=function(Fa){if(void 0===Fa&&(Fa=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,Fa);var Fb,Fc=0;for(Fc=0,Fb=this._components.length;Fc<Fb;Fc++)this._components[Fc]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,Ft.clearRes(this.url),this.loaded||Ftb._cancelLoadByUrl(this.url)}},Fc._handleSpriteToAvatar=function(Fa,Fb){Fa._avatarNodes;var Fc=Fa._avatarNodeMap[this.name];Fc&&Fc.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(Fa,Fc,Fb)},Fc._setAnimatorToLinkAvatar=function(Fa,Fb){this._handleSpriteToAvatar(Fa,Fb);for(var Fc=0,Fd=this._childs.length;Fc<Fd;Fc++){this._childs[Fc]._setAnimatorToLinkAvatar(Fa,Fb)}},Fq(0,Fc,"activeInHierarchy",function(){return this._activeInHierarchy}),Fq(0,Fc,"_loaded",null,function(Fa){this.__loaded=Fa}),Fq(0,Fc,"active",function(){return this._active},function(Fa){this._active!==Fa&&(this._active=Fa,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(Fa?this._activeHierarchy():this._inActiveHierarchy()))}),Fq(0,Fc,"componentsCount",function(){return this._components.length}),Fq(0,Fc,"loaded",function(){return this.__loaded}),Fq(0,Fc,"id",function(){return this._id}),Fq(0,Fc,"url",function(){return this._url}),Fq(0,Fc,"layer",function(){return this._layer},function(Fa){if(this._layer!==Fa){if(!Fa)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var Fb=0,Fc=this._colliders.length;if(this._layer)for(Fb=0;Fb<Fc;Fb++)this._layer._removeCollider(this._colliders[Fb]);for(Fb=0;Fb<Fc;Fb++)Fa._addCollider(this._colliders[Fb])}this._layer=Fa,this.event("layerchanged",Fa)}}),Fq(0,Fc,"scene",function(){return this._scene}),Fq(0,Fc,"transform",function(){return this._transform}),Fb.instantiate=function(Fa,Fb,Fc,Fd,Fe){void 0===Fc&&(Fc=!0);var Ff=Fa.clone();Fb&&Fb.addChild(Ff);var Fg=Ff.transform;if(Fc){var Fh=Fg.worldMatrix;Fa.transform.worldMatrix.cloneTo(Fh),Fg.worldMatrix=Fh}else Fd&&(Fg.position=Fd),Fe&&(Fg.rotation=Fe);return Ff},Fb.load=function(Fa){return Fx.loader.create(Fa,null,null,Fb)},Fb.WORLDMATRIX=0,Fb.MVPMATRIX=1,Fb._uniqueIDCounter=0,Fb._nameNumberCounter=0,Fb}(),FLb=function(Fa){function Fm(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],Fm.__super.call(this),!Fa||!Fb)throw"Shader Error";this._id=++Fm._count,this._vs=Fa,this._ps=Fb,this._attributeMap=Fc,this._sceneUniformMap=Fd,this._cameraUniformMap=Fe,this._spriteUniformMap=Ff,this._materialUniformMap=Fg,this._renderElementUniformMap=Fh,this._precompile=Fi,this._define=Fj,this._precompile&&Fm.extCompileObj&&Fm.extCompileFunc?Fm.extCompileFunc.call(Fm.extCompileObj,Fa,Fb,Fj):this.recreateResource()}Fp(Fm,"laya.d3.shader.Shader3D",Fc);var Fb=Fm.prototype;return Fb.recreateResource=function(){FH.now();this._compile(),this.completeCreate(),this.memorySize=0},Fb.disposeResource=function(){FF.mainContext.deleteShader(this._vshader),FF.mainContext.deleteShader(this._pshader),FF.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},Fb._compile=function(){if(!FF.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var Fa=[this._vs,this._ps],Fb=FF.mainContext;if(this._program=Fb.createProgram(),this._vshader=Fm._createShader(Fb,Fa[0],35633),this._pshader=Fm._createShader(Fb,Fa[1],35632),Fb.attachShader(this._program,this._vshader),Fb.attachShader(this._program,this._pshader),Fb.linkProgram(this._program),!Fr.isConchApp&&FAb.debugMode&&!Fb.getProgramParameter(this._program,35714))throw Fb.getProgramInfoLog(this._program);var Fc,Fd=0,Fe=0,Ff=0;for(Ff=Fr.isConchApp?Fb.getProgramParameterEx(this._vs,this._ps,"",35721):Fb.getProgramParameter(this._program,35721),Fd=0;Fd<Ff;Fd++){var Fg=null;Fc={vartype:"attribute",ivartype:0,attrib:Fg=Fr.isConchApp?Fb.getActiveAttribEx(this._vs,this._ps,"",Fd):Fb.getActiveAttrib(this._program,Fd),location:Fb.getAttribLocation(this._program,Fg.name),name:Fg.name,type:Fg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(Fc)}var Fh=0;for(Fh=Fr.isConchApp?Fb.getProgramParameterEx(this._vs,this._ps,"",35718):Fb.getProgramParameter(this._program,35718),Fd=0;Fd<Fh;Fd++){var Fi=null;Fi=Fr.isConchApp?Fb.getActiveUniformEx(this._vs,this._ps,"",Fd):Fb.getActiveUniform(this._program,Fd),0<(Fc={vartype:"uniform",ivartype:1,attrib:Fg,location:Fb.getUniformLocation(this._program,Fi.name),name:Fi.name,type:Fi.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Fc.name=Fc.name.substr(0,Fc.name.length-3),Fc.isArray=!0,Fc.location=Fb.getUniformLocation(this._program,Fc.name)),this._uniformParams.push(Fc)}for(Fd=0,Fe=this._attributeParams.length;Fd<Fe;Fd++)(Fc=this._attributeParams[Fd]).indexOfParams=Fd,Fc.index=1,Fc.value=[Fc.location,null],Fc.codename=Fc.name,Fc.name=null!=this._attributeMap[Fc.codename]?this._attributeMap[Fc.codename]:Fc.codename,this._attributeParamsMap.push(Fc.name),this._attributeParamsMap.push(Fc),Fc._this=this,Fc.uploadedValue=[],Fc.fun=this._attribute;for(Fd=0,Fe=this._uniformParams.length;Fd<Fe;Fd++)switch((Fc=this._uniformParams[Fd]).indexOfParams=Fd,Fc.index=1,Fc.value=[Fc.location,null],Fc.codename=Fc.name,null!=this._sceneUniformMap[Fc.codename]?(Fc.name=this._sceneUniformMap[Fc.codename],this._sceneUniformParamsMap.push(Fc.name),this._sceneUniformParamsMap.push(Fc)):null!=this._cameraUniformMap[Fc.codename]?(Fc.name=this._cameraUniformMap[Fc.codename],this._cameraUniformParamsMap.push(Fc.name),this._cameraUniformParamsMap.push(Fc)):null!=this._spriteUniformMap[Fc.codename]?(Fc.name=this._spriteUniformMap[Fc.codename],this._spriteUniformParamsMap.push(Fc.name),this._spriteUniformParamsMap.push(Fc)):null!=this._materialUniformMap[Fc.codename]?(Fc.name=this._materialUniformMap[Fc.codename],this._materialUniformParamsMap.push(Fc.name),this._materialUniformParamsMap.push(Fc)):null!=this._renderElementUniformMap[Fc.codename]?(Fc.name=this._renderElementUniformMap[Fc.codename],this._renderElementUniformParamsMap.push(Fc.name),this._renderElementUniformParamsMap.push(Fc)):console.log("Shader:can't find uinform name:"+Fc.codename+" in shader file."),Fc._this=this,Fc.uploadedValue=[],Fc.type){case 5124:Fc.fun=Fc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Fc.fun=Fc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Fc.fun=Fc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Fc.fun=Fc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Fc.fun=Fc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Fc.fun=this._uniform_sampler2D;break;case 35680:Fc.fun=this._uniform_samplerCube;break;case 35676:Fc.fun=this._uniformMatrix4fv;break;case 35670:Fc.fun=this._uniform1i;break;case 35674:Fc.fun=this._uinformMatrix2fv;break;case 35675:Fc.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},Fb._attribute=function(Fa,Fb){var Fc=FF.mainContext,Fd=Fh._enableAtributes,Fe=Fa.location;return Fd[Fe]||Fc.enableVertexAttribArray(Fe),Fc.vertexAttribPointer(Fe,Fb[0],Fb[1],Fb[2],Fb[3],Fb[4]),Fd[Fe]=Fh._bindVertexBuffer,1},Fb._uniform1f=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb?(FF.mainContext.uniform1f(Fa.location,Fc[0]=Fb),1):0},Fb._uniform1fv=function(Fa,Fb){if(Fb.length<4){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(FF.mainContext.uniform1fv(Fa.location,Fb),Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3],1):0}return FF.mainContext.uniform1fv(Fa.location,Fb),1},Fb._uniform_vec2=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]?(FF.mainContext.uniform2f(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1]),1):0},Fb._uniform_vec2v=function(Fa,Fb){if(Fb.length<2){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(FF.mainContext.uniform2fv(Fa.location,Fb),Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3],1):0}return FF.mainContext.uniform2fv(Fa.location,Fb),1},Fb._uniform_vec3=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]?(FF.mainContext.uniform3f(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2]),1):0},Fb._uniform_vec3v=function(Fa,Fb){return FF.mainContext.uniform3fv(Fa.location,Fb),1},Fb._uniform_vec4=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(FF.mainContext.uniform4f(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3]),1):0},Fb._uniform_vec4v=function(Fa,Fb){return FF.mainContext.uniform4fv(Fa.location,Fb),1},Fb._uniformMatrix2fv=function(Fa,Fb){return FF.mainContext.uniformMatrix2fv(Fa.location,!1,Fb),1},Fb._uniformMatrix3fv=function(Fa,Fb){return FF.mainContext.uniformMatrix3fv(Fa.location,!1,Fb),1},Fb._uniformMatrix4fv=function(Fa,Fb){return FF.mainContext.uniformMatrix4fv(Fa.location,!1,Fb),1},Fb._uinformMatrix2fv=function(Fa,Fb){return FF.mainContext.uniformMatrix2fv(Fa.location,!1,Fb),1},Fb._uinformMatrix3fv=function(Fa,Fb){return FF.mainContext.uniformMatrix3fv(Fa.location,!1,Fb),1},Fb._uniform1i=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb?(FF.mainContext.uniform1i(Fa.location,Fc[0]=Fb),1):0},Fb._uniform1iv=function(Fa,Fb){return FF.mainContext.uniform1iv(Fa.location,Fb),1},Fb._uniform_ivec2=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]?(FF.mainContext.uniform2i(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1]),1):0},Fb._uniform_ivec2v=function(Fa,Fb){return FF.mainContext.uniform2iv(Fa.location,Fb),1},Fb._uniform_vec3i=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]?(FF.mainContext.uniform3i(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2]),1):0},Fb._uniform_vec3vi=function(Fa,Fb){return FF.mainContext.uniform3iv(Fa.location,Fb),1},Fb._uniform_vec4i=function(Fa,Fb){var Fc=Fa.uploadedValue;return Fc[0]!==Fb[0]||Fc[1]!==Fb[1]||Fc[2]!==Fb[2]||Fc[3]!==Fb[3]?(FF.mainContext.uniform4i(Fa.location,Fc[0]=Fb[0],Fc[1]=Fb[1],Fc[2]=Fb[2],Fc[3]=Fb[3]),1):0},Fb._uniform_vec4vi=function(Fa,Fb){return FF.mainContext.uniform4iv(Fa.location,Fb),1},Fb._uniform_sampler2D=function(Fa,Fb){var Fc=Fb.source||Fb.defaulteTexture.source,Fd=FF.mainContext,Fe=Fa.uploadedValue;if(null!=Fe[0])return Fd.activeTexture(Fm._TEXTURES[Fe[0]]),Fc&&FG.bindTexture(Fd,3553,Fc),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Fe[0]=this._curActTexIndex,Fd.uniform1i(Fa.location,this._curActTexIndex),Fd.activeTexture(Fm._TEXTURES[this._curActTexIndex]),Fc&&FG.bindTexture(Fd,3553,Fc),this._curActTexIndex++,1},Fb._uniform_samplerCube=function(Fa,Fb){var Fc=Fb.source||Fb.defaulteTexture.source,Fd=FF.mainContext,Fe=Fa.uploadedValue;if(null!=Fe[0])return Fd.activeTexture(Fm._TEXTURES[Fe[0]]),Fc?FG.bindTexture(Fd,34067,Fc):FG.bindTexture(Fd,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Fe[0]=this._curActTexIndex,Fd.uniform1i(Fa.location,this._curActTexIndex),Fd.activeTexture(Fm._TEXTURES[this._curActTexIndex]),Fc?FG.bindTexture(Fd,34067,Fc):FG.bindTexture(Fd,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},Fb._noSetValue=function(Fa){console.log("no....:"+Fa.name)},Fb.bind=function(){return Fc.activeShader=this,(Fc.bindShader=this).activeResource(),FG.UseProgram(this._program)},Fb.uploadAttributes=function(Fa,Fb){for(var Fc,Fd,Fe=0,Ff=0,Fg=this._attributeParamsMap.length;Ff<Fg;Ff+=2)Fd=this._attributeParamsMap[Ff+1],null!=(Fc=Fa[this._attributeParamsMap[Ff]])&&(Fb&&Fb[Fd.name]&&Fb[Fd.name].bind(),Fe+=Fd.fun.call(this,Fd,Fc));FA.shaderCall+=Fe},Fb.uploadAttributesX=function(Fa,Fb){for(var Fc,Fd,Fe=0,Ff=0,Fg=this._attributeParamsMap.length;Ff<Fg;Ff+=2)Fd=this._attributeParamsMap[Ff+1],null!=(Fc=Fa[this._attributeParamsMap[Ff]])&&(Fb._bind(),Fe+=Fd.fun.call(this,Fd,Fc));FA.shaderCall+=Fe},Fb.uploadSceneUniforms=function(Fa){for(var Fb,Fc,Fd=0,Fe=0,Ff=this._sceneUniformParamsMap.length;Fe<Ff;Fe+=2)Fc=this._sceneUniformParamsMap[Fe+1],null!=(Fb=Fa[this._sceneUniformParamsMap[Fe]])&&(Fd+=Fc.fun.call(this,Fc,Fb));FA.shaderCall+=Fd},Fb.uploadCameraUniforms=function(Fa){for(var Fb,Fc,Fd=0,Fe=0,Ff=this._cameraUniformParamsMap.length;Fe<Ff;Fe+=2)Fc=this._cameraUniformParamsMap[Fe+1],null!=(Fb=Fa[this._cameraUniformParamsMap[Fe]])&&(Fd+=Fc.fun.call(this,Fc,Fb));FA.shaderCall+=Fd},Fb.uploadSpriteUniforms=function(Fa){for(var Fb,Fc,Fd=0,Fe=0,Ff=this._spriteUniformParamsMap.length;Fe<Ff;Fe+=2)Fc=this._spriteUniformParamsMap[Fe+1],null!=(Fb=Fa[this._spriteUniformParamsMap[Fe]])&&(Fd+=Fc.fun.call(this,Fc,Fb));FA.shaderCall+=Fd},Fb.uploadMaterialUniforms=function(Fa){for(var Fb,Fc,Fd=0,Fe=0,Ff=this._materialUniformParamsMap.length;Fe<Ff;Fe+=2)Fc=this._materialUniformParamsMap[Fe+1],null!=(Fb=Fa[this._materialUniformParamsMap[Fe]])&&(Fd+=Fc.fun.call(this,Fc,Fb));FA.shaderCall+=Fd},Fb.uploadRenderElementUniforms=function(Fa){for(var Fb,Fc,Fd=0,Fe=0,Ff=this._renderElementUniformParamsMap.length;Fe<Ff;Fe+=2)Fc=this._renderElementUniformParamsMap[Fe+1],null!=(Fb=Fa[this._renderElementUniformParamsMap[Fe]])&&(Fd+=Fc.fun.call(this,Fc,Fb));FA.shaderCall+=Fd},Fm.create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){return new Fm(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj)},Fm.addInclude=function(Fa,Fb){Fv.addInclude(Fa,Fb)},Fm._createShader=function(Fa,Fb,Fc){var Fd=Fa.createShader(Fc);if(Fa.shaderSource(Fd,Fb),Fa.compileShader(Fd),FAb.debugMode&&!Fa.getShaderParameter(Fd,35713))throw Fa.getShaderInfoLog(Fd);return Fd},Fm.PERIOD_RENDERELEMENT=0,Fm.PERIOD_MATERIAL=1,Fm.PERIOD_SPRITE=2,Fm.PERIOD_CAMERA=3,Fm.PERIOD_SCENE=4,Fm._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],Fm._count=0,Fm._preCompile=!1,Fm.extCompileFunc=null,Fm.extCompileObj=null,Fn(Fm,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new FB}]),Fm}(),FMb=function(Fh){function Fi(){this._transformUV=null,Fi.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new Fgb(.6,.6,.6)),this._setColor(10,new Fgb(1,1,1)),this._setColor(11,new Fhb(1,1,1,8)),this._setColor(12,new Fgb(1,1,1)),this._setColor(7,new Fhb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new Fhb(1,1,0,0)),this.renderMode=1}Fp(Fi,"laya.d3.core.material.StandardMaterial",Fh);var Fa=Fi.prototype;return Fa.disableLight=function(){this._addDisablePublicShaderDefine(FAb.SHADERDEFINE_POINTLIGHT|FAb.SHADERDEFINE_SPOTLIGHT|FAb.SHADERDEFINE_DIRECTIONLIGHT)},Fa.disableFog=function(){this._addDisablePublicShaderDefine(FAb.SHADERDEFINE_FOG)},Fa.onAsynLoaded=function(Fa,Fb,Fc){var Fd=Fb[0];if(Fd.version)Fh.prototype.onAsynLoaded.call(this,Fa,Fb,Fc);else{var Fe=Fb[1],Ff=Fd.props;for(var Fg in Ff)this[Fg]=Ff[Fg];Fi._parseStandardMaterial(Fe,this,Fd),this._endLoaded()}},Fa.cloneTo=function(Fa){Fh.prototype.cloneTo.call(this,Fa);var Fb=Fa;this._transformUV&&(Fb._transformUV=this._transformUV.clone())},Fq(0,Fa,"ambientColor",function(){return this._getColor(9)},function(Fa){this._setColor(9,Fa)}),Fq(0,Fa,"ambientTexture",function(){return this._getTexture(5)},function(Fa){Fa?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,Fa)}),Fq(0,Fa,"renderMode",null,function(Fa){switch(Fa){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Fi.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(Fa)}),Fq(0,Fa,"reflectColor",function(){return this._getColor(12)},function(Fa){this._setColor(12,Fa)}),Fq(0,Fa,"tilingOffset",function(){return this._getColor(15)},function(Fa){if(Fa){var Fb=Fa.elements;1!=Fb[0]||1!=Fb[1]||0!=Fb[2]||0!=Fb[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,Fa)}),Fq(0,Fa,"albedo",function(){return this._getColor(7)},function(Fa){this._setColor(7,Fa)}),Fq(0,Fa,"diffuseColor",function(){return this._getColor(10)},function(Fa){this._setColor(10,Fa)}),Fq(0,Fa,"albedoColor",function(){return this._getColor(7)},function(Fa){this._setColor(7,Fa)}),Fq(0,Fa,"specularColor",function(){return this._getColor(11)},function(Fa){this._setColor(11,Fa)}),Fq(0,Fa,"diffuseTexture",function(){return this._getTexture(1)},function(Fa){Fa?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,Fa)}),Fq(0,Fa,"normalTexture",function(){return this._getTexture(2)},function(Fa){Fa?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,Fa)}),Fq(0,Fa,"specularTexture",function(){return this._getTexture(3)},function(Fa){Fa?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,Fa)}),Fq(0,Fa,"emissiveTexture",function(){return this._getTexture(4)},function(Fa){Fa?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,Fa)}),Fq(0,Fa,"reflectTexture",function(){return this._getTexture(6)},function(Fa){Fa?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,Fa)}),Fq(0,Fa,"transformUV",function(){return this._transformUV},function(Fa){this._transformUV=Fa,this._setMatrix4x4(13,Fa.matrix),Fa?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,Fa.matrix.elements,0)}),Fi.__init__=function(){Fi.SHADERDEFINE_DIFFUSEMAP=Fi.shaderDefines.registerDefine("DIFFUSEMAP"),Fi.SHADERDEFINE_NORMALMAP=Fi.shaderDefines.registerDefine("NORMALMAP"),Fi.SHADERDEFINE_SPECULARMAP=Fi.shaderDefines.registerDefine("SPECULARMAP"),Fi.SHADERDEFINE_EMISSIVEMAP=Fi.shaderDefines.registerDefine("EMISSIVEMAP"),Fi.SHADERDEFINE_AMBIENTMAP=Fi.shaderDefines.registerDefine("AMBIENTMAP"),Fi.SHADERDEFINE_REFLECTMAP=Fi.shaderDefines.registerDefine("REFLECTMAP"),Fi.SHADERDEFINE_UVTRANSFORM=Fi.shaderDefines.registerDefine("UVTRANSFORM"),Fi.SHADERDEFINE_TILINGOFFSET=Fi.shaderDefines.registerDefine("TILINGOFFSET"),Fi.SHADERDEFINE_ADDTIVEFOG=Fi.shaderDefines.registerDefine("ADDTIVEFOG")},Fi.load=function(Fa){return Fx.loader.create(Fa,null,null,Fi)},Fi._parseStandardMaterial=function(Fa,Fb,Fc){var Fd=Fc.customProps,Fe=Fd.ambientColor;Fb.ambientColor=new Fgb(Fe[0],Fe[1],Fe[2]);var Ff=Fd.diffuseColor;Fb.diffuseColor=new Fgb(Ff[0],Ff[1],Ff[2]);var Fg=Fd.specularColor;Fb.specularColor=new Fhb(Fg[0],Fg[1],Fg[2],Fg[3]);var Fh=Fd.reflectColor;Fb.reflectColor=new Fgb(Fh[0],Fh[1],Fh[2]);var Fi=Fd.albedoColor;Fi&&(Fb.albedo=new Fhb(Fi[0],Fi[1],Fi[2],Fi[3]));var Fj=Fd.diffuseTexture.texture2D;Fj&&(Fb.diffuseTexture=Ft.getRes(Fa[Fj]));var Fm=Fd.normalTexture.texture2D;Fm&&(Fb.normalTexture=Ft.getRes(Fa[Fm]));var Fn=Fd.specularTexture.texture2D;Fn&&(Fb.specularTexture=Ft.getRes(Fa[Fn]));var Fo=Fd.emissiveTexture.texture2D;Fo&&(Fb.emissiveTexture=Ft.getRes(Fa[Fo]));var Fp=Fd.ambientTexture.texture2D;Fp&&(Fb.ambientTexture=Ft.getRes(Fa[Fp]));var Fq=Fd.reflectTexture.texture2D;Fq&&(Fb.reflectTexture=Ft.getRes(Fa[Fq]))},Fi.RENDERMODE_OPAQUE=1,Fi.RENDERMODE_OPAQUEDOUBLEFACE=2,Fi.RENDERMODE_CUTOUT=3,Fi.RENDERMODE_CUTOUTDOUBLEFACE=4,Fi.RENDERMODE_TRANSPARENT=13,Fi.RENDERMODE_TRANSPARENTDOUBLEFACE=14,Fi.RENDERMODE_ADDTIVE=15,Fi.RENDERMODE_ADDTIVEDOUBLEFACE=16,Fi.RENDERMODE_DEPTHREAD_TRANSPARENT=5,Fi.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,Fi.RENDERMODE_DEPTHREAD_ADDTIVE=7,Fi.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,Fi.RENDERMODE_NONDEPTH_TRANSPARENT=9,Fi.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,Fi.RENDERMODE_NONDEPTH_ADDTIVE=11,Fi.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,Fi.SHADERDEFINE_DIFFUSEMAP=0,Fi.SHADERDEFINE_NORMALMAP=0,Fi.SHADERDEFINE_SPECULARMAP=0,Fi.SHADERDEFINE_EMISSIVEMAP=0,Fi.SHADERDEFINE_AMBIENTMAP=0,Fi.SHADERDEFINE_REFLECTMAP=0,Fi.SHADERDEFINE_UVTRANSFORM=0,Fi.SHADERDEFINE_TILINGOFFSET=0,Fi.SHADERDEFINE_ADDTIVEFOG=0,Fi.DIFFUSETEXTURE=1,Fi.NORMALTEXTURE=2,Fi.SPECULARTEXTURE=3,Fi.EMISSIVETEXTURE=4,Fi.AMBIENTTEXTURE=5,Fi.REFLECTTEXTURE=6,Fi.ALBEDO=7,Fi.UVANIAGE=8,Fi.MATERIALAMBIENT=9,Fi.MATERIALDIFFUSE=10,Fi.MATERIALSPECULAR=11,Fi.MATERIALREFLECT=12,Fi.UVMATRIX=13,Fi.UVAGE=14,Fi.TILINGOFFSET=15,Fn(Fi,["defaultMaterial",function(){var Fa=new Fi;return Fa.lock=!0,this.defaultMaterial=Fa},"shaderDefines",function(){return this.shaderDefines=new Fmb(FEb.shaderDefines)}]),Fi}(FEb),FNb=function(Fa){function Fg(Fa,Fb,Fc,Fd,Fe){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===Fc&&(Fc=35044),void 0===Fd&&(Fd=!1),Fg.__super.call(this),this._indexType=Fa,this._indexCount=Fb,this._bufferUsage=Fc,this._bufferType=34963,this._canRead=Fd;var Ff;if("ushort"==Fa)this._indexTypeByteCount=2;else{if("ubyte"!=Fa)throw new Error("unidentification index type.");this._indexTypeByteCount=1}Ff=this._indexTypeByteCount*Fb,this._byteLength=Ff,this._bind(),Fh._gl.bufferData(this._bufferType,Ff,this._bufferUsage),this.uri=Fe,Fd?("ushort"==Fa?this._buffer=new Uint16Array(Fb):"ubyte"==Fa&&(this._buffer=new Uint8Array(Fb)),this.memorySize=2*Ff):this.memorySize=Ff}Fp(Fg,"laya.d3.graphics.IndexBuffer3D",Fa);var Fb=Fg.prototype;return Fb.setData=function(Fa,Fb,Fc,Fd){void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=4294967295);var Fe=0;if("ushort"==this._indexType?(Fe=2,0===Fc&&4294967295===Fd||(Fa=new Uint16Array(Fa.buffer,Fc*Fe,Fd))):"ubyte"==this._indexType&&(Fe=1,0===Fc&&4294967295===Fd||(Fa=new Uint8Array(Fa.buffer,Fc*Fe,Fd))),this._bind(),Fh._gl.bufferSubData(this._bufferType,Fb*Fe,Fa),this._canRead)if(0!==Fb||0!==Fc||4294967295!==Fd){var Ff=this._buffer.length-Fb;Ff<Fd&&(Fd=Ff);for(var Fg=0;Fg<Fd;Fg++)this._buffer[Fb+Fg]=Fa[Fg]}else this._buffer=Fa},Fb.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Fb.disposeResource=function(){Fa.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},Fq(0,Fb,"indexType",function(){return this._indexType}),Fq(0,Fb,"indexTypeByteCount",function(){return this._indexTypeByteCount}),Fq(0,Fb,"indexCount",function(){return this._indexCount}),Fq(0,Fb,"canRead",function(){return this._canRead}),Fg.INDEXTYPE_UBYTE="ubyte",Fg.INDEXTYPE_USHORT="ushort",Fg.create=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fc&&(Fc=35044),void 0===Fd&&(Fd=!1),new Fg(Fa,Fb,Fc,Fd,Fe)},Fg}(Fh),FOb=function(Ff){function Fg(Fa,Fb,Fc,Fd,Fe){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===Fd&&(Fd=!1),Fg.__super.call(this),this._vertexDeclaration=Fa,this._vertexCount=Fb,this._bufferUsage=Fc,this._bufferType=34962,this._canRead=Fd,this.uri=Fe,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*Fb,this._bind(),Fh._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),Fd&&(this._buffer=new Float32Array(this._byteLength/4))}Fp(Fg,"laya.d3.graphics.VertexBuffer3D",Ff);var Fa=Fg.prototype;return Fa.bindWithIndexBuffer=function(Fa){Fa&&Fa._bind(),this._bind()},Fa.setData=function(Fa,Fb,Fc,Fd){if(void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=4294967295),0===Fc&&4294967295===Fd||(Fa=new Float32Array(Fa.buffer,4*Fc,Fd)),this._bind(),Fh._gl.bufferSubData(this._bufferType,4*Fb,Fa),this._canRead)if(0!==Fb||0!==Fc||4294967295!==Fd){var Fe=this._buffer.length-Fb;Fe<Fd&&(Fd=Fe);for(var Ff=0;Ff<Fd;Ff++)this._buffer[Fb+Ff]=Fa[Ff]}else this._buffer=Fa},Fa.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Fa.disposeResource=function(){for(var Fa=FF.mainContext,Fb=this._vertexDeclaration.getVertexElements(),Fc=Fh._enableAtributes,Fd=0,Fe=Fb.length;Fd<Fe;Fd++)Fc[Fd]===this._glBuffer&&(Fa.disableVertexAttribArray(Fd),Fc[Fd]=null);Ff.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},Fq(0,Fa,"vertexDeclaration",function(){return this._vertexDeclaration}),Fq(0,Fa,"vertexCount",function(){return this._vertexCount}),Fq(0,Fa,"canRead",function(){return this._canRead}),Fg.create=function(Fa,Fb,Fc,Fd,Fe){return void 0===Fc&&(Fc=35044),void 0===Fd&&(Fd=!1),new Fg(Fa,Fb,Fc,Fd,Fe)},Fg}(Fh),FPb=function(Fa){function Fv(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,Fv.__super.call(this),this._type=3553}Fp(Fv,"laya.d3.resource.DataTexture2D",FFb);var Fb=Fv.prototype;return Fb.genDebugMipmaps=function(){var Fa=[];return Fa.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),Fa.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),Fa.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),Fa.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),Fa.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),Fa.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),Fa.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),Fa.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),Fa.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),Fa.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),Fa},Fb._onTextureLoaded=function(Fa){},Fb._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var Fa=FF.mainContext,Fb=this._source=Fa.createTexture(),Fc=this._width,Fd=this._height,Fe=FG.curBindTexTarget,Ff=FG.curBindTexValue,Fg=!1;if(FG.bindTexture(Fa,this._type,Fb),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var Fh=0;Fa.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var Fi=0;Fi<this._mipmaps.length;Fi++){if(this._mipmaps[Fi].byteLength!=Fj*Fm*4)throw"mipmap size error  level:"+Fi;Fa.texSubImage2D(this._type,0,Fv.simLodRect[Fh++],Fv.simLodRect[Fh++],Fv.simLodRect[Fh++],Fv.simLodRect[Fh++],6408,5121,new Uint8Array(this._mipmaps[Fi]))}this.minFifter=9729,this.magFifter=9729}else{var Fj=this._width,Fm=this._height;for(Fh=0,Fa.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),Fi=0;Fi<this._mipmaps.length;Fi++){if(this._mipmaps[Fi].byteLength!=Fj*Fm*4)throw"mipmap size error  level:"+Fi;Fa.texImage2D(this._type,Fi,6408,Fj,Fm,0,6408,5121,new Uint8Array(this._mipmaps[Fi])),(Fj/=2)<1&&(Fj=1),(Fm/=2)<1&&(Fm=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&Fa.pixelStorei(Fa.UNPACK_ALIGNMENT,1),Fa.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var Fn=0,Fo=!1,Fp=!1;this._buffer.byteLength==4*Fc*Fd?(Fn=6408,Fo=!0):this._buffer.byteLength==3*Fc*Fd?(Fn=6407,Fp=!0):Fn=this._format,Fo||Fp?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),Fp&&Fa.pixelStorei(Fa.UNPACK_ALIGNMENT,1),Fa.texImage2D(this._type,0,Fn,Fc,Fd,0,Fn,5121,this._buffer)):Fa&&Fn==Fa.ALPHA?(Fa.texImage2D(3553,0,Fn,Fc,Fd,0,Fn,Fa.UNSIGNED_BYTE,this._buffer),Fg=!0):0!=Fn&&(Fa.compressedTexImage2D(3553,0,Fn,Fc,Fd,0,this._buffer),Fg=!0)}var Fq=this._minFifter,Fr=this._magFifter,Fs=0==this._wrapModeU?10497:33071,Ft=0==this._wrapModeV?10497:33071,Fu=Fw.isPOT(Fc,Fd);Fu?(this._mipmap||this._mipmaps?-1!==Fq||(Fq=9987):-1!==Fq||(Fq=9729),-1!==Fr||(Fr=9729),Fa.texParameteri(this._type,10241,Fq),Fa.texParameteri(this._type,10240,Fr),Fa.texParameteri(this._type,10242,Fs),Fa.texParameteri(this._type,10243,Ft),this._mipmap&&Fa.generateMipmap(this._type)):(-1!==Fq||(Fq=9729),-1!==Fr||(Fr=9729),Fa.texParameteri(this._type,10241,Fq),Fa.texParameteri(this._type,10240,Fr),Fa.texParameteri(this._type,10242,33071),Fa.texParameteri(this._type,10243,33071)),Fe&&Ff&&FG.bindTexture(Fa,Fe,Ff),this.memorySize=Fg?this._buffer.length:Fu?Fc*Fd*4*(1+1/3):Fc*Fd*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},Fb.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},Fb.onAsynLoaded=function(Fa,Fb,Fc){var Fd;Fc&&(Fd=Fc[0].call(this,Fb)),Fd&&(this._width=Fd.width,this._height=Fd.height,this._buffer=Fd.data),this._src=Fa,this._size=new Frb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},Fb.getPixels=function(){return new Uint8Array(this._buffer)},Fb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(FF.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},Fq(0,Fb,"src",function(){return this._src}),Fv.create=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){if(void 0===Fd&&(Fd=9729),void 0===Fe&&(Fe=9729),void 0===Ff&&(Ff=!0),!Fa||Fa.byteLength<Fb*Fc*4)throw"DataTexture2D create error";var Fh=new Fv;return Fh.uri=Fg,Fh._buffer=Fa,Fh._width=Fb,Fh._height=Fc,Fh._mipmap=Ff,Fh._magFifter=Fd,Fh._minFifter=Fe,Fh._size=new Frb(Fh._width,Fh._height),Fh._conchTexture?alert("怎么给runtime传递datatexture数据"):Fh.activeResource(),Fh},Fv.load=function(Fa,Fb,Fc,Fd,Fe){if(void 0===Fb&&(Fb=0),void 0===Fc&&(Fc=0),void 0===Fd&&(Fd=9729),void 0===Fe&&(Fe=9729),"mipmaps"===FC.getFileExtension(Fa)){var Ff=Fx.loader.create(Fa,null,null,Fv,[function(Fa){this._mipmaps=[];var Fb=new Uint32Array(Fa);this._width=Fb[0];var Fc=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,Fc=1024),this._width!=Fc)throw"现在只支持512x256的环境贴图。当前的是"+Fb[0];this._height=Fb[1];for(var Fd=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,Fe=this._height,Ff=8;;){var Fg=Fd*Fe*4;if(Ff+Fg>Fa.byteLength)throw"load mipmaps data size error ";var Fh=new Uint8Array(Fa,Ff,Fg);if(this._mipmaps.push(Fh),Ff+=Fg,1==Fd&&1==Fe)break;(Fd/=2)<1&&(Fd=1),(Fe/=2)<1&&(Fe=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){Ff.simLodInfo=new Float32Array(40);for(var Fg=0;Fg<Ff.simLodInfo.length;)Ff.simLodInfo[Fg]=(Fv.simLodRect[Fg]+.5)/1024,Fg++,Ff.simLodInfo[Fg]=(Fv.simLodRect[Fg]+.5)/256,Fg++,Ff.simLodInfo[Fg]=Math.max(Fv.simLodRect[Fg]-1,.1)/1024,Fg++,Ff.simLodInfo[Fg]=Math.max(Fv.simLodRect[Fg]-1.5,.1)/256,Fg++}return Ff}if("number"==typeof Fb)return Fx.loader.create(Fa,null,null,Fv,[function(Fa){return this._width=Fb,this._height=Fc,this._buffer=Fa,null}]);if("function"==typeof Fb)return Fx.loader.create(Fa,null,null,Fv,[Fb]);throw new Error("unknown params.")},Fv.lodasatlas=!1,Fn(Fv,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),Fv}(),FQb=function(Fa){function Fb(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,Fb.__super.call(this)}Fp(Fb,"laya.d3.resource.models.PrimitiveMesh",FGb);var Fc=Fb.prototype;return Fx.imps(Fc,{"laya.d3.core.render.IRenderable":!0}),Fc._getVertexBuffer=function(Fa){return void 0===Fa&&(Fa=0),0===Fa?this._vertexBuffer:null},Fc._getVertexBuffers=function(){return null},Fc._getIndexBuffer=function(){return this._indexBuffer},Fc._getPositions=function(){var Fa,Fb=[],Fc=this._vertexBuffer.vertexDeclaration.getVertexElements(),Fd=0;for(Fd=0;Fd<Fc.length;Fd++){var Fe=Fc[Fd];if("vector3"===Fe.elementFormat&&0===Fe.elementUsage){Fa=Fe;break}}var Ff=this._vertexBuffer.getData();for(Fd=0;Fd<Ff.length;Fd+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var Fg=Fd+Fa.offset/4,Fh=new Fgb(Ff[Fg+0],Ff[Fg+1],Ff[Fg+2]);Fb.push(Fh)}return Fb},Fc.getRenderElement=function(Fa){return this},Fc.getRenderElementsCount=function(){return 1},Fc.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},Fc._beforeRender=function(Fa){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Fc._render=function(Fa){FF.mainContext.drawElements(4,this._numberIndices,5123,0),FA.drawCall++,FA.trianglesFaces+=this._numberIndices/3},Fq(0,Fc,"_vertexBufferCount",function(){return 1}),Fq(0,Fc,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Fb}(),FRb=function(Fa){function Fb(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,Fb.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}Fp(Fb,"laya.d3.resource.models.Mesh",FGb);var Fc=Fb.prototype;return Fc._getPositions=function(){var Fa,Fb,Fc,Fd,Fe,Ff=[],Fg=0,Fh=0,Fi=0;if(0!==this._vertexBuffers.length){var Fj=this._vertexBuffers.length;for(Fg=0;Fg<Fj;Fg++){for(Fc=(Fa=this._vertexBuffers[Fg]).vertexDeclaration.getVertexElements(),Fh=0;Fh<Fc.length;Fh++)if("vector3"===(Fd=Fc[Fh]).elementFormat&&0===Fd.elementUsage){Fb=Fd;break}for(Fe=Fa.getData(),Fh=0;Fh<Fe.length;Fh+=Fa.vertexDeclaration.vertexStride/4)Fi=Fh+Fb.offset/4,Ff.push(new Fgb(Fe[Fi+0],Fe[Fi+1],Fe[Fi+2]))}}else{var Fm=this._subMeshes.length;for(Fg=0;Fg<Fm;Fg++){for(Fc=(Fa=this._subMeshes[Fg]._getVertexBuffer()).vertexDeclaration.getVertexElements(),Fh=0;Fh<Fc.length;Fh++)if("vector3"===(Fd=Fc[Fh]).elementFormat&&0===Fd.elementUsage){Fb=Fd;break}for(Fe=Fa.getData(),Fh=0;Fh<Fe.length;Fh+=Fa.vertexDeclaration.vertexStride/4)Fi=Fh+Fb.offset/4,Ff.push(new Fgb(Fe[Fi+0],Fe[Fi+1],Fe[Fi+2]))}}return Ff},Fc._setSubMeshes=function(Fa){this._subMeshes=Fa,this._subMeshCount=Fa.length;for(var Fb=0;Fb<this._subMeshCount;Fb++)Fa[Fb]._indexInMesh=Fb;this._positions=this._getPositions(),this._generateBoundingObject()},Fc.onAsynLoaded=function(Fa,Fb,Fc){var Fd=Fb[0],Fe=Fb[1];FYa.read(Fd,this,this._materials,this._subMeshes,Fe),this.completeCreate(),this._endLoaded()},Fc.getSubMesh=function(Fa){return this._subMeshes[Fa]},Fc.getSubMeshCount=function(){return this._subMeshes.length},Fc.getRenderElementsCount=function(){return this._subMeshes.length},Fc.getRenderElement=function(Fa){return this._subMeshes[Fa]},Fc.disposeResource=function(){for(var Fa=0;Fa<this._subMeshes.length;Fa++)this._subMeshes[Fa].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},Fq(0,Fc,"materials",function(){return this._materials.slice()}),Fq(0,Fc,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),Fb.load=function(Fa){return Fx.loader.create(Fa,null,null,Fb)},Fb}(),FSb=(function(Fa){function Fj(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===Fc&&(Fc=6408),void 0===Fd&&(Fd=5121),void 0===Fe&&(Fe=33189),void 0===Ff&&(Ff=!1),void 0===Fg&&(Fg=!1),void 0===Fh&&(Fh=-1),void 0===Fi&&(Fi=-1),Fj.__super.call(this),this._type=3553,this._width=Fa,this._height=Fb,this._size=new Frb(Fa,Fb),this._surfaceFormat=Fc,this._surfaceType=Fd,this._depthStencilFormat=Fe,Fr.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=Ff,this._repeat=Fg,this._minFifter=Fh,this._magFifter=Fi,this.activeResource(),this._alreadyResolved=!0}Fp(Fj,"laya.d3.resource.RenderTexture",FFb);var Fb=Fj.prototype;Fb.recreateResource=function(){var Fa=FF.mainContext;this._frameBuffer=Fa.createFramebuffer(),this._source=Fa.createTexture();var Fb=FG.curBindTexTarget,Fc=FG.curBindTexValue;FG.bindTexture(Fa,this._type,this._source),Fa.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var Fd=this._minFifter,Fe=this._magFifter,Ff=this._repeat?10497:33071;if(Fw.isPOT(this._width,this._height)?(this._mipmap?-1!==Fd||(Fd=9987):-1!==Fd||(Fd=9729),-1!==Fe||(Fe=9729),Fa.texParameteri(this._type,10241,Fd),Fa.texParameteri(this._type,10240,Fe),Fa.texParameteri(this._type,10242,Ff),Fa.texParameteri(this._type,10243,Ff),this._mipmap&&Fa.generateMipmap(this._type)):(-1!==Fd||(Fd=9729),-1!==Fe||(Fe=9729),Fa.texParameteri(this._type,10241,Fd),Fa.texParameteri(this._type,10240,Fe),Fa.texParameteri(this._type,10242,33071),Fa.texParameteri(this._type,10243,33071)),Fb&&Fc&&FG.bindTexture(Fa,Fb,Fc),Fa.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=Fa.createRenderbuffer(),Fa.bindRenderbuffer(36161,this._depthStencilBuffer),Fa.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),Fa.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:Fa.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Fa.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Fa.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Fa.framebufferTexture2D(36160,36064,3553,this._source,0),Fa.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},Fb.start=function(){FF.mainContext.bindFramebuffer(36160,this.frameBuffer),(Fj._currentRenderTarget=this)._alreadyResolved=!1},Fb.end=function(){FF.mainContext.bindFramebuffer(36160,null),Fj._currentRenderTarget=null,this._alreadyResolved=!0},Fb.getData=function(Fa,Fb,Fc,Fd){var Fe=FF.mainContext;if(Fe.bindFramebuffer(36160,this._frameBuffer),!(36053===Fe.checkFramebufferStatus(36160)))return Fe.bindFramebuffer(36160,null),null;var Ff=new Uint8Array(this._width*this._height*4);return Fe.readPixels(Fa,Fb,Fc,Fd,this._surfaceFormat,this._surfaceType,Ff),Fe.bindFramebuffer(36160,null),Ff},Fb.disposeResource=function(){if(this._frameBuffer){var Fa=FF.mainContext;Fa.deleteTexture(this._source),Fa.deleteFramebuffer(this._frameBuffer),Fa.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},Fq(0,Fb,"surfaceFormat",function(){return this._surfaceFormat}),Fq(0,Fb,"surfaceType",function(){return this._surfaceType}),Fq(0,Fb,"depthStencilFormat",function(){return this._depthStencilFormat}),Fq(0,Fb,"source",function(){return this._alreadyResolved?Fx.superGet(FFb,this,"source"):null}),Fq(0,Fb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Fq(0,Fb,"frameBuffer",function(){return this._frameBuffer}),Fj._currentRenderTarget=null}(),function(Fa){function Fb(Fa){this._color=null,this._pixels=null,Fb.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new Frb(this.width,this.height),this._color=Fa,this._pixels=new Uint8Array([255*Fa.x,255*Fa.y,255*Fa.z,255*Fa.w]),this.uri="SolidColorTexture2D_"+this.id}Fp(Fb,"laya.d3.resource.SolidColorTexture2D",FFb);var Fc=Fb.prototype;return Fc._createWebGlTexture=function(){var Fa=FF.mainContext,Fb=this._source=Fa.createTexture(),Fc=this._width,Fd=this._height,Fe=FG.curBindTexTarget,Ff=FG.curBindTexValue;FG.bindTexture(Fa,this._type,Fb),Fa.texImage2D(this._type,0,6408,Fc,Fd,0,6408,5121,this._pixels);var Fg=this._minFifter,Fh=this._magFifter,Fi=this._repeat?10497:33071,Fj=Fw.isPOT(Fc,Fd);Fj?(this._mipmap?-1!==Fg||(Fg=9987):-1!==Fg||(Fg=9729),-1!==Fh||(Fh=9729),Fa.texParameteri(this._type,10241,Fg),Fa.texParameteri(this._type,10240,Fh),Fa.texParameteri(this._type,10242,Fi),Fa.texParameteri(this._type,10243,Fi),this._mipmap&&Fa.generateMipmap(this._type)):(-1!==Fg||(Fg=9729),-1!==Fh||(Fh=9729),Fa.texParameteri(this._type,10241,Fg),Fa.texParameteri(this._type,10240,Fh),Fa.texParameteri(this._type,10242,33071),Fa.texParameteri(this._type,10243,33071)),Fe&&Ff&&FG.bindTexture(Fa,Fe,Ff),this.memorySize=Fj?Fc*Fd*4*(1+1/3):Fc*Fd*4},Fc.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Fc.disposeResource=function(){this._source&&(FF.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Fn(Fb,["magentaTexture",function(){var Fa=new Fb(new Fhb(1,0,1,1));return Fa.lock=!0,this.magentaTexture=Fa},"grayTexture",function(){var Fa=new Fb(new Fhb(.5,.5,.5,1));return Fa.lock=!0,this.grayTexture=Fa}]),Fb}()),FTb=function(Fa){function Fe(Fa,Fb,Fc,Fd){this._canRead=!1,this._image=null,this._pixels=null,void 0===Fa&&(Fa=!1),void 0===Fb&&(Fb=!0),void 0===Fc&&(Fc=6408),void 0===Fd&&(Fd=!0),Fe.__super.call(this),this._type=3553,this._repeat=Fb,this._canRead=Fa,this._format=Fc,this._mipmap=Fd}Fp(Fe,"laya.d3.resource.Texture2D",FFb);var Fb=Fe.prototype;return Fb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Fa=FF.mainContext,Fb=this._source=Fa.createTexture(),Fc=this._width,Fd=this._height,Fe=FG.curBindTexTarget,Ff=FG.curBindTexValue;switch(FG.bindTexture(Fa,this._type,Fb),this._format){case 6407:case 6408:this._canRead?Fa.texImage2D(this._type,0,this._format,Fc,Fd,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?Fa.texImage2D(this._type,0,this._image._format,Fc,Fd,0,this._image._format,5121,this._image.atlasSource):Fa.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case FF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Fa.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var Fg=this._minFifter,Fh=this._magFifter,Fi=this._repeat?10497:33071,Fj=0==this._wrapModeU?10497:33071,Fm=0==this._wrapModeV?10497:33071,Fn=Fw.isPOT(Fc,Fd);Fn?(this._mipmap?-1!==Fg||(Fg=9987):-1!==Fg||(Fg=9729),-1!==Fh||(Fh=9729),Fa.texParameteri(this._type,10241,Fg),Fa.texParameteri(this._type,10240,Fh),Fa.texParameteri(this._type,10242,Fi),Fa.texParameteri(this._type,10243,Fi),Fa.texParameteri(this._type,10242,Fj),Fa.texParameteri(this._type,10243,Fm),this._mipmap&&Fa.generateMipmap(this._type)):(-1!==Fg||(Fg=9729),-1!==Fh||(Fh=9729),Fa.texParameteri(this._type,10241,Fg),Fa.texParameteri(this._type,10240,Fh),Fa.texParameteri(this._type,10242,33071),Fa.texParameteri(this._type,10243,33071)),Fe&&Ff&&FG.bindTexture(Fa,Fe,Ff),this._image.onload=null,this._image=null,this.memorySize=Fn?Fc*Fd*4*(1+1/3):Fc*Fd*4},Fb.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Fb.onAsynLoaded=function(Fa,Fb,Fc){if(Fc){var Fd=Fc[0];void 0!==Fd&&(this._canRead=Fd);var Fe=Fc[1];void 0!==Fe&&(this._repeat=Fe);var Ff=Fc[2];void 0!==Ff&&(this._format=Ff);var Fg=Fc[3];void 0!==Fg&&(this._mipmap=Fg);var Fh=Fc.wrapModeU;void 0!==Fh&&(this._wrapModeU=Fh);var Fi=Fc.wrapModeV;void 0!==Fi&&(this._wrapModeV=Fi)}switch(this._format){case 6407:case 6408:var Fj=(this._image=Fb).width,Fm=Fb.height;this._width=Fj,this._height=Fm,this._size=new Frb(Fj,Fm),this._canRead&&(Fr.isConchApp?Fb instanceof Fo.HTMLElement&&(this._pixels=new Uint8Array(Fb.getImageData(0,0,Fj,Fm))):(FH.canvas.size(Fj,Fm),FH.canvas.clear(),FH.context.drawImage(Fb,0,0,Fj,Fm),this._pixels=new Uint8Array(FH.context.getImageData(0,0,Fj,Fm).data.buffer)));break;case FF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var Fn=new Fy(Fb);Fn.readUTFBytes(4),Fn.readUTFBytes(2),Fn.getInt16();Fn.endian="bigEndian",this._width=Fn.getInt16(),this._height=Fn.getInt16(),this._size=new Frb(this._width,this._height);Fn.getInt16(),Fn.getInt16();this._image=new Uint8Array(Fb,Fn.pos)}this.recreateResource(),this._endLoaded()},Fb.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},Fb.disposeResource=function(){this._source&&(FF.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},Fq(0,Fb,"_src",function(){return this.url}),Fq(0,Fb,"src",function(){return this.url}),Fe.load=function(Fa){return Fx.loader.create(Fa,null,null,Fe)},Fe}(),FUb=function(Fb){function Fc(Fa,Fb){Fc.__super.call(this),void 0===Fa&&(Fa=.3),void 0===Fb&&(Fb=1e3),this._tempVector3=new Fgb,this._position=new Fgb,this._up=new Fgb,this._forward=new Fgb,this._right=new Fgb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=Frb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=Fa,this._farPlane=Fb,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),Fx.stage.on("resize",this,this._onScreenSizeChanged)}Fp(Fc,"laya.d3.core.BaseCamera",Fb);var Fa=Fc.prototype;return Fa._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var Fa=this.scene._cameraPool,Fb=Fa.length-1,Fc=0;Fc<Fb;Fc++)if(Fa[Fc].renderingOrder>Fa[Fb].renderingOrder){var Fd=Fa[Fc];Fa[Fc]=Fa[Fb],Fa[Fb]=Fd}},Fa._calculateProjectionMatrix=function(){},Fa._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},Fa._prepareCameraToRender=function(){FI._currentCameraCullingMask=this.cullingMask;var Fa=this._shaderValues;Fa.setValue(0,this.transform.position.elements),Fa.setValue(5,this.forward.elements),Fa.setValue(6,this.up.elements)},Fa._prepareCameraViewProject=function(Fa,Fb){var Fc=this._shaderValues;Fc.setValue(1,Fa.elements),Fc.setValue(2,Fb.elements)},Fa._renderCamera=function(Fa,Fb,Fc){},Fa.addLayer=function(Fa){29!==Fa.number&&30!=Fa.number&&(this.cullingMask=this.cullingMask|Fa.mask)},Fa.removeLayer=function(Fa){29!==Fa.number&&30!=Fa.number&&(this.cullingMask=this.cullingMask&~Fa.mask)},Fa.addAllLayers=function(){this.cullingMask=2147483647},Fa.removeAllLayers=function(){this.cullingMask=0|FI.getLayerByNumber(29).mask|FI.getLayerByNumber(30).mask},Fa.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},Fa.moveForward=function(Fa){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=Fa,this.transform.translate(this._tempVector3)},Fa.moveRight=function(Fa){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=Fa,this.transform.translate(this._tempVector3)},Fa.moveVertical=function(Fa){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=Fa,this.transform.translate(this._tempVector3,!1)},Fa._addSelfRenderObjects=function(){var Fa=this.scene._cameraPool,Fb=Fa.length;if(0<Fb){for(var Fc=Fb-1;0<=Fc;Fc--)if(this.renderingOrder<=Fa[Fc].renderingOrder){Fa.splice(Fc+1,0,this);break}}else Fa.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},Fa._clearSelfRenderObjects=function(){var Fa=this.scene._cameraPool;Fa.splice(Fa.indexOf(this),1)},Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,Fx.stage.off("resize",this,this._onScreenSizeChanged),Fb.prototype.destroy.call(this,Fa)},Fq(0,Fa,"sky",function(){return this._sky},function(Fa){(this._sky=Fa)._ownerCamera=this}),Fq(0,Fa,"forward",function(){var Fa=this.transform.worldMatrix.elements,Fb=this._forward.elements;return Fb[0]=-Fa[8],Fb[1]=-Fa[9],Fb[2]=-Fa[10],this._forward}),Fq(0,Fa,"position",function(){var Fa=this.transform.worldMatrix.elements,Fb=this._position.elements;return Fb[0]=Fa[12],Fb[1]=Fa[13],Fb[2]=Fa[14],this._position}),Fq(0,Fa,"renderTarget",function(){return this._renderTarget},function(Fa){null!=(this._renderTarget=Fa)&&(this._renderTargetSize=Fa.size)}),Fq(0,Fa,"up",function(){var Fa=this.transform.worldMatrix.elements,Fb=this._up.elements;return Fb[0]=Fa[4],Fb[1]=Fa[5],Fb[2]=Fa[6],this._up}),Fq(0,Fa,"right",function(){var Fa=this.transform.worldMatrix.elements,Fb=this._right.elements;return Fb[0]=Fa[0],Fb[1]=Fa[1],Fb[2]=Fa[2],this._right}),Fq(0,Fa,"renderTargetSize",function(){return this._renderTargetSize},function(Fa){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=Fa,this._calculateProjectionMatrix()}),Fq(0,Fa,"fieldOfView",function(){return this._fieldOfView},function(Fa){this._fieldOfView=Fa,this._calculateProjectionMatrix()}),Fq(0,Fa,"nearPlane",function(){return this._nearPlane},function(Fa){this._nearPlane=Fa,this._calculateProjectionMatrix()}),Fq(0,Fa,"farPlane",function(){return this._farPlane},function(Fa){this._farPlane=Fa,this._calculateProjectionMatrix()}),Fq(0,Fa,"orthographic",function(){return this._orthographic},function(Fa){this._orthographic=Fa,this._calculateProjectionMatrix()}),Fq(0,Fa,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(Fa){this._orthographicVerticalSize=Fa,this._calculateProjectionMatrix()}),Fq(0,Fa,"renderingOrder",function(){return this._renderingOrder},function(Fa){this._renderingOrder=Fa,this._sortCamerasByRenderingOrder()}),Fc.CAMERAPOS=0,Fc.VIEWMATRIX=1,Fc.PROJECTMATRIX=2,Fc.VPMATRIX=3,Fc.VPMATRIX_NO_TRANSLATE=4,Fc.CAMERADIRECTION=5,Fc.CAMERAUP=6,Fc.ENVIRONMENTDIFFUSE=7,Fc.ENVIRONMENTSPECULAR=8,Fc.SIMLODINFO=9,Fc.DIFFUSEIRRADMATR=10,Fc.DIFFUSEIRRADMATG=11,Fc.DIFFUSEIRRADMATB=12,Fc.HDREXPOSURE=13,Fc.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",Fc.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",Fc.CLEARFLAG_SOLIDCOLOR=0,Fc.CLEARFLAG_SKY=1,Fc.CLEARFLAG_DEPTHONLY=2,Fc.CLEARFLAG_NONE=3,Fn(Fc,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new Fab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new Fab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new Fab}]),Fc}(FKb),FVb=function(Fc){function Fb(Fa){this._render=null,this._geometryFilter=null,Fb.__super.call(this,Fa)}Fp(Fb,"laya.d3.core.RenderableSprite3D",Fc);var Fa=Fb.prototype;return Fa._addToInitStaticBatchManager=function(){},Fa._setBelongScene=function(Fa){Fc.prototype._setBelongScene.call(this,Fa),Fa._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},Fa._setUnBelongScene=function(){var Fa=this._scene._renderableSprite3Ds,Fb=Fa.indexOf(this);Fa.splice(Fb,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),Fc.prototype._setUnBelongScene.call(this)},Fa._update=function(Fa){(Fa.owner=this)._activeInHierarchy&&(this._updateComponents(Fa),this._render._updateOctreeNode(),this._lateUpdateComponents(Fa),FA.spriteCount++,this._childs.length&&this._updateChilds(Fa))},Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fc.prototype.destroy.call(this,Fa),this._render._destroy(),this._render=null},Fb.__init__=function(){Fb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=Fb.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),Fb.SAHDERDEFINE_LIGHTMAP=Fb.shaderDefines.registerDefine("LIGHTMAP")},Fb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,Fb.SAHDERDEFINE_LIGHTMAP=4,Fb.LIGHTMAPSCALEOFFSET=2,Fb.LIGHTMAP=3,Fn(Fb,["shaderDefines",function(){return this.shaderDefines=new Fmb}]),Fb}(FKb),FWb=(function(Fa){function Fd(Fa,Fb,Fc){this._long=NaN,this._width=NaN,this._height=NaN,void 0===Fa&&(Fa=1),void 0===Fb&&(Fb=1),void 0===Fc&&(Fc=1),Fd.__super.call(this),this._long=Fa,this._width=Fb,this._height=Fc,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Fp(Fd,"laya.d3.resource.models.BoxMesh",FQb);var Fb=Fd.prototype;Fb.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var Fa=FFa.vertexDeclaration,Fb=(Fa.vertexStride,this._long/2),Fc=this._height/2,Fd=this._width/2,Fe=new Float32Array([-Fb,Fc,-Fd,0,1,0,0,0,Fb,Fc,-Fd,0,1,0,1,0,Fb,Fc,Fd,0,1,0,1,1,-Fb,Fc,Fd,0,1,0,0,1,-Fb,-Fc,-Fd,0,-1,0,0,1,Fb,-Fc,-Fd,0,-1,0,1,1,Fb,-Fc,Fd,0,-1,0,1,0,-Fb,-Fc,Fd,0,-1,0,0,0,-Fb,Fc,-Fd,-1,0,0,0,0,-Fb,Fc,Fd,-1,0,0,1,0,-Fb,-Fc,Fd,-1,0,0,1,1,-Fb,-Fc,-Fd,-1,0,0,0,1,Fb,Fc,-Fd,1,0,0,1,0,Fb,Fc,Fd,1,0,0,0,0,Fb,-Fc,Fd,1,0,0,0,1,Fb,-Fc,-Fd,1,0,0,1,1,-Fb,Fc,Fd,0,0,1,0,0,Fb,Fc,Fd,0,0,1,1,0,Fb,-Fc,Fd,0,0,1,1,1,-Fb,-Fc,Fd,0,0,1,0,1,-Fb,Fc,-Fd,0,0,-1,1,0,Fb,Fc,-Fd,0,0,-1,0,0,Fb,-Fc,-Fd,0,0,-1,0,1,-Fb,-Fc,-Fd,0,0,-1,1,1]),Ff=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new FOb(Fa,this._numberVertices,35044,!0),this._indexBuffer=new FNb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(Fe),this._indexBuffer.setData(Ff),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},Fq(0,Fb,"long",function(){return this._long},function(Fa){this._long!==Fa&&(this._long=Fa,this.releaseResource(),this.activeResource())}),Fq(0,Fb,"width",function(){return this._width},function(Fa){this._width!==Fa&&(this._width=Fa,this.releaseResource(),this.activeResource())}),Fq(0,Fb,"height",function(){return this._height},function(Fa){this._height!==Fa&&(this._height=Fa,this.releaseResource(),this.activeResource())})}(),function(Fa){function Fg(Fa,Fb,Fc){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=.3),void 0===Fc&&(Fc=1e3),this._viewMatrix=new Fab,this._projectionMatrix=new Fab,this._projectionViewMatrix=new Fab,this._viewport=new Fib(0,0,0,0),this._normalizedViewport=new Fib(0,0,1,1),this._aspectRatio=Fa,this._boundFrustumUpdate=!0,this._boundFrustum=new F$a(Fab.DEFAULT),Fg.__super.call(this,Fb,Fc),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}Fp(Fg,"laya.d3.core.Camera",FUb);var Fb=Fg.prototype;return Fb._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},Fb._parseCustomProps=function(Fa,Fb,Fc,Fd){var Fe=Fc.clearColor;this.clearColor=new Fhb(Fe[0],Fe[1],Fe[2],Fe[3]);var Ff=Fc.viewport;this.normalizedViewport=new Fib(Ff[0],Ff[1],Ff[2],Ff[3])},Fb._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var Fa=this.orthographicVerticalSize*this.aspectRatio*.5,Fb=.5*this.orthographicVerticalSize;Fab.createOrthoOffCenterRH(-Fa,Fa,-Fb,Fb,this.nearPlane,this.farPlane,this._projectionMatrix)}else Fab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},Fb._update=function(Fa){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,Fa)},Fb._renderCamera=function(Fa,Fb,Fc){var Fd,Fe;Fc.parallelSplitShadowMaps[0]&&Fc._renderShadowMap(Fa,Fb,this),(Fb.camera=this)._prepareCameraToRender(),Fc._preRenderUpdateComponents(Fb),Fd=Fb._viewMatrix=this.viewMatrix;var Ff=this._renderTarget;Ff?(Ff.start(),Fab.multiply(FUb._invertYScaleMatrix,this._projectionMatrix,FUb._invertYProjectionMatrix),Fab.multiply(FUb._invertYScaleMatrix,this.projectionViewMatrix,FUb._invertYProjectionViewMatrix),Fe=Fb._projectionMatrix=FUb._invertYProjectionMatrix,Fb._projectionViewMatrix=FUb._invertYProjectionViewMatrix):(Fe=Fb._projectionMatrix=this._projectionMatrix,Fb._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(Fd,Fe),Fb._viewport=this.viewport,Fc._preRenderScene(Fa,Fb,this.boundFrustum),Fc._clear(Fa,Fb),Fc._renderScene(Fa,Fb),Fc._postRenderUpdateComponents(Fb),Ff&&Ff.end()},Fb.viewportPointToRay=function(Fa,Fb){Fqb.calculateCursorRay(Fa,this.viewport,this._projectionMatrix,this.viewMatrix,null,Fb)},Fb.normalizedViewportPointToRay=function(Fa,Fb){var Fc=Fg._tempVector20,Fd=this.viewport,Fe=Fa.elements,Ff=Fc.elements;Ff[0]=Fe[0]*Fd.width,Ff[1]=Fe[1]*Fd.height,Fqb.calculateCursorRay(Fc,this.viewport,this._projectionMatrix,this.viewMatrix,null,Fb)},Fb.worldToViewportPoint=function(Fa,Fb){Fab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(Fa,this._projectionViewMatrix,Fb);var Fc=Fb.elements;Fc[0]=Fc[0]/Fx.stage.clientScaleX,Fc[1]=Fc[1]/Fx.stage.clientScaleY},Fb.worldToNormalizedViewportPoint=function(Fa,Fb){Fab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(Fa,this._projectionViewMatrix,Fb);var Fc=Fb.elements;Fc[0]=Fc[0]/Fx.stage.clientScaleX,Fc[1]=Fc[1]/Fx.stage.clientScaleY},Fb.convertScreenCoordToOrthographicCoord=function(Fa,Fb){if(this._orthographic){var Fc=FY.clientWidth,Fd=FY.clientHeight,Fe=this.orthographicVerticalSize*this.aspectRatio/Fc,Ff=this.orthographicVerticalSize/Fd,Fg=Fa.elements,Fh=Fb.elements;return Fh[0]=(-Fc/2+Fg[0])*Fe,Fh[1]=(Fd/2-Fg[1])*Ff,Fh[2]=(this.nearPlane-this.farPlane)*(Fg[2]+1)/2-this.nearPlane,Fgb.transformCoordinate(Fb,this.transform.worldMatrix,Fb),!0}return!1},Fq(0,Fb,"projectionViewMatrix",function(){return Fab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),Fq(0,Fb,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var Fa=this.viewport;return Fa.width/Fa.height},function(Fa){if(Fa<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=Fa,this._calculateProjectionMatrix()}),Fq(0,Fb,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),Fq(0,Fb,"needViewport",function(){var Fa=this.normalizedViewport;return 0===Fa.x&&0===Fa.y&&1===Fa.width&&1===Fa.height}),Fq(0,Fb,"viewport",function(){if(this._viewportExpressedInClipSpace){var Fa=this._normalizedViewport,Fb=this.renderTargetSize,Fc=Fb.width,Fd=Fb.height;this._viewport.x=Fa.x*Fc,this._viewport.y=Fa.y*Fd,this._viewport.width=Fa.width*Fc,this._viewport.height=Fa.height*Fd}return this._viewport},function(Fa){if(null!=this.renderTarget&&(Fa.x<0||Fa.y<0||0==Fa.width||0==Fa.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=Fa,this._calculateProjectionMatrix()}),Fq(0,Fb,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var Fa=this._viewport,Fb=this.renderTargetSize,Fc=Fb.width,Fd=Fb.height;this._normalizedViewport.x=Fa.x/Fc,this._normalizedViewport.y=Fa.y/Fd,this._normalizedViewport.width=Fa.width/Fc,this._normalizedViewport.height=Fa.height/Fd}return this._normalizedViewport},function(Fa){Fa.x<0&&(Fa.x=0,console.warn("Camera: viewport.x must large than 0.0.")),Fa.y<0&&(Fa.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<Fa.x+Fa.width&&(Fa.width=1-Fa.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<Fa.y+Fa.height&&(Fa.height=1-Fa.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=Fa,this._calculateProjectionMatrix()}),Fq(0,Fb,"projectionMatrix",function(){return this._projectionMatrix},function(Fa){this._projectionMatrix=Fa,this._useUserProjectionMatrix=!0}),Fq(0,Fb,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),Fn(Fg,["_tempVector20",function(){return this._tempVector20=new Ffb}]),Fg}()),FXb=function(Fc){function Fd(Fa,Fb){Fd.__super.call(this,Fb),this._geometryFilter=new FHb(this),this._render=new FIb(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),Fa&&(this._geometryFilter.sharedMesh=Fa)instanceof laya.d3.resource.models.Mesh&&(Fa.loaded?this._render.sharedMaterials=Fa.materials:Fa.once("loaded",this,this._applyMeshMaterials))}Fp(Fd,"laya.d3.core.MeshSprite3D",Fc);var Fa=Fd.prototype;return Fa._changeRenderObjectByMesh=function(Fa){var Fb=this._render._renderElements,Fc=Fb[Fa];Fc||(Fc=Fb[Fa]=new Fzb),Fc._render=this._render;var Fd=this._render.sharedMaterials[Fa];Fd||(Fd=FMb.defaultMaterial);var Fe=this._geometryFilter.sharedMesh.getRenderElement(Fa);return Fc._mainSortID=this._getSortID(Fe,Fd),Fc._sprite3D=this,Fc.renderObj=Fe,Fc._material=Fd,Fc},Fa._changeRenderObjectByMaterial=function(Fa,Fb){var Fc=this._render._renderElements[Fa];Fb||(Fb=FMb.defaultMaterial);var Fd=this._geometryFilter.sharedMesh.getRenderElement(Fa);return Fc._mainSortID=this._getSortID(Fd,Fb),Fc._sprite3D=this,Fc.renderObj=Fd,Fc._material=Fb,Fc},Fa._changeRenderObjectsByMesh=function(){var Fa=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=Fa;for(var Fb=0;Fb<Fa;Fb++)this._changeRenderObjectByMesh(Fb)},Fa._onMeshChanged=function(Fa){var Fb=Fa.sharedMesh;Fb.loaded?this._changeRenderObjectsByMesh():Fb.once("loaded",this,this._onMeshLoaded)},Fa._onMeshLoaded=function(Fa){Fa===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},Fa._onMaterialChanged=function(Fa,Fb,Fc){Fb<this._render._renderElements.length&&this._changeRenderObjectByMaterial(Fb,Fc)},Fa._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},Fa._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},Fa._parseCustomProps=function(Fa,Fb,Fc,Fd){var Fe=this.meshRender,Ff=Fc.lightmapIndex;null!=Ff&&(Fe.lightmapIndex=Ff);var Fg,Fh,Fi=Fc.lightmapScaleOffset;if(Fi&&(Fe.lightmapScaleOffset=new Fhb(Fi[0],Fi[1],Fi[2],Fi[3])),Fd.instanceParams)(Fg=Fd.instanceParams.loadPath)&&(Fh=Ft.getRes(Fb[Fg]),(this.meshFilter.sharedMesh=Fh).loaded?Fe.sharedMaterials=Fh.materials:Fh.once("loaded",this,this._applyMeshMaterials));else{(Fg=Fc.meshPath)&&(Fh=Ft.getRes(Fb[Fg]),this.meshFilter.sharedMesh=Fh);var Fj=Fc.materials;if(Fj){var Fm=Fe.sharedMaterials,Fn=Fj.length;Fm.length=Fn;for(var Fo=0;Fo<Fn;Fo++)Fm[Fo]=Ft.getRes(Fb[Fj[Fo].path]);Fe.sharedMaterials=Fm}}},Fa._applyMeshMaterials=function(Fa){for(var Fb=this._render.sharedMaterials,Fc=Fa.materials,Fd=0,Fe=Fc.length;Fd<Fe;Fd++)Fb[Fd]||(Fb[Fd]=Fc[Fd]);this._render.sharedMaterials=Fb},Fa._addToInitStaticBatchManager=function(){Fd._staticBatchManager._addInitBatchSprite(this)},Fa.cloneTo=function(Fa){var Fb=Fa;Fb._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var Fc=this._render,Fd=Fb._render;Fd.enable=Fc.enable,Fd.sharedMaterials=Fc.sharedMaterials,Fd.castShadow=Fc.castShadow;var Fe=Fc.lightmapScaleOffset;Fe&&(Fd.lightmapScaleOffset=Fe.clone()),Fd.lightmapIndex=Fc.lightmapIndex,Fd.receiveShadow=Fc.receiveShadow,Fd.sortingFudge=Fc.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,Fa)},Fa.destroy=function(Fa){if(void 0===Fa&&(Fa=!0),!this.destroyed){var Fb=this.meshFilter.sharedMesh;null!=Fb&&(Fb.loaded||Fb.off("loaded",this,this._applyMeshMaterials)),Fc.prototype.destroy.call(this,Fa),this._geometryFilter._destroy()}},Fq(0,Fa,"meshFilter",function(){return this._geometryFilter}),Fq(0,Fa,"meshRender",function(){return this._render}),Fd.__init__=function(){Fda._staticBatchManagers.push(Fd._staticBatchManager)},Fd.load=function(Fa){return Fx.loader.create(Fa,null,null,Fd)},Fn(Fd,["_staticBatchManager",function(){return this._staticBatchManager=new FBb}]),Fd}(FVb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Fa,Fb){"use strict";for(var Fc in Object.defineProperty(Fb,"__esModule",{value:!0}),Laya){var Fd=Laya[Fc];Fd&&Fd.__isclass&&(Fb[Fc]=Fd)}}),function(Fa,Fb,Fea){Fea.un,Fea.uns;var Fc=Fea.static,Fd=Fea.class,Ff=Fea.getset,Fr=Fea.__newvec,Fh=laya.maths.Bezier,Fn=laya.utils.Browser,FFa=laya.utils.Byte,Fe=(laya.events.Event,laya.events.EventDispatcher),Fg=laya.display.Graphics,Fi=(laya.resource.HTMLCanvas,laya.utils.Handler),Fj=laya.net.Loader,Fo=laya.maths.MathUtil,FGa=laya.maths.Matrix,Fs=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),Fm=(laya.renders.RenderContext,laya.resource.Resource),Fp=laya.utils.RunDriver,Ffa=laya.display.Sprite,Fq=laya.utils.Stat,FHa=laya.resource.Texture,Ft=(laya.net.URL,laya.utils.Utils),FG=function(){function Fa(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return Fd(Fa,"laya.ani.AnimationContent"),Fa}(),FH=function(){function Fa(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return Fd(Fa,"laya.ani.AnimationNodeContent"),Fa}(),Fv=function(){function Fa(){}return Fd(Fa,"laya.ani.AnimationParser01"),Fa.parse=function(Fa,Fb){var Fc=Fb.__getBuffer(),Fd=0,Fe=0,Ff=0,Fg=0,Fh=0,Fi=0,Fj=0,Fm=Fb.readUTFString();Fa._aniClassName=Fm;var Fn,Fo=Fb.readUTFString().split("\n"),Fp=Fb.getUint8(),Fq=Fb.getUint32(),Fr=Fb.getUint32();0<Fq&&(Fn=Fc.slice(Fq,Fr));var Fs=new FFa(Fn);for(0<Fr&&(Fa._publicExtData=Fc.slice(Fr,Fc.byteLength)),Fa._useParent=!!Fb.getUint8(),Fa._anis.length=Fp,Fd=0;Fd<Fp;Fd++){var Ft=Fa._anis[Fd]=new FG;Ft.nodes=new Array;var Fu=Ft.name=Fo[Fb.getUint16()];Fa._aniMap[Fu]=Fd,Ft.bone3DMap={},Ft.playTime=Fb.getFloat32(),Ft.playTime<=0&&console.error("播放时间不能为0  url="+Fa.url+" name="+Ft.name);var Fv=Ft.nodes.length=Fb.getUint8();for(Fe=Ft.totalKeyframeDatasLength=0;Fe<Fv;Fe++){var Fw=Ft.nodes[Fe]=new FH;Fw.childs=[];var Fx=Fb.getInt16();0<=Fx&&(Fw.name=Fo[Fx],Ft.bone3DMap[Fw.name]=Fe),Fw.keyFrame=new Array,Fw.parentIndex=Fb.getInt16(),-1==Fw.parentIndex?Fw.parent=null:Fw.parent=Ft.nodes[Fw.parentIndex],Fw.lerpType=Fb.getUint8();var Fy=Fb.getUint32();Fs.pos=Fy;var Fz=Fw.keyframeWidth=Fs.getUint16();if(Ft.totalKeyframeDatasLength+=Fz,0===Fw.lerpType||1===Fw.lerpType)for(Fw.interpolationMethod=[],Fw.interpolationMethod.length=Fz,Ff=0;Ff<Fz;Ff++)Fw.interpolationMethod[Ff]=FK.interpolation[Fs.getUint8()];null!=Fw.parent&&Fw.parent.childs.push(Fw);var FA=Fb.getUint16();0<FA&&(Fw.extenData=Fc.slice(Fb.pos,Fb.pos+FA),Fb.pos+=FA);var FB,FC=Fb.getUint16(),FD=0;for(Ff=0,Fg=Fw.keyFrame.length=FC;Ff<Fg;Ff++){if((FB=Fw.keyFrame[Ff]=new FI).duration=Fb.getFloat32(),FB.startTime=FD,2===Fw.lerpType){FB.interpolationData=[];var FE,FF=Fb.getUint8();switch(FE=Fb.getFloat32()){case 254:for(FB.interpolationData.length=Fz,Fj=0;Fj<Fz;Fj++)FB.interpolationData[Fj]=0;break;case 255:for(FB.interpolationData.length=Fz,Fj=0;Fj<Fz;Fj++)FB.interpolationData[Fj]=5;break;default:for(FB.interpolationData.push(FE),Fi=1;Fi<FF;Fi++)FB.interpolationData.push(Fb.getFloat32())}}for(FB.data=new Float32Array(Fz),Fh=0;Fh<Fz;Fh++)FB.data[Fh]=Fb.getFloat32(),-1e-8<FB.data[Fh]&&FB.data[Fh]<1e-8&&(FB.data[Fh]=0);FD+=FB.duration}FB.startTime=Ft.playTime,Fw.playTime=Ft.playTime,Fa._calculateKeyFrame(Fw,FC,Fz)}}},Fa}(),Fw=function(){function Fx(){}return Fd(Fx,"laya.ani.AnimationParser02"),Fx.READ_DATA=function(){Fx._DATA.offset=Fx._reader.getUint32(),Fx._DATA.size=Fx._reader.getUint32()},Fx.READ_BLOCK=function(){for(var Fa=Fx._BLOCK.count=Fx._reader.getUint16(),Fb=Fx._BLOCK.blockStarts=[],Fc=Fx._BLOCK.blockLengths=[],Fd=0;Fd<Fa;Fd++)Fb.push(Fx._reader.getUint32()),Fc.push(Fx._reader.getUint32())},Fx.READ_STRINGS=function(){var Fa=Fx._reader.getUint32(),Fb=Fx._reader.getUint16(),Fc=Fx._reader.pos;Fx._reader.pos=Fa+Fx._DATA.offset;for(var Fd=0;Fd<Fb;Fd++)Fx._strings[Fd]=Fx._reader.readUTFString();Fx._reader.pos=Fc},Fx.parse=function(Fa,Fb){Fx._templet=Fa;(Fx._reader=Fb).__getBuffer();Fx.READ_DATA(),Fx.READ_BLOCK(),Fx.READ_STRINGS();for(var Fc=0,Fd=Fx._BLOCK.count;Fc<Fd;Fc++){var Fe=Fb.getUint16(),Ff=Fx._strings[Fe],Fg=Fx["READ_"+Ff];if(null==Fg)throw new Error("model file err,no this function:"+Fe+" "+Ff);Fg.call()}},Fx.READ_ANIMATIONS=function(){var Fa=Fx._reader,Fb=Fa.__getBuffer(),Fc=0,Fd=0,Fe=0,Ff=0,Fg=Fa.getUint16(),Fh=[];for(Fh.length=Fg,Fc=0;Fc<Fg;Fc++)Fh[Fc]=FK.interpolation[Fa.getByte()];var Fi=Fa.getUint8();for(Fx._templet._anis.length=Fi,Fc=0;Fc<Fi;Fc++){var Fj=Fx._templet._anis[Fc]={};Fj.nodes=new Array;var Fm=Fj.name=Fx._strings[Fa.getUint16()];Fx._templet._aniMap[Fm]=Fc,Fj.bone3DMap={},Fj.playTime=Fa.getFloat32();var Fn=Fj.nodes.length=Fa.getInt16();for(Fd=Fj.totalKeyframeDatasLength=0;Fd<Fn;Fd++){var Fo=Fj.nodes[Fd]={};Fo.keyframeWidth=Fg,Fo.childs=[];var Fp=Fa.getUint16();0<=Fp&&(Fo.name=Fx._strings[Fp],Fj.bone3DMap[Fo.name]=Fd),Fo.keyFrame=new Array,Fo.parentIndex=Fa.getInt16(),-1==Fo.parentIndex?Fo.parent=null:Fo.parent=Fj.nodes[Fo.parentIndex],Fj.totalKeyframeDatasLength+=Fg,Fo.interpolationMethod=Fh,null!=Fo.parent&&Fo.parent.childs.push(Fo);var Fq=Fa.getUint16(),Fr=null,Fs=null;for(Fe=0,Ff=Fo.keyFrame.length=Fq;Fe<Ff;Fe++){(Fr=Fo.keyFrame[Fe]={}).startTime=Fa.getFloat32(),Fs&&(Fs.duration=Fr.startTime-Fs.startTime);var Ft=Fx._DATA.offset,Fu=Fa.getUint32(),Fv=4*Fg,Fw=Fb.slice(Ft+Fu,Ft+Fu+Fv);Fr.data=new Float32Array(Fw),Fs=Fr}Fr.duration=0,Fo.playTime=Fj.playTime,Fx._templet._calculateKeyFrame(Fo,Fq,Fg)}}},Fx._templet=null,Fx._reader=null,Fx._strings=[],Fc(Fx,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Fx}(),FIa=(function(){function Fa(){}Fd(Fa,"laya.ani.AnimationState"),Fa.stopped=0,Fa.paused=1,Fa.playing=2}(),function(){function Fe(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new FVa,this.resultMatrix=new FGa,this._children=[]}Fd(Fe,"laya.ani.bone.Bone");var Fa=Fe.prototype;return Fa.setTempMatrix=function(Fa){this._tempMatrix=Fa;var Fb,Fc=0;for(Fc=0,Fb=this._children.length;Fc<Fb;Fc++)this._children[Fc].setTempMatrix(this._tempMatrix)},Fa.update=function(Fa){var Fb;if(this.rotation=this.transform.skX,Fa)Fb=this.resultTransform.getMatrix(),FGa.mul(Fb,Fa,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)Fb=this.resultTransform.getMatrix(),FGa.mul(Fb,this.parentBone.resultMatrix,this.resultMatrix);else{var Fc=this.parentBone,Fd=NaN,Fe=NaN,Ff=NaN,Fg=this.parentBone.resultMatrix;Fb=this.resultTransform.getMatrix();var Fh=Fg.a*Fb.tx+Fg.c*Fb.ty+Fg.tx,Fi=Fg.b*Fb.tx+Fg.d*Fb.ty+Fg.ty,Fj=new FGa;this.inheritRotation?(Fd=Math.atan2(Fc.resultMatrix.b,Fc.resultMatrix.a),Fe=Math.cos(Fd),Ff=Math.sin(Fd),Fj.setTo(Fe,Ff,-Ff,Fe,0,0),FGa.mul(this._tempMatrix,Fj,FGa.TEMP),FGa.TEMP.copyTo(Fj),Fb=this.resultTransform.getMatrix(),FGa.mul(Fb,Fj,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,Fb=this.resultTransform.getMatrix(),FGa.TEMP.identity(),FGa.TEMP.d=this.d,FGa.mul(Fb,FGa.TEMP,this.resultMatrix)),this.resultMatrix.tx=Fh,this.resultMatrix.ty=Fi}else(Fb=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var Fm,Fn=0;for(Fn=0,Fm=this._children.length;Fn<Fm;Fn++)this._children[Fn].update()},Fa.updateChild=function(){var Fa,Fb=0;for(Fb=0,Fa=this._children.length;Fb<Fa;Fb++)this._children[Fb].update()},Fa.setRotation=function(Fa){this._sprite&&(this._sprite.rotation=180*Fa/Math.PI)},Fa.updateDraw=function(Fa,Fb){Fe.ShowBones&&!Fe.ShowBones[this.name]||(this._sprite||(this._sprite=new Ffa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),Fea.stage.addChild(this._sprite)),this._sprite.x=Fa+this.resultMatrix.tx,this._sprite.y=Fb+this.resultMatrix.ty);var Fc,Fd=0;for(Fd=0,Fc=this._children.length;Fd<Fc;Fd++)this._children[Fd].updateDraw(Fa,Fb)},Fa.addChild=function(Fa){this._children.push(Fa),Fa.parentBone=this},Fa.findBone=function(Fa){if(this.name==Fa)return this;var Fb,Fc,Fd=0;for(Fd=0,Fb=this._children.length;Fd<Fb;Fd++)if(Fc=this._children[Fd].findBone(Fa))return Fc;return null},Fa.localToWorld=function(Fa){var Fb=Fa[0],Fc=Fa[1];Fa[0]=Fb*this.resultMatrix.a+Fc*this.resultMatrix.c+this.resultMatrix.tx,Fa[1]=Fb*this.resultMatrix.b+Fc*this.resultMatrix.d+this.resultMatrix.ty},Fe.ShowBones={},Fe}()),FJa=function(){function Fr(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}Fd(Fr,"laya.ani.bone.BoneSlot");var Fa=Fr.prototype;return Fa.showSlotData=function(Fa,Fb){void 0===Fb&&(Fb=!0),this.currSlotData=Fa,Fb&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},Fa.showDisplayByName=function(Fa){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(Fa))},Fa.replaceDisplayByName=function(Fa,Fb){if(this.currSlotData){var Fc;Fc=this.currSlotData.getDisplayByName(Fa);var Fd;Fd=this.currSlotData.getDisplayByName(Fb),this.replaceDisplayByIndex(Fc,Fd)}},Fa.replaceDisplayByIndex=function(Fa,Fb){this.currSlotData&&(this._replaceDic[Fa]=Fb,this.displayIndex==Fa&&this.showDisplayByIndex(Fa))},Fa.showDisplayByIndex=function(Fa){if(null!=this._replaceDic[Fa]&&(Fa=this._replaceDic[Fa]),this.currSlotData&&-1<Fa&&Fa<this.currSlotData.displayArr.length){if(this.displayIndex=Fa,this.currDisplayData=this.currSlotData.displayArr[Fa],this.currDisplayData){var Fb=this.currDisplayData.name;this.currTexture=this.templet.getTexture(Fb),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!Fs.isConchApp||Fs.isConchApp&&"0.9.15"<Ffa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},Fa.replaceSkin=function(Fa){this._diyTexture=Fa,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},Fa.setParentMatrix=function(Fa){this._parentMatrix=Fa},Fa.draw=function(Fa,Fb,Fc,Fd){if(void 0===Fc&&(Fc=!1),void 0===Fd&&(Fd=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var Fe,Ff=this.currTexture;switch(this._diyTexture&&(Ff=this._diyTexture),this.currDisplayData.type){case 0:if(Fa){var Fg=this.getDisplayMatrix();if(this._parentMatrix){var Fh=!1;if(Fg){var Fi;if(FGa.mul(Fg,this._parentMatrix,FGa.TEMP),Fi=Fc?(null==this._resultMatrix&&(this._resultMatrix=new FGa),this._resultMatrix):new FGa,!Fs.isWebGL&&this.currDisplayData.uvs||Fs.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var Fj=Fr._tempMatrix;Fj.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Fj.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Fh=!0,Fj.rotate(-Math.PI/2)),FGa.mul(Fj,FGa.TEMP,Fi)}else FGa.TEMP.copyTo(Fi);Fh?Fa.drawTexture(Ff,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,Fi):Fa.drawTexture(Ff,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,Fi)}}}break;case 1:if(null==(Fe=Fc?(null==this._skinSprite&&(this._skinSprite=Fr.createSkinMesh()),this._skinSprite):Fr.createSkinMesh()))return;var Fm;if(null==this.currDisplayData.bones){var Fn,Fo=this.currDisplayData.weights;this.deformData&&(Fo=this.deformData),Fn=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Fz.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Fz.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=Fo;this.currDisplayData.triangles.length;Fm=this.currDisplayData.triangles,Fe.init2(Ff,null,Fm,this._mVerticleArr,Fn);var Fp,Fq=this.getDisplayMatrix();if(this._parentMatrix)if(Fq)FGa.mul(Fq,this._parentMatrix,FGa.TEMP),Fp=Fc?(null==this._resultMatrix&&(this._resultMatrix=new FGa),this._resultMatrix):new FGa,FGa.TEMP.copyTo(Fp),Fe.transform=Fp}else this.skinMesh(Fb,Fe,Fd);Fa.drawSkin(Fe);break;case 2:if(null==(Fe=Fc?(null==this._skinSprite&&(this._skinSprite=Fr.createSkinMesh()),this._skinSprite):Fr.createSkinMesh()))return;this.skinMesh(Fb,Fe,Fd),Fa.drawSkin(Fe)}}},Fa.skinMesh=function(Fa,Fb,Fc){var Fd,Fe=this.currTexture,Ff=this.currDisplayData.bones;Fd=this._diyTexture?(Fe=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Fz.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Fz.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var Fg,Fh,Fi=this.currDisplayData.weights,Fj=this.currDisplayData.triangles,Fm=0,Fn=0,Fo=0,Fp=NaN,Fq=NaN,Fr=0,Fs=0,Ft=[],Fu=0,Fv=0;if(this.deformData&&0<this.deformData.length){var Fw=0;for(Fu=0,Fv=Ff.length;Fu<Fv;){for(Fo=Ff[Fu++]+Fu,Fn=Fm=0;Fu<Fo;Fu++)Fh=Fa[Ff[Fu]],Fp=Fi[Fr]+this.deformData[Fw++],Fq=Fi[Fr+1]+this.deformData[Fw++],Fs=Fi[Fr+2],Fm+=(Fp*Fh.a+Fq*Fh.c+Fh.tx)*Fs,Fn+=(Fp*Fh.b+Fq*Fh.d+Fh.ty)*Fs,Fr+=3;Ft.push(Fm,Fn)}}else for(Fu=0,Fv=Ff.length;Fu<Fv;){for(Fo=Ff[Fu++]+Fu,Fn=Fm=0;Fu<Fo;Fu++)Fh=Fa[Ff[Fu]],Fp=Fi[Fr],Fq=Fi[Fr+1],Fs=Fi[Fr+2],Fm+=(Fp*Fh.a+Fq*Fh.c+Fh.tx)*Fs,Fn+=(Fp*Fh.b+Fq*Fh.d+Fh.ty)*Fs,Fr+=3;Ft.push(Fm,Fn)}this._mVerticleArr=Ft,Fg=Fj,Fb.init2(Fe,null,Fg,this._mVerticleArr,Fd)},Fa.drawBonePoint=function(Fa){Fa&&this._parentMatrix&&Fa.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},Fa.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},Fa.getMatrix=function(){return this._resultMatrix},Fa.copy=function(){var Fa=new Fr;return Fa.type="copy",Fa.name=this.name,Fa.attachmentName=this.attachmentName,Fa.srcDisplayIndex=this.srcDisplayIndex,Fa.parent=this.parent,Fa.displayIndex=this.displayIndex,Fa.templet=this.templet,Fa.currSlotData=this.currSlotData,Fa.currTexture=this.currTexture,Fa.currDisplayData=this.currDisplayData,Fa},Fr.createSkinMesh=function(){return Fs.isWebGL||Fs.isConchApp?Fp.skinAniSprite():(Fs.isWebGL,null)},Fc(Fr,["_tempMatrix",function(){return this._tempMatrix=new FGa}]),Fr}(),FKa=function(){function Fa(){this.skinName=null,this.deformSlotDataList=[]}return Fd(Fa,"laya.ani.bone.DeformAniData"),Fa}(),FLa=function(){function Fa(){this.deformSlotDisplayList=[]}return Fd(Fa,"laya.ani.bone.DeformSlotData"),Fa}(),FMa=function(){function Fa(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}Fd(Fa,"laya.ani.bone.DeformSlotDisplayData");var Fb=Fa.prototype;return Fb.binarySearch1=function(Fa,Fb){var Fc=0,Fd=Fa.length-2;if(0==Fd)return 1;for(var Fe=Fd>>>1;;){if(Fa[Math.floor(Fe+1)]<=Fb?Fc=Fe+1:Fd=Fe,Fc==Fd)return Fc+1;Fe=Fc+Fd>>>1}return 0},Fb.apply=function(Fa,Fb,Fc){if(void 0===Fc&&(Fc=1),Fa+=.05,!(this.timeList.length<=0)){var Fd=0;if(!(Fa<this.timeList[0])){var Fe=this.vectices[0].length,Ff=[],Fg=this.binarySearch1(this.timeList,Fa);if(this.frameIndex=Fg,Fa>=this.timeList[this.timeList.length-1]){var Fh=this.vectices[this.vectices.length-1];if(Fc<1)for(Fd=0;Fd<Fe;Fd++)Ff[Fd]+=(Fh[Fd]-Ff[Fd])*Fc;else for(Fd=0;Fd<Fe;Fd++)Ff[Fd]=Fh[Fd];this.deformData=Ff}else{this.tweenKeyList[this.frameIndex];var Fi=this.vectices[this.frameIndex-1],Fj=this.vectices[this.frameIndex],Fm=this.timeList[this.frameIndex-1],Fn=this.timeList[this.frameIndex];Fc=this.tweenKeyList[Fg-1]?(Fa-Fm)/(Fn-Fm):0;var Fo=NaN;for(Fd=0;Fd<Fe;Fd++)Fo=Fi[Fd],Ff[Fd]=Fo+(Fj[Fd]-Fo)*Fc;this.deformData=Ff}}}},Fa}(),FNa=function(){function Fa(){this.time=NaN,this.drawOrder=[]}return Fd(Fa,"laya.ani.bone.DrawOrderData"),Fa}(),FOa=function(){function Fa(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return Fd(Fa,"laya.ani.bone.EventData"),Fa}(),Fu=function(){function Fda(Fa,Fb){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=Fa,this._targetBone=Fb[Fa.targetBoneIndex],this.isSpine=Fa.isSpine,null==this._bones&&(this._bones=[]);for(var Fc=this._bones.length=0,Fd=Fa.boneIndexs.length;Fc<Fd;Fc++)this._bones.push(Fb[Fa.boneIndexs[Fc]]);this.name=Fa.name,this.mix=Fa.mix,this.bendDirection=Fa.bendDirection}Fd(Fda,"laya.ani.bone.IkConstraint");var Fa=Fda.prototype;return Fa.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},Fa._applyIk1=function(Fa,Fb,Fc,Fd){var Fe=Fa.parentBone,Ff=1/(Fe.resultMatrix.a*Fe.resultMatrix.d-Fe.resultMatrix.b*Fe.resultMatrix.c),Fg=Fb-Fe.resultMatrix.tx,Fh=Fc-Fe.resultMatrix.ty,Fi=(Fg*Fe.resultMatrix.d-Fh*Fe.resultMatrix.c)*Ff-Fa.transform.x,Fj=(Fh*Fe.resultMatrix.a-Fg*Fe.resultMatrix.b)*Ff-Fa.transform.y,Fm=Math.atan2(Fj,Fi)*Fda.radDeg-0-Fa.transform.skX;Fa.transform.scX<0&&(Fm+=180),180<Fm?Fm-=360:Fm<-180&&(Fm+=360),Fa.transform.skX=Fa.transform.skY=Fa.transform.skX+Fm*Fd,Fa.update()},Fa.updatePos=function(Fa,Fb){this._sp&&this._sp.pos(Fa,Fb)},Fa._applyIk2=function(Fa,Fb,Fc,Fd,Fe,Ff){if(0!=Ff){var Fg=Fa.resultTransform.x,Fh=Fa.resultTransform.y,Fi=Fa.transform.scX,Fj=Fa.transform.scY,Fm=Fb.transform.scX,Fn=0,Fo=0,Fp=0;Fp=Fi<0?(Fi=-Fi,Fn=180,-1):(Fn=0,1),Fj<0&&(Fj=-Fj,Fp=-Fp),Fo=Fm<0?(Fm=-Fm,180):0;var Fq=Fb.resultTransform.x,Fr=NaN,Fs=NaN,Ft=NaN,Fu=Fa.resultMatrix.a,Fv=Fa.resultMatrix.c,Fw=Fa.resultMatrix.b,Fx=Fa.resultMatrix.d,Fy=Math.abs(Fi-Fj)<=1e-4;Ft=Fy?(Fs=Fu*Fq+Fv*(Fr=Fb.resultTransform.y)+Fa.resultMatrix.tx,Fw*Fq+Fx*Fr+Fa.resultMatrix.ty):(Fr=0,Fs=Fu*Fq+Fa.resultMatrix.tx,Fw*Fq+Fa.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new Ffa,Fea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Fc,Fd,15,"#ffff00"),this._sp.graphics.drawCircle(Fs,Ft,15,"#ff00ff")),Fa.setRotation(Math.atan2(Ft-Fa.resultMatrix.ty,Fs-Fa.resultMatrix.tx));var Fz=Fa.parentBone;Fu=Fz.resultMatrix.a,Fv=Fz.resultMatrix.c,Fw=Fz.resultMatrix.b;var FA=1/(Fu*(Fx=Fz.resultMatrix.d)-Fv*Fw),FB=Fc-Fz.resultMatrix.tx,FC=Fd-Fz.resultMatrix.ty,FD=(FB*Fx-FC*Fv)*FA-Fg,FE=(FC*Fu-FB*Fw)*FA-Fh,FF=((FB=Fs-Fz.resultMatrix.tx)*Fx-(FC=Ft-Fz.resultMatrix.ty)*Fv)*FA-Fg,FG=(FC*Fu-FB*Fw)*FA-Fh,FH=Math.sqrt(FF*FF+FG*FG),FI=Fb.length*Fm,FJ=NaN,FK=NaN;if(Fy){var FL=(FD*FD+FE*FE-FH*FH-(FI*=Fi)*FI)/(2*FH*FI);FL<-1?FL=-1:1<FL&&(FL=1),FK=Math.acos(FL)*Fe,Fu=FH+FI*FL,Fv=FI*Math.sin(FK),FJ=Math.atan2(FE*Fu-FD*Fv,FD*Fu+FE*Fv)}else{var FM=(Fu=Fi*FI)*Fu,FN=(Fv=Fj*FI)*Fv,FO=FD*FD+FE*FE,FP=Math.atan2(FE,FD),FQ=-2*FN*FH,FR=FN-FM;if(0<(Fx=FQ*FQ-4*FR*(Fw=FN*FH*FH+FM*FO-FM*FN))){var FS=Math.sqrt(Fx);FQ<0&&(FS=-FS);var FT=(FS=-(FQ+FS)/2)/FR,FU=Fw/FS,FV=Math.abs(FT)<Math.abs(FU)?FT:FU;FV*FV<=FO&&(FC=Math.sqrt(FO-FV*FV)*Fe,FJ=FP-Math.atan2(FC,FV),FK=Math.atan2(FC/Fj,(FV-FH)/Fi))}var FW=0,FX=Number.MAX_VALUE,FY=0,FZ=0,F$=0,F_=0,Fk=0,Fl=0;F_<(Fx=(FB=FH+Fu)*FB)&&(F$=0,F_=Fx,Fk=FB),(Fx=(FB=FH-Fu)*FB)<FX&&(FW=Math.PI,FX=Fx,FY=FB);var Faa=Math.acos(-Fu*FH/(FM-FN));(Fx=(FB=Fu*Math.cos(Faa)+FH)*FB+(FC=Fv*Math.sin(Faa))*FC)<FX&&(FW=Faa,FX=Fx,FY=FB,FZ=FC),F_<Fx&&(F$=Faa,F_=Fx,Fk=FB,Fl=FC),FK=FO<=(FX+F_)/2?(FJ=FP-Math.atan2(FZ*Fe,FY),FW*Fe):(FJ=FP-Math.atan2(Fl*Fe,Fk),F$*Fe)}var Fba=Math.atan2(Fr,Fq)*Fp,Fca=Fa.resultTransform.skX;180<(FJ=(FJ-Fba)*Fda.radDeg+Fn-Fca)?FJ-=360:FJ<-180&&(FJ+=360),Fa.resultTransform.x=Fg,Fa.resultTransform.y=Fh,Fa.resultTransform.skX=Fa.resultTransform.skY=Fca+FJ*Ff,Fca=Fb.resultTransform.skX,180<(FK=((FK+Fba)*Fda.radDeg-0)*Fp+Fo-(Fca%=360))?FK-=360:FK<-180&&(FK+=360),Fb.resultTransform.x=Fq,Fb.resultTransform.y=Fr,Fb.resultTransform.skX=Fb.resultTransform.skY=Fb.resultTransform.skY+FK*Ff,Fa.update()}},Fa._applyIk3=function(Fa,Fb,Fc,Fd,Fe,Ff){if(0!=Ff){var Fg,Fh,Fi=Fb.resultMatrix.a*Fb.length,Fj=Fb.resultMatrix.b*Fb.length,Fm=Fi*Fi+Fj*Fj,Fn=Math.sqrt(Fm),Fo=Fa.resultMatrix.tx,Fp=Fa.resultMatrix.ty,Fq=Fb.resultMatrix.tx,Fr=Fb.resultMatrix.ty,Fs=Fq-Fo,Ft=Fr-Fp,Fu=Fs*Fs+Ft*Ft,Fv=Math.sqrt(Fu),Fw=(Fs=Fc-Fa.resultMatrix.tx)*Fs+(Ft=Fd-Fa.resultMatrix.ty)*Ft,Fx=Math.sqrt(Fw);if(Fn+Fv<=Fx||Fx+Fn<=Fv||Fx+Fv<=Fn){var Fy=NaN;Fq=Fo+(Fy=Fn+Fv<=Fx?1:-1)*(Fc-Fo)*Fv/Fx,Fr=Fp+Fy*(Fd-Fp)*Fv/Fx}else{var Fz=(Fu-Fm+Fw)/(2*Fw),FA=Math.sqrt(Fu-Fz*Fz*Fw)/Fx,FB=Fo+Fs*Fz,FC=Fp+Ft*Fz,FD=-Ft*FA,FE=Fs*FA;Fr=0<Fe?(Fq=FB-FD,FC-FE):(Fq=FB+FD,FC+FE)}Fg=Fq,Fh=Fr,this.isDebug&&(this._sp||(this._sp=new Ffa,Fea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Fo,Fp,15,"#ff00ff"),this._sp.graphics.drawCircle(Fc,Fd,15,"#ffff00"),this._sp.graphics.drawCircle(Fg,Fh,15,"#ff00ff"));var FF,FG;FF=Math.atan2(Fh-Fa.resultMatrix.ty,Fg-Fa.resultMatrix.tx),Fa.setRotation(FF),(FG=Fda._tempMatrix).identity(),FG.rotate(FF),FG.scale(Fa.resultMatrix.getScaleX(),Fa.resultMatrix.getScaleY()),FG.translate(Fa.resultMatrix.tx,Fa.resultMatrix.ty),FG.copyTo(Fa.resultMatrix),Fa.updateChild();var FH,FI;FH=Math.atan2(Fd-Fh,Fc-Fg),Fb.setRotation(FH),(FI=Fda._tempMatrix).identity(),FI.rotate(FH),FI.scale(Fb.resultMatrix.getScaleX(),Fb.resultMatrix.getScaleY()),FI.translate(Fg,Fh),FG.copyTo(Fb.resultMatrix),Fb.updateChild()}},Fc(Fda,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new FGa}]),Fda}(),FPa=function(){function Fa(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return Fd(Fa,"laya.ani.bone.IkConstraintData"),Fa}(),Fx=function(){function FI(Fa,Fb){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=Fa,this.position=Fa.position,this.spacing=Fa.spacing,this.rotateMix=Fa.rotateMix,this.translateMix=Fa.translateMix,this.bones=[];for(var Fc=this.data.bones,Fd=0,Fe=Fc.length;Fd<Fe;Fd++)this.bones.push(Fb[Fc[Fd]])}Fd(FI,"laya.ani.bone.PathConstraint");var Fa=FI.prototype;return Fa.apply=function(Fa,Fb){if(this.target){var Fc=this.translateMix,Fd=this.translateMix,Fe=0<Fd,Ff=this.data.spacingMode,Fg="length"==Ff,Fh=this.data.rotateMode,Fi="tangent"==Fh,Fj="chainScale"==Fh,Fm=[],Fn=this.bones.length,Fo=Fi?Fn:Fn+1,Fp=[];(this._spaces=Fp)[0]=this.position;var Fq=this.spacing;if(Fj||Fg)for(var Fr=0,Fs=Fo-1;Fr<Fs;){var Ft=this.bones[Fr],Fu=Ft.length,Fv=Fu*Ft.resultMatrix.a,Fw=Fu*Ft.resultMatrix.b;Fu=Math.sqrt(Fv*Fv+Fw*Fw),Fj&&(Fm[Fr]=Fu),Fp[++Fr]=Fg?Math.max(0,Fu+Fq):Fq}else for(Fr=1;Fr<Fo;Fr++)Fp[Fr]=Fq;var Fx=this.computeWorldPositions(this.target,Fa,Fb,Fo,Fi,"percent"==this.data.positionMode,"percent"==Ff);if(this._debugKey){for(Fr=0;Fr<Fx.length;Fr++)Fb.drawCircle(Fx[Fr++],Fx[Fr++],5,"#00ff00");var Fy=[];for(Fr=0;Fr<Fx.length;Fr++)Fy.push(Fx[Fr++],Fx[Fr++]);Fb.drawLines(0,0,Fy,"#ff0000")}var Fz=Fx[0],FA=Fx[1],FB=this.data.offsetRotation,FC="chain"==Fh&&0==FB,FD=NaN;for(Fr=0,FD=3;Fr<Fn;Fr++,FD+=3){(Ft=this.bones[Fr]).resultMatrix.tx+=(Fz-Ft.resultMatrix.tx)*Fc,Ft.resultMatrix.ty+=(FA-Ft.resultMatrix.ty)*Fc;var FE=(Fv=Fx[FD])-Fz,FF=(Fw=Fx[FD+1])-FA;if(Fj&&0!=(Fu=Fm[Fr])){var FG=(Math.sqrt(FE*FE+FF*FF)/Fu-1)*Fd+1;Ft.resultMatrix.a*=FG,Ft.resultMatrix.c*=FG}if(Fz=Fv,FA=Fw,Fe){var FH=Ft.resultMatrix.a,FI=Ft.resultMatrix.c,FJ=Ft.resultMatrix.b,FK=Ft.resultMatrix.d,FL=NaN,FM=NaN,FN=NaN;FL=Fi?Fx[FD-1]:0==Fp[Fr+1]?Fx[FD+2]:Math.atan2(FF,FE),FL-=Math.atan2(FJ,FH)-FB/180*Math.PI,FC&&(FM=Math.cos(FL),FN=Math.sin(FL),Fz+=((Fu=Ft.length)*(FM*FH-FN*FJ)-FE)*Fd,FA+=(Fu*(FN*FH+FM*FJ)-FF)*Fd),FL>Math.PI?FL-=2*Math.PI:FL<-Math.PI&&(FL+=2*Math.PI),FL*=Fd,FM=Math.cos(FL),FN=Math.sin(FL),Ft.resultMatrix.a=FM*FH-FN*FJ,Ft.resultMatrix.c=FM*FI-FN*FK,Ft.resultMatrix.b=FN*FH+FM*FJ,Ft.resultMatrix.d=FN*FI+FM*FK}}}},Fa.computeWorldVertices2=function(Fa,Fb,Fc,Fd,Fe,Ff){var Fg,Fh,Fi=Fa.currDisplayData.bones,Fj=Fa.currDisplayData.weights,Fm=Fa.currDisplayData.triangles,Fn=0,Fo=0,Fp=0,Fq=0,Fr=0,Fs=0,Ft=0,Fu=0,Fv=0,Fw=0,Fx=0;if(null!=Fi){for(Fn=0;Fn<Fc;Fn+=2)Fo+=(Fq=Fi[Fo])+1,Fp+=Fq;var Fy=Fb;for(Fr=Ff,Fs=3*Fp;Fr<Fd;Fr+=2){for(Fu=Ft=0,Fq=Fi[Fo++],Fq+=Fo;Fo<Fq;Fo++,Fs+=3){Fg=Fy[Fi[Fo]].resultMatrix,Fv=Fj[Fs],Fw=Fj[Fs+1];var Fz=Fj[Fs+2];Ft+=(Fv*Fg.a+Fw*Fg.c+Fg.tx)*Fz,Fu+=(Fv*Fg.b+Fw*Fg.d+Fg.ty)*Fz}Fe[Fr]=Ft,Fe[Fr+1]=Fu}}else{var FA,FB;if(Fm||(Fm=Fj),Fa.deformData&&(Fm=Fa.deformData),FA=Fa.parent,Fb)for(Fx=Fb.length,Fn=0;Fn<Fx;Fn++)if(Fb[Fn].name==FA){Fh=Fb[Fn];break}Fh&&(FB=Fh.resultMatrix),FB||(FB=FI._tempMt);var FC=FB.tx,FD=FB.ty,FE=FB.a,FF=FB.b,FG=FB.c,FH=FB.d;for(Fh&&(FH*=Fh.d),Fo=Fc,Fr=Ff;Fr<Fd;Fo+=2,Fr+=2)Fv=Fm[Fo],Fw=Fm[Fo+1],Fe[Fr]=Fv*FE+Fw*FF+FC,Fe[Fr+1]=-(Fv*FG+Fw*FH+FD)}},Fa.computeWorldPositions=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg){Fa.currDisplayData.bones,Fa.currDisplayData.weights,Fa.currDisplayData.triangles;var Fh=[],Fi=0,Fj=Fa.currDisplayData.verLen,Fm=this.position,Fn=this._spaces,Fo=[],Fp=[],Fq=Fj/6,Fr=-1,Fs=NaN,Ft=0,Fu=0,Fv=NaN,Fw=NaN,Fx=NaN,Fy=NaN;if(Fq--,Fj-=4,this.computeWorldVertices2(Fa,Fb,2,Fj,Fh,0),this._debugKey)for(Fi=0;Fi<Fh.length;)Fc.drawCircle(Fh[Fi++],Fh[Fi++],10,"#ff0000");Fo=Fh,this._curves.length=Fq;var Fz=this._curves,FA=Fo[Fs=0],FB=Fo[1],FC=0,FD=0,FE=0,FF=0,FG=0,FH=0,FI=NaN,FJ=NaN,FK=NaN,FL=NaN,FM=NaN,FN=NaN,FO=NaN,FP=NaN,FQ=0;for(Fi=0,FQ=2;Fi<Fq;Fi++,FQ+=6)FC=Fo[FQ],FD=Fo[FQ+1],FE=Fo[FQ+2],FF=Fo[FQ+3],FM=2*(FI=.1875*(FA-2*FC+FE))+(FK=.09375*(3*(FC-FE)-FA+(FG=Fo[FQ+4]))),FN=2*(FJ=.1875*(FB-2*FD+FF))+(FL=.09375*(3*(FD-FF)-FB+(FH=Fo[FQ+5]))),FO=.75*(FC-FA)+FI+.16666667*FK,FP=.75*(FD-FB)+FJ+.16666667*FL,Fs+=Math.sqrt(FO*FO+FP*FP),FO+=FM,FP+=FN,FM+=FK,FN+=FL,Fs+=Math.sqrt(FO*FO+FP*FP),FO+=FM,FP+=FN,Fs+=Math.sqrt(FO*FO+FP*FP),FO+=FM+FK,FP+=FN+FL,Fs+=Math.sqrt(FO*FO+FP*FP),Fz[Fi]=Fs,FA=FG,FB=FH;if(Ff&&(Fm*=Fs),Fg)for(Fi=0;Fi<Fd;Fi++)Fn[Fi]*=Fs;var FR=this._segments,FS=0,FT=0;for(FT=Fu=Ft=Fi=0;Fi<Fd;Fi++,Ft+=3)if((Fv=Fm+=Fw=Fn[Fi])<0)this.addBeforePosition(Fv,Fo,0,Fp,Ft);else if(Fs<Fv)this.addAfterPosition(Fv-Fs,Fo,Fj-4,Fp,Ft);else{for(;;Fu++)if(!((Fy=Fz[Fu])<Fv)){0==Fu?Fv/=Fy:Fv=(Fv-(Fx=Fz[Fu-1]))/(Fy-Fx);break}if(Fu!=Fr){var FU=6*(Fr=Fu);for(FA=Fo[FU],FB=Fo[FU+1],FC=Fo[FU+2],FD=Fo[FU+3],FE=Fo[FU+4],FF=Fo[FU+5],FM=2*(FI=.03*(FA-2*FC+FE))+(FK=.006*(3*(FC-FE)-FA+(FG=Fo[FU+6]))),FN=2*(FJ=.03*(FB-2*FD+FF))+(FL=.006*(3*(FD-FF)-FB+(FH=Fo[FU+7]))),FO=.3*(FC-FA)+FI+.16666667*FK,FP=.3*(FD-FB)+FJ+.16666667*FL,FS=Math.sqrt(FO*FO+FP*FP),FR[0]=FS,FU=1;FU<8;FU++)FO+=FM,FP+=FN,FM+=FK,FN+=FL,FS+=Math.sqrt(FO*FO+FP*FP),FR[FU]=FS;FO+=FM,FP+=FN,FS+=Math.sqrt(FO*FO+FP*FP),FR[8]=FS,FO+=FM+FK,FP+=FN+FL,FS+=Math.sqrt(FO*FO+FP*FP),FR[9]=FS,FT=0}for(Fv*=FS;;FT++)if(!((Fy=FR[FT])<Fv)){0==FT?Fv/=Fy:Fv=FT+(Fv-(Fx=FR[FT-1]))/(Fy-Fx);break}this.addCurvePosition(.1*Fv,FA,FB,FC,FD,FE,FF,FG,FH,Fp,Ft,Fe||0<Fi&&0==Fw)}return Fp},Fa.addBeforePosition=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fb[Fc],Fg=Fb[Fc+1],Fh=Fb[Fc+2]-Ff,Fi=Fb[Fc+3]-Fg,Fj=Math.atan2(Fi,Fh);Fd[Fe]=Ff+Fa*Math.cos(Fj),Fd[Fe+1]=Fg+Fa*Math.sin(Fj),Fd[Fe+2]=Fj},Fa.addAfterPosition=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fb[Fc+2],Fg=Fb[Fc+3],Fh=Ff-Fb[Fc],Fi=Fg-Fb[Fc+1],Fj=Math.atan2(Fi,Fh);Fd[Fe]=Ff+Fa*Math.cos(Fj),Fd[Fe+1]=Fg+Fa*Math.sin(Fj),Fd[Fe+2]=Fj},Fa.addCurvePosition=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm,Fn){0==Fa&&(Fa=1e-4);var Fo=Fa*Fa,Fp=Fo*Fa,Fq=1-Fa,Fr=Fq*Fq,Fs=Fr*Fq,Ft=Fq*Fa,Fu=3*Ft,Fv=Fq*Fu,Fw=Fu*Fa,Fx=Fb*Fs+Fd*Fv+Ff*Fw+Fh*Fp,Fy=Fc*Fs+Fe*Fv+Fg*Fw+Fi*Fp;Fj[Fm]=Fx,Fj[Fm+1]=Fy,Fj[Fm+2]=Fn?Math.atan2(Fy-(Fc*Fr+Fe*Ft*2+Fg*Fo),Fx-(Fb*Fr+Fd*Ft*2+Ff*Fo)):0},FI.NONE=-1,FI.BEFORE=-2,FI.AFTER=-3,Fc(FI,["_tempMt",function(){return this._tempMt=new FGa}]),FI}(),FQa=function(){function Fa(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return Fd(Fa,"laya.ani.bone.PathConstraintData"),Fa}(),FRa=function(){function Fa(){this.name=null,this.slotArr=[]}return Fd(Fa,"laya.ani.bone.SkinData"),Fa}(),FSa=function(){function Fa(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}Fd(Fa,"laya.ani.bone.SkinSlotDisplayData");var Fb=Fa.prototype;return Fb.createTexture=function(Fa){return this.texture||(this.texture=new FHa(Fa.bitmap,this.uvs),Fa.bitmap.alphaTexture&&(this.texture.alphaTexture=new FHa(Fa.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=Fa.height,this.texture.height=Fa.width,this.texture.offsetX=-Fa.offsetX,this.texture.offsetY=-Fa.offsetY,this.texture.sourceWidth=Fa.sourceHeight,this.texture.sourceHeight=Fa.sourceWidth):(this.texture.width=Fa.width,this.texture.height=Fa.height,this.texture.offsetX=-Fa.offsetX,this.texture.offsetY=-Fa.offsetY,this.texture.sourceWidth=Fa.sourceWidth,this.texture.sourceHeight=Fa.sourceHeight),Fs.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},Fb.destory=function(){this.texture&&this.texture.destroy()},Fa}(),FTa=function(){function Fa(){this.name=null,this.displayArr=[]}return Fd(Fa,"laya.ani.bone.SlotData"),Fa.prototype.getDisplayByName=function(Fa){for(var Fb=0,Fc=this.displayArr.length;Fb<Fc;Fb++)if(this.displayArr[Fb].attachmentName==Fa)return Fb;return-1},Fa}(),Fy=function(){function Fa(Fa,Fb){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=Fr(2,0),this._data=Fa,null==this._bones&&(this._bones=[]),this.target=Fb[Fa.targetIndex];var Fc,Fd=0;for(Fd=0,Fc=Fa.boneIndexs.length;Fd<Fc;Fd++)this._bones.push(Fb[Fa.boneIndexs[Fd]]);this.rotateMix=Fa.rotateMix,this.translateMix=Fa.translateMix,this.scaleMix=Fa.scaleMix,this.shearMix=Fa.shearMix}return Fd(Fa,"laya.ani.bone.TfConstraint"),Fa.prototype.apply=function(){for(var Fa,Fb=this.target.resultMatrix.a,Fc=this.target.resultMatrix.b,Fd=this.target.resultMatrix.c,Fe=this.target.resultMatrix.d,Ff=0,Fg=this._bones.length;Ff<Fg;Ff++){if(Fa=this._bones[Ff],0<this.rotateMix){var Fh=Fa.resultMatrix.a,Fi=Fa.resultMatrix.b,Fj=Fa.resultMatrix.c,Fm=Fa.resultMatrix.d,Fn=Math.atan2(Fd,Fb)-Math.atan2(Fj,Fh)+this._data.offsetRotation*Math.PI/180;Fn>Math.PI?Fn-=2*Math.PI:Fn<-Math.PI&&(Fn+=2*Math.PI),Fn*=this.rotateMix;var Fo=Math.cos(Fn),Fp=Math.sin(Fn);Fa.resultMatrix.a=Fo*Fh-Fp*Fj,Fa.resultMatrix.b=Fo*Fi-Fp*Fm,Fa.resultMatrix.c=Fp*Fh+Fo*Fj,Fa.resultMatrix.d=Fp*Fi+Fo*Fm}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),Fa.resultMatrix.tx+=(this._temp[0]-Fa.resultMatrix.tx)*this.translateMix,Fa.resultMatrix.ty+=(this._temp[1]-Fa.resultMatrix.ty)*this.translateMix,Fa.updateChild()),0<this.scaleMix){var Fq=Math.sqrt(Fa.resultMatrix.a*Fa.resultMatrix.a+Fa.resultMatrix.c*Fa.resultMatrix.c),Fr=Math.sqrt(Fb*Fb+Fd*Fd),Fs=1e-5<Fq?(Fq+(Fr-Fq+this._data.offsetScaleX)*this.scaleMix)/Fq:0;Fa.resultMatrix.a*=Fs,Fa.resultMatrix.c*=Fs,Fq=Math.sqrt(Fa.resultMatrix.b*Fa.resultMatrix.b+Fa.resultMatrix.d*Fa.resultMatrix.d),Fr=Math.sqrt(Fc*Fc+Fe*Fe),Fs=1e-5<Fq?(Fq+(Fr-Fq+this._data.offsetScaleY)*this.scaleMix)/Fq:0,Fa.resultMatrix.b*=Fs,Fa.resultMatrix.d*=Fs}if(0<this.shearMix){Fi=Fa.resultMatrix.b,Fm=Fa.resultMatrix.d;var Ft=Math.atan2(Fm,Fi);(Fn=Math.atan2(Fe,Fc)-Math.atan2(Fd,Fb)-(Ft-Math.atan2(Fa.resultMatrix.c,Fa.resultMatrix.a)))>Math.PI?Fn-=2*Math.PI:Fn<-Math.PI&&(Fn+=2*Math.PI),Fn=Ft+(Fn+this._data.offsetShearY*Math.PI/180)*this.shearMix,Fs=Math.sqrt(Fi*Fi+Fm*Fm),Fa.resultMatrix.b=Math.cos(Fn)*Fs,Fa.resultMatrix.d=Math.sin(Fn)*Fs}}},Fa}(),FUa=function(){function Fa(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return Fd(Fa,"laya.ani.bone.TfConstraintData"),Fa}(),FVa=function(){function Fa(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}Fd(Fa,"laya.ani.bone.Transform");var Fb=Fa.prototype;return Fb.initData=function(Fa){null!=Fa.x&&(this.x=Fa.x),null!=Fa.y&&(this.y=Fa.y),null!=Fa.skX&&(this.skX=Fa.skX),null!=Fa.skY&&(this.skY=Fa.skY),null!=Fa.scX&&(this.scX=Fa.scX),null!=Fa.scY&&(this.scY=Fa.scY)},Fb.getMatrix=function(){var Fa;return(Fa=this.mMatrix?this.mMatrix:this.mMatrix=new FGa).identity(),Fa.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(Fa,this.skewX*Math.PI/180,this.skewY*Math.PI/180),Fa.rotate(this.skX*Math.PI/180),Fa.translate(this.x,this.y),Fa},Fb.skew=function(Fa,Fb,Fc){var Fd=Math.sin(Fc),Fe=Math.cos(Fc),Ff=Math.sin(Fb),Fg=Math.cos(Fb);return Fa.setTo(Fa.a*Fg-Fa.b*Fd,Fa.a*Ff+Fa.b*Fe,Fa.c*Fg-Fa.d*Fd,Fa.c*Ff+Fa.d*Fe,Fa.tx*Fg-Fa.ty*Fd,Fa.tx*Ff+Fa.ty*Fe),Fa},Fa}(),Fz=function(){function Fa(){}return Fd(Fa,"laya.ani.bone.UVTools"),Fa.getRelativeUV=function(Fa,Fb,Fc){var Fd=Fa[0],Fe=Fa[2]-Fa[0],Ff=Fa[1],Fg=Fa[5]-Fa[1];Fc||(Fc=[]),Fc.length=Fb.length;var Fh,Fi=0;Fh=Fc.length;var Fj=1/Fe,Fm=1/Fg;for(Fi=0;Fi<Fh;Fi+=2)Fc[Fi]=(Fb[Fi]-Fd)*Fj,Fc[Fi+1]=(Fb[Fi+1]-Ff)*Fm;return Fc},Fa.getAbsoluteUV=function(Fa,Fb,Fc){if(0==Fa[0]&&0==Fa[1]&&1==Fa[4]&&1==Fa[5])return Fc?(Ft.copyArray(Fc,Fb),Fc):Fb;var Fd=Fa[0],Fe=Fa[2]-Fa[0],Ff=Fa[1],Fg=Fa[5]-Fa[1];Fc||(Fc=[]),Fc.length=Fb.length;var Fh,Fi=0;for(Fh=Fc.length,Fi=0;Fi<Fh;Fi+=2)Fc[Fi]=Fb[Fi]*Fe+Fd,Fc[Fi+1]=Fb[Fi+1]*Fg+Ff;return Fc},Fa}(),FI=function(){function Fa(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return Fd(Fa,"laya.ani.KeyFramesContent"),Fa}(),FA=function(){function Fm(){}return Fd(Fm,"laya.ani.math.BezierLerp"),Fm.getBezierRate=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fm._getBezierParamKey(Fb,Fc,Fd,Fe),Fg=100*Ff+Fa;if(Fm._bezierResultCache[Fg])return Fm._bezierResultCache[Fg];var Fh,Fi=Fm._getBezierPoints(Fb,Fc,Fd,Fe,Ff),Fj=0;for(Fh=Fi.length,Fj=0;Fj<Fh;Fj+=2)if(Fa<=Fi[Fj])return Fm._bezierResultCache[Fg]=Fi[Fj+1],Fi[Fj+1];return Fm._bezierResultCache[Fg]=1},Fm._getBezierParamKey=function(Fa,Fb,Fc,Fd){return 100*(100*(100*(100*Fa+Fb)+Fc)+Fd)},Fm._getBezierPoints=function(Fa,Fb,Fc,Fd,Fe){return Fm._bezierPointsCache[Fe]?Fm._bezierPointsCache[Fe]:(Ff=[0,0,Fa,Fb,Fc,Fd,1,1],Fg=(new Fh).getBezierPoints(Ff,100,3),Fm._bezierPointsCache[Fe]=Fg);var Ff,Fg},Fm._bezierResultCache={},Fm._bezierPointsCache={},Fm}(),FB=function(Fa){function Fb(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,Fb.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}Fd(Fb,"laya.ani.AnimationPlayer",Fe);var Fc=Fb.prototype;return Fea.imps(Fc,{"laya.resource.IDestroy":!0}),Fc._onTempletLoadedComputeFullKeyframeIndices=function(Fa,Fb,Fc){this._templet===Fc&&this._cachePlayRate===Fa&&this._cacheFrameRate===Fb&&this._computeFullKeyframeIndices()},Fc._computeFullKeyframeIndices=function(){for(var Fa=this._fullFrames=[],Fb=this._templet,Fc=this._cacheFrameRateInterval*this._cachePlayRate,Fd=0,Fe=Fb.getAnimationCount();Fd<Fe;Fd++){for(var Ff=[],Fg=0,Fh=Fb.getAnimation(Fd).nodes.length;Fg<Fh;Fg++){for(var Fi=Fb.getAnimation(Fd).nodes[Fg],Fj=Math.floor(Fi.playTime/Fc+.01),Fm=new Uint16Array(Fj+1),Fn=-1,Fo=0,Fp=Fi.keyFrame.length;Fo<Fp;Fo++){var Fq=Fi.keyFrame[Fo],Fr=Fq.startTime,Fs=Fr+Fq.duration+Fc;do{for(var Ft=Math.floor(Fr/Fc+.5),Fu=Fn+1;Fu<Ft;Fu++)Fm[Fu]=Fo;Fm[Fn=Ft]=Fo,Fr+=Fc}while(Fr<=Fs)}Ff.push(Fm)}Fa.push(Ff)}},Fc._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},Fc._calculatePlayDuration=function(){if(0!==this.state){var Fa=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=Fa),this._playEnd>Fa&&(this._playEnd=Fa),this._playDuration=this._playEnd-this._playStart}},Fc._setPlayParams=function(Fa,Fb){this._currentTime=Fa,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Fb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Fb},Fc._setPlayParamsWhenStop=function(Fa,Fb){this._currentTime=Fa,this._currentKeyframeIndex=Math.max(Math.floor(Fa/Fb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Fb,this._currentAnimationClipIndex=-1},Fc._update=function(Fa){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var Fb=this._cacheFrameRateInterval*this._cachePlayRate,Fc=0;this._startUpdateLoopCount!==Fq.loopCount&&(Fc=Fa*this.playbackRate,this._elapsedPlaybackTime+=Fc);var Fd=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=Fd)return this._setPlayParamsWhenStop(Fd,Fb),void this.event("stopped");if(Fc+=this._currentTime,0<Fd)if(Fd<=Fc)do{if(Fc-=Fd,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Fd,Fb),this._stopWhenCircleFinish=!1,void this.event("stopped");Fc<Fd&&(this._setPlayParams(Fc,Fb),this.event("complete"))}while(Fd<=Fc);else this._setPlayParams(Fc,Fb);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Fd,Fb),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},Fc._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},Fc.play=function(Fa,Fb,Fc,Fd,Fe){if(void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=1),void 0===Fc&&(Fc=2147483647),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(Fc<0||Fd<0||Fe<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==Fe&&Fe<Fd)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=Fb,this._overallDuration=Fc,this._playStart=Fd,this._playEnd=Fe,this._paused=!1,this._currentAnimationClipIndex=Fa,this._currentKeyframeIndex=0,this._startUpdateLoopCount=Fq.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},Fc.playByFrame=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Fa&&(Fa=0),void 0===Fb&&(Fb=1),void 0===Fc&&(Fc=2147483647),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=30);var Fg=1e3/Ff;this.play(Fa,Fb,Fc,Fd*Fg,Fe*Fg)},Fc.stop=function(Fa){void 0===Fa&&(Fa=!0),Fa?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},Ff(0,Fc,"playEnd",function(){return this._playEnd}),Ff(0,Fc,"templet",function(){return this._templet},function(Fa){0===!this.state&&this.stop(!0),this._templet!==Fa&&((this._templet=Fa).loaded?this._computeFullKeyframeIndices():Fa.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),Ff(0,Fc,"playStart",function(){return this._playStart}),Ff(0,Fc,"playDuration",function(){return this._playDuration}),Ff(0,Fc,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),Ff(0,Fc,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),Ff(0,Fc,"overallDuration",function(){return this._overallDuration}),Ff(0,Fc,"currentFrameTime",function(){return this._currentFrameTime}),Ff(0,Fc,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),Ff(0,Fc,"currentPlayTime",function(){return this._currentTime+this._playStart}),Ff(0,Fc,"cachePlayRate",function(){return this._cachePlayRate},function(Fa){this._cachePlayRate!==Fa&&(this._cachePlayRate=Fa,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[Fa,this._cacheFrameRate])))}),Ff(0,Fc,"cacheFrameRate",function(){return this._cacheFrameRate},function(Fa){this._cacheFrameRate!==Fa&&(this._cacheFrameRate=Fa,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,Fa])))}),Ff(0,Fc,"currentTime",null,function(Fa){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(Fa<this._playStart||Fa>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=Fq.loopCount;var Fb=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=Fa,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Fb),0),this._currentFrameTime=this._currentKeyframeIndex*Fb}}),Ff(0,Fc,"paused",function(){return this._paused},function(Fa){(this._paused=Fa)&&this.event("paused")}),Ff(0,Fc,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),Ff(0,Fc,"destroyed",function(){return this._destroyed}),Fb}(),FJ=function(Fa){function Fb(){Fb.__super.call(this),Fs.isConchNode&&(this.drawSkin=function(Fa){Fa.transform||(Fa.transform=FGa.EMPTY),this._addCmd([Fa]),this.setSkinMesh&&this.setSkinMesh(Fa._ps,Fa.mVBData,Fa.mEleNum,0,Fa.mTexture,Fa.transform)})}return Fd(Fb,"laya.ani.GraphicsAni",Fg),Fb.prototype.drawSkin=function(Fa){var Fb=[Fa];this._saveToCmd(Fs._context._drawSkin,Fb)},Fb.create=function(){return Fb._caches.pop()||new Fb},Fb.recycle=function(Fa){Fa.clear(),Fb._caches.push(Fa)},Fb._caches=[],Fb}(),FK=function(Fa){function Fu(){this._aniMap={},this.unfixedLastAniIndex=-1,Fu.__super.call(this),this._anis=new Array}Fd(Fu,"laya.ani.AnimationTemplet",Fm);var Fb=Fu.prototype;return Fb.parse=function(Fa){var Fb=new FFa(Fa);this._aniVersion=Fb.readUTFString(),Fv.parse(this,Fb)},Fb._calculateKeyFrame=function(Fa,Fb,Fc){var Fd=Fa.keyFrame;Fd[Fb]=Fd[0];for(var Fe=0;Fe<Fb;Fe++){var Ff=Fd[Fe];Ff.nextData=0===Ff.duration?Ff.data:Fd[Fe+1].data}Fd.length--},Fb.onAsynLoaded=function(Fa,Fb,Fc){var Fd=new FFa(Fb);switch(this._aniVersion=Fd.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":Fw.parse(this,Fd);break;default:Fv.parse(this,Fd)}this._endLoaded()},Fb.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},Fb.getAnimationCount=function(){return this._anis.length},Fb.getAnimation=function(Fa){return this._anis[Fa]},Fb.getAniDuration=function(Fa){return this._anis[Fa].playTime},Fb.getNodes=function(Fa){return this._anis[Fa].nodes},Fb.getNodeIndexWithName=function(Fa,Fb){return this._anis[Fa].bone3DMap[Fb]},Fb.getNodeCount=function(Fa){return this._anis[Fa].nodes.length},Fb.getTotalkeyframesLength=function(Fa){return this._anis[Fa].totalKeyframeDatasLength},Fb.getPublicExtData=function(){return this._publicExtData},Fb.getAnimationDataWithCache=function(Fa,Fb,Fc,Fd){var Fe=Fb[Fc];if(Fe){var Ff=Fe[Fa];return Ff?Ff[Fd]:null}return null},Fb.setAnimationDataWithCache=function(Fa,Fb,Fc,Fd,Fe){var Ff=Fb[Fc]||(Fb[Fc]={});(Ff[Fa]||(Ff[Fa]=[]))[Fd]=Fe},Fb.getOriginalData=function(Fa,Fb,Fc,Fd,Fe){for(var Ff=this._anis[Fa].nodes,Fg=0,Fh=0,Fi=Ff.length,Fj=0;Fh<Fi;Fh++){var Fm,Fn=Ff[Fh];Fm=Fn.keyFrame[Fc[Fh][Fd]],Fn.dataOffset=Fj;var Fo=Fe-Fm.startTime,Fp=Fn.lerpType;if(Fp)switch(Fp){case 0:case 1:for(Fg=0;Fg<Fn.keyframeWidth;)Fg+=Fn.interpolationMethod[Fg](Fn,Fg,Fb,Fj+Fg,Fm.data,Fo,null,Fm.duration,Fm.nextData);break;case 2:var Fq=Fm.interpolationData,Fr=Fq.length,Fs=0;for(Fg=0;Fg<Fr;){var Ft=Fq[Fg];switch(Ft){case 6:case 7:Fg+=Fu.interpolation[Ft](Fn,Fs,Fb,Fj+Fs,Fm.data,Fo,null,Fm.duration,Fm.nextData,Fq,Fg+1);break;default:Fg+=Fu.interpolation[Ft](Fn,Fs,Fb,Fj+Fs,Fm.data,Fo,null,Fm.duration,Fm.nextData)}Fs++}}else for(Fg=0;Fg<Fn.keyframeWidth;)Fg+=Fn.interpolationMethod[Fg](Fn,Fg,Fb,Fj+Fg,Fm.data,Fo,null,Fm.duration,Fm.nextData);Fj+=Fn.keyframeWidth}},Fb.getNodesCurrentFrameIndex=function(Fa,Fb){var Fc=this._anis[Fa].nodes;Fa!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Fc.length),this.unfixedCurrentTimes=new Float32Array(Fc.length),this.unfixedLastAniIndex=Fa);for(var Fd=0,Fe=Fc.length;Fd<Fe;Fd++){var Ff=Fc[Fd];for(Fb<this.unfixedCurrentTimes[Fd]&&(this.unfixedCurrentFrameIndexes[Fd]=0),this.unfixedCurrentTimes[Fd]=Fb;this.unfixedCurrentFrameIndexes[Fd]<Ff.keyFrame.length&&!(Ff.keyFrame[this.unfixedCurrentFrameIndexes[Fd]].startTime>this.unfixedCurrentTimes[Fd]);)this.unfixedCurrentFrameIndexes[Fd]++;this.unfixedCurrentFrameIndexes[Fd]--}return this.unfixedCurrentFrameIndexes},Fb.getOriginalDataUnfixedRate=function(Fa,Fb,Fc){var Fd=this._anis[Fa].nodes;Fa!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Fd.length),this.unfixedCurrentTimes=new Float32Array(Fd.length),this.unfixedKeyframes=Fr(Fd.length),this.unfixedLastAniIndex=Fa);for(var Fe=0,Ff=0,Fg=Fd.length,Fh=0;Ff<Fg;Ff++){var Fi=Fd[Ff];for(Fc<this.unfixedCurrentTimes[Ff]&&(this.unfixedCurrentFrameIndexes[Ff]=0),this.unfixedCurrentTimes[Ff]=Fc;this.unfixedCurrentFrameIndexes[Ff]<Fi.keyFrame.length&&!(Fi.keyFrame[this.unfixedCurrentFrameIndexes[Ff]].startTime>this.unfixedCurrentTimes[Ff]);)this.unfixedKeyframes[Ff]=Fi.keyFrame[this.unfixedCurrentFrameIndexes[Ff]],this.unfixedCurrentFrameIndexes[Ff]++;var Fj=this.unfixedKeyframes[Ff];Fi.dataOffset=Fh;var Fm=Fc-Fj.startTime;if(Fi.lerpType)switch(Fi.lerpType){case 0:case 1:for(Fe=0;Fe<Fi.keyframeWidth;)Fe+=Fi.interpolationMethod[Fe](Fi,Fe,Fb,Fh+Fe,Fj.data,Fm,null,Fj.duration,Fj.nextData);break;case 2:var Fn=Fj.interpolationData,Fo=Fn.length,Fp=0;for(Fe=0;Fe<Fo;){var Fq=Fn[Fe];switch(Fq){case 6:case 7:Fe+=Fu.interpolation[Fq](Fi,Fp,Fb,Fh+Fp,Fj.data,Fm,null,Fj.duration,Fj.nextData,Fn,Fe+1);break;default:Fe+=Fu.interpolation[Fq](Fi,Fp,Fb,Fh+Fp,Fj.data,Fm,null,Fj.duration,Fj.nextData)}Fp++}}else for(Fe=0;Fe<Fi.keyframeWidth;)Fe+=Fi.interpolationMethod[Fe](Fi,Fe,Fb,Fh+Fe,Fj.data,Fm,null,Fj.duration,Fj.nextData);Fh+=Fi.keyframeWidth}},Fu._LinearInterpolation_0=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){var Fm=0===Fh?0:Ff/Fh;return Fc[Fd]=(1-Fm)*Fe[Fb]+Fm*Fi[Fb],1},Fu._QuaternionInterpolation_1=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){var Fm=0===Fh?0:Ff/Fh;return Fo.slerpQuaternionArray(Fe,Fb,Fi,Fb,Fm,Fc,Fd),4},Fu._AngleInterpolation_2=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){return 0},Fu._RadiansInterpolation_3=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){return 0},Fu._Matrix4x4Interpolation_4=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){for(var Fm=0;Fm<16;Fm++,Fb++)Fc[Fd+Fm]=Fe[Fb]+Ff*Fg[Fb];return 16},Fu._NoInterpolation_5=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj){return Fc[Fd]=Fe[Fb],1},Fu._BezierInterpolation_6=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm){return void 0===Fm&&(Fm=0),Fc[Fd]=Fe[Fb]+(Fi[Fb]-Fe[Fb])*FA.getBezierRate(Ff/Fh,Fj[Fm],Fj[Fm+1],Fj[Fm+2],Fj[Fm+3]),5},Fu._BezierInterpolation_7=function(Fa,Fb,Fc,Fd,Fe,Ff,Fg,Fh,Fi,Fj,Fm){return void 0===Fm&&(Fm=0),Fc[Fd]=Fj[Fm+4]+Fj[Fm+5]*FA.getBezierRate((.001*Ff+Fj[Fm+6])/Fj[Fm+7],Fj[Fm],Fj[Fm+1],Fj[Fm+2],Fj[Fm+3]),9},Fu.load=function(Fa){return Fea.loader.create(Fa,null,null,Fu)},Fu.interpolation=[Fu._LinearInterpolation_0,Fu._QuaternionInterpolation_1,Fu._AngleInterpolation_2,Fu._RadiansInterpolation_3,Fu._Matrix4x4Interpolation_4,Fu._NoInterpolation_5,Fu._BezierInterpolation_6,Fu._BezierInterpolation_7],Fu}(),FC=function(Fb){function Fc(Fa,Fb){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,Fc.__super.call(this),void 0===Fb&&(Fb=0),Fa&&this.init(Fa,Fb)}Fd(Fc,"laya.ani.bone.Skeleton",Fb);var Fa=Fc.prototype;return Fa.init=function(Fa,Fb){void 0===Fb&&(Fb=0);var Fc,Fd,Fe,Ff=0,Fg=0;if(1==Fb)for(this._graphicsCache=[],Ff=0,Fg=Fa.getAnimationCount();Ff<Fg;Ff++)this._graphicsCache.push([]);if(this._yReverseMatrix=Fa.yReverseMatrix,this._aniMode=Fb,this._templet=Fa,this._player=new FB,this._player.cacheFrameRate=Fa.rate,this._player.templet=Fa,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=Fa.mBoneArr,this._rootBone=Fa.mRootBone,this._aniSectionDic=Fa.aniSectionDic,0<Fa.ikArr.length)for(this._ikArr=[],Ff=0,Fg=Fa.ikArr.length;Ff<Fg;Ff++)this._ikArr.push(new Fu(Fa.ikArr[Ff],this._boneList));if(0<Fa.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),Ff=0,Fg=Fa.pathArr.length;Ff<Fg;Ff++)Fc=Fa.pathArr[Ff],Fd=new Fx(Fc,this._boneList),(Fe=this._boneSlotDic[Fc.name])&&((Fd=new Fx(Fc,this._boneList)).target=Fe),this._pathDic[Fc.name]=Fd;if(0<Fa.tfArr.length)for(this._tfArr=[],Ff=0,Fg=Fa.tfArr.length;Ff<Fg;Ff++)this._tfArr.push(new Fy(Fa.tfArr[Ff],this._boneList));if(0<Fa.skinDataArray.length){var Fh=this._templet.skinDataArray[this._skinIndex];this._skinName=Fh.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},Fa.load=function(Fa,Fb,Fc){},Fa._onLoaded=function(){},Fa._parseComplete=function(){var Fa=FD.TEMPLET_DICTIONARY[this._aniPath];Fa&&(this.init(Fa,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},Fa._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},Fa._onPlay=function(){this.event("played")},Fa._onStop=function(){var Fa,Fb=this._templet.eventAniArr[this._aniClipIndex];if(Fb&&this._eventIndex<Fb.length)for(;this._eventIndex<Fb.length;this._eventIndex++)(Fa=Fb[this._eventIndex]).time>=this._player.playStart&&Fa.time<=this._player.playEnd&&this.event("label",Fa);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},Fa._onPause=function(){this.event("paused")},Fa._parseSrcBoneMatrix=function(){var Fa=0,Fb=0;for(Fb=this._templet.srcBoneMatrixArr.length,Fa=0;Fa<Fb;Fa++)this._boneMatrixArray.push(new FGa);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var Fc,Fd,Fe=this._templet.boneSlotArray;for(Fa=0,Fb=Fe.length;Fa<Fb;Fa++)Fc=Fe[Fa],null==(Fd=this._bindBoneBoneSlotDic[Fc.parent])&&(this._bindBoneBoneSlotDic[Fc.parent]=Fd=[]),this._boneSlotDic[Fc.name]=Fc=Fc.copy(),Fd.push(Fc),this._boneSlotArray.push(Fc)}},Fa._emitMissedEvents=function(Fa,Fb,Fc){void 0===Fc&&(Fc=0);var Fd=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(Fd){var Fe,Ff,Fg=0;for(Fe=Fd.length,Fg=Fc;Fg<Fe;Fg++)(Ff=Fd[Fg]).time>=this._player.playStart&&Ff.time<=this._player.playEnd&&this.event("label",Ff)}},Fa._update=function(Fa){if(void 0===Fa&&(Fa=!0),!(this._pause||Fa&&this._indexControl)){var Fb=this.timer.currTimer,Fc=this._player.currentKeyframeIndex,Fd=Fb-this._lastTime;if(Fa?this._player._update(Fd):Fc=-1,this._lastTime=Fb,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<Fd&&this._clipIndex==Fc&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var Fe;this._lastUpdateAniClipIndex=this._aniClipIndex,Fc>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var Ff,Fg=this._templet.eventAniArr[this._aniClipIndex];if(Fg&&this._eventIndex<Fg.length&&((Fe=Fg[this._eventIndex]).time>=this._player.playStart&&Fe.time<=this._player.playEnd?this._player.currentPlayTime>=Fe.time&&(this.event("label",Fe),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(Ff=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Ff&&(this.graphics=Ff));var Fh=0,Fi=0;for(Fi=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,Fi-1)&&0<Fi;)Fi--;if(Fi<this._clipIndex)for(Fh=Fi;Fh<this._clipIndex;Fh++)this._createGraphics(Fh)}else if(1==this._aniMode){if(Ff=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Ff&&(this.graphics=Ff));for(Fi=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,Fi-1)&&0<Fi;)Fi--;if(Fi<this._clipIndex)for(Fh=Fi;Fh<this._clipIndex;Fh++)this._createGraphics(Fh)}this._createGraphics()}}},Fa._createGraphics=function(Fa){void 0===Fa&&(Fa=-1),-1==Fa&&(Fa=this._clipIndex);var Fb,Fc,Fd=Fa*this._player.cacheFrameRateInterval,Fe=this._templet.drawOrderAniArr[this._aniClipIndex];if(Fe&&0<Fe.length)for(this._drawOrderIndex=0,Fb=Fe[this._drawOrderIndex];Fd>=Fb.time&&(this._drawOrder=Fb.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=Fe.length));)Fb=Fe[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=FJ.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=FJ.create(),Fc=this.graphics;var Ff=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],Fa,Fd);var Fg,Fh,Fi,Fj,Fm=this._aniSectionDic[this._aniClipIndex],Fn=0,Fo=0,Fp=0,Fq=0,Fr=0,Fs=this._templet.srcBoneMatrixArr.length;for(Fr=Fm[Fo=0];Fo<Fs;Fo++)Fj=this._boneList[Fo],Fi=this._templet.srcBoneMatrixArr[Fo],Fj.resultTransform.scX=Fi.scX*this._curOriginalData[Fn++],Fj.resultTransform.skX=Fi.skX+this._curOriginalData[Fn++],Fj.resultTransform.skY=Fi.skY+this._curOriginalData[Fn++],Fj.resultTransform.scY=Fi.scY*this._curOriginalData[Fn++],Fj.resultTransform.x=Fi.x+this._curOriginalData[Fn++],Fj.resultTransform.y=Fi.y+this._curOriginalData[Fn++],8===this._templet.tMatrixDataLen&&(Fj.resultTransform.skewX=Fi.skewX+this._curOriginalData[Fn++],Fj.resultTransform.skewY=Fi.skewY+this._curOriginalData[Fn++]);var Ft,Fu={},Fv={};for(Fr+=Fm[1];Fo<Fr;Fo++)Fu[(Ft=Ff[Fo]).name]=this._curOriginalData[Fn++],Fv[Ft.name]=this._curOriginalData[Fn++],this._curOriginalData[Fn++],this._curOriginalData[Fn++],this._curOriginalData[Fn++],this._curOriginalData[Fn++];var Fw,Fx,Fy={},Fz={};for(Fr+=Fm[2];Fo<Fr;Fo++)Fy[(Ft=Ff[Fo]).name]=this._curOriginalData[Fn++],Fz[Ft.name]=this._curOriginalData[Fn++],this._curOriginalData[Fn++],this._curOriginalData[Fn++],this._curOriginalData[Fn++],this._curOriginalData[Fn++];if(this._pathDic)for(Fr+=Fm[3];Fo<Fr;Fo++){if(Ft=Ff[Fo],Fw=this._pathDic[Ft.name])switch(new FFa(Ft.extenData).getByte()){case 1:Fw.position=this._curOriginalData[Fn++];break;case 2:Fw.spacing=this._curOriginalData[Fn++];break;case 3:Fw.rotateMix=this._curOriginalData[Fn++],Fw.translateMix=this._curOriginalData[Fn++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(FGa.TEMP.identity()),this._ikArr)for(Fo=0,Fr=this._ikArr.length;Fo<Fr;Fo++)Fx=this._ikArr[Fo],Fy.hasOwnProperty(Fx.name)&&(Fx.bendDirection=Fy[Fx.name]),Fz.hasOwnProperty(Fx.name)&&(Fx.mix=Fz[Fx.name]),Fx.apply();if(this._pathDic)for(var FA in this._pathDic)(Fw=this._pathDic[FA]).apply(this._boneList,Fc);if(this._tfArr)for(Fo=0,Fq=this._tfArr.length;Fo<Fq;Fo++)this._tfArr[Fo].apply();for(Fo=0,Fq=this._boneList.length;Fo<Fq;Fo++)if(Fj=this._boneList[Fo],Fh=this._bindBoneBoneSlotDic[Fj.name],Fj.resultMatrix.copyTo(this._boneMatrixArray[Fo]),Fh)for(Fp=0,Fr=Fh.length;Fp<Fr;Fp++)(Fg=Fh[Fp])&&Fg.setParentMatrix(Fj.resultMatrix);var FB,FC,FD,FE,FF={},FG=this._templet.deformAniArr;if(FG&&0<FG.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,Fo=0,Fr=this._boneSlotArray.length;Fo<Fr;Fo++)(Fg=this._boneSlotArray[Fo]).deformData=null;var FH,FI=FG[this._aniClipIndex];for(FH in FB=FI.default,this._setDeform(FB,FF,this._boneSlotArray,Fd),FI)"default"!=FH&&FH!=this._skinName&&(FB=FI[FH],this._setDeform(FB,FF,this._boneSlotArray,Fd));FB=FI[this._skinName],this._setDeform(FB,FF,this._boneSlotArray,Fd)}if(this._drawOrder)for(Fo=0,Fr=this._drawOrder.length;Fo<Fr;Fo++)FC=Fu[(Fg=this._boneSlotArray[this._drawOrder[Fo]]).name],FD=Fv[Fg.name],isNaN(FD)||(Fc.save(),Fc.alpha(FD)),isNaN(FC)||-2==FC||(this._templet.attachmentNames?Fg.showDisplayByName(this._templet.attachmentNames[FC]):Fg.showDisplayByIndex(FC)),FF[this._drawOrder[Fo]]?(FE=FF[this._drawOrder[Fo]],Fg.currDisplayData&&FE[Fg.currDisplayData.attachmentName]?Fg.deformData=FE[Fg.currDisplayData.attachmentName]:Fg.deformData=null):Fg.deformData=null,isNaN(FD)?Fg.draw(Fc,this._boneMatrixArray,2==this._aniMode):Fg.draw(Fc,this._boneMatrixArray,2==this._aniMode,FD),isNaN(FD)||Fc.restore();else for(Fo=0,Fr=this._boneSlotArray.length;Fo<Fr;Fo++)FC=Fu[(Fg=this._boneSlotArray[Fo]).name],FD=Fv[Fg.name],isNaN(FD)||(Fc.save(),Fc.alpha(FD)),isNaN(FC)||-2==FC||(this._templet.attachmentNames?Fg.showDisplayByName(this._templet.attachmentNames[FC]):Fg.showDisplayByIndex(FC)),FF[Fo]?(FE=FF[Fo],Fg.currDisplayData&&FE[Fg.currDisplayData.attachmentName]?Fg.deformData=FE[Fg.currDisplayData.attachmentName]:Fg.deformData=null):Fg.deformData=null,isNaN(FD)?Fg.draw(Fc,this._boneMatrixArray,2==this._aniMode):Fg.draw(Fc,this._boneMatrixArray,2==this._aniMode,FD),isNaN(FD)||Fc.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,Fa,Fc):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,Fa,Fc)},Fa._setDeform=function(Fa,Fb,Fc,Fd){if(Fa){var Fe,Ff,Fg,Fh=0,Fi=0,Fj=0;if(Fa)for(Fh=0,Fi=Fa.deformSlotDataList.length;Fh<Fi;Fh++)for(Fe=Fa.deformSlotDataList[Fh],Fj=0;Fj<Fe.deformSlotDisplayList.length;Fj++)Fg=Fc[(Ff=Fe.deformSlotDisplayList[Fj]).slotIndex],Ff.apply(Fd,Fg),Fb[Ff.slotIndex]||(Fb[Ff.slotIndex]={}),Fb[Ff.slotIndex][Ff.attachment]=Ff.deformData}},Fa.getAnimNum=function(){return this._templet.getAnimationCount()},Fa.getAniNameByIndex=function(Fa){return this._templet.getAniNameByIndex(Fa)},Fa.getSlotByName=function(Fa){return this._boneSlotDic[Fa]},Fa.showSkinByName=function(Fa,Fb){void 0===Fb&&(Fb=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(Fa),Fb)},Fa.showSkinByIndex=function(Fa,Fb){void 0===Fb&&(Fb=!0);for(var Fc=0;Fc<this._boneSlotArray.length;Fc++)this._boneSlotArray[Fc].showSlotData(null,Fb);if(this._templet.showSkinByIndex(this._boneSlotDic,Fa,Fb)){var Fd=this._templet.skinDataArray[Fa];this._skinIndex=Fa,this._skinName=Fd.name}this._clearCache()},Fa.showSlotSkinByIndex=function(Fa,Fb){if(0!=this._aniMode){var Fc=this.getSlotByName(Fa);Fc&&Fc.showDisplayByIndex(Fb),this._clearCache()}},Fa.showSlotSkinByName=function(Fa,Fb){if(0!=this._aniMode){var Fc=this.getSlotByName(Fa);Fc&&Fc.showDisplayByName(Fb),this._clearCache()}},Fa.replaceSlotSkinName=function(Fa,Fb,Fc){if(0!=this._aniMode){var Fd=this.getSlotByName(Fa);Fd&&Fd.replaceDisplayByName(Fb,Fc),this._clearCache()}},Fa.replaceSlotSkinByIndex=function(Fa,Fb,Fc){if(0!=this._aniMode){var Fd=this.getSlotByName(Fa);Fd&&Fd.replaceDisplayByIndex(Fb,Fc),this._clearCache()}},Fa.setSlotSkin=function(Fa,Fb){if(0!=this._aniMode){var Fc=this.getSlotByName(Fa);Fc&&Fc.replaceSkin(Fb),this._clearCache()}},Fa._clearCache=function(){if(1==this._aniMode)for(var Fa=0,Fb=this._graphicsCache.length;Fa<Fb;Fa++){for(var Fc=0,Fd=this._graphicsCache[Fa].length;Fc<Fd;Fc++){var Fe=this._graphicsCache[Fa][Fc];Fe!=this.graphics&&FJ.recycle(Fe)}this._graphicsCache[Fa].length=0}},Fa.play=function(Fa,Fb,Fc,Fd,Fe,Ff){void 0===Fc&&(Fc=!0),void 0===Fd&&(Fd=0),void 0===Fe&&(Fe=0),void 0===Ff&&(Ff=!0),this._indexControl=!1;var Fg=-1,Fh=NaN;if(Fh=Fb?2147483647:0,"string"==typeof Fa)for(var Fi=0,Fj=this._templet.getAnimationCount();Fi<Fj;Fi++){var Fm=this._templet.getAnimation(Fi);if(Fm&&Fa==Fm.name){Fg=Fi;break}}else Fg=Fa;-1<Fg&&Fg<this.getAnimNum()&&(this._aniClipIndex=Fg,(Fc||this._pause||this._currAniIndex!=Fg)&&(this._currAniIndex=Fg,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(Fg)),this._drawOrder=null,this._eventIndex=0,this._player.play(Fg,this._player.playbackRate,Fh,Fd,Fe),Ff&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=Fn.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},Fa.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},Fa.playbackRate=function(Fa){this._player&&(this._player.playbackRate=Fa)},Fa.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},Fa.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=Fn.now(),this.timer.frameLoop(1,this,this._update,null,!0))},Fa._getGrahicsDataWithCache=function(Fa,Fb){return this._graphicsCache[Fa][Fb]},Fa._setGrahicsDataWithCache=function(Fa,Fb,Fc){this._graphicsCache[Fa][Fb]=Fc},Fa.destroy=function(Fa){void 0===Fa&&(Fa=!0),Fb.prototype.destroy.call(this,Fa),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},Ff(0,Fa,"url",function(){return this._aniPath},function(Fa){this.load(Fa)}),Ff(0,Fa,"index",function(){return this._index},function(Fa){this.player&&(this._index=Fa,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),Ff(0,Fa,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),Ff(0,Fa,"templet",function(){return this._templet}),Ff(0,Fa,"player",function(){return this._player}),Fc.useSimpleMeshInCanvas=!1,Fc}(Ffa),FD=function(Fb){function Fe(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,Fe.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}Fd(Fe,"laya.ani.bone.Templet",Fb);var Fa=Fe.prototype;return Fa.getLoadList=function(){return this._loadList},Fa.loadAni=function(Fa){this._skBufferUrl=Fa,Fea.loader.load(Fa,Fi.create(this,this.onComplete),null,"arraybuffer")},Fa.onComplete=function(Fa){if(this._isDestroyed)this.destroy();else{var Fb=Fj.getRes(this._skBufferUrl);Fb?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,Fb)):this.event("error","load failed:"+this._skBufferUrl)}},Fa.parseData=function(Fa,Fb,Fc){void 0===Fc&&(Fc=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=Fa,this._mainTexture&&Fs.isWebGL&&Fa.bitmap&&(Fa.bitmap.enableMerageInAtlas=!1),this._rate=Fc,this.parse(Fb)},Fa.buildArmature=function(Fa){return void 0===Fa&&(Fa=0),new FC(this,Fa)},Fa.parse=function(Fa){Fb.prototype.parse.call(this,Fa),this._endLoaded(),this._aniVersion!=Fe.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+Fe.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},Fa._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var Fa=0;this._loadList=[];var Fb,Fc=new FFa(this.getPublicExtData()),Fd=0,Fe=0,Ff=0,Fg=Fc.getInt32(),Fh=Fc.readUTFString(),Fi=Fh.split("\n");for(Fa=0;Fa<Fg;Fa++)Fb=this._path+Fi[2*Fa],Fh=Fi[2*Fa+1],Fc.getFloat32(),Fc.getFloat32(),Fd=Fc.getFloat32(),Fe=Fc.getFloat32(),Ff=Fc.getFloat32(),isNaN(Ff)?0:Ff,Ff=Fc.getFloat32(),isNaN(Ff)?0:Ff,Ff=Fc.getFloat32(),isNaN(Ff)?Fd:Ff,Ff=Fc.getFloat32(),isNaN(Ff)?Fe:Ff,-1==this._loadList.indexOf(Fb)&&this._loadList.push(Fb);this.event("inited",this)}},Fa._textureComplete=function(){for(var Fa,Fb,Fc=0,Fd=this._loadList.length;Fc<Fd;Fc++)Fb=this._loadList[Fc],Fa=this._textureDic[Fb]=Fj.getRes(Fb),Fs.isWebGL&&Fa&&Fa.bitmap&&(Fa.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},Fa._parsePublicExtData=function(){var Fa=0,Fb=0,Fc=0,Fd=0,Fe=0;for(Fa=0,Fe=this.getAnimationCount();Fa<Fe;Fa++)this._graphicsCache.push([]);var Ff;Ff="Dragon"!=this._aniClassName;var Fg,Fh,Fi=new FFa(this.getPublicExtData()),Fj=0,Fm=0,Fn=0,Fo=0,Fp=0,Fq=0,Fr=0,Fs=0,Ft=0,Fu=Fi.getInt32(),Fv=Fi.readUTFString(),Fw=Fv.split("\n");for(Fa=0;Fa<Fu;Fa++){if(Fg=this._mainTexture,Fh=this._path+Fw[2*Fa],Fv=Fw[2*Fa+1],null==this._mainTexture&&(Fg=this._textureDic[Fh]),!Fg)return this.event("error",this),void(this.isParseFail=!0);Fj=Fi.getFloat32(),Fm=Fi.getFloat32(),Fn=Fi.getFloat32(),Fo=Fi.getFloat32(),Ft=Fi.getFloat32(),Fp=isNaN(Ft)?0:Ft,Ft=Fi.getFloat32(),Fq=isNaN(Ft)?0:Ft,Ft=Fi.getFloat32(),Fr=isNaN(Ft)?Fn:Ft,Ft=Fi.getFloat32(),Fs=isNaN(Ft)?Fo:Ft,this.subTextureDic[Fv]=FHa.create(Fg,Fj,Fm,Fn,Fo,-Fp,-Fq,Fr,Fs),Fg.alphaTexture&&(this.subTextureDic[Fv].alphaTexture=FHa.create(Fg.alphaTexture,Fj,Fm,Fn,Fo,-Fp,-Fq,Fr,Fs))}this._mainTexture=Fg;var Fx,Fy,Fz,FA,FB,FC=Fi.getUint16();for(Fa=0;Fa<FC;Fa++)(Fx=[]).push(Fi.getUint16()),Fx.push(Fi.getUint16()),Fx.push(Fi.getUint16()),Fx.push(Fi.getUint16()),this.aniSectionDic[Fa]=Fx;var FD,FE=Fi.getInt16(),FF={};for(Fa=0;Fa<FE;Fa++)Fy=new FIa,0==Fa?FD=Fy:Fy.root=FD,Fy.d=Ff?-1:1,FA=Fi.readUTFString(),FB=Fi.readUTFString(),Fy.length=Fi.getFloat32(),1==Fi.getByte()&&(Fy.inheritRotation=!1),1==Fi.getByte()&&(Fy.inheritScale=!1),Fy.name=FA,FB&&((Fz=FF[FB])?Fz.addChild(Fy):this.mRootBone=Fy),FF[FA]=Fy,this.mBoneArr.push(Fy);this.tMatrixDataLen=Fi.getUint16();var FG,FH,FI=Fi.getUint16(),FJ=Math.floor(FI/this.tMatrixDataLen),FK=this.srcBoneMatrixArr;for(Fa=0;Fa<FJ;Fa++)(FG=new FVa).scX=Fi.getFloat32(),FG.skX=Fi.getFloat32(),FG.skY=Fi.getFloat32(),FG.scY=Fi.getFloat32(),FG.x=Fi.getFloat32(),FG.y=Fi.getFloat32(),8===this.tMatrixDataLen&&(FG.skewX=Fi.getFloat32(),FG.skewY=Fi.getFloat32()),FK.push(FG),(Fy=this.mBoneArr[Fa]).transform=FG;var FL,FM=Fi.getUint16(),FN=0;for(Fa=0;Fa<FM;Fa++){for(FH=new FPa,FN=Fi.getUint16(),Fb=0;Fb<FN;Fb++)FH.boneNames.push(Fi.readUTFString()),FH.boneIndexs.push(Fi.getInt16());FH.name=Fi.readUTFString(),FH.targetBoneName=Fi.readUTFString(),FH.targetBoneIndex=Fi.getInt16(),FH.bendDirection=Fi.getFloat32(),FH.mix=Fi.getFloat32(),FH.isSpine=Ff,this.ikArr.push(FH)}var FO,FP=Fi.getUint16(),FQ=0;for(Fa=0;Fa<FP;Fa++){for(FL=new FUa,FQ=Fi.getUint16(),Fb=0;Fb<FQ;Fb++)FL.boneIndexs.push(Fi.getInt16());FL.name=Fi.getUTFString(),FL.targetIndex=Fi.getInt16(),FL.rotateMix=Fi.getFloat32(),FL.translateMix=Fi.getFloat32(),FL.scaleMix=Fi.getFloat32(),FL.shearMix=Fi.getFloat32(),FL.offsetRotation=Fi.getFloat32(),FL.offsetX=Fi.getFloat32(),FL.offsetY=Fi.getFloat32(),FL.offsetScaleX=Fi.getFloat32(),FL.offsetScaleY=Fi.getFloat32(),FL.offsetShearY=Fi.getFloat32(),this.tfArr.push(FL)}var FR=Fi.getUint16(),FS=0;for(Fa=0;Fa<FR;Fa++){for((FO=new FQa).name=Fi.readUTFString(),FS=Fi.getUint16(),Fb=0;Fb<FS;Fb++)FO.bones.push(Fi.getInt16());FO.target=Fi.readUTFString(),FO.positionMode=Fi.readUTFString(),FO.spacingMode=Fi.readUTFString(),FO.rotateMode=Fi.readUTFString(),FO.offsetRotation=Fi.getFloat32(),FO.position=Fi.getFloat32(),FO.spacing=Fi.getFloat32(),FO.rotateMix=Fi.getFloat32(),FO.translateMix=Fi.getFloat32(),this.pathArr.push(FO)}var FT,FU,FV,FW,FX,FY=0,FZ=0,F$=0,F_=NaN,Fk=0,Fl=Fi.getInt16();for(Fa=0;Fa<Fl;Fa++){var Faa=Fi.getUint8(),Fba={};this.deformAniArr.push(Fba);for(var Fca=0;Fca<Faa;Fca++)for((FT=new FKa).skinName=Fi.getUTFString(),Fba[FT.skinName]=FT,FY=Fi.getInt16(),Fb=0;Fb<FY;Fb++)for(FU=new FLa,FT.deformSlotDataList.push(FU),FZ=Fi.getInt16(),Fc=0;Fc<FZ;Fc++)for(FV=new FMa,FU.deformSlotDisplayList.push(FV),FV.slotIndex=Fi.getInt16(),FV.attachment=Fi.getUTFString(),F$=Fi.getInt16(),Fd=0;Fd<F$;Fd++)for(1==Fi.getByte()?FV.tweenKeyList.push(!0):FV.tweenKeyList.push(!1),F_=Fi.getFloat32(),FV.timeList.push(F_),FW=[],FV.vectices.push(FW),Fk=Fi.getInt16(),Fe=0;Fe<Fk;Fe++)FW.push(Fi.getFloat32())}var Fda,Fea,Ffa=Fi.getInt16(),Fga=0,Fha=0;for(Fa=0;Fa<Ffa;Fa++){for(Fga=Fi.getInt16(),FX=[],Fb=0;Fb<Fga;Fb++){for((Fda=new FNa).time=Fi.getFloat32(),Fha=Fi.getInt16(),Fc=0;Fc<Fha;Fc++)Fda.drawOrder.push(Fi.getInt16());FX.push(Fda)}this.drawOrderAniArr.push(FX)}var Fia,Fja=Fi.getInt16(),Fma=0;for(Fa=0;Fa<Fja;Fa++){for(Fma=Fi.getInt16(),Fea=[],Fb=0;Fb<Fma;Fb++)(Fia=new FOa).name=Fi.getUTFString(),Fia.intValue=Fi.getInt32(),Fia.floatValue=Fi.getFloat32(),Fia.stringValue=Fi.getUTFString(),Fia.time=Fi.getFloat32(),Fea.push(Fia);this.eventAniArr.push(Fea)}var Fna=Fi.getInt16();if(0<Fna)for(this.attachmentNames=[],Fa=0;Fa<Fna;Fa++)this.attachmentNames.push(Fi.getUTFString());var Foa,Fpa,Fqa=Fi.getInt16();for(Fa=0;Fa<Fqa;Fa++)(Foa=new FJa).name=Fi.readUTFString(),Foa.parent=Fi.readUTFString(),Foa.attachmentName=Fi.readUTFString(),Foa.srcDisplayIndex=Foa.displayIndex=Fi.getInt16(),(Foa.templet=this).boneSlotDic[Foa.name]=Foa,null==(Fpa=this.bindBoneBoneSlotDic[Foa.parent])&&(this.bindBoneBoneSlotDic[Foa.parent]=Fpa=[]),Fpa.push(Foa),this.boneSlotArray.push(Foa);var Fra,Fsa,Fta,Fua=Fi.readUTFString().split("\n"),Fva=0,Fwa=Fi.getUint8(),Fxa=0,Fya=0,Fza=0,FAa=0,FBa=0,FCa=0,FDa=0;for(Fa=0;Fa<Fwa;Fa++){for((Fra=new FRa).name=Fua[Fva++],Fxa=Fi.getUint8(),Fb=0;Fb<Fxa;Fb++){for((Fsa=new FTa).name=Fua[Fva++],Foa=this.boneSlotDic[Fsa.name],Fya=Fi.getUint8(),Fc=0;Fc<Fya;Fc++){if(Fta=new FSa,this.skinSlotDisplayDataArr.push(Fta),Fta.name=Fua[Fva++],Fta.attachmentName=Fua[Fva++],Fta.transform=new FVa,Fta.transform.scX=Fi.getFloat32(),Fta.transform.skX=Fi.getFloat32(),Fta.transform.skY=Fi.getFloat32(),Fta.transform.scY=Fi.getFloat32(),Fta.transform.x=Fi.getFloat32(),Fta.transform.y=Fi.getFloat32(),Fsa.displayArr.push(Fta),Fta.width=Fi.getFloat32(),Fta.height=Fi.getFloat32(),Fta.type=Fi.getUint8(),Fta.verLen=Fi.getUint16(),0<(FE=Fi.getUint16()))for(Fta.bones=[],Fd=0;Fd<FE;Fd++){var FEa=Fi.getUint16();Fta.bones.push(FEa)}if(0<(Fza=Fi.getUint16()))for(Fta.uvs=[],Fd=0;Fd<Fza;Fd++)Fta.uvs.push(Fi.getFloat32());if(0<(FAa=Fi.getUint16()))for(Fta.weights=[],Fd=0;Fd<FAa;Fd++)Fta.weights.push(Fi.getFloat32());if(0<(FBa=Fi.getUint16()))for(Fta.triangles=[],Fd=0;Fd<FBa;Fd++)Fta.triangles.push(Fi.getUint16());if(0<(FCa=Fi.getUint16()))for(Fta.vertices=[],Fd=0;Fd<FCa;Fd++)Fta.vertices.push(Fi.getFloat32());if(0<(FDa=Fi.getUint16()))for(Fta.lengths=[],Fd=0;Fd<FDa;Fd++)Fta.lengths.push(Fi.getFloat32())}Fra.slotArr.push(Fsa)}this.skinDic[Fra.name]=Fra,this.skinDataArray.push(Fra)}1==Fi.getUint8()?(this.yReverseMatrix=new FGa(1,0,0,-1,0,0),FD&&FD.setTempMatrix(this.yReverseMatrix)):FD&&FD.setTempMatrix(new FGa),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},Fa.getTexture=function(Fa){var Fb=this.subTextureDic[Fa];return Fb||(Fb=this.subTextureDic[Fa.substr(0,Fa.length-1)]),null==Fb?this._mainTexture:Fb},Fa.showSkinByIndex=function(Fa,Fb,Fc){if(void 0===Fc&&(Fc=!0),Fb<0&&Fb>=this.skinDataArray.length)return!1;var Fd,Fe,Ff=0,Fg=0,Fh=this.skinDataArray[Fb];if(Fh){for(Ff=0,Fg=Fh.slotArr.length;Ff<Fg;Ff++)(Fe=Fh.slotArr[Ff])&&(Fd=Fa[Fe.name])&&(Fd.showSlotData(Fe,Fc),Fc&&"undefined"!=Fd.attachmentName&&"null"!=Fd.attachmentName?Fd.showDisplayByName(Fd.attachmentName):Fd.showDisplayByIndex(Fd.displayIndex));return!0}return!1},Fa.getSkinIndexByName=function(Fa){for(var Fb=0,Fc=this.skinDataArray.length;Fb<Fc;Fb++)if(this.skinDataArray[Fb].name==Fa)return Fb;return-1},Fa.getGrahicsDataWithCache=function(Fa,Fb){return this._graphicsCache[Fa][Fb]},Fa.setGrahicsDataWithCache=function(Fa,Fb,Fc){this._graphicsCache[Fa][Fb]=Fc},Fa.destroy=function(){var Fa;for(var Fb in this._isDestroyed=!0,this.subTextureDic)(Fa=this.subTextureDic[Fb])&&Fa.destroy();for(Fb in this._textureDic)(Fa=this._textureDic[Fb])&&Fa.destroy();for(var Fc=0,Fd=this.skinSlotDisplayDataArr.length;Fc<Fd;Fc++)this.skinSlotDisplayDataArr[Fc].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete Fe.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},Fa.getAniNameByIndex=function(Fa){var Fb=this.getAnimation(Fa);return Fb?Fb.name:null},Ff(0,Fa,"rate",function(){return this._rate},function(Fa){this._rate=Fa}),Fe.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",Fe.TEMPLET_DICTIONARY=null,Fe}(FK)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Fa,Fb){"use strict";for(var Fc in Object.defineProperty(Fb,"__esModule",{value:!0}),Laya){var Fd=Laya[Fc];Fd&&Fd.__isclass&&(Fb[Fc]=Fd)}});