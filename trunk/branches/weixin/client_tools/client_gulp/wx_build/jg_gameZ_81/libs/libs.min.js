var Laya=window.Laya=function(S$j,S$a){var S$G={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(S$a,S$m){return 1==arguments.length?S$G.__presubstr.call(this,S$a):S$G.__presubstr.call(this,S$a,0<S$m?S$m:this.length+S$m)},__init:function(S$a){S$a.forEach(function(S$a){S$a.__init$&&S$a.__init$()})},__isClass:function(S$a){return S$a&&(S$a.__isclass||S$a==Object||S$a==String||S$a==Array)},__newvec:function(S$a,S$m){var S$s=[];S$s.length=S$a;for(var S$P=0;S$P<S$a;S$P++)S$s[S$P]=S$m;return S$s},__extend:function(S$a,S$m){for(var S$s in S$m)if(S$m.hasOwnProperty(S$s)){var S$P=Object.getOwnPropertyDescriptor(S$m,S$s),S$_=S$P.get,S$e=S$P.set;S$_||S$e?S$_&&S$e?Object.defineProperty(S$a,S$s,S$P):(S$_&&Object.defineProperty(S$a,S$s,S$_),S$e&&Object.defineProperty(S$a,S$s,S$e)):S$a[S$s]=S$m[S$s]}function S$A(){S$G.un(this,"constructor",S$a)}S$A.prototype=S$m.prototype,S$a.prototype=new S$A,S$G.un(S$a.prototype,"__imps",S$G.__copy({},S$m.prototype.__imps))},__copy:function(S$a,S$m){if(!S$m)return null;for(var S$s in S$a=S$a||{},S$m)S$a[S$s]=S$m[S$s];return S$a},__package:function(S$a,S$m){if(!S$G.__packages[S$a]){S$G.__packages[S$a]=!0;var S$s=S$j,S$P=S$a.split(".");if(1<S$P.length)for(var S$_=0,S$e=S$P.length-1;S$_<S$e;S$_++){var S$A=S$s[S$P[S$_]];S$s=S$A||(S$s[S$P[S$_]]={})}S$s[S$P[S$P.length-1]]||(S$s[S$P[S$P.length-1]]=S$m||{})}},__hasOwnProperty:function(S$a,S$m){return S$m=S$m||this,Object.hasOwnProperty.call(S$m,S$a)||function S$a(S$m,S$s){if(Object.hasOwnProperty.call(S$s.prototype,S$m))return!0;var S$P=S$s.prototype.__super;return null==S$P?null:S$a(S$m,S$P)}(S$a,S$m.__class)},__typeof:function(S$a,S$m){if(!S$a||!S$m)return!1;if(S$m===String)return"string"==typeof S$a;if(S$m===Number)return"number"==typeof S$a;if(S$m.__interface__)S$m=S$m.__interface__;else if("string"!=typeof S$m)return S$a instanceof S$m;return S$a.__imps&&S$a.__imps[S$m]||S$a.__class==S$m},__as:function(S$a,S$m){return this.__typeof(S$a,S$m)?S$a:null},__int:function(S$a){return S$a?parseInt(S$a):0},interface:function(S$a,S$m){S$G.__package(S$a,{});var S$s=S$G.__internals,S$P=S$s[S$a]=S$s[S$a]||{self:S$a};if(S$m){var S$_=S$m.split(",");S$P.extend=[];for(var S$e=0;S$e<S$_.length;S$e++){var S$A=S$_[S$e];S$s[S$A]=S$s[S$A]||{self:S$A},S$P.extend.push(S$s[S$A])}}var S$B=S$j,S$k=S$a.split(".");for(S$e=0;S$e<S$k.length-1;S$e++)S$B=S$B[S$k[S$e]];S$B[S$k[S$k.length-1]]={__interface__:S$a}},class:function(S$a,S$m,S$s,S$P){if(S$s&&S$G.__extend(S$a,S$s),S$m)if(S$G.__package(S$m,S$a),S$G.__classmap[S$m]=S$a,0<S$m.indexOf(".")){if(0==S$m.indexOf("laya.")){var S$_=S$m.split(".");S$P=S$P||S$_[S$_.length-1],S$G[S$P]&&console.log("Warning!,this class["+S$P+"] already exist:",S$G[S$P]),S$G[S$P]=S$a}}else"Main"==S$m?S$j.Main=S$a:"MainWX"==S$m?S$j.MainWX=S$a:(S$G[S$m]&&console.log("Error!,this class["+S$m+"] already exist:",S$G[S$m]),S$G[S$m]=S$a);var S$e=S$G.un,S$A=S$a.prototype;S$e(S$A,"hasOwnProperty",S$G.__hasOwnProperty),S$e(S$A,"__class",S$a),S$e(S$A,"__super",S$s),S$e(S$A,"__className",S$m),S$e(S$a,"__super",S$s),S$e(S$a,"__className",S$m),S$e(S$a,"__isclass",!0),S$e(S$a,"super",function(S$a){this.__super.call(S$a)})},imps:function(S$a,S$m){if(!S$m)return null;var S$_=S$a.__imps||S$G.un(S$a,"__imps",{});function S$e(S$a){var S$m,S$s;if((S$m=S$G.__internals[S$a])&&(S$_[S$a]=!0,S$s=S$m.extend))for(var S$P=0;S$P<S$s.length;S$P++)S$e(S$s[S$P].self)}for(var S$s in S$m)S$e(S$s)},superSet:function(S$a,S$m,S$s,S$P){var S$_=S$a.prototype["_$set_"+S$s];S$_&&S$_.call(S$m,S$P)},superGet:function(S$a,S$m,S$s){var S$P=S$a.prototype["_$get_"+S$s];return S$P?S$P.call(S$m):null},getset:function(S$a,S$m,S$s,S$P,S$_){S$a?(S$P&&(S$m["_$GET_"+S$s]=S$P),S$_&&(S$m["_$SET_"+S$s]=S$_)):(S$P&&S$G.un(S$m,"_$get_"+S$s,S$P),S$_&&S$G.un(S$m,"_$set_"+S$s,S$_)),S$P&&S$_?Object.defineProperty(S$m,S$s,{get:S$P,set:S$_,enumerable:!1,configurable:!0}):(S$P&&Object.defineProperty(S$m,S$s,{get:S$P,enumerable:!1,configurable:!0}),S$_&&Object.defineProperty(S$m,S$s,{set:S$_,enumerable:!1,configurable:!0}))},static:function(S$s,S$P){for(var S$_=0,S$a=S$P.length;S$_<S$a;S$_+=2)if("length"==S$P[S$_])S$s.length=S$P[S$_+1].call(S$s);else{function S$m(){var S$m=S$P[S$_],S$a=S$P[S$_+1];Object.defineProperty(S$s,S$m,{get:function(){return delete this[S$m],this[S$m]=S$a.call(this)},set:function(S$a){delete this[S$m],this[S$m]=S$a},enumerable:!0,configurable:!0})}S$m()}},un:function(S$a,S$m,S$s){return S$s||(S$s=S$a[S$m]),S$G.__propun.value=S$s,Object.defineProperty(S$a,S$m,S$G.__propun),S$s},uns:function(S$m,S$a){S$a.forEach(function(S$a){S$G.un(S$m,S$a)})}};return S$j.console=S$j.console||{log:function(){}},S$j.trace=S$j.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),S$G}(window,document);!function(S$a,S$m,S$s){S$s.un,S$s.uns,S$s.static,S$s.class,S$s.getset,S$s.__newvec}(window,document,Laya),function(S$A,S$m,S$z){S$z.un,S$z.uns;var S$k=S$z.static,S$G=S$z.class,S$q=S$z.getset;S$z.__newvec;S$z.interface("laya.runtime.IMarket"),S$z.interface("laya.filters.IFilter"),S$z.interface("laya.display.ILayout"),S$z.interface("laya.resource.IDispose"),S$z.interface("laya.runtime.IPlatform"),S$z.interface("laya.resource.IDestroy"),S$z.interface("laya.runtime.IConchNode"),S$z.interface("laya.filters.IFilterAction"),S$z.interface("laya.runtime.ICPlatformClass"),S$z.interface("laya.resource.ICreateResource"),S$z.interface("laya.runtime.IConchRenderObject"),S$z.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var S$V=function(){function S$e(){}return S$G(S$e,"laya.utils.RunDriver"),S$e.FILTER_ACTIONS=[],S$e.pixelRatio=-1,S$e._charSizeTestDiv=null,S$e.now=function(){return Date.now()},S$e.getWindow=function(){return S$A},S$e.getPixelRatio=function(){if(S$e.pixelRatio<0){var S$a=S$L.context,S$m=S$a.backingStorePixelRatio||S$a.webkitBackingStorePixelRatio||S$a.mozBackingStorePixelRatio||S$a.msBackingStorePixelRatio||S$a.oBackingStorePixelRatio||S$a.backingStorePixelRatio||1;(S$e.pixelRatio=(S$L.window.devicePixelRatio||1)/S$m)<1&&(S$e.pixelRatio=1)}return S$e.pixelRatio},S$e.getIncludeStr=function(S$a){return null},S$e.createShaderCondition=function(S$a){var S$m="(function() {return "+S$a+";})";return S$z._runScript(S$m)},S$e.fontMap=[],S$e.measureText=function(S$a,S$m){var S$s=S$e.hanzi.test(S$a);if(S$s&&S$e.fontMap[S$m])return S$e.fontMap[S$m];var S$P=S$L.context;S$P.font=S$m;var S$_=S$P.measureText(S$a);return S$_||(S$_={width:16,height:16}),S$s&&(S$e.fontMap[S$m]=S$_),S$_},S$e.getWebGLContext=function(S$a){},S$e.beginFlush=function(){},S$e.endFinish=function(){},S$e.addToAtlas=null,S$e.flashFlushImage=function(S$a){},S$e.drawToCanvas=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$ca.create("2D"),S$B=new S$X(S$s,S$P,S$A);return S$E.renders[S$m]._fun(S$a,S$B,S$_,S$e),S$A},S$e.createParticleTemplate2D=null,S$e.createGLTextur=null,S$e.createWebGLContext2D=null,S$e.changeWebGLSize=function(S$a,S$m){},S$e.createRenderSprite=function(S$a,S$m){return new S$E(S$a,S$m)},S$e.createFilterAction=function(S$a){return new S$c},S$e.createGraphics=function(){return new S$d},S$e.clear=function(S$a){S$Z._context.ctx.clear()},S$e.cancelLoadByUrl=function(S$a){},S$e.clearAtlas=function(S$a){},S$e.isAtlas=function(S$a){return!1},S$e.addTextureToAtlas=function(S$a){},S$e.getTexturePixels=function(S$a,S$m,S$s,S$P,S$_){return null},S$e.skinAniSprite=function(){return null},S$e.update3DLoop=function(){},S$k(S$e,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),S$e}(),S$P=(S$q(1,S$z,"alertGlobalError",null,function(S$a){var S$e=0;S$L.window.onerror=S$a?function(S$a,S$m,S$s,S$P,S$_){S$e++<5&&S$_&&alert(S$_.stack||S$_)}:null}),S$z.init=function(S$a,S$m,S$s){for(var S$P=[],S$_=2,S$e=arguments.length;S$_<S$e;S$_++)S$P.push(arguments[S$_]);if(!S$z._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=S$z._arrayBufferSlice),S$z._isinit=!0,S$L.__init__(),S$i.__init__(),S$d.__init__(),S$z.timer=new S$Y,S$z.scaleTimer=new S$Y,S$z.loader=new S$ka,S$n.__init__(),S$_=0;for(var S$A=S$P.length;S$_<S$A;S$_++)S$P[S$_].enable&&S$P[S$_].enable();return S$Q.__init__(),S$B.__init__(),S$t.__init__(),S$F.beginCheck(),S$z._currentStage=S$z.stage=new S$Oa,S$z.stage.conchModel&&S$z.stage.conchModel.setRootNode(),S$z._getUrlPath(),S$z.render=new S$Z(0,0),S$z.stage.size(S$a,S$m),S$E.__init__(),S$y.__init__(),S$h.instance.__init__(S$z.stage,S$Z.canvas),S$oa.__init__(),S$K.autoStopMusic=!0,S$C.__init__(),S$Z.canvas}},S$z._getUrlPath=function(){var S$a=S$L.window.location,S$m=S$a.pathname;S$m=S$m&&":"==S$m.charAt(2)?S$m.substring(1):S$m,S$S.rootPath=S$S.basePath=S$S.getPath("file:"==S$a.protocol?S$m:S$a.protocol+"//"+S$a.host+S$a.pathname)},S$z._arrayBufferSlice=function(S$a,S$m){var S$s=new Uint8Array(this,S$a,S$m-S$a),S$P=new Uint8Array(S$s.length);return S$P.set(S$s),S$P.buffer},S$z._runScript=function(S$a){return S$L.window[S$z._evcode](S$a)},S$z.stage=null,S$z.timer=null,S$z.scaleTimer=null,S$z.loader=null,S$z.version="1.8.6",S$z.render=null,S$z._currentStage=null,S$z._isinit=!1,S$z.isDebug=!1,S$z.MiniAdpter={init:function(){S$A.navigator&&S$A.navigator.userAgent&&-1<S$A.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},S$k(S$z,["conchMarket",function(){return this.conchMarket=S$A.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=S$A.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function S$a(){}return S$G(S$a,"Config"),S$a.WebGLTextCacheCount=500,S$a.atlasEnable=!1,S$a.showCanvasMark=!1,S$a.animationInterval=50,S$a.isAntialias=!1,S$a.isAlpha=!1,S$a.premultipliedAlpha=!0,S$a.isStencil=!0,S$a.preserveDrawingBuffer=!1,S$a}()),S$j=function(){function S$j(){this._events=null}S$G(S$j,"laya.events.EventDispatcher");var S$a=S$j.prototype;return S$a.hasListener=function(S$a){return!!(this._events&&this._events[S$a])},S$a.getListener=function(S$a){return this._events?this._events[S$a]:null},S$a.event=function(S$a,S$m){if(!this._events||!this._events[S$a])return!1;var S$s=this._events[S$a];if(S$s.lock)S$s.queue||(S$s.queue=[]),S$s.queue.push(S$m);else{var S$P;for(S$s.lock=!0,S$s.cursor=S$s.head;S$s.cursor;)(S$P=S$s.cursor).recover?(S$s.head=S$s.tail=S$s.cursor=null,console.error("node is recover："+S$P.id)):(S$s.cursor=S$P.next,S$P.once&&S$j.delNode(S$s,S$P),S$P.method&&(null!=S$m?S$P.args?S$P.method.apply(S$P.caller,S$P.args.concat(S$m)):S$m instanceof Array?S$P.method.apply(S$P.caller,S$m):S$P.caller?S$P.method.call(S$P.caller,S$m):S$z.recordError("事件派发错误","node.caller:"+S$P.caller+"node.method:"+S$P.method+"data:"+S$m+"node.prev"+S$P.prev):S$P.method.apply(S$P.caller,S$P.args)),S$P.once&&S$j.recoverHandler(S$P));S$s.lock=!1,!S$s.head&&this._events&&this._events[S$a]==S$s&&delete this._events[S$a],S$s.queue&&S$s.queue.length&&this.event(S$a,S$s.queue.shift())}return!0},S$a.on=function(S$a,S$m,S$s,S$P){return this._createListener(S$a,S$m,S$s,S$P,!1)},S$a.once=function(S$a,S$m,S$s,S$P){return this._createListener(S$a,S$m,S$s,S$P,!0)},S$a._createListener=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$e&&(S$e=!0),S$e&&this.off(S$a,S$m,S$s,S$_);var S$A=S$j.createHandler(S$m||this,S$s,S$P,S$_);this._events||(this._events={});var S$B=this._events,S$k=S$B[S$a];return S$k?S$k.tail?(S$A.prev=S$k.tail,S$k.tail.next=S$A,S$k.tail=S$A):S$k.head=S$k.tail=S$A:S$B[S$a]={head:S$A,tail:S$A,cursor:null,lock:!1},this},S$a.off=function(S$a,S$m,S$s,S$P){if(void 0===S$P&&(S$P=!1),!this._events||!this._events[S$a])return this;for(var S$_=this._events[S$a],S$e=S$_.head;S$e;){if((!S$m||S$e.caller===S$m)&&S$e.method===S$s&&(!S$P||S$e.once)){S$j.delNode(S$_,S$e),S$_.cursor==S$e&&(S$_.cursor=S$e.next),S$j.recoverHandler(S$e);break}S$e=S$e.next}return this},S$a.offAll=function(S$a){var S$m=this._events;if(!S$m)return this;if(S$a)this._recoverHandlers(S$m[S$a]),delete S$m[S$a];else{for(var S$s in S$m)this._recoverHandlers(S$m[S$s]);this._events=null}return this},S$a._recoverHandlers=function(S$a){if(S$a){for(var S$m=S$a.head;S$m;){S$j.delNode(S$a,S$m);var S$s=S$m.next;S$j.recoverHandler(S$m),S$m=S$s}S$a.cursor=null}},S$a.isMouseEvent=function(S$a){return S$j.MOUSE_EVENTS[S$a]},S$j.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},S$j.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},S$j.delNode=function(S$a,S$m){S$m.prev?S$m.prev.next=S$m.next:S$a.head=S$m.next,S$m.next?S$m.next.prev=S$m.prev:S$a.tail=S$m.prev},S$j.createHandler=function(S$a,S$m,S$s,S$P){var S$_=500<S$j._freeHandler.length?S$j._freeHandler.shift():null;if(S$_)if(S$_.recover)S$_.recover=!1,S$_.caller=S$a,S$_.method=S$m,S$_.args=S$s,S$_.once=S$P;else{var S$e="";try{arguments.propertyIsEnumerable.caller}catch(S$a){S$e=S$a.stack}var S$A=S$_.caller?(S$_.caller.__proto__&&S$_.caller.__proto__.constructor&&S$_.caller.__proto__.constructor.name)+"|"+S$_.caller.__className+"|"+S$_.caller.name:"",S$B=S$_.method?S$_.method.name:"";S$z.recordError("EventDispatcher重复创建","caller="+S$A+"  method="+S$B+"  stack="+S$e),S$_={id:++S$j._nodeCount,caller:S$a,method:S$m,args:S$s,once:S$P,recover:!1}}else S$_={id:++S$j._nodeCount,caller:S$a,method:S$m,args:S$s,once:S$P,recover:!1};return S$_.prev=S$_.next=null,S$_},S$j.recoverHandler=function(S$a){if(S$a.recover){if(S$j._errorCount<5){S$j._errorCount++;var S$m="";try{arguments.propertyIsEnumerable.caller}catch(S$a){S$m=S$a.stack}var S$s=S$a.caller?(S$a.caller.__proto__&&S$a.caller.__proto__.constructor&&S$a.caller.__proto__.constructor.name)+"|"+S$a.caller.__className+"|"+S$a.caller.name:"",S$P=S$a.method?S$a.method.name:"";S$z.recordError("EventDispatcher重复回收","id="+S$a.id+"  caller="+S$s+"  method="+S$P+"  stack="+S$m)}S$a.caller=S$a.method=S$a.args=S$a.prev=null}else S$a.recover=!0,S$a.caller=S$a.method=S$a.args=S$a.prev=S$a.next=null,S$j._freeHandler&&S$j._freeHandler.length<3e3&&S$j._freeHandler.push(S$a)},S$j._freeHandler=[],S$j._nodeCount=0,S$j._errorCount=0,S$j}(),S$p=function(){function S$_(S$a,S$m,S$s,S$P){this.once=!1,void(this._id=0)===S$P&&(S$P=!1),this.setTo(S$a,S$m,S$s,S$P)}S$G(S$_,"laya.utils.Handler");var S$a=S$_.prototype;return S$a.setTo=function(S$a,S$m,S$s,S$P){return this._id=S$_._gid++,this.caller=S$a,this.method=S$m,this.args=S$s,this.once=S$P,this},S$a.run=function(){if(null==this.method)return null;var S$a=this._id,S$m=this.method.apply(this.caller,this.args);return this._id===S$a&&this.once&&this.recover(),S$m},S$a.runWith=function(S$a){if(null==this.method)return null;var S$m=this._id;if(null==S$a)var S$s=this.method.apply(this.caller,this.args);else S$s=this.args||S$a.unshift?this.args?this.method.apply(this.caller,this.args.concat(S$a)):this.method.apply(this.caller,S$a):this.method.call(this.caller,S$a);return this._id===S$m&&this.once&&this.recover(),S$s},S$a.clear=function(){return this.caller=null,this.method=null,this.args=null,this},S$a.recover=function(){0<this._id&&(this._id=0,this.clear())},S$_.create=function(S$a,S$m,S$s,S$P){return void 0===S$P&&(S$P=!0),new S$_(S$a,S$m,S$s,S$P)},S$_._gid=1,S$_}(),S$f=function(){function S$a(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}S$G(S$a,"laya.display.BitmapFont");var S$m=S$a.prototype;return S$m.loadFont=function(S$a,S$m){this._path=S$a,this._complete=S$m,S$z.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],S$p.create(this,this.onLoaded))},S$m.onLoaded=function(){this.parseFont(S$Ba.getRes(this._path),S$Ba.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},S$m.parseFont=function(S$a,S$m){if(null!=S$a&&null!=S$m){this._texture=S$m;var S$s=S$a.getElementsByTagName("info");if(!S$s[0].getAttributeNode)return this.parseFont2(S$a,S$m);this.fontSize=parseInt(S$s[0].getAttributeNode("size").nodeValue);var S$P,S$_=S$s[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(S$_[0]),parseInt(S$_[1]),parseInt(S$_[2]),parseInt(S$_[3])],S$P=S$a.getElementsByTagName("char");var S$e=0;for(S$e=0;S$e<S$P.length;S$e++){var S$A=S$P[S$e],S$B=parseInt(S$A.getAttributeNode("id").nodeValue),S$k=parseInt(S$A.getAttributeNode("xoffset").nodeValue)/1,S$j=parseInt(S$A.getAttributeNode("yoffset").nodeValue)/1,S$G=parseInt(S$A.getAttributeNode("xadvance").nodeValue)/1,S$y=new S$l;S$y.x=parseInt(S$A.getAttributeNode("x").nodeValue),S$y.y=parseInt(S$A.getAttributeNode("y").nodeValue),S$y.width=parseInt(S$A.getAttributeNode("width").nodeValue),S$y.height=parseInt(S$A.getAttributeNode("height").nodeValue);var S$d=S$Ga.create(S$m,S$y.x,S$y.y,S$y.width,S$y.height,S$k,S$j);this._maxWidth=Math.max(this._maxWidth,S$G+this.letterSpacing),this._fontCharDic[S$B]=S$d,this._fontWidthMap[S$B]=S$G}}},S$m.parseFont2=function(S$a,S$m){if(null!=S$a&&null!=S$m){this._texture=S$m;var S$s=S$a.getElementsByTagName("info");this.fontSize=parseInt(S$s[0].attributes.size.nodeValue);var S$P=S$s[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(S$P[0]),parseInt(S$P[1]),parseInt(S$P[2]),parseInt(S$P[3])];var S$_=S$a.getElementsByTagName("char"),S$e=0;for(S$e=0;S$e<S$_.length;S$e++){var S$A=S$_[S$e].attributes,S$B=parseInt(S$A.id.nodeValue),S$k=parseInt(S$A.xoffset.nodeValue)/1,S$j=parseInt(S$A.yoffset.nodeValue)/1,S$G=parseInt(S$A.xadvance.nodeValue)/1,S$y=new S$l;S$y.x=parseInt(S$A.x.nodeValue),S$y.y=parseInt(S$A.y.nodeValue),S$y.width=parseInt(S$A.width.nodeValue),S$y.height=parseInt(S$A.height.nodeValue);var S$d=S$Ga.create(S$m,S$y.x,S$y.y,S$y.width,S$y.height,S$k,S$j);this._maxWidth=Math.max(this._maxWidth,S$G+this.letterSpacing),this._fontCharDic[S$B]=S$d,this._fontWidthMap[S$B]=S$G}}},S$m.getCharTexture=function(S$a){return this._fontCharDic[S$a.charCodeAt(0)]},S$m.destroy=function(){if(this._texture){for(var S$a in this._fontCharDic){var S$m=this._fontCharDic[S$a];S$m&&S$m.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},S$m.setSpaceWidth=function(S$a){this._spaceWidth=S$a},S$m.getCharWidth=function(S$a){var S$m=S$a.charCodeAt(0);return this._fontWidthMap[S$m]?this._fontWidthMap[S$m]+this.letterSpacing:" "==S$a?this._spaceWidth+this.letterSpacing:0},S$m.getTextWidth=function(S$a){for(var S$m=0,S$s=0,S$P=S$a.length;S$s<S$P;S$s++)S$m+=this.getCharWidth(S$a.charAt(S$s));return S$m},S$m.getMaxWidth=function(){return this._maxWidth},S$m.getMaxHeight=function(){return this.fontSize},S$m.drawText=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A,S$B=this.getTextWidth(S$a),S$k=0;"center"===S$_&&(S$k=(S$e-S$B)/2),"right"===S$_&&(S$k=S$e-S$B);for(var S$j=0,S$G=0,S$y=S$a.length;S$G<S$y;S$G++)(S$A=this.getCharTexture(S$a.charAt(S$G)))&&(S$m.graphics.drawTexture(S$A,S$s+S$j+S$k,S$P),S$j+=this.getCharWidth(S$a.charAt(S$G)))},S$a}(),S$B=function(){function S$s(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=S$s._TF_EMPTY}S$G(S$s,"laya.display.css.Style");var S$a=S$s.prototype;return S$a.getTransform=function(){return this._tf},S$a.setTransform=function(S$a){this._tf="none"!==S$a&&S$a?S$a:S$s._TF_EMPTY},S$a.setTranslateX=function(S$a){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.translateX=S$a},S$a.setTranslateY=function(S$a){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.translateY=S$a},S$a.setScaleX=function(S$a){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.scaleX=S$a},S$a.setScale=function(S$a,S$m){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.scaleX=S$a,this._tf.scaleY=S$m},S$a.setScaleY=function(S$a){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.scaleY=S$a},S$a.setRotate=function(S$a){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.rotate=S$a},S$a.setSkewX=function(S$a){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.skewX=S$a},S$a.setSkewY=function(S$a){this._tf===S$s._TF_EMPTY&&(this._tf=new S$_),this._tf.skewY=S$a},S$a.destroy=function(){this.scrollRect=null},S$a.render=function(S$a,S$m,S$s,S$P){},S$a.getCSSStyle=function(){return S$ma.EMPTY},S$a._enableLayout=function(){return!1},S$q(0,S$a,"scaleX",function(){return this._tf.scaleX},function(S$a){this.setScaleX(S$a)}),S$q(0,S$a,"transform",function(){return this.getTransform()},function(S$a){this.setTransform(S$a)}),S$q(0,S$a,"translateX",function(){return this._tf.translateX},function(S$a){this.setTranslateX(S$a)}),S$q(0,S$a,"translateY",function(){return this._tf.translateY},function(S$a){this.setTranslateY(S$a)}),S$q(0,S$a,"scaleY",function(){return this._tf.scaleY},function(S$a){this.setScaleY(S$a)}),S$q(0,S$a,"block",function(){return 0!=(1&this._type)}),S$q(0,S$a,"skewY",function(){return this._tf.skewY},function(S$a){this.setSkewY(S$a)}),S$q(0,S$a,"rotate",function(){return this._tf.rotate},function(S$a){this.setRotate(S$a)}),S$q(0,S$a,"skewX",function(){return this._tf.skewX},function(S$a){this.setSkewX(S$a)}),S$q(0,S$a,"paddingLeft",function(){return 0}),S$q(0,S$a,"paddingTop",function(){return 0}),S$q(0,S$a,"absolute",function(){return!0}),S$s.__init__=function(){S$s._TF_EMPTY=new S$_,S$s.EMPTY=new S$s},S$s.EMPTY=null,S$s._TF_EMPTY=null,S$s}(),S$Q=function(){function S$m(S$a){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=S$M.create(S$m.defaultColor),this.family=S$m.defaultFamily,this.stroke=S$m._STROKE,this.size=S$m.defaultSize,S$a&&S$a!==S$m.EMPTY&&S$a.copyTo(this)}S$G(S$m,"laya.display.css.Font");var S$a=S$m.prototype;return S$a.set=function(S$a){this._text=null;for(var S$m=S$a.split(" "),S$s=0,S$P=S$m.length;S$s<S$P;S$s++){var S$_=S$m[S$s];switch(S$_){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<S$_.indexOf("px")&&(this.size=parseInt(S$_),this.family=S$m[S$s+1],S$s++)}},S$a.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},S$a.copyTo=function(S$a){S$a._type=this._type,S$a._text=this._text,S$a._weight=this._weight,S$a._color=this._color,S$a.family=this.family,S$a.stroke=this.stroke!=S$m._STROKE?this.stroke.slice():S$m._STROKE,S$a.indent=this.indent,S$a.size=this.size},S$q(0,S$a,"password",function(){return 0!=(1024&this._type)},function(S$a){S$a?this._type|=1024:this._type&=-1025}),S$q(0,S$a,"color",function(){return this._color.strColor},function(S$a){this._color=S$M.create(S$a)}),S$q(0,S$a,"italic",function(){return 0!=(512&this._type)},function(S$a){S$a?this._type|=512:this._type&=-513}),S$q(0,S$a,"bold",function(){return 0!=(2048&this._type)},function(S$a){S$a?this._type|=2048:this._type&=-2049}),S$q(0,S$a,"weight",function(){return""+this._weight},function(S$a){var S$m=0;switch(S$a){case"normal":break;case"bold":this.bold=!0,S$m=700;break;case"bolder":S$m=800;break;case"lighter":S$m=100;break;default:S$m=parseInt(S$a)}this._weight=S$m,this._text=null}),S$q(0,S$a,"decoration",function(){return this._decoration?this._decoration.value:null},function(S$a){var S$m=S$a.split(" ");switch(this._decoration||(this._decoration={}),S$m[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=S$m[0]}S$m[1]&&(this._decoration.color=S$M.create(S$m)),this._decoration.value=S$a}),S$m.__init__=function(){S$m.EMPTY=new S$m(null)},S$m.EMPTY=null,S$m.defaultColor="#000000",S$m.defaultSize=12,S$m.defaultFamily="Arial",S$m.defaultFont="12px Arial",S$m._STROKE=[0,"#000000"],S$m._ITALIC=512,S$m._PASSWORD=1024,S$m._BOLD=2048,S$m}(),S$_=function(){function S$a(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return S$G(S$a,"laya.display.css.TransformInfo"),S$a}(),S$d=function(){function S$y(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,S$Z.isConchNode){this._nativeObj=new S$A._conchGraphics,this.id=this._nativeObj.conchID}}S$G(S$y,"laya.display.Graphics");var S$a=S$y.prototype;return S$a.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},S$a.clear=function(S$a){void 0===S$a&&(S$a=!1);var S$m=0,S$s=0;if(S$a){var S$P=this._one;if(this._cmds){for(S$s=this._cmds.length,S$m=0;S$m<S$s;S$m++)!(S$P=this._cmds[S$m])||S$P.callee!==S$Z._context._drawTexture&&S$P.callee!==S$Z._context._drawTextureWithTransform||(S$P[0]=null,S$y._cache.push(S$P));this._cmds.length=0}else S$P&&(!S$P||S$P.callee!==S$Z._context._drawTexture&&S$P.callee!==S$Z._context._drawTextureWithTransform||(S$P[0]=null,S$y._cache.push(S$P)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(S$m=0,S$s=this._vectorgraphArray.length;S$m<S$s;S$m++)S$$.getInstance().deleteShape(this._vectorgraphArray[S$m]);this._vectorgraphArray.length=0}},S$a._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},S$a._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new S$s,this._graphicBounds._graphics=this)},S$a._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},S$a._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},S$a.getBounds=function(S$a){return void 0===S$a&&(S$a=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(S$a)},S$a.getBoundPoints=function(S$a){return void 0===S$a&&(S$a=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(S$a)},S$a._addCmd=function(S$a){this._cmds=this._cmds||[],S$a.callee=S$a.shift(),this._cmds.push(S$a)},S$a.setFilters=function(S$a){this._saveToCmd(S$Z._context._setFilters,S$a)},S$a.drawTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){if(void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),void 0===S$A&&(S$A=1),!S$a||S$A<.01)return null;S$P||(S$P=S$a.sourceWidth),S$_||(S$_=S$a.sourceHeight),S$A=S$A<0?0:1<S$A?1:S$A;var S$B,S$k=!S$Z.isWebGL&&(S$L.onFirefox||S$L.onEdge||S$L.onIE||S$L.onSafari)?.5:0,S$j=S$P/S$a.sourceWidth,S$G=S$_/S$a.sourceHeight;return S$P=S$a.width*S$j,S$_=S$a.height*S$G,S$a.loaded&&(S$P<=0||S$_<=0)?null:(S$m+=S$a.offsetX*S$j,S$s+=S$a.offsetY*S$G,this._sp&&(this._sp._renderType|=512),S$m-=S$k,S$s-=S$k,S$P+=2*S$k,S$_+=2*S$k,S$y._cache.length?((S$B=S$y._cache.pop())[0]=S$a,S$B[1]=S$m,S$B[2]=S$s,S$B[3]=S$P,S$B[4]=S$_,S$B[5]=S$e,S$B[6]=S$A):S$B=[S$a,S$m,S$s,S$P,S$_,S$e,S$A],S$B.callee=S$e||1!=S$A?S$Z._context._drawTextureWithTransform:S$Z._context._drawTexture,null!=this._one||S$e||1!=S$A?this._saveToCmd(S$B.callee,S$B):(this._one=S$B,this._render=this._renderOneImg),S$a.loaded||S$a.once("loaded",this,this._textureLoaded,[S$a,S$B]),this._repaint(),S$B)},S$a.cleanByTexture=function(S$a,S$m,S$s,S$P,S$_){if(void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),!S$a)return this.clear();if(this._one&&this._render===this._renderOneImg){S$P||(S$P=S$a.sourceWidth),S$_||(S$_=S$a.sourceHeight);var S$e=S$P/S$a.sourceWidth,S$A=S$_/S$a.sourceHeight;S$P=S$a.width*S$e,S$_=S$a.height*S$A,S$m+=S$a.offsetX*S$e,S$s+=S$a.offsetY*S$A,this._one[0]=S$a,this._one[1]=S$m,this._one[2]=S$s,this._one[3]=S$P,this._one[4]=S$_,this._repaint()}else this.clear(),S$a&&this.drawTexture(S$a,S$m,S$s,S$P,S$_)},S$a.drawTextures=function(S$a,S$m){S$a&&this._saveToCmd(S$Z._context._drawTextures,[S$a,S$m])},S$a.fillTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){if(void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),void 0===S$e&&(S$e="repeat"),S$a){var S$B=[S$a,S$m,S$s,S$P,S$_,S$e,S$A||S$U.EMPTY,{}];S$a.loaded||S$a.once("loaded",this,this._textureLoaded,[S$a,S$B]),this._saveToCmd(S$Z._context._fillTexture,S$B)}},S$a._textureLoaded=function(S$a,S$m){S$m[3]=S$m[3]||S$a.width,S$m[4]=S$m[4]||S$a.height,this._repaint()},S$a.fillCircle=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$s.bitmap.enableMerageInAtlas=!1;var S$B=new Float32Array(2*(S$A+1)),S$k=new Float32Array(2*(S$A+1)),S$j=new Uint16Array(3*S$A),S$G=2*Math.PI/S$A,S$y=0;S$B[0]=S$P,S$B[1]=S$_,S$k[0]=S$P/S$s.width,S$k[1]=S$_/S$s.height;for(var S$d=2,S$Q=0;S$Q<S$A;S$Q++){var S$q=S$e*Math.cos(S$y)+S$P,S$h=S$e*Math.sin(S$y)+S$_;S$B[S$d]=S$q,S$B[S$d+1]=S$h,S$k[S$d]=S$q/S$s.width,S$k[S$d+1]=S$h/S$s.height,S$y+=S$G,S$d+=2}for(S$Q=S$d=0;S$Q<S$A;S$Q++)S$j[S$d++]=0,S$j[S$d++]=S$Q+1,S$j[S$d++]=S$A+1<=S$Q+2?1:S$Q+2;this.drawTriangles(S$s,S$a,S$m,S$B,S$k,S$j)},S$a.drawTriangles=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){void 0===S$B&&(S$B=1),this._saveToCmd(S$Z._context.drawTriangles,[S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j])},S$a._saveToCmd=function(S$a,S$m){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=S$m,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(S$m)),S$m.callee=S$a,this._repaint(),S$m},S$a.clipRect=function(S$a,S$m,S$s,S$P){this._saveToCmd(S$Z._context._clipRect,[S$a,S$m,S$s,S$P])},S$a.fillText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){void 0===S$A&&(S$A=0),this._saveToCmd(S$Z._context._fillText,[S$a,S$m,S$s,S$P||S$Q.defaultFont,S$_,S$e])},S$a.fillBorderText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){this._saveToCmd(S$Z._context._fillBorderText,[S$a,S$m,S$s,S$P||S$Q.defaultFont,S$_,S$e,S$A,S$B])},S$a.strokeText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._saveToCmd(S$Z._context._strokeText,[S$a,S$m,S$s,S$P||S$Q.defaultFont,S$_,S$e,S$A])},S$a.alpha=function(S$a){S$a=S$a<0?0:1<S$a?1:S$a,this._saveToCmd(S$Z._context._alpha,[S$a])},S$a.setAlpha=function(S$a){S$a=S$a<0?0:1<S$a?1:S$a,this._saveToCmd(S$Z._context._setAlpha,[S$a])},S$a.transform=function(S$a,S$m,S$s){void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),this._saveToCmd(S$Z._context._transform,[S$a,S$m,S$s])},S$a.rotate=function(S$a,S$m,S$s){void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),this._saveToCmd(S$Z._context._rotate,[S$a,S$m,S$s])},S$a.scale=function(S$a,S$m,S$s,S$P){void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0),this._saveToCmd(S$Z._context._scale,[S$a,S$m,S$s,S$P])},S$a.translate=function(S$a,S$m){this._saveToCmd(S$Z._context._translate,[S$a,S$m])},S$a.save=function(){this._saveToCmd(S$Z._context._save,[])},S$a.restore=function(){this._saveToCmd(S$Z._context._restore,[])},S$a.replaceText=function(S$a){this._repaint();var S$m=this._cmds;if(S$m){for(var S$s=S$m.length-1;-1<S$s;S$s--)if(this._isTextCmd(S$m[S$s].callee))return S$m[S$s][0].toUpperCase?S$m[S$s][0]=S$a:S$m[S$s][0].setText(S$a),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=S$a:this._one[0].setText(S$a),!0;return!1},S$a._isTextCmd=function(S$a){return S$a===S$Z._context._fillText||S$a===S$Z._context._fillBorderText||S$a===S$Z._context._strokeText},S$a.replaceTextColor=function(S$a){this._repaint();var S$m=this._cmds;if(S$m)for(var S$s=S$m.length-1;-1<S$s;S$s--)this._isTextCmd(S$m[S$s].callee)&&(S$m[S$s][4]=S$a,S$m[S$s][0].toUpperCase||(S$m[S$s][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=S$a,this._one[0].toUpperCase||(this._one[0].changed=!0))},S$a.loadImage=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=this;void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0);var S$B=S$Ba.getRes(S$a);function S$k(S$a){S$a&&(S$A.drawTexture(S$a,S$m,S$s,S$P,S$_),null!=S$e&&S$e.call(S$A._sp,S$a))}S$B?S$k(S$B):S$z.loader.load(S$a,S$p.create(null,S$k),null,"image")},S$a._renderEmpty=function(S$a,S$m,S$s,S$P){},S$a._renderAll=function(S$a,S$m,S$s,S$P){for(var S$_,S$e=this._cmds,S$A=0,S$B=S$e.length;S$A<S$B;S$A++)(S$_=S$e[S$A]).callee.call(S$m,S$s,S$P,S$_)},S$a._renderOne=function(S$a,S$m,S$s,S$P){this._one.callee.call(S$m,S$s,S$P,this._one)},S$a._renderOneImg=function(S$a,S$m,S$s,S$P){this._one.callee.call(S$m,S$s,S$P,this._one),2305!==S$a._renderType&&(S$a._renderType|=1)},S$a.drawLine=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$e&&(S$e=1);var S$A=0;S$Z.isWebGL&&(S$A=S$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(S$A));var S$B=S$e%2==0?0:.5,S$k=[S$a+S$B,S$m+S$B,S$s+S$B,S$P+S$B,S$_,S$e,S$A];this._saveToCmd(S$Z._context._drawLine,S$k)},S$a.drawLines=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=1);var S$e=0;if(S$s&&!(S$s.length<4)){S$Z.isWebGL&&(S$e=S$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(S$e));var S$A=S$_%2==0?0:.5,S$B=[S$a+S$A,S$m+S$A,S$s,S$P,S$_,S$e];this._saveToCmd(S$Z._context._drawLines,S$B)}},S$a.drawCurves=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=1);var S$e=[S$a,S$m,S$s,S$P,S$_];this._saveToCmd(S$Z._context._drawCurves,S$e)},S$a.drawRect=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){void 0===S$A&&(S$A=1);var S$B=S$e?S$A/2:0,S$k=S$e?S$A:0,S$j=[S$a+S$B,S$m+S$B,S$s-S$k,S$P-S$k,S$_,S$e,S$A];this._saveToCmd(S$Z._context._drawRect,S$j)},S$a.drawCircle=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$e&&(S$e=1);var S$A=S$_?S$e/2:0,S$B=0;S$Z.isWebGL&&(S$B=S$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(S$B));var S$k=[S$a,S$m,S$s-S$A,S$P,S$_,S$e,S$B];this._saveToCmd(S$Z._context._drawCircle,S$k)},S$a.drawPie=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){void 0===S$B&&(S$B=1);var S$k=S$A?S$B/2:0,S$j=S$A?S$B:0,S$G=0;S$Z.isWebGL&&(S$G=S$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(S$G));var S$y=[S$a+S$k,S$m+S$k,S$s-S$j,S$P,S$_,S$e,S$A,S$B,S$G];S$y[3]=S$I.toRadian(S$P),S$y[4]=S$I.toRadian(S$_),this._saveToCmd(S$Z._context._drawPie,S$y)},S$a.drawPoly=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$e&&(S$e=1);var S$A=0,S$B=!1;S$Z.isWebGL&&(S$A=S$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(S$A),S$B=!(6<S$s.length));var S$k=S$_?S$e%2==0?0:.5:0,S$j=[S$a+S$k,S$m+S$k,S$s,S$P,S$_,S$e,S$A,S$B];this._saveToCmd(S$Z._context._drawPoly,S$j)},S$a.drawPath=function(S$a,S$m,S$s,S$P,S$_){var S$e=[S$a,S$m,S$s,S$P,S$_];this._saveToCmd(S$Z._context._drawPath,S$e)},S$q(0,S$a,"cmds",function(){return this._cmds},function(S$a){this._sp&&(this._sp._renderType|=512),this._cmds=S$a,this._render=this._renderAll,this._repaint()}),S$y.__init__=function(){if(S$Z.isConchNode){for(var S$a=laya.display.Graphics.prototype,S$m=S$L.window.ConchGraphics.prototype,S$s=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],S$P=0,S$_=S$s.length;S$P<=S$_;S$P++){var S$e=S$s[S$P];S$a[S$e]=S$m[S$e]}S$a._saveToCmd=null,S$m.drawImageS&&(S$a.drawTextures=function(S$a,S$m){if(S$a&&S$a.loaded&&S$a.bitmap&&S$a.source){var S$s=S$a.uv,S$P=S$a.bitmap.width,S$_=S$a.bitmap.height;this.drawImageS(S$a.bitmap.source,S$s[0]*S$P,S$s[1]*S$_,(S$s[2]-S$s[0])*S$P,(S$s[5]-S$s[3])*S$_,S$a.offsetX,S$a.offsetY,S$a.width,S$a.height,S$m)}}),S$a.drawTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){if(void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),void 0===S$A&&(S$A=1),S$a)if(S$a.loaded){if(S$a.loaded&&S$a.bitmap&&S$a.source&&(S$P||(S$P=S$a.sourceWidth),S$_||(S$_=S$a.sourceHeight),S$A=S$A<0?0:1<S$A?1:S$A,S$P=S$P-S$a.sourceWidth+S$a.width,S$_=S$_-S$a.sourceHeight+S$a.height,!(S$P<=0||S$_<=0))){S$m+=S$a.offsetX,S$s+=S$a.offsetY;var S$B=S$a.uv,S$k=S$a.bitmap.width,S$j=S$a.bitmap.height;S$B[4]<S$B[0]&&S$B[5]<S$B[1]?this.drawImageM(S$a.bitmap.source,S$B[4]*S$k,S$B[5]*S$j,(S$B[0]-S$B[4])*S$k,(S$B[1]-S$B[5])*S$j,S$m,S$s,S$P,S$_,S$e,S$A):this.drawImageM(S$a.bitmap.source,S$B[0]*S$k,S$B[1]*S$j,(S$B[2]-S$B[0])*S$k,(S$B[5]-S$B[3])*S$j,S$m,S$s,S$P,S$_,S$e,S$A),this._repaint()}}else S$a.once("loaded",this,function(){this.drawTexture(S$a,S$m,S$s,S$P,S$_,S$e)})},S$a.fillTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){if(void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),void 0===S$e&&(S$e="repeat"),S$a&&S$a.loaded){var S$B,S$k=S$Z._context.ctx,S$j=S$a.bitmap.width,S$G=S$a.bitmap.height,S$y=S$a.uv;S$B=S$a.uv!=S$Ga.DEF_UV?S$k.createPattern(S$a.bitmap.source,S$e,S$y[0]*S$j,S$y[1]*S$G,(S$y[2]-S$y[0])*S$j,(S$y[5]-S$y[3])*S$G):S$k.createPattern(S$a.bitmap.source,S$e);var S$d=0,S$Q=0;S$A&&(S$m+=S$A.x%S$a.width,S$s+=S$A.y%S$a.height,S$d-=S$A.x%S$a.width,S$Q-=S$A.y%S$a.height),this._fillImage(S$B,S$m,S$s,S$d,S$Q,S$P,S$_)}}}},S$y._cache=[],S$y}(),S$s=function(){function S$c(){this._cacheBoundsType=!1}S$G(S$c,"laya.display.GraphicsBounds");var S$a=S$c.prototype;return S$a.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},S$a.reset=function(){this._temp&&(this._temp.length=0)},S$a.getBounds=function(S$a){return void 0===S$a&&(S$a=!1),(!this._bounds||!this._temp||this._temp.length<1||S$a!=this._cacheBoundsType)&&(this._bounds=S$l._getWrapRec(this.getBoundPoints(S$a),this._bounds)),this._cacheBoundsType=S$a,this._bounds},S$a.getBoundPoints=function(S$a){return void 0===S$a&&(S$a=!1),(!this._temp||this._temp.length<1||S$a!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(S$a)),this._cacheBoundsType=S$a,this._rstBoundPoints=S$I.copyArray(this._rstBoundPoints,this._temp)},S$a._getCmdPoints=function(S$a){void 0===S$a&&(S$a=!1);var S$m,S$s,S$P=S$Z._context,S$_=this._graphics.cmds;if((S$m=this._temp||(this._temp=[])).length=0,S$_||null==this._graphics._one||(S$c._tempCmds.length=0,S$c._tempCmds.push(this._graphics._one),S$_=S$c._tempCmds),!S$_)return S$m;(S$s=S$c._tempMatrixArrays).length=0;var S$e=S$c._initMatrix;S$e.identity();for(var S$A,S$B,S$k=S$c._tempMatrix,S$j=NaN,S$G=NaN,S$y=NaN,S$d=NaN,S$Q=NaN,S$q=NaN,S$h=0,S$u=S$_.length;S$h<S$u;S$h++)if((S$A=S$_[S$h]).callee)switch(S$A.callee){case S$P._save:case 7:S$s.push(S$e),S$e=S$e.clone();break;case S$P._restore:case 8:S$e=S$s.pop();break;case S$P._scale:case 5:S$k.identity(),S$k.translate(-S$A[2],-S$A[3]),S$k.scale(S$A[0],S$A[1]),S$k.translate(S$A[2],S$A[3]),this._switchMatrix(S$e,S$k);break;case S$P._rotate:case 3:S$k.identity(),S$k.translate(-S$A[1],-S$A[2]),S$k.rotate(S$A[0]),S$k.translate(S$A[1],S$A[2]),this._switchMatrix(S$e,S$k);break;case S$P._translate:case 6:S$k.identity(),S$k.translate(S$A[0],S$A[1]),this._switchMatrix(S$e,S$k);break;case S$P._transform:case 4:S$k.identity(),S$k.translate(-S$A[1],-S$A[2]),S$k.concat(S$A[0]),S$k.translate(S$A[1],S$A[2]),this._switchMatrix(S$e,S$k);break;case 16:case 24:S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[0],S$A[1],S$A[2],S$A[3]),S$e);break;case 17:S$e.copyTo(S$k),S$k.concat(S$A[4]),S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[0],S$A[1],S$A[2],S$A[3]),S$k);break;case S$P._drawTexture:S$B=S$A[0],S$a?S$A[3]&&S$A[4]?S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1],S$A[2],S$A[3],S$A[4]),S$e):(S$B=S$A[0],S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1],S$A[2],S$B.width,S$B.height),S$e)):(S$j=(S$A[3]||S$B.sourceWidth)/S$B.width,S$G=(S$A[4]||S$B.sourceHeight)/S$B.height,S$y=S$j*S$B.sourceWidth,S$d=S$G*S$B.sourceHeight,S$Q=0<S$B.offsetX?S$B.offsetX:0,S$q=0<S$B.offsetY?S$B.offsetY:0,S$Q*=S$j,S$q*=S$G,S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1]-S$Q,S$A[2]-S$q,S$y,S$d),S$e));break;case S$P._fillTexture:S$A[3]&&S$A[4]?S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1],S$A[2],S$A[3],S$A[4]),S$e):(S$B=S$A[0],S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1],S$A[2],S$B.width,S$B.height),S$e));break;case S$P._drawTextureWithTransform:var S$O;S$O=S$A[5]?(S$e.copyTo(S$k),S$k.concat(S$A[5]),S$k):S$e,S$a?S$A[3]&&S$A[4]?S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1],S$A[2],S$A[3],S$A[4]),S$O):(S$B=S$A[0],S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1],S$A[2],S$B.width,S$B.height),S$O)):(S$B=S$A[0],S$j=(S$A[3]||S$B.sourceWidth)/S$B.width,S$G=(S$A[4]||S$B.sourceHeight)/S$B.height,S$y=S$j*S$B.sourceWidth,S$d=S$G*S$B.sourceHeight,S$Q=0<S$B.offsetX?S$B.offsetX:0,S$q=0<S$B.offsetY?S$B.offsetY:0,S$Q*=S$j,S$q*=S$G,S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[1]-S$Q,S$A[2]-S$q,S$y,S$d),S$O));break;case S$P._drawRect:case 13:S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[0],S$A[1],S$A[2],S$A[3]),S$e);break;case S$P._drawCircle:case S$P._fillCircle:case 14:S$c._addPointArrToRst(S$m,S$l._getBoundPointS(S$A[0]-S$A[2],S$A[1]-S$A[2],S$A[2]+S$A[2],S$A[2]+S$A[2]),S$e);break;case S$P._drawLine:case 20:S$c._tempPoints.length=0;var S$p;S$p=.5*S$A[5],S$A[0]==S$A[2]?S$c._tempPoints.push(S$A[0]+S$p,S$A[1],S$A[2]+S$p,S$A[3],S$A[0]-S$p,S$A[1],S$A[2]-S$p,S$A[3]):S$A[1]==S$A[3]?S$c._tempPoints.push(S$A[0],S$A[1]+S$p,S$A[2],S$A[3]+S$p,S$A[0],S$A[1]-S$p,S$A[2],S$A[3]-S$p):S$c._tempPoints.push(S$A[0],S$A[1],S$A[2],S$A[3]),S$c._addPointArrToRst(S$m,S$c._tempPoints,S$e);break;case S$P._drawCurves:case 22:S$c._addPointArrToRst(S$m,S$H.I.getBezierPoints(S$A[2]),S$e,S$A[0],S$A[1]);break;case S$P._drawPoly:case S$P._drawLines:case 18:S$c._addPointArrToRst(S$m,S$A[2],S$e,S$A[0],S$A[1]);break;case S$P._drawPath:case 19:S$c._addPointArrToRst(S$m,this._getPathPoints(S$A[2]),S$e,S$A[0],S$A[1]);break;case S$P._drawPie:case 15:S$c._addPointArrToRst(S$m,this._getPiePoints(S$A[0],S$A[1],S$A[2],S$A[3],S$A[4]),S$e)}return 200<S$m.length?S$m=S$I.copyArray(S$m,S$l._getWrapRec(S$m)._getBoundPoints()):8<S$m.length&&(S$m=S$o.scanPList(S$m)),S$m},S$a._switchMatrix=function(S$a,S$m){S$m.concat(S$a),S$m.copyTo(S$a)},S$a._getPiePoints=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$c._tempPoints;S$c._tempPoints.length=0,S$e.push(S$a,S$m);var S$A=(S$_-S$P)%(2*Math.PI)/10,S$B=NaN,S$k=S$P;for(S$B=0;S$B<=10;S$B++)S$e.push(S$a+S$s*Math.cos(S$k),S$m+S$s*Math.sin(S$k)),S$k+=S$A;return S$e},S$a._getPathPoints=function(S$a){var S$m,S$s,S$P=0,S$_=S$c._tempPoints;for(S$_.length=0,S$m=S$a.length,S$P=0;S$P<S$m;S$P++)1<(S$s=S$a[S$P]).length&&(S$_.push(S$s[1],S$s[2]),3<S$s.length&&S$_.push(S$s[3],S$s[4]));return S$_},S$c._addPointArrToRst=function(S$a,S$m,S$s,S$P,S$_){void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0);var S$e,S$A=0;for(S$e=S$m.length,S$A=0;S$A<S$e;S$A+=2)S$c._addPointToRst(S$a,S$m[S$A]+S$P,S$m[S$A+1]+S$_,S$s)},S$c._addPointToRst=function(S$a,S$m,S$s,S$P){var S$_=S$U.TEMP;S$_.setTo(S$m||0,S$s||0),S$P.transformPoint(S$_),S$a.push(S$_.x,S$_.y)},S$c._tempPoints=[],S$c._tempMatrixArrays=[],S$c._tempCmds=[],S$k(S$c,["_tempMatrix",function(){return this._tempMatrix=new S$W},"_initMatrix",function(){return this._initMatrix=new S$W}]),S$c}(),S$e=function(){function S$a(){}S$G(S$a,"laya.events.Event");var S$m=S$a.prototype;return S$m.setTo=function(S$a,S$m,S$s){return this.type=S$a,this.currentTarget=S$m,this.target=S$s,this},S$m.stopPropagation=function(){this._stoped=!0},S$q(0,S$m,"stageY",function(){return S$z.stage.mouseY}),S$q(0,S$m,"charCode",function(){return this.nativeEvent.charCode}),S$q(0,S$m,"touches",function(){var S$a=this.nativeEvent.touches;if(S$a)for(var S$m=S$z.stage,S$s=0,S$P=S$a.length;S$s<S$P;S$s++){var S$_=S$a[S$s],S$e=S$U.TEMP;S$e.setTo(S$_.clientX,S$_.clientY),S$m._canvasTransform.invertTransformPoint(S$e),S$m.transform.invertTransformPoint(S$e),S$_.stageX=S$e.x,S$_.stageY=S$e.y}return S$a}),S$q(0,S$m,"keyLocation",function(){return this.nativeEvent.keyLocation}),S$q(0,S$m,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),S$q(0,S$m,"altKey",function(){return this.nativeEvent.altKey}),S$q(0,S$m,"shiftKey",function(){return this.nativeEvent.shiftKey}),S$q(0,S$m,"stageX",function(){return S$z.stage.mouseX}),S$a.EMPTY=new S$a,S$a.MOUSE_DOWN="mousedown",S$a.MOUSE_UP="mouseup",S$a.CLICK="click",S$a.RIGHT_MOUSE_DOWN="rightmousedown",S$a.RIGHT_MOUSE_UP="rightmouseup",S$a.RIGHT_CLICK="rightclick",S$a.MOUSE_MOVE="mousemove",S$a.MOUSE_OVER="mouseover",S$a.MOUSE_OUT="mouseout",S$a.MOUSE_WHEEL="mousewheel",S$a.ROLL_OVER="mouseover",S$a.ROLL_OUT="mouseout",S$a.DOUBLE_CLICK="doubleclick",S$a.CHANGE="change",S$a.CHANGED="changed",S$a.RESIZE="resize",S$a.ADDED="added",S$a.REMOVED="removed",S$a.DISPLAY="display",S$a.UNDISPLAY="undisplay",S$a.ERROR="error",S$a.COMPLETE="complete",S$a.LOADED="loaded",S$a.INITED="inited",S$a.PROGRESS="progress",S$a.INPUT="input",S$a.RENDER="render",S$a.OPEN="open",S$a.MESSAGE="message",S$a.CLOSE="close",S$a.KEY_DOWN="keydown",S$a.KEY_PRESS="keypress",S$a.KEY_UP="keyup",S$a.FRAME="enterframe",S$a.DRAG_START="dragstart",S$a.DRAG_MOVE="dragmove",S$a.DRAG_END="dragend",S$a.ENTER="enter",S$a.SELECT="select",S$a.BLUR="blur",S$a.FOCUS="focus",S$a.VISIBILITY_CHANGE="visibilitychange",S$a.FOCUS_CHANGE="focuschange",S$a.PLAYED="played",S$a.PAUSED="paused",S$a.STOPPED="stopped",S$a.START="start",S$a.END="end",S$a.ENABLE_CHANGED="enablechanged",S$a.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",S$a.COMPONENT_ADDED="componentadded",S$a.COMPONENT_REMOVED="componentremoved",S$a.LAYER_CHANGED="layerchanged",S$a.HIERARCHY_LOADED="hierarchyloaded",S$a.RECOVERED="recovered",S$a.RELEASED="released",S$a.LINK="link",S$a.LABEL="label",S$a.FULL_SCREEN_CHANGE="fullscreenchange",S$a.DEVICE_LOST="devicelost",S$a.MESH_CHANGED="meshchanged",S$a.MATERIAL_CHANGED="materialchanged",S$a.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",S$a.ANIMATION_CHANGED="animationchanged",S$a.TRIGGER_ENTER="triggerenter",S$a.TRIGGER_STAY="triggerstay",S$a.TRIGGER_EXIT="triggerexit",S$a.TRAIL_FILTER_CHANGE="trailfilterchange",S$a.DOMINO_FILTER_CHANGE="dominofilterchange",S$a}(),S$y=(function(){function S$a(){}S$G(S$a,"laya.events.Keyboard"),S$a.NUMBER_0=48,S$a.NUMBER_1=49,S$a.NUMBER_2=50,S$a.NUMBER_3=51,S$a.NUMBER_4=52,S$a.NUMBER_5=53,S$a.NUMBER_6=54,S$a.NUMBER_7=55,S$a.NUMBER_8=56,S$a.NUMBER_9=57,S$a.A=65,S$a.B=66,S$a.C=67,S$a.D=68,S$a.E=69,S$a.F=70,S$a.G=71,S$a.H=72,S$a.I=73,S$a.J=74,S$a.K=75,S$a.L=76,S$a.M=77,S$a.N=78,S$a.O=79,S$a.P=80,S$a.Q=81,S$a.R=82,S$a.S=83,S$a.T=84,S$a.U=85,S$a.V=86,S$a.W=87,S$a.X=88,S$a.Y=89,S$a.Z=90,S$a.F1=112,S$a.F2=113,S$a.F3=114,S$a.F4=115,S$a.F5=116,S$a.F6=117,S$a.F7=118,S$a.F8=119,S$a.F9=120,S$a.F10=121,S$a.F11=122,S$a.F12=123,S$a.F13=124,S$a.F14=125,S$a.F15=126,S$a.NUMPAD=21,S$a.NUMPAD_0=96,S$a.NUMPAD_1=97,S$a.NUMPAD_2=98,S$a.NUMPAD_3=99,S$a.NUMPAD_4=100,S$a.NUMPAD_5=101,S$a.NUMPAD_6=102,S$a.NUMPAD_7=103,S$a.NUMPAD_8=104,S$a.NUMPAD_9=105,S$a.NUMPAD_ADD=107,S$a.NUMPAD_DECIMAL=110,S$a.NUMPAD_DIVIDE=111,S$a.NUMPAD_ENTER=108,S$a.NUMPAD_MULTIPLY=106,S$a.NUMPAD_SUBTRACT=109,S$a.SEMICOLON=186,S$a.EQUAL=187,S$a.COMMA=188,S$a.MINUS=189,S$a.PERIOD=190,S$a.SLASH=191,S$a.BACKQUOTE=192,S$a.LEFTBRACKET=219,S$a.BACKSLASH=220,S$a.RIGHTBRACKET=221,S$a.QUOTE=222,S$a.ALTERNATE=18,S$a.BACKSPACE=8,S$a.CAPS_LOCK=20,S$a.COMMAND=15,S$a.CONTROL=17,S$a.DELETE=46,S$a.ENTER=13,S$a.ESCAPE=27,S$a.PAGE_UP=33,S$a.PAGE_DOWN=34,S$a.END=35,S$a.HOME=36,S$a.LEFT=37,S$a.UP=38,S$a.RIGHT=39,S$a.DOWN=40,S$a.SHIFT=16,S$a.SPACE=32,S$a.TAB=9,S$a.INSERT=45}(),function(){function S$_(){}return S$G(S$_,"laya.events.KeyBoardManager"),S$_.__init__=function(){S$_._addEvent("keydown"),S$_._addEvent("keypress"),S$_._addEvent("keyup")},S$_._addEvent=function(S$m){S$L.document.addEventListener(S$m,function(S$a){laya.events.KeyBoardManager._dispatch(S$a,S$m)},!0)},S$_._dispatch=function(S$a,S$m){if(S$_.enabled){S$_._event._stoped=!1,S$_._event.nativeEvent=S$a,S$_._event.keyCode=S$a.keyCode||S$a.which||S$a.charCode,"keydown"===S$m?S$_._pressKeys[S$_._event.keyCode]=!0:"keyup"===S$m&&(S$_._pressKeys[S$_._event.keyCode]=null);for(var S$s=S$z.stage.focus&&null!=S$z.stage.focus.event&&S$z.stage.focus.displayedInStage?S$z.stage.focus:S$z.stage,S$P=S$s;S$P;)S$P.event(S$m,S$_._event.setTo(S$m,S$P,S$s)),S$P=S$P.parent}},S$_.hasKeyDown=function(S$a){return S$_._pressKeys[S$a]},S$_._pressKeys={},S$_.enabled=!0,S$k(S$_,["_event",function(){return this._event=new S$e}]),S$_}()),S$h=(function(){function S$a(){}S$G(S$a,"laya.events.KeyLocation"),S$a.STANDARD=0,S$a.LEFT=1,S$a.RIGHT=2,S$a.NUM_PAD=3}(),function(){function S$j(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=S$L.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new S$e,this._matrix=new S$W,this._point=new S$U,this._rect=new S$l,this._prePoint=new S$U,this._curTouchID=NaN}S$G(S$j,"laya.events.MouseManager");var S$a=S$j.prototype;return S$a.__init__=function(S$a,S$m){var S$s=this;this._stage=S$a;var S$P=this,S$_=this._eventList;S$m.oncontextmenu=function(S$a){if(S$j.enabled)return!1},S$m.addEventListener("mousedown",function(S$a){S$j.enabled&&(S$L.onIE||S$a.preventDefault(),S$_.push(S$a),S$P.mouseDownTime=S$L.now())}),S$m.addEventListener("mouseup",function(S$a){S$j.enabled&&(S$a.preventDefault(),S$_.push(S$a),S$P.mouseDownTime=-S$L.now())},!0),S$m.addEventListener("mousemove",function(S$a){if(S$j.enabled){S$a.preventDefault();var S$m=S$L.now();if(S$m-S$P._lastMoveTimer<10)return;S$P._lastMoveTimer=S$m,S$_.push(S$a)}},!0),S$m.addEventListener("mouseout",function(S$a){S$j.enabled&&S$_.push(S$a)}),S$m.addEventListener("mouseover",function(S$a){S$j.enabled&&S$_.push(S$a)}),S$m.addEventListener("touchstart",function(S$a){S$j.enabled&&(S$_.push(S$a),S$j._isFirstTouch||S$oa.isInputting||S$a.preventDefault(),S$P.mouseDownTime=S$L.now())}),S$m.addEventListener("touchend",function(S$a){S$j.enabled?(S$j._isFirstTouch||S$oa.isInputting||S$a.preventDefault(),S$j._isFirstTouch=!1,S$_.push(S$a),S$P.mouseDownTime=-S$L.now()):S$s._curTouchID=NaN},!0),S$m.addEventListener("touchmove",function(S$a){S$j.enabled&&(S$a.preventDefault(),S$_.push(S$a))},!0),S$m.addEventListener("touchcancel",function(S$a){S$j.enabled?(S$a.preventDefault(),S$_.push(S$a)):S$s._curTouchID=NaN},!0),S$m.addEventListener("mousewheel",function(S$a){S$j.enabled&&S$_.push(S$a)}),S$m.addEventListener("DOMMouseScroll",function(S$a){S$j.enabled&&S$_.push(S$a)})},S$a.initEvent=function(S$a,S$m){var S$s;this._event._stoped=!1,this._event.nativeEvent=S$m||S$a,this._target=null,this._point.setTo(S$a.pageX||S$a.clientX,S$a.pageY||S$a.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=S$a.identifier||0,this._tTouchID=this._event.touchId,(S$s=S$u.I._event)._stoped=!1,S$s.nativeEvent=this._event.nativeEvent,S$s.touchId=this._event.touchId},S$a.checkMouseWheel=function(S$a){this._event.delta=S$a.wheelDelta?.025*S$a.wheelDelta:-S$a.detail;for(var S$m=S$u.I.getLastOvers(),S$s=0,S$P=S$m.length;S$s<S$P;S$s++){var S$_=S$m[S$s];S$_.event("mousewheel",this._event.setTo("mousewheel",S$_,this._target))}},S$a.onMouseMove=function(S$a){S$u.I.onMouseMove(S$a,this._tTouchID)},S$a.onMouseDown=function(S$a){if(S$oa.isInputting&&S$z.stage.focus&&S$z.stage.focus.focus&&!S$z.stage.focus.contains(this._target)){var S$m=S$z.stage.focus._tf||S$z.stage.focus,S$s=S$a._tf||S$a;S$s instanceof laya.display.Input&&S$s.multiline==S$m.multiline?S$m._focusOut():S$m.focus=!1}S$u.I.onMouseDown(S$a,this._tTouchID,this._isLeftMouse)},S$a.onMouseUp=function(S$a){S$u.I.onMouseUp(S$a,this._tTouchID,this._isLeftMouse)},S$a.check=function(S$a,S$m,S$s,S$P){this._point.setTo(S$m,S$s),S$a.fromParentPoint(this._point),S$m=this._point.x,S$s=this._point.y;var S$_=S$a.scrollRect;if(S$_&&(this._rect.setTo(S$_.x,S$_.y,S$_.width,S$_.height),!this._rect.contains(S$m,S$s)))return!1;if(!this.disableMouseEvent){if(S$a.hitTestPrior&&!S$a.mouseThrough&&!this.hitTest(S$a,S$m,S$s))return!1;for(var S$e=S$a._childs.length-1;-1<S$e;S$e--){var S$A=S$a._childs[S$e];if(!S$A.destroyed&&S$A.mouseEnabled&&S$A.visible&&this.check(S$A,S$m,S$s,S$P))return!0}}var S$B=!(!S$a.hitTestPrior||S$a.mouseThrough||this.disableMouseEvent)||this.hitTest(S$a,S$m,S$s);return S$B?(this._target=S$a,S$P.call(this,S$a)):S$P===this.onMouseUp&&S$a===this._stage&&(this._target=this._stage,S$P.call(this,this._target)),S$B},S$a.hitTest=function(S$a,S$m,S$s){var S$P=!1;if(S$a.scrollRect&&(S$m-=S$a.scrollRect.x,S$s-=S$a.scrollRect.y),S$a.hitArea instanceof laya.utils.HitArea)return S$a.hitArea.isHit(S$m,S$s);if(0<S$a.width&&0<S$a.height||S$a.mouseThrough||S$a.hitArea)if(S$a.mouseThrough)S$P=S$a.getGraphicBounds().contains(S$m,S$s);else{var S$_=this._rect;S$a.hitArea?S$_=S$a.hitArea:S$_.setTo(0,0,S$a.width,S$a.height),S$P=S$_.contains(S$m,S$s)}return S$P},S$a.runEvent=function(){var S$a=this._eventList.length;if(S$a){this.mouseEventTime=S$L.now();var S$m,S$s=0,S$P=0,S$_=0;try{for(;S$s<S$a;){var S$e=this._eventList[S$s];switch("mousemove"!==S$e.type&&(this._prePoint.x=this._prePoint.y=-1e6),S$e.type){case"mousedown":this._touchIDs[0]=this._id++,S$j._isTouchRespond?S$j._isTouchRespond=!1:(this._isLeftMouse=0===S$e.button,this.initEvent(S$e),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===S$e.button,this.initEvent(S$e),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-S$e.clientX)+Math.abs(this._prePoint.y-S$e.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=S$e.clientX,this._prePoint.y=S$e.clientY,this.initEvent(S$e),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":S$j._isTouchRespond=!0,this._isLeftMouse=!0;var S$A=S$e.changedTouches;for(S$P=0,S$_=S$A.length;S$P<S$_;S$P++)S$m=S$A[S$P],(S$j.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=S$m.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[S$m.identifier]=this._id++,this.initEvent(S$m,S$e),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":S$j._isTouchRespond=!0,this._isLeftMouse=!0;var S$B=S$e.changedTouches;for(S$P=0,S$_=S$B.length;S$P<S$_;S$P++)if(S$m=S$B[S$P],S$j.multiTouchEnabled||S$m.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(S$m,S$e);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var S$k=S$e.changedTouches;for(S$P=0,S$_=S$k.length;S$P<S$_;S$P++)S$m=S$k[S$P],(S$j.multiTouchEnabled||S$m.identifier==this._curTouchID)&&(this.initEvent(S$m,S$e),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(S$e);break;case"mouseout":S$u.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}S$s++}}catch(S$a){throw this._eventList.length=0,S$a}this._eventList.length=0}},S$j.enabled=!0,S$j.multiTouchEnabled=!0,S$j._isTouchRespond=!1,S$j._isFirstTouch=!0,S$k(S$j,["instance",function(){return this.instance=new S$j}]),S$j}()),S$u=function(){function S$q(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new S$e}S$G(S$q,"laya.events.TouchManager");var S$a=S$q.prototype;return S$a._clearTempArrs=function(){S$q._oldArr.length=0,S$q._newArr.length=0,S$q._tEleArr.length=0},S$a.getTouchFromArr=function(S$a,S$m){var S$s,S$P,S$_=0;for(S$s=S$m.length,S$_=0;S$_<S$s;S$_++)if((S$P=S$m[S$_]).id==S$a)return S$P;return null},S$a.removeTouchFromArr=function(S$a,S$m){var S$s=0;for(S$s=S$m.length-1;0<=S$s;S$s--)S$m[S$s].id==S$a&&S$m.splice(S$s,1)},S$a.createTouchO=function(S$a,S$m){var S$s;return(S$s=S$w.getItem("TouchData")||{}).id=S$m,S$s.tar=S$a,S$s},S$a.onMouseDown=function(S$a,S$m,S$s){var S$P,S$_,S$e,S$A;(void 0===S$s&&(S$s=!1),this.enable)&&(S$P=this.getTouchFromArr(S$m,this.preOvers),S$e=this.getEles(S$a,null,S$q._tEleArr),S$P?S$P.tar=S$a:(S$_=this.createTouchO(S$a,S$m),this.preOvers.push(S$_)),S$L.onMobile&&this.sendEvents(S$e,"mouseover",S$m),S$A=S$s?this.preDowns:this.preRightDowns,(S$P=this.getTouchFromArr(S$m,S$A))?S$P.tar=S$a:(S$_=this.createTouchO(S$a,S$m),S$A.push(S$_)),this.sendEvents(S$e,S$s?"mousedown":"rightmousedown",S$m),this._clearTempArrs())},S$a.sendEvents=function(S$a,S$m,S$s){void 0===S$s&&(S$s=0);var S$P,S$_,S$e,S$A=0;for(S$P=S$a.length,this._event._stoped=!1,S$_=S$a[0],S$A=0;S$A<S$P;S$A++){if((S$e=S$a[S$A]).destroyed)return;if(S$e.event(S$m,this._event.setTo(S$m,S$e,S$_)),this._event._stoped)break}},S$a.getEles=function(S$a,S$m,S$s){for(S$s?S$s.length=0:S$s=[];S$a&&S$a!=S$m;)S$s.push(S$a),S$a=S$a.parent;return S$s},S$a.checkMouseOutAndOverOfMove=function(S$a,S$m,S$s){if(void 0===S$s&&(S$s=0),S$m!=S$a){var S$P,S$_,S$e=0,S$A=0;if(S$m.contains(S$a))S$_=this.getEles(S$a,S$m,S$q._tEleArr),this.sendEvents(S$_,"mouseover",S$s);else if(S$a.contains(S$m))S$_=this.getEles(S$m,S$a,S$q._tEleArr),this.sendEvents(S$_,"mouseout",S$s);else{var S$B,S$k;(S$_=S$q._tEleArr).length=0,S$B=this.getEles(S$m,null,S$q._oldArr),S$k=this.getEles(S$a,null,S$q._newArr),S$A=S$B.length;var S$j=0;for(S$e=0;S$e<S$A;S$e++){if(S$P=S$B[S$e],0<=(S$j=S$k.indexOf(S$P))){S$k.splice(S$j,S$k.length-S$j);break}S$_.push(S$P)}0<S$_.length&&this.sendEvents(S$_,"mouseout",S$s),0<S$k.length&&this.sendEvents(S$k,"mouseover",S$s)}}},S$a.onMouseMove=function(S$a,S$m){var S$s,S$P;this.enable&&((S$s=this.getTouchFromArr(S$m,this.preOvers))?(this.checkMouseOutAndOverOfMove(S$a,S$s.tar),S$s.tar=S$a,S$P=this.getEles(S$a,null,S$q._tEleArr)):(S$P=this.getEles(S$a,null,S$q._tEleArr),this.sendEvents(S$P,"mouseover",S$m),this.preOvers.push(this.createTouchO(S$a,S$m))),this.sendEvents(S$P,"mousemove",S$m),this._clearTempArrs())},S$a.getLastOvers=function(){return(S$q._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,S$q._tEleArr):(S$q._tEleArr.push(S$z.stage),S$q._tEleArr)},S$a.stageMouseOut=function(){var S$a;S$a=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(S$a,"mouseout",0)},S$a.onMouseUp=function(S$a,S$m,S$s){if(void 0===S$s&&(S$s=!1),this.enable){var S$P,S$_,S$e,S$A,S$B,S$k,S$j=0,S$G=0,S$y=S$L.onMobile;if(S$_=this.getEles(S$a,null,S$q._tEleArr),this.sendEvents(S$_,S$s?"mouseup":"rightmouseup",S$m),S$k=S$s?this.preDowns:this.preRightDowns,S$P=this.getTouchFromArr(S$m,S$k)){var S$d,S$Q=S$L.now();if(S$d=S$Q-this._lastClickTime<300,this._lastClickTime=S$Q,S$a==S$P.tar)S$B=S$_;else for(S$e=this.getEles(S$P.tar,null,S$q._oldArr),(S$B=S$q._newArr).length=0,S$G=S$e.length,S$j=0;S$j<S$G;S$j++)S$A=S$e[S$j],0<=S$_.indexOf(S$A)&&S$B.push(S$A);0<S$B.length&&this.sendEvents(S$B,S$s?"click":"rightclick",S$m),S$s&&S$d&&this.sendEvents(S$B,"doubleclick",S$m),this.removeTouchFromArr(S$m,S$k),S$P.tar=null,S$w.recover("TouchData",S$P)}else;(S$P=this.getTouchFromArr(S$m,this.preOvers))&&S$y&&((S$B=this.getEles(S$P.tar,null,S$B))&&0<S$B.length&&this.sendEvents(S$B,"mouseout",S$m),this.removeTouchFromArr(S$m,this.preOvers),S$P.tar=null,S$w.recover("TouchData",S$P)),this._clearTempArrs()}},S$q._oldArr=[],S$q._newArr=[],S$q._tEleArr=[],S$k(S$q,["I",function(){return this.I=new S$q}]),S$q}(),S$O=function(){function S$a(){this._action=null}S$G(S$a,"laya.filters.Filter");var S$m=S$a.prototype;return S$z.imps(S$m,{"laya.filters.IFilter":!0}),S$m.callNative=function(S$a){},S$q(0,S$m,"type",function(){return-1}),S$q(0,S$m,"action",function(){return this._action}),S$a.BLUR=16,S$a.COLOR=32,S$a.GLOW=8,S$a._filterStart=null,S$a._filterEnd=null,S$a._EndTarget=null,S$a._recycleScope=null,S$a._filter=null,S$a._useSrc=null,S$a._endSrc=null,S$a._useOut=null,S$a._endOut=null,S$a}(),S$c=function(){function S$a(){this.data=null}S$G(S$a,"laya.filters.ColorFilterAction");var S$m=S$a.prototype;return S$z.imps(S$m,{"laya.filters.IFilterAction":!0}),S$m.apply=function(S$a){var S$m=S$a.ctx.ctx,S$s=S$a.ctx.ctx.canvas;if(0==S$s.width||0==S$s.height)return S$s;for(var S$P,S$_=S$m.getImageData(0,0,S$s.width,S$s.height),S$e=S$_.data,S$A=0,S$B=S$e.length;S$A<S$B;S$A+=4)S$P=this.getColor(S$e[S$A],S$e[S$A+1],S$e[S$A+2],S$e[S$A+3]),0!=S$e[S$A+3]&&(S$e[S$A]=S$P[0],S$e[S$A+1]=S$P[1],S$e[S$A+2]=S$P[2],S$e[S$A+3]=S$P[3]);return S$m.putImageData(S$_,0,0),S$a},S$m.getColor=function(S$a,S$m,S$s,S$P){var S$_=[];if(this.data._mat&&this.data._alpha){var S$e=this.data._mat,S$A=this.data._alpha;S$_[0]=S$e[0]*S$a+S$e[1]*S$m+S$e[2]*S$s+S$e[3]*S$P+S$A[0],S$_[1]=S$e[4]*S$a+S$e[5]*S$m+S$e[6]*S$s+S$e[7]*S$P+S$A[1],S$_[2]=S$e[8]*S$a+S$e[9]*S$m+S$e[10]*S$s+S$e[11]*S$P+S$A[2],S$_[3]=S$e[12]*S$a+S$e[13]*S$m+S$e[14]*S$s+S$e[15]*S$P+S$A[3]}return S$_},S$a}(),S$H=(function(){function S$a(){}S$G(S$a,"laya.maths.Arith"),S$a.formatR=function(S$a){return S$a>Math.PI&&(S$a-=2*Math.PI),S$a<-Math.PI&&(S$a+=2*Math.PI),S$a},S$a.isPOT=function(S$a,S$m){return 0<S$a&&0==(S$a&S$a-1)&&0<S$m&&0==(S$m&S$m-1)},S$a.setMatToArray=function(S$a,S$m){S$a.a,S$a.b,S$a.c,S$a.d,S$a.tx,S$a.ty,S$m[0]=S$a.a,S$m[1]=S$a.b,S$m[4]=S$a.c,S$m[5]=S$a.d,S$m[12]=S$a.tx,S$m[13]=S$a.ty}}(),function(){function S$a(){this._controlPoints=[new S$U,new S$U,new S$U],this._calFun=this.getPoint2}S$G(S$a,"laya.maths.Bezier");var S$m=S$a.prototype;return S$m._switchPoint=function(S$a,S$m){var S$s=this._controlPoints.shift();S$s.setTo(S$a,S$m),this._controlPoints.push(S$s)},S$m.getPoint2=function(S$a,S$m){var S$s=this._controlPoints[0],S$P=this._controlPoints[1],S$_=this._controlPoints[2],S$e=Math.pow(1-S$a,2)*S$s.x+2*S$a*(1-S$a)*S$P.x+Math.pow(S$a,2)*S$_.x,S$A=Math.pow(1-S$a,2)*S$s.y+2*S$a*(1-S$a)*S$P.y+Math.pow(S$a,2)*S$_.y;S$m.push(S$e,S$A)},S$m.getPoint3=function(S$a,S$m){var S$s=this._controlPoints[0],S$P=this._controlPoints[1],S$_=this._controlPoints[2],S$e=this._controlPoints[3],S$A=Math.pow(1-S$a,3)*S$s.x+3*S$P.x*S$a*(1-S$a)*(1-S$a)+3*S$_.x*S$a*S$a*(1-S$a)+S$e.x*Math.pow(S$a,3),S$B=Math.pow(1-S$a,3)*S$s.y+3*S$P.y*S$a*(1-S$a)*(1-S$a)+3*S$_.y*S$a*S$a*(1-S$a)+S$e.y*Math.pow(S$a,3);S$m.push(S$A,S$B)},S$m.insertPoints=function(S$a,S$m){var S$s,S$P=NaN;for(S$s=1/(S$a=0<S$a?S$a:5),S$P=0;S$P<=1;S$P+=S$s)this._calFun(S$P,S$m)},S$m.getBezierPoints=function(S$a,S$m,S$s){void 0===S$m&&(S$m=5),void 0===S$s&&(S$s=2);var S$P,S$_,S$e=0;if((S$P=S$a.length)<2*(S$s+1))return[];switch(S$_=[],S$s){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=S$s;)this._controlPoints.push(new S$U);for(S$e=0;S$e<2*S$s;S$e+=2)this._switchPoint(S$a[S$e],S$a[S$e+1]);for(S$e=2*S$s;S$e<S$P;S$e+=2)this._switchPoint(S$a[S$e],S$a[S$e+1]),S$e/2%S$s==0&&this.insertPoints(S$m,S$_);return S$_},S$k(S$a,["I",function(){return this.I=new S$a}]),S$a}()),S$o=function(){function S$j(){}return S$G(S$j,"laya.maths.GrahamScan"),S$j.multiply=function(S$a,S$m,S$s){return(S$a.x-S$s.x)*(S$m.y-S$s.y)-(S$m.x-S$s.x)*(S$a.y-S$s.y)},S$j.dis=function(S$a,S$m){return(S$a.x-S$m.x)*(S$a.x-S$m.x)+(S$a.y-S$m.y)*(S$a.y-S$m.y)},S$j._getPoints=function(S$a,S$m,S$s){for(void 0===S$m&&(S$m=!1),S$j._mPointList||(S$j._mPointList=[]);S$j._mPointList.length<S$a;)S$j._mPointList.push(new S$U);return S$s||(S$s=[]),S$s.length=0,S$m?S$j.getFrom(S$s,S$j._mPointList,S$a):S$j.getFromR(S$s,S$j._mPointList,S$a),S$s},S$j.getFrom=function(S$a,S$m,S$s){var S$P=0;for(S$P=0;S$P<S$s;S$P++)S$a.push(S$m[S$P]);return S$a},S$j.getFromR=function(S$a,S$m,S$s){var S$P=0;for(S$P=0;S$P<S$s;S$P++)S$a.push(S$m.pop());return S$a},S$j.pListToPointList=function(S$a,S$m){void 0===S$m&&(S$m=!1);var S$s=0,S$P=S$a.length/2,S$_=S$j._getPoints(S$P,S$m,S$j._tempPointList);for(S$s=0;S$s<S$P;S$s++)S$_[S$s].setTo(S$a[S$s+S$s],S$a[S$s+S$s+1]);return S$_},S$j.pointListToPlist=function(S$a){var S$m,S$s=0,S$P=S$a.length,S$_=S$j._temPList;for(S$s=S$_.length=0;S$s<S$P;S$s++)S$m=S$a[S$s],S$_.push(S$m.x,S$m.y);return S$_},S$j.scanPList=function(S$a){return S$I.copyArray(S$a,S$j.pointListToPlist(S$j.scan(S$j.pListToPointList(S$a,!0))))},S$j.scan=function(S$a){var S$m,S$s,S$P,S$_=0,S$e=0,S$A=0,S$B=S$a.length,S$k={};for((S$s=S$j._temArr).length=0,S$_=(S$B=S$a.length)-1;0<=S$_;S$_--)S$P=(S$m=S$a[S$_]).x+"_"+S$m.y,S$k.hasOwnProperty(S$P)||(S$k[S$P]=!0,S$s.push(S$m));for(S$B=S$s.length,S$I.copyArray(S$a,S$s),S$_=1;S$_<S$B;S$_++)(S$a[S$_].y<S$a[S$A].y||S$a[S$_].y==S$a[S$A].y&&S$a[S$_].x<S$a[S$A].x)&&(S$A=S$_);for(S$m=S$a[0],S$a[0]=S$a[S$A],S$a[S$A]=S$m,S$_=1;S$_<S$B-1;S$_++){for(S$e=(S$A=S$_)+1;S$e<S$B;S$e++)(0<S$j.multiply(S$a[S$e],S$a[S$A],S$a[0])||0==S$j.multiply(S$a[S$e],S$a[S$A],S$a[0])&&S$j.dis(S$a[0],S$a[S$e])<S$j.dis(S$a[0],S$a[S$A]))&&(S$A=S$e);S$m=S$a[S$_],S$a[S$_]=S$a[S$A],S$a[S$A]=S$m}if((S$s=S$j._temArr).length=0,S$a.length<3)return S$I.copyArray(S$s,S$a);for(S$s.push(S$a[0],S$a[1],S$a[2]),S$_=3;S$_<S$B;S$_++){for(;2<=S$s.length&&0<=S$j.multiply(S$a[S$_],S$s[S$s.length-1],S$s[S$s.length-2]);)S$s.pop();S$a[S$_]&&S$s.push(S$a[S$_])}return S$s},S$j._mPointList=null,S$j._tempPointList=[],S$j._temPList=[],S$j._temArr=[],S$j}(),S$N=function(){function S$_(){}return S$G(S$_,"laya.maths.MathUtil"),S$_.subtractVector3=function(S$a,S$m,S$s){S$s[0]=S$a[0]-S$m[0],S$s[1]=S$a[1]-S$m[1],S$s[2]=S$a[2]-S$m[2]},S$_.lerp=function(S$a,S$m,S$s){return S$a*(1-S$s)+S$m*S$s},S$_.scaleVector3=function(S$a,S$m,S$s){S$s[0]=S$a[0]*S$m,S$s[1]=S$a[1]*S$m,S$s[2]=S$a[2]*S$m},S$_.lerpVector3=function(S$a,S$m,S$s,S$P){var S$_=S$a[0],S$e=S$a[1],S$A=S$a[2];S$P[0]=S$_+S$s*(S$m[0]-S$_),S$P[1]=S$e+S$s*(S$m[1]-S$e),S$P[2]=S$A+S$s*(S$m[2]-S$A)},S$_.lerpVector4=function(S$a,S$m,S$s,S$P){var S$_=S$a[0],S$e=S$a[1],S$A=S$a[2],S$B=S$a[3];S$P[0]=S$_+S$s*(S$m[0]-S$_),S$P[1]=S$e+S$s*(S$m[1]-S$e),S$P[2]=S$A+S$s*(S$m[2]-S$A),S$P[3]=S$B+S$s*(S$m[3]-S$B)},S$_.slerpQuaternionArray=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){var S$B,S$k,S$j,S$G,S$y,S$d=S$a[S$m+0],S$Q=S$a[S$m+1],S$q=S$a[S$m+2],S$h=S$a[S$m+3],S$u=S$s[S$P+0],S$O=S$s[S$P+1],S$p=S$s[S$P+2],S$c=S$s[S$P+3];return(S$k=S$d*S$u+S$Q*S$O+S$q*S$p+S$h*S$c)<0&&(S$k=-S$k,S$u=-S$u,S$O=-S$O,S$p=-S$p,S$c=-S$c),S$y=1e-6<1-S$k?(S$B=Math.acos(S$k),S$j=Math.sin(S$B),S$G=Math.sin((1-S$_)*S$B)/S$j,Math.sin(S$_*S$B)/S$j):(S$G=1-S$_,S$_),S$e[S$A+0]=S$G*S$d+S$y*S$u,S$e[S$A+1]=S$G*S$Q+S$y*S$O,S$e[S$A+2]=S$G*S$q+S$y*S$p,S$e[S$A+3]=S$G*S$h+S$y*S$c,S$e},S$_.getRotation=function(S$a,S$m,S$s,S$P){return Math.atan2(S$P-S$m,S$s-S$a)/Math.PI*180},S$_.sortBigFirst=function(S$a,S$m){return S$a==S$m?0:S$a<S$m?1:-1},S$_.sortSmallFirst=function(S$a,S$m){return S$a==S$m?0:S$a<S$m?-1:1},S$_.sortNumBigFirst=function(S$a,S$m){return parseFloat(S$m)-parseFloat(S$a)},S$_.sortNumSmallFirst=function(S$a,S$m){return parseFloat(S$a)-parseFloat(S$m)},S$_.sortByKey=function(S$s,S$a,S$m){var S$P;return void 0===S$a&&(S$a=!1),void 0===S$m&&(S$m=!0),S$P=S$a?S$m?S$_.sortNumBigFirst:S$_.sortBigFirst:S$m?S$_.sortNumSmallFirst:S$_.sortSmallFirst,function(S$a,S$m){return S$P(S$a[S$s],S$m[S$s])}},S$_}(),S$W=function(){function S$s(S$a,S$m,S$s,S$P,S$_,S$e){this.inPool=!1,this.bTransform=!1,void 0===S$a&&(S$a=1),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=1),void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=0),this.a=S$a,this.b=S$m,this.c=S$s,this.d=S$P,this.tx=S$_,this.ty=S$e,this._checkTransform()}S$G(S$s,"laya.maths.Matrix");var S$a=S$s.prototype;return S$a.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},S$a._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},S$a.setTranslate=function(S$a,S$m){return this.tx=S$a,this.ty=S$m,this},S$a.translate=function(S$a,S$m){return this.tx+=S$a,this.ty+=S$m,this},S$a.scale=function(S$a,S$m){this.a*=S$a,this.d*=S$m,this.c*=S$a,this.b*=S$m,this.tx*=S$a,this.ty*=S$m,this.bTransform=!0},S$a.rotate=function(S$a){var S$m=Math.cos(S$a),S$s=Math.sin(S$a),S$P=this.a,S$_=this.c,S$e=this.tx;this.a=S$P*S$m-this.b*S$s,this.b=S$P*S$s+this.b*S$m,this.c=S$_*S$m-this.d*S$s,this.d=S$_*S$s+this.d*S$m,this.tx=S$e*S$m-this.ty*S$s,this.ty=S$e*S$s+this.ty*S$m,this.bTransform=!0},S$a.skew=function(S$a,S$m){var S$s=Math.tan(S$a),S$P=Math.tan(S$m),S$_=this.a,S$e=this.b;return this.a+=S$P*this.c,this.b+=S$P*this.d,this.c+=S$s*S$_,this.d+=S$s*S$e,this},S$a.invertTransformPoint=function(S$a){var S$m=this.a,S$s=this.b,S$P=this.c,S$_=this.d,S$e=this.tx,S$A=S$m*S$_-S$s*S$P,S$B=S$_/S$A,S$k=-S$s/S$A,S$j=-S$P/S$A,S$G=S$m/S$A,S$y=(S$P*this.ty-S$_*S$e)/S$A,S$d=-(S$m*this.ty-S$s*S$e)/S$A;return S$a.setTo(S$B*S$a.x+S$j*S$a.y+S$y,S$k*S$a.x+S$G*S$a.y+S$d)},S$a.transformPoint=function(S$a){return S$a.setTo(this.a*S$a.x+this.c*S$a.y+this.tx,this.b*S$a.x+this.d*S$a.y+this.ty)},S$a.transformPointN=function(S$a){return S$a.setTo(this.a*S$a.x+this.c*S$a.y,this.b*S$a.x+this.d*S$a.y)},S$a.transformPointArray=function(S$a,S$m){for(var S$s=S$a.length,S$P=0;S$P<S$s;S$P+=2){var S$_=S$a[S$P],S$e=S$a[S$P+1];S$m[S$P]=this.a*S$_+this.c*S$e+this.tx,S$m[S$P+1]=this.b*S$_+this.d*S$e+this.ty}return S$m},S$a.transformPointArrayScale=function(S$a,S$m){for(var S$s=S$a.length,S$P=0;S$P<S$s;S$P+=2){var S$_=S$a[S$P],S$e=S$a[S$P+1];S$m[S$P]=this.a*S$_+this.c*S$e,S$m[S$P+1]=this.b*S$_+this.d*S$e}return S$m},S$a.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},S$a.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},S$a.invert=function(){var S$a=this.a,S$m=this.b,S$s=this.c,S$P=this.d,S$_=this.tx,S$e=S$a*S$P-S$m*S$s;return this.a=S$P/S$e,this.b=-S$m/S$e,this.c=-S$s/S$e,this.d=S$a/S$e,this.tx=(S$s*this.ty-S$P*S$_)/S$e,this.ty=-(S$a*this.ty-S$m*S$_)/S$e,this},S$a.setTo=function(S$a,S$m,S$s,S$P,S$_,S$e){return this.a=S$a,this.b=S$m,this.c=S$s,this.d=S$P,this.tx=S$_,this.ty=S$e,this},S$a.concat=function(S$a){var S$m=this.a,S$s=this.c,S$P=this.tx;return this.a=S$m*S$a.a+this.b*S$a.c,this.b=S$m*S$a.b+this.b*S$a.d,this.c=S$s*S$a.a+this.d*S$a.c,this.d=S$s*S$a.b+this.d*S$a.d,this.tx=S$P*S$a.a+this.ty*S$a.c+S$a.tx,this.ty=S$P*S$a.b+this.ty*S$a.d+S$a.ty,this},S$a.scaleEx=function(S$a,S$m){var S$s=this.a,S$P=this.b,S$_=this.c,S$e=this.d;0!==S$P||0!==S$_?(this.a=S$a*S$s,this.b=S$a*S$P,this.c=S$m*S$_):(this.a=S$a*S$s,this.b=0*S$e,this.c=0*S$s),this.d=S$m*S$e,this.bTransform=!0},S$a.rotateEx=function(S$a){var S$m=Math.cos(S$a),S$s=Math.sin(S$a),S$P=this.a,S$_=this.b,S$e=this.c,S$A=this.d;0!==S$_||0!==S$e?(this.a=S$m*S$P+S$s*S$e,this.b=S$m*S$_+S$s*S$A,this.c=-S$s*S$P+S$m*S$e,this.d=-S$s*S$_+S$m*S$A):(this.a=S$m*S$P,this.b=S$s*S$A,this.c=-S$s*S$P,this.d=S$m*S$A),this.bTransform=!0},S$a.clone=function(){var S$a=S$s.create();return S$a.a=this.a,S$a.b=this.b,S$a.c=this.c,S$a.d=this.d,S$a.tx=this.tx,S$a.ty=this.ty,S$a.bTransform=this.bTransform,S$a},S$a.copyTo=function(S$a){return S$a.a=this.a,S$a.b=this.b,S$a.c=this.c,S$a.d=this.d,S$a.tx=this.tx,S$a.ty=this.ty,S$a.bTransform=this.bTransform,S$a},S$a.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},S$a.destroy=function(){if(!this.inPool){var S$a=S$s._cache;this.inPool=!0,S$a._length||(S$a._length=0),(S$a[S$a._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},S$s.mul=function(S$a,S$m,S$s){var S$P=S$a.a,S$_=S$a.b,S$e=S$a.c,S$A=S$a.d,S$B=S$a.tx,S$k=S$a.ty,S$j=S$m.a,S$G=S$m.b,S$y=S$m.c,S$d=S$m.d,S$Q=S$m.tx,S$q=S$m.ty;return 0!==S$G||0!==S$y?(S$s.a=S$P*S$j+S$_*S$y,S$s.b=S$P*S$G+S$_*S$d,S$s.c=S$e*S$j+S$A*S$y,S$s.d=S$e*S$G+S$A*S$d,S$s.tx=S$j*S$B+S$y*S$k+S$Q,S$s.ty=S$G*S$B+S$d*S$k+S$q):(S$s.a=S$P*S$j,S$s.b=S$_*S$d,S$s.c=S$e*S$j,S$s.d=S$A*S$d,S$s.tx=S$j*S$B+S$Q,S$s.ty=S$d*S$k+S$q),S$s},S$s.mul16=function(S$a,S$m,S$s){var S$P=S$a.a,S$_=S$a.b,S$e=S$a.c,S$A=S$a.d,S$B=S$a.tx,S$k=S$a.ty,S$j=S$m.a,S$G=S$m.b,S$y=S$m.c,S$d=S$m.d,S$Q=S$m.tx,S$q=S$m.ty;return 0!==S$G||0!==S$y?(S$s[0]=S$P*S$j+S$_*S$y,S$s[1]=S$P*S$G+S$_*S$d,S$s[4]=S$e*S$j+S$A*S$y,S$s[5]=S$e*S$G+S$A*S$d,S$s[12]=S$j*S$B+S$y*S$k+S$Q,S$s[13]=S$G*S$B+S$d*S$k+S$q):(S$s[0]=S$P*S$j,S$s[1]=S$_*S$d,S$s[4]=S$e*S$j,S$s[5]=S$A*S$d,S$s[12]=S$j*S$B+S$Q,S$s[13]=S$d*S$k+S$q),S$s},S$s.mulPre=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){var S$k=S$a.a,S$j=S$a.b,S$G=S$a.c,S$y=S$a.d,S$d=S$a.tx,S$Q=S$a.ty;return 0!==S$s||0!==S$P?(S$B.a=S$k*S$m+S$j*S$P,S$B.b=S$k*S$s+S$j*S$_,S$B.c=S$G*S$m+S$y*S$P,S$B.d=S$G*S$s+S$y*S$_,S$B.tx=S$m*S$d+S$P*S$Q+S$e,S$B.ty=S$s*S$d+S$_*S$Q+S$A):(S$B.a=S$k*S$m,S$B.b=S$j*S$_,S$B.c=S$G*S$m,S$B.d=S$y*S$_,S$B.tx=S$m*S$d+S$e,S$B.ty=S$_*S$Q+S$A),S$B},S$s.mulPos=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){var S$k=S$a.a,S$j=S$a.b,S$G=S$a.c,S$y=S$a.d,S$d=S$a.tx,S$Q=S$a.ty;return 0!==S$j||0!==S$G?(S$B.a=S$m*S$k+S$s*S$G,S$B.b=S$m*S$j+S$s*S$y,S$B.c=S$P*S$k+S$_*S$G,S$B.d=S$P*S$j+S$_*S$y,S$B.tx=S$k*S$e+S$G*S$A+S$d,S$B.ty=S$j*S$e+S$y*S$A+S$Q):(S$B.a=S$m*S$k,S$B.b=S$s*S$y,S$B.c=S$P*S$k,S$B.d=S$_*S$y,S$B.tx=S$k*S$e+S$d,S$B.ty=S$y*S$A+S$Q),S$B},S$s.preMul=function(S$a,S$m,S$s){var S$P=S$a.a,S$_=S$a.b,S$e=S$a.c,S$A=S$a.d,S$B=S$m.a,S$k=S$m.b,S$j=S$m.c,S$G=S$m.d,S$y=S$m.tx,S$d=S$m.ty;return S$s.a=S$B*S$P,S$s.b=S$s.c=0,S$s.d=S$G*S$A,S$s.tx=S$y*S$P+S$a.tx,S$s.ty=S$d*S$A+S$a.ty,0===S$k&&0===S$j&&0===S$_&&0===S$e||(S$s.a+=S$k*S$e,S$s.d+=S$j*S$_,S$s.b+=S$B*S$_+S$k*S$A,S$s.c+=S$j*S$P+S$G*S$e,S$s.tx+=S$d*S$e,S$s.ty+=S$y*S$_),S$s},S$s.preMulXY=function(S$a,S$m,S$s,S$P){var S$_=S$a.a,S$e=S$a.b,S$A=S$a.c,S$B=S$a.d;return S$P.a=S$_,S$P.b=S$e,S$P.c=S$A,S$P.d=S$B,S$P.tx=S$m*S$_+S$a.tx+S$s*S$A,S$P.ty=S$s*S$B+S$a.ty+S$m*S$e,S$P},S$s.create=function(){var S$a=S$s._cache,S$m=S$a._length?S$a[--S$a._length]:new S$s;return S$m.inPool=!1,S$m},S$s.EMPTY=new S$s,S$s.TEMP=new S$s,S$s._cache=[],S$s}(),S$U=function(){function S$a(S$a,S$m){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),this.x=S$a,this.y=S$m}S$G(S$a,"laya.maths.Point");var S$m=S$a.prototype;return S$m.setTo=function(S$a,S$m){return this.x=S$a,this.y=S$m,this},S$m.distance=function(S$a,S$m){return Math.sqrt((this.x-S$a)*(this.x-S$a)+(this.y-S$m)*(this.y-S$m))},S$m.toString=function(){return this.x+","+this.y},S$m.normalize=function(){var S$a=Math.sqrt(this.x*this.x+this.y*this.y);if(0<S$a){var S$m=1/S$a;this.x*=S$m,this.y*=S$m}},S$a.TEMP=new S$a,S$a.EMPTY=new S$a,S$a}(),S$l=function(){function S$j(S$a,S$m,S$s,S$P){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0),this.x=S$a,this.y=S$m,this.width=S$s,this.height=S$P}S$G(S$j,"laya.maths.Rectangle");var S$a=S$j.prototype;return S$a.setTo=function(S$a,S$m,S$s,S$P){return this.x=S$a,this.y=S$m,this.width=S$s,this.height=S$P,this},S$a.copyFrom=function(S$a){return this.x=S$a.x,this.y=S$a.y,this.width=S$a.width,this.height=S$a.height,this},S$a.contains=function(S$a,S$m){return!(this.width<=0||this.height<=0)&&(S$a>=this.x&&S$a<this.right&&S$m>=this.y&&S$m<this.bottom)},S$a.intersects=function(S$a){return!(S$a.x>this.x+this.width||S$a.x+S$a.width<this.x||S$a.y>this.y+this.height||S$a.y+S$a.height<this.y)},S$a.intersection=function(S$a,S$m){return this.intersects(S$a)?(S$m||(S$m=new S$j),S$m.x=Math.max(this.x,S$a.x),S$m.y=Math.max(this.y,S$a.y),S$m.width=Math.min(this.right,S$a.right)-S$m.x,S$m.height=Math.min(this.bottom,S$a.bottom)-S$m.y,S$m):null},S$a.union=function(S$a,S$m){return S$m||(S$m=new S$j),this.clone(S$m),S$a.width<=0||S$a.height<=0?S$m:(S$m.addPoint(S$a.x,S$a.y),S$m.addPoint(S$a.right,S$a.bottom),this)},S$a.clone=function(S$a){return S$a||(S$a=new S$j),S$a.x=this.x,S$a.y=this.y,S$a.width=this.width,S$a.height=this.height,S$a},S$a.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},S$a.equals=function(S$a){return!(!S$a||S$a.x!==this.x||S$a.y!==this.y||S$a.width!==this.width||S$a.height!==this.height)},S$a.addPoint=function(S$a,S$m){return this.x>S$a&&(this.width+=this.x-S$a,this.x=S$a),this.y>S$m&&(this.height+=this.y-S$m,this.y=S$m),this.width<S$a-this.x&&(this.width=S$a-this.x),this.height<S$m-this.y&&(this.height=S$m-this.y),this},S$a._getBoundPoints=function(){var S$a=S$j._temB;return(S$a.length=0)==this.width||0==this.height||S$a.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),S$a},S$a.isEmpty=function(){return this.width<=0||this.height<=0},S$q(0,S$a,"right",function(){return this.x+this.width}),S$q(0,S$a,"bottom",function(){return this.y+this.height}),S$j._getBoundPointS=function(S$a,S$m,S$s,S$P){var S$_=S$j._temA;return(S$_.length=0)==S$s||0==S$P||S$_.push(S$a,S$m,S$a+S$s,S$m,S$a,S$m+S$P,S$a+S$s,S$m+S$P),S$_},S$j._getWrapRec=function(S$a,S$m){if(!S$a||S$a.length<1)return S$m?S$m.setTo(0,0,0,0):S$j.TEMP.setTo(0,0,0,0);S$m=S$m||new S$j;var S$s,S$P,S$_,S$e,S$A,S$B=S$a.length,S$k=S$U.TEMP;for(S$_=S$A=-(S$P=S$e=99999),S$s=0;S$s<S$B;S$s+=2)S$k.x=S$a[S$s],S$k.y=S$a[S$s+1],S$P=S$P<S$k.x?S$P:S$k.x,S$e=S$e<S$k.y?S$e:S$k.y,S$_=S$_>S$k.x?S$_:S$k.x,S$A=S$A>S$k.y?S$A:S$k.y;return S$m.setTo(S$P,S$e,S$_-S$P,S$A-S$e)},S$j.EMPTY=new S$j,S$j.TEMP=new S$j,S$j._temB=[],S$j._temA=[],S$j}(),S$K=function(){function S$k(){}return S$G(S$k,"laya.media.SoundManager"),S$q(1,S$k,"useAudioMusic",function(){return S$k._useAudioMusic},function(S$a){S$k._useAudioMusic=S$a,S$k._musicClass=S$a?S$sa:null}),S$q(1,S$k,"autoStopMusic",function(){return S$k._autoStopMusic},function(S$a){S$z.stage.off("blur",null,S$k._stageOnBlur),S$z.stage.off("focus",null,S$k._stageOnFocus),S$z.stage.off("visibilitychange",null,S$k._visibilityChange),(S$k._autoStopMusic=S$a)&&(S$z.stage.on("blur",null,S$k._stageOnBlur),S$z.stage.on("focus",null,S$k._stageOnFocus),S$z.stage.on("visibilitychange",null,S$k._visibilityChange))}),S$q(1,S$k,"muted",function(){return S$k._muted},function(S$a){S$a!=S$k._muted&&(S$a&&S$k.stopAllSound(),S$k.musicMuted=S$a,S$k._muted=S$a)}),S$q(1,S$k,"musicMuted",function(){return S$k._musicMuted},function(S$a){S$a!=S$k._musicMuted&&(S$a?(S$k._tMusic&&S$k._musicChannel&&!S$k._musicChannel.isStopped?S$k._musicChannel.pause():S$k._musicChannel=null,S$k._musicMuted=S$a):(S$k._musicMuted=S$a,S$k._tMusic&&S$k._musicChannel&&S$k._musicChannel.resume()))}),S$q(1,S$k,"soundMuted",function(){return S$k._soundMuted},function(S$a){S$k._soundMuted=S$a}),S$k.addChannel=function(S$a){0<=S$k._channels.indexOf(S$a)||(S$k._channels.push(S$a),S$k.autoReleaseSound&&0!=S$k._notUsedCount&&S$k._notUsedUrls[S$a.url]&&(delete S$k._notUsedUrls[S$a.url],0==--S$k._notUsedCount&&S$z.timer.clear(S$k,S$k.disposeSoundIfNotUsed)))},S$k.removeChannel=function(S$a){var S$m=S$k._channels,S$s=S$m.indexOf(S$a);if(-1!=S$s&&(S$m.splice(S$s,1),S$k.autoReleaseSound)){var S$P=S$a.url,S$_=S$k.defaultIntervals[S$P]||2e4;if(0<S$_){var S$e=!0;for(S$s=S$m.length-1;0<=S$s;S$s--)if(S$m[S$s].url==S$P){S$e=!1;break}S$e&&(S$k._notUsedUrls[S$P]=Date.now()+S$_,0==S$k._notUsedCount++&&S$z.timer.loop(1e4,S$k,S$k.disposeSoundIfNotUsed))}}},S$k.disposeSoundIfNotUsed=function(){var S$a=S$k._notUsedUrls;if(0!=S$k._notUsedCount){var S$m=Date.now();for(var S$s in S$a)S$m>=S$a[S$s]&&(delete S$a[S$s],--S$k._notUsedCount,S$k.destroySound(S$s));if(0!=S$k._notUsedCount)return}S$z.timer.clear(S$k,S$k.disposeSoundIfNotUsed)},S$k._visibilityChange=function(){S$z.stage.isVisibility?S$k._stageOnFocus():S$k._stageOnBlur()},S$k._stageOnBlur=function(){S$k._isActive=!1,S$k._musicChannel&&(S$k._musicChannel.isStopped||(S$k._blurPaused=!0,S$k._musicChannel.pause())),S$k.stopAllSound(),S$z.stage.once("mousedown",null,S$k._stageOnFocus)},S$k._recoverWebAudio=function(){S$ea.ctx&&"running"!=S$ea.ctx.state&&S$ea.ctx.resume&&S$ea.ctx.resume()},S$k._stageOnFocus=function(){if(S$k._isActive=!0,S$k._recoverWebAudio(),S$z.stage.off("mousedown",null,S$k._stageOnFocus),S$k._blurPaused){var S$a=S$k._musicChannel;S$a&&S$k._music&&S$a.isStopped&&(S$k._blurPaused=!1,S$k._music._disposed?S$k.playMusic(S$a.url,S$a.loops,S$a.startHandler,S$a.completeHandler,S$a.startTime):S$a.audioBuffer?S$a.resume():S$k._music.play(S$a.startTime,S$a.loops,S$a.startHandler,S$a))}},S$k.playSound=function(S$a,S$m,S$s,S$P,S$_,S$e){if(void 0===S$m&&(S$m=1),void 0===S$e&&(S$e=0),!S$a)return null;if(S$k._muted)return null;if(S$k._recoverWebAudio(),S$a==S$k._tMusic){if(S$k._musicMuted)return null}else{if(!S$k._isActive)return null;if(S$k._soundMuted)return null}var S$A,S$B=S$k._pool[S$a];return S$_||(S$_=S$k._soundClass),S$B||((S$B=new S$_).load(S$a),S$k._pool[S$a]=S$B),(S$A=S$B.play(S$e,S$m,S$s))?(S$a==S$k._tMusic&&(S$k._music=S$B,S$k._isActive||(S$k._blurPaused=!0,S$A.pause())),S$A.url=S$a,S$A.volume=S$a==S$k._tMusic?S$k.musicVolume:S$k.soundVolume,S$A.completeHandler=S$P,S$A):null},S$k.destroySound=function(S$a){var S$m=S$k._pool[S$a];S$m&&(delete S$k._pool[S$a],S$m.dispose())},S$k.playMusic=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$m&&(S$m=0),void 0===S$_&&(S$_=0),S$k._tMusic=S$a,S$k._musicChannel&&S$k._musicChannel.stop(),S$k._musicChannel=S$k.playSound(S$a,S$m,S$s,S$P,null,S$_)},S$k.stopSound=function(S$a){for(var S$m,S$s=S$k._channels.length-1;0<=S$s;S$s--)(S$m=S$k._channels[S$s]).url==S$a&&S$m.stop()},S$k.stopAll=function(){S$k._tMusic=null;var S$a=0;for(S$a=S$k._channels.length-1;0<=S$a;S$a--)S$k._channels[S$a].stop()},S$k.stopAllSound=function(){var S$a,S$m=0;for(S$m=S$k._channels.length-1;0<=S$m;S$m--)(S$a=S$k._channels[S$m]).url!=S$k._tMusic&&S$a.stop()},S$k.stopMusic=function(){S$k._musicChannel&&S$k._musicChannel.stop(),S$k._tMusic=null},S$k.setSoundVolume=function(S$a,S$m){if(S$m)S$k._setVolume(S$m,S$a);else{S$k.soundVolume=S$a;var S$s,S$P=0;for(S$P=S$k._channels.length-1;0<=S$P;S$P--)(S$s=S$k._channels[S$P]).url!=S$k._tMusic&&(S$s.volume=S$a)}},S$k.setMusicVolume=function(S$a){S$k.musicVolume=S$a,S$k._setVolume(S$k._tMusic,S$a)},S$k._setVolume=function(S$a,S$m){for(var S$s,S$P=S$k._channels.length-1;0<=S$P;S$P--)(S$s=S$k._channels[S$P]).url==S$a&&(S$s.volume=S$m)},S$k.musicVolume=1,S$k.soundVolume=1,S$k.playbackRate=1,S$k._useAudioMusic=!0,S$k._muted=!1,S$k._soundMuted=!1,S$k._musicMuted=!1,S$k._tMusic=null,S$k._musicChannel=null,S$k._music=null,S$k._channels=[],S$k._autoStopMusic=!1,S$k._blurPaused=!1,S$k._isActive=!0,S$k._soundClass=null,S$k._musicClass=null,S$k.autoReleaseSound=!0,S$k._pool={},S$k.defaultIntervals={},S$k._notUsedUrls={},S$k._notUsedCount=0,S$k}(),S$C=function(){var S$a;function S$s(){}return S$G(S$s,"laya.net.LocalStorage"),S$s.__init__=function(){S$s._baseClass||(S$s._baseClass=S$a).init(),S$s.items=S$s._baseClass.items,S$s.support=S$s._baseClass.support},S$s.setItem=function(S$a,S$m){S$s._baseClass.setItem(S$a,S$m)},S$s.getItem=function(S$a){return S$s._baseClass.getItem(S$a)},S$s.setJSON=function(S$a,S$m){S$s._baseClass.setJSON(S$a,S$m)},S$s.getJSON=function(S$a){return S$s._baseClass.getJSON(S$a)},S$s.removeItem=function(S$a){S$s._baseClass.removeItem(S$a)},S$s.clear=function(){S$s._baseClass.clear()},S$s._baseClass=null,S$s.items=null,S$s.support=!1,S$s.__init$=function(){S$a=function(){function S$s(){}return S$G(S$s,""),S$s.init=function(){try{S$s.support=!0,S$s.items=S$A.localStorage,S$s.setItem("laya","1"),S$s.removeItem("laya")}catch(S$a){S$s.support=!1}S$s.support||console.log("LocalStorage is not supprot or browser is private mode.")},S$s.setItem=function(S$a,S$m){try{S$s.support&&S$s.items.setItem(S$a,S$m)}catch(S$a){console.warn("set localStorage failed",S$a)}},S$s.getItem=function(S$a){return S$s.support?S$s.items.getItem(S$a):null},S$s.setJSON=function(S$a,S$m){try{S$s.support&&S$s.items.setItem(S$a,JSON.stringify(S$m))}catch(S$a){console.warn("set localStorage failed",S$a)}},S$s.getJSON=function(S$a){return JSON.parse(S$s.support?S$s.items.getItem(S$a):null)},S$s.removeItem=function(S$a){S$s.support&&S$s.items.removeItem(S$a)},S$s.clear=function(){S$s.support&&S$s.items.clear()},S$s.items=null,S$s.support=!1,S$s}()},S$s}(),S$b=(function(){function S$P(){}S$G(S$P,"laya.net.ResourceVersion"),S$P.enable=function(S$a,S$m,S$s){void 0===S$s&&(S$s=2),laya.net.ResourceVersion.type=S$s,S$z.loader.load(S$a,S$p.create(null,S$P.onManifestLoaded,[S$m]),null,"json"),S$S.customFormat=S$P.addVersionPrefix},S$P.onManifestLoaded=function(S$a,S$m){S$P.manifest=S$m,S$a.run(),S$m||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},S$P.addVersionPrefix=function(S$a){return S$P.manifest&&S$P.manifest[S$a]?2==S$P.type?S$P.manifest[S$a]:S$P.manifest[S$a]+"/"+S$a:S$a},S$P.FOLDER_VERSION=1,S$P.FILENAME_VERSION=2,S$P.manifest=null,S$P.type=1}(),function(){function S$a(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}S$G(S$a,"laya.net.TTFLoader");var S$m=S$a.prototype;return S$m.load=function(S$a){var S$m=(this._url=S$a).split(".ttf")[0].split("/");this.fontName=S$m[S$m.length-1],S$L.window.conch?this._loadConch():S$L.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},S$m._loadConch=function(){this._http=new S$Aa,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},S$m._onHttpLoaded=function(S$a){S$L.window.conch.setFontFaceFromBuffer(this.fontName,S$a),this._clearHttp(),this._complete()},S$m._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},S$m._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},S$m._complete=function(){S$z.timer.clear(this,this._complete),S$z.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},S$m._checkComplete=function(){S$V.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},S$m._loadWithFontFace=function(){var S$a=new S$L.window.FontFace(this.fontName,"url('"+this._url+"')");S$L.window.document.fonts.add(S$a);var S$m=this;S$a.loaded.then(function(){S$m._complete()}),S$a.load()},S$m._createDiv=function(){this._div=S$L.createElement("div"),this._div.innerHTML="laya";var S$a=this._div.style;S$a.fontFamily=this.fontName,S$a.position="absolute",S$a.left="-100px",S$a.top="-100px",S$L.document.body.appendChild(this._div)},S$m._loadWithCSS=function(){var S$a=this,S$m=S$L.createElement("style");S$m.type="text/css",S$L.document.body.appendChild(S$m),S$m.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=S$V.measureText("LayaTTFFont",this._fontTxt).width;var S$s=this;S$m.onload=function(){S$z.timer.once(1e4,S$s,S$a._complete)},S$z.timer.loop(20,this,this._checkComplete),this._createDiv()},S$a._testString="LayaTTFFont",S$a}()),S$S=function(){function S$P(S$a){this._url=null,this._path=null,this._url=S$P.formatURL(S$a),this._path=S$P.getPath(S$a)}S$G(S$P,"laya.net.URL");var S$a=S$P.prototype;return S$q(0,S$a,"path",function(){return this._path}),S$q(0,S$a,"url",function(){return this._url}),S$P.formatURL=function(S$a,S$m){if(!S$a)return"null path";if(0<S$a.indexOf(":"))return S$a;null!=S$P.customFormat&&(S$a=S$P.customFormat(S$a,S$m));var S$s=S$a.charAt(0);if("."===S$s)return S$P.formatRelativePath((S$m||S$P.basePath)+S$a);if("~"===S$s)return S$P.rootPath+S$a.substring(1);if("d"===S$s){if(0===S$a.indexOf("data:image"))return S$a}else if("/"===S$s)return S$a;return(S$m||S$P.basePath)+S$a},S$P.formatRelativePath=function(S$a){for(var S$m=S$a.split("/"),S$s=0,S$P=S$m.length;S$s<S$P;S$s++)".."==S$m[S$s]&&(S$m.splice(S$s-1,2),S$s-=2);return S$m.join("/")},S$P.isAbsolute=function(S$a){return 0<S$a.indexOf(":")||"/"==S$a.charAt(0)},S$P.getPath=function(S$a){var S$m=S$a.lastIndexOf("/");return 0<S$m?S$a.substr(0,S$m+1):""},S$P.getFileName=function(S$a){var S$m=S$a.lastIndexOf("/");return 0<S$m?S$a.substr(S$m+1):S$a},S$P.version={},S$P.basePath="",S$P.rootPath="",S$P.customFormat=function(S$a){var S$m=S$P.version[S$a];return!S$Z.isConchApp&&S$m&&(S$a+="?v="+S$m),S$a},S$P}(),S$Z=function(){function S$_(S$a,S$m){this._timeId=0;var S$s=S$_._mainCanvas.source.style;S$s.position="absolute",S$s.top=S$s.left="0px",S$s.background="#000000",S$_._mainCanvas.source.id="layaCanvas";var S$P=laya.renders.Render.isWebGL;S$_._mainCanvas.source.width=S$a,S$_._mainCanvas.source.height=S$m,S$P&&S$_.WebGL.init(S$_._mainCanvas,S$a,S$m),S$L.container.appendChild(S$_._mainCanvas.source),(S$_._context=new S$X(S$a,S$m,S$P?null:S$_._mainCanvas)).ctx.setIsMainContext(),S$L.window.requestAnimationFrame(function S$a(S$m){S$L.window.requestAnimationFrame(S$a);S$z.stage._loop()}),S$z.stage.on("visibilitychange",this,this._onVisibilitychange)}S$G(S$_,"laya.renders.Render");var S$a=S$_.prototype;return S$a._onVisibilitychange=function(){S$z.stage.isVisibility?0!=this._timeId&&S$L.window.clearInterval(this._timeId):this._timeId=S$L.window.setInterval(this._enterFrame,1e3)},S$a._enterFrame=function(S$a){S$z.stage._loop()},S$q(1,S$_,"context",function(){return S$_._context}),S$q(1,S$_,"canvas",function(){return S$_._mainCanvas.source}),S$_._context=null,S$_._mainCanvas=null,S$_.WebGL=null,S$_.isConchNode=!1,S$_.isConchApp=!1,S$_.isConchWebGL=!1,S$_.isWebGL=!1,S$_.is3DMode=!1,S$_.optimizeTextureMemory=function(S$a,S$m){return!0},S$_.__init$=function(){S$A.ConchRenderType=S$A.ConchRenderType||1,S$A.ConchRenderType|=S$A.conch?4:0,S$_.isConchNode=5==(5&S$A.ConchRenderType),S$_.isConchApp=4==(4&S$A.ConchRenderType),S$_.isConchWebGL=6==S$A.ConchRenderType},S$_}(),S$X=function(){function S$A(S$a,S$m,S$s){this.x=0,this.y=0,this._drawTexture=function(S$a,S$m,S$s){S$s[0].loaded&&this.ctx.drawTexture(S$s[0],S$s[1],S$s[2],S$s[3],S$s[4],S$a,S$m)},this._fillTexture=function(S$a,S$m,S$s){S$s[0].loaded&&this.ctx.fillTexture(S$s[0],S$s[1]+S$a,S$s[2]+S$m,S$s[3],S$s[4],S$s[5],S$s[6],S$s[7])},this._drawTextureWithTransform=function(S$a,S$m,S$s){S$s[0].loaded&&this.ctx.drawTextureWithTransform(S$s[0],S$s[1],S$s[2],S$s[3],S$s[4],S$s[5],S$a,S$m,S$s[6])},this._fillQuadrangle=function(S$a,S$m,S$s){this.ctx.fillQuadrangle(S$s[0],S$s[1],S$s[2],S$s[3],S$s[4])},this._drawRect=function(S$a,S$m,S$s){var S$P=this.ctx;null!=S$s[4]&&(S$P.fillStyle=S$s[4],S$P.fillRect(S$a+S$s[0],S$m+S$s[1],S$s[2],S$s[3],null)),null!=S$s[5]&&(S$P.strokeStyle=S$s[5],S$P.lineWidth=S$s[6],S$P.strokeRect(S$a+S$s[0],S$m+S$s[1],S$s[2],S$s[3],S$s[6]))},this._drawPie=function(S$a,S$m,S$s){var S$P=this.ctx;S$Z.isWebGL&&S$P.setPathId(S$s[8]),S$P.beginPath(),S$Z.isWebGL?(S$P.movePath(S$s[0]+S$a,S$s[1]+S$m),S$P.moveTo(0,0)):S$P.moveTo(S$a+S$s[0],S$m+S$s[1]),S$P.arc(S$a+S$s[0],S$m+S$s[1],S$s[2],S$s[3],S$s[4]),S$P.closePath(),this._fillAndStroke(S$s[5],S$s[6],S$s[7],!0)},this._clipRect=function(S$a,S$m,S$s){this.ctx.clipRect(S$a+S$s[0],S$m+S$s[1],S$s[2],S$s[3])},this._fillRect=function(S$a,S$m,S$s){this.ctx.fillRect(S$a+S$s[0],S$m+S$s[1],S$s[2],S$s[3],S$s[4])},this._drawCircle=function(S$a,S$m,S$s){var S$P=this.ctx;S$Z.isWebGL&&S$P.setPathId(S$s[6]),S$v.drawCall++,S$P.beginPath(),S$Z.isWebGL&&S$P.movePath(S$s[0]+S$a,S$s[1]+S$m),S$P.arc(S$s[0]+S$a,S$s[1]+S$m,S$s[2],0,S$A.PI2),S$P.closePath(),this._fillAndStroke(S$s[3],S$s[4],S$s[5],!0)},this._fillCircle=function(S$a,S$m,S$s){S$v.drawCall++;var S$P=this.ctx;S$P.beginPath(),S$P.fillStyle=S$s[3],S$P.arc(S$s[0]+S$a,S$s[1]+S$m,S$s[2],0,S$A.PI2),S$P.fill()},this._setShader=function(S$a,S$m,S$s){this.ctx.setShader(S$s[0])},this._drawLine=function(S$a,S$m,S$s){var S$P=this.ctx;S$Z.isWebGL&&S$P.setPathId(S$s[6]),S$P.beginPath(),S$P.strokeStyle=S$s[4],S$P.lineWidth=S$s[5],S$Z.isWebGL?(S$P.movePath(S$a,S$m),S$P.moveTo(S$s[0],S$s[1]),S$P.lineTo(S$s[2],S$s[3])):(S$P.moveTo(S$a+S$s[0],S$m+S$s[1]),S$P.lineTo(S$a+S$s[2],S$m+S$s[3])),S$P.stroke()},this._drawLines=function(S$a,S$m,S$s){var S$P=this.ctx;S$Z.isWebGL&&S$P.setPathId(S$s[5]),S$P.beginPath(),S$a+=S$s[0],S$m+=S$s[1],S$Z.isWebGL&&S$P.movePath(S$a,S$m),S$P.strokeStyle=S$s[3],S$P.lineWidth=S$s[4];var S$_=S$s[2],S$e=2,S$A=S$_.length;if(S$Z.isWebGL)for(S$P.moveTo(S$_[0],S$_[1]);S$e<S$A;)S$P.lineTo(S$_[S$e++],S$_[S$e++]);else for(S$P.moveTo(S$a+S$_[0],S$m+S$_[1]);S$e<S$A;)S$P.lineTo(S$a+S$_[S$e++],S$m+S$_[S$e++]);S$P.stroke()},this._drawLinesWebGL=function(S$a,S$m,S$s){this.ctx.drawLines(S$a+this.x+S$s[0],S$m+this.y+S$s[1],S$s[2],S$s[3],S$s[4])},this._drawCurves=function(S$a,S$m,S$s){this.ctx.drawCurves(S$a,S$m,S$s)},this._draw=function(S$a,S$m,S$s){S$s[0].call(null,this,S$a,S$m)},this._transformByMatrix=function(S$a,S$m,S$s){this.ctx.transformByMatrix(S$s[0])},this._setTransform=function(S$a,S$m,S$s){this.ctx.setTransform(S$s[0],S$s[1],S$s[2],S$s[3],S$s[4],S$s[5])},this._setTransformByMatrix=function(S$a,S$m,S$s){this.ctx.setTransformByMatrix(S$s[0])},this._save=function(S$a,S$m,S$s){this.ctx.save()},this._restore=function(S$a,S$m,S$s){this.ctx.restore()},this._translate=function(S$a,S$m,S$s){this.ctx.translate(S$s[0],S$s[1])},this._transform=function(S$a,S$m,S$s){this.ctx.translate(S$s[1]+S$a,S$s[2]+S$m);var S$P=S$s[0];this.ctx.transform(S$P.a,S$P.b,S$P.c,S$P.d,S$P.tx,S$P.ty),this.ctx.translate(-S$a-S$s[1],-S$m-S$s[2])},this._rotate=function(S$a,S$m,S$s){this.ctx.translate(S$s[1]+S$a,S$s[2]+S$m),this.ctx.rotate(S$s[0]),this.ctx.translate(-S$a-S$s[1],-S$m-S$s[2])},this._scale=function(S$a,S$m,S$s){this.ctx.translate(S$s[2]+S$a,S$s[3]+S$m),this.ctx.scale(S$s[0],S$s[1]),this.ctx.translate(-S$a-S$s[2],-S$m-S$s[3])},this._alpha=function(S$a,S$m,S$s){this.ctx.globalAlpha*=S$s[0]},this._setAlpha=function(S$a,S$m,S$s){this.ctx.globalAlpha=S$s[0]},this._fillText=function(S$a,S$m,S$s){this.ctx.fillText(S$s[0],S$s[1]+S$a,S$s[2]+S$m,S$s[3],S$s[4],S$s[5])},this._strokeText=function(S$a,S$m,S$s){this.ctx.strokeText(S$s[0],S$s[1]+S$a,S$s[2]+S$m,S$s[3],S$s[4],S$s[5],S$s[6])},this._fillBorderText=function(S$a,S$m,S$s){this.ctx.fillBorderText(S$s[0],S$s[1]+S$a,S$s[2]+S$m,S$s[3],S$s[4],S$s[5],S$s[6],S$s[7])},this._blendMode=function(S$a,S$m,S$s){this.ctx.globalCompositeOperation=S$s[0]},this._beginClip=function(S$a,S$m,S$s){this.ctx.beginClip&&this.ctx.beginClip(S$a+S$s[0],S$m+S$s[1],S$s[2],S$s[3])},this._setIBVB=function(S$a,S$m,S$s){this.ctx.setIBVB(S$s[0]+S$a,S$s[1]+S$m,S$s[2],S$s[3],S$s[4],S$s[5],S$s[6],S$s[7])},this._fillTrangles=function(S$a,S$m,S$s){this.ctx.fillTrangles(S$s[0],S$s[1]+S$a,S$s[2]+S$m,S$s[3],S$s[4])},this._drawPath=function(S$a,S$m,S$s){var S$P=this.ctx;S$Z.isWebGL&&S$P.setPathId(-1),S$P.beginPath(),S$a+=S$s[0],S$m+=S$s[1],S$Z.isWebGL&&S$P.movePath(S$a,S$m);for(var S$_=S$s[2],S$e=0,S$A=S$_.length;S$e<S$A;S$e++){var S$B=S$_[S$e];switch(S$B[0]){case"moveTo":S$Z.isWebGL?S$P.moveTo(S$B[1],S$B[2]):S$P.moveTo(S$a+S$B[1],S$m+S$B[2]);break;case"lineTo":S$Z.isWebGL?S$P.lineTo(S$B[1],S$B[2]):S$P.lineTo(S$a+S$B[1],S$m+S$B[2]);break;case"arcTo":S$Z.isWebGL?S$P.arcTo(S$B[1],S$B[2],S$B[3],S$B[4],S$B[5]):S$P.arcTo(S$a+S$B[1],S$m+S$B[2],S$a+S$B[3],S$m+S$B[4],S$B[5]);break;case"closePath":S$P.closePath()}}var S$k=S$s[3];null!=S$k&&(S$P.fillStyle=S$k.fillStyle,S$P.fill());var S$j=S$s[4];null!=S$j&&(S$P.strokeStyle=S$j.strokeStyle,S$P.lineWidth=S$j.lineWidth||1,S$P.lineJoin=S$j.lineJoin,S$P.lineCap=S$j.lineCap,S$P.miterLimit=S$j.miterLimit,S$P.stroke())},this.drawPoly=function(S$a,S$m,S$s){this.ctx.drawPoly(S$a+this.x+S$s[0],S$m+this.y+S$s[1],S$s[2],S$s[3],S$s[4],S$s[5],S$s[6])},this._drawPoly=function(S$a,S$m,S$s){var S$P=this.ctx,S$_=S$s[2],S$e=2,S$A=S$_.length;if(S$Z.isWebGL)for(S$P.setPathId(S$s[6]),S$P.beginPath(),S$a+=S$s[0],S$m+=S$s[1],S$P.movePath(S$a,S$m),S$P.moveTo(S$_[0],S$_[1]);S$e<S$A;)S$P.lineTo(S$_[S$e++],S$_[S$e++]);else for(S$P.beginPath(),S$a+=S$s[0],S$m+=S$s[1],S$P.moveTo(S$a+S$_[0],S$m+S$_[1]);S$e<S$A;)S$P.lineTo(S$a+S$_[S$e++],S$m+S$_[S$e++]);S$P.closePath(),this._fillAndStroke(S$s[3],S$s[4],S$s[5],S$s[7])},this._drawSkin=function(S$a,S$m,S$s){var S$P=S$s[0];if(S$P){var S$_=this.ctx;S$P.render(S$_,S$a,S$m)}},this._drawParticle=function(S$a,S$m,S$s){this.ctx.drawParticle(S$a+this.x,S$m+this.y,S$s[0])},this._setFilters=function(S$a,S$m,S$s){this.ctx.setFilters(S$s)},S$s?this.ctx=S$s.getContext("2d"):(S$s=S$ca.create("3D"),this.ctx=S$V.createWebGLContext2D(S$s),S$s._setContext(this.ctx)),S$s.size(S$a,S$m),this.canvas=S$s}S$G(S$A,"laya.renders.RenderContext");var S$a=S$A.prototype;return S$a.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},S$a.drawTexture=function(S$a,S$m,S$s,S$P,S$_){S$a.loaded&&this.ctx.drawTexture(S$a,S$m,S$s,S$P,S$_,this.x,this.y)},S$a._drawTextures=function(S$a,S$m,S$s){S$s[0].loaded&&this.ctx.drawTextures(S$s[0],S$s[1],S$a+this.x,S$m+this.y)},S$a.drawTextureWithTransform=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$a.loaded&&this.ctx.drawTextureWithTransform(S$a,S$m,S$s,S$P,S$_,S$e,this.x,this.y,S$A)},S$a.fillQuadrangle=function(S$a,S$m,S$s,S$P,S$_){this.ctx.fillQuadrangle(S$a,S$m,S$s,S$P,S$_)},S$a.drawCanvas=function(S$a,S$m,S$s,S$P,S$_){this.ctx.drawCanvas(S$a,S$m+this.x,S$s+this.y,S$P,S$_)},S$a.drawRect=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$e&&(S$e=1);var S$A=this.ctx;S$A.strokeStyle=S$_,S$A.lineWidth=S$e,S$A.strokeRect(S$a+this.x,S$m+this.y,S$s,S$P,S$e)},S$a._fillAndStroke=function(S$a,S$m,S$s,S$P){void 0===S$P&&(S$P=!1);var S$_=this.ctx;null!=S$a&&(S$_.fillStyle=S$a,S$Z.isWebGL?S$_.fill(S$P):S$_.fill()),null!=S$m&&0<S$s&&(S$_.strokeStyle=S$m,S$_.lineWidth=S$s,S$_.stroke())},S$a.clipRect=function(S$a,S$m,S$s,S$P){this.ctx.clipRect(S$a+this.x,S$m+this.y,S$s,S$P)},S$a.fillRect=function(S$a,S$m,S$s,S$P,S$_){this.ctx.fillRect(S$a+this.x,S$m+this.y,S$s,S$P,S$_)},S$a.drawCircle=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=1),S$v.drawCall++;var S$e=this.ctx;S$e.beginPath(),S$e.strokeStyle=S$P,S$e.lineWidth=S$_,S$e.arc(S$a+this.x,S$m+this.y,S$s,0,S$A.PI2),S$e.stroke()},S$a.drawTriangles=function(S$a,S$m,S$s){if(S$Z.isWebGL)this.ctx.drawTriangles(S$s[0],S$a+S$s[1],S$m+S$s[2],S$s[3],S$s[4],S$s[5],S$s[6],S$s[7],S$s[8],S$s[9]);else{var S$P=S$s[5],S$_=0,S$e=S$P.length,S$A=this.ctx;for(S$_=0;S$_<S$e;S$_+=3){var S$B=2*S$P[S$_],S$k=2*S$P[S$_+1],S$j=2*S$P[S$_+2];S$A.drawTriangle(S$s[0],S$s[3],S$s[4],S$B,S$k,S$j,S$s[6],!0)}}},S$a.fillCircle=function(S$a,S$m,S$s,S$P){S$v.drawCall++;var S$_=this.ctx;S$_.beginPath(),S$_.fillStyle=S$P,S$_.arc(S$a+this.x,S$m+this.y,S$s,0,S$A.PI2),S$_.fill()},S$a.setShader=function(S$a){this.ctx.setShader(S$a)},S$a.drawLine=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$e&&(S$e=1);var S$A=this.ctx;S$A.beginPath(),S$A.strokeStyle=S$_,S$A.lineWidth=S$e,S$A.moveTo(this.x+S$a,this.y+S$m),S$A.lineTo(this.x+S$s,this.y+S$P),S$A.stroke()},S$a.clear=function(){this.ctx.clear()},S$a.transformByMatrix=function(S$a){this.ctx.transformByMatrix(S$a)},S$a.setTransform=function(S$a,S$m,S$s,S$P,S$_,S$e){this.ctx.setTransform(S$a,S$m,S$s,S$P,S$_,S$e)},S$a.setTransformByMatrix=function(S$a){this.ctx.setTransformByMatrix(S$a)},S$a.save=function(){this.ctx.save()},S$a.restore=function(){this.ctx.restore()},S$a.translate=function(S$a,S$m){this.ctx.translate(S$a,S$m)},S$a.transform=function(S$a,S$m,S$s,S$P,S$_,S$e){this.ctx.transform(S$a,S$m,S$s,S$P,S$_,S$e)},S$a.rotate=function(S$a){this.ctx.rotate(S$a)},S$a.scale=function(S$a,S$m){this.ctx.scale(S$a,S$m)},S$a.alpha=function(S$a){this.ctx.globalAlpha*=S$a},S$a.setAlpha=function(S$a){this.ctx.globalAlpha=S$a},S$a.fillWords=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$e&&(S$e=0),this.ctx.fillWords(S$a,S$m,S$s,S$P,S$_,S$e)},S$a.fillBorderWords=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this.ctx.fillBorderWords(S$a,S$m,S$s,S$P,S$_,S$e,S$A)},S$a.fillText=function(S$a,S$m,S$s,S$P,S$_,S$e){this.ctx.fillText(S$a,S$m+this.x,S$s+this.y,S$P,S$_,S$e)},S$a.strokeText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this.ctx.strokeText(S$a,S$m+this.x,S$s+this.y,S$P,S$_,S$e,S$A)},S$a.blendMode=function(S$a){this.ctx.globalCompositeOperation=S$a},S$a.flush=function(){this.ctx.flush&&this.ctx.flush()},S$a.addRenderObject=function(S$a){this.ctx.addRenderObject(S$a)},S$a.beginClip=function(S$a,S$m,S$s,S$P){this.ctx.beginClip&&this.ctx.beginClip(S$a,S$m,S$s,S$P)},S$a.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},S$a.fillTrangles=function(S$a,S$m,S$s){this.ctx.fillTrangles(S$s[0],S$s[1],S$s[2],S$s[3],4<S$s.length?S$s[4]:null)},S$A.PI2=2*Math.PI,S$A}(),S$E=function(){function S$A(S$a,S$m){switch(this._next=S$m||S$A.NORENDER,S$a){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=S$O._filter);case 69905:return void(this._fun=S$A._initRenderFun)}this.onCreate(S$a)}S$G(S$A,"laya.renders.RenderSprite");var S$a=S$A.prototype;return S$a.onCreate=function(S$a){},S$a._style=function(S$a,S$m,S$s,S$P){S$a._style.render(S$a,S$m,S$s,S$P);var S$_=this._next;S$_._fun.call(S$_,S$a,S$m,S$s,S$P)},S$a._no=function(S$a,S$m,S$s,S$P){},S$a._custom=function(S$a,S$m,S$s,S$P){S$a.customRender(S$m,S$s,S$P);var S$_=S$a._style._tf;this._next._fun.call(this._next,S$a,S$m,S$s-S$_.translateX,S$P-S$_.translateY)},S$a._clip=function(S$a,S$m,S$s,S$P){var S$_=this._next;if(S$_!=S$A.NORENDER){var S$e=S$a._style.scrollRect;S$m.ctx.save(),S$m.ctx.clipRect(S$s,S$P,S$e.width,S$e.height),S$_._fun.call(S$_,S$a,S$m,S$s-S$e.x,S$P-S$e.y),S$m.ctx.restore()}},S$a._blend=function(S$a,S$m,S$s,S$P){var S$_=S$a._style;S$_.blendMode&&(S$m.ctx.globalCompositeOperation=S$_.blendMode);var S$e=this._next;S$e._fun.call(S$e,S$a,S$m,S$s,S$P),S$m.ctx.globalCompositeOperation="source-over"},S$a._mask=function(S$a,S$m,S$s,S$P){var S$_=this._next;S$_._fun.call(S$_,S$a,S$m,S$s,S$P);var S$e=S$a.mask;S$e&&(S$m.ctx.globalCompositeOperation="destination-in",(0<S$e.numChildren||!S$e.graphics._isOnlyOne())&&(S$e.cacheAsBitmap=!0),S$e.render(S$m,S$s-S$a.pivotX,S$P-S$a.pivotY)),S$m.ctx.globalCompositeOperation="source-over"},S$a._graphics=function(S$a,S$m,S$s,S$P){var S$_=S$a._style._tf;S$a._graphics&&S$a._graphics._render(S$a,S$m,S$s-S$_.translateX,S$P-S$_.translateY);var S$e=this._next;S$e._fun.call(S$e,S$a,S$m,S$s,S$P)},S$a._image=function(S$a,S$m,S$s,S$P){var S$_=S$a._style;S$m.ctx.drawTexture2(S$s,S$P,S$_._tf.translateX,S$_._tf.translateY,S$a.transform,S$_.alpha,S$_.blendMode,S$a._graphics._one)},S$a._image2=function(S$a,S$m,S$s,S$P){var S$_=S$a._style._tf;S$m.ctx.drawTexture2(S$s,S$P,S$_.translateX,S$_.translateY,S$a.transform,1,null,S$a._graphics._one)},S$a._alpha=function(S$a,S$m,S$s,S$P){var S$_;if(.01<(S$_=S$a._style.alpha)||S$a._needRepaint()){var S$e=S$m.ctx.globalAlpha;S$m.ctx.globalAlpha*=S$_;var S$A=this._next;S$A._fun.call(S$A,S$a,S$m,S$s,S$P),S$m.ctx.globalAlpha=S$e}},S$a._transform=function(S$a,S$m,S$s,S$P){var S$_=S$a.transform,S$e=this._next;S$_&&S$e!=S$A.NORENDER?(S$m.save(),S$m.transform(S$_.a,S$_.b,S$_.c,S$_.d,S$_.tx+S$s,S$_.ty+S$P),S$e._fun.call(S$e,S$a,S$m,0,0),S$m.restore()):S$e._fun.call(S$e,S$a,S$m,S$s,S$P)},S$a._childs=function(S$a,S$m,S$s,S$P){var S$_=S$a._style,S$e=S$_._tf;if(S$s=S$s-S$e.translateX+S$_.paddingLeft,S$P=S$P-S$e.translateY+S$_.paddingTop,S$_._calculation){var S$A=S$a._getWords();if(S$A){var S$B=S$_;S$B&&(S$B.stroke?S$m.fillBorderWords(S$A,S$s,S$P,S$B.font,S$B.color,S$B.strokeColor,S$B.stroke):S$m.fillWords(S$A,S$s,S$P,S$B.font,S$B.color,"none"!=S$B.textDecoration&&S$B.underLine?1:0))}}var S$k,S$j=S$a._childs,S$G=S$j.length;if(S$a.viewport||S$a.optimizeScrollRect&&S$a._style.scrollRect){var S$y=S$a.viewport||S$a._style.scrollRect,S$d=S$y.x,S$Q=S$y.y,S$q=S$y.right,S$h=S$y.bottom,S$u=NaN,S$O=NaN;for(S$p=0;S$p<S$G;++S$p)(S$k=S$j[S$p]).visible&&(S$u=S$k._x)<S$q&&S$u+S$k.width>S$d&&(S$O=S$k._y)<S$h&&S$O+S$k.height>S$Q&&S$k.render(S$m,S$s,S$P)}else for(var S$p=0;S$p<S$G;++S$p)(S$k=S$j[S$p])._style.visible&&S$k.render(S$m,S$s,S$P)},S$a._canvas=function(S$a,S$m,S$s,S$P){var S$_=S$a._$P.cacheCanvas;if(S$_){"bitmap"===S$_.type?S$v.canvasBitmap++:S$v.canvasNormal++;var S$e=S$_.ctx;if(S$a._needRepaint()||!S$e)this._canvas_repaint(S$a,S$m,S$s,S$P);else{var S$A=S$_._cacheRec;S$m.drawCanvas(S$e.canvas,S$s+S$A.x,S$P+S$A.y,S$A.width,S$A.height)}}else this._next._fun.call(this._next,S$a,S$m,S$s,S$P)},S$a._canvas_repaint=function(S$a,S$m,S$s,S$P){var S$_=S$a._$P.cacheCanvas,S$e=this._next;if(S$_){var S$A,S$B,S$k,S$j,S$G=S$_.ctx,S$y=S$a._needRepaint()||!S$G,S$d=S$_.type;if("bitmap"===S$d?S$v.canvasBitmap++:S$v.canvasNormal++,S$y){var S$Q,S$q;S$_._cacheRec||(S$_._cacheRec=new S$l),S$Z.isWebGL&&"bitmap"!==S$d?S$_._cacheRec.setTo(-S$a.pivotX,-S$a.pivotY,1,1):((S$j=S$a.getSelfBounds()).x=S$j.x-S$a.pivotX,S$j.y=S$j.y-S$a.pivotY,S$j.x=S$j.x-16,S$j.y=S$j.y-16,S$j.width=S$j.width+32,S$j.height=S$j.height+32,S$j.x=Math.floor(S$j.x+S$s)-S$s,S$j.y=Math.floor(S$j.y+S$P)-S$P,S$j.width=Math.floor(S$j.width),S$j.height=Math.floor(S$j.height),S$_._cacheRec.copyFrom(S$j)),S$j=S$_._cacheRec;var S$h,S$u=S$Z.isWebGL?1:S$L.pixelRatio*S$z.stage.clientScaleX,S$O=S$Z.isWebGL?1:S$L.pixelRatio*S$z.stage.clientScaleY;if(!S$Z.isWebGL){var S$p,S$c=1,S$H=1;for(S$p=S$a;S$p&&S$p!=S$z.stage;)S$c*=S$p.scaleX,S$H*=S$p.scaleY,S$p=S$p.parent;S$Z.isWebGL?(S$c<1&&(S$u*=S$c),S$H<1&&(S$O*=S$H)):(1<S$c&&(S$u*=S$c),1<S$H&&(S$O*=S$H))}if(S$a.scrollRect){var S$o=S$a.scrollRect;S$j.x-=S$o.x,S$j.y-=S$o.y}if(S$Q=S$j.width*S$u,S$q=S$j.height*S$O,S$B=S$j.x,S$k=S$j.y,S$Z.isWebGL&&"bitmap"===S$d&&(2048<S$Q||2048<S$q))return console.warn("cache bitmap size larger than 2048,cache ignored"),S$_.ctx&&(S$w.recover("RenderContext",S$_.ctx),S$_.ctx.canvas.size(0,0),S$_.ctx=null),void S$e._fun.call(S$e,S$a,S$m,S$s,S$P);if(S$G||(S$G=S$_.ctx=S$w.getItem("RenderContext")||new S$X(S$Q,S$q,S$ca.create("AUTO"))),S$G.ctx.sprite=S$a,(S$A=S$G.canvas).clear(),(S$A.width!=S$Q||S$A.height!=S$q)&&S$A.size(S$Q,S$q),"bitmap"===S$d?S$A.context.asBitmap=!0:"normal"===S$d&&(S$A.context.asBitmap=!1),1!=S$u||1!=S$O){var S$N=S$G.ctx;S$N.save(),S$N.scale(S$u,S$O),!S$Z.isConchWebGL&&S$Z.isConchApp&&(S$h=S$a._$P.cf)&&S$N.setFilterMatrix&&S$N.setFilterMatrix(S$h._mat,S$h._alpha),S$e._fun.call(S$e,S$a,S$G,-S$B,-S$k),S$N.restore(),S$Z.isConchApp&&!S$Z.isConchWebGL||S$a._applyFilters()}else S$N=S$G.ctx,!S$Z.isConchWebGL&&S$Z.isConchApp&&(S$h=S$a._$P.cf)&&S$N.setFilterMatrix&&S$N.setFilterMatrix(S$h._mat,S$h._alpha),S$e._fun.call(S$e,S$a,S$G,-S$B,-S$k),S$Z.isConchApp&&!S$Z.isConchWebGL||S$a._applyFilters();S$a._$P.staticCache&&(S$_.reCache=!1),S$v.canvasReCache++}else S$B=(S$j=S$_._cacheRec).x,S$k=S$j.y,S$A=S$G.canvas;S$m.drawCanvas(S$A,S$s+S$B,S$P+S$k,S$j.width,S$j.height)}else S$e._fun.call(S$e,S$a,S$G,S$s,S$P)},S$A.__init__=function(){var S$a,S$m,S$s=0;for(S$m=S$V.createRenderSprite(69905,null),S$a=S$A.renders.length=4096,S$s=0;S$s<S$a;S$s++)S$A.renders[S$s]=S$m;S$A.renders[0]=S$V.createRenderSprite(0,null),function(S$a,S$m){for(var S$s=0,S$P=0;S$P<S$a.length;S$P++)S$s|=S$a[S$P],S$A.renders[S$s]=S$m}([1,512,4,2],new S$A(1,null)),S$A.renders[513]=S$V.createRenderSprite(513,null),S$A.renders[517]=new S$A(517,null)},S$A._initRenderFun=function(S$a,S$m,S$s,S$P){var S$_=S$a._renderType;(S$A.renders[S$_]=S$A._getTypeRender(S$_))._fun(S$a,S$m,S$s,S$P)},S$A._getTypeRender=function(S$a){for(var S$m=null,S$s=2048;1<S$s;)S$s&S$a&&(S$m=S$V.createRenderSprite(S$s,S$m)),S$s>>=1;return S$m},S$A.IMAGE=1,S$A.ALPHA=2,S$A.TRANSFORM=4,S$A.BLEND=8,S$A.CANVAS=16,S$A.FILTERS=32,S$A.MASK=64,S$A.CLIP=128,S$A.STYLE=256,S$A.GRAPHICS=512,S$A.CUSTOM=1024,S$A.CHILDS=2048,S$A.INIT=69905,S$A.renders=[],S$A.NORENDER=new S$A(0,null),S$A}(),S$i=function(){function S$B(){this._repaint=!1}S$G(S$B,"laya.resource.Context");var S$a=S$B.prototype;return S$a.replaceReset=function(){var S$a,S$m,S$s=0;for(S$a=S$B.replaceKeys.length,S$s=0;S$s<S$a;S$s++)S$m=S$B.replaceKeys[S$s],this[S$B.newKeys[S$s]]=this[S$m]},S$a.replaceResotre=function(){this.__restore(),this.__reset()},S$a.setIsMainContext=function(){},S$a.drawTextures=function(S$a,S$m,S$s,S$P){S$v.drawCall+=S$m.length/2;for(var S$_=S$a.width,S$e=S$a.height,S$A=0,S$B=S$m.length;S$A<S$B;S$A+=2)this.drawTexture(S$a,S$m[S$A],S$m[S$A+1],S$_,S$e,S$s,S$P)},S$a.drawCanvas=function(S$a,S$m,S$s,S$P,S$_){S$v.drawCall++,this.drawImage(S$a.source,S$m,S$s,S$P,S$_)},S$a.fillRect=function(S$a,S$m,S$s,S$P,S$_){S$v.drawCall++,S$_&&(this.fillStyle=S$_),this.__fillRect(S$a,S$m,S$s,S$P)},S$a.fillText=function(S$a,S$m,S$s,S$P,S$_,S$e){S$v.drawCall++,3<arguments.length&&null!=S$P&&(this.font=S$P,this.fillStyle=S$_,this.textAlign=S$e,this.textBaseline="top"),this.__fillText(S$a,S$m,S$s)},S$a.fillBorderText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){S$v.drawCall++,this.font=S$P,this.fillStyle=S$_,this.textBaseline="top",this.strokeStyle=S$e,this.lineWidth=S$A,this.textAlign=S$B,this.__strokeText(S$a,S$m,S$s),this.__fillText(S$a,S$m,S$s)},S$a.strokeText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$v.drawCall++,3<arguments.length&&null!=S$P&&(this.font=S$P,this.strokeStyle=S$_,this.lineWidth=S$e,this.textAlign=S$A,this.textBaseline="top"),this.__strokeText(S$a,S$m,S$s)},S$a.transformByMatrix=function(S$a){this.transform(S$a.a,S$a.b,S$a.c,S$a.d,S$a.tx,S$a.ty)},S$a.setTransformByMatrix=function(S$a){this.setTransform(S$a.a,S$a.b,S$a.c,S$a.d,S$a.tx,S$a.ty)},S$a.clipRect=function(S$a,S$m,S$s,S$P){S$v.drawCall++,this.beginPath(),this.rect(S$a,S$m,S$s,S$P),this.clip()},S$a.drawTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$v.drawCall++;var S$B=S$a.uv,S$k=S$a.bitmap.width,S$j=S$a.bitmap.height;this.drawImage(S$a.source,S$B[0]*S$k,S$B[1]*S$j,(S$B[2]-S$B[0])*S$k,(S$B[5]-S$B[3])*S$j,S$m+S$e,S$s+S$A,S$P,S$_)},S$a.drawTextureWithTransform=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){S$v.drawCall++;var S$j=S$a.uv,S$G=S$a.bitmap.width,S$y=S$a.bitmap.height;this.save(),1!=S$k&&(this.globalAlpha*=S$k),S$e?(this.transform(S$e.a,S$e.b,S$e.c,S$e.d,S$e.tx+S$A,S$e.ty+S$B),this.drawImage(S$a.source,S$j[0]*S$G,S$j[1]*S$y,(S$j[2]-S$j[0])*S$G,(S$j[5]-S$j[3])*S$y,S$m,S$s,S$P,S$_)):this.drawImage(S$a.source,S$j[0]*S$G,S$j[1]*S$y,(S$j[2]-S$j[0])*S$G,(S$j[5]-S$j[3])*S$y,S$m+S$A,S$s+S$B,S$P,S$_),this.restore()},S$a.drawTexture2=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){var S$k=S$B[0];if(S$k.loaded&&S$k.bitmap&&S$k.source){S$v.drawCall++;var S$j=1!==S$e;if(S$j){var S$G=this.globalAlpha;this.globalAlpha*=S$e}var S$y=S$k.uv,S$d=S$k.bitmap.width,S$Q=S$k.bitmap.height;S$_?(this.save(),this.transform(S$_.a,S$_.b,S$_.c,S$_.d,S$_.tx+S$a,S$_.ty+S$m),this.drawImage(S$k.source,S$y[0]*S$d,S$y[1]*S$Q,(S$y[2]-S$y[0])*S$d,(S$y[5]-S$y[3])*S$Q,S$B[1]-S$s,S$B[2]-S$P,S$B[3],S$B[4]),this.restore()):this.drawImage(S$k.source,S$y[0]*S$d,S$y[1]*S$Q,(S$y[2]-S$y[0])*S$d,(S$y[5]-S$y[3])*S$Q,S$B[1]-S$s+S$a,S$B[2]-S$P+S$m,S$B[3],S$B[4]),S$j&&(this.globalAlpha=S$G)}},S$a.fillTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){if(!S$B.pat){if(S$a.uv!=S$Ga.DEF_UV){var S$k=new S$ca("2D");S$k.getContext("2d"),S$k.size(S$a.width,S$a.height),S$k.context.drawTexture(S$a,0,0,S$a.width,S$a.height,0,0),S$a=new S$Ga(S$k)}S$B.pat=this.createPattern(S$a.bitmap.source,S$e)}var S$j=S$m,S$G=S$s,S$y=0,S$d=0;S$A&&(S$j+=S$A.x%S$a.width,S$G+=S$A.y%S$a.height,S$y-=S$A.x%S$a.width,S$d-=S$A.y%S$a.height),this.translate(S$j,S$G),this.fillRect(S$y,S$d,S$P,S$_,S$B.pat),this.translate(-S$j,-S$G)},S$a.drawTriangle=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){var S$k=S$a.bitmap,S$j=S$k.source,S$G=S$a.width,S$y=S$a.height,S$d=S$k.width,S$Q=S$k.height,S$q=S$s[S$P]*S$d,S$h=S$s[S$_]*S$d,S$u=S$s[S$e]*S$d,S$O=S$s[S$P+1]*S$Q,S$p=S$s[S$_+1]*S$Q,S$c=S$s[S$e+1]*S$Q,S$H=S$m[S$P],S$o=S$m[S$_],S$N=S$m[S$e],S$z=S$m[S$P+1],S$U=S$m[S$_+1],S$l=S$m[S$e+1];if(S$B){var S$C=(S$H+S$o+S$N)/3,S$f=(S$z+S$U+S$l)/3,S$K=S$H-S$C,S$V=S$z-S$f,S$W=Math.sqrt(S$K*S$K+S$V*S$V);S$H=S$C+S$K/S$W*(S$W+1),S$z=S$f+S$V/S$W*(S$W+1),S$V=S$U-S$f,S$o=S$C+(S$K=S$o-S$C)/(S$W=Math.sqrt(S$K*S$K+S$V*S$V))*(S$W+1),S$U=S$f+S$V/S$W*(S$W+1),S$V=S$l-S$f,S$N=S$C+(S$K=S$N-S$C)/(S$W=Math.sqrt(S$K*S$K+S$V*S$V))*(S$W+1),S$l=S$f+S$V/S$W*(S$W+1)}this.save(),S$A&&this.transform(S$A.a,S$A.b,S$A.c,S$A.d,S$A.tx,S$A.ty),this.beginPath(),this.moveTo(S$H,S$z),this.lineTo(S$o,S$U),this.lineTo(S$N,S$l),this.closePath(),this.clip();var S$b=1/(S$q*S$p+S$O*S$u+S$h*S$c-S$p*S$u-S$O*S$h-S$q*S$c),S$S=S$H*S$p+S$O*S$N+S$o*S$c-S$p*S$N-S$O*S$o-S$H*S$c,S$Z=S$q*S$o+S$H*S$u+S$h*S$N-S$o*S$u-S$H*S$h-S$q*S$N,S$X=S$q*S$p*S$N+S$O*S$o*S$u+S$H*S$h*S$c-S$H*S$p*S$u-S$O*S$h*S$N-S$q*S$o*S$c,S$E=S$z*S$p+S$O*S$l+S$U*S$c-S$p*S$l-S$O*S$U-S$z*S$c,S$i=S$q*S$U+S$z*S$u+S$h*S$l-S$U*S$u-S$z*S$h-S$q*S$l,S$t=S$q*S$p*S$l+S$O*S$U*S$u+S$z*S$h*S$c-S$z*S$p*S$u-S$O*S$h*S$l-S$q*S$U*S$c;this.transform(S$S*S$b,S$E*S$b,S$Z*S$b,S$i*S$b,S$X*S$b,S$t*S$b),this.drawImage(S$j,S$a.uv[0]*S$d,S$a.uv[1]*S$Q,S$G,S$y,S$a.uv[0]*S$d,S$a.uv[1]*S$Q,S$G,S$y),this.restore()},S$a.flush=function(){return 0},S$a.fillWords=function(S$a,S$m,S$s,S$P,S$_,S$e){S$P&&(this.font=S$P),S$_&&(this.fillStyle=S$_);this.textBaseline="top",this.textAlign="left";for(var S$A=0,S$B=S$a.length;S$A<S$B;S$A++){var S$k=S$a[S$A];if(this.__fillText(S$k.char,S$k.x+S$m,S$k.y+S$s),1===S$e){var S$j=S$k.height,S$G=.5*S$k.style.letterSpacing;S$G||(S$G=0),this.beginPath(),this.strokeStyle=S$_,this.lineWidth=1,this.moveTo(S$m+S$k.x-S$G+.5,S$s+S$k.y+S$j+.5),this.lineTo(S$m+S$k.x+S$k.width+S$G+.5,S$s+S$k.y+S$j+.5),this.stroke()}}},S$a.fillBorderWords=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$P&&(this.font=S$P),S$_&&(this.fillStyle=S$_),this.textBaseline="top",this.lineWidth=S$A,this.textAlign="left",this.strokeStyle=S$e;for(var S$B=0,S$k=S$a.length;S$B<S$k;S$B++){var S$j=S$a[S$B];this.__strokeText(S$j.char,S$j.x+S$m,S$j.y+S$s),this.__fillText(S$j.char,S$j.x+S$m,S$j.y+S$s)}},S$a.destroy=function(){this.canvas.width=this.canvas.height=0},S$a.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},S$a.drawCurves=function(S$a,S$m,S$s){this.beginPath(),this.strokeStyle=S$s[3],this.lineWidth=S$s[4];var S$P=S$s[2];S$a+=S$s[0],S$m+=S$s[1],this.moveTo(S$a+S$P[0],S$m+S$P[1]);for(var S$_=2,S$e=S$P.length;S$_<S$e;)this.quadraticCurveTo(S$a+S$P[S$_++],S$m+S$P[S$_++],S$a+S$P[S$_++],S$m+S$P[S$_++]);this.stroke()},S$B.__init__=function(S$m){var S$s=laya.resource.Context.prototype;if(!(S$m=S$m||CanvasRenderingContext2D.prototype).inited){S$m.inited=!0,S$m.__fillText=S$m.fillText,S$m.__fillRect=S$m.fillRect,S$m.__strokeText=S$m.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(S$a){S$m[S$a]=S$s[S$a]})}},S$B.replaceCanvasGetSet=function(S$a,S$m){var S$s=Object.getOwnPropertyDescriptor(S$a,S$m);if(!S$s||!S$s.configurable)return!1;var S$P,S$_={};for(S$P in S$s)"set"!=S$P&&(S$_[S$P]=S$s[S$P]);var S$e=S$s.set;return S$_.set=function(S$a){S$e.call(this,S$a);var S$m=this.getContext("2d");S$m&&"__reset"in S$m&&S$m.__reset()},Object.defineProperty(S$a,S$m,S$_),!0},S$B.replaceGetSet=function(S$a,S$m){var S$s=Object.getOwnPropertyDescriptor(S$a,S$m);if(!S$s||!S$s.configurable)return!1;var S$P,S$_={};for(S$P in S$s)"set"!=S$P&&(S$_[S$P]=S$s[S$P]);var S$e=S$s.set,S$A="___"+S$m+"__";return S$B.newKeys.push(S$A),S$_.set=function(S$a){S$a!=this[S$A]&&(this[S$A]=S$a,S$e.call(this,S$a))},Object.defineProperty(S$a,S$m,S$_),!0},S$B._default=new S$B,S$B.newKeys=[],S$k(S$B,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),S$B}(),S$t=function(){function S$e(S$a){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++S$e._uniqueIDCounter,this._name=S$a||"Content Manager",S$e._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,S$e._resourceManagers.push(this),this._resources=[],this._records={}}S$G(S$e,"laya.resource.ResourceManager");var S$a=S$e.prototype;return S$z.imps(S$a,{"laya.resource.IDispose":!0}),S$a.getResourceByIndex=function(S$a){return this._resources[S$a]},S$a.getResourcesLength=function(){return this._resources.length},S$a.addResource=function(S$a){return S$a.resourceManager&&S$a.resourceManager.removeResource(S$a),-1===this._resources.indexOf(S$a)&&((S$a._resourceManager=this)._resources.push(S$a),this.addRecord(S$a.uri,S$a.__className,S$a.memorySize),this.addSize(S$a.memorySize),!0)},S$a.removeResource=function(S$a){var S$m=this._resources.indexOf(S$a);return-1!==S$m&&(this._resources.splice(S$m,1),S$a._resourceManager=null,this._memorySize-=S$a.memorySize,this.addRecord(S$a.uri,S$a.__className,-S$a.memorySize),!0)},S$a.unload=function(){for(var S$a=this._resources.slice(0,this._resources.length),S$m=0;S$m<S$a.length;S$m++){S$a[S$m].destroy()}S$a.length=0},S$a.dispose=function(){if(this===S$e._systemResourceManager)throw new Error("systemResourceManager不能被释放！");S$e._resourceManagers.splice(S$e._resourceManagers.indexOf(this),1),S$e._isResourceManagersSorted=!1;for(var S$a=this._resources.slice(0,this._resources.length),S$m=0;S$m<S$a.length;S$m++){var S$s=S$a[S$m];S$s.resourceManager.removeResource(S$s),S$s.destroy()}S$a.length=0},S$a.addSize=function(S$a){S$a&&(this.autoRelease&&0<S$a&&this._memorySize+S$a>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=S$a)},S$a.addRecord=function(S$a,S$m,S$s){DEBUG&&S$s&&!S$a&&console.error(S$a,S$m,S$s)},S$a.garbageCollection=function(S$a){var S$m=this._resources;(S$m=S$m.slice()).sort(function(S$a,S$m){if(!S$a||!S$m)throw new Error("a或b不能为空！");return S$a.released&&S$m.released?0:S$a.released?1:S$m.released?-1:S$a._lastUseFrameCount-S$m._lastUseFrameCount});for(var S$s=S$v.loopCount,S$P=0,S$_=S$m.length;S$P<S$_;S$P++){var S$e=S$m[S$P];if(!(1<S$s-S$e._lastUseFrameCount))return void(this._memorySize>=S$a&&(this._isOverflow=!0));if(S$e.releaseResource(),this._memorySize<S$a)return void(this._isOverflow=!1)}},S$q(0,S$a,"id",function(){return this._id}),S$q(0,S$a,"name",function(){return this._name},function(S$a){!S$a&&""===S$a||this._name===S$a||(this._name=S$a,S$e._isResourceManagersSorted=!1)}),S$q(0,S$a,"memorySize",function(){return this._memorySize}),S$q(0,S$a,"records",function(){return this._records}),S$q(1,S$e,"systemResourceManager",function(){return S$e._systemResourceManager}),S$e.__init__=function(){S$e.currentResourceManager=S$e.systemResourceManager},S$e.getLoadedResourceManagerByIndex=function(S$a){return S$e._resourceManagers[S$a]},S$e.getLoadedResourceManagersCount=function(){return S$e._resourceManagers.length},S$e.recreateContentManagers=function(S$a){void 0===S$a&&(S$a=!1);for(var S$m=S$e.currentResourceManager,S$s=0;S$s<S$e._resourceManagers.length;S$s++){S$e.currentResourceManager=S$e._resourceManagers[S$s];for(var S$P=0;S$P<S$e.currentResourceManager._resources.length;S$P++)S$e.currentResourceManager._resources[S$P].releaseResource(S$a),S$e.currentResourceManager._resources[S$P].activeResource(S$a)}S$e.currentResourceManager=S$m},S$e.releaseContentManagers=function(S$a){void 0===S$a&&(S$a=!1);for(var S$m=S$e.currentResourceManager,S$s=0;S$s<S$e._resourceManagers.length;S$s++){S$e.currentResourceManager=S$e._resourceManagers[S$s];for(var S$P=0;S$P<S$e.currentResourceManager._resources.length;S$P++){var S$_=S$e.currentResourceManager._resources[S$P];!S$_.released&&S$_.releaseResource(S$a)}}S$e.currentResourceManager=S$m},S$e._uniqueIDCounter=0,S$e._isResourceManagersSorted=!1,S$e._resourceManagers=[],S$k(S$e,["_systemResourceManager",function(){return this._systemResourceManager=new S$e("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=S$e._systemResourceManager}]),S$e}(),S$L=(function(){function S$a(){}S$G(S$a,"laya.system.System"),S$a.changeDefinition=function(S$a,S$m){S$z[S$a]=S$m;var S$s=S$a+"=classObj";S$z._runScript(S$s)},S$a.__init__=function(){S$Z.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function S$s(){}return S$G(S$s,"laya.utils.Browser"),S$q(1,S$s,"pixelRatio",function(){return S$s.__init__(),-1<S$s.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:S$V.getPixelRatio()}),S$q(1,S$s,"height",function(){return S$s.__init__(),(S$z.stage&&S$z.stage.canvasRotation?S$s.clientWidth:S$s.clientHeight)*S$s.pixelRatio}),S$q(1,S$s,"clientWidth",function(){return S$s.__init__(),S$s.window.innerWidth||S$s.document.body.clientWidth}),S$q(1,S$s,"window",function(){return S$s.__init__(),S$s._window}),S$q(1,S$s,"clientHeight",function(){return S$s.__init__(),S$s.window.innerHeight||S$s.document.body.clientHeight||S$s.document.documentElement.clientHeight}),S$q(1,S$s,"width",function(){return S$s.__init__(),(S$z.stage&&S$z.stage.canvasRotation?S$s.clientHeight:S$s.clientWidth)*S$s.pixelRatio}),S$q(1,S$s,"container",function(){return S$s.__init__(),S$s._container||((S$s._container=S$s.createElement("div")).id="layaContainer",S$s.document.body.appendChild(S$s._container)),S$s._container},function(S$a){S$s._container=S$a}),S$q(1,S$s,"document",function(){return S$s.__init__(),S$s._document}),S$s.__init__=function(){if(!S$s._window){S$s._window=S$V.getWindow(),S$s._document=S$s.window.document,S$s._window.addEventListener("message",function(S$a){laya.utils.Browser._onMessage(S$a)},!1),S$s.document.__createElement=S$s.document.createElement,S$A.requestAnimationFrame=S$A.requestAnimationFrame||S$A.webkitRequestAnimationFrame||S$A.mozRequestAnimationFrame||S$A.oRequestAnimationFrame||S$A.msRequestAnimationFrame||function(S$a){return S$A.setTimeout(S$a,1e3/60)};var S$a=S$A.document.body.style;S$a["-webkit-user-select"]="none",S$a["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",S$s.userAgent=S$s.window.navigator.userAgent,S$s.onIOS=!!(S$s.u=S$s.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),S$s.onMobile=-1<S$s.u.indexOf("Mobile"),S$s.onIPhone=-1<S$s.u.indexOf("iPhone"),S$s.onMac=-1<S$s.u.indexOf("Mac OS X"),S$s.onIPad=-1<S$s.u.indexOf("iPad"),S$s.onAndroid=-1<S$s.u.indexOf("Android")||-1<S$s.u.indexOf("Adr"),S$s.onWP=-1<S$s.u.indexOf("Windows Phone"),S$s.onQQBrowser=-1<S$s.u.indexOf("QQBrowser"),S$s.onMQQBrowser=-1<S$s.u.indexOf("MQQBrowser")||-1<S$s.u.indexOf("Mobile")&&-1<S$s.u.indexOf("QQ"),S$s.onIE=!!S$s.window.ActiveXObject||"ActiveXObject"in S$s.window,S$s.onWeiXin=-1<S$s.u.indexOf("MicroMessenger"),S$s.onPC=!S$s.onMobile,S$s.onSafari=-1<S$s.u.indexOf("Safari"),S$s.onFirefox=-1<S$s.u.indexOf("Firefox"),S$s.onEdge=-1<S$s.u.indexOf("Edge"),S$s.onMiniGame=-1<S$s.u.indexOf("MiniGame"),S$s.onLimixiu=-1<S$s.u.indexOf("limixiu"),S$s.httpProtocol="http:"==S$s.window.location.protocol,S$s.onMiniGame&&null==S$s.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),S$s.webAudioEnabled=!!(S$s.window.AudioContext||S$s.window.webkitAudioContext||S$s.window.mozAudioContext),S$s.soundType=S$s.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",S$_a=S$s.webAudioEnabled?S$ea:S$sa,S$s.webAudioEnabled&&S$ea.initWebAudio(),S$sa._initMusicAudio(),S$s.enableTouch="ontouchstart"in S$A||S$A.DocumentTouch&&S$m instanceof DocumentTouch,S$A.focus(),S$K._soundClass=S$_a,S$K._musicClass=S$sa,S$Z._mainCanvas=S$Z._mainCanvas||S$ca.create("2D"),S$s.canvas||(S$s.canvas=S$ca.create("2D"),S$s.context=S$s.canvas.getContext("2d"))}},S$s._onMessage=function(S$a){if(S$a.data&&"size"==S$a.data.name){if(S$s.window.innerWidth=S$a.data.width,S$s.window.innerHeight=S$a.data.height,S$s.window.__innerHeight=S$a.data.clientHeight,!S$s.document.createEvent)return void console.warn("no document.createEvent");var S$m=S$s.document.createEvent("HTMLEvents");return S$m.initEvent("resize",!1,!1),void S$s.window.dispatchEvent(S$m)}},S$s.createElement=function(S$a){return S$s.__init__(),S$s.document.__createElement(S$a)},S$s.getElementById=function(S$a){return S$s.__init__(),S$s.document.getElementById(S$a)},S$s.removeElement=function(S$a){S$a&&S$a.parentNode&&S$a.parentNode.removeChild(S$a)},S$s.now=function(){return S$V.now()},S$s._window=null,S$s._document=null,S$s._container=null,S$s.userAgent=null,S$s.u=null,S$s.onIOS=!1,S$s.onMac=!1,S$s.onMobile=!1,S$s.onIPhone=!1,S$s.onIPad=!1,S$s.onAndroid=!1,S$s.onWP=!1,S$s.onQQBrowser=!1,S$s.onMQQBrowser=!1,S$s.onSafari=!1,S$s.onFirefox=!1,S$s.onEdge=!1,S$s.onIE=!1,S$s.onWeiXin=!1,S$s.onMiniGame=!1,S$s.onLimixiu=!1,S$s.onPC=!1,S$s.httpProtocol=!1,S$s.webAudioEnabled=!1,S$s.soundType=null,S$s.enableTouch=!1,S$s.canvas=null,S$s.context=null,S$s.__init$=function(){},S$s}()),S$R=function(){function S$m(S$a){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,S$a?(this._u8d_=new Uint8Array(S$a),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}S$G(S$m,"laya.utils.Byte");var S$a=S$m.prototype;return S$a.___resizeBuffer=function(S$m){try{var S$a=new Uint8Array(S$m);null!=this._u8d_&&(this._u8d_.length<=S$m?S$a.set(this._u8d_):S$a.set(this._u8d_.subarray(0,S$m))),this._u8d_=S$a,this._d_=new DataView(S$a.buffer)}catch(S$a){throw"___resizeBuffer err:"+S$m}},S$a.getString=function(){return this.rUTF(this.getUint16())},S$a.getFloat32Array=function(S$a,S$m){var S$s=S$a+S$m;S$s=S$s>this._length?this._length:S$s;var S$P=new Float32Array(this._d_.buffer.slice(S$a,S$s));return this._pos_=S$s,S$P},S$a.getUint8Array=function(S$a,S$m){var S$s=S$a+S$m;S$s=S$s>this._length?this._length:S$s;var S$P=new Uint8Array(this._d_.buffer.slice(S$a,S$s));return this._pos_=S$s,S$P},S$a.getInt16Array=function(S$a,S$m){var S$s=S$a+S$m;S$s=S$s>this._length?this._length:S$s;var S$P=new Int16Array(this._d_.buffer.slice(S$a,S$s));return this._pos_=S$s,S$P},S$a.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var S$a=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,S$a},S$a.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var S$a=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,S$a},S$a.writeFloat32=function(S$a){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,S$a,this._xd_),this._pos_+=4},S$a.writeFloat64=function(S$a){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,S$a,this._xd_),this._pos_+=8},S$a.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var S$a=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,S$a},S$a.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var S$a=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,S$a},S$a.writeInt32=function(S$a){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,S$a,this._xd_),this._pos_+=4},S$a.writeUint32=function(S$a){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,S$a,this._xd_),this._pos_+=4},S$a.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var S$a=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,S$a},S$a.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var S$a=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,S$a},S$a.writeUint16=function(S$a){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,S$a,this._xd_),this._pos_+=2},S$a.writeInt16=function(S$a){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,S$a,this._xd_),this._pos_+=2},S$a.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},S$a.writeUint8=function(S$a){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,S$a),this._pos_++},S$a._getUInt8=function(S$a){return this._d_.getUint8(S$a)},S$a._getUint16=function(S$a){return this._d_.getUint16(S$a,this._xd_)},S$a._getMatrix=function(){return new S$W(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},S$a.rUTF=function(S$a){for(var S$m=[],S$s=this._pos_+S$a,S$P=0,S$_=0,S$e=0,S$A=String.fromCharCode,S$B=this._u8d_;this._pos_<S$s;)(S$P=S$B[this._pos_++])<128?0!=S$P&&S$m.push(S$A(S$P)):S$P<224?S$m.push(S$A((63&S$P)<<6|127&S$B[this._pos_++])):S$P<240?(S$_=S$B[this._pos_++],S$m.push(S$A((31&S$P)<<12|(127&S$_)<<6|127&S$B[this._pos_++]))):(S$_=S$B[this._pos_++],S$e=S$B[this._pos_++],S$m.push(S$A((15&S$P)<<18|(127&S$_)<<12|S$e<<6&127|127&S$B[this._pos_++]))),0;return S$m.join("")},S$a.getCustomString=function(S$a){for(var S$m=[],S$s=0,S$P=0,S$_=0,S$e=String.fromCharCode,S$A=this._u8d_;0<S$a;)if((S$P=S$A[this._pos_])<128)S$m.push(S$e(S$P)),this._pos_++,S$a--;else for(S$s=S$P-128,this._pos_++,S$a-=S$s;0<S$s;)S$P=S$A[this._pos_++],S$_=S$A[this._pos_++],S$m.push(S$e(S$_<<8|S$P)),S$s--;return S$m.join("")},S$a.clear=function(){this._pos_=0,this.length=0},S$a.__getBuffer=function(){return this._d_.buffer},S$a.writeUTFBytes=function(S$a){for(var S$m=0,S$s=(S$a+="").length;S$m<S$s;S$m++){var S$P=S$a.charCodeAt(S$m);S$P<=127?this.writeByte(S$P):S$P<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|S$P>>6,128|63&S$P],this._pos_),this._pos_+=2):S$P<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|S$P>>12,128|S$P>>6&63,128|63&S$P],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|S$P>>18,128|S$P>>12&63,128|S$P>>6&63,128|63&S$P],this._pos_),this._pos_+=4)}},S$a.writeUTFString=function(S$a){var S$m=this.pos;this.writeUint16(1),this.writeUTFBytes(S$a);var S$s=this.pos-S$m-2;if(65536<=S$s)throw"writeUTFString byte len more than 65536";this._d_.setUint16(S$m,S$s,this._xd_)},S$a.readUTFString=function(){return this.readUTFBytes(this.getUint16())},S$a.getUTFString=function(){return this.readUTFString()},S$a.readUTFBytes=function(S$a){if(void 0===S$a&&(S$a=-1),0==S$a)return"";var S$m=this.bytesAvailable;if(S$m<S$a)throw"readUTFBytes error - Out of bounds";return S$a=0<S$a?S$a:S$m,this.rUTF(S$a)},S$a.getUTFBytes=function(S$a){return void 0===S$a&&(S$a=-1),this.readUTFBytes(S$a)},S$a.writeByte=function(S$a){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,S$a),this._pos_+=1},S$a.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},S$a.getByte=function(){return this.readByte()},S$a.ensureWrite=function(S$a){this._length<S$a&&(this._length=S$a),this._allocated_<S$a&&(this.length=S$a)},S$a.writeArrayBuffer=function(S$a,S$m,S$s){if(void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),S$m<0||S$s<0)throw"writeArrayBuffer error - Out of bounds";0==S$s&&(S$s=S$a.byteLength-S$m),this.ensureWrite(this._pos_+S$s);var S$P=new Uint8Array(S$a);this._u8d_.set(S$P.subarray(S$m,S$m+S$s),this._pos_),this._pos_+=S$s},S$q(0,S$a,"buffer",function(){var S$a=this._d_.buffer;return S$a.byteLength==this.length?S$a:S$a.slice(0,this.length)}),S$q(0,S$a,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(S$a){this._xd_="littleEndian"==S$a}),S$q(0,S$a,"length",function(){return this._length},function(S$a){this._allocated_<S$a?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(S$a,2*this._allocated_))):this._allocated_>S$a&&this.___resizeBuffer(this._allocated_=S$a),this._length=S$a}),S$q(0,S$a,"pos",function(){return this._pos_},function(S$a){this._pos_=S$a}),S$q(0,S$a,"bytesAvailable",function(){return this._length-this._pos_}),S$m.getSystemEndian=function(){if(!S$m._sysEndian){var S$a=new ArrayBuffer(2);new DataView(S$a).setInt16(0,256,!0),S$m._sysEndian=256===new Int16Array(S$a)[0]?"littleEndian":"bigEndian"}return S$m._sysEndian},S$m.BIG_ENDIAN="bigEndian",S$m.LITTLE_ENDIAN="littleEndian",S$m._sysEndian=null,S$m}(),S$F=function(){function S$_(){}return S$G(S$_,"laya.utils.CacheManager"),S$_.regCacheByFunction=function(S$a,S$m){var S$s;S$_.unRegCacheByFunction(S$a,S$m),S$s={tryDispose:S$a,getCacheList:S$m},S$_._cacheList.push(S$s)},S$_.unRegCacheByFunction=function(S$a,S$m){var S$s,S$P=0;for(S$s=S$_._cacheList.length,S$P=0;S$P<S$s;S$P++)if(S$_._cacheList[S$P].tryDispose==S$a&&S$_._cacheList[S$P].getCacheList==S$m)return void S$_._cacheList.splice(S$P,1)},S$_.forceDispose=function(){var S$a=0,S$m=S$_._cacheList.length;for(S$a=0;S$a<S$m;S$a++)S$_._cacheList[S$a].tryDispose(!0)},S$_.beginCheck=function(S$a){void 0===S$a&&(S$a=15e3),S$z.timer.loop(S$a,null,S$_._checkLoop)},S$_.stopCheck=function(){S$z.timer.clear(null,S$_._checkLoop)},S$_._checkLoop=function(){var S$a=S$_._cacheList;if(!(S$a.length<1)){var S$m,S$s=S$L.now(),S$P=0;for(S$m=S$P=S$a.length;0<S$P&&(S$a[S$_._index=++S$_._index%S$m].tryDispose(!1),!(S$L.now()-S$s>S$_.loopTimeLimit));)S$P--}},S$_.loopTimeLimit=2,S$_._cacheList=[],S$_._index=0,S$_}(),S$x=function(){function S$Q(){}return S$G(S$Q,"laya.utils.ClassUtils"),S$Q.regClass=function(S$a,S$m){S$Q._classMap[S$a]=S$m},S$Q.getRegClass=function(S$a){return S$Q._classMap[S$a]},S$Q.getInstance=function(S$a){var S$m=S$Q.getClass(S$a);return S$m?new S$m:(console.warn("[error] Undefined class:",S$a),null)},S$Q.createByJson=function(S$a,S$m,S$s,S$P,S$_){"string"==typeof S$a&&(S$a=JSON.parse(S$a));var S$e=S$a.props;if(!S$m&&!(S$m=S$_?S$_.runWith(S$a):S$Q.getInstance(S$e.runtime||S$a.type)))return null;var S$A=S$a.child;if(S$A)for(var S$B=0,S$k=S$A.length;S$B<S$k;S$B++){var S$j=S$A[S$B];if("render"!==S$j.props.name&&"render"!==S$j.props.renderType||!S$m._$set_itemRender)if("Graphic"==S$j.type)S$Q.addGraphicsToSprite(S$j,S$m);else if(S$Q.isDrawType(S$j.type))S$Q.addGraphicToSprite(S$j,S$m,!0);else{var S$G=S$Q.createByJson(S$j,null,S$s,S$P,S$_);"Script"==S$j.type?S$G.hasOwnProperty("owner")?S$G.owner=S$m:S$G.hasOwnProperty("target")&&(S$G.target=S$m):"mask"==S$j.props.renderType?S$m.mask=S$G:S$m.addChild(S$G)}else S$m.itemRender=S$j}if(S$e)for(var S$y in S$e){var S$d=S$e[S$y];"var"===S$y&&S$s?S$s[S$d]=S$m:S$d instanceof Array&&"function"==typeof S$m[S$y]?S$m[S$y].apply(S$m,S$d):S$m[S$y]=S$d}return S$P&&S$a.customProps&&S$P.runWith([S$m,S$a]),S$m.created&&S$m.created(),S$m},S$Q.addGraphicsToSprite=function(S$a,S$m){var S$s;if((S$s=S$a.child)&&!(S$s.length<1)){var S$P;S$P=S$Q._getGraphicsFromSprite(S$a,S$m);var S$_=0,S$e=0;S$a.props&&(S$_=S$Q._getObjVar(S$a.props,"x",0),S$e=S$Q._getObjVar(S$a.props,"y",0)),0!=S$_&&0!=S$e&&S$P.translate(S$_,S$e);var S$A,S$B=0;for(S$A=S$s.length,S$B=0;S$B<S$A;S$B++)S$Q._addGraphicToGraphics(S$s[S$B],S$P);0!=S$_&&0!=S$e&&S$P.translate(-S$_,-S$e)}},S$Q.addGraphicToSprite=function(S$a,S$m,S$s){var S$P;void 0===S$s&&(S$s=!1),S$P=S$s?S$Q._getGraphicsFromSprite(S$a,S$m):S$m.graphics,S$Q._addGraphicToGraphics(S$a,S$P)},S$Q._getGraphicsFromSprite=function(S$a,S$m){var S$s,S$P;if(!S$a||!S$a.props)return S$m.graphics;switch(S$P=S$a.props.renderType){case"hit":case"unHit":var S$_;S$m.hitArea||(S$m.hitArea=new S$g),(S$_=S$m.hitArea)[S$P]||(S$_[S$P]=new S$d),S$s=S$_[S$P]}return S$s||(S$s=S$m.graphics),S$s},S$Q._getTransformData=function(S$a){var S$m;(S$a.hasOwnProperty("pivotX")||S$a.hasOwnProperty("pivotY"))&&(S$m=S$m||new S$W).translate(-S$Q._getObjVar(S$a,"pivotX",0),-S$Q._getObjVar(S$a,"pivotY",0));var S$s=S$Q._getObjVar(S$a,"scaleX",1),S$P=S$Q._getObjVar(S$a,"scaleY",1),S$_=S$Q._getObjVar(S$a,"rotation",0);S$Q._getObjVar(S$a,"skewX",0),S$Q._getObjVar(S$a,"skewY",0);return 1==S$s&&1==S$P&&0==S$_||((S$m=S$m||new S$W).scale(S$s,S$P),S$m.rotate(.0174532922222222*S$_)),S$m},S$Q._addGraphicToGraphics=function(S$a,S$m){var S$s,S$P;if((S$s=S$a.props)&&(S$P=S$Q.DrawTypeDic[S$a.type])){var S$_,S$e;S$_=S$m;var S$A=S$Q._getParams(S$s,S$P[1],S$P[2],S$P[3]);((S$e=S$Q._tM)||1!=S$Q._alpha)&&(S$_.save(),S$e&&S$_.transform(S$e),1!=S$Q._alpha&&S$_.alpha(S$Q._alpha)),S$_[S$P[0]].apply(S$_,S$A),(S$e||1!=S$Q._alpha)&&S$_.restore()}},S$Q._adptLineData=function(S$a){return S$a[2]=parseFloat(S$a[0])+parseFloat(S$a[2]),S$a[3]=parseFloat(S$a[1])+parseFloat(S$a[3]),S$a},S$Q._adptTextureData=function(S$a){return S$a[0]=S$Ba.getRes(S$a[0]),S$a},S$Q._adptLinesData=function(S$a){return S$a[2]=S$Q._getPointListByStr(S$a[2]),S$a},S$Q.isDrawType=function(S$a){return"Image"!=S$a&&S$Q.DrawTypeDic.hasOwnProperty(S$a)},S$Q._getParams=function(S$a,S$m,S$s,S$P){var S$_;void 0===S$s&&(S$s=0),(S$_=S$Q._temParam).length=S$m.length;var S$e,S$A,S$B=0;for(S$e=S$m.length,S$B=0;S$B<S$e;S$B++)S$_[S$B]=S$Q._getObjVar(S$a,S$m[S$B][0],S$m[S$B][1]);return S$Q._alpha=S$Q._getObjVar(S$a,"alpha",1),S$A=S$Q._getTransformData(S$a),S$Q._tM=S$A?(S$s||(S$s=0),S$A.translate(S$_[S$s],S$_[S$s+1]),S$_[S$s]=S$_[S$s+1]=0,S$A):null,S$P&&S$Q[S$P]&&(S$_=S$Q[S$P](S$_)),S$_},S$Q._getPointListByStr=function(S$a){var S$m,S$s,S$P=0;for(S$s=(S$m=S$a.split(",")).length,S$P=0;S$P<S$s;S$P++)S$m[S$P]=parseFloat(S$m[S$P]);return S$m},S$Q._getObjVar=function(S$a,S$m,S$s){return S$a.hasOwnProperty(S$m)?S$a[S$m]:S$s},S$Q._temParam=[],S$Q._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},S$Q.getClass=function(S$a){var S$m=S$Q._classMap[S$a]||S$a;return"string"==typeof S$m?S$z.__classmap[S$m]:S$m},S$Q._tM=null,S$Q._alpha=NaN,S$k(S$Q,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),S$Q}(),S$M=function(){function S$e(S$a){if(this._color=[],"string"==typeof S$a){null===(this.strColor=S$a)&&(S$a="#000000"),"#"==S$a.charAt(0)&&(S$a=S$a.substr(1));var S$m=S$a.length;if(3==S$m||4==S$m){for(var S$s="",S$P=0;S$P<S$m;S$P++)S$s+=S$a[S$P]+S$a[S$P];S$a=S$s}var S$_=this.numColor=parseInt(S$a,16);if(8==S$a.length)return void(this._color=[parseInt(S$a.substr(0,2),16)/255,((16711680&S$_)>>16)/255,((65280&S$_)>>8)/255,(255&S$_)/255])}else S$_=this.numColor=S$a,this.strColor=S$I.toHexColor(S$_);this._color=[((16711680&S$_)>>16)/255,((65280&S$_)>>8)/255,(255&S$_)/255,1],this._color.__id=++S$e._COLODID}return S$G(S$e,"laya.utils.Color"),S$e._initDefault=function(){for(var S$a in S$e._DEFAULT={},S$e._COLOR_MAP)S$e._SAVE[S$a]=S$e._DEFAULT[S$a]=new S$e(S$e._COLOR_MAP[S$a]);return S$e._DEFAULT},S$e._initSaveMap=function(){for(var S$a in S$e._SAVE_SIZE=0,S$e._SAVE={},S$e._DEFAULT)S$e._SAVE[S$a]=S$e._DEFAULT[S$a]},S$e.create=function(S$a){var S$m=S$e._SAVE[S$a+""];return null!=S$m?S$m:(S$e._SAVE_SIZE<1e3||S$e._initSaveMap(),S$e._SAVE[S$a+""]=new S$e(S$a))},S$e._SAVE={},S$e._SAVE_SIZE=0,S$e._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},S$e._DEFAULT=S$e._initDefault(),S$e._COLODID=1,S$e}(),S$J=(function(){function S$a(){this._values=[],this._keys=[]}S$G(S$a,"laya.utils.Dictionary");var S$m=S$a.prototype;S$m.set=function(S$a,S$m){var S$s=this.indexOf(S$a);0<=S$s?this._values[S$s]=S$m:(this._keys.push(S$a),this._values.push(S$m))},S$m.indexOf=function(S$a){var S$m=this._keys.indexOf(S$a);return 0<=S$m?S$m:(S$a="string"==typeof S$a?Number(S$a):"number"==typeof S$a?S$a.toString():S$a,this._keys.indexOf(S$a))},S$m.get=function(S$a){var S$m=this.indexOf(S$a);return S$m<0?null:this._values[S$m]},S$m.remove=function(S$a){var S$m=this.indexOf(S$a);return 0<=S$m&&(this._keys.splice(S$m,1),this._values.splice(S$m,1),!0)},S$m.clear=function(){this._values.length=0,this._keys.length=0},S$q(0,S$m,"values",function(){return this._values}),S$q(0,S$m,"keys",function(){return this._keys})}(),function(){function S$a(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}S$G(S$a,"laya.utils.Dragging");var S$m=S$a.prototype;return S$m.start=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){void 0===S$B&&(S$B=.92),this.clearTimer(),this.target=S$a,this.area=S$m,this.hasInertia=S$s,this.elasticDistance=S$m?S$P:0,this.elasticBackTime=S$_,this.data=S$e,this._disableMouseEvent=S$A,this.ratio=S$B,1!=S$a.globalScaleX||1!=S$a.globalScaleY?this._parent=S$a.parent:this._parent=S$z.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,S$z.stage.on("mouseup",this,this.onStageMouseUp),S$z.stage.on("mouseout",this,this.onStageMouseUp),S$z.timer.frameLoop(1,this,this.loop)},S$m.clearTimer=function(){S$z.timer.clear(this,this.loop),S$z.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},S$m.stop=function(){this._dragging&&(S$h.instance.disableMouseEvent=!1,S$z.stage.off("mouseup",this,this.onStageMouseUp),S$z.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},S$m.loop=function(){var S$a=this._parent.getMousePoint(),S$m=S$a.x,S$s=S$a.y,S$P=S$m-this._lastX,S$_=S$s-this._lastY;if(this._clickOnly){if(!(1<Math.abs(S$P*S$z.stage._canvasTransform.getScaleX())||1<Math.abs(S$_*S$z.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),S$h.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(S$P,S$_);0==S$P&&0==S$_||(this._lastX=S$m,this._lastY=S$s,this.target.x+=S$P*this._elasticRateX,this.target.y+=S$_*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},S$m.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var S$a=this.area.x-this.target.x;else S$a=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-S$a/this.elasticDistance),this.target.y<this.area.y)var S$m=this.area.y-this.target.y;else S$m=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-S$m/this.elasticDistance)}},S$m.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},S$m.onStageMouseUp=function(S$a){if(S$h.instance.disableMouseEvent=!1,S$z.stage.off("mouseup",this,this.onStageMouseUp),S$z.stage.off("mouseout",this,this.onStageMouseUp),S$z.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var S$m=this._offsets.length,S$s=Math.min(S$m,6),S$P=this._offsets.length-S$s,S$_=S$m-1;S$P<S$_;S$_--)this._offsetY+=this._offsets[S$_--],this._offsetX+=this._offsets[S$_];this._offsetX=this._offsetX/S$s*2,this._offsetY=this._offsetY/S$s*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),S$z.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},S$m.checkElastic=function(){var S$a=NaN,S$m=NaN;if(this.target.x<this.area.x?S$a=this.area.x:this.target.x>this.area.x+this.area.width&&(S$a=this.area.x+this.area.width),this.target.y<this.area.y?S$m=this.area.y:this.target.y>this.area.y+this.area.height&&(S$m=this.area.y+this.area.height),isNaN(S$a)&&isNaN(S$m))this.clear();else{var S$s={};isNaN(S$a)||(S$s.x=S$a),isNaN(S$m)||(S$s.y=S$m),this._tween=S$T.to(this.target,S$s,this.elasticBackTime,S$D.sineOut,S$p.create(this,this.clear),0,!1,!1)}},S$m.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(S$z.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},S$m.clear=function(){if(this.target){this.clearTimer();var S$a=this.target;this.target=null,this._parent=null,S$a.event("dragend",this.data)}},S$a}()),S$D=function(){function S$B(){}return S$G(S$B,"laya.utils.Ease"),S$B.linearNone=function(S$a,S$m,S$s,S$P){return S$s*S$a/S$P+S$m},S$B.linearIn=function(S$a,S$m,S$s,S$P){return S$s*S$a/S$P+S$m},S$B.linearInOut=function(S$a,S$m,S$s,S$P){return S$s*S$a/S$P+S$m},S$B.linearOut=function(S$a,S$m,S$s,S$P){return S$s*S$a/S$P+S$m},S$B.bounceIn=function(S$a,S$m,S$s,S$P){return S$s-S$B.bounceOut(S$P-S$a,0,S$s,S$P)+S$m},S$B.bounceInOut=function(S$a,S$m,S$s,S$P){return S$a<.5*S$P?.5*S$B.bounceIn(2*S$a,0,S$s,S$P)+S$m:.5*S$B.bounceOut(2*S$a-S$P,0,S$s,S$P)+.5*S$s+S$m},S$B.bounceOut=function(S$a,S$m,S$s,S$P){return(S$a/=S$P)<1/2.75?S$s*(7.5625*S$a*S$a)+S$m:S$a<2/2.75?S$s*(7.5625*(S$a-=1.5/2.75)*S$a+.75)+S$m:S$a<2.5/2.75?S$s*(7.5625*(S$a-=2.25/2.75)*S$a+.9375)+S$m:S$s*(7.5625*(S$a-=2.625/2.75)*S$a+.984375)+S$m},S$B.backIn=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$_&&(S$_=1.70158),S$s*(S$a/=S$P)*S$a*((S$_+1)*S$a-S$_)+S$m},S$B.backInOut=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$_&&(S$_=1.70158),(S$a/=.5*S$P)<1?.5*S$s*(S$a*S$a*((1+(S$_*=1.525))*S$a-S$_))+S$m:S$s/2*((S$a-=2)*S$a*((1+(S$_*=1.525))*S$a+S$_)+2)+S$m},S$B.backOut=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$_&&(S$_=1.70158),S$s*((S$a=S$a/S$P-1)*S$a*((S$_+1)*S$a+S$_)+1)+S$m},S$B.elasticIn=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A;return void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=0),0==S$a?S$m:1==(S$a/=S$P)?S$m+S$s:(S$e||(S$e=.3*S$P),S$A=!S$_||0<S$s&&S$_<S$s||S$s<0&&S$_<-S$s?(S$_=S$s,S$e/4):S$e/S$B.PI2*Math.asin(S$s/S$_),-S$_*Math.pow(2,10*(S$a-=1))*Math.sin((S$a*S$P-S$A)*S$B.PI2/S$e)+S$m)},S$B.elasticInOut=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A;return void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=0),0==S$a?S$m:2==(S$a/=.5*S$P)?S$m+S$s:(S$e||(S$e=S$P*(.3*1.5)),S$A=!S$_||0<S$s&&S$_<S$s||S$s<0&&S$_<-S$s?(S$_=S$s,S$e/4):S$e/S$B.PI2*Math.asin(S$s/S$_),S$a<1?S$_*Math.pow(2,10*(S$a-=1))*Math.sin((S$a*S$P-S$A)*S$B.PI2/S$e)*-.5+S$m:S$_*Math.pow(2,-10*(S$a-=1))*Math.sin((S$a*S$P-S$A)*S$B.PI2/S$e)*.5+S$s+S$m)},S$B.elasticOut=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A;return void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=0),0==S$a?S$m:1==(S$a/=S$P)?S$m+S$s:(S$e||(S$e=.3*S$P),S$A=!S$_||0<S$s&&S$_<S$s||S$s<0&&S$_<-S$s?(S$_=S$s,S$e/4):S$e/S$B.PI2*Math.asin(S$s/S$_),S$_*Math.pow(2,-10*S$a)*Math.sin((S$a*S$P-S$A)*S$B.PI2/S$e)+S$s+S$m)},S$B.strongIn=function(S$a,S$m,S$s,S$P){return S$s*(S$a/=S$P)*S$a*S$a*S$a*S$a+S$m},S$B.strongInOut=function(S$a,S$m,S$s,S$P){return(S$a/=.5*S$P)<1?.5*S$s*S$a*S$a*S$a*S$a*S$a+S$m:.5*S$s*((S$a-=2)*S$a*S$a*S$a*S$a+2)+S$m},S$B.strongOut=function(S$a,S$m,S$s,S$P){return S$s*((S$a=S$a/S$P-1)*S$a*S$a*S$a*S$a+1)+S$m},S$B.sineInOut=function(S$a,S$m,S$s,S$P){return.5*-S$s*(Math.cos(Math.PI*S$a/S$P)-1)+S$m},S$B.sineIn=function(S$a,S$m,S$s,S$P){return-S$s*Math.cos(S$a/S$P*S$B.HALF_PI)+S$s+S$m},S$B.sineOut=function(S$a,S$m,S$s,S$P){return S$s*Math.sin(S$a/S$P*S$B.HALF_PI)+S$m},S$B.quintIn=function(S$a,S$m,S$s,S$P){return S$s*(S$a/=S$P)*S$a*S$a*S$a*S$a+S$m},S$B.quintInOut=function(S$a,S$m,S$s,S$P){return(S$a/=.5*S$P)<1?.5*S$s*S$a*S$a*S$a*S$a*S$a+S$m:.5*S$s*((S$a-=2)*S$a*S$a*S$a*S$a+2)+S$m},S$B.quintOut=function(S$a,S$m,S$s,S$P){return S$s*((S$a=S$a/S$P-1)*S$a*S$a*S$a*S$a+1)+S$m},S$B.quartIn=function(S$a,S$m,S$s,S$P){return S$s*(S$a/=S$P)*S$a*S$a*S$a+S$m},S$B.quartInOut=function(S$a,S$m,S$s,S$P){return(S$a/=.5*S$P)<1?.5*S$s*S$a*S$a*S$a*S$a+S$m:.5*-S$s*((S$a-=2)*S$a*S$a*S$a-2)+S$m},S$B.quartOut=function(S$a,S$m,S$s,S$P){return-S$s*((S$a=S$a/S$P-1)*S$a*S$a*S$a-1)+S$m},S$B.cubicIn=function(S$a,S$m,S$s,S$P){return S$s*(S$a/=S$P)*S$a*S$a+S$m},S$B.cubicInOut=function(S$a,S$m,S$s,S$P){return(S$a/=.5*S$P)<1?.5*S$s*S$a*S$a*S$a+S$m:.5*S$s*((S$a-=2)*S$a*S$a+2)+S$m},S$B.cubicOut=function(S$a,S$m,S$s,S$P){return S$s*((S$a=S$a/S$P-1)*S$a*S$a+1)+S$m},S$B.quadIn=function(S$a,S$m,S$s,S$P){return S$s*(S$a/=S$P)*S$a+S$m},S$B.quadInOut=function(S$a,S$m,S$s,S$P){return(S$a/=.5*S$P)<1?.5*S$s*S$a*S$a+S$m:.5*-S$s*(--S$a*(S$a-2)-1)+S$m},S$B.quadOut=function(S$a,S$m,S$s,S$P){return-S$s*(S$a/=S$P)*(S$a-2)+S$m},S$B.expoIn=function(S$a,S$m,S$s,S$P){return 0==S$a?S$m:S$s*Math.pow(2,10*(S$a/S$P-1))+S$m-.001*S$s},S$B.expoInOut=function(S$a,S$m,S$s,S$P){return 0==S$a?S$m:S$a==S$P?S$m+S$s:(S$a/=.5*S$P)<1?.5*S$s*Math.pow(2,10*(S$a-1))+S$m:.5*S$s*(2-Math.pow(2,-10*--S$a))+S$m},S$B.expoOut=function(S$a,S$m,S$s,S$P){return S$a==S$P?S$m+S$s:S$s*(1-Math.pow(2,-10*S$a/S$P))+S$m},S$B.circIn=function(S$a,S$m,S$s,S$P){return-S$s*(Math.sqrt(1-(S$a/=S$P)*S$a)-1)+S$m},S$B.circInOut=function(S$a,S$m,S$s,S$P){return(S$a/=.5*S$P)<1?.5*-S$s*(Math.sqrt(1-S$a*S$a)-1)+S$m:.5*S$s*(Math.sqrt(1-(S$a-=2)*S$a)+1)+S$m},S$B.circOut=function(S$a,S$m,S$s,S$P){return S$s*Math.sqrt(1-(S$a=S$a/S$P-1)*S$a)+S$m},S$B.HALF_PI=.5*Math.PI,S$B.PI2=2*Math.PI,S$B}(),S$g=function(){function S$y(){this._hit=null,this._unHit=null}S$G(S$y,"laya.utils.HitArea");var S$a=S$y.prototype;return S$a.isHit=function(S$a,S$m){return!!S$y.isHitGraphic(S$a,S$m,this.hit)&&!S$y.isHitGraphic(S$a,S$m,this.unHit)},S$a.contains=function(S$a,S$m){return this.isHit(S$a,S$m)},S$q(0,S$a,"hit",function(){return this._hit||(this._hit=new S$d),this._hit},function(S$a){this._hit=S$a}),S$q(0,S$a,"unHit",function(){return this._unHit||(this._unHit=new S$d),this._unHit},function(S$a){this._unHit=S$a}),S$y.isHitGraphic=function(S$a,S$m,S$s){if(!S$s)return!1;var S$P;if(!(S$P=S$s.cmds)&&S$s._one&&((S$P=S$y._cmds).length=1,S$P[0]=S$s._one),!S$P)return!1;var S$_,S$e,S$A=0;for(S$_=S$P.length,S$A=0;S$A<S$_;S$A++)if(S$e=S$P[S$A]){var S$B=S$Z._context;switch(S$e.callee){case S$B._translate:case 6:S$a-=S$e[0],S$m-=S$e[1]}if(S$y.isHitCmd(S$a,S$m,S$e))return!0}return!1},S$y.isHitCmd=function(S$a,S$m,S$s){if(!S$s)return!1;var S$P=S$Z._context,S$_=!1;switch(S$s.callee){case S$P._drawRect:case 13:S$y._rec.setTo(S$s[0],S$s[1],S$s[2],S$s[3]),S$_=S$y._rec.contains(S$a,S$m);break;case S$P._drawCircle:case S$P._fillCircle:case 14:S$_=(S$a-=S$s[0])*S$a+(S$m-=S$s[1])*S$m<S$s[2]*S$s[2];break;case S$P._drawPoly:case 18:S$a-=S$s[0],S$m-=S$s[1],S$_=S$y.ptInPolygon(S$a,S$m,S$s[2])}return S$_},S$y.ptInPolygon=function(S$a,S$m,S$s){var S$P;(S$P=S$y._ptPoint).setTo(S$a,S$m);var S$_,S$e=0,S$A=NaN,S$B=NaN,S$k=NaN,S$j=NaN;S$_=S$s.length;for(var S$G=0;S$G<S$_;S$G+=2){if(S$A=S$s[S$G],S$B=S$s[S$G+1],S$k=S$s[(S$G+2)%S$_],S$B!=(S$j=S$s[(S$G+3)%S$_]))if(!(S$P.y<Math.min(S$B,S$j)))if(!(S$P.y>=Math.max(S$B,S$j)))(S$P.y-S$B)*(S$k-S$A)/(S$j-S$B)+S$A>S$P.x&&S$e++}return S$e%2==1},S$y._cmds=[],S$k(S$y,["_rec",function(){return this._rec=new S$l},"_ptPoint",function(){return this._ptPoint=new S$U}]),S$y}(),S$w=(function(){function S$_(S$a,S$m,S$s,S$P){this.char=S$a,this.charNum=S$a.charCodeAt(0),this._x=this._y=0,this.width=S$m,this.height=S$s,this.style=S$P,this.isWord=!S$_._isWordRegExp.test(S$a)}S$G(S$_,"laya.utils.HTMLChar");var S$a=S$_.prototype;S$z.imps(S$a,{"laya.display.ILayout":!0}),S$a.setSprite=function(S$a){this._sprite=S$a},S$a.getSprite=function(){return this._sprite},S$a._isChar=function(){return!0},S$a._getCSSStyle=function(){return this.style},S$q(0,S$a,"width",function(){return this._w},function(S$a){this._w=S$a}),S$q(0,S$a,"x",function(){return this._x},function(S$a){this._sprite&&(this._sprite.x=S$a),this._x=S$a}),S$q(0,S$a,"y",function(){return this._y},function(S$a){this._sprite&&(this._sprite.y=S$a),this._y=S$a}),S$q(0,S$a,"height",function(){return this._h},function(S$a){this._h=S$a}),S$_._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function S$m(){}S$G(S$m,"laya.utils.Log"),S$m.enable=function(){S$m._logdiv||(S$m._logdiv=S$L.window.document.createElement("div"),S$L.window.document.body.appendChild(S$m._logdiv),S$m._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},S$m.toggle=function(){var S$a=S$m._logdiv.style;"1px"==S$a.width?S$a.width=S$a.height="50%":S$a.width=S$a.height="1px"},S$m.print=function(S$a){S$m._logdiv&&(S$m.maxCount<=S$m._count&&S$m.clear(),S$m._count++,S$m._logdiv.innerText+=S$a+"\n",S$m._logdiv.scrollTop=S$m._logdiv.scrollHeight)},S$m.clear=function(){S$m._logdiv.innerText="",S$m._count=0},S$m._logdiv=null,S$m._count=0,S$m.maxCount=20}(),function(){function S$m(){}S$G(S$m,"laya.utils.Mouse"),S$q(1,S$m,"cursor",function(){return S$m._style.cursor},function(S$a){S$m._style.cursor=S$a}),S$m.hide=function(){"none"!=S$m.cursor&&(S$m._preCursor=S$m.cursor,S$m.cursor="none")},S$m.show=function(){"none"==S$m.cursor&&(S$m.cursor=S$m._preCursor?S$m._preCursor:"auto")},S$m._preCursor=null,S$k(S$m,["_style",function(){return this._style=S$L.document.body.style}])}(),function(){function S$e(){}return S$G(S$e,"laya.utils.Pool"),S$e.getPoolBySign=function(S$a){return S$e._poolDic[S$a]||(S$e._poolDic[S$a]=[])},S$e.clearBySign=function(S$a){S$e._poolDic[S$a]&&(S$e._poolDic[S$a].length=0)},S$e.recover=function(S$a,S$m){S$m.__InPool||(S$m.__InPool=!0,S$e.getPoolBySign(S$a).push(S$m))},S$e.getItemByClass=function(S$a,S$m){var S$s=S$e.getPoolBySign(S$a),S$P=S$s.length?S$s.pop():new S$m;return S$P.__InPool=!1,S$P},S$e.getItemByCreateFun=function(S$a,S$m,S$s){var S$P=S$e.getPoolBySign(S$a),S$_=S$P.length?S$P.pop():S$m.call(S$s);return S$_.__InPool=!1,S$_},S$e.getItem=function(S$a){var S$m=S$e.getPoolBySign(S$a),S$s=S$m.length?S$m.pop():null;return S$s&&(S$s.__InPool=!1),S$s},S$e._poolDic={},S$e.InPoolSign="__InPool",S$e}()),S$v=function(){function S$k(){}return S$G(S$k,"laya.utils.Stat"),S$q(1,S$k,"onclick",null,function(S$a){S$k._sp&&S$k._sp.on("click",S$k._sp,S$a),S$k._canvas&&(S$k._canvas.source.onclick=S$a,S$k._canvas.source.style.pointerEvents="")}),S$k.show=function(S$a,S$m,S$s){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),!S$Z.isConchApp||S$Z.isConchWebGL){if(S$Z.isConchWebGL||S$L.onMiniGame||S$L.onLimixiu||(S$k._useCanvas=!0),S$k._show=!0,S$k._fpsData.length=60,S$k._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},S$k._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},S$k._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},S$k._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},S$Z.isWebGL)if(S$k._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},S$Z.is3DMode){if(S$k._view[0].title="FPS(3D)",S$k._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},S$k._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},S$k._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==S$s){var S$P=8;S$k._view[S$P++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},S$k._view[S$P++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},S$k._view[S$P++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},S$k._view[S$P++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},S$k._view[S$P++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},S$k._view[S$P++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},S$k._view[S$P++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},S$k._view[S$P++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},S$k._view[S$P++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==S$s){S$P=8;S$k._view[S$P++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},S$k._view[S$P++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},S$k._view[S$P++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},S$k._view[S$P++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},S$k._view[S$P++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},S$k._view[S$P++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},S$k._view[S$P++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else S$k._view[0].title="FPS(WebGL)",S$k._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else S$k._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};S$k._useCanvas?S$k.createUIPre(S$a,S$m):S$k.createUI(S$a,S$m),S$k.enable()}else S$L.window.conch.showFPS&&S$L.window.conch.showFPS(S$a,S$m)},S$k.createUIPre=function(S$a,S$m){var S$s=S$L.pixelRatio;S$k._width=170*S$s,S$k._vx=75*S$s,S$k._height=S$s*(12*S$k._view.length+3*S$s)+4,S$k._fontSize=12*S$s;for(var S$P=0;S$P<S$k._view.length;S$P++)S$k._view[S$P].x=4,S$k._view[S$P].y=S$P*S$k._fontSize+2*S$s;S$k._canvas||((S$k._canvas=new S$ca("2D")).size(S$k._width,S$k._height),(S$k._ctx=S$k._canvas.getContext("2d")).textBaseline="top",S$k._ctx.font=S$k._fontSize+"px Sans-serif",S$k._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+S$a+"px;top:"+S$m+"px;width:"+S$k._width/S$s+"px;height:"+S$k._height/S$s+"px;"),S$k._first=!0,S$k.loop(),S$k._first=!1,S$L.container.appendChild(S$k._canvas.source)},S$k.createUI=function(S$a,S$m){var S$s=S$k._sp,S$P=S$L.pixelRatio;S$s||(S$s=new S$ya,(S$k._leftText=new S$ua).pos(5,5),S$k._leftText.color="#ffffff",S$s.addChild(S$k._leftText),(S$k._txt=new S$ua).pos(80*S$P,5),S$k._txt.color="#ffffff",S$s.addChild(S$k._txt),S$k._sp=S$s),S$s.pos(S$a,S$m);for(var S$_="",S$e=0;S$e<S$k._view.length;S$e++){S$_+=S$k._view[S$e].title+"\n"}S$k._leftText.text=S$_;var S$A=170*S$P,S$B=S$P*(12*S$k._view.length+3*S$P)+4;S$k._txt.fontSize=S$k._fontSize*S$P,S$k._leftText.fontSize=S$k._fontSize*S$P,S$s.size(S$A,S$B),S$s.graphics.clear(),S$s.graphics.setAlpha(.5),S$s.graphics.drawRect(0,0,S$A,S$B,"#999999"),S$s.graphics.setAlpha(1),S$k.loop()},S$k.enable=function(){S$z.timer.frameLoop(1,S$k,S$k.loop)},S$k.hide=function(){S$k._show=!1,S$z.timer.clear(S$k,S$k.loop),S$k._canvas&&S$L.removeElement(S$k._canvas.source)},S$k.clear=function(){S$k.trianglesFaces=S$k.drawCall=S$k.shaderCall=S$k.spriteCount=S$k.spriteRenderUseCacheCount=S$k.treeNodeCollision=S$k.treeSpriteCollision=S$k.canvasNormal=S$k.canvasBitmap=S$k.canvasReCache=0},S$k.loop=function(){S$k._count++;var S$a=S$L.now();if(!(S$a-S$k._timer<1e3)){var S$m=S$k._count;if(S$k.FPS=Math.round(1e3*S$m/(S$a-S$k._timer)),S$k._show){S$k.trianglesFaces=Math.round(S$k.trianglesFaces/S$m),S$k.spriteCount=S$k._useCanvas?(S$k.drawCall=Math.round(S$k.drawCall/S$m)-2,S$k.shaderCall=Math.round(S$k.shaderCall/S$m),Math.round(S$k.spriteCount/S$m)-1):(S$k.drawCall=Math.round(S$k.drawCall/S$m)-2,S$k.shaderCall=Math.round(S$k.shaderCall/S$m)-4,Math.round(S$k.spriteCount/S$m)-4),S$k.spriteRenderUseCacheCount=Math.round(S$k.spriteRenderUseCacheCount/S$m),S$k.canvasNormal=Math.round(S$k.canvasNormal/S$m),S$k.canvasBitmap=Math.round(S$k.canvasBitmap/S$m),S$k.canvasReCache=Math.ceil(S$k.canvasReCache/S$m),S$k.treeNodeCollision=Math.round(S$k.treeNodeCollision/S$m),S$k.treeSpriteCollision=Math.round(S$k.treeSpriteCollision/S$m);var S$s=0<S$k.FPS?Math.floor(1e3/S$k.FPS).toString():" ";S$k._fpsStr=S$k.FPS+(S$k.renderSlow?" slow":"")+" "+S$s,S$k._spriteStr=S$k.spriteCount+(S$k.spriteRenderUseCacheCount?"/"+S$k.spriteRenderUseCacheCount:""),S$k._canvasStr=S$k.canvasReCache+"/"+S$k.canvasNormal+"/"+S$k.canvasBitmap,S$k.currentMemorySize=S$t.systemResourceManager.memorySize,S$k._useCanvas?S$k.renderInfoPre():S$k.renderInfo(),S$k.clear()}S$k._count=0,S$k._timer=S$a}},S$k.renderInfoPre=function(){if(S$k._canvas){var S$a=S$k._ctx;S$a.clearRect(S$k._first?0:S$k._vx,0,S$k._width,S$k._height);for(var S$m=S$Z.WebGL.mainContext,S$s=0;S$s<S$k._view.length;S$s++){var S$P=S$k._view[S$s];S$k._first&&(S$a.fillStyle="white",S$a.fillText(S$P.title,S$P.x,S$P.y,null,null,null)),S$a.fillStyle=S$P.color;var S$_=-1;if((S$P=S$k._view[S$s]).varying){if(S$m)switch(S$P.varying){case 1:S$_=S$m.getParameter(S$m[S$P.value]);break;case 2:S$_=S$m.getExtension(S$P.value)}}else S$_=S$k[S$P.value];"M"==S$P.units&&(S$_=Math.floor(S$_/1048576*100)/100+" M"),"K"==S$P.units&&(S$_=Math.floor(S$_/1024*100)/100+" K"),"string"==S$P.units&&(S$_=S$_.match(/\d+\.?\d/i)),S$a.fillText(S$_+"",S$P.x+S$k._vx,S$P.y,null,null,null)}}},S$k.renderInfo=function(){for(var S$a="",S$m=S$Z.WebGL.mainContext,S$s=0;S$s<S$k._view.length;S$s++){var S$P=S$k._view[S$s],S$_=-1;if(S$P.varying){if(S$m)switch(S$P.varying){case 1:S$_=S$m.getParameter(S$m[S$P.value]);break;case 2:S$_=S$m.getExtension(S$P.value)}}else S$_=S$k[S$P.value];"M"==S$P.units&&(S$_=Math.floor(S$_/1048576*100)/100+" M"),"K"==S$P.units&&(S$_=Math.floor(S$_/1024*100)/100+" K"),"string"==S$P.units&&(S$_=S$_.match(/\d+\.?\d/i)),S$a+=S$_+"\n"}S$k._txt.text=S$a},S$k.FPS=0,S$k.loopCount=0,S$k.shaderCall=0,S$k.drawCall=0,S$k.trianglesFaces=0,S$k.spriteCount=0,S$k.spriteRenderUseCacheCount=0,S$k.treeNodeCollision=0,S$k.treeSpriteCollision=0,S$k.canvasNormal=0,S$k.canvasBitmap=0,S$k.canvasReCache=0,S$k.renderSlow=!1,S$k.currentMemorySize=0,S$k._fpsStr=null,S$k._canvasStr=null,S$k._spriteStr=null,S$k._fpsData=[],S$k._timer=0,S$k._count=0,S$k._view=[],S$k._fontSize=12,S$k._txt=null,S$k._leftText=null,S$k._sp=null,S$k._show=!1,S$k._useCanvas=!1,S$k._canvas=null,S$k._ctx=null,S$k._first=!1,S$k._vx=NaN,S$k._width=0,S$k._height=100,S$k}(),S$Y=(function(){function S$a(){this._strsToID={},this._idToStrs=[],this._length=0}S$G(S$a,"laya.utils.StringKey");var S$m=S$a.prototype;S$m.add=function(S$a){var S$m=this._strsToID[S$a];return null!=S$m?S$m:(this._idToStrs[this._length]=S$a,this._strsToID[S$a]=this._length++)},S$m.getID=function(S$a){var S$m=this._strsToID[S$a];return null==S$m?-1:S$m},S$m.getName=function(S$a){var S$m=this._idToStrs[S$a];return null==S$m?void 0:S$m}}(),function(){var S$j;function S$a(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}S$G(S$a,"laya.utils.Timer");var S$m=S$a.prototype;return S$m._init=function(){S$z.timer&&S$z.timer.frameLoop(1,this,this._update)},S$m._now=function(){return Date.now()},S$m._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var S$a=this.currFrame=this.currFrame+this.scale,S$m=this._now();this._delta=(S$m-this._lastTimer)*this.scale;var S$s=this.currTimer=this.currTimer+this._delta;S$z.isDebug&&6e4<Math.abs(S$m-this._lastTimer)&&console.error("系统时间错误！"+(S$m-this._lastTimer)),this._lastTimer=S$m;var S$P=this._handlers;for(S$A=this._count=0,S$B=S$P.length;S$A<S$B;S$A++)if(null!==(S$k=S$P[S$A]).method){var S$_=S$k.userFrame?S$a:S$s;if(S$_>=S$k.exeTime)if(S$k.repeat)if(S$k.jumpFrame)for(;S$_>=S$k.exeTime;)S$k.exeTime+=S$k.delay,S$k.run(!1);else S$k.exeTime+=S$k.delay,S$k.run(!1),S$_>S$k.exeTime&&(S$k.exeTime+=Math.ceil((S$_-S$k.exeTime)/S$k.delay)*S$k.delay);else S$k.run(!0)}else this._count++;(30<this._count||S$a%200==0)&&this._clearHandlers();for(var S$e=this._laters,S$A=0,S$B=S$e.length-1;S$A<=S$B;S$A++){var S$k=S$e[S$A];this._isIgnoreRecover(S$k)||(null!==S$k.method&&(delete this._map[S$k.key],S$k.run(!1)),this._recoverHandler(S$k)),S$A===S$B&&(S$B=S$e.length-1)}S$e.length=0}},S$m._clearHandlers=function(){for(var S$a=this._handlers,S$m=0,S$s=S$a.length;S$m<S$s;S$m++){var S$P=S$a[S$m];null!==S$P.method?this._temp.push(S$P):this._isIgnoreRecover(S$P)?this._temp.push(S$P):this._recoverHandler(S$P)}this._handlers=this._temp,this._temp=S$a,this._temp.length=0},S$m._recoverHandler=function(S$a){this._map[S$a.key]==S$a&&delete this._map[S$a.key],S$a.recover()},S$m._create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){if(!S$s)return S$_.apply(S$P,S$e),null;if(S$A){var S$k=this._getHandler(S$P,S$_);if(S$k)return S$k.repeat=S$m,S$k.userFrame=S$a,S$k.delay=S$s,S$k.ignoreRecover=S$B,S$k.caller=S$P,S$k.method=S$_,S$k.args=S$e,S$k.exeTime=S$s+(S$a?this.currFrame:this.currTimer+this._now()-this._lastTimer),S$k}return(S$k=S$j.create()).repeat=S$m,S$k.userFrame=S$a,S$k.delay=S$s,S$k.ignoreRecover=S$B,S$k.caller=S$P,S$k.method=S$_,S$k.args=S$e,S$k.exeTime=S$s+(S$a?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(S$k),this._handlers.push(S$k),S$k},S$m._indexHandler=function(S$a){var S$m=S$a.caller,S$s=S$a.method,S$P=S$m?S$m.$_GID||(S$m.$_GID=S$I.getGID()):0,S$_=S$s.$_TID||(S$s.$_TID=this._mid++);S$a.key=S$P+"_"+S$_,this._map[S$a.key]=S$a},S$m.once=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=!0),this._create(!1,!1,S$a,S$m,S$s,S$P,S$_,!1)},S$m.loop=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){void 0===S$_&&(S$_=!0),void 0===S$e&&(S$e=!1),void 0===S$A&&(S$A=!1);var S$B=this._create(!1,!0,S$a,S$m,S$s,S$P,S$_,S$A);S$B&&(S$B.jumpFrame=S$e)},S$m.frameOnce=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=!0),this._create(!0,!1,S$a,S$m,S$s,S$P,S$_,!1)},S$m.frameLoop=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$_&&(S$_=!0),void 0===S$e&&(S$e=!1),this._create(!0,!0,S$a,S$m,S$s,S$P,S$_,S$e)},S$m.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+S$j._freeCount},S$m.clear=function(S$a,S$m){var S$s=this._getHandler(S$a,S$m);return!(!S$s||this._isIgnoreRecover(S$s))&&(delete this._map[S$s.key],S$s.key=null,S$s.clear(),!0)},S$m.clearAll=function(S$a){if(S$a)for(var S$m=0,S$s=this._handlers.length;S$m<S$s;S$m++){var S$P=this._handlers[S$m];S$P.caller===S$a&&(this._isIgnoreRecover(S$P)||(delete this._map[S$P.key],S$P.key=null,S$P.clear()))}},S$m._getHandler=function(S$a,S$m){var S$s=S$a?S$a.$_GID||(S$a.$_GID=S$I.getGID()):0,S$P=S$m.$_TID||(S$m.$_TID=this._mid++);return this._map[S$s+"_"+S$P]},S$m._isIgnoreRecover=function(S$a){if(S$a.ignoreRecover||S$a.caller&&"IgnoreRecover"==S$a.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var S$m="";try{arguments.propertyIsEnumerable.caller}catch(S$a){S$m=S$a.stack}S$z.recordError("报错：核心定时器销毁忽略  "+S$m)}return!0}return!1},S$m.hasHandler=function(S$a,S$m){return this._map[S$a.$_GID+"_"+S$m.$_TID]},S$m.callLater=function(S$a,S$m,S$s){if(null==this._getHandler(S$a,S$m)){var S$P=S$j.create();S$P.caller=S$a,S$P.method=S$m,S$P.args=S$s,this._indexHandler(S$P),this._laters.push(S$P)}},S$m.runCallLater=function(S$a,S$m){var S$s=this._getHandler(S$a,S$m);S$s&&null!=S$s.method&&(this._isIgnoreRecover(S$s)||(delete this._map[S$s.key],S$s.run(!0)))},S$m.runTimer=function(S$a,S$m){this.runCallLater(S$a,S$m)},S$q(0,S$m,"delta",function(){return this._delta}),S$a.__init$=function(){S$j=function(){function S$m(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}S$G(S$m,"");var S$a=S$m.prototype;return S$a.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},S$a.recover=function(){this.clear(),this.args=S$m._freeHandler,S$m._freeHandler=this,S$m._freeCount++},S$a.run=function(S$a){var S$m=this.caller;if(S$m&&S$m.destroyed)return this.clear();var S$s=this.method,S$P=this.args;S$a&&this.clear(),null!=S$s&&(S$P?S$s.apply(S$m,S$P):S$s.call(S$m))},S$m._freeHandler=null,S$m._freeCount=0,S$m.create=function(){var S$a=S$m._freeHandler;return S$a?(S$m._freeHandler=S$a.args,--S$m._freeCount,S$a.args=null,S$a):new S$m},S$m}()},S$a}()),S$T=function(){function S$y(){this.gid=0}S$G(S$y,"laya.utils.Tween");var S$a=S$y.prototype;return S$a.to=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){return void 0===S$e&&(S$e=0),void 0===S$A&&(S$A=!1),this._create(S$a,S$m,S$s,S$P,S$_,S$e,S$A,!0,!1,!0)},S$a.from=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){return void 0===S$e&&(S$e=0),void 0===S$A&&(S$A=!1),this._create(S$a,S$m,S$s,S$P,S$_,S$e,S$A,!1,!1,!0)},S$a._create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){if(!S$a)throw new Error("Tween:target is null");this._target=S$a,this._duration=S$s,this._ease=S$P||S$m.ease||S$y.easeNone,this._complete=S$_||S$m.complete,this._delay=S$e,this._props=[],this._usedTimer=0,this._startTimer=S$L.now(),this._usedPool=S$k,this._delayParam=null,this.update=S$m.update;var S$G=S$a.$_GID||(S$a.$_GID=S$I.getGID());return S$y.tweenMap[S$G]?(S$A&&S$y.clearTween(S$a),S$y.tweenMap[S$G].push(this)):S$y.tweenMap[S$G]=[this],S$j?S$e<=0?this.firstStart(S$a,S$m,S$B):(this._delayParam=[S$a,S$m,S$B],S$z.scaleTimer.once(S$e,this,this.firstStart,this._delayParam)):this._initProps(S$a,S$m,S$B),this},S$a.firstStart=function(S$a,S$m,S$s){this._delayParam=null,S$a.destroyed?this.clear():(this._initProps(S$a,S$m,S$s),this._beginLoop())},S$a._initProps=function(S$a,S$m,S$s){for(var S$P in S$m)if("number"==typeof S$a[S$P]){var S$_=S$s?S$a[S$P]:S$m[S$P],S$e=S$s?S$m[S$P]:S$a[S$P];this._props.push([S$P,S$_,S$e-S$_]),S$s||(S$a[S$P]=S$_)}},S$a._beginLoop=function(){S$z.scaleTimer.frameLoop(1,this,this._doEase)},S$a._doEase=function(){this._updateEase(S$L.now())},S$a._updateEase=function(S$a){var S$m=this._target;if(S$m){if(S$m.destroyed)return S$y.clearTween(S$m);var S$s=this._usedTimer=S$a-this._startTimer-this._delay;if(!(S$s<0)){if(S$s>=this._duration)return this.complete();for(var S$P=0<S$s?this._ease(S$s,0,1,this._duration):0,S$_=this._props,S$e=0,S$A=S$_.length;S$e<S$A;S$e++){var S$B=S$_[S$e];S$m[S$B[0]]=S$B[1]+S$P*S$B[2]}this.update&&this.update.run()}}},S$a.complete=function(){if(this._target){S$z.scaleTimer.runTimer(this,this.firstStart);for(var S$a=this._target,S$m=this._props,S$s=this._complete,S$P=0,S$_=S$m.length;S$P<S$_;S$P++){var S$e=S$m[S$P];S$a[S$e[0]]=S$e[1]+S$e[2]}this.update&&this.update.run(),this.clear(),S$s&&S$s.run()}},S$a.pause=function(){S$z.scaleTimer.clear(this,this._beginLoop),S$z.scaleTimer.clear(this,this._doEase),S$z.scaleTimer.clear(this,this.firstStart);var S$a;(S$a=S$L.now()-this._startTimer-this._delay)<0&&(this._usedTimer=S$a)},S$a.setStartTime=function(S$a){this._startTimer=S$a},S$a.clear=function(){this._target&&(this._remove(),this._clear())},S$a._clear=function(){this.pause(),S$z.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,S$w.recover("tween",this))},S$a.recover=function(){this._usedPool=!0,this._clear()},S$a._remove=function(){var S$a=S$y.tweenMap[this._target.$_GID];if(S$a)for(var S$m=0,S$s=S$a.length;S$m<S$s;S$m++)if(S$a[S$m]===this){S$a.splice(S$m,1);break}},S$a.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=S$L.now(),this._delayParam)S$z.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var S$a=this._props,S$m=0,S$s=S$a.length;S$m<S$s;S$m++){var S$P=S$a[S$m];this._target[S$P[0]]=S$P[1]}S$z.scaleTimer.once(this._delay,this,this._beginLoop)}},S$a.resume=function(){this._usedTimer>=this._duration||(this._startTimer=S$L.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?S$z.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},S$q(0,S$a,"progress",null,function(S$a){var S$m=S$a*this._duration;this._startTimer=S$L.now()-this._delay-S$m}),S$y.to=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){return void 0===S$e&&(S$e=0),void 0===S$A&&(S$A=!1),void 0===S$B&&(S$B=!0),S$w.getItemByClass("tween",S$y)._create(S$a,S$m,S$s,S$P,S$_,S$e,S$A,!0,S$B,!0)},S$y.from=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){return void 0===S$e&&(S$e=0),void 0===S$A&&(S$A=!1),void 0===S$B&&(S$B=!0),S$w.getItemByClass("tween",S$y)._create(S$a,S$m,S$s,S$P,S$_,S$e,S$A,!1,S$B,!0)},S$y.clearAll=function(S$a){if(S$a&&S$a.$_GID){var S$m=S$y.tweenMap[S$a.$_GID];if(S$m){for(var S$s=0,S$P=S$m.length;S$s<S$P;S$s++)S$m[S$s]._clear();S$m.length=0}}},S$y.clear=function(S$a){S$a.clear()},S$y.clearTween=function(S$a){S$y.clearAll(S$a)},S$y.easeNone=function(S$a,S$m,S$s,S$P){return S$s*S$a/S$P+S$m},S$y.tweenMap={},S$y}(),S$I=function(){function S$B(){}return S$G(S$B,"laya.utils.Utils"),S$B.toRadian=function(S$a){return S$a*S$B._pi2},S$B.toAngle=function(S$a){return S$a*S$B._pi},S$B.toHexColor=function(S$a){if(S$a<0||isNaN(S$a))return null;for(var S$m=S$a.toString(16);S$m.length<6;)S$m="0"+S$m;return"#"+S$m},S$B.getGID=function(){return S$B._gid++},S$B.concatArray=function(S$a,S$m){if(!S$m)return S$a;if(!S$a)return S$m;var S$s=0,S$P=S$m.length;for(S$s=0;S$s<S$P;S$s++)S$a.push(S$m[S$s]);return S$a},S$B.clearArray=function(S$a){return S$a&&(S$a.length=0),S$a},S$B.copyArray=function(S$a,S$m){if(S$a||(S$a=[]),!S$m)return S$a;S$a.length=S$m.length;var S$s=0,S$P=S$m.length;for(S$s=0;S$s<S$P;S$s++)S$a[S$s]=S$m[S$s];return S$a},S$B.getGlobalRecByPoints=function(S$a,S$m,S$s,S$P,S$_){var S$e,S$A;return S$e=new S$U(S$m,S$s),S$e=S$a.localToGlobal(S$e),S$A=new S$U(S$P,S$_),S$A=S$a.localToGlobal(S$A),S$l._getWrapRec([S$e.x,S$e.y,S$A.x,S$A.y])},S$B.getGlobalPosAndScale=function(S$a){return S$B.getGlobalRecByPoints(S$a,0,0,1,1)},S$B.bind=function(S$a,S$m){return S$a.bind(S$m)},S$B.measureText=function(S$a,S$m){return S$V.measureText(S$a,S$m)},S$B.contextMeasureText=function(S$a){var S$m=S$L.context.measureText(S$a);return S$m||(S$m={width:16,height:16}),S$m},S$B.updateOrder=function(S$a){if(!S$a||S$a.length<2)return!1;for(var S$m,S$s=1,S$P=0,S$_=S$a.length,S$e=NaN;S$s<S$_;){for(S$m=S$a[S$P=S$s],S$e=S$a[S$P]._zOrder;-1<--S$P&&S$a[S$P]._zOrder>S$e;)S$a[S$P+1]=S$a[S$P];S$a[S$P+1]=S$m,S$s++}var S$A=S$m.parent.conchModel;if(S$A)if(null!=S$A.updateZOrder)S$A.updateZOrder();else{for(S$s=0;S$s<S$_;S$s++)S$A.removeChild(S$a[S$s].conchModel);for(S$s=0;S$s<S$_;S$s++)S$A.addChildAt(S$a[S$s].conchModel,S$s)}return!0},S$B.transPointList=function(S$a,S$m,S$s){var S$P=0,S$_=S$a.length;for(S$P=0;S$P<S$_;S$P+=2)S$a[S$P]+=S$m,S$a[S$P+1]+=S$s},S$B.parseInt=function(S$a,S$m){void 0===S$m&&(S$m=0);var S$s=S$L.window.parseInt(S$a,S$m);return isNaN(S$s)?0:S$s},S$B.getFileExtension=function(S$a){S$B._extReg.lastIndex=S$a.lastIndexOf(".");var S$m=S$B._extReg.exec(S$a);return S$m&&1<S$m.length?S$m[1].toLowerCase():null},S$B.getTransformRelativeToWindow=function(S$a,S$m,S$s){var S$P=S$z.stage,S$_=laya.utils.Utils.getGlobalPosAndScale(S$a),S$e=S$P._canvasTransform.clone(),S$A=S$e.tx,S$B=S$e.ty;S$e.rotate(-Math.PI/180*S$z.stage.canvasDegree),S$e.scale(S$z.stage.clientScaleX,S$z.stage.clientScaleY);var S$k=S$z.stage.canvasDegree%180!=0,S$j=NaN,S$G=NaN;S$k?(S$j=S$s+S$_.y,S$G=S$m+S$_.x,S$j*=S$e.d,S$G*=S$e.a,90==S$z.stage.canvasDegree?(S$j=S$A-S$j,S$G+=S$B):(S$j+=S$A,S$G=S$B-S$G)):(S$j=S$m+S$_.x,S$G=S$s+S$_.y,S$j*=S$e.a,S$G*=S$e.d,S$j+=S$A,S$G+=S$B);var S$y=NaN,S$d=NaN;return S$d=S$k?(S$y=S$e.d*S$_.height,S$e.a*S$_.width):(S$y=S$e.a*S$_.width,S$e.d*S$_.height),{x:S$j,y:S$G,scaleX:S$y,scaleY:S$d}},S$B.fitDOMElementInArea=function(S$a,S$m,S$s,S$P,S$_,S$e){S$a._fitLayaAirInitialized||(S$a._fitLayaAirInitialized=!0,S$a.style.transformOrigin=S$a.style.webKittransformOrigin="left top",S$a.style.position="absolute");var S$A=S$B.getTransformRelativeToWindow(S$m,S$s,S$P);S$a.style.transform=S$a.style.webkitTransform="scale("+S$A.scaleX+","+S$A.scaleY+") rotate("+S$z.stage.canvasDegree+"deg)",S$a.style.width=S$_+"px",S$a.style.height=S$e+"px",S$a.style.left=S$A.x+"px",S$a.style.top=S$A.y+"px"},S$B.isOkTextureList=function(S$a){if(!S$a)return!1;var S$m,S$s=0,S$P=S$a.length;for(S$s=0;S$s<S$P;S$s++)if(!(S$m=S$a[S$s])||!S$m.source)return!1;return!0},S$B.isOKCmdList=function(S$a){if(!S$a)return!1;var S$m,S$s,S$P=0,S$_=S$a.length,S$e=S$Z._context;for(S$P=0;S$P<S$_;S$P++)switch((S$m=S$a[S$P]).callee){case S$e._drawTexture:case S$e._fillTexture:case S$e._drawTextureWithTransform:if(!(S$s=S$m[0])||!S$s.source)return!1}return!0},S$B._gid=1,S$B._pi=180/Math.PI,S$B._pi2=Math.PI/180,S$B._extReg=/\.(\w+)\??/g,S$B.parseXMLFromString=function(S$a){var S$m;if(S$a=S$a.replace(/>\s+</g,"><"),-1<(S$m=(new DOMParser).parseFromString(S$a,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(S$m.firstChild.firstChild.textContent);return S$m},S$B}(),S$$=function(){function S$a(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],S$Z.isWebGL&&S$F.regCacheByFunction(S$I.bind(this.startDispose,this),S$I.bind(this.getCacheList,this))}S$G(S$a,"laya.utils.VectorGraphManager");var S$m=S$a.prototype;return S$m.getId=function(){return this._id++},S$m.addShape=function(S$a,S$m){this.shapeDic[S$a]=S$m,this.useDic[S$a]||(this.useDic[S$a]=!0)},S$m.addLine=function(S$a,S$m){this.shapeLineDic[S$a]=S$m,this.shapeLineDic[S$a]||(this.shapeLineDic[S$a]=!0)},S$m.getShape=function(S$a){this._checkKey&&null!=this.useDic[S$a]&&(this.useDic[S$a]=!0)},S$m.deleteShape=function(S$a){this.shapeDic[S$a]&&(this.shapeDic[S$a]=null,delete this.shapeDic[S$a]),this.shapeLineDic[S$a]&&(this.shapeLineDic[S$a]=null,delete this.shapeLineDic[S$a]),null!=this.useDic[S$a]&&delete this.useDic[S$a]},S$m.getCacheList=function(){var S$a,S$m=[];for(S$a in this.shapeDic)S$m.push(this.shapeDic[S$a]);for(S$a in this.shapeLineDic)S$m.push(this.shapeLineDic[S$a]);return S$m},S$m.startDispose=function(S$a){var S$m;for(S$m in this.useDic)this.useDic[S$m]=!1;this._checkKey=!0},S$m.endDispose=function(){if(this._checkKey){var S$a;for(S$a in this.useDic)this.useDic[S$a]||this.deleteShape(S$a);this._checkKey=!1}},S$a.getInstance=function(){return S$a.instance=S$a.instance||new S$a},S$a.instance=null,S$a}(),S$n=function(){function S$P(){this._obj=null,this._obj=S$P.supportWeakMap?new S$L.window.WeakMap:{},S$P.supportWeakMap||S$P._maps.push(this)}S$G(S$P,"laya.utils.WeakObject");var S$a=S$P.prototype;return S$a.set=function(S$a,S$m){if(null!=S$a)if(S$P.supportWeakMap){var S$s=S$a;"string"!=typeof S$a&&"number"!=typeof S$a||(S$s=S$P._keys[S$a])||(S$s=S$P._keys[S$a]={k:S$a}),this._obj.set(S$s,S$m)}else"string"==typeof S$a||"number"==typeof S$a?this._obj[S$a]=S$m:(S$a.$_GID||(S$a.$_GID=S$I.getGID()),this._obj[S$a.$_GID]=S$m)},S$a.get=function(S$a){if(null==S$a)return null;if(S$P.supportWeakMap){var S$m="string"==typeof S$a||"number"==typeof S$a?S$P._keys[S$a]:S$a;return S$m?this._obj.get(S$m):null}return"string"==typeof S$a||"number"==typeof S$a?this._obj[S$a]:this._obj[S$a.$_GID]},S$a.del=function(S$a){if(null!=S$a)if(S$P.supportWeakMap){var S$m="string"==typeof S$a||"number"==typeof S$a?S$P._keys[S$a]:S$a;if(!S$m)return;this._obj.delete(S$m)}else"string"==typeof S$a||"number"==typeof S$a?delete this._obj[S$a]:delete this._obj[this._obj.$_GID]},S$a.has=function(S$a){if(null==S$a)return!1;if(S$P.supportWeakMap){var S$m="string"==typeof S$a||"number"==typeof S$a?S$P._keys[S$a]:S$a;return this._obj.has(S$m)}return"string"==typeof S$a||"number"==typeof S$a?null!=this._obj[S$a]:null!=this._obj[this._obj.$_GID]},S$P.__init__=function(){(S$P.supportWeakMap=null!=S$L.window.WeakMap)||S$z.timer.loop(S$P.delInterval,null,S$P.clearCache)},S$P.clearCache=function(){for(var S$a=0,S$m=S$P._maps.length;S$a<S$m;S$a++){S$P._maps[S$a]._obj={}}},S$P.supportWeakMap=!1,S$P.delInterval=3e5,S$P._keys={},S$P._maps=[],S$k(S$P,["I",function(){return this.I=new S$P}]),S$P}(),S$r=function(){function S$a(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}S$G(S$a,"laya.utils.WordText");var S$m=S$a.prototype;return S$m.setText=function(S$a){this.changed=!0,this._text=S$a},S$m.toString=function(){return this._text},S$m.charCodeAt=function(S$a){return this._text?this._text.charCodeAt(S$a):NaN},S$m.charAt=function(S$a){return this._text?this._text.charAt(S$a):null},S$q(0,S$m,"length",function(){return this._text?this._text.length:0}),S$a}(),S$aa=function(S$a){function S$A(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,S$A.__super.call(this),this._childs=S$A.ARRAY_EMPTY,this._$P=S$A.PROP_EMPTY,this.timer=S$z.scaleTimer,this.conchModel=S$Z.isConchNode?this.createConchModel():null}S$G(S$A,"laya.display.Node",S$j);var S$m=S$A.prototype;return S$m._setBit=function(S$a,S$m){1==S$a&&(this._getBit(S$a)!=S$m&&this._updateDisplayedInstage());S$m?this._bits|=S$a:this._bits&=~S$a},S$m._getBit=function(S$a){return 0!=(this._bits&S$a)},S$m._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},S$m._setUpNoticeType=function(S$a){var S$m=this;for(S$m._setBit(S$a,!0),S$m=S$m.parent;S$m;){if(S$m._getBit(S$a))return;S$m._setBit(S$a,!0),S$m=S$m.parent}},S$m.on=function(S$a,S$m,S$s,S$P){return"display"!==S$a&&"undisplay"!==S$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(S$a,S$m,S$s,S$P,!1)},S$m.once=function(S$a,S$m,S$s,S$P){return"display"!==S$a&&"undisplay"!==S$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(S$a,S$m,S$s,S$P,!0)},S$m.createConchModel=function(){return null},S$m.destroy=function(S$a){void 0===S$a&&(S$a=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(S$a?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},S$m.destroyChildren=function(){if(this._childs)for(var S$a=this._childs.length-1;-1<S$a;S$a--)this._childs[S$a].destroy(!0)},S$m.addChild=function(S$a){if(!S$a||this.destroyed||S$a===this)return S$a;if(S$a.zOrder&&this._set$P("hasZorder",!0),S$a._parent===this){var S$m=this.getChildIndex(S$a);S$m!==this._childs.length-1&&(this._childs.splice(S$m,1),this._childs.push(S$a),this.conchModel&&(this.conchModel.removeChild(S$a.conchModel),this.conchModel.addChildAt(S$a.conchModel,this._childs.length-1)),this._childChanged())}else S$a.parent&&S$a.parent.removeChild(S$a),this._childs===S$A.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(S$a),this.conchModel&&this.conchModel.addChildAt(S$a.conchModel,this._childs.length-1),(S$a.parent=this)._childChanged();return S$a},S$m.addChildren=function(S$a){for(var S$m=arguments,S$s=0,S$P=S$m.length;S$s<S$P;)this.addChild(S$m[S$s++])},S$m.addChildAt=function(S$a,S$m){if(!S$a||this.destroyed||S$a===this)return S$a;if(S$a.zOrder&&this._set$P("hasZorder",!0),0<=S$m&&S$m<=this._childs.length){if(S$a._parent===this){var S$s=this.getChildIndex(S$a);this._childs.splice(S$s,1),this._childs.splice(S$m,0,S$a),this.conchModel&&(this.conchModel.removeChild(S$a.conchModel),this.conchModel.addChildAt(S$a.conchModel,S$m)),this._childChanged()}else S$a.parent&&S$a.parent.removeChild(S$a),this._childs===S$A.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(S$m,0,S$a),this.conchModel&&this.conchModel.addChildAt(S$a.conchModel,S$m),S$a.parent=this;return S$a}throw new Error("appendChildAt:The index is out of bounds")},S$m.getChildIndex=function(S$a){return this._childs.indexOf(S$a)},S$m.getChildByName=function(S$a){var S$m=this._childs;if(S$m)for(var S$s=0,S$P=S$m.length;S$s<S$P;S$s++){var S$_=S$m[S$s];if(S$_.name===S$a)return S$_}return null},S$m._get$P=function(S$a){return this._$P[S$a]},S$m._set$P=function(S$a,S$m){return this.destroyed||(this._$P===S$A.PROP_EMPTY&&(this._$P={}),this._$P[S$a]=S$m),S$m},S$m.getChildAt=function(S$a){return this._childs[S$a]},S$m.setChildIndex=function(S$a,S$m){var S$s=this._childs;if(S$m<0||S$m>=S$s.length)throw new Error("setChildIndex:The index is out of bounds.");var S$P=this.getChildIndex(S$a);if(S$P<0)throw new Error("setChildIndex:node is must child of this object.");return S$s.splice(S$P,1),S$s.splice(S$m,0,S$a),this.conchModel&&(this.conchModel.removeChild(S$a.conchModel),this.conchModel.addChildAt(S$a.conchModel,S$m)),this._childChanged(),S$a},S$m._childChanged=function(S$a){},S$m.removeChild=function(S$a){if(!this._childs)return S$a;var S$m=this._childs.indexOf(S$a);return this.removeChildAt(S$m)},S$m.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},S$m.removeChildByName=function(S$a){var S$m=this.getChildByName(S$a);return S$m&&this.removeChild(S$m),S$m},S$m.removeChildAt=function(S$a){var S$m=this.getChildAt(S$a);if(S$m){for(var S$s=this._childs.length-1,S$P=S$a;S$P<S$s;++S$P)this._childs[S$P]=this._childs[S$P+1];this._childs.length=S$s,this.conchModel&&this.conchModel.removeChild(S$m.conchModel),S$m.parent=null}return S$m},S$m.removeChildren=function(S$a,S$m){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=2147483647),this._childs&&0<this._childs.length){var S$s=this._childs;if(0===S$a&&S$e<=S$m){var S$P=S$s;this._childs=S$A.ARRAY_EMPTY}else S$P=S$s.splice(S$a,S$m-S$a);for(var S$_=0,S$e=S$P.length;S$_<S$e;S$_++)S$P[S$_].parent=null,this.conchModel&&this.conchModel.removeChild(S$P[S$_].conchModel)}return this},S$m.replaceChild=function(S$a,S$m){var S$s=this._childs.indexOf(S$m);return-1<S$s?(this._childs.splice(S$s,1,S$a),this.conchModel&&(this.conchModel.removeChild(S$m.conchModel),this.conchModel.addChildAt(S$a.conchModel,S$s)),S$m.parent=null,S$a.parent=this,S$a):null},S$m._updateDisplayedInstage=function(){var S$a;S$a=this;var S$m=S$z.stage;for(this._displayedInStage=!1;S$a;){if(S$a._getBit(1)){this._displayedInStage=S$a._displayedInStage;break}if(S$a==S$m||S$a._displayedInStage){this._displayedInStage=!0;break}S$a=S$a.parent}},S$m._setDisplay=function(S$a){this._displayedInStage!==S$a&&((this._displayedInStage=S$a)?this.event("display"):this.event("undisplay"))},S$m._displayChild=function(S$a,S$m){var S$s=S$a._childs;if(S$s)for(var S$P=0;S$P<S$s.length;S$P++){var S$_=S$s[S$P];S$_&&S$_._getBit(1)&&(0<S$_._childs.length?this._displayChild(S$_,S$m):S$_._setDisplay(S$m))}S$a._setDisplay(S$m)},S$m.contains=function(S$a){if(S$a===this)return!0;for(;S$a;){if(S$a.parent===this)return!0;S$a=S$a.parent}return!1},S$m.timerLoop=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$_&&(S$_=!0),void 0===S$e&&(S$e=!1),this.timer.loop(S$a,S$m,S$s,S$P,S$_,S$e)},S$m.timerOnce=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=!0),this.timer._create(!1,!1,S$a,S$m,S$s,S$P,S$_)},S$m.frameLoop=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=!0),this.timer._create(!0,!0,S$a,S$m,S$s,S$P,S$_)},S$m.frameOnce=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=!0),this.timer._create(!0,!1,S$a,S$m,S$s,S$P,S$_)},S$m.clearTimer=function(S$a,S$m){this.timer.clear(S$a,S$m)},S$q(0,S$m,"numChildren",function(){return this._childs.length}),S$q(0,S$m,"destroyed",function(){return this._destroyed}),S$q(0,S$m,"parent",function(){return this._parent},function(S$a){this._parent!==S$a&&(S$a?(this._parent=S$a,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),S$a.displayedInStage&&this._displayChild(this,!0)),S$a._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=S$a))}),S$q(0,S$m,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),S$A.ARRAY_EMPTY=[],S$A.PROP_EMPTY={},S$A.NOTICE_DISPLAY=1,S$A.MOUSEENABLE=2,S$A}(),S$ma=function(S$a){function S$d(S$a){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,S$d.__super.call(this),this._padding=S$d._PADDING,this._spacing=S$d._SPACING,this._aligns=S$d._ALIGNS,this._font=S$Q.EMPTY,this._ower=S$a}S$G(S$d,"laya.display.css.CSSStyle",S$a);var S$m=S$d.prototype;return S$m.destroy=function(){this._ower=null,this._font=null,this._rect=null},S$m.inherit=function(S$a){this._font=S$a._font,this._spacing=S$a._spacing===S$d._SPACING?S$d._SPACING:S$a._spacing.slice(),this.lineHeight=S$a.lineHeight},S$m._widthAuto=function(){return 0!=(262144&this._type)},S$m.widthed=function(S$a){return 0!=(8&this._type)},S$m._calculation=function(S$a,S$m){if(S$m.indexOf("%")<0)return!1;var S$P=this._ower,S$_=S$P.parent,S$e=this._rect;function S$A(S$a,S$m,S$s){return S$a*S$s[0]+S$m*S$s[1]+S$s[2]}function S$s(S$a){var S$m=S$_.width,S$s=S$P.width;S$e.width&&(S$P.width=S$A(S$m,S$s,S$e.width)),S$e.height&&(S$P.height=S$A(S$m,S$s,S$e.height)),S$e.left&&(S$P.x=S$A(S$m,S$s,S$e.left)),S$e.top&&(S$P.y=S$A(S$m,S$s,S$e.top))}null===S$e&&(S$_._getCSSStyle()._type|=524288,S$_.on("resize",this,S$s),this._rect=S$e={input:{}});var S$B=S$m.split(" ");return S$B[0]=parseFloat(S$B[0])/100,1==S$B.length?S$B[1]=S$B[2]=0:(S$B[1]=parseFloat(S$B[1])/100,S$B[2]=parseFloat(S$B[2])),S$e[S$a]=S$B,S$e.input[S$a]=S$m,S$s(),!0},S$m.heighted=function(S$a){return 0!=(8192&this._type)},S$m.size=function(S$a,S$m){var S$s=this._ower,S$P=!1;-1!==S$a&&S$a!=this._ower.width&&(this._type|=8,this._ower.width=S$a,S$P=!0),-1!==S$m&&S$m!=this._ower.height&&(this._type|=8192,this._ower.height=S$m,S$P=!0),S$P&&(S$s._layoutLater(),524288&this._type&&S$s.event("resize",this))},S$m._getAlign=function(){return this._aligns[0]},S$m._getValign=function(){return this._aligns[1]},S$m._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},S$m._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new S$Q(this._font))},S$m.render=function(S$a,S$m,S$s,S$P){var S$_=S$a.width,S$e=S$a.height;S$s-=S$a.pivotX,S$P-=S$a.pivotY,this._bgground&&null!=this._bgground.color&&S$m.ctx.fillRect(S$s,S$P,S$_,S$e,this._bgground.color),this._border&&this._border.color&&S$m.drawRect(S$s,S$P,S$_,S$e,this._border.color.strColor,this._border.size)},S$m.getCSSStyle=function(){return this},S$m.cssText=function(S$a){this.attrs(S$d.parseOneCSS(S$a,";"))},S$m.attrs=function(S$a){if(S$a)for(var S$m=0,S$s=S$a.length;S$m<S$s;S$m++){var S$P=S$a[S$m];this[S$P[0]]=S$P[1]}},S$m.setTransform=function(S$a){"none"===S$a?this._tf=S$B._TF_EMPTY:this.attrs(S$d.parseOneCSS(S$a,","))},S$m.translate=function(S$a,S$m){this._tf===S$B._TF_EMPTY&&(this._tf=new S$_),this._tf.translateX=S$a,this._tf.translateY=S$m},S$m.scale=function(S$a,S$m){this._tf===S$B._TF_EMPTY&&(this._tf=new S$_),this._tf.scaleX=S$a,this._tf.scaleY=S$m},S$m._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},S$q(0,S$m,"block",S$a.prototype._$get_block,function(S$a){S$a?this._type|=1:this._type&=-2}),S$q(0,S$m,"valign",function(){return S$d._valigndef[this._aligns[1]]},function(S$a){this._aligns===S$d._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=S$d._valigndef[S$a]}),S$q(0,S$m,"height",null,function(S$a){if(this._type|=8192,"string"==typeof S$a){if(this._calculation("height",S$a))return;S$a=parseInt(S$a)}this.size(-1,S$a)}),S$q(0,S$m,"width",null,function(S$a){if(this._type|=8,"string"==typeof S$a){var S$m=S$a.indexOf("auto");if(0<=S$m&&(this._type|=262144,S$a=S$a.substr(0,S$m)),this._calculation("width",S$a))return;S$a=parseInt(S$a)}this.size(S$a,-1)}),S$q(0,S$m,"fontWeight",function(){return this._font.weight},function(S$a){this._createFont().weight=S$a}),S$q(0,S$m,"left",null,function(S$a){var S$m=this._ower;if("string"==typeof S$a){if("center"===S$a?S$a="50% -50% 0":"right"===S$a&&(S$a="100% -100% 0"),this._calculation("left",S$a))return;S$a=parseInt(S$a)}S$m.x=S$a}),S$q(0,S$m,"_translate",null,function(S$a){this.translate(S$a[0],S$a[1])}),S$q(0,S$m,"absolute",function(){return 0!=(4&this._type)}),S$q(0,S$m,"top",null,function(S$a){var S$m=this._ower;if("string"==typeof S$a){if("middle"===S$a?S$a="50% -50% 0":"bottom"===S$a&&(S$a="100% -100% 0"),this._calculation("top",S$a))return;S$a=parseInt(S$a)}S$m.y=S$a}),S$q(0,S$m,"align",function(){return S$d._aligndef[this._aligns[0]]},function(S$a){this._aligns===S$d._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=S$d._aligndef[S$a]}),S$q(0,S$m,"bold",function(){return this._font.bold},function(S$a){this._createFont().bold=S$a}),S$q(0,S$m,"padding",function(){return this._padding},function(S$a){this._padding=S$a}),S$q(0,S$m,"leading",function(){return this._spacing[1]},function(S$a){"string"==typeof S$a&&(S$a=parseInt(S$a+"")),this._spacing===S$d._SPACING&&(this._spacing=[0,0]),this._spacing[1]=S$a}),S$q(0,S$m,"lineElement",function(){return 0!=(65536&this._type)},function(S$a){S$a?this._type|=65536:this._type&=-65537}),S$q(0,S$m,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(S$a){this.lineElement=!1,"right"===S$a?this._type|=32768:this._type&=-32769}),S$q(0,S$m,"textDecoration",function(){return this._font.decoration},function(S$a){this._createFont().decoration=S$a}),S$q(0,S$m,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(S$a){"nowrap"===S$a&&(this._type|=131072),"none"===S$a&&(this._type&=-131073)}),S$q(0,S$m,"background",null,function(S$a){S$a?(this._bgground||(this._bgground={}),this._bgground.color=S$a,this._ower.conchModel&&this._ower.conchModel.bgColor(S$a),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),S$q(0,S$m,"wordWrap",function(){return 0==(131072&this._type)},function(S$a){S$a?this._type&=-131073:this._type|=131072}),S$q(0,S$m,"color",function(){return this._font.color},function(S$a){this._createFont().color=S$a}),S$q(0,S$m,"password",function(){return this._font.password},function(S$a){this._createFont().password=S$a}),S$q(0,S$m,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(S$a){"none"===S$a?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=S$a),this._ower.conchModel&&this._ower.conchModel.bgColor(S$a),this._ower._renderType|=256}),S$q(0,S$m,"font",function(){return this._font.toString()},function(S$a){this._createFont().set(S$a)}),S$q(0,S$m,"weight",null,function(S$a){this._createFont().weight=S$a}),S$q(0,S$m,"letterSpacing",function(){return this._spacing[0]},function(S$a){"string"==typeof S$a&&(S$a=parseInt(S$a+"")),this._spacing===S$d._SPACING&&(this._spacing=[0,0]),this._spacing[0]=S$a}),S$q(0,S$m,"fontSize",function(){return this._font.size},function(S$a){this._createFont().size=S$a}),S$q(0,S$m,"italic",function(){return this._font.italic},function(S$a){this._createFont().italic=S$a}),S$q(0,S$m,"fontFamily",function(){return this._font.family},function(S$a){this._createFont().family=S$a}),S$q(0,S$m,"stroke",function(){return this._font.stroke[0]},function(S$a){this._createFont().stroke===S$Q._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=S$a}),S$q(0,S$m,"strokeColor",function(){return this._font.stroke[1]},function(S$a){this._createFont().stroke===S$Q._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=S$a}),S$q(0,S$m,"border",function(){return this._border?this._border.value:""},function(S$a){if("none"!=S$a){this._border||(this._border={});var S$m=(this._border.value=S$a).split(" ");if(this._border.color=S$M.create(S$m[S$m.length-1]),1==S$m.length)return this._border.size=1,void(this._border.type="solid");var S$s=0;0<S$m[0].indexOf("px")?(this._border.size=parseInt(S$m[0]),S$s++):this._border.size=1,this._border.type=S$m[S$s],this._ower._renderType|=256}else this._border=null}),S$q(0,S$m,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(S$a){S$a?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==S$a?null:S$M.create(S$a),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),S$q(0,S$m,"position",function(){return 4&this._type?"absolute":""},function(S$a){"absolute"==S$a?this._type|=4:this._type&=-5}),S$q(0,S$m,"display",null,function(S$a){switch(S$a){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),S$q(0,S$m,"paddingLeft",function(){return this.padding[3]}),S$q(0,S$m,"paddingTop",function(){return this.padding[0]}),S$q(0,S$m,"_scale",null,function(S$a){this._ower.scale(S$a[0],S$a[1])}),S$q(0,S$m,"_rotate",null,function(S$a){this._ower.rotation=S$a}),S$d.parseOneCSS=function(S$a,S$m){for(var S$s,S$P=[],S$_=S$a.split(S$m),S$e=0,S$A=S$_.length;S$e<S$A;S$e++){var S$B=S$_[S$e],S$k=S$B.indexOf(":"),S$j=S$B.substr(0,S$k).replace(/^\s+|\s+$/g,"");if(0!=S$j.length){var S$G=S$B.substr(S$k+1).replace(/^\s+|\s+$/g,""),S$y=[S$j,S$G];switch(S$j){case"italic":case"bold":S$y[1]="true"==S$G;break;case"line-height":S$y[0]="lineHeight",S$y[1]=parseInt(S$G);break;case"font-size":S$y[0]="fontSize",S$y[1]=parseInt(S$G);break;case"padding":1<(S$s=S$G.split(" ")).length||(S$s[1]=S$s[2]=S$s[3]=S$s[0]),S$y[1]=[parseInt(S$s[0]),parseInt(S$s[1]),parseInt(S$s[2]),parseInt(S$s[3])];break;case"rotate":S$y[0]="_rotate",S$y[1]=parseFloat(S$G);break;case"scale":S$s=S$G.split(" "),S$y[0]="_scale",S$y[1]=[parseFloat(S$s[0]),parseFloat(S$s[1])];break;case"translate":S$s=S$G.split(" "),S$y[0]="_translate",S$y[1]=[parseInt(S$s[0]),parseInt(S$s[1])];break;default:(S$y[0]=S$d._CSSTOVALUE[S$j])||(S$y[0]=S$j)}S$P.push(S$y)}}return S$P},S$d.parseCSS=function(S$a,S$m){for(var S$s;null!=(S$s=S$d._parseCSSRegExp.exec(S$a));)S$d.styleSheets[S$s[1]]=S$d.parseOneCSS(S$s[2],";")},S$d.EMPTY=new S$d(null),S$d._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},S$d._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),S$d._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},S$d._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},S$d.styleSheets={},S$d.ALIGN_CENTER=1,S$d.ALIGN_RIGHT=2,S$d.VALIGN_MIDDLE=1,S$d.VALIGN_BOTTOM=2,S$d._CSS_BLOCK=1,S$d._DISPLAY_NONE=2,S$d._ABSOLUTE=4,S$d._WIDTH_SET=8,S$d._PADDING=[0,0,0,0],S$d._RECT=[-1,-1,-1,-1],S$d._SPACING=[0,0],S$d._ALIGNS=[0,0,0],S$d.ADDLAYOUTED=512,S$d._NEWFONT=4096,S$d._HEIGHT_SET=8192,S$d._BACKGROUND_SET=16384,S$d._FLOAT_RIGHT=32768,S$d._LINE_ELEMENT=65536,S$d._NOWARP=131072,S$d._WIDTHAUTO=262144,S$d._LISTERRESZIE=524288,S$d}(S$B),S$sa=function(S$a){function S$A(){this.url=null,this.audio=null,this.loaded=!1,S$A.__super.call(this)}S$G(S$A,"laya.media.h5audio.AudioSound",S$j);var S$m=S$A.prototype;return S$m.dispose=function(){var S$a=S$A._audioCache[this.url];S$a&&(S$a.src="",delete S$A._audioCache[this.url])},S$m.load=function(S$a){var S$m;if(S$a=S$S.formatURL(S$a),(this.url=S$a)==S$K._tMusic?(S$A._initMusicAudio(),(S$m=S$A._musicAudio).src!=S$a&&(S$A._audioCache[S$m.src]=null,S$m=null)):S$m=S$A._audioCache[S$a],S$m&&2<=S$m.readyState)this.event("complete");else{S$m||(S$m=S$a==S$K._tMusic?(S$A._initMusicAudio(),S$A._musicAudio):S$L.createElement("audio"),(S$A._audioCache[S$a]=S$m).src=S$a),S$m.addEventListener("canplaythrough",S$P),S$m.addEventListener("error",S$_);var S$s=this;(this.audio=S$m).load?S$m.load():S$_()}function S$P(){S$e(),S$s.loaded=!0,S$s.event("complete")}function S$_(){S$m.load=null,S$e(),S$s.event("error")}function S$e(){S$m.removeEventListener("canplaythrough",S$P),S$m.removeEventListener("error",S$_)}},S$m.play=function(S$a,S$m,S$s){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),!this.url)return null;var S$P,S$_;if(!(S$P=this.url==S$K._tMusic?S$A._musicAudio:S$A._audioCache[this.url]))return null;S$_=S$w.getItem("audio:"+this.url),S$Z.isConchApp?S$_||((S$_=S$L.createElement("audio")).src=this.url):this.url==S$K._tMusic?(S$A._initMusicAudio(),(S$_=S$A._musicAudio).src=this.url):S$_=S$_||S$P.cloneNode(!0);var S$e=new S$da(S$_);return S$e.url=this.url,S$e.loops=S$m,S$e.startTime=S$a,S$e.startHandler=S$s,S$e.play(!1),S$K.addChannel(S$e),S$e},S$q(0,S$m,"duration",function(){var S$a;return(S$a=S$A._audioCache[this.url])?S$a.duration:0}),S$A._initMusicAudio=function(){S$A._musicAudio||(S$A._musicAudio||(S$A._musicAudio=S$L.createElement("audio")),S$Z.isConchApp||S$L.document.addEventListener("mousedown",S$A._makeMusicOK))},S$A._makeMusicOK=function(){S$L.document.removeEventListener("mousedown",S$A._makeMusicOK),S$A._musicAudio.src?S$A._musicAudio.play():(S$A._musicAudio.src="",S$A._musicAudio.load())},S$A._audioCache={},S$A._musicAudio=null,S$A}(),S$Pa=function(S$a){function S$m(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,S$m.__super.call(this)}S$G(S$m,"laya.media.SoundChannel",S$j);var S$s=S$m.prototype;return S$s.play=function(){},S$s.stop=function(){},S$s.pause=function(){},S$s.resume=function(){},S$s.__runComplete=function(S$a){S$a&&S$a.run()},S$q(0,S$s,"volume",function(){return 1},function(S$a){}),S$q(0,S$s,"position",function(){return 0}),S$q(0,S$s,"duration",function(){return 0}),S$m}(),S$_a=function(S$a){function S$m(){S$m.__super.call(this)}S$G(S$m,"laya.media.Sound",S$j);var S$s=S$m.prototype;return S$s.load=function(S$a){},S$s.play=function(S$a,S$m,S$s){return void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),null},S$s.dispose=function(){},S$q(0,S$s,"duration",function(){return 0}),S$m}(),S$ea=function(S$a){function S$_(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,S$_.__super.call(this)}S$G(S$_,"laya.media.webaudio.WebAudioSound",S$j);var S$m=S$_.prototype;return S$m.load=function(S$a){this.url=S$a,this.audioBuffer=S$_._dataCache[S$a],this.audioBuffer?this._loaded(this.audioBuffer):(S$_.e.on("loaded:"+S$a,this,this._loaded),S$_.e.on("err:"+S$a,this,this._err),S$_.__loadingSound[S$a]||(S$_.__loadingSound[S$a]=!0,S$z.loader.load(S$a,S$p.create(this,this.onloaded),null,S$Ba.BUFFER,4,!1,null,!0)))},S$m.onloaded=function(S$a){S$a||this._err(),this._disposed?this._removeLoadEvents():(this.data=S$a,S$_.buffs.push({buffer:this.data,url:this.url}),S$_.decode())},S$m._err=function(){if(this._removeLoadEvents(),S$_.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var S$a,S$m,S$s,S$P=0;for(S$a=(S$m=this.__toPlays).length,S$P=0;S$P<S$a;S$P++)(S$s=S$m[S$P])[3]&&!S$s[3].isStopped&&S$s[3].event("error");this.__toPlays.length=0}},S$m._loaded=function(S$a){this._removeLoadEvents(),this._disposed||(this.audioBuffer=S$a,this.loaded=!0,this.event("complete"))},S$m._removeLoadEvents=function(){S$_.e.off("loaded:"+this.url,this,this._loaded),S$_.e.off("err:"+this.url,this,this._err)},S$m.__playAfterLoaded=function(){if(this.__toPlays){var S$a,S$m,S$s,S$P=0;for(S$a=(S$m=this.__toPlays).length,S$P=0;S$P<S$a;S$P++)(S$s=S$m[S$P])[3]&&!S$s[3].isStopped&&this.play(S$s[0],S$s[1],S$s[2],S$s[3]);this.__toPlays.length=0}},S$m.play=function(S$a,S$m,S$s,S$P){return void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),S$P=S$P||new S$Qa,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([S$a,S$m,S$s,S$P]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),S$P.url=this.url,S$P.loops=S$m,S$P.audioBuffer=this.audioBuffer,S$P.startTime=S$a,S$P.startHandler=S$s,S$P.play(!1),S$K.addChannel(S$P),S$P},S$m.dispose=function(){this._disposed=!0,delete S$_._dataCache[this.url],delete S$_.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},S$q(0,S$m,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),S$_.decode=function(){if(!(S$_.buffs.length<=0||S$_.isDecoding))if(S$_.isDecoding=!0,(S$_.tInfo=S$_.buffs.shift())&&S$_.tInfo.buffer&&S$_.tInfo.buffer.byteLength)try{S$_.ctx.decodeAudioData(S$_.tInfo.buffer,S$_._done,S$_._fail)}catch(S$a){console.error("decodeAudioData error  byteLength:"+S$_.tInfo.buffer.byteLength+"  url:"+S$_.tInfo.url)}else S$_._fail()},S$_._done=function(S$a){S$_.e.event("loaded:"+S$_.tInfo.url,S$a),S$_._dataCache[S$_.tInfo.url]=S$a,S$_.isDecoding=!1,S$_.decode()},S$_._fail=function(){S$_.e.event("err:"+S$_.tInfo.url,null),S$_.isDecoding=!1,S$_.decode()},S$_._playEmptySound=function(){if(null!=S$_.ctx){if(S$_._emptySource&&(S$_._emptySource.stop(),S$_._emptySource.disconnect(0),!S$Qa._tryCleanFailed))try{S$_._emptySource.buffer=null}catch(S$a){S$Qa._tryCleanFailed=!0}var S$a=S$_.ctx.createBufferSource();S$a.buffer=S$_._miniBuffer,S$a.connect(S$_.ctx.destination),S$a.start(0,0,0),S$_._emptySource=S$a}},S$_._unlock=function(){S$_._unlocked||(S$_._playEmptySound(),"running"==S$_.ctx.state?(S$L.document.removeEventListener("mousedown",S$_._unlock,!0),S$L.document.removeEventListener("touchend",S$_._unlock,!0),S$L.document.removeEventListener("touchstart",S$_._unlock,!0),S$_._unlocked=!0):"suspended"==S$_.ctx.state&&S$K._recoverWebAudio())},S$_.initWebAudio=function(){"running"!=S$_.ctx.state&&(S$_._unlock(),S$L.document.addEventListener("mousedown",S$_._unlock,!0),S$L.document.addEventListener("touchend",S$_._unlock,!0),S$L.document.addEventListener("touchstart",S$_._unlock,!0))},S$_._emptySource=null,S$_._dataCache={},S$_.buffs=[],S$_.isDecoding=!1,S$_._unlocked=!1,S$_.tInfo=null,S$_.__loadingSound={},S$k(S$_,["window",function(){return this.window=S$L.window},"webAudioEnabled",function(){return this.webAudioEnabled=S$_.window.AudioContext||S$_.window.webkitAudioContext||S$_.window.mozAudioContext},"ctx",function(){return this.ctx=S$_.webAudioEnabled?new(S$_.window.AudioContext||S$_.window.webkitAudioContext||S$_.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=S$_.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new S$j}]),S$_}(),S$Aa=function(S$a){function S$m(){this._responseType=null,this._data=null,S$m.__super.call(this),this._http=new S$L.window.XMLHttpRequest}S$G(S$m,"laya.net.HttpRequest",S$j);var S$s=S$m.prototype;return S$s.send=function(S$a,S$m,S$s,S$P,S$_){void 0===S$s&&(S$s="get"),void 0===S$P&&(S$P="text"),this._responseType=S$P,this._data=null;var S$e=this,S$A=this._http;if(S$A.open(S$s,S$a,!0),S$_)for(var S$B=0;S$B<S$_.length;S$B++)S$A.setRequestHeader(S$_[S$B++],S$_[S$B]);else S$Z.isConchApp||(S$m&&"string"!=typeof S$m?S$A.setRequestHeader("Content-Type","application/json"):S$A.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));S$A.responseType="arraybuffer"!==S$P?"text":"arraybuffer",S$A.onerror=function(S$a){S$e._onError(S$a)},S$A.onabort=function(S$a){S$e._onAbort(S$a)},S$A.onprogress=function(S$a){S$e._onProgress(S$a)},S$A.onload=function(S$a){S$e._onLoad(S$a)},S$A.send(S$m)},S$s._onProgress=function(S$a){S$a&&S$a.lengthComputable&&this.event("progress",S$a.loaded/S$a.total)},S$s._onAbort=function(S$a){this.error("Request was aborted by user")},S$s._onError=function(S$a){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},S$s._onLoad=function(S$a){var S$m=this._http,S$s=void 0!==S$m.status?S$m.status:200;200===S$s||204===S$s||0===S$s?this.complete():this.error("["+S$m.status+"]"+S$m.statusText+":"+S$m.responseURL)},S$s.error=function(S$a){this.clear(),this.event("error",S$a)},S$s.complete=function(){this.clear();var S$m=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=S$I.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(S$a){S$m=!1,this.error(S$a.message)}S$m&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},S$s.clear=function(){var S$a=this._http;S$a.onerror=S$a.onabort=S$a.onprogress=S$a.onload=null},S$q(0,S$s,"url",function(){return this._http.responseURL}),S$q(0,S$s,"http",function(){return this._http}),S$q(0,S$s,"data",function(){return this._data}),S$m}(),S$Ba=function(S$a){function S$C(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,S$C.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1,this._base64=!1}S$G(S$C,"laya.net.Loader",S$j);var S$m=S$C.prototype;return S$m.load=function(S$a,S$m,S$s,S$P,S$_){if(S$a&&""!=S$a||console.error("Loader 加载的url不合法 "+S$a),void 0===S$s&&(S$s=!0),void 0===S$_&&(S$_=!1),this._url=S$a,this._base64=!1,0===S$a.indexOf("data:image")?(this._base64=!0,this._type=S$m="image"):this._type=S$m||(S$m=this.getTypeFromUrl(S$a)),this._cache=S$s,this._data=null,!S$_&&S$C.loadedMap[S$a])return this._data=S$C.loadedMap[S$a],this.event("progress",1),void this.event("complete",this._data);if(S$P&&S$C.setGroup(S$a,S$P),null!=S$C.parserMap[S$m])return this._customParse=!0,void(S$C.parserMap[S$m]instanceof laya.utils.Handler?S$C.parserMap[S$m].runWith(this):S$C.parserMap[S$m].call(null,this));if("image"===S$m||"htmlimage"===S$m||"nativeimage"===S$m)return this._loadImage(S$a);if("ttf"===S$m)return this._loadTTF(S$a);switch(S$m){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:S$m}S$C.preLoadedMap[S$a]?this.onLoaded(S$C.preLoadedMap[S$a]):S$A.resMgrLoad(S$a,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},S$m.getTypeFromUrl=function(S$a){var S$m=S$I.getFileExtension(S$a);return S$m?S$C.typeMap[S$m]:(console.warn("Not recognize the resources suffix",S$a),"text")},S$m._loadTTF=function(S$a){S$a=S$S.formatURL(S$a);var S$m=new S$b;S$m.complete=S$p.create(this,this.onLoaded),S$m.load(S$a)},S$m._loadBase64Image=function(S$m){S$m=S$S.formatURL(S$m);var S$s,S$a=this;function S$P(){S$s.onload=null,S$s.onerror=null,delete S$C.imgCache[S$m]}function S$_(){S$P(),S$a.onLoaded(S$s)}function S$e(){S$P(),S$a.event("error","Load image failed")}"nativeimage"===this._type?((S$s=new S$L.window.Image).crossOrigin="",S$s.onload=S$_,S$s.onerror=S$e,S$s.src=S$m,S$C.imgCache[S$m]=S$s):new S$Na.create(S$m,{onload:S$_,onerror:S$e,onCreate:function(S$a){S$s=S$a,S$C.imgCache[S$m]=S$a}})},S$m._loadImage=function(S$a){this._base64?this._loadBase64Image(S$a):S$A.imgMgrLoad(S$a,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},S$m._loadImageComplete=function(S$a,S$m,S$s){if(null!=S$s)if(S$s instanceof ArrayBuffer){var S$P=new DataView(S$s),S$_=new laya.webgl.resource.WebGLImage(new Uint8Array(S$s,8),S$a,0,!1,S$P.getUint32(0),S$P.getUint32(4));this.onLoaded(S$_)}else if(S$s instanceof S$Ga)S$C.imgMgrSet[S$a]=S$m,S$A.imgMgrLock(S$a,S$C.imgMgrSet[S$a]),this._url=S$a,this.complete(S$s);else{var S$e=-1!=S$a.indexOf(".png",S$a.length-4)?6408:6407;S$_=new laya.webgl.resource.WebGLImage(S$s,S$a,S$e,!1,S$s.width,S$s.height);this.onLoaded(S$_)}else this.event("error","Load image failed")},S$m.imageCancel=function(S$a,S$m,S$s){S$A.imgMgrCancel&&S$A.imgMgrCancel(S$a,this._onImageCallback)},S$m._loadSound=function(S$a){var S$m=new S$K._soundClass,S$s=this;function S$P(){S$m.offAll()}S$m.on("complete",this,function(){S$P(),S$s.onLoaded(S$m)}),S$m.on("error",this,function(){S$P(),S$m.dispose(),S$s.event("error","Load sound failed")}),S$m.load(S$a)},S$m.onProgress=function(S$a){"atlas"===this._type?this.event("progress",.3*S$a):this.event("progress",S$a)},S$m.onError=function(S$a){this.event("error",S$a)},S$m._loadedComplete=function(S$a,S$m,S$s){if(null!=S$s)switch(this._type){case"atlas":case"plf":case"json":var S$P=new S$R(S$s);this.onLoaded(JSON.parse(S$P.readUTFBytes()));break;case"font":S$P=new S$R(S$s);this.onLoaded(S$I.parseXMLFromString(S$P.readUTFBytes()));break;default:this.onLoaded(S$s)}else this.event("error",S$a)},S$m.onLoaded=function(S$a){var S$m=this._type;if("plf"==S$m)this.parsePLFData(S$a),this.complete(S$a);else if("image"===S$m){var S$s=new S$Ga(S$a);S$s.url=this._url,this.complete(S$s)}else if("sound"===S$m||"htmlimage"===S$m||"nativeimage"===S$m)this.complete(S$a);else if("atlas"===S$m){if(!S$a.src&&!S$a._setContext){if(!this._data){if((this._data=S$a).meta&&S$a.meta.image)for(var S$P=S$a.meta.image.split(","),S$_=0<=this._url.indexOf("/")?"/":"\\",S$e=this._url.lastIndexOf(S$_),S$A=0<=S$e?this._url.substr(0,S$e+1):"",S$B=0,S$k=S$P.length;S$B<S$k;S$B++)S$P[S$B]=S$A+S$P[S$B];else S$P=[this._url.replace(".json",".png")];S$P.reverse(),S$a.toLoads=S$P,S$a.pics=[]}return this.event("progress",.3+1/S$P.length*.6),this._loadImage(S$P.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(S$a),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var S$j=this._data.frames,S$G=this._url.split("?")[0],S$y=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:S$G.substring(0,S$G.lastIndexOf("."))+"/",S$d=this._data.pics,S$Q=S$S.formatURL(this._url),S$q=S$C.atlasMap[S$Q]||(S$C.atlasMap[S$Q]=[]);S$q.dir=S$y;var S$h=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var S$u in S$h=parseFloat(this._data.meta.scale),S$j){var S$O,S$p=S$j[S$u],S$c=S$d[S$p.frame.idx?S$p.frame.idx:0],S$H=S$S.formatURL(S$y+S$u);S$c.scaleRate=S$h,S$O=S$Ga.create(S$c,S$p.frame.x,S$p.frame.y,S$p.frame.w,S$p.frame.h,S$p.spriteSourceSize.x,S$p.spriteSourceSize.y,S$p.sourceSize.w,S$p.sourceSize.h),S$C.cacheRes(S$H,S$O),S$C.keepCache(this._url,S$y+S$u),S$O.url=S$H,S$q.push(S$H)}else for(S$u in S$j)S$c=S$d[(S$p=S$j[S$u]).frame.idx?S$p.frame.idx:0],S$H=S$S.formatURL(S$y+S$u),S$C.cacheRes(S$H,S$Ga.create(S$c,S$p.frame.x,S$p.frame.y,S$p.frame.w,S$p.frame.h,S$p.spriteSourceSize.x,S$p.spriteSourceSize.y,S$p.sourceSize.w,S$p.sourceSize.h)),S$C.loadedMap[S$H].url=S$H,S$C.keepCache(this._url,S$y+S$u),S$q.push(S$H);delete this._data.pics,this.complete(this._data)}else if("font"==S$m){if(!S$a.src)return this._data=S$a,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var S$o=new S$f;S$o.parseFont(this._data,S$a);var S$N=this._url.split(".fnt")[0].split("/"),S$z=S$N[S$N.length-1];S$ua.registerBitmapFont(S$z,S$o),this._data=S$o,this.complete(this._data)}else if("pkm"==S$m){var S$U=S$Na.create(S$a,this._url),S$l=new S$Ga(S$U);S$l.url=this._url,this.complete(S$l)}else this.complete(S$a)},S$m.parsePLFData=function(S$a){var S$m,S$s,S$P;for(S$m in S$a)switch(S$P=S$a[S$m],S$m){case"json":case"text":for(S$s in S$P)S$C.preLoadedMap[S$S.formatURL(S$s)]=S$P[S$s];break;default:for(S$s in S$P)S$C.preLoadedMap[S$S.formatURL(S$s)]=S$P[S$s]}},S$m.complete=function(S$a){this._data=S$a,this._customParse?this.event("loaded",S$a instanceof Array?[S$a]:S$a):(S$C._loaders.push(this),S$C._isWorking||S$C.checkNext())},S$m.endLoad=function(S$a){S$a&&(this._data=S$a),this._cache&&S$C.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},S$q(0,S$m,"url",function(){return this._url}),S$q(0,S$m,"data",function(){return this._data}),S$q(0,S$m,"cache",function(){return this._cache}),S$q(0,S$m,"type",function(){return this._type}),S$C.checkNext=function(){S$C._isWorking=!0;for(var S$a=S$L.now();S$C._startIndex<S$C._loaders.length;)if(S$L.now(),S$C._loaders[S$C._startIndex].endLoad(),S$C._startIndex++,S$L.now()-S$a>S$C.maxTimeOut)return console.warn("loader callback cost a long time:"+(S$L.now()-S$a)+" url="+S$C._loaders[S$C._startIndex-1].url),void S$z.timer.frameOnce(1,null,S$C.checkNext);S$C._loaders.length=0,S$C._startIndex=0,S$C._isWorking=!1},S$C.clearRes=function(S$a,S$m){if(null!=S$a){void 0===S$m&&(S$m=!1),S$a=S$S.formatURL(S$a);var S$s=S$C.getAtlas(S$a);if(S$s){for(var S$P=0,S$_=S$s.length;S$P<S$_;S$P++){var S$e=S$s[S$P],S$A=S$C.getRes(S$e);delete S$C.loadedMap[S$e],S$C.clearCache(S$a.substring(S$S.basePath.length),S$e.substring(S$S.basePath.length)),S$A&&S$A.destroy(S$m)}S$s.length=0,delete S$C.atlasMap[S$a],delete S$C.loadedMap[S$a]}else{var S$B=S$C.loadedMap[S$a];S$B&&(delete S$C.loadedMap[S$a],S$B instanceof laya.resource.Texture&&S$B.bitmap&&S$B.destroy(S$m))}}},S$C.clearTextureRes=function(S$a){S$a=S$S.formatURL(S$a);var S$m=laya.net.Loader.getAtlas(S$a),S$s=S$m&&0<S$m.length?laya.net.Loader.getRes(S$m[0]):laya.net.Loader.getRes(S$a);S$s&&S$s.bitmap&&(S$Z.isConchApp&&!S$Z.isConchWebGL?S$s.bitmap.source.releaseTexture&&S$s.bitmap.source.releaseTexture():null==S$s.bitmap._atlaser&&S$s.bitmap.releaseResource(!0))},S$C.getRes=function(S$a){return S$C.loadedMap[S$S.formatURL(S$a)]},S$C.getAtlas=function(S$a){return S$C.atlasMap[S$S.formatURL(S$a)]},S$C.cacheRes=function(S$a,S$m){S$a=S$S.formatURL(S$a),null!=S$C.loadedMap[S$a]?console.warn("Resources already exist,is repeated loading:",S$a):S$C.loadedMap[S$a]=S$m},S$C.setGroup=function(S$a,S$m){S$C.groupMap[S$m]||(S$C.groupMap[S$m]=[]),S$C.groupMap[S$m].push(S$a)},S$C.clearResByGroup=function(S$a){if(S$C.groupMap[S$a]){var S$m=S$C.groupMap[S$a],S$s=0,S$P=S$m.length;for(S$s=0;S$s<S$P;S$s++)S$C.clearRes(S$m[S$s]);S$m.length=0}},S$C.keepCache=function(S$a,S$m){if(S$a&&S$m){var S$s=S$C.cacheSet[S$m];S$s?-1==S$s.indexOf(S$a)&&S$s.push(S$a):S$C.cacheSet[S$m]=[S$a]}},S$C.clearCache=function(S$a,S$m){if(S$a&&S$m){var S$s=S$C.cacheSet[S$m];if(S$s){var S$P=S$s.indexOf(S$a);if(-1!==S$P){var S$_=S$s.length-1;0==S$_?(delete S$C.cacheSet[S$m],0<S$C.imgMgrSet[S$m]?S$A.imgMgrFree(S$m,S$C.imgMgrSet[S$m]):S$C.clearRes(S$m,!0)):(S$s[S$P]=S$s[S$_],S$s.length=S$_)}}}},S$C.saveObject=function(S$a,S$m,S$s){if(S$m&&S$a){var S$P=S$C.objectSet[S$a];S$P?(console.warn("Loader.saveObject: "+S$a),S$P[0]=S$m,S$P[1]=S$s):S$C.objectSet[S$a]=[S$m,S$s,[]]}},S$C.findObject=function(S$a){if(S$a){var S$m=S$C.objectSet[S$a];if(S$m)return S$m[0]}return null},S$C.keepObject=function(S$a,S$m){if(S$a&&S$m){var S$s=S$C.objectSet[S$m];S$s&&-1===S$s[2].indexOf(S$a)&&S$s[2].push(S$a)}},S$C.clearObject=function(S$a,S$m){if(S$a&&S$m){var S$s=S$C.objectSet[S$m];if(S$s){var S$P=S$s[2],S$_=S$P.indexOf(S$a);if(-1!==S$_){var S$e=S$P.length-1;0==S$e?(delete S$C.objectSet[S$m],S$s[1]&&S$s[1].call(null,S$s[0])):(S$P[S$_]=S$P[S$e],S$P.length=S$e)}}}},S$C.TEXT="text",S$C.JSON="json",S$C.XML="xml",S$C.BUFFER="arraybuffer",S$C.IMAGE="image",S$C.SOUND="sound",S$C.ATLAS="atlas",S$C.FONT="font",S$C.TTF="ttf",S$C.PLF="plf",S$C.PKM="pkm",S$C.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},S$C.parserMap={},S$C.groupMap={},S$C.maxTimeOut=100,S$C.loadedMap={},S$C.preLoadedMap={},S$C.atlasMap={},S$C._loaders=[],S$C._isWorking=!1,S$C._startIndex=0,S$C.imgCache={},S$C.cacheSet={},S$C.objectSet={},S$C.imgMgrSet={},S$C}(),S$ka=function(S$a){var S$d;function S$Q(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},S$Q.__super.call(this);for(var S$a=0;S$a<this._maxPriority;S$a++)this._resInfos[S$a]=[]}S$G(S$Q,"laya.net.LoaderManager",S$j);var S$m=S$Q.prototype;return S$m.create=function(S$a,S$s,S$m,S$P,S$_,S$e,S$A,S$B){if(null==S$e&&(S$e=2),null==S$A&&(S$A=!0),S$a instanceof Array){var S$k=S$a,S$j=S$k.length,S$G=0;if(S$m)var S$y=S$p.create(S$m.caller,S$m.method,S$m.args,!1);for(var S$d=0;S$d<S$j;S$d++){var S$Q=S$k[S$d];"string"==typeof S$Q&&(S$Q=S$k[S$d]={url:S$Q}),S$Q.progress=0}for(S$d=0;S$d<S$j;S$d++){S$Q=S$k[S$d];var S$q=S$m?S$p.create(null,S$O,[S$Q],!1):null,S$h=S$m||S$s?S$p.create(null,S$u,[S$Q]):null;this._create(S$Q.url,S$h,S$q,S$Q.clas||S$P,S$Q.params||S$_,null!=S$Q.priority&&0<=S$Q.priority?S$Q.priority:S$e,S$A,S$Q.group||S$B)}function S$u(S$a,S$m){S$G++,S$a.progress=1,S$G===S$j&&S$s&&S$s.run()}function S$O(S$a,S$m){S$a.progress=S$m;for(var S$s=0,S$P=0;S$P<S$j;S$P++){S$s+=S$k[S$P].progress}var S$_=S$s/S$j;S$y.runWith(S$_)}return!0}return this._create(S$a,S$s,S$m,S$P,S$_,S$e,S$A,S$B)},S$m._create=function(S$m,S$s,S$a,S$P,S$_,S$e,S$A,S$B){S$m&&""!=S$m||console.error("加载的url不合法 "+S$m),null==S$e&&(S$e=2),null==S$A&&(S$A=!0);var S$k=S$S.formatURL(S$m),S$j=this.getRes(S$k);if(S$j)!S$j.hasOwnProperty("loaded")||S$j.loaded?(S$a&&S$a.runWith(1),S$s&&S$s.run()):S$s&&S$z.loader._createListener(S$m,S$s.caller,S$s.method,S$s.args,!0,!1);else{var S$G=S$I.getFileExtension(S$m),S$y=S$Q.createMap[S$G];if(!S$y)throw new Error("LoaderManager:unknown file("+S$m+") extension with: "+S$G+".");S$P||(S$P=S$y[0]);var S$d=S$y[1];if("atlas"==S$G)this.load(S$m,S$s,S$a,S$d,S$e,S$A);else{S$P===S$Ga&&(S$d="htmlimage"),(S$j=S$P?new S$P:null).hasOwnProperty("_loaded")&&(S$j._loaded=!1),S$j._setUrl(S$m),S$B&&S$j._setGroup(S$B),this._createLoad(S$j,S$m,S$p.create(null,function(S$a){S$j&&!S$j.destroyed&&S$a&&S$j.onAsynLoaded.call(S$j,S$m,S$a,S$_),S$s&&S$s.run();S$z.loader.event(S$m)}),S$a,S$d,S$e,!1,S$B,!0),S$A&&this.cacheRes(S$k,S$j)}}return S$j},S$m.load=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){S$a&&""!=S$a||console.error("加载的url不合法 "+S$a);var S$k=this;if(null==S$_&&(S$_=2),null==S$e&&(S$e=!0),void 0===S$B&&(S$B=!1),S$a instanceof Array)return this._loadAssets(S$a,S$m,S$s,S$P,S$_,S$e,S$A);var S$j=S$Ba.getRes(S$a);if(null!=S$j)S$z.timer.frameOnce(1,null,function(){S$s&&S$s.runWith(1),S$m&&S$m.runWith(S$j),S$k._loaderCount||S$k.event("complete")});else{var S$G=S$Q._resMap[S$a];S$G?(S$m&&S$G._createListener("complete",S$m.caller,S$m.method,S$m.args,!1,!1),S$s&&S$G._createListener("progress",S$s.caller,S$s.method,S$s.args,!1,!1)):((S$G=this._infoPool.length?this._infoPool.pop():new S$d).url=S$a,S$G.clas=null,S$G.type=S$P,S$G.cache=S$e,S$G.group=S$A,S$G.ignoreCache=S$B,S$G.priority=S$_,S$m&&S$G.on("complete",S$m.caller,S$m.method,S$m.args),S$s&&S$G.on("progress",S$s.caller,S$s.method,S$s.args),S$Q._resMap[S$a]=S$G,S$_=S$_<this._maxPriority?0<=S$_?S$_:0:this._maxPriority-1,this._resInfos[S$_].push(S$G),this._next())}return this},S$m.cancel=function(S$a,S$m,S$s){if(S$j=S$Q._resMap[S$a]){S$m&&S$j.off("complete",S$m.caller,S$m.method,!1),S$s&&S$j.off("progress",S$s.caller,S$s.method,!1);var S$P=S$j.getListener("complete"),S$_=S$j.getListener("progress");if(!(S$P&&S$P.head||S$_&&S$_.head)){if(S$j.loader){var S$e=S$j.loader;S$e.imageCancel(S$a),S$e.offAll(),S$e._data=null,S$e._customParse=!1,S$e._url=null,S$e._class=null,S$e._type=null,this._loaders.push(S$e),this._loaderCount--,delete this._loaderMap[S$j.url]}for(var S$A=0;S$A<this._maxPriority;S$A++)for(var S$B=this._resInfos[S$A],S$k=S$B.length-1;-1<S$k;S$k--){var S$j;(S$j=S$B[S$k])&&S$j.url===S$a&&(S$B[S$k]=null,S$j.destroy(),S$j.offAll(),this._infoPool.push(S$j))}delete S$Q._resMap[S$a],this._next()}}},S$m._createLoad=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){var S$j=this;if(null==S$e&&(S$e=2),null==S$A&&(S$A=!0),void 0===S$k&&(S$k=!1),S$m instanceof Array)return this._loadAssets(S$m,S$s,S$P,S$_,S$e,S$A,S$B);var S$G=S$Ba.getRes(S$m);if(null!=S$G)S$z.timer.frameOnce(1,null,function(){S$P&&S$P.runWith(1),S$s&&S$s.runWith(S$G),S$j._loaderCount||S$j.event("complete")});else{var S$y=S$Q._resMap[S$m];S$y?(S$s&&S$y._createListener("complete",S$s.caller,S$s.method,S$s.args,!1,!1),S$P&&S$y._createListener("progress",S$P.caller,S$P.method,S$P.args,!1,!1)):((S$y=this._infoPool.length?this._infoPool.pop():new S$d).url=S$m,S$y.clas=S$a,S$y.type=S$_,S$y.cache=S$A,S$y.group=S$B,S$y.ignoreCache=S$k,S$y.priority=S$e,S$s&&S$y.on("complete",S$s.caller,S$s.method,S$s.args),S$P&&S$y.on("progress",S$P.caller,S$P.method,S$P.args),S$Q._resMap[S$m]=S$y,S$e=S$e<this._maxPriority?0<=S$e?S$e:0:this._maxPriority-1,this._resInfos[S$e].push(S$y),this._next())}return this},S$m._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var S$a=0;S$a<this._maxPriority;S$a++)for(var S$m=this._resInfos[S$a];0<S$m.length;){var S$s=S$m.shift();if(S$s)return this._doLoad(S$s)}this._loaderCount||this.event("complete")}},S$m._doLoad=function(S$m){var S$s=this._loaders.length?this._loaders.pop():new S$Ba;this._loaderCount++,(this._loaderMap[S$m.url]=S$s).on("complete",null,S$_),S$s.on("progress",null,function(S$a){S$m.event("progress",S$a)}),S$s.on("error",null,function(S$a){S$_(null)}),S$m.loader=S$s;var S$P=this;function S$_(S$a){S$s.offAll(),S$s._data=null,S$s._customParse=!1,S$s._url=null,S$s._class=null,S$s._type=null,S$P._loaders.push(S$s),S$P._loaderCount--,delete S$P._loaderMap[S$m.url],S$P._endLoad(S$m,S$a instanceof Array?[S$a]:S$a),S$P._next()}S$s._class=S$m.clas,1<=S$m.priority?(S$s.priority=S$m.priority,S$s.realTime=!1):(S$s.priority=0,S$s.realTime=!0),S$s.load(S$m.url,S$m.type,S$m.cache,S$m.group,S$m.ignoreCache)},S$m._endLoad=function(S$a,S$m){var S$s=S$a.url;if(null==S$m){var S$P=this._failRes[S$s]||0;if(S$P<this.retryNum)return console.warn("[warn]Retry to load:",S$s),this._failRes[S$s]=S$P+1,void S$z.timer.once(this.retryDelay,this,this._addReTry,[S$a],!1);console.warn("[error]Failed to load:",S$s),this.event("error",S$s)}this._failRes[S$s]&&(this._failRes[S$s]=0),delete S$Q._resMap[S$s],S$a.event("complete",S$m),S$a.destroy(),S$a.offAll(),this._infoPool.push(S$a)},S$m._addReTry=function(S$a){this._resInfos[this._maxPriority-1].push(S$a),this._next()},S$m.clearRes=function(S$a,S$m){void 0===S$m&&(S$m=!1),S$Ba.clearRes(S$a,S$m)},S$m.getRes=function(S$a){return S$Ba.getRes(S$a)},S$m.cacheRes=function(S$a,S$m){S$Ba.cacheRes(S$a,S$m)},S$m.clearTextureRes=function(S$a){S$Ba.clearTextureRes(S$a)},S$m.setGroup=function(S$a,S$m){S$Ba.setGroup(S$a,S$m)},S$m.clearResByGroup=function(S$a){S$Ba.clearResByGroup(S$a)},S$m.clearUnLoaded=function(){for(var S$a=0;S$a<this._maxPriority;S$a++){for(var S$m=this._resInfos[S$a],S$s=S$m.length-1;-1<S$s;S$s--){var S$P=S$m[S$s];S$P&&(S$P.destroy(),S$P.offAll(),this._infoPool.push(S$P))}S$m.length=0}this._loaderCount=0,S$Q._resMap={}},S$m.cancelLoadByUrls=function(S$a){if(S$a)for(var S$m=0,S$s=S$a.length;S$m<S$s;S$m++)this.cancelLoadByUrl(S$a[S$m])},S$m.cancelLoadByUrl=function(S$a){for(var S$m=0;S$m<this._maxPriority;S$m++)for(var S$s=this._resInfos[S$m],S$P=S$s.length-1;-1<S$P;S$P--){var S$_=S$s[S$P];S$_&&S$_.url===S$a&&(S$s[S$P]=null,S$_.destroy(),S$_.offAll(),this._infoPool.push(S$_))}S$Q._resMap[S$a]&&delete S$Q._resMap[S$a]},S$m._loadAssets=function(S$a,S$s,S$A,S$m,S$P,S$_,S$e){null==S$P&&(S$P=2),null==S$_&&(S$_=!0);for(var S$B=S$a.length,S$k=0,S$j=0,S$G=[],S$y=!0,S$d=0;S$d<S$B;S$d++){var S$Q=S$a[S$d];if(!S$Q)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+S$a);"string"==typeof S$Q&&(S$Q={url:S$Q,type:S$m,size:1,priority:S$P}),S$Q.size||(S$Q.size=1),S$Q.progress=0,S$j+=S$Q.size,S$G.push(S$Q);var S$q=S$A?S$p.create(null,S$O,[S$Q],!1):null,S$h=S$s||S$A?S$p.create(null,S$u,[S$Q]):null;this.load(S$Q.url,S$h,S$q,S$Q.type,null!=S$Q.priority&&0<=S$Q.priority?S$Q.priority:2,S$_,S$Q.group||S$e)}function S$u(S$a,S$m){S$k++,S$a.progress=1,S$m||(S$y=!1),S$k===S$B&&S$s&&S$s.runWith(S$y)}function S$O(S$a,S$m){if(null!=S$A){S$a.progress=S$m;for(var S$s=0,S$P=0;S$P<S$G.length;S$P++){var S$_=S$G[S$P];S$s+=S$_.size*S$_.progress}var S$e=S$s/S$j;S$A.runWith(S$e)}}return this},S$Q.cacheRes=function(S$a,S$m){S$Ba.cacheRes(S$a,S$m)},S$Q._resMap={},S$k(S$Q,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),S$Q.__init$=function(){S$d=function(S$a){function S$m(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,S$m.__super.call(this)}return S$G(S$m,"",S$j),S$m.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},S$m}()},S$Q}(),S$ja=(function(S$a){function S$_(S$a){S$_.__super.call(this),S$a||(S$a=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var S$m=0,S$s=0,S$P=0;S$P<20;S$P++)S$P%5!=4?this._mat[S$m++]=S$a[S$P]:this._alpha[S$s++]=S$a[S$P];this._action=S$V.createFilterAction(32),this._action.data=this}S$G(S$_,"laya.filters.ColorFilter",S$O);var S$m=S$_.prototype;S$z.imps(S$m,{"laya.filters.IFilter":!0}),S$m.callNative=function(S$a){S$a._$P.cf=this;S$a.conchModel&&S$a.conchModel.setFilterMatrix&&S$a.conchModel.setFilterMatrix(this._mat,this._alpha)},S$q(0,S$m,"type",function(){return 32}),S$q(0,S$m,"action",function(){return this._action})}(),function(S$a){function S$P(S$a,S$m,S$s){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===S$m&&(S$m=0),S$P.__super.call(this),this._byteClass=S$s||S$R,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,S$a&&0<S$m&&S$m<65535&&this.connect(S$a,S$m)}S$G(S$P,"laya.net.Socket",S$j);var S$m=S$P.prototype;S$m.connect=function(S$a,S$m){var S$s="ws://"+S$a+":"+S$m;S$s="https:"==S$L.window.location.protocol?"wss://"+S$a+":"+S$m:"ws://"+S$a+":"+S$m,this.connectByUrl(S$s)},S$m.connectByUrl=function(S$a){var S$m=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new S$L.window.WebSocket(S$a,this.protocols):this._socket=new S$L.window.WebSocket(S$a),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(S$a){S$m._onOpen(S$a)},this._socket.onmessage=function(S$a){S$m._onMessage(S$a)},this._socket.onclose=function(S$a){S$m._onClose(S$a)},this._socket.onerror=function(S$a){S$m._onError(S$a)}},S$m.cleanSocket=function(){try{this._socket.close()}catch(S$a){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},S$m.close=function(){if(null!=this._socket)try{this._socket.close()}catch(S$a){}},S$m._onOpen=function(S$a){this._connected=!0,this.event("open",S$a)},S$m._onMessage=function(S$a){if(S$a&&S$a.data){var S$m=S$a.data;if(this.disableInput&&S$m)this.event("message",S$m);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var S$s=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,S$m&&("string"==typeof S$m?this._input.writeUTFBytes(S$m):this._input.writeArrayBuffer(S$m),this._addInputPosition=this._input.pos,this._input.pos=S$s),this.event("message",S$m)}}},S$m._onClose=function(S$a){this._connected=!1,this.event("close",S$a)},S$m._onError=function(S$a){this.event("error",S$a)},S$m.send=function(S$a){this._socket.send(S$a)},S$m.flush=function(){if(this._output&&0<this._output.length){var S$m;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(S$a){S$m=S$a}this._output.endian=this.endian,this._output.clear(),S$m&&this.event("error",S$m)}},S$q(0,S$m,"input",function(){return this._input}),S$q(0,S$m,"output",function(){return this._output}),S$q(0,S$m,"connected",function(){return this._connected}),S$q(0,S$m,"endian",function(){return this._endian},function(S$a){this._endian=S$a,null!=this._input&&(this._input.endian=S$a),null!=this._output&&(this._output.endian=S$a)}),S$P.LITTLE_ENDIAN="littleEndian",S$P.BIG_ENDIAN="bigEndian"}(),function(S$a){function S$B(){S$B.__super.call(this),this._$1__id=++S$B._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(S$B._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,S$t.currentResourceManager&&S$t.currentResourceManager.addResource(this)}S$G(S$B,"laya.resource.Resource",S$j);var S$m=S$B.prototype;return S$z.imps(S$m,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),S$m._setUrl=function(S$a){var S$m;this._url!==S$a&&(this._url&&((S$m=S$B._urlResourcesMap[this._url]).splice(S$m.indexOf(this),1),0===S$m.length&&delete S$B._urlResourcesMap[this._url]),S$a&&((S$m=S$B._urlResourcesMap[S$a])||(S$B._urlResourcesMap[S$a]=S$m=[]),S$m.push(this)),this._url=S$a)},S$m._getGroup=function(){return this._group},S$m._setGroup=function(S$a){var S$m;this._group!==S$a&&(this._group&&((S$m=S$B._groupResourcesMap[this._group]).splice(S$m.indexOf(this),1),0===S$m.length&&delete S$B._groupResourcesMap[this._group]),S$a&&((S$m=S$B._groupResourcesMap[S$a])||(S$B._groupResourcesMap[S$a]=S$m=[]),S$m.push(this)),this._group=S$a)},S$m._addReference=function(){this._referenceCount++},S$m._removeReference=function(){this._referenceCount--},S$m._clearReference=function(){this._referenceCount=0},S$m._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},S$m.recreateResource=function(){this.completeCreate()},S$m.disposeResource=function(){},S$m.activeResource=function(S$a){void 0===S$a&&(S$a=!1),this._lastUseFrameCount=S$v.loopCount,!this._destroyed&&this.__loaded&&(this._released||S$a)&&this.recreateResource()},S$m.releaseResource=function(S$a){return void 0===S$a&&(S$a=!0),!(!S$a&&this.lock)&&(!(this._released&&!S$a)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},S$m.onAsynLoaded=function(S$a,S$m,S$s){throw new Error("Resource: must override this function!")},S$m.destroy=function(){var S$a;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete S$B._idResourcesMap[this.id],this._url&&((S$a=S$B._urlResourcesMap[this._url])&&(S$a.splice(S$a.indexOf(this),1),0===S$a.length&&delete S$B._urlResourcesMap[this.url]),S$Ba.clearRes(this._url),this.__loaded||S$V.cancelLoadByUrl(this._url)),this._group&&((S$a=S$B._groupResourcesMap[this._group]).splice(S$a.indexOf(this),1),0===S$a.length&&delete S$B._groupResourcesMap[this.url]))},S$m.completeCreate=function(){this._released=!1,this.event("recovered",this)},S$m.dispose=function(){this.destroy()},S$q(0,S$m,"memorySize",function(){return this._memorySize},function(S$a){var S$m=S$a-this._memorySize;this._memorySize=S$a,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,S$m),this.resourceManager&&this.resourceManager.addSize(S$m)}),S$q(0,S$m,"_loaded",null,function(S$a){this.__loaded=S$a}),S$q(0,S$m,"loaded",function(){return this.__loaded}),S$q(0,S$m,"id",function(){return this._$1__id}),S$q(0,S$m,"destroyed",function(){return this._destroyed}),S$q(0,S$m,"group",function(){return this._getGroup()},function(S$a){this._setGroup(S$a)}),S$q(0,S$m,"resourceManager",function(){return this._resourceManager}),S$q(0,S$m,"url",function(){return this._url}),S$q(0,S$m,"released",function(){return this._released}),S$q(0,S$m,"referenceCount",function(){return this._referenceCount}),S$B.getResourceByID=function(S$a){return S$B._idResourcesMap[S$a]},S$B.getResourceByURL=function(S$a,S$m){return void 0===S$m&&(S$m=0),null==S$B._urlResourcesMap[S$a]?null:S$B._urlResourcesMap[S$a][S$m]},S$B.getResourceCountByURL=function(S$a){return S$B._urlResourcesMap[S$a].length},S$B.destroyUnusedResources=function(S$a){var S$m;if(S$a){var S$s=S$B._groupResourcesMap[S$a];if(S$s)for(var S$P=S$s.slice(),S$_=0,S$e=S$P.length;S$_<S$e;S$_++)(S$m=S$P[S$_]).lock||0!==S$m._referenceCount||S$m.destroy()}else for(var S$A in S$B._idResourcesMap)(S$m=S$B._idResourcesMap[S$A]).lock||0!==S$m._referenceCount||S$m.destroy()},S$B._uniqueIDCounter=0,S$B._idResourcesMap={},S$B._urlResourcesMap={},S$B._groupResourcesMap={},S$B}()),S$Ga=function(S$a){function S$C(S$a,S$m){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,S$C.__super.call(this),S$a&&null!=S$a._addReference&&S$a._addReference(),this.setTo(S$a,S$m)}S$G(S$C,"laya.resource.Texture",S$j);var S$m=S$C.prototype;return S$m._setUrl=function(S$a){this.url=S$a},S$m.setTo=function(S$a,S$m){if(S$a instanceof S$A.HTMLElement){var S$s=S$ca.create("2D",S$a);this.bitmap=S$s}else this.bitmap=S$a;if(this.uv=S$m||S$C.DEF_UV,S$a){this._w=S$a.width,this._h=S$a.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var S$P=this;if(this._loaded)S$V.addToAtlas&&S$V.addToAtlas(S$P);else{var S$_=S$a;S$_ instanceof laya.resource.HTMLImage&&S$_.image&&S$_.image.addEventListener("load",function(S$a){S$V.addToAtlas&&S$V.addToAtlas(S$P)},!1)}}},S$m.active=function(){this.bitmap&&this.bitmap.activeResource()},S$m.destroy=function(S$a){if(void 0===S$a&&(S$a=!1),this.alphaTexture&&(this.alphaTexture.destroy(S$a),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var S$m=this.bitmap;S$a?(S$Z.isConchApp&&S$m.source&&S$m.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,S$m.dispose(),S$m._clearReference()):(S$m._removeReference(),0==S$m.referenceCount&&(S$Z.isConchApp&&S$m.source&&S$m.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,S$m.dispose())),this.url&&this===S$z.loader.getRes(this.url)&&S$z.loader.clearRes(this.url,S$a),this._loaded=!1}},S$m.load=function(S$a){var S$m=this;this._loaded=!1,S$a=S$S.customFormat(S$a);var S$s=this.bitmap||(this.bitmap=S$Na.create(S$a));S$s.uri=S$a,S$s&&S$s._addReference();var S$P=this;S$s.onload=function(){S$s.onload=null,S$P._loaded=!0,S$m.sourceWidth=S$m._w=S$s.width,S$m.sourceHeight=S$m._h=S$s.height,S$P.event("loaded",this),S$V.addToAtlas&&S$V.addToAtlas(S$P)}},S$m.addTextureToAtlas=function(S$a){S$V.addTextureToAtlas(this)},S$m.getPixels=function(S$a,S$m,S$s,S$P){if(S$Z.isConchApp){var S$_=this.bitmap;if(S$_.source&&S$_.source.getImageData){var S$e=S$_.source.getImageData(S$a,S$m,S$s,S$P),S$A=new Uint8Array(S$e);return Array.from(S$A)}return null}return S$Z.isWebGL?S$V.getTexturePixels(this,S$a,S$m,S$s,S$P):(S$L.canvas.size(S$s,S$P),S$L.canvas.clear(),S$L.context.drawTexture(this,-S$a,-S$m,this.width,this.height,0,0),S$L.context.getImageData(0,0,S$s,S$P).data)},S$m.onAsynLoaded=function(S$a,S$m){if(S$m){if("function"!=typeof S$m._addReference)throw new Error("bitmap._addReference is not a function. "+S$m.className+" "+typeof S$m._addReference+" "+S$m.constructor);S$m._addReference()}this.setTo(S$m,this.uv),this._loaded&&this.event("loaded",this)},S$q(0,S$m,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),S$q(0,S$m,"loaded",function(){return this._loaded}),S$q(0,S$m,"released",function(){return!this.bitmap||this.bitmap.released}),S$q(0,S$m,"width",function(){return this._w?this._w:this.uv&&this.uv!==S$C.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(S$a){this._w=S$a,this.sourceWidth||(this.sourceWidth=S$a)}),S$q(0,S$m,"repeat",function(){return!S$Z.isWebGL||!this.bitmap||this.bitmap.repeat},function(S$a){S$a&&S$Z.isWebGL&&this.bitmap&&(this.bitmap.repeat=S$a)&&(this.bitmap.enableMerageInAtlas=!1)}),S$q(0,S$m,"height",function(){return this._h?this._h:this.uv&&this.uv!==S$C.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(S$a){this._h=S$a,this.sourceHeight||(this.sourceHeight=S$a)}),S$q(0,S$m,"isLinearSampling",function(){return!S$Z.isWebGL||9728!=this.bitmap.minFifter},function(S$a){!S$a&&S$Z.isWebGL&&(S$a||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),S$C.moveUV=function(S$a,S$m,S$s){for(var S$P=0;S$P<8;S$P+=2)S$s[S$P]+=S$a,S$s[S$P+1]+=S$m;return S$s},S$C.create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){void 0===S$e&&(S$e=0),void 0===S$A&&(S$A=0),void 0===S$B&&(S$B=0),void 0===S$k&&(S$k=0);var S$j=S$a instanceof laya.resource.Texture,S$G=S$j?S$a.uv:S$C.DEF_UV,S$y=S$j?S$a.bitmap:S$a,S$d=S$V.isAtlas(S$y);if(S$d){var S$Q=S$y._atlaser,S$q=S$a._atlasID;if(-1==S$q)throw new Error("create texture error");S$y=S$Q._inAtlasTextureBitmapValue[S$q],S$G=S$Q._inAtlasTextureOriUVValue[S$q]}var S$h=new S$C(S$y,null);S$y.width&&S$m+S$P>S$y.width&&(S$P=S$y.width-S$m),S$y.height&&S$s+S$_>S$y.height&&(S$_=S$y.height-S$s),S$h.width=S$P,S$h.height=S$_,S$h.offsetX=S$e,S$h.offsetY=S$A,S$h.sourceWidth=S$B||S$P,S$h.sourceHeight=S$k||S$_;var S$u=1/S$y.width,S$O=1/S$y.height;S$m*=S$u,S$s*=S$O,S$P*=S$u,S$_*=S$O;var S$p=S$h.uv[0],S$c=S$h.uv[1],S$H=S$h.uv[4],S$o=S$h.uv[5],S$N=S$H-S$p,S$z=S$o-S$c,S$U=S$C.moveUV(S$G[0],S$G[1],[S$m,S$s,S$m+S$P,S$s,S$m+S$P,S$s+S$_,S$m,S$s+S$_]);S$h.uv=[S$p+S$U[0]*S$N,S$c+S$U[1]*S$z,S$H-(1-S$U[2])*S$N,S$c+S$U[3]*S$z,S$H-(1-S$U[4])*S$N,S$o-(1-S$U[5])*S$z,S$p+S$U[6]*S$N,S$o-(1-S$U[7])*S$z],S$d&&S$h.addTextureToAtlas();var S$l=S$y.scaleRate;return S$l&&1!=S$l?(S$h.sourceWidth/=S$l,S$h.sourceHeight/=S$l,S$h.width/=S$l,S$h.height/=S$l,S$h.scaleRate=S$l,S$h.offsetX/=S$l,S$h.offsetY/=S$l):S$h.scaleRate=1,S$h},S$C.createFromTexture=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$a.scaleRate;1!=S$e&&(S$m*=S$e,S$s*=S$e,S$P*=S$e,S$_*=S$e);var S$A=S$l.TEMP.setTo(S$m-S$a.offsetX,S$s-S$a.offsetY,S$P,S$_),S$B=S$A.intersection(S$C._rect1.setTo(0,0,S$a.width,S$a.height),S$C._rect2);if(!S$B)return null;var S$k=S$C.create(S$a,S$B.x,S$B.y,S$B.width,S$B.height,S$B.x-S$A.x,S$B.y-S$A.y,S$P,S$_);if(S$k.bitmap&&S$k.bitmap._removeReference)return S$k.bitmap._removeReference(),S$k;var S$j="bitmap:"+(S$k.bitmap?S$k.bitmap.constructor?S$k.bitmap.constructor.name:S$k.bitmap.__className:"")+", url:"+(S$a.url+" | "+(S$k.bitmap?S$k.bitmap.url:S$a.url))+", x="+S$m+",y="+S$s+",width="+S$P+",height="+S$_+", result="+(S$B?S$B.x+","+S$B.y+","+S$B.width+","+S$B.height:"null")+", rect="+S$A.x+","+S$A.y+","+S$A.width+","+S$A.height;throw new Error("报错：bitmap._removeReference is not a function  "+S$j)},S$C.DEF_UV=[0,0,1,0,1,1,0,1],S$C.INV_UV=[0,1,1,1,1,0,0,0],S$C._rect1=new S$l,S$C._rect2=new S$l,S$C}(),S$a=function(S$a){var S$B;function S$e(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,S$e.__super.call(this)}S$G(S$e,"laya.utils.TimeLine",S$j);var S$m=S$e.prototype;return S$m.to=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$_&&(S$_=0),this._create(S$a,S$m,S$s,S$P,S$_,!0)},S$m.from=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$_&&(S$_=0),this._create(S$a,S$m,S$s,S$P,S$_,!1)},S$m._create=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$w.getItemByClass("tweenData",S$B);return S$A.isTo=S$e,S$A.type=0,S$A.target=S$a,S$A.duration=S$s,S$A.data=S$m,S$A.startTime=this._startTime+S$_,S$A.endTime=S$A.startTime+S$A.duration,S$A.ease=S$P,this._startTime=Math.max(S$A.endTime,this._startTime),this._tweenDataList.push(S$A),this._startTimeSort=!0,this._endTimeSort=!0,this},S$m.addLabel=function(S$a,S$m){var S$s=S$w.getItemByClass("tweenData",S$B);return S$s.type=1,S$s.data=S$a,S$s.endTime=S$s.startTime=this._startTime+S$m,this._labelDic||(this._labelDic={}),this._labelDic[S$a]=S$s,this._tweenDataList.push(S$s),this},S$m.removeLabel=function(S$a){if(this._labelDic&&this._labelDic[S$a]){var S$m=this._labelDic[S$a];if(S$m){var S$s=this._tweenDataList.indexOf(S$m);-1<S$s&&this._tweenDataList.splice(S$s,1)}delete this._labelDic[S$a]}},S$m.gotoTime=function(S$a){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var S$m,S$s,S$P,S$_;for(var S$e in this._firstTweenDic)if(S$s=this._firstTweenDic[S$e])for(var S$A in S$s)S$s.diyTarget.hasOwnProperty(S$A)&&(S$s.diyTarget[S$A]=S$s[S$A]);for(S$e in this._tweenDic)(S$m=this._tweenDic[S$e]).clear(),delete this._tweenDic[S$e];if(this._index=0,this._gidIndex=0,this._currTime=S$a,this._lastTime=S$L.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=S$P=this._tweenDataList.concat(),S$P.sort(function(S$a,S$m){return S$a.endTime>S$m.endTime?1:S$a.endTime<S$m.endTime?-1:0})}else S$P=this._endTweenDataList;for(var S$B=0,S$k=S$P.length;S$B<S$k;S$B++)if(0==(S$_=S$P[S$B]).type){if(!(S$a>=S$_.endTime))break;this._index=Math.max(this._index,S$B+1);var S$j=S$_.data;if(S$_.isTo)for(var S$G in S$j)S$_.target[S$G]=S$j[S$G]}for(S$B=0,S$k=this._tweenDataList.length;S$B<S$k;S$B++)0==(S$_=this._tweenDataList[S$B]).type&&S$a>=S$_.startTime&&S$a<S$_.endTime&&(this._index=Math.max(this._index,S$B+1),this._gidIndex++,(S$m=S$w.getItemByClass("tween",S$T))._create(S$_.target,S$_.data,S$_.duration,S$_.ease,S$p.create(this,this._animComplete,[this._gidIndex]),0,!1,S$_.isTo,!0,!1),S$m.setStartTime(this._currTime-(S$a-S$_.startTime)),S$m._updateEase(this._currTime),S$m.gid=this._gidIndex,this._tweenDic[this._gidIndex]=S$m)}},S$m.gotoLabel=function(S$a){if(null!=this._labelDic){var S$m=this._labelDic[S$a];S$m&&this.gotoTime(S$m.startTime)}},S$m.pause=function(){S$z.timer.clear(this,this._update)},S$m.resume=function(){this.play(this._currTime,this._loopKey)},S$m.play=function(S$a,S$m){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(S$a,S$m){return S$a.startTime>S$m.startTime?1:S$a.startTime<S$m.startTime?-1:0});for(var S$s=0,S$P=this._tweenDataList.length;S$s<S$P;S$s++){var S$_=this._tweenDataList[S$s];if(null!=S$_&&0==S$_.type){var S$e=S$_.target,S$A=S$e.$_GID||(S$e.$_GID=S$I.getGID()),S$B=null;for(var S$k in null==this._firstTweenDic[S$A]?((S$B={}).diyTarget=S$e,this._firstTweenDic[S$A]=S$B):S$B=this._firstTweenDic[S$A],S$_.data)null==S$B[S$k]&&(S$B[S$k]=S$e[S$k])}}}"string"==typeof S$a?this.gotoLabel(S$a):this.gotoTime(S$a),this._loopKey=S$m,this._lastTime=S$L.now(),S$z.timer.frameLoop(1,this,this._update)}},S$m._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var S$a in this._tweenDic)(S$m=this._tweenDic[S$a]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var S$m,S$s=S$L.now(),S$P=S$s-this._lastTime,S$_=this._currTime+=S$P*this.scale;for(S$a in this._lastTime=S$s,this._tweenDic)(S$m=this._tweenDic[S$a])._updateEase(S$_);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var S$e=this._tweenDataList[this._index];S$_>=S$e.startTime&&(this._index++,0==S$e.type?(this._gidIndex++,(S$m=S$w.getItemByClass("tween",S$T))._create(S$e.target,S$e.data,S$e.duration,S$e.ease,S$p.create(this,this._animComplete,[this._gidIndex]),0,!1,S$e.isTo,!0,!1),S$m.setStartTime(S$_),S$m.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=S$m)._updateEase(S$_)):this.event("label",S$e.data))}},S$m._animComplete=function(S$a){this._tweenDic[S$a]&&delete this._tweenDic[S$a]},S$m._complete=function(){this.event("complete")},S$m.reset=function(){var S$a;if(this._labelDic)for(S$a in this._labelDic)delete this._labelDic[S$a];for(S$a in this._tweenDic)this._tweenDic[S$a].clear(),delete this._tweenDic[S$a];for(S$a in this._firstTweenDic)delete this._firstTweenDic[S$a];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var S$m,S$s=0;for(S$m=this._tweenDataList.length,S$s=0;S$s<S$m;S$s++)this._tweenDataList[S$s]&&this._tweenDataList[S$s].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,S$z.timer.clear(this,this._update)},S$m.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},S$q(0,S$m,"index",function(){return this._frameIndex},function(S$a){this._frameIndex=S$a,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),S$q(0,S$m,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),S$e.to=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$_&&(S$_=0),(new S$e).to(S$a,S$m,S$s,S$P,S$_)},S$e.from=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$_&&(S$_=0),(new S$e).from(S$a,S$m,S$s,S$P,S$_)},S$e.__init$=function(){S$B=function(){function S$a(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return S$G(S$a,""),S$a.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,S$w.recover("tweenData",this)},S$a}()},S$e}(),S$ya=function(S$_){function S$s(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,S$s.__super.call(this),this._style=S$B.EMPTY}S$G(S$s,"laya.display.Sprite",S$_);var S$a=S$s.prototype;return S$z.imps(S$a,{"laya.display.ILayout":!0}),S$a.createConchModel=function(){return new ConchNode},S$a.destroy=function(S$a){if(void 0===S$a&&(S$a=!0),this._releaseMem(),!this._destroyed){this.filters=null;var S$m=this.mask;S$m&&(this.mask=null,S$m.destroy(S$a))}S$_.prototype.destroy.call(this,S$a),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},S$a.updateZOrder=function(){S$I.updateOrder(this._childs)&&this.repaint()},S$a.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},S$a.setBounds=function(S$a){this._set$P("uBounds",S$a)},S$a.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new S$l),S$l._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},S$a.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new S$l),S$l._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},S$a._boundPointsToParent=function(S$a){void 0===S$a&&(S$a=!1);var S$m=0,S$s=0;this._style&&(S$m=this._style._tf.translateX,S$s=this._style._tf.translateY,S$a=S$a||0!==this._style._tf.rotate,this._style.scrollRect&&(S$m+=this._style.scrollRect.x,S$s+=this._style.scrollRect.y));var S$P=this._getBoundPointsM(S$a);if(!S$P||S$P.length<1)return S$P;if(8!=S$P.length&&(S$P=S$a?S$o.scanPList(S$P):S$l._getWrapRec(S$P,S$l.TEMP)._getBoundPoints()),!this.transform)return S$I.transPointList(S$P,this._x-S$m,this._y-S$s),S$P;var S$_=S$U.TEMP,S$e=0,S$A=S$P.length;for(S$e=0;S$e<S$A;S$e+=2)S$_.x=S$P[S$e],S$_.y=S$P[S$e+1],this.toParentPoint(S$_),S$P[S$e]=S$_.x,S$P[S$e+1]=S$_.y;return S$P},S$a.getGraphicBounds=function(S$a){return void 0===S$a&&(S$a=!1),this._graphics?this._graphics.getBounds(S$a):S$l.TEMP.setTo(0,0,0,0)},S$a._getBoundPointsM=function(S$a){if(void 0===S$a&&(S$a=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var S$m=S$I.clearArray(this._$P.temBM),S$s=S$l.TEMP;return S$s.copyFrom(this.scrollRect),S$I.concatArray(S$m,S$s._getBoundPoints()),S$m}for(var S$P,S$_,S$e,S$A=this._graphics?this._graphics.getBoundPoints():S$I.clearArray(this._$P.temBM),S$B=0,S$k=(S$e=this._childs).length;S$B<S$k;S$B++)(S$P=S$e[S$B])instanceof laya.display.Sprite&&1==S$P.visible&&(S$_=S$P._boundPointsToParent(S$a))&&(S$A=S$A?S$I.concatArray(S$A,S$_):S$_);return S$A},S$a.getStyle=function(){return this._style===S$B.EMPTY&&(this._style=new S$B),this._style},S$a.setStyle=function(S$a){this._style=S$a},S$a._adjustTransform=function(){this._tfChanged=!1;var S$a,S$m=this._style._tf,S$s=S$m.scaleX,S$P=S$m.scaleY;if(S$m.rotate||1!==S$s||1!==S$P||S$m.skewX||S$m.skewY){(S$a=this._transform||(this._transform=S$W.create())).bTransform=!0;var S$_=.0174532922222222*(S$m.rotate-S$m.skewX),S$e=.0174532922222222*(S$m.rotate+S$m.skewY),S$A=Math.cos(S$e),S$B=Math.sin(S$e),S$k=Math.sin(S$_),S$j=Math.cos(S$_);return S$a.a=S$s*S$A,S$a.b=S$s*S$B,S$a.c=-S$P*S$k,S$a.d=S$P*S$j,S$a.tx=S$a.ty=0,S$a}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,S$a},S$a.pos=function(S$a,S$m,S$s){if(void 0===S$s&&(S$s=!1),this._x!==S$a||this._y!==S$m){if(this.destroyed)return this;if(S$s){this._x=S$a,this._y=S$m,this.conchModel&&this.conchModel.pos(this._x,this._y);var S$P=this._parent;S$P&&0===S$P._repaint&&(S$P._repaint=1,S$P.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=S$a,this.y=S$m}return this},S$a.pivot=function(S$a,S$m){return this.pivotX=S$a,this.pivotY=S$m,this},S$a.size=function(S$a,S$m){return this.width=S$a,this.height=S$m,this},S$a.scale=function(S$a,S$m,S$s){void 0===S$s&&(S$s=!1);var S$P=this.getStyle(),S$_=S$P._tf;if(S$_.scaleX!=S$a||S$_.scaleY!=S$m){if(this.destroyed)return this;if(S$s){S$P.setScale(S$a,S$m),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(S$a,S$m),this._renderType|=4;var S$e=this._parent;S$e&&0===S$e._repaint&&(S$e._repaint=1,S$e.parentRepaint())}else this.scaleX=S$a,this.scaleY=S$m}return this},S$a.skew=function(S$a,S$m){return this.skewX=S$a,this.skewY=S$m,this},S$a.render=function(S$a,S$m,S$s){S$v.spriteCount++,S$E.renders[this._renderType]._fun(this,S$a,S$m+this._x,S$s+this._y),this._repaint=0},S$a.drawToCanvas=function(S$a,S$m,S$s,S$P){if(S$Z.isConchNode){var S$_=S$ca.create("2D");return new S$X(S$a,S$m,S$_).ctx.setCanvasType(1),this.conchModel.drawToCanvas(S$_.source,S$s,S$P),S$_}return S$V.drawToCanvas(this,this._renderType,S$a,S$m,S$s,S$P)},S$a.customRender=function(S$a,S$m,S$s){this._renderType|=1024},S$a._applyFilters=function(){var S$a;if(!S$Z.isWebGL&&((S$a=this._$P.filters)&&!(S$a.length<1)))for(var S$m=0,S$s=S$a.length;S$m<S$s;S$m++)S$a[S$m].action.apply(this._$P.cacheCanvas)},S$a._isHaveGlowFilter=function(){var S$a,S$m=0;if(this.filters)for(S$m=0;S$m<this.filters.length;S$m++)if(8==this.filters[S$m].type)return!0;for(S$m=0,S$a=this._childs.length;S$m<S$a;S$m++)if(this._childs[S$m]._isHaveGlowFilter())return!0;return!1},S$a.localToGlobal=function(S$a,S$m){void 0===S$m&&(S$m=!1),!0===S$m&&(S$a=new S$U(S$a.x,S$a.y));for(var S$s=this;S$s&&S$s!=S$z.stage;)S$a=S$s.toParentPoint(S$a),S$s=S$s.parent;return S$a},S$a.globalToLocal=function(S$a,S$m){void 0===S$m&&(S$m=!1),S$m&&(S$a=new S$U(S$a.x,S$a.y));for(var S$s=this,S$P=[];S$s&&S$s!=S$z.stage;)S$P.push(S$s),S$s=S$s.parent;for(var S$_=S$P.length-1;0<=S$_;)S$a=(S$s=S$P[S$_]).fromParentPoint(S$a),S$_--;return S$a},S$a.toParentPoint=function(S$a){if(!S$a)return S$a;S$a.x-=this.pivotX,S$a.y-=this.pivotY,this.transform&&this._transform.transformPoint(S$a),S$a.x+=this._x,S$a.y+=this._y;var S$m=this._style.scrollRect;return S$m&&(S$a.x-=S$m.x,S$a.y-=S$m.y),S$a},S$a.fromParentPoint=function(S$a){if(!S$a)return S$a;S$a.x-=this._x,S$a.y-=this._y;var S$m=this._style.scrollRect;return S$m&&(S$a.x+=S$m.x,S$a.y+=S$m.y),this.transform&&this._transform.invertTransformPoint(S$a),S$a.x+=this.pivotX,S$a.y+=this.pivotY,S$a},S$a.on=function(S$a,S$m,S$s,S$P){return 1!==this._mouseEnableState&&this.isMouseEvent(S$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(S$a,S$m,S$s,S$P,!1)):S$_.prototype.on.call(this,S$a,S$m,S$s,S$P)},S$a.once=function(S$a,S$m,S$s,S$P){return 1!==this._mouseEnableState&&this.isMouseEvent(S$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(S$a,S$m,S$s,S$P,!0)):S$_.prototype.once.call(this,S$a,S$m,S$s,S$P)},S$a._$2__onDisplay=function(){if(1!==this._mouseEnableState){var S$a=this;for(S$a=S$a.parent;S$a&&1!==S$a._mouseEnableState&&!S$a._getBit(2);)S$a.mouseEnabled=!0,S$a._setBit(2,!0),S$a=S$a.parent}},S$a.loadImage=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=this;return void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),this.graphics.loadImage(S$a,S$m,S$s,S$P,S$_,function(S$a){S$A.destroyed||(S$A.size(S$m+(S$P||S$a.width),S$s+(S$_||S$a.height)),S$A.repaint(),S$e&&S$e.runWith(S$a))}),this},S$a.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},S$a._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},S$a._childChanged=function(S$a){this._childs.length?this._renderType|=2048:this._renderType&=-2049,S$a&&this._get$P("hasZorder")&&S$z.timer.callLater(this,this.updateZOrder),this.repaint()},S$a.parentRepaint=function(){var S$a=this._parent;S$a&&0===S$a._repaint&&(S$a._repaint=1,S$a.parentRepaint())},S$a.startDrag=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){void 0===S$m&&(S$m=!1),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=300),void 0===S$e&&(S$e=!1),void 0===S$A&&(S$A=.92),this._$P.dragging||this._set$P("dragging",new S$J),this._$P.dragging.start(this,S$a,S$m,S$s,S$P,S$_,S$e,S$A)},S$a.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},S$a._releaseMem=function(){if(this._$P){var S$a=this._$P.cacheCanvas;S$a&&S$a.ctx&&(S$w.recover("RenderContext",S$a.ctx),S$a.ctx.canvas.size(0,0),S$a.ctx=null);var S$m=this._$P._filterCache;S$m&&(S$m.destroy(),S$m.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},S$a._setDisplay=function(S$a){S$a||this._releaseMem(),S$_.prototype._setDisplay.call(this,S$a)},S$a.hitTestPoint=function(S$a,S$m){var S$s=this.globalToLocal(S$U.TEMP.setTo(S$a,S$m));return S$a=S$s.x,S$m=S$s.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?S$l.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(S$a,S$m)},S$a.getMousePoint=function(){return this.globalToLocal(S$U.TEMP.setTo(S$z.stage.mouseX,S$z.stage.mouseY))},S$a._getWords=function(){return null},S$a._addChildsToLayout=function(S$a){var S$m=this._getWords();if(null==S$m&&0==this._childs.length)return!1;if(S$m)for(var S$s=0,S$P=S$m.length;S$s<S$P;S$s++)S$a.push(S$m[S$s]);S$s=0;for(var S$_=this._childs.length;S$s<S$_;++S$s){var S$e=this._childs[S$s];S$e._style._enableLayout()&&S$e._addToLayout(S$a)}return!0},S$a._addToLayout=function(S$a){this._style.absolute||(this._style.block?S$a.push(this):this._addChildsToLayout(S$a)&&(this.x=this.y=0))},S$a._isChar=function(){return!1},S$a._getCSSStyle=function(){return this._style.getCSSStyle()},S$a._setAttributes=function(S$a,S$m){switch(S$a){case"x":this.x=parseFloat(S$m);break;case"y":this.y=parseFloat(S$m);break;case"width":this.width=parseFloat(S$m);break;case"height":this.height=parseFloat(S$m);break;default:this[S$a]=S$m}},S$a._layoutLater=function(){this.parent&&this.parent._layoutLater()},S$q(0,S$a,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(S$a){this._optimizeScrollRect!=S$a&&(this._optimizeScrollRect=S$a,this.conchModel&&this.conchModel.optimizeScrollRect(S$a))}),S$q(0,S$a,"customRenderEnable",null,function(S$a){if(S$a&&(this._renderType|=1024,S$Z.isConchNode)){S$s.CustomList.push(this);var S$m=new S$ca("2d");S$m._setContext(new CanvasRenderingContext2D),this.customContext=new S$X(0,0,S$m),S$m.context.setCanvasType&&S$m.context.setCanvasType(2),this.conchModel.custom(S$m.context)}}),S$q(0,S$a,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(S$a){this.cacheAs=S$a?this._$P.hasFilter?"none":"normal":"none"}),S$q(0,S$a,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(S$a){var S$m=this._$P.cacheCanvas;if(S$a!==(S$m?S$m.type:"none")){if("none"!==S$a)this._getBit(1)||this._setUpNoticeType(1),S$m||(S$m=this._set$P("cacheCanvas",S$w.getItemByClass("cacheCanvas",Object))),S$m.type=S$a,S$m.reCache=!0,this._renderType|=16,"bitmap"==S$a&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(S$m){var S$s=S$m;S$s&&S$s.ctx&&(S$w.recover("RenderContext",S$s.ctx),S$s.ctx.canvas.size(0,0),S$s.ctx=null),S$w.recover("cacheCanvas",S$m)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),S$q(0,S$a,"zOrder",function(){return this._zOrder},function(S$a){this._zOrder!=S$a&&(this._zOrder=S$a,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(S$a),this._parent&&(S$a&&this._parent._set$P("hasZorder",!0),S$z.timer.callLater(this._parent,this.updateZOrder)))}),S$q(0,S$a,"rotation",function(){return this._style._tf.rotate},function(S$a){var S$m=this.getStyle();if(S$m._tf.rotate!==S$a){S$m.setRotate(S$a),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(S$a),this._renderType|=4;var S$s=this._parent;S$s&&0===S$s._repaint&&(S$s._repaint=1,S$s.parentRepaint())}}),S$q(0,S$a,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(S$a){this._width!==S$a&&(this._width=S$a,this.conchModel&&this.conchModel.size(S$a,this._height),this.repaint())}),S$q(0,S$a,"x",function(){return this._x},function(S$a){if(this._x!==S$a){if(this.destroyed)return;this._x=S$a,this.conchModel&&this.conchModel.pos(S$a,this._y);var S$m=this._parent;S$m&&0===S$m._repaint&&(S$m._repaint=1,S$m.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),S$q(0,S$a,"globalScaleY",function(){for(var S$a=1,S$m=this;S$m&&S$m!==S$z.stage;)S$a*=S$m.scaleY,S$m=S$m.parent;return S$a}),S$q(0,S$a,"hitArea",function(){return this._$P.hitArea},function(S$a){this._set$P("hitArea",S$a)}),S$q(0,S$a,"staticCache",function(){return this._$P.staticCache},function(S$a){this._set$P("staticCache",S$a),S$a||this.reCache()}),S$q(0,S$a,"texture",function(){return this._texture},function(S$a){this._texture!=S$a&&(this._texture=S$a,this.graphics.cleanByTexture(S$a,0,0))}),S$q(0,S$a,"y",function(){return this._y},function(S$a){if(this._y!==S$a){if(this.destroyed)return;this._y=S$a,this.conchModel&&this.conchModel.pos(this._x,S$a);var S$m=this._parent;S$m&&0===S$m._repaint&&(S$m._repaint=1,S$m.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),S$q(0,S$a,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(S$a){this._height!==S$a&&(this._height=S$a,this.conchModel&&this.conchModel.size(this._width,S$a),this.repaint())}),S$q(0,S$a,"blendMode",function(){return this._style.blendMode},function(S$a){this.getStyle().blendMode=S$a,this.conchModel&&this.conchModel.blendMode(S$a),S$a&&"source-over"!=S$a?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),S$q(0,S$a,"scaleX",function(){return this._style._tf.scaleX},function(S$a){var S$m=this.getStyle();if(S$m._tf.scaleX!==S$a){S$m.setScaleX(S$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(S$a,S$m._tf.scaleY),this._renderType|=4;var S$s=this._parent;S$s&&0===S$s._repaint&&(S$s._repaint=1,S$s.parentRepaint())}}),S$q(0,S$a,"scaleY",function(){return this._style._tf.scaleY},function(S$a){var S$m=this.getStyle();if(S$m._tf.scaleY!==S$a){S$m.setScaleY(S$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(S$m._tf.scaleX,S$a),this._renderType|=4;var S$s=this._parent;S$s&&0===S$s._repaint&&(S$s._repaint=1,S$s.parentRepaint())}}),S$q(0,S$a,"stage",function(){return S$z.stage}),S$q(0,S$a,"skewX",function(){return this._style._tf.skewX},function(S$a){var S$m=this.getStyle();if(S$m._tf.skewX!==S$a){S$m.setSkewX(S$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(S$a,S$m._tf.skewY),this._renderType|=4;var S$s=this._parent;S$s&&0===S$s._repaint&&(S$s._repaint=1,S$s.parentRepaint())}}),S$q(0,S$a,"scrollRect",function(){return this._style.scrollRect},function(S$a){this.getStyle().scrollRect=S$a,this.repaint(),S$a?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(S$a.x,S$a.y,S$a.width,S$a.height)):(this._renderType&=-129,this.conchModel&&(S$s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),S$q(0,S$a,"skewY",function(){return this._style._tf.skewY},function(S$a){var S$m=this.getStyle();if(S$m._tf.skewY!==S$a){S$m.setSkewY(S$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(S$m._tf.skewX,S$a),this._renderType|=4;var S$s=this._parent;S$s&&0===S$s._repaint&&(S$s._repaint=1,S$s.parentRepaint())}}),S$q(0,S$a,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(S$a){this._tfChanged=!1,(this._transform=S$a)&&(this._x=S$a.tx,this._y=S$a.ty,S$a.tx=S$a.ty=0,this.conchModel&&this.conchModel.transform(S$a.a,S$a.b,S$a.c,S$a.d,this._x,this._y)),S$a?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),S$q(0,S$a,"pivotX",function(){return this._style._tf.translateX},function(S$a){this.getStyle().setTranslateX(S$a),this.conchModel&&this.conchModel.pivot(S$a,this._style._tf.translateY),this.repaint()}),S$q(0,S$a,"pivotY",function(){return this._style._tf.translateY},function(S$a){this.getStyle().setTranslateY(S$a),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,S$a),this.repaint()}),S$q(0,S$a,"alpha",function(){return this._style.alpha},function(S$a){this._style&&this._style.alpha!==S$a&&(S$a=S$a<0?0:1<S$a?1:S$a,this.getStyle().alpha=S$a,this.conchModel&&this.conchModel.alpha(S$a),1!==S$a?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),S$q(0,S$a,"visible",function(){return this._style.visible},function(S$a){this._style&&this._style.visible!==S$a&&(this.getStyle().visible=S$a,this.conchModel&&this.conchModel.visible(S$a),this.parentRepaint())}),S$q(0,S$a,"graphics",function(){return this._graphics||(this.graphics=S$V.createGraphics())},function(S$a){this._graphics&&(this._graphics._sp=null),(this._graphics=S$a)?(this._renderType&=-2,this._renderType|=512,(S$a._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(S$s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),S$q(0,S$a,"filters",function(){return this._$P.filters},function(S$a){S$a&&0===S$a.length&&(S$a=null),this._$P.filters!=S$a&&(this._set$P("filters",S$a?S$a.slice():null),S$Z.isConchApp&&(this.conchModel&&(S$s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),S$Z.isWebGL&&(S$a&&S$a.length?this._renderType|=32:this._renderType&=-33),S$a&&0<S$a.length?(this._getBit(1)||this._setUpNoticeType(1),S$Z.isWebGL&&1==S$a.length&&S$a[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(S$Z.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),S$q(0,S$a,"parent",S$_.prototype._$get_parent,function(S$a){S$z.superSet(S$aa,this,"parent",S$a),S$a&&this._getBit(2)&&this._$2__onDisplay()}),S$q(0,S$a,"mask",function(){return this._$P._mask},function(S$a){S$a&&this.mask&&this.mask._$P.maskParent||(S$a?(this.cacheAs="bitmap",this._set$P("_mask",S$a),S$a._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",S$a),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(S$a?S$a.conchModel:null),this._renderType|=64,this.parentRepaint())}),S$q(0,S$a,"mouseEnabled",function(){return 1<this._mouseEnableState},function(S$a){this._mouseEnableState=S$a?2:1}),S$q(0,S$a,"globalScaleX",function(){for(var S$a=1,S$m=this;S$m&&S$m!==S$z.stage;)S$a*=S$m.scaleX,S$m=S$m.parent;return S$a}),S$q(0,S$a,"mouseX",function(){return this.getMousePoint().x}),S$q(0,S$a,"mouseY",function(){return this.getMousePoint().y}),S$s.fromImage=function(S$a){return(new S$s).loadImage(S$a)},S$s._cachePool=[],S$s.CustomList=[],S$k(S$s,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=S$A.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),S$s}(S$aa),S$da=function(S$a){function S$m(S$a){this._audio=null,this._onEnd=null,this._resumePlay=null,S$m.__super.call(this),this._onEnd=S$I.bind(this.__onEnd,this),this._resumePlay=S$I.bind(this.__resumePlay,this),S$a.addEventListener("ended",this._onEnd),this._audio=S$a}S$G(S$m,"laya.media.h5audio.AudioSoundChannel",S$Pa);var S$s=S$m.prototype;return S$s.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(S$z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},S$s.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,S$L.container.appendChild(this._audio),this._audio.play()}catch(S$a){this.event("error")}},S$s.play=function(S$a){this.isStopped=!1;try{this._audio.playbackRate=S$K.playbackRate,this._audio.currentTime=this.startTime}catch(S$a){return void this._audio.addEventListener("canplay",this._resumePlay)}S$K.addChannel(this),S$L.container.appendChild(this._audio),!S$a&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},S$s.stop=function(){this.isStopped=!0,S$K.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&S$Z.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),S$L.onIE||this._audio!=S$sa._musicAudio&&S$w.recover("audio:"+this.url,this._audio),S$L.removeElement(this._audio),this._audio=null)},S$s.pause=function(){this.isStopped=!0,S$K.removeChannel(this),"pause"in this._audio&&this._audio.pause()},S$s.resume=function(){this._audio&&(this.isStopped=!1,S$K.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},S$q(0,S$s,"position",function(){return this._audio?this._audio.currentTime:0}),S$q(0,S$s,"duration",function(){return this._audio?this._audio.duration:0}),S$q(0,S$s,"volume",function(){return this._audio?this._audio.volume:1},function(S$a){this._audio&&(this._audio.volume=S$a)}),S$m}(),S$Qa=function(S$a){function S$m(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=S$ea.ctx,S$m.__super.call(this),this._onPlayEnd=S$I.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}S$G(S$m,"laya.media.webaudio.WebAudioSoundChannel",S$Pa);var S$s=S$m.prototype;return S$s.play=function(S$a){if(S$K.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var S$m=this.context,S$s=this.gain,S$P=S$m.createBufferSource();(this.bufferSource=S$P).buffer=this.audioBuffer,S$P.connect(S$s),S$s&&S$s.disconnect(),S$s.connect(S$m.destination),S$P.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=S$L.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(S$P.loop=!0),S$P.playbackRate.setTargetAtTime?S$P.playbackRate.setTargetAtTime(S$K.playbackRate,this.context.currentTime,.1):S$P.playbackRate.value=S$K.playbackRate,S$P.start(0,this.startTime),!S$a&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},S$s.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(S$z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},S$s._clearBufferSource=function(){if(this.bufferSource){var S$a=this.bufferSource;S$a.stop?S$a.stop(0):S$a.noteOff(0),S$a.disconnect(0),S$a.onended=null,S$m._tryCleanFailed||this._tryClearBuffer(S$a),this.bufferSource=null}},S$s._tryClearBuffer=function(S$a){try{S$a.buffer=null}catch(S$a){S$m._tryCleanFailed=!0}},S$s.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,S$K.removeChannel(this),this.startHandler=null,this.completeHandler=null},S$s.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,S$K.removeChannel(this)},S$s.resume=function(){this.startTime=this._pauseTime,this.play(!1)},S$q(0,S$s,"position",function(){return this.bufferSource?(S$L.now()-this._startTime)/1e3+this.startTime:0}),S$q(0,S$s,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),S$q(0,S$s,"volume",function(){return this._volume},function(S$a){this.isStopped||(this._volume=S$a,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(S$a,this.context.currentTime,.1):this.gain.gain.value=S$a)}),S$m._tryCleanFailed=!1,S$m}(),S$qa=function(S$a){function S$m(){S$m.__super.call(this),this._w=0,this._h=0}S$G(S$m,"laya.resource.Bitmap",S$ja);var S$s=S$m.prototype;return S$q(0,S$s,"width",function(){return this._w}),S$q(0,S$s,"height",function(){return this._h}),S$q(0,S$s,"source",function(){return this._source}),S$m}(),S$ha=function(S$m){function S$a(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,S$a.__super.call(this),this._interval=S$P.animationInterval,this._setUpNoticeType(1)}S$G(S$a,"laya.display.AnimationPlayerBase",S$m);var S$s=S$a.prototype;return S$s.play=function(S$a,S$m,S$s,S$P){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=!0),void 0===S$s&&(S$s=""),void 0===S$P&&(S$P=!0),this._isPlaying=!0,this.index="string"==typeof S$a?this._getFrameByLabel(S$a):S$a,this.loop=S$m,this._actionName=S$s,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},S$s._getFrameByLabel=function(S$a){var S$m=0;for(S$m=0;S$m<this._count;S$m++)if(this._labels[S$m]&&0<=this._labels[S$m].indexOf(S$a))return S$m;return 0},S$s._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},S$s._setControlNode=function(S$a){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=S$a)&&S$a!=this&&(S$a.on("display",this,this._checkResumePlaying),S$a.on("undisplay",this,this._checkResumePlaying))},S$s._setDisplay=function(S$a){S$m.prototype._setDisplay.call(this,S$a),this._checkResumePlaying()},S$s._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},S$s.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},S$s.addLabel=function(S$a,S$m){this._labels||(this._labels={}),this._labels[S$m]||(this._labels[S$m]=[]),this._labels[S$m].push(S$a)},S$s.removeLabel=function(S$a){if(S$a){if(this._labels)for(var S$m in this._labels)this._removeLabelFromLabelList(this._labels[S$m],S$a)}else this._labels=null},S$s._removeLabelFromLabelList=function(S$a,S$m){if(S$a)for(var S$s=S$a.length-1;0<=S$s;S$s--)S$a[S$s]==S$m&&S$a.splice(S$s,1)},S$s.gotoAndStop=function(S$a){this.index="string"==typeof S$a?this._getFrameByLabel(S$a):S$a,this.stop()},S$s._displayToIndex=function(S$a){},S$s.clear=function(){this.stop(),this._labels=null},S$q(0,S$s,"interval",function(){return this._interval},function(S$a){this._interval!=S$a&&(this._frameRateChanged=!0,this._interval=S$a,this._isPlaying&&0<S$a&&this.timerLoop(S$a,this,this._frameLoop,null,!0,!0))}),S$q(0,S$s,"isPlaying",function(){return this._isPlaying}),S$q(0,S$s,"index",function(){return this._index},function(S$a){if(this._index=S$a,this._displayToIndex(S$a),this._labels&&this._labels[S$a])for(var S$m=this._labels[S$a],S$s=0,S$P=S$m.length;S$s<S$P;S$s++)this.event("label",S$m[S$s])}),S$q(0,S$s,"count",function(){return this._count}),S$a.WRAP_POSITIVE=0,S$a.WRAP_REVERSE=1,S$a.WRAP_PINGPONG=2,S$a}(S$ya),S$ua=function(S$m){function S$Q(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,S$Q.__super.call(this),this.overflow=S$Q.VISIBLE,this._style=new S$ma(this),this._style.wordWrap=!1}S$G(S$Q,"laya.display.Text",S$m);var S$a=S$Q.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._lines=null,this._words&&(this._words.length=0,this._words=null)},S$a._getBoundPointsM=function(S$a){void 0===S$a&&(S$a=!1);var S$m=S$l.TEMP;return S$m.setTo(0,0,this.width,this.height),S$m._getBoundPoints()},S$a.getGraphicBounds=function(S$a){void 0===S$a&&(S$a=!1);var S$m=S$l.TEMP;return S$m.setTo(0,0,this.width,this.height),S$m},S$a._getCSSStyle=function(){return this._style},S$a.lang=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G){if(S$a=S$Q.langPacks&&S$Q.langPacks[S$a]?S$Q.langPacks[S$a]:S$a,arguments.length<2)this._text=S$a;else{for(var S$y=0,S$d=arguments.length;S$y<S$d;S$y++)S$a=S$a.replace("{"+S$y+"}",arguments[S$y+1]);this._text=S$a}},S$a._isPassWordMode=function(){var S$a=this._style.password;return"prompt"in this&&this.prompt==this._text&&(S$a=!1),S$a},S$a._getPassWordTxt=function(S$a){var S$m;S$m="";for(var S$s=S$a.length;0<S$s;S$s--)S$m+="●";return S$m},S$a.renderText=function(S$a,S$m){var S$s=this.graphics;S$s.clear(!0);var S$P=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(S$L.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);S$L.context.font=S$P;var S$_=this.padding,S$e=S$_[3],S$A="left",S$B=this._lines,S$k=this.leading+this._charSize.height,S$j=this._currBitmapFont;S$j&&(S$k=this.leading+S$j.getMaxHeight());var S$G=S$_[0];if(!S$j&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(S$A="right",S$e=this._width-S$_[1]):"center"==this.align&&(S$A="center",S$e=.5*this._width+S$_[3]-S$_[1])),0<this._height){var S$y=this._textHeight>this._height?"top":this.valign;"middle"===S$y?S$G=.5*(this._height-S$m*S$k)+S$_[0]-S$_[2]:"bottom"===S$y&&(S$G=this._height-S$m*S$k-S$_[2])}var S$d=this._style;if(S$j&&S$j.autoScaleSize)var S$Q=S$j.fontSize/this.fontSize;if(this._clipPoint)if(S$s.save(),S$j&&S$j.autoScaleSize){var S$q=0,S$h=0;S$q=this._width?this._width-S$_[3]-S$_[1]:this._textWidth,S$h=this._height?this._height-S$_[0]-S$_[2]:this._textHeight,S$q*=S$Q,S$h*=S$Q,S$s.clipRect(S$_[3],S$_[0],S$q,S$h)}else S$s.clipRect(S$_[3],S$_[0],this._width?this._width-S$_[3]-S$_[1]:this._textWidth,this._height?this._height-S$_[0]-S$_[2]:this._textHeight);var S$u=S$d.password;"prompt"in this&&this.prompt==this._text&&(S$u=!1);for(var S$O=0,S$p=0,S$c=Math.min(this._lines.length,S$m+S$a)||1,S$H=S$a;S$H<S$c;S$H++){var S$o,S$N=S$B[S$H];if(S$u){var S$z=S$N.length;S$N="";for(var S$U=S$z;0<S$U;S$U--)S$N+="●"}if(S$O=S$e-(this._clipPoint?this._clipPoint.x:0),S$p=S$G+S$k*S$H-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(S$A,S$O,S$p,S$H),S$j){var S$l=this.width;S$j.autoScaleSize&&(S$l=this.width*S$Q),S$j.drawText(S$N,this,S$O,S$p,this.align,S$l)}else S$Z.isWebGL?(this._words||(this._words=[]),(S$o=this._words.length>S$H-S$a?this._words[S$H-S$a]:new S$r).setText(S$N)):S$o=S$N,S$d.stroke?S$s.fillBorderText(S$o,S$O,S$p,S$P,this.color,S$d.strokeColor,S$d.stroke,S$A):S$s.fillText(S$o,S$O,S$p,S$P,this.color,S$A)}if(S$j&&S$j.autoScaleSize){var S$C=1/S$Q;this.scale(S$C,S$C)}this._clipPoint&&S$s.restore(),this._startX=S$e,this._startY=S$G},S$a.drawUnderline=function(S$a,S$m,S$s,S$P){var S$_=this._lineWidths[S$P];switch(S$a){case"center":S$m-=S$_/2;break;case"right":S$m-=S$_}S$s+=this._charSize.height,this._graphics.drawLine(S$m,S$s,S$m+S$_,S$s,this.underlineColor||this.color,1)},S$a.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);S$L.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new S$U(0,0)):this._clipPoint=null;var S$a=this._lines.length;if(this.overflow!=S$Q.VISIBLE){var S$m=this.overflow==S$Q.HIDDEN?Math.floor:Math.ceil;S$a=Math.min(S$a,S$m((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var S$s=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(S$s,S$a),this.repaint()},S$a.evalTextSize=function(){var S$a,S$m=NaN;S$a=Math.max.apply(this,this._lineWidths),S$m=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],S$a==this._textWidth&&S$m==this._textHeight||(this._textWidth=S$a,this._textHeight=S$m,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},S$a.checkEnabledViewportOrNot=function(){return this.overflow==S$Q.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},S$a.changeText=function(S$a){this._text!==S$a&&(this.lang(S$a+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},S$a.parseLines=function(S$a){var S$m=this.wordWrap||this.overflow==S$Q.HIDDEN;if(S$m)var S$s=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var S$P=S$I.contextMeasureText(S$Q._testWord);S$Z.isConchApp&&0===S$P.width&&0===S$P.height&&(S$P=S$I.contextMeasureText("W")),this._charSize.width=S$P.width,this._charSize.height=S$P.height||this.fontSize}for(var S$_=S$a.replace(/\r\n/g,"\n").split("\n"),S$e=0,S$A=S$_.length;S$e<S$A;S$e++){var S$B=S$_[S$e];S$m?this.parseLine(S$B,S$s):(this._lineWidths.push(this.getTextWidth(S$B)),this._lines.push(S$B))}},S$a.parseLine=function(S$a,S$m){S$L.context;var S$s,S$P=this._lines,S$_=0,S$e=NaN,S$A=NaN,S$B=0;if((S$e=this.getTextWidth(S$a))<=S$m)return S$P.push(S$a),void this._lineWidths.push(S$e);S$e=this._charSize.width,0==(S$_=Math.floor(S$m/S$e))&&(S$_=1),S$A=S$e=this.getTextWidth(S$a.substring(0,S$_));for(var S$k=S$_,S$j=S$a.length;S$k<S$j;S$k++)if(S$m<(S$A+=S$e=this.getTextWidth(S$a.charAt(S$k))))if(this.wordWrap){var S$G=S$a.substring(S$B,S$k);if(S$G.charCodeAt(S$G.length-1)<255?(S$s=/(?:\w|-)+$/.exec(S$G))&&(S$k=S$s.index+S$B,0==S$s.index?S$k+=S$G.length:S$G=S$a.substring(S$B,S$k)):S$Q.RightToLeft&&(S$s=/([\u0600-\u06FF])+$/.exec(S$G))&&(S$k=S$s.index+S$B,0==S$s.index?S$k+=S$G.length:S$G=S$a.substring(S$B,S$k)),S$P.push(S$G),this._lineWidths.push(S$A-S$e),!((S$B=S$k)+S$_<S$j)){S$P.push(S$a.substring(S$B,S$j)),this._lineWidths.push(this.getTextWidth(S$P[S$P.length-1])),S$B=-1;break}S$k+=S$_,S$A=S$e=this.getTextWidth(S$a.substring(S$B,S$k)),S$k--}else if(this.overflow==S$Q.HIDDEN)return S$P.push(S$a.substring(0,S$k)),void this._lineWidths.push(this.getTextWidth(S$P[S$P.length-1]));this.wordWrap&&-1!=S$B&&(S$P.push(S$a.substring(S$B,S$j)),this._lineWidths.push(this.getTextWidth(S$P[S$P.length-1])))},S$a.getTextWidth=function(S$a){return this._currBitmapFont?this._currBitmapFont.getTextWidth(S$a):S$I.contextMeasureText(S$a).width},S$a.getWordWrapWidth=function(){var S$a=this.padding,S$m=NaN;return(S$m=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(S$m=this.wordWrap?100:S$L.width),S$m<=0&&(S$m=100),S$m-S$a[3]-S$a[1]},S$a.getCharPoint=function(S$a,S$m){this._isChanged&&S$z.timer.runCallLater(this,this.typeset);for(var S$s=0,S$P=this._lines,S$_=0,S$e=0,S$A=S$P.length;S$e<S$A;S$e++){if(S$a<(S$s+=S$P[S$e].length)){var S$B=S$e;break}S$_=S$s}var S$k=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;S$L.context.font=S$k;var S$j=this.getTextWidth(this._text.substring(S$_,S$a));return(S$m||new S$U).setTo(this._startX+S$j-(this._clipPoint?this._clipPoint.x:0),this._startY+S$B*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},S$q(0,S$a,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(S$a){S$a!=this._width&&(S$z.superSet(S$ya,this,"width",S$a),this.isChanged=!0)}),S$q(0,S$a,"textWidth",function(){return this._isChanged&&S$z.timer.runCallLater(this,this.typeset),this._textWidth}),S$q(0,S$a,"height",function(){return this._height?this._height:this.textHeight},function(S$a){S$a!=this._height&&(S$z.superSet(S$ya,this,"height",S$a),this.isChanged=!0)}),S$q(0,S$a,"textHeight",function(){return this._isChanged&&S$z.timer.runCallLater(this,this.typeset),this._textHeight}),S$q(0,S$a,"padding",function(){return this._getCSSStyle().padding},function(S$a){this._getCSSStyle().padding=S$a,this.isChanged=!0}),S$q(0,S$a,"bold",function(){return this._getCSSStyle().bold},function(S$a){this._getCSSStyle().bold=S$a,this.isChanged=!0}),S$q(0,S$a,"text",function(){return this._text||""},function(S$a){this._text!==S$a&&(this.lang(S$a+""),this.isChanged=!0,this.event("change"))}),S$q(0,S$a,"color",function(){return this._getCSSStyle().color},function(S$a){this._getCSSStyle().color!=S$a&&(this._getCSSStyle().color=S$a,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),S$q(0,S$a,"font",function(){return this._getCSSStyle().fontFamily},function(S$a){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),S$Q._bitmapFonts&&S$Q._bitmapFonts[S$a]&&(this._currBitmapFont=S$Q._bitmapFonts[S$a]),this._getCSSStyle().fontFamily=S$a,this.isChanged=!0}),S$q(0,S$a,"fontSize",function(){return this._getCSSStyle().fontSize},function(S$a){this._getCSSStyle().fontSize=S$a,this.isChanged=!0}),S$q(0,S$a,"italic",function(){return this._getCSSStyle().italic},function(S$a){this._getCSSStyle().italic=S$a,this.isChanged=!0}),S$q(0,S$a,"align",function(){return this._getCSSStyle().align},function(S$a){this._getCSSStyle().align=S$a,this.isChanged=!0}),S$q(0,S$a,"valign",function(){return this._getCSSStyle().valign},function(S$a){this._getCSSStyle().valign=S$a,this.isChanged=!0}),S$q(0,S$a,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(S$a){this._getCSSStyle().wordWrap=S$a,this.isChanged=!0}),S$q(0,S$a,"leading",function(){return this._getCSSStyle().leading},function(S$a){this._getCSSStyle().leading=S$a,this.isChanged=!0}),S$q(0,S$a,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(S$a){this._getCSSStyle().backgroundColor=S$a,this.isChanged=!0}),S$q(0,S$a,"borderColor",function(){return this._getCSSStyle().borderColor},function(S$a){this._getCSSStyle().borderColor=S$a,this.isChanged=!0}),S$q(0,S$a,"stroke",function(){return this._getCSSStyle().stroke},function(S$a){this._getCSSStyle().stroke=S$a,this.isChanged=!0}),S$q(0,S$a,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(S$a){this._getCSSStyle().strokeColor=S$a,this.isChanged=!0}),S$q(0,S$a,"isChanged",null,function(S$a){this._isChanged!==S$a&&(this._isChanged=S$a)&&S$z.timer.callLater(this,this.typeset)}),S$q(0,S$a,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(S$a){if(!(this.overflow!=S$Q.SCROLL||this.textWidth<this._width)&&this._clipPoint){S$a=S$a<this.padding[3]?this.padding[3]:S$a;var S$m=this._textWidth-this._width;S$a=S$m<S$a?S$m:S$a;var S$s=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=S$a,this.renderText(this._lastVisibleLineIndex,S$s)}}),S$q(0,S$a,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(S$a){if(!(this.overflow!=S$Q.SCROLL||this.textHeight<this._height)&&this._clipPoint){S$a=S$a<this.padding[0]?this.padding[0]:S$a;var S$m=this._textHeight-this._height,S$s=(S$a=S$m<S$a?S$m:S$a)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=S$s;var S$P=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=S$a,this.renderText(S$s,S$P)}}),S$q(0,S$a,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),S$q(0,S$a,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),S$q(0,S$a,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),S$q(0,S$a,"underlineColor",function(){return this._underlineColor},function(S$a){this._underlineColor=S$a,this._isChanged=!0,this.typeset()}),S$Q.registerBitmapFont=function(S$a,S$m){S$Q._bitmapFonts||(S$Q._bitmapFonts={}),S$Q._bitmapFonts[S$a]=S$m},S$Q.unregisterBitmapFont=function(S$a,S$m){if(void 0===S$m&&(S$m=!0),S$Q._bitmapFonts&&S$Q._bitmapFonts[S$a]){var S$s=S$Q._bitmapFonts[S$a];S$m&&S$s.destroy(),delete S$Q._bitmapFonts[S$a]}},S$Q.setTextRightToLeft=function(){var S$a;(S$a=S$L.canvas.source.style).display="none",S$a.position="absolute",S$a.direction="rtl",S$Z._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,S$L.document.body.appendChild(S$L.canvas.source)},S$Q.supportFont=function(S$a){S$L.context.font="10px sans-serif";var S$m=S$I.contextMeasureText("abcji").width;S$L.context.font="10px "+S$a;var S$s=S$I.contextMeasureText("abcji").width;return console.log(S$m,S$s),S$m!==S$s},S$Q._testWord="游",S$Q.langPacks=null,S$Q.VISIBLE="visible",S$Q.SCROLL="scroll",S$Q.HIDDEN="hidden",S$Q.CharacterCache=!0,S$Q.RightToLeft=!1,S$Q._bitmapFonts=null,S$k(S$Q,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),S$Q}(S$ya),S$Oa=function(S$y){function S$A(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",S$A.__super.call(this),this.offset=new S$U,this._canvasTransform=new S$W,this._previousOrientation=S$L.window.orientation;var S$m=this;this.transform=S$W.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var S$a=S$L.window,S$s=this;S$a.addEventListener("focus",function(){S$m._isFocused=!0,S$s.event("focus"),S$s.event("focuschange")}),S$a.addEventListener("blur",function(){S$m._isFocused=!1,S$s.event("blur"),S$s.event("focuschange"),S$s._isInputting()&&(S$oa.inputElement.target.focus=!1)});var S$P="visibilityState",S$_="visibilitychange",S$e=S$a.document;void 0!==S$e.hidden?(S$_="visibilitychange",S$P="visibilityState"):void 0!==S$e.mozHidden?(S$_="mozvisibilitychange",S$P="mozVisibilityState"):void 0!==S$e.msHidden?(S$_="msvisibilitychange",S$P="msVisibilityState"):void 0!==S$e.webkitHidden&&(S$_="webkitvisibilitychange",S$P="webkitVisibilityState"),S$a.document.addEventListener(S$_,function(){"hidden"==S$L.document[S$P]?S$s._setStageVisible(!1):S$s._setStageVisible(!0)}),S$a.document.addEventListener("qbrowserVisibilityChange",function(S$a){S$s._setStageVisible(!S$a.hidden)}),S$a.addEventListener("resize",function(){var S$a=S$L.window.orientation;null!=S$a&&S$a!=S$m._previousOrientation&&S$s._isInputting()&&(S$oa.inputElement.target.focus=!1),S$m._previousOrientation=S$a,S$s._isInputting()||S$s._resetCanvas()}),S$a.addEventListener("orientationchange",function(S$a){S$s._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),S$L.onMobile&&this.on("mousedown",this,this._onmouseMove)}S$G(S$A,"laya.display.Stage",S$y);var S$a=S$A.prototype;return S$a._setStageVisible=function(S$a){this._isVisibility!=S$a&&(this._isVisibility=S$a,this._isVisibility||this._isInputting()&&(S$oa.inputElement.target.focus=!1),this.event("visibilitychange"))},S$a._isInputting=function(){return S$L.onMobile&&S$oa.isInputting},S$a._changeCanvasSize=function(){this.setScreenSize(S$L.clientWidth*S$L.pixelRatio,S$L.clientHeight*S$L.pixelRatio)},S$a._resetCanvas=function(){if(this.screenAdaptationEnabled){var S$a=S$Z._mainCanvas;S$a.source.style;S$a.size(1,1),S$z.timer.once(100,this,this._changeCanvasSize)}},S$a.setScreenSize=function(S$a,S$m){var S$s=!1;if("none"!==this._screenMode&&(S$s=(S$a/S$m<1?"vertical":"horizontal")!==this._screenMode)){var S$P=S$m;S$m=S$a,S$a=S$P}this.canvasRotation=S$s;var S$_=S$Z._mainCanvas,S$e=S$_.source.style,S$A=this._canvasTransform.identity(),S$B=this._scaleMode,S$k=S$a/this.designWidth,S$j=S$m/this.designHeight,S$G=this.designWidth,S$y=this.designHeight,S$d=S$a,S$Q=S$m,S$q=S$L.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,S$B){case"noscale":S$k=S$j=1,S$d=this.designWidth,S$Q=this.designHeight;break;case"showall":S$k=S$j=Math.min(S$k,S$j),S$G=S$d=Math.round(this.designWidth*S$k),S$y=S$Q=Math.round(this.designHeight*S$j);break;case"noborder":S$k=S$j=Math.max(S$k,S$j),S$d=Math.round(this.designWidth*S$k),S$Q=Math.round(this.designHeight*S$j);break;case"full":S$k=S$j=1,this._width=S$G=S$a,this._height=S$y=S$m;break;case"fixedwidth":S$j=S$k,this._height=S$y=Math.round(S$m/S$k);break;case"fixedheight":S$k=S$j,this._width=S$G=Math.round(S$a/S$j);break;case"fixedauto":S$a/S$m<this.designWidth/this.designHeight?(S$j=S$k,this._height=S$y=Math.round(S$m/S$k)):(S$k=S$j,this._width=S$G=Math.round(S$a/S$j))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,S$G=S$G+1&2147483646,S$y=S$y+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),S$k*=this.scaleX,S$j*=this.scaleY,1===S$k&&1===S$j?this.transform.identity():(this.transform.a=this._formatData(S$k/(S$d/S$G)),this.transform.d=this._formatData(S$j/(S$Q/S$y)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),S$_.size(S$G,S$y),S$V.changeWebGLSize(S$G,S$y),S$A.scale(S$d/S$G/S$q,S$Q/S$y/S$q),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(S$a-S$d)/S$q:this.offset.x=.5*(S$a-S$d)/S$q,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(S$m-S$Q)/S$q:this.offset.y=.5*(S$m-S$Q)/S$q,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),S$A.translate(this.offset.x,this.offset.y),this.canvasDegree=0,S$s&&("horizontal"===this._screenMode?(S$A.rotate(Math.PI/2),S$A.translate(S$m/S$q,0),this.canvasDegree=90):(S$A.rotate(-Math.PI/2),S$A.translate(0,S$a/S$q),this.canvasDegree=-90)),S$A.a=this._formatData(S$A.a),S$A.d=this._formatData(S$A.d),S$A.tx=this._formatData(S$A.tx),S$A.ty=this._formatData(S$A.ty),S$e.transformOrigin=S$e.webkitTransformOrigin=S$e.msTransformOrigin=S$e.mozTransformOrigin=S$e.oTransformOrigin="0px 0px 0px",S$e.transform=S$e.webkitTransform=S$e.msTransform=S$e.mozTransform=S$e.oTransform="matrix("+S$A.toString()+")",S$A.translate(parseInt(S$e.left)||0,parseInt(S$e.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},S$a._formatData=function(S$a){return Math.abs(S$a)<1e-6?0:Math.abs(1-S$a)<.001?0<S$a?1:-1:S$a},S$a.getMousePoint=function(){return S$U.TEMP.setTo(this.mouseX,this.mouseY)},S$a.repaint=function(){this._repaint=1},S$a.parentRepaint=function(){},S$a._loop=function(){return this.render(S$Z.context,0,0),!0},S$a._onmouseMove=function(S$a){this._mouseMoveTime=S$L.now()},S$a.getTimeFromFrameStart=function(){return S$L.now()-this._frameStartTime},S$a.render=function(S$a,S$m,S$s){if("sleep"===this._frameRate&&!S$Z.isConchApp){var S$P=S$L.now();if(!(1e3<=S$P-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(S$v.loopCount++,S$h.instance.runEvent(),S$z.timer._update()));this._frameStartTime=S$P}if(this._renderCount++,S$Z.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=S$L.now();var S$_="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),S$e=this._renderCount%2==0;if(S$v.renderSlow=!S$_,S$_||S$e||S$Z.isConchApp){var S$A;S$v.loopCount++,S$h.instance.runEvent(),S$z.timer._update(),S$V.update3DLoop();var S$B=0,S$k=0;if(S$Z.isConchNode)for(S$B=0,S$k=this._scenes.length;S$B<S$k;S$B++)(S$A=this._scenes[S$B])&&S$A._updateSceneConch();else for(S$B=0,S$k=this._scenes.length;S$B<S$k;S$B++)(S$A=this._scenes[S$B])&&S$A._updateScene();if(S$Z.isConchNode){var S$j=S$ya.CustomList;for(S$B=0,S$k=S$j.length;S$B<S$k;S$B++){var S$G=S$j[S$B];S$G.customRender(S$G.customContext,0,0)}return}}S$Z.isConchNode||this.renderingEnabled&&(S$_||!S$e||S$Z.isConchWebGL)&&(S$Z.isWebGL?S$Z.WebGL.mainContext&&!S$Z.WebGL.mainContext.isContextLost()&&(S$a.clear(),S$y.prototype.render.call(this,S$a,S$m,S$s),S$v._show&&S$v._sp&&S$v._sp.render(S$a,S$m,S$s),S$V.clear(this._bgColor),S$V.beginFlush(),S$a.flush(),S$V.endFinish(),S$$.instance&&S$$.getInstance().endDispose()):(S$V.clear(this._bgColor),S$y.prototype.render.call(this,S$a,S$m,S$s),S$v._show&&S$v._sp&&S$v._sp.render(S$a,S$m,S$s)))}else this._renderCount%5==0&&(S$v.loopCount++,S$h.instance.runEvent(),S$z.timer._update())},S$a._requestFullscreen=function(){var S$a=S$L.document.documentElement;S$a.requestFullscreen?S$a.requestFullscreen():S$a.mozRequestFullScreen?S$a.mozRequestFullScreen():S$a.webkitRequestFullscreen?S$a.webkitRequestFullscreen():S$a.msRequestFullscreen&&S$a.msRequestFullscreen()},S$a._fullScreenChanged=function(){S$z.stage.event("fullscreenchange")},S$a.exitFullscreen=function(){var S$a=S$L.document;S$a.exitFullscreen?S$a.exitFullscreen():S$a.mozCancelFullScreen?S$a.mozCancelFullScreen():S$a.webkitExitFullscreen&&S$a.webkitExitFullscreen()},S$q(0,S$a,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),S$q(0,S$a,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),S$q(0,S$a,"frameRate",function(){return this._frameRate},function(S$a){if(this._frameRate=S$a,S$Z.isConchApp)switch(this._frameRate){case"slow":S$L.window.conch&&S$L.window.conchConfig.setSlowFrame&&S$L.window.conchConfig.setSlowFrame(!0);break;case"fast":S$L.window.conch&&S$L.window.conchConfig.setSlowFrame&&S$L.window.conchConfig.setSlowFrame(!1);break;case"mouse":S$L.window.conch&&S$L.window.conchConfig.setMouseFrame&&S$L.window.conchConfig.setMouseFrame(2e3);break;case"sleep":S$L.window.conch&&S$L.window.conchConfig.setLimitFPS&&S$L.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),S$q(0,S$a,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),S$q(0,S$a,"width",S$y.prototype._$get_width,function(S$a){this.designWidth=S$a,S$z.superSet(S$ya,this,"width",S$a),S$z.timer.callLater(this,this._changeCanvasSize)}),S$q(0,S$a,"alignH",function(){return this._alignH},function(S$a){this._alignH=S$a,S$z.timer.callLater(this,this._changeCanvasSize)}),S$q(0,S$a,"isFocused",function(){return this._isFocused}),S$q(0,S$a,"height",S$y.prototype._$get_height,function(S$a){this.designHeight=S$a,S$z.superSet(S$ya,this,"height",S$a),S$z.timer.callLater(this,this._changeCanvasSize)}),S$q(0,S$a,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||S$W.create()},S$y.prototype._$set_transform),S$q(0,S$a,"isVisibility",function(){return this._isVisibility}),S$q(0,S$a,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),S$q(0,S$a,"scaleMode",function(){return this._scaleMode},function(S$a){this._scaleMode=S$a,S$z.timer.callLater(this,this._changeCanvasSize)}),S$q(0,S$a,"alignV",function(){return this._alignV},function(S$a){this._alignV=S$a,S$z.timer.callLater(this,this._changeCanvasSize)}),S$q(0,S$a,"bgColor",function(){return this._bgColor},function(S$a){this._bgColor=S$a,this.conchModel&&this.conchModel.bgColor(S$a),S$Z.isWebGL&&(S$a?S$A._wgColor=S$M.create(S$a)._color:S$L.onMiniGame||(S$A._wgColor=null)),S$L.onLimixiu?S$A._wgColor=S$M.create(S$a)._color:S$Z.canvas.style.background=S$a||"none"}),S$q(0,S$a,"mouseX",function(){return Math.round(S$h.instance.mouseX/this.clientScaleX)}),S$q(0,S$a,"mouseY",function(){return Math.round(S$h.instance.mouseY/this.clientScaleY)}),S$q(0,S$a,"screenMode",function(){return this._screenMode},function(S$a){this._screenMode=S$a}),S$q(0,S$a,"visible",S$y.prototype._$get_visible,function(S$a){this.visible!==S$a&&(S$z.superSet(S$ya,this,"visible",S$a),S$Z._mainCanvas.source.style.visibility=S$a?"visible":"hidden")}),S$q(0,S$a,"fullScreenEnabled",null,function(S$a){var S$m=S$L.document,S$s=S$Z.canvas;S$a?(S$s.addEventListener("mousedown",this._requestFullscreen),S$s.addEventListener("touchstart",this._requestFullscreen),S$m.addEventListener("fullscreenchange",this._fullScreenChanged),S$m.addEventListener("mozfullscreenchange",this._fullScreenChanged),S$m.addEventListener("webkitfullscreenchange",this._fullScreenChanged),S$m.addEventListener("msfullscreenchange",this._fullScreenChanged)):(S$s.removeEventListener("mousedown",this._requestFullscreen),S$s.removeEventListener("touchstart",this._requestFullscreen),S$m.removeEventListener("fullscreenchange",this._fullScreenChanged),S$m.removeEventListener("mozfullscreenchange",this._fullScreenChanged),S$m.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),S$m.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),S$A.SCALE_NOSCALE="noscale",S$A.SCALE_EXACTFIT="exactfit",S$A.SCALE_SHOWALL="showall",S$A.SCALE_NOBORDER="noborder",S$A.SCALE_FULL="full",S$A.SCALE_FIXED_WIDTH="fixedwidth",S$A.SCALE_FIXED_HEIGHT="fixedheight",S$A.SCALE_FIXED_AUTO="fixedauto",S$A.ALIGN_LEFT="left",S$A.ALIGN_RIGHT="right",S$A.ALIGN_CENTER="center",S$A.ALIGN_TOP="top",S$A.ALIGN_MIDDLE="middle",S$A.ALIGN_BOTTOM="bottom",S$A.SCREEN_NONE="none",S$A.SCREEN_HORIZONTAL="horizontal",S$A.SCREEN_VERTICAL="vertical",S$A.FRAME_FAST="fast",S$A.FRAME_SLOW="slow",S$A.FRAME_MOUSE="mouse",S$A.FRAME_SLEEP="sleep",S$A.FRAME_MOUSE_THREDHOLD=2e3,S$k(S$A,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),S$A}(S$ya),S$pa=(function(S$a){function S$m(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,S$m.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}S$G(S$m,"laya.media.SoundNode",S$ya);var S$s=S$m.prototype;S$s._onParentChange=function(){this.target=this.parent},S$s.play=function(S$a,S$m){void 0===S$a&&(S$a=1),isNaN(S$a)&&(S$a=1),this.url&&(this.stop(),this._channel=S$K.playSound(this.url,S$a,null,S$m))},S$s.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},S$s._setPlayAction=function(S$a,S$m,S$s,S$P){void 0===S$P&&(S$P=!0),this[S$s]&&S$a&&(S$P?S$a.on(S$m,this,this[S$s]):S$a.off(S$m,this,this[S$s]))},S$s._setPlayActions=function(S$a,S$m,S$s,S$P){if(void 0===S$P&&(S$P=!0),S$a&&S$m){var S$_,S$e=S$m.split(","),S$A=0;for(S$_=S$e.length,S$A=0;S$A<S$_;S$A++)this._setPlayAction(S$a,S$e[S$A],S$s,S$P)}},S$q(0,S$s,"playEvent",null,function(S$a){(this._playEvents=S$a)&&this._tar&&this._setPlayActions(this._tar,S$a,"play")}),S$q(0,S$s,"target",null,function(S$a){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=S$a,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),S$q(0,S$s,"stopEvent",null,function(S$a){(this._stopEvents=S$a)&&this._tar&&this._setPlayActions(this._tar,S$a,"stop")})}(),function(S$a){function S$m(){this._src=null,this._onload=null,this._onerror=null,S$m.__super.call(this)}S$G(S$m,"laya.resource.FileBitmap",S$qa);var S$s=S$m.prototype;return S$q(0,S$s,"src",function(){return this._src},function(S$a){this._src=S$a}),S$q(0,S$s,"onload",null,function(S$a){}),S$q(0,S$s,"onerror",null,function(S$a){}),S$m}()),S$ca=function(S$a){function S$s(S$a,S$m){this._is2D=!1,S$s.__super.call(this);var S$P=this;if(this._source=this,"2D"===S$a||"AUTO"===S$a&&!S$Z.isWebGL){this._is2D=!0,this._source=S$m||S$L.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var S$_=this;S$_.getContext=function(S$a,S$m){if(S$P._ctx)return S$P._ctx;var S$s=S$P._ctx=S$P._source.getContext(S$a,S$m);return S$s&&(S$s._canvas=S$_,S$Z.isFlash||S$L.onLimixiu||(S$s.size=function(S$a,S$m){})),S$s}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}S$G(S$s,"laya.resource.HTMLCanvas",S$qa);var S$m=S$s.prototype;return S$m.clear=function(){this._ctx&&this._ctx.clear()},S$m.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},S$m.release=function(){},S$m._setContext=function(S$a){this._ctx=S$a},S$m.getContext=function(S$a,S$m){return this._ctx?this._ctx:this._ctx=S$s._createContext(this)},S$m.getMemSize=function(){return 0},S$m.size=function(S$a,S$m){(this._w!=S$a||this._h!=S$m||this._source&&(this._source.width!=S$a||this._source.height!=S$m))&&(this._w=S$a,this._h=S$m,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(S$a,S$m),this._source&&(this._source.height=S$m,this._source.width=S$a))},S$m.getCanvas=function(){return this._source},S$m.toBase64=function(S$a,S$m,S$s){if(this._source)if(S$Z.isConchApp&&this._source.toBase64)this._source.toBase64(S$a,S$m,S$s);else{var S$P=this._source.toDataURL(S$a,S$m);S$s.call(this,S$P)}},S$q(0,S$m,"context",function(){return this._ctx}),S$q(0,S$m,"asBitmap",null,function(S$a){}),S$s.create=function(S$a,S$m){return new S$s(S$a,S$m)},S$s.TYPE2D="2D",S$s.TYPE3D="3D",S$s.TYPEAUTO="AUTO",S$s._createContext=null,S$s}(),S$Ha=(function(S$a){function S$k(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){throw S$k.__super.call(this),new Error("不允许new！")}S$G(S$k,"laya.resource.HTMLSubImage",S$qa),S$k.create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){return void 0===S$B&&(S$B=!1),new S$k(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B)}}(),function(S$a){function S$y(){this._frames=null,this._url=null,S$y.__super.call(this),this._setControlNode(this)}S$G(S$y,"laya.display.Animation",S$a);var S$m=S$y.prototype;S$m.destroy=function(S$a){void 0===S$a&&(S$a=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,S$a),this._frames=null,this._labels=null},S$m.play=function(S$a,S$m,S$s,S$P){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=!0),void 0===S$s&&(S$s=""),void 0===S$P&&(S$P=!0),S$s&&this._setFramesFromCache(S$s,S$P),this._isPlaying=!0,this.index="string"==typeof S$a?this._getFrameByLabel(S$a):S$a,this.loop=S$m,this._actionName=S$s,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},S$m._setFramesFromCache=function(S$a,S$m){var S$s;return void 0===S$m&&(S$m=!1),this._url&&(S$a=this._url+"#"+S$a),S$a&&S$y.framesMap[S$a]?((S$s=S$y.framesMap[S$a])instanceof Array?(this._frames=S$y.framesMap[S$a],this._count=this._frames.length):(S$s.nodeRoot&&(S$y.framesMap[S$a]=this._parseGraphicAnimationByData(S$s),S$s=S$y.framesMap[S$a]),this._frames=S$s.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=S$s.interval),this._labels=this._copyLabels(S$s.labels)),!0):(S$m&&console.log("ani not found:",S$a),!1)},S$m._copyLabels=function(S$a){if(!S$a)return null;var S$m,S$s;for(S$s in S$m={},S$a)S$m[S$s]=S$I.copyArray([],S$a[S$s]);return S$m},S$m._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&S$a.prototype._frameLoop.call(this)},S$m._displayToIndex=function(S$a){this._frames&&(this.graphics=this._frames[S$a])},S$m.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},S$m.loadImages=function(S$a,S$m){return void 0===S$m&&(S$m=""),this._url="",this._setFramesFromCache(S$m)||(this.frames=S$y.framesMap[S$m]?S$y.framesMap[S$m]:S$y.createFrames(S$a,S$m)),this},S$m.loadAtlas=function(S$m,S$s,S$P){void 0===S$P&&(S$P=""),this._url="";var S$_=this;function S$a(S$a){S$m===S$a&&(S$_.frames=S$y.framesMap[S$P]?S$y.framesMap[S$P]:S$y.createFrames(S$m,S$P),S$s&&S$s.run())}return S$_._setFramesFromCache(S$P)||(S$Ba.getAtlas(S$m)?S$a(S$m):S$z.loader.load(S$m,S$p.create(null,S$a,[S$m]),null,"atlas")),this},S$m.loadAnimation=function(S$a,S$m,S$s){this._url=S$a;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,S$m&&S$m.run()):!S$s||S$Ba.getAtlas(S$s)?this._loadAnimationData(S$a,S$m,S$s):S$z.loader.load(S$s,S$p.create(this,this._loadAnimationData,[S$a,S$m,S$s]),null,"atlas"),this},S$m._loadAnimationData=function(S$B,S$k,S$a){var S$j=this;if(!S$a||S$Ba.getAtlas(S$a)){var S$G=this;S$Ba.getRes(S$B)?S$m(S$B):S$z.loader.load(S$B,S$p.create(null,S$m,[S$B]),null,"json"),S$Ba.clearRes(S$B)}else console.warn("atlas load fail:"+S$a);function S$m(S$a){if(S$Ba.getRes(S$a)&&S$B===S$a){var S$m;if(S$y.framesMap[S$B+"#"])S$G._setFramesFromCache(S$j._actionName,!0),S$j.index=0,S$j._checkResumePlaying();else{var S$s=S$G._parseGraphicAnimation(S$Ba.getRes(S$B));if(!S$s)return;var S$P,S$_=S$s.animationList,S$e=0,S$A=S$_.length;for(S$e=0;S$e<S$A;S$e++)S$m=S$_[S$e],S$y.framesMap[S$B+"#"+S$m.name]=S$m,S$P||(S$P=S$m);S$P&&(S$y.framesMap[S$B+"#"]=S$P,S$G._setFramesFromCache(S$j._actionName,!0),S$j.index=0),S$j._checkResumePlaying()}S$k&&S$k.run()}}},S$m._parseGraphicAnimation=function(S$a){return S$za.parseAnimationData(S$a)},S$m._parseGraphicAnimationByData=function(S$a){return S$za.parseAnimationByData(S$a)},S$q(0,S$m,"frames",function(){return this._frames},function(S$a){(this._frames=S$a)&&(this._count=S$a.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),S$q(0,S$m,"autoPlay",null,function(S$a){S$a?this.play():this.stop()}),S$q(0,S$m,"source",null,function(S$a){-1<S$a.indexOf(".ani")?this.loadAnimation(S$a):-1<S$a.indexOf(".json")||-1<S$a.indexOf("als")||-1<S$a.indexOf("atlas")?this.loadAtlas(S$a):this.loadImages(S$a.split(","))}),S$q(0,S$m,"autoAnimation",null,function(S$a){this.play(0,!0,S$a,!1)}),S$y.createFrames=function(S$a,S$m){var S$s,S$P,S$_=0,S$e=0;if("string"==typeof S$a){var S$A=S$Ba.getAtlas(S$a);if(S$A&&S$A.length)for(S$s=[],S$_=0,S$e=S$A.length;S$_<S$e;S$_++)(S$P=new S$V.createGraphics).drawTexture(S$Ba.getRes(S$A[S$_]),0,0),S$s.push(S$P)}else if(S$a instanceof Array)for(S$s=[],S$_=0,S$e=S$a.length;S$_<S$e;S$_++)(S$P=new S$V.createGraphics).loadImage(S$a[S$_],0,0),S$s.push(S$P);return S$m&&(S$y.framesMap[S$m]=S$s),S$s},S$y.clearCache=function(S$a){var S$m,S$s=S$y.framesMap,S$P=S$a+"#";for(S$m in S$s)S$m!==S$a&&0!=S$m.indexOf(S$P)||delete S$y.framesMap[S$m]},S$y.framesMap={}}(S$ha),function(S$a){function S$e(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,S$e.__super.call(this),null==S$e._sortIndexFun&&(S$e._sortIndexFun=S$N.sortByKey("index",!1,!0))}S$G(S$e,"laya.display.FrameAnimation",S$a);var S$m=S$e.prototype;return S$m._setUp=function(S$a,S$m){this._labels=null,this._animationNewFrames=null,this._targetDic=S$a,this._animationData=S$m,this.interval=1e3/S$m.frameRate,S$m.parsed?(this._count=S$m.count,this._labels=S$m.labels,this._animationNewFrames=S$m.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),S$m.parsed=!0,S$m.labels=this._labels,S$m.count=this._count,S$m.animationNewFrames=this._animationNewFrames},S$m.clear=function(){S$a.prototype.clear.call(this),this._targetDic=null,this._animationData=null},S$m._displayToIndex=function(S$a){if(this._animationData){S$a<0&&(S$a=0),S$a>this._count&&(S$a=this._count);var S$m=this._animationData.nodes,S$s=0,S$P=S$m.length;for(S$s=0;S$s<S$P;S$s++)this._displayNodeToFrame(S$m[S$s],S$a)}},S$m._displayNodeToFrame=function(S$a,S$m,S$s){S$s||(S$s=this._targetDic);var S$P=S$s[S$a.target];if(S$P){var S$_,S$e,S$A,S$B=S$a.frames,S$k=S$a.keys,S$j=0,S$G=S$k.length;for(S$j=0;S$j<S$G;S$j++)S$A=(S$e=S$B[S$_=S$k[S$j]]).length>S$m?S$e[S$m]:S$e[S$e.length-1],S$P[S$_]=S$A}},S$m._calculateDatas=function(){if(this._animationData){var S$a,S$m=this._animationData.nodes,S$s=0,S$P=S$m.length;for(S$s=this._count=0;S$s<S$P;S$s++)S$a=S$m[S$s],this._calculateNodeKeyFrames(S$a);this._count+=1}},S$m._calculateNodeKeyFrames=function(S$a){var S$m,S$s,S$P=S$a.keyframes,S$_=S$a.target;for(S$m in S$a.frames||(S$a.frames={}),S$a.keys?S$a.keys.length=0:S$a.keys=[],S$a.initValues||(S$a.initValues={}),S$P)S$s=S$P[S$m],S$a.frames[S$m]||(S$a.frames[S$m]=[]),this._targetDic&&this._targetDic[S$_]&&(S$a.initValues[S$m]=this._targetDic[S$_][S$m]),S$s.sort(S$e._sortIndexFun),S$a.keys.push(S$m),this._calculateNodePropFrames(S$s,S$a.frames[S$m],S$m,S$_)},S$m.resetToInitState=function(){if(this._targetDic&&this._animationData){var S$a,S$m,S$s=this._animationData.nodes,S$P=0,S$_=S$s.length;for(S$P=0;S$P<S$_;S$P++)if(S$m=(S$a=S$s[S$P]).initValues){var S$e,S$A=this._targetDic[S$a.target];if(S$A)for(S$e in S$m)S$A[S$e]=S$m[S$e]}}},S$m._calculateNodePropFrames=function(S$a,S$m,S$s,S$P){var S$_=0,S$e=S$a.length-1;if(0<S$e){for(S$m.length=S$a[S$e].index+1,S$_=0;S$_<S$e;S$_++)this._dealKeyFrame(S$a[S$_]),this._calculateFrameValues(S$a[S$_],S$a[S$_+1],S$m);this._dealKeyFrame(S$a[S$_])}0==S$e&&(S$m[S$a[0].index]=S$a[0].value,this._animationNewFrames&&(this._animationNewFrames[S$a[0].index]=!0))},S$m._dealKeyFrame=function(S$a){S$a.label&&""!=S$a.label&&this.addLabel(S$a.label,S$a.index)},S$m._calculateFrameValues=function(S$a,S$m,S$s){var S$P,S$_=0,S$e=S$a.index,S$A=S$m.index,S$B=S$a.value,S$k=S$m.value-S$a.value,S$j=S$A-S$e;if(S$A>this._count&&(this._count=S$A),S$a.tween)for(null==(S$P=S$D[S$a.tweenMethod])&&(S$P=S$D.linearNone),S$_=S$e;S$_<S$A;S$_++)S$s[S$_]=S$P(S$_-S$e,S$B,S$k,S$j),this._animationNewFrames&&(this._animationNewFrames[S$_]=!0);else for(S$_=S$e;S$_<S$A;S$_++)S$s[S$_]=S$B;this._animationNewFrames&&(this._animationNewFrames[S$a.index]=!0,this._animationNewFrames[S$m.index]=!0),S$s[S$m.index]=S$m.value},S$e._sortIndexFun=null,S$e}(S$ha)),S$oa=function(S$m){function S$_(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",S$_.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=S$ua.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}S$G(S$_,"laya.display.Input",S$m);var S$a=S$_.prototype;return S$a.setSelection=function(S$a,S$m){this.focus=!0,laya.display.Input.inputElement.selectionStart=S$a,laya.display.Input.inputElement.selectionEnd=S$m},S$a._onUnDisplay=function(S$a){this.focus=!1},S$a._onMouseDown=function(S$a){this.focus=!0},S$a._syncInputTransform=function(){var S$a=this.nativeInput,S$m=S$I.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),S$s=this._width-this.padding[1]-this.padding[3],S$P=this._height-this.padding[0]-this.padding[2];S$Z.isConchApp?(S$a.setScale(S$m.scaleX,S$m.scaleY),S$a.setSize(S$s,S$P),S$a.setPos(S$m.x,S$m.y)):(S$_.inputContainer.style.transform=S$_.inputContainer.style.webkitTransform="scale("+S$m.scaleX+","+S$m.scaleY+") rotate("+S$z.stage.canvasDegree+"deg)",S$a.style.width=S$s+"px",S$a.style.height=S$P+"px",S$_.inputContainer.style.left=S$m.x+"px",S$_.inputContainer.style.top=S$m.y+"px")},S$a.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},S$a._setInputMethod=function(){S$_.input.parentElement&&S$_.inputContainer.removeChild(S$_.input),S$_.area.parentElement&&S$_.inputContainer.removeChild(S$_.area),S$_.inputElement=this._multiline?S$_.area:S$_.input,S$_.inputContainer.appendChild(S$_.inputElement),S$ua.RightToLeft&&(S$_.inputElement.style.direction="rtl")},S$a._focusIn=function(){laya.display.Input.isInputting=!0;var S$a=this.nativeInput;this._focus=!0;var S$m=S$a.style;S$m.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),S$a.readOnly=!this._editable,S$Z.isConchApp&&(S$a.setType(this._type),S$a.setForbidEdit(!this._editable)),S$a.maxLength=this._maxChars;this.padding;if(S$a.type=this._type,S$a.value=this._content,S$a.placeholder=this._prompt,S$z.stage.off("keydown",this,this._onKeyDown),S$z.stage.on("keydown",this,this._onKeyDown),(S$z.stage.focus=this).event("focus"),S$L.onPC&&S$a.focus(),!S$L.onMiniGame){this._text;this._text=null}this.typeset(),S$a.setColor(this._originColor),S$a.setFontSize(this.fontSize),S$a.setFontFace(S$L.onIPhone&&S$ua._fontFamilyMap[this.font]||this.font),S$Z.isConchApp&&S$a.setMultiAble&&S$a.setMultiAble(this._multiline),S$m.lineHeight=this.leading+this.fontSize+"px",S$m.fontStyle=this.italic?"italic":"normal",S$m.fontWeight=this.bold?"bold":"normal",S$m.textAlign=this.align,S$m.padding="0 0",this._syncInputTransform(),!S$Z.isConchApp&&S$L.onPC&&S$z.timer.frameLoop(1,this,this._syncInputTransform)},S$a._setPromptColor=function(){(S$_.promptStyleDOM=S$L.getElementById("promptStyle"))||((S$_.promptStyleDOM=S$L.createElement("style")).setAttribute("id","promptStyle"),S$L.document.head.appendChild(S$_.promptStyleDOM)),S$_.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},S$a._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(S$z.superSet(S$ua,this,"text",this._content),S$z.superSet(S$ua,this,"color",this._originColor)):(S$z.superSet(S$ua,this,"text",this._prompt),S$z.superSet(S$ua,this,"color",this._promptColor)),S$z.stage.off("keydown",this,this._onKeyDown),S$z.stage.focus=null,this.event("blur"),S$Z.isConchApp&&this.nativeInput.blur(),S$L.onPC&&S$z.timer.clear(this,this._syncInputTransform)},S$a._onKeyDown=function(S$a){13===S$a.keyCode&&(S$L.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},S$a.changeText=function(S$a){this._content=S$a,this._focus?(this.nativeInput.value=S$a||"",this.event("change")):S$m.prototype.changeText.call(this,S$a)},S$q(0,S$a,"color",S$m.prototype._$get_color,function(S$a){this._focus&&this.nativeInput.setColor(S$a),S$z.superSet(S$ua,this,"color",this._content?S$a:this._promptColor),this._originColor=S$a}),S$q(0,S$a,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(S$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),S$q(0,S$a,"multiline",function(){return this._multiline},function(S$a){this._multiline=S$a,this.valign=S$a?"top":"middle"}),S$q(0,S$a,"maxChars",function(){return this._maxChars},function(S$a){S$a<=0&&(S$a=1e5),this._maxChars=S$a}),S$q(0,S$a,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(S$a){S$z.superSet(S$ua,this,"color",this._originColor),S$a+="",this._focus?(this.nativeInput.value=S$a||"",this.event("change")):(this._multiline||(S$a=S$a.replace(/\r?\n/g,"")),(this._content=S$a)?S$z.superSet(S$ua,this,"text",S$a):(S$z.superSet(S$ua,this,"text",this._prompt),S$z.superSet(S$ua,this,"color",this.promptColor)))}),S$q(0,S$a,"nativeInput",function(){return this._multiline?S$_.area:S$_.input}),S$q(0,S$a,"prompt",function(){return this._prompt},function(S$a){!this._text&&S$a&&S$z.superSet(S$ua,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?S$z.superSet(S$ua,this,"text",this._text==this._prompt?S$a:this._text):S$z.superSet(S$ua,this,"text",S$a),this._prompt=S$ua.langPacks&&S$ua.langPacks[S$a]?S$ua.langPacks[S$a]:S$a}),S$q(0,S$a,"focus",function(){return this._focus},function(S$a){var S$m=this.nativeInput;this._focus!==S$a&&(S$a?(S$m.target?S$m.target._focusOut():this._setInputMethod(),(S$m.target=this)._focusIn()):(S$m.target=null,this._focusOut(),S$L.document.body.scrollTop=0,S$m.blur(),S$Z.isConchApp?S$m.setPos(-1e4,-1e4):S$_.inputContainer.contains(S$m)&&S$_.inputContainer.removeChild(S$m)))}),S$q(0,S$a,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(S$a){S$a?(-1<(S$a="[^"+S$a+"]").indexOf("^^")&&(S$a=S$a.replace("^^","")),this._restrictPattern=new RegExp(S$a,"g")):this._restrictPattern=null}),S$q(0,S$a,"editable",function(){return this._editable},function(S$a){this._editable=S$a,S$Z.isConchApp&&S$_.input.setForbidEdit(!S$a)}),S$q(0,S$a,"promptColor",function(){return this._promptColor},function(S$a){this._promptColor=S$a,this._content||S$z.superSet(S$ua,this,"color",S$a)}),S$q(0,S$a,"type",function(){return this._type},function(S$a){this._getCSSStyle().password="password"==S$a,this._type=S$a,S$Z.isConchApp&&this.nativeInput.setType(S$a)}),S$q(0,S$a,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(S$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),S$q(0,S$a,"asPassword",function(){return this._getCSSStyle().password},function(S$a){this._getCSSStyle().password=S$a,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),S$_.__init__=function(){S$_._createInputElement(),S$L.onMobile&&S$Z.canvas.addEventListener(S$_.IOS_IFRAME?S$L.onMiniGame?"touchend":"click":"touchend",S$_._popupInputMethod)},S$_._popupInputMethod=function(S$a){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},S$_._createInputElement=function(){S$_._initInput(S$_.area=S$L.createElement("textarea")),S$_._initInput(S$_.input=S$L.createElement("input")),(S$_.inputContainer=S$L.createElement("div")).style.position="absolute",S$_.inputContainer.style.zIndex=1e5,S$L.container.appendChild(S$_.inputContainer),S$_.inputContainer.setPos=function(S$a,S$m){S$_.inputContainer.style.left=S$a+"px",S$_.inputContainer.style.top=S$m+"px"}},S$_._initInput=function(S$m){var S$a=S$m.style;S$a.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",S$a.resize="none",S$a.backgroundColor="transparent",S$a.border="none",S$a.outline="none",S$a.zIndex=1,S$m.addEventListener("input",S$_._processInputting),S$m.addEventListener("mousemove",S$_._stopEvent),S$m.addEventListener("mousedown",S$_._stopEvent),S$m.addEventListener("touchmove",S$_._stopEvent),S$m.setFontFace=function(S$a){S$m.style.fontFamily=S$a},S$Z.isConchApp||(S$m.setColor=function(S$a){S$m.style.color=S$a},S$m.setFontSize=function(S$a){S$m.style.fontSize=S$a+"px"})},S$_._processInputting=function(S$a){var S$m=laya.display.Input.inputElement.target;if(S$m){var S$s=laya.display.Input.inputElement.value;S$m._restrictPattern&&(S$s=S$s.replace(/\u2006|\x27/g,""),S$m._restrictPattern.test(S$s)&&(S$s=S$s.replace(S$m._restrictPattern,""),laya.display.Input.inputElement.value=S$s)),S$m._text=S$s,S$m.event("input")}},S$_._stopEvent=function(S$a){"touchmove"==S$a.type&&S$a.preventDefault(),S$a.stopPropagation&&S$a.stopPropagation()},S$_.TYPE_TEXT="text",S$_.TYPE_PASSWORD="password",S$_.TYPE_EMAIL="email",S$_.TYPE_URL="url",S$_.TYPE_NUMBER="number",S$_.TYPE_RANGE="range",S$_.TYPE_DATE="date",S$_.TYPE_MONTH="month",S$_.TYPE_WEEK="week",S$_.TYPE_TIME="time",S$_.TYPE_DATE_TIME="datetime",S$_.TYPE_DATE_TIME_LOCAL="datetime-local",S$_.TYPE_SEARCH="search",S$_.input=null,S$_.area=null,S$_.inputElement=null,S$_.inputContainer=null,S$_.confirmButton=null,S$_.promptStyleDOM=null,S$_.inputHeight=45,S$_.isInputting=!1,S$_.stageMatrix=null,S$k(S$_,["IOS_IFRAME",function(){return this.IOS_IFRAME=S$L.onIOS&&S$L.window.top!=S$L.window.self}]),S$_}(S$ua),S$Na=function(S$a){function S$s(S$a,S$m){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,S$s.__super.call(this),S$a&&this._init_(S$a,S$m)}S$G(S$s,"laya.resource.HTMLImage",S$pa);var S$m=S$s.prototype;return S$m._init_=function(S$a,S$m){this._src=S$a,this._source=new S$L.window.Image,S$m&&(S$m.onload&&(this.onload=S$m.onload),S$m.onerror&&(this.onerror=S$m.onerror),S$m.onCreate&&S$m.onCreate(this)),0!=S$a.indexOf("data:image")&&(this._source.crossOrigin=""),S$a&&(this._source.src=S$a)},S$m.recreateResource=function(){var S$a=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var S$m=this;this._source=new S$L.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(S$m._needReleaseAgain)return S$m._needReleaseAgain=!1,S$m._source.onload=null,void(S$m._source=null);S$m._source.onload=null,S$m.memorySize=S$a._w*S$a._h*4,S$m._recreateLock=!1,S$m.completeCreate()},this._source.src=this._src}},S$m.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},S$m.onresize=function(){this._w=this._source.width,this._h=this._source.height},S$q(0,S$m,"onload",null,function(S$a){var S$m=this;this._onload=S$a,this._source&&(this._source.onload=null!=this._onload?function(){S$m.onresize(),S$m._onload()}:null)}),S$q(0,S$m,"onerror",null,function(S$a){var S$m=this;this._onerror=S$a,this._source&&(this._source.onerror=null!=this._onerror?function(){S$m._onerror()}:null)}),S$q(0,S$m,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(S$a){this._enableMerageInAtlas=S$a,S$Z.isConchApp&&this._source&&(this._source.enableMerageInAtlas=S$a)}),S$s.create=function(S$a,S$m){return new S$s(S$a,S$m)},S$s}(),S$za=(function(S$e){function S$a(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,S$a.__super.call(this)}S$G(S$a,"laya.display.EffectAnimation",S$e);var S$m=S$a.prototype;S$m._onOtherBegin=function(S$a){S$a!=this&&this.stop()},S$m.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},S$m._onPlayAction=function(){this.play(0,!1)},S$m.play=function(S$a,S$m,S$s,S$P){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=!0),void 0===S$s&&(S$s=""),void 0===S$P&&(S$P=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,S$a,S$m,S$s,S$P))},S$m._recordInitData=function(){if(this._aniKeys){var S$a,S$m,S$s=0;for(S$a=this._aniKeys.length,S$s=0;S$s<S$a;S$s++)S$m=this._aniKeys[S$s],this._initData[S$m]=this._target[S$m]}},S$m._displayToIndex=function(S$a){if(this._animationData){S$a<0&&(S$a=0),S$a>this._count&&(S$a=this._count);var S$m=this._animationData.nodes,S$s=0,S$P=S$m.length;for(S$P=1<S$P?1:S$P,S$s=0;S$s<S$P;S$s++)this._displayNodeToFrame(S$m[S$s],S$a)}},S$m._displayNodeToFrame=function(S$a,S$m,S$s){if(this._target){var S$P;S$P=this._target;var S$_,S$e,S$A,S$B,S$k=S$a.frames,S$j=S$a.keys,S$G=0,S$y=S$j.length;S$B=S$a.secondFrames;var S$d,S$Q,S$q,S$h,S$u=0;for(S$G=0;S$G<S$y;S$G++)S$e=S$k[S$_=S$j[S$G]],S$A=-1==(S$u=S$B[S$_])?this._initData[S$_]:S$m<S$u?(S$q=(S$Q=S$a.keyframes[S$_])[0]).tween?(null==(S$d=S$D[S$q.tweenMethod])&&(S$d=S$D.linearNone),S$h=S$Q[1],S$d(S$m,this._initData[S$_],S$h.value-this._initData[S$_],S$h.index)):this._initData[S$_]:S$e.length>S$m?S$e[S$m]:S$e[S$e.length-1],S$P[S$_]=S$A}},S$m._calculateNodeKeyFrames=function(S$a){S$e.prototype._calculateNodeKeyFrames.call(this,S$a);var S$m,S$s,S$P,S$_=S$a.keyframes;S$a.target;for(S$m in S$P={},S$a.secondFrames=S$P,S$_)(S$s=S$_[S$m]).length<=1?S$P[S$m]=-1:S$P[S$m]=S$s[1].index},S$q(0,S$m,"target",function(){return this._target},function(S$a){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=S$a,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),S$q(0,S$m,"playEvent",null,function(S$a){(this._playEvents=S$a)&&this.addEvent()}),S$q(0,S$m,"effectData",null,function(S$a){var S$m;S$a&&((S$m=S$a.animations)&&S$m[0]&&(this._setUp({},S$m[0]),S$m[0].nodes&&S$m[0].nodes[0]&&(this._aniKeys=S$m[0].nodes[0].keys)))}),S$q(0,S$m,"effectClass",null,function(S$a){var S$m,S$s;(this._effectClass=S$x.getClass(S$a),this._effectClass)&&((S$m=this._effectClass.uiView)&&(S$s=S$m.animations)&&S$s[0]&&(this._setUp({},S$s[0]),S$s[0].nodes&&S$s[0].nodes[0]&&(this._aniKeys=S$s[0].nodes[0].keys)))}),S$a.EffectAnimationBegin="effectanimationbegin"}(S$Ha),function(S$m){var S$f;function S$K(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,S$K.__super.call(this)}S$G(S$K,"laya.utils.GraphicAnimation",S$m);var S$a=S$K.prototype;return S$a._parseNodeList=function(S$a){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[S$a.compId]=S$a.props,S$a.compId&&this._nodeList.push(S$a.compId);var S$m=S$a.child;if(S$m){var S$s=0,S$P=S$m.length;for(S$s=0;S$s<S$P;S$s++)this._parseNodeList(S$m[S$s])}},S$a._calGraphicData=function(S$a){var S$m;if(this._setUp(null,S$a),this._createGraphicData(),this._nodeIDAniDic)for(S$m in this._nodeIDAniDic)this._nodeIDAniDic[S$m]=null},S$a._createGraphicData=function(){var S$a,S$m=[],S$s=0,S$P=this.count,S$_=this._animationNewFrames;for(S$_||(S$_=[]),S$s=0;S$s<S$P;S$s++)!S$_[S$s]&&S$a||(S$a=this._createFrameGraphic(S$s)),S$m.push(S$a);this._gList=S$m},S$a._createFrameGraphic=function(S$a){var S$m=S$V.createGraphics();return S$K._rootMatrix||(S$K._rootMatrix=new S$W),this._updateNodeGraphic(this._rootNode,S$a,S$K._rootMatrix,S$m),S$m},S$a._updateNodeGraphic=function(S$a,S$m,S$s,S$P,S$_){var S$e;void 0===S$_&&(S$_=1);var S$A,S$B,S$k,S$j=(S$e=this._nodeGDic[S$a.compId]=this._getNodeGraphicData(S$a.compId,S$m,this._nodeGDic[S$a.compId])).alpha*S$_;if(!(S$j<.01)&&(S$e.resultTransform||(S$e.resultTransform=S$W.create()),S$A=S$e.resultTransform,S$W.mul(S$e.transform,S$s,S$A),S$e.skin&&(S$B=this._getTextureByUrl(S$e.skin))&&(S$A._checkTransform()?(S$P.drawTexture(S$B,0,0,S$e.width,S$e.height,S$A,S$j),S$e.resultTransform=null):S$P.drawTexture(S$B,S$A.tx,S$A.ty,S$e.width,S$e.height,null,S$j)),S$k=S$a.child)){var S$G,S$y=0;for(S$G=S$k.length,S$y=0;S$y<S$G;S$y++)this._updateNodeGraphic(S$k[S$y],S$m,S$A,S$P,S$j)}},S$a._updateNoChilds=function(S$a,S$m){if(S$a.skin){var S$s=this._getTextureByUrl(S$a.skin);if(S$s){var S$P=S$a.transform;S$P._checkTransform();!S$P.bTransform?S$m.drawTexture(S$s,S$P.tx,S$P.ty,S$a.width,S$a.height,null,S$a.alpha):S$m.drawTexture(S$s,0,0,S$a.width,S$a.height,S$P.clone(),S$a.alpha)}}},S$a._updateNodeGraphic2=function(S$a,S$m,S$s){var S$P;if(S$P=this._nodeGDic[S$a.compId]=this._getNodeGraphicData(S$a.compId,S$m,this._nodeGDic[S$a.compId]),S$a.child){var S$_=S$P.transform;S$_._checkTransform();var S$e,S$A;S$A=(S$e=!S$_.bTransform)&&(0!=S$_.tx||0!=S$_.ty);var S$B,S$k,S$j;if((S$B=S$_.bTransform||1!=S$P.alpha)&&S$s.save(),1!=S$P.alpha&&S$s.alpha(S$P.alpha),S$e?S$A&&S$s.translate(S$_.tx,S$_.ty):S$s.transform(S$_.clone()),S$k=S$a.child,S$P.skin&&(S$j=this._getTextureByUrl(S$P.skin))&&S$s.drawTexture(S$j,0,0,S$P.width,S$P.height),S$k){var S$G,S$y=0;for(S$G=S$k.length,S$y=0;S$y<S$G;S$y++)this._updateNodeGraphic2(S$k[S$y],S$m,S$s)}S$B?S$s.restore():S$e?S$A&&S$s.translate(-S$_.tx,-S$_.ty):S$s.transform(S$_.clone().invert())}else this._updateNoChilds(S$P,S$s)},S$a._calculateNodeKeyFrames=function(S$a){S$m.prototype._calculateNodeKeyFrames.call(this,S$a),this._nodeIDAniDic[S$a.target]=S$a},S$a.getNodeDataByID=function(S$a){return this._nodeIDAniDic[S$a]},S$a._getParams=function(S$a,S$m,S$s,S$P){var S$_=S$K._temParam;S$_.length=S$m.length;var S$e=0,S$A=S$m.length;for(S$e=0;S$e<S$A;S$e++)S$_[S$e]=this._getObjVar(S$a,S$m[S$e][0],S$s,S$m[S$e][1],S$P);return S$_},S$a._getObjVar=function(S$a,S$m,S$s,S$P,S$_){if(S$a.hasOwnProperty(S$m)){var S$e=S$a[S$m];if(S$s>=S$e.length&&(S$s=S$e.length-1),null!=S$a[S$m][S$s])return S$a[S$m][S$s]}return S$_.hasOwnProperty(S$m)?S$_[S$m]:S$P},S$a._getNodeGraphicData=function(S$a,S$m,S$s){S$s||(S$s=S$f.create()),S$s.transform?S$s.transform.identity():S$s.transform=S$W.create();var S$P=this.getNodeDataByID(S$a);if(!S$P)return S$s;var S$_,S$e,S$A=S$P.frames,S$B=this._getParams(S$A,S$K._drawTextureCmd,S$m,this._nodeDefaultProps[S$a]),S$k=S$B[0],S$j=NaN,S$G=NaN,S$y=S$B[5],S$d=S$B[6],S$Q=S$B[13],S$q=S$B[14],S$h=S$B[7],S$u=S$B[8],S$O=S$B[9],S$p=S$B[11],S$c=S$B[12];S$j=S$B[3],S$G=S$B[4],0!=S$j&&0!=S$G||(S$k=null),-1==S$j&&(S$j=0),-1==S$G&&(S$G=0),S$s.skin=S$k,S$s.width=S$j,S$s.height=S$G,S$k&&((S$_=this._getTextureByUrl(S$k))?(S$j||(S$j=S$_.sourceWidth),S$G||(S$G=S$_.sourceHeight)):console.warn("lost skin:",S$k,",you may load pics first")),S$s.alpha=S$B[10],S$e=S$s.transform,0!=S$Q&&(S$y=S$Q*S$j),0!=S$q&&(S$d=S$q*S$G),0==S$y&&0==S$d||S$e.translate(-S$y,-S$d);var S$H=null;if(S$O||1!==S$h||1!==S$u||S$p||S$c){(S$H=S$K._tempMt).identity(),S$H.bTransform=!0;var S$o=.0174532922222222*(S$O-S$p),S$N=.0174532922222222*(S$O+S$c),S$z=Math.cos(S$N),S$U=Math.sin(S$N),S$l=Math.sin(S$o),S$C=Math.cos(S$o);S$H.a=S$h*S$z,S$H.b=S$h*S$U,S$H.c=-S$u*S$l,S$H.d=S$u*S$C,S$H.tx=S$H.ty=0}return S$H&&(S$e=S$W.mul(S$e,S$H,S$e)),S$e.translate(S$B[1],S$B[2]),S$s},S$a._getTextureByUrl=function(S$a){return S$Ba.getRes(S$a)},S$a.setAniData=function(S$a,S$m){if(S$a.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=S$a,this._parseNodeList(S$a);var S$s,S$P={},S$_=[],S$e=S$a.animations,S$A=0,S$B=S$e.length;for(S$A=0;S$A<S$B;S$A++)if(S$s=S$e[S$A],this._labels=null,(!S$m||S$m==S$s.name)&&S$s){try{this._calGraphicData(S$s)}catch(S$a){console.warn("parse animation fail:"+S$s.name+",empty animation created"),this._gList=[]}var S$k={};S$k.interval=1e3/S$s.frameRate,S$k.frames=this._gList,S$k.labels=this._labels,S$k.name=S$s.name,S$_.push(S$k),S$P[S$s.name]=S$k}this.animationList=S$_,this.animationDic=S$P}S$K._temParam.length=0},S$a.parseByData=function(S$a){var S$m,S$s;S$m=S$a.nodeRoot,S$s=S$a.aniO,delete S$a.nodeRoot,delete S$a.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=S$m,this._parseNodeList(S$m),this._labels=null;try{this._calGraphicData(S$s)}catch(S$a){console.warn("parse animation fail:"+S$s.name+",empty animation created"),this._gList=[]}var S$P=S$a;return S$P.interval=1e3/S$s.frameRate,S$P.frames=this._gList,S$P.labels=this._labels,S$P.name=S$s.name,S$P},S$a.setUpAniData=function(S$a){if(S$a.animations){var S$m,S$s={},S$P=[],S$_=S$a.animations,S$e=0,S$A=S$_.length;for(S$e=0;S$e<S$A;S$e++)if(S$m=S$_[S$e]){var S$B={};S$B.name=S$m.name,S$B.aniO=S$m,S$B.nodeRoot=S$a,S$P.push(S$B),S$s[S$m.name]=S$B}this.animationList=S$P,this.animationDic=S$s}},S$a._clear=function(){var S$a,S$m;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(S$a in this._nodeGDic)(S$m=this._nodeGDic[S$a])&&S$m.recover();this._nodeGDic=null},S$K.parseAnimationByData=function(S$a){var S$m;return S$K._I||(S$K._I=new S$K),S$m=S$K._I.parseByData(S$a),S$K._I._clear(),S$m},S$K.parseAnimationData=function(S$a){var S$m;return S$K._I||(S$K._I=new S$K),S$K._I.setUpAniData(S$a),(S$m={}).animationList=S$K._I.animationList,S$m.animationDic=S$K._I.animationDic,S$K._I._clear(),S$m},S$K._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],S$K._temParam=[],S$K._I=null,S$K._rootMatrix=null,S$k(S$K,["_tempMt",function(){return this._tempMt=new S$W}]),S$K.__init$=function(){S$f=function(){function S$a(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return S$G(S$a,""),S$a.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),S$w.recover("GraphicNode",this)},S$a.create=function(){return S$w.getItemByClass("GraphicNode",S$a)},S$a}()},S$K}(S$Ha));S$z.__init([S$j,S$ka,S$Z,S$L,S$Y,S$C,S$a,S$za])}(window,document,Laya),function(S$a,S$m,S$s){S$s.un,S$s.uns,S$s.static;var S$P=S$s.class;S$s.getset,S$s.__newvec;new(function(){function S$a(){}return S$P(S$a,"LayaMain"),S$a}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(S$a,S$m){"use strict";for(var S$s in Object.defineProperty(S$m,"__esModule",{value:!0}),Laya){var S$P=Laya[S$s];S$P&&S$P.__isclass&&(S$m[S$s]=S$P)}}),function(S$s,S$a,S$N){S$N.un,S$N.uns;var S$A=S$N.static,S$d=S$N.class,S$P=S$N.getset,S$e=S$N.__newvec,S$G=laya.maths.Arith,S$y=laya.maths.Bezier,S$k=laya.resource.Bitmap,S$Q=laya.utils.Browser,S$j=laya.utils.Byte,S$q=laya.utils.Color,S$z=(laya.filters.ColorFilter,S$N.Config),S$_=laya.resource.Context,S$U=(laya.events.Event,laya.filters.Filter),S$B=laya.display.Graphics,S$h=laya.resource.HTMLCanvas,S$u=(laya.utils.HTMLChar,laya.resource.HTMLImage),S$m=laya.resource.HTMLSubImage,S$l=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),S$C=laya.maths.Point,S$f=laya.maths.Rectangle,S$O=laya.renders.Render,S$p=(laya.renders.RenderContext,laya.renders.RenderSprite),S$c=laya.resource.Resource,S$H=laya.resource.ResourceManager,S$o=laya.utils.RunDriver,S$K=laya.display.Sprite,S$V=laya.display.Stage,S$W=laya.utils.Stat,S$b=laya.utils.StringKey,S$S=(laya.display.css.Style,laya.system.System),S$Z=laya.display.Text,S$X=laya.resource.Texture,S$E=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),S$i=laya.utils.VectorGraphManager;laya.utils.WordText;S$N.interface("laya.webgl.shapes.IShape"),S$N.interface("laya.webgl.submit.ISubmit"),S$N.interface("laya.webgl.text.ICharSegment"),S$N.interface("laya.webgl.canvas.save.ISaveData"),S$N.interface("laya.webgl.resource.IMergeAtlasBitmap"),S$N.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var S$t=function(){function S$a(){}S$d(S$a,"laya.filters.webgl.FilterActionGL");var S$m=S$a.prototype;return S$N.imps(S$m,{"laya.filters.IFilterActionGL":!0}),S$m.setValue=function(S$a){},S$m.setValueMix=function(S$a){},S$m.apply3d=function(S$a,S$m,S$s,S$P,S$_){return null},S$m.apply=function(S$a){return null},S$P(0,S$m,"typeMix",function(){return 0}),S$a}(),S$L=function(){function S$a(){}return S$d(S$a,"laya.webgl.shader.ShaderValue"),S$a}(),S$R=function(){var S$P,S$_;function S$a(S$a,S$m,S$s){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new S$_,void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),this._cells=null,this._rowInfo=null,this._init(S$a,S$m),this._atlasID=S$s}S$d(S$a,"laya.webgl.atlas.AtlasGrid");var S$m=S$a.prototype;return S$m.getAltasID=function(){return this._atlasID},S$m.setAltasID=function(S$a){0<=S$a&&(this._atlasID=S$a)},S$m.addTex=function(S$a,S$m,S$s){var S$P=this._get(S$m,S$s);return 0==S$P.ret||(this._fill(S$P.x,S$P.y,S$m,S$s,S$a),this._texCount++),S$P},S$m._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},S$m._init=function(S$a,S$m){if(this._width=S$a,this._height=S$m,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=S$e(this._height);for(var S$s=0;S$s<this._height;S$s++)this._rowInfo[S$s]=new S$P;return this._clear(),!0},S$m._get=function(S$a,S$m){var S$s=new S$x;if(S$a>=this._failSize.width&&S$m>=this._failSize.height)return S$s;for(var S$P=-1,S$_=-1,S$e=this._width,S$A=this._height,S$B=this._cells,S$k=0;S$k<S$A;S$k++)if(!(this._rowInfo[S$k].spaceCount<S$a))for(var S$j=0;S$j<S$e;){var S$G=3*(S$k*S$e+S$j);if(0!=S$B[S$G]||S$B[1+S$G]<S$a||S$B[2+S$G]<S$m)S$j+=S$B[1+S$G];else{S$P=S$j,S$_=S$k;for(var S$y=0;S$y<S$a;S$y++)if(S$B[3*S$y+S$G+2]<S$m){S$P=-1;break}if(!(S$P<0))return S$s.ret=!0,S$s.x=S$P,S$s.y=S$_,S$s;S$j+=S$B[1+S$G]}}return S$s},S$m._fill=function(S$a,S$m,S$s,S$P,S$_){var S$e=this._width,S$A=this._height;this._check(S$a+S$s<=S$e&&S$m+S$P<=S$A);for(var S$B=S$m;S$B<S$P+S$m;++S$B){this._check(this._rowInfo[S$B].spaceCount>=S$s),this._rowInfo[S$B].spaceCount-=S$s;for(var S$k=0;S$k<S$s;S$k++){var S$j=3*(S$a+S$B*S$e+S$k);this._check(0==this._cells[S$j]),this._cells[S$j]=S$_,this._cells[1+S$j]=S$s,this._cells[2+S$j]=S$P}}if(0<S$a)for(S$B=0;S$B<S$P;++S$B){var S$G=0;for(S$k=S$a-1;0<=S$k&&0==this._cells[3*((S$m+S$B)*S$e+S$k)];--S$k,++S$G);for(S$k=S$G;0<S$k;--S$k)this._cells[3*((S$m+S$B)*S$e+S$a-S$k)+1]=S$k,this._check(0<S$k)}if(0<S$m)for(S$k=S$a;S$k<S$a+S$s;++S$k){for(S$G=0,S$B=S$m-1;0<=S$B&&0==this._cells[3*(S$k+S$B*S$e)];--S$B,S$G++);for(S$B=S$G;0<S$B;--S$B)this._cells[3*(S$k+(S$m-S$B)*S$e)+2]=S$B,this._check(0<S$B)}},S$m._check=function(S$a){0==S$a&&console.log("xtexMerger 错误啦")},S$m._clear=function(){for(var S$a=this._texCount=0;S$a<this._height;S$a++)this._rowInfo[S$a].spaceCount=this._width;for(var S$m=0;S$m<this._height;S$m++)for(var S$s=0;S$s<this._width;S$s++){var S$P=3*(S$m*this._width+S$s);this._cells[S$P]=0,this._cells[1+S$P]=this._width-S$s,this._cells[2+S$P]=this._width-S$m}this._failSize.width=this._width+1,this._failSize.height=this._height+1},S$a.__init$=function(){S$P=function(){function S$a(){this.spaceCount=0}return S$d(S$a,""),S$a}(),S$_=function(){function S$a(){this.width=0,this.height=0}return S$d(S$a,""),S$a}()},S$a}(),S$F=function(){function S$O(S$a,S$m,S$s,S$P){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=S$a,this._height=S$m,this._gridSize=S$s,this._maxAtlaserCount=S$P,this._gridNumX=S$a/S$s,this._gridNumY=S$m/S$s,this._curAtlasIndex=0,this._atlaserArray=[]}S$d(S$O,"laya.webgl.atlas.AtlasResourceManager");var S$a=S$O.prototype;return S$a.setAtlasParam=function(S$a,S$m,S$s,S$P){if(1==this._setAtlasParam)return S$O._sid_=0,this._width=S$a,this._height=S$m,this._gridSize=S$s,this._maxAtlaserCount=S$P,this._gridNumX=S$a/S$s,this._gridNumY=S$m/S$s,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},S$a.pushData=function(S$a){var S$m,S$s=S$a.bitmap,S$P=-1,S$_=null,S$e=0,S$A=0;for(S$e=0,S$m=this._atlaserArray.length;S$e<S$m&&(S$A=(this._curAtlasIndex+S$e)%S$m,-1==(S$P=(S$_=this._atlaserArray[S$A]).findBitmapIsExist(S$s)));S$e++);if(-1!=S$P){var S$B=S$_.InAtlasWebGLImagesOffsetValue[S$P];return S$q=S$B[0],S$h=S$B[1],S$_.addToAtlas(S$a,S$q,S$h),!0}this._setAtlasParam=!1;for(var S$k=Math.ceil((S$a.bitmap.width+2)/this._gridSize),S$j=Math.ceil((S$a.bitmap.height+2)/this._gridSize),S$G=!1,S$y=0;S$y<2;S$y++){var S$d=this._maxAtlaserCount;for(S$e=0;S$e<S$d;S$e++){S$A=(this._curAtlasIndex+S$e)%S$d,this._atlaserArray.length-1>=S$A||this._atlaserArray.push(new S$fa(this._gridNumX,this._gridNumY,this._width,this._height,S$O._sid_++));var S$Q=this._atlaserArray[S$A],S$q=0,S$h=0,S$u=S$Q.addTex(1,S$k,S$j);if(S$u.ret){S$q=S$u.x*this._gridSize+1,S$h=S$u.y*this._gridSize+1,S$s.lock=!0,S$Q.addToAtlasTexture(S$s,S$q,S$h),S$Q.addToAtlas(S$a,S$q,S$h),S$G=!0,this._curAtlasIndex=S$A;break}}if(S$G)break;this._atlaserArray.push(new S$fa(this._gridNumX,this._gridNumY,this._width,this._height,S$O._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return S$G||console.log(">>>AtlasManager pushData error"),S$G},S$a.addToAtlas=function(S$a){laya.webgl.atlas.AtlasResourceManager.instance.pushData(S$a)},S$a.garbageCollection=function(){if(!0===this._needGC){for(var S$a=this._atlaserArray.length-this._maxAtlaserCount,S$m=0;S$m<S$a;S$m++)this._atlaserArray[S$m].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+S$a),this._atlaserArray.splice(0,S$a),this._needGC=!1}return!0},S$a.freeAll=function(){for(var S$a=0,S$m=this._atlaserArray.length;S$a<S$m;S$a++)this._atlaserArray[S$a].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},S$a.getAtlaserCount=function(){return this._atlaserArray.length},S$a.getAtlaserByIndex=function(S$a){return this._atlaserArray[S$a]},S$P(1,S$O,"instance",function(){return S$O._Instance||(S$O._Instance=new S$O(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),S$O._Instance}),S$P(1,S$O,"enabled",function(){return S$z.atlasEnable}),S$P(1,S$O,"atlasLimitWidth",function(){return S$O._atlasLimitWidth},function(S$a){S$O._atlasLimitWidth=S$a}),S$P(1,S$O,"atlasLimitHeight",function(){return S$O._atlasLimitHeight},function(S$a){S$O._atlasLimitHeight=S$a}),S$O._enable=function(){S$z.atlasEnable=!0},S$O._disable=function(){S$z.atlasEnable=!1},S$O.__init__=function(){S$O.atlasTextureWidth=2048,S$O.atlasTextureHeight=2048,S$O.maxTextureCount=6,S$O.atlasLimitWidth=512,S$O.atlasLimitHeight=512},S$O._atlasLimitWidth=0,S$O._atlasLimitHeight=0,S$O.gridSize=16,S$O.atlasTextureWidth=0,S$O.atlasTextureHeight=0,S$O.maxTextureCount=0,S$O._atlasRestore=0,S$O.BOARDER_TYPE_NO=0,S$O.BOARDER_TYPE_RIGHT=1,S$O.BOARDER_TYPE_LEFT=2,S$O.BOARDER_TYPE_BOTTOM=4,S$O.BOARDER_TYPE_TOP=8,S$O.BOARDER_TYPE_ALL=15,S$O._sid_=0,S$O._Instance=null,S$O}(),S$x=function(){function S$a(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return S$d(S$a,"laya.webgl.atlas.MergeFillInfo"),S$a}(),S$M=function(){function S$m(){}return S$d(S$m,"laya.webgl.canvas.BlendMode"),S$m._init_=function(S$a){S$m.fns=[S$m.BlendNormal,S$m.BlendAdd,S$m.BlendMultiply,S$m.BlendScreen,S$m.BlendOverlay,S$m.BlendLight,S$m.BlendMask,S$m.BlendDestinationOut],S$m.targetFns=[S$m.BlendNormalTarget,S$m.BlendAddTarget,S$m.BlendMultiplyTarget,S$m.BlendScreenTarget,S$m.BlendOverlayTarget,S$m.BlendLightTarget,S$m.BlendMask,S$m.BlendDestinationOut]},S$m.BlendNormal=function(S$a){S$a.blendFunc(1,771)},S$m.BlendAdd=function(S$a){S$a.blendFunc(1,772)},S$m.BlendMultiply=function(S$a){S$a.blendFunc(774,771)},S$m.BlendScreen=function(S$a){S$a.blendFunc(1,1)},S$m.BlendOverlay=function(S$a){S$a.blendFunc(1,769)},S$m.BlendLight=function(S$a){S$a.blendFunc(1,1)},S$m.BlendNormalTarget=function(S$a){S$a.blendFunc(1,771)},S$m.BlendAddTarget=function(S$a){S$a.blendFunc(1,772)},S$m.BlendMultiplyTarget=function(S$a){S$a.blendFunc(774,771)},S$m.BlendScreenTarget=function(S$a){S$a.blendFunc(1,1)},S$m.BlendOverlayTarget=function(S$a){S$a.blendFunc(1,769)},S$m.BlendLightTarget=function(S$a){S$a.blendFunc(1,1)},S$m.BlendMask=function(S$a){S$a.blendFunc(0,770)},S$m.BlendDestinationOut=function(S$a){S$a.blendFunc(0,0)},S$m.activeBlendFunction=null,S$m.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],S$m.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},S$m.NORMAL="normal",S$m.ADD="add",S$m.MULTIPLY="multiply",S$m.SCREEN="screen",S$m.LIGHT="light",S$m.OVERLAY="overlay",S$m.DESTINATIONOUT="destination-out",S$m.fns=[],S$m.targetFns=[],S$m}(),S$J=function(){function S$s(S$a){this._color=S$q.create("black"),this.setValue(S$a)}S$d(S$s,"laya.webgl.canvas.DrawStyle");var S$a=S$s.prototype;return S$a.setValue=function(S$a){if(S$a){if("string"==typeof S$a)return void(this._color=S$q.create(S$a));if(S$a instanceof laya.utils.Color)return void(this._color=S$a)}},S$a.reset=function(){this._color=S$q.create("black")},S$a.equal=function(S$a){return"string"==typeof S$a?this._color.strColor===S$a:S$a instanceof laya.utils.Color&&this._color.numColor===S$a.numColor},S$a.toColorStr=function(){return this._color.strColor},S$s.create=function(S$a){var S$m;if(S$a&&("string"==typeof S$a?S$m=S$q.create(S$a):S$a instanceof laya.utils.Color&&(S$m=S$a),S$m))return S$m._drawStyle||(S$m._drawStyle=new S$s(S$a));return laya.webgl.canvas.DrawStyle.DEFAULT},S$A(S$s,["DEFAULT",function(){return this.DEFAULT=new S$s("#000000")}]),S$s}(),S$D=function(){function S$a(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];S$Ha.mainContext;this.ib=S$na.create(35048),this.vb=S$ra.create(5)}S$d(S$a,"laya.webgl.canvas.Path");var S$m=S$a.prototype;return S$m.addPoint=function(S$a,S$m){this.tempArray.push(S$a,S$m)},S$m.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},S$m.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},S$m.polygon=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A;return this.geomatrys.push(this._curGeomatry=S$A=new S$ba(S$a,S$m,S$s,S$P,S$_,S$e)),S$P||(S$A.fill=!1),null==S$e&&(S$A.borderWidth=0),S$A},S$m.setGeomtry=function(S$a){this.geomatrys.push(this._curGeomatry=S$a)},S$m.drawLine=function(S$a,S$m,S$s,S$P,S$_){var S$e;return this.closePath?this.geomatrys.push(this._curGeomatry=S$e=new S$Wa(S$a,S$m,S$s,S$P,S$_)):this.geomatrys.push(this._curGeomatry=S$e=new S$Va(S$a,S$m,S$s,S$P,S$_)),S$e.fill=!1,S$e},S$m.update=function(){var S$a=this.ib._byteLength,S$m=this.geomatrys.length;this.offset=S$a;for(var S$s=this.geoStart;S$s<S$m;S$s++)this.geomatrys[S$s].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=S$m,this.count=(this.ib._byteLength-S$a)/S$ha.BYTES_PIDX},S$m.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},S$m.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},S$a}(),S$g=function(){function S$B(){}S$d(S$B,"laya.webgl.canvas.save.SaveBase");var S$a=S$B.prototype;return S$N.imps(S$a,{"laya.webgl.canvas.save.ISaveData":!0}),S$a.isSaveMark=function(){return!1},S$a.restore=function(S$a){this._dataObj[this._valueName]=this._value,(S$B._cache[S$B._cache._length++]=this)._newSubmit&&(S$a._curSubmit=S$ea.RENDERBASE,S$a._renderKey=0)},S$B._createArray=function(){var S$a=[];return S$a._length=0,S$a},S$B._init=function(){var S$a=S$B._namemap={};return S$a[1]="ALPHA",S$a[2]="fillStyle",S$a[8]="font",S$a[256]="lineWidth",S$a[512]="strokeStyle",S$a[8192]="_mergeID",S$a[1024]=S$a[2048]=S$a[4096]=[],S$a[16384]="textBaseline",S$a[32768]="textAlign",S$a[65536]="_nBlendType",S$a[1048576]="shader",S$a[2097152]="filters",S$a},S$B.save=function(S$a,S$m,S$s,S$P){if((S$a._saveMark._saveuse&S$m)!==S$m){S$a._saveMark._saveuse|=S$m;var S$_=S$B._cache,S$e=0<S$_._length?S$_[--S$_._length]:new S$B;S$e._value=S$s[S$e._valueName=S$B._namemap[S$m]],S$e._dataObj=S$s,S$e._newSubmit=S$P;var S$A=S$a._save;S$A[S$A._length++]=S$e}},S$B._cache=laya.webgl.canvas.save.SaveBase._createArray(),S$B._namemap=S$B._init(),S$B}(),S$w=function(){function S$e(){this._clipRect=new S$f}S$d(S$e,"laya.webgl.canvas.save.SaveClipRect");var S$a=S$e.prototype;return S$N.imps(S$a,{"laya.webgl.canvas.save.ISaveData":!0}),S$a.isSaveMark=function(){return!1},S$a.restore=function(S$a){S$a._clipRect=this._clipSaveRect,(S$e._cache[S$e._cache._length++]=this)._submitScissor.submitLength=S$a._submits._length-this._submitScissor.submitIndex,S$a._curSubmit=S$ea.RENDERBASE,S$a._renderKey=0},S$e.save=function(S$a,S$m){if(131072!=(131072&S$a._saveMark._saveuse)){S$a._saveMark._saveuse|=131072;var S$s=S$e._cache,S$P=0<S$s._length?S$s[--S$s._length]:new S$e;S$P._clipSaveRect=S$a._clipRect,S$a._clipRect=S$P._clipRect.copyFrom(S$a._clipRect),S$P._submitScissor=S$m;var S$_=S$a._save;S$_[S$_._length++]=S$P}},S$A(S$e,["_cache",function(){return this._cache=S$g._createArray()}]),S$e}(),S$v=function(){function S$Q(){this._contextX=0,this._contextY=0,this._clipRect=new S$f,this._rect=new S$f,this._matrix=new S$l}S$d(S$Q,"laya.webgl.canvas.save.SaveClipRectStencil");var S$a=S$Q.prototype;return S$N.imps(S$a,{"laya.webgl.canvas.save.ISaveData":!0}),S$a.isSaveMark=function(){return!1},S$a.restore=function(S$a){S$Ga.restore(S$a,this._rect,this._saveMatrix,this._contextX,this._contextY),S$a._clipRect=this._clipSaveRect,S$a._curMat=this._saveMatrix,S$a._x=this._contextX,S$a._y=this._contextY,S$Q._cache[S$Q._cache._length++]=this,S$a._curSubmit=S$ea.RENDERBASE},S$Q.save=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){if(262144!=(262144&S$a._saveMark._saveuse)){S$a._saveMark._saveuse|=262144;var S$G=S$Q._cache,S$y=0<S$G._length?S$G[--S$G._length]:new S$Q;S$y._clipSaveRect=S$a._clipRect,S$y._clipRect.setTo(S$A,S$B,S$k,S$j),S$a._clipRect=S$y._clipRect,S$y._rect.x=S$s,S$y._rect.y=S$P,S$y._rect.width=S$_,S$y._rect.height=S$e,S$y._contextX=S$a._x,S$y._contextY=S$a._y,S$y._saveMatrix=S$a._curMat,S$a._curMat.copyTo(S$y._matrix),S$a._curMat=S$y._matrix,S$y._submitStencil=S$m;var S$d=S$a._save;S$d[S$d._length++]=S$y}},S$A(S$Q,["_cache",function(){return this._cache=S$g._createArray()}]),S$Q}(),S$Y=function(){function S$P(){this._saveuse=0}S$d(S$P,"laya.webgl.canvas.save.SaveMark");var S$a=S$P.prototype;return S$N.imps(S$a,{"laya.webgl.canvas.save.ISaveData":!0}),S$a.isSaveMark=function(){return!0},S$a.restore=function(S$a){S$a._saveMark=this._preSaveMark,S$P._no[S$P._no._length++]=this},S$P.Create=function(S$a){var S$m=S$P._no,S$s=0<S$m._length?S$m[--S$m._length]:new S$P;return S$s._saveuse=0,S$s._preSaveMark=S$a._saveMark,S$a._saveMark=S$s},S$A(S$P,["_no",function(){return this._no=S$g._createArray()}]),S$P}(),S$T=function(){function S$e(){this._matrix=new S$l}S$d(S$e,"laya.webgl.canvas.save.SaveTransform");var S$a=S$e.prototype;return S$N.imps(S$a,{"laya.webgl.canvas.save.ISaveData":!0}),S$a.isSaveMark=function(){return!1},S$a.restore=function(S$a){S$a._curMat=this._savematrix,S$e._no[S$e._no._length++]=this},S$e.save=function(S$a){var S$m=S$a._saveMark;if(2048!=(2048&S$m._saveuse)){S$m._saveuse|=2048;var S$s=S$e._no,S$P=0<S$s._length?S$s[--S$s._length]:new S$e;S$P._savematrix=S$a._curMat,S$a._curMat=S$a._curMat.copyTo(S$P._matrix);var S$_=S$a._save;S$_[S$_._length++]=S$P}},S$A(S$e,["_no",function(){return this._no=S$g._createArray()}]),S$e}(),S$I=function(){function S$_(){}S$d(S$_,"laya.webgl.canvas.save.SaveTranslate");var S$a=S$_.prototype;return S$N.imps(S$a,{"laya.webgl.canvas.save.ISaveData":!0}),S$a.isSaveMark=function(){return!1},S$a.restore=function(S$a){S$a._curMat;S$a._x=this._x,S$a._y=this._y,S$_._no[S$_._no._length++]=this},S$_.save=function(S$a){var S$m=S$_._no,S$s=0<S$m._length?S$m[--S$m._length]:new S$_;S$s._x=S$a._x,S$s._y=S$a._y;var S$P=S$a._save;S$P[S$P._length++]=S$s},S$A(S$_,["_no",function(){return this._no=S$g._createArray()}]),S$_}(),S$$=function(){function S$a(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new S$f}S$d(S$a,"laya.webgl.resource.RenderTargetMAX");var S$m=S$a.prototype;return S$m.setSP=function(S$a){this._sp=S$a},S$m.size=function(S$a,S$m){var S$s=this;this._width!==S$a||this._height!==S$m?(this.repaint=!0,this._width=S$a,this._height=S$m,this.target?this.target.size(S$a,S$m):this.target=S$ia.create(S$a,S$m),this.target.hasListener("recovered")||this.target.on("recovered",this,function(S$a){S$N.timer.callLater(S$s._sp,S$s._sp.repaint)})):this.target.size(S$a,S$m)},S$m._flushToTarget=function(S$a,S$m){if(!S$m._destroy){var S$s=S$pa.worldScissorTest,S$P=S$pa.worldClipRect;S$pa.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,S$pa.worldScissorTest=!1,S$Ha.mainContext.disable(3089);var S$_=S$pa.worldAlpha,S$e=S$pa.worldMatrix4,S$A=S$pa.worldMatrix,S$B=S$pa.worldFilters,S$k=S$pa.worldShaderDefines;if(S$pa.worldMatrix=S$l.EMPTY,S$pa.restoreTempArray(),S$pa.worldMatrix4=S$pa.TEMPMAT4_ARRAY,S$pa.worldAlpha=1,S$pa.worldFilters=null,S$pa.worldShaderDefines=null,S$Ea.activeShader=null,S$m.start(),S$z.showCanvasMark?S$m.clear(0,1,0,.3):S$m.clear(0,0,0,0),S$a.flush(),S$m.end(),S$Ea.activeShader=null,S$pa.worldAlpha=S$_,S$pa.worldMatrix4=S$e,S$pa.worldMatrix=S$A,S$pa.worldFilters=S$B,S$pa.worldShaderDefines=S$k,S$pa.worldScissorTest=S$s){var S$j=S$pa.height-S$P.y-S$P.height;S$Ha.mainContext.scissor(S$P.x,S$j,S$P.width,S$P.height),S$Ha.mainContext.enable(3089)}S$pa.worldClipRect=S$P}},S$m.flush=function(S$a){this.repaint&&(this._flushToTarget(S$a,this.target),this.repaint=!1)},S$m.drawTo=function(S$a,S$m,S$s,S$P,S$_){S$a.drawTexture(this.target.getTexture(),S$m,S$s,S$P,S$_,0,0)},S$m.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},S$a}(),S$n=function(){function S$a(){this.ALPHA=1,this.shaderType=0,this.defines=new S$Ka}return S$d(S$a,"laya.webgl.shader.d2.Shader2D"),S$a.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},S$a.__init__=function(){var S$a,S$m;S$Ya.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),S$Ya.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),S$Ya.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),S$Ya.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),S$Ya.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),S$Ya.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),S$Ya.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),S$Ya.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),S$a="attribute vec4 position;\n",S$a+="attribute vec2 texcoord;\n",S$a+="uniform vec2 size;\n\n",S$a+="#ifdef WORLDMAT\n",S$a+="  uniform mat4 mmat;\n",S$a+="#endif\n",S$a+="varying vec2 v_texcoord;\n",S$a+="void main() {\n",S$a+="  #ifdef WORLDMAT\n",S$a+="  vec4 pos=mmat*position;\n",S$a+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",S$a+="  #else\n",S$a+="  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n",S$a+="  #endif\n\n",S$a+="  v_texcoord = texcoord;\n",S$a+="}",S$m="precision mediump float;\n",S$m+="varying vec2 v_texcoord;\n",S$m+="uniform sampler2D texture;\n\n",S$m+="#ifdef COLORMUL\n",S$m+="  uniform vec4 colorMul;\n",S$m+="#endif\n\n",S$m+="#ifdef TXTALPHA\n",S$m+="  uniform sampler2D texture1;\n",S$m+="#endif\n\n",S$m+="uniform float alpha;\n",S$m+='#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n',S$m+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',S$m+='#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n',S$m+='#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\n',S$m+="void main() {\n",S$m+="   vec4 color= texture2D(texture, v_texcoord);\n\n",S$m+="   #ifdef TXTCOMPRESS\n",S$m+="      color.rgb *= color.a;\n",S$m+="   #endif\n\n",S$m+="   #ifdef TXTALPHA\n",S$m+="      color.rgba *= texture2D(texture1, v_texcoord).a;\n",S$m+="   #endif\n\n",S$m+="   color.a*=alpha;\n",S$m+="   color.rgb*=alpha;\n",S$m+="   #ifdef COLORMUL\n",S$m+="      color.rgba *= colorMul;\n",S$m+="   #endif\n\n",S$m+="   gl_FragColor=color;\n",S$m+='   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";\n',S$m+='   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n',S$m+='   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',S$m+='   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n',S$m+="}",S$Ya.preCompile2D(0,1,S$a,S$m,null),S$a="attribute vec4 position;\n",S$a+="uniform vec2 size;\n",S$a+="uniform mat4 mmat;\n",S$a+="void main() {\n",S$a+="  vec4 pos=mmat*position;\n",S$a+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",S$a+="}",S$m="precision mediump float;\n",S$m+="uniform vec4 color;\n",S$m+="uniform float alpha;\n",S$m+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',S$m+="void main() {\n",S$m+="\t vec4 a = vec4(color.r, color.g, color.b, color.a);\n",S$m+="\t a.w = alpha;\n",S$m+="\t a.xyz *= alpha;\n",S$m+="\t gl_FragColor = a;\n",S$m+='\t #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',S$m+="}",S$Ya.preCompile2D(0,2,S$a,S$m,null),S$a="attribute vec4 position;\n",S$a+="attribute vec3 a_color;\n",S$a+="uniform mat4 mmat;\n",S$a+="uniform mat4 u_mmat2;\n",S$a+="uniform vec2 u_pos;\n",S$a+="uniform vec2 size;\n",S$a+="varying vec3 color;\n",S$a+="void main(){\n",S$a+="  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n",S$a+="  vec4 pos=mmat*u_mmat2*tPos;\n",S$a+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",S$a+="  color=a_color;\n",S$a+="}",S$m="precision mediump float;\n",S$m+="varying vec3 color;\n",S$m+="uniform float alpha;\n",S$m+="void main(){\n",S$m+="  gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n",S$m+="\t gl_FragColor.rgb*=alpha;\n",S$m+="}",S$Ya.preCompile2D(0,4,S$a,S$m,null),S$a="attribute vec4 position;\n",S$a+="attribute vec2 texcoord;\n",S$a+="uniform vec2 size;\n\n",S$a+="#ifdef WORLDMAT\n",S$a+="  uniform mat4 mmat;\n",S$a+="#endif\n",S$a+="varying vec2 v_texcoord;\n",S$a+="void main() {\n",S$a+="  #ifdef WORLDMAT\n",S$a+="    vec4 pos=mmat*position;\n",S$a+="    gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",S$a+="  #else\n",S$a+="    gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n",S$a+="  #endif\n\n",S$a+="  v_texcoord = texcoord;\n",S$a+="}",S$m="#ifdef FSHIGHPRECISION\n",S$m+="   precision highp float;\n",S$m+="#else\n",S$m+="   precision mediump float;\n",S$m+="#endif\n",S$m+="varying vec2 v_texcoord;\n",S$m+="uniform sampler2D texture;\n\n",S$m+="#ifdef TXTALPHA\n",S$m+="   uniform sampler2D texture1;\n",S$m+="#endif\n\n",S$m+="uniform float alpha;\n",S$m+="uniform vec4 u_TexRange;\n",S$m+="uniform vec2 u_offset;\n",S$m+='#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n',S$m+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',S$m+='#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n',S$m+='#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\n',S$m+="void main() {\n",S$m+="   vec2 newTexCoord;\n",S$m+="   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n",S$m+="   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n",S$m+="   vec4 color= texture2D(texture, newTexCoord);\n\n",S$m+="   #ifdef TXTALPHA\n",S$m+="      color.a = texture2D(texture1, newTexCoord).a;\n",S$m+="   #endif\n\n",S$m+="   color.a*=alpha;\n",S$m+="   gl_FragColor=color;\n",S$m+='   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";\n',S$m+='   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n',S$m+='   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',S$m+='   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n',S$m+="}",S$Ya.preCompile2D(0,256,S$a,S$m,null),S$a="attribute vec2 position;\n",S$a+="attribute vec2 texcoord;\n",S$a+="attribute vec4 color;\n",S$a+="uniform vec2 size;\n",S$a+="uniform float offsetX;\n",S$a+="uniform float offsetY;\n",S$a+="uniform mat4 mmat;\n",S$a+="uniform mat4 u_mmat2;\n",S$a+="varying vec2 v_texcoord;\n",S$a+="varying vec4 v_color;\n",S$a+="void main() {\n",S$a+="  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n",S$a+="  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",S$a+="  v_color = color;\n",S$a+="  v_color.rgb *= v_color.a;\n",S$a+="  v_texcoord = texcoord;  \n",S$a+="}",S$m="precision mediump float;\n",S$m+="varying vec2 v_texcoord;\n",S$m+="varying vec4 v_color;\n",S$m+="uniform sampler2D texture;\n\n",S$m+="#ifdef TXTALPHA\n",S$m+="  uniform sampler2D texture1;\n",S$m+="#endif\n\n",S$m+="uniform float alpha;\n",S$m+="void main() {\n",S$m+="\t vec4 t_color = texture2D(texture, v_texcoord);\n\n",S$m+="  #ifdef TXTALPHA\n",S$m+="    t_color.a = texture2D(texture1, v_texcoord).a;\n",S$m+="  #endif\n\n",S$m+="\t gl_FragColor = t_color.rgba * v_color;\n",S$m+="\t gl_FragColor *= alpha;\n",S$m+="}",S$Ya.preCompile2D(0,512,S$a,S$m,null)},S$a}(),S$r=function(){function S$m(S$a,S$m,S$s){this._value=0,this._name2int=S$a,this._int2name=S$m,this._int2nameMap=S$s}S$d(S$m,"laya.webgl.shader.ShaderDefines");var S$a=S$m.prototype;return S$a.add=function(S$a){return"string"==typeof S$a&&(S$a=this._name2int[S$a]),this._value|=S$a,this._value},S$a.addInt=function(S$a){return this._value|=S$a,this._value},S$a.remove=function(S$a){return"string"==typeof S$a&&(S$a=this._name2int[S$a]),this._value&=~S$a,this._value},S$a.isDefine=function(S$a){return(this._value&S$a)===S$a},S$a.getValue=function(){return this._value},S$a.setValue=function(S$a){this._value=S$a},S$a.toNameDic=function(){var S$a=this._int2nameMap[this._value];return S$a||S$m._toText(this._value,this._int2name,this._int2nameMap)},S$m._reg=function(S$a,S$m,S$s,S$P){S$P[S$s[S$a]=S$m]=S$a},S$m._toText=function(S$a,S$m,S$s){var S$P=S$s[S$a];if(S$P)return S$P;for(var S$_={},S$e=1,S$A=0;S$A<32&&!(S$a<(S$e=1<<S$A));S$A++)if(S$a&S$e){var S$B=S$m[S$e];S$B&&(S$_[S$B]="")}return S$s[S$a]=S$_},S$m._toInt=function(S$a,S$m){for(var S$s=S$a.split("."),S$P=0,S$_=0,S$e=S$s.length;S$_<S$e;S$_++){var S$A=S$m[S$s[S$_]];if(!S$A)throw new Error("Defines to int err:"+S$a+"/"+S$s[S$_]);S$P|=S$A}return S$P},S$m}(),S$aa=function(){function S$A(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new S$l}S$d(S$A,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var S$a=S$A.prototype;return S$a.init=function(S$a,S$m,S$s){if(S$m)this._vs=S$m;else{this._vs=[];var S$P=S$a.width,S$_=S$a.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(S$P,0,1,0,1,1,1,1),this._vs.push(S$P,S$_,1,1,1,1,1,1),this._vs.push(0,S$_,0,1,1,1,1,1)}S$s?this._ps=S$s:(S$A._defaultPS||(S$A._defaultPS=[]).push(0,1,3,3,1,2),this._ps=S$A._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=S$a},S$a.init2=function(S$a,S$m,S$s,S$P,S$_){this.transform&&(this.transform=null),S$s?this._ps=S$s:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=S$P,this._uvs=S$_,this.mEleNum=this._ps.length,this.mTexture=S$a,(S$O.isConchNode||S$O.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},S$a._initMyData=function(){var S$a=0,S$m=0,S$s=4*this._verticles.length;this._vs=S$A._tempVS;var S$P=!1;if(S$O.isConchNode||S$O.isConchApp?(this._vs.length=S$s,S$P=!0):this._vs.length<S$s&&(this._vs.length=S$s,S$P=!0),S$A._tVSLen=S$s,S$P)for(;S$a<S$s;)this._vs[S$a]=this._verticles[S$m],this._vs[S$a+1]=this._verticles[S$m+1],this._vs[S$a+2]=this._uvs[S$m],this._vs[S$a+3]=this._uvs[S$m+1],this._vs[S$a+4]=1,this._vs[S$a+5]=1,this._vs[S$a+6]=1,this._vs[S$a+7]=1,S$a+=8,S$m+=2;else for(;S$a<S$s;)this._vs[S$a]=this._verticles[S$m],this._vs[S$a+1]=this._verticles[S$m+1],this._vs[S$a+2]=this._uvs[S$m],this._vs[S$a+3]=this._uvs[S$m+1],S$a+=8,S$m+=2},S$a.getData2=function(S$a,S$m,S$s){var S$P;this.mVBBuffer=S$a,this.mIBBuffer=S$m,this._initMyData(),S$a.appendEx2(this._vs,Float32Array,S$A._tVSLen,4),this._indexStart=S$m._byteLength,(S$P=S$A._tempIB).length<this._ps.length&&(S$P.length=this._ps.length);for(var S$_=0,S$e=this._ps.length;S$_<S$e;S$_++)S$P[S$_]=this._ps[S$_]+S$s;S$m.appendEx2(S$P,Uint16Array,this._ps.length,2)},S$a.getData=function(S$a,S$m,S$s){if(this.mVBBuffer=S$a,this.mIBBuffer=S$m,S$a.append(this.mVBData),this._indexStart=S$m._byteLength,this.mIBData.start!=S$s){for(var S$P=0,S$_=this._ps.length;S$P<S$_;S$P++)this.mIBData[S$P]=this._ps[S$P]+S$s;this.mIBData.start=S$s}S$m.append(this.mIBData)},S$a.render=function(S$a,S$m,S$s){if(S$O.isWebGL&&this.mTexture){S$a._renderKey=0,S$a._shader2D.glTexture=null,S$ma.getInstance().addSkinMesh(this);var S$P=S$ea.createShape(S$a,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,S$Ua.create(512,0));this.transform||(this.transform=S$l.EMPTY),this.transform.translate(S$m,S$s),S$l.mul(this.transform,S$a._curMat,this._tempMatrix),this.transform.translate(-S$m,-S$s);var S$_=S$P.shaderValue,S$e=S$_.u_mmat2||S$pa.getMatrArray();S$pa.mat2MatArray(this._tempMatrix,S$e),S$_.textureHost=this.mTexture,S$_.offsetX=0,S$_.offsetY=0,S$_.u_mmat2=S$e,S$_.ALPHA=S$a._shader2D.ALPHA,S$a._submits[S$a._submits._length++]=S$P}else S$O.isConchApp&&this.mTexture&&(this.transform||(this.transform=S$l.EMPTY),S$a.setSkinMesh&&S$a.setSkinMesh(S$m,S$s,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},S$A._tempVS=[],S$A._tempIB=[],S$A._defaultPS=null,S$A._tVSLen=0,S$A}(),S$ma=function(){function S$a(){this.ib=null,this.vb=null;S$Ha.mainContext;this.ib=S$na.create(35048),this.vb=S$ra.create(8)}S$d(S$a,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var S$m=S$a.prototype;return S$m.addSkinMesh=function(S$a){S$a.getData2(this.vb,this.ib,this.vb._byteLength/32)},S$m.reset=function(){this.vb.clear(),this.ib.clear()},S$a.getInstance=function(){return S$a.instance=S$a.instance||new S$a},S$a.instance=null,S$a}(),S$sa=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===S$k&&(S$k=0),this.x=S$a,this.y=S$m,this.width=S$s,this.height=S$P,this.edges=S$_,this.color=S$e,this.borderWidth=S$A,this.borderColor=S$B}S$d(S$a,"laya.webgl.shapes.BasePoly");var S$m=S$a.prototype;return S$N.imps(S$m,{"laya.webgl.shapes.IShape":!0}),S$m.getData=function(S$a,S$m,S$s){},S$m.rebuild=function(S$a){},S$m.setMatrix=function(S$a){},S$m.needUpdate=function(S$a){return!0},S$m.sector=function(S$a,S$m,S$s){var S$P=this.x,S$_=this.y,S$e=this.edges,S$A=(this.r1-this.r0)/S$e,S$B=this.width,S$k=this.height,S$j=this.color,S$G=(S$j>>16&255)/255,S$y=(S$j>>8&255)/255,S$d=(255&S$j)/255;S$a.push(S$P,S$_,S$G,S$y,S$d);for(var S$Q=0;S$Q<S$e+1;S$Q++)S$a.push(S$P+Math.sin(S$A*S$Q+this.r0)*S$B,S$_+Math.cos(S$A*S$Q+this.r0)*S$k),S$a.push(S$G,S$y,S$d);for(S$Q=0;S$Q<S$e;S$Q++)S$m.push(S$s,S$s+S$Q+1,S$s+S$Q+2)},S$m.createLine2=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A,S$B,S$k,S$j,S$G,S$y,S$d,S$Q,S$q,S$h,S$u,S$O,S$p,S$c,S$H,S$o,S$N,S$z,S$U,S$l,S$C=S$a.concat(),S$f=S$_,S$K=this.borderColor,S$V=(S$K>>16&255)/255,S$W=(S$K>>8&255)/255,S$b=(255&S$K)/255,S$S=S$C.length/2,S$Z=S$P,S$X=S$s/2;S$k=S$C[0],S$j=S$C[1],S$h=S$k-(S$G=S$C[2]),S$q=(S$q=-(S$j-(S$y=S$C[3])))/(S$l=Math.sqrt(S$q*S$q+S$h*S$h))*S$X,S$h=S$h/S$l*S$X,S$f.push(S$k-S$q+this.x,S$j-S$h+this.y,S$V,S$W,S$b,S$k+S$q+this.x,S$j+S$h+this.y,S$V,S$W,S$b);for(var S$E=1;S$E<S$S-1;S$E++)S$k=S$C[2*(S$E-1)],S$j=S$C[2*(S$E-1)+1],S$G=S$C[2*S$E],S$y=S$C[2*S$E+1],S$d=S$C[2*(S$E+1)],S$Q=S$C[2*(S$E+1)+1],S$h=S$k-S$G,S$O=S$G-S$d,S$H=(-(S$q=(S$q=-(S$j-S$y))/(S$l=Math.sqrt(S$q*S$q+S$h*S$h))*S$X)+S$k)*(-(S$h=S$h/S$l*S$X)+S$y)-(-S$q+S$G)*(-S$h+S$j),S$z=(-(S$u=(S$u=-(S$y-S$Q))/(S$l=Math.sqrt(S$u*S$u+S$O*S$O))*S$X)+S$d)*(-(S$O=S$O/S$l*S$X)+S$y)-(-S$u+S$G)*(-S$O+S$Q),S$U=(S$p=-S$h+S$j-(-S$h+S$y))*(S$N=-S$u+S$G-(-S$u+S$d))-(S$o=-S$O+S$Q-(-S$O+S$y))*(S$c=-S$q+S$G-(-S$q+S$k)),Math.abs(S$U)<.1?(S$U+=10.1,S$f.push(S$G-S$q+this.x,S$y-S$h+this.y,S$V,S$W,S$b,S$G+S$q+this.x,S$y+S$h+this.y,S$V,S$W,S$b)):(((S$A=(S$c*S$z-S$N*S$H)/S$U)-S$G)*(S$A-S$G)+((S$B=(S$o*S$H-S$p*S$z)/S$U)-S$y)+(S$B-S$y),S$f.push(S$A+this.x,S$B+this.y,S$V,S$W,S$b,S$G-(S$A-S$G)+this.x,S$y-(S$B-S$y)+this.y,S$V,S$W,S$b));S$k=S$C[S$C.length-4],S$j=S$C[S$C.length-3],S$h=S$k-(S$G=S$C[S$C.length-2]),S$q=(S$q=-(S$j-(S$y=S$C[S$C.length-1])))/(S$l=Math.sqrt(S$q*S$q+S$h*S$h))*S$X,S$h=S$h/S$l*S$X,S$f.push(S$G-S$q+this.x,S$y-S$h+this.y,S$V,S$W,S$b,S$G+S$q+this.x,S$y+S$h+this.y,S$V,S$W,S$b);var S$i=S$e;for(S$E=1;S$E<S$i;S$E++)S$m.push(S$Z+2*(S$E-1),S$Z+2*(S$E-1)+1,S$Z+2*S$E+1,S$Z+2*S$E+1,S$Z+2*S$E,S$Z+2*(S$E-1));return S$f},S$m.createLine=function(S$a,S$m,S$s,S$P){var S$_=S$a.concat(),S$e=S$a,S$A=this.borderColor,S$B=(S$A>>16&255)/255,S$k=(S$A>>8&255)/255,S$j=(255&S$A)/255;S$_.splice(0,5);var S$G,S$y,S$d,S$Q,S$q,S$h,S$u,S$O,S$p,S$c,S$H,S$o,S$N,S$z,S$U,S$l,S$C,S$f,S$K,S$V,S$W=S$_.length/5,S$b=S$P,S$S=S$s/2;S$d=S$_[0],S$Q=S$_[1],S$c=S$d-(S$q=S$_[5]),S$p=(S$p=-(S$Q-(S$h=S$_[6])))/(S$V=Math.sqrt(S$p*S$p+S$c*S$c))*S$S,S$c=S$c/S$V*S$S,S$e.push(S$d-S$p,S$Q-S$c,S$B,S$k,S$j,S$d+S$p,S$Q+S$c,S$B,S$k,S$j);for(var S$Z=1;S$Z<S$W-1;S$Z++)S$d=S$_[5*(S$Z-1)],S$Q=S$_[5*(S$Z-1)+1],S$q=S$_[5*S$Z],S$h=S$_[5*S$Z+1],S$u=S$_[5*(S$Z+1)],S$O=S$_[5*(S$Z+1)+1],S$c=S$d-S$q,S$o=S$q-S$u,S$U=(-(S$p=(S$p=-(S$Q-S$h))/(S$V=Math.sqrt(S$p*S$p+S$c*S$c))*S$S)+S$d)*(-(S$c=S$c/S$V*S$S)+S$h)-(-S$p+S$q)*(-S$c+S$Q),S$f=(-(S$H=(S$H=-(S$h-S$O))/(S$V=Math.sqrt(S$H*S$H+S$o*S$o))*S$S)+S$u)*(-(S$o=S$o/S$V*S$S)+S$h)-(-S$H+S$q)*(-S$o+S$O),S$K=(S$N=-S$c+S$Q-(-S$c+S$h))*(S$C=-S$H+S$q-(-S$H+S$u))-(S$l=-S$o+S$O-(-S$o+S$h))*(S$z=-S$p+S$q-(-S$p+S$d)),Math.abs(S$K)<.1?(S$K+=10.1,S$e.push(S$q-S$p,S$h-S$c,S$B,S$k,S$j,S$q+S$p,S$h+S$c,S$B,S$k,S$j)):(((S$G=(S$z*S$f-S$C*S$U)/S$K)-S$q)*(S$G-S$q)+((S$y=(S$l*S$U-S$N*S$f)/S$K)-S$h)+(S$y-S$h),S$e.push(S$G,S$y,S$B,S$k,S$j,S$q-(S$G-S$q),S$h-(S$y-S$h),S$B,S$k,S$j));S$d=S$_[S$_.length-10],S$Q=S$_[S$_.length-9],S$c=S$d-(S$q=S$_[S$_.length-5]),S$p=(S$p=-(S$Q-(S$h=S$_[S$_.length-4])))/(S$V=Math.sqrt(S$p*S$p+S$c*S$c))*S$S,S$c=S$c/S$V*S$S,S$e.push(S$q-S$p,S$h-S$c,S$B,S$k,S$j,S$q+S$p,S$h+S$c,S$B,S$k,S$j);var S$X=this.edges+1;for(S$Z=1;S$Z<S$X;S$Z++)S$m.push(S$b+2*(S$Z-1),S$b+2*(S$Z-1)+1,S$b+2*S$Z+1,S$b+2*S$Z+1,S$b+2*S$Z,S$b+2*(S$Z-1));return S$e},S$m.createLoopLine=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$a.concat(),S$B=S$_||S$a,S$k=this.borderColor,S$j=(S$k>>16&255)/255,S$G=(S$k>>8&255)/255,S$y=(255&S$k)/255;S$A.splice(0,5);var S$d=[S$A[0],S$A[1]],S$Q=[S$A[S$A.length-5],S$A[S$A.length-4]],S$q=S$Q[0]+.5*(S$d[0]-S$Q[0]),S$h=S$Q[1]+.5*(S$d[1]-S$Q[1]);S$A.unshift(S$q,S$h,0,0,0),S$A.push(S$q,S$h,0,0,0);var S$u,S$O,S$p,S$c,S$H,S$o,S$N,S$z,S$U,S$l,S$C,S$f,S$K,S$V,S$W,S$b,S$S,S$Z,S$X,S$E,S$i=S$A.length/5,S$t=S$P,S$L=S$s/2;S$p=S$A[0],S$c=S$A[1],S$l=S$p-(S$H=S$A[5]),S$U=(S$U=-(S$c-(S$o=S$A[6])))/(S$E=Math.sqrt(S$U*S$U+S$l*S$l))*S$L,S$l=S$l/S$E*S$L,S$B.push(S$p-S$U,S$c-S$l,S$j,S$G,S$y,S$p+S$U,S$c+S$l,S$j,S$G,S$y);for(var S$R=1;S$R<S$i-1;S$R++)S$p=S$A[5*(S$R-1)],S$c=S$A[5*(S$R-1)+1],S$H=S$A[5*S$R],S$o=S$A[5*S$R+1],S$N=S$A[5*(S$R+1)],S$z=S$A[5*(S$R+1)+1],S$l=S$p-S$H,S$f=S$H-S$N,S$W=(-(S$U=(S$U=-(S$c-S$o))/(S$E=Math.sqrt(S$U*S$U+S$l*S$l))*S$L)+S$p)*(-(S$l=S$l/S$E*S$L)+S$o)-(-S$U+S$H)*(-S$l+S$c),S$Z=(-(S$C=(S$C=-(S$o-S$z))/(S$E=Math.sqrt(S$C*S$C+S$f*S$f))*S$L)+S$N)*(-(S$f=S$f/S$E*S$L)+S$o)-(-S$C+S$H)*(-S$f+S$z),S$X=(S$K=-S$l+S$c-(-S$l+S$o))*(S$S=-S$C+S$H-(-S$C+S$N))-(S$b=-S$f+S$z-(-S$f+S$o))*(S$V=-S$U+S$H-(-S$U+S$p)),Math.abs(S$X)<.1?(S$X+=10.1,S$B.push(S$H-S$U,S$o-S$l,S$j,S$G,S$y,S$H+S$U,S$o+S$l,S$j,S$G,S$y)):(((S$u=(S$V*S$Z-S$S*S$W)/S$X)-S$H)*(S$u-S$H)+((S$O=(S$b*S$W-S$K*S$Z)/S$X)-S$o)+(S$O-S$o),S$B.push(S$u,S$O,S$j,S$G,S$y,S$H-(S$u-S$H),S$o-(S$O-S$o),S$j,S$G,S$y));S$e&&(S$m=S$e);var S$F=this.edges+1;for(S$R=1;S$R<S$F;S$R++)S$m.push(S$t+2*(S$R-1),S$t+2*(S$R-1)+1,S$t+2*S$R+1,S$t+2*S$R+1,S$t+2*S$R,S$t+2*(S$R-1));return S$m.push(S$t+2*(S$R-1),S$t+2*(S$R-1)+1,S$t+1,S$t+1,S$t,S$t+2*(S$R-1)),S$B},S$a}(),S$Pa=function(){function S$h(){}return S$d(S$h,"laya.webgl.shapes.Earcut"),S$h.earcut=function(S$a,S$m,S$s){S$s=S$s||2;var S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G=S$m&&S$m.length,S$y=S$G?S$m[0]*S$s:S$a.length,S$d=S$h.linkedList(S$a,0,S$y,S$s,!0),S$Q=[];if(!S$d)return S$Q;if(S$G&&(S$d=S$h.eliminateHoles(S$a,S$m,S$d,S$s)),S$a.length>80*S$s){S$P=S$e=S$a[0],S$_=S$A=S$a[1];for(var S$q=S$s;S$q<S$y;S$q+=S$s)(S$B=S$a[S$q])<S$P&&(S$P=S$B),(S$k=S$a[S$q+1])<S$_&&(S$_=S$k),S$e<S$B&&(S$e=S$B),S$A<S$k&&(S$A=S$k);S$j=0!==(S$j=Math.max(S$e-S$P,S$A-S$_))?1/S$j:0}return S$h.earcutLinked(S$d,S$Q,S$s,S$P,S$_,S$j),S$Q},S$h.linkedList=function(S$a,S$m,S$s,S$P,S$_){var S$e,S$A;if(S$_===0<S$h.signedArea(S$a,S$m,S$s,S$P))for(S$e=S$m;S$e<S$s;S$e+=S$P)S$A=S$h.insertNode(S$e,S$a[S$e],S$a[S$e+1],S$A);else for(S$e=S$s-S$P;S$m<=S$e;S$e-=S$P)S$A=S$h.insertNode(S$e,S$a[S$e],S$a[S$e+1],S$A);return S$A&&S$h.equals(S$A,S$A.next)&&(S$h.removeNode(S$A),S$A=S$A.next),S$A},S$h.filterPoints=function(S$a,S$m){if(!S$a)return S$a;S$m||(S$m=S$a);var S$s,S$P=S$a;do{if(S$s=!1,S$P.steiner||!S$h.equals(S$P,S$P.next)&&0!==S$h.area(S$P.prev,S$P,S$P.next))S$P=S$P.next;else{if(S$h.removeNode(S$P),(S$P=S$m=S$P.prev)===S$P.next)break;S$s=!0}}while(S$s||S$P!==S$m);return S$m},S$h.earcutLinked=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){if(S$a){!S$A&&S$e&&S$h.indexCurve(S$a,S$P,S$_,S$e);for(var S$B,S$k,S$j=S$a;S$a.prev!==S$a.next;)if(S$B=S$a.prev,S$k=S$a.next,S$e?S$h.isEarHashed(S$a,S$P,S$_,S$e):S$h.isEar(S$a))S$m.push(S$B.i/S$s),S$m.push(S$a.i/S$s),S$m.push(S$k.i/S$s),S$h.removeNode(S$a),S$a=S$k.next,S$j=S$k.next;else if((S$a=S$k)===S$j){S$A?1===S$A?(S$a=S$h.cureLocalIntersections(S$a,S$m,S$s),S$h.earcutLinked(S$a,S$m,S$s,S$P,S$_,S$e,2)):2===S$A&&S$h.splitEarcut(S$a,S$m,S$s,S$P,S$_,S$e):S$h.earcutLinked(S$h.filterPoints(S$a,null),S$m,S$s,S$P,S$_,S$e,1);break}}},S$h.isEar=function(S$a){var S$m=S$a.prev,S$s=S$a,S$P=S$a.next;if(0<=S$h.area(S$m,S$s,S$P))return!1;for(var S$_=S$a.next.next;S$_!==S$a.prev;){if(S$h.pointInTriangle(S$m.x,S$m.y,S$s.x,S$s.y,S$P.x,S$P.y,S$_.x,S$_.y)&&0<=S$h.area(S$_.prev,S$_,S$_.next))return!1;S$_=S$_.next}return!0},S$h.isEarHashed=function(S$a,S$m,S$s,S$P){var S$_=S$a.prev,S$e=S$a,S$A=S$a.next;if(0<=S$h.area(S$_,S$e,S$A))return!1;for(var S$B=S$_.x<S$e.x?S$_.x<S$A.x?S$_.x:S$A.x:S$e.x<S$A.x?S$e.x:S$A.x,S$k=S$_.y<S$e.y?S$_.y<S$A.y?S$_.y:S$A.y:S$e.y<S$A.y?S$e.y:S$A.y,S$j=S$_.x>S$e.x?S$_.x>S$A.x?S$_.x:S$A.x:S$e.x>S$A.x?S$e.x:S$A.x,S$G=S$_.y>S$e.y?S$_.y>S$A.y?S$_.y:S$A.y:S$e.y>S$A.y?S$e.y:S$A.y,S$y=S$h.zOrder(S$B,S$k,S$m,S$s,S$P),S$d=S$h.zOrder(S$j,S$G,S$m,S$s,S$P),S$Q=S$a.nextZ;S$Q&&S$Q.z<=S$d;){if(S$Q!==S$a.prev&&S$Q!==S$a.next&&S$h.pointInTriangle(S$_.x,S$_.y,S$e.x,S$e.y,S$A.x,S$A.y,S$Q.x,S$Q.y)&&0<=S$h.area(S$Q.prev,S$Q,S$Q.next))return!1;S$Q=S$Q.nextZ}for(S$Q=S$a.prevZ;S$Q&&S$Q.z>=S$y;){if(S$Q!==S$a.prev&&S$Q!==S$a.next&&S$h.pointInTriangle(S$_.x,S$_.y,S$e.x,S$e.y,S$A.x,S$A.y,S$Q.x,S$Q.y)&&0<=S$h.area(S$Q.prev,S$Q,S$Q.next))return!1;S$Q=S$Q.prevZ}return!0},S$h.cureLocalIntersections=function(S$a,S$m,S$s){var S$P=S$a;do{var S$_=S$P.prev,S$e=S$P.next.next;!S$h.equals(S$_,S$e)&&S$h.intersects(S$_,S$P,S$P.next,S$e)&&S$h.locallyInside(S$_,S$e)&&S$h.locallyInside(S$e,S$_)&&(S$m.push(S$_.i/S$s),S$m.push(S$P.i/S$s),S$m.push(S$e.i/S$s),S$h.removeNode(S$P),S$h.removeNode(S$P.next),S$P=S$a=S$e),S$P=S$P.next}while(S$P!==S$a);return S$P},S$h.splitEarcut=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$a;do{for(var S$B=S$A.next.next;S$B!==S$A.prev;){if(S$A.i!==S$B.i&&S$h.isValidDiagonal(S$A,S$B)){var S$k=S$h.splitPolygon(S$A,S$B);return S$A=S$h.filterPoints(S$A,S$A.next),S$k=S$h.filterPoints(S$k,S$k.next),S$h.earcutLinked(S$A,S$m,S$s,S$P,S$_,S$e),void S$h.earcutLinked(S$k,S$m,S$s,S$P,S$_,S$e)}S$B=S$B.next}S$A=S$A.next}while(S$A!==S$a)},S$h.eliminateHoles=function(S$a,S$m,S$s,S$P){var S$_,S$e,S$A,S$B,S$k,S$j=[];for(S$_=0,S$e=S$m.length;S$_<S$e;S$_++)S$A=S$m[S$_]*S$P,S$B=S$_<S$e-1?S$m[S$_+1]*S$P:S$a.length,(S$k=S$h.linkedList(S$a,S$A,S$B,S$P,!1))===S$k.next&&(S$k.steiner=!0),S$j.push(S$h.getLeftmost(S$k));for(S$j.sort(S$h.compareX),S$_=0;S$_<S$j.length;S$_++)S$h.eliminateHole(S$j[S$_],S$s),S$s=S$h.filterPoints(S$s,S$s.next);return S$s},S$h.compareX=function(S$a,S$m){return S$a.x-S$m.x},S$h.eliminateHole=function(S$a,S$m){if(S$m=S$h.findHoleBridge(S$a,S$m)){var S$s=S$h.splitPolygon(S$m,S$a);S$h.filterPoints(S$s,S$s.next)}},S$h.findHoleBridge=function(S$a,S$m){var S$s,S$P=S$m,S$_=S$a.x,S$e=S$a.y,S$A=-1/0;do{if(S$e<=S$P.y&&S$e>=S$P.next.y&&S$P.next.y!==S$P.y){var S$B=S$P.x+(S$e-S$P.y)*(S$P.next.x-S$P.x)/(S$P.next.y-S$P.y);if(S$B<=S$_&&S$A<S$B){if((S$A=S$B)===S$_){if(S$e===S$P.y)return S$P;if(S$e===S$P.next.y)return S$P.next}S$s=S$P.x<S$P.next.x?S$P:S$P.next}}S$P=S$P.next}while(S$P!==S$m);if(!S$s)return null;if(S$_===S$A)return S$s.prev;var S$k,S$j=S$s,S$G=S$s.x,S$y=S$s.y,S$d=1/0;for(S$P=S$s.next;S$P!==S$j;)S$_>=S$P.x&&S$P.x>=S$G&&S$_!==S$P.x&&S$h.pointInTriangle(S$e<S$y?S$_:S$A,S$e,S$G,S$y,S$e<S$y?S$A:S$_,S$e,S$P.x,S$P.y)&&((S$k=Math.abs(S$e-S$P.y)/(S$_-S$P.x))<S$d||S$k===S$d&&S$P.x>S$s.x)&&S$h.locallyInside(S$P,S$a)&&(S$s=S$P,S$d=S$k),S$P=S$P.next;return S$s},S$h.indexCurve=function(S$a,S$m,S$s,S$P){for(var S$_=S$a;null===S$_.z&&(S$_.z=S$h.zOrder(S$_.x,S$_.y,S$m,S$s,S$P)),S$_.prevZ=S$_.prev,S$_.nextZ=S$_.next,(S$_=S$_.next)!==S$a;);S$_.prevZ.nextZ=null,S$_.prevZ=null,S$h.sortLinked(S$_)},S$h.sortLinked=function(S$a){var S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j=1;do{for(S$s=S$a,S$e=S$a=null,S$A=0;S$s;){for(S$A++,S$P=S$s,S$m=S$B=0;S$m<S$j&&(S$B++,S$P=S$P.nextZ);S$m++);for(S$k=S$j;0<S$B||0<S$k&&S$P;)0!==S$B&&(0===S$k||!S$P||S$s.z<=S$P.z)?(S$s=(S$_=S$s).nextZ,S$B--):(S$P=(S$_=S$P).nextZ,S$k--),S$e?S$e.nextZ=S$_:S$a=S$_,S$_.prevZ=S$e,S$e=S$_;S$s=S$P}S$e.nextZ=null,S$j*=2}while(1<S$A);return S$a},S$h.zOrder=function(S$a,S$m,S$s,S$P,S$_){return(S$a=1431655765&((S$a=858993459&((S$a=252645135&((S$a=16711935&((S$a=32767*(S$a-S$s)*S$_)|S$a<<8))|S$a<<4))|S$a<<2))|S$a<<1))|(S$m=1431655765&((S$m=858993459&((S$m=252645135&((S$m=16711935&((S$m=32767*(S$m-S$P)*S$_)|S$m<<8))|S$m<<4))|S$m<<2))|S$m<<1))<<1},S$h.getLeftmost=function(S$a){for(var S$m=S$a,S$s=S$a;S$m.x<S$s.x&&(S$s=S$m),(S$m=S$m.next)!==S$a;);return S$s},S$h.pointInTriangle=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){return 0<=(S$_-S$A)*(S$m-S$B)-(S$a-S$A)*(S$e-S$B)&&0<=(S$a-S$A)*(S$P-S$B)-(S$s-S$A)*(S$m-S$B)&&0<=(S$s-S$A)*(S$e-S$B)-(S$_-S$A)*(S$P-S$B)},S$h.isValidDiagonal=function(S$a,S$m){return S$a.next.i!==S$m.i&&S$a.prev.i!==S$m.i&&!S$h.intersectsPolygon(S$a,S$m)&&S$h.locallyInside(S$a,S$m)&&S$h.locallyInside(S$m,S$a)&&S$h.middleInside(S$a,S$m)},S$h.area=function(S$a,S$m,S$s){return(S$m.y-S$a.y)*(S$s.x-S$m.x)-(S$m.x-S$a.x)*(S$s.y-S$m.y)},S$h.equals=function(S$a,S$m){return S$a.x===S$m.x&&S$a.y===S$m.y},S$h.intersects=function(S$a,S$m,S$s,S$P){return!!(S$h.equals(S$a,S$m)&&S$h.equals(S$s,S$P)||S$h.equals(S$a,S$P)&&S$h.equals(S$s,S$m))||0<S$h.area(S$a,S$m,S$s)!=0<S$h.area(S$a,S$m,S$P)&&0<S$h.area(S$s,S$P,S$a)!=0<S$h.area(S$s,S$P,S$m)},S$h.intersectsPolygon=function(S$a,S$m){var S$s=S$a;do{if(S$s.i!==S$a.i&&S$s.next.i!==S$a.i&&S$s.i!==S$m.i&&S$s.next.i!==S$m.i&&S$h.intersects(S$s,S$s.next,S$a,S$m))return!0;S$s=S$s.next}while(S$s!==S$a);return!1},S$h.locallyInside=function(S$a,S$m){return S$h.area(S$a.prev,S$a,S$a.next)<0?0<=S$h.area(S$a,S$m,S$a.next)&&0<=S$h.area(S$a,S$a.prev,S$m):S$h.area(S$a,S$m,S$a.prev)<0||S$h.area(S$a,S$a.next,S$m)<0},S$h.middleInside=function(S$a,S$m){for(var S$s=S$a,S$P=!1,S$_=(S$a.x+S$m.x)/2,S$e=(S$a.y+S$m.y)/2;S$s.y>S$e!=S$s.next.y>S$e&&S$s.next.y!==S$s.y&&S$_<(S$s.next.x-S$s.x)*(S$e-S$s.y)/(S$s.next.y-S$s.y)+S$s.x&&(S$P=!S$P),(S$s=S$s.next)!==S$a;);return S$P},S$h.splitPolygon=function(S$a,S$m){var S$s=new S$_a(S$a.i,S$a.x,S$a.y),S$P=new S$_a(S$m.i,S$m.x,S$m.y),S$_=S$a.next,S$e=S$m.prev;return(S$a.next=S$m).prev=S$a,(S$s.next=S$_).prev=S$s,(S$P.next=S$s).prev=S$P,(S$e.next=S$P).prev=S$e,S$P},S$h.insertNode=function(S$a,S$m,S$s,S$P){var S$_=new S$_a(S$a,S$m,S$s);return S$P?(S$_.next=S$P.next,(S$_.prev=S$P).next.prev=S$_,S$P.next=S$_):(S$_.prev=S$_).next=S$_,S$_},S$h.removeNode=function(S$a){S$a.next.prev=S$a.prev,S$a.prev.next=S$a.next,S$a.prevZ&&(S$a.prevZ.nextZ=S$a.nextZ),S$a.nextZ&&(S$a.nextZ.prevZ=S$a.prevZ)},S$h.signedArea=function(S$a,S$m,S$s,S$P){for(var S$_=0,S$e=S$m,S$A=S$s-S$P;S$e<S$s;S$e+=S$P)S$_+=(S$a[S$A]-S$a[S$e])*(S$a[S$e+1]+S$a[S$A+1]),S$A=S$e;return S$_},S$h}(),S$_a=function(){function S$a(S$a,S$m,S$s){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=S$a,this.x=S$m,this.y=S$s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return S$d(S$a,"laya.webgl.shapes.EarcutNode"),S$a}(),S$ea=(function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this.lineWidth=S$a,this.lineColor=S$m,this.lineAlpha=S$s,this.fillColor=S$P,this.fillAlpha=S$_,this.shape=S$A,this.fill=S$e}S$d(S$a,"laya.webgl.shapes.GeometryData");var S$m=S$a.prototype;S$m.clone=function(){return new S$a(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},S$m.getIndexData=function(){return null},S$m.getVertexData=function(){return null},S$m.destroy=function(){this.shape=null}}(),function(){function S$a(S$a){if(S$a instanceof Float32Array)this.points=S$a;else if(S$a instanceof Array){S$a.length;this.points=new Float32Array(S$a)}}S$d(S$a,"laya.webgl.shapes.Vertex");var S$m=S$a.prototype;S$N.imps(S$m,{"laya.webgl.shapes.IShape":!0}),S$m.getData=function(S$a,S$m,S$s){},S$m.needUpdate=function(S$a){return!1},S$m.rebuild=function(S$a){},S$m.setMatrix=function(S$a){}}(),function(){function S$k(S$a){void 0===S$a&&(S$a=1e4),this._renderType=S$a}S$d(S$k,"laya.webgl.submit.Submit");var S$a=S$k.prototype;return S$N.imps(S$a,{"laya.webgl.submit.ISubmit":!0}),S$a.releaseRender=function(){var S$a=S$k._cache;(S$a[S$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},S$a.getRenderType=function(){return this._renderType},S$a.renderSubmit=function(){if(0===this._numEle)return 1;var S$a=this.shaderValue.textureHost;if(S$a){var S$m=S$a.source;if(!S$a.bitmap||!S$m)return 1;this.shaderValue.texture=S$m,S$a.alphaTexture&&S$a.alphaTexture.source&&(this.shaderValue.texture1=S$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var S$s=S$Ha.mainContext;return this.shaderValue.upload(),S$M.activeBlendFunction!==this._blendFn&&(S$s.enable(3042),this._blendFn(S$s),S$M.activeBlendFunction=this._blendFn),S$W.drawCall++,S$W.trianglesFaces+=this._numEle/3,S$s.drawElements(4,this._numEle,5123,this._startIdx),1},S$k.__init__=function(){var S$a=S$k.RENDERBASE=new S$k(-1);S$a.shaderValue=new S$Ua(0,0),S$a.shaderValue.ALPHA=-1234},S$k.createSubmit=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$k._cache._length?S$k._cache[--S$k._cache._length]:new S$k;null==S$s&&((S$s=S$e._selfVb||(S$e._selfVb=S$ra.create(-1))).clear(),S$P=0),S$e._ib=S$m,S$e._vb=S$s,S$e._startIdx=S$P*S$ha.BYTES_PIDX,S$e._numEle=0;var S$A=S$a._nBlendType;S$e._blendFn=S$a._targets?S$M.targetFns[S$A]:S$M.fns[S$A],S$e.shaderValue=S$_,S$e.shaderValue.setValue(S$a._shader2D);var S$B=S$a._shader2D.filters;return S$B&&S$e.shaderValue.setFilters(S$B),S$e},S$k.createShape=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$k._cache._length?S$k._cache[--S$k._cache._length]:new S$k;S$A._ib=S$m,S$A._vb=S$s,S$A._numEle=S$P,S$A._startIdx=S$_,S$A.shaderValue=S$e,S$A.shaderValue.setValue(S$a._shader2D);var S$B=S$a._nBlendType;return S$A._blendFn=S$a._targets?S$M.targetFns[S$B]:S$M.fns[S$B],S$A},S$k.TYPE_2D=1e4,S$k.TYPE_CANVAS=10003,S$k.TYPE_CMDSETRT=10004,S$k.TYPE_CUSTOM=10005,S$k.TYPE_BLURRT=10006,S$k.TYPE_CMDDESTORYPRERT=10007,S$k.TYPE_DISABLESTENCIL=10008,S$k.TYPE_OTHERIBVB=10009,S$k.TYPE_PRIMITIVE=10010,S$k.TYPE_RT=10011,S$k.TYPE_BLUR_RT=10012,S$k.TYPE_TARGET=10013,S$k.TYPE_CHANGE_VALUE=10014,S$k.TYPE_SHAPE=10015,S$k.TYPE_TEXTURE=10016,S$k.TYPE_FILLTEXTURE=10017,S$k.RENDERBASE=null,S$k._cache=((S$k._cache=[])._length=0,S$k._cache),S$k}()),S$Aa=function(){function S$P(){this.fun=null,this.args=null}S$d(S$P,"laya.webgl.submit.SubmitCMD");var S$a=S$P.prototype;return S$N.imps(S$a,{"laya.webgl.submit.ISubmit":!0}),S$a.renderSubmit=function(){return this.fun.apply(null,this.args),1},S$a.getRenderType=function(){return 0},S$a.releaseRender=function(){var S$a=S$P._cache;S$a[S$a._length++]=this},S$P.create=function(S$a,S$m){var S$s=S$P._cache._length?S$P._cache[--S$P._cache._length]:new S$P;return S$s.fun=S$m,S$s.args=S$a,S$s},S$P._cache=((S$P._cache=[])._length=0,S$P._cache),S$P}(),S$Ba=function(){function S$m(){this.variables={}}S$d(S$m,"laya.webgl.submit.SubmitCMDScope");var S$a=S$m.prototype;return S$a.getValue=function(S$a){return this.variables[S$a]},S$a.addValue=function(S$a,S$m){return this.variables[S$a]=S$m},S$a.setValue=function(S$a,S$m){return this.variables.hasOwnProperty(S$a)?this.variables[S$a]=S$m:null},S$a.clear=function(){for(var S$a in this.variables)delete this.variables[S$a]},S$a.recycle=function(){this.clear(),S$m.POOL.push(this)},S$m.create=function(){var S$a=S$m.POOL.pop();return S$a||(S$a=new S$m),S$a},S$m.POOL=[],S$m}(),S$ka=function(){function S$y(){this.offset=0,this.startIndex=0,this._mat=S$l.create()}S$d(S$y,"laya.webgl.submit.SubmitOtherIBVB");var S$a=S$y.prototype;return S$N.imps(S$a,{"laya.webgl.submit.ISubmit":!0}),S$a.releaseRender=function(){var S$a=S$y._cache;(S$a[S$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},S$a.getRenderType=function(){return 10009},S$a.renderSubmit=function(){var S$a=this._shaderValue.textureHost;if(S$a){var S$m=S$a.source;if(!S$a.bitmap||!S$m)return 1;this._shaderValue.texture=S$m}this._vb.bind_upload(this._ib);var S$s=S$pa.worldMatrix4,S$P=S$l.TEMP;S$l.mulPre(this._mat,S$s[0],S$s[1],S$s[4],S$s[5],S$s[12],S$s[13],S$P);var S$_=S$pa.worldMatrix4=S$y.tempMatrix4;S$_[0]=S$P.a,S$_[1]=S$P.b,S$_[4]=S$P.c,S$_[5]=S$P.d,S$_[12]=S$P.tx,S$_[13]=S$P.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var S$e=S$Ha.mainContext;return S$M.activeBlendFunction!==this._blendFn&&(S$e.enable(3042),this._blendFn(S$e),S$M.activeBlendFunction=this._blendFn),S$W.drawCall++,S$W.trianglesFaces+=this._numEle/3,S$e.drawElements(4,this._numEle,5123,this.startIndex),S$pa.worldMatrix4=S$s,S$Ea.activeShader=null,1},S$y.create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){void 0===S$k&&(S$k=0);var S$j=S$y._cache._length?S$y._cache[--S$y._cache._length]:new S$y;S$j._ib=S$s,S$j._vb=S$m,S$j._numEle=S$P,S$j._shader=S$_,S$j._shaderValue=S$e;var S$G=S$a._nBlendType;switch(S$j._blendFn=S$a._targets?S$M.targetFns[S$G]:S$M.fns[S$G],S$k){case 0:S$j.offset=0,S$j.startIndex=S$B/(S$ha.BYTES_PE*S$m.vertexStride)*1.5,S$j.startIndex*=S$ha.BYTES_PIDX;break;case 1:S$j.startIndex=S$A,S$j.offset=S$B}return S$j},S$y._cache=((S$y._cache=[])._length=0,S$y._cache),S$y.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S$y}(),S$ja=function(){function S$s(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new S$f,this.screenRect=new S$f}S$d(S$s,"laya.webgl.submit.SubmitScissor");var S$a=S$s.prototype;return S$N.imps(S$a,{"laya.webgl.submit.ISubmit":!0}),S$a._scissor=function(S$a,S$m,S$s,S$P){var S$_=S$pa.worldMatrix4,S$e=S$_[0],S$A=S$_[5],S$B=S$_[12],S$k=S$_[13];if(S$P*=S$A,(S$s*=S$e)<1||S$P<1)return!1;var S$j=(S$a=S$a*S$e+S$B)+S$s,S$G=(S$m=S$m*S$A+S$k)+S$P;S$a<0&&(S$s=S$j-(S$a=0)),S$m<0&&(S$P=S$G-(S$m=0));var S$y=S$pa.worldClipRect;if(S$a=Math.max(S$a,S$y.x),S$m=Math.max(S$m,S$y.y),S$s=Math.min(S$j,S$y.right)-S$a,S$P=Math.min(S$G,S$y.bottom)-S$m,S$s<1||S$P<1)return!1;var S$d=S$pa.worldScissorTest;return this.screenRect.copyFrom(S$y),S$y.x=S$a,S$y.y=S$m,S$y.width=S$s,S$y.height=S$P,S$pa.worldScissorTest=!0,S$m=S$pa.height-S$m-S$P,S$Ha.mainContext.scissor(S$a,S$m,S$s,S$P),S$Ha.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),S$d?(S$m=S$pa.height-this.screenRect.y-this.screenRect.height,S$Ha.mainContext.scissor(this.screenRect.x,S$m,this.screenRect.width,this.screenRect.height),S$Ha.mainContext.enable(3089)):(S$Ha.mainContext.disable(3089),S$pa.worldScissorTest=!1),S$y.copyFrom(this.screenRect),!0},S$a._scissorWithTagart=function(S$a,S$m,S$s,S$P){if(S$s<1||S$P<1)return!1;var S$_=S$a+S$s,S$e=S$m+S$P;S$a<0&&(S$s=S$_-(S$a=0)),S$m<0&&(S$P=S$e-(S$m=0));var S$A=S$pa.worldClipRect;if(S$a=Math.max(S$a,S$A.x),S$m=Math.max(S$m,S$A.y),S$s=Math.min(S$_,S$A.right)-S$a,S$P=Math.min(S$e,S$A.bottom)-S$m,S$s<1||S$P<1)return!1;var S$B=S$pa.worldScissorTest;return this.screenRect.copyFrom(S$A),S$pa.worldScissorTest=!0,S$A.x=S$a,S$A.y=S$m,S$A.width=S$s,S$A.height=S$P,S$m=S$pa.height-S$m-S$P,S$Ha.mainContext.scissor(S$a,S$m,S$s,S$P),S$Ha.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),S$B?(S$m=S$pa.height-this.screenRect.y-this.screenRect.height,S$Ha.mainContext.scissor(this.screenRect.x,S$m,this.screenRect.width,this.screenRect.height),S$Ha.mainContext.enable(3089)):(S$Ha.mainContext.disable(3089),S$pa.worldScissorTest=!1),S$A.copyFrom(this.screenRect),!0},S$a.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},S$a.getRenderType=function(){return 0},S$a.releaseRender=function(){var S$a=S$s._cache;(S$a[S$a._length++]=this).context=null},S$s.create=function(S$a){var S$m=S$s._cache._length?S$s._cache[--S$s._cache._length]:new S$s;return S$m.context=S$a,S$m},S$s._cache=((S$s._cache=[])._length=0,S$s._cache),S$s}(),S$Ga=function(){function S$k(){this.step=0,this.blendMode=null,this.level=0}S$d(S$k,"laya.webgl.submit.SubmitStencil");var S$a=S$k.prototype;return S$N.imps(S$a,{"laya.webgl.submit.ISubmit":!0}),S$a.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},S$a.getRenderType=function(){return 0},S$a.releaseRender=function(){var S$a=S$k._cache;S$a[S$a._length++]=this},S$a.do1=function(){var S$a=S$Ha.mainContext;S$a.enable(2960),S$a.clear(1024),S$a.colorMask(!1,!1,!1,!1),S$a.stencilFunc(514,this.level,255),S$a.stencilOp(7680,7680,7682)},S$a.do2=function(){var S$a=S$Ha.mainContext;S$a.stencilFunc(514,this.level+1,255),S$a.colorMask(!0,!0,!0,!0),S$a.stencilOp(7680,7680,7680)},S$a.do3=function(){var S$a=S$Ha.mainContext;S$a.colorMask(!0,!0,!0,!0),S$a.stencilOp(7680,7680,7680),S$a.clear(1024),S$a.disable(2960)},S$a.do4=function(){var S$a=S$Ha.mainContext;0==this.level&&(S$a.enable(2960),S$a.clear(1024)),S$a.colorMask(!1,!1,!1,!1),S$a.stencilFunc(519,0,255),S$a.stencilOp(7680,7680,7682)},S$a.do5=function(){var S$a=S$Ha.mainContext;S$a.stencilFunc(514,this.level,255),S$a.colorMask(!0,!0,!0,!0),S$a.stencilOp(7680,7680,7680)},S$a.do6=function(){var S$a=S$Ha.mainContext;S$M.targetFns[S$M.TOINT[this.blendMode]](S$a)},S$a.do7=function(){var S$a=S$Ha.mainContext;S$a.colorMask(!1,!1,!1,!1),S$a.stencilOp(7680,7680,7683)},S$a.do8=function(){var S$a=S$Ha.mainContext;S$a.colorMask(!0,!0,!0,!0),S$a.stencilFunc(514,this.level,255),S$a.stencilOp(7680,7680,7680)},S$k.restore=function(S$a,S$m,S$s,S$P,S$_){var S$e;if((S$a._renderKey=0)<S$k._mask&&S$k._mask--,0==S$k._mask)S$e=laya.webgl.submit.SubmitStencil.create(3),S$a.addRenderObject(S$e),S$a._curSubmit=S$ea.RENDERBASE;else{S$e=laya.webgl.submit.SubmitStencil.create(7),S$a.addRenderObject(S$e);var S$A=S$a._vb;S$A._byteLength;if(S$ua.fillRectImgVb(S$A,null,S$m.x,S$m.y,S$m.width,S$m.height,S$X.DEF_UV,S$s,S$P,S$_,0,0)){S$a._shader2D.glTexture=null;var S$B=S$a._curSubmit=S$ea.createSubmit(S$a,S$a._ib,S$A,(S$A._byteLength-64)/32*3,S$Ua.create(2,0));S$B.shaderValue.ALPHA=1,S$a._submits[S$a._submits._length++]=S$B,S$a._curSubmit._numEle+=6,S$a._curSubmit=S$ea.RENDERBASE}else alert("clipRect calc stencil rect error");S$e=laya.webgl.submit.SubmitStencil.create(8),S$a.addRenderObject(S$e)}},S$k.restore2=function(S$a,S$m){var S$s;(S$a._renderKey=0)<S$k._mask&&S$k._mask--,0==S$k._mask?(S$s=laya.webgl.submit.SubmitStencil.create(3),S$a.addRenderObject(S$s),S$a._curSubmit=S$ea.RENDERBASE):(S$s=laya.webgl.submit.SubmitStencil.create(7),S$a.addRenderObject(S$s),S$a._submits[S$a._submits._length++]=S$m,S$s=laya.webgl.submit.SubmitStencil.create(8),S$a.addRenderObject(S$s))},S$k.create=function(S$a){var S$m=S$k._cache._length?S$k._cache[--S$k._cache._length]:new S$k;return 5==(S$m.step=S$a)&&++S$k._mask,S$m.level=S$k._mask,S$m},S$k._cache=((S$k._cache=[])._length=0,S$k._cache),S$k._mask=0,S$k}(),S$ya=function(){function S$B(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}S$d(S$B,"laya.webgl.submit.SubmitTarget");var S$a=S$B.prototype;return S$N.imps(S$a,{"laya.webgl.submit.ISubmit":!0}),S$a.renderSubmit=function(){this._vb.bind_upload(this._ib);var S$a=this.scope.getValue(this.proName);return S$a&&(this.shaderValue.texture=S$a.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[S$a.width,S$a.height]),this.shaderValue.upload(),this.blend(),S$W.drawCall++,S$W.trianglesFaces+=this._numEle/3,S$Ha.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},S$a.blend=function(){if(S$M.activeBlendFunction!==S$M.fns[this.blendType]){var S$a=S$Ha.mainContext;S$a.enable(3042),S$M.fns[this.blendType](S$a),S$M.activeBlendFunction=S$M.fns[this.blendType]}},S$a.getRenderType=function(){return 0},S$a.releaseRender=function(){var S$a=S$B._cache;(S$a[S$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},S$B.create=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$B._cache._length?S$B._cache[--S$B._cache._length]:new S$B;return S$A._ib=S$m,S$A._vb=S$s,S$A.proName=S$e,S$A._startIdx=S$P*S$ha.BYTES_PIDX,S$A._numEle=0,S$A.blendType=S$a._nBlendType,S$A.shaderValue=S$_,S$A.shaderValue.setValue(S$a._shader2D),S$A},S$B._cache=((S$B._cache=[])._length=0,S$B._cache),S$B}(),S$da=function(){function S$a(){this._sourceStr=null}S$d(S$a,"laya.webgl.text.CharSegment");var S$m=S$a.prototype;return S$N.imps(S$m,{"laya.webgl.text.ICharSegment":!0}),S$m.textToSpit=function(S$a){this._sourceStr=S$a},S$m.getChar=function(S$a){return this._sourceStr.charAt(S$a)},S$m.getCharCode=function(S$a){return this._sourceStr.charCodeAt(S$a)},S$m.length=function(){return this._sourceStr.length},S$a}(),S$Qa=function(){var S$a;function S$W(){}return S$d(S$W,"laya.webgl.text.DrawText"),S$W.__init__=function(){S$W._charsTemp=new Array,S$W._drawValue=new S$a,S$W._charSeg=new S$da},S$W.customCharSeg=function(S$a){S$W._charSeg=S$a},S$W.getChar=function(S$a,S$m,S$s){var S$P=S$ga.createOneChar(S$a,S$s);return-1!=S$m&&(S$W._charsCache[S$m]=S$P),S$P},S$W._drawSlow=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y,S$d,S$Q,S$q){var S$h,S$u,S$O=S$W._drawValue.value(S$e,S$B,S$k,S$j,S$d,S$Q,S$q),S$p=0,S$c=0,S$H=S$W._charsTemp,S$o=0,S$N=NaN;if(S$P)for(S$H.length=S$P.length,S$p=0,S$c=S$P.length;S$p<S$c;S$p++)(S$u=S$P[S$p])&&(S$N=S$u.charNum+S$O.txtID,S$H[S$p]=S$h=S$W._charsCache[S$N]||S$W.getChar(S$u.char,S$N,S$O),S$h.active());else{var S$z=S$s instanceof laya.utils.WordText?S$s.toString():S$s;if(S$Z.CharacterCache){S$W._charSeg.textToSpit(S$z);var S$U=S$W._charSeg.length();for(S$p=0,S$c=S$H.length=S$U;S$p<S$c;S$p++)S$N=S$W._charSeg.getCharCode(S$p)+S$O.txtID,S$H[S$p]=S$h=S$W._charsCache[S$N]||S$W.getChar(S$W._charSeg.getChar(S$p),S$N,S$O),S$h.active(),S$o+=S$h.cw}else S$H.length=0,(S$h=S$W.getChar(S$z,-1,S$O)).active(),S$o+=S$h.cw,S$H[0]=S$h}var S$l=0;null!==S$A&&"left"!==S$A&&(S$l=-("center"==S$A?S$o/2:S$o));var S$C,S$f,S$K=NaN,S$V=0;if(S$P)for(S$p=0,S$c=S$H.length;S$p<S$c;S$p++)S$h=S$H[S$p],S$u=S$P[S$p],S$h&&S$u&&!S$h.isSpace&&(S$K=S$h.borderSize,S$C=S$h.texture,S$m._drawText(S$C,S$G+S$l+S$u.x*S$d-S$K,S$y+S$u.y*S$Q-S$K,S$C.width,S$C.height,S$_,0,0,0,0));else{for(S$p=0,S$c=S$H.length;S$p<S$c;S$p++)(S$h=S$H[S$p])&&!S$h.isSpace&&(S$K=S$h.borderSize,S$C=S$h.texture,S$m._drawText(S$C,S$G+S$l-S$K,S$y-S$K,S$C.width,S$C.height,S$_,0,0,0,0),S$a&&((S$f=S$a[S$V++])||(S$f=S$a[S$V-1]=[]),S$f[0]=S$C,S$f[1]=S$l-S$K,S$f[2]=-S$K)),S$l+=S$h.cw;S$a&&(S$a.length=S$V)}},S$W._drawFast=function(S$a,S$m,S$s,S$P,S$_){for(var S$e,S$A,S$B=0,S$k=S$a.length;S$B<S$k;S$B++)(S$e=(S$A=S$a[S$B])[0]).active(),S$m._drawText(S$e,S$P+S$A[1],S$_+S$A[2],S$e.width,S$e.height,S$s,0,0,0,0)},S$W.drawText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y){if(void 0===S$y&&(S$y=0),!(S$m&&0===S$m.length||S$s&&0===S$s.length)){var S$d=S$P.a,S$Q=S$P.d;(0!==S$P.b||0!==S$P.c)&&(S$d=S$Q=1);var S$q=1!==S$d||1!==S$Q;if(S$q&&S$N.stage.transform){var S$h=S$N.stage.transform;S$q=S$h.a===S$d&&S$h.d===S$Q}else S$q=!1;if(S$q){var S$u=(S$P=S$P.copyTo(S$za._tmpMatrix)).tx,S$O=S$P.ty;S$P.scale(1/S$d,1/S$Q),S$P._checkTransform(),S$j*=S$d,S$G*=S$Q,S$j+=S$u-S$P.tx,S$G+=S$O-S$P.ty}else S$d=S$Q=1;if(S$s)S$W._drawSlow(null,S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$d,S$Q,S$y);else{if(null===S$m.toUpperCase){var S$p=S$d+1e5*S$Q,S$c=S$m;return void(S$c.changed||S$c.id!==S$p?(S$c.id=S$p,S$c.changed=!1,S$W._drawSlow(S$c.save,S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$d,S$Q,S$y)):S$W._drawFast(S$c.save,S$a,S$P,S$j,S$G))}var S$H=S$m+S$_.toString()+S$A+S$B+S$k+S$d+S$Q+S$e,S$o=S$W._textsCache[S$H];S$Z.CharacterCache?S$o?S$W._drawFast(S$o,S$a,S$P,S$j,S$G):(S$W._textsCache.__length||(S$W._textsCache.__length=0),S$W._textsCache.__length>S$z.WebGLTextCacheCount&&((S$W._textsCache={}).__length=0,S$W._curPoolIndex=0),S$W._textCachesPool[S$W._curPoolIndex]?(S$o=S$W._textsCache[S$H]=S$W._textCachesPool[S$W._curPoolIndex]).length=0:S$W._textCachesPool[S$W._curPoolIndex]=S$o=S$W._textsCache[S$H]=[],S$W._textsCache.__length++,S$W._curPoolIndex++,S$W._drawSlow(S$o,S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$d,S$Q,S$y)):S$W._drawSlow(S$o,S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$d,S$Q,S$y)}}},S$W._charsTemp=null,S$W._textCachesPool=[],S$W._curPoolIndex=0,S$W._charsCache={},S$W._textsCache={},S$W._drawValue=null,S$W.d=[],S$W._charSeg=null,S$W.__init$=function(){S$a=function(){function S$k(){}return S$d(S$k,""),S$k.prototype.value=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this.font=S$a,this.fillColor=S$m,this.borderColor=S$s,this.lineWidth=S$P,this.scaleX=S$_,this.scaleY=S$e,this.underLine=S$A;var S$B=S$a.toString()+S$_+S$e+S$P+(S$m?S$m.toLowerCase():" ")+(S$s?S$s.toLowerCase():" ")+S$A;return this.txtID=S$k._keymap[S$B],this.txtID||(this.txtID=1e-7*++S$k._keymapCount,S$k._keymap[S$B]=this.txtID),this},S$k.clear=function(){S$k._keymap={},S$k._keymapCount=1},S$k._keymap={},S$k._keymapCount=1,S$k}()},S$W}(),S$qa=function(){function S$_(S$a){this._index=0,this._size=14,this._italic=-2,S$_._cache2=S$_._cache2||[],this.setFont(S$a||"14px Arial")}S$d(S$_,"laya.webgl.text.FontInContext");var S$a=S$_.prototype;return S$a.setFont=function(S$a){var S$m=S$_._cache2[S$a];if(S$m)this._words=S$m[0],this._size=S$m[1];else{this._words=S$a.split(" ");for(var S$s=0,S$P=this._words.length;S$s<S$P;S$s++)if(0<this._words[S$s].indexOf("px")){this._index=S$s;break}this._size=parseInt(this._words[this._index]),S$_._cache2[S$a]=[this._words,this._size]}this._text=null,this._italic=-2},S$a.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},S$a.hasType=function(S$a){for(var S$m=0,S$s=this._words.length;S$m<S$s;S$m++)if(this._words[S$m]===S$a)return S$m;return-1},S$a.removeType=function(S$a){for(var S$m=0,S$s=this._words.length;S$m<S$s;S$m++)if(this._words[S$m]===S$a){this._words.splice(S$m,1),this._index>S$m&&this._index--;break}this._text=null,this._italic=-2},S$a.copyTo=function(S$a){return S$a._text=this._text,S$a._size=this._size,S$a._index=this._index,S$a._words=this._words.slice(),S$a._italic=-2,S$a},S$a.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},S$P(0,S$a,"size",function(){return this._size},function(S$a){this._size=S$a,this._words[this._index]=S$a+"px",this._text=null}),S$_.create=function(S$a){var S$m=S$_._cache[S$a];return S$m||(S$m=S$_._cache[S$a]=new S$_(S$a))},S$_.EMPTY=new S$_,S$_._cache={},S$_._cache2=null,S$_}(),S$ha=function(){function S$a(){}return S$d(S$a,"laya.webgl.utils.CONST3D2D"),S$a.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S$a.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],S$a.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],S$a._TMPARRAY=[],S$a._OFFSETX=0,S$a._OFFSETY=0,S$A(S$a,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),S$a}(),S$ua=function(){function S$q(){}return S$d(S$q,"laya.webgl.utils.GlUtils"),S$q.make2DProjection=function(S$a,S$m,S$s){return[2/S$a,0,0,0,0,-2/S$m,0,0,0,0,2/S$s,0,-1,1,0,1]},S$q.fillIBQuadrangle=function(S$a,S$m){if(65535/4<S$m)throw Error("IBQuadrangle count:"+S$m+" must<:"+Math.floor(65535/4));S$m=Math.floor(S$m),S$a._resizeBuffer(6*(S$m+1)*2,!1),S$a.byteLength=S$a.bufferLength;for(var S$s=S$a.getUint16Array(),S$P=0,S$_=0;S$_<S$m;S$_++)S$s[S$P++]=4*S$_,S$s[S$P++]=4*S$_+2,S$s[S$P++]=4*S$_+1,S$s[S$P++]=4*S$_,S$s[S$P++]=4*S$_+3,S$s[S$P++]=4*S$_+2;return S$a.setNeedUpload(),!0},S$q.expandIBQuadrangle=function(S$a,S$m){S$a.bufferLength>=6*S$m*2||S$q.fillIBQuadrangle(S$a,S$m)},S$q.mathCeilPowerOfTwo=function(S$a){return S$a--,S$a|=S$a>>1,S$a|=S$a>>2,S$a|=S$a>>4,S$a|=S$a>>8,S$a|=S$a>>16,++S$a},S$q.fillQuadrangleImgVb=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){var S$k=16+(S$a._byteLength>>2);S$a.byteLength=S$k<<2;var S$j=S$a.getFloat32Array();S$j[(S$k-=16)+2]=S$_[0],S$j[S$k+3]=S$_[1],S$j[S$k+6]=S$_[2],S$j[S$k+7]=S$_[3],S$j[S$k+10]=S$_[4],S$j[S$k+11]=S$_[5],S$j[S$k+14]=S$_[6],S$j[S$k+15]=S$_[7];var S$G=S$e.a,S$y=S$e.b,S$d=S$e.c,S$Q=S$e.d;if(1!==S$G||0!==S$y||0!==S$d||1!==S$Q){S$e.bTransform=!0;var S$q=S$e.tx+S$A,S$h=S$e.ty+S$B;S$j[S$k]=(S$P[0]+S$m)*S$G+(S$P[1]+S$s)*S$d+S$q,S$j[S$k+1]=(S$P[0]+S$m)*S$y+(S$P[1]+S$s)*S$Q+S$h,S$j[S$k+4]=(S$P[2]+S$m)*S$G+(S$P[3]+S$s)*S$d+S$q,S$j[S$k+5]=(S$P[2]+S$m)*S$y+(S$P[3]+S$s)*S$Q+S$h,S$j[S$k+8]=(S$P[4]+S$m)*S$G+(S$P[5]+S$s)*S$d+S$q,S$j[S$k+9]=(S$P[4]+S$m)*S$y+(S$P[5]+S$s)*S$Q+S$h,S$j[S$k+12]=(S$P[6]+S$m)*S$G+(S$P[7]+S$s)*S$d+S$q,S$j[S$k+13]=(S$P[6]+S$m)*S$y+(S$P[7]+S$s)*S$Q+S$h}else S$e.bTransform=!1,S$m+=S$e.tx+S$A,S$s+=S$e.ty+S$B,S$j[S$k]=S$m+S$P[0],S$j[S$k+1]=S$s+S$P[1],S$j[S$k+4]=S$m+S$P[2],S$j[S$k+5]=S$s+S$P[3],S$j[S$k+8]=S$m+S$P[4],S$j[S$k+9]=S$s+S$P[5],S$j[S$k+12]=S$m+S$P[6],S$j[S$k+13]=S$s+S$P[7];return S$a._upload=!0},S$q.fillTranglesVB=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){var S$B=(S$a._byteLength>>2)+S$P.length;S$a.byteLength=S$B<<2;var S$k=S$a.getFloat32Array();S$B-=S$P.length;for(var S$j=S$P.length,S$G=S$_.a,S$y=S$_.b,S$d=S$_.c,S$Q=S$_.d,S$q=0;S$q<S$j;S$q+=4)if(S$k[S$B+S$q+2]=S$P[S$q+2],S$k[S$B+S$q+3]=S$P[S$q+3],1!==S$G||0!==S$y||0!==S$d||1!==S$Q){S$_.bTransform=!0;var S$h=S$_.tx+S$e,S$u=S$_.ty+S$A;S$k[S$B+S$q]=(S$P[S$q]+S$m)*S$G+(S$P[S$q+1]+S$s)*S$d+S$h,S$k[S$B+S$q+1]=(S$P[S$q]+S$m)*S$y+(S$P[S$q+1]+S$s)*S$Q+S$u}else S$_.bTransform=!1,S$m+=S$_.tx+S$e,S$s+=S$_.ty+S$A,S$k[S$B+S$q]=S$m+S$P[S$q],S$k[S$B+S$q+1]=S$s+S$P[S$q+1];return S$a._upload=!0},S$q.copyPreImgVb=function(S$a,S$m,S$s){var S$P=S$a._byteLength>>2;S$a.byteLength=S$P+16<<2;for(var S$_=S$a.getFloat32Array(),S$e=0,S$A=S$P-16;S$e<4;S$e++)S$_[S$P]=S$_[S$A]+S$m,++S$A,S$_[++S$P]=S$_[S$A]+S$s,++S$A,S$_[++S$P]=S$_[S$A],++S$A,S$_[++S$P]=S$_[S$A],++S$P,++S$A;S$a._upload=!0},S$q.fillRectImgVb=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y,S$d){void 0===S$d&&(S$d=!1);var S$Q,S$q,S$h,S$u,S$O,S$p,S$c,S$H,S$o,S$N,S$z,S$U,S$l,S$C,S$f,S$K,S$V=1,S$W=S$B.a,S$b=S$B.b,S$S=S$B.c,S$Z=S$B.d,S$X=S$m&&S$m.width<99999999;if(1!==S$W||0!==S$b||0!==S$S||1!==S$Z?(S$B.bTransform=!0,0===S$b&&0===S$S&&(S$V=23,S$o=S$_+S$s,S$N=S$e+S$P,S$Q=S$W*S$s+(S$z=S$B.tx+S$k),S$h=S$W*S$o+S$z,S$q=S$Z*S$P+(S$U=S$B.ty+S$j),S$u=S$Z*S$N+S$U)):(S$V=23,S$B.bTransform=!1,S$h=(S$Q=S$s+S$B.tx+S$k)+S$_,S$u=(S$q=S$P+S$B.ty+S$j)+S$e),S$X&&(S$O=S$m.x,S$p=S$m.y,S$c=S$m.width+S$O,S$H=S$m.height+S$p),1!==S$V){if(Math.min(S$Q,S$h)>=S$c)return!1;if(Math.min(S$q,S$u)>=S$H)return!1;if(Math.max(S$h,S$Q)<=S$O)return!1;if(Math.max(S$u,S$q)<=S$p)return!1}var S$E=S$a._byteLength>>2;S$a.byteLength=16+S$E<<2;var S$i=S$a.getFloat32Array();switch(S$i[2+S$E]=S$A[0],S$i[3+S$E]=S$A[1],S$i[6+S$E]=S$A[2],S$i[7+S$E]=S$A[3],S$i[10+S$E]=S$A[4],S$i[11+S$E]=S$A[5],S$i[14+S$E]=S$A[6],S$i[15+S$E]=S$A[7],S$V){case 1:S$z=S$B.tx+S$k,S$U=S$B.ty+S$j;var S$t=S$W*S$s,S$L=S$S*S$P,S$R=S$Z*S$P,S$F=S$b*S$s,S$x=S$W*(S$o=S$_+S$s),S$M=S$S*(S$N=S$e+S$P),S$J=S$Z*S$N,S$D=S$b*S$o;S$d?(S$l=S$t+S$L+S$z,S$f=Math.round(S$l)-S$l,S$C=S$R+S$F+S$U,S$K=Math.round(S$C)-S$C,S$i[S$E]=S$l+S$f,S$i[1+S$E]=S$C+S$K,S$i[4+S$E]=S$x+S$L+S$z+S$f,S$i[5+S$E]=S$R+S$D+S$U+S$K,S$i[8+S$E]=S$x+S$M+S$z+S$f,S$i[9+S$E]=S$J+S$D+S$U+S$K,S$i[12+S$E]=S$t+S$M+S$z+S$f,S$i[13+S$E]=S$J+S$F+S$U+S$K):(S$i[S$E]=S$t+S$L+S$z,S$i[1+S$E]=S$R+S$F+S$U,S$i[4+S$E]=S$x+S$L+S$z,S$i[5+S$E]=S$R+S$D+S$U,S$i[8+S$E]=S$x+S$M+S$z,S$i[9+S$E]=S$J+S$D+S$U,S$i[12+S$E]=S$t+S$M+S$z,S$i[13+S$E]=S$J+S$F+S$U);break;case 23:S$d?(S$l=S$Q+S$G,S$f=Math.round(S$l)-S$l,S$C=S$q,S$K=Math.round(S$C)-S$C,S$i[S$E]=S$l+S$f,S$i[1+S$E]=S$C+S$K,S$i[4+S$E]=S$h+S$G+S$f,S$i[5+S$E]=S$q+S$K,S$i[8+S$E]=S$h+S$f,S$i[9+S$E]=S$u+S$K,S$i[12+S$E]=S$Q+S$f,S$i[13+S$E]=S$u+S$K):(S$i[S$E]=S$Q+S$G,S$i[1+S$E]=S$q,S$i[4+S$E]=S$h+S$G,S$i[5+S$E]=S$q,S$i[8+S$E]=S$h,S$i[9+S$E]=S$u,S$i[12+S$E]=S$Q,S$i[13+S$E]=S$u)}return S$a._upload=!0},S$q.fillLineVb=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){var S$k=.5*S$A,S$j=S$q._fillLineArray,S$G=-(S$P-S$e),S$y=S$s-S$_,S$d=Math.sqrt(S$G*S$G+S$y*S$y);S$G/=S$d,S$y/=S$d,S$G*=S$k,S$y*=S$k,S$j[0]=S$s-S$G,S$j[1]=S$P-S$y,S$j[4]=S$s+S$G,S$j[5]=S$P+S$y,S$j[8]=S$_+S$G,S$j[9]=S$e+S$y,S$j[12]=S$_-S$G,S$j[13]=S$e-S$y,S$B&&S$B.transformPointArray(S$j,S$j);var S$Q=16+(S$a._byteLength>>2);return S$a.byteLength=S$Q<<2,S$a.insertData(S$j,S$Q-16),!0},S$q._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S$q}(),S$Oa=(function(){function S$k(){}S$d(S$k,"laya.webgl.utils.MatirxArray"),S$k.ArrayMul=function(S$a,S$m,S$s){if(S$a)if(S$m)for(var S$P=NaN,S$_=NaN,S$e=NaN,S$A=NaN,S$B=0;S$B<4;S$B++)S$P=S$a[S$B],S$_=S$a[S$B+4],S$e=S$a[S$B+8],S$A=S$a[S$B+12],S$s[S$B]=S$P*S$m[0]+S$_*S$m[1]+S$e*S$m[2]+S$A*S$m[3],S$s[S$B+4]=S$P*S$m[4]+S$_*S$m[5]+S$e*S$m[6]+S$A*S$m[7],S$s[S$B+8]=S$P*S$m[8]+S$_*S$m[9]+S$e*S$m[10]+S$A*S$m[11],S$s[S$B+12]=S$P*S$m[12]+S$_*S$m[13]+S$e*S$m[14]+S$A*S$m[15];else S$k.copyArray(S$a,S$s);else S$k.copyArray(S$m,S$s)},S$k.copyArray=function(S$a,S$m){if(S$a&&S$m)for(var S$s=0;S$s<S$a.length;S$s++)S$m[S$s]=S$a[S$s]}}(),function(){function S$m(S$a,S$m,S$s){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=S$a,this._vb=new S$ra(S$a,35048),S$m&&this._vb._resizeBuffer(S$m,!1),this._ib=new S$na,S$s&&this._ib._resizeBuffer(S$s,!1)}S$d(S$m,"laya.webgl.utils.Mesh2D");var S$a=S$m.prototype;return S$a.cloneWithNewVB=function(){var S$a=new S$m(this._stride,0,0);return S$a._ib=this._ib,S$a._quadNum=this._quadNum,S$a._attribInfo=this._attribInfo,S$a},S$a.cloneWithNewVBIB=function(){var S$a=new S$m(this._stride,0,0);return S$a._attribInfo=this._attribInfo,S$a},S$a.getVBW=function(){return this._vb.setNeedUpload(),this._vb},S$a.getVBR=function(){return this._vb},S$a.getIBR=function(){return this._ib},S$a.getIBW=function(){return this._ib.setNeedUpload(),this._ib},S$a.createQuadIB=function(S$a){this._quadNum=S$a,this._ib._resizeBuffer(6*S$a*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var S$m=this._ib.getUint16Array(),S$s=0,S$P=0,S$_=0;S$_<S$a;S$_++)S$m[S$s++]=S$P,S$m[S$s++]=S$P+2,S$m[S$s++]=S$P+1,S$m[S$s++]=S$P,S$m[S$s++]=S$P+3,S$m[S$s++]=S$P+2,S$P+=4;this._ib.setNeedUpload()},S$a.setAttributes=function(S$a){if(this._attribInfo=S$a,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},S$a.getEleNum=function(){return this._ib.getBuffer().byteLength/2},S$a.releaseMesh=function(){},S$a.destroy=function(){},S$a.clearVB=function(){this._vb.clear()},S$m._gvaoid=0,S$m}()),S$pa=function(){function S$_(){}return S$d(S$_,"laya.webgl.utils.RenderState2D"),S$_.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},S$_.mat2MatArray=function(S$a,S$m){var S$s=S$a,S$P=S$m;return S$P[0]=S$s.a,S$P[1]=S$s.b,S$P[2]=S$_.EMPTYMAT4_ARRAY[2],S$P[3]=S$_.EMPTYMAT4_ARRAY[3],S$P[4]=S$s.c,S$P[5]=S$s.d,S$P[6]=S$_.EMPTYMAT4_ARRAY[6],S$P[7]=S$_.EMPTYMAT4_ARRAY[7],S$P[8]=S$_.EMPTYMAT4_ARRAY[8],S$P[9]=S$_.EMPTYMAT4_ARRAY[9],S$P[10]=S$_.EMPTYMAT4_ARRAY[10],S$P[11]=S$_.EMPTYMAT4_ARRAY[11],S$P[12]=S$s.tx,S$P[13]=S$s.ty,S$P[14]=S$_.EMPTYMAT4_ARRAY[14],S$P[15]=S$_.EMPTYMAT4_ARRAY[15],S$m},S$_.restoreTempArray=function(){S$_.TEMPMAT4_ARRAY[0]=1,S$_.TEMPMAT4_ARRAY[1]=0,S$_.TEMPMAT4_ARRAY[4]=0,S$_.TEMPMAT4_ARRAY[5]=1,S$_.TEMPMAT4_ARRAY[12]=0,S$_.TEMPMAT4_ARRAY[13]=0},S$_.clear=function(){S$_.worldScissorTest=!1,S$_.worldShaderDefines=null,S$_.worldFilters=null,S$_.worldAlpha=1,S$_.worldClipRect.x=S$_.worldClipRect.y=0,S$_.worldClipRect.width=S$_.width,S$_.worldClipRect.height=S$_.height,S$_.curRenderTarget=null},S$_._MAXSIZE=99999999,S$_.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S$_.worldMatrix4=S$_.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S$_.worldAlpha=1,S$_.worldScissorTest=!1,S$_.worldFilters=null,S$_.worldShaderDefines=null,S$_.curRenderTarget=null,S$_.width=0,S$_.height=0,S$A(S$_,["worldMatrix",function(){return this.worldMatrix=new S$l},"worldClipRect",function(){return this.worldClipRect=new S$f(0,0,99999999,99999999)}]),S$_}(),S$ca=function(){var S$p,S$s;function S$c(S$a,S$m,S$s,S$P,S$_){var S$e=this;function S$A(S$a){var S$m=[],S$s=new S$p(S$m);return S$e._compileToTree(S$s,S$a.split("\n"),0,S$m,S$_),S$s}var S$B=S$Q.now();this._VS=S$A(S$m),this._PS=S$A(S$s),this._nameMap=S$P,2<S$Q.now()-S$B&&console.log("ShaderCompile use time:"+(S$Q.now()-S$B)+"  size:"+S$m.length+"/"+S$s.length)}S$d(S$c,"laya.webgl.utils.ShaderCompile");var S$a=S$c.prototype;return S$a._compileToTree=function(S$a,S$m,S$s,S$P,S$_){var S$e,S$A,S$B,S$k,S$j,S$G,S$y,S$d=0,S$Q=0,S$q=0,S$h=0;for(S$Q=S$s;S$Q<S$m.length;S$Q++)if(!((S$B=S$m[S$Q]).length<1)&&0!==(S$d=S$B.indexOf("//"))){if(0<=S$d&&(S$B=S$B.substr(0,S$d)),S$e=S$y||new S$p(S$P),S$y=null,S$e.text=S$B,S$e.noCompile=!0,0<=(S$d=S$B.indexOf("#"))){for(S$k="#",S$h=S$d+1,S$q=S$B.length;S$h<S$q;S$h++){var S$u=S$B.charAt(S$h);if(" "===S$u||"\t"===S$u||"\r"===S$u||"\n"===S$u||"?"===S$u)break;S$k+=S$u}switch(S$e.name=S$k){case"#ifdef":case"#ifndef":if(S$e.src=S$B,S$e.noCompile=null!=S$B.match(/[!&|()=<>]/),S$e.noCompile?console.log("function():Boolean{return "+S$B.substr(S$d+S$e.name.length)+"}"):(S$G=S$B.replace(/^\s*/,"").split(/\s+/),S$e.setCondition(S$G[1],"#ifdef"===S$k?1:2),S$e.text="//"+S$e.text),S$e.setParent(S$a),S$a=S$e,S$_)for(S$G=S$B.substr(S$h).split(S$c._splitToWordExps3),S$h=0;S$h<S$G.length;S$h++)(S$B=S$G[S$h]).length&&(S$_[S$B]=!0);continue;case"#if":if(S$e.src=S$B,S$e.noCompile=!0,S$e.setParent(S$a),S$a=S$e,S$_)for(S$G=S$B.substr(S$h).split(S$c._splitToWordExps3),S$h=0;S$h<S$G.length;S$h++)(S$B=S$G[S$h]).length&&"defined"!=S$B&&(S$_[S$B]=!0);continue;case"#else":S$e.src=S$B,S$A=(S$a=S$a.parent).childs[S$a.childs.length-1],S$e.noCompile=S$A.noCompile,S$e.noCompile||(S$e.condition=S$A.condition,S$e.conditionType=1==S$A.conditionType?2:1,S$e.text="//"+S$e.text+" "+S$A.text+" "+S$e.conditionType),S$e.setParent(S$a),S$a=S$e;continue;case"#endif":S$A=(S$a=S$a.parent).childs[S$a.childs.length-1],S$e.noCompile=S$A.noCompile,S$e.noCompile||(S$e.text="//"+S$e.text),S$e.setParent(S$a);continue;case"#include":S$G=S$c.splitToWords(S$B,null);var S$O=S$c.includes[S$G[1]];if(!S$O)throw"ShaderCompile error no this include file:"+S$G[1];if((S$d=S$G[0].indexOf("?"))<0){S$e.setParent(S$a),S$B=S$O.getWith("with"==S$G[2]?S$G[3]:null),this._compileToTree(S$e,S$B.split("\n"),0,S$P,S$_),S$e.text="";continue}S$e.setCondition(S$G[0].substr(S$d+1),1),S$e.text=S$O.getWith("with"==S$G[2]?S$G[3]:null);break;case"#import":S$j=(S$G=S$c.splitToWords(S$B,null))[1],S$P.push({node:S$e,file:S$c.includes[S$j],ofs:S$e.text.length});continue}}else{if((S$A=S$a.childs[S$a.childs.length-1])&&!S$A.name){0<S$P.length&&S$c.splitToWords(S$B,S$A),S$y=S$e,S$A.text+="\n"+S$B;continue}0<S$P.length&&S$c.splitToWords(S$B,S$e)}S$e.setParent(S$a)}},S$a.createShader=function(S$a,S$m,S$s){var S$P={},S$_="";if(S$a)for(var S$e in S$a)S$_+="#define "+S$e+"\n",S$P[S$e]=!0;var S$A=this._VS.toscript(S$P,[]),S$B=this._PS.toscript(S$P,[]);return(S$s||S$Ya.create)(S$_+S$A.join("\n"),S$_+S$B.join("\n"),S$m,this._nameMap)},S$c._parseOne=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A={type:S$c.shaderParamsMap[S$s[S$P+1]],name:S$s[S$P+2],size:isNaN(parseInt(S$s[S$P+3]))?1:parseInt(S$s[S$P+3])};return S$e&&("attribute"==S$_?S$a.push(S$A):S$m.push(S$A)),":"==S$s[S$P+3]&&(S$A.type=S$s[S$P+4],S$P+=2),S$P+=2},S$c.addInclude=function(S$a,S$m){if(!S$m||0===S$m.length)throw new Error("add shader include file err:"+S$a);if(S$c.includes[S$a])throw new Error("add shader include file err, has add:"+S$a);S$c.includes[S$a]=new S$s(S$m)},S$c.preGetParams=function(S$a,S$m){var S$s=[S$a,S$m],S$P={},S$_=[],S$e=[],S$A={},S$B=[];S$P.attributes=S$_,S$P.uniforms=S$e,S$P.defines=S$A;for(var S$k=0,S$j=0,S$G=0;S$G<2;S$G++){S$s[S$G]=S$s[S$G].replace(S$c._removeAnnotation,"");var S$y,S$d=S$s[S$G].match(S$c._reg);for(S$k=0,S$j=S$d.length;S$k<S$j;S$k++){var S$Q=S$d[S$k];if("attribute"==S$Q||"uniform"==S$Q)S$k=S$c._parseOne(S$_,S$e,S$d,S$k,S$Q,!0);else{if("#define"==S$Q){S$B[S$Q=S$d[++S$k]]=1;continue}if("#ifdef"==S$Q){S$A[S$y=S$d[++S$k]]=S$A[S$y]||[];for(S$k++;S$k<S$j;S$k++)if("attribute"==(S$Q=S$d[S$k])||"uniform"==S$Q)S$k=S$c._parseOne(S$_,S$e,S$d,S$k,S$Q,S$B[S$y]);else if("#else"==S$Q)for(S$k++;S$k<S$j;S$k++)if("attribute"==(S$Q=S$d[S$k])||"uniform"==S$Q)S$k=S$c._parseOne(S$_,S$e,S$d,S$k,S$Q,!S$B[S$y]);else if("#endif"==S$Q)break}}}}return S$P},S$c.splitToWords=function(S$a,S$m){for(var S$s,S$P,S$_=[],S$e=-1,S$A=0,S$B=S$a.length;S$A<S$B;S$A++)if(S$s=S$a.charAt(S$A),0<=" \t=+-*/&%!<>()'\",;".indexOf(S$s)){if(0<=S$e&&1<S$A-S$e&&(S$P=S$a.substr(S$e,S$A-S$e),S$_.push(S$P)),'"'==S$s||"'"==S$s){var S$k=S$a.indexOf(S$s,S$A+1);if(S$k<0)throw"Sharder err:"+S$a;S$_.push(S$a.substr(S$A+1,S$k-S$A-1)),S$A=S$k,S$e=-1;continue}"("==S$s&&S$m&&0<S$_.length&&(S$P=S$_[S$_.length-1]+";","vec4;main;".indexOf(S$P)<0&&(S$m.useFuns+=S$P)),S$e=-1}else S$e<0&&(S$e=S$A);return S$e<S$B&&1<S$B-S$e&&(S$P=S$a.substr(S$e,S$B-S$e),S$_.push(S$P)),S$_},S$c.IFDEF_NO=0,S$c.IFDEF_YES=1,S$c.IFDEF_ELSE=2,S$c.IFDEF_PARENT=3,S$c._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),S$c._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),S$c._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),S$c.includes={},S$A(S$c,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),S$c.__init$=function(){S$p=function(){function S$s(S$a){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=S$a}S$d(S$s,"");var S$a=S$s.prototype;return S$a.setParent=function(S$a){S$a.childs.push(this),this.z=S$a.z+1,this.parent=S$a},S$a.setCondition=function(S$a,S$m){S$a&&(this.conditionType=S$m,S$a=S$a.replace(/(\s*$)/g,""),this.condition=function(){return this[S$a]},this.condition.__condition=S$a)},S$a.toscript=function(S$a,S$m){return this._toscript(S$a,S$m,++S$s.__id)},S$a._toscript=function(S$P,S$_,S$e){if(this.childs.length<1&&!this.text)return S$_;S$_.length;if(this.condition){var S$a=!!this.condition.call(S$P);if(2===this.conditionType&&(S$a=!S$a),!S$a)return S$_}if(this.text&&S$_.push(this.text),0<this.childs.length&&this.childs.forEach(function(S$a,S$m,S$s){S$a._toscript(S$P,S$_,S$e)}),0<this.includefiles.length&&0<this.useFuns.length)for(var S$m,S$s=0,S$A=this.includefiles.length;S$s<S$A;S$s++)this.includefiles[S$s].curUseID!=S$e&&0<(S$m=this.includefiles[S$s].file.getFunsScript(this.useFuns)).length&&(this.includefiles[S$s].curUseID=S$e,S$_[0]=S$m+S$_[0]);return S$_},S$s.__id=1,S$s}(),S$s=function(){function S$a(S$a){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=S$a;for(var S$m=0,S$s=0,S$P=0;!((S$m=S$a.indexOf("#begin",S$m))<0);){for(S$P=S$m+5;!((S$P=S$a.indexOf("#end",S$P))<0)&&"i"===S$a.charAt(S$P+4);)S$P+=5;if(S$P<0)throw"add include err,no #end:"+S$a;S$s=S$a.indexOf("\n",S$m);var S$_=S$c.splitToWords(S$a.substr(S$m,S$s-S$m),null);"code"==S$_[1]?this.codes[S$_[2]]=S$a.substr(S$s+1,S$P-S$s-1):"function"==S$_[1]&&(S$s=S$a.indexOf("function",S$m),S$s+="function".length,this.funs[S$_[3]]=S$a.substr(S$s+1,S$P-S$s-1),this.funnames+=S$_[3]+";"),S$m=S$P+1}}S$d(S$a,"");var S$m=S$a.prototype;return S$m.getWith=function(S$a){var S$m=S$a?this.codes[S$a]:this.script;if(!S$m)throw"get with error:"+S$a;return S$m},S$m.getFunsScript=function(S$a){var S$m="";for(var S$s in this.funs)0<=S$a.indexOf(S$s+";")&&(S$m+=this.funs[S$s]);return S$m},S$a}()},S$c}(),S$Ha=function(){function S$A(){}return S$d(S$A,"laya.webgl.WebGL"),S$A._uint8ArraySlice=function(){for(var S$a=this.length,S$m=new Uint8Array(this.length),S$s=0;S$s<S$a;S$s++)S$m[S$s]=this[S$s];return S$m},S$A._float32ArraySlice=function(){for(var S$a=this.length,S$m=new Float32Array(this.length),S$s=0;S$s<S$a;S$s++)S$m[S$s]=this[S$s];return S$m},S$A._uint16ArraySlice=function(S$a){var S$m,S$s=arguments,S$P=0,S$_=0;if(0===S$s.length)for(S$P=this.length,S$m=new Uint16Array(S$P),S$_=0;S$_<S$P;S$_++)S$m[S$_]=this[S$_];else if(2===S$s.length){var S$e=S$s[0],S$A=S$s[1];if(S$e<S$A)for(S$P=S$A-S$e,S$m=new Uint16Array(S$P),S$_=S$e;S$_<S$A;S$_++)S$m[S$_-S$e]=this[S$_];else S$m=new Uint16Array(0)}return S$m},S$A.expandContext=function(){var S$a=S$_.prototype,S$m=CanvasRenderingContext2D.prototype;S$m.fillTrangles=S$a.fillTrangles,S$Ta.__int__(null),S$m.setIBVB=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){void 0===S$k&&(S$k=0),void 0===S$j&&(S$j=0),null===S$s&&(this._ib=this._ib||S$na.QuadrangleIB,S$s=this._ib,S$ua.expandIBQuadrangle(S$s,S$P._byteLength/64+8)),this._setIBVB(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j)},S$m.fillTrangles=function(S$a,S$m,S$s,S$P,S$_){this._curMat=this._curMat||S$l.create(),this._vb=this._vb||S$ra.create(),this._ib||(this._ib=S$na.create(),S$ua.fillIBQuadrangle(this._ib,S$A/4));var S$e=this._vb,S$A=S$P.length>>4;S$ua.fillTranglesVB(S$e,S$m,S$s,S$P,S$_||this._curMat,0,0),S$ua.expandIBQuadrangle(this._ib,S$e._byteLength/64+8);var S$B=new S$Ua(1,0);S$B.textureHost=S$a;var S$k=new S$$a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");S$e._vertType=3,this._setIBVB(S$m,S$s,this._ib,S$e,6*S$A,S$_,S$k,S$B,0,0)}},S$A.enable=function(){if(S$Q.__init__(),S$O.isConchApp&&!S$O.isConchWebGL)return S$o.skinAniSprite=function(){return new S$aa},S$A.expandContext(),!1;if(S$o.getWebGLContext=function(S$a){for(var S$m,S$s=["webgl","experimental-webgl","webkit-3d","moz-webgl"],S$P=0;S$P<S$s.length;S$P++){try{S$m=S$a.getContext(S$s[S$P],{stencil:S$z.isStencil,alpha:S$z.isAlpha,antialias:S$z.isAntialias,premultipliedAlpha:S$z.premultipliedAlpha,preserveDrawingBuffer:S$z.preserveDrawingBuffer})}catch(S$a){}if(S$m)return S$m}return null},null==(S$A.mainContext=S$A.mainContext||S$o.getWebGLContext(S$O._mainCanvas)))return!1;if(S$O.isWebGL)return!0;S$u.create=function(S$a,S$m){return new S$am(S$a,S$m)},S$m.create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){return new S$va(S$a,S$m,S$s,S$P,S$_,S$e,S$A)},S$O.WebGL=S$A,S$O.isWebGL=!0,S$Qa.__init__(),S$o.createRenderSprite=function(S$a,S$m){return new S$la(S$a,S$m)},S$o.createWebGLContext2D=function(S$a){return new S$za(S$a)},S$o.changeWebGLSize=function(S$a,S$m){laya.webgl.WebGL.onStageResize(S$a,S$m)},S$o.createGraphics=function(){return new S$Na};var S$a=S$o.createFilterAction;return S$o.createFilterAction=S$a||function(S$a){return new S$Ca},S$o.clear=function(S$a){S$pa.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var S$m=S$O.context.ctx,S$s=0==S$m._submits._length||S$z.preserveDrawingBuffer?S$q.create(S$a)._color:S$V._wgColor;S$s&&S$m.clearBG(S$s[0],S$s[1],S$s[2],S$s[3]),S$pa.clear()},S$o.addToAtlas=function(S$a,S$m){void 0===S$m&&(S$m=!1);var S$s=S$a.bitmap;S$O.optimizeTextureMemory(S$a.url,S$a)?S$N.__typeof(S$s,"laya.webgl.resource.IMergeAtlasBitmap")&&S$s.allowMerageInAtlas&&S$s.on("recovered",S$a,S$a.addTextureToAtlas):S$s.enableMerageInAtlas=!1},S$o.isAtlas=function(S$a){return S$a instanceof laya.webgl.atlas.AtlasWebGLCanvas},S$F._enable(),S$o.beginFlush=function(){for(var S$a=S$F.instance,S$m=S$a.getAtlaserCount(),S$s=0;S$s<S$m;S$s++){var S$P=S$a.getAtlaserByIndex(S$s).texture;S$P._flashCacheImageNeedFlush&&S$o.flashFlushImage(S$P)}},S$o.drawToCanvas=function(S$a,S$m,S$s,S$P,S$_,S$e){(S$s<=0||S$P<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),S$s|=0,S$P|=0,S$_|=0,S$e|=0;var S$A=S$ia.create(S$s,S$P,6408,5121,0,!1);S$A.start(),S$A.clear(0,0,0,0),S$O.context.clear(),S$p.renders[S$m]._fun(S$a,S$O.context,S$_,S$pa.height-S$P+S$e),S$O.context.flush(),S$A.end();var S$B=S$A.getData(0,0,S$s,S$P);if(S$A.recycle(),S$B.byteLength==S$s*S$P*4){var S$k=new S$Da;S$k._canvas=S$Q.createElement("canvas"),S$k.size(S$s,S$P);var S$j=S$k._canvas.getContext("2d");S$Q.canvas.size(S$s,S$P);var S$G=S$Q.context,S$y=S$G.createImageData(S$s,S$P);return S$y.data.set(new Uint8ClampedArray(S$B.buffer)),S$k._imgData=S$y,S$G.putImageData(S$y,0,0),S$j.save(),S$j.translate(0,S$P),S$j.scale(1,-1),S$j.drawImage(S$Q.canvas.source,0,0),S$j.restore(),S$k}console.log("drawToCanvas error: w:"+S$s+",h:"+S$P+",datalen:"+S$B.byteLength)},S$o.createFilterAction=function(S$a){var S$m;switch(S$a){case 32:S$m=new S$Ca}return S$m},S$o.addTextureToAtlas=function(S$a){S$a._uvID++,S$F._atlasRestore++,S$a.bitmap.enableMerageInAtlas&&S$F.instance.addToAtlas(S$a)},S$o.getTexturePixels=function(S$a,S$m,S$s,S$P,S$_){S$O.context.ctx.clear();var S$e=new S$K;S$e.graphics.drawTexture(S$a,-S$m,-S$s);var S$A=S$ia.create(S$P,S$_);S$A.start(),S$A.clear(0,0,0,0),S$e.render(S$O.context,0,0),S$O.context.ctx.flush(),S$A.end();for(var S$B=S$A.getData(0,0,S$P,S$_),S$k=[],S$j=0,S$G=S$_-1;0<=S$G;S$G--)for(var S$y=0;S$y<S$P;S$y++)S$j=4*(S$G*S$P+S$y),S$k.push(S$B[S$j]),S$k.push(S$B[S$j+1]),S$k.push(S$B[S$j+2]),S$k.push(S$B[S$j+3]);return S$k},S$o.skinAniSprite=function(){return new S$aa},S$h.create=function(S$a,S$m){var S$s=new S$Da;return S$s._imgData=S$m,S$s.flipY=!1,S$s},S$U._filterStart=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$a.getValue("bounds"),S$A=S$ia.create(S$e.width,S$e.height);if(S$A.start(),S$A.clear(0,0,0,0),S$a.addValue("src",S$A),S$a.addValue("ScissorTest",S$pa.worldScissorTest),S$pa.worldScissorTest){var S$B=new S$f;S$B.copyFrom(S$s.ctx._clipRect),S$a.addValue("clipRect",S$B),S$pa.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},S$U._filterEnd=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$a.getValue("bounds");S$a.getValue("src").end();var S$A=S$ia.create(S$e.width,S$e.height);S$A.start(),S$A.clear(0,0,0,0),S$a.addValue("out",S$A),S$m._set$P("_filterCache",S$A),S$m._set$P("_isHaveGlowFilter",S$a.getValue("_isHaveGlowFilter"))},S$U._EndTarget=function(S$a,S$m){if(S$a.getValue("src").recycle(),S$a.getValue("out").end(),S$a.getValue("ScissorTest")){S$pa.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),S$m.ctx.save();var S$s=S$a.getValue("clipRect");S$m.ctx.clipRect(S$s.x,S$s.y,S$s.width,S$s.height)}},S$U._useSrc=function(S$a){var S$m=S$a.getValue("out");S$m.end(),(S$m=S$a.getValue("src")).start(),S$m.clear(0,0,0,0)},S$U._endSrc=function(S$a){S$a.getValue("src").end()},S$U._useOut=function(S$a){var S$m=S$a.getValue("src");S$m.end(),(S$m=S$a.getValue("out")).start(),S$m.clear(0,0,0,0)},S$U._endOut=function(S$a){S$a.getValue("out").end()},S$U._recycleScope=function(S$a){S$a.recycle()},S$U._filter=function(S$a,S$m,S$s,S$P){var S$_=this._next;if(S$_){var S$e,S$A,S$B=S$a.filters,S$k=S$B.length;if(1==S$k&&32==S$B[0].type)return S$m.ctx.save(),S$m.ctx.setFilters([S$B[0]]),S$_._fun.call(S$_,S$a,S$m,S$s,S$P),void S$m.ctx.restore();var S$j=S$Ba.create(),S$G=S$C.TEMP,S$y=S$m.ctx._getTransformMatrix(),S$d=S$l.create();S$y.copyTo(S$d);var S$Q=0,S$q=0,S$h=!1,S$u=S$a._$P._filterCache?S$a._$P._filterCache:null;if(!S$u||S$a._repaint){S$h=S$a._isHaveGlowFilter(),S$j.addValue("_isHaveGlowFilter",S$h),S$h&&(S$Q=50,S$q=25),(S$A=new S$f).copyFrom(S$a.getSelfBounds()),S$A.x+=S$a.x,S$A.y+=S$a.y,S$A.x-=S$a.pivotX+4,S$A.y-=S$a.pivotY+4;var S$O=S$A.x,S$p=S$A.y;if(S$A.width+=S$Q+8,S$A.height+=S$Q+8,S$G.x=S$A.x*S$d.a+S$A.y*S$d.c,S$G.y=S$A.y*S$d.d+S$A.x*S$d.b,S$A.x=S$G.x,S$A.y=S$G.y,S$G.x=S$A.width*S$d.a+S$A.height*S$d.c,S$G.y=S$A.height*S$d.d+S$A.width*S$d.b,S$A.width=S$G.x,S$A.height=S$G.y,S$A.width<=0||S$A.height<=0)return;S$u&&S$u.recycle(),S$j.addValue("bounds",S$A);var S$c=S$Aa.create([S$j,S$a,S$m,0,0],S$U._filterStart);S$m.addRenderObject(S$c),S$m.ctx._renderKey=0,S$m.ctx._shader2D.glTexture=null;var S$H=S$a.x-S$O+S$q,S$o=S$a.y-S$p+S$q;S$_._fun.call(S$_,S$a,S$m,S$H,S$o),S$c=S$Aa.create([S$j,S$a,S$m,0,0],S$U._filterEnd),S$m.addRenderObject(S$c);for(var S$N=0;S$N<S$k;S$N++){0!=S$N&&(S$c=S$Aa.create([S$j],S$U._useSrc),S$m.addRenderObject(S$c),S$e=S$Ua.create(1,0),S$l.TEMP.identity(),S$m.ctx.drawTarget(S$j,0,0,S$A.width,S$A.height,S$l.TEMP,"out",S$e,null,S$M.TOINT.overlay),S$c=S$Aa.create([S$j],S$U._useOut),S$m.addRenderObject(S$c)),S$B[S$N].action.apply3d(S$j,S$a,S$m,0,0)}S$c=S$Aa.create([S$j,S$m],S$U._EndTarget),S$m.addRenderObject(S$c)}else{if((S$h=!!S$a._$P._isHaveGlowFilter&&S$a._$P._isHaveGlowFilter)&&(S$Q=50,S$q=25),(S$A=S$a.getBounds()).width<=0||S$A.height<=0)return;S$A.width+=S$Q,S$A.height+=S$Q,S$G.x=S$A.x*S$d.a+S$A.y*S$d.c,S$G.y=S$A.y*S$d.d+S$A.x*S$d.b,S$A.x=S$G.x,S$A.y=S$G.y,S$G.x=S$A.width*S$d.a+S$A.height*S$d.c,S$G.y=S$A.height*S$d.d+S$A.width*S$d.b,S$A.width=S$G.x,S$A.height=S$G.y,S$j.addValue("out",S$u)}S$s=S$s-S$q-S$a.x,S$P=S$P-S$q-S$a.y,S$G.setTo(S$s,S$P),S$d.transformPoint(S$G),S$s=S$G.x+S$A.x,S$P=S$G.y+S$A.y,S$e=S$Ua.create(1,0),S$l.TEMP.identity(),S$m.ctx.drawTarget(S$j,S$s,S$P,S$A.width,S$A.height,S$l.TEMP,"out",S$e,null,S$M.TOINT.overlay),S$c=S$Aa.create([S$j],S$U._recycleScope),S$m.addRenderObject(S$c),S$d.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=S$A._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=S$A._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=S$A._uint8ArraySlice),!0},S$A.onStageResize=function(S$a,S$m){null!=S$A.mainContext&&(S$A.mainContext.viewport(0,0,S$a,S$m),S$pa.width=S$a,S$pa.height=S$m)},S$A.onInvalidGLRes=function(){S$F.instance.freeAll(),S$H.releaseContentManagers(!0),S$A.doNodeRepaint(S$N.stage),S$A.mainContext.viewport(0,0,S$pa.width,S$pa.height),S$N.stage.event("devicelost")},S$A.doNodeRepaint=function(S$a){0==S$a.numChildren&&S$a.repaint();for(var S$m=0;S$m<S$a.numChildren;S$m++)S$A.doNodeRepaint(S$a.getChildAt(S$m))},S$A.init=function(S$a,S$m,S$s){S$A.mainCanvas=S$a,S$h._createContext=function(S$a){return new S$za(S$a)},S$Da._createContext=function(S$a){return new S$za(S$a)};var S$P=laya.webgl.WebGL.mainContext;if(null!=S$P.getShaderPrecisionFormat){var S$_=S$P.getShaderPrecisionFormat(35633,36338),S$e=S$P.getShaderPrecisionFormat(35632,36338);S$A.shaderHighPrecision=!(!S$_.precision||!S$e.precision)}else S$A.shaderHighPrecision=!1;if(S$A.compressAstc=S$P.getExtension("WEBGL_compressed_texture_astc"),S$A.compressAtc=S$P.getExtension("WEBGL_compressed_texture_atc"),S$A.compressEtc=S$P.getExtension("WEBGL_compressed_texture_etc"),S$A.compressEtc1=S$P.getExtension("WEBGL_compressed_texture_etc1"),S$A.compressPvrtc=S$P.getExtension("WEBGL_compressed_texture_pvrtc"),S$A.compressS3tc=S$P.getExtension("WEBGL_compressed_texture_s3tc"),S$A.compressS3tc_srgb=S$P.getExtension("WEBGL_compressed_texture_s3tc_srgb"),S$A.compressAstc=S$A.compressAstc?S$A.compressAstc:{},S$A.compressAtc=S$A.compressAtc?S$A.compressAtc:{},S$A.compressEtc=S$A.compressEtc?S$A.compressEtc:{},S$A.compressEtc1=S$A.compressEtc1?S$A.compressEtc1:{},S$A.compressPvrtc=S$A.compressPvrtc?S$A.compressPvrtc:{},S$A.compressS3tc=S$A.compressS3tc?S$A.compressS3tc:{},S$A.compressS3tc_srgb=S$A.compressS3tc_srgb?S$A.compressS3tc_srgb:{},S$P.deleteTexture1=S$P.deleteTexture,S$P.deleteTexture=function(S$a){S$a==S$oa.curBindTexValue&&(S$oa.curBindTexValue=null),S$P.deleteTexture1(S$a)},S$A.onStageResize(S$m,S$s),null==S$A.mainContext)throw new Error("webGL getContext err!");S$S.__init__(),S$F.__init__(),S$Ka.__init__(),S$ea.__init__(),S$za.__init__(),S$Ua.__init__(),S$n.__init__(),S$Ta.__int__(S$P),S$M._init_(S$P),S$O.isConchApp&&conch.setOnInvalidGLRes(S$A.onInvalidGLRes)},S$A.mainCanvas=null,S$A.antialias=!0,S$A.shaderHighPrecision=!1,S$A._bg_null=[0,0,0,0],S$A}(),S$oa=function(){function S$P(){}return S$d(S$P,"laya.webgl.WebGLContext"),S$P.UseProgram=function(S$a){return S$P._useProgram!==S$a&&(S$Ha.mainContext.useProgram(S$a),S$P._useProgram=S$a,!0)},S$P.setDepthTest=function(S$a,S$m){S$m!==S$P._depthTest&&((S$P._depthTest=S$m)?S$a.enable(2929):S$a.disable(2929))},S$P.setDepthMask=function(S$a,S$m){S$m!==S$P._depthMask&&(S$P._depthMask=S$m,S$a.depthMask(S$m))},S$P.setDepthFunc=function(S$a,S$m){S$m!==S$P._depthFunc&&(S$P._depthFunc=S$m,S$a.depthFunc(S$m))},S$P.setBlend=function(S$a,S$m){S$m!==S$P._blend&&((S$P._blend=S$m)?S$a.enable(3042):S$a.disable(3042))},S$P.setBlendFunc=function(S$a,S$m,S$s){(S$m!==S$P._sFactor||S$s!==S$P._dFactor)&&(S$P._sFactor=S$m,S$P._dFactor=S$s,S$a.blendFunc(S$m,S$s))},S$P.setCullFace=function(S$a,S$m){S$m!==S$P._cullFace&&((S$P._cullFace=S$m)?S$a.enable(2884):S$a.disable(2884))},S$P.setFrontFace=function(S$a,S$m){S$m!==S$P._frontFace&&(S$P._frontFace=S$m,S$a.frontFace(S$m))},S$P.bindTexture=function(S$a,S$m,S$s){S$a.bindTexture(S$m,S$s),S$P.curBindTexTarget=S$m,S$P.curBindTexValue=S$s},S$P.DEPTH_BUFFER_BIT=256,S$P.STENCIL_BUFFER_BIT=1024,S$P.COLOR_BUFFER_BIT=16384,S$P.POINTS=0,S$P.LINES=1,S$P.LINE_LOOP=2,S$P.LINE_STRIP=3,S$P.TRIANGLES=4,S$P.TRIANGLE_STRIP=5,S$P.TRIANGLE_FAN=6,S$P.ZERO=0,S$P.ONE=1,S$P.SRC_COLOR=768,S$P.ONE_MINUS_SRC_COLOR=769,S$P.SRC_ALPHA=770,S$P.ONE_MINUS_SRC_ALPHA=771,S$P.DST_ALPHA=772,S$P.ONE_MINUS_DST_ALPHA=773,S$P.DST_COLOR=774,S$P.ONE_MINUS_DST_COLOR=775,S$P.SRC_ALPHA_SATURATE=776,S$P.FUNC_ADD=32774,S$P.BLEND_EQUATION=32777,S$P.BLEND_EQUATION_RGB=32777,S$P.BLEND_EQUATION_ALPHA=34877,S$P.FUNC_SUBTRACT=32778,S$P.FUNC_REVERSE_SUBTRACT=32779,S$P.BLEND_DST_RGB=32968,S$P.BLEND_SRC_RGB=32969,S$P.BLEND_DST_ALPHA=32970,S$P.BLEND_SRC_ALPHA=32971,S$P.CONSTANT_COLOR=32769,S$P.ONE_MINUS_CONSTANT_COLOR=32770,S$P.CONSTANT_ALPHA=32771,S$P.ONE_MINUS_CONSTANT_ALPHA=32772,S$P.BLEND_COLOR=32773,S$P.ARRAY_BUFFER=34962,S$P.ELEMENT_ARRAY_BUFFER=34963,S$P.ARRAY_BUFFER_BINDING=34964,S$P.ELEMENT_ARRAY_BUFFER_BINDING=34965,S$P.STREAM_DRAW=35040,S$P.STATIC_DRAW=35044,S$P.DYNAMIC_DRAW=35048,S$P.BUFFER_SIZE=34660,S$P.BUFFER_USAGE=34661,S$P.CURRENT_VERTEX_ATTRIB=34342,S$P.FRONT=1028,S$P.BACK=1029,S$P.CULL_FACE=2884,S$P.FRONT_AND_BACK=1032,S$P.BLEND=3042,S$P.DITHER=3024,S$P.STENCIL_TEST=2960,S$P.DEPTH_TEST=2929,S$P.SCISSOR_TEST=3089,S$P.POLYGON_OFFSET_FILL=32823,S$P.SAMPLE_ALPHA_TO_COVERAGE=32926,S$P.SAMPLE_COVERAGE=32928,S$P.NO_ERROR=0,S$P.INVALID_ENUM=1280,S$P.INVALID_VALUE=1281,S$P.INVALID_OPERATION=1282,S$P.OUT_OF_MEMORY=1285,S$P.CW=2304,S$P.CCW=2305,S$P.LINE_WIDTH=2849,S$P.ALIASED_POINT_SIZE_RANGE=33901,S$P.ALIASED_LINE_WIDTH_RANGE=33902,S$P.CULL_FACE_MODE=2885,S$P.FRONT_FACE=2886,S$P.DEPTH_RANGE=2928,S$P.DEPTH_WRITEMASK=2930,S$P.DEPTH_CLEAR_VALUE=2931,S$P.DEPTH_FUNC=2932,S$P.STENCIL_CLEAR_VALUE=2961,S$P.STENCIL_FUNC=2962,S$P.STENCIL_FAIL=2964,S$P.STENCIL_PASS_DEPTH_FAIL=2965,S$P.STENCIL_PASS_DEPTH_PASS=2966,S$P.STENCIL_REF=2967,S$P.STENCIL_VALUE_MASK=2963,S$P.STENCIL_WRITEMASK=2968,S$P.STENCIL_BACK_FUNC=34816,S$P.STENCIL_BACK_FAIL=34817,S$P.STENCIL_BACK_PASS_DEPTH_FAIL=34818,S$P.STENCIL_BACK_PASS_DEPTH_PASS=34819,S$P.STENCIL_BACK_REF=36003,S$P.STENCIL_BACK_VALUE_MASK=36004,S$P.STENCIL_BACK_WRITEMASK=36005,S$P.VIEWPORT=2978,S$P.SCISSOR_BOX=3088,S$P.COLOR_CLEAR_VALUE=3106,S$P.COLOR_WRITEMASK=3107,S$P.UNPACK_ALIGNMENT=3317,S$P.PACK_ALIGNMENT=3333,S$P.MAX_TEXTURE_SIZE=3379,S$P.MAX_VIEWPORT_DIMS=3386,S$P.SUBPIXEL_BITS=3408,S$P.RED_BITS=3410,S$P.GREEN_BITS=3411,S$P.BLUE_BITS=3412,S$P.ALPHA_BITS=3413,S$P.DEPTH_BITS=3414,S$P.STENCIL_BITS=3415,S$P.POLYGON_OFFSET_UNITS=10752,S$P.POLYGON_OFFSET_FACTOR=32824,S$P.TEXTURE_BINDING_2D=32873,S$P.SAMPLE_BUFFERS=32936,S$P.SAMPLES=32937,S$P.SAMPLE_COVERAGE_VALUE=32938,S$P.SAMPLE_COVERAGE_INVERT=32939,S$P.NUM_COMPRESSED_TEXTURE_FORMATS=34466,S$P.COMPRESSED_TEXTURE_FORMATS=34467,S$P.DONT_CARE=4352,S$P.FASTEST=4353,S$P.NICEST=4354,S$P.GENERATE_MIPMAP_HINT=33170,S$P.BYTE=5120,S$P.UNSIGNED_BYTE=5121,S$P.SHORT=5122,S$P.UNSIGNED_SHORT=5123,S$P.INT=5124,S$P.UNSIGNED_INT=5125,S$P.FLOAT=5126,S$P.DEPTH_COMPONENT=6402,S$P.ALPHA=6406,S$P.RGB=6407,S$P.RGBA=6408,S$P.LUMINANCE=6409,S$P.LUMINANCE_ALPHA=6410,S$P.UNSIGNED_SHORT_4_4_4_4=32819,S$P.UNSIGNED_SHORT_5_5_5_1=32820,S$P.UNSIGNED_SHORT_5_6_5=33635,S$P.FRAGMENT_SHADER=35632,S$P.VERTEX_SHADER=35633,S$P.MAX_VERTEX_ATTRIBS=34921,S$P.MAX_VERTEX_UNIFORM_VECTORS=36347,S$P.MAX_VARYING_VECTORS=36348,S$P.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,S$P.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,S$P.MAX_TEXTURE_IMAGE_UNITS=34930,S$P.MAX_FRAGMENT_UNIFORM_VECTORS=36349,S$P.SHADER_TYPE=35663,S$P.DELETE_STATUS=35712,S$P.LINK_STATUS=35714,S$P.VALIDATE_STATUS=35715,S$P.ATTACHED_SHADERS=35717,S$P.ACTIVE_UNIFORMS=35718,S$P.ACTIVE_ATTRIBUTES=35721,S$P.SHADING_LANGUAGE_VERSION=35724,S$P.CURRENT_PROGRAM=35725,S$P.NEVER=512,S$P.LESS=513,S$P.EQUAL=514,S$P.LEQUAL=515,S$P.GREATER=516,S$P.NOTEQUAL=517,S$P.GEQUAL=518,S$P.ALWAYS=519,S$P.KEEP=7680,S$P.REPLACE=7681,S$P.INCR=7682,S$P.DECR=7683,S$P.INVERT=5386,S$P.INCR_WRAP=34055,S$P.DECR_WRAP=34056,S$P.VENDOR=7936,S$P.RENDERER=7937,S$P.VERSION=7938,S$P.NEAREST=9728,S$P.LINEAR=9729,S$P.NEAREST_MIPMAP_NEAREST=9984,S$P.LINEAR_MIPMAP_NEAREST=9985,S$P.NEAREST_MIPMAP_LINEAR=9986,S$P.LINEAR_MIPMAP_LINEAR=9987,S$P.TEXTURE_MAG_FILTER=10240,S$P.TEXTURE_MIN_FILTER=10241,S$P.TEXTURE_WRAP_S=10242,S$P.TEXTURE_WRAP_T=10243,S$P.TEXTURE_2D=3553,S$P.TEXTURE=5890,S$P.TEXTURE_CUBE_MAP=34067,S$P.TEXTURE_BINDING_CUBE_MAP=34068,S$P.TEXTURE_CUBE_MAP_POSITIVE_X=34069,S$P.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,S$P.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,S$P.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,S$P.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,S$P.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,S$P.MAX_CUBE_MAP_TEXTURE_SIZE=34076,S$P.TEXTURE0=33984,S$P.TEXTURE1=33985,S$P.TEXTURE2=33986,S$P.TEXTURE3=33987,S$P.TEXTURE4=33988,S$P.TEXTURE5=33989,S$P.TEXTURE6=33990,S$P.TEXTURE7=33991,S$P.TEXTURE8=33992,S$P.TEXTURE9=33993,S$P.TEXTURE10=33994,S$P.TEXTURE11=33995,S$P.TEXTURE12=33996,S$P.TEXTURE13=33997,S$P.TEXTURE14=33998,S$P.TEXTURE15=33999,S$P.TEXTURE16=34e3,S$P.TEXTURE17=34001,S$P.TEXTURE18=34002,S$P.TEXTURE19=34003,S$P.TEXTURE20=34004,S$P.TEXTURE21=34005,S$P.TEXTURE22=34006,S$P.TEXTURE23=34007,S$P.TEXTURE24=34008,S$P.TEXTURE25=34009,S$P.TEXTURE26=34010,S$P.TEXTURE27=34011,S$P.TEXTURE28=34012,S$P.TEXTURE29=34013,S$P.TEXTURE30=34014,S$P.TEXTURE31=34015,S$P.ACTIVE_TEXTURE=34016,S$P.REPEAT=10497,S$P.CLAMP_TO_EDGE=33071,S$P.MIRRORED_REPEAT=33648,S$P.FLOAT_VEC2=35664,S$P.FLOAT_VEC3=35665,S$P.FLOAT_VEC4=35666,S$P.INT_VEC2=35667,S$P.INT_VEC3=35668,S$P.INT_VEC4=35669,S$P.BOOL=35670,S$P.BOOL_VEC2=35671,S$P.BOOL_VEC3=35672,S$P.BOOL_VEC4=35673,S$P.FLOAT_MAT2=35674,S$P.FLOAT_MAT3=35675,S$P.FLOAT_MAT4=35676,S$P.SAMPLER_2D=35678,S$P.SAMPLER_CUBE=35680,S$P.VERTEX_ATTRIB_ARRAY_ENABLED=34338,S$P.VERTEX_ATTRIB_ARRAY_SIZE=34339,S$P.VERTEX_ATTRIB_ARRAY_STRIDE=34340,S$P.VERTEX_ATTRIB_ARRAY_TYPE=34341,S$P.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,S$P.VERTEX_ATTRIB_ARRAY_POINTER=34373,S$P.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,S$P.COMPILE_STATUS=35713,S$P.LOW_FLOAT=36336,S$P.MEDIUM_FLOAT=36337,S$P.HIGH_FLOAT=36338,S$P.LOW_INT=36339,S$P.MEDIUM_INT=36340,S$P.HIGH_INT=36341,S$P.FRAMEBUFFER=36160,S$P.RENDERBUFFER=36161,S$P.RGBA4=32854,S$P.RGB5_A1=32855,S$P.RGB565=36194,S$P.DEPTH_COMPONENT16=33189,S$P.STENCIL_INDEX=6401,S$P.STENCIL_INDEX8=36168,S$P.DEPTH_STENCIL=34041,S$P.RENDERBUFFER_WIDTH=36162,S$P.RENDERBUFFER_HEIGHT=36163,S$P.RENDERBUFFER_INTERNAL_FORMAT=36164,S$P.RENDERBUFFER_RED_SIZE=36176,S$P.RENDERBUFFER_GREEN_SIZE=36177,S$P.RENDERBUFFER_BLUE_SIZE=36178,S$P.RENDERBUFFER_ALPHA_SIZE=36179,S$P.RENDERBUFFER_DEPTH_SIZE=36180,S$P.RENDERBUFFER_STENCIL_SIZE=36181,S$P.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,S$P.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,S$P.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,S$P.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,S$P.COLOR_ATTACHMENT0=36064,S$P.DEPTH_ATTACHMENT=36096,S$P.STENCIL_ATTACHMENT=36128,S$P.DEPTH_STENCIL_ATTACHMENT=33306,S$P.NONE=0,S$P.FRAMEBUFFER_COMPLETE=36053,S$P.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,S$P.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,S$P.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,S$P.FRAMEBUFFER_UNSUPPORTED=36061,S$P.FRAMEBUFFER_BINDING=36006,S$P.RENDERBUFFER_BINDING=36007,S$P.MAX_RENDERBUFFER_SIZE=34024,S$P.INVALID_FRAMEBUFFER_OPERATION=1286,S$P.UNPACK_FLIP_Y_WEBGL=37440,S$P.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,S$P.CONTEXT_LOST_WEBGL=37442,S$P.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,S$P.BROWSER_DEFAULT_WEBGL=37444,S$P._useProgram=null,S$P._depthTest=!0,S$P._depthMask=!0,S$P._blend=!1,S$P._cullFace=!1,S$P.curBindTexTarget=null,S$P.curBindTexValue=null,S$A(S$P,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),S$P}(),S$Na=function(S$a){function S$m(){S$m.__super.call(this)}S$d(S$m,"laya.webgl.display.GraphicsGL",S$B);var S$s=S$m.prototype;return S$s.setShader=function(S$a){this._saveToCmd(S$O.context._setShader,[S$a])},S$s.setIBVB=function(S$a,S$m,S$s,S$P,S$_,S$e){this._saveToCmd(S$O.context._setIBVB,[S$a,S$m,S$s,S$P,S$_,S$e])},S$s.drawParticle=function(S$a,S$m,S$s){var S$P=S$o.createParticleTemplate2D(S$s);S$P.x=S$a,S$P.y=S$m,this._saveToCmd(S$O.context._drawParticle,[S$P])},S$m}(),S$za=function(S$a){var S$s;function S$R(S$a){this._x=0,this._y=0,this._id=++S$R._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,S$R.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=S$R.MAXCLIPRECT,this.mOutPoint,this._canvas=S$a,this._canvas._addReference(),S$R._contextcount++,S$O.isFlash?(this._ib=S$na.create(35044),S$ua.fillIBQuadrangle(this._ib,16)):this._ib=S$na.QuadrangleIB,this.clear()}S$d(S$R,"laya.webgl.canvas.WebGLContext2D",S$_);var S$m=S$R.prototype;return S$m.setIsMainContext=function(){this._isMain=!0},S$m.clearBG=function(S$a,S$m,S$s,S$P){var S$_=S$Ha.mainContext;S$_.clearColor(S$a,S$m,S$s,S$P),S$_.clear(16384)},S$m._getSubmits=function(){return this._submits},S$m._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var S$a=0,S$m=this._submits._length;S$a<S$m;S$a++)this._submits[S$a].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},S$m.destroy=function(){--S$R._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=S$na.QuadrangleIB&&this._ib.releaseResource()},S$m.clear=function(){this._submits||(this._other=S$s.DEFAULT,this._curMat=S$l.create(),this._vb=S$ra.create(-1),this._submits=[],this._save=[S$Y.Create(this)],this._save.length=10,this._shader2D=new S$n,this._triangleMesh=S$Xa.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=S$s.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=S$R.MAXCLIPRECT,this._curSubmit=S$ea.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=S$J.DEFAULT;for(var S$a=0,S$m=this._submits._length;S$a<S$m;S$a++)this._submits[S$a].releaseRender(),this._submits[S$a]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},S$m.size=function(S$a,S$m){if(this._width!=S$a||this._height!=S$m)if(0==S$a||0==S$m){0!=this._vb._byteLength&&(this._width=S$a,this._height=S$m,this._vb.clear(),this._vb.upload());for(var S$s=0,S$P=this._submits._length;S$s<S$P;S$s++)this._submits[S$s].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=S$a,this._height=S$m,this._targets&&this._targets.size(S$a,S$m),this._canvas.memorySize-=this._canvas.memorySize;0===S$a&&0===S$m&&this._releaseMem()},S$m._getTransformMatrix=function(){return this._curMat},S$m.translate=function(S$a,S$m){0===S$a&&0===S$m||(S$I.save(this),this._curMat.bTransform&&(S$T.save(this),this._curMat.transformPointN(S$C.TEMP.setTo(S$a,S$m)),S$a=S$C.TEMP.x,S$m=S$C.TEMP.y),this._x+=S$a,this._y+=S$m)},S$m.save=function(){this._save[this._save._length++]=S$Y.Create(this)},S$m.restore=function(){var S$a=this._save._length;if(!(S$a<1))for(var S$m=S$a-1;0<=S$m;S$m--){var S$s=this._save[S$m];if(S$s.restore(this),S$s.isSaveMark())return void(this._save._length=S$m)}},S$m._fillText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){void 0===S$j&&(S$j=0);var S$G=this._shader2D,S$y=this._curSubmit.shaderValue,S$d=S$_?S$qa.create(S$_):this._other.font;if(S$F.enabled)S$G.ALPHA!==S$y.ALPHA&&(S$G.glTexture=null),S$Qa.drawText(this,S$a,S$m,this._curMat,S$d,S$k||this._other.textAlign,S$e,S$A,S$B,S$s,S$P,S$j);else{this._shader2D.defines.getValue();var S$Q=S$e?S$q.create(S$e)._color:S$G.colorAdd;S$G.ALPHA===S$y.ALPHA&&S$Q===S$G.colorAdd&&S$y.colorAdd===S$G.colorAdd||(S$G.glTexture=null,S$G.colorAdd=S$Q),S$Qa.drawText(this,S$a,S$m,this._curMat,S$d,S$k||this._other.textAlign,S$e,S$A,S$B,S$s,S$P,S$j)}},S$m.fillWords=function(S$a,S$m,S$s,S$P,S$_,S$e){this._fillText(null,S$a,S$m,S$s,S$P,S$_,null,-1,null,S$e)},S$m.fillBorderWords=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._fillBorderText(null,S$a,S$m,S$s,S$P,S$_,S$e,S$A,null)},S$m.fillText=function(S$a,S$m,S$s,S$P,S$_,S$e){this._fillText(S$a,null,S$m,S$s,S$P,S$_,null,-1,S$e)},S$m.strokeText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._fillText(S$a,null,S$m,S$s,S$P,null,S$_,S$e||1,S$A)},S$m.fillBorderText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){this._fillBorderText(S$a,null,S$m,S$s,S$P,S$_,S$e,S$A,S$B)},S$m._fillBorderText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){if(!S$F.enabled)return this._fillText(S$a,S$m,S$s,S$P,S$_,null,S$A,S$B||1,S$k),void this._fillText(S$a,S$m,S$s,S$P,S$_,S$e,null,-1,S$k);var S$j=this._shader2D,S$G=this._curSubmit.shaderValue;S$j.ALPHA!==S$G.ALPHA&&(S$j.glTexture=null);var S$y=S$_?(S$R._fontTemp.setFont(S$_),S$R._fontTemp):this._other.font;S$Qa.drawText(this,S$a,S$m,this._curMat,S$y,S$k||this._other.textAlign,S$e,S$A,S$B||1,S$s,S$P,0)},S$m.fillRect=function(S$a,S$m,S$s,S$P,S$_){var S$e=this._vb;if(S$ua.fillRectImgVb(S$e,this._clipRect,S$a,S$m,S$s,S$P,S$X.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var S$A=this._shader2D.fillStyle;S$_&&(this._shader2D.fillStyle=S$J.create(S$_));var S$B=this._shader2D,S$k=this._curSubmit.shaderValue;if(S$B.fillStyle!==S$k.fillStyle||S$B.ALPHA!==S$k.ALPHA){S$B.glTexture=null;var S$j=this._curSubmit=S$ea.createSubmit(this,this._ib,S$e,(S$e._byteLength-64)/32*3,S$Ua.create(2,0));S$j.shaderValue.color=S$B.fillStyle._color._color,S$j.shaderValue.ALPHA=S$B.ALPHA,this._submits[this._submits._length++]=S$j}this._curSubmit._numEle+=6,this._shader2D.fillStyle=S$A}},S$m.fillTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){if(S$a.loaded&&S$a.bitmap&&S$a.source){var S$k=this._vb,S$j=S$a.bitmap.width,S$G=S$a.bitmap.height,S$y=S$a.uv,S$d=S$A.x%S$a.width,S$Q=S$A.y%S$a.height;if(S$j!=S$B.w||S$G!=S$B.h){if(!S$B.w&&!S$B.h)switch(S$B.oy=S$B.ox=0,S$e){case"repeat":S$B.width=S$P,S$B.height=S$_;break;case"repeat-x":S$B.width=S$P,S$Q<0?S$a.height+S$Q>S$_?S$B.height=S$_:S$B.height=S$a.height+S$Q:(S$B.oy=S$Q,S$a.height+S$Q>S$_?S$B.height=S$_-S$Q:S$B.height=S$a.height);break;case"repeat-y":S$d<0?S$a.width+S$d>S$P?S$B.width=S$P:S$B.width=S$a.width+S$d:(S$B.ox=S$d,S$a.width+S$d>S$P?S$B.width=S$P-S$d:S$B.width=S$a.width),S$B.height=S$_;break;case"no-repeat":S$d<0?S$a.width+S$d>S$P?S$B.width=S$P:S$B.width=S$a.width+S$d:(S$B.ox=S$d,S$a.width+S$d>S$P?S$B.width=S$P-S$d:S$B.width=S$a.width),S$Q<0?S$a.height+S$Q>S$_?S$B.height=S$_:S$B.height=S$a.height+S$Q:(S$B.oy=S$Q,S$a.height+S$Q>S$_?S$B.height=S$_-S$Q:S$B.height=S$a.height);break;default:S$B.width=S$P,S$B.height=S$_}S$B.w=S$j,S$B.h=S$G,S$B.uv=[0,0,S$B.width/S$j,0,S$B.width/S$j,S$B.height/S$G,0,S$B.height/S$G]}if(S$m+=S$B.ox,S$s+=S$B.oy,S$d-=S$B.ox,S$Q-=S$B.oy,S$ua.fillRectImgVb(S$k,this._clipRect,S$m,S$s,S$B.width,S$B.height,S$B.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var S$q=S$Za.create(this,this._ib,S$k,(S$k._byteLength-64)/32*3,S$Ua.create(256,0)),S$h=(this._submits[this._submits._length++]=S$q).shaderValue;S$h.textureHost=S$a;var S$u=S$y[0]*S$j,S$O=S$y[1]*S$G,S$p=(S$y[2]-S$y[0])*S$j,S$c=(S$y[5]-S$y[3])*S$G,S$H=-S$d/S$j,S$o=-S$Q/S$G;S$h.u_TexRange[0]=S$u/S$j,S$h.u_TexRange[1]=S$p/S$j,S$h.u_TexRange[2]=S$O/S$G,S$h.u_TexRange[3]=S$c/S$G,S$h.u_offset[0]=S$H,S$h.u_offset[1]=S$o,S$F.enabled&&!this._isMain&&S$q.addTexture(S$a,(S$k._byteLength>>2)-16),(this._curSubmit=S$q)._renderType=10017,S$q._numEle+=6}}else this.sprite&&S$N.timer.callLater(this,this._repaintSprite)},S$m.setShader=function(S$a){S$g.save(this,1048576,this._shader2D,!0),this._shader2D.shader=S$a},S$m.setFilters=function(S$a){S$g.save(this,2097152,this._shader2D,!0),this._shader2D.filters=S$a,this._curSubmit=S$ea.RENDERBASE,this._renderKey=0,this._drawCount++},S$m.drawTexture=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._drawTextureM(S$a,S$m,S$s,S$P,S$_,S$e,S$A,null,1)},S$m.addTextureVb=function(S$a,S$m,S$s){var S$P=this._curSubmit._vb||this._vb,S$_=S$P._byteLength>>2;S$P.byteLength=S$_+16<<2;for(var S$e=S$P.getFloat32Array(),S$A=0;S$A<16;S$A+=4)S$e[S$_++]=S$a[S$A]+S$m,S$e[S$_++]=S$a[S$A+1]+S$s,S$e[S$_++]=S$a[S$A+2],S$e[S$_++]=S$a[S$A+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),S$P._upload=!0},S$m.willDrawTexture=function(S$a,S$m){if(!(S$a.loaded&&S$a.bitmap&&S$a.source))return this.sprite&&S$N.timer.callLater(this,this._repaintSprite),0;var S$s=S$a.bitmap,S$P=S$s.id+this._shader2D.ALPHA*S$m+10016;if(S$P==this._renderKey)return S$P;var S$_=this._shader2D,S$e=S$_.ALPHA,S$A=this._curSubmit.shaderValue;S$_.ALPHA*=S$m,this._renderKey=S$P,this._drawCount++,S$_.glTexture=S$s;var S$B=this._vb,S$k=null,S$j=S$B._byteLength/32*3,S$G=S$A.textureHost&&S$A.textureHost==S$a&&S$A.textureHost.alphaTexture==S$a.alphaTexture;return S$k=S$Za.create(this,this._ib,S$B,S$j,S$Ua.create(1,0)),(this._submits[this._submits._length++]=S$k).shaderValue.textureHost=S$a,S$k._renderType=10016,S$k._preIsSameTextureShader=10016===this._curSubmit._renderType&&S$_.ALPHA===S$A.ALPHA&&S$G,this._curSubmit=S$k,S$_.ALPHA=S$e,S$P},S$m.drawTextures=function(S$a,S$m,S$s,S$P){if(S$a.loaded&&S$a.bitmap&&S$a.source){var S$_=this._clipRect;if(this._clipRect=S$R.MAXCLIPRECT,this._drawTextureM(S$a,S$m[0],S$m[1],S$a.width,S$a.height,S$s,S$P,null,1)){if(this._clipRect=S$_,S$W.drawCall++,!(S$m.length<4)){for(var S$e=this._curSubmit._vb||this._vb,S$A=this._curMat.a,S$B=this._curMat.d,S$k=2,S$j=S$m.length;S$k<S$j;S$k+=2)S$ua.copyPreImgVb(S$e,(S$m[S$k]-S$m[S$k-2])*S$A,(S$m[S$k+1]-S$m[S$k-1])*S$B),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&S$N.timer.callLater(this,this._repaintSprite)},S$m._drawTextureM=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){if(!S$a.loaded||!S$a.source)return this.sprite&&S$N.timer.callLater(this,this._repaintSprite),!1;var S$j=this._curSubmit._vb||this._vb,S$G=S$a.bitmap;S$m+=S$e,S$s+=S$A,this._drawCount++;var S$y=S$G.id+this._shader2D.ALPHA*S$k+10016;if(S$y!=this._renderKey){this._renderKey=S$y;var S$d=this._curSubmit.shaderValue,S$Q=this._shader2D,S$q=S$Q.ALPHA;S$Q.ALPHA*=S$k,S$Q.glTexture=S$G;var S$h=this._vb,S$u=null,S$O=S$h._byteLength/32*3,S$p=S$d.textureHost&&S$d.textureHost==S$a&&S$d.textureHost.alphaTexture==S$a.alphaTexture;S$u=S$Za.create(this,this._ib,S$h,S$O,S$Ua.create(1,0)),(this._submits[this._submits._length++]=S$u).shaderValue.textureHost=S$a,S$u._renderType=10016,S$u._preIsSameTextureShader=10016===this._curSubmit._renderType&&S$Q.ALPHA===S$d.ALPHA&&S$p,this._curSubmit=S$u,S$j=this._curSubmit._vb||this._vb,S$Q.ALPHA=S$q}return!!S$ua.fillRectImgVb(S$j,this._clipRect,S$m,S$s,S$P||S$a.width,S$_||S$a.height,S$a.uv,S$B||this._curMat,this._x,this._y,0,0)&&(S$F.enabled&&!this._isMain&&this._curSubmit.addTexture(S$a,(S$j._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},S$m._repaintSprite=function(){this.sprite&&this.sprite.repaint()},S$m._drawText=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){var S$G=S$a.bitmap;this._drawCount++;var S$y=S$G.id+this._shader2D.ALPHA+10016;if(S$y!=this._renderKey){this._renderKey=S$y;var S$d=this._curSubmit.shaderValue,S$Q=this._shader2D;S$Q.glTexture=S$G;var S$q=this._vb,S$h=null,S$u=S$q._byteLength/32*3,S$O=S$d.textureHost&&S$d.textureHost==S$a&&S$d.textureHost.alphaTexture==S$a.alphaTexture;(S$h=S$F.enabled?S$Za.create(this,this._ib,S$q,S$u,S$Ua.create(1,0)):S$Za.create(this,this._ib,S$q,S$u,S$Ia.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&S$Q.ALPHA===S$d.ALPHA&&S$O,(this._submits[this._submits._length++]=S$h).shaderValue.textureHost=S$a,S$h._renderType=10016,this._curSubmit=S$h}S$a.active();var S$p=this._curSubmit._vb||this._vb;S$ua.fillRectImgVb(S$p,this._clipRect,S$m+S$A,S$s+S$B,S$P||S$a.width,S$_||S$a.height,S$a.uv,S$e||this._curMat,this._x,this._y,S$k,S$j,!0)&&(S$F.enabled&&!this._isMain&&this._curSubmit.addTexture(S$a,(S$p._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},S$m.drawTextureWithTransform=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){if(S$e){var S$j=this._curMat,S$G=this._x,S$y=this._y;(0!==S$A||0!==S$B)&&(this._x=S$A*S$j.a+S$B*S$j.c,this._y=S$B*S$j.d+S$A*S$j.b),S$e&&S$j.bTransform?(S$l.mul(S$e,S$j,S$R._tmpMatrix),(S$e=S$R._tmpMatrix)._checkTransform()):(this._x+=S$j.tx,this._y+=S$j.ty),this._drawTextureM(S$a,S$m,S$s,S$P,S$_,0,0,S$e,S$k),this._x=S$G,this._y=S$y}else this._drawTextureM(S$a,S$m,S$s,S$P,S$_,S$A,S$B,null,S$k)},S$m.fillQuadrangle=function(S$a,S$m,S$s,S$P,S$_){var S$e=this._curSubmit,S$A=this._vb,S$B=this._shader2D,S$k=S$e.shaderValue;if(this._renderKey=0,S$a.bitmap){var S$j=S$a.bitmap;S$B.glTexture==S$j&&S$B.ALPHA===S$k.ALPHA||(S$B.glTexture=S$j,(S$e=this._curSubmit=S$ea.createSubmit(this,this._ib,S$A,S$A._byteLength/32*3,S$Ua.create(1,0))).shaderValue.glTexture=S$j,this._submits[this._submits._length++]=S$e),S$ua.fillQuadrangleImgVb(S$A,S$m,S$s,S$P,S$a.uv,S$_||this._curMat,this._x,this._y)}else S$e.shaderValue.fillStyle&&S$e.shaderValue.fillStyle.equal(S$a)&&S$B.ALPHA===S$k.ALPHA||(S$B.glTexture=null,(S$e=this._curSubmit=S$ea.createSubmit(this,this._ib,S$A,S$A._byteLength/32*3,S$Ua.create(2,0))).shaderValue.defines.add(2),S$e.shaderValue.fillStyle=S$J.create(S$a),this._submits[this._submits._length++]=S$e),S$ua.fillQuadrangleImgVb(S$A,S$m,S$s,S$P,S$X.DEF_UV,S$_||this._curMat,this._x,this._y);S$e._numEle+=6},S$m.drawTexture2=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){if(0!=S$e){var S$k=this._curMat;if(this._x=S$a*S$k.a+S$m*S$k.c,this._y=S$m*S$k.d+S$a*S$k.b,S$_&&(S$_=S$k.bTransform||S$_.bTransform?(S$l.mul(S$_,S$k,S$R._tmpMatrix),S$R._tmpMatrix):(this._x+=S$_.tx+S$k.tx,this._y+=S$_.ty+S$k.ty,S$l.EMPTY)),1!==S$e||S$A){var S$j=this._shader2D.ALPHA,S$G=this._nBlendType;this._shader2D.ALPHA=S$e,S$A&&(this._nBlendType=S$M.TOINT(S$A)),this._drawTextureM(S$B[0],S$B[1]-S$s,S$B[2]-S$P,S$B[3],S$B[4],0,0,S$_,1),this._shader2D.ALPHA=S$j,this._nBlendType=S$G}else this._drawTextureM(S$B[0],S$B[1]-S$s,S$B[2]-S$P,S$B[3],S$B[4],0,0,S$_,1);this._x=this._y=0}},S$m.drawCanvas=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$a.context;if(this._renderKey=0,S$e._targets)this._submits[this._submits._length++]=S$Sa.create(S$e,0,null),this._curSubmit=S$ea.RENDERBASE,S$e._targets.drawTo(this,S$m,S$s,S$P,S$_);else{var S$A=this._submits[this._submits._length++]=S$Sa.create(S$e,this._shader2D.ALPHA,this._shader2D.filters),S$B=S$P/S$a.width,S$k=S$_/S$a.height,S$j=S$A._matrix;this._curMat.copyTo(S$j),1!=S$B&&1!=S$k&&S$j.scale(S$B,S$k);var S$G=S$j.tx,S$y=S$j.ty;S$j.tx=S$j.ty=0,S$j.transformPoint(S$C.TEMP.setTo(S$m,S$s)),S$j.translate(S$C.TEMP.x+S$G,S$C.TEMP.y+S$y),this._curSubmit=S$ea.RENDERBASE}S$z.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=S$e._targets?"yellow":"green",this.strokeRect(S$m-1,S$s-1,S$P+2,S$_+2,1),this.strokeRect(S$m,S$s,S$P,S$_,1),this.restore())},S$m.drawTarget=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){void 0===S$j&&(S$j=-1);var S$G=this._vb;if(S$ua.fillRectImgVb(S$G,this._clipRect,S$m,S$s,S$P,S$_,S$k||S$X.DEF_UV,S$e||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var S$y=this._curSubmit=S$ya.create(this,this._ib,S$G,(S$G._byteLength-64)/32*3,S$B,S$A);S$y.blendType=-1==S$j?this._nBlendType:S$j,S$y.scope=S$a,this._submits[this._submits._length++]=S$y,this._curSubmit._numEle+=6}},S$m.mixRGBandAlpha=function(S$a){return this._mixRGBandAlpha(S$a,this._shader2D.ALPHA)},S$m._mixRGBandAlpha=function(S$a,S$m){var S$s=(4278190080&S$a)>>>24;return 0!=S$s?S$s*=S$m:S$s=255*S$m,16777215&S$a|S$s<<24},S$m.drawTriangles=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){if(!S$a.loaded||!S$a.source)return this.sprite&&S$N.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;S$a.bitmap;var S$G=this._mixRGBandAlpha(4294967295,S$B),S$y=(S$P.length,S$e.length);this._renderKey=-1;var S$d=this._curSubmit=S$Za.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,S$Ua.create(1,0));return S$d.shaderValue.textureHost=S$a,S$d._renderType=10016,this._submits[this._submits._length++]=S$d,S$A?(S$R._tmpMatrix.a=S$A.a,S$R._tmpMatrix.b=S$A.b,S$R._tmpMatrix.c=S$A.c,S$R._tmpMatrix.d=S$A.d,S$R._tmpMatrix.tx=S$A.tx+S$m,S$R._tmpMatrix.ty=S$A.ty+S$s,S$l.mul(S$R._tmpMatrix,this._curMat,S$R._tmpMatrix)):(S$R._tmpMatrix.a=this._curMat.a,S$R._tmpMatrix.b=this._curMat.b,S$R._tmpMatrix.c=this._curMat.c,S$R._tmpMatrix.d=this._curMat.d,S$R._tmpMatrix.tx=this._curMat.tx+S$m,S$R._tmpMatrix.ty=this._curMat.ty+S$s),this._triangleMesh.addData(S$P,S$_,S$e,S$R._tmpMatrix,S$G,this),this._curSubmit._numEle+=S$y,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},S$m.transform=function(S$a,S$m,S$s,S$P,S$_,S$e){S$T.save(this),S$l.mul(S$l.TEMP.setTo(S$a,S$m,S$s,S$P,S$_,S$e),this._curMat,this._curMat),this._curMat._checkTransform()},S$m.setTransformByMatrix=function(S$a){S$a.copyTo(this._curMat)},S$m.transformByMatrix=function(S$a){S$T.save(this),S$l.mul(S$a,this._curMat,this._curMat),this._curMat._checkTransform()},S$m.rotate=function(S$a){S$T.save(this),this._curMat.rotateEx(S$a)},S$m.scale=function(S$a,S$m){S$T.save(this),this._curMat.scaleEx(S$a,S$m)},S$m.clipRect=function(S$a,S$m,S$s,S$P){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var S$_=S$Ga.create(4);this.addRenderObject(S$_);var S$e=this._vb,S$A=S$e._byteLength>>2;if(S$ua.fillRectImgVb(S$e,null,S$a,S$m,S$s,S$P,S$X.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var S$B=this._curSubmit=S$ea.createSubmit(this,this._ib,S$e,(S$e._byteLength-64)/32*3,S$Ua.create(2,0));S$B.shaderValue.ALPHA=1,this._submits[this._submits._length++]=S$B,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var S$k=S$Ga.create(5);this.addRenderObject(S$k);var S$j=S$e.getFloat32Array(),S$G=Math.min(Math.min(Math.min(S$j[0+S$A],S$j[4+S$A]),S$j[8+S$A]),S$j[12+S$A]),S$y=Math.max(Math.max(Math.max(S$j[0+S$A],S$j[4+S$A]),S$j[8+S$A]),S$j[12+S$A]),S$d=Math.min(Math.min(Math.min(S$j[1+S$A],S$j[5+S$A]),S$j[9+S$A]),S$j[13+S$A]),S$Q=Math.max(Math.max(Math.max(S$j[1+S$A],S$j[5+S$A]),S$j[9+S$A]),S$j[13+S$A]);S$v.save(this,S$k,S$a,S$m,S$s,S$P,S$G,S$d,S$y-S$G,S$Q-S$d),this._curSubmit=S$ea.RENDERBASE}else{S$s*=this._curMat.a,S$P*=this._curMat.d;var S$q=S$C.TEMP;this._curMat.transformPoint(S$q.setTo(S$a,S$m)),S$s<0&&(S$q.x=S$q.x+S$s,S$s=-S$s),S$P<0&&(S$q.y=S$q.y+S$P,S$P=-S$P),this._renderKey=0;var S$h=this._curSubmit=S$ja.create(this);(this._submits[this._submits._length++]=S$h).submitIndex=this._submits._length,S$h.submitLength=9999999,S$w.save(this,S$h);var S$u=this._clipRect,S$O=S$u.x,S$p=S$u.y,S$c=S$q.x+S$s,S$H=S$q.y+S$P;S$O<S$q.x&&(S$u.x=S$q.x),S$p<S$q.y&&(S$u.y=S$q.y),S$u.width=Math.min(S$c,S$O+S$u.width)-S$u.x,S$u.height=Math.min(S$H,S$p+S$u.height)-S$u.y,this._shader2D.glTexture=null,S$h.clipRect.copyFrom(S$u),this._curSubmit=S$ea.RENDERBASE}},S$m.setIBVB=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G){if(void 0===S$k&&(S$k=0),void 0===S$j&&(S$j=0),void 0===S$G&&(S$G=0),null===S$s){if(S$O.isFlash){var S$y=S$P;S$y._selfIB||(S$y._selfIB=S$na.create(35044)),S$y._selfIB.clear(),S$s=S$y._selfIB}else S$s=this._ib;S$ua.expandIBQuadrangle(S$s,S$P._byteLength/(4*S$P.vertexStride*4))}if(!S$B||!S$A)throw Error("setIBVB must input:shader shaderValues");var S$d=S$ka.create(this,S$P,S$s,S$_,S$A,S$B,S$k,S$j,S$G);S$e||(S$e=S$l.EMPTY),S$e.translate(S$a,S$m),S$l.mul(S$e,this._curMat,S$d._mat),S$e.translate(-S$a,-S$m),this._submits[this._submits._length++]=S$d,this._curSubmit=S$ea.RENDERBASE,this._renderKey=0},S$m.addRenderObject=function(S$a){this._submits[this._submits._length++]=S$a},S$m.fillTrangles=function(S$a,S$m,S$s,S$P,S$_){var S$e=this._curSubmit,S$A=this._vb,S$B=this._shader2D,S$k=S$e.shaderValue,S$j=S$P.length>>4,S$G=S$a.bitmap;this._renderKey=0,S$B.glTexture==S$G&&S$B.ALPHA===S$k.ALPHA||((S$e=this._curSubmit=S$ea.createSubmit(this,this._ib,S$A,S$A._byteLength/32*3,S$Ua.create(1,0))).shaderValue.textureHost=S$a,this._submits[this._submits._length++]=S$e),S$ua.fillTranglesVB(S$A,S$m,S$s,S$P,S$_||this._curMat,this._x,this._y),S$e._numEle+=6*S$j},S$m.submitElement=function(S$a,S$m){var S$s=this._submits;for(S$m<0&&(S$m=S$s._length);S$a<S$m;)S$a+=S$s[S$a].renderSubmit()},S$m.finish=function(){S$Ha.mainContext.finish()},S$m.flush=function(){var S$a=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(S$a>this._ib.bufferLength/12&&S$ua.expandIBQuadrangle(this._ib,S$a),!this._isMain&&S$F.enabled&&S$F._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=S$F._atlasRestore;for(var S$m=this._submits,S$s=0,S$P=S$m._length;S$s<S$P;S$s++){var S$_=S$m[S$s];10016===S$_.getRenderType()&&S$_.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),S$ma.instance&&S$ma.getInstance().reset();var S$e;for(S$s=0,S$e=this.meshlist.length;S$s<S$e;S$s++){var S$A=this.meshlist[S$s];S$A.canReuse?S$A.releaseMesh():S$A.destroy()}return this.meshlist.length=0,this._curSubmit=S$ea.RENDERBASE,this._renderKey=0,this._triangleMesh=S$Xa.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},S$m.setPathId=function(S$a){if(this.mId=S$a,-1!=this.mId){this.mHaveKey=!1;var S$m=S$i.getInstance();S$m.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,S$m.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},S$m.movePath=function(S$a,S$m){var S$s=S$a,S$P=S$m;S$a=this._curMat.a*S$s+this._curMat.c*S$P+this._curMat.tx,S$m=this._curMat.b*S$s+this._curMat.d*S$P+this._curMat.ty,this.mX+=S$a,this.mY+=S$m},S$m.beginPath=function(){var S$a=this._getPath();S$a.tempArray.length=0,S$a.closePath=!1,this.mX=0,this.mY=0},S$m.closePath=function(){this._path.closePath=!0},S$m.fill=function(S$a){void 0===S$a&&(S$a=!1);var S$m=this._getPath();this.drawPoly(0,0,S$m.tempArray,this.fillStyle._color.numColor,0,0,S$a)},S$m.stroke=function(){var S$a=this._getPath();if(0<this.lineWidth){if(-1==this.mId)S$a.drawLine(0,0,S$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var S$m=S$i.getInstance().shapeLineDic[this.mId];S$m.rebuild(S$a.tempArray),S$a.setGeomtry(S$m)}else S$i.getInstance().addLine(this.mId,S$a.drawLine(0,0,S$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor));S$a.update();var S$s=[this.mX,this.mY],S$P=S$ea.createShape(this,S$a.ib,S$a.vb,S$a.count,S$a.offset,S$Ua.create(4,0));S$P.shaderValue.ALPHA=this._shader2D.ALPHA,S$P.shaderValue.u_pos=S$s,S$P.shaderValue.u_mmat2=S$pa.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=S$P,this._renderKey=-1}},S$m.line=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=this._curSubmit,S$B=this._vb;if(S$ua.fillLineVb(S$B,this._clipRect,S$a,S$m,S$s,S$P,S$_,S$e)){this._renderKey=0;var S$k=this._shader2D,S$j=S$A.shaderValue;S$k.strokeStyle===S$j.strokeStyle&&S$k.ALPHA===S$j.ALPHA||(S$k.glTexture=null,(S$A=this._curSubmit=S$ea.createSubmit(this,this._ib,S$B,(S$B._byteLength-64)/32*3,S$Ua.create(2,0))).shaderValue.strokeStyle=S$k.strokeStyle,S$A.shaderValue.mainID=2,S$A.shaderValue.ALPHA=S$k.ALPHA,this._submits[this._submits._length++]=S$A),S$A._numEle+=6}},S$m.moveTo=function(S$a,S$m,S$s){void 0===S$s&&(S$s=!0);var S$P=this._getPath();if(S$s){var S$_=S$a,S$e=S$m;S$a=this._curMat.a*S$_+this._curMat.c*S$e,S$m=this._curMat.b*S$_+this._curMat.d*S$e}S$P.addPoint(S$a,S$m)},S$m.lineTo=function(S$a,S$m,S$s){void 0===S$s&&(S$s=!0);var S$P=this._getPath();if(S$s){var S$_=S$a,S$e=S$m;S$a=this._curMat.a*S$_+this._curMat.c*S$e,S$m=this._curMat.b*S$_+this._curMat.d*S$e}S$P.addPoint(S$a,S$m)},S$m.drawCurves=function(S$a,S$m,S$s){this.setPathId(-1),this.beginPath(),this.strokeStyle=S$s[3],this.lineWidth=S$s[4];var S$P=S$s[2];S$a+=S$s[0],S$m+=S$s[1],this.movePath(S$a,S$m),this.moveTo(S$P[0],S$P[1]);for(var S$_=2,S$e=S$P.length;S$_<S$e;)this.quadraticCurveTo(S$P[S$_++],S$P[S$_++],S$P[S$_++],S$P[S$_++]);this.stroke()},S$m.arcTo=function(S$a,S$m,S$s,S$P,S$_){if(-1==this.mId||!this.mHaveKey){var S$e=0,S$A=0,S$B=0,S$k=this._getPath();this._curMat.copyTo(S$R._tmpMatrix),S$R._tmpMatrix.tx=S$R._tmpMatrix.ty=0,S$R._tempPoint.setTo(S$k.getEndPointX(),S$k.getEndPointY()),S$R._tmpMatrix.invertTransformPoint(S$R._tempPoint);var S$j=S$R._tempPoint.x-S$a,S$G=S$R._tempPoint.y-S$m,S$y=Math.sqrt(S$j*S$j+S$G*S$G);if(!(S$y<=1e-6)){var S$d=S$j/S$y,S$Q=S$G/S$y,S$q=S$s-S$a,S$h=S$P-S$m,S$u=S$q*S$q+S$h*S$h,S$O=Math.sqrt(S$u);if(!(S$O<=1e-6)){var S$p=S$q/S$O,S$c=S$h/S$O,S$H=S$d+S$p,S$o=S$Q+S$c,S$N=Math.sqrt(S$H*S$H+S$o*S$o);if(!(S$N<=1e-6)){var S$z=S$H/S$N,S$U=S$o/S$N,S$l=Math.acos(S$z*S$d+S$U*S$Q),S$C=Math.PI/2-S$l,S$f=(S$y=S$_/Math.tan(S$C))*S$d+S$a,S$K=S$y*S$Q+S$m,S$V=Math.sqrt(S$y*S$y+S$_*S$_),S$W=S$a+S$z*S$V,S$b=S$m+S$U*S$V,S$S=0,S$Z=0;if(0<=S$d*S$c-S$Q*S$p){var S$X=2*S$C/S$R.SEGNUM;S$S=Math.sin(S$X),S$Z=Math.cos(S$X)}else S$X=2*-S$C/S$R.SEGNUM,S$S=Math.sin(S$X),S$Z=Math.cos(S$X);S$A=this._curMat.a*S$f+this._curMat.c*S$K,S$B=this._curMat.b*S$f+this._curMat.d*S$K,S$A==this._path.getEndPointX()&&S$B==this._path.getEndPointY()||S$k.addPoint(S$A,S$B);var S$E=S$f-S$W,S$i=S$K-S$b;for(S$e=0;S$e<S$R.SEGNUM;S$e++){var S$t=S$E*S$Z+S$i*S$S,S$L=-S$E*S$S+S$i*S$Z;S$A=S$t+S$W,S$B=S$L+S$b,S$a=this._curMat.a*S$A+this._curMat.c*S$B,S$B=S$m=this._curMat.b*S$A+this._curMat.d*S$B,(S$A=S$a)==this._path.getEndPointX()&&S$B==this._path.getEndPointY()||S$k.addPoint(S$A,S$B),S$E=S$t,S$i=S$L}}}}}},S$m.arc=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){if(void 0===S$e&&(S$e=!1),void 0===S$A&&(S$A=!0),-1!=this.mId){var S$B=S$i.getInstance().shapeDic[this.mId];if(S$B&&this.mHaveKey&&!S$B.needUpdate(this._curMat))return;S$m=S$a=0}var S$k,S$j=0,S$G=0,S$y=0,S$d=0,S$Q=0,S$q=0,S$h=0;if(S$G=S$_-S$P,S$e)if(Math.abs(S$G)>=2*Math.PI)S$G=2*-Math.PI;else for(;0<S$G;)S$G-=2*Math.PI;else if(Math.abs(S$G)>=2*Math.PI)S$G=2*Math.PI;else for(;S$G<0;)S$G+=2*Math.PI;S$k=S$G/(S$h=S$s<101?Math.max(10,S$G*S$s/5):S$s<201?Math.max(10,S$G*S$s/20):Math.max(10,S$G*S$s/40))/2,S$y=Math.abs(4/3*(1-Math.cos(S$k))/Math.sin(S$k)),S$e&&(S$y=-S$y);var S$u=this._getPath(),S$O=NaN,S$p=NaN;for(S$q=0;S$q<=S$h;S$q++)S$j=S$P+S$G*(S$q/S$h),S$d=S$a+Math.cos(S$j)*S$s,S$Q=S$m+Math.sin(S$j)*S$s,S$A&&(S$O=S$d,S$p=S$Q,S$d=this._curMat.a*S$O+this._curMat.c*S$p,S$Q=this._curMat.b*S$O+this._curMat.d*S$p),S$d==this._path.getEndPointX()&&S$Q==this._path.getEndPointY()||S$u.addPoint(S$d,S$Q);S$d=S$a+Math.cos(S$_)*S$s,S$Q=S$m+Math.sin(S$_)*S$s,S$A&&(S$O=S$d,S$p=S$Q,S$d=this._curMat.a*S$O+this._curMat.c*S$p,S$Q=this._curMat.b*S$O+this._curMat.d*S$p),S$d==this._path.getEndPointX()&&S$Q==this._path.getEndPointY()||S$u.addPoint(S$d,S$Q)},S$m.quadraticCurveTo=function(S$a,S$m,S$s,S$P){var S$_=S$y.I,S$e=S$s,S$A=S$P;S$s=this._curMat.a*S$e+this._curMat.c*S$A,S$P=this._curMat.b*S$e+this._curMat.d*S$A,S$e=S$a,S$A=S$m,S$a=this._curMat.a*S$e+this._curMat.c*S$A,S$m=this._curMat.b*S$e+this._curMat.d*S$A;for(var S$B=S$_.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),S$a,S$m,S$s,S$P],30,2),S$k=0,S$j=S$B.length/2;S$k<S$j;S$k++)this.lineTo(S$B[2*S$k],S$B[2*S$k+1],!1);this.lineTo(S$s,S$P,!1)},S$m.rect=function(S$a,S$m,S$s,S$P){this._other=this._other.make(),this._other.path||(this._other.path=new S$D),this._other.path.rect(S$a,S$m,S$s,S$P)},S$m.strokeRect=function(S$a,S$m,S$s,S$P,S$_){var S$e=.5*S$_;this.line(S$a-S$e,S$m,S$a+S$s+S$e,S$m,S$_,this._curMat),this.line(S$a+S$s,S$m,S$a+S$s,S$m+S$P,S$_,this._curMat),this.line(S$a,S$m,S$a,S$m+S$P,S$_,this._curMat),this.line(S$a-S$e,S$m+S$P,S$a+S$s+S$e,S$m+S$P,S$_,this._curMat)},S$m.clip=function(){},S$m.drawPoly=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){void 0===S$A&&(S$A=!1),this._renderKey=0,this._shader2D.glTexture=null;var S$B=this._getPath();if(-1==this.mId)S$B.polygon(S$a,S$m,S$s,S$P,S$_||1,S$e);else if(this.mHaveKey){var S$k=S$i.getInstance().shapeDic[this.mId];S$k.setMatrix(this._curMat),S$k.rebuild(S$B.tempArray),S$B.setGeomtry(S$k)}else{var S$j=S$B.polygon(S$a,S$m,S$s,S$P,S$_||1,S$e);S$i.getInstance().addShape(this.mId,S$j),S$j.setMatrix(this._curMat)}S$B.update();var S$G,S$y=[this.mX,this.mY];if((S$G=S$ea.createShape(this,S$B.ib,S$B.vb,S$B.count,S$B.offset,S$Ua.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,S$G.shaderValue.u_pos=S$y,S$G.shaderValue.u_mmat2=S$pa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=S$G,0<S$_){if(this.mHaveLineKey){var S$d=S$i.getInstance().shapeLineDic[this.mId];S$d.rebuild(S$B.tempArray),S$B.setGeomtry(S$d)}else S$i.getInstance().addShape(this.mId,S$B.drawLine(S$a,S$m,S$s,S$_,S$e));S$B.update(),(S$G=S$ea.createShape(this,S$B.ib,S$B.vb,S$B.count,S$B.offset,S$Ua.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,S$G.shaderValue.u_mmat2=S$pa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=S$G}},S$m.drawParticle=function(S$a,S$m,S$s){S$s.x=S$a,S$s.y=S$m,this._submits[this._submits._length++]=S$s},S$m._getPath=function(){return this._path||(this._path=new S$D)},S$P(0,S$m,"globalCompositeOperation",function(){return S$M.NAMES[this._nBlendType]},function(S$a){var S$m=S$M.TOINT[S$a];null==S$m||this._nBlendType===S$m||(S$g.save(this,65536,this,!0),this._curSubmit=S$ea.RENDERBASE,this._renderKey=0,this._nBlendType=S$m)}),S$P(0,S$m,"strokeStyle",function(){return this._shader2D.strokeStyle},function(S$a){this._shader2D.strokeStyle.equal(S$a)||(S$g.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=S$J.create(S$a))}),S$P(0,S$m,"globalAlpha",function(){return this._shader2D.ALPHA},function(S$a){(S$a=Math.floor(1e3*S$a)/1e3)!=this._shader2D.ALPHA&&(S$g.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=S$a)}),S$P(0,S$m,"asBitmap",null,function(S$a){if(S$a){if(this._targets||(this._targets=new S$$),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),S$P(0,S$m,"fillStyle",function(){return this._shader2D.fillStyle},function(S$a){this._shader2D.fillStyle.equal(S$a)||(S$g.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=S$J.create(S$a))}),S$P(0,S$m,"textAlign",function(){return this._other.textAlign},function(S$a){this._other.textAlign===S$a||(this._other=this._other.make(),S$g.save(this,32768,this._other,!1),this._other.textAlign=S$a)}),S$P(0,S$m,"lineWidth",function(){return this._other.lineWidth},function(S$a){this._other.lineWidth===S$a||(this._other=this._other.make(),S$g.save(this,256,this._other,!1),this._other.lineWidth=S$a)}),S$P(0,S$m,"textBaseline",function(){return this._other.textBaseline},function(S$a){this._other.textBaseline===S$a||(this._other=this._other.make(),S$g.save(this,16384,this._other,!1),this._other.textBaseline=S$a)}),S$P(0,S$m,"font",null,function(S$a){S$a!=this._other.font.toString()&&(this._other=this._other.make(),S$g.save(this,8,this._other,!1),this._other.font===S$qa.EMPTY?this._other.font=new S$qa(S$a):this._other.font.setFont(S$a))}),S$R.__init__=function(){S$s.DEFAULT=new S$s},S$R._tempPoint=new S$C,S$R._SUBMITVBSIZE=32e3,S$R._MAXSIZE=99999999,S$R._RECTVBSIZE=16,S$R.MAXCLIPRECT=new S$f(0,0,99999999,99999999),S$R._COUNT=0,S$R._tmpMatrix=new S$l,S$R.SEGNUM=32,S$R._contextcount=0,S$A(S$R,["_fontTemp",function(){return this._fontTemp=new S$qa},"_drawStyleTemp",function(){return this._drawStyleTemp=new S$J(null)}]),S$R.__init$=function(){S$s=function(){function S$a(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=S$qa.EMPTY}S$d(S$a,"");var S$m=S$a.prototype;return S$m.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=S$qa.EMPTY},S$m.make=function(){return this===S$a.DEFAULT?new S$a:this},S$a.DEFAULT=null,S$a}()},S$R}(),S$Ua=function(S$a){function S$P(S$a,S$m){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,S$P.__super.call(this),this.defines=new S$Ka,this.position=S$P._POSITION,this.mainID=S$a,this.subID=S$m,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.colorMul=S$s.ShieldColor?S$q.create(S$s.ShieldColor)._color:null,this.glTexture=null,this.u_mmat2=null,this._cacheID=S$a|S$m,this._inClassCache=S$P._cache[this._cacheID],0<S$a&&!this._inClassCache&&(this._inClassCache=S$P._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}S$d(S$P,"laya.webgl.shader.d2.value.Value2D",S$L);var S$m=S$P.prototype;return S$m.setValue=function(S$a){},S$m.refresh=function(){var S$a=this.size;return S$a[0]=S$pa.width,S$a[1]=S$pa.height,this.alpha=this.ALPHA*S$pa.worldAlpha,this.mmat=S$pa.worldMatrix4,this},S$m._ShaderWithCompile=function(){return S$Ya.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,S$$a.create)},S$m._withWorldShaderDefines=function(){var S$a=S$pa.worldShaderDefines,S$m=S$Ya.sharders[this.mainID|this.defines._value|S$a.getValue()];if(!S$m){var S$s,S$P={};for(S$s in this.defines.toNameDic())S$P[S$s]="";for(S$s in S$a.toNameDic())S$P[S$s]="";S$m=S$Ya.withCompile2D(0,this.mainID,S$P,this.mainID|this.defines._value|S$a.getValue(),S$$a.create)}var S$_=S$pa.worldFilters;if(!S$_)return S$m;for(var S$e,S$A=S$_.length,S$B=0;S$B<S$A;S$B++)(S$e=S$_[S$B])&&S$e.action.setValue(this);return S$m},S$m.upload=function(){var S$a=S$pa;this.alpha=this.ALPHA*S$a.worldAlpha,S$pa.worldMatrix4!==S$pa.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),this.colorMul?this.defines.add(16384):this.defines.remove(16384),S$Ha.shaderHighPrecision&&this.defines.add(1024);var S$m,S$s=S$a.worldShaderDefines?this._withWorldShaderDefines():S$Ya.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=S$a.width,this.size[1]=S$a.height,this.mmat=S$a.worldMatrix4,S$Ea.activeShader!==S$s?S$s._shaderValueWidth!==S$a.width||S$s._shaderValueHeight!==S$a.height?(S$s._shaderValueWidth=S$a.width,S$s._shaderValueHeight=S$a.height):S$m=S$s._params2dQuick2||S$s._make2dQuick2():S$s._shaderValueWidth!==S$a.width||S$s._shaderValueHeight!==S$a.height?(S$s._shaderValueWidth=S$a.width,S$s._shaderValueHeight=S$a.height):S$m=S$s._params2dQuick1||S$s._make2dQuick1(),S$s.upload(this,S$m)},S$m.setFilters=function(S$a){if(this.filters=S$a)for(var S$m,S$s=S$a.length,S$P=0;S$P<S$s;S$P++)(S$m=S$a[S$P])&&(this.defines.add(S$m.type),S$m.action.setValue(this))},S$m.clear=function(){this.defines.setValue(this.subID)},S$m.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},S$P._initone=function(S$a,S$m){S$P._typeClass[S$a]=S$m,S$P._cache[S$a]=[],S$P._cache[S$a]._length=0},S$P.__init__=function(){S$P._POSITION=[2,5126,!1,4*S$ha.BYTES_PE,0],S$P._TEXCOORD=[2,5126,!1,4*S$ha.BYTES_PE,2*S$ha.BYTES_PE],S$P._initone(2,S$Ra),S$P._initone(4,S$Ma),S$P._initone(256,S$Fa),S$P._initone(512,S$La),S$P._initone(1,S$xa),S$P._initone(65,S$Ia),S$P._initone(9,S$xa)},S$P.create=function(S$a,S$m){var S$s=S$P._cache[S$a|S$m];return S$s._length?S$s[--S$s._length]:new S$P._typeClass[S$a|S$m](S$m)},S$P._POSITION=null,S$P._TEXCOORD=null,S$P._cache=[],S$P._typeClass=[],S$P.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S$P}(),S$la=function(S$a){function S$u(S$a,S$m){S$u.__super.call(this,S$a,S$m)}S$d(S$u,"laya.webgl.utils.RenderSprite3D",S$p);var S$m=S$u.prototype;return S$m.onCreate=function(S$a){switch(S$a){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},S$m._mask=function(S$a,S$m,S$s,S$P){var S$_,S$e,S$A=this._next,S$B=S$a.mask;if(S$B){S$m.ctx.save();var S$k=S$m.ctx.globalCompositeOperation,S$j=new S$f;if(S$j.copyFrom(S$B.getBounds()),S$j.width=Math.round(S$j.width),S$j.height=Math.round(S$j.height),S$j.x=Math.round(S$j.x),S$j.y=Math.round(S$j.y),0<S$j.width&&0<S$j.height){var S$G=S$a._style._tf,S$y=S$Ba.create();S$y.addValue("bounds",S$j),S$_=S$Aa.create([S$y,S$m],laya.webgl.utils.RenderSprite3D.tmpTarget),S$m.addRenderObject(S$_),S$B.render(S$m,-S$j.x,-S$j.y),S$_=S$Aa.create([S$y],laya.webgl.utils.RenderSprite3D.endTmpTarget),S$m.addRenderObject(S$_),S$m.ctx.save(),S$m.clipRect(S$s-S$G.translateX+S$j.x,S$P-S$G.translateY+S$j.y,S$j.width,S$j.height),S$A._fun.call(S$A,S$a,S$m,S$s,S$P),S$m.ctx.restore(),S$e=S$Ga.create(6),S$k=S$m.ctx.globalCompositeOperation,S$e.blendMode="mask",S$m.addRenderObject(S$e),S$l.TEMP.identity();var S$d=S$Ua.create(1,0),S$Q=S$X.INV_UV,S$q=S$j.width,S$h=S$j.height;(S$j.width<32||S$j.height<32)&&((S$Q=S$u.tempUV)[0]=0,S$Q[1]=0,S$Q[2]=32<=S$j.width?1:S$j.width/32,S$Q[3]=0,S$Q[4]=32<=S$j.width?1:S$j.width/32,S$Q[5]=32<=S$j.height?1:S$j.height/32,S$Q[6]=0,S$Q[7]=32<=S$j.height?1:S$j.height/32,S$j.width=32<=S$j.width?S$j.width:32,S$j.height=32<=S$j.height?S$j.height:32,S$Q[1]*=-1,S$Q[3]*=-1,S$Q[5]*=-1,S$Q[7]*=-1,S$Q[1]+=1,S$Q[3]+=1,S$Q[5]+=1,S$Q[7]+=1),S$m.ctx.drawTarget(S$y,S$s+S$j.x-S$G.translateX,S$P+S$j.y-S$G.translateY,S$q,S$h,S$l.TEMP,"tmpTarget",S$d,S$Q,6),S$_=S$Aa.create([S$y],laya.webgl.utils.RenderSprite3D.recycleTarget),S$m.addRenderObject(S$_),(S$e=S$Ga.create(6)).blendMode=S$k,S$m.addRenderObject(S$e)}S$m.ctx.restore()}else S$A._fun.call(S$A,S$a,S$m,S$s,S$P)},S$m._blend=function(S$a,S$m,S$s,S$P){var S$_=S$a._style,S$e=this._next;S$_.blendMode?(S$m.ctx.save(),S$m.ctx.globalCompositeOperation=S$_.blendMode,S$e._fun.call(S$e,S$a,S$m,S$s,S$P),S$m.ctx.restore()):S$e._fun.call(S$e,S$a,S$m,S$s,S$P)},S$m._transform=function(S$a,S$m,S$s,S$P){var S$_=S$a.transform,S$e=this._next;if(S$_&&S$e!=S$p.NORENDER){var S$A=S$m.ctx;S$a._style;S$_.tx=S$s,S$_.ty=S$P;var S$B=S$A._getTransformMatrix(),S$k=S$B.clone();S$l.mul(S$_,S$B,S$B),S$B._checkTransform(),S$_.tx=S$_.ty=0,S$e._fun.call(S$e,S$a,S$m,0,0),S$k.copyTo(S$B),S$k.destroy()}else S$e._fun.call(S$e,S$a,S$m,S$s,S$P)},S$u.tmpTarget=function(S$a,S$m){var S$s=S$a.getValue("bounds"),S$P=S$ia.create(S$s.width,S$s.height);S$P.start(),S$P.clear(0,0,0,0),S$a.addValue("tmpTarget",S$P)},S$u.endTmpTarget=function(S$a){S$a.getValue("tmpTarget").end()},S$u.recycleTarget=function(S$a){S$a.getValue("tmpTarget").recycle(),S$a.recycle()},S$A(S$u,["tempUV",function(){return this.tempUV=new Array(8)}]),S$u}(),S$Ca=function(S$a){function S$m(){this.data=null,S$m.__super.call(this)}S$d(S$m,"laya.filters.webgl.ColorFilterActionGL",S$t);var S$s=S$m.prototype;return S$N.imps(S$s,{"laya.filters.IFilterActionGL":!0}),S$s.setValue=function(S$a){S$a.colorMat=this.data._mat,S$a.colorAlpha=this.data._alpha},S$s.apply3d=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$a.getValue("bounds"),S$A=S$Ua.create(1,0);S$A.setFilters([this.data]);var S$B=S$l.TEMP;S$B.identity(),S$s.ctx.drawTarget(S$a,0,0,S$e.width,S$e.height,S$B,"src",S$A)},S$m}(),S$fa=function(S$a){function S$e(S$a,S$m,S$s,S$P,S$_){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,S$e.__super.call(this,S$a,S$m,S$_),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new S$Ja,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=S$s,this._atlasCanvas.height=S$P,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}S$d(S$e,"laya.webgl.atlas.Atlaser",S$R);var S$m=S$e.prototype;return S$m.computeUVinAtlasTexture=function(S$a,S$m,S$s,S$P){var S$_=S$F.atlasTextureWidth,S$e=S$F.atlasTextureHeight,S$A=S$s/S$_,S$B=S$P/S$e,S$k=(S$s+S$a.bitmap.width)/S$_,S$j=(S$P+S$a.bitmap.height)/S$e,S$G=S$a.bitmap.width/S$_,S$y=S$a.bitmap.height/S$e;S$a.uv=[S$A+S$m[0]*S$G,S$B+S$m[1]*S$y,S$k-(1-S$m[2])*S$G,S$B+S$m[3]*S$y,S$k-(1-S$m[4])*S$G,S$j-(1-S$m[5])*S$y,S$A+S$m[6]*S$G,S$j-(1-S$m[7])*S$y]},S$m.findBitmapIsExist=function(S$a){if(S$a instanceof laya.webgl.resource.WebGLImage){var S$m=S$a,S$s=S$m.url,S$P=this._InAtlasWebGLImagesKey[S$s||S$m.id];if(S$P)return S$P.offsetInfoID}return-1},S$m.addToAtlasTexture=function(S$a,S$m,S$s){if(S$a instanceof laya.webgl.resource.WebGLImage){var S$P=S$a,S$_=S$P.url;this._InAtlasWebGLImagesKey[S$_||S$P.id]={bitmap:S$a,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([S$m,S$s])}this._atlasCanvas.texSubImage2D(S$m,S$s,S$a.atlasSource),S$a.clearAtlasSource()},S$m.addToAtlas=function(S$a,S$m,S$s){S$a._atlasID=this._inAtlasTextureKey.length;var S$P=S$a.uv.slice(),S$_=S$a.bitmap;this._inAtlasTextureKey.push(S$a),this._inAtlasTextureOriUVValue.push(S$P),this._inAtlasTextureBitmapValue.push(S$_),this.computeUVinAtlasTexture(S$a,S$P,S$m,S$s),S$a.bitmap=this._atlasCanvas},S$m.clear=function(){for(var S$a=0,S$m=this._inAtlasTextureKey.length;S$a<S$m;S$a++)this._inAtlasTextureKey[S$a].bitmap=this._inAtlasTextureBitmapValue[S$a],this._inAtlasTextureKey[S$a].uv=this._inAtlasTextureOriUVValue[S$a],this._inAtlasTextureKey[S$a]._atlasID=-1,this._inAtlasTextureKey[S$a].bitmap.lock=!1,this._inAtlasTextureKey[S$a].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},S$m.dispose=function(){this.clear(),this._atlasCanvas.destroy()},S$P(0,S$m,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),S$P(0,S$m,"texture",function(){return this._atlasCanvas}),S$P(0,S$m,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),S$e}(),S$Ka=function(S$a){function S$s(){S$s.__super.call(this,S$s.__name2int,S$s.__int2name,S$s.__int2nameMap)}return S$d(S$s,"laya.webgl.shader.d2.ShaderDefines2D",S$r),S$s.__init__=function(){S$s.reg("TEXTURE2D",1),S$s.reg("COLOR2D",2),S$s.reg("PRIMITIVE",4),S$s.reg("GLOW_FILTER",8),S$s.reg("BLUR_FILTER",16),S$s.reg("COLOR_FILTER",32),S$s.reg("COLOR_ADD",64),S$s.reg("WORLDMAT",128),S$s.reg("FILLTEXTURE",256),S$s.reg("FSHIGHPRECISION",1024),S$s.reg("TXTALPHA",2048),S$s.reg("TXTCOMPRESS",4096),S$s.reg("COLORMUL",16384)},S$s.reg=function(S$a,S$m){S$r._reg(S$a,S$m,S$s.__name2int,S$s.__int2name)},S$s.toText=function(S$a,S$m,S$s){return S$r._toText(S$a,S$m,S$s)},S$s.toInt=function(S$a){return S$r._toInt(S$a,S$s.__name2int)},S$s.TEXTURE2D=1,S$s.COLOR2D=2,S$s.PRIMITIVE=4,S$s.FILTERGLOW=8,S$s.FILTERBLUR=16,S$s.FILTERCOLOR=32,S$s.COLORADD=64,S$s.WORLDMAT=128,S$s.FILLTEXTURE=256,S$s.SKINMESH=512,S$s.SHADERDEFINE_FSHIGHPRECISION=1024,S$s.TXTALPHA=2048,S$s.TXTCOMPRESS=4096,S$s.COLORMUL=16384,S$s.__name2int={},S$s.__int2name=[],S$s.__int2nameMap=[],S$s}(),S$Va=(function(S$a){function S$B(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$B.__super.call(this,S$a,S$m,S$s,S$P,40,S$_,S$e,S$A)}S$d(S$B,"laya.webgl.shapes.Ellipse",S$sa)}(),function(S$a){function S$e(S$a,S$m,S$s,S$P,S$_){this._points=[],this.rebuild(S$s),S$e.__super.call(this,S$a,S$m,0,0,0,S$_,S$P,S$_,0)}S$d(S$e,"laya.webgl.shapes.Line",S$sa);var S$m=S$e.prototype;return S$m.rebuild=function(S$a){var S$m=S$a.length;S$m!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(S$m/2-1)),this.mFloat32Array=new Float32Array(5*S$m)),this._points.length=0;for(var S$s=NaN,S$P=NaN,S$_=-1,S$e=-1,S$A=S$a.length/2,S$B=0;S$B<S$A;S$B++)S$s=S$a[2*S$B],S$P=S$a[2*S$B+1],(.01<Math.abs(S$_-S$s)||.01<Math.abs(S$e-S$P))&&this._points.push(S$s,S$P),S$_=S$s,S$e=S$P},S$m.getData=function(S$a,S$m,S$s){var S$P=[],S$_=[];0<this.borderWidth&&this.createLine2(this._points,S$P,this.borderWidth,S$s,S$_,this._points.length/2),this.mUint16Array.set(S$P,0),this.mFloat32Array.set(S$_,0),S$a.append(this.mUint16Array),S$m.append(this.mFloat32Array)},S$e}()),S$Wa=function(S$a){function S$y(S$a,S$m,S$s,S$P,S$_){this._points=[];for(var S$e=NaN,S$A=NaN,S$B=-1,S$k=-1,S$j=S$s.length/2-1,S$G=0;S$G<S$j;S$G++)S$e=S$s[2*S$G],S$A=S$s[2*S$G+1],(.01<Math.abs(S$B-S$e)||.01<Math.abs(S$k-S$A))&&this._points.push(S$e,S$A),S$B=S$e,S$k=S$A;S$e=S$s[2*S$j],S$A=S$s[2*S$j+1],S$B=this._points[0],S$k=this._points[1],(.01<Math.abs(S$B-S$e)||.01<Math.abs(S$k-S$A))&&this._points.push(S$e,S$A),S$y.__super.call(this,S$a,S$m,0,0,this._points.length/2,0,S$P,S$_)}S$d(S$y,"laya.webgl.shapes.LoopLine",S$sa);var S$m=S$y.prototype;return S$m.getData=function(S$a,S$m,S$s){if(0<this.borderWidth){for(var S$P=this.color,S$_=(S$P>>16&255)/255,S$e=(S$P>>8&255)/255,S$A=(255&S$P)/255,S$B=[],S$k=0,S$j=0,S$G=[],S$y=Math.floor(this._points.length/2),S$d=0;S$d<S$y;S$d++)S$k=this._points[2*S$d],S$j=this._points[2*S$d+1],S$B.push(this.x+S$k,this.y+S$j,S$_,S$e,S$A);this.createLoopLine(S$B,S$G,this.borderWidth,S$s+S$B.length/5),S$a.append(new Uint16Array(S$G)),S$m.append(new Float32Array(S$B))}},S$m.createLoopLine=function(S$a,S$m,S$s,S$P,S$_,S$e){S$a.length;var S$A=S$a.concat(),S$B=S$_||S$a,S$k=this.borderColor,S$j=(S$k>>16&255)/255,S$G=(S$k>>8&255)/255,S$y=(255&S$k)/255,S$d=[S$A[0],S$A[1]],S$Q=[S$A[S$A.length-5],S$A[S$A.length-4]],S$q=S$Q[0]+.5*(S$d[0]-S$Q[0]),S$h=S$Q[1]+.5*(S$d[1]-S$Q[1]);S$A.unshift(S$q,S$h,0,0,0),S$A.push(S$q,S$h,0,0,0);var S$u,S$O,S$p,S$c,S$H,S$o,S$N,S$z,S$U,S$l,S$C,S$f,S$K,S$V,S$W,S$b,S$S,S$Z,S$X,S$E,S$i=S$A.length/5,S$t=S$P,S$L=S$s/2;S$p=S$A[0],S$c=S$A[1],S$l=S$p-(S$H=S$A[5]),S$U=(S$U=-(S$c-(S$o=S$A[6])))/(S$E=Math.sqrt(S$U*S$U+S$l*S$l))*S$L,S$l=S$l/S$E*S$L,S$B.push(S$p-S$U,S$c-S$l,S$j,S$G,S$y,S$p+S$U,S$c+S$l,S$j,S$G,S$y);for(var S$R=1;S$R<S$i-1;S$R++)S$p=S$A[5*(S$R-1)],S$c=S$A[5*(S$R-1)+1],S$H=S$A[5*S$R],S$o=S$A[5*S$R+1],S$N=S$A[5*(S$R+1)],S$z=S$A[5*(S$R+1)+1],S$l=S$p-S$H,S$f=S$H-S$N,S$W=(-(S$U=(S$U=-(S$c-S$o))/(S$E=Math.sqrt(S$U*S$U+S$l*S$l))*S$L)+S$p)*(-(S$l=S$l/S$E*S$L)+S$o)-(-S$U+S$H)*(-S$l+S$c),S$Z=(-(S$C=(S$C=-(S$o-S$z))/(S$E=Math.sqrt(S$C*S$C+S$f*S$f))*S$L)+S$N)*(-(S$f=S$f/S$E*S$L)+S$o)-(-S$C+S$H)*(-S$f+S$z),S$X=(S$K=-S$l+S$c-(-S$l+S$o))*(S$S=-S$C+S$H-(-S$C+S$N))-(S$b=-S$f+S$z-(-S$f+S$o))*(S$V=-S$U+S$H-(-S$U+S$p)),Math.abs(S$X)<.1?(S$X+=10.1,S$B.push(S$H-S$U,S$o-S$l,S$j,S$G,S$y,S$H+S$U,S$o+S$l,S$j,S$G,S$y)):(((S$u=(S$V*S$Z-S$S*S$W)/S$X)-S$H)*(S$u-S$H)+((S$O=(S$b*S$W-S$K*S$Z)/S$X)-S$o)+(S$O-S$o),S$B.push(S$u,S$O,S$j,S$G,S$y,S$H-(S$u-S$H),S$o-(S$O-S$o),S$j,S$G,S$y));S$e&&(S$m=S$e);var S$F=this.edges+1;for(S$R=1;S$R<S$F;S$R++)S$m.push(S$t+2*(S$R-1),S$t+2*(S$R-1)+1,S$t+2*S$R+1,S$t+2*S$R+1,S$t+2*S$R,S$t+2*(S$R-1));return S$m.push(S$t+2*(S$R-1),S$t+2*(S$R-1)+1,S$t+1,S$t+1,S$t,S$t+2*(S$R-1)),S$B},S$y}(),S$ba=function(S$a){function S$A(S$a,S$m,S$s,S$P,S$_,S$e){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=S$l.create(),this._points=S$s.slice(0,S$s.length),S$A.__super.call(this,S$a,S$m,0,0,this._points.length/2,S$P,S$_,S$e)}S$d(S$A,"laya.webgl.shapes.Polygon",S$sa);var S$m=S$A.prototype;return S$m.rebuild=function(S$a){this._repaint||(this._points.length=0,this._points=this._points.concat(S$a))},S$m.setMatrix=function(S$a){S$a.copyTo(this._mat)},S$m.needUpdate=function(S$a){return this._repaint=this._mat.a==S$a.a&&this._mat.b==S$a.b&&this._mat.c==S$a.c&&this._mat.d==S$a.d&&this._mat.tx==S$a.tx&&this._mat.ty==S$a.ty,!this._repaint},S$m.getData=function(S$a,S$m,S$s){var S$P,S$_=0,S$e=this._points,S$A=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=S$s){for(this._start=S$s,S$P=[],S$A=this.earcutTriangles.length,S$_=0;S$_<S$A;S$_++)S$P.push(this.earcutTriangles[S$_]+S$s);this.mUint16Array=new Uint16Array(S$P)}}else{this._start=S$s,S$P=[];var S$B=[],S$k=[],S$j=this.color,S$G=(S$j>>16&255)/255,S$y=(S$j>>8&255)/255,S$d=(255&S$j)/255;for(S$A=Math.floor(S$e.length/2),S$_=0;S$_<S$A;S$_++)S$B.push(this.x+S$e[2*S$_],this.y+S$e[2*S$_+1],S$G,S$y,S$d),S$k.push(this.x+S$e[2*S$_],this.y+S$e[2*S$_+1]);for(this.earcutTriangles=S$Pa.earcut(S$k,null,2),S$A=this.earcutTriangles.length,S$_=0;S$_<S$A;S$_++)S$P.push(this.earcutTriangles[S$_]+S$s);this.mUint16Array=new Uint16Array(S$P),this.mFloat32Array=new Float32Array(S$B)}S$a.append(this.mUint16Array),S$m.append(this.mFloat32Array)},S$A}(),S$Sa=function(S$a){function S$e(){this._matrix=new S$l,this._matrix4=S$ha.defaultMatrix4.concat(),S$e.__super.call(this,1e4),this.shaderValue=new S$Ua(0,0)}S$d(S$e,"laya.webgl.submit.SubmitCanvas",S$ea);var S$m=S$e.prototype;return S$m.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var S$a=S$pa.worldAlpha,S$m=S$pa.worldMatrix4,S$s=S$pa.worldMatrix,S$P=S$pa.worldFilters,S$_=S$pa.worldShaderDefines,S$e=this.shaderValue,S$A=this._matrix,S$B=this._matrix4,S$k=S$l.TEMP;return S$l.mul(S$A,S$s,S$k),S$B[0]=S$k.a,S$B[1]=S$k.b,S$B[4]=S$k.c,S$B[5]=S$k.d,S$B[12]=S$k.tx,S$B[13]=S$k.ty,S$pa.worldMatrix=S$k.clone(),S$pa.worldMatrix4=S$B,S$pa.worldAlpha=S$pa.worldAlpha*S$e.alpha,S$e.filters&&S$e.filters.length&&(S$pa.worldFilters=S$e.filters,S$pa.worldShaderDefines=S$e.defines),this._ctx_src.flush(),S$pa.worldAlpha=S$a,S$pa.worldMatrix4=S$m,S$pa.worldMatrix.destroy(),S$pa.worldMatrix=S$s,S$pa.worldFilters=S$P,S$pa.worldShaderDefines=S$_,1},S$m.releaseRender=function(){var S$a=S$e._cache;this._ctx_src=null,S$a[S$a._length++]=this},S$m.getRenderType=function(){return 10003},S$e.create=function(S$a,S$m,S$s){var S$P=S$e._cache._length?S$e._cache[--S$e._cache._length]:new S$e;S$P._ctx_src=S$a;var S$_=S$P.shaderValue;return S$_.alpha=S$m,S$_.defines.setValue(0),S$s&&S$s.length&&S$_.setFilters(S$s),S$P},S$e._cache=((S$e._cache=[])._length=0,S$e._cache),S$e}(),S$Za=function(S$a){function S$j(S$a){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===S$a&&(S$a=1e4),S$j.__super.call(this,S$a)}S$d(S$j,"laya.webgl.submit.SubmitTexture",S$ea);var S$m=S$j.prototype;return S$m.releaseRender=function(){var S$a=S$j._cache;(S$a[S$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},S$m.addTexture=function(S$a,S$m){this._texsID[this._texs.length]=S$a._uvID,this._texs.push(S$a),this._vbPos.push(S$m)},S$m.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var S$a=this.shaderValue.textureHost.bitmap;if(null!==S$a)for(var S$m=this._vb.getFloat32Array(),S$s=0,S$P=this._texs.length;S$s<S$P;S$s++){var S$_=this._texs[S$s];S$_.active();var S$e=S$_.uv;if(this._texsID[S$s]!==S$_._uvID){this._texsID[S$s]=S$_._uvID;var S$A=this._vbPos[S$s];S$m[S$A+2]=S$e[0],S$m[S$A+3]=S$e[1],S$m[S$A+6]=S$e[2],S$m[S$A+7]=S$e[3],S$m[S$A+10]=S$e[4],S$m[S$A+11]=S$e[5],S$m[S$A+14]=S$e[6],S$m[S$A+15]=S$e[7],this._vb.setNeedUpload()}S$_.bitmap!==S$a&&(this._isSameTexture=!1)}}},S$m.renderSubmit=function(){if(0===this._numEle)return S$j._shaderSet=!1,1;var S$a=this.shaderValue.textureHost;if(S$a){var S$m=S$a.source;if(!S$a.bitmap||!S$m)return S$j._shaderSet=!1,1;this.shaderValue.texture=S$m,S$a.alphaTexture&&S$a.alphaTexture.source&&(this.shaderValue.texture1=S$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var S$s=S$Ha.mainContext;if(S$M.activeBlendFunction!==this._blendFn&&(S$s.enable(3042),this._blendFn(S$s),S$M.activeBlendFunction=this._blendFn),S$W.drawCall++,S$W.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&S$Ea.activeShader&&S$j._shaderSet?(S$Ea.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&S$Ea.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),S$j._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var S$P=S$a.bitmap,S$_=0,S$e=S$Ea.activeShader,S$A=0,S$B=this._texs.length;S$A<S$B;S$A++){var S$k=this._texs[S$A];S$k.bitmap===S$P&&S$A+1!==S$B||(S$e.uploadTexture2D(S$k.source),S$s.drawElements(4,6*(S$A-S$_+1),5123,this._startIdx+6*S$_*S$ha.BYTES_PIDX),S$P=S$k.bitmap,S$_=S$A)}else S$s.drawElements(4,this._numEle,5123,this._startIdx);return 1},S$j.create=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$j._cache._length?S$j._cache[--S$j._cache._length]:new S$j;null==S$s&&((S$s=S$e._selfVb||(S$e._selfVb=S$ra.create(-1))).clear(),S$P=0),S$e._ib=S$m,S$e._vb=S$s,S$e._startIdx=S$P*S$ha.BYTES_PIDX,S$e._numEle=0;var S$A=S$a._nBlendType;S$e._blendFn=S$a._targets?S$M.targetFns[S$A]:S$M.fns[S$A],S$e.shaderValue=S$_,S$e.shaderValue.setValue(S$a._shader2D);var S$B=S$a._shader2D.filters;return S$B&&S$e.shaderValue.setFilters(S$B),S$e},S$j._cache=((S$j._cache=[])._length=0,S$j._cache),S$j._shaderSet=!0,S$j}(),S$Xa=function(S$a){function S$O(){S$O.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}S$d(S$O,"laya.webgl.utils.MeshTexture",S$Oa);var S$m=S$O.prototype;return S$m.addData=function(S$a,S$m,S$s,S$P,S$_,S$e){for(var S$A=S$a.length/2,S$B=this._vb.needSize(S$A*S$O.const_stride)>>2,S$k=this._vb.getFloat32Array(),S$j=0,S$G=0;S$G<S$A;S$G++){var S$y=S$a[S$j],S$d=S$a[S$j+1],S$Q=S$y*S$P.a+S$d*S$P.c+S$P.tx,S$q=S$y*S$P.b+S$d*S$P.d+S$P.ty;S$k[S$B++]=S$Q,S$k[S$B++]=S$q,S$k[S$B++]=S$m[S$j],S$k[S$B++]=S$m[S$j+1],S$j+=2}this._vb.setNeedUpload();var S$h=this.vertNum;if(0<S$h){(S$A=S$s.length)>S$O.tmpIdx.length&&(S$O.tmpIdx=new Uint16Array(S$A));for(var S$u=0;S$u<S$A;S$u++)S$O.tmpIdx[S$u]=S$s[S$u]+S$h;this._ib.appendU16Array(S$O.tmpIdx,S$s.length)}else this._ib.append(S$s);this._ib.setNeedUpload(),this.vertNum+=S$A,this.indexNum+=S$s.length},S$m.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},S$m.destroy=function(){this._ib.destroy(),this._vb.destroy()},S$O.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new S$O},S$O.const_stride=16,S$O._POOL=[],S$A(S$O,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),S$O}(),S$Ea=function(S$a){function S$m(){S$m.__super.call(this),this.lock=!0}return S$d(S$m,"laya.webgl.shader.BaseShader",S$c),S$m.activeShader=null,S$m.bindShader=null,S$m}(),S$ia=function(S$m){function S$G(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===S$s&&(S$s=6408),void 0===S$P&&(S$P=5121),void 0===S$_&&(S$_=34041),void 0===S$e&&(S$e=!1),void 0===S$A&&(S$A=!1),void 0===S$B&&(S$B=-1),void 0===S$k&&(S$k=-1),this._type=1,this._w=S$a,this._h=S$m,this._surfaceFormat=S$s,this._surfaceType=S$P,this._depthStencilFormat=S$_,S$O.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=S$e,this._repeat=S$A,this._minFifter=S$B,this._magFifter=S$k,this._createWebGLRenderTarget(),this.bitmap.lock=!0,S$G.__super.call(this,this.bitmap,S$X.INV_UV)}S$d(S$G,"laya.webgl.resource.RenderTarget2D",S$m);var S$a=S$G.prototype;return S$N.imps(S$a,{"laya.resource.IDispose":!0}),S$a.getType=function(){return this._type},S$a.getTexture=function(){return this},S$a.size=function(S$a,S$m){this._w==S$a&&this._h==S$m||(this._w=S$a,this._h=S$m,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},S$a.release=function(){this.destroy()},S$a.recycle=function(){S$G.POOL.push(this)},S$a.start=function(){var S$a=S$Ha.mainContext;return this._preRenderTarget=S$pa.curRenderTarget,S$pa.curRenderTarget=this,S$a.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(S$a.viewport(0,0,this._w,this._h),this._svWidth=S$pa.width,this._svHeight=S$pa.height,S$pa.width=this._w,S$pa.height=this._h,S$Ea.activeShader=null),this},S$a.clear=function(S$a,S$m,S$s,S$P){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=1);var S$_=S$Ha.mainContext;S$_.clearColor(S$a,S$m,S$s,S$P);var S$e=16384;switch(this._depthStencilFormat){case 33189:S$e|=256;break;case 36168:S$e|=1024;break;case 34041:S$e|=256,S$e|=1024}S$_.clear(S$e)},S$a.end=function(){var S$a=S$Ha.mainContext;S$a.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,S$pa.curRenderTarget=this._preRenderTarget,1==this._type?(S$a.viewport(0,0,this._svWidth,this._svHeight),S$pa.width=this._svWidth,S$pa.height=this._svHeight,S$Ea.activeShader=null):S$a.viewport(0,0,S$N.stage.width,S$N.stage.height)},S$a.getData=function(S$a,S$m,S$s,S$P){var S$_=S$Ha.mainContext;if(S$_.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===S$_.checkFramebufferStatus(36160)))return S$_.bindFramebuffer(36160,null),null;var S$e=new Uint8Array(this._w*this._h*4);return S$_.readPixels(S$a,S$m,S$s,S$P,this._surfaceFormat,this._surfaceType,S$e),S$_.bindFramebuffer(36160,null),S$e},S$a.destroy=function(S$a){void 0===S$a&&(S$a=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,S$m.prototype.destroy.call(this))},S$a.dispose=function(){},S$a._createWebGLRenderTarget=function(){this.bitmap=new S$wa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(S$a){this.event("recovered")})},S$P(0,S$a,"surfaceFormat",function(){return this._surfaceFormat}),S$P(0,S$a,"magFifter",function(){return this._magFifter}),S$P(0,S$a,"surfaceType",function(){return this._surfaceType}),S$P(0,S$a,"mipMap",function(){return this._mipMap}),S$P(0,S$a,"depthStencilFormat",function(){return this._depthStencilFormat}),S$P(0,S$a,"minFifter",function(){return this._minFifter}),S$P(0,S$a,"source",function(){return this._alreadyResolved?S$N.superGet(S$X,this,"source"):null}),S$G.create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){void 0===S$s&&(S$s=6408),void 0===S$P&&(S$P=5121),void 0===S$_&&(S$_=34041),void 0===S$e&&(S$e=!1),void 0===S$A&&(S$A=!1),void 0===S$B&&(S$B=-1),void 0===S$k&&(S$k=-1);var S$j=S$G.POOL.pop();return S$j||(S$j=new S$G(S$a,S$m)),S$j.bitmap&&S$j._w==S$a&&S$j._h==S$m&&S$j._surfaceFormat==S$s&&S$j._surfaceType==S$P&&S$j._depthStencilFormat==S$_&&S$j._mipMap==S$e&&S$j._repeat==S$A&&S$j._minFifter==S$B&&S$j._magFifter==S$k||(S$j._w=S$a,S$j._h=S$m,S$j._surfaceFormat=S$s,S$j._surfaceType=S$P,S$j._depthStencilFormat=S$_,S$O.isConchWebGL&&34041===S$j._depthStencilFormat&&(S$j._depthStencilFormat=33189),S$j._mipMap=S$e,S$j._repeat=S$A,S$j._minFifter=S$B,S$j._magFifter=S$k,S$j.release(),S$j._createWebGLRenderTarget()),S$j},S$G.TYPE2D=1,S$G.TYPE3D=2,S$G.POOL=[],S$G}(S$X),S$ta=function(S$a){function S$m(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,S$m.__super.call(this),S$m._gl=S$Ha.mainContext}S$d(S$m,"laya.webgl.utils.Buffer",S$c);var S$s=S$m.prototype;return S$s._bind=function(){this.activeResource(),S$m._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(S$m._bindVertexBuffer=this._glBuffer),S$m._gl.bindBuffer(this._bufferType,S$m._bindActive[this._bufferType]=this._glBuffer),S$Ea.activeShader=null)},S$s.recreateResource=function(){this._glBuffer||(this._glBuffer=S$m._gl.createBuffer()),this.completeCreate()},S$s.disposeResource=function(){this._glBuffer&&(S$Ha.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},S$P(0,S$s,"bufferUsage",function(){return this._bufferUsage}),S$m._gl=null,S$m._bindActive={},S$m._bindVertexBuffer=null,S$m._enableAtributes=[],S$m}(),S$La=function(S$a){function S$s(S$a){this.texcoord=null,this.offsetX=300,this.offsetY=0,S$s.__super.call(this,512,0);var S$m=8*S$ha.BYTES_PE;this.position=[2,5126,!1,S$m,0],this.texcoord=[2,5126,!1,S$m,2*S$ha.BYTES_PE],this.color=[4,5126,!1,S$m,4*S$ha.BYTES_PE]}return S$d(S$s,"laya.webgl.shader.d2.skinAnishader.SkinSV",S$Ua),S$s}(),S$Ra=function(S$a){function S$m(S$a){S$m.__super.call(this,2,0),this.color=[]}return S$d(S$m,"laya.webgl.shader.d2.value.Color2dSV",S$Ua),S$m.prototype.setValue=function(S$a){S$a.fillStyle&&(this.color=S$a.fillStyle._color._color),S$a.strokeStyle&&(this.color=S$a.strokeStyle._color._color)},S$m}(),S$Fa=function(S$a){function S$m(S$a){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=S$Ua._TEXCOORD,S$m.__super.call(this,256,0)}S$d(S$m,"laya.webgl.shader.d2.value.FillTextureSV",S$Ua);var S$s=S$m.prototype;return S$s.setValue=function(S$a){this.ALPHA=S$a.ALPHA,S$a.filters&&this.setFilters(S$a.filters)},S$s.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},S$m}(),S$xa=function(S$a){function S$m(S$a){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=S$Ua._TEXCOORD,void 0===S$a&&(S$a=0),S$m.__super.call(this,1,S$a)}S$d(S$m,"laya.webgl.shader.d2.value.TextureSV",S$Ua);var S$s=S$m.prototype;return S$s.setValue=function(S$a){this.ALPHA=S$a.ALPHA,S$a.filters&&this.setFilters(S$a.filters)},S$s.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},S$m}(),S$Ma=function(S$a){function S$m(S$a){this.a_color=null,this.u_pos=[0,0],S$m.__super.call(this,4,0),this.position=[2,5126,!1,5*S$ha.BYTES_PE,0],this.a_color=[3,5126,!1,5*S$ha.BYTES_PE,2*S$ha.BYTES_PE]}return S$d(S$m,"laya.webgl.shader.d2.value.PrimitiveSV",S$Ua),S$m}(),S$Ja=function(S$a){function S$m(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,S$m.__super.call(this)}S$d(S$m,"laya.webgl.atlas.AtlasWebGLCanvas",S$a);var S$s=S$m.prototype;return S$s.recreateResource=function(){var S$a=S$Ha.mainContext,S$m=this._source=S$a.createTexture(),S$s=S$oa.curBindTexTarget,S$P=S$oa.curBindTexValue;S$oa.bindTexture(S$a,3553,S$m),S$a.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),S$a.texParameteri(3553,10241,9729),S$a.texParameteri(3553,10240,9729),S$a.texParameteri(3553,10242,33071),S$a.texParameteri(3553,10243,33071),S$s&&S$P&&S$oa.bindTexture(S$a,S$s,S$P),this.memorySize=this._w*this._h*4,this.completeCreate()},S$s.disposeResource=function(){this._source&&(S$Ha.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},S$s.texSubImage2D=function(S$a,S$m,S$s){if(S$O.isFlash){this._flashCacheImage||(this._flashCacheImage=S$u.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var S$P=S$s.bitmapdata;this._flashCacheImage._image.copyPixels(S$P,0,0,S$P.width,S$P.height,S$a,S$m),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var S$_=S$Ha.mainContext,S$e=S$oa.curBindTexTarget,S$A=S$oa.curBindTexValue;S$oa.bindTexture(S$_,3553,this._source),S$_.pixelStorei(37441,!0),0<=S$a-1&&S$_.texSubImage2D(3553,0,S$a-1,S$m,6408,5121,S$s),S$a+1<=this._w&&S$_.texSubImage2D(3553,0,S$a+1,S$m,6408,5121,S$s),0<=S$m-1&&S$_.texSubImage2D(3553,0,S$a,S$m-1,6408,5121,S$s),S$m+1<=this._h&&S$_.texSubImage2D(3553,0,S$a,S$m+1,6408,5121,S$s),S$_.texSubImage2D(3553,0,S$a,S$m,6408,5121,S$s),S$_.pixelStorei(37441,!1),S$e&&S$A&&S$oa.bindTexture(S$_,S$e,S$A)}},S$s.texSubImage2DPixel=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$Ha.mainContext,S$A=S$oa.curBindTexTarget,S$B=S$oa.curBindTexValue;S$oa.bindTexture(S$e,3553,this._source);var S$k=new Uint8Array(S$_.data);S$e.pixelStorei(37441,!0),S$e.texSubImage2D(3553,0,S$a,S$m,S$s,S$P,6408,5121,S$k),S$e.pixelStorei(37441,!1),S$A&&S$B&&S$oa.bindTexture(S$e,S$A,S$B)},S$P(0,S$s,"width",S$a.prototype._$get_width,function(S$a){this._w=S$a}),S$P(0,S$s,"height",S$a.prototype._$get_height,function(S$a){this._h=S$a}),S$m}(S$k),S$Da=function(S$a){function S$_(){this.flipY=!0,this.alwaysChange=!1,S$_.__super.call(this)}S$d(S$_,"laya.webgl.resource.WebGLCanvas",S$k);var S$m=S$_.prototype;return S$m.getCanvas=function(){return this._canvas},S$m.clear=function(){this._ctx&&this._ctx.clear()},S$m.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},S$m._setContext=function(S$a){this._ctx=S$a},S$m.getContext=function(S$a,S$m){return this._ctx?this._ctx:this._ctx=S$_._createContext(this)},S$m.size=function(S$a,S$m){this._w==S$a&&this._h==S$m||(this._w=S$a,this._h=S$m,this._ctx&&this._ctx.size(S$a,S$m),this._canvas&&(this._canvas.height=S$m,this._canvas.width=S$a))},S$m.activeResource=function(S$a){void 0===S$a&&(S$a=!1),this._source||this.recreateResource()},S$m.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},S$m.disposeResource=function(){this._source&&!this.iscpuSource&&(S$Ha.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},S$m.createWebGlTexture=function(){var S$a=S$Ha.mainContext;this._canvas;var S$m=this._source=S$a.createTexture();this.iscpuSource=!1;var S$s=S$oa.curBindTexTarget,S$P=S$oa.curBindTexValue;S$oa.bindTexture(S$a,3553,S$m),S$a.pixelStorei(37440,this.flipY?1:0),S$_.premulAlpha&&S$a.pixelStorei(37441,!0),S$a.texImage2D(3553,0,6408,6408,5121,this._imgData),S$_.premulAlpha&&S$a.pixelStorei(37441,!1),S$a.texParameteri(3553,10240,9729),S$a.texParameteri(3553,10241,9729),S$a.texParameteri(3553,10242,33071),S$a.texParameteri(3553,10243,33071),S$a.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,S$s&&S$P&&S$oa.bindTexture(S$a,S$s,S$P)},S$m.reloadCanvasData=function(){var S$a=S$Ha.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var S$m=S$oa.curBindTexTarget,S$s=S$oa.curBindTexValue;S$oa.bindTexture(S$a,3553,this._source),S$_.premulAlpha&&S$a.pixelStorei(37441,!0),S$a.texImage2D(3553,0,6408,6408,5121,this._imgData),S$_.premulAlpha&&S$a.pixelStorei(37441,!1),S$a.pixelStorei(37440,0),S$m&&S$s&&S$oa.bindTexture(S$a,S$m,S$s)},S$m.texSubImage2D=function(S$a,S$m,S$s){var S$P=S$Ha.mainContext,S$_=S$oa.curBindTexTarget,S$e=S$oa.curBindTexValue;S$oa.bindTexture(S$P,3553,this._source),S$P.pixelStorei(37441,!0),S$P.texSubImage2D(3553,0,S$m,S$s,6408,5121,S$a._source),S$P.pixelStorei(37441,!1),S$_&&S$e&&S$oa.bindTexture(S$P,S$_,S$e)},S$m.toBase64=function(S$a,S$m,S$s){var S$P=null;this._canvas&&(S$P=this._canvas.toDataURL(S$a,S$m)),S$s.call(this,S$P)},S$P(0,S$m,"context",function(){return this._ctx}),S$P(0,S$m,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),S$P(0,S$m,"asBitmap",null,function(S$a){this._ctx&&(this._ctx.asBitmap=S$a)}),S$_._createContext=null,S$_.premulAlpha=!1,S$_}(),S$ga=function(S$a){function S$e(S$a,S$m){this.CborderSize=12,S$e.__super.call(this),this.char=S$a,this.isSpace=" "===S$a,this.xs=S$m.scaleX,this.ys=S$m.scaleY,this.font=S$m.font.toString(),this.fontSize=S$m.font.size,this.fillColor=S$m.fillColor,this.borderColor=S$m.borderColor,this.lineWidth=S$m.lineWidth,this.underLine=S$m.underLine;var S$s,S$P=S$O.isConchApp;S$P?((S$s=ConchTextCanvas)._source=ConchTextCanvas,S$s._source.canvas=ConchTextCanvas):S$s=S$Q.canvas.source,this.canvas=S$s,this._enableMerageInAtlas=!0,this._ctx=S$P?S$s:this.canvas.getContext("2d",void 0);var S$_=S$E.measureText(this.char,this.font);this.cw=S$_.width*this.xs,this.ch=(S$_.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new S$X(this)}S$d(S$e,"laya.webgl.resource.WebGLCharImage",S$k);var S$m=S$e.prototype;return S$N.imps(S$m,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),S$m.active=function(){this.texture.active()},S$m.recreateResource=function(){var S$a=S$O.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),S$a){var S$m=this.fontSize;1==this.xs&&1==this.ys||(S$m=parseInt(S$m*(this.xs>this.ys?this.xs:this.ys)+""));var S$s="normal 100 "+this.font;S$s=S$s.replace(S$e._fontSizeReg,S$m),this.borderColor&&(S$s+=" 1 "+this.borderColor),this._ctx.font=S$s,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,S$Z.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var S$P=this._ctx.measureText(this.char);S$P||(S$P={width:16});var S$_=S$P.width+1;this._ctx.lineTo(S$_,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},S$m.onresize=function(S$a,S$m){this._w=S$a,this._h=S$m,this._allowMerageInAtlas=!0},S$m.clearAtlasSource=function(){},S$P(0,S$m,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),S$P(0,S$m,"atlasSource",function(){return this.canvas}),S$P(0,S$m,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(S$a){this._enableMerageInAtlas=S$a}),S$e.createOneChar=function(S$a,S$m){return new S$e(S$a,S$m)},S$e._fontSizeReg=new RegExp("\\d+(?=px)","g"),S$e}(),S$wa=function(S$a){function S$j(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){void 0===S$s&&(S$s=6408),void 0===S$P&&(S$P=5121),void 0===S$_&&(S$_=34041),void 0===S$e&&(S$e=!1),void 0===S$A&&(S$A=!1),void 0===S$B&&(S$B=-1),void 0===S$k&&(S$k=1),S$j.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=S$a,this._h=S$m,this._surfaceFormat=S$s,this._surfaceType=S$P,this._depthStencilFormat=S$_,this._mipMap=S$e,this._repeat=S$A,this._minFifter=S$B,this._magFifter=S$k}S$d(S$j,"laya.webgl.resource.WebGLRenderTarget",S$k);var S$m=S$j.prototype;return S$m.recreateResource=function(){var S$a=S$Ha.mainContext;this._frameBuffer||(this._frameBuffer=S$a.createFramebuffer()),this._source||(this._source=S$a.createTexture());var S$m=S$oa.curBindTexTarget,S$s=S$oa.curBindTexValue;S$oa.bindTexture(S$a,3553,this._source),S$a.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var S$P=this._minFifter,S$_=this._magFifter,S$e=this._repeat?10497:33071,S$A=S$G.isPOT(this._w,this._h);if(S$A?(this._mipMap?-1!==S$P||(S$P=9987):-1!==S$P||(S$P=9729),-1!==S$_||(S$_=9729),S$a.texParameteri(3553,10241,S$P),S$a.texParameteri(3553,10240,S$_),S$a.texParameteri(3553,10242,S$e),S$a.texParameteri(3553,10243,S$e),this._mipMap&&S$a.generateMipmap(3553)):(-1!==S$P||(S$P=9729),-1!==S$_||(S$_=9729),S$a.texParameteri(3553,10241,S$P),S$a.texParameteri(3553,10240,S$_),S$a.texParameteri(3553,10242,33071),S$a.texParameteri(3553,10243,33071)),S$a.bindFramebuffer(36160,this._frameBuffer),S$a.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=S$a.createRenderbuffer()),S$a.bindRenderbuffer(36161,this._depthStencilBuffer),S$a.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:S$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:S$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:S$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}S$a.bindFramebuffer(36160,null),S$m&&S$s&&S$oa.bindTexture(S$a,S$m,S$s),S$a.bindRenderbuffer(36161,null),S$A&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},S$m.disposeResource=function(){this._frameBuffer&&(S$Ha.mainContext.deleteTexture(this._source),S$Ha.mainContext.deleteFramebuffer(this._frameBuffer),S$Ha.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},S$P(0,S$m,"depthStencilBuffer",function(){return this._depthStencilBuffer}),S$P(0,S$m,"frameBuffer",function(){return this._frameBuffer}),S$j}(),S$va=function(S$a){function S$B(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this.offsetX=0,this.offsetY=0,S$B.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=S$e,this.canvas=S$a,this._ctx=S$a.getContext("2d",void 0),this._w=S$P,this._h=S$_,this.offsetX=S$m,this.offsetY=S$s,this.src=S$A,this._enableMerageInAtlas=!0,S$F.enabled&&this._w<S$F.atlasLimitWidth&&this._h<S$F.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}S$d(S$B,"laya.webgl.resource.WebGLSubImage",S$k);var S$m=S$B.prototype;return S$N.imps(S$m,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),S$m.size=function(S$a,S$m){this._w=S$a,this._h=S$m,this._ctx&&this._ctx.size(S$a,S$m),this.canvas&&(this.canvas.height=S$m,this.canvas.width=S$a)},S$m.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},S$m.createWebGlTexture=function(){var S$a=S$Ha.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var S$m=this._source=S$a.createTexture(),S$s=S$oa.curBindTexTarget,S$P=S$oa.curBindTexValue;S$oa.bindTexture(S$a,3553,S$m),S$a.pixelStorei(37441,!0),S$a.texImage2D(3553,0,6408,6408,5121,this.canvas),S$a.pixelStorei(37441,!1);var S$_=this.minFifter,S$e=this.magFifter,S$A=this.repeat?10497:33071,S$B=S$G.isPOT(this.width,this.height);S$B?(this.mipmap?-1!==S$_||(S$_=9987):-1!==S$_||(S$_=9729),-1!==S$e||(S$e=9729),S$a.texParameteri(3553,10240,S$e),S$a.texParameteri(3553,10241,S$_),S$a.texParameteri(3553,10242,S$A),S$a.texParameteri(3553,10243,S$A),this.mipmap&&S$a.generateMipmap(3553)):(-1!==S$_||(S$_=9729),-1!==S$e||(S$e=9729),S$a.texParameteri(3553,10241,S$_),S$a.texParameteri(3553,10240,S$e),S$a.texParameteri(3553,10242,33071),S$a.texParameteri(3553,10243,33071)),S$s&&S$P&&S$oa.bindTexture(S$a,S$s,S$P),this.canvas=null,S$B&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},S$m.disposeResource=function(){S$F.enabled&&this._allowMerageInAtlas||!this._source||(S$Ha.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},S$m.clearAtlasSource=function(){},S$P(0,S$m,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),S$P(0,S$m,"atlasSource",function(){return this.canvas}),S$P(0,S$m,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(S$a){this._allowMerageInAtlas=S$a}),S$B}(),S$Ya=function(S$a){function S$j(S$a,S$m,S$s,S$P){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,S$j.__super.call(this),!S$a||!S$m)throw"Shader Error";this._id=++S$j._count,this._vs=S$a,this._ps=S$m,this._nameMap=S$P||{},null!=S$s&&(S$j.sharders[S$s]=this)}S$d(S$j,"laya.webgl.shader.Shader",S$Ea);var S$m=S$j.prototype;return S$m.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},S$m.disposeResource=function(){S$Ha.mainContext.deleteShader(this._vshader),S$Ha.mainContext.deleteShader(this._pshader),S$Ha.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},S$m._compile=function(){if(!S$Ha.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var S$a=[this._vs,this._ps],S$m=S$Ha.mainContext;if(this._program=S$m.createProgram(),this._vshader=S$j._createShader(S$m,S$a[0],35633),this._pshader=S$j._createShader(S$m,S$a[1],35632),S$m.attachShader(this._program,this._vshader),S$m.attachShader(this._program,this._pshader),S$m.linkProgram(this._program),!S$O.isConchApp&&!S$m.getProgramParameter(this._program,35714))throw S$m.getProgramInfoLog(this._program);var S$s,S$P,S$_=0,S$e=0;for(S$e=S$O.isConchApp?S$m.getProgramParameterEx(this._vs,this._ps,"",35721):S$m.getProgramParameter(this._program,35721),S$_=0;S$_<S$e;S$_++){var S$A=null;S$s={vartype:"attribute",glfun:null,ivartype:0,attrib:S$A=S$O.isConchApp?S$m.getActiveAttribEx(this._vs,this._ps,"",S$_):S$m.getActiveAttrib(this._program,S$_),location:S$m.getAttribLocation(this._program,S$A.name),name:S$A.name,type:S$A.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(S$s)}var S$B=0;for(S$B=S$O.isConchApp?S$m.getProgramParameterEx(this._vs,this._ps,"",35718):S$m.getProgramParameter(this._program,35718),S$_=0;S$_<S$B;S$_++){var S$k=null;S$k=S$O.isConchApp?S$m.getActiveUniformEx(this._vs,this._ps,"",S$_):S$m.getActiveUniform(this._program,S$_),0<(S$s={vartype:"uniform",glfun:null,ivartype:1,attrib:S$A,location:S$m.getUniformLocation(this._program,S$k.name),name:S$k.name,type:S$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(S$s.name=S$s.name.substr(0,S$s.name.length-3),S$s.isArray=!0,S$s.location=S$m.getUniformLocation(this._program,S$s.name)),this._params.push(S$s)}for(S$_=0,S$P=this._params.length;S$_<S$P;S$_++)if((S$s=this._params[S$_]).indexOfParams=S$_,S$s.index=1,S$s.value=[S$s.location,null],S$s.codename=S$s.name,S$s.name=this._nameMap[S$s.codename]?this._nameMap[S$s.codename]:S$s.codename,(this._paramsMap[S$s.name]=S$s)._this=this,S$s.uploadedValue=[],"attribute"!==S$s.vartype)switch(S$s.type){case 5124:S$s.fun=S$s.isArray?this._uniform1iv:this._uniform1i;break;case 5126:S$s.fun=S$s.isArray?this._uniform1fv:this._uniform1f;break;case 35664:S$s.fun=S$s.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:S$s.fun=S$s.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:S$s.fun=S$s.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:S$s.fun=this._uniform_sampler2D;break;case 35680:S$s.fun=this._uniform_samplerCube;break;case 35676:S$s.glfun=S$m.uniformMatrix4fv,S$s.fun=this._uniformMatrix4fv;break;case 35670:S$s.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else S$s.fun=this._attribute}},S$m.getUniform=function(S$a){return this._paramsMap[S$a]},S$m._attribute=function(S$a,S$m){var S$s=S$Ha.mainContext,S$P=S$ta._enableAtributes,S$_=S$a.location;return S$P[S$_]||S$s.enableVertexAttribArray(S$_),S$s.vertexAttribPointer(S$_,S$m[0],S$m[1],S$m[2],S$m[3],S$m[4]+this._offset),S$P[S$_]=S$ta._bindVertexBuffer,1},S$m._uniform1f=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m?(S$Ha.mainContext.uniform1f(S$a.location,S$s[0]=S$m),1):0},S$m._uniform1fv=function(S$a,S$m){if(S$m.length<4){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$Ha.mainContext.uniform1fv(S$a.location,S$m),S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3],1):0}return S$Ha.mainContext.uniform1fv(S$a.location,S$m),1},S$m._uniform_vec2=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]?(S$Ha.mainContext.uniform2f(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1]),1):0},S$m._uniform_vec2v=function(S$a,S$m){if(S$m.length<2){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$Ha.mainContext.uniform2fv(S$a.location,S$m),S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3],1):0}return S$Ha.mainContext.uniform2fv(S$a.location,S$m),1},S$m._uniform_vec3=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]?(S$Ha.mainContext.uniform3f(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2]),1):0},S$m._uniform_vec3v=function(S$a,S$m){return S$Ha.mainContext.uniform3fv(S$a.location,S$m),1},S$m._uniform_vec4=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$Ha.mainContext.uniform4f(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3]),1):0},S$m._uniform_vec4v=function(S$a,S$m){return S$Ha.mainContext.uniform4fv(S$a.location,S$m),1},S$m._uniformMatrix2fv=function(S$a,S$m){return S$Ha.mainContext.uniformMatrix2fv(S$a.location,!1,S$m),1},S$m._uniformMatrix3fv=function(S$a,S$m){return S$Ha.mainContext.uniformMatrix3fv(S$a.location,!1,S$m),1},S$m._uniformMatrix4fv=function(S$a,S$m){return S$Ha.mainContext.uniformMatrix4fv(S$a.location,!1,S$m),1},S$m._uniform1i=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m?(S$Ha.mainContext.uniform1i(S$a.location,S$s[0]=S$m),1):0},S$m._uniform1iv=function(S$a,S$m){return S$Ha.mainContext.uniform1iv(S$a.location,S$m),1},S$m._uniform_ivec2=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]?(S$Ha.mainContext.uniform2i(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1]),1):0},S$m._uniform_ivec2v=function(S$a,S$m){return S$Ha.mainContext.uniform2iv(S$a.location,S$m),1},S$m._uniform_vec3i=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]?(S$Ha.mainContext.uniform3i(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2]),1):0},S$m._uniform_vec3vi=function(S$a,S$m){return S$Ha.mainContext.uniform3iv(S$a.location,S$m),1},S$m._uniform_vec4i=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$Ha.mainContext.uniform4i(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3]),1):0},S$m._uniform_vec4vi=function(S$a,S$m){return S$Ha.mainContext.uniform4iv(S$a.location,S$m),1},S$m._uniform_sampler2D=function(S$a,S$m){var S$s=S$Ha.mainContext,S$P=S$a.uploadedValue;return null==S$P[0]?(S$P[0]=this._curActTexIndex,S$s.uniform1i(S$a.location,this._curActTexIndex),S$s.activeTexture(S$j._TEXTURES[this._curActTexIndex]),S$oa.bindTexture(S$s,3553,S$m),this._curActTexIndex++,1):(S$s.activeTexture(S$j._TEXTURES[S$P[0]]),S$oa.bindTexture(S$s,3553,S$m),0)},S$m._uniform_samplerCube=function(S$a,S$m){var S$s=S$Ha.mainContext,S$P=S$a.uploadedValue;return null==S$P[0]?(S$P[0]=this._curActTexIndex,S$s.uniform1i(S$a.location,this._curActTexIndex),S$s.activeTexture(S$j._TEXTURES[this._curActTexIndex]),S$oa.bindTexture(S$s,34067,S$m),this._curActTexIndex++,1):(S$s.activeTexture(S$j._TEXTURES[S$P[0]]),S$oa.bindTexture(S$s,34067,S$m),0)},S$m._noSetValue=function(S$a){console.log("no....:"+S$a.name)},S$m.uploadOne=function(S$a,S$m){this.activeResource(),S$oa.UseProgram(this._program);var S$s=this._paramsMap[S$a];S$s.fun.call(this,S$s,S$m)},S$m.uploadTexture2D=function(S$a){S$W.shaderCall++;var S$m=S$Ha.mainContext;S$m.activeTexture(33984),S$oa.bindTexture(S$m,3553,S$a)},S$m.uploadTexture2D1=function(S$a){S$W.shaderCall++;var S$m=S$Ha.mainContext;S$m.activeTexture(33985),S$oa.bindTexture(S$m,3553,S$a)},S$m.upload=function(S$a,S$m){S$Ea.activeShader=S$Ea.bindShader=this,this._lastUseFrameCount===S$W.loopCount||this.activeResource(),S$oa.UseProgram(this._program),this._reCompile?(S$m=this._params,this._reCompile=!1):S$m=S$m||this._params;S$Ha.mainContext;for(var S$s,S$P,S$_=S$m.length,S$e=0,S$A=0;S$A<S$_;S$A++)null!==(S$P=S$a[(S$s=S$m[S$A]).name])&&(S$e+=S$s.fun.call(this,S$s,S$P));S$W.shaderCall+=S$e},S$m.uploadArray=function(S$a,S$m,S$s){S$Ea.activeShader=this,(S$Ea.bindShader=this).activeResource(),S$oa.UseProgram(this._program);this._params;for(var S$P,S$_,S$e=0,S$A=S$m-2;0<=S$A;S$A-=2)(S$_=this._paramsMap[S$a[S$A]])&&null!=(S$P=S$a[S$A+1])&&(S$s&&S$s[S$_.name]&&S$s[S$_.name].bind(),S$e+=S$_.fun.call(this,S$_,S$P));S$W.shaderCall+=S$e},S$m.getParams=function(){return this._params},S$j.getShader=function(S$a){return S$j.sharders[S$a]},S$j.create=function(S$a,S$m,S$s,S$P){return new S$j(S$a,S$m,S$s,S$P)},S$j.withCompile=function(S$a,S$m,S$s,S$P){if(S$s&&S$j.sharders[S$s])return S$j.sharders[S$s];var S$_=S$j._preCompileShader[2e-4*S$a];if(!S$_)throw new Error("withCompile shader err!"+S$a);return S$_.createShader(S$m,S$s,S$P)},S$j.withCompile2D=function(S$a,S$m,S$s,S$P,S$_){if(S$P&&S$j.sharders[S$P])return S$j.sharders[S$P];var S$e=S$j._preCompileShader[2e-4*S$a+S$m];if(!S$e)throw new Error("withCompile shader err!"+S$a+" "+S$m);return S$e.createShader(S$s,S$P,S$_)},S$j.addInclude=function(S$a,S$m){S$ca.addInclude(S$a,S$m)},S$j.preCompile=function(S$a,S$m,S$s,S$P){var S$_=2e-4*S$a;S$j._preCompileShader[S$_]=new S$ca(S$_,S$m,S$s,S$P)},S$j.preCompile2D=function(S$a,S$m,S$s,S$P,S$_){var S$e=2e-4*S$a+S$m;S$j._preCompileShader[S$e]=new S$ca(S$e,S$s,S$P,S$_)},S$j._createShader=function(S$a,S$m,S$s){var S$P=S$a.createShader(S$s);return S$a.shaderSource(S$P,S$m),S$a.compileShader(S$P),S$P},S$j._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],S$j._count=0,S$j._preCompileShader={},S$j.SHADERNAME2ID=2e-4,S$j.sharders=((S$j.sharders=[]).length=32,S$j.sharders),S$A(S$j,["nameKey",function(){return this.nameKey=new S$b}]),S$j}(),S$Ta=function(S$a){function S$m(){this._maxsize=0,this._upload=!0,this._uploadSize=0,S$m.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}S$d(S$m,"laya.webgl.utils.Buffer2D",S$a);var S$s=S$m.prototype;return S$s.needSize=function(S$a){var S$m=this._byteLength;if(S$a){var S$s=this._byteLength+S$a;S$s<=this._buffer.byteLength||this._resizeBuffer(S$s<<1,!0),this._byteLength=S$s}return S$m},S$s._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),S$W.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,S$ta._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),S$ta._gl.bufferSubData(this._bufferType,0,this._buffer)},S$s._bufferSubData=function(S$a,S$m,S$s){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),this._maxsize=Math.max(this._maxsize,this._byteLength),S$W.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,S$ta._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),S$m||S$s){var S$P=this._buffer.slice(S$m,S$s);S$ta._gl.bufferSubData(this._bufferType,S$a,S$P)}else S$ta._gl.bufferSubData(this._bufferType,S$a,this._buffer)},S$s._checkArrayUse=function(){},S$s._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},S$s._bind_subUpload=function(S$a,S$m,S$s){return void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(S$a,S$m,S$s),!0)},S$s._resizeBuffer=function(S$a,S$m){if(S$a<this._buffer.byteLength)return this;if(this.memorySize=S$a,S$m&&this._buffer&&0<this._buffer.byteLength){var S$s=new ArrayBuffer(S$a);new Uint8Array(S$s).set(new Uint8Array(this._buffer),0),this._buffer=S$s}else this._buffer=new ArrayBuffer(S$a);return this._checkArrayUse(),this._upload=!0,this},S$s.append=function(S$a){this._upload=!0;var S$m,S$s;S$m=S$a.byteLength,S$a instanceof Uint8Array?(this._resizeBuffer(this._byteLength+S$m,!0),S$s=new Uint8Array(this._buffer,this._byteLength)):S$a instanceof Uint16Array?(this._resizeBuffer(this._byteLength+S$m,!0),S$s=new Uint16Array(this._buffer,this._byteLength)):S$a instanceof Float32Array&&(this._resizeBuffer(this._byteLength+S$m,!0),S$s=new Float32Array(this._buffer,this._byteLength)),S$s.set(S$a,0),this._byteLength+=S$m,this._checkArrayUse()},S$s.appendU16Array=function(S$a,S$m){this._resizeBuffer(this._byteLength+2*S$m,!0);for(var S$s=new Uint16Array(this._buffer,this._byteLength,S$m),S$P=0;S$P<S$m;S$P++)S$s[S$P]=S$a[S$P];this._byteLength+=2*S$m,this._checkArrayUse()},S$s.appendEx=function(S$a,S$m){this._upload=!0;var S$s;S$s=S$a.byteLength,this._resizeBuffer(this._byteLength+S$s,!0),new S$m(this._buffer,this._byteLength).set(S$a,0),this._byteLength+=S$s,this._checkArrayUse()},S$s.appendEx2=function(S$a,S$m,S$s,S$P){void 0===S$P&&(S$P=1),this._upload=!0;var S$_,S$e;S$_=S$s*S$P,this._resizeBuffer(this._byteLength+S$_,!0),S$e=new S$m(this._buffer,this._byteLength);var S$A=0;for(S$A=0;S$A<S$s;S$A++)S$e[S$A]=S$a[S$A];this._byteLength+=S$_,this._checkArrayUse()},S$s.getBuffer=function(){return this._buffer},S$s.setNeedUpload=function(){this._upload=!0},S$s.getNeedUpload=function(){return this._upload},S$s.upload=function(){var S$a=this._bind_upload();return S$ta._gl.bindBuffer(this._bufferType,null),S$ta._bindActive[this._bufferType]=null,S$Ea.activeShader=null,S$a},S$s.subUpload=function(S$a,S$m,S$s){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0);var S$P=this._bind_subUpload();return S$ta._gl.bindBuffer(this._bufferType,null),S$ta._bindActive[this._bufferType]=null,S$Ea.activeShader=null,S$P},S$s.disposeResource=function(){S$a.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},S$s.clear=function(){this._byteLength=0,this._upload=!0},S$P(0,S$s,"bufferLength",function(){return this._buffer.byteLength}),S$P(0,S$s,"byteLength",null,function(S$a){this._byteLength!==S$a&&(S$a<=this._buffer.byteLength||this._resizeBuffer(2*S$a+256,!0),this._byteLength=S$a)}),S$m.__int__=function(S$a){S$na.QuadrangleIB=S$na.create(35044),S$ua.fillIBQuadrangle(S$na.QuadrangleIB,16)},S$m.FLOAT32=4,S$m.SHORT=2,S$m}(S$ta),S$Ia=(function(S$m){function S$s(S$a){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,S$s.__super.call(this,9)}S$d(S$s,"laya.webgl.shader.d2.value.GlowSV",S$m);var S$a=S$s.prototype;S$a.setValue=function(S$a){S$m.prototype.setValue.call(this,S$a)},S$a.clear=function(){S$m.prototype.clear.call(this)}}(S$xa),function(S$a){function S$m(S$a){S$m.__super.call(this,64),this.defines.add(64)}S$d(S$m,"laya.webgl.shader.d2.value.TextSV",S$a);var S$s=S$m.prototype;return S$s.release=function(){(S$m.pool[S$m._length++]=this).clear()},S$s.clear=function(){S$a.prototype.clear.call(this)},S$m.create=function(){return S$m._length?S$m.pool[--S$m._length]:new S$m(null)},S$m.pool=[],S$m._length=0,S$m}(S$xa)),S$$a=function(S$a){function S$_(S$a,S$m,S$s,S$P){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,S$_.__super.call(this,S$a,S$m,S$s,S$P)}S$d(S$_,"laya.webgl.shader.d2.Shader2X",S$a);var S$m=S$_.prototype;return S$m.upload2dQuick1=function(S$a){this.upload(S$a,this._params2dQuick1||this._make2dQuick1())},S$m._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var S$a,S$m=this._params,S$s=0,S$P=S$m.length;S$s<S$P;S$s++)S$a=S$m[S$s],(S$O.isFlash||"size"!==S$a.name&&"position"!==S$a.name&&"texcoord"!==S$a.name)&&this._params2dQuick1.push(S$a)}return this._params2dQuick1},S$m.disposeResource=function(){S$a.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},S$m.upload2dQuick2=function(S$a){this.upload(S$a,this._params2dQuick2||this._make2dQuick2())},S$m._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var S$a,S$m=this._params,S$s=0,S$P=S$m.length;S$s<S$P;S$s++)S$a=S$m[S$s],(S$O.isFlash||"size"!==S$a.name)&&this._params2dQuick2.push(S$a)}return this._params2dQuick2},S$_.create=function(S$a,S$m,S$s,S$P){return new S$_(S$a,S$m,S$s,S$P)},S$_}(S$Ya),S$na=function(S$a){function S$m(S$a){this._uint8Array=null,this._uint16Array=null,void 0===S$a&&(S$a=35044),S$m.__super.call(this),this._bufferUsage=S$a,this._bufferType=34963,S$O.isFlash||(this._buffer=new ArrayBuffer(8))}S$d(S$m,"laya.webgl.utils.IndexBuffer2D",S$Ta);var S$s=S$m.prototype;return S$s._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},S$s.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},S$s.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},S$s.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},S$m.QuadrangleIB=null,S$m.create=function(S$a){return void 0===S$a&&(S$a=35044),new S$m(S$a)},S$m}(),S$ra=function(S$a){function S$s(S$a,S$m){this._floatArray32=null,this._vertexStride=0,S$s.__super.call(this),this._vertexStride=S$a,this._bufferUsage=S$m,this._bufferType=34962,S$O.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}S$d(S$s,"laya.webgl.utils.VertexBuffer2D",S$a);var S$m=S$s.prototype;return S$m.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},S$m.bind=function(S$a){S$a&&S$a._bind(),this._bind()},S$m.insertData=function(S$a,S$m){this.getFloat32Array().set(S$a,S$m),this._upload=!0},S$m.bind_upload=function(S$a){S$a._bind_upload()||S$a._bind(),this._bind_upload()||this._bind()},S$m._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},S$m.disposeResource=function(){S$a.prototype.disposeResource.call(this)},S$m.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},S$P(0,S$m,"vertexStride",function(){return this._vertexStride}),S$s.create=function(S$a,S$m){return void 0===S$m&&(S$m=35048),new S$s(S$a,S$m)},S$s}(S$Ta),S$am=function(S$a){function S$B(S$a,S$m,S$s,S$P,S$_,S$e){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===S$s&&(S$s=6408),void 0===S$P&&(S$P=!0),S$B.__super.call(this,S$a,S$m),S$a){if(this._format=S$s,this._mipmap=S$P,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof S$a)this._url=S$a,this._src=S$a,this._image=new S$Q.window.Image,S$m&&(S$m.onload&&(this.onload=S$m.onload),S$m.onerror&&(this.onerror=S$m.onerror),S$m.onCreate&&S$m.onCreate(this)),this._image.crossOrigin=S$a&&0==S$a.indexOf("data:")?null:"",S$a&&(this._image.src=S$a);else if(S$a instanceof ArrayBuffer){this._src=S$m,this._url=this._src;var S$A=new S$j(S$a);S$A.readUTFBytes(4),S$A.readUTFBytes(2),S$A.getInt16();S$A.endian="bigEndian",this._w=S$A.getInt16(),this._h=S$A.getInt16();S$A.getInt16(),S$A.getInt16();this._image=new Uint8Array(S$a,S$A.pos),this._format=S$Ha.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,S$F.enabled&&this._w<S$F.atlasLimitWidth&&this._h<S$F.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(S$a instanceof Uint8Array))return this._src=S$m,this._url=this._src,this._image=S$a.source||S$a,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=S$m,this._url=this._src,this._w=S$_,this._h=S$e,this._image=S$a,this._format=0===S$s?S$a.byteLength/(S$_*S$e)==4?6408:6407:S$s}this._$5__enableMerageInAtlas=!0}}S$d(S$B,"laya.webgl.resource.WebGLImage",S$u);var S$m=S$B.prototype;return S$N.imps(S$m,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),S$m._init_=function(S$a,S$m){},S$m._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var S$a=S$Ha.mainContext,S$m=this._source=S$a.createTexture(),S$s=S$oa.curBindTexTarget,S$P=S$oa.curBindTexValue;S$oa.bindTexture(S$a,3553,S$m);var S$_=this.minFifter,S$e=this.magFifter,S$A=this.repeat?10497:33071,S$B=S$G.isPOT(this._w,this._h),S$k=!1;switch(S$B?(this.mipmap?-1!==S$_||(S$_=9987):-1!==S$_||(S$_=9729),-1!==S$e||(S$e=9729),S$a.texParameteri(3553,10241,S$_),S$a.texParameteri(3553,10240,S$e),S$a.texParameteri(3553,10242,S$A),S$a.texParameteri(3553,10243,S$A),this.mipmap&&S$a.generateMipmap(3553)):(-1!==S$_||(S$_=9729),-1!==S$e||(S$e=9729),S$a.texParameteri(3553,10241,S$_),S$a.texParameteri(3553,10240,S$e),S$a.texParameteri(3553,10242,33071),S$a.texParameteri(3553,10243,33071)),S$a.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&S$a.pixelStorei(S$a.UNPACK_ALIGNMENT,1),S$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&S$a.pixelStorei(S$a.UNPACK_ALIGNMENT,1),S$a.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:S$k=!0,S$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case S$Ha.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:S$k=!0,S$a.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}S$a.pixelStorei(37441,!1),S$s&&S$P&&S$oa.bindTexture(S$a,S$s,S$P),this.uri||(this.uri=this._url),S$k?this.memorySize=this._image.length:S$B&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},S$m.recreateResource=function(){var S$a=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var S$m=this;this._image=new S$Q.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(S$m._needReleaseAgain)return S$m._needReleaseAgain=!1,S$m._image.onload=null,void(S$m._image=null);S$m._allowMerageInAtlas&&S$m._enableMerageInAtlas?(S$a.memorySize=0,S$a._recreateLock=!1):S$m._createWebGlTexture(),S$m.completeCreate()},this._image.src=this._src}},S$m.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&S$Ha.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},S$m.onresize=function(){this._w=this._image.width,this._h=this._image.height,S$F.enabled&&this._w<S$F.atlasLimitWidth&&this._h<S$F.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},S$m.clearAtlasSource=function(){this._image=null},S$P(0,S$m,"format",function(){return this._format}),S$P(0,S$m,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(S$a){this._$5__enableMerageInAtlas=S$a}),S$P(0,S$m,"mipmap",function(){return this._mipmap}),S$P(0,S$m,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),S$P(0,S$m,"atlasSource",function(){return this._image}),S$P(0,S$m,"onload",null,function(S$a){var S$m=this;this._onload=S$a,this._image&&(this._image.onload=null!=this._onload?function(){S$m.onresize(),S$m._onload()}:null)}),S$P(0,S$m,"onerror",null,function(S$a){var S$m=this;this._onerror=S$a,this._image&&(this._image.onerror=null!=this._onerror?function(){S$m._onerror()}:null)}),S$B}();S$N.__init([S$Qa,S$R,S$za,S$ca])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(S$a,S$m){"use strict";for(var S$s in Object.defineProperty(S$m,"__esModule",{value:!0}),Laya){var S$P=Laya[S$s];S$P&&S$P.__isclass&&(S$m[S$s]=S$P)}}),function(S$e,S$a,S$P){S$P.un,S$P.uns;var S$_=S$P.static,S$A=S$P.class,S$B=S$P.getset,S$k=(S$P.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),S$q=laya.utils.ClassUtils,S$y=(laya.events.Event,laya.utils.HTMLChar),S$j=laya.net.Loader,S$G=(laya.display.Node,laya.maths.Rectangle),S$d=laya.renders.Render,S$Q=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),S$h=laya.utils.Stat,S$E=laya.display.Text,S$u=laya.resource.Texture,S$O=laya.net.URL,S$p=laya.utils.Utils,S$c=function(){function S$Q(){}return S$A(S$Q,"laya.html.utils.HTMLParse"),S$Q.parse=function(S$a,S$m,S$s){S$m=(S$m="<root>"+(S$m=S$m.replace(/<br>/g,"<br/>"))+"</root>").replace(S$Q.spacePattern,S$Q.char255);var S$P=S$p.parseXMLFromString(S$m);S$Q._parseXML(S$a,S$P.childNodes[0].childNodes,S$s)},S$Q._parseXML=function(S$a,S$m,S$s,S$P){var S$_=0,S$e=0;if(S$m.join||S$m.item)for(S$_=0,S$e=S$m.length;S$_<S$e;++S$_)S$Q._parseXML(S$a,S$m[S$_],S$s,S$P);else{var S$A,S$B,S$k;if(3==S$m.nodeType)return void(S$a instanceof laya.html.dom.HTMLDivElement?(null==S$m.nodeName&&(S$m.nodeName="#text"),S$B=S$m.nodeName.toLowerCase(),0<(S$k=S$m.textContent.replace(/^\s+|\s+$/g,"")).length&&(S$A=S$q.getInstance(S$B))&&(S$a.addChild(S$A),S$A.innerTEXT=S$k.replace(S$Q.char255AndOneSpacePattern," "))):0<(S$k=S$m.textContent.replace(/^\s+|\s+$/g,"")).length&&(S$a.innerTEXT=S$k.replace(S$Q.char255AndOneSpacePattern," ")));if("#comment"==(S$B=S$m.nodeName.toLowerCase()))return;if(S$A=S$q.getInstance(S$B)){(S$A=S$a.addChild(S$A)).URI=S$s,S$A.href=S$P;var S$j=S$m.attributes;if(S$j&&0<S$j.length)for(S$_=0,S$e=S$j.length;S$_<S$e;++S$_){var S$G=S$j[S$_],S$y=S$G.nodeName,S$d=S$G.value;S$A._setAttributes(S$y,S$d)}S$Q._parseXML(S$A,S$m.childNodes,S$s,S$A.href)}else S$Q._parseXML(S$a,S$m.childNodes,S$s,S$P)}},S$Q.char255=String.fromCharCode(255),S$Q.spacePattern=/&nbsp;|&#160;/g,S$Q.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),S$Q}(),S$H=function(){function S$X(){}return S$A(S$X,"laya.html.utils.Layout"),S$X.later=function(S$a){null==S$X._will&&(S$X._will=[],S$P.stage.frameLoop(1,null,function(){if(!(S$X._will.length<1)){for(var S$a=0;S$a<S$X._will.length;S$a++)laya.html.utils.Layout.layout(S$X._will[S$a]);S$X._will.length=0}})),S$X._will.push(S$a)},S$X.layout=function(S$a){if(!S$a||!S$a._style)return null;if(0==(512&S$a._style._type))return null;S$a.getStyle()._type&=-513;var S$m=S$X._multiLineLayout(S$a);return S$d.isConchApp&&S$a.layaoutCallNative&&S$a.layaoutCallNative(),S$m},S$X._multiLineLayout=function(S$a){if(S$E.RightToLeft)return S$X._multiLineLayout2(S$a);var S$m=new Array;S$a._addChildsToLayout(S$m);var S$s,S$P,S$_,S$e,S$A,S$B=0,S$k=S$m.length,S$j=S$a._getCSSStyle(),S$G=S$j.letterSpacing,S$y=S$j.leading,S$d=S$j.lineHeight,S$Q=S$j._widthAuto()||!S$j.wordWrap,S$q=S$Q?999999:S$a.width,S$h=(S$a.height,0),S$u=S$j.italic?S$j.fontSize/3:0,S$O=S$j._getAlign(),S$p=S$j._getValign(),S$c=0!==S$p||0!==S$O||0!=S$d,S$H=0,S$o=0,S$N=0,S$z=0,S$U=new Array,S$l=S$U[0]=new S$i,S$C=!1,S$f=!1;S$l.h=0,S$j.italic&&(S$q-=S$j.fontSize/3);var S$K=0,S$V=!0;function S$W(){S$l.y=S$o,S$o+=S$l.h+S$y,0==S$l.h&&(S$o+=S$d),S$l.mWidth=S$K,S$K=0,S$l=new S$i,S$U.push(S$l),S$l.h=0,S$C=!(S$V=!(S$H=0))}for(S$B=0;S$B<S$k;S$B++)if(null!=(S$s=S$m[S$B]))if(S$V=!1,S$s instanceof laya.html.dom.HTMLBrElement)S$W(),S$l.y=S$o;else{if(S$s._isChar()){if((S$e=S$s).isWord)S$C=S$f||"\n"===S$e.char,S$l.wordStartIndex=S$l.elements.length;else{if(S$N=S$e.width+S$e.style.letterSpacin,0<S$U.length&&S$q<S$H+S$N&&0<S$l.wordStartIndex){var S$b;S$b=S$l.elements.length-S$l.wordStartIndex+1,S$l.elements.length=S$l.wordStartIndex,S$B-=S$b,S$W();continue}S$C=!1,S$K+=S$e.width}S$N=S$e.width+S$G,S$z=S$e.height,S$f=!1,(S$C=S$C||S$q<S$H+S$N)&&S$W(),S$l.minTextHeight=Math.min(S$l.minTextHeight,S$s.height)}else S$P=S$s._getCSSStyle(),S$A=S$s,S$_=S$P.padding,0===S$P._getCssFloat()||(S$c=!0),S$C=S$f||S$P.lineElement,S$N=S$A.width*S$A._style._tf.scaleX+S$_[1]+S$_[3]+S$G,S$z=S$A.height*S$A._style._tf.scaleY+S$_[0]+S$_[2],S$f=S$P.lineElement,(S$C=S$C||S$q<S$H+S$N&&S$P.wordWrap)&&S$W();S$l.elements.push(S$s),S$l.h=Math.max(S$l.h,S$z),S$s.x=S$H,S$s.y=S$o,S$H+=S$N,S$l.w=S$H-S$G,S$l.y=S$o,S$h=Math.max(S$H+S$u,S$h)}else S$V||(S$H+=S$X.DIV_ELEMENT_PADDING),S$l.wordStartIndex=S$l.elements.length;if(S$o=S$l.y+S$l.h,S$c){var S$S=0,S$Z=S$q;for(S$Q&&0<S$a.width&&(S$Z=S$a.width),S$B=0,S$k=S$U.length;S$B<S$k;S$B++)S$U[S$B].updatePos(0,S$Z,S$B,S$S,S$O,S$p,S$d),S$S+=Math.max(S$d,S$U[S$B].h+S$y);S$o=S$S}return S$Q&&(S$a.width=S$h),S$o>S$a.height&&(S$a.height=S$o),[S$h,S$o]},S$X._multiLineLayout2=function(S$a){var S$m=new Array;S$a._addChildsToLayout(S$m);var S$s,S$P,S$_,S$e,S$A,S$B=0,S$k=S$m.length,S$j=S$a._getCSSStyle(),S$G=S$j.letterSpacing,S$y=S$j.leading,S$d=S$j.lineHeight,S$Q=S$j._widthAuto()||!S$j.wordWrap,S$q=S$Q?999999:S$a.width,S$h=(S$a.height,0),S$u=S$j.italic?S$j.fontSize/3:0,S$O=2-S$j._getAlign(),S$p=S$j._getValign(),S$c=0!==S$p||0!=S$O||0!=S$d,S$H=0,S$o=0,S$N=0,S$z=0,S$U=new Array,S$l=S$U[0]=new S$i,S$C=!1,S$f=!1;S$l.h=0,S$j.italic&&(S$q-=S$j.fontSize/3);var S$K=0,S$V=!0;function S$W(){S$l.y=S$o,S$o+=S$l.h+S$y,0==S$l.h&&(S$o+=S$d),S$l.mWidth=S$K,S$K=0,S$l=new S$i,S$U.push(S$l),S$l.h=0,S$C=!(S$V=!(S$H=0))}for(S$B=0;S$B<S$k;S$B++)if(null!=(S$s=S$m[S$B]))if(S$V=!1,S$s instanceof laya.html.dom.HTMLBrElement)S$W(),S$l.y=S$o;else{if(S$s._isChar()){if((S$e=S$s).isWord)S$C=S$f||"\n"===S$e.char,S$l.wordStartIndex=S$l.elements.length;else{if(0<S$U.length&&S$q<S$H+S$N&&0<S$l.wordStartIndex){var S$b;S$b=S$l.elements.length-S$l.wordStartIndex+1,S$l.elements.length=S$l.wordStartIndex,S$B-=S$b,S$W();continue}S$C=!1,S$K+=S$e.width}S$N=S$e.width+S$G,S$z=S$e.height,S$f=!1,(S$C=S$C||S$q<S$H+S$N)&&S$W(),S$l.minTextHeight=Math.min(S$l.minTextHeight,S$s.height)}else S$P=S$s._getCSSStyle(),S$A=S$s,S$_=S$P.padding,0===S$P._getCssFloat()||(S$c=!0),S$C=S$f||S$P.lineElement,S$N=S$A.width*S$A._style._tf.scaleX+S$_[1]+S$_[3]+S$G,S$z=S$A.height*S$A._style._tf.scaleY+S$_[0]+S$_[2],S$f=S$P.lineElement,(S$C=S$C||S$q<S$H+S$N&&S$P.wordWrap)&&S$W();S$l.elements.push(S$s),S$l.h=Math.max(S$l.h,S$z),S$s.x=S$H,S$s.y=S$o,S$H+=S$N,S$l.w=S$H-S$G,S$l.y=S$o,S$h=Math.max(S$H+S$u,S$h)}else S$V||(S$H+=S$X.DIV_ELEMENT_PADDING),S$l.wordStartIndex=S$l.elements.length;if(S$o=S$l.y+S$l.h,S$c){var S$S=0,S$Z=S$q;for(S$B=0,S$k=S$U.length;S$B<S$k;S$B++)S$U[S$B].updatePos(0,S$Z,S$B,S$S,S$O,S$p,S$d),S$S+=Math.max(S$d,S$U[S$B].h+S$y);S$o=S$S}for(S$Q&&(S$a.width=S$h),S$o>S$a.height&&(S$a.height=S$o),S$B=0,S$k=S$U.length;S$B<S$k;S$B++)S$U[S$B].revertOrder(S$q);return[S$h,S$o]},S$X._will=null,S$X.DIV_ELEMENT_PADDING=0,S$X}(),S$i=function(){function S$a(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}S$A(S$a,"laya.html.utils.LayoutLine");var S$m=S$a.prototype;return S$m.updatePos=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){var S$B,S$k=0;0<this.elements.length&&(S$k=(S$B=this.elements[this.elements.length-1]).x+S$B.width-this.elements[0].x);var S$j=0,S$G=NaN;1===S$_&&(S$j=(S$m-S$k)/2),2===S$_&&(S$j=S$m-S$k),0===S$A||0!=S$e||(S$e=1);for(var S$y=0,S$d=this.elements.length;S$y<S$d;S$y++){var S$Q=(S$B=this.elements[S$y])._getCSSStyle();switch(0!==S$j&&(S$B.x+=S$j),S$Q._getValign()){case 0:S$B.y=S$P;break;case 1:var S$q=0;99999!=this.minTextHeight&&(S$q=this.minTextHeight);var S$h=(S$q+S$A)/2;S$h=Math.max(S$h,this.h),S$G=(laya.html.dom.HTMLImageElement,S$P+S$h-S$B.height),S$B.y=S$G;break;case 2:S$B.y=S$P+(S$A-S$B.height)}}},S$m.revertOrder=function(S$a){var S$m;if(0<this.elements.length){var S$s,S$P=0;for(S$s=this.elements.length,S$P=0;S$P<S$s;S$P++)(S$m=this.elements[S$P]).x=S$a-S$m.x-S$m.width}},S$a}(),S$o=function(S$s){function S$m(){this.URI=null,this._href=null,S$m.__super.call(this),this._text=S$m._EMPTYTEXT,this.setStyle(new S$k(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}S$A(S$m,"laya.html.dom.HTMLElement",S$s);var S$a=S$m.prototype;return S$a.layaoutCallNative=function(){var S$a=0;if(this._childs&&0<(S$a=this._childs.length))for(var S$m=0;S$m<S$a;S$m++)this._childs[S$m].layaoutCallNative&&this._childs[S$m].layaoutCallNative();var S$s=this._getWords();S$s?laya.html.dom.HTMLElement.fillWords(this,S$s,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},S$a.appendChild=function(S$a){return this.addChild(S$a)},S$a._getWords2=function(){var S$a=this._text.text;if(!S$a||0===S$a.length)return null;var S$m,S$s,S$P=0,S$_=0;if(this._text.drawWords)S$s=this._text.drawWords;else{for(S$_=(S$m=S$a.split(" ")).length-1,S$s=[],S$P=0;S$P<S$_;S$P++)S$s.push(S$m[S$P]," ");0<=S$_&&S$s.push(S$m[S$_]),this._text.drawWords=S$s}var S$e,S$A=this._text.words;if(S$A&&S$A.length===S$s.length)return S$A;null===S$A&&(this._text.words=S$A=[]),S$A.length=S$s.length;var S$B=this.style,S$k=S$B.font;for(S$P=0,S$_=S$s.length;S$P<S$_;S$P++){S$e=S$p.measureText(S$s[S$P],S$k);var S$j=S$A[S$P]=new S$y(S$s[S$P],S$e.width,S$e.height||S$B.fontSize,S$B);if(1<S$j.char.length&&(S$j.charNum=S$j.char),this.href){var S$G=new S$Q;this.addChild(S$G),S$j.setSprite(S$G)}}return S$A},S$a._getWords=function(){if(!S$E.CharacterCache)return this._getWords2();var S$a=this._text.text;if(!S$a||0===S$a.length)return null;var S$m,S$s=this._text.words;if(S$s&&S$s.length===S$a.length)return S$s;null===S$s&&(this._text.words=S$s=[]),S$s.length=S$a.length;for(var S$P=this.style,S$_=S$P.font,S$e=0,S$A=S$a.length;S$e<S$A;S$e++)if(S$m=S$p.measureText(S$a.charAt(S$e),S$_)){var S$B=S$s[S$e]=new S$y(S$a.charAt(S$e),S$m.width,S$m.height||S$P.fontSize,S$P);if(this.href){var S$k=new S$Q;this.addChild(S$k),S$B.setSprite(S$k)}}else console.warn("_getWords size is null"+S$a.charAt(S$e),S$_);return S$s},S$a.showLinkSprite=function(){var S$a=this._text.words;if(S$a)for(var S$m,S$s,S$P=[],S$_=0;S$_<S$a.length;S$_++)S$s=S$a[S$_],(S$m=new S$Q).graphics.drawRect(0,0,S$s.width,S$s.height,"#ff0000"),S$m.width=S$s.width,S$m.height=S$s.height,this.addChild(S$m),S$P.push(S$m)},S$a._layoutLater=function(){var S$a=this.style;512&S$a._type||(S$a.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&S$a.block?(S$H.later(this),S$a._type|=512):this.parent&&this.parent._layoutLater())},S$a._setAttributes=function(S$a,S$m){switch(S$a){case"style":return void this.style.cssText(S$m);case"class":return void(this.className=S$m)}S$s.prototype._setAttributes.call(this,S$a,S$m)},S$a.updateHref=function(){if(null!=this._href){var S$a=this._getWords();if(S$a)for(var S$m,S$s,S$P=0;S$P<S$a.length;S$P++)(S$s=(S$m=S$a[S$P]).getSprite())&&(S$s.size(S$m.width,S$m.height),S$s.on("click",this,this.onLinkHandler))}},S$a.onLinkHandler=function(S$a){switch(S$a.type){case"click":for(var S$m=this;S$m;)S$m.event("link",[this.href]),S$m=S$m.parent}},S$a.formatURL=function(S$a){return this.URI?S$O.formatURL(S$a,this.URI?this.URI.path:null):S$a},S$B(0,S$a,"href",function(){return this._href},function(S$a){null!=(this._href=S$a)&&(this._getCSSStyle().underLine=1,this.updateHref())}),S$B(0,S$a,"color",null,function(S$a){this.style.color=S$a}),S$B(0,S$a,"onClick",null,function(S$a){S$P._runScript("fn=function(event){"+S$a+";}"),this.on("click",this,void 0)}),S$B(0,S$a,"id",null,function(S$a){S$N.document.setElementById(S$a,this)}),S$B(0,S$a,"innerTEXT",function(){return this._text.text},function(S$a){this.text=S$a}),S$B(0,S$a,"style",function(){return this._style}),S$B(0,S$a,"text",function(){return this._text.text},function(S$a){this._text==S$m._EMPTYTEXT?this._text={text:S$a,words:null}:(this._text.text=S$a,this._text.words&&(this._text.words.length=0)),S$d.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),S$B(0,S$a,"parent",S$s.prototype._$get_parent,function(S$a){if(S$a instanceof laya.html.dom.HTMLElement){var S$m=S$a;this.URI||(this.URI=S$m.URI),this.style.inherit(S$m.style)}S$P.superSet(S$Q,this,"parent",S$a)}),S$B(0,S$a,"className",null,function(S$a){this.style.attrs(S$N.document.styleSheets["."+S$a])}),S$m.fillWords=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$a.graphics.clear();for(var S$B=0,S$k=S$m.length;S$B<S$k;S$B++){var S$j=S$m[S$B];S$a.graphics.fillText(S$j.char,S$j.x+S$s,S$j.y+S$P,S$_,S$e,"left",S$A)}},S$m._EMPTYTEXT={text:null,words:null},S$m}(S$Q),S$m=(function(S$a){function S$m(){S$m.__super.call(this),this.style.lineElement=!0,this.style.block=!0}S$A(S$m,"laya.html.dom.HTMLBrElement",S$o)}(),function(S$a){function S$m(){this.contextHeight=NaN,this.contextWidth=NaN,S$m.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}S$A(S$m,"laya.html.dom.HTMLDivElement",S$a);var S$s=S$m.prototype;return S$s.appendHTML=function(S$a){S$c.parse(this,S$a,this.URI),this.layout()},S$s._addChildsToLayout=function(S$m){var S$a=this._getWords();if(null==S$a&&0==this._childs.length)return!1;S$a&&S$a.forEach(function(S$a){S$m.push(S$a)});for(var S$s=!0,S$P=0,S$_=this._childs.length;S$P<S$_;S$P++){var S$e=this._childs[S$P];S$s?S$s=!1:S$m.push(null),S$e._addToLayout(S$m)}return!0},S$s._addToLayout=function(S$a){this.layout()},S$s.layout=function(){if(this.style){this.style._type|=512;var S$a=S$H.layout(this);if(S$a){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new S$G);var S$m=this._$P.mHtmlBounds;S$m.x=S$m.y=0,S$m.width=this.contextWidth=S$a[0],S$m.height=this.contextHeight=S$a[1],this.setBounds(S$m)}}},S$B(0,S$s,"height",function(){return this._height?this._height:this.contextHeight},S$a.prototype._$set_height),S$B(0,S$s,"innerHTML",null,function(S$a){this.destroyChildren(),this.appendHTML(S$a)}),S$B(0,S$s,"width",function(){return this._width?this._width:this.contextWidth},function(S$a){var S$m=!1;S$m=0===S$a?S$a!=this._width:S$a!=this.width,S$P.superSet(S$o,this,"width",S$a),S$m&&this.layout()}),S$m}(S$o)),S$N=function(S$a){function S$m(){this.all=new Array,this.styleSheets=S$k.styleSheets,S$m.__super.call(this)}S$A(S$m,"laya.html.dom.HTMLDocument",S$o);var S$s=S$m.prototype;return S$s.getElementById=function(S$a){return this.all[S$a]},S$s.setElementById=function(S$a,S$m){this.all[S$a]=S$m},S$_(S$m,["document",function(){return this.document=new S$m}]),S$m}();(function(S$a){function S$m(){this._tex=null,this._url=null,this._renderArgs=[],S$m.__super.call(this),this.style.block=!0}S$A(S$m,"laya.html.dom.HTMLImageElement",S$o);var S$s=S$m.prototype;S$s._addToLayout=function(S$a){!this._style.absolute&&S$a.push(this)},S$s.render=function(S$a,S$m,S$s){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(S$h.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,S$a.ctx.drawTexture2(S$m,S$s,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},S$s.layaoutCallNative=function(){var S$a=0;if(this._childs&&0<(S$a=this._childs.length))for(var S$m=0;S$m<S$a;S$m++)this._childs[S$m].layaoutCallNative&&this._childs[S$m].layaoutCallNative()},S$B(0,S$s,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(S$a){this._width!==S$a&&(this._width=S$a,this._style.width=S$a,this.repaint())}),S$B(0,S$s,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(S$a){this._height!==S$a&&(this._height=S$a,this._style.height=S$a,this.repaint())}),S$s.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),S$j.clearCache(this,this._url),this._tex=null),S$o.prototype.destroy.call(this)},S$s.onloaded=function(){var S$a=this._style;S$a&&!S$a.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),S$a&&!S$a.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),S$d.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},S$s._loadImageComplete=function(S$a,S$m,S$s){if(!this._destroyed)if(null!=S$s)if(S$s instanceof ArrayBuffer){var S$P=new DataView(S$s);new laya.webgl.resource.WebGLImage(new Uint8Array(S$s,8),S$a,0,!1,S$P.getUint32(0),S$P.getUint32(4));this.onloaded()}else if(S$s instanceof S$u)S$j.imgMgrSet[S$a]=S$m,S$e.imgMgrLock(S$a,S$j.imgMgrSet[S$a]),this._url=S$a,this._tex=S$s,S$j.keepCache(this,S$a),S$j.cacheRes(S$a,this._tex),this.onloaded();else{var S$_=-1!=S$a.indexOf(".png",S$a.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(S$s,S$a,S$_,!1,S$s.width,S$s.height);this.onloaded()}else this.event("error","Load image failed")},S$B(0,S$s,"src",null,function(S$a){(S$a=this.formatURL(S$a),this._url!=S$a)&&(null!=this._tex&&(S$j.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=S$a,(this._tex=S$j.getRes(S$a))?(S$j.keepCache(this,S$a),this.onloaded()):S$e.imgMgrLoad(S$a,this._loadImageComplete.bind(this),2,!1))})})(),function(S$a){function S$m(){this.type=null,S$m.__super.call(this),this.visible=!1}S$A(S$m,"laya.html.dom.HTMLLinkElement",S$a);var S$s=S$m.prototype;S$s._onload=function(S$a){switch(this.type){case"text/css":S$k.parseCSS(S$a,this.URI)}},S$B(0,S$s,"href",S$a.prototype._$get_href,function(S$a){var S$m=this;S$a=this.formatURL(S$a),this.URI=new S$O(S$a);var S$s=new S$j;S$s.once("complete",null,function(S$a){S$m._onload(S$a)}),S$s.load(S$a,"text")}),S$m._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(S$o),function(S$a){function S$m(){S$m.__super.call(this),this.visible=!1}S$A(S$m,"laya.html.dom.HTMLStyleElement",S$a),S$B(0,S$m.prototype,"text",S$a.prototype._$get_text,function(S$a){S$k.parseCSS(S$a,null)})}(S$o),function(S$a){function S$m(){S$m.__super.call(this),this._getCSSStyle().valign="middle"}S$A(S$m,"laya.html.dom.HTMLIframeElement",S$a),S$B(0,S$m.prototype,"href",S$a.prototype._$get_href,function(S$s){var S$P=this;S$s=this.formatURL(S$s);var S$a=new S$j;S$a.once("complete",null,function(S$a){var S$m=S$P.URI;S$P.URI=new S$O(S$s),S$P.innerHTML=S$a,!S$m||(S$P.URI=S$m)}),S$a.load(S$s,"text")})}(S$m)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(S$a,S$m){"use strict";for(var S$s in Object.defineProperty(S$m,"__esModule",{value:!0}),Laya){var S$P=Laya[S$s];S$P&&S$P.__isclass&&(S$m[S$s]=S$P)}}),function(S$_,S$a,S$h){S$h.un,S$h.uns;var S$P=S$h.static,S$e=S$h.class,S$A=S$h.getset,S$s=(S$h.__newvec,laya.display.Animation),S$u=(laya.utils.Browser,laya.utils.ClassUtils),S$B=laya.filters.ColorFilter,S$k=laya.utils.Ease,S$j=laya.events.Event,S$G=(laya.events.EventDispatcher,laya.display.css.Font),S$y=laya.display.FrameAnimation,S$m=laya.display.Graphics,S$d=laya.utils.Handler,S$Q=laya.display.Input,S$p=laya.net.Loader,S$q=(laya.display.Node,laya.maths.Point),S$O=laya.maths.Rectangle,S$c=laya.renders.Render,S$H=laya.display.Sprite,S$o=laya.display.Text,S$N=laya.resource.Texture,S$z=laya.utils.Tween,S$U=laya.utils.Utils,S$l=laya.utils.WeakObject;S$h.interface("laya.ui.IItem"),S$h.interface("laya.ui.ISelect"),S$h.interface("laya.ui.IRender"),S$h.interface("laya.ui.IComponent"),S$h.interface("laya.ui.IBox","IComponent");var S$C=function(){function S$a(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return S$e(S$a,"laya.ui.LayoutStyle"),S$P(S$a,["EMPTY",function(){return this.EMPTY=new S$a}]),S$a}(),S$f=function(){function S$a(){}return S$e(S$a,"laya.ui.Styles"),S$a.labelColor="#000000",S$a.buttonStateNum=3,S$a.scrollBarMinNum=15,S$a.scrollBarDelayTime=500,S$P(S$a,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),S$a}(),S$K=function(){function S$_(){}return S$e(S$_,"laya.ui.UIUtils"),S$_.fillArray=function(S$a,S$m,S$s){var S$P=S$a.concat();if(S$m)for(var S$_=S$m.split(","),S$e=0,S$A=Math.min(S$P.length,S$_.length);S$e<S$A;S$e++){var S$B=S$_[S$e];S$P[S$e]="true"==S$B||"false"!=S$B&&S$B,null!=S$s&&(S$P[S$e]=S$s(S$B))}return S$P},S$_.toColor=function(S$a){return S$U.toHexColor(S$a)},S$_.gray=function(S$a,S$m){void 0===S$m&&(S$m=!0),S$m?S$_.addFilter(S$a,S$_.grayFilter):S$_.clearFilter(S$a,S$B)},S$_.addFilter=function(S$a,S$m){var S$s=S$a.filters||[];S$s.push(S$m),S$a.filters=S$s},S$_.clearFilter=function(S$a,S$m){var S$s=S$a.filters;if(null!=S$s&&0<S$s.length){for(var S$P=S$s.length-1;-1<S$P;S$P--){var S$_=S$s[S$P];S$h.__typeof(S$_,S$m)&&S$s.splice(S$P,1)}S$a.filters=S$s}},S$_._getReplaceStr=function(S$a){return S$_.escapeSequence[S$a]},S$_.adptString=function(S$a){return S$a.replace(/\\(\w)/g,S$_._getReplaceStr)},S$_.getBindFun=function(S$a){var S$m=S$_._funMap.get(S$a);if(null==S$m){var S$s='"'+S$a+'"',S$P="(function(data){if(data==null)return;with(data){try{\nreturn "+(S$s=S$s.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";S$m=S$h._runScript(S$P),S$_._funMap.set(S$a,S$m)}return S$m},S$P(S$_,["grayFilter",function(){return this.grayFilter=new S$B([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new S$l}]),S$_}(),S$V=function(){function S$a(){}return S$e(S$a,"UIConfig"),S$a.touchScrollEnable=!0,S$a.mouseWheelEnable=!0,S$a.showButtons=!0,S$a.popupBgColor="#000000",S$a.popupBgAlpha=.5,S$a.closeDialogOnSide=!0,S$a}(),S$W=function(S$s){function S$O(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,S$O.__super.call(this),this._weakKeys=[]}S$e(S$O,"laya.ui.AutoBitmap",S$s);var S$a=S$O.prototype;return S$a.destroy=function(){if(S$p.clearObject(this,this._weakKey),this._weakKeys){for(var S$a=0,S$m=this._weakKeys.length;S$a<S$m;++S$a)S$p.clearObject(this,this._weakKeys[S$a]);this._weakKeys=null}S$s.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},S$a._setChanged=function(){this._isChanged||(this._isChanged=!0,S$h.timer.callLater(this,this.changeSource))},S$a.changeSource=function(){this._isChanged=!1;var S$a=this._source;if(S$a&&S$a.bitmap){var S$m=this.width,S$s=this.height,S$P=this._sizeGrid,S$_=S$a.sourceWidth,S$e=S$a.sourceHeight;if(!S$P||S$_===S$m&&S$e===S$s)this.cleanByTexture(S$a,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,S$m,S$s);else{S$p.clearObject(this,this._weakKey),S$a.$_GID||(S$a.$_GID=S$U.getGID());var S$A=S$a.$_GID+"."+S$m+"."+S$s+"."+S$P.join("."),S$B=S$p.findObject(S$A);if(S$U.isOKCmdList(S$B))return this._weakKey=S$A,S$p.keepObject(this,this._weakKey),void(this.cmds=S$B);this.clear();var S$k,S$j,S$G=S$P[0],S$y=S$P[1],S$d=S$P[2],S$Q=S$P[3],S$q=S$P[4],S$h=!1;if(S$m==S$_&&(S$Q=S$y=0),S$s==S$e&&(S$G=S$d=0),S$m<S$Q+S$y){var S$u=S$m;S$h=!0,S$m=S$Q+S$y,this.save(),this.clipRect(0,0,S$u,S$s)}S$Q&&S$G&&(S$k=S$O.getTexture(S$a,0,0,S$Q,S$G),S$j=this._weakKeys[0],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[0]=S$k.weakKey),this.drawTexture(S$k,0,0,S$Q,S$G)):(S$p.clearObject(this,S$j),this._weakKeys[0]="")),S$y&&S$G&&(S$k=S$O.getTexture(S$a,S$_-S$y,0,S$y,S$G),S$j=this._weakKeys[1],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[1]=S$k.weakKey),this.drawTexture(S$k,S$m-S$y,0,S$y,S$G)):(S$p.clearObject(this,S$j),this._weakKeys[1]="")),S$Q&&S$d&&(S$k=S$O.getTexture(S$a,0,S$e-S$d,S$Q,S$d),S$j=this._weakKeys[2],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[2]=S$k.weakKey),this.drawTexture(S$k,0,S$s-S$d,S$Q,S$d)):(S$p.clearObject(this,S$j),this._weakKeys[2]="")),S$y&&S$d&&(S$k=S$O.getTexture(S$a,S$_-S$y,S$e-S$d,S$y,S$d),S$j=this._weakKeys[3],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[3]=S$k.weakKey),this.drawTexture(S$k,S$m-S$y,S$s-S$d,S$y,S$d)):(S$p.clearObject(this,S$j),this._weakKeys[3]="")),S$G&&(S$k=S$O.getTexture(S$a,S$Q,0,S$_-S$Q-S$y,S$G),S$j=this._weakKeys[4],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[4]=S$k.weakKey),this.drawBitmap(S$q,S$k,S$Q,0,S$m-S$Q-S$y,S$G)):(S$p.clearObject(this,S$j),this._weakKeys[4]="")),S$d&&(S$k=S$O.getTexture(S$a,S$Q,S$e-S$d,S$_-S$Q-S$y,S$d),S$j=this._weakKeys[5],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[5]=S$k.weakKey),this.drawBitmap(S$q,S$k,S$Q,S$s-S$d,S$m-S$Q-S$y,S$d)):(S$p.clearObject(this,S$j),this._weakKeys[5]="")),S$Q&&(S$k=S$O.getTexture(S$a,0,S$G,S$Q,S$e-S$G-S$d),S$j=this._weakKeys[6],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[6]=S$k.weakKey),this.drawBitmap(S$q,S$k,0,S$G,S$Q,S$s-S$G-S$d)):(S$p.clearObject(this,S$j),this._weakKeys[6]="")),S$y&&(S$k=S$O.getTexture(S$a,S$_-S$y,S$G,S$y,S$e-S$G-S$d),S$j=this._weakKeys[7],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[7]=S$k.weakKey),this.drawBitmap(S$q,S$k,S$m-S$y,S$G,S$y,S$s-S$G-S$d)):(S$p.clearObject(this,S$j),this._weakKeys[7]="")),S$k=S$O.getTexture(S$a,S$Q,S$G,S$_-S$Q-S$y,S$e-S$G-S$d),S$j=this._weakKeys[8],S$k?(S$j!=S$k.weakKey&&(S$p.clearObject(this,S$j),S$p.keepObject(this,S$k.weakKey),this._weakKeys[8]=S$k.weakKey),this.drawBitmap(S$q,S$k,S$Q,S$G,S$m-S$Q-S$y,S$s-S$G-S$d)):(S$p.clearObject(this,S$j),this._weakKeys[8]=""),S$h&&this.restore(),this.autoCacheCmd&&!S$c.isConchApp&&(S$p.saveObject(S$A,this.cmds,null),this._weakKey=S$A,S$p.keepObject(this,this._weakKey))}this._repaint()}},S$a.drawBitmap=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=0),S$_<.1||S$e<.1||(!S$a||S$m.width==S$_&&S$m.height==S$e?this.drawTexture(S$m,S$s,S$P,S$_,S$e):this.fillTexture(S$m,S$s,S$P,S$_,S$e))},S$a.clear=function(S$a){void 0===S$a&&(S$a=!0),S$s.prototype.clear.call(this,!1)},S$A(0,S$a,"sizeGrid",function(){return this._sizeGrid},function(S$a){this._sizeGrid=S$a,this._setChanged()}),S$A(0,S$a,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(S$a){this._width!=S$a&&(this._width=S$a,this._setChanged())}),S$A(0,S$a,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(S$a){this._height!=S$a&&(this._height=S$a,this._setChanged())}),S$A(0,S$a,"source",function(){return this._source},function(S$a){S$a?(this._source=S$a,this._setChanged()):(this._source=null,this.clear())}),S$O.getTexture=function(S$a,S$m,S$s,S$P,S$_){S$P<=0&&(S$P=1),S$_<=0&&(S$_=1),S$a.$_GID||(S$a.$_GID=S$U.getGID());var S$e=S$a.$_GID+"."+S$m+"."+S$s+"."+S$P+"."+S$_,S$A=S$p.findObject(S$e);if((!S$A||!S$A.source)&&(S$A=S$N.createFromTexture(S$a,S$m,S$s,S$P,S$_))){if(S$a.alphaTexture){var S$B=S$a.width/S$a.alphaTexture.width;S$A.alphaTexture=S$N.createFromTexture(S$a.alphaTexture,S$m/S$B,S$s/S$B,S$P/S$B,S$_/S$B)}S$p.saveObject(S$e,S$A),S$A.weakKey=S$e}return S$A},S$O}(S$m),S$b=(function(S$a){function S$m(){S$m.__super.call(this)}S$e(S$m,"laya.ui.UIEvent",S$j),S$m.SHOW_TIP="showtip",S$m.HIDE_TIP="hidetip"}(),function(S$m){function S$a(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,S$a.__super.call(this),this._layout=S$C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}S$e(S$a,"laya.ui.Component",S$m);var S$s=S$a.prototype;return S$h.imps(S$s,{"laya.ui.IComponent":!0}),S$s.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},S$s.preinitialize=function(){},S$s.createChildren=function(){},S$s.initialize=function(){},S$s.callLater=function(S$a,S$m){S$h.timer.callLater(this,S$a,S$m)},S$s.runCallLater=function(S$a){S$h.timer.runCallLater(this,S$a)},S$s.commitMeasure=function(){},S$s.changeSize=function(){this.event("resize")},S$s.getLayout=function(){return this._layout===S$C.EMPTY&&(this._layout=new S$C),this._layout},S$s._setLayoutEnabled=function(S$a){this._layout&&this._layout.enable!=S$a&&(this._layout.enable=S$a,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},S$s.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},S$s.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},S$s.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},S$s.resetLayoutX=function(){var S$a=this._layout;if(isNaN(S$a.anchorX)||(this.pivotX=S$a.anchorX*this.width),this.layoutEnabled){var S$m=this.parent;S$m&&(isNaN(S$a.centerX)?isNaN(S$a.left)?isNaN(S$a.right)||(this.x=Math.round(S$m.width-this.displayWidth-S$a.right+this.pivotX*this.scaleX)):(this.x=Math.round(S$a.left+this.pivotX*this.scaleX),isNaN(S$a.right)||(this.width=(S$m._width-S$a.left-S$a.right)/(this.scaleX||.01))):this.x=Math.round(.5*(S$m.width-this.displayWidth)+S$a.centerX+this.pivotX*this.scaleX))}},S$s.resetLayoutY=function(){var S$a=this._layout;if(isNaN(S$a.anchorY)||(this.pivotY=S$a.anchorY*this.height),this.layoutEnabled){var S$m=this.parent;S$m&&(isNaN(S$a.centerY)?isNaN(S$a.top)?isNaN(S$a.bottom)||(this.y=Math.round(S$m.height-this.displayHeight-S$a.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(S$a.top+this.pivotY*this.scaleY),isNaN(S$a.bottom)||(this.height=(S$m._height-S$a.top-S$a.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(S$m.height-this.displayHeight)+S$a.centerY+this.pivotY*this.scaleY))}},S$s.onMouseOver=function(S$a){S$h.stage.event("showtip",this._toolTip)},S$s.onMouseOut=function(S$a){S$h.stage.event("hidetip",this._toolTip)},S$A(0,S$s,"displayWidth",function(){return this.width*this.scaleX}),S$A(0,S$s,"width",function(){return this._width?this._width:this.measureWidth},function(S$a){this._width!=S$a&&(this._width=S$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),S$A(0,S$s,"measureWidth",function(){var S$a=0;this.commitMeasure();for(var S$m=this.numChildren-1;-1<S$m;S$m--){var S$s=this.getChildAt(S$m);S$s.visible&&(S$a=Math.max(S$s.x+S$s.width*S$s.scaleX,S$a))}return S$a}),S$A(0,S$s,"displayHeight",function(){return this.height*this.scaleY}),S$A(0,S$s,"height",function(){return this._height?this._height:this.measureHeight},function(S$a){this._height!=S$a&&(this._height=S$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),S$A(0,S$s,"dataSource",function(){return this._dataSource},function(S$a){for(var S$m in this._dataSource=S$a,this._dataSource)this.hasOwnProperty(S$m)&&"function"!=typeof this[S$m]&&(this[S$m]=this._dataSource[S$m])}),S$A(0,S$s,"scaleY",S$m.prototype._$get_scaleY,function(S$a){S$h.superGet(S$H,this,"scaleY")!=S$a&&(S$h.superSet(S$H,this,"scaleY",S$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),S$A(0,S$s,"measureHeight",function(){var S$a=0;this.commitMeasure();for(var S$m=this.numChildren-1;-1<S$m;S$m--){var S$s=this.getChildAt(S$m);S$s.visible&&(S$a=Math.max(S$s.y+S$s.height*S$s.scaleY,S$a))}return S$a}),S$A(0,S$s,"scaleX",S$m.prototype._$get_scaleX,function(S$a){S$h.superGet(S$H,this,"scaleX")!=S$a&&(S$h.superSet(S$H,this,"scaleX",S$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),S$A(0,S$s,"top",function(){return this._layout.top},function(S$a){S$a!=this._layout.top&&(this.getLayout().top=S$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),S$A(0,S$s,"bottom",function(){return this._layout.bottom},function(S$a){S$a!=this._layout.bottom&&(this.getLayout().bottom=S$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),S$A(0,S$s,"left",function(){return this._layout.left},function(S$a){S$a!=this._layout.left&&(this.getLayout().left=S$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),S$A(0,S$s,"right",function(){return this._layout.right},function(S$a){S$a!=this._layout.right&&(this.getLayout().right=S$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),S$A(0,S$s,"centerX",function(){return this._layout.centerX},function(S$a){S$a!=this._layout.centerX&&(this.getLayout().centerX=S$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),S$A(0,S$s,"centerY",function(){return this._layout.centerY},function(S$a){S$a!=this._layout.centerY&&(this.getLayout().centerY=S$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),S$A(0,S$s,"anchorX",function(){return this._layout.anchorX},function(S$a){S$a!=this._layout.anchorX&&(this.getLayout().anchorX=S$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),S$A(0,S$s,"anchorY",function(){return this._layout.anchorY},function(S$a){S$a!=this._layout.anchorY&&(this.getLayout().anchorY=S$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),S$A(0,S$s,"tag",function(){return this._tag},function(S$a){this._tag=S$a}),S$A(0,S$s,"toolTip",function(){return this._toolTip},function(S$a){this._toolTip!=S$a&&(null!=(this._toolTip=S$a)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),S$A(0,S$s,"comXml",function(){return this._comXml},function(S$a){this._comXml=S$a}),S$A(0,S$s,"gray",function(){return this._gray},function(S$a){S$a!==this._gray&&(this._gray=S$a,S$K.gray(this,S$a))}),S$A(0,S$s,"disabled",function(){return this._disabled},function(S$a){S$a!==this._disabled&&(this.gray=this._disabled=S$a,this.mouseEnabled=!S$a)}),S$a}(S$H)),S$S=function(S$a){function S$m(){this.lockLayer=null,this.popupEffect=function(S$a){S$a.scale(1,1),S$z.from(S$a,{x:S$h.stage.width/2,y:S$h.stage.height/2,scaleX:0,scaleY:0},300,S$k.backOut,S$d.create(this,this.doOpen,[S$a]))},this.closeEffect=function(S$a,S$m){S$z.to(S$a,{x:S$h.stage.width/2,y:S$h.stage.height/2,scaleX:0,scaleY:0},300,S$k.strongOut,S$d.create(this,this.doClose,[S$a,S$m]))},S$m.__super.call(this),this.maskLayer=new S$H,this.popupEffectHandler=S$d.create(this,this.popupEffect,null,!1),this.closeEffectHandler=S$d.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,S$h.stage.addChild(this),S$h.stage.on("resize",this,this._onResize),S$V.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}S$e(S$m,"laya.ui.DialogManager",S$H);var S$s=S$m.prototype;return S$s._closeOnSide=function(){var S$a=this.getChildAt(this.numChildren-1);S$a instanceof laya.ui.Dialog&&S$a.close("side")},S$s.setLockView=function(S$a){this.lockLayer||(this.lockLayer=new S$Z,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(S$h.stage.width,S$h.stage.height)),this.lockLayer.removeChildren(),S$a&&(S$a.centerX=S$a.centerY=0,this.lockLayer.addChild(S$a))},S$s._onResize=function(S$a){var S$m=this.maskLayer.width=S$h.stage.width,S$s=this.maskLayer.height=S$h.stage.height;this.lockLayer&&this.lockLayer.size(S$m,S$s),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,S$m,S$s,S$V.popupBgColor),this.maskLayer.alpha=S$V.popupBgAlpha;for(var S$P=this.numChildren-1;-1<S$P;S$P--){var S$_=this.getChildAt(S$P);S$_.popupCenter&&this._centerDialog(S$_)}},S$s._centerDialog=function(S$a){S$a.x=Math.round((S$h.stage.width-S$a.width>>1)+S$a.pivotX),S$a.y=Math.round((S$h.stage.height-S$a.height>>1)+S$a.pivotY)},S$s.open=function(S$a,S$m,S$s){void 0===S$m&&(S$m=!1),void 0===S$s&&(S$s=!1),S$m&&this._closeAll(),S$a.popupCenter&&this._centerDialog(S$a),this.addChild(S$a),(S$a.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),S$s&&null!=S$a.popupEffect?S$a.popupEffect.runWith(S$a):this.doOpen(S$a),this.event("open")},S$s.doOpen=function(S$a){S$a.onOpened()},S$s.lock=function(S$a){this.lockLayer&&(S$a?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},S$s.close=function(S$a,S$m,S$s){void 0===S$s&&(S$s=!1),S$s&&null!=S$a.closeEffect?S$a.closeEffect.runWith([S$a,S$m]):this.doClose(S$a,S$m),this.event("close")},S$s.doClose=function(S$a,S$m){S$a.removeSelf(),S$a.isModal&&this._checkMask(),S$a.closeHandler&&S$a.closeHandler.runWith(S$m),S$a.onClosed(S$m)},S$s.closeAll=function(){this._closeAll(),this.event("close")},S$s._closeAll=function(){for(var S$a=this.numChildren-1;-1<S$a;S$a--){var S$m=this.getChildAt(S$a);S$m&&null!=S$m.close&&this.doClose(S$m)}},S$s.getDialogsByGroup=function(S$a){for(var S$m=[],S$s=this.numChildren-1;-1<S$s;S$s--){var S$P=this.getChildAt(S$s);S$P&&S$P.group===S$a&&S$m.push(S$P)}return S$m},S$s.closeByGroup=function(S$a){for(var S$m=[],S$s=this.numChildren-1;-1<S$s;S$s--){var S$P=this.getChildAt(S$s);S$P&&S$P.group===S$a&&(S$P.close(),S$m.push(S$P))}return S$m},S$s._checkMask=function(){this.maskLayer.removeSelf();for(var S$a=this.numChildren-1;-1<S$a;S$a--){var S$m=this.getChildAt(S$a);if(S$m&&S$m.isModal)return void this.addChildAt(this.maskLayer,S$a)}},S$m}(),S$Z=function(S$a){function S$m(){S$m.__super.call(this)}S$e(S$m,"laya.ui.Box",S$a);var S$s=S$m.prototype;return S$h.imps(S$s,{"laya.ui.IBox":!0}),S$A(0,S$s,"dataSource",S$a.prototype._$get_dataSource,function(S$a){for(var S$m in this._dataSource=S$a){var S$s=this.getChildByName(S$m);S$s?S$s.dataSource=S$a[S$m]:this.hasOwnProperty(S$m)&&"function"!=typeof this[S$m]&&(this[S$m]=S$a[S$m])}}),S$m}(S$b),S$X=function(S$m){function S$s(S$a,S$m){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,S$s.__super.call(this),this._labelColors=S$f.buttonLabelColors,this._stateNum=S$f.buttonStateNum,void 0===S$m&&(S$m=""),this.skin=S$a,this.label=S$m}S$e(S$s,"laya.ui.Button",S$m);var S$a=S$s.prototype;return S$h.imps(S$a,{"laya.ui.ISelect":!0}),S$a.destroy=function(S$a){this.clearEvent(),S$p.clearCache(this,this._skin),S$p.clearObject(this,this._weakKey),void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(S$a),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},S$a.clearEvent=function(){this._skin&&S$_.atalsNotify&&S$_.atalsNotify.off(this._skin,this,this._setBtnSource)},S$a.createChildren=function(){this.graphics=this._bitmap=new S$W},S$a.createText=function(){this._text||(this._text=new S$o,this._text.overflow=S$o.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},S$a.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},S$a.onMouse=function(S$a){if(!1!==this.toggle||!this._selected)return"click"===S$a.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=S$s.stateMap[S$a.type]))},S$a.changeClips=function(){var S$a=S$p.getRes(this._skin);if(S$a)if(this._skin&&""!=this._skin){S$p.clearObject(this,this._weakKey);var S$m=S$a.sourceWidth,S$s=S$a.sourceHeight/this._stateNum;S$a.$_GID||(S$a.$_GID=S$U.getGID());var S$P=S$a.$_GID+"-"+this._stateNum,S$_=S$p.findObject(S$P);if(S$U.isOkTextureList(S$_)||(S$_=null),S$_)this._weakKey=S$P,S$p.keepObject(this,this._weakKey),this._sources=S$_;else{if(this._sources=[],1===this._stateNum)this._sources.push(S$a);else for(var S$e=0;S$e<this._stateNum;S$e++){var S$A=S$N.createFromTexture(S$a,0,S$s*S$e,S$m,S$s);if(S$a.alphaTexture){var S$B=S$a.width/S$a.alphaTexture.width;S$A.alphaTexture=S$N.createFromTexture(S$a.alphaTexture,0/S$B,S$s*S$e/S$B,S$m/S$B,S$s/S$B)}this._sources.push(S$A)}S$p.saveObject(S$P,this._sources),this._weakKey=S$P,S$p.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||S$m,this._bitmap.height=this._height||S$s,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=S$m)}else console.warn("lose skin ",this._skin,this.name,this.__className)},S$a.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var S$a=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[S$a]),this.label&&(this._text.color=this._labelColors[S$a],this._strokeColors&&(this._text.strokeColor=this._strokeColors[S$a]))},S$a._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},S$A(0,S$a,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(S$a){this.createText(),this._text.strokeColor=S$a}),S$A(0,S$a,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),S$A(0,S$a,"skin",function(){return this._skin},function(S$a){if(this._skin!=S$a)if(this.clearEvent(),S$p.clearCache(this,this._skin),this._skin=S$a,S$p.keepCache(this,this._skin),S$p.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var S$m=S$_.resAtalsObj&&S$_.resAtalsObj[this._skin];S$m?(S$_.atalsNotify&&S$_.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=S$m.sourceW),0==this.height&&(this.height=S$m.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),S$a._setBtnSource=function(S$a,S$m){S$a===this._skin&&S$m&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},S$A(0,S$a,"state",function(){return this._state},function(S$a){this._state!=S$a&&(this._state=S$a,this._setStateChanged())}),S$A(0,S$a,"text",function(){return this.createText(),this._text}),S$A(0,S$a,"stateNum",function(){return this._stateNum},function(S$a){"string"==typeof S$a&&(S$a=parseInt(S$a)),this._stateNum!=S$a&&(this._stateNum=S$a<1?1:3<S$a?3:S$a,this.callLater(this.changeClips))}),S$A(0,S$a,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(S$a){this._strokeColors=S$K.fillArray(S$f.buttonLabelColors,S$a,String),this._setStateChanged()}),S$A(0,S$a,"labelColors",function(){return this._labelColors.join(",")},function(S$a){this._labelColors=S$K.fillArray(S$f.buttonLabelColors,S$a,String),this._setStateChanged()}),S$A(0,S$a,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),S$A(0,S$a,"label",function(){return this._text?this._text.text:null},function(S$a){(this._text||S$a)&&(this.createText(),this._text.text!=S$a&&(S$a&&!this._text.parent&&this.addChild(this._text),this._text.text=(S$a+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),S$A(0,S$a,"selected",function(){return this._selected},function(S$a){this._selected!=S$a&&(this._selected=S$a,this.state=this._selected?2:0,this.event("change"))}),S$A(0,S$a,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(S$a){this.createText(),this._text.padding=S$K.fillArray(S$f.labelPadding,S$a,Number)}),S$A(0,S$a,"labelSize",function(){return this.createText(),this._text.fontSize},function(S$a){this.createText(),this._text.fontSize=S$a}),S$A(0,S$a,"labelStroke",function(){return this.createText(),this._text.stroke},function(S$a){this.createText(),this._text.stroke=S$a}),S$A(0,S$a,"labelBold",function(){return this.createText(),this._text.bold},function(S$a){this.createText(),this._text.bold=S$a}),S$A(0,S$a,"labelFont",function(){return this.createText(),this._text.font},function(S$a){this.createText(),this._text.font=S$a}),S$A(0,S$a,"labelAlign",function(){return this.createText(),this._text.align},function(S$a){this.createText(),this._text.align=S$a}),S$A(0,S$a,"clickHandler",function(){return this._clickHandler},function(S$a){this._clickHandler=S$a}),S$A(0,S$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(S$a){this._bitmap.sizeGrid=S$K.fillArray(S$f.defaultSizeGrid,S$a,Number)}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$b,this,"width",S$a),this._autoSize&&(this._bitmap.width=S$a,this._text&&(this._text.width=S$a))}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$b,this,"height",S$a),this._autoSize&&(this._bitmap.height=S$a,this._text&&(this._text.height=S$a))}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)||"string"==typeof S$a?this.label=S$a+"":S$h.superSet(S$b,this,"dataSource",S$a)}),S$A(0,S$a,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(S$a){this._bitmap._offset=S$a?S$K.fillArray([1,1],S$a,Number):[]}),S$P(S$s,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),S$s}(S$b),S$E=function(S$m){function S$P(S$a,S$m,S$s){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,S$P.__super.call(this),void 0===S$m&&(S$m=1),void 0===S$s&&(S$s=1),this._clipX=S$m,this._clipY=S$s,this.skin=S$a}S$e(S$P,"laya.ui.Clip",S$m);var S$a=S$P.prototype;return S$a.destroy=function(S$a){this.clearEvent(),this.clearLoad(),S$p.clearCache(this,this._skin),S$p.clearObject(this,this._weakKey),void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},S$a.dispose=function(){this.destroy(!0),S$h.loader.clearRes(this._skin)},S$a.createChildren=function(){this.graphics=this._bitmap=new S$W},S$a._onDisplay=function(S$a){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},S$a.changeClip=function(){if(this._clipChanged=!1,this._skin){var S$a=S$p.getRes(this._skin);if(S$a)this.loadComplete(this._skin,S$a);else{if(S$_.resAtalsObj&&S$_.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=S$d.create(this,this.loadComplete,[this._skin]),this._progress=null,S$h.loader.load(this._skin,this._complete,this._progress)}}},S$a.loadComplete=function(S$a,S$m){if(S$a===this._skin&&S$m){S$p.clearObject(this,this._weakKey);var S$s=this._clipWidth||Math.ceil(S$m.sourceWidth/this._clipX),S$P=this._clipHeight||Math.ceil(S$m.sourceHeight/this._clipY),S$_=this._skin+S$s+S$P,S$e=S$p.findObject(S$_);if(S$U.isOkTextureList(S$e)||(S$e=null),S$e)this._weakKey=S$_,S$p.keepObject(this,this._weakKey),this._sources=S$e;else{this._sources=[];for(var S$A=0;S$A<this._clipY;S$A++)for(var S$B=0;S$B<this._clipX;S$B++){var S$k=S$N.createFromTexture(S$m,S$s*S$B,S$P*S$A,S$s,S$P);if(S$m.alphaTexture){var S$j=S$m.width/S$m.alphaTexture.width;S$k.alphaTexture=S$N.createFromTexture(S$m.alphaTexture,S$s*S$B/S$j,S$P*S$A/S$j,S$s/S$j,S$P/S$j)}this._sources.push(S$k)}S$p.saveObject(S$_,this._sources),this._weakKey=S$_,S$p.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},S$a.play=function(S$a,S$m){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=-1),this._isPlaying=!0,this.index=S$a,this._toIndex=S$m,this._index++,S$h.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},S$a._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},S$a.stop=function(){this._isPlaying=!1,S$h.timer.clear(this,this._loop),this.event("complete")},S$a._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},S$A(0,S$a,"interval",function(){return this._interval},function(S$a){this._interval!=S$a&&(this._interval=S$a,this._isPlaying&&this.play())}),S$a.clearEvent=function(){this._skin&&S$_.atalsNotify&&S$_.atalsNotify.off(this._skin,this,this._setBtnSource)},S$a.clearLoad=function(){this._skin&&((this._complete||this._progress)&&S$h.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},S$A(0,S$a,"skin",function(){return this._skin},function(S$a){if(this._skin!=S$a)if(this.clearLoad(),this.clearEvent(),S$p.clearCache(this,this._skin),this._skin=S$a){S$p.keepCache(this,this._skin);var S$m=S$p.getRes(S$a),S$s=S$_.resAtalsObj&&S$_.resAtalsObj[this._skin];!S$m&&S$s?S$_.atalsNotify&&S$_.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),S$a._setBtnSource=function(S$a,S$m){S$a===this._skin&&S$m&&(this.loadComplete(S$a,S$m),this.clearEvent())},S$A(0,S$a,"sources",function(){return this._sources},function(S$a){this._sources=S$a,this.index=this._index,this.event("loaded")}),S$A(0,S$a,"clipX",function(){return this._clipX},function(S$a){this._clipX=S$a||1,this._setClipChanged()}),S$A(0,S$a,"clipY",function(){return this._clipY},function(S$a){this._clipY=S$a||1,this._setClipChanged()}),S$A(0,S$a,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),S$A(0,S$a,"clipWidth",function(){return this._clipWidth},function(S$a){this._clipWidth=S$a,this._setClipChanged()}),S$A(0,S$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(S$a){this._bitmap.sizeGrid=S$K.fillArray(S$f.defaultSizeGrid,S$a,Number)}),S$A(0,S$a,"group",function(){return this._group},function(S$a){S$a&&this._skin&&S$p.setGroup(this._skin,S$a),this._group=S$a}),S$A(0,S$a,"clipHeight",function(){return this._clipHeight},function(S$a){this._clipHeight=S$a,this._setClipChanged()}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$b,this,"width",S$a),this._bitmap.width=S$a}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$b,this,"height",S$a),this._bitmap.height=S$a}),S$A(0,S$a,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),S$A(0,S$a,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),S$A(0,S$a,"index",function(){return this._index},function(S$a){this._index=S$a,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[S$a]),this.event("change")}),S$A(0,S$a,"autoPlay",function(){return this._autoPlay},function(S$a){this._autoPlay!=S$a&&((this._autoPlay=S$a)?this.play():this.stop())}),S$A(0,S$a,"isPlaying",function(){return this._isPlaying},function(S$a){this._isPlaying=S$a}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)&&Math.floor(S$a)==S$a||"string"==typeof S$a?this.index=parseInt(S$a):S$h.superSet(S$b,this,"dataSource",S$a)}),S$A(0,S$a,"bitmap",function(){return this._bitmap}),S$P}(S$b),S$i=function(S$m){function S$a(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,S$a.__super.call(this)}S$e(S$a,"laya.ui.ColorPicker",S$m);var S$s=S$a.prototype;return S$s.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._colorPanel&&this._colorPanel.destroy(S$a),this._colorButton&&this._colorButton.destroy(S$a),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},S$s.createChildren=function(){this.addChild(this._colorButton=new S$X),this._colorPanel=new S$Z,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new S$H),this._colorPanel.addChild(this._colorBlock=new S$H),this._colorPanel.addChild(this._colorInput=new S$Q)},S$s.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},S$s.onPanelMouseDown=function(S$a){S$a.stopPropagation()},S$s.changePanel=function(){this._panelChanged=!1;var S$a=this._colorPanel.graphics;S$a.clear(),S$a.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(S$a=this._colorTiles.graphics).clear();for(var S$m=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],S$s=0;S$s<12;S$s++)for(var S$P=0;S$P<20;S$P++){var S$_=0;S$_=0===S$P?S$m[S$s]:1===S$P?0:51*(((3*S$s+S$P/6)%3<<0)+3*(S$s/6<<0))<<16|S$P%6*51<<8|(S$s<<0)%6*51;var S$e=S$K.toColor(S$_);this._colors.push(S$e);var S$A=S$P*this._gridSize,S$B=S$s*this._gridSize;S$a.drawRect(S$A,S$B,this._gridSize,this._gridSize,S$e,"#000000")}},S$s.onColorButtonClick=function(S$a){this._colorPanel.parent?this.close():this.open()},S$s.open=function(){var S$a=this.localToGlobal(new S$q),S$m=S$a.x+this._colorPanel.width<=S$h.stage.width?S$a.x:S$h.stage.width-this._colorPanel.width,S$s=S$a.y+this._colorButton.height;S$s=S$s+this._colorPanel.height<=S$h.stage.height?S$s:S$a.y-this._colorPanel.height,this._colorPanel.pos(S$m,S$s),this._colorPanel.zOrder=1001,S$h._currentStage.addChild(this._colorPanel),S$h.stage.on("mousedown",this,this.removeColorBox)},S$s.close=function(){S$h.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},S$s.removeColorBox=function(S$a){this.close()},S$s.onColorFieldKeyDown=function(S$a){13==S$a.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),S$a.stopPropagation())},S$s.onColorInputChange=function(S$a){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},S$s.onColorTilesClick=function(S$a){this.selectedColor=this.getColorByMouse(),this.close()},S$s.onColorTilesMouseMove=function(S$a){this._colorInput.focus=!1;var S$m=this.getColorByMouse();this._colorInput.text=S$m,this.drawBlock(S$m)},S$s.getColorByMouse=function(){var S$a=this._colorTiles.getMousePoint(),S$m=Math.floor(S$a.x/this._gridSize),S$s=Math.floor(S$a.y/this._gridSize);return this._colors[20*S$s+S$m]},S$s.drawBlock=function(S$a){var S$m=this._colorBlock.graphics;S$m.clear();var S$s=S$a||"#ffffff";S$m.drawRect(0,0,50,20,S$s,this._borderColor),S$a||S$m.drawLine(0,0,50,20,"#ff0000")},S$s.changeColor=function(){var S$a=this.graphics;S$a.clear();var S$m=this._selectedColor||"#000000";S$a.drawRect(0,0,this._colorButton.width,this._colorButton.height,S$m)},S$s._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},S$A(0,S$s,"inputBgColor",function(){return this._inputBgColor},function(S$a){this._inputBgColor=S$a,this._setPanelChanged()}),S$A(0,S$s,"selectedColor",function(){return this._selectedColor},function(S$a){this._selectedColor!=S$a&&(this._selectedColor=this._colorInput.text=S$a,this.drawBlock(S$a),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",S$j.EMPTY.setTo("change",this,this)))}),S$A(0,S$s,"skin",function(){return this._colorButton.skin},function(S$a){this._colorButton.skin=S$a,this.changeColor()}),S$A(0,S$s,"bgColor",function(){return this._bgColor},function(S$a){this._bgColor=S$a,this._setPanelChanged()}),S$A(0,S$s,"borderColor",function(){return this._borderColor},function(S$a){this._borderColor=S$a,this._setPanelChanged()}),S$A(0,S$s,"inputColor",function(){return this._inputColor},function(S$a){this._inputColor=S$a,this._setPanelChanged()}),S$a}(S$b),S$t=function(S$m){function S$s(S$a,S$m){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,S$s.__super.call(this),this._itemColors=S$f.comboBoxItemColors,this.skin=S$a,this.labels=S$m}S$e(S$s,"laya.ui.ComboBox",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._button&&this._button.destroy(S$a),this._list&&this._list.destroy(S$a),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},S$a.createChildren=function(){this.addChild(this._button=new S$X),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},S$a._createList=function(){this._list=new S$v,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},S$a._setListEvent=function(S$a){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=S$d.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},S$a.onListDown=function(S$a){S$a.stopPropagation()},S$a.onScrollBarDown=function(S$a){S$a.stopPropagation()},S$a.onButtonMouseDown=function(S$a){this.callLater(this.switchTo,[!this._isOpen])},S$a.changeList=function(){this._listChanged=!1;var S$a=this.width-2,S$m=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:S$a,height:this._itemHeight,fontSize:this._itemSize,color:S$m}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},S$a.onlistItemMouse=function(S$a,S$m){var S$s=S$a.type;if("mouseover"===S$s||"mouseout"===S$s){if(this._isCustomList)return;var S$P=this._list.getCell(S$m);if(!S$P)return;var S$_=S$P.getChildByName("label");S$_&&("mouseover"===S$s?(S$_.bgColor=this._itemColors[0],S$_.color=this._itemColors[1]):(S$_.bgColor=null,S$_.color=this._itemColors[2]))}else"click"===S$s&&(this.selectedIndex=S$m,this.isOpen=!1)},S$a.switchTo=function(S$a){this.isOpen=S$a},S$a.changeOpen=function(){this.isOpen=!this._isOpen},S$a.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var S$a=this._list.graphics;S$a.clear(),S$a.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var S$m=this._list.array||[],S$s=S$m.length=0,S$P=this._labels.length;S$s<S$P;S$s++)S$m.push({label:this._labels[S$s]});this._list.height=this._listHeight,this._list.array=S$m},S$a.changeSelected=function(){this._button.label=this.selectedLabel},S$a._onStageMouseWheel=function(S$a){this._list&&!this._list.contains(S$a.target)&&this.removeList(null)},S$a.removeList=function(S$a){S$h.stage.off("mousedown",this,this.removeList),S$h.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},S$A(0,S$a,"selectedIndex",function(){return this._selectedIndex},function(S$a){this._selectedIndex!=S$a&&(this._selectedIndex=S$a,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[S$j.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),S$A(0,S$a,"measureHeight",function(){return this._button.height}),S$A(0,S$a,"skin",function(){return this._button.skin},function(S$a){this._button.skin!=S$a&&(this._button.skin=S$a,this._listChanged=!0)}),S$A(0,S$a,"measureWidth",function(){return this._button.width}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$b,this,"width",S$a),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),S$A(0,S$a,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(S$a){this.selectedIndex=this._labels.indexOf(S$a)}),S$A(0,S$a,"labels",function(){return this._labels.join(",")},function(S$a){0<this._labels.length&&(this.selectedIndex=-1),S$a?this._labels=S$a.split(","):this._labels.length=0,this._itemChanged=!0}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$b,this,"height",S$a),this._button.height=this._height}),S$A(0,S$a,"selectHandler",function(){return this._selectHandler},function(S$a){this._selectHandler=S$a}),S$A(0,S$a,"visibleNum",function(){return this._visibleNum},function(S$a){this._visibleNum=S$a,this._listChanged=!0}),S$A(0,S$a,"labelBold",function(){return this._button.text.bold},function(S$a){this._button.text.bold=S$a}),S$A(0,S$a,"itemColors",function(){return String(this._itemColors)},function(S$a){this._itemColors=S$K.fillArray(this._itemColors,S$a,String),this._listChanged=!0}),S$A(0,S$a,"itemSize",function(){return this._itemSize},function(S$a){this._itemSize=S$a,this._listChanged=!0}),S$A(0,S$a,"scrollBar",function(){return this.list.scrollBar}),S$A(0,S$a,"isOpen",function(){return this._isOpen},function(S$a){if(this._isOpen!=S$a)if(this._isOpen=S$a,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var S$m=this.localToGlobal(S$q.TEMP.setTo(0,0)),S$s=S$m.y+this._button.height;S$s=S$s+this._listHeight<=S$h.stage.height?S$s:S$m.y-this._listHeight,this._list.pos(S$m.x,S$s),this._list.zOrder=1001,S$h._currentStage.addChild(this._list),S$h.stage.once("mousedown",this,this.removeList),S$h.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),S$A(0,S$a,"scrollBarSkin",function(){return this._scrollBarSkin},function(S$a){this._scrollBarSkin=S$a}),S$A(0,S$a,"sizeGrid",function(){return this._button.sizeGrid},function(S$a){this._button.sizeGrid=S$a}),S$A(0,S$a,"button",function(){return this._button}),S$A(0,S$a,"list",function(){return this._list||this._createList(),this._list},function(S$a){S$a&&(S$a.removeSelf(),this._isCustomList=!0,this._list=S$a,this._setListEvent(S$a),this._itemHeight=S$a.getCell(0).height+S$a.spaceY)}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)&&Math.floor(S$a)==S$a||"string"==typeof S$a?this.selectedIndex=parseInt(S$a):S$a instanceof Array?this.labels=S$a.join(","):S$h.superSet(S$b,this,"dataSource",S$a)}),S$A(0,S$a,"labelColors",function(){return this._button.labelColors},function(S$a){this._button.labelColors!=S$a&&(this._button.labelColors=S$a)}),S$A(0,S$a,"labelPadding",function(){return this._button.text.padding.join(",")},function(S$a){this._button.text.padding=S$K.fillArray(S$f.labelPadding,S$a,Number)}),S$A(0,S$a,"labelSize",function(){return this._button.text.fontSize},function(S$a){this._button.text.fontSize=S$a}),S$A(0,S$a,"labelFont",function(){return this._button.text.font},function(S$a){this._button.text.font=S$a}),S$A(0,S$a,"stateNum",function(){return this._button.stateNum},function(S$a){this._button.stateNum=S$a}),S$s}(S$b),S$L=function(S$m){function S$s(S$a){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,S$s.__super.call(this),this._showButtons=S$V.showButtons,this._touchScrollEnable=S$V.touchScrollEnable,this._mouseWheelEnable=S$V.mouseWheelEnable,this.skin=S$a,this.max=1}S$e(S$s,"laya.ui.ScrollBar",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),this.stopScroll(),this.target=null,S$m.prototype.destroy.call(this,S$a),this.upButton&&this.upButton.destroy(S$a),this.downButton&&this.downButton.destroy(S$a),this.slider&&this.slider.destroy(S$a),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},S$a.createChildren=function(){this.addChild(this.slider=new S$R),this.addChild(this.upButton=new S$X),this.addChild(this.downButton=new S$X)},S$a.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},S$a.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},S$a.onButtonMouseDown=function(S$a){var S$m=S$a.currentTarget===this.upButton;this.slide(S$m),S$h.timer.once(S$f.scrollBarDelayTime,this,this.startLoop,[S$m]),S$h.stage.once("mouseup",this,this.onStageMouseUp)},S$a.startLoop=function(S$a){S$h.timer.frameLoop(1,this,this.slide,[S$a])},S$a.slide=function(S$a){S$a?this.value-=this._scrollSize:this.value+=this._scrollSize},S$a.onStageMouseUp=function(S$a){S$h.timer.clear(this,this.startLoop),S$h.timer.clear(this,this.slide)},S$a.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},S$a.changeSize=function(){S$m.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},S$a.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},S$a.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},S$a.setScroll=function(S$a,S$m,S$s){this.runCallLater(this.changeSize),this.slider.setSlider(S$a,S$m,S$s),this.slider.bar.visible=0<S$m,!this._hide&&this.autoHide&&(this.visible=!1)},S$a.onTargetMouseWheel=function(S$a){this.value-=S$a.delta*this._scrollSize,this.target=this._target},S$a.onTargetMouseDown=function(S$a){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new S$q),this._lastPoint.setTo(S$h.stage.mouseX,S$h.stage.mouseY),S$h.timer.clear(this,this.tweenMove),S$z.clearTween(this),S$h.stage.once("mouseup",this,this.onStageMouseUp2),S$h.stage.once("mouseout",this,this.onStageMouseUp2),S$h.timer.frameLoop(1,this,this.loop)},S$a.loop=function(){var S$a=S$h.stage.mouseY,S$m=S$h.stage.mouseX;if(this._lastOffset=this.isVertical?S$a-this._lastPoint.y:S$m-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?S$h.stage._canvasTransform.getScaleY():S$h.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=S$m,this._lastPoint.y=S$a,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},S$a.onStageMouseUp2=function(S$a){if(S$h.stage.off("mouseup",this,this.onStageMouseUp2),S$h.stage.off("mouseout",this,this.onStageMouseUp2),S$h.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?S$z.to(this,{value:this.min},this.elasticBackTime,S$k.sineOut,S$d.create(this,this.elasticOver)):this._value>this.max&&S$z.to(this,{value:this.max},this.elasticBackTime,S$k.sineOut,S$d.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?S$h.stage.mouseY-this._lastPoint.y:S$h.stage.mouseX-this._lastPoint.x);for(var S$m=0,S$s=Math.min(this._offsets.length,3),S$P=0;S$P<S$s;S$P++)S$m+=this._offsets[this._offsets.length-1-S$P];if(this._lastOffset=S$m/S$s,(S$m=Math.abs(this._lastOffset))<2)return void this.event("end");60<S$m&&(this._lastOffset=0<this._lastOffset?60:-60);var S$_=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));S$h.timer.frameLoop(1,this,this.tweenMove,[S$_])}},S$a.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&S$z.to(this,{alpha:0},500),this.event("end")},S$a.tweenMove=function(S$a){this._lastOffset*=this.rollRatio;var S$m=NaN;if(0<S$a&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,S$m=.5*-(this.min-S$a-this.value),this._lastOffset>S$m&&(this._lastOffset=S$m)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,S$m=.5*-(this.max+S$a-this.value),this._lastOffset<S$m&&(this._lastOffset=S$m))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(S$h.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?S$z.to(this,{value:this.min},this.elasticBackTime,S$k.sineOut,S$d.create(this,this.elasticOver)):this._value>this.max?S$z.to(this,{value:this.max},this.elasticBackTime,S$k.sineOut,S$d.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&S$z.to(this,{alpha:0},500)}},S$a.stopScroll=function(){this.onStageMouseUp2(null),S$h.timer.clear(this,this.tweenMove),S$z.clearTween(this)},S$A(0,S$a,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),S$A(0,S$a,"skin",function(){return this._skin},function(S$a){this._skin!=S$a&&(this._skin=S$a,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),S$A(0,S$a,"max",function(){return this.slider.max},function(S$a){this.slider.max=S$a}),S$A(0,S$a,"showButtons",function(){return this._showButtons},function(S$a){this._showButtons=S$a,this.callLater(this.changeScrollBar)}),S$A(0,S$a,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),S$A(0,S$a,"min",function(){return this.slider.min},function(S$a){this.slider.min=S$a}),S$A(0,S$a,"value",function(){return this._value},function(S$a){S$a!==this._value&&(this._value=S$a,this._isElastic||(this.slider._value!=S$a&&(this.slider._value=S$a,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),S$A(0,S$a,"isVertical",function(){return this.slider.isVertical},function(S$a){this.slider.isVertical=S$a}),S$A(0,S$a,"sizeGrid",function(){return this.slider.sizeGrid},function(S$a){this.slider.sizeGrid=S$a}),S$A(0,S$a,"scrollSize",function(){return this._scrollSize},function(S$a){this._scrollSize=S$a}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)||"string"==typeof S$a?this.value=Number(S$a):S$h.superSet(S$b,this,"dataSource",S$a)}),S$A(0,S$a,"thumbPercent",function(){return this._thumbPercent},function(S$a){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),S$a=1<=S$a?.99:S$a,this._thumbPercent=S$a,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*S$a,S$f.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*S$a,S$f.scrollBarMinNum))}),S$A(0,S$a,"target",function(){return this._target},function(S$a){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=S$a)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),S$A(0,S$a,"hide",function(){return this._hide},function(S$a){this._hide=S$a,this.visible=!S$a}),S$A(0,S$a,"touchScrollEnable",function(){return this._touchScrollEnable},function(S$a){this._touchScrollEnable=S$a,this.target=this._target}),S$A(0,S$a,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(S$a){this._mouseWheelEnable=S$a,this.target=this._target}),S$A(0,S$a,"tick",function(){return this.slider.tick},function(S$a){this.slider.tick=S$a}),S$s}(S$b),S$R=function(S$m){function S$s(S$a){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,S$s.__super.call(this),this.skin=S$a}S$e(S$s,"laya.ui.Slider",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._bg&&this._bg.destroy(S$a),this._bar&&this._bar.destroy(S$a),this._progress&&this._progress.destroy(S$a),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},S$a.createChildren=function(){this.addChild(this._bg=new S$F),this.addChild(this._bar=new S$X)},S$a.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},S$a.onBarMouseDown=function(S$a){this._globalSacle||(this._globalSacle=new S$q),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=S$h.stage.mouseX,this._ty=S$h.stage.mouseY,S$h.stage.on("mousemove",this,this.mouseMove),S$h.stage.once("mouseup",this,this.mouseUp),S$h.stage.once("mouseout",this,this.mouseUp),this.showValueText()},S$a.showValueText=function(){if(this.showLabel){var S$a=laya.ui.Slider.label;this.addChild(S$a),S$a.textField.changeText(this._value+""),this.isVertical?(S$a.x=this._bar.x+20,S$a.y=.5*(this._bar.height-S$a.height)+this._bar.y):(S$a.y=this._bar.y-20,S$a.x=.5*(this._bar.width-S$a.width)+this._bar.x)}},S$a.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},S$a.mouseUp=function(S$a){S$h.stage.off("mousemove",this,this.mouseMove),S$h.stage.off("mouseup",this,this.mouseUp),S$h.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},S$a.mouseMove=function(S$a){var S$m=this._value;this.isVertical?(this._bar.y+=(S$h.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(S$h.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=S$h.stage.mouseX,this._ty=S$h.stage.mouseY;var S$s=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*S$s)/S$s,this._value!=S$m&&this.sendChangeEvent(),this.showValueText()},S$a.sendChangeEvent=function(S$a){void 0===S$a&&(S$a="change"),this.event(S$a),this.changeHandler&&this.changeHandler.runWith(this._value)},S$a.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},S$a.changeSize=function(){S$m.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},S$a.setSlider=function(S$a,S$m,S$s){this._value=-1,this._min=S$a,this._max=S$a<S$m?S$m:S$a,this.value=S$s<S$a?S$a:S$m<S$s?S$m:S$s},S$a.changeValue=function(){var S$a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*S$a)/S$a,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var S$m=this._max-this._min;0===S$m&&(S$m=1),this.isVertical?(this._bar.y=(this._value-this._min)/S$m*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/S$m*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},S$a.onBgMouseDown=function(S$a){var S$m=this._bg.getMousePoint();this.isVertical?this.value=S$m.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=S$m.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},S$A(0,S$a,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),S$A(0,S$a,"skin",function(){return this._skin},function(S$a){if(this._skin!=S$a){this._skin=S$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var S$m=this._skin.replace(".png","$progress.png");S$p.getRes(S$m)&&(this._progress||(this.addChild(this._progress=new S$F),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=S$m),this.setBarPoint(),this.callLater(this.changeValue)}}),S$A(0,S$a,"allowClickBack",function(){return this._allowClickBack},function(S$a){this._allowClickBack!=S$a&&((this._allowClickBack=S$a)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),S$A(0,S$a,"max",function(){return this._max},function(S$a){this._max!=S$a&&(this._max=S$a,this.callLater(this.changeValue))}),S$A(0,S$a,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),S$A(0,S$a,"tick",function(){return this._tick},function(S$a){this._tick!=S$a&&(this._tick=S$a,this.callLater(this.changeValue))}),S$A(0,S$a,"sizeGrid",function(){return this._bg.sizeGrid},function(S$a){this._bg.sizeGrid=S$a,this._bar.sizeGrid=S$a,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),S$A(0,S$a,"min",function(){return this._min},function(S$a){this._min!=S$a&&(this._min=S$a,this.callLater(this.changeValue))}),S$A(0,S$a,"value",function(){return this._value},function(S$a){if(this._value!=S$a){var S$m=this._value;this._value=S$a,this.changeValue(),this._value!=S$m&&this.sendChangeEvent()}}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)||"string"==typeof S$a?this.value=Number(S$a):S$h.superSet(S$b,this,"dataSource",S$a)}),S$A(0,S$a,"bar",function(){return this._bar}),S$P(S$s,["label",function(){return this.label=new S$x}]),S$s}(S$b),S$F=function(S$m){function S$s(S$a){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,S$s.__super.call(this),this.skin=S$a}S$e(S$s,"laya.ui.Image",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,S$p.clearCache(this,this._skin)},S$a.dispose=function(){this.destroy(!0),S$p.clearCache(this,this._skin),this.clearEvent()},S$a.createChildren=function(){this.graphics=this._bitmap=new S$W},S$a.setSource=function(S$a,S$m){this.destroyed||S$a===this._skin&&S$m&&(this.source=S$m,this.onCompResize(),this.clearEvent())},S$a.clearEvent=function(){this._skin&&S$_.atalsNotify&&S$_.atalsNotify.off(this._skin,this,this.setSource)},S$a.clearLoad=function(){this._skin&&((this._complete||this._progress)&&S$h.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},S$A(0,S$a,"source",function(){return this._bitmap.source},function(S$a){this._bitmap&&(this._bitmap.source=S$a,this.event("loaded"),this.repaint())}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"string"==typeof(this._dataSource=S$a)?this.skin=S$a:S$h.superSet(S$b,this,"dataSource",S$a)}),S$A(0,S$a,"measureHeight",function(){return this._bitmap.height}),S$A(0,S$a,"skin",function(){return this._skin},function(S$a){if(this._skin!=S$a)if(S$p.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=S$a){S$p.keepCache(this,this._skin);var S$m=S$p.getRes(S$a),S$s=S$_.resAtalsObj&&S$_.resAtalsObj[this._skin];S$m?(this.source=S$m,this.onCompResize()):S$s?(S$_.atalsNotify&&S$_.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=S$s.sourceW),0==this.height&&(this.height=S$s.sourceH)):(this._complete=S$d.create(this,this.setSource,[this._skin]),this._progress=null,S$h.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),S$A(0,S$a,"group",function(){return this._group},function(S$a){S$a&&this._skin&&S$p.setGroup(this._skin,S$a),this._group=S$a}),S$A(0,S$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(S$a){this._bitmap.sizeGrid=S$K.fillArray(S$f.defaultSizeGrid,S$a,Number)}),S$A(0,S$a,"measureWidth",function(){return this._bitmap.width}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$b,this,"width",S$a),this._bitmap.width=0==S$a?1e-7:S$a}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$b,this,"height",S$a),this._bitmap.height=0==S$a?1e-7:S$a}),S$s}(S$b),S$x=function(S$m){function S$s(S$a){this._tf=null,S$s.__super.call(this),void 0===S$a&&(S$a=""),S$G.defaultColor=S$f.labelColor,this.text=S$a}S$e(S$s,"laya.ui.Label",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._tf=null},S$a.createChildren=function(){this.addChild(this._tf=new S$o)},S$a.changeText=function(S$a){this._tf.changeText(S$a)},S$A(0,S$a,"padding",function(){return this._tf.padding.join(",")},function(S$a){this._tf.padding=S$K.fillArray(S$f.labelPadding,S$a,Number)}),S$A(0,S$a,"bold",function(){return this._tf.bold},function(S$a){this._tf.bold=S$a}),S$A(0,S$a,"align",function(){return this._tf.align},function(S$a){this._tf.align=S$a}),S$A(0,S$a,"text",function(){return this._tf.text},function(S$a){this._tf.text!=S$a&&(S$a&&(S$a=S$K.adptString(S$a+"")),this._tf.text=S$a,this.event("change"),this._width&&this._height||this.onCompResize())}),S$A(0,S$a,"italic",function(){return this._tf.italic},function(S$a){this._tf.italic=S$a}),S$A(0,S$a,"wordWrap",function(){return this._tf.wordWrap},function(S$a){this._tf.wordWrap=S$a}),S$A(0,S$a,"font",function(){return this._tf.font},function(S$a){this._tf.font=S$a}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)||"string"==typeof S$a?this.text=S$a+"":S$h.superSet(S$b,this,"dataSource",S$a)}),S$A(0,S$a,"color",function(){return this._tf.color},function(S$a){this._tf.color=S$a}),S$A(0,S$a,"valign",function(){return this._tf.valign},function(S$a){this._tf.valign=S$a}),S$A(0,S$a,"leading",function(){return this._tf.leading},function(S$a){this._tf.leading=S$a}),S$A(0,S$a,"fontSize",function(){return this._tf.fontSize},function(S$a){this._tf.fontSize=S$a}),S$A(0,S$a,"bgColor",function(){return this._tf.bgColor},function(S$a){this._tf.bgColor=S$a}),S$A(0,S$a,"borderColor",function(){return this._tf.borderColor},function(S$a){this._tf.borderColor=S$a}),S$A(0,S$a,"stroke",function(){return this._tf.stroke},function(S$a){this._tf.stroke=S$a}),S$A(0,S$a,"strokeColor",function(){return this._tf.strokeColor},function(S$a){this._tf.strokeColor=S$a}),S$A(0,S$a,"textField",function(){return this._tf}),S$A(0,S$a,"measureWidth",function(){return this._tf.width}),S$A(0,S$a,"measureHeight",function(){return this._tf.height}),S$A(0,S$a,"width",function(){return this._width||this._tf.text?S$h.superGet(S$b,this,"width"):0},function(S$a){S$h.superSet(S$b,this,"width",S$a),this._tf.width=S$a}),S$A(0,S$a,"height",function(){return this._height||this._tf.text?S$h.superGet(S$b,this,"height"):0},function(S$a){S$h.superSet(S$b,this,"height",S$a),this._tf.height=S$a}),S$A(0,S$a,"overflow",function(){return this._tf.overflow},function(S$a){this._tf.overflow=S$a}),S$A(0,S$a,"underline",function(){return this._tf.underline},function(S$a){this._tf.underline=S$a}),S$A(0,S$a,"underlineColor",function(){return this._tf.underlineColor},function(S$a){this._tf.underlineColor=S$a}),S$s}(S$b),S$M=function(S$m){function S$s(S$a){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,S$s.__super.call(this),this.skin=S$a}S$e(S$s,"laya.ui.ProgressBar",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._bg&&this._bg.destroy(S$a),this._bar&&this._bar.destroy(S$a),this._bg=this._bar=null,this.changeHandler=null},S$a.createChildren=function(){this.addChild(this._bg=new S$F),this.addChild(this._bar=new S$F)},S$a.changeValue=function(){if(this.sizeGrid){var S$a=this.sizeGrid.split(","),S$m=Number(S$a[3]),S$s=Number(S$a[1]),S$P=(this.width-S$m-S$s)*this._value;this._bar.width=S$m+S$s+S$P,this._bar.visible=this._bar.width>S$m+S$s}else this._bar.width=this.width*this._value},S$A(0,S$a,"measureHeight",function(){return this._bg.height}),S$A(0,S$a,"skin",function(){return this._skin},function(S$a){this._skin!=S$a&&(this._skin=S$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),S$A(0,S$a,"measureWidth",function(){return this._bg.width}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$b,this,"height",S$a),this._bg.height=this._height,this._bar.height=this._height}),S$A(0,S$a,"bar",function(){return this._bar}),S$A(0,S$a,"value",function(){return this._value},function(S$a){this._value!=S$a&&(S$a=1<S$a?1:S$a<0?0:S$a,this._value=S$a,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(S$a))}),S$A(0,S$a,"bg",function(){return this._bg}),S$A(0,S$a,"sizeGrid",function(){return this._bg.sizeGrid},function(S$a){this._bg.sizeGrid=this._bar.sizeGrid=S$a}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$b,this,"width",S$a),this._bg.width=this._width,this.callLater(this.changeValue)}),S$A(0,S$a,"dataSource",S$m.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)||"string"==typeof S$a?this.value=Number(S$a):S$h.superSet(S$b,this,"dataSource",S$a)}),S$s}(S$b),S$J=(function(S$a){function S$s(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,S$s.__super.call(this),this._tipBox=new S$b,this._tipBox.addChild(this._tipText=new S$o),this._tipText.x=this._tipText.y=5,this._tipText.color=S$s.tipTextColor,this._defaultTipHandler=this._showDefaultTip,S$h.stage.on("showtip",this,this._onStageShowTip),S$h.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}S$e(S$s,"laya.ui.TipManager",S$b);var S$m=S$s.prototype;S$m._onStageHideTip=function(S$a){S$h.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},S$m._onStageShowTip=function(S$a){S$h.timer.once(S$s.tipDelay,this,this._showTip,[S$a],!0)},S$m._showTip=function(S$a){if("string"==typeof S$a){var S$m=String(S$a);Boolean(S$m)&&this._defaultTipHandler(S$m)}else S$a instanceof laya.utils.Handler?S$a.run():"function"==typeof S$a&&S$a.apply();S$h.stage.on("mousemove",this,this._onStageMouseMove),S$h.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},S$m._onStageMouseDown=function(S$a){this.closeAll()},S$m._onStageMouseMove=function(S$a){this._showToStage(this,S$s.offsetX,S$s.offsetY)},S$m._showToStage=function(S$a,S$m,S$s){void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0);var S$P=S$a.getBounds();S$a.x=S$h.stage.mouseX+S$m,S$a.y=S$h.stage.mouseY+S$s,S$a.x+S$P.width>S$h.stage.width&&(S$a.x-=S$P.width+S$m),S$a.y+S$P.height>S$h.stage.height&&(S$a.y-=S$P.height+S$s)},S$m.closeAll=function(){S$h.timer.clear(this,this._showTip),S$h.stage.off("mousemove",this,this._onStageMouseMove),S$h.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},S$m.showDislayTip=function(S$a){this.addChild(S$a),this._showToStage(this),S$h._currentStage.addChild(this)},S$m._showDefaultTip=function(S$a){this._tipText.text=S$a;var S$m=this._tipBox.graphics;S$m.clear(),S$m.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,S$s.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),S$h._currentStage.addChild(this)},S$A(0,S$m,"defaultTipHandler",function(){return this._defaultTipHandler},function(S$a){this._defaultTipHandler=S$a}),S$s.offsetX=10,S$s.offsetY=15,S$s.tipTextColor="#ffffff",S$s.tipBackColor="#111111",S$s.tipDelay=200}(),function(S$a){var S$Q;function S$q(){this._idMap=null,this._aniList=null,this._watchMap={},S$q.__super.call(this)}S$e(S$q,"laya.ui.View",S$Z);var S$m=S$q.prototype;return S$m.createView=function(S$a){if(S$a.animations&&!this._idMap&&(this._idMap={}),S$q.createComp(S$a,this,this),S$a.animations){var S$m,S$s,S$P=[],S$_=S$a.animations,S$e=0,S$A=S$_.length;for(S$e=0;S$e<S$A;S$e++){switch(S$m=new S$y,S$s=S$_[S$e],S$m._setUp(this._idMap,S$s),(this[S$s.name]=S$m)._setControlNode(this),S$s.action){case 1:S$m.play(0,!1);break;case 2:S$m.play(0,!0)}S$P.push(S$m)}this._aniList=S$P}0<this._width&&null==S$a.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},S$m.onEvent=function(S$a,S$m){},S$m.loadUI=function(S$a){var S$m=S$q.uiMap[S$a];S$m&&this.createView(S$m)},S$m.destroy=function(S$a){void 0===S$a&&(S$a=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,S$a)},S$m.changeData=function(S$a){var S$m=this._watchMap[S$a];if(S$m){console.log("change",S$a);for(var S$s=0,S$P=S$m.length;S$s<S$P;S$s++){S$m[S$s].exe(this)}}},S$q._regs=function(){for(var S$a in S$q.uiClassMap)S$u.regClass(S$a,S$q.uiClassMap[S$a])},S$q.createComp=function(S$a,S$m,S$s,S$P){if(!(S$m=S$m||S$q.getCompInstance(S$a)))return console.warn("can not create:"+S$a.type),null;var S$_=S$a.child;if(S$_)for(var S$e=S$m instanceof laya.ui.List,S$A=0,S$B=S$_.length;S$A<S$B;S$A++){var S$k=S$_[S$A];if(!S$m.hasOwnProperty("itemRender")||"render"!=S$k.props.name&&"render"!==S$k.props.renderType)if("Graphic"==S$k.type)S$u.addGraphicsToSprite(S$k,S$m);else if(S$u.isDrawType(S$k.type))S$u.addGraphicToSprite(S$k,S$m,!0);else{if(S$e){var S$j=[],S$G=S$q.createComp(S$k,null,S$s,S$j);S$j.length&&(S$G._$bindData=S$j)}else S$G=S$q.createComp(S$k,null,S$s,S$P);"Script"==S$k.type?"owner"in S$G?S$G.owner=S$m:"target"in S$G&&(S$G.target=S$m):"mask"==S$k.props.renderType||"mask"==S$k.props.name?S$m.mask=S$G:S$G instanceof laya.display.Sprite&&S$m.addChild(S$G)}else S$m.itemRender=S$k}var S$y=S$a.props;for(var S$d in S$y){var S$Q=S$y[S$d];S$q.eventDic[S$d]?S$Q&&S$s&&S$m.on(S$d,S$s,S$s.onEvent,[S$Q]):S$q.setCompValue(S$m,S$d,S$Q,S$s,S$P)}return S$h.__typeof(S$m,"laya.ui.IItem")&&S$m.initItems(),S$a.compId&&S$s&&S$s._idMap&&(S$s._idMap[S$a.compId]=S$m),S$m},S$q.setCompValue=function(S$a,S$m,S$s,S$P,S$_){if("string"==typeof S$s&&-1<S$s.indexOf("${")){if(S$q._sheet||(S$q._sheet=S$u.getClass("laya.data.Table")),!S$q._sheet)return void console.warn("Can not find class Sheet");if(S$_)S$_.push(S$a,S$m,S$s);else if(S$P){-1==S$s.indexOf("].")&&(S$s=S$s.replace(".","[0]."));var S$e,S$A,S$B=new S$Q(S$a,S$m,S$s);S$B.exe(S$P);for(var S$k=S$s.replace(/\[.*?\]\./g,".");null!=(S$e=S$q._parseWatchData.exec(S$k));){for(var S$j=S$e[1];null!=(S$A=S$q._parseKeyWord.exec(S$j));){var S$G=S$A[0],S$y=S$P._watchMap[S$G]||(S$P._watchMap[S$G]=[]);S$y.push(S$B),S$q._sheet.I.notifer.on(S$G,S$P,S$P.changeData,[S$G])}(S$y=S$P._watchMap[S$j]||(S$P._watchMap[S$j]=[])).push(S$B),S$q._sheet.I.notifer.on(S$j,S$P,S$P.changeData,[S$j])}}}else if("var"===S$m&&S$P)S$P[S$s]=S$a;else if("onClick"==S$m){var S$d=S$h._runScript("(function(){"+S$s+"})");S$a.on("click",S$P,S$d)}else S$a[S$m]="true"===S$s||"false"!==S$s&&S$s},S$q.getCompInstance=function(S$a){var S$m,S$s=S$a.props?S$a.props.runtime:null;return S$m=S$s?S$q.viewClassMap[S$s]||S$q.uiClassMap[S$s]||S$h.__classmap[S$s]:S$q.uiClassMap[S$a.type],S$a.props&&S$a.props.hasOwnProperty("renderType")&&"instance"==S$a.props.renderType?S$m.instance:S$m?new S$m:null},S$q.regComponent=function(S$a,S$m){S$q.uiClassMap[S$a]=S$m,S$u.regClass(S$a,S$m)},S$q.regViewRuntime=function(S$a,S$m){S$q.viewClassMap[S$a]=S$m},S$q.uiMap={},S$q.viewClassMap={},S$q._sheet=null,S$P(S$q,["uiClassMap",function(){return this.uiClassMap={ViewStack:S$aa,LinkButton:S$X,TextArea:S$ja,ColorPicker:S$i,Box:S$Z,Button:S$X,CheckBox:S$D,Clip:S$E,ComboBox:S$t,Component:S$b,HScrollBar:S$Y,HSlider:S$I,Image:S$F,Label:S$x,List:S$v,Panel:S$T,ProgressBar:S$M,Radio:S$n,RadioGroup:S$Ba,ScrollBar:S$L,Slider:S$R,Tab:S$ka,TextInput:S$sa,View:S$q,VScrollBar:S$ma,VSlider:S$Pa,Tree:S$r,HBox:S$ea,VBox:S$Aa,Sprite:S$H,Animation:S$s,Text:S$o,FontClip:S$w}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),S$q.__init$=function(){S$q._regs(),S$Q=function(){function S$a(S$a,S$m,S$s){this.comp=null,this.prop=null,this.value=null,this.comp=S$a,this.prop=S$m,this.value=S$s}return S$e(S$a,""),S$a.prototype.exe=function(S$a){var S$m=S$K.getBindFun(this.value);this.comp[this.prop]=S$m.call(this,S$a)},S$a}()},S$q}()),S$D=function(S$a){function S$s(S$a,S$m){void 0===S$m&&(S$m=""),S$s.__super.call(this,S$a,S$m)}S$e(S$s,"laya.ui.CheckBox",S$a);var S$m=S$s.prototype;return S$m.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},S$m.initialize=function(){S$a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},S$A(0,S$m,"dataSource",S$a.prototype._$get_dataSource,function(S$a){"boolean"==typeof(this._dataSource=S$a)?this.selected=S$a:"string"==typeof S$a?this.selected="true"===S$a:S$h.superSet(S$X,this,"dataSource",S$a)}),S$s}(S$X),S$g=function(S$a){function S$m(){this._space=0,this._align="none",this._itemChanged=!1,S$m.__super.call(this)}S$e(S$m,"laya.ui.LayoutBox",S$Z);var S$s=S$m.prototype;return S$s.addChild=function(S$a){return S$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,S$a)},S$s.onResize=function(S$a){this._setItemChanged()},S$s.addChildAt=function(S$a,S$m){return S$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,S$a,S$m)},S$s.removeChild=function(S$a){return S$a.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,S$a)},S$s.removeChildAt=function(S$a){return this.getChildAt(S$a).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,S$a)},S$s.refresh=function(){this._setItemChanged()},S$s.changeItems=function(){this._itemChanged=!1},S$s.sortItem=function(S$a){S$a&&S$a.sort(function(S$a,S$m){return S$a.y-S$m.y})},S$s._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},S$A(0,S$s,"space",function(){return this._space},function(S$a){this._space=S$a,this._setItemChanged()}),S$A(0,S$s,"align",function(){return this._align},function(S$a){this._align=S$a,this._setItemChanged()}),S$m}(),S$w=function(S$m){function S$s(S$a,S$m){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,S$s.__super.call(this),S$a&&(this.skin=S$a),S$m&&(this.sheet=S$m)}S$e(S$s,"laya.ui.FontClip",S$m);var S$a=S$s.prototype;return S$a.createChildren=function(){this._bitmap=new S$W,this.on("loaded",this,this._onClipLoaded)},S$a._onClipLoaded=function(){this.callLater(this.changeValue)},S$a.changeValue=function(){var S$a;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),S$a=this._sources[0]))){var S$m="horizontal"===this._direction;S$m?(this._wordsW=this._valueArr.length*(S$a.sourceWidth+this.spaceX),this._wordsH=S$a.sourceHeight):(this._wordsW=S$a.sourceWidth,this._wordsH=(S$a.sourceHeight+this.spaceY)*this._valueArr.length);var S$s=0;if(this._width)switch(this._align){case"center":S$s=.5*(this._width-this._wordsW);break;case"right":S$s=this._width-this._wordsW;break;default:S$s=0}for(var S$P=0,S$_=this._valueArr.length;S$P<S$_;S$P++){var S$e=this._indexMap[this._valueArr.charAt(S$P)];this.sources[S$e]&&(S$a=this.sources[S$e],S$m?this.graphics.drawTexture(S$a,S$s+S$P*(S$a.sourceWidth+this.spaceX),0,S$a.sourceWidth,S$a.sourceHeight):this.graphics.drawTexture(S$a,0+S$s,S$P*(S$a.sourceHeight+this.spaceY),S$a.sourceWidth,S$a.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),S$m.prototype.destroy.call(this,S$a)},S$A(0,S$a,"sheet",function(){return this._sheet},function(S$a){S$a+="";var S$m=(this._sheet=S$a).split(" ");this._clipX=String(S$m[0]).length,this.clipY=S$m.length,this._indexMap={};for(var S$s=0;S$s<this._clipY;S$s++)for(var S$P=S$m[S$s].split(""),S$_=0,S$e=S$P.length;S$_<S$e;S$_++)this._indexMap[S$P[S$_]]=S$s*this._clipX+S$_}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$E,this,"height",S$a),this.callLater(this.changeValue)}),S$A(0,S$a,"direction",function(){return this._direction},function(S$a){this._direction=S$a,this.callLater(this.changeValue)}),S$A(0,S$a,"value",function(){return this._valueArr?this._valueArr:""},function(S$a){S$a+="",this._valueArr=S$a,this.callLater(this.changeValue)}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$E,this,"width",S$a),this.callLater(this.changeValue)}),S$A(0,S$a,"spaceX",function(){return this._spaceX},function(S$a){this._spaceX=S$a,"horizontal"===this._direction&&this.callLater(this.changeValue)}),S$A(0,S$a,"spaceY",function(){return this._spaceY},function(S$a){this._spaceY=S$a,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),S$A(0,S$a,"align",function(){return this._align},function(S$a){this._align=S$a,this.callLater(this.changeValue)}),S$A(0,S$a,"measureWidth",function(){return this._wordsW}),S$A(0,S$a,"measureHeight",function(){return this._wordsH}),S$s}(S$E),S$v=function(S$a){function S$m(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new S$q,S$m.__super.call(this)}S$e(S$m,"laya.ui.List",S$a);var S$s=S$m.prototype;return S$h.imps(S$s,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),S$s.destroy=function(S$a){void 0===S$a&&(S$a=!0),this._content&&this._content.destroy(S$a),this._scrollBar&&this._scrollBar.destroy(S$a),laya.ui.Component.prototype.destroy.call(this,S$a),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},S$s.createChildren=function(){this.addChild(this._content=new S$Z)},S$s.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=S$h.superGet(S$Z,this,"cacheAs")),S$h.superSet(S$Z,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},S$s.onScrollEnd=function(){S$h.superSet(S$Z,this,"cacheAs",this._$P.cacheAs)},S$s._removePreScrollBar=function(){var S$a=this.removeChildByName("scrollBar");S$a&&S$a.destroy(!0)},S$s.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var S$a=this._getOneCell(),S$m=S$a.width+this._spaceX||1,S$s=S$a.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/S$m):Math.ceil(this._width/S$m)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/S$s):Math.round(this._height/S$s));var S$P=this._width?this._width:S$m*this.repeatX-this._spaceX,S$_=this._height?this._height:S$s*this.repeatY-this._spaceY;this._cellSize=this._isVertical?S$s:S$m,this._cellOffset=this._isVertical?S$s*Math.max(this._repeatY2,this._repeatY)-S$_-this._spaceY:S$m*Math.max(this._repeatX2,this._repeatX)-S$P-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=S$_:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=S$P),this.setContentSize(S$P,S$_);var S$e=this._isVertical?this.repeatX:this.repeatY,S$A=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,S$e,S$A),this._createdLine=S$A,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},S$s._getOneCell=function(){if(0===this._cells.length){var S$a=this.createItem();if(this._offset.setTo(S$a.x,S$a.y),this.cacheContent)return S$a;this._cells.push(S$a)}return this._cells[0]},S$s._createItems=function(S$a,S$m,S$s){var S$P=this._content,S$_=this._getOneCell(),S$e=S$_.width+this._spaceX,S$A=S$_.height+this._spaceY;if(this.cacheContent){var S$B=new S$Z;S$B.cacheAsBitmap=!0,S$B.pos((this._isVertical?0:S$a)*S$e,(this._isVertical?S$a:0)*S$A),this._content.addChild(S$B),this._content.optimizeScrollRect=!0,S$P=S$B}else{for(var S$k=[],S$j=this._cells.length-1;-1<S$j;S$j--){var S$G=this._cells[S$j];S$G.removeSelf(),S$k.push(S$G)}this._cells.length=0}for(var S$y=S$a;S$y<S$s;S$y++)for(var S$d=0;S$d<S$m;S$d++)(S$_=S$k&&S$k.length?S$k.pop():this.createItem()).x=(this._isVertical?S$d:S$y)*S$e-S$P.x,S$_.y=(this._isVertical?S$y:S$d)*S$A-S$P.y,S$_.name="item"+(S$y*S$m+S$d),S$P.addChild(S$_),this.addCell(S$_)},S$s.createItem=function(){var S$a=[];if("function"==typeof this._itemRender)var S$m=new this._itemRender;else S$m=S$J.createComp(this._itemRender,null,null,S$a);if(0==S$a.length&&S$m._watchMap){var S$s=S$m._watchMap;for(var S$P in S$s)for(var S$_=S$s[S$P],S$e=0;S$e<S$_.length;S$e++){var S$A=S$_[S$e];S$a.push(S$A.comp,S$A.prop,S$A.value)}}return S$a.length&&(S$m._$bindData=S$a),S$m},S$s.addCell=function(S$a){S$a.on("click",this,this.onCellMouse),S$a.on("rightclick",this,this.onCellMouse),S$a.on("mouseover",this,this.onCellMouse),S$a.on("mouseout",this,this.onCellMouse),S$a.on("mousedown",this,this.onCellMouse),S$a.on("mouseup",this,this.onCellMouse),this._cells.push(S$a)},S$s.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var S$a=0,S$m=S$a=0;S$m<1e4;S$m++){var S$s=this.getChildByName("item"+S$m);if(!S$s)break;this.addCell(S$s),S$a++}this.repeatY=S$a}},S$s.setContentSize=function(S$a,S$m){this._content.width=S$a,this._content.height=S$m,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new S$O),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,S$a,S$m),this._content.scrollRect=this._content.scrollRect),this.event("resize")},S$s.onCellMouse=function(S$a){"mousedown"===S$a.type&&(this._isMoved=!1);var S$m=S$a.currentTarget,S$s=this._startIndex+this._cells.indexOf(S$m);S$s<0||("click"===S$a.type||"rightclick"===S$a.type?this.selectEnable&&!this._isMoved?this.selectedIndex=S$s:this.changeCellState(S$m,!0,0):"mouseover"!==S$a.type&&"mouseout"!==S$a.type||this._selectedIndex===S$s||this.changeCellState(S$m,"mouseover"===S$a.type,0),this.mouseHandler&&this.mouseHandler.runWith([S$a,S$s]))},S$s.changeCellState=function(S$a,S$m,S$s){var S$P=S$a.getChildByName("selectBox");S$P&&(this.selectEnable=!0,S$P.visible=S$m,S$P.index=S$s)},S$s.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},S$s.onScrollBarChange=function(S$a){this.runCallLater(this.changeCells);var S$m=this._scrollBar.value,S$s=this._isVertical?this.repeatX:this.repeatY,S$P=this._isVertical?this.repeatY:this.repeatX,S$_=Math.floor(S$m/this._cellSize);if(this.cacheContent)S$A=S$P+1,this._createdLine-S$_<S$A&&(this._createItems(this._createdLine,S$s,this._createdLine+S$A),this.renderItems(this._createdLine*S$s,0),this._createdLine+=S$A);else{var S$e=S$_*S$s,S$A=0;if(S$e>this._startIndex){S$A=S$e-this._startIndex;var S$B=!0,S$k=this._startIndex+S$s*(S$P+1);this._isMoved=!0}else S$e<this._startIndex&&(S$A=this._startIndex-S$e,S$B=!1,S$k=this._startIndex-1,this._isMoved=!0);for(var S$j=0;S$j<S$A;S$j++){if(S$B){var S$G=this._cells.shift();this._cells[this._cells.length]=S$G;var S$y=S$k+S$j}else S$G=this._cells.pop(),this._cells.unshift(S$G),S$y=S$k-S$j;var S$d=Math.floor(S$y/S$s)*this._cellSize;this._isVertical?S$G.y=S$d:S$G.x=S$d,this.renderItem(S$G,S$y)}this._startIndex=S$e,this.changeSelectStatus()}var S$Q=this._content.scrollRect;this._isVertical?(S$Q.y=S$m-this._offset.y,S$Q.x=-this._offset.x):(S$Q.y=-this._offset.y,S$Q.x=S$m-this._offset.x),this._content.scrollRect=S$Q},S$s.posCell=function(S$a,S$m){if(this._scrollBar){var S$s=this._isVertical?this.repeatX:this.repeatY,S$P=(this._isVertical?this.repeatY:this.repeatX,Math.floor(S$m/S$s)*this._cellSize);this._isVertical?S$a.y=S$P:S$a.x=S$P}},S$s.changeSelectStatus=function(){for(var S$a=0,S$m=this._cells.length;S$a<S$m;S$a++)this.changeCellState(this._cells[S$a],this._selectedIndex===this._startIndex+S$a,1)},S$s.renderItems=function(S$a,S$m){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0);for(var S$s=S$a,S$P=S$m||this._cells.length;S$s<S$P;S$s++)this.renderItem(this._cells[S$s],this._startIndex+S$s);this.changeSelectStatus(),this._twDone=!0},S$s.renderItem=function(S$a,S$m){this._array&&0<=S$m&&S$m<this._array.length?(S$a.visible=!0,S$a._$bindData?(S$a._dataSource=this._array[S$m],this._bindData(S$a,this._array[S$m])):S$a.dataSource=this._array[S$m],this.cacheContent||this.posCell(S$a,S$m),this.hasListener("render")&&this.event("render",[S$a,S$m]),this.renderHandler&&this.renderHandler.runWith([S$a,S$m]),this.renderTwHandler&&this.renderTwHandler.runWith([S$a,S$m])):(S$a.visible=!1,S$a.dataSource=null)},S$s._bindData=function(S$a,S$m){for(var S$s=S$a._$bindData,S$P=0,S$_=S$s.length;S$P<S$_;S$P++){var S$e=S$s[S$P++],S$A=S$s[S$P++],S$B=S$s[S$P],S$k=S$K.getBindFun(S$B);S$e[S$A]=S$k.call(this,S$m)}},S$s.refresh=function(){this.array=this._array},S$s.getItem=function(S$a){return-1<S$a&&S$a<this._array.length?this._array[S$a]:null},S$s.changeItem=function(S$a,S$m){-1<S$a&&S$a<this._array.length&&(this._array[S$a]=S$m,S$a>=this._startIndex&&S$a<this._startIndex+this._cells.length&&this.renderItem(this.getCell(S$a),S$a))},S$s.setItem=function(S$a,S$m){this.changeItem(S$a,S$m)},S$s.addItem=function(S$a){this._array.push(S$a),this.array=this._array},S$s.addItemAt=function(S$a,S$m){this._array.splice(S$m,0,S$a),this.array=this._array},S$s.deleteItem=function(S$a){this._array.splice(S$a,1),this.array=this._array},S$s.getCell=function(S$a){return this.runCallLater(this.changeCells),-1<S$a&&this._cells?this._cells[(S$a-this._startIndex)%this._cells.length]:null},S$s.scrollTo=function(S$a){if(this._scrollBar){var S$m=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(S$a/S$m)*this._cellSize}else this.startIndex=S$a},S$s.tweenTo=function(S$a,S$m,S$s){if(void 0===S$m&&(S$m=200),this._scrollBar){var S$P=this._isVertical?this.repeatX:this.repeatY;S$z.to(this._scrollBar,{value:Math.floor(S$a/S$P)*this._cellSize},S$m,null,S$s,0,!0)}else this.startIndex=S$a,S$s&&S$s.run()},S$s._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},S$s.commitMeasure=function(){this.runCallLater(this.changeCells)},S$A(0,S$s,"cacheAs",S$a.prototype._$get_cacheAs,function(S$a){S$h.superSet(S$Z,this,"cacheAs",S$a),this._scrollBar&&(this._$P.cacheAs=null,"none"!==S$a?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),S$A(0,S$s,"content",function(){return this._content}),S$A(0,S$s,"height",S$a.prototype._$get_height,function(S$a){S$a!=this._height&&(S$h.superSet(S$Z,this,"height",S$a),this._setCellChanged())}),S$A(0,S$s,"itemRender",function(){return this._itemRender},function(S$a){if(this._itemRender!=S$a){this._itemRender=S$a;for(var S$m=this._cells.length-1;-1<S$m;S$m--)this._cells[S$m].destroy();this._cells.length=0,this._setCellChanged()}}),S$A(0,S$s,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(S$a){this._removePreScrollBar();var S$m=new S$ma;S$m.name="scrollBar",S$m.right=0,S$a&&" "!=S$a&&(S$m.skin=S$a),this.scrollBar=S$m,this.addChild(S$m),this._setCellChanged()}),S$A(0,S$s,"page",function(){return this._page},function(S$a){this._page=S$a,this._array&&(this._page=0<S$a?S$a:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),S$A(0,S$s,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(S$a){this._removePreScrollBar();var S$m=new S$Y;S$m.name="scrollBar",S$m.bottom=0,S$a&&" "!=S$a&&(S$m.skin=S$a),this.scrollBar=S$m,this.addChild(S$m),this._setCellChanged()}),S$A(0,S$s,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(S$a){this._repeatX=S$a,this._setCellChanged()}),S$A(0,S$s,"scrollBar",function(){return this._scrollBar},function(S$a){this._scrollBar!=S$a&&(this._scrollBar=S$a)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),S$A(0,S$s,"width",S$a.prototype._$get_width,function(S$a){S$a!=this._width&&(S$h.superSet(S$Z,this,"width",S$a),this._setCellChanged())}),S$A(0,S$s,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(S$a){this._repeatY=S$a,this._setCellChanged()}),S$A(0,S$s,"spaceX",function(){return this._spaceX},function(S$a){this._spaceX=S$a,this._setCellChanged()}),S$A(0,S$s,"spaceY",function(){return this._spaceY},function(S$a){this._spaceY=S$a,this._setCellChanged()}),S$A(0,S$s,"selectedIndex",function(){return this._selectedIndex},function(S$a){this._selectedIndex!=S$a&&(this._selectedIndex=S$a,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(S$a),this.startIndex=this._startIndex)}),S$A(0,S$s,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(S$a){this.selectedIndex=this._array.indexOf(S$a)}),S$A(0,S$s,"length",function(){return this._array?this._array.length:0}),S$A(0,S$s,"selection",function(){return this.getCell(this._selectedIndex)},function(S$a){this.selectedIndex=this._startIndex+this._cells.indexOf(S$a)}),S$A(0,S$s,"startIndex",function(){return this._startIndex},function(S$a){this._startIndex=0<S$a?S$a:0,this.callLater(this.renderItems)}),S$A(0,S$s,"twSwitch",function(){return this._twSwitch},function(S$a){this._twSwitch=S$a}),S$A(0,S$s,"twDone",function(){return this._twDone},function(S$a){this._twDone=S$a}),S$A(0,S$s,"array",function(){return this._array},function(S$a){this.runCallLater(this.changeCells),this._array=S$a||[];var S$m=this._array.length;if(this.totalPage=Math.ceil(S$m/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<S$m?this._selectedIndex:S$m-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var S$s=this._isVertical?this.repeatX:this.repeatY,S$P=this._isVertical?this.repeatY:this.repeatX,S$_=Math.ceil(S$m/S$s);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=S$P/S$_,this._scrollBar.setScroll(0,(S$_-S$P)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),S$A(0,S$s,"dataSource",S$a.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)&&Math.floor(S$a)==S$a||"string"==typeof S$a?this.selectedIndex=parseInt(S$a):S$a instanceof Array?this.array=S$a:S$h.superSet(S$Z,this,"dataSource",S$a)}),S$A(0,S$s,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),S$m}(S$Z),S$Y=function(S$a){function S$m(){S$m.__super.call(this)}return S$e(S$m,"laya.ui.HScrollBar",S$a),S$m.prototype.initialize=function(){S$a.prototype.initialize.call(this),this.slider.isVertical=!1},S$m}(S$L),S$T=function(S$a){function S$m(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,S$m.__super.call(this),this.width=this.height=100}S$e(S$m,"laya.ui.Panel",S$a);var S$s=S$m.prototype;return S$s.destroy=function(S$a){void 0===S$a&&(S$a=!0),laya.ui.Component.prototype.destroy.call(this,S$a),this._content&&this._content.destroy(S$a),this._vScrollBar&&this._vScrollBar.destroy(S$a),this._hScrollBar&&this._hScrollBar.destroy(S$a),this._vScrollBar=null,this._hScrollBar=null,this._content=null},S$s.destroyChildren=function(){this._content.destroyChildren()},S$s.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new S$Z)},S$s.addChild=function(S$a){return S$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(S$a)},S$s.onResize=function(){this._setScrollChanged()},S$s.addChildAt=function(S$a,S$m){return S$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(S$a,S$m)},S$s.removeChild=function(S$a){return S$a.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(S$a)},S$s.removeChildAt=function(S$a){return this.getChildAt(S$a).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(S$a)},S$s.removeChildren=function(S$a,S$m){return void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=2147483647),this._content.removeChildren(S$a,S$m),this._setScrollChanged(),this},S$s.getChildAt=function(S$a){return this._content.getChildAt(S$a)},S$s.getChildByName=function(S$a){return this._content.getChildByName(S$a)},S$s.getChildIndex=function(S$a){return this._content.getChildIndex(S$a)},S$s.changeScroll=function(){this._scrollChanged=!1;var S$a=this.contentWidth||1,S$m=this.contentHeight||1,S$s=this._vScrollBar,S$P=this._hScrollBar,S$_=S$s&&S$m>this._height,S$e=S$P&&S$a>this._width,S$A=S$_?this._width-S$s.width:this._width,S$B=S$e?this._height-S$P.height:this._height;S$s&&(S$s.x=this._width-S$s.width,S$s.y=0,S$s.height=this._height-(S$e?S$P.height:0),S$s.scrollSize=Math.max(.033*this._height,1),S$s.thumbPercent=S$B/S$m,S$s.setScroll(0,S$m-S$B,S$s.value)),S$P&&(S$P.x=0,S$P.y=this._height-S$P.height,S$P.width=this._width-(S$_?S$s.width:0),S$P.scrollSize=Math.max(.033*this._width,1),S$P.thumbPercent=S$A/S$a,S$P.setScroll(0,S$a-S$A,S$P.value))},S$s.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},S$s.setContentSize=function(S$a,S$m){var S$s=this._content;S$s.width=S$a,S$s.height=S$m,S$s.scrollRect||(S$s.scrollRect=new S$O),S$s.scrollRect.setTo(0,0,S$a,S$m),S$s.scrollRect=S$s.scrollRect},S$s.onScrollBarChange=function(S$a){var S$m=this._content.scrollRect;if(S$m){var S$s=Math.round(S$a.value);S$a.isVertical?S$m.y=S$s:S$m.x=S$s,this._content.scrollRect=S$m}},S$s.scrollTo=function(S$a,S$m){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),this.vScrollBar&&(this.vScrollBar.value=S$m),this.hScrollBar&&(this.hScrollBar.value=S$a)},S$s.refresh=function(){this.changeScroll()},S$s.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=S$h.superGet(S$Z,this,"cacheAs")),S$h.superSet(S$Z,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},S$s.onScrollEnd=function(){S$h.superSet(S$Z,this,"cacheAs",this._$P.cacheAs)},S$s._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},S$A(0,S$s,"numChildren",function(){return this._content.numChildren}),S$A(0,S$s,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(S$a){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new S$Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=S$a}),S$A(0,S$s,"contentWidth",function(){for(var S$a=0,S$m=this._content.numChildren-1;-1<S$m;S$m--){var S$s=this._content.getChildAt(S$m);S$a=Math.max(S$s.x+S$s.width*S$s.scaleX,S$a)}return S$a}),S$A(0,S$s,"contentHeight",function(){for(var S$a=0,S$m=this._content.numChildren-1;-1<S$m;S$m--){var S$s=this._content.getChildAt(S$m);S$a=Math.max(S$s.y+S$s.height*S$s.scaleY,S$a)}return S$a}),S$A(0,S$s,"width",S$a.prototype._$get_width,function(S$a){S$h.superSet(S$Z,this,"width",S$a),this._setScrollChanged()}),S$A(0,S$s,"hScrollBar",function(){return this._hScrollBar}),S$A(0,S$s,"content",function(){return this._content}),S$A(0,S$s,"height",S$a.prototype._$get_height,function(S$a){S$h.superSet(S$Z,this,"height",S$a),this._setScrollChanged()}),S$A(0,S$s,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(S$a){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new S$ma),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=S$a}),S$A(0,S$s,"vScrollBar",function(){return this._vScrollBar}),S$A(0,S$s,"cacheAs",S$a.prototype._$get_cacheAs,function(S$a){S$h.superSet(S$Z,this,"cacheAs",S$a),this._$P.cacheAs=null,"none"!==S$a?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),S$m}(S$Z),S$I=function(S$a){function S$m(S$a){S$m.__super.call(this,S$a),this.isVertical=!1}return S$e(S$m,"laya.ui.HSlider",S$R),S$m}(),S$$=function(S$a){function S$s(S$a,S$m){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,S$s.__super.call(this),this.skin=S$m,this.labels=S$a}S$e(S$s,"laya.ui.UIGroup",S$a);var S$m=S$s.prototype;return S$h.imps(S$m,{"laya.ui.IItem":!0}),S$m.preinitialize=function(){this.mouseEnabled=!0},S$m.destroy=function(S$a){void 0===S$a&&(S$a=!0),laya.ui.Component.prototype.destroy.call(this,S$a),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},S$m.addItem=function(S$a,S$m){void 0===S$m&&(S$m=!0);var S$s=S$a,S$P=this._items.length;if(S$s.name="item"+S$P,this.addChild(S$s),this.initItems(),S$m&&0<S$P){var S$_=this._items[S$P-1];"horizontal"==this._direction?S$s.x=S$_.x+S$_.width+this._space:S$s.y=S$_.y+S$_.height+this._space}else S$m&&(S$s.x=0,S$s.y=0);return S$P},S$m.delItem=function(S$a,S$m){void 0===S$m&&(S$m=!0);var S$s=this._items.indexOf(S$a);if(-1!=S$s){var S$P=S$a;this.removeChild(S$P);for(var S$_=S$s+1,S$e=this._items.length;S$_<S$e;S$_++){var S$A=this._items[S$_];S$A.name="item"+(S$_-1),S$m&&("horizontal"==this._direction?S$A.x-=S$P.width+this._space:S$A.y-=S$P.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var S$B;S$B=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=S$B}}},S$m.initItems=function(){this._items||(this._items=[]);for(var S$a=this._items.length=0;S$a<1e4;S$a++){var S$m=this.getChildByName("item"+S$a);if(null==S$m)break;this._items.push(S$m),S$m.selected=S$a===this._selectedIndex,S$m.clickHandler=S$d.create(this,this.itemClick,[S$a],!1)}},S$m.itemClick=function(S$a){this.selectedIndex=S$a},S$m.setSelect=function(S$a,S$m){this._items&&-1<S$a&&S$a<this._items.length&&(this._items[S$a].selected=S$m)},S$m.createItem=function(S$a,S$m){return null},S$m.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var S$a=0,S$m=0,S$s=this._items.length;S$m<S$s;S$m++){var S$P=this._items[S$m];this._skin&&(S$P.skin=this._skin),this._labelColors&&(S$P.labelColors=this._labelColors),this._labelSize&&(S$P.labelSize=this._labelSize),this._labelStroke&&(S$P.labelStroke=this._labelStroke),this._labelStrokeColor&&(S$P.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(S$P.strokeColors=this._strokeColors),this._labelBold&&(S$P.labelBold=this._labelBold),this._labelPadding&&(S$P.labelPadding=this._labelPadding),this._labelAlign&&(S$P.labelAlign=this._labelAlign),this._stateNum&&(S$P.stateNum=this._stateNum),this._labelFont&&(S$P.labelFont=this._labelFont),"horizontal"===this._direction?(S$P.y=0,S$P.x=S$a,S$a+=S$P.width+this._space):(S$P.x=0,S$P.y=S$a,S$a+=S$P.height+this._space)}this.changeSize()},S$m.commitMeasure=function(){this.runCallLater(this.changeLabels)},S$m._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},S$A(0,S$m,"labelStrokeColor",function(){return this._labelStrokeColor},function(S$a){this._labelStrokeColor!=S$a&&(this._labelStrokeColor=S$a,this._setLabelChanged())}),S$A(0,S$m,"skin",function(){return this._skin},function(S$a){this._skin!=S$a&&(this._skin=S$a,this._setLabelChanged())}),S$A(0,S$m,"selectedIndex",function(){return this._selectedIndex},function(S$a){this._selectedIndex!=S$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=S$a,this.setSelect(S$a,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),S$A(0,S$m,"labels",function(){return this._labels},function(S$a){if(this._labels!=S$a){if(this._labels=S$a,this.removeChildren(),this._setLabelChanged(),this._labels)for(var S$m=this._labels.split(","),S$s=0,S$P=S$m.length;S$s<S$P;S$s++){var S$_=this.createItem(this._skin,S$m[S$s]);S$_.name="item"+S$s,this.addChild(S$_)}this.initItems()}}),S$A(0,S$m,"strokeColors",function(){return this._strokeColors},function(S$a){this._strokeColors!=S$a&&(this._strokeColors=S$a,this._setLabelChanged())}),S$A(0,S$m,"labelColors",function(){return this._labelColors},function(S$a){this._labelColors!=S$a&&(this._labelColors=S$a,this._setLabelChanged())}),S$A(0,S$m,"labelStroke",function(){return this._labelStroke},function(S$a){this._labelStroke!=S$a&&(this._labelStroke=S$a,this._setLabelChanged())}),S$A(0,S$m,"labelSize",function(){return this._labelSize},function(S$a){this._labelSize!=S$a&&(this._labelSize=S$a,this._setLabelChanged())}),S$A(0,S$m,"stateNum",function(){return this._stateNum},function(S$a){this._stateNum!=S$a&&(this._stateNum=S$a,this._setLabelChanged())}),S$A(0,S$m,"labelBold",function(){return this._labelBold},function(S$a){this._labelBold!=S$a&&(this._labelBold=S$a,this._setLabelChanged())}),S$A(0,S$m,"labelFont",function(){return this._labelFont},function(S$a){this._labelFont!=S$a&&(this._labelFont=S$a,this._setLabelChanged())}),S$A(0,S$m,"labelPadding",function(){return this._labelPadding},function(S$a){this._labelPadding!=S$a&&(this._labelPadding=S$a,this._setLabelChanged())}),S$A(0,S$m,"direction",function(){return this._direction},function(S$a){this._direction=S$a,this._setLabelChanged()}),S$A(0,S$m,"space",function(){return this._space},function(S$a){this._space=S$a,this._setLabelChanged()}),S$A(0,S$m,"items",function(){return this._items}),S$A(0,S$m,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(S$a){this.selectedIndex=this._items.indexOf(S$a)}),S$A(0,S$m,"dataSource",S$a.prototype._$get_dataSource,function(S$a){"number"==typeof(this._dataSource=S$a)&&Math.floor(S$a)==S$a||"string"==typeof S$a?this.selectedIndex=parseInt(S$a):S$a instanceof Array?this.labels=S$a.join(","):S$h.superSet(S$Z,this,"dataSource",S$a)}),S$s}(S$Z),S$n=function(S$m){function S$s(S$a,S$m){this._value=null,void 0===S$m&&(S$m=""),S$s.__super.call(this,S$a,S$m)}S$e(S$s,"laya.ui.Radio",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._value=null},S$a.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},S$a.initialize=function(){S$m.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},S$a.onClick=function(S$a){this.selected=!0},S$A(0,S$a,"value",function(){return null!=this._value?this._value:this.label},function(S$a){this._value=S$a}),S$s}(S$X),S$r=function(S$a){function S$m(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,S$m.__super.call(this),this.width=this.height=200}S$e(S$m,"laya.ui.Tree",S$a);var S$s=S$m.prototype;return S$h.imps(S$s,{"laya.ui.IRender":!0}),S$s.destroy=function(S$a){void 0===S$a&&(S$a=!0),laya.ui.Component.prototype.destroy.call(this,S$a),this._list&&this._list.destroy(S$a),this._list=null,this._source=null,this._renderHandler=null},S$s.createChildren=function(){this.addChild(this._list=new S$v),this._list.renderHandler=S$d.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},S$s.onListChange=function(S$a){this.event("change")},S$s.getArray=function(){var S$a,S$m=[];for(var S$s in this._source)S$a=this._source[S$s],this.getParentOpenStatus(S$a)&&(S$a.x=this._spaceLeft*this.getDepth(S$a),S$m.push(S$a));return S$m},S$s.getDepth=function(S$a,S$m){return void 0===S$m&&(S$m=0),null==S$a.nodeParent?S$m:this.getDepth(S$a.nodeParent,S$m+1)},S$s.getParentOpenStatus=function(S$a){var S$m=S$a.nodeParent;return null==S$m||!!S$m.isOpen&&(null==S$m.nodeParent||this.getParentOpenStatus(S$m))},S$s.renderItem=function(S$a,S$m){var S$s=S$a.dataSource;if(S$s){S$a.left=S$s.x;var S$P=S$a.getChildByName("arrow");S$P&&(S$s.hasChild?(S$P.visible=!0,S$P.index=S$s.isOpen?1:0,S$P.tag=S$m,S$P.off("click",this,this.onArrowClick),S$P.on("click",this,this.onArrowClick)):S$P.visible=!1);var S$_=S$a.getChildByName("folder");S$_&&(2==S$_.clipY?S$_.index=S$s.isDirectory?0:1:S$_.index=S$s.isDirectory?S$s.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([S$a,S$m])}},S$s.onArrowClick=function(S$a){var S$m=S$a.currentTarget.tag;this._list.array[S$m].isOpen=!this._list.array[S$m].isOpen,this.event("open"),this._list.array=this.getArray()},S$s.setItemState=function(S$a,S$m){this._list.array[S$a]&&(this._list.array[S$a].isOpen=S$m,this._list.array=this.getArray())},S$s.fresh=function(){this._list.array=this.getArray(),this.repaint()},S$s.parseXml=function(S$a,S$m,S$s,S$P){var S$_,S$e=S$a.childNodes,S$A=S$e.length;if(!S$P){S$_={};var S$B,S$k=S$a.attributes;for(var S$j in S$k){var S$G=(S$B=S$k[S$j]).nodeName,S$y=S$B.nodeValue;S$_[S$G]="true"==S$y||"false"!=S$y&&S$y}S$_.nodeParent=S$s,0<S$A&&(S$_.isDirectory=!0),S$_.hasChild=0<S$A,S$m.push(S$_)}for(var S$d=0;S$d<S$A;S$d++){var S$Q=S$e[S$d];this.parseXml(S$Q,S$m,S$_,!1)}},S$s.parseOpenStatus=function(S$a,S$m){for(var S$s=0,S$P=S$m.length;S$s<S$P;S$s++){var S$_=S$m[S$s];if(S$_.isDirectory)for(var S$e=0,S$A=S$a.length;S$e<S$A;S$e++){var S$B=S$a[S$e];if(S$B.isDirectory&&this.isSameParent(S$B,S$_)&&S$_.label==S$B.label){S$_.isOpen=S$B.isOpen;break}}}},S$s.isSameParent=function(S$a,S$m){return null==S$a.nodeParent&&null==S$m.nodeParent||null!=S$a.nodeParent&&null!=S$m.nodeParent&&(S$a.nodeParent.label==S$m.nodeParent.label&&this.isSameParent(S$a.nodeParent,S$m.nodeParent))},S$s.filter=function(S$a){if(Boolean(S$a)){var S$m=[];this.getFilterSource(this._source,S$m,S$a),this._list.array=S$m}else this._list.array=this.getArray()},S$s.getFilterSource=function(S$a,S$m,S$s){var S$P;for(var S$_ in S$s=S$s.toLocaleLowerCase(),S$a)!(S$P=S$a[S$_]).isDirectory&&-1<String(S$P.label).toLowerCase().indexOf(S$s)&&(S$P.x=0,S$m.push(S$P)),S$P.child&&0<S$P.child.length&&this.getFilterSource(S$P.child,S$m,S$s)},S$A(0,S$s,"spaceBottom",function(){return this._list.spaceY},function(S$a){this._list.spaceY=S$a}),S$A(0,S$s,"keepStatus",function(){return this._keepStatus},function(S$a){this._keepStatus=S$a}),S$A(0,S$s,"itemRender",function(){return this._list.itemRender},function(S$a){this._list.itemRender=S$a}),S$A(0,S$s,"array",function(){return this._list.array},function(S$a){this._keepStatus&&this._list.array&&S$a&&this.parseOpenStatus(this._list.array,S$a),this._source=S$a,this._list.array=this.getArray()}),S$A(0,S$s,"mouseHandler",function(){return this._list.mouseHandler},function(S$a){this._list.mouseHandler=S$a}),S$A(0,S$s,"dataSource",S$a.prototype._$get_dataSource,function(S$a){this._dataSource=S$a,S$h.superSet(S$Z,this,"dataSource",S$a)}),S$A(0,S$s,"source",function(){return this._source}),S$A(0,S$s,"scrollBar",function(){return this._list.scrollBar}),S$A(0,S$s,"list",function(){return this._list}),S$A(0,S$s,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(S$a){this._list.vScrollBarSkin=S$a}),S$A(0,S$s,"renderHandler",function(){return this._renderHandler},function(S$a){this._renderHandler=S$a}),S$A(0,S$s,"selectedIndex",function(){return this._list.selectedIndex},function(S$a){this._list.selectedIndex=S$a}),S$A(0,S$s,"spaceLeft",function(){return this._spaceLeft},function(S$a){this._spaceLeft=S$a}),S$A(0,S$s,"selectedItem",function(){return this._list.selectedItem},function(S$a){this._list.selectedItem=S$a}),S$A(0,S$s,"width",S$a.prototype._$get_width,function(S$a){S$h.superSet(S$Z,this,"width",S$a),this._list.width=S$a}),S$A(0,S$s,"height",S$a.prototype._$get_height,function(S$a){S$h.superSet(S$Z,this,"height",S$a),this._list.height=S$a}),S$A(0,S$s,"xml",null,function(S$a){var S$m=[];this.parseXml(S$a.childNodes[0],S$m,null,!0),this.array=S$m}),S$A(0,S$s,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),S$m}(S$Z),S$aa=function(S$a){function S$m(){this._items=null,this._selectedIndex=0,S$m.__super.call(this),this._setIndexHandler=S$d.create(this,this.setIndex,null,!1)}S$e(S$m,"laya.ui.ViewStack",S$a);var S$s=S$m.prototype;return S$h.imps(S$s,{"laya.ui.IItem":!0}),S$s.setItems=function(S$a){this.removeChildren();for(var S$m=0,S$s=0,S$P=S$a.length;S$s<S$P;S$s++){var S$_=S$a[S$s];S$_&&(S$_.name="item"+S$m,this.addChild(S$_),S$m++)}this.initItems()},S$s.addItem=function(S$a){S$a.name="item"+this._items.length,this.addChild(S$a),this.initItems()},S$s.initItems=function(){this._items=[];for(var S$a=0;S$a<1e4;S$a++){var S$m=this.getChildByName("item"+S$a);if(null==S$m)break;this._items.push(S$m),S$m.visible=S$a==this._selectedIndex}},S$s.setSelect=function(S$a,S$m){this._items&&-1<S$a&&S$a<this._items.length&&(this._items[S$a].visible=S$m)},S$s.setIndex=function(S$a){this.selectedIndex=S$a},S$A(0,S$s,"dataSource",S$a.prototype._$get_dataSource,function(S$a){if("number"==typeof(this._dataSource=S$a)&&Math.floor(S$a)==S$a||"string"==typeof S$a)this.selectedIndex=parseInt(S$a);else for(var S$m in this._dataSource)this.hasOwnProperty(S$m)&&(this[S$m]=this._dataSource[S$m])}),S$A(0,S$s,"selectedIndex",function(){return this._selectedIndex},function(S$a){this._selectedIndex!=S$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=S$a,this.setSelect(this._selectedIndex,!0))}),S$A(0,S$s,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(S$a){this.selectedIndex=this._items.indexOf(S$a)}),S$A(0,S$s,"items",function(){return this._items}),S$A(0,S$s,"setIndexHandler",function(){return this._setIndexHandler},function(S$a){this._setIndexHandler=S$a}),S$m}(S$Z),S$ma=function(S$a){function S$m(){S$m.__super.call(this)}return S$e(S$m,"laya.ui.VScrollBar",S$L),S$m}(),S$sa=function(S$m){function S$s(S$a){this._bg=null,this._skin=null,S$s.__super.call(this),void 0===S$a&&(S$a=""),this.text=S$a,this.skin=this.skin}S$e(S$s,"laya.ui.TextInput",S$m);var S$a=S$s.prototype;return S$a.preinitialize=function(){this.mouseEnabled=!0},S$a.destroy=function(S$a){S$p.clearCache(this,this._skin),void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._bg&&this._bg.destroy(),this._bg=null},S$a.createChildren=function(){this.addChild(this._tf=new S$Q),this._tf.padding=S$f.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},S$a._onFocus=function(){this.event("focus",this)},S$a._onBlur=function(){this.event("blur",this)},S$a._onInput=function(){this.event("input",this)},S$a._onEnter=function(){this.event("enter",this)},S$a.initialize=function(){this.width=128,this.height=22},S$a.select=function(){this._tf.select()},S$a.setSelection=function(S$a,S$m){this._tf.setSelection(S$a,S$m)},S$A(0,S$a,"text",S$m.prototype._$get_text,function(S$a){this._tf.text!=S$a&&(S$a+="",this._tf.text=S$a,this.event("change"))}),S$A(0,S$a,"bg",function(){return this._bg},function(S$a){this.graphics=this._bg=S$a}),S$A(0,S$a,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(S$a){this._tf.inputElementYAdjuster=S$a}),S$A(0,S$a,"multiline",function(){return this._tf.multiline},function(S$a){this._tf.multiline=S$a}),S$A(0,S$a,"skin",function(){return this._skin},function(S$a){this._skin!=S$a&&(S$p.clearCache(this,this._skin),this._skin=S$a,this._bg||(this.graphics=this._bg=new S$W),S$p.keepCache(this,this._skin),this._bg.source=S$p.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),S$A(0,S$a,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(S$a){this._bg||(this.graphics=this._bg=new S$W),this._bg.sizeGrid=S$K.fillArray(S$f.defaultSizeGrid,S$a,Number)}),S$A(0,S$a,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(S$a){this._tf.inputElementXAdjuster=S$a}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$x,this,"width",S$a),this._bg&&(this._bg.width=S$a)}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$x,this,"height",S$a),this._bg&&(this._bg.height=S$a)}),S$A(0,S$a,"editable",function(){return this._tf.editable},function(S$a){this._tf.editable=S$a}),S$A(0,S$a,"restrict",function(){return this._tf.restrict},function(S$a){this._tf.restrict=S$a}),S$A(0,S$a,"prompt",function(){return this._tf.prompt},function(S$a){this._tf.prompt=S$a}),S$A(0,S$a,"promptColor",function(){return this._tf.promptColor},function(S$a){this._tf.promptColor=S$a}),S$A(0,S$a,"maxChars",function(){return this._tf.maxChars},function(S$a){this._tf.maxChars=S$a}),S$A(0,S$a,"focus",function(){return this._tf.focus},function(S$a){this._tf.focus=S$a}),S$A(0,S$a,"type",function(){return this._tf.type},function(S$a){this._tf.type=S$a}),S$A(0,S$a,"asPassword",function(){return this._tf.asPassword},function(S$a){this._tf.asPassword=S$a}),S$s}(S$x),S$Pa=function(S$a){function S$m(){S$m.__super.call(this)}return S$e(S$m,"laya.ui.VSlider",S$R),S$m}(),S$_a=function(S$a){function S$P(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,S$P.__super.call(this)}S$e(S$P,"laya.ui.Dialog",S$a);var S$m=S$P.prototype;return S$m.initialize=function(){this.popupEffect=S$P.manager.popupEffectHandler,this.closeEffect=S$P.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},S$m._dealDragArea=function(){var S$a=this.getChildByName("drag");S$a&&(this.dragArea=S$a.x+","+S$a.y+","+S$a.width+","+S$a.height,S$a.removeSelf())},S$m._onClick=function(S$a){var S$m=S$a.target;if(S$m)switch(S$m.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(S$m.name)}},S$m.show=function(S$a,S$m){void 0===S$a&&(S$a=!1),void 0===S$m&&(S$m=!0),this._open(!1,S$a,S$m)},S$m.popup=function(S$a,S$m){void 0===S$a&&(S$a=!1),void 0===S$m&&(S$m=!0),this._open(!0,S$a,S$m)},S$m._open=function(S$a,S$m,S$s){S$P.manager.lock(!1),this.isModal=S$a,S$P.manager.open(this,S$m,S$s)},S$m.onOpened=function(){},S$m.close=function(S$a,S$m){void 0===S$m&&(S$m=!0),S$P.manager.close(this,S$a,S$m)},S$m.onClosed=function(S$a){},S$m._onMouseDown=function(S$a){var S$m=this.getMousePoint();this._dragArea.contains(S$m.x,S$m.y)?this.startDrag():this.stopDrag()},S$A(0,S$m,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(S$a){if(S$a){var S$m=S$K.fillArray([0,0,0,0],S$a,Number);this._dragArea=new S$O(S$m[0],S$m[1],S$m[2],S$m[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),S$A(0,S$m,"isPopup",function(){return null!=this.parent}),S$A(0,S$m,"zOrder",S$a.prototype._$get_zOrder,function(S$a){S$h.superSet(S$J,this,"zOrder",S$a),S$P.manager._checkMask()}),S$A(1,S$P,"manager",function(){return S$P._manager=S$P._manager||new S$S},function(S$a){S$P._manager=S$a}),S$P.setLockView=function(S$a){S$P.manager.setLockView(S$a)},S$P.lock=function(S$a){S$P.manager.lock(S$a)},S$P.closeAll=function(){S$P.manager.closeAll()},S$P.getDialogsByGroup=function(S$a){return S$P.manager.getDialogsByGroup(S$a)},S$P.closeByGroup=function(S$a){return S$P.manager.closeByGroup(S$a)},S$P.CLOSE="close",S$P.CANCEL="cancel",S$P.SURE="sure",S$P.NO="no",S$P.OK="ok",S$P.YES="yes",S$P._manager=null,S$P}(S$J),S$ea=function(S$a){function S$m(){S$m.__super.call(this)}S$e(S$m,"laya.ui.HBox",S$a);var S$s=S$m.prototype;return S$s.sortItem=function(S$a){S$a&&S$a.sort(function(S$a,S$m){return S$a.x-S$m.x})},S$s.changeItems=function(){this._itemChanged=!1;for(var S$a=[],S$m=0,S$s=0,S$P=this.numChildren;S$s<S$P;S$s++){var S$_=this.getChildAt(S$s);S$_&&S$_.layoutEnabled&&(S$a.push(S$_),S$m=this._height?this._height:Math.max(S$m,S$_.height*S$_.scaleY))}this.sortItem(S$a);var S$e=0;for(S$s=0,S$P=S$a.length;S$s<S$P;S$s++)(S$_=S$a[S$s]).x=S$e,S$e+=S$_.width*S$_.scaleX+this._space,"top"==this._align?S$_.y=0:"middle"==this._align?S$_.y=.5*(S$m-S$_.height*S$_.scaleY):"bottom"==this._align&&(S$_.y=S$m-S$_.height*S$_.scaleY);this.changeSize()},S$A(0,S$s,"height",S$a.prototype._$get_height,function(S$a){this._height!=S$a&&(S$h.superSet(S$g,this,"height",S$a),this.callLater(this.changeItems))}),S$m.NONE="none",S$m.TOP="top",S$m.MIDDLE="middle",S$m.BOTTOM="bottom",S$m}(S$g),S$Aa=function(S$a){function S$m(){S$m.__super.call(this)}S$e(S$m,"laya.ui.VBox",S$a);var S$s=S$m.prototype;return S$s.changeItems=function(){this._itemChanged=!1;for(var S$a=[],S$m=0,S$s=0,S$P=this.numChildren;S$s<S$P;S$s++){var S$_=this.getChildAt(S$s);S$_&&S$_.layoutEnabled&&(S$a.push(S$_),S$m=this._width?this._width:Math.max(S$m,S$_.width*S$_.scaleX))}this.sortItem(S$a);var S$e=0;for(S$s=0,S$P=S$a.length;S$s<S$P;S$s++)(S$_=S$a[S$s]).y=S$e,S$e+=S$_.height*S$_.scaleY+this._space,"left"==this._align?S$_.x=0:"center"==this._align?S$_.x=.5*(S$m-S$_.width*S$_.scaleX):"right"==this._align&&(S$_.x=S$m-S$_.width*S$_.scaleX);this.changeSize()},S$A(0,S$s,"width",S$a.prototype._$get_width,function(S$a){this._width!=S$a&&(S$h.superSet(S$g,this,"width",S$a),this.callLater(this.changeItems))}),S$m.NONE="none",S$m.LEFT="left",S$m.CENTER="center",S$m.RIGHT="right",S$m}(S$g),S$Ba=function(S$a){function S$m(){S$m.__super.call(this)}return S$e(S$m,"laya.ui.RadioGroup",S$$),S$m.prototype.createItem=function(S$a,S$m){return new S$n(S$a,S$m)},S$m}(),S$ka=function(S$a){function S$m(){S$m.__super.call(this)}return S$e(S$m,"laya.ui.Tab",S$$),S$m.prototype.createItem=function(S$a,S$m){return new S$X(S$a,S$m)},S$m}(),S$ja=function(S$m){function S$s(S$a){this._vScrollBar=null,this._hScrollBar=null,void 0===S$a&&(S$a=""),S$s.__super.call(this,S$a)}S$e(S$s,"laya.ui.TextArea",S$m);var S$a=S$s.prototype;return S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},S$a.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},S$a.onVBarChanged=function(S$a){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},S$a.onHBarChanged=function(S$a){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},S$a.changeScroll=function(){var S$a=this._vScrollBar&&0<this._tf.maxScrollY,S$m=this._hScrollBar&&0<this._tf.maxScrollX,S$s=S$a?this._width-this._vScrollBar.width:this._width,S$P=S$m?this._height-this._hScrollBar.height:this._height,S$_=this._tf.padding||S$f.labelPadding;this._tf.width=S$s,this._tf.height=S$P,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-S$_[2],this._vScrollBar.y=S$_[1],this._vScrollBar.height=this._height-(S$m?this._hScrollBar.height:0)-S$_[1]-S$_[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=S$P/Math.max(this._tf.textHeight,S$P),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=S$a),this._hScrollBar&&(this._hScrollBar.x=S$_[0],this._hScrollBar.y=this._height-this._hScrollBar.height-S$_[3],this._hScrollBar.width=this._width-(S$a?this._vScrollBar.width:0)-S$_[0]-S$_[2],this._hScrollBar.scrollSize=Math.max(.033*S$s,1),this._hScrollBar.thumbPercent=S$s/Math.max(this._tf.textWidth,S$s),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=S$m)},S$a.scrollTo=function(S$a){this.commitMeasure(),this._tf.scrollY=S$a},S$A(0,S$a,"scrollY",function(){return this._tf.scrollY}),S$A(0,S$a,"width",S$m.prototype._$get_width,function(S$a){S$h.superSet(S$sa,this,"width",S$a),this.callLater(this.changeScroll)}),S$A(0,S$a,"hScrollBar",function(){return this._hScrollBar}),S$A(0,S$a,"height",S$m.prototype._$get_height,function(S$a){S$h.superSet(S$sa,this,"height",S$a),this.callLater(this.changeScroll)}),S$A(0,S$a,"maxScrollX",function(){return this._tf.maxScrollX}),S$A(0,S$a,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(S$a){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new S$ma),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=S$a}),S$A(0,S$a,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(S$a){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new S$Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=S$a}),S$A(0,S$a,"vScrollBar",function(){return this._vScrollBar}),S$A(0,S$a,"maxScrollY",function(){return this._tf.maxScrollY}),S$A(0,S$a,"scrollX",function(){return this._tf.scrollX}),S$s}(S$sa);!function(S$a){function S$m(){this._uiView=null,this.isCloseOther=!1,S$m.__super.call(this)}S$e(S$m,"laya.ui.AsynDialog",S$_a);var S$s=S$m.prototype;S$s.createView=function(S$a){this._uiView=S$a},S$s._open=function(S$a,S$m,S$s){this.isModal=S$a,this.isCloseOther=S$m,S$_a.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},S$s.onCreated=function(){this.createUI(),this.onOpen()},S$s.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},S$s.onOpen=function(){S$_a.manager.open(this,this.isCloseOther),S$_a.manager.lock(!1)},S$s.close=function(S$a,S$m){void 0===S$m&&(S$m=!0),S$_a.manager.close(this),this.onClose()},S$s.onClose=function(){},S$s.destroy=function(S$a){void 0===S$a&&(S$a=!0),laya.ui.View.prototype.destroy.call(this,S$a),this._uiView=null,this.onDestroy()},S$s.onDestroy=function(){}}();S$h.__init([S$J])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(S$a,S$m){"use strict";for(var S$s in Object.defineProperty(S$m,"__esModule",{value:!0}),Laya){var S$P=Laya[S$s];S$P&&S$P.__isclass&&(S$m[S$s]=S$P)}}),function(S$d,S$a,S$o){S$o.un,S$o.uns;var S$y=S$o.static,S$Q=S$o.class,S$q=S$o.getset,S$P=S$o.__newvec,S$H=laya.maths.Arith,S$A=laya.webgl.atlas.AtlasResourceManager,S$s=laya.webgl.shader.BaseShader,S$b=laya.utils.Browser,S$B=laya.webgl.utils.Buffer,S$N=laya.utils.Byte,S$_=laya.utils.ClassUtils,S$k=S$o.Config,S$e=(laya.events.Event,laya.events.EventDispatcher),S$f=laya.utils.Handler,S$O=laya.net.Loader,S$m=laya.net.LoaderManager,S$j=(laya.maths.MathUtil,laya.display.Node),S$h=laya.renders.Render,S$G=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),S$u=laya.resource.Resource,S$p=laya.utils.RunDriver,S$c=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),S$z=laya.display.Sprite,S$U=laya.utils.Stat,S$l=laya.utils.StringKey,S$K=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),S$C=laya.utils.Utils,S$V=laya.webgl.WebGL,S$W=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;S$o.interface("laya.d3.core.IClone"),S$o.interface("laya.d3.graphics.IVertex"),S$o.interface("laya.d3.core.render.IUpdate"),S$o.interface("laya.d3.core.scene.ITreeNode"),S$o.interface("laya.d3.core.render.IRenderable");(function(){function S$X(){}S$Q(S$X,"laya.d3.animation.AnimationClipParser01"),S$X.READ_DATA=function(){S$X._DATA.offset=S$X._reader.getUint32(),S$X._DATA.size=S$X._reader.getUint32()},S$X.READ_BLOCK=function(){for(var S$a=S$X._BLOCK.count=S$X._reader.getUint16(),S$m=S$X._BLOCK.blockStarts=[],S$s=S$X._BLOCK.blockLengths=[],S$P=0;S$P<S$a;S$P++)S$m.push(S$X._reader.getUint32()),S$s.push(S$X._reader.getUint32())},S$X.READ_STRINGS=function(){var S$a=S$X._reader.getUint32(),S$m=S$X._reader.getUint16(),S$s=S$X._reader.pos;S$X._reader.pos=S$a+S$X._DATA.offset;for(var S$P=0;S$P<S$m;S$P++)S$X._strings[S$P]=S$X._reader.readUTFString();S$X._reader.pos=S$s},S$X.parse=function(S$a,S$m){S$X._animationClip=S$a;(S$X._reader=S$m).__getBuffer();S$X.READ_DATA(),S$X.READ_BLOCK(),S$X.READ_STRINGS();for(var S$s=0,S$P=S$X._BLOCK.count;S$s<S$P;S$s++){var S$_=S$m.getUint16(),S$e=S$X._strings[S$_],S$A=S$X["READ_"+S$e];if(null==S$A)throw new Error("model file err,no this function:"+S$_+" "+S$e);S$A.call()}},S$X.READ_ANIMATIONS=function(){var S$a,S$m=0,S$s=0,S$P=S$X._reader,S$_=S$P.__getBuffer(),S$e=[],S$A=S$P.getUint8();for(S$e.length=S$A,S$m=0;S$m<S$A;S$m++)S$e[S$m]=S$P.getUint16();var S$B=[],S$k=S$P.getUint16();for(S$B.length=S$k,S$m=0;S$m<S$k;S$m++)S$B[S$m]=S$P.getFloat32();var S$j=S$X._animationClip;S$j.name=S$X._strings[S$P.getUint16()];var S$G=S$j._duration=S$P.getFloat32();S$j.islooping=!!S$P.getByte(),S$j._frameRate=S$P.getInt16();var S$y=S$P.getInt16(),S$d=S$j._nodes=new Array;S$d.length=S$y,(S$j._publicClipDatas=[]).length=S$y;var S$Q=S$j._nodesMap={},S$q=0,S$h=0;for(S$m=0;S$m<S$y;S$m++){S$a=S$d[S$m]=new S$M;var S$u=S$P.getUint16(),S$O=S$a.path=[];for(S$O.length=S$u,S$s=0;S$s<S$u;S$s++)S$O[S$s]=S$X._strings[S$P.getUint16()];var S$p=S$O.join("/"),S$c=S$Q[S$p];S$c||(S$Q[S$p]=S$c=[]),S$c.push(S$a);var S$H=S$P.getInt16();-1!==S$H&&(S$a.componentType=S$X._strings[S$H]);var S$o=S$F._propertyIndexDic[S$X._strings[S$P.getUint16()]];if(null==S$o)throw new Error("AnimationClipParser01:unknown property name.");var S$N=S$o<4,S$z=!S$N||S$N&&""===S$O[0];(S$a._cacheProperty=S$z)?S$q++:S$h++,S$a.propertyNameID=S$o;var S$U=S$e[S$P.getUint8()];S$a.keyFrameWidth=S$U/4;var S$l=S$a.keyFrames=[],S$C=S$l.length=S$P.getUint16(),S$f=null,S$K=NaN;for(S$s=0;S$s<S$C;S$s++){var S$V=S$l[S$s]=new S$x;S$K=S$V.startTime=S$B[S$P.getUint16()];var S$W=S$P.pos;S$V.inTangent=new Float32Array(S$_.slice(S$W,S$W+S$U)),S$P.pos+=S$U,S$W=S$P.pos,S$V.outTangent=new Float32Array(S$_.slice(S$W,S$W+S$U)),S$P.pos+=S$U,S$W=S$P.pos,S$V.data=new Float32Array(S$_.slice(S$W,S$W+S$U)),S$P.pos+=S$U,S$f&&(S$f.next=S$V,S$f.duration=S$K-S$f.startTime),S$f=S$V}S$V.next=null,S$V.duration=S$G-S$K}var S$b=S$j._nodeToCachePropertyMap=new Int32Array(S$y),S$S=S$j._cachePropertyMap=new Int32Array(S$q),S$Z=S$j._unCachePropertyMap=new Int32Array(S$h);for(S$q=S$h=0,S$m=0;S$m<S$y;S$m++)(S$a=S$d[S$m])._cacheProperty?(S$b[S$m]=S$q,S$S[S$q++]=S$m):S$Z[S$h++]=S$m},S$X._animationClip=null,S$X._reader=null,S$X._strings=[],S$y(S$X,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function S$L(){}S$Q(S$L,"laya.d3.animation.AnimationClipParser02"),S$L.READ_DATA=function(){S$L._DATA.offset=S$L._reader.getUint32(),S$L._DATA.size=S$L._reader.getUint32()},S$L.READ_BLOCK=function(){for(var S$a=S$L._BLOCK.count=S$L._reader.getUint16(),S$m=S$L._BLOCK.blockStarts=[],S$s=S$L._BLOCK.blockLengths=[],S$P=0;S$P<S$a;S$P++)S$m.push(S$L._reader.getUint32()),S$s.push(S$L._reader.getUint32())},S$L.READ_STRINGS=function(){var S$a=S$L._reader.getUint32(),S$m=S$L._reader.getUint16(),S$s=S$L._reader.pos;S$L._reader.pos=S$a+S$L._DATA.offset;for(var S$P=0;S$P<S$m;S$P++)S$L._strings[S$P]=S$L._reader.readUTFString();S$L._reader.pos=S$s},S$L.parse=function(S$a,S$m){S$L._animationClip=S$a;(S$L._reader=S$m).__getBuffer();S$L.READ_DATA(),S$L.READ_BLOCK(),S$L.READ_STRINGS();for(var S$s=0,S$P=S$L._BLOCK.count;S$s<S$P;S$s++){var S$_=S$m.getUint16(),S$e=S$L._strings[S$_],S$A=S$L["READ_"+S$e];if(null==S$A)throw new Error("model file err,no this function:"+S$_+" "+S$e);S$A.call()}},S$L.READ_ANIMATIONS=function(){var S$a,S$m=0,S$s=0,S$P=S$L._reader,S$_=S$P.__getBuffer(),S$e=[],S$A=S$P.getUint8();for(S$e.length=S$A,S$m=0;S$m<S$A;S$m++)S$e[S$m]=S$P.getUint16();var S$B=[],S$k=S$P.getUint16();for(S$B.length=S$k,S$m=0;S$m<S$k;S$m++)S$B[S$m]=S$P.getFloat32();var S$j=S$L._animationClip;S$j.name=S$L._strings[S$P.getUint16()];var S$G=S$j._duration=S$P.getFloat32();S$j.islooping=!!S$P.getByte(),S$j._frameRate=S$P.getInt16();var S$y=S$P.getInt16(),S$d=S$j._nodes=new Array;S$d.length=S$y,(S$j._publicClipDatas=[]).length=S$y;var S$Q=S$j._nodesMap={},S$q=0,S$h=0;for(S$m=0;S$m<S$y;S$m++){S$a=S$d[S$m]=new S$M;var S$u=S$P.getUint16(),S$O=S$a.path=[];for(S$O.length=S$u,S$s=0;S$s<S$u;S$s++)S$O[S$s]=S$L._strings[S$P.getUint16()];var S$p=S$O.join("/"),S$c=S$Q[S$p];S$c||(S$Q[S$p]=S$c=[]),S$c.push(S$a);var S$H=S$P.getInt16();-1!==S$H&&(S$a.componentType=S$L._strings[S$H]);var S$o=S$F._propertyIndexDic[S$L._strings[S$P.getUint16()]];if(null==S$o)throw new Error("AnimationClipParser02:unknown property name.");var S$N=S$o<4,S$z=!S$N||S$N&&""===S$O[0];(S$a._cacheProperty=S$z)?S$q++:S$h++,S$a.propertyNameID=S$o;var S$U=S$e[S$P.getUint8()];S$a.keyFrameWidth=S$U/4;var S$l=S$a.keyFrames=[],S$C=S$l.length=S$P.getUint16(),S$f=null,S$K=NaN;for(S$s=0;S$s<S$C;S$s++){var S$V=S$l[S$s]=new S$x;S$K=S$V.startTime=S$B[S$P.getUint16()];var S$W=S$P.pos;S$V.inTangent=new Float32Array(S$_.slice(S$W,S$W+S$U)),S$P.pos+=S$U,S$W=S$P.pos,S$V.outTangent=new Float32Array(S$_.slice(S$W,S$W+S$U)),S$P.pos+=S$U,S$W=S$P.pos,S$V.data=new Float32Array(S$_.slice(S$W,S$W+S$U)),S$P.pos+=S$U,S$f&&(S$f.next=S$V,S$f.duration=S$K-S$f.startTime),S$f=S$V}S$V.next=null,S$V.duration=S$G-S$K}var S$b=S$P.getUint16();for(S$m=0;S$m<S$b;S$m++){var S$S,S$Z=new S$R;S$Z.time=S$P.getFloat32(),S$Z.eventName=S$L._strings[S$P.getUint16()];var S$X=S$P.getUint16();for(0<S$X&&(S$Z.params=S$S=[]),S$s=0;S$s<S$X;S$s++){switch(S$P.getByte()){case 0:S$S.push(!!S$P.getByte());break;case 1:S$S.push(S$P.getInt32());break;case 2:S$S.push(S$P.getFloat32());break;case 3:S$S.push(S$L._strings[S$P.getUint16()]);break;default:throw new Error("unknown type.")}}S$j.addEvent(S$Z)}var S$E=S$j._nodeToCachePropertyMap=new Int32Array(S$y),S$i=S$j._cachePropertyMap=new Int32Array(S$q),S$t=S$j._unCachePropertyMap=new Int32Array(S$h);for(S$q=S$h=0,S$m=0;S$m<S$y;S$m++)(S$a=S$d[S$m])._cacheProperty?(S$E[S$m]=S$q,S$i[S$q++]=S$m):S$t[S$h++]=S$m},S$L._animationClip=null,S$L._reader=null,S$L._strings=[],S$y(S$L,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var S$R=function(){function S$a(){this.time=NaN,this.eventName=null,this.params=null}return S$Q(S$a,"laya.d3.animation.AnimationEvent"),S$a}(),S$F=function(){function S$P(){this._childs=[],this.transform=new S$pm(this)}S$Q(S$P,"laya.d3.animation.AnimationNode");var S$a=S$P.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.addChild=function(S$a){S$a._parent=this,S$a.transform.setParent(this.transform),this._childs.push(S$a)},S$a.removeChild=function(S$a){var S$m=this._childs.indexOf(S$a);-1!==S$m&&this._childs.splice(S$m,1)},S$a.getChildByName=function(S$a){for(var S$m=0,S$s=this._childs.length;S$m<S$s;S$m++){var S$P=this._childs[S$m];if(S$P.name===S$a)return S$P}return null},S$a.getChildByIndex=function(S$a){return this._childs[S$a]},S$a.getChildCount=function(){return this._childs.length},S$a.cloneTo=function(S$a){var S$m=S$a;S$m.name=this.name;for(var S$s=0,S$P=this._childs.length;S$s<S$P;S$s++){var S$_=this._childs[S$s],S$e=S$_.clone();S$m.addChild(S$e);var S$A=S$_.transform,S$B=S$e.transform;S$B.setLocalPosition(S$A.getLocalPosition()),S$B.setLocalRotation(S$A.getLocalRotation()),S$B.setLocalScale(S$A.getLocalScale()),S$B._localRotationEuler=S$A._localRotationEuler,S$B._setWorldMatrixIgnoreUpdate(S$A.getWorldMatrix())}},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$P.__init__=function(){S$P.registerAnimationNodeProperty("localPosition",S$P._getLocalPosition,S$P._setLocalPosition),S$P.registerAnimationNodeProperty("localRotation",S$P._getLocalRotation,S$P._setLocalRotation),S$P.registerAnimationNodeProperty("localScale",S$P._getLocalScale,S$P._setLocalScale),S$P.registerAnimationNodeProperty("localRotationEuler",S$P._getLocalRotationEuler,S$P._setLocalRotationEuler),S$P.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",S$P._getParticleRenderSharedMaterialTintColor,S$P._setParticleRenderSharedMaterialTintColor),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",S$P._getMeshRenderSharedMaterialTilingOffset,S$P._setMeshRenderSharedMaterialTilingOffset),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",S$P._getMeshRenderSharedMaterialAlbedo,S$P._setMeshRenderSharedMaterialAlbedo),S$P.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",S$P._getSkinnedMeshRenderSharedMaterialTilingOffset,S$P._setSkinnedMeshRenderSharedMaterialTilingOffset),S$P.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",S$P._getSkinnedMeshRenderSharedMaterialAlbedo,S$P._setSkinnedMeshRenderSharedMaterialAlbedo),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",S$P._getMeshRenderSharedMaterialAlbedo,S$P._setMeshRenderSharedMaterialAlbedo),S$P.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",S$P._getSkinnedMeshRenderSharedMaterialAlbedo,S$P._setSkinnedMeshRenderSharedMaterialAlbedo),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",S$P._getMeshRenderSharedMaterialIntensity,S$P._setMeshRenderSharedMaterialIntensity),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",S$P._getMeshRenderSharedMaterialAlpha,S$P._setMeshRenderSharedMaterialAlpha),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",S$P._getMeshRenderSharedMaterialAlphaColor,S$P._setMeshRenderSharedMaterialAlphaColor),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",S$P._getMeshRenderSharedMaterialBaseColor,S$P._setMeshRenderSharedMaterialBaseColor),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",S$P._getMeshRenderSharedMaterialDissolve,S$P._setMeshRenderSharedMaterialDissolve),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",S$P._getMeshRenderSharedMaterialDissolveSpeed,S$P._setMeshRenderSharedMaterialDissolveSpeed),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",S$P._getMeshRenderSharedMaterialMMultiplier,S$P._setMeshRenderSharedMaterialMMultiplier),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",S$P._getMeshRenderSharedMaterialBaseScrollSpeedX,S$P._setMeshRenderSharedMaterialBaseScrollSpeedX),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",S$P._getMeshRenderSharedMaterialBaseScrollSpeedY,S$P._setMeshRenderSharedMaterialBaseScrollSpeedY),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",S$P._getMeshRenderSharedMaterialSecondScrollSpeedX,S$P._setMeshRenderSharedMaterialSecondScrollSpeedX),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",S$P._getMeshRenderSharedMaterialSecondScrollSpeedY,S$P._setMeshRenderSharedMaterialSecondScrollSpeedY),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",S$P._getMeshRenderSharedMaterialDetailTilingOffset,S$P._setMeshRenderSharedMaterialDetailTilingOffset),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",S$P._getMeshRenderSharedMaterialDissolveTilingOffset,S$P._setMeshRenderSharedMaterialDissolveTilingOffset),S$P.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",S$P._getMeshRenderSharedMaterialMaskTilingOffset,S$P._setMeshRenderSharedMaterialMaskTilingOffset)},S$P.registerAnimationNodeProperty=function(S$a,S$m,S$s){if(S$P._propertyIndexDic[S$a])throw new Error("AnimationNode: this propertyName has registered.");S$P._propertyIndexDic[S$a]=S$P._propertyIDCounter,S$P._propertyGetFuncs[S$P._propertyIDCounter]=S$m,S$P._propertySetFuncs[S$P._propertyIDCounter]=S$s,S$P._propertyIDCounter++},S$P._getLocalPosition=function(S$a,S$m){return S$a?S$a.transform.getLocalPosition():S$m._transform.localPosition.elements},S$P._setLocalPosition=function(S$a,S$m,S$s){if(S$a)S$a.transform.setLocalPosition(S$s);else{var S$P=S$m._transform,S$_=S$P.localPosition;S$_.elements=S$s,S$P.localPosition=S$_}},S$P._getLocalRotation=function(S$a,S$m){return S$a?S$a.transform.getLocalRotation():S$m._transform.localRotation.elements},S$P._setLocalRotation=function(S$a,S$m,S$s){if(S$a)S$a.transform.setLocalRotation(S$s);else{var S$P=S$m._transform,S$_=S$P.localRotation;S$_.elements=S$s,S$P.localRotation=S$_}},S$P._getLocalScale=function(S$a,S$m){return S$a?S$a.transform.getLocalScale():S$m._transform.localScale.elements},S$P._setLocalScale=function(S$a,S$m,S$s){if(S$a)S$a.transform.setLocalScale(S$s);else{var S$P=S$m._transform,S$_=S$P.localScale;S$_.elements=S$s,S$P.localScale=S$_}},S$P._getLocalRotationEuler=function(S$a,S$m){return S$a?S$a.transform.getLocalRotationEuler():S$m._transform.localRotationEuler.elements},S$P._setLocalRotationEuler=function(S$a,S$m,S$s){if(S$a)S$a.transform.setLocalRotationEuler(S$s);else{var S$P=S$m._transform,S$_=S$P.localRotationEuler;S$_.elements=S$s,S$P.localRotationEuler=S$_}},S$P._getMeshRenderSharedMaterialTilingOffset=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return S$m.meshRender.sharedMaterial.tilingOffset.elements},S$P._setMeshRenderSharedMaterialTilingOffset=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.meshRender.material).tilingOffset).elements=S$s,S$P.tilingOffset=S$_)}else(S$_=(S$P=S$m.meshRender.material).tilingOffset).elements=S$s,S$P.tilingOffset=S$_},S$P._getMeshRenderSharedMaterialAlbedo=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.albedoColor.elements:null}return S$m.meshRender.sharedMaterial.albedoColor.elements},S$P._setMeshRenderSharedMaterialAlbedo=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.meshRender.material).albedoColor).elements=S$s,S$P.albedoColor=S$_)}else(S$_=(S$P=S$m.meshRender.material).albedoColor).elements=S$s,S$P.albedoColor=S$_},S$P._getSkinnedMeshRenderSharedMaterialTilingOffset=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return S$m.skinnedMeshRender.sharedMaterial.tilingOffset.elements},S$P._setSkinnedMeshRenderSharedMaterialTilingOffset=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.skinnedMeshRender.material).tilingOffset).elements=S$s,S$P.tilingOffset=S$_)}else(S$_=(S$P=S$m.skinnedMeshRender.material).tilingOffset).elements=S$s,S$P.tilingOffset=S$_},S$P._getSkinnedMeshRenderSharedMaterialAlbedo=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return S$m.skinnedMeshRender.sharedMaterial.albedoColor.elements},S$P._setSkinnedMeshRenderSharedMaterialAlbedo=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.skinnedMeshRender.material).albedoColor).elements=S$s,S$P.albedoColor=S$_)}else(S$_=(S$P=S$m.skinnedMeshRender.material).albedoColor).elements=S$s,S$P.albedoColor=S$_},S$P._getParticleRenderSharedMaterialTintColor=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.particleRender.sharedMaterial.tintColor.elements:null}return S$m.particleRender.sharedMaterial.tintColor.elements},S$P._setParticleRenderSharedMaterialTintColor=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.particleRender.material).tintColor).elements=S$s,S$P.tintColor=S$_)}else(S$_=(S$P=S$m.particleRender.material).tintColor).elements=S$s,S$P.tintColor=S$_},S$P._getMeshRenderSharedMaterialAlphaColor=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.alphaColor.elements:null}return S$m.meshRender.sharedMaterial.alphaColor.elements},S$P._setMeshRenderSharedMaterialAlphaColor=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.meshRender.material).alphaColor).elements=S$s,S$P.alphaColor=S$_)}else(S$_=(S$P=S$m.meshRender.material).alphaColor).elements=S$s,S$P.alphaColor=S$_},S$P._getMeshRenderSharedMaterialBaseColor=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.baseColor.elements:null}return S$m.meshRender.sharedMaterial.baseColor.elements},S$P._setMeshRenderSharedMaterialBaseColor=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.meshRender.material).baseColor).elements=S$s,S$P.baseColor=S$_)}else(S$_=(S$P=S$m.meshRender.material).baseColor).elements=S$s,S$P.baseColor=S$_},S$P._getMeshRenderSharedMaterialDissolve=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.dissolve:0}return S$m.meshRender.sharedMaterial.dissolve},S$P._setMeshRenderSharedMaterialDissolve=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.dissolve=S$s[0])}else S$m.meshRender.material.dissolve=S$s[0]},S$P._getMeshRenderSharedMaterialDissolveSpeed=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.dissolveSpeed:0}return S$m.meshRender.sharedMaterial.dissolveSpeed},S$P._setMeshRenderSharedMaterialDissolveSpeed=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.dissolveSpeed=S$s[0])}else S$m.meshRender.material.dissolveSpeed=S$s[0]},S$P._getMeshRenderSharedMaterialMMultiplier=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.mMultiplier:0}return S$m.meshRender.sharedMaterial.mMultiplier},S$P._setMeshRenderSharedMaterialMMultiplier=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.mMultiplier=S$s[0])}else S$m.meshRender.material.mMultiplier=S$s[0]},S$P._getMeshRenderSharedMaterialBaseScrollSpeedX=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return S$m.meshRender.sharedMaterial.baseScrollSpeedX},S$P._setMeshRenderSharedMaterialBaseScrollSpeedX=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.baseScrollSpeedX=S$s[0])}else S$m.meshRender.material.baseScrollSpeedX=S$s[0]},S$P._getMeshRenderSharedMaterialBaseScrollSpeedY=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return S$m.meshRender.sharedMaterial.baseScrollSpeedY},S$P._setMeshRenderSharedMaterialBaseScrollSpeedY=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.baseScrollSpeedY=S$s[0])}else S$m.meshRender.material.baseScrollSpeedY=S$s[0]},S$P._getMeshRenderSharedMaterialSecondScrollSpeedX=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return S$m.meshRender.sharedMaterial.secondScrollSpeedX},S$P._setMeshRenderSharedMaterialSecondScrollSpeedX=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.secondScrollSpeedX=S$s[0])}else S$m.meshRender.material.secondScrollSpeedX=S$s[0]},S$P._getMeshRenderSharedMaterialSecondScrollSpeedY=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return S$m.meshRender.sharedMaterial.secondScrollSpeedY},S$P._setMeshRenderSharedMaterialSecondScrollSpeedY=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.secondScrollSpeedY=S$s[0])}else S$m.meshRender.material.secondScrollSpeedY=S$s[0]},S$P._getMeshRenderSharedMaterialAlpha=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.alpha:0}return S$m.meshRender.sharedMaterial.alpha},S$P._setMeshRenderSharedMaterialAlpha=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.alpha=S$s[0])}else S$m.meshRender.material.alpha=S$s[0]},S$P._getMeshRenderSharedMaterialIntensity=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.intensity:0}return S$m.meshRender.sharedMaterial.intensity},S$P._setMeshRenderSharedMaterialIntensity=function(S$a,S$m,S$s){if(S$a){var S$P=S$a.transform._entity;S$P&&(S$P.owner.meshRender.material.intensity=S$s[0])}else S$m.meshRender.material.intensity=S$s[0]},S$P._getMeshRenderSharedMaterialDetailTilingOffset=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return S$m.meshRender.sharedMaterial.detailTilingOffset.elements},S$P._setMeshRenderSharedMaterialDetailTilingOffset=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.meshRender.material).detailTilingOffset).elements=S$s,S$P.detailTilingOffset=S$_)}else(S$_=(S$P=S$m.meshRender.material).detailTilingOffset).elements=S$s,S$P.detailTilingOffset=S$_},S$P._getMeshRenderSharedMaterialDissolveTilingOffset=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return S$m.meshRender.sharedMaterial.dissolveTilingOffset.elements},S$P._setMeshRenderSharedMaterialDissolveTilingOffset=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.meshRender.material).dissolveTilingOffset).elements=S$s,S$P.dissolveTilingOffset=S$_)}else(S$_=(S$P=S$m.meshRender.material).dissolveTilingOffset).elements=S$s,S$P.dissolveTilingOffset=S$_},S$P._getMeshRenderSharedMaterialMaskTilingOffset=function(S$a,S$m){if(S$a){var S$s=S$a.transform._entity;return S$s?S$s.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return S$m.meshRender.sharedMaterial.maskTilingOffset.elements},S$P._setMeshRenderSharedMaterialMaskTilingOffset=function(S$a,S$m,S$s){var S$P,S$_;if(S$a){var S$e=S$a.transform._entity;S$e&&((S$_=(S$P=S$e.owner.meshRender.material).maskTilingOffset).elements=S$s,S$P.maskTilingOffset=S$_)}else(S$_=(S$P=S$m.meshRender.material).maskTilingOffset).elements=S$s,S$P.maskTilingOffset=S$_},S$P._propertyIDCounter=0,S$P._propertyIndexDic={},S$P._propertySetFuncs=[],S$P._propertyGetFuncs=[],S$P}(),S$x=function(){function S$a(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return S$Q(S$a,"laya.d3.animation.Keyframe"),S$a}(),S$M=function(){function S$a(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return S$Q(S$a,"laya.d3.animation.KeyframeNode"),S$a}(),S$S=(function(){function S$a(){this._tempVector30=new S$Am,this._tempVector31=new S$Am,this._tempVector32=new S$Am,this._a=new S$Am,this._b=new S$Am,this._c=new S$Am,this._d=new S$Am}S$Q(S$a,"laya.d3.core.glitter.SplineCurvePositionVelocity");var S$m=S$a.prototype;S$m.Init=function(S$a,S$m,S$s,S$P){S$a.cloneTo(this._d),S$m.cloneTo(this._c),S$Am.scale(S$a,2,this._a),S$Am.scale(S$s,2,this._tempVector30),S$Am.subtract(this._a,this._tempVector30,this._a),S$Am.add(this._a,S$m,this._a),S$Am.add(this._a,S$P,this._a),S$Am.scale(S$s,3,this._b),S$Am.scale(S$a,3,this._tempVector30),S$Am.subtract(this._b,this._tempVector30,this._b),S$Am.subtract(this._b,S$P,this._b),S$Am.scale(S$m,2,this._tempVector30),S$Am.subtract(this._b,this._tempVector30,this._b)},S$m.Slerp=function(S$a,S$m){S$Am.scale(this._a,S$a*S$a*S$a,this._tempVector30),S$Am.scale(this._b,S$a*S$a,this._tempVector31),S$Am.scale(this._c,S$a,this._tempVector32),S$Am.add(this._tempVector30,this._tempVector31,S$m),S$Am.add(S$m,this._tempVector32,S$m),S$Am.add(S$m,this._d,S$m)}}(),function(){function S$i(S$a,S$m,S$s,S$P){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=S$a,this._h=S$m,this._minHeight=S$s,this._maxHeight=S$P}S$Q(S$i,"laya.d3.core.HeightMap");var S$a=S$i.prototype;S$a._inBounds=function(S$a,S$m){return 0<=S$a&&S$a<this._h&&0<=S$m&&S$m<this._w},S$a.getHeight=function(S$a,S$m){return this._inBounds(S$a,S$m)?this._datas[S$a][S$m]:NaN},S$q(0,S$a,"width",function(){return this._w}),S$q(0,S$a,"height",function(){return this._h}),S$q(0,S$a,"maxHeight",function(){return this._maxHeight}),S$q(0,S$a,"minHeight",function(){return this._minHeight}),S$i.creatFromMesh=function(S$a,S$m,S$s,S$P){for(var S$_=[],S$e=[],S$A=S$a.getSubMeshCount(),S$B=0;S$B<S$A;S$B++){for(var S$k=S$a.getSubMesh(S$B),S$j=S$k._getVertexBuffer(),S$G=S$j.getData(),S$y=[],S$d=0;S$d<S$G.length;S$d+=S$j.vertexDeclaration.vertexStride/4){var S$Q=new S$Am(S$G[S$d+0],S$G[S$d+1],S$G[S$d+2]);S$y.push(S$Q)}S$_.push(S$y);var S$q=S$k._getIndexBuffer();S$e.push(S$q.getData())}var S$h=S$a.boundingBox,S$u=S$h.min.x,S$O=S$h.min.z,S$p=S$h.max.x,S$c=S$h.max.z,S$H=S$h.min.y,S$o=S$h.max.y,S$N=S$p-S$u,S$z=S$c-S$O,S$U=S$P.elements[0]=S$N/(S$m-1),S$l=S$P.elements[1]=S$z/(S$s-1),S$C=new S$i(S$m,S$s,S$H,S$o),S$f=S$i._tempRay,S$K=S$f.direction.elements;S$K[0]=0,S$K[1]=-1,S$K[2]=0;var S$V=S$o+.1;S$f.origin.elements[1]=S$V;for(var S$W=0;S$W<S$s;S$W++){var S$b=S$O+S$W*S$l;S$C._datas[S$W]=[];for(var S$S=0;S$S<S$m;S$S++){var S$Z=S$u+S$S*S$U,S$X=S$f.origin.elements;S$X[0]=S$Z,S$X[2]=S$b;var S$E=S$i._getPosition(S$f,S$_,S$e);S$C._datas[S$W][S$S]=S$E===Number.MAX_VALUE?NaN:S$V-S$E}}return S$C},S$i.createFromImage=function(S$a,S$m,S$s){for(var S$P=S$a.width,S$_=S$a.height,S$e=new S$i(S$P,S$_,S$m,S$s),S$A=(S$s-S$m)/254,S$B=S$a.getPixels(),S$k=0,S$j=0;S$j<S$_;S$j++)for(var S$G=S$e._datas[S$j]=[],S$y=0;S$y<S$P;S$y++){var S$d=S$B[S$k++],S$Q=S$B[S$k++],S$q=S$B[S$k++],S$h=S$B[S$k++];S$G[S$y]=255==S$d&&255==S$Q&&255==S$q&&255==S$h?NaN:(S$d+S$Q+S$q)/3*S$A+S$m}return S$e},S$i._getPosition=function(S$a,S$m,S$s){for(var S$P=Number.MAX_VALUE,S$_=0;S$_<S$m.length;S$_++)for(var S$e=S$m[S$_],S$A=S$s[S$_],S$B=0;S$B<S$A.length;S$B+=3){var S$k=S$e[S$A[S$B+0]],S$j=S$e[S$A[S$B+1]],S$G=S$e[S$A[S$B+2]],S$y=S$qm.rayIntersectsTriangle(S$a,S$k,S$j,S$G);!isNaN(S$y)&&S$y<S$P&&(S$P=S$y)}return S$P},S$y(S$i,["_tempRay",function(){return this._tempRay=new S$_m(new S$Am,new S$Am)}])}(),function(){function S$_(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}S$Q(S$_,"laya.d3.core.Layer");var S$a=S$_.prototype;return S$a._binarySearchIndex=function(){for(var S$a=0,S$m=S$_._collsionTestList.length-1,S$s=0;S$a<=S$m;){S$s=Math.floor((S$a+S$m)/2);var S$P=S$_._collsionTestList[S$s];if(S$P==this._number)return S$s;S$P>this._number?S$m=S$s-1:S$a=S$s+1}return S$a},S$a._addCollider=function(S$a){0===this._colliders.length&&S$_._collsionTestList.splice(this._binarySearchIndex(),0,this._number),S$a._isRigidbody?(this._colliders.unshift(S$a),this._nonRigidbodyOffset++):this._colliders.push(S$a)},S$a._removeCollider=function(S$a){var S$m=this._colliders.indexOf(S$a);S$m<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(S$m,1),0===this._colliders.length&&S$_._collsionTestList.splice(S$_._collsionTestList.indexOf(this._number),1)},S$q(0,S$a,"number",function(){return this._number}),S$q(0,S$a,"visible",function(){return this._visible},function(S$a){this._visible=S$a,S$_._visibleLayers=S$a?S$_._visibleLayers|this.mask:S$_._visibleLayers&~this.mask}),S$q(0,S$a,"mask",function(){return this._mask}),S$q(1,S$_,"visibleLayers",function(){return S$_._visibleLayers},function(S$a){S$_._visibleLayers=S$a;for(var S$m=0,S$s=S$_._layerList.length;S$m<S$s;S$m++){var S$P=S$_._layerList[S$m];S$P._visible=0!=(S$P._mask&S$_._visibleLayers)}}),S$_.__init__=function(){S$_._layerList.length=31;for(var S$a=0;S$a<31;S$a++){var S$m=new S$_;S$_._layerList[S$a]=S$m,0===S$a?(S$m.name="Default Layer",S$m.visible=!0):(S$m.name="Layer-"+S$a,S$m.visible=!1),S$m._number=S$a,S$m._mask=Math.pow(2,S$a)}S$_.currentCreationLayer=S$_._layerList[0]},S$_.getLayerByNumber=function(S$a){if(S$a<0||30<S$a)throw new Error("无法返回指定Layer，该number超出范围！");return S$_._layerList[S$a]},S$_.getLayerByName=function(S$a){for(var S$m=0;S$m<31;S$m++)if(S$_._layerList[S$m].name===S$a)return S$_._layerList[S$m];throw new Error("无法返回指定Layer,该name不存在")},S$_.isVisible=function(S$a){return 0!=(S$a&S$_._currentCameraCullingMask&S$_._visibleLayers)},S$_._layerList=[],S$_._visibleLayers=2147483647,S$_._collsionTestList=[],S$_._currentCameraCullingMask=2147483647,S$_.maxCount=31,S$_.currentCreationLayer=null,S$_}()),S$Z=(function(){function S$a(S$a,S$m,S$s){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=S$a,this._minCount=S$m,this._maxCount=S$s}S$Q(S$a,"laya.d3.core.particleShuriKen.module.Burst");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.cloneTo=function(S$a){var S$m=S$a;S$m._time=this._time,S$m._minCount=this._minCount,S$m._maxCount=this._maxCount},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"time",function(){return this._time}),S$q(0,S$m,"minCount",function(){return this._minCount}),S$q(0,S$m,"maxCount",function(){return this._maxCount})}(),function(){function S$a(S$a){this._color=null,this.enbale=!1,this._color=S$a}S$Q(S$a,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var S$m=S$a.prototype;S$m.cloneTo=function(S$a){var S$m=S$a;this._color.cloneTo(S$m._color),S$m.enbale=this.enbale},S$m.clone=function(){var S$a;switch(this._color.type){case 0:S$a=S$E.createByConstant(this._color.constant.clone());break;case 1:S$a=S$E.createByGradient(this._color.gradient.clone());break;case 2:S$a=S$E.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:S$a=S$E.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var S$m=new this.constructor(S$a);return S$m.enbale=this.enbale,S$m},S$q(0,S$m,"color",function(){return this._color})}(),function(){function S$a(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}S$Q(S$a,"laya.d3.core.particleShuriKen.module.Emission");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),S$m._destroy=function(){this._bursts=null,this._destroyed=!0},S$m.getBurstsCount=function(){return this._bursts.length},S$m.getBurstByIndex=function(S$a){return this._bursts[S$a]},S$m.addBurst=function(S$a){var S$m=this._bursts.length;if(0<S$m)for(var S$s=0;S$s<S$m;S$s++)this._bursts[S$s].time>S$a.time&&this._bursts.splice(S$s,0,S$a);this._bursts.push(S$a)},S$m.removeBurst=function(S$a){var S$m=this._bursts.indexOf(S$a);-1!==S$m&&this._bursts.splice(S$m,1)},S$m.removeBurstByIndex=function(S$a){this._bursts.splice(S$a,1)},S$m.clearBurst=function(){this._bursts.length=0},S$m.cloneTo=function(S$a){var S$m=S$a,S$s=S$m._bursts;S$s.length=this._bursts.length;for(var S$P=0,S$_=this._bursts.length;S$P<S$_;S$P++){var S$e=S$s[S$P];S$e?this._bursts[S$P].cloneTo(S$e):S$s[S$P]=this._bursts[S$P].clone()}S$m._emissionRate=this._emissionRate,S$m.enbale=this.enbale},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"destroyed",function(){return this._destroyed}),S$q(0,S$m,"emissionRate",function(){return this._emissionRate},function(S$a){if(S$a<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=S$a})}(),function(){function S$P(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}S$Q(S$P,"laya.d3.core.particleShuriKen.module.FrameOverTime");var S$a=S$P.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.cloneTo=function(S$a){var S$m=S$a;S$m._type=this._type,S$m._constant=this._constant,this._overTime.cloneTo(S$m._overTime),S$m._constantMin=this._constantMin,S$m._constantMax=this._constantMax,this._overTimeMin.cloneTo(S$m._overTimeMin),this._overTimeMax.cloneTo(S$m._overTimeMax)},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$a,"frameOverTimeData",function(){return this._overTime}),S$q(0,S$a,"constant",function(){return this._constant}),S$q(0,S$a,"type",function(){return this._type}),S$q(0,S$a,"frameOverTimeDataMin",function(){return this._overTimeMin}),S$q(0,S$a,"constantMin",function(){return this._constantMin}),S$q(0,S$a,"frameOverTimeDataMax",function(){return this._overTimeMax}),S$q(0,S$a,"constantMax",function(){return this._constantMax}),S$P.createByConstant=function(S$a){var S$m=new S$P;return S$m._type=0,S$m._constant=S$a,S$m},S$P.createByOverTime=function(S$a){var S$m=new S$P;return S$m._type=1,S$m._overTime=S$a,S$m},S$P.createByRandomTwoConstant=function(S$a,S$m){var S$s=new S$P;return S$s._type=2,S$s._constantMin=S$a,S$s._constantMax=S$m,S$s},S$P.createByRandomTwoOverTime=function(S$a,S$m){var S$s=new S$P;return S$s._type=3,S$s._overTimeMin=S$a,S$s._overTimeMax=S$m,S$s},S$P}()),S$X=function(){function S$j(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}S$Q(S$j,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var S$a=S$j.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.cloneTo=function(S$a){var S$m=S$a;S$m._type=this._type,S$m._separateAxes=this._separateAxes,S$m._constant=this._constant,this._constantSeparate.cloneTo(S$m._constantSeparate),this._gradient.cloneTo(S$m._gradient),this._gradientX.cloneTo(S$m._gradientX),this._gradientY.cloneTo(S$m._gradientY),this._gradientZ.cloneTo(S$m._gradientZ),S$m._constantMin=this._constantMin,S$m._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(S$m._constantMinSeparate),this._constantMaxSeparate.cloneTo(S$m._constantMaxSeparate),this._gradientMin.cloneTo(S$m._gradientMin),this._gradientMax.cloneTo(S$m._gradientMax),this._gradientXMin.cloneTo(S$m._gradientXMin),this._gradientXMax.cloneTo(S$m._gradientXMax),this._gradientYMin.cloneTo(S$m._gradientYMin),this._gradientYMax.cloneTo(S$m._gradientYMax),this._gradientZMin.cloneTo(S$m._gradientZMin),this._gradientZMax.cloneTo(S$m._gradientZMax)},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$a,"gradientZ",function(){return this._gradientZ}),S$q(0,S$a,"constant",function(){return this._constant}),S$q(0,S$a,"gradient",function(){return this._gradient}),S$q(0,S$a,"separateAxes",function(){return this._separateAxes}),S$q(0,S$a,"type",function(){return this._type}),S$q(0,S$a,"constantSeparate",function(){return this._constantSeparate}),S$q(0,S$a,"gradientX",function(){return this._gradientX}),S$q(0,S$a,"gradientY",function(){return this._gradientY}),S$q(0,S$a,"gradientW",function(){return this._gradientW}),S$q(0,S$a,"gradientMin",function(){return this._gradientMin}),S$q(0,S$a,"constantMin",function(){return this._constantMin}),S$q(0,S$a,"gradientMax",function(){return this._gradientMax}),S$q(0,S$a,"constantMax",function(){return this._constantMax}),S$q(0,S$a,"gradientWMin",function(){return this._gradientWMin}),S$q(0,S$a,"constantMinSeparate",function(){return this._constantMinSeparate}),S$q(0,S$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),S$q(0,S$a,"gradientXMin",function(){return this._gradientXMin}),S$q(0,S$a,"gradientXMax",function(){return this._gradientXMax}),S$q(0,S$a,"gradientWMax",function(){return this._gradientWMax}),S$q(0,S$a,"gradientYMin",function(){return this._gradientYMin}),S$q(0,S$a,"gradientYMax",function(){return this._gradientYMax}),S$q(0,S$a,"gradientZMin",function(){return this._gradientZMin}),S$q(0,S$a,"gradientZMax",function(){return this._gradientZMax}),S$j.createByConstant=function(S$a){var S$m=new S$j;return S$m._type=0,S$m._separateAxes=!1,S$m._constant=S$a,S$m},S$j.createByConstantSeparate=function(S$a){var S$m=new S$j;return S$m._type=0,S$m._separateAxes=!0,S$m._constantSeparate=S$a,S$m},S$j.createByGradient=function(S$a){var S$m=new S$j;return S$m._type=1,S$m._separateAxes=!1,S$m._gradient=S$a,S$m},S$j.createByGradientSeparate=function(S$a,S$m,S$s,S$P){var S$_=new S$j;return S$_._type=1,S$_._separateAxes=!0,S$_._gradientX=S$a,S$_._gradientY=S$m,S$_._gradientZ=S$s,S$_._gradientW=S$P,S$_},S$j.createByRandomTwoConstant=function(S$a,S$m){var S$s=new S$j;return S$s._type=2,S$s._separateAxes=!1,S$s._constantMin=S$a,S$s._constantMax=S$m,S$s},S$j.createByRandomTwoConstantSeparate=function(S$a,S$m){var S$s=new S$j;return S$s._type=2,S$s._separateAxes=!0,S$s._constantMinSeparate=S$a,S$s._constantMaxSeparate=S$m,S$s},S$j.createByRandomTwoGradient=function(S$a,S$m){var S$s=new S$j;return S$s._type=3,S$s._separateAxes=!1,S$s._gradientMin=S$a,S$s._gradientMax=S$m,S$s},S$j.createByRandomTwoGradientSeparate=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){var S$k=new S$j;return S$k._type=3,S$k._separateAxes=!0,S$k._gradientXMin=S$a,S$k._gradientXMax=S$m,S$k._gradientYMin=S$s,S$k._gradientYMax=S$P,S$k._gradientZMin=S$_,S$k._gradientZMax=S$e,S$k._gradientWMin=S$A,S$k._gradientWMax=S$B,S$k},S$j}(),S$E=function(){function S$P(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}S$Q(S$P,"laya.d3.core.particleShuriKen.module.GradientColor");var S$a=S$P.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.cloneTo=function(S$a){var S$m=S$a;S$m._type=this._type,this._constant.cloneTo(S$m._constant),this._constantMin.cloneTo(S$m._constantMin),this._constantMax.cloneTo(S$m._constantMax),this._gradient.cloneTo(S$m._gradient),this._gradientMin.cloneTo(S$m._gradientMin),this._gradientMax.cloneTo(S$m._gradientMax)},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$a,"gradient",function(){return this._gradient}),S$q(0,S$a,"constant",function(){return this._constant}),S$q(0,S$a,"type",function(){return this._type}),S$q(0,S$a,"gradientMin",function(){return this._gradientMin}),S$q(0,S$a,"constantMin",function(){return this._constantMin}),S$q(0,S$a,"gradientMax",function(){return this._gradientMax}),S$q(0,S$a,"constantMax",function(){return this._constantMax}),S$P.createByConstant=function(S$a){var S$m=new S$P;return S$m._type=0,S$m._constant=S$a,S$m},S$P.createByGradient=function(S$a){var S$m=new S$P;return S$m._type=1,S$m._gradient=S$a,S$m},S$P.createByRandomTwoConstant=function(S$a,S$m){var S$s=new S$P;return S$s._type=2,S$s._constantMin=S$a,S$s._constantMax=S$m,S$s},S$P.createByRandomTwoGradient=function(S$a,S$m){var S$s=new S$P;return S$s._type=3,S$s._gradientMin=S$a,S$s._gradientMax=S$m,S$s},S$P}(),S$i=(function(){function S$a(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}S$Q(S$a,"laya.d3.core.particleShuriKen.module.GradientDataColor");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.addAlpha=function(S$a,S$m){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==S$a&&(S$a=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=S$a,this._alphaElements[this._alphaCurrentLength++]=S$m):DEBUG},S$m.addRGB=function(S$a,S$m){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==S$a&&(S$a=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=S$a,this._rgbElements[this._rgbCurrentLength++]=S$m.x,this._rgbElements[this._rgbCurrentLength++]=S$m.y,this._rgbElements[this._rgbCurrentLength++]=S$m.z):DEBUG},S$m.cloneTo=function(S$a){var S$m=S$a,S$s=0,S$P=0;S$m._alphaCurrentLength=this._alphaCurrentLength;var S$_=S$m._alphaElements;for(S$_.length=this._alphaElements.length,S$s=0,S$P=this._alphaElements.length;S$s<S$P;S$s++)S$_[S$s]=this._alphaElements[S$s];S$m._rgbCurrentLength=this._rgbCurrentLength;var S$e=S$m._rgbElements;for(S$e.length=this._rgbElements.length,S$s=0,S$P=this._rgbElements.length;S$s<S$P;S$s++)S$e[S$s]=this._rgbElements[S$s]},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),S$q(0,S$m,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function S$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}S$Q(S$a,"laya.d3.core.particleShuriKen.module.GradientDataInt");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.add=function(S$a,S$m){this._currentLength<8?(6===this._currentLength&&1!==S$a&&(S$a=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=S$a,this._elements[this._currentLength++]=S$m):console.log("Warning:data count must lessEqual than 4")},S$m.cloneTo=function(S$a){var S$m=S$a;S$m._currentLength=this._currentLength;var S$s=S$m._elements;S$s.length=this._elements.length;for(var S$P=0,S$_=this._elements.length;S$P<S$_;S$P++)S$s[S$P]=this._elements[S$P]},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"gradientCount",function(){return this._currentLength/2})}(),function(){function S$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}S$Q(S$a,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.add=function(S$a,S$m){this._currentLength<8?(6===this._currentLength&&1!==S$a&&(S$a=1,DEBUG),this._elements[this._currentLength++]=S$a,this._elements[this._currentLength++]=S$m):DEBUG},S$m.getKeyByIndex=function(S$a){return this._elements[2*S$a]},S$m.getValueByIndex=function(S$a){return this._elements[2*S$a+1]},S$m.getAverageValue=function(){for(var S$a=0,S$m=this._currentLength-2;S$a<S$m;S$a+=2){this._elements[S$a+1];this._elements[S$a+3],this._elements[S$a+2]-this._elements[S$a]}return 0},S$m.cloneTo=function(S$a){var S$m=S$a;S$m._currentLength=this._currentLength;var S$s=S$m._elements;S$s.length=this._elements.length;for(var S$P=0,S$_=this._elements.length;S$P<S$_;S$P++)S$s[S$P]=this._elements[S$P]},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"gradientCount",function(){return this._currentLength/2})}(),function(){function S$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}S$Q(S$a,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.add=function(S$a,S$m){this._currentLength<8?(6===this._currentLength&&1!==S$a&&(S$a=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=S$a,this._elements[this._currentLength++]=S$m.x,this._elements[this._currentLength++]=S$m.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},S$m.cloneTo=function(S$a){var S$m=S$a;S$m._currentLength=this._currentLength;var S$s=S$m._elements;S$s.length=this._elements.length;for(var S$P=0,S$_=this._elements.length;S$P<S$_;S$P++)S$s[S$P]=this._elements[S$P]},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"gradientCount",function(){return this._currentLength/3})}(),function(){function S$B(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}S$Q(S$B,"laya.d3.core.particleShuriKen.module.GradientSize");var S$a=S$B.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.getMaxSizeInGradient=function(){var S$a=0,S$m=0,S$s=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(S$a=0,S$m=this._gradientX.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientX.getValueByIndex(S$a));for(S$a=0,S$m=this._gradientY.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientY.getValueByIndex(S$a))}else for(S$a=0,S$m=this._gradient.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradient.getValueByIndex(S$a));break;case 1:S$s=this._separateAxes?(S$s=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),S$s=Math.max(S$s,this._constantMinSeparate.y),Math.max(S$s,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(S$a=0,S$m=this._gradientXMin.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientXMin.getValueByIndex(S$a));for(S$a=0,S$m=this._gradientXMax.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientXMax.getValueByIndex(S$a));for(S$a=0,S$m=this._gradientYMin.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientYMin.getValueByIndex(S$a));for(S$a=0,S$m=this._gradientZMax.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientZMax.getValueByIndex(S$a))}else{for(S$a=0,S$m=this._gradientMin.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientMin.getValueByIndex(S$a));for(S$a=0,S$m=this._gradientMax.gradientCount;S$a<S$m;S$a++)S$s=Math.max(S$s,this._gradientMax.getValueByIndex(S$a))}}return S$s},S$a.cloneTo=function(S$a){var S$m=S$a;S$m._type=this._type,S$m._separateAxes=this._separateAxes,this._gradient.cloneTo(S$m._gradient),this._gradientX.cloneTo(S$m._gradientX),this._gradientY.cloneTo(S$m._gradientY),this._gradientZ.cloneTo(S$m._gradientZ),S$m._constantMin=this._constantMin,S$m._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(S$m._constantMinSeparate),this._constantMaxSeparate.cloneTo(S$m._constantMaxSeparate),this._gradientMin.cloneTo(S$m._gradientMin),this._gradientMax.cloneTo(S$m._gradientMax),this._gradientXMin.cloneTo(S$m._gradientXMin),this._gradientXMax.cloneTo(S$m._gradientXMax),this._gradientYMin.cloneTo(S$m._gradientYMin),this._gradientYMax.cloneTo(S$m._gradientYMax),this._gradientZMin.cloneTo(S$m._gradientZMin),this._gradientZMax.cloneTo(S$m._gradientZMax)},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$a,"gradientZ",function(){return this._gradientZ}),S$q(0,S$a,"gradient",function(){return this._gradient}),S$q(0,S$a,"separateAxes",function(){return this._separateAxes}),S$q(0,S$a,"type",function(){return this._type}),S$q(0,S$a,"gradientMin",function(){return this._gradientMin}),S$q(0,S$a,"constantMin",function(){return this._constantMin}),S$q(0,S$a,"gradientX",function(){return this._gradientX}),S$q(0,S$a,"gradientY",function(){return this._gradientY}),S$q(0,S$a,"gradientMax",function(){return this._gradientMax}),S$q(0,S$a,"constantMax",function(){return this._constantMax}),S$q(0,S$a,"constantMinSeparate",function(){return this._constantMinSeparate}),S$q(0,S$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),S$q(0,S$a,"gradientXMin",function(){return this._gradientXMin}),S$q(0,S$a,"gradientXMax",function(){return this._gradientXMax}),S$q(0,S$a,"gradientYMin",function(){return this._gradientYMin}),S$q(0,S$a,"gradientYMax",function(){return this._gradientYMax}),S$q(0,S$a,"gradientZMin",function(){return this._gradientZMin}),S$q(0,S$a,"gradientZMax",function(){return this._gradientZMax}),S$B.createByGradient=function(S$a){var S$m=new S$B;return S$m._type=0,S$m._separateAxes=!1,S$m._gradient=S$a,S$m},S$B.createByGradientSeparate=function(S$a,S$m,S$s){var S$P=new S$B;return S$P._type=0,S$P._separateAxes=!0,S$P._gradientX=S$a,S$P._gradientY=S$m,S$P._gradientZ=S$s,S$P},S$B.createByRandomTwoConstant=function(S$a,S$m){var S$s=new S$B;return S$s._type=1,S$s._separateAxes=!1,S$s._constantMin=S$a,S$s._constantMax=S$m,S$s},S$B.createByRandomTwoConstantSeparate=function(S$a,S$m){var S$s=new S$B;return S$s._type=1,S$s._separateAxes=!0,S$s._constantMinSeparate=S$a,S$s._constantMaxSeparate=S$m,S$s},S$B.createByRandomTwoGradient=function(S$a,S$m){var S$s=new S$B;return S$s._type=2,S$s._separateAxes=!1,S$s._gradientMin=S$a,S$s._gradientMax=S$m,S$s},S$B.createByRandomTwoGradientSeparate=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=new S$B;return S$A._type=2,S$A._separateAxes=!0,S$A._gradientXMin=S$a,S$A._gradientXMax=S$m,S$A._gradientYMin=S$s,S$A._gradientYMax=S$P,S$A._gradientZMin=S$_,S$A._gradientZMax=S$e,S$A},S$B}()),S$t=function(){function S$B(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}S$Q(S$B,"laya.d3.core.particleShuriKen.module.GradientVelocity");var S$a=S$B.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.cloneTo=function(S$a){var S$m=S$a;S$m._type=this._type,this._constant.cloneTo(S$m._constant),this._gradientX.cloneTo(S$m._gradientX),this._gradientY.cloneTo(S$m._gradientY),this._gradientZ.cloneTo(S$m._gradientZ),this._constantMin.cloneTo(S$m._constantMin),this._constantMax.cloneTo(S$m._constantMax),this._gradientXMin.cloneTo(S$m._gradientXMin),this._gradientXMax.cloneTo(S$m._gradientXMax),this._gradientYMin.cloneTo(S$m._gradientYMin),this._gradientYMax.cloneTo(S$m._gradientYMax),this._gradientZMin.cloneTo(S$m._gradientZMin),this._gradientZMax.cloneTo(S$m._gradientZMax)},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$a,"gradientZ",function(){return this._gradientZ}),S$q(0,S$a,"constant",function(){return this._constant}),S$q(0,S$a,"type",function(){return this._type}),S$q(0,S$a,"gradientXMax",function(){return this._gradientXMax}),S$q(0,S$a,"constantMin",function(){return this._constantMin}),S$q(0,S$a,"gradientX",function(){return this._gradientX}),S$q(0,S$a,"gradientY",function(){return this._gradientY}),S$q(0,S$a,"gradientXMin",function(){return this._gradientXMin}),S$q(0,S$a,"constantMax",function(){return this._constantMax}),S$q(0,S$a,"gradientYMin",function(){return this._gradientYMin}),S$q(0,S$a,"gradientYMax",function(){return this._gradientYMax}),S$q(0,S$a,"gradientZMin",function(){return this._gradientZMin}),S$q(0,S$a,"gradientZMax",function(){return this._gradientZMax}),S$B.createByConstant=function(S$a){var S$m=new S$B;return S$m._type=0,S$m._constant=S$a,S$m},S$B.createByGradient=function(S$a,S$m,S$s){var S$P=new S$B;return S$P._type=1,S$P._gradientX=S$a,S$P._gradientY=S$m,S$P._gradientZ=S$s,S$P},S$B.createByRandomTwoConstant=function(S$a,S$m){var S$s=new S$B;return S$s._type=2,S$s._constantMin=S$a,S$s._constantMax=S$m,S$s},S$B.createByRandomTwoGradient=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=new S$B;return S$A._type=3,S$A._gradientXMin=S$a,S$A._gradientXMax=S$m,S$A._gradientYMin=S$s,S$A._gradientYMax=S$P,S$A._gradientZMin=S$_,S$A._gradientZMax=S$e,S$A},S$B}(),S$L=(function(){function S$a(S$a){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=S$a}S$Q(S$a,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.cloneTo=function(S$a){var S$m=S$a;this._angularVelocity.cloneTo(S$m._angularVelocity),S$m.enbale=this.enbale},S$m.clone=function(){var S$a;switch(this._angularVelocity.type){case 0:S$a=this._angularVelocity.separateAxes?S$X.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):S$X.createByConstant(this._angularVelocity.constant);break;case 1:S$a=this._angularVelocity.separateAxes?S$X.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):S$X.createByGradient(this._angularVelocity.gradient.clone());break;case 2:S$a=this._angularVelocity.separateAxes?S$X.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):S$X.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:S$a=this._angularVelocity.separateAxes?S$X.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):S$X.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var S$m=new this.constructor(S$a);return S$m.enbale=this.enbale,S$m},S$q(0,S$m,"angularVelocity",function(){return this._angularVelocity})}(),function(){function S$a(){this.enable=!1,this.randomDirection=!1}S$Q(S$a,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m._getShapeBoundBox=function(S$a){throw new Error("BaseShape: must override it.")},S$m._getSpeedBoundBox=function(S$a){throw new Error("BaseShape: must override it.")},S$m.generatePositionAndDirection=function(S$a,S$m,S$s,S$P){throw new Error("BaseShape: must override it.")},S$m._calculateProceduralBounds=function(S$a,S$m,S$s){this._getShapeBoundBox(S$a);var S$P=S$a.min,S$_=S$a.max;S$Am.multiply(S$P,S$m,S$P),S$Am.multiply(S$_,S$m,S$_);var S$e=new S$Ta(new S$Am,new S$Am);this.randomDirection?(S$e.min=new S$Am(-1,-1,-1),S$e.max=new S$Am(1,1,1)):this._getSpeedBoundBox(S$e);var S$A=new S$Ta(new S$Am,new S$Am),S$B=S$A.min,S$k=S$A.max;S$Am.scale(S$e.min,S$s.y,S$B),S$Am.scale(S$e.max,S$s.y,S$k),S$Am.add(S$a.min,S$B,S$B),S$Am.add(S$a.max,S$k,S$k),S$Am.min(S$a.min,S$B,S$a.min),S$Am.max(S$a.max,S$B,S$a.max);var S$j=new S$Ta(new S$Am,new S$Am),S$G=S$j.min,S$y=S$j.max;S$Am.scale(S$e.min,S$s.x,S$G),S$Am.scale(S$e.max,S$s.x,S$y),S$Am.min(S$j.min,S$y,S$B),S$Am.max(S$j.min,S$y,S$k),S$Am.min(S$a.min,S$B,S$a.min),S$Am.max(S$a.max,S$B,S$a.max)},S$m.cloneTo=function(S$a){S$a.enable=this.enable},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$a}()),S$J=function(){function S$e(){}return S$Q(S$e,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),S$e._randomPointUnitArcCircle=function(S$a,S$m,S$s){var S$P=S$m.elements,S$_=NaN;S$_=S$s?S$s.getFloat()*S$a:Math.random()*S$a,S$P[0]=Math.cos(S$_),S$P[1]=Math.sin(S$_)},S$e._randomPointInsideUnitArcCircle=function(S$a,S$m,S$s){var S$P=S$m.elements;S$e._randomPointUnitArcCircle(S$a,S$m,S$s);var S$_=NaN;S$_=S$s?Math.pow(S$s.getFloat(),.5):Math.pow(Math.random(),.5),S$P[0]=S$P[0]*S$_,S$P[1]=S$P[1]*S$_},S$e._randomPointUnitCircle=function(S$a,S$m){var S$s=S$a.elements,S$P=NaN;S$P=S$m?S$m.getFloat()*Math.PI*2:Math.random()*Math.PI*2,S$s[0]=Math.cos(S$P),S$s[1]=Math.sin(S$P)},S$e._randomPointInsideUnitCircle=function(S$a,S$m){var S$s=S$a.elements;S$e._randomPointUnitCircle(S$a);var S$P=NaN;S$P=S$m?Math.pow(S$m.getFloat(),.5):Math.pow(Math.random(),.5),S$s[0]=S$s[0]*S$P,S$s[1]=S$s[1]*S$P},S$e._randomPointUnitSphere=function(S$a,S$m){var S$s=S$a.elements,S$P=NaN,S$_=NaN;S$_=S$m?(S$P=S$s[2]=2*S$m.getFloat()-1,S$m.getFloat()*Math.PI*2):(S$P=S$s[2]=2*Math.random()-1,Math.random()*Math.PI*2);var S$e=Math.sqrt(1-S$P*S$P);S$s[0]=S$e*Math.cos(S$_),S$s[1]=S$e*Math.sin(S$_)},S$e._randomPointInsideUnitSphere=function(S$a,S$m){var S$s=S$a.elements;S$e._randomPointUnitSphere(S$a);var S$P=NaN;S$P=S$m?Math.pow(S$m.getFloat(),1/3):Math.pow(Math.random(),1/3),S$s[0]=S$s[0]*S$P,S$s[1]=S$s[1]*S$P,S$s[2]=S$s[2]*S$P},S$e._randomPointInsideHalfUnitBox=function(S$a,S$m){var S$s=S$a.elements;S$m?(S$s[0]=S$m.getFloat()-.5,S$s[1]=S$m.getFloat()-.5,S$s[2]=S$m.getFloat()-.5):(S$s[0]=Math.random()-.5,S$s[1]=Math.random()-.5,S$s[2]=Math.random()-.5)},S$e}(),S$D=(function(){function S$a(S$a){this._size=null,this.enbale=!1,this._size=S$a}S$Q(S$a,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.cloneTo=function(S$a){var S$m=S$a;this._size.cloneTo(S$m._size),S$m.enbale=this.enbale},S$m.clone=function(){var S$a;switch(this._size.type){case 0:S$a=this._size.separateAxes?S$i.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):S$i.createByGradient(this._size.gradient.clone());break;case 1:S$a=this._size.separateAxes?S$i.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):S$i.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:S$a=this._size.separateAxes?S$i.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):S$i.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var S$m=new this.constructor(S$a);return S$m.enbale=this.enbale,S$m},S$q(0,S$m,"size",function(){return this._size})}(),function(){function S$P(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}S$Q(S$P,"laya.d3.core.particleShuriKen.module.StartFrame");var S$a=S$P.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.cloneTo=function(S$a){var S$m=S$a;S$m._type=this._type,S$m._constant=this._constant,S$m._constantMin=this._constantMin,S$m._constantMax=this._constantMax},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$a,"constant",function(){return this._constant}),S$q(0,S$a,"type",function(){return this._type}),S$q(0,S$a,"constantMin",function(){return this._constantMin}),S$q(0,S$a,"constantMax",function(){return this._constantMax}),S$P.createByConstant=function(S$a){var S$m=new S$P;return S$m._type=0,S$m._constant=S$a,S$m},S$P.createByRandomTwoConstant=function(S$a,S$m){var S$s=new S$P;return S$s._type=1,S$s._constantMin=S$a,S$s._constantMax=S$m,S$s},S$P}()),S$g=(function(){function S$a(S$a,S$m){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new S$em(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=S$a,this._startFrame=S$m}S$Q(S$a,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.cloneTo=function(S$a){var S$m=S$a;this.tiles.cloneTo(S$m.tiles),S$m.type=this.type,S$m.randomRow=this.randomRow,this._frame.cloneTo(S$m._frame),this._startFrame.cloneTo(S$m._startFrame),S$m.cycles=this.cycles,S$m.enableUVChannels=this.enableUVChannels,S$m.enable=this.enable},S$m.clone=function(){var S$a,S$m;switch(this._frame.type){case 0:S$a=S$Z.createByConstant(this._frame.constant);break;case 1:S$a=S$Z.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:S$a=S$Z.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:S$a=S$Z.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:S$m=S$D.createByConstant(this._startFrame.constant);break;case 1:S$m=S$D.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var S$s=new this.constructor(S$a,S$m);return this.tiles.cloneTo(S$s.tiles),S$s.type=this.type,S$s.randomRow=this.randomRow,S$s.cycles=this.cycles,S$s.enableUVChannels=this.enableUVChannels,S$s.enable=this.enable,S$s},S$q(0,S$m,"frame",function(){return this._frame}),S$q(0,S$m,"startFrame",function(){return this._startFrame})}(),function(){function S$a(S$a){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=S$a}S$Q(S$a,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.cloneTo=function(S$a){var S$m=S$a;this._velocity.cloneTo(S$m._velocity),S$m.enbale=this.enbale,S$m.space=this.space},S$m.clone=function(){var S$a;switch(this._velocity.type){case 0:S$a=S$t.createByConstant(this._velocity.constant.clone());break;case 1:S$a=S$t.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:S$a=S$t.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:S$a=S$t.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var S$m=new this.constructor(S$a);return S$m.enbale=this.enbale,S$m.space=this.space,S$m},S$q(0,S$m,"velocity",function(){return this._velocity})}(),function(){function S$a(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new S$dm,this._vb=S$Lm.create(S$a._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=S$tm.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=S$Em.nameKey.getID("LINE"),this._shaderCompile=S$Um._preCompileShader[this._sharderNameID]}S$Q(S$a,"laya.d3.core.PhasorSpriter3D");var S$m=S$a.prototype;return S$m.line=function(S$a,S$m,S$s,S$P){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(S$a.x,S$a.y,S$a.z,S$m.x,S$m.y,S$m.z,S$m.w),this.addVertex(S$s.x,S$s.y,S$s.z,S$P.x,S$P.y,S$P.z,S$P.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},S$m.circle=function(S$a,S$m,S$s,S$P,S$_,S$e){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*S$m,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/S$m,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*S$a,Math.cos(this._tempNumver0)*S$a,0,S$s,S$P,S$_,S$e),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},S$m.plane=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=S$P/2,this._tempNumver1=S$_/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(S$a-this._tempNumver0,S$m+this._tempNumver1,S$s,S$e,S$A,S$B,S$k),this.addVertex(S$a+this._tempNumver0,S$m+this._tempNumver1,S$s,S$e,S$A,S$B,S$k),this.addVertex(S$a-this._tempNumver0,S$m-this._tempNumver1,S$s,S$e,S$A,S$B,S$k),this.addVertex(S$a+this._tempNumver0,S$m-this._tempNumver1,S$s,S$e,S$A,S$B,S$k),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},S$m.box=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=S$P/2,this._tempNumver1=S$_/2,this._tempNumver2=S$e/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(S$a-this._tempNumver0,S$m+this._tempNumver1,S$s+this._tempNumver2,S$A,S$B,S$k,S$j),this.addVertex(S$a+this._tempNumver0,S$m+this._tempNumver1,S$s+this._tempNumver2,S$A,S$B,S$k,S$j),this.addVertex(S$a-this._tempNumver0,S$m-this._tempNumver1,S$s+this._tempNumver2,S$A,S$B,S$k,S$j),this.addVertex(S$a+this._tempNumver0,S$m-this._tempNumver1,S$s+this._tempNumver2,S$A,S$B,S$k,S$j),this.addVertex(S$a+this._tempNumver0,S$m+this._tempNumver1,S$s-this._tempNumver2,S$A,S$B,S$k,S$j),this.addVertex(S$a-this._tempNumver0,S$m+this._tempNumver1,S$s-this._tempNumver2,S$A,S$B,S$k,S$j),this.addVertex(S$a+this._tempNumver0,S$m-this._tempNumver1,S$s-this._tempNumver2,S$A,S$B,S$k,S$j),this.addVertex(S$a-this._tempNumver0,S$m-this._tempNumver1,S$s-this._tempNumver2,S$A,S$B,S$k,S$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},S$m.cone=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*S$s+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*S$s>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/S$s,this.addVertexIndex(0,S$m,0,S$P,S$_,S$e,S$A,this._tempUint0),this.addVertexIndex(0,0,0,S$P,S$_,S$e,S$A,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<S$s;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(S$a*this._tempNumver2,0,S$a*this._tempNumver3,S$P,S$_,S$e,S$A,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==S$s-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(S$a*this._tempNumver2,0,S$a*this._tempNumver3,S$P,S$_,S$e,S$A,this._tempUint0+(this._tempInt0+S$s)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==S$s-1?this.addIndexes(this._tempUint1+S$s+2):this.addIndexes(this._tempUint1+this._tempInt0+S$s+1),this.addIndexes(this._tempUint1+this._tempInt0+S$s),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},S$m.boundingBoxLine=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(S$a,S$_,S$e,S$A,S$B,S$k,S$j),this.addVertex(S$P,S$_,S$e,S$A,S$B,S$k,S$j),this.addVertex(S$a,S$m,S$e,S$A,S$B,S$k,S$j),this.addVertex(S$P,S$m,S$e,S$A,S$B,S$k,S$j),this.addVertex(S$P,S$_,S$s,S$A,S$B,S$k,S$j),this.addVertex(S$a,S$_,S$s,S$A,S$B,S$k,S$j),this.addVertex(S$P,S$m,S$s,S$A,S$B,S$k,S$j),this.addVertex(S$a,S$m,S$s,S$A,S$B,S$k,S$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},S$m.addVertex=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=S$a,this._vbData[this._posInVBData+1]=S$m,this._vbData[this._posInVBData+2]=S$s,this._vbData[this._posInVBData+3]=S$P,this._vbData[this._posInVBData+4]=S$_,this._vbData[this._posInVBData+5]=S$e,this._vbData[this._posInVBData+6]=S$A,this._posInVBData+=this._floatSizePerVer,this},S$m.addVertexIndex=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){return this._hasBegun||this.addVertexIndexException(),this._vbData[S$B]=S$a,this._vbData[S$B+1]=S$m,this._vbData[S$B+2]=S$s,this._vbData[S$B+3]=S$P,this._vbData[S$B+4]=S$_,this._vbData[S$B+5]=S$e,this._vbData[S$B+6]=S$A,(S$B+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=S$B),this},S$m.addIndexes=function(S$a){var S$m=arguments;this._hasBegun||this.addVertexIndexException();for(var S$s=0;S$s<S$m.length;S$s++)this._ibData[this._posInIBData]=S$m[S$s],this._posInIBData++;return this},S$m.begin=function(S$a,S$m){return this._hasBegun&&this.beginException0(),1!==S$a&&4!==S$a&&this.beginException1(),this._primitiveType=S$a,this._camera=S$m,this._hasBegun=!0,this},S$m.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},S$m.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(S$a._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),S$U.drawCall++,S$V.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},S$m.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},S$m.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},S$m.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},S$m.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},S$m.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},S$m.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(28,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector4",1)])}]),S$a}()),S$w=function(){function S$a(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++S$a._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new S$dm}S$Q(S$a,"laya.d3.core.render.RenderElement");var S$m=S$a.prototype;return S$m.getDynamicBatchBakedVertexs=function(S$a){for(var S$m=this._renderObj._getVertexBuffer(S$a),S$s=S$m.getData().slice(),S$P=S$m.vertexDeclaration,S$_=S$P.getVertexElementByUsage(0).offset/4,S$e=S$P.getVertexElementByUsage(3).offset/4,S$A=this._sprite3D.transform,S$B=S$A.worldMatrix,S$k=S$A.rotation,S$j=S$P.vertexStride/4,S$G=0,S$y=S$s.length;S$G<S$y;S$G+=S$j){var S$d=S$G+S$_,S$Q=S$G+S$e;S$um.transformVector3ArrayToVector3ArrayCoordinate(S$s,S$d,S$B,S$s,S$d),S$um.transformVector3ArrayByQuat(S$s,S$Q,S$k,S$s,S$Q)}return S$s},S$m.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},S$m._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},S$q(0,S$m,"id",function(){return this._id}),S$q(0,S$m,"renderObj",function(){return this._renderObj},function(S$a){this._renderObj!==S$a&&(this._renderObj=S$a)}),S$a._uniqueIDCounter=0,S$a}(),S$v=function(){function S$m(S$a){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++S$m._uniqueIDCounter,this._needSort=!1,this._scene=S$a,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}S$Q(S$m,"laya.d3.core.render.RenderQueue");var S$a=S$m.prototype;return S$a._sortOpaqueFunc=function(S$a,S$m){if(S$a._render&&S$m._render){var S$s=S$a._material.renderQueue-S$m._material.renderQueue;return 0==S$s?S$a._render._distanceForSort-S$m._render._distanceForSort:S$s}return 0},S$a._sortAlphaFunc=function(S$a,S$m){if(S$a._render&&S$m._render){var S$s=S$a._material.renderQueue-S$m._material.renderQueue;return 0==S$s?S$m._render._distanceForSort-S$a._render._distanceForSort:S$s}return 0},S$a._begainRenderElement=function(S$a,S$m,S$s){return!!S$m._beforeRender(S$a)},S$a._sortAlpha=function(S$a){S$m._cameraPosition=S$a,this._finalElements.sort(this._sortAlphaFunc)},S$a._sortOpaque=function(S$a){S$m._cameraPosition=S$a,this._finalElements.sort(this._sortOpaqueFunc)},S$a._preRender=function(S$a){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},S$a._render=function(S$a,S$m){for(var S$s,S$P,S$_,S$e,S$A,S$B,S$k=S$U.loopCount,S$j=this._scene,S$G=S$a.camera,S$y=(S$G.id,!1),S$d=0,S$Q=this._finalElements.length;S$d<S$Q;S$d++){var S$q,S$h,S$u,S$O=this._finalElements[S$d];if(null!=S$O._onPreRenderFunction&&S$O._onPreRenderFunction.call(S$O._sprite3D,S$a),0===S$O._type){if(S$a.owner=S$u=S$O._sprite3D,S$a.renderElement=S$O,S$u._preRenderUpdateComponents(S$a),S$q=S$O.renderObj,S$h=S$O._material,this._begainRenderElement(S$a,S$q,S$h)){if(S$s=S$q._getVertexBuffers(),!(S$_=(S$P=S$q._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[S$P.id]){this._errorRecord[S$P.id]=1;var S$p="vertexBuffer:"+("("+S$P._destroyed+","+S$P._released+","+S$P._referenceCount+","+S$P._buffer+")")+", material:"+(S$h?S$h.__className+"("+S$h._destroyed+","+S$h._released+")":"null")+", owner:"+(S$u?S$u.__className+"("+S$u._destroyed+","+S$u._activeInHierarchy+","+S$u._displayedInStage+")":"null")+", renderObj:"+(S$q?S$q.__className+"("+S$q._destroyed+","+S$q._released+","+S$q._referenceCount+")":"")+", parent:, url:"+(S$u?S$u.url:"")+", disposeStack:"+S$P.disposeStack;S$o.recordError("报错：unknown vertexDeclaration  "+S$p)}continue}if(S$y=(S$e=S$a._shader=S$h._getShader(S$j._shaderDefineValue,S$_.shaderDefineValue,S$u._shaderDefineValue)).bind()||S$k!==S$e._uploadLoopCount,S$s){if(S$e._uploadVertexBuffer!==S$s||S$y){for(var S$c=0;S$c<S$s.length;S$c++){var S$H=S$s[S$c];S$e.uploadAttributesX(S$H.vertexDeclaration.shaderValues.data,S$H)}S$e._uploadVertexBuffer=S$s}}else(S$e._uploadVertexBuffer!==S$P||S$y)&&(S$e.uploadAttributes(S$_.shaderValues.data,null),S$e._uploadVertexBuffer=S$P);(S$e._uploadScene!==S$j||S$y)&&(S$e.uploadSceneUniforms(S$j._shaderValues.data),S$e._uploadScene=S$j),(S$G!==S$e._uploadCamera||S$e._uploadSprite3D!==S$u||S$y)&&(S$e.uploadSpriteUniforms(S$u._shaderValues.data),S$e._uploadSprite3D=S$u),(S$G!==S$e._uploadCamera||S$y)&&(S$e.uploadCameraUniforms(S$G._shaderValues.data),S$e._uploadCamera=S$G),(S$e._uploadMaterial!==S$h||S$y)&&(S$h._upload(),S$e._uploadMaterial=S$h),S$A!==S$h?(S$h._setRenderStateBlendDepth(),S$h._setRenderStateFrontFace(S$m,S$u.transform),S$A=S$h,S$B=S$u):S$B!==S$u&&(S$h._setRenderStateFrontFace(S$m,S$u.transform),S$B=S$u),S$q._render(S$a),S$e._uploadLoopCount=S$k}S$u._postRenderUpdateComponents(S$a)}else if(2===S$O._type){S$O.renderObj;S$a.owner=S$u=S$O._sprite3D,S$a.renderElement=S$O,S$a._batchIndexStart=S$O._tempBatchIndexStart,S$a._batchIndexEnd=S$O._tempBatchIndexEnd,S$q=S$O.renderObj,S$h=S$O._material,this._begainRenderElement(S$a,S$q,S$h)&&(S$_=(S$P=S$q._getVertexBuffer(0)).vertexDeclaration,S$y=(S$e=S$a._shader=S$h._getShader(S$j._shaderDefineValue,S$_.shaderDefineValue,S$u._shaderDefineValue)).bind()||S$k!==S$e._uploadLoopCount,(S$e._uploadVertexBuffer!==S$P||S$y)&&(S$e.uploadAttributes(S$_.shaderValues.data,null),S$e._uploadVertexBuffer=S$P),(S$e._uploadScene!==S$j||S$y)&&(S$e.uploadSceneUniforms(S$j._shaderValues.data),S$e._uploadScene=S$j),(S$G!==S$e._uploadCamera||S$e._uploadSprite3D!==S$u||S$y)&&(S$e.uploadSpriteUniforms(S$u._shaderValues.data),S$e._uploadSprite3D=S$u),(S$G!==S$e._uploadCamera||S$y)&&(S$e.uploadCameraUniforms(S$G._shaderValues.data),S$e._uploadCamera=S$G),(S$e._uploadMaterial!==S$h||S$y)&&(S$h._upload(),S$e._uploadMaterial=S$h),S$A!==S$h?(S$h._setRenderStateBlendDepth(),S$h._setRenderStateFrontFace(S$m,S$u.transform),S$A=S$h,S$B=S$u):S$B!==S$u&&(S$h._setRenderStateFrontFace(S$m,S$u.transform),S$B=S$u),S$q._render(S$a),S$e._uploadLoopCount=S$k)}}},S$a._renderShadow=function(S$a,S$m){for(var S$s,S$P,S$_,S$e,S$A,S$B=S$U.loopCount,S$k=this._scene,S$j=S$a.camera,S$G=!1,S$y=0,S$d=this._finalElements.length;S$y<S$d;S$y++){var S$Q,S$q,S$h,S$u=this._finalElements[S$y];0===S$u._type&&(S$a.owner=S$h=S$u._sprite3D,S$m||S$h._projectionViewWorldUpdateCamera===S$j&&S$h._projectionViewWorldUpdateLoopCount===S$U.loopCount||(S$h._render._renderUpdate(S$a._projectionViewMatrix),S$h._projectionViewWorldUpdateLoopCount=S$U.loopCount,S$h._projectionViewWorldUpdateCamera=S$j),S$a.renderElement=S$u,S$h._preRenderUpdateComponents(S$a),S$Q=S$u.renderObj,S$q=S$u._material,this._begainRenderElement(S$a,S$Q,null)&&(S$P=(S$s=S$Q._getVertexBuffer(0)).vertexDeclaration,S$G=(S$_=S$a._shader=S$q._getShader(S$k._shaderDefineValue,S$P.shaderDefineValue,S$h._shaderDefineValue)).bind()||S$B!==S$_._uploadLoopCount,(S$_._uploadVertexBuffer!==S$s||S$G)&&(S$_.uploadAttributes(S$P.shaderValues.data,null),S$_._uploadVertexBuffer=S$s),(S$j!==S$_._uploadCamera||S$_._uploadSprite3D!==S$h||S$G)&&(S$_.uploadSpriteUniforms(S$h._shaderValues.data),S$_._uploadSprite3D=S$h),(S$j!==S$_._uploadCamera||S$G)&&(S$_.uploadCameraUniforms(S$j._shaderValues.data),S$_._uploadCamera=S$j),(S$_._uploadMaterial!==S$q||S$G)&&(S$q._upload(),S$_._uploadMaterial=S$q),S$_._uploadRenderElement,S$e!==S$q?(S$q._setRenderStateFrontFace(!1,S$h.transform),S$e=S$q,S$A=S$h):S$A!==S$h&&(S$q._setRenderStateFrontFace(!1,S$h.transform),S$A=S$h),S$Q._render(S$a),S$_._uploadLoopCount=S$B),S$h._postRenderUpdateComponents(S$a))}},S$a._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},S$a._addRenderElement=function(S$a){this._renderElements.push(S$a),this._needSort=!0},S$a._addDynamicBatchElement=function(S$a){this._dynamicBatchCombineRenderElements.push(S$a)},S$q(0,S$a,"id",function(){return this._id}),S$m._uniqueIDCounter=0,S$m._cameraPosition=null,S$m}(),S$Y=function(){function S$a(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return S$Q(S$a,"laya.d3.core.render.RenderState"),S$a.clientWidth=0,S$a.clientHeight=0,S$a}(),S$T=function(){function S$A(S$a,S$m){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new S$$a(new S$Am,0),this._corners=[new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am],this._boundingBoxCenter=new S$Am,this._children=S$P(8),this._objects=[],this._tempBoundBoxCorners=[new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am],this._scene=S$a,this._currentDepth=S$m}S$Q(S$A,"laya.d3.core.scene.OctreeNode");var S$a=S$A.prototype;return S$o.imps(S$a,{"laya.d3.core.scene.ITreeNode":!0}),S$a.init=function(S$a,S$m){var S$s=new S$Am,S$P=new S$Am;S$Am.scale(S$m,-.5,S$s),S$Am.scale(S$m,.5,S$P),S$Am.add(S$s,S$a,S$s),S$Am.add(S$P,S$a,S$P),this.exactBox=new S$Ta(S$s,S$P),this.relaxBox=new S$Ta(S$s,S$P)},S$a.addTreeNode=function(S$a){1===Collision.boxContainsBox(this._relaxBox,S$a.boundingBox)?this.addNodeDown(S$a,0):this.addObject(S$a)},S$a.addChild=function(S$a){var S$m=this._children[S$a];if(null==S$m){S$m=new S$A(this._scene,this._currentDepth+1),(this._children[S$a]=S$m)._parent=this,S$Am.subtract(this._exactBox.max,this._exactBox.min,S$A.tempSize),S$Am.multiply(S$A.tempSize,S$A._octreeSplit[S$a],S$A.tempCenter),S$Am.add(this._exactBox.min,S$A.tempCenter,S$A.tempCenter),S$Am.scale(S$A.tempSize,.25,S$A.tempSize);var S$s=new S$Am,S$P=new S$Am;S$Am.subtract(S$A.tempCenter,S$A.tempSize,S$s),S$Am.add(S$A.tempCenter,S$A.tempSize,S$P),S$m.exactBox=new S$Ta(S$s,S$P),S$Am.scale(S$A.tempSize,S$A.relax,S$A.tempSize);var S$_=new S$Am,S$e=new S$Am;S$Am.subtract(S$A.tempCenter,S$A.tempSize,S$_),S$Am.add(S$A.tempCenter,S$A.tempSize,S$e),S$m.relaxBox=new S$Ta(S$_,S$e)}return S$m},S$a.addObject=function(S$a){(S$a._treeNode=this)._objects.push(S$a)},S$a.removeObject=function(S$a){if(S$a._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var S$m=this._objects.indexOf(S$a);return-1!==S$m&&(this._objects.splice(S$m,1),!0)},S$a.clearObject=function(){this._objects.length=0},S$a.addNodeUp=function(S$a,S$m){this._parent&&1!==Collision.boxContainsBox(this._exactBox,S$a.boundingBox)?this._parent.addNodeUp(S$a,S$m-1):this.addNodeDown(S$a,S$m)},S$a.addNodeDown=function(S$a,S$m){if(S$m<this._scene.treeLevel){var S$s=this.inChildIndex(S$a.boundingBoxCenter),S$P=this.addChild(S$s);1===Collision.boxContainsBox(S$P._relaxBox,S$a.boundingBox)?S$P.addNodeDown(S$a,++S$m):this.addObject(S$a)}else this.addObject(S$a)},S$a.inChildIndex=function(S$a){return 4*(S$a.z<this._boundingBoxCenter.z?0:1)+2*(S$a.y<this._boundingBoxCenter.y?0:1)+(S$a.x<this._boundingBoxCenter.x?0:1)},S$a.updateObject=function(S$a){1===Collision.boxContainsBox(this._relaxBox,S$a.boundingBox)?(this.removeObject(S$a),S$a._treeNode=null,this.addNodeDown(S$a,this._currentDepth)):this._parent&&(this.removeObject(S$a),S$a._treeNode=null,this._parent.addNodeUp(S$a,this._currentDepth-1))},S$a.cullingObjects=function(S$a,S$m,S$s,S$P,S$_){var S$e,S$A=0,S$B=0,S$k=0,S$j=this._scene._dynamicBatchManager;for(S$A=0,S$e=this._objects.length;S$A<S$e;S$A++){var S$G=this._objects[S$A];if(S$S.isVisible(S$G._owner.layer.mask)&&S$G.enable){if(S$m&&(S$U.treeSpriteCollision+=1,0===S$a.containsBoundSphere(S$G.boundingSphere)))continue;S$G._renderUpdate(S$_),S$G._distanceForSort=S$Am.distance(S$G.boundingSphere.center,S$P)+S$G.sortingFudge;var S$y=S$G._renderElements;for(S$B=0,S$k=S$y.length;S$B<S$k;S$B++){var S$d=S$y[S$B],S$Q=S$d._staticBatch;if(S$Q&&S$Q._material===S$d._material)S$Q._addBatchRenderElement(S$d);else{var S$q=S$d.renderObj;S$q.triangleCount<10&&1===S$q._vertexBufferCount&&S$q._getIndexBuffer()&&S$d._material.renderQueue<2&&S$d._canDynamicBatch&&!S$G._owner.isStatic?S$j._addPrepareRenderElement(S$d):this._scene.getRenderQueue(S$d._material.renderQueue)._addRenderElement(S$d)}}}}for(S$A=0;S$A<8;S$A++){var S$h=this._children[S$A];if(null!=S$h){var S$u=S$m;if(S$m){var S$O=S$a.containsBoundBox(S$h._relaxBox);if(S$U.treeNodeCollision+=1,0===S$O)continue;S$u=2===S$O}S$h.cullingObjects(S$a,S$u,S$s,S$P,S$_)}}},S$a.cullingShadowObjects=function(S$a,S$m,S$s,S$P,S$_){var S$e,S$A=0,S$B=0,S$k=0;this._scene._dynamicBatchManager;for(S$A=0,S$e=this._objects.length;S$A<S$e;S$A++){var S$j=this._objects[S$A];if(S$j.castShadow&&S$S.isVisible(S$j._owner.layer.mask)&&S$j.enable){if(S$s&&0===S$a[0].containsBoundSphere(S$j.boundingSphere))continue;for(var S$G=1,S$y=S$a.length;S$G<S$y;S$G++){var S$d=S$m[S$G-1];if(0!==S$a[S$G].containsBoundSphere(S$j.boundingSphere)){var S$Q=S$j._renderElements;for(S$B=0,S$k=S$Q.length;S$B<S$k;S$B++)S$d._addRenderElement(S$Q[S$B])}}}}for(S$A=0;S$A<8;S$A++){var S$q=this._children[S$A];if(null!=S$q){var S$h=S$s;if(S$s){var S$u=S$a[0].containsBoundBox(S$q._relaxBox);if(0===S$u)continue;S$h=2===S$u}S$q.cullingShadowObjects(S$a,S$m,S$h,S$P,S$_)}}},S$a.cullingShadowObjectsOnePSSM=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A,S$B=S$m[0],S$k=0,S$j=0,S$G=0;for(S$k=0,S$A=this._objects.length;S$k<S$A;S$k++){var S$y=this._objects[S$k];if(S$y.castShadow&&S$S.isVisible(S$y._owner.layer.mask)&&S$y.enable){if(S$P&&0===S$a.containsBoundSphere(S$y.boundingSphere))continue;S$y._renderUpdate(S$s);var S$d=S$y._renderElements;for(S$j=0,S$G=S$d.length;S$j<S$G;S$j++)S$B._addRenderElement(S$d[S$j])}}for(S$k=0;S$k<8;S$k++){var S$Q=this._children[S$k];if(null!=S$Q){var S$q=S$P;if(S$P){var S$h=S$a.containsBoundBox(S$Q._relaxBox);if(0===S$h)continue;S$q=2===S$h}S$Q.cullingShadowObjectsOnePSSM(S$a,S$m,S$s,S$q,S$_,S$e)}}},S$a.renderBoudingBox=function(S$a){this._renderBoudingBox(S$a);for(var S$m=0;S$m<8;++S$m){var S$s=this._children[S$m];S$s&&S$s.renderBoudingBox(S$a)}},S$a.buildAllChild=function(S$a){if(S$a<this._scene.treeLevel)for(var S$m=0;S$m<8;S$m++){this.addChild(S$m).buildAllChild(S$a+1)}},S$a._renderBoudingBox=function(S$a){},S$q(0,S$a,"exactBox",function(){return this._exactBox},function(S$a){this._exactBox=S$a,S$Am.add(S$a.min,S$a.max,this._boundingBoxCenter),S$Am.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),S$q(0,S$a,"relaxBox",function(){return this._relaxBox},function(S$a){(this._relaxBox=S$a).getCorners(this._corners),S$$a.createfromPoints(this._corners,this._boundingSphere)}),S$A.debugMode=!1,S$A.relax=1.15,S$A.CHILDNUM=8,S$y(S$A,["tempVector0",function(){return this.tempVector0=new S$Am},"tempSize",function(){return this.tempSize=new S$Am},"tempCenter",function(){return this.tempCenter=new S$Am},"_octreeSplit",function(){return this._octreeSplit=[new S$Am(.25,.25,.25),new S$Am(.75,.25,.25),new S$Am(.25,.75,.25),new S$Am(.75,.75,.25),new S$Am(.25,.25,.75),new S$Am(.75,.25,.75),new S$Am(.25,.75,.75),new S$Am(.75,.75,.75)]}]),S$A}(),S$I=(function(){function S$a(){}S$Q(S$a,"laya.d3.core.scene.SceneManager")}(),function(){function S$a(S$a,S$m,S$s,S$P){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===S$a&&(S$a=1),void 0===S$m&&(S$m=1),void 0===S$s&&(S$s=1),void 0===S$P&&(S$P=1),this._r=S$a,this._g=S$m,this._b=S$s,this._a=S$P}return S$Q(S$a,"laya.d3.core.trail.module.Color",null,"Color$1"),S$a.prototype.cloneTo=function(S$a){S$a._r=this._r,S$a._g=this._g,S$a._b=this._b,S$a._a=this._a},S$y(S$a,["RED",function(){return this.RED=new S$a(1,0,0,1)},"GREEN",function(){return this.GREEN=new S$a(0,1,0,1)},"BLUE",function(){return this.BLUE=new S$a(0,0,1,1)},"CYAN",function(){return this.CYAN=new S$a(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new S$a(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new S$a(1,0,1,1)},"GRAY",function(){return this.GRAY=new S$a(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new S$a(1,1,1,1)},"BLACK",function(){return this.BLACK=new S$a(0,0,0,1)}]),S$a}()),S$$=(function(){function S$a(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}S$Q(S$a,"laya.d3.core.trail.module.Gradient");var S$m=S$a.prototype;S$m.setKeys=function(S$a,S$m){var S$s,S$P;this._colorKeys=S$a;for(var S$_=this.index=0;S$_<S$a.length;S$_++){var S$e=(S$s=S$a[S$_]).color;this._colorKeyData[this.index++]=S$e._r,this._colorKeyData[this.index++]=S$e._g,this._colorKeyData[this.index++]=S$e._b,this._colorKeyData[this.index++]=S$s.time}this._alphaKeys=S$m;for(var S$A=this.index=0;S$A<S$m.length;S$A++)S$P=S$m[S$A],this._alphaKeyData[this.index++]=S$P.alpha,this._alphaKeyData[this.index++]=S$P.time},S$m.cloneTo=function(S$a){var S$m=0,S$s=0,S$P=this.colorKeys,S$_=[];for(S$m=0,S$s=S$P.length;S$m<S$s;S$m++){var S$e=new S$n;S$P[S$m].cloneTo(S$e),S$_.push(S$e)}var S$A=this.alphaKeys,S$B=[];for(S$m=0,S$s=S$A.length;S$m<S$s;S$m++){var S$k=new S$$;S$A[S$m].cloneTo(S$k),S$B.push(S$k)}S$a.setKeys(S$_,S$B)},S$q(0,S$m,"mode",function(){return this._mode},function(S$a){this._mode=S$a}),S$q(0,S$m,"colorKeys",function(){return this._colorKeys},function(S$a){this._colorKeys=S$a;for(var S$m=this.index=0;S$m<S$a.length;S$m++){var S$s=S$a[S$m],S$P=S$s.color;this._colorKeyData[this.index++]=S$P._r,this._colorKeyData[this.index++]=S$P._g,this._colorKeyData[this.index++]=S$P._b,this._colorKeyData[this.index++]=S$s.time}}),S$q(0,S$m,"alphaKeys",function(){return this._alphaKeys},function(S$a){this._alphaKeys=S$a;for(var S$m=this.index=0;S$m<S$a.length;S$m++){var S$s=S$a[S$m];this._alphaKeyData[this.index++]=S$s.alpha,this._alphaKeyData[this.index++]=S$s.time}})}(),function(){function S$a(S$a,S$m){this._alpha=NaN,this._time=NaN,void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),this._alpha=S$a,this._time=S$m}S$Q(S$a,"laya.d3.core.trail.module.GradientAlphaKey");var S$m=S$a.prototype;return S$m.cloneTo=function(S$a){S$a.alpha=this.alpha,S$a.time=this.time},S$q(0,S$m,"alpha",function(){return this._alpha},function(S$a){this._alpha=S$a}),S$q(0,S$m,"time",function(){return this._time},function(S$a){this._time=S$a}),S$a}()),S$n=function(){function S$a(S$a,S$m){this._color=null,this._time=NaN,void 0===S$m&&(S$m=0),this._color=S$a||new S$I,this._time=S$m}S$Q(S$a,"laya.d3.core.trail.module.GradientColorKey");var S$m=S$a.prototype;return S$m.cloneTo=function(S$a){this.color.cloneTo(S$a.color),S$a.time=this.time},S$q(0,S$m,"color",function(){return this._color},function(S$a){this._color=S$a}),S$q(0,S$m,"time",function(){return this._time},function(S$a){this._time=S$a}),S$a}(),S$r=(function(){function S$a(){}S$Q(S$a,"laya.d3.core.trail.module.GradientMode"),S$a.Blend=0,S$a.Fixed=1}(),function(){function S$a(){}S$Q(S$a,"laya.d3.core.trail.module.TextureMode"),S$a.Stretch=0,S$a.Tile=1}(),function(){function S$a(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}S$Q(S$a,"laya.d3.core.trail.module.TrailKeyFrame"),S$a.prototype.cloneTo=function(S$a){S$a.time=this.time,S$a.inTangent=this.inTangent,S$a.outTangent=this.outTangent,S$a.value=this.value}}(),function(){function S$m(S$a){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new S$Am,this._curPosition=new S$Am,this._delVector3=new S$Am,this._lastFixedVertexPosition=new S$Am,this._pointAtoBVector3=new S$Am,this._pointA=new S$Am,this._pointB=new S$Am,this._owner=S$a,this._id=S$m.renderElementCount++,0==this._id?S$a._owner.transform.position.cloneTo(this._lastPosition):S$a._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new S$Lm(S$r.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new S$Lm(S$r.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}S$Q(S$m,"laya.d3.core.trail.TrailRenderElement");var S$a=S$m.prototype;S$o.imps(S$a,{"laya.d3.core.render.IRenderable":!0}),S$a._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},S$a._addTrailByFirstPosition=function(S$a,S$m){S$Am.subtract(S$m,S$a,this._delVector3),S$Am.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),S$Am.normalize(this._pointAtoBVector3,this._pointAtoBVector3),S$Am.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(S$a),S$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},S$a._addTrailByNextPosition=function(S$a){S$Am.subtract(S$a,this._lastFixedVertexPosition,this._delVector3),S$Am.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),S$Am.normalize(this._pointAtoBVector3,this._pointAtoBVector3),S$Am.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=S$Am.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=S$na.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(S$a),S$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(S$a),this._virtualVerticesCount=2)},S$a._updateVerticesByPosition=function(S$a){this._pointe=S$a.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},S$a._updateVertexBuffer2=function(){var S$a,S$m=0,S$s=0,S$P=0;for(S$P=0,S$a=(this._verticesCount+this._virtualVerticesCount)/2;S$P<S$a;S$P++)S$s=0==this._owner.textureMode?(this._VerticesToTailLength[S$P]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[S$P],this._vertices2[S$m++]=1-S$s,this._vertices2[S$m++]=1-S$s;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},S$a._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},S$a._updateDisappear=function(){var S$a,S$m=0;for(S$m=this._curDisappearIndex,S$a=(this._verticesCount+this._virtualVerticesCount)/2;S$m<S$a;S$m++)this._owner._curtime-this._everyGroupVertexBirthTime[S$m]>=this._owner.time+S$na.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},S$a._beforeRender=function(S$a){return this._camera=S$a.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),S$Am.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},S$a._render=function(S$a){this._isDead||(S$V.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),S$U.drawCall++,S$U.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},S$a._getVertexBuffer=function(S$a){return void 0===S$a&&(S$a=0),0===S$a?this._vertexBuffer1:1===S$a?this._vertexBuffer2:null},S$a._getVertexBuffers=function(){return this._vertexBuffers},S$a._getIndexBuffer=function(){return null},S$a.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},S$a._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},S$q(0,S$a,"_vertexBufferCount",function(){return this._vertexBuffers.length}),S$q(0,S$a,"triangleCount",function(){return 0}),S$m.renderElementCount=0}(),function(){function S$a(){}S$Q(S$a,"laya.d3.core.trail.VertexTrail");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration1}),S$q(1,S$a,"vertexDeclaration1",function(){return S$a._vertexDeclaration1}),S$q(1,S$a,"vertexDeclaration2",function(){return S$a._vertexDeclaration2}),S$y(S$a,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new S$ea(32,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",41),new S$Aa(24,"single",33),new S$Aa(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new S$ea(4,[new S$Aa(0,"single",38)])}]),S$a}()),S$aa=function(){function S$H(S$a){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=S$a}S$Q(S$H,"laya.d3.graphics.DynamicBatch");var S$a=S$H.prototype;return S$o.imps(S$a,{"laya.d3.core.render.IRenderable":!0}),S$a._getVertexBuffer=function(S$a){return void 0===S$a&&(S$a=0),0===S$a?this._vertexBuffer:null},S$a._getIndexBuffer=function(){return this._indexBuffer},S$a._getCombineRenderElementFromPool=function(S$a,S$m,S$s){var S$P=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return S$P||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=S$P=new S$w,S$P._sprite3D=new S$vm),S$P._sprite3D._render._renderUpdate(S$s),S$P},S$a._getRenderElement=function(S$a,S$m,S$s){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*S$H.maxVertexCount),this._indexDatas=new Uint16Array(S$H.maxIndexCount),this._vertexBuffer=S$Lm.create(this._vertexDeclaration,S$H.maxVertexCount,35048),this._indexBuffer=S$tm.create("ushort",S$H.maxIndexCount,35048));for(var S$P=this._merageElements.length=0,S$_=0,S$e=0,S$A=this._combineRenderElements.length;S$e<S$A;S$e++){var S$B=this._combineRenderElements[S$e],S$k=S$B.getDynamicBatchBakedVertexs(0),S$j=S$B.getBakedIndices(),S$G=S$B._sprite3D.transform._isFrontFaceInvert,S$y=S$P/(this._vertexDeclaration.vertexStride/4),S$d=S$_,S$Q=S$d+S$j.length;S$B._tempBatchIndexStart=S$d,S$B._tempBatchIndexEnd=S$Q,this._indexDatas.set(S$j,S$_);var S$q=0;if(S$G)for(S$q=S$d;S$q<S$Q;S$q+=3){this._indexDatas[S$q]=S$y+this._indexDatas[S$q];var S$h=this._indexDatas[S$q+1],S$u=this._indexDatas[S$q+2];this._indexDatas[S$q+1]=S$y+S$u,this._indexDatas[S$q+2]=S$y+S$h}else for(S$q=S$d;S$q<S$Q;S$q+=3)this._indexDatas[S$q]=S$y+this._indexDatas[S$q],this._indexDatas[S$q+1]=S$y+this._indexDatas[S$q+1],this._indexDatas[S$q+2]=S$y+this._indexDatas[S$q+2];S$_+=S$j.length,this._vertexDatas.set(S$k,S$P),S$P+=S$k.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),S$e=this._combineRenderElementPoolIndex=0,S$A=this._materials.length;S$e<S$A;S$e++){var S$O=this._getCombineRenderElementFromPool(S$a,S$m,S$s);S$O._type=2,S$O._staticBatch=null;var S$p=(S$O.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[S$e]]._tempBatchIndexStart,S$c=S$e+1===this._materialToRenderElementsOffsets.length?S$_:this._combineRenderElements[this._materialToRenderElementsOffsets[S$e+1]]._tempBatchIndexStart;S$O._tempBatchIndexStart=S$p,S$O._tempBatchIndexEnd=S$c,S$O._material=this._materials[S$e],this._merageElements.push(S$O)}},S$a._addCombineRenderObjTest=function(S$a){var S$m=S$a.renderObj,S$s=this._currentCombineIndexCount+S$m._getIndexBuffer().indexCount,S$P=this._currentCombineVertexCount+S$m._getVertexBuffer().vertexCount;return!(S$H.maxVertexCount<S$P||S$H.maxIndexCount<S$s)},S$a._addCombineRenderObj=function(S$a){var S$m=S$a.renderObj;this._combineRenderElements.push(S$a),this._currentCombineIndexCount=this._currentCombineIndexCount+S$m._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+S$m._getVertexBuffer().vertexCount},S$a._addCombineMaterial=function(S$a){this._materials.push(S$a)},S$a._addMaterialToRenderElementOffset=function(S$a){this._materialToRenderElementsOffsets.push(S$a)},S$a._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},S$a._addToRenderQueue=function(S$a,S$m,S$s,S$P){this._getRenderElement(S$m,S$s,S$P);for(var S$_=0,S$e=this._materials.length;S$_<S$e;S$_++)S$a.getRenderQueue(this._materials[S$_].renderQueue)._addDynamicBatchElement(this._merageElements[S$_])},S$a._beforeRender=function(S$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},S$a._render=function(S$a){var S$m=S$a._batchIndexEnd-S$a._batchIndexStart;S$V.mainContext.drawElements(4,S$m,5123,2*S$a._batchIndexStart),S$U.drawCall++,S$U.trianglesFaces+=S$m/3},S$a._getVertexBuffers=function(){return null},S$q(0,S$a,"_vertexBufferCount",function(){return 1}),S$q(0,S$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),S$q(0,S$a,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),S$H.maxVertexCount=2e4,S$H.maxIndexCount=4e4,S$H.maxCombineTriangleCount=10,S$H}(),S$ma=function(){function S$H(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}S$Q(S$H,"laya.d3.graphics.DynamicBatchManager");var S$a=S$H.prototype;return S$a.getDynamicBatch=function(S$a,S$m){var S$s,S$P=S$a.id.toString()+S$m;return this._dynamicBatches[S$P]?S$s=this._dynamicBatches[S$P]:this._dynamicBatches[S$P]=S$s=new S$aa(S$a),S$s},S$a._garbageCollection=function(){for(var S$a in this._dynamicBatches)0===this._dynamicBatches[S$a].combineRenderElementsCount&&delete this._dynamicBatches[S$a]},S$a._addPrepareRenderElement=function(S$a){this._prepareDynamicBatchCombineElements.push(S$a)},S$a._finishCombineDynamicBatch=function(S$a){var S$m,S$s,S$P;this._prepareDynamicBatchCombineElements.sort(S$H._sortPrepareDynamicBatch);for(var S$_,S$e,S$A,S$B,S$k,S$j=-1,S$G=!0,S$y=0,S$d=-1,S$Q=0,S$q=this._prepareDynamicBatchCombineElements.length;S$Q<S$q;S$Q++){var S$h=(S$e=this._prepareDynamicBatchCombineElements[S$Q]).renderObj._getVertexBuffer(0).vertexDeclaration,S$u=S$s!==S$h;S$u&&(S$y=0,S$s=S$h);var S$O=S$y!==S$j;if(S$O&&(S$j=S$y),(S$u||S$O)&&(S$A=this.getDynamicBatch(S$h,S$y),S$m=null),S$G)if(S$A._addCombineRenderObjTest(S$e)){if(S$m!==(S$_=S$e._material))S$B&&(S$a.getRenderQueue(S$k._material.renderQueue)._addRenderElement(S$k),S$k=S$B=null,S$d=-1),S$B=S$_,S$d=S$A.combineRenderElementsCount,S$k=S$e,S$m=S$_;else if(S$B){var S$p=S$k.renderObj,S$c=S$e.renderObj;S$p._getVertexBuffer().vertexCount+S$c._getVertexBuffer().vertexCount>S$aa.maxVertexCount||S$p._getIndexBuffer().indexCount+S$c._getIndexBuffer().indexCount>S$aa.maxIndexCount?(S$a.getRenderQueue(S$k._material.renderQueue)._addRenderElement(S$k),S$B=S$_,S$d=S$A.combineRenderElementsCount,S$k=S$e):(S$A._addCombineMaterial(S$B),S$A._addMaterialToRenderElementOffset(S$d),S$A._addCombineRenderObj(S$k),S$k=S$B=null,S$d=-1,S$A._addCombineRenderObj(S$e))}else S$A._addCombineRenderObj(S$e);S$G=!0}else S$B&&(S$a.getRenderQueue(S$k._material.renderQueue)._addRenderElement(S$k),S$k=S$B=null,S$d=-1),S$y++,S$G=!1;else S$P=this._prepareDynamicBatchCombineElements[S$Q-1],S$A._addMaterialToRenderElementOffset(S$A.combineRenderElementsCount),S$m=S$P._material,S$A._addCombineMaterial(S$m),S$A._addCombineRenderObj(S$P),S$G=!0,S$m!==(S$_=S$e._material)?(S$B=S$_,S$d=S$A.combineRenderElementsCount,S$k=S$e):S$A._addCombineRenderObj(S$e),S$m=S$_}S$B&&(S$a.getRenderQueue(S$k._material.renderQueue)._addRenderElement(S$k),S$k=S$B=null,S$d=-1),this._prepareDynamicBatchCombineElements.length=0},S$a._clearRenderElements=function(){for(var S$a in this._dynamicBatches)this._dynamicBatches[S$a]._clearRenderElements()},S$a._addToRenderQueue=function(S$a,S$m,S$s,S$P){for(var S$_ in this._dynamicBatches){var S$e=this._dynamicBatches[S$_];0<S$e.combineRenderElementsCount&&S$e._addToRenderQueue(S$a,S$m,S$s,S$P)}},S$a.dispose=function(){this._dynamicBatches=null},S$H._sortPrepareDynamicBatch=function(S$a,S$m){return S$a._mainSortID-S$m._mainSortID},S$H}(),S$sa=function(){function S$a(){}return S$Q(S$a,"laya.d3.graphics.FrustumCulling"),S$a.renderShadowObjectCulling=function(S$a,S$m,S$s,S$P,S$_){var S$e=0,S$A=0,S$B=0,S$k=0;for(S$e=0,S$B=S$s.length;S$e<S$B;S$e++){var S$j=S$s[S$e];S$j&&S$j._clearRenderElements()}var S$G,S$y,S$d,S$Q=S$a._cullingRenders;if(1<S$_){for(S$e=0,S$B=S$a._cullingRendersLength;S$e<S$B;S$e++)if((S$G=S$Q[S$e]).castShadow&&S$S.isVisible(S$G._owner.layer.mask)&&S$G.enable)for(var S$q=1,S$h=S$m.length;S$q<S$h;S$q++)if(S$y=S$s[S$q-1],0!==S$m[S$q].containsBoundSphere(S$G.boundingSphere))for(S$A=0,S$k=(S$d=S$G._renderElements).length;S$A<S$k;S$A++)S$y._addRenderElement(S$d[S$A])}else for(S$e=0,S$B=S$a._cullingRendersLength;S$e<S$B;S$e++)if((S$G=S$Q[S$e]).castShadow&&S$S.isVisible(S$G._owner.layer.mask)&&S$G.enable&&0!==S$m[0].containsBoundSphere(S$G.boundingSphere))for(S$G._renderUpdate(S$P),S$y=S$s[0],S$A=0,S$k=(S$d=S$G._renderElements).length;S$A<S$k;S$A++)S$y._addRenderElement(S$d[S$A])},S$a.renderShadowObjectCullingOctree=function(S$a,S$m,S$s,S$P,S$_){for(var S$e=0,S$A=S$s.length;S$e<S$A;S$e++){var S$B=S$s[S$e];S$B&&S$B._clearRenderElements()}1<S$_?S$a.treeRoot.cullingShadowObjects(S$m,S$s,!0,0,S$a):S$a.treeRoot.cullingShadowObjectsOnePSSM(S$m[0],S$s,S$P,!0,0,S$a)},S$a.renderObjectCulling=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=0,S$B=0,S$k=0,S$j=0,S$G=S$m._quenes,S$y=S$m._dynamicBatchManager,S$d=S$m._cullingRenders;for(S$A=0,S$B=S$G.length;S$A<S$B;S$A++){var S$Q=S$G[S$A];S$Q&&S$Q._clearRenderElements()}var S$q=S$Pa._staticBatchManagers;for(S$A=0,S$B=S$q.length;S$A<S$B;S$A++)S$q[S$A]._clearRenderElements();S$y._clearRenderElements();var S$h=S$s.transform.position;for(S$A=0,S$B=S$m._cullingRendersLength;S$A<S$B;S$A++){var S$u=S$d[S$A];if(S$S.isVisible(S$u._owner.layer.mask)&&S$u.enable&&0!==S$a.containsBoundSphere(S$u.boundingSphere)&&S$u._renderUpdate(S$e)){S$u._distanceForSort=S$Am.distance(S$u.boundingSphere.center,S$h)+S$u.sortingFudge;var S$O=S$u._renderElements;for(S$k=0,S$j=S$O.length;S$k<S$j;S$k++){var S$p=S$O[S$k],S$c=S$p._staticBatch;if(S$c&&S$c._material===S$p._material)S$c._addBatchRenderElement(S$p);else{var S$H=S$p.renderObj;S$H.triangleCount<10&&1===S$H._vertexBufferCount&&S$H._getIndexBuffer()&&S$p._material.renderQueue<2&&S$p._canDynamicBatch&&!S$u._owner.isStatic?S$y._addPrepareRenderElement(S$p):S$m.getRenderQueue(S$p._material.renderQueue)._addRenderElement(S$p)}}}}for(S$A=0,S$B=S$q.length;S$A<S$B;S$A++)S$q[S$A]._addToRenderQueue(S$m,S$P,S$_,S$e);S$y._finishCombineDynamicBatch(S$m),S$y._addToRenderQueue(S$m,S$P,S$_,S$e)},S$a.renderObjectCullingOctree=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=0,S$B=0,S$k=S$m._quenes,S$j=S$m._dynamicBatchManager;for(S$A=0,S$B=S$k.length;S$A<S$B;S$A++){var S$G=S$k[S$A];S$G&&S$G._clearRenderElements()}var S$y=S$Pa._staticBatchManagers;for(S$A=0,S$B=S$y.length;S$A<S$B;S$A++)S$y[S$A]._clearRenderElements();for(S$j._clearRenderElements(),S$m._cullingRenders.length=0,S$m.treeRoot.cullingObjects(S$a,!0,0,S$s.transform.position,S$e),S$A=0,S$B=S$y.length;S$A<S$B;S$A++)S$y[S$A]._addToRenderQueue(S$m,S$P,S$_,S$e);S$j._finishCombineDynamicBatch(S$m),S$j._addToRenderQueue(S$m,S$P,S$_,S$e)},S$a.renderObjectCullingNoBoundFrustum=function(S$a,S$m,S$s,S$P,S$_){var S$e=0,S$A=0,S$B=0,S$k=0,S$j=S$a._quenes,S$G=S$a._dynamicBatchManager,S$y=S$a._cullingRenders;for(S$e=0,S$A=S$j.length;S$e<S$A;S$e++){var S$d=S$j[S$e];S$d&&S$d._clearRenderElements()}var S$Q=S$Pa._staticBatchManagers;for(S$e=0,S$A=S$Q.length;S$e<S$A;S$e++)S$Q[S$e]._clearRenderElements();S$G._clearRenderElements();var S$q=S$m.transform.position;for(S$e=0,S$A=S$a._cullingRendersLength;S$e<S$A;S$e++){var S$h=S$y[S$e];if(S$S.isVisible(S$h._owner.layer.mask)&&S$h.enable){S$h._renderUpdate(S$_),S$h._distanceForSort=S$Am.distance(S$h.boundingSphere.center,S$q)+S$h.sortingFudge;var S$u=S$h._renderElements;for(S$B=0,S$k=S$u.length;S$B<S$k;S$B++){var S$O=S$u[S$B],S$p=S$O._staticBatch;if(S$p&&S$p._material===S$O._material)S$p._addBatchRenderElement(S$O);else{var S$c=S$O.renderObj;S$c.triangleCount<10&&1===S$c._vertexBufferCount&&S$c._getIndexBuffer()&&S$O._material.renderQueue<2&&S$O._canDynamicBatch&&!S$h._owner.isStatic?S$G._addPrepareRenderElement(S$O):S$a.getRenderQueue(S$O._material.renderQueue)._addRenderElement(S$O)}}}}for(S$e=0,S$A=S$Q.length;S$e<S$A;S$e++)S$Q[S$e]._addToRenderQueue(S$a,S$s,S$P,S$_);S$G._finishCombineDynamicBatch(S$a),S$G._addToRenderQueue(S$a,S$s,S$P,S$_)},S$a}(),S$Pa=function(){function S$e(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}S$Q(S$e,"laya.d3.graphics.StaticBatchManager");var S$a=S$e.prototype;return S$a._finishInit=function(){for(var S$a in this._staticBatches)this._staticBatches[S$a]._finishInit();this._initBatchRenderElements.length=0},S$a._initStaticBatchs=function(S$a){throw new Error("StaticBatchManager:must override this function.")},S$a._addInitBatchSprite=function(S$a){for(var S$m=S$a._render._renderElements,S$s=0,S$P=S$m.length;S$s<S$P;S$s++)this._initBatchRenderElements.push(S$m[S$s])},S$a._clearRenderElements=function(){for(var S$a in this._staticBatches)this._staticBatches[S$a]._clearRenderElements()},S$a._garbageCollection=function(S$a){var S$m=S$a._staticBatch,S$s=S$m._initBatchRenderElements,S$P=S$s.indexOf(S$a);S$s.splice(S$P,1),0===S$s.length&&(S$m.dispose(),delete this._staticBatches[S$m._key])},S$a._addToRenderQueue=function(S$a,S$m,S$s,S$P){for(var S$_ in this._staticBatches){var S$e=this._staticBatches[S$_];0<S$e._batchRenderElements.length&&S$e._updateToRenderQueue(S$a,S$P)}},S$a.dispose=function(){this._staticBatches=null},S$e._addToStaticBatchQueue=function(S$a){S$a instanceof laya.d3.core.RenderableSprite3D&&S$a._addToInitStaticBatchManager();for(var S$m=0,S$s=S$a.numChildren;S$m<S$s;S$m++)S$e._addToStaticBatchQueue(S$a._childs[S$m])},S$e.combine=function(S$a,S$m){var S$s,S$P=0,S$_=0;if(S$m)for(S$P=0,S$_=S$m.length;S$P<S$_;S$P++){S$m[S$P]._addToInitStaticBatchManager()}else S$a&&S$e._addToStaticBatchQueue(S$a);for(S$P=0,S$_=S$e._staticBatchManagers.length;S$P<S$_;S$P++)(S$s=S$e._staticBatchManagers[S$P])._initStaticBatchs(S$a),S$s._finishInit()},S$e._staticBatchManagers=[],S$e}(),S$_a=function(){function S$a(S$a,S$m,S$s){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=S$a,this._manager=S$m,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=S$s}S$Q(S$a,"laya.d3.graphics.StaticBatch");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),S$m._binarySearch=function(S$a){for(var S$m=0,S$s=this._batchRenderElements.length-1,S$P=0;S$m<=S$s;)S$P=Math.floor((S$m+S$s)/2),this._compareBatchRenderElement(this._batchRenderElements[S$P],S$a)?S$s=S$P-1:S$m=S$P+1;return S$m},S$m._compareBatchRenderElement=function(S$a,S$m){throw new Error("StaticBatch:must override this function.")},S$m._getVertexDecLightMap=function(S$a){return S$a===S$ta.vertexDeclaration?S$Sa.vertexDeclaration:S$a===S$ia.vertexDeclaration?S$ba.vertexDeclaration:S$a===S$la.vertexDeclaration?S$Ha.vertexDeclaration:S$a===S$xa.vertexDeclaration?null:S$a===S$ha.vertexDeclaration?S$ua.vertexDeclaration:S$a===S$Ra.vertexDeclaration?S$Xa.vertexDeclaration:S$a===S$Va.vertexDeclaration?S$Wa.vertexDeclaration:S$a===S$La.vertexDeclaration?S$Za.vertexDeclaration:S$a===S$ia.vertexDeclaration?S$ba.vertexDeclaration:S$a===S$Ca.vertexDeclaration?S$oa.vertexDeclaration:S$a===S$xa.vertexDeclaration?null:S$a===S$ha.vertexDeclaration?S$ua.vertexDeclaration:S$a===S$Fa.vertexDeclaration?S$Ea.vertexDeclaration:S$a===S$Va.vertexDeclaration?S$Wa.vertexDeclaration:S$a},S$m._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},S$m._addBatchRenderElement=function(S$a){this._batchRenderElements.splice(this._binarySearch(S$a),0,S$a)},S$m._updateToRenderQueue=function(S$a,S$m){this._combineRenderElementPoolIndex=0,this._getRenderElement(S$a.getRenderQueue(this._material.renderQueue)._renderElements,S$a,S$m)},S$m._getRenderElement=function(S$a,S$m,S$s){throw new Error("StaticBatch:must override this function.")},S$m._finishInit=function(){throw new Error("StaticBatch:must override this function.")},S$m._clearRenderElements=function(){this._batchRenderElements.length=0},S$m.dispose=function(){},S$m._getVertexBuffer=function(S$a){return void 0===S$a&&(S$a=0),null},S$m._getIndexBuffer=function(){return null},S$m._beforeRender=function(S$a){return!0},S$m._render=function(S$a){},S$m._getVertexBuffers=function(){return null},S$q(0,S$m,"_vertexBufferCount",function(){return 1}),S$q(0,S$m,"triangleCount",function(){return 0}),S$a.combine=function(S$a){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),S$Pa.combine(S$a)},S$a.maxBatchVertexCount=65535,S$a}(),S$ea=function(){function S$A(S$a,S$m){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++S$A._uniqueIDCounter,this._id>S$A.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",S$A.maxVertexDeclaration);this._shaderValues=new S$dm,this._vertexElementsDic={},this._vertexStride=S$a,this._vertexElements=S$m;for(var S$s=0;S$s<S$m.length;S$s++){var S$P=S$m[S$s],S$_=S$P.elementUsage;this._vertexElementsDic[S$_]=S$P;var S$e=[S$A._getTypeSize(S$P.elementFormat)/4,5126,!1,this._vertexStride,S$P.offset];switch(this._shaderValues.setValue(S$_,S$e),S$_){case 1:this._addShaderDefine(S$Um.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(S$Um.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(S$Um.SHADERDEFINE_UV1)}}}S$Q(S$A,"laya.d3.graphics.VertexDeclaration");var S$a=S$A.prototype;return S$a._addShaderDefine=function(S$a){this._shaderDefineValue|=S$a},S$a._removeShaderDefine=function(S$a){this._shaderDefineValue&=~S$a},S$a.getVertexElements=function(){return this._vertexElements.slice()},S$a.getVertexElementByUsage=function(S$a){return this._vertexElementsDic[S$a]},S$a.unBinding=function(){},S$q(0,S$a,"shaderDefineValue",function(){return this._shaderDefineValue}),S$q(0,S$a,"id",function(){return this._id}),S$q(0,S$a,"vertexStride",function(){return this._vertexStride}),S$q(0,S$a,"shaderValues",function(){return this._shaderValues}),S$A._getTypeSize=function(S$a){switch(S$a){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},S$A.getVertexStride=function(S$a){for(var S$m=0,S$s=0;S$s<S$a.Length;S$s++){var S$P=S$a[S$s],S$_=S$P.offset+S$A._getTypeSize(S$P.elementFormat);S$m<S$_&&(S$m=S$_)}return S$m},S$A._maxVertexDeclarationBit=1e3,S$A._uniqueIDCounter=1,S$y(S$A,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),S$A}(),S$Aa=function(){function S$a(S$a,S$m,S$s){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=S$a,this.elementFormat=S$m,this.elementUsage=S$s}return S$Q(S$a,"laya.d3.graphics.VertexElement"),S$a}(),S$Ba=(function(){function S$a(){}S$Q(S$a,"laya.d3.graphics.VertexElementFormat"),S$a.Single="single",S$a.Vector2="vector2",S$a.Vector3="vector3",S$a.Vector4="vector4",S$a.Color="color",S$a.Byte4="byte4",S$a.Short2="short2",S$a.Short4="short4",S$a.NormalizedShort2="normalizedshort2",S$a.NormalizedShort4="normalizedshort4",S$a.HalfVector2="halfvector2",S$a.HalfVector4="halfvector4"}(),function(){function S$a(){}S$Q(S$a,"laya.d3.graphics.VertexElementUsage"),S$a.POSITION0=0,S$a.COLOR0=1,S$a.TEXTURECOORDINATE0=2,S$a.NORMAL0=3,S$a.BINORMAL0=4,S$a.TANGENT0=5,S$a.BLENDINDICES0=6,S$a.BLENDWEIGHT0=7,S$a.DEPTH0=8,S$a.FOG0=9,S$a.POINTSIZE0=10,S$a.SAMPLE0=11,S$a.TESSELLATEFACTOR0=12,S$a.COLOR1=13,S$a.NEXTTEXTURECOORDINATE0=14,S$a.TEXTURECOORDINATE1=15,S$a.NEXTTEXTURECOORDINATE1=16,S$a.CORNERTEXTURECOORDINATE0=17,S$a.VELOCITY0=18,S$a.STARTCOLOR0=19,S$a.STARTSIZE=20,S$a.AGEADDSCALE0=21,S$a.STARTROTATION=22,S$a.ENDCOLOR0=23,S$a.STARTLIFETIME=24,S$a.TIME0=33,S$a.SHAPEPOSITIONSTARTLIFETIME=30,S$a.DIRECTIONTIME=32,S$a.SIZEROTATION0=27,S$a.RADIUS0=28,S$a.RADIAN0=29,S$a.STARTSPEED=31,S$a.RANDOM0=34,S$a.RANDOM1=35,S$a.SIMULATIONWORLDPOSTION=36,S$a.SIMULATIONWORLDROTATION=37,S$a.TEXTURECOORDINATE0X=38,S$a.TEXTURECOORDINATE0X1=39,S$a.TEXTURECOORDINATE0Y=40,S$a.OFFSETVECTOR=41}(),function(){function S$a(S$a,S$m,S$s){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=S$a,this._textureCoordinate0=S$m,this._time=S$s}S$Q(S$a,"laya.d3.graphics.VertexGlitter");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate0}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"time",function(){return this._time}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(24,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector2",2),new S$Aa(20,"single",33)])}])}(),function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=S$a,this._position=S$m,this._velocity=S$s,this._startColor=S$P,this._endColor=S$_,this._sizeRotation=S$e,this._radius=S$A,this._radian=S$B,this._ageAddScale=S$k,this._time=S$j}S$Q(S$a,"laya.d3.graphics.VertexParticle");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"endColor",function(){return this._endColor}),S$q(0,S$m,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),S$q(0,S$m,"sizeRotation",function(){return this._sizeRotation}),S$q(0,S$m,"velocity",function(){return this._velocity}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"startColor",function(){return this._startColor}),S$q(0,S$m,"radius",function(){return this._radius}),S$q(0,S$m,"radian",function(){return this._radian}),S$q(0,S$m,"ageAddScale",function(){return this._ageAddScale}),S$q(0,S$m,"time",function(){return this._time}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(116,[new S$Aa(0,"vector4",17),new S$Aa(16,"vector3",0),new S$Aa(28,"vector3",18),new S$Aa(40,"vector4",19),new S$Aa(56,"vector4",23),new S$Aa(72,"vector3",27),new S$Aa(84,"vector2",28),new S$Aa(92,"vector4",29),new S$Aa(108,"single",24),new S$Aa(112,"single",33)])}])}(),function(){function S$a(S$a){this._position=null,this._position=S$a}S$Q(S$a,"laya.d3.graphics.VertexPosition");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(12,[new S$Aa(0,"vector3",0)])}]),S$a}()),S$ka=function(){function S$a(S$a,S$m){this._position=null,this._normal=null,this._position=S$a,this._normal=S$m}S$Q(S$a,"laya.d3.graphics.VertexPositionNormal");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(24,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3)])}]),S$a}(),S$ja=function(){function S$a(S$a,S$m,S$s){this._position=null,this._normal=null,this._color=null,this._position=S$a,this._normal=S$m,this._color=S$s}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColor");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(40,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1)])}]),S$a}(),S$Ga=function(){function S$a(S$a,S$m,S$s,S$P,S$_){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._blendIndex=S$P,this._blendWeight=S$_}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorSkin");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(72,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector4",7),new S$Aa(56,"vector4",6)])}]),S$a}(),S$ya=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._tangent=S$P,this._blendIndex=S$_,this._blendWeight=S$e}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(88,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector4",7),new S$Aa(56,"vector4",6),new S$Aa(72,"vector4",5)])}]),S$a}(),S$da=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._tangent=S$P,this._blendIndex=S$_,this._blendWeight=S$e}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(84,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector4",7),new S$Aa(56,"vector4",6),new S$Aa(72,"vector3",5)])}]),S$a}(),S$Qa=function(){function S$a(S$a,S$m,S$s,S$P){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._tangent=S$P}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(56,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector4",5)])}]),S$a}(),S$qa=function(){function S$a(S$a,S$m,S$s,S$P){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._tangent=S$P}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(52,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector3",5)])}]),S$a}(),S$ha=function(){function S$a(S$a,S$m,S$s,S$P){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate=S$P}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTexture");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(48,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2)])}]),S$a}(),S$ua=function(){function S$a(S$a,S$m,S$s,S$P,S$_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate0=S$P,this._textureCoordinate1=S$_}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(56,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector2",15)])}]),S$a}(),S$Oa=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate0=S$P,this._textureCoordinate1=S$_,this._blendIndex=S$e,this._blendWeight=S$A}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(88,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector2",15),new S$Aa(56,"vector4",7),new S$Aa(72,"vector4",6)])}]),S$a}(),S$pa=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate0=S$P,this._textureCoordinate1=S$_,this._tangent=S$e,this._blendIndex=S$A,this._blendWeight=S$B}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(104,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector2",15),new S$Aa(56,"vector4",7),new S$Aa(72,"vector4",6),new S$Aa(88,"vector4",5)])}]),S$a}(),S$ca=function(){function S$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$m.VertexPositionNormalColorTexture0SkinTangent=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate0=S$P,this._textureCoordinate1=S$_,this._tangent=S$e,this._blendIndex=S$A,this._blendWeight=S$B},S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(100,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector2",15),new S$Aa(56,"vector4",7),new S$Aa(72,"vector4",6),new S$Aa(88,"vector3",5)])}]),S$a}(),S$Ha=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate0=S$P,this._textureCoordinate1=S$_,this._tangent=S$e}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(72,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector2",15),new S$Aa(56,"vector4",5)])}]),S$a}(),S$oa=function(){function S$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$m.VertexPositionNormalColorTexture0Tangent=function(S$a,S$m,S$s,S$P,S$_,S$e){this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate0=S$P,this._textureCoordinate1=S$_,this._tangent=S$e},S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(68,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector2",15),new S$Aa(56,"vector3",5)])}]),S$a}(),S$Na=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate=S$P,this._blendIndex=S$_,this._blendWeight=S$e}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(80,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector4",7),new S$Aa(64,"vector4",6)])}]),S$a}(),S$za=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate=S$P,this._tangent=S$_,this._blendIndex=S$e,this._blendWeight=S$A}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(96,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector4",7),new S$Aa(64,"vector4",6),new S$Aa(80,"vector4",5)])}]),S$a}(),S$Ua=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate=S$P,this._tangent=S$_,this._blendIndex=S$e,this._blendWeight=S$A}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(92,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector4",7),new S$Aa(64,"vector4",6),new S$Aa(80,"vector3",5)])}]),S$a}(),S$la=function(){function S$a(S$a,S$m,S$s,S$P,S$_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate=S$P,this._tangent=S$_}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(64,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector4",5)])}]),S$a}(),S$Ca=function(){function S$a(S$a,S$m,S$s,S$P,S$_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._color=S$s,this._textureCoordinate=S$P,this._tangent=S$_}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"color",function(){return this._color}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(60,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",1),new S$Aa(40,"vector2",2),new S$Aa(48,"vector3",5)])}]),S$a}(),S$fa=function(){function S$a(S$a,S$m,S$s){this._position=null,this._normal=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._tangent=S$s}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(40,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector4",5)])}]),S$a}(),S$Ka=function(){function S$a(S$a,S$m,S$s){this._position=null,this._normal=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._tangent=S$s}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(36,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector3",5)])}]),S$a}(),S$Va=function(){function S$a(S$a,S$m,S$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTexture");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(32,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2)])}]),S$a}(),S$Wa=function(){function S$a(S$a,S$m,S$s,S$P){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=S$a,this._normal=S$m,this._textureCoordinate0=S$s,this._textureCoordinate1=S$P}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(40,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector2",15)])}]),S$a}(),S$ba=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=S$a,this._normal=S$m,this._textureCoordinate0=S$s,this._textureCoordinate1=S$P,this._blendIndex=S$_,this._blendWeight=S$e}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(72,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector2",15),new S$Aa(40,"vector4",7),new S$Aa(56,"vector4",6)])}]),S$a}(),S$Sa=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._textureCoordinate0=S$s,this._textureCoordinate1=S$P,this._tangent=S$_,this._blendIndex=S$e,this._blendWeight=S$A}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(88,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector2",15),new S$Aa(40,"vector4",7),new S$Aa(56,"vector4",6),new S$Aa(72,"vector4",5)])}]),S$a}(),S$Za=function(){function S$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$m.VertexPositionNormalTexture0SkinTangent=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){this._position=S$a,this._normal=S$m,this._textureCoordinate0=S$s,this._textureCoordinate1=S$P,this._tangent=S$_,this._blendIndex=S$e,this._blendWeight=S$A},S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(84,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector2",15),new S$Aa(40,"vector4",7),new S$Aa(56,"vector4",6),new S$Aa(72,"vector3",5)])}]),S$a}(),S$Xa=function(){function S$a(S$a,S$m,S$s,S$P,S$_){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._textureCoordinate0=S$s,this._textureCoordinate1=S$P,this._tangent=S$_}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(56,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector2",15),new S$Aa(40,"vector4",5)])}]),S$a}(),S$Ea=function(){function S$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$m.VertexPositionNormalTexture0Tangent=function(S$a,S$m,S$s,S$P,S$_){this._position=S$a,this._normal=S$m,this._textureCoordinate0=S$s,this._textureCoordinate1=S$P,this._tangent=S$_},S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(52,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector2",15),new S$Aa(40,"vector3",5)])}]),S$a}(),S$ia=function(){function S$a(S$a,S$m,S$s,S$P,S$_){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s,this._blendIndex=S$P,this._blendWeight=S$_}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTextureSkin");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(64,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector4",7),new S$Aa(48,"vector4",6)])}]),S$a}(),S$ta=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s,this._tangent=S$P,this._blendIndex=S$_,this._blendWeight=S$e}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(80,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector4",7),new S$Aa(48,"vector4",6),new S$Aa(64,"vector4",5)])}]),S$a}(),S$La=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s,this._tangent=S$P,this._blendIndex=S$_,this._blendWeight=S$e}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(76,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector4",7),new S$Aa(48,"vector4",6),new S$Aa(64,"vector3",5)])}]),S$a}(),S$Ra=function(){function S$a(S$a,S$m,S$s,S$P){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s,this._tangent=S$P}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(48,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector4",5)])}]),S$a}(),S$Fa=function(){function S$a(S$a,S$m,S$s,S$P){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s,this._tangent=S$P}S$Q(S$a,"laya.d3.graphics.VertexPositionNormalTextureTangent");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(44,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector3",5)])}]),S$a}(),S$xa=function(){function S$a(S$a,S$m,S$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s}S$Q(S$a,"laya.d3.graphics.VertexPositionNTBTexture");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(56,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector3",5),new S$Aa(36,"vector3",4),new S$Aa(48,"vector2",2)])}]),S$a}(),S$Ma=function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=S$a,this._normal=S$m,this._textureCoordinate0=S$P,this._textureCoordinate1=S$_,this._tangent=S$e,S$s=S$s,this._blendIndex=S$A,this._blendWeight=S$B}S$Q(S$a,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"tangent",function(){return this._tangent}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(0,S$m,"textureCoordinate1",function(){return this._textureCoordinate1}),S$q(0,S$m,"blendIndex",function(){return this._blendIndex}),S$q(0,S$m,"blendWeight",function(){return this._blendWeight}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(96,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector3",5),new S$Aa(36,"vector3",4),new S$Aa(48,"vector2",2),new S$Aa(56,"vector2",15),new S$Aa(64,"vector4",7),new S$Aa(80,"vector4",6)])}]),S$a}(),S$Ja=function(){function S$a(S$a,S$m,S$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=S$a,this._normal=S$m,this._textureCoordinate=S$s}S$Q(S$a,"laya.d3.graphics.VertexPositionNTBTextureSkin");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"textureCoordinate",function(){return this._textureCoordinate}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(88,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector3",5),new S$Aa(36,"vector3",4),new S$Aa(48,"vector2",2),new S$Aa(56,"vector4",7),new S$Aa(72,"vector4",6)])}]),S$a}(),S$Da=(function(){function S$a(S$a,S$m,S$s,S$P){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=S$a,this._normal=S$m,this._textureCoord0=S$s,this._textureCoord1=S$P}S$Q(S$a,"laya.d3.graphics.VertexPositionTerrain");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"normal",function(){return this._normal}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoord0",function(){return this._textureCoord0}),S$q(0,S$m,"textureCoord1",function(){return this._textureCoord1}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(40,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector3",3),new S$Aa(24,"vector2",2),new S$Aa(32,"vector2",15)])}])}(),function(){function S$a(S$a,S$m){this._position=null,this._textureCoordinate0=null,this._position=S$a,this._textureCoordinate0=S$m}S$Q(S$a,"laya.d3.graphics.VertexPositionTexture0");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"position",function(){return this._position}),S$q(0,S$m,"textureCoordinate0",function(){return this._textureCoordinate0}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(20,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector2",2)])}]),S$a}()),S$ga=(function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y,S$d,S$Q){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=S$a,this._positionStartLifeTime=S$m,this._velocity=S$s,this._startColor=S$P,this._startSize=S$_,this._startRotation0=S$e,this._startRotation1=S$A,this._startRotation2=S$B,this._startLifeTime=S$k,this._time=S$j,this._startSpeed=S$G,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=S$Q}S$Q(S$a,"laya.d3.graphics.VertexShurikenParticleBillboard");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),S$q(0,S$m,"random1",function(){return this._randoms1}),S$q(0,S$m,"startRotation2",function(){return this._startRotation2}),S$q(0,S$m,"positionStartLifeTime",function(){return this._positionStartLifeTime}),S$q(0,S$m,"velocity",function(){return this._velocity}),S$q(0,S$m,"random0",function(){return this._randoms0}),S$q(0,S$m,"startSize",function(){return this._startSize}),S$q(0,S$m,"startColor",function(){return this._startColor}),S$q(0,S$m,"startRotation0",function(){return this._startRotation0}),S$q(0,S$m,"startRotation1",function(){return this._startRotation1}),S$q(0,S$m,"startLifeTime",function(){return this._startLifeTime}),S$q(0,S$m,"time",function(){return this._time}),S$q(0,S$m,"startSpeed",function(){return this._startSpeed}),S$q(0,S$m,"simulationWorldPostion",function(){return this._simulationWorldPostion}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(152,[new S$Aa(0,"vector4",17),new S$Aa(16,"vector4",30),new S$Aa(32,"vector4",32),new S$Aa(48,"vector4",19),new S$Aa(64,"vector3",20),new S$Aa(76,"vector3",22),new S$Aa(88,"single",31),new S$Aa(92,"vector4",34),new S$Aa(108,"vector4",35),new S$Aa(124,"vector3",36),new S$Aa(136,"vector4",37)])}])}(),function(){function S$a(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y,S$d,S$Q){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=S$a,this._positionStartLifeTime=S$m,this._velocity=S$s,this._startColor=S$P,this._startSize=S$_,this._startRotation0=S$e,this._startRotation1=S$A,this._startRotation2=S$B,this._startLifeTime=S$k,this._time=S$j,this._startSpeed=S$G,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=S$Q}S$Q(S$a,"laya.d3.graphics.VertexShurikenParticleMesh");var S$m=S$a.prototype;S$o.imps(S$m,{"laya.d3.graphics.IVertex":!0}),S$q(0,S$m,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),S$q(0,S$m,"velocity",function(){return this._velocity}),S$q(0,S$m,"position",function(){return this._positionStartLifeTime}),S$q(0,S$m,"random0",function(){return this._randoms0}),S$q(0,S$m,"startSize",function(){return this._startSize}),S$q(0,S$m,"startColor",function(){return this._startColor}),S$q(0,S$m,"startRotation0",function(){return this._startRotation0}),S$q(0,S$m,"startRotation1",function(){return this._startRotation1}),S$q(0,S$m,"random1",function(){return this._randoms1}),S$q(0,S$m,"startRotation2",function(){return this._startRotation2}),S$q(0,S$m,"startLifeTime",function(){return this._startLifeTime}),S$q(0,S$m,"time",function(){return this._time}),S$q(0,S$m,"startSpeed",function(){return this._startSpeed}),S$q(0,S$m,"simulationWorldPostion",function(){return this._simulationWorldPostion}),S$q(0,S$m,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$q(1,S$a,"vertexDeclaration",function(){return S$a._vertexDeclaration}),S$y(S$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new S$ea(172,[new S$Aa(0,"vector3",0),new S$Aa(12,"vector4",1),new S$Aa(28,"vector2",2),new S$Aa(36,"vector4",30),new S$Aa(52,"vector4",32),new S$Aa(68,"vector4",19),new S$Aa(84,"vector3",20),new S$Aa(96,"vector3",22),new S$Aa(108,"single",31),new S$Aa(112,"vector4",34),new S$Aa(128,"vector4",35),new S$Aa(144,"vector3",36),new S$Aa(156,"vector4",37)])}])}(),function(){function S$c(S$a,S$m,S$s,S$P,S$_,S$e){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=S$s,this._materials=S$P,this._subMeshes=S$_,this._materialMap=S$e,this._version=S$m,this._onLoaded(S$a)}S$Q(S$c,"laya.d3.loaders.LoadModelV01");var S$a=S$c.prototype;return S$a._onLoaded=function(S$a){this._readData=S$a,this.READ_BLOCK();for(var S$m=0;S$m<this._BLOCK.count;S$m++){var S$s=this._readData.getUint16(),S$P=this._strings[S$s],S$_=this["READ_"+S$P];if(null==S$_)throw new Error("model file err,no this function:"+S$s+" "+S$P);if(!S$_.call(this))break}return this._mesh},S$a.onError=function(){},S$a._readString=function(){return this._strings[this._readData.getUint16()]},S$a.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},S$a.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},S$a.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var S$a=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var S$m=0;S$m<this._STRINGS.size;S$m++)this._strings[S$m]=this._readData.readUTFString();return this._readData.pos=S$a,!0},S$a.READ_MATERIAL=function(){var S$a=this._readData.getUint16(),S$m=(this._readString(),this._readString());return this._materials[S$a]="null"!==S$m?S$O.getRes(this._materialMap[S$m]):new S$Km,!0},S$a.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var S$a,S$m=this._readData.__getBuffer(),S$s=0,S$P=this._readData.getUint32(),S$_=this._readData.getUint32(),S$e=(new Float32Array(S$m.slice(S$P+this._DATA.offset,S$P+this._DATA.offset+S$_)),this._readData.getUint32()),S$A=this._readData.getUint32(),S$B=new Float32Array(S$m.slice(S$e+this._DATA.offset,S$e+this._DATA.offset+S$A));for(this.mesh._inverseBindPoses=[],S$s=0,S$a=S$B.length;S$s<S$a;S$s+=16){var S$k=new S$am(S$B[S$s+0],S$B[S$s+1],S$B[S$s+2],S$B[S$s+3],S$B[S$s+4],S$B[S$s+5],S$B[S$s+6],S$B[S$s+7],S$B[S$s+8],S$B[S$s+9],S$B[S$s+10],S$B[S$s+11],S$B[S$s+12],S$B[S$s+13],S$B[S$s+14],S$B[S$s+15]);this.mesh._inverseBindPoses.push(S$k)}break;default:throw new Error("LoadModel:unknown version.")}return!0},S$a.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var S$a=this._readString();this._shaderAttributes=S$a.match(S$c._attrReg);var S$m=this._readData.getUint32(),S$s=this._readData.getUint32(),S$P=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),S$_=this._readData.getUint32(),S$e=this._readData.getUint32(),S$A=this._readData.getUint32(),S$B=this._readData.__getBuffer(),S$k=new S$jm(this._mesh),S$j=this._getVertexDeclaration(),S$G=S$Lm.create(S$j,S$_/S$j.vertexStride,35044,!0),S$y=S$P+this._DATA.offset,S$d=S$B.slice(S$y,S$y+S$_);S$G.setData(new Float32Array(S$d));for(var S$Q=(S$k._vertexBuffer=S$G).vertexDeclaration.getVertexElements(),S$q=0;S$q<S$Q.length;S$q++)S$k._bufferUsage[S$Q[S$q].elementUsage]=S$G;var S$h=S$tm.create("ushort",S$s/2,35044,!0),S$u=S$m+this._DATA.offset,S$O=S$B.slice(S$u,S$u+S$s);S$h.setData(new Uint16Array(S$O)),S$k._indexBuffer=S$h;var S$p=S$B.slice(S$e+this._DATA.offset,S$e+this._DATA.offset+S$A);return S$k._boneIndicesList[0]=new Uint8Array(S$p),this._subMeshes.push(S$k),!0},S$a.READ_DATAAREA=function(){return!1},S$a._getVertexDeclaration=function(){for(var S$a,S$m=!1,S$s=!1,S$P=!1,S$_=!1,S$e=!1,S$A=!1,S$B=!1,S$k=!1,S$j=!1,S$G=0;S$G<this._shaderAttributes.length;S$G+=8)switch(this._shaderAttributes[S$G]){case"POSITION":S$m=!0;break;case"NORMAL":S$s=!0;break;case"COLOR":S$P=!0;break;case"UV":S$_=!0;break;case"UV1":S$e=!0;break;case"BLENDWEIGHT":S$B=!0;break;case"BLENDINDICES":S$k=!0;break;case"TANGENT":S$A=!0;break;case"BINORMAL":S$j=!0}return S$m&&S$s&&S$P&&S$_&&S$e&&S$B&&S$k&&S$A?S$a=S$ca.vertexDeclaration:S$m&&S$s&&S$P&&S$_&&S$e&&S$B&&S$k?S$a=S$Oa.vertexDeclaration:S$m&&S$s&&S$_&&S$e&&S$B&&S$k&&S$A?S$a=S$Za.vertexDeclaration:S$m&&S$s&&S$_&&S$e&&S$B&&S$k?S$a=S$ba.vertexDeclaration:S$m&&S$s&&S$P&&S$_&&S$B&&S$k&&S$A?S$a=S$Ua.vertexDeclaration:S$m&&S$s&&S$P&&S$_&&S$B&&S$k?S$a=S$Na.vertexDeclaration:S$m&&S$s&&S$A&&S$j&&S$_&&S$B&&S$k?S$a=S$Ja.vertexDeclaration:S$m&&S$s&&S$_&&S$B&&S$k&&S$A?S$a=S$La.vertexDeclaration:S$m&&S$s&&S$_&&S$B&&S$k?S$a=S$ia.vertexDeclaration:S$m&&S$s&&S$P&&S$B&&S$k&&S$A?S$a=S$da.vertexDeclaration:S$m&&S$s&&S$P&&S$B&&S$k?S$a=S$Ga.vertexDeclaration:S$m&&S$s&&S$P&&S$_&&S$e&&S$A?S$a=S$oa.vertexDeclaration:S$m&&S$s&&S$P&&S$_&&S$e?S$a=S$ua.vertexDeclaration:S$m&&S$s&&S$_&&S$e&&S$A?S$a=S$Ea.vertexDeclaration:S$m&&S$s&&S$_&&S$e?S$a=S$Wa.vertexDeclaration:S$m&&S$s&&S$P&&S$_&&S$A?S$a=S$Ca.vertexDeclaration:S$m&&S$s&&S$_&&S$A&&S$j?S$a=S$xa.vertexDeclaration:S$m&&S$s&&S$P&&S$_?S$a=S$ha.vertexDeclaration:S$m&&S$s&&S$_&&S$A?S$a=S$Fa.vertexDeclaration:S$m&&S$s&&S$_?S$a=S$Va.vertexDeclaration:S$m&&S$s&&S$P&&S$A?S$a=S$qa.vertexDeclaration:S$m&&S$s&&S$P&&(S$a=S$ja.vertexDeclaration),S$a},S$q(0,S$a,"mesh",function(){return this._mesh}),S$c._attrReg=new RegExp("(\\w+)|([:,;])","g"),S$c}()),S$wa=function(){function S$z(){}return S$Q(S$z,"laya.d3.loaders.LoadModelV02"),S$z.parse=function(S$a,S$m,S$s,S$P,S$_,S$e){S$z._mesh=S$s,S$z._materials=S$P,S$z._subMeshes=S$_,S$z._materialMap=S$e,S$z._version=S$m,S$z._readData=S$a,S$z.READ_DATA(),S$z.READ_BLOCK(),S$z.READ_STRINGS();for(var S$A=0,S$B=S$z._BLOCK.count;S$A<S$B;S$A++){S$z._readData.pos=S$z._BLOCK.blockStarts[S$A];var S$k=S$z._readData.getUint16(),S$j=S$z._strings[S$k],S$G=S$z["READ_"+S$j];if(null==S$G)throw new Error("model file err,no this function:"+S$k+" "+S$j);S$G.call()}S$z._strings.length=0,S$z._readData=null,S$z._version=null,S$z._mesh=null,S$z._materials=null,S$z._subMeshes=null,S$z._materialMap=null},S$z._readString=function(){return S$z._strings[S$z._readData.getUint16()]},S$z.READ_DATA=function(){S$z._DATA.offset=S$z._readData.getUint32(),S$z._DATA.size=S$z._readData.getUint32()},S$z.READ_BLOCK=function(){for(var S$a=S$z._BLOCK.count=S$z._readData.getUint16(),S$m=S$z._BLOCK.blockStarts=[],S$s=S$z._BLOCK.blockLengths=[],S$P=0;S$P<S$a;S$P++)S$m.push(S$z._readData.getUint32()),S$s.push(S$z._readData.getUint32())},S$z.READ_STRINGS=function(){var S$a=S$z._readData.getUint32(),S$m=S$z._readData.getUint16(),S$s=S$z._readData.pos;S$z._readData.pos=S$a+S$z._DATA.offset;for(var S$P=0;S$P<S$m;S$P++)S$z._strings[S$P]=S$z._readData.readUTFString();S$z._readData.pos=S$s},S$z.READ_MATERIAL=function(){S$z._readString(),S$z._readString();var S$a=S$z._readString();return""!==S$a&&S$z._materials.push(S$O.getRes(S$z._materialMap[S$a])),!0},S$z.READ_MESH=function(){S$z._readString();var S$a,S$m=S$z._readData.__getBuffer(),S$s=0,S$P=S$z._readData.getInt16(),S$_=S$z._DATA.offset;for(S$s=0;S$s<S$P;S$s++){var S$e=S$_+S$z._readData.getUint32(),S$A=S$z._readData.getUint32(),S$B=new Float32Array(S$m.slice(S$e,S$e+S$A)),S$k=S$z._readString().match(S$z._attrReg),S$j=S$z._getVertexDeclaration(S$k),S$G=S$Lm.create(S$j,4*S$B.length/S$j.vertexStride,35044,!0);S$G.setData(S$B),S$z._mesh._vertexBuffers.push(S$G)}var S$y=S$_+S$z._readData.getUint32(),S$d=S$z._readData.getUint32(),S$Q=new Uint16Array(S$m.slice(S$y,S$y+S$d)),S$q=S$tm.create("ushort",S$d/2,35044,!0);S$q.setData(S$Q),S$z._mesh._indexBuffer=S$q;var S$h=S$z._mesh._boneNames=[],S$u=S$z._readData.getUint16();for(S$h.length=S$u,S$s=0;S$s<S$u;S$s++)S$h[S$s]=S$z._strings[S$z._readData.getUint16()];var S$O=S$z._readData.getUint32(),S$p=S$z._readData.getUint32(),S$c=(new Float32Array(S$m.slice(S$_+S$O,S$_+S$O+S$p)),S$z._readData.getUint32()),S$H=S$z._readData.getUint32(),S$o=new Float32Array(S$m.slice(S$_+S$c,S$_+S$c+S$H));for(S$z._mesh._inverseBindPoses=[],S$s=0,S$a=S$o.length;S$s<S$a;S$s+=16){var S$N=new S$am(S$o[S$s+0],S$o[S$s+1],S$o[S$s+2],S$o[S$s+3],S$o[S$s+4],S$o[S$s+5],S$o[S$s+6],S$o[S$s+7],S$o[S$s+8],S$o[S$s+9],S$o[S$s+10],S$o[S$s+11],S$o[S$s+12],S$o[S$s+13],S$o[S$s+14],S$o[S$s+15]);S$z._mesh._inverseBindPoses.push(S$N)}return S$z._mesh._skinnedDatas=new Float32Array(16*S$o.length),!0},S$z.READ_SUBMESH=function(){var S$a=S$z._readData.__getBuffer(),S$m=new S$jm(S$z._mesh),S$s=S$z._readData.getInt16(),S$P=S$z._readData.getUint32(),S$_=S$z._readData.getUint32();S$m._vertexBuffer=S$z._mesh._vertexBuffers[S$s],S$m._vertexStart=S$P,S$m._vertexCount=S$_;var S$e=S$z._readData.getUint32(),S$A=S$z._readData.getUint32(),S$B=S$z._mesh._indexBuffer;S$m._indexBuffer=S$B,S$m._indexStart=S$e,S$m._indexCount=S$A,S$m._indices=new Uint16Array(S$B.getData().buffer,2*S$e,S$A);var S$k=S$z._DATA.offset,S$j=S$m._subIndexBufferStart,S$G=S$m._subIndexBufferCount,S$y=S$m._boneIndicesList,S$d=S$z._readData.getUint16();S$j.length=S$d,S$G.length=S$d,S$y.length=S$d;for(var S$Q=0;S$Q<S$d;S$Q++){S$j[S$Q]=S$z._readData.getUint32(),S$G[S$Q]=S$z._readData.getUint32();var S$q=S$z._readData.getUint32(),S$h=S$z._readData.getUint32();S$m._boneIndicesList[S$Q]=new Uint8Array(S$a.slice(S$k+S$q,S$k+S$q+S$h))}return S$z._subMeshes.push(S$m),!0},S$z._getVertexDeclaration=function(S$a){for(var S$m,S$s=!1,S$P=!1,S$_=!1,S$e=!1,S$A=!1,S$B=!1,S$k=!1,S$j=!1,S$G=!1,S$y=0;S$y<S$a.length;S$y++)switch(S$a[S$y]){case"POSITION":S$s=!0;break;case"NORMAL":S$P=!0;break;case"COLOR":S$_=!0;break;case"UV":S$e=!0;break;case"UV1":S$A=!0;break;case"BLENDWEIGHT":S$k=!0;break;case"BLENDINDICES":S$j=!0;break;case"TANGENT":S$B=!0;break;case"BINORMAL":S$G=!0}return S$s&&S$P&&S$_&&S$e&&S$A&&S$k&&S$j&&S$B?S$m=S$ca.vertexDeclaration:S$s&&S$P&&S$_&&S$e&&S$A&&S$k&&S$j?S$m=S$Oa.vertexDeclaration:S$s&&S$P&&S$e&&S$A&&S$k&&S$j&&S$B?S$m=S$Za.vertexDeclaration:S$s&&S$P&&S$e&&S$A&&S$k&&S$j?S$m=S$ba.vertexDeclaration:S$s&&S$P&&S$_&&S$e&&S$k&&S$j&&S$B?S$m=S$Ua.vertexDeclaration:S$s&&S$P&&S$_&&S$e&&S$k&&S$j?S$m=S$Na.vertexDeclaration:S$s&&S$P&&S$e&&S$k&&S$j&&S$B?S$m=S$La.vertexDeclaration:S$s&&S$P&&S$e&&S$k&&S$j?S$m=S$ia.vertexDeclaration:S$s&&S$P&&S$_&&S$k&&S$j&&S$B?S$m=S$da.vertexDeclaration:S$s&&S$P&&S$_&&S$k&&S$j?S$m=S$Ga.vertexDeclaration:S$s&&S$P&&S$_&&S$e&&S$A&&S$B?S$m=S$oa.vertexDeclaration:S$s&&S$P&&S$_&&S$e&&S$A?S$m=S$ua.vertexDeclaration:S$s&&S$P&&S$e&&S$A&&S$B?S$m=S$Ea.vertexDeclaration:S$s&&S$P&&S$e&&S$A?S$m=S$Wa.vertexDeclaration:S$s&&S$P&&S$_&&S$e&&S$B?S$m=S$Ca.vertexDeclaration:S$s&&S$P&&S$e&&S$B&&S$G?S$m=S$xa.vertexDeclaration:S$s&&S$P&&S$_&&S$e?S$m=S$ha.vertexDeclaration:S$s&&S$P&&S$e&&S$B?S$m=S$Fa.vertexDeclaration:S$s&&S$P&&S$e?S$m=S$Va.vertexDeclaration:S$s&&S$P&&S$_&&S$B?S$m=S$qa.vertexDeclaration:S$s&&S$P&&S$_&&(S$m=S$ja.vertexDeclaration),S$m},S$z._attrReg=new RegExp("(\\w+)|([:,;])","g"),S$z._strings=[],S$z._readData=null,S$z._version=null,S$z._mesh=null,S$z._materials=null,S$z._subMeshes=null,S$z._materialMap=null,S$y(S$z,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),S$z}(),S$va=function(){function S$N(){}return S$Q(S$N,"laya.d3.loaders.LoadModelV03"),S$N.parse=function(S$a,S$m,S$s,S$P,S$_){S$N._mesh=S$s,S$N._subMeshes=S$P,S$N._materialMap=S$_,S$N._version=S$m,S$N._readData=S$a,S$N.READ_DATA(),S$N.READ_BLOCK(),S$N.READ_STRINGS();for(var S$e=0,S$A=S$N._BLOCK.count;S$e<S$A;S$e++){S$N._readData.pos=S$N._BLOCK.blockStarts[S$e];var S$B=S$N._readData.getUint16(),S$k=S$N._strings[S$B],S$j=S$N["READ_"+S$k];if(null==S$j)throw new Error("model file err,no this function:"+S$B+" "+S$k);S$j.call()}S$N._strings.length=0,S$N._readData=null,S$N._version=null,S$N._mesh=null,S$N._subMeshes=null,S$N._materialMap=null},S$N._readString=function(){return S$N._strings[S$N._readData.getUint16()]},S$N.READ_DATA=function(){S$N._DATA.offset=S$N._readData.getUint32(),S$N._DATA.size=S$N._readData.getUint32()},S$N.READ_BLOCK=function(){for(var S$a=S$N._BLOCK.count=S$N._readData.getUint16(),S$m=S$N._BLOCK.blockStarts=[],S$s=S$N._BLOCK.blockLengths=[],S$P=0;S$P<S$a;S$P++)S$m.push(S$N._readData.getUint32()),S$s.push(S$N._readData.getUint32())},S$N.READ_STRINGS=function(){var S$a=S$N._readData.getUint32(),S$m=S$N._readData.getUint16(),S$s=S$N._readData.pos;S$N._readData.pos=S$a+S$N._DATA.offset;for(var S$P=0;S$P<S$m;S$P++)S$N._strings[S$P]=S$N._readData.readUTFString();S$N._readData.pos=S$s},S$N.READ_MESH=function(){var S$a,S$m=S$N._readString(),S$s=S$N._readData.__getBuffer(),S$P=0,S$_=S$N._readData.getInt16(),S$e=S$N._DATA.offset;for(S$P=0;S$P<S$_;S$P++){var S$A,S$B=S$e+S$N._readData.getUint32(),S$k=S$N._readData.getUint32(),S$j=new Float32Array(S$s.slice(S$B,S$B+S$k)),S$G=S$N._readString();switch(S$N._version){case"LAYAMODEL:03":S$A=S$N._vertexDeclarationMap_Discard[S$G];break;case"LAYAMODEL:0301":S$A=S$N._vertexDeclarationMap[S$G];break;default:throw new Error("LoadModelV03: unknown version.")}if(!S$A)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+S$N._version+"  bufferAttribute="+S$G+"  name="+S$m+"  url="+(S$N._mesh?S$N._mesh.url:"null"));var S$y=S$Lm.create(S$A,4*S$j.length/S$A.vertexStride,35044,!0,S$N._mesh._url+"_"+S$P);S$y.setData(S$j),S$N._mesh._vertexBuffers.push(S$y)}var S$d=S$e+S$N._readData.getUint32(),S$Q=S$N._readData.getUint32(),S$q=new Uint16Array(S$s.slice(S$d,S$d+S$Q)),S$h=S$tm.create("ushort",S$Q/2,35044,!0,S$N._mesh._url);S$h.setData(S$q),S$N._mesh._indexBuffer=S$h;var S$u=S$N._mesh._boneNames=[],S$O=S$N._readData.getUint16();for(S$u.length=S$O,S$P=0;S$P<S$O;S$P++)S$u[S$P]=S$N._strings[S$N._readData.getUint16()];S$N._readData.pos+=8;var S$p=S$N._readData.getUint32(),S$c=S$N._readData.getUint32(),S$H=new Float32Array(S$s.slice(S$e+S$p,S$e+S$p+S$c));for(S$N._mesh._inverseBindPoses=[],S$P=0,S$a=S$H.length;S$P<S$a;S$P+=16){var S$o=new S$am(S$H[S$P+0],S$H[S$P+1],S$H[S$P+2],S$H[S$P+3],S$H[S$P+4],S$H[S$P+5],S$H[S$P+6],S$H[S$P+7],S$H[S$P+8],S$H[S$P+9],S$H[S$P+10],S$H[S$P+11],S$H[S$P+12],S$H[S$P+13],S$H[S$P+14],S$H[S$P+15]);S$N._mesh._inverseBindPoses.push(S$o)}return S$N._mesh._skinnedDatas=new Float32Array(16*S$H.length),!0},S$N.READ_SUBMESH=function(){var S$a=S$N._readData.__getBuffer(),S$m=new S$jm(S$N._mesh),S$s=S$N._readData.getInt16(),S$P=S$N._readData.getUint32(),S$_=S$N._readData.getUint32();S$m._vertexBuffer=S$N._mesh._vertexBuffers[S$s],S$m._vertexStart=S$P,S$m._vertexCount=S$_;var S$e=S$N._readData.getUint32(),S$A=S$N._readData.getUint32(),S$B=S$N._mesh._indexBuffer;S$m._indexBuffer=S$B,S$m._indexStart=S$e,S$m._indexCount=S$A,S$m._indices=new Uint16Array(S$B.getData().buffer,2*S$e,S$A);var S$k=S$N._DATA.offset,S$j=S$m._subIndexBufferStart,S$G=S$m._subIndexBufferCount,S$y=S$m._boneIndicesList,S$d=S$N._readData.getUint16();S$j.length=S$d,S$G.length=S$d,S$y.length=S$d;for(var S$Q=0;S$Q<S$d;S$Q++){S$j[S$Q]=S$N._readData.getUint32(),S$G[S$Q]=S$N._readData.getUint32();var S$q=S$N._readData.getUint32(),S$h=S$N._readData.getUint32();S$y[S$Q]=new Uint8Array(S$a.slice(S$k+S$q,S$k+S$q+S$h))}return S$N._subMeshes.push(S$m),!0},S$N._strings=[],S$N._readData=null,S$N._version=null,S$N._mesh=null,S$N._subMeshes=null,S$N._materialMap=null,S$y(S$N,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":S$ca.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":S$Oa.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":S$Ma.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":S$Za.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":S$ba.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":S$Ua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":S$Na.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":S$La.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":S$ia.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":S$da.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":S$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":S$oa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":S$ua.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":S$Ea.vertexDeclaration,"POSITION,NORMAL,UV,UV1":S$Wa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":S$Ca.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":S$xa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":S$ha.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":S$Fa.vertexDeclaration,"POSITION,NORMAL,UV":S$Va.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":S$qa.vertexDeclaration,"POSITION,NORMAL,COLOR":S$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":S$Ka.vertexDeclaration,"POSITION,NORMAL":S$ka.vertexDeclaration,"POSITION,UV":S$Da.vertexDeclaration,POSITION:S$Ba.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":S$pa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":S$Oa.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":S$Ma.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":S$Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":S$ba.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":S$za.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":S$Na.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":S$ta.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":S$ia.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":S$ya.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":S$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":S$Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":S$ua.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":S$Xa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":S$Wa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":S$la.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":S$xa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":S$ha.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":S$Ra.vertexDeclaration,"POSITION,NORMAL,UV":S$Va.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":S$Qa.vertexDeclaration,"POSITION,NORMAL,COLOR":S$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":S$fa.vertexDeclaration,"POSITION,NORMAL":S$ka.vertexDeclaration,"POSITION,UV":S$Da.vertexDeclaration,POSITION:S$Ba.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),S$N}(),S$Ya=function(){function S$B(){}return S$Q(S$B,"laya.d3.loaders.MeshReader"),S$B.read=function(S$a,S$m,S$s,S$P,S$_){var S$e=new S$N(S$a);S$e.pos=0;var S$A=S$e.readUTFString();switch(S$A){case"LAYAMODEL:01":case"LAYASKINANI:01":S$B._readVersion01(S$e,S$A,S$m,S$s,S$P,S$_);break;case"LAYAMODEL:02":S$wa.parse(S$e,S$A,S$m,S$s,S$P,S$_);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":S$va.parse(S$e,S$A,S$m,S$P,S$_);break;default:throw new Error("MeshReader: unknown mesh version.")}S$m._setSubMeshes(S$P)},S$B._readVersion01=function(S$a,S$m,S$s,S$P,S$_,S$e){new S$ga(S$a,S$m,S$s,S$P,S$_,S$e)},S$B}(),S$Ta=function(){function S$a(S$a,S$m){this.min=null,this.max=null,this.min=S$a,this.max=S$m}S$Q(S$a,"laya.d3.math.BoundBox");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.getCorners=function(S$a){S$a.length=8;var S$m=this.min.elements,S$s=this.max.elements,S$P=S$m[0],S$_=S$m[1],S$e=S$m[2],S$A=S$s[0],S$B=S$s[1],S$k=S$s[2];S$a[0]=new S$Am(S$P,S$B,S$k),S$a[1]=new S$Am(S$A,S$B,S$k),S$a[2]=new S$Am(S$A,S$_,S$k),S$a[3]=new S$Am(S$P,S$_,S$k),S$a[4]=new S$Am(S$P,S$B,S$e),S$a[5]=new S$Am(S$A,S$B,S$e),S$a[6]=new S$Am(S$A,S$_,S$e),S$a[7]=new S$Am(S$P,S$_,S$e)},S$m.toDefault=function(){this.min.toDefault(),this.max.toDefault()},S$m.cloneTo=function(S$a){var S$m=S$a;this.min.cloneTo(S$m.min),this.max.cloneTo(S$m.max)},S$m.clone=function(){var S$a=new this.constructor(new S$Am,new S$Am);return this.cloneTo(S$a),S$a},S$a.createfromPoints=function(S$a,S$m){if(null==S$a)throw new Error("points");var S$s=S$m.min,S$P=S$m.max,S$_=S$s.elements;S$_[0]=Number.MAX_VALUE,S$_[1]=Number.MAX_VALUE,S$_[2]=Number.MAX_VALUE;var S$e=S$P.elements;S$e[0]=-Number.MAX_VALUE,S$e[1]=-Number.MAX_VALUE,S$e[2]=-Number.MAX_VALUE;for(var S$A=0,S$B=S$a.length;S$A<S$B;++S$A)S$Am.min(S$s,S$a[S$A],S$s),S$Am.max(S$P,S$a[S$A],S$P)},S$a.merge=function(S$a,S$m,S$s){S$Am.min(S$a.min,S$m.min,S$s.min),S$Am.max(S$a.max,S$m.max,S$s.max)},S$a}(),S$Ia=function(){function S$j(S$a){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=S$a,this._near=new S$mm(new S$Am),this._far=new S$mm(new S$Am),this._left=new S$mm(new S$Am),this._right=new S$mm(new S$Am),this._top=new S$mm(new S$Am),this._bottom=new S$mm(new S$Am),S$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}S$Q(S$j,"laya.d3.math.BoundFrustum");var S$a=S$j.prototype;return S$a.equalsBoundFrustum=function(S$a){return this._matrix.equalsOtherMatrix(S$a.matrix)},S$a.equalsObj=function(S$a){if(S$a instanceof laya.d3.math.BoundFrustum){var S$m=S$a;return this.equalsBoundFrustum(S$m)}return!1},S$a.getPlane=function(S$a){switch(S$a){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},S$a.getCorners=function(S$a){S$j._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(S$a[0]),S$j._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(S$a[1]),S$j._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(S$a[2]),S$j._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(S$a[3]),S$j._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(S$a[4]),S$j._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(S$a[5]),S$j._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(S$a[6]),S$j._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(S$a[7])},S$a.containsPoint=function(S$a){for(var S$m=S$mm.PlaneIntersectionType_Front,S$s=S$mm.PlaneIntersectionType_Front,S$P=0;S$P<6;S$P++){switch(S$P){case 0:S$s=Collision.intersectsPlaneAndPoint(this._near,S$a);break;case 1:S$s=Collision.intersectsPlaneAndPoint(this._far,S$a);break;case 2:S$s=Collision.intersectsPlaneAndPoint(this._left,S$a);break;case 3:S$s=Collision.intersectsPlaneAndPoint(this._right,S$a);break;case 4:S$s=Collision.intersectsPlaneAndPoint(this._top,S$a);break;case 5:S$s=Collision.intersectsPlaneAndPoint(this._bottom,S$a)}switch(S$s){case S$mm.PlaneIntersectionType_Back:return 0;case S$mm.PlaneIntersectionType_Intersecting:S$m=S$mm.PlaneIntersectionType_Intersecting}}switch(S$m){case S$mm.PlaneIntersectionType_Intersecting:return 2;default:return 1}},S$a.containsBoundBox=function(S$a){for(var S$m,S$s=S$j._tempV30,S$P=S$j._tempV31,S$_=1,S$e=0;S$e<6;S$e++){if(S$m=this.getPlane(S$e),this._getBoxToPlanePVertexNVertex(S$a,S$m.normal,S$s,S$P),Collision.intersectsPlaneAndPoint(S$m,S$s)===S$mm.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(S$m,S$P)===S$mm.PlaneIntersectionType_Back&&(S$_=2)}return S$_},S$a.containsBoundSphere=function(S$a){for(var S$m=S$mm.PlaneIntersectionType_Front,S$s=S$mm.PlaneIntersectionType_Front,S$P=0;S$P<6;S$P++){switch(S$P){case 0:S$s=Collision.intersectsPlaneAndSphere(this._near,S$a);break;case 1:S$s=Collision.intersectsPlaneAndSphere(this._far,S$a);break;case 2:S$s=Collision.intersectsPlaneAndSphere(this._left,S$a);break;case 3:S$s=Collision.intersectsPlaneAndSphere(this._right,S$a);break;case 4:S$s=Collision.intersectsPlaneAndSphere(this._top,S$a);break;case 5:S$s=Collision.intersectsPlaneAndSphere(this._bottom,S$a)}switch(S$s){case S$mm.PlaneIntersectionType_Back:return 0;case S$mm.PlaneIntersectionType_Intersecting:S$m=S$mm.PlaneIntersectionType_Intersecting}}switch(S$m){case S$mm.PlaneIntersectionType_Intersecting:return 2;default:return 1}},S$a._getBoxToPlanePVertexNVertex=function(S$a,S$m,S$s,S$P){var S$_=S$a.min,S$e=S$_.elements,S$A=S$a.max,S$B=S$A.elements,S$k=S$m.elements,S$j=S$k[0],S$G=S$k[1],S$y=S$k[2];S$_.cloneTo(S$s);var S$d=S$s.elements;0<=S$j&&(S$d[0]=S$B[0]),0<=S$G&&(S$d[1]=S$B[1]),0<=S$y&&(S$d[2]=S$B[2]),S$A.cloneTo(S$P);var S$Q=S$P.elements;0<=S$j&&(S$Q[0]=S$e[0]),0<=S$G&&(S$Q[1]=S$e[1]),0<=S$y&&(S$Q[2]=S$e[2])},S$q(0,S$a,"top",function(){return this._top}),S$q(0,S$a,"matrix",function(){return this._matrix},function(S$a){this._matrix=S$a,S$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),S$q(0,S$a,"near",function(){return this._near}),S$q(0,S$a,"far",function(){return this._far}),S$q(0,S$a,"left",function(){return this._left}),S$q(0,S$a,"right",function(){return this._right}),S$q(0,S$a,"bottom",function(){return this._bottom}),S$j._getPlanesFromMatrix=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){var S$B=S$a.elements,S$k=S$B[0],S$j=S$B[1],S$G=S$B[2],S$y=S$B[3],S$d=S$B[4],S$Q=S$B[5],S$q=S$B[6],S$h=S$B[7],S$u=S$B[8],S$O=S$B[9],S$p=S$B[10],S$c=S$B[11],S$H=S$B[12],S$o=S$B[13],S$N=S$B[14],S$z=S$B[15],S$U=S$m.normal.elements;S$U[0]=S$y+S$G,S$U[1]=S$h+S$q,S$U[2]=S$c+S$p,S$m.distance=S$z+S$N,S$m.normalize();var S$l=S$s.normal.elements;S$l[0]=S$y-S$G,S$l[1]=S$h-S$q,S$l[2]=S$c-S$p,S$s.distance=S$z-S$N,S$s.normalize();var S$C=S$P.normal.elements;S$C[0]=S$y+S$k,S$C[1]=S$h+S$d,S$C[2]=S$c+S$u,S$P.distance=S$z+S$H,S$P.normalize();var S$f=S$_.normal.elements;S$f[0]=S$y-S$k,S$f[1]=S$h-S$d,S$f[2]=S$c-S$u,S$_.distance=S$z-S$H,S$_.normalize();var S$K=S$e.normal.elements;S$K[0]=S$y-S$j,S$K[1]=S$h-S$Q,S$K[2]=S$c-S$O,S$e.distance=S$z-S$o,S$e.normalize();var S$V=S$A.normal.elements;S$V[0]=S$y+S$j,S$V[1]=S$h+S$Q,S$V[2]=S$c+S$O,S$A.distance=S$z+S$o,S$A.normalize()},S$j._get3PlaneInterPoint=function(S$a,S$m,S$s){var S$P=S$a.normal,S$_=S$m.normal,S$e=S$s.normal;S$Am.cross(S$_,S$e,S$j._tempV30),S$Am.cross(S$e,S$P,S$j._tempV31),S$Am.cross(S$P,S$_,S$j._tempV32);var S$A=S$Am.dot(S$P,S$j._tempV30),S$B=S$Am.dot(S$_,S$j._tempV31),S$k=S$Am.dot(S$e,S$j._tempV32);return S$Am.scale(S$j._tempV30,-S$a.distance/S$A,S$j._tempV33),S$Am.scale(S$j._tempV31,-S$m.distance/S$B,S$j._tempV34),S$Am.scale(S$j._tempV32,-S$s.distance/S$k,S$j._tempV35),S$Am.add(S$j._tempV33,S$j._tempV34,S$j._tempV36),S$Am.add(S$j._tempV35,S$j._tempV36,S$j._tempV37),S$j._tempV37},S$y(S$j,["_tempV30",function(){return this._tempV30=new S$Am},"_tempV31",function(){return this._tempV31=new S$Am},"_tempV32",function(){return this._tempV32=new S$Am},"_tempV33",function(){return this._tempV33=new S$Am},"_tempV34",function(){return this._tempV34=new S$Am},"_tempV35",function(){return this._tempV35=new S$Am},"_tempV36",function(){return this._tempV36=new S$Am},"_tempV37",function(){return this._tempV37=new S$Am}]),S$j}(),S$$a=function(){function S$G(S$a,S$m){this.center=null,this.radius=NaN,this.center=S$a,this.radius=S$m}S$Q(S$G,"laya.d3.math.BoundSphere");var S$a=S$G.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.toDefault=function(){this.center.toDefault(),this.radius=0},S$a.intersectsRayDistance=function(S$a){return Collision.intersectsRayAndSphereRD(S$a,this)},S$a.intersectsRayPoint=function(S$a,S$m){return Collision.intersectsRayAndSphereRP(S$a,this,S$m)},S$a.cloneTo=function(S$a){var S$m=S$a;this.center.cloneTo(S$m.center),S$m.radius=this.radius},S$a.clone=function(){var S$a=new this.constructor(new S$Am,new S$Am);return this.cloneTo(S$a),S$a},S$G.createFromSubPoints=function(S$a,S$m,S$s,S$P){if(null==S$a)throw new Error("points");if(S$m<0||S$m>=S$a.length)throw new Error("start"+S$m+"Must be in the range [0, "+(S$a.length-1)+"]");if(S$s<0||S$m+S$s>S$a.length)throw new Error("count"+S$s+"Must be in the range <= "+S$a.length+"}");var S$_=S$m+S$s,S$e=S$G._tempVector3;S$e.elements[0]=0,S$e.elements[1]=0,S$e.elements[2]=0;for(var S$A=S$m;S$A<S$_;++S$A)S$Am.add(S$a[S$A],S$e,S$e);var S$B=S$P.center;S$Am.scale(S$e,1/S$s,S$B);var S$k=0;for(S$A=S$m;S$A<S$_;++S$A){var S$j=S$Am.distanceSquared(S$B,S$a[S$A]);S$k<S$j&&(S$k=S$j)}S$P.radius=Math.sqrt(S$k)},S$G.createfromPoints=function(S$a,S$m){if(null==S$a)throw new Error("points");S$G.createFromSubPoints(S$a,0,S$a.length,S$m)},S$y(S$G,["_tempVector3",function(){return this._tempVector3=new S$Am}]),S$G}(),S$na=(function(){function S$a(){}S$Q(S$a,"laya.d3.math.ContainmentType"),S$a.Disjoint=0,S$a.Contains=1,S$a.Intersects=2}(),function(){function S$s(){}return S$Q(S$s,"laya.d3.math.MathUtils3D"),S$s.isZero=function(S$a){return Math.abs(S$a)<S$s.zeroTolerance},S$s.nearEqual=function(S$a,S$m){return!!S$s.isZero(S$a-S$m)},S$s.fastInvSqrt=function(S$a){return S$s.isZero(S$a)?S$a:1/Math.sqrt(S$a)},S$y(S$s,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),S$s}()),S$ra=function(){function S$k(){var S$a=this.elements=new Float32Array(9);S$a[0]=1,S$a[1]=0,S$a[2]=0,S$a[3]=0,S$a[4]=1,S$a[5]=0,S$a[6]=0,S$a[7]=0,S$a[8]=1}S$Q(S$k,"laya.d3.math.Matrix3x3");var S$a=S$k.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.determinant=function(){var S$a=this.elements,S$m=S$a[0],S$s=S$a[1],S$P=S$a[2],S$_=S$a[3],S$e=S$a[4],S$A=S$a[5],S$B=S$a[6],S$k=S$a[7],S$j=S$a[8];return S$m*(S$j*S$e-S$A*S$k)+S$s*(-S$j*S$_+S$A*S$B)+S$P*(S$k*S$_-S$e*S$B)},S$a.translate=function(S$a,S$m){var S$s=S$m.elements,S$P=this.elements,S$_=S$a.elements,S$e=S$P[0],S$A=S$P[1],S$B=S$P[2],S$k=S$P[3],S$j=S$P[4],S$G=S$P[5],S$y=S$P[6],S$d=S$P[7],S$Q=S$P[8],S$q=S$_[0],S$h=S$_[1];S$s[0]=S$e,S$s[1]=S$A,S$s[2]=S$B,S$s[3]=S$k,S$s[4]=S$j,S$s[5]=S$G,S$s[6]=S$q*S$e+S$h*S$k+S$y,S$s[7]=S$q*S$A+S$h*S$j+S$d,S$s[8]=S$q*S$B+S$h*S$G+S$Q},S$a.rotate=function(S$a,S$m){var S$s=S$m.elements,S$P=this.elements,S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$P[3],S$k=S$P[4],S$j=S$P[5],S$G=S$P[6],S$y=S$P[7],S$d=S$P[8],S$Q=Math.sin(S$a),S$q=Math.cos(S$a);S$s[0]=S$q*S$_+S$Q*S$B,S$s[1]=S$q*S$e+S$Q*S$k,S$s[2]=S$q*S$A+S$Q*S$j,S$s[3]=S$q*S$B-S$Q*S$_,S$s[4]=S$q*S$k-S$Q*S$e,S$s[5]=S$q*S$j-S$Q*S$A,S$s[6]=S$G,S$s[7]=S$y,S$s[8]=S$d},S$a.scale=function(S$a,S$m){var S$s=S$m.elements,S$P=this.elements,S$_=S$a.elements,S$e=S$_[0],S$A=S$_[1];S$s[0]=S$e*S$P[0],S$s[1]=S$e*S$P[1],S$s[2]=S$e*S$P[2],S$s[3]=S$A*S$P[3],S$s[4]=S$A*S$P[4],S$s[5]=S$A*S$P[5],S$s[6]=S$P[6],S$s[7]=S$P[7],S$s[8]=S$P[8]},S$a.invert=function(S$a){var S$m=S$a.elements,S$s=this.elements,S$P=S$s[0],S$_=S$s[1],S$e=S$s[2],S$A=S$s[3],S$B=S$s[4],S$k=S$s[5],S$j=S$s[6],S$G=S$s[7],S$y=S$s[8],S$d=S$y*S$B-S$k*S$G,S$Q=-S$y*S$A+S$k*S$j,S$q=S$G*S$A-S$B*S$j,S$h=S$P*S$d+S$_*S$Q+S$e*S$q;S$h||(S$a=null),S$h=1/S$h,S$m[0]=S$d*S$h,S$m[1]=(-S$y*S$_+S$e*S$G)*S$h,S$m[2]=(S$k*S$_-S$e*S$B)*S$h,S$m[3]=S$Q*S$h,S$m[4]=(S$y*S$P-S$e*S$j)*S$h,S$m[5]=(-S$k*S$P+S$e*S$A)*S$h,S$m[6]=S$q*S$h,S$m[7]=(-S$G*S$P+S$_*S$j)*S$h,S$m[8]=(S$B*S$P-S$_*S$A)*S$h},S$a.transpose=function(S$a){var S$m=S$a.elements,S$s=this.elements;if(S$a===this){var S$P=S$s[1],S$_=S$s[2],S$e=S$s[5];S$m[1]=S$s[3],S$m[2]=S$s[6],S$m[3]=S$P,S$m[5]=S$s[7],S$m[6]=S$_,S$m[7]=S$e}else S$m[0]=S$s[0],S$m[1]=S$s[3],S$m[2]=S$s[6],S$m[3]=S$s[1],S$m[4]=S$s[4],S$m[5]=S$s[7],S$m[6]=S$s[2],S$m[7]=S$s[5],S$m[8]=S$s[8]},S$a.identity=function(){var S$a=this.elements;S$a[0]=1,S$a[1]=0,S$a[2]=0,S$a[3]=0,S$a[4]=1,S$a[5]=0,S$a[6]=0,S$a[7]=0,S$a[8]=1},S$a.cloneTo=function(S$a){var S$m,S$s,S$P;if((S$s=this.elements)!==(S$P=S$a.elements))for(S$m=0;S$m<9;++S$m)S$P[S$m]=S$s[S$m]},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$k.createFromTranslation=function(S$a,S$m){S$m.elements;var S$s=S$a.elements;S$m[0]=1,S$m[1]=0,S$m[2]=0,S$m[3]=0,S$m[4]=1,S$m[5]=0,S$m[6]=S$s[0],S$m[7]=S$s[1],S$m[8]=1},S$k.createFromRotation=function(S$a,S$m){var S$s=S$m.elements,S$P=Math.sin(S$a),S$_=Math.cos(S$a);S$s[0]=S$_,S$s[1]=S$P,S$s[2]=0,S$s[3]=-S$P,S$s[4]=S$_,S$s[5]=0,S$s[6]=0,S$s[7]=0,S$s[8]=1},S$k.createFromScaling=function(S$a,S$m){var S$s=S$m.elements,S$P=S$a.elements;S$s[0]=S$P[0],S$s[1]=0,S$s[2]=0,S$s[3]=0,S$s[4]=S$P[1],S$s[5]=0,S$s[6]=0,S$s[7]=0,S$s[8]=1},S$k.createFromMatrix4x4=function(S$a,S$m){S$m[0]=S$a[0],S$m[1]=S$a[1],S$m[2]=S$a[2],S$m[3]=S$a[4],S$m[4]=S$a[5],S$m[5]=S$a[6],S$m[6]=S$a[8],S$m[7]=S$a[9],S$m[8]=S$a[10]},S$k.multiply=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements,S$A=S$_[0],S$B=S$_[1],S$k=S$_[2],S$j=S$_[3],S$G=S$_[4],S$y=S$_[5],S$d=S$_[6],S$Q=S$_[7],S$q=S$_[8],S$h=S$e[0],S$u=S$e[1],S$O=S$e[2],S$p=S$e[3],S$c=S$e[4],S$H=S$e[5],S$o=S$e[6],S$N=S$e[7],S$z=S$e[8];S$P[0]=S$h*S$A+S$u*S$j+S$O*S$d,S$P[1]=S$h*S$B+S$u*S$G+S$O*S$Q,S$P[2]=S$h*S$k+S$u*S$y+S$O*S$q,S$P[3]=S$p*S$A+S$c*S$j+S$H*S$d,S$P[4]=S$p*S$B+S$c*S$G+S$H*S$Q,S$P[5]=S$p*S$k+S$c*S$y+S$H*S$q,S$P[6]=S$o*S$A+S$N*S$j+S$z*S$d,S$P[7]=S$o*S$B+S$N*S$G+S$z*S$Q,S$P[8]=S$o*S$k+S$N*S$y+S$z*S$q},S$k.lookAt=function(S$a,S$m,S$s,S$P){S$Am.subtract(S$a,S$m,S$k._tempV30),S$Am.normalize(S$k._tempV30,S$k._tempV30),S$Am.cross(S$s,S$k._tempV30,S$k._tempV31),S$Am.normalize(S$k._tempV31,S$k._tempV31),S$Am.cross(S$k._tempV30,S$k._tempV31,S$k._tempV32);var S$_=S$k._tempV30.elements,S$e=S$k._tempV31.elements,S$A=S$k._tempV32.elements,S$B=S$P.elements;S$B[0]=S$e[0],S$B[3]=S$e[1],S$B[6]=S$e[2],S$B[1]=S$A[0],S$B[4]=S$A[1],S$B[7]=S$A[2],S$B[2]=S$_[0],S$B[5]=S$_[1],S$B[8]=S$_[2]},S$k.DEFAULT=new S$k,S$y(S$k,["_tempV30",function(){return this._tempV30=new S$Am},"_tempV31",function(){return this._tempV31=new S$Am},"_tempV32",function(){return this._tempV32=new S$Am}]),S$k}(),S$am=function(){function S$l(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y,S$d,S$Q,S$q,S$h){void 0===S$a&&(S$a=1),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=1),void 0===S$A&&(S$A=0),void 0===S$B&&(S$B=0),void 0===S$k&&(S$k=0),void 0===S$j&&(S$j=0),void 0===S$G&&(S$G=1),void 0===S$y&&(S$y=0),void 0===S$d&&(S$d=0),void 0===S$Q&&(S$Q=0),void 0===S$q&&(S$q=0),void 0===S$h&&(S$h=1);var S$u=this.elements=new Float32Array(16);S$u[0]=S$a,S$u[1]=S$m,S$u[2]=S$s,S$u[3]=S$P,S$u[4]=S$_,S$u[5]=S$e,S$u[6]=S$A,S$u[7]=S$B,S$u[8]=S$k,S$u[9]=S$j,S$u[10]=S$G,S$u[11]=S$y,S$u[12]=S$d,S$u[13]=S$Q,S$u[14]=S$q,S$u[15]=S$h}S$Q(S$l,"laya.d3.math.Matrix4x4");var S$a=S$l.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.getElementByRowColumn=function(S$a,S$m){if(S$a<0||3<S$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(S$m<0||3<S$m)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*S$a+S$m]},S$a.setElementByRowColumn=function(S$a,S$m,S$s){if(S$a<0||3<S$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(S$m<0||3<S$m)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*S$a+S$m]=S$s},S$a.equalsOtherMatrix=function(S$a){var S$m=this.elements,S$s=S$a.elements;return S$na.nearEqual(S$m[0],S$s[0])&&S$na.nearEqual(S$m[1],S$s[1])&&S$na.nearEqual(S$m[2],S$s[2])&&S$na.nearEqual(S$m[3],S$s[3])&&S$na.nearEqual(S$m[4],S$s[4])&&S$na.nearEqual(S$m[5],S$s[5])&&S$na.nearEqual(S$m[6],S$s[6])&&S$na.nearEqual(S$m[7],S$s[7])&&S$na.nearEqual(S$m[8],S$s[8])&&S$na.nearEqual(S$m[9],S$s[9])&&S$na.nearEqual(S$m[10],S$s[10])&&S$na.nearEqual(S$m[11],S$s[11])&&S$na.nearEqual(S$m[12],S$s[12])&&S$na.nearEqual(S$m[13],S$s[13])&&S$na.nearEqual(S$m[14],S$s[14])&&S$na.nearEqual(S$m[15],S$s[15])},S$a.decomposeTransRotScale=function(S$a,S$m,S$s){var S$P=S$l._tempMatrix4x4;return this.decomposeTransRotMatScale(S$a,S$P,S$s)?(S$sm.createFromMatrix4x4(S$P,S$m),!0):(S$m.identity(),!1)},S$a.decomposeTransRotMatScale=function(S$a,S$m,S$s){var S$P=this.elements,S$_=S$a.elements,S$e=S$m.elements,S$A=S$s.elements;S$_[0]=S$P[12],S$_[1]=S$P[13],S$_[2]=S$P[14];var S$B=S$P[0],S$k=S$P[1],S$j=S$P[2],S$G=S$P[4],S$y=S$P[5],S$d=S$P[6],S$Q=S$P[8],S$q=S$P[9],S$h=S$P[10],S$u=S$A[0]=Math.sqrt(S$B*S$B+S$k*S$k+S$j*S$j),S$O=S$A[1]=Math.sqrt(S$G*S$G+S$y*S$y+S$d*S$d),S$p=S$A[2]=Math.sqrt(S$Q*S$Q+S$q*S$q+S$h*S$h);if(S$na.isZero(S$u)||S$na.isZero(S$O)||S$na.isZero(S$p))return S$e[1]=S$e[2]=S$e[3]=S$e[4]=S$e[6]=S$e[7]=S$e[8]=S$e[9]=S$e[11]=S$e[12]=S$e[13]=S$e[14]=0,S$e[0]=S$e[5]=S$e[10]=S$e[15]=1,!1;var S$c=S$l._tempVector0,S$H=S$c.elements;S$H[0]=S$Q/S$p,S$H[1]=S$q/S$p,S$H[2]=S$h/S$p;var S$o=S$l._tempVector1,S$N=S$o.elements;S$N[0]=S$B/S$u,S$N[1]=S$k/S$u,S$N[2]=S$j/S$u;var S$z=S$l._tempVector2;S$Am.cross(S$c,S$o,S$z);var S$U=S$l._tempVector1;return S$Am.cross(S$z,S$c,S$U),S$e[3]=S$e[7]=S$e[11]=S$e[12]=S$e[13]=S$e[14]=0,S$e[15]=1,S$e[0]=S$U.x,S$e[1]=S$U.y,S$e[2]=S$U.z,S$e[4]=S$z.x,S$e[5]=S$z.y,S$e[6]=S$z.z,S$e[8]=S$c.x,S$e[9]=S$c.y,S$e[10]=S$c.z,S$e[0]*S$B+S$e[1]*S$k+S$e[2]*S$j<0&&(S$A[0]=-S$u),S$e[4]*S$G+S$e[5]*S$y+S$e[6]*S$d<0&&(S$A[1]=-S$O),S$e[8]*S$Q+S$e[9]*S$q+S$e[10]*S$h<0&&(S$A[2]=-S$p),!0},S$a.decomposeYawPitchRoll=function(S$a){var S$m=S$a.elements,S$s=Math.asin(-this.elements[9]);S$m[1]=S$s,Math.cos(S$s)>S$na.zeroTolerance?(S$m[2]=Math.atan2(this.elements[1],this.elements[5]),S$m[0]=Math.atan2(this.elements[8],this.elements[10])):(S$m[2]=Math.atan2(-this.elements[4],this.elements[0]),S$m[0]=0)},S$a.normalize=function(){var S$a=this.elements,S$m=S$a[0],S$s=S$a[1],S$P=S$a[2],S$_=Math.sqrt(S$m*S$m+S$s*S$s+S$P*S$P);if(!S$_)return S$a[0]=0,S$a[1]=0,void(S$a[2]=0);1!=S$_&&(S$_=1/S$_,S$a[0]=S$m*S$_,S$a[1]=S$s*S$_,S$a[2]=S$P*S$_)},S$a.transpose=function(){var S$a,S$m;return S$m=(S$a=this.elements)[1],S$a[1]=S$a[4],S$a[4]=S$m,S$m=S$a[2],S$a[2]=S$a[8],S$a[8]=S$m,S$m=S$a[3],S$a[3]=S$a[12],S$a[12]=S$m,S$m=S$a[6],S$a[6]=S$a[9],S$a[9]=S$m,S$m=S$a[7],S$a[7]=S$a[13],S$a[13]=S$m,S$m=S$a[11],S$a[11]=S$a[14],S$a[14]=S$m,this},S$a.invert=function(S$a){var S$m=this.elements,S$s=S$a.elements,S$P=S$m[0],S$_=S$m[1],S$e=S$m[2],S$A=S$m[3],S$B=S$m[4],S$k=S$m[5],S$j=S$m[6],S$G=S$m[7],S$y=S$m[8],S$d=S$m[9],S$Q=S$m[10],S$q=S$m[11],S$h=S$m[12],S$u=S$m[13],S$O=S$m[14],S$p=S$m[15],S$c=S$P*S$k-S$_*S$B,S$H=S$P*S$j-S$e*S$B,S$o=S$P*S$G-S$A*S$B,S$N=S$_*S$j-S$e*S$k,S$z=S$_*S$G-S$A*S$k,S$U=S$e*S$G-S$A*S$j,S$l=S$y*S$u-S$d*S$h,S$C=S$y*S$O-S$Q*S$h,S$f=S$y*S$p-S$q*S$h,S$K=S$d*S$O-S$Q*S$u,S$V=S$d*S$p-S$q*S$u,S$W=S$Q*S$p-S$q*S$O,S$b=S$c*S$W-S$H*S$V+S$o*S$K+S$N*S$f-S$z*S$C+S$U*S$l;0!==Math.abs(S$b)&&(S$b=1/S$b,S$s[0]=(S$k*S$W-S$j*S$V+S$G*S$K)*S$b,S$s[1]=(S$e*S$V-S$_*S$W-S$A*S$K)*S$b,S$s[2]=(S$u*S$U-S$O*S$z+S$p*S$N)*S$b,S$s[3]=(S$Q*S$z-S$d*S$U-S$q*S$N)*S$b,S$s[4]=(S$j*S$f-S$B*S$W-S$G*S$C)*S$b,S$s[5]=(S$P*S$W-S$e*S$f+S$A*S$C)*S$b,S$s[6]=(S$O*S$o-S$h*S$U-S$p*S$H)*S$b,S$s[7]=(S$y*S$U-S$Q*S$o+S$q*S$H)*S$b,S$s[8]=(S$B*S$V-S$k*S$f+S$G*S$l)*S$b,S$s[9]=(S$_*S$f-S$P*S$V-S$A*S$l)*S$b,S$s[10]=(S$h*S$z-S$u*S$o+S$p*S$c)*S$b,S$s[11]=(S$d*S$o-S$y*S$z-S$q*S$c)*S$b,S$s[12]=(S$k*S$C-S$B*S$K-S$j*S$l)*S$b,S$s[13]=(S$P*S$K-S$_*S$C+S$e*S$l)*S$b,S$s[14]=(S$u*S$H-S$h*S$N-S$O*S$c)*S$b,S$s[15]=(S$y*S$N-S$d*S$H+S$Q*S$c)*S$b)},S$a.identity=function(){var S$a=this.elements;S$a[1]=S$a[2]=S$a[3]=S$a[4]=S$a[6]=S$a[7]=S$a[8]=S$a[9]=S$a[11]=S$a[12]=S$a[13]=S$a[14]=0,S$a[0]=S$a[5]=S$a[10]=S$a[15]=1},S$a.cloneTo=function(S$a){var S$m,S$s,S$P;if((S$s=this.elements)!==(S$P=S$a.elements))for(S$m=0;S$m<16;++S$m)S$P[S$m]=S$s[S$m]},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$a.getTranslationVector=function(S$a){var S$m=this.elements,S$s=S$a.elements;S$s[0]=S$m[12],S$s[1]=S$m[13],S$s[2]=S$m[14]},S$a.setTranslationVector=function(S$a){var S$m=this.elements,S$s=S$a.elements;S$m[12]=S$s[0],S$m[13]=S$s[1],S$m[14]=S$s[2]},S$a.getForward=function(S$a){var S$m=this.elements,S$s=S$a.elements;S$s[0]=-S$m[8],S$s[1]=-S$m[9],S$s[2]=-S$m[10]},S$a.setForward=function(S$a){var S$m=this.elements,S$s=S$a.elements;S$m[8]=-S$s[0],S$m[9]=-S$s[1],S$m[10]=-S$s[2]},S$l.createRotationX=function(S$a,S$m){var S$s=S$m.elements,S$P=Math.sin(S$a),S$_=Math.cos(S$a);S$s[1]=S$s[2]=S$s[3]=S$s[4]=S$s[7]=S$s[8]=S$s[11]=S$s[12]=S$s[13]=S$s[14]=0,S$s[0]=S$s[15]=1,S$s[5]=S$s[10]=S$_,S$s[6]=S$P,S$s[9]=-S$P},S$l.createRotationY=function(S$a,S$m){var S$s=S$m.elements,S$P=Math.sin(S$a),S$_=Math.cos(S$a);S$s[1]=S$s[3]=S$s[4]=S$s[6]=S$s[7]=S$s[9]=S$s[11]=S$s[12]=S$s[13]=S$s[14]=0,S$s[5]=S$s[15]=1,S$s[0]=S$s[10]=S$_,S$s[2]=-S$P,S$s[8]=S$P},S$l.createRotationZ=function(S$a,S$m){var S$s=S$m.elements,S$P=Math.sin(S$a),S$_=Math.cos(S$a);S$s[2]=S$s[3]=S$s[6]=S$s[7]=S$s[8]=S$s[9]=S$s[11]=S$s[12]=S$s[13]=S$s[14]=0,S$s[10]=S$s[15]=1,S$s[0]=S$s[5]=S$_,S$s[1]=S$P,S$s[4]=-S$P},S$l.createRotationYawPitchRoll=function(S$a,S$m,S$s,S$P){S$sm.createFromYawPitchRoll(S$a,S$m,S$s,S$l._tempQuaternion),S$l.createRotationQuaternion(S$l._tempQuaternion,S$P)},S$l.createRotationAxis=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=Math.cos(S$m),S$k=Math.sin(S$m),S$j=S$_*S$_,S$G=S$e*S$e,S$y=S$A*S$A,S$d=S$_*S$e,S$Q=S$_*S$A,S$q=S$e*S$A,S$h=S$s.elements;S$h[3]=S$h[7]=S$h[11]=S$h[12]=S$h[13]=S$h[14]=0,S$h[15]=1,S$h[0]=S$j+S$B*(1-S$j),S$h[1]=S$d-S$B*S$d+S$k*S$A,S$h[2]=S$Q-S$B*S$Q-S$k*S$e,S$h[4]=S$d-S$B*S$d-S$k*S$A,S$h[5]=S$G+S$B*(1-S$G),S$h[6]=S$q-S$B*S$q+S$k*S$_,S$h[8]=S$Q-S$B*S$Q+S$k*S$e,S$h[9]=S$q-S$B*S$q-S$k*S$_,S$h[10]=S$y+S$B*(1-S$y)},S$l.createRotationQuaternion=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$s[0],S$e=S$s[1],S$A=S$s[2],S$B=S$s[3],S$k=S$_*S$_,S$j=S$e*S$e,S$G=S$A*S$A,S$y=S$_*S$e,S$d=S$A*S$B,S$Q=S$A*S$_,S$q=S$e*S$B,S$h=S$e*S$A,S$u=S$_*S$B;S$P[3]=S$P[7]=S$P[11]=S$P[12]=S$P[13]=S$P[14]=0,S$P[15]=1,S$P[0]=1-2*(S$j+S$G),S$P[1]=2*(S$y+S$d),S$P[2]=2*(S$Q-S$q),S$P[4]=2*(S$y-S$d),S$P[5]=1-2*(S$G+S$k),S$P[6]=2*(S$h+S$u),S$P[8]=2*(S$Q+S$q),S$P[9]=2*(S$h-S$u),S$P[10]=1-2*(S$j+S$k)},S$l.createTranslate=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;S$P[4]=S$P[8]=S$P[1]=S$P[9]=S$P[2]=S$P[6]=S$P[3]=S$P[7]=S$P[11]=0,S$P[0]=S$P[5]=S$P[10]=S$P[15]=1,S$P[12]=S$s[0],S$P[13]=S$s[1],S$P[14]=S$s[2]},S$l.createScaling=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;S$P[0]=S$s[0],S$P[5]=S$s[1],S$P[10]=S$s[2],S$P[1]=S$P[4]=S$P[8]=S$P[12]=S$P[9]=S$P[13]=S$P[2]=S$P[6]=S$P[14]=S$P[3]=S$P[7]=S$P[11]=0,S$P[15]=1},S$l.multiply=function(S$a,S$m,S$s){var S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G;for(S$_=S$s.elements,S$e=S$a.elements,S$_===(S$A=S$m.elements)&&(S$A=S$A.slice()),S$P=0;S$P<4;S$P++)S$B=S$e[S$P],S$k=S$e[S$P+4],S$j=S$e[S$P+8],S$G=S$e[S$P+12],S$_[S$P]=S$B*S$A[0]+S$k*S$A[1]+S$j*S$A[2]+S$G*S$A[3],S$_[S$P+4]=S$B*S$A[4]+S$k*S$A[5]+S$j*S$A[6]+S$G*S$A[7],S$_[S$P+8]=S$B*S$A[8]+S$k*S$A[9]+S$j*S$A[10]+S$G*S$A[11],S$_[S$P+12]=S$B*S$A[12]+S$k*S$A[13]+S$j*S$A[14]+S$G*S$A[15]},S$l.createFromQuaternion=function(S$a,S$m){var S$s=S$m.elements,S$P=S$a.elements,S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$P[3],S$k=S$_+S$_,S$j=S$e+S$e,S$G=S$A+S$A,S$y=S$_*S$k,S$d=S$e*S$k,S$Q=S$e*S$j,S$q=S$A*S$k,S$h=S$A*S$j,S$u=S$A*S$G,S$O=S$B*S$k,S$p=S$B*S$j,S$c=S$B*S$G;S$s[0]=1-S$Q-S$u,S$s[1]=S$d+S$c,S$s[2]=S$q-S$p,S$s[3]=0,S$s[4]=S$d-S$c,S$s[5]=1-S$y-S$u,S$s[6]=S$h+S$O,S$s[7]=0,S$s[8]=S$q+S$p,S$s[9]=S$h-S$O,S$s[10]=1-S$y-S$Q,S$s[11]=0,S$s[12]=0,S$s[13]=0,S$s[14]=0,S$s[15]=1},S$l.createAffineTransformation=function(S$a,S$m,S$s,S$P){var S$_=S$a.elements,S$e=S$m.elements,S$A=S$s.elements,S$B=S$P.elements,S$k=S$e[0],S$j=S$e[1],S$G=S$e[2],S$y=S$e[3],S$d=S$k+S$k,S$Q=S$j+S$j,S$q=S$G+S$G,S$h=S$k*S$d,S$u=S$k*S$Q,S$O=S$k*S$q,S$p=S$j*S$Q,S$c=S$j*S$q,S$H=S$G*S$q,S$o=S$y*S$d,S$N=S$y*S$Q,S$z=S$y*S$q,S$U=S$A[0],S$l=S$A[1],S$C=S$A[2];S$B[0]=(1-(S$p+S$H))*S$U,S$B[1]=(S$u+S$z)*S$U,S$B[2]=(S$O-S$N)*S$U,S$B[3]=0,S$B[4]=(S$u-S$z)*S$l,S$B[5]=(1-(S$h+S$H))*S$l,S$B[6]=(S$c+S$o)*S$l,S$B[7]=0,S$B[8]=(S$O+S$N)*S$C,S$B[9]=(S$c-S$o)*S$C,S$B[10]=(1-(S$h+S$p))*S$C,S$B[11]=0,S$B[12]=S$_[0],S$B[13]=S$_[1],S$B[14]=S$_[2],S$B[15]=1},S$l.createLookAt=function(S$a,S$m,S$s,S$P){var S$_=S$P.elements,S$e=S$l._tempVector0,S$A=S$l._tempVector1,S$B=S$l._tempVector2;S$Am.subtract(S$a,S$m,S$B),S$Am.normalize(S$B,S$B),S$Am.cross(S$s,S$B,S$e),S$Am.normalize(S$e,S$e),S$Am.cross(S$B,S$e,S$A),S$P.identity(),S$_[0]=S$e.x,S$_[4]=S$e.y,S$_[8]=S$e.z,S$_[1]=S$A.x,S$_[5]=S$A.y,S$_[9]=S$A.z,S$_[2]=S$B.x,S$_[6]=S$B.y,S$_[10]=S$B.z,S$_[12]=-S$Am.dot(S$e,S$a),S$_[13]=-S$Am.dot(S$A,S$a),S$_[14]=-S$Am.dot(S$B,S$a)},S$l.createPerspective=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$_.elements,S$A=1/Math.tan(S$a/2),S$B=1/(S$s-S$P);S$e[0]=S$A/S$m,S$e[5]=S$A,S$e[10]=(S$P+S$s)*S$B,S$e[11]=-1,S$e[14]=2*S$P*S$s*S$B,S$e[1]=S$e[2]=S$e[3]=S$e[4]=S$e[6]=S$e[7]=S$e[8]=S$e[9]=S$e[12]=S$e[13]=S$e[15]=0},S$l.createOrthoOffCenterRH=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){var S$B=S$A.elements,S$k=1/(S$a-S$m),S$j=1/(S$s-S$P),S$G=1/(S$_-S$e);S$B[1]=S$B[2]=S$B[3]=S$B[4]=S$B[6]=S$B[7]=S$B[8]=S$B[9]=S$B[11]=0,S$B[15]=1,S$B[0]=-2*S$k,S$B[5]=-2*S$j,S$B[10]=2*S$G,S$B[12]=(S$a+S$m)*S$k,S$B[13]=(S$P+S$s)*S$j,S$B[14]=(S$e+S$_)*S$G},S$l.translation=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;S$P[0]=S$P[5]=S$P[10]=S$P[15]=1,S$P[12]=S$s[0],S$P[13]=S$s[1],S$P[14]=S$s[2]},S$y(S$l,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new S$l},"_tempVector0",function(){return this._tempVector0=new S$Am},"_tempVector1",function(){return this._tempVector1=new S$Am},"_tempVector2",function(){return this._tempVector2=new S$Am},"_tempQuaternion",function(){return this._tempQuaternion=new S$sm},"DEFAULT",function(){return this.DEFAULT=new S$l},"ZERO",function(){return this.ZERO=new S$l(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),S$l}(),S$mm=(function(){function S$c(S$a,S$m){this.extents=null,this.transformation=null,this.extents=S$a,this.transformation=S$m}S$Q(S$c,"laya.d3.math.OrientedBoundBox");var S$a=S$c.prototype;S$a.getCorners=function(S$a){var S$m=S$c._tempV30.elements,S$s=S$c._tempV31.elements,S$P=S$c._tempV32.elements,S$_=this.extents.elements;S$m[0]=S$_[0],S$m[1]=S$m[2]=0,S$s[1]=S$_[1],S$s[0]=S$s[2]=0,S$P[2]=S$_[2],S$P[0]=S$P[1]=0,S$Am.TransformNormal(S$c._tempV30,this.transformation,S$c._tempV30),S$Am.TransformNormal(S$c._tempV31,this.transformation,S$c._tempV31),S$Am.TransformNormal(S$c._tempV32,this.transformation,S$c._tempV32);var S$e=S$c._tempV33;this.transformation.getTranslationVector(S$e),S$a.length=8,S$Am.add(S$e,S$c._tempV30,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV32,S$a[0]),S$Am.add(S$e,S$c._tempV30,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV32,S$a[1]),S$Am.subtract(S$e,S$c._tempV30,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV32,S$a[2]),S$Am.subtract(S$e,S$c._tempV30,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV32,S$a[3]),S$Am.add(S$e,S$c._tempV30,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV32,S$a[4]),S$Am.add(S$e,S$c._tempV30,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV32,S$a[5]),S$Am.subtract(S$e,S$c._tempV30,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV32,S$a[6]),S$Am.subtract(S$e,S$c._tempV30,S$c._tempV34),S$Am.subtract(S$c._tempV34,S$c._tempV31,S$c._tempV34),S$Am.add(S$c._tempV34,S$c._tempV32,S$a[7])},S$a.transform=function(S$a){S$am.multiply(this.transformation,S$a,this.transformation)},S$a.scale=function(S$a){S$Am.multiply(this.extents,S$a,this.extents)},S$a.translate=function(S$a){this.transformation.getTranslationVector(S$c._tempV30),S$Am.add(S$c._tempV30,S$a,S$c._tempV31),this.transformation.setTranslationVector(S$c._tempV31)},S$a.Size=function(S$a){S$Am.scale(this.extents,2,S$a)},S$a.getSize=function(S$a){var S$m=this.extents.elements;S$c._tempV30.x=S$m[0],S$c._tempV31.y=S$m[1],S$c._tempV32.z=S$m[2],S$Am.TransformNormal(S$c._tempV30,this.transformation,S$c._tempV30),S$Am.TransformNormal(S$c._tempV31,this.transformation,S$c._tempV31),S$Am.TransformNormal(S$c._tempV31,this.transformation,S$c._tempV32);var S$s=S$a.elements;S$s[0]=S$Am.scalarLength(S$c._tempV30),S$s[1]=S$Am.scalarLength(S$c._tempV31),S$s[2]=S$Am.scalarLength(S$c._tempV32)},S$a.getSizeSquared=function(S$a){var S$m=this.extents.elements;S$c._tempV30.x=S$m[0],S$c._tempV31.y=S$m[1],S$c._tempV32.z=S$m[2],S$Am.TransformNormal(S$c._tempV30,this.transformation,S$c._tempV30),S$Am.TransformNormal(S$c._tempV31,this.transformation,S$c._tempV31),S$Am.TransformNormal(S$c._tempV31,this.transformation,S$c._tempV32);var S$s=S$a.elements;S$s[0]=S$Am.scalarLengthSquared(S$c._tempV30),S$s[1]=S$Am.scalarLengthSquared(S$c._tempV31),S$s[2]=S$Am.scalarLengthSquared(S$c._tempV32)},S$a.getCenter=function(S$a){this.transformation.getTranslationVector(S$a)},S$a.containsPoint=function(S$a){var S$m=this.extents.elements,S$s=S$m[0],S$P=S$m[1],S$_=S$m[2];this.transformation.invert(S$c._tempM0),S$Am.transformCoordinate(S$a,S$c._tempM0,S$c._tempV30);var S$e=S$c._tempV30.elements,S$A=Math.abs(S$e[0]),S$B=Math.abs(S$e[1]),S$k=Math.abs(S$e[2]);return S$na.nearEqual(S$A,S$s)&&S$na.nearEqual(S$B,S$P)&&S$na.nearEqual(S$k,S$_)?2:S$A<S$s&&S$B<S$P&&S$k<S$_?1:0},S$a.containsPoints=function(S$a){var S$m=this.extents.elements,S$s=S$m[0],S$P=S$m[1],S$_=S$m[2];this.transformation.invert(S$c._tempM0);for(var S$e=!0,S$A=!1,S$B=0;S$B<S$a.length;S$B++){S$Am.transformCoordinate(S$a[S$B],S$c._tempM0,S$c._tempV30);var S$k=S$c._tempV30.elements,S$j=Math.abs(S$k[0]),S$G=Math.abs(S$k[1]),S$y=Math.abs(S$k[2]);S$na.nearEqual(S$j,S$s)&&S$na.nearEqual(S$G,S$P)&&S$na.nearEqual(S$y,S$_)&&(S$A=!0),S$j<S$s&&S$G<S$P&&S$y<S$_?S$A=!0:S$e=!1}return S$e?1:S$A?2:0},S$a.containsSphere=function(S$a,S$m){void 0===S$m&&(S$m=!1);var S$s=this.extents.elements,S$P=S$s[0],S$_=S$s[1],S$e=S$s[2],S$A=S$a.radius;this.transformation.invert(S$c._tempM0),S$Am.transformCoordinate(S$a.center,S$c._tempM0,S$c._tempV30);var S$B=NaN;if(S$B=S$m?S$A:(S$Am.scale(S$Am.UnitX,S$A,S$c._tempV31),S$Am.TransformNormal(S$c._tempV31,S$c._tempM0,S$c._tempV31),S$Am.scalarLength(S$c._tempV31)),S$Am.scale(this.extents,-1,S$c._tempV32),S$Am.Clamp(S$c._tempV30,S$c._tempV32,this.extents,S$c._tempV33),S$B*S$B<S$Am.distanceSquared(S$c._tempV30,S$c._tempV33))return 0;var S$k=S$c._tempV30.elements,S$j=S$k[0],S$G=S$k[1],S$y=S$k[2],S$d=S$c._tempV32.elements,S$Q=S$d[0],S$q=S$d[1],S$h=S$d[2];return S$Q+S$B<=S$j&&S$j<=S$P-S$B&&S$B<S$P-S$Q&&S$q+S$B<=S$G&&S$G<=S$_-S$B&&S$B<S$_-S$q&&S$h+S$B<=S$y&&S$y<=S$e-S$B&&S$B<S$e-S$h?1:2},S$a.containsOrientedBoundBox=function(S$a){var S$m=0,S$s=0;S$a.getCorners(S$c._corners);var S$P=this.containsPoints(S$c._corners);if(0!=S$P)return S$P;var S$_=this.extents.elements;S$a.extents.cloneTo(S$c._tempV35);var S$e=S$c._tempV35.elements;S$c._getRows(this.transformation,S$c._rows1),S$c._getRows(S$a.transformation,S$c._rows2);var S$A=NaN;for(S$m=0;S$m<4;S$m++)for(S$s=0;S$s<4;S$s++)3==S$m||3==S$s?(S$c._tempM0.setElementByRowColumn(S$m,S$s,0),S$c._tempM1.setElementByRowColumn(S$m,S$s,0)):(S$A=S$Am.dot(S$c._rows1[S$m],S$c._rows2[S$s]),S$c._tempM0.setElementByRowColumn(S$m,S$s,S$A),S$c._tempM1.setElementByRowColumn(S$m,S$s,Math.abs(S$A)));S$a.getCenter(S$c._tempV34),this.getCenter(S$c._tempV36),S$Am.subtract(S$c._tempV34,S$c._tempV36,S$c._tempV30);var S$B=S$c._tempV31.elements;S$B[0]=S$Am.dot(S$c._tempV30,S$c._rows1[0]),S$B[1]=S$Am.dot(S$c._tempV30,S$c._rows1[1]),S$B[2]=S$Am.dot(S$c._tempV30,S$c._rows1[2]);var S$k=S$c._tempV32.elements,S$j=S$c._tempV33.elements;for(S$m=0;S$m<3;S$m++)if(S$k[0]=S$c._tempM1.getElementByRowColumn(S$m,0),S$k[1]=S$c._tempM1.getElementByRowColumn(S$m,1),S$k[2]=S$c._tempM1.getElementByRowColumn(S$m,2),S$_[S$m]+S$Am.dot(S$c._tempV35,S$c._tempV32)<Math.abs(S$B[S$m]))return 0;for(S$s=0;S$s<3;S$s++)if(S$k[0]=S$c._tempM1.getElementByRowColumn(0,S$s),S$k[1]=S$c._tempM1.getElementByRowColumn(1,S$s),S$k[2]=S$c._tempM1.getElementByRowColumn(2,S$s),S$j[0]=S$c._tempM0.getElementByRowColumn(0,S$s),S$j[1]=S$c._tempM0.getElementByRowColumn(1,S$s),S$j[2]=S$c._tempM0.getElementByRowColumn(2,S$s),S$Am.dot(this.extents,S$c._tempV32)+S$e[S$s]<Math.abs(S$Am.dot(S$c._tempV31,S$c._tempV33)))return 0;for(S$m=0;S$m<3;S$m++)for(S$s=0;S$s<3;S$s++){var S$G=(S$m+1)%3,S$y=(S$m+2)%3,S$d=(S$s+1)%3,S$Q=(S$s+2)%3;if(S$_[S$G]*S$c._tempM1.getElementByRowColumn(S$y,S$s)+S$_[S$y]*S$c._tempM1.getElementByRowColumn(S$G,S$s)+(S$e[S$d]*S$c._tempM1.getElementByRowColumn(S$m,S$Q)+S$e[S$Q]*S$c._tempM1.getElementByRowColumn(S$m,S$d))<Math.abs(S$B[S$y]*S$c._tempM0.getElementByRowColumn(S$G,S$s)-S$B[S$G]*S$c._tempM0.getElementByRowColumn(S$y,S$s)))return 0}return 2},S$a.containsLine=function(S$a,S$m){S$c._corners[0]=S$a,S$c._corners[1]=S$m;var S$s=this.containsPoints(S$c._corners);if(0!=S$s)return S$s;var S$P=this.extents.elements,S$_=S$P[0],S$e=S$P[1],S$A=S$P[2];this.transformation.invert(S$c._tempM0),S$Am.transformCoordinate(S$a,S$c._tempM0,S$c._tempV30),S$Am.transformCoordinate(S$m,S$c._tempM0,S$c._tempV31),S$Am.add(S$c._tempV30,S$c._tempV31,S$c._tempV32),S$Am.scale(S$c._tempV32,.5,S$c._tempV32),S$Am.subtract(S$c._tempV30,S$c._tempV32,S$c._tempV33);var S$B=S$c._tempV33.elements,S$k=S$B[0],S$j=S$B[1],S$G=S$B[2],S$y=S$c._tempV34.elements,S$d=S$y[0]=Math.abs(S$B[0]),S$Q=S$y[1]=Math.abs(S$B[1]),S$q=S$y[2]=Math.abs(S$B[2]),S$h=S$c._tempV32.elements,S$u=S$h[0],S$O=S$h[1],S$p=S$h[2];return Math.abs(S$u)>S$_+S$d?0:Math.abs(S$O)>S$e+S$Q?0:Math.abs(S$p)>S$A+S$q?0:Math.abs(S$O*S$G-S$p*S$j)>S$e*S$q+S$A*S$Q?0:Math.abs(S$u*S$G-S$p*S$k)>S$_*S$q+S$A*S$d?0:Math.abs(S$u*S$j-S$O*S$k)>S$_*S$Q+S$e*S$d?0:2},S$a.containsBoundBox=function(S$a){var S$m=0,S$s=0,S$P=S$a.min,S$_=S$a.max;S$a.getCorners(S$c._corners);var S$e=this.containsPoints(S$c._corners);if(0!=S$e)return S$e;S$Am.subtract(S$_,S$P,S$c._tempV30),S$Am.scale(S$c._tempV30,.5,S$c._tempV30),S$Am.add(S$P,S$c._tempV30,S$c._tempV30),S$Am.subtract(S$_,S$c._tempV30,S$c._tempV31);var S$A=this.extents.elements,S$B=S$c._tempV31.elements;S$c._getRows(this.transformation,S$c._rows1),this.transformation.invert(S$c._tempM0);for(S$m=0;S$m<3;S$m++)for(S$s=0;S$s<3;S$s++)S$c._tempM1.setElementByRowColumn(S$m,S$s,Math.abs(S$c._tempM0.getElementByRowColumn(S$m,S$s)));this.getCenter(S$c._tempV35),S$Am.subtract(S$c._tempV30,S$c._tempV35,S$c._tempV32);var S$k=S$c._tempV31.elements;S$k[0]=S$Am.dot(S$c._tempV32,S$c._rows1[0]),S$k[1]=S$Am.dot(S$c._tempV32,S$c._rows1[1]),S$k[2]=S$Am.dot(S$c._tempV32,S$c._rows1[2]);var S$j=S$c._tempV33.elements,S$G=S$c._tempV34.elements;for(S$m=0;S$m<3;S$m++)if(S$j[0]=S$c._tempM1.getElementByRowColumn(S$m,0),S$j[1]=S$c._tempM1.getElementByRowColumn(S$m,1),S$j[2]=S$c._tempM1.getElementByRowColumn(S$m,2),S$A[S$m]+S$Am.dot(S$c._tempV31,S$c._tempV33)<Math.abs(S$k[S$m]))return 0;for(S$s=0;S$s<3;S$s++)if(S$j[0]=S$c._tempM1.getElementByRowColumn(0,S$s),S$j[1]=S$c._tempM1.getElementByRowColumn(1,S$s),S$j[2]=S$c._tempM1.getElementByRowColumn(2,S$s),S$G[0]=S$c._tempM0.getElementByRowColumn(0,S$s),S$G[1]=S$c._tempM0.getElementByRowColumn(1,S$s),S$G[2]=S$c._tempM0.getElementByRowColumn(2,S$s),S$Am.dot(this.extents,S$c._tempV33)+S$B[S$s]<Math.abs(S$Am.dot(S$c._tempV31,S$c._tempV34)))return 0;for(S$m=0;S$m<3;S$m++)for(S$s=0;S$s<3;S$s++){var S$y=(S$m+1)%3,S$d=(S$m+2)%3,S$Q=(S$s+1)%3,S$q=(S$s+2)%3;if(S$A[S$y]*S$c._tempM1.getElementByRowColumn(S$d,S$s)+S$A[S$d]*S$c._tempM1.getElementByRowColumn(S$y,S$s)+(S$B[S$Q]*S$c._tempM1.getElementByRowColumn(S$m,S$q)+S$B[S$q]*S$c._tempM1.getElementByRowColumn(S$m,S$Q))<Math.abs(S$k[S$d]*S$c._tempM0.getElementByRowColumn(S$y,S$s)-S$k[S$y]*S$c._tempM0.getElementByRowColumn(S$d,S$s)))return 0}return 2},S$a.intersectsRay=function(S$a,S$m){S$Am.scale(this.extents,-1,S$c._tempV30),this.transformation.invert(S$c._tempM0),S$Am.TransformNormal(S$a.direction,S$c._tempM0,S$c._ray.direction),S$Am.transformCoordinate(S$a.origin,S$c._tempM0,S$c._ray.origin),S$c._boxBound1.min=S$c._tempV30,S$c._boxBound1.max=this.extents;var S$s=Collision.intersectsRayAndBoxRP(S$c._ray,S$c._boxBound1,S$m);return-1!==S$s&&S$Am.transformCoordinate(S$m,this.transformation,S$m),S$s},S$a._getLocalCorners=function(S$a){S$a.length=8;var S$m=this.extents.elements;S$c._tempV30.x=S$m[0],S$c._tempV31.y=S$m[1],S$c._tempV32.z=S$m[2],S$Am.add(S$c._tempV30,S$c._tempV31,S$c._tempV33),S$Am.add(S$c._tempV33,S$c._tempV32,S$a[0]),S$Am.add(S$c._tempV30,S$c._tempV31,S$c._tempV33),S$Am.subtract(S$c._tempV33,S$c._tempV32,S$a[1]),S$Am.subtract(S$c._tempV31,S$c._tempV30,S$c._tempV33),S$Am.subtract(S$c._tempV33,S$c._tempV30,S$a[2]),S$Am.subtract(S$c._tempV31,S$c._tempV30,S$c._tempV33),S$Am.add(S$c._tempV33,S$c._tempV32,S$a[3]),S$Am.subtract(S$c._tempV30,S$c._tempV31,S$c._tempV33),S$Am.add(S$c._tempV33,S$c._tempV32,S$a[4]),S$Am.subtract(S$c._tempV30,S$c._tempV31,S$c._tempV33),S$Am.subtract(S$c._tempV33,S$c._tempV32,S$a[5]),S$Am.scale(S$a[0],-1,S$a[6]),S$Am.subtract(S$c._tempV32,S$c._tempV30,S$c._tempV33),S$Am.subtract(S$c._tempV33,S$c._tempV31,S$a[7])},S$a.equals=function(S$a){return this.extents==S$a.extents&&this.transformation==S$a.transformation},S$a.cloneTo=function(S$a){var S$m=S$a;this.extents.cloneTo(S$m.extents),this.transformation.cloneTo(S$m.transformation)},S$c.createByBoundBox=function(S$a,S$m){var S$s=S$a.min,S$P=S$a.max;S$Am.subtract(S$P,S$s,S$c._tempV30),S$Am.scale(S$c._tempV30,.5,S$c._tempV30),S$Am.add(S$s,S$c._tempV30,S$c._tempV31),S$Am.subtract(S$P,S$c._tempV31,S$c._tempV32),S$am.translation(S$c._tempV31,S$c._tempM0);var S$_=S$c._tempV32.clone(),S$e=S$c._tempM0.clone();S$m.extents=S$_,S$m.transformation=S$e},S$c.createByMinAndMaxVertex=function(S$a,S$m){return S$Am.subtract(S$m,S$a,S$c._tempV30),S$Am.scale(S$c._tempV30,.5,S$c._tempV30),S$Am.add(S$a,S$c._tempV30,S$c._tempV31),S$Am.subtract(S$m,S$c._tempV31,S$c._tempV32),S$am.translation(S$c._tempV31,S$c._tempM0),new S$c(S$c._tempV32,S$c._tempM0)},S$c._getRows=function(S$a,S$m){S$m.length=3;var S$s=S$a.elements,S$P=S$m[0].elements;S$P[0]=S$s[0],S$P[1]=S$s[1],S$P[2]=S$s[2];var S$_=S$m[1].elements;S$_[0]=S$s[4],S$_[1]=S$s[5],S$_[2]=S$s[6];var S$e=S$m[2].elements;S$e[0]=S$s[8],S$e[1]=S$s[9],S$e[2]=S$s[10]},S$c.getObbtoObbMatrix4x4=function(S$a,S$m,S$s,S$P){var S$_=S$a.transformation,S$e=S$m.transformation;if(S$s){S$c._getRows(S$_,S$c._rows1),S$c._getRows(S$e,S$c._rows2);for(var S$A=0;S$A<3;S$A++)for(var S$B=0;S$B<3;S$B++)S$P.setElementByRowColumn(S$A,S$B,S$Am.dot(S$c._rows2[S$A],S$c._rows1[S$B]));S$m.getCenter(S$c._tempV30),S$a.getCenter(S$c._tempV31),S$Am.subtract(S$c._tempV30,S$c._tempV31,S$c._tempV32);var S$k=S$P.elements;S$k[12]=S$Am.dot(S$c._tempV32,S$c._rows1[0]),S$k[13]=S$Am.dot(S$c._tempV32,S$c._rows1[1]),S$k[14]=S$Am.dot(S$c._tempV32,S$c._rows1[2]),S$k[15]=1}else S$_.invert(S$c._tempM0),S$am.multiply(S$e,S$c._tempM0,S$P)},S$c.merge=function(S$a,S$m,S$s){var S$P=S$a.extents,S$_=S$a.transformation;S$c.getObbtoObbMatrix4x4(S$a,S$m,S$s,S$c._tempM0),S$m._getLocalCorners(S$c._corners),S$Am.transformCoordinate(S$c._corners[0],S$c._tempM0,S$c._corners[0]),S$Am.transformCoordinate(S$c._corners[1],S$c._tempM0,S$c._corners[1]),S$Am.transformCoordinate(S$c._corners[2],S$c._tempM0,S$c._corners[2]),S$Am.transformCoordinate(S$c._corners[3],S$c._tempM0,S$c._corners[3]),S$Am.transformCoordinate(S$c._corners[4],S$c._tempM0,S$c._corners[4]),S$Am.transformCoordinate(S$c._corners[5],S$c._tempM0,S$c._corners[5]),S$Am.transformCoordinate(S$c._corners[6],S$c._tempM0,S$c._corners[6]),S$Am.transformCoordinate(S$c._corners[7],S$c._tempM0,S$c._corners[7]),S$Am.scale(S$P,-1,S$c._boxBound1.min),S$P.cloneTo(S$c._boxBound1.max),S$Ta.createfromPoints(S$c._corners,S$c._boxBound2),S$Ta.merge(S$c._boxBound2,S$c._boxBound1,S$c._boxBound3);var S$e=S$c._boxBound3.min,S$A=S$c._boxBound3.max;S$Am.subtract(S$A,S$e,S$c._tempV30),S$Am.scale(S$c._tempV30,.5,S$c._tempV30),S$Am.add(S$e,S$c._tempV30,S$c._tempV32),S$Am.subtract(S$A,S$c._tempV32,S$P),S$Am.transformCoordinate(S$c._tempV32,S$_,S$c._tempV33)},S$y(S$c,["_tempV30",function(){return this._tempV30=new S$Am},"_tempV31",function(){return this._tempV31=new S$Am},"_tempV32",function(){return this._tempV32=new S$Am},"_tempV33",function(){return this._tempV33=new S$Am},"_tempV34",function(){return this._tempV34=new S$Am},"_tempV35",function(){return this._tempV35=new S$Am},"_tempV36",function(){return this._tempV36=new S$Am},"_tempM0",function(){return this._tempM0=new S$am},"_tempM1",function(){return this._tempM1=new S$am},"_corners",function(){return this._corners=[new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am]},"_rows1",function(){return this._rows1=[new S$Am,new S$Am,new S$Am]},"_rows2",function(){return this._rows2=[new S$Am,new S$Am,new S$Am]},"_ray",function(){return this._ray=new S$_m(new S$Am,new S$Am)},"_boxBound1",function(){return this._boxBound1=new S$Ta(new S$Am,new S$Am)},"_boxBound2",function(){return this._boxBound2=new S$Ta(new S$Am,new S$Am)},"_boxBound3",function(){return this._boxBound3=new S$Ta(new S$Am,new S$Am)}])}(),function(){function S$o(S$a,S$m){this.normal=null,this.distance=NaN,void 0===S$m&&(S$m=0),this.normal=S$a,this.distance=S$m}return S$Q(S$o,"laya.d3.math.Plane"),S$o.prototype.normalize=function(){var S$a=this.normal.elements,S$m=S$a[0],S$s=S$a[1],S$P=S$a[2],S$_=1/Math.sqrt(S$m*S$m+S$s*S$s+S$P*S$P);S$a[0]=S$m*S$_,S$a[1]=S$s*S$_,S$a[2]=S$P*S$_,this.distance*=S$_},S$o.createPlaneBy3P=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$m.elements,S$e=S$s.elements,S$A=S$_[0]-S$P[0],S$B=S$_[1]-S$P[1],S$k=S$_[2]-S$P[2],S$j=S$e[0]-S$P[0],S$G=S$e[1]-S$P[1],S$y=S$e[2]-S$P[2],S$d=S$B*S$y-S$k*S$G,S$Q=S$k*S$j-S$A*S$y,S$q=S$A*S$G-S$B*S$j,S$h=1/Math.sqrt(S$d*S$d+S$Q*S$Q+S$q*S$q),S$u=S$d*S$h,S$O=S$Q*S$h,S$p=S$q*S$h,S$c=S$o._TEMPVec3.elements;S$c[0]=S$u,S$c[1]=S$O,S$c[2]=S$p;var S$H=-(S$u*S$P[0]+S$O*S$P[1]+S$p*S$P[2]);return new S$o(S$o._TEMPVec3,S$H)},S$o.PlaneIntersectionType_Back=0,S$o.PlaneIntersectionType_Front=1,S$o.PlaneIntersectionType_Intersecting=2,S$y(S$o,["_TEMPVec3",function(){return this._TEMPVec3=new S$Am}]),S$o}()),S$sm=function(){function S$_(S$a,S$m,S$s,S$P){this.elements=new Float32Array(4),void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=1),this.elements[0]=S$a,this.elements[1]=S$m,this.elements[2]=S$s,this.elements[3]=S$P}S$Q(S$_,"laya.d3.math.Quaternion");var S$a=S$_.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.scaling=function(S$a,S$m){var S$s=S$m.elements,S$P=this.elements;S$s[0]=S$P[0]*S$a,S$s[1]=S$P[1]*S$a,S$s[2]=S$P[2]*S$a,S$s[3]=S$P[3]*S$a},S$a.normalize=function(S$a){var S$m=S$a.elements,S$s=this.elements,S$P=S$s[0],S$_=S$s[1],S$e=S$s[2],S$A=S$s[3],S$B=S$P*S$P+S$_*S$_+S$e*S$e+S$A*S$A;0<S$B&&(S$B=1/Math.sqrt(S$B),S$m[0]=S$P*S$B,S$m[1]=S$_*S$B,S$m[2]=S$e*S$B,S$m[3]=S$A*S$B)},S$a.length=function(){var S$a=this.elements,S$m=S$a[0],S$s=S$a[1],S$P=S$a[2],S$_=S$a[3];return Math.sqrt(S$m*S$m+S$s*S$s+S$P*S$P+S$_*S$_)},S$a.rotateX=function(S$a,S$m){var S$s=S$m.elements,S$P=this.elements;S$a*=.5;var S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$P[3],S$k=Math.sin(S$a),S$j=Math.cos(S$a);S$s[0]=S$_*S$j+S$B*S$k,S$s[1]=S$e*S$j+S$A*S$k,S$s[2]=S$A*S$j-S$e*S$k,S$s[3]=S$B*S$j-S$_*S$k},S$a.rotateY=function(S$a,S$m){var S$s=S$m.elements,S$P=this.elements;S$a*=.5;var S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$P[3],S$k=Math.sin(S$a),S$j=Math.cos(S$a);S$s[0]=S$_*S$j-S$A*S$k,S$s[1]=S$e*S$j+S$B*S$k,S$s[2]=S$A*S$j+S$_*S$k,S$s[3]=S$B*S$j-S$e*S$k},S$a.rotateZ=function(S$a,S$m){var S$s=S$m.elements,S$P=this.elements;S$a*=.5;var S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$P[3],S$k=Math.sin(S$a),S$j=Math.cos(S$a);S$s[0]=S$_*S$j+S$e*S$k,S$s[1]=S$e*S$j-S$_*S$k,S$s[2]=S$A*S$j+S$B*S$k,S$s[3]=S$B*S$j-S$A*S$k},S$a.getYawPitchRoll=function(S$a){S$Am.transformQuat(S$Am.ForwardRH,this,S$_.TEMPVector31),S$Am.transformQuat(S$Am.Up,this,S$_.TEMPVector32);var S$m=S$_.TEMPVector32.elements;S$_.angleTo(S$Am.ZERO,S$_.TEMPVector31,S$_.TEMPVector33);var S$s=S$_.TEMPVector33.elements;S$s[0]==Math.PI/2?(S$s[1]=S$_.arcTanAngle(S$m[2],S$m[0]),S$s[2]=0):S$s[0]==-Math.PI/2?(S$s[1]=S$_.arcTanAngle(-S$m[2],-S$m[0]),S$s[2]=0):(S$am.createRotationY(-S$s[1],S$_.TEMPMatrix0),S$am.createRotationX(-S$s[0],S$_.TEMPMatrix1),S$Am.transformCoordinate(S$_.TEMPVector32,S$_.TEMPMatrix0,S$_.TEMPVector32),S$Am.transformCoordinate(S$_.TEMPVector32,S$_.TEMPMatrix1,S$_.TEMPVector32),S$s[2]=S$_.arcTanAngle(S$m[1],-S$m[0])),S$s[1]<=-Math.PI&&(S$s[1]=Math.PI),S$s[2]<=-Math.PI&&(S$s[2]=Math.PI),S$s[1]>=Math.PI&&S$s[2]>=Math.PI&&(S$s[1]=0,S$s[2]=0,S$s[0]=Math.PI-S$s[0]);var S$P=S$a.elements;S$P[0]=S$s[1],S$P[1]=S$s[0],S$P[2]=S$s[2]},S$a.invert=function(S$a){var S$m=S$a.elements,S$s=this.elements,S$P=S$s[0],S$_=S$s[1],S$e=S$s[2],S$A=S$s[3],S$B=S$P*S$P+S$_*S$_+S$e*S$e+S$A*S$A,S$k=S$B?1/S$B:0;S$m[0]=-S$P*S$k,S$m[1]=-S$_*S$k,S$m[2]=-S$e*S$k,S$m[3]=S$A*S$k},S$a.identity=function(){var S$a=this.elements;S$a[0]=0,S$a[1]=0,S$a[2]=0,S$a[3]=1},S$a.fromArray=function(S$a,S$m){void 0===S$m&&(S$m=0),this.elements[0]=S$a[S$m+0],this.elements[1]=S$a[S$m+1],this.elements[2]=S$a[S$m+2],this.elements[3]=S$a[S$m+3]},S$a.cloneTo=function(S$a){var S$m,S$s,S$P;if((S$s=this.elements)!==(S$P=S$a.elements))for(S$m=0;S$m<4;++S$m)S$P[S$m]=S$s[S$m]},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$a.equals=function(S$a){var S$m=this.elements,S$s=S$a.elements;return S$na.nearEqual(S$m[0],S$s[0])&&S$na.nearEqual(S$m[1],S$s[1])&&S$na.nearEqual(S$m[2],S$s[2])&&S$na.nearEqual(S$m[3],S$s[3])},S$a.lengthSquared=function(){var S$a=this.elements[0],S$m=this.elements[1],S$s=this.elements[2],S$P=this.elements[3];return S$a*S$a+S$m*S$m+S$s*S$s+S$P*S$P},S$q(0,S$a,"x",function(){return this.elements[0]}),S$q(0,S$a,"y",function(){return this.elements[1]}),S$q(0,S$a,"z",function(){return this.elements[2]}),S$q(0,S$a,"w",function(){return this.elements[3]}),S$_.createFromYawPitchRoll=function(S$a,S$m,S$s,S$P){var S$_=.5*S$s,S$e=.5*S$m,S$A=.5*S$a,S$B=Math.sin(S$_),S$k=Math.cos(S$_),S$j=Math.sin(S$e),S$G=Math.cos(S$e),S$y=Math.sin(S$A),S$d=Math.cos(S$A),S$Q=S$P.elements;S$Q[0]=S$d*S$j*S$k+S$y*S$G*S$B,S$Q[1]=S$y*S$G*S$k-S$d*S$j*S$B,S$Q[2]=S$d*S$G*S$B-S$y*S$j*S$k,S$Q[3]=S$d*S$G*S$k+S$y*S$j*S$B},S$_.multiply=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$m.elements,S$e=S$s.elements,S$A=S$P[0],S$B=S$P[1],S$k=S$P[2],S$j=S$P[3],S$G=S$_[0],S$y=S$_[1],S$d=S$_[2],S$Q=S$_[3],S$q=S$B*S$d-S$k*S$y,S$h=S$k*S$G-S$A*S$d,S$u=S$A*S$y-S$B*S$G,S$O=S$A*S$G+S$B*S$y+S$k*S$d;S$e[0]=S$A*S$Q+S$G*S$j+S$q,S$e[1]=S$B*S$Q+S$y*S$j+S$h,S$e[2]=S$k*S$Q+S$d*S$j+S$u,S$e[3]=S$j*S$Q-S$O},S$_.arcTanAngle=function(S$a,S$m){return 0==S$a?1==S$m?Math.PI/2:-Math.PI/2:0<S$a?Math.atan(S$m/S$a):S$a<0?0<S$m?Math.atan(S$m/S$a)+Math.PI:Math.atan(S$m/S$a)-Math.PI:0},S$_.angleTo=function(S$a,S$m,S$s){S$Am.subtract(S$m,S$a,S$_.TEMPVector30),S$Am.normalize(S$_.TEMPVector30,S$_.TEMPVector30),S$s.elements[0]=Math.asin(S$_.TEMPVector30.y),S$s.elements[1]=S$_.arcTanAngle(-S$_.TEMPVector30.z,-S$_.TEMPVector30.x)},S$_.createFromAxisAngle=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements;S$m*=.5;var S$e=Math.sin(S$m);S$P[0]=S$e*S$_[0],S$P[1]=S$e*S$_[1],S$P[2]=S$e*S$_[2],S$P[3]=Math.cos(S$m)},S$_.createFromMatrix3x3=function(S$a,S$m){var S$s,S$P=S$m.elements,S$_=S$a.elements,S$e=S$_[0]+S$_[4]+S$_[8];if(0<S$e)S$s=Math.sqrt(S$e+1),S$P[3]=.5*S$s,S$s=.5/S$s,S$P[0]=(S$_[5]-S$_[7])*S$s,S$P[1]=(S$_[6]-S$_[2])*S$s,S$P[2]=(S$_[1]-S$_[3])*S$s;else{var S$A=0;S$_[4]>S$_[0]&&(S$A=1),S$_[8]>S$_[3*S$A+S$A]&&(S$A=2);var S$B=(S$A+1)%3,S$k=(S$A+2)%3;S$s=Math.sqrt(S$_[3*S$A+S$A]-S$_[3*S$B+S$B]-S$_[3*S$k+S$k]+1),S$P[S$A]=.5*S$s,S$s=.5/S$s,S$P[3]=(S$_[3*S$B+S$k]-S$_[3*S$k+S$B])*S$s,S$P[S$B]=(S$_[3*S$B+S$A]+S$_[3*S$A+S$B])*S$s,S$P[S$k]=(S$_[3*S$k+S$A]+S$_[3*S$A+S$k])*S$s}},S$_.createFromMatrix4x4=function(S$a,S$m){var S$s,S$P,S$_=S$a.elements,S$e=S$m.elements,S$A=S$_[0]+S$_[5]+S$_[10];0<S$A?(S$s=Math.sqrt(S$A+1),S$e[3]=.5*S$s,S$s=.5/S$s,S$e[0]=(S$_[6]-S$_[9])*S$s,S$e[1]=(S$_[8]-S$_[2])*S$s,S$e[2]=(S$_[1]-S$_[4])*S$s):S$_[0]>=S$_[5]&&S$_[0]>=S$_[10]?(S$P=.5/(S$s=Math.sqrt(1+S$_[0]-S$_[5]-S$_[10])),S$e[0]=.5*S$s,S$e[1]=(S$_[1]+S$_[4])*S$P,S$e[2]=(S$_[2]+S$_[8])*S$P,S$e[3]=(S$_[6]-S$_[9])*S$P):S$_[5]>S$_[10]?(S$P=.5/(S$s=Math.sqrt(1+S$_[5]-S$_[0]-S$_[10])),S$e[0]=(S$_[4]+S$_[1])*S$P,S$e[1]=.5*S$s,S$e[2]=(S$_[9]+S$_[6])*S$P,S$e[3]=(S$_[8]-S$_[2])*S$P):(S$P=.5/(S$s=Math.sqrt(1+S$_[10]-S$_[0]-S$_[5])),S$e[0]=(S$_[8]+S$_[2])*S$P,S$e[1]=(S$_[9]+S$_[6])*S$P,S$e[2]=.5*S$s,S$e[3]=(S$_[1]-S$_[4])*S$P)},S$_.slerp=function(S$a,S$m,S$s,S$P){var S$_,S$e,S$A,S$B,S$k,S$j=S$a.elements,S$G=S$m.elements,S$y=S$P.elements,S$d=S$j[0],S$Q=S$j[1],S$q=S$j[2],S$h=S$j[3],S$u=S$G[0],S$O=S$G[1],S$p=S$G[2],S$c=S$G[3];return(S$e=S$d*S$u+S$Q*S$O+S$q*S$p+S$h*S$c)<0&&(S$e=-S$e,S$u=-S$u,S$O=-S$O,S$p=-S$p,S$c=-S$c),S$k=1e-6<1-S$e?(S$_=Math.acos(S$e),S$A=Math.sin(S$_),S$B=Math.sin((1-S$s)*S$_)/S$A,Math.sin(S$s*S$_)/S$A):(S$B=1-S$s,S$s),S$y[0]=S$B*S$d+S$k*S$u,S$y[1]=S$B*S$Q+S$k*S$O,S$y[2]=S$B*S$q+S$k*S$p,S$y[3]=S$B*S$h+S$k*S$c,S$y},S$_.lerp=function(S$a,S$m,S$s,S$P){var S$_=S$P.elements,S$e=S$a.elements,S$A=S$m.elements,S$B=S$e[0],S$k=S$e[1],S$j=S$e[2],S$G=S$e[3];S$_[0]=S$B+S$s*(S$A[0]-S$B),S$_[1]=S$k+S$s*(S$A[1]-S$k),S$_[2]=S$j+S$s*(S$A[2]-S$j),S$_[3]=S$G+S$s*(S$A[3]-S$G)},S$_.add=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=S$_[0]+S$e[0],S$P[1]=S$_[1]+S$e[1],S$P[2]=S$_[2]+S$e[2],S$P[3]=S$_[3]+S$e[3]},S$_.dot=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;return S$s[0]*S$P[0]+S$s[1]*S$P[1]+S$s[2]*S$P[2]+S$s[3]*S$P[3]},S$_.rotationLookAt=function(S$a,S$m,S$s){S$_.lookAt(S$Am.ZERO,S$a,S$m,S$s)},S$_.lookAt=function(S$a,S$m,S$s,S$P){S$ra.lookAt(S$a,S$m,S$s,S$_._tempMatrix3x3),S$_.rotationMatrix(S$_._tempMatrix3x3,S$P)},S$_.invert=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$a.lengthSquared();S$na.isZero(S$_)||(S$_=1/S$_,S$P[0]=-S$s[0]*S$_,S$P[1]=-S$s[1]*S$_,S$P[2]=-S$s[2]*S$_,S$P[3]=S$s[3]*S$_)},S$_.rotationMatrix=function(S$a,S$m){var S$s=S$a.elements,S$P=S$s[0],S$_=S$s[1],S$e=S$s[2],S$A=S$s[3],S$B=S$s[4],S$k=S$s[5],S$j=S$s[6],S$G=S$s[7],S$y=S$s[8],S$d=S$m.elements,S$Q=NaN,S$q=NaN,S$h=S$P+S$B+S$y;0<S$h?(S$Q=Math.sqrt(S$h+1),S$d[3]=.5*S$Q,S$Q=.5/S$Q,S$d[0]=(S$k-S$G)*S$Q,S$d[1]=(S$j-S$e)*S$Q,S$d[2]=(S$_-S$A)*S$Q):S$B<=S$P&&S$y<=S$P?(S$q=.5/(S$Q=Math.sqrt(1+S$P-S$B-S$y)),S$d[0]=.5*S$Q,S$d[1]=(S$_+S$A)*S$q,S$d[2]=(S$e+S$j)*S$q,S$d[3]=(S$k-S$G)*S$q):S$y<S$B?(S$q=.5/(S$Q=Math.sqrt(1+S$B-S$P-S$y)),S$d[0]=(S$A+S$_)*S$q,S$d[1]=.5*S$Q,S$d[2]=(S$G+S$k)*S$q,S$d[3]=(S$j-S$e)*S$q):(S$q=.5/(S$Q=Math.sqrt(1+S$y-S$P-S$B)),S$d[0]=(S$j+S$e)*S$q,S$d[1]=(S$G+S$k)*S$q,S$d[2]=.5*S$Q,S$d[3]=(S$_-S$A)*S$q)},S$_.DEFAULT=new S$_,S$y(S$_,["TEMPVector30",function(){return this.TEMPVector30=new S$Am},"TEMPVector31",function(){return this.TEMPVector31=new S$Am},"TEMPVector32",function(){return this.TEMPVector32=new S$Am},"TEMPVector33",function(){return this.TEMPVector33=new S$Am},"TEMPMatrix0",function(){return this.TEMPMatrix0=new S$am},"TEMPMatrix1",function(){return this.TEMPMatrix1=new S$am},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new S$ra},"NAN",function(){return this.NAN=new S$_(NaN,NaN,NaN,NaN)}]),S$_}(),S$Pm=function(){function S$a(S$a){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=S$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}S$Q(S$a,"laya.d3.math.Rand");var S$m=S$a.prototype;return S$m.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},S$m.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},S$m.getSignedFloat=function(){return 2*this.getFloat()-1},S$q(0,S$m,"seed",function(){return this.seeds[0]},function(S$a){this.seeds[0]=S$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),S$a.getFloatFromInt=function(S$a){return 1/8388607*(8388607&S$a)},S$a.getByteFromInt=function(S$a){return(8388607&S$a)>>>15},S$a}(),S$_m=(function(){function S$_(S$a){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(S$a instanceof Array)||4!==S$a.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|S$a[0],this._state0L=0|S$a[1],this._state1U=0|S$a[2],this._state1L=0|S$a[3]}S$Q(S$_,"laya.d3.math.RandX");var S$a=S$_.prototype;S$a.randomint=function(){var S$a=this._state0U,S$m=this._state0L,S$s=this._state1U,S$P=this._state1L,S$_=(S$P>>>0)+(S$m>>>0),S$e=S$s+S$a+(S$_/2>>>31)>>>0,S$A=S$_>>>0,S$B=0,S$k=0;S$B=(S$a^=S$B=S$a<<23|(-512&S$m)>>>9)^(this._state0U=S$s),S$k=(S$m^=S$k=S$m<<23)^(this._state0L=S$P);S$B^=S$a>>>18,S$k^=S$m>>>18|(262143&S$a)<<14;return S$B^=S$s>>>5,S$k^=S$P>>>5|(31&S$s)<<27,this._state1U=S$B,this._state1L=S$k,[S$e,S$A]},S$a.random=function(){var S$a=this.randomint(),S$m=S$a[0],S$s=1023<<20|S$m>>>12,S$P=0|(S$a[1]>>>12|(4095&S$m)<<20);return S$_._CONVERTION_BUFFER.setUint32(0,S$s,!1),S$_._CONVERTION_BUFFER.setUint32(4,S$P,!1),S$Pm._CONVERTION_BUFFER.getFloat64(0,!1)-1},S$y(S$_,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new S$Pm([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function S$a(S$a,S$m){this.origin=null,this.direction=null,this.origin=S$a,this.direction=S$m}return S$Q(S$a,"laya.d3.math.Ray"),S$a}()),S$em=function(){function S$a(S$a,S$m){this.elements=new Float32Array(2),void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0);var S$s=this.elements;S$s[0]=S$a,S$s[1]=S$m}S$Q(S$a,"laya.d3.math.Vector2");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.fromArray=function(S$a,S$m){void 0===S$m&&(S$m=0),this.elements[0]=S$a[S$m+0],this.elements[1]=S$a[S$m+1]},S$m.cloneTo=function(S$a){var S$m=S$a.elements,S$s=this.elements;S$m[0]=S$s[0],S$m[1]=S$s[1]},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"x",function(){return this.elements[0]},function(S$a){this.elements[0]=S$a}),S$q(0,S$m,"y",function(){return this.elements[1]},function(S$a){this.elements[1]=S$a}),S$a.scale=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements;S$P[0]=S$_[0]*S$m,S$P[1]=S$_[1]*S$m},S$y(S$a,["ZERO",function(){return this.ZERO=new S$a(0,0)},"ONE",function(){return this.ONE=new S$a(1,1)}]),S$a}(),S$Am=function(){function S$G(S$a,S$m,S$s){this.elements=new Float32Array(3),void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0);var S$P=this.elements;S$P[0]=S$a,S$P[1]=S$m,S$P[2]=S$s}S$Q(S$G,"laya.d3.math.Vector3");var S$a=S$G.prototype;return S$o.imps(S$a,{"laya.d3.core.IClone":!0}),S$a.fromArray=function(S$a,S$m){void 0===S$m&&(S$m=0),this.elements[0]=S$a[S$m+0],this.elements[1]=S$a[S$m+1],this.elements[2]=S$a[S$m+2]},S$a.cloneTo=function(S$a){var S$m=S$a.elements,S$s=this.elements;S$m[0]=S$s[0],S$m[1]=S$s[1],S$m[2]=S$s[2]},S$a.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$a.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},S$a.reset=function(S$a,S$m,S$s){this.elements[0]=S$a,this.elements[1]=S$m,this.elements[2]=S$s},S$q(0,S$a,"x",function(){return this.elements[0]},function(S$a){this.elements[0]=S$a}),S$q(0,S$a,"y",function(){return this.elements[1]},function(S$a){this.elements[1]=S$a}),S$q(0,S$a,"z",function(){return this.elements[2]},function(S$a){this.elements[2]=S$a}),S$G.distanceSquared=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$s[0]-S$P[0],S$e=S$s[1]-S$P[1],S$A=S$s[2]-S$P[2];return S$_*S$_+S$e*S$e+S$A*S$A},S$G.distance=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$s[0]-S$P[0],S$e=S$s[1]-S$P[1],S$A=S$s[2]-S$P[2];return Math.sqrt(S$_*S$_+S$e*S$e+S$A*S$A)},S$G.min=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=Math.min(S$_[0],S$e[0]),S$P[1]=Math.min(S$_[1],S$e[1]),S$P[2]=Math.min(S$_[2],S$e[2])},S$G.max=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=Math.max(S$_[0],S$e[0]),S$P[1]=Math.max(S$_[1],S$e[1]),S$P[2]=Math.max(S$_[2],S$e[2])},S$G.transformQuat=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements,S$A=S$_[0],S$B=S$_[1],S$k=S$_[2],S$j=S$e[0],S$G=S$e[1],S$y=S$e[2],S$d=S$e[3],S$Q=S$d*S$A+S$G*S$k-S$y*S$B,S$q=S$d*S$B+S$y*S$A-S$j*S$k,S$h=S$d*S$k+S$j*S$B-S$G*S$A,S$u=-S$j*S$A-S$G*S$B-S$y*S$k;S$P[0]=S$Q*S$d+S$u*-S$j+S$q*-S$y-S$h*-S$G,S$P[1]=S$q*S$d+S$u*-S$G+S$h*-S$j-S$Q*-S$y,S$P[2]=S$h*S$d+S$u*-S$y+S$Q*-S$G-S$q*-S$j},S$G.scalarLength=function(S$a){var S$m=S$a.elements,S$s=S$m[0],S$P=S$m[1],S$_=S$m[2];return Math.sqrt(S$s*S$s+S$P*S$P+S$_*S$_)},S$G.scalarLengthSquared=function(S$a){var S$m=S$a.elements,S$s=S$m[0],S$P=S$m[1],S$_=S$m[2];return S$s*S$s+S$P*S$P+S$_*S$_},S$G.normalize=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$s[0],S$e=S$s[1],S$A=S$s[2],S$B=S$_*S$_+S$e*S$e+S$A*S$A;0<S$B&&(S$B=1/Math.sqrt(S$B),S$P[0]=S$s[0]*S$B,S$P[1]=S$s[1]*S$B,S$P[2]=S$s[2]*S$B)},S$G.multiply=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=S$_[0]*S$e[0],S$P[1]=S$_[1]*S$e[1],S$P[2]=S$_[2]*S$e[2]},S$G.scale=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements;S$P[0]=S$_[0]*S$m,S$P[1]=S$_[1]*S$m,S$P[2]=S$_[2]*S$m},S$G.lerp=function(S$a,S$m,S$s,S$P){var S$_=S$P.elements,S$e=S$a.elements,S$A=S$m.elements,S$B=S$e[0],S$k=S$e[1],S$j=S$e[2];S$_[0]=S$B+S$s*(S$A[0]-S$B),S$_[1]=S$k+S$s*(S$A[1]-S$k),S$_[2]=S$j+S$s*(S$A[2]-S$j)},S$G.transformV3ToV3=function(S$a,S$m,S$s){var S$P=S$G._tempVector4;S$G.transformV3ToV4(S$a,S$m,S$P);var S$_=S$P.elements,S$e=S$s.elements;S$e[0]=S$_[0],S$e[1]=S$_[1],S$e[2]=S$_[2]},S$G.transformV3ToV4=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$m.elements,S$k=S$s.elements;S$k[0]=S$_*S$B[0]+S$e*S$B[4]+S$A*S$B[8]+S$B[12],S$k[1]=S$_*S$B[1]+S$e*S$B[5]+S$A*S$B[9]+S$B[13],S$k[2]=S$_*S$B[2]+S$e*S$B[6]+S$A*S$B[10]+S$B[14],S$k[3]=S$_*S$B[3]+S$e*S$B[7]+S$A*S$B[11]+S$B[15]},S$G.TransformNormal=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$m.elements,S$k=S$s.elements;S$k[0]=S$_*S$B[0]+S$e*S$B[4]+S$A*S$B[8],S$k[1]=S$_*S$B[1]+S$e*S$B[5]+S$A*S$B[9],S$k[2]=S$_*S$B[2]+S$e*S$B[6]+S$A*S$B[10]},S$G.transformCoordinate=function(S$a,S$m,S$s){var S$P=S$G._tempVector4.elements,S$_=S$a.elements,S$e=S$_[0],S$A=S$_[1],S$B=S$_[2],S$k=S$m.elements;S$P[0]=S$e*S$k[0]+S$A*S$k[4]+S$B*S$k[8]+S$k[12],S$P[1]=S$e*S$k[1]+S$A*S$k[5]+S$B*S$k[9]+S$k[13],S$P[2]=S$e*S$k[2]+S$A*S$k[6]+S$B*S$k[10]+S$k[14],S$P[3]=1/(S$e*S$k[3]+S$A*S$k[7]+S$B*S$k[11]+S$k[15]);var S$j=S$s.elements;S$j[0]=S$P[0]*S$P[3],S$j[1]=S$P[1]*S$P[3],S$j[2]=S$P[2]*S$P[3]},S$G.Clamp=function(S$a,S$m,S$s,S$P){var S$_=S$a.elements,S$e=S$_[0],S$A=S$_[1],S$B=S$_[2],S$k=S$m.elements,S$j=S$k[0],S$G=S$k[1],S$y=S$k[2],S$d=S$s.elements,S$Q=S$d[0],S$q=S$d[1],S$h=S$d[2],S$u=S$P.elements;S$e=(S$e=S$Q<S$e?S$Q:S$e)<S$j?S$j:S$e,S$A=(S$A=S$q<S$A?S$q:S$A)<S$G?S$G:S$A,S$B=(S$B=S$h<S$B?S$h:S$B)<S$y?S$y:S$B,S$u[0]=S$e,S$u[1]=S$A,S$u[2]=S$B},S$G.add=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=S$_[0]+S$e[0],S$P[1]=S$_[1]+S$e[1],S$P[2]=S$_[2]+S$e[2]},S$G.subtract=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=S$_[0]-S$e[0],S$P[1]=S$_[1]-S$e[1],S$P[2]=S$_[2]-S$e[2]},S$G.cross=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$m.elements,S$e=S$s.elements,S$A=S$P[0],S$B=S$P[1],S$k=S$P[2],S$j=S$_[0],S$G=S$_[1],S$y=S$_[2];S$e[0]=S$B*S$y-S$k*S$G,S$e[1]=S$k*S$j-S$A*S$y,S$e[2]=S$A*S$G-S$B*S$j},S$G.dot=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;return S$s[0]*S$P[0]+S$s[1]*S$P[1]+S$s[2]*S$P[2]},S$G.equals=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;return S$na.nearEqual(Math.abs(S$s[0]),Math.abs(S$P[0]))&&S$na.nearEqual(Math.abs(S$s[1]),Math.abs(S$P[1]))&&S$na.nearEqual(Math.abs(S$s[2]),Math.abs(S$P[2]))},S$G.ZERO=new S$G(0,0,0),S$G.ONE=new S$G(1,1,1),S$G.NegativeUnitX=new S$G(-1,0,0),S$G.UnitX=new S$G(1,0,0),S$G.UnitY=new S$G(0,1,0),S$G.UnitZ=new S$G(0,0,1),S$G.ForwardRH=new S$G(0,0,-1),S$G.ForwardLH=new S$G(0,0,1),S$G.Up=new S$G(0,1,0),S$G.NAN=new S$G(NaN,NaN,NaN),S$y(S$G,["_tempVector4",function(){return this._tempVector4=new S$Bm}]),S$G}(),S$Bm=function(){function S$a(S$a,S$m,S$s,S$P){this.elements=new Float32Array(4),void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=0);var S$_=this.elements;S$_[0]=S$a,S$_[1]=S$m,S$_[2]=S$s,S$_[3]=S$P}S$Q(S$a,"laya.d3.math.Vector4");var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m.fromArray=function(S$a,S$m){void 0===S$m&&(S$m=0),this.elements[0]=S$a[S$m+0],this.elements[1]=S$a[S$m+1],this.elements[2]=S$a[S$m+2],this.elements[3]=S$a[S$m+3]},S$m.cloneTo=function(S$a){var S$m=S$a.elements,S$s=this.elements;S$m[0]=S$s[0],S$m[1]=S$s[1],S$m[2]=S$s[2],S$m[3]=S$s[3]},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$m.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},S$m.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},S$q(0,S$m,"x",function(){return this.elements[0]},function(S$a){this.elements[0]=S$a}),S$q(0,S$m,"y",function(){return this.elements[1]},function(S$a){this.elements[1]=S$a}),S$q(0,S$m,"z",function(){return this.elements[2]},function(S$a){this.elements[2]=S$a}),S$q(0,S$m,"w",function(){return this.elements[3]},function(S$a){this.elements[3]=S$a}),S$a.lerp=function(S$a,S$m,S$s,S$P){var S$_=S$P.elements,S$e=S$a.elements,S$A=S$m.elements,S$B=S$e[0],S$k=S$e[1],S$j=S$e[2],S$G=S$e[3];S$_[0]=S$B+S$s*(S$A[0]-S$B),S$_[1]=S$k+S$s*(S$A[1]-S$k),S$_[2]=S$j+S$s*(S$A[2]-S$j),S$_[3]=S$G+S$s*(S$A[3]-S$G)},S$a.transformByM4x4=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$P[0],S$e=S$P[1],S$A=S$P[2],S$B=S$P[3],S$k=S$m.elements,S$j=S$s.elements;S$j[0]=S$_*S$k[0]+S$e*S$k[4]+S$A*S$k[8]+S$B*S$k[12],S$j[1]=S$_*S$k[1]+S$e*S$k[5]+S$A*S$k[9]+S$B*S$k[13],S$j[2]=S$_*S$k[2]+S$e*S$k[6]+S$A*S$k[10]+S$B*S$k[14],S$j[3]=S$_*S$k[3]+S$e*S$k[7]+S$A*S$k[11]+S$B*S$k[15]},S$a.equals=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;return S$na.nearEqual(Math.abs(S$s[0]),Math.abs(S$P[0]))&&S$na.nearEqual(Math.abs(S$s[1]),Math.abs(S$P[1]))&&S$na.nearEqual(Math.abs(S$s[2]),Math.abs(S$P[2]))&&S$na.nearEqual(Math.abs(S$s[3]),Math.abs(S$P[3]))},S$a.normalize=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$a.length();0<S$_&&(S$P[0]=S$s[0]*S$_,S$P[1]=S$s[1]*S$_,S$P[2]=S$s[2]*S$_,S$P[3]=S$s[3]*S$_)},S$a.add=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=S$_[0]+S$e[0],S$P[1]=S$_[1]+S$e[1],S$P[2]=S$_[2]+S$e[2],S$P[3]=S$_[3]+S$e[3]},S$a.subtract=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=S$_[0]-S$e[0],S$P[1]=S$_[1]-S$e[1],S$P[2]=S$_[2]-S$e[2],S$P[3]=S$_[3]-S$e[3]},S$a.multiply=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=S$_[0]*S$e[0],S$P[1]=S$_[1]*S$e[1],S$P[2]=S$_[2]*S$e[2],S$P[3]=S$_[3]*S$e[3]},S$a.scale=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements;S$P[0]=S$_[0]*S$m,S$P[1]=S$_[1]*S$m,S$P[2]=S$_[2]*S$m,S$P[3]=S$_[3]*S$m},S$a.Clamp=function(S$a,S$m,S$s,S$P){var S$_=S$a.elements,S$e=S$_[0],S$A=S$_[1],S$B=S$_[2],S$k=S$_[3],S$j=S$m.elements,S$G=S$j[0],S$y=S$j[1],S$d=S$j[2],S$Q=S$j[3],S$q=S$s.elements,S$h=S$q[0],S$u=S$q[1],S$O=S$q[2],S$p=S$q[3],S$c=S$P.elements;S$e=(S$e=S$h<S$e?S$h:S$e)<S$G?S$G:S$e,S$A=(S$A=S$u<S$A?S$u:S$A)<S$y?S$y:S$A,S$B=(S$B=S$O<S$B?S$O:S$B)<S$d?S$d:S$B,S$k=(S$k=S$p<S$k?S$p:S$k)<S$Q?S$Q:S$k,S$c[0]=S$e,S$c[1]=S$A,S$c[2]=S$B,S$c[3]=S$k},S$a.distanceSquared=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$s[0]-S$P[0],S$e=S$s[1]-S$P[1],S$A=S$s[2]-S$P[2],S$B=S$s[3]-S$P[3];return S$_*S$_+S$e*S$e+S$A*S$A+S$B*S$B},S$a.distance=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements,S$_=S$s[0]-S$P[0],S$e=S$s[1]-S$P[1],S$A=S$s[2]-S$P[2],S$B=S$s[3]-S$P[3];return Math.sqrt(S$_*S$_+S$e*S$e+S$A*S$A+S$B*S$B)},S$a.dot=function(S$a,S$m){var S$s=S$a.elements,S$P=S$m.elements;return S$s[0]*S$P[0]+S$s[1]*S$P[1]+S$s[2]*S$P[2]+S$s[3]*S$P[3]},S$a.min=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=Math.min(S$_[0],S$e[0]),S$P[1]=Math.min(S$_[1],S$e[1]),S$P[2]=Math.min(S$_[2],S$e[2]),S$P[3]=Math.min(S$_[3],S$e[3])},S$a.max=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m.elements;S$P[0]=Math.max(S$_[0],S$e[0]),S$P[1]=Math.max(S$_[1],S$e[1]),S$P[2]=Math.max(S$_[2],S$e[2]),S$P[3]=Math.max(S$_[3],S$e[3])},S$y(S$a,["ZERO",function(){return this.ZERO=new S$a},"ONE",function(){return this.ONE=new S$a(1,1,1,1)},"UnitX",function(){return this.UnitX=new S$a(1,0,0,0)},"UnitY",function(){return this.UnitY=new S$a(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new S$a(0,0,1,0)},"UnitW",function(){return this.UnitW=new S$a(0,0,0,1)}]),S$a}(),S$km=function(){function S$e(S$a,S$m,S$s,S$P){this.minDepth=0,this.maxDepth=1,this.x=S$a,this.y=S$m,this.width=S$s,this.height=S$P}S$Q(S$e,"laya.d3.math.Viewport");var S$a=S$e.prototype;return S$a.project=function(S$a,S$m,S$s){S$Am.transformV3ToV3(S$a,S$m,S$s);var S$P=S$a.elements,S$_=S$m.elements,S$e=S$s.elements,S$A=S$P[0]*S$_[3]+S$P[1]*S$_[7]+S$P[2]*S$_[11]+S$_[15];1!==S$A&&(S$e[0]=S$e[0]/S$A,S$e[1]=S$e[1]/S$A,S$e[2]=S$e[2]/S$A),S$e[0]=.5*(S$e[0]+1)*this.width+this.x,S$e[1]=.5*(1-S$e[1])*this.height+this.y,S$e[2]=S$e[2]*(this.maxDepth-this.minDepth)+this.minDepth},S$a.unprojectFromMat=function(S$a,S$m,S$s){var S$P=S$a.elements,S$_=S$m.elements,S$e=S$s.elements;S$e[0]=(S$P[0]-this.x)/this.width*2-1,S$e[1]=-((S$P[1]-this.y)/this.height*2-1);var S$A=(this.maxDepth-this.minDepth)/2;S$e[2]=(S$P[2]-this.minDepth-S$A)/S$A;var S$B=S$e[0]*S$_[3]+S$e[1]*S$_[7]+S$e[2]*S$_[11]+S$_[15];S$Am.transformV3ToV3(S$s,S$m,S$s),1!==S$B&&(S$e[0]=S$e[0]/S$B,S$e[1]=S$e[1]/S$B,S$e[2]=S$e[2]/S$B)},S$a.unprojectFromWVP=function(S$a,S$m,S$s,S$P,S$_){S$am.multiply(S$m,S$s,S$e._tempMatrix4x4),S$P&&S$am.multiply(S$e._tempMatrix4x4,S$P,S$e._tempMatrix4x4),S$e._tempMatrix4x4.invert(S$e._tempMatrix4x4),this.unprojectFromMat(S$a,S$e._tempMatrix4x4,S$_)},S$y(S$e,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new S$am}]),S$e}(),S$jm=function(){function S$K(S$a){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=S$a,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}S$Q(S$K,"laya.d3.resource.models.SubMesh");var S$a=S$K.prototype;return S$o.imps(S$a,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),S$a._getVertexBuffer=function(S$a){return void 0===S$a&&(S$a=0),0===S$a?this._vertexBuffer:null},S$a._getIndexBuffer=function(){return this._indexBuffer},S$a._getStaticBatchBakedVertexs=function(S$a,S$m){var S$s,S$P,S$_=this._vertexBuffer,S$e=S$_.vertexDeclaration,S$A=S$e.getVertexElementByUsage(0).offset/4,S$B=S$e.getVertexElementByUsage(3).offset/4,S$k=S$m.meshRender.lightmapScaleOffset,S$j=0,S$G=0,S$y=0,S$d=0,S$Q=0,S$q=0;if(S$k)if(S$P=S$e.getVertexElementByUsage(15))S$y=S$e.vertexStride/4,S$s=0<this._vertexCount?S$_.getData().slice(this._vertexStart*S$y,(this._vertexStart+this._vertexCount)*S$y):S$_.getData().slice(),S$d=S$P.offset/4;else{S$y=(S$q=S$e.vertexStride/4)+2,S$s=this._vertexCount?new Float32Array(this._vertexCount*(S$_.vertexDeclaration.vertexStride/4+2)):new Float32Array(S$_.vertexCount*(S$_.vertexDeclaration.vertexStride/4+2)),S$d=(S$Q=S$e.getVertexElementByUsage(2).offset/4)+2;var S$h=S$_.getData();for(S$j=0,S$G=S$h.length/S$q;S$j<S$G;S$j++){var S$u=0;S$u=0<this._vertexCount?(this._vertexStart+S$j)*S$q:S$j*S$q;var S$O=S$j*S$y,S$p=0;for(S$p=0;S$p<S$d;S$p++)S$s[S$O+S$p]=S$h[S$u+S$p];for(S$p=S$d;S$p<S$q;S$p++)S$s[S$O+S$p+2]=S$h[S$u+S$p]}}else S$y=S$e.vertexStride/4,S$s=this._vertexCount?S$_.getData().slice(this._vertexStart*S$y,(this._vertexStart+this._vertexCount)*S$y):S$_.getData().slice();if(S$a){var S$c=S$a.worldMatrix,S$H=S$K._tempMatrix4x40;S$c.invert(S$H);var S$o=S$K._tempMatrix4x41,S$N=S$m.transform.worldMatrix;S$am.multiply(S$H,S$N,S$o)}else S$o=S$m.transform.worldMatrix;var S$z=S$K._tempQuaternion0;for(S$o.decomposeTransRotScale(S$K._tempVector30,S$z,S$K._tempVector31),S$j=0,S$G=S$s.length/S$y;S$j<S$G;S$j++){var S$U=S$j*S$y+S$A,S$l=S$j*S$y+S$B;if(S$um.transformVector3ArrayToVector3ArrayCoordinate(S$s,S$U,S$o,S$s,S$U),S$um.transformVector3ArrayByQuat(S$s,S$l,S$z,S$s,S$l),S$k){var S$C=S$j*S$y+S$d;if(S$P)S$um.transformLightingMapTexcoordByUV1Array(S$s,S$C,S$k,S$s,S$C);else{var S$f=S$j*S$q+S$Q;S$um.transformLightingMapTexcoordByUV0Array(S$h,S$f,S$k,S$s,S$C)}}}return S$s},S$a._getVertexBuffers=function(){return null},S$a._beforeRender=function(S$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},S$a._render=function(S$a){var S$m,S$s=0,S$P=S$a.renderElement;if(1<this._indexCount){var S$_=this._boneIndicesList.length;if(1<S$_){for(var S$e=0;S$e<S$_;S$e++)(S$m=S$P._skinAnimationDatas||this._skinAnimationDatas)&&(S$P._shaderValue.setValue(0,S$m[S$e]),S$a._shader.uploadRenderElementUniforms(S$P._shaderValue.data)),S$V.mainContext.drawElements(4,this._subIndexBufferCount[S$e],5123,2*this._subIndexBufferStart[S$e]);S$U.drawCall+=S$_}else(S$m=S$P._skinAnimationDatas||this._skinAnimationDatas)&&(S$P._shaderValue.setValue(0,S$m[0]),S$a._shader.uploadRenderElementUniforms(S$P._shaderValue.data)),S$V.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),S$U.drawCall++;S$s=this._indexCount}else S$s=this._indexBuffer.indexCount,(S$m=S$P._skinAnimationDatas||this._skinAnimationDatas)&&(S$P._shaderValue.setValue(0,S$m[0]),S$a._shader.uploadRenderElementUniforms(S$P._shaderValue.data)),S$V.mainContext.drawElements(4,S$s,5123,0),S$U.drawCall++;S$U.trianglesFaces+=S$s/3},S$a.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},S$a.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},S$q(0,S$a,"_vertexBufferCount",function(){return 1}),S$q(0,S$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),S$y(S$K,["_tempVector30",function(){return this._tempVector30=new S$Am},"_tempVector31",function(){return this._tempVector31=new S$Am},"_tempQuaternion0",function(){return this._tempQuaternion0=new S$sm},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new S$am},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new S$am}]),S$K}(),S$Gm=function(){function S$a(S$a){this.defineCounter=0,this.defines=null,S$a?(this.defineCounter=S$a.defineCounter,this.defines=S$a.defines.slice()):(this.defineCounter=0,this.defines=[])}return S$Q(S$a,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),S$a.prototype.registerDefine=function(S$a){var S$m=Math.pow(2,this.defineCounter++);return this.defines[S$m]=S$a,S$m},S$a}(),S$ym=function(){function S$a(){}return S$Q(S$a,"laya.d3.shader.ShaderInit3D"),S$a.__init__=function(){var S$a,S$m;S$Um._globalRegDefine("HIGHPRECISION",S$Um.SHADERDEFINE_HIGHPRECISION),S$Um._globalRegDefine("FOG",S$Um.SHADERDEFINE_FOG),S$Um._globalRegDefine("DIRECTIONLIGHT",S$Um.SHADERDEFINE_DIRECTIONLIGHT),S$Um._globalRegDefine("POINTLIGHT",S$Um.SHADERDEFINE_POINTLIGHT),S$Um._globalRegDefine("SPOTLIGHT",S$Um.SHADERDEFINE_SPOTLIGHT),S$Um._globalRegDefine("UV",S$Um.SHADERDEFINE_UV0),S$Um._globalRegDefine("COLOR",S$Um.SHADERDEFINE_COLOR),S$Um._globalRegDefine("UV1",S$Um.SHADERDEFINE_UV1),S$Um._globalRegDefine("CASTSHADOW",S$Qm.SHADERDEFINE_CAST_SHADOW),S$Um._globalRegDefine("SHADOWMAP_PSSM1",S$Qm.SHADERDEFINE_SHADOW_PSSM1),S$Um._globalRegDefine("SHADOWMAP_PSSM2",S$Qm.SHADERDEFINE_SHADOW_PSSM2),S$Um._globalRegDefine("SHADOWMAP_PSSM3",S$Qm.SHADERDEFINE_SHADOW_PSSM3),S$Um._globalRegDefine("SHADOWMAP_PCF_NO",S$Qm.SHADERDEFINE_SHADOW_PCF_NO),S$Um._globalRegDefine("SHADOWMAP_PCF1",S$Qm.SHADERDEFINE_SHADOW_PCF1),S$Um._globalRegDefine("SHADOWMAP_PCF2",S$Qm.SHADERDEFINE_SHADOW_PCF2),S$Um._globalRegDefine("SHADOWMAP_PCF3",S$Qm.SHADERDEFINE_SHADOW_PCF3),S$Um._globalRegDefine("DEPTHFOG",S$Um.SAHDERDEFINE_DEPTHFOG),S$Em.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),S$Em.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),S$a={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},S$m={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var S$s=S$Em.nameKey.add("SIMPLE");shaderCompile=S$Um.add(S$s,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',S$a,S$m),S$im.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),S$im.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),S$im.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),S$im.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),S$im.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),S$im.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),S$im.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),S$im.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),S$im.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},S$a}(),S$dm=function(){function S$a(){this._data=null,this._data=[]}S$Q(S$a,"laya.d3.shader.ValusArray");var S$m=S$a.prototype;return S$m.setValue=function(S$a,S$m){this._data[S$a]=S$m},S$q(0,S$m,"data",function(){return this._data}),S$a}(),S$Qm=function(){function S$a(){}return S$a.SHADERDEFINE_RECEIVE_SHADOW=1,S$a.SHADERDEFINE_CAST_SHADOW=512,S$a.SHADERDEFINE_SHADOW_PSSM1=1024,S$a.SHADERDEFINE_SHADOW_PSSM2=2048,S$a.SHADERDEFINE_SHADOW_PSSM3=4096,S$a.SHADERDEFINE_SHADOW_PCF_NO=8192,S$a.SHADERDEFINE_SHADOW_PCF1=16384,S$a.SHADERDEFINE_SHADOW_PCF2=32768,S$a.SHADERDEFINE_SHADOW_PCF3=65536,S$a.MAX_PSSM_COUNT=3,S$a}(),S$qm=function(){function S$v(){}return S$Q(S$v,"laya.d3.utils.Picker"),S$v.calculateCursorRay=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$a.elements[0],S$B=S$a.elements[1],S$k=S$v._tempVector30,S$j=S$k.elements;S$j[0]=S$A,S$j[1]=S$B,S$j[2]=S$m.minDepth;var S$G=S$v._tempVector31,S$y=S$G.elements;S$y[0]=S$A,S$y[1]=S$B,S$y[2]=S$m.maxDepth;var S$d=S$e.origin,S$Q=S$v._tempVector32;S$m.unprojectFromWVP(S$k,S$s,S$P,S$_,S$d),S$m.unprojectFromWVP(S$G,S$s,S$P,S$_,S$Q);var S$q=S$e.direction.elements;S$q[0]=S$Q.x-S$d.x,S$q[1]=S$Q.y-S$d.y,S$q[2]=S$Q.z-S$d.z,S$Am.normalize(S$e.direction,S$e.direction)},S$v.rayIntersectsPositionsAndIndices=function(S$a,S$m,S$s,S$P,S$_){for(var S$e=S$s.vertexStride/4,S$A=S$s.getVertexElementByUsage(0).offset/4,S$B=Number.MAX_VALUE,S$k=-1,S$j=-1,S$G=-1,S$y=0;S$y<S$P.length;S$y+=3){var S$d=S$v._tempVector35,S$Q=S$d.elements,S$q=S$P[S$y]*S$e,S$h=S$q+S$A;S$Q[0]=S$m[S$h],S$Q[1]=S$m[1+S$h],S$Q[2]=S$m[2+S$h];var S$u=S$v._tempVector36,S$O=S$u.elements,S$p=S$P[S$y+1]*S$e,S$c=S$p+S$A;S$O[0]=S$m[S$c],S$O[1]=S$m[1+S$c],S$O[2]=S$m[2+S$c];var S$H=S$v._tempVector37,S$o=S$H.elements,S$N=S$P[S$y+2]*S$e,S$z=S$N+S$A;S$o[0]=S$m[S$z],S$o[1]=S$m[1+S$z],S$o[2]=S$m[2+S$z];var S$U=laya.d3.utils.Picker.rayIntersectsTriangle(S$a,S$d,S$u,S$H);!isNaN(S$U)&&S$U<S$B&&(S$B=S$U,S$k=S$q,S$j=S$p,S$G=S$N)}if(S$B===Number.MAX_VALUE)return S$_.position.toDefault(),S$_.distance=Number.MAX_VALUE,S$_.trianglePositions[0].toDefault(),S$_.trianglePositions[1].toDefault(),S$_.trianglePositions[2].toDefault(),S$_.triangleNormals[0].toDefault(),S$_.triangleNormals[1].toDefault(),S$_.triangleNormals[2].toDefault(),!1;S$_.distance=S$B,S$Am.scale(S$a.direction,S$B,S$_.position),S$Am.add(S$a.origin,S$_.position,S$_.position);var S$l=S$_.trianglePositions,S$C=S$l[0],S$f=S$l[1],S$K=S$l[2],S$V=S$C.elements,S$W=S$f.elements,S$b=S$K.elements,S$S=S$k+S$A;S$V[0]=S$m[S$S],S$V[1]=S$m[S$S+1],S$V[2]=S$m[S$S+2];var S$Z=S$j+S$A;S$W[0]=S$m[S$Z],S$W[1]=S$m[S$Z+1],S$W[2]=S$m[S$Z+2];var S$X=S$G+S$A;S$b[0]=S$m[S$X],S$b[1]=S$m[S$X+1],S$b[2]=S$m[S$X+2];var S$E=S$s.getVertexElementByUsage(3);if(S$E){var S$i=S$E.offset/4,S$t=S$_.triangleNormals,S$L=S$t[0],S$R=S$t[1],S$F=S$t[2],S$x=S$L.elements,S$M=S$R.elements,S$J=S$F.elements,S$D=S$k+S$i;S$x[0]=S$m[S$D],S$x[1]=S$m[S$D+1],S$x[2]=S$m[S$D+2];var S$g=S$j+S$i;S$M[0]=S$m[S$g],S$M[1]=S$m[S$g+1],S$M[2]=S$m[S$g+2];var S$w=S$G+S$i;S$J[0]=S$m[S$w],S$J[1]=S$m[S$w+1],S$J[2]=S$m[S$w+2]}return!0},S$v.rayIntersectsTriangle=function(S$a,S$m,S$s,S$P){var S$_=S$v._tempVector30,S$e=S$v._tempVector31;S$Am.subtract(S$s,S$m,S$_),S$Am.subtract(S$P,S$m,S$e);var S$A,S$B=S$v._tempVector32;if(S$Am.cross(S$a.direction,S$e,S$B),(S$A=S$Am.dot(S$_,S$B))>-Number.MIN_VALUE&&S$A<Number.MIN_VALUE)return Number.NaN;var S$k,S$j=1/S$A,S$G=S$v._tempVector33;if(S$Am.subtract(S$a.origin,S$m,S$G),S$k=S$Am.dot(S$G,S$B),(S$k*=S$j)<0||1<S$k)return Number.NaN;var S$y,S$d,S$Q=S$v._tempVector34;return S$Am.cross(S$G,S$_,S$Q),S$y=S$Am.dot(S$a.direction,S$Q),(S$y*=S$j)<0||1<S$k+S$y?Number.NaN:(S$d=S$Am.dot(S$e,S$Q),(S$d*=S$j)<0?Number.NaN:S$d)},S$y(S$v,["_tempVector30",function(){return this._tempVector30=new S$Am},"_tempVector31",function(){return this._tempVector31=new S$Am},"_tempVector32",function(){return this._tempVector32=new S$Am},"_tempVector33",function(){return this._tempVector33=new S$Am},"_tempVector34",function(){return this._tempVector34=new S$Am},"_tempVector35",function(){return this._tempVector35=new S$Am},"_tempVector36",function(){return this._tempVector36=new S$Am},"_tempVector37",function(){return this._tempVector37=new S$Am}]),S$v}(),S$hm=(function(){function S$a(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new S$Am,new S$Am,new S$Am],this.trianglePositions.length=3,this.triangleNormals=[new S$Am,new S$Am,new S$Am],this.triangleNormals.length=3,this.position=new S$Am}S$Q(S$a,"laya.d3.utils.RaycastHit"),S$a.prototype.cloneTo=function(S$a){S$a.distance=this.distance,this.trianglePositions[0].cloneTo(S$a.trianglePositions[0]),this.trianglePositions[1].cloneTo(S$a.trianglePositions[1]),this.trianglePositions[2].cloneTo(S$a.trianglePositions[2]),this.triangleNormals[0].cloneTo(S$a.triangleNormals[0]),this.triangleNormals[1].cloneTo(S$a.triangleNormals[1]),this.triangleNormals[2].cloneTo(S$a.triangleNormals[2]),this.position.cloneTo(S$a.position),S$a.sprite3D=this.sprite3D}}(),function(){function S$a(S$a,S$m){this._width=0,this._height=0,this._width=S$a,this._height=S$m}S$Q(S$a,"laya.d3.utils.Size");var S$m=S$a.prototype;return S$q(0,S$m,"width",function(){return-1===this._width?S$Y.clientWidth:this._width}),S$q(0,S$m,"height",function(){return-1===this._height?S$Y.clientHeight:this._height}),S$q(1,S$a,"fullScreen",function(){return new S$a(-1,-1)}),S$a}()),S$um=function(){function S$S(){}return S$Q(S$S,"laya.d3.utils.Utils3D"),S$S._rotationTransformScaleSkinAnimation=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y){var S$d,S$Q,S$q,S$h,S$u,S$O=S$S._tempArray16_0,S$p=S$S._tempArray16_1,S$c=S$S._tempArray16_2,S$H=S$P+S$P,S$o=S$_+S$_,S$N=S$e+S$e,S$z=S$P*S$H,S$U=S$_*S$H,S$l=S$_*S$o,S$C=S$e*S$H,S$f=S$e*S$o,S$K=S$e*S$N,S$V=S$A*S$H,S$W=S$A*S$o,S$b=S$A*S$N;for(S$O[15]=1,S$O[0]=1-S$l-S$K,S$O[1]=S$U+S$b,S$O[2]=S$C-S$W,S$O[4]=S$U-S$b,S$O[5]=1-S$z-S$K,S$O[6]=S$f+S$V,S$O[8]=S$C+S$W,S$O[9]=S$f-S$V,S$O[10]=1-S$z-S$l,S$p[15]=1,S$p[0]=S$B,S$p[5]=S$k,S$p[10]=S$j,S$d=0;S$d<4;S$d++)S$Q=S$O[S$d],S$q=S$O[S$d+4],S$h=S$O[S$d+8],S$u=S$O[S$d+12],S$c[S$d]=S$Q,S$c[S$d+4]=S$q,S$c[S$d+8]=S$h,S$c[S$d+12]=S$Q*S$a+S$q*S$m+S$h*S$s+S$u;for(S$d=0;S$d<4;S$d++)S$Q=S$c[S$d],S$q=S$c[S$d+4],S$h=S$c[S$d+8],S$u=S$c[S$d+12],S$G[S$d+S$y]=S$Q*S$p[0]+S$q*S$p[1]+S$h*S$p[2]+S$u*S$p[3],S$G[S$d+S$y+4]=S$Q*S$p[4]+S$q*S$p[5]+S$h*S$p[6]+S$u*S$p[7],S$G[S$d+S$y+8]=S$Q*S$p[8]+S$q*S$p[9]+S$h*S$p[10]+S$u*S$p[11],S$G[S$d+S$y+12]=S$Q*S$p[12]+S$q*S$p[13]+S$h*S$p[14]+S$u*S$p[15]},S$S._createNodeByJson=function(S$a,S$m,S$s,S$P){if(!S$s)switch(S$m.type){case"Sprite3D":S$s=new S$Xm;break;case"MeshSprite3D":S$s=new S$vm;break;case"SkinnedMeshSprite3D":S$s=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":S$s=new ShuriKenParticle3D;break;case"TrailSprite3D":S$s=new TrailSprite3D;break;case"Terrain":S$s=new Terrain;break;case"Camera":S$s=new S$wm;break;case"DirectionLight":S$s=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var S$_=S$m.props;if(S$_)for(var S$e in S$_)S$s[S$e]=S$_[S$e];var S$A=S$m.customProps;S$A&&(S$s instanceof laya.d3.core.Sprite3D?(S$s._parseBaseCustomProps(S$A),S$s._parseCustomProps(S$a,S$P,S$A,S$m),S$s._parseCustomComponent(S$a,S$P,S$m.components)):S$s._parseCustomProps(S$a,S$P,S$A,S$m));var S$B=S$m.child;if(S$B)for(var S$k=0,S$j=S$B.length;S$k<S$j;S$k++){var S$G=S$S._createNodeByJson(S$a,S$B[S$k],null,S$P);S$s.addChild(S$G)}return S$s},S$S._computeBoneAndAnimationDatasByBindPoseMatrxix=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A,S$B,S$k=0,S$j=0,S$G=S$a.length;for(S$A=0;S$A<S$G;S$k+=S$a[S$A].keyframeWidth,S$j+=16,S$A++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(S$m[S$k+0],S$m[S$k+1],S$m[S$k+2],S$m[S$k+3],S$m[S$k+4],S$m[S$k+5],S$m[S$k+6],S$m[S$k+7],S$m[S$k+8],S$m[S$k+9],S$P,S$j),0!=S$A&&(S$B=16*S$a[S$A].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(S$P,S$B,S$P,S$j,S$P,S$j));var S$y=S$s.length;for(S$A=0;S$A<S$y;S$A++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(S$P,16*S$e[S$A],S$s[S$A],S$_,16*S$A)},S$S._computeAnimationDatasByArrayAndMatrixFast=function(S$a,S$m,S$s,S$P){for(var S$_=0,S$e=S$a.length;S$_<S$e;S$_++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(S$m,16*S$P[S$_],S$a[S$_],S$s,16*S$_)},S$S._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(S$a,S$m,S$s,S$P,S$_){var S$e,S$A,S$B=0,S$k=0,S$j=S$a.length;for(S$e=0;S$e<S$j;S$B+=S$a[S$e].keyframeWidth,S$k+=16,S$e++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(S$m[S$B+7],S$m[S$B+8],S$m[S$B+9],S$m[S$B+3],S$m[S$B+4],S$m[S$B+5],S$m[S$B+6],S$m[S$B+0],S$m[S$B+1],S$m[S$B+2],S$P,S$k),0!=S$e&&(S$A=16*S$a[S$e].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(S$P,S$A,S$P,S$k,S$P,S$k));var S$G=S$s.length;for(S$e=0;S$e<S$G;S$e++){var S$y=16*S$e;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(S$P,S$y,S$s[S$e],S$_,S$y)}},S$S._computeAnimationDatasByArrayAndMatrixFastOld=function(S$a,S$m,S$s){for(var S$P=S$a.length,S$_=0;S$_<S$P;S$_++){var S$e=16*S$_;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(S$m,S$e,S$a[S$_],S$s,S$e)}},S$S._computeRootAnimationData=function(S$a,S$m,S$s){for(var S$P=0,S$_=0,S$e=0,S$A=S$a.length;S$P<S$A;S$_+=S$a[S$P].keyframeWidth,S$e+=16,S$P++)laya.d3.utils.Utils3D.createAffineTransformationArray(S$m[S$_+0],S$m[S$_+1],S$m[S$_+2],S$m[S$_+3],S$m[S$_+4],S$m[S$_+5],S$m[S$_+6],S$m[S$_+7],S$m[S$_+8],S$m[S$_+9],S$s,S$e)},S$S.transformVector3ArrayByQuat=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$s.elements,S$A=S$a[S$m],S$B=S$a[S$m+1],S$k=S$a[S$m+2],S$j=S$e[0],S$G=S$e[1],S$y=S$e[2],S$d=S$e[3],S$Q=S$d*S$A+S$G*S$k-S$y*S$B,S$q=S$d*S$B+S$y*S$A-S$j*S$k,S$h=S$d*S$k+S$j*S$B-S$G*S$A,S$u=-S$j*S$A-S$G*S$B-S$y*S$k;S$P[S$_]=S$Q*S$d+S$u*-S$j+S$q*-S$y-S$h*-S$G,S$P[S$_+1]=S$q*S$d+S$u*-S$G+S$h*-S$j-S$Q*-S$y,S$P[S$_+2]=S$h*S$d+S$u*-S$y+S$Q*-S$G-S$q*-S$j},S$S.mulMatrixByArray=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A,S$B,S$k,S$j,S$G;if(S$_===S$s){for(S$s=S$S._tempArray16_3,S$A=0;S$A<16;++S$A)S$s[S$A]=S$_[S$e+S$A];S$P=0}for(S$A=0;S$A<4;S$A++)S$B=S$a[S$m+S$A],S$k=S$a[S$m+S$A+4],S$j=S$a[S$m+S$A+8],S$G=S$a[S$m+S$A+12],S$_[S$e+S$A]=S$B*S$s[S$P+0]+S$k*S$s[S$P+1]+S$j*S$s[S$P+2]+S$G*S$s[S$P+3],S$_[S$e+S$A+4]=S$B*S$s[S$P+4]+S$k*S$s[S$P+5]+S$j*S$s[S$P+6]+S$G*S$s[S$P+7],S$_[S$e+S$A+8]=S$B*S$s[S$P+8]+S$k*S$s[S$P+9]+S$j*S$s[S$P+10]+S$G*S$s[S$P+11],S$_[S$e+S$A+12]=S$B*S$s[S$P+12]+S$k*S$s[S$P+13]+S$j*S$s[S$P+14]+S$G*S$s[S$P+15]},S$S.mulMatrixByArrayFast=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A,S$B,S$k,S$j,S$G;for(S$A=0;S$A<4;S$A++)S$B=S$a[S$m+S$A],S$k=S$a[S$m+S$A+4],S$j=S$a[S$m+S$A+8],S$G=S$a[S$m+S$A+12],S$_[S$e+S$A]=S$B*S$s[S$P+0]+S$k*S$s[S$P+1]+S$j*S$s[S$P+2]+S$G*S$s[S$P+3],S$_[S$e+S$A+4]=S$B*S$s[S$P+4]+S$k*S$s[S$P+5]+S$j*S$s[S$P+6]+S$G*S$s[S$P+7],S$_[S$e+S$A+8]=S$B*S$s[S$P+8]+S$k*S$s[S$P+9]+S$j*S$s[S$P+10]+S$G*S$s[S$P+11],S$_[S$e+S$A+12]=S$B*S$s[S$P+12]+S$k*S$s[S$P+13]+S$j*S$s[S$P+14]+S$G*S$s[S$P+15]},S$S.mulMatrixByArrayAndMatrixFast=function(S$a,S$m,S$s,S$P,S$_){var S$e,S$A,S$B,S$k,S$j,S$G=S$s.elements,S$y=S$G[0],S$d=S$G[1],S$Q=S$G[2],S$q=S$G[3],S$h=S$G[4],S$u=S$G[5],S$O=S$G[6],S$p=S$G[7],S$c=S$G[8],S$H=S$G[9],S$o=S$G[10],S$N=S$G[11],S$z=S$G[12],S$U=S$G[13],S$l=S$G[14],S$C=S$G[15],S$f=S$m,S$K=S$m+4,S$V=S$m+8,S$W=S$m+12,S$b=S$_,S$S=S$_+4,S$Z=S$_+8,S$X=S$_+12;for(S$e=0;S$e<4;S$e++)S$A=S$a[S$f+S$e],S$B=S$a[S$K+S$e],S$k=S$a[S$V+S$e],S$j=S$a[S$W+S$e],S$P[S$b+S$e]=S$A*S$y+S$B*S$d+S$k*S$Q+S$j*S$q,S$P[S$S+S$e]=S$A*S$h+S$B*S$u+S$k*S$O+S$j*S$p,S$P[S$Z+S$e]=S$A*S$c+S$B*S$H+S$k*S$o+S$j*S$N,S$P[S$X+S$e]=S$A*S$z+S$B*S$U+S$k*S$l+S$j*S$C},S$S.createAffineTransformationArray=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y){var S$d=S$P+S$P,S$Q=S$_+S$_,S$q=S$e+S$e,S$h=S$P*S$d,S$u=S$P*S$Q,S$O=S$P*S$q,S$p=S$_*S$Q,S$c=S$_*S$q,S$H=S$e*S$q,S$o=S$A*S$d,S$N=S$A*S$Q,S$z=S$A*S$q;S$G[S$y+0]=(1-(S$p+S$H))*S$B,S$G[S$y+1]=(S$u+S$z)*S$B,S$G[S$y+2]=(S$O-S$N)*S$B,S$G[S$y+3]=0,S$G[S$y+4]=(S$u-S$z)*S$k,S$G[S$y+5]=(1-(S$h+S$H))*S$k,S$G[S$y+6]=(S$c+S$o)*S$k,S$G[S$y+7]=0,S$G[S$y+8]=(S$O+S$N)*S$j,S$G[S$y+9]=(S$c-S$o)*S$j,S$G[S$y+10]=(1-(S$h+S$p))*S$j,S$G[S$y+11]=0,S$G[S$y+12]=S$a,S$G[S$y+13]=S$m,S$G[S$y+14]=S$s,S$G[S$y+15]=1},S$S.transformVector3ArrayToVector3ArrayCoordinate=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$S._tempArray4_0,S$A=S$a[S$m+0],S$B=S$a[S$m+1],S$k=S$a[S$m+2],S$j=S$s.elements;S$e[0]=S$A*S$j[0]+S$B*S$j[4]+S$k*S$j[8]+S$j[12],S$e[1]=S$A*S$j[1]+S$B*S$j[5]+S$k*S$j[9]+S$j[13],S$e[2]=S$A*S$j[2]+S$B*S$j[6]+S$k*S$j[10]+S$j[14],S$e[3]=1/(S$A*S$j[3]+S$B*S$j[7]+S$k*S$j[11]+S$j[15]),S$P[S$_+0]=S$e[0]*S$e[3],S$P[S$_+1]=S$e[1]*S$e[3],S$P[S$_+2]=S$e[2]*S$e[3]},S$S.transformLightingMapTexcoordByUV0Array=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$s.elements;S$P[S$_+0]=S$a[S$m+0]*S$e[0]+S$e[2],S$P[S$_+1]=(S$a[S$m+1]-1)*S$e[1]+S$e[3]},S$S.transformLightingMapTexcoordByUV1Array=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$s.elements;S$P[S$_+0]=S$a[S$m+0]*S$e[0]+S$e[2],S$P[S$_+1]=1+S$a[S$m+1]*S$e[1]+S$e[3]},S$S.getURLVerion=function(S$a){var S$m=S$a.indexOf("?");return 0<=S$m?S$a.substr(S$m):null},S$S._quaternionCreateFromYawPitchRollArray=function(S$a,S$m,S$s,S$P){var S$_=.5*S$s,S$e=.5*S$m,S$A=.5*S$a,S$B=Math.sin(S$_),S$k=Math.cos(S$_),S$j=Math.sin(S$e),S$G=Math.cos(S$e),S$y=Math.sin(S$A),S$d=Math.cos(S$A);S$P[0]=S$d*S$j*S$k+S$y*S$G*S$B,S$P[1]=S$y*S$G*S$k-S$d*S$j*S$B,S$P[2]=S$d*S$G*S$B-S$y*S$j*S$k,S$P[3]=S$d*S$G*S$k+S$y*S$j*S$B},S$S._createAffineTransformationArray=function(S$a,S$m,S$s,S$P){var S$_=S$m[0],S$e=S$m[1],S$A=S$m[2],S$B=S$m[3],S$k=S$_+S$_,S$j=S$e+S$e,S$G=S$A+S$A,S$y=S$_*S$k,S$d=S$_*S$j,S$Q=S$_*S$G,S$q=S$e*S$j,S$h=S$e*S$G,S$u=S$A*S$G,S$O=S$B*S$k,S$p=S$B*S$j,S$c=S$B*S$G,S$H=S$s[0],S$o=S$s[1],S$N=S$s[2];S$P[0]=(1-(S$q+S$u))*S$H,S$P[1]=(S$d+S$c)*S$H,S$P[2]=(S$Q-S$p)*S$H,S$P[3]=0,S$P[4]=(S$d-S$c)*S$o,S$P[5]=(1-(S$y+S$u))*S$o,S$P[6]=(S$h+S$O)*S$o,S$P[7]=0,S$P[8]=(S$Q+S$p)*S$N,S$P[9]=(S$h-S$O)*S$N,S$P[10]=(1-(S$y+S$q))*S$N,S$P[11]=0,S$P[12]=S$a[0],S$P[13]=S$a[1],S$P[14]=S$a[2],S$P[15]=1},S$S._mulMatrixArray=function(S$a,S$m,S$s,S$P){var S$_,S$e,S$A,S$B,S$k,S$j=S$m.elements,S$G=S$j[0],S$y=S$j[1],S$d=S$j[2],S$Q=S$j[3],S$q=S$j[4],S$h=S$j[5],S$u=S$j[6],S$O=S$j[7],S$p=S$j[8],S$c=S$j[9],S$H=S$j[10],S$o=S$j[11],S$N=S$j[12],S$z=S$j[13],S$U=S$j[14],S$l=S$j[15],S$C=S$P,S$f=S$P+4,S$K=S$P+8,S$V=S$P+12;for(S$_=0;S$_<4;S$_++)S$e=S$a[S$_],S$A=S$a[S$_+4],S$B=S$a[S$_+8],S$k=S$a[S$_+12],S$s[S$C+S$_]=S$e*S$G+S$A*S$y+S$B*S$d+S$k*S$Q,S$s[S$f+S$_]=S$e*S$q+S$A*S$h+S$B*S$u+S$k*S$O,S$s[S$K+S$_]=S$e*S$p+S$A*S$c+S$B*S$H+S$k*S$o,S$s[S$V+S$_]=S$e*S$N+S$A*S$z+S$B*S$U+S$k*S$l},S$S.getYawPitchRoll=function(S$a,S$m){S$S.transformQuat(S$Am.ForwardRH,S$a,S$sm.TEMPVector31),S$S.transformQuat(S$Am.Up,S$a,S$sm.TEMPVector32);var S$s=S$sm.TEMPVector32.elements;S$S.angleTo(S$Am.ZERO,S$sm.TEMPVector31,S$sm.TEMPVector33);var S$P=S$sm.TEMPVector33.elements;S$P[0]==Math.PI/2?(S$P[1]=S$S.arcTanAngle(S$s[2],S$s[0]),S$P[2]=0):S$P[0]==-Math.PI/2?(S$P[1]=S$S.arcTanAngle(-S$s[2],-S$s[0]),S$P[2]=0):(S$am.createRotationY(-S$P[1],S$sm.TEMPMatrix0),S$am.createRotationX(-S$P[0],S$sm.TEMPMatrix1),S$Am.transformCoordinate(S$sm.TEMPVector32,S$sm.TEMPMatrix0,S$sm.TEMPVector32),S$Am.transformCoordinate(S$sm.TEMPVector32,S$sm.TEMPMatrix1,S$sm.TEMPVector32),S$P[2]=S$S.arcTanAngle(S$s[1],-S$s[0])),S$P[1]<=-Math.PI&&(S$P[1]=Math.PI),S$P[2]<=-Math.PI&&(S$P[2]=Math.PI),S$P[1]>=Math.PI&&S$P[2]>=Math.PI&&(S$P[1]=0,S$P[2]=0,S$P[0]=Math.PI-S$P[0]),S$m[0]=S$P[1],S$m[1]=S$P[0],S$m[2]=S$P[2]},S$S.arcTanAngle=function(S$a,S$m){return 0==S$a?1==S$m?Math.PI/2:-Math.PI/2:0<S$a?Math.atan(S$m/S$a):S$a<0?0<S$m?Math.atan(S$m/S$a)+Math.PI:Math.atan(S$m/S$a)-Math.PI:0},S$S.angleTo=function(S$a,S$m,S$s){S$Am.subtract(S$m,S$a,S$sm.TEMPVector30),S$Am.normalize(S$sm.TEMPVector30,S$sm.TEMPVector30),S$s.elements[0]=Math.asin(S$sm.TEMPVector30.y),S$s.elements[1]=S$S.arcTanAngle(-S$sm.TEMPVector30.z,-S$sm.TEMPVector30.x)},S$S.transformQuat=function(S$a,S$m,S$s){var S$P=S$s.elements,S$_=S$a.elements,S$e=S$m,S$A=S$_[0],S$B=S$_[1],S$k=S$_[2],S$j=S$e[0],S$G=S$e[1],S$y=S$e[2],S$d=S$e[3],S$Q=S$d*S$A+S$G*S$k-S$y*S$B,S$q=S$d*S$B+S$y*S$A-S$j*S$k,S$h=S$d*S$k+S$j*S$B-S$G*S$A,S$u=-S$j*S$A-S$G*S$B-S$y*S$k;S$P[0]=S$Q*S$d+S$u*-S$j+S$q*-S$y-S$h*-S$G,S$P[1]=S$q*S$d+S$u*-S$G+S$h*-S$j-S$Q*-S$y,S$P[2]=S$h*S$d+S$u*-S$y+S$Q*-S$G-S$q*-S$j},S$S.quaterionNormalize=function(S$a,S$m){var S$s=S$a[0],S$P=S$a[1],S$_=S$a[2],S$e=S$a[3],S$A=S$s*S$s+S$P*S$P+S$_*S$_+S$e*S$e;0<S$A&&(S$A=1/Math.sqrt(S$A),S$m[0]=S$s*S$A,S$m[1]=S$P*S$A,S$m[2]=S$_*S$A,S$m[3]=S$e*S$A)},S$S.matrix4x4MultiplyFFF=function(S$a,S$m,S$s){var S$P,S$_,S$e,S$A,S$B;if(S$s===S$m)for(S$m=new Float32Array(16),S$P=0;S$P<16;++S$P)S$m[S$P]=S$s[S$P];for(S$P=0;S$P<4;S$P++)S$_=S$a[S$P],S$e=S$a[S$P+4],S$A=S$a[S$P+8],S$B=S$a[S$P+12],S$s[S$P]=S$_*S$m[0]+S$e*S$m[1]+S$A*S$m[2]+S$B*S$m[3],S$s[S$P+4]=S$_*S$m[4]+S$e*S$m[5]+S$A*S$m[6]+S$B*S$m[7],S$s[S$P+8]=S$_*S$m[8]+S$e*S$m[9]+S$A*S$m[10]+S$B*S$m[11],S$s[S$P+12]=S$_*S$m[12]+S$e*S$m[13]+S$A*S$m[14]+S$B*S$m[15]},S$S.matrix4x4MultiplyMFM=function(S$a,S$m,S$s){S$S.matrix4x4MultiplyFFF(S$a.elements,S$m,S$s.elements)},S$y(S$S,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new S$Am},"_tempVector3_1",function(){return this._tempVector3_1=new S$Am},"_tempVector3_2",function(){return this._tempVector3_2=new S$Am},"_tempVector3_3",function(){return this._tempVector3_3=new S$Am},"_tempVector3_4",function(){return this._tempVector3_4=new S$Am},"_tempVector3_5",function(){return this._tempVector3_5=new S$Am},"_tempVector3_6",function(){return this._tempVector3_6=new S$Am},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),S$S}(),S$Om=function(){function S$W(){}return S$Q(S$W,"Laya3D"),S$W._cancelLoadByUrl=function(S$a){S$o.loader.cancelLoadByUrl(S$a),S$W._innerFirstLevelLoaderManager.cancelLoadByUrl(S$a),S$W._innerSecondLevelLoaderManager.cancelLoadByUrl(S$a),S$W._innerThirdLevelLoaderManager.cancelLoadByUrl(S$a),S$W._innerFourthLevelLoaderManager.cancelLoadByUrl(S$a)},S$W._changeWebGLSize=function(S$a,S$m){S$V.onStageResize(S$a,S$m),S$Y.clientWidth=S$a,S$Y.clientHeight=S$m},S$W.__init__=function(){var S$a=S$m.createMap;S$a.lh=[S$Xm,"SPRITE3DHIERARCHY"],S$a.ls=[S$Zm,"SPRITE3DHIERARCHY"],S$a.lm=[S$xm,"MESH"],S$a.lmat=[S$im,"MATERIAL"],S$a.jpg=[S$Jm,"nativeimage"],S$a.jpeg=[S$Jm,"nativeimage"],S$a.png=[S$Jm,"nativeimage"],S$a.pkm=[S$Jm,"arraybuffer"],S$a.raw=[S$Rm,"arraybuffer"],S$a.mipmaps=[S$Rm,"arraybuffer"],S$O.parserMap.SPRITE3DHIERARCHY=S$W._loadHierarchy,S$O.parserMap.MESH=S$W._loadMesh,S$O.parserMap.MATERIAL=S$W._loadMaterial,S$O.parserMap.TEXTURECUBE=S$W._loadTextureCube,S$O.parserMap.TERRAIN=S$W._loadTerrain,S$W._innerFirstLevelLoaderManager.on("error",null,S$W._eventLoadManagerError),S$W._innerSecondLevelLoaderManager.on("error",null,S$W._eventLoadManagerError),S$W._innerThirdLevelLoaderManager.on("error",null,S$W._eventLoadManagerError),S$W._innerFourthLevelLoaderManager.on("error",null,S$W._eventLoadManagerError)},S$W.READ_BLOCK=function(){return S$W._readData.pos+=4,!0},S$W.READ_DATA=function(){return S$W._DATA.offset=S$W._readData.getUint32(),S$W._DATA.size=S$W._readData.getUint32(),!0},S$W.READ_STRINGS=function(){var S$a=[],S$m={offset:0,size:0};S$m.offset=S$W._readData.getUint16(),S$m.size=S$W._readData.getUint16();S$W._readData.pos;S$W._readData.pos=S$m.offset+S$W._DATA.offset;for(var S$s=0;S$s<S$m.size;S$s++){var S$P=S$W._readData.readUTFString();-1===S$P.lastIndexOf(".lmat")&&-1===S$P.lastIndexOf(".lpbr")||S$a.push(S$P)}return S$a},S$W.formatRelativePath=function(S$a,S$m){var S$s;if("."===S$m.charAt(0)){for(var S$P=(S$a+S$m).split("/"),S$_=0,S$e=S$P.length;S$_<S$e;S$_++)if(".."==S$P[S$_]){var S$A=S$_-1;0<S$A&&".."!==S$P[S$A]&&(S$P.splice(S$A,2),S$_-=2)}S$s=S$P.join("/")}else S$s=S$a+S$m;return null!=S$K.customFormat&&(S$s=S$K.customFormat(S$s,null)),S$s},S$W._eventLoadManagerError=function(S$a){S$o.loader.event("error",S$a)},S$W._addHierarchyInnerUrls=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A=S$W.formatRelativePath(S$P,S$_);S$s&&(S$A+=S$s),S$a.push({url:S$A,clas:S$e}),S$m[S$_]=S$A},S$W._getSprite3DHierarchyInnerUrls=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){var S$B,S$k=0,S$j=0;switch(S$a.type){case"Scene":var S$G=S$a.customProps.lightmaps;for(S$k=0,S$j=S$G.length;S$k<S$j;S$k++){var S$y=S$G[S$k].replace(".exr",".png");S$W._addHierarchyInnerUrls(S$P,S$_,S$e,S$A,S$y,S$Jm)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var S$d;if(S$a.instanceParams)(S$d=S$a.instanceParams.loadPath)&&S$W._addHierarchyInnerUrls(S$m,S$_,S$e,S$A,S$d,S$xm);else{(S$d=(S$B=S$a.customProps).meshPath)&&S$W._addHierarchyInnerUrls(S$m,S$_,S$e,S$A,S$d,S$xm);var S$Q=S$B.materials;if(S$Q)for(S$k=0,S$j=S$Q.length;S$k<S$j;S$k++){for(var S$q=S$Q[S$k],S$h=S$q.type.split("."),S$u=S$b.window,S$O=0,S$p=S$h.length;S$O<S$p;++S$O){S$u=S$u[this.clasPaths[S$O]]}if("function"!=typeof S$u)throw"_getSprite3DHierarchyInnerUrls 错误: "+S$q.type+" 不是类";S$W._addHierarchyInnerUrls(S$s,S$_,S$e,S$A,S$q.path,S$u)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var S$c=(S$B=S$a.customProps).meshPath;S$c&&S$W._addHierarchyInnerUrls(S$m,S$_,S$e,S$A,S$c,S$xm);var S$H=S$B.material;if(S$H){S$h=S$H.type.split("."),S$u=S$b.window;for(S$O=0,S$p=S$h.length;S$O<S$p;++S$O){S$u=S$u[this.clasPaths[S$O]]}S$W._addHierarchyInnerUrls(S$s,S$_,S$e,S$A,S$H.path,S$u)}else{var S$o=S$B.materialPath;if(S$o)S$W._addHierarchyInnerUrls(S$s,S$_,S$e,S$A,S$o,ShurikenParticleMaterial);else{var S$N=S$B.texturePath;S$N&&S$W._addHierarchyInnerUrls(S$P,S$_,S$e,S$A,S$N,S$Jm)}}break;case"Terrain":S$W._addHierarchyInnerUrls(S$P,S$_,S$e,S$A,S$a.customProps.dataPath,TerrainRes)}var S$z=S$a.components;for(var S$U in S$z){var S$l=S$z[S$U];switch(S$U){case"Animator":var S$C=S$l.avatarPath;if(S$C)S$W._addHierarchyInnerUrls(S$P,S$_,S$e,S$A,S$C,Avatar);else{var S$f=S$l.avatar;S$f&&S$W._addHierarchyInnerUrls(S$P,S$_,S$e,S$A,S$f.path,Avatar)}var S$K=S$l.clipPaths;for(S$k=0,S$j=S$K.length;S$k<S$j;S$k++)S$W._addHierarchyInnerUrls(S$P,S$_,S$e,S$A,S$K[S$k],AnimationClip)}}var S$V=S$a.child;for(S$k=0,S$j=S$V.length;S$k<S$j;S$k++)S$W._getSprite3DHierarchyInnerUrls(S$V[S$k],S$m,S$s,S$P,S$_,S$e,S$A)},S$W._loadHierarchy=function(S$a){S$a.on("loaded",null,S$W._onHierarchylhLoaded,[S$a,S$a._class._getGroup()]),S$a.load(S$a.url,"json",!1,null,!0)},S$W._onHierarchylhLoaded=function(S$a,S$m,S$s){if(S$a._class.destroyed)S$a.endLoad();else{var S$P=S$a.url,S$_=S$um.getURLVerion(S$P),S$e=S$K.getPath(S$P),S$A=[],S$B=[],S$k=[],S$j={};S$W._getSprite3DHierarchyInnerUrls(S$s,S$A,S$B,S$k,S$j,S$_,S$e);var S$G=S$A.length+S$B.length+S$k.length,S$y=S$G+1,S$d=1/S$y;if(S$W._onProcessChange(S$a,0,S$d,1),0<S$k.length){var S$Q=S$G/S$y,S$q=S$f.create(null,S$W._onProcessChange,[S$a,S$d,S$Q],!1);S$W._innerFourthLevelLoaderManager.create(S$k,S$f.create(null,S$W._onHierarchyInnerForthLevResouLoaded,[S$a,S$m,S$q,S$s,S$j,S$A,S$B,S$d+S$Q*S$k.length,S$Q]),S$q,null,null,1,!0,S$m)}else S$W._onHierarchyInnerForthLevResouLoaded(S$a,S$m,null,S$s,S$j,S$A,S$B,S$d,S$Q)}},S$W._onHierarchyInnerForthLevResouLoaded=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){if(S$a._class.destroyed)S$a.endLoad();else if(S$s&&S$s.recover(),0<S$A.length){var S$j=S$f.create(null,S$W._onProcessChange,[S$a,S$B,S$k],!1);S$W._innerSecondLevelLoaderManager.create(S$A,S$f.create(null,S$W._onHierarchyInnerSecondLevResouLoaded,[S$a,S$m,S$j,S$P,S$_,S$e,S$B+S$k*S$A.length,S$k]),S$s,null,null,1,!0,S$m)}else S$W._onHierarchyInnerSecondLevResouLoaded(S$a,S$m,null,S$P,S$_,S$e,S$B,S$k)},S$W._onHierarchyInnerSecondLevResouLoaded=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B){if(S$a._class.destroyed)S$a.endLoad();else if(S$s&&S$s.recover(),0<S$e.length){var S$k=S$f.create(null,S$W._onProcessChange,[S$a,S$A,S$B],!1);S$W._innerFirstLevelLoaderManager.create(S$e,S$f.create(null,S$W._onHierarchyInnerFirstLevResouLoaded,[S$a,S$k,S$P,S$_]),S$s,null,null,1,!0,S$m)}else S$W._onHierarchyInnerFirstLevResouLoaded(S$a,null,S$P,S$_)},S$W._onHierarchyInnerFirstLevResouLoaded=function(S$a,S$m,S$s,S$P){S$m&&S$m.recover(),S$a.endLoad([S$s,S$P])},S$W._loadTerrain=function(S$a){S$a.on("loaded",null,S$W._onTerrainLtLoaded,[S$a,S$a._class._getGroup()]),S$a.load(S$a.url,"json",!1,null,!0)},S$W._onTerrainLtLoaded=function(S$a,S$m,S$s){if(S$a._class.destroyed)S$a.endLoad();else{var S$P,S$_,S$e=S$a.url,S$A=S$um.getURLVerion(S$e),S$B=S$K.getPath(S$e),S$k=[],S$j={},S$G=0,S$y=0,S$d=S$s.heightData;S$P=S$d.url,S$_=S$W.formatRelativePath(S$B,S$P),S$A&&(S$_+=S$A),S$P=S$j[S$P]=S$_;var S$Q=S$s.detailTexture;for(S$G=0,S$y=S$Q.length;S$G<S$y;S$G++)S$k.push({url:S$Q[S$G].diffuse});var S$q=S$s.normalMap;for(S$G=0,S$y=S$q.length;S$G<S$y;S$G++)S$k.push({url:S$q[S$G]});var S$h=S$s.alphaMap;for(S$G=0,S$y=S$h.length;S$G<S$y;S$G++)S$k.push({url:S$h[S$G],params:[!1,!1,6408,!0]});for(S$G=0,S$y=S$k.length;S$G<S$y;S$G++){var S$u=S$k[S$G].url;S$_=S$W.formatRelativePath(S$B,S$u),S$A&&(S$_+=S$A),S$k[S$G].url=S$_,S$j[S$u]=S$_}var S$O=S$k.length,S$p=S$O+2,S$c=1/S$p;S$W._onProcessChange(S$a,0,S$c,1);var S$H={heightMapLoaded:!1,texturesLoaded:!1},S$o=S$f.create(null,S$W._onProcessChange,[S$a,S$c,S$c],!1);S$W._innerFourthLevelLoaderManager.create(S$P,S$f.create(null,S$W._onTerrainHeightMapLoaded,[S$a,S$o,S$s,S$j,S$H]),S$o,null,[S$d.numX,S$d.numZ,S$d.bitType,S$d.value],1,!0,S$m);var S$N=S$f.create(null,S$W._onProcessChange,[S$a,2*S$c,S$O/S$p],!1);S$W._innerFourthLevelLoaderManager.create(S$k,S$f.create(null,S$W._onTerrainTexturesLoaded,[S$a,S$N,S$s,S$j,S$H]),S$N,null,null,1,!0,S$m)}},S$W._onTerrainHeightMapLoaded=function(S$a,S$m,S$s,S$P,S$_){S$_.heightMapLoaded=!0,S$_.texturesLoaded&&(S$a.endLoad([S$s,S$P]),S$m.recover())},S$W._onTerrainTexturesLoaded=function(S$a,S$m,S$s,S$P,S$_){S$_.texturesLoaded=!0,S$_.heightMapLoaded&&(S$a.endLoad([S$s,S$P]),S$m.recover())},S$W._loadMesh=function(S$a){S$a.on("loaded",null,S$W._onMeshLmLoaded,[S$a,S$a._class._getGroup()]),S$a.load(S$a.url,"arraybuffer",!1,null,!0)},S$W._onMeshLmLoaded=function(S$a,S$m,S$s){if(S$a._class.destroyed)S$a.endLoad();else{var S$P,S$_,S$e,S$A=S$a.url,S$B=S$um.getURLVerion(S$A),S$k=S$K.getPath(S$A),S$j={},S$G=0,S$y=0;switch((S$W._readData=new S$N(S$s)).pos=0,S$W._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var S$d=S$W._readData.getUint32();S$W._readData.pos=S$W._readData.pos+4,S$y=S$W._readData.getUint16(),S$W._readData.pos=S$W._readData.pos+8*S$y;var S$Q=S$W._readData.getUint32();for(S$y=S$W._readData.getUint16(),S$W._readData.pos=S$d+S$Q,S$P=[],S$G=0;S$G<S$y;S$G++){var S$q=S$W._readData.readUTFString();-1!==S$q.lastIndexOf(".lmat")&&S$P.push(S$q)}break;default:for(S$W.READ_BLOCK(),S$G=0;S$G<2;S$G++){var S$h=S$W._readData.getUint16(),S$u=S$W._strings[S$h],S$O=S$W["READ_"+S$u];if(null==S$O)throw new Error("model file err,no this function:"+S$h+" "+S$u);1===S$G?S$P=S$O.call():S$O.call()}}for(S$G=0,S$e=S$P.length;S$G<S$e;S$G++){var S$p=S$P[S$G];S$_=S$W.formatRelativePath(S$k,S$p),S$B&&(S$_+=S$B),S$P[S$G]=S$_,S$j[S$p]=S$_}if(0<S$P.length){S$W._onProcessChange(S$a,0,.5,1);var S$c=S$f.create(null,S$W._onProcessChange,[S$a,.5,.5],!1);S$W._innerSecondLevelLoaderManager.create(S$P,S$f.create(null,S$W._onMeshMateialLoaded,[S$a,S$c,S$s,S$j]),S$c,null,null,1,!0,S$m)}else S$a.endLoad([S$s,S$j])}},S$W._onMeshMateialLoaded=function(S$a,S$m,S$s,S$P){S$a.endLoad([S$s,S$P]),S$m.recover()},S$W._getMaterialTexturePath=function(S$a,S$m,S$s){var S$P=S$a.length-4;return S$a.indexOf(".dds")!=S$P&&S$a.indexOf(".tga")!=S$P&&S$a.indexOf(".exr")!=S$P&&S$a.indexOf(".DDS")!=S$P&&S$a.indexOf(".TGA")!=S$P&&S$a.indexOf(".EXR")!=S$P||(S$a=S$a.substr(0,S$P)+".png"),S$a=S$W.formatRelativePath(S$s,S$a),S$m&&(S$a+=S$m),S$a},S$W._loadMaterial=function(S$a){S$a.on("loaded",null,S$W._onMaterilLmatLoaded,[S$a,S$a._class._getGroup()]),S$a.load(S$a.url,"json",!1,null,!0)},S$W._onMaterilLmatLoaded=function(S$a,S$m,S$s){if(S$a._class.destroyed)S$a.endLoad();else{var S$P,S$_=S$a.url,S$e=S$um.getURLVerion(S$_),S$A=S$K.getPath(S$_),S$B=[],S$k={},S$j=S$s.customProps,S$G=S$s.version;if(S$G)switch(S$G){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var S$y=S$s.props.textures,S$d=0,S$Q=S$y.length;S$d<S$Q;S$d++){var S$q=S$y[S$d],S$h=S$q.path;if(S$h){var S$u=S$h.length-4;S$h.indexOf(".exr")!=S$u&&S$h.indexOf(".EXR")!=S$u||(S$h=S$h.substr(0,S$u)+".png"),S$P=S$W.formatRelativePath(S$A,S$h),S$e&&(S$P+=S$e),S$B.push({url:S$P,params:S$q.params}),S$k[S$h]=S$P}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var S$O=S$j.diffuseTexture.texture2D;if(S$O&&(S$P=S$W._getMaterialTexturePath(S$O,S$e,S$A),S$B.push(S$P),S$k[S$O]=S$P),S$j.normalTexture){var S$p=S$j.normalTexture.texture2D;S$p&&(S$P=S$W._getMaterialTexturePath(S$p,S$e,S$A),S$B.push(S$P),S$k[S$p]=S$P)}if(S$j.specularTexture){var S$c=S$j.specularTexture.texture2D;S$c&&(S$P=S$W._getMaterialTexturePath(S$c,S$e,S$A),S$B.push(S$P),S$k[S$c]=S$P)}if(S$j.emissiveTexture){var S$H=S$j.emissiveTexture.texture2D;S$H&&(S$P=S$W._getMaterialTexturePath(S$H,S$e,S$A),S$B.push(S$P),S$k[S$H]=S$P)}if(S$j.ambientTexture){var S$o=S$j.ambientTexture.texture2D;S$o&&(S$P=S$W._getMaterialTexturePath(S$o,S$e,S$A),S$B.push(S$P),S$k[S$o]=S$P)}if(S$j.reflectTexture){var S$N=S$j.reflectTexture.texture2D;S$N&&(S$P=S$W._getMaterialTexturePath(S$N,S$e,S$A),S$B.push(S$P),S$k[S$N]=S$P)}}var S$z=S$B.length,S$U=S$z+1,S$l=1/S$U;if(S$W._onProcessChange(S$a,0,S$l,1),0<S$z){var S$C=S$f.create(null,S$W._onProcessChange,[S$a,S$l,S$z/S$U],!1);S$W._innerFourthLevelLoaderManager.create(S$B,S$f.create(null,S$W._onMateialTexturesLoaded,[S$a,S$C,S$s,S$k]),S$C,S$Jm,null,1,!0,S$m)}else S$W._onMateialTexturesLoaded(S$a,null,S$s,null)}},S$W._onMateialTexturesLoaded=function(S$a,S$m,S$s,S$P){S$a.endLoad([S$s,S$P]),S$m&&S$m.recover()},S$W._loadTextureCube=function(S$a){S$a.on("loaded",null,S$W._onTextureCubeLtcLoaded,[S$a]),S$a.load(S$a.url,"json",!1,null,!0)},S$W._onTextureCubeLtcLoaded=function(S$a,S$m){if(S$a._class.destroyed)S$a.endLoad();else{var S$s=S$K.getPath(S$a.url),S$P=[S$W.formatRelativePath(S$s,S$m.px),S$W.formatRelativePath(S$s,S$m.nx),S$W.formatRelativePath(S$s,S$m.py),S$W.formatRelativePath(S$s,S$m.ny),S$W.formatRelativePath(S$s,S$m.pz),S$W.formatRelativePath(S$s,S$m.nz)];S$W._onProcessChange(S$a,0,1/7,1);var S$_=S$f.create(null,S$W._onProcessChange,[S$a,1/7,6/7],!1);S$W._innerFourthLevelLoaderManager.load(S$P,S$f.create(null,S$W._onTextureCubeImagesLoaded,[S$a,S$P,S$_]),S$_,"nativeimage")}},S$W._onTextureCubeImagesLoaded=function(S$a,S$m,S$s){var S$P=[];S$P.length=6;for(var S$_=0;S$_<6;S$_++){var S$e=S$m[S$_];S$P[S$_]=S$O.getRes(S$e),S$O.clearRes(S$e)}S$a.endLoad(S$P),S$s.recover()},S$W._onProcessChange=function(S$a,S$m,S$s,S$P){(S$P=S$m+S$P*S$s)<1&&S$a.event("progress",S$P)},S$W.init=function(S$a,S$m,S$s,S$P,S$_,S$e){if(void 0===S$s&&(S$s=!1),void 0===S$P&&(S$P=!1),void 0===S$_&&(S$_=!0),void 0===S$e&&(S$e=!0),S$p.update3DLoop=function(){},S$p.cancelLoadByUrl=function(S$a){S$W._cancelLoadByUrl(S$a)},S$k.isAntialias=S$s,S$k.isAlpha=S$P,S$k.premultipliedAlpha=S$_,S$k.isStencil=S$e,!S$V.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");S$p.changeWebGLSize=S$W._changeWebGLSize,S$h.is3DMode=!0,S$o.init(S$a,S$m),S$S.__init__(),S$ym.__init__(),S$vm.__init__(),S$F.__init__(),S$W.__init__(),S$A.maxTextureCount=2,(S$W.debugMode||S$T.debugMode)&&(S$W._debugPhasorSprite=new S$g)},S$W.HIERARCHY="SPRITE3DHIERARCHY",S$W.MESH="MESH",S$W.MATERIAL="MATERIAL",S$W.PBRMATERIAL="PBRMTL",S$W.TEXTURECUBE="TEXTURECUBE",S$W.TERRAIN="TERRAIN",S$W._readData=null,S$W._debugPhasorSprite=null,S$W.debugMode=!1,S$y(S$W,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new S$m},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new S$m},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new S$m},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new S$m}]),S$W}(),S$pm=function(S$a){function S$_(S$a){S$_.__super.call(this),this._owner=S$a,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}S$Q(S$_,"laya.d3.animation.AnimationTransform3D",S$e);var S$m=S$_.prototype;return S$m._getlocalMatrix=function(){return this._localUpdate&&(S$um._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},S$m._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._onWorldTransform()}},S$m._setWorldMatrixAndUpdate=function(S$a){if(this._worldMatrix=S$a,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var S$m=this._getlocalMatrix(),S$s=0;S$s<16;++S$s)this._worldMatrix[S$s]=S$m[S$s];else S$um.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},S$m._setWorldMatrixNoUpdate=function(S$a){this._worldMatrix=S$a},S$m._setWorldMatrixIgnoreUpdate=function(S$a){this._worldMatrix=S$a,this._worldUpdate=!1},S$m.getLocalPosition=function(){return this._localPosition},S$m.setLocalPosition=function(S$a){if(this._parent)this._localPosition=S$a,this._localUpdate=!0,this._onWorldTransform();else{var S$m=this._entity.owner._transform,S$s=this._entity.localPosition,S$P=S$s.elements;S$P[0]=S$a[0],S$P[1]=S$a[1],S$P[2]=S$a[2],S$m.localPosition=S$s}},S$m.getLocalRotation=function(){if(this._localQuaternionUpdate){var S$a=this._localRotationEuler;S$um._quaternionCreateFromYawPitchRollArray(S$a[1]/S$_._angleToRandin,S$a[0]/S$_._angleToRandin,S$a[2]/S$_._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},S$m.setLocalRotation=function(S$a){if(this._parent)this._localRotation=S$a,S$um.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var S$m=this._entity.owner._transform,S$s=this._entity.localRotation,S$P=S$s.elements;S$P[0]=S$a[0],S$P[1]=S$a[1],S$P[2]=S$a[2],S$P[3]=S$a[3],S$m.localRotation=S$s}},S$m.getLocalScale=function(){return this._localScale},S$m.setLocalScale=function(S$a){if(this._parent)this._localScale=S$a,this._localUpdate=!0,this._onWorldTransform();else{var S$m=this._entity.owner._transform,S$s=this._entity.localScale,S$P=S$s.elements;S$P[0]=S$a[0],S$P[1]=S$a[1],S$P[2]=S$a[2],S$m.localScale=S$s}},S$m.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){S$um.getYawPitchRoll(this._localRotation,S$_._tempVector3);var S$a=S$_._tempVector3,S$m=this._localRotationEuler;S$m[0]=S$a[1]*S$_._angleToRandin,S$m[1]=S$a[0]*S$_._angleToRandin,S$m[2]=S$a[2]*S$_._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},S$m.setLocalRotationEuler=function(S$a){if(this._parent)S$um._quaternionCreateFromYawPitchRollArray(S$a[1]/S$_._angleToRandin,S$a[0]/S$_._angleToRandin,S$a[2]/S$_._angleToRandin,this._localRotation),this._localRotationEuler=S$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var S$m=this._entity.owner._transform,S$s=this._entity.localRotationEuler,S$P=S$s.elements;S$P[0]=S$a[0],S$P[1]=S$a[1],S$P[2]=S$a[2],S$m.localRotationEuler=S$s}},S$m.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)S$um.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var S$a=this._getlocalMatrix(),S$m=0;S$m<16;++S$m)this._worldMatrix[S$m]=S$a[S$m];this._worldUpdate=!1}return this._worldMatrix},S$m.setParent=function(S$a){if(this._parent!==S$a){if(this._parent){var S$m=this._parent._childs,S$s=S$m.indexOf(this);S$m.splice(S$s,1)}S$a&&(S$a._childs.push(this),S$a&&this._onWorldTransform()),this._parent=S$a}},S$y(S$_,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),S$_}(),S$cm=function(S$a){function S$m(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,S$m.__super.call(this),this._destroyed=!1,this._id=S$m._uniqueIDCounter,S$m._uniqueIDCounter++}S$Q(S$m,"laya.d3.component.Component3D",S$e);var S$s=S$m.prototype;return S$o.imps(S$s,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),S$s._initialize=function(S$a){this._owner=S$a,this._enable=!0,this.started=!1,this._load(S$a)},S$s._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},S$s._load=function(S$a){},S$s._start=function(S$a){},S$s._update=function(S$a){},S$s._lateUpdate=function(S$a){},S$s._preRenderUpdate=function(S$a){},S$s._postRenderUpdate=function(S$a){},S$s._unload=function(S$a){this.offAll()},S$s._cloneTo=function(S$a){},S$q(0,S$s,"id",function(){return this._id}),S$q(0,S$s,"destroyed",function(){return this._destroyed}),S$q(0,S$s,"owner",function(){return this._owner}),S$q(0,S$s,"enable",function(){return this._enable},function(S$a){this._enable!==S$a&&(this._enable=S$a,this.event("enablechanged",this._enable))}),S$q(0,S$s,"isSingleton",function(){return S$m._isSingleton}),S$m._isSingleton=!0,S$m._uniqueIDCounter=1,S$m}(),S$Hm=function(S$a){function S$m(){this._destroyed=!1,S$m.__super.call(this),this._destroyed=!1}S$Q(S$m,"laya.d3.core.GeometryFilter",S$e);var S$s=S$m.prototype;return S$o.imps(S$s,{"laya.resource.IDestroy":!0}),S$s._destroy=function(){this.offAll(),this._destroyed=!0},S$q(0,S$s,"_isAsyncLoaded",function(){return!0}),S$q(0,S$s,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),S$q(0,S$s,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),S$q(0,S$s,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),S$q(0,S$s,"destroyed",function(){return this._destroyed}),S$m}(),S$om=function(S$a){function S$P(S$a){S$P.__super.call(this),this._id=++S$P._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new S$Ta(new S$Am,new S$Am),this._boundingBoxCenter=new S$Am,this._boundingSphere=new S$$a(new S$Am,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=S$a,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}S$Q(S$P,"laya.d3.core.render.BaseRender",S$e);var S$m=S$P.prototype;return S$o.imps(S$m,{"laya.resource.IDestroy":!0}),S$m._changeMaterialReference=function(S$a,S$m){S$a&&S$a._removeReference(),S$m._addReference()},S$m._getInstanceMaterial=function(S$a,S$m){var S$s=new S$a.constructor;return S$a.cloneTo(S$s),S$s.name=S$s.name+"(Instance)",this._materialsInstance[S$m]=!0,this._changeMaterialReference(this._materials[S$m],S$s),this._materials[S$m]=S$s},S$m._setShaderValuelightMap=function(S$a){this._setShaderValueTexture(3,S$a)},S$m._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},S$m._renderRenderableBoundBox=function(){var S$a=S$Om._debugPhasorSprite,S$m=this.boundingBox,S$s=S$P._tempBoundBoxCorners;S$m.getCorners(S$s),S$a.line(S$s[0],S$P._greenColor,S$s[1],S$P._greenColor),S$a.line(S$s[2],S$P._greenColor,S$s[3],S$P._greenColor),S$a.line(S$s[4],S$P._greenColor,S$s[5],S$P._greenColor),S$a.line(S$s[6],S$P._greenColor,S$s[7],S$P._greenColor),S$a.line(S$s[0],S$P._greenColor,S$s[3],S$P._greenColor),S$a.line(S$s[1],S$P._greenColor,S$s[2],S$P._greenColor),S$a.line(S$s[2],S$P._greenColor,S$s[6],S$P._greenColor),S$a.line(S$s[3],S$P._greenColor,S$s[7],S$P._greenColor),S$a.line(S$s[0],S$P._greenColor,S$s[4],S$P._greenColor),S$a.line(S$s[1],S$P._greenColor,S$s[5],S$P._greenColor),S$a.line(S$s[4],S$P._greenColor,S$s[7],S$P._greenColor),S$a.line(S$s[5],S$P._greenColor,S$s[6],S$P._greenColor)},S$m._calculateBoundingSphere=function(){throw"BaseRender: must override it."},S$m._calculateBoundingBox=function(){throw"BaseRender: must override it."},S$m._setShaderValueTexture=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m)},S$m._setShaderValueMatrix4x4=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m?S$m.elements:null)},S$m._setShaderValueColor=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m?S$m.elements:null)},S$m._setShaderValueBuffer=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m)},S$m._setShaderValueInt=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m)},S$m._setShaderValueBool=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m)},S$m._setShaderValueNumber=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m)},S$m._setShaderValueVector2=function(S$a,S$m){this._owner._shaderValues.setValue(S$a,S$m?S$m.elements:null)},S$m._addShaderDefine=function(S$a){this._owner._shaderDefineValue|=S$a},S$m._removeShaderDefine=function(S$a){this._owner._shaderDefineValue&=~S$a},S$m._renderUpdate=function(S$a){return!0},S$m._applyLightMapParams=function(){if(0<=this._lightmapIndex){var S$a=this._owner.scene;if(S$a){var S$m=S$a.getlightmaps()[this._lightmapIndex];S$m?(this._addShaderDefine(S$gm.SAHDERDEFINE_LIGHTMAP),S$m.loaded?this._setShaderValuelightMap(S$m):S$m.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(S$gm.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(S$gm.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(S$gm.SAHDERDEFINE_LIGHTMAP)},S$m._updateOctreeNode=function(){var S$a=this._treeNode;S$a&&this._octreeNodeNeedChange&&(S$a.updateObject(this),this._octreeNodeNeedChange=!1)},S$m._destroy=function(){this.offAll();var S$a=0,S$m=0;for(S$a=0,S$m=this._renderElements.length;S$a<S$m;S$a++)this._renderElements[S$a]._destroy();for(S$a=0,S$m=this._materials.length;S$a<S$m;S$a++)this._materials[S$a]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},S$q(0,S$m,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),S$q(0,S$m,"id",function(){return this._id}),S$q(0,S$m,"material",function(){var S$a=this._materials[0];if(S$a&&!this._materialsInstance[0]){var S$m=this._getInstanceMaterial(S$a,0);this.event("materialchanged",[this,0,S$m])}return this._materials[0]},function(S$a){this.sharedMaterial=S$a}),S$q(0,S$m,"sharedMaterial",function(){return this._materials[0]},function(S$a){var S$m=this._materials[0];S$m!==S$a&&(this._materials[0]=S$a,this._materialsInstance[0]=!1,this._changeMaterialReference(S$m,S$a),this.event("materialchanged",[this,0,S$a]))}),S$q(0,S$m,"lightmapIndex",function(){return this._lightmapIndex},function(S$a){this._lightmapIndex=S$a,this._applyLightMapParams()}),S$q(0,S$m,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(S$a){this._lightmapScaleOffset=S$a,this._setShaderValueColor(2,S$a),this._addShaderDefine(S$gm.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),S$q(0,S$m,"enable",function(){return this._enable},function(S$a){this._enable=S$a,this.event("enablechanged",[this,S$a])}),S$q(0,S$m,"materials",function(){for(var S$a=0,S$m=this._materials.length;S$a<S$m;S$a++)if(!this._materialsInstance[S$a]){var S$s=this._getInstanceMaterial(this._materials[S$a],S$a);this.event("materialchanged",[this,S$a,S$s])}return this._materials.slice()},function(S$a){this.sharedMaterials=S$a}),S$q(0,S$m,"sharedMaterials",function(){return this._materials.slice()},function(S$a){if(!S$a)throw new Error("MeshRender: shadredMaterials value can't be null.");var S$m=S$a.length;this._materialsInstance.length=S$m;for(var S$s=0;S$s<S$m;S$s++){var S$P=this._materials[S$s];S$P!==S$a[S$s]&&(this._materialsInstance[S$s]=!1,this._changeMaterialReference(S$P,S$a[S$s]),this.event("materialchanged",[this,S$s,S$a[S$s]]))}this._materials=S$a}),S$q(0,S$m,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),S$q(0,S$m,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var S$a=this.boundingBox;S$Am.add(S$a.min,S$a.max,this._boundingBoxCenter),S$Am.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),S$q(0,S$m,"receiveShadow",function(){return this._receiveShadow},function(S$a){this._receiveShadow!==S$a&&((this._receiveShadow=S$a)?this._addShaderDefine(S$Qm.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(S$Qm.SHADERDEFINE_RECEIVE_SHADOW))}),S$q(0,S$m,"destroyed",function(){return this._destroyed}),S$P._uniqueIDCounter=0,S$y(S$P,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am,new S$Am]},"_greenColor",function(){return this._greenColor=new S$Bm(0,1,0,1)}]),S$P}(),S$Nm=function(S$a){function S$B(S$a){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,S$B.__super.call(this),this._localPosition=new S$Am,this._localRotation=new S$sm(0,0,0,1),this._localScale=new S$Am(1,1,1),this._localRotationEuler=new S$Am,this._localMatrix=new S$am,this._position=new S$Am,this._rotation=new S$sm(0,0,0,1),this._scale=new S$Am(1,1,1),this._worldMatrix=new S$am,this._forward=new S$Am,this._up=new S$Am,this._right=new S$Am,this._owner=S$a,this._childs=[]}S$Q(S$B,"laya.d3.core.Transform3D",S$e);var S$m=S$B.prototype;return S$m._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)S$am.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var S$a=S$B._tempVector30;S$Am.multiply(this.pivot,this._localScale,S$a);var S$m=S$B._tempVector31;S$Am.subtract(S$a,this.pivot,S$m);var S$s=S$B._tempVector32,S$P=this.localRotation;S$Am.transformQuat(S$a,S$P,S$s),S$Am.subtract(S$s,S$a,S$s);var S$_=S$B._tempVector33;S$Am.subtract(this._localPosition,S$m,S$_),S$Am.subtract(S$_,S$s,S$_),S$am.createAffineTransformation(S$_,S$P,this._localScale,this._localMatrix)}},S$m._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._onWorldPositionRotationTransform()}},S$m._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._onWorldPositionScaleTransform()}},S$m._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._onWorldPositionTransform()}},S$m._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._onWorldPositionRotationTransform()}},S$m._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._onWorldPositionScaleTransform()}},S$m._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._onWorldTransform()}},S$m.translate=function(S$a,S$m){void 0===S$m&&(S$m=!0),S$m?(S$am.createFromQuaternion(this.localRotation,S$B._tempMatrix0),S$Am.transformCoordinate(S$a,S$B._tempMatrix0,S$B._tempVector30),S$Am.add(this.localPosition,S$B._tempVector30,this._localPosition),this.localPosition=this._localPosition):(S$Am.add(this.position,S$a,this._position),this.position=this._position)},S$m.rotate=function(S$a,S$m,S$s){var S$P;void 0===S$m&&(S$m=!0),void 0===S$s&&(S$s=!0),S$P=S$s?S$a:(S$Am.scale(S$a,Math.PI/180,S$B._tempVector30),S$B._tempVector30),S$sm.createFromYawPitchRoll(S$P.y,S$P.x,S$P.z,S$B._tempQuaternion0),S$m?(S$sm.multiply(this._localRotation,S$B._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(S$sm.multiply(S$B._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},S$m.lookAt=function(S$a,S$m,S$s){void 0===S$s&&(S$s=!1);var S$P,S$_=S$a.elements;if(S$s){if(S$P=this._localPosition.elements,Math.abs(S$P[0]-S$_[0])<S$na.zeroTolerance&&Math.abs(S$P[1]-S$_[1])<S$na.zeroTolerance&&Math.abs(S$P[2]-S$_[2])<S$na.zeroTolerance)return;S$sm.lookAt(this._localPosition,S$a,S$m,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var S$e=this.position;if(S$P=S$e.elements,Math.abs(S$P[0]-S$_[0])<S$na.zeroTolerance&&Math.abs(S$P[1]-S$_[1])<S$na.zeroTolerance&&Math.abs(S$P[2]-S$_[2])<S$na.zeroTolerance)return;S$sm.lookAt(S$e,S$a,S$m,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},S$q(0,S$m,"_isFrontFaceInvert",function(){var S$a=this.scale,S$m=S$a.x<0;return S$a.y<0&&(S$m=!S$m),S$a.z<0&&(S$m=!S$m),S$m}),S$q(0,S$m,"owner",function(){return this._owner}),S$q(0,S$m,"localRotation",function(){if(this._localQuaternionUpdate){var S$a=this._localRotationEuler.elements;S$sm.createFromYawPitchRoll(S$a[1]/S$B._angleToRandin,S$a[0]/S$B._angleToRandin,S$a[2]/S$B._angleToRandin,this._localRotation)}return this._localRotation},function(S$a){this._localRotation=S$a,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),S$q(0,S$m,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?S$am.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(S$a){null===this._parent?S$a.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),S$am.multiply(this._localMatrix,S$a,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=S$a,this._worldUpdate=!1}),S$q(0,S$m,"worldNeedUpdate",function(){return this._worldUpdate}),S$q(0,S$m,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(S$a){this._localMatrix=S$a,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),S$q(0,S$m,"dummy",function(){return this._dummy},function(S$a){this._dummy!==S$a&&(this._dummy&&(this._dummy._entity=null),S$a&&(S$a._entity=this),this._dummy=S$a)}),S$q(0,S$m,"localPosition",function(){return this._localPosition},function(S$a){this._localPosition=S$a,this._localUpdate=!0,this._onWorldPositionTransform()}),S$q(0,S$m,"position",function(){if(this._positionUpdate){if(null!=this._parent){var S$a=this._parent.position;S$Am.multiply(this._localPosition,this._parent.scale,S$B._tempVector30),S$Am.transformQuat(S$B._tempVector30,this._parent.rotation,S$B._tempVector30),S$Am.add(S$a,S$B._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(S$a){if(null!=this._parent){S$Am.subtract(S$a,this._parent.position,this._localPosition);var S$m=this._parent.scale.elements,S$s=S$m[0],S$P=S$m[1],S$_=S$m[2];if(1!==S$s||1!==S$P||1!==S$_){var S$e=S$B._tempVector30,S$A=S$e.elements;S$A[0]=1/S$s,S$A[1]=1/S$P,S$A[2]=1/S$_,S$Am.multiply(this._localPosition,S$e,this._localPosition)}this._parent.rotation.invert(S$B._tempQuaternion0),S$Am.transformQuat(this._localPosition,S$B._tempQuaternion0,this._localPosition)}else S$a.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=S$a,this._positionUpdate=!1}),S$q(0,S$m,"localScale",function(){return this._localScale},function(S$a){this._localScale=S$a,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),S$q(0,S$m,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(S$B._tempVector30);var S$a=S$B._tempVector30.elements,S$m=this._localRotationEuler.elements;S$m[0]=S$a[1]*S$B._angleToRandin,S$m[1]=S$a[0]*S$B._angleToRandin,S$m[2]=S$a[2]*S$B._angleToRandin}return this._localRotationEuler},function(S$a){this._localRotationEuler=S$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),S$q(0,S$m,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?S$sm.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(S$a){null!=this._parent?(this._parent.rotation.invert(S$B._tempQuaternion0),S$sm.multiply(S$a,S$B._tempQuaternion0,this._localRotation)):S$a.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=S$a,this._rotationUpdate=!1}),S$q(0,S$m,"scale",function(){return this._scaleUpdate&&(null!==this._parent?S$Am.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(S$a){if(null!==this._parent){var S$m=this._parent.scale.elements,S$s=S$B._tempVector30.elements;S$s[0]=1/S$m[0],S$s[1]=1/S$m[1],S$s[2]=1/S$m[2],S$Am.multiply(S$a,S$B._tempVector30,this._localScale)}else S$a.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=S$a,this._scaleUpdate=!1}),S$q(0,S$m,"rotationEuler",null,function(S$a){S$sm.createFromYawPitchRoll(S$a.y,S$a.x,S$a.z,this._rotation),this.rotation=this._rotation}),S$q(0,S$m,"forward",function(){var S$a=this.worldMatrix.elements;return this._forward.elements[0]=-S$a[8],this._forward.elements[1]=-S$a[9],this._forward.elements[2]=-S$a[10],this._forward}),S$q(0,S$m,"up",function(){var S$a=this.worldMatrix.elements;return this._up.elements[0]=S$a[4],this._up.elements[1]=S$a[5],this._up.elements[2]=S$a[6],this._up}),S$q(0,S$m,"right",function(){var S$a=this.worldMatrix.elements;return this._right.elements[0]=S$a[0],this._right.elements[1]=S$a[1],this._right.elements[2]=S$a[2],this._right}),S$q(0,S$m,"parent",function(){return this._parent},function(S$a){if(this._parent!==S$a){if(this._parent){var S$m=this._parent._childs,S$s=S$m.indexOf(this);S$m.splice(S$s,1)}S$a&&(S$a._childs.push(this),S$a&&this._onWorldTransform()),this._parent=S$a}}),S$y(S$B,["_tempVector30",function(){return this._tempVector30=new S$Am},"_tempVector31",function(){return this._tempVector31=new S$Am},"_tempVector32",function(){return this._tempVector32=new S$Am},"_tempVector33",function(){return this._tempVector33=new S$Am},"_tempQuaternion0",function(){return this._tempQuaternion0=new S$sm},"_tempMatrix0",function(){return this._tempMatrix0=new S$am},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),S$B}(),S$zm=(function(S$a){function S$m(){this._rotation=0,this._matNeedUpdte=!1,S$m.__super.call(this),this._matrix=new S$am,this._offset=new S$em,this._tiling=new S$em(1,1)}S$Q(S$m,"laya.d3.core.TransformUV",S$e);var S$s=S$m.prototype;S$o.imps(S$s,{"laya.d3.core.IClone":!0}),S$s._updateMatrix=function(){S$m._tempOffsetV3.elements[0]=this._offset.x,S$m._tempOffsetV3.elements[1]=this._offset.y,S$sm.createFromYawPitchRoll(0,0,this._rotation,S$m._tempRotationQua),S$m._tempTitlingV3.elements[0]=this._tiling.x,S$m._tempTitlingV3.elements[1]=this._tiling.y,S$am.createAffineTransformation(S$m._tempOffsetV3,S$m._tempRotationQua,S$m._tempTitlingV3,this._matrix)},S$s.cloneTo=function(S$a){S$a._matrix=this._matrix.clone(),S$a._offset=this._offset.clone(),S$a._rotation=this._rotation,S$a._tiling=this._tiling.clone()},S$s.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$s,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),S$q(0,S$s,"tiling",function(){return this._tiling},function(S$a){this._tiling=S$a,this._matNeedUpdte=!0}),S$q(0,S$s,"offset",function(){return this._offset},function(S$a){this._offset=S$a,this._matNeedUpdte=!0}),S$q(0,S$s,"rotation",function(){return this._rotation},function(S$a){this._rotation=S$a,this._matNeedUpdte=!0}),S$y(S$m,["_tempOffsetV3",function(){return this._tempOffsetV3=new S$Am(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new S$sm},"_tempTitlingV3",function(){return this._tempTitlingV3=new S$Am(1,1,1)}])}(),function(S$s){function S$a(){this.x=NaN,this.y=NaN,this.z=NaN,S$a.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}S$Q(S$a,"laya.d3.core.particleShuriKen.module.shape.BoxShape",S$s);var S$m=S$a.prototype;S$m._getShapeBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=.5*-this.x,S$m[1]=.5*-this.y,S$m[2]=.5*-this.z;var S$s=S$a.max.elements;S$s[0]=.5*this.x,S$s[1]=.5*this.y,S$s[2]=.5*this.z},S$m._getSpeedBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=0,S$m[1]=0,S$m[2]=0;var S$s=S$a.max.elements;S$s[0]=0,S$s[1]=1,S$s[2]=0},S$m.generatePositionAndDirection=function(S$a,S$m,S$s,S$P){var S$_=S$a.elements,S$e=S$m.elements;S$s?(S$s.seed=S$P[16],S$J._randomPointInsideHalfUnitBox(S$a,S$s),S$P[16]=S$s.seed):S$J._randomPointInsideHalfUnitBox(S$a),S$_[0]=this.x*S$_[0],S$_[1]=this.y*S$_[1],S$_[2]=this.z*S$_[2],this.randomDirection?S$s?(S$s.seed=S$P[17],S$J._randomPointUnitSphere(S$m,S$s),S$P[17]=S$s.seed):S$J._randomPointUnitSphere(S$m):(S$e[0]=0,S$e[1]=0,S$e[2]=1)},S$m.cloneTo=function(S$a){S$s.prototype.cloneTo.call(this,S$a);var S$m=S$a;S$m.x=this.x,S$m.y=this.y,S$m.z=this.z,S$m.randomDirection=this.randomDirection}}(S$L),function(S$s){function S$A(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,S$A.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}S$Q(S$A,"laya.d3.core.particleShuriKen.module.shape.CircleShape",S$s);var S$a=S$A.prototype;S$a._getShapeBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=S$m[2]=-this.radius,S$m[1]=0;var S$s=S$a.max.elements;S$s[0]=S$s[2]=this.radius,S$s[1]=0},S$a._getSpeedBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=S$m[1]=-1,S$m[2]=0;var S$s=S$a.max.elements;S$s[0]=S$s[1]=1,S$s[2]=0},S$a.generatePositionAndDirection=function(S$a,S$m,S$s,S$P){var S$_=S$a.elements,S$e=S$A._tempPositionPoint.elements;S$s?(S$s.seed=S$P[16],this.emitFromEdge?S$J._randomPointUnitArcCircle(this.arc,S$A._tempPositionPoint,S$s):S$J._randomPointInsideUnitArcCircle(this.arc,S$A._tempPositionPoint,S$s),S$P[16]=S$s.seed):this.emitFromEdge?S$J._randomPointUnitArcCircle(this.arc,S$A._tempPositionPoint):S$J._randomPointInsideUnitArcCircle(this.arc,S$A._tempPositionPoint),S$_[0]=-S$e[0],S$_[1]=S$e[1],S$_[2]=0,S$Am.scale(S$a,this.radius,S$a),this.randomDirection?S$s?(S$s.seed=S$P[17],S$J._randomPointUnitSphere(S$m,S$s),S$P[17]=S$s.seed):S$J._randomPointUnitSphere(S$m):S$a.cloneTo(S$m)},S$a.cloneTo=function(S$a){S$s.prototype.cloneTo.call(this,S$a);var S$m=S$a;S$m.radius=this.radius,S$m.arc=this.arc,S$m.emitFromEdge=this.emitFromEdge,S$m.randomDirection=this.randomDirection},S$y(S$A,["_tempPositionPoint",function(){return this._tempPositionPoint=new S$em}])}(S$L),function(S$s){function S$d(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,S$d.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}S$Q(S$d,"laya.d3.core.particleShuriKen.module.shape.ConeShape",S$s);var S$a=S$d.prototype;S$a._getShapeBoundBox=function(S$a){var S$m=this.radius+this.length*Math.sin(this.angle),S$s=this.length*Math.cos(this.angle),S$P=S$a.min.elements;S$P[0]=S$P[1]=-S$m,S$P[2]=0;var S$_=S$a.max.elements;S$_[0]=S$_[1]=S$m,S$_[2]=S$s},S$a._getSpeedBoundBox=function(S$a){var S$m=Math.sin(this.angle),S$s=S$a.min.elements;S$s[0]=S$s[1]=-S$m,S$s[2]=0;var S$P=S$a.max.elements;S$P[0]=S$s[1]=S$m,S$P[2]=1},S$a.generatePositionAndDirection=function(S$a,S$m,S$s,S$P){var S$_,S$e=S$a.elements,S$A=S$m.elements,S$B=S$d._tempPositionPoint.elements,S$k=NaN,S$j=NaN,S$G=Math.cos(this.angle),S$y=Math.sin(this.angle);switch(this.emitType){case 0:S$s?(S$s.seed=S$P[16],S$J._randomPointInsideUnitCircle(S$d._tempPositionPoint,S$s),S$P[16]=S$s.seed):S$J._randomPointInsideUnitCircle(S$d._tempPositionPoint),S$k=S$B[0],S$j=S$B[1],S$e[0]=S$k*this.radius,S$e[1]=S$j*this.radius,S$e[2]=0,this.randomDirection?(S$s?(S$s.seed=S$P[17],S$J._randomPointInsideUnitCircle(S$d._tempDirectionPoint,S$s),S$P[17]=S$s.seed):S$J._randomPointInsideUnitCircle(S$d._tempDirectionPoint),S$_=S$d._tempDirectionPoint.elements,S$A[0]=S$_[0]*S$y,S$A[1]=S$_[1]*S$y):(S$A[0]=S$k*S$y,S$A[1]=S$j*S$y),S$A[2]=S$G;break;case 1:S$s?(S$s.seed=S$P[16],S$J._randomPointUnitCircle(S$d._tempPositionPoint,S$s),S$P[16]=S$s.seed):S$J._randomPointUnitCircle(S$d._tempPositionPoint),S$k=S$B[0],S$j=S$B[1],S$e[0]=S$k*this.radius,S$e[1]=S$j*this.radius,S$e[2]=0,this.randomDirection?(S$s?(S$s.seed=S$P[17],S$J._randomPointInsideUnitCircle(S$d._tempDirectionPoint,S$s),S$P[17]=S$s.seed):S$J._randomPointInsideUnitCircle(S$d._tempDirectionPoint),S$_=S$d._tempDirectionPoint.elements,S$A[0]=S$_[0]*S$y,S$A[1]=S$_[1]*S$y):(S$A[0]=S$k*S$y,S$A[1]=S$j*S$y),S$A[2]=S$G;break;case 2:S$s?(S$s.seed=S$P[16],S$J._randomPointInsideUnitCircle(S$d._tempPositionPoint,S$s)):S$J._randomPointInsideUnitCircle(S$d._tempPositionPoint),S$k=S$B[0],S$j=S$B[1],S$e[0]=S$k*this.radius,S$e[1]=S$j*this.radius,S$A[S$e[2]=0]=S$k*S$y,S$A[1]=S$j*S$y,S$A[2]=S$G,S$Am.normalize(S$m,S$m),S$s?(S$Am.scale(S$m,this.length*S$s.getFloat(),S$m),S$P[16]=S$s.seed):S$Am.scale(S$m,this.length*Math.random(),S$m),S$Am.add(S$a,S$m,S$a),this.randomDirection&&(S$s?(S$s.seed=S$P[17],S$J._randomPointUnitSphere(S$m,S$s),S$P[17]=S$s.seed):S$J._randomPointUnitSphere(S$m));break;case 3:S$s?(S$s.seed=S$P[16],S$J._randomPointUnitCircle(S$d._tempPositionPoint,S$s)):S$J._randomPointUnitCircle(S$d._tempPositionPoint),S$k=S$B[0],S$j=S$B[1],S$e[0]=S$k*this.radius,S$e[1]=S$j*this.radius,S$A[S$e[2]=0]=S$k*S$y,S$A[1]=S$j*S$y,S$A[2]=S$G,S$Am.normalize(S$m,S$m),S$s?(S$Am.scale(S$m,this.length*S$s.getFloat(),S$m),S$P[16]=S$s.seed):S$Am.scale(S$m,this.length*Math.random(),S$m),S$Am.add(S$a,S$m,S$a),this.randomDirection&&(S$s?(S$s.seed=S$P[17],S$J._randomPointUnitSphere(S$m,S$s),S$P[17]=S$s.seed):S$J._randomPointUnitSphere(S$m));break;default:throw new Error("ConeShape:emitType is invalid.")}},S$a.cloneTo=function(S$a){S$s.prototype.cloneTo.call(this,S$a);var S$m=S$a;S$m.angle=this.angle,S$m.radius=this.radius,S$m.length=this.length,S$m.emitType=this.emitType,S$m.randomDirection=this.randomDirection},S$y(S$d,["_tempPositionPoint",function(){return this._tempPositionPoint=new S$em},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new S$em}])}(S$L),function(S$s){function S$a(){this.radius=NaN,this.emitFromShell=!1,S$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}S$Q(S$a,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",S$s);var S$m=S$a.prototype;S$m._getShapeBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=S$m[1]=S$m[2]=-this.radius;var S$s=S$a.max.elements;S$s[0]=S$s[1]=this.radius,S$s[2]=0},S$m._getSpeedBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=S$m[1]=-1,S$m[2]=0;var S$s=S$a.max.elements;S$s[0]=S$s[1]=S$s[2]=1},S$m.generatePositionAndDirection=function(S$a,S$m,S$s,S$P){var S$_=S$a.elements;S$s?(S$s.seed=S$P[16],this.emitFromShell?S$J._randomPointUnitSphere(S$a,S$s):S$J._randomPointInsideUnitSphere(S$a,S$s),S$P[16]=S$s.seed):this.emitFromShell?S$J._randomPointUnitSphere(S$a):S$J._randomPointInsideUnitSphere(S$a),S$Am.scale(S$a,this.radius,S$a);var S$e=S$_[2];S$e<0&&(S$_[2]=-1*S$e),this.randomDirection?S$s?(S$s.seed=S$P[17],S$J._randomPointUnitSphere(S$m,S$s),S$P[17]=S$s.seed):S$J._randomPointUnitSphere(S$m):S$a.cloneTo(S$m)},S$m.cloneTo=function(S$a){S$s.prototype.cloneTo.call(this,S$a);var S$m=S$a;S$m.radius=this.radius,S$m.emitFromShell=this.emitFromShell,S$m.randomDirection=this.randomDirection}}(S$L),function(S$s){function S$a(){this.radius=NaN,this.emitFromShell=!1,S$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}S$Q(S$a,"laya.d3.core.particleShuriKen.module.shape.SphereShape",S$s);var S$m=S$a.prototype;S$m._getShapeBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=S$m[1]=S$m[2]=-this.radius;var S$s=S$a.max.elements;S$s[0]=S$s[1]=S$s[2]=this.radius},S$m._getSpeedBoundBox=function(S$a){var S$m=S$a.min.elements;S$m[0]=S$m[1]=S$m[2]=-1;var S$s=S$a.max.elements;S$s[0]=S$s[1]=S$s[2]=1},S$m.generatePositionAndDirection=function(S$a,S$m,S$s,S$P){S$s?(S$s.seed=S$P[16],this.emitFromShell?S$J._randomPointUnitSphere(S$a,S$s):S$J._randomPointInsideUnitSphere(S$a,S$s),S$P[16]=S$s.seed):this.emitFromShell?S$J._randomPointUnitSphere(S$a):S$J._randomPointInsideUnitSphere(S$a),S$Am.scale(S$a,this.radius,S$a),this.randomDirection?S$s?(S$s.seed=S$P[17],S$J._randomPointUnitSphere(S$m,S$s),S$P[17]=S$s.seed):S$J._randomPointUnitSphere(S$m):S$a.cloneTo(S$m)},S$m.cloneTo=function(S$a){S$s.prototype.cloneTo.call(this,S$a);var S$m=S$a;S$m.radius=this.radius,S$m.emitFromShell=this.emitFromShell,S$m.randomDirection=this.randomDirection}}(S$L),function(S$a){function S$m(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,S$m.__super.call(this)}return S$Q(S$m,"laya.d3.core.render.SubMeshRenderElement",S$w),S$m}()),S$Um=function(S$a){function S$u(S$a,S$m,S$s,S$P,S$_,S$e){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=S$a,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[S$Qm.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[S$gm.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[S$gm.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[S$Km.SHADERDEFINE_ALPHATEST]="ALPHATEST";S$u.__super.call(this,S$a,S$m,S$s,null,{}),this._attributeMap=S$P;var S$A;for(S$A in S$_){var S$B=S$_[S$A];switch(S$B[1]){case 0:this._renderElementUniformMap[S$A]=S$B[0];break;case 1:this._materialUniformMap[S$A]=S$B[0];break;case 2:this._spriteUniformMap[S$A]=S$B[0];break;case 3:this._cameraUniformMap[S$A]=S$B[0];break;case 4:this._sceneUniformMap[S$A]=S$B[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}S$Q(S$u,"laya.d3.shader.ShaderCompile3D",S$c);var S$m=S$u.prototype;return S$m._definesToNameDic=function(S$a,S$m){for(var S$s={},S$P=1,S$_=0;S$_<32&&!(S$a<(S$P=1<<S$_));S$_++)if(S$a&S$P){var S$e=S$m[S$P];S$e&&(S$s[S$e]="")}return S$s},S$m.withCompile=function(S$a,S$m,S$s,S$P){var S$_,S$e,S$A;if(S$e=this.sharders[S$a])if(S$A=S$e[S$m]){if(S$_=S$A[S$s])return S$_}else S$A=S$e[S$m]=[];else S$A=(S$e=this.sharders[S$a]=[])[S$m]=[];var S$B,S$k=this._definesToNameDic(S$a,S$u._globalInt2name),S$j=this._definesToNameDic(S$m,this._spriteInt2name),S$G=this._definesToNameDic(S$s,this._materialInt2name),S$y={},S$d="";if(S$k)for(S$B in S$k)S$d+="#define "+S$B+"\n",S$y[S$B]=!0;if(S$j)for(S$B in S$j)S$d+="#define "+S$B+"\n",S$y[S$B]=!0;if(S$G)for(S$B in S$G)S$d+="#define "+S$B+"\n",S$y[S$B]=!0;var S$Q=S$Em.nameKey.getName(this._name)+" compile ("+S$a+","+S$m+","+S$s+")",S$q=this._VS.toscript(S$y,[]),S$h=this._PS.toscript(S$y,[]);S$b.now();if(S$_=S$Em.create(S$d+S$q.join("\n"),S$d+S$h.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,S$P,S$Q),S$A[S$s]=S$_,laya.d3.shader.ShaderCompile3D.debugMode)S$b.now();return S$_},S$m.precompileShaderWithShaderDefine=function(S$a,S$m,S$s){this.withCompile(S$a,S$m,S$s,!0)},S$m.addMaterialDefines=function(S$a){var S$m=S$a.defines;for(var S$s in S$m){var S$P=S$m[S$s],S$_=parseInt(S$s);this._materialInt2name[S$_]=S$P,this._materialName2Int[S$P]=S$_}},S$m.addSpriteDefines=function(S$a){var S$m=S$a.defines;for(var S$s in S$m){var S$P=S$m[S$s],S$_=parseInt(S$s);this._spriteInt2name[S$_]=S$P,this._spriteName2Int[S$P]=S$_}},S$m.getMaterialDefineByName=function(S$a){return this._materialName2Int[S$a]},S$m.registerMaterialDefine=function(S$a){var S$m=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[S$m]=S$a,this._materialName2Int[S$a]=S$m},S$m.registerSpriteDefine=function(S$a){var S$m=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[S$m]=S$a,this._spriteName2Int[S$a]=S$m},S$u._globalRegDefine=function(S$a,S$m){S$u._globalInt2name[S$m]=S$a},S$u.add=function(S$a,S$m,S$s,S$P,S$_){return laya.d3.shader.ShaderCompile3D._preCompileShader[S$a]=new S$u(S$a,S$m,S$s,S$P,S$_,S$c.includes)},S$u.get=function(S$a){return laya.d3.shader.ShaderCompile3D._preCompileShader[S$Em.nameKey.getID(S$a)]},S$u._preCompileShader={},S$u._globalInt2name=[],S$u.debugMode=!1,S$u.SHADERDEFINE_HIGHPRECISION=1,S$u.SHADERDEFINE_FOG=4,S$u.SHADERDEFINE_DIRECTIONLIGHT=8,S$u.SHADERDEFINE_POINTLIGHT=16,S$u.SHADERDEFINE_SPOTLIGHT=32,S$u.SHADERDEFINE_UV0=64,S$u.SHADERDEFINE_COLOR=128,S$u.SHADERDEFINE_UV1=256,S$u.SAHDERDEFINE_DEPTHFOG=131072,S$u}(),S$lm=function(S$a){function S$q(){S$q.__super.call(this)}S$Q(S$q,"laya.d3.graphics.MeshSprite3DStaticBatchManager",S$Pa);var S$m=S$q.prototype;return S$m._getStaticBatch=function(S$a,S$m,S$s,S$P){var S$_,S$e;return S$e=S$a?S$a.id.toString()+S$s.id.toString()+S$m.id.toString()+S$P.toString():S$s.id.toString()+S$m.id.toString()+S$P.toString(),this._staticBatches[S$e]?S$_=this._staticBatches[S$e]:this._staticBatches[S$e]=S$_=new S$Cm(S$e,this,S$a,S$m,S$s),S$_},S$m._initStaticBatchs=function(S$a){var S$m,S$s;this._initBatchRenderElements.sort(S$q._sortPrepareStaticBatch);for(var S$P,S$_=!1,S$e=0,S$A=0,S$B=this._initBatchRenderElements.length;S$A<S$B;S$A++){var S$k,S$j=this._initBatchRenderElements[S$A],S$G=S$j.renderObj._getVertexBuffer(0);S$j._sprite3D;if(S$s===S$G.vertexDeclaration&&S$m===S$j._material)if(S$_)S$P._addCombineBatchRenderObjTest(S$j)?(S$k=S$j._staticBatch)!==S$P&&(S$k&&S$k._deleteCombineBatchRenderObj(S$j),S$P._addCombineBatchRenderObj(S$j)):(S$_=!1,S$e++);else{var S$y=this._initBatchRenderElements[S$A-1],S$d=S$y.renderObj,S$Q=S$j.renderObj;S$_=!(65535<S$d._getVertexBuffer().vertexCount+S$Q._getVertexBuffer().vertexCount)&&(S$P=this._getStaticBatch(S$a,S$s,S$m,S$e),(S$k=S$y._staticBatch)!==S$P&&(S$k&&S$k._deleteCombineBatchRenderObj(S$y),S$P._addCombineBatchRenderObj(S$y)),(S$k=S$j._staticBatch)!==S$P&&(S$k&&S$k._deleteCombineBatchRenderObj(S$j),S$P._addCombineBatchRenderObj(S$j)),!0)}else S$_=!1,S$e=0;S$m=S$j._material,S$s=S$G.vertexDeclaration}},S$q._sortPrepareStaticBatch=function(S$a,S$m){var S$s=S$a._render,S$P=S$m._render,S$_=S$s.lightmapIndex-S$P.lightmapIndex;if(0!=S$_)return S$_;var S$e=S$s.receiveShadow-S$P.receiveShadow;if(0!=S$e)return S$e;var S$A=S$a._mainSortID-S$m._mainSortID;return 0==S$A?S$a.renderObj.triangleCount-S$m.renderObj.triangleCount:S$A},S$q}(),S$Cm=function(S$a){function S$e(S$a,S$m,S$s,S$P,S$_){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,S$e.__super.call(this,S$a,S$m,S$s),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=S$P,this._material=S$_}S$Q(S$e,"laya.d3.graphics.SubMeshStaticBatch",S$_a);var S$m=S$e.prototype;return S$m._compareBatchRenderElement=function(S$a,S$m){return S$a._batchIndexStart>S$m._batchIndexStart},S$m._addCombineBatchRenderObjTest=function(S$a){var S$m=S$a.renderObj._vertexCount;return!(65535<(0<S$m?this._currentCombineVertexCount+S$m:this._currentCombineVertexCount+S$a.renderObj._getVertexBuffer().vertexCount))},S$m._addCombineBatchRenderObj=function(S$a){var S$m=S$a.renderObj,S$s=S$m._vertexCount;this._initBatchRenderElements.push(S$a),S$a._staticBatch=this,0<S$s?(this._currentCombineIndexCount+=S$m._indexCount,this._currentCombineVertexCount+=S$s):(this._currentCombineIndexCount=this._currentCombineIndexCount+S$m._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+S$m._getVertexBuffer().vertexCount),this._needFinishCombine=!0},S$m._deleteCombineBatchRenderObj=function(S$a){var S$m=S$a.renderObj,S$s=this._initBatchRenderElements.indexOf(S$a);if(-1!==S$s){this._initBatchRenderElements.splice(S$s,1),S$a._staticBatch=null;var S$P=S$m._vertexCount;0<S$P?(this._currentCombineIndexCount=this._currentCombineIndexCount-S$m._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-S$P):(this._currentCombineIndexCount=this._currentCombineIndexCount-S$m._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-S$m._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},S$m._finishInit=function(){if(this._needFinishCombine){var S$a=0,S$m=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var S$s=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),S$P=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=S$Lm.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=S$tm.create("ushort",this._currentCombineIndexCount,35044);for(var S$_=0,S$e=this._initBatchRenderElements.length;S$_<S$e;S$_++){var S$A=this._initBatchRenderElements[S$_],S$B=S$A.renderObj,S$k=S$B._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,S$A._sprite3D),S$j=S$B.getIndices(),S$G=S$A._sprite3D.transform._isFrontFaceInvert,S$y=S$a/(this._vertexDeclaration.vertexStride/4)-S$B._vertexStart,S$d=S$m,S$Q=S$d+S$j.length;S$A._batchIndexStart=S$d,S$A._batchIndexEnd=S$Q,S$P.set(S$j,S$m);var S$q=0;if(S$G)for(S$q=S$d;S$q<S$Q;S$q+=3){S$P[S$q]=S$y+S$P[S$q];var S$h=S$P[S$q+1],S$u=S$P[S$q+2];S$P[S$q+1]=S$y+S$u,S$P[S$q+2]=S$y+S$h}else for(S$q=S$d;S$q<S$Q;S$q+=3)S$P[S$q]=S$y+S$P[S$q],S$P[S$q+1]=S$y+S$P[S$q+1],S$P[S$q+2]=S$y+S$P[S$q+2];S$m+=S$j.length,S$s.set(S$k,S$a),S$a+=S$k.length}this._vertexBuffer.setData(S$s),this._indexBuffer.setData(S$P),this._needFinishCombine=!1}},S$m._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new S$zm)},S$m._getRenderElement=function(S$a,S$m,S$s){for(var S$P,S$_,S$e=this._batchRenderElements.length,S$A=!0,S$B=0;S$B<S$e;S$B++){var S$k,S$j,S$G=(S$_=this._batchRenderElements[S$B])._sprite3D._render;if(0!==S$B&&(S$A=(S$k=(S$P=this._batchRenderElements[S$B-1])._sprite3D._render).lightmapIndex!==S$G.lightmapIndex||S$k.receiveShadow!==S$G.receiveShadow||S$P._batchIndexEnd!==S$_._batchIndexStart),S$A){(S$j=this._getCombineRenderElementFromPool()).renderObj=this,S$j._material=this._material,S$j._batchIndexStart=S$_._batchIndexStart,S$j._batchIndexEnd=S$_._batchIndexEnd;var S$y=S$G.lightmapIndex,S$d=S$y+1,S$Q=this._batchOwnerIndices[S$d];S$Q||(S$Q=this._batchOwnerIndices[S$d]=[]);var S$q,S$h=S$Q[S$_._render.receiveShadow?1:0];void 0===S$h?(S$Q[S$G.receiveShadow?1:0]=this._batchOwners.length,(S$q=new S$vm(null,"StaticBatchMeshSprite3D"))._scene=S$m,S$q._transform=this._rootOwner?this._rootOwner._transform:null,S$q._render.lightmapIndex=S$y,S$q._render.receiveShadow=S$_._render.receiveShadow,this._batchOwners.push(S$q)):S$q=this._batchOwners[S$h],S$q._render._renderUpdate(S$s),S$j._sprite3D=S$q,S$a.push(S$j)}else S$j._batchIndexEnd=S$_._batchIndexEnd}},S$m._beforeRender=function(S$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},S$m._render=function(S$a){var S$m=S$a.renderElement,S$s=S$m._batchIndexStart,S$P=S$m._batchIndexEnd-S$s;S$V.mainContext.drawElements(4,S$P,5123,2*S$s),S$U.drawCall++,S$U.trianglesFaces+=S$P/3},S$m.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},S$m._getVertexBuffer=function(S$a){return void 0===S$a&&(S$a=0),this._vertexBuffer},S$e}(),S$fm=function(S$a){function S$m(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,S$m.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}S$Q(S$m,"laya.d3.core.ComponentNode",S$j);var S$s=S$m.prototype;return S$s.addComponent=function(S$a){var S$m,S$s=this._componentsMap.indexOf(S$a);if(-1===S$s)S$m=[],this._componentsMap.push(S$a),this._typeComponentsIndices.push(S$m);else if(S$m=this._typeComponentsIndices[S$s],this._components[S$m[0]].isSingleton)throw new Error("无法单实例创建"+S$a+"组件，"+S$a+"组件已存在！");var S$P=S$_.getInstance(S$a);return S$m.push(this._components.length),this._components.push(S$P),S$P instanceof laya.d3.component.Script&&this._scripts.push(S$P),S$P._initialize(this),S$P},S$s._removeComponent=function(S$a,S$m){var S$s=this._typeComponentsIndices[S$a],S$P=S$s[S$m],S$_=this._components[S$P];this._components.splice(S$P,1),S$_ instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(S$_),1),S$s.splice(S$m,1),0===S$s.length&&(this._typeComponentsIndices.splice(S$a,1),this._componentsMap.splice(S$a,1));for(var S$e=0,S$A=this._componentsMap.length;S$e<S$A;S$e++)for(var S$B=(S$s=this._typeComponentsIndices[S$e]).length-1;0<=S$B;S$B--){var S$k=S$s[S$B];if(!(S$P<S$k))break;S$s[S$B]=--S$k}S$_._destroy()},S$s.getComponentByType=function(S$a,S$m){void 0===S$m&&(S$m=0);var S$s=this._componentsMap.indexOf(S$a);return-1===S$s?null:this._components[this._typeComponentsIndices[S$s][S$m]]},S$s.getComponentsByType=function(S$a,S$m){var S$s=this._componentsMap.indexOf(S$a);if(-1!==S$s){var S$P=this._typeComponentsIndices[S$s],S$_=S$P.length;S$m.length=S$_;for(var S$e=0;S$e<S$_;S$e++)S$m[S$e]=this._components[S$P[S$e]]}else S$m.length=0},S$s.getComponentByIndex=function(S$a){return this._components[S$a]},S$s.removeComponentByType=function(S$a,S$m){void 0===S$m&&(S$m=0);var S$s=this._componentsMap.indexOf(S$a);-1!==S$s&&this._removeComponent(S$s,S$m)},S$s.removeComponentsByType=function(S$a){var S$m=this._componentsMap.indexOf(S$a);if(-1!==S$m)for(var S$s=this._typeComponentsIndices[S$m],S$P=0,S$_=S$s.length;S$P<S$_;S$s.length<S$_?S$_--:S$P++)this._removeComponent(S$m,S$P)},S$s.removeAllComponent=function(){for(var S$a=0,S$m=this._componentsMap.length;S$a<S$m;this._componentsMap.length<S$m?S$m--:S$a++)this.removeComponentsByType(this._componentsMap[S$a])},S$s._updateComponents=function(S$a){for(var S$m=0,S$s=this._components.length;S$m<S$s;S$m++){var S$P=this._components[S$m];!S$P.started&&(S$P._start(S$a),S$P.started=!0),S$P.enable&&S$P._update(S$a)}},S$s._lateUpdateComponents=function(S$a){for(var S$m=0;S$m<this._components.length;S$m++){var S$s=this._components[S$m];!S$s.started&&(S$s._start(S$a),S$s.started=!0),S$s.enable&&S$s._lateUpdate(S$a)}},S$s._preRenderUpdateComponents=function(S$a){for(var S$m=0;S$m<this._components.length;S$m++){var S$s=this._components[S$m];!S$s.started&&(S$s._start(S$a),S$s.started=!0),S$s.enable&&S$s._preRenderUpdate(S$a)}},S$s._postRenderUpdateComponents=function(S$a){for(var S$m=0;S$m<this._components.length;S$m++){var S$s=this._components[S$m];!S$s.started&&(S$s._start(S$a),S$s.started=!0),S$s.enable&&S$s._postRenderUpdate(S$a)}},S$m}(),S$Km=function(S$P){function S$a(){S$a.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new S$dm,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new S$Bm(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}S$Q(S$a,"laya.d3.core.material.BaseMaterial",S$P);var S$m=S$a.prototype;return S$o.imps(S$m,{"laya.d3.core.IClone":!0}),S$m._addShaderDefine=function(S$a){this._shaderDefineValue|=S$a},S$m._removeShaderDefine=function(S$a){this._shaderDefineValue&=~S$a},S$m._addDisablePublicShaderDefine=function(S$a){this._disablePublicShaderDefine|=S$a},S$m._removeDisablePublicShaderDefine=function(S$a){this._disablePublicShaderDefine&=~S$a},S$m._setBuffer=function(S$a,S$m){this._shaderValues.setValue(S$a,S$m),this._values[S$a]=S$m},S$m._getBuffer=function(S$a){return this._values[S$a]},S$m._setMatrix4x4=function(S$a,S$m){this._shaderValues.setValue(S$a,S$m?S$m.elements:null),this._values[S$a]=S$m},S$m._getMatrix4x4=function(S$a){return this._values[S$a]},S$m._setInt=function(S$a,S$m){this._shaderValues.setValue(S$a,S$m),this._values[S$a]=S$m},S$m._getInt=function(S$a){return this._values[S$a]},S$m._setNumber=function(S$a,S$m){this._shaderValues.setValue(S$a,S$m),this._values[S$a]=S$m},S$m._getNumber=function(S$a){return this._values[S$a]},S$m._setBool=function(S$a,S$m){this._shaderValues.setValue(S$a,S$m),this._values[S$a]=S$m},S$m._getBool=function(S$a){return this._values[S$a]},S$m._setVector2=function(S$a,S$m){this._shaderValues.setValue(S$a,S$m?S$m.elements:null),this._values[S$a]=S$m},S$m._getVector2=function(S$a){return this._values[S$a]},S$m._setColor=function(S$a,S$m){this._shaderValues.setValue(S$a,S$m?S$m.elements:null),this._values[S$a]=S$m},S$m._getColor=function(S$a){return this._values[S$a]},S$m._setTexture=function(S$a,S$m){var S$s=this._values[S$a];this._values[S$a]=S$m,this._shaderValues.setValue(S$a,S$m),0<this.referenceCount&&(S$s&&S$s._removeReference(),S$m&&S$m._addReference())},S$m._getTexture=function(S$a){return this._values[S$a]},S$m._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},S$m._getShader=function(S$a,S$m,S$s){var S$P=(S$a|S$m)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(S$P,S$s,this._shaderDefineValue),this._shader},S$m._setRenderStateBlendDepth=function(){var S$a=S$V.mainContext;switch(S$W.setDepthMask(S$a,this.depthWrite),0===this.depthTest?S$W.setDepthTest(S$a,!1):(S$W.setDepthTest(S$a,!0),S$W.setDepthFunc(S$a,this.depthTest)),this.blend){case 0:S$W.setBlend(S$a,!1);break;case 1:S$W.setBlend(S$a,!0),S$W.setBlendFunc(S$a,this.srcBlend,this.dstBlend);break;case 2:S$W.setBlend(S$a,!0)}},S$m._setRenderStateFrontFace=function(S$a,S$m){var S$s=S$V.mainContext,S$P=0;switch(this.cull){case 0:S$W.setCullFace(S$s,!1);break;case 1:S$W.setCullFace(S$s,!0),S$P=S$a?S$m&&S$m._isFrontFaceInvert?2305:2304:S$m&&S$m._isFrontFaceInvert?2304:2305,S$W.setFrontFace(S$s,S$P);break;case 2:S$W.setCullFace(S$s,!0),S$P=S$a?S$m&&S$m._isFrontFaceInvert?2304:2305:S$m&&S$m._isFrontFaceInvert?2305:2304,S$W.setFrontFace(S$s,S$P)}},S$m.onAsynLoaded=function(S$a,S$m,S$s){var S$P=S$m[0],S$_=S$m[1];switch(S$P.version){case"LAYAMATERIAL:01":var S$e=0,S$A=0,S$B=S$P.props;for(var S$k in S$B)switch(S$k){case"vectors":var S$j=S$B[S$k];for(S$e=0,S$A=S$j.length;S$e<S$A;S$e++){var S$G=S$j[S$e],S$y=S$G.value;switch(S$y.length){case 2:this[S$G.name]=new S$em(S$y[0],S$y[1]);break;case 3:this[S$G.name]=new S$Am(S$y[0],S$y[1],S$y[2]);break;case 4:this[S$G.name]=new S$Bm(S$y[0],S$y[1],S$y[2],S$y[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var S$d=S$B[S$k];for(S$e=0,S$A=S$d.length;S$e<S$A;S$e++){var S$Q=S$d[S$e],S$q=S$Q.path;S$q&&(this[S$Q.name]=S$O.getRes(S$_[S$q]))}break;case"defines":var S$h=S$B[S$k];for(S$e=0,S$A=S$h.length;S$e<S$A;S$e++){var S$u=this._shaderCompile.getMaterialDefineByName(S$h[S$e]);this._addShaderDefine(S$u)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[S$k]=S$B[S$k];break;case"renderQueue":switch(S$B[S$k]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[S$k]=S$B[S$k]}break;case"LAYAMATERIAL:02":for(S$k in S$B=S$P.props)switch(S$k){case"vectors":for(S$e=0,S$A=(S$j=S$B[S$k]).length;S$e<S$A;S$e++)switch((S$y=(S$G=S$j[S$e]).value).length){case 2:this[S$G.name]=new S$em(S$y[0],S$y[1]);break;case 3:this[S$G.name]=new S$Am(S$y[0],S$y[1],S$y[2]);break;case 4:this[S$G.name]=new S$Bm(S$y[0],S$y[1],S$y[2],S$y[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(S$e=0,S$A=(S$d=S$B[S$k]).length;S$e<S$A;S$e++)(S$q=(S$Q=S$d[S$e]).path)&&(this[S$Q.name]=S$O.getRes(S$_[S$q]));break;case"defines":for(S$e=0,S$A=(S$h=S$B[S$k]).length;S$e<S$A;S$e++)S$u=this._shaderCompile.getMaterialDefineByName(S$h[S$e]),this._addShaderDefine(S$u);break;default:this[S$k]=S$B[S$k]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},S$m._addReference=function(){S$P.prototype._addReference.call(this);for(var S$a=0,S$m=this._values.length;S$a<S$m;S$a++){var S$s=this._values[S$a];S$s&&S$s instanceof laya.d3.resource.BaseTexture&&S$s._addReference()}},S$m._removeReference=function(){S$P.prototype._removeReference.call(this);for(var S$a=0,S$m=this._values.length;S$a<S$m;S$a++){var S$s=this._values[S$a];S$s&&S$s instanceof laya.d3.resource.BaseTexture&&S$s._removeReference()}},S$m.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},S$m.setShaderName=function(S$a){var S$m=S$Em.nameKey.getID(S$a);if(-1===S$m)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=S$Um._preCompileShader[S$m]},S$m.cloneTo=function(S$a){var S$m=S$a;S$m.name=this.name,S$m.cull=this.cull,S$m.blend=this.blend,S$m.srcBlend=this.srcBlend,S$m.dstBlend=this.dstBlend,S$m.srcBlendRGB=this.srcBlendRGB,S$m.dstBlendRGB=this.dstBlendRGB,S$m.srcBlendAlpha=this.srcBlendAlpha,S$m.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(S$m.blendConstColor),S$m.blendEquation=this.blendEquation,S$m.blendEquationRGB=this.blendEquationRGB,S$m.blendEquationAlpha=this.blendEquationAlpha,S$m.depthTest=this.depthTest,S$m.depthWrite=this.depthWrite,S$m.renderQueue=this.renderQueue,S$m._shader=this._shader,S$m._disablePublicShaderDefine=this._disablePublicShaderDefine,S$m._shaderDefineValue=this._shaderDefineValue;var S$s,S$P=0,S$_=S$m._shaderValues;S$m._shaderValues.data.length=this._shaderValues.data.length;var S$e=this._values.length,S$A=S$m._values;for(S$P=0,S$s=S$A.length=S$e;S$P<S$s;S$P++){var S$B=this._values[S$P];if(S$B)if("number"==typeof S$B)S$A[S$P]=S$B,S$_.data[S$P]=S$B;else if("number"==typeof S$B&&Math.floor(S$B)==S$B)S$A[S$P]=S$B,S$_.data[S$P]=S$B;else if("boolean"==typeof S$B)S$A[S$P]=S$B,S$_.data[S$P]=S$B;else if(S$B instanceof laya.d3.math.Vector2){var S$k=S$A[S$P]||(S$A[S$P]=new S$em);S$B.cloneTo(S$k),S$_.data[S$P]=S$k.elements}else if(S$B instanceof laya.d3.math.Vector3){var S$j=S$A[S$P]||(S$A[S$P]=new S$Am);S$B.cloneTo(S$j),S$_.data[S$P]=S$j.elements}else if(S$B instanceof laya.d3.math.Vector4){var S$G=S$A[S$P]||(S$A[S$P]=new S$Bm);S$B.cloneTo(S$G),S$_.data[S$P]=S$G.elements}else if(S$B instanceof laya.d3.math.Matrix4x4){var S$y=S$A[S$P]||(S$A[S$P]=new S$am);S$B.cloneTo(S$y),S$_.data[S$P]=S$y.elements}else S$B instanceof laya.d3.resource.BaseTexture&&(S$A[S$P]=S$B,S$_.data[S$P]=S$B)}},S$m.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$q(0,S$m,"alphaTestValue",function(){return this._getNumber(0)},function(S$a){this._setNumber(0,S$a)}),S$q(0,S$m,"alphaTest",function(){return this._alphaTest},function(S$a){(this._alphaTest=S$a)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),S$a.__init__=function(){S$a.SHADERDEFINE_ALPHATEST=S$a.shaderDefines.registerDefine("ALPHATEST")},S$a.RENDERQUEUE_OPAQUE=2e3,S$a.RENDERQUEUE_ALPHATEST=2450,S$a.RENDERQUEUE_TRANSPARENT=3e3,S$a.CULL_NONE=0,S$a.CULL_FRONT=1,S$a.CULL_BACK=2,S$a.BLEND_DISABLE=0,S$a.BLEND_ENABLE_ALL=1,S$a.BLEND_ENABLE_SEPERATE=2,S$a.BLENDPARAM_ZERO=0,S$a.BLENDPARAM_ONE=1,S$a.BLENDPARAM_SRC_COLOR=768,S$a.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,S$a.BLENDPARAM_DST_COLOR=774,S$a.BLENDPARAM_ONE_MINUS_DST_COLOR=775,S$a.BLENDPARAM_SRC_ALPHA=770,S$a.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,S$a.BLENDPARAM_DST_ALPHA=772,S$a.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,S$a.BLENDPARAM_SRC_ALPHA_SATURATE=776,S$a.BLENDEQUATION_ADD=0,S$a.BLENDEQUATION_SUBTRACT=1,S$a.BLENDEQUATION_REVERSE_SUBTRACT=2,S$a.DEPTHTEST_OFF=0,S$a.DEPTHTEST_NEVER=512,S$a.DEPTHTEST_LESS=513,S$a.DEPTHTEST_EQUAL=514,S$a.DEPTHTEST_LEQUAL=515,S$a.DEPTHTEST_GREATER=516,S$a.DEPTHTEST_NOTEQUAL=517,S$a.DEPTHTEST_GEQUAL=518,S$a.DEPTHTEST_ALWAYS=519,S$a.SHADERDEFINE_ALPHATEST=1,S$a.ALPHATESTVALUE=0,S$y(S$a,["shaderDefines",function(){return this.shaderDefines=new S$Gm}]),S$a}(S$u),S$Vm=function(S$a){function S$m(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,S$m.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}S$Q(S$m,"laya.d3.resource.BaseTexture",S$u);var S$s=S$m.prototype;return S$q(0,S$s,"width",function(){return this._width}),S$q(0,S$s,"repeat",function(){return this._repeat},function(S$a){if(this._repeat!==S$a&&(this._repeat=S$a,this._source)){var S$m=S$V.mainContext;S$W.bindTexture(S$m,this._type,this._source),S$H.isPOT(this._width,this._height)&&this._repeat?(S$m.texParameteri(this._type,10242,10497),S$m.texParameteri(this._type,10243,10497)):(S$m.texParameteri(this._type,10242,33071),S$m.texParameteri(this._type,10243,33071))}}),S$q(0,S$s,"height",function(){return this._height}),S$q(0,S$s,"magFifter",function(){return this._magFifter},function(S$a){(this._magFifter=S$a)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(S$a)}),S$q(0,S$s,"wrapModeV",function(){return this._wrapModeV}),S$q(0,S$s,"size",function(){return this._size}),S$q(0,S$s,"wrapModeU",function(){return this._wrapModeU}),S$q(0,S$s,"mipmap",function(){return this._mipmap},function(S$a){this._mipmap=S$a,this._mipmap!=S$a&&this._conchTexture&&this._conchTexture.setMipMap(S$a)}),S$q(0,S$s,"minFifter",function(){return this._minFifter},function(S$a){this._minFifter=S$a,this._minFifter!=S$a&&this._conchTexture&&this._conchTexture.setMinFifter(S$a)}),S$q(0,S$s,"format",function(){return this._format}),S$q(0,S$s,"source",function(){return this.activeResource(),this._source}),S$q(0,S$s,"defaulteTexture",function(){return S$Mm.grayTexture}),S$m.WARPMODE_REPEAT=0,S$m.WARPMODE_CLAMP=1,S$m}(),S$Wm=function(S$a){function S$m(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,S$m.__super.call(this),this._boundingBoxCorners=S$P(8,null)}S$Q(S$m,"laya.d3.resource.models.BaseMesh",S$u);var S$s=S$m.prototype;return S$s._getPositions=function(){throw new Error("未Override,请重载该属性！")},S$s._generateBoundingObject=function(){this._boundingSphere=new S$$a(new S$Am,0),S$$a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new S$Ta(new S$Am,new S$Am),S$Ta.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},S$s.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},S$s.getRenderElement=function(S$a){throw new Error("未Override,请重载该属性！")},S$q(0,S$s,"subMeshCount",function(){return this._subMeshCount}),S$q(0,S$s,"boundingBox",function(){return this._boundingBox}),S$q(0,S$s,"boundingBoxCorners",function(){return this._boundingBoxCorners}),S$q(0,S$s,"boundingSphere",function(){return this._boundingSphere}),S$m}(),S$bm=(function(S$a){function S$m(){S$m.__super.call(this)}S$Q(S$m,"laya.d3.component.Script",S$cm);var S$s=S$m.prototype;S$s.onTriggerEnter=function(S$a){},S$s.onTriggerExit=function(S$a){},S$s.onTriggerStay=function(S$a){},S$q(0,S$s,"isSingleton",function(){return S$m._isSingleton}),S$m._isSingleton=!1}(),function(S$a){function S$m(S$a){this._owner=null,this._sharedMesh=null,S$m.__super.call(this),this._owner=S$a}S$Q(S$m,"laya.d3.core.MeshFilter",S$a);var S$s=S$m.prototype;return S$s._sharedMeshLoaded=function(){this.event("loaded")},S$s._destroy=function(){S$a.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},S$q(0,S$s,"sharedMesh",function(){return this._sharedMesh},function(S$a){var S$m=this._sharedMesh;S$m&&S$m._removeReference(),(this._sharedMesh=S$a)._addReference(),this.event("meshchanged",[this,S$m,S$a]),S$a.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),S$q(0,S$s,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),S$q(0,S$s,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),S$q(0,S$s,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),S$q(0,S$s,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),S$m}(S$Hm)),S$Sm=function(S$a){function S$m(S$a){S$m.__super.call(this,S$a),S$a.meshFilter.on("meshchanged",this,this._onMeshChanged)}S$Q(S$m,"laya.d3.core.MeshRender",S$om);var S$s=S$m.prototype;return S$s._onMeshChanged=function(S$a,S$m,S$s){S$s.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:S$s.once("loaded",this,this._onMeshLoaed)},S$s._onMeshLoaed=function(S$a,S$m){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},S$s._calculateBoundingSphereByInitSphere=function(S$a){var S$m=NaN,S$s=this._owner.transform,S$P=S$s.scale.elements,S$_=Math.abs(S$P[0]),S$e=Math.abs(S$P[1]),S$A=Math.abs(S$P[2]);S$m=S$e<=S$_&&S$A<=S$_?S$_:S$A<=S$e?S$e:S$A,S$Am.transformCoordinate(S$a.center,S$s.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=S$a.radius*S$m},S$s._calculateBoundBoxByInitCorners=function(S$a){for(var S$m=this._owner.transform.worldMatrix,S$s=0;S$s<8;S$s++)S$Am.transformCoordinate(S$a[S$s],S$m,S$om._tempBoundBoxCorners[S$s]);S$Ta.createfromPoints(S$om._tempBoundBoxCorners,this._boundingBox)},S$s._calculateBoundingSphere=function(){var S$a=this._owner.meshFilter.sharedMesh;null==S$a||null==S$a.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(S$a.boundingSphere)},S$s._calculateBoundingBox=function(){var S$a=this._owner.meshFilter.sharedMesh;null==S$a||null==S$a.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(S$a.boundingBoxCorners)},S$s._renderUpdate=function(S$a){var S$m=this._owner.transform;if(S$m){this._setShaderValueMatrix4x4(0,S$m.worldMatrix);var S$s=this._owner.getProjectionViewWorldMatrix(S$a);this._setShaderValueMatrix4x4(1,S$s)}else this._setShaderValueMatrix4x4(0,S$am.DEFAULT),this._setShaderValueMatrix4x4(1,S$a);return S$Om.debugMode&&this._renderRenderableBoundBox(),!0},S$m}(),S$Zm=function(S$m){function S$P(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,S$P.__super.call(this),this._renderState=new S$Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new S$dm,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new S$ma,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new S$Am(.7,.7,.7),this.ambientColor=new S$Am(.212,.227,.259),S$V.shaderHighPrecision&&this.addShaderDefine(S$Um.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}S$Q(S$P,"laya.d3.core.scene.Scene",S$m);var S$a=S$P.prototype;return S$o.imps(S$a,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),S$a._setUrl=function(S$a){this._url=S$a},S$a._getGroup=function(){return this._group},S$a._setGroup=function(S$a){this._group=S$a},S$a._display=function(){S$o.stage._scenes.push(this),S$o.stage._scenes.sort(S$P._sortScenes);for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++){var S$s=this._childs[S$a];S$s.active&&S$s._activeHierarchy()}},S$a._unDisplay=function(){var S$a=S$o.stage._scenes;S$a.splice(S$a.indexOf(this),1);for(var S$m=0,S$s=this._childs.length;S$m<S$s;S$m++){var S$P=this._childs[S$m];S$P.active&&S$P._inActiveHierarchy()}},S$a._addChild3D=function(S$a){S$a.transform._onWorldTransform(),S$a._setBelongScene(this),this.displayedInStage&&S$a.active&&S$a._activeHierarchy()},S$a._removeChild3D=function(S$a){S$a.transform.parent=null,this.displayedInStage&&S$a.active&&S$a._inActiveHierarchy(),S$a._setUnBelongScene()},S$a.initOctree=function(S$a,S$m,S$s,S$P,S$_){void 0===S$_&&(S$_=6),this.treeSize=new S$Am(S$a,S$m,S$s),this.treeLevel=S$_,this.treeRoot=new S$T(this,0),this.treeRoot.init(S$P,this.treeSize)},S$a._prepareUpdateToRenderState=function(S$a,S$m){S$m.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,S$m.scene=this},S$a._prepareSceneToRender=function(S$a){var S$m=this._lights.length;if(0<S$m)for(var S$s=0,S$P=0;S$P<S$m&&!(this._lights[S$P]._prepareToScene(S$a)&&++S$s>=this._enableLightCount);S$P++);},S$a._updateChilds=function(S$a){for(var S$m=0,S$s=this._childs.length;S$m<S$s;++S$m)this._childs[S$m]._update(S$a)},S$a._preRenderScene=function(S$a,S$m,S$s){var S$P,S$_=S$m._viewMatrix,S$e=S$m._projectionMatrix,S$A=S$m._projectionViewMatrix,S$B=0,S$k=S$m.camera;for(S$k.useOcclusionCulling?this.treeRoot?S$sa.renderObjectCullingOctree(S$s,this,S$k,S$_,S$e,S$A):S$sa.renderObjectCulling(S$s,this,S$k,S$_,S$e,S$A):S$sa.renderObjectCullingNoBoundFrustum(this,S$k,S$_,S$e,S$A),S$B=0,S$P=this._quenes.length;S$B<S$P;S$B++)this._quenes[S$B]&&this._quenes[S$B]._preRender(S$m)},S$a._clear=function(S$a,S$m){var S$s=S$m._viewport,S$P=S$m.camera,S$_=S$s.x,S$e=S$P.renderTargetSize.height-S$s.y-S$s.height,S$A=S$s.width,S$B=S$s.height;S$a.viewport(S$_,S$e,S$A,S$B);var S$k=256,S$j=S$P.renderTarget;switch(S$P.clearFlag){case 0:var S$G=S$P.clearColor;if(S$G){S$a.enable(3089),S$a.scissor(S$_,S$e,S$A,S$B);var S$y=S$G.elements;S$a.clearColor(S$y[0],S$y[1],S$y[2],S$y[3]),S$k|=16384}if(S$j)switch(S$G||(S$k=16384),S$j.depthStencilFormat){case 33189:S$k|=256;break;case 36168:S$k|=1024;break;case 34041:S$k|=256,S$k|=1024}S$a.clear(S$k),S$G&&S$a.disable(3089);break;case 1:case 2:if(S$j)switch(S$k=16384,S$j.depthStencilFormat){case 33189:S$k|=256;break;case 36168:S$k|=1024;break;case 34041:S$k|=256,S$k|=1024}S$a.clear(S$k);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},S$a._renderScene=function(S$a,S$m){var S$s,S$P,S$_=S$m.camera,S$e=0;for(S$e=0;S$e<2;S$e++)(S$P=this._quenes[S$e])&&(S$_.renderTarget?S$P._render(S$m,!0):S$P._render(S$m,!1));if(1===S$_.clearFlag){var S$A=S$_.sky;S$A&&(S$W.setCullFace(S$a,!1),S$W.setDepthFunc(S$a,515),S$W.setDepthMask(S$a,!1),S$A._render(S$m),S$W.setDepthFunc(S$a,513),S$W.setDepthMask(S$a,!0))}for(S$e=2,S$s=this._quenes.length;S$e<S$s;S$e++)(S$P=this._quenes[S$e])&&(S$P._sortAlpha(S$m.camera.transform.position),S$_.renderTarget?S$P._render(S$m,!0):S$P._render(S$m,!1))},S$a._set3DRenderConfig=function(S$a){S$a.disable(3042),S$W._blend=!1,S$a.blendFunc(770,771),S$W._sFactor=770,S$W._dFactor=771,S$a.disable(2929),S$W._depthTest=!1,S$a.enable(2884),S$W._cullFace=!0,S$a.depthMask(1),S$W._depthMask=!0,S$a.frontFace(2304),S$W._frontFace=2304},S$a._set2DRenderConfig=function(S$a){S$W.setBlend(S$a,!0),S$W.setBlendFunc(S$a,1,771),S$W.setDepthTest(S$a,!1),S$W.setCullFace(S$a,!1),S$W.setDepthMask(S$a,!0),S$W.setFrontFace(S$a,2305),S$a.viewport(0,0,S$G.width,S$G.height)},S$a._parseCustomProps=function(S$a,S$m,S$s,S$P){var S$_=S$P.customProps.lightmaps,S$e=S$_.length,S$A=this._lightmaps;S$A.length=S$e;for(var S$B=0;S$B<S$e;S$B++)S$A[S$B]=S$O.getRes(S$m[S$_[S$B].replace(".exr",".png")]);this.setlightmaps(S$A);var S$k=S$P.customProps.ambientColor;S$k&&(this.ambientColor=new S$Am(S$k[0],S$k[1],S$k[2]));var S$j=S$P.customProps.fogColor;S$j&&(this.fogColor=new S$Am(S$j[0],S$j[1],S$j[2]))},S$a._addLight=function(S$a){this._lights.indexOf(S$a)<0&&this._lights.push(S$a)},S$a._removeLight=function(S$a){var S$m=this._lights.indexOf(S$a);0<=S$m&&this._lights.splice(S$m,1)},S$a._updateScene=function(){var S$a=this._renderState;this._prepareUpdateToRenderState(S$V.mainContext,S$a),this._updateComponents(S$a),this._updateChilds(S$a),this._lateUpdateComponents(S$a),this._time+=S$a.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},S$a._updateSceneConch=function(){var S$a=this._renderState;this._prepareUpdateToRenderState(S$V.mainContext,S$a),this._updateComponents(S$a),this._lateUpdateComponents(S$a),this._prepareSceneToRender(S$a);for(var S$m=0,S$s=this._cameraPool.length;S$m<S$s;S$m++){var S$P=this._cameraPool[S$m];(S$a.camera=S$P)._prepareCameraToRender()}},S$a._preRenderShadow=function(S$a,S$m,S$s,S$P,S$_){this.treeRoot?S$sa.renderShadowObjectCullingOctree(this,S$m,S$s,S$P,S$_):S$sa.renderShadowObjectCulling(this,S$m,S$s,S$P,S$_);for(var S$e=0,S$A=S$s.length;S$e<S$A;S$e++)S$s[S$e]&&S$s[S$e]._preRender(S$a)},S$a._renderShadowMap=function(S$a,S$m,S$s){var S$P=this.parallelSplitShadowMaps[0];S$P._calcAllLightCameraInfo(S$s);var S$_,S$e,S$A,S$B=S$P.PSSMNum;if(this._preRenderShadow(S$m,S$P._lightCulling,S$P._shadowQuenes,S$P._lightVPMatrix[0],S$B),this.addShaderDefine(S$Qm.SHADERDEFINE_CAST_SHADOW),1<S$B)for(var S$k=0;S$k<S$B;S$k++)S$_=S$P.getRenderTarget(S$k+1),S$P.beginRenderTarget(S$k+1),S$a.clearColor(1,1,1,1),S$a.clear(16640),S$a.viewport(0,0,S$_.width,S$_.height),S$m.camera=S$A=S$P.getLightCamera(S$k),S$A._prepareCameraToRender(),S$A._prepareCameraViewProject(S$A.viewMatrix,S$A.projectionMatrix),S$m._projectionViewMatrix=S$P._lightVPMatrix[S$k+1],(S$e=S$P._shadowQuenes[S$k])._preRender(S$m),S$e._renderShadow(S$m,!1),S$P.endRenderTarget(S$k+1);else S$_=S$P.getRenderTarget(1),S$P.beginRenderTarget(1),S$a.clearColor(1,1,1,1),S$a.clear(16640),S$a.viewport(0,0,S$_.width,S$_.height),S$m.camera=S$A=S$P.getLightCamera(0),S$A._prepareCameraToRender(),S$A._prepareCameraViewProject(S$A.viewMatrix,S$A.projectionMatrix),S$m._projectionViewMatrix=S$P._lightVPMatrix[0],(S$e=S$P._shadowQuenes[0])._preRender(S$m),S$e._renderShadow(S$m,!0),S$P.endRenderTarget(1);this.removeShaderDefine(S$Qm.SHADERDEFINE_CAST_SHADOW)},S$a.addTreeNode=function(S$a){this.treeRoot.addTreeNode(S$a)},S$a.removeTreeNode=function(S$a){this.treeSize&&S$a._treeNode&&S$a._treeNode.removeObject(S$a)},S$a.setlightmaps=function(S$a){this._lightmaps=S$a;for(var S$m=0,S$s=this._renderableSprite3Ds.length;S$m<S$s;S$m++)this._renderableSprite3Ds[S$m]._render._applyLightMapParams()},S$a.getlightmaps=function(){return this._lightmaps},S$a.addChildAt=function(S$a,S$m){if(!(S$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(S$a&&S$a.__className));if(!S$a||this.destroyed||S$a===this)return S$a;if(S$a.zOrder&&this._set$P("hasZorder",!0),0<=S$m&&S$m<=this._childs.length){if(S$a._parent===this){var S$s=this.getChildIndex(S$a);this._childs.splice(S$s,1),this._childs.splice(S$m,0,S$a),this.conchModel&&(this.conchModel.removeChild(S$a.conchModel),this.conchModel.addChildAt(S$a.conchModel,S$m)),this._childChanged()}else S$a.parent&&S$a.parent.removeChild(S$a),this._childs===S$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(S$m,0,S$a),this.conchModel&&this.conchModel.addChildAt(S$a.conchModel,S$m),(S$a.parent=this)._addChild3D(S$a);return S$a}throw new Error("appendChildAt:The index is out of bounds")},S$a.addChild=function(S$a){if(!(S$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!S$a||this.destroyed||S$a===this)return S$a;if(S$a.zOrder&&this._set$P("hasZorder",!0),S$a._parent===this){var S$m=this.getChildIndex(S$a);S$m!==this._childs.length-1&&(this._childs.splice(S$m,1),this._childs.push(S$a),this.conchModel&&(this.conchModel.removeChild(S$a.conchModel),this.conchModel.addChildAt(S$a.conchModel,this._childs.length-1)),this._childChanged())}else S$a.parent&&S$a.parent.removeChild(S$a),this._childs===S$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(S$a),this.conchModel&&this.conchModel.addChildAt(S$a.conchModel,this._childs.length-1),(S$a.parent=this)._childChanged(),this._addChild3D(S$a);return S$a},S$a.removeChildAt=function(S$a){var S$m=this.getChildAt(S$a);return S$m&&(this._removeChild3D(S$m),this._childs.splice(S$a,1),this.conchModel&&this.conchModel.removeChild(S$m.conchModel),S$m.parent=null),S$m},S$a.removeChildren=function(S$a,S$m){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=2147483647),this._childs&&0<this._childs.length){var S$s=this._childs;if(0===S$a&&S$e<=S$m){var S$P=S$s;this._childs=S$j.ARRAY_EMPTY}else S$P=S$s.splice(S$a,S$m-S$a);for(var S$_=0,S$e=S$P.length;S$_<S$e;S$_++)this._removeChild3D(S$P[S$_]),S$P[S$_].parent=null,this.conchModel&&this.conchModel.removeChild(S$P[S$_].conchModel)}return this},S$a.addFrustumCullingObject=function(S$a){this.treeRoot?this.addTreeNode(S$a):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(S$a):this._cullingRenders[this._cullingRendersLength]=S$a,S$a._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},S$a.removeFrustumCullingObject=function(S$a){if(this.treeRoot)this.removeTreeNode(S$a);else{this._cullingRendersLength--;var S$m=S$a._indexInSceneFrustumCullingObjects;if(S$m!==this._cullingRendersLength){var S$s=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[S$m]=S$s)._indexInSceneFrustumCullingObjects=S$m,S$a._indexInSceneFrustumCullingObjects=-1}}},S$a.getRenderQueue=function(S$a){return S$a<3e3?this._quenes[1]||(this._quenes[1]=new S$v(this)):this._quenes[2]||(this._quenes[2]=new S$v(this))},S$a.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new S$v(this)},S$a.addShaderDefine=function(S$a){this._shaderDefineValue|=S$a},S$a.removeShaderDefine=function(S$a){this._shaderDefineValue&=~S$a},S$a.addScript=function(S$a){return this._addComponent(S$a)},S$a.getScriptByType=function(S$a,S$m){return void 0===S$m&&(S$m=0),this._getComponentByType(S$a,S$m)},S$a.getScriptsByType=function(S$a,S$m){this._getComponentsByType(S$a,S$m)},S$a.getScriptByIndex=function(S$a){return this._getComponentByIndex(S$a)},S$a.removeScriptByType=function(S$a,S$m){void 0===S$m&&(S$m=0),this._removeComponentByType(S$a,S$m)},S$a.removeScriptsByType=function(S$a){this._removeComponentByType(S$a)},S$a.removeAllScript=function(){this._removeAllComponent()},S$a.render=function(S$a,S$m,S$s){(S$h._context.ctx._renderKey=0)<this._childs.length&&S$a.addRenderObject(this)},S$a.renderSubmit=function(){var S$a=S$V.mainContext,S$m=this._renderState;this._set3DRenderConfig(S$a),this._prepareSceneToRender(this._renderState);var S$s,S$P=0,S$_=0;if(S$Om.debugMode||S$T.debugMode)for(S$P=0,S$_=this._cameraPool.length;S$P<S$_;S$P++)S$s=this._cameraPool[S$P],S$Om._debugPhasorSprite.begin(1,S$s),S$s.activeInHierarchy&&S$s._renderCamera(S$a,S$m,this),S$Om._debugPhasorSprite.end();else for(S$P=0,S$_=this._cameraPool.length;S$P<S$_;S$P++)(S$s=this._cameraPool[S$P]).activeInHierarchy&&S$s._renderCamera(S$a,S$m,this);return this._set2DRenderConfig(S$a),1},S$a.onAsynLoaded=function(S$a,S$m,S$s){var S$P=S$m[0];if("Scene"!==S$P.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var S$_=S$m[1];S$um._createNodeByJson(this,S$P,this,S$_),this.event("hierarchyloaded",[this]),this.__loaded=!0},S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),this.destroyed||(S$m.prototype.destroy.call(this,S$a),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,S$O.clearRes(this.url),this.loaded||S$Om._cancelLoadByUrl(this.url))},S$a.getRenderType=function(){return 0},S$a.releaseRender=function(){},S$a._addComponent=function(S$a){var S$m,S$s=this._componentsMap.indexOf(S$a);if(-1===S$s)S$m=[],this._componentsMap.push(S$a),this._typeComponentsIndices.push(S$m);else if(S$m=this._typeComponentsIndices[S$s],this._components[S$m[0]].isSingleton)throw new Error("无法单实例创建"+S$a+"组件，"+S$a+"组件已存在！");var S$P=S$_.getInstance(S$a);S$m.push(this._components.length),this._components.push(S$P);return S$P._initialize(this),S$P},S$a._removeComponent=function(S$a,S$m){var S$s=this._typeComponentsIndices[S$a],S$P=S$s[S$m],S$_=this._components[S$P];this._components.splice(S$P,1),S$s.splice(S$m,1),0===S$s.length&&(this._typeComponentsIndices.splice(S$a,1),this._componentsMap.splice(S$a,1));for(var S$e=0,S$A=this._componentsMap.length;S$e<S$A;S$e++)for(var S$B=(S$s=this._typeComponentsIndices[S$e]).length-1;0<=S$B;S$B--){var S$k=S$s[S$B];if(!(S$P<S$k))break;S$s[S$B]=--S$k}S$_._destroy()},S$a._getComponentByType=function(S$a,S$m){void 0===S$m&&(S$m=0);var S$s=this._componentsMap.indexOf(S$a);return-1===S$s?null:this._components[this._typeComponentsIndices[S$s][S$m]]},S$a._getComponentsByType=function(S$a,S$m){var S$s=this._componentsMap.indexOf(S$a);if(-1!==S$s){var S$P=this._typeComponentsIndices[S$s],S$_=S$P.length;S$m.length=S$_;for(var S$e=0;S$e<S$_;S$e++)S$m[S$e]=this._components[S$P[S$e]]}else S$m.length=0},S$a._getComponentByIndex=function(S$a){return this._components[S$a]},S$a._removeComponentByType=function(S$a,S$m){void 0===S$m&&(S$m=0);var S$s=this._componentsMap.indexOf(S$a);-1!==S$s&&this._removeComponent(S$s,S$m)},S$a._removeComponentsByType=function(S$a){var S$m=this._componentsMap.indexOf(S$a);if(-1!==S$m)for(var S$s=this._typeComponentsIndices[S$m],S$P=0,S$_=S$s.length;S$P<S$_;S$s.length<S$_?S$_--:S$P++)this._removeComponent(S$m,S$P)},S$a._removeAllComponent=function(){for(var S$a=0,S$m=this._componentsMap.length;S$a<S$m;this._componentsMap.length<S$m?S$m--:S$a++)this._removeComponentsByType(this._componentsMap[S$a])},S$a._updateComponents=function(S$a){for(var S$m=0,S$s=this._components.length;S$m<S$s;S$m++){var S$P=this._components[S$m];!S$P.started&&(S$P._start(S$a),S$P.started=!0),S$P.enable&&S$P._update(S$a)}},S$a._lateUpdateComponents=function(S$a){for(var S$m=0;S$m<this._components.length;S$m++){var S$s=this._components[S$m];!S$s.started&&(S$s._start(S$a),S$s.started=!0),S$s.enable&&S$s._lateUpdate(S$a)}},S$a._preRenderUpdateComponents=function(S$a){for(var S$m=0;S$m<this._components.length;S$m++){var S$s=this._components[S$m];!S$s.started&&(S$s._start(S$a),S$s.started=!0),S$s.enable&&S$s._preRenderUpdate(S$a)}},S$a._postRenderUpdateComponents=function(S$a){for(var S$m=0;S$m<this._components.length;S$m++){var S$s=this._components[S$m];!S$s.started&&(S$s._start(S$a),S$s.started=!0),S$s.enable&&S$s._postRenderUpdate(S$a)}},S$q(0,S$a,"_loaded",null,function(S$a){this.__loaded=S$a}),S$q(0,S$a,"fogColor",function(){return this._fogColor},function(S$a){this._fogColor=S$a,this._shaderValues.setValue(0,S$a.elements)}),S$q(0,S$a,"enableFog",function(){return this._enableFog},function(S$a){this._enableFog!==S$a&&((this._enableFog=S$a)?(this.addShaderDefine(S$Um.SHADERDEFINE_FOG),this.removeShaderDefine(S$Um.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(S$Um.SHADERDEFINE_FOG))}),S$q(0,S$a,"url",function(){return this._url}),S$q(0,S$a,"loaded",function(){return this.__loaded}),S$q(0,S$a,"enableDepthFog",function(){return this._enableDepthFog},function(S$a){this._enableDepthFog!=S$a&&((this._enableDepthFog=S$a)?(this.addShaderDefine(S$Um.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(S$Um.SHADERDEFINE_FOG)):this.removeShaderDefine(S$Um.SAHDERDEFINE_DEPTHFOG))}),S$q(0,S$a,"fogStart",function(){return this._fogStart},function(S$a){this._fogStart=S$a,this._shaderValues.setValue(1,S$a)}),S$q(0,S$a,"fogRange",function(){return this._fogRange},function(S$a){this._fogRange=S$a,this._shaderValues.setValue(2,S$a)}),S$q(0,S$a,"ambientColor",function(){return this._ambientColor},function(S$a){this._ambientColor=S$a,this._shaderValues.setValue(21,S$a.elements)}),S$q(0,S$a,"scene",function(){return this}),S$q(0,S$a,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),S$P._sortScenes=function(S$a,S$m){if(S$a.parent!==S$o.stage||S$m.parent!==S$o.stage)return S$a.parent!==S$o.stage&&S$m.parent!==S$o.stage?S$P._sortScenes(S$a.parent,S$m.parent):S$a.parent===S$o.stage?-1:1;var S$s=S$o.stage._childs;return S$s.indexOf(S$a)-S$s.indexOf(S$m)},S$P.load=function(S$a){return S$o.loader.create(S$a,null,null,S$P)},S$P.FOGCOLOR=0,S$P.FOGSTART=1,S$P.FOGRANGE=2,S$P.LIGHTDIRECTION=3,S$P.LIGHTDIRCOLOR=4,S$P.POINTLIGHTPOS=5,S$P.POINTLIGHTRANGE=6,S$P.POINTLIGHTATTENUATION=7,S$P.POINTLIGHTCOLOR=8,S$P.SPOTLIGHTPOS=9,S$P.SPOTLIGHTDIRECTION=10,S$P.SPOTLIGHTSPOT=11,S$P.SPOTLIGHTRANGE=12,S$P.SPOTLIGHTATTENUATION=13,S$P.SPOTLIGHTCOLOR=14,S$P.SHADOWDISTANCE=15,S$P.SHADOWLIGHTVIEWPROJECT=16,S$P.SHADOWMAPPCFOFFSET=17,S$P.SHADOWMAPTEXTURE1=18,S$P.SHADOWMAPTEXTURE2=19,S$P.SHADOWMAPTEXTURE3=20,S$P.AMBIENTCOLOR=21,S$P.TIME=22,S$P}(S$z),S$Xm=function(S$a){function S$m(S$a){S$m.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new S$am,this._shaderValues=new S$dm,this._colliders=[],this._id=++S$m._uniqueIDCounter,this._transform=new S$Nm(this),this.name=S$a||"Sprite3D-"+S$m._nameNumberCounter++,this.layer=S$S.currentCreationLayer,this.active=!0}S$Q(S$m,"laya.d3.core.Sprite3D",S$fm);var S$s=S$m.prototype;return S$o.imps(S$s,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),S$s._setUrl=function(S$a){this._url=S$a},S$s._getGroup=function(){return this._group},S$s._setGroup=function(S$a){this._group=S$a},S$s._addChild3D=function(S$a){S$a.transform.parent=this.transform,this._hierarchyAnimator&&(!S$a._hierarchyAnimator&&S$a._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(S$a,!0,[S$a.name])),this._scene&&(S$a._setBelongScene(this._scene),this._activeInHierarchy&&S$a._active&&S$a._activeHierarchy())},S$s._removeChild3D=function(S$a){S$a.transform.parent=null,this._scene&&(this._activeInHierarchy&&S$a._active&&S$a._inActiveHierarchy(),S$a._setUnBelongScene()),this._hierarchyAnimator&&(S$a._hierarchyAnimator==this._hierarchyAnimator&&S$a._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(S$a,!1,[S$a.name]))},S$s._parseBaseCustomProps=function(S$a){var S$m=this.transform.localPosition;S$a.translate?(S$m.fromArray(S$a.translate),S$m.x*=100,S$m.y*=100,S$m.z*=100):S$m.elements.fill(0),this.transform.localPosition=S$m;var S$s=this.transform.localRotation;S$a.rotation?S$s.fromArray(S$a.rotation):S$s.fromArray([0,0,0,-1]),this.transform.localRotation=S$s;var S$P=this.transform.localScale;S$a.scale?S$P.fromArray(S$a.scale):S$P.elements.fill(1),this.transform.localScale=S$P;var S$_=S$a.layer;null!=S$_&&(this.layer=S$S.getLayerByNumber(S$_))},S$s._parseCustomComponent=function(S$a,S$m,S$s){for(var S$P in S$s){var S$_=S$s[S$P];switch(S$P){case"Animator":var S$e=this.addComponent(Animator);if(S$_.avatarPath)S$e.avatar=S$O.getRes(S$m[S$_.avatarPath]);else{var S$A=S$_.avatar;if(S$A){S$e.avatar=S$O.getRes(S$m[S$A.path]);var S$B=S$A.linkSprites;S$B&&S$a.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[S$e,S$B])}}for(var S$k=S$_.clipPaths,S$j=S$k.length,S$G=0;S$G<S$j;S$G++)S$e.addClip(S$O.getRes(S$m[S$k[S$G]]));S$e.clip=S$O.getRes(S$m[S$k[0]]);var S$y=S$_.playOnWake;void 0!==S$y&&(S$e.playOnWake=S$y);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var S$d=this.addComponent(SphereCollider);S$d.isTrigger=S$_.isTrigger;var S$Q=S$d.center;S$Q.fromArray(S$_.center),S$d.center=S$Q,S$d.radius=S$_.radius;break;case"BoxCollider":var S$q=this.addComponent(BoxCollider);S$q.isTrigger=S$_.isTrigger,S$q.center.fromArray(S$_.center);var S$h=S$q.size;S$h.fromArray(S$_.size),S$q.size=S$h;break;case"MeshCollider":this.addComponent(MeshCollider)}}},S$s._onRootNodeHierarchyLoaded=function(S$a,S$m){for(var S$s in S$m){for(var S$P=this,S$_=S$m[S$s],S$e=0,S$A=S$_.length;S$e<S$A;S$e++){var S$B=S$_[S$e];if(""===S$B)break;if(!(S$P=S$P.getChildByName(S$B)))break}S$P&&S$a.linkSprite3DToAvatarNode(S$s,S$P)}},S$s._setHierarchyAnimator=function(S$a,S$m){this._changeHierarchyAnimator(S$a);for(var S$s=0,S$P=this._childs.length;S$s<S$P;S$s++){var S$_=this._childs[S$s];S$_._hierarchyAnimator==S$m&&S$_._setHierarchyAnimator(S$a,S$m)}},S$s._clearHierarchyAnimator=function(S$a,S$m){this._changeHierarchyAnimator(S$m);for(var S$s=0,S$P=this._childs.length;S$s<S$P;S$s++){var S$_=this._childs[S$s];S$_._hierarchyAnimator==S$a&&S$_._clearHierarchyAnimator(S$a,S$m)}},S$s._getAnimatorToLinkSprite3D=function(S$a,S$m,S$s){var S$P=this.getComponentByType(Animator);if(S$P&&(S$P.avatar?S$P.avatar._version||S$a._setAnimatorToLinkAvatar(S$P,S$m):S$a._setAnimatorToLinkSprite3DNoAvatar(S$P,S$m,S$s)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){S$s.unshift(this._parent.name);var S$_=this._parent;S$_._hierarchyAnimator&&S$_._getAnimatorToLinkSprite3D(S$a,S$m,S$s)}},S$s._setAnimatorToLinkSprite3DNoAvatar=function(S$a,S$m,S$s){var S$P=0,S$_=0;for(S$P=0,S$_=S$a.getClipCount();S$P<S$_;S$P++)S$a._handleSpriteOwnersBySprite(S$P,S$m,S$s,this);for(S$P=0,S$_=this._childs.length;S$P<S$_;S$P++){var S$e=this._childs[S$P],S$A=S$s.length;S$s.push(S$e.name),S$e._setAnimatorToLinkSprite3DNoAvatar(S$a,S$m,S$s),S$s.splice(S$A,1)}},S$s._changeHierarchyAnimator=function(S$a){this._hierarchyAnimator=S$a},S$s._isLinkSpriteToAnimationNode=function(S$a,S$m,S$s){var S$P=S$a._avatarNodes.indexOf(S$m),S$_=S$a._cacheSpriteToNodesMap;if(S$s)this._transform.dummy=S$m.transform,S$a._cacheNodesToSpriteMap[S$P]=S$_.length,S$_.push(S$P);else{this._transform.dummy=null;var S$e=S$a._cacheNodesToSpriteMap[S$P];S$a._cacheNodesToSpriteMap[S$P]=null,S$_.splice(S$e,1)}},S$s._setBelongScene=function(S$a){this._scene=S$a;for(var S$m=0,S$s=this._childs.length;S$m<S$s;S$m++)this._childs[S$m]._setBelongScene(S$a)},S$s._setUnBelongScene=function(){this._scene=null;for(var S$a=0,S$m=this._childs.length;S$a<S$m;S$a++)this._childs[S$a]._setUnBelongScene()},S$s._activeHierarchy=function(){var S$a=0,S$m=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),S$a=0,S$m=this._colliders.length;S$a<S$m;S$a++)this._layer._addCollider(this._colliders[S$a]);for(this.event("activeinhierarchychanged",!0),S$a=0,S$m=this._childs.length;S$a<S$m;S$a++){var S$s=this._childs[S$a];S$s._active&&S$s._activeHierarchy()}},S$s._inActiveHierarchy=function(){var S$a=0,S$m=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),S$a=0,S$m=this._colliders.length;S$a<S$m;S$a++){var S$s=this._colliders[S$a];S$s._clearCollsionMap(),this._layer._removeCollider(S$s)}for(this.event("activeinhierarchychanged",!1),S$a=0,S$m=this._childs.length;S$a<S$m;S$a++){var S$P=this._childs[S$a];S$P._active&&S$P._inActiveHierarchy()}},S$s.addComponent=function(S$a){var S$m,S$s=this._componentsMap.indexOf(S$a);if(-1===S$s)S$m=[],this._componentsMap.push(S$a),this._typeComponentsIndices.push(S$m);else if(S$m=this._typeComponentsIndices[S$s],this._components[S$m[0]].isSingleton)throw new Error("无法单实例创建"+S$a+"组件，"+S$a+"组件已存在！");var S$P=S$_.getInstance(S$a);return S$m.push(this._components.length),this._components.push(S$P),S$P instanceof laya.d3.component.Script&&this._scripts.push(S$P),S$P._initialize(this),S$P},S$s._removeComponent=function(S$a,S$m){var S$s,S$P=0,S$_=this._typeComponentsIndices[S$a],S$e=S$_[S$m],S$A=this._components[S$e];for(S$A instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(S$A),1),S$_.splice(S$m,1),0===S$_.length&&(this._typeComponentsIndices.splice(S$a,1),this._componentsMap.splice(S$a,1)),S$P=0,S$s=this._componentsMap.length;S$P<S$s;S$P++)for(var S$B=(S$_=this._typeComponentsIndices[S$P]).length-1;0<=S$B;S$B--){var S$k=S$_[S$B];if(!(S$e<S$k))break;S$_[S$B]=--S$k}S$A._destroy()},S$s._clearSelfRenderObjects=function(){},S$s._addSelfRenderObjects=function(){},S$s._parseCustomProps=function(S$a,S$m,S$s,S$P){},S$s._updateChilds=function(S$a){var S$m=this._childs.length;if(0!==S$m)for(var S$s=0;S$s<S$m;++S$s)this._childs[S$s]._update(S$a)},S$s._getSortID=function(S$a,S$m){return 1e3*S$m.id+S$a._getVertexBuffer().vertexDeclaration.id},S$s._update=function(S$a){(S$a.owner=this)._activeInHierarchy&&(this._updateComponents(S$a),this._lateUpdateComponents(S$a),S$U.spriteCount++,this._childs.length&&this._updateChilds(S$a))},S$s.getProjectionViewWorldMatrix=function(S$a){return S$am.multiply(S$a,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},S$s.loadHierarchy=function(S$a){this.addChild(laya.d3.core.Sprite3D.load(S$a))},S$s.addChildAt=function(S$a,S$m){if(!(S$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!S$a||this.destroyed||S$a===this)return S$a;if(S$a.zOrder&&this._set$P("hasZorder",!0),0<=S$m&&S$m<=this._childs.length){if(S$a._parent===this){var S$s=this.getChildIndex(S$a);this._childs.splice(S$s,1),this._childs.splice(S$m,0,S$a),this.conchModel&&(this.conchModel.removeChild(S$a.conchModel),this.conchModel.addChildAt(S$a.conchModel,S$m)),this._childChanged()}else S$a.parent&&S$a.parent.removeChild(S$a),this._childs===S$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(S$m,0,S$a),this.conchModel&&this.conchModel.addChildAt(S$a.conchModel,S$m),(S$a.parent=this)._addChild3D(S$a);return S$a}throw new Error("appendChildAt:The index is out of bounds")},S$s.addChild=function(S$a){if(!(S$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!S$a||this.destroyed||S$a===this)return S$a;if(S$a.zOrder&&this._set$P("hasZorder",!0),S$a._parent===this){var S$m=this.getChildIndex(S$a);S$m!==this._childs.length-1&&(this._childs.splice(S$m,1),this._childs.push(S$a),this.conchModel&&(this.conchModel.removeChild(S$a.conchModel),this.conchModel.addChildAt(S$a.conchModel,this._childs.length-1)),this._childChanged())}else S$a.parent&&S$a.parent.removeChild(S$a),this._childs===S$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(S$a),this.conchModel&&this.conchModel.addChildAt(S$a.conchModel,this._childs.length-1),(S$a.parent=this)._childChanged(),this._addChild3D(S$a);return S$a},S$s.removeChildAt=function(S$a){var S$m=this.getChildAt(S$a);return S$m&&(this._removeChild3D(S$m),this._childs.splice(S$a,1),this.conchModel&&this.conchModel.removeChild(S$m.conchModel),S$m.parent=null),S$m},S$s.removeChildren=function(S$a,S$m){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=2147483647),this._childs&&0<this._childs.length){var S$s=this._childs;if(0===S$a&&S$e<=S$m){var S$P=S$s;this._childs=S$j.ARRAY_EMPTY}else S$P=S$s.splice(S$a,S$m-S$a);for(var S$_=0,S$e=S$P.length;S$_<S$e;S$_++)this._removeChild3D(S$P[S$_]),S$P[S$_].parent=null,this.conchModel&&this.conchModel.removeChild(S$P[S$_].conchModel)}return this},S$s.onAsynLoaded=function(S$a,S$m,S$s){var S$P=S$m[0];if("Sprite3D"!==S$P.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var S$_=S$m[1];S$um._createNodeByJson(this,S$P,this,S$_),this.event("hierarchyloaded",[this]),this.__loaded=!0},S$s.cloneTo=function(S$a){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var S$m=S$a;S$m.name=this.name,S$m._destroyed=this._destroyed,S$m.timer=this.timer,S$m._$P=this._$P,S$m.active=this._active;var S$s=S$m.transform.localPosition;this.transform.localPosition.cloneTo(S$s),S$m.transform.localPosition=S$s;var S$P=S$m.transform.localRotation;this.transform.localRotation.cloneTo(S$P),S$m.transform.localRotation=S$P;var S$_=S$m.transform.localScale;this.transform.localScale.cloneTo(S$_),S$m.transform.localScale=S$_,S$m.isStatic=this.isStatic;var S$e=0,S$A=0;for(S$e=0,S$A=this._componentsMap.length;S$e<S$A;S$e++){var S$B=S$m.addComponent(this._componentsMap[S$e]);this._components[S$e]._cloneTo(S$B)}for(S$e=0,S$A=this._childs.length;S$e<S$A;S$e++)S$m.addChild(this._childs[S$e].clone());var S$k=S$m.getComponentByType(Animator);if(S$k){var S$j=S$k._linkSpritesData;if(S$j)for(var S$G in S$j){for(var S$y=S$j[S$G],S$d=S$m,S$Q=0,S$q=S$y.length;S$Q<S$q&&(S$d=S$d.getChildByName(S$y[S$Q]));S$Q++);if(S$d){var S$h=S$k._avatarNodeMap[S$G];S$d._isLinkSpriteToAnimationNode(S$k,S$h,!0)}}}},S$s.clone=function(){var S$a=new this.constructor;return this.cloneTo(S$a),S$a},S$s.destroy=function(S$a){if(void 0===S$a&&(S$a=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,S$a);var S$m,S$s=0;for(S$s=0,S$m=this._components.length;S$s<S$m;S$s++)this._components[S$s]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,S$O.clearRes(this.url),this.loaded||S$Om._cancelLoadByUrl(this.url)}},S$s._handleSpriteToAvatar=function(S$a,S$m){S$a._avatarNodes;var S$s=S$a._avatarNodeMap[this.name];S$s&&S$s.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(S$a,S$s,S$m)},S$s._setAnimatorToLinkAvatar=function(S$a,S$m){this._handleSpriteToAvatar(S$a,S$m);for(var S$s=0,S$P=this._childs.length;S$s<S$P;S$s++){this._childs[S$s]._setAnimatorToLinkAvatar(S$a,S$m)}},S$q(0,S$s,"activeInHierarchy",function(){return this._activeInHierarchy}),S$q(0,S$s,"_loaded",null,function(S$a){this.__loaded=S$a}),S$q(0,S$s,"active",function(){return this._active},function(S$a){this._active!==S$a&&(this._active=S$a,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(S$a?this._activeHierarchy():this._inActiveHierarchy()))}),S$q(0,S$s,"componentsCount",function(){return this._components.length}),S$q(0,S$s,"loaded",function(){return this.__loaded}),S$q(0,S$s,"id",function(){return this._id}),S$q(0,S$s,"url",function(){return this._url}),S$q(0,S$s,"layer",function(){return this._layer},function(S$a){if(this._layer!==S$a){if(!S$a)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var S$m=0,S$s=this._colliders.length;if(this._layer)for(S$m=0;S$m<S$s;S$m++)this._layer._removeCollider(this._colliders[S$m]);for(S$m=0;S$m<S$s;S$m++)S$a._addCollider(this._colliders[S$m])}this._layer=S$a,this.event("layerchanged",S$a)}}),S$q(0,S$s,"scene",function(){return this._scene}),S$q(0,S$s,"transform",function(){return this._transform}),S$m.instantiate=function(S$a,S$m,S$s,S$P,S$_){void 0===S$s&&(S$s=!0);var S$e=S$a.clone();S$m&&S$m.addChild(S$e);var S$A=S$e.transform;if(S$s){var S$B=S$A.worldMatrix;S$a.transform.worldMatrix.cloneTo(S$B),S$A.worldMatrix=S$B}else S$P&&(S$A.position=S$P),S$_&&(S$A.rotation=S$_);return S$e},S$m.load=function(S$a){return S$o.loader.create(S$a,null,null,S$m)},S$m.WORLDMATRIX=0,S$m.MVPMATRIX=1,S$m._uniqueIDCounter=0,S$m._nameNumberCounter=0,S$m}(),S$Em=function(S$a){function S$G(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],S$G.__super.call(this),!S$a||!S$m)throw"Shader Error";this._id=++S$G._count,this._vs=S$a,this._ps=S$m,this._attributeMap=S$s,this._sceneUniformMap=S$P,this._cameraUniformMap=S$_,this._spriteUniformMap=S$e,this._materialUniformMap=S$A,this._renderElementUniformMap=S$B,this._precompile=S$k,this._define=S$j,this._precompile&&S$G.extCompileObj&&S$G.extCompileFunc?S$G.extCompileFunc.call(S$G.extCompileObj,S$a,S$m,S$j):this.recreateResource()}S$Q(S$G,"laya.d3.shader.Shader3D",S$s);var S$m=S$G.prototype;return S$m.recreateResource=function(){S$b.now();this._compile(),this.completeCreate(),this.memorySize=0},S$m.disposeResource=function(){S$V.mainContext.deleteShader(this._vshader),S$V.mainContext.deleteShader(this._pshader),S$V.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},S$m._compile=function(){if(!S$V.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var S$a=[this._vs,this._ps],S$m=S$V.mainContext;if(this._program=S$m.createProgram(),this._vshader=S$G._createShader(S$m,S$a[0],35633),this._pshader=S$G._createShader(S$m,S$a[1],35632),S$m.attachShader(this._program,this._vshader),S$m.attachShader(this._program,this._pshader),S$m.linkProgram(this._program),!S$h.isConchApp&&S$Um.debugMode&&!S$m.getProgramParameter(this._program,35714))throw S$m.getProgramInfoLog(this._program);var S$s,S$P=0,S$_=0,S$e=0;for(S$e=S$h.isConchApp?S$m.getProgramParameterEx(this._vs,this._ps,"",35721):S$m.getProgramParameter(this._program,35721),S$P=0;S$P<S$e;S$P++){var S$A=null;S$s={vartype:"attribute",ivartype:0,attrib:S$A=S$h.isConchApp?S$m.getActiveAttribEx(this._vs,this._ps,"",S$P):S$m.getActiveAttrib(this._program,S$P),location:S$m.getAttribLocation(this._program,S$A.name),name:S$A.name,type:S$A.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(S$s)}var S$B=0;for(S$B=S$h.isConchApp?S$m.getProgramParameterEx(this._vs,this._ps,"",35718):S$m.getProgramParameter(this._program,35718),S$P=0;S$P<S$B;S$P++){var S$k=null;S$k=S$h.isConchApp?S$m.getActiveUniformEx(this._vs,this._ps,"",S$P):S$m.getActiveUniform(this._program,S$P),0<(S$s={vartype:"uniform",ivartype:1,attrib:S$A,location:S$m.getUniformLocation(this._program,S$k.name),name:S$k.name,type:S$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(S$s.name=S$s.name.substr(0,S$s.name.length-3),S$s.isArray=!0,S$s.location=S$m.getUniformLocation(this._program,S$s.name)),this._uniformParams.push(S$s)}for(S$P=0,S$_=this._attributeParams.length;S$P<S$_;S$P++)(S$s=this._attributeParams[S$P]).indexOfParams=S$P,S$s.index=1,S$s.value=[S$s.location,null],S$s.codename=S$s.name,S$s.name=null!=this._attributeMap[S$s.codename]?this._attributeMap[S$s.codename]:S$s.codename,this._attributeParamsMap.push(S$s.name),this._attributeParamsMap.push(S$s),S$s._this=this,S$s.uploadedValue=[],S$s.fun=this._attribute;for(S$P=0,S$_=this._uniformParams.length;S$P<S$_;S$P++)switch((S$s=this._uniformParams[S$P]).indexOfParams=S$P,S$s.index=1,S$s.value=[S$s.location,null],S$s.codename=S$s.name,null!=this._sceneUniformMap[S$s.codename]?(S$s.name=this._sceneUniformMap[S$s.codename],this._sceneUniformParamsMap.push(S$s.name),this._sceneUniformParamsMap.push(S$s)):null!=this._cameraUniformMap[S$s.codename]?(S$s.name=this._cameraUniformMap[S$s.codename],this._cameraUniformParamsMap.push(S$s.name),this._cameraUniformParamsMap.push(S$s)):null!=this._spriteUniformMap[S$s.codename]?(S$s.name=this._spriteUniformMap[S$s.codename],this._spriteUniformParamsMap.push(S$s.name),this._spriteUniformParamsMap.push(S$s)):null!=this._materialUniformMap[S$s.codename]?(S$s.name=this._materialUniformMap[S$s.codename],this._materialUniformParamsMap.push(S$s.name),this._materialUniformParamsMap.push(S$s)):null!=this._renderElementUniformMap[S$s.codename]?(S$s.name=this._renderElementUniformMap[S$s.codename],this._renderElementUniformParamsMap.push(S$s.name),this._renderElementUniformParamsMap.push(S$s)):console.log("Shader:can't find uinform name:"+S$s.codename+" in shader file."),S$s._this=this,S$s.uploadedValue=[],S$s.type){case 5124:S$s.fun=S$s.isArray?this._uniform1iv:this._uniform1i;break;case 5126:S$s.fun=S$s.isArray?this._uniform1fv:this._uniform1f;break;case 35664:S$s.fun=S$s.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:S$s.fun=S$s.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:S$s.fun=S$s.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:S$s.fun=this._uniform_sampler2D;break;case 35680:S$s.fun=this._uniform_samplerCube;break;case 35676:S$s.fun=this._uniformMatrix4fv;break;case 35670:S$s.fun=this._uniform1i;break;case 35674:S$s.fun=this._uinformMatrix2fv;break;case 35675:S$s.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},S$m._attribute=function(S$a,S$m){var S$s=S$V.mainContext,S$P=S$B._enableAtributes,S$_=S$a.location;return S$P[S$_]||S$s.enableVertexAttribArray(S$_),S$s.vertexAttribPointer(S$_,S$m[0],S$m[1],S$m[2],S$m[3],S$m[4]),S$P[S$_]=S$B._bindVertexBuffer,1},S$m._uniform1f=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m?(S$V.mainContext.uniform1f(S$a.location,S$s[0]=S$m),1):0},S$m._uniform1fv=function(S$a,S$m){if(S$m.length<4){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$V.mainContext.uniform1fv(S$a.location,S$m),S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3],1):0}return S$V.mainContext.uniform1fv(S$a.location,S$m),1},S$m._uniform_vec2=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]?(S$V.mainContext.uniform2f(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1]),1):0},S$m._uniform_vec2v=function(S$a,S$m){if(S$m.length<2){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$V.mainContext.uniform2fv(S$a.location,S$m),S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3],1):0}return S$V.mainContext.uniform2fv(S$a.location,S$m),1},S$m._uniform_vec3=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]?(S$V.mainContext.uniform3f(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2]),1):0},S$m._uniform_vec3v=function(S$a,S$m){return S$V.mainContext.uniform3fv(S$a.location,S$m),1},S$m._uniform_vec4=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$V.mainContext.uniform4f(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3]),1):0},S$m._uniform_vec4v=function(S$a,S$m){return S$V.mainContext.uniform4fv(S$a.location,S$m),1},S$m._uniformMatrix2fv=function(S$a,S$m){return S$V.mainContext.uniformMatrix2fv(S$a.location,!1,S$m),1},S$m._uniformMatrix3fv=function(S$a,S$m){return S$V.mainContext.uniformMatrix3fv(S$a.location,!1,S$m),1},S$m._uniformMatrix4fv=function(S$a,S$m){return S$V.mainContext.uniformMatrix4fv(S$a.location,!1,S$m),1},S$m._uinformMatrix2fv=function(S$a,S$m){return S$V.mainContext.uniformMatrix2fv(S$a.location,!1,S$m),1},S$m._uinformMatrix3fv=function(S$a,S$m){return S$V.mainContext.uniformMatrix3fv(S$a.location,!1,S$m),1},S$m._uniform1i=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m?(S$V.mainContext.uniform1i(S$a.location,S$s[0]=S$m),1):0},S$m._uniform1iv=function(S$a,S$m){return S$V.mainContext.uniform1iv(S$a.location,S$m),1},S$m._uniform_ivec2=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]?(S$V.mainContext.uniform2i(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1]),1):0},S$m._uniform_ivec2v=function(S$a,S$m){return S$V.mainContext.uniform2iv(S$a.location,S$m),1},S$m._uniform_vec3i=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]?(S$V.mainContext.uniform3i(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2]),1):0},S$m._uniform_vec3vi=function(S$a,S$m){return S$V.mainContext.uniform3iv(S$a.location,S$m),1},S$m._uniform_vec4i=function(S$a,S$m){var S$s=S$a.uploadedValue;return S$s[0]!==S$m[0]||S$s[1]!==S$m[1]||S$s[2]!==S$m[2]||S$s[3]!==S$m[3]?(S$V.mainContext.uniform4i(S$a.location,S$s[0]=S$m[0],S$s[1]=S$m[1],S$s[2]=S$m[2],S$s[3]=S$m[3]),1):0},S$m._uniform_vec4vi=function(S$a,S$m){return S$V.mainContext.uniform4iv(S$a.location,S$m),1},S$m._uniform_sampler2D=function(S$a,S$m){var S$s=S$m.source||S$m.defaulteTexture.source,S$P=S$V.mainContext,S$_=S$a.uploadedValue;if(null!=S$_[0])return S$P.activeTexture(S$G._TEXTURES[S$_[0]]),S$s&&S$W.bindTexture(S$P,3553,S$s),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return S$_[0]=this._curActTexIndex,S$P.uniform1i(S$a.location,this._curActTexIndex),S$P.activeTexture(S$G._TEXTURES[this._curActTexIndex]),S$s&&S$W.bindTexture(S$P,3553,S$s),this._curActTexIndex++,1},S$m._uniform_samplerCube=function(S$a,S$m){var S$s=S$m.source||S$m.defaulteTexture.source,S$P=S$V.mainContext,S$_=S$a.uploadedValue;if(null!=S$_[0])return S$P.activeTexture(S$G._TEXTURES[S$_[0]]),S$s?S$W.bindTexture(S$P,34067,S$s):S$W.bindTexture(S$P,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return S$_[0]=this._curActTexIndex,S$P.uniform1i(S$a.location,this._curActTexIndex),S$P.activeTexture(S$G._TEXTURES[this._curActTexIndex]),S$s?S$W.bindTexture(S$P,34067,S$s):S$W.bindTexture(S$P,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},S$m._noSetValue=function(S$a){console.log("no....:"+S$a.name)},S$m.bind=function(){return S$s.activeShader=this,(S$s.bindShader=this).activeResource(),S$W.UseProgram(this._program)},S$m.uploadAttributes=function(S$a,S$m){for(var S$s,S$P,S$_=0,S$e=0,S$A=this._attributeParamsMap.length;S$e<S$A;S$e+=2)S$P=this._attributeParamsMap[S$e+1],null!=(S$s=S$a[this._attributeParamsMap[S$e]])&&(S$m&&S$m[S$P.name]&&S$m[S$P.name].bind(),S$_+=S$P.fun.call(this,S$P,S$s));S$U.shaderCall+=S$_},S$m.uploadAttributesX=function(S$a,S$m){for(var S$s,S$P,S$_=0,S$e=0,S$A=this._attributeParamsMap.length;S$e<S$A;S$e+=2)S$P=this._attributeParamsMap[S$e+1],null!=(S$s=S$a[this._attributeParamsMap[S$e]])&&(S$m._bind(),S$_+=S$P.fun.call(this,S$P,S$s));S$U.shaderCall+=S$_},S$m.uploadSceneUniforms=function(S$a){for(var S$m,S$s,S$P=0,S$_=0,S$e=this._sceneUniformParamsMap.length;S$_<S$e;S$_+=2)S$s=this._sceneUniformParamsMap[S$_+1],null!=(S$m=S$a[this._sceneUniformParamsMap[S$_]])&&(S$P+=S$s.fun.call(this,S$s,S$m));S$U.shaderCall+=S$P},S$m.uploadCameraUniforms=function(S$a){for(var S$m,S$s,S$P=0,S$_=0,S$e=this._cameraUniformParamsMap.length;S$_<S$e;S$_+=2)S$s=this._cameraUniformParamsMap[S$_+1],null!=(S$m=S$a[this._cameraUniformParamsMap[S$_]])&&(S$P+=S$s.fun.call(this,S$s,S$m));S$U.shaderCall+=S$P},S$m.uploadSpriteUniforms=function(S$a){for(var S$m,S$s,S$P=0,S$_=0,S$e=this._spriteUniformParamsMap.length;S$_<S$e;S$_+=2)S$s=this._spriteUniformParamsMap[S$_+1],null!=(S$m=S$a[this._spriteUniformParamsMap[S$_]])&&(S$P+=S$s.fun.call(this,S$s,S$m));S$U.shaderCall+=S$P},S$m.uploadMaterialUniforms=function(S$a){for(var S$m,S$s,S$P=0,S$_=0,S$e=this._materialUniformParamsMap.length;S$_<S$e;S$_+=2)S$s=this._materialUniformParamsMap[S$_+1],null!=(S$m=S$a[this._materialUniformParamsMap[S$_]])&&(S$P+=S$s.fun.call(this,S$s,S$m));S$U.shaderCall+=S$P},S$m.uploadRenderElementUniforms=function(S$a){for(var S$m,S$s,S$P=0,S$_=0,S$e=this._renderElementUniformParamsMap.length;S$_<S$e;S$_+=2)S$s=this._renderElementUniformParamsMap[S$_+1],null!=(S$m=S$a[this._renderElementUniformParamsMap[S$_]])&&(S$P+=S$s.fun.call(this,S$s,S$m));S$U.shaderCall+=S$P},S$G.create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){return new S$G(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j)},S$G.addInclude=function(S$a,S$m){S$c.addInclude(S$a,S$m)},S$G._createShader=function(S$a,S$m,S$s){var S$P=S$a.createShader(S$s);if(S$a.shaderSource(S$P,S$m),S$a.compileShader(S$P),S$Um.debugMode&&!S$a.getShaderParameter(S$P,35713))throw S$a.getShaderInfoLog(S$P);return S$P},S$G.PERIOD_RENDERELEMENT=0,S$G.PERIOD_MATERIAL=1,S$G.PERIOD_SPRITE=2,S$G.PERIOD_CAMERA=3,S$G.PERIOD_SCENE=4,S$G._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],S$G._count=0,S$G._preCompile=!1,S$G.extCompileFunc=null,S$G.extCompileObj=null,S$y(S$G,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new S$l}]),S$G}(),S$im=function(S$B){function S$k(){this._transformUV=null,S$k.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new S$Am(.6,.6,.6)),this._setColor(10,new S$Am(1,1,1)),this._setColor(11,new S$Bm(1,1,1,8)),this._setColor(12,new S$Am(1,1,1)),this._setColor(7,new S$Bm(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new S$Bm(1,1,0,0)),this.renderMode=1}S$Q(S$k,"laya.d3.core.material.StandardMaterial",S$B);var S$a=S$k.prototype;return S$a.disableLight=function(){this._addDisablePublicShaderDefine(S$Um.SHADERDEFINE_POINTLIGHT|S$Um.SHADERDEFINE_SPOTLIGHT|S$Um.SHADERDEFINE_DIRECTIONLIGHT)},S$a.disableFog=function(){this._addDisablePublicShaderDefine(S$Um.SHADERDEFINE_FOG)},S$a.onAsynLoaded=function(S$a,S$m,S$s){var S$P=S$m[0];if(S$P.version)S$B.prototype.onAsynLoaded.call(this,S$a,S$m,S$s);else{var S$_=S$m[1],S$e=S$P.props;for(var S$A in S$e)this[S$A]=S$e[S$A];S$k._parseStandardMaterial(S$_,this,S$P),this._endLoaded()}},S$a.cloneTo=function(S$a){S$B.prototype.cloneTo.call(this,S$a);var S$m=S$a;this._transformUV&&(S$m._transformUV=this._transformUV.clone())},S$q(0,S$a,"ambientColor",function(){return this._getColor(9)},function(S$a){this._setColor(9,S$a)}),S$q(0,S$a,"ambientTexture",function(){return this._getTexture(5)},function(S$a){S$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,S$a)}),S$q(0,S$a,"renderMode",null,function(S$a){switch(S$a){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(S$k.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(S$a)}),S$q(0,S$a,"reflectColor",function(){return this._getColor(12)},function(S$a){this._setColor(12,S$a)}),S$q(0,S$a,"tilingOffset",function(){return this._getColor(15)},function(S$a){if(S$a){var S$m=S$a.elements;1!=S$m[0]||1!=S$m[1]||0!=S$m[2]||0!=S$m[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,S$a)}),S$q(0,S$a,"albedo",function(){return this._getColor(7)},function(S$a){this._setColor(7,S$a)}),S$q(0,S$a,"diffuseColor",function(){return this._getColor(10)},function(S$a){this._setColor(10,S$a)}),S$q(0,S$a,"albedoColor",function(){return this._getColor(7)},function(S$a){this._setColor(7,S$a)}),S$q(0,S$a,"specularColor",function(){return this._getColor(11)},function(S$a){this._setColor(11,S$a)}),S$q(0,S$a,"diffuseTexture",function(){return this._getTexture(1)},function(S$a){S$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,S$a)}),S$q(0,S$a,"normalTexture",function(){return this._getTexture(2)},function(S$a){S$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,S$a)}),S$q(0,S$a,"specularTexture",function(){return this._getTexture(3)},function(S$a){S$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,S$a)}),S$q(0,S$a,"emissiveTexture",function(){return this._getTexture(4)},function(S$a){S$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,S$a)}),S$q(0,S$a,"reflectTexture",function(){return this._getTexture(6)},function(S$a){S$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,S$a)}),S$q(0,S$a,"transformUV",function(){return this._transformUV},function(S$a){this._transformUV=S$a,this._setMatrix4x4(13,S$a.matrix),S$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,S$a.matrix.elements,0)}),S$k.__init__=function(){S$k.SHADERDEFINE_DIFFUSEMAP=S$k.shaderDefines.registerDefine("DIFFUSEMAP"),S$k.SHADERDEFINE_NORMALMAP=S$k.shaderDefines.registerDefine("NORMALMAP"),S$k.SHADERDEFINE_SPECULARMAP=S$k.shaderDefines.registerDefine("SPECULARMAP"),S$k.SHADERDEFINE_EMISSIVEMAP=S$k.shaderDefines.registerDefine("EMISSIVEMAP"),S$k.SHADERDEFINE_AMBIENTMAP=S$k.shaderDefines.registerDefine("AMBIENTMAP"),S$k.SHADERDEFINE_REFLECTMAP=S$k.shaderDefines.registerDefine("REFLECTMAP"),S$k.SHADERDEFINE_UVTRANSFORM=S$k.shaderDefines.registerDefine("UVTRANSFORM"),S$k.SHADERDEFINE_TILINGOFFSET=S$k.shaderDefines.registerDefine("TILINGOFFSET"),S$k.SHADERDEFINE_ADDTIVEFOG=S$k.shaderDefines.registerDefine("ADDTIVEFOG")},S$k.load=function(S$a){return S$o.loader.create(S$a,null,null,S$k)},S$k._parseStandardMaterial=function(S$a,S$m,S$s){var S$P=S$s.customProps,S$_=S$P.ambientColor;S$m.ambientColor=new S$Am(S$_[0],S$_[1],S$_[2]);var S$e=S$P.diffuseColor;S$m.diffuseColor=new S$Am(S$e[0],S$e[1],S$e[2]);var S$A=S$P.specularColor;S$m.specularColor=new S$Bm(S$A[0],S$A[1],S$A[2],S$A[3]);var S$B=S$P.reflectColor;S$m.reflectColor=new S$Am(S$B[0],S$B[1],S$B[2]);var S$k=S$P.albedoColor;S$k&&(S$m.albedo=new S$Bm(S$k[0],S$k[1],S$k[2],S$k[3]));var S$j=S$P.diffuseTexture.texture2D;S$j&&(S$m.diffuseTexture=S$O.getRes(S$a[S$j]));var S$G=S$P.normalTexture.texture2D;S$G&&(S$m.normalTexture=S$O.getRes(S$a[S$G]));var S$y=S$P.specularTexture.texture2D;S$y&&(S$m.specularTexture=S$O.getRes(S$a[S$y]));var S$d=S$P.emissiveTexture.texture2D;S$d&&(S$m.emissiveTexture=S$O.getRes(S$a[S$d]));var S$Q=S$P.ambientTexture.texture2D;S$Q&&(S$m.ambientTexture=S$O.getRes(S$a[S$Q]));var S$q=S$P.reflectTexture.texture2D;S$q&&(S$m.reflectTexture=S$O.getRes(S$a[S$q]))},S$k.RENDERMODE_OPAQUE=1,S$k.RENDERMODE_OPAQUEDOUBLEFACE=2,S$k.RENDERMODE_CUTOUT=3,S$k.RENDERMODE_CUTOUTDOUBLEFACE=4,S$k.RENDERMODE_TRANSPARENT=13,S$k.RENDERMODE_TRANSPARENTDOUBLEFACE=14,S$k.RENDERMODE_ADDTIVE=15,S$k.RENDERMODE_ADDTIVEDOUBLEFACE=16,S$k.RENDERMODE_DEPTHREAD_TRANSPARENT=5,S$k.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,S$k.RENDERMODE_DEPTHREAD_ADDTIVE=7,S$k.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,S$k.RENDERMODE_NONDEPTH_TRANSPARENT=9,S$k.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,S$k.RENDERMODE_NONDEPTH_ADDTIVE=11,S$k.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,S$k.SHADERDEFINE_DIFFUSEMAP=0,S$k.SHADERDEFINE_NORMALMAP=0,S$k.SHADERDEFINE_SPECULARMAP=0,S$k.SHADERDEFINE_EMISSIVEMAP=0,S$k.SHADERDEFINE_AMBIENTMAP=0,S$k.SHADERDEFINE_REFLECTMAP=0,S$k.SHADERDEFINE_UVTRANSFORM=0,S$k.SHADERDEFINE_TILINGOFFSET=0,S$k.SHADERDEFINE_ADDTIVEFOG=0,S$k.DIFFUSETEXTURE=1,S$k.NORMALTEXTURE=2,S$k.SPECULARTEXTURE=3,S$k.EMISSIVETEXTURE=4,S$k.AMBIENTTEXTURE=5,S$k.REFLECTTEXTURE=6,S$k.ALBEDO=7,S$k.UVANIAGE=8,S$k.MATERIALAMBIENT=9,S$k.MATERIALDIFFUSE=10,S$k.MATERIALSPECULAR=11,S$k.MATERIALREFLECT=12,S$k.UVMATRIX=13,S$k.UVAGE=14,S$k.TILINGOFFSET=15,S$y(S$k,["defaultMaterial",function(){var S$a=new S$k;return S$a.lock=!0,this.defaultMaterial=S$a},"shaderDefines",function(){return this.shaderDefines=new S$Gm(S$Km.shaderDefines)}]),S$k}(S$Km),S$tm=function(S$a){function S$A(S$a,S$m,S$s,S$P,S$_){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===S$s&&(S$s=35044),void 0===S$P&&(S$P=!1),S$A.__super.call(this),this._indexType=S$a,this._indexCount=S$m,this._bufferUsage=S$s,this._bufferType=34963,this._canRead=S$P;var S$e;if("ushort"==S$a)this._indexTypeByteCount=2;else{if("ubyte"!=S$a)throw new Error("unidentification index type.");this._indexTypeByteCount=1}S$e=this._indexTypeByteCount*S$m,this._byteLength=S$e,this._bind(),S$B._gl.bufferData(this._bufferType,S$e,this._bufferUsage),this.uri=S$_,S$P?("ushort"==S$a?this._buffer=new Uint16Array(S$m):"ubyte"==S$a&&(this._buffer=new Uint8Array(S$m)),this.memorySize=2*S$e):this.memorySize=S$e}S$Q(S$A,"laya.d3.graphics.IndexBuffer3D",S$a);var S$m=S$A.prototype;return S$m.setData=function(S$a,S$m,S$s,S$P){void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=4294967295);var S$_=0;if("ushort"==this._indexType?(S$_=2,0===S$s&&4294967295===S$P||(S$a=new Uint16Array(S$a.buffer,S$s*S$_,S$P))):"ubyte"==this._indexType&&(S$_=1,0===S$s&&4294967295===S$P||(S$a=new Uint8Array(S$a.buffer,S$s*S$_,S$P))),this._bind(),S$B._gl.bufferSubData(this._bufferType,S$m*S$_,S$a),this._canRead)if(0!==S$m||0!==S$s||4294967295!==S$P){var S$e=this._buffer.length-S$m;S$e<S$P&&(S$P=S$e);for(var S$A=0;S$A<S$P;S$A++)this._buffer[S$m+S$A]=S$a[S$A]}else this._buffer=S$a},S$m.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},S$m.disposeResource=function(){S$a.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},S$q(0,S$m,"indexType",function(){return this._indexType}),S$q(0,S$m,"indexTypeByteCount",function(){return this._indexTypeByteCount}),S$q(0,S$m,"indexCount",function(){return this._indexCount}),S$q(0,S$m,"canRead",function(){return this._canRead}),S$A.INDEXTYPE_UBYTE="ubyte",S$A.INDEXTYPE_USHORT="ushort",S$A.create=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$s&&(S$s=35044),void 0===S$P&&(S$P=!1),new S$A(S$a,S$m,S$s,S$P,S$_)},S$A}(S$B),S$Lm=function(S$e){function S$A(S$a,S$m,S$s,S$P,S$_){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===S$P&&(S$P=!1),S$A.__super.call(this),this._vertexDeclaration=S$a,this._vertexCount=S$m,this._bufferUsage=S$s,this._bufferType=34962,this._canRead=S$P,this.uri=S$_,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*S$m,this._bind(),S$B._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),S$P&&(this._buffer=new Float32Array(this._byteLength/4))}S$Q(S$A,"laya.d3.graphics.VertexBuffer3D",S$e);var S$a=S$A.prototype;return S$a.bindWithIndexBuffer=function(S$a){S$a&&S$a._bind(),this._bind()},S$a.setData=function(S$a,S$m,S$s,S$P){if(void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=4294967295),0===S$s&&4294967295===S$P||(S$a=new Float32Array(S$a.buffer,4*S$s,S$P)),this._bind(),S$B._gl.bufferSubData(this._bufferType,4*S$m,S$a),this._canRead)if(0!==S$m||0!==S$s||4294967295!==S$P){var S$_=this._buffer.length-S$m;S$_<S$P&&(S$P=S$_);for(var S$e=0;S$e<S$P;S$e++)this._buffer[S$m+S$e]=S$a[S$e]}else this._buffer=S$a},S$a.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},S$a.disposeResource=function(){for(var S$a=S$V.mainContext,S$m=this._vertexDeclaration.getVertexElements(),S$s=S$B._enableAtributes,S$P=0,S$_=S$m.length;S$P<S$_;S$P++)S$s[S$P]===this._glBuffer&&(S$a.disableVertexAttribArray(S$P),S$s[S$P]=null);S$e.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},S$q(0,S$a,"vertexDeclaration",function(){return this._vertexDeclaration}),S$q(0,S$a,"vertexCount",function(){return this._vertexCount}),S$q(0,S$a,"canRead",function(){return this._canRead}),S$A.create=function(S$a,S$m,S$s,S$P,S$_){return void 0===S$s&&(S$s=35044),void 0===S$P&&(S$P=!1),new S$A(S$a,S$m,S$s,S$P,S$_)},S$A}(S$B),S$Rm=function(S$a){function S$c(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,S$c.__super.call(this),this._type=3553}S$Q(S$c,"laya.d3.resource.DataTexture2D",S$Vm);var S$m=S$c.prototype;return S$m.genDebugMipmaps=function(){var S$a=[];return S$a.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),S$a.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),S$a.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),S$a.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),S$a.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),S$a.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),S$a.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),S$a.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),S$a.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),S$a.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),S$a},S$m._onTextureLoaded=function(S$a){},S$m._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var S$a=S$V.mainContext,S$m=this._source=S$a.createTexture(),S$s=this._width,S$P=this._height,S$_=S$W.curBindTexTarget,S$e=S$W.curBindTexValue,S$A=!1;if(S$W.bindTexture(S$a,this._type,S$m),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var S$B=0;S$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var S$k=0;S$k<this._mipmaps.length;S$k++){if(this._mipmaps[S$k].byteLength!=S$j*S$G*4)throw"mipmap size error  level:"+S$k;S$a.texSubImage2D(this._type,0,S$c.simLodRect[S$B++],S$c.simLodRect[S$B++],S$c.simLodRect[S$B++],S$c.simLodRect[S$B++],6408,5121,new Uint8Array(this._mipmaps[S$k]))}this.minFifter=9729,this.magFifter=9729}else{var S$j=this._width,S$G=this._height;for(S$B=0,S$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),S$k=0;S$k<this._mipmaps.length;S$k++){if(this._mipmaps[S$k].byteLength!=S$j*S$G*4)throw"mipmap size error  level:"+S$k;S$a.texImage2D(this._type,S$k,6408,S$j,S$G,0,6408,5121,new Uint8Array(this._mipmaps[S$k])),(S$j/=2)<1&&(S$j=1),(S$G/=2)<1&&(S$G=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&S$a.pixelStorei(S$a.UNPACK_ALIGNMENT,1),S$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var S$y=0,S$d=!1,S$Q=!1;this._buffer.byteLength==4*S$s*S$P?(S$y=6408,S$d=!0):this._buffer.byteLength==3*S$s*S$P?(S$y=6407,S$Q=!0):S$y=this._format,S$d||S$Q?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),S$Q&&S$a.pixelStorei(S$a.UNPACK_ALIGNMENT,1),S$a.texImage2D(this._type,0,S$y,S$s,S$P,0,S$y,5121,this._buffer)):S$a&&S$y==S$a.ALPHA?(S$a.texImage2D(3553,0,S$y,S$s,S$P,0,S$y,S$a.UNSIGNED_BYTE,this._buffer),S$A=!0):0!=S$y&&(S$a.compressedTexImage2D(3553,0,S$y,S$s,S$P,0,this._buffer),S$A=!0)}var S$q=this._minFifter,S$h=this._magFifter,S$u=0==this._wrapModeU?10497:33071,S$O=0==this._wrapModeV?10497:33071,S$p=S$H.isPOT(S$s,S$P);S$p?(this._mipmap||this._mipmaps?-1!==S$q||(S$q=9987):-1!==S$q||(S$q=9729),-1!==S$h||(S$h=9729),S$a.texParameteri(this._type,10241,S$q),S$a.texParameteri(this._type,10240,S$h),S$a.texParameteri(this._type,10242,S$u),S$a.texParameteri(this._type,10243,S$O),this._mipmap&&S$a.generateMipmap(this._type)):(-1!==S$q||(S$q=9729),-1!==S$h||(S$h=9729),S$a.texParameteri(this._type,10241,S$q),S$a.texParameteri(this._type,10240,S$h),S$a.texParameteri(this._type,10242,33071),S$a.texParameteri(this._type,10243,33071)),S$_&&S$e&&S$W.bindTexture(S$a,S$_,S$e),this.memorySize=S$A?this._buffer.length:S$p?S$s*S$P*4*(1+1/3):S$s*S$P*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},S$m.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},S$m.onAsynLoaded=function(S$a,S$m,S$s){var S$P;S$s&&(S$P=S$s[0].call(this,S$m)),S$P&&(this._width=S$P.width,this._height=S$P.height,this._buffer=S$P.data),this._src=S$a,this._size=new S$hm(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},S$m.getPixels=function(){return new Uint8Array(this._buffer)},S$m.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(S$V.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},S$q(0,S$m,"src",function(){return this._src}),S$c.create=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){if(void 0===S$P&&(S$P=9729),void 0===S$_&&(S$_=9729),void 0===S$e&&(S$e=!0),!S$a||S$a.byteLength<S$m*S$s*4)throw"DataTexture2D create error";var S$B=new S$c;return S$B.uri=S$A,S$B._buffer=S$a,S$B._width=S$m,S$B._height=S$s,S$B._mipmap=S$e,S$B._magFifter=S$P,S$B._minFifter=S$_,S$B._size=new S$hm(S$B._width,S$B._height),S$B._conchTexture?alert("怎么给runtime传递datatexture数据"):S$B.activeResource(),S$B},S$c.load=function(S$a,S$m,S$s,S$P,S$_){if(void 0===S$m&&(S$m=0),void 0===S$s&&(S$s=0),void 0===S$P&&(S$P=9729),void 0===S$_&&(S$_=9729),"mipmaps"===S$C.getFileExtension(S$a)){var S$e=S$o.loader.create(S$a,null,null,S$c,[function(S$a){this._mipmaps=[];var S$m=new Uint32Array(S$a);this._width=S$m[0];var S$s=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,S$s=1024),this._width!=S$s)throw"现在只支持512x256的环境贴图。当前的是"+S$m[0];this._height=S$m[1];for(var S$P=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,S$_=this._height,S$e=8;;){var S$A=S$P*S$_*4;if(S$e+S$A>S$a.byteLength)throw"load mipmaps data size error ";var S$B=new Uint8Array(S$a,S$e,S$A);if(this._mipmaps.push(S$B),S$e+=S$A,1==S$P&&1==S$_)break;(S$P/=2)<1&&(S$P=1),(S$_/=2)<1&&(S$_=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){S$e.simLodInfo=new Float32Array(40);for(var S$A=0;S$A<S$e.simLodInfo.length;)S$e.simLodInfo[S$A]=(S$c.simLodRect[S$A]+.5)/1024,S$A++,S$e.simLodInfo[S$A]=(S$c.simLodRect[S$A]+.5)/256,S$A++,S$e.simLodInfo[S$A]=Math.max(S$c.simLodRect[S$A]-1,.1)/1024,S$A++,S$e.simLodInfo[S$A]=Math.max(S$c.simLodRect[S$A]-1.5,.1)/256,S$A++}return S$e}if("number"==typeof S$m)return S$o.loader.create(S$a,null,null,S$c,[function(S$a){return this._width=S$m,this._height=S$s,this._buffer=S$a,null}]);if("function"==typeof S$m)return S$o.loader.create(S$a,null,null,S$c,[S$m]);throw new Error("unknown params.")},S$c.lodasatlas=!1,S$y(S$c,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),S$c}(),S$Fm=function(S$a){function S$m(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,S$m.__super.call(this)}S$Q(S$m,"laya.d3.resource.models.PrimitiveMesh",S$Wm);var S$s=S$m.prototype;return S$o.imps(S$s,{"laya.d3.core.render.IRenderable":!0}),S$s._getVertexBuffer=function(S$a){return void 0===S$a&&(S$a=0),0===S$a?this._vertexBuffer:null},S$s._getVertexBuffers=function(){return null},S$s._getIndexBuffer=function(){return this._indexBuffer},S$s._getPositions=function(){var S$a,S$m=[],S$s=this._vertexBuffer.vertexDeclaration.getVertexElements(),S$P=0;for(S$P=0;S$P<S$s.length;S$P++){var S$_=S$s[S$P];if("vector3"===S$_.elementFormat&&0===S$_.elementUsage){S$a=S$_;break}}var S$e=this._vertexBuffer.getData();for(S$P=0;S$P<S$e.length;S$P+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var S$A=S$P+S$a.offset/4,S$B=new S$Am(S$e[S$A+0],S$e[S$A+1],S$e[S$A+2]);S$m.push(S$B)}return S$m},S$s.getRenderElement=function(S$a){return this},S$s.getRenderElementsCount=function(){return 1},S$s.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},S$s._beforeRender=function(S$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},S$s._render=function(S$a){S$V.mainContext.drawElements(4,this._numberIndices,5123,0),S$U.drawCall++,S$U.trianglesFaces+=this._numberIndices/3},S$q(0,S$s,"_vertexBufferCount",function(){return 1}),S$q(0,S$s,"triangleCount",function(){return this._indexBuffer.indexCount/3}),S$m}(),S$xm=function(S$a){function S$m(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,S$m.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}S$Q(S$m,"laya.d3.resource.models.Mesh",S$Wm);var S$s=S$m.prototype;return S$s._getPositions=function(){var S$a,S$m,S$s,S$P,S$_,S$e=[],S$A=0,S$B=0,S$k=0;if(0!==this._vertexBuffers.length){var S$j=this._vertexBuffers.length;for(S$A=0;S$A<S$j;S$A++){for(S$s=(S$a=this._vertexBuffers[S$A]).vertexDeclaration.getVertexElements(),S$B=0;S$B<S$s.length;S$B++)if("vector3"===(S$P=S$s[S$B]).elementFormat&&0===S$P.elementUsage){S$m=S$P;break}for(S$_=S$a.getData(),S$B=0;S$B<S$_.length;S$B+=S$a.vertexDeclaration.vertexStride/4)S$k=S$B+S$m.offset/4,S$e.push(new S$Am(S$_[S$k+0],S$_[S$k+1],S$_[S$k+2]))}}else{var S$G=this._subMeshes.length;for(S$A=0;S$A<S$G;S$A++){for(S$s=(S$a=this._subMeshes[S$A]._getVertexBuffer()).vertexDeclaration.getVertexElements(),S$B=0;S$B<S$s.length;S$B++)if("vector3"===(S$P=S$s[S$B]).elementFormat&&0===S$P.elementUsage){S$m=S$P;break}for(S$_=S$a.getData(),S$B=0;S$B<S$_.length;S$B+=S$a.vertexDeclaration.vertexStride/4)S$k=S$B+S$m.offset/4,S$e.push(new S$Am(S$_[S$k+0],S$_[S$k+1],S$_[S$k+2]))}}return S$e},S$s._setSubMeshes=function(S$a){this._subMeshes=S$a,this._subMeshCount=S$a.length;for(var S$m=0;S$m<this._subMeshCount;S$m++)S$a[S$m]._indexInMesh=S$m;this._positions=this._getPositions(),this._generateBoundingObject()},S$s.onAsynLoaded=function(S$a,S$m,S$s){var S$P=S$m[0],S$_=S$m[1];S$Ya.read(S$P,this,this._materials,this._subMeshes,S$_),this.completeCreate(),this._endLoaded()},S$s.getSubMesh=function(S$a){return this._subMeshes[S$a]},S$s.getSubMeshCount=function(){return this._subMeshes.length},S$s.getRenderElementsCount=function(){return this._subMeshes.length},S$s.getRenderElement=function(S$a){return this._subMeshes[S$a]},S$s.disposeResource=function(){for(var S$a=0;S$a<this._subMeshes.length;S$a++)this._subMeshes[S$a].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},S$q(0,S$s,"materials",function(){return this._materials.slice()}),S$q(0,S$s,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),S$m.load=function(S$a){return S$o.loader.create(S$a,null,null,S$m)},S$m}(),S$Mm=(function(S$a){function S$j(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===S$s&&(S$s=6408),void 0===S$P&&(S$P=5121),void 0===S$_&&(S$_=33189),void 0===S$e&&(S$e=!1),void 0===S$A&&(S$A=!1),void 0===S$B&&(S$B=-1),void 0===S$k&&(S$k=-1),S$j.__super.call(this),this._type=3553,this._width=S$a,this._height=S$m,this._size=new S$hm(S$a,S$m),this._surfaceFormat=S$s,this._surfaceType=S$P,this._depthStencilFormat=S$_,S$h.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=S$e,this._repeat=S$A,this._minFifter=S$B,this._magFifter=S$k,this.activeResource(),this._alreadyResolved=!0}S$Q(S$j,"laya.d3.resource.RenderTexture",S$Vm);var S$m=S$j.prototype;S$m.recreateResource=function(){var S$a=S$V.mainContext;this._frameBuffer=S$a.createFramebuffer(),this._source=S$a.createTexture();var S$m=S$W.curBindTexTarget,S$s=S$W.curBindTexValue;S$W.bindTexture(S$a,this._type,this._source),S$a.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var S$P=this._minFifter,S$_=this._magFifter,S$e=this._repeat?10497:33071;if(S$H.isPOT(this._width,this._height)?(this._mipmap?-1!==S$P||(S$P=9987):-1!==S$P||(S$P=9729),-1!==S$_||(S$_=9729),S$a.texParameteri(this._type,10241,S$P),S$a.texParameteri(this._type,10240,S$_),S$a.texParameteri(this._type,10242,S$e),S$a.texParameteri(this._type,10243,S$e),this._mipmap&&S$a.generateMipmap(this._type)):(-1!==S$P||(S$P=9729),-1!==S$_||(S$_=9729),S$a.texParameteri(this._type,10241,S$P),S$a.texParameteri(this._type,10240,S$_),S$a.texParameteri(this._type,10242,33071),S$a.texParameteri(this._type,10243,33071)),S$m&&S$s&&S$W.bindTexture(S$a,S$m,S$s),S$a.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=S$a.createRenderbuffer(),S$a.bindRenderbuffer(36161,this._depthStencilBuffer),S$a.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),S$a.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:S$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:S$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:S$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}S$a.framebufferTexture2D(36160,36064,3553,this._source,0),S$a.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},S$m.start=function(){S$V.mainContext.bindFramebuffer(36160,this.frameBuffer),(S$j._currentRenderTarget=this)._alreadyResolved=!1},S$m.end=function(){S$V.mainContext.bindFramebuffer(36160,null),S$j._currentRenderTarget=null,this._alreadyResolved=!0},S$m.getData=function(S$a,S$m,S$s,S$P){var S$_=S$V.mainContext;if(S$_.bindFramebuffer(36160,this._frameBuffer),!(36053===S$_.checkFramebufferStatus(36160)))return S$_.bindFramebuffer(36160,null),null;var S$e=new Uint8Array(this._width*this._height*4);return S$_.readPixels(S$a,S$m,S$s,S$P,this._surfaceFormat,this._surfaceType,S$e),S$_.bindFramebuffer(36160,null),S$e},S$m.disposeResource=function(){if(this._frameBuffer){var S$a=S$V.mainContext;S$a.deleteTexture(this._source),S$a.deleteFramebuffer(this._frameBuffer),S$a.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},S$q(0,S$m,"surfaceFormat",function(){return this._surfaceFormat}),S$q(0,S$m,"surfaceType",function(){return this._surfaceType}),S$q(0,S$m,"depthStencilFormat",function(){return this._depthStencilFormat}),S$q(0,S$m,"source",function(){return this._alreadyResolved?S$o.superGet(S$Vm,this,"source"):null}),S$q(0,S$m,"depthStencilBuffer",function(){return this._depthStencilBuffer}),S$q(0,S$m,"frameBuffer",function(){return this._frameBuffer}),S$j._currentRenderTarget=null}(),function(S$a){function S$m(S$a){this._color=null,this._pixels=null,S$m.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new S$hm(this.width,this.height),this._color=S$a,this._pixels=new Uint8Array([255*S$a.x,255*S$a.y,255*S$a.z,255*S$a.w]),this.uri="SolidColorTexture2D_"+this.id}S$Q(S$m,"laya.d3.resource.SolidColorTexture2D",S$Vm);var S$s=S$m.prototype;return S$s._createWebGlTexture=function(){var S$a=S$V.mainContext,S$m=this._source=S$a.createTexture(),S$s=this._width,S$P=this._height,S$_=S$W.curBindTexTarget,S$e=S$W.curBindTexValue;S$W.bindTexture(S$a,this._type,S$m),S$a.texImage2D(this._type,0,6408,S$s,S$P,0,6408,5121,this._pixels);var S$A=this._minFifter,S$B=this._magFifter,S$k=this._repeat?10497:33071,S$j=S$H.isPOT(S$s,S$P);S$j?(this._mipmap?-1!==S$A||(S$A=9987):-1!==S$A||(S$A=9729),-1!==S$B||(S$B=9729),S$a.texParameteri(this._type,10241,S$A),S$a.texParameteri(this._type,10240,S$B),S$a.texParameteri(this._type,10242,S$k),S$a.texParameteri(this._type,10243,S$k),this._mipmap&&S$a.generateMipmap(this._type)):(-1!==S$A||(S$A=9729),-1!==S$B||(S$B=9729),S$a.texParameteri(this._type,10241,S$A),S$a.texParameteri(this._type,10240,S$B),S$a.texParameteri(this._type,10242,33071),S$a.texParameteri(this._type,10243,33071)),S$_&&S$e&&S$W.bindTexture(S$a,S$_,S$e),this.memorySize=S$j?S$s*S$P*4*(1+1/3):S$s*S$P*4},S$s.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},S$s.disposeResource=function(){this._source&&(S$V.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},S$y(S$m,["magentaTexture",function(){var S$a=new S$m(new S$Bm(1,0,1,1));return S$a.lock=!0,this.magentaTexture=S$a},"grayTexture",function(){var S$a=new S$m(new S$Bm(.5,.5,.5,1));return S$a.lock=!0,this.grayTexture=S$a}]),S$m}()),S$Jm=function(S$a){function S$_(S$a,S$m,S$s,S$P){this._canRead=!1,this._image=null,this._pixels=null,void 0===S$a&&(S$a=!1),void 0===S$m&&(S$m=!0),void 0===S$s&&(S$s=6408),void 0===S$P&&(S$P=!0),S$_.__super.call(this),this._type=3553,this._repeat=S$m,this._canRead=S$a,this._format=S$s,this._mipmap=S$P}S$Q(S$_,"laya.d3.resource.Texture2D",S$Vm);var S$m=S$_.prototype;return S$m._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var S$a=S$V.mainContext,S$m=this._source=S$a.createTexture(),S$s=this._width,S$P=this._height,S$_=S$W.curBindTexTarget,S$e=S$W.curBindTexValue;switch(S$W.bindTexture(S$a,this._type,S$m),this._format){case 6407:case 6408:this._canRead?S$a.texImage2D(this._type,0,this._format,S$s,S$P,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?S$a.texImage2D(this._type,0,this._image._format,S$s,S$P,0,this._image._format,5121,this._image.atlasSource):S$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case S$V.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:S$a.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var S$A=this._minFifter,S$B=this._magFifter,S$k=this._repeat?10497:33071,S$j=0==this._wrapModeU?10497:33071,S$G=0==this._wrapModeV?10497:33071,S$y=S$H.isPOT(S$s,S$P);S$y?(this._mipmap?-1!==S$A||(S$A=9987):-1!==S$A||(S$A=9729),-1!==S$B||(S$B=9729),S$a.texParameteri(this._type,10241,S$A),S$a.texParameteri(this._type,10240,S$B),S$a.texParameteri(this._type,10242,S$k),S$a.texParameteri(this._type,10243,S$k),S$a.texParameteri(this._type,10242,S$j),S$a.texParameteri(this._type,10243,S$G),this._mipmap&&S$a.generateMipmap(this._type)):(-1!==S$A||(S$A=9729),-1!==S$B||(S$B=9729),S$a.texParameteri(this._type,10241,S$A),S$a.texParameteri(this._type,10240,S$B),S$a.texParameteri(this._type,10242,33071),S$a.texParameteri(this._type,10243,33071)),S$_&&S$e&&S$W.bindTexture(S$a,S$_,S$e),this._image.onload=null,this._image=null,this.memorySize=S$y?S$s*S$P*4*(1+1/3):S$s*S$P*4},S$m.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},S$m.onAsynLoaded=function(S$a,S$m,S$s){if(S$s){var S$P=S$s[0];void 0!==S$P&&(this._canRead=S$P);var S$_=S$s[1];void 0!==S$_&&(this._repeat=S$_);var S$e=S$s[2];void 0!==S$e&&(this._format=S$e);var S$A=S$s[3];void 0!==S$A&&(this._mipmap=S$A);var S$B=S$s.wrapModeU;void 0!==S$B&&(this._wrapModeU=S$B);var S$k=S$s.wrapModeV;void 0!==S$k&&(this._wrapModeV=S$k)}switch(this._format){case 6407:case 6408:var S$j=(this._image=S$m).width,S$G=S$m.height;this._width=S$j,this._height=S$G,this._size=new S$hm(S$j,S$G),this._canRead&&(S$h.isConchApp?S$m instanceof S$d.HTMLElement&&(this._pixels=new Uint8Array(S$m.getImageData(0,0,S$j,S$G))):(S$b.canvas.size(S$j,S$G),S$b.canvas.clear(),S$b.context.drawImage(S$m,0,0,S$j,S$G),this._pixels=new Uint8Array(S$b.context.getImageData(0,0,S$j,S$G).data.buffer)));break;case S$V.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var S$y=new S$N(S$m);S$y.readUTFBytes(4),S$y.readUTFBytes(2),S$y.getInt16();S$y.endian="bigEndian",this._width=S$y.getInt16(),this._height=S$y.getInt16(),this._size=new S$hm(this._width,this._height);S$y.getInt16(),S$y.getInt16();this._image=new Uint8Array(S$m,S$y.pos)}this.recreateResource(),this._endLoaded()},S$m.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},S$m.disposeResource=function(){this._source&&(S$V.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},S$q(0,S$m,"_src",function(){return this.url}),S$q(0,S$m,"src",function(){return this.url}),S$_.load=function(S$a){return S$o.loader.create(S$a,null,null,S$_)},S$_}(),S$Dm=function(S$m){function S$s(S$a,S$m){S$s.__super.call(this),void 0===S$a&&(S$a=.3),void 0===S$m&&(S$m=1e3),this._tempVector3=new S$Am,this._position=new S$Am,this._up=new S$Am,this._forward=new S$Am,this._right=new S$Am,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=S$hm.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=S$a,this._farPlane=S$m,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),S$o.stage.on("resize",this,this._onScreenSizeChanged)}S$Q(S$s,"laya.d3.core.BaseCamera",S$m);var S$a=S$s.prototype;return S$a._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var S$a=this.scene._cameraPool,S$m=S$a.length-1,S$s=0;S$s<S$m;S$s++)if(S$a[S$s].renderingOrder>S$a[S$m].renderingOrder){var S$P=S$a[S$s];S$a[S$s]=S$a[S$m],S$a[S$m]=S$P}},S$a._calculateProjectionMatrix=function(){},S$a._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},S$a._prepareCameraToRender=function(){S$S._currentCameraCullingMask=this.cullingMask;var S$a=this._shaderValues;S$a.setValue(0,this.transform.position.elements),S$a.setValue(5,this.forward.elements),S$a.setValue(6,this.up.elements)},S$a._prepareCameraViewProject=function(S$a,S$m){var S$s=this._shaderValues;S$s.setValue(1,S$a.elements),S$s.setValue(2,S$m.elements)},S$a._renderCamera=function(S$a,S$m,S$s){},S$a.addLayer=function(S$a){29!==S$a.number&&30!=S$a.number&&(this.cullingMask=this.cullingMask|S$a.mask)},S$a.removeLayer=function(S$a){29!==S$a.number&&30!=S$a.number&&(this.cullingMask=this.cullingMask&~S$a.mask)},S$a.addAllLayers=function(){this.cullingMask=2147483647},S$a.removeAllLayers=function(){this.cullingMask=0|S$S.getLayerByNumber(29).mask|S$S.getLayerByNumber(30).mask},S$a.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},S$a.moveForward=function(S$a){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=S$a,this.transform.translate(this._tempVector3)},S$a.moveRight=function(S$a){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=S$a,this.transform.translate(this._tempVector3)},S$a.moveVertical=function(S$a){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=S$a,this.transform.translate(this._tempVector3,!1)},S$a._addSelfRenderObjects=function(){var S$a=this.scene._cameraPool,S$m=S$a.length;if(0<S$m){for(var S$s=S$m-1;0<=S$s;S$s--)if(this.renderingOrder<=S$a[S$s].renderingOrder){S$a.splice(S$s+1,0,this);break}}else S$a.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},S$a._clearSelfRenderObjects=function(){var S$a=this.scene._cameraPool;S$a.splice(S$a.indexOf(this),1)},S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,S$o.stage.off("resize",this,this._onScreenSizeChanged),S$m.prototype.destroy.call(this,S$a)},S$q(0,S$a,"sky",function(){return this._sky},function(S$a){(this._sky=S$a)._ownerCamera=this}),S$q(0,S$a,"forward",function(){var S$a=this.transform.worldMatrix.elements,S$m=this._forward.elements;return S$m[0]=-S$a[8],S$m[1]=-S$a[9],S$m[2]=-S$a[10],this._forward}),S$q(0,S$a,"position",function(){var S$a=this.transform.worldMatrix.elements,S$m=this._position.elements;return S$m[0]=S$a[12],S$m[1]=S$a[13],S$m[2]=S$a[14],this._position}),S$q(0,S$a,"renderTarget",function(){return this._renderTarget},function(S$a){null!=(this._renderTarget=S$a)&&(this._renderTargetSize=S$a.size)}),S$q(0,S$a,"up",function(){var S$a=this.transform.worldMatrix.elements,S$m=this._up.elements;return S$m[0]=S$a[4],S$m[1]=S$a[5],S$m[2]=S$a[6],this._up}),S$q(0,S$a,"right",function(){var S$a=this.transform.worldMatrix.elements,S$m=this._right.elements;return S$m[0]=S$a[0],S$m[1]=S$a[1],S$m[2]=S$a[2],this._right}),S$q(0,S$a,"renderTargetSize",function(){return this._renderTargetSize},function(S$a){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=S$a,this._calculateProjectionMatrix()}),S$q(0,S$a,"fieldOfView",function(){return this._fieldOfView},function(S$a){this._fieldOfView=S$a,this._calculateProjectionMatrix()}),S$q(0,S$a,"nearPlane",function(){return this._nearPlane},function(S$a){this._nearPlane=S$a,this._calculateProjectionMatrix()}),S$q(0,S$a,"farPlane",function(){return this._farPlane},function(S$a){this._farPlane=S$a,this._calculateProjectionMatrix()}),S$q(0,S$a,"orthographic",function(){return this._orthographic},function(S$a){this._orthographic=S$a,this._calculateProjectionMatrix()}),S$q(0,S$a,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(S$a){this._orthographicVerticalSize=S$a,this._calculateProjectionMatrix()}),S$q(0,S$a,"renderingOrder",function(){return this._renderingOrder},function(S$a){this._renderingOrder=S$a,this._sortCamerasByRenderingOrder()}),S$s.CAMERAPOS=0,S$s.VIEWMATRIX=1,S$s.PROJECTMATRIX=2,S$s.VPMATRIX=3,S$s.VPMATRIX_NO_TRANSLATE=4,S$s.CAMERADIRECTION=5,S$s.CAMERAUP=6,S$s.ENVIRONMENTDIFFUSE=7,S$s.ENVIRONMENTSPECULAR=8,S$s.SIMLODINFO=9,S$s.DIFFUSEIRRADMATR=10,S$s.DIFFUSEIRRADMATG=11,S$s.DIFFUSEIRRADMATB=12,S$s.HDREXPOSURE=13,S$s.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",S$s.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",S$s.CLEARFLAG_SOLIDCOLOR=0,S$s.CLEARFLAG_SKY=1,S$s.CLEARFLAG_DEPTHONLY=2,S$s.CLEARFLAG_NONE=3,S$y(S$s,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new S$am(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new S$am},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new S$am}]),S$s}(S$Xm),S$gm=function(S$s){function S$m(S$a){this._render=null,this._geometryFilter=null,S$m.__super.call(this,S$a)}S$Q(S$m,"laya.d3.core.RenderableSprite3D",S$s);var S$a=S$m.prototype;return S$a._addToInitStaticBatchManager=function(){},S$a._setBelongScene=function(S$a){S$s.prototype._setBelongScene.call(this,S$a),S$a._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},S$a._setUnBelongScene=function(){var S$a=this._scene._renderableSprite3Ds,S$m=S$a.indexOf(this);S$a.splice(S$m,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),S$s.prototype._setUnBelongScene.call(this)},S$a._update=function(S$a){(S$a.owner=this)._activeInHierarchy&&(this._updateComponents(S$a),this._render._updateOctreeNode(),this._lateUpdateComponents(S$a),S$U.spriteCount++,this._childs.length&&this._updateChilds(S$a))},S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$s.prototype.destroy.call(this,S$a),this._render._destroy(),this._render=null},S$m.__init__=function(){S$m.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=S$m.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),S$m.SAHDERDEFINE_LIGHTMAP=S$m.shaderDefines.registerDefine("LIGHTMAP")},S$m.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,S$m.SAHDERDEFINE_LIGHTMAP=4,S$m.LIGHTMAPSCALEOFFSET=2,S$m.LIGHTMAP=3,S$y(S$m,["shaderDefines",function(){return this.shaderDefines=new S$Gm}]),S$m}(S$Xm),S$wm=(function(S$a){function S$P(S$a,S$m,S$s){this._long=NaN,this._width=NaN,this._height=NaN,void 0===S$a&&(S$a=1),void 0===S$m&&(S$m=1),void 0===S$s&&(S$s=1),S$P.__super.call(this),this._long=S$a,this._width=S$m,this._height=S$s,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}S$Q(S$P,"laya.d3.resource.models.BoxMesh",S$Fm);var S$m=S$P.prototype;S$m.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var S$a=S$Va.vertexDeclaration,S$m=(S$a.vertexStride,this._long/2),S$s=this._height/2,S$P=this._width/2,S$_=new Float32Array([-S$m,S$s,-S$P,0,1,0,0,0,S$m,S$s,-S$P,0,1,0,1,0,S$m,S$s,S$P,0,1,0,1,1,-S$m,S$s,S$P,0,1,0,0,1,-S$m,-S$s,-S$P,0,-1,0,0,1,S$m,-S$s,-S$P,0,-1,0,1,1,S$m,-S$s,S$P,0,-1,0,1,0,-S$m,-S$s,S$P,0,-1,0,0,0,-S$m,S$s,-S$P,-1,0,0,0,0,-S$m,S$s,S$P,-1,0,0,1,0,-S$m,-S$s,S$P,-1,0,0,1,1,-S$m,-S$s,-S$P,-1,0,0,0,1,S$m,S$s,-S$P,1,0,0,1,0,S$m,S$s,S$P,1,0,0,0,0,S$m,-S$s,S$P,1,0,0,0,1,S$m,-S$s,-S$P,1,0,0,1,1,-S$m,S$s,S$P,0,0,1,0,0,S$m,S$s,S$P,0,0,1,1,0,S$m,-S$s,S$P,0,0,1,1,1,-S$m,-S$s,S$P,0,0,1,0,1,-S$m,S$s,-S$P,0,0,-1,1,0,S$m,S$s,-S$P,0,0,-1,0,0,S$m,-S$s,-S$P,0,0,-1,0,1,-S$m,-S$s,-S$P,0,0,-1,1,1]),S$e=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new S$Lm(S$a,this._numberVertices,35044,!0),this._indexBuffer=new S$tm("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(S$_),this._indexBuffer.setData(S$e),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},S$q(0,S$m,"long",function(){return this._long},function(S$a){this._long!==S$a&&(this._long=S$a,this.releaseResource(),this.activeResource())}),S$q(0,S$m,"width",function(){return this._width},function(S$a){this._width!==S$a&&(this._width=S$a,this.releaseResource(),this.activeResource())}),S$q(0,S$m,"height",function(){return this._height},function(S$a){this._height!==S$a&&(this._height=S$a,this.releaseResource(),this.activeResource())})}(),function(S$a){function S$_(S$a,S$m,S$s,S$P){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===S$a&&(S$a=10),void 0===S$m&&(S$m=10),void 0===S$s&&(S$s=10),void 0===S$P&&(S$P=10),S$_.__super.call(this),this._long=S$a,this._width=S$m,this._stacks=S$s,this._slices=S$P,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}S$Q(S$_,"laya.d3.resource.models.PlaneMesh",S$Fm);var S$m=S$_.prototype;S$m.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var S$a=new Uint16Array(this._numberIndices),S$m=S$Va.vertexDeclaration,S$s=S$m.vertexStride/4,S$P=new Float32Array(this._numberVertices*S$s),S$_=this._long/2,S$e=this._width/2,S$A=this._long/this._stacks,S$B=this._width/this._slices,S$k=0,S$j=0;S$j<=this._slices;S$j++)for(var S$G=0;S$G<=this._stacks;S$G++)S$P[S$k++]=S$G*S$A-S$_,S$P[S$k++]=0,S$P[S$k++]=S$j*S$B-S$e,S$P[S$k++]=0,S$P[S$k++]=1,S$P[S$k++]=0,S$P[S$k++]=1*S$G/this._stacks,S$P[S$k++]=1*S$j/this._slices;var S$y=0;for(S$j=0;S$j<this._slices;S$j++)for(S$G=0;S$G<this._stacks;S$G++)S$a[S$y++]=(S$j+1)*(this._stacks+1)+S$G,S$a[S$y++]=S$j*(this._stacks+1)+S$G,S$a[S$y++]=(S$j+1)*(this._stacks+1)+S$G+1,S$a[S$y++]=S$j*(this._stacks+1)+S$G,S$a[S$y++]=S$j*(this._stacks+1)+S$G+1,S$a[S$y++]=(S$j+1)*(this._stacks+1)+S$G+1;this._vertexBuffer=new S$Lm(S$m,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new S$tm("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(S$P),this._indexBuffer.setData(S$a),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},S$q(0,S$m,"long",function(){return this._long},function(S$a){this._long!==S$a&&(this._long=S$a,this.releaseResource(),this.activeResource())}),S$q(0,S$m,"width",function(){return this._width},function(S$a){this._width!==S$a&&(this._width=S$a,this.releaseResource(),this.activeResource())}),S$q(0,S$m,"stacks",function(){return this._stacks},function(S$a){this._stacks!==S$a&&(this._stacks=S$a,this.releaseResource(),this.activeResource())}),S$q(0,S$m,"slices",function(){return this._slices},function(S$a){this._slices!==S$a&&(this._slices=S$a,this.releaseResource(),this.activeResource())})}(),function(S$a){function S$A(S$a,S$m,S$s){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=.3),void 0===S$s&&(S$s=1e3),this._viewMatrix=new S$am,this._projectionMatrix=new S$am,this._projectionViewMatrix=new S$am,this._viewport=new S$km(0,0,0,0),this._normalizedViewport=new S$km(0,0,1,1),this._aspectRatio=S$a,this._boundFrustumUpdate=!0,this._boundFrustum=new S$Ia(S$am.DEFAULT),S$A.__super.call(this,S$m,S$s),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}S$Q(S$A,"laya.d3.core.Camera",S$Dm);var S$m=S$A.prototype;return S$m._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},S$m._parseCustomProps=function(S$a,S$m,S$s,S$P){var S$_=S$s.clearColor;this.clearColor=new S$Bm(S$_[0],S$_[1],S$_[2],S$_[3]);var S$e=S$s.viewport;this.normalizedViewport=new S$km(S$e[0],S$e[1],S$e[2],S$e[3])},S$m._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var S$a=this.orthographicVerticalSize*this.aspectRatio*.5,S$m=.5*this.orthographicVerticalSize;S$am.createOrthoOffCenterRH(-S$a,S$a,-S$m,S$m,this.nearPlane,this.farPlane,this._projectionMatrix)}else S$am.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},S$m._update=function(S$a){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,S$a)},S$m._renderCamera=function(S$a,S$m,S$s){var S$P,S$_;S$s.parallelSplitShadowMaps[0]&&S$s._renderShadowMap(S$a,S$m,this),(S$m.camera=this)._prepareCameraToRender(),S$s._preRenderUpdateComponents(S$m),S$P=S$m._viewMatrix=this.viewMatrix;var S$e=this._renderTarget;S$e?(S$e.start(),S$am.multiply(S$Dm._invertYScaleMatrix,this._projectionMatrix,S$Dm._invertYProjectionMatrix),S$am.multiply(S$Dm._invertYScaleMatrix,this.projectionViewMatrix,S$Dm._invertYProjectionViewMatrix),S$_=S$m._projectionMatrix=S$Dm._invertYProjectionMatrix,S$m._projectionViewMatrix=S$Dm._invertYProjectionViewMatrix):(S$_=S$m._projectionMatrix=this._projectionMatrix,S$m._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(S$P,S$_),S$m._viewport=this.viewport,S$s._preRenderScene(S$a,S$m,this.boundFrustum),S$s._clear(S$a,S$m),S$s._renderScene(S$a,S$m),S$s._postRenderUpdateComponents(S$m),S$e&&S$e.end()},S$m.viewportPointToRay=function(S$a,S$m){S$qm.calculateCursorRay(S$a,this.viewport,this._projectionMatrix,this.viewMatrix,null,S$m)},S$m.normalizedViewportPointToRay=function(S$a,S$m){var S$s=S$A._tempVector20,S$P=this.viewport,S$_=S$a.elements,S$e=S$s.elements;S$e[0]=S$_[0]*S$P.width,S$e[1]=S$_[1]*S$P.height,S$qm.calculateCursorRay(S$s,this.viewport,this._projectionMatrix,this.viewMatrix,null,S$m)},S$m.worldToViewportPoint=function(S$a,S$m){S$am.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(S$a,this._projectionViewMatrix,S$m);var S$s=S$m.elements;S$s[0]=S$s[0]/S$o.stage.clientScaleX,S$s[1]=S$s[1]/S$o.stage.clientScaleY},S$m.worldToNormalizedViewportPoint=function(S$a,S$m){S$am.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(S$a,this._projectionViewMatrix,S$m);var S$s=S$m.elements;S$s[0]=S$s[0]/S$o.stage.clientScaleX,S$s[1]=S$s[1]/S$o.stage.clientScaleY},S$m.convertScreenCoordToOrthographicCoord=function(S$a,S$m){if(this._orthographic){var S$s=S$Y.clientWidth,S$P=S$Y.clientHeight,S$_=this.orthographicVerticalSize*this.aspectRatio/S$s,S$e=this.orthographicVerticalSize/S$P,S$A=S$a.elements,S$B=S$m.elements;return S$B[0]=(-S$s/2+S$A[0])*S$_,S$B[1]=(S$P/2-S$A[1])*S$e,S$B[2]=(this.nearPlane-this.farPlane)*(S$A[2]+1)/2-this.nearPlane,S$Am.transformCoordinate(S$m,this.transform.worldMatrix,S$m),!0}return!1},S$q(0,S$m,"projectionViewMatrix",function(){return S$am.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),S$q(0,S$m,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var S$a=this.viewport;return S$a.width/S$a.height},function(S$a){if(S$a<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=S$a,this._calculateProjectionMatrix()}),S$q(0,S$m,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),S$q(0,S$m,"needViewport",function(){var S$a=this.normalizedViewport;return 0===S$a.x&&0===S$a.y&&1===S$a.width&&1===S$a.height}),S$q(0,S$m,"viewport",function(){if(this._viewportExpressedInClipSpace){var S$a=this._normalizedViewport,S$m=this.renderTargetSize,S$s=S$m.width,S$P=S$m.height;this._viewport.x=S$a.x*S$s,this._viewport.y=S$a.y*S$P,this._viewport.width=S$a.width*S$s,this._viewport.height=S$a.height*S$P}return this._viewport},function(S$a){if(null!=this.renderTarget&&(S$a.x<0||S$a.y<0||0==S$a.width||0==S$a.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=S$a,this._calculateProjectionMatrix()}),S$q(0,S$m,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var S$a=this._viewport,S$m=this.renderTargetSize,S$s=S$m.width,S$P=S$m.height;this._normalizedViewport.x=S$a.x/S$s,this._normalizedViewport.y=S$a.y/S$P,this._normalizedViewport.width=S$a.width/S$s,this._normalizedViewport.height=S$a.height/S$P}return this._normalizedViewport},function(S$a){S$a.x<0&&(S$a.x=0,console.warn("Camera: viewport.x must large than 0.0.")),S$a.y<0&&(S$a.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<S$a.x+S$a.width&&(S$a.width=1-S$a.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<S$a.y+S$a.height&&(S$a.height=1-S$a.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=S$a,this._calculateProjectionMatrix()}),S$q(0,S$m,"projectionMatrix",function(){return this._projectionMatrix},function(S$a){this._projectionMatrix=S$a,this._useUserProjectionMatrix=!0}),S$q(0,S$m,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),S$y(S$A,["_tempVector20",function(){return this._tempVector20=new S$em}]),S$A}()),S$vm=function(S$s){function S$P(S$a,S$m){S$P.__super.call(this,S$m),this._geometryFilter=new S$bm(this),this._render=new S$Sm(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),S$a&&(this._geometryFilter.sharedMesh=S$a)instanceof laya.d3.resource.models.Mesh&&(S$a.loaded?this._render.sharedMaterials=S$a.materials:S$a.once("loaded",this,this._applyMeshMaterials))}S$Q(S$P,"laya.d3.core.MeshSprite3D",S$s);var S$a=S$P.prototype;return S$a._changeRenderObjectByMesh=function(S$a){var S$m=this._render._renderElements,S$s=S$m[S$a];S$s||(S$s=S$m[S$a]=new S$zm),S$s._render=this._render;var S$P=this._render.sharedMaterials[S$a];S$P||(S$P=S$im.defaultMaterial);var S$_=this._geometryFilter.sharedMesh.getRenderElement(S$a);return S$s._mainSortID=this._getSortID(S$_,S$P),S$s._sprite3D=this,S$s.renderObj=S$_,S$s._material=S$P,S$s},S$a._changeRenderObjectByMaterial=function(S$a,S$m){var S$s=this._render._renderElements[S$a];S$m||(S$m=S$im.defaultMaterial);var S$P=this._geometryFilter.sharedMesh.getRenderElement(S$a);return S$s._mainSortID=this._getSortID(S$P,S$m),S$s._sprite3D=this,S$s.renderObj=S$P,S$s._material=S$m,S$s},S$a._changeRenderObjectsByMesh=function(){var S$a=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=S$a;for(var S$m=0;S$m<S$a;S$m++)this._changeRenderObjectByMesh(S$m)},S$a._onMeshChanged=function(S$a){var S$m=S$a.sharedMesh;S$m.loaded?this._changeRenderObjectsByMesh():S$m.once("loaded",this,this._onMeshLoaded)},S$a._onMeshLoaded=function(S$a){S$a===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},S$a._onMaterialChanged=function(S$a,S$m,S$s){S$m<this._render._renderElements.length&&this._changeRenderObjectByMaterial(S$m,S$s)},S$a._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},S$a._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},S$a._parseCustomProps=function(S$a,S$m,S$s,S$P){var S$_=this.meshRender,S$e=S$s.lightmapIndex;null!=S$e&&(S$_.lightmapIndex=S$e);var S$A,S$B,S$k=S$s.lightmapScaleOffset;if(S$k&&(S$_.lightmapScaleOffset=new S$Bm(S$k[0],S$k[1],S$k[2],S$k[3])),S$P.instanceParams)(S$A=S$P.instanceParams.loadPath)&&(S$B=S$O.getRes(S$m[S$A]),(this.meshFilter.sharedMesh=S$B).loaded?S$_.sharedMaterials=S$B.materials:S$B.once("loaded",this,this._applyMeshMaterials));else{(S$A=S$s.meshPath)&&(S$B=S$O.getRes(S$m[S$A]),this.meshFilter.sharedMesh=S$B);var S$j=S$s.materials;if(S$j){var S$G=S$_.sharedMaterials,S$y=S$j.length;S$G.length=S$y;for(var S$d=0;S$d<S$y;S$d++)S$G[S$d]=S$O.getRes(S$m[S$j[S$d].path]);S$_.sharedMaterials=S$G}}},S$a._applyMeshMaterials=function(S$a){for(var S$m=this._render.sharedMaterials,S$s=S$a.materials,S$P=0,S$_=S$s.length;S$P<S$_;S$P++)S$m[S$P]||(S$m[S$P]=S$s[S$P]);this._render.sharedMaterials=S$m},S$a._addToInitStaticBatchManager=function(){S$P._staticBatchManager._addInitBatchSprite(this)},S$a.cloneTo=function(S$a){var S$m=S$a;S$m._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var S$s=this._render,S$P=S$m._render;S$P.enable=S$s.enable,S$P.sharedMaterials=S$s.sharedMaterials,S$P.castShadow=S$s.castShadow;var S$_=S$s.lightmapScaleOffset;S$_&&(S$P.lightmapScaleOffset=S$_.clone()),S$P.lightmapIndex=S$s.lightmapIndex,S$P.receiveShadow=S$s.receiveShadow,S$P.sortingFudge=S$s.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,S$a)},S$a.destroy=function(S$a){if(void 0===S$a&&(S$a=!0),!this.destroyed){var S$m=this.meshFilter.sharedMesh;null!=S$m&&(S$m.loaded||S$m.off("loaded",this,this._applyMeshMaterials)),S$s.prototype.destroy.call(this,S$a),this._geometryFilter._destroy()}},S$q(0,S$a,"meshFilter",function(){return this._geometryFilter}),S$q(0,S$a,"meshRender",function(){return this._render}),S$P.__init__=function(){S$Pa._staticBatchManagers.push(S$P._staticBatchManager)},S$P.load=function(S$a){return S$o.loader.create(S$a,null,null,S$P)},S$y(S$P,["_staticBatchManager",function(){return this._staticBatchManager=new S$lm}]),S$P}(S$gm)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(S$a,S$m){"use strict";for(var S$s in Object.defineProperty(S$m,"__esModule",{value:!0}),Laya){var S$P=Laya[S$s];S$P&&S$P.__isclass&&(S$m[S$s]=S$P)}}),function(S$a,S$m,S$_a){S$_a.un,S$_a.uns;var S$s=S$_a.static,S$P=S$_a.class,S$e=S$_a.getset,S$h=S$_a.__newvec,S$B=laya.maths.Bezier,S$y=laya.utils.Browser,S$Va=laya.utils.Byte,S$_=(laya.events.Event,laya.events.EventDispatcher),S$A=laya.display.Graphics,S$k=(laya.resource.HTMLCanvas,laya.utils.Handler),S$j=laya.net.Loader,S$d=laya.maths.MathUtil,S$Wa=laya.maths.Matrix,S$u=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),S$G=(laya.renders.RenderContext,laya.resource.Resource),S$Q=laya.utils.RunDriver,S$ea=laya.display.Sprite,S$q=laya.utils.Stat,S$ba=laya.resource.Texture,S$O=(laya.net.URL,laya.utils.Utils),S$W=function(){function S$a(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return S$P(S$a,"laya.ani.AnimationContent"),S$a}(),S$b=function(){function S$a(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return S$P(S$a,"laya.ani.AnimationNodeContent"),S$a}(),S$c=function(){function S$a(){}return S$P(S$a,"laya.ani.AnimationParser01"),S$a.parse=function(S$a,S$m){var S$s=S$m.__getBuffer(),S$P=0,S$_=0,S$e=0,S$A=0,S$B=0,S$k=0,S$j=0,S$G=S$m.readUTFString();S$a._aniClassName=S$G;var S$y,S$d=S$m.readUTFString().split("\n"),S$Q=S$m.getUint8(),S$q=S$m.getUint32(),S$h=S$m.getUint32();0<S$q&&(S$y=S$s.slice(S$q,S$h));var S$u=new S$Va(S$y);for(0<S$h&&(S$a._publicExtData=S$s.slice(S$h,S$s.byteLength)),S$a._useParent=!!S$m.getUint8(),S$a._anis.length=S$Q,S$P=0;S$P<S$Q;S$P++){var S$O=S$a._anis[S$P]=new S$W;S$O.nodes=new Array;var S$p=S$O.name=S$d[S$m.getUint16()];S$a._aniMap[S$p]=S$P,S$O.bone3DMap={},S$O.playTime=S$m.getFloat32(),S$O.playTime<=0&&console.error("播放时间不能为0  url="+S$a.url+" name="+S$O.name);var S$c=S$O.nodes.length=S$m.getUint8();for(S$_=S$O.totalKeyframeDatasLength=0;S$_<S$c;S$_++){var S$H=S$O.nodes[S$_]=new S$b;S$H.childs=[];var S$o=S$m.getInt16();0<=S$o&&(S$H.name=S$d[S$o],S$O.bone3DMap[S$H.name]=S$_),S$H.keyFrame=new Array,S$H.parentIndex=S$m.getInt16(),-1==S$H.parentIndex?S$H.parent=null:S$H.parent=S$O.nodes[S$H.parentIndex],S$H.lerpType=S$m.getUint8();var S$N=S$m.getUint32();S$u.pos=S$N;var S$z=S$H.keyframeWidth=S$u.getUint16();if(S$O.totalKeyframeDatasLength+=S$z,0===S$H.lerpType||1===S$H.lerpType)for(S$H.interpolationMethod=[],S$H.interpolationMethod.length=S$z,S$e=0;S$e<S$z;S$e++)S$H.interpolationMethod[S$e]=S$X.interpolation[S$u.getUint8()];null!=S$H.parent&&S$H.parent.childs.push(S$H);var S$U=S$m.getUint16();0<S$U&&(S$H.extenData=S$s.slice(S$m.pos,S$m.pos+S$U),S$m.pos+=S$U);var S$l,S$C=S$m.getUint16(),S$f=0;for(S$e=0,S$A=S$H.keyFrame.length=S$C;S$e<S$A;S$e++){if((S$l=S$H.keyFrame[S$e]=new S$S).duration=S$m.getFloat32(),S$l.startTime=S$f,2===S$H.lerpType){S$l.interpolationData=[];var S$K,S$V=S$m.getUint8();switch(S$K=S$m.getFloat32()){case 254:for(S$l.interpolationData.length=S$z,S$j=0;S$j<S$z;S$j++)S$l.interpolationData[S$j]=0;break;case 255:for(S$l.interpolationData.length=S$z,S$j=0;S$j<S$z;S$j++)S$l.interpolationData[S$j]=5;break;default:for(S$l.interpolationData.push(S$K),S$k=1;S$k<S$V;S$k++)S$l.interpolationData.push(S$m.getFloat32())}}for(S$l.data=new Float32Array(S$z),S$B=0;S$B<S$z;S$B++)S$l.data[S$B]=S$m.getFloat32(),-1e-8<S$l.data[S$B]&&S$l.data[S$B]<1e-8&&(S$l.data[S$B]=0);S$f+=S$l.duration}S$l.startTime=S$O.playTime,S$H.playTime=S$O.playTime,S$a._calculateKeyFrame(S$H,S$C,S$z)}}},S$a}(),S$H=function(){function S$o(){}return S$P(S$o,"laya.ani.AnimationParser02"),S$o.READ_DATA=function(){S$o._DATA.offset=S$o._reader.getUint32(),S$o._DATA.size=S$o._reader.getUint32()},S$o.READ_BLOCK=function(){for(var S$a=S$o._BLOCK.count=S$o._reader.getUint16(),S$m=S$o._BLOCK.blockStarts=[],S$s=S$o._BLOCK.blockLengths=[],S$P=0;S$P<S$a;S$P++)S$m.push(S$o._reader.getUint32()),S$s.push(S$o._reader.getUint32())},S$o.READ_STRINGS=function(){var S$a=S$o._reader.getUint32(),S$m=S$o._reader.getUint16(),S$s=S$o._reader.pos;S$o._reader.pos=S$a+S$o._DATA.offset;for(var S$P=0;S$P<S$m;S$P++)S$o._strings[S$P]=S$o._reader.readUTFString();S$o._reader.pos=S$s},S$o.parse=function(S$a,S$m){S$o._templet=S$a;(S$o._reader=S$m).__getBuffer();S$o.READ_DATA(),S$o.READ_BLOCK(),S$o.READ_STRINGS();for(var S$s=0,S$P=S$o._BLOCK.count;S$s<S$P;S$s++){var S$_=S$m.getUint16(),S$e=S$o._strings[S$_],S$A=S$o["READ_"+S$e];if(null==S$A)throw new Error("model file err,no this function:"+S$_+" "+S$e);S$A.call()}},S$o.READ_ANIMATIONS=function(){var S$a=S$o._reader,S$m=S$a.__getBuffer(),S$s=0,S$P=0,S$_=0,S$e=0,S$A=S$a.getUint16(),S$B=[];for(S$B.length=S$A,S$s=0;S$s<S$A;S$s++)S$B[S$s]=S$X.interpolation[S$a.getByte()];var S$k=S$a.getUint8();for(S$o._templet._anis.length=S$k,S$s=0;S$s<S$k;S$s++){var S$j=S$o._templet._anis[S$s]={};S$j.nodes=new Array;var S$G=S$j.name=S$o._strings[S$a.getUint16()];S$o._templet._aniMap[S$G]=S$s,S$j.bone3DMap={},S$j.playTime=S$a.getFloat32();var S$y=S$j.nodes.length=S$a.getInt16();for(S$P=S$j.totalKeyframeDatasLength=0;S$P<S$y;S$P++){var S$d=S$j.nodes[S$P]={};S$d.keyframeWidth=S$A,S$d.childs=[];var S$Q=S$a.getUint16();0<=S$Q&&(S$d.name=S$o._strings[S$Q],S$j.bone3DMap[S$d.name]=S$P),S$d.keyFrame=new Array,S$d.parentIndex=S$a.getInt16(),-1==S$d.parentIndex?S$d.parent=null:S$d.parent=S$j.nodes[S$d.parentIndex],S$j.totalKeyframeDatasLength+=S$A,S$d.interpolationMethod=S$B,null!=S$d.parent&&S$d.parent.childs.push(S$d);var S$q=S$a.getUint16(),S$h=null,S$u=null;for(S$_=0,S$e=S$d.keyFrame.length=S$q;S$_<S$e;S$_++){(S$h=S$d.keyFrame[S$_]={}).startTime=S$a.getFloat32(),S$u&&(S$u.duration=S$h.startTime-S$u.startTime);var S$O=S$o._DATA.offset,S$p=S$a.getUint32(),S$c=4*S$A,S$H=S$m.slice(S$O+S$p,S$O+S$p+S$c);S$h.data=new Float32Array(S$H),S$u=S$h}S$h.duration=0,S$d.playTime=S$j.playTime,S$o._templet._calculateKeyFrame(S$d,S$q,S$A)}}},S$o._templet=null,S$o._reader=null,S$o._strings=[],S$s(S$o,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),S$o}(),S$Sa=(function(){function S$a(){}S$P(S$a,"laya.ani.AnimationState"),S$a.stopped=0,S$a.paused=1,S$a.playing=2}(),function(){function S$_(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new S$ga,this.resultMatrix=new S$Wa,this._children=[]}S$P(S$_,"laya.ani.bone.Bone");var S$a=S$_.prototype;return S$a.setTempMatrix=function(S$a){this._tempMatrix=S$a;var S$m,S$s=0;for(S$s=0,S$m=this._children.length;S$s<S$m;S$s++)this._children[S$s].setTempMatrix(this._tempMatrix)},S$a.update=function(S$a){var S$m;if(this.rotation=this.transform.skX,S$a)S$m=this.resultTransform.getMatrix(),S$Wa.mul(S$m,S$a,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)S$m=this.resultTransform.getMatrix(),S$Wa.mul(S$m,this.parentBone.resultMatrix,this.resultMatrix);else{var S$s=this.parentBone,S$P=NaN,S$_=NaN,S$e=NaN,S$A=this.parentBone.resultMatrix;S$m=this.resultTransform.getMatrix();var S$B=S$A.a*S$m.tx+S$A.c*S$m.ty+S$A.tx,S$k=S$A.b*S$m.tx+S$A.d*S$m.ty+S$A.ty,S$j=new S$Wa;this.inheritRotation?(S$P=Math.atan2(S$s.resultMatrix.b,S$s.resultMatrix.a),S$_=Math.cos(S$P),S$e=Math.sin(S$P),S$j.setTo(S$_,S$e,-S$e,S$_,0,0),S$Wa.mul(this._tempMatrix,S$j,S$Wa.TEMP),S$Wa.TEMP.copyTo(S$j),S$m=this.resultTransform.getMatrix(),S$Wa.mul(S$m,S$j,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,S$m=this.resultTransform.getMatrix(),S$Wa.TEMP.identity(),S$Wa.TEMP.d=this.d,S$Wa.mul(S$m,S$Wa.TEMP,this.resultMatrix)),this.resultMatrix.tx=S$B,this.resultMatrix.ty=S$k}else(S$m=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var S$G,S$y=0;for(S$y=0,S$G=this._children.length;S$y<S$G;S$y++)this._children[S$y].update()},S$a.updateChild=function(){var S$a,S$m=0;for(S$m=0,S$a=this._children.length;S$m<S$a;S$m++)this._children[S$m].update()},S$a.setRotation=function(S$a){this._sprite&&(this._sprite.rotation=180*S$a/Math.PI)},S$a.updateDraw=function(S$a,S$m){S$_.ShowBones&&!S$_.ShowBones[this.name]||(this._sprite||(this._sprite=new S$ea,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),S$_a.stage.addChild(this._sprite)),this._sprite.x=S$a+this.resultMatrix.tx,this._sprite.y=S$m+this.resultMatrix.ty);var S$s,S$P=0;for(S$P=0,S$s=this._children.length;S$P<S$s;S$P++)this._children[S$P].updateDraw(S$a,S$m)},S$a.addChild=function(S$a){this._children.push(S$a),S$a.parentBone=this},S$a.findBone=function(S$a){if(this.name==S$a)return this;var S$m,S$s,S$P=0;for(S$P=0,S$m=this._children.length;S$P<S$m;S$P++)if(S$s=this._children[S$P].findBone(S$a))return S$s;return null},S$a.localToWorld=function(S$a){var S$m=S$a[0],S$s=S$a[1];S$a[0]=S$m*this.resultMatrix.a+S$s*this.resultMatrix.c+this.resultMatrix.tx,S$a[1]=S$m*this.resultMatrix.b+S$s*this.resultMatrix.d+this.resultMatrix.ty},S$_.ShowBones={},S$_}()),S$Za=function(){function S$h(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}S$P(S$h,"laya.ani.bone.BoneSlot");var S$a=S$h.prototype;return S$a.showSlotData=function(S$a,S$m){void 0===S$m&&(S$m=!0),this.currSlotData=S$a,S$m&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},S$a.showDisplayByName=function(S$a){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(S$a))},S$a.replaceDisplayByName=function(S$a,S$m){if(this.currSlotData){var S$s;S$s=this.currSlotData.getDisplayByName(S$a);var S$P;S$P=this.currSlotData.getDisplayByName(S$m),this.replaceDisplayByIndex(S$s,S$P)}},S$a.replaceDisplayByIndex=function(S$a,S$m){this.currSlotData&&(this._replaceDic[S$a]=S$m,this.displayIndex==S$a&&this.showDisplayByIndex(S$a))},S$a.showDisplayByIndex=function(S$a){if(null!=this._replaceDic[S$a]&&(S$a=this._replaceDic[S$a]),this.currSlotData&&-1<S$a&&S$a<this.currSlotData.displayArr.length){if(this.displayIndex=S$a,this.currDisplayData=this.currSlotData.displayArr[S$a],this.currDisplayData){var S$m=this.currDisplayData.name;this.currTexture=this.templet.getTexture(S$m),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!S$u.isConchApp||S$u.isConchApp&&"0.9.15"<S$ea.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},S$a.replaceSkin=function(S$a){this._diyTexture=S$a,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},S$a.setParentMatrix=function(S$a){this._parentMatrix=S$a},S$a.draw=function(S$a,S$m,S$s,S$P){if(void 0===S$s&&(S$s=!1),void 0===S$P&&(S$P=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var S$_,S$e=this.currTexture;switch(this._diyTexture&&(S$e=this._diyTexture),this.currDisplayData.type){case 0:if(S$a){var S$A=this.getDisplayMatrix();if(this._parentMatrix){var S$B=!1;if(S$A){var S$k;if(S$Wa.mul(S$A,this._parentMatrix,S$Wa.TEMP),S$k=S$s?(null==this._resultMatrix&&(this._resultMatrix=new S$Wa),this._resultMatrix):new S$Wa,!S$u.isWebGL&&this.currDisplayData.uvs||S$u.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var S$j=S$h._tempMatrix;S$j.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(S$j.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(S$B=!0,S$j.rotate(-Math.PI/2)),S$Wa.mul(S$j,S$Wa.TEMP,S$k)}else S$Wa.TEMP.copyTo(S$k);S$B?S$a.drawTexture(S$e,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,S$k):S$a.drawTexture(S$e,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,S$k)}}}break;case 1:if(null==(S$_=S$s?(null==this._skinSprite&&(this._skinSprite=S$h.createSkinMesh()),this._skinSprite):S$h.createSkinMesh()))return;var S$G;if(null==this.currDisplayData.bones){var S$y,S$d=this.currDisplayData.weights;this.deformData&&(S$d=this.deformData),S$y=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=S$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=S$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=S$d;this.currDisplayData.triangles.length;S$G=this.currDisplayData.triangles,S$_.init2(S$e,null,S$G,this._mVerticleArr,S$y);var S$Q,S$q=this.getDisplayMatrix();if(this._parentMatrix)if(S$q)S$Wa.mul(S$q,this._parentMatrix,S$Wa.TEMP),S$Q=S$s?(null==this._resultMatrix&&(this._resultMatrix=new S$Wa),this._resultMatrix):new S$Wa,S$Wa.TEMP.copyTo(S$Q),S$_.transform=S$Q}else this.skinMesh(S$m,S$_,S$P);S$a.drawSkin(S$_);break;case 2:if(null==(S$_=S$s?(null==this._skinSprite&&(this._skinSprite=S$h.createSkinMesh()),this._skinSprite):S$h.createSkinMesh()))return;this.skinMesh(S$m,S$_,S$P),S$a.drawSkin(S$_)}}},S$a.skinMesh=function(S$a,S$m,S$s){var S$P,S$_=this.currTexture,S$e=this.currDisplayData.bones;S$P=this._diyTexture?(S$_=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=S$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=S$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var S$A,S$B,S$k=this.currDisplayData.weights,S$j=this.currDisplayData.triangles,S$G=0,S$y=0,S$d=0,S$Q=NaN,S$q=NaN,S$h=0,S$u=0,S$O=[],S$p=0,S$c=0;if(this.deformData&&0<this.deformData.length){var S$H=0;for(S$p=0,S$c=S$e.length;S$p<S$c;){for(S$d=S$e[S$p++]+S$p,S$y=S$G=0;S$p<S$d;S$p++)S$B=S$a[S$e[S$p]],S$Q=S$k[S$h]+this.deformData[S$H++],S$q=S$k[S$h+1]+this.deformData[S$H++],S$u=S$k[S$h+2],S$G+=(S$Q*S$B.a+S$q*S$B.c+S$B.tx)*S$u,S$y+=(S$Q*S$B.b+S$q*S$B.d+S$B.ty)*S$u,S$h+=3;S$O.push(S$G,S$y)}}else for(S$p=0,S$c=S$e.length;S$p<S$c;){for(S$d=S$e[S$p++]+S$p,S$y=S$G=0;S$p<S$d;S$p++)S$B=S$a[S$e[S$p]],S$Q=S$k[S$h],S$q=S$k[S$h+1],S$u=S$k[S$h+2],S$G+=(S$Q*S$B.a+S$q*S$B.c+S$B.tx)*S$u,S$y+=(S$Q*S$B.b+S$q*S$B.d+S$B.ty)*S$u,S$h+=3;S$O.push(S$G,S$y)}this._mVerticleArr=S$O,S$A=S$j,S$m.init2(S$_,null,S$A,this._mVerticleArr,S$P)},S$a.drawBonePoint=function(S$a){S$a&&this._parentMatrix&&S$a.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},S$a.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},S$a.getMatrix=function(){return this._resultMatrix},S$a.copy=function(){var S$a=new S$h;return S$a.type="copy",S$a.name=this.name,S$a.attachmentName=this.attachmentName,S$a.srcDisplayIndex=this.srcDisplayIndex,S$a.parent=this.parent,S$a.displayIndex=this.displayIndex,S$a.templet=this.templet,S$a.currSlotData=this.currSlotData,S$a.currTexture=this.currTexture,S$a.currDisplayData=this.currDisplayData,S$a},S$h.createSkinMesh=function(){return S$u.isWebGL||S$u.isConchApp?S$Q.skinAniSprite():(S$u.isWebGL,null)},S$s(S$h,["_tempMatrix",function(){return this._tempMatrix=new S$Wa}]),S$h}(),S$Xa=function(){function S$a(){this.skinName=null,this.deformSlotDataList=[]}return S$P(S$a,"laya.ani.bone.DeformAniData"),S$a}(),S$Ea=function(){function S$a(){this.deformSlotDisplayList=[]}return S$P(S$a,"laya.ani.bone.DeformSlotData"),S$a}(),S$ia=function(){function S$a(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}S$P(S$a,"laya.ani.bone.DeformSlotDisplayData");var S$m=S$a.prototype;return S$m.binarySearch1=function(S$a,S$m){var S$s=0,S$P=S$a.length-2;if(0==S$P)return 1;for(var S$_=S$P>>>1;;){if(S$a[Math.floor(S$_+1)]<=S$m?S$s=S$_+1:S$P=S$_,S$s==S$P)return S$s+1;S$_=S$s+S$P>>>1}return 0},S$m.apply=function(S$a,S$m,S$s){if(void 0===S$s&&(S$s=1),S$a+=.05,!(this.timeList.length<=0)){var S$P=0;if(!(S$a<this.timeList[0])){var S$_=this.vectices[0].length,S$e=[],S$A=this.binarySearch1(this.timeList,S$a);if(this.frameIndex=S$A,S$a>=this.timeList[this.timeList.length-1]){var S$B=this.vectices[this.vectices.length-1];if(S$s<1)for(S$P=0;S$P<S$_;S$P++)S$e[S$P]+=(S$B[S$P]-S$e[S$P])*S$s;else for(S$P=0;S$P<S$_;S$P++)S$e[S$P]=S$B[S$P];this.deformData=S$e}else{this.tweenKeyList[this.frameIndex];var S$k=this.vectices[this.frameIndex-1],S$j=this.vectices[this.frameIndex],S$G=this.timeList[this.frameIndex-1],S$y=this.timeList[this.frameIndex];S$s=this.tweenKeyList[S$A-1]?(S$a-S$G)/(S$y-S$G):0;var S$d=NaN;for(S$P=0;S$P<S$_;S$P++)S$d=S$k[S$P],S$e[S$P]=S$d+(S$j[S$P]-S$d)*S$s;this.deformData=S$e}}}},S$a}(),S$ta=function(){function S$a(){this.time=NaN,this.drawOrder=[]}return S$P(S$a,"laya.ani.bone.DrawOrderData"),S$a}(),S$La=function(){function S$a(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return S$P(S$a,"laya.ani.bone.EventData"),S$a}(),S$p=function(){function S$Pa(S$a,S$m){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=S$a,this._targetBone=S$m[S$a.targetBoneIndex],this.isSpine=S$a.isSpine,null==this._bones&&(this._bones=[]);for(var S$s=this._bones.length=0,S$P=S$a.boneIndexs.length;S$s<S$P;S$s++)this._bones.push(S$m[S$a.boneIndexs[S$s]]);this.name=S$a.name,this.mix=S$a.mix,this.bendDirection=S$a.bendDirection}S$P(S$Pa,"laya.ani.bone.IkConstraint");var S$a=S$Pa.prototype;return S$a.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},S$a._applyIk1=function(S$a,S$m,S$s,S$P){var S$_=S$a.parentBone,S$e=1/(S$_.resultMatrix.a*S$_.resultMatrix.d-S$_.resultMatrix.b*S$_.resultMatrix.c),S$A=S$m-S$_.resultMatrix.tx,S$B=S$s-S$_.resultMatrix.ty,S$k=(S$A*S$_.resultMatrix.d-S$B*S$_.resultMatrix.c)*S$e-S$a.transform.x,S$j=(S$B*S$_.resultMatrix.a-S$A*S$_.resultMatrix.b)*S$e-S$a.transform.y,S$G=Math.atan2(S$j,S$k)*S$Pa.radDeg-0-S$a.transform.skX;S$a.transform.scX<0&&(S$G+=180),180<S$G?S$G-=360:S$G<-180&&(S$G+=360),S$a.transform.skX=S$a.transform.skY=S$a.transform.skX+S$G*S$P,S$a.update()},S$a.updatePos=function(S$a,S$m){this._sp&&this._sp.pos(S$a,S$m)},S$a._applyIk2=function(S$a,S$m,S$s,S$P,S$_,S$e){if(0!=S$e){var S$A=S$a.resultTransform.x,S$B=S$a.resultTransform.y,S$k=S$a.transform.scX,S$j=S$a.transform.scY,S$G=S$m.transform.scX,S$y=0,S$d=0,S$Q=0;S$Q=S$k<0?(S$k=-S$k,S$y=180,-1):(S$y=0,1),S$j<0&&(S$j=-S$j,S$Q=-S$Q),S$d=S$G<0?(S$G=-S$G,180):0;var S$q=S$m.resultTransform.x,S$h=NaN,S$u=NaN,S$O=NaN,S$p=S$a.resultMatrix.a,S$c=S$a.resultMatrix.c,S$H=S$a.resultMatrix.b,S$o=S$a.resultMatrix.d,S$N=Math.abs(S$k-S$j)<=1e-4;S$O=S$N?(S$u=S$p*S$q+S$c*(S$h=S$m.resultTransform.y)+S$a.resultMatrix.tx,S$H*S$q+S$o*S$h+S$a.resultMatrix.ty):(S$h=0,S$u=S$p*S$q+S$a.resultMatrix.tx,S$H*S$q+S$a.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new S$ea,S$_a.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(S$s,S$P,15,"#ffff00"),this._sp.graphics.drawCircle(S$u,S$O,15,"#ff00ff")),S$a.setRotation(Math.atan2(S$O-S$a.resultMatrix.ty,S$u-S$a.resultMatrix.tx));var S$z=S$a.parentBone;S$p=S$z.resultMatrix.a,S$c=S$z.resultMatrix.c,S$H=S$z.resultMatrix.b;var S$U=1/(S$p*(S$o=S$z.resultMatrix.d)-S$c*S$H),S$l=S$s-S$z.resultMatrix.tx,S$C=S$P-S$z.resultMatrix.ty,S$f=(S$l*S$o-S$C*S$c)*S$U-S$A,S$K=(S$C*S$p-S$l*S$H)*S$U-S$B,S$V=((S$l=S$u-S$z.resultMatrix.tx)*S$o-(S$C=S$O-S$z.resultMatrix.ty)*S$c)*S$U-S$A,S$W=(S$C*S$p-S$l*S$H)*S$U-S$B,S$b=Math.sqrt(S$V*S$V+S$W*S$W),S$S=S$m.length*S$G,S$Z=NaN,S$X=NaN;if(S$N){var S$E=(S$f*S$f+S$K*S$K-S$b*S$b-(S$S*=S$k)*S$S)/(2*S$b*S$S);S$E<-1?S$E=-1:1<S$E&&(S$E=1),S$X=Math.acos(S$E)*S$_,S$p=S$b+S$S*S$E,S$c=S$S*Math.sin(S$X),S$Z=Math.atan2(S$K*S$p-S$f*S$c,S$f*S$p+S$K*S$c)}else{var S$i=(S$p=S$k*S$S)*S$p,S$t=(S$c=S$j*S$S)*S$c,S$L=S$f*S$f+S$K*S$K,S$R=Math.atan2(S$K,S$f),S$F=-2*S$t*S$b,S$x=S$t-S$i;if(0<(S$o=S$F*S$F-4*S$x*(S$H=S$t*S$b*S$b+S$i*S$L-S$i*S$t))){var S$M=Math.sqrt(S$o);S$F<0&&(S$M=-S$M);var S$J=(S$M=-(S$F+S$M)/2)/S$x,S$D=S$H/S$M,S$g=Math.abs(S$J)<Math.abs(S$D)?S$J:S$D;S$g*S$g<=S$L&&(S$C=Math.sqrt(S$L-S$g*S$g)*S$_,S$Z=S$R-Math.atan2(S$C,S$g),S$X=Math.atan2(S$C/S$j,(S$g-S$b)/S$k))}var S$w=0,S$v=Number.MAX_VALUE,S$Y=0,S$T=0,S$I=0,S$$=0,S$n=0,S$r=0;S$$<(S$o=(S$l=S$b+S$p)*S$l)&&(S$I=0,S$$=S$o,S$n=S$l),(S$o=(S$l=S$b-S$p)*S$l)<S$v&&(S$w=Math.PI,S$v=S$o,S$Y=S$l);var S$aa=Math.acos(-S$p*S$b/(S$i-S$t));(S$o=(S$l=S$p*Math.cos(S$aa)+S$b)*S$l+(S$C=S$c*Math.sin(S$aa))*S$C)<S$v&&(S$w=S$aa,S$v=S$o,S$Y=S$l,S$T=S$C),S$$<S$o&&(S$I=S$aa,S$$=S$o,S$n=S$l,S$r=S$C),S$X=S$L<=(S$v+S$$)/2?(S$Z=S$R-Math.atan2(S$T*S$_,S$Y),S$w*S$_):(S$Z=S$R-Math.atan2(S$r*S$_,S$n),S$I*S$_)}var S$ma=Math.atan2(S$h,S$q)*S$Q,S$sa=S$a.resultTransform.skX;180<(S$Z=(S$Z-S$ma)*S$Pa.radDeg+S$y-S$sa)?S$Z-=360:S$Z<-180&&(S$Z+=360),S$a.resultTransform.x=S$A,S$a.resultTransform.y=S$B,S$a.resultTransform.skX=S$a.resultTransform.skY=S$sa+S$Z*S$e,S$sa=S$m.resultTransform.skX,180<(S$X=((S$X+S$ma)*S$Pa.radDeg-0)*S$Q+S$d-(S$sa%=360))?S$X-=360:S$X<-180&&(S$X+=360),S$m.resultTransform.x=S$q,S$m.resultTransform.y=S$h,S$m.resultTransform.skX=S$m.resultTransform.skY=S$m.resultTransform.skY+S$X*S$e,S$a.update()}},S$a._applyIk3=function(S$a,S$m,S$s,S$P,S$_,S$e){if(0!=S$e){var S$A,S$B,S$k=S$m.resultMatrix.a*S$m.length,S$j=S$m.resultMatrix.b*S$m.length,S$G=S$k*S$k+S$j*S$j,S$y=Math.sqrt(S$G),S$d=S$a.resultMatrix.tx,S$Q=S$a.resultMatrix.ty,S$q=S$m.resultMatrix.tx,S$h=S$m.resultMatrix.ty,S$u=S$q-S$d,S$O=S$h-S$Q,S$p=S$u*S$u+S$O*S$O,S$c=Math.sqrt(S$p),S$H=(S$u=S$s-S$a.resultMatrix.tx)*S$u+(S$O=S$P-S$a.resultMatrix.ty)*S$O,S$o=Math.sqrt(S$H);if(S$y+S$c<=S$o||S$o+S$y<=S$c||S$o+S$c<=S$y){var S$N=NaN;S$q=S$d+(S$N=S$y+S$c<=S$o?1:-1)*(S$s-S$d)*S$c/S$o,S$h=S$Q+S$N*(S$P-S$Q)*S$c/S$o}else{var S$z=(S$p-S$G+S$H)/(2*S$H),S$U=Math.sqrt(S$p-S$z*S$z*S$H)/S$o,S$l=S$d+S$u*S$z,S$C=S$Q+S$O*S$z,S$f=-S$O*S$U,S$K=S$u*S$U;S$h=0<S$_?(S$q=S$l-S$f,S$C-S$K):(S$q=S$l+S$f,S$C+S$K)}S$A=S$q,S$B=S$h,this.isDebug&&(this._sp||(this._sp=new S$ea,S$_a.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(S$d,S$Q,15,"#ff00ff"),this._sp.graphics.drawCircle(S$s,S$P,15,"#ffff00"),this._sp.graphics.drawCircle(S$A,S$B,15,"#ff00ff"));var S$V,S$W;S$V=Math.atan2(S$B-S$a.resultMatrix.ty,S$A-S$a.resultMatrix.tx),S$a.setRotation(S$V),(S$W=S$Pa._tempMatrix).identity(),S$W.rotate(S$V),S$W.scale(S$a.resultMatrix.getScaleX(),S$a.resultMatrix.getScaleY()),S$W.translate(S$a.resultMatrix.tx,S$a.resultMatrix.ty),S$W.copyTo(S$a.resultMatrix),S$a.updateChild();var S$b,S$S;S$b=Math.atan2(S$P-S$B,S$s-S$A),S$m.setRotation(S$b),(S$S=S$Pa._tempMatrix).identity(),S$S.rotate(S$b),S$S.scale(S$m.resultMatrix.getScaleX(),S$m.resultMatrix.getScaleY()),S$S.translate(S$A,S$B),S$W.copyTo(S$m.resultMatrix),S$m.updateChild()}},S$s(S$Pa,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new S$Wa}]),S$Pa}(),S$Ra=function(){function S$a(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return S$P(S$a,"laya.ani.bone.IkConstraintData"),S$a}(),S$o=function(){function S$S(S$a,S$m){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=S$a,this.position=S$a.position,this.spacing=S$a.spacing,this.rotateMix=S$a.rotateMix,this.translateMix=S$a.translateMix,this.bones=[];for(var S$s=this.data.bones,S$P=0,S$_=S$s.length;S$P<S$_;S$P++)this.bones.push(S$m[S$s[S$P]])}S$P(S$S,"laya.ani.bone.PathConstraint");var S$a=S$S.prototype;return S$a.apply=function(S$a,S$m){if(this.target){var S$s=this.translateMix,S$P=this.translateMix,S$_=0<S$P,S$e=this.data.spacingMode,S$A="length"==S$e,S$B=this.data.rotateMode,S$k="tangent"==S$B,S$j="chainScale"==S$B,S$G=[],S$y=this.bones.length,S$d=S$k?S$y:S$y+1,S$Q=[];(this._spaces=S$Q)[0]=this.position;var S$q=this.spacing;if(S$j||S$A)for(var S$h=0,S$u=S$d-1;S$h<S$u;){var S$O=this.bones[S$h],S$p=S$O.length,S$c=S$p*S$O.resultMatrix.a,S$H=S$p*S$O.resultMatrix.b;S$p=Math.sqrt(S$c*S$c+S$H*S$H),S$j&&(S$G[S$h]=S$p),S$Q[++S$h]=S$A?Math.max(0,S$p+S$q):S$q}else for(S$h=1;S$h<S$d;S$h++)S$Q[S$h]=S$q;var S$o=this.computeWorldPositions(this.target,S$a,S$m,S$d,S$k,"percent"==this.data.positionMode,"percent"==S$e);if(this._debugKey){for(S$h=0;S$h<S$o.length;S$h++)S$m.drawCircle(S$o[S$h++],S$o[S$h++],5,"#00ff00");var S$N=[];for(S$h=0;S$h<S$o.length;S$h++)S$N.push(S$o[S$h++],S$o[S$h++]);S$m.drawLines(0,0,S$N,"#ff0000")}var S$z=S$o[0],S$U=S$o[1],S$l=this.data.offsetRotation,S$C="chain"==S$B&&0==S$l,S$f=NaN;for(S$h=0,S$f=3;S$h<S$y;S$h++,S$f+=3){(S$O=this.bones[S$h]).resultMatrix.tx+=(S$z-S$O.resultMatrix.tx)*S$s,S$O.resultMatrix.ty+=(S$U-S$O.resultMatrix.ty)*S$s;var S$K=(S$c=S$o[S$f])-S$z,S$V=(S$H=S$o[S$f+1])-S$U;if(S$j&&0!=(S$p=S$G[S$h])){var S$W=(Math.sqrt(S$K*S$K+S$V*S$V)/S$p-1)*S$P+1;S$O.resultMatrix.a*=S$W,S$O.resultMatrix.c*=S$W}if(S$z=S$c,S$U=S$H,S$_){var S$b=S$O.resultMatrix.a,S$S=S$O.resultMatrix.c,S$Z=S$O.resultMatrix.b,S$X=S$O.resultMatrix.d,S$E=NaN,S$i=NaN,S$t=NaN;S$E=S$k?S$o[S$f-1]:0==S$Q[S$h+1]?S$o[S$f+2]:Math.atan2(S$V,S$K),S$E-=Math.atan2(S$Z,S$b)-S$l/180*Math.PI,S$C&&(S$i=Math.cos(S$E),S$t=Math.sin(S$E),S$z+=((S$p=S$O.length)*(S$i*S$b-S$t*S$Z)-S$K)*S$P,S$U+=(S$p*(S$t*S$b+S$i*S$Z)-S$V)*S$P),S$E>Math.PI?S$E-=2*Math.PI:S$E<-Math.PI&&(S$E+=2*Math.PI),S$E*=S$P,S$i=Math.cos(S$E),S$t=Math.sin(S$E),S$O.resultMatrix.a=S$i*S$b-S$t*S$Z,S$O.resultMatrix.c=S$i*S$S-S$t*S$X,S$O.resultMatrix.b=S$t*S$b+S$i*S$Z,S$O.resultMatrix.d=S$t*S$S+S$i*S$X}}}},S$a.computeWorldVertices2=function(S$a,S$m,S$s,S$P,S$_,S$e){var S$A,S$B,S$k=S$a.currDisplayData.bones,S$j=S$a.currDisplayData.weights,S$G=S$a.currDisplayData.triangles,S$y=0,S$d=0,S$Q=0,S$q=0,S$h=0,S$u=0,S$O=0,S$p=0,S$c=0,S$H=0,S$o=0;if(null!=S$k){for(S$y=0;S$y<S$s;S$y+=2)S$d+=(S$q=S$k[S$d])+1,S$Q+=S$q;var S$N=S$m;for(S$h=S$e,S$u=3*S$Q;S$h<S$P;S$h+=2){for(S$p=S$O=0,S$q=S$k[S$d++],S$q+=S$d;S$d<S$q;S$d++,S$u+=3){S$A=S$N[S$k[S$d]].resultMatrix,S$c=S$j[S$u],S$H=S$j[S$u+1];var S$z=S$j[S$u+2];S$O+=(S$c*S$A.a+S$H*S$A.c+S$A.tx)*S$z,S$p+=(S$c*S$A.b+S$H*S$A.d+S$A.ty)*S$z}S$_[S$h]=S$O,S$_[S$h+1]=S$p}}else{var S$U,S$l;if(S$G||(S$G=S$j),S$a.deformData&&(S$G=S$a.deformData),S$U=S$a.parent,S$m)for(S$o=S$m.length,S$y=0;S$y<S$o;S$y++)if(S$m[S$y].name==S$U){S$B=S$m[S$y];break}S$B&&(S$l=S$B.resultMatrix),S$l||(S$l=S$S._tempMt);var S$C=S$l.tx,S$f=S$l.ty,S$K=S$l.a,S$V=S$l.b,S$W=S$l.c,S$b=S$l.d;for(S$B&&(S$b*=S$B.d),S$d=S$s,S$h=S$e;S$h<S$P;S$d+=2,S$h+=2)S$c=S$G[S$d],S$H=S$G[S$d+1],S$_[S$h]=S$c*S$K+S$H*S$V+S$C,S$_[S$h+1]=-(S$c*S$W+S$H*S$b+S$f)}},S$a.computeWorldPositions=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A){S$a.currDisplayData.bones,S$a.currDisplayData.weights,S$a.currDisplayData.triangles;var S$B=[],S$k=0,S$j=S$a.currDisplayData.verLen,S$G=this.position,S$y=this._spaces,S$d=[],S$Q=[],S$q=S$j/6,S$h=-1,S$u=NaN,S$O=0,S$p=0,S$c=NaN,S$H=NaN,S$o=NaN,S$N=NaN;if(S$q--,S$j-=4,this.computeWorldVertices2(S$a,S$m,2,S$j,S$B,0),this._debugKey)for(S$k=0;S$k<S$B.length;)S$s.drawCircle(S$B[S$k++],S$B[S$k++],10,"#ff0000");S$d=S$B,this._curves.length=S$q;var S$z=this._curves,S$U=S$d[S$u=0],S$l=S$d[1],S$C=0,S$f=0,S$K=0,S$V=0,S$W=0,S$b=0,S$S=NaN,S$Z=NaN,S$X=NaN,S$E=NaN,S$i=NaN,S$t=NaN,S$L=NaN,S$R=NaN,S$F=0;for(S$k=0,S$F=2;S$k<S$q;S$k++,S$F+=6)S$C=S$d[S$F],S$f=S$d[S$F+1],S$K=S$d[S$F+2],S$V=S$d[S$F+3],S$i=2*(S$S=.1875*(S$U-2*S$C+S$K))+(S$X=.09375*(3*(S$C-S$K)-S$U+(S$W=S$d[S$F+4]))),S$t=2*(S$Z=.1875*(S$l-2*S$f+S$V))+(S$E=.09375*(3*(S$f-S$V)-S$l+(S$b=S$d[S$F+5]))),S$L=.75*(S$C-S$U)+S$S+.16666667*S$X,S$R=.75*(S$f-S$l)+S$Z+.16666667*S$E,S$u+=Math.sqrt(S$L*S$L+S$R*S$R),S$L+=S$i,S$R+=S$t,S$i+=S$X,S$t+=S$E,S$u+=Math.sqrt(S$L*S$L+S$R*S$R),S$L+=S$i,S$R+=S$t,S$u+=Math.sqrt(S$L*S$L+S$R*S$R),S$L+=S$i+S$X,S$R+=S$t+S$E,S$u+=Math.sqrt(S$L*S$L+S$R*S$R),S$z[S$k]=S$u,S$U=S$W,S$l=S$b;if(S$e&&(S$G*=S$u),S$A)for(S$k=0;S$k<S$P;S$k++)S$y[S$k]*=S$u;var S$x=this._segments,S$M=0,S$J=0;for(S$J=S$p=S$O=S$k=0;S$k<S$P;S$k++,S$O+=3)if((S$c=S$G+=S$H=S$y[S$k])<0)this.addBeforePosition(S$c,S$d,0,S$Q,S$O);else if(S$u<S$c)this.addAfterPosition(S$c-S$u,S$d,S$j-4,S$Q,S$O);else{for(;;S$p++)if(!((S$N=S$z[S$p])<S$c)){0==S$p?S$c/=S$N:S$c=(S$c-(S$o=S$z[S$p-1]))/(S$N-S$o);break}if(S$p!=S$h){var S$D=6*(S$h=S$p);for(S$U=S$d[S$D],S$l=S$d[S$D+1],S$C=S$d[S$D+2],S$f=S$d[S$D+3],S$K=S$d[S$D+4],S$V=S$d[S$D+5],S$i=2*(S$S=.03*(S$U-2*S$C+S$K))+(S$X=.006*(3*(S$C-S$K)-S$U+(S$W=S$d[S$D+6]))),S$t=2*(S$Z=.03*(S$l-2*S$f+S$V))+(S$E=.006*(3*(S$f-S$V)-S$l+(S$b=S$d[S$D+7]))),S$L=.3*(S$C-S$U)+S$S+.16666667*S$X,S$R=.3*(S$f-S$l)+S$Z+.16666667*S$E,S$M=Math.sqrt(S$L*S$L+S$R*S$R),S$x[0]=S$M,S$D=1;S$D<8;S$D++)S$L+=S$i,S$R+=S$t,S$i+=S$X,S$t+=S$E,S$M+=Math.sqrt(S$L*S$L+S$R*S$R),S$x[S$D]=S$M;S$L+=S$i,S$R+=S$t,S$M+=Math.sqrt(S$L*S$L+S$R*S$R),S$x[8]=S$M,S$L+=S$i+S$X,S$R+=S$t+S$E,S$M+=Math.sqrt(S$L*S$L+S$R*S$R),S$x[9]=S$M,S$J=0}for(S$c*=S$M;;S$J++)if(!((S$N=S$x[S$J])<S$c)){0==S$J?S$c/=S$N:S$c=S$J+(S$c-(S$o=S$x[S$J-1]))/(S$N-S$o);break}this.addCurvePosition(.1*S$c,S$U,S$l,S$C,S$f,S$K,S$V,S$W,S$b,S$Q,S$O,S$_||0<S$k&&0==S$H)}return S$Q},S$a.addBeforePosition=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$m[S$s],S$A=S$m[S$s+1],S$B=S$m[S$s+2]-S$e,S$k=S$m[S$s+3]-S$A,S$j=Math.atan2(S$k,S$B);S$P[S$_]=S$e+S$a*Math.cos(S$j),S$P[S$_+1]=S$A+S$a*Math.sin(S$j),S$P[S$_+2]=S$j},S$a.addAfterPosition=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$m[S$s+2],S$A=S$m[S$s+3],S$B=S$e-S$m[S$s],S$k=S$A-S$m[S$s+1],S$j=Math.atan2(S$k,S$B);S$P[S$_]=S$e+S$a*Math.cos(S$j),S$P[S$_+1]=S$A+S$a*Math.sin(S$j),S$P[S$_+2]=S$j},S$a.addCurvePosition=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G,S$y){0==S$a&&(S$a=1e-4);var S$d=S$a*S$a,S$Q=S$d*S$a,S$q=1-S$a,S$h=S$q*S$q,S$u=S$h*S$q,S$O=S$q*S$a,S$p=3*S$O,S$c=S$q*S$p,S$H=S$p*S$a,S$o=S$m*S$u+S$P*S$c+S$e*S$H+S$B*S$Q,S$N=S$s*S$u+S$_*S$c+S$A*S$H+S$k*S$Q;S$j[S$G]=S$o,S$j[S$G+1]=S$N,S$j[S$G+2]=S$y?Math.atan2(S$N-(S$s*S$h+S$_*S$O*2+S$A*S$d),S$o-(S$m*S$h+S$P*S$O*2+S$e*S$d)):0},S$S.NONE=-1,S$S.BEFORE=-2,S$S.AFTER=-3,S$s(S$S,["_tempMt",function(){return this._tempMt=new S$Wa}]),S$S}(),S$Fa=function(){function S$a(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return S$P(S$a,"laya.ani.bone.PathConstraintData"),S$a}(),S$xa=function(){function S$a(){this.name=null,this.slotArr=[]}return S$P(S$a,"laya.ani.bone.SkinData"),S$a}(),S$Ma=function(){function S$a(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}S$P(S$a,"laya.ani.bone.SkinSlotDisplayData");var S$m=S$a.prototype;return S$m.createTexture=function(S$a){return this.texture||(this.texture=new S$ba(S$a.bitmap,this.uvs),S$a.bitmap.alphaTexture&&(this.texture.alphaTexture=new S$ba(S$a.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=S$a.height,this.texture.height=S$a.width,this.texture.offsetX=-S$a.offsetX,this.texture.offsetY=-S$a.offsetY,this.texture.sourceWidth=S$a.sourceHeight,this.texture.sourceHeight=S$a.sourceWidth):(this.texture.width=S$a.width,this.texture.height=S$a.height,this.texture.offsetX=-S$a.offsetX,this.texture.offsetY=-S$a.offsetY,this.texture.sourceWidth=S$a.sourceWidth,this.texture.sourceHeight=S$a.sourceHeight),S$u.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},S$m.destory=function(){this.texture&&this.texture.destroy()},S$a}(),S$Ja=function(){function S$a(){this.name=null,this.displayArr=[]}return S$P(S$a,"laya.ani.bone.SlotData"),S$a.prototype.getDisplayByName=function(S$a){for(var S$m=0,S$s=this.displayArr.length;S$m<S$s;S$m++)if(this.displayArr[S$m].attachmentName==S$a)return S$m;return-1},S$a}(),S$N=function(){function S$a(S$a,S$m){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=S$h(2,0),this._data=S$a,null==this._bones&&(this._bones=[]),this.target=S$m[S$a.targetIndex];var S$s,S$P=0;for(S$P=0,S$s=S$a.boneIndexs.length;S$P<S$s;S$P++)this._bones.push(S$m[S$a.boneIndexs[S$P]]);this.rotateMix=S$a.rotateMix,this.translateMix=S$a.translateMix,this.scaleMix=S$a.scaleMix,this.shearMix=S$a.shearMix}return S$P(S$a,"laya.ani.bone.TfConstraint"),S$a.prototype.apply=function(){for(var S$a,S$m=this.target.resultMatrix.a,S$s=this.target.resultMatrix.b,S$P=this.target.resultMatrix.c,S$_=this.target.resultMatrix.d,S$e=0,S$A=this._bones.length;S$e<S$A;S$e++){if(S$a=this._bones[S$e],0<this.rotateMix){var S$B=S$a.resultMatrix.a,S$k=S$a.resultMatrix.b,S$j=S$a.resultMatrix.c,S$G=S$a.resultMatrix.d,S$y=Math.atan2(S$P,S$m)-Math.atan2(S$j,S$B)+this._data.offsetRotation*Math.PI/180;S$y>Math.PI?S$y-=2*Math.PI:S$y<-Math.PI&&(S$y+=2*Math.PI),S$y*=this.rotateMix;var S$d=Math.cos(S$y),S$Q=Math.sin(S$y);S$a.resultMatrix.a=S$d*S$B-S$Q*S$j,S$a.resultMatrix.b=S$d*S$k-S$Q*S$G,S$a.resultMatrix.c=S$Q*S$B+S$d*S$j,S$a.resultMatrix.d=S$Q*S$k+S$d*S$G}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),S$a.resultMatrix.tx+=(this._temp[0]-S$a.resultMatrix.tx)*this.translateMix,S$a.resultMatrix.ty+=(this._temp[1]-S$a.resultMatrix.ty)*this.translateMix,S$a.updateChild()),0<this.scaleMix){var S$q=Math.sqrt(S$a.resultMatrix.a*S$a.resultMatrix.a+S$a.resultMatrix.c*S$a.resultMatrix.c),S$h=Math.sqrt(S$m*S$m+S$P*S$P),S$u=1e-5<S$q?(S$q+(S$h-S$q+this._data.offsetScaleX)*this.scaleMix)/S$q:0;S$a.resultMatrix.a*=S$u,S$a.resultMatrix.c*=S$u,S$q=Math.sqrt(S$a.resultMatrix.b*S$a.resultMatrix.b+S$a.resultMatrix.d*S$a.resultMatrix.d),S$h=Math.sqrt(S$s*S$s+S$_*S$_),S$u=1e-5<S$q?(S$q+(S$h-S$q+this._data.offsetScaleY)*this.scaleMix)/S$q:0,S$a.resultMatrix.b*=S$u,S$a.resultMatrix.d*=S$u}if(0<this.shearMix){S$k=S$a.resultMatrix.b,S$G=S$a.resultMatrix.d;var S$O=Math.atan2(S$G,S$k);(S$y=Math.atan2(S$_,S$s)-Math.atan2(S$P,S$m)-(S$O-Math.atan2(S$a.resultMatrix.c,S$a.resultMatrix.a)))>Math.PI?S$y-=2*Math.PI:S$y<-Math.PI&&(S$y+=2*Math.PI),S$y=S$O+(S$y+this._data.offsetShearY*Math.PI/180)*this.shearMix,S$u=Math.sqrt(S$k*S$k+S$G*S$G),S$a.resultMatrix.b=Math.cos(S$y)*S$u,S$a.resultMatrix.d=Math.sin(S$y)*S$u}}},S$a}(),S$Da=function(){function S$a(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return S$P(S$a,"laya.ani.bone.TfConstraintData"),S$a}(),S$ga=function(){function S$a(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}S$P(S$a,"laya.ani.bone.Transform");var S$m=S$a.prototype;return S$m.initData=function(S$a){null!=S$a.x&&(this.x=S$a.x),null!=S$a.y&&(this.y=S$a.y),null!=S$a.skX&&(this.skX=S$a.skX),null!=S$a.skY&&(this.skY=S$a.skY),null!=S$a.scX&&(this.scX=S$a.scX),null!=S$a.scY&&(this.scY=S$a.scY)},S$m.getMatrix=function(){var S$a;return(S$a=this.mMatrix?this.mMatrix:this.mMatrix=new S$Wa).identity(),S$a.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(S$a,this.skewX*Math.PI/180,this.skewY*Math.PI/180),S$a.rotate(this.skX*Math.PI/180),S$a.translate(this.x,this.y),S$a},S$m.skew=function(S$a,S$m,S$s){var S$P=Math.sin(S$s),S$_=Math.cos(S$s),S$e=Math.sin(S$m),S$A=Math.cos(S$m);return S$a.setTo(S$a.a*S$A-S$a.b*S$P,S$a.a*S$e+S$a.b*S$_,S$a.c*S$A-S$a.d*S$P,S$a.c*S$e+S$a.d*S$_,S$a.tx*S$A-S$a.ty*S$P,S$a.tx*S$e+S$a.ty*S$_),S$a},S$a}(),S$z=function(){function S$a(){}return S$P(S$a,"laya.ani.bone.UVTools"),S$a.getRelativeUV=function(S$a,S$m,S$s){var S$P=S$a[0],S$_=S$a[2]-S$a[0],S$e=S$a[1],S$A=S$a[5]-S$a[1];S$s||(S$s=[]),S$s.length=S$m.length;var S$B,S$k=0;S$B=S$s.length;var S$j=1/S$_,S$G=1/S$A;for(S$k=0;S$k<S$B;S$k+=2)S$s[S$k]=(S$m[S$k]-S$P)*S$j,S$s[S$k+1]=(S$m[S$k+1]-S$e)*S$G;return S$s},S$a.getAbsoluteUV=function(S$a,S$m,S$s){if(0==S$a[0]&&0==S$a[1]&&1==S$a[4]&&1==S$a[5])return S$s?(S$O.copyArray(S$s,S$m),S$s):S$m;var S$P=S$a[0],S$_=S$a[2]-S$a[0],S$e=S$a[1],S$A=S$a[5]-S$a[1];S$s||(S$s=[]),S$s.length=S$m.length;var S$B,S$k=0;for(S$B=S$s.length,S$k=0;S$k<S$B;S$k+=2)S$s[S$k]=S$m[S$k]*S$_+S$P,S$s[S$k+1]=S$m[S$k+1]*S$A+S$e;return S$s},S$a}(),S$S=function(){function S$a(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return S$P(S$a,"laya.ani.KeyFramesContent"),S$a}(),S$U=function(){function S$G(){}return S$P(S$G,"laya.ani.math.BezierLerp"),S$G.getBezierRate=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$G._getBezierParamKey(S$m,S$s,S$P,S$_),S$A=100*S$e+S$a;if(S$G._bezierResultCache[S$A])return S$G._bezierResultCache[S$A];var S$B,S$k=S$G._getBezierPoints(S$m,S$s,S$P,S$_,S$e),S$j=0;for(S$B=S$k.length,S$j=0;S$j<S$B;S$j+=2)if(S$a<=S$k[S$j])return S$G._bezierResultCache[S$A]=S$k[S$j+1],S$k[S$j+1];return S$G._bezierResultCache[S$A]=1},S$G._getBezierParamKey=function(S$a,S$m,S$s,S$P){return 100*(100*(100*(100*S$a+S$m)+S$s)+S$P)},S$G._getBezierPoints=function(S$a,S$m,S$s,S$P,S$_){return S$G._bezierPointsCache[S$_]?S$G._bezierPointsCache[S$_]:(S$e=[0,0,S$a,S$m,S$s,S$P,1,1],S$A=(new S$B).getBezierPoints(S$e,100,3),S$G._bezierPointsCache[S$_]=S$A);var S$e,S$A},S$G._bezierResultCache={},S$G._bezierPointsCache={},S$G}(),S$l=function(S$a){function S$m(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,S$m.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}S$P(S$m,"laya.ani.AnimationPlayer",S$_);var S$s=S$m.prototype;return S$_a.imps(S$s,{"laya.resource.IDestroy":!0}),S$s._onTempletLoadedComputeFullKeyframeIndices=function(S$a,S$m,S$s){this._templet===S$s&&this._cachePlayRate===S$a&&this._cacheFrameRate===S$m&&this._computeFullKeyframeIndices()},S$s._computeFullKeyframeIndices=function(){for(var S$a=this._fullFrames=[],S$m=this._templet,S$s=this._cacheFrameRateInterval*this._cachePlayRate,S$P=0,S$_=S$m.getAnimationCount();S$P<S$_;S$P++){for(var S$e=[],S$A=0,S$B=S$m.getAnimation(S$P).nodes.length;S$A<S$B;S$A++){for(var S$k=S$m.getAnimation(S$P).nodes[S$A],S$j=Math.floor(S$k.playTime/S$s+.01),S$G=new Uint16Array(S$j+1),S$y=-1,S$d=0,S$Q=S$k.keyFrame.length;S$d<S$Q;S$d++){var S$q=S$k.keyFrame[S$d],S$h=S$q.startTime,S$u=S$h+S$q.duration+S$s;do{for(var S$O=Math.floor(S$h/S$s+.5),S$p=S$y+1;S$p<S$O;S$p++)S$G[S$p]=S$d;S$G[S$y=S$O]=S$d,S$h+=S$s}while(S$h<=S$u)}S$e.push(S$G)}S$a.push(S$e)}},S$s._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},S$s._calculatePlayDuration=function(){if(0!==this.state){var S$a=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=S$a),this._playEnd>S$a&&(this._playEnd=S$a),this._playDuration=this._playEnd-this._playStart}},S$s._setPlayParams=function(S$a,S$m){this._currentTime=S$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/S$m+.01),0),this._currentFrameTime=this._currentKeyframeIndex*S$m},S$s._setPlayParamsWhenStop=function(S$a,S$m){this._currentTime=S$a,this._currentKeyframeIndex=Math.max(Math.floor(S$a/S$m+.01),0),this._currentFrameTime=this._currentKeyframeIndex*S$m,this._currentAnimationClipIndex=-1},S$s._update=function(S$a){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var S$m=this._cacheFrameRateInterval*this._cachePlayRate,S$s=0;this._startUpdateLoopCount!==S$q.loopCount&&(S$s=S$a*this.playbackRate,this._elapsedPlaybackTime+=S$s);var S$P=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=S$P)return this._setPlayParamsWhenStop(S$P,S$m),void this.event("stopped");if(S$s+=this._currentTime,0<S$P)if(S$P<=S$s)do{if(S$s-=S$P,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(S$P,S$m),this._stopWhenCircleFinish=!1,void this.event("stopped");S$s<S$P&&(this._setPlayParams(S$s,S$m),this.event("complete"))}while(S$P<=S$s);else this._setPlayParams(S$s,S$m);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(S$P,S$m),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},S$s._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},S$s.play=function(S$a,S$m,S$s,S$P,S$_){if(void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=1),void 0===S$s&&(S$s=2147483647),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(S$s<0||S$P<0||S$_<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==S$_&&S$_<S$P)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=S$m,this._overallDuration=S$s,this._playStart=S$P,this._playEnd=S$_,this._paused=!1,this._currentAnimationClipIndex=S$a,this._currentKeyframeIndex=0,this._startUpdateLoopCount=S$q.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},S$s.playByFrame=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$a&&(S$a=0),void 0===S$m&&(S$m=1),void 0===S$s&&(S$s=2147483647),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=30);var S$A=1e3/S$e;this.play(S$a,S$m,S$s,S$P*S$A,S$_*S$A)},S$s.stop=function(S$a){void 0===S$a&&(S$a=!0),S$a?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},S$e(0,S$s,"playEnd",function(){return this._playEnd}),S$e(0,S$s,"templet",function(){return this._templet},function(S$a){0===!this.state&&this.stop(!0),this._templet!==S$a&&((this._templet=S$a).loaded?this._computeFullKeyframeIndices():S$a.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),S$e(0,S$s,"playStart",function(){return this._playStart}),S$e(0,S$s,"playDuration",function(){return this._playDuration}),S$e(0,S$s,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),S$e(0,S$s,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),S$e(0,S$s,"overallDuration",function(){return this._overallDuration}),S$e(0,S$s,"currentFrameTime",function(){return this._currentFrameTime}),S$e(0,S$s,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),S$e(0,S$s,"currentPlayTime",function(){return this._currentTime+this._playStart}),S$e(0,S$s,"cachePlayRate",function(){return this._cachePlayRate},function(S$a){this._cachePlayRate!==S$a&&(this._cachePlayRate=S$a,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[S$a,this._cacheFrameRate])))}),S$e(0,S$s,"cacheFrameRate",function(){return this._cacheFrameRate},function(S$a){this._cacheFrameRate!==S$a&&(this._cacheFrameRate=S$a,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,S$a])))}),S$e(0,S$s,"currentTime",null,function(S$a){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(S$a<this._playStart||S$a>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=S$q.loopCount;var S$m=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=S$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/S$m),0),this._currentFrameTime=this._currentKeyframeIndex*S$m}}),S$e(0,S$s,"paused",function(){return this._paused},function(S$a){(this._paused=S$a)&&this.event("paused")}),S$e(0,S$s,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),S$e(0,S$s,"destroyed",function(){return this._destroyed}),S$m}(),S$Z=function(S$a){function S$m(){S$m.__super.call(this),S$u.isConchNode&&(this.drawSkin=function(S$a){S$a.transform||(S$a.transform=S$Wa.EMPTY),this._addCmd([S$a]),this.setSkinMesh&&this.setSkinMesh(S$a._ps,S$a.mVBData,S$a.mEleNum,0,S$a.mTexture,S$a.transform)})}return S$P(S$m,"laya.ani.GraphicsAni",S$A),S$m.prototype.drawSkin=function(S$a){var S$m=[S$a];this._saveToCmd(S$u._context._drawSkin,S$m)},S$m.create=function(){return S$m._caches.pop()||new S$m},S$m.recycle=function(S$a){S$a.clear(),S$m._caches.push(S$a)},S$m._caches=[],S$m}(),S$X=function(S$a){function S$p(){this._aniMap={},this.unfixedLastAniIndex=-1,S$p.__super.call(this),this._anis=new Array}S$P(S$p,"laya.ani.AnimationTemplet",S$G);var S$m=S$p.prototype;return S$m.parse=function(S$a){var S$m=new S$Va(S$a);this._aniVersion=S$m.readUTFString(),S$c.parse(this,S$m)},S$m._calculateKeyFrame=function(S$a,S$m,S$s){var S$P=S$a.keyFrame;S$P[S$m]=S$P[0];for(var S$_=0;S$_<S$m;S$_++){var S$e=S$P[S$_];S$e.nextData=0===S$e.duration?S$e.data:S$P[S$_+1].data}S$P.length--},S$m.onAsynLoaded=function(S$a,S$m,S$s){var S$P=new S$Va(S$m);switch(this._aniVersion=S$P.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":S$H.parse(this,S$P);break;default:S$c.parse(this,S$P)}this._endLoaded()},S$m.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},S$m.getAnimationCount=function(){return this._anis.length},S$m.getAnimation=function(S$a){return this._anis[S$a]},S$m.getAniDuration=function(S$a){return this._anis[S$a].playTime},S$m.getNodes=function(S$a){return this._anis[S$a].nodes},S$m.getNodeIndexWithName=function(S$a,S$m){return this._anis[S$a].bone3DMap[S$m]},S$m.getNodeCount=function(S$a){return this._anis[S$a].nodes.length},S$m.getTotalkeyframesLength=function(S$a){return this._anis[S$a].totalKeyframeDatasLength},S$m.getPublicExtData=function(){return this._publicExtData},S$m.getAnimationDataWithCache=function(S$a,S$m,S$s,S$P){var S$_=S$m[S$s];if(S$_){var S$e=S$_[S$a];return S$e?S$e[S$P]:null}return null},S$m.setAnimationDataWithCache=function(S$a,S$m,S$s,S$P,S$_){var S$e=S$m[S$s]||(S$m[S$s]={});(S$e[S$a]||(S$e[S$a]=[]))[S$P]=S$_},S$m.getOriginalData=function(S$a,S$m,S$s,S$P,S$_){for(var S$e=this._anis[S$a].nodes,S$A=0,S$B=0,S$k=S$e.length,S$j=0;S$B<S$k;S$B++){var S$G,S$y=S$e[S$B];S$G=S$y.keyFrame[S$s[S$B][S$P]],S$y.dataOffset=S$j;var S$d=S$_-S$G.startTime,S$Q=S$y.lerpType;if(S$Q)switch(S$Q){case 0:case 1:for(S$A=0;S$A<S$y.keyframeWidth;)S$A+=S$y.interpolationMethod[S$A](S$y,S$A,S$m,S$j+S$A,S$G.data,S$d,null,S$G.duration,S$G.nextData);break;case 2:var S$q=S$G.interpolationData,S$h=S$q.length,S$u=0;for(S$A=0;S$A<S$h;){var S$O=S$q[S$A];switch(S$O){case 6:case 7:S$A+=S$p.interpolation[S$O](S$y,S$u,S$m,S$j+S$u,S$G.data,S$d,null,S$G.duration,S$G.nextData,S$q,S$A+1);break;default:S$A+=S$p.interpolation[S$O](S$y,S$u,S$m,S$j+S$u,S$G.data,S$d,null,S$G.duration,S$G.nextData)}S$u++}}else for(S$A=0;S$A<S$y.keyframeWidth;)S$A+=S$y.interpolationMethod[S$A](S$y,S$A,S$m,S$j+S$A,S$G.data,S$d,null,S$G.duration,S$G.nextData);S$j+=S$y.keyframeWidth}},S$m.getNodesCurrentFrameIndex=function(S$a,S$m){var S$s=this._anis[S$a].nodes;S$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(S$s.length),this.unfixedCurrentTimes=new Float32Array(S$s.length),this.unfixedLastAniIndex=S$a);for(var S$P=0,S$_=S$s.length;S$P<S$_;S$P++){var S$e=S$s[S$P];for(S$m<this.unfixedCurrentTimes[S$P]&&(this.unfixedCurrentFrameIndexes[S$P]=0),this.unfixedCurrentTimes[S$P]=S$m;this.unfixedCurrentFrameIndexes[S$P]<S$e.keyFrame.length&&!(S$e.keyFrame[this.unfixedCurrentFrameIndexes[S$P]].startTime>this.unfixedCurrentTimes[S$P]);)this.unfixedCurrentFrameIndexes[S$P]++;this.unfixedCurrentFrameIndexes[S$P]--}return this.unfixedCurrentFrameIndexes},S$m.getOriginalDataUnfixedRate=function(S$a,S$m,S$s){var S$P=this._anis[S$a].nodes;S$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(S$P.length),this.unfixedCurrentTimes=new Float32Array(S$P.length),this.unfixedKeyframes=S$h(S$P.length),this.unfixedLastAniIndex=S$a);for(var S$_=0,S$e=0,S$A=S$P.length,S$B=0;S$e<S$A;S$e++){var S$k=S$P[S$e];for(S$s<this.unfixedCurrentTimes[S$e]&&(this.unfixedCurrentFrameIndexes[S$e]=0),this.unfixedCurrentTimes[S$e]=S$s;this.unfixedCurrentFrameIndexes[S$e]<S$k.keyFrame.length&&!(S$k.keyFrame[this.unfixedCurrentFrameIndexes[S$e]].startTime>this.unfixedCurrentTimes[S$e]);)this.unfixedKeyframes[S$e]=S$k.keyFrame[this.unfixedCurrentFrameIndexes[S$e]],this.unfixedCurrentFrameIndexes[S$e]++;var S$j=this.unfixedKeyframes[S$e];S$k.dataOffset=S$B;var S$G=S$s-S$j.startTime;if(S$k.lerpType)switch(S$k.lerpType){case 0:case 1:for(S$_=0;S$_<S$k.keyframeWidth;)S$_+=S$k.interpolationMethod[S$_](S$k,S$_,S$m,S$B+S$_,S$j.data,S$G,null,S$j.duration,S$j.nextData);break;case 2:var S$y=S$j.interpolationData,S$d=S$y.length,S$Q=0;for(S$_=0;S$_<S$d;){var S$q=S$y[S$_];switch(S$q){case 6:case 7:S$_+=S$p.interpolation[S$q](S$k,S$Q,S$m,S$B+S$Q,S$j.data,S$G,null,S$j.duration,S$j.nextData,S$y,S$_+1);break;default:S$_+=S$p.interpolation[S$q](S$k,S$Q,S$m,S$B+S$Q,S$j.data,S$G,null,S$j.duration,S$j.nextData)}S$Q++}}else for(S$_=0;S$_<S$k.keyframeWidth;)S$_+=S$k.interpolationMethod[S$_](S$k,S$_,S$m,S$B+S$_,S$j.data,S$G,null,S$j.duration,S$j.nextData);S$B+=S$k.keyframeWidth}},S$p._LinearInterpolation_0=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){var S$G=0===S$B?0:S$e/S$B;return S$s[S$P]=(1-S$G)*S$_[S$m]+S$G*S$k[S$m],1},S$p._QuaternionInterpolation_1=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){var S$G=0===S$B?0:S$e/S$B;return S$d.slerpQuaternionArray(S$_,S$m,S$k,S$m,S$G,S$s,S$P),4},S$p._AngleInterpolation_2=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){return 0},S$p._RadiansInterpolation_3=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){return 0},S$p._Matrix4x4Interpolation_4=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){for(var S$G=0;S$G<16;S$G++,S$m++)S$s[S$P+S$G]=S$_[S$m]+S$e*S$A[S$m];return 16},S$p._NoInterpolation_5=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j){return S$s[S$P]=S$_[S$m],1},S$p._BezierInterpolation_6=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G){return void 0===S$G&&(S$G=0),S$s[S$P]=S$_[S$m]+(S$k[S$m]-S$_[S$m])*S$U.getBezierRate(S$e/S$B,S$j[S$G],S$j[S$G+1],S$j[S$G+2],S$j[S$G+3]),5},S$p._BezierInterpolation_7=function(S$a,S$m,S$s,S$P,S$_,S$e,S$A,S$B,S$k,S$j,S$G){return void 0===S$G&&(S$G=0),S$s[S$P]=S$j[S$G+4]+S$j[S$G+5]*S$U.getBezierRate((.001*S$e+S$j[S$G+6])/S$j[S$G+7],S$j[S$G],S$j[S$G+1],S$j[S$G+2],S$j[S$G+3]),9},S$p.load=function(S$a){return S$_a.loader.create(S$a,null,null,S$p)},S$p.interpolation=[S$p._LinearInterpolation_0,S$p._QuaternionInterpolation_1,S$p._AngleInterpolation_2,S$p._RadiansInterpolation_3,S$p._Matrix4x4Interpolation_4,S$p._NoInterpolation_5,S$p._BezierInterpolation_6,S$p._BezierInterpolation_7],S$p}(),S$C=function(S$m){function S$s(S$a,S$m){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,S$s.__super.call(this),void 0===S$m&&(S$m=0),S$a&&this.init(S$a,S$m)}S$P(S$s,"laya.ani.bone.Skeleton",S$m);var S$a=S$s.prototype;return S$a.init=function(S$a,S$m){void 0===S$m&&(S$m=0);var S$s,S$P,S$_,S$e=0,S$A=0;if(1==S$m)for(this._graphicsCache=[],S$e=0,S$A=S$a.getAnimationCount();S$e<S$A;S$e++)this._graphicsCache.push([]);if(this._yReverseMatrix=S$a.yReverseMatrix,this._aniMode=S$m,this._templet=S$a,this._player=new S$l,this._player.cacheFrameRate=S$a.rate,this._player.templet=S$a,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=S$a.mBoneArr,this._rootBone=S$a.mRootBone,this._aniSectionDic=S$a.aniSectionDic,0<S$a.ikArr.length)for(this._ikArr=[],S$e=0,S$A=S$a.ikArr.length;S$e<S$A;S$e++)this._ikArr.push(new S$p(S$a.ikArr[S$e],this._boneList));if(0<S$a.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),S$e=0,S$A=S$a.pathArr.length;S$e<S$A;S$e++)S$s=S$a.pathArr[S$e],S$P=new S$o(S$s,this._boneList),(S$_=this._boneSlotDic[S$s.name])&&((S$P=new S$o(S$s,this._boneList)).target=S$_),this._pathDic[S$s.name]=S$P;if(0<S$a.tfArr.length)for(this._tfArr=[],S$e=0,S$A=S$a.tfArr.length;S$e<S$A;S$e++)this._tfArr.push(new S$N(S$a.tfArr[S$e],this._boneList));if(0<S$a.skinDataArray.length){var S$B=this._templet.skinDataArray[this._skinIndex];this._skinName=S$B.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},S$a.load=function(S$a,S$m,S$s){},S$a._onLoaded=function(){},S$a._parseComplete=function(){var S$a=S$f.TEMPLET_DICTIONARY[this._aniPath];S$a&&(this.init(S$a,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},S$a._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},S$a._onPlay=function(){this.event("played")},S$a._onStop=function(){var S$a,S$m=this._templet.eventAniArr[this._aniClipIndex];if(S$m&&this._eventIndex<S$m.length)for(;this._eventIndex<S$m.length;this._eventIndex++)(S$a=S$m[this._eventIndex]).time>=this._player.playStart&&S$a.time<=this._player.playEnd&&this.event("label",S$a);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},S$a._onPause=function(){this.event("paused")},S$a._parseSrcBoneMatrix=function(){var S$a=0,S$m=0;for(S$m=this._templet.srcBoneMatrixArr.length,S$a=0;S$a<S$m;S$a++)this._boneMatrixArray.push(new S$Wa);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var S$s,S$P,S$_=this._templet.boneSlotArray;for(S$a=0,S$m=S$_.length;S$a<S$m;S$a++)S$s=S$_[S$a],null==(S$P=this._bindBoneBoneSlotDic[S$s.parent])&&(this._bindBoneBoneSlotDic[S$s.parent]=S$P=[]),this._boneSlotDic[S$s.name]=S$s=S$s.copy(),S$P.push(S$s),this._boneSlotArray.push(S$s)}},S$a._emitMissedEvents=function(S$a,S$m,S$s){void 0===S$s&&(S$s=0);var S$P=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(S$P){var S$_,S$e,S$A=0;for(S$_=S$P.length,S$A=S$s;S$A<S$_;S$A++)(S$e=S$P[S$A]).time>=this._player.playStart&&S$e.time<=this._player.playEnd&&this.event("label",S$e)}},S$a._update=function(S$a){if(void 0===S$a&&(S$a=!0),!(this._pause||S$a&&this._indexControl)){var S$m=this.timer.currTimer,S$s=this._player.currentKeyframeIndex,S$P=S$m-this._lastTime;if(S$a?this._player._update(S$P):S$s=-1,this._lastTime=S$m,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<S$P&&this._clipIndex==S$s&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var S$_;this._lastUpdateAniClipIndex=this._aniClipIndex,S$s>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var S$e,S$A=this._templet.eventAniArr[this._aniClipIndex];if(S$A&&this._eventIndex<S$A.length&&((S$_=S$A[this._eventIndex]).time>=this._player.playStart&&S$_.time<=this._player.playEnd?this._player.currentPlayTime>=S$_.time&&(this.event("label",S$_),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(S$e=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=S$e&&(this.graphics=S$e));var S$B=0,S$k=0;for(S$k=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,S$k-1)&&0<S$k;)S$k--;if(S$k<this._clipIndex)for(S$B=S$k;S$B<this._clipIndex;S$B++)this._createGraphics(S$B)}else if(1==this._aniMode){if(S$e=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=S$e&&(this.graphics=S$e));for(S$k=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,S$k-1)&&0<S$k;)S$k--;if(S$k<this._clipIndex)for(S$B=S$k;S$B<this._clipIndex;S$B++)this._createGraphics(S$B)}this._createGraphics()}}},S$a._createGraphics=function(S$a){void 0===S$a&&(S$a=-1),-1==S$a&&(S$a=this._clipIndex);var S$m,S$s,S$P=S$a*this._player.cacheFrameRateInterval,S$_=this._templet.drawOrderAniArr[this._aniClipIndex];if(S$_&&0<S$_.length)for(this._drawOrderIndex=0,S$m=S$_[this._drawOrderIndex];S$P>=S$m.time&&(this._drawOrder=S$m.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=S$_.length));)S$m=S$_[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=S$Z.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=S$Z.create(),S$s=this.graphics;var S$e=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],S$a,S$P);var S$A,S$B,S$k,S$j,S$G=this._aniSectionDic[this._aniClipIndex],S$y=0,S$d=0,S$Q=0,S$q=0,S$h=0,S$u=this._templet.srcBoneMatrixArr.length;for(S$h=S$G[S$d=0];S$d<S$u;S$d++)S$j=this._boneList[S$d],S$k=this._templet.srcBoneMatrixArr[S$d],S$j.resultTransform.scX=S$k.scX*this._curOriginalData[S$y++],S$j.resultTransform.skX=S$k.skX+this._curOriginalData[S$y++],S$j.resultTransform.skY=S$k.skY+this._curOriginalData[S$y++],S$j.resultTransform.scY=S$k.scY*this._curOriginalData[S$y++],S$j.resultTransform.x=S$k.x+this._curOriginalData[S$y++],S$j.resultTransform.y=S$k.y+this._curOriginalData[S$y++],8===this._templet.tMatrixDataLen&&(S$j.resultTransform.skewX=S$k.skewX+this._curOriginalData[S$y++],S$j.resultTransform.skewY=S$k.skewY+this._curOriginalData[S$y++]);var S$O,S$p={},S$c={};for(S$h+=S$G[1];S$d<S$h;S$d++)S$p[(S$O=S$e[S$d]).name]=this._curOriginalData[S$y++],S$c[S$O.name]=this._curOriginalData[S$y++],this._curOriginalData[S$y++],this._curOriginalData[S$y++],this._curOriginalData[S$y++],this._curOriginalData[S$y++];var S$H,S$o,S$N={},S$z={};for(S$h+=S$G[2];S$d<S$h;S$d++)S$N[(S$O=S$e[S$d]).name]=this._curOriginalData[S$y++],S$z[S$O.name]=this._curOriginalData[S$y++],this._curOriginalData[S$y++],this._curOriginalData[S$y++],this._curOriginalData[S$y++],this._curOriginalData[S$y++];if(this._pathDic)for(S$h+=S$G[3];S$d<S$h;S$d++){if(S$O=S$e[S$d],S$H=this._pathDic[S$O.name])switch(new S$Va(S$O.extenData).getByte()){case 1:S$H.position=this._curOriginalData[S$y++];break;case 2:S$H.spacing=this._curOriginalData[S$y++];break;case 3:S$H.rotateMix=this._curOriginalData[S$y++],S$H.translateMix=this._curOriginalData[S$y++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(S$Wa.TEMP.identity()),this._ikArr)for(S$d=0,S$h=this._ikArr.length;S$d<S$h;S$d++)S$o=this._ikArr[S$d],S$N.hasOwnProperty(S$o.name)&&(S$o.bendDirection=S$N[S$o.name]),S$z.hasOwnProperty(S$o.name)&&(S$o.mix=S$z[S$o.name]),S$o.apply();if(this._pathDic)for(var S$U in this._pathDic)(S$H=this._pathDic[S$U]).apply(this._boneList,S$s);if(this._tfArr)for(S$d=0,S$q=this._tfArr.length;S$d<S$q;S$d++)this._tfArr[S$d].apply();for(S$d=0,S$q=this._boneList.length;S$d<S$q;S$d++)if(S$j=this._boneList[S$d],S$B=this._bindBoneBoneSlotDic[S$j.name],S$j.resultMatrix.copyTo(this._boneMatrixArray[S$d]),S$B)for(S$Q=0,S$h=S$B.length;S$Q<S$h;S$Q++)(S$A=S$B[S$Q])&&S$A.setParentMatrix(S$j.resultMatrix);var S$l,S$C,S$f,S$K,S$V={},S$W=this._templet.deformAniArr;if(S$W&&0<S$W.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,S$d=0,S$h=this._boneSlotArray.length;S$d<S$h;S$d++)(S$A=this._boneSlotArray[S$d]).deformData=null;var S$b,S$S=S$W[this._aniClipIndex];for(S$b in S$l=S$S.default,this._setDeform(S$l,S$V,this._boneSlotArray,S$P),S$S)"default"!=S$b&&S$b!=this._skinName&&(S$l=S$S[S$b],this._setDeform(S$l,S$V,this._boneSlotArray,S$P));S$l=S$S[this._skinName],this._setDeform(S$l,S$V,this._boneSlotArray,S$P)}if(this._drawOrder)for(S$d=0,S$h=this._drawOrder.length;S$d<S$h;S$d++)S$C=S$p[(S$A=this._boneSlotArray[this._drawOrder[S$d]]).name],S$f=S$c[S$A.name],isNaN(S$f)||(S$s.save(),S$s.alpha(S$f)),isNaN(S$C)||-2==S$C||(this._templet.attachmentNames?S$A.showDisplayByName(this._templet.attachmentNames[S$C]):S$A.showDisplayByIndex(S$C)),S$V[this._drawOrder[S$d]]?(S$K=S$V[this._drawOrder[S$d]],S$A.currDisplayData&&S$K[S$A.currDisplayData.attachmentName]?S$A.deformData=S$K[S$A.currDisplayData.attachmentName]:S$A.deformData=null):S$A.deformData=null,isNaN(S$f)?S$A.draw(S$s,this._boneMatrixArray,2==this._aniMode):S$A.draw(S$s,this._boneMatrixArray,2==this._aniMode,S$f),isNaN(S$f)||S$s.restore();else for(S$d=0,S$h=this._boneSlotArray.length;S$d<S$h;S$d++)S$C=S$p[(S$A=this._boneSlotArray[S$d]).name],S$f=S$c[S$A.name],isNaN(S$f)||(S$s.save(),S$s.alpha(S$f)),isNaN(S$C)||-2==S$C||(this._templet.attachmentNames?S$A.showDisplayByName(this._templet.attachmentNames[S$C]):S$A.showDisplayByIndex(S$C)),S$V[S$d]?(S$K=S$V[S$d],S$A.currDisplayData&&S$K[S$A.currDisplayData.attachmentName]?S$A.deformData=S$K[S$A.currDisplayData.attachmentName]:S$A.deformData=null):S$A.deformData=null,isNaN(S$f)?S$A.draw(S$s,this._boneMatrixArray,2==this._aniMode):S$A.draw(S$s,this._boneMatrixArray,2==this._aniMode,S$f),isNaN(S$f)||S$s.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,S$a,S$s):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,S$a,S$s)},S$a._setDeform=function(S$a,S$m,S$s,S$P){if(S$a){var S$_,S$e,S$A,S$B=0,S$k=0,S$j=0;if(S$a)for(S$B=0,S$k=S$a.deformSlotDataList.length;S$B<S$k;S$B++)for(S$_=S$a.deformSlotDataList[S$B],S$j=0;S$j<S$_.deformSlotDisplayList.length;S$j++)S$A=S$s[(S$e=S$_.deformSlotDisplayList[S$j]).slotIndex],S$e.apply(S$P,S$A),S$m[S$e.slotIndex]||(S$m[S$e.slotIndex]={}),S$m[S$e.slotIndex][S$e.attachment]=S$e.deformData}},S$a.getAnimNum=function(){return this._templet.getAnimationCount()},S$a.getAniNameByIndex=function(S$a){return this._templet.getAniNameByIndex(S$a)},S$a.getSlotByName=function(S$a){return this._boneSlotDic[S$a]},S$a.showSkinByName=function(S$a,S$m){void 0===S$m&&(S$m=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(S$a),S$m)},S$a.showSkinByIndex=function(S$a,S$m){void 0===S$m&&(S$m=!0);for(var S$s=0;S$s<this._boneSlotArray.length;S$s++)this._boneSlotArray[S$s].showSlotData(null,S$m);if(this._templet.showSkinByIndex(this._boneSlotDic,S$a,S$m)){var S$P=this._templet.skinDataArray[S$a];this._skinIndex=S$a,this._skinName=S$P.name}this._clearCache()},S$a.showSlotSkinByIndex=function(S$a,S$m){if(0!=this._aniMode){var S$s=this.getSlotByName(S$a);S$s&&S$s.showDisplayByIndex(S$m),this._clearCache()}},S$a.showSlotSkinByName=function(S$a,S$m){if(0!=this._aniMode){var S$s=this.getSlotByName(S$a);S$s&&S$s.showDisplayByName(S$m),this._clearCache()}},S$a.replaceSlotSkinName=function(S$a,S$m,S$s){if(0!=this._aniMode){var S$P=this.getSlotByName(S$a);S$P&&S$P.replaceDisplayByName(S$m,S$s),this._clearCache()}},S$a.replaceSlotSkinByIndex=function(S$a,S$m,S$s){if(0!=this._aniMode){var S$P=this.getSlotByName(S$a);S$P&&S$P.replaceDisplayByIndex(S$m,S$s),this._clearCache()}},S$a.setSlotSkin=function(S$a,S$m){if(0!=this._aniMode){var S$s=this.getSlotByName(S$a);S$s&&S$s.replaceSkin(S$m),this._clearCache()}},S$a._clearCache=function(){if(1==this._aniMode)for(var S$a=0,S$m=this._graphicsCache.length;S$a<S$m;S$a++){for(var S$s=0,S$P=this._graphicsCache[S$a].length;S$s<S$P;S$s++){var S$_=this._graphicsCache[S$a][S$s];S$_!=this.graphics&&S$Z.recycle(S$_)}this._graphicsCache[S$a].length=0}},S$a.play=function(S$a,S$m,S$s,S$P,S$_,S$e){void 0===S$s&&(S$s=!0),void 0===S$P&&(S$P=0),void 0===S$_&&(S$_=0),void 0===S$e&&(S$e=!0),this._indexControl=!1;var S$A=-1,S$B=NaN;if(S$B=S$m?2147483647:0,"string"==typeof S$a)for(var S$k=0,S$j=this._templet.getAnimationCount();S$k<S$j;S$k++){var S$G=this._templet.getAnimation(S$k);if(S$G&&S$a==S$G.name){S$A=S$k;break}}else S$A=S$a;-1<S$A&&S$A<this.getAnimNum()&&(this._aniClipIndex=S$A,(S$s||this._pause||this._currAniIndex!=S$A)&&(this._currAniIndex=S$A,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(S$A)),this._drawOrder=null,this._eventIndex=0,this._player.play(S$A,this._player.playbackRate,S$B,S$P,S$_),S$e&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=S$y.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},S$a.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},S$a.playbackRate=function(S$a){this._player&&(this._player.playbackRate=S$a)},S$a.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},S$a.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=S$y.now(),this.timer.frameLoop(1,this,this._update,null,!0))},S$a._getGrahicsDataWithCache=function(S$a,S$m){return this._graphicsCache[S$a][S$m]},S$a._setGrahicsDataWithCache=function(S$a,S$m,S$s){this._graphicsCache[S$a][S$m]=S$s},S$a.destroy=function(S$a){void 0===S$a&&(S$a=!0),S$m.prototype.destroy.call(this,S$a),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},S$e(0,S$a,"url",function(){return this._aniPath},function(S$a){this.load(S$a)}),S$e(0,S$a,"index",function(){return this._index},function(S$a){this.player&&(this._index=S$a,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),S$e(0,S$a,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),S$e(0,S$a,"templet",function(){return this._templet}),S$e(0,S$a,"player",function(){return this._player}),S$s.useSimpleMeshInCanvas=!1,S$s}(S$ea),S$f=function(S$m){function S$_(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,S$_.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}S$P(S$_,"laya.ani.bone.Templet",S$m);var S$a=S$_.prototype;return S$a.getLoadList=function(){return this._loadList},S$a.loadAni=function(S$a){this._skBufferUrl=S$a,S$_a.loader.load(S$a,S$k.create(this,this.onComplete),null,"arraybuffer")},S$a.onComplete=function(S$a){if(this._isDestroyed)this.destroy();else{var S$m=S$j.getRes(this._skBufferUrl);S$m?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,S$m)):this.event("error","load failed:"+this._skBufferUrl)}},S$a.parseData=function(S$a,S$m,S$s){void 0===S$s&&(S$s=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=S$a,this._mainTexture&&S$u.isWebGL&&S$a.bitmap&&(S$a.bitmap.enableMerageInAtlas=!1),this._rate=S$s,this.parse(S$m)},S$a.buildArmature=function(S$a){return void 0===S$a&&(S$a=0),new S$C(this,S$a)},S$a.parse=function(S$a){S$m.prototype.parse.call(this,S$a),this._endLoaded(),this._aniVersion!=S$_.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+S$_.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},S$a._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var S$a=0;this._loadList=[];var S$m,S$s=new S$Va(this.getPublicExtData()),S$P=0,S$_=0,S$e=0,S$A=S$s.getInt32(),S$B=S$s.readUTFString(),S$k=S$B.split("\n");for(S$a=0;S$a<S$A;S$a++)S$m=this._path+S$k[2*S$a],S$B=S$k[2*S$a+1],S$s.getFloat32(),S$s.getFloat32(),S$P=S$s.getFloat32(),S$_=S$s.getFloat32(),S$e=S$s.getFloat32(),isNaN(S$e)?0:S$e,S$e=S$s.getFloat32(),isNaN(S$e)?0:S$e,S$e=S$s.getFloat32(),isNaN(S$e)?S$P:S$e,S$e=S$s.getFloat32(),isNaN(S$e)?S$_:S$e,-1==this._loadList.indexOf(S$m)&&this._loadList.push(S$m);this.event("inited",this)}},S$a._textureComplete=function(){for(var S$a,S$m,S$s=0,S$P=this._loadList.length;S$s<S$P;S$s++)S$m=this._loadList[S$s],S$a=this._textureDic[S$m]=S$j.getRes(S$m),S$u.isWebGL&&S$a&&S$a.bitmap&&(S$a.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},S$a._parsePublicExtData=function(){var S$a=0,S$m=0,S$s=0,S$P=0,S$_=0;for(S$a=0,S$_=this.getAnimationCount();S$a<S$_;S$a++)this._graphicsCache.push([]);var S$e;S$e="Dragon"!=this._aniClassName;var S$A,S$B,S$k=new S$Va(this.getPublicExtData()),S$j=0,S$G=0,S$y=0,S$d=0,S$Q=0,S$q=0,S$h=0,S$u=0,S$O=0,S$p=S$k.getInt32(),S$c=S$k.readUTFString(),S$H=S$c.split("\n");for(S$a=0;S$a<S$p;S$a++){if(S$A=this._mainTexture,S$B=this._path+S$H[2*S$a],S$c=S$H[2*S$a+1],null==this._mainTexture&&(S$A=this._textureDic[S$B]),!S$A)return this.event("error",this),void(this.isParseFail=!0);S$j=S$k.getFloat32(),S$G=S$k.getFloat32(),S$y=S$k.getFloat32(),S$d=S$k.getFloat32(),S$O=S$k.getFloat32(),S$Q=isNaN(S$O)?0:S$O,S$O=S$k.getFloat32(),S$q=isNaN(S$O)?0:S$O,S$O=S$k.getFloat32(),S$h=isNaN(S$O)?S$y:S$O,S$O=S$k.getFloat32(),S$u=isNaN(S$O)?S$d:S$O,this.subTextureDic[S$c]=S$ba.create(S$A,S$j,S$G,S$y,S$d,-S$Q,-S$q,S$h,S$u),S$A.alphaTexture&&(this.subTextureDic[S$c].alphaTexture=S$ba.create(S$A.alphaTexture,S$j,S$G,S$y,S$d,-S$Q,-S$q,S$h,S$u))}this._mainTexture=S$A;var S$o,S$N,S$z,S$U,S$l,S$C=S$k.getUint16();for(S$a=0;S$a<S$C;S$a++)(S$o=[]).push(S$k.getUint16()),S$o.push(S$k.getUint16()),S$o.push(S$k.getUint16()),S$o.push(S$k.getUint16()),this.aniSectionDic[S$a]=S$o;var S$f,S$K=S$k.getInt16(),S$V={};for(S$a=0;S$a<S$K;S$a++)S$N=new S$Sa,0==S$a?S$f=S$N:S$N.root=S$f,S$N.d=S$e?-1:1,S$U=S$k.readUTFString(),S$l=S$k.readUTFString(),S$N.length=S$k.getFloat32(),1==S$k.getByte()&&(S$N.inheritRotation=!1),1==S$k.getByte()&&(S$N.inheritScale=!1),S$N.name=S$U,S$l&&((S$z=S$V[S$l])?S$z.addChild(S$N):this.mRootBone=S$N),S$V[S$U]=S$N,this.mBoneArr.push(S$N);this.tMatrixDataLen=S$k.getUint16();var S$W,S$b,S$S=S$k.getUint16(),S$Z=Math.floor(S$S/this.tMatrixDataLen),S$X=this.srcBoneMatrixArr;for(S$a=0;S$a<S$Z;S$a++)(S$W=new S$ga).scX=S$k.getFloat32(),S$W.skX=S$k.getFloat32(),S$W.skY=S$k.getFloat32(),S$W.scY=S$k.getFloat32(),S$W.x=S$k.getFloat32(),S$W.y=S$k.getFloat32(),8===this.tMatrixDataLen&&(S$W.skewX=S$k.getFloat32(),S$W.skewY=S$k.getFloat32()),S$X.push(S$W),(S$N=this.mBoneArr[S$a]).transform=S$W;var S$E,S$i=S$k.getUint16(),S$t=0;for(S$a=0;S$a<S$i;S$a++){for(S$b=new S$Ra,S$t=S$k.getUint16(),S$m=0;S$m<S$t;S$m++)S$b.boneNames.push(S$k.readUTFString()),S$b.boneIndexs.push(S$k.getInt16());S$b.name=S$k.readUTFString(),S$b.targetBoneName=S$k.readUTFString(),S$b.targetBoneIndex=S$k.getInt16(),S$b.bendDirection=S$k.getFloat32(),S$b.mix=S$k.getFloat32(),S$b.isSpine=S$e,this.ikArr.push(S$b)}var S$L,S$R=S$k.getUint16(),S$F=0;for(S$a=0;S$a<S$R;S$a++){for(S$E=new S$Da,S$F=S$k.getUint16(),S$m=0;S$m<S$F;S$m++)S$E.boneIndexs.push(S$k.getInt16());S$E.name=S$k.getUTFString(),S$E.targetIndex=S$k.getInt16(),S$E.rotateMix=S$k.getFloat32(),S$E.translateMix=S$k.getFloat32(),S$E.scaleMix=S$k.getFloat32(),S$E.shearMix=S$k.getFloat32(),S$E.offsetRotation=S$k.getFloat32(),S$E.offsetX=S$k.getFloat32(),S$E.offsetY=S$k.getFloat32(),S$E.offsetScaleX=S$k.getFloat32(),S$E.offsetScaleY=S$k.getFloat32(),S$E.offsetShearY=S$k.getFloat32(),this.tfArr.push(S$E)}var S$x=S$k.getUint16(),S$M=0;for(S$a=0;S$a<S$x;S$a++){for((S$L=new S$Fa).name=S$k.readUTFString(),S$M=S$k.getUint16(),S$m=0;S$m<S$M;S$m++)S$L.bones.push(S$k.getInt16());S$L.target=S$k.readUTFString(),S$L.positionMode=S$k.readUTFString(),S$L.spacingMode=S$k.readUTFString(),S$L.rotateMode=S$k.readUTFString(),S$L.offsetRotation=S$k.getFloat32(),S$L.position=S$k.getFloat32(),S$L.spacing=S$k.getFloat32(),S$L.rotateMix=S$k.getFloat32(),S$L.translateMix=S$k.getFloat32(),this.pathArr.push(S$L)}var S$J,S$D,S$g,S$w,S$v,S$Y=0,S$T=0,S$I=0,S$$=NaN,S$n=0,S$r=S$k.getInt16();for(S$a=0;S$a<S$r;S$a++){var S$aa=S$k.getUint8(),S$ma={};this.deformAniArr.push(S$ma);for(var S$sa=0;S$sa<S$aa;S$sa++)for((S$J=new S$Xa).skinName=S$k.getUTFString(),S$ma[S$J.skinName]=S$J,S$Y=S$k.getInt16(),S$m=0;S$m<S$Y;S$m++)for(S$D=new S$Ea,S$J.deformSlotDataList.push(S$D),S$T=S$k.getInt16(),S$s=0;S$s<S$T;S$s++)for(S$g=new S$ia,S$D.deformSlotDisplayList.push(S$g),S$g.slotIndex=S$k.getInt16(),S$g.attachment=S$k.getUTFString(),S$I=S$k.getInt16(),S$P=0;S$P<S$I;S$P++)for(1==S$k.getByte()?S$g.tweenKeyList.push(!0):S$g.tweenKeyList.push(!1),S$$=S$k.getFloat32(),S$g.timeList.push(S$$),S$w=[],S$g.vectices.push(S$w),S$n=S$k.getInt16(),S$_=0;S$_<S$n;S$_++)S$w.push(S$k.getFloat32())}var S$Pa,S$_a,S$ea=S$k.getInt16(),S$Aa=0,S$Ba=0;for(S$a=0;S$a<S$ea;S$a++){for(S$Aa=S$k.getInt16(),S$v=[],S$m=0;S$m<S$Aa;S$m++){for((S$Pa=new S$ta).time=S$k.getFloat32(),S$Ba=S$k.getInt16(),S$s=0;S$s<S$Ba;S$s++)S$Pa.drawOrder.push(S$k.getInt16());S$v.push(S$Pa)}this.drawOrderAniArr.push(S$v)}var S$ka,S$ja=S$k.getInt16(),S$Ga=0;for(S$a=0;S$a<S$ja;S$a++){for(S$Ga=S$k.getInt16(),S$_a=[],S$m=0;S$m<S$Ga;S$m++)(S$ka=new S$La).name=S$k.getUTFString(),S$ka.intValue=S$k.getInt32(),S$ka.floatValue=S$k.getFloat32(),S$ka.stringValue=S$k.getUTFString(),S$ka.time=S$k.getFloat32(),S$_a.push(S$ka);this.eventAniArr.push(S$_a)}var S$ya=S$k.getInt16();if(0<S$ya)for(this.attachmentNames=[],S$a=0;S$a<S$ya;S$a++)this.attachmentNames.push(S$k.getUTFString());var S$da,S$Qa,S$qa=S$k.getInt16();for(S$a=0;S$a<S$qa;S$a++)(S$da=new S$Za).name=S$k.readUTFString(),S$da.parent=S$k.readUTFString(),S$da.attachmentName=S$k.readUTFString(),S$da.srcDisplayIndex=S$da.displayIndex=S$k.getInt16(),(S$da.templet=this).boneSlotDic[S$da.name]=S$da,null==(S$Qa=this.bindBoneBoneSlotDic[S$da.parent])&&(this.bindBoneBoneSlotDic[S$da.parent]=S$Qa=[]),S$Qa.push(S$da),this.boneSlotArray.push(S$da);var S$ha,S$ua,S$Oa,S$pa=S$k.readUTFString().split("\n"),S$ca=0,S$Ha=S$k.getUint8(),S$oa=0,S$Na=0,S$za=0,S$Ua=0,S$la=0,S$Ca=0,S$fa=0;for(S$a=0;S$a<S$Ha;S$a++){for((S$ha=new S$xa).name=S$pa[S$ca++],S$oa=S$k.getUint8(),S$m=0;S$m<S$oa;S$m++){for((S$ua=new S$Ja).name=S$pa[S$ca++],S$da=this.boneSlotDic[S$ua.name],S$Na=S$k.getUint8(),S$s=0;S$s<S$Na;S$s++){if(S$Oa=new S$Ma,this.skinSlotDisplayDataArr.push(S$Oa),S$Oa.name=S$pa[S$ca++],S$Oa.attachmentName=S$pa[S$ca++],S$Oa.transform=new S$ga,S$Oa.transform.scX=S$k.getFloat32(),S$Oa.transform.skX=S$k.getFloat32(),S$Oa.transform.skY=S$k.getFloat32(),S$Oa.transform.scY=S$k.getFloat32(),S$Oa.transform.x=S$k.getFloat32(),S$Oa.transform.y=S$k.getFloat32(),S$ua.displayArr.push(S$Oa),S$Oa.width=S$k.getFloat32(),S$Oa.height=S$k.getFloat32(),S$Oa.type=S$k.getUint8(),S$Oa.verLen=S$k.getUint16(),0<(S$K=S$k.getUint16()))for(S$Oa.bones=[],S$P=0;S$P<S$K;S$P++){var S$Ka=S$k.getUint16();S$Oa.bones.push(S$Ka)}if(0<(S$za=S$k.getUint16()))for(S$Oa.uvs=[],S$P=0;S$P<S$za;S$P++)S$Oa.uvs.push(S$k.getFloat32());if(0<(S$Ua=S$k.getUint16()))for(S$Oa.weights=[],S$P=0;S$P<S$Ua;S$P++)S$Oa.weights.push(S$k.getFloat32());if(0<(S$la=S$k.getUint16()))for(S$Oa.triangles=[],S$P=0;S$P<S$la;S$P++)S$Oa.triangles.push(S$k.getUint16());if(0<(S$Ca=S$k.getUint16()))for(S$Oa.vertices=[],S$P=0;S$P<S$Ca;S$P++)S$Oa.vertices.push(S$k.getFloat32());if(0<(S$fa=S$k.getUint16()))for(S$Oa.lengths=[],S$P=0;S$P<S$fa;S$P++)S$Oa.lengths.push(S$k.getFloat32())}S$ha.slotArr.push(S$ua)}this.skinDic[S$ha.name]=S$ha,this.skinDataArray.push(S$ha)}1==S$k.getUint8()?(this.yReverseMatrix=new S$Wa(1,0,0,-1,0,0),S$f&&S$f.setTempMatrix(this.yReverseMatrix)):S$f&&S$f.setTempMatrix(new S$Wa),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},S$a.getTexture=function(S$a){var S$m=this.subTextureDic[S$a];return S$m||(S$m=this.subTextureDic[S$a.substr(0,S$a.length-1)]),null==S$m?this._mainTexture:S$m},S$a.showSkinByIndex=function(S$a,S$m,S$s){if(void 0===S$s&&(S$s=!0),S$m<0&&S$m>=this.skinDataArray.length)return!1;var S$P,S$_,S$e=0,S$A=0,S$B=this.skinDataArray[S$m];if(S$B){for(S$e=0,S$A=S$B.slotArr.length;S$e<S$A;S$e++)(S$_=S$B.slotArr[S$e])&&(S$P=S$a[S$_.name])&&(S$P.showSlotData(S$_,S$s),S$s&&"undefined"!=S$P.attachmentName&&"null"!=S$P.attachmentName?S$P.showDisplayByName(S$P.attachmentName):S$P.showDisplayByIndex(S$P.displayIndex));return!0}return!1},S$a.getSkinIndexByName=function(S$a){for(var S$m=0,S$s=this.skinDataArray.length;S$m<S$s;S$m++)if(this.skinDataArray[S$m].name==S$a)return S$m;return-1},S$a.getGrahicsDataWithCache=function(S$a,S$m){return this._graphicsCache[S$a][S$m]},S$a.setGrahicsDataWithCache=function(S$a,S$m,S$s){this._graphicsCache[S$a][S$m]=S$s},S$a.destroy=function(){var S$a;for(var S$m in this._isDestroyed=!0,this.subTextureDic)(S$a=this.subTextureDic[S$m])&&S$a.destroy();for(S$m in this._textureDic)(S$a=this._textureDic[S$m])&&S$a.destroy();for(var S$s=0,S$P=this.skinSlotDisplayDataArr.length;S$s<S$P;S$s++)this.skinSlotDisplayDataArr[S$s].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete S$_.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},S$a.getAniNameByIndex=function(S$a){var S$m=this.getAnimation(S$a);return S$m?S$m.name:null},S$e(0,S$a,"rate",function(){return this._rate},function(S$a){this._rate=S$a}),S$_.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",S$_.TEMPLET_DICTIONARY=null,S$_}(S$X)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(S$a,S$m){"use strict";for(var S$s in Object.defineProperty(S$m,"__esModule",{value:!0}),Laya){var S$P=Laya[S$s];S$P&&S$P.__isclass&&(S$m[S$s]=S$P)}});