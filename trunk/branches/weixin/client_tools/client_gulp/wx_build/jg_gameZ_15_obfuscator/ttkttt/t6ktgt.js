var P=wx.$y;import{default as ONEFIVE}from"../utils/onefiveSdk";var sdk=new ONEFIVE;var config={game_id:256,game_pkg:P[1790],partner_label:P[1791],partner_id:P[1792],game_ver:P[1793],tmpId:{1:P[1794],2:P[1795],3:P[1796]},is_auth:!1};window.config=config;var P__U9GV=P__9VGU();var HOST=P[1797];var P__U9VG=null;var P__9GVU=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;function P__9VGU(){var n={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(P[1798]);var t=this;var o;o=wx.getStorageSync(P[1799])?0:(o=t.uuid(16,32),wx.setStorageSync(P[1799],o),1),wx.getStorageSync(P[1800])||(n=t.uuid(16,32),wx.setStorageSync(P[1800],n));var n=wx.getLaunchOptionsSync();var a=n.scene||"";o&&n.query&&n.query.ad_code&&wx.setStorageSync(P[1801],n.query.ad_code),t.log(P[1802],{install:o,scene:a}),wx.showShareMenu();t=n.query&&n.query.invite?n.query.invite:"";n=n.query&&n.query.invite_type?n.query.invite_type:"";t&&(P__9GVU={invite:t,invite_type:n,is_new:o,scene:a}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(P[1803]),n[P[261]]=typeof r==P[1002]?r:null;var t=this;sdk.init({},function(e,r){1==e?(console.log(P[1804]),sdk.login(function(e,r){1==e?(console.log(P[1805]),partner_user_info=r,t.do_login(r)):0==e&&console.log(P[1806]+r.msg)})):0==e&&console.log(P[1807]+r.msg)})},do_login:function(e){var t=this;var r=t.getPublicData();if(r[P[1808]]=JSON.stringify(e),P__9GVU&&typeof P__9GVU==P[902])for(var o in P__9GVU)r[o]=P__9GVU[o];wx.request({url:P[1809]+HOST+P[1810],method:P[225],dataType:P[1247],header:{"content-type":P[400]},data:r,success:function(e){if(console.log(P[1811]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(P[1812],e.data.sdk_token),wx.setStorageSync(P[1813],e.data.user_id),wx.setStorageSync(P[1814],e.data.username),e.data.ext&&wx.setStorageSync(P[1815],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};n[P[261]]&&n[P[261]](0,r)}else n[P[261]]&&n[P[261]](1,{errMsg:e.msg});t.getShareInfo(P[1816],function(e){console.log(P[1817]),sdk.onShareAppMessage({query:e.query})})}else n[P[261]]&&n[P[261]](1,{errMsg:P[1818]})}})},share:function(e){n[P[357]]=typeof callback==P[1002]?callback:null;var r=e.type||P[357];console.log(P[1819]+r);var t=this;this.getShareInfo(r,function(n){t.logStartShare(r);n.query;sdk.userShare({},function(e,r){var t,o;1==e&&(e=n.query,t=n.title,o=n.img,wx.shareAppMessage({title:r.title||t,imageUrl:r.imageUrl||o,query:e+"&"+r.query}))})})},logStartShare:function(e){var r=wx.getStorageSync(P[1812]);wx.request({url:P[1809]+HOST+P[1820],method:P[225],dataType:P[1247],header:{"content-type":P[400]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:P__U9VG?P__U9VG.server_id:"",role_id:P__U9VG?P__U9VG.role_id:"",type:e},success:function(e){}})},openService:function(){},checkGameVersion:function(e,t){console.log(P[1821]);wx.getStorageSync(P[1812]);wx.request({url:P[1809]+HOST+P[1822],method:P[225],dataType:P[1247],header:{"content-type":P[400]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(P[1823]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?t&&t(r.data):t&&t({develop:0})}})},getShareInfo:function(e,r){console.log(P[1824]);var t=wx.getStorageSync(P[1812]);wx.request({url:P[1809]+HOST+P[1825],method:P[225],dataType:P[1247],header:{"content-type":P[400]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:P__U9VG?P__U9VG.server_id:"",role_id:P__U9VG?P__U9VG.role_id:"",no_log:1},success:function(e){console.log(P[1826]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):n[P[357]]&&n[P[357]](1,{errMsg:P[1827]+e.msg}):n[P[357]]&&n[P[357]](1,{errMsg:P[1828]})}})},updateShare:function(e,r,t,o,n,a){console.log(P[1829]);var i=wx.getStorageSync(P[1812]);wx.request({url:P[1809]+HOST+P[1830],method:P[225],dataType:P[1247],header:{"content-type":P[400]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:t,role_id:o,sever_id:n,scene:a},success:function(e){console.log(P[1831]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(P[1832]+e);wx.request({url:P[1809]+HOST+P[1833]+config.partner_id+"/"+config.game_pkg,method:P[225],dataType:P[1247],header:{"content-type":P[400]},data:{content:e,uid:partner_user_info.userId},success:function(e){console.log(P[1834]+JSON.stringify(e)),console.log(e),r&&r(e)}})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(P[1835]+JSON.stringify(e));var t=this;n[P[339]]=typeof r==P[1002]?r:null;r=wx.getStorageSync(P[1812]);var o=wx.getStorageSync(P[1815]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:o,platform:platform},t.order_data=e,(r=t.getPublicData())[P[1837]]=JSON.stringify(e),wx.request({url:P[1809]+HOST+P[1838],method:P[225],dataType:P[1247],header:{"content-type":P[400]},data:r,success:function(e){console.log(P[1839]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?""==e.data.ext?sdk.pay(e.data.pay_data,function(e,r){1==e?console.log(P[1840]):0==e&&console.log(P[1841]+r.msg)}):t.extDo({ext1:e.data.ext,ext2:e.data.pay_data}):n[P[339]]&&n[P[339]](1,{errMsg:e.msg}):n[P[261]]&&n[P[261]](1,{errMsg:P[1818]})}})):n[P[339]]&&n[P[339]](1,{errMsg:P[1836]})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:P[1842]+e.ext2.trade_id+P[1843]+e.ext2.total_fee/100,extraData:{},envVersion:P[1844],success(e){}})},logCreateRole:function(e){var r=wx.getStorageSync(P[1813]);var t=wx.getStorageSync(P[1814]);var o={};o[P[1845]]=r,o[P[1846]]=t,o[P[1847]]=e.roleid,o[P[1848]]=e.rolelevel,o[P[1849]]=e.rolename,o[P[24]]=e.serverid,e.roleid&&e.serverid&&(P__U9VG={role_id:e.roleid,server_id:e.serverid});r=Date.parse(new Date).toString();r=r.substr(0,10),this.log(P[481],o);t={createTime:r,serverId:e.serverid,serverName:e.servername,roleId:e.roleid,roleName:e.rolename,roleLevel:0,payLevel:0,dataType:1};sdk.roleLog(t)},logEnterGame:function(e){var r=wx.getStorageSync(P[1813]);var t=wx.getStorageSync(P[1814]);var o={};o[P[1845]]=r,o[P[1846]]=t,o[P[1847]]=e.roleid,o[P[1848]]=e.rolelevel,o[P[1849]]=e.rolename,o[P[24]]=e.serverid,e.roleid&&e.serverid&&(P__U9VG={role_id:e.roleid,server_id:e.serverid}),this.log(P[1850],o),P__9GVU&&this.updateShare(P__9GVU.invite,P__9GVU.invite_type,P__9GVU.is_new,e.roleid,e.serverid,P__9GVU.scene);r={createTime:e.rolecreatetime,serverId:e.serverid,serverName:e.servername,roleId:e.roleid,roleName:e.rolename,roleLevel:e.rolelevel,payLevel:0,dataType:2};sdk.roleLog(r)},paySwitch(e,t){sdk.getPayState(e,function(e,r){1==e?1==r.switch?t(0):t(1):0==e&&t(0)})},logRoleUpLevel:function(e){var r=wx.getStorageSync(P[1813]);var t=wx.getStorageSync(P[1814]);var o={};o[P[1845]]=r,o[P[1846]]=t,o[P[1847]]=e.roleid,o[P[1848]]=e.rolelevel,o[P[1849]]=e.rolename,o[P[24]]=e.serverid,e.roleid&&e.serverid&&(P__U9VG={role_id:e.roleid,server_id:e.serverid,server_name:e.servername,role_name:e.rolename,role_level:e.rolelevel,role_createtime:e.rolecreatetime}),this.log(P[1851],o);r={createTime:e.rolecreatetime,serverId:e.serverid,serverName:e.servername,roleId:e.roleid,roleName:e.rolename,roleLevel:e.rolelevel,payLevel:0,dataType:3};sdk.roleLog(r)},uuid:function(e,r){var t=P[1852].split("");var o,n=[];var a;if(e=e||t.length,r)for(o=0;o<r;o++)n[o]=t[0|Math.random()*e];else for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",o=0;o<36;o++)n[o]||(a=0|16*Math.random(),n[o]=t[19==o?3&a|8:a]);return n.join("")},getPublicData:function(){var e=wx.getStorageSync(P[1799]);var r=wx.getStorageSync(P[1800]);var t=wx.getStorageSync(P[1801]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:t,uuid:e,idfv:r,mac:P[1853],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":P[1854],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==P[111]?1:2}},log:function(e,r){var t=this.getPublicData();for(var o in r)t[o]=r[o];console.log(P[1855]+e),console.log(t),wx.request({url:P[1809]+HOST+P[1856]+e+P[1857]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))},subscribeMessage:function(e,r){console.log(P[1858]+e),n[P[368]]=typeof r==P[1002]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(P[1859]),console.log(e),n[P[368]]&&n[P[368]](e)},fail(e){console.log(P[1860]),console.log(e),n[P[368]]&&n[P[368]](e)}})}}}function run(e,r,t){e in P__U9GV&&P__U9GV[e](r,t)}exports.init=function(e,r){run(P[238],e,r)},exports.login=function(e){run(P[261],"",e)},exports.login=function(e){run(P[261],"",e)},exports.pay=function(e,r){run(P[339],e,r)},exports.openService=function(){run(P[358])},exports.logCreateRole=function(e,r,t,o,n,a){run(P[352],{serverid:e,servername:r,roleid:t,rolename:o,rolelevel:n,rolecreatetime:a})},exports.logEnterGame=function(e,r,t,o,n,a){run(P[354],{serverid:e,servername:r,roleid:t,rolename:o,rolelevel:n,rolecreatetime:a})},exports.logRoleUpLevel=function(e,r,t,o,n,a){run(P[356],{serverid:e,servername:r,roleid:t,rolename:o,rolelevel:n,rolecreatetime:a})},exports.paySwitch=function(e,r,t,o,n,a,i){run(P[1861],{serverid:e,servername:r,roleid:t,rolename:o,rolelevel:n,rolecreatetime:a},i)},exports.share=function(e){run(P[357],{type:e})},exports.msgCheck=function(e,r){run(P[201],e,r)},exports.downloadClient=function(){run(P[1862])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(P[1863])},exports.weiduanHelper=function(){run(P[360])},exports.setMessageToFriendQuery=function(e,r){run(P[1864],e,r)},exports.subscribeMessage=function(e,r){run(P[368],e,r)};