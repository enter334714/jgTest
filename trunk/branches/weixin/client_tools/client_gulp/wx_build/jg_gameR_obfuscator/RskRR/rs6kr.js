var I=wx.$X;require(I[22921]);var config={game_id:I[22922],game_pkg:I[22923],partner_label:I[22924],partner_id:I[22925],game_ver:I[22926],platId:1e3,gameId:289,channelVer:I[22927],mode:2,is_auth:!0};window.config=config;var rUYESF=rUEFSY();var HOST=I[22928];var rUYEFS=null;var rUESFY=null;var partner_data={};function rUEFSY(){var l={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(I[22929]);var a=this;var t;t=wx.getStorageSync(I[22930])?0:(t=a.uuid(16,32),wx.setStorageSync(I[22930],t),1),wx.getStorageSync(I[22931])||(o=a.uuid(16,32),wx.setStorageSync(I[22931],o));var o=wx.getLaunchOptionsSync();var n=o.scene||"";t&&o.query&&o.query.ad_code&&wx.setStorageSync(I[22932],o.query.ad_code),a.log("start",{install:t,scene:n});ddtSDKPlat.init({platId:config.platId,gameId:config.gameId,channelVer:config.channelVer,mode:config.mode},function(e,r){switch(e){case I[22933]:console.log(I[22934],e,r);break;case I[22935]:console.log(I[22936],e,r);break;case I[22937]:console.log(I[22938],e,r),a.do_login(r);break;case I[22939]:console.log(I[22940],e,r),l[I[19744]]&&l[I[19744]](1,{errMsg:r.msg});break;case I[22941]:console.log(I[22942],e,r);break;case I[22943]:console.log(I[22944],e,r),l[I[19773]]&&l[I[19773]](1,{errMsg:r.errMsg})}},!0),wx.showShareMenu({withShareTicket:!0}),console.log(I[22945]+ddtSDKPlat.version);var i=o.query&&o.query.invite?o.query.invite:"";o=o.query&&o.query.invite_type?o.query.invite_type:"";i&&(rUESFY={invite:i,invite_type:o,is_new:t,scene:n}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(I[22946]),l[I[19744]]=typeof r==I[19841]?r:null},do_login:function(e){var a=this;partner_data={uid:e.uid,gameToken:e.gameToken,time:e.time,sign:e.sign};var r=a.getPublicData();if(r.is_from_min=1,r.partner_data=JSON.stringify(partner_data),rUESFY&&typeof rUESFY==I[147])for(var t in rUESFY)r[t]=rUESFY[t];wx.request({url:I[17156]+HOST+"/partner/auth",method:I[19719],dataType:I[3304],header:{"content-type":"application/x-www-form-urlencoded"},data:r,success:function(e){if(console.log(I[22947]),console.log(e),200===e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(I[22948],e.data.sdk_token),wx.setStorageSync(I[22949],e.data.user_id),wx.setStorageSync("plat_username",e.data.username),e.data.ext&&wx.setStorageSync(I[22950],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};l[I[19744]]&&l[I[19744]](0,r)}else l[I[19744]]&&l[I[19744]](1,{errMsg:e.msg});a.getShareInfo(I[22951],function(e){console.log(I[22952]),wx.onShareAppMessage(function(){return a.logStartShare(I[22951]),{title:e.title,imageUrl:e.img,query:e.query}})})}else l[I[19744]]&&l[I[19744]](1,{errMsg:I[22953]})}})},share:function(e){l.share=typeof callback==I[19841]?callback:null;var r=e.type||"share";console.log(I[22954]+r);var a=this;this.getShareInfo(r,function(e){a.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(I[22948]);wx.request({url:I[17156]+HOST+"/game/min/?ac=logStartShare",method:I[19719],dataType:I[3304],header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:rUYEFS?rUYEFS.server_id:"",role_id:rUYEFS?rUYEFS.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,a){console.log(I[22955]);wx.getStorageSync(I[22948]);wx.request({url:I[17156]+HOST+"/game/min/?ac=checkGameVersion",method:I[19719],dataType:I[3304],header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(I[22956]),console.log(e),200==e.statusCode&&(r=e.data).state?a&&a(r.data):a&&a({develop:0})}})},getShareInfo:function(e,r){console.log(I[22957]);var a=wx.getStorageSync(I[22948]);wx.request({url:I[17156]+HOST+"/game/min/?ac=shareConfig",method:I[19719],dataType:I[3304],header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:a,type:e,server_id:rUYEFS?rUYEFS.server_id:"",role_id:rUYEFS?rUYEFS.role_id:"",no_log:1},success:function(e){console.log(I[22958]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):l.share&&l.share(1,{errMsg:I[22959]+e.msg}):l.share&&l.share(1,{errMsg:I[22960]})}})},updateShare:function(e,r,a,t,o,n){console.log(I[22961]);var i=wx.getStorageSync(I[22948]);wx.request({url:I[17156]+HOST+"/game/min/?ac=updateShare",method:I[19719],dataType:I[3304],header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:a,role_id:t,sever_id:o,scene:n},success:function(e){console.log(I[22962]),console.log(e)}})},msgCheck:function(e,r){console.log(I[22963]);var a=wx.getStorageSync(I[22948]);wx.request({url:I[17156]+HOST+"/partner/data/msgSecCheck/"+config.partner_id+"/"+config.game_pkg,method:I[19719],dataType:I[3304],header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:a,content:e,gameToken:partner_data.gameToken,uid:partner_data.uid,channelVer:config.channelVer,gameId:config.gameId,platId:config.platId},success:function(e){console.log(I[22964]),console.log(e),r&&r(e)}})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(I[22965]),console.log(e);var a=this;l[I[19773]]=typeof r==I[19841]?r:null;r=wx.getStorageSync(I[22948]);var t=wx.getStorageSync(I[22950]);var o;r||t?(o=wx.getSystemInfoSync(),e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:o.platform},a.order_data=e,(r=a.getPublicData()).order_data=JSON.stringify(e),r.is_from_min=1,wx.request({url:I[17156]+HOST+"/partner/order",method:I[19719],dataType:I[3304],header:{"content-type":"application/x-www-form-urlencoded"},data:r,success:function(e){var r;console.log(I[22967]),console.log(e),200==e.statusCode?""==(e=e.data).data.ext?e.state&&e.data.pay_data&&""==e.data.ext?(console.log(I[22968]+JSON.stringify(e.data.pay_data)),r={billNo:e.data.pay_data.billNo,amount:e.data.pay_data.amount,serverId:e.data.pay_data.serverId,roleId:e.data.pay_data.roleId,roleName:e.data.pay_data.roleName,roleLevel:e.data.pay_data.roleLevel,subject:e.data.pay_data.subject,productDesc:e.data.pay_data.productDesc,extraInfo:e.data.pay_data.extraInfo},ddtSDKPlat.pay(r)):a.extDo({ext1:e.data.ext,ext2:e.data.pay_data}):l[I[19773]]&&l[I[19773]](1,{errMsg:e.errMsg}):l[I[19744]]&&l[I[19744]](1,{errMsg:I[22953]})}})):l[I[19773]]&&l[I[19773]](1,{errMsg:I[22966]})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:"pages/pay/pay?order_id="+e.ext2.extraInfo+I[22969]+e.ext2.amount,extraData:{},envVersion:"release",success(e){}})},logCreateRole:function(e){var r=wx.getStorageSync(I[22949]);var a=wx.getStorageSync("plat_username");var t={};t.user_id=r,t.user_name=a,t.role_id=e.roleid,t.role_lev=e.rolelevel,t.role_name=e.rolename,t.server_id=e.serverid,e.roleid&&e.serverid&&(rUYEFS={role_id:e.roleid,server_id:e.serverid}),this.log("create",t);r={roleLevel:e.rolelevel+"",roleId:e.roleid+"",roleName:e.rolename,serverName:e.servername,serverId:e.serverid+""};ddtSDKPlat.submitData("createRole",r)},logEnterGame:function(e,r){var a=wx.getStorageSync(I[22949]);var t=wx.getStorageSync("plat_username");var o={};o.user_id=a,o.user_name=t,o.role_id=e.roleid,o.role_lev=e.rolelevel,o.role_name=e.rolename,o.server_id=e.serverid,e.roleid&&e.serverid&&(rUYEFS={role_id:e.roleid,server_id:e.serverid}),this.log("enter",o);a={roleLevel:e.rolelevel,roleId:e.roleid,roleName:e.rolename,serverName:e.servername,serverId:e.serverid};ddtSDKPlat.submitData("enterGame",a),rUESFY&&this.updateShare(rUESFY.invite,rUESFY.invite_type,rUESFY.is_new,e.roleid,e.serverid,rUESFY.scene)},logRoleUpLevel:function(e,r){var a=wx.getStorageSync(I[22949]);var t=wx.getStorageSync("plat_username");this.log(I[22970],e);var o={};o.user_id=a,o.user_name=t,o.role_id=e.roleid,o.role_lev=e.rolelevel,o.role_name=e.rolename,o.server_id=e.serverid,e.roleid&&e.serverid&&(rUYEFS={role_id:e.roleid,server_id:e.serverid,role_level:e.rolelevel,role_createtime:e.rolecreatetime});a={roleLevel:e.rolelevel,roleId:e.roleid,roleName:e.rolename,serverName:e.servername,serverId:e.serverid,rolecreatetime:e.rolecreatetime,vipLevel:"",power:"",roleSex:"",partyId:"",partyName:""};ddtSDKPlat.submitData(I[22971],a)},subscribeMessage:function(e,r){console.log(I[22972]+e),l.subscribeMessage=typeof r==I[19841]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(I[22973]),console.log(e),l.subscribeMessage&&l.subscribeMessage(e)},fail(e){console.log(I[22974]),console.log(e),l.subscribeMessage&&l.subscribeMessage(e)}})},weiduanHelper:function(){console.log(I[22975]),ddtSDKPlat.jump()},uuid:function(e,r){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var t,o=[];var n;if(e=e||a.length,r)for(t=0;t<r;t++)o[t]=a[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",t=0;t<36;t++)o[t]||(n=0|16*Math.random(),o[t]=a[19==t?3&n|8:n]);return o.join("")},getPublicData:function(){var e=wx.getSystemInfoSync();var r=wx.getStorageSync(I[22930]);var a=wx.getStorageSync(I[22931]);var t=wx.getStorageSync(I[22932]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:t,uuid:r,idfv:a,dname:e.model,mac:I[22976],net_type:0==e.wifiSignal?I[22977]:I[22978],os_ver:e.system,sdk_ver:e.version,game_ver:config.game_ver,device:"android"==e.platform?1:2}},log:function(e,r){var a=this.getPublicData();for(var t in r)a[t]=r[t];console.log(I[22979]+e),console.log(a),wx.request({url:I[17156]+HOST+"/partner/h5Log/?type="+e+I[22980]+encodeURIComponent(JSON.stringify(a))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()}}}function run(e,r,a){e in rUYESF&&rUYESF[e](r,a)}exports.init=function(e,r){run(I[203],e,r)},exports.login=function(e){run(I[19744],"",e)},exports.pay=function(e,r){run(I[19773],e,r)},exports.openService=function(){run("openService")},exports.logCreateRole=function(e,r,a,t,o){run("logCreateRole",{serverid:e,servername:r,roleid:a,rolename:t,rolelevel:o})},exports.logEnterGame=function(e,r,a,t,o,n,i){run("logEnterGame",{serverid:e,servername:r,roleid:a,rolename:t,rolelevel:o,rolecreatetime:n},i)},exports.logRoleUpLevel=function(e,r,a,t,o,n,i){run(I[19778],{serverid:e,servername:r,roleid:a,rolename:t,rolelevel:o,rolecreatetime:n},i)},exports.share=function(e){run("share",{type:e})},exports.subscribeMessage=function(e,r){run("subscribeMessage",e,r)},exports.msgCheck=function(e,r){run(I[7801],e,r)},exports.downloadClient=function(){run(I[22981])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(I[22982])},exports.weiduanHelper=function(){run("weiduanHelper")};