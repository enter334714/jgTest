var Laya=window.Laya=function($H,$$){var $w={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($$,$b){return 1==arguments.length?$w.__presubstr.call(this,$$):$w.__presubstr.call(this,$$,0<$b?$b:this.length+$b)},__init:function($$){$$.forEach(function($$){$$.__init$&&$$.__init$()})},__isClass:function($$){return $$&&($$.__isclass||$$==Object||$$==String||$$==Array)},__newvec:function($$,$b){var $u=[];$u.length=$$;for(var $Z=0;$Z<$$;$Z++)$u[$Z]=$b;return $u},__extend:function($$,$b){for(var $u in $b)if($b.hasOwnProperty($u)){var $Z=Object.getOwnPropertyDescriptor($b,$u),$E=$Z.get,$r=$Z.set;$E||$r?$E&&$r?Object.defineProperty($$,$u,$Z):($E&&Object.defineProperty($$,$u,$E),$r&&Object.defineProperty($$,$u,$r)):$$[$u]=$b[$u]}function $F(){$w.un(this,"constructor",$$)}$F.prototype=$b.prototype,$$.prototype=new $F,$w.un($$.prototype,"__imps",$w.__copy({},$b.prototype.__imps))},__copy:function($$,$b){if(!$b)return null;for(var $u in $$=$$||{},$b)$$[$u]=$b[$u];return $$},__package:function($$,$b){if(!$w.__packages[$$]){$w.__packages[$$]=!0;var $u=$H,$Z=$$.split(".");if(1<$Z.length)for(var $E=0,$r=$Z.length-1;$E<$r;$E++){var $F=$u[$Z[$E]];$u=$F||($u[$Z[$E]]={})}$u[$Z[$Z.length-1]]||($u[$Z[$Z.length-1]]=$b||{})}},__hasOwnProperty:function($$,$b){return $b=$b||this,Object.hasOwnProperty.call($b,$$)||function $$($b,$u){if(Object.hasOwnProperty.call($u.prototype,$b))return!0;var $Z=$u.prototype.__super;return null==$Z?null:$$($b,$Z)}($$,$b.__class)},__typeof:function($$,$b){if(!$$||!$b)return!1;if($b===String)return"string"==typeof $$;if($b===Number)return"number"==typeof $$;if($b.__interface__)$b=$b.__interface__;else if("string"!=typeof $b)return $$ instanceof $b;return $$.__imps&&$$.__imps[$b]||$$.__class==$b},__as:function($$,$b){return this.__typeof($$,$b)?$$:null},__int:function($$){return $$?parseInt($$):0},interface:function($$,$b){$w.__package($$,{});var $u=$w.__internals,$Z=$u[$$]=$u[$$]||{self:$$};if($b){var $E=$b.split(",");$Z.extend=[];for(var $r=0;$r<$E.length;$r++){var $F=$E[$r];$u[$F]=$u[$F]||{self:$F},$Z.extend.push($u[$F])}}var $x=$H,$g=$$.split(".");for($r=0;$r<$g.length-1;$r++)$x=$x[$g[$r]];$x[$g[$g.length-1]]={__interface__:$$}},class:function($$,$b,$u,$Z){if($u&&$w.__extend($$,$u),$b)if($w.__package($b,$$),$w.__classmap[$b]=$$,0<$b.indexOf(".")){if(0==$b.indexOf("laya.")){var $E=$b.split(".");$Z=$Z||$E[$E.length-1],$w[$Z]&&console.log("Warning!,this class["+$Z+"] already exist:",$w[$Z]),$w[$Z]=$$}}else"Main"==$b?$H.Main=$$:"MainWX"==$b?$H.MainWX=$$:($w[$b]&&console.log("Error!,this class["+$b+"] already exist:",$w[$b]),$w[$b]=$$);var $r=$w.un,$F=$$.prototype;$r($F,"hasOwnProperty",$w.__hasOwnProperty),$r($F,"__class",$$),$r($F,"__super",$u),$r($F,"__className",$b),$r($$,"__super",$u),$r($$,"__className",$b),$r($$,"__isclass",!0),$r($$,"super",function($$){this.__super.call($$)})},imps:function($$,$b){if(!$b)return null;var $E=$$.__imps||$w.un($$,"__imps",{});function $r($$){var $b,$u;if(($b=$w.__internals[$$])&&($E[$$]=!0,$u=$b.extend))for(var $Z=0;$Z<$u.length;$Z++)$r($u[$Z].self)}for(var $u in $b)$r($u)},superSet:function($$,$b,$u,$Z){var $E=$$.prototype["_$set_"+$u];$E&&$E.call($b,$Z)},superGet:function($$,$b,$u){var $Z=$$.prototype["_$get_"+$u];return $Z?$Z.call($b):null},getset:function($$,$b,$u,$Z,$E){$$?($Z&&($b["_$GET_"+$u]=$Z),$E&&($b["_$SET_"+$u]=$E)):($Z&&$w.un($b,"_$get_"+$u,$Z),$E&&$w.un($b,"_$set_"+$u,$E)),$Z&&$E?Object.defineProperty($b,$u,{get:$Z,set:$E,enumerable:!1,configurable:!0}):($Z&&Object.defineProperty($b,$u,{get:$Z,enumerable:!1,configurable:!0}),$E&&Object.defineProperty($b,$u,{set:$E,enumerable:!1,configurable:!0}))},static:function($u,$Z){for(var $E=0,$$=$Z.length;$E<$$;$E+=2)if("length"==$Z[$E])$u.length=$Z[$E+1].call($u);else{function $b(){var $b=$Z[$E],$$=$Z[$E+1];Object.defineProperty($u,$b,{get:function(){return delete this[$b],this[$b]=$$.call(this)},set:function($$){delete this[$b],this[$b]=$$},enumerable:!0,configurable:!0})}$b()}},un:function($$,$b,$u){return $u||($u=$$[$b]),$w.__propun.value=$u,Object.defineProperty($$,$b,$w.__propun),$u},uns:function($b,$$){$$.forEach(function($$){$w.un($b,$$)})}};return $H.console=$H.console||{log:function(){}},$H.trace=$H.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$w}(window,document);!function($$,$b,$u){$u.un,$u.uns,$u.static,$u.class,$u.getset,$u.__newvec}(window,document,Laya),function($F,$b,$z){$z.un,$z.uns;var $g=$z.static,$e=$z.class,$w=$z.getset;$z.__newvec;$z.interface("laya.runtime.IMarket"),$z.interface("laya.filters.IFilter"),$z.interface("laya.display.ILayout"),$z.interface("laya.resource.IDispose"),$z.interface("laya.runtime.IPlatform"),$z.interface("laya.resource.IDestroy"),$z.interface("laya.runtime.IConchNode"),$z.interface("laya.filters.IFilterAction"),$z.interface("laya.runtime.ICPlatformClass"),$z.interface("laya.resource.ICreateResource"),$z.interface("laya.runtime.IConchRenderObject"),$z.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $O=function(){function $r(){}return $e($r,"laya.utils.RunDriver"),$r.FILTER_ACTIONS=[],$r.pixelRatio=-1,$r._charSizeTestDiv=null,$r.now=function(){return Date.now()},$r.getWindow=function(){return $F},$r.getPixelRatio=function(){if($r.pixelRatio<0){var $$=$s.context,$b=$$.backingStorePixelRatio||$$.webkitBackingStorePixelRatio||$$.mozBackingStorePixelRatio||$$.msBackingStorePixelRatio||$$.oBackingStorePixelRatio||$$.backingStorePixelRatio||1;($r.pixelRatio=($s.window.devicePixelRatio||1)/$b)<1&&($r.pixelRatio=1)}return $r.pixelRatio},$r.getIncludeStr=function($$){return null},$r.createShaderCondition=function($$){var $b="(function() {return "+$$+";})";return $z._runScript($b)},$r.fontMap=[],$r.measureText=function($$,$b){var $u=$r.hanzi.test($$);if($u&&$r.fontMap[$b])return $r.fontMap[$b];var $Z=$s.context;$Z.font=$b;var $E=$Z.measureText($$);return $E||($E={width:16,height:16}),$u&&($r.fontMap[$b]=$E),$E},$r.getWebGLContext=function($$){},$r.beginFlush=function(){},$r.endFinish=function(){},$r.addToAtlas=null,$r.flashFlushImage=function($$){},$r.drawToCanvas=function($$,$b,$u,$Z,$E,$r){var $F=$y$.create("2D"),$x=new $k($u,$Z,$F);return $M.renders[$b]._fun($$,$x,$E,$r),$F},$r.createParticleTemplate2D=null,$r.createGLTextur=null,$r.createWebGLContext2D=null,$r.changeWebGLSize=function($$,$b){},$r.createRenderSprite=function($$,$b){return new $M($$,$b)},$r.createFilterAction=function($$){return new $y},$r.createGraphics=function(){return new $o},$r.clear=function($$){$Y._context.ctx.clear()},$r.cancelLoadByUrl=function($$){},$r.clearAtlas=function($$){},$r.isAtlas=function($$){return!1},$r.addTextureToAtlas=function($$){},$r.getTexturePixels=function($$,$b,$u,$Z,$E){return null},$r.skinAniSprite=function(){return null},$r.update3DLoop=function(){},$g($r,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$r}(),$Z=($w(1,$z,"alertGlobalError",null,function($$){var $r=0;$s.window.onerror=$$?function($$,$b,$u,$Z,$E){$r++<5&&$E&&alert($E.stack||$E)}:null}),$z.init=function($$,$b,$u){for(var $Z=[],$E=2,$r=arguments.length;$E<$r;$E++)$Z.push(arguments[$E]);if(!$z._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$z._arrayBufferSlice),$z._isinit=!0,$s.__init__(),$l.__init__(),$o.__init__(),$z.timer=new $j,$z.scaleTimer=new $j,$z.loader=new $g$,$B.__init__(),$E=0;for(var $F=$Z.length;$E<$F;$E++)$Z[$E].enable&&$Z[$E].enable();return $N.__init__(),$x.__init__(),$X.__init__(),$n.beginCheck(),$z._currentStage=$z.stage=new $T$,$z.stage.conchModel&&$z.stage.conchModel.setRootNode(),$z._getUrlPath(),$z.render=new $Y(0,0),$z.stage.size($$,$b),$M.__init__(),$I.__init__(),$D.instance.__init__($z.stage,$Y.canvas),$P$.__init__(),$K.autoStopMusic=!0,$t.__init__(),$Y.canvas}},$z._getUrlPath=function(){var $$=$s.window.location,$b=$$.pathname;$b=$b&&":"==$b.charAt(2)?$b.substring(1):$b,$p.rootPath=$p.basePath=$p.getPath("file:"==$$.protocol?$b:$$.protocol+"//"+$$.host+$$.pathname)},$z._arrayBufferSlice=function($$,$b){var $u=new Uint8Array(this,$$,$b-$$),$Z=new Uint8Array($u.length);return $Z.set($u),$Z.buffer},$z._runScript=function($$){return $s.window[$z._evcode]($$)},$z.stage=null,$z.timer=null,$z.scaleTimer=null,$z.loader=null,$z.version="1.8.6",$z.render=null,$z._currentStage=null,$z._isinit=!1,$z.isDebug=!1,$z.MiniAdpter={init:function(){$F.navigator&&$F.navigator.userAgent&&-1<$F.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$g($z,["conchMarket",function(){return this.conchMarket=$F.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$F.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $$(){}return $e($$,"Config"),$$.WebGLTextCacheCount=500,$$.atlasEnable=!1,$$.showCanvasMark=!1,$$.animationInterval=50,$$.isAntialias=!1,$$.isAlpha=!1,$$.premultipliedAlpha=!0,$$.isStencil=!0,$$.preserveDrawingBuffer=!1,$$}()),$H=function(){function $H(){this._events=null}$e($H,"laya.events.EventDispatcher");var $$=$H.prototype;return $$.hasListener=function($$){return!!(this._events&&this._events[$$])},$$.getListener=function($$){return this._events?this._events[$$]:null},$$.event=function($$,$b){if(!this._events||!this._events[$$])return!1;var $u=this._events[$$];if($u.lock)$u.queue||($u.queue=[]),$u.queue.push($b);else{var $Z;for($u.lock=!0,$u.cursor=$u.head;$u.cursor;)($Z=$u.cursor).recover?($u.head=$u.tail=$u.cursor=null,console.error("node is recover："+$Z.id)):($u.cursor=$Z.next,$Z.once&&$H.delNode($u,$Z),$Z.method&&(null!=$b?$Z.args?$Z.method.apply($Z.caller,$Z.args.concat($b)):$b instanceof Array?$Z.method.apply($Z.caller,$b):$Z.caller?$Z.method.call($Z.caller,$b):$z.recordError("事件派发错误","node.caller:"+$Z.caller+"node.method:"+$Z.method+"data:"+$b+"node.prev"+$Z.prev):$Z.method.apply($Z.caller,$Z.args)),$Z.once&&$H.recoverHandler($Z));$u.lock=!1,!$u.head&&this._events&&this._events[$$]==$u&&delete this._events[$$],$u.queue&&$u.queue.length&&this.event($$,$u.queue.shift())}return!0},$$.on=function($$,$b,$u,$Z){return this._createListener($$,$b,$u,$Z,!1)},$$.once=function($$,$b,$u,$Z){return this._createListener($$,$b,$u,$Z,!0)},$$._createListener=function($$,$b,$u,$Z,$E,$r){void 0===$r&&($r=!0),$r&&this.off($$,$b,$u,$E);var $F=$H.createHandler($b||this,$u,$Z,$E);this._events||(this._events={});var $x=this._events,$g=$x[$$];return $g?$g.tail?($F.prev=$g.tail,$g.tail.next=$F,$g.tail=$F):$g.head=$g.tail=$F:$x[$$]={head:$F,tail:$F,cursor:null,lock:!1},this},$$.off=function($$,$b,$u,$Z){if(void 0===$Z&&($Z=!1),!this._events||!this._events[$$])return this;for(var $E=this._events[$$],$r=$E.head;$r;){if((!$b||$r.caller===$b)&&$r.method===$u&&(!$Z||$r.once)){$H.delNode($E,$r),$E.cursor==$r&&($E.cursor=$r.next),$H.recoverHandler($r);break}$r=$r.next}return this},$$.offAll=function($$){var $b=this._events;if(!$b)return this;if($$)this._recoverHandlers($b[$$]),delete $b[$$];else{for(var $u in $b)this._recoverHandlers($b[$u]);this._events=null}return this},$$._recoverHandlers=function($$){if($$){for(var $b=$$.head;$b;){$H.delNode($$,$b);var $u=$b.next;$H.recoverHandler($b),$b=$u}$$.cursor=null}},$$.isMouseEvent=function($$){return $H.MOUSE_EVENTS[$$]},$H.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$H.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$H.delNode=function($$,$b){$b.prev?$b.prev.next=$b.next:$$.head=$b.next,$b.next?$b.next.prev=$b.prev:$$.tail=$b.prev},$H.createHandler=function($$,$b,$u,$Z){var $E=500<$H._freeHandler.length?$H._freeHandler.shift():null;if($E)if($E.recover)$E.recover=!1,$E.caller=$$,$E.method=$b,$E.args=$u,$E.once=$Z;else{var $r="";try{arguments.propertyIsEnumerable.caller}catch($$){$r=$$.stack}var $F=$E.caller?($E.caller.__proto__&&$E.caller.__proto__.constructor&&$E.caller.__proto__.constructor.name)+"|"+$E.caller.__className+"|"+$E.caller.name:"",$x=$E.method?$E.method.name:"";$z.recordError("EventDispatcher重复创建","caller="+$F+"  method="+$x+"  stack="+$r),$E={id:++$H._nodeCount,caller:$$,method:$b,args:$u,once:$Z,recover:!1}}else $E={id:++$H._nodeCount,caller:$$,method:$b,args:$u,once:$Z,recover:!1};return $E.prev=$E.next=null,$E},$H.recoverHandler=function($$){if($$.recover){if($H._errorCount<5){$H._errorCount++;var $b="";try{arguments.propertyIsEnumerable.caller}catch($$){$b=$$.stack}var $u=$$.caller?($$.caller.__proto__&&$$.caller.__proto__.constructor&&$$.caller.__proto__.constructor.name)+"|"+$$.caller.__className+"|"+$$.caller.name:"",$Z=$$.method?$$.method.name:"";$z.recordError("EventDispatcher重复回收","id="+$$.id+"  caller="+$u+"  method="+$Z+"  stack="+$b)}$$.caller=$$.method=$$.args=$$.prev=null}else $$.recover=!0,$$.caller=$$.method=$$.args=$$.prev=$$.next=null,$H._freeHandler&&$H._freeHandler.length<3e3&&$H._freeHandler.push($$)},$H._freeHandler=[],$H._nodeCount=0,$H._errorCount=0,$H}(),$_=function(){function $E($$,$b,$u,$Z){this.once=!1,void(this._id=0)===$Z&&($Z=!1),this.setTo($$,$b,$u,$Z)}$e($E,"laya.utils.Handler");var $$=$E.prototype;return $$.setTo=function($$,$b,$u,$Z){return this._id=$E._gid++,this.caller=$$,this.method=$b,this.args=$u,this.once=$Z,this},$$.run=function(){if(null==this.method)return null;var $$=this._id,$b=this.method.apply(this.caller,this.args);return this._id===$$&&this.once&&this.recover(),$b},$$.runWith=function($$){if(null==this.method)return null;var $b=this._id;if(null==$$)var $u=this.method.apply(this.caller,this.args);else $u=this.args||$$.unshift?this.args?this.method.apply(this.caller,this.args.concat($$)):this.method.apply(this.caller,$$):this.method.call(this.caller,$$);return this._id===$b&&this.once&&this.recover(),$u},$$.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$$.recover=function(){0<this._id&&(this._id=0,this.clear())},$E.create=function($$,$b,$u,$Z){return void 0===$Z&&($Z=!0),new $E($$,$b,$u,$Z)},$E._gid=1,$E}(),$C=function(){function $$(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$e($$,"laya.display.BitmapFont");var $b=$$.prototype;return $b.loadFont=function($$,$b){this._path=$$,this._complete=$b,$z.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$_.create(this,this.onLoaded))},$b.onLoaded=function(){this.parseFont($x$.getRes(this._path),$x$.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$b.parseFont=function($$,$b){if(null!=$$&&null!=$b){this._texture=$b;var $u=$$.getElementsByTagName("info");if(!$u[0].getAttributeNode)return this.parseFont2($$,$b);this.fontSize=parseInt($u[0].getAttributeNode("size").nodeValue);var $Z,$E=$u[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($E[0]),parseInt($E[1]),parseInt($E[2]),parseInt($E[3])],$Z=$$.getElementsByTagName("char");var $r=0;for($r=0;$r<$Z.length;$r++){var $F=$Z[$r],$x=parseInt($F.getAttributeNode("id").nodeValue),$g=parseInt($F.getAttributeNode("xoffset").nodeValue)/1,$H=parseInt($F.getAttributeNode("yoffset").nodeValue)/1,$w=parseInt($F.getAttributeNode("xadvance").nodeValue)/1,$I=new $a;$I.x=parseInt($F.getAttributeNode("x").nodeValue),$I.y=parseInt($F.getAttributeNode("y").nodeValue),$I.width=parseInt($F.getAttributeNode("width").nodeValue),$I.height=parseInt($F.getAttributeNode("height").nodeValue);var $o=$w$.create($b,$I.x,$I.y,$I.width,$I.height,$g,$H);this._maxWidth=Math.max(this._maxWidth,$w+this.letterSpacing),this._fontCharDic[$x]=$o,this._fontWidthMap[$x]=$w}}},$b.parseFont2=function($$,$b){if(null!=$$&&null!=$b){this._texture=$b;var $u=$$.getElementsByTagName("info");this.fontSize=parseInt($u[0].attributes.size.nodeValue);var $Z=$u[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($Z[0]),parseInt($Z[1]),parseInt($Z[2]),parseInt($Z[3])];var $E=$$.getElementsByTagName("char"),$r=0;for($r=0;$r<$E.length;$r++){var $F=$E[$r].attributes,$x=parseInt($F.id.nodeValue),$g=parseInt($F.xoffset.nodeValue)/1,$H=parseInt($F.yoffset.nodeValue)/1,$w=parseInt($F.xadvance.nodeValue)/1,$I=new $a;$I.x=parseInt($F.x.nodeValue),$I.y=parseInt($F.y.nodeValue),$I.width=parseInt($F.width.nodeValue),$I.height=parseInt($F.height.nodeValue);var $o=$w$.create($b,$I.x,$I.y,$I.width,$I.height,$g,$H);this._maxWidth=Math.max(this._maxWidth,$w+this.letterSpacing),this._fontCharDic[$x]=$o,this._fontWidthMap[$x]=$w}}},$b.getCharTexture=function($$){return this._fontCharDic[$$.charCodeAt(0)]},$b.destroy=function(){if(this._texture){for(var $$ in this._fontCharDic){var $b=this._fontCharDic[$$];$b&&$b.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$b.setSpaceWidth=function($$){this._spaceWidth=$$},$b.getCharWidth=function($$){var $b=$$.charCodeAt(0);return this._fontWidthMap[$b]?this._fontWidthMap[$b]+this.letterSpacing:" "==$$?this._spaceWidth+this.letterSpacing:0},$b.getTextWidth=function($$){for(var $b=0,$u=0,$Z=$$.length;$u<$Z;$u++)$b+=this.getCharWidth($$.charAt($u));return $b},$b.getMaxWidth=function(){return this._maxWidth},$b.getMaxHeight=function(){return this.fontSize},$b.drawText=function($$,$b,$u,$Z,$E,$r){var $F,$x=this.getTextWidth($$),$g=0;"center"===$E&&($g=($r-$x)/2),"right"===$E&&($g=$r-$x);for(var $H=0,$w=0,$I=$$.length;$w<$I;$w++)($F=this.getCharTexture($$.charAt($w)))&&($b.graphics.drawTexture($F,$u+$H+$g,$Z),$H+=this.getCharWidth($$.charAt($w)))},$$}(),$x=function(){function $u(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$u._TF_EMPTY}$e($u,"laya.display.css.Style");var $$=$u.prototype;return $$.getTransform=function(){return this._tf},$$.setTransform=function($$){this._tf="none"!==$$&&$$?$$:$u._TF_EMPTY},$$.setTranslateX=function($$){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.translateX=$$},$$.setTranslateY=function($$){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.translateY=$$},$$.setScaleX=function($$){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.scaleX=$$},$$.setScale=function($$,$b){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.scaleX=$$,this._tf.scaleY=$b},$$.setScaleY=function($$){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.scaleY=$$},$$.setRotate=function($$){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.rotate=$$},$$.setSkewX=function($$){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.skewX=$$},$$.setSkewY=function($$){this._tf===$u._TF_EMPTY&&(this._tf=new $E),this._tf.skewY=$$},$$.destroy=function(){this.scrollRect=null},$$.render=function($$,$b,$u,$Z){},$$.getCSSStyle=function(){return $b$.EMPTY},$$._enableLayout=function(){return!1},$w(0,$$,"scaleX",function(){return this._tf.scaleX},function($$){this.setScaleX($$)}),$w(0,$$,"transform",function(){return this.getTransform()},function($$){this.setTransform($$)}),$w(0,$$,"translateX",function(){return this._tf.translateX},function($$){this.setTranslateX($$)}),$w(0,$$,"translateY",function(){return this._tf.translateY},function($$){this.setTranslateY($$)}),$w(0,$$,"scaleY",function(){return this._tf.scaleY},function($$){this.setScaleY($$)}),$w(0,$$,"block",function(){return 0!=(1&this._type)}),$w(0,$$,"skewY",function(){return this._tf.skewY},function($$){this.setSkewY($$)}),$w(0,$$,"rotate",function(){return this._tf.rotate},function($$){this.setRotate($$)}),$w(0,$$,"skewX",function(){return this._tf.skewX},function($$){this.setSkewX($$)}),$w(0,$$,"paddingLeft",function(){return 0}),$w(0,$$,"paddingTop",function(){return 0}),$w(0,$$,"absolute",function(){return!0}),$u.__init__=function(){$u._TF_EMPTY=new $E,$u.EMPTY=new $u},$u.EMPTY=null,$u._TF_EMPTY=null,$u}(),$N=function(){function $b($$){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$J.create($b.defaultColor),this.family=$b.defaultFamily,this.stroke=$b._STROKE,this.size=$b.defaultSize,$$&&$$!==$b.EMPTY&&$$.copyTo(this)}$e($b,"laya.display.css.Font");var $$=$b.prototype;return $$.set=function($$){this._text=null;for(var $b=$$.split(" "),$u=0,$Z=$b.length;$u<$Z;$u++){var $E=$b[$u];switch($E){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$E.indexOf("px")&&(this.size=parseInt($E),this.family=$b[$u+1],$u++)}},$$.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$$.copyTo=function($$){$$._type=this._type,$$._text=this._text,$$._weight=this._weight,$$._color=this._color,$$.family=this.family,$$.stroke=this.stroke!=$b._STROKE?this.stroke.slice():$b._STROKE,$$.indent=this.indent,$$.size=this.size},$w(0,$$,"password",function(){return 0!=(1024&this._type)},function($$){$$?this._type|=1024:this._type&=-1025}),$w(0,$$,"color",function(){return this._color.strColor},function($$){this._color=$J.create($$)}),$w(0,$$,"italic",function(){return 0!=(512&this._type)},function($$){$$?this._type|=512:this._type&=-513}),$w(0,$$,"bold",function(){return 0!=(2048&this._type)},function($$){$$?this._type|=2048:this._type&=-2049}),$w(0,$$,"weight",function(){return""+this._weight},function($$){var $b=0;switch($$){case"normal":break;case"bold":this.bold=!0,$b=700;break;case"bolder":$b=800;break;case"lighter":$b=100;break;default:$b=parseInt($$)}this._weight=$b,this._text=null}),$w(0,$$,"decoration",function(){return this._decoration?this._decoration.value:null},function($$){var $b=$$.split(" ");switch(this._decoration||(this._decoration={}),$b[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$b[0]}$b[1]&&(this._decoration.color=$J.create($b)),this._decoration.value=$$}),$b.__init__=function(){$b.EMPTY=new $b(null)},$b.EMPTY=null,$b.defaultColor="#000000",$b.defaultSize=12,$b.defaultFamily="Arial",$b.defaultFont="12px Arial",$b._STROKE=[0,"#000000"],$b._ITALIC=512,$b._PASSWORD=1024,$b._BOLD=2048,$b}(),$E=function(){function $$(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $e($$,"laya.display.css.TransformInfo"),$$}(),$o=function(){function $I(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$Y.isConchNode){this._nativeObj=new $F._conchGraphics,this.id=this._nativeObj.conchID}}$e($I,"laya.display.Graphics");var $$=$I.prototype;return $$.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$$.clear=function($$){void 0===$$&&($$=!1);var $b=0,$u=0;if($$){var $Z=this._one;if(this._cmds){for($u=this._cmds.length,$b=0;$b<$u;$b++)!($Z=this._cmds[$b])||$Z.callee!==$Y._context._drawTexture&&$Z.callee!==$Y._context._drawTextureWithTransform||($Z[0]=null,$I._cache.push($Z));this._cmds.length=0}else $Z&&(!$Z||$Z.callee!==$Y._context._drawTexture&&$Z.callee!==$Y._context._drawTextureWithTransform||($Z[0]=null,$I._cache.push($Z)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($b=0,$u=this._vectorgraphArray.length;$b<$u;$b++)$U.getInstance().deleteShape(this._vectorgraphArray[$b]);this._vectorgraphArray.length=0}},$$._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$$._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $u,this._graphicBounds._graphics=this)},$$._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$$._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$$.getBounds=function($$){return void 0===$$&&($$=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($$)},$$.getBoundPoints=function($$){return void 0===$$&&($$=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($$)},$$._addCmd=function($$){this._cmds=this._cmds||[],$$.callee=$$.shift(),this._cmds.push($$)},$$.setFilters=function($$){this._saveToCmd($Y._context._setFilters,$$)},$$.drawTexture=function($$,$b,$u,$Z,$E,$r,$F){if(void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=0),void 0===$E&&($E=0),void 0===$F&&($F=1),!$$||$F<.01)return null;$Z||($Z=$$.sourceWidth),$E||($E=$$.sourceHeight),$F=$F<0?0:1<$F?1:$F;var $x,$g=!$Y.isWebGL&&($s.onFirefox||$s.onEdge||$s.onIE||$s.onSafari)?.5:0,$H=$Z/$$.sourceWidth,$w=$E/$$.sourceHeight;return $Z=$$.width*$H,$E=$$.height*$w,$$.loaded&&($Z<=0||$E<=0)?null:($b+=$$.offsetX*$H,$u+=$$.offsetY*$w,this._sp&&(this._sp._renderType|=512),$b-=$g,$u-=$g,$Z+=2*$g,$E+=2*$g,$I._cache.length?(($x=$I._cache.pop())[0]=$$,$x[1]=$b,$x[2]=$u,$x[3]=$Z,$x[4]=$E,$x[5]=$r,$x[6]=$F):$x=[$$,$b,$u,$Z,$E,$r,$F],$x.callee=$r||1!=$F?$Y._context._drawTextureWithTransform:$Y._context._drawTexture,null!=this._one||$r||1!=$F?this._saveToCmd($x.callee,$x):(this._one=$x,this._render=this._renderOneImg),$$.loaded||$$.once("loaded",this,this._textureLoaded,[$$,$x]),this._repaint(),$x)},$$.cleanByTexture=function($$,$b,$u,$Z,$E){if(void 0===$Z&&($Z=0),void 0===$E&&($E=0),!$$)return this.clear();if(this._one&&this._render===this._renderOneImg){$Z||($Z=$$.sourceWidth),$E||($E=$$.sourceHeight);var $r=$Z/$$.sourceWidth,$F=$E/$$.sourceHeight;$Z=$$.width*$r,$E=$$.height*$F,$b+=$$.offsetX*$r,$u+=$$.offsetY*$F,this._one[0]=$$,this._one[1]=$b,this._one[2]=$u,this._one[3]=$Z,this._one[4]=$E,this._repaint()}else this.clear(),$$&&this.drawTexture($$,$b,$u,$Z,$E)},$$.drawTextures=function($$,$b){$$&&this._saveToCmd($Y._context._drawTextures,[$$,$b])},$$.fillTexture=function($$,$b,$u,$Z,$E,$r,$F){if(void 0===$Z&&($Z=0),void 0===$E&&($E=0),void 0===$r&&($r="repeat"),$$){var $x=[$$,$b,$u,$Z,$E,$r,$F||$q.EMPTY,{}];$$.loaded||$$.once("loaded",this,this._textureLoaded,[$$,$x]),this._saveToCmd($Y._context._fillTexture,$x)}},$$._textureLoaded=function($$,$b){$b[3]=$b[3]||$$.width,$b[4]=$b[4]||$$.height,this._repaint()},$$.fillCircle=function($$,$b,$u,$Z,$E,$r,$F){$u.bitmap.enableMerageInAtlas=!1;var $x=new Float32Array(2*($F+1)),$g=new Float32Array(2*($F+1)),$H=new Uint16Array(3*$F),$w=2*Math.PI/$F,$I=0;$x[0]=$Z,$x[1]=$E,$g[0]=$Z/$u.width,$g[1]=$E/$u.height;for(var $o=2,$N=0;$N<$F;$N++){var $D=$r*Math.cos($I)+$Z,$e=$r*Math.sin($I)+$E;$x[$o]=$D,$x[$o+1]=$e,$g[$o]=$D/$u.width,$g[$o+1]=$e/$u.height,$I+=$w,$o+=2}for($N=$o=0;$N<$F;$N++)$H[$o++]=0,$H[$o++]=$N+1,$H[$o++]=$F+1<=$N+2?1:$N+2;this.drawTriangles($u,$$,$b,$x,$g,$H)},$$.drawTriangles=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){void 0===$x&&($x=1),this._saveToCmd($Y._context.drawTriangles,[$$,$b,$u,$Z,$E,$r,$F,$x,$g,$H])},$$._saveToCmd=function($$,$b){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$b,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($b)),$b.callee=$$,this._repaint(),$b},$$.clipRect=function($$,$b,$u,$Z){this._saveToCmd($Y._context._clipRect,[$$,$b,$u,$Z])},$$.fillText=function($$,$b,$u,$Z,$E,$r,$F){void 0===$F&&($F=0),this._saveToCmd($Y._context._fillText,[$$,$b,$u,$Z||$N.defaultFont,$E,$r])},$$.fillBorderText=function($$,$b,$u,$Z,$E,$r,$F,$x){this._saveToCmd($Y._context._fillBorderText,[$$,$b,$u,$Z||$N.defaultFont,$E,$r,$F,$x])},$$.strokeText=function($$,$b,$u,$Z,$E,$r,$F){this._saveToCmd($Y._context._strokeText,[$$,$b,$u,$Z||$N.defaultFont,$E,$r,$F])},$$.alpha=function($$){$$=$$<0?0:1<$$?1:$$,this._saveToCmd($Y._context._alpha,[$$])},$$.setAlpha=function($$){$$=$$<0?0:1<$$?1:$$,this._saveToCmd($Y._context._setAlpha,[$$])},$$.transform=function($$,$b,$u){void 0===$b&&($b=0),void 0===$u&&($u=0),this._saveToCmd($Y._context._transform,[$$,$b,$u])},$$.rotate=function($$,$b,$u){void 0===$b&&($b=0),void 0===$u&&($u=0),this._saveToCmd($Y._context._rotate,[$$,$b,$u])},$$.scale=function($$,$b,$u,$Z){void 0===$u&&($u=0),void 0===$Z&&($Z=0),this._saveToCmd($Y._context._scale,[$$,$b,$u,$Z])},$$.translate=function($$,$b){this._saveToCmd($Y._context._translate,[$$,$b])},$$.save=function(){this._saveToCmd($Y._context._save,[])},$$.restore=function(){this._saveToCmd($Y._context._restore,[])},$$.replaceText=function($$){this._repaint();var $b=this._cmds;if($b){for(var $u=$b.length-1;-1<$u;$u--)if(this._isTextCmd($b[$u].callee))return $b[$u][0].toUpperCase?$b[$u][0]=$$:$b[$u][0].setText($$),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$$:this._one[0].setText($$),!0;return!1},$$._isTextCmd=function($$){return $$===$Y._context._fillText||$$===$Y._context._fillBorderText||$$===$Y._context._strokeText},$$.replaceTextColor=function($$){this._repaint();var $b=this._cmds;if($b)for(var $u=$b.length-1;-1<$u;$u--)this._isTextCmd($b[$u].callee)&&($b[$u][4]=$$,$b[$u][0].toUpperCase||($b[$u][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$$,this._one[0].toUpperCase||(this._one[0].changed=!0))},$$.loadImage=function($$,$b,$u,$Z,$E,$r){var $F=this;void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=0),void 0===$E&&($E=0);var $x=$x$.getRes($$);function $g($$){$$&&($F.drawTexture($$,$b,$u,$Z,$E),null!=$r&&$r.call($F._sp,$$))}$x?$g($x):$z.loader.load($$,$_.create(null,$g),null,"image")},$$._renderEmpty=function($$,$b,$u,$Z){},$$._renderAll=function($$,$b,$u,$Z){for(var $E,$r=this._cmds,$F=0,$x=$r.length;$F<$x;$F++)($E=$r[$F]).callee.call($b,$u,$Z,$E)},$$._renderOne=function($$,$b,$u,$Z){this._one.callee.call($b,$u,$Z,this._one)},$$._renderOneImg=function($$,$b,$u,$Z){this._one.callee.call($b,$u,$Z,this._one),2305!==$$._renderType&&($$._renderType|=1)},$$.drawLine=function($$,$b,$u,$Z,$E,$r){void 0===$r&&($r=1);var $F=0;$Y.isWebGL&&($F=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($F));var $x=$r%2==0?0:.5,$g=[$$+$x,$b+$x,$u+$x,$Z+$x,$E,$r,$F];this._saveToCmd($Y._context._drawLine,$g)},$$.drawLines=function($$,$b,$u,$Z,$E){void 0===$E&&($E=1);var $r=0;if($u&&!($u.length<4)){$Y.isWebGL&&($r=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($r));var $F=$E%2==0?0:.5,$x=[$$+$F,$b+$F,$u,$Z,$E,$r];this._saveToCmd($Y._context._drawLines,$x)}},$$.drawCurves=function($$,$b,$u,$Z,$E){void 0===$E&&($E=1);var $r=[$$,$b,$u,$Z,$E];this._saveToCmd($Y._context._drawCurves,$r)},$$.drawRect=function($$,$b,$u,$Z,$E,$r,$F){void 0===$F&&($F=1);var $x=$r?$F/2:0,$g=$r?$F:0,$H=[$$+$x,$b+$x,$u-$g,$Z-$g,$E,$r,$F];this._saveToCmd($Y._context._drawRect,$H)},$$.drawCircle=function($$,$b,$u,$Z,$E,$r){void 0===$r&&($r=1);var $F=$E?$r/2:0,$x=0;$Y.isWebGL&&($x=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($x));var $g=[$$,$b,$u-$F,$Z,$E,$r,$x];this._saveToCmd($Y._context._drawCircle,$g)},$$.drawPie=function($$,$b,$u,$Z,$E,$r,$F,$x){void 0===$x&&($x=1);var $g=$F?$x/2:0,$H=$F?$x:0,$w=0;$Y.isWebGL&&($w=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($w));var $I=[$$+$g,$b+$g,$u-$H,$Z,$E,$r,$F,$x,$w];$I[3]=$d.toRadian($Z),$I[4]=$d.toRadian($E),this._saveToCmd($Y._context._drawPie,$I)},$$.drawPoly=function($$,$b,$u,$Z,$E,$r){void 0===$r&&($r=1);var $F=0,$x=!1;$Y.isWebGL&&($F=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($F),$x=!(6<$u.length));var $g=$E?$r%2==0?0:.5:0,$H=[$$+$g,$b+$g,$u,$Z,$E,$r,$F,$x];this._saveToCmd($Y._context._drawPoly,$H)},$$.drawPath=function($$,$b,$u,$Z,$E){var $r=[$$,$b,$u,$Z,$E];this._saveToCmd($Y._context._drawPath,$r)},$w(0,$$,"cmds",function(){return this._cmds},function($$){this._sp&&(this._sp._renderType|=512),this._cmds=$$,this._render=this._renderAll,this._repaint()}),$I.__init__=function(){if($Y.isConchNode){for(var $$=laya.display.Graphics.prototype,$b=$s.window.ConchGraphics.prototype,$u=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$Z=0,$E=$u.length;$Z<=$E;$Z++){var $r=$u[$Z];$$[$r]=$b[$r]}$$._saveToCmd=null,$b.drawImageS&&($$.drawTextures=function($$,$b){if($$&&$$.loaded&&$$.bitmap&&$$.source){var $u=$$.uv,$Z=$$.bitmap.width,$E=$$.bitmap.height;this.drawImageS($$.bitmap.source,$u[0]*$Z,$u[1]*$E,($u[2]-$u[0])*$Z,($u[5]-$u[3])*$E,$$.offsetX,$$.offsetY,$$.width,$$.height,$b)}}),$$.drawTexture=function($$,$b,$u,$Z,$E,$r,$F){if(void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=0),void 0===$E&&($E=0),void 0===$F&&($F=1),$$)if($$.loaded){if($$.loaded&&$$.bitmap&&$$.source&&($Z||($Z=$$.sourceWidth),$E||($E=$$.sourceHeight),$F=$F<0?0:1<$F?1:$F,$Z=$Z-$$.sourceWidth+$$.width,$E=$E-$$.sourceHeight+$$.height,!($Z<=0||$E<=0))){$b+=$$.offsetX,$u+=$$.offsetY;var $x=$$.uv,$g=$$.bitmap.width,$H=$$.bitmap.height;$x[4]<$x[0]&&$x[5]<$x[1]?this.drawImageM($$.bitmap.source,$x[4]*$g,$x[5]*$H,($x[0]-$x[4])*$g,($x[1]-$x[5])*$H,$b,$u,$Z,$E,$r,$F):this.drawImageM($$.bitmap.source,$x[0]*$g,$x[1]*$H,($x[2]-$x[0])*$g,($x[5]-$x[3])*$H,$b,$u,$Z,$E,$r,$F),this._repaint()}}else $$.once("loaded",this,function(){this.drawTexture($$,$b,$u,$Z,$E,$r)})},$$.fillTexture=function($$,$b,$u,$Z,$E,$r,$F){if(void 0===$Z&&($Z=0),void 0===$E&&($E=0),void 0===$r&&($r="repeat"),$$&&$$.loaded){var $x,$g=$Y._context.ctx,$H=$$.bitmap.width,$w=$$.bitmap.height,$I=$$.uv;$x=$$.uv!=$w$.DEF_UV?$g.createPattern($$.bitmap.source,$r,$I[0]*$H,$I[1]*$w,($I[2]-$I[0])*$H,($I[5]-$I[3])*$w):$g.createPattern($$.bitmap.source,$r);var $o=0,$N=0;$F&&($b+=$F.x%$$.width,$u+=$F.y%$$.height,$o-=$F.x%$$.width,$N-=$F.y%$$.height),this._fillImage($x,$b,$u,$o,$N,$Z,$E)}}}},$I._cache=[],$I}(),$u=function(){function $y(){this._cacheBoundsType=!1}$e($y,"laya.display.GraphicsBounds");var $$=$y.prototype;return $$.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$$.reset=function(){this._temp&&(this._temp.length=0)},$$.getBounds=function($$){return void 0===$$&&($$=!1),(!this._bounds||!this._temp||this._temp.length<1||$$!=this._cacheBoundsType)&&(this._bounds=$a._getWrapRec(this.getBoundPoints($$),this._bounds)),this._cacheBoundsType=$$,this._bounds},$$.getBoundPoints=function($$){return void 0===$$&&($$=!1),(!this._temp||this._temp.length<1||$$!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($$)),this._cacheBoundsType=$$,this._rstBoundPoints=$d.copyArray(this._rstBoundPoints,this._temp)},$$._getCmdPoints=function($$){void 0===$$&&($$=!1);var $b,$u,$Z=$Y._context,$E=this._graphics.cmds;if(($b=this._temp||(this._temp=[])).length=0,$E||null==this._graphics._one||($y._tempCmds.length=0,$y._tempCmds.push(this._graphics._one),$E=$y._tempCmds),!$E)return $b;($u=$y._tempMatrixArrays).length=0;var $r=$y._initMatrix;$r.identity();for(var $F,$x,$g=$y._tempMatrix,$H=NaN,$w=NaN,$I=NaN,$o=NaN,$N=NaN,$D=NaN,$e=0,$L=$E.length;$e<$L;$e++)if(($F=$E[$e]).callee)switch($F.callee){case $Z._save:case 7:$u.push($r),$r=$r.clone();break;case $Z._restore:case 8:$r=$u.pop();break;case $Z._scale:case 5:$g.identity(),$g.translate(-$F[2],-$F[3]),$g.scale($F[0],$F[1]),$g.translate($F[2],$F[3]),this._switchMatrix($r,$g);break;case $Z._rotate:case 3:$g.identity(),$g.translate(-$F[1],-$F[2]),$g.rotate($F[0]),$g.translate($F[1],$F[2]),this._switchMatrix($r,$g);break;case $Z._translate:case 6:$g.identity(),$g.translate($F[0],$F[1]),this._switchMatrix($r,$g);break;case $Z._transform:case 4:$g.identity(),$g.translate(-$F[1],-$F[2]),$g.concat($F[0]),$g.translate($F[1],$F[2]),this._switchMatrix($r,$g);break;case 16:case 24:$y._addPointArrToRst($b,$a._getBoundPointS($F[0],$F[1],$F[2],$F[3]),$r);break;case 17:$r.copyTo($g),$g.concat($F[4]),$y._addPointArrToRst($b,$a._getBoundPointS($F[0],$F[1],$F[2],$F[3]),$g);break;case $Z._drawTexture:$x=$F[0],$$?$F[3]&&$F[4]?$y._addPointArrToRst($b,$a._getBoundPointS($F[1],$F[2],$F[3],$F[4]),$r):($x=$F[0],$y._addPointArrToRst($b,$a._getBoundPointS($F[1],$F[2],$x.width,$x.height),$r)):($H=($F[3]||$x.sourceWidth)/$x.width,$w=($F[4]||$x.sourceHeight)/$x.height,$I=$H*$x.sourceWidth,$o=$w*$x.sourceHeight,$N=0<$x.offsetX?$x.offsetX:0,$D=0<$x.offsetY?$x.offsetY:0,$N*=$H,$D*=$w,$y._addPointArrToRst($b,$a._getBoundPointS($F[1]-$N,$F[2]-$D,$I,$o),$r));break;case $Z._fillTexture:$F[3]&&$F[4]?$y._addPointArrToRst($b,$a._getBoundPointS($F[1],$F[2],$F[3],$F[4]),$r):($x=$F[0],$y._addPointArrToRst($b,$a._getBoundPointS($F[1],$F[2],$x.width,$x.height),$r));break;case $Z._drawTextureWithTransform:var $T;$T=$F[5]?($r.copyTo($g),$g.concat($F[5]),$g):$r,$$?$F[3]&&$F[4]?$y._addPointArrToRst($b,$a._getBoundPointS($F[1],$F[2],$F[3],$F[4]),$T):($x=$F[0],$y._addPointArrToRst($b,$a._getBoundPointS($F[1],$F[2],$x.width,$x.height),$T)):($x=$F[0],$H=($F[3]||$x.sourceWidth)/$x.width,$w=($F[4]||$x.sourceHeight)/$x.height,$I=$H*$x.sourceWidth,$o=$w*$x.sourceHeight,$N=0<$x.offsetX?$x.offsetX:0,$D=0<$x.offsetY?$x.offsetY:0,$N*=$H,$D*=$w,$y._addPointArrToRst($b,$a._getBoundPointS($F[1]-$N,$F[2]-$D,$I,$o),$T));break;case $Z._drawRect:case 13:$y._addPointArrToRst($b,$a._getBoundPointS($F[0],$F[1],$F[2],$F[3]),$r);break;case $Z._drawCircle:case $Z._fillCircle:case 14:$y._addPointArrToRst($b,$a._getBoundPointS($F[0]-$F[2],$F[1]-$F[2],$F[2]+$F[2],$F[2]+$F[2]),$r);break;case $Z._drawLine:case 20:$y._tempPoints.length=0;var $_;$_=.5*$F[5],$F[0]==$F[2]?$y._tempPoints.push($F[0]+$_,$F[1],$F[2]+$_,$F[3],$F[0]-$_,$F[1],$F[2]-$_,$F[3]):$F[1]==$F[3]?$y._tempPoints.push($F[0],$F[1]+$_,$F[2],$F[3]+$_,$F[0],$F[1]-$_,$F[2],$F[3]-$_):$y._tempPoints.push($F[0],$F[1],$F[2],$F[3]),$y._addPointArrToRst($b,$y._tempPoints,$r);break;case $Z._drawCurves:case 22:$y._addPointArrToRst($b,$S.I.getBezierPoints($F[2]),$r,$F[0],$F[1]);break;case $Z._drawPoly:case $Z._drawLines:case 18:$y._addPointArrToRst($b,$F[2],$r,$F[0],$F[1]);break;case $Z._drawPath:case 19:$y._addPointArrToRst($b,this._getPathPoints($F[2]),$r,$F[0],$F[1]);break;case $Z._drawPie:case 15:$y._addPointArrToRst($b,this._getPiePoints($F[0],$F[1],$F[2],$F[3],$F[4]),$r)}return 200<$b.length?$b=$d.copyArray($b,$a._getWrapRec($b)._getBoundPoints()):8<$b.length&&($b=$P.scanPList($b)),$b},$$._switchMatrix=function($$,$b){$b.concat($$),$b.copyTo($$)},$$._getPiePoints=function($$,$b,$u,$Z,$E){var $r=$y._tempPoints;$y._tempPoints.length=0,$r.push($$,$b);var $F=($E-$Z)%(2*Math.PI)/10,$x=NaN,$g=$Z;for($x=0;$x<=10;$x++)$r.push($$+$u*Math.cos($g),$b+$u*Math.sin($g)),$g+=$F;return $r},$$._getPathPoints=function($$){var $b,$u,$Z=0,$E=$y._tempPoints;for($E.length=0,$b=$$.length,$Z=0;$Z<$b;$Z++)1<($u=$$[$Z]).length&&($E.push($u[1],$u[2]),3<$u.length&&$E.push($u[3],$u[4]));return $E},$y._addPointArrToRst=function($$,$b,$u,$Z,$E){void 0===$Z&&($Z=0),void 0===$E&&($E=0);var $r,$F=0;for($r=$b.length,$F=0;$F<$r;$F+=2)$y._addPointToRst($$,$b[$F]+$Z,$b[$F+1]+$E,$u)},$y._addPointToRst=function($$,$b,$u,$Z){var $E=$q.TEMP;$E.setTo($b||0,$u||0),$Z.transformPoint($E),$$.push($E.x,$E.y)},$y._tempPoints=[],$y._tempMatrixArrays=[],$y._tempCmds=[],$g($y,["_tempMatrix",function(){return this._tempMatrix=new $V},"_initMatrix",function(){return this._initMatrix=new $V}]),$y}(),$r=function(){function $$(){}$e($$,"laya.events.Event");var $b=$$.prototype;return $b.setTo=function($$,$b,$u){return this.type=$$,this.currentTarget=$b,this.target=$u,this},$b.stopPropagation=function(){this._stoped=!0},$w(0,$b,"stageY",function(){return $z.stage.mouseY}),$w(0,$b,"charCode",function(){return this.nativeEvent.charCode}),$w(0,$b,"touches",function(){var $$=this.nativeEvent.touches;if($$)for(var $b=$z.stage,$u=0,$Z=$$.length;$u<$Z;$u++){var $E=$$[$u],$r=$q.TEMP;$r.setTo($E.clientX,$E.clientY),$b._canvasTransform.invertTransformPoint($r),$b.transform.invertTransformPoint($r),$E.stageX=$r.x,$E.stageY=$r.y}return $$}),$w(0,$b,"keyLocation",function(){return this.nativeEvent.keyLocation}),$w(0,$b,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$w(0,$b,"altKey",function(){return this.nativeEvent.altKey}),$w(0,$b,"shiftKey",function(){return this.nativeEvent.shiftKey}),$w(0,$b,"stageX",function(){return $z.stage.mouseX}),$$.EMPTY=new $$,$$.MOUSE_DOWN="mousedown",$$.MOUSE_UP="mouseup",$$.CLICK="click",$$.RIGHT_MOUSE_DOWN="rightmousedown",$$.RIGHT_MOUSE_UP="rightmouseup",$$.RIGHT_CLICK="rightclick",$$.MOUSE_MOVE="mousemove",$$.MOUSE_OVER="mouseover",$$.MOUSE_OUT="mouseout",$$.MOUSE_WHEEL="mousewheel",$$.ROLL_OVER="mouseover",$$.ROLL_OUT="mouseout",$$.DOUBLE_CLICK="doubleclick",$$.CHANGE="change",$$.CHANGED="changed",$$.RESIZE="resize",$$.ADDED="added",$$.REMOVED="removed",$$.DISPLAY="display",$$.UNDISPLAY="undisplay",$$.ERROR="error",$$.COMPLETE="complete",$$.LOADED="loaded",$$.INITED="inited",$$.PROGRESS="progress",$$.INPUT="input",$$.RENDER="render",$$.OPEN="open",$$.MESSAGE="message",$$.CLOSE="close",$$.KEY_DOWN="keydown",$$.KEY_PRESS="keypress",$$.KEY_UP="keyup",$$.FRAME="enterframe",$$.DRAG_START="dragstart",$$.DRAG_MOVE="dragmove",$$.DRAG_END="dragend",$$.ENTER="enter",$$.SELECT="select",$$.BLUR="blur",$$.FOCUS="focus",$$.VISIBILITY_CHANGE="visibilitychange",$$.FOCUS_CHANGE="focuschange",$$.PLAYED="played",$$.PAUSED="paused",$$.STOPPED="stopped",$$.START="start",$$.END="end",$$.ENABLE_CHANGED="enablechanged",$$.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$$.COMPONENT_ADDED="componentadded",$$.COMPONENT_REMOVED="componentremoved",$$.LAYER_CHANGED="layerchanged",$$.HIERARCHY_LOADED="hierarchyloaded",$$.RECOVERED="recovered",$$.RELEASED="released",$$.LINK="link",$$.LABEL="label",$$.FULL_SCREEN_CHANGE="fullscreenchange",$$.DEVICE_LOST="devicelost",$$.MESH_CHANGED="meshchanged",$$.MATERIAL_CHANGED="materialchanged",$$.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$$.ANIMATION_CHANGED="animationchanged",$$.TRIGGER_ENTER="triggerenter",$$.TRIGGER_STAY="triggerstay",$$.TRIGGER_EXIT="triggerexit",$$.TRAIL_FILTER_CHANGE="trailfilterchange",$$.DOMINO_FILTER_CHANGE="dominofilterchange",$$}(),$I=(function(){function $$(){}$e($$,"laya.events.Keyboard"),$$.NUMBER_0=48,$$.NUMBER_1=49,$$.NUMBER_2=50,$$.NUMBER_3=51,$$.NUMBER_4=52,$$.NUMBER_5=53,$$.NUMBER_6=54,$$.NUMBER_7=55,$$.NUMBER_8=56,$$.NUMBER_9=57,$$.A=65,$$.B=66,$$.C=67,$$.D=68,$$.E=69,$$.F=70,$$.G=71,$$.H=72,$$.I=73,$$.J=74,$$.K=75,$$.L=76,$$.M=77,$$.N=78,$$.O=79,$$.P=80,$$.Q=81,$$.R=82,$$.S=83,$$.T=84,$$.U=85,$$.V=86,$$.W=87,$$.X=88,$$.Y=89,$$.Z=90,$$.F1=112,$$.F2=113,$$.F3=114,$$.F4=115,$$.F5=116,$$.F6=117,$$.F7=118,$$.F8=119,$$.F9=120,$$.F10=121,$$.F11=122,$$.F12=123,$$.F13=124,$$.F14=125,$$.F15=126,$$.NUMPAD=21,$$.NUMPAD_0=96,$$.NUMPAD_1=97,$$.NUMPAD_2=98,$$.NUMPAD_3=99,$$.NUMPAD_4=100,$$.NUMPAD_5=101,$$.NUMPAD_6=102,$$.NUMPAD_7=103,$$.NUMPAD_8=104,$$.NUMPAD_9=105,$$.NUMPAD_ADD=107,$$.NUMPAD_DECIMAL=110,$$.NUMPAD_DIVIDE=111,$$.NUMPAD_ENTER=108,$$.NUMPAD_MULTIPLY=106,$$.NUMPAD_SUBTRACT=109,$$.SEMICOLON=186,$$.EQUAL=187,$$.COMMA=188,$$.MINUS=189,$$.PERIOD=190,$$.SLASH=191,$$.BACKQUOTE=192,$$.LEFTBRACKET=219,$$.BACKSLASH=220,$$.RIGHTBRACKET=221,$$.QUOTE=222,$$.ALTERNATE=18,$$.BACKSPACE=8,$$.CAPS_LOCK=20,$$.COMMAND=15,$$.CONTROL=17,$$.DELETE=46,$$.ENTER=13,$$.ESCAPE=27,$$.PAGE_UP=33,$$.PAGE_DOWN=34,$$.END=35,$$.HOME=36,$$.LEFT=37,$$.UP=38,$$.RIGHT=39,$$.DOWN=40,$$.SHIFT=16,$$.SPACE=32,$$.TAB=9,$$.INSERT=45}(),function(){function $E(){}return $e($E,"laya.events.KeyBoardManager"),$E.__init__=function(){$E._addEvent("keydown"),$E._addEvent("keypress"),$E._addEvent("keyup")},$E._addEvent=function($b){$s.document.addEventListener($b,function($$){laya.events.KeyBoardManager._dispatch($$,$b)},!0)},$E._dispatch=function($$,$b){if($E.enabled){$E._event._stoped=!1,$E._event.nativeEvent=$$,$E._event.keyCode=$$.keyCode||$$.which||$$.charCode,"keydown"===$b?$E._pressKeys[$E._event.keyCode]=!0:"keyup"===$b&&($E._pressKeys[$E._event.keyCode]=null);for(var $u=$z.stage.focus&&null!=$z.stage.focus.event&&$z.stage.focus.displayedInStage?$z.stage.focus:$z.stage,$Z=$u;$Z;)$Z.event($b,$E._event.setTo($b,$Z,$u)),$Z=$Z.parent}},$E.hasKeyDown=function($$){return $E._pressKeys[$$]},$E._pressKeys={},$E.enabled=!0,$g($E,["_event",function(){return this._event=new $r}]),$E}()),$D=(function(){function $$(){}$e($$,"laya.events.KeyLocation"),$$.STANDARD=0,$$.LEFT=1,$$.RIGHT=2,$$.NUM_PAD=3}(),function(){function $w(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$s.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $r,this._matrix=new $V,this._point=new $q,this._rect=new $a,this._prePoint=new $q,this._curTouchID=NaN}$e($w,"laya.events.MouseManager");var $$=$w.prototype;return $$.__init__=function($$,$b){var $u=this;this._stage=$$;var $Z=this,$E=this._eventList;$b.oncontextmenu=function($$){if($w.enabled)return!1},$b.addEventListener("mousedown",function($$){$w.enabled&&($s.onIE||$$.preventDefault(),$E.push($$),$Z.mouseDownTime=$s.now())}),$b.addEventListener("mouseup",function($$){$w.enabled&&($$.preventDefault(),$E.push($$),$Z.mouseDownTime=-$s.now())},!0),$b.addEventListener("mousemove",function($$){if($w.enabled){$$.preventDefault();var $b=$s.now();if($b-$Z._lastMoveTimer<10)return;$Z._lastMoveTimer=$b,$E.push($$)}},!0),$b.addEventListener("mouseout",function($$){$w.enabled&&$E.push($$)}),$b.addEventListener("mouseover",function($$){$w.enabled&&$E.push($$)}),$b.addEventListener("touchstart",function($$){$w.enabled&&($E.push($$),$w._isFirstTouch||$P$.isInputting||$$.preventDefault(),$Z.mouseDownTime=$s.now())}),$b.addEventListener("touchend",function($$){$w.enabled?($w._isFirstTouch||$P$.isInputting||$$.preventDefault(),$w._isFirstTouch=!1,$E.push($$),$Z.mouseDownTime=-$s.now()):$u._curTouchID=NaN},!0),$b.addEventListener("touchmove",function($$){$w.enabled&&($$.preventDefault(),$E.push($$))},!0),$b.addEventListener("touchcancel",function($$){$w.enabled?($$.preventDefault(),$E.push($$)):$u._curTouchID=NaN},!0),$b.addEventListener("mousewheel",function($$){$w.enabled&&$E.push($$)}),$b.addEventListener("DOMMouseScroll",function($$){$w.enabled&&$E.push($$)})},$$.initEvent=function($$,$b){var $u;this._event._stoped=!1,this._event.nativeEvent=$b||$$,this._target=null,this._point.setTo($$.pageX||$$.clientX,$$.pageY||$$.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$$.identifier||0,this._tTouchID=this._event.touchId,($u=$L.I._event)._stoped=!1,$u.nativeEvent=this._event.nativeEvent,$u.touchId=this._event.touchId},$$.checkMouseWheel=function($$){this._event.delta=$$.wheelDelta?.025*$$.wheelDelta:-$$.detail;for(var $b=$L.I.getLastOvers(),$u=0,$Z=$b.length;$u<$Z;$u++){var $E=$b[$u];$E.event("mousewheel",this._event.setTo("mousewheel",$E,this._target))}},$$.onMouseMove=function($$){$L.I.onMouseMove($$,this._tTouchID)},$$.onMouseDown=function($$){if($P$.isInputting&&$z.stage.focus&&$z.stage.focus.focus&&!$z.stage.focus.contains(this._target)){var $b=$z.stage.focus._tf||$z.stage.focus,$u=$$._tf||$$;$u instanceof laya.display.Input&&$u.multiline==$b.multiline?$b._focusOut():$b.focus=!1}$L.I.onMouseDown($$,this._tTouchID,this._isLeftMouse)},$$.onMouseUp=function($$){$L.I.onMouseUp($$,this._tTouchID,this._isLeftMouse)},$$.check=function($$,$b,$u,$Z){this._point.setTo($b,$u),$$.fromParentPoint(this._point),$b=this._point.x,$u=this._point.y;var $E=$$.scrollRect;if($E&&(this._rect.setTo($E.x,$E.y,$E.width,$E.height),!this._rect.contains($b,$u)))return!1;if(!this.disableMouseEvent){if($$.hitTestPrior&&!$$.mouseThrough&&!this.hitTest($$,$b,$u))return!1;for(var $r=$$._childs.length-1;-1<$r;$r--){var $F=$$._childs[$r];if(!$F.destroyed&&$F.mouseEnabled&&$F.visible&&this.check($F,$b,$u,$Z))return!0}}var $x=!(!$$.hitTestPrior||$$.mouseThrough||this.disableMouseEvent)||this.hitTest($$,$b,$u);return $x?(this._target=$$,$Z.call(this,$$)):$Z===this.onMouseUp&&$$===this._stage&&(this._target=this._stage,$Z.call(this,this._target)),$x},$$.hitTest=function($$,$b,$u){var $Z=!1;if($$.scrollRect&&($b-=$$.scrollRect.x,$u-=$$.scrollRect.y),$$.hitArea instanceof laya.utils.HitArea)return $$.hitArea.isHit($b,$u);if(0<$$.width&&0<$$.height||$$.mouseThrough||$$.hitArea)if($$.mouseThrough)$Z=$$.getGraphicBounds().contains($b,$u);else{var $E=this._rect;$$.hitArea?$E=$$.hitArea:$E.setTo(0,0,$$.width,$$.height),$Z=$E.contains($b,$u)}return $Z},$$.runEvent=function(){var $$=this._eventList.length;if($$){var $b=this;$b.mouseEventTime=$s.now();var $u,$Z=0,$E=0,$r=0;try{for(;$Z<$$;){var $F=this._eventList[$Z];switch("mousemove"!==$F.type&&(this._prePoint.x=this._prePoint.y=-1e6),$F.type){case"mousedown":this._touchIDs[0]=this._id++,$w._isTouchRespond?$w._isTouchRespond=!1:($b._isLeftMouse=0===$F.button,$b.initEvent($F),$b.check($b._stage,$b.mouseX,$b.mouseY,$b.onMouseDown));break;case"mouseup":$b._isLeftMouse=0===$F.button,$b.initEvent($F),$b.check($b._stage,$b.mouseX,$b.mouseY,$b.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$F.clientX)+Math.abs(this._prePoint.y-$F.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$F.clientX,this._prePoint.y=$F.clientY,$b.initEvent($F),$b.check($b._stage,$b.mouseX,$b.mouseY,$b.onMouseMove));break;case"touchstart":$w._isTouchRespond=!0,$b._isLeftMouse=!0;var $x=$F.changedTouches;for($E=0,$r=$x.length;$E<$r;$E++)$u=$x[$E],($w.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$u.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$u.identifier]=this._id++,$b.initEvent($u,$F),$b.check($b._stage,$b.mouseX,$b.mouseY,$b.onMouseDown));break;case"touchend":case"touchcancel":$w._isTouchRespond=!0,$b._isLeftMouse=!0;var $g=$F.changedTouches;for($E=0,$r=$g.length;$E<$r;$E++)if($u=$g[$E],$w.multiTouchEnabled||$u.identifier==this._curTouchID){this._curTouchID=NaN,$b.initEvent($u,$F);$b.check($b._stage,$b.mouseX,$b.mouseY,$b.onMouseUp)||$b.onMouseUp(null)}break;case"touchmove":var $H=$F.changedTouches;for($E=0,$r=$H.length;$E<$r;$E++)$u=$H[$E],($w.multiTouchEnabled||$u.identifier==this._curTouchID)&&($b.initEvent($u,$F),$b.check($b._stage,$b.mouseX,$b.mouseY,$b.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$b.checkMouseWheel($F);break;case"mouseout":$L.I.stageMouseOut();break;case"mouseover":$b._stage.event("mouseover",$b._event.setTo("mouseover",$b._stage,$b._stage))}$Z++}}catch($$){throw this._eventList.length=0,$$}this._eventList.length=0}},$w.enabled=!0,$w.multiTouchEnabled=!0,$w._isTouchRespond=!1,$w._isFirstTouch=!0,$g($w,["instance",function(){return this.instance=new $w}]),$w}()),$L=function(){function $D(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $r}$e($D,"laya.events.TouchManager");var $$=$D.prototype;return $$._clearTempArrs=function(){$D._oldArr.length=0,$D._newArr.length=0,$D._tEleArr.length=0},$$.getTouchFromArr=function($$,$b){var $u,$Z,$E=0;for($u=$b.length,$E=0;$E<$u;$E++)if(($Z=$b[$E]).id==$$)return $Z;return null},$$.removeTouchFromArr=function($$,$b){var $u=0;for($u=$b.length-1;0<=$u;$u--)$b[$u].id==$$&&$b.splice($u,1)},$$.createTouchO=function($$,$b){var $u;return($u=$G.getItem("TouchData")||{}).id=$b,$u.tar=$$,$u},$$.onMouseDown=function($$,$b,$u){var $Z,$E,$r,$F;(void 0===$u&&($u=!1),this.enable)&&($Z=this.getTouchFromArr($b,this.preOvers),$r=this.getEles($$,null,$D._tEleArr),$Z?$Z.tar=$$:($E=this.createTouchO($$,$b),this.preOvers.push($E)),$s.onMobile&&this.sendEvents($r,"mouseover",$b),$F=$u?this.preDowns:this.preRightDowns,($Z=this.getTouchFromArr($b,$F))?$Z.tar=$$:($E=this.createTouchO($$,$b),$F.push($E)),this.sendEvents($r,$u?"mousedown":"rightmousedown",$b),this._clearTempArrs())},$$.sendEvents=function($$,$b,$u){void 0===$u&&($u=0);var $Z,$E,$r,$F=0;for($Z=$$.length,this._event._stoped=!1,$E=$$[0],$F=0;$F<$Z;$F++){if(($r=$$[$F]).destroyed)return;if($r.event($b,this._event.setTo($b,$r,$E)),this._event._stoped)break}},$$.getEles=function($$,$b,$u){for($u?$u.length=0:$u=[];$$&&$$!=$b;)$u.push($$),$$=$$.parent;return $u},$$.checkMouseOutAndOverOfMove=function($$,$b,$u){if(void 0===$u&&($u=0),$b!=$$){var $Z,$E,$r=0,$F=0;if($b.contains($$))$E=this.getEles($$,$b,$D._tEleArr),this.sendEvents($E,"mouseover",$u);else if($$.contains($b))$E=this.getEles($b,$$,$D._tEleArr),this.sendEvents($E,"mouseout",$u);else{var $x,$g;($E=$D._tEleArr).length=0,$x=this.getEles($b,null,$D._oldArr),$g=this.getEles($$,null,$D._newArr),$F=$x.length;var $H=0;for($r=0;$r<$F;$r++){if($Z=$x[$r],0<=($H=$g.indexOf($Z))){$g.splice($H,$g.length-$H);break}$E.push($Z)}0<$E.length&&this.sendEvents($E,"mouseout",$u),0<$g.length&&this.sendEvents($g,"mouseover",$u)}}},$$.onMouseMove=function($$,$b){var $u,$Z;this.enable&&(($u=this.getTouchFromArr($b,this.preOvers))?(this.checkMouseOutAndOverOfMove($$,$u.tar),$u.tar=$$,$Z=this.getEles($$,null,$D._tEleArr)):($Z=this.getEles($$,null,$D._tEleArr),this.sendEvents($Z,"mouseover",$b),this.preOvers.push(this.createTouchO($$,$b))),this.sendEvents($Z,"mousemove",$b),this._clearTempArrs())},$$.getLastOvers=function(){return($D._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$D._tEleArr):($D._tEleArr.push($z.stage),$D._tEleArr)},$$.stageMouseOut=function(){var $$;$$=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($$,"mouseout",0)},$$.onMouseUp=function($$,$b,$u){if(void 0===$u&&($u=!1),this.enable){var $Z,$E,$r,$F,$x,$g,$H=0,$w=0,$I=$s.onMobile;if($E=this.getEles($$,null,$D._tEleArr),this.sendEvents($E,$u?"mouseup":"rightmouseup",$b),$g=$u?this.preDowns:this.preRightDowns,$Z=this.getTouchFromArr($b,$g)){var $o,$N=$s.now();if($o=$N-this._lastClickTime<300,this._lastClickTime=$N,$$==$Z.tar)$x=$E;else for($r=this.getEles($Z.tar,null,$D._oldArr),($x=$D._newArr).length=0,$w=$r.length,$H=0;$H<$w;$H++)$F=$r[$H],0<=$E.indexOf($F)&&$x.push($F);0<$x.length&&this.sendEvents($x,$u?"click":"rightclick",$b),$u&&$o&&this.sendEvents($x,"doubleclick",$b),this.removeTouchFromArr($b,$g),$Z.tar=null,$G.recover("TouchData",$Z)}else;($Z=this.getTouchFromArr($b,this.preOvers))&&$I&&(($x=this.getEles($Z.tar,null,$x))&&0<$x.length&&this.sendEvents($x,"mouseout",$b),this.removeTouchFromArr($b,this.preOvers),$Z.tar=null,$G.recover("TouchData",$Z)),this._clearTempArrs()}},$D._oldArr=[],$D._newArr=[],$D._tEleArr=[],$g($D,["I",function(){return this.I=new $D}]),$D}(),$T=function(){function $$(){this._action=null}$e($$,"laya.filters.Filter");var $b=$$.prototype;return $z.imps($b,{"laya.filters.IFilter":!0}),$b.callNative=function($$){},$w(0,$b,"type",function(){return-1}),$w(0,$b,"action",function(){return this._action}),$$.BLUR=16,$$.COLOR=32,$$.GLOW=8,$$._filterStart=null,$$._filterEnd=null,$$._EndTarget=null,$$._recycleScope=null,$$._filter=null,$$._useSrc=null,$$._endSrc=null,$$._useOut=null,$$._endOut=null,$$}(),$y=function(){function $$(){this.data=null}$e($$,"laya.filters.ColorFilterAction");var $b=$$.prototype;return $z.imps($b,{"laya.filters.IFilterAction":!0}),$b.apply=function($$){var $b=$$.ctx.ctx,$u=$$.ctx.ctx.canvas;if(0==$u.width||0==$u.height)return $u;for(var $Z,$E=$b.getImageData(0,0,$u.width,$u.height),$r=$E.data,$F=0,$x=$r.length;$F<$x;$F+=4)$Z=this.getColor($r[$F],$r[$F+1],$r[$F+2],$r[$F+3]),0!=$r[$F+3]&&($r[$F]=$Z[0],$r[$F+1]=$Z[1],$r[$F+2]=$Z[2],$r[$F+3]=$Z[3]);return $b.putImageData($E,0,0),$$},$b.getColor=function($$,$b,$u,$Z){var $E=[];if(this.data._mat&&this.data._alpha){var $r=this.data._mat,$F=this.data._alpha;$E[0]=$r[0]*$$+$r[1]*$b+$r[2]*$u+$r[3]*$Z+$F[0],$E[1]=$r[4]*$$+$r[5]*$b+$r[6]*$u+$r[7]*$Z+$F[1],$E[2]=$r[8]*$$+$r[9]*$b+$r[10]*$u+$r[11]*$Z+$F[2],$E[3]=$r[12]*$$+$r[13]*$b+$r[14]*$u+$r[15]*$Z+$F[3]}return $E},$$}(),$S=(function(){function $$(){}$e($$,"laya.maths.Arith"),$$.formatR=function($$){return $$>Math.PI&&($$-=2*Math.PI),$$<-Math.PI&&($$+=2*Math.PI),$$},$$.isPOT=function($$,$b){return 0<$$&&0==($$&$$-1)&&0<$b&&0==($b&$b-1)},$$.setMatToArray=function($$,$b){$$.a,$$.b,$$.c,$$.d,$$.tx,$$.ty,$b[0]=$$.a,$b[1]=$$.b,$b[4]=$$.c,$b[5]=$$.d,$b[12]=$$.tx,$b[13]=$$.ty}}(),function(){function $$(){this._controlPoints=[new $q,new $q,new $q],this._calFun=this.getPoint2}$e($$,"laya.maths.Bezier");var $b=$$.prototype;return $b._switchPoint=function($$,$b){var $u=this._controlPoints.shift();$u.setTo($$,$b),this._controlPoints.push($u)},$b.getPoint2=function($$,$b){var $u=this._controlPoints[0],$Z=this._controlPoints[1],$E=this._controlPoints[2],$r=Math.pow(1-$$,2)*$u.x+2*$$*(1-$$)*$Z.x+Math.pow($$,2)*$E.x,$F=Math.pow(1-$$,2)*$u.y+2*$$*(1-$$)*$Z.y+Math.pow($$,2)*$E.y;$b.push($r,$F)},$b.getPoint3=function($$,$b){var $u=this._controlPoints[0],$Z=this._controlPoints[1],$E=this._controlPoints[2],$r=this._controlPoints[3],$F=Math.pow(1-$$,3)*$u.x+3*$Z.x*$$*(1-$$)*(1-$$)+3*$E.x*$$*$$*(1-$$)+$r.x*Math.pow($$,3),$x=Math.pow(1-$$,3)*$u.y+3*$Z.y*$$*(1-$$)*(1-$$)+3*$E.y*$$*$$*(1-$$)+$r.y*Math.pow($$,3);$b.push($F,$x)},$b.insertPoints=function($$,$b){var $u,$Z=NaN;for($u=1/($$=0<$$?$$:5),$Z=0;$Z<=1;$Z+=$u)this._calFun($Z,$b)},$b.getBezierPoints=function($$,$b,$u){void 0===$b&&($b=5),void 0===$u&&($u=2);var $Z,$E,$r=0;if(($Z=$$.length)<2*($u+1))return[];switch($E=[],$u){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$u;)this._controlPoints.push(new $q);for($r=0;$r<2*$u;$r+=2)this._switchPoint($$[$r],$$[$r+1]);for($r=2*$u;$r<$Z;$r+=2)this._switchPoint($$[$r],$$[$r+1]),$r/2%$u==0&&this.insertPoints($b,$E);return $E},$g($$,["I",function(){return this.I=new $$}]),$$}()),$P=function(){function $H(){}return $e($H,"laya.maths.GrahamScan"),$H.multiply=function($$,$b,$u){return($$.x-$u.x)*($b.y-$u.y)-($b.x-$u.x)*($$.y-$u.y)},$H.dis=function($$,$b){return($$.x-$b.x)*($$.x-$b.x)+($$.y-$b.y)*($$.y-$b.y)},$H._getPoints=function($$,$b,$u){for(void 0===$b&&($b=!1),$H._mPointList||($H._mPointList=[]);$H._mPointList.length<$$;)$H._mPointList.push(new $q);return $u||($u=[]),$u.length=0,$b?$H.getFrom($u,$H._mPointList,$$):$H.getFromR($u,$H._mPointList,$$),$u},$H.getFrom=function($$,$b,$u){var $Z=0;for($Z=0;$Z<$u;$Z++)$$.push($b[$Z]);return $$},$H.getFromR=function($$,$b,$u){var $Z=0;for($Z=0;$Z<$u;$Z++)$$.push($b.pop());return $$},$H.pListToPointList=function($$,$b){void 0===$b&&($b=!1);var $u=0,$Z=$$.length/2,$E=$H._getPoints($Z,$b,$H._tempPointList);for($u=0;$u<$Z;$u++)$E[$u].setTo($$[$u+$u],$$[$u+$u+1]);return $E},$H.pointListToPlist=function($$){var $b,$u=0,$Z=$$.length,$E=$H._temPList;for($u=$E.length=0;$u<$Z;$u++)$b=$$[$u],$E.push($b.x,$b.y);return $E},$H.scanPList=function($$){return $d.copyArray($$,$H.pointListToPlist($H.scan($H.pListToPointList($$,!0))))},$H.scan=function($$){var $b,$u,$Z,$E=0,$r=0,$F=0,$x=$$.length,$g={};for(($u=$H._temArr).length=0,$E=($x=$$.length)-1;0<=$E;$E--)$Z=($b=$$[$E]).x+"_"+$b.y,$g.hasOwnProperty($Z)||($g[$Z]=!0,$u.push($b));for($x=$u.length,$d.copyArray($$,$u),$E=1;$E<$x;$E++)($$[$E].y<$$[$F].y||$$[$E].y==$$[$F].y&&$$[$E].x<$$[$F].x)&&($F=$E);for($b=$$[0],$$[0]=$$[$F],$$[$F]=$b,$E=1;$E<$x-1;$E++){for($r=($F=$E)+1;$r<$x;$r++)(0<$H.multiply($$[$r],$$[$F],$$[0])||0==$H.multiply($$[$r],$$[$F],$$[0])&&$H.dis($$[0],$$[$r])<$H.dis($$[0],$$[$F]))&&($F=$r);$b=$$[$E],$$[$E]=$$[$F],$$[$F]=$b}if(($u=$H._temArr).length=0,$$.length<3)return $d.copyArray($u,$$);for($u.push($$[0],$$[1],$$[2]),$E=3;$E<$x;$E++){for(;2<=$u.length&&0<=$H.multiply($$[$E],$u[$u.length-1],$u[$u.length-2]);)$u.pop();$$[$E]&&$u.push($$[$E])}return $u},$H._mPointList=null,$H._tempPointList=[],$H._temPList=[],$H._temArr=[],$H}(),$i=function(){function $E(){}return $e($E,"laya.maths.MathUtil"),$E.subtractVector3=function($$,$b,$u){$u[0]=$$[0]-$b[0],$u[1]=$$[1]-$b[1],$u[2]=$$[2]-$b[2]},$E.lerp=function($$,$b,$u){return $$*(1-$u)+$b*$u},$E.scaleVector3=function($$,$b,$u){$u[0]=$$[0]*$b,$u[1]=$$[1]*$b,$u[2]=$$[2]*$b},$E.lerpVector3=function($$,$b,$u,$Z){var $E=$$[0],$r=$$[1],$F=$$[2];$Z[0]=$E+$u*($b[0]-$E),$Z[1]=$r+$u*($b[1]-$r),$Z[2]=$F+$u*($b[2]-$F)},$E.lerpVector4=function($$,$b,$u,$Z){var $E=$$[0],$r=$$[1],$F=$$[2],$x=$$[3];$Z[0]=$E+$u*($b[0]-$E),$Z[1]=$r+$u*($b[1]-$r),$Z[2]=$F+$u*($b[2]-$F),$Z[3]=$x+$u*($b[3]-$x)},$E.slerpQuaternionArray=function($$,$b,$u,$Z,$E,$r,$F){var $x,$g,$H,$w,$I,$o=$$[$b+0],$N=$$[$b+1],$D=$$[$b+2],$e=$$[$b+3],$L=$u[$Z+0],$T=$u[$Z+1],$_=$u[$Z+2],$y=$u[$Z+3];return($g=$o*$L+$N*$T+$D*$_+$e*$y)<0&&($g=-$g,$L=-$L,$T=-$T,$_=-$_,$y=-$y),$I=1e-6<1-$g?($x=Math.acos($g),$H=Math.sin($x),$w=Math.sin((1-$E)*$x)/$H,Math.sin($E*$x)/$H):($w=1-$E,$E),$r[$F+0]=$w*$o+$I*$L,$r[$F+1]=$w*$N+$I*$T,$r[$F+2]=$w*$D+$I*$_,$r[$F+3]=$w*$e+$I*$y,$r},$E.getRotation=function($$,$b,$u,$Z){return Math.atan2($Z-$b,$u-$$)/Math.PI*180},$E.sortBigFirst=function($$,$b){return $$==$b?0:$$<$b?1:-1},$E.sortSmallFirst=function($$,$b){return $$==$b?0:$$<$b?-1:1},$E.sortNumBigFirst=function($$,$b){return parseFloat($b)-parseFloat($$)},$E.sortNumSmallFirst=function($$,$b){return parseFloat($$)-parseFloat($b)},$E.sortByKey=function($u,$$,$b){var $Z;return void 0===$$&&($$=!1),void 0===$b&&($b=!0),$Z=$$?$b?$E.sortNumBigFirst:$E.sortBigFirst:$b?$E.sortNumSmallFirst:$E.sortSmallFirst,function($$,$b){return $Z($$[$u],$b[$u])}},$E}(),$V=function(){function $u($$,$b,$u,$Z,$E,$r){this.inPool=!1,this.bTransform=!1,void 0===$$&&($$=1),void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=1),void 0===$E&&($E=0),void 0===$r&&($r=0),this.a=$$,this.b=$b,this.c=$u,this.d=$Z,this.tx=$E,this.ty=$r,this._checkTransform()}$e($u,"laya.maths.Matrix");var $$=$u.prototype;return $$.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$$._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$$.setTranslate=function($$,$b){return this.tx=$$,this.ty=$b,this},$$.translate=function($$,$b){return this.tx+=$$,this.ty+=$b,this},$$.scale=function($$,$b){this.a*=$$,this.d*=$b,this.c*=$$,this.b*=$b,this.tx*=$$,this.ty*=$b,this.bTransform=!0},$$.rotate=function($$){var $b=Math.cos($$),$u=Math.sin($$),$Z=this.a,$E=this.c,$r=this.tx;this.a=$Z*$b-this.b*$u,this.b=$Z*$u+this.b*$b,this.c=$E*$b-this.d*$u,this.d=$E*$u+this.d*$b,this.tx=$r*$b-this.ty*$u,this.ty=$r*$u+this.ty*$b,this.bTransform=!0},$$.skew=function($$,$b){var $u=Math.tan($$),$Z=Math.tan($b),$E=this.a,$r=this.b;return this.a+=$Z*this.c,this.b+=$Z*this.d,this.c+=$u*$E,this.d+=$u*$r,this},$$.invertTransformPoint=function($$){var $b=this.a,$u=this.b,$Z=this.c,$E=this.d,$r=this.tx,$F=$b*$E-$u*$Z,$x=$E/$F,$g=-$u/$F,$H=-$Z/$F,$w=$b/$F,$I=($Z*this.ty-$E*$r)/$F,$o=-($b*this.ty-$u*$r)/$F;return $$.setTo($x*$$.x+$H*$$.y+$I,$g*$$.x+$w*$$.y+$o)},$$.transformPoint=function($$){return $$.setTo(this.a*$$.x+this.c*$$.y+this.tx,this.b*$$.x+this.d*$$.y+this.ty)},$$.transformPointN=function($$){return $$.setTo(this.a*$$.x+this.c*$$.y,this.b*$$.x+this.d*$$.y)},$$.transformPointArray=function($$,$b){for(var $u=$$.length,$Z=0;$Z<$u;$Z+=2){var $E=$$[$Z],$r=$$[$Z+1];$b[$Z]=this.a*$E+this.c*$r+this.tx,$b[$Z+1]=this.b*$E+this.d*$r+this.ty}return $b},$$.transformPointArrayScale=function($$,$b){for(var $u=$$.length,$Z=0;$Z<$u;$Z+=2){var $E=$$[$Z],$r=$$[$Z+1];$b[$Z]=this.a*$E+this.c*$r,$b[$Z+1]=this.b*$E+this.d*$r}return $b},$$.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$$.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$$.invert=function(){var $$=this.a,$b=this.b,$u=this.c,$Z=this.d,$E=this.tx,$r=$$*$Z-$b*$u;return this.a=$Z/$r,this.b=-$b/$r,this.c=-$u/$r,this.d=$$/$r,this.tx=($u*this.ty-$Z*$E)/$r,this.ty=-($$*this.ty-$b*$E)/$r,this},$$.setTo=function($$,$b,$u,$Z,$E,$r){return this.a=$$,this.b=$b,this.c=$u,this.d=$Z,this.tx=$E,this.ty=$r,this},$$.concat=function($$){var $b=this.a,$u=this.c,$Z=this.tx;return this.a=$b*$$.a+this.b*$$.c,this.b=$b*$$.b+this.b*$$.d,this.c=$u*$$.a+this.d*$$.c,this.d=$u*$$.b+this.d*$$.d,this.tx=$Z*$$.a+this.ty*$$.c+$$.tx,this.ty=$Z*$$.b+this.ty*$$.d+$$.ty,this},$$.scaleEx=function($$,$b){var $u=this.a,$Z=this.b,$E=this.c,$r=this.d;0!==$Z||0!==$E?(this.a=$$*$u,this.b=$$*$Z,this.c=$b*$E):(this.a=$$*$u,this.b=0*$r,this.c=0*$u),this.d=$b*$r,this.bTransform=!0},$$.rotateEx=function($$){var $b=Math.cos($$),$u=Math.sin($$),$Z=this.a,$E=this.b,$r=this.c,$F=this.d;0!==$E||0!==$r?(this.a=$b*$Z+$u*$r,this.b=$b*$E+$u*$F,this.c=-$u*$Z+$b*$r,this.d=-$u*$E+$b*$F):(this.a=$b*$Z,this.b=$u*$F,this.c=-$u*$Z,this.d=$b*$F),this.bTransform=!0},$$.clone=function(){var $$=$u.create();return $$.a=this.a,$$.b=this.b,$$.c=this.c,$$.d=this.d,$$.tx=this.tx,$$.ty=this.ty,$$.bTransform=this.bTransform,$$},$$.copyTo=function($$){return $$.a=this.a,$$.b=this.b,$$.c=this.c,$$.d=this.d,$$.tx=this.tx,$$.ty=this.ty,$$.bTransform=this.bTransform,$$},$$.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$$.destroy=function(){if(!this.inPool){var $$=$u._cache;this.inPool=!0,$$._length||($$._length=0),($$[$$._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$u.mul=function($$,$b,$u){var $Z=$$.a,$E=$$.b,$r=$$.c,$F=$$.d,$x=$$.tx,$g=$$.ty,$H=$b.a,$w=$b.b,$I=$b.c,$o=$b.d,$N=$b.tx,$D=$b.ty;return 0!==$w||0!==$I?($u.a=$Z*$H+$E*$I,$u.b=$Z*$w+$E*$o,$u.c=$r*$H+$F*$I,$u.d=$r*$w+$F*$o,$u.tx=$H*$x+$I*$g+$N,$u.ty=$w*$x+$o*$g+$D):($u.a=$Z*$H,$u.b=$E*$o,$u.c=$r*$H,$u.d=$F*$o,$u.tx=$H*$x+$N,$u.ty=$o*$g+$D),$u},$u.mul16=function($$,$b,$u){var $Z=$$.a,$E=$$.b,$r=$$.c,$F=$$.d,$x=$$.tx,$g=$$.ty,$H=$b.a,$w=$b.b,$I=$b.c,$o=$b.d,$N=$b.tx,$D=$b.ty;return 0!==$w||0!==$I?($u[0]=$Z*$H+$E*$I,$u[1]=$Z*$w+$E*$o,$u[4]=$r*$H+$F*$I,$u[5]=$r*$w+$F*$o,$u[12]=$H*$x+$I*$g+$N,$u[13]=$w*$x+$o*$g+$D):($u[0]=$Z*$H,$u[1]=$E*$o,$u[4]=$r*$H,$u[5]=$F*$o,$u[12]=$H*$x+$N,$u[13]=$o*$g+$D),$u},$u.mulPre=function($$,$b,$u,$Z,$E,$r,$F,$x){var $g=$$.a,$H=$$.b,$w=$$.c,$I=$$.d,$o=$$.tx,$N=$$.ty;return 0!==$u||0!==$Z?($x.a=$g*$b+$H*$Z,$x.b=$g*$u+$H*$E,$x.c=$w*$b+$I*$Z,$x.d=$w*$u+$I*$E,$x.tx=$b*$o+$Z*$N+$r,$x.ty=$u*$o+$E*$N+$F):($x.a=$g*$b,$x.b=$H*$E,$x.c=$w*$b,$x.d=$I*$E,$x.tx=$b*$o+$r,$x.ty=$E*$N+$F),$x},$u.mulPos=function($$,$b,$u,$Z,$E,$r,$F,$x){var $g=$$.a,$H=$$.b,$w=$$.c,$I=$$.d,$o=$$.tx,$N=$$.ty;return 0!==$H||0!==$w?($x.a=$b*$g+$u*$w,$x.b=$b*$H+$u*$I,$x.c=$Z*$g+$E*$w,$x.d=$Z*$H+$E*$I,$x.tx=$g*$r+$w*$F+$o,$x.ty=$H*$r+$I*$F+$N):($x.a=$b*$g,$x.b=$u*$I,$x.c=$Z*$g,$x.d=$E*$I,$x.tx=$g*$r+$o,$x.ty=$I*$F+$N),$x},$u.preMul=function($$,$b,$u){var $Z=$$.a,$E=$$.b,$r=$$.c,$F=$$.d,$x=$b.a,$g=$b.b,$H=$b.c,$w=$b.d,$I=$b.tx,$o=$b.ty;return $u.a=$x*$Z,$u.b=$u.c=0,$u.d=$w*$F,$u.tx=$I*$Z+$$.tx,$u.ty=$o*$F+$$.ty,0===$g&&0===$H&&0===$E&&0===$r||($u.a+=$g*$r,$u.d+=$H*$E,$u.b+=$x*$E+$g*$F,$u.c+=$H*$Z+$w*$r,$u.tx+=$o*$r,$u.ty+=$I*$E),$u},$u.preMulXY=function($$,$b,$u,$Z){var $E=$$.a,$r=$$.b,$F=$$.c,$x=$$.d;return $Z.a=$E,$Z.b=$r,$Z.c=$F,$Z.d=$x,$Z.tx=$b*$E+$$.tx+$u*$F,$Z.ty=$u*$x+$$.ty+$b*$r,$Z},$u.create=function(){var $$=$u._cache,$b=$$._length?$$[--$$._length]:new $u;return $b.inPool=!1,$b},$u.EMPTY=new $u,$u.TEMP=new $u,$u._cache=[],$u}(),$q=function(){function $$($$,$b){void 0===$$&&($$=0),void 0===$b&&($b=0),this.x=$$,this.y=$b}$e($$,"laya.maths.Point");var $b=$$.prototype;return $b.setTo=function($$,$b){return this.x=$$,this.y=$b,this},$b.distance=function($$,$b){return Math.sqrt((this.x-$$)*(this.x-$$)+(this.y-$b)*(this.y-$b))},$b.toString=function(){return this.x+","+this.y},$b.normalize=function(){var $$=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$$){var $b=1/$$;this.x*=$b,this.y*=$b}},$$.TEMP=new $$,$$.EMPTY=new $$,$$}(),$a=function(){function $H($$,$b,$u,$Z){void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=0),this.x=$$,this.y=$b,this.width=$u,this.height=$Z}$e($H,"laya.maths.Rectangle");var $$=$H.prototype;return $$.setTo=function($$,$b,$u,$Z){return this.x=$$,this.y=$b,this.width=$u,this.height=$Z,this},$$.copyFrom=function($$){return this.x=$$.x,this.y=$$.y,this.width=$$.width,this.height=$$.height,this},$$.contains=function($$,$b){return!(this.width<=0||this.height<=0)&&($$>=this.x&&$$<this.right&&$b>=this.y&&$b<this.bottom)},$$.intersects=function($$){return!($$.x>this.x+this.width||$$.x+$$.width<this.x||$$.y>this.y+this.height||$$.y+$$.height<this.y)},$$.intersection=function($$,$b){return this.intersects($$)?($b||($b=new $H),$b.x=Math.max(this.x,$$.x),$b.y=Math.max(this.y,$$.y),$b.width=Math.min(this.right,$$.right)-$b.x,$b.height=Math.min(this.bottom,$$.bottom)-$b.y,$b):null},$$.union=function($$,$b){return $b||($b=new $H),this.clone($b),$$.width<=0||$$.height<=0?$b:($b.addPoint($$.x,$$.y),$b.addPoint($$.right,$$.bottom),this)},$$.clone=function($$){return $$||($$=new $H),$$.x=this.x,$$.y=this.y,$$.width=this.width,$$.height=this.height,$$},$$.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$$.equals=function($$){return!(!$$||$$.x!==this.x||$$.y!==this.y||$$.width!==this.width||$$.height!==this.height)},$$.addPoint=function($$,$b){return this.x>$$&&(this.width+=this.x-$$,this.x=$$),this.y>$b&&(this.height+=this.y-$b,this.y=$b),this.width<$$-this.x&&(this.width=$$-this.x),this.height<$b-this.y&&(this.height=$b-this.y),this},$$._getBoundPoints=function(){var $$=$H._temB;return($$.length=0)==this.width||0==this.height||$$.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$$},$$.isEmpty=function(){return this.width<=0||this.height<=0},$w(0,$$,"right",function(){return this.x+this.width}),$w(0,$$,"bottom",function(){return this.y+this.height}),$H._getBoundPointS=function($$,$b,$u,$Z){var $E=$H._temA;return($E.length=0)==$u||0==$Z||$E.push($$,$b,$$+$u,$b,$$,$b+$Z,$$+$u,$b+$Z),$E},$H._getWrapRec=function($$,$b){if(!$$||$$.length<1)return $b?$b.setTo(0,0,0,0):$H.TEMP.setTo(0,0,0,0);$b=$b||new $H;var $u,$Z,$E,$r,$F,$x=$$.length,$g=$q.TEMP;for($E=$F=-($Z=$r=99999),$u=0;$u<$x;$u+=2)$g.x=$$[$u],$g.y=$$[$u+1],$Z=$Z<$g.x?$Z:$g.x,$r=$r<$g.y?$r:$g.y,$E=$E>$g.x?$E:$g.x,$F=$F>$g.y?$F:$g.y;return $b.setTo($Z,$r,$E-$Z,$F-$r)},$H.EMPTY=new $H,$H.TEMP=new $H,$H._temB=[],$H._temA=[],$H}(),$K=function(){function $g(){}return $e($g,"laya.media.SoundManager"),$w(1,$g,"useAudioMusic",function(){return $g._useAudioMusic},function($$){$g._useAudioMusic=$$,$g._musicClass=$$?$u$:null}),$w(1,$g,"autoStopMusic",function(){return $g._autoStopMusic},function($$){$z.stage.off("blur",null,$g._stageOnBlur),$z.stage.off("focus",null,$g._stageOnFocus),$z.stage.off("visibilitychange",null,$g._visibilityChange),($g._autoStopMusic=$$)&&($z.stage.on("blur",null,$g._stageOnBlur),$z.stage.on("focus",null,$g._stageOnFocus),$z.stage.on("visibilitychange",null,$g._visibilityChange))}),$w(1,$g,"muted",function(){return $g._muted},function($$){$$!=$g._muted&&($$&&$g.stopAllSound(),$g.musicMuted=$$,$g._muted=$$)}),$w(1,$g,"musicMuted",function(){return $g._musicMuted},function($$){$$!=$g._musicMuted&&($$?($g._tMusic&&$g._musicChannel&&!$g._musicChannel.isStopped?$g._musicChannel.pause():$g._musicChannel=null,$g._musicMuted=$$):($g._musicMuted=$$,$g._tMusic&&$g._musicChannel&&$g._musicChannel.resume()))}),$w(1,$g,"soundMuted",function(){return $g._soundMuted},function($$){$g._soundMuted=$$}),$g.addChannel=function($$){0<=$g._channels.indexOf($$)||($g._channels.push($$),$g.autoReleaseSound&&0!=$g._notUsedCount&&$g._notUsedUrls[$$.url]&&(delete $g._notUsedUrls[$$.url],0==--$g._notUsedCount&&$z.timer.clear($g,$g.disposeSoundIfNotUsed)))},$g.removeChannel=function($$){var $b=$g._channels,$u=$b.indexOf($$);if(-1!=$u&&($b.splice($u,1),$g.autoReleaseSound)){var $Z=$$.url,$E=$g.defaultIntervals[$Z]||2e4;if(0<$E){var $r=!0;for($u=$b.length-1;0<=$u;$u--)if($b[$u].url==$Z){$r=!1;break}$r&&($g._notUsedUrls[$Z]=Date.now()+$E,0==$g._notUsedCount++&&$z.timer.loop(1e4,$g,$g.disposeSoundIfNotUsed))}}},$g.disposeSoundIfNotUsed=function(){var $$=$g._notUsedUrls;if(0!=$g._notUsedCount){var $b=Date.now();for(var $u in $$)$b>=$$[$u]&&(delete $$[$u],--$g._notUsedCount,$g.destroySound($u));if(0!=$g._notUsedCount)return}$z.timer.clear($g,$g.disposeSoundIfNotUsed)},$g._visibilityChange=function(){$z.stage.isVisibility?$g._stageOnFocus():$g._stageOnBlur()},$g._stageOnBlur=function(){$g._isActive=!1,$g._musicChannel&&($g._musicChannel.isStopped||($g._blurPaused=!0,$g._musicChannel.pause())),$g.stopAllSound(),$z.stage.once("mousedown",null,$g._stageOnFocus)},$g._recoverWebAudio=function(){$r$.ctx&&"running"!=$r$.ctx.state&&$r$.ctx.resume&&$r$.ctx.resume()},$g._stageOnFocus=function(){if($g._isActive=!0,$g._recoverWebAudio(),$z.stage.off("mousedown",null,$g._stageOnFocus),$g._blurPaused){var $$=$g._musicChannel;$$&&$g._music&&$$.isStopped&&($g._blurPaused=!1,$g._music._disposed?$g.playMusic($$.url,$$.loops,$$.startHandler,$$.completeHandler,$$.startTime):$$.audioBuffer?$$.resume():$g._music.play($$.startTime,$$.loops,$$.startHandler,$$))}},$g.playSound=function($$,$b,$u,$Z,$E,$r){if(void 0===$b&&($b=1),void 0===$r&&($r=0),!$$)return null;if($g._muted)return null;if($g._recoverWebAudio(),$$==$g._tMusic){if($g._musicMuted)return null}else{if(!$g._isActive)return null;if($g._soundMuted)return null}var $F,$x=$g._pool[$$];return $E||($E=$g._soundClass),$x||(($x=new $E).load($$),$g._pool[$$]=$x),($F=$x.play($r,$b,$u))?($$==$g._tMusic&&($g._music=$x,$g._isActive||($g._blurPaused=!0,$F.pause())),$F.url=$$,$F.volume=$$==$g._tMusic?$g.musicVolume:$g.soundVolume,$F.completeHandler=$Z,$F):null},$g.destroySound=function($$){var $b=$g._pool[$$];$b&&(delete $g._pool[$$],$b.dispose())},$g.playMusic=function($$,$b,$u,$Z,$E){return void 0===$b&&($b=0),void 0===$E&&($E=0),$g._tMusic=$$,$g._musicChannel&&$g._musicChannel.stop(),$g._musicChannel=$g.playSound($$,$b,$u,$Z,null,$E)},$g.stopSound=function($$){for(var $b,$u=$g._channels.length-1;0<=$u;$u--)($b=$g._channels[$u]).url==$$&&$b.stop()},$g.stopAll=function(){$g._tMusic=null;var $$=0;for($$=$g._channels.length-1;0<=$$;$$--)$g._channels[$$].stop()},$g.stopAllSound=function(){var $$,$b=0;for($b=$g._channels.length-1;0<=$b;$b--)($$=$g._channels[$b]).url!=$g._tMusic&&$$.stop()},$g.stopMusic=function(){$g._musicChannel&&$g._musicChannel.stop(),$g._tMusic=null},$g.setSoundVolume=function($$,$b){if($b)$g._setVolume($b,$$);else{$g.soundVolume=$$;var $u,$Z=0;for($Z=$g._channels.length-1;0<=$Z;$Z--)($u=$g._channels[$Z]).url!=$g._tMusic&&($u.volume=$$)}},$g.setMusicVolume=function($$){$g.musicVolume=$$,$g._setVolume($g._tMusic,$$)},$g._setVolume=function($$,$b){for(var $u,$Z=$g._channels.length-1;0<=$Z;$Z--)($u=$g._channels[$Z]).url==$$&&($u.volume=$b)},$g.musicVolume=1,$g.soundVolume=1,$g.playbackRate=1,$g._useAudioMusic=!0,$g._muted=!1,$g._soundMuted=!1,$g._musicMuted=!1,$g._tMusic=null,$g._musicChannel=null,$g._music=null,$g._channels=[],$g._autoStopMusic=!1,$g._blurPaused=!1,$g._isActive=!0,$g._soundClass=null,$g._musicClass=null,$g.autoReleaseSound=!0,$g._pool={},$g.defaultIntervals={},$g._notUsedUrls={},$g._notUsedCount=0,$g}(),$t=function(){var $$;function $u(){}return $e($u,"laya.net.LocalStorage"),$u.__init__=function(){$u._baseClass||($u._baseClass=$$).init(),$u.items=$u._baseClass.items,$u.support=$u._baseClass.support},$u.setItem=function($$,$b){$u._baseClass.setItem($$,$b)},$u.getItem=function($$){return $u._baseClass.getItem($$)},$u.setJSON=function($$,$b){$u._baseClass.setJSON($$,$b)},$u.getJSON=function($$){return $u._baseClass.getJSON($$)},$u.removeItem=function($$){$u._baseClass.removeItem($$)},$u.clear=function(){$u._baseClass.clear()},$u._baseClass=null,$u.items=null,$u.support=!1,$u.__init$=function(){$$=function(){function $u(){}return $e($u,""),$u.init=function(){try{$u.support=!0,$u.items=$F.localStorage,$u.setItem("laya","1"),$u.removeItem("laya")}catch($$){$u.support=!1}$u.support||console.log("LocalStorage is not supprot or browser is private mode.")},$u.setItem=function($$,$b){try{$u.support&&$u.items.setItem($$,$b)}catch($$){console.warn("set localStorage failed",$$)}},$u.getItem=function($$){return $u.support?$u.items.getItem($$):null},$u.setJSON=function($$,$b){try{$u.support&&$u.items.setItem($$,JSON.stringify($b))}catch($$){console.warn("set localStorage failed",$$)}},$u.getJSON=function($$){return JSON.parse($u.support?$u.items.getItem($$):null)},$u.removeItem=function($$){$u.support&&$u.items.removeItem($$)},$u.clear=function(){$u.support&&$u.items.clear()},$u.items=null,$u.support=!1,$u}()},$u}(),$v=(function(){function $Z(){}$e($Z,"laya.net.ResourceVersion"),$Z.enable=function($$,$b,$u){void 0===$u&&($u=2),laya.net.ResourceVersion.type=$u,$z.loader.load($$,$_.create(null,$Z.onManifestLoaded,[$b]),null,"json"),$p.customFormat=$Z.addVersionPrefix},$Z.onManifestLoaded=function($$,$b){$Z.manifest=$b,$$.run(),$b||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$Z.addVersionPrefix=function($$){return $Z.manifest&&$Z.manifest[$$]?2==$Z.type?$Z.manifest[$$]:$Z.manifest[$$]+"/"+$$:$$},$Z.FOLDER_VERSION=1,$Z.FILENAME_VERSION=2,$Z.manifest=null,$Z.type=1}(),function(){function $$(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$e($$,"laya.net.TTFLoader");var $b=$$.prototype;return $b.load=function($$){var $b=(this._url=$$).split(".ttf")[0].split("/");this.fontName=$b[$b.length-1],$s.window.conch?this._loadConch():$s.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$b._loadConch=function(){this._http=new $F$,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$b._onHttpLoaded=function($$){$s.window.conch.setFontFaceFromBuffer(this.fontName,$$),this._clearHttp(),this._complete()},$b._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$b._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$b._complete=function(){$z.timer.clear(this,this._complete),$z.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$b._checkComplete=function(){$O.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$b._loadWithFontFace=function(){var $$=new $s.window.FontFace(this.fontName,"url('"+this._url+"')");$s.window.document.fonts.add($$);var $b=this;$$.loaded.then(function(){$b._complete()}),$$.load()},$b._createDiv=function(){this._div=$s.createElement("div"),this._div.innerHTML="laya";var $$=this._div.style;$$.fontFamily=this.fontName,$$.position="absolute",$$.left="-100px",$$.top="-100px",$s.document.body.appendChild(this._div)},$b._loadWithCSS=function(){var $$=this,$b=$s.createElement("style");$b.type="text/css",$s.document.body.appendChild($b),$b.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$O.measureText("LayaTTFFont",this._fontTxt).width;var $u=this;$b.onload=function(){$z.timer.once(1e4,$u,$$._complete)},$z.timer.loop(20,this,this._checkComplete),this._createDiv()},$$._testString="LayaTTFFont",$$}()),$p=function(){function $Z($$){this._url=null,this._path=null,this._url=$Z.formatURL($$),this._path=$Z.getPath($$)}$e($Z,"laya.net.URL");var $$=$Z.prototype;return $w(0,$$,"path",function(){return this._path}),$w(0,$$,"url",function(){return this._url}),$Z.formatURL=function($$,$b){if(!$$)return"null path";if(0<$$.indexOf(":"))return $$;null!=$Z.customFormat&&($$=$Z.customFormat($$,$b));var $u=$$.charAt(0);if("."===$u)return $Z.formatRelativePath(($b||$Z.basePath)+$$);if("~"===$u)return $Z.rootPath+$$.substring(1);if("d"===$u){if(0===$$.indexOf("data:image"))return $$}else if("/"===$u)return $$;return($b||$Z.basePath)+$$},$Z.formatRelativePath=function($$){for(var $b=$$.split("/"),$u=0,$Z=$b.length;$u<$Z;$u++)".."==$b[$u]&&($b.splice($u-1,2),$u-=2);return $b.join("/")},$Z.isAbsolute=function($$){return 0<$$.indexOf(":")||"/"==$$.charAt(0)},$Z.getPath=function($$){var $b=$$.lastIndexOf("/");return 0<$b?$$.substr(0,$b+1):""},$Z.getFileName=function($$){var $b=$$.lastIndexOf("/");return 0<$b?$$.substr($b+1):$$},$Z.version={},$Z.basePath="",$Z.rootPath="",$Z.customFormat=function($$){var $b=$Z.version[$$];return!$Y.isConchApp&&$b&&($$+="?v="+$b),$$},$Z}(),$Y=function(){function $E($$,$b){this._timeId=0;var $u=$E._mainCanvas.source.style;$u.position="absolute",$u.top=$u.left="0px",$u.background="#000000",$E._mainCanvas.source.id="layaCanvas";var $Z=laya.renders.Render.isWebGL;$E._mainCanvas.source.width=$$,$E._mainCanvas.source.height=$b,$Z&&$E.WebGL.init($E._mainCanvas,$$,$b),$s.container.appendChild($E._mainCanvas.source),($E._context=new $k($$,$b,$Z?null:$E._mainCanvas)).ctx.setIsMainContext(),$s.window.requestAnimationFrame(function $$($b){$s.window.requestAnimationFrame($$);$z.stage._loop()}),$z.stage.on("visibilitychange",this,this._onVisibilitychange)}$e($E,"laya.renders.Render");var $$=$E.prototype;return $$._onVisibilitychange=function(){$z.stage.isVisibility?0!=this._timeId&&$s.window.clearInterval(this._timeId):this._timeId=$s.window.setInterval(this._enterFrame,1e3)},$$._enterFrame=function($$){$z.stage._loop()},$w(1,$E,"context",function(){return $E._context}),$w(1,$E,"canvas",function(){return $E._mainCanvas.source}),$E._context=null,$E._mainCanvas=null,$E.WebGL=null,$E.isConchNode=!1,$E.isConchApp=!1,$E.isConchWebGL=!1,$E.isWebGL=!1,$E.is3DMode=!1,$E.optimizeTextureMemory=function($$,$b){return!0},$E.__init$=function(){$F.ConchRenderType=$F.ConchRenderType||1,$F.ConchRenderType|=$F.conch?4:0,$E.isConchNode=5==(5&$F.ConchRenderType),$E.isConchApp=4==(4&$F.ConchRenderType),$E.isConchWebGL=6==$F.ConchRenderType},$E}(),$k=function(){function $F($$,$b,$u){this.x=0,this.y=0,this._drawTexture=function($$,$b,$u){$u[0].loaded&&this.ctx.drawTexture($u[0],$u[1],$u[2],$u[3],$u[4],$$,$b)},this._fillTexture=function($$,$b,$u){$u[0].loaded&&this.ctx.fillTexture($u[0],$u[1]+$$,$u[2]+$b,$u[3],$u[4],$u[5],$u[6],$u[7])},this._drawTextureWithTransform=function($$,$b,$u){$u[0].loaded&&this.ctx.drawTextureWithTransform($u[0],$u[1],$u[2],$u[3],$u[4],$u[5],$$,$b,$u[6])},this._fillQuadrangle=function($$,$b,$u){this.ctx.fillQuadrangle($u[0],$u[1],$u[2],$u[3],$u[4])},this._drawRect=function($$,$b,$u){var $Z=this.ctx;null!=$u[4]&&($Z.fillStyle=$u[4],$Z.fillRect($$+$u[0],$b+$u[1],$u[2],$u[3],null)),null!=$u[5]&&($Z.strokeStyle=$u[5],$Z.lineWidth=$u[6],$Z.strokeRect($$+$u[0],$b+$u[1],$u[2],$u[3],$u[6]))},this._drawPie=function($$,$b,$u){var $Z=this.ctx;$Y.isWebGL&&$Z.setPathId($u[8]),$Z.beginPath(),$Y.isWebGL?($Z.movePath($u[0]+$$,$u[1]+$b),$Z.moveTo(0,0)):$Z.moveTo($$+$u[0],$b+$u[1]),$Z.arc($$+$u[0],$b+$u[1],$u[2],$u[3],$u[4]),$Z.closePath(),this._fillAndStroke($u[5],$u[6],$u[7],!0)},this._clipRect=function($$,$b,$u){this.ctx.clipRect($$+$u[0],$b+$u[1],$u[2],$u[3])},this._fillRect=function($$,$b,$u){this.ctx.fillRect($$+$u[0],$b+$u[1],$u[2],$u[3],$u[4])},this._drawCircle=function($$,$b,$u){var $Z=this.ctx;$Y.isWebGL&&$Z.setPathId($u[6]),$A.drawCall++,$Z.beginPath(),$Y.isWebGL&&$Z.movePath($u[0]+$$,$u[1]+$b),$Z.arc($u[0]+$$,$u[1]+$b,$u[2],0,$F.PI2),$Z.closePath(),this._fillAndStroke($u[3],$u[4],$u[5],!0)},this._fillCircle=function($$,$b,$u){$A.drawCall++;var $Z=this.ctx;$Z.beginPath(),$Z.fillStyle=$u[3],$Z.arc($u[0]+$$,$u[1]+$b,$u[2],0,$F.PI2),$Z.fill()},this._setShader=function($$,$b,$u){this.ctx.setShader($u[0])},this._drawLine=function($$,$b,$u){var $Z=this.ctx;$Y.isWebGL&&$Z.setPathId($u[6]),$Z.beginPath(),$Z.strokeStyle=$u[4],$Z.lineWidth=$u[5],$Y.isWebGL?($Z.movePath($$,$b),$Z.moveTo($u[0],$u[1]),$Z.lineTo($u[2],$u[3])):($Z.moveTo($$+$u[0],$b+$u[1]),$Z.lineTo($$+$u[2],$b+$u[3])),$Z.stroke()},this._drawLines=function($$,$b,$u){var $Z=this.ctx;$Y.isWebGL&&$Z.setPathId($u[5]),$Z.beginPath(),$$+=$u[0],$b+=$u[1],$Y.isWebGL&&$Z.movePath($$,$b),$Z.strokeStyle=$u[3],$Z.lineWidth=$u[4];var $E=$u[2],$r=2,$F=$E.length;if($Y.isWebGL)for($Z.moveTo($E[0],$E[1]);$r<$F;)$Z.lineTo($E[$r++],$E[$r++]);else for($Z.moveTo($$+$E[0],$b+$E[1]);$r<$F;)$Z.lineTo($$+$E[$r++],$b+$E[$r++]);$Z.stroke()},this._drawLinesWebGL=function($$,$b,$u){this.ctx.drawLines($$+this.x+$u[0],$b+this.y+$u[1],$u[2],$u[3],$u[4])},this._drawCurves=function($$,$b,$u){this.ctx.drawCurves($$,$b,$u)},this._draw=function($$,$b,$u){$u[0].call(null,this,$$,$b)},this._transformByMatrix=function($$,$b,$u){this.ctx.transformByMatrix($u[0])},this._setTransform=function($$,$b,$u){this.ctx.setTransform($u[0],$u[1],$u[2],$u[3],$u[4],$u[5])},this._setTransformByMatrix=function($$,$b,$u){this.ctx.setTransformByMatrix($u[0])},this._save=function($$,$b,$u){this.ctx.save()},this._restore=function($$,$b,$u){this.ctx.restore()},this._translate=function($$,$b,$u){this.ctx.translate($u[0],$u[1])},this._transform=function($$,$b,$u){this.ctx.translate($u[1]+$$,$u[2]+$b);var $Z=$u[0];this.ctx.transform($Z.a,$Z.b,$Z.c,$Z.d,$Z.tx,$Z.ty),this.ctx.translate(-$$-$u[1],-$b-$u[2])},this._rotate=function($$,$b,$u){this.ctx.translate($u[1]+$$,$u[2]+$b),this.ctx.rotate($u[0]),this.ctx.translate(-$$-$u[1],-$b-$u[2])},this._scale=function($$,$b,$u){this.ctx.translate($u[2]+$$,$u[3]+$b),this.ctx.scale($u[0],$u[1]),this.ctx.translate(-$$-$u[2],-$b-$u[3])},this._alpha=function($$,$b,$u){this.ctx.globalAlpha*=$u[0]},this._setAlpha=function($$,$b,$u){this.ctx.globalAlpha=$u[0]},this._fillText=function($$,$b,$u){this.ctx.fillText($u[0],$u[1]+$$,$u[2]+$b,$u[3],$u[4],$u[5])},this._strokeText=function($$,$b,$u){this.ctx.strokeText($u[0],$u[1]+$$,$u[2]+$b,$u[3],$u[4],$u[5],$u[6])},this._fillBorderText=function($$,$b,$u){this.ctx.fillBorderText($u[0],$u[1]+$$,$u[2]+$b,$u[3],$u[4],$u[5],$u[6],$u[7])},this._blendMode=function($$,$b,$u){this.ctx.globalCompositeOperation=$u[0]},this._beginClip=function($$,$b,$u){this.ctx.beginClip&&this.ctx.beginClip($$+$u[0],$b+$u[1],$u[2],$u[3])},this._setIBVB=function($$,$b,$u){this.ctx.setIBVB($u[0]+$$,$u[1]+$b,$u[2],$u[3],$u[4],$u[5],$u[6],$u[7])},this._fillTrangles=function($$,$b,$u){this.ctx.fillTrangles($u[0],$u[1]+$$,$u[2]+$b,$u[3],$u[4])},this._drawPath=function($$,$b,$u){var $Z=this.ctx;$Y.isWebGL&&$Z.setPathId(-1),$Z.beginPath(),$$+=$u[0],$b+=$u[1],$Y.isWebGL&&$Z.movePath($$,$b);for(var $E=$u[2],$r=0,$F=$E.length;$r<$F;$r++){var $x=$E[$r];switch($x[0]){case"moveTo":$Y.isWebGL?$Z.moveTo($x[1],$x[2]):$Z.moveTo($$+$x[1],$b+$x[2]);break;case"lineTo":$Y.isWebGL?$Z.lineTo($x[1],$x[2]):$Z.lineTo($$+$x[1],$b+$x[2]);break;case"arcTo":$Y.isWebGL?$Z.arcTo($x[1],$x[2],$x[3],$x[4],$x[5]):$Z.arcTo($$+$x[1],$b+$x[2],$$+$x[3],$b+$x[4],$x[5]);break;case"closePath":$Z.closePath()}}var $g=$u[3];null!=$g&&($Z.fillStyle=$g.fillStyle,$Z.fill());var $H=$u[4];null!=$H&&($Z.strokeStyle=$H.strokeStyle,$Z.lineWidth=$H.lineWidth||1,$Z.lineJoin=$H.lineJoin,$Z.lineCap=$H.lineCap,$Z.miterLimit=$H.miterLimit,$Z.stroke())},this.drawPoly=function($$,$b,$u){this.ctx.drawPoly($$+this.x+$u[0],$b+this.y+$u[1],$u[2],$u[3],$u[4],$u[5],$u[6])},this._drawPoly=function($$,$b,$u){var $Z=this.ctx,$E=$u[2],$r=2,$F=$E.length;if($Y.isWebGL)for($Z.setPathId($u[6]),$Z.beginPath(),$$+=$u[0],$b+=$u[1],$Z.movePath($$,$b),$Z.moveTo($E[0],$E[1]);$r<$F;)$Z.lineTo($E[$r++],$E[$r++]);else for($Z.beginPath(),$$+=$u[0],$b+=$u[1],$Z.moveTo($$+$E[0],$b+$E[1]);$r<$F;)$Z.lineTo($$+$E[$r++],$b+$E[$r++]);$Z.closePath(),this._fillAndStroke($u[3],$u[4],$u[5],$u[7])},this._drawSkin=function($$,$b,$u){var $Z=$u[0];if($Z){var $E=this.ctx;$Z.render($E,$$,$b)}},this._drawParticle=function($$,$b,$u){this.ctx.drawParticle($$+this.x,$b+this.y,$u[0])},this._setFilters=function($$,$b,$u){this.ctx.setFilters($u)},$u?this.ctx=$u.getContext("2d"):($u=$y$.create("3D"),this.ctx=$O.createWebGLContext2D($u),$u._setContext(this.ctx)),$u.size($$,$b),this.canvas=$u}$e($F,"laya.renders.RenderContext");var $$=$F.prototype;return $$.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$$.drawTexture=function($$,$b,$u,$Z,$E){$$.loaded&&this.ctx.drawTexture($$,$b,$u,$Z,$E,this.x,this.y)},$$._drawTextures=function($$,$b,$u){$u[0].loaded&&this.ctx.drawTextures($u[0],$u[1],$$+this.x,$b+this.y)},$$.drawTextureWithTransform=function($$,$b,$u,$Z,$E,$r,$F){$$.loaded&&this.ctx.drawTextureWithTransform($$,$b,$u,$Z,$E,$r,this.x,this.y,$F)},$$.fillQuadrangle=function($$,$b,$u,$Z,$E){this.ctx.fillQuadrangle($$,$b,$u,$Z,$E)},$$.drawCanvas=function($$,$b,$u,$Z,$E){this.ctx.drawCanvas($$,$b+this.x,$u+this.y,$Z,$E)},$$.drawRect=function($$,$b,$u,$Z,$E,$r){void 0===$r&&($r=1);var $F=this.ctx;$F.strokeStyle=$E,$F.lineWidth=$r,$F.strokeRect($$+this.x,$b+this.y,$u,$Z,$r)},$$._fillAndStroke=function($$,$b,$u,$Z){void 0===$Z&&($Z=!1);var $E=this.ctx;null!=$$&&($E.fillStyle=$$,$Y.isWebGL?$E.fill($Z):$E.fill()),null!=$b&&0<$u&&($E.strokeStyle=$b,$E.lineWidth=$u,$E.stroke())},$$.clipRect=function($$,$b,$u,$Z){this.ctx.clipRect($$+this.x,$b+this.y,$u,$Z)},$$.fillRect=function($$,$b,$u,$Z,$E){this.ctx.fillRect($$+this.x,$b+this.y,$u,$Z,$E)},$$.drawCircle=function($$,$b,$u,$Z,$E){void 0===$E&&($E=1),$A.drawCall++;var $r=this.ctx;$r.beginPath(),$r.strokeStyle=$Z,$r.lineWidth=$E,$r.arc($$+this.x,$b+this.y,$u,0,$F.PI2),$r.stroke()},$$.drawTriangles=function($$,$b,$u){if($Y.isWebGL)this.ctx.drawTriangles($u[0],$$+$u[1],$b+$u[2],$u[3],$u[4],$u[5],$u[6],$u[7],$u[8],$u[9]);else{var $Z=$u[5],$E=0,$r=$Z.length,$F=this.ctx;for($E=0;$E<$r;$E+=3){var $x=2*$Z[$E],$g=2*$Z[$E+1],$H=2*$Z[$E+2];$F.drawTriangle($u[0],$u[3],$u[4],$x,$g,$H,$u[6],!0)}}},$$.fillCircle=function($$,$b,$u,$Z){$A.drawCall++;var $E=this.ctx;$E.beginPath(),$E.fillStyle=$Z,$E.arc($$+this.x,$b+this.y,$u,0,$F.PI2),$E.fill()},$$.setShader=function($$){this.ctx.setShader($$)},$$.drawLine=function($$,$b,$u,$Z,$E,$r){void 0===$r&&($r=1);var $F=this.ctx;$F.beginPath(),$F.strokeStyle=$E,$F.lineWidth=$r,$F.moveTo(this.x+$$,this.y+$b),$F.lineTo(this.x+$u,this.y+$Z),$F.stroke()},$$.clear=function(){this.ctx.clear()},$$.transformByMatrix=function($$){this.ctx.transformByMatrix($$)},$$.setTransform=function($$,$b,$u,$Z,$E,$r){this.ctx.setTransform($$,$b,$u,$Z,$E,$r)},$$.setTransformByMatrix=function($$){this.ctx.setTransformByMatrix($$)},$$.save=function(){this.ctx.save()},$$.restore=function(){this.ctx.restore()},$$.translate=function($$,$b){this.ctx.translate($$,$b)},$$.transform=function($$,$b,$u,$Z,$E,$r){this.ctx.transform($$,$b,$u,$Z,$E,$r)},$$.rotate=function($$){this.ctx.rotate($$)},$$.scale=function($$,$b){this.ctx.scale($$,$b)},$$.alpha=function($$){this.ctx.globalAlpha*=$$},$$.setAlpha=function($$){this.ctx.globalAlpha=$$},$$.fillWords=function($$,$b,$u,$Z,$E,$r){void 0===$r&&($r=0),this.ctx.fillWords($$,$b,$u,$Z,$E,$r)},$$.fillBorderWords=function($$,$b,$u,$Z,$E,$r,$F){this.ctx.fillBorderWords($$,$b,$u,$Z,$E,$r,$F)},$$.fillText=function($$,$b,$u,$Z,$E,$r){this.ctx.fillText($$,$b+this.x,$u+this.y,$Z,$E,$r)},$$.strokeText=function($$,$b,$u,$Z,$E,$r,$F){this.ctx.strokeText($$,$b+this.x,$u+this.y,$Z,$E,$r,$F)},$$.blendMode=function($$){this.ctx.globalCompositeOperation=$$},$$.flush=function(){this.ctx.flush&&this.ctx.flush()},$$.addRenderObject=function($$){this.ctx.addRenderObject($$)},$$.beginClip=function($$,$b,$u,$Z){this.ctx.beginClip&&this.ctx.beginClip($$,$b,$u,$Z)},$$.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$$.fillTrangles=function($$,$b,$u){this.ctx.fillTrangles($u[0],$u[1],$u[2],$u[3],4<$u.length?$u[4]:null)},$F.PI2=2*Math.PI,$F}(),$M=function(){function $F($$,$b){switch(this._next=$b||$F.NORENDER,$$){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$T._filter);case 69905:return void(this._fun=$F._initRenderFun)}this.onCreate($$)}$e($F,"laya.renders.RenderSprite");var $$=$F.prototype;return $$.onCreate=function($$){},$$._style=function($$,$b,$u,$Z){$$._style.render($$,$b,$u,$Z);var $E=this._next;$E._fun.call($E,$$,$b,$u,$Z)},$$._no=function($$,$b,$u,$Z){},$$._custom=function($$,$b,$u,$Z){$$.customRender($b,$u,$Z);var $E=$$._style._tf;this._next._fun.call(this._next,$$,$b,$u-$E.translateX,$Z-$E.translateY)},$$._clip=function($$,$b,$u,$Z){var $E=this._next;if($E!=$F.NORENDER){var $r=$$._style.scrollRect;$b.ctx.save(),$b.ctx.clipRect($u,$Z,$r.width,$r.height),$E._fun.call($E,$$,$b,$u-$r.x,$Z-$r.y),$b.ctx.restore()}},$$._blend=function($$,$b,$u,$Z){var $E=$$._style;$E.blendMode&&($b.ctx.globalCompositeOperation=$E.blendMode);var $r=this._next;$r._fun.call($r,$$,$b,$u,$Z),$b.ctx.globalCompositeOperation="source-over"},$$._mask=function($$,$b,$u,$Z){var $E=this._next;$E._fun.call($E,$$,$b,$u,$Z);var $r=$$.mask;$r&&($b.ctx.globalCompositeOperation="destination-in",(0<$r.numChildren||!$r.graphics._isOnlyOne())&&($r.cacheAsBitmap=!0),$r.render($b,$u-$$.pivotX,$Z-$$.pivotY)),$b.ctx.globalCompositeOperation="source-over"},$$._graphics=function($$,$b,$u,$Z){var $E=$$._style._tf;$$._graphics&&$$._graphics._render($$,$b,$u-$E.translateX,$Z-$E.translateY);var $r=this._next;$r._fun.call($r,$$,$b,$u,$Z)},$$._image=function($$,$b,$u,$Z){var $E=$$._style;$b.ctx.drawTexture2($u,$Z,$E._tf.translateX,$E._tf.translateY,$$.transform,$E.alpha,$E.blendMode,$$._graphics._one)},$$._image2=function($$,$b,$u,$Z){var $E=$$._style._tf;$b.ctx.drawTexture2($u,$Z,$E.translateX,$E.translateY,$$.transform,1,null,$$._graphics._one)},$$._alpha=function($$,$b,$u,$Z){var $E;if(.01<($E=$$._style.alpha)||$$._needRepaint()){var $r=$b.ctx.globalAlpha;$b.ctx.globalAlpha*=$E;var $F=this._next;$F._fun.call($F,$$,$b,$u,$Z),$b.ctx.globalAlpha=$r}},$$._transform=function($$,$b,$u,$Z){var $E=$$.transform,$r=this._next;$E&&$r!=$F.NORENDER?($b.save(),$b.transform($E.a,$E.b,$E.c,$E.d,$E.tx+$u,$E.ty+$Z),$r._fun.call($r,$$,$b,0,0),$b.restore()):$r._fun.call($r,$$,$b,$u,$Z)},$$._childs=function($$,$b,$u,$Z){var $E=$$._style,$r=$E._tf;if($u=$u-$r.translateX+$E.paddingLeft,$Z=$Z-$r.translateY+$E.paddingTop,$E._calculation){var $F=$$._getWords();if($F){var $x=$E;$x&&($x.stroke?$b.fillBorderWords($F,$u,$Z,$x.font,$x.color,$x.strokeColor,$x.stroke):$b.fillWords($F,$u,$Z,$x.font,$x.color,"none"!=$x.textDecoration&&$x.underLine?1:0))}}var $g,$H=$$._childs,$w=$H.length;if($$.viewport||$$.optimizeScrollRect&&$$._style.scrollRect){var $I=$$.viewport||$$._style.scrollRect,$o=$I.x,$N=$I.y,$D=$I.right,$e=$I.bottom,$L=NaN,$T=NaN;for($_=0;$_<$w;++$_)($g=$H[$_]).visible&&($L=$g._x)<$D&&$L+$g.width>$o&&($T=$g._y)<$e&&$T+$g.height>$N&&$g.render($b,$u,$Z)}else for(var $_=0;$_<$w;++$_)($g=$H[$_])._style.visible&&$g.render($b,$u,$Z)},$$._canvas=function($$,$b,$u,$Z){var $E=$$._$P.cacheCanvas;if($E){"bitmap"===$E.type?$A.canvasBitmap++:$A.canvasNormal++;var $r=$E.ctx;if($$._needRepaint()||!$r)this._canvas_repaint($$,$b,$u,$Z);else{var $F=$E._cacheRec;$b.drawCanvas($r.canvas,$u+$F.x,$Z+$F.y,$F.width,$F.height)}}else this._next._fun.call(this._next,$$,$b,$u,$Z)},$$._canvas_repaint=function($$,$b,$u,$Z){var $E=$$._$P.cacheCanvas,$r=this._next;if($E){var $F,$x,$g,$H,$w=$E.ctx,$I=$$._needRepaint()||!$w,$o=$E.type;if("bitmap"===$o?$A.canvasBitmap++:$A.canvasNormal++,$I){var $N,$D;$E._cacheRec||($E._cacheRec=new $a),$Y.isWebGL&&"bitmap"!==$o?$E._cacheRec.setTo(-$$.pivotX,-$$.pivotY,1,1):(($H=$$.getSelfBounds()).x=$H.x-$$.pivotX,$H.y=$H.y-$$.pivotY,$H.x=$H.x-16,$H.y=$H.y-16,$H.width=$H.width+32,$H.height=$H.height+32,$H.x=Math.floor($H.x+$u)-$u,$H.y=Math.floor($H.y+$Z)-$Z,$H.width=Math.floor($H.width),$H.height=Math.floor($H.height),$E._cacheRec.copyFrom($H)),$H=$E._cacheRec;var $e,$L=$Y.isWebGL?1:$s.pixelRatio*$z.stage.clientScaleX,$T=$Y.isWebGL?1:$s.pixelRatio*$z.stage.clientScaleY;if(!$Y.isWebGL){var $_,$y=1,$S=1;for($_=$$;$_&&$_!=$z.stage;)$y*=$_.scaleX,$S*=$_.scaleY,$_=$_.parent;$Y.isWebGL?($y<1&&($L*=$y),$S<1&&($T*=$S)):(1<$y&&($L*=$y),1<$S&&($T*=$S))}if($$.scrollRect){var $P=$$.scrollRect;$H.x-=$P.x,$H.y-=$P.y}if($N=$H.width*$L,$D=$H.height*$T,$x=$H.x,$g=$H.y,$Y.isWebGL&&"bitmap"===$o&&(2048<$N||2048<$D))return console.warn("cache bitmap size larger than 2048,cache ignored"),$E.ctx&&($G.recover("RenderContext",$E.ctx),$E.ctx.canvas.size(0,0),$E.ctx=null),void $r._fun.call($r,$$,$b,$u,$Z);if($w||($w=$E.ctx=$G.getItem("RenderContext")||new $k($N,$D,$y$.create("AUTO"))),$w.ctx.sprite=$$,($F=$w.canvas).clear(),($F.width!=$N||$F.height!=$D)&&$F.size($N,$D),"bitmap"===$o?$F.context.asBitmap=!0:"normal"===$o&&($F.context.asBitmap=!1),1!=$L||1!=$T){var $i=$w.ctx;$i.save(),$i.scale($L,$T),!$Y.isConchWebGL&&$Y.isConchApp&&($e=$$._$P.cf)&&$i.setFilterMatrix&&$i.setFilterMatrix($e._mat,$e._alpha),$r._fun.call($r,$$,$w,-$x,-$g),$i.restore(),$Y.isConchApp&&!$Y.isConchWebGL||$$._applyFilters()}else $i=$w.ctx,!$Y.isConchWebGL&&$Y.isConchApp&&($e=$$._$P.cf)&&$i.setFilterMatrix&&$i.setFilterMatrix($e._mat,$e._alpha),$r._fun.call($r,$$,$w,-$x,-$g),$Y.isConchApp&&!$Y.isConchWebGL||$$._applyFilters();$$._$P.staticCache&&($E.reCache=!1),$A.canvasReCache++}else $x=($H=$E._cacheRec).x,$g=$H.y,$F=$w.canvas;$b.drawCanvas($F,$u+$x,$Z+$g,$H.width,$H.height)}else $r._fun.call($r,$$,$w,$u,$Z)},$F.__init__=function(){var $$,$b,$u=0;for($b=$O.createRenderSprite(69905,null),$$=$F.renders.length=4096,$u=0;$u<$$;$u++)$F.renders[$u]=$b;$F.renders[0]=$O.createRenderSprite(0,null),function($$,$b){for(var $u=0,$Z=0;$Z<$$.length;$Z++)$u|=$$[$Z],$F.renders[$u]=$b}([1,512,4,2],new $F(1,null)),$F.renders[513]=$O.createRenderSprite(513,null),$F.renders[517]=new $F(517,null)},$F._initRenderFun=function($$,$b,$u,$Z){var $E=$$._renderType;($F.renders[$E]=$F._getTypeRender($E))._fun($$,$b,$u,$Z)},$F._getTypeRender=function($$){for(var $b=null,$u=2048;1<$u;)$u&$$&&($b=$O.createRenderSprite($u,$b)),$u>>=1;return $b},$F.IMAGE=1,$F.ALPHA=2,$F.TRANSFORM=4,$F.BLEND=8,$F.CANVAS=16,$F.FILTERS=32,$F.MASK=64,$F.CLIP=128,$F.STYLE=256,$F.GRAPHICS=512,$F.CUSTOM=1024,$F.CHILDS=2048,$F.INIT=69905,$F.renders=[],$F.NORENDER=new $F(0,null),$F}(),$l=function(){function $x(){this._repaint=!1}$e($x,"laya.resource.Context");var $$=$x.prototype;return $$.replaceReset=function(){var $$,$b,$u=0;for($$=$x.replaceKeys.length,$u=0;$u<$$;$u++)$b=$x.replaceKeys[$u],this[$x.newKeys[$u]]=this[$b]},$$.replaceResotre=function(){this.__restore(),this.__reset()},$$.setIsMainContext=function(){},$$.drawTextures=function($$,$b,$u,$Z){$A.drawCall+=$b.length/2;for(var $E=$$.width,$r=$$.height,$F=0,$x=$b.length;$F<$x;$F+=2)this.drawTexture($$,$b[$F],$b[$F+1],$E,$r,$u,$Z)},$$.drawCanvas=function($$,$b,$u,$Z,$E){$A.drawCall++,this.drawImage($$.source,$b,$u,$Z,$E)},$$.fillRect=function($$,$b,$u,$Z,$E){$A.drawCall++,$E&&(this.fillStyle=$E),this.__fillRect($$,$b,$u,$Z)},$$.fillText=function($$,$b,$u,$Z,$E,$r){$A.drawCall++,3<arguments.length&&null!=$Z&&(this.font=$Z,this.fillStyle=$E,this.textAlign=$r,this.textBaseline="top"),this.__fillText($$,$b,$u)},$$.fillBorderText=function($$,$b,$u,$Z,$E,$r,$F,$x){$A.drawCall++,this.font=$Z,this.fillStyle=$E,this.textBaseline="top",this.strokeStyle=$r,this.lineWidth=$F,this.textAlign=$x,this.__strokeText($$,$b,$u),this.__fillText($$,$b,$u)},$$.strokeText=function($$,$b,$u,$Z,$E,$r,$F){$A.drawCall++,3<arguments.length&&null!=$Z&&(this.font=$Z,this.strokeStyle=$E,this.lineWidth=$r,this.textAlign=$F,this.textBaseline="top"),this.__strokeText($$,$b,$u)},$$.transformByMatrix=function($$){this.transform($$.a,$$.b,$$.c,$$.d,$$.tx,$$.ty)},$$.setTransformByMatrix=function($$){this.setTransform($$.a,$$.b,$$.c,$$.d,$$.tx,$$.ty)},$$.clipRect=function($$,$b,$u,$Z){$A.drawCall++,this.beginPath(),this.rect($$,$b,$u,$Z),this.clip()},$$.drawTexture=function($$,$b,$u,$Z,$E,$r,$F){$A.drawCall++;var $x=$$.uv,$g=$$.bitmap.width,$H=$$.bitmap.height;this.drawImage($$.source,$x[0]*$g,$x[1]*$H,($x[2]-$x[0])*$g,($x[5]-$x[3])*$H,$b+$r,$u+$F,$Z,$E)},$$.drawTextureWithTransform=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){$A.drawCall++;var $H=$$.uv,$w=$$.bitmap.width,$I=$$.bitmap.height;this.save(),1!=$g&&(this.globalAlpha*=$g),$r?(this.transform($r.a,$r.b,$r.c,$r.d,$r.tx+$F,$r.ty+$x),this.drawImage($$.source,$H[0]*$w,$H[1]*$I,($H[2]-$H[0])*$w,($H[5]-$H[3])*$I,$b,$u,$Z,$E)):this.drawImage($$.source,$H[0]*$w,$H[1]*$I,($H[2]-$H[0])*$w,($H[5]-$H[3])*$I,$b+$F,$u+$x,$Z,$E),this.restore()},$$.drawTexture2=function($$,$b,$u,$Z,$E,$r,$F,$x){var $g=$x[0];if($g.loaded&&$g.bitmap&&$g.source){$A.drawCall++;var $H=1!==$r;if($H){var $w=this.globalAlpha;this.globalAlpha*=$r}var $I=$g.uv,$o=$g.bitmap.width,$N=$g.bitmap.height;$E?(this.save(),this.transform($E.a,$E.b,$E.c,$E.d,$E.tx+$$,$E.ty+$b),this.drawImage($g.source,$I[0]*$o,$I[1]*$N,($I[2]-$I[0])*$o,($I[5]-$I[3])*$N,$x[1]-$u,$x[2]-$Z,$x[3],$x[4]),this.restore()):this.drawImage($g.source,$I[0]*$o,$I[1]*$N,($I[2]-$I[0])*$o,($I[5]-$I[3])*$N,$x[1]-$u+$$,$x[2]-$Z+$b,$x[3],$x[4]),$H&&(this.globalAlpha=$w)}},$$.fillTexture=function($$,$b,$u,$Z,$E,$r,$F,$x){if(!$x.pat){if($$.uv!=$w$.DEF_UV){var $g=new $y$("2D");$g.getContext("2d"),$g.size($$.width,$$.height),$g.context.drawTexture($$,0,0,$$.width,$$.height,0,0),$$=new $w$($g)}$x.pat=this.createPattern($$.bitmap.source,$r)}var $H=$b,$w=$u,$I=0,$o=0;$F&&($H+=$F.x%$$.width,$w+=$F.y%$$.height,$I-=$F.x%$$.width,$o-=$F.y%$$.height),this.translate($H,$w),this.fillRect($I,$o,$Z,$E,$x.pat),this.translate(-$H,-$w)},$$.drawTriangle=function($$,$b,$u,$Z,$E,$r,$F,$x){var $g=$$.bitmap,$H=$g.source,$w=$$.width,$I=$$.height,$o=$g.width,$N=$g.height,$D=$u[$Z]*$o,$e=$u[$E]*$o,$L=$u[$r]*$o,$T=$u[$Z+1]*$N,$_=$u[$E+1]*$N,$y=$u[$r+1]*$N,$S=$b[$Z],$P=$b[$E],$i=$b[$r],$z=$b[$Z+1],$q=$b[$E+1],$a=$b[$r+1];if($x){var $t=($S+$P+$i)/3,$C=($z+$q+$a)/3,$K=$S-$t,$O=$z-$C,$V=Math.sqrt($K*$K+$O*$O);$S=$t+$K/$V*($V+1),$z=$C+$O/$V*($V+1),$O=$q-$C,$P=$t+($K=$P-$t)/($V=Math.sqrt($K*$K+$O*$O))*($V+1),$q=$C+$O/$V*($V+1),$O=$a-$C,$i=$t+($K=$i-$t)/($V=Math.sqrt($K*$K+$O*$O))*($V+1),$a=$C+$O/$V*($V+1)}this.save(),$F&&this.transform($F.a,$F.b,$F.c,$F.d,$F.tx,$F.ty),this.beginPath(),this.moveTo($S,$z),this.lineTo($P,$q),this.lineTo($i,$a),this.closePath(),this.clip();var $v=1/($D*$_+$T*$L+$e*$y-$_*$L-$T*$e-$D*$y),$p=$S*$_+$T*$i+$P*$y-$_*$i-$T*$P-$S*$y,$Y=$D*$P+$S*$L+$e*$i-$P*$L-$S*$e-$D*$i,$k=$D*$_*$i+$T*$P*$L+$S*$e*$y-$S*$_*$L-$T*$e*$i-$D*$P*$y,$M=$z*$_+$T*$a+$q*$y-$_*$a-$T*$q-$z*$y,$l=$D*$q+$z*$L+$e*$a-$q*$L-$z*$e-$D*$a,$X=$D*$_*$a+$T*$q*$L+$z*$e*$y-$z*$_*$L-$T*$e*$a-$D*$q*$y;this.transform($p*$v,$M*$v,$Y*$v,$l*$v,$k*$v,$X*$v),this.drawImage($H,$$.uv[0]*$o,$$.uv[1]*$N,$w,$I,$$.uv[0]*$o,$$.uv[1]*$N,$w,$I),this.restore()},$$.flush=function(){return 0},$$.fillWords=function($$,$b,$u,$Z,$E,$r){$Z&&(this.font=$Z),$E&&(this.fillStyle=$E);this.textBaseline="top",this.textAlign="left";for(var $F=0,$x=$$.length;$F<$x;$F++){var $g=$$[$F];if(this.__fillText($g.char,$g.x+$b,$g.y+$u),1===$r){var $H=$g.height,$w=.5*$g.style.letterSpacing;$w||($w=0),this.beginPath(),this.strokeStyle=$E,this.lineWidth=1,this.moveTo($b+$g.x-$w+.5,$u+$g.y+$H+.5),this.lineTo($b+$g.x+$g.width+$w+.5,$u+$g.y+$H+.5),this.stroke()}}},$$.fillBorderWords=function($$,$b,$u,$Z,$E,$r,$F){$Z&&(this.font=$Z),$E&&(this.fillStyle=$E),this.textBaseline="top",this.lineWidth=$F,this.textAlign="left",this.strokeStyle=$r;for(var $x=0,$g=$$.length;$x<$g;$x++){var $H=$$[$x];this.__strokeText($H.char,$H.x+$b,$H.y+$u),this.__fillText($H.char,$H.x+$b,$H.y+$u)}},$$.destroy=function(){this.canvas.width=this.canvas.height=0},$$.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$$.drawCurves=function($$,$b,$u){this.beginPath(),this.strokeStyle=$u[3],this.lineWidth=$u[4];var $Z=$u[2];$$+=$u[0],$b+=$u[1],this.moveTo($$+$Z[0],$b+$Z[1]);for(var $E=2,$r=$Z.length;$E<$r;)this.quadraticCurveTo($$+$Z[$E++],$b+$Z[$E++],$$+$Z[$E++],$b+$Z[$E++]);this.stroke()},$x.__init__=function($b){var $u=laya.resource.Context.prototype;if(!($b=$b||CanvasRenderingContext2D.prototype).inited){$b.inited=!0,$b.__fillText=$b.fillText,$b.__fillRect=$b.fillRect,$b.__strokeText=$b.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($$){$b[$$]=$u[$$]})}},$x.replaceCanvasGetSet=function($$,$b){var $u=Object.getOwnPropertyDescriptor($$,$b);if(!$u||!$u.configurable)return!1;var $Z,$E={};for($Z in $u)"set"!=$Z&&($E[$Z]=$u[$Z]);var $r=$u.set;return $E.set=function($$){$r.call(this,$$);var $b=this.getContext("2d");$b&&"__reset"in $b&&$b.__reset()},Object.defineProperty($$,$b,$E),!0},$x.replaceGetSet=function($$,$b){var $u=Object.getOwnPropertyDescriptor($$,$b);if(!$u||!$u.configurable)return!1;var $Z,$E={};for($Z in $u)"set"!=$Z&&($E[$Z]=$u[$Z]);var $r=$u.set,$F="___"+$b+"__";return $x.newKeys.push($F),$E.set=function($$){$$!=this[$F]&&(this[$F]=$$,$r.call(this,$$))},Object.defineProperty($$,$b,$E),!0},$x._default=new $x,$x.newKeys=[],$g($x,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$x}(),$X=function(){function $r($$){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$r._uniqueIDCounter,this._name=$$||"Content Manager",$r._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$r._resourceManagers.push(this),this._resources=[],this._records={}}$e($r,"laya.resource.ResourceManager");var $$=$r.prototype;return $z.imps($$,{"laya.resource.IDispose":!0}),$$.getResourceByIndex=function($$){return this._resources[$$]},$$.getResourcesLength=function(){return this._resources.length},$$.addResource=function($$){return $$.resourceManager&&$$.resourceManager.removeResource($$),-1===this._resources.indexOf($$)&&(($$._resourceManager=this)._resources.push($$),this.addRecord($$.uri,$$.__className,$$.memorySize),this.addSize($$.memorySize),!0)},$$.removeResource=function($$){var $b=this._resources.indexOf($$);return-1!==$b&&(this._resources.splice($b,1),$$._resourceManager=null,this._memorySize-=$$.memorySize,this.addRecord($$.uri,$$.__className,-$$.memorySize),!0)},$$.unload=function(){for(var $$=this._resources.slice(0,this._resources.length),$b=0;$b<$$.length;$b++){$$[$b].destroy()}$$.length=0},$$.dispose=function(){if(this===$r._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$r._resourceManagers.splice($r._resourceManagers.indexOf(this),1),$r._isResourceManagersSorted=!1;for(var $$=this._resources.slice(0,this._resources.length),$b=0;$b<$$.length;$b++){var $u=$$[$b];$u.resourceManager.removeResource($u),$u.destroy()}$$.length=0},$$.addSize=function($$){$$&&(this.autoRelease&&0<$$&&this._memorySize+$$>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$$)},$$.addRecord=function($$,$b,$u){DEBUG&&$u&&!$$&&console.error($$,$b,$u)},$$.garbageCollection=function($$){var $b=this._resources;($b=$b.slice()).sort(function($$,$b){if(!$$||!$b)throw new Error("a或b不能为空！");return $$.released&&$b.released?0:$$.released?1:$b.released?-1:$$._lastUseFrameCount-$b._lastUseFrameCount});for(var $u=$A.loopCount,$Z=0,$E=$b.length;$Z<$E;$Z++){var $r=$b[$Z];if(!(1<$u-$r._lastUseFrameCount))return void(this._memorySize>=$$&&(this._isOverflow=!0));if($r.releaseResource(),this._memorySize<$$)return void(this._isOverflow=!1)}},$w(0,$$,"id",function(){return this._id}),$w(0,$$,"name",function(){return this._name},function($$){!$$&&""===$$||this._name===$$||(this._name=$$,$r._isResourceManagersSorted=!1)}),$w(0,$$,"memorySize",function(){return this._memorySize}),$w(0,$$,"records",function(){return this._records}),$w(1,$r,"systemResourceManager",function(){return $r._systemResourceManager}),$r.__init__=function(){$r.currentResourceManager=$r.systemResourceManager},$r.getLoadedResourceManagerByIndex=function($$){return $r._resourceManagers[$$]},$r.getLoadedResourceManagersCount=function(){return $r._resourceManagers.length},$r.recreateContentManagers=function($$){void 0===$$&&($$=!1);for(var $b=$r.currentResourceManager,$u=0;$u<$r._resourceManagers.length;$u++){$r.currentResourceManager=$r._resourceManagers[$u];for(var $Z=0;$Z<$r.currentResourceManager._resources.length;$Z++)$r.currentResourceManager._resources[$Z].releaseResource($$),$r.currentResourceManager._resources[$Z].activeResource($$)}$r.currentResourceManager=$b},$r.releaseContentManagers=function($$){void 0===$$&&($$=!1);for(var $b=$r.currentResourceManager,$u=0;$u<$r._resourceManagers.length;$u++){$r.currentResourceManager=$r._resourceManagers[$u];for(var $Z=0;$Z<$r.currentResourceManager._resources.length;$Z++){var $E=$r.currentResourceManager._resources[$Z];!$E.released&&$E.releaseResource($$)}}$r.currentResourceManager=$b},$r._uniqueIDCounter=0,$r._isResourceManagersSorted=!1,$r._resourceManagers=[],$g($r,["_systemResourceManager",function(){return this._systemResourceManager=new $r("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$r._systemResourceManager}]),$r}(),$s=(function(){function $$(){}$e($$,"laya.system.System"),$$.changeDefinition=function($$,$b){$z[$$]=$b;var $u=$$+"=classObj";$z._runScript($u)},$$.__init__=function(){$Y.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $u(){}return $e($u,"laya.utils.Browser"),$w(1,$u,"pixelRatio",function(){return $u.__init__(),-1<$u.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$O.getPixelRatio()}),$w(1,$u,"height",function(){return $u.__init__(),($z.stage&&$z.stage.canvasRotation?$u.clientWidth:$u.clientHeight)*$u.pixelRatio}),$w(1,$u,"clientWidth",function(){return $u.__init__(),$u.window.innerWidth||$u.document.body.clientWidth}),$w(1,$u,"window",function(){return $u.__init__(),$u._window}),$w(1,$u,"clientHeight",function(){return $u.__init__(),$u.window.innerHeight||$u.document.body.clientHeight||$u.document.documentElement.clientHeight}),$w(1,$u,"width",function(){return $u.__init__(),($z.stage&&$z.stage.canvasRotation?$u.clientHeight:$u.clientWidth)*$u.pixelRatio}),$w(1,$u,"container",function(){return $u.__init__(),$u._container||(($u._container=$u.createElement("div")).id="layaContainer",$u.document.body.appendChild($u._container)),$u._container},function($$){$u._container=$$}),$w(1,$u,"document",function(){return $u.__init__(),$u._document}),$u.__init__=function(){if(!$u._window){$u._window=$O.getWindow(),$u._document=$u.window.document,$u._window.addEventListener("message",function($$){laya.utils.Browser._onMessage($$)},!1),$u.document.__createElement=$u.document.createElement,$F.requestAnimationFrame=$F.requestAnimationFrame||$F.webkitRequestAnimationFrame||$F.mozRequestAnimationFrame||$F.oRequestAnimationFrame||$F.msRequestAnimationFrame||function($$){return $F.setTimeout($$,1e3/60)};var $$=$F.document.body.style;$$["-webkit-user-select"]="none",$$["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$u.userAgent=$u.window.navigator.userAgent,$u.onIOS=!!($u.u=$u.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$u.onMobile=-1<$u.u.indexOf("Mobile"),$u.onIPhone=-1<$u.u.indexOf("iPhone"),$u.onMac=-1<$u.u.indexOf("Mac OS X"),$u.onIPad=-1<$u.u.indexOf("iPad"),$u.onAndroid=-1<$u.u.indexOf("Android")||-1<$u.u.indexOf("Adr"),$u.onWP=-1<$u.u.indexOf("Windows Phone"),$u.onQQBrowser=-1<$u.u.indexOf("QQBrowser"),$u.onMQQBrowser=-1<$u.u.indexOf("MQQBrowser")||-1<$u.u.indexOf("Mobile")&&-1<$u.u.indexOf("QQ"),$u.onIE=!!$u.window.ActiveXObject||"ActiveXObject"in $u.window,$u.onWeiXin=-1<$u.u.indexOf("MicroMessenger"),$u.onPC=!$u.onMobile,$u.onSafari=-1<$u.u.indexOf("Safari"),$u.onFirefox=-1<$u.u.indexOf("Firefox"),$u.onEdge=-1<$u.u.indexOf("Edge"),$u.onMiniGame=-1<$u.u.indexOf("MiniGame"),$u.onLimixiu=-1<$u.u.indexOf("limixiu"),$u.httpProtocol="http:"==$u.window.location.protocol,$u.onMiniGame&&null==$u.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$u.webAudioEnabled=!!($u.window.AudioContext||$u.window.webkitAudioContext||$u.window.mozAudioContext),$u.soundType=$u.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$E$=$u.webAudioEnabled?$r$:$u$,$u.webAudioEnabled&&$r$.initWebAudio(),$u$._initMusicAudio(),$u.enableTouch="ontouchstart"in $F||$F.DocumentTouch&&$b instanceof DocumentTouch,$F.focus(),$K._soundClass=$E$,$K._musicClass=$u$,$Y._mainCanvas=$Y._mainCanvas||$y$.create("2D"),$u.canvas||($u.canvas=$y$.create("2D"),$u.context=$u.canvas.getContext("2d"))}},$u._onMessage=function($$){if($$.data&&"size"==$$.data.name){if($u.window.innerWidth=$$.data.width,$u.window.innerHeight=$$.data.height,$u.window.__innerHeight=$$.data.clientHeight,!$u.document.createEvent)return void console.warn("no document.createEvent");var $b=$u.document.createEvent("HTMLEvents");return $b.initEvent("resize",!1,!1),void $u.window.dispatchEvent($b)}},$u.createElement=function($$){return $u.__init__(),$u.document.__createElement($$)},$u.getElementById=function($$){return $u.__init__(),$u.document.getElementById($$)},$u.removeElement=function($$){$$&&$$.parentNode&&$$.parentNode.removeChild($$)},$u.now=function(){return $O.now()},$u._window=null,$u._document=null,$u._container=null,$u.userAgent=null,$u.u=null,$u.onIOS=!1,$u.onMac=!1,$u.onMobile=!1,$u.onIPhone=!1,$u.onIPad=!1,$u.onAndroid=!1,$u.onWP=!1,$u.onQQBrowser=!1,$u.onMQQBrowser=!1,$u.onSafari=!1,$u.onFirefox=!1,$u.onEdge=!1,$u.onIE=!1,$u.onWeiXin=!1,$u.onMiniGame=!1,$u.onLimixiu=!1,$u.onPC=!1,$u.httpProtocol=!1,$u.webAudioEnabled=!1,$u.soundType=null,$u.enableTouch=!1,$u.canvas=null,$u.context=null,$u.__init$=function(){},$u}()),$m=function(){function $b($$){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$$?(this._u8d_=new Uint8Array($$),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$e($b,"laya.utils.Byte");var $$=$b.prototype;return $$.___resizeBuffer=function($b){try{var $$=new Uint8Array($b);null!=this._u8d_&&(this._u8d_.length<=$b?$$.set(this._u8d_):$$.set(this._u8d_.subarray(0,$b))),this._u8d_=$$,this._d_=new DataView($$.buffer)}catch($$){throw"___resizeBuffer err:"+$b}},$$.getString=function(){return this.rUTF(this.getUint16())},$$.getFloat32Array=function($$,$b){var $u=$$+$b;$u=$u>this._length?this._length:$u;var $Z=new Float32Array(this._d_.buffer.slice($$,$u));return this._pos_=$u,$Z},$$.getUint8Array=function($$,$b){var $u=$$+$b;$u=$u>this._length?this._length:$u;var $Z=new Uint8Array(this._d_.buffer.slice($$,$u));return this._pos_=$u,$Z},$$.getInt16Array=function($$,$b){var $u=$$+$b;$u=$u>this._length?this._length:$u;var $Z=new Int16Array(this._d_.buffer.slice($$,$u));return this._pos_=$u,$Z},$$.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $$=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$$},$$.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $$=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$$},$$.writeFloat32=function($$){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$$,this._xd_),this._pos_+=4},$$.writeFloat64=function($$){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$$,this._xd_),this._pos_+=8},$$.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $$=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$$},$$.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $$=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$$},$$.writeInt32=function($$){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$$,this._xd_),this._pos_+=4},$$.writeUint32=function($$){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$$,this._xd_),this._pos_+=4},$$.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $$=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$$},$$.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $$=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$$},$$.writeUint16=function($$){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$$,this._xd_),this._pos_+=2},$$.writeInt16=function($$){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$$,this._xd_),this._pos_+=2},$$.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$$.writeUint8=function($$){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$$),this._pos_++},$$._getUInt8=function($$){return this._d_.getUint8($$)},$$._getUint16=function($$){return this._d_.getUint16($$,this._xd_)},$$._getMatrix=function(){return new $V(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$$.rUTF=function($$){for(var $b=[],$u=this._pos_+$$,$Z=0,$E=0,$r=0,$F=String.fromCharCode,$x=this._u8d_;this._pos_<$u;)($Z=$x[this._pos_++])<128?0!=$Z&&$b.push($F($Z)):$Z<224?$b.push($F((63&$Z)<<6|127&$x[this._pos_++])):$Z<240?($E=$x[this._pos_++],$b.push($F((31&$Z)<<12|(127&$E)<<6|127&$x[this._pos_++]))):($E=$x[this._pos_++],$r=$x[this._pos_++],$b.push($F((15&$Z)<<18|(127&$E)<<12|$r<<6&127|127&$x[this._pos_++]))),0;return $b.join("")},$$.getCustomString=function($$){for(var $b=[],$u=0,$Z=0,$E=0,$r=String.fromCharCode,$F=this._u8d_;0<$$;)if(($Z=$F[this._pos_])<128)$b.push($r($Z)),this._pos_++,$$--;else for($u=$Z-128,this._pos_++,$$-=$u;0<$u;)$Z=$F[this._pos_++],$E=$F[this._pos_++],$b.push($r($E<<8|$Z)),$u--;return $b.join("")},$$.clear=function(){this._pos_=0,this.length=0},$$.__getBuffer=function(){return this._d_.buffer},$$.writeUTFBytes=function($$){for(var $b=0,$u=($$+="").length;$b<$u;$b++){var $Z=$$.charCodeAt($b);$Z<=127?this.writeByte($Z):$Z<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$Z>>6,128|63&$Z],this._pos_),this._pos_+=2):$Z<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$Z>>12,128|$Z>>6&63,128|63&$Z],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$Z>>18,128|$Z>>12&63,128|$Z>>6&63,128|63&$Z],this._pos_),this._pos_+=4)}},$$.writeUTFString=function($$){var $b=this.pos;this.writeUint16(1),this.writeUTFBytes($$);var $u=this.pos-$b-2;if(65536<=$u)throw"writeUTFString byte len more than 65536";this._d_.setUint16($b,$u,this._xd_)},$$.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$$.getUTFString=function(){return this.readUTFString()},$$.readUTFBytes=function($$){if(void 0===$$&&($$=-1),0==$$)return"";var $b=this.bytesAvailable;if($b<$$)throw"readUTFBytes error - Out of bounds";return $$=0<$$?$$:$b,this.rUTF($$)},$$.getUTFBytes=function($$){return void 0===$$&&($$=-1),this.readUTFBytes($$)},$$.writeByte=function($$){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$$),this._pos_+=1},$$.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$$.getByte=function(){return this.readByte()},$$.ensureWrite=function($$){this._length<$$&&(this._length=$$),this._allocated_<$$&&(this.length=$$)},$$.writeArrayBuffer=function($$,$b,$u){if(void 0===$b&&($b=0),void 0===$u&&($u=0),$b<0||$u<0)throw"writeArrayBuffer error - Out of bounds";0==$u&&($u=$$.byteLength-$b),this.ensureWrite(this._pos_+$u);var $Z=new Uint8Array($$);this._u8d_.set($Z.subarray($b,$b+$u),this._pos_),this._pos_+=$u},$w(0,$$,"buffer",function(){var $$=this._d_.buffer;return $$.byteLength==this.length?$$:$$.slice(0,this.length)}),$w(0,$$,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($$){this._xd_="littleEndian"==$$}),$w(0,$$,"length",function(){return this._length},function($$){this._allocated_<$$?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($$,2*this._allocated_))):this._allocated_>$$&&this.___resizeBuffer(this._allocated_=$$),this._length=$$}),$w(0,$$,"pos",function(){return this._pos_},function($$){this._pos_=$$}),$w(0,$$,"bytesAvailable",function(){return this._length-this._pos_}),$b.getSystemEndian=function(){if(!$b._sysEndian){var $$=new ArrayBuffer(2);new DataView($$).setInt16(0,256,!0),$b._sysEndian=256===new Int16Array($$)[0]?"littleEndian":"bigEndian"}return $b._sysEndian},$b.BIG_ENDIAN="bigEndian",$b.LITTLE_ENDIAN="littleEndian",$b._sysEndian=null,$b}(),$n=function(){function $E(){}return $e($E,"laya.utils.CacheManager"),$E.regCacheByFunction=function($$,$b){var $u;$E.unRegCacheByFunction($$,$b),$u={tryDispose:$$,getCacheList:$b},$E._cacheList.push($u)},$E.unRegCacheByFunction=function($$,$b){var $u,$Z=0;for($u=$E._cacheList.length,$Z=0;$Z<$u;$Z++)if($E._cacheList[$Z].tryDispose==$$&&$E._cacheList[$Z].getCacheList==$b)return void $E._cacheList.splice($Z,1)},$E.forceDispose=function(){var $$=0,$b=$E._cacheList.length;for($$=0;$$<$b;$$++)$E._cacheList[$$].tryDispose(!0)},$E.beginCheck=function($$){void 0===$$&&($$=15e3),$z.timer.loop($$,null,$E._checkLoop)},$E.stopCheck=function(){$z.timer.clear(null,$E._checkLoop)},$E._checkLoop=function(){var $$=$E._cacheList;if(!($$.length<1)){var $b,$u=$s.now(),$Z=0;for($b=$Z=$$.length;0<$Z&&($$[$E._index=++$E._index%$b].tryDispose(!1),!($s.now()-$u>$E.loopTimeLimit));)$Z--}},$E.loopTimeLimit=2,$E._cacheList=[],$E._index=0,$E}(),$c=function(){function $N(){}return $e($N,"laya.utils.ClassUtils"),$N.regClass=function($$,$b){$N._classMap[$$]=$b},$N.getRegClass=function($$){return $N._classMap[$$]},$N.getInstance=function($$){var $b=$N.getClass($$);return $b?new $b:(console.warn("[error] Undefined class:",$$),null)},$N.createByJson=function($$,$b,$u,$Z,$E){"string"==typeof $$&&($$=JSON.parse($$));var $r=$$.props;if(!$b&&!($b=$E?$E.runWith($$):$N.getInstance($r.runtime||$$.type)))return null;var $F=$$.child;if($F)for(var $x=0,$g=$F.length;$x<$g;$x++){var $H=$F[$x];if("render"!==$H.props.name&&"render"!==$H.props.renderType||!$b._$set_itemRender)if("Graphic"==$H.type)$N.addGraphicsToSprite($H,$b);else if($N.isDrawType($H.type))$N.addGraphicToSprite($H,$b,!0);else{var $w=$N.createByJson($H,null,$u,$Z,$E);"Script"==$H.type?$w.hasOwnProperty("owner")?$w.owner=$b:$w.hasOwnProperty("target")&&($w.target=$b):"mask"==$H.props.renderType?$b.mask=$w:$b.addChild($w)}else $b.itemRender=$H}if($r)for(var $I in $r){var $o=$r[$I];"var"===$I&&$u?$u[$o]=$b:$o instanceof Array&&"function"==typeof $b[$I]?$b[$I].apply($b,$o):$b[$I]=$o}return $Z&&$$.customProps&&$Z.runWith([$b,$$]),$b.created&&$b.created(),$b},$N.addGraphicsToSprite=function($$,$b){var $u;if(($u=$$.child)&&!($u.length<1)){var $Z;$Z=$N._getGraphicsFromSprite($$,$b);var $E=0,$r=0;$$.props&&($E=$N._getObjVar($$.props,"x",0),$r=$N._getObjVar($$.props,"y",0)),0!=$E&&0!=$r&&$Z.translate($E,$r);var $F,$x=0;for($F=$u.length,$x=0;$x<$F;$x++)$N._addGraphicToGraphics($u[$x],$Z);0!=$E&&0!=$r&&$Z.translate(-$E,-$r)}},$N.addGraphicToSprite=function($$,$b,$u){var $Z;void 0===$u&&($u=!1),$Z=$u?$N._getGraphicsFromSprite($$,$b):$b.graphics,$N._addGraphicToGraphics($$,$Z)},$N._getGraphicsFromSprite=function($$,$b){var $u,$Z;if(!$$||!$$.props)return $b.graphics;switch($Z=$$.props.renderType){case"hit":case"unHit":var $E;$b.hitArea||($b.hitArea=new $W),($E=$b.hitArea)[$Z]||($E[$Z]=new $o),$u=$E[$Z]}return $u||($u=$b.graphics),$u},$N._getTransformData=function($$){var $b;($$.hasOwnProperty("pivotX")||$$.hasOwnProperty("pivotY"))&&($b=$b||new $V).translate(-$N._getObjVar($$,"pivotX",0),-$N._getObjVar($$,"pivotY",0));var $u=$N._getObjVar($$,"scaleX",1),$Z=$N._getObjVar($$,"scaleY",1),$E=$N._getObjVar($$,"rotation",0);$N._getObjVar($$,"skewX",0),$N._getObjVar($$,"skewY",0);return 1==$u&&1==$Z&&0==$E||(($b=$b||new $V).scale($u,$Z),$b.rotate(.0174532922222222*$E)),$b},$N._addGraphicToGraphics=function($$,$b){var $u,$Z;if(($u=$$.props)&&($Z=$N.DrawTypeDic[$$.type])){var $E,$r;$E=$b;var $F=$N._getParams($u,$Z[1],$Z[2],$Z[3]);(($r=$N._tM)||1!=$N._alpha)&&($E.save(),$r&&$E.transform($r),1!=$N._alpha&&$E.alpha($N._alpha)),$E[$Z[0]].apply($E,$F),($r||1!=$N._alpha)&&$E.restore()}},$N._adptLineData=function($$){return $$[2]=parseFloat($$[0])+parseFloat($$[2]),$$[3]=parseFloat($$[1])+parseFloat($$[3]),$$},$N._adptTextureData=function($$){return $$[0]=$x$.getRes($$[0]),$$},$N._adptLinesData=function($$){return $$[2]=$N._getPointListByStr($$[2]),$$},$N.isDrawType=function($$){return"Image"!=$$&&$N.DrawTypeDic.hasOwnProperty($$)},$N._getParams=function($$,$b,$u,$Z){var $E;void 0===$u&&($u=0),($E=$N._temParam).length=$b.length;var $r,$F,$x=0;for($r=$b.length,$x=0;$x<$r;$x++)$E[$x]=$N._getObjVar($$,$b[$x][0],$b[$x][1]);return $N._alpha=$N._getObjVar($$,"alpha",1),$F=$N._getTransformData($$),$N._tM=$F?($u||($u=0),$F.translate($E[$u],$E[$u+1]),$E[$u]=$E[$u+1]=0,$F):null,$Z&&$N[$Z]&&($E=$N[$Z]($E)),$E},$N._getPointListByStr=function($$){var $b,$u,$Z=0;for($u=($b=$$.split(",")).length,$Z=0;$Z<$u;$Z++)$b[$Z]=parseFloat($b[$Z]);return $b},$N._getObjVar=function($$,$b,$u){return $$.hasOwnProperty($b)?$$[$b]:$u},$N._temParam=[],$N._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$N.getClass=function($$){var $b=$N._classMap[$$]||$$;return"string"==typeof $b?$z.__classmap[$b]:$b},$N._tM=null,$N._alpha=NaN,$g($N,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$N}(),$J=function(){function $r($$){if(this._color=[],"string"==typeof $$){null===(this.strColor=$$)&&($$="#000000"),"#"==$$.charAt(0)&&($$=$$.substr(1));var $b=$$.length;if(3==$b||4==$b){for(var $u="",$Z=0;$Z<$b;$Z++)$u+=$$[$Z]+$$[$Z];$$=$u}var $E=this.numColor=parseInt($$,16);if(8==$$.length)return void(this._color=[parseInt($$.substr(0,2),16)/255,((16711680&$E)>>16)/255,((65280&$E)>>8)/255,(255&$E)/255])}else $E=this.numColor=$$,this.strColor=$d.toHexColor($E);this._color=[((16711680&$E)>>16)/255,((65280&$E)>>8)/255,(255&$E)/255,1],this._color.__id=++$r._COLODID}return $e($r,"laya.utils.Color"),$r._initDefault=function(){for(var $$ in $r._DEFAULT={},$r._COLOR_MAP)$r._SAVE[$$]=$r._DEFAULT[$$]=new $r($r._COLOR_MAP[$$]);return $r._DEFAULT},$r._initSaveMap=function(){for(var $$ in $r._SAVE_SIZE=0,$r._SAVE={},$r._DEFAULT)$r._SAVE[$$]=$r._DEFAULT[$$]},$r.create=function($$){var $b=$r._SAVE[$$+""];return null!=$b?$b:($r._SAVE_SIZE<1e3||$r._initSaveMap(),$r._SAVE[$$+""]=new $r($$))},$r._SAVE={},$r._SAVE_SIZE=0,$r._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$r._DEFAULT=$r._initDefault(),$r._COLODID=1,$r}(),$f=(function(){function $$(){this._values=[],this._keys=[]}$e($$,"laya.utils.Dictionary");var $b=$$.prototype;$b.set=function($$,$b){var $u=this.indexOf($$);0<=$u?this._values[$u]=$b:(this._keys.push($$),this._values.push($b))},$b.indexOf=function($$){var $b=this._keys.indexOf($$);return 0<=$b?$b:($$="string"==typeof $$?Number($$):"number"==typeof $$?$$.toString():$$,this._keys.indexOf($$))},$b.get=function($$){var $b=this.indexOf($$);return $b<0?null:this._values[$b]},$b.remove=function($$){var $b=this.indexOf($$);return 0<=$b&&(this._keys.splice($b,1),this._values.splice($b,1),!0)},$b.clear=function(){this._values.length=0,this._keys.length=0},$w(0,$b,"values",function(){return this._values}),$w(0,$b,"keys",function(){return this._keys})}(),function(){function $$(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$e($$,"laya.utils.Dragging");var $b=$$.prototype;return $b.start=function($$,$b,$u,$Z,$E,$r,$F,$x){void 0===$x&&($x=.92),this.clearTimer(),this.target=$$,this.area=$b,this.hasInertia=$u,this.elasticDistance=$b?$Z:0,this.elasticBackTime=$E,this.data=$r,this._disableMouseEvent=$F,this.ratio=$x,1!=$$.globalScaleX||1!=$$.globalScaleY?this._parent=$$.parent:this._parent=$z.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$z.stage.on("mouseup",this,this.onStageMouseUp),$z.stage.on("mouseout",this,this.onStageMouseUp),$z.timer.frameLoop(1,this,this.loop)},$b.clearTimer=function(){$z.timer.clear(this,this.loop),$z.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$b.stop=function(){this._dragging&&($D.instance.disableMouseEvent=!1,$z.stage.off("mouseup",this,this.onStageMouseUp),$z.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$b.loop=function(){var $$=this._parent.getMousePoint(),$b=$$.x,$u=$$.y,$Z=$b-this._lastX,$E=$u-this._lastY;if(this._clickOnly){if(!(1<Math.abs($Z*$z.stage._canvasTransform.getScaleX())||1<Math.abs($E*$z.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$D.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($Z,$E);0==$Z&&0==$E||(this._lastX=$b,this._lastY=$u,this.target.x+=$Z*this._elasticRateX,this.target.y+=$E*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$b.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $$=this.area.x-this.target.x;else $$=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$$/this.elasticDistance),this.target.y<this.area.y)var $b=this.area.y-this.target.y;else $b=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$b/this.elasticDistance)}},$b.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$b.onStageMouseUp=function($$){if($D.instance.disableMouseEvent=!1,$z.stage.off("mouseup",this,this.onStageMouseUp),$z.stage.off("mouseout",this,this.onStageMouseUp),$z.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $b=this._offsets.length,$u=Math.min($b,6),$Z=this._offsets.length-$u,$E=$b-1;$Z<$E;$E--)this._offsetY+=this._offsets[$E--],this._offsetX+=this._offsets[$E];this._offsetX=this._offsetX/$u*2,this._offsetY=this._offsetY/$u*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$z.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$b.checkElastic=function(){var $$=NaN,$b=NaN;if(this.target.x<this.area.x?$$=this.area.x:this.target.x>this.area.x+this.area.width&&($$=this.area.x+this.area.width),this.target.y<this.area.y?$b=this.area.y:this.target.y>this.area.y+this.area.height&&($b=this.area.y+this.area.height),isNaN($$)&&isNaN($b))this.clear();else{var $u={};isNaN($$)||($u.x=$$),isNaN($b)||($u.y=$b),this._tween=$h.to(this.target,$u,this.elasticBackTime,$Q.sineOut,$_.create(this,this.clear),0,!1,!1)}},$b.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($z.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$b.clear=function(){if(this.target){this.clearTimer();var $$=this.target;this.target=null,this._parent=null,$$.event("dragend",this.data)}},$$}()),$Q=function(){function $x(){}return $e($x,"laya.utils.Ease"),$x.linearNone=function($$,$b,$u,$Z){return $u*$$/$Z+$b},$x.linearIn=function($$,$b,$u,$Z){return $u*$$/$Z+$b},$x.linearInOut=function($$,$b,$u,$Z){return $u*$$/$Z+$b},$x.linearOut=function($$,$b,$u,$Z){return $u*$$/$Z+$b},$x.bounceIn=function($$,$b,$u,$Z){return $u-$x.bounceOut($Z-$$,0,$u,$Z)+$b},$x.bounceInOut=function($$,$b,$u,$Z){return $$<.5*$Z?.5*$x.bounceIn(2*$$,0,$u,$Z)+$b:.5*$x.bounceOut(2*$$-$Z,0,$u,$Z)+.5*$u+$b},$x.bounceOut=function($$,$b,$u,$Z){return($$/=$Z)<1/2.75?$u*(7.5625*$$*$$)+$b:$$<2/2.75?$u*(7.5625*($$-=1.5/2.75)*$$+.75)+$b:$$<2.5/2.75?$u*(7.5625*($$-=2.25/2.75)*$$+.9375)+$b:$u*(7.5625*($$-=2.625/2.75)*$$+.984375)+$b},$x.backIn=function($$,$b,$u,$Z,$E){return void 0===$E&&($E=1.70158),$u*($$/=$Z)*$$*(($E+1)*$$-$E)+$b},$x.backInOut=function($$,$b,$u,$Z,$E){return void 0===$E&&($E=1.70158),($$/=.5*$Z)<1?.5*$u*($$*$$*((1+($E*=1.525))*$$-$E))+$b:$u/2*(($$-=2)*$$*((1+($E*=1.525))*$$+$E)+2)+$b},$x.backOut=function($$,$b,$u,$Z,$E){return void 0===$E&&($E=1.70158),$u*(($$=$$/$Z-1)*$$*(($E+1)*$$+$E)+1)+$b},$x.elasticIn=function($$,$b,$u,$Z,$E,$r){var $F;return void 0===$E&&($E=0),void 0===$r&&($r=0),0==$$?$b:1==($$/=$Z)?$b+$u:($r||($r=.3*$Z),$F=!$E||0<$u&&$E<$u||$u<0&&$E<-$u?($E=$u,$r/4):$r/$x.PI2*Math.asin($u/$E),-$E*Math.pow(2,10*($$-=1))*Math.sin(($$*$Z-$F)*$x.PI2/$r)+$b)},$x.elasticInOut=function($$,$b,$u,$Z,$E,$r){var $F;return void 0===$E&&($E=0),void 0===$r&&($r=0),0==$$?$b:2==($$/=.5*$Z)?$b+$u:($r||($r=$Z*(.3*1.5)),$F=!$E||0<$u&&$E<$u||$u<0&&$E<-$u?($E=$u,$r/4):$r/$x.PI2*Math.asin($u/$E),$$<1?$E*Math.pow(2,10*($$-=1))*Math.sin(($$*$Z-$F)*$x.PI2/$r)*-.5+$b:$E*Math.pow(2,-10*($$-=1))*Math.sin(($$*$Z-$F)*$x.PI2/$r)*.5+$u+$b)},$x.elasticOut=function($$,$b,$u,$Z,$E,$r){var $F;return void 0===$E&&($E=0),void 0===$r&&($r=0),0==$$?$b:1==($$/=$Z)?$b+$u:($r||($r=.3*$Z),$F=!$E||0<$u&&$E<$u||$u<0&&$E<-$u?($E=$u,$r/4):$r/$x.PI2*Math.asin($u/$E),$E*Math.pow(2,-10*$$)*Math.sin(($$*$Z-$F)*$x.PI2/$r)+$u+$b)},$x.strongIn=function($$,$b,$u,$Z){return $u*($$/=$Z)*$$*$$*$$*$$+$b},$x.strongInOut=function($$,$b,$u,$Z){return($$/=.5*$Z)<1?.5*$u*$$*$$*$$*$$*$$+$b:.5*$u*(($$-=2)*$$*$$*$$*$$+2)+$b},$x.strongOut=function($$,$b,$u,$Z){return $u*(($$=$$/$Z-1)*$$*$$*$$*$$+1)+$b},$x.sineInOut=function($$,$b,$u,$Z){return.5*-$u*(Math.cos(Math.PI*$$/$Z)-1)+$b},$x.sineIn=function($$,$b,$u,$Z){return-$u*Math.cos($$/$Z*$x.HALF_PI)+$u+$b},$x.sineOut=function($$,$b,$u,$Z){return $u*Math.sin($$/$Z*$x.HALF_PI)+$b},$x.quintIn=function($$,$b,$u,$Z){return $u*($$/=$Z)*$$*$$*$$*$$+$b},$x.quintInOut=function($$,$b,$u,$Z){return($$/=.5*$Z)<1?.5*$u*$$*$$*$$*$$*$$+$b:.5*$u*(($$-=2)*$$*$$*$$*$$+2)+$b},$x.quintOut=function($$,$b,$u,$Z){return $u*(($$=$$/$Z-1)*$$*$$*$$*$$+1)+$b},$x.quartIn=function($$,$b,$u,$Z){return $u*($$/=$Z)*$$*$$*$$+$b},$x.quartInOut=function($$,$b,$u,$Z){return($$/=.5*$Z)<1?.5*$u*$$*$$*$$*$$+$b:.5*-$u*(($$-=2)*$$*$$*$$-2)+$b},$x.quartOut=function($$,$b,$u,$Z){return-$u*(($$=$$/$Z-1)*$$*$$*$$-1)+$b},$x.cubicIn=function($$,$b,$u,$Z){return $u*($$/=$Z)*$$*$$+$b},$x.cubicInOut=function($$,$b,$u,$Z){return($$/=.5*$Z)<1?.5*$u*$$*$$*$$+$b:.5*$u*(($$-=2)*$$*$$+2)+$b},$x.cubicOut=function($$,$b,$u,$Z){return $u*(($$=$$/$Z-1)*$$*$$+1)+$b},$x.quadIn=function($$,$b,$u,$Z){return $u*($$/=$Z)*$$+$b},$x.quadInOut=function($$,$b,$u,$Z){return($$/=.5*$Z)<1?.5*$u*$$*$$+$b:.5*-$u*(--$$*($$-2)-1)+$b},$x.quadOut=function($$,$b,$u,$Z){return-$u*($$/=$Z)*($$-2)+$b},$x.expoIn=function($$,$b,$u,$Z){return 0==$$?$b:$u*Math.pow(2,10*($$/$Z-1))+$b-.001*$u},$x.expoInOut=function($$,$b,$u,$Z){return 0==$$?$b:$$==$Z?$b+$u:($$/=.5*$Z)<1?.5*$u*Math.pow(2,10*($$-1))+$b:.5*$u*(2-Math.pow(2,-10*--$$))+$b},$x.expoOut=function($$,$b,$u,$Z){return $$==$Z?$b+$u:$u*(1-Math.pow(2,-10*$$/$Z))+$b},$x.circIn=function($$,$b,$u,$Z){return-$u*(Math.sqrt(1-($$/=$Z)*$$)-1)+$b},$x.circInOut=function($$,$b,$u,$Z){return($$/=.5*$Z)<1?.5*-$u*(Math.sqrt(1-$$*$$)-1)+$b:.5*$u*(Math.sqrt(1-($$-=2)*$$)+1)+$b},$x.circOut=function($$,$b,$u,$Z){return $u*Math.sqrt(1-($$=$$/$Z-1)*$$)+$b},$x.HALF_PI=.5*Math.PI,$x.PI2=2*Math.PI,$x}(),$W=function(){function $I(){this._hit=null,this._unHit=null}$e($I,"laya.utils.HitArea");var $$=$I.prototype;return $$.isHit=function($$,$b){return!!$I.isHitGraphic($$,$b,this.hit)&&!$I.isHitGraphic($$,$b,this.unHit)},$$.contains=function($$,$b){return this.isHit($$,$b)},$w(0,$$,"hit",function(){return this._hit||(this._hit=new $o),this._hit},function($$){this._hit=$$}),$w(0,$$,"unHit",function(){return this._unHit||(this._unHit=new $o),this._unHit},function($$){this._unHit=$$}),$I.isHitGraphic=function($$,$b,$u){if(!$u)return!1;var $Z;if(!($Z=$u.cmds)&&$u._one&&(($Z=$I._cmds).length=1,$Z[0]=$u._one),!$Z)return!1;var $E,$r,$F=0;for($E=$Z.length,$F=0;$F<$E;$F++)if($r=$Z[$F]){var $x=$Y._context;switch($r.callee){case $x._translate:case 6:$$-=$r[0],$b-=$r[1]}if($I.isHitCmd($$,$b,$r))return!0}return!1},$I.isHitCmd=function($$,$b,$u){if(!$u)return!1;var $Z=$Y._context,$E=!1;switch($u.callee){case $Z._drawRect:case 13:$I._rec.setTo($u[0],$u[1],$u[2],$u[3]),$E=$I._rec.contains($$,$b);break;case $Z._drawCircle:case $Z._fillCircle:case 14:$E=($$-=$u[0])*$$+($b-=$u[1])*$b<$u[2]*$u[2];break;case $Z._drawPoly:case 18:$$-=$u[0],$b-=$u[1],$E=$I.ptInPolygon($$,$b,$u[2])}return $E},$I.ptInPolygon=function($$,$b,$u){var $Z;($Z=$I._ptPoint).setTo($$,$b);var $E,$r=0,$F=NaN,$x=NaN,$g=NaN,$H=NaN;$E=$u.length;for(var $w=0;$w<$E;$w+=2){if($F=$u[$w],$x=$u[$w+1],$g=$u[($w+2)%$E],$x!=($H=$u[($w+3)%$E]))if(!($Z.y<Math.min($x,$H)))if(!($Z.y>=Math.max($x,$H)))($Z.y-$x)*($g-$F)/($H-$x)+$F>$Z.x&&$r++}return $r%2==1},$I._cmds=[],$g($I,["_rec",function(){return this._rec=new $a},"_ptPoint",function(){return this._ptPoint=new $q}]),$I}(),$G=(function(){function $E($$,$b,$u,$Z){this.char=$$,this.charNum=$$.charCodeAt(0),this._x=this._y=0,this.width=$b,this.height=$u,this.style=$Z,this.isWord=!$E._isWordRegExp.test($$)}$e($E,"laya.utils.HTMLChar");var $$=$E.prototype;$z.imps($$,{"laya.display.ILayout":!0}),$$.setSprite=function($$){this._sprite=$$},$$.getSprite=function(){return this._sprite},$$._isChar=function(){return!0},$$._getCSSStyle=function(){return this.style},$w(0,$$,"width",function(){return this._w},function($$){this._w=$$}),$w(0,$$,"x",function(){return this._x},function($$){this._sprite&&(this._sprite.x=$$),this._x=$$}),$w(0,$$,"y",function(){return this._y},function($$){this._sprite&&(this._sprite.y=$$),this._y=$$}),$w(0,$$,"height",function(){return this._h},function($$){this._h=$$}),$E._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $b(){}$e($b,"laya.utils.Log"),$b.enable=function(){$b._logdiv||($b._logdiv=$s.window.document.createElement("div"),$s.window.document.body.appendChild($b._logdiv),$b._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$b.toggle=function(){var $$=$b._logdiv.style;"1px"==$$.width?$$.width=$$.height="50%":$$.width=$$.height="1px"},$b.print=function($$){$b._logdiv&&($b.maxCount<=$b._count&&$b.clear(),$b._count++,$b._logdiv.innerText+=$$+"\n",$b._logdiv.scrollTop=$b._logdiv.scrollHeight)},$b.clear=function(){$b._logdiv.innerText="",$b._count=0},$b._logdiv=null,$b._count=0,$b.maxCount=20}(),function(){function $b(){}$e($b,"laya.utils.Mouse"),$w(1,$b,"cursor",function(){return $b._style.cursor},function($$){$b._style.cursor=$$}),$b.hide=function(){"none"!=$b.cursor&&($b._preCursor=$b.cursor,$b.cursor="none")},$b.show=function(){"none"==$b.cursor&&($b.cursor=$b._preCursor?$b._preCursor:"auto")},$b._preCursor=null,$g($b,["_style",function(){return this._style=$s.document.body.style}])}(),function(){function $r(){}return $e($r,"laya.utils.Pool"),$r.getPoolBySign=function($$){return $r._poolDic[$$]||($r._poolDic[$$]=[])},$r.clearBySign=function($$){$r._poolDic[$$]&&($r._poolDic[$$].length=0)},$r.recover=function($$,$b){$b.__InPool||($b.__InPool=!0,$r.getPoolBySign($$).push($b))},$r.getItemByClass=function($$,$b){var $u=$r.getPoolBySign($$),$Z=$u.length?$u.pop():new $b;return $Z.__InPool=!1,$Z},$r.getItemByCreateFun=function($$,$b,$u){var $Z=$r.getPoolBySign($$),$E=$Z.length?$Z.pop():$b.call($u);return $E.__InPool=!1,$E},$r.getItem=function($$){var $b=$r.getPoolBySign($$),$u=$b.length?$b.pop():null;return $u&&($u.__InPool=!1),$u},$r._poolDic={},$r.InPoolSign="__InPool",$r}()),$A=function(){function $g(){}return $e($g,"laya.utils.Stat"),$w(1,$g,"onclick",null,function($$){$g._sp&&$g._sp.on("click",$g._sp,$$),$g._canvas&&($g._canvas.source.onclick=$$,$g._canvas.source.style.pointerEvents="")}),$g.show=function($$,$b,$u){if(void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),!$Y.isConchApp||$Y.isConchWebGL){if($Y.isConchWebGL||$s.onMiniGame||$s.onLimixiu||($g._useCanvas=!0),$g._show=!0,$g._fpsData.length=60,$g._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$g._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$g._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$g._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$Y.isWebGL)if($g._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$Y.is3DMode){if($g._view[0].title="FPS(3D)",$g._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$g._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$g._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$u){var $Z=8;$g._view[$Z++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$g._view[$Z++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$g._view[$Z++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$g._view[$Z++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$g._view[$Z++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$g._view[$Z++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$g._view[$Z++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$g._view[$Z++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$g._view[$Z++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$u){$Z=8;$g._view[$Z++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$g._view[$Z++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$g._view[$Z++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$g._view[$Z++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$g._view[$Z++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$g._view[$Z++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$g._view[$Z++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $g._view[0].title="FPS(WebGL)",$g._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $g._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$g._useCanvas?$g.createUIPre($$,$b):$g.createUI($$,$b),$g.enable()}else $s.window.conch.showFPS&&$s.window.conch.showFPS($$,$b)},$g.createUIPre=function($$,$b){var $u=$s.pixelRatio;$g._width=170*$u,$g._vx=75*$u,$g._height=$u*(12*$g._view.length+3*$u)+4,$g._fontSize=12*$u;for(var $Z=0;$Z<$g._view.length;$Z++)$g._view[$Z].x=4,$g._view[$Z].y=$Z*$g._fontSize+2*$u;$g._canvas||(($g._canvas=new $y$("2D")).size($g._width,$g._height),($g._ctx=$g._canvas.getContext("2d")).textBaseline="top",$g._ctx.font=$g._fontSize+"px Sans-serif",$g._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$$+"px;top:"+$b+"px;width:"+$g._width/$u+"px;height:"+$g._height/$u+"px;"),$g._first=!0,$g.loop(),$g._first=!1,$s.container.appendChild($g._canvas.source)},$g.createUI=function($$,$b){var $u=$g._sp,$Z=$s.pixelRatio;$u||($u=new $I$,($g._leftText=new $L$).pos(5,5),$g._leftText.color="#ffffff",$u.addChild($g._leftText),($g._txt=new $L$).pos(80*$Z,5),$g._txt.color="#ffffff",$u.addChild($g._txt),$g._sp=$u),$u.pos($$,$b);for(var $E="",$r=0;$r<$g._view.length;$r++){$E+=$g._view[$r].title+"\n"}$g._leftText.text=$E;var $F=170*$Z,$x=$Z*(12*$g._view.length+3*$Z)+4;$g._txt.fontSize=$g._fontSize*$Z,$g._leftText.fontSize=$g._fontSize*$Z,$u.size($F,$x),$u.graphics.clear(),$u.graphics.setAlpha(.5),$u.graphics.drawRect(0,0,$F,$x,"#999999"),$u.graphics.setAlpha(1),$g.loop()},$g.enable=function(){$z.timer.frameLoop(1,$g,$g.loop)},$g.hide=function(){$g._show=!1,$z.timer.clear($g,$g.loop),$g._canvas&&$s.removeElement($g._canvas.source)},$g.clear=function(){$g.trianglesFaces=$g.drawCall=$g.shaderCall=$g.spriteCount=$g.spriteRenderUseCacheCount=$g.treeNodeCollision=$g.treeSpriteCollision=$g.canvasNormal=$g.canvasBitmap=$g.canvasReCache=0},$g.loop=function(){$g._count++;var $$=$s.now();if(!($$-$g._timer<1e3)){var $b=$g._count;if($g.FPS=Math.round(1e3*$b/($$-$g._timer)),$g._show){$g.trianglesFaces=Math.round($g.trianglesFaces/$b),$g.spriteCount=$g._useCanvas?($g.drawCall=Math.round($g.drawCall/$b)-2,$g.shaderCall=Math.round($g.shaderCall/$b),Math.round($g.spriteCount/$b)-1):($g.drawCall=Math.round($g.drawCall/$b)-2,$g.shaderCall=Math.round($g.shaderCall/$b)-4,Math.round($g.spriteCount/$b)-4),$g.spriteRenderUseCacheCount=Math.round($g.spriteRenderUseCacheCount/$b),$g.canvasNormal=Math.round($g.canvasNormal/$b),$g.canvasBitmap=Math.round($g.canvasBitmap/$b),$g.canvasReCache=Math.ceil($g.canvasReCache/$b),$g.treeNodeCollision=Math.round($g.treeNodeCollision/$b),$g.treeSpriteCollision=Math.round($g.treeSpriteCollision/$b);var $u=0<$g.FPS?Math.floor(1e3/$g.FPS).toString():" ";$g._fpsStr=$g.FPS+($g.renderSlow?" slow":"")+" "+$u,$g._spriteStr=$g.spriteCount+($g.spriteRenderUseCacheCount?"/"+$g.spriteRenderUseCacheCount:""),$g._canvasStr=$g.canvasReCache+"/"+$g.canvasNormal+"/"+$g.canvasBitmap,$g.currentMemorySize=$X.systemResourceManager.memorySize,$g._useCanvas?$g.renderInfoPre():$g.renderInfo(),$g.clear()}$g._count=0,$g._timer=$$}},$g.renderInfoPre=function(){if($g._canvas){var $$=$g._ctx;$$.clearRect($g._first?0:$g._vx,0,$g._width,$g._height);for(var $b=$Y.WebGL.mainContext,$u=0;$u<$g._view.length;$u++){var $Z=$g._view[$u];$g._first&&($$.fillStyle="white",$$.fillText($Z.title,$Z.x,$Z.y,null,null,null)),$$.fillStyle=$Z.color;var $E=-1;if(($Z=$g._view[$u]).varying){if($b)switch($Z.varying){case 1:$E=$b.getParameter($b[$Z.value]);break;case 2:$E=$b.getExtension($Z.value)}}else $E=$g[$Z.value];"M"==$Z.units&&($E=Math.floor($E/1048576*100)/100+" M"),"K"==$Z.units&&($E=Math.floor($E/1024*100)/100+" K"),"string"==$Z.units&&($E=$E.match(/\d+\.?\d/i)),$$.fillText($E+"",$Z.x+$g._vx,$Z.y,null,null,null)}}},$g.renderInfo=function(){for(var $$="",$b=$Y.WebGL.mainContext,$u=0;$u<$g._view.length;$u++){var $Z=$g._view[$u],$E=-1;if($Z.varying){if($b)switch($Z.varying){case 1:$E=$b.getParameter($b[$Z.value]);break;case 2:$E=$b.getExtension($Z.value)}}else $E=$g[$Z.value];"M"==$Z.units&&($E=Math.floor($E/1048576*100)/100+" M"),"K"==$Z.units&&($E=Math.floor($E/1024*100)/100+" K"),"string"==$Z.units&&($E=$E.match(/\d+\.?\d/i)),$$+=$E+"\n"}$g._txt.text=$$},$g.FPS=0,$g.loopCount=0,$g.shaderCall=0,$g.drawCall=0,$g.trianglesFaces=0,$g.spriteCount=0,$g.spriteRenderUseCacheCount=0,$g.treeNodeCollision=0,$g.treeSpriteCollision=0,$g.canvasNormal=0,$g.canvasBitmap=0,$g.canvasReCache=0,$g.renderSlow=!1,$g.currentMemorySize=0,$g._fpsStr=null,$g._canvasStr=null,$g._spriteStr=null,$g._fpsData=[],$g._timer=0,$g._count=0,$g._view=[],$g._fontSize=12,$g._txt=null,$g._leftText=null,$g._sp=null,$g._show=!1,$g._useCanvas=!1,$g._canvas=null,$g._ctx=null,$g._first=!1,$g._vx=NaN,$g._width=0,$g._height=100,$g}(),$j=(function(){function $$(){this._strsToID={},this._idToStrs=[],this._length=0}$e($$,"laya.utils.StringKey");var $b=$$.prototype;$b.add=function($$){var $b=this._strsToID[$$];return null!=$b?$b:(this._idToStrs[this._length]=$$,this._strsToID[$$]=this._length++)},$b.getID=function($$){var $b=this._strsToID[$$];return null==$b?-1:$b},$b.getName=function($$){var $b=this._idToStrs[$$];return null==$b?void 0:$b}}(),function(){var $H;function $$(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$e($$,"laya.utils.Timer");var $b=$$.prototype;return $b._init=function(){$z.timer&&$z.timer.frameLoop(1,this,this._update)},$b._now=function(){return Date.now()},$b._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $$=this.currFrame=this.currFrame+this.scale,$b=this._now();this._delta=($b-this._lastTimer)*this.scale;var $u=this.currTimer=this.currTimer+this._delta;$z.isDebug&&6e4<Math.abs($b-this._lastTimer)&&console.error("系统时间错误！"+($b-this._lastTimer)),this._lastTimer=$b;var $Z=this._handlers;for($F=this._count=0,$x=$Z.length;$F<$x;$F++)if(null!==($g=$Z[$F]).method){var $E=$g.userFrame?$$:$u;if($E>=$g.exeTime)if($g.repeat)if($g.jumpFrame)for(;$E>=$g.exeTime;)$g.exeTime+=$g.delay,$g.run(!1);else $g.exeTime+=$g.delay,$g.run(!1),$E>$g.exeTime&&($g.exeTime+=Math.ceil(($E-$g.exeTime)/$g.delay)*$g.delay);else $g.run(!0)}else this._count++;(30<this._count||$$%200==0)&&this._clearHandlers();for(var $r=this._laters,$F=0,$x=$r.length-1;$F<=$x;$F++){var $g=$r[$F];this._isIgnoreRecover($g)||(null!==$g.method&&(delete this._map[$g.key],$g.run(!1)),this._recoverHandler($g)),$F===$x&&($x=$r.length-1)}$r.length=0}},$b._clearHandlers=function(){for(var $$=this._handlers,$b=0,$u=$$.length;$b<$u;$b++){var $Z=$$[$b];null!==$Z.method?this._temp.push($Z):this._isIgnoreRecover($Z)?this._temp.push($Z):this._recoverHandler($Z)}this._handlers=this._temp,this._temp=$$,this._temp.length=0},$b._recoverHandler=function($$){this._map[$$.key]==$$&&delete this._map[$$.key],$$.recover()},$b._create=function($$,$b,$u,$Z,$E,$r,$F,$x){if(!$u)return $E.apply($Z,$r),null;if($F){var $g=this._getHandler($Z,$E);if($g)return $g.repeat=$b,$g.userFrame=$$,$g.delay=$u,$g.ignoreRecover=$x,$g.caller=$Z,$g.method=$E,$g.args=$r,$g.exeTime=$u+($$?this.currFrame:this.currTimer+this._now()-this._lastTimer),$g}return($g=$H.create()).repeat=$b,$g.userFrame=$$,$g.delay=$u,$g.ignoreRecover=$x,$g.caller=$Z,$g.method=$E,$g.args=$r,$g.exeTime=$u+($$?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($g),this._handlers.push($g),$g},$b._indexHandler=function($$){var $b=$$.caller,$u=$$.method,$Z=$b?$b.$_GID||($b.$_GID=$d.getGID()):0,$E=$u.$_TID||($u.$_TID=this._mid++);$$.key=$Z+"_"+$E,this._map[$$.key]=$$},$b.once=function($$,$b,$u,$Z,$E){void 0===$E&&($E=!0),this._create(!1,!1,$$,$b,$u,$Z,$E,!1)},$b.loop=function($$,$b,$u,$Z,$E,$r,$F){void 0===$E&&($E=!0),void 0===$r&&($r=!1),void 0===$F&&($F=!1);var $x=this._create(!1,!0,$$,$b,$u,$Z,$E,$F);$x&&($x.jumpFrame=$r)},$b.frameOnce=function($$,$b,$u,$Z,$E){void 0===$E&&($E=!0),this._create(!0,!1,$$,$b,$u,$Z,$E,!1)},$b.frameLoop=function($$,$b,$u,$Z,$E,$r){void 0===$E&&($E=!0),void 0===$r&&($r=!1),this._create(!0,!0,$$,$b,$u,$Z,$E,$r)},$b.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$H._freeCount},$b.clear=function($$,$b){var $u=this._getHandler($$,$b);return!(!$u||this._isIgnoreRecover($u))&&(delete this._map[$u.key],$u.key=null,$u.clear(),!0)},$b.clearAll=function($$){if($$)for(var $b=0,$u=this._handlers.length;$b<$u;$b++){var $Z=this._handlers[$b];$Z.caller===$$&&(this._isIgnoreRecover($Z)||(delete this._map[$Z.key],$Z.key=null,$Z.clear()))}},$b._getHandler=function($$,$b){var $u=$$?$$.$_GID||($$.$_GID=$d.getGID()):0,$Z=$b.$_TID||($b.$_TID=this._mid++);return this._map[$u+"_"+$Z]},$b._isIgnoreRecover=function($$){if($$.ignoreRecover||$$.caller&&"IgnoreRecover"==$$.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $b="";try{arguments.propertyIsEnumerable.caller}catch($$){$b=$$.stack}$z.recordError("报错：核心定时器销毁忽略  "+$b)}return!0}return!1},$b.hasHandler=function($$,$b){return this._map[$$.$_GID+"_"+$b.$_TID]},$b.callLater=function($$,$b,$u){if(null==this._getHandler($$,$b)){var $Z=$H.create();$Z.caller=$$,$Z.method=$b,$Z.args=$u,this._indexHandler($Z),this._laters.push($Z)}},$b.runCallLater=function($$,$b){var $u=this._getHandler($$,$b);$u&&null!=$u.method&&(this._isIgnoreRecover($u)||(delete this._map[$u.key],$u.run(!0)))},$b.runTimer=function($$,$b){this.runCallLater($$,$b)},$w(0,$b,"delta",function(){return this._delta}),$$.__init$=function(){$H=function(){function $b(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$e($b,"");var $$=$b.prototype;return $$.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$$.recover=function(){this.clear(),this.args=$b._freeHandler,$b._freeHandler=this,$b._freeCount++},$$.run=function($$){var $b=this.caller;if($b&&$b.destroyed)return this.clear();var $u=this.method,$Z=this.args;$$&&this.clear(),null!=$u&&($Z?$u.apply($b,$Z):$u.call($b))},$b._freeHandler=null,$b._freeCount=0,$b.create=function(){var $$=$b._freeHandler;return $$?($b._freeHandler=$$.args,--$b._freeCount,$$.args=null,$$):new $b},$b}()},$$}()),$h=function(){function $I(){this.gid=0}$e($I,"laya.utils.Tween");var $$=$I.prototype;return $$.to=function($$,$b,$u,$Z,$E,$r,$F){return void 0===$r&&($r=0),void 0===$F&&($F=!1),this._create($$,$b,$u,$Z,$E,$r,$F,!0,!1,!0)},$$.from=function($$,$b,$u,$Z,$E,$r,$F){return void 0===$r&&($r=0),void 0===$F&&($F=!1),this._create($$,$b,$u,$Z,$E,$r,$F,!1,!1,!0)},$$._create=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){if(!$$)throw new Error("Tween:target is null");this._target=$$,this._duration=$u,this._ease=$Z||$b.ease||$I.easeNone,this._complete=$E||$b.complete,this._delay=$r,this._props=[],this._usedTimer=0,this._startTimer=$s.now(),this._usedPool=$g,this._delayParam=null,this.update=$b.update;var $w=$$.$_GID||($$.$_GID=$d.getGID());return $I.tweenMap[$w]?($F&&$I.clearTween($$),$I.tweenMap[$w].push(this)):$I.tweenMap[$w]=[this],$H?$r<=0?this.firstStart($$,$b,$x):(this._delayParam=[$$,$b,$x],$z.scaleTimer.once($r,this,this.firstStart,this._delayParam)):this._initProps($$,$b,$x),this},$$.firstStart=function($$,$b,$u){this._delayParam=null,$$.destroyed?this.clear():(this._initProps($$,$b,$u),this._beginLoop())},$$._initProps=function($$,$b,$u){for(var $Z in $b)if("number"==typeof $$[$Z]){var $E=$u?$$[$Z]:$b[$Z],$r=$u?$b[$Z]:$$[$Z];this._props.push([$Z,$E,$r-$E]),$u||($$[$Z]=$E)}},$$._beginLoop=function(){$z.scaleTimer.frameLoop(1,this,this._doEase)},$$._doEase=function(){this._updateEase($s.now())},$$._updateEase=function($$){var $b=this._target;if($b){if($b.destroyed)return $I.clearTween($b);var $u=this._usedTimer=$$-this._startTimer-this._delay;if(!($u<0)){if($u>=this._duration)return this.complete();for(var $Z=0<$u?this._ease($u,0,1,this._duration):0,$E=this._props,$r=0,$F=$E.length;$r<$F;$r++){var $x=$E[$r];$b[$x[0]]=$x[1]+$Z*$x[2]}this.update&&this.update.run()}}},$$.complete=function(){if(this._target){$z.scaleTimer.runTimer(this,this.firstStart);for(var $$=this._target,$b=this._props,$u=this._complete,$Z=0,$E=$b.length;$Z<$E;$Z++){var $r=$b[$Z];$$[$r[0]]=$r[1]+$r[2]}this.update&&this.update.run(),this.clear(),$u&&$u.run()}},$$.pause=function(){$z.scaleTimer.clear(this,this._beginLoop),$z.scaleTimer.clear(this,this._doEase),$z.scaleTimer.clear(this,this.firstStart);var $$;($$=$s.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$$)},$$.setStartTime=function($$){this._startTimer=$$},$$.clear=function(){this._target&&(this._remove(),this._clear())},$$._clear=function(){this.pause(),$z.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$G.recover("tween",this))},$$.recover=function(){this._usedPool=!0,this._clear()},$$._remove=function(){var $$=$I.tweenMap[this._target.$_GID];if($$)for(var $b=0,$u=$$.length;$b<$u;$b++)if($$[$b]===this){$$.splice($b,1);break}},$$.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$s.now(),this._delayParam)$z.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $$=this._props,$b=0,$u=$$.length;$b<$u;$b++){var $Z=$$[$b];this._target[$Z[0]]=$Z[1]}$z.scaleTimer.once(this._delay,this,this._beginLoop)}},$$.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$s.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$z.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$w(0,$$,"progress",null,function($$){var $b=$$*this._duration;this._startTimer=$s.now()-this._delay-$b}),$I.to=function($$,$b,$u,$Z,$E,$r,$F,$x){return void 0===$r&&($r=0),void 0===$F&&($F=!1),void 0===$x&&($x=!0),$G.getItemByClass("tween",$I)._create($$,$b,$u,$Z,$E,$r,$F,!0,$x,!0)},$I.from=function($$,$b,$u,$Z,$E,$r,$F,$x){return void 0===$r&&($r=0),void 0===$F&&($F=!1),void 0===$x&&($x=!0),$G.getItemByClass("tween",$I)._create($$,$b,$u,$Z,$E,$r,$F,!1,$x,!0)},$I.clearAll=function($$){if($$&&$$.$_GID){var $b=$I.tweenMap[$$.$_GID];if($b){for(var $u=0,$Z=$b.length;$u<$Z;$u++)$b[$u]._clear();$b.length=0}}},$I.clear=function($$){$$.clear()},$I.clearTween=function($$){$I.clearAll($$)},$I.easeNone=function($$,$b,$u,$Z){return $u*$$/$Z+$b},$I.tweenMap={},$I}(),$d=function(){function $x(){}return $e($x,"laya.utils.Utils"),$x.toRadian=function($$){return $$*$x._pi2},$x.toAngle=function($$){return $$*$x._pi},$x.toHexColor=function($$){if($$<0||isNaN($$))return null;for(var $b=$$.toString(16);$b.length<6;)$b="0"+$b;return"#"+$b},$x.getGID=function(){return $x._gid++},$x.concatArray=function($$,$b){if(!$b)return $$;if(!$$)return $b;var $u=0,$Z=$b.length;for($u=0;$u<$Z;$u++)$$.push($b[$u]);return $$},$x.clearArray=function($$){return $$&&($$.length=0),$$},$x.copyArray=function($$,$b){if($$||($$=[]),!$b)return $$;$$.length=$b.length;var $u=0,$Z=$b.length;for($u=0;$u<$Z;$u++)$$[$u]=$b[$u];return $$},$x.getGlobalRecByPoints=function($$,$b,$u,$Z,$E){var $r,$F;return $r=new $q($b,$u),$r=$$.localToGlobal($r),$F=new $q($Z,$E),$F=$$.localToGlobal($F),$a._getWrapRec([$r.x,$r.y,$F.x,$F.y])},$x.getGlobalPosAndScale=function($$){return $x.getGlobalRecByPoints($$,0,0,1,1)},$x.bind=function($$,$b){return $$.bind($b)},$x.measureText=function($$,$b){return $O.measureText($$,$b)},$x.contextMeasureText=function($$){var $b=$s.context.measureText($$);return $b||($b={width:16,height:16}),$b},$x.updateOrder=function($$){if(!$$||$$.length<2)return!1;for(var $b,$u=1,$Z=0,$E=$$.length,$r=NaN;$u<$E;){for($b=$$[$Z=$u],$r=$$[$Z]._zOrder;-1<--$Z&&$$[$Z]._zOrder>$r;)$$[$Z+1]=$$[$Z];$$[$Z+1]=$b,$u++}var $F=$b.parent.conchModel;if($F)if(null!=$F.updateZOrder)$F.updateZOrder();else{for($u=0;$u<$E;$u++)$F.removeChild($$[$u].conchModel);for($u=0;$u<$E;$u++)$F.addChildAt($$[$u].conchModel,$u)}return!0},$x.transPointList=function($$,$b,$u){var $Z=0,$E=$$.length;for($Z=0;$Z<$E;$Z+=2)$$[$Z]+=$b,$$[$Z+1]+=$u},$x.parseInt=function($$,$b){void 0===$b&&($b=0);var $u=$s.window.parseInt($$,$b);return isNaN($u)?0:$u},$x.getFileExtension=function($$){$x._extReg.lastIndex=$$.lastIndexOf(".");var $b=$x._extReg.exec($$);return $b&&1<$b.length?$b[1].toLowerCase():null},$x.getTransformRelativeToWindow=function($$,$b,$u){var $Z=$z.stage,$E=laya.utils.Utils.getGlobalPosAndScale($$),$r=$Z._canvasTransform.clone(),$F=$r.tx,$x=$r.ty;$r.rotate(-Math.PI/180*$z.stage.canvasDegree),$r.scale($z.stage.clientScaleX,$z.stage.clientScaleY);var $g=$z.stage.canvasDegree%180!=0,$H=NaN,$w=NaN;$g?($H=$u+$E.y,$w=$b+$E.x,$H*=$r.d,$w*=$r.a,90==$z.stage.canvasDegree?($H=$F-$H,$w+=$x):($H+=$F,$w=$x-$w)):($H=$b+$E.x,$w=$u+$E.y,$H*=$r.a,$w*=$r.d,$H+=$F,$w+=$x);var $I=NaN,$o=NaN;return $o=$g?($I=$r.d*$E.height,$r.a*$E.width):($I=$r.a*$E.width,$r.d*$E.height),{x:$H,y:$w,scaleX:$I,scaleY:$o}},$x.fitDOMElementInArea=function($$,$b,$u,$Z,$E,$r){$$._fitLayaAirInitialized||($$._fitLayaAirInitialized=!0,$$.style.transformOrigin=$$.style.webKittransformOrigin="left top",$$.style.position="absolute");var $F=$x.getTransformRelativeToWindow($b,$u,$Z);$$.style.transform=$$.style.webkitTransform="scale("+$F.scaleX+","+$F.scaleY+") rotate("+$z.stage.canvasDegree+"deg)",$$.style.width=$E+"px",$$.style.height=$r+"px",$$.style.left=$F.x+"px",$$.style.top=$F.y+"px"},$x.isOkTextureList=function($$){if(!$$)return!1;var $b,$u=0,$Z=$$.length;for($u=0;$u<$Z;$u++)if(!($b=$$[$u])||!$b.source)return!1;return!0},$x.isOKCmdList=function($$){if(!$$)return!1;var $b,$u,$Z=0,$E=$$.length,$r=$Y._context;for($Z=0;$Z<$E;$Z++)switch(($b=$$[$Z]).callee){case $r._drawTexture:case $r._fillTexture:case $r._drawTextureWithTransform:if(!($u=$b[0])||!$u.source)return!1}return!0},$x._gid=1,$x._pi=180/Math.PI,$x._pi2=Math.PI/180,$x._extReg=/\.(\w+)\??/g,$x.parseXMLFromString=function($$){var $b;if($$=$$.replace(/>\s+</g,"><"),-1<($b=(new DOMParser).parseFromString($$,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($b.firstChild.firstChild.textContent);return $b},$x}(),$U=function(){function $$(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$Y.isWebGL&&$n.regCacheByFunction($d.bind(this.startDispose,this),$d.bind(this.getCacheList,this))}$e($$,"laya.utils.VectorGraphManager");var $b=$$.prototype;return $b.getId=function(){return this._id++},$b.addShape=function($$,$b){this.shapeDic[$$]=$b,this.useDic[$$]||(this.useDic[$$]=!0)},$b.addLine=function($$,$b){this.shapeLineDic[$$]=$b,this.shapeLineDic[$$]||(this.shapeLineDic[$$]=!0)},$b.getShape=function($$){this._checkKey&&null!=this.useDic[$$]&&(this.useDic[$$]=!0)},$b.deleteShape=function($$){this.shapeDic[$$]&&(this.shapeDic[$$]=null,delete this.shapeDic[$$]),this.shapeLineDic[$$]&&(this.shapeLineDic[$$]=null,delete this.shapeLineDic[$$]),null!=this.useDic[$$]&&delete this.useDic[$$]},$b.getCacheList=function(){var $$,$b=[];for($$ in this.shapeDic)$b.push(this.shapeDic[$$]);for($$ in this.shapeLineDic)$b.push(this.shapeLineDic[$$]);return $b},$b.startDispose=function($$){var $b;for($b in this.useDic)this.useDic[$b]=!1;this._checkKey=!0},$b.endDispose=function(){if(this._checkKey){var $$;for($$ in this.useDic)this.useDic[$$]||this.deleteShape($$);this._checkKey=!1}},$$.getInstance=function(){return $$.instance=$$.instance||new $$},$$.instance=null,$$}(),$B=function(){function $Z(){this._obj=null,this._obj=$Z.supportWeakMap?new $s.window.WeakMap:{},$Z.supportWeakMap||$Z._maps.push(this)}$e($Z,"laya.utils.WeakObject");var $$=$Z.prototype;return $$.set=function($$,$b){if(null!=$$)if($Z.supportWeakMap){var $u=$$;"string"!=typeof $$&&"number"!=typeof $$||($u=$Z._keys[$$])||($u=$Z._keys[$$]={k:$$}),this._obj.set($u,$b)}else"string"==typeof $$||"number"==typeof $$?this._obj[$$]=$b:($$.$_GID||($$.$_GID=$d.getGID()),this._obj[$$.$_GID]=$b)},$$.get=function($$){if(null==$$)return null;if($Z.supportWeakMap){var $b="string"==typeof $$||"number"==typeof $$?$Z._keys[$$]:$$;return $b?this._obj.get($b):null}return"string"==typeof $$||"number"==typeof $$?this._obj[$$]:this._obj[$$.$_GID]},$$.del=function($$){if(null!=$$)if($Z.supportWeakMap){var $b="string"==typeof $$||"number"==typeof $$?$Z._keys[$$]:$$;if(!$b)return;this._obj.delete($b)}else"string"==typeof $$||"number"==typeof $$?delete this._obj[$$]:delete this._obj[this._obj.$_GID]},$$.has=function($$){if(null==$$)return!1;if($Z.supportWeakMap){var $b="string"==typeof $$||"number"==typeof $$?$Z._keys[$$]:$$;return this._obj.has($b)}return"string"==typeof $$||"number"==typeof $$?null!=this._obj[$$]:null!=this._obj[this._obj.$_GID]},$Z.__init__=function(){($Z.supportWeakMap=null!=$s.window.WeakMap)||$z.timer.loop($Z.delInterval,null,$Z.clearCache)},$Z.clearCache=function(){for(var $$=0,$b=$Z._maps.length;$$<$b;$$++){$Z._maps[$$]._obj={}}},$Z.supportWeakMap=!1,$Z.delInterval=3e5,$Z._keys={},$Z._maps=[],$g($Z,["I",function(){return this.I=new $Z}]),$Z}(),$R=function(){function $$(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$e($$,"laya.utils.WordText");var $b=$$.prototype;return $b.setText=function($$){this.changed=!0,this._text=$$},$b.toString=function(){return this._text},$b.charCodeAt=function($$){return this._text?this._text.charCodeAt($$):NaN},$b.charAt=function($$){return this._text?this._text.charAt($$):null},$w(0,$b,"length",function(){return this._text?this._text.length:0}),$$}(),$$$=function($$){function $F(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$F.__super.call(this),this._childs=$F.ARRAY_EMPTY,this._$P=$F.PROP_EMPTY,this.timer=$z.scaleTimer,this.conchModel=$Y.isConchNode?this.createConchModel():null}$e($F,"laya.display.Node",$H);var $b=$F.prototype;return $b._setBit=function($$,$b){1==$$&&(this._getBit($$)!=$b&&this._updateDisplayedInstage());$b?this._bits|=$$:this._bits&=~$$},$b._getBit=function($$){return 0!=(this._bits&$$)},$b._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$b._setUpNoticeType=function($$){var $b=this;for($b._setBit($$,!0),$b=$b.parent;$b;){if($b._getBit($$))return;$b._setBit($$,!0),$b=$b.parent}},$b.on=function($$,$b,$u,$Z){return"display"!==$$&&"undisplay"!==$$||this._getBit(1)||this._setUpNoticeType(1),this._createListener($$,$b,$u,$Z,!1)},$b.once=function($$,$b,$u,$Z){return"display"!==$$&&"undisplay"!==$$||this._getBit(1)||this._setUpNoticeType(1),this._createListener($$,$b,$u,$Z,!0)},$b.createConchModel=function(){return null},$b.destroy=function($$){void 0===$$&&($$=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($$?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$b.destroyChildren=function(){if(this._childs)for(var $$=this._childs.length-1;-1<$$;$$--)this._childs[$$].destroy(!0)},$b.addChild=function($$){if(!$$||this.destroyed||$$===this)return $$;if($$.zOrder&&this._set$P("hasZorder",!0),$$._parent===this){var $b=this.getChildIndex($$);$b!==this._childs.length-1&&(this._childs.splice($b,1),this._childs.push($$),this.conchModel&&(this.conchModel.removeChild($$.conchModel),this.conchModel.addChildAt($$.conchModel,this._childs.length-1)),this._childChanged())}else $$.parent&&$$.parent.removeChild($$),this._childs===$F.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($$),this.conchModel&&this.conchModel.addChildAt($$.conchModel,this._childs.length-1),($$.parent=this)._childChanged();return $$},$b.addChildren=function($$){for(var $b=arguments,$u=0,$Z=$b.length;$u<$Z;)this.addChild($b[$u++])},$b.addChildAt=function($$,$b){if(!$$||this.destroyed||$$===this)return $$;if($$.zOrder&&this._set$P("hasZorder",!0),0<=$b&&$b<=this._childs.length){if($$._parent===this){var $u=this.getChildIndex($$);this._childs.splice($u,1),this._childs.splice($b,0,$$),this.conchModel&&(this.conchModel.removeChild($$.conchModel),this.conchModel.addChildAt($$.conchModel,$b)),this._childChanged()}else $$.parent&&$$.parent.removeChild($$),this._childs===$F.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($b,0,$$),this.conchModel&&this.conchModel.addChildAt($$.conchModel,$b),$$.parent=this;return $$}throw new Error("appendChildAt:The index is out of bounds")},$b.getChildIndex=function($$){return this._childs.indexOf($$)},$b.getChildByName=function($$){var $b=this._childs;if($b)for(var $u=0,$Z=$b.length;$u<$Z;$u++){var $E=$b[$u];if($E.name===$$)return $E}return null},$b._get$P=function($$){return this._$P[$$]},$b._set$P=function($$,$b){return this.destroyed||(this._$P===$F.PROP_EMPTY&&(this._$P={}),this._$P[$$]=$b),$b},$b.getChildAt=function($$){return this._childs[$$]},$b.setChildIndex=function($$,$b){var $u=this._childs;if($b<0||$b>=$u.length)throw new Error("setChildIndex:The index is out of bounds.");var $Z=this.getChildIndex($$);if($Z<0)throw new Error("setChildIndex:node is must child of this object.");return $u.splice($Z,1),$u.splice($b,0,$$),this.conchModel&&(this.conchModel.removeChild($$.conchModel),this.conchModel.addChildAt($$.conchModel,$b)),this._childChanged(),$$},$b._childChanged=function($$){},$b.removeChild=function($$){if(!this._childs)return $$;var $b=this._childs.indexOf($$);return this.removeChildAt($b)},$b.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$b.removeChildByName=function($$){var $b=this.getChildByName($$);return $b&&this.removeChild($b),$b},$b.removeChildAt=function($$){var $b=this.getChildAt($$);if($b){for(var $u=this._childs.length-1,$Z=$$;$Z<$u;++$Z)this._childs[$Z]=this._childs[$Z+1];this._childs.length=$u,this.conchModel&&this.conchModel.removeChild($b.conchModel),$b.parent=null}return $b},$b.removeChildren=function($$,$b){if(void 0===$$&&($$=0),void 0===$b&&($b=2147483647),this._childs&&0<this._childs.length){var $u=this._childs;if(0===$$&&$r<=$b){var $Z=$u;this._childs=$F.ARRAY_EMPTY}else $Z=$u.splice($$,$b-$$);for(var $E=0,$r=$Z.length;$E<$r;$E++)$Z[$E].parent=null,this.conchModel&&this.conchModel.removeChild($Z[$E].conchModel)}return this},$b.replaceChild=function($$,$b){var $u=this._childs.indexOf($b);return-1<$u?(this._childs.splice($u,1,$$),this.conchModel&&(this.conchModel.removeChild($b.conchModel),this.conchModel.addChildAt($$.conchModel,$u)),$b.parent=null,$$.parent=this,$$):null},$b._updateDisplayedInstage=function(){var $$;$$=this;var $b=$z.stage;for(this._displayedInStage=!1;$$;){if($$._getBit(1)){this._displayedInStage=$$._displayedInStage;break}if($$==$b||$$._displayedInStage){this._displayedInStage=!0;break}$$=$$.parent}},$b._setDisplay=function($$){this._displayedInStage!==$$&&((this._displayedInStage=$$)?this.event("display"):this.event("undisplay"))},$b._displayChild=function($$,$b){var $u=$$._childs;if($u)for(var $Z=0;$Z<$u.length;$Z++){var $E=$u[$Z];$E&&$E._getBit(1)&&(0<$E._childs.length?this._displayChild($E,$b):$E._setDisplay($b))}$$._setDisplay($b)},$b.contains=function($$){if($$===this)return!0;for(;$$;){if($$.parent===this)return!0;$$=$$.parent}return!1},$b.timerLoop=function($$,$b,$u,$Z,$E,$r){void 0===$E&&($E=!0),void 0===$r&&($r=!1),this.timer.loop($$,$b,$u,$Z,$E,$r)},$b.timerOnce=function($$,$b,$u,$Z,$E){void 0===$E&&($E=!0),this.timer._create(!1,!1,$$,$b,$u,$Z,$E)},$b.frameLoop=function($$,$b,$u,$Z,$E){void 0===$E&&($E=!0),this.timer._create(!0,!0,$$,$b,$u,$Z,$E)},$b.frameOnce=function($$,$b,$u,$Z,$E){void 0===$E&&($E=!0),this.timer._create(!0,!1,$$,$b,$u,$Z,$E)},$b.clearTimer=function($$,$b){this.timer.clear($$,$b)},$w(0,$b,"numChildren",function(){return this._childs.length}),$w(0,$b,"destroyed",function(){return this._destroyed}),$w(0,$b,"parent",function(){return this._parent},function($$){this._parent!==$$&&($$?(this._parent=$$,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$$.displayedInStage&&this._displayChild(this,!0)),$$._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$$))}),$w(0,$b,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$F.ARRAY_EMPTY=[],$F.PROP_EMPTY={},$F.NOTICE_DISPLAY=1,$F.MOUSEENABLE=2,$F}(),$b$=function($$){function $o($$){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$o.__super.call(this),this._padding=$o._PADDING,this._spacing=$o._SPACING,this._aligns=$o._ALIGNS,this._font=$N.EMPTY,this._ower=$$}$e($o,"laya.display.css.CSSStyle",$$);var $b=$o.prototype;return $b.destroy=function(){this._ower=null,this._font=null,this._rect=null},$b.inherit=function($$){this._font=$$._font,this._spacing=$$._spacing===$o._SPACING?$o._SPACING:$$._spacing.slice(),this.lineHeight=$$.lineHeight},$b._widthAuto=function(){return 0!=(262144&this._type)},$b.widthed=function($$){return 0!=(8&this._type)},$b._calculation=function($$,$b){if($b.indexOf("%")<0)return!1;var $Z=this._ower,$E=$Z.parent,$r=this._rect;function $F($$,$b,$u){return $$*$u[0]+$b*$u[1]+$u[2]}function $u($$){var $b=$E.width,$u=$Z.width;$r.width&&($Z.width=$F($b,$u,$r.width)),$r.height&&($Z.height=$F($b,$u,$r.height)),$r.left&&($Z.x=$F($b,$u,$r.left)),$r.top&&($Z.y=$F($b,$u,$r.top))}null===$r&&($E._getCSSStyle()._type|=524288,$E.on("resize",this,$u),this._rect=$r={input:{}});var $x=$b.split(" ");return $x[0]=parseFloat($x[0])/100,1==$x.length?$x[1]=$x[2]=0:($x[1]=parseFloat($x[1])/100,$x[2]=parseFloat($x[2])),$r[$$]=$x,$r.input[$$]=$b,$u(),!0},$b.heighted=function($$){return 0!=(8192&this._type)},$b.size=function($$,$b){var $u=this._ower,$Z=!1;-1!==$$&&$$!=this._ower.width&&(this._type|=8,this._ower.width=$$,$Z=!0),-1!==$b&&$b!=this._ower.height&&(this._type|=8192,this._ower.height=$b,$Z=!0),$Z&&($u._layoutLater(),524288&this._type&&$u.event("resize",this))},$b._getAlign=function(){return this._aligns[0]},$b._getValign=function(){return this._aligns[1]},$b._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$b._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $N(this._font))},$b.render=function($$,$b,$u,$Z){var $E=$$.width,$r=$$.height;$u-=$$.pivotX,$Z-=$$.pivotY,this._bgground&&null!=this._bgground.color&&$b.ctx.fillRect($u,$Z,$E,$r,this._bgground.color),this._border&&this._border.color&&$b.drawRect($u,$Z,$E,$r,this._border.color.strColor,this._border.size)},$b.getCSSStyle=function(){return this},$b.cssText=function($$){this.attrs($o.parseOneCSS($$,";"))},$b.attrs=function($$){if($$)for(var $b=0,$u=$$.length;$b<$u;$b++){var $Z=$$[$b];this[$Z[0]]=$Z[1]}},$b.setTransform=function($$){"none"===$$?this._tf=$x._TF_EMPTY:this.attrs($o.parseOneCSS($$,","))},$b.translate=function($$,$b){this._tf===$x._TF_EMPTY&&(this._tf=new $E),this._tf.translateX=$$,this._tf.translateY=$b},$b.scale=function($$,$b){this._tf===$x._TF_EMPTY&&(this._tf=new $E),this._tf.scaleX=$$,this._tf.scaleY=$b},$b._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$w(0,$b,"block",$$.prototype._$get_block,function($$){$$?this._type|=1:this._type&=-2}),$w(0,$b,"valign",function(){return $o._valigndef[this._aligns[1]]},function($$){this._aligns===$o._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$o._valigndef[$$]}),$w(0,$b,"height",null,function($$){if(this._type|=8192,"string"==typeof $$){if(this._calculation("height",$$))return;$$=parseInt($$)}this.size(-1,$$)}),$w(0,$b,"width",null,function($$){if(this._type|=8,"string"==typeof $$){var $b=$$.indexOf("auto");if(0<=$b&&(this._type|=262144,$$=$$.substr(0,$b)),this._calculation("width",$$))return;$$=parseInt($$)}this.size($$,-1)}),$w(0,$b,"fontWeight",function(){return this._font.weight},function($$){this._createFont().weight=$$}),$w(0,$b,"left",null,function($$){var $b=this._ower;if("string"==typeof $$){if("center"===$$?$$="50% -50% 0":"right"===$$&&($$="100% -100% 0"),this._calculation("left",$$))return;$$=parseInt($$)}$b.x=$$}),$w(0,$b,"_translate",null,function($$){this.translate($$[0],$$[1])}),$w(0,$b,"absolute",function(){return 0!=(4&this._type)}),$w(0,$b,"top",null,function($$){var $b=this._ower;if("string"==typeof $$){if("middle"===$$?$$="50% -50% 0":"bottom"===$$&&($$="100% -100% 0"),this._calculation("top",$$))return;$$=parseInt($$)}$b.y=$$}),$w(0,$b,"align",function(){return $o._aligndef[this._aligns[0]]},function($$){this._aligns===$o._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$o._aligndef[$$]}),$w(0,$b,"bold",function(){return this._font.bold},function($$){this._createFont().bold=$$}),$w(0,$b,"padding",function(){return this._padding},function($$){this._padding=$$}),$w(0,$b,"leading",function(){return this._spacing[1]},function($$){"string"==typeof $$&&($$=parseInt($$+"")),this._spacing===$o._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$$}),$w(0,$b,"lineElement",function(){return 0!=(65536&this._type)},function($$){$$?this._type|=65536:this._type&=-65537}),$w(0,$b,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($$){this.lineElement=!1,"right"===$$?this._type|=32768:this._type&=-32769}),$w(0,$b,"textDecoration",function(){return this._font.decoration},function($$){this._createFont().decoration=$$}),$w(0,$b,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($$){"nowrap"===$$&&(this._type|=131072),"none"===$$&&(this._type&=-131073)}),$w(0,$b,"background",null,function($$){$$?(this._bgground||(this._bgground={}),this._bgground.color=$$,this._ower.conchModel&&this._ower.conchModel.bgColor($$),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$w(0,$b,"wordWrap",function(){return 0==(131072&this._type)},function($$){$$?this._type&=-131073:this._type|=131072}),$w(0,$b,"color",function(){return this._font.color},function($$){this._createFont().color=$$}),$w(0,$b,"password",function(){return this._font.password},function($$){this._createFont().password=$$}),$w(0,$b,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($$){"none"===$$?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$$),this._ower.conchModel&&this._ower.conchModel.bgColor($$),this._ower._renderType|=256}),$w(0,$b,"font",function(){return this._font.toString()},function($$){this._createFont().set($$)}),$w(0,$b,"weight",null,function($$){this._createFont().weight=$$}),$w(0,$b,"letterSpacing",function(){return this._spacing[0]},function($$){"string"==typeof $$&&($$=parseInt($$+"")),this._spacing===$o._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$$}),$w(0,$b,"fontSize",function(){return this._font.size},function($$){this._createFont().size=$$}),$w(0,$b,"italic",function(){return this._font.italic},function($$){this._createFont().italic=$$}),$w(0,$b,"fontFamily",function(){return this._font.family},function($$){this._createFont().family=$$}),$w(0,$b,"stroke",function(){return this._font.stroke[0]},function($$){this._createFont().stroke===$N._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$$}),$w(0,$b,"strokeColor",function(){return this._font.stroke[1]},function($$){this._createFont().stroke===$N._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$$}),$w(0,$b,"border",function(){return this._border?this._border.value:""},function($$){if("none"!=$$){this._border||(this._border={});var $b=(this._border.value=$$).split(" ");if(this._border.color=$J.create($b[$b.length-1]),1==$b.length)return this._border.size=1,void(this._border.type="solid");var $u=0;0<$b[0].indexOf("px")?(this._border.size=parseInt($b[0]),$u++):this._border.size=1,this._border.type=$b[$u],this._ower._renderType|=256}else this._border=null}),$w(0,$b,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($$){$$?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$$?null:$J.create($$),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$w(0,$b,"position",function(){return 4&this._type?"absolute":""},function($$){"absolute"==$$?this._type|=4:this._type&=-5}),$w(0,$b,"display",null,function($$){switch($$){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$w(0,$b,"paddingLeft",function(){return this.padding[3]}),$w(0,$b,"paddingTop",function(){return this.padding[0]}),$w(0,$b,"_scale",null,function($$){this._ower.scale($$[0],$$[1])}),$w(0,$b,"_rotate",null,function($$){this._ower.rotation=$$}),$o.parseOneCSS=function($$,$b){for(var $u,$Z=[],$E=$$.split($b),$r=0,$F=$E.length;$r<$F;$r++){var $x=$E[$r],$g=$x.indexOf(":"),$H=$x.substr(0,$g).replace(/^\s+|\s+$/g,"");if(0!=$H.length){var $w=$x.substr($g+1).replace(/^\s+|\s+$/g,""),$I=[$H,$w];switch($H){case"italic":case"bold":$I[1]="true"==$w;break;case"line-height":$I[0]="lineHeight",$I[1]=parseInt($w);break;case"font-size":$I[0]="fontSize",$I[1]=parseInt($w);break;case"padding":1<($u=$w.split(" ")).length||($u[1]=$u[2]=$u[3]=$u[0]),$I[1]=[parseInt($u[0]),parseInt($u[1]),parseInt($u[2]),parseInt($u[3])];break;case"rotate":$I[0]="_rotate",$I[1]=parseFloat($w);break;case"scale":$u=$w.split(" "),$I[0]="_scale",$I[1]=[parseFloat($u[0]),parseFloat($u[1])];break;case"translate":$u=$w.split(" "),$I[0]="_translate",$I[1]=[parseInt($u[0]),parseInt($u[1])];break;default:($I[0]=$o._CSSTOVALUE[$H])||($I[0]=$H)}$Z.push($I)}}return $Z},$o.parseCSS=function($$,$b){for(var $u;null!=($u=$o._parseCSSRegExp.exec($$));)$o.styleSheets[$u[1]]=$o.parseOneCSS($u[2],";")},$o.EMPTY=new $o(null),$o._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$o._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$o._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$o._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$o.styleSheets={},$o.ALIGN_CENTER=1,$o.ALIGN_RIGHT=2,$o.VALIGN_MIDDLE=1,$o.VALIGN_BOTTOM=2,$o._CSS_BLOCK=1,$o._DISPLAY_NONE=2,$o._ABSOLUTE=4,$o._WIDTH_SET=8,$o._PADDING=[0,0,0,0],$o._RECT=[-1,-1,-1,-1],$o._SPACING=[0,0],$o._ALIGNS=[0,0,0],$o.ADDLAYOUTED=512,$o._NEWFONT=4096,$o._HEIGHT_SET=8192,$o._BACKGROUND_SET=16384,$o._FLOAT_RIGHT=32768,$o._LINE_ELEMENT=65536,$o._NOWARP=131072,$o._WIDTHAUTO=262144,$o._LISTERRESZIE=524288,$o}($x),$u$=function($$){function $F(){this.url=null,this.audio=null,this.loaded=!1,$F.__super.call(this)}$e($F,"laya.media.h5audio.AudioSound",$H);var $b=$F.prototype;return $b.dispose=function(){var $$=$F._audioCache[this.url];$$&&($$.src="",delete $F._audioCache[this.url])},$b.load=function($$){var $b;if($$=$p.formatURL($$),(this.url=$$)==$K._tMusic?($F._initMusicAudio(),($b=$F._musicAudio).src!=$$&&($F._audioCache[$b.src]=null,$b=null)):$b=$F._audioCache[$$],$b&&2<=$b.readyState)this.event("complete");else{$b||($b=$$==$K._tMusic?($F._initMusicAudio(),$F._musicAudio):$s.createElement("audio"),($F._audioCache[$$]=$b).src=$$),$b.addEventListener("canplaythrough",$Z),$b.addEventListener("error",$E);var $u=this;(this.audio=$b).load?$b.load():$E()}function $Z(){$r(),$u.loaded=!0,$u.event("complete")}function $E(){$b.load=null,$r(),$u.event("error")}function $r(){$b.removeEventListener("canplaythrough",$Z),$b.removeEventListener("error",$E)}},$b.play=function($$,$b,$u){if(void 0===$$&&($$=0),void 0===$b&&($b=0),!this.url)return null;var $Z,$E;if(!($Z=this.url==$K._tMusic?$F._musicAudio:$F._audioCache[this.url]))return null;$E=$G.getItem("audio:"+this.url),$Y.isConchApp?$E||(($E=$s.createElement("audio")).src=this.url):this.url==$K._tMusic?($F._initMusicAudio(),($E=$F._musicAudio).src=this.url):$E=$E||$Z.cloneNode(!0);var $r=new $o$($E);return $r.url=this.url,$r.loops=$b,$r.startTime=$$,$r.startHandler=$u,$r.play(!1),$K.addChannel($r),$r},$w(0,$b,"duration",function(){var $$;return($$=$F._audioCache[this.url])?$$.duration:0}),$F._initMusicAudio=function(){$F._musicAudio||($F._musicAudio||($F._musicAudio=$s.createElement("audio")),$Y.isConchApp||$s.document.addEventListener("mousedown",$F._makeMusicOK))},$F._makeMusicOK=function(){$s.document.removeEventListener("mousedown",$F._makeMusicOK),$F._musicAudio.src?$F._musicAudio.play():($F._musicAudio.src="",$F._musicAudio.load())},$F._audioCache={},$F._musicAudio=null,$F}(),$Z$=function($$){function $b(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$b.__super.call(this)}$e($b,"laya.media.SoundChannel",$H);var $u=$b.prototype;return $u.play=function(){},$u.stop=function(){},$u.pause=function(){},$u.resume=function(){},$u.__runComplete=function($$){$$&&$$.run()},$w(0,$u,"volume",function(){return 1},function($$){}),$w(0,$u,"position",function(){return 0}),$w(0,$u,"duration",function(){return 0}),$b}(),$E$=function($$){function $b(){$b.__super.call(this)}$e($b,"laya.media.Sound",$H);var $u=$b.prototype;return $u.load=function($$){},$u.play=function($$,$b,$u){return void 0===$$&&($$=0),void 0===$b&&($b=0),null},$u.dispose=function(){},$w(0,$u,"duration",function(){return 0}),$b}(),$r$=function($$){function $E(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$E.__super.call(this)}$e($E,"laya.media.webaudio.WebAudioSound",$H);var $b=$E.prototype;return $b.load=function($$){this.url=$$,this.audioBuffer=$E._dataCache[$$],this.audioBuffer?this._loaded(this.audioBuffer):($E.e.on("loaded:"+$$,this,this._loaded),$E.e.on("err:"+$$,this,this._err),$E.__loadingSound[$$]||($E.__loadingSound[$$]=!0,$z.loader.load($$,$_.create(this,this.onloaded),null,$x$.BUFFER,4,!1,null,!0)))},$b.onloaded=function($$){$$||this._err(),this._disposed?this._removeLoadEvents():(this.data=$$,$E.buffs.push({buffer:this.data,url:this.url}),$E.decode())},$b._err=function(){if(this._removeLoadEvents(),$E.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $$,$b,$u,$Z=0;for($$=($b=this.__toPlays).length,$Z=0;$Z<$$;$Z++)($u=$b[$Z])[3]&&!$u[3].isStopped&&$u[3].event("error");this.__toPlays.length=0}},$b._loaded=function($$){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$$,this.loaded=!0,this.event("complete"))},$b._removeLoadEvents=function(){$E.e.off("loaded:"+this.url,this,this._loaded),$E.e.off("err:"+this.url,this,this._err)},$b.__playAfterLoaded=function(){if(this.__toPlays){var $$,$b,$u,$Z=0;for($$=($b=this.__toPlays).length,$Z=0;$Z<$$;$Z++)($u=$b[$Z])[3]&&!$u[3].isStopped&&this.play($u[0],$u[1],$u[2],$u[3]);this.__toPlays.length=0}},$b.play=function($$,$b,$u,$Z){return void 0===$$&&($$=0),void 0===$b&&($b=0),$Z=$Z||new $N$,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$$,$b,$u,$Z]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$Z.url=this.url,$Z.loops=$b,$Z.audioBuffer=this.audioBuffer,$Z.startTime=$$,$Z.startHandler=$u,$Z.play(!1),$K.addChannel($Z),$Z},$b.dispose=function(){this._disposed=!0,delete $E._dataCache[this.url],delete $E.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$w(0,$b,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$E.decode=function(){if(!($E.buffs.length<=0||$E.isDecoding))if($E.isDecoding=!0,($E.tInfo=$E.buffs.shift())&&$E.tInfo.buffer&&$E.tInfo.buffer.byteLength)try{$E.ctx.decodeAudioData($E.tInfo.buffer,$E._done,$E._fail)}catch($$){console.error("decodeAudioData error  byteLength:"+$E.tInfo.buffer.byteLength+"  url:"+$E.tInfo.url)}else $E._fail()},$E._done=function($$){$E.e.event("loaded:"+$E.tInfo.url,$$),$E._dataCache[$E.tInfo.url]=$$,$E.isDecoding=!1,$E.decode()},$E._fail=function(){$E.e.event("err:"+$E.tInfo.url,null),$E.isDecoding=!1,$E.decode()},$E._playEmptySound=function(){if(null!=$E.ctx){if($E._emptySource&&($E._emptySource.stop(),$E._emptySource.disconnect(0),!$N$._tryCleanFailed))try{$E._emptySource.buffer=null}catch($$){$N$._tryCleanFailed=!0}var $$=$E.ctx.createBufferSource();$$.buffer=$E._miniBuffer,$$.connect($E.ctx.destination),$$.start(0,0,0),$E._emptySource=$$}},$E._unlock=function(){$E._unlocked||($E._playEmptySound(),"running"==$E.ctx.state?($s.document.removeEventListener("mousedown",$E._unlock,!0),$s.document.removeEventListener("touchend",$E._unlock,!0),$s.document.removeEventListener("touchstart",$E._unlock,!0),$E._unlocked=!0):"suspended"==$E.ctx.state&&$K._recoverWebAudio())},$E.initWebAudio=function(){"running"!=$E.ctx.state&&($E._unlock(),$s.document.addEventListener("mousedown",$E._unlock,!0),$s.document.addEventListener("touchend",$E._unlock,!0),$s.document.addEventListener("touchstart",$E._unlock,!0))},$E._emptySource=null,$E._dataCache={},$E.buffs=[],$E.isDecoding=!1,$E._unlocked=!1,$E.tInfo=null,$E.__loadingSound={},$g($E,["window",function(){return this.window=$s.window},"webAudioEnabled",function(){return this.webAudioEnabled=$E.window.AudioContext||$E.window.webkitAudioContext||$E.window.mozAudioContext},"ctx",function(){return this.ctx=$E.webAudioEnabled?new($E.window.AudioContext||$E.window.webkitAudioContext||$E.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$E.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $H}]),$E}(),$F$=function($$){function $b(){this._responseType=null,this._data=null,$b.__super.call(this),this._http=new $s.window.XMLHttpRequest}$e($b,"laya.net.HttpRequest",$H);var $u=$b.prototype;return $u.send=function($$,$b,$u,$Z,$E){void 0===$u&&($u="get"),void 0===$Z&&($Z="text"),this._responseType=$Z,this._data=null;var $r=this,$F=this._http;if($F.open($u,$$,!0),$E)for(var $x=0;$x<$E.length;$x++)$F.setRequestHeader($E[$x++],$E[$x]);else $Y.isConchApp||($b&&"string"!=typeof $b?$F.setRequestHeader("Content-Type","application/json"):$F.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$F.responseType="arraybuffer"!==$Z?"text":"arraybuffer",$F.onerror=function($$){$r._onError($$)},$F.onabort=function($$){$r._onAbort($$)},$F.onprogress=function($$){$r._onProgress($$)},$F.onload=function($$){$r._onLoad($$)},$F.send($b)},$u._onProgress=function($$){$$&&$$.lengthComputable&&this.event("progress",$$.loaded/$$.total)},$u._onAbort=function($$){this.error("Request was aborted by user")},$u._onError=function($$){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$u._onLoad=function($$){var $b=this._http,$u=void 0!==$b.status?$b.status:200;200===$u||204===$u||0===$u?this.complete():this.error("["+$b.status+"]"+$b.statusText+":"+$b.responseURL)},$u.error=function($$){this.clear(),this.event("error",$$)},$u.complete=function(){this.clear();var $b=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$d.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($$){$b=!1,this.error($$.message)}$b&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$u.clear=function(){var $$=this._http;$$.onerror=$$.onabort=$$.onprogress=$$.onload=null},$w(0,$u,"url",function(){return this._http.responseURL}),$w(0,$u,"http",function(){return this._http}),$w(0,$u,"data",function(){return this._data}),$b}(),$x$=function($$){function $t(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$t.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}$e($t,"laya.net.Loader",$H);var $b=$t.prototype;return $b.load=function($$,$b,$u,$Z,$E){if($$&&""!=$$||console.error("Loader 加载的url不合法 "+$$),void 0===$u&&($u=!0),void 0===$E&&($E=!1),0===(this._url=$$).indexOf("data:image")?this._type=$b="image":this._type=$b||($b=this.getTypeFromUrl($$)),this._cache=$u,this._data=null,!$E&&$t.loadedMap[$$])return this._data=$t.loadedMap[$$],this.event("progress",1),void this.event("complete",this._data);if($Z&&$t.setGroup($$,$Z),null!=$t.parserMap[$b])return this._customParse=!0,void($t.parserMap[$b]instanceof laya.utils.Handler?$t.parserMap[$b].runWith(this):$t.parserMap[$b].call(null,this));if("image"===$b||"htmlimage"===$b||"nativeimage"===$b)return this._loadImage($$);if("ttf"===$b)return this._loadTTF($$);switch($b){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$b}$t.preLoadedMap[$$]?this.onLoaded($t.preLoadedMap[$$]):$F.resMgrLoad($$,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$b.getTypeFromUrl=function($$){var $b=$d.getFileExtension($$);return $b?$t.typeMap[$b]:(console.warn("Not recognize the resources suffix",$$),"text")},$b._loadTTF=function($$){$$=$p.formatURL($$);var $b=new $v;$b.complete=$_.create(this,this.onLoaded),$b.load($$)},$b._loadImage=function($$){$F.imgMgrLoad($$,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$b._loadImageComplete=function($$,$b,$u){if(null!=$u)if($u instanceof ArrayBuffer){var $Z=new DataView($u),$E=new laya.webgl.resource.WebGLImage(new Uint8Array($u,8),$$,0,!1,$Z.getUint32(0),$Z.getUint32(4));this.onLoaded($E)}else if($u instanceof $w$)$t.imgMgrSet[$$]=$b,$F.imgMgrLock($$,$t.imgMgrSet[$$]),this._url=$$,this.complete($u);else{var $r=-1!=$$.indexOf(".png",$$.length-4)?6408:6407;$E=new laya.webgl.resource.WebGLImage($u,$$,$r,!1,$u.width,$u.height);this.onLoaded($E)}else this.event("error","Load image failed")},$b.imageCancel=function($$,$b,$u){$F.imgMgrCancel($$,this._onImageCallback)},$b._loadSound=function($$){var $b=new $K._soundClass,$u=this;function $Z(){$b.offAll()}$b.on("complete",this,function(){$Z(),$u.onLoaded($b)}),$b.on("error",this,function(){$Z(),$b.dispose(),$u.event("error","Load sound failed")}),$b.load($$)},$b.onProgress=function($$){"atlas"===this._type?this.event("progress",.3*$$):this.event("progress",$$)},$b.onError=function($$){this.event("error",$$)},$b._loadedComplete=function($$,$b,$u){if(null!=$u)switch(this._type){case"atlas":case"plf":case"json":var $Z=new $m($u);this.onLoaded(JSON.parse($Z.readUTFBytes()));break;case"font":$Z=new $m($u);this.onLoaded($d.parseXMLFromString($Z.readUTFBytes()));break;default:this.onLoaded($u)}else this.event("error",$$)},$b.onLoaded=function($$){var $b=this._type;if("plf"==$b)this.parsePLFData($$),this.complete($$);else if("image"===$b){var $u=new $w$($$);$u.url=this._url,this.complete($u)}else if("sound"===$b||"htmlimage"===$b||"nativeimage"===$b)this.complete($$);else if("atlas"===$b){if(!$$.src&&!$$._setContext){if(!this._data){if((this._data=$$).meta&&$$.meta.image)for(var $Z=$$.meta.image.split(","),$E=0<=this._url.indexOf("/")?"/":"\\",$r=this._url.lastIndexOf($E),$F=0<=$r?this._url.substr(0,$r+1):"",$x=0,$g=$Z.length;$x<$g;$x++)$Z[$x]=$F+$Z[$x];else $Z=[this._url.replace(".json",".png")];$Z.reverse(),$$.toLoads=$Z,$$.pics=[]}return this.event("progress",.3+1/$Z.length*.6),this._loadImage($Z.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($$),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $H=this._data.frames,$w=this._url.split("?")[0],$I=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$w.substring(0,$w.lastIndexOf("."))+"/",$o=this._data.pics,$N=$p.formatURL(this._url),$D=$t.atlasMap[$N]||($t.atlasMap[$N]=[]);$D.dir=$I;var $e=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $L in $e=parseFloat(this._data.meta.scale),$H){var $T,$_=$H[$L],$y=$o[$_.frame.idx?$_.frame.idx:0],$S=$p.formatURL($I+$L);$y.scaleRate=$e,$T=$w$.create($y,$_.frame.x,$_.frame.y,$_.frame.w,$_.frame.h,$_.spriteSourceSize.x,$_.spriteSourceSize.y,$_.sourceSize.w,$_.sourceSize.h),$t.cacheRes($S,$T),$t.keepCache(this._url,$I+$L),$T.url=$S,$D.push($S)}else for($L in $H)$y=$o[($_=$H[$L]).frame.idx?$_.frame.idx:0],$S=$p.formatURL($I+$L),$t.cacheRes($S,$w$.create($y,$_.frame.x,$_.frame.y,$_.frame.w,$_.frame.h,$_.spriteSourceSize.x,$_.spriteSourceSize.y,$_.sourceSize.w,$_.sourceSize.h)),$t.loadedMap[$S].url=$S,$t.keepCache(this._url,$I+$L),$D.push($S);delete this._data.pics,this.complete(this._data)}else if("font"==$b){if(!$$.src)return this._data=$$,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $P=new $C;$P.parseFont(this._data,$$);var $i=this._url.split(".fnt")[0].split("/"),$z=$i[$i.length-1];$L$.registerBitmapFont($z,$P),this._data=$P,this.complete(this._data)}else if("pkm"==$b){var $q=$i$.create($$,this._url),$a=new $w$($q);$a.url=this._url,this.complete($a)}else this.complete($$)},$b.parsePLFData=function($$){var $b,$u,$Z;for($b in $$)switch($Z=$$[$b],$b){case"json":case"text":for($u in $Z)$t.preLoadedMap[$p.formatURL($u)]=$Z[$u];break;default:for($u in $Z)$t.preLoadedMap[$p.formatURL($u)]=$Z[$u]}},$b.complete=function($$){this._data=$$,this._customParse?this.event("loaded",$$ instanceof Array?[$$]:$$):($t._loaders.push(this),$t._isWorking||$t.checkNext())},$b.endLoad=function($$){$$&&(this._data=$$),this._cache&&$t.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$w(0,$b,"url",function(){return this._url}),$w(0,$b,"data",function(){return this._data}),$w(0,$b,"cache",function(){return this._cache}),$w(0,$b,"type",function(){return this._type}),$t.checkNext=function(){$t._isWorking=!0;for(var $$=$s.now();$t._startIndex<$t._loaders.length;)if($s.now(),$t._loaders[$t._startIndex].endLoad(),$t._startIndex++,$s.now()-$$>$t.maxTimeOut)return console.warn("loader callback cost a long time:"+($s.now()-$$)+" url="+$t._loaders[$t._startIndex-1].url),void $z.timer.frameOnce(1,null,$t.checkNext);$t._loaders.length=0,$t._startIndex=0,$t._isWorking=!1},$t.clearRes=function($$,$b){if(null!=$$){void 0===$b&&($b=!1),$$=$p.formatURL($$);var $u=$t.getAtlas($$);if($u){for(var $Z=0,$E=$u.length;$Z<$E;$Z++){var $r=$u[$Z],$F=$t.getRes($r);delete $t.loadedMap[$r],$t.clearCache($$.substring($p.basePath.length),$r.substring($p.basePath.length)),$F&&$F.destroy($b)}$u.length=0,delete $t.atlasMap[$$],delete $t.loadedMap[$$]}else{var $x=$t.loadedMap[$$];$x&&(delete $t.loadedMap[$$],$x instanceof laya.resource.Texture&&$x.bitmap&&$x.destroy($b))}}},$t.clearTextureRes=function($$){$$=$p.formatURL($$);var $b=laya.net.Loader.getAtlas($$),$u=$b&&0<$b.length?laya.net.Loader.getRes($b[0]):laya.net.Loader.getRes($$);$u&&$u.bitmap&&($Y.isConchApp&&!$Y.isConchWebGL?$u.bitmap.source.releaseTexture&&$u.bitmap.source.releaseTexture():null==$u.bitmap._atlaser&&$u.bitmap.releaseResource(!0))},$t.getRes=function($$){return $t.loadedMap[$p.formatURL($$)]},$t.getAtlas=function($$){return $t.atlasMap[$p.formatURL($$)]},$t.cacheRes=function($$,$b){$$=$p.formatURL($$),null!=$t.loadedMap[$$]?console.warn("Resources already exist,is repeated loading:",$$):$t.loadedMap[$$]=$b},$t.setGroup=function($$,$b){$t.groupMap[$b]||($t.groupMap[$b]=[]),$t.groupMap[$b].push($$)},$t.clearResByGroup=function($$){if($t.groupMap[$$]){var $b=$t.groupMap[$$],$u=0,$Z=$b.length;for($u=0;$u<$Z;$u++)$t.clearRes($b[$u]);$b.length=0}},$t.keepCache=function($$,$b){if($$&&$b){var $u=$t.cacheSet[$b];$u?-1==$u.indexOf($$)&&$u.push($$):$t.cacheSet[$b]=[$$]}},$t.clearCache=function($$,$b){if($$&&$b){var $u=$t.cacheSet[$b];if($u){var $Z=$u.indexOf($$);if(-1!==$Z){var $E=$u.length-1;0==$E?(delete $t.cacheSet[$b],0<$t.imgMgrSet[$b]?$F.imgMgrFree($b,$t.imgMgrSet[$b]):$t.clearRes($b,!0)):($u[$Z]=$u[$E],$u.length=$E)}}}},$t.saveObject=function($$,$b,$u){if($b&&$$){var $Z=$t.objectSet[$$];$Z?(console.warn("Loader.saveObject: "+$$),$Z[0]=$b,$Z[1]=$u):$t.objectSet[$$]=[$b,$u,[]]}},$t.findObject=function($$){if($$){var $b=$t.objectSet[$$];if($b)return $b[0]}return null},$t.keepObject=function($$,$b){if($$&&$b){var $u=$t.objectSet[$b];$u&&-1===$u[2].indexOf($$)&&$u[2].push($$)}},$t.clearObject=function($$,$b){if($$&&$b){var $u=$t.objectSet[$b];if($u){var $Z=$u[2],$E=$Z.indexOf($$);if(-1!==$E){var $r=$Z.length-1;0==$r?(delete $t.objectSet[$b],$u[1]&&$u[1].call(null,$u[0])):($Z[$E]=$Z[$r],$Z.length=$r)}}}},$t.TEXT="text",$t.JSON="json",$t.XML="xml",$t.BUFFER="arraybuffer",$t.IMAGE="image",$t.SOUND="sound",$t.ATLAS="atlas",$t.FONT="font",$t.TTF="ttf",$t.PLF="plf",$t.PKM="pkm",$t.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$t.parserMap={},$t.groupMap={},$t.maxTimeOut=100,$t.loadedMap={},$t.preLoadedMap={},$t.atlasMap={},$t._loaders=[],$t._isWorking=!1,$t._startIndex=0,$t.imgCache={},$t.cacheSet={},$t.objectSet={},$t.imgMgrSet={},$t}(),$g$=function($$){var $o;function $N(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$N.__super.call(this);for(var $$=0;$$<this._maxPriority;$$++)this._resInfos[$$]=[]}$e($N,"laya.net.LoaderManager",$H);var $b=$N.prototype;return $b.create=function($$,$u,$b,$Z,$E,$r,$F,$x){if(null==$r&&($r=2),null==$F&&($F=!0),$$ instanceof Array){var $g=$$,$H=$g.length,$w=0;if($b)var $I=$_.create($b.caller,$b.method,$b.args,!1);for(var $o=0;$o<$H;$o++){var $N=$g[$o];"string"==typeof $N&&($N=$g[$o]={url:$N}),$N.progress=0}for($o=0;$o<$H;$o++){$N=$g[$o];var $D=$b?$_.create(null,$T,[$N],!1):null,$e=$b||$u?$_.create(null,$L,[$N]):null;this._create($N.url,$e,$D,$N.clas||$Z,$N.params||$E,null!=$N.priority&&0<=$N.priority?$N.priority:$r,$F,$N.group||$x)}function $L($$,$b){$w++,$$.progress=1,$w===$H&&$u&&$u.run()}function $T($$,$b){$$.progress=$b;for(var $u=0,$Z=0;$Z<$H;$Z++){$u+=$g[$Z].progress}var $E=$u/$H;$I.runWith($E)}return!0}return this._create($$,$u,$b,$Z,$E,$r,$F,$x)},$b._create=function($b,$u,$$,$Z,$E,$r,$F,$x){$b&&""!=$b||console.error("加载的url不合法 "+$b),null==$r&&($r=2),null==$F&&($F=!0);var $g=$p.formatURL($b),$H=this.getRes($g);if($H)!$H.hasOwnProperty("loaded")||$H.loaded?($$&&$$.runWith(1),$u&&$u.run()):$u&&$z.loader._createListener($b,$u.caller,$u.method,$u.args,!0,!1);else{var $w=$d.getFileExtension($b),$I=$N.createMap[$w];if(!$I)throw new Error("LoaderManager:unknown file("+$b+") extension with: "+$w+".");$Z||($Z=$I[0]);var $o=$I[1];if("atlas"==$w)this.load($b,$u,$$,$o,$r,$F);else{$Z===$w$&&($o="htmlimage"),($H=$Z?new $Z:null).hasOwnProperty("_loaded")&&($H._loaded=!1),$H._setUrl($b),$x&&$H._setGroup($x),this._createLoad($H,$b,$_.create(null,function($$){$H&&!$H.destroyed&&$$&&$H.onAsynLoaded.call($H,$b,$$,$E),$u&&$u.run();$z.loader.event($b)}),$$,$o,$r,!1,$x,!0),$F&&this.cacheRes($g,$H)}}return $H},$b.load=function($$,$b,$u,$Z,$E,$r,$F,$x){$$&&""!=$$||console.error("加载的url不合法 "+$$);var $g=this;if(null==$E&&($E=2),null==$r&&($r=!0),void 0===$x&&($x=!1),$$ instanceof Array)return this._loadAssets($$,$b,$u,$Z,$E,$r,$F);var $H=$x$.getRes($$);if(null!=$H)$z.timer.frameOnce(1,null,function(){$u&&$u.runWith(1),$b&&$b.runWith($H),$g._loaderCount||$g.event("complete")});else{var $w=$N._resMap[$$];$w?($b&&$w._createListener("complete",$b.caller,$b.method,$b.args,!1,!1),$u&&$w._createListener("progress",$u.caller,$u.method,$u.args,!1,!1)):(($w=this._infoPool.length?this._infoPool.pop():new $o).url=$$,$w.clas=null,$w.type=$Z,$w.cache=$r,$w.group=$F,$w.ignoreCache=$x,$w.priority=$E,$b&&$w.on("complete",$b.caller,$b.method,$b.args),$u&&$w.on("progress",$u.caller,$u.method,$u.args),$N._resMap[$$]=$w,$E=$E<this._maxPriority?0<=$E?$E:0:this._maxPriority-1,this._resInfos[$E].push($w),this._next())}return this},$b.cancel=function($$,$b,$u){if($H=$N._resMap[$$]){$b&&$H.off("complete",$b.caller,$b.method,!1),$u&&$H.off("progress",$u.caller,$u.method,!1);var $Z=$H.getListener("complete"),$E=$H.getListener("progress");if(!($Z&&$Z.head||$E&&$E.head)){if($H.loader){var $r=$H.loader;$r.imageCancel($$),$r.offAll(),$r._data=null,$r._customParse=!1,$r._url=null,$r._class=null,$r._type=null,this._loaders.push($r),this._loaderCount--,delete this._loaderMap[$H.url]}for(var $F=0;$F<this._maxPriority;$F++)for(var $x=this._resInfos[$F],$g=$x.length-1;-1<$g;$g--){var $H;($H=$x[$g])&&$H.url===$$&&($x[$g]=null,$H.destroy(),$H.offAll(),this._infoPool.push($H))}delete $N._resMap[$$],this._next()}}},$b._createLoad=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){var $H=this;if(null==$r&&($r=2),null==$F&&($F=!0),void 0===$g&&($g=!1),$b instanceof Array)return this._loadAssets($b,$u,$Z,$E,$r,$F,$x);var $w=$x$.getRes($b);if(null!=$w)$z.timer.frameOnce(1,null,function(){$Z&&$Z.runWith(1),$u&&$u.runWith($w),$H._loaderCount||$H.event("complete")});else{var $I=$N._resMap[$b];$I?($u&&$I._createListener("complete",$u.caller,$u.method,$u.args,!1,!1),$Z&&$I._createListener("progress",$Z.caller,$Z.method,$Z.args,!1,!1)):(($I=this._infoPool.length?this._infoPool.pop():new $o).url=$b,$I.clas=$$,$I.type=$E,$I.cache=$F,$I.group=$x,$I.ignoreCache=$g,$I.priority=$r,$u&&$I.on("complete",$u.caller,$u.method,$u.args),$Z&&$I.on("progress",$Z.caller,$Z.method,$Z.args),$N._resMap[$b]=$I,$r=$r<this._maxPriority?0<=$r?$r:0:this._maxPriority-1,this._resInfos[$r].push($I),this._next())}return this},$b._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $$=0;$$<this._maxPriority;$$++)for(var $b=this._resInfos[$$];0<$b.length;){var $u=$b.shift();if($u)return this._doLoad($u)}this._loaderCount||this.event("complete")}},$b._doLoad=function($b){var $u=this._loaders.length?this._loaders.pop():new $x$;this._loaderCount++,(this._loaderMap[$b.url]=$u).on("complete",null,$E),$u.on("progress",null,function($$){$b.event("progress",$$)}),$u.on("error",null,function($$){$E(null)}),$b.loader=$u;var $Z=this;function $E($$){$u.offAll(),$u._data=null,$u._customParse=!1,$u._url=null,$u._class=null,$u._type=null,$Z._loaders.push($u),$Z._loaderCount--,delete $Z._loaderMap[$b.url],$Z._endLoad($b,$$ instanceof Array?[$$]:$$),$Z._next()}$u._class=$b.clas,1<=$b.priority?($u.priority=$b.priority,$u.realTime=!1):($u.priority=0,$u.realTime=!0),$u.load($b.url,$b.type,$b.cache,$b.group,$b.ignoreCache)},$b._endLoad=function($$,$b){var $u=$$.url;if(null==$b){var $Z=this._failRes[$u]||0;if($Z<this.retryNum)return console.warn("[warn]Retry to load:",$u),this._failRes[$u]=$Z+1,void $z.timer.once(this.retryDelay,this,this._addReTry,[$$],!1);console.warn("[error]Failed to load:",$u),this.event("error",$u)}this._failRes[$u]&&(this._failRes[$u]=0),delete $N._resMap[$u],$$.event("complete",$b),$$.destroy(),$$.offAll(),this._infoPool.push($$)},$b._addReTry=function($$){this._resInfos[this._maxPriority-1].push($$),this._next()},$b.clearRes=function($$,$b){void 0===$b&&($b=!1),$x$.clearRes($$,$b)},$b.getRes=function($$){return $x$.getRes($$)},$b.cacheRes=function($$,$b){$x$.cacheRes($$,$b)},$b.clearTextureRes=function($$){$x$.clearTextureRes($$)},$b.setGroup=function($$,$b){$x$.setGroup($$,$b)},$b.clearResByGroup=function($$){$x$.clearResByGroup($$)},$b.clearUnLoaded=function(){for(var $$=0;$$<this._maxPriority;$$++){for(var $b=this._resInfos[$$],$u=$b.length-1;-1<$u;$u--){var $Z=$b[$u];$Z&&($Z.destroy(),$Z.offAll(),this._infoPool.push($Z))}$b.length=0}this._loaderCount=0,$N._resMap={}},$b.cancelLoadByUrls=function($$){if($$)for(var $b=0,$u=$$.length;$b<$u;$b++)this.cancelLoadByUrl($$[$b])},$b.cancelLoadByUrl=function($$){for(var $b=0;$b<this._maxPriority;$b++)for(var $u=this._resInfos[$b],$Z=$u.length-1;-1<$Z;$Z--){var $E=$u[$Z];$E&&$E.url===$$&&($u[$Z]=null,$E.destroy(),$E.offAll(),this._infoPool.push($E))}$N._resMap[$$]&&delete $N._resMap[$$]},$b._loadAssets=function($$,$u,$F,$b,$Z,$E,$r){null==$Z&&($Z=2),null==$E&&($E=!0);for(var $x=$$.length,$g=0,$H=0,$w=[],$I=!0,$o=0;$o<$x;$o++){var $N=$$[$o];if(!$N)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$$);"string"==typeof $N&&($N={url:$N,type:$b,size:1,priority:$Z}),$N.size||($N.size=1),$N.progress=0,$H+=$N.size,$w.push($N);var $D=$F?$_.create(null,$T,[$N],!1):null,$e=$u||$F?$_.create(null,$L,[$N]):null;this.load($N.url,$e,$D,$N.type,null!=$N.priority&&0<=$N.priority?$N.priority:2,$E,$N.group||$r)}function $L($$,$b){$g++,$$.progress=1,$b||($I=!1),$g===$x&&$u&&$u.runWith($I)}function $T($$,$b){if(null!=$F){$$.progress=$b;for(var $u=0,$Z=0;$Z<$w.length;$Z++){var $E=$w[$Z];$u+=$E.size*$E.progress}var $r=$u/$H;$F.runWith($r)}}return this},$N.cacheRes=function($$,$b){$x$.cacheRes($$,$b)},$N._resMap={},$g($N,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$N.__init$=function(){$o=function($$){function $b(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$b.__super.call(this)}return $e($b,"",$H),$b.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},$b}()},$N}(),$H$=(function($$){function $E($$){$E.__super.call(this),$$||($$=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $b=0,$u=0,$Z=0;$Z<20;$Z++)$Z%5!=4?this._mat[$b++]=$$[$Z]:this._alpha[$u++]=$$[$Z];this._action=$O.createFilterAction(32),this._action.data=this}$e($E,"laya.filters.ColorFilter",$T);var $b=$E.prototype;$z.imps($b,{"laya.filters.IFilter":!0}),$b.callNative=function($$){$$._$P.cf=this;$$.conchModel&&$$.conchModel.setFilterMatrix&&$$.conchModel.setFilterMatrix(this._mat,this._alpha)},$w(0,$b,"type",function(){return 32}),$w(0,$b,"action",function(){return this._action})}(),function($$){function $Z($$,$b,$u){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$b&&($b=0),$Z.__super.call(this),this._byteClass=$u||$m,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$$&&0<$b&&$b<65535&&this.connect($$,$b)}$e($Z,"laya.net.Socket",$H);var $b=$Z.prototype;$b.connect=function($$,$b){var $u="ws://"+$$+":"+$b;$u="https:"==$s.window.location.protocol?"wss://"+$$+":"+$b:"ws://"+$$+":"+$b,this.connectByUrl($u)},$b.connectByUrl=function($$){var $b=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $s.window.WebSocket($$,this.protocols):this._socket=new $s.window.WebSocket($$),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($$){$b._onOpen($$)},this._socket.onmessage=function($$){$b._onMessage($$)},this._socket.onclose=function($$){$b._onClose($$)},this._socket.onerror=function($$){$b._onError($$)}},$b.cleanSocket=function(){try{this._socket.close()}catch($$){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$b.close=function(){if(null!=this._socket)try{this._socket.close()}catch($$){}},$b._onOpen=function($$){this._connected=!0,this.event("open",$$)},$b._onMessage=function($$){if($$&&$$.data){var $b=$$.data;if(this.disableInput&&$b)this.event("message",$b);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $u=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$b&&("string"==typeof $b?this._input.writeUTFBytes($b):this._input.writeArrayBuffer($b),this._addInputPosition=this._input.pos,this._input.pos=$u),this.event("message",$b)}}},$b._onClose=function($$){this._connected=!1,this.event("close",$$)},$b._onError=function($$){this.event("error",$$)},$b.send=function($$){this._socket.send($$)},$b.flush=function(){if(this._output&&0<this._output.length){var $b;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($$){$b=$$}this._output.endian=this.endian,this._output.clear(),$b&&this.event("error",$b)}},$w(0,$b,"input",function(){return this._input}),$w(0,$b,"output",function(){return this._output}),$w(0,$b,"connected",function(){return this._connected}),$w(0,$b,"endian",function(){return this._endian},function($$){this._endian=$$,null!=this._input&&(this._input.endian=$$),null!=this._output&&(this._output.endian=$$)}),$Z.LITTLE_ENDIAN="littleEndian",$Z.BIG_ENDIAN="bigEndian"}(),function($$){function $x(){$x.__super.call(this),this._$1__id=++$x._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($x._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$X.currentResourceManager&&$X.currentResourceManager.addResource(this)}$e($x,"laya.resource.Resource",$H);var $b=$x.prototype;return $z.imps($b,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$b._setUrl=function($$){var $b;this._url!==$$&&(this._url&&(($b=$x._urlResourcesMap[this._url]).splice($b.indexOf(this),1),0===$b.length&&delete $x._urlResourcesMap[this._url]),$$&&(($b=$x._urlResourcesMap[$$])||($x._urlResourcesMap[$$]=$b=[]),$b.push(this)),this._url=$$)},$b._getGroup=function(){return this._group},$b._setGroup=function($$){var $b;this._group!==$$&&(this._group&&(($b=$x._groupResourcesMap[this._group]).splice($b.indexOf(this),1),0===$b.length&&delete $x._groupResourcesMap[this._group]),$$&&(($b=$x._groupResourcesMap[$$])||($x._groupResourcesMap[$$]=$b=[]),$b.push(this)),this._group=$$)},$b._addReference=function(){this._referenceCount++},$b._removeReference=function(){this._referenceCount--},$b._clearReference=function(){this._referenceCount=0},$b._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$b.recreateResource=function(){this.completeCreate()},$b.disposeResource=function(){},$b.activeResource=function($$){void 0===$$&&($$=!1),this._lastUseFrameCount=$A.loopCount,!this._destroyed&&this.__loaded&&(this._released||$$)&&this.recreateResource()},$b.releaseResource=function($$){return void 0===$$&&($$=!0),!(!$$&&this.lock)&&(!(this._released&&!$$)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$b.onAsynLoaded=function($$,$b,$u){throw new Error("Resource: must override this function!")},$b.destroy=function(){var $$;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $x._idResourcesMap[this.id],this._url&&(($$=$x._urlResourcesMap[this._url])&&($$.splice($$.indexOf(this),1),0===$$.length&&delete $x._urlResourcesMap[this.url]),$x$.clearRes(this._url),this.__loaded||$O.cancelLoadByUrl(this._url)),this._group&&(($$=$x._groupResourcesMap[this._group]).splice($$.indexOf(this),1),0===$$.length&&delete $x._groupResourcesMap[this.url]))},$b.completeCreate=function(){this._released=!1,this.event("recovered",this)},$b.dispose=function(){this.destroy()},$w(0,$b,"memorySize",function(){return this._memorySize},function($$){var $b=$$-this._memorySize;this._memorySize=$$,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$b),this.resourceManager&&this.resourceManager.addSize($b)}),$w(0,$b,"_loaded",null,function($$){this.__loaded=$$}),$w(0,$b,"loaded",function(){return this.__loaded}),$w(0,$b,"id",function(){return this._$1__id}),$w(0,$b,"destroyed",function(){return this._destroyed}),$w(0,$b,"group",function(){return this._getGroup()},function($$){this._setGroup($$)}),$w(0,$b,"resourceManager",function(){return this._resourceManager}),$w(0,$b,"url",function(){return this._url}),$w(0,$b,"released",function(){return this._released}),$w(0,$b,"referenceCount",function(){return this._referenceCount}),$x.getResourceByID=function($$){return $x._idResourcesMap[$$]},$x.getResourceByURL=function($$,$b){return void 0===$b&&($b=0),null==$x._urlResourcesMap[$$]?null:$x._urlResourcesMap[$$][$b]},$x.getResourceCountByURL=function($$){return $x._urlResourcesMap[$$].length},$x.destroyUnusedResources=function($$){var $b;if($$){var $u=$x._groupResourcesMap[$$];if($u)for(var $Z=$u.slice(),$E=0,$r=$Z.length;$E<$r;$E++)($b=$Z[$E]).lock||0!==$b._referenceCount||$b.destroy()}else for(var $F in $x._idResourcesMap)($b=$x._idResourcesMap[$F]).lock||0!==$b._referenceCount||$b.destroy()},$x._uniqueIDCounter=0,$x._idResourcesMap={},$x._urlResourcesMap={},$x._groupResourcesMap={},$x}()),$w$=function($$){function $t($$,$b){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$t.__super.call(this),$$&&null!=$$._addReference&&$$._addReference(),this.setTo($$,$b)}$e($t,"laya.resource.Texture",$H);var $b=$t.prototype;return $b._setUrl=function($$){this.url=$$},$b.setTo=function($$,$b){if($$ instanceof $F.HTMLElement){var $u=$y$.create("2D",$$);this.bitmap=$u}else this.bitmap=$$;if(this.uv=$b||$t.DEF_UV,$$){this._w=$$.width,this._h=$$.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $Z=this;if(this._loaded)$O.addToAtlas&&$O.addToAtlas($Z);else{var $E=$$;$E instanceof laya.resource.HTMLImage&&$E.image&&$E.image.addEventListener("load",function($$){$O.addToAtlas&&$O.addToAtlas($Z)},!1)}}},$b.active=function(){this.bitmap&&this.bitmap.activeResource()},$b.destroy=function($$){if(void 0===$$&&($$=!1),this.alphaTexture&&(this.alphaTexture.destroy($$),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $b=this.bitmap;$$?($Y.isConchApp&&$b.source&&$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$b.dispose(),$b._clearReference()):($b._removeReference(),0==$b.referenceCount&&($Y.isConchApp&&$b.source&&$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$b.dispose())),this.url&&this===$z.loader.getRes(this.url)&&$z.loader.clearRes(this.url,$$),this._loaded=!1}},$b.load=function($$){var $b=this;this._loaded=!1,$$=$p.customFormat($$);var $u=this.bitmap||(this.bitmap=$i$.create($$));$u.uri=$$,$u&&$u._addReference();var $Z=this;$u.onload=function(){$u.onload=null,$Z._loaded=!0,$b.sourceWidth=$b._w=$u.width,$b.sourceHeight=$b._h=$u.height,$Z.event("loaded",this),$O.addToAtlas&&$O.addToAtlas($Z)}},$b.addTextureToAtlas=function($$){$O.addTextureToAtlas(this)},$b.getPixels=function($$,$b,$u,$Z){if($Y.isConchApp){var $E=this.bitmap;if($E.source&&$E.source.getImageData){var $r=$E.source.getImageData($$,$b,$u,$Z),$F=new Uint8Array($r);return Array.from($F)}return null}return $Y.isWebGL?$O.getTexturePixels(this,$$,$b,$u,$Z):($s.canvas.size($u,$Z),$s.canvas.clear(),$s.context.drawTexture(this,-$$,-$b,this.width,this.height,0,0),$s.context.getImageData(0,0,$u,$Z).data)},$b.onAsynLoaded=function($$,$b){if($b){if("function"!=typeof $b._addReference)throw new Error("bitmap._addReference is not a function. "+$b.className+" "+typeof $b._addReference+" "+$b.constructor);$b._addReference()}this.setTo($b,this.uv),this._loaded&&this.event("loaded",this)},$w(0,$b,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$w(0,$b,"loaded",function(){return this._loaded}),$w(0,$b,"released",function(){return!this.bitmap||this.bitmap.released}),$w(0,$b,"width",function(){return this._w?this._w:this.uv&&this.uv!==$t.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($$){this._w=$$,this.sourceWidth||(this.sourceWidth=$$)}),$w(0,$b,"repeat",function(){return!$Y.isWebGL||!this.bitmap||this.bitmap.repeat},function($$){$$&&$Y.isWebGL&&this.bitmap&&(this.bitmap.repeat=$$)&&(this.bitmap.enableMerageInAtlas=!1)}),$w(0,$b,"height",function(){return this._h?this._h:this.uv&&this.uv!==$t.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($$){this._h=$$,this.sourceHeight||(this.sourceHeight=$$)}),$w(0,$b,"isLinearSampling",function(){return!$Y.isWebGL||9728!=this.bitmap.minFifter},function($$){!$$&&$Y.isWebGL&&($$||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$t.moveUV=function($$,$b,$u){for(var $Z=0;$Z<8;$Z+=2)$u[$Z]+=$$,$u[$Z+1]+=$b;return $u},$t.create=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){void 0===$r&&($r=0),void 0===$F&&($F=0),void 0===$x&&($x=0),void 0===$g&&($g=0);var $H=$$ instanceof laya.resource.Texture,$w=$H?$$.uv:$t.DEF_UV,$I=$H?$$.bitmap:$$,$o=$O.isAtlas($I);if($o){var $N=$I._atlaser,$D=$$._atlasID;if(-1==$D)throw new Error("create texture error");$I=$N._inAtlasTextureBitmapValue[$D],$w=$N._inAtlasTextureOriUVValue[$D]}var $e=new $t($I,null);$I.width&&$b+$Z>$I.width&&($Z=$I.width-$b),$I.height&&$u+$E>$I.height&&($E=$I.height-$u),$e.width=$Z,$e.height=$E,$e.offsetX=$r,$e.offsetY=$F,$e.sourceWidth=$x||$Z,$e.sourceHeight=$g||$E;var $L=1/$I.width,$T=1/$I.height;$b*=$L,$u*=$T,$Z*=$L,$E*=$T;var $_=$e.uv[0],$y=$e.uv[1],$S=$e.uv[4],$P=$e.uv[5],$i=$S-$_,$z=$P-$y,$q=$t.moveUV($w[0],$w[1],[$b,$u,$b+$Z,$u,$b+$Z,$u+$E,$b,$u+$E]);$e.uv=[$_+$q[0]*$i,$y+$q[1]*$z,$S-(1-$q[2])*$i,$y+$q[3]*$z,$S-(1-$q[4])*$i,$P-(1-$q[5])*$z,$_+$q[6]*$i,$P-(1-$q[7])*$z],$o&&$e.addTextureToAtlas();var $a=$I.scaleRate;return $a&&1!=$a?($e.sourceWidth/=$a,$e.sourceHeight/=$a,$e.width/=$a,$e.height/=$a,$e.scaleRate=$a,$e.offsetX/=$a,$e.offsetY/=$a):$e.scaleRate=1,$e},$t.createFromTexture=function($$,$b,$u,$Z,$E){var $r=$$.scaleRate;1!=$r&&($b*=$r,$u*=$r,$Z*=$r,$E*=$r);var $F=$a.TEMP.setTo($b-$$.offsetX,$u-$$.offsetY,$Z,$E),$x=$F.intersection($t._rect1.setTo(0,0,$$.width,$$.height),$t._rect2);if(!$x)return null;var $g=$t.create($$,$x.x,$x.y,$x.width,$x.height,$x.x-$F.x,$x.y-$F.y,$Z,$E);if($g.bitmap&&$g.bitmap._removeReference)return $g.bitmap._removeReference(),$g;var $H="bitmap:"+($g.bitmap?$g.bitmap.constructor?$g.bitmap.constructor.name:$g.bitmap.__className:"")+", url:"+($$.url+" | "+($g.bitmap?$g.bitmap.url:$$.url))+", x="+$b+",y="+$u+",width="+$Z+",height="+$E+", result="+($x?$x.x+","+$x.y+","+$x.width+","+$x.height:"null")+", rect="+$F.x+","+$F.y+","+$F.width+","+$F.height;throw new Error("报错：bitmap._removeReference is not a function  "+$H)},$t.DEF_UV=[0,0,1,0,1,1,0,1],$t.INV_UV=[0,1,1,1,1,0,0,0],$t._rect1=new $a,$t._rect2=new $a,$t}(),$$=function($$){var $x;function $r(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$r.__super.call(this)}$e($r,"laya.utils.TimeLine",$H);var $b=$r.prototype;return $b.to=function($$,$b,$u,$Z,$E){return void 0===$E&&($E=0),this._create($$,$b,$u,$Z,$E,!0)},$b.from=function($$,$b,$u,$Z,$E){return void 0===$E&&($E=0),this._create($$,$b,$u,$Z,$E,!1)},$b._create=function($$,$b,$u,$Z,$E,$r){var $F=$G.getItemByClass("tweenData",$x);return $F.isTo=$r,$F.type=0,$F.target=$$,$F.duration=$u,$F.data=$b,$F.startTime=this._startTime+$E,$F.endTime=$F.startTime+$F.duration,$F.ease=$Z,this._startTime=Math.max($F.endTime,this._startTime),this._tweenDataList.push($F),this._startTimeSort=!0,this._endTimeSort=!0,this},$b.addLabel=function($$,$b){var $u=$G.getItemByClass("tweenData",$x);return $u.type=1,$u.data=$$,$u.endTime=$u.startTime=this._startTime+$b,this._labelDic||(this._labelDic={}),this._labelDic[$$]=$u,this._tweenDataList.push($u),this},$b.removeLabel=function($$){if(this._labelDic&&this._labelDic[$$]){var $b=this._labelDic[$$];if($b){var $u=this._tweenDataList.indexOf($b);-1<$u&&this._tweenDataList.splice($u,1)}delete this._labelDic[$$]}},$b.gotoTime=function($$){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $b,$u,$Z,$E;for(var $r in this._firstTweenDic)if($u=this._firstTweenDic[$r])for(var $F in $u)$u.diyTarget.hasOwnProperty($F)&&($u.diyTarget[$F]=$u[$F]);for($r in this._tweenDic)($b=this._tweenDic[$r]).clear(),delete this._tweenDic[$r];if(this._index=0,this._gidIndex=0,this._currTime=$$,this._lastTime=$s.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$Z=this._tweenDataList.concat(),$Z.sort(function($$,$b){return $$.endTime>$b.endTime?1:$$.endTime<$b.endTime?-1:0})}else $Z=this._endTweenDataList;for(var $x=0,$g=$Z.length;$x<$g;$x++)if(0==($E=$Z[$x]).type){if(!($$>=$E.endTime))break;this._index=Math.max(this._index,$x+1);var $H=$E.data;if($E.isTo)for(var $w in $H)$E.target[$w]=$H[$w]}for($x=0,$g=this._tweenDataList.length;$x<$g;$x++)0==($E=this._tweenDataList[$x]).type&&$$>=$E.startTime&&$$<$E.endTime&&(this._index=Math.max(this._index,$x+1),this._gidIndex++,($b=$G.getItemByClass("tween",$h))._create($E.target,$E.data,$E.duration,$E.ease,$_.create(this,this._animComplete,[this._gidIndex]),0,!1,$E.isTo,!0,!1),$b.setStartTime(this._currTime-($$-$E.startTime)),$b._updateEase(this._currTime),$b.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$b)}},$b.gotoLabel=function($$){if(null!=this._labelDic){var $b=this._labelDic[$$];$b&&this.gotoTime($b.startTime)}},$b.pause=function(){$z.timer.clear(this,this._update)},$b.resume=function(){this.play(this._currTime,this._loopKey)},$b.play=function($$,$b){if(void 0===$$&&($$=0),void 0===$b&&($b=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($$,$b){return $$.startTime>$b.startTime?1:$$.startTime<$b.startTime?-1:0});for(var $u=0,$Z=this._tweenDataList.length;$u<$Z;$u++){var $E=this._tweenDataList[$u];if(null!=$E&&0==$E.type){var $r=$E.target,$F=$r.$_GID||($r.$_GID=$d.getGID()),$x=null;for(var $g in null==this._firstTweenDic[$F]?(($x={}).diyTarget=$r,this._firstTweenDic[$F]=$x):$x=this._firstTweenDic[$F],$E.data)null==$x[$g]&&($x[$g]=$r[$g])}}}"string"==typeof $$?this.gotoLabel($$):this.gotoTime($$),this._loopKey=$b,this._lastTime=$s.now(),$z.timer.frameLoop(1,this,this._update)}},$b._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $$ in this._tweenDic)($b=this._tweenDic[$$]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $b,$u=$s.now(),$Z=$u-this._lastTime,$E=this._currTime+=$Z*this.scale;for($$ in this._lastTime=$u,this._tweenDic)($b=this._tweenDic[$$])._updateEase($E);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $r=this._tweenDataList[this._index];$E>=$r.startTime&&(this._index++,0==$r.type?(this._gidIndex++,($b=$G.getItemByClass("tween",$h))._create($r.target,$r.data,$r.duration,$r.ease,$_.create(this,this._animComplete,[this._gidIndex]),0,!1,$r.isTo,!0,!1),$b.setStartTime($E),$b.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$b)._updateEase($E)):this.event("label",$r.data))}},$b._animComplete=function($$){this._tweenDic[$$]&&delete this._tweenDic[$$]},$b._complete=function(){this.event("complete")},$b.reset=function(){var $$;if(this._labelDic)for($$ in this._labelDic)delete this._labelDic[$$];for($$ in this._tweenDic)this._tweenDic[$$].clear(),delete this._tweenDic[$$];for($$ in this._firstTweenDic)delete this._firstTweenDic[$$];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $b,$u=0;for($b=this._tweenDataList.length,$u=0;$u<$b;$u++)this._tweenDataList[$u]&&this._tweenDataList[$u].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$z.timer.clear(this,this._update)},$b.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$w(0,$b,"index",function(){return this._frameIndex},function($$){this._frameIndex=$$,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$w(0,$b,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$r.to=function($$,$b,$u,$Z,$E){return void 0===$E&&($E=0),(new $r).to($$,$b,$u,$Z,$E)},$r.from=function($$,$b,$u,$Z,$E){return void 0===$E&&($E=0),(new $r).from($$,$b,$u,$Z,$E)},$r.__init$=function(){$x=function(){function $$(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $e($$,""),$$.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$G.recover("tweenData",this)},$$}()},$r}(),$I$=function($E){function $u(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$u.__super.call(this),this._style=$x.EMPTY}$e($u,"laya.display.Sprite",$E);var $$=$u.prototype;return $z.imps($$,{"laya.display.ILayout":!0}),$$.createConchModel=function(){return new ConchNode},$$.destroy=function($$){if(void 0===$$&&($$=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $b=this.mask;$b&&(this.mask=null,$b.destroy($$))}$E.prototype.destroy.call(this,$$),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$$.updateZOrder=function(){$d.updateOrder(this._childs)&&this.repaint()},$$.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$$.setBounds=function($$){this._set$P("uBounds",$$)},$$.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $a),$a._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$$.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $a),$a._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$$._boundPointsToParent=function($$){void 0===$$&&($$=!1);var $b=0,$u=0;this._style&&($b=this._style._tf.translateX,$u=this._style._tf.translateY,$$=$$||0!==this._style._tf.rotate,this._style.scrollRect&&($b+=this._style.scrollRect.x,$u+=this._style.scrollRect.y));var $Z=this._getBoundPointsM($$);if(!$Z||$Z.length<1)return $Z;if(8!=$Z.length&&($Z=$$?$P.scanPList($Z):$a._getWrapRec($Z,$a.TEMP)._getBoundPoints()),!this.transform)return $d.transPointList($Z,this._x-$b,this._y-$u),$Z;var $E=$q.TEMP,$r=0,$F=$Z.length;for($r=0;$r<$F;$r+=2)$E.x=$Z[$r],$E.y=$Z[$r+1],this.toParentPoint($E),$Z[$r]=$E.x,$Z[$r+1]=$E.y;return $Z},$$.getGraphicBounds=function($$){return void 0===$$&&($$=!1),this._graphics?this._graphics.getBounds($$):$a.TEMP.setTo(0,0,0,0)},$$._getBoundPointsM=function($$){if(void 0===$$&&($$=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $b=$d.clearArray(this._$P.temBM),$u=$a.TEMP;return $u.copyFrom(this.scrollRect),$d.concatArray($b,$u._getBoundPoints()),$b}for(var $Z,$E,$r,$F=this._graphics?this._graphics.getBoundPoints():$d.clearArray(this._$P.temBM),$x=0,$g=($r=this._childs).length;$x<$g;$x++)($Z=$r[$x])instanceof laya.display.Sprite&&1==$Z.visible&&($E=$Z._boundPointsToParent($$))&&($F=$F?$d.concatArray($F,$E):$E);return $F},$$.getStyle=function(){return this._style===$x.EMPTY&&(this._style=new $x),this._style},$$.setStyle=function($$){this._style=$$},$$._adjustTransform=function(){this._tfChanged=!1;var $$,$b=this._style._tf,$u=$b.scaleX,$Z=$b.scaleY;if($b.rotate||1!==$u||1!==$Z||$b.skewX||$b.skewY){($$=this._transform||(this._transform=$V.create())).bTransform=!0;var $E=.0174532922222222*($b.rotate-$b.skewX),$r=.0174532922222222*($b.rotate+$b.skewY),$F=Math.cos($r),$x=Math.sin($r),$g=Math.sin($E),$H=Math.cos($E);return $$.a=$u*$F,$$.b=$u*$x,$$.c=-$Z*$g,$$.d=$Z*$H,$$.tx=$$.ty=0,$$}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$$},$$.pos=function($$,$b,$u){if(void 0===$u&&($u=!1),this._x!==$$||this._y!==$b){if(this.destroyed)return this;if($u){this._x=$$,this._y=$b,this.conchModel&&this.conchModel.pos(this._x,this._y);var $Z=this._parent;$Z&&0===$Z._repaint&&($Z._repaint=1,$Z.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$$,this.y=$b}return this},$$.pivot=function($$,$b){return this.pivotX=$$,this.pivotY=$b,this},$$.size=function($$,$b){return this.width=$$,this.height=$b,this},$$.scale=function($$,$b,$u){void 0===$u&&($u=!1);var $Z=this.getStyle(),$E=$Z._tf;if($E.scaleX!=$$||$E.scaleY!=$b){if(this.destroyed)return this;if($u){$Z.setScale($$,$b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($$,$b),this._renderType|=4;var $r=this._parent;$r&&0===$r._repaint&&($r._repaint=1,$r.parentRepaint())}else this.scaleX=$$,this.scaleY=$b}return this},$$.skew=function($$,$b){return this.skewX=$$,this.skewY=$b,this},$$.render=function($$,$b,$u){$A.spriteCount++,$M.renders[this._renderType]._fun(this,$$,$b+this._x,$u+this._y),this._repaint=0},$$.drawToCanvas=function($$,$b,$u,$Z){if($Y.isConchNode){var $E=$y$.create("2D");return new $k($$,$b,$E).ctx.setCanvasType(1),this.conchModel.drawToCanvas($E.source,$u,$Z),$E}return $O.drawToCanvas(this,this._renderType,$$,$b,$u,$Z)},$$.customRender=function($$,$b,$u){this._renderType|=1024},$$._applyFilters=function(){var $$;if(!$Y.isWebGL&&(($$=this._$P.filters)&&!($$.length<1)))for(var $b=0,$u=$$.length;$b<$u;$b++)$$[$b].action.apply(this._$P.cacheCanvas)},$$._isHaveGlowFilter=function(){var $$,$b=0;if(this.filters)for($b=0;$b<this.filters.length;$b++)if(8==this.filters[$b].type)return!0;for($b=0,$$=this._childs.length;$b<$$;$b++)if(this._childs[$b]._isHaveGlowFilter())return!0;return!1},$$.localToGlobal=function($$,$b){void 0===$b&&($b=!1),!0===$b&&($$=new $q($$.x,$$.y));for(var $u=this;$u&&$u!=$z.stage;)$$=$u.toParentPoint($$),$u=$u.parent;return $$},$$.globalToLocal=function($$,$b){void 0===$b&&($b=!1),$b&&($$=new $q($$.x,$$.y));for(var $u=this,$Z=[];$u&&$u!=$z.stage;)$Z.push($u),$u=$u.parent;for(var $E=$Z.length-1;0<=$E;)$$=($u=$Z[$E]).fromParentPoint($$),$E--;return $$},$$.toParentPoint=function($$){if(!$$)return $$;$$.x-=this.pivotX,$$.y-=this.pivotY,this.transform&&this._transform.transformPoint($$),$$.x+=this._x,$$.y+=this._y;var $b=this._style.scrollRect;return $b&&($$.x-=$b.x,$$.y-=$b.y),$$},$$.fromParentPoint=function($$){if(!$$)return $$;$$.x-=this._x,$$.y-=this._y;var $b=this._style.scrollRect;return $b&&($$.x+=$b.x,$$.y+=$b.y),this.transform&&this._transform.invertTransformPoint($$),$$.x+=this.pivotX,$$.y+=this.pivotY,$$},$$.on=function($$,$b,$u,$Z){return 1!==this._mouseEnableState&&this.isMouseEvent($$)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($$,$b,$u,$Z,!1)):$E.prototype.on.call(this,$$,$b,$u,$Z)},$$.once=function($$,$b,$u,$Z){return 1!==this._mouseEnableState&&this.isMouseEvent($$)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($$,$b,$u,$Z,!0)):$E.prototype.once.call(this,$$,$b,$u,$Z)},$$._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $$=this;for($$=$$.parent;$$&&1!==$$._mouseEnableState&&!$$._getBit(2);)$$.mouseEnabled=!0,$$._setBit(2,!0),$$=$$.parent}},$$.loadImage=function($$,$b,$u,$Z,$E,$r){var $F=this;return void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=0),void 0===$E&&($E=0),this.graphics.loadImage($$,$b,$u,$Z,$E,function($$){$F.destroyed||($F.size($b+($Z||$$.width),$u+($E||$$.height)),$F.repaint(),$r&&$r.runWith($$))}),this},$$.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$$._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$$._childChanged=function($$){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$$&&this._get$P("hasZorder")&&$z.timer.callLater(this,this.updateZOrder),this.repaint()},$$.parentRepaint=function(){var $$=this._parent;$$&&0===$$._repaint&&($$._repaint=1,$$.parentRepaint())},$$.startDrag=function($$,$b,$u,$Z,$E,$r,$F){void 0===$b&&($b=!1),void 0===$u&&($u=0),void 0===$Z&&($Z=300),void 0===$r&&($r=!1),void 0===$F&&($F=.92),this._$P.dragging||this._set$P("dragging",new $f),this._$P.dragging.start(this,$$,$b,$u,$Z,$E,$r,$F)},$$.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$$._releaseMem=function(){if(this._$P){var $$=this._$P.cacheCanvas;$$&&$$.ctx&&($G.recover("RenderContext",$$.ctx),$$.ctx.canvas.size(0,0),$$.ctx=null);var $b=this._$P._filterCache;$b&&($b.destroy(),$b.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$$._setDisplay=function($$){$$||this._releaseMem(),$E.prototype._setDisplay.call(this,$$)},$$.hitTestPoint=function($$,$b){var $u=this.globalToLocal($q.TEMP.setTo($$,$b));return $$=$u.x,$b=$u.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$a.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($$,$b)},$$.getMousePoint=function(){return this.globalToLocal($q.TEMP.setTo($z.stage.mouseX,$z.stage.mouseY))},$$._getWords=function(){return null},$$._addChildsToLayout=function($$){var $b=this._getWords();if(null==$b&&0==this._childs.length)return!1;if($b)for(var $u=0,$Z=$b.length;$u<$Z;$u++)$$.push($b[$u]);$u=0;for(var $E=this._childs.length;$u<$E;++$u){var $r=this._childs[$u];$r._style._enableLayout()&&$r._addToLayout($$)}return!0},$$._addToLayout=function($$){this._style.absolute||(this._style.block?$$.push(this):this._addChildsToLayout($$)&&(this.x=this.y=0))},$$._isChar=function(){return!1},$$._getCSSStyle=function(){return this._style.getCSSStyle()},$$._setAttributes=function($$,$b){switch($$){case"x":this.x=parseFloat($b);break;case"y":this.y=parseFloat($b);break;case"width":this.width=parseFloat($b);break;case"height":this.height=parseFloat($b);break;default:this[$$]=$b}},$$._layoutLater=function(){this.parent&&this.parent._layoutLater()},$w(0,$$,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($$){this._optimizeScrollRect!=$$&&(this._optimizeScrollRect=$$,this.conchModel&&this.conchModel.optimizeScrollRect($$))}),$w(0,$$,"customRenderEnable",null,function($$){if($$&&(this._renderType|=1024,$Y.isConchNode)){$u.CustomList.push(this);var $b=new $y$("2d");$b._setContext(new CanvasRenderingContext2D),this.customContext=new $k(0,0,$b),$b.context.setCanvasType&&$b.context.setCanvasType(2),this.conchModel.custom($b.context)}}),$w(0,$$,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($$){this.cacheAs=$$?this._$P.hasFilter?"none":"normal":"none"}),$w(0,$$,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($$){var $b=this._$P.cacheCanvas;if($$!==($b?$b.type:"none")){if("none"!==$$)this._getBit(1)||this._setUpNoticeType(1),$b||($b=this._set$P("cacheCanvas",$G.getItemByClass("cacheCanvas",Object))),$b.type=$$,$b.reCache=!0,this._renderType|=16,"bitmap"==$$&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($b){var $u=$b;$u&&$u.ctx&&($G.recover("RenderContext",$u.ctx),$u.ctx.canvas.size(0,0),$u.ctx=null),$G.recover("cacheCanvas",$b)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$w(0,$$,"zOrder",function(){return this._zOrder},function($$){this._zOrder!=$$&&(this._zOrder=$$,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($$),this._parent&&($$&&this._parent._set$P("hasZorder",!0),$z.timer.callLater(this._parent,this.updateZOrder)))}),$w(0,$$,"rotation",function(){return this._style._tf.rotate},function($$){var $b=this.getStyle();if($b._tf.rotate!==$$){$b.setRotate($$),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($$),this._renderType|=4;var $u=this._parent;$u&&0===$u._repaint&&($u._repaint=1,$u.parentRepaint())}}),$w(0,$$,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($$){this._width!==$$&&(this._width=$$,this.conchModel&&this.conchModel.size($$,this._height),this.repaint())}),$w(0,$$,"x",function(){return this._x},function($$){if(this._x!==$$){if(this.destroyed)return;this._x=$$,this.conchModel&&this.conchModel.pos($$,this._y);var $b=this._parent;$b&&0===$b._repaint&&($b._repaint=1,$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$w(0,$$,"globalScaleY",function(){for(var $$=1,$b=this;$b&&$b!==$z.stage;)$$*=$b.scaleY,$b=$b.parent;return $$}),$w(0,$$,"hitArea",function(){return this._$P.hitArea},function($$){this._set$P("hitArea",$$)}),$w(0,$$,"staticCache",function(){return this._$P.staticCache},function($$){this._set$P("staticCache",$$),$$||this.reCache()}),$w(0,$$,"texture",function(){return this._texture},function($$){this._texture!=$$&&(this._texture=$$,this.graphics.cleanByTexture($$,0,0))}),$w(0,$$,"y",function(){return this._y},function($$){if(this._y!==$$){if(this.destroyed)return;this._y=$$,this.conchModel&&this.conchModel.pos(this._x,$$);var $b=this._parent;$b&&0===$b._repaint&&($b._repaint=1,$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$w(0,$$,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($$){this._height!==$$&&(this._height=$$,this.conchModel&&this.conchModel.size(this._width,$$),this.repaint())}),$w(0,$$,"blendMode",function(){return this._style.blendMode},function($$){this.getStyle().blendMode=$$,this.conchModel&&this.conchModel.blendMode($$),$$&&"source-over"!=$$?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$w(0,$$,"scaleX",function(){return this._style._tf.scaleX},function($$){var $b=this.getStyle();if($b._tf.scaleX!==$$){$b.setScaleX($$),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($$,$b._tf.scaleY),this._renderType|=4;var $u=this._parent;$u&&0===$u._repaint&&($u._repaint=1,$u.parentRepaint())}}),$w(0,$$,"scaleY",function(){return this._style._tf.scaleY},function($$){var $b=this.getStyle();if($b._tf.scaleY!==$$){$b.setScaleY($$),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($b._tf.scaleX,$$),this._renderType|=4;var $u=this._parent;$u&&0===$u._repaint&&($u._repaint=1,$u.parentRepaint())}}),$w(0,$$,"stage",function(){return $z.stage}),$w(0,$$,"skewX",function(){return this._style._tf.skewX},function($$){var $b=this.getStyle();if($b._tf.skewX!==$$){$b.setSkewX($$),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($$,$b._tf.skewY),this._renderType|=4;var $u=this._parent;$u&&0===$u._repaint&&($u._repaint=1,$u.parentRepaint())}}),$w(0,$$,"scrollRect",function(){return this._style.scrollRect},function($$){this.getStyle().scrollRect=$$,this.repaint(),$$?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($$.x,$$.y,$$.width,$$.height)):(this._renderType&=-129,this.conchModel&&($u.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$w(0,$$,"skewY",function(){return this._style._tf.skewY},function($$){var $b=this.getStyle();if($b._tf.skewY!==$$){$b.setSkewY($$),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($b._tf.skewX,$$),this._renderType|=4;var $u=this._parent;$u&&0===$u._repaint&&($u._repaint=1,$u.parentRepaint())}}),$w(0,$$,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($$){this._tfChanged=!1,(this._transform=$$)&&(this._x=$$.tx,this._y=$$.ty,$$.tx=$$.ty=0,this.conchModel&&this.conchModel.transform($$.a,$$.b,$$.c,$$.d,this._x,this._y)),$$?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$w(0,$$,"pivotX",function(){return this._style._tf.translateX},function($$){this.getStyle().setTranslateX($$),this.conchModel&&this.conchModel.pivot($$,this._style._tf.translateY),this.repaint()}),$w(0,$$,"pivotY",function(){return this._style._tf.translateY},function($$){this.getStyle().setTranslateY($$),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$$),this.repaint()}),$w(0,$$,"alpha",function(){return this._style.alpha},function($$){this._style&&this._style.alpha!==$$&&($$=$$<0?0:1<$$?1:$$,this.getStyle().alpha=$$,this.conchModel&&this.conchModel.alpha($$),1!==$$?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$w(0,$$,"visible",function(){return this._style.visible},function($$){this._style&&this._style.visible!==$$&&(this.getStyle().visible=$$,this.conchModel&&this.conchModel.visible($$),this.parentRepaint())}),$w(0,$$,"graphics",function(){return this._graphics||(this.graphics=$O.createGraphics())},function($$){this._graphics&&(this._graphics._sp=null),(this._graphics=$$)?(this._renderType&=-2,this._renderType|=512,($$._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($u.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$w(0,$$,"filters",function(){return this._$P.filters},function($$){$$&&0===$$.length&&($$=null),this._$P.filters!=$$&&(this._set$P("filters",$$?$$.slice():null),$Y.isConchApp&&(this.conchModel&&($u.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$Y.isWebGL&&($$&&$$.length?this._renderType|=32:this._renderType&=-33),$$&&0<$$.length?(this._getBit(1)||this._setUpNoticeType(1),$Y.isWebGL&&1==$$.length&&$$[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($Y.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$w(0,$$,"parent",$E.prototype._$get_parent,function($$){$z.superSet($$$,this,"parent",$$),$$&&this._getBit(2)&&this._$2__onDisplay()}),$w(0,$$,"mask",function(){return this._$P._mask},function($$){$$&&this.mask&&this.mask._$P.maskParent||($$?(this.cacheAs="bitmap",this._set$P("_mask",$$),$$._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$$),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($$?$$.conchModel:null),this._renderType|=64,this.parentRepaint())}),$w(0,$$,"mouseEnabled",function(){return 1<this._mouseEnableState},function($$){this._mouseEnableState=$$?2:1}),$w(0,$$,"globalScaleX",function(){for(var $$=1,$b=this;$b&&$b!==$z.stage;)$$*=$b.scaleX,$b=$b.parent;return $$}),$w(0,$$,"mouseX",function(){return this.getMousePoint().x}),$w(0,$$,"mouseY",function(){return this.getMousePoint().y}),$u.fromImage=function($$){return(new $u).loadImage($$)},$u._cachePool=[],$u.CustomList=[],$g($u,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$F.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$u}($$$),$o$=function($$){function $b($$){this._audio=null,this._onEnd=null,this._resumePlay=null,$b.__super.call(this),this._onEnd=$d.bind(this.__onEnd,this),this._resumePlay=$d.bind(this.__resumePlay,this),$$.addEventListener("ended",this._onEnd),this._audio=$$}$e($b,"laya.media.h5audio.AudioSoundChannel",$Z$);var $u=$b.prototype;return $u.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$u.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$s.container.appendChild(this._audio),this._audio.play()}catch($$){this.event("error")}},$u.play=function($$){this.isStopped=!1;try{this._audio.playbackRate=$K.playbackRate,this._audio.currentTime=this.startTime}catch($$){return void this._audio.addEventListener("canplay",this._resumePlay)}$K.addChannel(this),$s.container.appendChild(this._audio),!$$&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$u.stop=function(){this.isStopped=!0,$K.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$Y.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$s.onIE||this._audio!=$u$._musicAudio&&$G.recover("audio:"+this.url,this._audio),$s.removeElement(this._audio),this._audio=null)},$u.pause=function(){this.isStopped=!0,$K.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$u.resume=function(){this._audio&&(this.isStopped=!1,$K.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$w(0,$u,"position",function(){return this._audio?this._audio.currentTime:0}),$w(0,$u,"duration",function(){return this._audio?this._audio.duration:0}),$w(0,$u,"volume",function(){return this._audio?this._audio.volume:1},function($$){this._audio&&(this._audio.volume=$$)}),$b}(),$N$=function($$){function $b(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$r$.ctx,$b.__super.call(this),this._onPlayEnd=$d.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$e($b,"laya.media.webaudio.WebAudioSoundChannel",$Z$);var $u=$b.prototype;return $u.play=function($$){if($K.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $b=this.context,$u=this.gain,$Z=$b.createBufferSource();(this.bufferSource=$Z).buffer=this.audioBuffer,$Z.connect($u),$u&&$u.disconnect(),$u.connect($b.destination),$Z.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$s.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($Z.loop=!0),$Z.playbackRate.setTargetAtTime?$Z.playbackRate.setTargetAtTime($K.playbackRate,this.context.currentTime,.1):$Z.playbackRate.value=$K.playbackRate,$Z.start(0,this.startTime),!$$&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$u.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$u._clearBufferSource=function(){if(this.bufferSource){var $$=this.bufferSource;$$.stop?$$.stop(0):$$.noteOff(0),$$.disconnect(0),$$.onended=null,$b._tryCleanFailed||this._tryClearBuffer($$),this.bufferSource=null}},$u._tryClearBuffer=function($$){try{$$.buffer=null}catch($$){$b._tryCleanFailed=!0}},$u.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$K.removeChannel(this),this.startHandler=null,this.completeHandler=null},$u.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$K.removeChannel(this)},$u.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$w(0,$u,"position",function(){return this.bufferSource?($s.now()-this._startTime)/1e3+this.startTime:0}),$w(0,$u,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$w(0,$u,"volume",function(){return this._volume},function($$){this.isStopped||(this._volume=$$,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($$,this.context.currentTime,.1):this.gain.gain.value=$$)}),$b._tryCleanFailed=!1,$b}(),$D$=function($$){function $b(){$b.__super.call(this),this._w=0,this._h=0}$e($b,"laya.resource.Bitmap",$H$);var $u=$b.prototype;return $w(0,$u,"width",function(){return this._w}),$w(0,$u,"height",function(){return this._h}),$w(0,$u,"source",function(){return this._source}),$b}(),$e$=function($b){function $$(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$$.__super.call(this),this._interval=$Z.animationInterval,this._setUpNoticeType(1)}$e($$,"laya.display.AnimationPlayerBase",$b);var $u=$$.prototype;return $u.play=function($$,$b,$u,$Z){void 0===$$&&($$=0),void 0===$b&&($b=!0),void 0===$u&&($u=""),void 0===$Z&&($Z=!0),this._isPlaying=!0,this.index="string"==typeof $$?this._getFrameByLabel($$):$$,this.loop=$b,this._actionName=$u,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$u._getFrameByLabel=function($$){var $b=0;for($b=0;$b<this._count;$b++)if(this._labels[$b]&&0<=this._labels[$b].indexOf($$))return $b;return 0},$u._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$u._setControlNode=function($$){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$$)&&$$!=this&&($$.on("display",this,this._checkResumePlaying),$$.on("undisplay",this,this._checkResumePlaying))},$u._setDisplay=function($$){$b.prototype._setDisplay.call(this,$$),this._checkResumePlaying()},$u._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$u.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$u.addLabel=function($$,$b){this._labels||(this._labels={}),this._labels[$b]||(this._labels[$b]=[]),this._labels[$b].push($$)},$u.removeLabel=function($$){if($$){if(this._labels)for(var $b in this._labels)this._removeLabelFromLabelList(this._labels[$b],$$)}else this._labels=null},$u._removeLabelFromLabelList=function($$,$b){if($$)for(var $u=$$.length-1;0<=$u;$u--)$$[$u]==$b&&$$.splice($u,1)},$u.gotoAndStop=function($$){this.index="string"==typeof $$?this._getFrameByLabel($$):$$,this.stop()},$u._displayToIndex=function($$){},$u.clear=function(){this.stop(),this._labels=null},$w(0,$u,"interval",function(){return this._interval},function($$){this._interval!=$$&&(this._frameRateChanged=!0,this._interval=$$,this._isPlaying&&0<$$&&this.timerLoop($$,this,this._frameLoop,null,!0,!0))}),$w(0,$u,"isPlaying",function(){return this._isPlaying}),$w(0,$u,"index",function(){return this._index},function($$){if(this._index=$$,this._displayToIndex($$),this._labels&&this._labels[$$])for(var $b=this._labels[$$],$u=0,$Z=$b.length;$u<$Z;$u++)this.event("label",$b[$u])}),$w(0,$u,"count",function(){return this._count}),$$.WRAP_POSITIVE=0,$$.WRAP_REVERSE=1,$$.WRAP_PINGPONG=2,$$}($I$),$L$=function($b){function $N(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$N.__super.call(this),this.overflow=$N.VISIBLE,this._style=new $b$(this),this._style.wordWrap=!1}$e($N,"laya.display.Text",$b);var $$=$N.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$$._getBoundPointsM=function($$){void 0===$$&&($$=!1);var $b=$a.TEMP;return $b.setTo(0,0,this.width,this.height),$b._getBoundPoints()},$$.getGraphicBounds=function($$){void 0===$$&&($$=!1);var $b=$a.TEMP;return $b.setTo(0,0,this.width,this.height),$b},$$._getCSSStyle=function(){return this._style},$$.lang=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w){if($$=$N.langPacks&&$N.langPacks[$$]?$N.langPacks[$$]:$$,arguments.length<2)this._text=$$;else{for(var $I=0,$o=arguments.length;$I<$o;$I++)$$=$$.replace("{"+$I+"}",arguments[$I+1]);this._text=$$}},$$._isPassWordMode=function(){var $$=this._style.password;return"prompt"in this&&this.prompt==this._text&&($$=!1),$$},$$._getPassWordTxt=function($$){var $b;$b="";for(var $u=$$.length;0<$u;$u--)$b+="●";return $b},$$.renderText=function($$,$b){var $u=this.graphics;$u.clear(!0);var $Z=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($s.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$s.context.font=$Z;var $E=this.padding,$r=$E[3],$F="left",$x=this._lines,$g=this.leading+this._charSize.height,$H=this._currBitmapFont;$H&&($g=this.leading+$H.getMaxHeight());var $w=$E[0];if(!$H&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($F="right",$r=this._width-$E[1]):"center"==this.align&&($F="center",$r=.5*this._width+$E[3]-$E[1])),0<this._height){var $I=this._textHeight>this._height?"top":this.valign;"middle"===$I?$w=.5*(this._height-$b*$g)+$E[0]-$E[2]:"bottom"===$I&&($w=this._height-$b*$g-$E[2])}var $o=this._style;if($H&&$H.autoScaleSize)var $N=$H.fontSize/this.fontSize;if(this._clipPoint)if($u.save(),$H&&$H.autoScaleSize){var $D=0,$e=0;$D=this._width?this._width-$E[3]-$E[1]:this._textWidth,$e=this._height?this._height-$E[0]-$E[2]:this._textHeight,$D*=$N,$e*=$N,$u.clipRect($E[3],$E[0],$D,$e)}else $u.clipRect($E[3],$E[0],this._width?this._width-$E[3]-$E[1]:this._textWidth,this._height?this._height-$E[0]-$E[2]:this._textHeight);var $L=$o.password;"prompt"in this&&this.prompt==this._text&&($L=!1);for(var $T=0,$_=0,$y=Math.min(this._lines.length,$b+$$)||1,$S=$$;$S<$y;$S++){var $P,$i=$x[$S];if($L){var $z=$i.length;$i="";for(var $q=$z;0<$q;$q--)$i+="●"}if($T=$r-(this._clipPoint?this._clipPoint.x:0),$_=$w+$g*$S-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($F,$T,$_,$S),$H){var $a=this.width;$H.autoScaleSize&&($a=this.width*$N),$H.drawText($i,this,$T,$_,this.align,$a)}else $Y.isWebGL?(this._words||(this._words=[]),($P=this._words.length>$S-$$?this._words[$S-$$]:new $R).setText($i)):$P=$i,$o.stroke?$u.fillBorderText($P,$T,$_,$Z,this.color,$o.strokeColor,$o.stroke,$F):$u.fillText($P,$T,$_,$Z,this.color,$F)}if($H&&$H.autoScaleSize){var $t=1/$N;this.scale($t,$t)}this._clipPoint&&$u.restore(),this._startX=$r,this._startY=$w},$$.drawUnderline=function($$,$b,$u,$Z){var $E=this._lineWidths[$Z];switch($$){case"center":$b-=$E/2;break;case"right":$b-=$E}$u+=this._charSize.height,this._graphics.drawLine($b,$u,$b+$E,$u,this.underlineColor||this.color,1)},$$.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$s.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $q(0,0)):this._clipPoint=null;var $$=this._lines.length;if(this.overflow!=$N.VISIBLE){var $b=this.overflow==$N.HIDDEN?Math.floor:Math.ceil;$$=Math.min($$,$b((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $u=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($u,$$),this.repaint()},$$.evalTextSize=function(){var $$,$b=NaN;$$=Math.max.apply(this,this._lineWidths),$b=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$$==this._textWidth&&$b==this._textHeight||(this._textWidth=$$,this._textHeight=$b,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$$.checkEnabledViewportOrNot=function(){return this.overflow==$N.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$$.changeText=function($$){this._text!==$$&&(this.lang($$+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$$.parseLines=function($$){var $b=this.wordWrap||this.overflow==$N.HIDDEN;if($b)var $u=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $Z=$d.contextMeasureText($N._testWord);$Y.isConchApp&&0===$Z.width&&0===$Z.height&&($Z=$d.contextMeasureText("W")),this._charSize.width=$Z.width,this._charSize.height=$Z.height||this.fontSize}for(var $E=$$.replace(/\r\n/g,"\n").split("\n"),$r=0,$F=$E.length;$r<$F;$r++){var $x=$E[$r];$b?this.parseLine($x,$u):(this._lineWidths.push(this.getTextWidth($x)),this._lines.push($x))}},$$.parseLine=function($$,$b){$s.context;var $u,$Z=this._lines,$E=0,$r=NaN,$F=NaN,$x=0;if(($r=this.getTextWidth($$))<=$b)return $Z.push($$),void this._lineWidths.push($r);$r=this._charSize.width,0==($E=Math.floor($b/$r))&&($E=1),$F=$r=this.getTextWidth($$.substring(0,$E));for(var $g=$E,$H=$$.length;$g<$H;$g++)if($b<($F+=$r=this.getTextWidth($$.charAt($g))))if(this.wordWrap){var $w=$$.substring($x,$g);if($w.charCodeAt($w.length-1)<255?($u=/(?:\w|-)+$/.exec($w))&&($g=$u.index+$x,0==$u.index?$g+=$w.length:$w=$$.substring($x,$g)):$N.RightToLeft&&($u=/([\u0600-\u06FF])+$/.exec($w))&&($g=$u.index+$x,0==$u.index?$g+=$w.length:$w=$$.substring($x,$g)),$Z.push($w),this._lineWidths.push($F-$r),!(($x=$g)+$E<$H)){$Z.push($$.substring($x,$H)),this._lineWidths.push(this.getTextWidth($Z[$Z.length-1])),$x=-1;break}$g+=$E,$F=$r=this.getTextWidth($$.substring($x,$g)),$g--}else if(this.overflow==$N.HIDDEN)return $Z.push($$.substring(0,$g)),void this._lineWidths.push(this.getTextWidth($Z[$Z.length-1]));this.wordWrap&&-1!=$x&&($Z.push($$.substring($x,$H)),this._lineWidths.push(this.getTextWidth($Z[$Z.length-1])))},$$.getTextWidth=function($$){return this._currBitmapFont?this._currBitmapFont.getTextWidth($$):$d.contextMeasureText($$).width},$$.getWordWrapWidth=function(){var $$=this.padding,$b=NaN;return($b=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($b=this.wordWrap?100:$s.width),$b<=0&&($b=100),$b-$$[3]-$$[1]},$$.getCharPoint=function($$,$b){this._isChanged&&$z.timer.runCallLater(this,this.typeset);for(var $u=0,$Z=this._lines,$E=0,$r=0,$F=$Z.length;$r<$F;$r++){if($$<($u+=$Z[$r].length)){var $x=$r;break}$E=$u}var $g=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$s.context.font=$g;var $H=this.getTextWidth(this._text.substring($E,$$));return($b||new $q).setTo(this._startX+$H-(this._clipPoint?this._clipPoint.x:0),this._startY+$x*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$w(0,$$,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($$){$$!=this._width&&($z.superSet($I$,this,"width",$$),this.isChanged=!0)}),$w(0,$$,"textWidth",function(){return this._isChanged&&$z.timer.runCallLater(this,this.typeset),this._textWidth}),$w(0,$$,"height",function(){return this._height?this._height:this.textHeight},function($$){$$!=this._height&&($z.superSet($I$,this,"height",$$),this.isChanged=!0)}),$w(0,$$,"textHeight",function(){return this._isChanged&&$z.timer.runCallLater(this,this.typeset),this._textHeight}),$w(0,$$,"padding",function(){return this._getCSSStyle().padding},function($$){this._getCSSStyle().padding=$$,this.isChanged=!0}),$w(0,$$,"bold",function(){return this._getCSSStyle().bold},function($$){this._getCSSStyle().bold=$$,this.isChanged=!0}),$w(0,$$,"text",function(){return this._text||""},function($$){this._text!==$$&&(this.lang($$+""),this.isChanged=!0,this.event("change"))}),$w(0,$$,"color",function(){return this._getCSSStyle().color},function($$){this._getCSSStyle().color!=$$&&(this._getCSSStyle().color=$$,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$w(0,$$,"font",function(){return this._getCSSStyle().fontFamily},function($$){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$N._bitmapFonts&&$N._bitmapFonts[$$]&&(this._currBitmapFont=$N._bitmapFonts[$$]),this._getCSSStyle().fontFamily=$$,this.isChanged=!0}),$w(0,$$,"fontSize",function(){return this._getCSSStyle().fontSize},function($$){this._getCSSStyle().fontSize=$$,this.isChanged=!0}),$w(0,$$,"italic",function(){return this._getCSSStyle().italic},function($$){this._getCSSStyle().italic=$$,this.isChanged=!0}),$w(0,$$,"align",function(){return this._getCSSStyle().align},function($$){this._getCSSStyle().align=$$,this.isChanged=!0}),$w(0,$$,"valign",function(){return this._getCSSStyle().valign},function($$){this._getCSSStyle().valign=$$,this.isChanged=!0}),$w(0,$$,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($$){this._getCSSStyle().wordWrap=$$,this.isChanged=!0}),$w(0,$$,"leading",function(){return this._getCSSStyle().leading},function($$){this._getCSSStyle().leading=$$,this.isChanged=!0}),$w(0,$$,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($$){this._getCSSStyle().backgroundColor=$$,this.isChanged=!0}),$w(0,$$,"borderColor",function(){return this._getCSSStyle().borderColor},function($$){this._getCSSStyle().borderColor=$$,this.isChanged=!0}),$w(0,$$,"stroke",function(){return this._getCSSStyle().stroke},function($$){this._getCSSStyle().stroke=$$,this.isChanged=!0}),$w(0,$$,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($$){this._getCSSStyle().strokeColor=$$,this.isChanged=!0}),$w(0,$$,"isChanged",null,function($$){this._isChanged!==$$&&(this._isChanged=$$)&&$z.timer.callLater(this,this.typeset)}),$w(0,$$,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($$){if(!(this.overflow!=$N.SCROLL||this.textWidth<this._width)&&this._clipPoint){$$=$$<this.padding[3]?this.padding[3]:$$;var $b=this._textWidth-this._width;$$=$b<$$?$b:$$;var $u=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$$,this.renderText(this._lastVisibleLineIndex,$u)}}),$w(0,$$,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($$){if(!(this.overflow!=$N.SCROLL||this.textHeight<this._height)&&this._clipPoint){$$=$$<this.padding[0]?this.padding[0]:$$;var $b=this._textHeight-this._height,$u=($$=$b<$$?$b:$$)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$u;var $Z=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$$,this.renderText($u,$Z)}}),$w(0,$$,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$w(0,$$,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$w(0,$$,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$w(0,$$,"underlineColor",function(){return this._underlineColor},function($$){this._underlineColor=$$,this._isChanged=!0,this.typeset()}),$N.registerBitmapFont=function($$,$b){$N._bitmapFonts||($N._bitmapFonts={}),$N._bitmapFonts[$$]=$b},$N.unregisterBitmapFont=function($$,$b){if(void 0===$b&&($b=!0),$N._bitmapFonts&&$N._bitmapFonts[$$]){var $u=$N._bitmapFonts[$$];$b&&$u.destroy(),delete $N._bitmapFonts[$$]}},$N.setTextRightToLeft=function(){var $$;($$=$s.canvas.source.style).display="none",$$.position="absolute",$$.direction="rtl",$Y._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$s.document.body.appendChild($s.canvas.source)},$N.supportFont=function($$){$s.context.font="10px sans-serif";var $b=$d.contextMeasureText("abcji").width;$s.context.font="10px "+$$;var $u=$d.contextMeasureText("abcji").width;return console.log($b,$u),$b!==$u},$N._testWord="游",$N.langPacks=null,$N.VISIBLE="visible",$N.SCROLL="scroll",$N.HIDDEN="hidden",$N.CharacterCache=!0,$N.RightToLeft=!1,$N._bitmapFonts=null,$g($N,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$N}($I$),$T$=function($I){function $F(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$F.__super.call(this),this.offset=new $q,this._canvasTransform=new $V,this._previousOrientation=$s.window.orientation;var $b=this;this.transform=$V.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $$=$s.window,$u=this;$$.addEventListener("focus",function(){$b._isFocused=!0,$u.event("focus"),$u.event("focuschange")}),$$.addEventListener("blur",function(){$b._isFocused=!1,$u.event("blur"),$u.event("focuschange"),$u._isInputting()&&($P$.inputElement.target.focus=!1)});var $Z="visibilityState",$E="visibilitychange",$r=$$.document;void 0!==$r.hidden?($E="visibilitychange",$Z="visibilityState"):void 0!==$r.mozHidden?($E="mozvisibilitychange",$Z="mozVisibilityState"):void 0!==$r.msHidden?($E="msvisibilitychange",$Z="msVisibilityState"):void 0!==$r.webkitHidden&&($E="webkitvisibilitychange",$Z="webkitVisibilityState"),$$.document.addEventListener($E,function(){"hidden"==$s.document[$Z]?$u._setStageVisible(!1):$u._setStageVisible(!0)}),$$.document.addEventListener("qbrowserVisibilityChange",function($$){$u._setStageVisible(!$$.hidden)}),$$.addEventListener("resize",function(){var $$=$s.window.orientation;null!=$$&&$$!=$b._previousOrientation&&$u._isInputting()&&($P$.inputElement.target.focus=!1),$b._previousOrientation=$$,$u._isInputting()||$u._resetCanvas()}),$$.addEventListener("orientationchange",function($$){$u._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$s.onMobile&&this.on("mousedown",this,this._onmouseMove)}$e($F,"laya.display.Stage",$I);var $$=$F.prototype;return $$._setStageVisible=function($$){this._isVisibility!=$$&&(this._isVisibility=$$,this._isVisibility||this._isInputting()&&($P$.inputElement.target.focus=!1),this.event("visibilitychange"))},$$._isInputting=function(){return $s.onMobile&&$P$.isInputting},$$._changeCanvasSize=function(){this.setScreenSize($s.clientWidth*$s.pixelRatio,$s.clientHeight*$s.pixelRatio)},$$._resetCanvas=function(){if(this.screenAdaptationEnabled){var $$=$Y._mainCanvas;$$.source.style;$$.size(1,1),$z.timer.once(100,this,this._changeCanvasSize)}},$$.setScreenSize=function($$,$b){var $u=!1;if("none"!==this._screenMode&&($u=($$/$b<1?"vertical":"horizontal")!==this._screenMode)){var $Z=$b;$b=$$,$$=$Z}this.canvasRotation=$u;var $E=$Y._mainCanvas,$r=$E.source.style,$F=this._canvasTransform.identity(),$x=this._scaleMode,$g=$$/this.designWidth,$H=$b/this.designHeight,$w=this.designWidth,$I=this.designHeight,$o=$$,$N=$b,$D=$s.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$x){case"noscale":$g=$H=1,$o=this.designWidth,$N=this.designHeight;break;case"showall":$g=$H=Math.min($g,$H),$w=$o=Math.round(this.designWidth*$g),$I=$N=Math.round(this.designHeight*$H);break;case"noborder":$g=$H=Math.max($g,$H),$o=Math.round(this.designWidth*$g),$N=Math.round(this.designHeight*$H);break;case"full":$g=$H=1,this._width=$w=$$,this._height=$I=$b;break;case"fixedwidth":$H=$g,this._height=$I=Math.round($b/$g);break;case"fixedheight":$g=$H,this._width=$w=Math.round($$/$H);break;case"fixedauto":$$/$b<this.designWidth/this.designHeight?($H=$g,this._height=$I=Math.round($b/$g)):($g=$H,this._width=$w=Math.round($$/$H))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$w=$w+1&2147483646,$I=$I+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$g*=this.scaleX,$H*=this.scaleY,1===$g&&1===$H?this.transform.identity():(this.transform.a=this._formatData($g/($o/$w)),this.transform.d=this._formatData($H/($N/$I)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$E.size($w,$I),$O.changeWebGLSize($w,$I),$F.scale($o/$w/$D,$N/$I/$D),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($$-$o)/$D:this.offset.x=.5*($$-$o)/$D,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($b-$N)/$D:this.offset.y=.5*($b-$N)/$D,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$F.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$u&&("horizontal"===this._screenMode?($F.rotate(Math.PI/2),$F.translate($b/$D,0),this.canvasDegree=90):($F.rotate(-Math.PI/2),$F.translate(0,$$/$D),this.canvasDegree=-90)),$F.a=this._formatData($F.a),$F.d=this._formatData($F.d),$F.tx=this._formatData($F.tx),$F.ty=this._formatData($F.ty),$r.transformOrigin=$r.webkitTransformOrigin=$r.msTransformOrigin=$r.mozTransformOrigin=$r.oTransformOrigin="0px 0px 0px",$r.transform=$r.webkitTransform=$r.msTransform=$r.mozTransform=$r.oTransform="matrix("+$F.toString()+")",$F.translate(parseInt($r.left)||0,parseInt($r.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$$._formatData=function($$){return Math.abs($$)<1e-6?0:Math.abs(1-$$)<.001?0<$$?1:-1:$$},$$.getMousePoint=function(){return $q.TEMP.setTo(this.mouseX,this.mouseY)},$$.repaint=function(){this._repaint=1},$$.parentRepaint=function(){},$$._loop=function(){return this.render($Y.context,0,0),!0},$$._onmouseMove=function($$){this._mouseMoveTime=$s.now()},$$.getTimeFromFrameStart=function(){return $s.now()-this._frameStartTime},$$.render=function($$,$b,$u){if("sleep"===this._frameRate&&!$Y.isConchApp){var $Z=$s.now();if(!(1e3<=$Z-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($A.loopCount++,$D.instance.runEvent(),$z.timer._update()));this._frameStartTime=$Z}if(this._renderCount++,$Y.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$s.now();var $E="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$r=this._renderCount%2==0;if($A.renderSlow=!$E,$E||$r||$Y.isConchApp){var $F;$A.loopCount++,$D.instance.runEvent(),$z.timer._update(),$O.update3DLoop();var $x=0,$g=0;if($Y.isConchNode)for($x=0,$g=this._scenes.length;$x<$g;$x++)($F=this._scenes[$x])&&$F._updateSceneConch();else for($x=0,$g=this._scenes.length;$x<$g;$x++)($F=this._scenes[$x])&&$F._updateScene();if($Y.isConchNode){var $H=$I$.CustomList;for($x=0,$g=$H.length;$x<$g;$x++){var $w=$H[$x];$w.customRender($w.customContext,0,0)}return}}$Y.isConchNode||this.renderingEnabled&&($E||!$r||$Y.isConchWebGL)&&($Y.isWebGL?$Y.WebGL.mainContext&&!$Y.WebGL.mainContext.isContextLost()&&($$.clear(),$I.prototype.render.call(this,$$,$b,$u),$A._show&&$A._sp&&$A._sp.render($$,$b,$u),$O.clear(this._bgColor),$O.beginFlush(),$$.flush(),$O.endFinish(),$U.instance&&$U.getInstance().endDispose()):($O.clear(this._bgColor),$I.prototype.render.call(this,$$,$b,$u),$A._show&&$A._sp&&$A._sp.render($$,$b,$u)))}else this._renderCount%5==0&&($A.loopCount++,$D.instance.runEvent(),$z.timer._update())},$$._requestFullscreen=function(){var $$=$s.document.documentElement;$$.requestFullscreen?$$.requestFullscreen():$$.mozRequestFullScreen?$$.mozRequestFullScreen():$$.webkitRequestFullscreen?$$.webkitRequestFullscreen():$$.msRequestFullscreen&&$$.msRequestFullscreen()},$$._fullScreenChanged=function(){$z.stage.event("fullscreenchange")},$$.exitFullscreen=function(){var $$=$s.document;$$.exitFullscreen?$$.exitFullscreen():$$.mozCancelFullScreen?$$.mozCancelFullScreen():$$.webkitExitFullscreen&&$$.webkitExitFullscreen()},$w(0,$$,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$w(0,$$,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$w(0,$$,"frameRate",function(){return this._frameRate},function($$){if(this._frameRate=$$,$Y.isConchApp)switch(this._frameRate){case"slow":$s.window.conch&&$s.window.conchConfig.setSlowFrame&&$s.window.conchConfig.setSlowFrame(!0);break;case"fast":$s.window.conch&&$s.window.conchConfig.setSlowFrame&&$s.window.conchConfig.setSlowFrame(!1);break;case"mouse":$s.window.conch&&$s.window.conchConfig.setMouseFrame&&$s.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$s.window.conch&&$s.window.conchConfig.setLimitFPS&&$s.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$w(0,$$,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$w(0,$$,"width",$I.prototype._$get_width,function($$){this.designWidth=$$,$z.superSet($I$,this,"width",$$),$z.timer.callLater(this,this._changeCanvasSize)}),$w(0,$$,"alignH",function(){return this._alignH},function($$){this._alignH=$$,$z.timer.callLater(this,this._changeCanvasSize)}),$w(0,$$,"isFocused",function(){return this._isFocused}),$w(0,$$,"height",$I.prototype._$get_height,function($$){this.designHeight=$$,$z.superSet($I$,this,"height",$$),$z.timer.callLater(this,this._changeCanvasSize)}),$w(0,$$,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$V.create()},$I.prototype._$set_transform),$w(0,$$,"isVisibility",function(){return this._isVisibility}),$w(0,$$,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$w(0,$$,"scaleMode",function(){return this._scaleMode},function($$){this._scaleMode=$$,$z.timer.callLater(this,this._changeCanvasSize)}),$w(0,$$,"alignV",function(){return this._alignV},function($$){this._alignV=$$,$z.timer.callLater(this,this._changeCanvasSize)}),$w(0,$$,"bgColor",function(){return this._bgColor},function($$){this._bgColor=$$,this.conchModel&&this.conchModel.bgColor($$),$Y.isWebGL&&($$?$F._wgColor=$J.create($$)._color:$s.onMiniGame||($F._wgColor=null)),$s.onLimixiu?$F._wgColor=$J.create($$)._color:$Y.canvas.style.background=$$||"none"}),$w(0,$$,"mouseX",function(){return Math.round($D.instance.mouseX/this.clientScaleX)}),$w(0,$$,"mouseY",function(){return Math.round($D.instance.mouseY/this.clientScaleY)}),$w(0,$$,"screenMode",function(){return this._screenMode},function($$){this._screenMode=$$}),$w(0,$$,"visible",$I.prototype._$get_visible,function($$){this.visible!==$$&&($z.superSet($I$,this,"visible",$$),$Y._mainCanvas.source.style.visibility=$$?"visible":"hidden")}),$w(0,$$,"fullScreenEnabled",null,function($$){var $b=$s.document,$u=$Y.canvas;$$?($u.addEventListener("mousedown",this._requestFullscreen),$u.addEventListener("touchstart",this._requestFullscreen),$b.addEventListener("fullscreenchange",this._fullScreenChanged),$b.addEventListener("mozfullscreenchange",this._fullScreenChanged),$b.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$b.addEventListener("msfullscreenchange",this._fullScreenChanged)):($u.removeEventListener("mousedown",this._requestFullscreen),$u.removeEventListener("touchstart",this._requestFullscreen),$b.removeEventListener("fullscreenchange",this._fullScreenChanged),$b.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$b.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$b.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$F.SCALE_NOSCALE="noscale",$F.SCALE_EXACTFIT="exactfit",$F.SCALE_SHOWALL="showall",$F.SCALE_NOBORDER="noborder",$F.SCALE_FULL="full",$F.SCALE_FIXED_WIDTH="fixedwidth",$F.SCALE_FIXED_HEIGHT="fixedheight",$F.SCALE_FIXED_AUTO="fixedauto",$F.ALIGN_LEFT="left",$F.ALIGN_RIGHT="right",$F.ALIGN_CENTER="center",$F.ALIGN_TOP="top",$F.ALIGN_MIDDLE="middle",$F.ALIGN_BOTTOM="bottom",$F.SCREEN_NONE="none",$F.SCREEN_HORIZONTAL="horizontal",$F.SCREEN_VERTICAL="vertical",$F.FRAME_FAST="fast",$F.FRAME_SLOW="slow",$F.FRAME_MOUSE="mouse",$F.FRAME_SLEEP="sleep",$F.FRAME_MOUSE_THREDHOLD=2e3,$g($F,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$F}($I$),$_$=(function($$){function $b(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$b.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$e($b,"laya.media.SoundNode",$I$);var $u=$b.prototype;$u._onParentChange=function(){this.target=this.parent},$u.play=function($$,$b){void 0===$$&&($$=1),isNaN($$)&&($$=1),this.url&&(this.stop(),this._channel=$K.playSound(this.url,$$,null,$b))},$u.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$u._setPlayAction=function($$,$b,$u,$Z){void 0===$Z&&($Z=!0),this[$u]&&$$&&($Z?$$.on($b,this,this[$u]):$$.off($b,this,this[$u]))},$u._setPlayActions=function($$,$b,$u,$Z){if(void 0===$Z&&($Z=!0),$$&&$b){var $E,$r=$b.split(","),$F=0;for($E=$r.length,$F=0;$F<$E;$F++)this._setPlayAction($$,$r[$F],$u,$Z)}},$w(0,$u,"playEvent",null,function($$){(this._playEvents=$$)&&this._tar&&this._setPlayActions(this._tar,$$,"play")}),$w(0,$u,"target",null,function($$){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$$,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$w(0,$u,"stopEvent",null,function($$){(this._stopEvents=$$)&&this._tar&&this._setPlayActions(this._tar,$$,"stop")})}(),function($$){function $b(){this._src=null,this._onload=null,this._onerror=null,$b.__super.call(this)}$e($b,"laya.resource.FileBitmap",$D$);var $u=$b.prototype;return $w(0,$u,"src",function(){return this._src},function($$){this._src=$$}),$w(0,$u,"onload",null,function($$){}),$w(0,$u,"onerror",null,function($$){}),$b}()),$y$=function($$){function $u($$,$b){this._is2D=!1,$u.__super.call(this);var $Z=this;if(this._source=this,"2D"===$$||"AUTO"===$$&&!$Y.isWebGL){this._is2D=!0,this._source=$b||$s.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $E=this;$E.getContext=function($$,$b){if($Z._ctx)return $Z._ctx;var $u=$Z._ctx=$Z._source.getContext($$,$b);return $u&&($u._canvas=$E,$Y.isFlash||$s.onLimixiu||($u.size=function($$,$b){})),$u}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$e($u,"laya.resource.HTMLCanvas",$D$);var $b=$u.prototype;return $b.clear=function(){this._ctx&&this._ctx.clear()},$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$b.release=function(){},$b._setContext=function($$){this._ctx=$$},$b.getContext=function($$,$b){return this._ctx?this._ctx:this._ctx=$u._createContext(this)},$b.getMemSize=function(){return 0},$b.size=function($$,$b){(this._w!=$$||this._h!=$b||this._source&&(this._source.width!=$$||this._source.height!=$b))&&(this._w=$$,this._h=$b,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($$,$b),this._source&&(this._source.height=$b,this._source.width=$$))},$b.getCanvas=function(){return this._source},$b.toBase64=function($$,$b,$u){if(this._source)if($Y.isConchApp&&this._source.toBase64)this._source.toBase64($$,$b,$u);else{var $Z=this._source.toDataURL($$,$b);$u.call(this,$Z)}},$w(0,$b,"context",function(){return this._ctx}),$w(0,$b,"asBitmap",null,function($$){}),$u.create=function($$,$b){return new $u($$,$b)},$u.TYPE2D="2D",$u.TYPE3D="3D",$u.TYPEAUTO="AUTO",$u._createContext=null,$u}(),$S$=(function($$){function $g($$,$b,$u,$Z,$E,$r,$F,$x){throw $g.__super.call(this),new Error("不允许new！")}$e($g,"laya.resource.HTMLSubImage",$D$),$g.create=function($$,$b,$u,$Z,$E,$r,$F,$x){return void 0===$x&&($x=!1),new $g($$,$b,$u,$Z,$E,$r,$F,$x)}}(),function($$){function $I(){this._frames=null,this._url=null,$I.__super.call(this),this._setControlNode(this)}$e($I,"laya.display.Animation",$$);var $b=$I.prototype;$b.destroy=function($$){void 0===$$&&($$=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$$),this._frames=null,this._labels=null},$b.play=function($$,$b,$u,$Z){void 0===$$&&($$=0),void 0===$b&&($b=!0),void 0===$u&&($u=""),void 0===$Z&&($Z=!0),$u&&this._setFramesFromCache($u,$Z),this._isPlaying=!0,this.index="string"==typeof $$?this._getFrameByLabel($$):$$,this.loop=$b,this._actionName=$u,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$b._setFramesFromCache=function($$,$b){var $u;return void 0===$b&&($b=!1),this._url&&($$=this._url+"#"+$$),$$&&$I.framesMap[$$]?(($u=$I.framesMap[$$])instanceof Array?(this._frames=$I.framesMap[$$],this._count=this._frames.length):($u.nodeRoot&&($I.framesMap[$$]=this._parseGraphicAnimationByData($u),$u=$I.framesMap[$$]),this._frames=$u.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$u.interval),this._labels=this._copyLabels($u.labels)),!0):($b&&console.log("ani not found:",$$),!1)},$b._copyLabels=function($$){if(!$$)return null;var $b,$u;for($u in $b={},$$)$b[$u]=$d.copyArray([],$$[$u]);return $b},$b._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$$.prototype._frameLoop.call(this)},$b._displayToIndex=function($$){this._frames&&(this.graphics=this._frames[$$])},$b.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$b.loadImages=function($$,$b){return void 0===$b&&($b=""),this._url="",this._setFramesFromCache($b)||(this.frames=$I.framesMap[$b]?$I.framesMap[$b]:$I.createFrames($$,$b)),this},$b.loadAtlas=function($b,$u,$Z){void 0===$Z&&($Z=""),this._url="";var $E=this;function $$($$){$b===$$&&($E.frames=$I.framesMap[$Z]?$I.framesMap[$Z]:$I.createFrames($b,$Z),$u&&$u.run())}return $E._setFramesFromCache($Z)||($x$.getAtlas($b)?$$($b):$z.loader.load($b,$_.create(null,$$,[$b]),null,"atlas")),this},$b.loadAnimation=function($$,$b,$u){this._url=$$;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$b&&$b.run()):!$u||$x$.getAtlas($u)?this._loadAnimationData($$,$b,$u):$z.loader.load($u,$_.create(this,this._loadAnimationData,[$$,$b,$u]),null,"atlas"),this},$b._loadAnimationData=function($x,$g,$$){var $H=this;if(!$$||$x$.getAtlas($$)){var $w=this;$x$.getRes($x)?$b($x):$z.loader.load($x,$_.create(null,$b,[$x]),null,"json"),$x$.clearRes($x)}else console.warn("atlas load fail:"+$$);function $b($$){if($x$.getRes($$)&&$x===$$){var $b;if($I.framesMap[$x+"#"])$w._setFramesFromCache($H._actionName,!0),$H.index=0,$H._checkResumePlaying();else{var $u=$w._parseGraphicAnimation($x$.getRes($x));if(!$u)return;var $Z,$E=$u.animationList,$r=0,$F=$E.length;for($r=0;$r<$F;$r++)$b=$E[$r],$I.framesMap[$x+"#"+$b.name]=$b,$Z||($Z=$b);$Z&&($I.framesMap[$x+"#"]=$Z,$w._setFramesFromCache($H._actionName,!0),$H.index=0),$H._checkResumePlaying()}$g&&$g.run()}}},$b._parseGraphicAnimation=function($$){return $z$.parseAnimationData($$)},$b._parseGraphicAnimationByData=function($$){return $z$.parseAnimationByData($$)},$w(0,$b,"frames",function(){return this._frames},function($$){(this._frames=$$)&&(this._count=$$.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$w(0,$b,"autoPlay",null,function($$){$$?this.play():this.stop()}),$w(0,$b,"source",null,function($$){-1<$$.indexOf(".ani")?this.loadAnimation($$):-1<$$.indexOf(".json")||-1<$$.indexOf("als")||-1<$$.indexOf("atlas")?this.loadAtlas($$):this.loadImages($$.split(","))}),$w(0,$b,"autoAnimation",null,function($$){this.play(0,!0,$$,!1)}),$I.createFrames=function($$,$b){var $u,$Z,$E=0,$r=0;if("string"==typeof $$){var $F=$x$.getAtlas($$);if($F&&$F.length)for($u=[],$E=0,$r=$F.length;$E<$r;$E++)($Z=new $O.createGraphics).drawTexture($x$.getRes($F[$E]),0,0),$u.push($Z)}else if($$ instanceof Array)for($u=[],$E=0,$r=$$.length;$E<$r;$E++)($Z=new $O.createGraphics).loadImage($$[$E],0,0),$u.push($Z);return $b&&($I.framesMap[$b]=$u),$u},$I.clearCache=function($$){var $b,$u=$I.framesMap,$Z=$$+"#";for($b in $u)$b!==$$&&0!=$b.indexOf($Z)||delete $I.framesMap[$b]},$I.framesMap={}}($e$),function($$){function $r(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$r.__super.call(this),null==$r._sortIndexFun&&($r._sortIndexFun=$i.sortByKey("index",!1,!0))}$e($r,"laya.display.FrameAnimation",$$);var $b=$r.prototype;return $b._setUp=function($$,$b){this._labels=null,this._animationNewFrames=null,this._targetDic=$$,this._animationData=$b,this.interval=1e3/$b.frameRate,$b.parsed?(this._count=$b.count,this._labels=$b.labels,this._animationNewFrames=$b.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$b.parsed=!0,$b.labels=this._labels,$b.count=this._count,$b.animationNewFrames=this._animationNewFrames},$b.clear=function(){$$.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$b._displayToIndex=function($$){if(this._animationData){$$<0&&($$=0),$$>this._count&&($$=this._count);var $b=this._animationData.nodes,$u=0,$Z=$b.length;for($u=0;$u<$Z;$u++)this._displayNodeToFrame($b[$u],$$)}},$b._displayNodeToFrame=function($$,$b,$u){$u||($u=this._targetDic);var $Z=$u[$$.target];if($Z){var $E,$r,$F,$x=$$.frames,$g=$$.keys,$H=0,$w=$g.length;for($H=0;$H<$w;$H++)$F=($r=$x[$E=$g[$H]]).length>$b?$r[$b]:$r[$r.length-1],$Z[$E]=$F}},$b._calculateDatas=function(){if(this._animationData){var $$,$b=this._animationData.nodes,$u=0,$Z=$b.length;for($u=this._count=0;$u<$Z;$u++)$$=$b[$u],this._calculateNodeKeyFrames($$);this._count+=1}},$b._calculateNodeKeyFrames=function($$){var $b,$u,$Z=$$.keyframes,$E=$$.target;for($b in $$.frames||($$.frames={}),$$.keys?$$.keys.length=0:$$.keys=[],$$.initValues||($$.initValues={}),$Z)$u=$Z[$b],$$.frames[$b]||($$.frames[$b]=[]),this._targetDic&&this._targetDic[$E]&&($$.initValues[$b]=this._targetDic[$E][$b]),$u.sort($r._sortIndexFun),$$.keys.push($b),this._calculateNodePropFrames($u,$$.frames[$b],$b,$E)},$b.resetToInitState=function(){if(this._targetDic&&this._animationData){var $$,$b,$u=this._animationData.nodes,$Z=0,$E=$u.length;for($Z=0;$Z<$E;$Z++)if($b=($$=$u[$Z]).initValues){var $r,$F=this._targetDic[$$.target];if($F)for($r in $b)$F[$r]=$b[$r]}}},$b._calculateNodePropFrames=function($$,$b,$u,$Z){var $E=0,$r=$$.length-1;if(0<$r){for($b.length=$$[$r].index+1,$E=0;$E<$r;$E++)this._dealKeyFrame($$[$E]),this._calculateFrameValues($$[$E],$$[$E+1],$b);this._dealKeyFrame($$[$E])}0==$r&&($b[$$[0].index]=$$[0].value,this._animationNewFrames&&(this._animationNewFrames[$$[0].index]=!0))},$b._dealKeyFrame=function($$){$$.label&&""!=$$.label&&this.addLabel($$.label,$$.index)},$b._calculateFrameValues=function($$,$b,$u){var $Z,$E=0,$r=$$.index,$F=$b.index,$x=$$.value,$g=$b.value-$$.value,$H=$F-$r;if($F>this._count&&(this._count=$F),$$.tween)for(null==($Z=$Q[$$.tweenMethod])&&($Z=$Q.linearNone),$E=$r;$E<$F;$E++)$u[$E]=$Z($E-$r,$x,$g,$H),this._animationNewFrames&&(this._animationNewFrames[$E]=!0);else for($E=$r;$E<$F;$E++)$u[$E]=$x;this._animationNewFrames&&(this._animationNewFrames[$$.index]=!0,this._animationNewFrames[$b.index]=!0),$u[$b.index]=$b.value},$r._sortIndexFun=null,$r}($e$)),$P$=function($b){function $E(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$E.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$L$.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$e($E,"laya.display.Input",$b);var $$=$E.prototype;return $$.setSelection=function($$,$b){this.focus=!0,laya.display.Input.inputElement.selectionStart=$$,laya.display.Input.inputElement.selectionEnd=$b},$$._onUnDisplay=function($$){this.focus=!1},$$._onMouseDown=function($$){this.focus=!0},$$._syncInputTransform=function(){var $$=this.nativeInput,$b=$d.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$u=this._width-this.padding[1]-this.padding[3],$Z=this._height-this.padding[0]-this.padding[2];$Y.isConchApp?($$.setScale($b.scaleX,$b.scaleY),$$.setSize($u,$Z),$$.setPos($b.x,$b.y)):($E.inputContainer.style.transform=$E.inputContainer.style.webkitTransform="scale("+$b.scaleX+","+$b.scaleY+") rotate("+$z.stage.canvasDegree+"deg)",$$.style.width=$u+"px",$$.style.height=$Z+"px",$E.inputContainer.style.left=$b.x+"px",$E.inputContainer.style.top=$b.y+"px")},$$.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$$._setInputMethod=function(){$E.input.parentElement&&$E.inputContainer.removeChild($E.input),$E.area.parentElement&&$E.inputContainer.removeChild($E.area),$E.inputElement=this._multiline?$E.area:$E.input,$E.inputContainer.appendChild($E.inputElement),$L$.RightToLeft&&($E.inputElement.style.direction="rtl")},$$._focusIn=function(){laya.display.Input.isInputting=!0;var $$=this.nativeInput;this._focus=!0;var $b=$$.style;$b.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$$.readOnly=!this._editable,$Y.isConchApp&&($$.setType(this._type),$$.setForbidEdit(!this._editable)),$$.maxLength=this._maxChars;this.padding;if($$.type=this._type,$$.value=this._content,$$.placeholder=this._prompt,$z.stage.off("keydown",this,this._onKeyDown),$z.stage.on("keydown",this,this._onKeyDown),($z.stage.focus=this).event("focus"),$s.onPC&&$$.focus(),!$s.onMiniGame){this._text;this._text=null}this.typeset(),$$.setColor(this._originColor),$$.setFontSize(this.fontSize),$$.setFontFace($s.onIPhone&&$L$._fontFamilyMap[this.font]||this.font),$Y.isConchApp&&$$.setMultiAble&&$$.setMultiAble(this._multiline),$b.lineHeight=this.leading+this.fontSize+"px",$b.fontStyle=this.italic?"italic":"normal",$b.fontWeight=this.bold?"bold":"normal",$b.textAlign=this.align,$b.padding="0 0",this._syncInputTransform(),!$Y.isConchApp&&$s.onPC&&$z.timer.frameLoop(1,this,this._syncInputTransform)},$$._setPromptColor=function(){($E.promptStyleDOM=$s.getElementById("promptStyle"))||(($E.promptStyleDOM=$s.createElement("style")).setAttribute("id","promptStyle"),$s.document.head.appendChild($E.promptStyleDOM)),$E.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$$._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($z.superSet($L$,this,"text",this._content),$z.superSet($L$,this,"color",this._originColor)):($z.superSet($L$,this,"text",this._prompt),$z.superSet($L$,this,"color",this._promptColor)),$z.stage.off("keydown",this,this._onKeyDown),$z.stage.focus=null,this.event("blur"),$Y.isConchApp&&this.nativeInput.blur(),$s.onPC&&$z.timer.clear(this,this._syncInputTransform)},$$._onKeyDown=function($$){13===$$.keyCode&&($s.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$$.changeText=function($$){this._content=$$,this._focus?(this.nativeInput.value=$$||"",this.event("change")):$b.prototype.changeText.call(this,$$)},$w(0,$$,"color",$b.prototype._$get_color,function($$){this._focus&&this.nativeInput.setColor($$),$z.superSet($L$,this,"color",this._content?$$:this._promptColor),this._originColor=$$}),$w(0,$$,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($$){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$w(0,$$,"multiline",function(){return this._multiline},function($$){this._multiline=$$,this.valign=$$?"top":"middle"}),$w(0,$$,"maxChars",function(){return this._maxChars},function($$){$$<=0&&($$=1e5),this._maxChars=$$}),$w(0,$$,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($$){$z.superSet($L$,this,"color",this._originColor),$$+="",this._focus?(this.nativeInput.value=$$||"",this.event("change")):(this._multiline||($$=$$.replace(/\r?\n/g,"")),(this._content=$$)?$z.superSet($L$,this,"text",$$):($z.superSet($L$,this,"text",this._prompt),$z.superSet($L$,this,"color",this.promptColor)))}),$w(0,$$,"nativeInput",function(){return this._multiline?$E.area:$E.input}),$w(0,$$,"prompt",function(){return this._prompt},function($$){!this._text&&$$&&$z.superSet($L$,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$z.superSet($L$,this,"text",this._text==this._prompt?$$:this._text):$z.superSet($L$,this,"text",$$),this._prompt=$L$.langPacks&&$L$.langPacks[$$]?$L$.langPacks[$$]:$$}),$w(0,$$,"focus",function(){return this._focus},function($$){var $b=this.nativeInput;this._focus!==$$&&($$?($b.target?$b.target._focusOut():this._setInputMethod(),($b.target=this)._focusIn()):($b.target=null,this._focusOut(),$s.document.body.scrollTop=0,$b.blur(),$Y.isConchApp?$b.setPos(-1e4,-1e4):$E.inputContainer.contains($b)&&$E.inputContainer.removeChild($b)))}),$w(0,$$,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($$){$$?(-1<($$="[^"+$$+"]").indexOf("^^")&&($$=$$.replace("^^","")),this._restrictPattern=new RegExp($$,"g")):this._restrictPattern=null}),$w(0,$$,"editable",function(){return this._editable},function($$){this._editable=$$,$Y.isConchApp&&$E.input.setForbidEdit(!$$)}),$w(0,$$,"promptColor",function(){return this._promptColor},function($$){this._promptColor=$$,this._content||$z.superSet($L$,this,"color",$$)}),$w(0,$$,"type",function(){return this._type},function($$){this._getCSSStyle().password="password"==$$,this._type=$$,$Y.isConchApp&&this.nativeInput.setType($$)}),$w(0,$$,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($$){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$w(0,$$,"asPassword",function(){return this._getCSSStyle().password},function($$){this._getCSSStyle().password=$$,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$E.__init__=function(){$E._createInputElement(),$s.onMobile&&$Y.canvas.addEventListener($E.IOS_IFRAME?$s.onMiniGame?"touchend":"click":"touchend",$E._popupInputMethod)},$E._popupInputMethod=function($$){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$E._createInputElement=function(){$E._initInput($E.area=$s.createElement("textarea")),$E._initInput($E.input=$s.createElement("input")),($E.inputContainer=$s.createElement("div")).style.position="absolute",$E.inputContainer.style.zIndex=1e5,$s.container.appendChild($E.inputContainer),$E.inputContainer.setPos=function($$,$b){$E.inputContainer.style.left=$$+"px",$E.inputContainer.style.top=$b+"px"}},$E._initInput=function($b){var $$=$b.style;$$.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$$.resize="none",$$.backgroundColor="transparent",$$.border="none",$$.outline="none",$$.zIndex=1,$b.addEventListener("input",$E._processInputting),$b.addEventListener("mousemove",$E._stopEvent),$b.addEventListener("mousedown",$E._stopEvent),$b.addEventListener("touchmove",$E._stopEvent),$b.setFontFace=function($$){$b.style.fontFamily=$$},$Y.isConchApp||($b.setColor=function($$){$b.style.color=$$},$b.setFontSize=function($$){$b.style.fontSize=$$+"px"})},$E._processInputting=function($$){var $b=laya.display.Input.inputElement.target;if($b){var $u=laya.display.Input.inputElement.value;$b._restrictPattern&&($u=$u.replace(/\u2006|\x27/g,""),$b._restrictPattern.test($u)&&($u=$u.replace($b._restrictPattern,""),laya.display.Input.inputElement.value=$u)),$b._text=$u,$b.event("input")}},$E._stopEvent=function($$){"touchmove"==$$.type&&$$.preventDefault(),$$.stopPropagation&&$$.stopPropagation()},$E.TYPE_TEXT="text",$E.TYPE_PASSWORD="password",$E.TYPE_EMAIL="email",$E.TYPE_URL="url",$E.TYPE_NUMBER="number",$E.TYPE_RANGE="range",$E.TYPE_DATE="date",$E.TYPE_MONTH="month",$E.TYPE_WEEK="week",$E.TYPE_TIME="time",$E.TYPE_DATE_TIME="datetime",$E.TYPE_DATE_TIME_LOCAL="datetime-local",$E.TYPE_SEARCH="search",$E.input=null,$E.area=null,$E.inputElement=null,$E.inputContainer=null,$E.confirmButton=null,$E.promptStyleDOM=null,$E.inputHeight=45,$E.isInputting=!1,$E.stageMatrix=null,$g($E,["IOS_IFRAME",function(){return this.IOS_IFRAME=$s.onIOS&&$s.window.top!=$s.window.self}]),$E}($L$),$i$=function($$){function $u($$,$b){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$u.__super.call(this),$$&&this._init_($$,$b)}$e($u,"laya.resource.HTMLImage",$_$);var $b=$u.prototype;return $b._init_=function($$,$b){this._src=$$,this._source=new $s.window.Image,$b&&($b.onload&&(this.onload=$b.onload),$b.onerror&&(this.onerror=$b.onerror),$b.onCreate&&$b.onCreate(this)),0!=$$.indexOf("data:image")&&(this._source.crossOrigin=""),$$&&(this._source.src=$$)},$b.recreateResource=function(){var $$=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $b=this;this._source=new $s.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($b._needReleaseAgain)return $b._needReleaseAgain=!1,$b._source.onload=null,void($b._source=null);$b._source.onload=null,$b.memorySize=$$._w*$$._h*4,$b._recreateLock=!1,$b.completeCreate()},this._source.src=this._src}},$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$b.onresize=function(){this._w=this._source.width,this._h=this._source.height},$w(0,$b,"onload",null,function($$){var $b=this;this._onload=$$,this._source&&(this._source.onload=null!=this._onload?function(){$b.onresize(),$b._onload()}:null)}),$w(0,$b,"onerror",null,function($$){var $b=this;this._onerror=$$,this._source&&(this._source.onerror=null!=this._onerror?function(){$b._onerror()}:null)}),$w(0,$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($$){this._enableMerageInAtlas=$$,$Y.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$$)}),$u.create=function($$,$b){return new $u($$,$b)},$u}(),$z$=(function($r){function $$(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$$.__super.call(this)}$e($$,"laya.display.EffectAnimation",$r);var $b=$$.prototype;$b._onOtherBegin=function($$){$$!=this&&this.stop()},$b.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$b._onPlayAction=function(){this.play(0,!1)},$b.play=function($$,$b,$u,$Z){void 0===$$&&($$=0),void 0===$b&&($b=!0),void 0===$u&&($u=""),void 0===$Z&&($Z=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$$,$b,$u,$Z))},$b._recordInitData=function(){if(this._aniKeys){var $$,$b,$u=0;for($$=this._aniKeys.length,$u=0;$u<$$;$u++)$b=this._aniKeys[$u],this._initData[$b]=this._target[$b]}},$b._displayToIndex=function($$){if(this._animationData){$$<0&&($$=0),$$>this._count&&($$=this._count);var $b=this._animationData.nodes,$u=0,$Z=$b.length;for($Z=1<$Z?1:$Z,$u=0;$u<$Z;$u++)this._displayNodeToFrame($b[$u],$$)}},$b._displayNodeToFrame=function($$,$b,$u){if(this._target){var $Z;$Z=this._target;var $E,$r,$F,$x,$g=$$.frames,$H=$$.keys,$w=0,$I=$H.length;$x=$$.secondFrames;var $o,$N,$D,$e,$L=0;for($w=0;$w<$I;$w++)$r=$g[$E=$H[$w]],$F=-1==($L=$x[$E])?this._initData[$E]:$b<$L?($D=($N=$$.keyframes[$E])[0]).tween?(null==($o=$Q[$D.tweenMethod])&&($o=$Q.linearNone),$e=$N[1],$o($b,this._initData[$E],$e.value-this._initData[$E],$e.index)):this._initData[$E]:$r.length>$b?$r[$b]:$r[$r.length-1],$Z[$E]=$F}},$b._calculateNodeKeyFrames=function($$){$r.prototype._calculateNodeKeyFrames.call(this,$$);var $b,$u,$Z,$E=$$.keyframes;$$.target;for($b in $Z={},$$.secondFrames=$Z,$E)($u=$E[$b]).length<=1?$Z[$b]=-1:$Z[$b]=$u[1].index},$w(0,$b,"target",function(){return this._target},function($$){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$$,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$w(0,$b,"playEvent",null,function($$){(this._playEvents=$$)&&this.addEvent()}),$w(0,$b,"effectData",null,function($$){var $b;$$&&(($b=$$.animations)&&$b[0]&&(this._setUp({},$b[0]),$b[0].nodes&&$b[0].nodes[0]&&(this._aniKeys=$b[0].nodes[0].keys)))}),$w(0,$b,"effectClass",null,function($$){var $b,$u;(this._effectClass=$c.getClass($$),this._effectClass)&&(($b=this._effectClass.uiView)&&($u=$b.animations)&&$u[0]&&(this._setUp({},$u[0]),$u[0].nodes&&$u[0].nodes[0]&&(this._aniKeys=$u[0].nodes[0].keys)))}),$$.EffectAnimationBegin="effectanimationbegin"}($S$),function($b){var $C;function $K(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$K.__super.call(this)}$e($K,"laya.utils.GraphicAnimation",$b);var $$=$K.prototype;return $$._parseNodeList=function($$){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$$.compId]=$$.props,$$.compId&&this._nodeList.push($$.compId);var $b=$$.child;if($b){var $u=0,$Z=$b.length;for($u=0;$u<$Z;$u++)this._parseNodeList($b[$u])}},$$._calGraphicData=function($$){var $b;if(this._setUp(null,$$),this._createGraphicData(),this._nodeIDAniDic)for($b in this._nodeIDAniDic)this._nodeIDAniDic[$b]=null},$$._createGraphicData=function(){var $$,$b=[],$u=0,$Z=this.count,$E=this._animationNewFrames;for($E||($E=[]),$u=0;$u<$Z;$u++)!$E[$u]&&$$||($$=this._createFrameGraphic($u)),$b.push($$);this._gList=$b},$$._createFrameGraphic=function($$){var $b=$O.createGraphics();return $K._rootMatrix||($K._rootMatrix=new $V),this._updateNodeGraphic(this._rootNode,$$,$K._rootMatrix,$b),$b},$$._updateNodeGraphic=function($$,$b,$u,$Z,$E){var $r;void 0===$E&&($E=1);var $F,$x,$g,$H=($r=this._nodeGDic[$$.compId]=this._getNodeGraphicData($$.compId,$b,this._nodeGDic[$$.compId])).alpha*$E;if(!($H<.01)&&($r.resultTransform||($r.resultTransform=$V.create()),$F=$r.resultTransform,$V.mul($r.transform,$u,$F),$r.skin&&($x=this._getTextureByUrl($r.skin))&&($F._checkTransform()?($Z.drawTexture($x,0,0,$r.width,$r.height,$F,$H),$r.resultTransform=null):$Z.drawTexture($x,$F.tx,$F.ty,$r.width,$r.height,null,$H)),$g=$$.child)){var $w,$I=0;for($w=$g.length,$I=0;$I<$w;$I++)this._updateNodeGraphic($g[$I],$b,$F,$Z,$H)}},$$._updateNoChilds=function($$,$b){if($$.skin){var $u=this._getTextureByUrl($$.skin);if($u){var $Z=$$.transform;$Z._checkTransform();!$Z.bTransform?$b.drawTexture($u,$Z.tx,$Z.ty,$$.width,$$.height,null,$$.alpha):$b.drawTexture($u,0,0,$$.width,$$.height,$Z.clone(),$$.alpha)}}},$$._updateNodeGraphic2=function($$,$b,$u){var $Z;if($Z=this._nodeGDic[$$.compId]=this._getNodeGraphicData($$.compId,$b,this._nodeGDic[$$.compId]),$$.child){var $E=$Z.transform;$E._checkTransform();var $r,$F;$F=($r=!$E.bTransform)&&(0!=$E.tx||0!=$E.ty);var $x,$g,$H;if(($x=$E.bTransform||1!=$Z.alpha)&&$u.save(),1!=$Z.alpha&&$u.alpha($Z.alpha),$r?$F&&$u.translate($E.tx,$E.ty):$u.transform($E.clone()),$g=$$.child,$Z.skin&&($H=this._getTextureByUrl($Z.skin))&&$u.drawTexture($H,0,0,$Z.width,$Z.height),$g){var $w,$I=0;for($w=$g.length,$I=0;$I<$w;$I++)this._updateNodeGraphic2($g[$I],$b,$u)}$x?$u.restore():$r?$F&&$u.translate(-$E.tx,-$E.ty):$u.transform($E.clone().invert())}else this._updateNoChilds($Z,$u)},$$._calculateNodeKeyFrames=function($$){$b.prototype._calculateNodeKeyFrames.call(this,$$),this._nodeIDAniDic[$$.target]=$$},$$.getNodeDataByID=function($$){return this._nodeIDAniDic[$$]},$$._getParams=function($$,$b,$u,$Z){var $E=$K._temParam;$E.length=$b.length;var $r=0,$F=$b.length;for($r=0;$r<$F;$r++)$E[$r]=this._getObjVar($$,$b[$r][0],$u,$b[$r][1],$Z);return $E},$$._getObjVar=function($$,$b,$u,$Z,$E){if($$.hasOwnProperty($b)){var $r=$$[$b];if($u>=$r.length&&($u=$r.length-1),null!=$$[$b][$u])return $$[$b][$u]}return $E.hasOwnProperty($b)?$E[$b]:$Z},$$._getNodeGraphicData=function($$,$b,$u){$u||($u=$C.create()),$u.transform?$u.transform.identity():$u.transform=$V.create();var $Z=this.getNodeDataByID($$);if(!$Z)return $u;var $E,$r,$F=$Z.frames,$x=this._getParams($F,$K._drawTextureCmd,$b,this._nodeDefaultProps[$$]),$g=$x[0],$H=NaN,$w=NaN,$I=$x[5],$o=$x[6],$N=$x[13],$D=$x[14],$e=$x[7],$L=$x[8],$T=$x[9],$_=$x[11],$y=$x[12];$H=$x[3],$w=$x[4],0!=$H&&0!=$w||($g=null),-1==$H&&($H=0),-1==$w&&($w=0),$u.skin=$g,$u.width=$H,$u.height=$w,$g&&(($E=this._getTextureByUrl($g))?($H||($H=$E.sourceWidth),$w||($w=$E.sourceHeight)):console.warn("lost skin:",$g,",you may load pics first")),$u.alpha=$x[10],$r=$u.transform,0!=$N&&($I=$N*$H),0!=$D&&($o=$D*$w),0==$I&&0==$o||$r.translate(-$I,-$o);var $S=null;if($T||1!==$e||1!==$L||$_||$y){($S=$K._tempMt).identity(),$S.bTransform=!0;var $P=.0174532922222222*($T-$_),$i=.0174532922222222*($T+$y),$z=Math.cos($i),$q=Math.sin($i),$a=Math.sin($P),$t=Math.cos($P);$S.a=$e*$z,$S.b=$e*$q,$S.c=-$L*$a,$S.d=$L*$t,$S.tx=$S.ty=0}return $S&&($r=$V.mul($r,$S,$r)),$r.translate($x[1],$x[2]),$u},$$._getTextureByUrl=function($$){return $x$.getRes($$)},$$.setAniData=function($$,$b){if($$.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$$,this._parseNodeList($$);var $u,$Z={},$E=[],$r=$$.animations,$F=0,$x=$r.length;for($F=0;$F<$x;$F++)if($u=$r[$F],this._labels=null,(!$b||$b==$u.name)&&$u){try{this._calGraphicData($u)}catch($$){console.warn("parse animation fail:"+$u.name+",empty animation created"),this._gList=[]}var $g={};$g.interval=1e3/$u.frameRate,$g.frames=this._gList,$g.labels=this._labels,$g.name=$u.name,$E.push($g),$Z[$u.name]=$g}this.animationList=$E,this.animationDic=$Z}$K._temParam.length=0},$$.parseByData=function($$){var $b,$u;$b=$$.nodeRoot,$u=$$.aniO,delete $$.nodeRoot,delete $$.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$b,this._parseNodeList($b),this._labels=null;try{this._calGraphicData($u)}catch($$){console.warn("parse animation fail:"+$u.name+",empty animation created"),this._gList=[]}var $Z=$$;return $Z.interval=1e3/$u.frameRate,$Z.frames=this._gList,$Z.labels=this._labels,$Z.name=$u.name,$Z},$$.setUpAniData=function($$){if($$.animations){var $b,$u={},$Z=[],$E=$$.animations,$r=0,$F=$E.length;for($r=0;$r<$F;$r++)if($b=$E[$r]){var $x={};$x.name=$b.name,$x.aniO=$b,$x.nodeRoot=$$,$Z.push($x),$u[$b.name]=$x}this.animationList=$Z,this.animationDic=$u}},$$._clear=function(){var $$,$b;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($$ in this._nodeGDic)($b=this._nodeGDic[$$])&&$b.recover();this._nodeGDic=null},$K.parseAnimationByData=function($$){var $b;return $K._I||($K._I=new $K),$b=$K._I.parseByData($$),$K._I._clear(),$b},$K.parseAnimationData=function($$){var $b;return $K._I||($K._I=new $K),$K._I.setUpAniData($$),($b={}).animationList=$K._I.animationList,$b.animationDic=$K._I.animationDic,$K._I._clear(),$b},$K._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$K._temParam=[],$K._I=null,$K._rootMatrix=null,$g($K,["_tempMt",function(){return this._tempMt=new $V}]),$K.__init$=function(){$C=function(){function $$(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $e($$,""),$$.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$G.recover("GraphicNode",this)},$$.create=function(){return $G.getItemByClass("GraphicNode",$$)},$$}()},$K}($S$));$z.__init([$H,$g$,$Y,$s,$j,$t,$$,$z$])}(window,document,Laya),function($$,$b,$u){$u.un,$u.uns,$u.static;var $Z=$u.class;$u.getset,$u.__newvec;new(function(){function $$(){}return $Z($$,"LayaMain"),$$}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($$,$b){"use strict";for(var $u in Object.defineProperty($b,"__esModule",{value:!0}),Laya){var $Z=Laya[$u];$Z&&$Z.__isclass&&($b[$u]=$Z)}}),function($$,$b,$i){$i.un,$i.uns;var $F=$i.static,$o=$i.class,$Z=$i.getset,$r=$i.__newvec,$w=laya.maths.Arith,$I=laya.maths.Bezier,$u=laya.resource.Bitmap,$N=laya.utils.Browser,$g=laya.utils.Byte,$D=laya.utils.Color,$z=(laya.filters.ColorFilter,$i.Config),$E=laya.resource.Context,$q=(laya.events.Event,laya.filters.Filter),$x=laya.display.Graphics,$H=laya.resource.HTMLCanvas,$e=(laya.utils.HTMLChar,laya.resource.HTMLImage),$L=laya.resource.HTMLSubImage,$a=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$t=laya.maths.Point,$C=laya.maths.Rectangle,$T=laya.renders.Render,$_=(laya.renders.RenderContext,laya.renders.RenderSprite),$y=laya.resource.Resource,$S=laya.resource.ResourceManager,$P=laya.utils.RunDriver,$K=laya.display.Sprite,$O=laya.display.Stage,$V=laya.utils.Stat,$v=laya.utils.StringKey,$p=(laya.display.css.Style,laya.system.System),$Y=laya.display.Text,$k=laya.resource.Texture,$M=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$l=laya.utils.VectorGraphManager;laya.utils.WordText;$i.interface("laya.webgl.shapes.IShape"),$i.interface("laya.webgl.submit.ISubmit"),$i.interface("laya.webgl.text.ICharSegment"),$i.interface("laya.webgl.canvas.save.ISaveData"),$i.interface("laya.webgl.resource.IMergeAtlasBitmap"),$i.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $X=function(){function $$(){}$o($$,"laya.filters.webgl.FilterActionGL");var $b=$$.prototype;return $i.imps($b,{"laya.filters.IFilterActionGL":!0}),$b.setValue=function($$){},$b.setValueMix=function($$){},$b.apply3d=function($$,$b,$u,$Z,$E){return null},$b.apply=function($$){return null},$Z(0,$b,"typeMix",function(){return 0}),$$}(),$s=function(){function $$(){}return $o($$,"laya.webgl.shader.ShaderValue"),$$}(),$m=function(){var $Z,$E;function $$($$,$b,$u){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $E,void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),this._cells=null,this._rowInfo=null,this._init($$,$b),this._atlasID=$u}$o($$,"laya.webgl.atlas.AtlasGrid");var $b=$$.prototype;return $b.getAltasID=function(){return this._atlasID},$b.setAltasID=function($$){0<=$$&&(this._atlasID=$$)},$b.addTex=function($$,$b,$u){var $Z=this._get($b,$u);return 0==$Z.ret||(this._fill($Z.x,$Z.y,$b,$u,$$),this._texCount++),$Z},$b._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$b._init=function($$,$b){if(this._width=$$,this._height=$b,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$r(this._height);for(var $u=0;$u<this._height;$u++)this._rowInfo[$u]=new $Z;return this._clear(),!0},$b._get=function($$,$b){var $u=new $c;if($$>=this._failSize.width&&$b>=this._failSize.height)return $u;for(var $Z=-1,$E=-1,$r=this._width,$F=this._height,$x=this._cells,$g=0;$g<$F;$g++)if(!(this._rowInfo[$g].spaceCount<$$))for(var $H=0;$H<$r;){var $w=3*($g*$r+$H);if(0!=$x[$w]||$x[1+$w]<$$||$x[2+$w]<$b)$H+=$x[1+$w];else{$Z=$H,$E=$g;for(var $I=0;$I<$$;$I++)if($x[3*$I+$w+2]<$b){$Z=-1;break}if(!($Z<0))return $u.ret=!0,$u.x=$Z,$u.y=$E,$u;$H+=$x[1+$w]}}return $u},$b._fill=function($$,$b,$u,$Z,$E){var $r=this._width,$F=this._height;this._check($$+$u<=$r&&$b+$Z<=$F);for(var $x=$b;$x<$Z+$b;++$x){this._check(this._rowInfo[$x].spaceCount>=$u),this._rowInfo[$x].spaceCount-=$u;for(var $g=0;$g<$u;$g++){var $H=3*($$+$x*$r+$g);this._check(0==this._cells[$H]),this._cells[$H]=$E,this._cells[1+$H]=$u,this._cells[2+$H]=$Z}}if(0<$$)for($x=0;$x<$Z;++$x){var $w=0;for($g=$$-1;0<=$g&&0==this._cells[3*(($b+$x)*$r+$g)];--$g,++$w);for($g=$w;0<$g;--$g)this._cells[3*(($b+$x)*$r+$$-$g)+1]=$g,this._check(0<$g)}if(0<$b)for($g=$$;$g<$$+$u;++$g){for($w=0,$x=$b-1;0<=$x&&0==this._cells[3*($g+$x*$r)];--$x,$w++);for($x=$w;0<$x;--$x)this._cells[3*($g+($b-$x)*$r)+2]=$x,this._check(0<$x)}},$b._check=function($$){0==$$&&console.log("xtexMerger 错误啦")},$b._clear=function(){for(var $$=this._texCount=0;$$<this._height;$$++)this._rowInfo[$$].spaceCount=this._width;for(var $b=0;$b<this._height;$b++)for(var $u=0;$u<this._width;$u++){var $Z=3*($b*this._width+$u);this._cells[$Z]=0,this._cells[1+$Z]=this._width-$u,this._cells[2+$Z]=this._width-$b}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$$.__init$=function(){$Z=function(){function $$(){this.spaceCount=0}return $o($$,""),$$}(),$E=function(){function $$(){this.width=0,this.height=0}return $o($$,""),$$}()},$$}(),$n=function(){function $T($$,$b,$u,$Z){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$$,this._height=$b,this._gridSize=$u,this._maxAtlaserCount=$Z,this._gridNumX=$$/$u,this._gridNumY=$b/$u,this._curAtlasIndex=0,this._atlaserArray=[]}$o($T,"laya.webgl.atlas.AtlasResourceManager");var $$=$T.prototype;return $$.setAtlasParam=function($$,$b,$u,$Z){if(1==this._setAtlasParam)return $T._sid_=0,this._width=$$,this._height=$b,this._gridSize=$u,this._maxAtlaserCount=$Z,this._gridNumX=$$/$u,this._gridNumY=$b/$u,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$$.pushData=function($$){var $b,$u=$$.bitmap,$Z=-1,$E=null,$r=0,$F=0;for($r=0,$b=this._atlaserArray.length;$r<$b&&($F=(this._curAtlasIndex+$r)%$b,-1==($Z=($E=this._atlaserArray[$F]).findBitmapIsExist($u)));$r++);if(-1!=$Z){var $x=$E.InAtlasWebGLImagesOffsetValue[$Z];return $D=$x[0],$e=$x[1],$E.addToAtlas($$,$D,$e),!0}this._setAtlasParam=!1;for(var $g=Math.ceil(($$.bitmap.width+2)/this._gridSize),$H=Math.ceil(($$.bitmap.height+2)/this._gridSize),$w=!1,$I=0;$I<2;$I++){var $o=this._maxAtlaserCount;for($r=0;$r<$o;$r++){$F=(this._curAtlasIndex+$r)%$o,this._atlaserArray.length-1>=$F||this._atlaserArray.push(new $C$(this._gridNumX,this._gridNumY,this._width,this._height,$T._sid_++));var $N=this._atlaserArray[$F],$D=0,$e=0,$L=$N.addTex(1,$g,$H);if($L.ret){$D=$L.x*this._gridSize+1,$e=$L.y*this._gridSize+1,$u.lock=!0,$N.addToAtlasTexture($u,$D,$e),$N.addToAtlas($$,$D,$e),$w=!0,this._curAtlasIndex=$F;break}}if($w)break;this._atlaserArray.push(new $C$(this._gridNumX,this._gridNumY,this._width,this._height,$T._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $w||console.log(">>>AtlasManager pushData error"),$w},$$.addToAtlas=function($$){laya.webgl.atlas.AtlasResourceManager.instance.pushData($$)},$$.garbageCollection=function(){if(!0===this._needGC){for(var $$=this._atlaserArray.length-this._maxAtlaserCount,$b=0;$b<$$;$b++)this._atlaserArray[$b].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$$),this._atlaserArray.splice(0,$$),this._needGC=!1}return!0},$$.freeAll=function(){for(var $$=0,$b=this._atlaserArray.length;$$<$b;$$++)this._atlaserArray[$$].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$$.getAtlaserCount=function(){return this._atlaserArray.length},$$.getAtlaserByIndex=function($$){return this._atlaserArray[$$]},$Z(1,$T,"instance",function(){return $T._Instance||($T._Instance=new $T(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$T._Instance}),$Z(1,$T,"enabled",function(){return $z.atlasEnable}),$Z(1,$T,"atlasLimitWidth",function(){return $T._atlasLimitWidth},function($$){$T._atlasLimitWidth=$$}),$Z(1,$T,"atlasLimitHeight",function(){return $T._atlasLimitHeight},function($$){$T._atlasLimitHeight=$$}),$T._enable=function(){$z.atlasEnable=!0},$T._disable=function(){$z.atlasEnable=!1},$T.__init__=function(){$T.atlasTextureWidth=2048,$T.atlasTextureHeight=2048,$T.maxTextureCount=6,$T.atlasLimitWidth=512,$T.atlasLimitHeight=512},$T._atlasLimitWidth=0,$T._atlasLimitHeight=0,$T.gridSize=16,$T.atlasTextureWidth=0,$T.atlasTextureHeight=0,$T.maxTextureCount=0,$T._atlasRestore=0,$T.BOARDER_TYPE_NO=0,$T.BOARDER_TYPE_RIGHT=1,$T.BOARDER_TYPE_LEFT=2,$T.BOARDER_TYPE_BOTTOM=4,$T.BOARDER_TYPE_TOP=8,$T.BOARDER_TYPE_ALL=15,$T._sid_=0,$T._Instance=null,$T}(),$c=function(){function $$(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $o($$,"laya.webgl.atlas.MergeFillInfo"),$$}(),$J=function(){function $b(){}return $o($b,"laya.webgl.canvas.BlendMode"),$b._init_=function($$){$b.fns=[$b.BlendNormal,$b.BlendAdd,$b.BlendMultiply,$b.BlendScreen,$b.BlendOverlay,$b.BlendLight,$b.BlendMask,$b.BlendDestinationOut],$b.targetFns=[$b.BlendNormalTarget,$b.BlendAddTarget,$b.BlendMultiplyTarget,$b.BlendScreenTarget,$b.BlendOverlayTarget,$b.BlendLightTarget,$b.BlendMask,$b.BlendDestinationOut]},$b.BlendNormal=function($$){$$.blendFunc(1,771)},$b.BlendAdd=function($$){$$.blendFunc(1,772)},$b.BlendMultiply=function($$){$$.blendFunc(774,771)},$b.BlendScreen=function($$){$$.blendFunc(1,1)},$b.BlendOverlay=function($$){$$.blendFunc(1,769)},$b.BlendLight=function($$){$$.blendFunc(1,1)},$b.BlendNormalTarget=function($$){$$.blendFunc(1,771)},$b.BlendAddTarget=function($$){$$.blendFunc(1,772)},$b.BlendMultiplyTarget=function($$){$$.blendFunc(774,771)},$b.BlendScreenTarget=function($$){$$.blendFunc(1,1)},$b.BlendOverlayTarget=function($$){$$.blendFunc(1,769)},$b.BlendLightTarget=function($$){$$.blendFunc(1,1)},$b.BlendMask=function($$){$$.blendFunc(0,770)},$b.BlendDestinationOut=function($$){$$.blendFunc(0,0)},$b.activeBlendFunction=null,$b.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$b.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$b.NORMAL="normal",$b.ADD="add",$b.MULTIPLY="multiply",$b.SCREEN="screen",$b.LIGHT="light",$b.OVERLAY="overlay",$b.DESTINATIONOUT="destination-out",$b.fns=[],$b.targetFns=[],$b}(),$f=function(){function $u($$){this._color=$D.create("black"),this.setValue($$)}$o($u,"laya.webgl.canvas.DrawStyle");var $$=$u.prototype;return $$.setValue=function($$){if($$){if("string"==typeof $$)return void(this._color=$D.create($$));if($$ instanceof laya.utils.Color)return void(this._color=$$)}},$$.reset=function(){this._color=$D.create("black")},$$.equal=function($$){return"string"==typeof $$?this._color.strColor===$$:$$ instanceof laya.utils.Color&&this._color.numColor===$$.numColor},$$.toColorStr=function(){return this._color.strColor},$u.create=function($$){var $b;if($$&&("string"==typeof $$?$b=$D.create($$):$$ instanceof laya.utils.Color&&($b=$$),$b))return $b._drawStyle||($b._drawStyle=new $u($$));return laya.webgl.canvas.DrawStyle.DEFAULT},$F($u,["DEFAULT",function(){return this.DEFAULT=new $u("#000000")}]),$u}(),$Q=function(){function $$(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$S$.mainContext;this.ib=$B$.create(35048),this.vb=$R$.create(5)}$o($$,"laya.webgl.canvas.Path");var $b=$$.prototype;return $b.addPoint=function($$,$b){this.tempArray.push($$,$b)},$b.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$b.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$b.polygon=function($$,$b,$u,$Z,$E,$r){var $F;return this.geomatrys.push(this._curGeomatry=$F=new $v$($$,$b,$u,$Z,$E,$r)),$Z||($F.fill=!1),null==$r&&($F.borderWidth=0),$F},$b.setGeomtry=function($$){this.geomatrys.push(this._curGeomatry=$$)},$b.drawLine=function($$,$b,$u,$Z,$E){var $r;return this.closePath?this.geomatrys.push(this._curGeomatry=$r=new $V$($$,$b,$u,$Z,$E)):this.geomatrys.push(this._curGeomatry=$r=new $O$($$,$b,$u,$Z,$E)),$r.fill=!1,$r},$b.update=function(){var $$=this.ib._byteLength,$b=this.geomatrys.length;this.offset=$$;for(var $u=this.geoStart;$u<$b;$u++)this.geomatrys[$u].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$b,this.count=(this.ib._byteLength-$$)/$e$.BYTES_PIDX},$b.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$b.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$$}(),$W=function(){function $x(){}$o($x,"laya.webgl.canvas.save.SaveBase");var $$=$x.prototype;return $i.imps($$,{"laya.webgl.canvas.save.ISaveData":!0}),$$.isSaveMark=function(){return!1},$$.restore=function($$){this._dataObj[this._valueName]=this._value,($x._cache[$x._cache._length++]=this)._newSubmit&&($$._curSubmit=$r$.RENDERBASE,$$._renderKey=0)},$x._createArray=function(){var $$=[];return $$._length=0,$$},$x._init=function(){var $$=$x._namemap={};return $$[1]="ALPHA",$$[2]="fillStyle",$$[8]="font",$$[256]="lineWidth",$$[512]="strokeStyle",$$[8192]="_mergeID",$$[1024]=$$[2048]=$$[4096]=[],$$[16384]="textBaseline",$$[32768]="textAlign",$$[65536]="_nBlendType",$$[1048576]="shader",$$[2097152]="filters",$$},$x.save=function($$,$b,$u,$Z){if(($$._saveMark._saveuse&$b)!==$b){$$._saveMark._saveuse|=$b;var $E=$x._cache,$r=0<$E._length?$E[--$E._length]:new $x;$r._value=$u[$r._valueName=$x._namemap[$b]],$r._dataObj=$u,$r._newSubmit=$Z;var $F=$$._save;$F[$F._length++]=$r}},$x._cache=laya.webgl.canvas.save.SaveBase._createArray(),$x._namemap=$x._init(),$x}(),$G=function(){function $r(){this._clipRect=new $C}$o($r,"laya.webgl.canvas.save.SaveClipRect");var $$=$r.prototype;return $i.imps($$,{"laya.webgl.canvas.save.ISaveData":!0}),$$.isSaveMark=function(){return!1},$$.restore=function($$){$$._clipRect=this._clipSaveRect,($r._cache[$r._cache._length++]=this)._submitScissor.submitLength=$$._submits._length-this._submitScissor.submitIndex,$$._curSubmit=$r$.RENDERBASE,$$._renderKey=0},$r.save=function($$,$b){if(131072!=(131072&$$._saveMark._saveuse)){$$._saveMark._saveuse|=131072;var $u=$r._cache,$Z=0<$u._length?$u[--$u._length]:new $r;$Z._clipSaveRect=$$._clipRect,$$._clipRect=$Z._clipRect.copyFrom($$._clipRect),$Z._submitScissor=$b;var $E=$$._save;$E[$E._length++]=$Z}},$F($r,["_cache",function(){return this._cache=$W._createArray()}]),$r}(),$A=function(){function $N(){this._contextX=0,this._contextY=0,this._clipRect=new $C,this._rect=new $C,this._matrix=new $a}$o($N,"laya.webgl.canvas.save.SaveClipRectStencil");var $$=$N.prototype;return $i.imps($$,{"laya.webgl.canvas.save.ISaveData":!0}),$$.isSaveMark=function(){return!1},$$.restore=function($$){$w$.restore($$,this._rect,this._saveMatrix,this._contextX,this._contextY),$$._clipRect=this._clipSaveRect,$$._curMat=this._saveMatrix,$$._x=this._contextX,$$._y=this._contextY,$N._cache[$N._cache._length++]=this,$$._curSubmit=$r$.RENDERBASE},$N.save=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){if(262144!=(262144&$$._saveMark._saveuse)){$$._saveMark._saveuse|=262144;var $w=$N._cache,$I=0<$w._length?$w[--$w._length]:new $N;$I._clipSaveRect=$$._clipRect,$I._clipRect.setTo($F,$x,$g,$H),$$._clipRect=$I._clipRect,$I._rect.x=$u,$I._rect.y=$Z,$I._rect.width=$E,$I._rect.height=$r,$I._contextX=$$._x,$I._contextY=$$._y,$I._saveMatrix=$$._curMat,$$._curMat.copyTo($I._matrix),$$._curMat=$I._matrix,$I._submitStencil=$b;var $o=$$._save;$o[$o._length++]=$I}},$F($N,["_cache",function(){return this._cache=$W._createArray()}]),$N}(),$j=function(){function $Z(){this._saveuse=0}$o($Z,"laya.webgl.canvas.save.SaveMark");var $$=$Z.prototype;return $i.imps($$,{"laya.webgl.canvas.save.ISaveData":!0}),$$.isSaveMark=function(){return!0},$$.restore=function($$){$$._saveMark=this._preSaveMark,$Z._no[$Z._no._length++]=this},$Z.Create=function($$){var $b=$Z._no,$u=0<$b._length?$b[--$b._length]:new $Z;return $u._saveuse=0,$u._preSaveMark=$$._saveMark,$$._saveMark=$u},$F($Z,["_no",function(){return this._no=$W._createArray()}]),$Z}(),$h=function(){function $r(){this._matrix=new $a}$o($r,"laya.webgl.canvas.save.SaveTransform");var $$=$r.prototype;return $i.imps($$,{"laya.webgl.canvas.save.ISaveData":!0}),$$.isSaveMark=function(){return!1},$$.restore=function($$){$$._curMat=this._savematrix,$r._no[$r._no._length++]=this},$r.save=function($$){var $b=$$._saveMark;if(2048!=(2048&$b._saveuse)){$b._saveuse|=2048;var $u=$r._no,$Z=0<$u._length?$u[--$u._length]:new $r;$Z._savematrix=$$._curMat,$$._curMat=$$._curMat.copyTo($Z._matrix);var $E=$$._save;$E[$E._length++]=$Z}},$F($r,["_no",function(){return this._no=$W._createArray()}]),$r}(),$d=function(){function $E(){}$o($E,"laya.webgl.canvas.save.SaveTranslate");var $$=$E.prototype;return $i.imps($$,{"laya.webgl.canvas.save.ISaveData":!0}),$$.isSaveMark=function(){return!1},$$.restore=function($$){$$._curMat;$$._x=this._x,$$._y=this._y,$E._no[$E._no._length++]=this},$E.save=function($$){var $b=$E._no,$u=0<$b._length?$b[--$b._length]:new $E;$u._x=$$._x,$u._y=$$._y;var $Z=$$._save;$Z[$Z._length++]=$u},$F($E,["_no",function(){return this._no=$W._createArray()}]),$E}(),$U=function(){function $$(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $C}$o($$,"laya.webgl.resource.RenderTargetMAX");var $b=$$.prototype;return $b.setSP=function($$){this._sp=$$},$b.size=function($$,$b){var $u=this;this._width!==$$||this._height!==$b?(this.repaint=!0,this._width=$$,this._height=$b,this.target?this.target.size($$,$b):this.target=$l$.create($$,$b),this.target.hasListener("recovered")||this.target.on("recovered",this,function($$){$i.timer.callLater($u._sp,$u._sp.repaint)})):this.target.size($$,$b)},$b._flushToTarget=function($$,$b){if(!$b._destroy){var $u=$_$.worldScissorTest,$Z=$_$.worldClipRect;$_$.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$_$.worldScissorTest=!1,$S$.mainContext.disable(3089);var $E=$_$.worldAlpha,$r=$_$.worldMatrix4,$F=$_$.worldMatrix,$x=$_$.worldFilters,$g=$_$.worldShaderDefines;if($_$.worldMatrix=$a.EMPTY,$_$.restoreTempArray(),$_$.worldMatrix4=$_$.TEMPMAT4_ARRAY,$_$.worldAlpha=1,$_$.worldFilters=null,$_$.worldShaderDefines=null,$M$.activeShader=null,$b.start(),$z.showCanvasMark?$b.clear(0,1,0,.3):$b.clear(0,0,0,0),$$.flush(),$b.end(),$M$.activeShader=null,$_$.worldAlpha=$E,$_$.worldMatrix4=$r,$_$.worldMatrix=$F,$_$.worldFilters=$x,$_$.worldShaderDefines=$g,$_$.worldScissorTest=$u){var $H=$_$.height-$Z.y-$Z.height;$S$.mainContext.scissor($Z.x,$H,$Z.width,$Z.height),$S$.mainContext.enable(3089)}$_$.worldClipRect=$Z}},$b.flush=function($$){this.repaint&&(this._flushToTarget($$,this.target),this.repaint=!1)},$b.drawTo=function($$,$b,$u,$Z,$E){$$.drawTexture(this.target.getTexture(),$b,$u,$Z,$E,0,0)},$b.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$$}(),$B=function(){function $$(){this.ALPHA=1,this.shaderType=0,this.defines=new $K$}return $o($$,"laya.webgl.shader.d2.Shader2D"),$$.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$$.__init__=function(){var $$,$b;$j$.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$j$.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$j$.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$j$.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$j$.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$j$.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$j$.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$j$.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$$="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$b='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$j$.preCompile2D(0,1,$$,$b,null),$$="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$b='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$j$.preCompile2D(0,2,$$,$b,null),$$="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$b="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$j$.preCompile2D(0,4,$$,$b,null),$$="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$b='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$j$.preCompile2D(0,256,$$,$b,null),$$="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$b="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$j$.preCompile2D(0,512,$$,$b,null)},$$}(),$R=function(){function $b($$,$b,$u){this._value=0,this._name2int=$$,this._int2name=$b,this._int2nameMap=$u}$o($b,"laya.webgl.shader.ShaderDefines");var $$=$b.prototype;return $$.add=function($$){return"string"==typeof $$&&($$=this._name2int[$$]),this._value|=$$,this._value},$$.addInt=function($$){return this._value|=$$,this._value},$$.remove=function($$){return"string"==typeof $$&&($$=this._name2int[$$]),this._value&=~$$,this._value},$$.isDefine=function($$){return(this._value&$$)===$$},$$.getValue=function(){return this._value},$$.setValue=function($$){this._value=$$},$$.toNameDic=function(){var $$=this._int2nameMap[this._value];return $$||$b._toText(this._value,this._int2name,this._int2nameMap)},$b._reg=function($$,$b,$u,$Z){$Z[$u[$$]=$b]=$$},$b._toText=function($$,$b,$u){var $Z=$u[$$];if($Z)return $Z;for(var $E={},$r=1,$F=0;$F<32&&!($$<($r=1<<$F));$F++)if($$&$r){var $x=$b[$r];$x&&($E[$x]="")}return $u[$$]=$E},$b._toInt=function($$,$b){for(var $u=$$.split("."),$Z=0,$E=0,$r=$u.length;$E<$r;$E++){var $F=$b[$u[$E]];if(!$F)throw new Error("Defines to int err:"+$$+"/"+$u[$E]);$Z|=$F}return $Z},$b}(),$$$=function(){function $F(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $a}$o($F,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $$=$F.prototype;return $$.init=function($$,$b,$u){if($b)this._vs=$b;else{this._vs=[];var $Z=$$.width,$E=$$.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($Z,0,1,0,1,1,1,1),this._vs.push($Z,$E,1,1,1,1,1,1),this._vs.push(0,$E,0,1,1,1,1,1)}$u?this._ps=$u:($F._defaultPS||($F._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$F._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$$},$$.init2=function($$,$b,$u,$Z,$E){this.transform&&(this.transform=null),$u?this._ps=$u:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$Z,this._uvs=$E,this.mEleNum=this._ps.length,this.mTexture=$$,($T.isConchNode||$T.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$$._initMyData=function(){var $$=0,$b=0,$u=4*this._verticles.length;this._vs=$F._tempVS;var $Z=!1;if($T.isConchNode||$T.isConchApp?(this._vs.length=$u,$Z=!0):this._vs.length<$u&&(this._vs.length=$u,$Z=!0),$F._tVSLen=$u,$Z)for(;$$<$u;)this._vs[$$]=this._verticles[$b],this._vs[$$+1]=this._verticles[$b+1],this._vs[$$+2]=this._uvs[$b],this._vs[$$+3]=this._uvs[$b+1],this._vs[$$+4]=1,this._vs[$$+5]=1,this._vs[$$+6]=1,this._vs[$$+7]=1,$$+=8,$b+=2;else for(;$$<$u;)this._vs[$$]=this._verticles[$b],this._vs[$$+1]=this._verticles[$b+1],this._vs[$$+2]=this._uvs[$b],this._vs[$$+3]=this._uvs[$b+1],$$+=8,$b+=2},$$.getData2=function($$,$b,$u){var $Z;this.mVBBuffer=$$,this.mIBBuffer=$b,this._initMyData(),$$.appendEx2(this._vs,Float32Array,$F._tVSLen,4),this._indexStart=$b._byteLength,($Z=$F._tempIB).length<this._ps.length&&($Z.length=this._ps.length);for(var $E=0,$r=this._ps.length;$E<$r;$E++)$Z[$E]=this._ps[$E]+$u;$b.appendEx2($Z,Uint16Array,this._ps.length,2)},$$.getData=function($$,$b,$u){if(this.mVBBuffer=$$,this.mIBBuffer=$b,$$.append(this.mVBData),this._indexStart=$b._byteLength,this.mIBData.start!=$u){for(var $Z=0,$E=this._ps.length;$Z<$E;$Z++)this.mIBData[$Z]=this._ps[$Z]+$u;this.mIBData.start=$u}$b.append(this.mIBData)},$$.render=function($$,$b,$u){if($T.isWebGL&&this.mTexture){$$._renderKey=0,$$._shader2D.glTexture=null,$b$.getInstance().addSkinMesh(this);var $Z=$r$.createShape($$,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$q$.create(512,0));this.transform||(this.transform=$a.EMPTY),this.transform.translate($b,$u),$a.mul(this.transform,$$._curMat,this._tempMatrix),this.transform.translate(-$b,-$u);var $E=$Z.shaderValue,$r=$E.u_mmat2||$_$.getMatrArray();$_$.mat2MatArray(this._tempMatrix,$r),$E.textureHost=this.mTexture,$E.offsetX=0,$E.offsetY=0,$E.u_mmat2=$r,$E.ALPHA=$$._shader2D.ALPHA,$$._submits[$$._submits._length++]=$Z}else $T.isConchApp&&this.mTexture&&(this.transform||(this.transform=$a.EMPTY),$$.setSkinMesh&&$$.setSkinMesh($b,$u,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$F._tempVS=[],$F._tempIB=[],$F._defaultPS=null,$F._tVSLen=0,$F}(),$b$=function(){function $$(){this.ib=null,this.vb=null;$S$.mainContext;this.ib=$B$.create(35048),this.vb=$R$.create(8)}$o($$,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $b=$$.prototype;return $b.addSkinMesh=function($$){$$.getData2(this.vb,this.ib,this.vb._byteLength/32)},$b.reset=function(){this.vb.clear(),this.ib.clear()},$$.getInstance=function(){return $$.instance=$$.instance||new $$},$$.instance=null,$$}(),$u$=function(){function $$($$,$b,$u,$Z,$E,$r,$F,$x,$g){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$g&&($g=0),this.x=$$,this.y=$b,this.width=$u,this.height=$Z,this.edges=$E,this.color=$r,this.borderWidth=$F,this.borderColor=$x}$o($$,"laya.webgl.shapes.BasePoly");var $b=$$.prototype;return $i.imps($b,{"laya.webgl.shapes.IShape":!0}),$b.getData=function($$,$b,$u){},$b.rebuild=function($$){},$b.setMatrix=function($$){},$b.needUpdate=function($$){return!0},$b.sector=function($$,$b,$u){var $Z=this.x,$E=this.y,$r=this.edges,$F=(this.r1-this.r0)/$r,$x=this.width,$g=this.height,$H=this.color,$w=($H>>16&255)/255,$I=($H>>8&255)/255,$o=(255&$H)/255;$$.push($Z,$E,$w,$I,$o);for(var $N=0;$N<$r+1;$N++)$$.push($Z+Math.sin($F*$N+this.r0)*$x,$E+Math.cos($F*$N+this.r0)*$g),$$.push($w,$I,$o);for($N=0;$N<$r;$N++)$b.push($u,$u+$N+1,$u+$N+2)},$b.createLine2=function($$,$b,$u,$Z,$E,$r){var $F,$x,$g,$H,$w,$I,$o,$N,$D,$e,$L,$T,$_,$y,$S,$P,$i,$z,$q,$a,$t=$$.concat(),$C=$E,$K=this.borderColor,$O=($K>>16&255)/255,$V=($K>>8&255)/255,$v=(255&$K)/255,$p=$t.length/2,$Y=$Z,$k=$u/2;$g=$t[0],$H=$t[1],$e=$g-($w=$t[2]),$D=($D=-($H-($I=$t[3])))/($a=Math.sqrt($D*$D+$e*$e))*$k,$e=$e/$a*$k,$C.push($g-$D+this.x,$H-$e+this.y,$O,$V,$v,$g+$D+this.x,$H+$e+this.y,$O,$V,$v);for(var $M=1;$M<$p-1;$M++)$g=$t[2*($M-1)],$H=$t[2*($M-1)+1],$w=$t[2*$M],$I=$t[2*$M+1],$o=$t[2*($M+1)],$N=$t[2*($M+1)+1],$e=$g-$w,$T=$w-$o,$S=(-($D=($D=-($H-$I))/($a=Math.sqrt($D*$D+$e*$e))*$k)+$g)*(-($e=$e/$a*$k)+$I)-(-$D+$w)*(-$e+$H),$z=(-($L=($L=-($I-$N))/($a=Math.sqrt($L*$L+$T*$T))*$k)+$o)*(-($T=$T/$a*$k)+$I)-(-$L+$w)*(-$T+$N),$q=($_=-$e+$H-(-$e+$I))*($i=-$L+$w-(-$L+$o))-($P=-$T+$N-(-$T+$I))*($y=-$D+$w-(-$D+$g)),Math.abs($q)<.1?($q+=10.1,$C.push($w-$D+this.x,$I-$e+this.y,$O,$V,$v,$w+$D+this.x,$I+$e+this.y,$O,$V,$v)):((($F=($y*$z-$i*$S)/$q)-$w)*($F-$w)+(($x=($P*$S-$_*$z)/$q)-$I)+($x-$I),$C.push($F+this.x,$x+this.y,$O,$V,$v,$w-($F-$w)+this.x,$I-($x-$I)+this.y,$O,$V,$v));$g=$t[$t.length-4],$H=$t[$t.length-3],$e=$g-($w=$t[$t.length-2]),$D=($D=-($H-($I=$t[$t.length-1])))/($a=Math.sqrt($D*$D+$e*$e))*$k,$e=$e/$a*$k,$C.push($w-$D+this.x,$I-$e+this.y,$O,$V,$v,$w+$D+this.x,$I+$e+this.y,$O,$V,$v);var $l=$r;for($M=1;$M<$l;$M++)$b.push($Y+2*($M-1),$Y+2*($M-1)+1,$Y+2*$M+1,$Y+2*$M+1,$Y+2*$M,$Y+2*($M-1));return $C},$b.createLine=function($$,$b,$u,$Z){var $E=$$.concat(),$r=$$,$F=this.borderColor,$x=($F>>16&255)/255,$g=($F>>8&255)/255,$H=(255&$F)/255;$E.splice(0,5);var $w,$I,$o,$N,$D,$e,$L,$T,$_,$y,$S,$P,$i,$z,$q,$a,$t,$C,$K,$O,$V=$E.length/5,$v=$Z,$p=$u/2;$o=$E[0],$N=$E[1],$y=$o-($D=$E[5]),$_=($_=-($N-($e=$E[6])))/($O=Math.sqrt($_*$_+$y*$y))*$p,$y=$y/$O*$p,$r.push($o-$_,$N-$y,$x,$g,$H,$o+$_,$N+$y,$x,$g,$H);for(var $Y=1;$Y<$V-1;$Y++)$o=$E[5*($Y-1)],$N=$E[5*($Y-1)+1],$D=$E[5*$Y],$e=$E[5*$Y+1],$L=$E[5*($Y+1)],$T=$E[5*($Y+1)+1],$y=$o-$D,$P=$D-$L,$q=(-($_=($_=-($N-$e))/($O=Math.sqrt($_*$_+$y*$y))*$p)+$o)*(-($y=$y/$O*$p)+$e)-(-$_+$D)*(-$y+$N),$C=(-($S=($S=-($e-$T))/($O=Math.sqrt($S*$S+$P*$P))*$p)+$L)*(-($P=$P/$O*$p)+$e)-(-$S+$D)*(-$P+$T),$K=($i=-$y+$N-(-$y+$e))*($t=-$S+$D-(-$S+$L))-($a=-$P+$T-(-$P+$e))*($z=-$_+$D-(-$_+$o)),Math.abs($K)<.1?($K+=10.1,$r.push($D-$_,$e-$y,$x,$g,$H,$D+$_,$e+$y,$x,$g,$H)):((($w=($z*$C-$t*$q)/$K)-$D)*($w-$D)+(($I=($a*$q-$i*$C)/$K)-$e)+($I-$e),$r.push($w,$I,$x,$g,$H,$D-($w-$D),$e-($I-$e),$x,$g,$H));$o=$E[$E.length-10],$N=$E[$E.length-9],$y=$o-($D=$E[$E.length-5]),$_=($_=-($N-($e=$E[$E.length-4])))/($O=Math.sqrt($_*$_+$y*$y))*$p,$y=$y/$O*$p,$r.push($D-$_,$e-$y,$x,$g,$H,$D+$_,$e+$y,$x,$g,$H);var $k=this.edges+1;for($Y=1;$Y<$k;$Y++)$b.push($v+2*($Y-1),$v+2*($Y-1)+1,$v+2*$Y+1,$v+2*$Y+1,$v+2*$Y,$v+2*($Y-1));return $r},$b.createLoopLine=function($$,$b,$u,$Z,$E,$r){var $F=$$.concat(),$x=$E||$$,$g=this.borderColor,$H=($g>>16&255)/255,$w=($g>>8&255)/255,$I=(255&$g)/255;$F.splice(0,5);var $o=[$F[0],$F[1]],$N=[$F[$F.length-5],$F[$F.length-4]],$D=$N[0]+.5*($o[0]-$N[0]),$e=$N[1]+.5*($o[1]-$N[1]);$F.unshift($D,$e,0,0,0),$F.push($D,$e,0,0,0);var $L,$T,$_,$y,$S,$P,$i,$z,$q,$a,$t,$C,$K,$O,$V,$v,$p,$Y,$k,$M,$l=$F.length/5,$X=$Z,$s=$u/2;$_=$F[0],$y=$F[1],$a=$_-($S=$F[5]),$q=($q=-($y-($P=$F[6])))/($M=Math.sqrt($q*$q+$a*$a))*$s,$a=$a/$M*$s,$x.push($_-$q,$y-$a,$H,$w,$I,$_+$q,$y+$a,$H,$w,$I);for(var $m=1;$m<$l-1;$m++)$_=$F[5*($m-1)],$y=$F[5*($m-1)+1],$S=$F[5*$m],$P=$F[5*$m+1],$i=$F[5*($m+1)],$z=$F[5*($m+1)+1],$a=$_-$S,$C=$S-$i,$V=(-($q=($q=-($y-$P))/($M=Math.sqrt($q*$q+$a*$a))*$s)+$_)*(-($a=$a/$M*$s)+$P)-(-$q+$S)*(-$a+$y),$Y=(-($t=($t=-($P-$z))/($M=Math.sqrt($t*$t+$C*$C))*$s)+$i)*(-($C=$C/$M*$s)+$P)-(-$t+$S)*(-$C+$z),$k=($K=-$a+$y-(-$a+$P))*($p=-$t+$S-(-$t+$i))-($v=-$C+$z-(-$C+$P))*($O=-$q+$S-(-$q+$_)),Math.abs($k)<.1?($k+=10.1,$x.push($S-$q,$P-$a,$H,$w,$I,$S+$q,$P+$a,$H,$w,$I)):((($L=($O*$Y-$p*$V)/$k)-$S)*($L-$S)+(($T=($v*$V-$K*$Y)/$k)-$P)+($T-$P),$x.push($L,$T,$H,$w,$I,$S-($L-$S),$P-($T-$P),$H,$w,$I));$r&&($b=$r);var $n=this.edges+1;for($m=1;$m<$n;$m++)$b.push($X+2*($m-1),$X+2*($m-1)+1,$X+2*$m+1,$X+2*$m+1,$X+2*$m,$X+2*($m-1));return $b.push($X+2*($m-1),$X+2*($m-1)+1,$X+1,$X+1,$X,$X+2*($m-1)),$x},$$}(),$Z$=function(){function $e(){}return $o($e,"laya.webgl.shapes.Earcut"),$e.earcut=function($$,$b,$u){$u=$u||2;var $Z,$E,$r,$F,$x,$g,$H,$w=$b&&$b.length,$I=$w?$b[0]*$u:$$.length,$o=$e.linkedList($$,0,$I,$u,!0),$N=[];if(!$o)return $N;if($w&&($o=$e.eliminateHoles($$,$b,$o,$u)),$$.length>80*$u){$Z=$r=$$[0],$E=$F=$$[1];for(var $D=$u;$D<$I;$D+=$u)($x=$$[$D])<$Z&&($Z=$x),($g=$$[$D+1])<$E&&($E=$g),$r<$x&&($r=$x),$F<$g&&($F=$g);$H=0!==($H=Math.max($r-$Z,$F-$E))?1/$H:0}return $e.earcutLinked($o,$N,$u,$Z,$E,$H),$N},$e.linkedList=function($$,$b,$u,$Z,$E){var $r,$F;if($E===0<$e.signedArea($$,$b,$u,$Z))for($r=$b;$r<$u;$r+=$Z)$F=$e.insertNode($r,$$[$r],$$[$r+1],$F);else for($r=$u-$Z;$b<=$r;$r-=$Z)$F=$e.insertNode($r,$$[$r],$$[$r+1],$F);return $F&&$e.equals($F,$F.next)&&($e.removeNode($F),$F=$F.next),$F},$e.filterPoints=function($$,$b){if(!$$)return $$;$b||($b=$$);var $u,$Z=$$;do{if($u=!1,$Z.steiner||!$e.equals($Z,$Z.next)&&0!==$e.area($Z.prev,$Z,$Z.next))$Z=$Z.next;else{if($e.removeNode($Z),($Z=$b=$Z.prev)===$Z.next)break;$u=!0}}while($u||$Z!==$b);return $b},$e.earcutLinked=function($$,$b,$u,$Z,$E,$r,$F){if($$){!$F&&$r&&$e.indexCurve($$,$Z,$E,$r);for(var $x,$g,$H=$$;$$.prev!==$$.next;)if($x=$$.prev,$g=$$.next,$r?$e.isEarHashed($$,$Z,$E,$r):$e.isEar($$))$b.push($x.i/$u),$b.push($$.i/$u),$b.push($g.i/$u),$e.removeNode($$),$$=$g.next,$H=$g.next;else if(($$=$g)===$H){$F?1===$F?($$=$e.cureLocalIntersections($$,$b,$u),$e.earcutLinked($$,$b,$u,$Z,$E,$r,2)):2===$F&&$e.splitEarcut($$,$b,$u,$Z,$E,$r):$e.earcutLinked($e.filterPoints($$,null),$b,$u,$Z,$E,$r,1);break}}},$e.isEar=function($$){var $b=$$.prev,$u=$$,$Z=$$.next;if(0<=$e.area($b,$u,$Z))return!1;for(var $E=$$.next.next;$E!==$$.prev;){if($e.pointInTriangle($b.x,$b.y,$u.x,$u.y,$Z.x,$Z.y,$E.x,$E.y)&&0<=$e.area($E.prev,$E,$E.next))return!1;$E=$E.next}return!0},$e.isEarHashed=function($$,$b,$u,$Z){var $E=$$.prev,$r=$$,$F=$$.next;if(0<=$e.area($E,$r,$F))return!1;for(var $x=$E.x<$r.x?$E.x<$F.x?$E.x:$F.x:$r.x<$F.x?$r.x:$F.x,$g=$E.y<$r.y?$E.y<$F.y?$E.y:$F.y:$r.y<$F.y?$r.y:$F.y,$H=$E.x>$r.x?$E.x>$F.x?$E.x:$F.x:$r.x>$F.x?$r.x:$F.x,$w=$E.y>$r.y?$E.y>$F.y?$E.y:$F.y:$r.y>$F.y?$r.y:$F.y,$I=$e.zOrder($x,$g,$b,$u,$Z),$o=$e.zOrder($H,$w,$b,$u,$Z),$N=$$.nextZ;$N&&$N.z<=$o;){if($N!==$$.prev&&$N!==$$.next&&$e.pointInTriangle($E.x,$E.y,$r.x,$r.y,$F.x,$F.y,$N.x,$N.y)&&0<=$e.area($N.prev,$N,$N.next))return!1;$N=$N.nextZ}for($N=$$.prevZ;$N&&$N.z>=$I;){if($N!==$$.prev&&$N!==$$.next&&$e.pointInTriangle($E.x,$E.y,$r.x,$r.y,$F.x,$F.y,$N.x,$N.y)&&0<=$e.area($N.prev,$N,$N.next))return!1;$N=$N.prevZ}return!0},$e.cureLocalIntersections=function($$,$b,$u){var $Z=$$;do{var $E=$Z.prev,$r=$Z.next.next;!$e.equals($E,$r)&&$e.intersects($E,$Z,$Z.next,$r)&&$e.locallyInside($E,$r)&&$e.locallyInside($r,$E)&&($b.push($E.i/$u),$b.push($Z.i/$u),$b.push($r.i/$u),$e.removeNode($Z),$e.removeNode($Z.next),$Z=$$=$r),$Z=$Z.next}while($Z!==$$);return $Z},$e.splitEarcut=function($$,$b,$u,$Z,$E,$r){var $F=$$;do{for(var $x=$F.next.next;$x!==$F.prev;){if($F.i!==$x.i&&$e.isValidDiagonal($F,$x)){var $g=$e.splitPolygon($F,$x);return $F=$e.filterPoints($F,$F.next),$g=$e.filterPoints($g,$g.next),$e.earcutLinked($F,$b,$u,$Z,$E,$r),void $e.earcutLinked($g,$b,$u,$Z,$E,$r)}$x=$x.next}$F=$F.next}while($F!==$$)},$e.eliminateHoles=function($$,$b,$u,$Z){var $E,$r,$F,$x,$g,$H=[];for($E=0,$r=$b.length;$E<$r;$E++)$F=$b[$E]*$Z,$x=$E<$r-1?$b[$E+1]*$Z:$$.length,($g=$e.linkedList($$,$F,$x,$Z,!1))===$g.next&&($g.steiner=!0),$H.push($e.getLeftmost($g));for($H.sort($e.compareX),$E=0;$E<$H.length;$E++)$e.eliminateHole($H[$E],$u),$u=$e.filterPoints($u,$u.next);return $u},$e.compareX=function($$,$b){return $$.x-$b.x},$e.eliminateHole=function($$,$b){if($b=$e.findHoleBridge($$,$b)){var $u=$e.splitPolygon($b,$$);$e.filterPoints($u,$u.next)}},$e.findHoleBridge=function($$,$b){var $u,$Z=$b,$E=$$.x,$r=$$.y,$F=-1/0;do{if($r<=$Z.y&&$r>=$Z.next.y&&$Z.next.y!==$Z.y){var $x=$Z.x+($r-$Z.y)*($Z.next.x-$Z.x)/($Z.next.y-$Z.y);if($x<=$E&&$F<$x){if(($F=$x)===$E){if($r===$Z.y)return $Z;if($r===$Z.next.y)return $Z.next}$u=$Z.x<$Z.next.x?$Z:$Z.next}}$Z=$Z.next}while($Z!==$b);if(!$u)return null;if($E===$F)return $u.prev;var $g,$H=$u,$w=$u.x,$I=$u.y,$o=1/0;for($Z=$u.next;$Z!==$H;)$E>=$Z.x&&$Z.x>=$w&&$E!==$Z.x&&$e.pointInTriangle($r<$I?$E:$F,$r,$w,$I,$r<$I?$F:$E,$r,$Z.x,$Z.y)&&(($g=Math.abs($r-$Z.y)/($E-$Z.x))<$o||$g===$o&&$Z.x>$u.x)&&$e.locallyInside($Z,$$)&&($u=$Z,$o=$g),$Z=$Z.next;return $u},$e.indexCurve=function($$,$b,$u,$Z){for(var $E=$$;null===$E.z&&($E.z=$e.zOrder($E.x,$E.y,$b,$u,$Z)),$E.prevZ=$E.prev,$E.nextZ=$E.next,($E=$E.next)!==$$;);$E.prevZ.nextZ=null,$E.prevZ=null,$e.sortLinked($E)},$e.sortLinked=function($$){var $b,$u,$Z,$E,$r,$F,$x,$g,$H=1;do{for($u=$$,$r=$$=null,$F=0;$u;){for($F++,$Z=$u,$b=$x=0;$b<$H&&($x++,$Z=$Z.nextZ);$b++);for($g=$H;0<$x||0<$g&&$Z;)0!==$x&&(0===$g||!$Z||$u.z<=$Z.z)?($u=($E=$u).nextZ,$x--):($Z=($E=$Z).nextZ,$g--),$r?$r.nextZ=$E:$$=$E,$E.prevZ=$r,$r=$E;$u=$Z}$r.nextZ=null,$H*=2}while(1<$F);return $$},$e.zOrder=function($$,$b,$u,$Z,$E){return($$=1431655765&(($$=858993459&(($$=252645135&(($$=16711935&(($$=32767*($$-$u)*$E)|$$<<8))|$$<<4))|$$<<2))|$$<<1))|($b=1431655765&(($b=858993459&(($b=252645135&(($b=16711935&(($b=32767*($b-$Z)*$E)|$b<<8))|$b<<4))|$b<<2))|$b<<1))<<1},$e.getLeftmost=function($$){for(var $b=$$,$u=$$;$b.x<$u.x&&($u=$b),($b=$b.next)!==$$;);return $u},$e.pointInTriangle=function($$,$b,$u,$Z,$E,$r,$F,$x){return 0<=($E-$F)*($b-$x)-($$-$F)*($r-$x)&&0<=($$-$F)*($Z-$x)-($u-$F)*($b-$x)&&0<=($u-$F)*($r-$x)-($E-$F)*($Z-$x)},$e.isValidDiagonal=function($$,$b){return $$.next.i!==$b.i&&$$.prev.i!==$b.i&&!$e.intersectsPolygon($$,$b)&&$e.locallyInside($$,$b)&&$e.locallyInside($b,$$)&&$e.middleInside($$,$b)},$e.area=function($$,$b,$u){return($b.y-$$.y)*($u.x-$b.x)-($b.x-$$.x)*($u.y-$b.y)},$e.equals=function($$,$b){return $$.x===$b.x&&$$.y===$b.y},$e.intersects=function($$,$b,$u,$Z){return!!($e.equals($$,$b)&&$e.equals($u,$Z)||$e.equals($$,$Z)&&$e.equals($u,$b))||0<$e.area($$,$b,$u)!=0<$e.area($$,$b,$Z)&&0<$e.area($u,$Z,$$)!=0<$e.area($u,$Z,$b)},$e.intersectsPolygon=function($$,$b){var $u=$$;do{if($u.i!==$$.i&&$u.next.i!==$$.i&&$u.i!==$b.i&&$u.next.i!==$b.i&&$e.intersects($u,$u.next,$$,$b))return!0;$u=$u.next}while($u!==$$);return!1},$e.locallyInside=function($$,$b){return $e.area($$.prev,$$,$$.next)<0?0<=$e.area($$,$b,$$.next)&&0<=$e.area($$,$$.prev,$b):$e.area($$,$b,$$.prev)<0||$e.area($$,$$.next,$b)<0},$e.middleInside=function($$,$b){for(var $u=$$,$Z=!1,$E=($$.x+$b.x)/2,$r=($$.y+$b.y)/2;$u.y>$r!=$u.next.y>$r&&$u.next.y!==$u.y&&$E<($u.next.x-$u.x)*($r-$u.y)/($u.next.y-$u.y)+$u.x&&($Z=!$Z),($u=$u.next)!==$$;);return $Z},$e.splitPolygon=function($$,$b){var $u=new $E$($$.i,$$.x,$$.y),$Z=new $E$($b.i,$b.x,$b.y),$E=$$.next,$r=$b.prev;return($$.next=$b).prev=$$,($u.next=$E).prev=$u,($Z.next=$u).prev=$Z,($r.next=$Z).prev=$r,$Z},$e.insertNode=function($$,$b,$u,$Z){var $E=new $E$($$,$b,$u);return $Z?($E.next=$Z.next,($E.prev=$Z).next.prev=$E,$Z.next=$E):($E.prev=$E).next=$E,$E},$e.removeNode=function($$){$$.next.prev=$$.prev,$$.prev.next=$$.next,$$.prevZ&&($$.prevZ.nextZ=$$.nextZ),$$.nextZ&&($$.nextZ.prevZ=$$.prevZ)},$e.signedArea=function($$,$b,$u,$Z){for(var $E=0,$r=$b,$F=$u-$Z;$r<$u;$r+=$Z)$E+=($$[$F]-$$[$r])*($$[$r+1]+$$[$F+1]),$F=$r;return $E},$e}(),$E$=function(){function $$($$,$b,$u){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$$,this.x=$b,this.y=$u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $o($$,"laya.webgl.shapes.EarcutNode"),$$}(),$r$=(function(){function $$($$,$b,$u,$Z,$E,$r,$F){this.lineWidth=$$,this.lineColor=$b,this.lineAlpha=$u,this.fillColor=$Z,this.fillAlpha=$E,this.shape=$F,this.fill=$r}$o($$,"laya.webgl.shapes.GeometryData");var $b=$$.prototype;$b.clone=function(){return new $$(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$b.getIndexData=function(){return null},$b.getVertexData=function(){return null},$b.destroy=function(){this.shape=null}}(),function(){function $$($$){if($$ instanceof Float32Array)this.points=$$;else if($$ instanceof Array){$$.length;this.points=new Float32Array($$)}}$o($$,"laya.webgl.shapes.Vertex");var $b=$$.prototype;$i.imps($b,{"laya.webgl.shapes.IShape":!0}),$b.getData=function($$,$b,$u){},$b.needUpdate=function($$){return!1},$b.rebuild=function($$){},$b.setMatrix=function($$){}}(),function(){function $g($$){void 0===$$&&($$=1e4),this._renderType=$$}$o($g,"laya.webgl.submit.Submit");var $$=$g.prototype;return $i.imps($$,{"laya.webgl.submit.ISubmit":!0}),$$.releaseRender=function(){var $$=$g._cache;($$[$$._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$$.getRenderType=function(){return this._renderType},$$.renderSubmit=function(){if(0===this._numEle)return 1;var $$=this.shaderValue.textureHost;if($$){var $b=$$.source;if(!$$.bitmap||!$b)return 1;this.shaderValue.texture=$b,$$.alphaTexture&&$$.alphaTexture.source&&(this.shaderValue.texture1=$$.alphaTexture.source)}this._vb.bind_upload(this._ib);var $u=$S$.mainContext;return this.shaderValue.upload(),$J.activeBlendFunction!==this._blendFn&&($u.enable(3042),this._blendFn($u),$J.activeBlendFunction=this._blendFn),$V.drawCall++,$V.trianglesFaces+=this._numEle/3,$u.drawElements(4,this._numEle,5123,this._startIdx),1},$g.__init__=function(){var $$=$g.RENDERBASE=new $g(-1);$$.shaderValue=new $q$(0,0),$$.shaderValue.ALPHA=-1234},$g.createSubmit=function($$,$b,$u,$Z,$E){var $r=$g._cache._length?$g._cache[--$g._cache._length]:new $g;null==$u&&(($u=$r._selfVb||($r._selfVb=$R$.create(-1))).clear(),$Z=0),$r._ib=$b,$r._vb=$u,$r._startIdx=$Z*$e$.BYTES_PIDX,$r._numEle=0;var $F=$$._nBlendType;$r._blendFn=$$._targets?$J.targetFns[$F]:$J.fns[$F],$r.shaderValue=$E,$r.shaderValue.setValue($$._shader2D);var $x=$$._shader2D.filters;return $x&&$r.shaderValue.setFilters($x),$r},$g.createShape=function($$,$b,$u,$Z,$E,$r){var $F=$g._cache._length?$g._cache[--$g._cache._length]:new $g;$F._ib=$b,$F._vb=$u,$F._numEle=$Z,$F._startIdx=$E,$F.shaderValue=$r,$F.shaderValue.setValue($$._shader2D);var $x=$$._nBlendType;return $F._blendFn=$$._targets?$J.targetFns[$x]:$J.fns[$x],$F},$g.TYPE_2D=1e4,$g.TYPE_CANVAS=10003,$g.TYPE_CMDSETRT=10004,$g.TYPE_CUSTOM=10005,$g.TYPE_BLURRT=10006,$g.TYPE_CMDDESTORYPRERT=10007,$g.TYPE_DISABLESTENCIL=10008,$g.TYPE_OTHERIBVB=10009,$g.TYPE_PRIMITIVE=10010,$g.TYPE_RT=10011,$g.TYPE_BLUR_RT=10012,$g.TYPE_TARGET=10013,$g.TYPE_CHANGE_VALUE=10014,$g.TYPE_SHAPE=10015,$g.TYPE_TEXTURE=10016,$g.TYPE_FILLTEXTURE=10017,$g.RENDERBASE=null,$g._cache=(($g._cache=[])._length=0,$g._cache),$g}()),$F$=function(){function $Z(){this.fun=null,this.args=null}$o($Z,"laya.webgl.submit.SubmitCMD");var $$=$Z.prototype;return $i.imps($$,{"laya.webgl.submit.ISubmit":!0}),$$.renderSubmit=function(){return this.fun.apply(null,this.args),1},$$.getRenderType=function(){return 0},$$.releaseRender=function(){var $$=$Z._cache;$$[$$._length++]=this},$Z.create=function($$,$b){var $u=$Z._cache._length?$Z._cache[--$Z._cache._length]:new $Z;return $u.fun=$b,$u.args=$$,$u},$Z._cache=(($Z._cache=[])._length=0,$Z._cache),$Z}(),$x$=function(){function $b(){this.variables={}}$o($b,"laya.webgl.submit.SubmitCMDScope");var $$=$b.prototype;return $$.getValue=function($$){return this.variables[$$]},$$.addValue=function($$,$b){return this.variables[$$]=$b},$$.setValue=function($$,$b){return this.variables.hasOwnProperty($$)?this.variables[$$]=$b:null},$$.clear=function(){for(var $$ in this.variables)delete this.variables[$$]},$$.recycle=function(){this.clear(),$b.POOL.push(this)},$b.create=function(){var $$=$b.POOL.pop();return $$||($$=new $b),$$},$b.POOL=[],$b}(),$g$=function(){function $I(){this.offset=0,this.startIndex=0,this._mat=$a.create()}$o($I,"laya.webgl.submit.SubmitOtherIBVB");var $$=$I.prototype;return $i.imps($$,{"laya.webgl.submit.ISubmit":!0}),$$.releaseRender=function(){var $$=$I._cache;($$[$$._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$$.getRenderType=function(){return 10009},$$.renderSubmit=function(){var $$=this._shaderValue.textureHost;if($$){var $b=$$.source;if(!$$.bitmap||!$b)return 1;this._shaderValue.texture=$b}this._vb.bind_upload(this._ib);var $u=$_$.worldMatrix4,$Z=$a.TEMP;$a.mulPre(this._mat,$u[0],$u[1],$u[4],$u[5],$u[12],$u[13],$Z);var $E=$_$.worldMatrix4=$I.tempMatrix4;$E[0]=$Z.a,$E[1]=$Z.b,$E[4]=$Z.c,$E[5]=$Z.d,$E[12]=$Z.tx,$E[13]=$Z.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $r=$S$.mainContext;return $J.activeBlendFunction!==this._blendFn&&($r.enable(3042),this._blendFn($r),$J.activeBlendFunction=this._blendFn),$V.drawCall++,$V.trianglesFaces+=this._numEle/3,$r.drawElements(4,this._numEle,5123,this.startIndex),$_$.worldMatrix4=$u,$M$.activeShader=null,1},$I.create=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){void 0===$g&&($g=0);var $H=$I._cache._length?$I._cache[--$I._cache._length]:new $I;$H._ib=$u,$H._vb=$b,$H._numEle=$Z,$H._shader=$E,$H._shaderValue=$r;var $w=$$._nBlendType;switch($H._blendFn=$$._targets?$J.targetFns[$w]:$J.fns[$w],$g){case 0:$H.offset=0,$H.startIndex=$x/($e$.BYTES_PE*$b.vertexStride)*1.5,$H.startIndex*=$e$.BYTES_PIDX;break;case 1:$H.startIndex=$F,$H.offset=$x}return $H},$I._cache=(($I._cache=[])._length=0,$I._cache),$I.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$I}(),$H$=function(){function $u(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $C,this.screenRect=new $C}$o($u,"laya.webgl.submit.SubmitScissor");var $$=$u.prototype;return $i.imps($$,{"laya.webgl.submit.ISubmit":!0}),$$._scissor=function($$,$b,$u,$Z){var $E=$_$.worldMatrix4,$r=$E[0],$F=$E[5],$x=$E[12],$g=$E[13];if($Z*=$F,($u*=$r)<1||$Z<1)return!1;var $H=($$=$$*$r+$x)+$u,$w=($b=$b*$F+$g)+$Z;$$<0&&($u=$H-($$=0)),$b<0&&($Z=$w-($b=0));var $I=$_$.worldClipRect;if($$=Math.max($$,$I.x),$b=Math.max($b,$I.y),$u=Math.min($H,$I.right)-$$,$Z=Math.min($w,$I.bottom)-$b,$u<1||$Z<1)return!1;var $o=$_$.worldScissorTest;return this.screenRect.copyFrom($I),$I.x=$$,$I.y=$b,$I.width=$u,$I.height=$Z,$_$.worldScissorTest=!0,$b=$_$.height-$b-$Z,$S$.mainContext.scissor($$,$b,$u,$Z),$S$.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$o?($b=$_$.height-this.screenRect.y-this.screenRect.height,$S$.mainContext.scissor(this.screenRect.x,$b,this.screenRect.width,this.screenRect.height),$S$.mainContext.enable(3089)):($S$.mainContext.disable(3089),$_$.worldScissorTest=!1),$I.copyFrom(this.screenRect),!0},$$._scissorWithTagart=function($$,$b,$u,$Z){if($u<1||$Z<1)return!1;var $E=$$+$u,$r=$b+$Z;$$<0&&($u=$E-($$=0)),$b<0&&($Z=$r-($b=0));var $F=$_$.worldClipRect;if($$=Math.max($$,$F.x),$b=Math.max($b,$F.y),$u=Math.min($E,$F.right)-$$,$Z=Math.min($r,$F.bottom)-$b,$u<1||$Z<1)return!1;var $x=$_$.worldScissorTest;return this.screenRect.copyFrom($F),$_$.worldScissorTest=!0,$F.x=$$,$F.y=$b,$F.width=$u,$F.height=$Z,$b=$_$.height-$b-$Z,$S$.mainContext.scissor($$,$b,$u,$Z),$S$.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$x?($b=$_$.height-this.screenRect.y-this.screenRect.height,$S$.mainContext.scissor(this.screenRect.x,$b,this.screenRect.width,this.screenRect.height),$S$.mainContext.enable(3089)):($S$.mainContext.disable(3089),$_$.worldScissorTest=!1),$F.copyFrom(this.screenRect),!0},$$.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$$.getRenderType=function(){return 0},$$.releaseRender=function(){var $$=$u._cache;($$[$$._length++]=this).context=null},$u.create=function($$){var $b=$u._cache._length?$u._cache[--$u._cache._length]:new $u;return $b.context=$$,$b},$u._cache=(($u._cache=[])._length=0,$u._cache),$u}(),$w$=function(){function $g(){this.step=0,this.blendMode=null,this.level=0}$o($g,"laya.webgl.submit.SubmitStencil");var $$=$g.prototype;return $i.imps($$,{"laya.webgl.submit.ISubmit":!0}),$$.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$$.getRenderType=function(){return 0},$$.releaseRender=function(){var $$=$g._cache;$$[$$._length++]=this},$$.do1=function(){var $$=$S$.mainContext;$$.enable(2960),$$.clear(1024),$$.colorMask(!1,!1,!1,!1),$$.stencilFunc(514,this.level,255),$$.stencilOp(7680,7680,7682)},$$.do2=function(){var $$=$S$.mainContext;$$.stencilFunc(514,this.level+1,255),$$.colorMask(!0,!0,!0,!0),$$.stencilOp(7680,7680,7680)},$$.do3=function(){var $$=$S$.mainContext;$$.colorMask(!0,!0,!0,!0),$$.stencilOp(7680,7680,7680),$$.clear(1024),$$.disable(2960)},$$.do4=function(){var $$=$S$.mainContext;0==this.level&&($$.enable(2960),$$.clear(1024)),$$.colorMask(!1,!1,!1,!1),$$.stencilFunc(519,0,255),$$.stencilOp(7680,7680,7682)},$$.do5=function(){var $$=$S$.mainContext;$$.stencilFunc(514,this.level,255),$$.colorMask(!0,!0,!0,!0),$$.stencilOp(7680,7680,7680)},$$.do6=function(){var $$=$S$.mainContext;$J.targetFns[$J.TOINT[this.blendMode]]($$)},$$.do7=function(){var $$=$S$.mainContext;$$.colorMask(!1,!1,!1,!1),$$.stencilOp(7680,7680,7683)},$$.do8=function(){var $$=$S$.mainContext;$$.colorMask(!0,!0,!0,!0),$$.stencilFunc(514,this.level,255),$$.stencilOp(7680,7680,7680)},$g.restore=function($$,$b,$u,$Z,$E){var $r;if(($$._renderKey=0)<$g._mask&&$g._mask--,0==$g._mask)$r=laya.webgl.submit.SubmitStencil.create(3),$$.addRenderObject($r),$$._curSubmit=$r$.RENDERBASE;else{$r=laya.webgl.submit.SubmitStencil.create(7),$$.addRenderObject($r);var $F=$$._vb;$F._byteLength;if($L$.fillRectImgVb($F,null,$b.x,$b.y,$b.width,$b.height,$k.DEF_UV,$u,$Z,$E,0,0)){$$._shader2D.glTexture=null;var $x=$$._curSubmit=$r$.createSubmit($$,$$._ib,$F,($F._byteLength-64)/32*3,$q$.create(2,0));$x.shaderValue.ALPHA=1,$$._submits[$$._submits._length++]=$x,$$._curSubmit._numEle+=6,$$._curSubmit=$r$.RENDERBASE}else alert("clipRect calc stencil rect error");$r=laya.webgl.submit.SubmitStencil.create(8),$$.addRenderObject($r)}},$g.restore2=function($$,$b){var $u;($$._renderKey=0)<$g._mask&&$g._mask--,0==$g._mask?($u=laya.webgl.submit.SubmitStencil.create(3),$$.addRenderObject($u),$$._curSubmit=$r$.RENDERBASE):($u=laya.webgl.submit.SubmitStencil.create(7),$$.addRenderObject($u),$$._submits[$$._submits._length++]=$b,$u=laya.webgl.submit.SubmitStencil.create(8),$$.addRenderObject($u))},$g.create=function($$){var $b=$g._cache._length?$g._cache[--$g._cache._length]:new $g;return 5==($b.step=$$)&&++$g._mask,$b.level=$g._mask,$b},$g._cache=(($g._cache=[])._length=0,$g._cache),$g._mask=0,$g}(),$I$=function(){function $x(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$o($x,"laya.webgl.submit.SubmitTarget");var $$=$x.prototype;return $i.imps($$,{"laya.webgl.submit.ISubmit":!0}),$$.renderSubmit=function(){this._vb.bind_upload(this._ib);var $$=this.scope.getValue(this.proName);return $$&&(this.shaderValue.texture=$$.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$$.width,$$.height]),this.shaderValue.upload(),this.blend(),$V.drawCall++,$V.trianglesFaces+=this._numEle/3,$S$.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$$.blend=function(){if($J.activeBlendFunction!==$J.fns[this.blendType]){var $$=$S$.mainContext;$$.enable(3042),$J.fns[this.blendType]($$),$J.activeBlendFunction=$J.fns[this.blendType]}},$$.getRenderType=function(){return 0},$$.releaseRender=function(){var $$=$x._cache;($$[$$._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$x.create=function($$,$b,$u,$Z,$E,$r){var $F=$x._cache._length?$x._cache[--$x._cache._length]:new $x;return $F._ib=$b,$F._vb=$u,$F.proName=$r,$F._startIdx=$Z*$e$.BYTES_PIDX,$F._numEle=0,$F.blendType=$$._nBlendType,$F.shaderValue=$E,$F.shaderValue.setValue($$._shader2D),$F},$x._cache=(($x._cache=[])._length=0,$x._cache),$x}(),$o$=function(){function $$(){this._sourceStr=null}$o($$,"laya.webgl.text.CharSegment");var $b=$$.prototype;return $i.imps($b,{"laya.webgl.text.ICharSegment":!0}),$b.textToSpit=function($$){this._sourceStr=$$},$b.getChar=function($$){return this._sourceStr.charAt($$)},$b.getCharCode=function($$){return this._sourceStr.charCodeAt($$)},$b.length=function(){return this._sourceStr.length},$$}(),$N$=function(){var $$;function $V(){}return $o($V,"laya.webgl.text.DrawText"),$V.__init__=function(){$V._charsTemp=new Array,$V._drawValue=new $$,$V._charSeg=new $o$},$V.customCharSeg=function($$){$V._charSeg=$$},$V.getChar=function($$,$b,$u){var $Z=$W$.createOneChar($$,$u);return-1!=$b&&($V._charsCache[$b]=$Z),$Z},$V._drawSlow=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I,$o,$N,$D){var $e,$L,$T=$V._drawValue.value($r,$x,$g,$H,$o,$N,$D),$_=0,$y=0,$S=$V._charsTemp,$P=0,$i=NaN;if($Z)for($S.length=$Z.length,$_=0,$y=$Z.length;$_<$y;$_++)($L=$Z[$_])&&($i=$L.charNum+$T.txtID,$S[$_]=$e=$V._charsCache[$i]||$V.getChar($L.char,$i,$T),$e.active());else{var $z=$u instanceof laya.utils.WordText?$u.toString():$u;if($Y.CharacterCache){$V._charSeg.textToSpit($z);var $q=$V._charSeg.length();for($_=0,$y=$S.length=$q;$_<$y;$_++)$i=$V._charSeg.getCharCode($_)+$T.txtID,$S[$_]=$e=$V._charsCache[$i]||$V.getChar($V._charSeg.getChar($_),$i,$T),$e.active(),$P+=$e.cw}else $S.length=0,($e=$V.getChar($z,-1,$T)).active(),$P+=$e.cw,$S[0]=$e}var $a=0;null!==$F&&"left"!==$F&&($a=-("center"==$F?$P/2:$P));var $t,$C,$K=NaN,$O=0;if($Z)for($_=0,$y=$S.length;$_<$y;$_++)$e=$S[$_],$L=$Z[$_],$e&&$L&&!$e.isSpace&&($K=$e.borderSize,$t=$e.texture,$b._drawText($t,$w+$a+$L.x*$o-$K,$I+$L.y*$N-$K,$t.width,$t.height,$E,0,0,0,0));else{for($_=0,$y=$S.length;$_<$y;$_++)($e=$S[$_])&&!$e.isSpace&&($K=$e.borderSize,$t=$e.texture,$b._drawText($t,$w+$a-$K,$I-$K,$t.width,$t.height,$E,0,0,0,0),$$&&(($C=$$[$O++])||($C=$$[$O-1]=[]),$C[0]=$t,$C[1]=$a-$K,$C[2]=-$K)),$a+=$e.cw;$$&&($$.length=$O)}},$V._drawFast=function($$,$b,$u,$Z,$E){for(var $r,$F,$x=0,$g=$$.length;$x<$g;$x++)($r=($F=$$[$x])[0]).active(),$b._drawText($r,$Z+$F[1],$E+$F[2],$r.width,$r.height,$u,0,0,0,0)},$V.drawText=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I){if(void 0===$I&&($I=0),!($b&&0===$b.length||$u&&0===$u.length)){var $o=$Z.a,$N=$Z.d;(0!==$Z.b||0!==$Z.c)&&($o=$N=1);var $D=1!==$o||1!==$N;if($D&&$i.stage.transform){var $e=$i.stage.transform;$D=$e.a===$o&&$e.d===$N}else $D=!1;if($D){var $L=($Z=$Z.copyTo($z$._tmpMatrix)).tx,$T=$Z.ty;$Z.scale(1/$o,1/$N),$Z._checkTransform(),$H*=$o,$w*=$N,$H+=$L-$Z.tx,$w+=$T-$Z.ty}else $o=$N=1;if($u)$V._drawSlow(null,$$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$o,$N,$I);else{if(null===$b.toUpperCase){var $_=$o+1e5*$N,$y=$b;return void($y.changed||$y.id!==$_?($y.id=$_,$y.changed=!1,$V._drawSlow($y.save,$$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$o,$N,$I)):$V._drawFast($y.save,$$,$Z,$H,$w))}var $S=$b+$E.toString()+$F+$x+$g+$o+$N+$r,$P=$V._textsCache[$S];$Y.CharacterCache?$P?$V._drawFast($P,$$,$Z,$H,$w):($V._textsCache.__length||($V._textsCache.__length=0),$V._textsCache.__length>$z.WebGLTextCacheCount&&(($V._textsCache={}).__length=0,$V._curPoolIndex=0),$V._textCachesPool[$V._curPoolIndex]?($P=$V._textsCache[$S]=$V._textCachesPool[$V._curPoolIndex]).length=0:$V._textCachesPool[$V._curPoolIndex]=$P=$V._textsCache[$S]=[],$V._textsCache.__length++,$V._curPoolIndex++,$V._drawSlow($P,$$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$o,$N,$I)):$V._drawSlow($P,$$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$o,$N,$I)}}},$V._charsTemp=null,$V._textCachesPool=[],$V._curPoolIndex=0,$V._charsCache={},$V._textsCache={},$V._drawValue=null,$V.d=[],$V._charSeg=null,$V.__init$=function(){$$=function(){function $g(){}return $o($g,""),$g.prototype.value=function($$,$b,$u,$Z,$E,$r,$F){this.font=$$,this.fillColor=$b,this.borderColor=$u,this.lineWidth=$Z,this.scaleX=$E,this.scaleY=$r,this.underLine=$F;var $x=$$.toString()+$E+$r+$Z+($b?$b.toLowerCase():" ")+($u?$u.toLowerCase():" ")+$F;return this.txtID=$g._keymap[$x],this.txtID||(this.txtID=1e-7*++$g._keymapCount,$g._keymap[$x]=this.txtID),this},$g.clear=function(){$g._keymap={},$g._keymapCount=1},$g._keymap={},$g._keymapCount=1,$g}()},$V}(),$D$=function(){function $E($$){this._index=0,this._size=14,this._italic=-2,$E._cache2=$E._cache2||[],this.setFont($$||"14px Arial")}$o($E,"laya.webgl.text.FontInContext");var $$=$E.prototype;return $$.setFont=function($$){var $b=$E._cache2[$$];if($b)this._words=$b[0],this._size=$b[1];else{this._words=$$.split(" ");for(var $u=0,$Z=this._words.length;$u<$Z;$u++)if(0<this._words[$u].indexOf("px")){this._index=$u;break}this._size=parseInt(this._words[this._index]),$E._cache2[$$]=[this._words,this._size]}this._text=null,this._italic=-2},$$.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$$.hasType=function($$){for(var $b=0,$u=this._words.length;$b<$u;$b++)if(this._words[$b]===$$)return $b;return-1},$$.removeType=function($$){for(var $b=0,$u=this._words.length;$b<$u;$b++)if(this._words[$b]===$$){this._words.splice($b,1),this._index>$b&&this._index--;break}this._text=null,this._italic=-2},$$.copyTo=function($$){return $$._text=this._text,$$._size=this._size,$$._index=this._index,$$._words=this._words.slice(),$$._italic=-2,$$},$$.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$Z(0,$$,"size",function(){return this._size},function($$){this._size=$$,this._words[this._index]=$$+"px",this._text=null}),$E.create=function($$){var $b=$E._cache[$$];return $b||($b=$E._cache[$$]=new $E($$))},$E.EMPTY=new $E,$E._cache={},$E._cache2=null,$E}(),$e$=function(){function $$(){}return $o($$,"laya.webgl.utils.CONST3D2D"),$$.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$$.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$$.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$$._TMPARRAY=[],$$._OFFSETX=0,$$._OFFSETY=0,$F($$,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$$}(),$L$=function(){function $D(){}return $o($D,"laya.webgl.utils.GlUtils"),$D.make2DProjection=function($$,$b,$u){return[2/$$,0,0,0,0,-2/$b,0,0,0,0,2/$u,0,-1,1,0,1]},$D.fillIBQuadrangle=function($$,$b){if(65535/4<$b)throw Error("IBQuadrangle count:"+$b+" must<:"+Math.floor(65535/4));$b=Math.floor($b),$$._resizeBuffer(6*($b+1)*2,!1),$$.byteLength=$$.bufferLength;for(var $u=$$.getUint16Array(),$Z=0,$E=0;$E<$b;$E++)$u[$Z++]=4*$E,$u[$Z++]=4*$E+2,$u[$Z++]=4*$E+1,$u[$Z++]=4*$E,$u[$Z++]=4*$E+3,$u[$Z++]=4*$E+2;return $$.setNeedUpload(),!0},$D.expandIBQuadrangle=function($$,$b){$$.bufferLength>=6*$b*2||$D.fillIBQuadrangle($$,$b)},$D.mathCeilPowerOfTwo=function($$){return $$--,$$|=$$>>1,$$|=$$>>2,$$|=$$>>4,$$|=$$>>8,$$|=$$>>16,++$$},$D.fillQuadrangleImgVb=function($$,$b,$u,$Z,$E,$r,$F,$x){var $g=16+($$._byteLength>>2);$$.byteLength=$g<<2;var $H=$$.getFloat32Array();$H[($g-=16)+2]=$E[0],$H[$g+3]=$E[1],$H[$g+6]=$E[2],$H[$g+7]=$E[3],$H[$g+10]=$E[4],$H[$g+11]=$E[5],$H[$g+14]=$E[6],$H[$g+15]=$E[7];var $w=$r.a,$I=$r.b,$o=$r.c,$N=$r.d;if(1!==$w||0!==$I||0!==$o||1!==$N){$r.bTransform=!0;var $D=$r.tx+$F,$e=$r.ty+$x;$H[$g]=($Z[0]+$b)*$w+($Z[1]+$u)*$o+$D,$H[$g+1]=($Z[0]+$b)*$I+($Z[1]+$u)*$N+$e,$H[$g+4]=($Z[2]+$b)*$w+($Z[3]+$u)*$o+$D,$H[$g+5]=($Z[2]+$b)*$I+($Z[3]+$u)*$N+$e,$H[$g+8]=($Z[4]+$b)*$w+($Z[5]+$u)*$o+$D,$H[$g+9]=($Z[4]+$b)*$I+($Z[5]+$u)*$N+$e,$H[$g+12]=($Z[6]+$b)*$w+($Z[7]+$u)*$o+$D,$H[$g+13]=($Z[6]+$b)*$I+($Z[7]+$u)*$N+$e}else $r.bTransform=!1,$b+=$r.tx+$F,$u+=$r.ty+$x,$H[$g]=$b+$Z[0],$H[$g+1]=$u+$Z[1],$H[$g+4]=$b+$Z[2],$H[$g+5]=$u+$Z[3],$H[$g+8]=$b+$Z[4],$H[$g+9]=$u+$Z[5],$H[$g+12]=$b+$Z[6],$H[$g+13]=$u+$Z[7];return $$._upload=!0},$D.fillTranglesVB=function($$,$b,$u,$Z,$E,$r,$F){var $x=($$._byteLength>>2)+$Z.length;$$.byteLength=$x<<2;var $g=$$.getFloat32Array();$x-=$Z.length;for(var $H=$Z.length,$w=$E.a,$I=$E.b,$o=$E.c,$N=$E.d,$D=0;$D<$H;$D+=4)if($g[$x+$D+2]=$Z[$D+2],$g[$x+$D+3]=$Z[$D+3],1!==$w||0!==$I||0!==$o||1!==$N){$E.bTransform=!0;var $e=$E.tx+$r,$L=$E.ty+$F;$g[$x+$D]=($Z[$D]+$b)*$w+($Z[$D+1]+$u)*$o+$e,$g[$x+$D+1]=($Z[$D]+$b)*$I+($Z[$D+1]+$u)*$N+$L}else $E.bTransform=!1,$b+=$E.tx+$r,$u+=$E.ty+$F,$g[$x+$D]=$b+$Z[$D],$g[$x+$D+1]=$u+$Z[$D+1];return $$._upload=!0},$D.copyPreImgVb=function($$,$b,$u){var $Z=$$._byteLength>>2;$$.byteLength=$Z+16<<2;for(var $E=$$.getFloat32Array(),$r=0,$F=$Z-16;$r<4;$r++)$E[$Z]=$E[$F]+$b,++$F,$E[++$Z]=$E[$F]+$u,++$F,$E[++$Z]=$E[$F],++$F,$E[++$Z]=$E[$F],++$Z,++$F;$$._upload=!0},$D.fillRectImgVb=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I,$o){void 0===$o&&($o=!1);var $N,$D,$e,$L,$T,$_,$y,$S,$P,$i,$z,$q,$a,$t,$C,$K,$O=1,$V=$x.a,$v=$x.b,$p=$x.c,$Y=$x.d,$k=$b&&$b.width<99999999;if(1!==$V||0!==$v||0!==$p||1!==$Y?($x.bTransform=!0,0===$v&&0===$p&&($O=23,$P=$E+$u,$i=$r+$Z,$N=$V*$u+($z=$x.tx+$g),$e=$V*$P+$z,$D=$Y*$Z+($q=$x.ty+$H),$L=$Y*$i+$q)):($O=23,$x.bTransform=!1,$e=($N=$u+$x.tx+$g)+$E,$L=($D=$Z+$x.ty+$H)+$r),$k&&($T=$b.x,$_=$b.y,$y=$b.width+$T,$S=$b.height+$_),1!==$O){if(Math.min($N,$e)>=$y)return!1;if(Math.min($D,$L)>=$S)return!1;if(Math.max($e,$N)<=$T)return!1;if(Math.max($L,$D)<=$_)return!1}var $M=$$._byteLength>>2;$$.byteLength=16+$M<<2;var $l=$$.getFloat32Array();switch($l[2+$M]=$F[0],$l[3+$M]=$F[1],$l[6+$M]=$F[2],$l[7+$M]=$F[3],$l[10+$M]=$F[4],$l[11+$M]=$F[5],$l[14+$M]=$F[6],$l[15+$M]=$F[7],$O){case 1:$z=$x.tx+$g,$q=$x.ty+$H;var $X=$V*$u,$s=$p*$Z,$m=$Y*$Z,$n=$v*$u,$c=$V*($P=$E+$u),$J=$p*($i=$r+$Z),$f=$Y*$i,$Q=$v*$P;$o?($a=$X+$s+$z,$C=Math.round($a)-$a,$t=$m+$n+$q,$K=Math.round($t)-$t,$l[$M]=$a+$C,$l[1+$M]=$t+$K,$l[4+$M]=$c+$s+$z+$C,$l[5+$M]=$m+$Q+$q+$K,$l[8+$M]=$c+$J+$z+$C,$l[9+$M]=$f+$Q+$q+$K,$l[12+$M]=$X+$J+$z+$C,$l[13+$M]=$f+$n+$q+$K):($l[$M]=$X+$s+$z,$l[1+$M]=$m+$n+$q,$l[4+$M]=$c+$s+$z,$l[5+$M]=$m+$Q+$q,$l[8+$M]=$c+$J+$z,$l[9+$M]=$f+$Q+$q,$l[12+$M]=$X+$J+$z,$l[13+$M]=$f+$n+$q);break;case 23:$o?($a=$N+$w,$C=Math.round($a)-$a,$t=$D,$K=Math.round($t)-$t,$l[$M]=$a+$C,$l[1+$M]=$t+$K,$l[4+$M]=$e+$w+$C,$l[5+$M]=$D+$K,$l[8+$M]=$e+$C,$l[9+$M]=$L+$K,$l[12+$M]=$N+$C,$l[13+$M]=$L+$K):($l[$M]=$N+$w,$l[1+$M]=$D,$l[4+$M]=$e+$w,$l[5+$M]=$D,$l[8+$M]=$e,$l[9+$M]=$L,$l[12+$M]=$N,$l[13+$M]=$L)}return $$._upload=!0},$D.fillLineVb=function($$,$b,$u,$Z,$E,$r,$F,$x){var $g=.5*$F,$H=$D._fillLineArray,$w=-($Z-$r),$I=$u-$E,$o=Math.sqrt($w*$w+$I*$I);$w/=$o,$I/=$o,$w*=$g,$I*=$g,$H[0]=$u-$w,$H[1]=$Z-$I,$H[4]=$u+$w,$H[5]=$Z+$I,$H[8]=$E+$w,$H[9]=$r+$I,$H[12]=$E-$w,$H[13]=$r-$I,$x&&$x.transformPointArray($H,$H);var $N=16+($$._byteLength>>2);return $$.byteLength=$N<<2,$$.insertData($H,$N-16),!0},$D._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$D}(),$T$=(function(){function $g(){}$o($g,"laya.webgl.utils.MatirxArray"),$g.ArrayMul=function($$,$b,$u){if($$)if($b)for(var $Z=NaN,$E=NaN,$r=NaN,$F=NaN,$x=0;$x<4;$x++)$Z=$$[$x],$E=$$[$x+4],$r=$$[$x+8],$F=$$[$x+12],$u[$x]=$Z*$b[0]+$E*$b[1]+$r*$b[2]+$F*$b[3],$u[$x+4]=$Z*$b[4]+$E*$b[5]+$r*$b[6]+$F*$b[7],$u[$x+8]=$Z*$b[8]+$E*$b[9]+$r*$b[10]+$F*$b[11],$u[$x+12]=$Z*$b[12]+$E*$b[13]+$r*$b[14]+$F*$b[15];else $g.copyArray($$,$u);else $g.copyArray($b,$u)},$g.copyArray=function($$,$b){if($$&&$b)for(var $u=0;$u<$$.length;$u++)$b[$u]=$$[$u]}}(),function(){function $b($$,$b,$u){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$$,this._vb=new $R$($$,35048),$b&&this._vb._resizeBuffer($b,!1),this._ib=new $B$,$u&&this._ib._resizeBuffer($u,!1)}$o($b,"laya.webgl.utils.Mesh2D");var $$=$b.prototype;return $$.cloneWithNewVB=function(){var $$=new $b(this._stride,0,0);return $$._ib=this._ib,$$._quadNum=this._quadNum,$$._attribInfo=this._attribInfo,$$},$$.cloneWithNewVBIB=function(){var $$=new $b(this._stride,0,0);return $$._attribInfo=this._attribInfo,$$},$$.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$$.getVBR=function(){return this._vb},$$.getIBR=function(){return this._ib},$$.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$$.createQuadIB=function($$){this._quadNum=$$,this._ib._resizeBuffer(6*$$*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $b=this._ib.getUint16Array(),$u=0,$Z=0,$E=0;$E<$$;$E++)$b[$u++]=$Z,$b[$u++]=$Z+2,$b[$u++]=$Z+1,$b[$u++]=$Z,$b[$u++]=$Z+3,$b[$u++]=$Z+2,$Z+=4;this._ib.setNeedUpload()},$$.setAttributes=function($$){if(this._attribInfo=$$,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$$.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$$.releaseMesh=function(){},$$.destroy=function(){},$$.clearVB=function(){this._vb.clear()},$b._gvaoid=0,$b}()),$_$=function(){function $E(){}return $o($E,"laya.webgl.utils.RenderState2D"),$E.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$E.mat2MatArray=function($$,$b){var $u=$$,$Z=$b;return $Z[0]=$u.a,$Z[1]=$u.b,$Z[2]=$E.EMPTYMAT4_ARRAY[2],$Z[3]=$E.EMPTYMAT4_ARRAY[3],$Z[4]=$u.c,$Z[5]=$u.d,$Z[6]=$E.EMPTYMAT4_ARRAY[6],$Z[7]=$E.EMPTYMAT4_ARRAY[7],$Z[8]=$E.EMPTYMAT4_ARRAY[8],$Z[9]=$E.EMPTYMAT4_ARRAY[9],$Z[10]=$E.EMPTYMAT4_ARRAY[10],$Z[11]=$E.EMPTYMAT4_ARRAY[11],$Z[12]=$u.tx,$Z[13]=$u.ty,$Z[14]=$E.EMPTYMAT4_ARRAY[14],$Z[15]=$E.EMPTYMAT4_ARRAY[15],$b},$E.restoreTempArray=function(){$E.TEMPMAT4_ARRAY[0]=1,$E.TEMPMAT4_ARRAY[1]=0,$E.TEMPMAT4_ARRAY[4]=0,$E.TEMPMAT4_ARRAY[5]=1,$E.TEMPMAT4_ARRAY[12]=0,$E.TEMPMAT4_ARRAY[13]=0},$E.clear=function(){$E.worldScissorTest=!1,$E.worldShaderDefines=null,$E.worldFilters=null,$E.worldAlpha=1,$E.worldClipRect.x=$E.worldClipRect.y=0,$E.worldClipRect.width=$E.width,$E.worldClipRect.height=$E.height,$E.curRenderTarget=null},$E._MAXSIZE=99999999,$E.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$E.worldMatrix4=$E.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$E.worldAlpha=1,$E.worldScissorTest=!1,$E.worldFilters=null,$E.worldShaderDefines=null,$E.curRenderTarget=null,$E.width=0,$E.height=0,$F($E,["worldMatrix",function(){return this.worldMatrix=new $a},"worldClipRect",function(){return this.worldClipRect=new $C(0,0,99999999,99999999)}]),$E}(),$y$=function(){var $_,$u;function $y($$,$b,$u,$Z,$E){var $r=this;function $F($$){var $b=[],$u=new $_($b);return $r._compileToTree($u,$$.split("\n"),0,$b,$E),$u}var $x=$N.now();this._VS=$F($b),this._PS=$F($u),this._nameMap=$Z,2<$N.now()-$x&&console.log("ShaderCompile use time:"+($N.now()-$x)+"  size:"+$b.length+"/"+$u.length)}$o($y,"laya.webgl.utils.ShaderCompile");var $$=$y.prototype;return $$._compileToTree=function($$,$b,$u,$Z,$E){var $r,$F,$x,$g,$H,$w,$I,$o=0,$N=0,$D=0,$e=0;for($N=$u;$N<$b.length;$N++)if(!(($x=$b[$N]).length<1)&&0!==($o=$x.indexOf("//"))){if(0<=$o&&($x=$x.substr(0,$o)),$r=$I||new $_($Z),$I=null,$r.text=$x,$r.noCompile=!0,0<=($o=$x.indexOf("#"))){for($g="#",$e=$o+1,$D=$x.length;$e<$D;$e++){var $L=$x.charAt($e);if(" "===$L||"\t"===$L||"\r"===$L||"\n"===$L||"?"===$L)break;$g+=$L}switch($r.name=$g){case"#ifdef":case"#ifndef":if($r.src=$x,$r.noCompile=null!=$x.match(/[!&|()=<>]/),$r.noCompile?console.log("function():Boolean{return "+$x.substr($o+$r.name.length)+"}"):($w=$x.replace(/^\s*/,"").split(/\s+/),$r.setCondition($w[1],"#ifdef"===$g?1:2),$r.text="//"+$r.text),$r.setParent($$),$$=$r,$E)for($w=$x.substr($e).split($y._splitToWordExps3),$e=0;$e<$w.length;$e++)($x=$w[$e]).length&&($E[$x]=!0);continue;case"#if":if($r.src=$x,$r.noCompile=!0,$r.setParent($$),$$=$r,$E)for($w=$x.substr($e).split($y._splitToWordExps3),$e=0;$e<$w.length;$e++)($x=$w[$e]).length&&"defined"!=$x&&($E[$x]=!0);continue;case"#else":$r.src=$x,$F=($$=$$.parent).childs[$$.childs.length-1],$r.noCompile=$F.noCompile,$r.noCompile||($r.condition=$F.condition,$r.conditionType=1==$F.conditionType?2:1,$r.text="//"+$r.text+" "+$F.text+" "+$r.conditionType),$r.setParent($$),$$=$r;continue;case"#endif":$F=($$=$$.parent).childs[$$.childs.length-1],$r.noCompile=$F.noCompile,$r.noCompile||($r.text="//"+$r.text),$r.setParent($$);continue;case"#include":$w=$y.splitToWords($x,null);var $T=$y.includes[$w[1]];if(!$T)throw"ShaderCompile error no this include file:"+$w[1];if(($o=$w[0].indexOf("?"))<0){$r.setParent($$),$x=$T.getWith("with"==$w[2]?$w[3]:null),this._compileToTree($r,$x.split("\n"),0,$Z,$E),$r.text="";continue}$r.setCondition($w[0].substr($o+1),1),$r.text=$T.getWith("with"==$w[2]?$w[3]:null);break;case"#import":$H=($w=$y.splitToWords($x,null))[1],$Z.push({node:$r,file:$y.includes[$H],ofs:$r.text.length});continue}}else{if(($F=$$.childs[$$.childs.length-1])&&!$F.name){0<$Z.length&&$y.splitToWords($x,$F),$I=$r,$F.text+="\n"+$x;continue}0<$Z.length&&$y.splitToWords($x,$r)}$r.setParent($$)}},$$.createShader=function($$,$b,$u){var $Z={},$E="";if($$)for(var $r in $$)$E+="#define "+$r+"\n",$Z[$r]=!0;var $F=this._VS.toscript($Z,[]),$x=this._PS.toscript($Z,[]);return($u||$j$.create)($E+$F.join("\n"),$E+$x.join("\n"),$b,this._nameMap)},$y._parseOne=function($$,$b,$u,$Z,$E,$r){var $F={type:$y.shaderParamsMap[$u[$Z+1]],name:$u[$Z+2],size:isNaN(parseInt($u[$Z+3]))?1:parseInt($u[$Z+3])};return $r&&("attribute"==$E?$$.push($F):$b.push($F)),":"==$u[$Z+3]&&($F.type=$u[$Z+4],$Z+=2),$Z+=2},$y.addInclude=function($$,$b){if(!$b||0===$b.length)throw new Error("add shader include file err:"+$$);if($y.includes[$$])throw new Error("add shader include file err, has add:"+$$);$y.includes[$$]=new $u($b)},$y.preGetParams=function($$,$b){var $u=[$$,$b],$Z={},$E=[],$r=[],$F={},$x=[];$Z.attributes=$E,$Z.uniforms=$r,$Z.defines=$F;for(var $g=0,$H=0,$w=0;$w<2;$w++){$u[$w]=$u[$w].replace($y._removeAnnotation,"");var $I,$o=$u[$w].match($y._reg);for($g=0,$H=$o.length;$g<$H;$g++){var $N=$o[$g];if("attribute"==$N||"uniform"==$N)$g=$y._parseOne($E,$r,$o,$g,$N,!0);else{if("#define"==$N){$x[$N=$o[++$g]]=1;continue}if("#ifdef"==$N){$F[$I=$o[++$g]]=$F[$I]||[];for($g++;$g<$H;$g++)if("attribute"==($N=$o[$g])||"uniform"==$N)$g=$y._parseOne($E,$r,$o,$g,$N,$x[$I]);else if("#else"==$N)for($g++;$g<$H;$g++)if("attribute"==($N=$o[$g])||"uniform"==$N)$g=$y._parseOne($E,$r,$o,$g,$N,!$x[$I]);else if("#endif"==$N)break}}}}return $Z},$y.splitToWords=function($$,$b){for(var $u,$Z,$E=[],$r=-1,$F=0,$x=$$.length;$F<$x;$F++)if($u=$$.charAt($F),0<=" \t=+-*/&%!<>()'\",;".indexOf($u)){if(0<=$r&&1<$F-$r&&($Z=$$.substr($r,$F-$r),$E.push($Z)),'"'==$u||"'"==$u){var $g=$$.indexOf($u,$F+1);if($g<0)throw"Sharder err:"+$$;$E.push($$.substr($F+1,$g-$F-1)),$F=$g,$r=-1;continue}"("==$u&&$b&&0<$E.length&&($Z=$E[$E.length-1]+";","vec4;main;".indexOf($Z)<0&&($b.useFuns+=$Z)),$r=-1}else $r<0&&($r=$F);return $r<$x&&1<$x-$r&&($Z=$$.substr($r,$x-$r),$E.push($Z)),$E},$y.IFDEF_NO=0,$y.IFDEF_YES=1,$y.IFDEF_ELSE=2,$y.IFDEF_PARENT=3,$y._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$y._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$y._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$y.includes={},$F($y,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$y.__init$=function(){$_=function(){function $u($$){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$$}$o($u,"");var $$=$u.prototype;return $$.setParent=function($$){$$.childs.push(this),this.z=$$.z+1,this.parent=$$},$$.setCondition=function($$,$b){$$&&(this.conditionType=$b,$$=$$.replace(/(\s*$)/g,""),this.condition=function(){return this[$$]},this.condition.__condition=$$)},$$.toscript=function($$,$b){return this._toscript($$,$b,++$u.__id)},$$._toscript=function($Z,$E,$r){if(this.childs.length<1&&!this.text)return $E;$E.length;if(this.condition){var $$=!!this.condition.call($Z);if(2===this.conditionType&&($$=!$$),!$$)return $E}if(this.text&&$E.push(this.text),0<this.childs.length&&this.childs.forEach(function($$,$b,$u){$$._toscript($Z,$E,$r)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $b,$u=0,$F=this.includefiles.length;$u<$F;$u++)this.includefiles[$u].curUseID!=$r&&0<($b=this.includefiles[$u].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$u].curUseID=$r,$E[0]=$b+$E[0]);return $E},$u.__id=1,$u}(),$u=function(){function $$($$){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$$;for(var $b=0,$u=0,$Z=0;!(($b=$$.indexOf("#begin",$b))<0);){for($Z=$b+5;!(($Z=$$.indexOf("#end",$Z))<0)&&"i"===$$.charAt($Z+4);)$Z+=5;if($Z<0)throw"add include err,no #end:"+$$;$u=$$.indexOf("\n",$b);var $E=$y.splitToWords($$.substr($b,$u-$b),null);"code"==$E[1]?this.codes[$E[2]]=$$.substr($u+1,$Z-$u-1):"function"==$E[1]&&($u=$$.indexOf("function",$b),$u+="function".length,this.funs[$E[3]]=$$.substr($u+1,$Z-$u-1),this.funnames+=$E[3]+";"),$b=$Z+1}}$o($$,"");var $b=$$.prototype;return $b.getWith=function($$){var $b=$$?this.codes[$$]:this.script;if(!$b)throw"get with error:"+$$;return $b},$b.getFunsScript=function($$){var $b="";for(var $u in this.funs)0<=$$.indexOf($u+";")&&($b+=this.funs[$u]);return $b},$$}()},$y}(),$S$=function(){function $F(){}return $o($F,"laya.webgl.WebGL"),$F._uint8ArraySlice=function(){for(var $$=this.length,$b=new Uint8Array(this.length),$u=0;$u<$$;$u++)$b[$u]=this[$u];return $b},$F._float32ArraySlice=function(){for(var $$=this.length,$b=new Float32Array(this.length),$u=0;$u<$$;$u++)$b[$u]=this[$u];return $b},$F._uint16ArraySlice=function($$){var $b,$u=arguments,$Z=0,$E=0;if(0===$u.length)for($Z=this.length,$b=new Uint16Array($Z),$E=0;$E<$Z;$E++)$b[$E]=this[$E];else if(2===$u.length){var $r=$u[0],$F=$u[1];if($r<$F)for($Z=$F-$r,$b=new Uint16Array($Z),$E=$r;$E<$F;$E++)$b[$E-$r]=this[$E];else $b=new Uint16Array(0)}return $b},$F.expandContext=function(){var $$=$E.prototype,$b=CanvasRenderingContext2D.prototype;$b.fillTrangles=$$.fillTrangles,$h$.__int__(null),$b.setIBVB=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){void 0===$g&&($g=0),void 0===$H&&($H=0),null===$u&&(this._ib=this._ib||$B$.QuadrangleIB,$u=this._ib,$L$.expandIBQuadrangle($u,$Z._byteLength/64+8)),this._setIBVB($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H)},$b.fillTrangles=function($$,$b,$u,$Z,$E){this._curMat=this._curMat||$a.create(),this._vb=this._vb||$R$.create(),this._ib||(this._ib=$B$.create(),$L$.fillIBQuadrangle(this._ib,$F/4));var $r=this._vb,$F=$Z.length>>4;$L$.fillTranglesVB($r,$b,$u,$Z,$E||this._curMat,0,0),$L$.expandIBQuadrangle(this._ib,$r._byteLength/64+8);var $x=new $q$(1,0);$x.textureHost=$$;var $g=new $U$("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$r._vertType=3,this._setIBVB($b,$u,this._ib,$r,6*$F,$E,$g,$x,0,0)}},$F.enable=function(){if($N.__init__(),$T.isConchApp&&!$T.isConchWebGL)return $P.skinAniSprite=function(){return new $$$},$F.expandContext(),!1;if($P.getWebGLContext=function($$){for(var $b,$u=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$Z=0;$Z<$u.length;$Z++){try{$b=$$.getContext($u[$Z],{stencil:$z.isStencil,alpha:$z.isAlpha,antialias:$z.isAntialias,premultipliedAlpha:$z.premultipliedAlpha,preserveDrawingBuffer:$z.preserveDrawingBuffer})}catch($$){}if($b)return $b}return null},null==($F.mainContext=$F.mainContext||$P.getWebGLContext($T._mainCanvas)))return!1;if($T.isWebGL)return!0;$e.create=function($$,$b){return new $$b($$,$b)},$L.create=function($$,$b,$u,$Z,$E,$r,$F){return new $A$($$,$b,$u,$Z,$E,$r,$F)},$T.WebGL=$F,$T.isWebGL=!0,$N$.__init__(),$P.createRenderSprite=function($$,$b){return new $a$($$,$b)},$P.createWebGLContext2D=function($$){return new $z$($$)},$P.changeWebGLSize=function($$,$b){laya.webgl.WebGL.onStageResize($$,$b)},$P.createGraphics=function(){return new $i$};var $$=$P.createFilterAction;return $P.createFilterAction=$$||function($$){return new $t$},$P.clear=function($$){$_$.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $b=$T.context.ctx,$u=0==$b._submits._length||$z.preserveDrawingBuffer?$D.create($$)._color:$O._wgColor;$u&&$b.clearBG($u[0],$u[1],$u[2],$u[3]),$_$.clear()},$P.addToAtlas=function($$,$b){void 0===$b&&($b=!1);var $u=$$.bitmap;$T.optimizeTextureMemory($$.url,$$)?$i.__typeof($u,"laya.webgl.resource.IMergeAtlasBitmap")&&$u.allowMerageInAtlas&&$u.on("recovered",$$,$$.addTextureToAtlas):$u.enableMerageInAtlas=!1},$P.isAtlas=function($$){return $$ instanceof laya.webgl.atlas.AtlasWebGLCanvas},$n._enable(),$P.beginFlush=function(){for(var $$=$n.instance,$b=$$.getAtlaserCount(),$u=0;$u<$b;$u++){var $Z=$$.getAtlaserByIndex($u).texture;$Z._flashCacheImageNeedFlush&&$P.flashFlushImage($Z)}},$P.drawToCanvas=function($$,$b,$u,$Z,$E,$r){($u<=0||$Z<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$u|=0,$Z|=0,$E|=0,$r|=0;var $F=$l$.create($u,$Z,6408,5121,0,!1);$F.start(),$F.clear(0,0,0,0),$T.context.clear(),$_.renders[$b]._fun($$,$T.context,$E,$_$.height-$Z+$r),$T.context.flush(),$F.end();var $x=$F.getData(0,0,$u,$Z);if($F.recycle(),$x.byteLength==$u*$Z*4){var $g=new $Q$;$g._canvas=$N.createElement("canvas"),$g.size($u,$Z);var $H=$g._canvas.getContext("2d");$N.canvas.size($u,$Z);var $w=$N.context,$I=$w.createImageData($u,$Z);return $I.data.set(new Uint8ClampedArray($x.buffer)),$g._imgData=$I,$w.putImageData($I,0,0),$H.save(),$H.translate(0,$Z),$H.scale(1,-1),$H.drawImage($N.canvas.source,0,0),$H.restore(),$g}console.log("drawToCanvas error: w:"+$u+",h:"+$Z+",datalen:"+$x.byteLength)},$P.createFilterAction=function($$){var $b;switch($$){case 32:$b=new $t$}return $b},$P.addTextureToAtlas=function($$){$$._uvID++,$n._atlasRestore++,$$.bitmap.enableMerageInAtlas&&$n.instance.addToAtlas($$)},$P.getTexturePixels=function($$,$b,$u,$Z,$E){$T.context.ctx.clear();var $r=new $K;$r.graphics.drawTexture($$,-$b,-$u);var $F=$l$.create($Z,$E);$F.start(),$F.clear(0,0,0,0),$r.render($T.context,0,0),$T.context.ctx.flush(),$F.end();for(var $x=$F.getData(0,0,$Z,$E),$g=[],$H=0,$w=$E-1;0<=$w;$w--)for(var $I=0;$I<$Z;$I++)$H=4*($w*$Z+$I),$g.push($x[$H]),$g.push($x[$H+1]),$g.push($x[$H+2]),$g.push($x[$H+3]);return $g},$P.skinAniSprite=function(){return new $$$},$H.create=function($$,$b){var $u=new $Q$;return $u._imgData=$b,$u.flipY=!1,$u},$q._filterStart=function($$,$b,$u,$Z,$E){var $r=$$.getValue("bounds"),$F=$l$.create($r.width,$r.height);if($F.start(),$F.clear(0,0,0,0),$$.addValue("src",$F),$$.addValue("ScissorTest",$_$.worldScissorTest),$_$.worldScissorTest){var $x=new $C;$x.copyFrom($u.ctx._clipRect),$$.addValue("clipRect",$x),$_$.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$q._filterEnd=function($$,$b,$u,$Z,$E){var $r=$$.getValue("bounds");$$.getValue("src").end();var $F=$l$.create($r.width,$r.height);$F.start(),$F.clear(0,0,0,0),$$.addValue("out",$F),$b._set$P("_filterCache",$F),$b._set$P("_isHaveGlowFilter",$$.getValue("_isHaveGlowFilter"))},$q._EndTarget=function($$,$b){if($$.getValue("src").recycle(),$$.getValue("out").end(),$$.getValue("ScissorTest")){$_$.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$b.ctx.save();var $u=$$.getValue("clipRect");$b.ctx.clipRect($u.x,$u.y,$u.width,$u.height)}},$q._useSrc=function($$){var $b=$$.getValue("out");$b.end(),($b=$$.getValue("src")).start(),$b.clear(0,0,0,0)},$q._endSrc=function($$){$$.getValue("src").end()},$q._useOut=function($$){var $b=$$.getValue("src");$b.end(),($b=$$.getValue("out")).start(),$b.clear(0,0,0,0)},$q._endOut=function($$){$$.getValue("out").end()},$q._recycleScope=function($$){$$.recycle()},$q._filter=function($$,$b,$u,$Z){var $E=this._next;if($E){var $r,$F,$x=$$.filters,$g=$x.length;if(1==$g&&32==$x[0].type)return $b.ctx.save(),$b.ctx.setFilters([$x[0]]),$E._fun.call($E,$$,$b,$u,$Z),void $b.ctx.restore();var $H=$x$.create(),$w=$t.TEMP,$I=$b.ctx._getTransformMatrix(),$o=$a.create();$I.copyTo($o);var $N=0,$D=0,$e=!1,$L=$$._$P._filterCache?$$._$P._filterCache:null;if(!$L||$$._repaint){$e=$$._isHaveGlowFilter(),$H.addValue("_isHaveGlowFilter",$e),$e&&($N=50,$D=25),($F=new $C).copyFrom($$.getSelfBounds()),$F.x+=$$.x,$F.y+=$$.y,$F.x-=$$.pivotX+4,$F.y-=$$.pivotY+4;var $T=$F.x,$_=$F.y;if($F.width+=$N+8,$F.height+=$N+8,$w.x=$F.x*$o.a+$F.y*$o.c,$w.y=$F.y*$o.d+$F.x*$o.b,$F.x=$w.x,$F.y=$w.y,$w.x=$F.width*$o.a+$F.height*$o.c,$w.y=$F.height*$o.d+$F.width*$o.b,$F.width=$w.x,$F.height=$w.y,$F.width<=0||$F.height<=0)return;$L&&$L.recycle(),$H.addValue("bounds",$F);var $y=$F$.create([$H,$$,$b,0,0],$q._filterStart);$b.addRenderObject($y),$b.ctx._renderKey=0,$b.ctx._shader2D.glTexture=null;var $S=$$.x-$T+$D,$P=$$.y-$_+$D;$E._fun.call($E,$$,$b,$S,$P),$y=$F$.create([$H,$$,$b,0,0],$q._filterEnd),$b.addRenderObject($y);for(var $i=0;$i<$g;$i++){0!=$i&&($y=$F$.create([$H],$q._useSrc),$b.addRenderObject($y),$r=$q$.create(1,0),$a.TEMP.identity(),$b.ctx.drawTarget($H,0,0,$F.width,$F.height,$a.TEMP,"out",$r,null,$J.TOINT.overlay),$y=$F$.create([$H],$q._useOut),$b.addRenderObject($y)),$x[$i].action.apply3d($H,$$,$b,0,0)}$y=$F$.create([$H,$b],$q._EndTarget),$b.addRenderObject($y)}else{if(($e=!!$$._$P._isHaveGlowFilter&&$$._$P._isHaveGlowFilter)&&($N=50,$D=25),($F=$$.getBounds()).width<=0||$F.height<=0)return;$F.width+=$N,$F.height+=$N,$w.x=$F.x*$o.a+$F.y*$o.c,$w.y=$F.y*$o.d+$F.x*$o.b,$F.x=$w.x,$F.y=$w.y,$w.x=$F.width*$o.a+$F.height*$o.c,$w.y=$F.height*$o.d+$F.width*$o.b,$F.width=$w.x,$F.height=$w.y,$H.addValue("out",$L)}$u=$u-$D-$$.x,$Z=$Z-$D-$$.y,$w.setTo($u,$Z),$o.transformPoint($w),$u=$w.x+$F.x,$Z=$w.y+$F.y,$r=$q$.create(1,0),$a.TEMP.identity(),$b.ctx.drawTarget($H,$u,$Z,$F.width,$F.height,$a.TEMP,"out",$r,null,$J.TOINT.overlay),$y=$F$.create([$H],$q._recycleScope),$b.addRenderObject($y),$o.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$F._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$F._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$F._uint8ArraySlice),!0},$F.onStageResize=function($$,$b){null!=$F.mainContext&&($F.mainContext.viewport(0,0,$$,$b),$_$.width=$$,$_$.height=$b)},$F.onInvalidGLRes=function(){$n.instance.freeAll(),$S.releaseContentManagers(!0),$F.doNodeRepaint($i.stage),$F.mainContext.viewport(0,0,$_$.width,$_$.height),$i.stage.event("devicelost")},$F.doNodeRepaint=function($$){0==$$.numChildren&&$$.repaint();for(var $b=0;$b<$$.numChildren;$b++)$F.doNodeRepaint($$.getChildAt($b))},$F.init=function($$,$b,$u){$F.mainCanvas=$$,$H._createContext=function($$){return new $z$($$)},$Q$._createContext=function($$){return new $z$($$)};var $Z=laya.webgl.WebGL.mainContext;if(null!=$Z.getShaderPrecisionFormat){var $E=$Z.getShaderPrecisionFormat(35633,36338),$r=$Z.getShaderPrecisionFormat(35632,36338);$F.shaderHighPrecision=!(!$E.precision||!$r.precision)}else $F.shaderHighPrecision=!1;if($F.compressAstc=$Z.getExtension("WEBGL_compressed_texture_astc"),$F.compressAtc=$Z.getExtension("WEBGL_compressed_texture_atc"),$F.compressEtc=$Z.getExtension("WEBGL_compressed_texture_etc"),$F.compressEtc1=$Z.getExtension("WEBGL_compressed_texture_etc1"),$F.compressPvrtc=$Z.getExtension("WEBGL_compressed_texture_pvrtc"),$F.compressS3tc=$Z.getExtension("WEBGL_compressed_texture_s3tc"),$F.compressS3tc_srgb=$Z.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$F.compressAstc=$F.compressAstc?$F.compressAstc:{},$F.compressAtc=$F.compressAtc?$F.compressAtc:{},$F.compressEtc=$F.compressEtc?$F.compressEtc:{},$F.compressEtc1=$F.compressEtc1?$F.compressEtc1:{},$F.compressPvrtc=$F.compressPvrtc?$F.compressPvrtc:{},$F.compressS3tc=$F.compressS3tc?$F.compressS3tc:{},$F.compressS3tc_srgb=$F.compressS3tc_srgb?$F.compressS3tc_srgb:{},$Z.deleteTexture1=$Z.deleteTexture,$Z.deleteTexture=function($$){$$==$P$.curBindTexValue&&($P$.curBindTexValue=null),$Z.deleteTexture1($$)},$F.onStageResize($b,$u),null==$F.mainContext)throw new Error("webGL getContext err!");$p.__init__(),$n.__init__(),$K$.__init__(),$r$.__init__(),$z$.__init__(),$q$.__init__(),$B.__init__(),$h$.__int__($Z),$J._init_($Z),$T.isConchApp&&conch.setOnInvalidGLRes($F.onInvalidGLRes)},$F.mainCanvas=null,$F.antialias=!0,$F.shaderHighPrecision=!1,$F._bg_null=[0,0,0,0],$F}(),$P$=function(){function $Z(){}return $o($Z,"laya.webgl.WebGLContext"),$Z.UseProgram=function($$){return $Z._useProgram!==$$&&($S$.mainContext.useProgram($$),$Z._useProgram=$$,!0)},$Z.setDepthTest=function($$,$b){$b!==$Z._depthTest&&(($Z._depthTest=$b)?$$.enable(2929):$$.disable(2929))},$Z.setDepthMask=function($$,$b){$b!==$Z._depthMask&&($Z._depthMask=$b,$$.depthMask($b))},$Z.setDepthFunc=function($$,$b){$b!==$Z._depthFunc&&($Z._depthFunc=$b,$$.depthFunc($b))},$Z.setBlend=function($$,$b){$b!==$Z._blend&&(($Z._blend=$b)?$$.enable(3042):$$.disable(3042))},$Z.setBlendFunc=function($$,$b,$u){($b!==$Z._sFactor||$u!==$Z._dFactor)&&($Z._sFactor=$b,$Z._dFactor=$u,$$.blendFunc($b,$u))},$Z.setCullFace=function($$,$b){$b!==$Z._cullFace&&(($Z._cullFace=$b)?$$.enable(2884):$$.disable(2884))},$Z.setFrontFace=function($$,$b){$b!==$Z._frontFace&&($Z._frontFace=$b,$$.frontFace($b))},$Z.bindTexture=function($$,$b,$u){$$.bindTexture($b,$u),$Z.curBindTexTarget=$b,$Z.curBindTexValue=$u},$Z.DEPTH_BUFFER_BIT=256,$Z.STENCIL_BUFFER_BIT=1024,$Z.COLOR_BUFFER_BIT=16384,$Z.POINTS=0,$Z.LINES=1,$Z.LINE_LOOP=2,$Z.LINE_STRIP=3,$Z.TRIANGLES=4,$Z.TRIANGLE_STRIP=5,$Z.TRIANGLE_FAN=6,$Z.ZERO=0,$Z.ONE=1,$Z.SRC_COLOR=768,$Z.ONE_MINUS_SRC_COLOR=769,$Z.SRC_ALPHA=770,$Z.ONE_MINUS_SRC_ALPHA=771,$Z.DST_ALPHA=772,$Z.ONE_MINUS_DST_ALPHA=773,$Z.DST_COLOR=774,$Z.ONE_MINUS_DST_COLOR=775,$Z.SRC_ALPHA_SATURATE=776,$Z.FUNC_ADD=32774,$Z.BLEND_EQUATION=32777,$Z.BLEND_EQUATION_RGB=32777,$Z.BLEND_EQUATION_ALPHA=34877,$Z.FUNC_SUBTRACT=32778,$Z.FUNC_REVERSE_SUBTRACT=32779,$Z.BLEND_DST_RGB=32968,$Z.BLEND_SRC_RGB=32969,$Z.BLEND_DST_ALPHA=32970,$Z.BLEND_SRC_ALPHA=32971,$Z.CONSTANT_COLOR=32769,$Z.ONE_MINUS_CONSTANT_COLOR=32770,$Z.CONSTANT_ALPHA=32771,$Z.ONE_MINUS_CONSTANT_ALPHA=32772,$Z.BLEND_COLOR=32773,$Z.ARRAY_BUFFER=34962,$Z.ELEMENT_ARRAY_BUFFER=34963,$Z.ARRAY_BUFFER_BINDING=34964,$Z.ELEMENT_ARRAY_BUFFER_BINDING=34965,$Z.STREAM_DRAW=35040,$Z.STATIC_DRAW=35044,$Z.DYNAMIC_DRAW=35048,$Z.BUFFER_SIZE=34660,$Z.BUFFER_USAGE=34661,$Z.CURRENT_VERTEX_ATTRIB=34342,$Z.FRONT=1028,$Z.BACK=1029,$Z.CULL_FACE=2884,$Z.FRONT_AND_BACK=1032,$Z.BLEND=3042,$Z.DITHER=3024,$Z.STENCIL_TEST=2960,$Z.DEPTH_TEST=2929,$Z.SCISSOR_TEST=3089,$Z.POLYGON_OFFSET_FILL=32823,$Z.SAMPLE_ALPHA_TO_COVERAGE=32926,$Z.SAMPLE_COVERAGE=32928,$Z.NO_ERROR=0,$Z.INVALID_ENUM=1280,$Z.INVALID_VALUE=1281,$Z.INVALID_OPERATION=1282,$Z.OUT_OF_MEMORY=1285,$Z.CW=2304,$Z.CCW=2305,$Z.LINE_WIDTH=2849,$Z.ALIASED_POINT_SIZE_RANGE=33901,$Z.ALIASED_LINE_WIDTH_RANGE=33902,$Z.CULL_FACE_MODE=2885,$Z.FRONT_FACE=2886,$Z.DEPTH_RANGE=2928,$Z.DEPTH_WRITEMASK=2930,$Z.DEPTH_CLEAR_VALUE=2931,$Z.DEPTH_FUNC=2932,$Z.STENCIL_CLEAR_VALUE=2961,$Z.STENCIL_FUNC=2962,$Z.STENCIL_FAIL=2964,$Z.STENCIL_PASS_DEPTH_FAIL=2965,$Z.STENCIL_PASS_DEPTH_PASS=2966,$Z.STENCIL_REF=2967,$Z.STENCIL_VALUE_MASK=2963,$Z.STENCIL_WRITEMASK=2968,$Z.STENCIL_BACK_FUNC=34816,$Z.STENCIL_BACK_FAIL=34817,$Z.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$Z.STENCIL_BACK_PASS_DEPTH_PASS=34819,$Z.STENCIL_BACK_REF=36003,$Z.STENCIL_BACK_VALUE_MASK=36004,$Z.STENCIL_BACK_WRITEMASK=36005,$Z.VIEWPORT=2978,$Z.SCISSOR_BOX=3088,$Z.COLOR_CLEAR_VALUE=3106,$Z.COLOR_WRITEMASK=3107,$Z.UNPACK_ALIGNMENT=3317,$Z.PACK_ALIGNMENT=3333,$Z.MAX_TEXTURE_SIZE=3379,$Z.MAX_VIEWPORT_DIMS=3386,$Z.SUBPIXEL_BITS=3408,$Z.RED_BITS=3410,$Z.GREEN_BITS=3411,$Z.BLUE_BITS=3412,$Z.ALPHA_BITS=3413,$Z.DEPTH_BITS=3414,$Z.STENCIL_BITS=3415,$Z.POLYGON_OFFSET_UNITS=10752,$Z.POLYGON_OFFSET_FACTOR=32824,$Z.TEXTURE_BINDING_2D=32873,$Z.SAMPLE_BUFFERS=32936,$Z.SAMPLES=32937,$Z.SAMPLE_COVERAGE_VALUE=32938,$Z.SAMPLE_COVERAGE_INVERT=32939,$Z.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$Z.COMPRESSED_TEXTURE_FORMATS=34467,$Z.DONT_CARE=4352,$Z.FASTEST=4353,$Z.NICEST=4354,$Z.GENERATE_MIPMAP_HINT=33170,$Z.BYTE=5120,$Z.UNSIGNED_BYTE=5121,$Z.SHORT=5122,$Z.UNSIGNED_SHORT=5123,$Z.INT=5124,$Z.UNSIGNED_INT=5125,$Z.FLOAT=5126,$Z.DEPTH_COMPONENT=6402,$Z.ALPHA=6406,$Z.RGB=6407,$Z.RGBA=6408,$Z.LUMINANCE=6409,$Z.LUMINANCE_ALPHA=6410,$Z.UNSIGNED_SHORT_4_4_4_4=32819,$Z.UNSIGNED_SHORT_5_5_5_1=32820,$Z.UNSIGNED_SHORT_5_6_5=33635,$Z.FRAGMENT_SHADER=35632,$Z.VERTEX_SHADER=35633,$Z.MAX_VERTEX_ATTRIBS=34921,$Z.MAX_VERTEX_UNIFORM_VECTORS=36347,$Z.MAX_VARYING_VECTORS=36348,$Z.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$Z.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$Z.MAX_TEXTURE_IMAGE_UNITS=34930,$Z.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$Z.SHADER_TYPE=35663,$Z.DELETE_STATUS=35712,$Z.LINK_STATUS=35714,$Z.VALIDATE_STATUS=35715,$Z.ATTACHED_SHADERS=35717,$Z.ACTIVE_UNIFORMS=35718,$Z.ACTIVE_ATTRIBUTES=35721,$Z.SHADING_LANGUAGE_VERSION=35724,$Z.CURRENT_PROGRAM=35725,$Z.NEVER=512,$Z.LESS=513,$Z.EQUAL=514,$Z.LEQUAL=515,$Z.GREATER=516,$Z.NOTEQUAL=517,$Z.GEQUAL=518,$Z.ALWAYS=519,$Z.KEEP=7680,$Z.REPLACE=7681,$Z.INCR=7682,$Z.DECR=7683,$Z.INVERT=5386,$Z.INCR_WRAP=34055,$Z.DECR_WRAP=34056,$Z.VENDOR=7936,$Z.RENDERER=7937,$Z.VERSION=7938,$Z.NEAREST=9728,$Z.LINEAR=9729,$Z.NEAREST_MIPMAP_NEAREST=9984,$Z.LINEAR_MIPMAP_NEAREST=9985,$Z.NEAREST_MIPMAP_LINEAR=9986,$Z.LINEAR_MIPMAP_LINEAR=9987,$Z.TEXTURE_MAG_FILTER=10240,$Z.TEXTURE_MIN_FILTER=10241,$Z.TEXTURE_WRAP_S=10242,$Z.TEXTURE_WRAP_T=10243,$Z.TEXTURE_2D=3553,$Z.TEXTURE=5890,$Z.TEXTURE_CUBE_MAP=34067,$Z.TEXTURE_BINDING_CUBE_MAP=34068,$Z.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$Z.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$Z.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$Z.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$Z.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$Z.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$Z.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$Z.TEXTURE0=33984,$Z.TEXTURE1=33985,$Z.TEXTURE2=33986,$Z.TEXTURE3=33987,$Z.TEXTURE4=33988,$Z.TEXTURE5=33989,$Z.TEXTURE6=33990,$Z.TEXTURE7=33991,$Z.TEXTURE8=33992,$Z.TEXTURE9=33993,$Z.TEXTURE10=33994,$Z.TEXTURE11=33995,$Z.TEXTURE12=33996,$Z.TEXTURE13=33997,$Z.TEXTURE14=33998,$Z.TEXTURE15=33999,$Z.TEXTURE16=34e3,$Z.TEXTURE17=34001,$Z.TEXTURE18=34002,$Z.TEXTURE19=34003,$Z.TEXTURE20=34004,$Z.TEXTURE21=34005,$Z.TEXTURE22=34006,$Z.TEXTURE23=34007,$Z.TEXTURE24=34008,$Z.TEXTURE25=34009,$Z.TEXTURE26=34010,$Z.TEXTURE27=34011,$Z.TEXTURE28=34012,$Z.TEXTURE29=34013,$Z.TEXTURE30=34014,$Z.TEXTURE31=34015,$Z.ACTIVE_TEXTURE=34016,$Z.REPEAT=10497,$Z.CLAMP_TO_EDGE=33071,$Z.MIRRORED_REPEAT=33648,$Z.FLOAT_VEC2=35664,$Z.FLOAT_VEC3=35665,$Z.FLOAT_VEC4=35666,$Z.INT_VEC2=35667,$Z.INT_VEC3=35668,$Z.INT_VEC4=35669,$Z.BOOL=35670,$Z.BOOL_VEC2=35671,$Z.BOOL_VEC3=35672,$Z.BOOL_VEC4=35673,$Z.FLOAT_MAT2=35674,$Z.FLOAT_MAT3=35675,$Z.FLOAT_MAT4=35676,$Z.SAMPLER_2D=35678,$Z.SAMPLER_CUBE=35680,$Z.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$Z.VERTEX_ATTRIB_ARRAY_SIZE=34339,$Z.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$Z.VERTEX_ATTRIB_ARRAY_TYPE=34341,$Z.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$Z.VERTEX_ATTRIB_ARRAY_POINTER=34373,$Z.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$Z.COMPILE_STATUS=35713,$Z.LOW_FLOAT=36336,$Z.MEDIUM_FLOAT=36337,$Z.HIGH_FLOAT=36338,$Z.LOW_INT=36339,$Z.MEDIUM_INT=36340,$Z.HIGH_INT=36341,$Z.FRAMEBUFFER=36160,$Z.RENDERBUFFER=36161,$Z.RGBA4=32854,$Z.RGB5_A1=32855,$Z.RGB565=36194,$Z.DEPTH_COMPONENT16=33189,$Z.STENCIL_INDEX=6401,$Z.STENCIL_INDEX8=36168,$Z.DEPTH_STENCIL=34041,$Z.RENDERBUFFER_WIDTH=36162,$Z.RENDERBUFFER_HEIGHT=36163,$Z.RENDERBUFFER_INTERNAL_FORMAT=36164,$Z.RENDERBUFFER_RED_SIZE=36176,$Z.RENDERBUFFER_GREEN_SIZE=36177,$Z.RENDERBUFFER_BLUE_SIZE=36178,$Z.RENDERBUFFER_ALPHA_SIZE=36179,$Z.RENDERBUFFER_DEPTH_SIZE=36180,$Z.RENDERBUFFER_STENCIL_SIZE=36181,$Z.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$Z.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$Z.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$Z.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$Z.COLOR_ATTACHMENT0=36064,$Z.DEPTH_ATTACHMENT=36096,$Z.STENCIL_ATTACHMENT=36128,$Z.DEPTH_STENCIL_ATTACHMENT=33306,$Z.NONE=0,$Z.FRAMEBUFFER_COMPLETE=36053,$Z.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$Z.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$Z.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$Z.FRAMEBUFFER_UNSUPPORTED=36061,$Z.FRAMEBUFFER_BINDING=36006,$Z.RENDERBUFFER_BINDING=36007,$Z.MAX_RENDERBUFFER_SIZE=34024,$Z.INVALID_FRAMEBUFFER_OPERATION=1286,$Z.UNPACK_FLIP_Y_WEBGL=37440,$Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$Z.CONTEXT_LOST_WEBGL=37442,$Z.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$Z.BROWSER_DEFAULT_WEBGL=37444,$Z._useProgram=null,$Z._depthTest=!0,$Z._depthMask=!0,$Z._blend=!1,$Z._cullFace=!1,$Z.curBindTexTarget=null,$Z.curBindTexValue=null,$F($Z,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$Z}(),$i$=function($$){function $b(){$b.__super.call(this)}$o($b,"laya.webgl.display.GraphicsGL",$x);var $u=$b.prototype;return $u.setShader=function($$){this._saveToCmd($T.context._setShader,[$$])},$u.setIBVB=function($$,$b,$u,$Z,$E,$r){this._saveToCmd($T.context._setIBVB,[$$,$b,$u,$Z,$E,$r])},$u.drawParticle=function($$,$b,$u){var $Z=$P.createParticleTemplate2D($u);$Z.x=$$,$Z.y=$b,this._saveToCmd($T.context._drawParticle,[$Z])},$b}(),$z$=function($$){var $u;function $m($$){this._x=0,this._y=0,this._id=++$m._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$m.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$m.MAXCLIPRECT,this.mOutPoint,this._canvas=$$,this._canvas._addReference(),$m._contextcount++,$T.isFlash?(this._ib=$B$.create(35044),$L$.fillIBQuadrangle(this._ib,16)):this._ib=$B$.QuadrangleIB,this.clear()}$o($m,"laya.webgl.canvas.WebGLContext2D",$E);var $b=$m.prototype;return $b.setIsMainContext=function(){this._isMain=!0},$b.clearBG=function($$,$b,$u,$Z){var $E=$S$.mainContext;$E.clearColor($$,$b,$u,$Z),$E.clear(16384)},$b._getSubmits=function(){return this._submits},$b._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $$=0,$b=this._submits._length;$$<$b;$$++)this._submits[$$].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$b.destroy=function(){--$m._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$B$.QuadrangleIB&&this._ib.releaseResource()},$b.clear=function(){this._submits||(this._other=$u.DEFAULT,this._curMat=$a.create(),this._vb=$R$.create(-1),this._submits=[],this._save=[$j.Create(this)],this._save.length=10,this._shader2D=new $B,this._triangleMesh=$k$.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$u.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$m.MAXCLIPRECT,this._curSubmit=$r$.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$f.DEFAULT;for(var $$=0,$b=this._submits._length;$$<$b;$$++)this._submits[$$].releaseRender(),this._submits[$$]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$b.size=function($$,$b){if(this._width!=$$||this._height!=$b)if(0==$$||0==$b){0!=this._vb._byteLength&&(this._width=$$,this._height=$b,this._vb.clear(),this._vb.upload());for(var $u=0,$Z=this._submits._length;$u<$Z;$u++)this._submits[$u].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$$,this._height=$b,this._targets&&this._targets.size($$,$b),this._canvas.memorySize-=this._canvas.memorySize;0===$$&&0===$b&&this._releaseMem()},$b._getTransformMatrix=function(){return this._curMat},$b.translate=function($$,$b){0===$$&&0===$b||($d.save(this),this._curMat.bTransform&&($h.save(this),this._curMat.transformPointN($t.TEMP.setTo($$,$b)),$$=$t.TEMP.x,$b=$t.TEMP.y),this._x+=$$,this._y+=$b)},$b.save=function(){this._save[this._save._length++]=$j.Create(this)},$b.restore=function(){var $$=this._save._length;if(!($$<1))for(var $b=$$-1;0<=$b;$b--){var $u=this._save[$b];if($u.restore(this),$u.isSaveMark())return void(this._save._length=$b)}},$b._fillText=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){void 0===$H&&($H=0);var $w=this._shader2D,$I=this._curSubmit.shaderValue,$o=$E?$D$.create($E):this._other.font;if($n.enabled)$w.ALPHA!==$I.ALPHA&&($w.glTexture=null),$N$.drawText(this,$$,$b,this._curMat,$o,$g||this._other.textAlign,$r,$F,$x,$u,$Z,$H);else{this._shader2D.defines.getValue();var $N=$r?$D.create($r)._color:$w.colorAdd;$w.ALPHA===$I.ALPHA&&$N===$w.colorAdd&&$I.colorAdd===$w.colorAdd||($w.glTexture=null,$w.colorAdd=$N),$N$.drawText(this,$$,$b,this._curMat,$o,$g||this._other.textAlign,$r,$F,$x,$u,$Z,$H)}},$b.fillWords=function($$,$b,$u,$Z,$E,$r){this._fillText(null,$$,$b,$u,$Z,$E,null,-1,null,$r)},$b.fillBorderWords=function($$,$b,$u,$Z,$E,$r,$F){this._fillBorderText(null,$$,$b,$u,$Z,$E,$r,$F,null)},$b.fillText=function($$,$b,$u,$Z,$E,$r){this._fillText($$,null,$b,$u,$Z,$E,null,-1,$r)},$b.strokeText=function($$,$b,$u,$Z,$E,$r,$F){this._fillText($$,null,$b,$u,$Z,null,$E,$r||1,$F)},$b.fillBorderText=function($$,$b,$u,$Z,$E,$r,$F,$x){this._fillBorderText($$,null,$b,$u,$Z,$E,$r,$F,$x)},$b._fillBorderText=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){if(!$n.enabled)return this._fillText($$,$b,$u,$Z,$E,null,$F,$x||1,$g),void this._fillText($$,$b,$u,$Z,$E,$r,null,-1,$g);var $H=this._shader2D,$w=this._curSubmit.shaderValue;$H.ALPHA!==$w.ALPHA&&($H.glTexture=null);var $I=$E?($m._fontTemp.setFont($E),$m._fontTemp):this._other.font;$N$.drawText(this,$$,$b,this._curMat,$I,$g||this._other.textAlign,$r,$F,$x||1,$u,$Z,0)},$b.fillRect=function($$,$b,$u,$Z,$E){var $r=this._vb;if($L$.fillRectImgVb($r,this._clipRect,$$,$b,$u,$Z,$k.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $F=this._shader2D.fillStyle;$E&&(this._shader2D.fillStyle=$f.create($E));var $x=this._shader2D,$g=this._curSubmit.shaderValue;if($x.fillStyle!==$g.fillStyle||$x.ALPHA!==$g.ALPHA){$x.glTexture=null;var $H=this._curSubmit=$r$.createSubmit(this,this._ib,$r,($r._byteLength-64)/32*3,$q$.create(2,0));$H.shaderValue.color=$x.fillStyle._color._color,$H.shaderValue.ALPHA=$x.ALPHA,this._submits[this._submits._length++]=$H}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$F}},$b.fillTexture=function($$,$b,$u,$Z,$E,$r,$F,$x){if($$.loaded&&$$.bitmap&&$$.source){var $g=this._vb,$H=$$.bitmap.width,$w=$$.bitmap.height,$I=$$.uv,$o=$F.x%$$.width,$N=$F.y%$$.height;if($H!=$x.w||$w!=$x.h){if(!$x.w&&!$x.h)switch($x.oy=$x.ox=0,$r){case"repeat":$x.width=$Z,$x.height=$E;break;case"repeat-x":$x.width=$Z,$N<0?$$.height+$N>$E?$x.height=$E:$x.height=$$.height+$N:($x.oy=$N,$$.height+$N>$E?$x.height=$E-$N:$x.height=$$.height);break;case"repeat-y":$o<0?$$.width+$o>$Z?$x.width=$Z:$x.width=$$.width+$o:($x.ox=$o,$$.width+$o>$Z?$x.width=$Z-$o:$x.width=$$.width),$x.height=$E;break;case"no-repeat":$o<0?$$.width+$o>$Z?$x.width=$Z:$x.width=$$.width+$o:($x.ox=$o,$$.width+$o>$Z?$x.width=$Z-$o:$x.width=$$.width),$N<0?$$.height+$N>$E?$x.height=$E:$x.height=$$.height+$N:($x.oy=$N,$$.height+$N>$E?$x.height=$E-$N:$x.height=$$.height);break;default:$x.width=$Z,$x.height=$E}$x.w=$H,$x.h=$w,$x.uv=[0,0,$x.width/$H,0,$x.width/$H,$x.height/$w,0,$x.height/$w]}if($b+=$x.ox,$u+=$x.oy,$o-=$x.ox,$N-=$x.oy,$L$.fillRectImgVb($g,this._clipRect,$b,$u,$x.width,$x.height,$x.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $D=$Y$.create(this,this._ib,$g,($g._byteLength-64)/32*3,$q$.create(256,0)),$e=(this._submits[this._submits._length++]=$D).shaderValue;$e.textureHost=$$;var $L=$I[0]*$H,$T=$I[1]*$w,$_=($I[2]-$I[0])*$H,$y=($I[5]-$I[3])*$w,$S=-$o/$H,$P=-$N/$w;$e.u_TexRange[0]=$L/$H,$e.u_TexRange[1]=$_/$H,$e.u_TexRange[2]=$T/$w,$e.u_TexRange[3]=$y/$w,$e.u_offset[0]=$S,$e.u_offset[1]=$P,$n.enabled&&!this._isMain&&$D.addTexture($$,($g._byteLength>>2)-16),(this._curSubmit=$D)._renderType=10017,$D._numEle+=6}}else this.sprite&&$i.timer.callLater(this,this._repaintSprite)},$b.setShader=function($$){$W.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$$},$b.setFilters=function($$){$W.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$$,this._curSubmit=$r$.RENDERBASE,this._renderKey=0,this._drawCount++},$b.drawTexture=function($$,$b,$u,$Z,$E,$r,$F){this._drawTextureM($$,$b,$u,$Z,$E,$r,$F,null,1)},$b.addTextureVb=function($$,$b,$u){var $Z=this._curSubmit._vb||this._vb,$E=$Z._byteLength>>2;$Z.byteLength=$E+16<<2;for(var $r=$Z.getFloat32Array(),$F=0;$F<16;$F+=4)$r[$E++]=$$[$F]+$b,$r[$E++]=$$[$F+1]+$u,$r[$E++]=$$[$F+2],$r[$E++]=$$[$F+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$Z._upload=!0},$b.willDrawTexture=function($$,$b){if(!($$.loaded&&$$.bitmap&&$$.source))return this.sprite&&$i.timer.callLater(this,this._repaintSprite),0;var $u=$$.bitmap,$Z=$u.id+this._shader2D.ALPHA*$b+10016;if($Z==this._renderKey)return $Z;var $E=this._shader2D,$r=$E.ALPHA,$F=this._curSubmit.shaderValue;$E.ALPHA*=$b,this._renderKey=$Z,this._drawCount++,$E.glTexture=$u;var $x=this._vb,$g=null,$H=$x._byteLength/32*3,$w=$F.textureHost&&$F.textureHost==$$&&$F.textureHost.alphaTexture==$$.alphaTexture;return $g=$Y$.create(this,this._ib,$x,$H,$q$.create(1,0)),(this._submits[this._submits._length++]=$g).shaderValue.textureHost=$$,$g._renderType=10016,$g._preIsSameTextureShader=10016===this._curSubmit._renderType&&$E.ALPHA===$F.ALPHA&&$w,this._curSubmit=$g,$E.ALPHA=$r,$Z},$b.drawTextures=function($$,$b,$u,$Z){if($$.loaded&&$$.bitmap&&$$.source){var $E=this._clipRect;if(this._clipRect=$m.MAXCLIPRECT,this._drawTextureM($$,$b[0],$b[1],$$.width,$$.height,$u,$Z,null,1)){if(this._clipRect=$E,$V.drawCall++,!($b.length<4)){for(var $r=this._curSubmit._vb||this._vb,$F=this._curMat.a,$x=this._curMat.d,$g=2,$H=$b.length;$g<$H;$g+=2)$L$.copyPreImgVb($r,($b[$g]-$b[$g-2])*$F,($b[$g+1]-$b[$g-1])*$x),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$i.timer.callLater(this,this._repaintSprite)},$b._drawTextureM=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){if(!$$.loaded||!$$.source)return this.sprite&&$i.timer.callLater(this,this._repaintSprite),!1;var $H=this._curSubmit._vb||this._vb,$w=$$.bitmap;$b+=$r,$u+=$F,this._drawCount++;var $I=$w.id+this._shader2D.ALPHA*$g+10016;if($I!=this._renderKey){this._renderKey=$I;var $o=this._curSubmit.shaderValue,$N=this._shader2D,$D=$N.ALPHA;$N.ALPHA*=$g,$N.glTexture=$w;var $e=this._vb,$L=null,$T=$e._byteLength/32*3,$_=$o.textureHost&&$o.textureHost==$$&&$o.textureHost.alphaTexture==$$.alphaTexture;$L=$Y$.create(this,this._ib,$e,$T,$q$.create(1,0)),(this._submits[this._submits._length++]=$L).shaderValue.textureHost=$$,$L._renderType=10016,$L._preIsSameTextureShader=10016===this._curSubmit._renderType&&$N.ALPHA===$o.ALPHA&&$_,this._curSubmit=$L,$H=this._curSubmit._vb||this._vb,$N.ALPHA=$D}return!!$L$.fillRectImgVb($H,this._clipRect,$b,$u,$Z||$$.width,$E||$$.height,$$.uv,$x||this._curMat,this._x,this._y,0,0)&&($n.enabled&&!this._isMain&&this._curSubmit.addTexture($$,($H._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$b._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$b._drawText=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){var $w=$$.bitmap;this._drawCount++;var $I=$w.id+this._shader2D.ALPHA+10016;if($I!=this._renderKey){this._renderKey=$I;var $o=this._curSubmit.shaderValue,$N=this._shader2D;$N.glTexture=$w;var $D=this._vb,$e=null,$L=$D._byteLength/32*3,$T=$o.textureHost&&$o.textureHost==$$&&$o.textureHost.alphaTexture==$$.alphaTexture;($e=$n.enabled?$Y$.create(this,this._ib,$D,$L,$q$.create(1,0)):$Y$.create(this,this._ib,$D,$L,$d$.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$N.ALPHA===$o.ALPHA&&$T,(this._submits[this._submits._length++]=$e).shaderValue.textureHost=$$,$e._renderType=10016,this._curSubmit=$e}$$.active();var $_=this._curSubmit._vb||this._vb;$L$.fillRectImgVb($_,this._clipRect,$b+$F,$u+$x,$Z||$$.width,$E||$$.height,$$.uv,$r||this._curMat,this._x,this._y,$g,$H,!0)&&($n.enabled&&!this._isMain&&this._curSubmit.addTexture($$,($_._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$b.drawTextureWithTransform=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){if($r){var $H=this._curMat,$w=this._x,$I=this._y;(0!==$F||0!==$x)&&(this._x=$F*$H.a+$x*$H.c,this._y=$x*$H.d+$F*$H.b),$r&&$H.bTransform?($a.mul($r,$H,$m._tmpMatrix),($r=$m._tmpMatrix)._checkTransform()):(this._x+=$H.tx,this._y+=$H.ty),this._drawTextureM($$,$b,$u,$Z,$E,0,0,$r,$g),this._x=$w,this._y=$I}else this._drawTextureM($$,$b,$u,$Z,$E,$F,$x,null,$g)},$b.fillQuadrangle=function($$,$b,$u,$Z,$E){var $r=this._curSubmit,$F=this._vb,$x=this._shader2D,$g=$r.shaderValue;if(this._renderKey=0,$$.bitmap){var $H=$$.bitmap;$x.glTexture==$H&&$x.ALPHA===$g.ALPHA||($x.glTexture=$H,($r=this._curSubmit=$r$.createSubmit(this,this._ib,$F,$F._byteLength/32*3,$q$.create(1,0))).shaderValue.glTexture=$H,this._submits[this._submits._length++]=$r),$L$.fillQuadrangleImgVb($F,$b,$u,$Z,$$.uv,$E||this._curMat,this._x,this._y)}else $r.shaderValue.fillStyle&&$r.shaderValue.fillStyle.equal($$)&&$x.ALPHA===$g.ALPHA||($x.glTexture=null,($r=this._curSubmit=$r$.createSubmit(this,this._ib,$F,$F._byteLength/32*3,$q$.create(2,0))).shaderValue.defines.add(2),$r.shaderValue.fillStyle=$f.create($$),this._submits[this._submits._length++]=$r),$L$.fillQuadrangleImgVb($F,$b,$u,$Z,$k.DEF_UV,$E||this._curMat,this._x,this._y);$r._numEle+=6},$b.drawTexture2=function($$,$b,$u,$Z,$E,$r,$F,$x){if(0!=$r){var $g=this._curMat;if(this._x=$$*$g.a+$b*$g.c,this._y=$b*$g.d+$$*$g.b,$E&&($E=$g.bTransform||$E.bTransform?($a.mul($E,$g,$m._tmpMatrix),$m._tmpMatrix):(this._x+=$E.tx+$g.tx,this._y+=$E.ty+$g.ty,$a.EMPTY)),1!==$r||$F){var $H=this._shader2D.ALPHA,$w=this._nBlendType;this._shader2D.ALPHA=$r,$F&&(this._nBlendType=$J.TOINT($F)),this._drawTextureM($x[0],$x[1]-$u,$x[2]-$Z,$x[3],$x[4],0,0,$E,1),this._shader2D.ALPHA=$H,this._nBlendType=$w}else this._drawTextureM($x[0],$x[1]-$u,$x[2]-$Z,$x[3],$x[4],0,0,$E,1);this._x=this._y=0}},$b.drawCanvas=function($$,$b,$u,$Z,$E){var $r=$$.context;if(this._renderKey=0,$r._targets)this._submits[this._submits._length++]=$p$.create($r,0,null),this._curSubmit=$r$.RENDERBASE,$r._targets.drawTo(this,$b,$u,$Z,$E);else{var $F=this._submits[this._submits._length++]=$p$.create($r,this._shader2D.ALPHA,this._shader2D.filters),$x=$Z/$$.width,$g=$E/$$.height,$H=$F._matrix;this._curMat.copyTo($H),1!=$x&&1!=$g&&$H.scale($x,$g);var $w=$H.tx,$I=$H.ty;$H.tx=$H.ty=0,$H.transformPoint($t.TEMP.setTo($b,$u)),$H.translate($t.TEMP.x+$w,$t.TEMP.y+$I),this._curSubmit=$r$.RENDERBASE}$z.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$r._targets?"yellow":"green",this.strokeRect($b-1,$u-1,$Z+2,$E+2,1),this.strokeRect($b,$u,$Z,$E,1),this.restore())},$b.drawTarget=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){void 0===$H&&($H=-1);var $w=this._vb;if($L$.fillRectImgVb($w,this._clipRect,$b,$u,$Z,$E,$g||$k.DEF_UV,$r||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $I=this._curSubmit=$I$.create(this,this._ib,$w,($w._byteLength-64)/32*3,$x,$F);$I.blendType=-1==$H?this._nBlendType:$H,$I.scope=$$,this._submits[this._submits._length++]=$I,this._curSubmit._numEle+=6}},$b.mixRGBandAlpha=function($$){return this._mixRGBandAlpha($$,this._shader2D.ALPHA)},$b._mixRGBandAlpha=function($$,$b){var $u=(4278190080&$$)>>>24;return 0!=$u?$u*=$b:$u=255*$b,16777215&$$|$u<<24},$b.drawTriangles=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){if(!$$.loaded||!$$.source)return this.sprite&&$i.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$$.bitmap;var $w=this._mixRGBandAlpha(4294967295,$x),$I=($Z.length,$r.length);this._renderKey=-1;var $o=this._curSubmit=$Y$.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$q$.create(1,0));return $o.shaderValue.textureHost=$$,$o._renderType=10016,this._submits[this._submits._length++]=$o,$F?($m._tmpMatrix.a=$F.a,$m._tmpMatrix.b=$F.b,$m._tmpMatrix.c=$F.c,$m._tmpMatrix.d=$F.d,$m._tmpMatrix.tx=$F.tx+$b,$m._tmpMatrix.ty=$F.ty+$u,$a.mul($m._tmpMatrix,this._curMat,$m._tmpMatrix)):($m._tmpMatrix.a=this._curMat.a,$m._tmpMatrix.b=this._curMat.b,$m._tmpMatrix.c=this._curMat.c,$m._tmpMatrix.d=this._curMat.d,$m._tmpMatrix.tx=this._curMat.tx+$b,$m._tmpMatrix.ty=this._curMat.ty+$u),this._triangleMesh.addData($Z,$E,$r,$m._tmpMatrix,$w,this),this._curSubmit._numEle+=$I,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$b.transform=function($$,$b,$u,$Z,$E,$r){$h.save(this),$a.mul($a.TEMP.setTo($$,$b,$u,$Z,$E,$r),this._curMat,this._curMat),this._curMat._checkTransform()},$b.setTransformByMatrix=function($$){$$.copyTo(this._curMat)},$b.transformByMatrix=function($$){$h.save(this),$a.mul($$,this._curMat,this._curMat),this._curMat._checkTransform()},$b.rotate=function($$){$h.save(this),this._curMat.rotateEx($$)},$b.scale=function($$,$b){$h.save(this),this._curMat.scaleEx($$,$b)},$b.clipRect=function($$,$b,$u,$Z){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $E=$w$.create(4);this.addRenderObject($E);var $r=this._vb,$F=$r._byteLength>>2;if($L$.fillRectImgVb($r,null,$$,$b,$u,$Z,$k.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $x=this._curSubmit=$r$.createSubmit(this,this._ib,$r,($r._byteLength-64)/32*3,$q$.create(2,0));$x.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$x,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $g=$w$.create(5);this.addRenderObject($g);var $H=$r.getFloat32Array(),$w=Math.min(Math.min(Math.min($H[0+$F],$H[4+$F]),$H[8+$F]),$H[12+$F]),$I=Math.max(Math.max(Math.max($H[0+$F],$H[4+$F]),$H[8+$F]),$H[12+$F]),$o=Math.min(Math.min(Math.min($H[1+$F],$H[5+$F]),$H[9+$F]),$H[13+$F]),$N=Math.max(Math.max(Math.max($H[1+$F],$H[5+$F]),$H[9+$F]),$H[13+$F]);$A.save(this,$g,$$,$b,$u,$Z,$w,$o,$I-$w,$N-$o),this._curSubmit=$r$.RENDERBASE}else{$u*=this._curMat.a,$Z*=this._curMat.d;var $D=$t.TEMP;this._curMat.transformPoint($D.setTo($$,$b)),$u<0&&($D.x=$D.x+$u,$u=-$u),$Z<0&&($D.y=$D.y+$Z,$Z=-$Z),this._renderKey=0;var $e=this._curSubmit=$H$.create(this);(this._submits[this._submits._length++]=$e).submitIndex=this._submits._length,$e.submitLength=9999999,$G.save(this,$e);var $L=this._clipRect,$T=$L.x,$_=$L.y,$y=$D.x+$u,$S=$D.y+$Z;$T<$D.x&&($L.x=$D.x),$_<$D.y&&($L.y=$D.y),$L.width=Math.min($y,$T+$L.width)-$L.x,$L.height=Math.min($S,$_+$L.height)-$L.y,this._shader2D.glTexture=null,$e.clipRect.copyFrom($L),this._curSubmit=$r$.RENDERBASE}},$b.setIBVB=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w){if(void 0===$g&&($g=0),void 0===$H&&($H=0),void 0===$w&&($w=0),null===$u){if($T.isFlash){var $I=$Z;$I._selfIB||($I._selfIB=$B$.create(35044)),$I._selfIB.clear(),$u=$I._selfIB}else $u=this._ib;$L$.expandIBQuadrangle($u,$Z._byteLength/(4*$Z.vertexStride*4))}if(!$x||!$F)throw Error("setIBVB must input:shader shaderValues");var $o=$g$.create(this,$Z,$u,$E,$F,$x,$g,$H,$w);$r||($r=$a.EMPTY),$r.translate($$,$b),$a.mul($r,this._curMat,$o._mat),$r.translate(-$$,-$b),this._submits[this._submits._length++]=$o,this._curSubmit=$r$.RENDERBASE,this._renderKey=0},$b.addRenderObject=function($$){this._submits[this._submits._length++]=$$},$b.fillTrangles=function($$,$b,$u,$Z,$E){var $r=this._curSubmit,$F=this._vb,$x=this._shader2D,$g=$r.shaderValue,$H=$Z.length>>4,$w=$$.bitmap;this._renderKey=0,$x.glTexture==$w&&$x.ALPHA===$g.ALPHA||(($r=this._curSubmit=$r$.createSubmit(this,this._ib,$F,$F._byteLength/32*3,$q$.create(1,0))).shaderValue.textureHost=$$,this._submits[this._submits._length++]=$r),$L$.fillTranglesVB($F,$b,$u,$Z,$E||this._curMat,this._x,this._y),$r._numEle+=6*$H},$b.submitElement=function($$,$b){var $u=this._submits;for($b<0&&($b=$u._length);$$<$b;)$$+=$u[$$].renderSubmit()},$b.finish=function(){$S$.mainContext.finish()},$b.flush=function(){var $$=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($$>this._ib.bufferLength/12&&$L$.expandIBQuadrangle(this._ib,$$),!this._isMain&&$n.enabled&&$n._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$n._atlasRestore;for(var $b=this._submits,$u=0,$Z=$b._length;$u<$Z;$u++){var $E=$b[$u];10016===$E.getRenderType()&&$E.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$b$.instance&&$b$.getInstance().reset();var $r;for($u=0,$r=this.meshlist.length;$u<$r;$u++){var $F=this.meshlist[$u];$F.canReuse?$F.releaseMesh():$F.destroy()}return this.meshlist.length=0,this._curSubmit=$r$.RENDERBASE,this._renderKey=0,this._triangleMesh=$k$.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$b.setPathId=function($$){if(this.mId=$$,-1!=this.mId){this.mHaveKey=!1;var $b=$l.getInstance();$b.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$b.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$b.movePath=function($$,$b){var $u=$$,$Z=$b;$$=this._curMat.a*$u+this._curMat.c*$Z+this._curMat.tx,$b=this._curMat.b*$u+this._curMat.d*$Z+this._curMat.ty,this.mX+=$$,this.mY+=$b},$b.beginPath=function(){var $$=this._getPath();$$.tempArray.length=0,$$.closePath=!1,this.mX=0,this.mY=0},$b.closePath=function(){this._path.closePath=!0},$b.fill=function($$){void 0===$$&&($$=!1);var $b=this._getPath();this.drawPoly(0,0,$b.tempArray,this.fillStyle._color.numColor,0,0,$$)},$b.stroke=function(){var $$=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$$.drawLine(0,0,$$.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $b=$l.getInstance().shapeLineDic[this.mId];$b.rebuild($$.tempArray),$$.setGeomtry($b)}else $l.getInstance().addLine(this.mId,$$.drawLine(0,0,$$.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$$.update();var $u=[this.mX,this.mY],$Z=$r$.createShape(this,$$.ib,$$.vb,$$.count,$$.offset,$q$.create(4,0));$Z.shaderValue.ALPHA=this._shader2D.ALPHA,$Z.shaderValue.u_pos=$u,$Z.shaderValue.u_mmat2=$_$.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$Z,this._renderKey=-1}},$b.line=function($$,$b,$u,$Z,$E,$r){var $F=this._curSubmit,$x=this._vb;if($L$.fillLineVb($x,this._clipRect,$$,$b,$u,$Z,$E,$r)){this._renderKey=0;var $g=this._shader2D,$H=$F.shaderValue;$g.strokeStyle===$H.strokeStyle&&$g.ALPHA===$H.ALPHA||($g.glTexture=null,($F=this._curSubmit=$r$.createSubmit(this,this._ib,$x,($x._byteLength-64)/32*3,$q$.create(2,0))).shaderValue.strokeStyle=$g.strokeStyle,$F.shaderValue.mainID=2,$F.shaderValue.ALPHA=$g.ALPHA,this._submits[this._submits._length++]=$F),$F._numEle+=6}},$b.moveTo=function($$,$b,$u){void 0===$u&&($u=!0);var $Z=this._getPath();if($u){var $E=$$,$r=$b;$$=this._curMat.a*$E+this._curMat.c*$r,$b=this._curMat.b*$E+this._curMat.d*$r}$Z.addPoint($$,$b)},$b.lineTo=function($$,$b,$u){void 0===$u&&($u=!0);var $Z=this._getPath();if($u){var $E=$$,$r=$b;$$=this._curMat.a*$E+this._curMat.c*$r,$b=this._curMat.b*$E+this._curMat.d*$r}$Z.addPoint($$,$b)},$b.drawCurves=function($$,$b,$u){this.setPathId(-1),this.beginPath(),this.strokeStyle=$u[3],this.lineWidth=$u[4];var $Z=$u[2];$$+=$u[0],$b+=$u[1],this.movePath($$,$b),this.moveTo($Z[0],$Z[1]);for(var $E=2,$r=$Z.length;$E<$r;)this.quadraticCurveTo($Z[$E++],$Z[$E++],$Z[$E++],$Z[$E++]);this.stroke()},$b.arcTo=function($$,$b,$u,$Z,$E){if(-1==this.mId||!this.mHaveKey){var $r=0,$F=0,$x=0,$g=this._getPath();this._curMat.copyTo($m._tmpMatrix),$m._tmpMatrix.tx=$m._tmpMatrix.ty=0,$m._tempPoint.setTo($g.getEndPointX(),$g.getEndPointY()),$m._tmpMatrix.invertTransformPoint($m._tempPoint);var $H=$m._tempPoint.x-$$,$w=$m._tempPoint.y-$b,$I=Math.sqrt($H*$H+$w*$w);if(!($I<=1e-6)){var $o=$H/$I,$N=$w/$I,$D=$u-$$,$e=$Z-$b,$L=$D*$D+$e*$e,$T=Math.sqrt($L);if(!($T<=1e-6)){var $_=$D/$T,$y=$e/$T,$S=$o+$_,$P=$N+$y,$i=Math.sqrt($S*$S+$P*$P);if(!($i<=1e-6)){var $z=$S/$i,$q=$P/$i,$a=Math.acos($z*$o+$q*$N),$t=Math.PI/2-$a,$C=($I=$E/Math.tan($t))*$o+$$,$K=$I*$N+$b,$O=Math.sqrt($I*$I+$E*$E),$V=$$+$z*$O,$v=$b+$q*$O,$p=0,$Y=0;if(0<=$o*$y-$N*$_){var $k=2*$t/$m.SEGNUM;$p=Math.sin($k),$Y=Math.cos($k)}else $k=2*-$t/$m.SEGNUM,$p=Math.sin($k),$Y=Math.cos($k);$F=this._curMat.a*$C+this._curMat.c*$K,$x=this._curMat.b*$C+this._curMat.d*$K,$F==this._path.getEndPointX()&&$x==this._path.getEndPointY()||$g.addPoint($F,$x);var $M=$C-$V,$l=$K-$v;for($r=0;$r<$m.SEGNUM;$r++){var $X=$M*$Y+$l*$p,$s=-$M*$p+$l*$Y;$F=$X+$V,$x=$s+$v,$$=this._curMat.a*$F+this._curMat.c*$x,$x=$b=this._curMat.b*$F+this._curMat.d*$x,($F=$$)==this._path.getEndPointX()&&$x==this._path.getEndPointY()||$g.addPoint($F,$x),$M=$X,$l=$s}}}}}},$b.arc=function($$,$b,$u,$Z,$E,$r,$F){if(void 0===$r&&($r=!1),void 0===$F&&($F=!0),-1!=this.mId){var $x=$l.getInstance().shapeDic[this.mId];if($x&&this.mHaveKey&&!$x.needUpdate(this._curMat))return;$b=$$=0}var $g,$H=0,$w=0,$I=0,$o=0,$N=0,$D=0,$e=0;if($w=$E-$Z,$r)if(Math.abs($w)>=2*Math.PI)$w=2*-Math.PI;else for(;0<$w;)$w-=2*Math.PI;else if(Math.abs($w)>=2*Math.PI)$w=2*Math.PI;else for(;$w<0;)$w+=2*Math.PI;$g=$w/($e=$u<101?Math.max(10,$w*$u/5):$u<201?Math.max(10,$w*$u/20):Math.max(10,$w*$u/40))/2,$I=Math.abs(4/3*(1-Math.cos($g))/Math.sin($g)),$r&&($I=-$I);var $L=this._getPath(),$T=NaN,$_=NaN;for($D=0;$D<=$e;$D++)$H=$Z+$w*($D/$e),$o=$$+Math.cos($H)*$u,$N=$b+Math.sin($H)*$u,$F&&($T=$o,$_=$N,$o=this._curMat.a*$T+this._curMat.c*$_,$N=this._curMat.b*$T+this._curMat.d*$_),$o==this._path.getEndPointX()&&$N==this._path.getEndPointY()||$L.addPoint($o,$N);$o=$$+Math.cos($E)*$u,$N=$b+Math.sin($E)*$u,$F&&($T=$o,$_=$N,$o=this._curMat.a*$T+this._curMat.c*$_,$N=this._curMat.b*$T+this._curMat.d*$_),$o==this._path.getEndPointX()&&$N==this._path.getEndPointY()||$L.addPoint($o,$N)},$b.quadraticCurveTo=function($$,$b,$u,$Z){var $E=$I.I,$r=$u,$F=$Z;$u=this._curMat.a*$r+this._curMat.c*$F,$Z=this._curMat.b*$r+this._curMat.d*$F,$r=$$,$F=$b,$$=this._curMat.a*$r+this._curMat.c*$F,$b=this._curMat.b*$r+this._curMat.d*$F;for(var $x=$E.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$$,$b,$u,$Z],30,2),$g=0,$H=$x.length/2;$g<$H;$g++)this.lineTo($x[2*$g],$x[2*$g+1],!1);this.lineTo($u,$Z,!1)},$b.rect=function($$,$b,$u,$Z){this._other=this._other.make(),this._other.path||(this._other.path=new $Q),this._other.path.rect($$,$b,$u,$Z)},$b.strokeRect=function($$,$b,$u,$Z,$E){var $r=.5*$E;this.line($$-$r,$b,$$+$u+$r,$b,$E,this._curMat),this.line($$+$u,$b,$$+$u,$b+$Z,$E,this._curMat),this.line($$,$b,$$,$b+$Z,$E,this._curMat),this.line($$-$r,$b+$Z,$$+$u+$r,$b+$Z,$E,this._curMat)},$b.clip=function(){},$b.drawPoly=function($$,$b,$u,$Z,$E,$r,$F){void 0===$F&&($F=!1),this._renderKey=0,this._shader2D.glTexture=null;var $x=this._getPath();if(-1==this.mId)$x.polygon($$,$b,$u,$Z,$E||1,$r);else if(this.mHaveKey){var $g=$l.getInstance().shapeDic[this.mId];$g.setMatrix(this._curMat),$g.rebuild($x.tempArray),$x.setGeomtry($g)}else{var $H=$x.polygon($$,$b,$u,$Z,$E||1,$r);$l.getInstance().addShape(this.mId,$H),$H.setMatrix(this._curMat)}$x.update();var $w,$I=[this.mX,this.mY];if(($w=$r$.createShape(this,$x.ib,$x.vb,$x.count,$x.offset,$q$.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$w.shaderValue.u_pos=$I,$w.shaderValue.u_mmat2=$_$.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$w,0<$E){if(this.mHaveLineKey){var $o=$l.getInstance().shapeLineDic[this.mId];$o.rebuild($x.tempArray),$x.setGeomtry($o)}else $l.getInstance().addShape(this.mId,$x.drawLine($$,$b,$u,$E,$r));$x.update(),($w=$r$.createShape(this,$x.ib,$x.vb,$x.count,$x.offset,$q$.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$w.shaderValue.u_mmat2=$_$.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$w}},$b.drawParticle=function($$,$b,$u){$u.x=$$,$u.y=$b,this._submits[this._submits._length++]=$u},$b._getPath=function(){return this._path||(this._path=new $Q)},$Z(0,$b,"globalCompositeOperation",function(){return $J.NAMES[this._nBlendType]},function($$){var $b=$J.TOINT[$$];null==$b||this._nBlendType===$b||($W.save(this,65536,this,!0),this._curSubmit=$r$.RENDERBASE,this._renderKey=0,this._nBlendType=$b)}),$Z(0,$b,"strokeStyle",function(){return this._shader2D.strokeStyle},function($$){this._shader2D.strokeStyle.equal($$)||($W.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$f.create($$))}),$Z(0,$b,"globalAlpha",function(){return this._shader2D.ALPHA},function($$){($$=Math.floor(1e3*$$)/1e3)!=this._shader2D.ALPHA&&($W.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$$)}),$Z(0,$b,"asBitmap",null,function($$){if($$){if(this._targets||(this._targets=new $U),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$Z(0,$b,"fillStyle",function(){return this._shader2D.fillStyle},function($$){this._shader2D.fillStyle.equal($$)||($W.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$f.create($$))}),$Z(0,$b,"textAlign",function(){return this._other.textAlign},function($$){this._other.textAlign===$$||(this._other=this._other.make(),$W.save(this,32768,this._other,!1),this._other.textAlign=$$)}),$Z(0,$b,"lineWidth",function(){return this._other.lineWidth},function($$){this._other.lineWidth===$$||(this._other=this._other.make(),$W.save(this,256,this._other,!1),this._other.lineWidth=$$)}),$Z(0,$b,"textBaseline",function(){return this._other.textBaseline},function($$){this._other.textBaseline===$$||(this._other=this._other.make(),$W.save(this,16384,this._other,!1),this._other.textBaseline=$$)}),$Z(0,$b,"font",null,function($$){$$!=this._other.font.toString()&&(this._other=this._other.make(),$W.save(this,8,this._other,!1),this._other.font===$D$.EMPTY?this._other.font=new $D$($$):this._other.font.setFont($$))}),$m.__init__=function(){$u.DEFAULT=new $u},$m._tempPoint=new $t,$m._SUBMITVBSIZE=32e3,$m._MAXSIZE=99999999,$m._RECTVBSIZE=16,$m.MAXCLIPRECT=new $C(0,0,99999999,99999999),$m._COUNT=0,$m._tmpMatrix=new $a,$m.SEGNUM=32,$m._contextcount=0,$F($m,["_fontTemp",function(){return this._fontTemp=new $D$},"_drawStyleTemp",function(){return this._drawStyleTemp=new $f(null)}]),$m.__init$=function(){$u=function(){function $$(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$D$.EMPTY}$o($$,"");var $b=$$.prototype;return $b.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$D$.EMPTY},$b.make=function(){return this===$$.DEFAULT?new $$:this},$$.DEFAULT=null,$$}()},$m}(),$q$=function($$){function $Z($$,$b){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$Z.__super.call(this),this.defines=new $K$,this.position=$Z._POSITION,this.mainID=$$,this.subID=$b,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$$|$b,this._inClassCache=$Z._cache[this._cacheID],0<$$&&!this._inClassCache&&(this._inClassCache=$Z._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$o($Z,"laya.webgl.shader.d2.value.Value2D",$s);var $b=$Z.prototype;return $b.setValue=function($$){},$b.refresh=function(){var $$=this.size;return $$[0]=$_$.width,$$[1]=$_$.height,this.alpha=this.ALPHA*$_$.worldAlpha,this.mmat=$_$.worldMatrix4,this},$b._ShaderWithCompile=function(){return $j$.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$U$.create)},$b._withWorldShaderDefines=function(){var $$=$_$.worldShaderDefines,$b=$j$.sharders[this.mainID|this.defines._value|$$.getValue()];if(!$b){var $u,$Z={};for($u in this.defines.toNameDic())$Z[$u]="";for($u in $$.toNameDic())$Z[$u]="";$b=$j$.withCompile2D(0,this.mainID,$Z,this.mainID|this.defines._value|$$.getValue(),$U$.create)}var $E=$_$.worldFilters;if(!$E)return $b;for(var $r,$F=$E.length,$x=0;$x<$F;$x++)($r=$E[$x])&&$r.action.setValue(this);return $b},$b.upload=function(){var $$=$_$;this.alpha=this.ALPHA*$$.worldAlpha,$_$.worldMatrix4!==$_$.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$S$.shaderHighPrecision&&this.defines.add(1024);var $b,$u=$$.worldShaderDefines?this._withWorldShaderDefines():$j$.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$$.width,this.size[1]=$$.height,this.mmat=$$.worldMatrix4,$M$.activeShader!==$u?$u._shaderValueWidth!==$$.width||$u._shaderValueHeight!==$$.height?($u._shaderValueWidth=$$.width,$u._shaderValueHeight=$$.height):$b=$u._params2dQuick2||$u._make2dQuick2():$u._shaderValueWidth!==$$.width||$u._shaderValueHeight!==$$.height?($u._shaderValueWidth=$$.width,$u._shaderValueHeight=$$.height):$b=$u._params2dQuick1||$u._make2dQuick1(),$u.upload(this,$b)},$b.setFilters=function($$){if(this.filters=$$)for(var $b,$u=$$.length,$Z=0;$Z<$u;$Z++)($b=$$[$Z])&&(this.defines.add($b.type),$b.action.setValue(this))},$b.clear=function(){this.defines.setValue(this.subID)},$b.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$Z._initone=function($$,$b){$Z._typeClass[$$]=$b,$Z._cache[$$]=[],$Z._cache[$$]._length=0},$Z.__init__=function(){$Z._POSITION=[2,5126,!1,4*$e$.BYTES_PE,0],$Z._TEXCOORD=[2,5126,!1,4*$e$.BYTES_PE,2*$e$.BYTES_PE],$Z._initone(2,$m$),$Z._initone(4,$J$),$Z._initone(256,$n$),$Z._initone(512,$s$),$Z._initone(1,$c$),$Z._initone(65,$d$),$Z._initone(9,$c$)},$Z.create=function($$,$b){var $u=$Z._cache[$$|$b];return $u._length?$u[--$u._length]:new $Z._typeClass[$$|$b]($b)},$Z._POSITION=null,$Z._TEXCOORD=null,$Z._cache=[],$Z._typeClass=[],$Z.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Z}(),$a$=function($$){function $L($$,$b){$L.__super.call(this,$$,$b)}$o($L,"laya.webgl.utils.RenderSprite3D",$_);var $b=$L.prototype;return $b.onCreate=function($$){switch($$){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$b._mask=function($$,$b,$u,$Z){var $E,$r,$F=this._next,$x=$$.mask;if($x){$b.ctx.save();var $g=$b.ctx.globalCompositeOperation,$H=new $C;if($H.copyFrom($x.getBounds()),$H.width=Math.round($H.width),$H.height=Math.round($H.height),$H.x=Math.round($H.x),$H.y=Math.round($H.y),0<$H.width&&0<$H.height){var $w=$$._style._tf,$I=$x$.create();$I.addValue("bounds",$H),$E=$F$.create([$I,$b],laya.webgl.utils.RenderSprite3D.tmpTarget),$b.addRenderObject($E),$x.render($b,-$H.x,-$H.y),$E=$F$.create([$I],laya.webgl.utils.RenderSprite3D.endTmpTarget),$b.addRenderObject($E),$b.ctx.save(),$b.clipRect($u-$w.translateX+$H.x,$Z-$w.translateY+$H.y,$H.width,$H.height),$F._fun.call($F,$$,$b,$u,$Z),$b.ctx.restore(),$r=$w$.create(6),$g=$b.ctx.globalCompositeOperation,$r.blendMode="mask",$b.addRenderObject($r),$a.TEMP.identity();var $o=$q$.create(1,0),$N=$k.INV_UV,$D=$H.width,$e=$H.height;($H.width<32||$H.height<32)&&(($N=$L.tempUV)[0]=0,$N[1]=0,$N[2]=32<=$H.width?1:$H.width/32,$N[3]=0,$N[4]=32<=$H.width?1:$H.width/32,$N[5]=32<=$H.height?1:$H.height/32,$N[6]=0,$N[7]=32<=$H.height?1:$H.height/32,$H.width=32<=$H.width?$H.width:32,$H.height=32<=$H.height?$H.height:32,$N[1]*=-1,$N[3]*=-1,$N[5]*=-1,$N[7]*=-1,$N[1]+=1,$N[3]+=1,$N[5]+=1,$N[7]+=1),$b.ctx.drawTarget($I,$u+$H.x-$w.translateX,$Z+$H.y-$w.translateY,$D,$e,$a.TEMP,"tmpTarget",$o,$N,6),$E=$F$.create([$I],laya.webgl.utils.RenderSprite3D.recycleTarget),$b.addRenderObject($E),($r=$w$.create(6)).blendMode=$g,$b.addRenderObject($r)}$b.ctx.restore()}else $F._fun.call($F,$$,$b,$u,$Z)},$b._blend=function($$,$b,$u,$Z){var $E=$$._style,$r=this._next;$E.blendMode?($b.ctx.save(),$b.ctx.globalCompositeOperation=$E.blendMode,$r._fun.call($r,$$,$b,$u,$Z),$b.ctx.restore()):$r._fun.call($r,$$,$b,$u,$Z)},$b._transform=function($$,$b,$u,$Z){var $E=$$.transform,$r=this._next;if($E&&$r!=$_.NORENDER){var $F=$b.ctx;$$._style;$E.tx=$u,$E.ty=$Z;var $x=$F._getTransformMatrix(),$g=$x.clone();$a.mul($E,$x,$x),$x._checkTransform(),$E.tx=$E.ty=0,$r._fun.call($r,$$,$b,0,0),$g.copyTo($x),$g.destroy()}else $r._fun.call($r,$$,$b,$u,$Z)},$L.tmpTarget=function($$,$b){var $u=$$.getValue("bounds"),$Z=$l$.create($u.width,$u.height);$Z.start(),$Z.clear(0,0,0,0),$$.addValue("tmpTarget",$Z)},$L.endTmpTarget=function($$){$$.getValue("tmpTarget").end()},$L.recycleTarget=function($$){$$.getValue("tmpTarget").recycle(),$$.recycle()},$F($L,["tempUV",function(){return this.tempUV=new Array(8)}]),$L}(),$t$=function($$){function $b(){this.data=null,$b.__super.call(this)}$o($b,"laya.filters.webgl.ColorFilterActionGL",$X);var $u=$b.prototype;return $i.imps($u,{"laya.filters.IFilterActionGL":!0}),$u.setValue=function($$){$$.colorMat=this.data._mat,$$.colorAlpha=this.data._alpha},$u.apply3d=function($$,$b,$u,$Z,$E){var $r=$$.getValue("bounds"),$F=$q$.create(1,0);$F.setFilters([this.data]);var $x=$a.TEMP;$x.identity(),$u.ctx.drawTarget($$,0,0,$r.width,$r.height,$x,"src",$F)},$b}(),$C$=function($$){function $r($$,$b,$u,$Z,$E){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$r.__super.call(this,$$,$b,$E),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $f$,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$u,this._atlasCanvas.height=$Z,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$o($r,"laya.webgl.atlas.Atlaser",$m);var $b=$r.prototype;return $b.computeUVinAtlasTexture=function($$,$b,$u,$Z){var $E=$n.atlasTextureWidth,$r=$n.atlasTextureHeight,$F=$u/$E,$x=$Z/$r,$g=($u+$$.bitmap.width)/$E,$H=($Z+$$.bitmap.height)/$r,$w=$$.bitmap.width/$E,$I=$$.bitmap.height/$r;$$.uv=[$F+$b[0]*$w,$x+$b[1]*$I,$g-(1-$b[2])*$w,$x+$b[3]*$I,$g-(1-$b[4])*$w,$H-(1-$b[5])*$I,$F+$b[6]*$w,$H-(1-$b[7])*$I]},$b.findBitmapIsExist=function($$){if($$ instanceof laya.webgl.resource.WebGLImage){var $b=$$,$u=$b.url,$Z=this._InAtlasWebGLImagesKey[$u||$b.id];if($Z)return $Z.offsetInfoID}return-1},$b.addToAtlasTexture=function($$,$b,$u){if($$ instanceof laya.webgl.resource.WebGLImage){var $Z=$$,$E=$Z.url;this._InAtlasWebGLImagesKey[$E||$Z.id]={bitmap:$$,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$b,$u])}this._atlasCanvas.texSubImage2D($b,$u,$$.atlasSource),$$.clearAtlasSource()},$b.addToAtlas=function($$,$b,$u){$$._atlasID=this._inAtlasTextureKey.length;var $Z=$$.uv.slice(),$E=$$.bitmap;this._inAtlasTextureKey.push($$),this._inAtlasTextureOriUVValue.push($Z),this._inAtlasTextureBitmapValue.push($E),this.computeUVinAtlasTexture($$,$Z,$b,$u),$$.bitmap=this._atlasCanvas},$b.clear=function(){for(var $$=0,$b=this._inAtlasTextureKey.length;$$<$b;$$++)this._inAtlasTextureKey[$$].bitmap=this._inAtlasTextureBitmapValue[$$],this._inAtlasTextureKey[$$].uv=this._inAtlasTextureOriUVValue[$$],this._inAtlasTextureKey[$$]._atlasID=-1,this._inAtlasTextureKey[$$].bitmap.lock=!1,this._inAtlasTextureKey[$$].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$b.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$Z(0,$b,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$Z(0,$b,"texture",function(){return this._atlasCanvas}),$Z(0,$b,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$r}(),$K$=function($$){function $u(){$u.__super.call(this,$u.__name2int,$u.__int2name,$u.__int2nameMap)}return $o($u,"laya.webgl.shader.d2.ShaderDefines2D",$R),$u.__init__=function(){$u.reg("TEXTURE2D",1),$u.reg("COLOR2D",2),$u.reg("PRIMITIVE",4),$u.reg("GLOW_FILTER",8),$u.reg("BLUR_FILTER",16),$u.reg("COLOR_FILTER",32),$u.reg("COLOR_ADD",64),$u.reg("WORLDMAT",128),$u.reg("FILLTEXTURE",256),$u.reg("FSHIGHPRECISION",1024),$u.reg("TXTALPHA",2048),$u.reg("TXTCOMPRESS",4096)},$u.reg=function($$,$b){$R._reg($$,$b,$u.__name2int,$u.__int2name)},$u.toText=function($$,$b,$u){return $R._toText($$,$b,$u)},$u.toInt=function($$){return $R._toInt($$,$u.__name2int)},$u.TEXTURE2D=1,$u.COLOR2D=2,$u.PRIMITIVE=4,$u.FILTERGLOW=8,$u.FILTERBLUR=16,$u.FILTERCOLOR=32,$u.COLORADD=64,$u.WORLDMAT=128,$u.FILLTEXTURE=256,$u.SKINMESH=512,$u.SHADERDEFINE_FSHIGHPRECISION=1024,$u.TXTALPHA=2048,$u.TXTCOMPRESS=4096,$u.__name2int={},$u.__int2name=[],$u.__int2nameMap=[],$u}(),$O$=(function($$){function $x($$,$b,$u,$Z,$E,$r,$F){$x.__super.call(this,$$,$b,$u,$Z,40,$E,$r,$F)}$o($x,"laya.webgl.shapes.Ellipse",$u$)}(),function($$){function $r($$,$b,$u,$Z,$E){this._points=[],this.rebuild($u),$r.__super.call(this,$$,$b,0,0,0,$E,$Z,$E,0)}$o($r,"laya.webgl.shapes.Line",$u$);var $b=$r.prototype;return $b.rebuild=function($$){var $b=$$.length;$b!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($b/2-1)),this.mFloat32Array=new Float32Array(5*$b)),this._points.length=0;for(var $u=NaN,$Z=NaN,$E=-1,$r=-1,$F=$$.length/2,$x=0;$x<$F;$x++)$u=$$[2*$x],$Z=$$[2*$x+1],(.01<Math.abs($E-$u)||.01<Math.abs($r-$Z))&&this._points.push($u,$Z),$E=$u,$r=$Z},$b.getData=function($$,$b,$u){var $Z=[],$E=[];0<this.borderWidth&&this.createLine2(this._points,$Z,this.borderWidth,$u,$E,this._points.length/2),this.mUint16Array.set($Z,0),this.mFloat32Array.set($E,0),$$.append(this.mUint16Array),$b.append(this.mFloat32Array)},$r}()),$V$=function($$){function $I($$,$b,$u,$Z,$E){this._points=[];for(var $r=NaN,$F=NaN,$x=-1,$g=-1,$H=$u.length/2-1,$w=0;$w<$H;$w++)$r=$u[2*$w],$F=$u[2*$w+1],(.01<Math.abs($x-$r)||.01<Math.abs($g-$F))&&this._points.push($r,$F),$x=$r,$g=$F;$r=$u[2*$H],$F=$u[2*$H+1],$x=this._points[0],$g=this._points[1],(.01<Math.abs($x-$r)||.01<Math.abs($g-$F))&&this._points.push($r,$F),$I.__super.call(this,$$,$b,0,0,this._points.length/2,0,$Z,$E)}$o($I,"laya.webgl.shapes.LoopLine",$u$);var $b=$I.prototype;return $b.getData=function($$,$b,$u){if(0<this.borderWidth){for(var $Z=this.color,$E=($Z>>16&255)/255,$r=($Z>>8&255)/255,$F=(255&$Z)/255,$x=[],$g=0,$H=0,$w=[],$I=Math.floor(this._points.length/2),$o=0;$o<$I;$o++)$g=this._points[2*$o],$H=this._points[2*$o+1],$x.push(this.x+$g,this.y+$H,$E,$r,$F);this.createLoopLine($x,$w,this.borderWidth,$u+$x.length/5),$$.append(new Uint16Array($w)),$b.append(new Float32Array($x))}},$b.createLoopLine=function($$,$b,$u,$Z,$E,$r){$$.length;var $F=$$.concat(),$x=$E||$$,$g=this.borderColor,$H=($g>>16&255)/255,$w=($g>>8&255)/255,$I=(255&$g)/255,$o=[$F[0],$F[1]],$N=[$F[$F.length-5],$F[$F.length-4]],$D=$N[0]+.5*($o[0]-$N[0]),$e=$N[1]+.5*($o[1]-$N[1]);$F.unshift($D,$e,0,0,0),$F.push($D,$e,0,0,0);var $L,$T,$_,$y,$S,$P,$i,$z,$q,$a,$t,$C,$K,$O,$V,$v,$p,$Y,$k,$M,$l=$F.length/5,$X=$Z,$s=$u/2;$_=$F[0],$y=$F[1],$a=$_-($S=$F[5]),$q=($q=-($y-($P=$F[6])))/($M=Math.sqrt($q*$q+$a*$a))*$s,$a=$a/$M*$s,$x.push($_-$q,$y-$a,$H,$w,$I,$_+$q,$y+$a,$H,$w,$I);for(var $m=1;$m<$l-1;$m++)$_=$F[5*($m-1)],$y=$F[5*($m-1)+1],$S=$F[5*$m],$P=$F[5*$m+1],$i=$F[5*($m+1)],$z=$F[5*($m+1)+1],$a=$_-$S,$C=$S-$i,$V=(-($q=($q=-($y-$P))/($M=Math.sqrt($q*$q+$a*$a))*$s)+$_)*(-($a=$a/$M*$s)+$P)-(-$q+$S)*(-$a+$y),$Y=(-($t=($t=-($P-$z))/($M=Math.sqrt($t*$t+$C*$C))*$s)+$i)*(-($C=$C/$M*$s)+$P)-(-$t+$S)*(-$C+$z),$k=($K=-$a+$y-(-$a+$P))*($p=-$t+$S-(-$t+$i))-($v=-$C+$z-(-$C+$P))*($O=-$q+$S-(-$q+$_)),Math.abs($k)<.1?($k+=10.1,$x.push($S-$q,$P-$a,$H,$w,$I,$S+$q,$P+$a,$H,$w,$I)):((($L=($O*$Y-$p*$V)/$k)-$S)*($L-$S)+(($T=($v*$V-$K*$Y)/$k)-$P)+($T-$P),$x.push($L,$T,$H,$w,$I,$S-($L-$S),$P-($T-$P),$H,$w,$I));$r&&($b=$r);var $n=this.edges+1;for($m=1;$m<$n;$m++)$b.push($X+2*($m-1),$X+2*($m-1)+1,$X+2*$m+1,$X+2*$m+1,$X+2*$m,$X+2*($m-1));return $b.push($X+2*($m-1),$X+2*($m-1)+1,$X+1,$X+1,$X,$X+2*($m-1)),$x},$I}(),$v$=function($$){function $F($$,$b,$u,$Z,$E,$r){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$a.create(),this._points=$u.slice(0,$u.length),$F.__super.call(this,$$,$b,0,0,this._points.length/2,$Z,$E,$r)}$o($F,"laya.webgl.shapes.Polygon",$u$);var $b=$F.prototype;return $b.rebuild=function($$){this._repaint||(this._points.length=0,this._points=this._points.concat($$))},$b.setMatrix=function($$){$$.copyTo(this._mat)},$b.needUpdate=function($$){return this._repaint=this._mat.a==$$.a&&this._mat.b==$$.b&&this._mat.c==$$.c&&this._mat.d==$$.d&&this._mat.tx==$$.tx&&this._mat.ty==$$.ty,!this._repaint},$b.getData=function($$,$b,$u){var $Z,$E=0,$r=this._points,$F=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$u){for(this._start=$u,$Z=[],$F=this.earcutTriangles.length,$E=0;$E<$F;$E++)$Z.push(this.earcutTriangles[$E]+$u);this.mUint16Array=new Uint16Array($Z)}}else{this._start=$u,$Z=[];var $x=[],$g=[],$H=this.color,$w=($H>>16&255)/255,$I=($H>>8&255)/255,$o=(255&$H)/255;for($F=Math.floor($r.length/2),$E=0;$E<$F;$E++)$x.push(this.x+$r[2*$E],this.y+$r[2*$E+1],$w,$I,$o),$g.push(this.x+$r[2*$E],this.y+$r[2*$E+1]);for(this.earcutTriangles=$Z$.earcut($g,null,2),$F=this.earcutTriangles.length,$E=0;$E<$F;$E++)$Z.push(this.earcutTriangles[$E]+$u);this.mUint16Array=new Uint16Array($Z),this.mFloat32Array=new Float32Array($x)}$$.append(this.mUint16Array),$b.append(this.mFloat32Array)},$F}(),$p$=function($$){function $r(){this._matrix=new $a,this._matrix4=$e$.defaultMatrix4.concat(),$r.__super.call(this,1e4),this.shaderValue=new $q$(0,0)}$o($r,"laya.webgl.submit.SubmitCanvas",$r$);var $b=$r.prototype;return $b.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $$=$_$.worldAlpha,$b=$_$.worldMatrix4,$u=$_$.worldMatrix,$Z=$_$.worldFilters,$E=$_$.worldShaderDefines,$r=this.shaderValue,$F=this._matrix,$x=this._matrix4,$g=$a.TEMP;return $a.mul($F,$u,$g),$x[0]=$g.a,$x[1]=$g.b,$x[4]=$g.c,$x[5]=$g.d,$x[12]=$g.tx,$x[13]=$g.ty,$_$.worldMatrix=$g.clone(),$_$.worldMatrix4=$x,$_$.worldAlpha=$_$.worldAlpha*$r.alpha,$r.filters&&$r.filters.length&&($_$.worldFilters=$r.filters,$_$.worldShaderDefines=$r.defines),this._ctx_src.flush(),$_$.worldAlpha=$$,$_$.worldMatrix4=$b,$_$.worldMatrix.destroy(),$_$.worldMatrix=$u,$_$.worldFilters=$Z,$_$.worldShaderDefines=$E,1},$b.releaseRender=function(){var $$=$r._cache;this._ctx_src=null,$$[$$._length++]=this},$b.getRenderType=function(){return 10003},$r.create=function($$,$b,$u){var $Z=$r._cache._length?$r._cache[--$r._cache._length]:new $r;$Z._ctx_src=$$;var $E=$Z.shaderValue;return $E.alpha=$b,$E.defines.setValue(0),$u&&$u.length&&$E.setFilters($u),$Z},$r._cache=(($r._cache=[])._length=0,$r._cache),$r}(),$Y$=function($$){function $H($$){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$$&&($$=1e4),$H.__super.call(this,$$)}$o($H,"laya.webgl.submit.SubmitTexture",$r$);var $b=$H.prototype;return $b.releaseRender=function(){var $$=$H._cache;($$[$$._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$b.addTexture=function($$,$b){this._texsID[this._texs.length]=$$._uvID,this._texs.push($$),this._vbPos.push($b)},$b.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $$=this.shaderValue.textureHost.bitmap;if(null!==$$)for(var $b=this._vb.getFloat32Array(),$u=0,$Z=this._texs.length;$u<$Z;$u++){var $E=this._texs[$u];$E.active();var $r=$E.uv;if(this._texsID[$u]!==$E._uvID){this._texsID[$u]=$E._uvID;var $F=this._vbPos[$u];$b[$F+2]=$r[0],$b[$F+3]=$r[1],$b[$F+6]=$r[2],$b[$F+7]=$r[3],$b[$F+10]=$r[4],$b[$F+11]=$r[5],$b[$F+14]=$r[6],$b[$F+15]=$r[7],this._vb.setNeedUpload()}$E.bitmap!==$$&&(this._isSameTexture=!1)}}},$b.renderSubmit=function(){if(0===this._numEle)return $H._shaderSet=!1,1;var $$=this.shaderValue.textureHost;if($$){var $b=$$.source;if(!$$.bitmap||!$b)return $H._shaderSet=!1,1;this.shaderValue.texture=$b,$$.alphaTexture&&$$.alphaTexture.source&&(this.shaderValue.texture1=$$.alphaTexture.source)}this._vb.bind_upload(this._ib);var $u=$S$.mainContext;if($J.activeBlendFunction!==this._blendFn&&($u.enable(3042),this._blendFn($u),$J.activeBlendFunction=this._blendFn),$V.drawCall++,$V.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$M$.activeShader&&$H._shaderSet?($M$.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$M$.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$H._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $Z=$$.bitmap,$E=0,$r=$M$.activeShader,$F=0,$x=this._texs.length;$F<$x;$F++){var $g=this._texs[$F];$g.bitmap===$Z&&$F+1!==$x||($r.uploadTexture2D($g.source),$u.drawElements(4,6*($F-$E+1),5123,this._startIdx+6*$E*$e$.BYTES_PIDX),$Z=$g.bitmap,$E=$F)}else $u.drawElements(4,this._numEle,5123,this._startIdx);return 1},$H.create=function($$,$b,$u,$Z,$E){var $r=$H._cache._length?$H._cache[--$H._cache._length]:new $H;null==$u&&(($u=$r._selfVb||($r._selfVb=$R$.create(-1))).clear(),$Z=0),$r._ib=$b,$r._vb=$u,$r._startIdx=$Z*$e$.BYTES_PIDX,$r._numEle=0;var $F=$$._nBlendType;$r._blendFn=$$._targets?$J.targetFns[$F]:$J.fns[$F],$r.shaderValue=$E,$r.shaderValue.setValue($$._shader2D);var $x=$$._shader2D.filters;return $x&&$r.shaderValue.setFilters($x),$r},$H._cache=(($H._cache=[])._length=0,$H._cache),$H._shaderSet=!0,$H}(),$k$=function($$){function $T(){$T.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$o($T,"laya.webgl.utils.MeshTexture",$T$);var $b=$T.prototype;return $b.addData=function($$,$b,$u,$Z,$E,$r){for(var $F=$$.length/2,$x=this._vb.needSize($F*$T.const_stride)>>2,$g=this._vb.getFloat32Array(),$H=0,$w=0;$w<$F;$w++){var $I=$$[$H],$o=$$[$H+1],$N=$I*$Z.a+$o*$Z.c+$Z.tx,$D=$I*$Z.b+$o*$Z.d+$Z.ty;$g[$x++]=$N,$g[$x++]=$D,$g[$x++]=$b[$H],$g[$x++]=$b[$H+1],$H+=2}this._vb.setNeedUpload();var $e=this.vertNum;if(0<$e){($F=$u.length)>$T.tmpIdx.length&&($T.tmpIdx=new Uint16Array($F));for(var $L=0;$L<$F;$L++)$T.tmpIdx[$L]=$u[$L]+$e;this._ib.appendU16Array($T.tmpIdx,$u.length)}else this._ib.append($u);this._ib.setNeedUpload(),this.vertNum+=$F,this.indexNum+=$u.length},$b.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$b.destroy=function(){this._ib.destroy(),this._vb.destroy()},$T.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $T},$T.const_stride=16,$T._POOL=[],$F($T,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$T}(),$M$=function($$){function $b(){$b.__super.call(this),this.lock=!0}return $o($b,"laya.webgl.shader.BaseShader",$y),$b.activeShader=null,$b.bindShader=null,$b}(),$l$=function($b){function $w($$,$b,$u,$Z,$E,$r,$F,$x,$g){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$u&&($u=6408),void 0===$Z&&($Z=5121),void 0===$E&&($E=34041),void 0===$r&&($r=!1),void 0===$F&&($F=!1),void 0===$x&&($x=-1),void 0===$g&&($g=-1),this._type=1,this._w=$$,this._h=$b,this._surfaceFormat=$u,this._surfaceType=$Z,this._depthStencilFormat=$E,$T.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$r,this._repeat=$F,this._minFifter=$x,this._magFifter=$g,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$w.__super.call(this,this.bitmap,$k.INV_UV)}$o($w,"laya.webgl.resource.RenderTarget2D",$b);var $$=$w.prototype;return $i.imps($$,{"laya.resource.IDispose":!0}),$$.getType=function(){return this._type},$$.getTexture=function(){return this},$$.size=function($$,$b){this._w==$$&&this._h==$b||(this._w=$$,this._h=$b,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$$.release=function(){this.destroy()},$$.recycle=function(){$w.POOL.push(this)},$$.start=function(){var $$=$S$.mainContext;return this._preRenderTarget=$_$.curRenderTarget,$_$.curRenderTarget=this,$$.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($$.viewport(0,0,this._w,this._h),this._svWidth=$_$.width,this._svHeight=$_$.height,$_$.width=this._w,$_$.height=this._h,$M$.activeShader=null),this},$$.clear=function($$,$b,$u,$Z){void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=1);var $E=$S$.mainContext;$E.clearColor($$,$b,$u,$Z);var $r=16384;switch(this._depthStencilFormat){case 33189:$r|=256;break;case 36168:$r|=1024;break;case 34041:$r|=256,$r|=1024}$E.clear($r)},$$.end=function(){var $$=$S$.mainContext;$$.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$_$.curRenderTarget=this._preRenderTarget,1==this._type?($$.viewport(0,0,this._svWidth,this._svHeight),$_$.width=this._svWidth,$_$.height=this._svHeight,$M$.activeShader=null):$$.viewport(0,0,$i.stage.width,$i.stage.height)},$$.getData=function($$,$b,$u,$Z){var $E=$S$.mainContext;if($E.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$E.checkFramebufferStatus(36160)))return $E.bindFramebuffer(36160,null),null;var $r=new Uint8Array(this._w*this._h*4);return $E.readPixels($$,$b,$u,$Z,this._surfaceFormat,this._surfaceType,$r),$E.bindFramebuffer(36160,null),$r},$$.destroy=function($$){void 0===$$&&($$=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$b.prototype.destroy.call(this))},$$.dispose=function(){},$$._createWebGLRenderTarget=function(){this.bitmap=new $G$(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($$){this.event("recovered")})},$Z(0,$$,"surfaceFormat",function(){return this._surfaceFormat}),$Z(0,$$,"magFifter",function(){return this._magFifter}),$Z(0,$$,"surfaceType",function(){return this._surfaceType}),$Z(0,$$,"mipMap",function(){return this._mipMap}),$Z(0,$$,"depthStencilFormat",function(){return this._depthStencilFormat}),$Z(0,$$,"minFifter",function(){return this._minFifter}),$Z(0,$$,"source",function(){return this._alreadyResolved?$i.superGet($k,this,"source"):null}),$w.create=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){void 0===$u&&($u=6408),void 0===$Z&&($Z=5121),void 0===$E&&($E=34041),void 0===$r&&($r=!1),void 0===$F&&($F=!1),void 0===$x&&($x=-1),void 0===$g&&($g=-1);var $H=$w.POOL.pop();return $H||($H=new $w($$,$b)),$H.bitmap&&$H._w==$$&&$H._h==$b&&$H._surfaceFormat==$u&&$H._surfaceType==$Z&&$H._depthStencilFormat==$E&&$H._mipMap==$r&&$H._repeat==$F&&$H._minFifter==$x&&$H._magFifter==$g||($H._w=$$,$H._h=$b,$H._surfaceFormat=$u,$H._surfaceType=$Z,$H._depthStencilFormat=$E,$T.isConchWebGL&&34041===$H._depthStencilFormat&&($H._depthStencilFormat=33189),$H._mipMap=$r,$H._repeat=$F,$H._minFifter=$x,$H._magFifter=$g,$H.release(),$H._createWebGLRenderTarget()),$H},$w.TYPE2D=1,$w.TYPE3D=2,$w.POOL=[],$w}($k),$X$=function($$){function $b(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$b.__super.call(this),$b._gl=$S$.mainContext}$o($b,"laya.webgl.utils.Buffer",$y);var $u=$b.prototype;return $u._bind=function(){this.activeResource(),$b._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($b._bindVertexBuffer=this._glBuffer),$b._gl.bindBuffer(this._bufferType,$b._bindActive[this._bufferType]=this._glBuffer),$M$.activeShader=null)},$u.recreateResource=function(){this._glBuffer||(this._glBuffer=$b._gl.createBuffer()),this.completeCreate()},$u.disposeResource=function(){this._glBuffer&&($S$.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$Z(0,$u,"bufferUsage",function(){return this._bufferUsage}),$b._gl=null,$b._bindActive={},$b._bindVertexBuffer=null,$b._enableAtributes=[],$b}(),$s$=function($$){function $u($$){this.texcoord=null,this.offsetX=300,this.offsetY=0,$u.__super.call(this,512,0);var $b=8*$e$.BYTES_PE;this.position=[2,5126,!1,$b,0],this.texcoord=[2,5126,!1,$b,2*$e$.BYTES_PE],this.color=[4,5126,!1,$b,4*$e$.BYTES_PE]}return $o($u,"laya.webgl.shader.d2.skinAnishader.SkinSV",$q$),$u}(),$m$=function($$){function $b($$){$b.__super.call(this,2,0),this.color=[]}return $o($b,"laya.webgl.shader.d2.value.Color2dSV",$q$),$b.prototype.setValue=function($$){$$.fillStyle&&(this.color=$$.fillStyle._color._color),$$.strokeStyle&&(this.color=$$.strokeStyle._color._color)},$b}(),$n$=function($$){function $b($$){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$q$._TEXCOORD,$b.__super.call(this,256,0)}$o($b,"laya.webgl.shader.d2.value.FillTextureSV",$q$);var $u=$b.prototype;return $u.setValue=function($$){this.ALPHA=$$.ALPHA,$$.filters&&this.setFilters($$.filters)},$u.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$b}(),$c$=function($$){function $b($$){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$q$._TEXCOORD,void 0===$$&&($$=0),$b.__super.call(this,1,$$)}$o($b,"laya.webgl.shader.d2.value.TextureSV",$q$);var $u=$b.prototype;return $u.setValue=function($$){this.ALPHA=$$.ALPHA,$$.filters&&this.setFilters($$.filters)},$u.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$b}(),$J$=function($$){function $b($$){this.a_color=null,this.u_pos=[0,0],$b.__super.call(this,4,0),this.position=[2,5126,!1,5*$e$.BYTES_PE,0],this.a_color=[3,5126,!1,5*$e$.BYTES_PE,2*$e$.BYTES_PE]}return $o($b,"laya.webgl.shader.d2.value.PrimitiveSV",$q$),$b}(),$f$=function($$){function $b(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$b.__super.call(this)}$o($b,"laya.webgl.atlas.AtlasWebGLCanvas",$$);var $u=$b.prototype;return $u.recreateResource=function(){var $$=$S$.mainContext,$b=this._source=$$.createTexture(),$u=$P$.curBindTexTarget,$Z=$P$.curBindTexValue;$P$.bindTexture($$,3553,$b),$$.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$$.texParameteri(3553,10241,9729),$$.texParameteri(3553,10240,9729),$$.texParameteri(3553,10242,33071),$$.texParameteri(3553,10243,33071),$u&&$Z&&$P$.bindTexture($$,$u,$Z),this.memorySize=this._w*this._h*4,this.completeCreate()},$u.disposeResource=function(){this._source&&($S$.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$u.texSubImage2D=function($$,$b,$u){if($T.isFlash){this._flashCacheImage||(this._flashCacheImage=$e.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $Z=$u.bitmapdata;this._flashCacheImage._image.copyPixels($Z,0,0,$Z.width,$Z.height,$$,$b),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $E=$S$.mainContext,$r=$P$.curBindTexTarget,$F=$P$.curBindTexValue;$P$.bindTexture($E,3553,this._source),$E.pixelStorei(37441,!0),0<=$$-1&&$E.texSubImage2D(3553,0,$$-1,$b,6408,5121,$u),$$+1<=this._w&&$E.texSubImage2D(3553,0,$$+1,$b,6408,5121,$u),0<=$b-1&&$E.texSubImage2D(3553,0,$$,$b-1,6408,5121,$u),$b+1<=this._h&&$E.texSubImage2D(3553,0,$$,$b+1,6408,5121,$u),$E.texSubImage2D(3553,0,$$,$b,6408,5121,$u),$E.pixelStorei(37441,!1),$r&&$F&&$P$.bindTexture($E,$r,$F)}},$u.texSubImage2DPixel=function($$,$b,$u,$Z,$E){var $r=$S$.mainContext,$F=$P$.curBindTexTarget,$x=$P$.curBindTexValue;$P$.bindTexture($r,3553,this._source);var $g=new Uint8Array($E.data);$r.pixelStorei(37441,!0),$r.texSubImage2D(3553,0,$$,$b,$u,$Z,6408,5121,$g),$r.pixelStorei(37441,!1),$F&&$x&&$P$.bindTexture($r,$F,$x)},$Z(0,$u,"width",$$.prototype._$get_width,function($$){this._w=$$}),$Z(0,$u,"height",$$.prototype._$get_height,function($$){this._h=$$}),$b}($u),$Q$=function($$){function $E(){this.flipY=!0,this.alwaysChange=!1,$E.__super.call(this)}$o($E,"laya.webgl.resource.WebGLCanvas",$u);var $b=$E.prototype;return $b.getCanvas=function(){return this._canvas},$b.clear=function(){this._ctx&&this._ctx.clear()},$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$b._setContext=function($$){this._ctx=$$},$b.getContext=function($$,$b){return this._ctx?this._ctx:this._ctx=$E._createContext(this)},$b.size=function($$,$b){this._w==$$&&this._h==$b||(this._w=$$,this._h=$b,this._ctx&&this._ctx.size($$,$b),this._canvas&&(this._canvas.height=$b,this._canvas.width=$$))},$b.activeResource=function($$){void 0===$$&&($$=!1),this._source||this.recreateResource()},$b.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$b.disposeResource=function(){this._source&&!this.iscpuSource&&($S$.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$b.createWebGlTexture=function(){var $$=$S$.mainContext;this._canvas;var $b=this._source=$$.createTexture();this.iscpuSource=!1;var $u=$P$.curBindTexTarget,$Z=$P$.curBindTexValue;$P$.bindTexture($$,3553,$b),$$.pixelStorei(37440,this.flipY?1:0),$E.premulAlpha&&$$.pixelStorei(37441,!0),$$.texImage2D(3553,0,6408,6408,5121,this._imgData),$E.premulAlpha&&$$.pixelStorei(37441,!1),$$.texParameteri(3553,10240,9729),$$.texParameteri(3553,10241,9729),$$.texParameteri(3553,10242,33071),$$.texParameteri(3553,10243,33071),$$.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$u&&$Z&&$P$.bindTexture($$,$u,$Z)},$b.reloadCanvasData=function(){var $$=$S$.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $b=$P$.curBindTexTarget,$u=$P$.curBindTexValue;$P$.bindTexture($$,3553,this._source),$E.premulAlpha&&$$.pixelStorei(37441,!0),$$.texImage2D(3553,0,6408,6408,5121,this._imgData),$E.premulAlpha&&$$.pixelStorei(37441,!1),$$.pixelStorei(37440,0),$b&&$u&&$P$.bindTexture($$,$b,$u)},$b.texSubImage2D=function($$,$b,$u){var $Z=$S$.mainContext,$E=$P$.curBindTexTarget,$r=$P$.curBindTexValue;$P$.bindTexture($Z,3553,this._source),$Z.pixelStorei(37441,!0),$Z.texSubImage2D(3553,0,$b,$u,6408,5121,$$._source),$Z.pixelStorei(37441,!1),$E&&$r&&$P$.bindTexture($Z,$E,$r)},$b.toBase64=function($$,$b,$u){var $Z=null;this._canvas&&($Z=this._canvas.toDataURL($$,$b)),$u.call(this,$Z)},$Z(0,$b,"context",function(){return this._ctx}),$Z(0,$b,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$Z(0,$b,"asBitmap",null,function($$){this._ctx&&(this._ctx.asBitmap=$$)}),$E._createContext=null,$E.premulAlpha=!1,$E}(),$W$=function($$){function $r($$,$b){this.CborderSize=12,$r.__super.call(this),this.char=$$,this.isSpace=" "===$$,this.xs=$b.scaleX,this.ys=$b.scaleY,this.font=$b.font.toString(),this.fontSize=$b.font.size,this.fillColor=$b.fillColor,this.borderColor=$b.borderColor,this.lineWidth=$b.lineWidth,this.underLine=$b.underLine;var $u,$Z=$T.isConchApp;$Z?(($u=ConchTextCanvas)._source=ConchTextCanvas,$u._source.canvas=ConchTextCanvas):$u=$N.canvas.source,this.canvas=$u,this._enableMerageInAtlas=!0,this._ctx=$Z?$u:this.canvas.getContext("2d",void 0);var $E=$M.measureText(this.char,this.font);this.cw=$E.width*this.xs,this.ch=($E.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $k(this)}$o($r,"laya.webgl.resource.WebGLCharImage",$u);var $b=$r.prototype;return $i.imps($b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$b.active=function(){this.texture.active()},$b.recreateResource=function(){var $$=$T.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$$){var $b=this.fontSize;1==this.xs&&1==this.ys||($b=parseInt($b*(this.xs>this.ys?this.xs:this.ys)+""));var $u="normal 100 "+this.font;$u=$u.replace($r._fontSizeReg,$b),this.borderColor&&($u+=" 1 "+this.borderColor),this._ctx.font=$u,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$Y.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $Z=this._ctx.measureText(this.char);$Z||($Z={width:16});var $E=$Z.width+1;this._ctx.lineTo($E,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$b.onresize=function($$,$b){this._w=$$,this._h=$b,this._allowMerageInAtlas=!0},$b.clearAtlasSource=function(){},$Z(0,$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Z(0,$b,"atlasSource",function(){return this.canvas}),$Z(0,$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($$){this._enableMerageInAtlas=$$}),$r.createOneChar=function($$,$b){return new $r($$,$b)},$r._fontSizeReg=new RegExp("\\d+(?=px)","g"),$r}(),$G$=function($$){function $H($$,$b,$u,$Z,$E,$r,$F,$x,$g){void 0===$u&&($u=6408),void 0===$Z&&($Z=5121),void 0===$E&&($E=34041),void 0===$r&&($r=!1),void 0===$F&&($F=!1),void 0===$x&&($x=-1),void 0===$g&&($g=1),$H.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$$,this._h=$b,this._surfaceFormat=$u,this._surfaceType=$Z,this._depthStencilFormat=$E,this._mipMap=$r,this._repeat=$F,this._minFifter=$x,this._magFifter=$g}$o($H,"laya.webgl.resource.WebGLRenderTarget",$u);var $b=$H.prototype;return $b.recreateResource=function(){var $$=$S$.mainContext;this._frameBuffer||(this._frameBuffer=$$.createFramebuffer()),this._source||(this._source=$$.createTexture());var $b=$P$.curBindTexTarget,$u=$P$.curBindTexValue;$P$.bindTexture($$,3553,this._source),$$.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $Z=this._minFifter,$E=this._magFifter,$r=this._repeat?10497:33071,$F=$w.isPOT(this._w,this._h);if($F?(this._mipMap?-1!==$Z||($Z=9987):-1!==$Z||($Z=9729),-1!==$E||($E=9729),$$.texParameteri(3553,10241,$Z),$$.texParameteri(3553,10240,$E),$$.texParameteri(3553,10242,$r),$$.texParameteri(3553,10243,$r),this._mipMap&&$$.generateMipmap(3553)):(-1!==$Z||($Z=9729),-1!==$E||($E=9729),$$.texParameteri(3553,10241,$Z),$$.texParameteri(3553,10240,$E),$$.texParameteri(3553,10242,33071),$$.texParameteri(3553,10243,33071)),$$.bindFramebuffer(36160,this._frameBuffer),$$.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$$.createRenderbuffer()),$$.bindRenderbuffer(36161,this._depthStencilBuffer),$$.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$$.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$$.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$$.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$$.bindFramebuffer(36160,null),$b&&$u&&$P$.bindTexture($$,$b,$u),$$.bindRenderbuffer(36161,null),$F&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$b.disposeResource=function(){this._frameBuffer&&($S$.mainContext.deleteTexture(this._source),$S$.mainContext.deleteFramebuffer(this._frameBuffer),$S$.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},$Z(0,$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$Z(0,$b,"frameBuffer",function(){return this._frameBuffer}),$H}(),$A$=function($$){function $x($$,$b,$u,$Z,$E,$r,$F){this.offsetX=0,this.offsetY=0,$x.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$r,this.canvas=$$,this._ctx=$$.getContext("2d",void 0),this._w=$Z,this._h=$E,this.offsetX=$b,this.offsetY=$u,this.src=$F,this._enableMerageInAtlas=!0,$n.enabled&&this._w<$n.atlasLimitWidth&&this._h<$n.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$o($x,"laya.webgl.resource.WebGLSubImage",$u);var $b=$x.prototype;return $i.imps($b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$b.size=function($$,$b){this._w=$$,this._h=$b,this._ctx&&this._ctx.size($$,$b),this.canvas&&(this.canvas.height=$b,this.canvas.width=$$)},$b.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$b.createWebGlTexture=function(){var $$=$S$.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $b=this._source=$$.createTexture(),$u=$P$.curBindTexTarget,$Z=$P$.curBindTexValue;$P$.bindTexture($$,3553,$b),$$.pixelStorei(37441,!0),$$.texImage2D(3553,0,6408,6408,5121,this.canvas),$$.pixelStorei(37441,!1);var $E=this.minFifter,$r=this.magFifter,$F=this.repeat?10497:33071,$x=$w.isPOT(this.width,this.height);$x?(this.mipmap?-1!==$E||($E=9987):-1!==$E||($E=9729),-1!==$r||($r=9729),$$.texParameteri(3553,10240,$r),$$.texParameteri(3553,10241,$E),$$.texParameteri(3553,10242,$F),$$.texParameteri(3553,10243,$F),this.mipmap&&$$.generateMipmap(3553)):(-1!==$E||($E=9729),-1!==$r||($r=9729),$$.texParameteri(3553,10241,$E),$$.texParameteri(3553,10240,$r),$$.texParameteri(3553,10242,33071),$$.texParameteri(3553,10243,33071)),$u&&$Z&&$P$.bindTexture($$,$u,$Z),this.canvas=null,$x&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$b.disposeResource=function(){$n.enabled&&this._allowMerageInAtlas||!this._source||($S$.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$b.clearAtlasSource=function(){},$Z(0,$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Z(0,$b,"atlasSource",function(){return this.canvas}),$Z(0,$b,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($$){this._allowMerageInAtlas=$$}),$x}(),$j$=function($$){function $H($$,$b,$u,$Z){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$H.__super.call(this),!$$||!$b)throw"Shader Error";this._id=++$H._count,this._vs=$$,this._ps=$b,this._nameMap=$Z||{},null!=$u&&($H.sharders[$u]=this)}$o($H,"laya.webgl.shader.Shader",$M$);var $b=$H.prototype;return $b.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$b.disposeResource=function(){$S$.mainContext.deleteShader(this._vshader),$S$.mainContext.deleteShader(this._pshader),$S$.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$b._compile=function(){if(!$S$.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $$=[this._vs,this._ps],$b=$S$.mainContext;if(this._program=$b.createProgram(),this._vshader=$H._createShader($b,$$[0],35633),this._pshader=$H._createShader($b,$$[1],35632),$b.attachShader(this._program,this._vshader),$b.attachShader(this._program,this._pshader),$b.linkProgram(this._program),!$T.isConchApp&&!$b.getProgramParameter(this._program,35714))throw $b.getProgramInfoLog(this._program);var $u,$Z,$E=0,$r=0;for($r=$T.isConchApp?$b.getProgramParameterEx(this._vs,this._ps,"",35721):$b.getProgramParameter(this._program,35721),$E=0;$E<$r;$E++){var $F=null;$u={vartype:"attribute",glfun:null,ivartype:0,attrib:$F=$T.isConchApp?$b.getActiveAttribEx(this._vs,this._ps,"",$E):$b.getActiveAttrib(this._program,$E),location:$b.getAttribLocation(this._program,$F.name),name:$F.name,type:$F.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($u)}var $x=0;for($x=$T.isConchApp?$b.getProgramParameterEx(this._vs,this._ps,"",35718):$b.getProgramParameter(this._program,35718),$E=0;$E<$x;$E++){var $g=null;$g=$T.isConchApp?$b.getActiveUniformEx(this._vs,this._ps,"",$E):$b.getActiveUniform(this._program,$E),0<($u={vartype:"uniform",glfun:null,ivartype:1,attrib:$F,location:$b.getUniformLocation(this._program,$g.name),name:$g.name,type:$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($u.name=$u.name.substr(0,$u.name.length-3),$u.isArray=!0,$u.location=$b.getUniformLocation(this._program,$u.name)),this._params.push($u)}for($E=0,$Z=this._params.length;$E<$Z;$E++)if(($u=this._params[$E]).indexOfParams=$E,$u.index=1,$u.value=[$u.location,null],$u.codename=$u.name,$u.name=this._nameMap[$u.codename]?this._nameMap[$u.codename]:$u.codename,(this._paramsMap[$u.name]=$u)._this=this,$u.uploadedValue=[],"attribute"!==$u.vartype)switch($u.type){case 5124:$u.fun=$u.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$u.fun=$u.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$u.fun=$u.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$u.fun=$u.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$u.fun=$u.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$u.fun=this._uniform_sampler2D;break;case 35680:$u.fun=this._uniform_samplerCube;break;case 35676:$u.glfun=$b.uniformMatrix4fv,$u.fun=this._uniformMatrix4fv;break;case 35670:$u.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $u.fun=this._attribute}},$b.getUniform=function($$){return this._paramsMap[$$]},$b._attribute=function($$,$b){var $u=$S$.mainContext,$Z=$X$._enableAtributes,$E=$$.location;return $Z[$E]||$u.enableVertexAttribArray($E),$u.vertexAttribPointer($E,$b[0],$b[1],$b[2],$b[3],$b[4]+this._offset),$Z[$E]=$X$._bindVertexBuffer,1},$b._uniform1f=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b?($S$.mainContext.uniform1f($$.location,$u[0]=$b),1):0},$b._uniform1fv=function($$,$b){if($b.length<4){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($S$.mainContext.uniform1fv($$.location,$b),$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3],1):0}return $S$.mainContext.uniform1fv($$.location,$b),1},$b._uniform_vec2=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]?($S$.mainContext.uniform2f($$.location,$u[0]=$b[0],$u[1]=$b[1]),1):0},$b._uniform_vec2v=function($$,$b){if($b.length<2){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($S$.mainContext.uniform2fv($$.location,$b),$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3],1):0}return $S$.mainContext.uniform2fv($$.location,$b),1},$b._uniform_vec3=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]?($S$.mainContext.uniform3f($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2]),1):0},$b._uniform_vec3v=function($$,$b){return $S$.mainContext.uniform3fv($$.location,$b),1},$b._uniform_vec4=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($S$.mainContext.uniform4f($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3]),1):0},$b._uniform_vec4v=function($$,$b){return $S$.mainContext.uniform4fv($$.location,$b),1},$b._uniformMatrix2fv=function($$,$b){return $S$.mainContext.uniformMatrix2fv($$.location,!1,$b),1},$b._uniformMatrix3fv=function($$,$b){return $S$.mainContext.uniformMatrix3fv($$.location,!1,$b),1},$b._uniformMatrix4fv=function($$,$b){return $S$.mainContext.uniformMatrix4fv($$.location,!1,$b),1},$b._uniform1i=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b?($S$.mainContext.uniform1i($$.location,$u[0]=$b),1):0},$b._uniform1iv=function($$,$b){return $S$.mainContext.uniform1iv($$.location,$b),1},$b._uniform_ivec2=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]?($S$.mainContext.uniform2i($$.location,$u[0]=$b[0],$u[1]=$b[1]),1):0},$b._uniform_ivec2v=function($$,$b){return $S$.mainContext.uniform2iv($$.location,$b),1},$b._uniform_vec3i=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]?($S$.mainContext.uniform3i($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2]),1):0},$b._uniform_vec3vi=function($$,$b){return $S$.mainContext.uniform3iv($$.location,$b),1},$b._uniform_vec4i=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($S$.mainContext.uniform4i($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3]),1):0},$b._uniform_vec4vi=function($$,$b){return $S$.mainContext.uniform4iv($$.location,$b),1},$b._uniform_sampler2D=function($$,$b){var $u=$S$.mainContext,$Z=$$.uploadedValue;return null==$Z[0]?($Z[0]=this._curActTexIndex,$u.uniform1i($$.location,this._curActTexIndex),$u.activeTexture($H._TEXTURES[this._curActTexIndex]),$P$.bindTexture($u,3553,$b),this._curActTexIndex++,1):($u.activeTexture($H._TEXTURES[$Z[0]]),$P$.bindTexture($u,3553,$b),0)},$b._uniform_samplerCube=function($$,$b){var $u=$S$.mainContext,$Z=$$.uploadedValue;return null==$Z[0]?($Z[0]=this._curActTexIndex,$u.uniform1i($$.location,this._curActTexIndex),$u.activeTexture($H._TEXTURES[this._curActTexIndex]),$P$.bindTexture($u,34067,$b),this._curActTexIndex++,1):($u.activeTexture($H._TEXTURES[$Z[0]]),$P$.bindTexture($u,34067,$b),0)},$b._noSetValue=function($$){console.log("no....:"+$$.name)},$b.uploadOne=function($$,$b){this.activeResource(),$P$.UseProgram(this._program);var $u=this._paramsMap[$$];$u.fun.call(this,$u,$b)},$b.uploadTexture2D=function($$){$V.shaderCall++;var $b=$S$.mainContext;$b.activeTexture(33984),$P$.bindTexture($b,3553,$$)},$b.uploadTexture2D1=function($$){$V.shaderCall++;var $b=$S$.mainContext;$b.activeTexture(33985),$P$.bindTexture($b,3553,$$)},$b.upload=function($$,$b){$M$.activeShader=$M$.bindShader=this,this._lastUseFrameCount===$V.loopCount||this.activeResource(),$P$.UseProgram(this._program),this._reCompile?($b=this._params,this._reCompile=!1):$b=$b||this._params;$S$.mainContext;for(var $u,$Z,$E=$b.length,$r=0,$F=0;$F<$E;$F++)null!==($Z=$$[($u=$b[$F]).name])&&($r+=$u.fun.call(this,$u,$Z));$V.shaderCall+=$r},$b.uploadArray=function($$,$b,$u){$M$.activeShader=this,($M$.bindShader=this).activeResource(),$P$.UseProgram(this._program);this._params;for(var $Z,$E,$r=0,$F=$b-2;0<=$F;$F-=2)($E=this._paramsMap[$$[$F]])&&null!=($Z=$$[$F+1])&&($u&&$u[$E.name]&&$u[$E.name].bind(),$r+=$E.fun.call(this,$E,$Z));$V.shaderCall+=$r},$b.getParams=function(){return this._params},$H.getShader=function($$){return $H.sharders[$$]},$H.create=function($$,$b,$u,$Z){return new $H($$,$b,$u,$Z)},$H.withCompile=function($$,$b,$u,$Z){if($u&&$H.sharders[$u])return $H.sharders[$u];var $E=$H._preCompileShader[2e-4*$$];if(!$E)throw new Error("withCompile shader err!"+$$);return $E.createShader($b,$u,$Z)},$H.withCompile2D=function($$,$b,$u,$Z,$E){if($Z&&$H.sharders[$Z])return $H.sharders[$Z];var $r=$H._preCompileShader[2e-4*$$+$b];if(!$r)throw new Error("withCompile shader err!"+$$+" "+$b);return $r.createShader($u,$Z,$E)},$H.addInclude=function($$,$b){$y$.addInclude($$,$b)},$H.preCompile=function($$,$b,$u,$Z){var $E=2e-4*$$;$H._preCompileShader[$E]=new $y$($E,$b,$u,$Z)},$H.preCompile2D=function($$,$b,$u,$Z,$E){var $r=2e-4*$$+$b;$H._preCompileShader[$r]=new $y$($r,$u,$Z,$E)},$H._createShader=function($$,$b,$u){var $Z=$$.createShader($u);return $$.shaderSource($Z,$b),$$.compileShader($Z),$Z},$H._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$H._count=0,$H._preCompileShader={},$H.SHADERNAME2ID=2e-4,$H.sharders=(($H.sharders=[]).length=32,$H.sharders),$F($H,["nameKey",function(){return this.nameKey=new $v}]),$H}(),$h$=function($$){function $b(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$b.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$o($b,"laya.webgl.utils.Buffer2D",$$);var $u=$b.prototype;return $u.needSize=function($$){var $b=this._byteLength;if($$){var $u=this._byteLength+$$;$u<=this._buffer.byteLength||this._resizeBuffer($u<<1,!0),this._byteLength=$u}return $b},$u._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$V.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$X$._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$X$._gl.bufferSubData(this._bufferType,0,this._buffer)},$u._bufferSubData=function($$,$b,$u){if(void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$V.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$X$._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$b||$u){var $Z=this._buffer.slice($b,$u);$X$._gl.bufferSubData(this._bufferType,$$,$Z)}else $X$._gl.bufferSubData(this._bufferType,$$,this._buffer)},$u._checkArrayUse=function(){},$u._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$u._bind_subUpload=function($$,$b,$u){return void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($$,$b,$u),!0)},$u._resizeBuffer=function($$,$b){if($$<this._buffer.byteLength)return this;if(this.memorySize=$$,$b&&this._buffer&&0<this._buffer.byteLength){var $u=new ArrayBuffer($$);new Uint8Array($u).set(new Uint8Array(this._buffer),0),this._buffer=$u}else this._buffer=new ArrayBuffer($$);return this._checkArrayUse(),this._upload=!0,this},$u.append=function($$){this._upload=!0;var $b,$u;$b=$$.byteLength,$$ instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$b,!0),$u=new Uint8Array(this._buffer,this._byteLength)):$$ instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$b,!0),$u=new Uint16Array(this._buffer,this._byteLength)):$$ instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$b,!0),$u=new Float32Array(this._buffer,this._byteLength)),$u.set($$,0),this._byteLength+=$b,this._checkArrayUse()},$u.appendU16Array=function($$,$b){this._resizeBuffer(this._byteLength+2*$b,!0);for(var $u=new Uint16Array(this._buffer,this._byteLength,$b),$Z=0;$Z<$b;$Z++)$u[$Z]=$$[$Z];this._byteLength+=2*$b,this._checkArrayUse()},$u.appendEx=function($$,$b){this._upload=!0;var $u;$u=$$.byteLength,this._resizeBuffer(this._byteLength+$u,!0),new $b(this._buffer,this._byteLength).set($$,0),this._byteLength+=$u,this._checkArrayUse()},$u.appendEx2=function($$,$b,$u,$Z){void 0===$Z&&($Z=1),this._upload=!0;var $E,$r;$E=$u*$Z,this._resizeBuffer(this._byteLength+$E,!0),$r=new $b(this._buffer,this._byteLength);var $F=0;for($F=0;$F<$u;$F++)$r[$F]=$$[$F];this._byteLength+=$E,this._checkArrayUse()},$u.getBuffer=function(){return this._buffer},$u.setNeedUpload=function(){this._upload=!0},$u.getNeedUpload=function(){return this._upload},$u.upload=function(){var $$=this._bind_upload();return $X$._gl.bindBuffer(this._bufferType,null),$X$._bindActive[this._bufferType]=null,$M$.activeShader=null,$$},$u.subUpload=function($$,$b,$u){void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0);var $Z=this._bind_subUpload();return $X$._gl.bindBuffer(this._bufferType,null),$X$._bindActive[this._bufferType]=null,$M$.activeShader=null,$Z},$u.disposeResource=function(){$$.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$u.clear=function(){this._byteLength=0,this._upload=!0},$Z(0,$u,"bufferLength",function(){return this._buffer.byteLength}),$Z(0,$u,"byteLength",null,function($$){this._byteLength!==$$&&($$<=this._buffer.byteLength||this._resizeBuffer(2*$$+256,!0),this._byteLength=$$)}),$b.__int__=function($$){$B$.QuadrangleIB=$B$.create(35044),$L$.fillIBQuadrangle($B$.QuadrangleIB,16)},$b.FLOAT32=4,$b.SHORT=2,$b}($X$),$d$=(function($b){function $u($$){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$u.__super.call(this,9)}$o($u,"laya.webgl.shader.d2.value.GlowSV",$b);var $$=$u.prototype;$$.setValue=function($$){$b.prototype.setValue.call(this,$$)},$$.clear=function(){$b.prototype.clear.call(this)}}($c$),function($$){function $b($$){$b.__super.call(this,64),this.defines.add(64)}$o($b,"laya.webgl.shader.d2.value.TextSV",$$);var $u=$b.prototype;return $u.release=function(){($b.pool[$b._length++]=this).clear()},$u.clear=function(){$$.prototype.clear.call(this)},$b.create=function(){return $b._length?$b.pool[--$b._length]:new $b(null)},$b.pool=[],$b._length=0,$b}($c$)),$U$=function($$){function $E($$,$b,$u,$Z){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$E.__super.call(this,$$,$b,$u,$Z)}$o($E,"laya.webgl.shader.d2.Shader2X",$$);var $b=$E.prototype;return $b.upload2dQuick1=function($$){this.upload($$,this._params2dQuick1||this._make2dQuick1())},$b._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $$,$b=this._params,$u=0,$Z=$b.length;$u<$Z;$u++)$$=$b[$u],($T.isFlash||"size"!==$$.name&&"position"!==$$.name&&"texcoord"!==$$.name)&&this._params2dQuick1.push($$)}return this._params2dQuick1},$b.disposeResource=function(){$$.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$b.upload2dQuick2=function($$){this.upload($$,this._params2dQuick2||this._make2dQuick2())},$b._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $$,$b=this._params,$u=0,$Z=$b.length;$u<$Z;$u++)$$=$b[$u],($T.isFlash||"size"!==$$.name)&&this._params2dQuick2.push($$)}return this._params2dQuick2},$E.create=function($$,$b,$u,$Z){return new $E($$,$b,$u,$Z)},$E}($j$),$B$=function($$){function $b($$){this._uint8Array=null,this._uint16Array=null,void 0===$$&&($$=35044),$b.__super.call(this),this._bufferUsage=$$,this._bufferType=34963,$T.isFlash||(this._buffer=new ArrayBuffer(8))}$o($b,"laya.webgl.utils.IndexBuffer2D",$h$);var $u=$b.prototype;return $u._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$u.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$u.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$u.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$b.QuadrangleIB=null,$b.create=function($$){return void 0===$$&&($$=35044),new $b($$)},$b}(),$R$=function($$){function $u($$,$b){this._floatArray32=null,this._vertexStride=0,$u.__super.call(this),this._vertexStride=$$,this._bufferUsage=$b,this._bufferType=34962,$T.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$o($u,"laya.webgl.utils.VertexBuffer2D",$$);var $b=$u.prototype;return $b.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$b.bind=function($$){$$&&$$._bind(),this._bind()},$b.insertData=function($$,$b){this.getFloat32Array().set($$,$b),this._upload=!0},$b.bind_upload=function($$){$$._bind_upload()||$$._bind(),this._bind_upload()||this._bind()},$b._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$b.disposeResource=function(){$$.prototype.disposeResource.call(this)},$b.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$Z(0,$b,"vertexStride",function(){return this._vertexStride}),$u.create=function($$,$b){return void 0===$b&&($b=35048),new $u($$,$b)},$u}($h$),$$b=function($$){function $x($$,$b,$u,$Z,$E,$r){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$u&&($u=6408),void 0===$Z&&($Z=!0),$x.__super.call(this,$$,$b),$$){if(this._format=$u,this._mipmap=$Z,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $$)this._url=$$,this._src=$$,this._image=new $N.window.Image,$b&&($b.onload&&(this.onload=$b.onload),$b.onerror&&(this.onerror=$b.onerror),$b.onCreate&&$b.onCreate(this)),this._image.crossOrigin=$$&&0==$$.indexOf("data:")?null:"",$$&&(this._image.src=$$);else if($$ instanceof ArrayBuffer){this._src=$b,this._url=this._src;var $F=new $g($$);$F.readUTFBytes(4),$F.readUTFBytes(2),$F.getInt16();$F.endian="bigEndian",this._w=$F.getInt16(),this._h=$F.getInt16();$F.getInt16(),$F.getInt16();this._image=new Uint8Array($$,$F.pos),this._format=$S$.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$n.enabled&&this._w<$n.atlasLimitWidth&&this._h<$n.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($$ instanceof Uint8Array))return this._src=$b,this._url=this._src,this._image=$$.source||$$,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$b,this._url=this._src,this._w=$E,this._h=$r,this._image=$$,this._format=0===$u?$$.byteLength/($E*$r)==4?6408:6407:$u}this._$5__enableMerageInAtlas=!0}}$o($x,"laya.webgl.resource.WebGLImage",$e);var $b=$x.prototype;return $i.imps($b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$b._init_=function($$,$b){},$b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $$=$S$.mainContext,$b=this._source=$$.createTexture(),$u=$P$.curBindTexTarget,$Z=$P$.curBindTexValue;$P$.bindTexture($$,3553,$b);var $E=this.minFifter,$r=this.magFifter,$F=this.repeat?10497:33071,$x=$w.isPOT(this._w,this._h),$g=!1;switch($x?(this.mipmap?-1!==$E||($E=9987):-1!==$E||($E=9729),-1!==$r||($r=9729),$$.texParameteri(3553,10241,$E),$$.texParameteri(3553,10240,$r),$$.texParameteri(3553,10242,$F),$$.texParameteri(3553,10243,$F),this.mipmap&&$$.generateMipmap(3553)):(-1!==$E||($E=9729),-1!==$r||($r=9729),$$.texParameteri(3553,10241,$E),$$.texParameteri(3553,10240,$r),$$.texParameteri(3553,10242,33071),$$.texParameteri(3553,10243,33071)),$$.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$$.pixelStorei($$.UNPACK_ALIGNMENT,1),$$.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$$.pixelStorei($$.UNPACK_ALIGNMENT,1),$$.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$g=!0,$$.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $S$.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$g=!0,$$.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$$.pixelStorei(37441,!1),$u&&$Z&&$P$.bindTexture($$,$u,$Z),this.uri||(this.uri=this._url),$g?this.memorySize=this._image.length:$x&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$b.recreateResource=function(){var $$=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $b=this;this._image=new $N.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($b._needReleaseAgain)return $b._needReleaseAgain=!1,$b._image.onload=null,void($b._image=null);$b._allowMerageInAtlas&&$b._enableMerageInAtlas?($$.memorySize=0,$$._recreateLock=!1):$b._createWebGlTexture(),$b.completeCreate()},this._image.src=this._src}},$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$S$.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$b.onresize=function(){this._w=this._image.width,this._h=this._image.height,$n.enabled&&this._w<$n.atlasLimitWidth&&this._h<$n.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$b.clearAtlasSource=function(){this._image=null},$Z(0,$b,"format",function(){return this._format}),$Z(0,$b,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($$){this._$5__enableMerageInAtlas=$$}),$Z(0,$b,"mipmap",function(){return this._mipmap}),$Z(0,$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Z(0,$b,"atlasSource",function(){return this._image}),$Z(0,$b,"onload",null,function($$){var $b=this;this._onload=$$,this._image&&(this._image.onload=null!=this._onload?function(){$b.onresize(),$b._onload()}:null)}),$Z(0,$b,"onerror",null,function($$){var $b=this;this._onerror=$$,this._image&&(this._image.onerror=null!=this._onerror?function(){$b._onerror()}:null)}),$x}();$i.__init([$N$,$m,$z$,$y$])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($$,$b){"use strict";for(var $u in Object.defineProperty($b,"__esModule",{value:!0}),Laya){var $Z=Laya[$u];$Z&&$Z.__isclass&&($b[$u]=$Z)}}),function($r,$$,$Z){$Z.un,$Z.uns;var $E=$Z.static,$F=$Z.class,$x=$Z.getset,$g=($Z.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$D=laya.utils.ClassUtils,$I=(laya.events.Event,laya.utils.HTMLChar),$H=laya.net.Loader,$w=(laya.display.Node,laya.maths.Rectangle),$o=laya.renders.Render,$N=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$e=laya.utils.Stat,$M=laya.display.Text,$L=laya.resource.Texture,$T=laya.net.URL,$_=laya.utils.Utils,$y=function(){function $N(){}return $F($N,"laya.html.utils.HTMLParse"),$N.parse=function($$,$b,$u){$b=($b="<root>"+($b=$b.replace(/<br>/g,"<br/>"))+"</root>").replace($N.spacePattern,$N.char255);var $Z=$_.parseXMLFromString($b);$N._parseXML($$,$Z.childNodes[0].childNodes,$u)},$N._parseXML=function($$,$b,$u,$Z){var $E=0,$r=0;if($b.join||$b.item)for($E=0,$r=$b.length;$E<$r;++$E)$N._parseXML($$,$b[$E],$u,$Z);else{var $F,$x,$g;if(3==$b.nodeType)return void($$ instanceof laya.html.dom.HTMLDivElement?(null==$b.nodeName&&($b.nodeName="#text"),$x=$b.nodeName.toLowerCase(),0<($g=$b.textContent.replace(/^\s+|\s+$/g,"")).length&&($F=$D.getInstance($x))&&($$.addChild($F),$F.innerTEXT=$g.replace($N.char255AndOneSpacePattern," "))):0<($g=$b.textContent.replace(/^\s+|\s+$/g,"")).length&&($$.innerTEXT=$g.replace($N.char255AndOneSpacePattern," ")));if("#comment"==($x=$b.nodeName.toLowerCase()))return;if($F=$D.getInstance($x)){($F=$$.addChild($F)).URI=$u,$F.href=$Z;var $H=$b.attributes;if($H&&0<$H.length)for($E=0,$r=$H.length;$E<$r;++$E){var $w=$H[$E],$I=$w.nodeName,$o=$w.value;$F._setAttributes($I,$o)}$N._parseXML($F,$b.childNodes,$u,$F.href)}else $N._parseXML($$,$b.childNodes,$u,$Z)}},$N.char255=String.fromCharCode(255),$N.spacePattern=/&nbsp;|&#160;/g,$N.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$N}(),$S=function(){function $k(){}return $F($k,"laya.html.utils.Layout"),$k.later=function($$){null==$k._will&&($k._will=[],$Z.stage.frameLoop(1,null,function(){if(!($k._will.length<1)){for(var $$=0;$$<$k._will.length;$$++)laya.html.utils.Layout.layout($k._will[$$]);$k._will.length=0}})),$k._will.push($$)},$k.layout=function($$){if(!$$||!$$._style)return null;if(0==(512&$$._style._type))return null;$$.getStyle()._type&=-513;var $b=$k._multiLineLayout($$);return $o.isConchApp&&$$.layaoutCallNative&&$$.layaoutCallNative(),$b},$k._multiLineLayout=function($$){if($M.RightToLeft)return $k._multiLineLayout2($$);var $b=new Array;$$._addChildsToLayout($b);var $u,$Z,$E,$r,$F,$x=0,$g=$b.length,$H=$$._getCSSStyle(),$w=$H.letterSpacing,$I=$H.leading,$o=$H.lineHeight,$N=$H._widthAuto()||!$H.wordWrap,$D=$N?999999:$$.width,$e=($$.height,0),$L=$H.italic?$H.fontSize/3:0,$T=$H._getAlign(),$_=$H._getValign(),$y=0!==$_||0!==$T||0!=$o,$S=0,$P=0,$i=0,$z=0,$q=new Array,$a=$q[0]=new $l,$t=!1,$C=!1;$a.h=0,$H.italic&&($D-=$H.fontSize/3);var $K=0,$O=!0;function $V(){$a.y=$P,$P+=$a.h+$I,0==$a.h&&($P+=$o),$a.mWidth=$K,$K=0,$a=new $l,$q.push($a),$a.h=0,$t=!($O=!($S=0))}for($x=0;$x<$g;$x++)if(null!=($u=$b[$x]))if($O=!1,$u instanceof laya.html.dom.HTMLBrElement)$V(),$a.y=$P;else{if($u._isChar()){if(($r=$u).isWord)$t=$C||"\n"===$r.char,$a.wordStartIndex=$a.elements.length;else{if($i=$r.width+$r.style.letterSpacin,0<$q.length&&$D<$S+$i&&0<$a.wordStartIndex){var $v;$v=$a.elements.length-$a.wordStartIndex+1,$a.elements.length=$a.wordStartIndex,$x-=$v,$V();continue}$t=!1,$K+=$r.width}$i=$r.width+$w,$z=$r.height,$C=!1,($t=$t||$D<$S+$i)&&$V(),$a.minTextHeight=Math.min($a.minTextHeight,$u.height)}else $Z=$u._getCSSStyle(),$F=$u,$E=$Z.padding,0===$Z._getCssFloat()||($y=!0),$t=$C||$Z.lineElement,$i=$F.width*$F._style._tf.scaleX+$E[1]+$E[3]+$w,$z=$F.height*$F._style._tf.scaleY+$E[0]+$E[2],$C=$Z.lineElement,($t=$t||$D<$S+$i&&$Z.wordWrap)&&$V();$a.elements.push($u),$a.h=Math.max($a.h,$z),$u.x=$S,$u.y=$P,$S+=$i,$a.w=$S-$w,$a.y=$P,$e=Math.max($S+$L,$e)}else $O||($S+=$k.DIV_ELEMENT_PADDING),$a.wordStartIndex=$a.elements.length;if($P=$a.y+$a.h,$y){var $p=0,$Y=$D;for($N&&0<$$.width&&($Y=$$.width),$x=0,$g=$q.length;$x<$g;$x++)$q[$x].updatePos(0,$Y,$x,$p,$T,$_,$o),$p+=Math.max($o,$q[$x].h+$I);$P=$p}return $N&&($$.width=$e),$P>$$.height&&($$.height=$P),[$e,$P]},$k._multiLineLayout2=function($$){var $b=new Array;$$._addChildsToLayout($b);var $u,$Z,$E,$r,$F,$x=0,$g=$b.length,$H=$$._getCSSStyle(),$w=$H.letterSpacing,$I=$H.leading,$o=$H.lineHeight,$N=$H._widthAuto()||!$H.wordWrap,$D=$N?999999:$$.width,$e=($$.height,0),$L=$H.italic?$H.fontSize/3:0,$T=2-$H._getAlign(),$_=$H._getValign(),$y=0!==$_||0!=$T||0!=$o,$S=0,$P=0,$i=0,$z=0,$q=new Array,$a=$q[0]=new $l,$t=!1,$C=!1;$a.h=0,$H.italic&&($D-=$H.fontSize/3);var $K=0,$O=!0;function $V(){$a.y=$P,$P+=$a.h+$I,0==$a.h&&($P+=$o),$a.mWidth=$K,$K=0,$a=new $l,$q.push($a),$a.h=0,$t=!($O=!($S=0))}for($x=0;$x<$g;$x++)if(null!=($u=$b[$x]))if($O=!1,$u instanceof laya.html.dom.HTMLBrElement)$V(),$a.y=$P;else{if($u._isChar()){if(($r=$u).isWord)$t=$C||"\n"===$r.char,$a.wordStartIndex=$a.elements.length;else{if(0<$q.length&&$D<$S+$i&&0<$a.wordStartIndex){var $v;$v=$a.elements.length-$a.wordStartIndex+1,$a.elements.length=$a.wordStartIndex,$x-=$v,$V();continue}$t=!1,$K+=$r.width}$i=$r.width+$w,$z=$r.height,$C=!1,($t=$t||$D<$S+$i)&&$V(),$a.minTextHeight=Math.min($a.minTextHeight,$u.height)}else $Z=$u._getCSSStyle(),$F=$u,$E=$Z.padding,0===$Z._getCssFloat()||($y=!0),$t=$C||$Z.lineElement,$i=$F.width*$F._style._tf.scaleX+$E[1]+$E[3]+$w,$z=$F.height*$F._style._tf.scaleY+$E[0]+$E[2],$C=$Z.lineElement,($t=$t||$D<$S+$i&&$Z.wordWrap)&&$V();$a.elements.push($u),$a.h=Math.max($a.h,$z),$u.x=$S,$u.y=$P,$S+=$i,$a.w=$S-$w,$a.y=$P,$e=Math.max($S+$L,$e)}else $O||($S+=$k.DIV_ELEMENT_PADDING),$a.wordStartIndex=$a.elements.length;if($P=$a.y+$a.h,$y){var $p=0,$Y=$D;for($x=0,$g=$q.length;$x<$g;$x++)$q[$x].updatePos(0,$Y,$x,$p,$T,$_,$o),$p+=Math.max($o,$q[$x].h+$I);$P=$p}for($N&&($$.width=$e),$P>$$.height&&($$.height=$P),$x=0,$g=$q.length;$x<$g;$x++)$q[$x].revertOrder($D);return[$e,$P]},$k._will=null,$k.DIV_ELEMENT_PADDING=0,$k}(),$l=function(){function $$(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$F($$,"laya.html.utils.LayoutLine");var $b=$$.prototype;return $b.updatePos=function($$,$b,$u,$Z,$E,$r,$F){var $x,$g=0;0<this.elements.length&&($g=($x=this.elements[this.elements.length-1]).x+$x.width-this.elements[0].x);var $H=0,$w=NaN;1===$E&&($H=($b-$g)/2),2===$E&&($H=$b-$g),0===$F||0!=$r||($r=1);for(var $I=0,$o=this.elements.length;$I<$o;$I++){var $N=($x=this.elements[$I])._getCSSStyle();switch(0!==$H&&($x.x+=$H),$N._getValign()){case 0:$x.y=$Z;break;case 1:var $D=0;99999!=this.minTextHeight&&($D=this.minTextHeight);var $e=($D+$F)/2;$e=Math.max($e,this.h),$w=(laya.html.dom.HTMLImageElement,$Z+$e-$x.height),$x.y=$w;break;case 2:$x.y=$Z+($F-$x.height)}}},$b.revertOrder=function($$){var $b;if(0<this.elements.length){var $u,$Z=0;for($u=this.elements.length,$Z=0;$Z<$u;$Z++)($b=this.elements[$Z]).x=$$-$b.x-$b.width}},$$}(),$P=function($u){function $b(){this.URI=null,this._href=null,$b.__super.call(this),this._text=$b._EMPTYTEXT,this.setStyle(new $g(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$F($b,"laya.html.dom.HTMLElement",$u);var $$=$b.prototype;return $$.layaoutCallNative=function(){var $$=0;if(this._childs&&0<($$=this._childs.length))for(var $b=0;$b<$$;$b++)this._childs[$b].layaoutCallNative&&this._childs[$b].layaoutCallNative();var $u=this._getWords();$u?laya.html.dom.HTMLElement.fillWords(this,$u,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$$.appendChild=function($$){return this.addChild($$)},$$._getWords2=function(){var $$=this._text.text;if(!$$||0===$$.length)return null;var $b,$u,$Z=0,$E=0;if(this._text.drawWords)$u=this._text.drawWords;else{for($E=($b=$$.split(" ")).length-1,$u=[],$Z=0;$Z<$E;$Z++)$u.push($b[$Z]," ");0<=$E&&$u.push($b[$E]),this._text.drawWords=$u}var $r,$F=this._text.words;if($F&&$F.length===$u.length)return $F;null===$F&&(this._text.words=$F=[]),$F.length=$u.length;var $x=this.style,$g=$x.font;for($Z=0,$E=$u.length;$Z<$E;$Z++){$r=$_.measureText($u[$Z],$g);var $H=$F[$Z]=new $I($u[$Z],$r.width,$r.height||$x.fontSize,$x);if(1<$H.char.length&&($H.charNum=$H.char),this.href){var $w=new $N;this.addChild($w),$H.setSprite($w)}}return $F},$$._getWords=function(){if(!$M.CharacterCache)return this._getWords2();var $$=this._text.text;if(!$$||0===$$.length)return null;var $b,$u=this._text.words;if($u&&$u.length===$$.length)return $u;null===$u&&(this._text.words=$u=[]),$u.length=$$.length;for(var $Z=this.style,$E=$Z.font,$r=0,$F=$$.length;$r<$F;$r++)if($b=$_.measureText($$.charAt($r),$E)){var $x=$u[$r]=new $I($$.charAt($r),$b.width,$b.height||$Z.fontSize,$Z);if(this.href){var $g=new $N;this.addChild($g),$x.setSprite($g)}}else console.warn("_getWords size is null"+$$.charAt($r),$E);return $u},$$.showLinkSprite=function(){var $$=this._text.words;if($$)for(var $b,$u,$Z=[],$E=0;$E<$$.length;$E++)$u=$$[$E],($b=new $N).graphics.drawRect(0,0,$u.width,$u.height,"#ff0000"),$b.width=$u.width,$b.height=$u.height,this.addChild($b),$Z.push($b)},$$._layoutLater=function(){var $$=this.style;512&$$._type||($$.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$$.block?($S.later(this),$$._type|=512):this.parent&&this.parent._layoutLater())},$$._setAttributes=function($$,$b){switch($$){case"style":return void this.style.cssText($b);case"class":return void(this.className=$b)}$u.prototype._setAttributes.call(this,$$,$b)},$$.updateHref=function(){if(null!=this._href){var $$=this._getWords();if($$)for(var $b,$u,$Z=0;$Z<$$.length;$Z++)($u=($b=$$[$Z]).getSprite())&&($u.size($b.width,$b.height),$u.on("click",this,this.onLinkHandler))}},$$.onLinkHandler=function($$){switch($$.type){case"click":for(var $b=this;$b;)$b.event("link",[this.href]),$b=$b.parent}},$$.formatURL=function($$){return this.URI?$T.formatURL($$,this.URI?this.URI.path:null):$$},$x(0,$$,"href",function(){return this._href},function($$){null!=(this._href=$$)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$x(0,$$,"color",null,function($$){this.style.color=$$}),$x(0,$$,"onClick",null,function($$){$Z._runScript("fn=function(event){"+$$+";}"),this.on("click",this,void 0)}),$x(0,$$,"id",null,function($$){$i.document.setElementById($$,this)}),$x(0,$$,"innerTEXT",function(){return this._text.text},function($$){this.text=$$}),$x(0,$$,"style",function(){return this._style}),$x(0,$$,"text",function(){return this._text.text},function($$){this._text==$b._EMPTYTEXT?this._text={text:$$,words:null}:(this._text.text=$$,this._text.words&&(this._text.words.length=0)),$o.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$x(0,$$,"parent",$u.prototype._$get_parent,function($$){if($$ instanceof laya.html.dom.HTMLElement){var $b=$$;this.URI||(this.URI=$b.URI),this.style.inherit($b.style)}$Z.superSet($N,this,"parent",$$)}),$x(0,$$,"className",null,function($$){this.style.attrs($i.document.styleSheets["."+$$])}),$b.fillWords=function($$,$b,$u,$Z,$E,$r,$F){$$.graphics.clear();for(var $x=0,$g=$b.length;$x<$g;$x++){var $H=$b[$x];$$.graphics.fillText($H.char,$H.x+$u,$H.y+$Z,$E,$r,"left",$F)}},$b._EMPTYTEXT={text:null,words:null},$b}($N),$b=(function($$){function $b(){$b.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$F($b,"laya.html.dom.HTMLBrElement",$P)}(),function($$){function $b(){this.contextHeight=NaN,this.contextWidth=NaN,$b.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$F($b,"laya.html.dom.HTMLDivElement",$$);var $u=$b.prototype;return $u.appendHTML=function($$){$y.parse(this,$$,this.URI),this.layout()},$u._addChildsToLayout=function($b){var $$=this._getWords();if(null==$$&&0==this._childs.length)return!1;$$&&$$.forEach(function($$){$b.push($$)});for(var $u=!0,$Z=0,$E=this._childs.length;$Z<$E;$Z++){var $r=this._childs[$Z];$u?$u=!1:$b.push(null),$r._addToLayout($b)}return!0},$u._addToLayout=function($$){this.layout()},$u.layout=function(){if(this.style){this.style._type|=512;var $$=$S.layout(this);if($$){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $w);var $b=this._$P.mHtmlBounds;$b.x=$b.y=0,$b.width=this.contextWidth=$$[0],$b.height=this.contextHeight=$$[1],this.setBounds($b)}}},$x(0,$u,"height",function(){return this._height?this._height:this.contextHeight},$$.prototype._$set_height),$x(0,$u,"innerHTML",null,function($$){this.destroyChildren(),this.appendHTML($$)}),$x(0,$u,"width",function(){return this._width?this._width:this.contextWidth},function($$){var $b=!1;$b=0===$$?$$!=this._width:$$!=this.width,$Z.superSet($P,this,"width",$$),$b&&this.layout()}),$b}($P)),$i=function($$){function $b(){this.all=new Array,this.styleSheets=$g.styleSheets,$b.__super.call(this)}$F($b,"laya.html.dom.HTMLDocument",$P);var $u=$b.prototype;return $u.getElementById=function($$){return this.all[$$]},$u.setElementById=function($$,$b){this.all[$$]=$b},$E($b,["document",function(){return this.document=new $b}]),$b}();(function($$){function $b(){this._tex=null,this._url=null,this._renderArgs=[],$b.__super.call(this),this.style.block=!0}$F($b,"laya.html.dom.HTMLImageElement",$P);var $u=$b.prototype;$u._addToLayout=function($$){!this._style.absolute&&$$.push(this)},$u.render=function($$,$b,$u){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($e.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$$.ctx.drawTexture2($b,$u,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$u.layaoutCallNative=function(){var $$=0;if(this._childs&&0<($$=this._childs.length))for(var $b=0;$b<$$;$b++)this._childs[$b].layaoutCallNative&&this._childs[$b].layaoutCallNative()},$x(0,$u,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($$){this._width!==$$&&(this._width=$$,this._style.width=$$,this.repaint())}),$x(0,$u,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($$){this._height!==$$&&(this._height=$$,this._style.height=$$,this.repaint())}),$u.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$H.clearCache(this,this._url),this._tex=null),$P.prototype.destroy.call(this)},$u.onloaded=function(){var $$=this._style;$$&&!$$.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$$&&!$$.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$o.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$u._loadImageComplete=function($$,$b,$u){if(!this._destroyed)if(null!=$u)if($u instanceof ArrayBuffer){var $Z=new DataView($u);new laya.webgl.resource.WebGLImage(new Uint8Array($u,8),$$,0,!1,$Z.getUint32(0),$Z.getUint32(4));this.onloaded()}else if($u instanceof $L)$H.imgMgrSet[$$]=$b,$r.imgMgrLock($$,$H.imgMgrSet[$$]),this._url=$$,this._tex=$u,$H.keepCache(this,$$),$H.cacheRes($$,this._tex),this.onloaded();else{var $E=-1!=$$.indexOf(".png",$$.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($u,$$,$E,!1,$u.width,$u.height);this.onloaded()}else this.event("error","Load image failed")},$x(0,$u,"src",null,function($$){($$=this.formatURL($$),this._url!=$$)&&(null!=this._tex&&($H.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$$,(this._tex=$H.getRes($$))?($H.keepCache(this,$$),this.onloaded()):$r.imgMgrLoad($$,this._loadImageComplete.bind(this),2,!1))})})(),function($$){function $b(){this.type=null,$b.__super.call(this),this.visible=!1}$F($b,"laya.html.dom.HTMLLinkElement",$$);var $u=$b.prototype;$u._onload=function($$){switch(this.type){case"text/css":$g.parseCSS($$,this.URI)}},$x(0,$u,"href",$$.prototype._$get_href,function($$){var $b=this;$$=this.formatURL($$),this.URI=new $T($$);var $u=new $H;$u.once("complete",null,function($$){$b._onload($$)}),$u.load($$,"text")}),$b._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($P),function($$){function $b(){$b.__super.call(this),this.visible=!1}$F($b,"laya.html.dom.HTMLStyleElement",$$),$x(0,$b.prototype,"text",$$.prototype._$get_text,function($$){$g.parseCSS($$,null)})}($P),function($$){function $b(){$b.__super.call(this),this._getCSSStyle().valign="middle"}$F($b,"laya.html.dom.HTMLIframeElement",$$),$x(0,$b.prototype,"href",$$.prototype._$get_href,function($u){var $Z=this;$u=this.formatURL($u);var $$=new $H;$$.once("complete",null,function($$){var $b=$Z.URI;$Z.URI=new $T($u),$Z.innerHTML=$$,!$b||($Z.URI=$b)}),$$.load($u,"text")})}($b)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($$,$b){"use strict";for(var $u in Object.defineProperty($b,"__esModule",{value:!0}),Laya){var $Z=Laya[$u];$Z&&$Z.__isclass&&($b[$u]=$Z)}}),function($E,$$,$e){$e.un,$e.uns;var $Z=$e.static,$r=$e.class,$F=$e.getset,$u=($e.__newvec,laya.display.Animation),$L=(laya.utils.Browser,laya.utils.ClassUtils),$x=laya.filters.ColorFilter,$g=laya.utils.Ease,$H=laya.events.Event,$w=(laya.events.EventDispatcher,laya.display.css.Font),$I=laya.display.FrameAnimation,$b=laya.display.Graphics,$o=laya.utils.Handler,$N=laya.display.Input,$_=laya.net.Loader,$D=(laya.display.Node,laya.maths.Point),$T=laya.maths.Rectangle,$y=laya.renders.Render,$S=laya.display.Sprite,$P=laya.display.Text,$i=laya.resource.Texture,$z=laya.utils.Tween,$q=laya.utils.Utils,$a=laya.utils.WeakObject;$e.interface("laya.ui.IItem"),$e.interface("laya.ui.ISelect"),$e.interface("laya.ui.IRender"),$e.interface("laya.ui.IComponent"),$e.interface("laya.ui.IBox","IComponent");var $t=function(){function $$(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $r($$,"laya.ui.LayoutStyle"),$Z($$,["EMPTY",function(){return this.EMPTY=new $$}]),$$}(),$C=function(){function $$(){}return $r($$,"laya.ui.Styles"),$$.labelColor="#000000",$$.buttonStateNum=3,$$.scrollBarMinNum=15,$$.scrollBarDelayTime=500,$Z($$,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$$}(),$K=function(){function $E(){}return $r($E,"laya.ui.UIUtils"),$E.fillArray=function($$,$b,$u){var $Z=$$.concat();if($b)for(var $E=$b.split(","),$r=0,$F=Math.min($Z.length,$E.length);$r<$F;$r++){var $x=$E[$r];$Z[$r]="true"==$x||"false"!=$x&&$x,null!=$u&&($Z[$r]=$u($x))}return $Z},$E.toColor=function($$){return $q.toHexColor($$)},$E.gray=function($$,$b){void 0===$b&&($b=!0),$b?$E.addFilter($$,$E.grayFilter):$E.clearFilter($$,$x)},$E.addFilter=function($$,$b){var $u=$$.filters||[];$u.push($b),$$.filters=$u},$E.clearFilter=function($$,$b){var $u=$$.filters;if(null!=$u&&0<$u.length){for(var $Z=$u.length-1;-1<$Z;$Z--){var $E=$u[$Z];$e.__typeof($E,$b)&&$u.splice($Z,1)}$$.filters=$u}},$E._getReplaceStr=function($$){return $E.escapeSequence[$$]},$E.adptString=function($$){return $$.replace(/\\(\w)/g,$E._getReplaceStr)},$E.getBindFun=function($$){var $b=$E._funMap.get($$);if(null==$b){var $u='"'+$$+'"',$Z="(function(data){if(data==null)return;with(data){try{\nreturn "+($u=$u.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$b=$e._runScript($Z),$E._funMap.set($$,$b)}return $b},$Z($E,["grayFilter",function(){return this.grayFilter=new $x([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $a}]),$E}(),$O=function(){function $$(){}return $r($$,"UIConfig"),$$.touchScrollEnable=!0,$$.mouseWheelEnable=!0,$$.showButtons=!0,$$.popupBgColor="#000000",$$.popupBgAlpha=.5,$$.closeDialogOnSide=!0,$$}(),$V=function($u){function $T(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$T.__super.call(this),this._weakKeys=[]}$r($T,"laya.ui.AutoBitmap",$u);var $$=$T.prototype;return $$.destroy=function(){if($_.clearObject(this,this._weakKey),this._weakKeys){for(var $$=0,$b=this._weakKeys.length;$$<$b;++$$)$_.clearObject(this,this._weakKeys[$$]);this._weakKeys=null}$u.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$$._setChanged=function(){this._isChanged||(this._isChanged=!0,$e.timer.callLater(this,this.changeSource))},$$.changeSource=function(){this._isChanged=!1;var $$=this._source;if($$&&$$.bitmap){var $b=this.width,$u=this.height,$Z=this._sizeGrid,$E=$$.sourceWidth,$r=$$.sourceHeight;if(!$Z||$E===$b&&$r===$u)this.cleanByTexture($$,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$b,$u);else{$_.clearObject(this,this._weakKey),$$.$_GID||($$.$_GID=$q.getGID());var $F=$$.$_GID+"."+$b+"."+$u+"."+$Z.join("."),$x=$_.findObject($F);if($q.isOKCmdList($x))return this._weakKey=$F,$_.keepObject(this,this._weakKey),void(this.cmds=$x);this.clear();var $g,$H,$w=$Z[0],$I=$Z[1],$o=$Z[2],$N=$Z[3],$D=$Z[4],$e=!1;if($b==$E&&($N=$I=0),$u==$r&&($w=$o=0),$b<$N+$I){var $L=$b;$e=!0,$b=$N+$I,this.save(),this.clipRect(0,0,$L,$u)}$N&&$w&&($g=$T.getTexture($$,0,0,$N,$w),$H=this._weakKeys[0],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[0]=$g.weakKey),this.drawTexture($g,0,0,$N,$w)):($_.clearObject(this,$H),this._weakKeys[0]="")),$I&&$w&&($g=$T.getTexture($$,$E-$I,0,$I,$w),$H=this._weakKeys[1],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[1]=$g.weakKey),this.drawTexture($g,$b-$I,0,$I,$w)):($_.clearObject(this,$H),this._weakKeys[1]="")),$N&&$o&&($g=$T.getTexture($$,0,$r-$o,$N,$o),$H=this._weakKeys[2],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[2]=$g.weakKey),this.drawTexture($g,0,$u-$o,$N,$o)):($_.clearObject(this,$H),this._weakKeys[2]="")),$I&&$o&&($g=$T.getTexture($$,$E-$I,$r-$o,$I,$o),$H=this._weakKeys[3],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[3]=$g.weakKey),this.drawTexture($g,$b-$I,$u-$o,$I,$o)):($_.clearObject(this,$H),this._weakKeys[3]="")),$w&&($g=$T.getTexture($$,$N,0,$E-$N-$I,$w),$H=this._weakKeys[4],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[4]=$g.weakKey),this.drawBitmap($D,$g,$N,0,$b-$N-$I,$w)):($_.clearObject(this,$H),this._weakKeys[4]="")),$o&&($g=$T.getTexture($$,$N,$r-$o,$E-$N-$I,$o),$H=this._weakKeys[5],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[5]=$g.weakKey),this.drawBitmap($D,$g,$N,$u-$o,$b-$N-$I,$o)):($_.clearObject(this,$H),this._weakKeys[5]="")),$N&&($g=$T.getTexture($$,0,$w,$N,$r-$w-$o),$H=this._weakKeys[6],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[6]=$g.weakKey),this.drawBitmap($D,$g,0,$w,$N,$u-$w-$o)):($_.clearObject(this,$H),this._weakKeys[6]="")),$I&&($g=$T.getTexture($$,$E-$I,$w,$I,$r-$w-$o),$H=this._weakKeys[7],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[7]=$g.weakKey),this.drawBitmap($D,$g,$b-$I,$w,$I,$u-$w-$o)):($_.clearObject(this,$H),this._weakKeys[7]="")),$g=$T.getTexture($$,$N,$w,$E-$N-$I,$r-$w-$o),$H=this._weakKeys[8],$g?($H!=$g.weakKey&&($_.clearObject(this,$H),$_.keepObject(this,$g.weakKey),this._weakKeys[8]=$g.weakKey),this.drawBitmap($D,$g,$N,$w,$b-$N-$I,$u-$w-$o)):($_.clearObject(this,$H),this._weakKeys[8]=""),$e&&this.restore(),this.autoCacheCmd&&!$y.isConchApp&&($_.saveObject($F,this.cmds,null),this._weakKey=$F,$_.keepObject(this,this._weakKey))}this._repaint()}},$$.drawBitmap=function($$,$b,$u,$Z,$E,$r){void 0===$E&&($E=0),void 0===$r&&($r=0),$E<.1||$r<.1||(!$$||$b.width==$E&&$b.height==$r?this.drawTexture($b,$u,$Z,$E,$r):this.fillTexture($b,$u,$Z,$E,$r))},$$.clear=function($$){void 0===$$&&($$=!0),$u.prototype.clear.call(this,!1)},$F(0,$$,"sizeGrid",function(){return this._sizeGrid},function($$){this._sizeGrid=$$,this._setChanged()}),$F(0,$$,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($$){this._width!=$$&&(this._width=$$,this._setChanged())}),$F(0,$$,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($$){this._height!=$$&&(this._height=$$,this._setChanged())}),$F(0,$$,"source",function(){return this._source},function($$){$$?(this._source=$$,this._setChanged()):(this._source=null,this.clear())}),$T.getTexture=function($$,$b,$u,$Z,$E){$Z<=0&&($Z=1),$E<=0&&($E=1),$$.$_GID||($$.$_GID=$q.getGID());var $r=$$.$_GID+"."+$b+"."+$u+"."+$Z+"."+$E,$F=$_.findObject($r);if((!$F||!$F.source)&&($F=$i.createFromTexture($$,$b,$u,$Z,$E))){if($$.alphaTexture){var $x=$$.width/$$.alphaTexture.width;$F.alphaTexture=$i.createFromTexture($$.alphaTexture,$b/$x,$u/$x,$Z/$x,$E/$x)}$_.saveObject($r,$F),$F.weakKey=$r}return $F},$T}($b),$v=(function($$){function $b(){$b.__super.call(this)}$r($b,"laya.ui.UIEvent",$H),$b.SHOW_TIP="showtip",$b.HIDE_TIP="hidetip"}(),function($b){function $$(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$$.__super.call(this),this._layout=$t.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$r($$,"laya.ui.Component",$b);var $u=$$.prototype;return $e.imps($u,{"laya.ui.IComponent":!0}),$u.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$u.preinitialize=function(){},$u.createChildren=function(){},$u.initialize=function(){},$u.callLater=function($$,$b){$e.timer.callLater(this,$$,$b)},$u.runCallLater=function($$){$e.timer.runCallLater(this,$$)},$u.commitMeasure=function(){},$u.changeSize=function(){this.event("resize")},$u.getLayout=function(){return this._layout===$t.EMPTY&&(this._layout=new $t),this._layout},$u._setLayoutEnabled=function($$){this._layout&&this._layout.enable!=$$&&(this._layout.enable=$$,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$u.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$u.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$u.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$u.resetLayoutX=function(){var $$=this._layout;if(isNaN($$.anchorX)||(this.pivotX=$$.anchorX*this.width),this.layoutEnabled){var $b=this.parent;$b&&(isNaN($$.centerX)?isNaN($$.left)?isNaN($$.right)||(this.x=Math.round($b.width-this.displayWidth-$$.right+this.pivotX*this.scaleX)):(this.x=Math.round($$.left+this.pivotX*this.scaleX),isNaN($$.right)||(this.width=($b._width-$$.left-$$.right)/(this.scaleX||.01))):this.x=Math.round(.5*($b.width-this.displayWidth)+$$.centerX+this.pivotX*this.scaleX))}},$u.resetLayoutY=function(){var $$=this._layout;if(isNaN($$.anchorY)||(this.pivotY=$$.anchorY*this.height),this.layoutEnabled){var $b=this.parent;$b&&(isNaN($$.centerY)?isNaN($$.top)?isNaN($$.bottom)||(this.y=Math.round($b.height-this.displayHeight-$$.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($$.top+this.pivotY*this.scaleY),isNaN($$.bottom)||(this.height=($b._height-$$.top-$$.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($b.height-this.displayHeight)+$$.centerY+this.pivotY*this.scaleY))}},$u.onMouseOver=function($$){$e.stage.event("showtip",this._toolTip)},$u.onMouseOut=function($$){$e.stage.event("hidetip",this._toolTip)},$F(0,$u,"displayWidth",function(){return this.width*this.scaleX}),$F(0,$u,"width",function(){return this._width?this._width:this.measureWidth},function($$){this._width!=$$&&(this._width=$$,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$F(0,$u,"measureWidth",function(){var $$=0;this.commitMeasure();for(var $b=this.numChildren-1;-1<$b;$b--){var $u=this.getChildAt($b);$u.visible&&($$=Math.max($u.x+$u.width*$u.scaleX,$$))}return $$}),$F(0,$u,"displayHeight",function(){return this.height*this.scaleY}),$F(0,$u,"height",function(){return this._height?this._height:this.measureHeight},function($$){this._height!=$$&&(this._height=$$,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$F(0,$u,"dataSource",function(){return this._dataSource},function($$){for(var $b in this._dataSource=$$,this._dataSource)this.hasOwnProperty($b)&&"function"!=typeof this[$b]&&(this[$b]=this._dataSource[$b])}),$F(0,$u,"scaleY",$b.prototype._$get_scaleY,function($$){$e.superGet($S,this,"scaleY")!=$$&&($e.superSet($S,this,"scaleY",$$),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$F(0,$u,"measureHeight",function(){var $$=0;this.commitMeasure();for(var $b=this.numChildren-1;-1<$b;$b--){var $u=this.getChildAt($b);$u.visible&&($$=Math.max($u.y+$u.height*$u.scaleY,$$))}return $$}),$F(0,$u,"scaleX",$b.prototype._$get_scaleX,function($$){$e.superGet($S,this,"scaleX")!=$$&&($e.superSet($S,this,"scaleX",$$),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$F(0,$u,"top",function(){return this._layout.top},function($$){$$!=this._layout.top&&(this.getLayout().top=$$,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$F(0,$u,"bottom",function(){return this._layout.bottom},function($$){$$!=this._layout.bottom&&(this.getLayout().bottom=$$,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$F(0,$u,"left",function(){return this._layout.left},function($$){$$!=this._layout.left&&(this.getLayout().left=$$,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$F(0,$u,"right",function(){return this._layout.right},function($$){$$!=this._layout.right&&(this.getLayout().right=$$,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$F(0,$u,"centerX",function(){return this._layout.centerX},function($$){$$!=this._layout.centerX&&(this.getLayout().centerX=$$,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$F(0,$u,"centerY",function(){return this._layout.centerY},function($$){$$!=this._layout.centerY&&(this.getLayout().centerY=$$,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$F(0,$u,"anchorX",function(){return this._layout.anchorX},function($$){$$!=this._layout.anchorX&&(this.getLayout().anchorX=$$,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$F(0,$u,"anchorY",function(){return this._layout.anchorY},function($$){$$!=this._layout.anchorY&&(this.getLayout().anchorY=$$,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$F(0,$u,"tag",function(){return this._tag},function($$){this._tag=$$}),$F(0,$u,"toolTip",function(){return this._toolTip},function($$){this._toolTip!=$$&&(null!=(this._toolTip=$$)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$F(0,$u,"comXml",function(){return this._comXml},function($$){this._comXml=$$}),$F(0,$u,"gray",function(){return this._gray},function($$){$$!==this._gray&&(this._gray=$$,$K.gray(this,$$))}),$F(0,$u,"disabled",function(){return this._disabled},function($$){$$!==this._disabled&&(this.gray=this._disabled=$$,this.mouseEnabled=!$$)}),$$}($S)),$p=function($$){function $b(){this.lockLayer=null,this.popupEffect=function($$){$$.scale(1,1),$z.from($$,{x:$e.stage.width/2,y:$e.stage.height/2,scaleX:0,scaleY:0},300,$g.backOut,$o.create(this,this.doOpen,[$$]))},this.closeEffect=function($$,$b){$z.to($$,{x:$e.stage.width/2,y:$e.stage.height/2,scaleX:0,scaleY:0},300,$g.strongOut,$o.create(this,this.doClose,[$$,$b]))},$b.__super.call(this),this.maskLayer=new $S,this.popupEffectHandler=$o.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$o.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$e.stage.addChild(this),$e.stage.on("resize",this,this._onResize),$O.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$r($b,"laya.ui.DialogManager",$S);var $u=$b.prototype;return $u._closeOnSide=function(){var $$=this.getChildAt(this.numChildren-1);$$ instanceof laya.ui.Dialog&&$$.close("side")},$u.setLockView=function($$){this.lockLayer||(this.lockLayer=new $Y,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($e.stage.width,$e.stage.height)),this.lockLayer.removeChildren(),$$&&($$.centerX=$$.centerY=0,this.lockLayer.addChild($$))},$u._onResize=function($$){var $b=this.maskLayer.width=$e.stage.width,$u=this.maskLayer.height=$e.stage.height;this.lockLayer&&this.lockLayer.size($b,$u),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$b,$u,$O.popupBgColor),this.maskLayer.alpha=$O.popupBgAlpha;for(var $Z=this.numChildren-1;-1<$Z;$Z--){var $E=this.getChildAt($Z);$E.popupCenter&&this._centerDialog($E)}},$u._centerDialog=function($$){$$.x=Math.round(($e.stage.width-$$.width>>1)+$$.pivotX),$$.y=Math.round(($e.stage.height-$$.height>>1)+$$.pivotY)},$u.open=function($$,$b,$u){void 0===$b&&($b=!1),void 0===$u&&($u=!1),$b&&this._closeAll(),$$.popupCenter&&this._centerDialog($$),this.addChild($$),($$.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$u&&null!=$$.popupEffect?$$.popupEffect.runWith($$):this.doOpen($$),this.event("open")},$u.doOpen=function($$){$$.onOpened()},$u.lock=function($$){this.lockLayer&&($$?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$u.close=function($$,$b,$u){void 0===$u&&($u=!1),$u&&null!=$$.closeEffect?$$.closeEffect.runWith([$$,$b]):this.doClose($$,$b),this.event("close")},$u.doClose=function($$,$b){$$.removeSelf(),$$.isModal&&this._checkMask(),$$.closeHandler&&$$.closeHandler.runWith($b),$$.onClosed($b)},$u.closeAll=function(){this._closeAll(),this.event("close")},$u._closeAll=function(){for(var $$=this.numChildren-1;-1<$$;$$--){var $b=this.getChildAt($$);$b&&null!=$b.close&&this.doClose($b)}},$u.getDialogsByGroup=function($$){for(var $b=[],$u=this.numChildren-1;-1<$u;$u--){var $Z=this.getChildAt($u);$Z&&$Z.group===$$&&$b.push($Z)}return $b},$u.closeByGroup=function($$){for(var $b=[],$u=this.numChildren-1;-1<$u;$u--){var $Z=this.getChildAt($u);$Z&&$Z.group===$$&&($Z.close(),$b.push($Z))}return $b},$u._checkMask=function(){this.maskLayer.removeSelf();for(var $$=this.numChildren-1;-1<$$;$$--){var $b=this.getChildAt($$);if($b&&$b.isModal)return void this.addChildAt(this.maskLayer,$$)}},$b}(),$Y=function($$){function $b(){$b.__super.call(this)}$r($b,"laya.ui.Box",$$);var $u=$b.prototype;return $e.imps($u,{"laya.ui.IBox":!0}),$F(0,$u,"dataSource",$$.prototype._$get_dataSource,function($$){for(var $b in this._dataSource=$$){var $u=this.getChildByName($b);$u?$u.dataSource=$$[$b]:this.hasOwnProperty($b)&&"function"!=typeof this[$b]&&(this[$b]=$$[$b])}}),$b}($v),$k=function($b){function $u($$,$b){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$u.__super.call(this),this._labelColors=$C.buttonLabelColors,this._stateNum=$C.buttonStateNum,void 0===$b&&($b=""),this.skin=$$,this.label=$b}$r($u,"laya.ui.Button",$b);var $$=$u.prototype;return $e.imps($$,{"laya.ui.ISelect":!0}),$$.destroy=function($$){this.clearEvent(),$_.clearCache(this,this._skin),$_.clearObject(this,this._weakKey),void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($$),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$$.clearEvent=function(){this._skin&&$E.atalsNotify&&$E.atalsNotify.off(this._skin,this,this._setBtnSource)},$$.createChildren=function(){this.graphics=this._bitmap=new $V},$$.createText=function(){this._text||(this._text=new $P,this._text.overflow=$P.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$$.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$$.onMouse=function($$){if(!1!==this.toggle||!this._selected)return"click"===$$.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$u.stateMap[$$.type]))},$$.changeClips=function(){var $$=$_.getRes(this._skin);if($$)if(this._skin&&""!=this._skin){$_.clearObject(this,this._weakKey);var $b=$$.sourceWidth,$u=$$.sourceHeight/this._stateNum;$$.$_GID||($$.$_GID=$q.getGID());var $Z=$$.$_GID+"-"+this._stateNum,$E=$_.findObject($Z);if($q.isOkTextureList($E)||($E=null),$E)this._weakKey=$Z,$_.keepObject(this,this._weakKey),this._sources=$E;else{if(this._sources=[],1===this._stateNum)this._sources.push($$);else for(var $r=0;$r<this._stateNum;$r++){var $F=$i.createFromTexture($$,0,$u*$r,$b,$u);if($$.alphaTexture){var $x=$$.width/$$.alphaTexture.width;$F.alphaTexture=$i.createFromTexture($$.alphaTexture,0/$x,$u*$r/$x,$b/$x,$u/$x)}this._sources.push($F)}$_.saveObject($Z,this._sources),this._weakKey=$Z,$_.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$b,this._bitmap.height=this._height||$u,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$b)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$$.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $$=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$$]),this.label&&(this._text.color=this._labelColors[$$],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$$]))},$$._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$F(0,$$,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($$){this.createText(),this._text.strokeColor=$$}),$F(0,$$,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$F(0,$$,"skin",function(){return this._skin},function($$){if(this._skin!=$$)if(this.clearEvent(),$_.clearCache(this,this._skin),this._skin=$$,$_.keepCache(this,this._skin),$_.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $b=$E.resAtalsObj&&$E.resAtalsObj[this._skin];$b?($E.atalsNotify&&$E.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$b.sourceW),0==this.height&&(this.height=$b.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),$$._setBtnSource=function($$,$b){$$===this._skin&&$b&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},$F(0,$$,"state",function(){return this._state},function($$){this._state!=$$&&(this._state=$$,this._setStateChanged())}),$F(0,$$,"text",function(){return this.createText(),this._text}),$F(0,$$,"stateNum",function(){return this._stateNum},function($$){"string"==typeof $$&&($$=parseInt($$)),this._stateNum!=$$&&(this._stateNum=$$<1?1:3<$$?3:$$,this.callLater(this.changeClips))}),$F(0,$$,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($$){this._strokeColors=$K.fillArray($C.buttonLabelColors,$$,String),this._setStateChanged()}),$F(0,$$,"labelColors",function(){return this._labelColors.join(",")},function($$){this._labelColors=$K.fillArray($C.buttonLabelColors,$$,String),this._setStateChanged()}),$F(0,$$,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$F(0,$$,"label",function(){return this._text?this._text.text:null},function($$){(this._text||$$)&&(this.createText(),this._text.text!=$$&&($$&&!this._text.parent&&this.addChild(this._text),this._text.text=($$+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$F(0,$$,"selected",function(){return this._selected},function($$){this._selected!=$$&&(this._selected=$$,this.state=this._selected?2:0,this.event("change"))}),$F(0,$$,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($$){this.createText(),this._text.padding=$K.fillArray($C.labelPadding,$$,Number)}),$F(0,$$,"labelSize",function(){return this.createText(),this._text.fontSize},function($$){this.createText(),this._text.fontSize=$$}),$F(0,$$,"labelStroke",function(){return this.createText(),this._text.stroke},function($$){this.createText(),this._text.stroke=$$}),$F(0,$$,"labelBold",function(){return this.createText(),this._text.bold},function($$){this.createText(),this._text.bold=$$}),$F(0,$$,"labelFont",function(){return this.createText(),this._text.font},function($$){this.createText(),this._text.font=$$}),$F(0,$$,"labelAlign",function(){return this.createText(),this._text.align},function($$){this.createText(),this._text.align=$$}),$F(0,$$,"clickHandler",function(){return this._clickHandler},function($$){this._clickHandler=$$}),$F(0,$$,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($$){this._bitmap.sizeGrid=$K.fillArray($C.defaultSizeGrid,$$,Number)}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($v,this,"width",$$),this._autoSize&&(this._bitmap.width=$$,this._text&&(this._text.width=$$))}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($v,this,"height",$$),this._autoSize&&(this._bitmap.height=$$,this._text&&(this._text.height=$$))}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)||"string"==typeof $$?this.label=$$+"":$e.superSet($v,this,"dataSource",$$)}),$F(0,$$,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($$){this._bitmap._offset=$$?$K.fillArray([1,1],$$,Number):[]}),$Z($u,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$u}($v),$M=function($b){function $Z($$,$b,$u){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$Z.__super.call(this),void 0===$b&&($b=1),void 0===$u&&($u=1),this._clipX=$b,this._clipY=$u,this.skin=$$}$r($Z,"laya.ui.Clip",$b);var $$=$Z.prototype;return $$.destroy=function($$){this.clearEvent(),this.clearLoad(),$_.clearCache(this,this._skin),$_.clearObject(this,this._weakKey),void 0===$$&&($$=!0),$b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$$.dispose=function(){this.destroy(!0),$e.loader.clearRes(this._skin)},$$.createChildren=function(){this.graphics=this._bitmap=new $V},$$._onDisplay=function($$){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$$.changeClip=function(){if(this._clipChanged=!1,this._skin){var $$=$_.getRes(this._skin);if($$)this.loadComplete(this._skin,$$);else{if($E.resAtalsObj&&$E.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$o.create(this,this.loadComplete,[this._skin]),this._progress=null,$e.loader.load(this._skin,this._complete,this._progress)}}},$$.loadComplete=function($$,$b){if($$===this._skin&&$b){$_.clearObject(this,this._weakKey);var $u=this._clipWidth||Math.ceil($b.sourceWidth/this._clipX),$Z=this._clipHeight||Math.ceil($b.sourceHeight/this._clipY),$E=this._skin+$u+$Z,$r=$_.findObject($E);if($q.isOkTextureList($r)||($r=null),$r)this._weakKey=$E,$_.keepObject(this,this._weakKey),this._sources=$r;else{this._sources=[];for(var $F=0;$F<this._clipY;$F++)for(var $x=0;$x<this._clipX;$x++){var $g=$i.createFromTexture($b,$u*$x,$Z*$F,$u,$Z);if($b.alphaTexture){var $H=$b.width/$b.alphaTexture.width;$g.alphaTexture=$i.createFromTexture($b.alphaTexture,$u*$x/$H,$Z*$F/$H,$u/$H,$Z/$H)}this._sources.push($g)}$_.saveObject($E,this._sources),this._weakKey=$E,$_.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$$.play=function($$,$b){void 0===$$&&($$=0),void 0===$b&&($b=-1),this._isPlaying=!0,this.index=$$,this._toIndex=$b,this._index++,$e.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$$._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$$.stop=function(){this._isPlaying=!1,$e.timer.clear(this,this._loop),this.event("complete")},$$._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$F(0,$$,"interval",function(){return this._interval},function($$){this._interval!=$$&&(this._interval=$$,this._isPlaying&&this.play())}),$$.clearEvent=function(){this._skin&&$E.atalsNotify&&$E.atalsNotify.off(this._skin,this,this._setBtnSource)},$$.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$e.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$F(0,$$,"skin",function(){return this._skin},function($$){if(this._skin!=$$)if(this.clearLoad(),this.clearEvent(),$_.clearCache(this,this._skin),this._skin=$$){$_.keepCache(this,this._skin);var $b=$_.getRes($$),$u=$E.resAtalsObj&&$E.resAtalsObj[this._skin];!$b&&$u?$E.atalsNotify&&$E.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),$$._setBtnSource=function($$,$b){$$===this._skin&&$b&&(this.loadComplete($$,$b),this.clearEvent())},$F(0,$$,"sources",function(){return this._sources},function($$){this._sources=$$,this.index=this._index,this.event("loaded")}),$F(0,$$,"clipX",function(){return this._clipX},function($$){this._clipX=$$||1,this._setClipChanged()}),$F(0,$$,"clipY",function(){return this._clipY},function($$){this._clipY=$$||1,this._setClipChanged()}),$F(0,$$,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$F(0,$$,"clipWidth",function(){return this._clipWidth},function($$){this._clipWidth=$$,this._setClipChanged()}),$F(0,$$,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($$){this._bitmap.sizeGrid=$K.fillArray($C.defaultSizeGrid,$$,Number)}),$F(0,$$,"group",function(){return this._group},function($$){$$&&this._skin&&$_.setGroup(this._skin,$$),this._group=$$}),$F(0,$$,"clipHeight",function(){return this._clipHeight},function($$){this._clipHeight=$$,this._setClipChanged()}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($v,this,"width",$$),this._bitmap.width=$$}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($v,this,"height",$$),this._bitmap.height=$$}),$F(0,$$,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$F(0,$$,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$F(0,$$,"index",function(){return this._index},function($$){this._index=$$,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$$]),this.event("change")}),$F(0,$$,"autoPlay",function(){return this._autoPlay},function($$){this._autoPlay!=$$&&((this._autoPlay=$$)?this.play():this.stop())}),$F(0,$$,"isPlaying",function(){return this._isPlaying},function($$){this._isPlaying=$$}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)&&Math.floor($$)==$$||"string"==typeof $$?this.index=parseInt($$):$e.superSet($v,this,"dataSource",$$)}),$F(0,$$,"bitmap",function(){return this._bitmap}),$Z}($v),$l=function($b){function $$(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$$.__super.call(this)}$r($$,"laya.ui.ColorPicker",$b);var $u=$$.prototype;return $u.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._colorPanel&&this._colorPanel.destroy($$),this._colorButton&&this._colorButton.destroy($$),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$u.createChildren=function(){this.addChild(this._colorButton=new $k),this._colorPanel=new $Y,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $S),this._colorPanel.addChild(this._colorBlock=new $S),this._colorPanel.addChild(this._colorInput=new $N)},$u.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$u.onPanelMouseDown=function($$){$$.stopPropagation()},$u.changePanel=function(){this._panelChanged=!1;var $$=this._colorPanel.graphics;$$.clear(),$$.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($$=this._colorTiles.graphics).clear();for(var $b=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$u=0;$u<12;$u++)for(var $Z=0;$Z<20;$Z++){var $E=0;$E=0===$Z?$b[$u]:1===$Z?0:51*(((3*$u+$Z/6)%3<<0)+3*($u/6<<0))<<16|$Z%6*51<<8|($u<<0)%6*51;var $r=$K.toColor($E);this._colors.push($r);var $F=$Z*this._gridSize,$x=$u*this._gridSize;$$.drawRect($F,$x,this._gridSize,this._gridSize,$r,"#000000")}},$u.onColorButtonClick=function($$){this._colorPanel.parent?this.close():this.open()},$u.open=function(){var $$=this.localToGlobal(new $D),$b=$$.x+this._colorPanel.width<=$e.stage.width?$$.x:$e.stage.width-this._colorPanel.width,$u=$$.y+this._colorButton.height;$u=$u+this._colorPanel.height<=$e.stage.height?$u:$$.y-this._colorPanel.height,this._colorPanel.pos($b,$u),this._colorPanel.zOrder=1001,$e._currentStage.addChild(this._colorPanel),$e.stage.on("mousedown",this,this.removeColorBox)},$u.close=function(){$e.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$u.removeColorBox=function($$){this.close()},$u.onColorFieldKeyDown=function($$){13==$$.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$$.stopPropagation())},$u.onColorInputChange=function($$){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$u.onColorTilesClick=function($$){this.selectedColor=this.getColorByMouse(),this.close()},$u.onColorTilesMouseMove=function($$){this._colorInput.focus=!1;var $b=this.getColorByMouse();this._colorInput.text=$b,this.drawBlock($b)},$u.getColorByMouse=function(){var $$=this._colorTiles.getMousePoint(),$b=Math.floor($$.x/this._gridSize),$u=Math.floor($$.y/this._gridSize);return this._colors[20*$u+$b]},$u.drawBlock=function($$){var $b=this._colorBlock.graphics;$b.clear();var $u=$$||"#ffffff";$b.drawRect(0,0,50,20,$u,this._borderColor),$$||$b.drawLine(0,0,50,20,"#ff0000")},$u.changeColor=function(){var $$=this.graphics;$$.clear();var $b=this._selectedColor||"#000000";$$.drawRect(0,0,this._colorButton.width,this._colorButton.height,$b)},$u._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$F(0,$u,"inputBgColor",function(){return this._inputBgColor},function($$){this._inputBgColor=$$,this._setPanelChanged()}),$F(0,$u,"selectedColor",function(){return this._selectedColor},function($$){this._selectedColor!=$$&&(this._selectedColor=this._colorInput.text=$$,this.drawBlock($$),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$H.EMPTY.setTo("change",this,this)))}),$F(0,$u,"skin",function(){return this._colorButton.skin},function($$){this._colorButton.skin=$$,this.changeColor()}),$F(0,$u,"bgColor",function(){return this._bgColor},function($$){this._bgColor=$$,this._setPanelChanged()}),$F(0,$u,"borderColor",function(){return this._borderColor},function($$){this._borderColor=$$,this._setPanelChanged()}),$F(0,$u,"inputColor",function(){return this._inputColor},function($$){this._inputColor=$$,this._setPanelChanged()}),$$}($v),$X=function($b){function $u($$,$b){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$u.__super.call(this),this._itemColors=$C.comboBoxItemColors,this.skin=$$,this.labels=$b}$r($u,"laya.ui.ComboBox",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._button&&this._button.destroy($$),this._list&&this._list.destroy($$),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$$.createChildren=function(){this.addChild(this._button=new $k),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$$._createList=function(){this._list=new $A,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$$._setListEvent=function($$){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$o.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$$.onListDown=function($$){$$.stopPropagation()},$$.onScrollBarDown=function($$){$$.stopPropagation()},$$.onButtonMouseDown=function($$){this.callLater(this.switchTo,[!this._isOpen])},$$.changeList=function(){this._listChanged=!1;var $$=this.width-2,$b=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$$,height:this._itemHeight,fontSize:this._itemSize,color:$b}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$$.onlistItemMouse=function($$,$b){var $u=$$.type;if("mouseover"===$u||"mouseout"===$u){if(this._isCustomList)return;var $Z=this._list.getCell($b);if(!$Z)return;var $E=$Z.getChildByName("label");$E&&("mouseover"===$u?($E.bgColor=this._itemColors[0],$E.color=this._itemColors[1]):($E.bgColor=null,$E.color=this._itemColors[2]))}else"click"===$u&&(this.selectedIndex=$b,this.isOpen=!1)},$$.switchTo=function($$){this.isOpen=$$},$$.changeOpen=function(){this.isOpen=!this._isOpen},$$.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $$=this._list.graphics;$$.clear(),$$.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $b=this._list.array||[],$u=$b.length=0,$Z=this._labels.length;$u<$Z;$u++)$b.push({label:this._labels[$u]});this._list.height=this._listHeight,this._list.array=$b},$$.changeSelected=function(){this._button.label=this.selectedLabel},$$._onStageMouseWheel=function($$){this._list&&!this._list.contains($$.target)&&this.removeList(null)},$$.removeList=function($$){$e.stage.off("mousedown",this,this.removeList),$e.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$F(0,$$,"selectedIndex",function(){return this._selectedIndex},function($$){this._selectedIndex!=$$&&(this._selectedIndex=$$,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$H.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$F(0,$$,"measureHeight",function(){return this._button.height}),$F(0,$$,"skin",function(){return this._button.skin},function($$){this._button.skin!=$$&&(this._button.skin=$$,this._listChanged=!0)}),$F(0,$$,"measureWidth",function(){return this._button.width}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($v,this,"width",$$),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$F(0,$$,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($$){this.selectedIndex=this._labels.indexOf($$)}),$F(0,$$,"labels",function(){return this._labels.join(",")},function($$){0<this._labels.length&&(this.selectedIndex=-1),$$?this._labels=$$.split(","):this._labels.length=0,this._itemChanged=!0}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($v,this,"height",$$),this._button.height=this._height}),$F(0,$$,"selectHandler",function(){return this._selectHandler},function($$){this._selectHandler=$$}),$F(0,$$,"visibleNum",function(){return this._visibleNum},function($$){this._visibleNum=$$,this._listChanged=!0}),$F(0,$$,"labelBold",function(){return this._button.text.bold},function($$){this._button.text.bold=$$}),$F(0,$$,"itemColors",function(){return String(this._itemColors)},function($$){this._itemColors=$K.fillArray(this._itemColors,$$,String),this._listChanged=!0}),$F(0,$$,"itemSize",function(){return this._itemSize},function($$){this._itemSize=$$,this._listChanged=!0}),$F(0,$$,"scrollBar",function(){return this.list.scrollBar}),$F(0,$$,"isOpen",function(){return this._isOpen},function($$){if(this._isOpen!=$$)if(this._isOpen=$$,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $b=this.localToGlobal($D.TEMP.setTo(0,0)),$u=$b.y+this._button.height;$u=$u+this._listHeight<=$e.stage.height?$u:$b.y-this._listHeight,this._list.pos($b.x,$u),this._list.zOrder=1001,$e._currentStage.addChild(this._list),$e.stage.once("mousedown",this,this.removeList),$e.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$F(0,$$,"scrollBarSkin",function(){return this._scrollBarSkin},function($$){this._scrollBarSkin=$$}),$F(0,$$,"sizeGrid",function(){return this._button.sizeGrid},function($$){this._button.sizeGrid=$$}),$F(0,$$,"button",function(){return this._button}),$F(0,$$,"list",function(){return this._list||this._createList(),this._list},function($$){$$&&($$.removeSelf(),this._isCustomList=!0,this._list=$$,this._setListEvent($$),this._itemHeight=$$.getCell(0).height+$$.spaceY)}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)&&Math.floor($$)==$$||"string"==typeof $$?this.selectedIndex=parseInt($$):$$ instanceof Array?this.labels=$$.join(","):$e.superSet($v,this,"dataSource",$$)}),$F(0,$$,"labelColors",function(){return this._button.labelColors},function($$){this._button.labelColors!=$$&&(this._button.labelColors=$$)}),$F(0,$$,"labelPadding",function(){return this._button.text.padding.join(",")},function($$){this._button.text.padding=$K.fillArray($C.labelPadding,$$,Number)}),$F(0,$$,"labelSize",function(){return this._button.text.fontSize},function($$){this._button.text.fontSize=$$}),$F(0,$$,"labelFont",function(){return this._button.text.font},function($$){this._button.text.font=$$}),$F(0,$$,"stateNum",function(){return this._button.stateNum},function($$){this._button.stateNum=$$}),$u}($v),$s=function($b){function $u($$){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$u.__super.call(this),this._showButtons=$O.showButtons,this._touchScrollEnable=$O.touchScrollEnable,this._mouseWheelEnable=$O.mouseWheelEnable,this.skin=$$,this.max=1}$r($u,"laya.ui.ScrollBar",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),this.stopScroll(),this.target=null,$b.prototype.destroy.call(this,$$),this.upButton&&this.upButton.destroy($$),this.downButton&&this.downButton.destroy($$),this.slider&&this.slider.destroy($$),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$$.createChildren=function(){this.addChild(this.slider=new $m),this.addChild(this.upButton=new $k),this.addChild(this.downButton=new $k)},$$.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$$.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$$.onButtonMouseDown=function($$){var $b=$$.currentTarget===this.upButton;this.slide($b),$e.timer.once($C.scrollBarDelayTime,this,this.startLoop,[$b]),$e.stage.once("mouseup",this,this.onStageMouseUp)},$$.startLoop=function($$){$e.timer.frameLoop(1,this,this.slide,[$$])},$$.slide=function($$){$$?this.value-=this._scrollSize:this.value+=this._scrollSize},$$.onStageMouseUp=function($$){$e.timer.clear(this,this.startLoop),$e.timer.clear(this,this.slide)},$$.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$$.changeSize=function(){$b.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$$.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$$.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$$.setScroll=function($$,$b,$u){this.runCallLater(this.changeSize),this.slider.setSlider($$,$b,$u),this.slider.bar.visible=0<$b,!this._hide&&this.autoHide&&(this.visible=!1)},$$.onTargetMouseWheel=function($$){this.value-=$$.delta*this._scrollSize,this.target=this._target},$$.onTargetMouseDown=function($$){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $D),this._lastPoint.setTo($e.stage.mouseX,$e.stage.mouseY),$e.timer.clear(this,this.tweenMove),$z.clearTween(this),$e.stage.once("mouseup",this,this.onStageMouseUp2),$e.stage.once("mouseout",this,this.onStageMouseUp2),$e.timer.frameLoop(1,this,this.loop)},$$.loop=function(){var $$=$e.stage.mouseY,$b=$e.stage.mouseX;if(this._lastOffset=this.isVertical?$$-this._lastPoint.y:$b-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$e.stage._canvasTransform.getScaleY():$e.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$b,this._lastPoint.y=$$,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$$.onStageMouseUp2=function($$){if($e.stage.off("mouseup",this,this.onStageMouseUp2),$e.stage.off("mouseout",this,this.onStageMouseUp2),$e.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$z.to(this,{value:this.min},this.elasticBackTime,$g.sineOut,$o.create(this,this.elasticOver)):this._value>this.max&&$z.to(this,{value:this.max},this.elasticBackTime,$g.sineOut,$o.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$e.stage.mouseY-this._lastPoint.y:$e.stage.mouseX-this._lastPoint.x);for(var $b=0,$u=Math.min(this._offsets.length,3),$Z=0;$Z<$u;$Z++)$b+=this._offsets[this._offsets.length-1-$Z];if(this._lastOffset=$b/$u,($b=Math.abs(this._lastOffset))<2)return void this.event("end");60<$b&&(this._lastOffset=0<this._lastOffset?60:-60);var $E=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$e.timer.frameLoop(1,this,this.tweenMove,[$E])}},$$.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$z.to(this,{alpha:0},500),this.event("end")},$$.tweenMove=function($$){this._lastOffset*=this.rollRatio;var $b=NaN;if(0<$$&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$b=.5*-(this.min-$$-this.value),this._lastOffset>$b&&(this._lastOffset=$b)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$b=.5*-(this.max+$$-this.value),this._lastOffset<$b&&(this._lastOffset=$b))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($e.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$z.to(this,{value:this.min},this.elasticBackTime,$g.sineOut,$o.create(this,this.elasticOver)):this._value>this.max?$z.to(this,{value:this.max},this.elasticBackTime,$g.sineOut,$o.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$z.to(this,{alpha:0},500)}},$$.stopScroll=function(){this.onStageMouseUp2(null),$e.timer.clear(this,this.tweenMove),$z.clearTween(this)},$F(0,$$,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$F(0,$$,"skin",function(){return this._skin},function($$){this._skin!=$$&&(this._skin=$$,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$F(0,$$,"max",function(){return this.slider.max},function($$){this.slider.max=$$}),$F(0,$$,"showButtons",function(){return this._showButtons},function($$){this._showButtons=$$,this.callLater(this.changeScrollBar)}),$F(0,$$,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$F(0,$$,"min",function(){return this.slider.min},function($$){this.slider.min=$$}),$F(0,$$,"value",function(){return this._value},function($$){$$!==this._value&&(this._value=$$,this._isElastic||(this.slider._value!=$$&&(this.slider._value=$$,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$F(0,$$,"isVertical",function(){return this.slider.isVertical},function($$){this.slider.isVertical=$$}),$F(0,$$,"sizeGrid",function(){return this.slider.sizeGrid},function($$){this.slider.sizeGrid=$$}),$F(0,$$,"scrollSize",function(){return this._scrollSize},function($$){this._scrollSize=$$}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)||"string"==typeof $$?this.value=Number($$):$e.superSet($v,this,"dataSource",$$)}),$F(0,$$,"thumbPercent",function(){return this._thumbPercent},function($$){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$$=1<=$$?.99:$$,this._thumbPercent=$$,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$$,$C.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$$,$C.scrollBarMinNum))}),$F(0,$$,"target",function(){return this._target},function($$){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$$)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$F(0,$$,"hide",function(){return this._hide},function($$){this._hide=$$,this.visible=!$$}),$F(0,$$,"touchScrollEnable",function(){return this._touchScrollEnable},function($$){this._touchScrollEnable=$$,this.target=this._target}),$F(0,$$,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($$){this._mouseWheelEnable=$$,this.target=this._target}),$F(0,$$,"tick",function(){return this.slider.tick},function($$){this.slider.tick=$$}),$u}($v),$m=function($b){function $u($$){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$u.__super.call(this),this.skin=$$}$r($u,"laya.ui.Slider",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._bg&&this._bg.destroy($$),this._bar&&this._bar.destroy($$),this._progress&&this._progress.destroy($$),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$$.createChildren=function(){this.addChild(this._bg=new $n),this.addChild(this._bar=new $k)},$$.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$$.onBarMouseDown=function($$){this._globalSacle||(this._globalSacle=new $D),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$e.stage.mouseX,this._ty=$e.stage.mouseY,$e.stage.on("mousemove",this,this.mouseMove),$e.stage.once("mouseup",this,this.mouseUp),$e.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$$.showValueText=function(){if(this.showLabel){var $$=laya.ui.Slider.label;this.addChild($$),$$.textField.changeText(this._value+""),this.isVertical?($$.x=this._bar.x+20,$$.y=.5*(this._bar.height-$$.height)+this._bar.y):($$.y=this._bar.y-20,$$.x=.5*(this._bar.width-$$.width)+this._bar.x)}},$$.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$$.mouseUp=function($$){$e.stage.off("mousemove",this,this.mouseMove),$e.stage.off("mouseup",this,this.mouseUp),$e.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$$.mouseMove=function($$){var $b=this._value;this.isVertical?(this._bar.y+=($e.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($e.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$e.stage.mouseX,this._ty=$e.stage.mouseY;var $u=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$u)/$u,this._value!=$b&&this.sendChangeEvent(),this.showValueText()},$$.sendChangeEvent=function($$){void 0===$$&&($$="change"),this.event($$),this.changeHandler&&this.changeHandler.runWith(this._value)},$$.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$$.changeSize=function(){$b.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$$.setSlider=function($$,$b,$u){this._value=-1,this._min=$$,this._max=$$<$b?$b:$$,this.value=$u<$$?$$:$b<$u?$b:$u},$$.changeValue=function(){var $$=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$$)/$$,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $b=this._max-this._min;0===$b&&($b=1),this.isVertical?(this._bar.y=(this._value-this._min)/$b*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$b*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$$.onBgMouseDown=function($$){var $b=this._bg.getMousePoint();this.isVertical?this.value=$b.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$b.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$F(0,$$,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$F(0,$$,"skin",function(){return this._skin},function($$){if(this._skin!=$$){this._skin=$$,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $b=this._skin.replace(".png","$progress.png");$_.getRes($b)&&(this._progress||(this.addChild(this._progress=new $n),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$b),this.setBarPoint(),this.callLater(this.changeValue)}}),$F(0,$$,"allowClickBack",function(){return this._allowClickBack},function($$){this._allowClickBack!=$$&&((this._allowClickBack=$$)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$F(0,$$,"max",function(){return this._max},function($$){this._max!=$$&&(this._max=$$,this.callLater(this.changeValue))}),$F(0,$$,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$F(0,$$,"tick",function(){return this._tick},function($$){this._tick!=$$&&(this._tick=$$,this.callLater(this.changeValue))}),$F(0,$$,"sizeGrid",function(){return this._bg.sizeGrid},function($$){this._bg.sizeGrid=$$,this._bar.sizeGrid=$$,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$F(0,$$,"min",function(){return this._min},function($$){this._min!=$$&&(this._min=$$,this.callLater(this.changeValue))}),$F(0,$$,"value",function(){return this._value},function($$){if(this._value!=$$){var $b=this._value;this._value=$$,this.changeValue(),this._value!=$b&&this.sendChangeEvent()}}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)||"string"==typeof $$?this.value=Number($$):$e.superSet($v,this,"dataSource",$$)}),$F(0,$$,"bar",function(){return this._bar}),$Z($u,["label",function(){return this.label=new $c}]),$u}($v),$n=function($b){function $u($$){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$u.__super.call(this),this.skin=$$}$r($u,"laya.ui.Image",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$_.clearCache(this,this._skin)},$$.dispose=function(){this.destroy(!0),$_.clearCache(this,this._skin),this.clearEvent()},$$.createChildren=function(){this.graphics=this._bitmap=new $V},$$.setSource=function($$,$b){this.destroyed||$$===this._skin&&$b&&(this.source=$b,this.onCompResize(),this.clearEvent())},$$.clearEvent=function(){this._skin&&$E.atalsNotify&&$E.atalsNotify.off(this._skin,this,this.setSource)},$$.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$e.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$F(0,$$,"source",function(){return this._bitmap.source},function($$){this._bitmap&&(this._bitmap.source=$$,this.event("loaded"),this.repaint())}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"string"==typeof(this._dataSource=$$)?this.skin=$$:$e.superSet($v,this,"dataSource",$$)}),$F(0,$$,"measureHeight",function(){return this._bitmap.height}),$F(0,$$,"skin",function(){return this._skin},function($$){if(this._skin!=$$)if($_.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$$){$_.keepCache(this,this._skin);var $b=$_.getRes($$),$u=$E.resAtalsObj&&$E.resAtalsObj[this._skin];$b?(this.source=$b,this.onCompResize()):$u?($E.atalsNotify&&$E.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$u.sourceW),0==this.height&&(this.height=$u.sourceH)):(this._complete=$o.create(this,this.setSource,[this._skin]),this._progress=null,$e.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),$F(0,$$,"group",function(){return this._group},function($$){$$&&this._skin&&$_.setGroup(this._skin,$$),this._group=$$}),$F(0,$$,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($$){this._bitmap.sizeGrid=$K.fillArray($C.defaultSizeGrid,$$,Number)}),$F(0,$$,"measureWidth",function(){return this._bitmap.width}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($v,this,"width",$$),this._bitmap.width=0==$$?1e-7:$$}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($v,this,"height",$$),this._bitmap.height=0==$$?1e-7:$$}),$u}($v),$c=function($b){function $u($$){this._tf=null,$u.__super.call(this),void 0===$$&&($$=""),$w.defaultColor=$C.labelColor,this.text=$$}$r($u,"laya.ui.Label",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._tf=null},$$.createChildren=function(){this.addChild(this._tf=new $P)},$$.changeText=function($$){this._tf.changeText($$)},$F(0,$$,"padding",function(){return this._tf.padding.join(",")},function($$){this._tf.padding=$K.fillArray($C.labelPadding,$$,Number)}),$F(0,$$,"bold",function(){return this._tf.bold},function($$){this._tf.bold=$$}),$F(0,$$,"align",function(){return this._tf.align},function($$){this._tf.align=$$}),$F(0,$$,"text",function(){return this._tf.text},function($$){this._tf.text!=$$&&($$&&($$=$K.adptString($$+"")),this._tf.text=$$,this.event("change"),this._width&&this._height||this.onCompResize())}),$F(0,$$,"italic",function(){return this._tf.italic},function($$){this._tf.italic=$$}),$F(0,$$,"wordWrap",function(){return this._tf.wordWrap},function($$){this._tf.wordWrap=$$}),$F(0,$$,"font",function(){return this._tf.font},function($$){this._tf.font=$$}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)||"string"==typeof $$?this.text=$$+"":$e.superSet($v,this,"dataSource",$$)}),$F(0,$$,"color",function(){return this._tf.color},function($$){this._tf.color=$$}),$F(0,$$,"valign",function(){return this._tf.valign},function($$){this._tf.valign=$$}),$F(0,$$,"leading",function(){return this._tf.leading},function($$){this._tf.leading=$$}),$F(0,$$,"fontSize",function(){return this._tf.fontSize},function($$){this._tf.fontSize=$$}),$F(0,$$,"bgColor",function(){return this._tf.bgColor},function($$){this._tf.bgColor=$$}),$F(0,$$,"borderColor",function(){return this._tf.borderColor},function($$){this._tf.borderColor=$$}),$F(0,$$,"stroke",function(){return this._tf.stroke},function($$){this._tf.stroke=$$}),$F(0,$$,"strokeColor",function(){return this._tf.strokeColor},function($$){this._tf.strokeColor=$$}),$F(0,$$,"textField",function(){return this._tf}),$F(0,$$,"measureWidth",function(){return this._tf.width}),$F(0,$$,"measureHeight",function(){return this._tf.height}),$F(0,$$,"width",function(){return this._width||this._tf.text?$e.superGet($v,this,"width"):0},function($$){$e.superSet($v,this,"width",$$),this._tf.width=$$}),$F(0,$$,"height",function(){return this._height||this._tf.text?$e.superGet($v,this,"height"):0},function($$){$e.superSet($v,this,"height",$$),this._tf.height=$$}),$F(0,$$,"overflow",function(){return this._tf.overflow},function($$){this._tf.overflow=$$}),$F(0,$$,"underline",function(){return this._tf.underline},function($$){this._tf.underline=$$}),$F(0,$$,"underlineColor",function(){return this._tf.underlineColor},function($$){this._tf.underlineColor=$$}),$u}($v),$J=function($b){function $u($$){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$u.__super.call(this),this.skin=$$}$r($u,"laya.ui.ProgressBar",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._bg&&this._bg.destroy($$),this._bar&&this._bar.destroy($$),this._bg=this._bar=null,this.changeHandler=null},$$.createChildren=function(){this.addChild(this._bg=new $n),this.addChild(this._bar=new $n)},$$.changeValue=function(){if(this.sizeGrid){var $$=this.sizeGrid.split(","),$b=Number($$[3]),$u=Number($$[1]),$Z=(this.width-$b-$u)*this._value;this._bar.width=$b+$u+$Z,this._bar.visible=this._bar.width>$b+$u}else this._bar.width=this.width*this._value},$F(0,$$,"measureHeight",function(){return this._bg.height}),$F(0,$$,"skin",function(){return this._skin},function($$){this._skin!=$$&&(this._skin=$$,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$F(0,$$,"measureWidth",function(){return this._bg.width}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($v,this,"height",$$),this._bg.height=this._height,this._bar.height=this._height}),$F(0,$$,"bar",function(){return this._bar}),$F(0,$$,"value",function(){return this._value},function($$){this._value!=$$&&($$=1<$$?1:$$<0?0:$$,this._value=$$,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($$))}),$F(0,$$,"bg",function(){return this._bg}),$F(0,$$,"sizeGrid",function(){return this._bg.sizeGrid},function($$){this._bg.sizeGrid=this._bar.sizeGrid=$$}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($v,this,"width",$$),this._bg.width=this._width,this.callLater(this.changeValue)}),$F(0,$$,"dataSource",$b.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)||"string"==typeof $$?this.value=Number($$):$e.superSet($v,this,"dataSource",$$)}),$u}($v),$f=(function($$){function $u(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$u.__super.call(this),this._tipBox=new $v,this._tipBox.addChild(this._tipText=new $P),this._tipText.x=this._tipText.y=5,this._tipText.color=$u.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$e.stage.on("showtip",this,this._onStageShowTip),$e.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$r($u,"laya.ui.TipManager",$v);var $b=$u.prototype;$b._onStageHideTip=function($$){$e.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$b._onStageShowTip=function($$){$e.timer.once($u.tipDelay,this,this._showTip,[$$],!0)},$b._showTip=function($$){if("string"==typeof $$){var $b=String($$);Boolean($b)&&this._defaultTipHandler($b)}else $$ instanceof laya.utils.Handler?$$.run():"function"==typeof $$&&$$.apply();$e.stage.on("mousemove",this,this._onStageMouseMove),$e.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$b._onStageMouseDown=function($$){this.closeAll()},$b._onStageMouseMove=function($$){this._showToStage(this,$u.offsetX,$u.offsetY)},$b._showToStage=function($$,$b,$u){void 0===$b&&($b=0),void 0===$u&&($u=0);var $Z=$$.getBounds();$$.x=$e.stage.mouseX+$b,$$.y=$e.stage.mouseY+$u,$$.x+$Z.width>$e.stage.width&&($$.x-=$Z.width+$b),$$.y+$Z.height>$e.stage.height&&($$.y-=$Z.height+$u)},$b.closeAll=function(){$e.timer.clear(this,this._showTip),$e.stage.off("mousemove",this,this._onStageMouseMove),$e.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$b.showDislayTip=function($$){this.addChild($$),this._showToStage(this),$e._currentStage.addChild(this)},$b._showDefaultTip=function($$){this._tipText.text=$$;var $b=this._tipBox.graphics;$b.clear(),$b.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$u.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$e._currentStage.addChild(this)},$F(0,$b,"defaultTipHandler",function(){return this._defaultTipHandler},function($$){this._defaultTipHandler=$$}),$u.offsetX=10,$u.offsetY=15,$u.tipTextColor="#ffffff",$u.tipBackColor="#111111",$u.tipDelay=200}(),function($$){var $N;function $D(){this._idMap=null,this._aniList=null,this._watchMap={},$D.__super.call(this)}$r($D,"laya.ui.View",$Y);var $b=$D.prototype;return $b.createView=function($$){if($$.animations&&!this._idMap&&(this._idMap={}),$D.createComp($$,this,this),$$.animations){var $b,$u,$Z=[],$E=$$.animations,$r=0,$F=$E.length;for($r=0;$r<$F;$r++){switch($b=new $I,$u=$E[$r],$b._setUp(this._idMap,$u),(this[$u.name]=$b)._setControlNode(this),$u.action){case 1:$b.play(0,!1);break;case 2:$b.play(0,!0)}$Z.push($b)}this._aniList=$Z}0<this._width&&null==$$.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$b.onEvent=function($$,$b){},$b.loadUI=function($$){var $b=$D.uiMap[$$];$b&&this.createView($b)},$b.destroy=function($$){void 0===$$&&($$=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$$)},$b.changeData=function($$){var $b=this._watchMap[$$];if($b){console.log("change",$$);for(var $u=0,$Z=$b.length;$u<$Z;$u++){$b[$u].exe(this)}}},$D._regs=function(){for(var $$ in $D.uiClassMap)$L.regClass($$,$D.uiClassMap[$$])},$D.createComp=function($$,$b,$u,$Z){if(!($b=$b||$D.getCompInstance($$)))return console.warn("can not create:"+$$.type),null;var $E=$$.child;if($E)for(var $r=$b instanceof laya.ui.List,$F=0,$x=$E.length;$F<$x;$F++){var $g=$E[$F];if(!$b.hasOwnProperty("itemRender")||"render"!=$g.props.name&&"render"!==$g.props.renderType)if("Graphic"==$g.type)$L.addGraphicsToSprite($g,$b);else if($L.isDrawType($g.type))$L.addGraphicToSprite($g,$b,!0);else{if($r){var $H=[],$w=$D.createComp($g,null,$u,$H);$H.length&&($w._$bindData=$H)}else $w=$D.createComp($g,null,$u,$Z);"Script"==$g.type?"owner"in $w?$w.owner=$b:"target"in $w&&($w.target=$b):"mask"==$g.props.renderType||"mask"==$g.props.name?$b.mask=$w:$w instanceof laya.display.Sprite&&$b.addChild($w)}else $b.itemRender=$g}var $I=$$.props;for(var $o in $I){var $N=$I[$o];$D.eventDic[$o]?$N&&$u&&$b.on($o,$u,$u.onEvent,[$N]):$D.setCompValue($b,$o,$N,$u,$Z)}return $e.__typeof($b,"laya.ui.IItem")&&$b.initItems(),$$.compId&&$u&&$u._idMap&&($u._idMap[$$.compId]=$b),$b},$D.setCompValue=function($$,$b,$u,$Z,$E){if("string"==typeof $u&&-1<$u.indexOf("${")){if($D._sheet||($D._sheet=$L.getClass("laya.data.Table")),!$D._sheet)return void console.warn("Can not find class Sheet");if($E)$E.push($$,$b,$u);else if($Z){-1==$u.indexOf("].")&&($u=$u.replace(".","[0]."));var $r,$F,$x=new $N($$,$b,$u);$x.exe($Z);for(var $g=$u.replace(/\[.*?\]\./g,".");null!=($r=$D._parseWatchData.exec($g));){for(var $H=$r[1];null!=($F=$D._parseKeyWord.exec($H));){var $w=$F[0],$I=$Z._watchMap[$w]||($Z._watchMap[$w]=[]);$I.push($x),$D._sheet.I.notifer.on($w,$Z,$Z.changeData,[$w])}($I=$Z._watchMap[$H]||($Z._watchMap[$H]=[])).push($x),$D._sheet.I.notifer.on($H,$Z,$Z.changeData,[$H])}}}else if("var"===$b&&$Z)$Z[$u]=$$;else if("onClick"==$b){var $o=$e._runScript("(function(){"+$u+"})");$$.on("click",$Z,$o)}else $$[$b]="true"===$u||"false"!==$u&&$u},$D.getCompInstance=function($$){var $b,$u=$$.props?$$.props.runtime:null;return $b=$u?$D.viewClassMap[$u]||$D.uiClassMap[$u]||$e.__classmap[$u]:$D.uiClassMap[$$.type],$$.props&&$$.props.hasOwnProperty("renderType")&&"instance"==$$.props.renderType?$b.instance:$b?new $b:null},$D.regComponent=function($$,$b){$D.uiClassMap[$$]=$b,$L.regClass($$,$b)},$D.regViewRuntime=function($$,$b){$D.viewClassMap[$$]=$b},$D.uiMap={},$D.viewClassMap={},$D._sheet=null,$Z($D,["uiClassMap",function(){return this.uiClassMap={ViewStack:$$$,LinkButton:$k,TextArea:$H$,ColorPicker:$l,Box:$Y,Button:$k,CheckBox:$Q,Clip:$M,ComboBox:$X,Component:$v,HScrollBar:$j,HSlider:$d,Image:$n,Label:$c,List:$A,Panel:$h,ProgressBar:$J,Radio:$B,RadioGroup:$x$,ScrollBar:$s,Slider:$m,Tab:$g$,TextInput:$u$,View:$D,VScrollBar:$b$,VSlider:$Z$,Tree:$R,HBox:$r$,VBox:$F$,Sprite:$S,Animation:$u,Text:$P,FontClip:$G}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$D.__init$=function(){$D._regs(),$N=function(){function $$($$,$b,$u){this.comp=null,this.prop=null,this.value=null,this.comp=$$,this.prop=$b,this.value=$u}return $r($$,""),$$.prototype.exe=function($$){var $b=$K.getBindFun(this.value);this.comp[this.prop]=$b.call(this,$$)},$$}()},$D}()),$Q=function($$){function $u($$,$b){void 0===$b&&($b=""),$u.__super.call(this,$$,$b)}$r($u,"laya.ui.CheckBox",$$);var $b=$u.prototype;return $b.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$b.initialize=function(){$$.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$F(0,$b,"dataSource",$$.prototype._$get_dataSource,function($$){"boolean"==typeof(this._dataSource=$$)?this.selected=$$:"string"==typeof $$?this.selected="true"===$$:$e.superSet($k,this,"dataSource",$$)}),$u}($k),$W=function($$){function $b(){this._space=0,this._align="none",this._itemChanged=!1,$b.__super.call(this)}$r($b,"laya.ui.LayoutBox",$Y);var $u=$b.prototype;return $u.addChild=function($$){return $$.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$$)},$u.onResize=function($$){this._setItemChanged()},$u.addChildAt=function($$,$b){return $$.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$$,$b)},$u.removeChild=function($$){return $$.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$$)},$u.removeChildAt=function($$){return this.getChildAt($$).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$$)},$u.refresh=function(){this._setItemChanged()},$u.changeItems=function(){this._itemChanged=!1},$u.sortItem=function($$){$$&&$$.sort(function($$,$b){return $$.y-$b.y})},$u._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$F(0,$u,"space",function(){return this._space},function($$){this._space=$$,this._setItemChanged()}),$F(0,$u,"align",function(){return this._align},function($$){this._align=$$,this._setItemChanged()}),$b}(),$G=function($b){function $u($$,$b){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$u.__super.call(this),$$&&(this.skin=$$),$b&&(this.sheet=$b)}$r($u,"laya.ui.FontClip",$b);var $$=$u.prototype;return $$.createChildren=function(){this._bitmap=new $V,this.on("loaded",this,this._onClipLoaded)},$$._onClipLoaded=function(){this.callLater(this.changeValue)},$$.changeValue=function(){var $$;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$$=this._sources[0]))){var $b="horizontal"===this._direction;$b?(this._wordsW=this._valueArr.length*($$.sourceWidth+this.spaceX),this._wordsH=$$.sourceHeight):(this._wordsW=$$.sourceWidth,this._wordsH=($$.sourceHeight+this.spaceY)*this._valueArr.length);var $u=0;if(this._width)switch(this._align){case"center":$u=.5*(this._width-this._wordsW);break;case"right":$u=this._width-this._wordsW;break;default:$u=0}for(var $Z=0,$E=this._valueArr.length;$Z<$E;$Z++){var $r=this._indexMap[this._valueArr.charAt($Z)];this.sources[$r]&&($$=this.sources[$r],$b?this.graphics.drawTexture($$,$u+$Z*($$.sourceWidth+this.spaceX),0,$$.sourceWidth,$$.sourceHeight):this.graphics.drawTexture($$,0+$u,$Z*($$.sourceHeight+this.spaceY),$$.sourceWidth,$$.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$$.destroy=function($$){void 0===$$&&($$=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$b.prototype.destroy.call(this,$$)},$F(0,$$,"sheet",function(){return this._sheet},function($$){$$+="";var $b=(this._sheet=$$).split(" ");this._clipX=String($b[0]).length,this.clipY=$b.length,this._indexMap={};for(var $u=0;$u<this._clipY;$u++)for(var $Z=$b[$u].split(""),$E=0,$r=$Z.length;$E<$r;$E++)this._indexMap[$Z[$E]]=$u*this._clipX+$E}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($M,this,"height",$$),this.callLater(this.changeValue)}),$F(0,$$,"direction",function(){return this._direction},function($$){this._direction=$$,this.callLater(this.changeValue)}),$F(0,$$,"value",function(){return this._valueArr?this._valueArr:""},function($$){$$+="",this._valueArr=$$,this.callLater(this.changeValue)}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($M,this,"width",$$),this.callLater(this.changeValue)}),$F(0,$$,"spaceX",function(){return this._spaceX},function($$){this._spaceX=$$,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$F(0,$$,"spaceY",function(){return this._spaceY},function($$){this._spaceY=$$,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$F(0,$$,"align",function(){return this._align},function($$){this._align=$$,this.callLater(this.changeValue)}),$F(0,$$,"measureWidth",function(){return this._wordsW}),$F(0,$$,"measureHeight",function(){return this._wordsH}),$u}($M),$A=function($$){function $b(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $D,$b.__super.call(this)}$r($b,"laya.ui.List",$$);var $u=$b.prototype;return $e.imps($u,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$u.destroy=function($$){void 0===$$&&($$=!0),this._content&&this._content.destroy($$),this._scrollBar&&this._scrollBar.destroy($$),laya.ui.Component.prototype.destroy.call(this,$$),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},$u.createChildren=function(){this.addChild(this._content=new $Y)},$u.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$e.superGet($Y,this,"cacheAs")),$e.superSet($Y,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$u.onScrollEnd=function(){$e.superSet($Y,this,"cacheAs",this._$P.cacheAs)},$u._removePreScrollBar=function(){var $$=this.removeChildByName("scrollBar");$$&&$$.destroy(!0)},$u.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $$=this._getOneCell(),$b=$$.width+this._spaceX||1,$u=$$.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$b):Math.ceil(this._width/$b)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$u):Math.round(this._height/$u));var $Z=this._width?this._width:$b*this.repeatX-this._spaceX,$E=this._height?this._height:$u*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$u:$b,this._cellOffset=this._isVertical?$u*Math.max(this._repeatY2,this._repeatY)-$E-this._spaceY:$b*Math.max(this._repeatX2,this._repeatX)-$Z-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$E:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$Z),this.setContentSize($Z,$E);var $r=this._isVertical?this.repeatX:this.repeatY,$F=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$r,$F),this._createdLine=$F,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$u._getOneCell=function(){if(0===this._cells.length){var $$=this.createItem();if(this._offset.setTo($$.x,$$.y),this.cacheContent)return $$;this._cells.push($$)}return this._cells[0]},$u._createItems=function($$,$b,$u){var $Z=this._content,$E=this._getOneCell(),$r=$E.width+this._spaceX,$F=$E.height+this._spaceY;if(this.cacheContent){var $x=new $Y;$x.cacheAsBitmap=!0,$x.pos((this._isVertical?0:$$)*$r,(this._isVertical?$$:0)*$F),this._content.addChild($x),this._content.optimizeScrollRect=!0,$Z=$x}else{for(var $g=[],$H=this._cells.length-1;-1<$H;$H--){var $w=this._cells[$H];$w.removeSelf(),$g.push($w)}this._cells.length=0}for(var $I=$$;$I<$u;$I++)for(var $o=0;$o<$b;$o++)($E=$g&&$g.length?$g.pop():this.createItem()).x=(this._isVertical?$o:$I)*$r-$Z.x,$E.y=(this._isVertical?$I:$o)*$F-$Z.y,$E.name="item"+($I*$b+$o),$Z.addChild($E),this.addCell($E)},$u.createItem=function(){var $$=[];if("function"==typeof this._itemRender)var $b=new this._itemRender;else $b=$f.createComp(this._itemRender,null,null,$$);if(0==$$.length&&$b._watchMap){var $u=$b._watchMap;for(var $Z in $u)for(var $E=$u[$Z],$r=0;$r<$E.length;$r++){var $F=$E[$r];$$.push($F.comp,$F.prop,$F.value)}}return $$.length&&($b._$bindData=$$),$b},$u.addCell=function($$){$$.on("click",this,this.onCellMouse),$$.on("rightclick",this,this.onCellMouse),$$.on("mouseover",this,this.onCellMouse),$$.on("mouseout",this,this.onCellMouse),$$.on("mousedown",this,this.onCellMouse),$$.on("mouseup",this,this.onCellMouse),this._cells.push($$)},$u.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $$=0,$b=$$=0;$b<1e4;$b++){var $u=this.getChildByName("item"+$b);if(!$u)break;this.addCell($u),$$++}this.repeatY=$$}},$u.setContentSize=function($$,$b){this._content.width=$$,this._content.height=$b,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $T),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$$,$b),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$u.onCellMouse=function($$){"mousedown"===$$.type&&(this._isMoved=!1);var $b=$$.currentTarget,$u=this._startIndex+this._cells.indexOf($b);$u<0||("click"===$$.type||"rightclick"===$$.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$u:this.changeCellState($b,!0,0):"mouseover"!==$$.type&&"mouseout"!==$$.type||this._selectedIndex===$u||this.changeCellState($b,"mouseover"===$$.type,0),this.mouseHandler&&this.mouseHandler.runWith([$$,$u]))},$u.changeCellState=function($$,$b,$u){var $Z=$$.getChildByName("selectBox");$Z&&(this.selectEnable=!0,$Z.visible=$b,$Z.index=$u)},$u.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$u.onScrollBarChange=function($$){this.runCallLater(this.changeCells);var $b=this._scrollBar.value,$u=this._isVertical?this.repeatX:this.repeatY,$Z=this._isVertical?this.repeatY:this.repeatX,$E=Math.floor($b/this._cellSize);if(this.cacheContent)$F=$Z+1,this._createdLine-$E<$F&&(this._createItems(this._createdLine,$u,this._createdLine+$F),this.renderItems(this._createdLine*$u,0),this._createdLine+=$F);else{var $r=$E*$u,$F=0;if($r>this._startIndex){$F=$r-this._startIndex;var $x=!0,$g=this._startIndex+$u*($Z+1);this._isMoved=!0}else $r<this._startIndex&&($F=this._startIndex-$r,$x=!1,$g=this._startIndex-1,this._isMoved=!0);for(var $H=0;$H<$F;$H++){if($x){var $w=this._cells.shift();this._cells[this._cells.length]=$w;var $I=$g+$H}else $w=this._cells.pop(),this._cells.unshift($w),$I=$g-$H;var $o=Math.floor($I/$u)*this._cellSize;this._isVertical?$w.y=$o:$w.x=$o,this.renderItem($w,$I)}this._startIndex=$r,this.changeSelectStatus()}var $N=this._content.scrollRect;this._isVertical?($N.y=$b-this._offset.y,$N.x=-this._offset.x):($N.y=-this._offset.y,$N.x=$b-this._offset.x),this._content.scrollRect=$N},$u.posCell=function($$,$b){if(this._scrollBar){var $u=this._isVertical?this.repeatX:this.repeatY,$Z=(this._isVertical?this.repeatY:this.repeatX,Math.floor($b/$u)*this._cellSize);this._isVertical?$$.y=$Z:$$.x=$Z}},$u.changeSelectStatus=function(){for(var $$=0,$b=this._cells.length;$$<$b;$$++)this.changeCellState(this._cells[$$],this._selectedIndex===this._startIndex+$$,1)},$u.renderItems=function($$,$b){void 0===$$&&($$=0),void 0===$b&&($b=0);for(var $u=$$,$Z=$b||this._cells.length;$u<$Z;$u++)this.renderItem(this._cells[$u],this._startIndex+$u);this.changeSelectStatus(),this._twDone=!0},$u.renderItem=function($$,$b){this._array&&0<=$b&&$b<this._array.length?($$.visible=!0,$$._$bindData?($$._dataSource=this._array[$b],this._bindData($$,this._array[$b])):$$.dataSource=this._array[$b],this.cacheContent||this.posCell($$,$b),this.hasListener("render")&&this.event("render",[$$,$b]),this.renderHandler&&this.renderHandler.runWith([$$,$b]),this.renderTwHandler&&this.renderTwHandler.runWith([$$,$b])):($$.visible=!1,$$.dataSource=null)},$u._bindData=function($$,$b){for(var $u=$$._$bindData,$Z=0,$E=$u.length;$Z<$E;$Z++){var $r=$u[$Z++],$F=$u[$Z++],$x=$u[$Z],$g=$K.getBindFun($x);$r[$F]=$g.call(this,$b)}},$u.refresh=function(){this.array=this._array},$u.getItem=function($$){return-1<$$&&$$<this._array.length?this._array[$$]:null},$u.changeItem=function($$,$b){-1<$$&&$$<this._array.length&&(this._array[$$]=$b,$$>=this._startIndex&&$$<this._startIndex+this._cells.length&&this.renderItem(this.getCell($$),$$))},$u.setItem=function($$,$b){this.changeItem($$,$b)},$u.addItem=function($$){this._array.push($$),this.array=this._array},$u.addItemAt=function($$,$b){this._array.splice($b,0,$$),this.array=this._array},$u.deleteItem=function($$){this._array.splice($$,1),this.array=this._array},$u.getCell=function($$){return this.runCallLater(this.changeCells),-1<$$&&this._cells?this._cells[($$-this._startIndex)%this._cells.length]:null},$u.scrollTo=function($$){if(this._scrollBar){var $b=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($$/$b)*this._cellSize}else this.startIndex=$$},$u.tweenTo=function($$,$b,$u){if(void 0===$b&&($b=200),this._scrollBar){var $Z=this._isVertical?this.repeatX:this.repeatY;$z.to(this._scrollBar,{value:Math.floor($$/$Z)*this._cellSize},$b,null,$u,0,!0)}else this.startIndex=$$,$u&&$u.run()},$u._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$u.commitMeasure=function(){this.runCallLater(this.changeCells)},$F(0,$u,"cacheAs",$$.prototype._$get_cacheAs,function($$){$e.superSet($Y,this,"cacheAs",$$),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$$?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$F(0,$u,"content",function(){return this._content}),$F(0,$u,"height",$$.prototype._$get_height,function($$){$$!=this._height&&($e.superSet($Y,this,"height",$$),this._setCellChanged())}),$F(0,$u,"itemRender",function(){return this._itemRender},function($$){if(this._itemRender!=$$){this._itemRender=$$;for(var $b=this._cells.length-1;-1<$b;$b--)this._cells[$b].destroy();this._cells.length=0,this._setCellChanged()}}),$F(0,$u,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($$){this._removePreScrollBar();var $b=new $b$;$b.name="scrollBar",$b.right=0,$$&&" "!=$$&&($b.skin=$$),this.scrollBar=$b,this.addChild($b),this._setCellChanged()}),$F(0,$u,"page",function(){return this._page},function($$){this._page=$$,this._array&&(this._page=0<$$?$$:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$F(0,$u,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($$){this._removePreScrollBar();var $b=new $j;$b.name="scrollBar",$b.bottom=0,$$&&" "!=$$&&($b.skin=$$),this.scrollBar=$b,this.addChild($b),this._setCellChanged()}),$F(0,$u,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($$){this._repeatX=$$,this._setCellChanged()}),$F(0,$u,"scrollBar",function(){return this._scrollBar},function($$){this._scrollBar!=$$&&(this._scrollBar=$$)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$F(0,$u,"width",$$.prototype._$get_width,function($$){$$!=this._width&&($e.superSet($Y,this,"width",$$),this._setCellChanged())}),$F(0,$u,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($$){this._repeatY=$$,this._setCellChanged()}),$F(0,$u,"spaceX",function(){return this._spaceX},function($$){this._spaceX=$$,this._setCellChanged()}),$F(0,$u,"spaceY",function(){return this._spaceY},function($$){this._spaceY=$$,this._setCellChanged()}),$F(0,$u,"selectedIndex",function(){return this._selectedIndex},function($$){this._selectedIndex!=$$&&(this._selectedIndex=$$,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($$),this.startIndex=this._startIndex)}),$F(0,$u,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($$){this.selectedIndex=this._array.indexOf($$)}),$F(0,$u,"length",function(){return this._array?this._array.length:0}),$F(0,$u,"selection",function(){return this.getCell(this._selectedIndex)},function($$){this.selectedIndex=this._startIndex+this._cells.indexOf($$)}),$F(0,$u,"startIndex",function(){return this._startIndex},function($$){this._startIndex=0<$$?$$:0,this.callLater(this.renderItems)}),$F(0,$u,"twSwitch",function(){return this._twSwitch},function($$){this._twSwitch=$$}),$F(0,$u,"twDone",function(){return this._twDone},function($$){this._twDone=$$}),$F(0,$u,"array",function(){return this._array},function($$){this.runCallLater(this.changeCells),this._array=$$||[];var $b=this._array.length;if(this.totalPage=Math.ceil($b/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$b?this._selectedIndex:$b-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $u=this._isVertical?this.repeatX:this.repeatY,$Z=this._isVertical?this.repeatY:this.repeatX,$E=Math.ceil($b/$u);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$Z/$E,this._scrollBar.setScroll(0,($E-$Z)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$F(0,$u,"dataSource",$$.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)&&Math.floor($$)==$$||"string"==typeof $$?this.selectedIndex=parseInt($$):$$ instanceof Array?this.array=$$:$e.superSet($Y,this,"dataSource",$$)}),$F(0,$u,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$b}($Y),$j=function($$){function $b(){$b.__super.call(this)}return $r($b,"laya.ui.HScrollBar",$$),$b.prototype.initialize=function(){$$.prototype.initialize.call(this),this.slider.isVertical=!1},$b}($s),$h=function($$){function $b(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$b.__super.call(this),this.width=this.height=100}$r($b,"laya.ui.Panel",$$);var $u=$b.prototype;return $u.destroy=function($$){void 0===$$&&($$=!0),laya.ui.Component.prototype.destroy.call(this,$$),this._content&&this._content.destroy($$),this._vScrollBar&&this._vScrollBar.destroy($$),this._hScrollBar&&this._hScrollBar.destroy($$),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$u.destroyChildren=function(){this._content.destroyChildren()},$u.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $Y)},$u.addChild=function($$){return $$.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($$)},$u.onResize=function(){this._setScrollChanged()},$u.addChildAt=function($$,$b){return $$.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($$,$b)},$u.removeChild=function($$){return $$.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($$)},$u.removeChildAt=function($$){return this.getChildAt($$).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($$)},$u.removeChildren=function($$,$b){return void 0===$$&&($$=0),void 0===$b&&($b=2147483647),this._content.removeChildren($$,$b),this._setScrollChanged(),this},$u.getChildAt=function($$){return this._content.getChildAt($$)},$u.getChildByName=function($$){return this._content.getChildByName($$)},$u.getChildIndex=function($$){return this._content.getChildIndex($$)},$u.changeScroll=function(){this._scrollChanged=!1;var $$=this.contentWidth||1,$b=this.contentHeight||1,$u=this._vScrollBar,$Z=this._hScrollBar,$E=$u&&$b>this._height,$r=$Z&&$$>this._width,$F=$E?this._width-$u.width:this._width,$x=$r?this._height-$Z.height:this._height;$u&&($u.x=this._width-$u.width,$u.y=0,$u.height=this._height-($r?$Z.height:0),$u.scrollSize=Math.max(.033*this._height,1),$u.thumbPercent=$x/$b,$u.setScroll(0,$b-$x,$u.value)),$Z&&($Z.x=0,$Z.y=this._height-$Z.height,$Z.width=this._width-($E?$u.width:0),$Z.scrollSize=Math.max(.033*this._width,1),$Z.thumbPercent=$F/$$,$Z.setScroll(0,$$-$F,$Z.value))},$u.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$u.setContentSize=function($$,$b){var $u=this._content;$u.width=$$,$u.height=$b,$u.scrollRect||($u.scrollRect=new $T),$u.scrollRect.setTo(0,0,$$,$b),$u.scrollRect=$u.scrollRect},$u.onScrollBarChange=function($$){var $b=this._content.scrollRect;if($b){var $u=Math.round($$.value);$$.isVertical?$b.y=$u:$b.x=$u,this._content.scrollRect=$b}},$u.scrollTo=function($$,$b){void 0===$$&&($$=0),void 0===$b&&($b=0),this.vScrollBar&&(this.vScrollBar.value=$b),this.hScrollBar&&(this.hScrollBar.value=$$)},$u.refresh=function(){this.changeScroll()},$u.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$e.superGet($Y,this,"cacheAs")),$e.superSet($Y,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$u.onScrollEnd=function(){$e.superSet($Y,this,"cacheAs",this._$P.cacheAs)},$u._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$F(0,$u,"numChildren",function(){return this._content.numChildren}),$F(0,$u,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($$){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $j),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$$}),$F(0,$u,"contentWidth",function(){for(var $$=0,$b=this._content.numChildren-1;-1<$b;$b--){var $u=this._content.getChildAt($b);$$=Math.max($u.x+$u.width*$u.scaleX,$$)}return $$}),$F(0,$u,"contentHeight",function(){for(var $$=0,$b=this._content.numChildren-1;-1<$b;$b--){var $u=this._content.getChildAt($b);$$=Math.max($u.y+$u.height*$u.scaleY,$$)}return $$}),$F(0,$u,"width",$$.prototype._$get_width,function($$){$e.superSet($Y,this,"width",$$),this._setScrollChanged()}),$F(0,$u,"hScrollBar",function(){return this._hScrollBar}),$F(0,$u,"content",function(){return this._content}),$F(0,$u,"height",$$.prototype._$get_height,function($$){$e.superSet($Y,this,"height",$$),this._setScrollChanged()}),$F(0,$u,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($$){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $b$),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$$}),$F(0,$u,"vScrollBar",function(){return this._vScrollBar}),$F(0,$u,"cacheAs",$$.prototype._$get_cacheAs,function($$){$e.superSet($Y,this,"cacheAs",$$),this._$P.cacheAs=null,"none"!==$$?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$b}($Y),$d=function($$){function $b($$){$b.__super.call(this,$$),this.isVertical=!1}return $r($b,"laya.ui.HSlider",$m),$b}(),$U=function($$){function $u($$,$b){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$u.__super.call(this),this.skin=$b,this.labels=$$}$r($u,"laya.ui.UIGroup",$$);var $b=$u.prototype;return $e.imps($b,{"laya.ui.IItem":!0}),$b.preinitialize=function(){this.mouseEnabled=!0},$b.destroy=function($$){void 0===$$&&($$=!0),laya.ui.Component.prototype.destroy.call(this,$$),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$b.addItem=function($$,$b){void 0===$b&&($b=!0);var $u=$$,$Z=this._items.length;if($u.name="item"+$Z,this.addChild($u),this.initItems(),$b&&0<$Z){var $E=this._items[$Z-1];"horizontal"==this._direction?$u.x=$E.x+$E.width+this._space:$u.y=$E.y+$E.height+this._space}else $b&&($u.x=0,$u.y=0);return $Z},$b.delItem=function($$,$b){void 0===$b&&($b=!0);var $u=this._items.indexOf($$);if(-1!=$u){var $Z=$$;this.removeChild($Z);for(var $E=$u+1,$r=this._items.length;$E<$r;$E++){var $F=this._items[$E];$F.name="item"+($E-1),$b&&("horizontal"==this._direction?$F.x-=$Z.width+this._space:$F.y-=$Z.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $x;$x=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$x}}},$b.initItems=function(){this._items||(this._items=[]);for(var $$=this._items.length=0;$$<1e4;$$++){var $b=this.getChildByName("item"+$$);if(null==$b)break;this._items.push($b),$b.selected=$$===this._selectedIndex,$b.clickHandler=$o.create(this,this.itemClick,[$$],!1)}},$b.itemClick=function($$){this.selectedIndex=$$},$b.setSelect=function($$,$b){this._items&&-1<$$&&$$<this._items.length&&(this._items[$$].selected=$b)},$b.createItem=function($$,$b){return null},$b.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $$=0,$b=0,$u=this._items.length;$b<$u;$b++){var $Z=this._items[$b];this._skin&&($Z.skin=this._skin),this._labelColors&&($Z.labelColors=this._labelColors),this._labelSize&&($Z.labelSize=this._labelSize),this._labelStroke&&($Z.labelStroke=this._labelStroke),this._labelStrokeColor&&($Z.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($Z.strokeColors=this._strokeColors),this._labelBold&&($Z.labelBold=this._labelBold),this._labelPadding&&($Z.labelPadding=this._labelPadding),this._labelAlign&&($Z.labelAlign=this._labelAlign),this._stateNum&&($Z.stateNum=this._stateNum),this._labelFont&&($Z.labelFont=this._labelFont),"horizontal"===this._direction?($Z.y=0,$Z.x=$$,$$+=$Z.width+this._space):($Z.x=0,$Z.y=$$,$$+=$Z.height+this._space)}this.changeSize()},$b.commitMeasure=function(){this.runCallLater(this.changeLabels)},$b._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$F(0,$b,"labelStrokeColor",function(){return this._labelStrokeColor},function($$){this._labelStrokeColor!=$$&&(this._labelStrokeColor=$$,this._setLabelChanged())}),$F(0,$b,"skin",function(){return this._skin},function($$){this._skin!=$$&&(this._skin=$$,this._setLabelChanged())}),$F(0,$b,"selectedIndex",function(){return this._selectedIndex},function($$){this._selectedIndex!=$$&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$$,this.setSelect($$,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$F(0,$b,"labels",function(){return this._labels},function($$){if(this._labels!=$$){if(this._labels=$$,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $b=this._labels.split(","),$u=0,$Z=$b.length;$u<$Z;$u++){var $E=this.createItem(this._skin,$b[$u]);$E.name="item"+$u,this.addChild($E)}this.initItems()}}),$F(0,$b,"strokeColors",function(){return this._strokeColors},function($$){this._strokeColors!=$$&&(this._strokeColors=$$,this._setLabelChanged())}),$F(0,$b,"labelColors",function(){return this._labelColors},function($$){this._labelColors!=$$&&(this._labelColors=$$,this._setLabelChanged())}),$F(0,$b,"labelStroke",function(){return this._labelStroke},function($$){this._labelStroke!=$$&&(this._labelStroke=$$,this._setLabelChanged())}),$F(0,$b,"labelSize",function(){return this._labelSize},function($$){this._labelSize!=$$&&(this._labelSize=$$,this._setLabelChanged())}),$F(0,$b,"stateNum",function(){return this._stateNum},function($$){this._stateNum!=$$&&(this._stateNum=$$,this._setLabelChanged())}),$F(0,$b,"labelBold",function(){return this._labelBold},function($$){this._labelBold!=$$&&(this._labelBold=$$,this._setLabelChanged())}),$F(0,$b,"labelFont",function(){return this._labelFont},function($$){this._labelFont!=$$&&(this._labelFont=$$,this._setLabelChanged())}),$F(0,$b,"labelPadding",function(){return this._labelPadding},function($$){this._labelPadding!=$$&&(this._labelPadding=$$,this._setLabelChanged())}),$F(0,$b,"direction",function(){return this._direction},function($$){this._direction=$$,this._setLabelChanged()}),$F(0,$b,"space",function(){return this._space},function($$){this._space=$$,this._setLabelChanged()}),$F(0,$b,"items",function(){return this._items}),$F(0,$b,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($$){this.selectedIndex=this._items.indexOf($$)}),$F(0,$b,"dataSource",$$.prototype._$get_dataSource,function($$){"number"==typeof(this._dataSource=$$)&&Math.floor($$)==$$||"string"==typeof $$?this.selectedIndex=parseInt($$):$$ instanceof Array?this.labels=$$.join(","):$e.superSet($Y,this,"dataSource",$$)}),$u}($Y),$B=function($b){function $u($$,$b){this._value=null,void 0===$b&&($b=""),$u.__super.call(this,$$,$b)}$r($u,"laya.ui.Radio",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._value=null},$$.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$$.initialize=function(){$b.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$$.onClick=function($$){this.selected=!0},$F(0,$$,"value",function(){return null!=this._value?this._value:this.label},function($$){this._value=$$}),$u}($k),$R=function($$){function $b(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$b.__super.call(this),this.width=this.height=200}$r($b,"laya.ui.Tree",$$);var $u=$b.prototype;return $e.imps($u,{"laya.ui.IRender":!0}),$u.destroy=function($$){void 0===$$&&($$=!0),laya.ui.Component.prototype.destroy.call(this,$$),this._list&&this._list.destroy($$),this._list=null,this._source=null,this._renderHandler=null},$u.createChildren=function(){this.addChild(this._list=new $A),this._list.renderHandler=$o.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$u.onListChange=function($$){this.event("change")},$u.getArray=function(){var $$,$b=[];for(var $u in this._source)$$=this._source[$u],this.getParentOpenStatus($$)&&($$.x=this._spaceLeft*this.getDepth($$),$b.push($$));return $b},$u.getDepth=function($$,$b){return void 0===$b&&($b=0),null==$$.nodeParent?$b:this.getDepth($$.nodeParent,$b+1)},$u.getParentOpenStatus=function($$){var $b=$$.nodeParent;return null==$b||!!$b.isOpen&&(null==$b.nodeParent||this.getParentOpenStatus($b))},$u.renderItem=function($$,$b){var $u=$$.dataSource;if($u){$$.left=$u.x;var $Z=$$.getChildByName("arrow");$Z&&($u.hasChild?($Z.visible=!0,$Z.index=$u.isOpen?1:0,$Z.tag=$b,$Z.off("click",this,this.onArrowClick),$Z.on("click",this,this.onArrowClick)):$Z.visible=!1);var $E=$$.getChildByName("folder");$E&&(2==$E.clipY?$E.index=$u.isDirectory?0:1:$E.index=$u.isDirectory?$u.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$$,$b])}},$u.onArrowClick=function($$){var $b=$$.currentTarget.tag;this._list.array[$b].isOpen=!this._list.array[$b].isOpen,this.event("open"),this._list.array=this.getArray()},$u.setItemState=function($$,$b){this._list.array[$$]&&(this._list.array[$$].isOpen=$b,this._list.array=this.getArray())},$u.fresh=function(){this._list.array=this.getArray(),this.repaint()},$u.parseXml=function($$,$b,$u,$Z){var $E,$r=$$.childNodes,$F=$r.length;if(!$Z){$E={};var $x,$g=$$.attributes;for(var $H in $g){var $w=($x=$g[$H]).nodeName,$I=$x.nodeValue;$E[$w]="true"==$I||"false"!=$I&&$I}$E.nodeParent=$u,0<$F&&($E.isDirectory=!0),$E.hasChild=0<$F,$b.push($E)}for(var $o=0;$o<$F;$o++){var $N=$r[$o];this.parseXml($N,$b,$E,!1)}},$u.parseOpenStatus=function($$,$b){for(var $u=0,$Z=$b.length;$u<$Z;$u++){var $E=$b[$u];if($E.isDirectory)for(var $r=0,$F=$$.length;$r<$F;$r++){var $x=$$[$r];if($x.isDirectory&&this.isSameParent($x,$E)&&$E.label==$x.label){$E.isOpen=$x.isOpen;break}}}},$u.isSameParent=function($$,$b){return null==$$.nodeParent&&null==$b.nodeParent||null!=$$.nodeParent&&null!=$b.nodeParent&&($$.nodeParent.label==$b.nodeParent.label&&this.isSameParent($$.nodeParent,$b.nodeParent))},$u.filter=function($$){if(Boolean($$)){var $b=[];this.getFilterSource(this._source,$b,$$),this._list.array=$b}else this._list.array=this.getArray()},$u.getFilterSource=function($$,$b,$u){var $Z;for(var $E in $u=$u.toLocaleLowerCase(),$$)!($Z=$$[$E]).isDirectory&&-1<String($Z.label).toLowerCase().indexOf($u)&&($Z.x=0,$b.push($Z)),$Z.child&&0<$Z.child.length&&this.getFilterSource($Z.child,$b,$u)},$F(0,$u,"spaceBottom",function(){return this._list.spaceY},function($$){this._list.spaceY=$$}),$F(0,$u,"keepStatus",function(){return this._keepStatus},function($$){this._keepStatus=$$}),$F(0,$u,"itemRender",function(){return this._list.itemRender},function($$){this._list.itemRender=$$}),$F(0,$u,"array",function(){return this._list.array},function($$){this._keepStatus&&this._list.array&&$$&&this.parseOpenStatus(this._list.array,$$),this._source=$$,this._list.array=this.getArray()}),$F(0,$u,"mouseHandler",function(){return this._list.mouseHandler},function($$){this._list.mouseHandler=$$}),$F(0,$u,"dataSource",$$.prototype._$get_dataSource,function($$){this._dataSource=$$,$e.superSet($Y,this,"dataSource",$$)}),$F(0,$u,"source",function(){return this._source}),$F(0,$u,"scrollBar",function(){return this._list.scrollBar}),$F(0,$u,"list",function(){return this._list}),$F(0,$u,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($$){this._list.vScrollBarSkin=$$}),$F(0,$u,"renderHandler",function(){return this._renderHandler},function($$){this._renderHandler=$$}),$F(0,$u,"selectedIndex",function(){return this._list.selectedIndex},function($$){this._list.selectedIndex=$$}),$F(0,$u,"spaceLeft",function(){return this._spaceLeft},function($$){this._spaceLeft=$$}),$F(0,$u,"selectedItem",function(){return this._list.selectedItem},function($$){this._list.selectedItem=$$}),$F(0,$u,"width",$$.prototype._$get_width,function($$){$e.superSet($Y,this,"width",$$),this._list.width=$$}),$F(0,$u,"height",$$.prototype._$get_height,function($$){$e.superSet($Y,this,"height",$$),this._list.height=$$}),$F(0,$u,"xml",null,function($$){var $b=[];this.parseXml($$.childNodes[0],$b,null,!0),this.array=$b}),$F(0,$u,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$b}($Y),$$$=function($$){function $b(){this._items=null,this._selectedIndex=0,$b.__super.call(this),this._setIndexHandler=$o.create(this,this.setIndex,null,!1)}$r($b,"laya.ui.ViewStack",$$);var $u=$b.prototype;return $e.imps($u,{"laya.ui.IItem":!0}),$u.setItems=function($$){this.removeChildren();for(var $b=0,$u=0,$Z=$$.length;$u<$Z;$u++){var $E=$$[$u];$E&&($E.name="item"+$b,this.addChild($E),$b++)}this.initItems()},$u.addItem=function($$){$$.name="item"+this._items.length,this.addChild($$),this.initItems()},$u.initItems=function(){this._items=[];for(var $$=0;$$<1e4;$$++){var $b=this.getChildByName("item"+$$);if(null==$b)break;this._items.push($b),$b.visible=$$==this._selectedIndex}},$u.setSelect=function($$,$b){this._items&&-1<$$&&$$<this._items.length&&(this._items[$$].visible=$b)},$u.setIndex=function($$){this.selectedIndex=$$},$F(0,$u,"dataSource",$$.prototype._$get_dataSource,function($$){if("number"==typeof(this._dataSource=$$)&&Math.floor($$)==$$||"string"==typeof $$)this.selectedIndex=parseInt($$);else for(var $b in this._dataSource)this.hasOwnProperty($b)&&(this[$b]=this._dataSource[$b])}),$F(0,$u,"selectedIndex",function(){return this._selectedIndex},function($$){this._selectedIndex!=$$&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$$,this.setSelect(this._selectedIndex,!0))}),$F(0,$u,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($$){this.selectedIndex=this._items.indexOf($$)}),$F(0,$u,"items",function(){return this._items}),$F(0,$u,"setIndexHandler",function(){return this._setIndexHandler},function($$){this._setIndexHandler=$$}),$b}($Y),$b$=function($$){function $b(){$b.__super.call(this)}return $r($b,"laya.ui.VScrollBar",$s),$b}(),$u$=function($b){function $u($$){this._bg=null,this._skin=null,$u.__super.call(this),void 0===$$&&($$=""),this.text=$$,this.skin=this.skin}$r($u,"laya.ui.TextInput",$b);var $$=$u.prototype;return $$.preinitialize=function(){this.mouseEnabled=!0},$$.destroy=function($$){$_.clearCache(this,this._skin),void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._bg&&this._bg.destroy(),this._bg=null},$$.createChildren=function(){this.addChild(this._tf=new $N),this._tf.padding=$C.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$$._onFocus=function(){this.event("focus",this)},$$._onBlur=function(){this.event("blur",this)},$$._onInput=function(){this.event("input",this)},$$._onEnter=function(){this.event("enter",this)},$$.initialize=function(){this.width=128,this.height=22},$$.select=function(){this._tf.select()},$$.setSelection=function($$,$b){this._tf.setSelection($$,$b)},$F(0,$$,"text",$b.prototype._$get_text,function($$){this._tf.text!=$$&&($$+="",this._tf.text=$$,this.event("change"))}),$F(0,$$,"bg",function(){return this._bg},function($$){this.graphics=this._bg=$$}),$F(0,$$,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($$){this._tf.inputElementYAdjuster=$$}),$F(0,$$,"multiline",function(){return this._tf.multiline},function($$){this._tf.multiline=$$}),$F(0,$$,"skin",function(){return this._skin},function($$){this._skin!=$$&&($_.clearCache(this,this._skin),this._skin=$$,this._bg||(this.graphics=this._bg=new $V),$_.keepCache(this,this._skin),this._bg.source=$_.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$F(0,$$,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($$){this._bg||(this.graphics=this._bg=new $V),this._bg.sizeGrid=$K.fillArray($C.defaultSizeGrid,$$,Number)}),$F(0,$$,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($$){this._tf.inputElementXAdjuster=$$}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($c,this,"width",$$),this._bg&&(this._bg.width=$$)}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($c,this,"height",$$),this._bg&&(this._bg.height=$$)}),$F(0,$$,"editable",function(){return this._tf.editable},function($$){this._tf.editable=$$}),$F(0,$$,"restrict",function(){return this._tf.restrict},function($$){this._tf.restrict=$$}),$F(0,$$,"prompt",function(){return this._tf.prompt},function($$){this._tf.prompt=$$}),$F(0,$$,"promptColor",function(){return this._tf.promptColor},function($$){this._tf.promptColor=$$}),$F(0,$$,"maxChars",function(){return this._tf.maxChars},function($$){this._tf.maxChars=$$}),$F(0,$$,"focus",function(){return this._tf.focus},function($$){this._tf.focus=$$}),$F(0,$$,"type",function(){return this._tf.type},function($$){this._tf.type=$$}),$F(0,$$,"asPassword",function(){return this._tf.asPassword},function($$){this._tf.asPassword=$$}),$u}($c),$Z$=function($$){function $b(){$b.__super.call(this)}return $r($b,"laya.ui.VSlider",$m),$b}(),$E$=function($$){function $Z(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$Z.__super.call(this)}$r($Z,"laya.ui.Dialog",$$);var $b=$Z.prototype;return $b.initialize=function(){this.popupEffect=$Z.manager.popupEffectHandler,this.closeEffect=$Z.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$b._dealDragArea=function(){var $$=this.getChildByName("drag");$$&&(this.dragArea=$$.x+","+$$.y+","+$$.width+","+$$.height,$$.removeSelf())},$b._onClick=function($$){var $b=$$.target;if($b)switch($b.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($b.name)}},$b.show=function($$,$b){void 0===$$&&($$=!1),void 0===$b&&($b=!0),this._open(!1,$$,$b)},$b.popup=function($$,$b){void 0===$$&&($$=!1),void 0===$b&&($b=!0),this._open(!0,$$,$b)},$b._open=function($$,$b,$u){$Z.manager.lock(!1),this.isModal=$$,$Z.manager.open(this,$b,$u)},$b.onOpened=function(){},$b.close=function($$,$b){void 0===$b&&($b=!0),$Z.manager.close(this,$$,$b)},$b.onClosed=function($$){},$b._onMouseDown=function($$){var $b=this.getMousePoint();this._dragArea.contains($b.x,$b.y)?this.startDrag():this.stopDrag()},$F(0,$b,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($$){if($$){var $b=$K.fillArray([0,0,0,0],$$,Number);this._dragArea=new $T($b[0],$b[1],$b[2],$b[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$F(0,$b,"isPopup",function(){return null!=this.parent}),$F(0,$b,"zOrder",$$.prototype._$get_zOrder,function($$){$e.superSet($f,this,"zOrder",$$),$Z.manager._checkMask()}),$F(1,$Z,"manager",function(){return $Z._manager=$Z._manager||new $p},function($$){$Z._manager=$$}),$Z.setLockView=function($$){$Z.manager.setLockView($$)},$Z.lock=function($$){$Z.manager.lock($$)},$Z.closeAll=function(){$Z.manager.closeAll()},$Z.getDialogsByGroup=function($$){return $Z.manager.getDialogsByGroup($$)},$Z.closeByGroup=function($$){return $Z.manager.closeByGroup($$)},$Z.CLOSE="close",$Z.CANCEL="cancel",$Z.SURE="sure",$Z.NO="no",$Z.OK="ok",$Z.YES="yes",$Z._manager=null,$Z}($f),$r$=function($$){function $b(){$b.__super.call(this)}$r($b,"laya.ui.HBox",$$);var $u=$b.prototype;return $u.sortItem=function($$){$$&&$$.sort(function($$,$b){return $$.x-$b.x})},$u.changeItems=function(){this._itemChanged=!1;for(var $$=[],$b=0,$u=0,$Z=this.numChildren;$u<$Z;$u++){var $E=this.getChildAt($u);$E&&$E.layoutEnabled&&($$.push($E),$b=this._height?this._height:Math.max($b,$E.height*$E.scaleY))}this.sortItem($$);var $r=0;for($u=0,$Z=$$.length;$u<$Z;$u++)($E=$$[$u]).x=$r,$r+=$E.width*$E.scaleX+this._space,"top"==this._align?$E.y=0:"middle"==this._align?$E.y=.5*($b-$E.height*$E.scaleY):"bottom"==this._align&&($E.y=$b-$E.height*$E.scaleY);this.changeSize()},$F(0,$u,"height",$$.prototype._$get_height,function($$){this._height!=$$&&($e.superSet($W,this,"height",$$),this.callLater(this.changeItems))}),$b.NONE="none",$b.TOP="top",$b.MIDDLE="middle",$b.BOTTOM="bottom",$b}($W),$F$=function($$){function $b(){$b.__super.call(this)}$r($b,"laya.ui.VBox",$$);var $u=$b.prototype;return $u.changeItems=function(){this._itemChanged=!1;for(var $$=[],$b=0,$u=0,$Z=this.numChildren;$u<$Z;$u++){var $E=this.getChildAt($u);$E&&$E.layoutEnabled&&($$.push($E),$b=this._width?this._width:Math.max($b,$E.width*$E.scaleX))}this.sortItem($$);var $r=0;for($u=0,$Z=$$.length;$u<$Z;$u++)($E=$$[$u]).y=$r,$r+=$E.height*$E.scaleY+this._space,"left"==this._align?$E.x=0:"center"==this._align?$E.x=.5*($b-$E.width*$E.scaleX):"right"==this._align&&($E.x=$b-$E.width*$E.scaleX);this.changeSize()},$F(0,$u,"width",$$.prototype._$get_width,function($$){this._width!=$$&&($e.superSet($W,this,"width",$$),this.callLater(this.changeItems))}),$b.NONE="none",$b.LEFT="left",$b.CENTER="center",$b.RIGHT="right",$b}($W),$x$=function($$){function $b(){$b.__super.call(this)}return $r($b,"laya.ui.RadioGroup",$U),$b.prototype.createItem=function($$,$b){return new $B($$,$b)},$b}(),$g$=function($$){function $b(){$b.__super.call(this)}return $r($b,"laya.ui.Tab",$U),$b.prototype.createItem=function($$,$b){return new $k($$,$b)},$b}(),$H$=function($b){function $u($$){this._vScrollBar=null,this._hScrollBar=null,void 0===$$&&($$=""),$u.__super.call(this,$$)}$r($u,"laya.ui.TextArea",$b);var $$=$u.prototype;return $$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$$.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$$.onVBarChanged=function($$){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$$.onHBarChanged=function($$){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$$.changeScroll=function(){var $$=this._vScrollBar&&0<this._tf.maxScrollY,$b=this._hScrollBar&&0<this._tf.maxScrollX,$u=$$?this._width-this._vScrollBar.width:this._width,$Z=$b?this._height-this._hScrollBar.height:this._height,$E=this._tf.padding||$C.labelPadding;this._tf.width=$u,this._tf.height=$Z,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$E[2],this._vScrollBar.y=$E[1],this._vScrollBar.height=this._height-($b?this._hScrollBar.height:0)-$E[1]-$E[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$Z/Math.max(this._tf.textHeight,$Z),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$$),this._hScrollBar&&(this._hScrollBar.x=$E[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$E[3],this._hScrollBar.width=this._width-($$?this._vScrollBar.width:0)-$E[0]-$E[2],this._hScrollBar.scrollSize=Math.max(.033*$u,1),this._hScrollBar.thumbPercent=$u/Math.max(this._tf.textWidth,$u),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$b)},$$.scrollTo=function($$){this.commitMeasure(),this._tf.scrollY=$$},$F(0,$$,"scrollY",function(){return this._tf.scrollY}),$F(0,$$,"width",$b.prototype._$get_width,function($$){$e.superSet($u$,this,"width",$$),this.callLater(this.changeScroll)}),$F(0,$$,"hScrollBar",function(){return this._hScrollBar}),$F(0,$$,"height",$b.prototype._$get_height,function($$){$e.superSet($u$,this,"height",$$),this.callLater(this.changeScroll)}),$F(0,$$,"maxScrollX",function(){return this._tf.maxScrollX}),$F(0,$$,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($$){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $b$),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$$}),$F(0,$$,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($$){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $j),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$$}),$F(0,$$,"vScrollBar",function(){return this._vScrollBar}),$F(0,$$,"maxScrollY",function(){return this._tf.maxScrollY}),$F(0,$$,"scrollX",function(){return this._tf.scrollX}),$u}($u$);!function($$){function $b(){this._uiView=null,this.isCloseOther=!1,$b.__super.call(this)}$r($b,"laya.ui.AsynDialog",$E$);var $u=$b.prototype;$u.createView=function($$){this._uiView=$$},$u._open=function($$,$b,$u){this.isModal=$$,this.isCloseOther=$b,$E$.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$u.onCreated=function(){this.createUI(),this.onOpen()},$u.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$u.onOpen=function(){$E$.manager.open(this,this.isCloseOther),$E$.manager.lock(!1)},$u.close=function($$,$b){void 0===$b&&($b=!0),$E$.manager.close(this),this.onClose()},$u.onClose=function(){},$u.destroy=function($$){void 0===$$&&($$=!0),laya.ui.View.prototype.destroy.call(this,$$),this._uiView=null,this.onDestroy()},$u.onDestroy=function(){}}();$e.__init([$f])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($$,$b){"use strict";for(var $u in Object.defineProperty($b,"__esModule",{value:!0}),Laya){var $Z=Laya[$u];$Z&&$Z.__isclass&&($b[$u]=$Z)}}),function($o,$$,$P){$P.un,$P.uns;var $I=$P.static,$N=$P.class,$D=$P.getset,$Z=$P.__newvec,$S=laya.maths.Arith,$F=laya.webgl.atlas.AtlasResourceManager,$u=laya.webgl.shader.BaseShader,$v=laya.utils.Browser,$x=laya.webgl.utils.Buffer,$i=laya.utils.Byte,$E=laya.utils.ClassUtils,$g=$P.Config,$r=(laya.events.Event,laya.events.EventDispatcher),$C=laya.utils.Handler,$T=laya.net.Loader,$b=laya.net.LoaderManager,$H=(laya.maths.MathUtil,laya.display.Node),$e=laya.renders.Render,$w=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$L=laya.resource.Resource,$_=laya.utils.RunDriver,$y=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$z=laya.display.Sprite,$q=laya.utils.Stat,$a=laya.utils.StringKey,$K=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$t=laya.utils.Utils,$O=laya.webgl.WebGL,$V=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$P.interface("laya.d3.core.IClone"),$P.interface("laya.d3.graphics.IVertex"),$P.interface("laya.d3.core.render.IUpdate"),$P.interface("laya.d3.core.scene.ITreeNode"),$P.interface("laya.d3.core.render.IRenderable");(function(){function $k(){}$N($k,"laya.d3.animation.AnimationClipParser01"),$k.READ_DATA=function(){$k._DATA.offset=$k._reader.getUint32(),$k._DATA.size=$k._reader.getUint32()},$k.READ_BLOCK=function(){for(var $$=$k._BLOCK.count=$k._reader.getUint16(),$b=$k._BLOCK.blockStarts=[],$u=$k._BLOCK.blockLengths=[],$Z=0;$Z<$$;$Z++)$b.push($k._reader.getUint32()),$u.push($k._reader.getUint32())},$k.READ_STRINGS=function(){var $$=$k._reader.getUint32(),$b=$k._reader.getUint16(),$u=$k._reader.pos;$k._reader.pos=$$+$k._DATA.offset;for(var $Z=0;$Z<$b;$Z++)$k._strings[$Z]=$k._reader.readUTFString();$k._reader.pos=$u},$k.parse=function($$,$b){$k._animationClip=$$;($k._reader=$b).__getBuffer();$k.READ_DATA(),$k.READ_BLOCK(),$k.READ_STRINGS();for(var $u=0,$Z=$k._BLOCK.count;$u<$Z;$u++){var $E=$b.getUint16(),$r=$k._strings[$E],$F=$k["READ_"+$r];if(null==$F)throw new Error("model file err,no this function:"+$E+" "+$r);$F.call()}},$k.READ_ANIMATIONS=function(){var $$,$b=0,$u=0,$Z=$k._reader,$E=$Z.__getBuffer(),$r=[],$F=$Z.getUint8();for($r.length=$F,$b=0;$b<$F;$b++)$r[$b]=$Z.getUint16();var $x=[],$g=$Z.getUint16();for($x.length=$g,$b=0;$b<$g;$b++)$x[$b]=$Z.getFloat32();var $H=$k._animationClip;$H.name=$k._strings[$Z.getUint16()];var $w=$H._duration=$Z.getFloat32();$H.islooping=!!$Z.getByte(),$H._frameRate=$Z.getInt16();var $I=$Z.getInt16(),$o=$H._nodes=new Array;$o.length=$I,($H._publicClipDatas=[]).length=$I;var $N=$H._nodesMap={},$D=0,$e=0;for($b=0;$b<$I;$b++){$$=$o[$b]=new $J;var $L=$Z.getUint16(),$T=$$.path=[];for($T.length=$L,$u=0;$u<$L;$u++)$T[$u]=$k._strings[$Z.getUint16()];var $_=$T.join("/"),$y=$N[$_];$y||($N[$_]=$y=[]),$y.push($$);var $S=$Z.getInt16();-1!==$S&&($$.componentType=$k._strings[$S]);var $P=$n._propertyIndexDic[$k._strings[$Z.getUint16()]];if(null==$P)throw new Error("AnimationClipParser01:unknown property name.");var $i=$P<4,$z=!$i||$i&&""===$T[0];($$._cacheProperty=$z)?$D++:$e++,$$.propertyNameID=$P;var $q=$r[$Z.getUint8()];$$.keyFrameWidth=$q/4;var $a=$$.keyFrames=[],$t=$a.length=$Z.getUint16(),$C=null,$K=NaN;for($u=0;$u<$t;$u++){var $O=$a[$u]=new $c;$K=$O.startTime=$x[$Z.getUint16()];var $V=$Z.pos;$O.inTangent=new Float32Array($E.slice($V,$V+$q)),$Z.pos+=$q,$V=$Z.pos,$O.outTangent=new Float32Array($E.slice($V,$V+$q)),$Z.pos+=$q,$V=$Z.pos,$O.data=new Float32Array($E.slice($V,$V+$q)),$Z.pos+=$q,$C&&($C.next=$O,$C.duration=$K-$C.startTime),$C=$O}$O.next=null,$O.duration=$w-$K}var $v=$H._nodeToCachePropertyMap=new Int32Array($I),$p=$H._cachePropertyMap=new Int32Array($D),$Y=$H._unCachePropertyMap=new Int32Array($e);for($D=$e=0,$b=0;$b<$I;$b++)($$=$o[$b])._cacheProperty?($v[$b]=$D,$p[$D++]=$b):$Y[$e++]=$b},$k._animationClip=null,$k._reader=null,$k._strings=[],$I($k,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $s(){}$N($s,"laya.d3.animation.AnimationClipParser02"),$s.READ_DATA=function(){$s._DATA.offset=$s._reader.getUint32(),$s._DATA.size=$s._reader.getUint32()},$s.READ_BLOCK=function(){for(var $$=$s._BLOCK.count=$s._reader.getUint16(),$b=$s._BLOCK.blockStarts=[],$u=$s._BLOCK.blockLengths=[],$Z=0;$Z<$$;$Z++)$b.push($s._reader.getUint32()),$u.push($s._reader.getUint32())},$s.READ_STRINGS=function(){var $$=$s._reader.getUint32(),$b=$s._reader.getUint16(),$u=$s._reader.pos;$s._reader.pos=$$+$s._DATA.offset;for(var $Z=0;$Z<$b;$Z++)$s._strings[$Z]=$s._reader.readUTFString();$s._reader.pos=$u},$s.parse=function($$,$b){$s._animationClip=$$;($s._reader=$b).__getBuffer();$s.READ_DATA(),$s.READ_BLOCK(),$s.READ_STRINGS();for(var $u=0,$Z=$s._BLOCK.count;$u<$Z;$u++){var $E=$b.getUint16(),$r=$s._strings[$E],$F=$s["READ_"+$r];if(null==$F)throw new Error("model file err,no this function:"+$E+" "+$r);$F.call()}},$s.READ_ANIMATIONS=function(){var $$,$b=0,$u=0,$Z=$s._reader,$E=$Z.__getBuffer(),$r=[],$F=$Z.getUint8();for($r.length=$F,$b=0;$b<$F;$b++)$r[$b]=$Z.getUint16();var $x=[],$g=$Z.getUint16();for($x.length=$g,$b=0;$b<$g;$b++)$x[$b]=$Z.getFloat32();var $H=$s._animationClip;$H.name=$s._strings[$Z.getUint16()];var $w=$H._duration=$Z.getFloat32();$H.islooping=!!$Z.getByte(),$H._frameRate=$Z.getInt16();var $I=$Z.getInt16(),$o=$H._nodes=new Array;$o.length=$I,($H._publicClipDatas=[]).length=$I;var $N=$H._nodesMap={},$D=0,$e=0;for($b=0;$b<$I;$b++){$$=$o[$b]=new $J;var $L=$Z.getUint16(),$T=$$.path=[];for($T.length=$L,$u=0;$u<$L;$u++)$T[$u]=$s._strings[$Z.getUint16()];var $_=$T.join("/"),$y=$N[$_];$y||($N[$_]=$y=[]),$y.push($$);var $S=$Z.getInt16();-1!==$S&&($$.componentType=$s._strings[$S]);var $P=$n._propertyIndexDic[$s._strings[$Z.getUint16()]];if(null==$P)throw new Error("AnimationClipParser02:unknown property name.");var $i=$P<4,$z=!$i||$i&&""===$T[0];($$._cacheProperty=$z)?$D++:$e++,$$.propertyNameID=$P;var $q=$r[$Z.getUint8()];$$.keyFrameWidth=$q/4;var $a=$$.keyFrames=[],$t=$a.length=$Z.getUint16(),$C=null,$K=NaN;for($u=0;$u<$t;$u++){var $O=$a[$u]=new $c;$K=$O.startTime=$x[$Z.getUint16()];var $V=$Z.pos;$O.inTangent=new Float32Array($E.slice($V,$V+$q)),$Z.pos+=$q,$V=$Z.pos,$O.outTangent=new Float32Array($E.slice($V,$V+$q)),$Z.pos+=$q,$V=$Z.pos,$O.data=new Float32Array($E.slice($V,$V+$q)),$Z.pos+=$q,$C&&($C.next=$O,$C.duration=$K-$C.startTime),$C=$O}$O.next=null,$O.duration=$w-$K}var $v=$Z.getUint16();for($b=0;$b<$v;$b++){var $p,$Y=new $m;$Y.time=$Z.getFloat32(),$Y.eventName=$s._strings[$Z.getUint16()];var $k=$Z.getUint16();for(0<$k&&($Y.params=$p=[]),$u=0;$u<$k;$u++){switch($Z.getByte()){case 0:$p.push(!!$Z.getByte());break;case 1:$p.push($Z.getInt32());break;case 2:$p.push($Z.getFloat32());break;case 3:$p.push($s._strings[$Z.getUint16()]);break;default:throw new Error("unknown type.")}}$H.addEvent($Y)}var $M=$H._nodeToCachePropertyMap=new Int32Array($I),$l=$H._cachePropertyMap=new Int32Array($D),$X=$H._unCachePropertyMap=new Int32Array($e);for($D=$e=0,$b=0;$b<$I;$b++)($$=$o[$b])._cacheProperty?($M[$b]=$D,$l[$D++]=$b):$X[$e++]=$b},$s._animationClip=null,$s._reader=null,$s._strings=[],$I($s,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $m=function(){function $$(){this.time=NaN,this.eventName=null,this.params=null}return $N($$,"laya.d3.animation.AnimationEvent"),$$}(),$n=function(){function $Z(){this._childs=[],this.transform=new $_b(this)}$N($Z,"laya.d3.animation.AnimationNode");var $$=$Z.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.addChild=function($$){$$._parent=this,$$.transform.setParent(this.transform),this._childs.push($$)},$$.removeChild=function($$){var $b=this._childs.indexOf($$);-1!==$b&&this._childs.splice($b,1)},$$.getChildByName=function($$){for(var $b=0,$u=this._childs.length;$b<$u;$b++){var $Z=this._childs[$b];if($Z.name===$$)return $Z}return null},$$.getChildByIndex=function($$){return this._childs[$$]},$$.getChildCount=function(){return this._childs.length},$$.cloneTo=function($$){var $b=$$;$b.name=this.name;for(var $u=0,$Z=this._childs.length;$u<$Z;$u++){var $E=this._childs[$u],$r=$E.clone();$b.addChild($r);var $F=$E.transform,$x=$r.transform;$x.setLocalPosition($F.getLocalPosition()),$x.setLocalRotation($F.getLocalRotation()),$x.setLocalScale($F.getLocalScale()),$x._localRotationEuler=$F._localRotationEuler,$x._setWorldMatrixIgnoreUpdate($F.getWorldMatrix())}},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$Z.__init__=function(){$Z.registerAnimationNodeProperty("localPosition",$Z._getLocalPosition,$Z._setLocalPosition),$Z.registerAnimationNodeProperty("localRotation",$Z._getLocalRotation,$Z._setLocalRotation),$Z.registerAnimationNodeProperty("localScale",$Z._getLocalScale,$Z._setLocalScale),$Z.registerAnimationNodeProperty("localRotationEuler",$Z._getLocalRotationEuler,$Z._setLocalRotationEuler),$Z.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$Z._getParticleRenderSharedMaterialTintColor,$Z._setParticleRenderSharedMaterialTintColor),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$Z._getMeshRenderSharedMaterialTilingOffset,$Z._setMeshRenderSharedMaterialTilingOffset),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$Z._getMeshRenderSharedMaterialAlbedo,$Z._setMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$Z._getSkinnedMeshRenderSharedMaterialTilingOffset,$Z._setSkinnedMeshRenderSharedMaterialTilingOffset),$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$Z._getSkinnedMeshRenderSharedMaterialAlbedo,$Z._setSkinnedMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$Z._getMeshRenderSharedMaterialAlbedo,$Z._setMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$Z._getSkinnedMeshRenderSharedMaterialAlbedo,$Z._setSkinnedMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$Z._getMeshRenderSharedMaterialIntensity,$Z._setMeshRenderSharedMaterialIntensity),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$Z._getMeshRenderSharedMaterialAlpha,$Z._setMeshRenderSharedMaterialAlpha),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$Z._getMeshRenderSharedMaterialAlphaColor,$Z._setMeshRenderSharedMaterialAlphaColor),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$Z._getMeshRenderSharedMaterialBaseColor,$Z._setMeshRenderSharedMaterialBaseColor),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$Z._getMeshRenderSharedMaterialDissolve,$Z._setMeshRenderSharedMaterialDissolve),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$Z._getMeshRenderSharedMaterialDissolveSpeed,$Z._setMeshRenderSharedMaterialDissolveSpeed),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$Z._getMeshRenderSharedMaterialMMultiplier,$Z._setMeshRenderSharedMaterialMMultiplier),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$Z._getMeshRenderSharedMaterialBaseScrollSpeedX,$Z._setMeshRenderSharedMaterialBaseScrollSpeedX),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$Z._getMeshRenderSharedMaterialBaseScrollSpeedY,$Z._setMeshRenderSharedMaterialBaseScrollSpeedY),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$Z._getMeshRenderSharedMaterialSecondScrollSpeedX,$Z._setMeshRenderSharedMaterialSecondScrollSpeedX),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$Z._getMeshRenderSharedMaterialSecondScrollSpeedY,$Z._setMeshRenderSharedMaterialSecondScrollSpeedY),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$Z._getMeshRenderSharedMaterialDetailTilingOffset,$Z._setMeshRenderSharedMaterialDetailTilingOffset),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$Z._getMeshRenderSharedMaterialDissolveTilingOffset,$Z._setMeshRenderSharedMaterialDissolveTilingOffset),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$Z._getMeshRenderSharedMaterialMaskTilingOffset,$Z._setMeshRenderSharedMaterialMaskTilingOffset)},$Z.registerAnimationNodeProperty=function($$,$b,$u){if($Z._propertyIndexDic[$$])throw new Error("AnimationNode: this propertyName has registered.");$Z._propertyIndexDic[$$]=$Z._propertyIDCounter,$Z._propertyGetFuncs[$Z._propertyIDCounter]=$b,$Z._propertySetFuncs[$Z._propertyIDCounter]=$u,$Z._propertyIDCounter++},$Z._getLocalPosition=function($$,$b){return $$?$$.transform.getLocalPosition():$b._transform.localPosition.elements},$Z._setLocalPosition=function($$,$b,$u){if($$)$$.transform.setLocalPosition($u);else{var $Z=$b._transform,$E=$Z.localPosition;$E.elements=$u,$Z.localPosition=$E}},$Z._getLocalRotation=function($$,$b){return $$?$$.transform.getLocalRotation():$b._transform.localRotation.elements},$Z._setLocalRotation=function($$,$b,$u){if($$)$$.transform.setLocalRotation($u);else{var $Z=$b._transform,$E=$Z.localRotation;$E.elements=$u,$Z.localRotation=$E}},$Z._getLocalScale=function($$,$b){return $$?$$.transform.getLocalScale():$b._transform.localScale.elements},$Z._setLocalScale=function($$,$b,$u){if($$)$$.transform.setLocalScale($u);else{var $Z=$b._transform,$E=$Z.localScale;$E.elements=$u,$Z.localScale=$E}},$Z._getLocalRotationEuler=function($$,$b){return $$?$$.transform.getLocalRotationEuler():$b._transform.localRotationEuler.elements},$Z._setLocalRotationEuler=function($$,$b,$u){if($$)$$.transform.setLocalRotationEuler($u);else{var $Z=$b._transform,$E=$Z.localRotationEuler;$E.elements=$u,$Z.localRotationEuler=$E}},$Z._getMeshRenderSharedMaterialTilingOffset=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $b.meshRender.sharedMaterial.tilingOffset.elements},$Z._setMeshRenderSharedMaterialTilingOffset=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.meshRender.material).tilingOffset).elements=$u,$Z.tilingOffset=$E)}else($E=($Z=$b.meshRender.material).tilingOffset).elements=$u,$Z.tilingOffset=$E},$Z._getMeshRenderSharedMaterialAlbedo=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $b.meshRender.sharedMaterial.albedoColor.elements},$Z._setMeshRenderSharedMaterialAlbedo=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.meshRender.material).albedoColor).elements=$u,$Z.albedoColor=$E)}else($E=($Z=$b.meshRender.material).albedoColor).elements=$u,$Z.albedoColor=$E},$Z._getSkinnedMeshRenderSharedMaterialTilingOffset=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $b.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$Z._setSkinnedMeshRenderSharedMaterialTilingOffset=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.skinnedMeshRender.material).tilingOffset).elements=$u,$Z.tilingOffset=$E)}else($E=($Z=$b.skinnedMeshRender.material).tilingOffset).elements=$u,$Z.tilingOffset=$E},$Z._getSkinnedMeshRenderSharedMaterialAlbedo=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $b.skinnedMeshRender.sharedMaterial.albedoColor.elements},$Z._setSkinnedMeshRenderSharedMaterialAlbedo=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.skinnedMeshRender.material).albedoColor).elements=$u,$Z.albedoColor=$E)}else($E=($Z=$b.skinnedMeshRender.material).albedoColor).elements=$u,$Z.albedoColor=$E},$Z._getParticleRenderSharedMaterialTintColor=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.particleRender.sharedMaterial.tintColor.elements:null}return $b.particleRender.sharedMaterial.tintColor.elements},$Z._setParticleRenderSharedMaterialTintColor=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.particleRender.material).tintColor).elements=$u,$Z.tintColor=$E)}else($E=($Z=$b.particleRender.material).tintColor).elements=$u,$Z.tintColor=$E},$Z._getMeshRenderSharedMaterialAlphaColor=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $b.meshRender.sharedMaterial.alphaColor.elements},$Z._setMeshRenderSharedMaterialAlphaColor=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.meshRender.material).alphaColor).elements=$u,$Z.alphaColor=$E)}else($E=($Z=$b.meshRender.material).alphaColor).elements=$u,$Z.alphaColor=$E},$Z._getMeshRenderSharedMaterialBaseColor=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.baseColor.elements:null}return $b.meshRender.sharedMaterial.baseColor.elements},$Z._setMeshRenderSharedMaterialBaseColor=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.meshRender.material).baseColor).elements=$u,$Z.baseColor=$E)}else($E=($Z=$b.meshRender.material).baseColor).elements=$u,$Z.baseColor=$E},$Z._getMeshRenderSharedMaterialDissolve=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.dissolve:0}return $b.meshRender.sharedMaterial.dissolve},$Z._setMeshRenderSharedMaterialDissolve=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.dissolve=$u[0])}else $b.meshRender.material.dissolve=$u[0]},$Z._getMeshRenderSharedMaterialDissolveSpeed=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $b.meshRender.sharedMaterial.dissolveSpeed},$Z._setMeshRenderSharedMaterialDissolveSpeed=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.dissolveSpeed=$u[0])}else $b.meshRender.material.dissolveSpeed=$u[0]},$Z._getMeshRenderSharedMaterialMMultiplier=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.mMultiplier:0}return $b.meshRender.sharedMaterial.mMultiplier},$Z._setMeshRenderSharedMaterialMMultiplier=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.mMultiplier=$u[0])}else $b.meshRender.material.mMultiplier=$u[0]},$Z._getMeshRenderSharedMaterialBaseScrollSpeedX=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $b.meshRender.sharedMaterial.baseScrollSpeedX},$Z._setMeshRenderSharedMaterialBaseScrollSpeedX=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.baseScrollSpeedX=$u[0])}else $b.meshRender.material.baseScrollSpeedX=$u[0]},$Z._getMeshRenderSharedMaterialBaseScrollSpeedY=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $b.meshRender.sharedMaterial.baseScrollSpeedY},$Z._setMeshRenderSharedMaterialBaseScrollSpeedY=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.baseScrollSpeedY=$u[0])}else $b.meshRender.material.baseScrollSpeedY=$u[0]},$Z._getMeshRenderSharedMaterialSecondScrollSpeedX=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $b.meshRender.sharedMaterial.secondScrollSpeedX},$Z._setMeshRenderSharedMaterialSecondScrollSpeedX=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.secondScrollSpeedX=$u[0])}else $b.meshRender.material.secondScrollSpeedX=$u[0]},$Z._getMeshRenderSharedMaterialSecondScrollSpeedY=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $b.meshRender.sharedMaterial.secondScrollSpeedY},$Z._setMeshRenderSharedMaterialSecondScrollSpeedY=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.secondScrollSpeedY=$u[0])}else $b.meshRender.material.secondScrollSpeedY=$u[0]},$Z._getMeshRenderSharedMaterialAlpha=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.alpha:0}return $b.meshRender.sharedMaterial.alpha},$Z._setMeshRenderSharedMaterialAlpha=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.alpha=$u[0])}else $b.meshRender.material.alpha=$u[0]},$Z._getMeshRenderSharedMaterialIntensity=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.intensity:0}return $b.meshRender.sharedMaterial.intensity},$Z._setMeshRenderSharedMaterialIntensity=function($$,$b,$u){if($$){var $Z=$$.transform._entity;$Z&&($Z.owner.meshRender.material.intensity=$u[0])}else $b.meshRender.material.intensity=$u[0]},$Z._getMeshRenderSharedMaterialDetailTilingOffset=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $b.meshRender.sharedMaterial.detailTilingOffset.elements},$Z._setMeshRenderSharedMaterialDetailTilingOffset=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.meshRender.material).detailTilingOffset).elements=$u,$Z.detailTilingOffset=$E)}else($E=($Z=$b.meshRender.material).detailTilingOffset).elements=$u,$Z.detailTilingOffset=$E},$Z._getMeshRenderSharedMaterialDissolveTilingOffset=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $b.meshRender.sharedMaterial.dissolveTilingOffset.elements},$Z._setMeshRenderSharedMaterialDissolveTilingOffset=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.meshRender.material).dissolveTilingOffset).elements=$u,$Z.dissolveTilingOffset=$E)}else($E=($Z=$b.meshRender.material).dissolveTilingOffset).elements=$u,$Z.dissolveTilingOffset=$E},$Z._getMeshRenderSharedMaterialMaskTilingOffset=function($$,$b){if($$){var $u=$$.transform._entity;return $u?$u.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $b.meshRender.sharedMaterial.maskTilingOffset.elements},$Z._setMeshRenderSharedMaterialMaskTilingOffset=function($$,$b,$u){var $Z,$E;if($$){var $r=$$.transform._entity;$r&&(($E=($Z=$r.owner.meshRender.material).maskTilingOffset).elements=$u,$Z.maskTilingOffset=$E)}else($E=($Z=$b.meshRender.material).maskTilingOffset).elements=$u,$Z.maskTilingOffset=$E},$Z._propertyIDCounter=0,$Z._propertyIndexDic={},$Z._propertySetFuncs=[],$Z._propertyGetFuncs=[],$Z}(),$c=function(){function $$(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $N($$,"laya.d3.animation.Keyframe"),$$}(),$J=function(){function $$(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $N($$,"laya.d3.animation.KeyframeNode"),$$}(),$p=(function(){function $$(){this._tempVector30=new $Fb,this._tempVector31=new $Fb,this._tempVector32=new $Fb,this._a=new $Fb,this._b=new $Fb,this._c=new $Fb,this._d=new $Fb}$N($$,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $b=$$.prototype;$b.Init=function($$,$b,$u,$Z){$$.cloneTo(this._d),$b.cloneTo(this._c),$Fb.scale($$,2,this._a),$Fb.scale($u,2,this._tempVector30),$Fb.subtract(this._a,this._tempVector30,this._a),$Fb.add(this._a,$b,this._a),$Fb.add(this._a,$Z,this._a),$Fb.scale($u,3,this._b),$Fb.scale($$,3,this._tempVector30),$Fb.subtract(this._b,this._tempVector30,this._b),$Fb.subtract(this._b,$Z,this._b),$Fb.scale($b,2,this._tempVector30),$Fb.subtract(this._b,this._tempVector30,this._b)},$b.Slerp=function($$,$b){$Fb.scale(this._a,$$*$$*$$,this._tempVector30),$Fb.scale(this._b,$$*$$,this._tempVector31),$Fb.scale(this._c,$$,this._tempVector32),$Fb.add(this._tempVector30,this._tempVector31,$b),$Fb.add($b,this._tempVector32,$b),$Fb.add($b,this._d,$b)}}(),function(){function $l($$,$b,$u,$Z){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$$,this._h=$b,this._minHeight=$u,this._maxHeight=$Z}$N($l,"laya.d3.core.HeightMap");var $$=$l.prototype;$$._inBounds=function($$,$b){return 0<=$$&&$$<this._h&&0<=$b&&$b<this._w},$$.getHeight=function($$,$b){return this._inBounds($$,$b)?this._datas[$$][$b]:NaN},$D(0,$$,"width",function(){return this._w}),$D(0,$$,"height",function(){return this._h}),$D(0,$$,"maxHeight",function(){return this._maxHeight}),$D(0,$$,"minHeight",function(){return this._minHeight}),$l.creatFromMesh=function($$,$b,$u,$Z){for(var $E=[],$r=[],$F=$$.getSubMeshCount(),$x=0;$x<$F;$x++){for(var $g=$$.getSubMesh($x),$H=$g._getVertexBuffer(),$w=$H.getData(),$I=[],$o=0;$o<$w.length;$o+=$H.vertexDeclaration.vertexStride/4){var $N=new $Fb($w[$o+0],$w[$o+1],$w[$o+2]);$I.push($N)}$E.push($I);var $D=$g._getIndexBuffer();$r.push($D.getData())}var $e=$$.boundingBox,$L=$e.min.x,$T=$e.min.z,$_=$e.max.x,$y=$e.max.z,$S=$e.min.y,$P=$e.max.y,$i=$_-$L,$z=$y-$T,$q=$Z.elements[0]=$i/($b-1),$a=$Z.elements[1]=$z/($u-1),$t=new $l($b,$u,$S,$P),$C=$l._tempRay,$K=$C.direction.elements;$K[0]=0,$K[1]=-1,$K[2]=0;var $O=$P+.1;$C.origin.elements[1]=$O;for(var $V=0;$V<$u;$V++){var $v=$T+$V*$a;$t._datas[$V]=[];for(var $p=0;$p<$b;$p++){var $Y=$L+$p*$q,$k=$C.origin.elements;$k[0]=$Y,$k[2]=$v;var $M=$l._getPosition($C,$E,$r);$t._datas[$V][$p]=$M===Number.MAX_VALUE?NaN:$O-$M}}return $t},$l.createFromImage=function($$,$b,$u){for(var $Z=$$.width,$E=$$.height,$r=new $l($Z,$E,$b,$u),$F=($u-$b)/254,$x=$$.getPixels(),$g=0,$H=0;$H<$E;$H++)for(var $w=$r._datas[$H]=[],$I=0;$I<$Z;$I++){var $o=$x[$g++],$N=$x[$g++],$D=$x[$g++],$e=$x[$g++];$w[$I]=255==$o&&255==$N&&255==$D&&255==$e?NaN:($o+$N+$D)/3*$F+$b}return $r},$l._getPosition=function($$,$b,$u){for(var $Z=Number.MAX_VALUE,$E=0;$E<$b.length;$E++)for(var $r=$b[$E],$F=$u[$E],$x=0;$x<$F.length;$x+=3){var $g=$r[$F[$x+0]],$H=$r[$F[$x+1]],$w=$r[$F[$x+2]],$I=$Db.rayIntersectsTriangle($$,$g,$H,$w);!isNaN($I)&&$I<$Z&&($Z=$I)}return $Z},$I($l,["_tempRay",function(){return this._tempRay=new $Eb(new $Fb,new $Fb)}])}(),function(){function $E(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$N($E,"laya.d3.core.Layer");var $$=$E.prototype;return $$._binarySearchIndex=function(){for(var $$=0,$b=$E._collsionTestList.length-1,$u=0;$$<=$b;){$u=Math.floor(($$+$b)/2);var $Z=$E._collsionTestList[$u];if($Z==this._number)return $u;$Z>this._number?$b=$u-1:$$=$u+1}return $$},$$._addCollider=function($$){0===this._colliders.length&&$E._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$$._isRigidbody?(this._colliders.unshift($$),this._nonRigidbodyOffset++):this._colliders.push($$)},$$._removeCollider=function($$){var $b=this._colliders.indexOf($$);$b<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($b,1),0===this._colliders.length&&$E._collsionTestList.splice($E._collsionTestList.indexOf(this._number),1)},$D(0,$$,"number",function(){return this._number}),$D(0,$$,"visible",function(){return this._visible},function($$){this._visible=$$,$E._visibleLayers=$$?$E._visibleLayers|this.mask:$E._visibleLayers&~this.mask}),$D(0,$$,"mask",function(){return this._mask}),$D(1,$E,"visibleLayers",function(){return $E._visibleLayers},function($$){$E._visibleLayers=$$;for(var $b=0,$u=$E._layerList.length;$b<$u;$b++){var $Z=$E._layerList[$b];$Z._visible=0!=($Z._mask&$E._visibleLayers)}}),$E.__init__=function(){$E._layerList.length=31;for(var $$=0;$$<31;$$++){var $b=new $E;$E._layerList[$$]=$b,0===$$?($b.name="Default Layer",$b.visible=!0):($b.name="Layer-"+$$,$b.visible=!1),$b._number=$$,$b._mask=Math.pow(2,$$)}$E.currentCreationLayer=$E._layerList[0]},$E.getLayerByNumber=function($$){if($$<0||30<$$)throw new Error("无法返回指定Layer，该number超出范围！");return $E._layerList[$$]},$E.getLayerByName=function($$){for(var $b=0;$b<31;$b++)if($E._layerList[$b].name===$$)return $E._layerList[$b];throw new Error("无法返回指定Layer,该name不存在")},$E.isVisible=function($$){return 0!=($$&$E._currentCameraCullingMask&$E._visibleLayers)},$E._layerList=[],$E._visibleLayers=2147483647,$E._collsionTestList=[],$E._currentCameraCullingMask=2147483647,$E.maxCount=31,$E.currentCreationLayer=null,$E}()),$Y=(function(){function $$($$,$b,$u){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$$,this._minCount=$b,this._maxCount=$u}$N($$,"laya.d3.core.particleShuriKen.module.Burst");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.cloneTo=function($$){var $b=$$;$b._time=this._time,$b._minCount=this._minCount,$b._maxCount=this._maxCount},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"time",function(){return this._time}),$D(0,$b,"minCount",function(){return this._minCount}),$D(0,$b,"maxCount",function(){return this._maxCount})}(),function(){function $$($$){this._color=null,this.enbale=!1,this._color=$$}$N($$,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $b=$$.prototype;$b.cloneTo=function($$){var $b=$$;this._color.cloneTo($b._color),$b.enbale=this.enbale},$b.clone=function(){var $$;switch(this._color.type){case 0:$$=$M.createByConstant(this._color.constant.clone());break;case 1:$$=$M.createByGradient(this._color.gradient.clone());break;case 2:$$=$M.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$$=$M.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $b=new this.constructor($$);return $b.enbale=this.enbale,$b},$D(0,$b,"color",function(){return this._color})}(),function(){function $$(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$N($$,"laya.d3.core.particleShuriKen.module.Emission");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$b._destroy=function(){this._bursts=null,this._destroyed=!0},$b.getBurstsCount=function(){return this._bursts.length},$b.getBurstByIndex=function($$){return this._bursts[$$]},$b.addBurst=function($$){var $b=this._bursts.length;if(0<$b)for(var $u=0;$u<$b;$u++)this._bursts[$u].time>$$.time&&this._bursts.splice($u,0,$$);this._bursts.push($$)},$b.removeBurst=function($$){var $b=this._bursts.indexOf($$);-1!==$b&&this._bursts.splice($b,1)},$b.removeBurstByIndex=function($$){this._bursts.splice($$,1)},$b.clearBurst=function(){this._bursts.length=0},$b.cloneTo=function($$){var $b=$$,$u=$b._bursts;$u.length=this._bursts.length;for(var $Z=0,$E=this._bursts.length;$Z<$E;$Z++){var $r=$u[$Z];$r?this._bursts[$Z].cloneTo($r):$u[$Z]=this._bursts[$Z].clone()}$b._emissionRate=this._emissionRate,$b.enbale=this.enbale},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"destroyed",function(){return this._destroyed}),$D(0,$b,"emissionRate",function(){return this._emissionRate},function($$){if($$<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$$})}(),function(){function $Z(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$N($Z,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $$=$Z.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.cloneTo=function($$){var $b=$$;$b._type=this._type,$b._constant=this._constant,this._overTime.cloneTo($b._overTime),$b._constantMin=this._constantMin,$b._constantMax=this._constantMax,this._overTimeMin.cloneTo($b._overTimeMin),this._overTimeMax.cloneTo($b._overTimeMax)},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$$,"frameOverTimeData",function(){return this._overTime}),$D(0,$$,"constant",function(){return this._constant}),$D(0,$$,"type",function(){return this._type}),$D(0,$$,"frameOverTimeDataMin",function(){return this._overTimeMin}),$D(0,$$,"constantMin",function(){return this._constantMin}),$D(0,$$,"frameOverTimeDataMax",function(){return this._overTimeMax}),$D(0,$$,"constantMax",function(){return this._constantMax}),$Z.createByConstant=function($$){var $b=new $Z;return $b._type=0,$b._constant=$$,$b},$Z.createByOverTime=function($$){var $b=new $Z;return $b._type=1,$b._overTime=$$,$b},$Z.createByRandomTwoConstant=function($$,$b){var $u=new $Z;return $u._type=2,$u._constantMin=$$,$u._constantMax=$b,$u},$Z.createByRandomTwoOverTime=function($$,$b){var $u=new $Z;return $u._type=3,$u._overTimeMin=$$,$u._overTimeMax=$b,$u},$Z}()),$k=function(){function $H(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$N($H,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $$=$H.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.cloneTo=function($$){var $b=$$;$b._type=this._type,$b._separateAxes=this._separateAxes,$b._constant=this._constant,this._constantSeparate.cloneTo($b._constantSeparate),this._gradient.cloneTo($b._gradient),this._gradientX.cloneTo($b._gradientX),this._gradientY.cloneTo($b._gradientY),this._gradientZ.cloneTo($b._gradientZ),$b._constantMin=this._constantMin,$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($b._constantMinSeparate),this._constantMaxSeparate.cloneTo($b._constantMaxSeparate),this._gradientMin.cloneTo($b._gradientMin),this._gradientMax.cloneTo($b._gradientMax),this._gradientXMin.cloneTo($b._gradientXMin),this._gradientXMax.cloneTo($b._gradientXMax),this._gradientYMin.cloneTo($b._gradientYMin),this._gradientYMax.cloneTo($b._gradientYMax),this._gradientZMin.cloneTo($b._gradientZMin),this._gradientZMax.cloneTo($b._gradientZMax)},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$$,"gradientZ",function(){return this._gradientZ}),$D(0,$$,"constant",function(){return this._constant}),$D(0,$$,"gradient",function(){return this._gradient}),$D(0,$$,"separateAxes",function(){return this._separateAxes}),$D(0,$$,"type",function(){return this._type}),$D(0,$$,"constantSeparate",function(){return this._constantSeparate}),$D(0,$$,"gradientX",function(){return this._gradientX}),$D(0,$$,"gradientY",function(){return this._gradientY}),$D(0,$$,"gradientW",function(){return this._gradientW}),$D(0,$$,"gradientMin",function(){return this._gradientMin}),$D(0,$$,"constantMin",function(){return this._constantMin}),$D(0,$$,"gradientMax",function(){return this._gradientMax}),$D(0,$$,"constantMax",function(){return this._constantMax}),$D(0,$$,"gradientWMin",function(){return this._gradientWMin}),$D(0,$$,"constantMinSeparate",function(){return this._constantMinSeparate}),$D(0,$$,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$D(0,$$,"gradientXMin",function(){return this._gradientXMin}),$D(0,$$,"gradientXMax",function(){return this._gradientXMax}),$D(0,$$,"gradientWMax",function(){return this._gradientWMax}),$D(0,$$,"gradientYMin",function(){return this._gradientYMin}),$D(0,$$,"gradientYMax",function(){return this._gradientYMax}),$D(0,$$,"gradientZMin",function(){return this._gradientZMin}),$D(0,$$,"gradientZMax",function(){return this._gradientZMax}),$H.createByConstant=function($$){var $b=new $H;return $b._type=0,$b._separateAxes=!1,$b._constant=$$,$b},$H.createByConstantSeparate=function($$){var $b=new $H;return $b._type=0,$b._separateAxes=!0,$b._constantSeparate=$$,$b},$H.createByGradient=function($$){var $b=new $H;return $b._type=1,$b._separateAxes=!1,$b._gradient=$$,$b},$H.createByGradientSeparate=function($$,$b,$u,$Z){var $E=new $H;return $E._type=1,$E._separateAxes=!0,$E._gradientX=$$,$E._gradientY=$b,$E._gradientZ=$u,$E._gradientW=$Z,$E},$H.createByRandomTwoConstant=function($$,$b){var $u=new $H;return $u._type=2,$u._separateAxes=!1,$u._constantMin=$$,$u._constantMax=$b,$u},$H.createByRandomTwoConstantSeparate=function($$,$b){var $u=new $H;return $u._type=2,$u._separateAxes=!0,$u._constantMinSeparate=$$,$u._constantMaxSeparate=$b,$u},$H.createByRandomTwoGradient=function($$,$b){var $u=new $H;return $u._type=3,$u._separateAxes=!1,$u._gradientMin=$$,$u._gradientMax=$b,$u},$H.createByRandomTwoGradientSeparate=function($$,$b,$u,$Z,$E,$r,$F,$x){var $g=new $H;return $g._type=3,$g._separateAxes=!0,$g._gradientXMin=$$,$g._gradientXMax=$b,$g._gradientYMin=$u,$g._gradientYMax=$Z,$g._gradientZMin=$E,$g._gradientZMax=$r,$g._gradientWMin=$F,$g._gradientWMax=$x,$g},$H}(),$M=function(){function $Z(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$N($Z,"laya.d3.core.particleShuriKen.module.GradientColor");var $$=$Z.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.cloneTo=function($$){var $b=$$;$b._type=this._type,this._constant.cloneTo($b._constant),this._constantMin.cloneTo($b._constantMin),this._constantMax.cloneTo($b._constantMax),this._gradient.cloneTo($b._gradient),this._gradientMin.cloneTo($b._gradientMin),this._gradientMax.cloneTo($b._gradientMax)},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$$,"gradient",function(){return this._gradient}),$D(0,$$,"constant",function(){return this._constant}),$D(0,$$,"type",function(){return this._type}),$D(0,$$,"gradientMin",function(){return this._gradientMin}),$D(0,$$,"constantMin",function(){return this._constantMin}),$D(0,$$,"gradientMax",function(){return this._gradientMax}),$D(0,$$,"constantMax",function(){return this._constantMax}),$Z.createByConstant=function($$){var $b=new $Z;return $b._type=0,$b._constant=$$,$b},$Z.createByGradient=function($$){var $b=new $Z;return $b._type=1,$b._gradient=$$,$b},$Z.createByRandomTwoConstant=function($$,$b){var $u=new $Z;return $u._type=2,$u._constantMin=$$,$u._constantMax=$b,$u},$Z.createByRandomTwoGradient=function($$,$b){var $u=new $Z;return $u._type=3,$u._gradientMin=$$,$u._gradientMax=$b,$u},$Z}(),$l=(function(){function $$(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$N($$,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.addAlpha=function($$,$b){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$$&&($$=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$$,this._alphaElements[this._alphaCurrentLength++]=$b):DEBUG},$b.addRGB=function($$,$b){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$$&&($$=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$$,this._rgbElements[this._rgbCurrentLength++]=$b.x,this._rgbElements[this._rgbCurrentLength++]=$b.y,this._rgbElements[this._rgbCurrentLength++]=$b.z):DEBUG},$b.cloneTo=function($$){var $b=$$,$u=0,$Z=0;$b._alphaCurrentLength=this._alphaCurrentLength;var $E=$b._alphaElements;for($E.length=this._alphaElements.length,$u=0,$Z=this._alphaElements.length;$u<$Z;$u++)$E[$u]=this._alphaElements[$u];$b._rgbCurrentLength=this._rgbCurrentLength;var $r=$b._rgbElements;for($r.length=this._rgbElements.length,$u=0,$Z=this._rgbElements.length;$u<$Z;$u++)$r[$u]=this._rgbElements[$u]},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$D(0,$b,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $$(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$N($$,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.add=function($$,$b){this._currentLength<8?(6===this._currentLength&&1!==$$&&($$=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$$,this._elements[this._currentLength++]=$b):console.log("Warning:data count must lessEqual than 4")},$b.cloneTo=function($$){var $b=$$;$b._currentLength=this._currentLength;var $u=$b._elements;$u.length=this._elements.length;for(var $Z=0,$E=this._elements.length;$Z<$E;$Z++)$u[$Z]=this._elements[$Z]},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function $$(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$N($$,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.add=function($$,$b){this._currentLength<8?(6===this._currentLength&&1!==$$&&($$=1,DEBUG),this._elements[this._currentLength++]=$$,this._elements[this._currentLength++]=$b):DEBUG},$b.getKeyByIndex=function($$){return this._elements[2*$$]},$b.getValueByIndex=function($$){return this._elements[2*$$+1]},$b.getAverageValue=function(){for(var $$=0,$b=this._currentLength-2;$$<$b;$$+=2){this._elements[$$+1];this._elements[$$+3],this._elements[$$+2]-this._elements[$$]}return 0},$b.cloneTo=function($$){var $b=$$;$b._currentLength=this._currentLength;var $u=$b._elements;$u.length=this._elements.length;for(var $Z=0,$E=this._elements.length;$Z<$E;$Z++)$u[$Z]=this._elements[$Z]},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function $$(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$N($$,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.add=function($$,$b){this._currentLength<8?(6===this._currentLength&&1!==$$&&($$=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$$,this._elements[this._currentLength++]=$b.x,this._elements[this._currentLength++]=$b.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$b.cloneTo=function($$){var $b=$$;$b._currentLength=this._currentLength;var $u=$b._elements;$u.length=this._elements.length;for(var $Z=0,$E=this._elements.length;$Z<$E;$Z++)$u[$Z]=this._elements[$Z]},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"gradientCount",function(){return this._currentLength/3})}(),function(){function $x(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$N($x,"laya.d3.core.particleShuriKen.module.GradientSize");var $$=$x.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.getMaxSizeInGradient=function(){var $$=0,$b=0,$u=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($$=0,$b=this._gradientX.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientX.getValueByIndex($$));for($$=0,$b=this._gradientY.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientY.getValueByIndex($$))}else for($$=0,$b=this._gradient.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradient.getValueByIndex($$));break;case 1:$u=this._separateAxes?($u=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$u=Math.max($u,this._constantMinSeparate.y),Math.max($u,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($$=0,$b=this._gradientXMin.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientXMin.getValueByIndex($$));for($$=0,$b=this._gradientXMax.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientXMax.getValueByIndex($$));for($$=0,$b=this._gradientYMin.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientYMin.getValueByIndex($$));for($$=0,$b=this._gradientZMax.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientZMax.getValueByIndex($$))}else{for($$=0,$b=this._gradientMin.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientMin.getValueByIndex($$));for($$=0,$b=this._gradientMax.gradientCount;$$<$b;$$++)$u=Math.max($u,this._gradientMax.getValueByIndex($$))}}return $u},$$.cloneTo=function($$){var $b=$$;$b._type=this._type,$b._separateAxes=this._separateAxes,this._gradient.cloneTo($b._gradient),this._gradientX.cloneTo($b._gradientX),this._gradientY.cloneTo($b._gradientY),this._gradientZ.cloneTo($b._gradientZ),$b._constantMin=this._constantMin,$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($b._constantMinSeparate),this._constantMaxSeparate.cloneTo($b._constantMaxSeparate),this._gradientMin.cloneTo($b._gradientMin),this._gradientMax.cloneTo($b._gradientMax),this._gradientXMin.cloneTo($b._gradientXMin),this._gradientXMax.cloneTo($b._gradientXMax),this._gradientYMin.cloneTo($b._gradientYMin),this._gradientYMax.cloneTo($b._gradientYMax),this._gradientZMin.cloneTo($b._gradientZMin),this._gradientZMax.cloneTo($b._gradientZMax)},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$$,"gradientZ",function(){return this._gradientZ}),$D(0,$$,"gradient",function(){return this._gradient}),$D(0,$$,"separateAxes",function(){return this._separateAxes}),$D(0,$$,"type",function(){return this._type}),$D(0,$$,"gradientMin",function(){return this._gradientMin}),$D(0,$$,"constantMin",function(){return this._constantMin}),$D(0,$$,"gradientX",function(){return this._gradientX}),$D(0,$$,"gradientY",function(){return this._gradientY}),$D(0,$$,"gradientMax",function(){return this._gradientMax}),$D(0,$$,"constantMax",function(){return this._constantMax}),$D(0,$$,"constantMinSeparate",function(){return this._constantMinSeparate}),$D(0,$$,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$D(0,$$,"gradientXMin",function(){return this._gradientXMin}),$D(0,$$,"gradientXMax",function(){return this._gradientXMax}),$D(0,$$,"gradientYMin",function(){return this._gradientYMin}),$D(0,$$,"gradientYMax",function(){return this._gradientYMax}),$D(0,$$,"gradientZMin",function(){return this._gradientZMin}),$D(0,$$,"gradientZMax",function(){return this._gradientZMax}),$x.createByGradient=function($$){var $b=new $x;return $b._type=0,$b._separateAxes=!1,$b._gradient=$$,$b},$x.createByGradientSeparate=function($$,$b,$u){var $Z=new $x;return $Z._type=0,$Z._separateAxes=!0,$Z._gradientX=$$,$Z._gradientY=$b,$Z._gradientZ=$u,$Z},$x.createByRandomTwoConstant=function($$,$b){var $u=new $x;return $u._type=1,$u._separateAxes=!1,$u._constantMin=$$,$u._constantMax=$b,$u},$x.createByRandomTwoConstantSeparate=function($$,$b){var $u=new $x;return $u._type=1,$u._separateAxes=!0,$u._constantMinSeparate=$$,$u._constantMaxSeparate=$b,$u},$x.createByRandomTwoGradient=function($$,$b){var $u=new $x;return $u._type=2,$u._separateAxes=!1,$u._gradientMin=$$,$u._gradientMax=$b,$u},$x.createByRandomTwoGradientSeparate=function($$,$b,$u,$Z,$E,$r){var $F=new $x;return $F._type=2,$F._separateAxes=!0,$F._gradientXMin=$$,$F._gradientXMax=$b,$F._gradientYMin=$u,$F._gradientYMax=$Z,$F._gradientZMin=$E,$F._gradientZMax=$r,$F},$x}()),$X=function(){function $x(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$N($x,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $$=$x.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.cloneTo=function($$){var $b=$$;$b._type=this._type,this._constant.cloneTo($b._constant),this._gradientX.cloneTo($b._gradientX),this._gradientY.cloneTo($b._gradientY),this._gradientZ.cloneTo($b._gradientZ),this._constantMin.cloneTo($b._constantMin),this._constantMax.cloneTo($b._constantMax),this._gradientXMin.cloneTo($b._gradientXMin),this._gradientXMax.cloneTo($b._gradientXMax),this._gradientYMin.cloneTo($b._gradientYMin),this._gradientYMax.cloneTo($b._gradientYMax),this._gradientZMin.cloneTo($b._gradientZMin),this._gradientZMax.cloneTo($b._gradientZMax)},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$$,"gradientZ",function(){return this._gradientZ}),$D(0,$$,"constant",function(){return this._constant}),$D(0,$$,"type",function(){return this._type}),$D(0,$$,"gradientXMax",function(){return this._gradientXMax}),$D(0,$$,"constantMin",function(){return this._constantMin}),$D(0,$$,"gradientX",function(){return this._gradientX}),$D(0,$$,"gradientY",function(){return this._gradientY}),$D(0,$$,"gradientXMin",function(){return this._gradientXMin}),$D(0,$$,"constantMax",function(){return this._constantMax}),$D(0,$$,"gradientYMin",function(){return this._gradientYMin}),$D(0,$$,"gradientYMax",function(){return this._gradientYMax}),$D(0,$$,"gradientZMin",function(){return this._gradientZMin}),$D(0,$$,"gradientZMax",function(){return this._gradientZMax}),$x.createByConstant=function($$){var $b=new $x;return $b._type=0,$b._constant=$$,$b},$x.createByGradient=function($$,$b,$u){var $Z=new $x;return $Z._type=1,$Z._gradientX=$$,$Z._gradientY=$b,$Z._gradientZ=$u,$Z},$x.createByRandomTwoConstant=function($$,$b){var $u=new $x;return $u._type=2,$u._constantMin=$$,$u._constantMax=$b,$u},$x.createByRandomTwoGradient=function($$,$b,$u,$Z,$E,$r){var $F=new $x;return $F._type=3,$F._gradientXMin=$$,$F._gradientXMax=$b,$F._gradientYMin=$u,$F._gradientYMax=$Z,$F._gradientZMin=$E,$F._gradientZMax=$r,$F},$x}(),$s=(function(){function $$($$){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$$}$N($$,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.cloneTo=function($$){var $b=$$;this._angularVelocity.cloneTo($b._angularVelocity),$b.enbale=this.enbale},$b.clone=function(){var $$;switch(this._angularVelocity.type){case 0:$$=this._angularVelocity.separateAxes?$k.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$k.createByConstant(this._angularVelocity.constant);break;case 1:$$=this._angularVelocity.separateAxes?$k.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$k.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$$=this._angularVelocity.separateAxes?$k.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$k.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$$=this._angularVelocity.separateAxes?$k.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$k.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $b=new this.constructor($$);return $b.enbale=this.enbale,$b},$D(0,$b,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $$(){this.enable=!1,this.randomDirection=!1}$N($$,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $b=$$.prototype;return $P.imps($b,{"laya.d3.core.IClone":!0}),$b._getShapeBoundBox=function($$){throw new Error("BaseShape: must override it.")},$b._getSpeedBoundBox=function($$){throw new Error("BaseShape: must override it.")},$b.generatePositionAndDirection=function($$,$b,$u,$Z){throw new Error("BaseShape: must override it.")},$b._calculateProceduralBounds=function($$,$b,$u){this._getShapeBoundBox($$);var $Z=$$.min,$E=$$.max;$Fb.multiply($Z,$b,$Z),$Fb.multiply($E,$b,$E);var $r=new $h$(new $Fb,new $Fb);this.randomDirection?($r.min=new $Fb(-1,-1,-1),$r.max=new $Fb(1,1,1)):this._getSpeedBoundBox($r);var $F=new $h$(new $Fb,new $Fb),$x=$F.min,$g=$F.max;$Fb.scale($r.min,$u.y,$x),$Fb.scale($r.max,$u.y,$g),$Fb.add($$.min,$x,$x),$Fb.add($$.max,$g,$g),$Fb.min($$.min,$x,$$.min),$Fb.max($$.max,$x,$$.max);var $H=new $h$(new $Fb,new $Fb),$w=$H.min,$I=$H.max;$Fb.scale($r.min,$u.x,$w),$Fb.scale($r.max,$u.x,$I),$Fb.min($H.min,$I,$x),$Fb.max($H.min,$I,$g),$Fb.min($$.min,$x,$$.min),$Fb.max($$.max,$x,$$.max)},$b.cloneTo=function($$){$$.enable=this.enable},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$$}()),$f=function(){function $r(){}return $N($r,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$r._randomPointUnitArcCircle=function($$,$b,$u){var $Z=$b.elements,$E=NaN;$E=$u?$u.getFloat()*$$:Math.random()*$$,$Z[0]=Math.cos($E),$Z[1]=Math.sin($E)},$r._randomPointInsideUnitArcCircle=function($$,$b,$u){var $Z=$b.elements;$r._randomPointUnitArcCircle($$,$b,$u);var $E=NaN;$E=$u?Math.pow($u.getFloat(),.5):Math.pow(Math.random(),.5),$Z[0]=$Z[0]*$E,$Z[1]=$Z[1]*$E},$r._randomPointUnitCircle=function($$,$b){var $u=$$.elements,$Z=NaN;$Z=$b?$b.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$u[0]=Math.cos($Z),$u[1]=Math.sin($Z)},$r._randomPointInsideUnitCircle=function($$,$b){var $u=$$.elements;$r._randomPointUnitCircle($$);var $Z=NaN;$Z=$b?Math.pow($b.getFloat(),.5):Math.pow(Math.random(),.5),$u[0]=$u[0]*$Z,$u[1]=$u[1]*$Z},$r._randomPointUnitSphere=function($$,$b){var $u=$$.elements,$Z=NaN,$E=NaN;$E=$b?($Z=$u[2]=2*$b.getFloat()-1,$b.getFloat()*Math.PI*2):($Z=$u[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $r=Math.sqrt(1-$Z*$Z);$u[0]=$r*Math.cos($E),$u[1]=$r*Math.sin($E)},$r._randomPointInsideUnitSphere=function($$,$b){var $u=$$.elements;$r._randomPointUnitSphere($$);var $Z=NaN;$Z=$b?Math.pow($b.getFloat(),1/3):Math.pow(Math.random(),1/3),$u[0]=$u[0]*$Z,$u[1]=$u[1]*$Z,$u[2]=$u[2]*$Z},$r._randomPointInsideHalfUnitBox=function($$,$b){var $u=$$.elements;$b?($u[0]=$b.getFloat()-.5,$u[1]=$b.getFloat()-.5,$u[2]=$b.getFloat()-.5):($u[0]=Math.random()-.5,$u[1]=Math.random()-.5,$u[2]=Math.random()-.5)},$r}(),$Q=(function(){function $$($$){this._size=null,this.enbale=!1,this._size=$$}$N($$,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.cloneTo=function($$){var $b=$$;this._size.cloneTo($b._size),$b.enbale=this.enbale},$b.clone=function(){var $$;switch(this._size.type){case 0:$$=this._size.separateAxes?$l.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$l.createByGradient(this._size.gradient.clone());break;case 1:$$=this._size.separateAxes?$l.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$l.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$$=this._size.separateAxes?$l.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$l.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $b=new this.constructor($$);return $b.enbale=this.enbale,$b},$D(0,$b,"size",function(){return this._size})}(),function(){function $Z(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$N($Z,"laya.d3.core.particleShuriKen.module.StartFrame");var $$=$Z.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.cloneTo=function($$){var $b=$$;$b._type=this._type,$b._constant=this._constant,$b._constantMin=this._constantMin,$b._constantMax=this._constantMax},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$$,"constant",function(){return this._constant}),$D(0,$$,"type",function(){return this._type}),$D(0,$$,"constantMin",function(){return this._constantMin}),$D(0,$$,"constantMax",function(){return this._constantMax}),$Z.createByConstant=function($$){var $b=new $Z;return $b._type=0,$b._constant=$$,$b},$Z.createByRandomTwoConstant=function($$,$b){var $u=new $Z;return $u._type=1,$u._constantMin=$$,$u._constantMax=$b,$u},$Z}()),$W=(function(){function $$($$,$b){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $rb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$$,this._startFrame=$b}$N($$,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.cloneTo=function($$){var $b=$$;this.tiles.cloneTo($b.tiles),$b.type=this.type,$b.randomRow=this.randomRow,this._frame.cloneTo($b._frame),this._startFrame.cloneTo($b._startFrame),$b.cycles=this.cycles,$b.enableUVChannels=this.enableUVChannels,$b.enable=this.enable},$b.clone=function(){var $$,$b;switch(this._frame.type){case 0:$$=$Y.createByConstant(this._frame.constant);break;case 1:$$=$Y.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$$=$Y.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$$=$Y.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$b=$Q.createByConstant(this._startFrame.constant);break;case 1:$b=$Q.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $u=new this.constructor($$,$b);return this.tiles.cloneTo($u.tiles),$u.type=this.type,$u.randomRow=this.randomRow,$u.cycles=this.cycles,$u.enableUVChannels=this.enableUVChannels,$u.enable=this.enable,$u},$D(0,$b,"frame",function(){return this._frame}),$D(0,$b,"startFrame",function(){return this._startFrame})}(),function(){function $$($$){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$$}$N($$,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $b=$$.prototype;$P.imps($b,{"laya.d3.core.IClone":!0}),$b.cloneTo=function($$){var $b=$$;this._velocity.cloneTo($b._velocity),$b.enbale=this.enbale,$b.space=this.space},$b.clone=function(){var $$;switch(this._velocity.type){case 0:$$=$X.createByConstant(this._velocity.constant.clone());break;case 1:$$=$X.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$$=$X.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$$=$X.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $b=new this.constructor($$);return $b.enbale=this.enbale,$b.space=this.space,$b},$D(0,$b,"velocity",function(){return this._velocity})}(),function(){function $$(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $ob,this._vb=$sb.create($$._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$Xb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$Mb.nameKey.getID("LINE"),this._shaderCompile=$qb._preCompileShader[this._sharderNameID]}$N($$,"laya.d3.core.PhasorSpriter3D");var $b=$$.prototype;return $b.line=function($$,$b,$u,$Z){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($$.x,$$.y,$$.z,$b.x,$b.y,$b.z,$b.w),this.addVertex($u.x,$u.y,$u.z,$Z.x,$Z.y,$Z.z,$Z.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$b.circle=function($$,$b,$u,$Z,$E,$r){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$b,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$b,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$$,Math.cos(this._tempNumver0)*$$,0,$u,$Z,$E,$r),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$b.plane=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$Z/2,this._tempNumver1=$E/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($$-this._tempNumver0,$b+this._tempNumver1,$u,$r,$F,$x,$g),this.addVertex($$+this._tempNumver0,$b+this._tempNumver1,$u,$r,$F,$x,$g),this.addVertex($$-this._tempNumver0,$b-this._tempNumver1,$u,$r,$F,$x,$g),this.addVertex($$+this._tempNumver0,$b-this._tempNumver1,$u,$r,$F,$x,$g),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$b.box=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$Z/2,this._tempNumver1=$E/2,this._tempNumver2=$r/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($$-this._tempNumver0,$b+this._tempNumver1,$u+this._tempNumver2,$F,$x,$g,$H),this.addVertex($$+this._tempNumver0,$b+this._tempNumver1,$u+this._tempNumver2,$F,$x,$g,$H),this.addVertex($$-this._tempNumver0,$b-this._tempNumver1,$u+this._tempNumver2,$F,$x,$g,$H),this.addVertex($$+this._tempNumver0,$b-this._tempNumver1,$u+this._tempNumver2,$F,$x,$g,$H),this.addVertex($$+this._tempNumver0,$b+this._tempNumver1,$u-this._tempNumver2,$F,$x,$g,$H),this.addVertex($$-this._tempNumver0,$b+this._tempNumver1,$u-this._tempNumver2,$F,$x,$g,$H),this.addVertex($$+this._tempNumver0,$b-this._tempNumver1,$u-this._tempNumver2,$F,$x,$g,$H),this.addVertex($$-this._tempNumver0,$b-this._tempNumver1,$u-this._tempNumver2,$F,$x,$g,$H),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$b.cone=function($$,$b,$u,$Z,$E,$r,$F){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$u+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$u>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$u,this.addVertexIndex(0,$b,0,$Z,$E,$r,$F,this._tempUint0),this.addVertexIndex(0,0,0,$Z,$E,$r,$F,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$u;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($$*this._tempNumver2,0,$$*this._tempNumver3,$Z,$E,$r,$F,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$u-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($$*this._tempNumver2,0,$$*this._tempNumver3,$Z,$E,$r,$F,this._tempUint0+(this._tempInt0+$u)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$u-1?this.addIndexes(this._tempUint1+$u+2):this.addIndexes(this._tempUint1+this._tempInt0+$u+1),this.addIndexes(this._tempUint1+this._tempInt0+$u),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$b.boundingBoxLine=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($$,$E,$r,$F,$x,$g,$H),this.addVertex($Z,$E,$r,$F,$x,$g,$H),this.addVertex($$,$b,$r,$F,$x,$g,$H),this.addVertex($Z,$b,$r,$F,$x,$g,$H),this.addVertex($Z,$E,$u,$F,$x,$g,$H),this.addVertex($$,$E,$u,$F,$x,$g,$H),this.addVertex($Z,$b,$u,$F,$x,$g,$H),this.addVertex($$,$b,$u,$F,$x,$g,$H),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$b.addVertex=function($$,$b,$u,$Z,$E,$r,$F){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$$,this._vbData[this._posInVBData+1]=$b,this._vbData[this._posInVBData+2]=$u,this._vbData[this._posInVBData+3]=$Z,this._vbData[this._posInVBData+4]=$E,this._vbData[this._posInVBData+5]=$r,this._vbData[this._posInVBData+6]=$F,this._posInVBData+=this._floatSizePerVer,this},$b.addVertexIndex=function($$,$b,$u,$Z,$E,$r,$F,$x){return this._hasBegun||this.addVertexIndexException(),this._vbData[$x]=$$,this._vbData[$x+1]=$b,this._vbData[$x+2]=$u,this._vbData[$x+3]=$Z,this._vbData[$x+4]=$E,this._vbData[$x+5]=$r,this._vbData[$x+6]=$F,($x+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$x),this},$b.addIndexes=function($$){var $b=arguments;this._hasBegun||this.addVertexIndexException();for(var $u=0;$u<$b.length;$u++)this._ibData[this._posInIBData]=$b[$u],this._posInIBData++;return this},$b.begin=function($$,$b){return this._hasBegun&&this.beginException0(),1!==$$&&4!==$$&&this.beginException1(),this._primitiveType=$$,this._camera=$b,this._hasBegun=!0,this},$b.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$b.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($$._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$q.drawCall++,$O.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$b.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$b.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$b.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$b.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$b.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$b.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(28,[new $F$(0,"vector3",0),new $F$(12,"vector4",1)])}]),$$}()),$G=function(){function $$(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$$._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $ob}$N($$,"laya.d3.core.render.RenderElement");var $b=$$.prototype;return $b.getDynamicBatchBakedVertexs=function($$){for(var $b=this._renderObj._getVertexBuffer($$),$u=$b.getData().slice(),$Z=$b.vertexDeclaration,$E=$Z.getVertexElementByUsage(0).offset/4,$r=$Z.getVertexElementByUsage(3).offset/4,$F=this._sprite3D.transform,$x=$F.worldMatrix,$g=$F.rotation,$H=$Z.vertexStride/4,$w=0,$I=$u.length;$w<$I;$w+=$H){var $o=$w+$E,$N=$w+$r;$Lb.transformVector3ArrayToVector3ArrayCoordinate($u,$o,$x,$u,$o),$Lb.transformVector3ArrayByQuat($u,$N,$g,$u,$N)}return $u},$b.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$b._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$D(0,$b,"id",function(){return this._id}),$D(0,$b,"renderObj",function(){return this._renderObj},function($$){this._renderObj!==$$&&(this._renderObj=$$)}),$$._uniqueIDCounter=0,$$}(),$A=function(){function $b($$){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$b._uniqueIDCounter,this._needSort=!1,this._scene=$$,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$N($b,"laya.d3.core.render.RenderQueue");var $$=$b.prototype;return $$._sortOpaqueFunc=function($$,$b){if($$._render&&$b._render){var $u=$$._material.renderQueue-$b._material.renderQueue;return 0==$u?$$._render._distanceForSort-$b._render._distanceForSort:$u}return 0},$$._sortAlphaFunc=function($$,$b){if($$._render&&$b._render){var $u=$$._material.renderQueue-$b._material.renderQueue;return 0==$u?$b._render._distanceForSort-$$._render._distanceForSort:$u}return 0},$$._begainRenderElement=function($$,$b,$u){return!!$b._beforeRender($$)},$$._sortAlpha=function($$){$b._cameraPosition=$$,this._finalElements.sort(this._sortAlphaFunc)},$$._sortOpaque=function($$){$b._cameraPosition=$$,this._finalElements.sort(this._sortOpaqueFunc)},$$._preRender=function($$){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$$._render=function($$,$b){for(var $u,$Z,$E,$r,$F,$x,$g=$q.loopCount,$H=this._scene,$w=$$.camera,$I=($w.id,!1),$o=0,$N=this._finalElements.length;$o<$N;$o++){var $D,$e,$L,$T=this._finalElements[$o];if(null!=$T._onPreRenderFunction&&$T._onPreRenderFunction.call($T._sprite3D,$$),0===$T._type){if($$.owner=$L=$T._sprite3D,$$.renderElement=$T,$L._preRenderUpdateComponents($$),$D=$T.renderObj,$e=$T._material,this._begainRenderElement($$,$D,$e)){if($u=$D._getVertexBuffers(),!($E=($Z=$D._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$Z.id]){this._errorRecord[$Z.id]=1;var $_="vertexBuffer:"+("("+$Z._destroyed+","+$Z._released+","+$Z._referenceCount+","+$Z._buffer+")")+", material:"+($e?$e.__className+"("+$e._destroyed+","+$e._released+")":"null")+", owner:"+($L?$L.__className+"("+$L._destroyed+","+$L._activeInHierarchy+","+$L._displayedInStage+")":"null")+", renderObj:"+($D?$D.__className+"("+$D._destroyed+","+$D._released+","+$D._referenceCount+")":"")+", parent:, url:"+($L?$L.url:"")+", disposeStack:"+$Z.disposeStack;$P.recordError("报错：unknown vertexDeclaration  "+$_)}continue}if($I=($r=$$._shader=$e._getShader($H._shaderDefineValue,$E.shaderDefineValue,$L._shaderDefineValue)).bind()||$g!==$r._uploadLoopCount,$u){if($r._uploadVertexBuffer!==$u||$I){for(var $y=0;$y<$u.length;$y++){var $S=$u[$y];$r.uploadAttributesX($S.vertexDeclaration.shaderValues.data,$S)}$r._uploadVertexBuffer=$u}}else($r._uploadVertexBuffer!==$Z||$I)&&($r.uploadAttributes($E.shaderValues.data,null),$r._uploadVertexBuffer=$Z);($r._uploadScene!==$H||$I)&&($r.uploadSceneUniforms($H._shaderValues.data),$r._uploadScene=$H),($w!==$r._uploadCamera||$r._uploadSprite3D!==$L||$I)&&($r.uploadSpriteUniforms($L._shaderValues.data),$r._uploadSprite3D=$L),($w!==$r._uploadCamera||$I)&&($r.uploadCameraUniforms($w._shaderValues.data),$r._uploadCamera=$w),($r._uploadMaterial!==$e||$I)&&($e._upload(),$r._uploadMaterial=$e),$F!==$e?($e._setRenderStateBlendDepth(),$e._setRenderStateFrontFace($b,$L.transform),$F=$e,$x=$L):$x!==$L&&($e._setRenderStateFrontFace($b,$L.transform),$x=$L),$D._render($$),$r._uploadLoopCount=$g}$L._postRenderUpdateComponents($$)}else if(2===$T._type){$T.renderObj;$$.owner=$L=$T._sprite3D,$$.renderElement=$T,$$._batchIndexStart=$T._tempBatchIndexStart,$$._batchIndexEnd=$T._tempBatchIndexEnd,$D=$T.renderObj,$e=$T._material,this._begainRenderElement($$,$D,$e)&&($E=($Z=$D._getVertexBuffer(0)).vertexDeclaration,$I=($r=$$._shader=$e._getShader($H._shaderDefineValue,$E.shaderDefineValue,$L._shaderDefineValue)).bind()||$g!==$r._uploadLoopCount,($r._uploadVertexBuffer!==$Z||$I)&&($r.uploadAttributes($E.shaderValues.data,null),$r._uploadVertexBuffer=$Z),($r._uploadScene!==$H||$I)&&($r.uploadSceneUniforms($H._shaderValues.data),$r._uploadScene=$H),($w!==$r._uploadCamera||$r._uploadSprite3D!==$L||$I)&&($r.uploadSpriteUniforms($L._shaderValues.data),$r._uploadSprite3D=$L),($w!==$r._uploadCamera||$I)&&($r.uploadCameraUniforms($w._shaderValues.data),$r._uploadCamera=$w),($r._uploadMaterial!==$e||$I)&&($e._upload(),$r._uploadMaterial=$e),$F!==$e?($e._setRenderStateBlendDepth(),$e._setRenderStateFrontFace($b,$L.transform),$F=$e,$x=$L):$x!==$L&&($e._setRenderStateFrontFace($b,$L.transform),$x=$L),$D._render($$),$r._uploadLoopCount=$g)}}},$$._renderShadow=function($$,$b){for(var $u,$Z,$E,$r,$F,$x=$q.loopCount,$g=this._scene,$H=$$.camera,$w=!1,$I=0,$o=this._finalElements.length;$I<$o;$I++){var $N,$D,$e,$L=this._finalElements[$I];0===$L._type&&($$.owner=$e=$L._sprite3D,$b||$e._projectionViewWorldUpdateCamera===$H&&$e._projectionViewWorldUpdateLoopCount===$q.loopCount||($e._render._renderUpdate($$._projectionViewMatrix),$e._projectionViewWorldUpdateLoopCount=$q.loopCount,$e._projectionViewWorldUpdateCamera=$H),$$.renderElement=$L,$e._preRenderUpdateComponents($$),$N=$L.renderObj,$D=$L._material,this._begainRenderElement($$,$N,null)&&($Z=($u=$N._getVertexBuffer(0)).vertexDeclaration,$w=($E=$$._shader=$D._getShader($g._shaderDefineValue,$Z.shaderDefineValue,$e._shaderDefineValue)).bind()||$x!==$E._uploadLoopCount,($E._uploadVertexBuffer!==$u||$w)&&($E.uploadAttributes($Z.shaderValues.data,null),$E._uploadVertexBuffer=$u),($H!==$E._uploadCamera||$E._uploadSprite3D!==$e||$w)&&($E.uploadSpriteUniforms($e._shaderValues.data),$E._uploadSprite3D=$e),($H!==$E._uploadCamera||$w)&&($E.uploadCameraUniforms($H._shaderValues.data),$E._uploadCamera=$H),($E._uploadMaterial!==$D||$w)&&($D._upload(),$E._uploadMaterial=$D),$E._uploadRenderElement,$r!==$D?($D._setRenderStateFrontFace(!1,$e.transform),$r=$D,$F=$e):$F!==$e&&($D._setRenderStateFrontFace(!1,$e.transform),$F=$e),$N._render($$),$E._uploadLoopCount=$x),$e._postRenderUpdateComponents($$))}},$$._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$$._addRenderElement=function($$){this._renderElements.push($$),this._needSort=!0},$$._addDynamicBatchElement=function($$){this._dynamicBatchCombineRenderElements.push($$)},$D(0,$$,"id",function(){return this._id}),$b._uniqueIDCounter=0,$b._cameraPosition=null,$b}(),$j=function(){function $$(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $N($$,"laya.d3.core.render.RenderState"),$$.clientWidth=0,$$.clientHeight=0,$$}(),$h=function(){function $F($$,$b){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $U$(new $Fb,0),this._corners=[new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb],this._boundingBoxCenter=new $Fb,this._children=$Z(8),this._objects=[],this._tempBoundBoxCorners=[new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb],this._scene=$$,this._currentDepth=$b}$N($F,"laya.d3.core.scene.OctreeNode");var $$=$F.prototype;return $P.imps($$,{"laya.d3.core.scene.ITreeNode":!0}),$$.init=function($$,$b){var $u=new $Fb,$Z=new $Fb;$Fb.scale($b,-.5,$u),$Fb.scale($b,.5,$Z),$Fb.add($u,$$,$u),$Fb.add($Z,$$,$Z),this.exactBox=new $h$($u,$Z),this.relaxBox=new $h$($u,$Z)},$$.addTreeNode=function($$){1===Collision.boxContainsBox(this._relaxBox,$$.boundingBox)?this.addNodeDown($$,0):this.addObject($$)},$$.addChild=function($$){var $b=this._children[$$];if(null==$b){$b=new $F(this._scene,this._currentDepth+1),(this._children[$$]=$b)._parent=this,$Fb.subtract(this._exactBox.max,this._exactBox.min,$F.tempSize),$Fb.multiply($F.tempSize,$F._octreeSplit[$$],$F.tempCenter),$Fb.add(this._exactBox.min,$F.tempCenter,$F.tempCenter),$Fb.scale($F.tempSize,.25,$F.tempSize);var $u=new $Fb,$Z=new $Fb;$Fb.subtract($F.tempCenter,$F.tempSize,$u),$Fb.add($F.tempCenter,$F.tempSize,$Z),$b.exactBox=new $h$($u,$Z),$Fb.scale($F.tempSize,$F.relax,$F.tempSize);var $E=new $Fb,$r=new $Fb;$Fb.subtract($F.tempCenter,$F.tempSize,$E),$Fb.add($F.tempCenter,$F.tempSize,$r),$b.relaxBox=new $h$($E,$r)}return $b},$$.addObject=function($$){($$._treeNode=this)._objects.push($$)},$$.removeObject=function($$){if($$._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $b=this._objects.indexOf($$);return-1!==$b&&(this._objects.splice($b,1),!0)},$$.clearObject=function(){this._objects.length=0},$$.addNodeUp=function($$,$b){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$$.boundingBox)?this._parent.addNodeUp($$,$b-1):this.addNodeDown($$,$b)},$$.addNodeDown=function($$,$b){if($b<this._scene.treeLevel){var $u=this.inChildIndex($$.boundingBoxCenter),$Z=this.addChild($u);1===Collision.boxContainsBox($Z._relaxBox,$$.boundingBox)?$Z.addNodeDown($$,++$b):this.addObject($$)}else this.addObject($$)},$$.inChildIndex=function($$){return 4*($$.z<this._boundingBoxCenter.z?0:1)+2*($$.y<this._boundingBoxCenter.y?0:1)+($$.x<this._boundingBoxCenter.x?0:1)},$$.updateObject=function($$){1===Collision.boxContainsBox(this._relaxBox,$$.boundingBox)?(this.removeObject($$),$$._treeNode=null,this.addNodeDown($$,this._currentDepth)):this._parent&&(this.removeObject($$),$$._treeNode=null,this._parent.addNodeUp($$,this._currentDepth-1))},$$.cullingObjects=function($$,$b,$u,$Z,$E){var $r,$F=0,$x=0,$g=0,$H=this._scene._dynamicBatchManager;for($F=0,$r=this._objects.length;$F<$r;$F++){var $w=this._objects[$F];if($p.isVisible($w._owner.layer.mask)&&$w.enable){if($b&&($q.treeSpriteCollision+=1,0===$$.containsBoundSphere($w.boundingSphere)))continue;$w._renderUpdate($E),$w._distanceForSort=$Fb.distance($w.boundingSphere.center,$Z)+$w.sortingFudge;var $I=$w._renderElements;for($x=0,$g=$I.length;$x<$g;$x++){var $o=$I[$x],$N=$o._staticBatch;if($N&&$N._material===$o._material)$N._addBatchRenderElement($o);else{var $D=$o.renderObj;$D.triangleCount<10&&1===$D._vertexBufferCount&&$D._getIndexBuffer()&&$o._material.renderQueue<2&&$o._canDynamicBatch&&!$w._owner.isStatic?$H._addPrepareRenderElement($o):this._scene.getRenderQueue($o._material.renderQueue)._addRenderElement($o)}}}}for($F=0;$F<8;$F++){var $e=this._children[$F];if(null!=$e){var $L=$b;if($b){var $T=$$.containsBoundBox($e._relaxBox);if($q.treeNodeCollision+=1,0===$T)continue;$L=2===$T}$e.cullingObjects($$,$L,$u,$Z,$E)}}},$$.cullingShadowObjects=function($$,$b,$u,$Z,$E){var $r,$F=0,$x=0,$g=0;this._scene._dynamicBatchManager;for($F=0,$r=this._objects.length;$F<$r;$F++){var $H=this._objects[$F];if($H.castShadow&&$p.isVisible($H._owner.layer.mask)&&$H.enable){if($u&&0===$$[0].containsBoundSphere($H.boundingSphere))continue;for(var $w=1,$I=$$.length;$w<$I;$w++){var $o=$b[$w-1];if(0!==$$[$w].containsBoundSphere($H.boundingSphere)){var $N=$H._renderElements;for($x=0,$g=$N.length;$x<$g;$x++)$o._addRenderElement($N[$x])}}}}for($F=0;$F<8;$F++){var $D=this._children[$F];if(null!=$D){var $e=$u;if($u){var $L=$$[0].containsBoundBox($D._relaxBox);if(0===$L)continue;$e=2===$L}$D.cullingShadowObjects($$,$b,$e,$Z,$E)}}},$$.cullingShadowObjectsOnePSSM=function($$,$b,$u,$Z,$E,$r){var $F,$x=$b[0],$g=0,$H=0,$w=0;for($g=0,$F=this._objects.length;$g<$F;$g++){var $I=this._objects[$g];if($I.castShadow&&$p.isVisible($I._owner.layer.mask)&&$I.enable){if($Z&&0===$$.containsBoundSphere($I.boundingSphere))continue;$I._renderUpdate($u);var $o=$I._renderElements;for($H=0,$w=$o.length;$H<$w;$H++)$x._addRenderElement($o[$H])}}for($g=0;$g<8;$g++){var $N=this._children[$g];if(null!=$N){var $D=$Z;if($Z){var $e=$$.containsBoundBox($N._relaxBox);if(0===$e)continue;$D=2===$e}$N.cullingShadowObjectsOnePSSM($$,$b,$u,$D,$E,$r)}}},$$.renderBoudingBox=function($$){this._renderBoudingBox($$);for(var $b=0;$b<8;++$b){var $u=this._children[$b];$u&&$u.renderBoudingBox($$)}},$$.buildAllChild=function($$){if($$<this._scene.treeLevel)for(var $b=0;$b<8;$b++){this.addChild($b).buildAllChild($$+1)}},$$._renderBoudingBox=function($$){},$D(0,$$,"exactBox",function(){return this._exactBox},function($$){this._exactBox=$$,$Fb.add($$.min,$$.max,this._boundingBoxCenter),$Fb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$D(0,$$,"relaxBox",function(){return this._relaxBox},function($$){(this._relaxBox=$$).getCorners(this._corners),$U$.createfromPoints(this._corners,this._boundingSphere)}),$F.debugMode=!1,$F.relax=1.15,$F.CHILDNUM=8,$I($F,["tempVector0",function(){return this.tempVector0=new $Fb},"tempSize",function(){return this.tempSize=new $Fb},"tempCenter",function(){return this.tempCenter=new $Fb},"_octreeSplit",function(){return this._octreeSplit=[new $Fb(.25,.25,.25),new $Fb(.75,.25,.25),new $Fb(.25,.75,.25),new $Fb(.75,.75,.25),new $Fb(.25,.25,.75),new $Fb(.75,.25,.75),new $Fb(.25,.75,.75),new $Fb(.75,.75,.75)]}]),$F}(),$d=(function(){function $$(){}$N($$,"laya.d3.core.scene.SceneManager")}(),function(){function $$($$,$b,$u,$Z){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$$&&($$=1),void 0===$b&&($b=1),void 0===$u&&($u=1),void 0===$Z&&($Z=1),this._r=$$,this._g=$b,this._b=$u,this._a=$Z}return $N($$,"laya.d3.core.trail.module.Color",null,"Color$1"),$$.prototype.cloneTo=function($$){$$._r=this._r,$$._g=this._g,$$._b=this._b,$$._a=this._a},$I($$,["RED",function(){return this.RED=new $$(1,0,0,1)},"GREEN",function(){return this.GREEN=new $$(0,1,0,1)},"BLUE",function(){return this.BLUE=new $$(0,0,1,1)},"CYAN",function(){return this.CYAN=new $$(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $$(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $$(1,0,1,1)},"GRAY",function(){return this.GRAY=new $$(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $$(1,1,1,1)},"BLACK",function(){return this.BLACK=new $$(0,0,0,1)}]),$$}()),$U=(function(){function $$(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$N($$,"laya.d3.core.trail.module.Gradient");var $b=$$.prototype;$b.setKeys=function($$,$b){var $u,$Z;this._colorKeys=$$;for(var $E=this.index=0;$E<$$.length;$E++){var $r=($u=$$[$E]).color;this._colorKeyData[this.index++]=$r._r,this._colorKeyData[this.index++]=$r._g,this._colorKeyData[this.index++]=$r._b,this._colorKeyData[this.index++]=$u.time}this._alphaKeys=$b;for(var $F=this.index=0;$F<$b.length;$F++)$Z=$b[$F],this._alphaKeyData[this.index++]=$Z.alpha,this._alphaKeyData[this.index++]=$Z.time},$b.cloneTo=function($$){var $b=0,$u=0,$Z=this.colorKeys,$E=[];for($b=0,$u=$Z.length;$b<$u;$b++){var $r=new $B;$Z[$b].cloneTo($r),$E.push($r)}var $F=this.alphaKeys,$x=[];for($b=0,$u=$F.length;$b<$u;$b++){var $g=new $U;$F[$b].cloneTo($g),$x.push($g)}$$.setKeys($E,$x)},$D(0,$b,"mode",function(){return this._mode},function($$){this._mode=$$}),$D(0,$b,"colorKeys",function(){return this._colorKeys},function($$){this._colorKeys=$$;for(var $b=this.index=0;$b<$$.length;$b++){var $u=$$[$b],$Z=$u.color;this._colorKeyData[this.index++]=$Z._r,this._colorKeyData[this.index++]=$Z._g,this._colorKeyData[this.index++]=$Z._b,this._colorKeyData[this.index++]=$u.time}}),$D(0,$b,"alphaKeys",function(){return this._alphaKeys},function($$){this._alphaKeys=$$;for(var $b=this.index=0;$b<$$.length;$b++){var $u=$$[$b];this._alphaKeyData[this.index++]=$u.alpha,this._alphaKeyData[this.index++]=$u.time}})}(),function(){function $$($$,$b){this._alpha=NaN,this._time=NaN,void 0===$$&&($$=0),void 0===$b&&($b=0),this._alpha=$$,this._time=$b}$N($$,"laya.d3.core.trail.module.GradientAlphaKey");var $b=$$.prototype;return $b.cloneTo=function($$){$$.alpha=this.alpha,$$.time=this.time},$D(0,$b,"alpha",function(){return this._alpha},function($$){this._alpha=$$}),$D(0,$b,"time",function(){return this._time},function($$){this._time=$$}),$$}()),$B=function(){function $$($$,$b){this._color=null,this._time=NaN,void 0===$b&&($b=0),this._color=$$||new $d,this._time=$b}$N($$,"laya.d3.core.trail.module.GradientColorKey");var $b=$$.prototype;return $b.cloneTo=function($$){this.color.cloneTo($$.color),$$.time=this.time},$D(0,$b,"color",function(){return this._color},function($$){this._color=$$}),$D(0,$b,"time",function(){return this._time},function($$){this._time=$$}),$$}(),$R=(function(){function $$(){}$N($$,"laya.d3.core.trail.module.GradientMode"),$$.Blend=0,$$.Fixed=1}(),function(){function $$(){}$N($$,"laya.d3.core.trail.module.TextureMode"),$$.Stretch=0,$$.Tile=1}(),function(){function $$(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$N($$,"laya.d3.core.trail.module.TrailKeyFrame"),$$.prototype.cloneTo=function($$){$$.time=this.time,$$.inTangent=this.inTangent,$$.outTangent=this.outTangent,$$.value=this.value}}(),function(){function $b($$){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $Fb,this._curPosition=new $Fb,this._delVector3=new $Fb,this._lastFixedVertexPosition=new $Fb,this._pointAtoBVector3=new $Fb,this._pointA=new $Fb,this._pointB=new $Fb,this._owner=$$,this._id=$b.renderElementCount++,0==this._id?$$._owner.transform.position.cloneTo(this._lastPosition):$$._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $sb($R.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $sb($R.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$N($b,"laya.d3.core.trail.TrailRenderElement");var $$=$b.prototype;$P.imps($$,{"laya.d3.core.render.IRenderable":!0}),$$._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$$._addTrailByFirstPosition=function($$,$b){$Fb.subtract($b,$$,this._delVector3),$Fb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$Fb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$Fb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($$),$$.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$$._addTrailByNextPosition=function($$){$Fb.subtract($$,this._lastFixedVertexPosition,this._delVector3),$Fb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$Fb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$Fb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$Fb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$B$.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($$),$$.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($$),this._virtualVerticesCount=2)},$$._updateVerticesByPosition=function($$){this._pointe=$$.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$$._updateVertexBuffer2=function(){var $$,$b=0,$u=0,$Z=0;for($Z=0,$$=(this._verticesCount+this._virtualVerticesCount)/2;$Z<$$;$Z++)$u=0==this._owner.textureMode?(this._VerticesToTailLength[$Z]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$Z],this._vertices2[$b++]=1-$u,this._vertices2[$b++]=1-$u;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$$._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$$._updateDisappear=function(){var $$,$b=0;for($b=this._curDisappearIndex,$$=(this._verticesCount+this._virtualVerticesCount)/2;$b<$$;$b++)this._owner._curtime-this._everyGroupVertexBirthTime[$b]>=this._owner.time+$B$.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$$._beforeRender=function($$){return this._camera=$$.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$Fb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$$._render=function($$){this._isDead||($O.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$q.drawCall++,$q.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$$._getVertexBuffer=function($$){return void 0===$$&&($$=0),0===$$?this._vertexBuffer1:1===$$?this._vertexBuffer2:null},$$._getVertexBuffers=function(){return this._vertexBuffers},$$._getIndexBuffer=function(){return null},$$.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$$._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$D(0,$$,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$D(0,$$,"triangleCount",function(){return 0}),$b.renderElementCount=0}(),function(){function $$(){}$N($$,"laya.d3.core.trail.VertexTrail");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration1}),$D(1,$$,"vertexDeclaration1",function(){return $$._vertexDeclaration1}),$D(1,$$,"vertexDeclaration2",function(){return $$._vertexDeclaration2}),$I($$,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $r$(32,[new $F$(0,"vector3",0),new $F$(12,"vector3",41),new $F$(24,"single",33),new $F$(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $r$(4,[new $F$(0,"single",38)])}]),$$}()),$$$=function(){function $S($$){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$$}$N($S,"laya.d3.graphics.DynamicBatch");var $$=$S.prototype;return $P.imps($$,{"laya.d3.core.render.IRenderable":!0}),$$._getVertexBuffer=function($$){return void 0===$$&&($$=0),0===$$?this._vertexBuffer:null},$$._getIndexBuffer=function(){return this._indexBuffer},$$._getCombineRenderElementFromPool=function($$,$b,$u){var $Z=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $Z||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$Z=new $G,$Z._sprite3D=new $Ab),$Z._sprite3D._render._renderUpdate($u),$Z},$$._getRenderElement=function($$,$b,$u){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$S.maxVertexCount),this._indexDatas=new Uint16Array($S.maxIndexCount),this._vertexBuffer=$sb.create(this._vertexDeclaration,$S.maxVertexCount,35048),this._indexBuffer=$Xb.create("ushort",$S.maxIndexCount,35048));for(var $Z=this._merageElements.length=0,$E=0,$r=0,$F=this._combineRenderElements.length;$r<$F;$r++){var $x=this._combineRenderElements[$r],$g=$x.getDynamicBatchBakedVertexs(0),$H=$x.getBakedIndices(),$w=$x._sprite3D.transform._isFrontFaceInvert,$I=$Z/(this._vertexDeclaration.vertexStride/4),$o=$E,$N=$o+$H.length;$x._tempBatchIndexStart=$o,$x._tempBatchIndexEnd=$N,this._indexDatas.set($H,$E);var $D=0;if($w)for($D=$o;$D<$N;$D+=3){this._indexDatas[$D]=$I+this._indexDatas[$D];var $e=this._indexDatas[$D+1],$L=this._indexDatas[$D+2];this._indexDatas[$D+1]=$I+$L,this._indexDatas[$D+2]=$I+$e}else for($D=$o;$D<$N;$D+=3)this._indexDatas[$D]=$I+this._indexDatas[$D],this._indexDatas[$D+1]=$I+this._indexDatas[$D+1],this._indexDatas[$D+2]=$I+this._indexDatas[$D+2];$E+=$H.length,this._vertexDatas.set($g,$Z),$Z+=$g.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$r=this._combineRenderElementPoolIndex=0,$F=this._materials.length;$r<$F;$r++){var $T=this._getCombineRenderElementFromPool($$,$b,$u);$T._type=2,$T._staticBatch=null;var $_=($T.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$r]]._tempBatchIndexStart,$y=$r+1===this._materialToRenderElementsOffsets.length?$E:this._combineRenderElements[this._materialToRenderElementsOffsets[$r+1]]._tempBatchIndexStart;$T._tempBatchIndexStart=$_,$T._tempBatchIndexEnd=$y,$T._material=this._materials[$r],this._merageElements.push($T)}},$$._addCombineRenderObjTest=function($$){var $b=$$.renderObj,$u=this._currentCombineIndexCount+$b._getIndexBuffer().indexCount,$Z=this._currentCombineVertexCount+$b._getVertexBuffer().vertexCount;return!($S.maxVertexCount<$Z||$S.maxIndexCount<$u)},$$._addCombineRenderObj=function($$){var $b=$$.renderObj;this._combineRenderElements.push($$),this._currentCombineIndexCount=this._currentCombineIndexCount+$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$b._getVertexBuffer().vertexCount},$$._addCombineMaterial=function($$){this._materials.push($$)},$$._addMaterialToRenderElementOffset=function($$){this._materialToRenderElementsOffsets.push($$)},$$._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$$._addToRenderQueue=function($$,$b,$u,$Z){this._getRenderElement($b,$u,$Z);for(var $E=0,$r=this._materials.length;$E<$r;$E++)$$.getRenderQueue(this._materials[$E].renderQueue)._addDynamicBatchElement(this._merageElements[$E])},$$._beforeRender=function($$){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$$._render=function($$){var $b=$$._batchIndexEnd-$$._batchIndexStart;$O.mainContext.drawElements(4,$b,5123,2*$$._batchIndexStart),$q.drawCall++,$q.trianglesFaces+=$b/3},$$._getVertexBuffers=function(){return null},$D(0,$$,"_vertexBufferCount",function(){return 1}),$D(0,$$,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$D(0,$$,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$S.maxVertexCount=2e4,$S.maxIndexCount=4e4,$S.maxCombineTriangleCount=10,$S}(),$b$=function(){function $S(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$N($S,"laya.d3.graphics.DynamicBatchManager");var $$=$S.prototype;return $$.getDynamicBatch=function($$,$b){var $u,$Z=$$.id.toString()+$b;return this._dynamicBatches[$Z]?$u=this._dynamicBatches[$Z]:this._dynamicBatches[$Z]=$u=new $$$($$),$u},$$._garbageCollection=function(){for(var $$ in this._dynamicBatches)0===this._dynamicBatches[$$].combineRenderElementsCount&&delete this._dynamicBatches[$$]},$$._addPrepareRenderElement=function($$){this._prepareDynamicBatchCombineElements.push($$)},$$._finishCombineDynamicBatch=function($$){var $b,$u,$Z;this._prepareDynamicBatchCombineElements.sort($S._sortPrepareDynamicBatch);for(var $E,$r,$F,$x,$g,$H=-1,$w=!0,$I=0,$o=-1,$N=0,$D=this._prepareDynamicBatchCombineElements.length;$N<$D;$N++){var $e=($r=this._prepareDynamicBatchCombineElements[$N]).renderObj._getVertexBuffer(0).vertexDeclaration,$L=$u!==$e;$L&&($I=0,$u=$e);var $T=$I!==$H;if($T&&($H=$I),($L||$T)&&($F=this.getDynamicBatch($e,$I),$b=null),$w)if($F._addCombineRenderObjTest($r)){if($b!==($E=$r._material))$x&&($$.getRenderQueue($g._material.renderQueue)._addRenderElement($g),$g=$x=null,$o=-1),$x=$E,$o=$F.combineRenderElementsCount,$g=$r,$b=$E;else if($x){var $_=$g.renderObj,$y=$r.renderObj;$_._getVertexBuffer().vertexCount+$y._getVertexBuffer().vertexCount>$$$.maxVertexCount||$_._getIndexBuffer().indexCount+$y._getIndexBuffer().indexCount>$$$.maxIndexCount?($$.getRenderQueue($g._material.renderQueue)._addRenderElement($g),$x=$E,$o=$F.combineRenderElementsCount,$g=$r):($F._addCombineMaterial($x),$F._addMaterialToRenderElementOffset($o),$F._addCombineRenderObj($g),$g=$x=null,$o=-1,$F._addCombineRenderObj($r))}else $F._addCombineRenderObj($r);$w=!0}else $x&&($$.getRenderQueue($g._material.renderQueue)._addRenderElement($g),$g=$x=null,$o=-1),$I++,$w=!1;else $Z=this._prepareDynamicBatchCombineElements[$N-1],$F._addMaterialToRenderElementOffset($F.combineRenderElementsCount),$b=$Z._material,$F._addCombineMaterial($b),$F._addCombineRenderObj($Z),$w=!0,$b!==($E=$r._material)?($x=$E,$o=$F.combineRenderElementsCount,$g=$r):$F._addCombineRenderObj($r),$b=$E}$x&&($$.getRenderQueue($g._material.renderQueue)._addRenderElement($g),$g=$x=null,$o=-1),this._prepareDynamicBatchCombineElements.length=0},$$._clearRenderElements=function(){for(var $$ in this._dynamicBatches)this._dynamicBatches[$$]._clearRenderElements()},$$._addToRenderQueue=function($$,$b,$u,$Z){for(var $E in this._dynamicBatches){var $r=this._dynamicBatches[$E];0<$r.combineRenderElementsCount&&$r._addToRenderQueue($$,$b,$u,$Z)}},$$.dispose=function(){this._dynamicBatches=null},$S._sortPrepareDynamicBatch=function($$,$b){return $$._mainSortID-$b._mainSortID},$S}(),$u$=function(){function $$(){}return $N($$,"laya.d3.graphics.FrustumCulling"),$$.renderShadowObjectCulling=function($$,$b,$u,$Z,$E){var $r=0,$F=0,$x=0,$g=0;for($r=0,$x=$u.length;$r<$x;$r++){var $H=$u[$r];$H&&$H._clearRenderElements()}var $w,$I,$o,$N=$$._cullingRenders;if(1<$E){for($r=0,$x=$$._cullingRendersLength;$r<$x;$r++)if(($w=$N[$r]).castShadow&&$p.isVisible($w._owner.layer.mask)&&$w.enable)for(var $D=1,$e=$b.length;$D<$e;$D++)if($I=$u[$D-1],0!==$b[$D].containsBoundSphere($w.boundingSphere))for($F=0,$g=($o=$w._renderElements).length;$F<$g;$F++)$I._addRenderElement($o[$F])}else for($r=0,$x=$$._cullingRendersLength;$r<$x;$r++)if(($w=$N[$r]).castShadow&&$p.isVisible($w._owner.layer.mask)&&$w.enable&&0!==$b[0].containsBoundSphere($w.boundingSphere))for($w._renderUpdate($Z),$I=$u[0],$F=0,$g=($o=$w._renderElements).length;$F<$g;$F++)$I._addRenderElement($o[$F])},$$.renderShadowObjectCullingOctree=function($$,$b,$u,$Z,$E){for(var $r=0,$F=$u.length;$r<$F;$r++){var $x=$u[$r];$x&&$x._clearRenderElements()}1<$E?$$.treeRoot.cullingShadowObjects($b,$u,!0,0,$$):$$.treeRoot.cullingShadowObjectsOnePSSM($b[0],$u,$Z,!0,0,$$)},$$.renderObjectCulling=function($$,$b,$u,$Z,$E,$r){var $F=0,$x=0,$g=0,$H=0,$w=$b._quenes,$I=$b._dynamicBatchManager,$o=$b._cullingRenders;for($F=0,$x=$w.length;$F<$x;$F++){var $N=$w[$F];$N&&$N._clearRenderElements()}var $D=$Z$._staticBatchManagers;for($F=0,$x=$D.length;$F<$x;$F++)$D[$F]._clearRenderElements();$I._clearRenderElements();var $e=$u.transform.position;for($F=0,$x=$b._cullingRendersLength;$F<$x;$F++){var $L=$o[$F];if($p.isVisible($L._owner.layer.mask)&&$L.enable&&0!==$$.containsBoundSphere($L.boundingSphere)&&$L._renderUpdate($r)){$L._distanceForSort=$Fb.distance($L.boundingSphere.center,$e)+$L.sortingFudge;var $T=$L._renderElements;for($g=0,$H=$T.length;$g<$H;$g++){var $_=$T[$g],$y=$_._staticBatch;if($y&&$y._material===$_._material)$y._addBatchRenderElement($_);else{var $S=$_.renderObj;$S.triangleCount<10&&1===$S._vertexBufferCount&&$S._getIndexBuffer()&&$_._material.renderQueue<2&&$_._canDynamicBatch&&!$L._owner.isStatic?$I._addPrepareRenderElement($_):$b.getRenderQueue($_._material.renderQueue)._addRenderElement($_)}}}}for($F=0,$x=$D.length;$F<$x;$F++)$D[$F]._addToRenderQueue($b,$Z,$E,$r);$I._finishCombineDynamicBatch($b),$I._addToRenderQueue($b,$Z,$E,$r)},$$.renderObjectCullingOctree=function($$,$b,$u,$Z,$E,$r){var $F=0,$x=0,$g=$b._quenes,$H=$b._dynamicBatchManager;for($F=0,$x=$g.length;$F<$x;$F++){var $w=$g[$F];$w&&$w._clearRenderElements()}var $I=$Z$._staticBatchManagers;for($F=0,$x=$I.length;$F<$x;$F++)$I[$F]._clearRenderElements();for($H._clearRenderElements(),$b._cullingRenders.length=0,$b.treeRoot.cullingObjects($$,!0,0,$u.transform.position,$r),$F=0,$x=$I.length;$F<$x;$F++)$I[$F]._addToRenderQueue($b,$Z,$E,$r);$H._finishCombineDynamicBatch($b),$H._addToRenderQueue($b,$Z,$E,$r)},$$.renderObjectCullingNoBoundFrustum=function($$,$b,$u,$Z,$E){var $r=0,$F=0,$x=0,$g=0,$H=$$._quenes,$w=$$._dynamicBatchManager,$I=$$._cullingRenders;for($r=0,$F=$H.length;$r<$F;$r++){var $o=$H[$r];$o&&$o._clearRenderElements()}var $N=$Z$._staticBatchManagers;for($r=0,$F=$N.length;$r<$F;$r++)$N[$r]._clearRenderElements();$w._clearRenderElements();var $D=$b.transform.position;for($r=0,$F=$$._cullingRendersLength;$r<$F;$r++){var $e=$I[$r];if($p.isVisible($e._owner.layer.mask)&&$e.enable){$e._renderUpdate($E),$e._distanceForSort=$Fb.distance($e.boundingSphere.center,$D)+$e.sortingFudge;var $L=$e._renderElements;for($x=0,$g=$L.length;$x<$g;$x++){var $T=$L[$x],$_=$T._staticBatch;if($_&&$_._material===$T._material)$_._addBatchRenderElement($T);else{var $y=$T.renderObj;$y.triangleCount<10&&1===$y._vertexBufferCount&&$y._getIndexBuffer()&&$T._material.renderQueue<2&&$T._canDynamicBatch&&!$e._owner.isStatic?$w._addPrepareRenderElement($T):$$.getRenderQueue($T._material.renderQueue)._addRenderElement($T)}}}}for($r=0,$F=$N.length;$r<$F;$r++)$N[$r]._addToRenderQueue($$,$u,$Z,$E);$w._finishCombineDynamicBatch($$),$w._addToRenderQueue($$,$u,$Z,$E)},$$}(),$Z$=function(){function $r(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$N($r,"laya.d3.graphics.StaticBatchManager");var $$=$r.prototype;return $$._finishInit=function(){for(var $$ in this._staticBatches)this._staticBatches[$$]._finishInit();this._initBatchRenderElements.length=0},$$._initStaticBatchs=function($$){throw new Error("StaticBatchManager:must override this function.")},$$._addInitBatchSprite=function($$){for(var $b=$$._render._renderElements,$u=0,$Z=$b.length;$u<$Z;$u++)this._initBatchRenderElements.push($b[$u])},$$._clearRenderElements=function(){for(var $$ in this._staticBatches)this._staticBatches[$$]._clearRenderElements()},$$._garbageCollection=function($$){var $b=$$._staticBatch,$u=$b._initBatchRenderElements,$Z=$u.indexOf($$);$u.splice($Z,1),0===$u.length&&($b.dispose(),delete this._staticBatches[$b._key])},$$._addToRenderQueue=function($$,$b,$u,$Z){for(var $E in this._staticBatches){var $r=this._staticBatches[$E];0<$r._batchRenderElements.length&&$r._updateToRenderQueue($$,$Z)}},$$.dispose=function(){this._staticBatches=null},$r._addToStaticBatchQueue=function($$){$$ instanceof laya.d3.core.RenderableSprite3D&&$$._addToInitStaticBatchManager();for(var $b=0,$u=$$.numChildren;$b<$u;$b++)$r._addToStaticBatchQueue($$._childs[$b])},$r.combine=function($$,$b){var $u,$Z=0,$E=0;if($b)for($Z=0,$E=$b.length;$Z<$E;$Z++){$b[$Z]._addToInitStaticBatchManager()}else $$&&$r._addToStaticBatchQueue($$);for($Z=0,$E=$r._staticBatchManagers.length;$Z<$E;$Z++)($u=$r._staticBatchManagers[$Z])._initStaticBatchs($$),$u._finishInit()},$r._staticBatchManagers=[],$r}(),$E$=function(){function $$($$,$b,$u){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$$,this._manager=$b,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$u}$N($$,"laya.d3.graphics.StaticBatch");var $b=$$.prototype;return $P.imps($b,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$b._binarySearch=function($$){for(var $b=0,$u=this._batchRenderElements.length-1,$Z=0;$b<=$u;)$Z=Math.floor(($b+$u)/2),this._compareBatchRenderElement(this._batchRenderElements[$Z],$$)?$u=$Z-1:$b=$Z+1;return $b},$b._compareBatchRenderElement=function($$,$b){throw new Error("StaticBatch:must override this function.")},$b._getVertexDecLightMap=function($$){return $$===$X$.vertexDeclaration?$p$.vertexDeclaration:$$===$l$.vertexDeclaration?$v$.vertexDeclaration:$$===$a$.vertexDeclaration?$S$.vertexDeclaration:$$===$c$.vertexDeclaration?null:$$===$e$.vertexDeclaration?$L$.vertexDeclaration:$$===$m$.vertexDeclaration?$k$.vertexDeclaration:$$===$O$.vertexDeclaration?$V$.vertexDeclaration:$$===$s$.vertexDeclaration?$Y$.vertexDeclaration:$$===$l$.vertexDeclaration?$v$.vertexDeclaration:$$===$t$.vertexDeclaration?$P$.vertexDeclaration:$$===$c$.vertexDeclaration?null:$$===$e$.vertexDeclaration?$L$.vertexDeclaration:$$===$n$.vertexDeclaration?$M$.vertexDeclaration:$$===$O$.vertexDeclaration?$V$.vertexDeclaration:$$},$b._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$b._addBatchRenderElement=function($$){this._batchRenderElements.splice(this._binarySearch($$),0,$$)},$b._updateToRenderQueue=function($$,$b){this._combineRenderElementPoolIndex=0,this._getRenderElement($$.getRenderQueue(this._material.renderQueue)._renderElements,$$,$b)},$b._getRenderElement=function($$,$b,$u){throw new Error("StaticBatch:must override this function.")},$b._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$b._clearRenderElements=function(){this._batchRenderElements.length=0},$b.dispose=function(){},$b._getVertexBuffer=function($$){return void 0===$$&&($$=0),null},$b._getIndexBuffer=function(){return null},$b._beforeRender=function($$){return!0},$b._render=function($$){},$b._getVertexBuffers=function(){return null},$D(0,$b,"_vertexBufferCount",function(){return 1}),$D(0,$b,"triangleCount",function(){return 0}),$$.combine=function($$){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$Z$.combine($$)},$$.maxBatchVertexCount=65535,$$}(),$r$=function(){function $F($$,$b){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$F._uniqueIDCounter,this._id>$F.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$F.maxVertexDeclaration);this._shaderValues=new $ob,this._vertexElementsDic={},this._vertexStride=$$,this._vertexElements=$b;for(var $u=0;$u<$b.length;$u++){var $Z=$b[$u],$E=$Z.elementUsage;this._vertexElementsDic[$E]=$Z;var $r=[$F._getTypeSize($Z.elementFormat)/4,5126,!1,this._vertexStride,$Z.offset];switch(this._shaderValues.setValue($E,$r),$E){case 1:this._addShaderDefine($qb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($qb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($qb.SHADERDEFINE_UV1)}}}$N($F,"laya.d3.graphics.VertexDeclaration");var $$=$F.prototype;return $$._addShaderDefine=function($$){this._shaderDefineValue|=$$},$$._removeShaderDefine=function($$){this._shaderDefineValue&=~$$},$$.getVertexElements=function(){return this._vertexElements.slice()},$$.getVertexElementByUsage=function($$){return this._vertexElementsDic[$$]},$$.unBinding=function(){},$D(0,$$,"shaderDefineValue",function(){return this._shaderDefineValue}),$D(0,$$,"id",function(){return this._id}),$D(0,$$,"vertexStride",function(){return this._vertexStride}),$D(0,$$,"shaderValues",function(){return this._shaderValues}),$F._getTypeSize=function($$){switch($$){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$F.getVertexStride=function($$){for(var $b=0,$u=0;$u<$$.Length;$u++){var $Z=$$[$u],$E=$Z.offset+$F._getTypeSize($Z.elementFormat);$b<$E&&($b=$E)}return $b},$F._maxVertexDeclarationBit=1e3,$F._uniqueIDCounter=1,$I($F,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$F}(),$F$=function(){function $$($$,$b,$u){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$$,this.elementFormat=$b,this.elementUsage=$u}return $N($$,"laya.d3.graphics.VertexElement"),$$}(),$x$=(function(){function $$(){}$N($$,"laya.d3.graphics.VertexElementFormat"),$$.Single="single",$$.Vector2="vector2",$$.Vector3="vector3",$$.Vector4="vector4",$$.Color="color",$$.Byte4="byte4",$$.Short2="short2",$$.Short4="short4",$$.NormalizedShort2="normalizedshort2",$$.NormalizedShort4="normalizedshort4",$$.HalfVector2="halfvector2",$$.HalfVector4="halfvector4"}(),function(){function $$(){}$N($$,"laya.d3.graphics.VertexElementUsage"),$$.POSITION0=0,$$.COLOR0=1,$$.TEXTURECOORDINATE0=2,$$.NORMAL0=3,$$.BINORMAL0=4,$$.TANGENT0=5,$$.BLENDINDICES0=6,$$.BLENDWEIGHT0=7,$$.DEPTH0=8,$$.FOG0=9,$$.POINTSIZE0=10,$$.SAMPLE0=11,$$.TESSELLATEFACTOR0=12,$$.COLOR1=13,$$.NEXTTEXTURECOORDINATE0=14,$$.TEXTURECOORDINATE1=15,$$.NEXTTEXTURECOORDINATE1=16,$$.CORNERTEXTURECOORDINATE0=17,$$.VELOCITY0=18,$$.STARTCOLOR0=19,$$.STARTSIZE=20,$$.AGEADDSCALE0=21,$$.STARTROTATION=22,$$.ENDCOLOR0=23,$$.STARTLIFETIME=24,$$.TIME0=33,$$.SHAPEPOSITIONSTARTLIFETIME=30,$$.DIRECTIONTIME=32,$$.SIZEROTATION0=27,$$.RADIUS0=28,$$.RADIAN0=29,$$.STARTSPEED=31,$$.RANDOM0=34,$$.RANDOM1=35,$$.SIMULATIONWORLDPOSTION=36,$$.SIMULATIONWORLDROTATION=37,$$.TEXTURECOORDINATE0X=38,$$.TEXTURECOORDINATE0X1=39,$$.TEXTURECOORDINATE0Y=40,$$.OFFSETVECTOR=41}(),function(){function $$($$,$b,$u){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$$,this._textureCoordinate0=$b,this._time=$u}$N($$,"laya.d3.graphics.VertexGlitter");var $b=$$.prototype;$P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate0}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"time",function(){return this._time}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(24,[new $F$(0,"vector3",0),new $F$(12,"vector2",2),new $F$(20,"single",33)])}])}(),function(){function $$($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$$,this._position=$b,this._velocity=$u,this._startColor=$Z,this._endColor=$E,this._sizeRotation=$r,this._radius=$F,this._radian=$x,this._ageAddScale=$g,this._time=$H}$N($$,"laya.d3.graphics.VertexParticle");var $b=$$.prototype;$P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"endColor",function(){return this._endColor}),$D(0,$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$D(0,$b,"sizeRotation",function(){return this._sizeRotation}),$D(0,$b,"velocity",function(){return this._velocity}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"startColor",function(){return this._startColor}),$D(0,$b,"radius",function(){return this._radius}),$D(0,$b,"radian",function(){return this._radian}),$D(0,$b,"ageAddScale",function(){return this._ageAddScale}),$D(0,$b,"time",function(){return this._time}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(116,[new $F$(0,"vector4",17),new $F$(16,"vector3",0),new $F$(28,"vector3",18),new $F$(40,"vector4",19),new $F$(56,"vector4",23),new $F$(72,"vector3",27),new $F$(84,"vector2",28),new $F$(92,"vector4",29),new $F$(108,"single",24),new $F$(112,"single",33)])}])}(),function(){function $$($$){this._position=null,this._position=$$}$N($$,"laya.d3.graphics.VertexPosition");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(12,[new $F$(0,"vector3",0)])}]),$$}()),$g$=function(){function $$($$,$b){this._position=null,this._normal=null,this._position=$$,this._normal=$b}$N($$,"laya.d3.graphics.VertexPositionNormal");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(24,[new $F$(0,"vector3",0),new $F$(12,"vector3",3)])}]),$$}(),$H$=function(){function $$($$,$b,$u){this._position=null,this._normal=null,this._color=null,this._position=$$,this._normal=$b,this._color=$u}$N($$,"laya.d3.graphics.VertexPositionNormalColor");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(40,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1)])}]),$$}(),$w$=function(){function $$($$,$b,$u,$Z,$E){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$$,this._normal=$b,this._color=$u,this._blendIndex=$Z,this._blendWeight=$E}$N($$,"laya.d3.graphics.VertexPositionNormalColorSkin");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(72,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector4",7),new $F$(56,"vector4",6)])}]),$$}(),$I$=function(){function $$($$,$b,$u,$Z,$E,$r){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._tangent=$Z,this._blendIndex=$E,this._blendWeight=$r}$N($$,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(88,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector4",7),new $F$(56,"vector4",6),new $F$(72,"vector4",5)])}]),$$}(),$o$=function(){function $$($$,$b,$u,$Z,$E,$r){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._tangent=$Z,this._blendIndex=$E,this._blendWeight=$r}$N($$,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(84,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector4",7),new $F$(56,"vector4",6),new $F$(72,"vector3",5)])}]),$$}(),$N$=function(){function $$($$,$b,$u,$Z){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._tangent=$Z}$N($$,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(56,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector4",5)])}]),$$}(),$D$=function(){function $$($$,$b,$u,$Z){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._tangent=$Z}$N($$,"laya.d3.graphics.VertexPositionNormalColorTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(52,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector3",5)])}]),$$}(),$e$=function(){function $$($$,$b,$u,$Z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate=$Z}$N($$,"laya.d3.graphics.VertexPositionNormalColorTexture");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(48,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2)])}]),$$}(),$L$=function(){function $$($$,$b,$u,$Z,$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate0=$Z,this._textureCoordinate1=$E}$N($$,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(56,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector2",15)])}]),$$}(),$T$=function(){function $$($$,$b,$u,$Z,$E,$r,$F){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate0=$Z,this._textureCoordinate1=$E,this._blendIndex=$r,this._blendWeight=$F}$N($$,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(88,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector2",15),new $F$(56,"vector4",7),new $F$(72,"vector4",6)])}]),$$}(),$_$=function(){function $$($$,$b,$u,$Z,$E,$r,$F,$x){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate0=$Z,this._textureCoordinate1=$E,this._tangent=$r,this._blendIndex=$F,this._blendWeight=$x}$N($$,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(104,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector2",15),new $F$(56,"vector4",7),new $F$(72,"vector4",6),new $F$(88,"vector4",5)])}]),$$}(),$y$=function(){function $$(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$N($$,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$b.VertexPositionNormalColorTexture0SkinTangent=function($$,$b,$u,$Z,$E,$r,$F,$x){this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate0=$Z,this._textureCoordinate1=$E,this._tangent=$r,this._blendIndex=$F,this._blendWeight=$x},$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(100,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector2",15),new $F$(56,"vector4",7),new $F$(72,"vector4",6),new $F$(88,"vector3",5)])}]),$$}(),$S$=function(){function $$($$,$b,$u,$Z,$E,$r){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate0=$Z,this._textureCoordinate1=$E,this._tangent=$r}$N($$,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(72,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector2",15),new $F$(56,"vector4",5)])}]),$$}(),$P$=function(){function $$(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$N($$,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$b.VertexPositionNormalColorTexture0Tangent=function($$,$b,$u,$Z,$E,$r){this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate0=$Z,this._textureCoordinate1=$E,this._tangent=$r},$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(68,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector2",15),new $F$(56,"vector3",5)])}]),$$}(),$i$=function(){function $$($$,$b,$u,$Z,$E,$r){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate=$Z,this._blendIndex=$E,this._blendWeight=$r}$N($$,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(80,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector4",7),new $F$(64,"vector4",6)])}]),$$}(),$z$=function(){function $$($$,$b,$u,$Z,$E,$r,$F){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate=$Z,this._tangent=$E,this._blendIndex=$r,this._blendWeight=$F}$N($$,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(96,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector4",7),new $F$(64,"vector4",6),new $F$(80,"vector4",5)])}]),$$}(),$q$=function(){function $$($$,$b,$u,$Z,$E,$r,$F){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate=$Z,this._tangent=$E,this._blendIndex=$r,this._blendWeight=$F}$N($$,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(92,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector4",7),new $F$(64,"vector4",6),new $F$(80,"vector3",5)])}]),$$}(),$a$=function(){function $$($$,$b,$u,$Z,$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate=$Z,this._tangent=$E}$N($$,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(64,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector4",5)])}]),$$}(),$t$=function(){function $$($$,$b,$u,$Z,$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$$,this._normal=$b,this._color=$u,this._textureCoordinate=$Z,this._tangent=$E}$N($$,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"color",function(){return this._color}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(60,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",1),new $F$(40,"vector2",2),new $F$(48,"vector3",5)])}]),$$}(),$C$=function(){function $$($$,$b,$u){this._position=null,this._normal=null,this._tangent=null,this._position=$$,this._normal=$b,this._tangent=$u}$N($$,"laya.d3.graphics.VertexPositionNormalSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(40,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector4",5)])}]),$$}(),$K$=function(){function $$($$,$b,$u){this._position=null,this._normal=null,this._tangent=null,this._position=$$,this._normal=$b,this._tangent=$u}$N($$,"laya.d3.graphics.VertexPositionNormalTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(36,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector3",5)])}]),$$}(),$O$=function(){function $$($$,$b,$u){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u}$N($$,"laya.d3.graphics.VertexPositionNormalTexture");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(32,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2)])}]),$$}(),$V$=function(){function $$($$,$b,$u,$Z){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$$,this._normal=$b,this._textureCoordinate0=$u,this._textureCoordinate1=$Z}$N($$,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(40,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector2",15)])}]),$$}(),$v$=function(){function $$($$,$b,$u,$Z,$E,$r){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$$,this._normal=$b,this._textureCoordinate0=$u,this._textureCoordinate1=$Z,this._blendIndex=$E,this._blendWeight=$r}$N($$,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(72,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector2",15),new $F$(40,"vector4",7),new $F$(56,"vector4",6)])}]),$$}(),$p$=function(){function $$($$,$b,$u,$Z,$E,$r,$F){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._textureCoordinate0=$u,this._textureCoordinate1=$Z,this._tangent=$E,this._blendIndex=$r,this._blendWeight=$F}$N($$,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(88,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector2",15),new $F$(40,"vector4",7),new $F$(56,"vector4",6),new $F$(72,"vector4",5)])}]),$$}(),$Y$=function(){function $$(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$N($$,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$b.VertexPositionNormalTexture0SkinTangent=function($$,$b,$u,$Z,$E,$r,$F){this._position=$$,this._normal=$b,this._textureCoordinate0=$u,this._textureCoordinate1=$Z,this._tangent=$E,this._blendIndex=$r,this._blendWeight=$F},$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(84,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector2",15),new $F$(40,"vector4",7),new $F$(56,"vector4",6),new $F$(72,"vector3",5)])}]),$$}(),$k$=function(){function $$($$,$b,$u,$Z,$E){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$$,this._normal=$b,this._textureCoordinate0=$u,this._textureCoordinate1=$Z,this._tangent=$E}$N($$,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(56,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector2",15),new $F$(40,"vector4",5)])}]),$$}(),$M$=function(){function $$(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$N($$,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$b.VertexPositionNormalTexture0Tangent=function($$,$b,$u,$Z,$E){this._position=$$,this._normal=$b,this._textureCoordinate0=$u,this._textureCoordinate1=$Z,this._tangent=$E},$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(52,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector2",15),new $F$(40,"vector3",5)])}]),$$}(),$l$=function(){function $$($$,$b,$u,$Z,$E){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u,this._blendIndex=$Z,this._blendWeight=$E}$N($$,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(64,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector4",7),new $F$(48,"vector4",6)])}]),$$}(),$X$=function(){function $$($$,$b,$u,$Z,$E,$r){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u,this._tangent=$Z,this._blendIndex=$E,this._blendWeight=$r}$N($$,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(80,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector4",7),new $F$(48,"vector4",6),new $F$(64,"vector4",5)])}]),$$}(),$s$=function(){function $$($$,$b,$u,$Z,$E,$r){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u,this._tangent=$Z,this._blendIndex=$E,this._blendWeight=$r}$N($$,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(76,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector4",7),new $F$(48,"vector4",6),new $F$(64,"vector3",5)])}]),$$}(),$m$=function(){function $$($$,$b,$u,$Z){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u,this._tangent=$Z}$N($$,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(48,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector4",5)])}]),$$}(),$n$=function(){function $$($$,$b,$u,$Z){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u,this._tangent=$Z}$N($$,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(44,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector3",5)])}]),$$}(),$c$=function(){function $$($$,$b,$u){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u}$N($$,"laya.d3.graphics.VertexPositionNTBTexture");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(56,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector3",5),new $F$(36,"vector3",4),new $F$(48,"vector2",2)])}]),$$}(),$J$=function(){function $$($$,$b,$u,$Z,$E,$r,$F,$x){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$$,this._normal=$b,this._textureCoordinate0=$Z,this._textureCoordinate1=$E,this._tangent=$r,$u=$u,this._blendIndex=$F,this._blendWeight=$x}$N($$,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"tangent",function(){return this._tangent}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(0,$b,"textureCoordinate1",function(){return this._textureCoordinate1}),$D(0,$b,"blendIndex",function(){return this._blendIndex}),$D(0,$b,"blendWeight",function(){return this._blendWeight}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(96,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector3",5),new $F$(36,"vector3",4),new $F$(48,"vector2",2),new $F$(56,"vector2",15),new $F$(64,"vector4",7),new $F$(80,"vector4",6)])}]),$$}(),$f$=function(){function $$($$,$b,$u){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$$,this._normal=$b,this._textureCoordinate=$u}$N($$,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"textureCoordinate",function(){return this._textureCoordinate}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(88,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector3",5),new $F$(36,"vector3",4),new $F$(48,"vector2",2),new $F$(56,"vector4",7),new $F$(72,"vector4",6)])}]),$$}(),$Q$=(function(){function $$($$,$b,$u,$Z){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$$,this._normal=$b,this._textureCoord0=$u,this._textureCoord1=$Z}$N($$,"laya.d3.graphics.VertexPositionTerrain");var $b=$$.prototype;$P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"normal",function(){return this._normal}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoord0",function(){return this._textureCoord0}),$D(0,$b,"textureCoord1",function(){return this._textureCoord1}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(40,[new $F$(0,"vector3",0),new $F$(12,"vector3",3),new $F$(24,"vector2",2),new $F$(32,"vector2",15)])}])}(),function(){function $$($$,$b){this._position=null,this._textureCoordinate0=null,this._position=$$,this._textureCoordinate0=$b}$N($$,"laya.d3.graphics.VertexPositionTexture0");var $b=$$.prototype;return $P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"position",function(){return this._position}),$D(0,$b,"textureCoordinate0",function(){return this._textureCoordinate0}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(20,[new $F$(0,"vector3",0),new $F$(12,"vector2",2)])}]),$$}()),$W$=(function(){function $$($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I,$o,$N){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$$,this._positionStartLifeTime=$b,this._velocity=$u,this._startColor=$Z,this._startSize=$E,this._startRotation0=$r,this._startRotation1=$F,this._startRotation2=$x,this._startLifeTime=$g,this._time=$H,this._startSpeed=$w,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$N}$N($$,"laya.d3.graphics.VertexShurikenParticleBillboard");var $b=$$.prototype;$P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$D(0,$b,"random1",function(){return this._randoms1}),$D(0,$b,"startRotation2",function(){return this._startRotation2}),$D(0,$b,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$D(0,$b,"velocity",function(){return this._velocity}),$D(0,$b,"random0",function(){return this._randoms0}),$D(0,$b,"startSize",function(){return this._startSize}),$D(0,$b,"startColor",function(){return this._startColor}),$D(0,$b,"startRotation0",function(){return this._startRotation0}),$D(0,$b,"startRotation1",function(){return this._startRotation1}),$D(0,$b,"startLifeTime",function(){return this._startLifeTime}),$D(0,$b,"time",function(){return this._time}),$D(0,$b,"startSpeed",function(){return this._startSpeed}),$D(0,$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(152,[new $F$(0,"vector4",17),new $F$(16,"vector4",30),new $F$(32,"vector4",32),new $F$(48,"vector4",19),new $F$(64,"vector3",20),new $F$(76,"vector3",22),new $F$(88,"single",31),new $F$(92,"vector4",34),new $F$(108,"vector4",35),new $F$(124,"vector3",36),new $F$(136,"vector4",37)])}])}(),function(){function $$($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I,$o,$N){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$$,this._positionStartLifeTime=$b,this._velocity=$u,this._startColor=$Z,this._startSize=$E,this._startRotation0=$r,this._startRotation1=$F,this._startRotation2=$x,this._startLifeTime=$g,this._time=$H,this._startSpeed=$w,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$N}$N($$,"laya.d3.graphics.VertexShurikenParticleMesh");var $b=$$.prototype;$P.imps($b,{"laya.d3.graphics.IVertex":!0}),$D(0,$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$D(0,$b,"velocity",function(){return this._velocity}),$D(0,$b,"position",function(){return this._positionStartLifeTime}),$D(0,$b,"random0",function(){return this._randoms0}),$D(0,$b,"startSize",function(){return this._startSize}),$D(0,$b,"startColor",function(){return this._startColor}),$D(0,$b,"startRotation0",function(){return this._startRotation0}),$D(0,$b,"startRotation1",function(){return this._startRotation1}),$D(0,$b,"random1",function(){return this._randoms1}),$D(0,$b,"startRotation2",function(){return this._startRotation2}),$D(0,$b,"startLifeTime",function(){return this._startLifeTime}),$D(0,$b,"time",function(){return this._time}),$D(0,$b,"startSpeed",function(){return this._startSpeed}),$D(0,$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$D(0,$b,"vertexDeclaration",function(){return $$._vertexDeclaration}),$D(1,$$,"vertexDeclaration",function(){return $$._vertexDeclaration}),$I($$,["_vertexDeclaration",function(){return this._vertexDeclaration=new $r$(172,[new $F$(0,"vector3",0),new $F$(12,"vector4",1),new $F$(28,"vector2",2),new $F$(36,"vector4",30),new $F$(52,"vector4",32),new $F$(68,"vector4",19),new $F$(84,"vector3",20),new $F$(96,"vector3",22),new $F$(108,"single",31),new $F$(112,"vector4",34),new $F$(128,"vector4",35),new $F$(144,"vector3",36),new $F$(156,"vector4",37)])}])}(),function(){function $y($$,$b,$u,$Z,$E,$r){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$u,this._materials=$Z,this._subMeshes=$E,this._materialMap=$r,this._version=$b,this._onLoaded($$)}$N($y,"laya.d3.loaders.LoadModelV01");var $$=$y.prototype;return $$._onLoaded=function($$){this._readData=$$,this.READ_BLOCK();for(var $b=0;$b<this._BLOCK.count;$b++){var $u=this._readData.getUint16(),$Z=this._strings[$u],$E=this["READ_"+$Z];if(null==$E)throw new Error("model file err,no this function:"+$u+" "+$Z);if(!$E.call(this))break}return this._mesh},$$.onError=function(){},$$._readString=function(){return this._strings[this._readData.getUint16()]},$$.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$$.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$$.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $$=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $b=0;$b<this._STRINGS.size;$b++)this._strings[$b]=this._readData.readUTFString();return this._readData.pos=$$,!0},$$.READ_MATERIAL=function(){var $$=this._readData.getUint16(),$b=(this._readString(),this._readString());return this._materials[$$]="null"!==$b?$T.getRes(this._materialMap[$b]):new $Kb,!0},$$.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $$,$b=this._readData.__getBuffer(),$u=0,$Z=this._readData.getUint32(),$E=this._readData.getUint32(),$r=(new Float32Array($b.slice($Z+this._DATA.offset,$Z+this._DATA.offset+$E)),this._readData.getUint32()),$F=this._readData.getUint32(),$x=new Float32Array($b.slice($r+this._DATA.offset,$r+this._DATA.offset+$F));for(this.mesh._inverseBindPoses=[],$u=0,$$=$x.length;$u<$$;$u+=16){var $g=new $$b($x[$u+0],$x[$u+1],$x[$u+2],$x[$u+3],$x[$u+4],$x[$u+5],$x[$u+6],$x[$u+7],$x[$u+8],$x[$u+9],$x[$u+10],$x[$u+11],$x[$u+12],$x[$u+13],$x[$u+14],$x[$u+15]);this.mesh._inverseBindPoses.push($g)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$$.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $$=this._readString();this._shaderAttributes=$$.match($y._attrReg);var $b=this._readData.getUint32(),$u=this._readData.getUint32(),$Z=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$E=this._readData.getUint32(),$r=this._readData.getUint32(),$F=this._readData.getUint32(),$x=this._readData.__getBuffer(),$g=new $Hb(this._mesh),$H=this._getVertexDeclaration(),$w=$sb.create($H,$E/$H.vertexStride,35044,!0),$I=$Z+this._DATA.offset,$o=$x.slice($I,$I+$E);$w.setData(new Float32Array($o));for(var $N=($g._vertexBuffer=$w).vertexDeclaration.getVertexElements(),$D=0;$D<$N.length;$D++)$g._bufferUsage[$N[$D].elementUsage]=$w;var $e=$Xb.create("ushort",$u/2,35044,!0),$L=$b+this._DATA.offset,$T=$x.slice($L,$L+$u);$e.setData(new Uint16Array($T)),$g._indexBuffer=$e;var $_=$x.slice($r+this._DATA.offset,$r+this._DATA.offset+$F);return $g._boneIndicesList[0]=new Uint8Array($_),this._subMeshes.push($g),!0},$$.READ_DATAAREA=function(){return!1},$$._getVertexDeclaration=function(){for(var $$,$b=!1,$u=!1,$Z=!1,$E=!1,$r=!1,$F=!1,$x=!1,$g=!1,$H=!1,$w=0;$w<this._shaderAttributes.length;$w+=8)switch(this._shaderAttributes[$w]){case"POSITION":$b=!0;break;case"NORMAL":$u=!0;break;case"COLOR":$Z=!0;break;case"UV":$E=!0;break;case"UV1":$r=!0;break;case"BLENDWEIGHT":$x=!0;break;case"BLENDINDICES":$g=!0;break;case"TANGENT":$F=!0;break;case"BINORMAL":$H=!0}return $b&&$u&&$Z&&$E&&$r&&$x&&$g&&$F?$$=$y$.vertexDeclaration:$b&&$u&&$Z&&$E&&$r&&$x&&$g?$$=$T$.vertexDeclaration:$b&&$u&&$E&&$r&&$x&&$g&&$F?$$=$Y$.vertexDeclaration:$b&&$u&&$E&&$r&&$x&&$g?$$=$v$.vertexDeclaration:$b&&$u&&$Z&&$E&&$x&&$g&&$F?$$=$q$.vertexDeclaration:$b&&$u&&$Z&&$E&&$x&&$g?$$=$i$.vertexDeclaration:$b&&$u&&$F&&$H&&$E&&$x&&$g?$$=$f$.vertexDeclaration:$b&&$u&&$E&&$x&&$g&&$F?$$=$s$.vertexDeclaration:$b&&$u&&$E&&$x&&$g?$$=$l$.vertexDeclaration:$b&&$u&&$Z&&$x&&$g&&$F?$$=$o$.vertexDeclaration:$b&&$u&&$Z&&$x&&$g?$$=$w$.vertexDeclaration:$b&&$u&&$Z&&$E&&$r&&$F?$$=$P$.vertexDeclaration:$b&&$u&&$Z&&$E&&$r?$$=$L$.vertexDeclaration:$b&&$u&&$E&&$r&&$F?$$=$M$.vertexDeclaration:$b&&$u&&$E&&$r?$$=$V$.vertexDeclaration:$b&&$u&&$Z&&$E&&$F?$$=$t$.vertexDeclaration:$b&&$u&&$E&&$F&&$H?$$=$c$.vertexDeclaration:$b&&$u&&$Z&&$E?$$=$e$.vertexDeclaration:$b&&$u&&$E&&$F?$$=$n$.vertexDeclaration:$b&&$u&&$E?$$=$O$.vertexDeclaration:$b&&$u&&$Z&&$F?$$=$D$.vertexDeclaration:$b&&$u&&$Z&&($$=$H$.vertexDeclaration),$$},$D(0,$$,"mesh",function(){return this._mesh}),$y._attrReg=new RegExp("(\\w+)|([:,;])","g"),$y}()),$G$=function(){function $z(){}return $N($z,"laya.d3.loaders.LoadModelV02"),$z.parse=function($$,$b,$u,$Z,$E,$r){$z._mesh=$u,$z._materials=$Z,$z._subMeshes=$E,$z._materialMap=$r,$z._version=$b,$z._readData=$$,$z.READ_DATA(),$z.READ_BLOCK(),$z.READ_STRINGS();for(var $F=0,$x=$z._BLOCK.count;$F<$x;$F++){$z._readData.pos=$z._BLOCK.blockStarts[$F];var $g=$z._readData.getUint16(),$H=$z._strings[$g],$w=$z["READ_"+$H];if(null==$w)throw new Error("model file err,no this function:"+$g+" "+$H);$w.call()}$z._strings.length=0,$z._readData=null,$z._version=null,$z._mesh=null,$z._materials=null,$z._subMeshes=null,$z._materialMap=null},$z._readString=function(){return $z._strings[$z._readData.getUint16()]},$z.READ_DATA=function(){$z._DATA.offset=$z._readData.getUint32(),$z._DATA.size=$z._readData.getUint32()},$z.READ_BLOCK=function(){for(var $$=$z._BLOCK.count=$z._readData.getUint16(),$b=$z._BLOCK.blockStarts=[],$u=$z._BLOCK.blockLengths=[],$Z=0;$Z<$$;$Z++)$b.push($z._readData.getUint32()),$u.push($z._readData.getUint32())},$z.READ_STRINGS=function(){var $$=$z._readData.getUint32(),$b=$z._readData.getUint16(),$u=$z._readData.pos;$z._readData.pos=$$+$z._DATA.offset;for(var $Z=0;$Z<$b;$Z++)$z._strings[$Z]=$z._readData.readUTFString();$z._readData.pos=$u},$z.READ_MATERIAL=function(){$z._readString(),$z._readString();var $$=$z._readString();return""!==$$&&$z._materials.push($T.getRes($z._materialMap[$$])),!0},$z.READ_MESH=function(){$z._readString();var $$,$b=$z._readData.__getBuffer(),$u=0,$Z=$z._readData.getInt16(),$E=$z._DATA.offset;for($u=0;$u<$Z;$u++){var $r=$E+$z._readData.getUint32(),$F=$z._readData.getUint32(),$x=new Float32Array($b.slice($r,$r+$F)),$g=$z._readString().match($z._attrReg),$H=$z._getVertexDeclaration($g),$w=$sb.create($H,4*$x.length/$H.vertexStride,35044,!0);$w.setData($x),$z._mesh._vertexBuffers.push($w)}var $I=$E+$z._readData.getUint32(),$o=$z._readData.getUint32(),$N=new Uint16Array($b.slice($I,$I+$o)),$D=$Xb.create("ushort",$o/2,35044,!0);$D.setData($N),$z._mesh._indexBuffer=$D;var $e=$z._mesh._boneNames=[],$L=$z._readData.getUint16();for($e.length=$L,$u=0;$u<$L;$u++)$e[$u]=$z._strings[$z._readData.getUint16()];var $T=$z._readData.getUint32(),$_=$z._readData.getUint32(),$y=(new Float32Array($b.slice($E+$T,$E+$T+$_)),$z._readData.getUint32()),$S=$z._readData.getUint32(),$P=new Float32Array($b.slice($E+$y,$E+$y+$S));for($z._mesh._inverseBindPoses=[],$u=0,$$=$P.length;$u<$$;$u+=16){var $i=new $$b($P[$u+0],$P[$u+1],$P[$u+2],$P[$u+3],$P[$u+4],$P[$u+5],$P[$u+6],$P[$u+7],$P[$u+8],$P[$u+9],$P[$u+10],$P[$u+11],$P[$u+12],$P[$u+13],$P[$u+14],$P[$u+15]);$z._mesh._inverseBindPoses.push($i)}return $z._mesh._skinnedDatas=new Float32Array(16*$P.length),!0},$z.READ_SUBMESH=function(){var $$=$z._readData.__getBuffer(),$b=new $Hb($z._mesh),$u=$z._readData.getInt16(),$Z=$z._readData.getUint32(),$E=$z._readData.getUint32();$b._vertexBuffer=$z._mesh._vertexBuffers[$u],$b._vertexStart=$Z,$b._vertexCount=$E;var $r=$z._readData.getUint32(),$F=$z._readData.getUint32(),$x=$z._mesh._indexBuffer;$b._indexBuffer=$x,$b._indexStart=$r,$b._indexCount=$F,$b._indices=new Uint16Array($x.getData().buffer,2*$r,$F);var $g=$z._DATA.offset,$H=$b._subIndexBufferStart,$w=$b._subIndexBufferCount,$I=$b._boneIndicesList,$o=$z._readData.getUint16();$H.length=$o,$w.length=$o,$I.length=$o;for(var $N=0;$N<$o;$N++){$H[$N]=$z._readData.getUint32(),$w[$N]=$z._readData.getUint32();var $D=$z._readData.getUint32(),$e=$z._readData.getUint32();$b._boneIndicesList[$N]=new Uint8Array($$.slice($g+$D,$g+$D+$e))}return $z._subMeshes.push($b),!0},$z._getVertexDeclaration=function($$){for(var $b,$u=!1,$Z=!1,$E=!1,$r=!1,$F=!1,$x=!1,$g=!1,$H=!1,$w=!1,$I=0;$I<$$.length;$I++)switch($$[$I]){case"POSITION":$u=!0;break;case"NORMAL":$Z=!0;break;case"COLOR":$E=!0;break;case"UV":$r=!0;break;case"UV1":$F=!0;break;case"BLENDWEIGHT":$g=!0;break;case"BLENDINDICES":$H=!0;break;case"TANGENT":$x=!0;break;case"BINORMAL":$w=!0}return $u&&$Z&&$E&&$r&&$F&&$g&&$H&&$x?$b=$y$.vertexDeclaration:$u&&$Z&&$E&&$r&&$F&&$g&&$H?$b=$T$.vertexDeclaration:$u&&$Z&&$r&&$F&&$g&&$H&&$x?$b=$Y$.vertexDeclaration:$u&&$Z&&$r&&$F&&$g&&$H?$b=$v$.vertexDeclaration:$u&&$Z&&$E&&$r&&$g&&$H&&$x?$b=$q$.vertexDeclaration:$u&&$Z&&$E&&$r&&$g&&$H?$b=$i$.vertexDeclaration:$u&&$Z&&$r&&$g&&$H&&$x?$b=$s$.vertexDeclaration:$u&&$Z&&$r&&$g&&$H?$b=$l$.vertexDeclaration:$u&&$Z&&$E&&$g&&$H&&$x?$b=$o$.vertexDeclaration:$u&&$Z&&$E&&$g&&$H?$b=$w$.vertexDeclaration:$u&&$Z&&$E&&$r&&$F&&$x?$b=$P$.vertexDeclaration:$u&&$Z&&$E&&$r&&$F?$b=$L$.vertexDeclaration:$u&&$Z&&$r&&$F&&$x?$b=$M$.vertexDeclaration:$u&&$Z&&$r&&$F?$b=$V$.vertexDeclaration:$u&&$Z&&$E&&$r&&$x?$b=$t$.vertexDeclaration:$u&&$Z&&$r&&$x&&$w?$b=$c$.vertexDeclaration:$u&&$Z&&$E&&$r?$b=$e$.vertexDeclaration:$u&&$Z&&$r&&$x?$b=$n$.vertexDeclaration:$u&&$Z&&$r?$b=$O$.vertexDeclaration:$u&&$Z&&$E&&$x?$b=$D$.vertexDeclaration:$u&&$Z&&$E&&($b=$H$.vertexDeclaration),$b},$z._attrReg=new RegExp("(\\w+)|([:,;])","g"),$z._strings=[],$z._readData=null,$z._version=null,$z._mesh=null,$z._materials=null,$z._subMeshes=null,$z._materialMap=null,$I($z,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$z}(),$A$=function(){function $i(){}return $N($i,"laya.d3.loaders.LoadModelV03"),$i.parse=function($$,$b,$u,$Z,$E){$i._mesh=$u,$i._subMeshes=$Z,$i._materialMap=$E,$i._version=$b,$i._readData=$$,$i.READ_DATA(),$i.READ_BLOCK(),$i.READ_STRINGS();for(var $r=0,$F=$i._BLOCK.count;$r<$F;$r++){$i._readData.pos=$i._BLOCK.blockStarts[$r];var $x=$i._readData.getUint16(),$g=$i._strings[$x],$H=$i["READ_"+$g];if(null==$H)throw new Error("model file err,no this function:"+$x+" "+$g);$H.call()}$i._strings.length=0,$i._readData=null,$i._version=null,$i._mesh=null,$i._subMeshes=null,$i._materialMap=null},$i._readString=function(){return $i._strings[$i._readData.getUint16()]},$i.READ_DATA=function(){$i._DATA.offset=$i._readData.getUint32(),$i._DATA.size=$i._readData.getUint32()},$i.READ_BLOCK=function(){for(var $$=$i._BLOCK.count=$i._readData.getUint16(),$b=$i._BLOCK.blockStarts=[],$u=$i._BLOCK.blockLengths=[],$Z=0;$Z<$$;$Z++)$b.push($i._readData.getUint32()),$u.push($i._readData.getUint32())},$i.READ_STRINGS=function(){var $$=$i._readData.getUint32(),$b=$i._readData.getUint16(),$u=$i._readData.pos;$i._readData.pos=$$+$i._DATA.offset;for(var $Z=0;$Z<$b;$Z++)$i._strings[$Z]=$i._readData.readUTFString();$i._readData.pos=$u},$i.READ_MESH=function(){var $$,$b=$i._readString(),$u=$i._readData.__getBuffer(),$Z=0,$E=$i._readData.getInt16(),$r=$i._DATA.offset;for($Z=0;$Z<$E;$Z++){var $F,$x=$r+$i._readData.getUint32(),$g=$i._readData.getUint32(),$H=new Float32Array($u.slice($x,$x+$g)),$w=$i._readString();switch($i._version){case"LAYAMODEL:03":$F=$i._vertexDeclarationMap_Discard[$w];break;case"LAYAMODEL:0301":$F=$i._vertexDeclarationMap[$w];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$F)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$i._version+"  bufferAttribute="+$w+"  name="+$b+"  url="+($i._mesh?$i._mesh.url:"null"));var $I=$sb.create($F,4*$H.length/$F.vertexStride,35044,!0,$i._mesh._url+"_"+$Z);$I.setData($H),$i._mesh._vertexBuffers.push($I)}var $o=$r+$i._readData.getUint32(),$N=$i._readData.getUint32(),$D=new Uint16Array($u.slice($o,$o+$N)),$e=$Xb.create("ushort",$N/2,35044,!0,$i._mesh._url);$e.setData($D),$i._mesh._indexBuffer=$e;var $L=$i._mesh._boneNames=[],$T=$i._readData.getUint16();for($L.length=$T,$Z=0;$Z<$T;$Z++)$L[$Z]=$i._strings[$i._readData.getUint16()];$i._readData.pos+=8;var $_=$i._readData.getUint32(),$y=$i._readData.getUint32(),$S=new Float32Array($u.slice($r+$_,$r+$_+$y));for($i._mesh._inverseBindPoses=[],$Z=0,$$=$S.length;$Z<$$;$Z+=16){var $P=new $$b($S[$Z+0],$S[$Z+1],$S[$Z+2],$S[$Z+3],$S[$Z+4],$S[$Z+5],$S[$Z+6],$S[$Z+7],$S[$Z+8],$S[$Z+9],$S[$Z+10],$S[$Z+11],$S[$Z+12],$S[$Z+13],$S[$Z+14],$S[$Z+15]);$i._mesh._inverseBindPoses.push($P)}return $i._mesh._skinnedDatas=new Float32Array(16*$S.length),!0},$i.READ_SUBMESH=function(){var $$=$i._readData.__getBuffer(),$b=new $Hb($i._mesh),$u=$i._readData.getInt16(),$Z=$i._readData.getUint32(),$E=$i._readData.getUint32();$b._vertexBuffer=$i._mesh._vertexBuffers[$u],$b._vertexStart=$Z,$b._vertexCount=$E;var $r=$i._readData.getUint32(),$F=$i._readData.getUint32(),$x=$i._mesh._indexBuffer;$b._indexBuffer=$x,$b._indexStart=$r,$b._indexCount=$F,$b._indices=new Uint16Array($x.getData().buffer,2*$r,$F);var $g=$i._DATA.offset,$H=$b._subIndexBufferStart,$w=$b._subIndexBufferCount,$I=$b._boneIndicesList,$o=$i._readData.getUint16();$H.length=$o,$w.length=$o,$I.length=$o;for(var $N=0;$N<$o;$N++){$H[$N]=$i._readData.getUint32(),$w[$N]=$i._readData.getUint32();var $D=$i._readData.getUint32(),$e=$i._readData.getUint32();$I[$N]=new Uint8Array($$.slice($g+$D,$g+$D+$e))}return $i._subMeshes.push($b),!0},$i._strings=[],$i._readData=null,$i._version=null,$i._mesh=null,$i._subMeshes=null,$i._materialMap=null,$I($i,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$y$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$T$.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$J$.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Y$.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$v$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$q$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$i$.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$s$.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$l$.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$o$.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$w$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$P$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$L$.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$M$.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$V$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$t$.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$c$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$e$.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$n$.vertexDeclaration,"POSITION,NORMAL,UV":$O$.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$D$.vertexDeclaration,"POSITION,NORMAL,COLOR":$H$.vertexDeclaration,"POSITION,NORMAL,TANGENT":$K$.vertexDeclaration,"POSITION,NORMAL":$g$.vertexDeclaration,"POSITION,UV":$Q$.vertexDeclaration,POSITION:$x$.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$_$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$T$.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$J$.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$p$.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$v$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$z$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$i$.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$X$.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$l$.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$I$.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$w$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$S$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$L$.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$k$.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$V$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$a$.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$c$.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$e$.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$m$.vertexDeclaration,"POSITION,NORMAL,UV":$O$.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$N$.vertexDeclaration,"POSITION,NORMAL,COLOR":$H$.vertexDeclaration,"POSITION,NORMAL,TANGENT":$C$.vertexDeclaration,"POSITION,NORMAL":$g$.vertexDeclaration,"POSITION,UV":$Q$.vertexDeclaration,POSITION:$x$.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$i}(),$j$=function(){function $x(){}return $N($x,"laya.d3.loaders.MeshReader"),$x.read=function($$,$b,$u,$Z,$E){var $r=new $i($$);$r.pos=0;var $F=$r.readUTFString();switch($F){case"LAYAMODEL:01":case"LAYASKINANI:01":$x._readVersion01($r,$F,$b,$u,$Z,$E);break;case"LAYAMODEL:02":$G$.parse($r,$F,$b,$u,$Z,$E);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$A$.parse($r,$F,$b,$Z,$E);break;default:throw new Error("MeshReader: unknown mesh version.")}$b._setSubMeshes($Z)},$x._readVersion01=function($$,$b,$u,$Z,$E,$r){new $W$($$,$b,$u,$Z,$E,$r)},$x}(),$h$=function(){function $$($$,$b){this.min=null,this.max=null,this.min=$$,this.max=$b}$N($$,"laya.d3.math.BoundBox");var $b=$$.prototype;return $P.imps($b,{"laya.d3.core.IClone":!0}),$b.getCorners=function($$){$$.length=8;var $b=this.min.elements,$u=this.max.elements,$Z=$b[0],$E=$b[1],$r=$b[2],$F=$u[0],$x=$u[1],$g=$u[2];$$[0]=new $Fb($Z,$x,$g),$$[1]=new $Fb($F,$x,$g),$$[2]=new $Fb($F,$E,$g),$$[3]=new $Fb($Z,$E,$g),$$[4]=new $Fb($Z,$x,$r),$$[5]=new $Fb($F,$x,$r),$$[6]=new $Fb($F,$E,$r),$$[7]=new $Fb($Z,$E,$r)},$b.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$b.cloneTo=function($$){var $b=$$;this.min.cloneTo($b.min),this.max.cloneTo($b.max)},$b.clone=function(){var $$=new this.constructor(new $Fb,new $Fb);return this.cloneTo($$),$$},$$.createfromPoints=function($$,$b){if(null==$$)throw new Error("points");var $u=$b.min,$Z=$b.max,$E=$u.elements;$E[0]=Number.MAX_VALUE,$E[1]=Number.MAX_VALUE,$E[2]=Number.MAX_VALUE;var $r=$Z.elements;$r[0]=-Number.MAX_VALUE,$r[1]=-Number.MAX_VALUE,$r[2]=-Number.MAX_VALUE;for(var $F=0,$x=$$.length;$F<$x;++$F)$Fb.min($u,$$[$F],$u),$Fb.max($Z,$$[$F],$Z)},$$.merge=function($$,$b,$u){$Fb.min($$.min,$b.min,$u.min),$Fb.max($$.max,$b.max,$u.max)},$$}(),$d$=function(){function $H($$){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$$,this._near=new $bb(new $Fb),this._far=new $bb(new $Fb),this._left=new $bb(new $Fb),this._right=new $bb(new $Fb),this._top=new $bb(new $Fb),this._bottom=new $bb(new $Fb),$H._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$N($H,"laya.d3.math.BoundFrustum");var $$=$H.prototype;return $$.equalsBoundFrustum=function($$){return this._matrix.equalsOtherMatrix($$.matrix)},$$.equalsObj=function($$){if($$ instanceof laya.d3.math.BoundFrustum){var $b=$$;return this.equalsBoundFrustum($b)}return!1},$$.getPlane=function($$){switch($$){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$$.getCorners=function($$){$H._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($$[0]),$H._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($$[1]),$H._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($$[2]),$H._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($$[3]),$H._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($$[4]),$H._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($$[5]),$H._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($$[6]),$H._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($$[7])},$$.containsPoint=function($$){for(var $b=$bb.PlaneIntersectionType_Front,$u=$bb.PlaneIntersectionType_Front,$Z=0;$Z<6;$Z++){switch($Z){case 0:$u=Collision.intersectsPlaneAndPoint(this._near,$$);break;case 1:$u=Collision.intersectsPlaneAndPoint(this._far,$$);break;case 2:$u=Collision.intersectsPlaneAndPoint(this._left,$$);break;case 3:$u=Collision.intersectsPlaneAndPoint(this._right,$$);break;case 4:$u=Collision.intersectsPlaneAndPoint(this._top,$$);break;case 5:$u=Collision.intersectsPlaneAndPoint(this._bottom,$$)}switch($u){case $bb.PlaneIntersectionType_Back:return 0;case $bb.PlaneIntersectionType_Intersecting:$b=$bb.PlaneIntersectionType_Intersecting}}switch($b){case $bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$$.containsBoundBox=function($$){for(var $b,$u=$H._tempV30,$Z=$H._tempV31,$E=1,$r=0;$r<6;$r++){if($b=this.getPlane($r),this._getBoxToPlanePVertexNVertex($$,$b.normal,$u,$Z),Collision.intersectsPlaneAndPoint($b,$u)===$bb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($b,$Z)===$bb.PlaneIntersectionType_Back&&($E=2)}return $E},$$.containsBoundSphere=function($$){for(var $b=$bb.PlaneIntersectionType_Front,$u=$bb.PlaneIntersectionType_Front,$Z=0;$Z<6;$Z++){switch($Z){case 0:$u=Collision.intersectsPlaneAndSphere(this._near,$$);break;case 1:$u=Collision.intersectsPlaneAndSphere(this._far,$$);break;case 2:$u=Collision.intersectsPlaneAndSphere(this._left,$$);break;case 3:$u=Collision.intersectsPlaneAndSphere(this._right,$$);break;case 4:$u=Collision.intersectsPlaneAndSphere(this._top,$$);break;case 5:$u=Collision.intersectsPlaneAndSphere(this._bottom,$$)}switch($u){case $bb.PlaneIntersectionType_Back:return 0;case $bb.PlaneIntersectionType_Intersecting:$b=$bb.PlaneIntersectionType_Intersecting}}switch($b){case $bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$$._getBoxToPlanePVertexNVertex=function($$,$b,$u,$Z){var $E=$$.min,$r=$E.elements,$F=$$.max,$x=$F.elements,$g=$b.elements,$H=$g[0],$w=$g[1],$I=$g[2];$E.cloneTo($u);var $o=$u.elements;0<=$H&&($o[0]=$x[0]),0<=$w&&($o[1]=$x[1]),0<=$I&&($o[2]=$x[2]),$F.cloneTo($Z);var $N=$Z.elements;0<=$H&&($N[0]=$r[0]),0<=$w&&($N[1]=$r[1]),0<=$I&&($N[2]=$r[2])},$D(0,$$,"top",function(){return this._top}),$D(0,$$,"matrix",function(){return this._matrix},function($$){this._matrix=$$,$H._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$D(0,$$,"near",function(){return this._near}),$D(0,$$,"far",function(){return this._far}),$D(0,$$,"left",function(){return this._left}),$D(0,$$,"right",function(){return this._right}),$D(0,$$,"bottom",function(){return this._bottom}),$H._getPlanesFromMatrix=function($$,$b,$u,$Z,$E,$r,$F){var $x=$$.elements,$g=$x[0],$H=$x[1],$w=$x[2],$I=$x[3],$o=$x[4],$N=$x[5],$D=$x[6],$e=$x[7],$L=$x[8],$T=$x[9],$_=$x[10],$y=$x[11],$S=$x[12],$P=$x[13],$i=$x[14],$z=$x[15],$q=$b.normal.elements;$q[0]=$I+$w,$q[1]=$e+$D,$q[2]=$y+$_,$b.distance=$z+$i,$b.normalize();var $a=$u.normal.elements;$a[0]=$I-$w,$a[1]=$e-$D,$a[2]=$y-$_,$u.distance=$z-$i,$u.normalize();var $t=$Z.normal.elements;$t[0]=$I+$g,$t[1]=$e+$o,$t[2]=$y+$L,$Z.distance=$z+$S,$Z.normalize();var $C=$E.normal.elements;$C[0]=$I-$g,$C[1]=$e-$o,$C[2]=$y-$L,$E.distance=$z-$S,$E.normalize();var $K=$r.normal.elements;$K[0]=$I-$H,$K[1]=$e-$N,$K[2]=$y-$T,$r.distance=$z-$P,$r.normalize();var $O=$F.normal.elements;$O[0]=$I+$H,$O[1]=$e+$N,$O[2]=$y+$T,$F.distance=$z+$P,$F.normalize()},$H._get3PlaneInterPoint=function($$,$b,$u){var $Z=$$.normal,$E=$b.normal,$r=$u.normal;$Fb.cross($E,$r,$H._tempV30),$Fb.cross($r,$Z,$H._tempV31),$Fb.cross($Z,$E,$H._tempV32);var $F=$Fb.dot($Z,$H._tempV30),$x=$Fb.dot($E,$H._tempV31),$g=$Fb.dot($r,$H._tempV32);return $Fb.scale($H._tempV30,-$$.distance/$F,$H._tempV33),$Fb.scale($H._tempV31,-$b.distance/$x,$H._tempV34),$Fb.scale($H._tempV32,-$u.distance/$g,$H._tempV35),$Fb.add($H._tempV33,$H._tempV34,$H._tempV36),$Fb.add($H._tempV35,$H._tempV36,$H._tempV37),$H._tempV37},$I($H,["_tempV30",function(){return this._tempV30=new $Fb},"_tempV31",function(){return this._tempV31=new $Fb},"_tempV32",function(){return this._tempV32=new $Fb},"_tempV33",function(){return this._tempV33=new $Fb},"_tempV34",function(){return this._tempV34=new $Fb},"_tempV35",function(){return this._tempV35=new $Fb},"_tempV36",function(){return this._tempV36=new $Fb},"_tempV37",function(){return this._tempV37=new $Fb}]),$H}(),$U$=function(){function $w($$,$b){this.center=null,this.radius=NaN,this.center=$$,this.radius=$b}$N($w,"laya.d3.math.BoundSphere");var $$=$w.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.toDefault=function(){this.center.toDefault(),this.radius=0},$$.intersectsRayDistance=function($$){return Collision.intersectsRayAndSphereRD($$,this)},$$.intersectsRayPoint=function($$,$b){return Collision.intersectsRayAndSphereRP($$,this,$b)},$$.cloneTo=function($$){var $b=$$;this.center.cloneTo($b.center),$b.radius=this.radius},$$.clone=function(){var $$=new this.constructor(new $Fb,new $Fb);return this.cloneTo($$),$$},$w.createFromSubPoints=function($$,$b,$u,$Z){if(null==$$)throw new Error("points");if($b<0||$b>=$$.length)throw new Error("start"+$b+"Must be in the range [0, "+($$.length-1)+"]");if($u<0||$b+$u>$$.length)throw new Error("count"+$u+"Must be in the range <= "+$$.length+"}");var $E=$b+$u,$r=$w._tempVector3;$r.elements[0]=0,$r.elements[1]=0,$r.elements[2]=0;for(var $F=$b;$F<$E;++$F)$Fb.add($$[$F],$r,$r);var $x=$Z.center;$Fb.scale($r,1/$u,$x);var $g=0;for($F=$b;$F<$E;++$F){var $H=$Fb.distanceSquared($x,$$[$F]);$g<$H&&($g=$H)}$Z.radius=Math.sqrt($g)},$w.createfromPoints=function($$,$b){if(null==$$)throw new Error("points");$w.createFromSubPoints($$,0,$$.length,$b)},$I($w,["_tempVector3",function(){return this._tempVector3=new $Fb}]),$w}(),$B$=(function(){function $$(){}$N($$,"laya.d3.math.ContainmentType"),$$.Disjoint=0,$$.Contains=1,$$.Intersects=2}(),function(){function $u(){}return $N($u,"laya.d3.math.MathUtils3D"),$u.isZero=function($$){return Math.abs($$)<$u.zeroTolerance},$u.nearEqual=function($$,$b){return!!$u.isZero($$-$b)},$u.fastInvSqrt=function($$){return $u.isZero($$)?$$:1/Math.sqrt($$)},$I($u,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$u}()),$R$=function(){function $g(){var $$=this.elements=new Float32Array(9);$$[0]=1,$$[1]=0,$$[2]=0,$$[3]=0,$$[4]=1,$$[5]=0,$$[6]=0,$$[7]=0,$$[8]=1}$N($g,"laya.d3.math.Matrix3x3");var $$=$g.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.determinant=function(){var $$=this.elements,$b=$$[0],$u=$$[1],$Z=$$[2],$E=$$[3],$r=$$[4],$F=$$[5],$x=$$[6],$g=$$[7],$H=$$[8];return $b*($H*$r-$F*$g)+$u*(-$H*$E+$F*$x)+$Z*($g*$E-$r*$x)},$$.translate=function($$,$b){var $u=$b.elements,$Z=this.elements,$E=$$.elements,$r=$Z[0],$F=$Z[1],$x=$Z[2],$g=$Z[3],$H=$Z[4],$w=$Z[5],$I=$Z[6],$o=$Z[7],$N=$Z[8],$D=$E[0],$e=$E[1];$u[0]=$r,$u[1]=$F,$u[2]=$x,$u[3]=$g,$u[4]=$H,$u[5]=$w,$u[6]=$D*$r+$e*$g+$I,$u[7]=$D*$F+$e*$H+$o,$u[8]=$D*$x+$e*$w+$N},$$.rotate=function($$,$b){var $u=$b.elements,$Z=this.elements,$E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$Z[3],$g=$Z[4],$H=$Z[5],$w=$Z[6],$I=$Z[7],$o=$Z[8],$N=Math.sin($$),$D=Math.cos($$);$u[0]=$D*$E+$N*$x,$u[1]=$D*$r+$N*$g,$u[2]=$D*$F+$N*$H,$u[3]=$D*$x-$N*$E,$u[4]=$D*$g-$N*$r,$u[5]=$D*$H-$N*$F,$u[6]=$w,$u[7]=$I,$u[8]=$o},$$.scale=function($$,$b){var $u=$b.elements,$Z=this.elements,$E=$$.elements,$r=$E[0],$F=$E[1];$u[0]=$r*$Z[0],$u[1]=$r*$Z[1],$u[2]=$r*$Z[2],$u[3]=$F*$Z[3],$u[4]=$F*$Z[4],$u[5]=$F*$Z[5],$u[6]=$Z[6],$u[7]=$Z[7],$u[8]=$Z[8]},$$.invert=function($$){var $b=$$.elements,$u=this.elements,$Z=$u[0],$E=$u[1],$r=$u[2],$F=$u[3],$x=$u[4],$g=$u[5],$H=$u[6],$w=$u[7],$I=$u[8],$o=$I*$x-$g*$w,$N=-$I*$F+$g*$H,$D=$w*$F-$x*$H,$e=$Z*$o+$E*$N+$r*$D;$e||($$=null),$e=1/$e,$b[0]=$o*$e,$b[1]=(-$I*$E+$r*$w)*$e,$b[2]=($g*$E-$r*$x)*$e,$b[3]=$N*$e,$b[4]=($I*$Z-$r*$H)*$e,$b[5]=(-$g*$Z+$r*$F)*$e,$b[6]=$D*$e,$b[7]=(-$w*$Z+$E*$H)*$e,$b[8]=($x*$Z-$E*$F)*$e},$$.transpose=function($$){var $b=$$.elements,$u=this.elements;if($$===this){var $Z=$u[1],$E=$u[2],$r=$u[5];$b[1]=$u[3],$b[2]=$u[6],$b[3]=$Z,$b[5]=$u[7],$b[6]=$E,$b[7]=$r}else $b[0]=$u[0],$b[1]=$u[3],$b[2]=$u[6],$b[3]=$u[1],$b[4]=$u[4],$b[5]=$u[7],$b[6]=$u[2],$b[7]=$u[5],$b[8]=$u[8]},$$.identity=function(){var $$=this.elements;$$[0]=1,$$[1]=0,$$[2]=0,$$[3]=0,$$[4]=1,$$[5]=0,$$[6]=0,$$[7]=0,$$[8]=1},$$.cloneTo=function($$){var $b,$u,$Z;if(($u=this.elements)!==($Z=$$.elements))for($b=0;$b<9;++$b)$Z[$b]=$u[$b]},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$g.createFromTranslation=function($$,$b){$b.elements;var $u=$$.elements;$b[0]=1,$b[1]=0,$b[2]=0,$b[3]=0,$b[4]=1,$b[5]=0,$b[6]=$u[0],$b[7]=$u[1],$b[8]=1},$g.createFromRotation=function($$,$b){var $u=$b.elements,$Z=Math.sin($$),$E=Math.cos($$);$u[0]=$E,$u[1]=$Z,$u[2]=0,$u[3]=-$Z,$u[4]=$E,$u[5]=0,$u[6]=0,$u[7]=0,$u[8]=1},$g.createFromScaling=function($$,$b){var $u=$b.elements,$Z=$$.elements;$u[0]=$Z[0],$u[1]=0,$u[2]=0,$u[3]=0,$u[4]=$Z[1],$u[5]=0,$u[6]=0,$u[7]=0,$u[8]=1},$g.createFromMatrix4x4=function($$,$b){$b[0]=$$[0],$b[1]=$$[1],$b[2]=$$[2],$b[3]=$$[4],$b[4]=$$[5],$b[5]=$$[6],$b[6]=$$[8],$b[7]=$$[9],$b[8]=$$[10]},$g.multiply=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements,$F=$E[0],$x=$E[1],$g=$E[2],$H=$E[3],$w=$E[4],$I=$E[5],$o=$E[6],$N=$E[7],$D=$E[8],$e=$r[0],$L=$r[1],$T=$r[2],$_=$r[3],$y=$r[4],$S=$r[5],$P=$r[6],$i=$r[7],$z=$r[8];$Z[0]=$e*$F+$L*$H+$T*$o,$Z[1]=$e*$x+$L*$w+$T*$N,$Z[2]=$e*$g+$L*$I+$T*$D,$Z[3]=$_*$F+$y*$H+$S*$o,$Z[4]=$_*$x+$y*$w+$S*$N,$Z[5]=$_*$g+$y*$I+$S*$D,$Z[6]=$P*$F+$i*$H+$z*$o,$Z[7]=$P*$x+$i*$w+$z*$N,$Z[8]=$P*$g+$i*$I+$z*$D},$g.lookAt=function($$,$b,$u,$Z){$Fb.subtract($$,$b,$g._tempV30),$Fb.normalize($g._tempV30,$g._tempV30),$Fb.cross($u,$g._tempV30,$g._tempV31),$Fb.normalize($g._tempV31,$g._tempV31),$Fb.cross($g._tempV30,$g._tempV31,$g._tempV32);var $E=$g._tempV30.elements,$r=$g._tempV31.elements,$F=$g._tempV32.elements,$x=$Z.elements;$x[0]=$r[0],$x[3]=$r[1],$x[6]=$r[2],$x[1]=$F[0],$x[4]=$F[1],$x[7]=$F[2],$x[2]=$E[0],$x[5]=$E[1],$x[8]=$E[2]},$g.DEFAULT=new $g,$I($g,["_tempV30",function(){return this._tempV30=new $Fb},"_tempV31",function(){return this._tempV31=new $Fb},"_tempV32",function(){return this._tempV32=new $Fb}]),$g}(),$$b=function(){function $a($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I,$o,$N,$D,$e){void 0===$$&&($$=1),void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=0),void 0===$E&&($E=0),void 0===$r&&($r=1),void 0===$F&&($F=0),void 0===$x&&($x=0),void 0===$g&&($g=0),void 0===$H&&($H=0),void 0===$w&&($w=1),void 0===$I&&($I=0),void 0===$o&&($o=0),void 0===$N&&($N=0),void 0===$D&&($D=0),void 0===$e&&($e=1);var $L=this.elements=new Float32Array(16);$L[0]=$$,$L[1]=$b,$L[2]=$u,$L[3]=$Z,$L[4]=$E,$L[5]=$r,$L[6]=$F,$L[7]=$x,$L[8]=$g,$L[9]=$H,$L[10]=$w,$L[11]=$I,$L[12]=$o,$L[13]=$N,$L[14]=$D,$L[15]=$e}$N($a,"laya.d3.math.Matrix4x4");var $$=$a.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.getElementByRowColumn=function($$,$b){if($$<0||3<$$)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($b<0||3<$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$$+$b]},$$.setElementByRowColumn=function($$,$b,$u){if($$<0||3<$$)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($b<0||3<$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$$+$b]=$u},$$.equalsOtherMatrix=function($$){var $b=this.elements,$u=$$.elements;return $B$.nearEqual($b[0],$u[0])&&$B$.nearEqual($b[1],$u[1])&&$B$.nearEqual($b[2],$u[2])&&$B$.nearEqual($b[3],$u[3])&&$B$.nearEqual($b[4],$u[4])&&$B$.nearEqual($b[5],$u[5])&&$B$.nearEqual($b[6],$u[6])&&$B$.nearEqual($b[7],$u[7])&&$B$.nearEqual($b[8],$u[8])&&$B$.nearEqual($b[9],$u[9])&&$B$.nearEqual($b[10],$u[10])&&$B$.nearEqual($b[11],$u[11])&&$B$.nearEqual($b[12],$u[12])&&$B$.nearEqual($b[13],$u[13])&&$B$.nearEqual($b[14],$u[14])&&$B$.nearEqual($b[15],$u[15])},$$.decomposeTransRotScale=function($$,$b,$u){var $Z=$a._tempMatrix4x4;return this.decomposeTransRotMatScale($$,$Z,$u)?($ub.createFromMatrix4x4($Z,$b),!0):($b.identity(),!1)},$$.decomposeTransRotMatScale=function($$,$b,$u){var $Z=this.elements,$E=$$.elements,$r=$b.elements,$F=$u.elements;$E[0]=$Z[12],$E[1]=$Z[13],$E[2]=$Z[14];var $x=$Z[0],$g=$Z[1],$H=$Z[2],$w=$Z[4],$I=$Z[5],$o=$Z[6],$N=$Z[8],$D=$Z[9],$e=$Z[10],$L=$F[0]=Math.sqrt($x*$x+$g*$g+$H*$H),$T=$F[1]=Math.sqrt($w*$w+$I*$I+$o*$o),$_=$F[2]=Math.sqrt($N*$N+$D*$D+$e*$e);if($B$.isZero($L)||$B$.isZero($T)||$B$.isZero($_))return $r[1]=$r[2]=$r[3]=$r[4]=$r[6]=$r[7]=$r[8]=$r[9]=$r[11]=$r[12]=$r[13]=$r[14]=0,$r[0]=$r[5]=$r[10]=$r[15]=1,!1;var $y=$a._tempVector0,$S=$y.elements;$S[0]=$N/$_,$S[1]=$D/$_,$S[2]=$e/$_;var $P=$a._tempVector1,$i=$P.elements;$i[0]=$x/$L,$i[1]=$g/$L,$i[2]=$H/$L;var $z=$a._tempVector2;$Fb.cross($y,$P,$z);var $q=$a._tempVector1;return $Fb.cross($z,$y,$q),$r[3]=$r[7]=$r[11]=$r[12]=$r[13]=$r[14]=0,$r[15]=1,$r[0]=$q.x,$r[1]=$q.y,$r[2]=$q.z,$r[4]=$z.x,$r[5]=$z.y,$r[6]=$z.z,$r[8]=$y.x,$r[9]=$y.y,$r[10]=$y.z,$r[0]*$x+$r[1]*$g+$r[2]*$H<0&&($F[0]=-$L),$r[4]*$w+$r[5]*$I+$r[6]*$o<0&&($F[1]=-$T),$r[8]*$N+$r[9]*$D+$r[10]*$e<0&&($F[2]=-$_),!0},$$.decomposeYawPitchRoll=function($$){var $b=$$.elements,$u=Math.asin(-this.elements[9]);$b[1]=$u,Math.cos($u)>$B$.zeroTolerance?($b[2]=Math.atan2(this.elements[1],this.elements[5]),$b[0]=Math.atan2(this.elements[8],this.elements[10])):($b[2]=Math.atan2(-this.elements[4],this.elements[0]),$b[0]=0)},$$.normalize=function(){var $$=this.elements,$b=$$[0],$u=$$[1],$Z=$$[2],$E=Math.sqrt($b*$b+$u*$u+$Z*$Z);if(!$E)return $$[0]=0,$$[1]=0,void($$[2]=0);1!=$E&&($E=1/$E,$$[0]=$b*$E,$$[1]=$u*$E,$$[2]=$Z*$E)},$$.transpose=function(){var $$,$b;return $b=($$=this.elements)[1],$$[1]=$$[4],$$[4]=$b,$b=$$[2],$$[2]=$$[8],$$[8]=$b,$b=$$[3],$$[3]=$$[12],$$[12]=$b,$b=$$[6],$$[6]=$$[9],$$[9]=$b,$b=$$[7],$$[7]=$$[13],$$[13]=$b,$b=$$[11],$$[11]=$$[14],$$[14]=$b,this},$$.invert=function($$){var $b=this.elements,$u=$$.elements,$Z=$b[0],$E=$b[1],$r=$b[2],$F=$b[3],$x=$b[4],$g=$b[5],$H=$b[6],$w=$b[7],$I=$b[8],$o=$b[9],$N=$b[10],$D=$b[11],$e=$b[12],$L=$b[13],$T=$b[14],$_=$b[15],$y=$Z*$g-$E*$x,$S=$Z*$H-$r*$x,$P=$Z*$w-$F*$x,$i=$E*$H-$r*$g,$z=$E*$w-$F*$g,$q=$r*$w-$F*$H,$a=$I*$L-$o*$e,$t=$I*$T-$N*$e,$C=$I*$_-$D*$e,$K=$o*$T-$N*$L,$O=$o*$_-$D*$L,$V=$N*$_-$D*$T,$v=$y*$V-$S*$O+$P*$K+$i*$C-$z*$t+$q*$a;0!==Math.abs($v)&&($v=1/$v,$u[0]=($g*$V-$H*$O+$w*$K)*$v,$u[1]=($r*$O-$E*$V-$F*$K)*$v,$u[2]=($L*$q-$T*$z+$_*$i)*$v,$u[3]=($N*$z-$o*$q-$D*$i)*$v,$u[4]=($H*$C-$x*$V-$w*$t)*$v,$u[5]=($Z*$V-$r*$C+$F*$t)*$v,$u[6]=($T*$P-$e*$q-$_*$S)*$v,$u[7]=($I*$q-$N*$P+$D*$S)*$v,$u[8]=($x*$O-$g*$C+$w*$a)*$v,$u[9]=($E*$C-$Z*$O-$F*$a)*$v,$u[10]=($e*$z-$L*$P+$_*$y)*$v,$u[11]=($o*$P-$I*$z-$D*$y)*$v,$u[12]=($g*$t-$x*$K-$H*$a)*$v,$u[13]=($Z*$K-$E*$t+$r*$a)*$v,$u[14]=($L*$S-$e*$i-$T*$y)*$v,$u[15]=($I*$i-$o*$S+$N*$y)*$v)},$$.identity=function(){var $$=this.elements;$$[1]=$$[2]=$$[3]=$$[4]=$$[6]=$$[7]=$$[8]=$$[9]=$$[11]=$$[12]=$$[13]=$$[14]=0,$$[0]=$$[5]=$$[10]=$$[15]=1},$$.cloneTo=function($$){var $b,$u,$Z;if(($u=this.elements)!==($Z=$$.elements))for($b=0;$b<16;++$b)$Z[$b]=$u[$b]},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$$.getTranslationVector=function($$){var $b=this.elements,$u=$$.elements;$u[0]=$b[12],$u[1]=$b[13],$u[2]=$b[14]},$$.setTranslationVector=function($$){var $b=this.elements,$u=$$.elements;$b[12]=$u[0],$b[13]=$u[1],$b[14]=$u[2]},$$.getForward=function($$){var $b=this.elements,$u=$$.elements;$u[0]=-$b[8],$u[1]=-$b[9],$u[2]=-$b[10]},$$.setForward=function($$){var $b=this.elements,$u=$$.elements;$b[8]=-$u[0],$b[9]=-$u[1],$b[10]=-$u[2]},$a.createRotationX=function($$,$b){var $u=$b.elements,$Z=Math.sin($$),$E=Math.cos($$);$u[1]=$u[2]=$u[3]=$u[4]=$u[7]=$u[8]=$u[11]=$u[12]=$u[13]=$u[14]=0,$u[0]=$u[15]=1,$u[5]=$u[10]=$E,$u[6]=$Z,$u[9]=-$Z},$a.createRotationY=function($$,$b){var $u=$b.elements,$Z=Math.sin($$),$E=Math.cos($$);$u[1]=$u[3]=$u[4]=$u[6]=$u[7]=$u[9]=$u[11]=$u[12]=$u[13]=$u[14]=0,$u[5]=$u[15]=1,$u[0]=$u[10]=$E,$u[2]=-$Z,$u[8]=$Z},$a.createRotationZ=function($$,$b){var $u=$b.elements,$Z=Math.sin($$),$E=Math.cos($$);$u[2]=$u[3]=$u[6]=$u[7]=$u[8]=$u[9]=$u[11]=$u[12]=$u[13]=$u[14]=0,$u[10]=$u[15]=1,$u[0]=$u[5]=$E,$u[1]=$Z,$u[4]=-$Z},$a.createRotationYawPitchRoll=function($$,$b,$u,$Z){$ub.createFromYawPitchRoll($$,$b,$u,$a._tempQuaternion),$a.createRotationQuaternion($a._tempQuaternion,$Z)},$a.createRotationAxis=function($$,$b,$u){var $Z=$$.elements,$E=$Z[0],$r=$Z[1],$F=$Z[2],$x=Math.cos($b),$g=Math.sin($b),$H=$E*$E,$w=$r*$r,$I=$F*$F,$o=$E*$r,$N=$E*$F,$D=$r*$F,$e=$u.elements;$e[3]=$e[7]=$e[11]=$e[12]=$e[13]=$e[14]=0,$e[15]=1,$e[0]=$H+$x*(1-$H),$e[1]=$o-$x*$o+$g*$F,$e[2]=$N-$x*$N-$g*$r,$e[4]=$o-$x*$o-$g*$F,$e[5]=$w+$x*(1-$w),$e[6]=$D-$x*$D+$g*$E,$e[8]=$N-$x*$N+$g*$r,$e[9]=$D-$x*$D-$g*$E,$e[10]=$I+$x*(1-$I)},$a.createRotationQuaternion=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$u[0],$r=$u[1],$F=$u[2],$x=$u[3],$g=$E*$E,$H=$r*$r,$w=$F*$F,$I=$E*$r,$o=$F*$x,$N=$F*$E,$D=$r*$x,$e=$r*$F,$L=$E*$x;$Z[3]=$Z[7]=$Z[11]=$Z[12]=$Z[13]=$Z[14]=0,$Z[15]=1,$Z[0]=1-2*($H+$w),$Z[1]=2*($I+$o),$Z[2]=2*($N-$D),$Z[4]=2*($I-$o),$Z[5]=1-2*($w+$g),$Z[6]=2*($e+$L),$Z[8]=2*($N+$D),$Z[9]=2*($e-$L),$Z[10]=1-2*($H+$g)},$a.createTranslate=function($$,$b){var $u=$$.elements,$Z=$b.elements;$Z[4]=$Z[8]=$Z[1]=$Z[9]=$Z[2]=$Z[6]=$Z[3]=$Z[7]=$Z[11]=0,$Z[0]=$Z[5]=$Z[10]=$Z[15]=1,$Z[12]=$u[0],$Z[13]=$u[1],$Z[14]=$u[2]},$a.createScaling=function($$,$b){var $u=$$.elements,$Z=$b.elements;$Z[0]=$u[0],$Z[5]=$u[1],$Z[10]=$u[2],$Z[1]=$Z[4]=$Z[8]=$Z[12]=$Z[9]=$Z[13]=$Z[2]=$Z[6]=$Z[14]=$Z[3]=$Z[7]=$Z[11]=0,$Z[15]=1},$a.multiply=function($$,$b,$u){var $Z,$E,$r,$F,$x,$g,$H,$w;for($E=$u.elements,$r=$$.elements,$E===($F=$b.elements)&&($F=$F.slice()),$Z=0;$Z<4;$Z++)$x=$r[$Z],$g=$r[$Z+4],$H=$r[$Z+8],$w=$r[$Z+12],$E[$Z]=$x*$F[0]+$g*$F[1]+$H*$F[2]+$w*$F[3],$E[$Z+4]=$x*$F[4]+$g*$F[5]+$H*$F[6]+$w*$F[7],$E[$Z+8]=$x*$F[8]+$g*$F[9]+$H*$F[10]+$w*$F[11],$E[$Z+12]=$x*$F[12]+$g*$F[13]+$H*$F[14]+$w*$F[15]},$a.createFromQuaternion=function($$,$b){var $u=$b.elements,$Z=$$.elements,$E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$Z[3],$g=$E+$E,$H=$r+$r,$w=$F+$F,$I=$E*$g,$o=$r*$g,$N=$r*$H,$D=$F*$g,$e=$F*$H,$L=$F*$w,$T=$x*$g,$_=$x*$H,$y=$x*$w;$u[0]=1-$N-$L,$u[1]=$o+$y,$u[2]=$D-$_,$u[3]=0,$u[4]=$o-$y,$u[5]=1-$I-$L,$u[6]=$e+$T,$u[7]=0,$u[8]=$D+$_,$u[9]=$e-$T,$u[10]=1-$I-$N,$u[11]=0,$u[12]=0,$u[13]=0,$u[14]=0,$u[15]=1},$a.createAffineTransformation=function($$,$b,$u,$Z){var $E=$$.elements,$r=$b.elements,$F=$u.elements,$x=$Z.elements,$g=$r[0],$H=$r[1],$w=$r[2],$I=$r[3],$o=$g+$g,$N=$H+$H,$D=$w+$w,$e=$g*$o,$L=$g*$N,$T=$g*$D,$_=$H*$N,$y=$H*$D,$S=$w*$D,$P=$I*$o,$i=$I*$N,$z=$I*$D,$q=$F[0],$a=$F[1],$t=$F[2];$x[0]=(1-($_+$S))*$q,$x[1]=($L+$z)*$q,$x[2]=($T-$i)*$q,$x[3]=0,$x[4]=($L-$z)*$a,$x[5]=(1-($e+$S))*$a,$x[6]=($y+$P)*$a,$x[7]=0,$x[8]=($T+$i)*$t,$x[9]=($y-$P)*$t,$x[10]=(1-($e+$_))*$t,$x[11]=0,$x[12]=$E[0],$x[13]=$E[1],$x[14]=$E[2],$x[15]=1},$a.createLookAt=function($$,$b,$u,$Z){var $E=$Z.elements,$r=$a._tempVector0,$F=$a._tempVector1,$x=$a._tempVector2;$Fb.subtract($$,$b,$x),$Fb.normalize($x,$x),$Fb.cross($u,$x,$r),$Fb.normalize($r,$r),$Fb.cross($x,$r,$F),$Z.identity(),$E[0]=$r.x,$E[4]=$r.y,$E[8]=$r.z,$E[1]=$F.x,$E[5]=$F.y,$E[9]=$F.z,$E[2]=$x.x,$E[6]=$x.y,$E[10]=$x.z,$E[12]=-$Fb.dot($r,$$),$E[13]=-$Fb.dot($F,$$),$E[14]=-$Fb.dot($x,$$)},$a.createPerspective=function($$,$b,$u,$Z,$E){var $r=$E.elements,$F=1/Math.tan($$/2),$x=1/($u-$Z);$r[0]=$F/$b,$r[5]=$F,$r[10]=($Z+$u)*$x,$r[11]=-1,$r[14]=2*$Z*$u*$x,$r[1]=$r[2]=$r[3]=$r[4]=$r[6]=$r[7]=$r[8]=$r[9]=$r[12]=$r[13]=$r[15]=0},$a.createOrthoOffCenterRH=function($$,$b,$u,$Z,$E,$r,$F){var $x=$F.elements,$g=1/($$-$b),$H=1/($u-$Z),$w=1/($E-$r);$x[1]=$x[2]=$x[3]=$x[4]=$x[6]=$x[7]=$x[8]=$x[9]=$x[11]=0,$x[15]=1,$x[0]=-2*$g,$x[5]=-2*$H,$x[10]=2*$w,$x[12]=($$+$b)*$g,$x[13]=($Z+$u)*$H,$x[14]=($r+$E)*$w},$a.translation=function($$,$b){var $u=$$.elements,$Z=$b.elements;$Z[0]=$Z[5]=$Z[10]=$Z[15]=1,$Z[12]=$u[0],$Z[13]=$u[1],$Z[14]=$u[2]},$I($a,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $a},"_tempVector0",function(){return this._tempVector0=new $Fb},"_tempVector1",function(){return this._tempVector1=new $Fb},"_tempVector2",function(){return this._tempVector2=new $Fb},"_tempQuaternion",function(){return this._tempQuaternion=new $ub},"DEFAULT",function(){return this.DEFAULT=new $a},"ZERO",function(){return this.ZERO=new $a(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$a}(),$bb=(function(){function $y($$,$b){this.extents=null,this.transformation=null,this.extents=$$,this.transformation=$b}$N($y,"laya.d3.math.OrientedBoundBox");var $$=$y.prototype;$$.getCorners=function($$){var $b=$y._tempV30.elements,$u=$y._tempV31.elements,$Z=$y._tempV32.elements,$E=this.extents.elements;$b[0]=$E[0],$b[1]=$b[2]=0,$u[1]=$E[1],$u[0]=$u[2]=0,$Z[2]=$E[2],$Z[0]=$Z[1]=0,$Fb.TransformNormal($y._tempV30,this.transformation,$y._tempV30),$Fb.TransformNormal($y._tempV31,this.transformation,$y._tempV31),$Fb.TransformNormal($y._tempV32,this.transformation,$y._tempV32);var $r=$y._tempV33;this.transformation.getTranslationVector($r),$$.length=8,$Fb.add($r,$y._tempV30,$y._tempV34),$Fb.add($y._tempV34,$y._tempV31,$y._tempV34),$Fb.add($y._tempV34,$y._tempV32,$$[0]),$Fb.add($r,$y._tempV30,$y._tempV34),$Fb.add($y._tempV34,$y._tempV31,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV32,$$[1]),$Fb.subtract($r,$y._tempV30,$y._tempV34),$Fb.add($y._tempV34,$y._tempV31,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV32,$$[2]),$Fb.subtract($r,$y._tempV30,$y._tempV34),$Fb.add($y._tempV34,$y._tempV31,$y._tempV34),$Fb.add($y._tempV34,$y._tempV32,$$[3]),$Fb.add($r,$y._tempV30,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV31,$y._tempV34),$Fb.add($y._tempV34,$y._tempV32,$$[4]),$Fb.add($r,$y._tempV30,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV31,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV32,$$[5]),$Fb.subtract($r,$y._tempV30,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV31,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV32,$$[6]),$Fb.subtract($r,$y._tempV30,$y._tempV34),$Fb.subtract($y._tempV34,$y._tempV31,$y._tempV34),$Fb.add($y._tempV34,$y._tempV32,$$[7])},$$.transform=function($$){$$b.multiply(this.transformation,$$,this.transformation)},$$.scale=function($$){$Fb.multiply(this.extents,$$,this.extents)},$$.translate=function($$){this.transformation.getTranslationVector($y._tempV30),$Fb.add($y._tempV30,$$,$y._tempV31),this.transformation.setTranslationVector($y._tempV31)},$$.Size=function($$){$Fb.scale(this.extents,2,$$)},$$.getSize=function($$){var $b=this.extents.elements;$y._tempV30.x=$b[0],$y._tempV31.y=$b[1],$y._tempV32.z=$b[2],$Fb.TransformNormal($y._tempV30,this.transformation,$y._tempV30),$Fb.TransformNormal($y._tempV31,this.transformation,$y._tempV31),$Fb.TransformNormal($y._tempV31,this.transformation,$y._tempV32);var $u=$$.elements;$u[0]=$Fb.scalarLength($y._tempV30),$u[1]=$Fb.scalarLength($y._tempV31),$u[2]=$Fb.scalarLength($y._tempV32)},$$.getSizeSquared=function($$){var $b=this.extents.elements;$y._tempV30.x=$b[0],$y._tempV31.y=$b[1],$y._tempV32.z=$b[2],$Fb.TransformNormal($y._tempV30,this.transformation,$y._tempV30),$Fb.TransformNormal($y._tempV31,this.transformation,$y._tempV31),$Fb.TransformNormal($y._tempV31,this.transformation,$y._tempV32);var $u=$$.elements;$u[0]=$Fb.scalarLengthSquared($y._tempV30),$u[1]=$Fb.scalarLengthSquared($y._tempV31),$u[2]=$Fb.scalarLengthSquared($y._tempV32)},$$.getCenter=function($$){this.transformation.getTranslationVector($$)},$$.containsPoint=function($$){var $b=this.extents.elements,$u=$b[0],$Z=$b[1],$E=$b[2];this.transformation.invert($y._tempM0),$Fb.transformCoordinate($$,$y._tempM0,$y._tempV30);var $r=$y._tempV30.elements,$F=Math.abs($r[0]),$x=Math.abs($r[1]),$g=Math.abs($r[2]);return $B$.nearEqual($F,$u)&&$B$.nearEqual($x,$Z)&&$B$.nearEqual($g,$E)?2:$F<$u&&$x<$Z&&$g<$E?1:0},$$.containsPoints=function($$){var $b=this.extents.elements,$u=$b[0],$Z=$b[1],$E=$b[2];this.transformation.invert($y._tempM0);for(var $r=!0,$F=!1,$x=0;$x<$$.length;$x++){$Fb.transformCoordinate($$[$x],$y._tempM0,$y._tempV30);var $g=$y._tempV30.elements,$H=Math.abs($g[0]),$w=Math.abs($g[1]),$I=Math.abs($g[2]);$B$.nearEqual($H,$u)&&$B$.nearEqual($w,$Z)&&$B$.nearEqual($I,$E)&&($F=!0),$H<$u&&$w<$Z&&$I<$E?$F=!0:$r=!1}return $r?1:$F?2:0},$$.containsSphere=function($$,$b){void 0===$b&&($b=!1);var $u=this.extents.elements,$Z=$u[0],$E=$u[1],$r=$u[2],$F=$$.radius;this.transformation.invert($y._tempM0),$Fb.transformCoordinate($$.center,$y._tempM0,$y._tempV30);var $x=NaN;if($x=$b?$F:($Fb.scale($Fb.UnitX,$F,$y._tempV31),$Fb.TransformNormal($y._tempV31,$y._tempM0,$y._tempV31),$Fb.scalarLength($y._tempV31)),$Fb.scale(this.extents,-1,$y._tempV32),$Fb.Clamp($y._tempV30,$y._tempV32,this.extents,$y._tempV33),$x*$x<$Fb.distanceSquared($y._tempV30,$y._tempV33))return 0;var $g=$y._tempV30.elements,$H=$g[0],$w=$g[1],$I=$g[2],$o=$y._tempV32.elements,$N=$o[0],$D=$o[1],$e=$o[2];return $N+$x<=$H&&$H<=$Z-$x&&$x<$Z-$N&&$D+$x<=$w&&$w<=$E-$x&&$x<$E-$D&&$e+$x<=$I&&$I<=$r-$x&&$x<$r-$e?1:2},$$.containsOrientedBoundBox=function($$){var $b=0,$u=0;$$.getCorners($y._corners);var $Z=this.containsPoints($y._corners);if(0!=$Z)return $Z;var $E=this.extents.elements;$$.extents.cloneTo($y._tempV35);var $r=$y._tempV35.elements;$y._getRows(this.transformation,$y._rows1),$y._getRows($$.transformation,$y._rows2);var $F=NaN;for($b=0;$b<4;$b++)for($u=0;$u<4;$u++)3==$b||3==$u?($y._tempM0.setElementByRowColumn($b,$u,0),$y._tempM1.setElementByRowColumn($b,$u,0)):($F=$Fb.dot($y._rows1[$b],$y._rows2[$u]),$y._tempM0.setElementByRowColumn($b,$u,$F),$y._tempM1.setElementByRowColumn($b,$u,Math.abs($F)));$$.getCenter($y._tempV34),this.getCenter($y._tempV36),$Fb.subtract($y._tempV34,$y._tempV36,$y._tempV30);var $x=$y._tempV31.elements;$x[0]=$Fb.dot($y._tempV30,$y._rows1[0]),$x[1]=$Fb.dot($y._tempV30,$y._rows1[1]),$x[2]=$Fb.dot($y._tempV30,$y._rows1[2]);var $g=$y._tempV32.elements,$H=$y._tempV33.elements;for($b=0;$b<3;$b++)if($g[0]=$y._tempM1.getElementByRowColumn($b,0),$g[1]=$y._tempM1.getElementByRowColumn($b,1),$g[2]=$y._tempM1.getElementByRowColumn($b,2),$E[$b]+$Fb.dot($y._tempV35,$y._tempV32)<Math.abs($x[$b]))return 0;for($u=0;$u<3;$u++)if($g[0]=$y._tempM1.getElementByRowColumn(0,$u),$g[1]=$y._tempM1.getElementByRowColumn(1,$u),$g[2]=$y._tempM1.getElementByRowColumn(2,$u),$H[0]=$y._tempM0.getElementByRowColumn(0,$u),$H[1]=$y._tempM0.getElementByRowColumn(1,$u),$H[2]=$y._tempM0.getElementByRowColumn(2,$u),$Fb.dot(this.extents,$y._tempV32)+$r[$u]<Math.abs($Fb.dot($y._tempV31,$y._tempV33)))return 0;for($b=0;$b<3;$b++)for($u=0;$u<3;$u++){var $w=($b+1)%3,$I=($b+2)%3,$o=($u+1)%3,$N=($u+2)%3;if($E[$w]*$y._tempM1.getElementByRowColumn($I,$u)+$E[$I]*$y._tempM1.getElementByRowColumn($w,$u)+($r[$o]*$y._tempM1.getElementByRowColumn($b,$N)+$r[$N]*$y._tempM1.getElementByRowColumn($b,$o))<Math.abs($x[$I]*$y._tempM0.getElementByRowColumn($w,$u)-$x[$w]*$y._tempM0.getElementByRowColumn($I,$u)))return 0}return 2},$$.containsLine=function($$,$b){$y._corners[0]=$$,$y._corners[1]=$b;var $u=this.containsPoints($y._corners);if(0!=$u)return $u;var $Z=this.extents.elements,$E=$Z[0],$r=$Z[1],$F=$Z[2];this.transformation.invert($y._tempM0),$Fb.transformCoordinate($$,$y._tempM0,$y._tempV30),$Fb.transformCoordinate($b,$y._tempM0,$y._tempV31),$Fb.add($y._tempV30,$y._tempV31,$y._tempV32),$Fb.scale($y._tempV32,.5,$y._tempV32),$Fb.subtract($y._tempV30,$y._tempV32,$y._tempV33);var $x=$y._tempV33.elements,$g=$x[0],$H=$x[1],$w=$x[2],$I=$y._tempV34.elements,$o=$I[0]=Math.abs($x[0]),$N=$I[1]=Math.abs($x[1]),$D=$I[2]=Math.abs($x[2]),$e=$y._tempV32.elements,$L=$e[0],$T=$e[1],$_=$e[2];return Math.abs($L)>$E+$o?0:Math.abs($T)>$r+$N?0:Math.abs($_)>$F+$D?0:Math.abs($T*$w-$_*$H)>$r*$D+$F*$N?0:Math.abs($L*$w-$_*$g)>$E*$D+$F*$o?0:Math.abs($L*$H-$T*$g)>$E*$N+$r*$o?0:2},$$.containsBoundBox=function($$){var $b=0,$u=0,$Z=$$.min,$E=$$.max;$$.getCorners($y._corners);var $r=this.containsPoints($y._corners);if(0!=$r)return $r;$Fb.subtract($E,$Z,$y._tempV30),$Fb.scale($y._tempV30,.5,$y._tempV30),$Fb.add($Z,$y._tempV30,$y._tempV30),$Fb.subtract($E,$y._tempV30,$y._tempV31);var $F=this.extents.elements,$x=$y._tempV31.elements;$y._getRows(this.transformation,$y._rows1),this.transformation.invert($y._tempM0);for($b=0;$b<3;$b++)for($u=0;$u<3;$u++)$y._tempM1.setElementByRowColumn($b,$u,Math.abs($y._tempM0.getElementByRowColumn($b,$u)));this.getCenter($y._tempV35),$Fb.subtract($y._tempV30,$y._tempV35,$y._tempV32);var $g=$y._tempV31.elements;$g[0]=$Fb.dot($y._tempV32,$y._rows1[0]),$g[1]=$Fb.dot($y._tempV32,$y._rows1[1]),$g[2]=$Fb.dot($y._tempV32,$y._rows1[2]);var $H=$y._tempV33.elements,$w=$y._tempV34.elements;for($b=0;$b<3;$b++)if($H[0]=$y._tempM1.getElementByRowColumn($b,0),$H[1]=$y._tempM1.getElementByRowColumn($b,1),$H[2]=$y._tempM1.getElementByRowColumn($b,2),$F[$b]+$Fb.dot($y._tempV31,$y._tempV33)<Math.abs($g[$b]))return 0;for($u=0;$u<3;$u++)if($H[0]=$y._tempM1.getElementByRowColumn(0,$u),$H[1]=$y._tempM1.getElementByRowColumn(1,$u),$H[2]=$y._tempM1.getElementByRowColumn(2,$u),$w[0]=$y._tempM0.getElementByRowColumn(0,$u),$w[1]=$y._tempM0.getElementByRowColumn(1,$u),$w[2]=$y._tempM0.getElementByRowColumn(2,$u),$Fb.dot(this.extents,$y._tempV33)+$x[$u]<Math.abs($Fb.dot($y._tempV31,$y._tempV34)))return 0;for($b=0;$b<3;$b++)for($u=0;$u<3;$u++){var $I=($b+1)%3,$o=($b+2)%3,$N=($u+1)%3,$D=($u+2)%3;if($F[$I]*$y._tempM1.getElementByRowColumn($o,$u)+$F[$o]*$y._tempM1.getElementByRowColumn($I,$u)+($x[$N]*$y._tempM1.getElementByRowColumn($b,$D)+$x[$D]*$y._tempM1.getElementByRowColumn($b,$N))<Math.abs($g[$o]*$y._tempM0.getElementByRowColumn($I,$u)-$g[$I]*$y._tempM0.getElementByRowColumn($o,$u)))return 0}return 2},$$.intersectsRay=function($$,$b){$Fb.scale(this.extents,-1,$y._tempV30),this.transformation.invert($y._tempM0),$Fb.TransformNormal($$.direction,$y._tempM0,$y._ray.direction),$Fb.transformCoordinate($$.origin,$y._tempM0,$y._ray.origin),$y._boxBound1.min=$y._tempV30,$y._boxBound1.max=this.extents;var $u=Collision.intersectsRayAndBoxRP($y._ray,$y._boxBound1,$b);return-1!==$u&&$Fb.transformCoordinate($b,this.transformation,$b),$u},$$._getLocalCorners=function($$){$$.length=8;var $b=this.extents.elements;$y._tempV30.x=$b[0],$y._tempV31.y=$b[1],$y._tempV32.z=$b[2],$Fb.add($y._tempV30,$y._tempV31,$y._tempV33),$Fb.add($y._tempV33,$y._tempV32,$$[0]),$Fb.add($y._tempV30,$y._tempV31,$y._tempV33),$Fb.subtract($y._tempV33,$y._tempV32,$$[1]),$Fb.subtract($y._tempV31,$y._tempV30,$y._tempV33),$Fb.subtract($y._tempV33,$y._tempV30,$$[2]),$Fb.subtract($y._tempV31,$y._tempV30,$y._tempV33),$Fb.add($y._tempV33,$y._tempV32,$$[3]),$Fb.subtract($y._tempV30,$y._tempV31,$y._tempV33),$Fb.add($y._tempV33,$y._tempV32,$$[4]),$Fb.subtract($y._tempV30,$y._tempV31,$y._tempV33),$Fb.subtract($y._tempV33,$y._tempV32,$$[5]),$Fb.scale($$[0],-1,$$[6]),$Fb.subtract($y._tempV32,$y._tempV30,$y._tempV33),$Fb.subtract($y._tempV33,$y._tempV31,$$[7])},$$.equals=function($$){return this.extents==$$.extents&&this.transformation==$$.transformation},$$.cloneTo=function($$){var $b=$$;this.extents.cloneTo($b.extents),this.transformation.cloneTo($b.transformation)},$y.createByBoundBox=function($$,$b){var $u=$$.min,$Z=$$.max;$Fb.subtract($Z,$u,$y._tempV30),$Fb.scale($y._tempV30,.5,$y._tempV30),$Fb.add($u,$y._tempV30,$y._tempV31),$Fb.subtract($Z,$y._tempV31,$y._tempV32),$$b.translation($y._tempV31,$y._tempM0);var $E=$y._tempV32.clone(),$r=$y._tempM0.clone();$b.extents=$E,$b.transformation=$r},$y.createByMinAndMaxVertex=function($$,$b){return $Fb.subtract($b,$$,$y._tempV30),$Fb.scale($y._tempV30,.5,$y._tempV30),$Fb.add($$,$y._tempV30,$y._tempV31),$Fb.subtract($b,$y._tempV31,$y._tempV32),$$b.translation($y._tempV31,$y._tempM0),new $y($y._tempV32,$y._tempM0)},$y._getRows=function($$,$b){$b.length=3;var $u=$$.elements,$Z=$b[0].elements;$Z[0]=$u[0],$Z[1]=$u[1],$Z[2]=$u[2];var $E=$b[1].elements;$E[0]=$u[4],$E[1]=$u[5],$E[2]=$u[6];var $r=$b[2].elements;$r[0]=$u[8],$r[1]=$u[9],$r[2]=$u[10]},$y.getObbtoObbMatrix4x4=function($$,$b,$u,$Z){var $E=$$.transformation,$r=$b.transformation;if($u){$y._getRows($E,$y._rows1),$y._getRows($r,$y._rows2);for(var $F=0;$F<3;$F++)for(var $x=0;$x<3;$x++)$Z.setElementByRowColumn($F,$x,$Fb.dot($y._rows2[$F],$y._rows1[$x]));$b.getCenter($y._tempV30),$$.getCenter($y._tempV31),$Fb.subtract($y._tempV30,$y._tempV31,$y._tempV32);var $g=$Z.elements;$g[12]=$Fb.dot($y._tempV32,$y._rows1[0]),$g[13]=$Fb.dot($y._tempV32,$y._rows1[1]),$g[14]=$Fb.dot($y._tempV32,$y._rows1[2]),$g[15]=1}else $E.invert($y._tempM0),$$b.multiply($r,$y._tempM0,$Z)},$y.merge=function($$,$b,$u){var $Z=$$.extents,$E=$$.transformation;$y.getObbtoObbMatrix4x4($$,$b,$u,$y._tempM0),$b._getLocalCorners($y._corners),$Fb.transformCoordinate($y._corners[0],$y._tempM0,$y._corners[0]),$Fb.transformCoordinate($y._corners[1],$y._tempM0,$y._corners[1]),$Fb.transformCoordinate($y._corners[2],$y._tempM0,$y._corners[2]),$Fb.transformCoordinate($y._corners[3],$y._tempM0,$y._corners[3]),$Fb.transformCoordinate($y._corners[4],$y._tempM0,$y._corners[4]),$Fb.transformCoordinate($y._corners[5],$y._tempM0,$y._corners[5]),$Fb.transformCoordinate($y._corners[6],$y._tempM0,$y._corners[6]),$Fb.transformCoordinate($y._corners[7],$y._tempM0,$y._corners[7]),$Fb.scale($Z,-1,$y._boxBound1.min),$Z.cloneTo($y._boxBound1.max),$h$.createfromPoints($y._corners,$y._boxBound2),$h$.merge($y._boxBound2,$y._boxBound1,$y._boxBound3);var $r=$y._boxBound3.min,$F=$y._boxBound3.max;$Fb.subtract($F,$r,$y._tempV30),$Fb.scale($y._tempV30,.5,$y._tempV30),$Fb.add($r,$y._tempV30,$y._tempV32),$Fb.subtract($F,$y._tempV32,$Z),$Fb.transformCoordinate($y._tempV32,$E,$y._tempV33)},$I($y,["_tempV30",function(){return this._tempV30=new $Fb},"_tempV31",function(){return this._tempV31=new $Fb},"_tempV32",function(){return this._tempV32=new $Fb},"_tempV33",function(){return this._tempV33=new $Fb},"_tempV34",function(){return this._tempV34=new $Fb},"_tempV35",function(){return this._tempV35=new $Fb},"_tempV36",function(){return this._tempV36=new $Fb},"_tempM0",function(){return this._tempM0=new $$b},"_tempM1",function(){return this._tempM1=new $$b},"_corners",function(){return this._corners=[new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb]},"_rows1",function(){return this._rows1=[new $Fb,new $Fb,new $Fb]},"_rows2",function(){return this._rows2=[new $Fb,new $Fb,new $Fb]},"_ray",function(){return this._ray=new $Eb(new $Fb,new $Fb)},"_boxBound1",function(){return this._boxBound1=new $h$(new $Fb,new $Fb)},"_boxBound2",function(){return this._boxBound2=new $h$(new $Fb,new $Fb)},"_boxBound3",function(){return this._boxBound3=new $h$(new $Fb,new $Fb)}])}(),function(){function $P($$,$b){this.normal=null,this.distance=NaN,void 0===$b&&($b=0),this.normal=$$,this.distance=$b}return $N($P,"laya.d3.math.Plane"),$P.prototype.normalize=function(){var $$=this.normal.elements,$b=$$[0],$u=$$[1],$Z=$$[2],$E=1/Math.sqrt($b*$b+$u*$u+$Z*$Z);$$[0]=$b*$E,$$[1]=$u*$E,$$[2]=$Z*$E,this.distance*=$E},$P.createPlaneBy3P=function($$,$b,$u){var $Z=$$.elements,$E=$b.elements,$r=$u.elements,$F=$E[0]-$Z[0],$x=$E[1]-$Z[1],$g=$E[2]-$Z[2],$H=$r[0]-$Z[0],$w=$r[1]-$Z[1],$I=$r[2]-$Z[2],$o=$x*$I-$g*$w,$N=$g*$H-$F*$I,$D=$F*$w-$x*$H,$e=1/Math.sqrt($o*$o+$N*$N+$D*$D),$L=$o*$e,$T=$N*$e,$_=$D*$e,$y=$P._TEMPVec3.elements;$y[0]=$L,$y[1]=$T,$y[2]=$_;var $S=-($L*$Z[0]+$T*$Z[1]+$_*$Z[2]);return new $P($P._TEMPVec3,$S)},$P.PlaneIntersectionType_Back=0,$P.PlaneIntersectionType_Front=1,$P.PlaneIntersectionType_Intersecting=2,$I($P,["_TEMPVec3",function(){return this._TEMPVec3=new $Fb}]),$P}()),$ub=function(){function $E($$,$b,$u,$Z){this.elements=new Float32Array(4),void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=1),this.elements[0]=$$,this.elements[1]=$b,this.elements[2]=$u,this.elements[3]=$Z}$N($E,"laya.d3.math.Quaternion");var $$=$E.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.scaling=function($$,$b){var $u=$b.elements,$Z=this.elements;$u[0]=$Z[0]*$$,$u[1]=$Z[1]*$$,$u[2]=$Z[2]*$$,$u[3]=$Z[3]*$$},$$.normalize=function($$){var $b=$$.elements,$u=this.elements,$Z=$u[0],$E=$u[1],$r=$u[2],$F=$u[3],$x=$Z*$Z+$E*$E+$r*$r+$F*$F;0<$x&&($x=1/Math.sqrt($x),$b[0]=$Z*$x,$b[1]=$E*$x,$b[2]=$r*$x,$b[3]=$F*$x)},$$.length=function(){var $$=this.elements,$b=$$[0],$u=$$[1],$Z=$$[2],$E=$$[3];return Math.sqrt($b*$b+$u*$u+$Z*$Z+$E*$E)},$$.rotateX=function($$,$b){var $u=$b.elements,$Z=this.elements;$$*=.5;var $E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$Z[3],$g=Math.sin($$),$H=Math.cos($$);$u[0]=$E*$H+$x*$g,$u[1]=$r*$H+$F*$g,$u[2]=$F*$H-$r*$g,$u[3]=$x*$H-$E*$g},$$.rotateY=function($$,$b){var $u=$b.elements,$Z=this.elements;$$*=.5;var $E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$Z[3],$g=Math.sin($$),$H=Math.cos($$);$u[0]=$E*$H-$F*$g,$u[1]=$r*$H+$x*$g,$u[2]=$F*$H+$E*$g,$u[3]=$x*$H-$r*$g},$$.rotateZ=function($$,$b){var $u=$b.elements,$Z=this.elements;$$*=.5;var $E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$Z[3],$g=Math.sin($$),$H=Math.cos($$);$u[0]=$E*$H+$r*$g,$u[1]=$r*$H-$E*$g,$u[2]=$F*$H+$x*$g,$u[3]=$x*$H-$F*$g},$$.getYawPitchRoll=function($$){$Fb.transformQuat($Fb.ForwardRH,this,$E.TEMPVector31),$Fb.transformQuat($Fb.Up,this,$E.TEMPVector32);var $b=$E.TEMPVector32.elements;$E.angleTo($Fb.ZERO,$E.TEMPVector31,$E.TEMPVector33);var $u=$E.TEMPVector33.elements;$u[0]==Math.PI/2?($u[1]=$E.arcTanAngle($b[2],$b[0]),$u[2]=0):$u[0]==-Math.PI/2?($u[1]=$E.arcTanAngle(-$b[2],-$b[0]),$u[2]=0):($$b.createRotationY(-$u[1],$E.TEMPMatrix0),$$b.createRotationX(-$u[0],$E.TEMPMatrix1),$Fb.transformCoordinate($E.TEMPVector32,$E.TEMPMatrix0,$E.TEMPVector32),$Fb.transformCoordinate($E.TEMPVector32,$E.TEMPMatrix1,$E.TEMPVector32),$u[2]=$E.arcTanAngle($b[1],-$b[0])),$u[1]<=-Math.PI&&($u[1]=Math.PI),$u[2]<=-Math.PI&&($u[2]=Math.PI),$u[1]>=Math.PI&&$u[2]>=Math.PI&&($u[1]=0,$u[2]=0,$u[0]=Math.PI-$u[0]);var $Z=$$.elements;$Z[0]=$u[1],$Z[1]=$u[0],$Z[2]=$u[2]},$$.invert=function($$){var $b=$$.elements,$u=this.elements,$Z=$u[0],$E=$u[1],$r=$u[2],$F=$u[3],$x=$Z*$Z+$E*$E+$r*$r+$F*$F,$g=$x?1/$x:0;$b[0]=-$Z*$g,$b[1]=-$E*$g,$b[2]=-$r*$g,$b[3]=$F*$g},$$.identity=function(){var $$=this.elements;$$[0]=0,$$[1]=0,$$[2]=0,$$[3]=1},$$.fromArray=function($$,$b){void 0===$b&&($b=0),this.elements[0]=$$[$b+0],this.elements[1]=$$[$b+1],this.elements[2]=$$[$b+2],this.elements[3]=$$[$b+3]},$$.cloneTo=function($$){var $b,$u,$Z;if(($u=this.elements)!==($Z=$$.elements))for($b=0;$b<4;++$b)$Z[$b]=$u[$b]},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$$.equals=function($$){var $b=this.elements,$u=$$.elements;return $B$.nearEqual($b[0],$u[0])&&$B$.nearEqual($b[1],$u[1])&&$B$.nearEqual($b[2],$u[2])&&$B$.nearEqual($b[3],$u[3])},$$.lengthSquared=function(){var $$=this.elements[0],$b=this.elements[1],$u=this.elements[2],$Z=this.elements[3];return $$*$$+$b*$b+$u*$u+$Z*$Z},$D(0,$$,"x",function(){return this.elements[0]}),$D(0,$$,"y",function(){return this.elements[1]}),$D(0,$$,"z",function(){return this.elements[2]}),$D(0,$$,"w",function(){return this.elements[3]}),$E.createFromYawPitchRoll=function($$,$b,$u,$Z){var $E=.5*$u,$r=.5*$b,$F=.5*$$,$x=Math.sin($E),$g=Math.cos($E),$H=Math.sin($r),$w=Math.cos($r),$I=Math.sin($F),$o=Math.cos($F),$N=$Z.elements;$N[0]=$o*$H*$g+$I*$w*$x,$N[1]=$I*$w*$g-$o*$H*$x,$N[2]=$o*$w*$x-$I*$H*$g,$N[3]=$o*$w*$g+$I*$H*$x},$E.multiply=function($$,$b,$u){var $Z=$$.elements,$E=$b.elements,$r=$u.elements,$F=$Z[0],$x=$Z[1],$g=$Z[2],$H=$Z[3],$w=$E[0],$I=$E[1],$o=$E[2],$N=$E[3],$D=$x*$o-$g*$I,$e=$g*$w-$F*$o,$L=$F*$I-$x*$w,$T=$F*$w+$x*$I+$g*$o;$r[0]=$F*$N+$w*$H+$D,$r[1]=$x*$N+$I*$H+$e,$r[2]=$g*$N+$o*$H+$L,$r[3]=$H*$N-$T},$E.arcTanAngle=function($$,$b){return 0==$$?1==$b?Math.PI/2:-Math.PI/2:0<$$?Math.atan($b/$$):$$<0?0<$b?Math.atan($b/$$)+Math.PI:Math.atan($b/$$)-Math.PI:0},$E.angleTo=function($$,$b,$u){$Fb.subtract($b,$$,$E.TEMPVector30),$Fb.normalize($E.TEMPVector30,$E.TEMPVector30),$u.elements[0]=Math.asin($E.TEMPVector30.y),$u.elements[1]=$E.arcTanAngle(-$E.TEMPVector30.z,-$E.TEMPVector30.x)},$E.createFromAxisAngle=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements;$b*=.5;var $r=Math.sin($b);$Z[0]=$r*$E[0],$Z[1]=$r*$E[1],$Z[2]=$r*$E[2],$Z[3]=Math.cos($b)},$E.createFromMatrix3x3=function($$,$b){var $u,$Z=$b.elements,$E=$$.elements,$r=$E[0]+$E[4]+$E[8];if(0<$r)$u=Math.sqrt($r+1),$Z[3]=.5*$u,$u=.5/$u,$Z[0]=($E[5]-$E[7])*$u,$Z[1]=($E[6]-$E[2])*$u,$Z[2]=($E[1]-$E[3])*$u;else{var $F=0;$E[4]>$E[0]&&($F=1),$E[8]>$E[3*$F+$F]&&($F=2);var $x=($F+1)%3,$g=($F+2)%3;$u=Math.sqrt($E[3*$F+$F]-$E[3*$x+$x]-$E[3*$g+$g]+1),$Z[$F]=.5*$u,$u=.5/$u,$Z[3]=($E[3*$x+$g]-$E[3*$g+$x])*$u,$Z[$x]=($E[3*$x+$F]+$E[3*$F+$x])*$u,$Z[$g]=($E[3*$g+$F]+$E[3*$F+$g])*$u}},$E.createFromMatrix4x4=function($$,$b){var $u,$Z,$E=$$.elements,$r=$b.elements,$F=$E[0]+$E[5]+$E[10];0<$F?($u=Math.sqrt($F+1),$r[3]=.5*$u,$u=.5/$u,$r[0]=($E[6]-$E[9])*$u,$r[1]=($E[8]-$E[2])*$u,$r[2]=($E[1]-$E[4])*$u):$E[0]>=$E[5]&&$E[0]>=$E[10]?($Z=.5/($u=Math.sqrt(1+$E[0]-$E[5]-$E[10])),$r[0]=.5*$u,$r[1]=($E[1]+$E[4])*$Z,$r[2]=($E[2]+$E[8])*$Z,$r[3]=($E[6]-$E[9])*$Z):$E[5]>$E[10]?($Z=.5/($u=Math.sqrt(1+$E[5]-$E[0]-$E[10])),$r[0]=($E[4]+$E[1])*$Z,$r[1]=.5*$u,$r[2]=($E[9]+$E[6])*$Z,$r[3]=($E[8]-$E[2])*$Z):($Z=.5/($u=Math.sqrt(1+$E[10]-$E[0]-$E[5])),$r[0]=($E[8]+$E[2])*$Z,$r[1]=($E[9]+$E[6])*$Z,$r[2]=.5*$u,$r[3]=($E[1]-$E[4])*$Z)},$E.slerp=function($$,$b,$u,$Z){var $E,$r,$F,$x,$g,$H=$$.elements,$w=$b.elements,$I=$Z.elements,$o=$H[0],$N=$H[1],$D=$H[2],$e=$H[3],$L=$w[0],$T=$w[1],$_=$w[2],$y=$w[3];return($r=$o*$L+$N*$T+$D*$_+$e*$y)<0&&($r=-$r,$L=-$L,$T=-$T,$_=-$_,$y=-$y),$g=1e-6<1-$r?($E=Math.acos($r),$F=Math.sin($E),$x=Math.sin((1-$u)*$E)/$F,Math.sin($u*$E)/$F):($x=1-$u,$u),$I[0]=$x*$o+$g*$L,$I[1]=$x*$N+$g*$T,$I[2]=$x*$D+$g*$_,$I[3]=$x*$e+$g*$y,$I},$E.lerp=function($$,$b,$u,$Z){var $E=$Z.elements,$r=$$.elements,$F=$b.elements,$x=$r[0],$g=$r[1],$H=$r[2],$w=$r[3];$E[0]=$x+$u*($F[0]-$x),$E[1]=$g+$u*($F[1]-$g),$E[2]=$H+$u*($F[2]-$H),$E[3]=$w+$u*($F[3]-$w)},$E.add=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=$E[0]+$r[0],$Z[1]=$E[1]+$r[1],$Z[2]=$E[2]+$r[2],$Z[3]=$E[3]+$r[3]},$E.dot=function($$,$b){var $u=$$.elements,$Z=$b.elements;return $u[0]*$Z[0]+$u[1]*$Z[1]+$u[2]*$Z[2]+$u[3]*$Z[3]},$E.rotationLookAt=function($$,$b,$u){$E.lookAt($Fb.ZERO,$$,$b,$u)},$E.lookAt=function($$,$b,$u,$Z){$R$.lookAt($$,$b,$u,$E._tempMatrix3x3),$E.rotationMatrix($E._tempMatrix3x3,$Z)},$E.invert=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$$.lengthSquared();$B$.isZero($E)||($E=1/$E,$Z[0]=-$u[0]*$E,$Z[1]=-$u[1]*$E,$Z[2]=-$u[2]*$E,$Z[3]=$u[3]*$E)},$E.rotationMatrix=function($$,$b){var $u=$$.elements,$Z=$u[0],$E=$u[1],$r=$u[2],$F=$u[3],$x=$u[4],$g=$u[5],$H=$u[6],$w=$u[7],$I=$u[8],$o=$b.elements,$N=NaN,$D=NaN,$e=$Z+$x+$I;0<$e?($N=Math.sqrt($e+1),$o[3]=.5*$N,$N=.5/$N,$o[0]=($g-$w)*$N,$o[1]=($H-$r)*$N,$o[2]=($E-$F)*$N):$x<=$Z&&$I<=$Z?($D=.5/($N=Math.sqrt(1+$Z-$x-$I)),$o[0]=.5*$N,$o[1]=($E+$F)*$D,$o[2]=($r+$H)*$D,$o[3]=($g-$w)*$D):$I<$x?($D=.5/($N=Math.sqrt(1+$x-$Z-$I)),$o[0]=($F+$E)*$D,$o[1]=.5*$N,$o[2]=($w+$g)*$D,$o[3]=($H-$r)*$D):($D=.5/($N=Math.sqrt(1+$I-$Z-$x)),$o[0]=($H+$r)*$D,$o[1]=($w+$g)*$D,$o[2]=.5*$N,$o[3]=($E-$F)*$D)},$E.DEFAULT=new $E,$I($E,["TEMPVector30",function(){return this.TEMPVector30=new $Fb},"TEMPVector31",function(){return this.TEMPVector31=new $Fb},"TEMPVector32",function(){return this.TEMPVector32=new $Fb},"TEMPVector33",function(){return this.TEMPVector33=new $Fb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $$b},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $$b},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $R$},"NAN",function(){return this.NAN=new $E(NaN,NaN,NaN,NaN)}]),$E}(),$Zb=function(){function $$($$){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$$,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$N($$,"laya.d3.math.Rand");var $b=$$.prototype;return $b.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$b.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$b.getSignedFloat=function(){return 2*this.getFloat()-1},$D(0,$b,"seed",function(){return this.seeds[0]},function($$){this.seeds[0]=$$,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$$.getFloatFromInt=function($$){return 1/8388607*(8388607&$$)},$$.getByteFromInt=function($$){return(8388607&$$)>>>15},$$}(),$Eb=(function(){function $E($$){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($$ instanceof Array)||4!==$$.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$$[0],this._state0L=0|$$[1],this._state1U=0|$$[2],this._state1L=0|$$[3]}$N($E,"laya.d3.math.RandX");var $$=$E.prototype;$$.randomint=function(){var $$=this._state0U,$b=this._state0L,$u=this._state1U,$Z=this._state1L,$E=($Z>>>0)+($b>>>0),$r=$u+$$+($E/2>>>31)>>>0,$F=$E>>>0,$x=0,$g=0;$x=($$^=$x=$$<<23|(-512&$b)>>>9)^(this._state0U=$u),$g=($b^=$g=$b<<23)^(this._state0L=$Z);$x^=$$>>>18,$g^=$b>>>18|(262143&$$)<<14;return $x^=$u>>>5,$g^=$Z>>>5|(31&$u)<<27,this._state1U=$x,this._state1L=$g,[$r,$F]},$$.random=function(){var $$=this.randomint(),$b=$$[0],$u=1023<<20|$b>>>12,$Z=0|($$[1]>>>12|(4095&$b)<<20);return $E._CONVERTION_BUFFER.setUint32(0,$u,!1),$E._CONVERTION_BUFFER.setUint32(4,$Z,!1),$Zb._CONVERTION_BUFFER.getFloat64(0,!1)-1},$I($E,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $Zb([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $$($$,$b){this.origin=null,this.direction=null,this.origin=$$,this.direction=$b}return $N($$,"laya.d3.math.Ray"),$$}()),$rb=function(){function $$($$,$b){this.elements=new Float32Array(2),void 0===$$&&($$=0),void 0===$b&&($b=0);var $u=this.elements;$u[0]=$$,$u[1]=$b}$N($$,"laya.d3.math.Vector2");var $b=$$.prototype;return $P.imps($b,{"laya.d3.core.IClone":!0}),$b.fromArray=function($$,$b){void 0===$b&&($b=0),this.elements[0]=$$[$b+0],this.elements[1]=$$[$b+1]},$b.cloneTo=function($$){var $b=$$.elements,$u=this.elements;$b[0]=$u[0],$b[1]=$u[1]},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"x",function(){return this.elements[0]},function($$){this.elements[0]=$$}),$D(0,$b,"y",function(){return this.elements[1]},function($$){this.elements[1]=$$}),$$.scale=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements;$Z[0]=$E[0]*$b,$Z[1]=$E[1]*$b},$I($$,["ZERO",function(){return this.ZERO=new $$(0,0)},"ONE",function(){return this.ONE=new $$(1,1)}]),$$}(),$Fb=function(){function $w($$,$b,$u){this.elements=new Float32Array(3),void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0);var $Z=this.elements;$Z[0]=$$,$Z[1]=$b,$Z[2]=$u}$N($w,"laya.d3.math.Vector3");var $$=$w.prototype;return $P.imps($$,{"laya.d3.core.IClone":!0}),$$.fromArray=function($$,$b){void 0===$b&&($b=0),this.elements[0]=$$[$b+0],this.elements[1]=$$[$b+1],this.elements[2]=$$[$b+2]},$$.cloneTo=function($$){var $b=$$.elements,$u=this.elements;$b[0]=$u[0],$b[1]=$u[1],$b[2]=$u[2]},$$.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$$.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$$.reset=function($$,$b,$u){this.elements[0]=$$,this.elements[1]=$b,this.elements[2]=$u},$D(0,$$,"x",function(){return this.elements[0]},function($$){this.elements[0]=$$}),$D(0,$$,"y",function(){return this.elements[1]},function($$){this.elements[1]=$$}),$D(0,$$,"z",function(){return this.elements[2]},function($$){this.elements[2]=$$}),$w.distanceSquared=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$u[0]-$Z[0],$r=$u[1]-$Z[1],$F=$u[2]-$Z[2];return $E*$E+$r*$r+$F*$F},$w.distance=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$u[0]-$Z[0],$r=$u[1]-$Z[1],$F=$u[2]-$Z[2];return Math.sqrt($E*$E+$r*$r+$F*$F)},$w.min=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=Math.min($E[0],$r[0]),$Z[1]=Math.min($E[1],$r[1]),$Z[2]=Math.min($E[2],$r[2])},$w.max=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=Math.max($E[0],$r[0]),$Z[1]=Math.max($E[1],$r[1]),$Z[2]=Math.max($E[2],$r[2])},$w.transformQuat=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements,$F=$E[0],$x=$E[1],$g=$E[2],$H=$r[0],$w=$r[1],$I=$r[2],$o=$r[3],$N=$o*$F+$w*$g-$I*$x,$D=$o*$x+$I*$F-$H*$g,$e=$o*$g+$H*$x-$w*$F,$L=-$H*$F-$w*$x-$I*$g;$Z[0]=$N*$o+$L*-$H+$D*-$I-$e*-$w,$Z[1]=$D*$o+$L*-$w+$e*-$H-$N*-$I,$Z[2]=$e*$o+$L*-$I+$N*-$w-$D*-$H},$w.scalarLength=function($$){var $b=$$.elements,$u=$b[0],$Z=$b[1],$E=$b[2];return Math.sqrt($u*$u+$Z*$Z+$E*$E)},$w.scalarLengthSquared=function($$){var $b=$$.elements,$u=$b[0],$Z=$b[1],$E=$b[2];return $u*$u+$Z*$Z+$E*$E},$w.normalize=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$u[0],$r=$u[1],$F=$u[2],$x=$E*$E+$r*$r+$F*$F;0<$x&&($x=1/Math.sqrt($x),$Z[0]=$u[0]*$x,$Z[1]=$u[1]*$x,$Z[2]=$u[2]*$x)},$w.multiply=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=$E[0]*$r[0],$Z[1]=$E[1]*$r[1],$Z[2]=$E[2]*$r[2]},$w.scale=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements;$Z[0]=$E[0]*$b,$Z[1]=$E[1]*$b,$Z[2]=$E[2]*$b},$w.lerp=function($$,$b,$u,$Z){var $E=$Z.elements,$r=$$.elements,$F=$b.elements,$x=$r[0],$g=$r[1],$H=$r[2];$E[0]=$x+$u*($F[0]-$x),$E[1]=$g+$u*($F[1]-$g),$E[2]=$H+$u*($F[2]-$H)},$w.transformV3ToV3=function($$,$b,$u){var $Z=$w._tempVector4;$w.transformV3ToV4($$,$b,$Z);var $E=$Z.elements,$r=$u.elements;$r[0]=$E[0],$r[1]=$E[1],$r[2]=$E[2]},$w.transformV3ToV4=function($$,$b,$u){var $Z=$$.elements,$E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$b.elements,$g=$u.elements;$g[0]=$E*$x[0]+$r*$x[4]+$F*$x[8]+$x[12],$g[1]=$E*$x[1]+$r*$x[5]+$F*$x[9]+$x[13],$g[2]=$E*$x[2]+$r*$x[6]+$F*$x[10]+$x[14],$g[3]=$E*$x[3]+$r*$x[7]+$F*$x[11]+$x[15]},$w.TransformNormal=function($$,$b,$u){var $Z=$$.elements,$E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$b.elements,$g=$u.elements;$g[0]=$E*$x[0]+$r*$x[4]+$F*$x[8],$g[1]=$E*$x[1]+$r*$x[5]+$F*$x[9],$g[2]=$E*$x[2]+$r*$x[6]+$F*$x[10]},$w.transformCoordinate=function($$,$b,$u){var $Z=$w._tempVector4.elements,$E=$$.elements,$r=$E[0],$F=$E[1],$x=$E[2],$g=$b.elements;$Z[0]=$r*$g[0]+$F*$g[4]+$x*$g[8]+$g[12],$Z[1]=$r*$g[1]+$F*$g[5]+$x*$g[9]+$g[13],$Z[2]=$r*$g[2]+$F*$g[6]+$x*$g[10]+$g[14],$Z[3]=1/($r*$g[3]+$F*$g[7]+$x*$g[11]+$g[15]);var $H=$u.elements;$H[0]=$Z[0]*$Z[3],$H[1]=$Z[1]*$Z[3],$H[2]=$Z[2]*$Z[3]},$w.Clamp=function($$,$b,$u,$Z){var $E=$$.elements,$r=$E[0],$F=$E[1],$x=$E[2],$g=$b.elements,$H=$g[0],$w=$g[1],$I=$g[2],$o=$u.elements,$N=$o[0],$D=$o[1],$e=$o[2],$L=$Z.elements;$r=($r=$N<$r?$N:$r)<$H?$H:$r,$F=($F=$D<$F?$D:$F)<$w?$w:$F,$x=($x=$e<$x?$e:$x)<$I?$I:$x,$L[0]=$r,$L[1]=$F,$L[2]=$x},$w.add=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=$E[0]+$r[0],$Z[1]=$E[1]+$r[1],$Z[2]=$E[2]+$r[2]},$w.subtract=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=$E[0]-$r[0],$Z[1]=$E[1]-$r[1],$Z[2]=$E[2]-$r[2]},$w.cross=function($$,$b,$u){var $Z=$$.elements,$E=$b.elements,$r=$u.elements,$F=$Z[0],$x=$Z[1],$g=$Z[2],$H=$E[0],$w=$E[1],$I=$E[2];$r[0]=$x*$I-$g*$w,$r[1]=$g*$H-$F*$I,$r[2]=$F*$w-$x*$H},$w.dot=function($$,$b){var $u=$$.elements,$Z=$b.elements;return $u[0]*$Z[0]+$u[1]*$Z[1]+$u[2]*$Z[2]},$w.equals=function($$,$b){var $u=$$.elements,$Z=$b.elements;return $B$.nearEqual(Math.abs($u[0]),Math.abs($Z[0]))&&$B$.nearEqual(Math.abs($u[1]),Math.abs($Z[1]))&&$B$.nearEqual(Math.abs($u[2]),Math.abs($Z[2]))},$w.ZERO=new $w(0,0,0),$w.ONE=new $w(1,1,1),$w.NegativeUnitX=new $w(-1,0,0),$w.UnitX=new $w(1,0,0),$w.UnitY=new $w(0,1,0),$w.UnitZ=new $w(0,0,1),$w.ForwardRH=new $w(0,0,-1),$w.ForwardLH=new $w(0,0,1),$w.Up=new $w(0,1,0),$w.NAN=new $w(NaN,NaN,NaN),$I($w,["_tempVector4",function(){return this._tempVector4=new $xb}]),$w}(),$xb=function(){function $$($$,$b,$u,$Z){this.elements=new Float32Array(4),void 0===$$&&($$=0),void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=0);var $E=this.elements;$E[0]=$$,$E[1]=$b,$E[2]=$u,$E[3]=$Z}$N($$,"laya.d3.math.Vector4");var $b=$$.prototype;return $P.imps($b,{"laya.d3.core.IClone":!0}),$b.fromArray=function($$,$b){void 0===$b&&($b=0),this.elements[0]=$$[$b+0],this.elements[1]=$$[$b+1],this.elements[2]=$$[$b+2],this.elements[3]=$$[$b+3]},$b.cloneTo=function($$){var $b=$$.elements,$u=this.elements;$b[0]=$u[0],$b[1]=$u[1],$b[2]=$u[2],$b[3]=$u[3]},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$b.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$b.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$D(0,$b,"x",function(){return this.elements[0]},function($$){this.elements[0]=$$}),$D(0,$b,"y",function(){return this.elements[1]},function($$){this.elements[1]=$$}),$D(0,$b,"z",function(){return this.elements[2]},function($$){this.elements[2]=$$}),$D(0,$b,"w",function(){return this.elements[3]},function($$){this.elements[3]=$$}),$$.lerp=function($$,$b,$u,$Z){var $E=$Z.elements,$r=$$.elements,$F=$b.elements,$x=$r[0],$g=$r[1],$H=$r[2],$w=$r[3];$E[0]=$x+$u*($F[0]-$x),$E[1]=$g+$u*($F[1]-$g),$E[2]=$H+$u*($F[2]-$H),$E[3]=$w+$u*($F[3]-$w)},$$.transformByM4x4=function($$,$b,$u){var $Z=$$.elements,$E=$Z[0],$r=$Z[1],$F=$Z[2],$x=$Z[3],$g=$b.elements,$H=$u.elements;$H[0]=$E*$g[0]+$r*$g[4]+$F*$g[8]+$x*$g[12],$H[1]=$E*$g[1]+$r*$g[5]+$F*$g[9]+$x*$g[13],$H[2]=$E*$g[2]+$r*$g[6]+$F*$g[10]+$x*$g[14],$H[3]=$E*$g[3]+$r*$g[7]+$F*$g[11]+$x*$g[15]},$$.equals=function($$,$b){var $u=$$.elements,$Z=$b.elements;return $B$.nearEqual(Math.abs($u[0]),Math.abs($Z[0]))&&$B$.nearEqual(Math.abs($u[1]),Math.abs($Z[1]))&&$B$.nearEqual(Math.abs($u[2]),Math.abs($Z[2]))&&$B$.nearEqual(Math.abs($u[3]),Math.abs($Z[3]))},$$.normalize=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$$.length();0<$E&&($Z[0]=$u[0]*$E,$Z[1]=$u[1]*$E,$Z[2]=$u[2]*$E,$Z[3]=$u[3]*$E)},$$.add=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=$E[0]+$r[0],$Z[1]=$E[1]+$r[1],$Z[2]=$E[2]+$r[2],$Z[3]=$E[3]+$r[3]},$$.subtract=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=$E[0]-$r[0],$Z[1]=$E[1]-$r[1],$Z[2]=$E[2]-$r[2],$Z[3]=$E[3]-$r[3]},$$.multiply=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=$E[0]*$r[0],$Z[1]=$E[1]*$r[1],$Z[2]=$E[2]*$r[2],$Z[3]=$E[3]*$r[3]},$$.scale=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements;$Z[0]=$E[0]*$b,$Z[1]=$E[1]*$b,$Z[2]=$E[2]*$b,$Z[3]=$E[3]*$b},$$.Clamp=function($$,$b,$u,$Z){var $E=$$.elements,$r=$E[0],$F=$E[1],$x=$E[2],$g=$E[3],$H=$b.elements,$w=$H[0],$I=$H[1],$o=$H[2],$N=$H[3],$D=$u.elements,$e=$D[0],$L=$D[1],$T=$D[2],$_=$D[3],$y=$Z.elements;$r=($r=$e<$r?$e:$r)<$w?$w:$r,$F=($F=$L<$F?$L:$F)<$I?$I:$F,$x=($x=$T<$x?$T:$x)<$o?$o:$x,$g=($g=$_<$g?$_:$g)<$N?$N:$g,$y[0]=$r,$y[1]=$F,$y[2]=$x,$y[3]=$g},$$.distanceSquared=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$u[0]-$Z[0],$r=$u[1]-$Z[1],$F=$u[2]-$Z[2],$x=$u[3]-$Z[3];return $E*$E+$r*$r+$F*$F+$x*$x},$$.distance=function($$,$b){var $u=$$.elements,$Z=$b.elements,$E=$u[0]-$Z[0],$r=$u[1]-$Z[1],$F=$u[2]-$Z[2],$x=$u[3]-$Z[3];return Math.sqrt($E*$E+$r*$r+$F*$F+$x*$x)},$$.dot=function($$,$b){var $u=$$.elements,$Z=$b.elements;return $u[0]*$Z[0]+$u[1]*$Z[1]+$u[2]*$Z[2]+$u[3]*$Z[3]},$$.min=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=Math.min($E[0],$r[0]),$Z[1]=Math.min($E[1],$r[1]),$Z[2]=Math.min($E[2],$r[2]),$Z[3]=Math.min($E[3],$r[3])},$$.max=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b.elements;$Z[0]=Math.max($E[0],$r[0]),$Z[1]=Math.max($E[1],$r[1]),$Z[2]=Math.max($E[2],$r[2]),$Z[3]=Math.max($E[3],$r[3])},$I($$,["ZERO",function(){return this.ZERO=new $$},"ONE",function(){return this.ONE=new $$(1,1,1,1)},"UnitX",function(){return this.UnitX=new $$(1,0,0,0)},"UnitY",function(){return this.UnitY=new $$(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $$(0,0,1,0)},"UnitW",function(){return this.UnitW=new $$(0,0,0,1)}]),$$}(),$gb=function(){function $r($$,$b,$u,$Z){this.minDepth=0,this.maxDepth=1,this.x=$$,this.y=$b,this.width=$u,this.height=$Z}$N($r,"laya.d3.math.Viewport");var $$=$r.prototype;return $$.project=function($$,$b,$u){$Fb.transformV3ToV3($$,$b,$u);var $Z=$$.elements,$E=$b.elements,$r=$u.elements,$F=$Z[0]*$E[3]+$Z[1]*$E[7]+$Z[2]*$E[11]+$E[15];1!==$F&&($r[0]=$r[0]/$F,$r[1]=$r[1]/$F,$r[2]=$r[2]/$F),$r[0]=.5*($r[0]+1)*this.width+this.x,$r[1]=.5*(1-$r[1])*this.height+this.y,$r[2]=$r[2]*(this.maxDepth-this.minDepth)+this.minDepth},$$.unprojectFromMat=function($$,$b,$u){var $Z=$$.elements,$E=$b.elements,$r=$u.elements;$r[0]=($Z[0]-this.x)/this.width*2-1,$r[1]=-(($Z[1]-this.y)/this.height*2-1);var $F=(this.maxDepth-this.minDepth)/2;$r[2]=($Z[2]-this.minDepth-$F)/$F;var $x=$r[0]*$E[3]+$r[1]*$E[7]+$r[2]*$E[11]+$E[15];$Fb.transformV3ToV3($u,$b,$u),1!==$x&&($r[0]=$r[0]/$x,$r[1]=$r[1]/$x,$r[2]=$r[2]/$x)},$$.unprojectFromWVP=function($$,$b,$u,$Z,$E){$$b.multiply($b,$u,$r._tempMatrix4x4),$Z&&$$b.multiply($r._tempMatrix4x4,$Z,$r._tempMatrix4x4),$r._tempMatrix4x4.invert($r._tempMatrix4x4),this.unprojectFromMat($$,$r._tempMatrix4x4,$E)},$I($r,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $$b}]),$r}(),$Hb=function(){function $K($$){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$$,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$N($K,"laya.d3.resource.models.SubMesh");var $$=$K.prototype;return $P.imps($$,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$$._getVertexBuffer=function($$){return void 0===$$&&($$=0),0===$$?this._vertexBuffer:null},$$._getIndexBuffer=function(){return this._indexBuffer},$$._getStaticBatchBakedVertexs=function($$,$b){var $u,$Z,$E=this._vertexBuffer,$r=$E.vertexDeclaration,$F=$r.getVertexElementByUsage(0).offset/4,$x=$r.getVertexElementByUsage(3).offset/4,$g=$b.meshRender.lightmapScaleOffset,$H=0,$w=0,$I=0,$o=0,$N=0,$D=0;if($g)if($Z=$r.getVertexElementByUsage(15))$I=$r.vertexStride/4,$u=0<this._vertexCount?$E.getData().slice(this._vertexStart*$I,(this._vertexStart+this._vertexCount)*$I):$E.getData().slice(),$o=$Z.offset/4;else{$I=($D=$r.vertexStride/4)+2,$u=this._vertexCount?new Float32Array(this._vertexCount*($E.vertexDeclaration.vertexStride/4+2)):new Float32Array($E.vertexCount*($E.vertexDeclaration.vertexStride/4+2)),$o=($N=$r.getVertexElementByUsage(2).offset/4)+2;var $e=$E.getData();for($H=0,$w=$e.length/$D;$H<$w;$H++){var $L=0;$L=0<this._vertexCount?(this._vertexStart+$H)*$D:$H*$D;var $T=$H*$I,$_=0;for($_=0;$_<$o;$_++)$u[$T+$_]=$e[$L+$_];for($_=$o;$_<$D;$_++)$u[$T+$_+2]=$e[$L+$_]}}else $I=$r.vertexStride/4,$u=this._vertexCount?$E.getData().slice(this._vertexStart*$I,(this._vertexStart+this._vertexCount)*$I):$E.getData().slice();if($$){var $y=$$.worldMatrix,$S=$K._tempMatrix4x40;$y.invert($S);var $P=$K._tempMatrix4x41,$i=$b.transform.worldMatrix;$$b.multiply($S,$i,$P)}else $P=$b.transform.worldMatrix;var $z=$K._tempQuaternion0;for($P.decomposeTransRotScale($K._tempVector30,$z,$K._tempVector31),$H=0,$w=$u.length/$I;$H<$w;$H++){var $q=$H*$I+$F,$a=$H*$I+$x;if($Lb.transformVector3ArrayToVector3ArrayCoordinate($u,$q,$P,$u,$q),$Lb.transformVector3ArrayByQuat($u,$a,$z,$u,$a),$g){var $t=$H*$I+$o;if($Z)$Lb.transformLightingMapTexcoordByUV1Array($u,$t,$g,$u,$t);else{var $C=$H*$D+$N;$Lb.transformLightingMapTexcoordByUV0Array($e,$C,$g,$u,$t)}}}return $u},$$._getVertexBuffers=function(){return null},$$._beforeRender=function($$){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$$._render=function($$){var $b,$u=0,$Z=$$.renderElement;if(1<this._indexCount){var $E=this._boneIndicesList.length;if(1<$E){for(var $r=0;$r<$E;$r++)($b=$Z._skinAnimationDatas||this._skinAnimationDatas)&&($Z._shaderValue.setValue(0,$b[$r]),$$._shader.uploadRenderElementUniforms($Z._shaderValue.data)),$O.mainContext.drawElements(4,this._subIndexBufferCount[$r],5123,2*this._subIndexBufferStart[$r]);$q.drawCall+=$E}else($b=$Z._skinAnimationDatas||this._skinAnimationDatas)&&($Z._shaderValue.setValue(0,$b[0]),$$._shader.uploadRenderElementUniforms($Z._shaderValue.data)),$O.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$q.drawCall++;$u=this._indexCount}else $u=this._indexBuffer.indexCount,($b=$Z._skinAnimationDatas||this._skinAnimationDatas)&&($Z._shaderValue.setValue(0,$b[0]),$$._shader.uploadRenderElementUniforms($Z._shaderValue.data)),$O.mainContext.drawElements(4,$u,5123,0),$q.drawCall++;$q.trianglesFaces+=$u/3},$$.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$$.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$D(0,$$,"_vertexBufferCount",function(){return 1}),$D(0,$$,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$I($K,["_tempVector30",function(){return this._tempVector30=new $Fb},"_tempVector31",function(){return this._tempVector31=new $Fb},"_tempQuaternion0",function(){return this._tempQuaternion0=new $ub},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $$b},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $$b}]),$K}(),$wb=function(){function $$($$){this.defineCounter=0,this.defines=null,$$?(this.defineCounter=$$.defineCounter,this.defines=$$.defines.slice()):(this.defineCounter=0,this.defines=[])}return $N($$,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$$.prototype.registerDefine=function($$){var $b=Math.pow(2,this.defineCounter++);return this.defines[$b]=$$,$b},$$}(),$Ib=function(){function $$(){}return $N($$,"laya.d3.shader.ShaderInit3D"),$$.__init__=function(){var $$,$b;$qb._globalRegDefine("HIGHPRECISION",$qb.SHADERDEFINE_HIGHPRECISION),$qb._globalRegDefine("FOG",$qb.SHADERDEFINE_FOG),$qb._globalRegDefine("DIRECTIONLIGHT",$qb.SHADERDEFINE_DIRECTIONLIGHT),$qb._globalRegDefine("POINTLIGHT",$qb.SHADERDEFINE_POINTLIGHT),$qb._globalRegDefine("SPOTLIGHT",$qb.SHADERDEFINE_SPOTLIGHT),$qb._globalRegDefine("UV",$qb.SHADERDEFINE_UV0),$qb._globalRegDefine("COLOR",$qb.SHADERDEFINE_COLOR),$qb._globalRegDefine("UV1",$qb.SHADERDEFINE_UV1),$qb._globalRegDefine("CASTSHADOW",$Nb.SHADERDEFINE_CAST_SHADOW),$qb._globalRegDefine("SHADOWMAP_PSSM1",$Nb.SHADERDEFINE_SHADOW_PSSM1),$qb._globalRegDefine("SHADOWMAP_PSSM2",$Nb.SHADERDEFINE_SHADOW_PSSM2),$qb._globalRegDefine("SHADOWMAP_PSSM3",$Nb.SHADERDEFINE_SHADOW_PSSM3),$qb._globalRegDefine("SHADOWMAP_PCF_NO",$Nb.SHADERDEFINE_SHADOW_PCF_NO),$qb._globalRegDefine("SHADOWMAP_PCF1",$Nb.SHADERDEFINE_SHADOW_PCF1),$qb._globalRegDefine("SHADOWMAP_PCF2",$Nb.SHADERDEFINE_SHADOW_PCF2),$qb._globalRegDefine("SHADOWMAP_PCF3",$Nb.SHADERDEFINE_SHADOW_PCF3),$qb._globalRegDefine("DEPTHFOG",$qb.SAHDERDEFINE_DEPTHFOG),$Mb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$Mb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$$={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$b={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $u=$Mb.nameKey.add("SIMPLE");shaderCompile=$qb.add($u,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$$,$b),$lb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$lb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$lb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$lb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$lb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$lb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$lb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$lb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$lb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},$$}(),$ob=function(){function $$(){this._data=null,this._data=[]}$N($$,"laya.d3.shader.ValusArray");var $b=$$.prototype;return $b.setValue=function($$,$b){this._data[$$]=$b},$D(0,$b,"data",function(){return this._data}),$$}(),$Nb=function(){function $$(){}return $$.SHADERDEFINE_RECEIVE_SHADOW=1,$$.SHADERDEFINE_CAST_SHADOW=512,$$.SHADERDEFINE_SHADOW_PSSM1=1024,$$.SHADERDEFINE_SHADOW_PSSM2=2048,$$.SHADERDEFINE_SHADOW_PSSM3=4096,$$.SHADERDEFINE_SHADOW_PCF_NO=8192,$$.SHADERDEFINE_SHADOW_PCF1=16384,$$.SHADERDEFINE_SHADOW_PCF2=32768,$$.SHADERDEFINE_SHADOW_PCF3=65536,$$.MAX_PSSM_COUNT=3,$$}(),$Db=function(){function $A(){}return $N($A,"laya.d3.utils.Picker"),$A.calculateCursorRay=function($$,$b,$u,$Z,$E,$r){var $F=$$.elements[0],$x=$$.elements[1],$g=$A._tempVector30,$H=$g.elements;$H[0]=$F,$H[1]=$x,$H[2]=$b.minDepth;var $w=$A._tempVector31,$I=$w.elements;$I[0]=$F,$I[1]=$x,$I[2]=$b.maxDepth;var $o=$r.origin,$N=$A._tempVector32;$b.unprojectFromWVP($g,$u,$Z,$E,$o),$b.unprojectFromWVP($w,$u,$Z,$E,$N);var $D=$r.direction.elements;$D[0]=$N.x-$o.x,$D[1]=$N.y-$o.y,$D[2]=$N.z-$o.z,$Fb.normalize($r.direction,$r.direction)},$A.rayIntersectsPositionsAndIndices=function($$,$b,$u,$Z,$E){for(var $r=$u.vertexStride/4,$F=$u.getVertexElementByUsage(0).offset/4,$x=Number.MAX_VALUE,$g=-1,$H=-1,$w=-1,$I=0;$I<$Z.length;$I+=3){var $o=$A._tempVector35,$N=$o.elements,$D=$Z[$I]*$r,$e=$D+$F;$N[0]=$b[$e],$N[1]=$b[1+$e],$N[2]=$b[2+$e];var $L=$A._tempVector36,$T=$L.elements,$_=$Z[$I+1]*$r,$y=$_+$F;$T[0]=$b[$y],$T[1]=$b[1+$y],$T[2]=$b[2+$y];var $S=$A._tempVector37,$P=$S.elements,$i=$Z[$I+2]*$r,$z=$i+$F;$P[0]=$b[$z],$P[1]=$b[1+$z],$P[2]=$b[2+$z];var $q=laya.d3.utils.Picker.rayIntersectsTriangle($$,$o,$L,$S);!isNaN($q)&&$q<$x&&($x=$q,$g=$D,$H=$_,$w=$i)}if($x===Number.MAX_VALUE)return $E.position.toDefault(),$E.distance=Number.MAX_VALUE,$E.trianglePositions[0].toDefault(),$E.trianglePositions[1].toDefault(),$E.trianglePositions[2].toDefault(),$E.triangleNormals[0].toDefault(),$E.triangleNormals[1].toDefault(),$E.triangleNormals[2].toDefault(),!1;$E.distance=$x,$Fb.scale($$.direction,$x,$E.position),$Fb.add($$.origin,$E.position,$E.position);var $a=$E.trianglePositions,$t=$a[0],$C=$a[1],$K=$a[2],$O=$t.elements,$V=$C.elements,$v=$K.elements,$p=$g+$F;$O[0]=$b[$p],$O[1]=$b[$p+1],$O[2]=$b[$p+2];var $Y=$H+$F;$V[0]=$b[$Y],$V[1]=$b[$Y+1],$V[2]=$b[$Y+2];var $k=$w+$F;$v[0]=$b[$k],$v[1]=$b[$k+1],$v[2]=$b[$k+2];var $M=$u.getVertexElementByUsage(3);if($M){var $l=$M.offset/4,$X=$E.triangleNormals,$s=$X[0],$m=$X[1],$n=$X[2],$c=$s.elements,$J=$m.elements,$f=$n.elements,$Q=$g+$l;$c[0]=$b[$Q],$c[1]=$b[$Q+1],$c[2]=$b[$Q+2];var $W=$H+$l;$J[0]=$b[$W],$J[1]=$b[$W+1],$J[2]=$b[$W+2];var $G=$w+$l;$f[0]=$b[$G],$f[1]=$b[$G+1],$f[2]=$b[$G+2]}return!0},$A.rayIntersectsTriangle=function($$,$b,$u,$Z){var $E=$A._tempVector30,$r=$A._tempVector31;$Fb.subtract($u,$b,$E),$Fb.subtract($Z,$b,$r);var $F,$x=$A._tempVector32;if($Fb.cross($$.direction,$r,$x),($F=$Fb.dot($E,$x))>-Number.MIN_VALUE&&$F<Number.MIN_VALUE)return Number.NaN;var $g,$H=1/$F,$w=$A._tempVector33;if($Fb.subtract($$.origin,$b,$w),$g=$Fb.dot($w,$x),($g*=$H)<0||1<$g)return Number.NaN;var $I,$o,$N=$A._tempVector34;return $Fb.cross($w,$E,$N),$I=$Fb.dot($$.direction,$N),($I*=$H)<0||1<$g+$I?Number.NaN:($o=$Fb.dot($r,$N),($o*=$H)<0?Number.NaN:$o)},$I($A,["_tempVector30",function(){return this._tempVector30=new $Fb},"_tempVector31",function(){return this._tempVector31=new $Fb},"_tempVector32",function(){return this._tempVector32=new $Fb},"_tempVector33",function(){return this._tempVector33=new $Fb},"_tempVector34",function(){return this._tempVector34=new $Fb},"_tempVector35",function(){return this._tempVector35=new $Fb},"_tempVector36",function(){return this._tempVector36=new $Fb},"_tempVector37",function(){return this._tempVector37=new $Fb}]),$A}(),$eb=(function(){function $$(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $Fb,new $Fb,new $Fb],this.trianglePositions.length=3,this.triangleNormals=[new $Fb,new $Fb,new $Fb],this.triangleNormals.length=3,this.position=new $Fb}$N($$,"laya.d3.utils.RaycastHit"),$$.prototype.cloneTo=function($$){$$.distance=this.distance,this.trianglePositions[0].cloneTo($$.trianglePositions[0]),this.trianglePositions[1].cloneTo($$.trianglePositions[1]),this.trianglePositions[2].cloneTo($$.trianglePositions[2]),this.triangleNormals[0].cloneTo($$.triangleNormals[0]),this.triangleNormals[1].cloneTo($$.triangleNormals[1]),this.triangleNormals[2].cloneTo($$.triangleNormals[2]),this.position.cloneTo($$.position),$$.sprite3D=this.sprite3D}}(),function(){function $$($$,$b){this._width=0,this._height=0,this._width=$$,this._height=$b}$N($$,"laya.d3.utils.Size");var $b=$$.prototype;return $D(0,$b,"width",function(){return-1===this._width?$j.clientWidth:this._width}),$D(0,$b,"height",function(){return-1===this._height?$j.clientHeight:this._height}),$D(1,$$,"fullScreen",function(){return new $$(-1,-1)}),$$}()),$Lb=function(){function $p(){}return $N($p,"laya.d3.utils.Utils3D"),$p._rotationTransformScaleSkinAnimation=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I){var $o,$N,$D,$e,$L,$T=$p._tempArray16_0,$_=$p._tempArray16_1,$y=$p._tempArray16_2,$S=$Z+$Z,$P=$E+$E,$i=$r+$r,$z=$Z*$S,$q=$E*$S,$a=$E*$P,$t=$r*$S,$C=$r*$P,$K=$r*$i,$O=$F*$S,$V=$F*$P,$v=$F*$i;for($T[15]=1,$T[0]=1-$a-$K,$T[1]=$q+$v,$T[2]=$t-$V,$T[4]=$q-$v,$T[5]=1-$z-$K,$T[6]=$C+$O,$T[8]=$t+$V,$T[9]=$C-$O,$T[10]=1-$z-$a,$_[15]=1,$_[0]=$x,$_[5]=$g,$_[10]=$H,$o=0;$o<4;$o++)$N=$T[$o],$D=$T[$o+4],$e=$T[$o+8],$L=$T[$o+12],$y[$o]=$N,$y[$o+4]=$D,$y[$o+8]=$e,$y[$o+12]=$N*$$+$D*$b+$e*$u+$L;for($o=0;$o<4;$o++)$N=$y[$o],$D=$y[$o+4],$e=$y[$o+8],$L=$y[$o+12],$w[$o+$I]=$N*$_[0]+$D*$_[1]+$e*$_[2]+$L*$_[3],$w[$o+$I+4]=$N*$_[4]+$D*$_[5]+$e*$_[6]+$L*$_[7],$w[$o+$I+8]=$N*$_[8]+$D*$_[9]+$e*$_[10]+$L*$_[11],$w[$o+$I+12]=$N*$_[12]+$D*$_[13]+$e*$_[14]+$L*$_[15]},$p._createNodeByJson=function($$,$b,$u,$Z){if(!$u)switch($b.type){case"Sprite3D":$u=new $kb;break;case"MeshSprite3D":$u=new $Ab;break;case"SkinnedMeshSprite3D":$u=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$u=new ShuriKenParticle3D;break;case"TrailSprite3D":$u=new TrailSprite3D;break;case"Terrain":$u=new Terrain;break;case"Camera":$u=new $Gb;break;case"DirectionLight":$u=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $E=$b.props;if($E)for(var $r in $E)$u[$r]=$E[$r];var $F=$b.customProps;$F&&($u instanceof laya.d3.core.Sprite3D?($u._parseBaseCustomProps($F),$u._parseCustomProps($$,$Z,$F,$b),$u._parseCustomComponent($$,$Z,$b.components)):$u._parseCustomProps($$,$Z,$F,$b));var $x=$b.child;if($x)for(var $g=0,$H=$x.length;$g<$H;$g++){var $w=$p._createNodeByJson($$,$x[$g],null,$Z);$u.addChild($w)}return $u},$p._computeBoneAndAnimationDatasByBindPoseMatrxix=function($$,$b,$u,$Z,$E,$r){var $F,$x,$g=0,$H=0,$w=$$.length;for($F=0;$F<$w;$g+=$$[$F].keyframeWidth,$H+=16,$F++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($b[$g+0],$b[$g+1],$b[$g+2],$b[$g+3],$b[$g+4],$b[$g+5],$b[$g+6],$b[$g+7],$b[$g+8],$b[$g+9],$Z,$H),0!=$F&&($x=16*$$[$F].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($Z,$x,$Z,$H,$Z,$H));var $I=$u.length;for($F=0;$F<$I;$F++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Z,16*$r[$F],$u[$F],$E,16*$F)},$p._computeAnimationDatasByArrayAndMatrixFast=function($$,$b,$u,$Z){for(var $E=0,$r=$$.length;$E<$r;$E++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($b,16*$Z[$E],$$[$E],$u,16*$E)},$p._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($$,$b,$u,$Z,$E){var $r,$F,$x=0,$g=0,$H=$$.length;for($r=0;$r<$H;$x+=$$[$r].keyframeWidth,$g+=16,$r++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($b[$x+7],$b[$x+8],$b[$x+9],$b[$x+3],$b[$x+4],$b[$x+5],$b[$x+6],$b[$x+0],$b[$x+1],$b[$x+2],$Z,$g),0!=$r&&($F=16*$$[$r].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($Z,$F,$Z,$g,$Z,$g));var $w=$u.length;for($r=0;$r<$w;$r++){var $I=16*$r;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Z,$I,$u[$r],$E,$I)}},$p._computeAnimationDatasByArrayAndMatrixFastOld=function($$,$b,$u){for(var $Z=$$.length,$E=0;$E<$Z;$E++){var $r=16*$E;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($b,$r,$$[$E],$u,$r)}},$p._computeRootAnimationData=function($$,$b,$u){for(var $Z=0,$E=0,$r=0,$F=$$.length;$Z<$F;$E+=$$[$Z].keyframeWidth,$r+=16,$Z++)laya.d3.utils.Utils3D.createAffineTransformationArray($b[$E+0],$b[$E+1],$b[$E+2],$b[$E+3],$b[$E+4],$b[$E+5],$b[$E+6],$b[$E+7],$b[$E+8],$b[$E+9],$u,$r)},$p.transformVector3ArrayByQuat=function($$,$b,$u,$Z,$E){var $r=$u.elements,$F=$$[$b],$x=$$[$b+1],$g=$$[$b+2],$H=$r[0],$w=$r[1],$I=$r[2],$o=$r[3],$N=$o*$F+$w*$g-$I*$x,$D=$o*$x+$I*$F-$H*$g,$e=$o*$g+$H*$x-$w*$F,$L=-$H*$F-$w*$x-$I*$g;$Z[$E]=$N*$o+$L*-$H+$D*-$I-$e*-$w,$Z[$E+1]=$D*$o+$L*-$w+$e*-$H-$N*-$I,$Z[$E+2]=$e*$o+$L*-$I+$N*-$w-$D*-$H},$p.mulMatrixByArray=function($$,$b,$u,$Z,$E,$r){var $F,$x,$g,$H,$w;if($E===$u){for($u=$p._tempArray16_3,$F=0;$F<16;++$F)$u[$F]=$E[$r+$F];$Z=0}for($F=0;$F<4;$F++)$x=$$[$b+$F],$g=$$[$b+$F+4],$H=$$[$b+$F+8],$w=$$[$b+$F+12],$E[$r+$F]=$x*$u[$Z+0]+$g*$u[$Z+1]+$H*$u[$Z+2]+$w*$u[$Z+3],$E[$r+$F+4]=$x*$u[$Z+4]+$g*$u[$Z+5]+$H*$u[$Z+6]+$w*$u[$Z+7],$E[$r+$F+8]=$x*$u[$Z+8]+$g*$u[$Z+9]+$H*$u[$Z+10]+$w*$u[$Z+11],$E[$r+$F+12]=$x*$u[$Z+12]+$g*$u[$Z+13]+$H*$u[$Z+14]+$w*$u[$Z+15]},$p.mulMatrixByArrayFast=function($$,$b,$u,$Z,$E,$r){var $F,$x,$g,$H,$w;for($F=0;$F<4;$F++)$x=$$[$b+$F],$g=$$[$b+$F+4],$H=$$[$b+$F+8],$w=$$[$b+$F+12],$E[$r+$F]=$x*$u[$Z+0]+$g*$u[$Z+1]+$H*$u[$Z+2]+$w*$u[$Z+3],$E[$r+$F+4]=$x*$u[$Z+4]+$g*$u[$Z+5]+$H*$u[$Z+6]+$w*$u[$Z+7],$E[$r+$F+8]=$x*$u[$Z+8]+$g*$u[$Z+9]+$H*$u[$Z+10]+$w*$u[$Z+11],$E[$r+$F+12]=$x*$u[$Z+12]+$g*$u[$Z+13]+$H*$u[$Z+14]+$w*$u[$Z+15]},$p.mulMatrixByArrayAndMatrixFast=function($$,$b,$u,$Z,$E){var $r,$F,$x,$g,$H,$w=$u.elements,$I=$w[0],$o=$w[1],$N=$w[2],$D=$w[3],$e=$w[4],$L=$w[5],$T=$w[6],$_=$w[7],$y=$w[8],$S=$w[9],$P=$w[10],$i=$w[11],$z=$w[12],$q=$w[13],$a=$w[14],$t=$w[15],$C=$b,$K=$b+4,$O=$b+8,$V=$b+12,$v=$E,$p=$E+4,$Y=$E+8,$k=$E+12;for($r=0;$r<4;$r++)$F=$$[$C+$r],$x=$$[$K+$r],$g=$$[$O+$r],$H=$$[$V+$r],$Z[$v+$r]=$F*$I+$x*$o+$g*$N+$H*$D,$Z[$p+$r]=$F*$e+$x*$L+$g*$T+$H*$_,$Z[$Y+$r]=$F*$y+$x*$S+$g*$P+$H*$i,$Z[$k+$r]=$F*$z+$x*$q+$g*$a+$H*$t},$p.createAffineTransformationArray=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I){var $o=$Z+$Z,$N=$E+$E,$D=$r+$r,$e=$Z*$o,$L=$Z*$N,$T=$Z*$D,$_=$E*$N,$y=$E*$D,$S=$r*$D,$P=$F*$o,$i=$F*$N,$z=$F*$D;$w[$I+0]=(1-($_+$S))*$x,$w[$I+1]=($L+$z)*$x,$w[$I+2]=($T-$i)*$x,$w[$I+3]=0,$w[$I+4]=($L-$z)*$g,$w[$I+5]=(1-($e+$S))*$g,$w[$I+6]=($y+$P)*$g,$w[$I+7]=0,$w[$I+8]=($T+$i)*$H,$w[$I+9]=($y-$P)*$H,$w[$I+10]=(1-($e+$_))*$H,$w[$I+11]=0,$w[$I+12]=$$,$w[$I+13]=$b,$w[$I+14]=$u,$w[$I+15]=1},$p.transformVector3ArrayToVector3ArrayCoordinate=function($$,$b,$u,$Z,$E){var $r=$p._tempArray4_0,$F=$$[$b+0],$x=$$[$b+1],$g=$$[$b+2],$H=$u.elements;$r[0]=$F*$H[0]+$x*$H[4]+$g*$H[8]+$H[12],$r[1]=$F*$H[1]+$x*$H[5]+$g*$H[9]+$H[13],$r[2]=$F*$H[2]+$x*$H[6]+$g*$H[10]+$H[14],$r[3]=1/($F*$H[3]+$x*$H[7]+$g*$H[11]+$H[15]),$Z[$E+0]=$r[0]*$r[3],$Z[$E+1]=$r[1]*$r[3],$Z[$E+2]=$r[2]*$r[3]},$p.transformLightingMapTexcoordByUV0Array=function($$,$b,$u,$Z,$E){var $r=$u.elements;$Z[$E+0]=$$[$b+0]*$r[0]+$r[2],$Z[$E+1]=($$[$b+1]-1)*$r[1]+$r[3]},$p.transformLightingMapTexcoordByUV1Array=function($$,$b,$u,$Z,$E){var $r=$u.elements;$Z[$E+0]=$$[$b+0]*$r[0]+$r[2],$Z[$E+1]=1+$$[$b+1]*$r[1]+$r[3]},$p.getURLVerion=function($$){var $b=$$.indexOf("?");return 0<=$b?$$.substr($b):null},$p._quaternionCreateFromYawPitchRollArray=function($$,$b,$u,$Z){var $E=.5*$u,$r=.5*$b,$F=.5*$$,$x=Math.sin($E),$g=Math.cos($E),$H=Math.sin($r),$w=Math.cos($r),$I=Math.sin($F),$o=Math.cos($F);$Z[0]=$o*$H*$g+$I*$w*$x,$Z[1]=$I*$w*$g-$o*$H*$x,$Z[2]=$o*$w*$x-$I*$H*$g,$Z[3]=$o*$w*$g+$I*$H*$x},$p._createAffineTransformationArray=function($$,$b,$u,$Z){var $E=$b[0],$r=$b[1],$F=$b[2],$x=$b[3],$g=$E+$E,$H=$r+$r,$w=$F+$F,$I=$E*$g,$o=$E*$H,$N=$E*$w,$D=$r*$H,$e=$r*$w,$L=$F*$w,$T=$x*$g,$_=$x*$H,$y=$x*$w,$S=$u[0],$P=$u[1],$i=$u[2];$Z[0]=(1-($D+$L))*$S,$Z[1]=($o+$y)*$S,$Z[2]=($N-$_)*$S,$Z[3]=0,$Z[4]=($o-$y)*$P,$Z[5]=(1-($I+$L))*$P,$Z[6]=($e+$T)*$P,$Z[7]=0,$Z[8]=($N+$_)*$i,$Z[9]=($e-$T)*$i,$Z[10]=(1-($I+$D))*$i,$Z[11]=0,$Z[12]=$$[0],$Z[13]=$$[1],$Z[14]=$$[2],$Z[15]=1},$p._mulMatrixArray=function($$,$b,$u,$Z){var $E,$r,$F,$x,$g,$H=$b.elements,$w=$H[0],$I=$H[1],$o=$H[2],$N=$H[3],$D=$H[4],$e=$H[5],$L=$H[6],$T=$H[7],$_=$H[8],$y=$H[9],$S=$H[10],$P=$H[11],$i=$H[12],$z=$H[13],$q=$H[14],$a=$H[15],$t=$Z,$C=$Z+4,$K=$Z+8,$O=$Z+12;for($E=0;$E<4;$E++)$r=$$[$E],$F=$$[$E+4],$x=$$[$E+8],$g=$$[$E+12],$u[$t+$E]=$r*$w+$F*$I+$x*$o+$g*$N,$u[$C+$E]=$r*$D+$F*$e+$x*$L+$g*$T,$u[$K+$E]=$r*$_+$F*$y+$x*$S+$g*$P,$u[$O+$E]=$r*$i+$F*$z+$x*$q+$g*$a},$p.getYawPitchRoll=function($$,$b){$p.transformQuat($Fb.ForwardRH,$$,$ub.TEMPVector31),$p.transformQuat($Fb.Up,$$,$ub.TEMPVector32);var $u=$ub.TEMPVector32.elements;$p.angleTo($Fb.ZERO,$ub.TEMPVector31,$ub.TEMPVector33);var $Z=$ub.TEMPVector33.elements;$Z[0]==Math.PI/2?($Z[1]=$p.arcTanAngle($u[2],$u[0]),$Z[2]=0):$Z[0]==-Math.PI/2?($Z[1]=$p.arcTanAngle(-$u[2],-$u[0]),$Z[2]=0):($$b.createRotationY(-$Z[1],$ub.TEMPMatrix0),$$b.createRotationX(-$Z[0],$ub.TEMPMatrix1),$Fb.transformCoordinate($ub.TEMPVector32,$ub.TEMPMatrix0,$ub.TEMPVector32),$Fb.transformCoordinate($ub.TEMPVector32,$ub.TEMPMatrix1,$ub.TEMPVector32),$Z[2]=$p.arcTanAngle($u[1],-$u[0])),$Z[1]<=-Math.PI&&($Z[1]=Math.PI),$Z[2]<=-Math.PI&&($Z[2]=Math.PI),$Z[1]>=Math.PI&&$Z[2]>=Math.PI&&($Z[1]=0,$Z[2]=0,$Z[0]=Math.PI-$Z[0]),$b[0]=$Z[1],$b[1]=$Z[0],$b[2]=$Z[2]},$p.arcTanAngle=function($$,$b){return 0==$$?1==$b?Math.PI/2:-Math.PI/2:0<$$?Math.atan($b/$$):$$<0?0<$b?Math.atan($b/$$)+Math.PI:Math.atan($b/$$)-Math.PI:0},$p.angleTo=function($$,$b,$u){$Fb.subtract($b,$$,$ub.TEMPVector30),$Fb.normalize($ub.TEMPVector30,$ub.TEMPVector30),$u.elements[0]=Math.asin($ub.TEMPVector30.y),$u.elements[1]=$p.arcTanAngle(-$ub.TEMPVector30.z,-$ub.TEMPVector30.x)},$p.transformQuat=function($$,$b,$u){var $Z=$u.elements,$E=$$.elements,$r=$b,$F=$E[0],$x=$E[1],$g=$E[2],$H=$r[0],$w=$r[1],$I=$r[2],$o=$r[3],$N=$o*$F+$w*$g-$I*$x,$D=$o*$x+$I*$F-$H*$g,$e=$o*$g+$H*$x-$w*$F,$L=-$H*$F-$w*$x-$I*$g;$Z[0]=$N*$o+$L*-$H+$D*-$I-$e*-$w,$Z[1]=$D*$o+$L*-$w+$e*-$H-$N*-$I,$Z[2]=$e*$o+$L*-$I+$N*-$w-$D*-$H},$p.quaterionNormalize=function($$,$b){var $u=$$[0],$Z=$$[1],$E=$$[2],$r=$$[3],$F=$u*$u+$Z*$Z+$E*$E+$r*$r;0<$F&&($F=1/Math.sqrt($F),$b[0]=$u*$F,$b[1]=$Z*$F,$b[2]=$E*$F,$b[3]=$r*$F)},$p.matrix4x4MultiplyFFF=function($$,$b,$u){var $Z,$E,$r,$F,$x;if($u===$b)for($b=new Float32Array(16),$Z=0;$Z<16;++$Z)$b[$Z]=$u[$Z];for($Z=0;$Z<4;$Z++)$E=$$[$Z],$r=$$[$Z+4],$F=$$[$Z+8],$x=$$[$Z+12],$u[$Z]=$E*$b[0]+$r*$b[1]+$F*$b[2]+$x*$b[3],$u[$Z+4]=$E*$b[4]+$r*$b[5]+$F*$b[6]+$x*$b[7],$u[$Z+8]=$E*$b[8]+$r*$b[9]+$F*$b[10]+$x*$b[11],$u[$Z+12]=$E*$b[12]+$r*$b[13]+$F*$b[14]+$x*$b[15]},$p.matrix4x4MultiplyMFM=function($$,$b,$u){$p.matrix4x4MultiplyFFF($$.elements,$b,$u.elements)},$I($p,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $Fb},"_tempVector3_1",function(){return this._tempVector3_1=new $Fb},"_tempVector3_2",function(){return this._tempVector3_2=new $Fb},"_tempVector3_3",function(){return this._tempVector3_3=new $Fb},"_tempVector3_4",function(){return this._tempVector3_4=new $Fb},"_tempVector3_5",function(){return this._tempVector3_5=new $Fb},"_tempVector3_6",function(){return this._tempVector3_6=new $Fb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$p}(),$Tb=function(){function $V(){}return $N($V,"Laya3D"),$V._cancelLoadByUrl=function($$){$P.loader.cancelLoadByUrl($$),$V._innerFirstLevelLoaderManager.cancelLoadByUrl($$),$V._innerSecondLevelLoaderManager.cancelLoadByUrl($$),$V._innerThirdLevelLoaderManager.cancelLoadByUrl($$),$V._innerFourthLevelLoaderManager.cancelLoadByUrl($$)},$V._changeWebGLSize=function($$,$b){$O.onStageResize($$,$b),$j.clientWidth=$$,$j.clientHeight=$b},$V.__init__=function(){var $$=$b.createMap;$$.lh=[$kb,"SPRITE3DHIERARCHY"],$$.ls=[$Yb,"SPRITE3DHIERARCHY"],$$.lm=[$cb,"MESH"],$$.lmat=[$lb,"MATERIAL"],$$.jpg=[$fb,"nativeimage"],$$.jpeg=[$fb,"nativeimage"],$$.png=[$fb,"nativeimage"],$$.pkm=[$fb,"arraybuffer"],$$.raw=[$mb,"arraybuffer"],$$.mipmaps=[$mb,"arraybuffer"],$T.parserMap.SPRITE3DHIERARCHY=$V._loadHierarchy,$T.parserMap.MESH=$V._loadMesh,$T.parserMap.MATERIAL=$V._loadMaterial,$T.parserMap.TEXTURECUBE=$V._loadTextureCube,$T.parserMap.TERRAIN=$V._loadTerrain,$V._innerFirstLevelLoaderManager.on("error",null,$V._eventLoadManagerError),$V._innerSecondLevelLoaderManager.on("error",null,$V._eventLoadManagerError),$V._innerThirdLevelLoaderManager.on("error",null,$V._eventLoadManagerError),$V._innerFourthLevelLoaderManager.on("error",null,$V._eventLoadManagerError)},$V.READ_BLOCK=function(){return $V._readData.pos+=4,!0},$V.READ_DATA=function(){return $V._DATA.offset=$V._readData.getUint32(),$V._DATA.size=$V._readData.getUint32(),!0},$V.READ_STRINGS=function(){var $$=[],$b={offset:0,size:0};$b.offset=$V._readData.getUint16(),$b.size=$V._readData.getUint16();$V._readData.pos;$V._readData.pos=$b.offset+$V._DATA.offset;for(var $u=0;$u<$b.size;$u++){var $Z=$V._readData.readUTFString();-1===$Z.lastIndexOf(".lmat")&&-1===$Z.lastIndexOf(".lpbr")||$$.push($Z)}return $$},$V.formatRelativePath=function($$,$b){var $u;if("."===$b.charAt(0)){for(var $Z=($$+$b).split("/"),$E=0,$r=$Z.length;$E<$r;$E++)if(".."==$Z[$E]){var $F=$E-1;0<$F&&".."!==$Z[$F]&&($Z.splice($F,2),$E-=2)}$u=$Z.join("/")}else $u=$$+$b;return null!=$K.customFormat&&($u=$K.customFormat($u,null)),$u},$V._eventLoadManagerError=function($$){$P.loader.event("error",$$)},$V._addHierarchyInnerUrls=function($$,$b,$u,$Z,$E,$r){var $F=$V.formatRelativePath($Z,$E);$u&&($F+=$u),$$.push({url:$F,clas:$r}),$b[$E]=$F},$V._getSprite3DHierarchyInnerUrls=function($$,$b,$u,$Z,$E,$r,$F){var $x,$g=0,$H=0;switch($$.type){case"Scene":var $w=$$.customProps.lightmaps;for($g=0,$H=$w.length;$g<$H;$g++){var $I=$w[$g].replace(".exr",".png");$V._addHierarchyInnerUrls($Z,$E,$r,$F,$I,$fb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $o;if($$.instanceParams)($o=$$.instanceParams.loadPath)&&$V._addHierarchyInnerUrls($b,$E,$r,$F,$o,$cb);else{($o=($x=$$.customProps).meshPath)&&$V._addHierarchyInnerUrls($b,$E,$r,$F,$o,$cb);var $N=$x.materials;if($N)for($g=0,$H=$N.length;$g<$H;$g++){for(var $D=$N[$g],$e=$D.type.split("."),$L=$v.window,$T=0,$_=$e.length;$T<$_;++$T){$L=$L[this.clasPaths[$T]]}if("function"!=typeof $L)throw"_getSprite3DHierarchyInnerUrls 错误: "+$D.type+" 不是类";$V._addHierarchyInnerUrls($u,$E,$r,$F,$D.path,$L)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $y=($x=$$.customProps).meshPath;$y&&$V._addHierarchyInnerUrls($b,$E,$r,$F,$y,$cb);var $S=$x.material;if($S){$e=$S.type.split("."),$L=$v.window;for($T=0,$_=$e.length;$T<$_;++$T){$L=$L[this.clasPaths[$T]]}$V._addHierarchyInnerUrls($u,$E,$r,$F,$S.path,$L)}else{var $P=$x.materialPath;if($P)$V._addHierarchyInnerUrls($u,$E,$r,$F,$P,ShurikenParticleMaterial);else{var $i=$x.texturePath;$i&&$V._addHierarchyInnerUrls($Z,$E,$r,$F,$i,$fb)}}break;case"Terrain":$V._addHierarchyInnerUrls($Z,$E,$r,$F,$$.customProps.dataPath,TerrainRes)}var $z=$$.components;for(var $q in $z){var $a=$z[$q];switch($q){case"Animator":var $t=$a.avatarPath;if($t)$V._addHierarchyInnerUrls($Z,$E,$r,$F,$t,Avatar);else{var $C=$a.avatar;$C&&$V._addHierarchyInnerUrls($Z,$E,$r,$F,$C.path,Avatar)}var $K=$a.clipPaths;for($g=0,$H=$K.length;$g<$H;$g++)$V._addHierarchyInnerUrls($Z,$E,$r,$F,$K[$g],AnimationClip)}}var $O=$$.child;for($g=0,$H=$O.length;$g<$H;$g++)$V._getSprite3DHierarchyInnerUrls($O[$g],$b,$u,$Z,$E,$r,$F)},$V._loadHierarchy=function($$){$$.on("loaded",null,$V._onHierarchylhLoaded,[$$,$$._class._getGroup()]),$$.load($$.url,"json",!1,null,!0)},$V._onHierarchylhLoaded=function($$,$b,$u){if($$._class.destroyed)$$.endLoad();else{var $Z=$$.url,$E=$Lb.getURLVerion($Z),$r=$K.getPath($Z),$F=[],$x=[],$g=[],$H={};$V._getSprite3DHierarchyInnerUrls($u,$F,$x,$g,$H,$E,$r);var $w=$F.length+$x.length+$g.length,$I=$w+1,$o=1/$I;if($V._onProcessChange($$,0,$o,1),0<$g.length){var $N=$w/$I,$D=$C.create(null,$V._onProcessChange,[$$,$o,$N],!1);$V._innerFourthLevelLoaderManager.create($g,$C.create(null,$V._onHierarchyInnerForthLevResouLoaded,[$$,$b,$D,$u,$H,$F,$x,$o+$N*$g.length,$N]),$D,null,null,1,!0,$b)}else $V._onHierarchyInnerForthLevResouLoaded($$,$b,null,$u,$H,$F,$x,$o,$N)}},$V._onHierarchyInnerForthLevResouLoaded=function($$,$b,$u,$Z,$E,$r,$F,$x,$g){if($$._class.destroyed)$$.endLoad();else if($u&&$u.recover(),0<$F.length){var $H=$C.create(null,$V._onProcessChange,[$$,$x,$g],!1);$V._innerSecondLevelLoaderManager.create($F,$C.create(null,$V._onHierarchyInnerSecondLevResouLoaded,[$$,$b,$H,$Z,$E,$r,$x+$g*$F.length,$g]),$u,null,null,1,!0,$b)}else $V._onHierarchyInnerSecondLevResouLoaded($$,$b,null,$Z,$E,$r,$x,$g)},$V._onHierarchyInnerSecondLevResouLoaded=function($$,$b,$u,$Z,$E,$r,$F,$x){if($$._class.destroyed)$$.endLoad();else if($u&&$u.recover(),0<$r.length){var $g=$C.create(null,$V._onProcessChange,[$$,$F,$x],!1);$V._innerFirstLevelLoaderManager.create($r,$C.create(null,$V._onHierarchyInnerFirstLevResouLoaded,[$$,$g,$Z,$E]),$u,null,null,1,!0,$b)}else $V._onHierarchyInnerFirstLevResouLoaded($$,null,$Z,$E)},$V._onHierarchyInnerFirstLevResouLoaded=function($$,$b,$u,$Z){$b&&$b.recover(),$$.endLoad([$u,$Z])},$V._loadTerrain=function($$){$$.on("loaded",null,$V._onTerrainLtLoaded,[$$,$$._class._getGroup()]),$$.load($$.url,"json",!1,null,!0)},$V._onTerrainLtLoaded=function($$,$b,$u){if($$._class.destroyed)$$.endLoad();else{var $Z,$E,$r=$$.url,$F=$Lb.getURLVerion($r),$x=$K.getPath($r),$g=[],$H={},$w=0,$I=0,$o=$u.heightData;$Z=$o.url,$E=$V.formatRelativePath($x,$Z),$F&&($E+=$F),$Z=$H[$Z]=$E;var $N=$u.detailTexture;for($w=0,$I=$N.length;$w<$I;$w++)$g.push({url:$N[$w].diffuse});var $D=$u.normalMap;for($w=0,$I=$D.length;$w<$I;$w++)$g.push({url:$D[$w]});var $e=$u.alphaMap;for($w=0,$I=$e.length;$w<$I;$w++)$g.push({url:$e[$w],params:[!1,!1,6408,!0]});for($w=0,$I=$g.length;$w<$I;$w++){var $L=$g[$w].url;$E=$V.formatRelativePath($x,$L),$F&&($E+=$F),$g[$w].url=$E,$H[$L]=$E}var $T=$g.length,$_=$T+2,$y=1/$_;$V._onProcessChange($$,0,$y,1);var $S={heightMapLoaded:!1,texturesLoaded:!1},$P=$C.create(null,$V._onProcessChange,[$$,$y,$y],!1);$V._innerFourthLevelLoaderManager.create($Z,$C.create(null,$V._onTerrainHeightMapLoaded,[$$,$P,$u,$H,$S]),$P,null,[$o.numX,$o.numZ,$o.bitType,$o.value],1,!0,$b);var $i=$C.create(null,$V._onProcessChange,[$$,2*$y,$T/$_],!1);$V._innerFourthLevelLoaderManager.create($g,$C.create(null,$V._onTerrainTexturesLoaded,[$$,$i,$u,$H,$S]),$i,null,null,1,!0,$b)}},$V._onTerrainHeightMapLoaded=function($$,$b,$u,$Z,$E){$E.heightMapLoaded=!0,$E.texturesLoaded&&($$.endLoad([$u,$Z]),$b.recover())},$V._onTerrainTexturesLoaded=function($$,$b,$u,$Z,$E){$E.texturesLoaded=!0,$E.heightMapLoaded&&($$.endLoad([$u,$Z]),$b.recover())},$V._loadMesh=function($$){$$.on("loaded",null,$V._onMeshLmLoaded,[$$,$$._class._getGroup()]),$$.load($$.url,"arraybuffer",!1,null,!0)},$V._onMeshLmLoaded=function($$,$b,$u){if($$._class.destroyed)$$.endLoad();else{var $Z,$E,$r,$F=$$.url,$x=$Lb.getURLVerion($F),$g=$K.getPath($F),$H={},$w=0,$I=0;switch(($V._readData=new $i($u)).pos=0,$V._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $o=$V._readData.getUint32();$V._readData.pos=$V._readData.pos+4,$I=$V._readData.getUint16(),$V._readData.pos=$V._readData.pos+8*$I;var $N=$V._readData.getUint32();for($I=$V._readData.getUint16(),$V._readData.pos=$o+$N,$Z=[],$w=0;$w<$I;$w++){var $D=$V._readData.readUTFString();-1!==$D.lastIndexOf(".lmat")&&$Z.push($D)}break;default:for($V.READ_BLOCK(),$w=0;$w<2;$w++){var $e=$V._readData.getUint16(),$L=$V._strings[$e],$T=$V["READ_"+$L];if(null==$T)throw new Error("model file err,no this function:"+$e+" "+$L);1===$w?$Z=$T.call():$T.call()}}for($w=0,$r=$Z.length;$w<$r;$w++){var $_=$Z[$w];$E=$V.formatRelativePath($g,$_),$x&&($E+=$x),$Z[$w]=$E,$H[$_]=$E}if(0<$Z.length){$V._onProcessChange($$,0,.5,1);var $y=$C.create(null,$V._onProcessChange,[$$,.5,.5],!1);$V._innerSecondLevelLoaderManager.create($Z,$C.create(null,$V._onMeshMateialLoaded,[$$,$y,$u,$H]),$y,null,null,1,!0,$b)}else $$.endLoad([$u,$H])}},$V._onMeshMateialLoaded=function($$,$b,$u,$Z){$$.endLoad([$u,$Z]),$b.recover()},$V._getMaterialTexturePath=function($$,$b,$u){var $Z=$$.length-4;return $$.indexOf(".dds")!=$Z&&$$.indexOf(".tga")!=$Z&&$$.indexOf(".exr")!=$Z&&$$.indexOf(".DDS")!=$Z&&$$.indexOf(".TGA")!=$Z&&$$.indexOf(".EXR")!=$Z||($$=$$.substr(0,$Z)+".png"),$$=$V.formatRelativePath($u,$$),$b&&($$+=$b),$$},$V._loadMaterial=function($$){$$.on("loaded",null,$V._onMaterilLmatLoaded,[$$,$$._class._getGroup()]),$$.load($$.url,"json",!1,null,!0)},$V._onMaterilLmatLoaded=function($$,$b,$u){if($$._class.destroyed)$$.endLoad();else{var $Z,$E=$$.url,$r=$Lb.getURLVerion($E),$F=$K.getPath($E),$x=[],$g={},$H=$u.customProps,$w=$u.version;if($w)switch($w){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $I=$u.props.textures,$o=0,$N=$I.length;$o<$N;$o++){var $D=$I[$o],$e=$D.path;if($e){var $L=$e.length-4;$e.indexOf(".exr")!=$L&&$e.indexOf(".EXR")!=$L||($e=$e.substr(0,$L)+".png"),$Z=$V.formatRelativePath($F,$e),$r&&($Z+=$r),$x.push({url:$Z,params:$D.params}),$g[$e]=$Z}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $T=$H.diffuseTexture.texture2D;if($T&&($Z=$V._getMaterialTexturePath($T,$r,$F),$x.push($Z),$g[$T]=$Z),$H.normalTexture){var $_=$H.normalTexture.texture2D;$_&&($Z=$V._getMaterialTexturePath($_,$r,$F),$x.push($Z),$g[$_]=$Z)}if($H.specularTexture){var $y=$H.specularTexture.texture2D;$y&&($Z=$V._getMaterialTexturePath($y,$r,$F),$x.push($Z),$g[$y]=$Z)}if($H.emissiveTexture){var $S=$H.emissiveTexture.texture2D;$S&&($Z=$V._getMaterialTexturePath($S,$r,$F),$x.push($Z),$g[$S]=$Z)}if($H.ambientTexture){var $P=$H.ambientTexture.texture2D;$P&&($Z=$V._getMaterialTexturePath($P,$r,$F),$x.push($Z),$g[$P]=$Z)}if($H.reflectTexture){var $i=$H.reflectTexture.texture2D;$i&&($Z=$V._getMaterialTexturePath($i,$r,$F),$x.push($Z),$g[$i]=$Z)}}var $z=$x.length,$q=$z+1,$a=1/$q;if($V._onProcessChange($$,0,$a,1),0<$z){var $t=$C.create(null,$V._onProcessChange,[$$,$a,$z/$q],!1);$V._innerFourthLevelLoaderManager.create($x,$C.create(null,$V._onMateialTexturesLoaded,[$$,$t,$u,$g]),$t,$fb,null,1,!0,$b)}else $V._onMateialTexturesLoaded($$,null,$u,null)}},$V._onMateialTexturesLoaded=function($$,$b,$u,$Z){$$.endLoad([$u,$Z]),$b&&$b.recover()},$V._loadTextureCube=function($$){$$.on("loaded",null,$V._onTextureCubeLtcLoaded,[$$]),$$.load($$.url,"json",!1,null,!0)},$V._onTextureCubeLtcLoaded=function($$,$b){if($$._class.destroyed)$$.endLoad();else{var $u=$K.getPath($$.url),$Z=[$V.formatRelativePath($u,$b.px),$V.formatRelativePath($u,$b.nx),$V.formatRelativePath($u,$b.py),$V.formatRelativePath($u,$b.ny),$V.formatRelativePath($u,$b.pz),$V.formatRelativePath($u,$b.nz)];$V._onProcessChange($$,0,1/7,1);var $E=$C.create(null,$V._onProcessChange,[$$,1/7,6/7],!1);$V._innerFourthLevelLoaderManager.load($Z,$C.create(null,$V._onTextureCubeImagesLoaded,[$$,$Z,$E]),$E,"nativeimage")}},$V._onTextureCubeImagesLoaded=function($$,$b,$u){var $Z=[];$Z.length=6;for(var $E=0;$E<6;$E++){var $r=$b[$E];$Z[$E]=$T.getRes($r),$T.clearRes($r)}$$.endLoad($Z),$u.recover()},$V._onProcessChange=function($$,$b,$u,$Z){($Z=$b+$Z*$u)<1&&$$.event("progress",$Z)},$V.init=function($$,$b,$u,$Z,$E,$r){if(void 0===$u&&($u=!1),void 0===$Z&&($Z=!1),void 0===$E&&($E=!0),void 0===$r&&($r=!0),$_.update3DLoop=function(){},$_.cancelLoadByUrl=function($$){$V._cancelLoadByUrl($$)},$g.isAntialias=$u,$g.isAlpha=$Z,$g.premultipliedAlpha=$E,$g.isStencil=$r,!$O.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$_.changeWebGLSize=$V._changeWebGLSize,$e.is3DMode=!0,$P.init($$,$b),$p.__init__(),$Ib.__init__(),$Ab.__init__(),$n.__init__(),$V.__init__(),$F.maxTextureCount=2,($V.debugMode||$h.debugMode)&&($V._debugPhasorSprite=new $W)},$V.HIERARCHY="SPRITE3DHIERARCHY",$V.MESH="MESH",$V.MATERIAL="MATERIAL",$V.PBRMATERIAL="PBRMTL",$V.TEXTURECUBE="TEXTURECUBE",$V.TERRAIN="TERRAIN",$V._readData=null,$V._debugPhasorSprite=null,$V.debugMode=!1,$I($V,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $b},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $b},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $b},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $b}]),$V}(),$_b=function($$){function $E($$){$E.__super.call(this),this._owner=$$,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$N($E,"laya.d3.animation.AnimationTransform3D",$r);var $b=$E.prototype;return $b._getlocalMatrix=function(){return this._localUpdate&&($Lb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$b._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._onWorldTransform()}},$b._setWorldMatrixAndUpdate=function($$){if(this._worldMatrix=$$,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $b=this._getlocalMatrix(),$u=0;$u<16;++$u)this._worldMatrix[$u]=$b[$u];else $Lb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$b._setWorldMatrixNoUpdate=function($$){this._worldMatrix=$$},$b._setWorldMatrixIgnoreUpdate=function($$){this._worldMatrix=$$,this._worldUpdate=!1},$b.getLocalPosition=function(){return this._localPosition},$b.setLocalPosition=function($$){if(this._parent)this._localPosition=$$,this._localUpdate=!0,this._onWorldTransform();else{var $b=this._entity.owner._transform,$u=this._entity.localPosition,$Z=$u.elements;$Z[0]=$$[0],$Z[1]=$$[1],$Z[2]=$$[2],$b.localPosition=$u}},$b.getLocalRotation=function(){if(this._localQuaternionUpdate){var $$=this._localRotationEuler;$Lb._quaternionCreateFromYawPitchRollArray($$[1]/$E._angleToRandin,$$[0]/$E._angleToRandin,$$[2]/$E._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$b.setLocalRotation=function($$){if(this._parent)this._localRotation=$$,$Lb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $b=this._entity.owner._transform,$u=this._entity.localRotation,$Z=$u.elements;$Z[0]=$$[0],$Z[1]=$$[1],$Z[2]=$$[2],$Z[3]=$$[3],$b.localRotation=$u}},$b.getLocalScale=function(){return this._localScale},$b.setLocalScale=function($$){if(this._parent)this._localScale=$$,this._localUpdate=!0,this._onWorldTransform();else{var $b=this._entity.owner._transform,$u=this._entity.localScale,$Z=$u.elements;$Z[0]=$$[0],$Z[1]=$$[1],$Z[2]=$$[2],$b.localScale=$u}},$b.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$Lb.getYawPitchRoll(this._localRotation,$E._tempVector3);var $$=$E._tempVector3,$b=this._localRotationEuler;$b[0]=$$[1]*$E._angleToRandin,$b[1]=$$[0]*$E._angleToRandin,$b[2]=$$[2]*$E._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$b.setLocalRotationEuler=function($$){if(this._parent)$Lb._quaternionCreateFromYawPitchRollArray($$[1]/$E._angleToRandin,$$[0]/$E._angleToRandin,$$[2]/$E._angleToRandin,this._localRotation),this._localRotationEuler=$$,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $b=this._entity.owner._transform,$u=this._entity.localRotationEuler,$Z=$u.elements;$Z[0]=$$[0],$Z[1]=$$[1],$Z[2]=$$[2],$b.localRotationEuler=$u}},$b.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$Lb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $$=this._getlocalMatrix(),$b=0;$b<16;++$b)this._worldMatrix[$b]=$$[$b];this._worldUpdate=!1}return this._worldMatrix},$b.setParent=function($$){if(this._parent!==$$){if(this._parent){var $b=this._parent._childs,$u=$b.indexOf(this);$b.splice($u,1)}$$&&($$._childs.push(this),$$&&this._onWorldTransform()),this._parent=$$}},$I($E,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$E}(),$yb=function($$){function $b(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$b.__super.call(this),this._destroyed=!1,this._id=$b._uniqueIDCounter,$b._uniqueIDCounter++}$N($b,"laya.d3.component.Component3D",$r);var $u=$b.prototype;return $P.imps($u,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$u._initialize=function($$){this._owner=$$,this._enable=!0,this.started=!1,this._load($$)},$u._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$u._load=function($$){},$u._start=function($$){},$u._update=function($$){},$u._lateUpdate=function($$){},$u._preRenderUpdate=function($$){},$u._postRenderUpdate=function($$){},$u._unload=function($$){this.offAll()},$u._cloneTo=function($$){},$D(0,$u,"id",function(){return this._id}),$D(0,$u,"destroyed",function(){return this._destroyed}),$D(0,$u,"owner",function(){return this._owner}),$D(0,$u,"enable",function(){return this._enable},function($$){this._enable!==$$&&(this._enable=$$,this.event("enablechanged",this._enable))}),$D(0,$u,"isSingleton",function(){return $b._isSingleton}),$b._isSingleton=!0,$b._uniqueIDCounter=1,$b}(),$Sb=function($$){function $b(){this._destroyed=!1,$b.__super.call(this),this._destroyed=!1}$N($b,"laya.d3.core.GeometryFilter",$r);var $u=$b.prototype;return $P.imps($u,{"laya.resource.IDestroy":!0}),$u._destroy=function(){this.offAll(),this._destroyed=!0},$D(0,$u,"_isAsyncLoaded",function(){return!0}),$D(0,$u,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$D(0,$u,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$D(0,$u,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$D(0,$u,"destroyed",function(){return this._destroyed}),$b}(),$Pb=function($$){function $Z($$){$Z.__super.call(this),this._id=++$Z._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $h$(new $Fb,new $Fb),this._boundingBoxCenter=new $Fb,this._boundingSphere=new $U$(new $Fb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$$,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$N($Z,"laya.d3.core.render.BaseRender",$r);var $b=$Z.prototype;return $P.imps($b,{"laya.resource.IDestroy":!0}),$b._changeMaterialReference=function($$,$b){$$&&$$._removeReference(),$b._addReference()},$b._getInstanceMaterial=function($$,$b){var $u=new $$.constructor;return $$.cloneTo($u),$u.name=$u.name+"(Instance)",this._materialsInstance[$b]=!0,this._changeMaterialReference(this._materials[$b],$u),this._materials[$b]=$u},$b._setShaderValuelightMap=function($$){this._setShaderValueTexture(3,$$)},$b._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$b._renderRenderableBoundBox=function(){var $$=$Tb._debugPhasorSprite,$b=this.boundingBox,$u=$Z._tempBoundBoxCorners;$b.getCorners($u),$$.line($u[0],$Z._greenColor,$u[1],$Z._greenColor),$$.line($u[2],$Z._greenColor,$u[3],$Z._greenColor),$$.line($u[4],$Z._greenColor,$u[5],$Z._greenColor),$$.line($u[6],$Z._greenColor,$u[7],$Z._greenColor),$$.line($u[0],$Z._greenColor,$u[3],$Z._greenColor),$$.line($u[1],$Z._greenColor,$u[2],$Z._greenColor),$$.line($u[2],$Z._greenColor,$u[6],$Z._greenColor),$$.line($u[3],$Z._greenColor,$u[7],$Z._greenColor),$$.line($u[0],$Z._greenColor,$u[4],$Z._greenColor),$$.line($u[1],$Z._greenColor,$u[5],$Z._greenColor),$$.line($u[4],$Z._greenColor,$u[7],$Z._greenColor),$$.line($u[5],$Z._greenColor,$u[6],$Z._greenColor)},$b._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$b._calculateBoundingBox=function(){throw"BaseRender: must override it."},$b._setShaderValueTexture=function($$,$b){this._owner._shaderValues.setValue($$,$b)},$b._setShaderValueMatrix4x4=function($$,$b){this._owner._shaderValues.setValue($$,$b?$b.elements:null)},$b._setShaderValueColor=function($$,$b){this._owner._shaderValues.setValue($$,$b?$b.elements:null)},$b._setShaderValueBuffer=function($$,$b){this._owner._shaderValues.setValue($$,$b)},$b._setShaderValueInt=function($$,$b){this._owner._shaderValues.setValue($$,$b)},$b._setShaderValueBool=function($$,$b){this._owner._shaderValues.setValue($$,$b)},$b._setShaderValueNumber=function($$,$b){this._owner._shaderValues.setValue($$,$b)},$b._setShaderValueVector2=function($$,$b){this._owner._shaderValues.setValue($$,$b?$b.elements:null)},$b._addShaderDefine=function($$){this._owner._shaderDefineValue|=$$},$b._removeShaderDefine=function($$){this._owner._shaderDefineValue&=~$$},$b._renderUpdate=function($$){return!0},$b._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $$=this._owner.scene;if($$){var $b=$$.getlightmaps()[this._lightmapIndex];$b?(this._addShaderDefine($Wb.SAHDERDEFINE_LIGHTMAP),$b.loaded?this._setShaderValuelightMap($b):$b.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($Wb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Wb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Wb.SAHDERDEFINE_LIGHTMAP)},$b._updateOctreeNode=function(){var $$=this._treeNode;$$&&this._octreeNodeNeedChange&&($$.updateObject(this),this._octreeNodeNeedChange=!1)},$b._destroy=function(){this.offAll();var $$=0,$b=0;for($$=0,$b=this._renderElements.length;$$<$b;$$++)this._renderElements[$$]._destroy();for($$=0,$b=this._materials.length;$$<$b;$$++)this._materials[$$]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$D(0,$b,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$D(0,$b,"id",function(){return this._id}),$D(0,$b,"material",function(){var $$=this._materials[0];if($$&&!this._materialsInstance[0]){var $b=this._getInstanceMaterial($$,0);this.event("materialchanged",[this,0,$b])}return this._materials[0]},function($$){this.sharedMaterial=$$}),$D(0,$b,"sharedMaterial",function(){return this._materials[0]},function($$){var $b=this._materials[0];$b!==$$&&(this._materials[0]=$$,this._materialsInstance[0]=!1,this._changeMaterialReference($b,$$),this.event("materialchanged",[this,0,$$]))}),$D(0,$b,"lightmapIndex",function(){return this._lightmapIndex},function($$){this._lightmapIndex=$$,this._applyLightMapParams()}),$D(0,$b,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($$){this._lightmapScaleOffset=$$,this._setShaderValueColor(2,$$),this._addShaderDefine($Wb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$D(0,$b,"enable",function(){return this._enable},function($$){this._enable=$$,this.event("enablechanged",[this,$$])}),$D(0,$b,"materials",function(){for(var $$=0,$b=this._materials.length;$$<$b;$$++)if(!this._materialsInstance[$$]){var $u=this._getInstanceMaterial(this._materials[$$],$$);this.event("materialchanged",[this,$$,$u])}return this._materials.slice()},function($$){this.sharedMaterials=$$}),$D(0,$b,"sharedMaterials",function(){return this._materials.slice()},function($$){if(!$$)throw new Error("MeshRender: shadredMaterials value can't be null.");var $b=$$.length;this._materialsInstance.length=$b;for(var $u=0;$u<$b;$u++){var $Z=this._materials[$u];$Z!==$$[$u]&&(this._materialsInstance[$u]=!1,this._changeMaterialReference($Z,$$[$u]),this.event("materialchanged",[this,$u,$$[$u]]))}this._materials=$$}),$D(0,$b,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$D(0,$b,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $$=this.boundingBox;$Fb.add($$.min,$$.max,this._boundingBoxCenter),$Fb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$D(0,$b,"receiveShadow",function(){return this._receiveShadow},function($$){this._receiveShadow!==$$&&((this._receiveShadow=$$)?this._addShaderDefine($Nb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($Nb.SHADERDEFINE_RECEIVE_SHADOW))}),$D(0,$b,"destroyed",function(){return this._destroyed}),$Z._uniqueIDCounter=0,$I($Z,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb,new $Fb]},"_greenColor",function(){return this._greenColor=new $xb(0,1,0,1)}]),$Z}(),$ib=function($$){function $x($$){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$x.__super.call(this),this._localPosition=new $Fb,this._localRotation=new $ub(0,0,0,1),this._localScale=new $Fb(1,1,1),this._localRotationEuler=new $Fb,this._localMatrix=new $$b,this._position=new $Fb,this._rotation=new $ub(0,0,0,1),this._scale=new $Fb(1,1,1),this._worldMatrix=new $$b,this._forward=new $Fb,this._up=new $Fb,this._right=new $Fb,this._owner=$$,this._childs=[]}$N($x,"laya.d3.core.Transform3D",$r);var $b=$x.prototype;return $b._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$$b.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $$=$x._tempVector30;$Fb.multiply(this.pivot,this._localScale,$$);var $b=$x._tempVector31;$Fb.subtract($$,this.pivot,$b);var $u=$x._tempVector32,$Z=this.localRotation;$Fb.transformQuat($$,$Z,$u),$Fb.subtract($u,$$,$u);var $E=$x._tempVector33;$Fb.subtract(this._localPosition,$b,$E),$Fb.subtract($E,$u,$E),$$b.createAffineTransformation($E,$Z,this._localScale,this._localMatrix)}},$b._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._onWorldPositionRotationTransform()}},$b._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._onWorldPositionScaleTransform()}},$b._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._onWorldPositionTransform()}},$b._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._onWorldPositionRotationTransform()}},$b._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._onWorldPositionScaleTransform()}},$b._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._onWorldTransform()}},$b.translate=function($$,$b){void 0===$b&&($b=!0),$b?($$b.createFromQuaternion(this.localRotation,$x._tempMatrix0),$Fb.transformCoordinate($$,$x._tempMatrix0,$x._tempVector30),$Fb.add(this.localPosition,$x._tempVector30,this._localPosition),this.localPosition=this._localPosition):($Fb.add(this.position,$$,this._position),this.position=this._position)},$b.rotate=function($$,$b,$u){var $Z;void 0===$b&&($b=!0),void 0===$u&&($u=!0),$Z=$u?$$:($Fb.scale($$,Math.PI/180,$x._tempVector30),$x._tempVector30),$ub.createFromYawPitchRoll($Z.y,$Z.x,$Z.z,$x._tempQuaternion0),$b?($ub.multiply(this._localRotation,$x._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($ub.multiply($x._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$b.lookAt=function($$,$b,$u){void 0===$u&&($u=!1);var $Z,$E=$$.elements;if($u){if($Z=this._localPosition.elements,Math.abs($Z[0]-$E[0])<$B$.zeroTolerance&&Math.abs($Z[1]-$E[1])<$B$.zeroTolerance&&Math.abs($Z[2]-$E[2])<$B$.zeroTolerance)return;$ub.lookAt(this._localPosition,$$,$b,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $r=this.position;if($Z=$r.elements,Math.abs($Z[0]-$E[0])<$B$.zeroTolerance&&Math.abs($Z[1]-$E[1])<$B$.zeroTolerance&&Math.abs($Z[2]-$E[2])<$B$.zeroTolerance)return;$ub.lookAt($r,$$,$b,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$D(0,$b,"_isFrontFaceInvert",function(){var $$=this.scale,$b=$$.x<0;return $$.y<0&&($b=!$b),$$.z<0&&($b=!$b),$b}),$D(0,$b,"owner",function(){return this._owner}),$D(0,$b,"localRotation",function(){if(this._localQuaternionUpdate){var $$=this._localRotationEuler.elements;$ub.createFromYawPitchRoll($$[1]/$x._angleToRandin,$$[0]/$x._angleToRandin,$$[2]/$x._angleToRandin,this._localRotation)}return this._localRotation},function($$){this._localRotation=$$,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$D(0,$b,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$$b.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($$){null===this._parent?$$.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$$b.multiply(this._localMatrix,$$,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$$,this._worldUpdate=!1}),$D(0,$b,"worldNeedUpdate",function(){return this._worldUpdate}),$D(0,$b,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($$){this._localMatrix=$$,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$D(0,$b,"dummy",function(){return this._dummy},function($$){this._dummy!==$$&&(this._dummy&&(this._dummy._entity=null),$$&&($$._entity=this),this._dummy=$$)}),$D(0,$b,"localPosition",function(){return this._localPosition},function($$){this._localPosition=$$,this._localUpdate=!0,this._onWorldPositionTransform()}),$D(0,$b,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $$=this._parent.position;$Fb.multiply(this._localPosition,this._parent.scale,$x._tempVector30),$Fb.transformQuat($x._tempVector30,this._parent.rotation,$x._tempVector30),$Fb.add($$,$x._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($$){if(null!=this._parent){$Fb.subtract($$,this._parent.position,this._localPosition);var $b=this._parent.scale.elements,$u=$b[0],$Z=$b[1],$E=$b[2];if(1!==$u||1!==$Z||1!==$E){var $r=$x._tempVector30,$F=$r.elements;$F[0]=1/$u,$F[1]=1/$Z,$F[2]=1/$E,$Fb.multiply(this._localPosition,$r,this._localPosition)}this._parent.rotation.invert($x._tempQuaternion0),$Fb.transformQuat(this._localPosition,$x._tempQuaternion0,this._localPosition)}else $$.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$$,this._positionUpdate=!1}),$D(0,$b,"localScale",function(){return this._localScale},function($$){this._localScale=$$,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$D(0,$b,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($x._tempVector30);var $$=$x._tempVector30.elements,$b=this._localRotationEuler.elements;$b[0]=$$[1]*$x._angleToRandin,$b[1]=$$[0]*$x._angleToRandin,$b[2]=$$[2]*$x._angleToRandin}return this._localRotationEuler},function($$){this._localRotationEuler=$$,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$D(0,$b,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$ub.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($$){null!=this._parent?(this._parent.rotation.invert($x._tempQuaternion0),$ub.multiply($$,$x._tempQuaternion0,this._localRotation)):$$.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$$,this._rotationUpdate=!1}),$D(0,$b,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$Fb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($$){if(null!==this._parent){var $b=this._parent.scale.elements,$u=$x._tempVector30.elements;$u[0]=1/$b[0],$u[1]=1/$b[1],$u[2]=1/$b[2],$Fb.multiply($$,$x._tempVector30,this._localScale)}else $$.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$$,this._scaleUpdate=!1}),$D(0,$b,"rotationEuler",null,function($$){$ub.createFromYawPitchRoll($$.y,$$.x,$$.z,this._rotation),this.rotation=this._rotation}),$D(0,$b,"forward",function(){var $$=this.worldMatrix.elements;return this._forward.elements[0]=-$$[8],this._forward.elements[1]=-$$[9],this._forward.elements[2]=-$$[10],this._forward}),$D(0,$b,"up",function(){var $$=this.worldMatrix.elements;return this._up.elements[0]=$$[4],this._up.elements[1]=$$[5],this._up.elements[2]=$$[6],this._up}),$D(0,$b,"right",function(){var $$=this.worldMatrix.elements;return this._right.elements[0]=$$[0],this._right.elements[1]=$$[1],this._right.elements[2]=$$[2],this._right}),$D(0,$b,"parent",function(){return this._parent},function($$){if(this._parent!==$$){if(this._parent){var $b=this._parent._childs,$u=$b.indexOf(this);$b.splice($u,1)}$$&&($$._childs.push(this),$$&&this._onWorldTransform()),this._parent=$$}}),$I($x,["_tempVector30",function(){return this._tempVector30=new $Fb},"_tempVector31",function(){return this._tempVector31=new $Fb},"_tempVector32",function(){return this._tempVector32=new $Fb},"_tempVector33",function(){return this._tempVector33=new $Fb},"_tempQuaternion0",function(){return this._tempQuaternion0=new $ub},"_tempMatrix0",function(){return this._tempMatrix0=new $$b},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$x}(),$zb=(function($$){function $b(){this._rotation=0,this._matNeedUpdte=!1,$b.__super.call(this),this._matrix=new $$b,this._offset=new $rb,this._tiling=new $rb(1,1)}$N($b,"laya.d3.core.TransformUV",$r);var $u=$b.prototype;$P.imps($u,{"laya.d3.core.IClone":!0}),$u._updateMatrix=function(){$b._tempOffsetV3.elements[0]=this._offset.x,$b._tempOffsetV3.elements[1]=this._offset.y,$ub.createFromYawPitchRoll(0,0,this._rotation,$b._tempRotationQua),$b._tempTitlingV3.elements[0]=this._tiling.x,$b._tempTitlingV3.elements[1]=this._tiling.y,$$b.createAffineTransformation($b._tempOffsetV3,$b._tempRotationQua,$b._tempTitlingV3,this._matrix)},$u.cloneTo=function($$){$$._matrix=this._matrix.clone(),$$._offset=this._offset.clone(),$$._rotation=this._rotation,$$._tiling=this._tiling.clone()},$u.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$u,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$D(0,$u,"tiling",function(){return this._tiling},function($$){this._tiling=$$,this._matNeedUpdte=!0}),$D(0,$u,"offset",function(){return this._offset},function($$){this._offset=$$,this._matNeedUpdte=!0}),$D(0,$u,"rotation",function(){return this._rotation},function($$){this._rotation=$$,this._matNeedUpdte=!0}),$I($b,["_tempOffsetV3",function(){return this._tempOffsetV3=new $Fb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $ub},"_tempTitlingV3",function(){return this._tempTitlingV3=new $Fb(1,1,1)}])}(),function($u){function $$(){this.x=NaN,this.y=NaN,this.z=NaN,$$.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$N($$,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$u);var $b=$$.prototype;$b._getShapeBoundBox=function($$){var $b=$$.min.elements;$b[0]=.5*-this.x,$b[1]=.5*-this.y,$b[2]=.5*-this.z;var $u=$$.max.elements;$u[0]=.5*this.x,$u[1]=.5*this.y,$u[2]=.5*this.z},$b._getSpeedBoundBox=function($$){var $b=$$.min.elements;$b[0]=0,$b[1]=0,$b[2]=0;var $u=$$.max.elements;$u[0]=0,$u[1]=1,$u[2]=0},$b.generatePositionAndDirection=function($$,$b,$u,$Z){var $E=$$.elements,$r=$b.elements;$u?($u.seed=$Z[16],$f._randomPointInsideHalfUnitBox($$,$u),$Z[16]=$u.seed):$f._randomPointInsideHalfUnitBox($$),$E[0]=this.x*$E[0],$E[1]=this.y*$E[1],$E[2]=this.z*$E[2],this.randomDirection?$u?($u.seed=$Z[17],$f._randomPointUnitSphere($b,$u),$Z[17]=$u.seed):$f._randomPointUnitSphere($b):($r[0]=0,$r[1]=0,$r[2]=1)},$b.cloneTo=function($$){$u.prototype.cloneTo.call(this,$$);var $b=$$;$b.x=this.x,$b.y=this.y,$b.z=this.z,$b.randomDirection=this.randomDirection}}($s),function($u){function $F(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$F.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$N($F,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$u);var $$=$F.prototype;$$._getShapeBoundBox=function($$){var $b=$$.min.elements;$b[0]=$b[2]=-this.radius,$b[1]=0;var $u=$$.max.elements;$u[0]=$u[2]=this.radius,$u[1]=0},$$._getSpeedBoundBox=function($$){var $b=$$.min.elements;$b[0]=$b[1]=-1,$b[2]=0;var $u=$$.max.elements;$u[0]=$u[1]=1,$u[2]=0},$$.generatePositionAndDirection=function($$,$b,$u,$Z){var $E=$$.elements,$r=$F._tempPositionPoint.elements;$u?($u.seed=$Z[16],this.emitFromEdge?$f._randomPointUnitArcCircle(this.arc,$F._tempPositionPoint,$u):$f._randomPointInsideUnitArcCircle(this.arc,$F._tempPositionPoint,$u),$Z[16]=$u.seed):this.emitFromEdge?$f._randomPointUnitArcCircle(this.arc,$F._tempPositionPoint):$f._randomPointInsideUnitArcCircle(this.arc,$F._tempPositionPoint),$E[0]=-$r[0],$E[1]=$r[1],$E[2]=0,$Fb.scale($$,this.radius,$$),this.randomDirection?$u?($u.seed=$Z[17],$f._randomPointUnitSphere($b,$u),$Z[17]=$u.seed):$f._randomPointUnitSphere($b):$$.cloneTo($b)},$$.cloneTo=function($$){$u.prototype.cloneTo.call(this,$$);var $b=$$;$b.radius=this.radius,$b.arc=this.arc,$b.emitFromEdge=this.emitFromEdge,$b.randomDirection=this.randomDirection},$I($F,["_tempPositionPoint",function(){return this._tempPositionPoint=new $rb}])}($s),function($u){function $o(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$o.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$N($o,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$u);var $$=$o.prototype;$$._getShapeBoundBox=function($$){var $b=this.radius+this.length*Math.sin(this.angle),$u=this.length*Math.cos(this.angle),$Z=$$.min.elements;$Z[0]=$Z[1]=-$b,$Z[2]=0;var $E=$$.max.elements;$E[0]=$E[1]=$b,$E[2]=$u},$$._getSpeedBoundBox=function($$){var $b=Math.sin(this.angle),$u=$$.min.elements;$u[0]=$u[1]=-$b,$u[2]=0;var $Z=$$.max.elements;$Z[0]=$u[1]=$b,$Z[2]=1},$$.generatePositionAndDirection=function($$,$b,$u,$Z){var $E,$r=$$.elements,$F=$b.elements,$x=$o._tempPositionPoint.elements,$g=NaN,$H=NaN,$w=Math.cos(this.angle),$I=Math.sin(this.angle);switch(this.emitType){case 0:$u?($u.seed=$Z[16],$f._randomPointInsideUnitCircle($o._tempPositionPoint,$u),$Z[16]=$u.seed):$f._randomPointInsideUnitCircle($o._tempPositionPoint),$g=$x[0],$H=$x[1],$r[0]=$g*this.radius,$r[1]=$H*this.radius,$r[2]=0,this.randomDirection?($u?($u.seed=$Z[17],$f._randomPointInsideUnitCircle($o._tempDirectionPoint,$u),$Z[17]=$u.seed):$f._randomPointInsideUnitCircle($o._tempDirectionPoint),$E=$o._tempDirectionPoint.elements,$F[0]=$E[0]*$I,$F[1]=$E[1]*$I):($F[0]=$g*$I,$F[1]=$H*$I),$F[2]=$w;break;case 1:$u?($u.seed=$Z[16],$f._randomPointUnitCircle($o._tempPositionPoint,$u),$Z[16]=$u.seed):$f._randomPointUnitCircle($o._tempPositionPoint),$g=$x[0],$H=$x[1],$r[0]=$g*this.radius,$r[1]=$H*this.radius,$r[2]=0,this.randomDirection?($u?($u.seed=$Z[17],$f._randomPointInsideUnitCircle($o._tempDirectionPoint,$u),$Z[17]=$u.seed):$f._randomPointInsideUnitCircle($o._tempDirectionPoint),$E=$o._tempDirectionPoint.elements,$F[0]=$E[0]*$I,$F[1]=$E[1]*$I):($F[0]=$g*$I,$F[1]=$H*$I),$F[2]=$w;break;case 2:$u?($u.seed=$Z[16],$f._randomPointInsideUnitCircle($o._tempPositionPoint,$u)):$f._randomPointInsideUnitCircle($o._tempPositionPoint),$g=$x[0],$H=$x[1],$r[0]=$g*this.radius,$r[1]=$H*this.radius,$F[$r[2]=0]=$g*$I,$F[1]=$H*$I,$F[2]=$w,$Fb.normalize($b,$b),$u?($Fb.scale($b,this.length*$u.getFloat(),$b),$Z[16]=$u.seed):$Fb.scale($b,this.length*Math.random(),$b),$Fb.add($$,$b,$$),this.randomDirection&&($u?($u.seed=$Z[17],$f._randomPointUnitSphere($b,$u),$Z[17]=$u.seed):$f._randomPointUnitSphere($b));break;case 3:$u?($u.seed=$Z[16],$f._randomPointUnitCircle($o._tempPositionPoint,$u)):$f._randomPointUnitCircle($o._tempPositionPoint),$g=$x[0],$H=$x[1],$r[0]=$g*this.radius,$r[1]=$H*this.radius,$F[$r[2]=0]=$g*$I,$F[1]=$H*$I,$F[2]=$w,$Fb.normalize($b,$b),$u?($Fb.scale($b,this.length*$u.getFloat(),$b),$Z[16]=$u.seed):$Fb.scale($b,this.length*Math.random(),$b),$Fb.add($$,$b,$$),this.randomDirection&&($u?($u.seed=$Z[17],$f._randomPointUnitSphere($b,$u),$Z[17]=$u.seed):$f._randomPointUnitSphere($b));break;default:throw new Error("ConeShape:emitType is invalid.")}},$$.cloneTo=function($$){$u.prototype.cloneTo.call(this,$$);var $b=$$;$b.angle=this.angle,$b.radius=this.radius,$b.length=this.length,$b.emitType=this.emitType,$b.randomDirection=this.randomDirection},$I($o,["_tempPositionPoint",function(){return this._tempPositionPoint=new $rb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $rb}])}($s),function($u){function $$(){this.radius=NaN,this.emitFromShell=!1,$$.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$N($$,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$u);var $b=$$.prototype;$b._getShapeBoundBox=function($$){var $b=$$.min.elements;$b[0]=$b[1]=$b[2]=-this.radius;var $u=$$.max.elements;$u[0]=$u[1]=this.radius,$u[2]=0},$b._getSpeedBoundBox=function($$){var $b=$$.min.elements;$b[0]=$b[1]=-1,$b[2]=0;var $u=$$.max.elements;$u[0]=$u[1]=$u[2]=1},$b.generatePositionAndDirection=function($$,$b,$u,$Z){var $E=$$.elements;$u?($u.seed=$Z[16],this.emitFromShell?$f._randomPointUnitSphere($$,$u):$f._randomPointInsideUnitSphere($$,$u),$Z[16]=$u.seed):this.emitFromShell?$f._randomPointUnitSphere($$):$f._randomPointInsideUnitSphere($$),$Fb.scale($$,this.radius,$$);var $r=$E[2];$r<0&&($E[2]=-1*$r),this.randomDirection?$u?($u.seed=$Z[17],$f._randomPointUnitSphere($b,$u),$Z[17]=$u.seed):$f._randomPointUnitSphere($b):$$.cloneTo($b)},$b.cloneTo=function($$){$u.prototype.cloneTo.call(this,$$);var $b=$$;$b.radius=this.radius,$b.emitFromShell=this.emitFromShell,$b.randomDirection=this.randomDirection}}($s),function($u){function $$(){this.radius=NaN,this.emitFromShell=!1,$$.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$N($$,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$u);var $b=$$.prototype;$b._getShapeBoundBox=function($$){var $b=$$.min.elements;$b[0]=$b[1]=$b[2]=-this.radius;var $u=$$.max.elements;$u[0]=$u[1]=$u[2]=this.radius},$b._getSpeedBoundBox=function($$){var $b=$$.min.elements;$b[0]=$b[1]=$b[2]=-1;var $u=$$.max.elements;$u[0]=$u[1]=$u[2]=1},$b.generatePositionAndDirection=function($$,$b,$u,$Z){$u?($u.seed=$Z[16],this.emitFromShell?$f._randomPointUnitSphere($$,$u):$f._randomPointInsideUnitSphere($$,$u),$Z[16]=$u.seed):this.emitFromShell?$f._randomPointUnitSphere($$):$f._randomPointInsideUnitSphere($$),$Fb.scale($$,this.radius,$$),this.randomDirection?$u?($u.seed=$Z[17],$f._randomPointUnitSphere($b,$u),$Z[17]=$u.seed):$f._randomPointUnitSphere($b):$$.cloneTo($b)},$b.cloneTo=function($$){$u.prototype.cloneTo.call(this,$$);var $b=$$;$b.radius=this.radius,$b.emitFromShell=this.emitFromShell,$b.randomDirection=this.randomDirection}}($s),function($$){function $b(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$b.__super.call(this)}return $N($b,"laya.d3.core.render.SubMeshRenderElement",$G),$b}()),$qb=function($$){function $L($$,$b,$u,$Z,$E,$r){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$$,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$Nb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$Wb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$Wb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$Kb.SHADERDEFINE_ALPHATEST]="ALPHATEST";$L.__super.call(this,$$,$b,$u,null,{}),this._attributeMap=$Z;var $F;for($F in $E){var $x=$E[$F];switch($x[1]){case 0:this._renderElementUniformMap[$F]=$x[0];break;case 1:this._materialUniformMap[$F]=$x[0];break;case 2:this._spriteUniformMap[$F]=$x[0];break;case 3:this._cameraUniformMap[$F]=$x[0];break;case 4:this._sceneUniformMap[$F]=$x[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$N($L,"laya.d3.shader.ShaderCompile3D",$y);var $b=$L.prototype;return $b._definesToNameDic=function($$,$b){for(var $u={},$Z=1,$E=0;$E<32&&!($$<($Z=1<<$E));$E++)if($$&$Z){var $r=$b[$Z];$r&&($u[$r]="")}return $u},$b.withCompile=function($$,$b,$u,$Z){var $E,$r,$F;if($r=this.sharders[$$])if($F=$r[$b]){if($E=$F[$u])return $E}else $F=$r[$b]=[];else $F=($r=this.sharders[$$]=[])[$b]=[];var $x,$g=this._definesToNameDic($$,$L._globalInt2name),$H=this._definesToNameDic($b,this._spriteInt2name),$w=this._definesToNameDic($u,this._materialInt2name),$I={},$o="";if($g)for($x in $g)$o+="#define "+$x+"\n",$I[$x]=!0;if($H)for($x in $H)$o+="#define "+$x+"\n",$I[$x]=!0;if($w)for($x in $w)$o+="#define "+$x+"\n",$I[$x]=!0;var $N=$Mb.nameKey.getName(this._name)+" compile ("+$$+","+$b+","+$u+")",$D=this._VS.toscript($I,[]),$e=this._PS.toscript($I,[]);$v.now();if($E=$Mb.create($o+$D.join("\n"),$o+$e.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$Z,$N),$F[$u]=$E,laya.d3.shader.ShaderCompile3D.debugMode)$v.now();return $E},$b.precompileShaderWithShaderDefine=function($$,$b,$u){this.withCompile($$,$b,$u,!0)},$b.addMaterialDefines=function($$){var $b=$$.defines;for(var $u in $b){var $Z=$b[$u],$E=parseInt($u);this._materialInt2name[$E]=$Z,this._materialName2Int[$Z]=$E}},$b.addSpriteDefines=function($$){var $b=$$.defines;for(var $u in $b){var $Z=$b[$u],$E=parseInt($u);this._spriteInt2name[$E]=$Z,this._spriteName2Int[$Z]=$E}},$b.getMaterialDefineByName=function($$){return this._materialName2Int[$$]},$b.registerMaterialDefine=function($$){var $b=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$b]=$$,this._materialName2Int[$$]=$b},$b.registerSpriteDefine=function($$){var $b=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$b]=$$,this._spriteName2Int[$$]=$b},$L._globalRegDefine=function($$,$b){$L._globalInt2name[$b]=$$},$L.add=function($$,$b,$u,$Z,$E){return laya.d3.shader.ShaderCompile3D._preCompileShader[$$]=new $L($$,$b,$u,$Z,$E,$y.includes)},$L.get=function($$){return laya.d3.shader.ShaderCompile3D._preCompileShader[$Mb.nameKey.getID($$)]},$L._preCompileShader={},$L._globalInt2name=[],$L.debugMode=!1,$L.SHADERDEFINE_HIGHPRECISION=1,$L.SHADERDEFINE_FOG=4,$L.SHADERDEFINE_DIRECTIONLIGHT=8,$L.SHADERDEFINE_POINTLIGHT=16,$L.SHADERDEFINE_SPOTLIGHT=32,$L.SHADERDEFINE_UV0=64,$L.SHADERDEFINE_COLOR=128,$L.SHADERDEFINE_UV1=256,$L.SAHDERDEFINE_DEPTHFOG=131072,$L}(),$ab=function($$){function $D(){$D.__super.call(this)}$N($D,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$Z$);var $b=$D.prototype;return $b._getStaticBatch=function($$,$b,$u,$Z){var $E,$r;return $r=$$?$$.id.toString()+$u.id.toString()+$b.id.toString()+$Z.toString():$u.id.toString()+$b.id.toString()+$Z.toString(),this._staticBatches[$r]?$E=this._staticBatches[$r]:this._staticBatches[$r]=$E=new $tb($r,this,$$,$b,$u),$E},$b._initStaticBatchs=function($$){var $b,$u;this._initBatchRenderElements.sort($D._sortPrepareStaticBatch);for(var $Z,$E=!1,$r=0,$F=0,$x=this._initBatchRenderElements.length;$F<$x;$F++){var $g,$H=this._initBatchRenderElements[$F],$w=$H.renderObj._getVertexBuffer(0);$H._sprite3D;if($u===$w.vertexDeclaration&&$b===$H._material)if($E)$Z._addCombineBatchRenderObjTest($H)?($g=$H._staticBatch)!==$Z&&($g&&$g._deleteCombineBatchRenderObj($H),$Z._addCombineBatchRenderObj($H)):($E=!1,$r++);else{var $I=this._initBatchRenderElements[$F-1],$o=$I.renderObj,$N=$H.renderObj;$E=!(65535<$o._getVertexBuffer().vertexCount+$N._getVertexBuffer().vertexCount)&&($Z=this._getStaticBatch($$,$u,$b,$r),($g=$I._staticBatch)!==$Z&&($g&&$g._deleteCombineBatchRenderObj($I),$Z._addCombineBatchRenderObj($I)),($g=$H._staticBatch)!==$Z&&($g&&$g._deleteCombineBatchRenderObj($H),$Z._addCombineBatchRenderObj($H)),!0)}else $E=!1,$r=0;$b=$H._material,$u=$w.vertexDeclaration}},$D._sortPrepareStaticBatch=function($$,$b){var $u=$$._render,$Z=$b._render,$E=$u.lightmapIndex-$Z.lightmapIndex;if(0!=$E)return $E;var $r=$u.receiveShadow-$Z.receiveShadow;if(0!=$r)return $r;var $F=$$._mainSortID-$b._mainSortID;return 0==$F?$$.renderObj.triangleCount-$b.renderObj.triangleCount:$F},$D}(),$tb=function($$){function $r($$,$b,$u,$Z,$E){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$r.__super.call(this,$$,$b,$u),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$Z,this._material=$E}$N($r,"laya.d3.graphics.SubMeshStaticBatch",$E$);var $b=$r.prototype;return $b._compareBatchRenderElement=function($$,$b){return $$._batchIndexStart>$b._batchIndexStart},$b._addCombineBatchRenderObjTest=function($$){var $b=$$.renderObj._vertexCount;return!(65535<(0<$b?this._currentCombineVertexCount+$b:this._currentCombineVertexCount+$$.renderObj._getVertexBuffer().vertexCount))},$b._addCombineBatchRenderObj=function($$){var $b=$$.renderObj,$u=$b._vertexCount;this._initBatchRenderElements.push($$),$$._staticBatch=this,0<$u?(this._currentCombineIndexCount+=$b._indexCount,this._currentCombineVertexCount+=$u):(this._currentCombineIndexCount=this._currentCombineIndexCount+$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$b._deleteCombineBatchRenderObj=function($$){var $b=$$.renderObj,$u=this._initBatchRenderElements.indexOf($$);if(-1!==$u){this._initBatchRenderElements.splice($u,1),$$._staticBatch=null;var $Z=$b._vertexCount;0<$Z?(this._currentCombineIndexCount=this._currentCombineIndexCount-$b._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$Z):(this._currentCombineIndexCount=this._currentCombineIndexCount-$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$b._finishInit=function(){if(this._needFinishCombine){var $$=0,$b=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $u=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$Z=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$sb.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$Xb.create("ushort",this._currentCombineIndexCount,35044);for(var $E=0,$r=this._initBatchRenderElements.length;$E<$r;$E++){var $F=this._initBatchRenderElements[$E],$x=$F.renderObj,$g=$x._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$F._sprite3D),$H=$x.getIndices(),$w=$F._sprite3D.transform._isFrontFaceInvert,$I=$$/(this._vertexDeclaration.vertexStride/4)-$x._vertexStart,$o=$b,$N=$o+$H.length;$F._batchIndexStart=$o,$F._batchIndexEnd=$N,$Z.set($H,$b);var $D=0;if($w)for($D=$o;$D<$N;$D+=3){$Z[$D]=$I+$Z[$D];var $e=$Z[$D+1],$L=$Z[$D+2];$Z[$D+1]=$I+$L,$Z[$D+2]=$I+$e}else for($D=$o;$D<$N;$D+=3)$Z[$D]=$I+$Z[$D],$Z[$D+1]=$I+$Z[$D+1],$Z[$D+2]=$I+$Z[$D+2];$b+=$H.length,$u.set($g,$$),$$+=$g.length}this._vertexBuffer.setData($u),this._indexBuffer.setData($Z),this._needFinishCombine=!1}},$b._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $zb)},$b._getRenderElement=function($$,$b,$u){for(var $Z,$E,$r=this._batchRenderElements.length,$F=!0,$x=0;$x<$r;$x++){var $g,$H,$w=($E=this._batchRenderElements[$x])._sprite3D._render;if(0!==$x&&($F=($g=($Z=this._batchRenderElements[$x-1])._sprite3D._render).lightmapIndex!==$w.lightmapIndex||$g.receiveShadow!==$w.receiveShadow||$Z._batchIndexEnd!==$E._batchIndexStart),$F){($H=this._getCombineRenderElementFromPool()).renderObj=this,$H._material=this._material,$H._batchIndexStart=$E._batchIndexStart,$H._batchIndexEnd=$E._batchIndexEnd;var $I=$w.lightmapIndex,$o=$I+1,$N=this._batchOwnerIndices[$o];$N||($N=this._batchOwnerIndices[$o]=[]);var $D,$e=$N[$E._render.receiveShadow?1:0];void 0===$e?($N[$w.receiveShadow?1:0]=this._batchOwners.length,($D=new $Ab(null,"StaticBatchMeshSprite3D"))._scene=$b,$D._transform=this._rootOwner?this._rootOwner._transform:null,$D._render.lightmapIndex=$I,$D._render.receiveShadow=$E._render.receiveShadow,this._batchOwners.push($D)):$D=this._batchOwners[$e],$D._render._renderUpdate($u),$H._sprite3D=$D,$$.push($H)}else $H._batchIndexEnd=$E._batchIndexEnd}},$b._beforeRender=function($$){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$b._render=function($$){var $b=$$.renderElement,$u=$b._batchIndexStart,$Z=$b._batchIndexEnd-$u;$O.mainContext.drawElements(4,$Z,5123,2*$u),$q.drawCall++,$q.trianglesFaces+=$Z/3},$b.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$b._getVertexBuffer=function($$){return void 0===$$&&($$=0),this._vertexBuffer},$r}(),$Cb=function($$){function $b(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$b.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$N($b,"laya.d3.core.ComponentNode",$H);var $u=$b.prototype;return $u.addComponent=function($$){var $b,$u=this._componentsMap.indexOf($$);if(-1===$u)$b=[],this._componentsMap.push($$),this._typeComponentsIndices.push($b);else if($b=this._typeComponentsIndices[$u],this._components[$b[0]].isSingleton)throw new Error("无法单实例创建"+$$+"组件，"+$$+"组件已存在！");var $Z=$E.getInstance($$);return $b.push(this._components.length),this._components.push($Z),$Z instanceof laya.d3.component.Script&&this._scripts.push($Z),$Z._initialize(this),$Z},$u._removeComponent=function($$,$b){var $u=this._typeComponentsIndices[$$],$Z=$u[$b],$E=this._components[$Z];this._components.splice($Z,1),$E instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($E),1),$u.splice($b,1),0===$u.length&&(this._typeComponentsIndices.splice($$,1),this._componentsMap.splice($$,1));for(var $r=0,$F=this._componentsMap.length;$r<$F;$r++)for(var $x=($u=this._typeComponentsIndices[$r]).length-1;0<=$x;$x--){var $g=$u[$x];if(!($Z<$g))break;$u[$x]=--$g}$E._destroy()},$u.getComponentByType=function($$,$b){void 0===$b&&($b=0);var $u=this._componentsMap.indexOf($$);return-1===$u?null:this._components[this._typeComponentsIndices[$u][$b]]},$u.getComponentsByType=function($$,$b){var $u=this._componentsMap.indexOf($$);if(-1!==$u){var $Z=this._typeComponentsIndices[$u],$E=$Z.length;$b.length=$E;for(var $r=0;$r<$E;$r++)$b[$r]=this._components[$Z[$r]]}else $b.length=0},$u.getComponentByIndex=function($$){return this._components[$$]},$u.removeComponentByType=function($$,$b){void 0===$b&&($b=0);var $u=this._componentsMap.indexOf($$);-1!==$u&&this._removeComponent($u,$b)},$u.removeComponentsByType=function($$){var $b=this._componentsMap.indexOf($$);if(-1!==$b)for(var $u=this._typeComponentsIndices[$b],$Z=0,$E=$u.length;$Z<$E;$u.length<$E?$E--:$Z++)this._removeComponent($b,$Z)},$u.removeAllComponent=function(){for(var $$=0,$b=this._componentsMap.length;$$<$b;this._componentsMap.length<$b?$b--:$$++)this.removeComponentsByType(this._componentsMap[$$])},$u._updateComponents=function($$){for(var $b=0,$u=this._components.length;$b<$u;$b++){var $Z=this._components[$b];!$Z.started&&($Z._start($$),$Z.started=!0),$Z.enable&&$Z._update($$)}},$u._lateUpdateComponents=function($$){for(var $b=0;$b<this._components.length;$b++){var $u=this._components[$b];!$u.started&&($u._start($$),$u.started=!0),$u.enable&&$u._lateUpdate($$)}},$u._preRenderUpdateComponents=function($$){for(var $b=0;$b<this._components.length;$b++){var $u=this._components[$b];!$u.started&&($u._start($$),$u.started=!0),$u.enable&&$u._preRenderUpdate($$)}},$u._postRenderUpdateComponents=function($$){for(var $b=0;$b<this._components.length;$b++){var $u=this._components[$b];!$u.started&&($u._start($$),$u.started=!0),$u.enable&&$u._postRenderUpdate($$)}},$b}(),$Kb=function($Z){function $$(){$$.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $ob,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $xb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$N($$,"laya.d3.core.material.BaseMaterial",$Z);var $b=$$.prototype;return $P.imps($b,{"laya.d3.core.IClone":!0}),$b._addShaderDefine=function($$){this._shaderDefineValue|=$$},$b._removeShaderDefine=function($$){this._shaderDefineValue&=~$$},$b._addDisablePublicShaderDefine=function($$){this._disablePublicShaderDefine|=$$},$b._removeDisablePublicShaderDefine=function($$){this._disablePublicShaderDefine&=~$$},$b._setBuffer=function($$,$b){this._shaderValues.setValue($$,$b),this._values[$$]=$b},$b._getBuffer=function($$){return this._values[$$]},$b._setMatrix4x4=function($$,$b){this._shaderValues.setValue($$,$b?$b.elements:null),this._values[$$]=$b},$b._getMatrix4x4=function($$){return this._values[$$]},$b._setInt=function($$,$b){this._shaderValues.setValue($$,$b),this._values[$$]=$b},$b._getInt=function($$){return this._values[$$]},$b._setNumber=function($$,$b){this._shaderValues.setValue($$,$b),this._values[$$]=$b},$b._getNumber=function($$){return this._values[$$]},$b._setBool=function($$,$b){this._shaderValues.setValue($$,$b),this._values[$$]=$b},$b._getBool=function($$){return this._values[$$]},$b._setVector2=function($$,$b){this._shaderValues.setValue($$,$b?$b.elements:null),this._values[$$]=$b},$b._getVector2=function($$){return this._values[$$]},$b._setColor=function($$,$b){this._shaderValues.setValue($$,$b?$b.elements:null),this._values[$$]=$b},$b._getColor=function($$){return this._values[$$]},$b._setTexture=function($$,$b){var $u=this._values[$$];this._values[$$]=$b,this._shaderValues.setValue($$,$b),0<this.referenceCount&&($u&&$u._removeReference(),$b&&$b._addReference())},$b._getTexture=function($$){return this._values[$$]},$b._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$b._getShader=function($$,$b,$u){var $Z=($$|$b)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($Z,$u,this._shaderDefineValue),this._shader},$b._setRenderStateBlendDepth=function(){var $$=$O.mainContext;switch($V.setDepthMask($$,this.depthWrite),0===this.depthTest?$V.setDepthTest($$,!1):($V.setDepthTest($$,!0),$V.setDepthFunc($$,this.depthTest)),this.blend){case 0:$V.setBlend($$,!1);break;case 1:$V.setBlend($$,!0),$V.setBlendFunc($$,this.srcBlend,this.dstBlend);break;case 2:$V.setBlend($$,!0)}},$b._setRenderStateFrontFace=function($$,$b){var $u=$O.mainContext,$Z=0;switch(this.cull){case 0:$V.setCullFace($u,!1);break;case 1:$V.setCullFace($u,!0),$Z=$$?$b&&$b._isFrontFaceInvert?2305:2304:$b&&$b._isFrontFaceInvert?2304:2305,$V.setFrontFace($u,$Z);break;case 2:$V.setCullFace($u,!0),$Z=$$?$b&&$b._isFrontFaceInvert?2304:2305:$b&&$b._isFrontFaceInvert?2305:2304,$V.setFrontFace($u,$Z)}},$b.onAsynLoaded=function($$,$b,$u){var $Z=$b[0],$E=$b[1];switch($Z.version){case"LAYAMATERIAL:01":var $r=0,$F=0,$x=$Z.props;for(var $g in $x)switch($g){case"vectors":var $H=$x[$g];for($r=0,$F=$H.length;$r<$F;$r++){var $w=$H[$r],$I=$w.value;switch($I.length){case 2:this[$w.name]=new $rb($I[0],$I[1]);break;case 3:this[$w.name]=new $Fb($I[0],$I[1],$I[2]);break;case 4:this[$w.name]=new $xb($I[0],$I[1],$I[2],$I[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $o=$x[$g];for($r=0,$F=$o.length;$r<$F;$r++){var $N=$o[$r],$D=$N.path;$D&&(this[$N.name]=$T.getRes($E[$D]))}break;case"defines":var $e=$x[$g];for($r=0,$F=$e.length;$r<$F;$r++){var $L=this._shaderCompile.getMaterialDefineByName($e[$r]);this._addShaderDefine($L)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$g]=$x[$g];break;case"renderQueue":switch($x[$g]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$g]=$x[$g]}break;case"LAYAMATERIAL:02":for($g in $x=$Z.props)switch($g){case"vectors":for($r=0,$F=($H=$x[$g]).length;$r<$F;$r++)switch(($I=($w=$H[$r]).value).length){case 2:this[$w.name]=new $rb($I[0],$I[1]);break;case 3:this[$w.name]=new $Fb($I[0],$I[1],$I[2]);break;case 4:this[$w.name]=new $xb($I[0],$I[1],$I[2],$I[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($r=0,$F=($o=$x[$g]).length;$r<$F;$r++)($D=($N=$o[$r]).path)&&(this[$N.name]=$T.getRes($E[$D]));break;case"defines":for($r=0,$F=($e=$x[$g]).length;$r<$F;$r++)$L=this._shaderCompile.getMaterialDefineByName($e[$r]),this._addShaderDefine($L);break;default:this[$g]=$x[$g]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$b._addReference=function(){$Z.prototype._addReference.call(this);for(var $$=0,$b=this._values.length;$$<$b;$$++){var $u=this._values[$$];$u&&$u instanceof laya.d3.resource.BaseTexture&&$u._addReference()}},$b._removeReference=function(){$Z.prototype._removeReference.call(this);for(var $$=0,$b=this._values.length;$$<$b;$$++){var $u=this._values[$$];$u&&$u instanceof laya.d3.resource.BaseTexture&&$u._removeReference()}},$b.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$b.setShaderName=function($$){var $b=$Mb.nameKey.getID($$);if(-1===$b)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$qb._preCompileShader[$b]},$b.cloneTo=function($$){var $b=$$;$b.name=this.name,$b.cull=this.cull,$b.blend=this.blend,$b.srcBlend=this.srcBlend,$b.dstBlend=this.dstBlend,$b.srcBlendRGB=this.srcBlendRGB,$b.dstBlendRGB=this.dstBlendRGB,$b.srcBlendAlpha=this.srcBlendAlpha,$b.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($b.blendConstColor),$b.blendEquation=this.blendEquation,$b.blendEquationRGB=this.blendEquationRGB,$b.blendEquationAlpha=this.blendEquationAlpha,$b.depthTest=this.depthTest,$b.depthWrite=this.depthWrite,$b.renderQueue=this.renderQueue,$b._shader=this._shader,$b._disablePublicShaderDefine=this._disablePublicShaderDefine,$b._shaderDefineValue=this._shaderDefineValue;var $u,$Z=0,$E=$b._shaderValues;$b._shaderValues.data.length=this._shaderValues.data.length;var $r=this._values.length,$F=$b._values;for($Z=0,$u=$F.length=$r;$Z<$u;$Z++){var $x=this._values[$Z];if($x)if("number"==typeof $x)$F[$Z]=$x,$E.data[$Z]=$x;else if("number"==typeof $x&&Math.floor($x)==$x)$F[$Z]=$x,$E.data[$Z]=$x;else if("boolean"==typeof $x)$F[$Z]=$x,$E.data[$Z]=$x;else if($x instanceof laya.d3.math.Vector2){var $g=$F[$Z]||($F[$Z]=new $rb);$x.cloneTo($g),$E.data[$Z]=$g.elements}else if($x instanceof laya.d3.math.Vector3){var $H=$F[$Z]||($F[$Z]=new $Fb);$x.cloneTo($H),$E.data[$Z]=$H.elements}else if($x instanceof laya.d3.math.Vector4){var $w=$F[$Z]||($F[$Z]=new $xb);$x.cloneTo($w),$E.data[$Z]=$w.elements}else if($x instanceof laya.d3.math.Matrix4x4){var $I=$F[$Z]||($F[$Z]=new $$b);$x.cloneTo($I),$E.data[$Z]=$I.elements}else $x instanceof laya.d3.resource.BaseTexture&&($F[$Z]=$x,$E.data[$Z]=$x)}},$b.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$D(0,$b,"alphaTestValue",function(){return this._getNumber(0)},function($$){this._setNumber(0,$$)}),$D(0,$b,"alphaTest",function(){return this._alphaTest},function($$){(this._alphaTest=$$)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$$.__init__=function(){$$.SHADERDEFINE_ALPHATEST=$$.shaderDefines.registerDefine("ALPHATEST")},$$.RENDERQUEUE_OPAQUE=2e3,$$.RENDERQUEUE_ALPHATEST=2450,$$.RENDERQUEUE_TRANSPARENT=3e3,$$.CULL_NONE=0,$$.CULL_FRONT=1,$$.CULL_BACK=2,$$.BLEND_DISABLE=0,$$.BLEND_ENABLE_ALL=1,$$.BLEND_ENABLE_SEPERATE=2,$$.BLENDPARAM_ZERO=0,$$.BLENDPARAM_ONE=1,$$.BLENDPARAM_SRC_COLOR=768,$$.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$$.BLENDPARAM_DST_COLOR=774,$$.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$$.BLENDPARAM_SRC_ALPHA=770,$$.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$$.BLENDPARAM_DST_ALPHA=772,$$.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$$.BLENDPARAM_SRC_ALPHA_SATURATE=776,$$.BLENDEQUATION_ADD=0,$$.BLENDEQUATION_SUBTRACT=1,$$.BLENDEQUATION_REVERSE_SUBTRACT=2,$$.DEPTHTEST_OFF=0,$$.DEPTHTEST_NEVER=512,$$.DEPTHTEST_LESS=513,$$.DEPTHTEST_EQUAL=514,$$.DEPTHTEST_LEQUAL=515,$$.DEPTHTEST_GREATER=516,$$.DEPTHTEST_NOTEQUAL=517,$$.DEPTHTEST_GEQUAL=518,$$.DEPTHTEST_ALWAYS=519,$$.SHADERDEFINE_ALPHATEST=1,$$.ALPHATESTVALUE=0,$I($$,["shaderDefines",function(){return this.shaderDefines=new $wb}]),$$}($L),$Ob=function($$){function $b(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$b.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$N($b,"laya.d3.resource.BaseTexture",$L);var $u=$b.prototype;return $D(0,$u,"width",function(){return this._width}),$D(0,$u,"repeat",function(){return this._repeat},function($$){if(this._repeat!==$$&&(this._repeat=$$,this._source)){var $b=$O.mainContext;$V.bindTexture($b,this._type,this._source),$S.isPOT(this._width,this._height)&&this._repeat?($b.texParameteri(this._type,10242,10497),$b.texParameteri(this._type,10243,10497)):($b.texParameteri(this._type,10242,33071),$b.texParameteri(this._type,10243,33071))}}),$D(0,$u,"height",function(){return this._height}),$D(0,$u,"magFifter",function(){return this._magFifter},function($$){(this._magFifter=$$)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($$)}),$D(0,$u,"wrapModeV",function(){return this._wrapModeV}),$D(0,$u,"size",function(){return this._size}),$D(0,$u,"wrapModeU",function(){return this._wrapModeU}),$D(0,$u,"mipmap",function(){return this._mipmap},function($$){this._mipmap=$$,this._mipmap!=$$&&this._conchTexture&&this._conchTexture.setMipMap($$)}),$D(0,$u,"minFifter",function(){return this._minFifter},function($$){this._minFifter=$$,this._minFifter!=$$&&this._conchTexture&&this._conchTexture.setMinFifter($$)}),$D(0,$u,"format",function(){return this._format}),$D(0,$u,"source",function(){return this.activeResource(),this._source}),$D(0,$u,"defaulteTexture",function(){return $Jb.grayTexture}),$b.WARPMODE_REPEAT=0,$b.WARPMODE_CLAMP=1,$b}(),$Vb=function($$){function $b(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$b.__super.call(this),this._boundingBoxCorners=$Z(8,null)}$N($b,"laya.d3.resource.models.BaseMesh",$L);var $u=$b.prototype;return $u._getPositions=function(){throw new Error("未Override,请重载该属性！")},$u._generateBoundingObject=function(){this._boundingSphere=new $U$(new $Fb,0),$U$.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $h$(new $Fb,new $Fb),$h$.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$u.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$u.getRenderElement=function($$){throw new Error("未Override,请重载该属性！")},$D(0,$u,"subMeshCount",function(){return this._subMeshCount}),$D(0,$u,"boundingBox",function(){return this._boundingBox}),$D(0,$u,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$D(0,$u,"boundingSphere",function(){return this._boundingSphere}),$b}(),$vb=(function($$){function $b(){$b.__super.call(this)}$N($b,"laya.d3.component.Script",$yb);var $u=$b.prototype;$u.onTriggerEnter=function($$){},$u.onTriggerExit=function($$){},$u.onTriggerStay=function($$){},$D(0,$u,"isSingleton",function(){return $b._isSingleton}),$b._isSingleton=!1}(),function($$){function $b($$){this._owner=null,this._sharedMesh=null,$b.__super.call(this),this._owner=$$}$N($b,"laya.d3.core.MeshFilter",$$);var $u=$b.prototype;return $u._sharedMeshLoaded=function(){this.event("loaded")},$u._destroy=function(){$$.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$D(0,$u,"sharedMesh",function(){return this._sharedMesh},function($$){var $b=this._sharedMesh;$b&&$b._removeReference(),(this._sharedMesh=$$)._addReference(),this.event("meshchanged",[this,$b,$$]),$$.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$D(0,$u,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$D(0,$u,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$D(0,$u,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$D(0,$u,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$b}($Sb)),$pb=function($$){function $b($$){$b.__super.call(this,$$),$$.meshFilter.on("meshchanged",this,this._onMeshChanged)}$N($b,"laya.d3.core.MeshRender",$Pb);var $u=$b.prototype;return $u._onMeshChanged=function($$,$b,$u){$u.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$u.once("loaded",this,this._onMeshLoaed)},$u._onMeshLoaed=function($$,$b){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$u._calculateBoundingSphereByInitSphere=function($$){var $b=NaN,$u=this._owner.transform,$Z=$u.scale.elements,$E=Math.abs($Z[0]),$r=Math.abs($Z[1]),$F=Math.abs($Z[2]);$b=$r<=$E&&$F<=$E?$E:$F<=$r?$r:$F,$Fb.transformCoordinate($$.center,$u.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$$.radius*$b},$u._calculateBoundBoxByInitCorners=function($$){for(var $b=this._owner.transform.worldMatrix,$u=0;$u<8;$u++)$Fb.transformCoordinate($$[$u],$b,$Pb._tempBoundBoxCorners[$u]);$h$.createfromPoints($Pb._tempBoundBoxCorners,this._boundingBox)},$u._calculateBoundingSphere=function(){var $$=this._owner.meshFilter.sharedMesh;null==$$||null==$$.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($$.boundingSphere)},$u._calculateBoundingBox=function(){var $$=this._owner.meshFilter.sharedMesh;null==$$||null==$$.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($$.boundingBoxCorners)},$u._renderUpdate=function($$){var $b=this._owner.transform;if($b){this._setShaderValueMatrix4x4(0,$b.worldMatrix);var $u=this._owner.getProjectionViewWorldMatrix($$);this._setShaderValueMatrix4x4(1,$u)}else this._setShaderValueMatrix4x4(0,$$b.DEFAULT),this._setShaderValueMatrix4x4(1,$$);return $Tb.debugMode&&this._renderRenderableBoundBox(),!0},$b}(),$Yb=function($b){function $Z(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$Z.__super.call(this),this._renderState=new $j,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $ob,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $b$,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $Fb(.7,.7,.7),this.ambientColor=new $Fb(.212,.227,.259),$O.shaderHighPrecision&&this.addShaderDefine($qb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$N($Z,"laya.d3.core.scene.Scene",$b);var $$=$Z.prototype;return $P.imps($$,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$$._setUrl=function($$){this._url=$$},$$._getGroup=function(){return this._group},$$._setGroup=function($$){this._group=$$},$$._display=function(){$P.stage._scenes.push(this),$P.stage._scenes.sort($Z._sortScenes);for(var $$=0,$b=this._childs.length;$$<$b;$$++){var $u=this._childs[$$];$u.active&&$u._activeHierarchy()}},$$._unDisplay=function(){var $$=$P.stage._scenes;$$.splice($$.indexOf(this),1);for(var $b=0,$u=this._childs.length;$b<$u;$b++){var $Z=this._childs[$b];$Z.active&&$Z._inActiveHierarchy()}},$$._addChild3D=function($$){$$.transform._onWorldTransform(),$$._setBelongScene(this),this.displayedInStage&&$$.active&&$$._activeHierarchy()},$$._removeChild3D=function($$){$$.transform.parent=null,this.displayedInStage&&$$.active&&$$._inActiveHierarchy(),$$._setUnBelongScene()},$$.initOctree=function($$,$b,$u,$Z,$E){void 0===$E&&($E=6),this.treeSize=new $Fb($$,$b,$u),this.treeLevel=$E,this.treeRoot=new $h(this,0),this.treeRoot.init($Z,this.treeSize)},$$._prepareUpdateToRenderState=function($$,$b){$b.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$b.scene=this},$$._prepareSceneToRender=function($$){var $b=this._lights.length;if(0<$b)for(var $u=0,$Z=0;$Z<$b&&!(this._lights[$Z]._prepareToScene($$)&&++$u>=this._enableLightCount);$Z++);},$$._updateChilds=function($$){for(var $b=0,$u=this._childs.length;$b<$u;++$b)this._childs[$b]._update($$)},$$._preRenderScene=function($$,$b,$u){var $Z,$E=$b._viewMatrix,$r=$b._projectionMatrix,$F=$b._projectionViewMatrix,$x=0,$g=$b.camera;for($g.useOcclusionCulling?this.treeRoot?$u$.renderObjectCullingOctree($u,this,$g,$E,$r,$F):$u$.renderObjectCulling($u,this,$g,$E,$r,$F):$u$.renderObjectCullingNoBoundFrustum(this,$g,$E,$r,$F),$x=0,$Z=this._quenes.length;$x<$Z;$x++)this._quenes[$x]&&this._quenes[$x]._preRender($b)},$$._clear=function($$,$b){var $u=$b._viewport,$Z=$b.camera,$E=$u.x,$r=$Z.renderTargetSize.height-$u.y-$u.height,$F=$u.width,$x=$u.height;$$.viewport($E,$r,$F,$x);var $g=256,$H=$Z.renderTarget;switch($Z.clearFlag){case 0:var $w=$Z.clearColor;if($w){$$.enable(3089),$$.scissor($E,$r,$F,$x);var $I=$w.elements;$$.clearColor($I[0],$I[1],$I[2],$I[3]),$g|=16384}if($H)switch($w||($g=16384),$H.depthStencilFormat){case 33189:$g|=256;break;case 36168:$g|=1024;break;case 34041:$g|=256,$g|=1024}$$.clear($g),$w&&$$.disable(3089);break;case 1:case 2:if($H)switch($g=16384,$H.depthStencilFormat){case 33189:$g|=256;break;case 36168:$g|=1024;break;case 34041:$g|=256,$g|=1024}$$.clear($g);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$$._renderScene=function($$,$b){var $u,$Z,$E=$b.camera,$r=0;for($r=0;$r<2;$r++)($Z=this._quenes[$r])&&($E.renderTarget?$Z._render($b,!0):$Z._render($b,!1));if(1===$E.clearFlag){var $F=$E.sky;$F&&($V.setCullFace($$,!1),$V.setDepthFunc($$,515),$V.setDepthMask($$,!1),$F._render($b),$V.setDepthFunc($$,513),$V.setDepthMask($$,!0))}for($r=2,$u=this._quenes.length;$r<$u;$r++)($Z=this._quenes[$r])&&($Z._sortAlpha($b.camera.transform.position),$E.renderTarget?$Z._render($b,!0):$Z._render($b,!1))},$$._set3DRenderConfig=function($$){$$.disable(3042),$V._blend=!1,$$.blendFunc(770,771),$V._sFactor=770,$V._dFactor=771,$$.disable(2929),$V._depthTest=!1,$$.enable(2884),$V._cullFace=!0,$$.depthMask(1),$V._depthMask=!0,$$.frontFace(2304),$V._frontFace=2304},$$._set2DRenderConfig=function($$){$V.setBlend($$,!0),$V.setBlendFunc($$,1,771),$V.setDepthTest($$,!1),$V.setCullFace($$,!1),$V.setDepthMask($$,!0),$V.setFrontFace($$,2305),$$.viewport(0,0,$w.width,$w.height)},$$._parseCustomProps=function($$,$b,$u,$Z){var $E=$Z.customProps.lightmaps,$r=$E.length,$F=this._lightmaps;$F.length=$r;for(var $x=0;$x<$r;$x++)$F[$x]=$T.getRes($b[$E[$x].replace(".exr",".png")]);this.setlightmaps($F);var $g=$Z.customProps.ambientColor;$g&&(this.ambientColor=new $Fb($g[0],$g[1],$g[2]));var $H=$Z.customProps.fogColor;$H&&(this.fogColor=new $Fb($H[0],$H[1],$H[2]))},$$._addLight=function($$){this._lights.indexOf($$)<0&&this._lights.push($$)},$$._removeLight=function($$){var $b=this._lights.indexOf($$);0<=$b&&this._lights.splice($b,1)},$$._updateScene=function(){var $$=this._renderState;this._prepareUpdateToRenderState($O.mainContext,$$),this._updateComponents($$),this._updateChilds($$),this._lateUpdateComponents($$),this._time+=$$.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$$._updateSceneConch=function(){var $$=this._renderState;this._prepareUpdateToRenderState($O.mainContext,$$),this._updateComponents($$),this._lateUpdateComponents($$),this._prepareSceneToRender($$);for(var $b=0,$u=this._cameraPool.length;$b<$u;$b++){var $Z=this._cameraPool[$b];($$.camera=$Z)._prepareCameraToRender()}},$$._preRenderShadow=function($$,$b,$u,$Z,$E){this.treeRoot?$u$.renderShadowObjectCullingOctree(this,$b,$u,$Z,$E):$u$.renderShadowObjectCulling(this,$b,$u,$Z,$E);for(var $r=0,$F=$u.length;$r<$F;$r++)$u[$r]&&$u[$r]._preRender($$)},$$._renderShadowMap=function($$,$b,$u){var $Z=this.parallelSplitShadowMaps[0];$Z._calcAllLightCameraInfo($u);var $E,$r,$F,$x=$Z.PSSMNum;if(this._preRenderShadow($b,$Z._lightCulling,$Z._shadowQuenes,$Z._lightVPMatrix[0],$x),this.addShaderDefine($Nb.SHADERDEFINE_CAST_SHADOW),1<$x)for(var $g=0;$g<$x;$g++)$E=$Z.getRenderTarget($g+1),$Z.beginRenderTarget($g+1),$$.clearColor(1,1,1,1),$$.clear(16640),$$.viewport(0,0,$E.width,$E.height),$b.camera=$F=$Z.getLightCamera($g),$F._prepareCameraToRender(),$F._prepareCameraViewProject($F.viewMatrix,$F.projectionMatrix),$b._projectionViewMatrix=$Z._lightVPMatrix[$g+1],($r=$Z._shadowQuenes[$g])._preRender($b),$r._renderShadow($b,!1),$Z.endRenderTarget($g+1);else $E=$Z.getRenderTarget(1),$Z.beginRenderTarget(1),$$.clearColor(1,1,1,1),$$.clear(16640),$$.viewport(0,0,$E.width,$E.height),$b.camera=$F=$Z.getLightCamera(0),$F._prepareCameraToRender(),$F._prepareCameraViewProject($F.viewMatrix,$F.projectionMatrix),$b._projectionViewMatrix=$Z._lightVPMatrix[0],($r=$Z._shadowQuenes[0])._preRender($b),$r._renderShadow($b,!0),$Z.endRenderTarget(1);this.removeShaderDefine($Nb.SHADERDEFINE_CAST_SHADOW)},$$.addTreeNode=function($$){this.treeRoot.addTreeNode($$)},$$.removeTreeNode=function($$){this.treeSize&&$$._treeNode&&$$._treeNode.removeObject($$)},$$.setlightmaps=function($$){this._lightmaps=$$;for(var $b=0,$u=this._renderableSprite3Ds.length;$b<$u;$b++)this._renderableSprite3Ds[$b]._render._applyLightMapParams()},$$.getlightmaps=function(){return this._lightmaps},$$.addChildAt=function($$,$b){if(!($$ instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($$&&$$.__className));if(!$$||this.destroyed||$$===this)return $$;if($$.zOrder&&this._set$P("hasZorder",!0),0<=$b&&$b<=this._childs.length){if($$._parent===this){var $u=this.getChildIndex($$);this._childs.splice($u,1),this._childs.splice($b,0,$$),this.conchModel&&(this.conchModel.removeChild($$.conchModel),this.conchModel.addChildAt($$.conchModel,$b)),this._childChanged()}else $$.parent&&$$.parent.removeChild($$),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($b,0,$$),this.conchModel&&this.conchModel.addChildAt($$.conchModel,$b),($$.parent=this)._addChild3D($$);return $$}throw new Error("appendChildAt:The index is out of bounds")},$$.addChild=function($$){if(!($$ instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$$||this.destroyed||$$===this)return $$;if($$.zOrder&&this._set$P("hasZorder",!0),$$._parent===this){var $b=this.getChildIndex($$);$b!==this._childs.length-1&&(this._childs.splice($b,1),this._childs.push($$),this.conchModel&&(this.conchModel.removeChild($$.conchModel),this.conchModel.addChildAt($$.conchModel,this._childs.length-1)),this._childChanged())}else $$.parent&&$$.parent.removeChild($$),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($$),this.conchModel&&this.conchModel.addChildAt($$.conchModel,this._childs.length-1),($$.parent=this)._childChanged(),this._addChild3D($$);return $$},$$.removeChildAt=function($$){var $b=this.getChildAt($$);return $b&&(this._removeChild3D($b),this._childs.splice($$,1),this.conchModel&&this.conchModel.removeChild($b.conchModel),$b.parent=null),$b},$$.removeChildren=function($$,$b){if(void 0===$$&&($$=0),void 0===$b&&($b=2147483647),this._childs&&0<this._childs.length){var $u=this._childs;if(0===$$&&$r<=$b){var $Z=$u;this._childs=$H.ARRAY_EMPTY}else $Z=$u.splice($$,$b-$$);for(var $E=0,$r=$Z.length;$E<$r;$E++)this._removeChild3D($Z[$E]),$Z[$E].parent=null,this.conchModel&&this.conchModel.removeChild($Z[$E].conchModel)}return this},$$.addFrustumCullingObject=function($$){this.treeRoot?this.addTreeNode($$):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($$):this._cullingRenders[this._cullingRendersLength]=$$,$$._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$$.removeFrustumCullingObject=function($$){if(this.treeRoot)this.removeTreeNode($$);else{this._cullingRendersLength--;var $b=$$._indexInSceneFrustumCullingObjects;if($b!==this._cullingRendersLength){var $u=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$b]=$u)._indexInSceneFrustumCullingObjects=$b,$$._indexInSceneFrustumCullingObjects=-1}}},$$.getRenderQueue=function($$){return $$<3e3?this._quenes[1]||(this._quenes[1]=new $A(this)):this._quenes[2]||(this._quenes[2]=new $A(this))},$$.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $A(this)},$$.addShaderDefine=function($$){this._shaderDefineValue|=$$},$$.removeShaderDefine=function($$){this._shaderDefineValue&=~$$},$$.addScript=function($$){return this._addComponent($$)},$$.getScriptByType=function($$,$b){return void 0===$b&&($b=0),this._getComponentByType($$,$b)},$$.getScriptsByType=function($$,$b){this._getComponentsByType($$,$b)},$$.getScriptByIndex=function($$){return this._getComponentByIndex($$)},$$.removeScriptByType=function($$,$b){void 0===$b&&($b=0),this._removeComponentByType($$,$b)},$$.removeScriptsByType=function($$){this._removeComponentByType($$)},$$.removeAllScript=function(){this._removeAllComponent()},$$.render=function($$,$b,$u){($e._context.ctx._renderKey=0)<this._childs.length&&$$.addRenderObject(this)},$$.renderSubmit=function(){var $$=$O.mainContext,$b=this._renderState;this._set3DRenderConfig($$),this._prepareSceneToRender(this._renderState);var $u,$Z=0,$E=0;if($Tb.debugMode||$h.debugMode)for($Z=0,$E=this._cameraPool.length;$Z<$E;$Z++)$u=this._cameraPool[$Z],$Tb._debugPhasorSprite.begin(1,$u),$u.activeInHierarchy&&$u._renderCamera($$,$b,this),$Tb._debugPhasorSprite.end();else for($Z=0,$E=this._cameraPool.length;$Z<$E;$Z++)($u=this._cameraPool[$Z]).activeInHierarchy&&$u._renderCamera($$,$b,this);return this._set2DRenderConfig($$),1},$$.onAsynLoaded=function($$,$b,$u){var $Z=$b[0];if("Scene"!==$Z.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $E=$b[1];$Lb._createNodeByJson(this,$Z,this,$E),this.event("hierarchyloaded",[this]),this.__loaded=!0},$$.destroy=function($$){void 0===$$&&($$=!0),this.destroyed||($b.prototype.destroy.call(this,$$),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$T.clearRes(this.url),this.loaded||$Tb._cancelLoadByUrl(this.url))},$$.getRenderType=function(){return 0},$$.releaseRender=function(){},$$._addComponent=function($$){var $b,$u=this._componentsMap.indexOf($$);if(-1===$u)$b=[],this._componentsMap.push($$),this._typeComponentsIndices.push($b);else if($b=this._typeComponentsIndices[$u],this._components[$b[0]].isSingleton)throw new Error("无法单实例创建"+$$+"组件，"+$$+"组件已存在！");var $Z=$E.getInstance($$);$b.push(this._components.length),this._components.push($Z);return $Z._initialize(this),$Z},$$._removeComponent=function($$,$b){var $u=this._typeComponentsIndices[$$],$Z=$u[$b],$E=this._components[$Z];this._components.splice($Z,1),$u.splice($b,1),0===$u.length&&(this._typeComponentsIndices.splice($$,1),this._componentsMap.splice($$,1));for(var $r=0,$F=this._componentsMap.length;$r<$F;$r++)for(var $x=($u=this._typeComponentsIndices[$r]).length-1;0<=$x;$x--){var $g=$u[$x];if(!($Z<$g))break;$u[$x]=--$g}$E._destroy()},$$._getComponentByType=function($$,$b){void 0===$b&&($b=0);var $u=this._componentsMap.indexOf($$);return-1===$u?null:this._components[this._typeComponentsIndices[$u][$b]]},$$._getComponentsByType=function($$,$b){var $u=this._componentsMap.indexOf($$);if(-1!==$u){var $Z=this._typeComponentsIndices[$u],$E=$Z.length;$b.length=$E;for(var $r=0;$r<$E;$r++)$b[$r]=this._components[$Z[$r]]}else $b.length=0},$$._getComponentByIndex=function($$){return this._components[$$]},$$._removeComponentByType=function($$,$b){void 0===$b&&($b=0);var $u=this._componentsMap.indexOf($$);-1!==$u&&this._removeComponent($u,$b)},$$._removeComponentsByType=function($$){var $b=this._componentsMap.indexOf($$);if(-1!==$b)for(var $u=this._typeComponentsIndices[$b],$Z=0,$E=$u.length;$Z<$E;$u.length<$E?$E--:$Z++)this._removeComponent($b,$Z)},$$._removeAllComponent=function(){for(var $$=0,$b=this._componentsMap.length;$$<$b;this._componentsMap.length<$b?$b--:$$++)this._removeComponentsByType(this._componentsMap[$$])},$$._updateComponents=function($$){for(var $b=0,$u=this._components.length;$b<$u;$b++){var $Z=this._components[$b];!$Z.started&&($Z._start($$),$Z.started=!0),$Z.enable&&$Z._update($$)}},$$._lateUpdateComponents=function($$){for(var $b=0;$b<this._components.length;$b++){var $u=this._components[$b];!$u.started&&($u._start($$),$u.started=!0),$u.enable&&$u._lateUpdate($$)}},$$._preRenderUpdateComponents=function($$){for(var $b=0;$b<this._components.length;$b++){var $u=this._components[$b];!$u.started&&($u._start($$),$u.started=!0),$u.enable&&$u._preRenderUpdate($$)}},$$._postRenderUpdateComponents=function($$){for(var $b=0;$b<this._components.length;$b++){var $u=this._components[$b];!$u.started&&($u._start($$),$u.started=!0),$u.enable&&$u._postRenderUpdate($$)}},$D(0,$$,"_loaded",null,function($$){this.__loaded=$$}),$D(0,$$,"fogColor",function(){return this._fogColor},function($$){this._fogColor=$$,this._shaderValues.setValue(0,$$.elements)}),$D(0,$$,"enableFog",function(){return this._enableFog},function($$){this._enableFog!==$$&&((this._enableFog=$$)?(this.addShaderDefine($qb.SHADERDEFINE_FOG),this.removeShaderDefine($qb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($qb.SHADERDEFINE_FOG))}),$D(0,$$,"url",function(){return this._url}),$D(0,$$,"loaded",function(){return this.__loaded}),$D(0,$$,"enableDepthFog",function(){return this._enableDepthFog},function($$){this._enableDepthFog!=$$&&((this._enableDepthFog=$$)?(this.addShaderDefine($qb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($qb.SHADERDEFINE_FOG)):this.removeShaderDefine($qb.SAHDERDEFINE_DEPTHFOG))}),$D(0,$$,"fogStart",function(){return this._fogStart},function($$){this._fogStart=$$,this._shaderValues.setValue(1,$$)}),$D(0,$$,"fogRange",function(){return this._fogRange},function($$){this._fogRange=$$,this._shaderValues.setValue(2,$$)}),$D(0,$$,"ambientColor",function(){return this._ambientColor},function($$){this._ambientColor=$$,this._shaderValues.setValue(21,$$.elements)}),$D(0,$$,"scene",function(){return this}),$D(0,$$,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$Z._sortScenes=function($$,$b){if($$.parent!==$P.stage||$b.parent!==$P.stage)return $$.parent!==$P.stage&&$b.parent!==$P.stage?$Z._sortScenes($$.parent,$b.parent):$$.parent===$P.stage?-1:1;var $u=$P.stage._childs;return $u.indexOf($$)-$u.indexOf($b)},$Z.load=function($$){return $P.loader.create($$,null,null,$Z)},$Z.FOGCOLOR=0,$Z.FOGSTART=1,$Z.FOGRANGE=2,$Z.LIGHTDIRECTION=3,$Z.LIGHTDIRCOLOR=4,$Z.POINTLIGHTPOS=5,$Z.POINTLIGHTRANGE=6,$Z.POINTLIGHTATTENUATION=7,$Z.POINTLIGHTCOLOR=8,$Z.SPOTLIGHTPOS=9,$Z.SPOTLIGHTDIRECTION=10,$Z.SPOTLIGHTSPOT=11,$Z.SPOTLIGHTRANGE=12,$Z.SPOTLIGHTATTENUATION=13,$Z.SPOTLIGHTCOLOR=14,$Z.SHADOWDISTANCE=15,$Z.SHADOWLIGHTVIEWPROJECT=16,$Z.SHADOWMAPPCFOFFSET=17,$Z.SHADOWMAPTEXTURE1=18,$Z.SHADOWMAPTEXTURE2=19,$Z.SHADOWMAPTEXTURE3=20,$Z.AMBIENTCOLOR=21,$Z.TIME=22,$Z}($z),$kb=function($$){function $b($$){$b.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $$b,this._shaderValues=new $ob,this._colliders=[],this._id=++$b._uniqueIDCounter,this._transform=new $ib(this),this.name=$$||"Sprite3D-"+$b._nameNumberCounter++,this.layer=$p.currentCreationLayer,this.active=!0}$N($b,"laya.d3.core.Sprite3D",$Cb);var $u=$b.prototype;return $P.imps($u,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$u._setUrl=function($$){this._url=$$},$u._getGroup=function(){return this._group},$u._setGroup=function($$){this._group=$$},$u._addChild3D=function($$){$$.transform.parent=this.transform,this._hierarchyAnimator&&(!$$._hierarchyAnimator&&$$._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($$,!0,[$$.name])),this._scene&&($$._setBelongScene(this._scene),this._activeInHierarchy&&$$._active&&$$._activeHierarchy())},$u._removeChild3D=function($$){$$.transform.parent=null,this._scene&&(this._activeInHierarchy&&$$._active&&$$._inActiveHierarchy(),$$._setUnBelongScene()),this._hierarchyAnimator&&($$._hierarchyAnimator==this._hierarchyAnimator&&$$._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($$,!1,[$$.name]))},$u._parseBaseCustomProps=function($$){var $b=this.transform.localPosition;$$.translate?($b.fromArray($$.translate),$b.x*=100,$b.y*=100,$b.z*=100):$b.elements.fill(0),this.transform.localPosition=$b;var $u=this.transform.localRotation;$$.rotation?$u.fromArray($$.rotation):$u.fromArray([0,0,0,-1]),this.transform.localRotation=$u;var $Z=this.transform.localScale;$$.scale?$Z.fromArray($$.scale):$Z.elements.fill(1),this.transform.localScale=$Z;var $E=$$.layer;null!=$E&&(this.layer=$p.getLayerByNumber($E))},$u._parseCustomComponent=function($$,$b,$u){for(var $Z in $u){var $E=$u[$Z];switch($Z){case"Animator":var $r=this.addComponent(Animator);if($E.avatarPath)$r.avatar=$T.getRes($b[$E.avatarPath]);else{var $F=$E.avatar;if($F){$r.avatar=$T.getRes($b[$F.path]);var $x=$F.linkSprites;$x&&$$.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$r,$x])}}for(var $g=$E.clipPaths,$H=$g.length,$w=0;$w<$H;$w++)$r.addClip($T.getRes($b[$g[$w]]));$r.clip=$T.getRes($b[$g[0]]);var $I=$E.playOnWake;void 0!==$I&&($r.playOnWake=$I);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $o=this.addComponent(SphereCollider);$o.isTrigger=$E.isTrigger;var $N=$o.center;$N.fromArray($E.center),$o.center=$N,$o.radius=$E.radius;break;case"BoxCollider":var $D=this.addComponent(BoxCollider);$D.isTrigger=$E.isTrigger,$D.center.fromArray($E.center);var $e=$D.size;$e.fromArray($E.size),$D.size=$e;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$u._onRootNodeHierarchyLoaded=function($$,$b){for(var $u in $b){for(var $Z=this,$E=$b[$u],$r=0,$F=$E.length;$r<$F;$r++){var $x=$E[$r];if(""===$x)break;if(!($Z=$Z.getChildByName($x)))break}$Z&&$$.linkSprite3DToAvatarNode($u,$Z)}},$u._setHierarchyAnimator=function($$,$b){this._changeHierarchyAnimator($$);for(var $u=0,$Z=this._childs.length;$u<$Z;$u++){var $E=this._childs[$u];$E._hierarchyAnimator==$b&&$E._setHierarchyAnimator($$,$b)}},$u._clearHierarchyAnimator=function($$,$b){this._changeHierarchyAnimator($b);for(var $u=0,$Z=this._childs.length;$u<$Z;$u++){var $E=this._childs[$u];$E._hierarchyAnimator==$$&&$E._clearHierarchyAnimator($$,$b)}},$u._getAnimatorToLinkSprite3D=function($$,$b,$u){var $Z=this.getComponentByType(Animator);if($Z&&($Z.avatar?$Z.avatar._version||$$._setAnimatorToLinkAvatar($Z,$b):$$._setAnimatorToLinkSprite3DNoAvatar($Z,$b,$u)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$u.unshift(this._parent.name);var $E=this._parent;$E._hierarchyAnimator&&$E._getAnimatorToLinkSprite3D($$,$b,$u)}},$u._setAnimatorToLinkSprite3DNoAvatar=function($$,$b,$u){var $Z=0,$E=0;for($Z=0,$E=$$.getClipCount();$Z<$E;$Z++)$$._handleSpriteOwnersBySprite($Z,$b,$u,this);for($Z=0,$E=this._childs.length;$Z<$E;$Z++){var $r=this._childs[$Z],$F=$u.length;$u.push($r.name),$r._setAnimatorToLinkSprite3DNoAvatar($$,$b,$u),$u.splice($F,1)}},$u._changeHierarchyAnimator=function($$){this._hierarchyAnimator=$$},$u._isLinkSpriteToAnimationNode=function($$,$b,$u){var $Z=$$._avatarNodes.indexOf($b),$E=$$._cacheSpriteToNodesMap;if($u)this._transform.dummy=$b.transform,$$._cacheNodesToSpriteMap[$Z]=$E.length,$E.push($Z);else{this._transform.dummy=null;var $r=$$._cacheNodesToSpriteMap[$Z];$$._cacheNodesToSpriteMap[$Z]=null,$E.splice($r,1)}},$u._setBelongScene=function($$){this._scene=$$;for(var $b=0,$u=this._childs.length;$b<$u;$b++)this._childs[$b]._setBelongScene($$)},$u._setUnBelongScene=function(){this._scene=null;for(var $$=0,$b=this._childs.length;$$<$b;$$++)this._childs[$$]._setUnBelongScene()},$u._activeHierarchy=function(){var $$=0,$b=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$$=0,$b=this._colliders.length;$$<$b;$$++)this._layer._addCollider(this._colliders[$$]);for(this.event("activeinhierarchychanged",!0),$$=0,$b=this._childs.length;$$<$b;$$++){var $u=this._childs[$$];$u._active&&$u._activeHierarchy()}},$u._inActiveHierarchy=function(){var $$=0,$b=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$$=0,$b=this._colliders.length;$$<$b;$$++){var $u=this._colliders[$$];$u._clearCollsionMap(),this._layer._removeCollider($u)}for(this.event("activeinhierarchychanged",!1),$$=0,$b=this._childs.length;$$<$b;$$++){var $Z=this._childs[$$];$Z._active&&$Z._inActiveHierarchy()}},$u.addComponent=function($$){var $b,$u=this._componentsMap.indexOf($$);if(-1===$u)$b=[],this._componentsMap.push($$),this._typeComponentsIndices.push($b);else if($b=this._typeComponentsIndices[$u],this._components[$b[0]].isSingleton)throw new Error("无法单实例创建"+$$+"组件，"+$$+"组件已存在！");var $Z=$E.getInstance($$);return $b.push(this._components.length),this._components.push($Z),$Z instanceof laya.d3.component.Script&&this._scripts.push($Z),$Z._initialize(this),$Z},$u._removeComponent=function($$,$b){var $u,$Z=0,$E=this._typeComponentsIndices[$$],$r=$E[$b],$F=this._components[$r];for($F instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($F),1),$E.splice($b,1),0===$E.length&&(this._typeComponentsIndices.splice($$,1),this._componentsMap.splice($$,1)),$Z=0,$u=this._componentsMap.length;$Z<$u;$Z++)for(var $x=($E=this._typeComponentsIndices[$Z]).length-1;0<=$x;$x--){var $g=$E[$x];if(!($r<$g))break;$E[$x]=--$g}$F._destroy()},$u._clearSelfRenderObjects=function(){},$u._addSelfRenderObjects=function(){},$u._parseCustomProps=function($$,$b,$u,$Z){},$u._updateChilds=function($$){var $b=this._childs.length;if(0!==$b)for(var $u=0;$u<$b;++$u)this._childs[$u]._update($$)},$u._getSortID=function($$,$b){return 1e3*$b.id+$$._getVertexBuffer().vertexDeclaration.id},$u._update=function($$){($$.owner=this)._activeInHierarchy&&(this._updateComponents($$),this._lateUpdateComponents($$),$q.spriteCount++,this._childs.length&&this._updateChilds($$))},$u.getProjectionViewWorldMatrix=function($$){return $$b.multiply($$,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$u.loadHierarchy=function($$){this.addChild(laya.d3.core.Sprite3D.load($$))},$u.addChildAt=function($$,$b){if(!($$ instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$$||this.destroyed||$$===this)return $$;if($$.zOrder&&this._set$P("hasZorder",!0),0<=$b&&$b<=this._childs.length){if($$._parent===this){var $u=this.getChildIndex($$);this._childs.splice($u,1),this._childs.splice($b,0,$$),this.conchModel&&(this.conchModel.removeChild($$.conchModel),this.conchModel.addChildAt($$.conchModel,$b)),this._childChanged()}else $$.parent&&$$.parent.removeChild($$),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($b,0,$$),this.conchModel&&this.conchModel.addChildAt($$.conchModel,$b),($$.parent=this)._addChild3D($$);return $$}throw new Error("appendChildAt:The index is out of bounds")},$u.addChild=function($$){if(!($$ instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$$||this.destroyed||$$===this)return $$;if($$.zOrder&&this._set$P("hasZorder",!0),$$._parent===this){var $b=this.getChildIndex($$);$b!==this._childs.length-1&&(this._childs.splice($b,1),this._childs.push($$),this.conchModel&&(this.conchModel.removeChild($$.conchModel),this.conchModel.addChildAt($$.conchModel,this._childs.length-1)),this._childChanged())}else $$.parent&&$$.parent.removeChild($$),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($$),this.conchModel&&this.conchModel.addChildAt($$.conchModel,this._childs.length-1),($$.parent=this)._childChanged(),this._addChild3D($$);return $$},$u.removeChildAt=function($$){var $b=this.getChildAt($$);return $b&&(this._removeChild3D($b),this._childs.splice($$,1),this.conchModel&&this.conchModel.removeChild($b.conchModel),$b.parent=null),$b},$u.removeChildren=function($$,$b){if(void 0===$$&&($$=0),void 0===$b&&($b=2147483647),this._childs&&0<this._childs.length){var $u=this._childs;if(0===$$&&$r<=$b){var $Z=$u;this._childs=$H.ARRAY_EMPTY}else $Z=$u.splice($$,$b-$$);for(var $E=0,$r=$Z.length;$E<$r;$E++)this._removeChild3D($Z[$E]),$Z[$E].parent=null,this.conchModel&&this.conchModel.removeChild($Z[$E].conchModel)}return this},$u.onAsynLoaded=function($$,$b,$u){var $Z=$b[0];if("Sprite3D"!==$Z.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $E=$b[1];$Lb._createNodeByJson(this,$Z,this,$E),this.event("hierarchyloaded",[this]),this.__loaded=!0},$u.cloneTo=function($$){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $b=$$;$b.name=this.name,$b._destroyed=this._destroyed,$b.timer=this.timer,$b._$P=this._$P,$b.active=this._active;var $u=$b.transform.localPosition;this.transform.localPosition.cloneTo($u),$b.transform.localPosition=$u;var $Z=$b.transform.localRotation;this.transform.localRotation.cloneTo($Z),$b.transform.localRotation=$Z;var $E=$b.transform.localScale;this.transform.localScale.cloneTo($E),$b.transform.localScale=$E,$b.isStatic=this.isStatic;var $r=0,$F=0;for($r=0,$F=this._componentsMap.length;$r<$F;$r++){var $x=$b.addComponent(this._componentsMap[$r]);this._components[$r]._cloneTo($x)}for($r=0,$F=this._childs.length;$r<$F;$r++)$b.addChild(this._childs[$r].clone());var $g=$b.getComponentByType(Animator);if($g){var $H=$g._linkSpritesData;if($H)for(var $w in $H){for(var $I=$H[$w],$o=$b,$N=0,$D=$I.length;$N<$D&&($o=$o.getChildByName($I[$N]));$N++);if($o){var $e=$g._avatarNodeMap[$w];$o._isLinkSpriteToAnimationNode($g,$e,!0)}}}},$u.clone=function(){var $$=new this.constructor;return this.cloneTo($$),$$},$u.destroy=function($$){if(void 0===$$&&($$=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$$);var $b,$u=0;for($u=0,$b=this._components.length;$u<$b;$u++)this._components[$u]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$T.clearRes(this.url),this.loaded||$Tb._cancelLoadByUrl(this.url)}},$u._handleSpriteToAvatar=function($$,$b){$$._avatarNodes;var $u=$$._avatarNodeMap[this.name];$u&&$u.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($$,$u,$b)},$u._setAnimatorToLinkAvatar=function($$,$b){this._handleSpriteToAvatar($$,$b);for(var $u=0,$Z=this._childs.length;$u<$Z;$u++){this._childs[$u]._setAnimatorToLinkAvatar($$,$b)}},$D(0,$u,"activeInHierarchy",function(){return this._activeInHierarchy}),$D(0,$u,"_loaded",null,function($$){this.__loaded=$$}),$D(0,$u,"active",function(){return this._active},function($$){this._active!==$$&&(this._active=$$,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($$?this._activeHierarchy():this._inActiveHierarchy()))}),$D(0,$u,"componentsCount",function(){return this._components.length}),$D(0,$u,"loaded",function(){return this.__loaded}),$D(0,$u,"id",function(){return this._id}),$D(0,$u,"url",function(){return this._url}),$D(0,$u,"layer",function(){return this._layer},function($$){if(this._layer!==$$){if(!$$)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $b=0,$u=this._colliders.length;if(this._layer)for($b=0;$b<$u;$b++)this._layer._removeCollider(this._colliders[$b]);for($b=0;$b<$u;$b++)$$._addCollider(this._colliders[$b])}this._layer=$$,this.event("layerchanged",$$)}}),$D(0,$u,"scene",function(){return this._scene}),$D(0,$u,"transform",function(){return this._transform}),$b.instantiate=function($$,$b,$u,$Z,$E){void 0===$u&&($u=!0);var $r=$$.clone();$b&&$b.addChild($r);var $F=$r.transform;if($u){var $x=$F.worldMatrix;$$.transform.worldMatrix.cloneTo($x),$F.worldMatrix=$x}else $Z&&($F.position=$Z),$E&&($F.rotation=$E);return $r},$b.load=function($$){return $P.loader.create($$,null,null,$b)},$b.WORLDMATRIX=0,$b.MVPMATRIX=1,$b._uniqueIDCounter=0,$b._nameNumberCounter=0,$b}(),$Mb=function($$){function $w($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$w.__super.call(this),!$$||!$b)throw"Shader Error";this._id=++$w._count,this._vs=$$,this._ps=$b,this._attributeMap=$u,this._sceneUniformMap=$Z,this._cameraUniformMap=$E,this._spriteUniformMap=$r,this._materialUniformMap=$F,this._renderElementUniformMap=$x,this._precompile=$g,this._define=$H,this._precompile&&$w.extCompileObj&&$w.extCompileFunc?$w.extCompileFunc.call($w.extCompileObj,$$,$b,$H):this.recreateResource()}$N($w,"laya.d3.shader.Shader3D",$u);var $b=$w.prototype;return $b.recreateResource=function(){$v.now();this._compile(),this.completeCreate(),this.memorySize=0},$b.disposeResource=function(){$O.mainContext.deleteShader(this._vshader),$O.mainContext.deleteShader(this._pshader),$O.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$b._compile=function(){if(!$O.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $$=[this._vs,this._ps],$b=$O.mainContext;if(this._program=$b.createProgram(),this._vshader=$w._createShader($b,$$[0],35633),this._pshader=$w._createShader($b,$$[1],35632),$b.attachShader(this._program,this._vshader),$b.attachShader(this._program,this._pshader),$b.linkProgram(this._program),!$e.isConchApp&&$qb.debugMode&&!$b.getProgramParameter(this._program,35714))throw $b.getProgramInfoLog(this._program);var $u,$Z=0,$E=0,$r=0;for($r=$e.isConchApp?$b.getProgramParameterEx(this._vs,this._ps,"",35721):$b.getProgramParameter(this._program,35721),$Z=0;$Z<$r;$Z++){var $F=null;$u={vartype:"attribute",ivartype:0,attrib:$F=$e.isConchApp?$b.getActiveAttribEx(this._vs,this._ps,"",$Z):$b.getActiveAttrib(this._program,$Z),location:$b.getAttribLocation(this._program,$F.name),name:$F.name,type:$F.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($u)}var $x=0;for($x=$e.isConchApp?$b.getProgramParameterEx(this._vs,this._ps,"",35718):$b.getProgramParameter(this._program,35718),$Z=0;$Z<$x;$Z++){var $g=null;$g=$e.isConchApp?$b.getActiveUniformEx(this._vs,this._ps,"",$Z):$b.getActiveUniform(this._program,$Z),0<($u={vartype:"uniform",ivartype:1,attrib:$F,location:$b.getUniformLocation(this._program,$g.name),name:$g.name,type:$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($u.name=$u.name.substr(0,$u.name.length-3),$u.isArray=!0,$u.location=$b.getUniformLocation(this._program,$u.name)),this._uniformParams.push($u)}for($Z=0,$E=this._attributeParams.length;$Z<$E;$Z++)($u=this._attributeParams[$Z]).indexOfParams=$Z,$u.index=1,$u.value=[$u.location,null],$u.codename=$u.name,$u.name=null!=this._attributeMap[$u.codename]?this._attributeMap[$u.codename]:$u.codename,this._attributeParamsMap.push($u.name),this._attributeParamsMap.push($u),$u._this=this,$u.uploadedValue=[],$u.fun=this._attribute;for($Z=0,$E=this._uniformParams.length;$Z<$E;$Z++)switch(($u=this._uniformParams[$Z]).indexOfParams=$Z,$u.index=1,$u.value=[$u.location,null],$u.codename=$u.name,null!=this._sceneUniformMap[$u.codename]?($u.name=this._sceneUniformMap[$u.codename],this._sceneUniformParamsMap.push($u.name),this._sceneUniformParamsMap.push($u)):null!=this._cameraUniformMap[$u.codename]?($u.name=this._cameraUniformMap[$u.codename],this._cameraUniformParamsMap.push($u.name),this._cameraUniformParamsMap.push($u)):null!=this._spriteUniformMap[$u.codename]?($u.name=this._spriteUniformMap[$u.codename],this._spriteUniformParamsMap.push($u.name),this._spriteUniformParamsMap.push($u)):null!=this._materialUniformMap[$u.codename]?($u.name=this._materialUniformMap[$u.codename],this._materialUniformParamsMap.push($u.name),this._materialUniformParamsMap.push($u)):null!=this._renderElementUniformMap[$u.codename]?($u.name=this._renderElementUniformMap[$u.codename],this._renderElementUniformParamsMap.push($u.name),this._renderElementUniformParamsMap.push($u)):console.log("Shader:can't find uinform name:"+$u.codename+" in shader file."),$u._this=this,$u.uploadedValue=[],$u.type){case 5124:$u.fun=$u.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$u.fun=$u.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$u.fun=$u.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$u.fun=$u.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$u.fun=$u.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$u.fun=this._uniform_sampler2D;break;case 35680:$u.fun=this._uniform_samplerCube;break;case 35676:$u.fun=this._uniformMatrix4fv;break;case 35670:$u.fun=this._uniform1i;break;case 35674:$u.fun=this._uinformMatrix2fv;break;case 35675:$u.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$b._attribute=function($$,$b){var $u=$O.mainContext,$Z=$x._enableAtributes,$E=$$.location;return $Z[$E]||$u.enableVertexAttribArray($E),$u.vertexAttribPointer($E,$b[0],$b[1],$b[2],$b[3],$b[4]),$Z[$E]=$x._bindVertexBuffer,1},$b._uniform1f=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b?($O.mainContext.uniform1f($$.location,$u[0]=$b),1):0},$b._uniform1fv=function($$,$b){if($b.length<4){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($O.mainContext.uniform1fv($$.location,$b),$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3],1):0}return $O.mainContext.uniform1fv($$.location,$b),1},$b._uniform_vec2=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]?($O.mainContext.uniform2f($$.location,$u[0]=$b[0],$u[1]=$b[1]),1):0},$b._uniform_vec2v=function($$,$b){if($b.length<2){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($O.mainContext.uniform2fv($$.location,$b),$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3],1):0}return $O.mainContext.uniform2fv($$.location,$b),1},$b._uniform_vec3=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]?($O.mainContext.uniform3f($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2]),1):0},$b._uniform_vec3v=function($$,$b){return $O.mainContext.uniform3fv($$.location,$b),1},$b._uniform_vec4=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($O.mainContext.uniform4f($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3]),1):0},$b._uniform_vec4v=function($$,$b){return $O.mainContext.uniform4fv($$.location,$b),1},$b._uniformMatrix2fv=function($$,$b){return $O.mainContext.uniformMatrix2fv($$.location,!1,$b),1},$b._uniformMatrix3fv=function($$,$b){return $O.mainContext.uniformMatrix3fv($$.location,!1,$b),1},$b._uniformMatrix4fv=function($$,$b){return $O.mainContext.uniformMatrix4fv($$.location,!1,$b),1},$b._uinformMatrix2fv=function($$,$b){return $O.mainContext.uniformMatrix2fv($$.location,!1,$b),1},$b._uinformMatrix3fv=function($$,$b){return $O.mainContext.uniformMatrix3fv($$.location,!1,$b),1},$b._uniform1i=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b?($O.mainContext.uniform1i($$.location,$u[0]=$b),1):0},$b._uniform1iv=function($$,$b){return $O.mainContext.uniform1iv($$.location,$b),1},$b._uniform_ivec2=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]?($O.mainContext.uniform2i($$.location,$u[0]=$b[0],$u[1]=$b[1]),1):0},$b._uniform_ivec2v=function($$,$b){return $O.mainContext.uniform2iv($$.location,$b),1},$b._uniform_vec3i=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]?($O.mainContext.uniform3i($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2]),1):0},$b._uniform_vec3vi=function($$,$b){return $O.mainContext.uniform3iv($$.location,$b),1},$b._uniform_vec4i=function($$,$b){var $u=$$.uploadedValue;return $u[0]!==$b[0]||$u[1]!==$b[1]||$u[2]!==$b[2]||$u[3]!==$b[3]?($O.mainContext.uniform4i($$.location,$u[0]=$b[0],$u[1]=$b[1],$u[2]=$b[2],$u[3]=$b[3]),1):0},$b._uniform_vec4vi=function($$,$b){return $O.mainContext.uniform4iv($$.location,$b),1},$b._uniform_sampler2D=function($$,$b){var $u=$b.source||$b.defaulteTexture.source,$Z=$O.mainContext,$E=$$.uploadedValue;if(null!=$E[0])return $Z.activeTexture($w._TEXTURES[$E[0]]),$u&&$V.bindTexture($Z,3553,$u),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $E[0]=this._curActTexIndex,$Z.uniform1i($$.location,this._curActTexIndex),$Z.activeTexture($w._TEXTURES[this._curActTexIndex]),$u&&$V.bindTexture($Z,3553,$u),this._curActTexIndex++,1},$b._uniform_samplerCube=function($$,$b){var $u=$b.source||$b.defaulteTexture.source,$Z=$O.mainContext,$E=$$.uploadedValue;if(null!=$E[0])return $Z.activeTexture($w._TEXTURES[$E[0]]),$u?$V.bindTexture($Z,34067,$u):$V.bindTexture($Z,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $E[0]=this._curActTexIndex,$Z.uniform1i($$.location,this._curActTexIndex),$Z.activeTexture($w._TEXTURES[this._curActTexIndex]),$u?$V.bindTexture($Z,34067,$u):$V.bindTexture($Z,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$b._noSetValue=function($$){console.log("no....:"+$$.name)},$b.bind=function(){return $u.activeShader=this,($u.bindShader=this).activeResource(),$V.UseProgram(this._program)},$b.uploadAttributes=function($$,$b){for(var $u,$Z,$E=0,$r=0,$F=this._attributeParamsMap.length;$r<$F;$r+=2)$Z=this._attributeParamsMap[$r+1],null!=($u=$$[this._attributeParamsMap[$r]])&&($b&&$b[$Z.name]&&$b[$Z.name].bind(),$E+=$Z.fun.call(this,$Z,$u));$q.shaderCall+=$E},$b.uploadAttributesX=function($$,$b){for(var $u,$Z,$E=0,$r=0,$F=this._attributeParamsMap.length;$r<$F;$r+=2)$Z=this._attributeParamsMap[$r+1],null!=($u=$$[this._attributeParamsMap[$r]])&&($b._bind(),$E+=$Z.fun.call(this,$Z,$u));$q.shaderCall+=$E},$b.uploadSceneUniforms=function($$){for(var $b,$u,$Z=0,$E=0,$r=this._sceneUniformParamsMap.length;$E<$r;$E+=2)$u=this._sceneUniformParamsMap[$E+1],null!=($b=$$[this._sceneUniformParamsMap[$E]])&&($Z+=$u.fun.call(this,$u,$b));$q.shaderCall+=$Z},$b.uploadCameraUniforms=function($$){for(var $b,$u,$Z=0,$E=0,$r=this._cameraUniformParamsMap.length;$E<$r;$E+=2)$u=this._cameraUniformParamsMap[$E+1],null!=($b=$$[this._cameraUniformParamsMap[$E]])&&($Z+=$u.fun.call(this,$u,$b));$q.shaderCall+=$Z},$b.uploadSpriteUniforms=function($$){for(var $b,$u,$Z=0,$E=0,$r=this._spriteUniformParamsMap.length;$E<$r;$E+=2)$u=this._spriteUniformParamsMap[$E+1],null!=($b=$$[this._spriteUniformParamsMap[$E]])&&($Z+=$u.fun.call(this,$u,$b));$q.shaderCall+=$Z},$b.uploadMaterialUniforms=function($$){for(var $b,$u,$Z=0,$E=0,$r=this._materialUniformParamsMap.length;$E<$r;$E+=2)$u=this._materialUniformParamsMap[$E+1],null!=($b=$$[this._materialUniformParamsMap[$E]])&&($Z+=$u.fun.call(this,$u,$b));$q.shaderCall+=$Z},$b.uploadRenderElementUniforms=function($$){for(var $b,$u,$Z=0,$E=0,$r=this._renderElementUniformParamsMap.length;$E<$r;$E+=2)$u=this._renderElementUniformParamsMap[$E+1],null!=($b=$$[this._renderElementUniformParamsMap[$E]])&&($Z+=$u.fun.call(this,$u,$b));$q.shaderCall+=$Z},$w.create=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){return new $w($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H)},$w.addInclude=function($$,$b){$y.addInclude($$,$b)},$w._createShader=function($$,$b,$u){var $Z=$$.createShader($u);if($$.shaderSource($Z,$b),$$.compileShader($Z),$qb.debugMode&&!$$.getShaderParameter($Z,35713))throw $$.getShaderInfoLog($Z);return $Z},$w.PERIOD_RENDERELEMENT=0,$w.PERIOD_MATERIAL=1,$w.PERIOD_SPRITE=2,$w.PERIOD_CAMERA=3,$w.PERIOD_SCENE=4,$w._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$w._count=0,$w._preCompile=!1,$w.extCompileFunc=null,$w.extCompileObj=null,$I($w,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $a}]),$w}(),$lb=function($x){function $g(){this._transformUV=null,$g.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $Fb(.6,.6,.6)),this._setColor(10,new $Fb(1,1,1)),this._setColor(11,new $xb(1,1,1,8)),this._setColor(12,new $Fb(1,1,1)),this._setColor(7,new $xb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $xb(1,1,0,0)),this.renderMode=1}$N($g,"laya.d3.core.material.StandardMaterial",$x);var $$=$g.prototype;return $$.disableLight=function(){this._addDisablePublicShaderDefine($qb.SHADERDEFINE_POINTLIGHT|$qb.SHADERDEFINE_SPOTLIGHT|$qb.SHADERDEFINE_DIRECTIONLIGHT)},$$.disableFog=function(){this._addDisablePublicShaderDefine($qb.SHADERDEFINE_FOG)},$$.onAsynLoaded=function($$,$b,$u){var $Z=$b[0];if($Z.version)$x.prototype.onAsynLoaded.call(this,$$,$b,$u);else{var $E=$b[1],$r=$Z.props;for(var $F in $r)this[$F]=$r[$F];$g._parseStandardMaterial($E,this,$Z),this._endLoaded()}},$$.cloneTo=function($$){$x.prototype.cloneTo.call(this,$$);var $b=$$;this._transformUV&&($b._transformUV=this._transformUV.clone())},$D(0,$$,"ambientColor",function(){return this._getColor(9)},function($$){this._setColor(9,$$)}),$D(0,$$,"ambientTexture",function(){return this._getTexture(5)},function($$){$$?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$$)}),$D(0,$$,"renderMode",null,function($$){switch($$){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($g.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($$)}),$D(0,$$,"reflectColor",function(){return this._getColor(12)},function($$){this._setColor(12,$$)}),$D(0,$$,"tilingOffset",function(){return this._getColor(15)},function($$){if($$){var $b=$$.elements;1!=$b[0]||1!=$b[1]||0!=$b[2]||0!=$b[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$$)}),$D(0,$$,"albedo",function(){return this._getColor(7)},function($$){this._setColor(7,$$)}),$D(0,$$,"diffuseColor",function(){return this._getColor(10)},function($$){this._setColor(10,$$)}),$D(0,$$,"albedoColor",function(){return this._getColor(7)},function($$){this._setColor(7,$$)}),$D(0,$$,"specularColor",function(){return this._getColor(11)},function($$){this._setColor(11,$$)}),$D(0,$$,"diffuseTexture",function(){return this._getTexture(1)},function($$){$$?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$$)}),$D(0,$$,"normalTexture",function(){return this._getTexture(2)},function($$){$$?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$$)}),$D(0,$$,"specularTexture",function(){return this._getTexture(3)},function($$){$$?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$$)}),$D(0,$$,"emissiveTexture",function(){return this._getTexture(4)},function($$){$$?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$$)}),$D(0,$$,"reflectTexture",function(){return this._getTexture(6)},function($$){$$?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$$)}),$D(0,$$,"transformUV",function(){return this._transformUV},function($$){this._transformUV=$$,this._setMatrix4x4(13,$$.matrix),$$?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$$.matrix.elements,0)}),$g.__init__=function(){$g.SHADERDEFINE_DIFFUSEMAP=$g.shaderDefines.registerDefine("DIFFUSEMAP"),$g.SHADERDEFINE_NORMALMAP=$g.shaderDefines.registerDefine("NORMALMAP"),$g.SHADERDEFINE_SPECULARMAP=$g.shaderDefines.registerDefine("SPECULARMAP"),$g.SHADERDEFINE_EMISSIVEMAP=$g.shaderDefines.registerDefine("EMISSIVEMAP"),$g.SHADERDEFINE_AMBIENTMAP=$g.shaderDefines.registerDefine("AMBIENTMAP"),$g.SHADERDEFINE_REFLECTMAP=$g.shaderDefines.registerDefine("REFLECTMAP"),$g.SHADERDEFINE_UVTRANSFORM=$g.shaderDefines.registerDefine("UVTRANSFORM"),$g.SHADERDEFINE_TILINGOFFSET=$g.shaderDefines.registerDefine("TILINGOFFSET"),$g.SHADERDEFINE_ADDTIVEFOG=$g.shaderDefines.registerDefine("ADDTIVEFOG")},$g.load=function($$){return $P.loader.create($$,null,null,$g)},$g._parseStandardMaterial=function($$,$b,$u){var $Z=$u.customProps,$E=$Z.ambientColor;$b.ambientColor=new $Fb($E[0],$E[1],$E[2]);var $r=$Z.diffuseColor;$b.diffuseColor=new $Fb($r[0],$r[1],$r[2]);var $F=$Z.specularColor;$b.specularColor=new $xb($F[0],$F[1],$F[2],$F[3]);var $x=$Z.reflectColor;$b.reflectColor=new $Fb($x[0],$x[1],$x[2]);var $g=$Z.albedoColor;$g&&($b.albedo=new $xb($g[0],$g[1],$g[2],$g[3]));var $H=$Z.diffuseTexture.texture2D;$H&&($b.diffuseTexture=$T.getRes($$[$H]));var $w=$Z.normalTexture.texture2D;$w&&($b.normalTexture=$T.getRes($$[$w]));var $I=$Z.specularTexture.texture2D;$I&&($b.specularTexture=$T.getRes($$[$I]));var $o=$Z.emissiveTexture.texture2D;$o&&($b.emissiveTexture=$T.getRes($$[$o]));var $N=$Z.ambientTexture.texture2D;$N&&($b.ambientTexture=$T.getRes($$[$N]));var $D=$Z.reflectTexture.texture2D;$D&&($b.reflectTexture=$T.getRes($$[$D]))},$g.RENDERMODE_OPAQUE=1,$g.RENDERMODE_OPAQUEDOUBLEFACE=2,$g.RENDERMODE_CUTOUT=3,$g.RENDERMODE_CUTOUTDOUBLEFACE=4,$g.RENDERMODE_TRANSPARENT=13,$g.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$g.RENDERMODE_ADDTIVE=15,$g.RENDERMODE_ADDTIVEDOUBLEFACE=16,$g.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$g.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$g.RENDERMODE_DEPTHREAD_ADDTIVE=7,$g.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$g.RENDERMODE_NONDEPTH_TRANSPARENT=9,$g.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$g.RENDERMODE_NONDEPTH_ADDTIVE=11,$g.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$g.SHADERDEFINE_DIFFUSEMAP=0,$g.SHADERDEFINE_NORMALMAP=0,$g.SHADERDEFINE_SPECULARMAP=0,$g.SHADERDEFINE_EMISSIVEMAP=0,$g.SHADERDEFINE_AMBIENTMAP=0,$g.SHADERDEFINE_REFLECTMAP=0,$g.SHADERDEFINE_UVTRANSFORM=0,$g.SHADERDEFINE_TILINGOFFSET=0,$g.SHADERDEFINE_ADDTIVEFOG=0,$g.DIFFUSETEXTURE=1,$g.NORMALTEXTURE=2,$g.SPECULARTEXTURE=3,$g.EMISSIVETEXTURE=4,$g.AMBIENTTEXTURE=5,$g.REFLECTTEXTURE=6,$g.ALBEDO=7,$g.UVANIAGE=8,$g.MATERIALAMBIENT=9,$g.MATERIALDIFFUSE=10,$g.MATERIALSPECULAR=11,$g.MATERIALREFLECT=12,$g.UVMATRIX=13,$g.UVAGE=14,$g.TILINGOFFSET=15,$I($g,["defaultMaterial",function(){var $$=new $g;return $$.lock=!0,this.defaultMaterial=$$},"shaderDefines",function(){return this.shaderDefines=new $wb($Kb.shaderDefines)}]),$g}($Kb),$Xb=function($$){function $F($$,$b,$u,$Z,$E){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$u&&($u=35044),void 0===$Z&&($Z=!1),$F.__super.call(this),this._indexType=$$,this._indexCount=$b,this._bufferUsage=$u,this._bufferType=34963,this._canRead=$Z;var $r;if("ushort"==$$)this._indexTypeByteCount=2;else{if("ubyte"!=$$)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$r=this._indexTypeByteCount*$b,this._byteLength=$r,this._bind(),$x._gl.bufferData(this._bufferType,$r,this._bufferUsage),this.uri=$E,$Z?("ushort"==$$?this._buffer=new Uint16Array($b):"ubyte"==$$&&(this._buffer=new Uint8Array($b)),this.memorySize=2*$r):this.memorySize=$r}$N($F,"laya.d3.graphics.IndexBuffer3D",$$);var $b=$F.prototype;return $b.setData=function($$,$b,$u,$Z){void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=4294967295);var $E=0;if("ushort"==this._indexType?($E=2,0===$u&&4294967295===$Z||($$=new Uint16Array($$.buffer,$u*$E,$Z))):"ubyte"==this._indexType&&($E=1,0===$u&&4294967295===$Z||($$=new Uint8Array($$.buffer,$u*$E,$Z))),this._bind(),$x._gl.bufferSubData(this._bufferType,$b*$E,$$),this._canRead)if(0!==$b||0!==$u||4294967295!==$Z){var $r=this._buffer.length-$b;$r<$Z&&($Z=$r);for(var $F=0;$F<$Z;$F++)this._buffer[$b+$F]=$$[$F]}else this._buffer=$$},$b.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$b.disposeResource=function(){$$.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$D(0,$b,"indexType",function(){return this._indexType}),$D(0,$b,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$D(0,$b,"indexCount",function(){return this._indexCount}),$D(0,$b,"canRead",function(){return this._canRead}),$F.INDEXTYPE_UBYTE="ubyte",$F.INDEXTYPE_USHORT="ushort",$F.create=function($$,$b,$u,$Z,$E){return void 0===$u&&($u=35044),void 0===$Z&&($Z=!1),new $F($$,$b,$u,$Z,$E)},$F}($x),$sb=function($r){function $F($$,$b,$u,$Z,$E){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$Z&&($Z=!1),$F.__super.call(this),this._vertexDeclaration=$$,this._vertexCount=$b,this._bufferUsage=$u,this._bufferType=34962,this._canRead=$Z,this.uri=$E,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$b,this._bind(),$x._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$Z&&(this._buffer=new Float32Array(this._byteLength/4))}$N($F,"laya.d3.graphics.VertexBuffer3D",$r);var $$=$F.prototype;return $$.bindWithIndexBuffer=function($$){$$&&$$._bind(),this._bind()},$$.setData=function($$,$b,$u,$Z){if(void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=4294967295),0===$u&&4294967295===$Z||($$=new Float32Array($$.buffer,4*$u,$Z)),this._bind(),$x._gl.bufferSubData(this._bufferType,4*$b,$$),this._canRead)if(0!==$b||0!==$u||4294967295!==$Z){var $E=this._buffer.length-$b;$E<$Z&&($Z=$E);for(var $r=0;$r<$Z;$r++)this._buffer[$b+$r]=$$[$r]}else this._buffer=$$},$$.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$$.disposeResource=function(){for(var $$=$O.mainContext,$b=this._vertexDeclaration.getVertexElements(),$u=$x._enableAtributes,$Z=0,$E=$b.length;$Z<$E;$Z++)$u[$Z]===this._glBuffer&&($$.disableVertexAttribArray($Z),$u[$Z]=null);$r.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$D(0,$$,"vertexDeclaration",function(){return this._vertexDeclaration}),$D(0,$$,"vertexCount",function(){return this._vertexCount}),$D(0,$$,"canRead",function(){return this._canRead}),$F.create=function($$,$b,$u,$Z,$E){return void 0===$u&&($u=35044),void 0===$Z&&($Z=!1),new $F($$,$b,$u,$Z,$E)},$F}($x),$mb=function($$){function $y(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$y.__super.call(this),this._type=3553}$N($y,"laya.d3.resource.DataTexture2D",$Ob);var $b=$y.prototype;return $b.genDebugMipmaps=function(){var $$=[];return $$.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$$.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$$.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$$.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$$.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$$.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$$.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$$.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$$.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$$.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$$},$b._onTextureLoaded=function($$){},$b._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $$=$O.mainContext,$b=this._source=$$.createTexture(),$u=this._width,$Z=this._height,$E=$V.curBindTexTarget,$r=$V.curBindTexValue,$F=!1;if($V.bindTexture($$,this._type,$b),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $x=0;$$.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $g=0;$g<this._mipmaps.length;$g++){if(this._mipmaps[$g].byteLength!=$H*$w*4)throw"mipmap size error  level:"+$g;$$.texSubImage2D(this._type,0,$y.simLodRect[$x++],$y.simLodRect[$x++],$y.simLodRect[$x++],$y.simLodRect[$x++],6408,5121,new Uint8Array(this._mipmaps[$g]))}this.minFifter=9729,this.magFifter=9729}else{var $H=this._width,$w=this._height;for($x=0,$$.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$g=0;$g<this._mipmaps.length;$g++){if(this._mipmaps[$g].byteLength!=$H*$w*4)throw"mipmap size error  level:"+$g;$$.texImage2D(this._type,$g,6408,$H,$w,0,6408,5121,new Uint8Array(this._mipmaps[$g])),($H/=2)<1&&($H=1),($w/=2)<1&&($w=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$$.pixelStorei($$.UNPACK_ALIGNMENT,1),$$.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $I=0,$o=!1,$N=!1;this._buffer.byteLength==4*$u*$Z?($I=6408,$o=!0):this._buffer.byteLength==3*$u*$Z?($I=6407,$N=!0):$I=this._format,$o||$N?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$N&&$$.pixelStorei($$.UNPACK_ALIGNMENT,1),$$.texImage2D(this._type,0,$I,$u,$Z,0,$I,5121,this._buffer)):$$&&$I==$$.ALPHA?($$.texImage2D(3553,0,$I,$u,$Z,0,$I,$$.UNSIGNED_BYTE,this._buffer),$F=!0):0!=$I&&($$.compressedTexImage2D(3553,0,$I,$u,$Z,0,this._buffer),$F=!0)}var $D=this._minFifter,$e=this._magFifter,$L=0==this._wrapModeU?10497:33071,$T=0==this._wrapModeV?10497:33071,$_=$S.isPOT($u,$Z);$_?(this._mipmap||this._mipmaps?-1!==$D||($D=9987):-1!==$D||($D=9729),-1!==$e||($e=9729),$$.texParameteri(this._type,10241,$D),$$.texParameteri(this._type,10240,$e),$$.texParameteri(this._type,10242,$L),$$.texParameteri(this._type,10243,$T),this._mipmap&&$$.generateMipmap(this._type)):(-1!==$D||($D=9729),-1!==$e||($e=9729),$$.texParameteri(this._type,10241,$D),$$.texParameteri(this._type,10240,$e),$$.texParameteri(this._type,10242,33071),$$.texParameteri(this._type,10243,33071)),$E&&$r&&$V.bindTexture($$,$E,$r),this.memorySize=$F?this._buffer.length:$_?$u*$Z*4*(1+1/3):$u*$Z*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$b.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$b.onAsynLoaded=function($$,$b,$u){var $Z;$u&&($Z=$u[0].call(this,$b)),$Z&&(this._width=$Z.width,this._height=$Z.height,this._buffer=$Z.data),this._src=$$,this._size=new $eb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$b.getPixels=function(){return new Uint8Array(this._buffer)},$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($O.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$D(0,$b,"src",function(){return this._src}),$y.create=function($$,$b,$u,$Z,$E,$r,$F){if(void 0===$Z&&($Z=9729),void 0===$E&&($E=9729),void 0===$r&&($r=!0),!$$||$$.byteLength<$b*$u*4)throw"DataTexture2D create error";var $x=new $y;return $x.uri=$F,$x._buffer=$$,$x._width=$b,$x._height=$u,$x._mipmap=$r,$x._magFifter=$Z,$x._minFifter=$E,$x._size=new $eb($x._width,$x._height),$x._conchTexture?alert("怎么给runtime传递datatexture数据"):$x.activeResource(),$x},$y.load=function($$,$b,$u,$Z,$E){if(void 0===$b&&($b=0),void 0===$u&&($u=0),void 0===$Z&&($Z=9729),void 0===$E&&($E=9729),"mipmaps"===$t.getFileExtension($$)){var $r=$P.loader.create($$,null,null,$y,[function($$){this._mipmaps=[];var $b=new Uint32Array($$);this._width=$b[0];var $u=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$u=1024),this._width!=$u)throw"现在只支持512x256的环境贴图。当前的是"+$b[0];this._height=$b[1];for(var $Z=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$E=this._height,$r=8;;){var $F=$Z*$E*4;if($r+$F>$$.byteLength)throw"load mipmaps data size error ";var $x=new Uint8Array($$,$r,$F);if(this._mipmaps.push($x),$r+=$F,1==$Z&&1==$E)break;($Z/=2)<1&&($Z=1),($E/=2)<1&&($E=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$r.simLodInfo=new Float32Array(40);for(var $F=0;$F<$r.simLodInfo.length;)$r.simLodInfo[$F]=($y.simLodRect[$F]+.5)/1024,$F++,$r.simLodInfo[$F]=($y.simLodRect[$F]+.5)/256,$F++,$r.simLodInfo[$F]=Math.max($y.simLodRect[$F]-1,.1)/1024,$F++,$r.simLodInfo[$F]=Math.max($y.simLodRect[$F]-1.5,.1)/256,$F++}return $r}if("number"==typeof $b)return $P.loader.create($$,null,null,$y,[function($$){return this._width=$b,this._height=$u,this._buffer=$$,null}]);if("function"==typeof $b)return $P.loader.create($$,null,null,$y,[$b]);throw new Error("unknown params.")},$y.lodasatlas=!1,$I($y,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$y}(),$nb=function($$){function $b(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$b.__super.call(this)}$N($b,"laya.d3.resource.models.PrimitiveMesh",$Vb);var $u=$b.prototype;return $P.imps($u,{"laya.d3.core.render.IRenderable":!0}),$u._getVertexBuffer=function($$){return void 0===$$&&($$=0),0===$$?this._vertexBuffer:null},$u._getVertexBuffers=function(){return null},$u._getIndexBuffer=function(){return this._indexBuffer},$u._getPositions=function(){var $$,$b=[],$u=this._vertexBuffer.vertexDeclaration.getVertexElements(),$Z=0;for($Z=0;$Z<$u.length;$Z++){var $E=$u[$Z];if("vector3"===$E.elementFormat&&0===$E.elementUsage){$$=$E;break}}var $r=this._vertexBuffer.getData();for($Z=0;$Z<$r.length;$Z+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $F=$Z+$$.offset/4,$x=new $Fb($r[$F+0],$r[$F+1],$r[$F+2]);$b.push($x)}return $b},$u.getRenderElement=function($$){return this},$u.getRenderElementsCount=function(){return 1},$u.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$u._beforeRender=function($$){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$u._render=function($$){$O.mainContext.drawElements(4,this._numberIndices,5123,0),$q.drawCall++,$q.trianglesFaces+=this._numberIndices/3},$D(0,$u,"_vertexBufferCount",function(){return 1}),$D(0,$u,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$b}(),$cb=function($$){function $b(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$b.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$N($b,"laya.d3.resource.models.Mesh",$Vb);var $u=$b.prototype;return $u._getPositions=function(){var $$,$b,$u,$Z,$E,$r=[],$F=0,$x=0,$g=0;if(0!==this._vertexBuffers.length){var $H=this._vertexBuffers.length;for($F=0;$F<$H;$F++){for($u=($$=this._vertexBuffers[$F]).vertexDeclaration.getVertexElements(),$x=0;$x<$u.length;$x++)if("vector3"===($Z=$u[$x]).elementFormat&&0===$Z.elementUsage){$b=$Z;break}for($E=$$.getData(),$x=0;$x<$E.length;$x+=$$.vertexDeclaration.vertexStride/4)$g=$x+$b.offset/4,$r.push(new $Fb($E[$g+0],$E[$g+1],$E[$g+2]))}}else{var $w=this._subMeshes.length;for($F=0;$F<$w;$F++){for($u=($$=this._subMeshes[$F]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$x=0;$x<$u.length;$x++)if("vector3"===($Z=$u[$x]).elementFormat&&0===$Z.elementUsage){$b=$Z;break}for($E=$$.getData(),$x=0;$x<$E.length;$x+=$$.vertexDeclaration.vertexStride/4)$g=$x+$b.offset/4,$r.push(new $Fb($E[$g+0],$E[$g+1],$E[$g+2]))}}return $r},$u._setSubMeshes=function($$){this._subMeshes=$$,this._subMeshCount=$$.length;for(var $b=0;$b<this._subMeshCount;$b++)$$[$b]._indexInMesh=$b;this._positions=this._getPositions(),this._generateBoundingObject()},$u.onAsynLoaded=function($$,$b,$u){var $Z=$b[0],$E=$b[1];$j$.read($Z,this,this._materials,this._subMeshes,$E),this.completeCreate(),this._endLoaded()},$u.getSubMesh=function($$){return this._subMeshes[$$]},$u.getSubMeshCount=function(){return this._subMeshes.length},$u.getRenderElementsCount=function(){return this._subMeshes.length},$u.getRenderElement=function($$){return this._subMeshes[$$]},$u.disposeResource=function(){for(var $$=0;$$<this._subMeshes.length;$$++)this._subMeshes[$$].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$D(0,$u,"materials",function(){return this._materials.slice()}),$D(0,$u,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$b.load=function($$){return $P.loader.create($$,null,null,$b)},$b}(),$Jb=(function($$){function $H($$,$b,$u,$Z,$E,$r,$F,$x,$g){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$u&&($u=6408),void 0===$Z&&($Z=5121),void 0===$E&&($E=33189),void 0===$r&&($r=!1),void 0===$F&&($F=!1),void 0===$x&&($x=-1),void 0===$g&&($g=-1),$H.__super.call(this),this._type=3553,this._width=$$,this._height=$b,this._size=new $eb($$,$b),this._surfaceFormat=$u,this._surfaceType=$Z,this._depthStencilFormat=$E,$e.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$r,this._repeat=$F,this._minFifter=$x,this._magFifter=$g,this.activeResource(),this._alreadyResolved=!0}$N($H,"laya.d3.resource.RenderTexture",$Ob);var $b=$H.prototype;$b.recreateResource=function(){var $$=$O.mainContext;this._frameBuffer=$$.createFramebuffer(),this._source=$$.createTexture();var $b=$V.curBindTexTarget,$u=$V.curBindTexValue;$V.bindTexture($$,this._type,this._source),$$.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $Z=this._minFifter,$E=this._magFifter,$r=this._repeat?10497:33071;if($S.isPOT(this._width,this._height)?(this._mipmap?-1!==$Z||($Z=9987):-1!==$Z||($Z=9729),-1!==$E||($E=9729),$$.texParameteri(this._type,10241,$Z),$$.texParameteri(this._type,10240,$E),$$.texParameteri(this._type,10242,$r),$$.texParameteri(this._type,10243,$r),this._mipmap&&$$.generateMipmap(this._type)):(-1!==$Z||($Z=9729),-1!==$E||($E=9729),$$.texParameteri(this._type,10241,$Z),$$.texParameteri(this._type,10240,$E),$$.texParameteri(this._type,10242,33071),$$.texParameteri(this._type,10243,33071)),$b&&$u&&$V.bindTexture($$,$b,$u),$$.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$$.createRenderbuffer(),$$.bindRenderbuffer(36161,this._depthStencilBuffer),$$.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$$.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$$.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$$.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$$.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$$.framebufferTexture2D(36160,36064,3553,this._source,0),$$.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$b.start=function(){$O.mainContext.bindFramebuffer(36160,this.frameBuffer),($H._currentRenderTarget=this)._alreadyResolved=!1},$b.end=function(){$O.mainContext.bindFramebuffer(36160,null),$H._currentRenderTarget=null,this._alreadyResolved=!0},$b.getData=function($$,$b,$u,$Z){var $E=$O.mainContext;if($E.bindFramebuffer(36160,this._frameBuffer),!(36053===$E.checkFramebufferStatus(36160)))return $E.bindFramebuffer(36160,null),null;var $r=new Uint8Array(this._width*this._height*4);return $E.readPixels($$,$b,$u,$Z,this._surfaceFormat,this._surfaceType,$r),$E.bindFramebuffer(36160,null),$r},$b.disposeResource=function(){if(this._frameBuffer){var $$=$O.mainContext;$$.deleteTexture(this._source),$$.deleteFramebuffer(this._frameBuffer),$$.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$D(0,$b,"surfaceFormat",function(){return this._surfaceFormat}),$D(0,$b,"surfaceType",function(){return this._surfaceType}),$D(0,$b,"depthStencilFormat",function(){return this._depthStencilFormat}),$D(0,$b,"source",function(){return this._alreadyResolved?$P.superGet($Ob,this,"source"):null}),$D(0,$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$D(0,$b,"frameBuffer",function(){return this._frameBuffer}),$H._currentRenderTarget=null}(),function($$){function $b($$){this._color=null,this._pixels=null,$b.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $eb(this.width,this.height),this._color=$$,this._pixels=new Uint8Array([255*$$.x,255*$$.y,255*$$.z,255*$$.w]),this.uri="SolidColorTexture2D_"+this.id}$N($b,"laya.d3.resource.SolidColorTexture2D",$Ob);var $u=$b.prototype;return $u._createWebGlTexture=function(){var $$=$O.mainContext,$b=this._source=$$.createTexture(),$u=this._width,$Z=this._height,$E=$V.curBindTexTarget,$r=$V.curBindTexValue;$V.bindTexture($$,this._type,$b),$$.texImage2D(this._type,0,6408,$u,$Z,0,6408,5121,this._pixels);var $F=this._minFifter,$x=this._magFifter,$g=this._repeat?10497:33071,$H=$S.isPOT($u,$Z);$H?(this._mipmap?-1!==$F||($F=9987):-1!==$F||($F=9729),-1!==$x||($x=9729),$$.texParameteri(this._type,10241,$F),$$.texParameteri(this._type,10240,$x),$$.texParameteri(this._type,10242,$g),$$.texParameteri(this._type,10243,$g),this._mipmap&&$$.generateMipmap(this._type)):(-1!==$F||($F=9729),-1!==$x||($x=9729),$$.texParameteri(this._type,10241,$F),$$.texParameteri(this._type,10240,$x),$$.texParameteri(this._type,10242,33071),$$.texParameteri(this._type,10243,33071)),$E&&$r&&$V.bindTexture($$,$E,$r),this.memorySize=$H?$u*$Z*4*(1+1/3):$u*$Z*4},$u.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$u.disposeResource=function(){this._source&&($O.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$I($b,["magentaTexture",function(){var $$=new $b(new $xb(1,0,1,1));return $$.lock=!0,this.magentaTexture=$$},"grayTexture",function(){var $$=new $b(new $xb(.5,.5,.5,1));return $$.lock=!0,this.grayTexture=$$}]),$b}()),$fb=function($$){function $E($$,$b,$u,$Z){this._canRead=!1,this._image=null,this._pixels=null,void 0===$$&&($$=!1),void 0===$b&&($b=!0),void 0===$u&&($u=6408),void 0===$Z&&($Z=!0),$E.__super.call(this),this._type=3553,this._repeat=$b,this._canRead=$$,this._format=$u,this._mipmap=$Z}$N($E,"laya.d3.resource.Texture2D",$Ob);var $b=$E.prototype;return $b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $$=$O.mainContext,$b=this._source=$$.createTexture(),$u=this._width,$Z=this._height,$E=$V.curBindTexTarget,$r=$V.curBindTexValue;switch($V.bindTexture($$,this._type,$b),this._format){case 6407:case 6408:this._canRead?$$.texImage2D(this._type,0,this._format,$u,$Z,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$$.texImage2D(this._type,0,this._image._format,$u,$Z,0,this._image._format,5121,this._image.atlasSource):$$.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $O.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$$.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $F=this._minFifter,$x=this._magFifter,$g=this._repeat?10497:33071,$H=0==this._wrapModeU?10497:33071,$w=0==this._wrapModeV?10497:33071,$I=$S.isPOT($u,$Z);$I?(this._mipmap?-1!==$F||($F=9987):-1!==$F||($F=9729),-1!==$x||($x=9729),$$.texParameteri(this._type,10241,$F),$$.texParameteri(this._type,10240,$x),$$.texParameteri(this._type,10242,$g),$$.texParameteri(this._type,10243,$g),$$.texParameteri(this._type,10242,$H),$$.texParameteri(this._type,10243,$w),this._mipmap&&$$.generateMipmap(this._type)):(-1!==$F||($F=9729),-1!==$x||($x=9729),$$.texParameteri(this._type,10241,$F),$$.texParameteri(this._type,10240,$x),$$.texParameteri(this._type,10242,33071),$$.texParameteri(this._type,10243,33071)),$E&&$r&&$V.bindTexture($$,$E,$r),this._image.onload=null,this._image=null,this.memorySize=$I?$u*$Z*4*(1+1/3):$u*$Z*4},$b.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$b.onAsynLoaded=function($$,$b,$u){if($u){var $Z=$u[0];void 0!==$Z&&(this._canRead=$Z);var $E=$u[1];void 0!==$E&&(this._repeat=$E);var $r=$u[2];void 0!==$r&&(this._format=$r);var $F=$u[3];void 0!==$F&&(this._mipmap=$F);var $x=$u.wrapModeU;void 0!==$x&&(this._wrapModeU=$x);var $g=$u.wrapModeV;void 0!==$g&&(this._wrapModeV=$g)}switch(this._format){case 6407:case 6408:var $H=(this._image=$b).width,$w=$b.height;this._width=$H,this._height=$w,this._size=new $eb($H,$w),this._canRead&&($e.isConchApp?$b instanceof $o.HTMLElement&&(this._pixels=new Uint8Array($b.getImageData(0,0,$H,$w))):($v.canvas.size($H,$w),$v.canvas.clear(),$v.context.drawImage($b,0,0,$H,$w),this._pixels=new Uint8Array($v.context.getImageData(0,0,$H,$w).data.buffer)));break;case $O.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $I=new $i($b);$I.readUTFBytes(4),$I.readUTFBytes(2),$I.getInt16();$I.endian="bigEndian",this._width=$I.getInt16(),this._height=$I.getInt16(),this._size=new $eb(this._width,this._height);$I.getInt16(),$I.getInt16();this._image=new Uint8Array($b,$I.pos)}this.recreateResource(),this._endLoaded()},$b.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$b.disposeResource=function(){this._source&&($O.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$D(0,$b,"_src",function(){return this.url}),$D(0,$b,"src",function(){return this.url}),$E.load=function($$){return $P.loader.create($$,null,null,$E)},$E}(),$Qb=function($b){function $u($$,$b){$u.__super.call(this),void 0===$$&&($$=.3),void 0===$b&&($b=1e3),this._tempVector3=new $Fb,this._position=new $Fb,this._up=new $Fb,this._forward=new $Fb,this._right=new $Fb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$eb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$$,this._farPlane=$b,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$P.stage.on("resize",this,this._onScreenSizeChanged)}$N($u,"laya.d3.core.BaseCamera",$b);var $$=$u.prototype;return $$._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $$=this.scene._cameraPool,$b=$$.length-1,$u=0;$u<$b;$u++)if($$[$u].renderingOrder>$$[$b].renderingOrder){var $Z=$$[$u];$$[$u]=$$[$b],$$[$b]=$Z}},$$._calculateProjectionMatrix=function(){},$$._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$$._prepareCameraToRender=function(){$p._currentCameraCullingMask=this.cullingMask;var $$=this._shaderValues;$$.setValue(0,this.transform.position.elements),$$.setValue(5,this.forward.elements),$$.setValue(6,this.up.elements)},$$._prepareCameraViewProject=function($$,$b){var $u=this._shaderValues;$u.setValue(1,$$.elements),$u.setValue(2,$b.elements)},$$._renderCamera=function($$,$b,$u){},$$.addLayer=function($$){29!==$$.number&&30!=$$.number&&(this.cullingMask=this.cullingMask|$$.mask)},$$.removeLayer=function($$){29!==$$.number&&30!=$$.number&&(this.cullingMask=this.cullingMask&~$$.mask)},$$.addAllLayers=function(){this.cullingMask=2147483647},$$.removeAllLayers=function(){this.cullingMask=0|$p.getLayerByNumber(29).mask|$p.getLayerByNumber(30).mask},$$.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$$.moveForward=function($$){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$$,this.transform.translate(this._tempVector3)},$$.moveRight=function($$){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$$,this.transform.translate(this._tempVector3)},$$.moveVertical=function($$){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$$,this.transform.translate(this._tempVector3,!1)},$$._addSelfRenderObjects=function(){var $$=this.scene._cameraPool,$b=$$.length;if(0<$b){for(var $u=$b-1;0<=$u;$u--)if(this.renderingOrder<=$$[$u].renderingOrder){$$.splice($u+1,0,this);break}}else $$.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$$._clearSelfRenderObjects=function(){var $$=this.scene._cameraPool;$$.splice($$.indexOf(this),1)},$$.destroy=function($$){void 0===$$&&($$=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$P.stage.off("resize",this,this._onScreenSizeChanged),$b.prototype.destroy.call(this,$$)},$D(0,$$,"sky",function(){return this._sky},function($$){(this._sky=$$)._ownerCamera=this}),$D(0,$$,"forward",function(){var $$=this.transform.worldMatrix.elements,$b=this._forward.elements;return $b[0]=-$$[8],$b[1]=-$$[9],$b[2]=-$$[10],this._forward}),$D(0,$$,"position",function(){var $$=this.transform.worldMatrix.elements,$b=this._position.elements;return $b[0]=$$[12],$b[1]=$$[13],$b[2]=$$[14],this._position}),$D(0,$$,"renderTarget",function(){return this._renderTarget},function($$){null!=(this._renderTarget=$$)&&(this._renderTargetSize=$$.size)}),$D(0,$$,"up",function(){var $$=this.transform.worldMatrix.elements,$b=this._up.elements;return $b[0]=$$[4],$b[1]=$$[5],$b[2]=$$[6],this._up}),$D(0,$$,"right",function(){var $$=this.transform.worldMatrix.elements,$b=this._right.elements;return $b[0]=$$[0],$b[1]=$$[1],$b[2]=$$[2],this._right}),$D(0,$$,"renderTargetSize",function(){return this._renderTargetSize},function($$){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$$,this._calculateProjectionMatrix()}),$D(0,$$,"fieldOfView",function(){return this._fieldOfView},function($$){this._fieldOfView=$$,this._calculateProjectionMatrix()}),$D(0,$$,"nearPlane",function(){return this._nearPlane},function($$){this._nearPlane=$$,this._calculateProjectionMatrix()}),$D(0,$$,"farPlane",function(){return this._farPlane},function($$){this._farPlane=$$,this._calculateProjectionMatrix()}),$D(0,$$,"orthographic",function(){return this._orthographic},function($$){this._orthographic=$$,this._calculateProjectionMatrix()}),$D(0,$$,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($$){this._orthographicVerticalSize=$$,this._calculateProjectionMatrix()}),$D(0,$$,"renderingOrder",function(){return this._renderingOrder},function($$){this._renderingOrder=$$,this._sortCamerasByRenderingOrder()}),$u.CAMERAPOS=0,$u.VIEWMATRIX=1,$u.PROJECTMATRIX=2,$u.VPMATRIX=3,$u.VPMATRIX_NO_TRANSLATE=4,$u.CAMERADIRECTION=5,$u.CAMERAUP=6,$u.ENVIRONMENTDIFFUSE=7,$u.ENVIRONMENTSPECULAR=8,$u.SIMLODINFO=9,$u.DIFFUSEIRRADMATR=10,$u.DIFFUSEIRRADMATG=11,$u.DIFFUSEIRRADMATB=12,$u.HDREXPOSURE=13,$u.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$u.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$u.CLEARFLAG_SOLIDCOLOR=0,$u.CLEARFLAG_SKY=1,$u.CLEARFLAG_DEPTHONLY=2,$u.CLEARFLAG_NONE=3,$I($u,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $$b(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $$b},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $$b}]),$u}($kb),$Wb=function($u){function $b($$){this._render=null,this._geometryFilter=null,$b.__super.call(this,$$)}$N($b,"laya.d3.core.RenderableSprite3D",$u);var $$=$b.prototype;return $$._addToInitStaticBatchManager=function(){},$$._setBelongScene=function($$){$u.prototype._setBelongScene.call(this,$$),$$._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$$._setUnBelongScene=function(){var $$=this._scene._renderableSprite3Ds,$b=$$.indexOf(this);$$.splice($b,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$u.prototype._setUnBelongScene.call(this)},$$._update=function($$){($$.owner=this)._activeInHierarchy&&(this._updateComponents($$),this._render._updateOctreeNode(),this._lateUpdateComponents($$),$q.spriteCount++,this._childs.length&&this._updateChilds($$))},$$.destroy=function($$){void 0===$$&&($$=!0),$u.prototype.destroy.call(this,$$),this._render._destroy(),this._render=null},$b.__init__=function(){$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$b.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$b.SAHDERDEFINE_LIGHTMAP=$b.shaderDefines.registerDefine("LIGHTMAP")},$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$b.SAHDERDEFINE_LIGHTMAP=4,$b.LIGHTMAPSCALEOFFSET=2,$b.LIGHTMAP=3,$I($b,["shaderDefines",function(){return this.shaderDefines=new $wb}]),$b}($kb),$Gb=(function($$){function $Z($$,$b,$u){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$$&&($$=1),void 0===$b&&($b=1),void 0===$u&&($u=1),$Z.__super.call(this),this._long=$$,this._width=$b,this._height=$u,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$N($Z,"laya.d3.resource.models.BoxMesh",$nb);var $b=$Z.prototype;$b.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $$=$O$.vertexDeclaration,$b=($$.vertexStride,this._long/2),$u=this._height/2,$Z=this._width/2,$E=new Float32Array([-$b,$u,-$Z,0,1,0,0,0,$b,$u,-$Z,0,1,0,1,0,$b,$u,$Z,0,1,0,1,1,-$b,$u,$Z,0,1,0,0,1,-$b,-$u,-$Z,0,-1,0,0,1,$b,-$u,-$Z,0,-1,0,1,1,$b,-$u,$Z,0,-1,0,1,0,-$b,-$u,$Z,0,-1,0,0,0,-$b,$u,-$Z,-1,0,0,0,0,-$b,$u,$Z,-1,0,0,1,0,-$b,-$u,$Z,-1,0,0,1,1,-$b,-$u,-$Z,-1,0,0,0,1,$b,$u,-$Z,1,0,0,1,0,$b,$u,$Z,1,0,0,0,0,$b,-$u,$Z,1,0,0,0,1,$b,-$u,-$Z,1,0,0,1,1,-$b,$u,$Z,0,0,1,0,0,$b,$u,$Z,0,0,1,1,0,$b,-$u,$Z,0,0,1,1,1,-$b,-$u,$Z,0,0,1,0,1,-$b,$u,-$Z,0,0,-1,1,0,$b,$u,-$Z,0,0,-1,0,0,$b,-$u,-$Z,0,0,-1,0,1,-$b,-$u,-$Z,0,0,-1,1,1]),$r=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $sb($$,this._numberVertices,35044,!0),this._indexBuffer=new $Xb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($E),this._indexBuffer.setData($r),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$D(0,$b,"long",function(){return this._long},function($$){this._long!==$$&&(this._long=$$,this.releaseResource(),this.activeResource())}),$D(0,$b,"width",function(){return this._width},function($$){this._width!==$$&&(this._width=$$,this.releaseResource(),this.activeResource())}),$D(0,$b,"height",function(){return this._height},function($$){this._height!==$$&&(this._height=$$,this.releaseResource(),this.activeResource())})}(),function($$){function $E($$,$b,$u,$Z){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$$&&($$=10),void 0===$b&&($b=10),void 0===$u&&($u=10),void 0===$Z&&($Z=10),$E.__super.call(this),this._long=$$,this._width=$b,this._stacks=$u,this._slices=$Z,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$N($E,"laya.d3.resource.models.PlaneMesh",$nb);var $b=$E.prototype;$b.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $$=new Uint16Array(this._numberIndices),$b=$O$.vertexDeclaration,$u=$b.vertexStride/4,$Z=new Float32Array(this._numberVertices*$u),$E=this._long/2,$r=this._width/2,$F=this._long/this._stacks,$x=this._width/this._slices,$g=0,$H=0;$H<=this._slices;$H++)for(var $w=0;$w<=this._stacks;$w++)$Z[$g++]=$w*$F-$E,$Z[$g++]=0,$Z[$g++]=$H*$x-$r,$Z[$g++]=0,$Z[$g++]=1,$Z[$g++]=0,$Z[$g++]=1*$w/this._stacks,$Z[$g++]=1*$H/this._slices;var $I=0;for($H=0;$H<this._slices;$H++)for($w=0;$w<this._stacks;$w++)$$[$I++]=($H+1)*(this._stacks+1)+$w,$$[$I++]=$H*(this._stacks+1)+$w,$$[$I++]=($H+1)*(this._stacks+1)+$w+1,$$[$I++]=$H*(this._stacks+1)+$w,$$[$I++]=$H*(this._stacks+1)+$w+1,$$[$I++]=($H+1)*(this._stacks+1)+$w+1;this._vertexBuffer=new $sb($b,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $Xb("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($Z),this._indexBuffer.setData($$),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$D(0,$b,"long",function(){return this._long},function($$){this._long!==$$&&(this._long=$$,this.releaseResource(),this.activeResource())}),$D(0,$b,"width",function(){return this._width},function($$){this._width!==$$&&(this._width=$$,this.releaseResource(),this.activeResource())}),$D(0,$b,"stacks",function(){return this._stacks},function($$){this._stacks!==$$&&(this._stacks=$$,this.releaseResource(),this.activeResource())}),$D(0,$b,"slices",function(){return this._slices},function($$){this._slices!==$$&&(this._slices=$$,this.releaseResource(),this.activeResource())})}(),function($$){function $F($$,$b,$u){void 0===$$&&($$=0),void 0===$b&&($b=.3),void 0===$u&&($u=1e3),this._viewMatrix=new $$b,this._projectionMatrix=new $$b,this._projectionViewMatrix=new $$b,this._viewport=new $gb(0,0,0,0),this._normalizedViewport=new $gb(0,0,1,1),this._aspectRatio=$$,this._boundFrustumUpdate=!0,this._boundFrustum=new $d$($$b.DEFAULT),$F.__super.call(this,$b,$u),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$N($F,"laya.d3.core.Camera",$Qb);var $b=$F.prototype;return $b._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$b._parseCustomProps=function($$,$b,$u,$Z){var $E=$u.clearColor;this.clearColor=new $xb($E[0],$E[1],$E[2],$E[3]);var $r=$u.viewport;this.normalizedViewport=new $gb($r[0],$r[1],$r[2],$r[3])},$b._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $$=this.orthographicVerticalSize*this.aspectRatio*.5,$b=.5*this.orthographicVerticalSize;$$b.createOrthoOffCenterRH(-$$,$$,-$b,$b,this.nearPlane,this.farPlane,this._projectionMatrix)}else $$b.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$b._update=function($$){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$$)},$b._renderCamera=function($$,$b,$u){var $Z,$E;$u.parallelSplitShadowMaps[0]&&$u._renderShadowMap($$,$b,this),($b.camera=this)._prepareCameraToRender(),$u._preRenderUpdateComponents($b),$Z=$b._viewMatrix=this.viewMatrix;var $r=this._renderTarget;$r?($r.start(),$$b.multiply($Qb._invertYScaleMatrix,this._projectionMatrix,$Qb._invertYProjectionMatrix),$$b.multiply($Qb._invertYScaleMatrix,this.projectionViewMatrix,$Qb._invertYProjectionViewMatrix),$E=$b._projectionMatrix=$Qb._invertYProjectionMatrix,$b._projectionViewMatrix=$Qb._invertYProjectionViewMatrix):($E=$b._projectionMatrix=this._projectionMatrix,$b._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($Z,$E),$b._viewport=this.viewport,$u._preRenderScene($$,$b,this.boundFrustum),$u._clear($$,$b),$u._renderScene($$,$b),$u._postRenderUpdateComponents($b),$r&&$r.end()},$b.viewportPointToRay=function($$,$b){$Db.calculateCursorRay($$,this.viewport,this._projectionMatrix,this.viewMatrix,null,$b)},$b.normalizedViewportPointToRay=function($$,$b){var $u=$F._tempVector20,$Z=this.viewport,$E=$$.elements,$r=$u.elements;$r[0]=$E[0]*$Z.width,$r[1]=$E[1]*$Z.height,$Db.calculateCursorRay($u,this.viewport,this._projectionMatrix,this.viewMatrix,null,$b)},$b.worldToViewportPoint=function($$,$b){$$b.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($$,this._projectionViewMatrix,$b);var $u=$b.elements;$u[0]=$u[0]/$P.stage.clientScaleX,$u[1]=$u[1]/$P.stage.clientScaleY},$b.worldToNormalizedViewportPoint=function($$,$b){$$b.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($$,this._projectionViewMatrix,$b);var $u=$b.elements;$u[0]=$u[0]/$P.stage.clientScaleX,$u[1]=$u[1]/$P.stage.clientScaleY},$b.convertScreenCoordToOrthographicCoord=function($$,$b){if(this._orthographic){var $u=$j.clientWidth,$Z=$j.clientHeight,$E=this.orthographicVerticalSize*this.aspectRatio/$u,$r=this.orthographicVerticalSize/$Z,$F=$$.elements,$x=$b.elements;return $x[0]=(-$u/2+$F[0])*$E,$x[1]=($Z/2-$F[1])*$r,$x[2]=(this.nearPlane-this.farPlane)*($F[2]+1)/2-this.nearPlane,$Fb.transformCoordinate($b,this.transform.worldMatrix,$b),!0}return!1},$D(0,$b,"projectionViewMatrix",function(){return $$b.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$D(0,$b,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $$=this.viewport;return $$.width/$$.height},function($$){if($$<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$$,this._calculateProjectionMatrix()}),$D(0,$b,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$D(0,$b,"needViewport",function(){var $$=this.normalizedViewport;return 0===$$.x&&0===$$.y&&1===$$.width&&1===$$.height}),$D(0,$b,"viewport",function(){if(this._viewportExpressedInClipSpace){var $$=this._normalizedViewport,$b=this.renderTargetSize,$u=$b.width,$Z=$b.height;this._viewport.x=$$.x*$u,this._viewport.y=$$.y*$Z,this._viewport.width=$$.width*$u,this._viewport.height=$$.height*$Z}return this._viewport},function($$){if(null!=this.renderTarget&&($$.x<0||$$.y<0||0==$$.width||0==$$.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$$,this._calculateProjectionMatrix()}),$D(0,$b,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $$=this._viewport,$b=this.renderTargetSize,$u=$b.width,$Z=$b.height;this._normalizedViewport.x=$$.x/$u,this._normalizedViewport.y=$$.y/$Z,this._normalizedViewport.width=$$.width/$u,this._normalizedViewport.height=$$.height/$Z}return this._normalizedViewport},function($$){$$.x<0&&($$.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$$.y<0&&($$.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$$.x+$$.width&&($$.width=1-$$.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$$.y+$$.height&&($$.height=1-$$.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$$,this._calculateProjectionMatrix()}),$D(0,$b,"projectionMatrix",function(){return this._projectionMatrix},function($$){this._projectionMatrix=$$,this._useUserProjectionMatrix=!0}),$D(0,$b,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$I($F,["_tempVector20",function(){return this._tempVector20=new $rb}]),$F}()),$Ab=function($u){function $Z($$,$b){$Z.__super.call(this,$b),this._geometryFilter=new $vb(this),this._render=new $pb(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$$&&(this._geometryFilter.sharedMesh=$$)instanceof laya.d3.resource.models.Mesh&&($$.loaded?this._render.sharedMaterials=$$.materials:$$.once("loaded",this,this._applyMeshMaterials))}$N($Z,"laya.d3.core.MeshSprite3D",$u);var $$=$Z.prototype;return $$._changeRenderObjectByMesh=function($$){var $b=this._render._renderElements,$u=$b[$$];$u||($u=$b[$$]=new $zb),$u._render=this._render;var $Z=this._render.sharedMaterials[$$];$Z||($Z=$lb.defaultMaterial);var $E=this._geometryFilter.sharedMesh.getRenderElement($$);return $u._mainSortID=this._getSortID($E,$Z),$u._sprite3D=this,$u.renderObj=$E,$u._material=$Z,$u},$$._changeRenderObjectByMaterial=function($$,$b){var $u=this._render._renderElements[$$];$b||($b=$lb.defaultMaterial);var $Z=this._geometryFilter.sharedMesh.getRenderElement($$);return $u._mainSortID=this._getSortID($Z,$b),$u._sprite3D=this,$u.renderObj=$Z,$u._material=$b,$u},$$._changeRenderObjectsByMesh=function(){var $$=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$$;for(var $b=0;$b<$$;$b++)this._changeRenderObjectByMesh($b)},$$._onMeshChanged=function($$){var $b=$$.sharedMesh;$b.loaded?this._changeRenderObjectsByMesh():$b.once("loaded",this,this._onMeshLoaded)},$$._onMeshLoaded=function($$){$$===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$$._onMaterialChanged=function($$,$b,$u){$b<this._render._renderElements.length&&this._changeRenderObjectByMaterial($b,$u)},$$._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$$._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$$._parseCustomProps=function($$,$b,$u,$Z){var $E=this.meshRender,$r=$u.lightmapIndex;null!=$r&&($E.lightmapIndex=$r);var $F,$x,$g=$u.lightmapScaleOffset;if($g&&($E.lightmapScaleOffset=new $xb($g[0],$g[1],$g[2],$g[3])),$Z.instanceParams)($F=$Z.instanceParams.loadPath)&&($x=$T.getRes($b[$F]),(this.meshFilter.sharedMesh=$x).loaded?$E.sharedMaterials=$x.materials:$x.once("loaded",this,this._applyMeshMaterials));else{($F=$u.meshPath)&&($x=$T.getRes($b[$F]),this.meshFilter.sharedMesh=$x);var $H=$u.materials;if($H){var $w=$E.sharedMaterials,$I=$H.length;$w.length=$I;for(var $o=0;$o<$I;$o++)$w[$o]=$T.getRes($b[$H[$o].path]);$E.sharedMaterials=$w}}},$$._applyMeshMaterials=function($$){for(var $b=this._render.sharedMaterials,$u=$$.materials,$Z=0,$E=$u.length;$Z<$E;$Z++)$b[$Z]||($b[$Z]=$u[$Z]);this._render.sharedMaterials=$b},$$._addToInitStaticBatchManager=function(){$Z._staticBatchManager._addInitBatchSprite(this)},$$.cloneTo=function($$){var $b=$$;$b._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $u=this._render,$Z=$b._render;$Z.enable=$u.enable,$Z.sharedMaterials=$u.sharedMaterials,$Z.castShadow=$u.castShadow;var $E=$u.lightmapScaleOffset;$E&&($Z.lightmapScaleOffset=$E.clone()),$Z.lightmapIndex=$u.lightmapIndex,$Z.receiveShadow=$u.receiveShadow,$Z.sortingFudge=$u.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$$)},$$.destroy=function($$){if(void 0===$$&&($$=!0),!this.destroyed){var $b=this.meshFilter.sharedMesh;null!=$b&&($b.loaded||$b.off("loaded",this,this._applyMeshMaterials)),$u.prototype.destroy.call(this,$$),this._geometryFilter._destroy()}},$D(0,$$,"meshFilter",function(){return this._geometryFilter}),$D(0,$$,"meshRender",function(){return this._render}),$Z.__init__=function(){$Z$._staticBatchManagers.push($Z._staticBatchManager)},$Z.load=function($$){return $P.loader.create($$,null,null,$Z)},$I($Z,["_staticBatchManager",function(){return this._staticBatchManager=new $ab}]),$Z}($Wb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($$,$b){"use strict";for(var $u in Object.defineProperty($b,"__esModule",{value:!0}),Laya){var $Z=Laya[$u];$Z&&$Z.__isclass&&($b[$u]=$Z)}}),function($$,$b,$E$){$E$.un,$E$.uns;var $u=$E$.static,$Z=$E$.class,$r=$E$.getset,$e=$E$.__newvec,$x=laya.maths.Bezier,$I=laya.utils.Browser,$O$=laya.utils.Byte,$E=(laya.events.Event,laya.events.EventDispatcher),$F=laya.display.Graphics,$g=(laya.resource.HTMLCanvas,laya.utils.Handler),$H=laya.net.Loader,$o=laya.maths.MathUtil,$V$=laya.maths.Matrix,$L=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$w=(laya.renders.RenderContext,laya.resource.Resource),$N=laya.utils.RunDriver,$r$=laya.display.Sprite,$D=laya.utils.Stat,$v$=laya.resource.Texture,$T=(laya.net.URL,laya.utils.Utils),$V=function(){function $$(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $Z($$,"laya.ani.AnimationContent"),$$}(),$v=function(){function $$(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $Z($$,"laya.ani.AnimationNodeContent"),$$}(),$y=function(){function $$(){}return $Z($$,"laya.ani.AnimationParser01"),$$.parse=function($$,$b){var $u=$b.__getBuffer(),$Z=0,$E=0,$r=0,$F=0,$x=0,$g=0,$H=0,$w=$b.readUTFString();$$._aniClassName=$w;var $I,$o=$b.readUTFString().split("\n"),$N=$b.getUint8(),$D=$b.getUint32(),$e=$b.getUint32();0<$D&&($I=$u.slice($D,$e));var $L=new $O$($I);for(0<$e&&($$._publicExtData=$u.slice($e,$u.byteLength)),$$._useParent=!!$b.getUint8(),$$._anis.length=$N,$Z=0;$Z<$N;$Z++){var $T=$$._anis[$Z]=new $V;$T.nodes=new Array;var $_=$T.name=$o[$b.getUint16()];$$._aniMap[$_]=$Z,$T.bone3DMap={},$T.playTime=$b.getFloat32(),$T.playTime<=0&&console.error("播放时间不能为0  url="+$$.url+" name="+$T.name);var $y=$T.nodes.length=$b.getUint8();for($E=$T.totalKeyframeDatasLength=0;$E<$y;$E++){var $S=$T.nodes[$E]=new $v;$S.childs=[];var $P=$b.getInt16();0<=$P&&($S.name=$o[$P],$T.bone3DMap[$S.name]=$E),$S.keyFrame=new Array,$S.parentIndex=$b.getInt16(),-1==$S.parentIndex?$S.parent=null:$S.parent=$T.nodes[$S.parentIndex],$S.lerpType=$b.getUint8();var $i=$b.getUint32();$L.pos=$i;var $z=$S.keyframeWidth=$L.getUint16();if($T.totalKeyframeDatasLength+=$z,0===$S.lerpType||1===$S.lerpType)for($S.interpolationMethod=[],$S.interpolationMethod.length=$z,$r=0;$r<$z;$r++)$S.interpolationMethod[$r]=$k.interpolation[$L.getUint8()];null!=$S.parent&&$S.parent.childs.push($S);var $q=$b.getUint16();0<$q&&($S.extenData=$u.slice($b.pos,$b.pos+$q),$b.pos+=$q);var $a,$t=$b.getUint16(),$C=0;for($r=0,$F=$S.keyFrame.length=$t;$r<$F;$r++){if(($a=$S.keyFrame[$r]=new $p).duration=$b.getFloat32(),$a.startTime=$C,2===$S.lerpType){$a.interpolationData=[];var $K,$O=$b.getUint8();switch($K=$b.getFloat32()){case 254:for($a.interpolationData.length=$z,$H=0;$H<$z;$H++)$a.interpolationData[$H]=0;break;case 255:for($a.interpolationData.length=$z,$H=0;$H<$z;$H++)$a.interpolationData[$H]=5;break;default:for($a.interpolationData.push($K),$g=1;$g<$O;$g++)$a.interpolationData.push($b.getFloat32())}}for($a.data=new Float32Array($z),$x=0;$x<$z;$x++)$a.data[$x]=$b.getFloat32(),-1e-8<$a.data[$x]&&$a.data[$x]<1e-8&&($a.data[$x]=0);$C+=$a.duration}$a.startTime=$T.playTime,$S.playTime=$T.playTime,$$._calculateKeyFrame($S,$t,$z)}}},$$}(),$S=function(){function $P(){}return $Z($P,"laya.ani.AnimationParser02"),$P.READ_DATA=function(){$P._DATA.offset=$P._reader.getUint32(),$P._DATA.size=$P._reader.getUint32()},$P.READ_BLOCK=function(){for(var $$=$P._BLOCK.count=$P._reader.getUint16(),$b=$P._BLOCK.blockStarts=[],$u=$P._BLOCK.blockLengths=[],$Z=0;$Z<$$;$Z++)$b.push($P._reader.getUint32()),$u.push($P._reader.getUint32())},$P.READ_STRINGS=function(){var $$=$P._reader.getUint32(),$b=$P._reader.getUint16(),$u=$P._reader.pos;$P._reader.pos=$$+$P._DATA.offset;for(var $Z=0;$Z<$b;$Z++)$P._strings[$Z]=$P._reader.readUTFString();$P._reader.pos=$u},$P.parse=function($$,$b){$P._templet=$$;($P._reader=$b).__getBuffer();$P.READ_DATA(),$P.READ_BLOCK(),$P.READ_STRINGS();for(var $u=0,$Z=$P._BLOCK.count;$u<$Z;$u++){var $E=$b.getUint16(),$r=$P._strings[$E],$F=$P["READ_"+$r];if(null==$F)throw new Error("model file err,no this function:"+$E+" "+$r);$F.call()}},$P.READ_ANIMATIONS=function(){var $$=$P._reader,$b=$$.__getBuffer(),$u=0,$Z=0,$E=0,$r=0,$F=$$.getUint16(),$x=[];for($x.length=$F,$u=0;$u<$F;$u++)$x[$u]=$k.interpolation[$$.getByte()];var $g=$$.getUint8();for($P._templet._anis.length=$g,$u=0;$u<$g;$u++){var $H=$P._templet._anis[$u]={};$H.nodes=new Array;var $w=$H.name=$P._strings[$$.getUint16()];$P._templet._aniMap[$w]=$u,$H.bone3DMap={},$H.playTime=$$.getFloat32();var $I=$H.nodes.length=$$.getInt16();for($Z=$H.totalKeyframeDatasLength=0;$Z<$I;$Z++){var $o=$H.nodes[$Z]={};$o.keyframeWidth=$F,$o.childs=[];var $N=$$.getUint16();0<=$N&&($o.name=$P._strings[$N],$H.bone3DMap[$o.name]=$Z),$o.keyFrame=new Array,$o.parentIndex=$$.getInt16(),-1==$o.parentIndex?$o.parent=null:$o.parent=$H.nodes[$o.parentIndex],$H.totalKeyframeDatasLength+=$F,$o.interpolationMethod=$x,null!=$o.parent&&$o.parent.childs.push($o);var $D=$$.getUint16(),$e=null,$L=null;for($E=0,$r=$o.keyFrame.length=$D;$E<$r;$E++){($e=$o.keyFrame[$E]={}).startTime=$$.getFloat32(),$L&&($L.duration=$e.startTime-$L.startTime);var $T=$P._DATA.offset,$_=$$.getUint32(),$y=4*$F,$S=$b.slice($T+$_,$T+$_+$y);$e.data=new Float32Array($S),$L=$e}$e.duration=0,$o.playTime=$H.playTime,$P._templet._calculateKeyFrame($o,$D,$F)}}},$P._templet=null,$P._reader=null,$P._strings=[],$u($P,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$P}(),$p$=(function(){function $$(){}$Z($$,"laya.ani.AnimationState"),$$.stopped=0,$$.paused=1,$$.playing=2}(),function(){function $E(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $W$,this.resultMatrix=new $V$,this._children=[]}$Z($E,"laya.ani.bone.Bone");var $$=$E.prototype;return $$.setTempMatrix=function($$){this._tempMatrix=$$;var $b,$u=0;for($u=0,$b=this._children.length;$u<$b;$u++)this._children[$u].setTempMatrix(this._tempMatrix)},$$.update=function($$){var $b;if(this.rotation=this.transform.skX,$$)$b=this.resultTransform.getMatrix(),$V$.mul($b,$$,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$b=this.resultTransform.getMatrix(),$V$.mul($b,this.parentBone.resultMatrix,this.resultMatrix);else{var $u=this.parentBone,$Z=NaN,$E=NaN,$r=NaN,$F=this.parentBone.resultMatrix;$b=this.resultTransform.getMatrix();var $x=$F.a*$b.tx+$F.c*$b.ty+$F.tx,$g=$F.b*$b.tx+$F.d*$b.ty+$F.ty,$H=new $V$;this.inheritRotation?($Z=Math.atan2($u.resultMatrix.b,$u.resultMatrix.a),$E=Math.cos($Z),$r=Math.sin($Z),$H.setTo($E,$r,-$r,$E,0,0),$V$.mul(this._tempMatrix,$H,$V$.TEMP),$V$.TEMP.copyTo($H),$b=this.resultTransform.getMatrix(),$V$.mul($b,$H,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$b=this.resultTransform.getMatrix(),$V$.TEMP.identity(),$V$.TEMP.d=this.d,$V$.mul($b,$V$.TEMP,this.resultMatrix)),this.resultMatrix.tx=$x,this.resultMatrix.ty=$g}else($b=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $w,$I=0;for($I=0,$w=this._children.length;$I<$w;$I++)this._children[$I].update()},$$.updateChild=function(){var $$,$b=0;for($b=0,$$=this._children.length;$b<$$;$b++)this._children[$b].update()},$$.setRotation=function($$){this._sprite&&(this._sprite.rotation=180*$$/Math.PI)},$$.updateDraw=function($$,$b){$E.ShowBones&&!$E.ShowBones[this.name]||(this._sprite||(this._sprite=new $r$,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$E$.stage.addChild(this._sprite)),this._sprite.x=$$+this.resultMatrix.tx,this._sprite.y=$b+this.resultMatrix.ty);var $u,$Z=0;for($Z=0,$u=this._children.length;$Z<$u;$Z++)this._children[$Z].updateDraw($$,$b)},$$.addChild=function($$){this._children.push($$),$$.parentBone=this},$$.findBone=function($$){if(this.name==$$)return this;var $b,$u,$Z=0;for($Z=0,$b=this._children.length;$Z<$b;$Z++)if($u=this._children[$Z].findBone($$))return $u;return null},$$.localToWorld=function($$){var $b=$$[0],$u=$$[1];$$[0]=$b*this.resultMatrix.a+$u*this.resultMatrix.c+this.resultMatrix.tx,$$[1]=$b*this.resultMatrix.b+$u*this.resultMatrix.d+this.resultMatrix.ty},$E.ShowBones={},$E}()),$Y$=function(){function $e(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$Z($e,"laya.ani.bone.BoneSlot");var $$=$e.prototype;return $$.showSlotData=function($$,$b){void 0===$b&&($b=!0),this.currSlotData=$$,$b&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$$.showDisplayByName=function($$){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($$))},$$.replaceDisplayByName=function($$,$b){if(this.currSlotData){var $u;$u=this.currSlotData.getDisplayByName($$);var $Z;$Z=this.currSlotData.getDisplayByName($b),this.replaceDisplayByIndex($u,$Z)}},$$.replaceDisplayByIndex=function($$,$b){this.currSlotData&&(this._replaceDic[$$]=$b,this.displayIndex==$$&&this.showDisplayByIndex($$))},$$.showDisplayByIndex=function($$){if(null!=this._replaceDic[$$]&&($$=this._replaceDic[$$]),this.currSlotData&&-1<$$&&$$<this.currSlotData.displayArr.length){if(this.displayIndex=$$,this.currDisplayData=this.currSlotData.displayArr[$$],this.currDisplayData){var $b=this.currDisplayData.name;this.currTexture=this.templet.getTexture($b),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$L.isConchApp||$L.isConchApp&&"0.9.15"<$r$.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$$.replaceSkin=function($$){this._diyTexture=$$,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$$.setParentMatrix=function($$){this._parentMatrix=$$},$$.draw=function($$,$b,$u,$Z){if(void 0===$u&&($u=!1),void 0===$Z&&($Z=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $E,$r=this.currTexture;switch(this._diyTexture&&($r=this._diyTexture),this.currDisplayData.type){case 0:if($$){var $F=this.getDisplayMatrix();if(this._parentMatrix){var $x=!1;if($F){var $g;if($V$.mul($F,this._parentMatrix,$V$.TEMP),$g=$u?(null==this._resultMatrix&&(this._resultMatrix=new $V$),this._resultMatrix):new $V$,!$L.isWebGL&&this.currDisplayData.uvs||$L.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $H=$e._tempMatrix;$H.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($H.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($x=!0,$H.rotate(-Math.PI/2)),$V$.mul($H,$V$.TEMP,$g)}else $V$.TEMP.copyTo($g);$x?$$.drawTexture($r,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$g):$$.drawTexture($r,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$g)}}}break;case 1:if(null==($E=$u?(null==this._skinSprite&&(this._skinSprite=$e.createSkinMesh()),this._skinSprite):$e.createSkinMesh()))return;var $w;if(null==this.currDisplayData.bones){var $I,$o=this.currDisplayData.weights;this.deformData&&($o=this.deformData),$I=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$o;this.currDisplayData.triangles.length;$w=this.currDisplayData.triangles,$E.init2($r,null,$w,this._mVerticleArr,$I);var $N,$D=this.getDisplayMatrix();if(this._parentMatrix)if($D)$V$.mul($D,this._parentMatrix,$V$.TEMP),$N=$u?(null==this._resultMatrix&&(this._resultMatrix=new $V$),this._resultMatrix):new $V$,$V$.TEMP.copyTo($N),$E.transform=$N}else this.skinMesh($b,$E,$Z);$$.drawSkin($E);break;case 2:if(null==($E=$u?(null==this._skinSprite&&(this._skinSprite=$e.createSkinMesh()),this._skinSprite):$e.createSkinMesh()))return;this.skinMesh($b,$E,$Z),$$.drawSkin($E)}}},$$.skinMesh=function($$,$b,$u){var $Z,$E=this.currTexture,$r=this.currDisplayData.bones;$Z=this._diyTexture?($E=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $F,$x,$g=this.currDisplayData.weights,$H=this.currDisplayData.triangles,$w=0,$I=0,$o=0,$N=NaN,$D=NaN,$e=0,$L=0,$T=[],$_=0,$y=0;if(this.deformData&&0<this.deformData.length){var $S=0;for($_=0,$y=$r.length;$_<$y;){for($o=$r[$_++]+$_,$I=$w=0;$_<$o;$_++)$x=$$[$r[$_]],$N=$g[$e]+this.deformData[$S++],$D=$g[$e+1]+this.deformData[$S++],$L=$g[$e+2],$w+=($N*$x.a+$D*$x.c+$x.tx)*$L,$I+=($N*$x.b+$D*$x.d+$x.ty)*$L,$e+=3;$T.push($w,$I)}}else for($_=0,$y=$r.length;$_<$y;){for($o=$r[$_++]+$_,$I=$w=0;$_<$o;$_++)$x=$$[$r[$_]],$N=$g[$e],$D=$g[$e+1],$L=$g[$e+2],$w+=($N*$x.a+$D*$x.c+$x.tx)*$L,$I+=($N*$x.b+$D*$x.d+$x.ty)*$L,$e+=3;$T.push($w,$I)}this._mVerticleArr=$T,$F=$H,$b.init2($E,null,$F,this._mVerticleArr,$Z)},$$.drawBonePoint=function($$){$$&&this._parentMatrix&&$$.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$$.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$$.getMatrix=function(){return this._resultMatrix},$$.copy=function(){var $$=new $e;return $$.type="copy",$$.name=this.name,$$.attachmentName=this.attachmentName,$$.srcDisplayIndex=this.srcDisplayIndex,$$.parent=this.parent,$$.displayIndex=this.displayIndex,$$.templet=this.templet,$$.currSlotData=this.currSlotData,$$.currTexture=this.currTexture,$$.currDisplayData=this.currDisplayData,$$},$e.createSkinMesh=function(){return $L.isWebGL||$L.isConchApp?$N.skinAniSprite():($L.isWebGL,null)},$u($e,["_tempMatrix",function(){return this._tempMatrix=new $V$}]),$e}(),$k$=function(){function $$(){this.skinName=null,this.deformSlotDataList=[]}return $Z($$,"laya.ani.bone.DeformAniData"),$$}(),$M$=function(){function $$(){this.deformSlotDisplayList=[]}return $Z($$,"laya.ani.bone.DeformSlotData"),$$}(),$l$=function(){function $$(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$Z($$,"laya.ani.bone.DeformSlotDisplayData");var $b=$$.prototype;return $b.binarySearch1=function($$,$b){var $u=0,$Z=$$.length-2;if(0==$Z)return 1;for(var $E=$Z>>>1;;){if($$[Math.floor($E+1)]<=$b?$u=$E+1:$Z=$E,$u==$Z)return $u+1;$E=$u+$Z>>>1}return 0},$b.apply=function($$,$b,$u){if(void 0===$u&&($u=1),$$+=.05,!(this.timeList.length<=0)){var $Z=0;if(!($$<this.timeList[0])){var $E=this.vectices[0].length,$r=[],$F=this.binarySearch1(this.timeList,$$);if(this.frameIndex=$F,$$>=this.timeList[this.timeList.length-1]){var $x=this.vectices[this.vectices.length-1];if($u<1)for($Z=0;$Z<$E;$Z++)$r[$Z]+=($x[$Z]-$r[$Z])*$u;else for($Z=0;$Z<$E;$Z++)$r[$Z]=$x[$Z];this.deformData=$r}else{this.tweenKeyList[this.frameIndex];var $g=this.vectices[this.frameIndex-1],$H=this.vectices[this.frameIndex],$w=this.timeList[this.frameIndex-1],$I=this.timeList[this.frameIndex];$u=this.tweenKeyList[$F-1]?($$-$w)/($I-$w):0;var $o=NaN;for($Z=0;$Z<$E;$Z++)$o=$g[$Z],$r[$Z]=$o+($H[$Z]-$o)*$u;this.deformData=$r}}}},$$}(),$X$=function(){function $$(){this.time=NaN,this.drawOrder=[]}return $Z($$,"laya.ani.bone.DrawOrderData"),$$}(),$s$=function(){function $$(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $Z($$,"laya.ani.bone.EventData"),$$}(),$_=function(){function $Z$($$,$b){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$$,this._targetBone=$b[$$.targetBoneIndex],this.isSpine=$$.isSpine,null==this._bones&&(this._bones=[]);for(var $u=this._bones.length=0,$Z=$$.boneIndexs.length;$u<$Z;$u++)this._bones.push($b[$$.boneIndexs[$u]]);this.name=$$.name,this.mix=$$.mix,this.bendDirection=$$.bendDirection}$Z($Z$,"laya.ani.bone.IkConstraint");var $$=$Z$.prototype;return $$.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$$._applyIk1=function($$,$b,$u,$Z){var $E=$$.parentBone,$r=1/($E.resultMatrix.a*$E.resultMatrix.d-$E.resultMatrix.b*$E.resultMatrix.c),$F=$b-$E.resultMatrix.tx,$x=$u-$E.resultMatrix.ty,$g=($F*$E.resultMatrix.d-$x*$E.resultMatrix.c)*$r-$$.transform.x,$H=($x*$E.resultMatrix.a-$F*$E.resultMatrix.b)*$r-$$.transform.y,$w=Math.atan2($H,$g)*$Z$.radDeg-0-$$.transform.skX;$$.transform.scX<0&&($w+=180),180<$w?$w-=360:$w<-180&&($w+=360),$$.transform.skX=$$.transform.skY=$$.transform.skX+$w*$Z,$$.update()},$$.updatePos=function($$,$b){this._sp&&this._sp.pos($$,$b)},$$._applyIk2=function($$,$b,$u,$Z,$E,$r){if(0!=$r){var $F=$$.resultTransform.x,$x=$$.resultTransform.y,$g=$$.transform.scX,$H=$$.transform.scY,$w=$b.transform.scX,$I=0,$o=0,$N=0;$N=$g<0?($g=-$g,$I=180,-1):($I=0,1),$H<0&&($H=-$H,$N=-$N),$o=$w<0?($w=-$w,180):0;var $D=$b.resultTransform.x,$e=NaN,$L=NaN,$T=NaN,$_=$$.resultMatrix.a,$y=$$.resultMatrix.c,$S=$$.resultMatrix.b,$P=$$.resultMatrix.d,$i=Math.abs($g-$H)<=1e-4;$T=$i?($L=$_*$D+$y*($e=$b.resultTransform.y)+$$.resultMatrix.tx,$S*$D+$P*$e+$$.resultMatrix.ty):($e=0,$L=$_*$D+$$.resultMatrix.tx,$S*$D+$$.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $r$,$E$.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($u,$Z,15,"#ffff00"),this._sp.graphics.drawCircle($L,$T,15,"#ff00ff")),$$.setRotation(Math.atan2($T-$$.resultMatrix.ty,$L-$$.resultMatrix.tx));var $z=$$.parentBone;$_=$z.resultMatrix.a,$y=$z.resultMatrix.c,$S=$z.resultMatrix.b;var $q=1/($_*($P=$z.resultMatrix.d)-$y*$S),$a=$u-$z.resultMatrix.tx,$t=$Z-$z.resultMatrix.ty,$C=($a*$P-$t*$y)*$q-$F,$K=($t*$_-$a*$S)*$q-$x,$O=(($a=$L-$z.resultMatrix.tx)*$P-($t=$T-$z.resultMatrix.ty)*$y)*$q-$F,$V=($t*$_-$a*$S)*$q-$x,$v=Math.sqrt($O*$O+$V*$V),$p=$b.length*$w,$Y=NaN,$k=NaN;if($i){var $M=($C*$C+$K*$K-$v*$v-($p*=$g)*$p)/(2*$v*$p);$M<-1?$M=-1:1<$M&&($M=1),$k=Math.acos($M)*$E,$_=$v+$p*$M,$y=$p*Math.sin($k),$Y=Math.atan2($K*$_-$C*$y,$C*$_+$K*$y)}else{var $l=($_=$g*$p)*$_,$X=($y=$H*$p)*$y,$s=$C*$C+$K*$K,$m=Math.atan2($K,$C),$n=-2*$X*$v,$c=$X-$l;if(0<($P=$n*$n-4*$c*($S=$X*$v*$v+$l*$s-$l*$X))){var $J=Math.sqrt($P);$n<0&&($J=-$J);var $f=($J=-($n+$J)/2)/$c,$Q=$S/$J,$W=Math.abs($f)<Math.abs($Q)?$f:$Q;$W*$W<=$s&&($t=Math.sqrt($s-$W*$W)*$E,$Y=$m-Math.atan2($t,$W),$k=Math.atan2($t/$H,($W-$v)/$g))}var $G=0,$A=Number.MAX_VALUE,$j=0,$h=0,$d=0,$U=0,$B=0,$R=0;$U<($P=($a=$v+$_)*$a)&&($d=0,$U=$P,$B=$a),($P=($a=$v-$_)*$a)<$A&&($G=Math.PI,$A=$P,$j=$a);var $$$=Math.acos(-$_*$v/($l-$X));($P=($a=$_*Math.cos($$$)+$v)*$a+($t=$y*Math.sin($$$))*$t)<$A&&($G=$$$,$A=$P,$j=$a,$h=$t),$U<$P&&($d=$$$,$U=$P,$B=$a,$R=$t),$k=$s<=($A+$U)/2?($Y=$m-Math.atan2($h*$E,$j),$G*$E):($Y=$m-Math.atan2($R*$E,$B),$d*$E)}var $b$=Math.atan2($e,$D)*$N,$u$=$$.resultTransform.skX;180<($Y=($Y-$b$)*$Z$.radDeg+$I-$u$)?$Y-=360:$Y<-180&&($Y+=360),$$.resultTransform.x=$F,$$.resultTransform.y=$x,$$.resultTransform.skX=$$.resultTransform.skY=$u$+$Y*$r,$u$=$b.resultTransform.skX,180<($k=(($k+$b$)*$Z$.radDeg-0)*$N+$o-($u$%=360))?$k-=360:$k<-180&&($k+=360),$b.resultTransform.x=$D,$b.resultTransform.y=$e,$b.resultTransform.skX=$b.resultTransform.skY=$b.resultTransform.skY+$k*$r,$$.update()}},$$._applyIk3=function($$,$b,$u,$Z,$E,$r){if(0!=$r){var $F,$x,$g=$b.resultMatrix.a*$b.length,$H=$b.resultMatrix.b*$b.length,$w=$g*$g+$H*$H,$I=Math.sqrt($w),$o=$$.resultMatrix.tx,$N=$$.resultMatrix.ty,$D=$b.resultMatrix.tx,$e=$b.resultMatrix.ty,$L=$D-$o,$T=$e-$N,$_=$L*$L+$T*$T,$y=Math.sqrt($_),$S=($L=$u-$$.resultMatrix.tx)*$L+($T=$Z-$$.resultMatrix.ty)*$T,$P=Math.sqrt($S);if($I+$y<=$P||$P+$I<=$y||$P+$y<=$I){var $i=NaN;$D=$o+($i=$I+$y<=$P?1:-1)*($u-$o)*$y/$P,$e=$N+$i*($Z-$N)*$y/$P}else{var $z=($_-$w+$S)/(2*$S),$q=Math.sqrt($_-$z*$z*$S)/$P,$a=$o+$L*$z,$t=$N+$T*$z,$C=-$T*$q,$K=$L*$q;$e=0<$E?($D=$a-$C,$t-$K):($D=$a+$C,$t+$K)}$F=$D,$x=$e,this.isDebug&&(this._sp||(this._sp=new $r$,$E$.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($o,$N,15,"#ff00ff"),this._sp.graphics.drawCircle($u,$Z,15,"#ffff00"),this._sp.graphics.drawCircle($F,$x,15,"#ff00ff"));var $O,$V;$O=Math.atan2($x-$$.resultMatrix.ty,$F-$$.resultMatrix.tx),$$.setRotation($O),($V=$Z$._tempMatrix).identity(),$V.rotate($O),$V.scale($$.resultMatrix.getScaleX(),$$.resultMatrix.getScaleY()),$V.translate($$.resultMatrix.tx,$$.resultMatrix.ty),$V.copyTo($$.resultMatrix),$$.updateChild();var $v,$p;$v=Math.atan2($Z-$x,$u-$F),$b.setRotation($v),($p=$Z$._tempMatrix).identity(),$p.rotate($v),$p.scale($b.resultMatrix.getScaleX(),$b.resultMatrix.getScaleY()),$p.translate($F,$x),$V.copyTo($b.resultMatrix),$b.updateChild()}},$u($Z$,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $V$}]),$Z$}(),$m$=function(){function $$(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $Z($$,"laya.ani.bone.IkConstraintData"),$$}(),$P=function(){function $p($$,$b){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$$,this.position=$$.position,this.spacing=$$.spacing,this.rotateMix=$$.rotateMix,this.translateMix=$$.translateMix,this.bones=[];for(var $u=this.data.bones,$Z=0,$E=$u.length;$Z<$E;$Z++)this.bones.push($b[$u[$Z]])}$Z($p,"laya.ani.bone.PathConstraint");var $$=$p.prototype;return $$.apply=function($$,$b){if(this.target){var $u=this.translateMix,$Z=this.translateMix,$E=0<$Z,$r=this.data.spacingMode,$F="length"==$r,$x=this.data.rotateMode,$g="tangent"==$x,$H="chainScale"==$x,$w=[],$I=this.bones.length,$o=$g?$I:$I+1,$N=[];(this._spaces=$N)[0]=this.position;var $D=this.spacing;if($H||$F)for(var $e=0,$L=$o-1;$e<$L;){var $T=this.bones[$e],$_=$T.length,$y=$_*$T.resultMatrix.a,$S=$_*$T.resultMatrix.b;$_=Math.sqrt($y*$y+$S*$S),$H&&($w[$e]=$_),$N[++$e]=$F?Math.max(0,$_+$D):$D}else for($e=1;$e<$o;$e++)$N[$e]=$D;var $P=this.computeWorldPositions(this.target,$$,$b,$o,$g,"percent"==this.data.positionMode,"percent"==$r);if(this._debugKey){for($e=0;$e<$P.length;$e++)$b.drawCircle($P[$e++],$P[$e++],5,"#00ff00");var $i=[];for($e=0;$e<$P.length;$e++)$i.push($P[$e++],$P[$e++]);$b.drawLines(0,0,$i,"#ff0000")}var $z=$P[0],$q=$P[1],$a=this.data.offsetRotation,$t="chain"==$x&&0==$a,$C=NaN;for($e=0,$C=3;$e<$I;$e++,$C+=3){($T=this.bones[$e]).resultMatrix.tx+=($z-$T.resultMatrix.tx)*$u,$T.resultMatrix.ty+=($q-$T.resultMatrix.ty)*$u;var $K=($y=$P[$C])-$z,$O=($S=$P[$C+1])-$q;if($H&&0!=($_=$w[$e])){var $V=(Math.sqrt($K*$K+$O*$O)/$_-1)*$Z+1;$T.resultMatrix.a*=$V,$T.resultMatrix.c*=$V}if($z=$y,$q=$S,$E){var $v=$T.resultMatrix.a,$p=$T.resultMatrix.c,$Y=$T.resultMatrix.b,$k=$T.resultMatrix.d,$M=NaN,$l=NaN,$X=NaN;$M=$g?$P[$C-1]:0==$N[$e+1]?$P[$C+2]:Math.atan2($O,$K),$M-=Math.atan2($Y,$v)-$a/180*Math.PI,$t&&($l=Math.cos($M),$X=Math.sin($M),$z+=(($_=$T.length)*($l*$v-$X*$Y)-$K)*$Z,$q+=($_*($X*$v+$l*$Y)-$O)*$Z),$M>Math.PI?$M-=2*Math.PI:$M<-Math.PI&&($M+=2*Math.PI),$M*=$Z,$l=Math.cos($M),$X=Math.sin($M),$T.resultMatrix.a=$l*$v-$X*$Y,$T.resultMatrix.c=$l*$p-$X*$k,$T.resultMatrix.b=$X*$v+$l*$Y,$T.resultMatrix.d=$X*$p+$l*$k}}}},$$.computeWorldVertices2=function($$,$b,$u,$Z,$E,$r){var $F,$x,$g=$$.currDisplayData.bones,$H=$$.currDisplayData.weights,$w=$$.currDisplayData.triangles,$I=0,$o=0,$N=0,$D=0,$e=0,$L=0,$T=0,$_=0,$y=0,$S=0,$P=0;if(null!=$g){for($I=0;$I<$u;$I+=2)$o+=($D=$g[$o])+1,$N+=$D;var $i=$b;for($e=$r,$L=3*$N;$e<$Z;$e+=2){for($_=$T=0,$D=$g[$o++],$D+=$o;$o<$D;$o++,$L+=3){$F=$i[$g[$o]].resultMatrix,$y=$H[$L],$S=$H[$L+1];var $z=$H[$L+2];$T+=($y*$F.a+$S*$F.c+$F.tx)*$z,$_+=($y*$F.b+$S*$F.d+$F.ty)*$z}$E[$e]=$T,$E[$e+1]=$_}}else{var $q,$a;if($w||($w=$H),$$.deformData&&($w=$$.deformData),$q=$$.parent,$b)for($P=$b.length,$I=0;$I<$P;$I++)if($b[$I].name==$q){$x=$b[$I];break}$x&&($a=$x.resultMatrix),$a||($a=$p._tempMt);var $t=$a.tx,$C=$a.ty,$K=$a.a,$O=$a.b,$V=$a.c,$v=$a.d;for($x&&($v*=$x.d),$o=$u,$e=$r;$e<$Z;$o+=2,$e+=2)$y=$w[$o],$S=$w[$o+1],$E[$e]=$y*$K+$S*$O+$t,$E[$e+1]=-($y*$V+$S*$v+$C)}},$$.computeWorldPositions=function($$,$b,$u,$Z,$E,$r,$F){$$.currDisplayData.bones,$$.currDisplayData.weights,$$.currDisplayData.triangles;var $x=[],$g=0,$H=$$.currDisplayData.verLen,$w=this.position,$I=this._spaces,$o=[],$N=[],$D=$H/6,$e=-1,$L=NaN,$T=0,$_=0,$y=NaN,$S=NaN,$P=NaN,$i=NaN;if($D--,$H-=4,this.computeWorldVertices2($$,$b,2,$H,$x,0),this._debugKey)for($g=0;$g<$x.length;)$u.drawCircle($x[$g++],$x[$g++],10,"#ff0000");$o=$x,this._curves.length=$D;var $z=this._curves,$q=$o[$L=0],$a=$o[1],$t=0,$C=0,$K=0,$O=0,$V=0,$v=0,$p=NaN,$Y=NaN,$k=NaN,$M=NaN,$l=NaN,$X=NaN,$s=NaN,$m=NaN,$n=0;for($g=0,$n=2;$g<$D;$g++,$n+=6)$t=$o[$n],$C=$o[$n+1],$K=$o[$n+2],$O=$o[$n+3],$l=2*($p=.1875*($q-2*$t+$K))+($k=.09375*(3*($t-$K)-$q+($V=$o[$n+4]))),$X=2*($Y=.1875*($a-2*$C+$O))+($M=.09375*(3*($C-$O)-$a+($v=$o[$n+5]))),$s=.75*($t-$q)+$p+.16666667*$k,$m=.75*($C-$a)+$Y+.16666667*$M,$L+=Math.sqrt($s*$s+$m*$m),$s+=$l,$m+=$X,$l+=$k,$X+=$M,$L+=Math.sqrt($s*$s+$m*$m),$s+=$l,$m+=$X,$L+=Math.sqrt($s*$s+$m*$m),$s+=$l+$k,$m+=$X+$M,$L+=Math.sqrt($s*$s+$m*$m),$z[$g]=$L,$q=$V,$a=$v;if($r&&($w*=$L),$F)for($g=0;$g<$Z;$g++)$I[$g]*=$L;var $c=this._segments,$J=0,$f=0;for($f=$_=$T=$g=0;$g<$Z;$g++,$T+=3)if(($y=$w+=$S=$I[$g])<0)this.addBeforePosition($y,$o,0,$N,$T);else if($L<$y)this.addAfterPosition($y-$L,$o,$H-4,$N,$T);else{for(;;$_++)if(!(($i=$z[$_])<$y)){0==$_?$y/=$i:$y=($y-($P=$z[$_-1]))/($i-$P);break}if($_!=$e){var $Q=6*($e=$_);for($q=$o[$Q],$a=$o[$Q+1],$t=$o[$Q+2],$C=$o[$Q+3],$K=$o[$Q+4],$O=$o[$Q+5],$l=2*($p=.03*($q-2*$t+$K))+($k=.006*(3*($t-$K)-$q+($V=$o[$Q+6]))),$X=2*($Y=.03*($a-2*$C+$O))+($M=.006*(3*($C-$O)-$a+($v=$o[$Q+7]))),$s=.3*($t-$q)+$p+.16666667*$k,$m=.3*($C-$a)+$Y+.16666667*$M,$J=Math.sqrt($s*$s+$m*$m),$c[0]=$J,$Q=1;$Q<8;$Q++)$s+=$l,$m+=$X,$l+=$k,$X+=$M,$J+=Math.sqrt($s*$s+$m*$m),$c[$Q]=$J;$s+=$l,$m+=$X,$J+=Math.sqrt($s*$s+$m*$m),$c[8]=$J,$s+=$l+$k,$m+=$X+$M,$J+=Math.sqrt($s*$s+$m*$m),$c[9]=$J,$f=0}for($y*=$J;;$f++)if(!(($i=$c[$f])<$y)){0==$f?$y/=$i:$y=$f+($y-($P=$c[$f-1]))/($i-$P);break}this.addCurvePosition(.1*$y,$q,$a,$t,$C,$K,$O,$V,$v,$N,$T,$E||0<$g&&0==$S)}return $N},$$.addBeforePosition=function($$,$b,$u,$Z,$E){var $r=$b[$u],$F=$b[$u+1],$x=$b[$u+2]-$r,$g=$b[$u+3]-$F,$H=Math.atan2($g,$x);$Z[$E]=$r+$$*Math.cos($H),$Z[$E+1]=$F+$$*Math.sin($H),$Z[$E+2]=$H},$$.addAfterPosition=function($$,$b,$u,$Z,$E){var $r=$b[$u+2],$F=$b[$u+3],$x=$r-$b[$u],$g=$F-$b[$u+1],$H=Math.atan2($g,$x);$Z[$E]=$r+$$*Math.cos($H),$Z[$E+1]=$F+$$*Math.sin($H),$Z[$E+2]=$H},$$.addCurvePosition=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w,$I){0==$$&&($$=1e-4);var $o=$$*$$,$N=$o*$$,$D=1-$$,$e=$D*$D,$L=$e*$D,$T=$D*$$,$_=3*$T,$y=$D*$_,$S=$_*$$,$P=$b*$L+$Z*$y+$r*$S+$x*$N,$i=$u*$L+$E*$y+$F*$S+$g*$N;$H[$w]=$P,$H[$w+1]=$i,$H[$w+2]=$I?Math.atan2($i-($u*$e+$E*$T*2+$F*$o),$P-($b*$e+$Z*$T*2+$r*$o)):0},$p.NONE=-1,$p.BEFORE=-2,$p.AFTER=-3,$u($p,["_tempMt",function(){return this._tempMt=new $V$}]),$p}(),$n$=function(){function $$(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $Z($$,"laya.ani.bone.PathConstraintData"),$$}(),$c$=function(){function $$(){this.name=null,this.slotArr=[]}return $Z($$,"laya.ani.bone.SkinData"),$$}(),$J$=function(){function $$(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$Z($$,"laya.ani.bone.SkinSlotDisplayData");var $b=$$.prototype;return $b.createTexture=function($$){return this.texture||(this.texture=new $v$($$.bitmap,this.uvs),$$.bitmap.alphaTexture&&(this.texture.alphaTexture=new $v$($$.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$$.height,this.texture.height=$$.width,this.texture.offsetX=-$$.offsetX,this.texture.offsetY=-$$.offsetY,this.texture.sourceWidth=$$.sourceHeight,this.texture.sourceHeight=$$.sourceWidth):(this.texture.width=$$.width,this.texture.height=$$.height,this.texture.offsetX=-$$.offsetX,this.texture.offsetY=-$$.offsetY,this.texture.sourceWidth=$$.sourceWidth,this.texture.sourceHeight=$$.sourceHeight),$L.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$b.destory=function(){this.texture&&this.texture.destroy()},$$}(),$f$=function(){function $$(){this.name=null,this.displayArr=[]}return $Z($$,"laya.ani.bone.SlotData"),$$.prototype.getDisplayByName=function($$){for(var $b=0,$u=this.displayArr.length;$b<$u;$b++)if(this.displayArr[$b].attachmentName==$$)return $b;return-1},$$}(),$i=function(){function $$($$,$b){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$e(2,0),this._data=$$,null==this._bones&&(this._bones=[]),this.target=$b[$$.targetIndex];var $u,$Z=0;for($Z=0,$u=$$.boneIndexs.length;$Z<$u;$Z++)this._bones.push($b[$$.boneIndexs[$Z]]);this.rotateMix=$$.rotateMix,this.translateMix=$$.translateMix,this.scaleMix=$$.scaleMix,this.shearMix=$$.shearMix}return $Z($$,"laya.ani.bone.TfConstraint"),$$.prototype.apply=function(){for(var $$,$b=this.target.resultMatrix.a,$u=this.target.resultMatrix.b,$Z=this.target.resultMatrix.c,$E=this.target.resultMatrix.d,$r=0,$F=this._bones.length;$r<$F;$r++){if($$=this._bones[$r],0<this.rotateMix){var $x=$$.resultMatrix.a,$g=$$.resultMatrix.b,$H=$$.resultMatrix.c,$w=$$.resultMatrix.d,$I=Math.atan2($Z,$b)-Math.atan2($H,$x)+this._data.offsetRotation*Math.PI/180;$I>Math.PI?$I-=2*Math.PI:$I<-Math.PI&&($I+=2*Math.PI),$I*=this.rotateMix;var $o=Math.cos($I),$N=Math.sin($I);$$.resultMatrix.a=$o*$x-$N*$H,$$.resultMatrix.b=$o*$g-$N*$w,$$.resultMatrix.c=$N*$x+$o*$H,$$.resultMatrix.d=$N*$g+$o*$w}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$$.resultMatrix.tx+=(this._temp[0]-$$.resultMatrix.tx)*this.translateMix,$$.resultMatrix.ty+=(this._temp[1]-$$.resultMatrix.ty)*this.translateMix,$$.updateChild()),0<this.scaleMix){var $D=Math.sqrt($$.resultMatrix.a*$$.resultMatrix.a+$$.resultMatrix.c*$$.resultMatrix.c),$e=Math.sqrt($b*$b+$Z*$Z),$L=1e-5<$D?($D+($e-$D+this._data.offsetScaleX)*this.scaleMix)/$D:0;$$.resultMatrix.a*=$L,$$.resultMatrix.c*=$L,$D=Math.sqrt($$.resultMatrix.b*$$.resultMatrix.b+$$.resultMatrix.d*$$.resultMatrix.d),$e=Math.sqrt($u*$u+$E*$E),$L=1e-5<$D?($D+($e-$D+this._data.offsetScaleY)*this.scaleMix)/$D:0,$$.resultMatrix.b*=$L,$$.resultMatrix.d*=$L}if(0<this.shearMix){$g=$$.resultMatrix.b,$w=$$.resultMatrix.d;var $T=Math.atan2($w,$g);($I=Math.atan2($E,$u)-Math.atan2($Z,$b)-($T-Math.atan2($$.resultMatrix.c,$$.resultMatrix.a)))>Math.PI?$I-=2*Math.PI:$I<-Math.PI&&($I+=2*Math.PI),$I=$T+($I+this._data.offsetShearY*Math.PI/180)*this.shearMix,$L=Math.sqrt($g*$g+$w*$w),$$.resultMatrix.b=Math.cos($I)*$L,$$.resultMatrix.d=Math.sin($I)*$L}}},$$}(),$Q$=function(){function $$(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $Z($$,"laya.ani.bone.TfConstraintData"),$$}(),$W$=function(){function $$(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$Z($$,"laya.ani.bone.Transform");var $b=$$.prototype;return $b.initData=function($$){null!=$$.x&&(this.x=$$.x),null!=$$.y&&(this.y=$$.y),null!=$$.skX&&(this.skX=$$.skX),null!=$$.skY&&(this.skY=$$.skY),null!=$$.scX&&(this.scX=$$.scX),null!=$$.scY&&(this.scY=$$.scY)},$b.getMatrix=function(){var $$;return($$=this.mMatrix?this.mMatrix:this.mMatrix=new $V$).identity(),$$.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($$,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$$.rotate(this.skX*Math.PI/180),$$.translate(this.x,this.y),$$},$b.skew=function($$,$b,$u){var $Z=Math.sin($u),$E=Math.cos($u),$r=Math.sin($b),$F=Math.cos($b);return $$.setTo($$.a*$F-$$.b*$Z,$$.a*$r+$$.b*$E,$$.c*$F-$$.d*$Z,$$.c*$r+$$.d*$E,$$.tx*$F-$$.ty*$Z,$$.tx*$r+$$.ty*$E),$$},$$}(),$z=function(){function $$(){}return $Z($$,"laya.ani.bone.UVTools"),$$.getRelativeUV=function($$,$b,$u){var $Z=$$[0],$E=$$[2]-$$[0],$r=$$[1],$F=$$[5]-$$[1];$u||($u=[]),$u.length=$b.length;var $x,$g=0;$x=$u.length;var $H=1/$E,$w=1/$F;for($g=0;$g<$x;$g+=2)$u[$g]=($b[$g]-$Z)*$H,$u[$g+1]=($b[$g+1]-$r)*$w;return $u},$$.getAbsoluteUV=function($$,$b,$u){if(0==$$[0]&&0==$$[1]&&1==$$[4]&&1==$$[5])return $u?($T.copyArray($u,$b),$u):$b;var $Z=$$[0],$E=$$[2]-$$[0],$r=$$[1],$F=$$[5]-$$[1];$u||($u=[]),$u.length=$b.length;var $x,$g=0;for($x=$u.length,$g=0;$g<$x;$g+=2)$u[$g]=$b[$g]*$E+$Z,$u[$g+1]=$b[$g+1]*$F+$r;return $u},$$}(),$p=function(){function $$(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $Z($$,"laya.ani.KeyFramesContent"),$$}(),$q=function(){function $w(){}return $Z($w,"laya.ani.math.BezierLerp"),$w.getBezierRate=function($$,$b,$u,$Z,$E){var $r=$w._getBezierParamKey($b,$u,$Z,$E),$F=100*$r+$$;if($w._bezierResultCache[$F])return $w._bezierResultCache[$F];var $x,$g=$w._getBezierPoints($b,$u,$Z,$E,$r),$H=0;for($x=$g.length,$H=0;$H<$x;$H+=2)if($$<=$g[$H])return $w._bezierResultCache[$F]=$g[$H+1],$g[$H+1];return $w._bezierResultCache[$F]=1},$w._getBezierParamKey=function($$,$b,$u,$Z){return 100*(100*(100*(100*$$+$b)+$u)+$Z)},$w._getBezierPoints=function($$,$b,$u,$Z,$E){return $w._bezierPointsCache[$E]?$w._bezierPointsCache[$E]:($r=[0,0,$$,$b,$u,$Z,1,1],$F=(new $x).getBezierPoints($r,100,3),$w._bezierPointsCache[$E]=$F);var $r,$F},$w._bezierResultCache={},$w._bezierPointsCache={},$w}(),$a=function($$){function $b(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$b.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$Z($b,"laya.ani.AnimationPlayer",$E);var $u=$b.prototype;return $E$.imps($u,{"laya.resource.IDestroy":!0}),$u._onTempletLoadedComputeFullKeyframeIndices=function($$,$b,$u){this._templet===$u&&this._cachePlayRate===$$&&this._cacheFrameRate===$b&&this._computeFullKeyframeIndices()},$u._computeFullKeyframeIndices=function(){for(var $$=this._fullFrames=[],$b=this._templet,$u=this._cacheFrameRateInterval*this._cachePlayRate,$Z=0,$E=$b.getAnimationCount();$Z<$E;$Z++){for(var $r=[],$F=0,$x=$b.getAnimation($Z).nodes.length;$F<$x;$F++){for(var $g=$b.getAnimation($Z).nodes[$F],$H=Math.floor($g.playTime/$u+.01),$w=new Uint16Array($H+1),$I=-1,$o=0,$N=$g.keyFrame.length;$o<$N;$o++){var $D=$g.keyFrame[$o],$e=$D.startTime,$L=$e+$D.duration+$u;do{for(var $T=Math.floor($e/$u+.5),$_=$I+1;$_<$T;$_++)$w[$_]=$o;$w[$I=$T]=$o,$e+=$u}while($e<=$L)}$r.push($w)}$$.push($r)}},$u._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$u._calculatePlayDuration=function(){if(0!==this.state){var $$=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$$),this._playEnd>$$&&(this._playEnd=$$),this._playDuration=this._playEnd-this._playStart}},$u._setPlayParams=function($$,$b){this._currentTime=$$,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$b},$u._setPlayParamsWhenStop=function($$,$b){this._currentTime=$$,this._currentKeyframeIndex=Math.max(Math.floor($$/$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$b,this._currentAnimationClipIndex=-1},$u._update=function($$){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $b=this._cacheFrameRateInterval*this._cachePlayRate,$u=0;this._startUpdateLoopCount!==$D.loopCount&&($u=$$*this.playbackRate,this._elapsedPlaybackTime+=$u);var $Z=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$Z)return this._setPlayParamsWhenStop($Z,$b),void this.event("stopped");if($u+=this._currentTime,0<$Z)if($Z<=$u)do{if($u-=$Z,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($Z,$b),this._stopWhenCircleFinish=!1,void this.event("stopped");$u<$Z&&(this._setPlayParams($u,$b),this.event("complete"))}while($Z<=$u);else this._setPlayParams($u,$b);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($Z,$b),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$u._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$u.play=function($$,$b,$u,$Z,$E){if(void 0===$$&&($$=0),void 0===$b&&($b=1),void 0===$u&&($u=2147483647),void 0===$Z&&($Z=0),void 0===$E&&($E=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($u<0||$Z<0||$E<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$E&&$E<$Z)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$b,this._overallDuration=$u,this._playStart=$Z,this._playEnd=$E,this._paused=!1,this._currentAnimationClipIndex=$$,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$D.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$u.playByFrame=function($$,$b,$u,$Z,$E,$r){void 0===$$&&($$=0),void 0===$b&&($b=1),void 0===$u&&($u=2147483647),void 0===$Z&&($Z=0),void 0===$E&&($E=0),void 0===$r&&($r=30);var $F=1e3/$r;this.play($$,$b,$u,$Z*$F,$E*$F)},$u.stop=function($$){void 0===$$&&($$=!0),$$?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$r(0,$u,"playEnd",function(){return this._playEnd}),$r(0,$u,"templet",function(){return this._templet},function($$){0===!this.state&&this.stop(!0),this._templet!==$$&&((this._templet=$$).loaded?this._computeFullKeyframeIndices():$$.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$r(0,$u,"playStart",function(){return this._playStart}),$r(0,$u,"playDuration",function(){return this._playDuration}),$r(0,$u,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$r(0,$u,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$r(0,$u,"overallDuration",function(){return this._overallDuration}),$r(0,$u,"currentFrameTime",function(){return this._currentFrameTime}),$r(0,$u,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$r(0,$u,"currentPlayTime",function(){return this._currentTime+this._playStart}),$r(0,$u,"cachePlayRate",function(){return this._cachePlayRate},function($$){this._cachePlayRate!==$$&&(this._cachePlayRate=$$,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$$,this._cacheFrameRate])))}),$r(0,$u,"cacheFrameRate",function(){return this._cacheFrameRate},function($$){this._cacheFrameRate!==$$&&(this._cacheFrameRate=$$,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$$])))}),$r(0,$u,"currentTime",null,function($$){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($$<this._playStart||$$>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$D.loopCount;var $b=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$$,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$b),0),this._currentFrameTime=this._currentKeyframeIndex*$b}}),$r(0,$u,"paused",function(){return this._paused},function($$){(this._paused=$$)&&this.event("paused")}),$r(0,$u,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$r(0,$u,"destroyed",function(){return this._destroyed}),$b}(),$Y=function($$){function $b(){$b.__super.call(this),$L.isConchNode&&(this.drawSkin=function($$){$$.transform||($$.transform=$V$.EMPTY),this._addCmd([$$]),this.setSkinMesh&&this.setSkinMesh($$._ps,$$.mVBData,$$.mEleNum,0,$$.mTexture,$$.transform)})}return $Z($b,"laya.ani.GraphicsAni",$F),$b.prototype.drawSkin=function($$){var $b=[$$];this._saveToCmd($L._context._drawSkin,$b)},$b.create=function(){return $b._caches.pop()||new $b},$b.recycle=function($$){$$.clear(),$b._caches.push($$)},$b._caches=[],$b}(),$k=function($$){function $_(){this._aniMap={},this.unfixedLastAniIndex=-1,$_.__super.call(this),this._anis=new Array}$Z($_,"laya.ani.AnimationTemplet",$w);var $b=$_.prototype;return $b.parse=function($$){var $b=new $O$($$);this._aniVersion=$b.readUTFString(),$y.parse(this,$b)},$b._calculateKeyFrame=function($$,$b,$u){var $Z=$$.keyFrame;$Z[$b]=$Z[0];for(var $E=0;$E<$b;$E++){var $r=$Z[$E];$r.nextData=0===$r.duration?$r.data:$Z[$E+1].data}$Z.length--},$b.onAsynLoaded=function($$,$b,$u){var $Z=new $O$($b);switch(this._aniVersion=$Z.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$S.parse(this,$Z);break;default:$y.parse(this,$Z)}this._endLoaded()},$b.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$b.getAnimationCount=function(){return this._anis.length},$b.getAnimation=function($$){return this._anis[$$]},$b.getAniDuration=function($$){return this._anis[$$].playTime},$b.getNodes=function($$){return this._anis[$$].nodes},$b.getNodeIndexWithName=function($$,$b){return this._anis[$$].bone3DMap[$b]},$b.getNodeCount=function($$){return this._anis[$$].nodes.length},$b.getTotalkeyframesLength=function($$){return this._anis[$$].totalKeyframeDatasLength},$b.getPublicExtData=function(){return this._publicExtData},$b.getAnimationDataWithCache=function($$,$b,$u,$Z){var $E=$b[$u];if($E){var $r=$E[$$];return $r?$r[$Z]:null}return null},$b.setAnimationDataWithCache=function($$,$b,$u,$Z,$E){var $r=$b[$u]||($b[$u]={});($r[$$]||($r[$$]=[]))[$Z]=$E},$b.getOriginalData=function($$,$b,$u,$Z,$E){for(var $r=this._anis[$$].nodes,$F=0,$x=0,$g=$r.length,$H=0;$x<$g;$x++){var $w,$I=$r[$x];$w=$I.keyFrame[$u[$x][$Z]],$I.dataOffset=$H;var $o=$E-$w.startTime,$N=$I.lerpType;if($N)switch($N){case 0:case 1:for($F=0;$F<$I.keyframeWidth;)$F+=$I.interpolationMethod[$F]($I,$F,$b,$H+$F,$w.data,$o,null,$w.duration,$w.nextData);break;case 2:var $D=$w.interpolationData,$e=$D.length,$L=0;for($F=0;$F<$e;){var $T=$D[$F];switch($T){case 6:case 7:$F+=$_.interpolation[$T]($I,$L,$b,$H+$L,$w.data,$o,null,$w.duration,$w.nextData,$D,$F+1);break;default:$F+=$_.interpolation[$T]($I,$L,$b,$H+$L,$w.data,$o,null,$w.duration,$w.nextData)}$L++}}else for($F=0;$F<$I.keyframeWidth;)$F+=$I.interpolationMethod[$F]($I,$F,$b,$H+$F,$w.data,$o,null,$w.duration,$w.nextData);$H+=$I.keyframeWidth}},$b.getNodesCurrentFrameIndex=function($$,$b){var $u=this._anis[$$].nodes;$$!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($u.length),this.unfixedCurrentTimes=new Float32Array($u.length),this.unfixedLastAniIndex=$$);for(var $Z=0,$E=$u.length;$Z<$E;$Z++){var $r=$u[$Z];for($b<this.unfixedCurrentTimes[$Z]&&(this.unfixedCurrentFrameIndexes[$Z]=0),this.unfixedCurrentTimes[$Z]=$b;this.unfixedCurrentFrameIndexes[$Z]<$r.keyFrame.length&&!($r.keyFrame[this.unfixedCurrentFrameIndexes[$Z]].startTime>this.unfixedCurrentTimes[$Z]);)this.unfixedCurrentFrameIndexes[$Z]++;this.unfixedCurrentFrameIndexes[$Z]--}return this.unfixedCurrentFrameIndexes},$b.getOriginalDataUnfixedRate=function($$,$b,$u){var $Z=this._anis[$$].nodes;$$!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($Z.length),this.unfixedCurrentTimes=new Float32Array($Z.length),this.unfixedKeyframes=$e($Z.length),this.unfixedLastAniIndex=$$);for(var $E=0,$r=0,$F=$Z.length,$x=0;$r<$F;$r++){var $g=$Z[$r];for($u<this.unfixedCurrentTimes[$r]&&(this.unfixedCurrentFrameIndexes[$r]=0),this.unfixedCurrentTimes[$r]=$u;this.unfixedCurrentFrameIndexes[$r]<$g.keyFrame.length&&!($g.keyFrame[this.unfixedCurrentFrameIndexes[$r]].startTime>this.unfixedCurrentTimes[$r]);)this.unfixedKeyframes[$r]=$g.keyFrame[this.unfixedCurrentFrameIndexes[$r]],this.unfixedCurrentFrameIndexes[$r]++;var $H=this.unfixedKeyframes[$r];$g.dataOffset=$x;var $w=$u-$H.startTime;if($g.lerpType)switch($g.lerpType){case 0:case 1:for($E=0;$E<$g.keyframeWidth;)$E+=$g.interpolationMethod[$E]($g,$E,$b,$x+$E,$H.data,$w,null,$H.duration,$H.nextData);break;case 2:var $I=$H.interpolationData,$o=$I.length,$N=0;for($E=0;$E<$o;){var $D=$I[$E];switch($D){case 6:case 7:$E+=$_.interpolation[$D]($g,$N,$b,$x+$N,$H.data,$w,null,$H.duration,$H.nextData,$I,$E+1);break;default:$E+=$_.interpolation[$D]($g,$N,$b,$x+$N,$H.data,$w,null,$H.duration,$H.nextData)}$N++}}else for($E=0;$E<$g.keyframeWidth;)$E+=$g.interpolationMethod[$E]($g,$E,$b,$x+$E,$H.data,$w,null,$H.duration,$H.nextData);$x+=$g.keyframeWidth}},$_._LinearInterpolation_0=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){var $w=0===$x?0:$r/$x;return $u[$Z]=(1-$w)*$E[$b]+$w*$g[$b],1},$_._QuaternionInterpolation_1=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){var $w=0===$x?0:$r/$x;return $o.slerpQuaternionArray($E,$b,$g,$b,$w,$u,$Z),4},$_._AngleInterpolation_2=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){return 0},$_._RadiansInterpolation_3=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){return 0},$_._Matrix4x4Interpolation_4=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){for(var $w=0;$w<16;$w++,$b++)$u[$Z+$w]=$E[$b]+$r*$F[$b];return 16},$_._NoInterpolation_5=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H){return $u[$Z]=$E[$b],1},$_._BezierInterpolation_6=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w){return void 0===$w&&($w=0),$u[$Z]=$E[$b]+($g[$b]-$E[$b])*$q.getBezierRate($r/$x,$H[$w],$H[$w+1],$H[$w+2],$H[$w+3]),5},$_._BezierInterpolation_7=function($$,$b,$u,$Z,$E,$r,$F,$x,$g,$H,$w){return void 0===$w&&($w=0),$u[$Z]=$H[$w+4]+$H[$w+5]*$q.getBezierRate((.001*$r+$H[$w+6])/$H[$w+7],$H[$w],$H[$w+1],$H[$w+2],$H[$w+3]),9},$_.load=function($$){return $E$.loader.create($$,null,null,$_)},$_.interpolation=[$_._LinearInterpolation_0,$_._QuaternionInterpolation_1,$_._AngleInterpolation_2,$_._RadiansInterpolation_3,$_._Matrix4x4Interpolation_4,$_._NoInterpolation_5,$_._BezierInterpolation_6,$_._BezierInterpolation_7],$_}(),$t=function($b){function $u($$,$b){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$u.__super.call(this),void 0===$b&&($b=0),$$&&this.init($$,$b)}$Z($u,"laya.ani.bone.Skeleton",$b);var $$=$u.prototype;return $$.init=function($$,$b){void 0===$b&&($b=0);var $u,$Z,$E,$r=0,$F=0;if(1==$b)for(this._graphicsCache=[],$r=0,$F=$$.getAnimationCount();$r<$F;$r++)this._graphicsCache.push([]);if(this._yReverseMatrix=$$.yReverseMatrix,this._aniMode=$b,this._templet=$$,this._player=new $a,this._player.cacheFrameRate=$$.rate,this._player.templet=$$,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$$.mBoneArr,this._rootBone=$$.mRootBone,this._aniSectionDic=$$.aniSectionDic,0<$$.ikArr.length)for(this._ikArr=[],$r=0,$F=$$.ikArr.length;$r<$F;$r++)this._ikArr.push(new $_($$.ikArr[$r],this._boneList));if(0<$$.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$r=0,$F=$$.pathArr.length;$r<$F;$r++)$u=$$.pathArr[$r],$Z=new $P($u,this._boneList),($E=this._boneSlotDic[$u.name])&&(($Z=new $P($u,this._boneList)).target=$E),this._pathDic[$u.name]=$Z;if(0<$$.tfArr.length)for(this._tfArr=[],$r=0,$F=$$.tfArr.length;$r<$F;$r++)this._tfArr.push(new $i($$.tfArr[$r],this._boneList));if(0<$$.skinDataArray.length){var $x=this._templet.skinDataArray[this._skinIndex];this._skinName=$x.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$$.load=function($$,$b,$u){},$$._onLoaded=function(){},$$._parseComplete=function(){var $$=$C.TEMPLET_DICTIONARY[this._aniPath];$$&&(this.init($$,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$$._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$$._onPlay=function(){this.event("played")},$$._onStop=function(){var $$,$b=this._templet.eventAniArr[this._aniClipIndex];if($b&&this._eventIndex<$b.length)for(;this._eventIndex<$b.length;this._eventIndex++)($$=$b[this._eventIndex]).time>=this._player.playStart&&$$.time<=this._player.playEnd&&this.event("label",$$);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$$._onPause=function(){this.event("paused")},$$._parseSrcBoneMatrix=function(){var $$=0,$b=0;for($b=this._templet.srcBoneMatrixArr.length,$$=0;$$<$b;$$++)this._boneMatrixArray.push(new $V$);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $u,$Z,$E=this._templet.boneSlotArray;for($$=0,$b=$E.length;$$<$b;$$++)$u=$E[$$],null==($Z=this._bindBoneBoneSlotDic[$u.parent])&&(this._bindBoneBoneSlotDic[$u.parent]=$Z=[]),this._boneSlotDic[$u.name]=$u=$u.copy(),$Z.push($u),this._boneSlotArray.push($u)}},$$._emitMissedEvents=function($$,$b,$u){void 0===$u&&($u=0);var $Z=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($Z){var $E,$r,$F=0;for($E=$Z.length,$F=$u;$F<$E;$F++)($r=$Z[$F]).time>=this._player.playStart&&$r.time<=this._player.playEnd&&this.event("label",$r)}},$$._update=function($$){if(void 0===$$&&($$=!0),!(this._pause||$$&&this._indexControl)){var $b=this.timer.currTimer,$u=this._player.currentKeyframeIndex,$Z=$b-this._lastTime;if($$?this._player._update($Z):$u=-1,this._lastTime=$b,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$Z&&this._clipIndex==$u&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $E;this._lastUpdateAniClipIndex=this._aniClipIndex,$u>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $r,$F=this._templet.eventAniArr[this._aniClipIndex];if($F&&this._eventIndex<$F.length&&(($E=$F[this._eventIndex]).time>=this._player.playStart&&$E.time<=this._player.playEnd?this._player.currentPlayTime>=$E.time&&(this.event("label",$E),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($r=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$r&&(this.graphics=$r));var $x=0,$g=0;for($g=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$g-1)&&0<$g;)$g--;if($g<this._clipIndex)for($x=$g;$x<this._clipIndex;$x++)this._createGraphics($x)}else if(1==this._aniMode){if($r=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$r&&(this.graphics=$r));for($g=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$g-1)&&0<$g;)$g--;if($g<this._clipIndex)for($x=$g;$x<this._clipIndex;$x++)this._createGraphics($x)}this._createGraphics()}}},$$._createGraphics=function($$){void 0===$$&&($$=-1),-1==$$&&($$=this._clipIndex);var $b,$u,$Z=$$*this._player.cacheFrameRateInterval,$E=this._templet.drawOrderAniArr[this._aniClipIndex];if($E&&0<$E.length)for(this._drawOrderIndex=0,$b=$E[this._drawOrderIndex];$Z>=$b.time&&(this._drawOrder=$b.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$E.length));)$b=$E[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$Y.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$Y.create(),$u=this.graphics;var $r=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$$,$Z);var $F,$x,$g,$H,$w=this._aniSectionDic[this._aniClipIndex],$I=0,$o=0,$N=0,$D=0,$e=0,$L=this._templet.srcBoneMatrixArr.length;for($e=$w[$o=0];$o<$L;$o++)$H=this._boneList[$o],$g=this._templet.srcBoneMatrixArr[$o],$H.resultTransform.scX=$g.scX*this._curOriginalData[$I++],$H.resultTransform.skX=$g.skX+this._curOriginalData[$I++],$H.resultTransform.skY=$g.skY+this._curOriginalData[$I++],$H.resultTransform.scY=$g.scY*this._curOriginalData[$I++],$H.resultTransform.x=$g.x+this._curOriginalData[$I++],$H.resultTransform.y=$g.y+this._curOriginalData[$I++],8===this._templet.tMatrixDataLen&&($H.resultTransform.skewX=$g.skewX+this._curOriginalData[$I++],$H.resultTransform.skewY=$g.skewY+this._curOriginalData[$I++]);var $T,$_={},$y={};for($e+=$w[1];$o<$e;$o++)$_[($T=$r[$o]).name]=this._curOriginalData[$I++],$y[$T.name]=this._curOriginalData[$I++],this._curOriginalData[$I++],this._curOriginalData[$I++],this._curOriginalData[$I++],this._curOriginalData[$I++];var $S,$P,$i={},$z={};for($e+=$w[2];$o<$e;$o++)$i[($T=$r[$o]).name]=this._curOriginalData[$I++],$z[$T.name]=this._curOriginalData[$I++],this._curOriginalData[$I++],this._curOriginalData[$I++],this._curOriginalData[$I++],this._curOriginalData[$I++];if(this._pathDic)for($e+=$w[3];$o<$e;$o++){if($T=$r[$o],$S=this._pathDic[$T.name])switch(new $O$($T.extenData).getByte()){case 1:$S.position=this._curOriginalData[$I++];break;case 2:$S.spacing=this._curOriginalData[$I++];break;case 3:$S.rotateMix=this._curOriginalData[$I++],$S.translateMix=this._curOriginalData[$I++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($V$.TEMP.identity()),this._ikArr)for($o=0,$e=this._ikArr.length;$o<$e;$o++)$P=this._ikArr[$o],$i.hasOwnProperty($P.name)&&($P.bendDirection=$i[$P.name]),$z.hasOwnProperty($P.name)&&($P.mix=$z[$P.name]),$P.apply();if(this._pathDic)for(var $q in this._pathDic)($S=this._pathDic[$q]).apply(this._boneList,$u);if(this._tfArr)for($o=0,$D=this._tfArr.length;$o<$D;$o++)this._tfArr[$o].apply();for($o=0,$D=this._boneList.length;$o<$D;$o++)if($H=this._boneList[$o],$x=this._bindBoneBoneSlotDic[$H.name],$H.resultMatrix.copyTo(this._boneMatrixArray[$o]),$x)for($N=0,$e=$x.length;$N<$e;$N++)($F=$x[$N])&&$F.setParentMatrix($H.resultMatrix);var $a,$t,$C,$K,$O={},$V=this._templet.deformAniArr;if($V&&0<$V.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$o=0,$e=this._boneSlotArray.length;$o<$e;$o++)($F=this._boneSlotArray[$o]).deformData=null;var $v,$p=$V[this._aniClipIndex];for($v in $a=$p.default,this._setDeform($a,$O,this._boneSlotArray,$Z),$p)"default"!=$v&&$v!=this._skinName&&($a=$p[$v],this._setDeform($a,$O,this._boneSlotArray,$Z));$a=$p[this._skinName],this._setDeform($a,$O,this._boneSlotArray,$Z)}if(this._drawOrder)for($o=0,$e=this._drawOrder.length;$o<$e;$o++)$t=$_[($F=this._boneSlotArray[this._drawOrder[$o]]).name],$C=$y[$F.name],isNaN($C)||($u.save(),$u.alpha($C)),isNaN($t)||-2==$t||(this._templet.attachmentNames?$F.showDisplayByName(this._templet.attachmentNames[$t]):$F.showDisplayByIndex($t)),$O[this._drawOrder[$o]]?($K=$O[this._drawOrder[$o]],$F.currDisplayData&&$K[$F.currDisplayData.attachmentName]?$F.deformData=$K[$F.currDisplayData.attachmentName]:$F.deformData=null):$F.deformData=null,isNaN($C)?$F.draw($u,this._boneMatrixArray,2==this._aniMode):$F.draw($u,this._boneMatrixArray,2==this._aniMode,$C),isNaN($C)||$u.restore();else for($o=0,$e=this._boneSlotArray.length;$o<$e;$o++)$t=$_[($F=this._boneSlotArray[$o]).name],$C=$y[$F.name],isNaN($C)||($u.save(),$u.alpha($C)),isNaN($t)||-2==$t||(this._templet.attachmentNames?$F.showDisplayByName(this._templet.attachmentNames[$t]):$F.showDisplayByIndex($t)),$O[$o]?($K=$O[$o],$F.currDisplayData&&$K[$F.currDisplayData.attachmentName]?$F.deformData=$K[$F.currDisplayData.attachmentName]:$F.deformData=null):$F.deformData=null,isNaN($C)?$F.draw($u,this._boneMatrixArray,2==this._aniMode):$F.draw($u,this._boneMatrixArray,2==this._aniMode,$C),isNaN($C)||$u.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$$,$u):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$$,$u)},$$._setDeform=function($$,$b,$u,$Z){if($$){var $E,$r,$F,$x=0,$g=0,$H=0;if($$)for($x=0,$g=$$.deformSlotDataList.length;$x<$g;$x++)for($E=$$.deformSlotDataList[$x],$H=0;$H<$E.deformSlotDisplayList.length;$H++)$F=$u[($r=$E.deformSlotDisplayList[$H]).slotIndex],$r.apply($Z,$F),$b[$r.slotIndex]||($b[$r.slotIndex]={}),$b[$r.slotIndex][$r.attachment]=$r.deformData}},$$.getAnimNum=function(){return this._templet.getAnimationCount()},$$.getAniNameByIndex=function($$){return this._templet.getAniNameByIndex($$)},$$.getSlotByName=function($$){return this._boneSlotDic[$$]},$$.showSkinByName=function($$,$b){void 0===$b&&($b=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($$),$b)},$$.showSkinByIndex=function($$,$b){void 0===$b&&($b=!0);for(var $u=0;$u<this._boneSlotArray.length;$u++)this._boneSlotArray[$u].showSlotData(null,$b);if(this._templet.showSkinByIndex(this._boneSlotDic,$$,$b)){var $Z=this._templet.skinDataArray[$$];this._skinIndex=$$,this._skinName=$Z.name}this._clearCache()},$$.showSlotSkinByIndex=function($$,$b){if(0!=this._aniMode){var $u=this.getSlotByName($$);$u&&$u.showDisplayByIndex($b),this._clearCache()}},$$.showSlotSkinByName=function($$,$b){if(0!=this._aniMode){var $u=this.getSlotByName($$);$u&&$u.showDisplayByName($b),this._clearCache()}},$$.replaceSlotSkinName=function($$,$b,$u){if(0!=this._aniMode){var $Z=this.getSlotByName($$);$Z&&$Z.replaceDisplayByName($b,$u),this._clearCache()}},$$.replaceSlotSkinByIndex=function($$,$b,$u){if(0!=this._aniMode){var $Z=this.getSlotByName($$);$Z&&$Z.replaceDisplayByIndex($b,$u),this._clearCache()}},$$.setSlotSkin=function($$,$b){if(0!=this._aniMode){var $u=this.getSlotByName($$);$u&&$u.replaceSkin($b),this._clearCache()}},$$._clearCache=function(){if(1==this._aniMode)for(var $$=0,$b=this._graphicsCache.length;$$<$b;$$++){for(var $u=0,$Z=this._graphicsCache[$$].length;$u<$Z;$u++){var $E=this._graphicsCache[$$][$u];$E!=this.graphics&&$Y.recycle($E)}this._graphicsCache[$$].length=0}},$$.play=function($$,$b,$u,$Z,$E,$r){void 0===$u&&($u=!0),void 0===$Z&&($Z=0),void 0===$E&&($E=0),void 0===$r&&($r=!0),this._indexControl=!1;var $F=-1,$x=NaN;if($x=$b?2147483647:0,"string"==typeof $$)for(var $g=0,$H=this._templet.getAnimationCount();$g<$H;$g++){var $w=this._templet.getAnimation($g);if($w&&$$==$w.name){$F=$g;break}}else $F=$$;-1<$F&&$F<this.getAnimNum()&&(this._aniClipIndex=$F,($u||this._pause||this._currAniIndex!=$F)&&(this._currAniIndex=$F,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($F)),this._drawOrder=null,this._eventIndex=0,this._player.play($F,this._player.playbackRate,$x,$Z,$E),$r&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$I.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$$.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$$.playbackRate=function($$){this._player&&(this._player.playbackRate=$$)},$$.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$$.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$I.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$$._getGrahicsDataWithCache=function($$,$b){return this._graphicsCache[$$][$b]},$$._setGrahicsDataWithCache=function($$,$b,$u){this._graphicsCache[$$][$b]=$u},$$.destroy=function($$){void 0===$$&&($$=!0),$b.prototype.destroy.call(this,$$),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$r(0,$$,"url",function(){return this._aniPath},function($$){this.load($$)}),$r(0,$$,"index",function(){return this._index},function($$){this.player&&(this._index=$$,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$r(0,$$,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$r(0,$$,"templet",function(){return this._templet}),$r(0,$$,"player",function(){return this._player}),$u.useSimpleMeshInCanvas=!1,$u}($r$),$C=function($b){function $E(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$E.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$Z($E,"laya.ani.bone.Templet",$b);var $$=$E.prototype;return $$.getLoadList=function(){return this._loadList},$$.loadAni=function($$){this._skBufferUrl=$$,$E$.loader.load($$,$g.create(this,this.onComplete),null,"arraybuffer")},$$.onComplete=function($$){if(this._isDestroyed)this.destroy();else{var $b=$H.getRes(this._skBufferUrl);$b?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$b)):this.event("error","load failed:"+this._skBufferUrl)}},$$.parseData=function($$,$b,$u){void 0===$u&&($u=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$$,this._mainTexture&&$L.isWebGL&&$$.bitmap&&($$.bitmap.enableMerageInAtlas=!1),this._rate=$u,this.parse($b)},$$.buildArmature=function($$){return void 0===$$&&($$=0),new $t(this,$$)},$$.parse=function($$){$b.prototype.parse.call(this,$$),this._endLoaded(),this._aniVersion!=$E.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$E.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$$._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $$=0;this._loadList=[];var $b,$u=new $O$(this.getPublicExtData()),$Z=0,$E=0,$r=0,$F=$u.getInt32(),$x=$u.readUTFString(),$g=$x.split("\n");for($$=0;$$<$F;$$++)$b=this._path+$g[2*$$],$x=$g[2*$$+1],$u.getFloat32(),$u.getFloat32(),$Z=$u.getFloat32(),$E=$u.getFloat32(),$r=$u.getFloat32(),isNaN($r)?0:$r,$r=$u.getFloat32(),isNaN($r)?0:$r,$r=$u.getFloat32(),isNaN($r)?$Z:$r,$r=$u.getFloat32(),isNaN($r)?$E:$r,-1==this._loadList.indexOf($b)&&this._loadList.push($b);this.event("inited",this)}},$$._textureComplete=function(){for(var $$,$b,$u=0,$Z=this._loadList.length;$u<$Z;$u++)$b=this._loadList[$u],$$=this._textureDic[$b]=$H.getRes($b),$L.isWebGL&&$$&&$$.bitmap&&($$.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$$._parsePublicExtData=function(){var $$=0,$b=0,$u=0,$Z=0,$E=0;for($$=0,$E=this.getAnimationCount();$$<$E;$$++)this._graphicsCache.push([]);var $r;$r="Dragon"!=this._aniClassName;var $F,$x,$g=new $O$(this.getPublicExtData()),$H=0,$w=0,$I=0,$o=0,$N=0,$D=0,$e=0,$L=0,$T=0,$_=$g.getInt32(),$y=$g.readUTFString(),$S=$y.split("\n");for($$=0;$$<$_;$$++){if($F=this._mainTexture,$x=this._path+$S[2*$$],$y=$S[2*$$+1],null==this._mainTexture&&($F=this._textureDic[$x]),!$F)return this.event("error",this),void(this.isParseFail=!0);$H=$g.getFloat32(),$w=$g.getFloat32(),$I=$g.getFloat32(),$o=$g.getFloat32(),$T=$g.getFloat32(),$N=isNaN($T)?0:$T,$T=$g.getFloat32(),$D=isNaN($T)?0:$T,$T=$g.getFloat32(),$e=isNaN($T)?$I:$T,$T=$g.getFloat32(),$L=isNaN($T)?$o:$T,this.subTextureDic[$y]=$v$.create($F,$H,$w,$I,$o,-$N,-$D,$e,$L),$F.alphaTexture&&(this.subTextureDic[$y].alphaTexture=$v$.create($F.alphaTexture,$H,$w,$I,$o,-$N,-$D,$e,$L))}this._mainTexture=$F;var $P,$i,$z,$q,$a,$t=$g.getUint16();for($$=0;$$<$t;$$++)($P=[]).push($g.getUint16()),$P.push($g.getUint16()),$P.push($g.getUint16()),$P.push($g.getUint16()),this.aniSectionDic[$$]=$P;var $C,$K=$g.getInt16(),$O={};for($$=0;$$<$K;$$++)$i=new $p$,0==$$?$C=$i:$i.root=$C,$i.d=$r?-1:1,$q=$g.readUTFString(),$a=$g.readUTFString(),$i.length=$g.getFloat32(),1==$g.getByte()&&($i.inheritRotation=!1),1==$g.getByte()&&($i.inheritScale=!1),$i.name=$q,$a&&(($z=$O[$a])?$z.addChild($i):this.mRootBone=$i),$O[$q]=$i,this.mBoneArr.push($i);this.tMatrixDataLen=$g.getUint16();var $V,$v,$p=$g.getUint16(),$Y=Math.floor($p/this.tMatrixDataLen),$k=this.srcBoneMatrixArr;for($$=0;$$<$Y;$$++)($V=new $W$).scX=$g.getFloat32(),$V.skX=$g.getFloat32(),$V.skY=$g.getFloat32(),$V.scY=$g.getFloat32(),$V.x=$g.getFloat32(),$V.y=$g.getFloat32(),8===this.tMatrixDataLen&&($V.skewX=$g.getFloat32(),$V.skewY=$g.getFloat32()),$k.push($V),($i=this.mBoneArr[$$]).transform=$V;var $M,$l=$g.getUint16(),$X=0;for($$=0;$$<$l;$$++){for($v=new $m$,$X=$g.getUint16(),$b=0;$b<$X;$b++)$v.boneNames.push($g.readUTFString()),$v.boneIndexs.push($g.getInt16());$v.name=$g.readUTFString(),$v.targetBoneName=$g.readUTFString(),$v.targetBoneIndex=$g.getInt16(),$v.bendDirection=$g.getFloat32(),$v.mix=$g.getFloat32(),$v.isSpine=$r,this.ikArr.push($v)}var $s,$m=$g.getUint16(),$n=0;for($$=0;$$<$m;$$++){for($M=new $Q$,$n=$g.getUint16(),$b=0;$b<$n;$b++)$M.boneIndexs.push($g.getInt16());$M.name=$g.getUTFString(),$M.targetIndex=$g.getInt16(),$M.rotateMix=$g.getFloat32(),$M.translateMix=$g.getFloat32(),$M.scaleMix=$g.getFloat32(),$M.shearMix=$g.getFloat32(),$M.offsetRotation=$g.getFloat32(),$M.offsetX=$g.getFloat32(),$M.offsetY=$g.getFloat32(),$M.offsetScaleX=$g.getFloat32(),$M.offsetScaleY=$g.getFloat32(),$M.offsetShearY=$g.getFloat32(),this.tfArr.push($M)}var $c=$g.getUint16(),$J=0;for($$=0;$$<$c;$$++){for(($s=new $n$).name=$g.readUTFString(),$J=$g.getUint16(),$b=0;$b<$J;$b++)$s.bones.push($g.getInt16());$s.target=$g.readUTFString(),$s.positionMode=$g.readUTFString(),$s.spacingMode=$g.readUTFString(),$s.rotateMode=$g.readUTFString(),$s.offsetRotation=$g.getFloat32(),$s.position=$g.getFloat32(),$s.spacing=$g.getFloat32(),$s.rotateMix=$g.getFloat32(),$s.translateMix=$g.getFloat32(),this.pathArr.push($s)}var $f,$Q,$W,$G,$A,$j=0,$h=0,$d=0,$U=NaN,$B=0,$R=$g.getInt16();for($$=0;$$<$R;$$++){var $$$=$g.getUint8(),$b$={};this.deformAniArr.push($b$);for(var $u$=0;$u$<$$$;$u$++)for(($f=new $k$).skinName=$g.getUTFString(),$b$[$f.skinName]=$f,$j=$g.getInt16(),$b=0;$b<$j;$b++)for($Q=new $M$,$f.deformSlotDataList.push($Q),$h=$g.getInt16(),$u=0;$u<$h;$u++)for($W=new $l$,$Q.deformSlotDisplayList.push($W),$W.slotIndex=$g.getInt16(),$W.attachment=$g.getUTFString(),$d=$g.getInt16(),$Z=0;$Z<$d;$Z++)for(1==$g.getByte()?$W.tweenKeyList.push(!0):$W.tweenKeyList.push(!1),$U=$g.getFloat32(),$W.timeList.push($U),$G=[],$W.vectices.push($G),$B=$g.getInt16(),$E=0;$E<$B;$E++)$G.push($g.getFloat32())}var $Z$,$E$,$r$=$g.getInt16(),$F$=0,$x$=0;for($$=0;$$<$r$;$$++){for($F$=$g.getInt16(),$A=[],$b=0;$b<$F$;$b++){for(($Z$=new $X$).time=$g.getFloat32(),$x$=$g.getInt16(),$u=0;$u<$x$;$u++)$Z$.drawOrder.push($g.getInt16());$A.push($Z$)}this.drawOrderAniArr.push($A)}var $g$,$H$=$g.getInt16(),$w$=0;for($$=0;$$<$H$;$$++){for($w$=$g.getInt16(),$E$=[],$b=0;$b<$w$;$b++)($g$=new $s$).name=$g.getUTFString(),$g$.intValue=$g.getInt32(),$g$.floatValue=$g.getFloat32(),$g$.stringValue=$g.getUTFString(),$g$.time=$g.getFloat32(),$E$.push($g$);this.eventAniArr.push($E$)}var $I$=$g.getInt16();if(0<$I$)for(this.attachmentNames=[],$$=0;$$<$I$;$$++)this.attachmentNames.push($g.getUTFString());var $o$,$N$,$D$=$g.getInt16();for($$=0;$$<$D$;$$++)($o$=new $Y$).name=$g.readUTFString(),$o$.parent=$g.readUTFString(),$o$.attachmentName=$g.readUTFString(),$o$.srcDisplayIndex=$o$.displayIndex=$g.getInt16(),($o$.templet=this).boneSlotDic[$o$.name]=$o$,null==($N$=this.bindBoneBoneSlotDic[$o$.parent])&&(this.bindBoneBoneSlotDic[$o$.parent]=$N$=[]),$N$.push($o$),this.boneSlotArray.push($o$);var $e$,$L$,$T$,$_$=$g.readUTFString().split("\n"),$y$=0,$S$=$g.getUint8(),$P$=0,$i$=0,$z$=0,$q$=0,$a$=0,$t$=0,$C$=0;for($$=0;$$<$S$;$$++){for(($e$=new $c$).name=$_$[$y$++],$P$=$g.getUint8(),$b=0;$b<$P$;$b++){for(($L$=new $f$).name=$_$[$y$++],$o$=this.boneSlotDic[$L$.name],$i$=$g.getUint8(),$u=0;$u<$i$;$u++){if($T$=new $J$,this.skinSlotDisplayDataArr.push($T$),$T$.name=$_$[$y$++],$T$.attachmentName=$_$[$y$++],$T$.transform=new $W$,$T$.transform.scX=$g.getFloat32(),$T$.transform.skX=$g.getFloat32(),$T$.transform.skY=$g.getFloat32(),$T$.transform.scY=$g.getFloat32(),$T$.transform.x=$g.getFloat32(),$T$.transform.y=$g.getFloat32(),$L$.displayArr.push($T$),$T$.width=$g.getFloat32(),$T$.height=$g.getFloat32(),$T$.type=$g.getUint8(),$T$.verLen=$g.getUint16(),0<($K=$g.getUint16()))for($T$.bones=[],$Z=0;$Z<$K;$Z++){var $K$=$g.getUint16();$T$.bones.push($K$)}if(0<($z$=$g.getUint16()))for($T$.uvs=[],$Z=0;$Z<$z$;$Z++)$T$.uvs.push($g.getFloat32());if(0<($q$=$g.getUint16()))for($T$.weights=[],$Z=0;$Z<$q$;$Z++)$T$.weights.push($g.getFloat32());if(0<($a$=$g.getUint16()))for($T$.triangles=[],$Z=0;$Z<$a$;$Z++)$T$.triangles.push($g.getUint16());if(0<($t$=$g.getUint16()))for($T$.vertices=[],$Z=0;$Z<$t$;$Z++)$T$.vertices.push($g.getFloat32());if(0<($C$=$g.getUint16()))for($T$.lengths=[],$Z=0;$Z<$C$;$Z++)$T$.lengths.push($g.getFloat32())}$e$.slotArr.push($L$)}this.skinDic[$e$.name]=$e$,this.skinDataArray.push($e$)}1==$g.getUint8()?(this.yReverseMatrix=new $V$(1,0,0,-1,0,0),$C&&$C.setTempMatrix(this.yReverseMatrix)):$C&&$C.setTempMatrix(new $V$),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$$.getTexture=function($$){var $b=this.subTextureDic[$$];return $b||($b=this.subTextureDic[$$.substr(0,$$.length-1)]),null==$b?this._mainTexture:$b},$$.showSkinByIndex=function($$,$b,$u){if(void 0===$u&&($u=!0),$b<0&&$b>=this.skinDataArray.length)return!1;var $Z,$E,$r=0,$F=0,$x=this.skinDataArray[$b];if($x){for($r=0,$F=$x.slotArr.length;$r<$F;$r++)($E=$x.slotArr[$r])&&($Z=$$[$E.name])&&($Z.showSlotData($E,$u),$u&&"undefined"!=$Z.attachmentName&&"null"!=$Z.attachmentName?$Z.showDisplayByName($Z.attachmentName):$Z.showDisplayByIndex($Z.displayIndex));return!0}return!1},$$.getSkinIndexByName=function($$){for(var $b=0,$u=this.skinDataArray.length;$b<$u;$b++)if(this.skinDataArray[$b].name==$$)return $b;return-1},$$.getGrahicsDataWithCache=function($$,$b){return this._graphicsCache[$$][$b]},$$.setGrahicsDataWithCache=function($$,$b,$u){this._graphicsCache[$$][$b]=$u},$$.destroy=function(){var $$;for(var $b in this._isDestroyed=!0,this.subTextureDic)($$=this.subTextureDic[$b])&&$$.destroy();for($b in this._textureDic)($$=this._textureDic[$b])&&$$.destroy();for(var $u=0,$Z=this.skinSlotDisplayDataArr.length;$u<$Z;$u++)this.skinSlotDisplayDataArr[$u].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $E.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$$.getAniNameByIndex=function($$){var $b=this.getAnimation($$);return $b?$b.name:null},$r(0,$$,"rate",function(){return this._rate},function($$){this._rate=$$}),$E.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$E.TEMPLET_DICTIONARY=null,$E}($k)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($$,$b){"use strict";for(var $u in Object.defineProperty($b,"__esModule",{value:!0}),Laya){var $Z=Laya[$u];$Z&&$Z.__isclass&&($b[$u]=$Z)}});