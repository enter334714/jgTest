var _=wx.y$;import"../utils/PjMiniGameSdk_wx";var config={game_id:256,game_pkg:_[30308],partner_label:_[30309],partner_id:_[30310],game_ver:_[30311],is_auth:!1,partner_config:{appId:_[30312],channel:_[30313],appVersion:_[30314],platformType:"wx"}};window.config=config;var p$LUKNB=p$LKBNU();var HOST=_[30315];var p$LUKBN=null;var p$LKNBU=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;var sdk=window.pjsdk;function p$LKBNU(){var t={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0,console.log(_[30316]);var o=this;var n;n=wx.getStorageSync(_[30317])?0:(n=o.uuid(16,32),wx.setStorageSync(_[30317],n),1),wx.getStorageSync(_[30318])||(t=o.uuid(16,32),wx.setStorageSync(_[30318],t));var t=wx.getLaunchOptionsSync();var a=t.scene||"";n&&t.query&&t.query.ad_code&&wx.setStorageSync(_[30319],t.query.ad_code),o.log(_[282],{install:n,scene:a}),o=t.query&&t.query.invite?t.query.invite:"",t=t.query&&t.query.invite_type?t.query.invite_type:"",o&&(p$LKNBU={invite:o,invite_type:t,is_new:n,scene:a}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(_[30320]),t[_[30321]]=typeof r==_[29936]?r:null;var n=this;sdk.initSdk(config.partner_config.appId,config.partner_config.channel,config.partner_config.appVersion,config.partner_config.platformType),sdk.login(function(e){var r,o;1==e.code?(r=e.data.userInfo.uid,o=e.data.userInfo.token,console.log(_[30322]+r),console.log(_[30323]+o),n.do_login({uid:r,token:o}),console.log(_[30324]+JSON.stringify(e.data))):console.log(_[30325],e)})},do_login:function(e){var o=this;var r=o.getPublicData();if(r[_[30326]]=JSON.stringify(e),p$LKNBU&&typeof p$LKNBU==_[277])for(var n in p$LKNBU)r[n]=p$LKNBU[n];wx.request({url:_[26267]+HOST+_[30327],method:_[30328],dataType:_[6065],header:{"content-type":_[30329]},data:r,success:function(e){if(console.log(_[30330]+JSON.stringify(e)),200==e.statusCode){if((e=e.data).state){try{wx.setStorageSync(_[30331],e.data.sdk_token),wx.setStorageSync(_[30332],e.data.user_id),wx.setStorageSync(_[30333],e.data.username),e.data.ext&&wx.setStorageSync(_[30334],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};sdk.initFloat(Laya.stage),t[_[30321]]&&t[_[30321]](0,r)}else t[_[30321]]&&t[_[30321]](1,{errMsg:e.msg});o.getShareInfo(_[30335],function(e){console.log(_[30336]),o.logStartShare(_[30335]),wx.onShareAppMessage(function(){return o.logStartShare(_[30335]),{title:e.title,imageUrl:e.img,query:e.query}})})}else t[_[30321]]&&t[_[30321]](1,{errMsg:_[30337]})}})},share:function(e){t[_[30338]]=typeof callback==_[29936]?callback:null;var r=e.type||_[30338];console.log(_[30339]+r);var o=this;this.getShareInfo(r,function(e){o.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(_[30331]);wx.request({url:_[26267]+HOST+_[30340],method:_[30328],dataType:_[6065],header:{"content-type":_[30329]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:p$LUKBN?p$LUKBN.server_id:"",role_id:p$LUKBN?p$LUKBN.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,o){console.log(_[30341]),wx.getStorageSync(_[30331]),wx.request({url:_[26267]+HOST+_[30342],method:_[30328],dataType:_[6065],header:{"content-type":_[30329]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(_[30343]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?o&&o(r.data):o&&o({develop:0})}})},getShareInfo:function(e,r){console.log(_[30344]);var o=wx.getStorageSync(_[30331]);wx.request({url:_[26267]+HOST+_[30345],method:_[30328],dataType:_[6065],header:{"content-type":_[30329]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:o,type:e,server_id:p$LUKBN?p$LUKBN.server_id:"",role_id:p$LUKBN?p$LUKBN.role_id:"",no_log:1},success:function(e){console.log(_[30346]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):t[_[30338]]&&t[_[30338]](1,{errMsg:_[30347]+e.msg}):t[_[30338]]&&t[_[30338]](1,{errMsg:_[30348]})}})},updateShare:function(e,r,o,n,t,a){console.log(_[30349]);var i=wx.getStorageSync(_[30331]);wx.request({url:_[26267]+HOST+_[30350],method:_[30328],dataType:_[6065],header:{"content-type":_[30329]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:o,role_id:n,sever_id:t,scene:a},success:function(e){console.log(_[30351]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(_[30352]+e);let o={data:{}};sdk.msgSecCheck(e,function(e){1==e.code?(console.log(_[30353]+e.msg),o.statusCode=200,o.data.state=1):(o.statusCode=200,o.data.state=0),r&&r(o)})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(_[30354]+JSON.stringify(e));var o=this;t[_[30355]]=typeof r==_[29936]?r:null,r=wx.getStorageSync(_[30331]);var n=wx.getStorageSync(_[30334]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:n,platform:platform},o.order_data=e,(r=o.getPublicData())[_[30357]]=JSON.stringify(e),wx.request({url:_[26267]+HOST+_[30358],method:_[30328],dataType:_[6065],header:{"content-type":_[30329]},data:r,success:function(e){console.log(_[30359]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?""==e.data.ext?sdk.pay(e.data.pay_data):o.extDo({ext1:e.data.ext,ext2:e.data.pay_data}):t[_[30355]]&&t[_[30355]](1,{errMsg:e.msg}):t[_[30321]]&&t[_[30321]](1,{errMsg:_[30337]})}})):t[_[30355]]&&t[_[30355]](1,{errMsg:_[30356]})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:_[30360]+e.ext2.cp_order_id+_[30361]+e.ext2.amount/100,extraData:{},envVersion:_[30362],success(e){}})},logCreateRole:function(e){var r=wx.getStorageSync(_[30332]);var o=wx.getStorageSync(_[30333]);var n={};n[_[30363]]=r,n[_[30364]]=o,n[_[11136]]=e.roleid,n[_[30365]]=e.rolelevel,n[_[30366]]=e.rolename,n[_[11813]]=e.serverid,e.roleid&&e.serverid&&(p$LUKBN={role_id:e.roleid,server_id:e.serverid}),this.log(_[6],n),r={roleid:e.roleid,roleName:e.rolename,roleLever:e.rolelevel,roleMoney:"0",serverid:e.serverid,servername:e.servername,roleType:"1"},sdk.reportRoleinfo(r)},logEnterGame:function(e){var r=wx.getStorageSync(_[30332]);var o=wx.getStorageSync(_[30333]);var n={};n[_[30363]]=r,n[_[30364]]=o,n[_[11136]]=e.roleid,n[_[30365]]=e.rolelevel,n[_[30366]]=e.rolename,n[_[11813]]=e.serverid,e.roleid&&e.serverid&&(p$LUKBN={role_id:e.roleid,server_id:e.serverid}),this.log(_[5947],n),p$LKNBU&&this.updateShare(p$LKNBU.invite,p$LKNBU.invite_type,p$LKNBU.is_new,e.roleid,e.serverid,p$LKNBU.scene),r={roleid:e.roleid,roleName:e.rolename,roleLever:e.rolelevel,roleMoney:"0",serverid:e.serverid,servername:e.servername,roleType:"2"},sdk.reportRoleinfo(r)},logRoleUpLevel:function(e){var r=wx.getStorageSync(_[30332]);var o=wx.getStorageSync(_[30333]);var n={};n[_[30363]]=r,n[_[30364]]=o,n[_[11136]]=e.roleid,n[_[30365]]=e.rolelevel,n[_[30366]]=e.rolename,n[_[11813]]=e.serverid,e.roleid&&e.serverid&&(p$LUKBN={role_id:e.roleid,server_id:e.serverid}),this.log(_[30367],n),r={roleid:e.roleid,roleName:e.rolename,roleLever:e.rolelevel,roleMoney:"0",serverid:e.serverid,servername:e.servername,roleType:"3"},sdk.reportRoleinfo(r)},uuid:function(e,r){var o=_[30368].split("");var n,t=[];var a;if(e=e||o.length,r)for(n=0;n<r;n++)t[n]=o[0|Math.random()*e];else for(t[8]=t[13]=t[18]=t[23]="-",t[14]="4",n=0;n<36;n++)t[n]||(a=0|16*Math.random(),t[n]=o[19==n?3&a|8:a]);return t.join("")},getPublicData:function(){var e=wx.getStorageSync(_[30317]);var r=wx.getStorageSync(_[30318]);var o=wx.getStorageSync(_[30319]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:o,uuid:e,idfv:r,mac:_[30369],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":_[30370],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==_[30371]?1:2}},log:function(e,r){var o=this.getPublicData();for(var n in r)o[n]=r[n];console.log(_[30372]+e),console.log(o),wx.request({url:_[26267]+HOST+_[30373]+e+_[30374]+encodeURIComponent(JSON.stringify(o))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){sdk.openZd()},sendUrl:function(){sdk.openZd()},setMessageToFriendQuery:function(e,r){e=e.activity_id,r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))},setLoadingCmp:function(){sdk.setLoadingCmp()},sendCode:function(e,r){console.log(_[30375],e.phone),sdk.lwSendVCode({phone:e.phone,success:function(e){1==e.code?r&&r(0,e):r&&r(1,e)},fail:function(e){r&&r(1,e)}})},bindPhone:function(e,r){console.log(_[30376],e.phone,e.code),sdk.toBindPhone({phone:e.phone,code:e.code,success:function(e){1==e.code?r&&r(0,e):r&&r(1,e)},fail:function(e){r&&r(1,e)}})},subscribeMessage:function(e,r){console.log(_[30377]+e),t[_[30378]]=typeof r==_[29936]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(_[30379]),console.log(e),t[_[30378]]&&t[_[30378]](e)},fail(e){console.log(_[30380]),console.log(e),t[_[30378]]&&t[_[30378]](e)}})}}}function run(e,r,o){e in p$LUKNB&&p$LUKNB[e](r,o)}exports.init=function(e,r){run(_[363],e,r)},exports.login=function(e){run(_[30321],"",e)},exports.login=function(e){run(_[30321],"",e)},exports.pay=function(e,r){run(_[30355],e,r)},exports.openService=function(){run(_[24342])},exports.logCreateRole=function(e,r,o,n,t){run(_[30381],{serverid:e,servername:r,roleid:o,rolename:n,rolelevel:t})},exports.logEnterGame=function(e,r,o,n,t){run(_[30382],{serverid:e,servername:r,roleid:o,rolename:n,rolelevel:t})},exports.logRoleUpLevel=function(e,r,o,n,t){run(_[30383],{serverid:e,servername:r,roleid:o,rolename:n,rolelevel:t})},exports.share=function(e){run(_[30338],{type:e})},exports.msgCheck=function(e,r){run(_[12518],e,r)},exports.downloadClient=function(){run(_[30384])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(_[30385])},exports.weiduanHelper=function(){run(_[24232])},exports.sendUrl=function(){run(_[30386])},exports.setMessageToFriendQuery=function(e,r){run(_[30387],e,r)},exports.setLoadingCmp=function(){run(_[30388])},exports.sendCode=function(e,r){run(_[30389],e,r)},exports.bindPhone=function(e,r){run(_[11943],e,r)},exports.subscribeMessage=function(e,r){run(_[30378],e,r)};