var Laya=window.Laya=function(D$Z,D$s){var D$h={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(D$s,D$r){return 1==arguments.length?D$h.__presubstr.call(this,D$s):D$h.__presubstr.call(this,D$s,0<D$r?D$r:this.length+D$r)},__init:function(D$s){D$s.forEach(function(D$s){D$s.__init$&&D$s.__init$()})},__isClass:function(D$s){return D$s&&(D$s.__isclass||D$s==Object||D$s==String||D$s==Array)},__newvec:function(D$s,D$r){var D$e=[];D$e.length=D$s;for(var D$U=0;D$U<D$s;D$U++)D$e[D$U]=D$r;return D$e},__extend:function(D$s,D$r){for(var D$e in D$r)if(D$r.hasOwnProperty(D$e)){var D$U=Object.getOwnPropertyDescriptor(D$r,D$e),D$m=D$U.get,D$k=D$U.set;D$m||D$k?D$m&&D$k?Object.defineProperty(D$s,D$e,D$U):(D$m&&Object.defineProperty(D$s,D$e,D$m),D$k&&Object.defineProperty(D$s,D$e,D$k)):D$s[D$e]=D$r[D$e]}function D$j(){D$h.un(this,"constructor",D$s)}D$j.prototype=D$r.prototype,D$s.prototype=new D$j,D$h.un(D$s.prototype,"__imps",D$h.__copy({},D$r.prototype.__imps))},__copy:function(D$s,D$r){if(!D$r)return null;for(var D$e in D$s=D$s||{},D$r)D$s[D$e]=D$r[D$e];return D$s},__package:function(D$s,D$r){if(!D$h.__packages[D$s]){D$h.__packages[D$s]=!0;var D$e=D$Z,D$U=D$s.split(".");if(1<D$U.length)for(var D$m=0,D$k=D$U.length-1;D$m<D$k;D$m++){var D$j=D$e[D$U[D$m]];D$e=D$j||(D$e[D$U[D$m]]={})}D$e[D$U[D$U.length-1]]||(D$e[D$U[D$U.length-1]]=D$r||{})}},__hasOwnProperty:function(D$s,D$r){return D$r=D$r||this,Object.hasOwnProperty.call(D$r,D$s)||function D$s(D$r,D$e){if(Object.hasOwnProperty.call(D$e.prototype,D$r))return!0;var D$U=D$e.prototype.__super;return null==D$U?null:D$s(D$r,D$U)}(D$s,D$r.__class)},__typeof:function(D$s,D$r){if(!D$s||!D$r)return!1;if(D$r===String)return"string"==typeof D$s;if(D$r===Number)return"number"==typeof D$s;if(D$r.__interface__)D$r=D$r.__interface__;else if("string"!=typeof D$r)return D$s instanceof D$r;return D$s.__imps&&D$s.__imps[D$r]||D$s.__class==D$r},__as:function(D$s,D$r){return this.__typeof(D$s,D$r)?D$s:null},__int:function(D$s){return D$s?parseInt(D$s):0},interface:function(D$s,D$r){D$h.__package(D$s,{});var D$e=D$h.__internals,D$U=D$e[D$s]=D$e[D$s]||{self:D$s};if(D$r){var D$m=D$r.split(",");D$U.extend=[];for(var D$k=0;D$k<D$m.length;D$k++){var D$j=D$m[D$k];D$e[D$j]=D$e[D$j]||{self:D$j},D$U.extend.push(D$e[D$j])}}var D$T=D$Z,D$Y=D$s.split(".");for(D$k=0;D$k<D$Y.length-1;D$k++)D$T=D$T[D$Y[D$k]];D$T[D$Y[D$Y.length-1]]={__interface__:D$s}},class:function(D$s,D$r,D$e,D$U){if(D$e&&D$h.__extend(D$s,D$e),D$r)if(D$h.__package(D$r,D$s),D$h.__classmap[D$r]=D$s,0<D$r.indexOf(".")){if(0==D$r.indexOf("laya.")){var D$m=D$r.split(".");D$U=D$U||D$m[D$m.length-1],D$h[D$U]&&console.log("Warning!,this class["+D$U+"] already exist:",D$h[D$U]),D$h[D$U]=D$s}}else"Main"==D$r?D$Z.Main=D$s:"MainWX"==D$r?D$Z.MainWX=D$s:(D$h[D$r]&&console.log("Error!,this class["+D$r+"] already exist:",D$h[D$r]),D$h[D$r]=D$s);var D$k=D$h.un,D$j=D$s.prototype;D$k(D$j,"hasOwnProperty",D$h.__hasOwnProperty),D$k(D$j,"__class",D$s),D$k(D$j,"__super",D$e),D$k(D$j,"__className",D$r),D$k(D$s,"__super",D$e),D$k(D$s,"__className",D$r),D$k(D$s,"__isclass",!0),D$k(D$s,"super",function(D$s){this.__super.call(D$s)})},imps:function(D$s,D$r){if(!D$r)return null;var D$m=D$s.__imps||D$h.un(D$s,"__imps",{});function D$k(D$s){var D$r,D$e;if((D$r=D$h.__internals[D$s])&&(D$m[D$s]=!0,D$e=D$r.extend))for(var D$U=0;D$U<D$e.length;D$U++)D$k(D$e[D$U].self)}for(var D$e in D$r)D$k(D$e)},superSet:function(D$s,D$r,D$e,D$U){var D$m=D$s.prototype["_$set_"+D$e];D$m&&D$m.call(D$r,D$U)},superGet:function(D$s,D$r,D$e){var D$U=D$s.prototype["_$get_"+D$e];return D$U?D$U.call(D$r):null},getset:function(D$s,D$r,D$e,D$U,D$m){D$s?(D$U&&(D$r["_$GET_"+D$e]=D$U),D$m&&(D$r["_$SET_"+D$e]=D$m)):(D$U&&D$h.un(D$r,"_$get_"+D$e,D$U),D$m&&D$h.un(D$r,"_$set_"+D$e,D$m)),D$U&&D$m?Object.defineProperty(D$r,D$e,{get:D$U,set:D$m,enumerable:!1,configurable:!0}):(D$U&&Object.defineProperty(D$r,D$e,{get:D$U,enumerable:!1,configurable:!0}),D$m&&Object.defineProperty(D$r,D$e,{set:D$m,enumerable:!1,configurable:!0}))},static:function(D$e,D$U){for(var D$m=0,D$s=D$U.length;D$m<D$s;D$m+=2)if("length"==D$U[D$m])D$e.length=D$U[D$m+1].call(D$e);else{function D$r(){var D$r=D$U[D$m],D$s=D$U[D$m+1];Object.defineProperty(D$e,D$r,{get:function(){return delete this[D$r],this[D$r]=D$s.call(this)},set:function(D$s){delete this[D$r],this[D$r]=D$s},enumerable:!0,configurable:!0})}D$r()}},un:function(D$s,D$r,D$e){return D$e||(D$e=D$s[D$r]),D$h.__propun.value=D$e,Object.defineProperty(D$s,D$r,D$h.__propun),D$e},uns:function(D$r,D$s){D$s.forEach(function(D$s){D$h.un(D$r,D$s)})}};return D$Z.console=D$Z.console||{log:function(){}},D$Z.trace=D$Z.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),D$h}(window,document);!function(D$s,D$r,D$e){D$e.un,D$e.uns,D$e.static,D$e.class,D$e.getset,D$e.__newvec}(window,document,Laya),function(D$j,D$r,D$D){D$D.un,D$D.uns;var D$Y=D$D.static,D$h=D$D.class,D$B=D$D.getset;D$D.__newvec;D$D.interface("laya.runtime.IMarket"),D$D.interface("laya.filters.IFilter"),D$D.interface("laya.display.ILayout"),D$D.interface("laya.resource.IDispose"),D$D.interface("laya.runtime.IPlatform"),D$D.interface("laya.resource.IDestroy"),D$D.interface("laya.runtime.IConchNode"),D$D.interface("laya.filters.IFilterAction"),D$D.interface("laya.runtime.ICPlatformClass"),D$D.interface("laya.resource.ICreateResource"),D$D.interface("laya.runtime.IConchRenderObject"),D$D.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var D$P=function(){function D$k(){}return D$h(D$k,"laya.utils.RunDriver"),D$k.FILTER_ACTIONS=[],D$k.pixelRatio=-1,D$k._charSizeTestDiv=null,D$k.now=function(){return Date.now()},D$k.getWindow=function(){return D$j},D$k.getPixelRatio=function(){if(D$k.pixelRatio<0){var D$s=D$Q.context,D$r=D$s.backingStorePixelRatio||D$s.webkitBackingStorePixelRatio||D$s.mozBackingStorePixelRatio||D$s.msBackingStorePixelRatio||D$s.oBackingStorePixelRatio||D$s.backingStorePixelRatio||1;(D$k.pixelRatio=(D$Q.window.devicePixelRatio||1)/D$r)<1&&(D$k.pixelRatio=1)}return D$k.pixelRatio},D$k.getIncludeStr=function(D$s){return null},D$k.createShaderCondition=function(D$s){var D$r="(function() {return "+D$s+";})";return D$D._runScript(D$r)},D$k.fontMap=[],D$k.measureText=function(D$s,D$r){var D$e=D$k.hanzi.test(D$s);if(D$e&&D$k.fontMap[D$r])return D$k.fontMap[D$r];var D$U=D$Q.context;D$U.font=D$r;var D$m=D$U.measureText(D$s);return D$m||(D$m={width:16,height:16}),D$e&&(D$k.fontMap[D$r]=D$m),D$m},D$k.getWebGLContext=function(D$s){},D$k.beginFlush=function(){},D$k.endFinish=function(){},D$k.addToAtlas=null,D$k.flashFlushImage=function(D$s){},D$k.drawToCanvas=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$os.create("2D"),D$T=new D$E(D$e,D$U,D$j);return D$v.renders[D$r]._fun(D$s,D$T,D$m,D$k),D$j},D$k.createParticleTemplate2D=null,D$k.createGLTextur=null,D$k.createWebGLContext2D=null,D$k.changeWebGLSize=function(D$s,D$r){},D$k.createRenderSprite=function(D$s,D$r){return new D$v(D$s,D$r)},D$k.createFilterAction=function(D$s){return new D$o},D$k.createGraphics=function(){return new D$A},D$k.clear=function(D$s){D$c._context.ctx.clear()},D$k.cancelLoadByUrl=function(D$s){},D$k.clearAtlas=function(D$s){},D$k.isAtlas=function(D$s){return!1},D$k.addTextureToAtlas=function(D$s){},D$k.getTexturePixels=function(D$s,D$r,D$e,D$U,D$m){return null},D$k.skinAniSprite=function(){return null},D$k.update3DLoop=function(){},D$Y(D$k,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),D$k}(),D$U=(D$B(1,D$D,"alertGlobalError",null,function(D$s){var D$k=0;D$Q.window.onerror=D$s?function(D$s,D$r,D$e,D$U,D$m){D$k++<5&&D$m&&alert(D$m.stack||D$m)}:null}),D$D.init=function(D$s,D$r,D$e){for(var D$U=[],D$m=2,D$k=arguments.length;D$m<D$k;D$m++)D$U.push(arguments[D$m]);if(!D$D._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=D$D._arrayBufferSlice),D$D._isinit=!0,D$Q.__init__(),D$S.__init__(),D$A.__init__(),D$D.timer=new D$W,D$D.scaleTimer=new D$W,D$D.loader=new D$Ys,D$_.__init__(),D$m=0;for(var D$j=D$U.length;D$m<D$j;D$m++)D$U[D$m].enable&&D$U[D$m].enable();return D$x.__init__(),D$T.__init__(),D$z.__init__(),D$R.beginCheck(),D$D._currentStage=D$D.stage=new D$Vs,D$D.stage.conchModel&&D$D.stage.conchModel.setRootNode(),D$D._getUrlPath(),D$D.render=new D$c(0,0),D$D.stage.size(D$s,D$r),D$v.__init__(),D$H.__init__(),D$$.instance.__init__(D$D.stage,D$c.canvas),D$ws.__init__(),D$J.autoStopMusic=!0,D$g.__init__(),D$c.canvas}},D$D._getUrlPath=function(){var D$s=D$Q.window.location,D$r=D$s.pathname;D$r=D$r&&":"==D$r.charAt(2)?D$r.substring(1):D$r,D$K.rootPath=D$K.basePath=D$K.getPath("file:"==D$s.protocol?D$r:D$s.protocol+"//"+D$s.host+D$s.pathname)},D$D._arrayBufferSlice=function(D$s,D$r){var D$e=new Uint8Array(this,D$s,D$r-D$s),D$U=new Uint8Array(D$e.length);return D$U.set(D$e),D$U.buffer},D$D._runScript=function(D$s){return D$Q.window[D$D._evcode](D$s)},D$D.stage=null,D$D.timer=null,D$D.scaleTimer=null,D$D.loader=null,D$D.version="1.8.6",D$D.render=null,D$D._currentStage=null,D$D._isinit=!1,D$D.isDebug=!1,D$D.MiniAdpter={init:function(){D$j.navigator&&D$j.navigator.userAgent&&-1<D$j.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},D$Y(D$D,["conchMarket",function(){return this.conchMarket=D$j.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=D$j.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function D$s(){}return D$h(D$s,"Config"),D$s.WebGLTextCacheCount=500,D$s.atlasEnable=!1,D$s.showCanvasMark=!1,D$s.animationInterval=50,D$s.isAntialias=!1,D$s.isAlpha=!1,D$s.premultipliedAlpha=!0,D$s.isStencil=!0,D$s.preserveDrawingBuffer=!1,D$s}()),D$Z=function(){function D$Z(){this._events=null}D$h(D$Z,"laya.events.EventDispatcher");var D$s=D$Z.prototype;return D$s.hasListener=function(D$s){return!!(this._events&&this._events[D$s])},D$s.getListener=function(D$s){return this._events?this._events[D$s]:null},D$s.event=function(D$s,D$r){if(!this._events||!this._events[D$s])return!1;var D$e=this._events[D$s];if(D$e.lock)D$e.queue||(D$e.queue=[]),D$e.queue.push(D$r);else{var D$U;for(D$e.lock=!0,D$e.cursor=D$e.head;D$e.cursor;)(D$U=D$e.cursor).recover?(D$e.head=D$e.tail=D$e.cursor=null,console.error("node is recover："+D$U.id)):(D$e.cursor=D$U.next,D$U.once&&D$Z.delNode(D$e,D$U),D$U.method&&(null!=D$r?D$U.args?D$U.method.apply(D$U.caller,D$U.args.concat(D$r)):D$r instanceof Array?D$U.method.apply(D$U.caller,D$r):D$U.caller?D$U.method.call(D$U.caller,D$r):D$D.recordError("事件派发错误","node.caller:"+D$U.caller+"node.method:"+D$U.method+"data:"+D$r+"node.prev"+D$U.prev):D$U.method.apply(D$U.caller,D$U.args)),D$U.once&&D$Z.recoverHandler(D$U));D$e.lock=!1,!D$e.head&&this._events&&this._events[D$s]==D$e&&delete this._events[D$s],D$e.queue&&D$e.queue.length&&this.event(D$s,D$e.queue.shift())}return!0},D$s.on=function(D$s,D$r,D$e,D$U){return this._createListener(D$s,D$r,D$e,D$U,!1)},D$s.once=function(D$s,D$r,D$e,D$U){return this._createListener(D$s,D$r,D$e,D$U,!0)},D$s._createListener=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$k&&(D$k=!0),D$k&&this.off(D$s,D$r,D$e,D$m);var D$j=D$Z.createHandler(D$r||this,D$e,D$U,D$m);this._events||(this._events={});var D$T=this._events,D$Y=D$T[D$s];return D$Y?D$Y.tail?(D$j.prev=D$Y.tail,D$Y.tail.next=D$j,D$Y.tail=D$j):D$Y.head=D$Y.tail=D$j:D$T[D$s]={head:D$j,tail:D$j,cursor:null,lock:!1},this},D$s.off=function(D$s,D$r,D$e,D$U){if(void 0===D$U&&(D$U=!1),!this._events||!this._events[D$s])return this;for(var D$m=this._events[D$s],D$k=D$m.head;D$k;){if((!D$r||D$k.caller===D$r)&&D$k.method===D$e&&(!D$U||D$k.once)){D$Z.delNode(D$m,D$k),D$m.cursor==D$k&&(D$m.cursor=D$k.next),D$Z.recoverHandler(D$k);break}D$k=D$k.next}return this},D$s.offAll=function(D$s){var D$r=this._events;if(!D$r)return this;if(D$s)this._recoverHandlers(D$r[D$s]),delete D$r[D$s];else{for(var D$e in D$r)this._recoverHandlers(D$r[D$e]);this._events=null}return this},D$s._recoverHandlers=function(D$s){if(D$s){for(var D$r=D$s.head;D$r;){D$Z.delNode(D$s,D$r);var D$e=D$r.next;D$Z.recoverHandler(D$r),D$r=D$e}D$s.cursor=null}},D$s.isMouseEvent=function(D$s){return D$Z.MOUSE_EVENTS[D$s]},D$Z.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},D$Z.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},D$Z.delNode=function(D$s,D$r){D$r.prev?D$r.prev.next=D$r.next:D$s.head=D$r.next,D$r.next?D$r.next.prev=D$r.prev:D$s.tail=D$r.prev},D$Z.createHandler=function(D$s,D$r,D$e,D$U){var D$m=500<D$Z._freeHandler.length?D$Z._freeHandler.shift():null;if(D$m)if(D$m.recover)D$m.recover=!1,D$m.caller=D$s,D$m.method=D$r,D$m.args=D$e,D$m.once=D$U;else{var D$k="";try{arguments.propertyIsEnumerable.caller}catch(D$s){D$k=D$s.stack}var D$j=D$m.caller?(D$m.caller.__proto__&&D$m.caller.__proto__.constructor&&D$m.caller.__proto__.constructor.name)+"|"+D$m.caller.__className+"|"+D$m.caller.name:"",D$T=D$m.method?D$m.method.name:"";D$D.recordError("EventDispatcher重复创建","caller="+D$j+"  method="+D$T+"  stack="+D$k),D$m={id:++D$Z._nodeCount,caller:D$s,method:D$r,args:D$e,once:D$U,recover:!1}}else D$m={id:++D$Z._nodeCount,caller:D$s,method:D$r,args:D$e,once:D$U,recover:!1};return D$m.prev=D$m.next=null,D$m},D$Z.recoverHandler=function(D$s){if(D$s.recover){if(D$Z._errorCount<5){D$Z._errorCount++;var D$r="";try{arguments.propertyIsEnumerable.caller}catch(D$s){D$r=D$s.stack}var D$e=D$s.caller?(D$s.caller.__proto__&&D$s.caller.__proto__.constructor&&D$s.caller.__proto__.constructor.name)+"|"+D$s.caller.__className+"|"+D$s.caller.name:"",D$U=D$s.method?D$s.method.name:"";D$D.recordError("EventDispatcher重复回收","id="+D$s.id+"  caller="+D$e+"  method="+D$U+"  stack="+D$r)}D$s.caller=D$s.method=D$s.args=D$s.prev=null}else D$s.recover=!0,D$s.caller=D$s.method=D$s.args=D$s.prev=D$s.next=null,D$Z._freeHandler&&D$Z._freeHandler.length<3e3&&D$Z._freeHandler.push(D$s)},D$Z._freeHandler=[],D$Z._nodeCount=0,D$Z._errorCount=0,D$Z}(),D$b=function(){function D$m(D$s,D$r,D$e,D$U){this.once=!1,void(this._id=0)===D$U&&(D$U=!1),this.setTo(D$s,D$r,D$e,D$U)}D$h(D$m,"laya.utils.Handler");var D$s=D$m.prototype;return D$s.setTo=function(D$s,D$r,D$e,D$U){return this._id=D$m._gid++,this.caller=D$s,this.method=D$r,this.args=D$e,this.once=D$U,this},D$s.run=function(){if(null==this.method)return null;var D$s=this._id,D$r=this.method.apply(this.caller,this.args);return this._id===D$s&&this.once&&this.recover(),D$r},D$s.runWith=function(D$s){if(null==this.method)return null;var D$r=this._id;if(null==D$s)var D$e=this.method.apply(this.caller,this.args);else D$e=this.args||D$s.unshift?this.args?this.method.apply(this.caller,this.args.concat(D$s)):this.method.apply(this.caller,D$s):this.method.call(this.caller,D$s);return this._id===D$r&&this.once&&this.recover(),D$e},D$s.clear=function(){return this.caller=null,this.method=null,this.args=null,this},D$s.recover=function(){0<this._id&&(this._id=0,this.clear())},D$m.create=function(D$s,D$r,D$e,D$U){return void 0===D$U&&(D$U=!0),new D$m(D$s,D$r,D$e,D$U)},D$m._gid=1,D$m}(),D$f=function(){function D$s(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}D$h(D$s,"laya.display.BitmapFont");var D$r=D$s.prototype;return D$r.loadFont=function(D$s,D$r){this._path=D$s,this._complete=D$r,D$D.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],D$b.create(this,this.onLoaded))},D$r.onLoaded=function(){this.parseFont(D$Ts.getRes(this._path),D$Ts.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},D$r.parseFont=function(D$s,D$r){if(null!=D$s&&null!=D$r){this._texture=D$r;var D$e=D$s.getElementsByTagName("info");if(!D$e[0].getAttributeNode)return this.parseFont2(D$s,D$r);this.fontSize=parseInt(D$e[0].getAttributeNode("size").nodeValue);var D$U,D$m=D$e[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(D$m[0]),parseInt(D$m[1]),parseInt(D$m[2]),parseInt(D$m[3])],D$U=D$s.getElementsByTagName("char");var D$k=0;for(D$k=0;D$k<D$U.length;D$k++){var D$j=D$U[D$k],D$T=parseInt(D$j.getAttributeNode("id").nodeValue),D$Y=parseInt(D$j.getAttributeNode("xoffset").nodeValue)/1,D$Z=parseInt(D$j.getAttributeNode("yoffset").nodeValue)/1,D$h=parseInt(D$j.getAttributeNode("xadvance").nodeValue)/1,D$H=new D$y;D$H.x=parseInt(D$j.getAttributeNode("x").nodeValue),D$H.y=parseInt(D$j.getAttributeNode("y").nodeValue),D$H.width=parseInt(D$j.getAttributeNode("width").nodeValue),D$H.height=parseInt(D$j.getAttributeNode("height").nodeValue);var D$A=D$hs.create(D$r,D$H.x,D$H.y,D$H.width,D$H.height,D$Y,D$Z);this._maxWidth=Math.max(this._maxWidth,D$h+this.letterSpacing),this._fontCharDic[D$T]=D$A,this._fontWidthMap[D$T]=D$h}}},D$r.parseFont2=function(D$s,D$r){if(null!=D$s&&null!=D$r){this._texture=D$r;var D$e=D$s.getElementsByTagName("info");this.fontSize=parseInt(D$e[0].attributes.size.nodeValue);var D$U=D$e[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(D$U[0]),parseInt(D$U[1]),parseInt(D$U[2]),parseInt(D$U[3])];var D$m=D$s.getElementsByTagName("char"),D$k=0;for(D$k=0;D$k<D$m.length;D$k++){var D$j=D$m[D$k].attributes,D$T=parseInt(D$j.id.nodeValue),D$Y=parseInt(D$j.xoffset.nodeValue)/1,D$Z=parseInt(D$j.yoffset.nodeValue)/1,D$h=parseInt(D$j.xadvance.nodeValue)/1,D$H=new D$y;D$H.x=parseInt(D$j.x.nodeValue),D$H.y=parseInt(D$j.y.nodeValue),D$H.width=parseInt(D$j.width.nodeValue),D$H.height=parseInt(D$j.height.nodeValue);var D$A=D$hs.create(D$r,D$H.x,D$H.y,D$H.width,D$H.height,D$Y,D$Z);this._maxWidth=Math.max(this._maxWidth,D$h+this.letterSpacing),this._fontCharDic[D$T]=D$A,this._fontWidthMap[D$T]=D$h}}},D$r.getCharTexture=function(D$s){return this._fontCharDic[D$s.charCodeAt(0)]},D$r.destroy=function(){if(this._texture){for(var D$s in this._fontCharDic){var D$r=this._fontCharDic[D$s];D$r&&D$r.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},D$r.setSpaceWidth=function(D$s){this._spaceWidth=D$s},D$r.getCharWidth=function(D$s){var D$r=D$s.charCodeAt(0);return this._fontWidthMap[D$r]?this._fontWidthMap[D$r]+this.letterSpacing:" "==D$s?this._spaceWidth+this.letterSpacing:0},D$r.getTextWidth=function(D$s){for(var D$r=0,D$e=0,D$U=D$s.length;D$e<D$U;D$e++)D$r+=this.getCharWidth(D$s.charAt(D$e));return D$r},D$r.getMaxWidth=function(){return this._maxWidth},D$r.getMaxHeight=function(){return this.fontSize},D$r.drawText=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j,D$T=this.getTextWidth(D$s),D$Y=0;"center"===D$m&&(D$Y=(D$k-D$T)/2),"right"===D$m&&(D$Y=D$k-D$T);for(var D$Z=0,D$h=0,D$H=D$s.length;D$h<D$H;D$h++)(D$j=this.getCharTexture(D$s.charAt(D$h)))&&(D$r.graphics.drawTexture(D$j,D$e+D$Z+D$Y,D$U),D$Z+=this.getCharWidth(D$s.charAt(D$h)))},D$s}(),D$T=function(){function D$e(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=D$e._TF_EMPTY}D$h(D$e,"laya.display.css.Style");var D$s=D$e.prototype;return D$s.getTransform=function(){return this._tf},D$s.setTransform=function(D$s){this._tf="none"!==D$s&&D$s?D$s:D$e._TF_EMPTY},D$s.setTranslateX=function(D$s){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.translateX=D$s},D$s.setTranslateY=function(D$s){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.translateY=D$s},D$s.setScaleX=function(D$s){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.scaleX=D$s},D$s.setScale=function(D$s,D$r){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.scaleX=D$s,this._tf.scaleY=D$r},D$s.setScaleY=function(D$s){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.scaleY=D$s},D$s.setRotate=function(D$s){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.rotate=D$s},D$s.setSkewX=function(D$s){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.skewX=D$s},D$s.setSkewY=function(D$s){this._tf===D$e._TF_EMPTY&&(this._tf=new D$m),this._tf.skewY=D$s},D$s.destroy=function(){this.scrollRect=null},D$s.render=function(D$s,D$r,D$e,D$U){},D$s.getCSSStyle=function(){return D$rs.EMPTY},D$s._enableLayout=function(){return!1},D$B(0,D$s,"scaleX",function(){return this._tf.scaleX},function(D$s){this.setScaleX(D$s)}),D$B(0,D$s,"transform",function(){return this.getTransform()},function(D$s){this.setTransform(D$s)}),D$B(0,D$s,"translateX",function(){return this._tf.translateX},function(D$s){this.setTranslateX(D$s)}),D$B(0,D$s,"translateY",function(){return this._tf.translateY},function(D$s){this.setTranslateY(D$s)}),D$B(0,D$s,"scaleY",function(){return this._tf.scaleY},function(D$s){this.setScaleY(D$s)}),D$B(0,D$s,"block",function(){return 0!=(1&this._type)}),D$B(0,D$s,"skewY",function(){return this._tf.skewY},function(D$s){this.setSkewY(D$s)}),D$B(0,D$s,"rotate",function(){return this._tf.rotate},function(D$s){this.setRotate(D$s)}),D$B(0,D$s,"skewX",function(){return this._tf.skewX},function(D$s){this.setSkewX(D$s)}),D$B(0,D$s,"paddingLeft",function(){return 0}),D$B(0,D$s,"paddingTop",function(){return 0}),D$B(0,D$s,"absolute",function(){return!0}),D$e.__init__=function(){D$e._TF_EMPTY=new D$m,D$e.EMPTY=new D$e},D$e.EMPTY=null,D$e._TF_EMPTY=null,D$e}(),D$x=function(){function D$r(D$s){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=D$p.create(D$r.defaultColor),this.family=D$r.defaultFamily,this.stroke=D$r._STROKE,this.size=D$r.defaultSize,D$s&&D$s!==D$r.EMPTY&&D$s.copyTo(this)}D$h(D$r,"laya.display.css.Font");var D$s=D$r.prototype;return D$s.set=function(D$s){this._text=null;for(var D$r=D$s.split(" "),D$e=0,D$U=D$r.length;D$e<D$U;D$e++){var D$m=D$r[D$e];switch(D$m){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<D$m.indexOf("px")&&(this.size=parseInt(D$m),this.family=D$r[D$e+1],D$e++)}},D$s.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},D$s.copyTo=function(D$s){D$s._type=this._type,D$s._text=this._text,D$s._weight=this._weight,D$s._color=this._color,D$s.family=this.family,D$s.stroke=this.stroke!=D$r._STROKE?this.stroke.slice():D$r._STROKE,D$s.indent=this.indent,D$s.size=this.size},D$B(0,D$s,"password",function(){return 0!=(1024&this._type)},function(D$s){D$s?this._type|=1024:this._type&=-1025}),D$B(0,D$s,"color",function(){return this._color.strColor},function(D$s){this._color=D$p.create(D$s)}),D$B(0,D$s,"italic",function(){return 0!=(512&this._type)},function(D$s){D$s?this._type|=512:this._type&=-513}),D$B(0,D$s,"bold",function(){return 0!=(2048&this._type)},function(D$s){D$s?this._type|=2048:this._type&=-2049}),D$B(0,D$s,"weight",function(){return""+this._weight},function(D$s){var D$r=0;switch(D$s){case"normal":break;case"bold":this.bold=!0,D$r=700;break;case"bolder":D$r=800;break;case"lighter":D$r=100;break;default:D$r=parseInt(D$s)}this._weight=D$r,this._text=null}),D$B(0,D$s,"decoration",function(){return this._decoration?this._decoration.value:null},function(D$s){var D$r=D$s.split(" ");switch(this._decoration||(this._decoration={}),D$r[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=D$r[0]}D$r[1]&&(this._decoration.color=D$p.create(D$r)),this._decoration.value=D$s}),D$r.__init__=function(){D$r.EMPTY=new D$r(null)},D$r.EMPTY=null,D$r.defaultColor="#000000",D$r.defaultSize=12,D$r.defaultFamily="Arial",D$r.defaultFont="12px Arial",D$r._STROKE=[0,"#000000"],D$r._ITALIC=512,D$r._PASSWORD=1024,D$r._BOLD=2048,D$r}(),D$m=function(){function D$s(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return D$h(D$s,"laya.display.css.TransformInfo"),D$s}(),D$A=function(){function D$H(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,D$c.isConchNode){this._nativeObj=new D$j._conchGraphics,this.id=this._nativeObj.conchID}}D$h(D$H,"laya.display.Graphics");var D$s=D$H.prototype;return D$s.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},D$s.clear=function(D$s){void 0===D$s&&(D$s=!1);var D$r=0,D$e=0;if(D$s){var D$U=this._one;if(this._cmds){for(D$e=this._cmds.length,D$r=0;D$r<D$e;D$r++)!(D$U=this._cmds[D$r])||D$U.callee!==D$c._context._drawTexture&&D$U.callee!==D$c._context._drawTextureWithTransform||(D$U[0]=null,D$H._cache.push(D$U));this._cmds.length=0}else D$U&&(!D$U||D$U.callee!==D$c._context._drawTexture&&D$U.callee!==D$c._context._drawTextureWithTransform||(D$U[0]=null,D$H._cache.push(D$U)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(D$r=0,D$e=this._vectorgraphArray.length;D$r<D$e;D$r++)D$M.getInstance().deleteShape(this._vectorgraphArray[D$r]);this._vectorgraphArray.length=0}},D$s._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},D$s._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new D$e,this._graphicBounds._graphics=this)},D$s._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},D$s._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},D$s.getBounds=function(D$s){return void 0===D$s&&(D$s=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(D$s)},D$s.getBoundPoints=function(D$s){return void 0===D$s&&(D$s=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(D$s)},D$s._addCmd=function(D$s){this._cmds=this._cmds||[],D$s.callee=D$s.shift(),this._cmds.push(D$s)},D$s.setFilters=function(D$s){this._saveToCmd(D$c._context._setFilters,D$s)},D$s.drawTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){if(void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),void 0===D$j&&(D$j=1),!D$s||D$j<.01)return null;D$U||(D$U=D$s.sourceWidth),D$m||(D$m=D$s.sourceHeight),D$j=D$j<0?0:1<D$j?1:D$j;var D$T,D$Y=!D$c.isWebGL&&(D$Q.onFirefox||D$Q.onEdge||D$Q.onIE||D$Q.onSafari)?.5:0,D$Z=D$U/D$s.sourceWidth,D$h=D$m/D$s.sourceHeight;return D$U=D$s.width*D$Z,D$m=D$s.height*D$h,D$s.loaded&&(D$U<=0||D$m<=0)?null:(D$r+=D$s.offsetX*D$Z,D$e+=D$s.offsetY*D$h,this._sp&&(this._sp._renderType|=512),D$r-=D$Y,D$e-=D$Y,D$U+=2*D$Y,D$m+=2*D$Y,D$H._cache.length?((D$T=D$H._cache.pop())[0]=D$s,D$T[1]=D$r,D$T[2]=D$e,D$T[3]=D$U,D$T[4]=D$m,D$T[5]=D$k,D$T[6]=D$j):D$T=[D$s,D$r,D$e,D$U,D$m,D$k,D$j],D$T.callee=D$k||1!=D$j?D$c._context._drawTextureWithTransform:D$c._context._drawTexture,null!=this._one||D$k||1!=D$j?this._saveToCmd(D$T.callee,D$T):(this._one=D$T,this._render=this._renderOneImg),D$s.loaded||D$s.once("loaded",this,this._textureLoaded,[D$s,D$T]),this._repaint(),D$T)},D$s.cleanByTexture=function(D$s,D$r,D$e,D$U,D$m){if(void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),!D$s)return this.clear();if(this._one&&this._render===this._renderOneImg){D$U||(D$U=D$s.sourceWidth),D$m||(D$m=D$s.sourceHeight);var D$k=D$U/D$s.sourceWidth,D$j=D$m/D$s.sourceHeight;D$U=D$s.width*D$k,D$m=D$s.height*D$j,D$r+=D$s.offsetX*D$k,D$e+=D$s.offsetY*D$j,this._one[0]=D$s,this._one[1]=D$r,this._one[2]=D$e,this._one[3]=D$U,this._one[4]=D$m,this._repaint()}else this.clear(),D$s&&this.drawTexture(D$s,D$r,D$e,D$U,D$m)},D$s.drawTextures=function(D$s,D$r){D$s&&this._saveToCmd(D$c._context._drawTextures,[D$s,D$r])},D$s.fillTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){if(void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),void 0===D$k&&(D$k="repeat"),D$s){var D$T=[D$s,D$r,D$e,D$U,D$m,D$k,D$j||D$n.EMPTY,{}];D$s.loaded||D$s.once("loaded",this,this._textureLoaded,[D$s,D$T]),this._saveToCmd(D$c._context._fillTexture,D$T)}},D$s._textureLoaded=function(D$s,D$r){D$r[3]=D$r[3]||D$s.width,D$r[4]=D$r[4]||D$s.height,this._repaint()},D$s.fillCircle=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$e.bitmap.enableMerageInAtlas=!1;var D$T=new Float32Array(2*(D$j+1)),D$Y=new Float32Array(2*(D$j+1)),D$Z=new Uint16Array(3*D$j),D$h=2*Math.PI/D$j,D$H=0;D$T[0]=D$U,D$T[1]=D$m,D$Y[0]=D$U/D$e.width,D$Y[1]=D$m/D$e.height;for(var D$A=2,D$x=0;D$x<D$j;D$x++){var D$B=D$k*Math.cos(D$H)+D$U,D$$=D$k*Math.sin(D$H)+D$m;D$T[D$A]=D$B,D$T[D$A+1]=D$$,D$Y[D$A]=D$B/D$e.width,D$Y[D$A+1]=D$$/D$e.height,D$H+=D$h,D$A+=2}for(D$x=D$A=0;D$x<D$j;D$x++)D$Z[D$A++]=0,D$Z[D$A++]=D$x+1,D$Z[D$A++]=D$j+1<=D$x+2?1:D$x+2;this.drawTriangles(D$e,D$s,D$r,D$T,D$Y,D$Z)},D$s.drawTriangles=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){void 0===D$T&&(D$T=1),this._saveToCmd(D$c._context.drawTriangles,[D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z])},D$s._saveToCmd=function(D$s,D$r){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=D$r,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(D$r)),D$r.callee=D$s,this._repaint(),D$r},D$s.clipRect=function(D$s,D$r,D$e,D$U){this._saveToCmd(D$c._context._clipRect,[D$s,D$r,D$e,D$U])},D$s.fillText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){void 0===D$j&&(D$j=0),this._saveToCmd(D$c._context._fillText,[D$s,D$r,D$e,D$U||D$x.defaultFont,D$m,D$k])},D$s.fillBorderText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){this._saveToCmd(D$c._context._fillBorderText,[D$s,D$r,D$e,D$U||D$x.defaultFont,D$m,D$k,D$j,D$T])},D$s.strokeText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._saveToCmd(D$c._context._strokeText,[D$s,D$r,D$e,D$U||D$x.defaultFont,D$m,D$k,D$j])},D$s.alpha=function(D$s){D$s=D$s<0?0:1<D$s?1:D$s,this._saveToCmd(D$c._context._alpha,[D$s])},D$s.setAlpha=function(D$s){D$s=D$s<0?0:1<D$s?1:D$s,this._saveToCmd(D$c._context._setAlpha,[D$s])},D$s.transform=function(D$s,D$r,D$e){void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),this._saveToCmd(D$c._context._transform,[D$s,D$r,D$e])},D$s.rotate=function(D$s,D$r,D$e){void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),this._saveToCmd(D$c._context._rotate,[D$s,D$r,D$e])},D$s.scale=function(D$s,D$r,D$e,D$U){void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0),this._saveToCmd(D$c._context._scale,[D$s,D$r,D$e,D$U])},D$s.translate=function(D$s,D$r){this._saveToCmd(D$c._context._translate,[D$s,D$r])},D$s.save=function(){this._saveToCmd(D$c._context._save,[])},D$s.restore=function(){this._saveToCmd(D$c._context._restore,[])},D$s.replaceText=function(D$s){this._repaint();var D$r=this._cmds;if(D$r){for(var D$e=D$r.length-1;-1<D$e;D$e--)if(this._isTextCmd(D$r[D$e].callee))return D$r[D$e][0].toUpperCase?D$r[D$e][0]=D$s:D$r[D$e][0].setText(D$s),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=D$s:this._one[0].setText(D$s),!0;return!1},D$s._isTextCmd=function(D$s){return D$s===D$c._context._fillText||D$s===D$c._context._fillBorderText||D$s===D$c._context._strokeText},D$s.replaceTextColor=function(D$s){this._repaint();var D$r=this._cmds;if(D$r)for(var D$e=D$r.length-1;-1<D$e;D$e--)this._isTextCmd(D$r[D$e].callee)&&(D$r[D$e][4]=D$s,D$r[D$e][0].toUpperCase||(D$r[D$e][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=D$s,this._one[0].toUpperCase||(this._one[0].changed=!0))},D$s.loadImage=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=this;void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0);var D$T=D$Ts.getRes(D$s);function D$Y(D$s){D$s&&(D$j.drawTexture(D$s,D$r,D$e,D$U,D$m),null!=D$k&&D$k.call(D$j._sp,D$s))}D$T?D$Y(D$T):D$D.loader.load(D$s,D$b.create(null,D$Y),null,"image")},D$s._renderEmpty=function(D$s,D$r,D$e,D$U){},D$s._renderAll=function(D$s,D$r,D$e,D$U){for(var D$m,D$k=this._cmds,D$j=0,D$T=D$k.length;D$j<D$T;D$j++)(D$m=D$k[D$j]).callee.call(D$r,D$e,D$U,D$m)},D$s._renderOne=function(D$s,D$r,D$e,D$U){this._one.callee.call(D$r,D$e,D$U,this._one)},D$s._renderOneImg=function(D$s,D$r,D$e,D$U){this._one.callee.call(D$r,D$e,D$U,this._one),2305!==D$s._renderType&&(D$s._renderType|=1)},D$s.drawLine=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$k&&(D$k=1);var D$j=0;D$c.isWebGL&&(D$j=D$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(D$j));var D$T=D$k%2==0?0:.5,D$Y=[D$s+D$T,D$r+D$T,D$e+D$T,D$U+D$T,D$m,D$k,D$j];this._saveToCmd(D$c._context._drawLine,D$Y)},D$s.drawLines=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=1);var D$k=0;if(D$e&&!(D$e.length<4)){D$c.isWebGL&&(D$k=D$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(D$k));var D$j=D$m%2==0?0:.5,D$T=[D$s+D$j,D$r+D$j,D$e,D$U,D$m,D$k];this._saveToCmd(D$c._context._drawLines,D$T)}},D$s.drawCurves=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=1);var D$k=[D$s,D$r,D$e,D$U,D$m];this._saveToCmd(D$c._context._drawCurves,D$k)},D$s.drawRect=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){void 0===D$j&&(D$j=1);var D$T=D$k?D$j/2:0,D$Y=D$k?D$j:0,D$Z=[D$s+D$T,D$r+D$T,D$e-D$Y,D$U-D$Y,D$m,D$k,D$j];this._saveToCmd(D$c._context._drawRect,D$Z)},D$s.drawCircle=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$k&&(D$k=1);var D$j=D$m?D$k/2:0,D$T=0;D$c.isWebGL&&(D$T=D$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(D$T));var D$Y=[D$s,D$r,D$e-D$j,D$U,D$m,D$k,D$T];this._saveToCmd(D$c._context._drawCircle,D$Y)},D$s.drawPie=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){void 0===D$T&&(D$T=1);var D$Y=D$j?D$T/2:0,D$Z=D$j?D$T:0,D$h=0;D$c.isWebGL&&(D$h=D$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(D$h));var D$H=[D$s+D$Y,D$r+D$Y,D$e-D$Z,D$U,D$m,D$k,D$j,D$T,D$h];D$H[3]=D$u.toRadian(D$U),D$H[4]=D$u.toRadian(D$m),this._saveToCmd(D$c._context._drawPie,D$H)},D$s.drawPoly=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$k&&(D$k=1);var D$j=0,D$T=!1;D$c.isWebGL&&(D$j=D$M.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(D$j),D$T=!(6<D$e.length));var D$Y=D$m?D$k%2==0?0:.5:0,D$Z=[D$s+D$Y,D$r+D$Y,D$e,D$U,D$m,D$k,D$j,D$T];this._saveToCmd(D$c._context._drawPoly,D$Z)},D$s.drawPath=function(D$s,D$r,D$e,D$U,D$m){var D$k=[D$s,D$r,D$e,D$U,D$m];this._saveToCmd(D$c._context._drawPath,D$k)},D$B(0,D$s,"cmds",function(){return this._cmds},function(D$s){this._sp&&(this._sp._renderType|=512),this._cmds=D$s,this._render=this._renderAll,this._repaint()}),D$H.__init__=function(){if(D$c.isConchNode){for(var D$s=laya.display.Graphics.prototype,D$r=D$Q.window.ConchGraphics.prototype,D$e=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],D$U=0,D$m=D$e.length;D$U<=D$m;D$U++){var D$k=D$e[D$U];D$s[D$k]=D$r[D$k]}D$s._saveToCmd=null,D$r.drawImageS&&(D$s.drawTextures=function(D$s,D$r){if(D$s&&D$s.loaded&&D$s.bitmap&&D$s.source){var D$e=D$s.uv,D$U=D$s.bitmap.width,D$m=D$s.bitmap.height;this.drawImageS(D$s.bitmap.source,D$e[0]*D$U,D$e[1]*D$m,(D$e[2]-D$e[0])*D$U,(D$e[5]-D$e[3])*D$m,D$s.offsetX,D$s.offsetY,D$s.width,D$s.height,D$r)}}),D$s.drawTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){if(void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),void 0===D$j&&(D$j=1),D$s)if(D$s.loaded){if(D$s.loaded&&D$s.bitmap&&D$s.source&&(D$U||(D$U=D$s.sourceWidth),D$m||(D$m=D$s.sourceHeight),D$j=D$j<0?0:1<D$j?1:D$j,D$U=D$U-D$s.sourceWidth+D$s.width,D$m=D$m-D$s.sourceHeight+D$s.height,!(D$U<=0||D$m<=0))){D$r+=D$s.offsetX,D$e+=D$s.offsetY;var D$T=D$s.uv,D$Y=D$s.bitmap.width,D$Z=D$s.bitmap.height;D$T[4]<D$T[0]&&D$T[5]<D$T[1]?this.drawImageM(D$s.bitmap.source,D$T[4]*D$Y,D$T[5]*D$Z,(D$T[0]-D$T[4])*D$Y,(D$T[1]-D$T[5])*D$Z,D$r,D$e,D$U,D$m,D$k,D$j):this.drawImageM(D$s.bitmap.source,D$T[0]*D$Y,D$T[1]*D$Z,(D$T[2]-D$T[0])*D$Y,(D$T[5]-D$T[3])*D$Z,D$r,D$e,D$U,D$m,D$k,D$j),this._repaint()}}else D$s.once("loaded",this,function(){this.drawTexture(D$s,D$r,D$e,D$U,D$m,D$k)})},D$s.fillTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){if(void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),void 0===D$k&&(D$k="repeat"),D$s&&D$s.loaded){var D$T,D$Y=D$c._context.ctx,D$Z=D$s.bitmap.width,D$h=D$s.bitmap.height,D$H=D$s.uv;D$T=D$s.uv!=D$hs.DEF_UV?D$Y.createPattern(D$s.bitmap.source,D$k,D$H[0]*D$Z,D$H[1]*D$h,(D$H[2]-D$H[0])*D$Z,(D$H[5]-D$H[3])*D$h):D$Y.createPattern(D$s.bitmap.source,D$k);var D$A=0,D$x=0;D$j&&(D$r+=D$j.x%D$s.width,D$e+=D$j.y%D$s.height,D$A-=D$j.x%D$s.width,D$x-=D$j.y%D$s.height),this._fillImage(D$T,D$r,D$e,D$A,D$x,D$U,D$m)}}}},D$H._cache=[],D$H}(),D$e=function(){function D$o(){this._cacheBoundsType=!1}D$h(D$o,"laya.display.GraphicsBounds");var D$s=D$o.prototype;return D$s.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},D$s.reset=function(){this._temp&&(this._temp.length=0)},D$s.getBounds=function(D$s){return void 0===D$s&&(D$s=!1),(!this._bounds||!this._temp||this._temp.length<1||D$s!=this._cacheBoundsType)&&(this._bounds=D$y._getWrapRec(this.getBoundPoints(D$s),this._bounds)),this._cacheBoundsType=D$s,this._bounds},D$s.getBoundPoints=function(D$s){return void 0===D$s&&(D$s=!1),(!this._temp||this._temp.length<1||D$s!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(D$s)),this._cacheBoundsType=D$s,this._rstBoundPoints=D$u.copyArray(this._rstBoundPoints,this._temp)},D$s._getCmdPoints=function(D$s){void 0===D$s&&(D$s=!1);var D$r,D$e,D$U=D$c._context,D$m=this._graphics.cmds;if((D$r=this._temp||(this._temp=[])).length=0,D$m||null==this._graphics._one||(D$o._tempCmds.length=0,D$o._tempCmds.push(this._graphics._one),D$m=D$o._tempCmds),!D$m)return D$r;(D$e=D$o._tempMatrixArrays).length=0;var D$k=D$o._initMatrix;D$k.identity();for(var D$j,D$T,D$Y=D$o._tempMatrix,D$Z=NaN,D$h=NaN,D$H=NaN,D$A=NaN,D$x=NaN,D$B=NaN,D$$=0,D$l=D$m.length;D$$<D$l;D$$++)if((D$j=D$m[D$$]).callee)switch(D$j.callee){case D$U._save:case 7:D$e.push(D$k),D$k=D$k.clone();break;case D$U._restore:case 8:D$k=D$e.pop();break;case D$U._scale:case 5:D$Y.identity(),D$Y.translate(-D$j[2],-D$j[3]),D$Y.scale(D$j[0],D$j[1]),D$Y.translate(D$j[2],D$j[3]),this._switchMatrix(D$k,D$Y);break;case D$U._rotate:case 3:D$Y.identity(),D$Y.translate(-D$j[1],-D$j[2]),D$Y.rotate(D$j[0]),D$Y.translate(D$j[1],D$j[2]),this._switchMatrix(D$k,D$Y);break;case D$U._translate:case 6:D$Y.identity(),D$Y.translate(D$j[0],D$j[1]),this._switchMatrix(D$k,D$Y);break;case D$U._transform:case 4:D$Y.identity(),D$Y.translate(-D$j[1],-D$j[2]),D$Y.concat(D$j[0]),D$Y.translate(D$j[1],D$j[2]),this._switchMatrix(D$k,D$Y);break;case 16:case 24:D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[0],D$j[1],D$j[2],D$j[3]),D$k);break;case 17:D$k.copyTo(D$Y),D$Y.concat(D$j[4]),D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[0],D$j[1],D$j[2],D$j[3]),D$Y);break;case D$U._drawTexture:D$T=D$j[0],D$s?D$j[3]&&D$j[4]?D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1],D$j[2],D$j[3],D$j[4]),D$k):(D$T=D$j[0],D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1],D$j[2],D$T.width,D$T.height),D$k)):(D$Z=(D$j[3]||D$T.sourceWidth)/D$T.width,D$h=(D$j[4]||D$T.sourceHeight)/D$T.height,D$H=D$Z*D$T.sourceWidth,D$A=D$h*D$T.sourceHeight,D$x=0<D$T.offsetX?D$T.offsetX:0,D$B=0<D$T.offsetY?D$T.offsetY:0,D$x*=D$Z,D$B*=D$h,D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1]-D$x,D$j[2]-D$B,D$H,D$A),D$k));break;case D$U._fillTexture:D$j[3]&&D$j[4]?D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1],D$j[2],D$j[3],D$j[4]),D$k):(D$T=D$j[0],D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1],D$j[2],D$T.width,D$T.height),D$k));break;case D$U._drawTextureWithTransform:var D$V;D$V=D$j[5]?(D$k.copyTo(D$Y),D$Y.concat(D$j[5]),D$Y):D$k,D$s?D$j[3]&&D$j[4]?D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1],D$j[2],D$j[3],D$j[4]),D$V):(D$T=D$j[0],D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1],D$j[2],D$T.width,D$T.height),D$V)):(D$T=D$j[0],D$Z=(D$j[3]||D$T.sourceWidth)/D$T.width,D$h=(D$j[4]||D$T.sourceHeight)/D$T.height,D$H=D$Z*D$T.sourceWidth,D$A=D$h*D$T.sourceHeight,D$x=0<D$T.offsetX?D$T.offsetX:0,D$B=0<D$T.offsetY?D$T.offsetY:0,D$x*=D$Z,D$B*=D$h,D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[1]-D$x,D$j[2]-D$B,D$H,D$A),D$V));break;case D$U._drawRect:case 13:D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[0],D$j[1],D$j[2],D$j[3]),D$k);break;case D$U._drawCircle:case D$U._fillCircle:case 14:D$o._addPointArrToRst(D$r,D$y._getBoundPointS(D$j[0]-D$j[2],D$j[1]-D$j[2],D$j[2]+D$j[2],D$j[2]+D$j[2]),D$k);break;case D$U._drawLine:case 20:D$o._tempPoints.length=0;var D$b;D$b=.5*D$j[5],D$j[0]==D$j[2]?D$o._tempPoints.push(D$j[0]+D$b,D$j[1],D$j[2]+D$b,D$j[3],D$j[0]-D$b,D$j[1],D$j[2]-D$b,D$j[3]):D$j[1]==D$j[3]?D$o._tempPoints.push(D$j[0],D$j[1]+D$b,D$j[2],D$j[3]+D$b,D$j[0],D$j[1]-D$b,D$j[2],D$j[3]-D$b):D$o._tempPoints.push(D$j[0],D$j[1],D$j[2],D$j[3]),D$o._addPointArrToRst(D$r,D$o._tempPoints,D$k);break;case D$U._drawCurves:case 22:D$o._addPointArrToRst(D$r,D$I.I.getBezierPoints(D$j[2]),D$k,D$j[0],D$j[1]);break;case D$U._drawPoly:case D$U._drawLines:case 18:D$o._addPointArrToRst(D$r,D$j[2],D$k,D$j[0],D$j[1]);break;case D$U._drawPath:case 19:D$o._addPointArrToRst(D$r,this._getPathPoints(D$j[2]),D$k,D$j[0],D$j[1]);break;case D$U._drawPie:case 15:D$o._addPointArrToRst(D$r,this._getPiePoints(D$j[0],D$j[1],D$j[2],D$j[3],D$j[4]),D$k)}return 200<D$r.length?D$r=D$u.copyArray(D$r,D$y._getWrapRec(D$r)._getBoundPoints()):8<D$r.length&&(D$r=D$w.scanPList(D$r)),D$r},D$s._switchMatrix=function(D$s,D$r){D$r.concat(D$s),D$r.copyTo(D$s)},D$s._getPiePoints=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$o._tempPoints;D$o._tempPoints.length=0,D$k.push(D$s,D$r);var D$j=(D$m-D$U)%(2*Math.PI)/10,D$T=NaN,D$Y=D$U;for(D$T=0;D$T<=10;D$T++)D$k.push(D$s+D$e*Math.cos(D$Y),D$r+D$e*Math.sin(D$Y)),D$Y+=D$j;return D$k},D$s._getPathPoints=function(D$s){var D$r,D$e,D$U=0,D$m=D$o._tempPoints;for(D$m.length=0,D$r=D$s.length,D$U=0;D$U<D$r;D$U++)1<(D$e=D$s[D$U]).length&&(D$m.push(D$e[1],D$e[2]),3<D$e.length&&D$m.push(D$e[3],D$e[4]));return D$m},D$o._addPointArrToRst=function(D$s,D$r,D$e,D$U,D$m){void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0);var D$k,D$j=0;for(D$k=D$r.length,D$j=0;D$j<D$k;D$j+=2)D$o._addPointToRst(D$s,D$r[D$j]+D$U,D$r[D$j+1]+D$m,D$e)},D$o._addPointToRst=function(D$s,D$r,D$e,D$U){var D$m=D$n.TEMP;D$m.setTo(D$r||0,D$e||0),D$U.transformPoint(D$m),D$s.push(D$m.x,D$m.y)},D$o._tempPoints=[],D$o._tempMatrixArrays=[],D$o._tempCmds=[],D$Y(D$o,["_tempMatrix",function(){return this._tempMatrix=new D$O},"_initMatrix",function(){return this._initMatrix=new D$O}]),D$o}(),D$k=function(){function D$s(){}D$h(D$s,"laya.events.Event");var D$r=D$s.prototype;return D$r.setTo=function(D$s,D$r,D$e){return this.type=D$s,this.currentTarget=D$r,this.target=D$e,this},D$r.stopPropagation=function(){this._stoped=!0},D$B(0,D$r,"stageY",function(){return D$D.stage.mouseY}),D$B(0,D$r,"charCode",function(){return this.nativeEvent.charCode}),D$B(0,D$r,"touches",function(){var D$s=this.nativeEvent.touches;if(D$s)for(var D$r=D$D.stage,D$e=0,D$U=D$s.length;D$e<D$U;D$e++){var D$m=D$s[D$e],D$k=D$n.TEMP;D$k.setTo(D$m.clientX,D$m.clientY),D$r._canvasTransform.invertTransformPoint(D$k),D$r.transform.invertTransformPoint(D$k),D$m.stageX=D$k.x,D$m.stageY=D$k.y}return D$s}),D$B(0,D$r,"keyLocation",function(){return this.nativeEvent.keyLocation}),D$B(0,D$r,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),D$B(0,D$r,"altKey",function(){return this.nativeEvent.altKey}),D$B(0,D$r,"shiftKey",function(){return this.nativeEvent.shiftKey}),D$B(0,D$r,"stageX",function(){return D$D.stage.mouseX}),D$s.EMPTY=new D$s,D$s.MOUSE_DOWN="mousedown",D$s.MOUSE_UP="mouseup",D$s.CLICK="click",D$s.RIGHT_MOUSE_DOWN="rightmousedown",D$s.RIGHT_MOUSE_UP="rightmouseup",D$s.RIGHT_CLICK="rightclick",D$s.MOUSE_MOVE="mousemove",D$s.MOUSE_OVER="mouseover",D$s.MOUSE_OUT="mouseout",D$s.MOUSE_WHEEL="mousewheel",D$s.ROLL_OVER="mouseover",D$s.ROLL_OUT="mouseout",D$s.DOUBLE_CLICK="doubleclick",D$s.CHANGE="change",D$s.CHANGED="changed",D$s.RESIZE="resize",D$s.ADDED="added",D$s.REMOVED="removed",D$s.DISPLAY="display",D$s.UNDISPLAY="undisplay",D$s.ERROR="error",D$s.COMPLETE="complete",D$s.LOADED="loaded",D$s.INITED="inited",D$s.PROGRESS="progress",D$s.INPUT="input",D$s.RENDER="render",D$s.OPEN="open",D$s.MESSAGE="message",D$s.CLOSE="close",D$s.KEY_DOWN="keydown",D$s.KEY_PRESS="keypress",D$s.KEY_UP="keyup",D$s.FRAME="enterframe",D$s.DRAG_START="dragstart",D$s.DRAG_MOVE="dragmove",D$s.DRAG_END="dragend",D$s.ENTER="enter",D$s.SELECT="select",D$s.BLUR="blur",D$s.FOCUS="focus",D$s.VISIBILITY_CHANGE="visibilitychange",D$s.FOCUS_CHANGE="focuschange",D$s.PLAYED="played",D$s.PAUSED="paused",D$s.STOPPED="stopped",D$s.START="start",D$s.END="end",D$s.ENABLE_CHANGED="enablechanged",D$s.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",D$s.COMPONENT_ADDED="componentadded",D$s.COMPONENT_REMOVED="componentremoved",D$s.LAYER_CHANGED="layerchanged",D$s.HIERARCHY_LOADED="hierarchyloaded",D$s.RECOVERED="recovered",D$s.RELEASED="released",D$s.LINK="link",D$s.LABEL="label",D$s.FULL_SCREEN_CHANGE="fullscreenchange",D$s.DEVICE_LOST="devicelost",D$s.MESH_CHANGED="meshchanged",D$s.MATERIAL_CHANGED="materialchanged",D$s.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",D$s.ANIMATION_CHANGED="animationchanged",D$s.TRIGGER_ENTER="triggerenter",D$s.TRIGGER_STAY="triggerstay",D$s.TRIGGER_EXIT="triggerexit",D$s.TRAIL_FILTER_CHANGE="trailfilterchange",D$s.DOMINO_FILTER_CHANGE="dominofilterchange",D$s}(),D$H=(function(){function D$s(){}D$h(D$s,"laya.events.Keyboard"),D$s.NUMBER_0=48,D$s.NUMBER_1=49,D$s.NUMBER_2=50,D$s.NUMBER_3=51,D$s.NUMBER_4=52,D$s.NUMBER_5=53,D$s.NUMBER_6=54,D$s.NUMBER_7=55,D$s.NUMBER_8=56,D$s.NUMBER_9=57,D$s.A=65,D$s.B=66,D$s.C=67,D$s.D=68,D$s.E=69,D$s.F=70,D$s.G=71,D$s.H=72,D$s.I=73,D$s.J=74,D$s.K=75,D$s.L=76,D$s.M=77,D$s.N=78,D$s.O=79,D$s.P=80,D$s.Q=81,D$s.R=82,D$s.S=83,D$s.T=84,D$s.U=85,D$s.V=86,D$s.W=87,D$s.X=88,D$s.Y=89,D$s.Z=90,D$s.F1=112,D$s.F2=113,D$s.F3=114,D$s.F4=115,D$s.F5=116,D$s.F6=117,D$s.F7=118,D$s.F8=119,D$s.F9=120,D$s.F10=121,D$s.F11=122,D$s.F12=123,D$s.F13=124,D$s.F14=125,D$s.F15=126,D$s.NUMPAD=21,D$s.NUMPAD_0=96,D$s.NUMPAD_1=97,D$s.NUMPAD_2=98,D$s.NUMPAD_3=99,D$s.NUMPAD_4=100,D$s.NUMPAD_5=101,D$s.NUMPAD_6=102,D$s.NUMPAD_7=103,D$s.NUMPAD_8=104,D$s.NUMPAD_9=105,D$s.NUMPAD_ADD=107,D$s.NUMPAD_DECIMAL=110,D$s.NUMPAD_DIVIDE=111,D$s.NUMPAD_ENTER=108,D$s.NUMPAD_MULTIPLY=106,D$s.NUMPAD_SUBTRACT=109,D$s.SEMICOLON=186,D$s.EQUAL=187,D$s.COMMA=188,D$s.MINUS=189,D$s.PERIOD=190,D$s.SLASH=191,D$s.BACKQUOTE=192,D$s.LEFTBRACKET=219,D$s.BACKSLASH=220,D$s.RIGHTBRACKET=221,D$s.QUOTE=222,D$s.ALTERNATE=18,D$s.BACKSPACE=8,D$s.CAPS_LOCK=20,D$s.COMMAND=15,D$s.CONTROL=17,D$s.DELETE=46,D$s.ENTER=13,D$s.ESCAPE=27,D$s.PAGE_UP=33,D$s.PAGE_DOWN=34,D$s.END=35,D$s.HOME=36,D$s.LEFT=37,D$s.UP=38,D$s.RIGHT=39,D$s.DOWN=40,D$s.SHIFT=16,D$s.SPACE=32,D$s.TAB=9,D$s.INSERT=45}(),function(){function D$m(){}return D$h(D$m,"laya.events.KeyBoardManager"),D$m.__init__=function(){D$m._addEvent("keydown"),D$m._addEvent("keypress"),D$m._addEvent("keyup")},D$m._addEvent=function(D$r){D$Q.document.addEventListener(D$r,function(D$s){laya.events.KeyBoardManager._dispatch(D$s,D$r)},!0)},D$m._dispatch=function(D$s,D$r){if(D$m.enabled){D$m._event._stoped=!1,D$m._event.nativeEvent=D$s,D$m._event.keyCode=D$s.keyCode||D$s.which||D$s.charCode,"keydown"===D$r?D$m._pressKeys[D$m._event.keyCode]=!0:"keyup"===D$r&&(D$m._pressKeys[D$m._event.keyCode]=null);for(var D$e=D$D.stage.focus&&null!=D$D.stage.focus.event&&D$D.stage.focus.displayedInStage?D$D.stage.focus:D$D.stage,D$U=D$e;D$U;)D$U.event(D$r,D$m._event.setTo(D$r,D$U,D$e)),D$U=D$U.parent}},D$m.hasKeyDown=function(D$s){return D$m._pressKeys[D$s]},D$m._pressKeys={},D$m.enabled=!0,D$Y(D$m,["_event",function(){return this._event=new D$k}]),D$m}()),D$$=(function(){function D$s(){}D$h(D$s,"laya.events.KeyLocation"),D$s.STANDARD=0,D$s.LEFT=1,D$s.RIGHT=2,D$s.NUM_PAD=3}(),function(){function D$Z(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=D$Q.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new D$k,this._matrix=new D$O,this._point=new D$n,this._rect=new D$y,this._prePoint=new D$n,this._curTouchID=NaN}D$h(D$Z,"laya.events.MouseManager");var D$s=D$Z.prototype;return D$s.__init__=function(D$s,D$r){var D$e=this;this._stage=D$s;var D$U=this,D$m=this._eventList;D$r.oncontextmenu=function(D$s){if(D$Z.enabled)return!1},D$r.addEventListener("mousedown",function(D$s){D$Z.enabled&&(D$Q.onIE||D$s.preventDefault(),D$m.push(D$s),D$U.mouseDownTime=D$Q.now())}),D$r.addEventListener("mouseup",function(D$s){D$Z.enabled&&(D$s.preventDefault(),D$m.push(D$s),D$U.mouseDownTime=-D$Q.now())},!0),D$r.addEventListener("mousemove",function(D$s){if(D$Z.enabled){D$s.preventDefault();var D$r=D$Q.now();if(D$r-D$U._lastMoveTimer<10)return;D$U._lastMoveTimer=D$r,D$m.push(D$s)}},!0),D$r.addEventListener("mouseout",function(D$s){D$Z.enabled&&D$m.push(D$s)}),D$r.addEventListener("mouseover",function(D$s){D$Z.enabled&&D$m.push(D$s)}),D$r.addEventListener("touchstart",function(D$s){D$Z.enabled&&(D$m.push(D$s),D$Z._isFirstTouch||D$ws.isInputting||D$s.preventDefault(),D$U.mouseDownTime=D$Q.now())}),D$r.addEventListener("touchend",function(D$s){D$Z.enabled?(D$Z._isFirstTouch||D$ws.isInputting||D$s.preventDefault(),D$Z._isFirstTouch=!1,D$m.push(D$s),D$U.mouseDownTime=-D$Q.now()):D$e._curTouchID=NaN},!0),D$r.addEventListener("touchmove",function(D$s){D$Z.enabled&&(D$s.preventDefault(),D$m.push(D$s))},!0),D$r.addEventListener("touchcancel",function(D$s){D$Z.enabled?(D$s.preventDefault(),D$m.push(D$s)):D$e._curTouchID=NaN},!0),D$r.addEventListener("mousewheel",function(D$s){D$Z.enabled&&D$m.push(D$s)}),D$r.addEventListener("DOMMouseScroll",function(D$s){D$Z.enabled&&D$m.push(D$s)})},D$s.initEvent=function(D$s,D$r){var D$e;this._event._stoped=!1,this._event.nativeEvent=D$r||D$s,this._target=null,this._point.setTo(D$s.pageX||D$s.clientX,D$s.pageY||D$s.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=D$s.identifier||0,this._tTouchID=this._event.touchId,(D$e=D$l.I._event)._stoped=!1,D$e.nativeEvent=this._event.nativeEvent,D$e.touchId=this._event.touchId},D$s.checkMouseWheel=function(D$s){this._event.delta=D$s.wheelDelta?.025*D$s.wheelDelta:-D$s.detail;for(var D$r=D$l.I.getLastOvers(),D$e=0,D$U=D$r.length;D$e<D$U;D$e++){var D$m=D$r[D$e];D$m.event("mousewheel",this._event.setTo("mousewheel",D$m,this._target))}},D$s.onMouseMove=function(D$s){D$l.I.onMouseMove(D$s,this._tTouchID)},D$s.onMouseDown=function(D$s){if(D$ws.isInputting&&D$D.stage.focus&&D$D.stage.focus.focus&&!D$D.stage.focus.contains(this._target)){var D$r=D$D.stage.focus._tf||D$D.stage.focus,D$e=D$s._tf||D$s;D$e instanceof laya.display.Input&&D$e.multiline==D$r.multiline?D$r._focusOut():D$r.focus=!1}D$l.I.onMouseDown(D$s,this._tTouchID,this._isLeftMouse)},D$s.onMouseUp=function(D$s){D$l.I.onMouseUp(D$s,this._tTouchID,this._isLeftMouse)},D$s.check=function(D$s,D$r,D$e,D$U){this._point.setTo(D$r,D$e),D$s.fromParentPoint(this._point),D$r=this._point.x,D$e=this._point.y;var D$m=D$s.scrollRect;if(D$m&&(this._rect.setTo(D$m.x,D$m.y,D$m.width,D$m.height),!this._rect.contains(D$r,D$e)))return!1;if(!this.disableMouseEvent){if(D$s.hitTestPrior&&!D$s.mouseThrough&&!this.hitTest(D$s,D$r,D$e))return!1;for(var D$k=D$s._childs.length-1;-1<D$k;D$k--){var D$j=D$s._childs[D$k];if(!D$j.destroyed&&D$j.mouseEnabled&&D$j.visible&&this.check(D$j,D$r,D$e,D$U))return!0}}var D$T=!(!D$s.hitTestPrior||D$s.mouseThrough||this.disableMouseEvent)||this.hitTest(D$s,D$r,D$e);return D$T?(this._target=D$s,D$U.call(this,D$s)):D$U===this.onMouseUp&&D$s===this._stage&&(this._target=this._stage,D$U.call(this,this._target)),D$T},D$s.hitTest=function(D$s,D$r,D$e){var D$U=!1;if(D$s.scrollRect&&(D$r-=D$s.scrollRect.x,D$e-=D$s.scrollRect.y),D$s.hitArea instanceof laya.utils.HitArea)return D$s.hitArea.isHit(D$r,D$e);if(0<D$s.width&&0<D$s.height||D$s.mouseThrough||D$s.hitArea)if(D$s.mouseThrough)D$U=D$s.getGraphicBounds().contains(D$r,D$e);else{var D$m=this._rect;D$s.hitArea?D$m=D$s.hitArea:D$m.setTo(0,0,D$s.width,D$s.height),D$U=D$m.contains(D$r,D$e)}return D$U},D$s.runEvent=function(){var D$s=this._eventList.length;if(D$s){this.mouseEventTime=D$Q.now();var D$r,D$e=0,D$U=0,D$m=0;try{for(;D$e<D$s;){var D$k=this._eventList[D$e];switch("mousemove"!==D$k.type&&(this._prePoint.x=this._prePoint.y=-1e6),D$k.type){case"mousedown":this._touchIDs[0]=this._id++,D$Z._isTouchRespond?D$Z._isTouchRespond=!1:(this._isLeftMouse=0===D$k.button,this.initEvent(D$k),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===D$k.button,this.initEvent(D$k),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-D$k.clientX)+Math.abs(this._prePoint.y-D$k.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=D$k.clientX,this._prePoint.y=D$k.clientY,this.initEvent(D$k),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":D$Z._isTouchRespond=!0,this._isLeftMouse=!0;var D$j=D$k.changedTouches;for(D$U=0,D$m=D$j.length;D$U<D$m;D$U++)D$r=D$j[D$U],(D$Z.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=D$r.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[D$r.identifier]=this._id++,this.initEvent(D$r,D$k),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":D$Z._isTouchRespond=!0,this._isLeftMouse=!0;var D$T=D$k.changedTouches;for(D$U=0,D$m=D$T.length;D$U<D$m;D$U++)if(D$r=D$T[D$U],D$Z.multiTouchEnabled||D$r.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(D$r,D$k);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var D$Y=D$k.changedTouches;for(D$U=0,D$m=D$Y.length;D$U<D$m;D$U++)D$r=D$Y[D$U],(D$Z.multiTouchEnabled||D$r.identifier==this._curTouchID)&&(this.initEvent(D$r,D$k),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(D$k);break;case"mouseout":D$l.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}D$e++}}catch(D$s){throw this._eventList.length=0,D$s}this._eventList.length=0}},D$Z.enabled=!0,D$Z.multiTouchEnabled=!0,D$Z._isTouchRespond=!1,D$Z._isFirstTouch=!0,D$Y(D$Z,["instance",function(){return this.instance=new D$Z}]),D$Z}()),D$l=function(){function D$B(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new D$k}D$h(D$B,"laya.events.TouchManager");var D$s=D$B.prototype;return D$s._clearTempArrs=function(){D$B._oldArr.length=0,D$B._newArr.length=0,D$B._tEleArr.length=0},D$s.getTouchFromArr=function(D$s,D$r){var D$e,D$U,D$m=0;for(D$e=D$r.length,D$m=0;D$m<D$e;D$m++)if((D$U=D$r[D$m]).id==D$s)return D$U;return null},D$s.removeTouchFromArr=function(D$s,D$r){var D$e=0;for(D$e=D$r.length-1;0<=D$e;D$e--)D$r[D$e].id==D$s&&D$r.splice(D$e,1)},D$s.createTouchO=function(D$s,D$r){var D$e;return(D$e=D$d.getItem("TouchData")||{}).id=D$r,D$e.tar=D$s,D$e},D$s.onMouseDown=function(D$s,D$r,D$e){var D$U,D$m,D$k,D$j;(void 0===D$e&&(D$e=!1),this.enable)&&(D$U=this.getTouchFromArr(D$r,this.preOvers),D$k=this.getEles(D$s,null,D$B._tEleArr),D$U?D$U.tar=D$s:(D$m=this.createTouchO(D$s,D$r),this.preOvers.push(D$m)),D$Q.onMobile&&this.sendEvents(D$k,"mouseover",D$r),D$j=D$e?this.preDowns:this.preRightDowns,(D$U=this.getTouchFromArr(D$r,D$j))?D$U.tar=D$s:(D$m=this.createTouchO(D$s,D$r),D$j.push(D$m)),this.sendEvents(D$k,D$e?"mousedown":"rightmousedown",D$r),this._clearTempArrs())},D$s.sendEvents=function(D$s,D$r,D$e){void 0===D$e&&(D$e=0);var D$U,D$m,D$k,D$j=0;for(D$U=D$s.length,this._event._stoped=!1,D$m=D$s[0],D$j=0;D$j<D$U;D$j++){if((D$k=D$s[D$j]).destroyed)return;if(D$k.event(D$r,this._event.setTo(D$r,D$k,D$m)),this._event._stoped)break}},D$s.getEles=function(D$s,D$r,D$e){for(D$e?D$e.length=0:D$e=[];D$s&&D$s!=D$r;)D$e.push(D$s),D$s=D$s.parent;return D$e},D$s.checkMouseOutAndOverOfMove=function(D$s,D$r,D$e){if(void 0===D$e&&(D$e=0),D$r!=D$s){var D$U,D$m,D$k=0,D$j=0;if(D$r.contains(D$s))D$m=this.getEles(D$s,D$r,D$B._tEleArr),this.sendEvents(D$m,"mouseover",D$e);else if(D$s.contains(D$r))D$m=this.getEles(D$r,D$s,D$B._tEleArr),this.sendEvents(D$m,"mouseout",D$e);else{var D$T,D$Y;(D$m=D$B._tEleArr).length=0,D$T=this.getEles(D$r,null,D$B._oldArr),D$Y=this.getEles(D$s,null,D$B._newArr),D$j=D$T.length;var D$Z=0;for(D$k=0;D$k<D$j;D$k++){if(D$U=D$T[D$k],0<=(D$Z=D$Y.indexOf(D$U))){D$Y.splice(D$Z,D$Y.length-D$Z);break}D$m.push(D$U)}0<D$m.length&&this.sendEvents(D$m,"mouseout",D$e),0<D$Y.length&&this.sendEvents(D$Y,"mouseover",D$e)}}},D$s.onMouseMove=function(D$s,D$r){var D$e,D$U;this.enable&&((D$e=this.getTouchFromArr(D$r,this.preOvers))?(this.checkMouseOutAndOverOfMove(D$s,D$e.tar),D$e.tar=D$s,D$U=this.getEles(D$s,null,D$B._tEleArr)):(D$U=this.getEles(D$s,null,D$B._tEleArr),this.sendEvents(D$U,"mouseover",D$r),this.preOvers.push(this.createTouchO(D$s,D$r))),this.sendEvents(D$U,"mousemove",D$r),this._clearTempArrs())},D$s.getLastOvers=function(){return(D$B._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,D$B._tEleArr):(D$B._tEleArr.push(D$D.stage),D$B._tEleArr)},D$s.stageMouseOut=function(){var D$s;D$s=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(D$s,"mouseout",0)},D$s.onMouseUp=function(D$s,D$r,D$e){if(void 0===D$e&&(D$e=!1),this.enable){var D$U,D$m,D$k,D$j,D$T,D$Y,D$Z=0,D$h=0,D$H=D$Q.onMobile;if(D$m=this.getEles(D$s,null,D$B._tEleArr),this.sendEvents(D$m,D$e?"mouseup":"rightmouseup",D$r),D$Y=D$e?this.preDowns:this.preRightDowns,D$U=this.getTouchFromArr(D$r,D$Y)){var D$A,D$x=D$Q.now();if(D$A=D$x-this._lastClickTime<300,this._lastClickTime=D$x,D$s==D$U.tar)D$T=D$m;else for(D$k=this.getEles(D$U.tar,null,D$B._oldArr),(D$T=D$B._newArr).length=0,D$h=D$k.length,D$Z=0;D$Z<D$h;D$Z++)D$j=D$k[D$Z],0<=D$m.indexOf(D$j)&&D$T.push(D$j);0<D$T.length&&this.sendEvents(D$T,D$e?"click":"rightclick",D$r),D$e&&D$A&&this.sendEvents(D$T,"doubleclick",D$r),this.removeTouchFromArr(D$r,D$Y),D$U.tar=null,D$d.recover("TouchData",D$U)}else;(D$U=this.getTouchFromArr(D$r,this.preOvers))&&D$H&&((D$T=this.getEles(D$U.tar,null,D$T))&&0<D$T.length&&this.sendEvents(D$T,"mouseout",D$r),this.removeTouchFromArr(D$r,this.preOvers),D$U.tar=null,D$d.recover("TouchData",D$U)),this._clearTempArrs()}},D$B._oldArr=[],D$B._newArr=[],D$B._tEleArr=[],D$Y(D$B,["I",function(){return this.I=new D$B}]),D$B}(),D$V=function(){function D$s(){this._action=null}D$h(D$s,"laya.filters.Filter");var D$r=D$s.prototype;return D$D.imps(D$r,{"laya.filters.IFilter":!0}),D$r.callNative=function(D$s){},D$B(0,D$r,"type",function(){return-1}),D$B(0,D$r,"action",function(){return this._action}),D$s.BLUR=16,D$s.COLOR=32,D$s.GLOW=8,D$s._filterStart=null,D$s._filterEnd=null,D$s._EndTarget=null,D$s._recycleScope=null,D$s._filter=null,D$s._useSrc=null,D$s._endSrc=null,D$s._useOut=null,D$s._endOut=null,D$s}(),D$o=function(){function D$s(){this.data=null}D$h(D$s,"laya.filters.ColorFilterAction");var D$r=D$s.prototype;return D$D.imps(D$r,{"laya.filters.IFilterAction":!0}),D$r.apply=function(D$s){var D$r=D$s.ctx.ctx,D$e=D$s.ctx.ctx.canvas;if(0==D$e.width||0==D$e.height)return D$e;for(var D$U,D$m=D$r.getImageData(0,0,D$e.width,D$e.height),D$k=D$m.data,D$j=0,D$T=D$k.length;D$j<D$T;D$j+=4)D$U=this.getColor(D$k[D$j],D$k[D$j+1],D$k[D$j+2],D$k[D$j+3]),0!=D$k[D$j+3]&&(D$k[D$j]=D$U[0],D$k[D$j+1]=D$U[1],D$k[D$j+2]=D$U[2],D$k[D$j+3]=D$U[3]);return D$r.putImageData(D$m,0,0),D$s},D$r.getColor=function(D$s,D$r,D$e,D$U){var D$m=[];if(this.data._mat&&this.data._alpha){var D$k=this.data._mat,D$j=this.data._alpha;D$m[0]=D$k[0]*D$s+D$k[1]*D$r+D$k[2]*D$e+D$k[3]*D$U+D$j[0],D$m[1]=D$k[4]*D$s+D$k[5]*D$r+D$k[6]*D$e+D$k[7]*D$U+D$j[1],D$m[2]=D$k[8]*D$s+D$k[9]*D$r+D$k[10]*D$e+D$k[11]*D$U+D$j[2],D$m[3]=D$k[12]*D$s+D$k[13]*D$r+D$k[14]*D$e+D$k[15]*D$U+D$j[3]}return D$m},D$s}(),D$I=(function(){function D$s(){}D$h(D$s,"laya.maths.Arith"),D$s.formatR=function(D$s){return D$s>Math.PI&&(D$s-=2*Math.PI),D$s<-Math.PI&&(D$s+=2*Math.PI),D$s},D$s.isPOT=function(D$s,D$r){return 0<D$s&&0==(D$s&D$s-1)&&0<D$r&&0==(D$r&D$r-1)},D$s.setMatToArray=function(D$s,D$r){D$s.a,D$s.b,D$s.c,D$s.d,D$s.tx,D$s.ty,D$r[0]=D$s.a,D$r[1]=D$s.b,D$r[4]=D$s.c,D$r[5]=D$s.d,D$r[12]=D$s.tx,D$r[13]=D$s.ty}}(),function(){function D$s(){this._controlPoints=[new D$n,new D$n,new D$n],this._calFun=this.getPoint2}D$h(D$s,"laya.maths.Bezier");var D$r=D$s.prototype;return D$r._switchPoint=function(D$s,D$r){var D$e=this._controlPoints.shift();D$e.setTo(D$s,D$r),this._controlPoints.push(D$e)},D$r.getPoint2=function(D$s,D$r){var D$e=this._controlPoints[0],D$U=this._controlPoints[1],D$m=this._controlPoints[2],D$k=Math.pow(1-D$s,2)*D$e.x+2*D$s*(1-D$s)*D$U.x+Math.pow(D$s,2)*D$m.x,D$j=Math.pow(1-D$s,2)*D$e.y+2*D$s*(1-D$s)*D$U.y+Math.pow(D$s,2)*D$m.y;D$r.push(D$k,D$j)},D$r.getPoint3=function(D$s,D$r){var D$e=this._controlPoints[0],D$U=this._controlPoints[1],D$m=this._controlPoints[2],D$k=this._controlPoints[3],D$j=Math.pow(1-D$s,3)*D$e.x+3*D$U.x*D$s*(1-D$s)*(1-D$s)+3*D$m.x*D$s*D$s*(1-D$s)+D$k.x*Math.pow(D$s,3),D$T=Math.pow(1-D$s,3)*D$e.y+3*D$U.y*D$s*(1-D$s)*(1-D$s)+3*D$m.y*D$s*D$s*(1-D$s)+D$k.y*Math.pow(D$s,3);D$r.push(D$j,D$T)},D$r.insertPoints=function(D$s,D$r){var D$e,D$U=NaN;for(D$e=1/(D$s=0<D$s?D$s:5),D$U=0;D$U<=1;D$U+=D$e)this._calFun(D$U,D$r)},D$r.getBezierPoints=function(D$s,D$r,D$e){void 0===D$r&&(D$r=5),void 0===D$e&&(D$e=2);var D$U,D$m,D$k=0;if((D$U=D$s.length)<2*(D$e+1))return[];switch(D$m=[],D$e){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=D$e;)this._controlPoints.push(new D$n);for(D$k=0;D$k<2*D$e;D$k+=2)this._switchPoint(D$s[D$k],D$s[D$k+1]);for(D$k=2*D$e;D$k<D$U;D$k+=2)this._switchPoint(D$s[D$k],D$s[D$k+1]),D$k/2%D$e==0&&this.insertPoints(D$r,D$m);return D$m},D$Y(D$s,["I",function(){return this.I=new D$s}]),D$s}()),D$w=function(){function D$Z(){}return D$h(D$Z,"laya.maths.GrahamScan"),D$Z.multiply=function(D$s,D$r,D$e){return(D$s.x-D$e.x)*(D$r.y-D$e.y)-(D$r.x-D$e.x)*(D$s.y-D$e.y)},D$Z.dis=function(D$s,D$r){return(D$s.x-D$r.x)*(D$s.x-D$r.x)+(D$s.y-D$r.y)*(D$s.y-D$r.y)},D$Z._getPoints=function(D$s,D$r,D$e){for(void 0===D$r&&(D$r=!1),D$Z._mPointList||(D$Z._mPointList=[]);D$Z._mPointList.length<D$s;)D$Z._mPointList.push(new D$n);return D$e||(D$e=[]),D$e.length=0,D$r?D$Z.getFrom(D$e,D$Z._mPointList,D$s):D$Z.getFromR(D$e,D$Z._mPointList,D$s),D$e},D$Z.getFrom=function(D$s,D$r,D$e){var D$U=0;for(D$U=0;D$U<D$e;D$U++)D$s.push(D$r[D$U]);return D$s},D$Z.getFromR=function(D$s,D$r,D$e){var D$U=0;for(D$U=0;D$U<D$e;D$U++)D$s.push(D$r.pop());return D$s},D$Z.pListToPointList=function(D$s,D$r){void 0===D$r&&(D$r=!1);var D$e=0,D$U=D$s.length/2,D$m=D$Z._getPoints(D$U,D$r,D$Z._tempPointList);for(D$e=0;D$e<D$U;D$e++)D$m[D$e].setTo(D$s[D$e+D$e],D$s[D$e+D$e+1]);return D$m},D$Z.pointListToPlist=function(D$s){var D$r,D$e=0,D$U=D$s.length,D$m=D$Z._temPList;for(D$e=D$m.length=0;D$e<D$U;D$e++)D$r=D$s[D$e],D$m.push(D$r.x,D$r.y);return D$m},D$Z.scanPList=function(D$s){return D$u.copyArray(D$s,D$Z.pointListToPlist(D$Z.scan(D$Z.pListToPointList(D$s,!0))))},D$Z.scan=function(D$s){var D$r,D$e,D$U,D$m=0,D$k=0,D$j=0,D$T=D$s.length,D$Y={};for((D$e=D$Z._temArr).length=0,D$m=(D$T=D$s.length)-1;0<=D$m;D$m--)D$U=(D$r=D$s[D$m]).x+"_"+D$r.y,D$Y.hasOwnProperty(D$U)||(D$Y[D$U]=!0,D$e.push(D$r));for(D$T=D$e.length,D$u.copyArray(D$s,D$e),D$m=1;D$m<D$T;D$m++)(D$s[D$m].y<D$s[D$j].y||D$s[D$m].y==D$s[D$j].y&&D$s[D$m].x<D$s[D$j].x)&&(D$j=D$m);for(D$r=D$s[0],D$s[0]=D$s[D$j],D$s[D$j]=D$r,D$m=1;D$m<D$T-1;D$m++){for(D$k=(D$j=D$m)+1;D$k<D$T;D$k++)(0<D$Z.multiply(D$s[D$k],D$s[D$j],D$s[0])||0==D$Z.multiply(D$s[D$k],D$s[D$j],D$s[0])&&D$Z.dis(D$s[0],D$s[D$k])<D$Z.dis(D$s[0],D$s[D$j]))&&(D$j=D$k);D$r=D$s[D$m],D$s[D$m]=D$s[D$j],D$s[D$j]=D$r}if((D$e=D$Z._temArr).length=0,D$s.length<3)return D$u.copyArray(D$e,D$s);for(D$e.push(D$s[0],D$s[1],D$s[2]),D$m=3;D$m<D$T;D$m++){for(;2<=D$e.length&&0<=D$Z.multiply(D$s[D$m],D$e[D$e.length-1],D$e[D$e.length-2]);)D$e.pop();D$s[D$m]&&D$e.push(D$s[D$m])}return D$e},D$Z._mPointList=null,D$Z._tempPointList=[],D$Z._temPList=[],D$Z._temArr=[],D$Z}(),D$X=function(){function D$m(){}return D$h(D$m,"laya.maths.MathUtil"),D$m.subtractVector3=function(D$s,D$r,D$e){D$e[0]=D$s[0]-D$r[0],D$e[1]=D$s[1]-D$r[1],D$e[2]=D$s[2]-D$r[2]},D$m.lerp=function(D$s,D$r,D$e){return D$s*(1-D$e)+D$r*D$e},D$m.scaleVector3=function(D$s,D$r,D$e){D$e[0]=D$s[0]*D$r,D$e[1]=D$s[1]*D$r,D$e[2]=D$s[2]*D$r},D$m.lerpVector3=function(D$s,D$r,D$e,D$U){var D$m=D$s[0],D$k=D$s[1],D$j=D$s[2];D$U[0]=D$m+D$e*(D$r[0]-D$m),D$U[1]=D$k+D$e*(D$r[1]-D$k),D$U[2]=D$j+D$e*(D$r[2]-D$j)},D$m.lerpVector4=function(D$s,D$r,D$e,D$U){var D$m=D$s[0],D$k=D$s[1],D$j=D$s[2],D$T=D$s[3];D$U[0]=D$m+D$e*(D$r[0]-D$m),D$U[1]=D$k+D$e*(D$r[1]-D$k),D$U[2]=D$j+D$e*(D$r[2]-D$j),D$U[3]=D$T+D$e*(D$r[3]-D$T)},D$m.slerpQuaternionArray=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){var D$T,D$Y,D$Z,D$h,D$H,D$A=D$s[D$r+0],D$x=D$s[D$r+1],D$B=D$s[D$r+2],D$$=D$s[D$r+3],D$l=D$e[D$U+0],D$V=D$e[D$U+1],D$b=D$e[D$U+2],D$o=D$e[D$U+3];return(D$Y=D$A*D$l+D$x*D$V+D$B*D$b+D$$*D$o)<0&&(D$Y=-D$Y,D$l=-D$l,D$V=-D$V,D$b=-D$b,D$o=-D$o),D$H=1e-6<1-D$Y?(D$T=Math.acos(D$Y),D$Z=Math.sin(D$T),D$h=Math.sin((1-D$m)*D$T)/D$Z,Math.sin(D$m*D$T)/D$Z):(D$h=1-D$m,D$m),D$k[D$j+0]=D$h*D$A+D$H*D$l,D$k[D$j+1]=D$h*D$x+D$H*D$V,D$k[D$j+2]=D$h*D$B+D$H*D$b,D$k[D$j+3]=D$h*D$$+D$H*D$o,D$k},D$m.getRotation=function(D$s,D$r,D$e,D$U){return Math.atan2(D$U-D$r,D$e-D$s)/Math.PI*180},D$m.sortBigFirst=function(D$s,D$r){return D$s==D$r?0:D$s<D$r?1:-1},D$m.sortSmallFirst=function(D$s,D$r){return D$s==D$r?0:D$s<D$r?-1:1},D$m.sortNumBigFirst=function(D$s,D$r){return parseFloat(D$r)-parseFloat(D$s)},D$m.sortNumSmallFirst=function(D$s,D$r){return parseFloat(D$s)-parseFloat(D$r)},D$m.sortByKey=function(D$e,D$s,D$r){var D$U;return void 0===D$s&&(D$s=!1),void 0===D$r&&(D$r=!0),D$U=D$s?D$r?D$m.sortNumBigFirst:D$m.sortBigFirst:D$r?D$m.sortNumSmallFirst:D$m.sortSmallFirst,function(D$s,D$r){return D$U(D$s[D$e],D$r[D$e])}},D$m}(),D$O=function(){function D$e(D$s,D$r,D$e,D$U,D$m,D$k){this.inPool=!1,this.bTransform=!1,void 0===D$s&&(D$s=1),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=1),void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=0),this.a=D$s,this.b=D$r,this.c=D$e,this.d=D$U,this.tx=D$m,this.ty=D$k,this._checkTransform()}D$h(D$e,"laya.maths.Matrix");var D$s=D$e.prototype;return D$s.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},D$s._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},D$s.setTranslate=function(D$s,D$r){return this.tx=D$s,this.ty=D$r,this},D$s.translate=function(D$s,D$r){return this.tx+=D$s,this.ty+=D$r,this},D$s.scale=function(D$s,D$r){this.a*=D$s,this.d*=D$r,this.c*=D$s,this.b*=D$r,this.tx*=D$s,this.ty*=D$r,this.bTransform=!0},D$s.rotate=function(D$s){var D$r=Math.cos(D$s),D$e=Math.sin(D$s),D$U=this.a,D$m=this.c,D$k=this.tx;this.a=D$U*D$r-this.b*D$e,this.b=D$U*D$e+this.b*D$r,this.c=D$m*D$r-this.d*D$e,this.d=D$m*D$e+this.d*D$r,this.tx=D$k*D$r-this.ty*D$e,this.ty=D$k*D$e+this.ty*D$r,this.bTransform=!0},D$s.skew=function(D$s,D$r){var D$e=Math.tan(D$s),D$U=Math.tan(D$r),D$m=this.a,D$k=this.b;return this.a+=D$U*this.c,this.b+=D$U*this.d,this.c+=D$e*D$m,this.d+=D$e*D$k,this},D$s.invertTransformPoint=function(D$s){var D$r=this.a,D$e=this.b,D$U=this.c,D$m=this.d,D$k=this.tx,D$j=D$r*D$m-D$e*D$U,D$T=D$m/D$j,D$Y=-D$e/D$j,D$Z=-D$U/D$j,D$h=D$r/D$j,D$H=(D$U*this.ty-D$m*D$k)/D$j,D$A=-(D$r*this.ty-D$e*D$k)/D$j;return D$s.setTo(D$T*D$s.x+D$Z*D$s.y+D$H,D$Y*D$s.x+D$h*D$s.y+D$A)},D$s.transformPoint=function(D$s){return D$s.setTo(this.a*D$s.x+this.c*D$s.y+this.tx,this.b*D$s.x+this.d*D$s.y+this.ty)},D$s.transformPointN=function(D$s){return D$s.setTo(this.a*D$s.x+this.c*D$s.y,this.b*D$s.x+this.d*D$s.y)},D$s.transformPointArray=function(D$s,D$r){for(var D$e=D$s.length,D$U=0;D$U<D$e;D$U+=2){var D$m=D$s[D$U],D$k=D$s[D$U+1];D$r[D$U]=this.a*D$m+this.c*D$k+this.tx,D$r[D$U+1]=this.b*D$m+this.d*D$k+this.ty}return D$r},D$s.transformPointArrayScale=function(D$s,D$r){for(var D$e=D$s.length,D$U=0;D$U<D$e;D$U+=2){var D$m=D$s[D$U],D$k=D$s[D$U+1];D$r[D$U]=this.a*D$m+this.c*D$k,D$r[D$U+1]=this.b*D$m+this.d*D$k}return D$r},D$s.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},D$s.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},D$s.invert=function(){var D$s=this.a,D$r=this.b,D$e=this.c,D$U=this.d,D$m=this.tx,D$k=D$s*D$U-D$r*D$e;return this.a=D$U/D$k,this.b=-D$r/D$k,this.c=-D$e/D$k,this.d=D$s/D$k,this.tx=(D$e*this.ty-D$U*D$m)/D$k,this.ty=-(D$s*this.ty-D$r*D$m)/D$k,this},D$s.setTo=function(D$s,D$r,D$e,D$U,D$m,D$k){return this.a=D$s,this.b=D$r,this.c=D$e,this.d=D$U,this.tx=D$m,this.ty=D$k,this},D$s.concat=function(D$s){var D$r=this.a,D$e=this.c,D$U=this.tx;return this.a=D$r*D$s.a+this.b*D$s.c,this.b=D$r*D$s.b+this.b*D$s.d,this.c=D$e*D$s.a+this.d*D$s.c,this.d=D$e*D$s.b+this.d*D$s.d,this.tx=D$U*D$s.a+this.ty*D$s.c+D$s.tx,this.ty=D$U*D$s.b+this.ty*D$s.d+D$s.ty,this},D$s.scaleEx=function(D$s,D$r){var D$e=this.a,D$U=this.b,D$m=this.c,D$k=this.d;0!==D$U||0!==D$m?(this.a=D$s*D$e,this.b=D$s*D$U,this.c=D$r*D$m):(this.a=D$s*D$e,this.b=0*D$k,this.c=0*D$e),this.d=D$r*D$k,this.bTransform=!0},D$s.rotateEx=function(D$s){var D$r=Math.cos(D$s),D$e=Math.sin(D$s),D$U=this.a,D$m=this.b,D$k=this.c,D$j=this.d;0!==D$m||0!==D$k?(this.a=D$r*D$U+D$e*D$k,this.b=D$r*D$m+D$e*D$j,this.c=-D$e*D$U+D$r*D$k,this.d=-D$e*D$m+D$r*D$j):(this.a=D$r*D$U,this.b=D$e*D$j,this.c=-D$e*D$U,this.d=D$r*D$j),this.bTransform=!0},D$s.clone=function(){var D$s=D$e.create();return D$s.a=this.a,D$s.b=this.b,D$s.c=this.c,D$s.d=this.d,D$s.tx=this.tx,D$s.ty=this.ty,D$s.bTransform=this.bTransform,D$s},D$s.copyTo=function(D$s){return D$s.a=this.a,D$s.b=this.b,D$s.c=this.c,D$s.d=this.d,D$s.tx=this.tx,D$s.ty=this.ty,D$s.bTransform=this.bTransform,D$s},D$s.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},D$s.destroy=function(){if(!this.inPool){var D$s=D$e._cache;this.inPool=!0,D$s._length||(D$s._length=0),(D$s[D$s._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},D$e.mul=function(D$s,D$r,D$e){var D$U=D$s.a,D$m=D$s.b,D$k=D$s.c,D$j=D$s.d,D$T=D$s.tx,D$Y=D$s.ty,D$Z=D$r.a,D$h=D$r.b,D$H=D$r.c,D$A=D$r.d,D$x=D$r.tx,D$B=D$r.ty;return 0!==D$h||0!==D$H?(D$e.a=D$U*D$Z+D$m*D$H,D$e.b=D$U*D$h+D$m*D$A,D$e.c=D$k*D$Z+D$j*D$H,D$e.d=D$k*D$h+D$j*D$A,D$e.tx=D$Z*D$T+D$H*D$Y+D$x,D$e.ty=D$h*D$T+D$A*D$Y+D$B):(D$e.a=D$U*D$Z,D$e.b=D$m*D$A,D$e.c=D$k*D$Z,D$e.d=D$j*D$A,D$e.tx=D$Z*D$T+D$x,D$e.ty=D$A*D$Y+D$B),D$e},D$e.mul16=function(D$s,D$r,D$e){var D$U=D$s.a,D$m=D$s.b,D$k=D$s.c,D$j=D$s.d,D$T=D$s.tx,D$Y=D$s.ty,D$Z=D$r.a,D$h=D$r.b,D$H=D$r.c,D$A=D$r.d,D$x=D$r.tx,D$B=D$r.ty;return 0!==D$h||0!==D$H?(D$e[0]=D$U*D$Z+D$m*D$H,D$e[1]=D$U*D$h+D$m*D$A,D$e[4]=D$k*D$Z+D$j*D$H,D$e[5]=D$k*D$h+D$j*D$A,D$e[12]=D$Z*D$T+D$H*D$Y+D$x,D$e[13]=D$h*D$T+D$A*D$Y+D$B):(D$e[0]=D$U*D$Z,D$e[1]=D$m*D$A,D$e[4]=D$k*D$Z,D$e[5]=D$j*D$A,D$e[12]=D$Z*D$T+D$x,D$e[13]=D$A*D$Y+D$B),D$e},D$e.mulPre=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){var D$Y=D$s.a,D$Z=D$s.b,D$h=D$s.c,D$H=D$s.d,D$A=D$s.tx,D$x=D$s.ty;return 0!==D$e||0!==D$U?(D$T.a=D$Y*D$r+D$Z*D$U,D$T.b=D$Y*D$e+D$Z*D$m,D$T.c=D$h*D$r+D$H*D$U,D$T.d=D$h*D$e+D$H*D$m,D$T.tx=D$r*D$A+D$U*D$x+D$k,D$T.ty=D$e*D$A+D$m*D$x+D$j):(D$T.a=D$Y*D$r,D$T.b=D$Z*D$m,D$T.c=D$h*D$r,D$T.d=D$H*D$m,D$T.tx=D$r*D$A+D$k,D$T.ty=D$m*D$x+D$j),D$T},D$e.mulPos=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){var D$Y=D$s.a,D$Z=D$s.b,D$h=D$s.c,D$H=D$s.d,D$A=D$s.tx,D$x=D$s.ty;return 0!==D$Z||0!==D$h?(D$T.a=D$r*D$Y+D$e*D$h,D$T.b=D$r*D$Z+D$e*D$H,D$T.c=D$U*D$Y+D$m*D$h,D$T.d=D$U*D$Z+D$m*D$H,D$T.tx=D$Y*D$k+D$h*D$j+D$A,D$T.ty=D$Z*D$k+D$H*D$j+D$x):(D$T.a=D$r*D$Y,D$T.b=D$e*D$H,D$T.c=D$U*D$Y,D$T.d=D$m*D$H,D$T.tx=D$Y*D$k+D$A,D$T.ty=D$H*D$j+D$x),D$T},D$e.preMul=function(D$s,D$r,D$e){var D$U=D$s.a,D$m=D$s.b,D$k=D$s.c,D$j=D$s.d,D$T=D$r.a,D$Y=D$r.b,D$Z=D$r.c,D$h=D$r.d,D$H=D$r.tx,D$A=D$r.ty;return D$e.a=D$T*D$U,D$e.b=D$e.c=0,D$e.d=D$h*D$j,D$e.tx=D$H*D$U+D$s.tx,D$e.ty=D$A*D$j+D$s.ty,0===D$Y&&0===D$Z&&0===D$m&&0===D$k||(D$e.a+=D$Y*D$k,D$e.d+=D$Z*D$m,D$e.b+=D$T*D$m+D$Y*D$j,D$e.c+=D$Z*D$U+D$h*D$k,D$e.tx+=D$A*D$k,D$e.ty+=D$H*D$m),D$e},D$e.preMulXY=function(D$s,D$r,D$e,D$U){var D$m=D$s.a,D$k=D$s.b,D$j=D$s.c,D$T=D$s.d;return D$U.a=D$m,D$U.b=D$k,D$U.c=D$j,D$U.d=D$T,D$U.tx=D$r*D$m+D$s.tx+D$e*D$j,D$U.ty=D$e*D$T+D$s.ty+D$r*D$k,D$U},D$e.create=function(){var D$s=D$e._cache,D$r=D$s._length?D$s[--D$s._length]:new D$e;return D$r.inPool=!1,D$r},D$e.EMPTY=new D$e,D$e.TEMP=new D$e,D$e._cache=[],D$e}(),D$n=function(){function D$s(D$s,D$r){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),this.x=D$s,this.y=D$r}D$h(D$s,"laya.maths.Point");var D$r=D$s.prototype;return D$r.setTo=function(D$s,D$r){return this.x=D$s,this.y=D$r,this},D$r.distance=function(D$s,D$r){return Math.sqrt((this.x-D$s)*(this.x-D$s)+(this.y-D$r)*(this.y-D$r))},D$r.toString=function(){return this.x+","+this.y},D$r.normalize=function(){var D$s=Math.sqrt(this.x*this.x+this.y*this.y);if(0<D$s){var D$r=1/D$s;this.x*=D$r,this.y*=D$r}},D$s.TEMP=new D$s,D$s.EMPTY=new D$s,D$s}(),D$y=function(){function D$Z(D$s,D$r,D$e,D$U){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0),this.x=D$s,this.y=D$r,this.width=D$e,this.height=D$U}D$h(D$Z,"laya.maths.Rectangle");var D$s=D$Z.prototype;return D$s.setTo=function(D$s,D$r,D$e,D$U){return this.x=D$s,this.y=D$r,this.width=D$e,this.height=D$U,this},D$s.copyFrom=function(D$s){return this.x=D$s.x,this.y=D$s.y,this.width=D$s.width,this.height=D$s.height,this},D$s.contains=function(D$s,D$r){return!(this.width<=0||this.height<=0)&&(D$s>=this.x&&D$s<this.right&&D$r>=this.y&&D$r<this.bottom)},D$s.intersects=function(D$s){return!(D$s.x>this.x+this.width||D$s.x+D$s.width<this.x||D$s.y>this.y+this.height||D$s.y+D$s.height<this.y)},D$s.intersection=function(D$s,D$r){return this.intersects(D$s)?(D$r||(D$r=new D$Z),D$r.x=Math.max(this.x,D$s.x),D$r.y=Math.max(this.y,D$s.y),D$r.width=Math.min(this.right,D$s.right)-D$r.x,D$r.height=Math.min(this.bottom,D$s.bottom)-D$r.y,D$r):null},D$s.union=function(D$s,D$r){return D$r||(D$r=new D$Z),this.clone(D$r),D$s.width<=0||D$s.height<=0?D$r:(D$r.addPoint(D$s.x,D$s.y),D$r.addPoint(D$s.right,D$s.bottom),this)},D$s.clone=function(D$s){return D$s||(D$s=new D$Z),D$s.x=this.x,D$s.y=this.y,D$s.width=this.width,D$s.height=this.height,D$s},D$s.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},D$s.equals=function(D$s){return!(!D$s||D$s.x!==this.x||D$s.y!==this.y||D$s.width!==this.width||D$s.height!==this.height)},D$s.addPoint=function(D$s,D$r){return this.x>D$s&&(this.width+=this.x-D$s,this.x=D$s),this.y>D$r&&(this.height+=this.y-D$r,this.y=D$r),this.width<D$s-this.x&&(this.width=D$s-this.x),this.height<D$r-this.y&&(this.height=D$r-this.y),this},D$s._getBoundPoints=function(){var D$s=D$Z._temB;return(D$s.length=0)==this.width||0==this.height||D$s.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),D$s},D$s.isEmpty=function(){return this.width<=0||this.height<=0},D$B(0,D$s,"right",function(){return this.x+this.width}),D$B(0,D$s,"bottom",function(){return this.y+this.height}),D$Z._getBoundPointS=function(D$s,D$r,D$e,D$U){var D$m=D$Z._temA;return(D$m.length=0)==D$e||0==D$U||D$m.push(D$s,D$r,D$s+D$e,D$r,D$s,D$r+D$U,D$s+D$e,D$r+D$U),D$m},D$Z._getWrapRec=function(D$s,D$r){if(!D$s||D$s.length<1)return D$r?D$r.setTo(0,0,0,0):D$Z.TEMP.setTo(0,0,0,0);D$r=D$r||new D$Z;var D$e,D$U,D$m,D$k,D$j,D$T=D$s.length,D$Y=D$n.TEMP;for(D$m=D$j=-(D$U=D$k=99999),D$e=0;D$e<D$T;D$e+=2)D$Y.x=D$s[D$e],D$Y.y=D$s[D$e+1],D$U=D$U<D$Y.x?D$U:D$Y.x,D$k=D$k<D$Y.y?D$k:D$Y.y,D$m=D$m>D$Y.x?D$m:D$Y.x,D$j=D$j>D$Y.y?D$j:D$Y.y;return D$r.setTo(D$U,D$k,D$m-D$U,D$j-D$k)},D$Z.EMPTY=new D$Z,D$Z.TEMP=new D$Z,D$Z._temB=[],D$Z._temA=[],D$Z}(),D$J=function(){function D$Y(){}return D$h(D$Y,"laya.media.SoundManager"),D$B(1,D$Y,"useAudioMusic",function(){return D$Y._useAudioMusic},function(D$s){D$Y._useAudioMusic=D$s,D$Y._musicClass=D$s?D$es:null}),D$B(1,D$Y,"autoStopMusic",function(){return D$Y._autoStopMusic},function(D$s){D$D.stage.off("blur",null,D$Y._stageOnBlur),D$D.stage.off("focus",null,D$Y._stageOnFocus),D$D.stage.off("visibilitychange",null,D$Y._visibilityChange),(D$Y._autoStopMusic=D$s)&&(D$D.stage.on("blur",null,D$Y._stageOnBlur),D$D.stage.on("focus",null,D$Y._stageOnFocus),D$D.stage.on("visibilitychange",null,D$Y._visibilityChange))}),D$B(1,D$Y,"muted",function(){return D$Y._muted},function(D$s){D$s!=D$Y._muted&&(D$s&&D$Y.stopAllSound(),D$Y.musicMuted=D$s,D$Y._muted=D$s)}),D$B(1,D$Y,"musicMuted",function(){return D$Y._musicMuted},function(D$s){D$s!=D$Y._musicMuted&&(D$s?(D$Y._tMusic&&D$Y._musicChannel&&!D$Y._musicChannel.isStopped?D$Y._musicChannel.pause():D$Y._musicChannel=null,D$Y._musicMuted=D$s):(D$Y._musicMuted=D$s,D$Y._tMusic&&D$Y._musicChannel&&D$Y._musicChannel.resume()))}),D$B(1,D$Y,"soundMuted",function(){return D$Y._soundMuted},function(D$s){D$Y._soundMuted=D$s}),D$Y.addChannel=function(D$s){0<=D$Y._channels.indexOf(D$s)||(D$Y._channels.push(D$s),D$Y.autoReleaseSound&&0!=D$Y._notUsedCount&&D$Y._notUsedUrls[D$s.url]&&(delete D$Y._notUsedUrls[D$s.url],0==--D$Y._notUsedCount&&D$D.timer.clear(D$Y,D$Y.disposeSoundIfNotUsed)))},D$Y.removeChannel=function(D$s){var D$r=D$Y._channels,D$e=D$r.indexOf(D$s);if(-1!=D$e&&(D$r.splice(D$e,1),D$Y.autoReleaseSound)){var D$U=D$s.url,D$m=D$Y.defaultIntervals[D$U]||2e4;if(0<D$m){var D$k=!0;for(D$e=D$r.length-1;0<=D$e;D$e--)if(D$r[D$e].url==D$U){D$k=!1;break}D$k&&(D$Y._notUsedUrls[D$U]=Date.now()+D$m,0==D$Y._notUsedCount++&&D$D.timer.loop(1e4,D$Y,D$Y.disposeSoundIfNotUsed))}}},D$Y.disposeSoundIfNotUsed=function(){var D$s=D$Y._notUsedUrls;if(0!=D$Y._notUsedCount){var D$r=Date.now();for(var D$e in D$s)D$r>=D$s[D$e]&&(delete D$s[D$e],--D$Y._notUsedCount,D$Y.destroySound(D$e));if(0!=D$Y._notUsedCount)return}D$D.timer.clear(D$Y,D$Y.disposeSoundIfNotUsed)},D$Y._visibilityChange=function(){D$D.stage.isVisibility?D$Y._stageOnFocus():D$Y._stageOnBlur()},D$Y._stageOnBlur=function(){D$Y._isActive=!1,D$Y._musicChannel&&(D$Y._musicChannel.isStopped||(D$Y._blurPaused=!0,D$Y._musicChannel.pause())),D$Y.stopAllSound(),D$D.stage.once("mousedown",null,D$Y._stageOnFocus)},D$Y._recoverWebAudio=function(){D$ks.ctx&&"running"!=D$ks.ctx.state&&D$ks.ctx.resume&&D$ks.ctx.resume()},D$Y._stageOnFocus=function(){if(D$Y._isActive=!0,D$Y._recoverWebAudio(),D$D.stage.off("mousedown",null,D$Y._stageOnFocus),D$Y._blurPaused){var D$s=D$Y._musicChannel;D$s&&D$Y._music&&D$s.isStopped&&(D$Y._blurPaused=!1,D$Y._music._disposed?D$Y.playMusic(D$s.url,D$s.loops,D$s.startHandler,D$s.completeHandler,D$s.startTime):D$s.audioBuffer?D$s.resume():D$Y._music.play(D$s.startTime,D$s.loops,D$s.startHandler,D$s))}},D$Y.playSound=function(D$s,D$r,D$e,D$U,D$m,D$k){if(void 0===D$r&&(D$r=1),void 0===D$k&&(D$k=0),!D$s)return null;if(D$Y._muted)return null;if(D$Y._recoverWebAudio(),D$s==D$Y._tMusic){if(D$Y._musicMuted)return null}else{if(!D$Y._isActive)return null;if(D$Y._soundMuted)return null}var D$j,D$T=D$Y._pool[D$s];return D$m||(D$m=D$Y._soundClass),D$T||((D$T=new D$m).load(D$s),D$Y._pool[D$s]=D$T),(D$j=D$T.play(D$k,D$r,D$e))?(D$s==D$Y._tMusic&&(D$Y._music=D$T,D$Y._isActive||(D$Y._blurPaused=!0,D$j.pause())),D$j.url=D$s,D$j.volume=D$s==D$Y._tMusic?D$Y.musicVolume:D$Y.soundVolume,D$j.completeHandler=D$U,D$j):null},D$Y.destroySound=function(D$s){var D$r=D$Y._pool[D$s];D$r&&(delete D$Y._pool[D$s],D$r.dispose())},D$Y.playMusic=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$r&&(D$r=0),void 0===D$m&&(D$m=0),D$Y._tMusic=D$s,D$Y._musicChannel&&D$Y._musicChannel.stop(),D$Y._musicChannel=D$Y.playSound(D$s,D$r,D$e,D$U,null,D$m)},D$Y.stopSound=function(D$s){for(var D$r,D$e=D$Y._channels.length-1;0<=D$e;D$e--)(D$r=D$Y._channels[D$e]).url==D$s&&D$r.stop()},D$Y.stopAll=function(){D$Y._tMusic=null;var D$s=0;for(D$s=D$Y._channels.length-1;0<=D$s;D$s--)D$Y._channels[D$s].stop()},D$Y.stopAllSound=function(){var D$s,D$r=0;for(D$r=D$Y._channels.length-1;0<=D$r;D$r--)(D$s=D$Y._channels[D$r]).url!=D$Y._tMusic&&D$s.stop()},D$Y.stopMusic=function(){D$Y._musicChannel&&D$Y._musicChannel.stop(),D$Y._tMusic=null},D$Y.setSoundVolume=function(D$s,D$r){if(D$r)D$Y._setVolume(D$r,D$s);else{D$Y.soundVolume=D$s;var D$e,D$U=0;for(D$U=D$Y._channels.length-1;0<=D$U;D$U--)(D$e=D$Y._channels[D$U]).url!=D$Y._tMusic&&(D$e.volume=D$s)}},D$Y.setMusicVolume=function(D$s){D$Y.musicVolume=D$s,D$Y._setVolume(D$Y._tMusic,D$s)},D$Y._setVolume=function(D$s,D$r){for(var D$e,D$U=D$Y._channels.length-1;0<=D$U;D$U--)(D$e=D$Y._channels[D$U]).url==D$s&&(D$e.volume=D$r)},D$Y.musicVolume=1,D$Y.soundVolume=1,D$Y.playbackRate=1,D$Y._useAudioMusic=!0,D$Y._muted=!1,D$Y._soundMuted=!1,D$Y._musicMuted=!1,D$Y._tMusic=null,D$Y._musicChannel=null,D$Y._music=null,D$Y._channels=[],D$Y._autoStopMusic=!1,D$Y._blurPaused=!1,D$Y._isActive=!0,D$Y._soundClass=null,D$Y._musicClass=null,D$Y.autoReleaseSound=!0,D$Y._pool={},D$Y.defaultIntervals={},D$Y._notUsedUrls={},D$Y._notUsedCount=0,D$Y}(),D$g=function(){var D$s;function D$e(){}return D$h(D$e,"laya.net.LocalStorage"),D$e.__init__=function(){D$e._baseClass||(D$e._baseClass=D$s).init(),D$e.items=D$e._baseClass.items,D$e.support=D$e._baseClass.support},D$e.setItem=function(D$s,D$r){D$e._baseClass.setItem(D$s,D$r)},D$e.getItem=function(D$s){return D$e._baseClass.getItem(D$s)},D$e.setJSON=function(D$s,D$r){D$e._baseClass.setJSON(D$s,D$r)},D$e.getJSON=function(D$s){return D$e._baseClass.getJSON(D$s)},D$e.removeItem=function(D$s){D$e._baseClass.removeItem(D$s)},D$e.clear=function(){D$e._baseClass.clear()},D$e._baseClass=null,D$e.items=null,D$e.support=!1,D$e.__init$=function(){D$s=function(){function D$e(){}return D$h(D$e,""),D$e.init=function(){try{D$e.support=!0,D$e.items=D$j.localStorage,D$e.setItem("laya","1"),D$e.removeItem("laya")}catch(D$s){D$e.support=!1}D$e.support||console.log("LocalStorage is not supprot or browser is private mode.")},D$e.setItem=function(D$s,D$r){try{D$e.support&&D$e.items.setItem(D$s,D$r)}catch(D$s){console.warn("set localStorage failed",D$s)}},D$e.getItem=function(D$s){return D$e.support?D$e.items.getItem(D$s):null},D$e.setJSON=function(D$s,D$r){try{D$e.support&&D$e.items.setItem(D$s,JSON.stringify(D$r))}catch(D$s){console.warn("set localStorage failed",D$s)}},D$e.getJSON=function(D$s){return JSON.parse(D$e.support?D$e.items.getItem(D$s):null)},D$e.removeItem=function(D$s){D$e.support&&D$e.items.removeItem(D$s)},D$e.clear=function(){D$e.support&&D$e.items.clear()},D$e.items=null,D$e.support=!1,D$e}()},D$e}(),D$i=(function(){function D$U(){}D$h(D$U,"laya.net.ResourceVersion"),D$U.enable=function(D$s,D$r,D$e){void 0===D$e&&(D$e=2),laya.net.ResourceVersion.type=D$e,D$D.loader.load(D$s,D$b.create(null,D$U.onManifestLoaded,[D$r]),null,"json"),D$K.customFormat=D$U.addVersionPrefix},D$U.onManifestLoaded=function(D$s,D$r){D$U.manifest=D$r,D$s.run(),D$r||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},D$U.addVersionPrefix=function(D$s){return D$U.manifest&&D$U.manifest[D$s]?2==D$U.type?D$U.manifest[D$s]:D$U.manifest[D$s]+"/"+D$s:D$s},D$U.FOLDER_VERSION=1,D$U.FILENAME_VERSION=2,D$U.manifest=null,D$U.type=1}(),function(){function D$s(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}D$h(D$s,"laya.net.TTFLoader");var D$r=D$s.prototype;return D$r.load=function(D$s){var D$r=(this._url=D$s).split(".ttf")[0].split("/");this.fontName=D$r[D$r.length-1],D$Q.window.conch?this._loadConch():D$Q.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},D$r._loadConch=function(){this._http=new D$js,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},D$r._onHttpLoaded=function(D$s){D$Q.window.conch.setFontFaceFromBuffer(this.fontName,D$s),this._clearHttp(),this._complete()},D$r._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},D$r._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},D$r._complete=function(){D$D.timer.clear(this,this._complete),D$D.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},D$r._checkComplete=function(){D$P.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},D$r._loadWithFontFace=function(){var D$s=new D$Q.window.FontFace(this.fontName,"url('"+this._url+"')");D$Q.window.document.fonts.add(D$s);var D$r=this;D$s.loaded.then(function(){D$r._complete()}),D$s.load()},D$r._createDiv=function(){this._div=D$Q.createElement("div"),this._div.innerHTML="laya";var D$s=this._div.style;D$s.fontFamily=this.fontName,D$s.position="absolute",D$s.left="-100px",D$s.top="-100px",D$Q.document.body.appendChild(this._div)},D$r._loadWithCSS=function(){var D$s=this,D$r=D$Q.createElement("style");D$r.type="text/css",D$Q.document.body.appendChild(D$r),D$r.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=D$P.measureText("LayaTTFFont",this._fontTxt).width;var D$e=this;D$r.onload=function(){D$D.timer.once(1e4,D$e,D$s._complete)},D$D.timer.loop(20,this,this._checkComplete),this._createDiv()},D$s._testString="LayaTTFFont",D$s}()),D$K=function(){function D$U(D$s){this._url=null,this._path=null,this._url=D$U.formatURL(D$s),this._path=D$U.getPath(D$s)}D$h(D$U,"laya.net.URL");var D$s=D$U.prototype;return D$B(0,D$s,"path",function(){return this._path}),D$B(0,D$s,"url",function(){return this._url}),D$U.formatURL=function(D$s,D$r){if(!D$s)return"null path";if(0<D$s.indexOf(":"))return D$s;null!=D$U.customFormat&&(D$s=D$U.customFormat(D$s,D$r));var D$e=D$s.charAt(0);if("."===D$e)return D$U.formatRelativePath((D$r||D$U.basePath)+D$s);if("~"===D$e)return D$U.rootPath+D$s.substring(1);if("d"===D$e){if(0===D$s.indexOf("data:image"))return D$s}else if("/"===D$e)return D$s;return(D$r||D$U.basePath)+D$s},D$U.formatRelativePath=function(D$s){for(var D$r=D$s.split("/"),D$e=0,D$U=D$r.length;D$e<D$U;D$e++)".."==D$r[D$e]&&(D$r.splice(D$e-1,2),D$e-=2);return D$r.join("/")},D$U.isAbsolute=function(D$s){return 0<D$s.indexOf(":")||"/"==D$s.charAt(0)},D$U.getPath=function(D$s){var D$r=D$s.lastIndexOf("/");return 0<D$r?D$s.substr(0,D$r+1):""},D$U.getFileName=function(D$s){var D$r=D$s.lastIndexOf("/");return 0<D$r?D$s.substr(D$r+1):D$s},D$U.version={},D$U.basePath="",D$U.rootPath="",D$U.customFormat=function(D$s){var D$r=D$U.version[D$s];return!D$c.isConchApp&&D$r&&(D$s+="?v="+D$r),D$s},D$U}(),D$c=function(){function D$m(D$s,D$r){this._timeId=0;var D$e=D$m._mainCanvas.source.style;D$e.position="absolute",D$e.top=D$e.left="0px",D$e.background="#000000",D$m._mainCanvas.source.id="layaCanvas";var D$U=laya.renders.Render.isWebGL;D$m._mainCanvas.source.width=D$s,D$m._mainCanvas.source.height=D$r,D$U&&D$m.WebGL.init(D$m._mainCanvas,D$s,D$r),D$Q.container.appendChild(D$m._mainCanvas.source),(D$m._context=new D$E(D$s,D$r,D$U?null:D$m._mainCanvas)).ctx.setIsMainContext(),D$Q.window.requestAnimationFrame(function D$s(D$r){D$Q.window.requestAnimationFrame(D$s);D$D.stage._loop()}),D$D.stage.on("visibilitychange",this,this._onVisibilitychange)}D$h(D$m,"laya.renders.Render");var D$s=D$m.prototype;return D$s._onVisibilitychange=function(){D$D.stage.isVisibility?0!=this._timeId&&D$Q.window.clearInterval(this._timeId):this._timeId=D$Q.window.setInterval(this._enterFrame,1e3)},D$s._enterFrame=function(D$s){D$D.stage._loop()},D$B(1,D$m,"context",function(){return D$m._context}),D$B(1,D$m,"canvas",function(){return D$m._mainCanvas.source}),D$m._context=null,D$m._mainCanvas=null,D$m.WebGL=null,D$m.isConchNode=!1,D$m.isConchApp=!1,D$m.isConchWebGL=!1,D$m.isWebGL=!1,D$m.is3DMode=!1,D$m.optimizeTextureMemory=function(D$s,D$r){return!0},D$m.__init$=function(){D$j.ConchRenderType=D$j.ConchRenderType||1,D$j.ConchRenderType|=D$j.conch?4:0,D$m.isConchNode=5==(5&D$j.ConchRenderType),D$m.isConchApp=4==(4&D$j.ConchRenderType),D$m.isConchWebGL=6==D$j.ConchRenderType},D$m}(),D$E=function(){function D$j(D$s,D$r,D$e){this.x=0,this.y=0,this._drawTexture=function(D$s,D$r,D$e){D$e[0].loaded&&this.ctx.drawTexture(D$e[0],D$e[1],D$e[2],D$e[3],D$e[4],D$s,D$r)},this._fillTexture=function(D$s,D$r,D$e){D$e[0].loaded&&this.ctx.fillTexture(D$e[0],D$e[1]+D$s,D$e[2]+D$r,D$e[3],D$e[4],D$e[5],D$e[6],D$e[7])},this._drawTextureWithTransform=function(D$s,D$r,D$e){D$e[0].loaded&&this.ctx.drawTextureWithTransform(D$e[0],D$e[1],D$e[2],D$e[3],D$e[4],D$e[5],D$s,D$r,D$e[6])},this._fillQuadrangle=function(D$s,D$r,D$e){this.ctx.fillQuadrangle(D$e[0],D$e[1],D$e[2],D$e[3],D$e[4])},this._drawRect=function(D$s,D$r,D$e){var D$U=this.ctx;null!=D$e[4]&&(D$U.fillStyle=D$e[4],D$U.fillRect(D$s+D$e[0],D$r+D$e[1],D$e[2],D$e[3],null)),null!=D$e[5]&&(D$U.strokeStyle=D$e[5],D$U.lineWidth=D$e[6],D$U.strokeRect(D$s+D$e[0],D$r+D$e[1],D$e[2],D$e[3],D$e[6]))},this._drawPie=function(D$s,D$r,D$e){var D$U=this.ctx;D$c.isWebGL&&D$U.setPathId(D$e[8]),D$U.beginPath(),D$c.isWebGL?(D$U.movePath(D$e[0]+D$s,D$e[1]+D$r),D$U.moveTo(0,0)):D$U.moveTo(D$s+D$e[0],D$r+D$e[1]),D$U.arc(D$s+D$e[0],D$r+D$e[1],D$e[2],D$e[3],D$e[4]),D$U.closePath(),this._fillAndStroke(D$e[5],D$e[6],D$e[7],!0)},this._clipRect=function(D$s,D$r,D$e){this.ctx.clipRect(D$s+D$e[0],D$r+D$e[1],D$e[2],D$e[3])},this._fillRect=function(D$s,D$r,D$e){this.ctx.fillRect(D$s+D$e[0],D$r+D$e[1],D$e[2],D$e[3],D$e[4])},this._drawCircle=function(D$s,D$r,D$e){var D$U=this.ctx;D$c.isWebGL&&D$U.setPathId(D$e[6]),D$t.drawCall++,D$U.beginPath(),D$c.isWebGL&&D$U.movePath(D$e[0]+D$s,D$e[1]+D$r),D$U.arc(D$e[0]+D$s,D$e[1]+D$r,D$e[2],0,D$j.PI2),D$U.closePath(),this._fillAndStroke(D$e[3],D$e[4],D$e[5],!0)},this._fillCircle=function(D$s,D$r,D$e){D$t.drawCall++;var D$U=this.ctx;D$U.beginPath(),D$U.fillStyle=D$e[3],D$U.arc(D$e[0]+D$s,D$e[1]+D$r,D$e[2],0,D$j.PI2),D$U.fill()},this._setShader=function(D$s,D$r,D$e){this.ctx.setShader(D$e[0])},this._drawLine=function(D$s,D$r,D$e){var D$U=this.ctx;D$c.isWebGL&&D$U.setPathId(D$e[6]),D$U.beginPath(),D$U.strokeStyle=D$e[4],D$U.lineWidth=D$e[5],D$c.isWebGL?(D$U.movePath(D$s,D$r),D$U.moveTo(D$e[0],D$e[1]),D$U.lineTo(D$e[2],D$e[3])):(D$U.moveTo(D$s+D$e[0],D$r+D$e[1]),D$U.lineTo(D$s+D$e[2],D$r+D$e[3])),D$U.stroke()},this._drawLines=function(D$s,D$r,D$e){var D$U=this.ctx;D$c.isWebGL&&D$U.setPathId(D$e[5]),D$U.beginPath(),D$s+=D$e[0],D$r+=D$e[1],D$c.isWebGL&&D$U.movePath(D$s,D$r),D$U.strokeStyle=D$e[3],D$U.lineWidth=D$e[4];var D$m=D$e[2],D$k=2,D$j=D$m.length;if(D$c.isWebGL)for(D$U.moveTo(D$m[0],D$m[1]);D$k<D$j;)D$U.lineTo(D$m[D$k++],D$m[D$k++]);else for(D$U.moveTo(D$s+D$m[0],D$r+D$m[1]);D$k<D$j;)D$U.lineTo(D$s+D$m[D$k++],D$r+D$m[D$k++]);D$U.stroke()},this._drawLinesWebGL=function(D$s,D$r,D$e){this.ctx.drawLines(D$s+this.x+D$e[0],D$r+this.y+D$e[1],D$e[2],D$e[3],D$e[4])},this._drawCurves=function(D$s,D$r,D$e){this.ctx.drawCurves(D$s,D$r,D$e)},this._draw=function(D$s,D$r,D$e){D$e[0].call(null,this,D$s,D$r)},this._transformByMatrix=function(D$s,D$r,D$e){this.ctx.transformByMatrix(D$e[0])},this._setTransform=function(D$s,D$r,D$e){this.ctx.setTransform(D$e[0],D$e[1],D$e[2],D$e[3],D$e[4],D$e[5])},this._setTransformByMatrix=function(D$s,D$r,D$e){this.ctx.setTransformByMatrix(D$e[0])},this._save=function(D$s,D$r,D$e){this.ctx.save()},this._restore=function(D$s,D$r,D$e){this.ctx.restore()},this._translate=function(D$s,D$r,D$e){this.ctx.translate(D$e[0],D$e[1])},this._transform=function(D$s,D$r,D$e){this.ctx.translate(D$e[1]+D$s,D$e[2]+D$r);var D$U=D$e[0];this.ctx.transform(D$U.a,D$U.b,D$U.c,D$U.d,D$U.tx,D$U.ty),this.ctx.translate(-D$s-D$e[1],-D$r-D$e[2])},this._rotate=function(D$s,D$r,D$e){this.ctx.translate(D$e[1]+D$s,D$e[2]+D$r),this.ctx.rotate(D$e[0]),this.ctx.translate(-D$s-D$e[1],-D$r-D$e[2])},this._scale=function(D$s,D$r,D$e){this.ctx.translate(D$e[2]+D$s,D$e[3]+D$r),this.ctx.scale(D$e[0],D$e[1]),this.ctx.translate(-D$s-D$e[2],-D$r-D$e[3])},this._alpha=function(D$s,D$r,D$e){this.ctx.globalAlpha*=D$e[0]},this._setAlpha=function(D$s,D$r,D$e){this.ctx.globalAlpha=D$e[0]},this._fillText=function(D$s,D$r,D$e){this.ctx.fillText(D$e[0],D$e[1]+D$s,D$e[2]+D$r,D$e[3],D$e[4],D$e[5])},this._strokeText=function(D$s,D$r,D$e){this.ctx.strokeText(D$e[0],D$e[1]+D$s,D$e[2]+D$r,D$e[3],D$e[4],D$e[5],D$e[6])},this._fillBorderText=function(D$s,D$r,D$e){this.ctx.fillBorderText(D$e[0],D$e[1]+D$s,D$e[2]+D$r,D$e[3],D$e[4],D$e[5],D$e[6],D$e[7])},this._blendMode=function(D$s,D$r,D$e){this.ctx.globalCompositeOperation=D$e[0]},this._beginClip=function(D$s,D$r,D$e){this.ctx.beginClip&&this.ctx.beginClip(D$s+D$e[0],D$r+D$e[1],D$e[2],D$e[3])},this._setIBVB=function(D$s,D$r,D$e){this.ctx.setIBVB(D$e[0]+D$s,D$e[1]+D$r,D$e[2],D$e[3],D$e[4],D$e[5],D$e[6],D$e[7])},this._fillTrangles=function(D$s,D$r,D$e){this.ctx.fillTrangles(D$e[0],D$e[1]+D$s,D$e[2]+D$r,D$e[3],D$e[4])},this._drawPath=function(D$s,D$r,D$e){var D$U=this.ctx;D$c.isWebGL&&D$U.setPathId(-1),D$U.beginPath(),D$s+=D$e[0],D$r+=D$e[1],D$c.isWebGL&&D$U.movePath(D$s,D$r);for(var D$m=D$e[2],D$k=0,D$j=D$m.length;D$k<D$j;D$k++){var D$T=D$m[D$k];switch(D$T[0]){case"moveTo":D$c.isWebGL?D$U.moveTo(D$T[1],D$T[2]):D$U.moveTo(D$s+D$T[1],D$r+D$T[2]);break;case"lineTo":D$c.isWebGL?D$U.lineTo(D$T[1],D$T[2]):D$U.lineTo(D$s+D$T[1],D$r+D$T[2]);break;case"arcTo":D$c.isWebGL?D$U.arcTo(D$T[1],D$T[2],D$T[3],D$T[4],D$T[5]):D$U.arcTo(D$s+D$T[1],D$r+D$T[2],D$s+D$T[3],D$r+D$T[4],D$T[5]);break;case"closePath":D$U.closePath()}}var D$Y=D$e[3];null!=D$Y&&(D$U.fillStyle=D$Y.fillStyle,D$U.fill());var D$Z=D$e[4];null!=D$Z&&(D$U.strokeStyle=D$Z.strokeStyle,D$U.lineWidth=D$Z.lineWidth||1,D$U.lineJoin=D$Z.lineJoin,D$U.lineCap=D$Z.lineCap,D$U.miterLimit=D$Z.miterLimit,D$U.stroke())},this.drawPoly=function(D$s,D$r,D$e){this.ctx.drawPoly(D$s+this.x+D$e[0],D$r+this.y+D$e[1],D$e[2],D$e[3],D$e[4],D$e[5],D$e[6])},this._drawPoly=function(D$s,D$r,D$e){var D$U=this.ctx,D$m=D$e[2],D$k=2,D$j=D$m.length;if(D$c.isWebGL)for(D$U.setPathId(D$e[6]),D$U.beginPath(),D$s+=D$e[0],D$r+=D$e[1],D$U.movePath(D$s,D$r),D$U.moveTo(D$m[0],D$m[1]);D$k<D$j;)D$U.lineTo(D$m[D$k++],D$m[D$k++]);else for(D$U.beginPath(),D$s+=D$e[0],D$r+=D$e[1],D$U.moveTo(D$s+D$m[0],D$r+D$m[1]);D$k<D$j;)D$U.lineTo(D$s+D$m[D$k++],D$r+D$m[D$k++]);D$U.closePath(),this._fillAndStroke(D$e[3],D$e[4],D$e[5],D$e[7])},this._drawSkin=function(D$s,D$r,D$e){var D$U=D$e[0];if(D$U){var D$m=this.ctx;D$U.render(D$m,D$s,D$r)}},this._drawParticle=function(D$s,D$r,D$e){this.ctx.drawParticle(D$s+this.x,D$r+this.y,D$e[0])},this._setFilters=function(D$s,D$r,D$e){this.ctx.setFilters(D$e)},D$e?this.ctx=D$e.getContext("2d"):(D$e=D$os.create("3D"),this.ctx=D$P.createWebGLContext2D(D$e),D$e._setContext(this.ctx)),D$e.size(D$s,D$r),this.canvas=D$e}D$h(D$j,"laya.renders.RenderContext");var D$s=D$j.prototype;return D$s.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},D$s.drawTexture=function(D$s,D$r,D$e,D$U,D$m){D$s.loaded&&this.ctx.drawTexture(D$s,D$r,D$e,D$U,D$m,this.x,this.y)},D$s._drawTextures=function(D$s,D$r,D$e){D$e[0].loaded&&this.ctx.drawTextures(D$e[0],D$e[1],D$s+this.x,D$r+this.y)},D$s.drawTextureWithTransform=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$s.loaded&&this.ctx.drawTextureWithTransform(D$s,D$r,D$e,D$U,D$m,D$k,this.x,this.y,D$j)},D$s.fillQuadrangle=function(D$s,D$r,D$e,D$U,D$m){this.ctx.fillQuadrangle(D$s,D$r,D$e,D$U,D$m)},D$s.drawCanvas=function(D$s,D$r,D$e,D$U,D$m){this.ctx.drawCanvas(D$s,D$r+this.x,D$e+this.y,D$U,D$m)},D$s.drawRect=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$k&&(D$k=1);var D$j=this.ctx;D$j.strokeStyle=D$m,D$j.lineWidth=D$k,D$j.strokeRect(D$s+this.x,D$r+this.y,D$e,D$U,D$k)},D$s._fillAndStroke=function(D$s,D$r,D$e,D$U){void 0===D$U&&(D$U=!1);var D$m=this.ctx;null!=D$s&&(D$m.fillStyle=D$s,D$c.isWebGL?D$m.fill(D$U):D$m.fill()),null!=D$r&&0<D$e&&(D$m.strokeStyle=D$r,D$m.lineWidth=D$e,D$m.stroke())},D$s.clipRect=function(D$s,D$r,D$e,D$U){this.ctx.clipRect(D$s+this.x,D$r+this.y,D$e,D$U)},D$s.fillRect=function(D$s,D$r,D$e,D$U,D$m){this.ctx.fillRect(D$s+this.x,D$r+this.y,D$e,D$U,D$m)},D$s.drawCircle=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=1),D$t.drawCall++;var D$k=this.ctx;D$k.beginPath(),D$k.strokeStyle=D$U,D$k.lineWidth=D$m,D$k.arc(D$s+this.x,D$r+this.y,D$e,0,D$j.PI2),D$k.stroke()},D$s.drawTriangles=function(D$s,D$r,D$e){if(D$c.isWebGL)this.ctx.drawTriangles(D$e[0],D$s+D$e[1],D$r+D$e[2],D$e[3],D$e[4],D$e[5],D$e[6],D$e[7],D$e[8],D$e[9]);else{var D$U=D$e[5],D$m=0,D$k=D$U.length,D$j=this.ctx;for(D$m=0;D$m<D$k;D$m+=3){var D$T=2*D$U[D$m],D$Y=2*D$U[D$m+1],D$Z=2*D$U[D$m+2];D$j.drawTriangle(D$e[0],D$e[3],D$e[4],D$T,D$Y,D$Z,D$e[6],!0)}}},D$s.fillCircle=function(D$s,D$r,D$e,D$U){D$t.drawCall++;var D$m=this.ctx;D$m.beginPath(),D$m.fillStyle=D$U,D$m.arc(D$s+this.x,D$r+this.y,D$e,0,D$j.PI2),D$m.fill()},D$s.setShader=function(D$s){this.ctx.setShader(D$s)},D$s.drawLine=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$k&&(D$k=1);var D$j=this.ctx;D$j.beginPath(),D$j.strokeStyle=D$m,D$j.lineWidth=D$k,D$j.moveTo(this.x+D$s,this.y+D$r),D$j.lineTo(this.x+D$e,this.y+D$U),D$j.stroke()},D$s.clear=function(){this.ctx.clear()},D$s.transformByMatrix=function(D$s){this.ctx.transformByMatrix(D$s)},D$s.setTransform=function(D$s,D$r,D$e,D$U,D$m,D$k){this.ctx.setTransform(D$s,D$r,D$e,D$U,D$m,D$k)},D$s.setTransformByMatrix=function(D$s){this.ctx.setTransformByMatrix(D$s)},D$s.save=function(){this.ctx.save()},D$s.restore=function(){this.ctx.restore()},D$s.translate=function(D$s,D$r){this.ctx.translate(D$s,D$r)},D$s.transform=function(D$s,D$r,D$e,D$U,D$m,D$k){this.ctx.transform(D$s,D$r,D$e,D$U,D$m,D$k)},D$s.rotate=function(D$s){this.ctx.rotate(D$s)},D$s.scale=function(D$s,D$r){this.ctx.scale(D$s,D$r)},D$s.alpha=function(D$s){this.ctx.globalAlpha*=D$s},D$s.setAlpha=function(D$s){this.ctx.globalAlpha=D$s},D$s.fillWords=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$k&&(D$k=0),this.ctx.fillWords(D$s,D$r,D$e,D$U,D$m,D$k)},D$s.fillBorderWords=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this.ctx.fillBorderWords(D$s,D$r,D$e,D$U,D$m,D$k,D$j)},D$s.fillText=function(D$s,D$r,D$e,D$U,D$m,D$k){this.ctx.fillText(D$s,D$r+this.x,D$e+this.y,D$U,D$m,D$k)},D$s.strokeText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this.ctx.strokeText(D$s,D$r+this.x,D$e+this.y,D$U,D$m,D$k,D$j)},D$s.blendMode=function(D$s){this.ctx.globalCompositeOperation=D$s},D$s.flush=function(){this.ctx.flush&&this.ctx.flush()},D$s.addRenderObject=function(D$s){this.ctx.addRenderObject(D$s)},D$s.beginClip=function(D$s,D$r,D$e,D$U){this.ctx.beginClip&&this.ctx.beginClip(D$s,D$r,D$e,D$U)},D$s.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},D$s.fillTrangles=function(D$s,D$r,D$e){this.ctx.fillTrangles(D$e[0],D$e[1],D$e[2],D$e[3],4<D$e.length?D$e[4]:null)},D$j.PI2=2*Math.PI,D$j}(),D$v=function(){function D$j(D$s,D$r){switch(this._next=D$r||D$j.NORENDER,D$s){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=D$V._filter);case 69905:return void(this._fun=D$j._initRenderFun)}this.onCreate(D$s)}D$h(D$j,"laya.renders.RenderSprite");var D$s=D$j.prototype;return D$s.onCreate=function(D$s){},D$s._style=function(D$s,D$r,D$e,D$U){D$s._style.render(D$s,D$r,D$e,D$U);var D$m=this._next;D$m._fun.call(D$m,D$s,D$r,D$e,D$U)},D$s._no=function(D$s,D$r,D$e,D$U){},D$s._custom=function(D$s,D$r,D$e,D$U){D$s.customRender(D$r,D$e,D$U);var D$m=D$s._style._tf;this._next._fun.call(this._next,D$s,D$r,D$e-D$m.translateX,D$U-D$m.translateY)},D$s._clip=function(D$s,D$r,D$e,D$U){var D$m=this._next;if(D$m!=D$j.NORENDER){var D$k=D$s._style.scrollRect;D$r.ctx.save(),D$r.ctx.clipRect(D$e,D$U,D$k.width,D$k.height),D$m._fun.call(D$m,D$s,D$r,D$e-D$k.x,D$U-D$k.y),D$r.ctx.restore()}},D$s._blend=function(D$s,D$r,D$e,D$U){var D$m=D$s._style;D$m.blendMode&&(D$r.ctx.globalCompositeOperation=D$m.blendMode);var D$k=this._next;D$k._fun.call(D$k,D$s,D$r,D$e,D$U),D$r.ctx.globalCompositeOperation="source-over"},D$s._mask=function(D$s,D$r,D$e,D$U){var D$m=this._next;D$m._fun.call(D$m,D$s,D$r,D$e,D$U);var D$k=D$s.mask;D$k&&(D$r.ctx.globalCompositeOperation="destination-in",(0<D$k.numChildren||!D$k.graphics._isOnlyOne())&&(D$k.cacheAsBitmap=!0),D$k.render(D$r,D$e-D$s.pivotX,D$U-D$s.pivotY)),D$r.ctx.globalCompositeOperation="source-over"},D$s._graphics=function(D$s,D$r,D$e,D$U){var D$m=D$s._style._tf;D$s._graphics&&D$s._graphics._render(D$s,D$r,D$e-D$m.translateX,D$U-D$m.translateY);var D$k=this._next;D$k._fun.call(D$k,D$s,D$r,D$e,D$U)},D$s._image=function(D$s,D$r,D$e,D$U){var D$m=D$s._style;D$r.ctx.drawTexture2(D$e,D$U,D$m._tf.translateX,D$m._tf.translateY,D$s.transform,D$m.alpha,D$m.blendMode,D$s._graphics._one)},D$s._image2=function(D$s,D$r,D$e,D$U){var D$m=D$s._style._tf;D$r.ctx.drawTexture2(D$e,D$U,D$m.translateX,D$m.translateY,D$s.transform,1,null,D$s._graphics._one)},D$s._alpha=function(D$s,D$r,D$e,D$U){var D$m;if(.01<(D$m=D$s._style.alpha)||D$s._needRepaint()){var D$k=D$r.ctx.globalAlpha;D$r.ctx.globalAlpha*=D$m;var D$j=this._next;D$j._fun.call(D$j,D$s,D$r,D$e,D$U),D$r.ctx.globalAlpha=D$k}},D$s._transform=function(D$s,D$r,D$e,D$U){var D$m=D$s.transform,D$k=this._next;D$m&&D$k!=D$j.NORENDER?(D$r.save(),D$r.transform(D$m.a,D$m.b,D$m.c,D$m.d,D$m.tx+D$e,D$m.ty+D$U),D$k._fun.call(D$k,D$s,D$r,0,0),D$r.restore()):D$k._fun.call(D$k,D$s,D$r,D$e,D$U)},D$s._childs=function(D$s,D$r,D$e,D$U){var D$m=D$s._style,D$k=D$m._tf;if(D$e=D$e-D$k.translateX+D$m.paddingLeft,D$U=D$U-D$k.translateY+D$m.paddingTop,D$m._calculation){var D$j=D$s._getWords();if(D$j){var D$T=D$m;D$T&&(D$T.stroke?D$r.fillBorderWords(D$j,D$e,D$U,D$T.font,D$T.color,D$T.strokeColor,D$T.stroke):D$r.fillWords(D$j,D$e,D$U,D$T.font,D$T.color,"none"!=D$T.textDecoration&&D$T.underLine?1:0))}}var D$Y,D$Z=D$s._childs,D$h=D$Z.length;if(D$s.viewport||D$s.optimizeScrollRect&&D$s._style.scrollRect){var D$H=D$s.viewport||D$s._style.scrollRect,D$A=D$H.x,D$x=D$H.y,D$B=D$H.right,D$$=D$H.bottom,D$l=NaN,D$V=NaN;for(D$b=0;D$b<D$h;++D$b)(D$Y=D$Z[D$b]).visible&&(D$l=D$Y._x)<D$B&&D$l+D$Y.width>D$A&&(D$V=D$Y._y)<D$$&&D$V+D$Y.height>D$x&&D$Y.render(D$r,D$e,D$U)}else for(var D$b=0;D$b<D$h;++D$b)(D$Y=D$Z[D$b])._style.visible&&D$Y.render(D$r,D$e,D$U)},D$s._canvas=function(D$s,D$r,D$e,D$U){var D$m=D$s._$P.cacheCanvas;if(D$m){"bitmap"===D$m.type?D$t.canvasBitmap++:D$t.canvasNormal++;var D$k=D$m.ctx;if(D$s._needRepaint()||!D$k)this._canvas_repaint(D$s,D$r,D$e,D$U);else{var D$j=D$m._cacheRec;D$r.drawCanvas(D$k.canvas,D$e+D$j.x,D$U+D$j.y,D$j.width,D$j.height)}}else this._next._fun.call(this._next,D$s,D$r,D$e,D$U)},D$s._canvas_repaint=function(D$s,D$r,D$e,D$U){var D$m=D$s._$P.cacheCanvas,D$k=this._next;if(D$m){var D$j,D$T,D$Y,D$Z,D$h=D$m.ctx,D$H=D$s._needRepaint()||!D$h,D$A=D$m.type;if("bitmap"===D$A?D$t.canvasBitmap++:D$t.canvasNormal++,D$H){var D$x,D$B;D$m._cacheRec||(D$m._cacheRec=new D$y),D$c.isWebGL&&"bitmap"!==D$A?D$m._cacheRec.setTo(-D$s.pivotX,-D$s.pivotY,1,1):((D$Z=D$s.getSelfBounds()).x=D$Z.x-D$s.pivotX,D$Z.y=D$Z.y-D$s.pivotY,D$Z.x=D$Z.x-16,D$Z.y=D$Z.y-16,D$Z.width=D$Z.width+32,D$Z.height=D$Z.height+32,D$Z.x=Math.floor(D$Z.x+D$e)-D$e,D$Z.y=Math.floor(D$Z.y+D$U)-D$U,D$Z.width=Math.floor(D$Z.width),D$Z.height=Math.floor(D$Z.height),D$m._cacheRec.copyFrom(D$Z)),D$Z=D$m._cacheRec;var D$$,D$l=D$c.isWebGL?1:D$Q.pixelRatio*D$D.stage.clientScaleX,D$V=D$c.isWebGL?1:D$Q.pixelRatio*D$D.stage.clientScaleY;if(!D$c.isWebGL){var D$b,D$o=1,D$I=1;for(D$b=D$s;D$b&&D$b!=D$D.stage;)D$o*=D$b.scaleX,D$I*=D$b.scaleY,D$b=D$b.parent;D$c.isWebGL?(D$o<1&&(D$l*=D$o),D$I<1&&(D$V*=D$I)):(1<D$o&&(D$l*=D$o),1<D$I&&(D$V*=D$I))}if(D$s.scrollRect){var D$w=D$s.scrollRect;D$Z.x-=D$w.x,D$Z.y-=D$w.y}if(D$x=D$Z.width*D$l,D$B=D$Z.height*D$V,D$T=D$Z.x,D$Y=D$Z.y,D$c.isWebGL&&"bitmap"===D$A&&(2048<D$x||2048<D$B))return console.warn("cache bitmap size larger than 2048,cache ignored"),D$m.ctx&&(D$d.recover("RenderContext",D$m.ctx),D$m.ctx.canvas.size(0,0),D$m.ctx=null),void D$k._fun.call(D$k,D$s,D$r,D$e,D$U);if(D$h||(D$h=D$m.ctx=D$d.getItem("RenderContext")||new D$E(D$x,D$B,D$os.create("AUTO"))),D$h.ctx.sprite=D$s,(D$j=D$h.canvas).clear(),(D$j.width!=D$x||D$j.height!=D$B)&&D$j.size(D$x,D$B),"bitmap"===D$A?D$j.context.asBitmap=!0:"normal"===D$A&&(D$j.context.asBitmap=!1),1!=D$l||1!=D$V){var D$X=D$h.ctx;D$X.save(),D$X.scale(D$l,D$V),!D$c.isConchWebGL&&D$c.isConchApp&&(D$$=D$s._$P.cf)&&D$X.setFilterMatrix&&D$X.setFilterMatrix(D$$._mat,D$$._alpha),D$k._fun.call(D$k,D$s,D$h,-D$T,-D$Y),D$X.restore(),D$c.isConchApp&&!D$c.isConchWebGL||D$s._applyFilters()}else D$X=D$h.ctx,!D$c.isConchWebGL&&D$c.isConchApp&&(D$$=D$s._$P.cf)&&D$X.setFilterMatrix&&D$X.setFilterMatrix(D$$._mat,D$$._alpha),D$k._fun.call(D$k,D$s,D$h,-D$T,-D$Y),D$c.isConchApp&&!D$c.isConchWebGL||D$s._applyFilters();D$s._$P.staticCache&&(D$m.reCache=!1),D$t.canvasReCache++}else D$T=(D$Z=D$m._cacheRec).x,D$Y=D$Z.y,D$j=D$h.canvas;D$r.drawCanvas(D$j,D$e+D$T,D$U+D$Y,D$Z.width,D$Z.height)}else D$k._fun.call(D$k,D$s,D$h,D$e,D$U)},D$j.__init__=function(){var D$s,D$r,D$e=0;for(D$r=D$P.createRenderSprite(69905,null),D$s=D$j.renders.length=4096,D$e=0;D$e<D$s;D$e++)D$j.renders[D$e]=D$r;D$j.renders[0]=D$P.createRenderSprite(0,null),function(D$s,D$r){for(var D$e=0,D$U=0;D$U<D$s.length;D$U++)D$e|=D$s[D$U],D$j.renders[D$e]=D$r}([1,512,4,2],new D$j(1,null)),D$j.renders[513]=D$P.createRenderSprite(513,null),D$j.renders[517]=new D$j(517,null)},D$j._initRenderFun=function(D$s,D$r,D$e,D$U){var D$m=D$s._renderType;(D$j.renders[D$m]=D$j._getTypeRender(D$m))._fun(D$s,D$r,D$e,D$U)},D$j._getTypeRender=function(D$s){for(var D$r=null,D$e=2048;1<D$e;)D$e&D$s&&(D$r=D$P.createRenderSprite(D$e,D$r)),D$e>>=1;return D$r},D$j.IMAGE=1,D$j.ALPHA=2,D$j.TRANSFORM=4,D$j.BLEND=8,D$j.CANVAS=16,D$j.FILTERS=32,D$j.MASK=64,D$j.CLIP=128,D$j.STYLE=256,D$j.GRAPHICS=512,D$j.CUSTOM=1024,D$j.CHILDS=2048,D$j.INIT=69905,D$j.renders=[],D$j.NORENDER=new D$j(0,null),D$j}(),D$S=function(){function D$T(){this._repaint=!1}D$h(D$T,"laya.resource.Context");var D$s=D$T.prototype;return D$s.replaceReset=function(){var D$s,D$r,D$e=0;for(D$s=D$T.replaceKeys.length,D$e=0;D$e<D$s;D$e++)D$r=D$T.replaceKeys[D$e],this[D$T.newKeys[D$e]]=this[D$r]},D$s.replaceResotre=function(){this.__restore(),this.__reset()},D$s.setIsMainContext=function(){},D$s.drawTextures=function(D$s,D$r,D$e,D$U){D$t.drawCall+=D$r.length/2;for(var D$m=D$s.width,D$k=D$s.height,D$j=0,D$T=D$r.length;D$j<D$T;D$j+=2)this.drawTexture(D$s,D$r[D$j],D$r[D$j+1],D$m,D$k,D$e,D$U)},D$s.drawCanvas=function(D$s,D$r,D$e,D$U,D$m){D$t.drawCall++,this.drawImage(D$s.source,D$r,D$e,D$U,D$m)},D$s.fillRect=function(D$s,D$r,D$e,D$U,D$m){D$t.drawCall++,D$m&&(this.fillStyle=D$m),this.__fillRect(D$s,D$r,D$e,D$U)},D$s.fillText=function(D$s,D$r,D$e,D$U,D$m,D$k){D$t.drawCall++,3<arguments.length&&null!=D$U&&(this.font=D$U,this.fillStyle=D$m,this.textAlign=D$k,this.textBaseline="top"),this.__fillText(D$s,D$r,D$e)},D$s.fillBorderText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){D$t.drawCall++,this.font=D$U,this.fillStyle=D$m,this.textBaseline="top",this.strokeStyle=D$k,this.lineWidth=D$j,this.textAlign=D$T,this.__strokeText(D$s,D$r,D$e),this.__fillText(D$s,D$r,D$e)},D$s.strokeText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$t.drawCall++,3<arguments.length&&null!=D$U&&(this.font=D$U,this.strokeStyle=D$m,this.lineWidth=D$k,this.textAlign=D$j,this.textBaseline="top"),this.__strokeText(D$s,D$r,D$e)},D$s.transformByMatrix=function(D$s){this.transform(D$s.a,D$s.b,D$s.c,D$s.d,D$s.tx,D$s.ty)},D$s.setTransformByMatrix=function(D$s){this.setTransform(D$s.a,D$s.b,D$s.c,D$s.d,D$s.tx,D$s.ty)},D$s.clipRect=function(D$s,D$r,D$e,D$U){D$t.drawCall++,this.beginPath(),this.rect(D$s,D$r,D$e,D$U),this.clip()},D$s.drawTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$t.drawCall++;var D$T=D$s.uv,D$Y=D$s.bitmap.width,D$Z=D$s.bitmap.height;this.drawImage(D$s.source,D$T[0]*D$Y,D$T[1]*D$Z,(D$T[2]-D$T[0])*D$Y,(D$T[5]-D$T[3])*D$Z,D$r+D$k,D$e+D$j,D$U,D$m)},D$s.drawTextureWithTransform=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){D$t.drawCall++;var D$Z=D$s.uv,D$h=D$s.bitmap.width,D$H=D$s.bitmap.height;this.save(),1!=D$Y&&(this.globalAlpha*=D$Y),D$k?(this.transform(D$k.a,D$k.b,D$k.c,D$k.d,D$k.tx+D$j,D$k.ty+D$T),this.drawImage(D$s.source,D$Z[0]*D$h,D$Z[1]*D$H,(D$Z[2]-D$Z[0])*D$h,(D$Z[5]-D$Z[3])*D$H,D$r,D$e,D$U,D$m)):this.drawImage(D$s.source,D$Z[0]*D$h,D$Z[1]*D$H,(D$Z[2]-D$Z[0])*D$h,(D$Z[5]-D$Z[3])*D$H,D$r+D$j,D$e+D$T,D$U,D$m),this.restore()},D$s.drawTexture2=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){var D$Y=D$T[0];if(D$Y.loaded&&D$Y.bitmap&&D$Y.source){D$t.drawCall++;var D$Z=1!==D$k;if(D$Z){var D$h=this.globalAlpha;this.globalAlpha*=D$k}var D$H=D$Y.uv,D$A=D$Y.bitmap.width,D$x=D$Y.bitmap.height;D$m?(this.save(),this.transform(D$m.a,D$m.b,D$m.c,D$m.d,D$m.tx+D$s,D$m.ty+D$r),this.drawImage(D$Y.source,D$H[0]*D$A,D$H[1]*D$x,(D$H[2]-D$H[0])*D$A,(D$H[5]-D$H[3])*D$x,D$T[1]-D$e,D$T[2]-D$U,D$T[3],D$T[4]),this.restore()):this.drawImage(D$Y.source,D$H[0]*D$A,D$H[1]*D$x,(D$H[2]-D$H[0])*D$A,(D$H[5]-D$H[3])*D$x,D$T[1]-D$e+D$s,D$T[2]-D$U+D$r,D$T[3],D$T[4]),D$Z&&(this.globalAlpha=D$h)}},D$s.fillTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){if(!D$T.pat){if(D$s.uv!=D$hs.DEF_UV){var D$Y=new D$os("2D");D$Y.getContext("2d"),D$Y.size(D$s.width,D$s.height),D$Y.context.drawTexture(D$s,0,0,D$s.width,D$s.height,0,0),D$s=new D$hs(D$Y)}D$T.pat=this.createPattern(D$s.bitmap.source,D$k)}var D$Z=D$r,D$h=D$e,D$H=0,D$A=0;D$j&&(D$Z+=D$j.x%D$s.width,D$h+=D$j.y%D$s.height,D$H-=D$j.x%D$s.width,D$A-=D$j.y%D$s.height),this.translate(D$Z,D$h),this.fillRect(D$H,D$A,D$U,D$m,D$T.pat),this.translate(-D$Z,-D$h)},D$s.drawTriangle=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){var D$Y=D$s.bitmap,D$Z=D$Y.source,D$h=D$s.width,D$H=D$s.height,D$A=D$Y.width,D$x=D$Y.height,D$B=D$e[D$U]*D$A,D$$=D$e[D$m]*D$A,D$l=D$e[D$k]*D$A,D$V=D$e[D$U+1]*D$x,D$b=D$e[D$m+1]*D$x,D$o=D$e[D$k+1]*D$x,D$I=D$r[D$U],D$w=D$r[D$m],D$X=D$r[D$k],D$D=D$r[D$U+1],D$n=D$r[D$m+1],D$y=D$r[D$k+1];if(D$T){var D$g=(D$I+D$w+D$X)/3,D$f=(D$D+D$n+D$y)/3,D$J=D$I-D$g,D$P=D$D-D$f,D$O=Math.sqrt(D$J*D$J+D$P*D$P);D$I=D$g+D$J/D$O*(D$O+1),D$D=D$f+D$P/D$O*(D$O+1),D$P=D$n-D$f,D$w=D$g+(D$J=D$w-D$g)/(D$O=Math.sqrt(D$J*D$J+D$P*D$P))*(D$O+1),D$n=D$f+D$P/D$O*(D$O+1),D$P=D$y-D$f,D$X=D$g+(D$J=D$X-D$g)/(D$O=Math.sqrt(D$J*D$J+D$P*D$P))*(D$O+1),D$y=D$f+D$P/D$O*(D$O+1)}this.save(),D$j&&this.transform(D$j.a,D$j.b,D$j.c,D$j.d,D$j.tx,D$j.ty),this.beginPath(),this.moveTo(D$I,D$D),this.lineTo(D$w,D$n),this.lineTo(D$X,D$y),this.closePath(),this.clip();var D$i=1/(D$B*D$b+D$V*D$l+D$$*D$o-D$b*D$l-D$V*D$$-D$B*D$o),D$K=D$I*D$b+D$V*D$X+D$w*D$o-D$b*D$X-D$V*D$w-D$I*D$o,D$c=D$B*D$w+D$I*D$l+D$$*D$X-D$w*D$l-D$I*D$$-D$B*D$X,D$E=D$B*D$b*D$X+D$V*D$w*D$l+D$I*D$$*D$o-D$I*D$b*D$l-D$V*D$$*D$X-D$B*D$w*D$o,D$v=D$D*D$b+D$V*D$y+D$n*D$o-D$b*D$y-D$V*D$n-D$D*D$o,D$S=D$B*D$n+D$D*D$l+D$$*D$y-D$n*D$l-D$D*D$$-D$B*D$y,D$z=D$B*D$b*D$y+D$V*D$n*D$l+D$D*D$$*D$o-D$D*D$b*D$l-D$V*D$$*D$y-D$B*D$n*D$o;this.transform(D$K*D$i,D$v*D$i,D$c*D$i,D$S*D$i,D$E*D$i,D$z*D$i),this.drawImage(D$Z,D$s.uv[0]*D$A,D$s.uv[1]*D$x,D$h,D$H,D$s.uv[0]*D$A,D$s.uv[1]*D$x,D$h,D$H),this.restore()},D$s.flush=function(){return 0},D$s.fillWords=function(D$s,D$r,D$e,D$U,D$m,D$k){D$U&&(this.font=D$U),D$m&&(this.fillStyle=D$m);this.textBaseline="top",this.textAlign="left";for(var D$j=0,D$T=D$s.length;D$j<D$T;D$j++){var D$Y=D$s[D$j];if(this.__fillText(D$Y.char,D$Y.x+D$r,D$Y.y+D$e),1===D$k){var D$Z=D$Y.height,D$h=.5*D$Y.style.letterSpacing;D$h||(D$h=0),this.beginPath(),this.strokeStyle=D$m,this.lineWidth=1,this.moveTo(D$r+D$Y.x-D$h+.5,D$e+D$Y.y+D$Z+.5),this.lineTo(D$r+D$Y.x+D$Y.width+D$h+.5,D$e+D$Y.y+D$Z+.5),this.stroke()}}},D$s.fillBorderWords=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$U&&(this.font=D$U),D$m&&(this.fillStyle=D$m),this.textBaseline="top",this.lineWidth=D$j,this.textAlign="left",this.strokeStyle=D$k;for(var D$T=0,D$Y=D$s.length;D$T<D$Y;D$T++){var D$Z=D$s[D$T];this.__strokeText(D$Z.char,D$Z.x+D$r,D$Z.y+D$e),this.__fillText(D$Z.char,D$Z.x+D$r,D$Z.y+D$e)}},D$s.destroy=function(){this.canvas.width=this.canvas.height=0},D$s.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},D$s.drawCurves=function(D$s,D$r,D$e){this.beginPath(),this.strokeStyle=D$e[3],this.lineWidth=D$e[4];var D$U=D$e[2];D$s+=D$e[0],D$r+=D$e[1],this.moveTo(D$s+D$U[0],D$r+D$U[1]);for(var D$m=2,D$k=D$U.length;D$m<D$k;)this.quadraticCurveTo(D$s+D$U[D$m++],D$r+D$U[D$m++],D$s+D$U[D$m++],D$r+D$U[D$m++]);this.stroke()},D$T.__init__=function(D$r){var D$e=laya.resource.Context.prototype;if(!(D$r=D$r||CanvasRenderingContext2D.prototype).inited){D$r.inited=!0,D$r.__fillText=D$r.fillText,D$r.__fillRect=D$r.fillRect,D$r.__strokeText=D$r.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(D$s){D$r[D$s]=D$e[D$s]})}},D$T.replaceCanvasGetSet=function(D$s,D$r){var D$e=Object.getOwnPropertyDescriptor(D$s,D$r);if(!D$e||!D$e.configurable)return!1;var D$U,D$m={};for(D$U in D$e)"set"!=D$U&&(D$m[D$U]=D$e[D$U]);var D$k=D$e.set;return D$m.set=function(D$s){D$k.call(this,D$s);var D$r=this.getContext("2d");D$r&&"__reset"in D$r&&D$r.__reset()},Object.defineProperty(D$s,D$r,D$m),!0},D$T.replaceGetSet=function(D$s,D$r){var D$e=Object.getOwnPropertyDescriptor(D$s,D$r);if(!D$e||!D$e.configurable)return!1;var D$U,D$m={};for(D$U in D$e)"set"!=D$U&&(D$m[D$U]=D$e[D$U]);var D$k=D$e.set,D$j="___"+D$r+"__";return D$T.newKeys.push(D$j),D$m.set=function(D$s){D$s!=this[D$j]&&(this[D$j]=D$s,D$k.call(this,D$s))},Object.defineProperty(D$s,D$r,D$m),!0},D$T._default=new D$T,D$T.newKeys=[],D$Y(D$T,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),D$T}(),D$z=function(){function D$k(D$s){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++D$k._uniqueIDCounter,this._name=D$s||"Content Manager",D$k._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,D$k._resourceManagers.push(this),this._resources=[],this._records={}}D$h(D$k,"laya.resource.ResourceManager");var D$s=D$k.prototype;return D$D.imps(D$s,{"laya.resource.IDispose":!0}),D$s.getResourceByIndex=function(D$s){return this._resources[D$s]},D$s.getResourcesLength=function(){return this._resources.length},D$s.addResource=function(D$s){return D$s.resourceManager&&D$s.resourceManager.removeResource(D$s),-1===this._resources.indexOf(D$s)&&((D$s._resourceManager=this)._resources.push(D$s),this.addRecord(D$s.uri,D$s.__className,D$s.memorySize),this.addSize(D$s.memorySize),!0)},D$s.removeResource=function(D$s){var D$r=this._resources.indexOf(D$s);return-1!==D$r&&(this._resources.splice(D$r,1),D$s._resourceManager=null,this._memorySize-=D$s.memorySize,this.addRecord(D$s.uri,D$s.__className,-D$s.memorySize),!0)},D$s.unload=function(){for(var D$s=this._resources.slice(0,this._resources.length),D$r=0;D$r<D$s.length;D$r++){D$s[D$r].destroy()}D$s.length=0},D$s.dispose=function(){if(this===D$k._systemResourceManager)throw new Error("systemResourceManager不能被释放！");D$k._resourceManagers.splice(D$k._resourceManagers.indexOf(this),1),D$k._isResourceManagersSorted=!1;for(var D$s=this._resources.slice(0,this._resources.length),D$r=0;D$r<D$s.length;D$r++){var D$e=D$s[D$r];D$e.resourceManager.removeResource(D$e),D$e.destroy()}D$s.length=0},D$s.addSize=function(D$s){D$s&&(this.autoRelease&&0<D$s&&this._memorySize+D$s>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=D$s)},D$s.addRecord=function(D$s,D$r,D$e){DEBUG&&D$e&&!D$s&&console.error(D$s,D$r,D$e)},D$s.garbageCollection=function(D$s){var D$r=this._resources;(D$r=D$r.slice()).sort(function(D$s,D$r){if(!D$s||!D$r)throw new Error("a或b不能为空！");return D$s.released&&D$r.released?0:D$s.released?1:D$r.released?-1:D$s._lastUseFrameCount-D$r._lastUseFrameCount});for(var D$e=D$t.loopCount,D$U=0,D$m=D$r.length;D$U<D$m;D$U++){var D$k=D$r[D$U];if(!(1<D$e-D$k._lastUseFrameCount))return void(this._memorySize>=D$s&&(this._isOverflow=!0));if(D$k.releaseResource(),this._memorySize<D$s)return void(this._isOverflow=!1)}},D$B(0,D$s,"id",function(){return this._id}),D$B(0,D$s,"name",function(){return this._name},function(D$s){!D$s&&""===D$s||this._name===D$s||(this._name=D$s,D$k._isResourceManagersSorted=!1)}),D$B(0,D$s,"memorySize",function(){return this._memorySize}),D$B(0,D$s,"records",function(){return this._records}),D$B(1,D$k,"systemResourceManager",function(){return D$k._systemResourceManager}),D$k.__init__=function(){D$k.currentResourceManager=D$k.systemResourceManager},D$k.getLoadedResourceManagerByIndex=function(D$s){return D$k._resourceManagers[D$s]},D$k.getLoadedResourceManagersCount=function(){return D$k._resourceManagers.length},D$k.recreateContentManagers=function(D$s){void 0===D$s&&(D$s=!1);for(var D$r=D$k.currentResourceManager,D$e=0;D$e<D$k._resourceManagers.length;D$e++){D$k.currentResourceManager=D$k._resourceManagers[D$e];for(var D$U=0;D$U<D$k.currentResourceManager._resources.length;D$U++)D$k.currentResourceManager._resources[D$U].releaseResource(D$s),D$k.currentResourceManager._resources[D$U].activeResource(D$s)}D$k.currentResourceManager=D$r},D$k.releaseContentManagers=function(D$s){void 0===D$s&&(D$s=!1);for(var D$r=D$k.currentResourceManager,D$e=0;D$e<D$k._resourceManagers.length;D$e++){D$k.currentResourceManager=D$k._resourceManagers[D$e];for(var D$U=0;D$U<D$k.currentResourceManager._resources.length;D$U++){var D$m=D$k.currentResourceManager._resources[D$U];!D$m.released&&D$m.releaseResource(D$s)}}D$k.currentResourceManager=D$r},D$k._uniqueIDCounter=0,D$k._isResourceManagersSorted=!1,D$k._resourceManagers=[],D$Y(D$k,["_systemResourceManager",function(){return this._systemResourceManager=new D$k("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=D$k._systemResourceManager}]),D$k}(),D$Q=(function(){function D$s(){}D$h(D$s,"laya.system.System"),D$s.changeDefinition=function(D$s,D$r){D$D[D$s]=D$r;var D$e=D$s+"=classObj";D$D._runScript(D$e)},D$s.__init__=function(){D$c.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function D$e(){}return D$h(D$e,"laya.utils.Browser"),D$B(1,D$e,"pixelRatio",function(){return D$e.__init__(),-1<D$e.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:D$P.getPixelRatio()}),D$B(1,D$e,"height",function(){return D$e.__init__(),(D$D.stage&&D$D.stage.canvasRotation?D$e.clientWidth:D$e.clientHeight)*D$e.pixelRatio}),D$B(1,D$e,"clientWidth",function(){return D$e.__init__(),D$e.window.innerWidth||D$e.document.body.clientWidth}),D$B(1,D$e,"window",function(){return D$e.__init__(),D$e._window}),D$B(1,D$e,"clientHeight",function(){return D$e.__init__(),D$e.window.innerHeight||D$e.document.body.clientHeight||D$e.document.documentElement.clientHeight}),D$B(1,D$e,"width",function(){return D$e.__init__(),(D$D.stage&&D$D.stage.canvasRotation?D$e.clientHeight:D$e.clientWidth)*D$e.pixelRatio}),D$B(1,D$e,"container",function(){return D$e.__init__(),D$e._container||((D$e._container=D$e.createElement("div")).id="layaContainer",D$e.document.body.appendChild(D$e._container)),D$e._container},function(D$s){D$e._container=D$s}),D$B(1,D$e,"document",function(){return D$e.__init__(),D$e._document}),D$e.__init__=function(){if(!D$e._window){D$e._window=D$P.getWindow(),D$e._document=D$e.window.document,D$e._window.addEventListener("message",function(D$s){laya.utils.Browser._onMessage(D$s)},!1),D$e.document.__createElement=D$e.document.createElement,D$j.requestAnimationFrame=D$j.requestAnimationFrame||D$j.webkitRequestAnimationFrame||D$j.mozRequestAnimationFrame||D$j.oRequestAnimationFrame||D$j.msRequestAnimationFrame||function(D$s){return D$j.setTimeout(D$s,1e3/60)};var D$s=D$j.document.body.style;D$s["-webkit-user-select"]="none",D$s["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",D$e.userAgent=D$e.window.navigator.userAgent,D$e.onIOS=!!(D$e.u=D$e.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),D$e.onMobile=-1<D$e.u.indexOf("Mobile"),D$e.onIPhone=-1<D$e.u.indexOf("iPhone"),D$e.onMac=-1<D$e.u.indexOf("Mac OS X"),D$e.onIPad=-1<D$e.u.indexOf("iPad"),D$e.onAndroid=-1<D$e.u.indexOf("Android")||-1<D$e.u.indexOf("Adr"),D$e.onWP=-1<D$e.u.indexOf("Windows Phone"),D$e.onQQBrowser=-1<D$e.u.indexOf("QQBrowser"),D$e.onMQQBrowser=-1<D$e.u.indexOf("MQQBrowser")||-1<D$e.u.indexOf("Mobile")&&-1<D$e.u.indexOf("QQ"),D$e.onIE=!!D$e.window.ActiveXObject||"ActiveXObject"in D$e.window,D$e.onWeiXin=-1<D$e.u.indexOf("MicroMessenger"),D$e.onPC=!D$e.onMobile,D$e.onSafari=-1<D$e.u.indexOf("Safari"),D$e.onFirefox=-1<D$e.u.indexOf("Firefox"),D$e.onEdge=-1<D$e.u.indexOf("Edge"),D$e.onMiniGame=-1<D$e.u.indexOf("MiniGame"),D$e.onLimixiu=-1<D$e.u.indexOf("limixiu"),D$e.httpProtocol="http:"==D$e.window.location.protocol,D$e.onMiniGame&&null==D$e.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),D$e.webAudioEnabled=!!(D$e.window.AudioContext||D$e.window.webkitAudioContext||D$e.window.mozAudioContext),D$e.soundType=D$e.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",D$ms=D$e.webAudioEnabled?D$ks:D$es,D$e.webAudioEnabled&&D$ks.initWebAudio(),D$es._initMusicAudio(),D$e.enableTouch="ontouchstart"in D$j||D$j.DocumentTouch&&D$r instanceof DocumentTouch,D$j.focus(),D$J._soundClass=D$ms,D$J._musicClass=D$es,D$c._mainCanvas=D$c._mainCanvas||D$os.create("2D"),D$e.canvas||(D$e.canvas=D$os.create("2D"),D$e.context=D$e.canvas.getContext("2d"))}},D$e._onMessage=function(D$s){if(D$s.data&&"size"==D$s.data.name){if(D$e.window.innerWidth=D$s.data.width,D$e.window.innerHeight=D$s.data.height,D$e.window.__innerHeight=D$s.data.clientHeight,!D$e.document.createEvent)return void console.warn("no document.createEvent");var D$r=D$e.document.createEvent("HTMLEvents");return D$r.initEvent("resize",!1,!1),void D$e.window.dispatchEvent(D$r)}},D$e.createElement=function(D$s){return D$e.__init__(),D$e.document.__createElement(D$s)},D$e.getElementById=function(D$s){return D$e.__init__(),D$e.document.getElementById(D$s)},D$e.removeElement=function(D$s){D$s&&D$s.parentNode&&D$s.parentNode.removeChild(D$s)},D$e.now=function(){return D$P.now()},D$e._window=null,D$e._document=null,D$e._container=null,D$e.userAgent=null,D$e.u=null,D$e.onIOS=!1,D$e.onMac=!1,D$e.onMobile=!1,D$e.onIPhone=!1,D$e.onIPad=!1,D$e.onAndroid=!1,D$e.onWP=!1,D$e.onQQBrowser=!1,D$e.onMQQBrowser=!1,D$e.onSafari=!1,D$e.onFirefox=!1,D$e.onEdge=!1,D$e.onIE=!1,D$e.onWeiXin=!1,D$e.onMiniGame=!1,D$e.onLimixiu=!1,D$e.onPC=!1,D$e.httpProtocol=!1,D$e.webAudioEnabled=!1,D$e.soundType=null,D$e.enableTouch=!1,D$e.canvas=null,D$e.context=null,D$e.__init$=function(){},D$e}()),D$C=function(){function D$r(D$s){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,D$s?(this._u8d_=new Uint8Array(D$s),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}D$h(D$r,"laya.utils.Byte");var D$s=D$r.prototype;return D$s.___resizeBuffer=function(D$r){try{var D$s=new Uint8Array(D$r);null!=this._u8d_&&(this._u8d_.length<=D$r?D$s.set(this._u8d_):D$s.set(this._u8d_.subarray(0,D$r))),this._u8d_=D$s,this._d_=new DataView(D$s.buffer)}catch(D$s){throw"___resizeBuffer err:"+D$r}},D$s.getString=function(){return this.rUTF(this.getUint16())},D$s.getFloat32Array=function(D$s,D$r){var D$e=D$s+D$r;D$e=D$e>this._length?this._length:D$e;var D$U=new Float32Array(this._d_.buffer.slice(D$s,D$e));return this._pos_=D$e,D$U},D$s.getUint8Array=function(D$s,D$r){var D$e=D$s+D$r;D$e=D$e>this._length?this._length:D$e;var D$U=new Uint8Array(this._d_.buffer.slice(D$s,D$e));return this._pos_=D$e,D$U},D$s.getInt16Array=function(D$s,D$r){var D$e=D$s+D$r;D$e=D$e>this._length?this._length:D$e;var D$U=new Int16Array(this._d_.buffer.slice(D$s,D$e));return this._pos_=D$e,D$U},D$s.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var D$s=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,D$s},D$s.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var D$s=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,D$s},D$s.writeFloat32=function(D$s){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,D$s,this._xd_),this._pos_+=4},D$s.writeFloat64=function(D$s){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,D$s,this._xd_),this._pos_+=8},D$s.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var D$s=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,D$s},D$s.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var D$s=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,D$s},D$s.writeInt32=function(D$s){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,D$s,this._xd_),this._pos_+=4},D$s.writeUint32=function(D$s){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,D$s,this._xd_),this._pos_+=4},D$s.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var D$s=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,D$s},D$s.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var D$s=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,D$s},D$s.writeUint16=function(D$s){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,D$s,this._xd_),this._pos_+=2},D$s.writeInt16=function(D$s){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,D$s,this._xd_),this._pos_+=2},D$s.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},D$s.writeUint8=function(D$s){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,D$s),this._pos_++},D$s._getUInt8=function(D$s){return this._d_.getUint8(D$s)},D$s._getUint16=function(D$s){return this._d_.getUint16(D$s,this._xd_)},D$s._getMatrix=function(){return new D$O(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},D$s.rUTF=function(D$s){for(var D$r=[],D$e=this._pos_+D$s,D$U=0,D$m=0,D$k=0,D$j=String.fromCharCode,D$T=this._u8d_;this._pos_<D$e;)(D$U=D$T[this._pos_++])<128?0!=D$U&&D$r.push(D$j(D$U)):D$U<224?D$r.push(D$j((63&D$U)<<6|127&D$T[this._pos_++])):D$U<240?(D$m=D$T[this._pos_++],D$r.push(D$j((31&D$U)<<12|(127&D$m)<<6|127&D$T[this._pos_++]))):(D$m=D$T[this._pos_++],D$k=D$T[this._pos_++],D$r.push(D$j((15&D$U)<<18|(127&D$m)<<12|D$k<<6&127|127&D$T[this._pos_++]))),0;return D$r.join("")},D$s.getCustomString=function(D$s){for(var D$r=[],D$e=0,D$U=0,D$m=0,D$k=String.fromCharCode,D$j=this._u8d_;0<D$s;)if((D$U=D$j[this._pos_])<128)D$r.push(D$k(D$U)),this._pos_++,D$s--;else for(D$e=D$U-128,this._pos_++,D$s-=D$e;0<D$e;)D$U=D$j[this._pos_++],D$m=D$j[this._pos_++],D$r.push(D$k(D$m<<8|D$U)),D$e--;return D$r.join("")},D$s.clear=function(){this._pos_=0,this.length=0},D$s.__getBuffer=function(){return this._d_.buffer},D$s.writeUTFBytes=function(D$s){for(var D$r=0,D$e=(D$s+="").length;D$r<D$e;D$r++){var D$U=D$s.charCodeAt(D$r);D$U<=127?this.writeByte(D$U):D$U<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|D$U>>6,128|63&D$U],this._pos_),this._pos_+=2):D$U<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|D$U>>12,128|D$U>>6&63,128|63&D$U],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|D$U>>18,128|D$U>>12&63,128|D$U>>6&63,128|63&D$U],this._pos_),this._pos_+=4)}},D$s.writeUTFString=function(D$s){var D$r=this.pos;this.writeUint16(1),this.writeUTFBytes(D$s);var D$e=this.pos-D$r-2;if(65536<=D$e)throw"writeUTFString byte len more than 65536";this._d_.setUint16(D$r,D$e,this._xd_)},D$s.readUTFString=function(){return this.readUTFBytes(this.getUint16())},D$s.getUTFString=function(){return this.readUTFString()},D$s.readUTFBytes=function(D$s){if(void 0===D$s&&(D$s=-1),0==D$s)return"";var D$r=this.bytesAvailable;if(D$r<D$s)throw"readUTFBytes error - Out of bounds";return D$s=0<D$s?D$s:D$r,this.rUTF(D$s)},D$s.getUTFBytes=function(D$s){return void 0===D$s&&(D$s=-1),this.readUTFBytes(D$s)},D$s.writeByte=function(D$s){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,D$s),this._pos_+=1},D$s.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},D$s.getByte=function(){return this.readByte()},D$s.ensureWrite=function(D$s){this._length<D$s&&(this._length=D$s),this._allocated_<D$s&&(this.length=D$s)},D$s.writeArrayBuffer=function(D$s,D$r,D$e){if(void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),D$r<0||D$e<0)throw"writeArrayBuffer error - Out of bounds";0==D$e&&(D$e=D$s.byteLength-D$r),this.ensureWrite(this._pos_+D$e);var D$U=new Uint8Array(D$s);this._u8d_.set(D$U.subarray(D$r,D$r+D$e),this._pos_),this._pos_+=D$e},D$B(0,D$s,"buffer",function(){var D$s=this._d_.buffer;return D$s.byteLength==this.length?D$s:D$s.slice(0,this.length)}),D$B(0,D$s,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(D$s){this._xd_="littleEndian"==D$s}),D$B(0,D$s,"length",function(){return this._length},function(D$s){this._allocated_<D$s?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(D$s,2*this._allocated_))):this._allocated_>D$s&&this.___resizeBuffer(this._allocated_=D$s),this._length=D$s}),D$B(0,D$s,"pos",function(){return this._pos_},function(D$s){this._pos_=D$s}),D$B(0,D$s,"bytesAvailable",function(){return this._length-this._pos_}),D$r.getSystemEndian=function(){if(!D$r._sysEndian){var D$s=new ArrayBuffer(2);new DataView(D$s).setInt16(0,256,!0),D$r._sysEndian=256===new Int16Array(D$s)[0]?"littleEndian":"bigEndian"}return D$r._sysEndian},D$r.BIG_ENDIAN="bigEndian",D$r.LITTLE_ENDIAN="littleEndian",D$r._sysEndian=null,D$r}(),D$R=function(){function D$m(){}return D$h(D$m,"laya.utils.CacheManager"),D$m.regCacheByFunction=function(D$s,D$r){var D$e;D$m.unRegCacheByFunction(D$s,D$r),D$e={tryDispose:D$s,getCacheList:D$r},D$m._cacheList.push(D$e)},D$m.unRegCacheByFunction=function(D$s,D$r){var D$e,D$U=0;for(D$e=D$m._cacheList.length,D$U=0;D$U<D$e;D$U++)if(D$m._cacheList[D$U].tryDispose==D$s&&D$m._cacheList[D$U].getCacheList==D$r)return void D$m._cacheList.splice(D$U,1)},D$m.forceDispose=function(){var D$s=0,D$r=D$m._cacheList.length;for(D$s=0;D$s<D$r;D$s++)D$m._cacheList[D$s].tryDispose(!0)},D$m.beginCheck=function(D$s){void 0===D$s&&(D$s=15e3),D$D.timer.loop(D$s,null,D$m._checkLoop)},D$m.stopCheck=function(){D$D.timer.clear(null,D$m._checkLoop)},D$m._checkLoop=function(){var D$s=D$m._cacheList;if(!(D$s.length<1)){var D$r,D$e=D$Q.now(),D$U=0;for(D$r=D$U=D$s.length;0<D$U&&(D$s[D$m._index=++D$m._index%D$r].tryDispose(!1),!(D$Q.now()-D$e>D$m.loopTimeLimit));)D$U--}},D$m.loopTimeLimit=2,D$m._cacheList=[],D$m._index=0,D$m}(),D$a=function(){function D$x(){}return D$h(D$x,"laya.utils.ClassUtils"),D$x.regClass=function(D$s,D$r){D$x._classMap[D$s]=D$r},D$x.getRegClass=function(D$s){return D$x._classMap[D$s]},D$x.getInstance=function(D$s){var D$r=D$x.getClass(D$s);return D$r?new D$r:(console.warn("[error] Undefined class:",D$s),null)},D$x.createByJson=function(D$s,D$r,D$e,D$U,D$m){"string"==typeof D$s&&(D$s=JSON.parse(D$s));var D$k=D$s.props;if(!D$r&&!(D$r=D$m?D$m.runWith(D$s):D$x.getInstance(D$k.runtime||D$s.type)))return null;var D$j=D$s.child;if(D$j)for(var D$T=0,D$Y=D$j.length;D$T<D$Y;D$T++){var D$Z=D$j[D$T];if("render"!==D$Z.props.name&&"render"!==D$Z.props.renderType||!D$r._$set_itemRender)if("Graphic"==D$Z.type)D$x.addGraphicsToSprite(D$Z,D$r);else if(D$x.isDrawType(D$Z.type))D$x.addGraphicToSprite(D$Z,D$r,!0);else{var D$h=D$x.createByJson(D$Z,null,D$e,D$U,D$m);"Script"==D$Z.type?D$h.hasOwnProperty("owner")?D$h.owner=D$r:D$h.hasOwnProperty("target")&&(D$h.target=D$r):"mask"==D$Z.props.renderType?D$r.mask=D$h:D$r.addChild(D$h)}else D$r.itemRender=D$Z}if(D$k)for(var D$H in D$k){var D$A=D$k[D$H];"var"===D$H&&D$e?D$e[D$A]=D$r:D$A instanceof Array&&"function"==typeof D$r[D$H]?D$r[D$H].apply(D$r,D$A):D$r[D$H]=D$A}return D$U&&D$s.customProps&&D$U.runWith([D$r,D$s]),D$r.created&&D$r.created(),D$r},D$x.addGraphicsToSprite=function(D$s,D$r){var D$e;if((D$e=D$s.child)&&!(D$e.length<1)){var D$U;D$U=D$x._getGraphicsFromSprite(D$s,D$r);var D$m=0,D$k=0;D$s.props&&(D$m=D$x._getObjVar(D$s.props,"x",0),D$k=D$x._getObjVar(D$s.props,"y",0)),0!=D$m&&0!=D$k&&D$U.translate(D$m,D$k);var D$j,D$T=0;for(D$j=D$e.length,D$T=0;D$T<D$j;D$T++)D$x._addGraphicToGraphics(D$e[D$T],D$U);0!=D$m&&0!=D$k&&D$U.translate(-D$m,-D$k)}},D$x.addGraphicToSprite=function(D$s,D$r,D$e){var D$U;void 0===D$e&&(D$e=!1),D$U=D$e?D$x._getGraphicsFromSprite(D$s,D$r):D$r.graphics,D$x._addGraphicToGraphics(D$s,D$U)},D$x._getGraphicsFromSprite=function(D$s,D$r){var D$e,D$U;if(!D$s||!D$s.props)return D$r.graphics;switch(D$U=D$s.props.renderType){case"hit":case"unHit":var D$m;D$r.hitArea||(D$r.hitArea=new D$G),(D$m=D$r.hitArea)[D$U]||(D$m[D$U]=new D$A),D$e=D$m[D$U]}return D$e||(D$e=D$r.graphics),D$e},D$x._getTransformData=function(D$s){var D$r;(D$s.hasOwnProperty("pivotX")||D$s.hasOwnProperty("pivotY"))&&(D$r=D$r||new D$O).translate(-D$x._getObjVar(D$s,"pivotX",0),-D$x._getObjVar(D$s,"pivotY",0));var D$e=D$x._getObjVar(D$s,"scaleX",1),D$U=D$x._getObjVar(D$s,"scaleY",1),D$m=D$x._getObjVar(D$s,"rotation",0);D$x._getObjVar(D$s,"skewX",0),D$x._getObjVar(D$s,"skewY",0);return 1==D$e&&1==D$U&&0==D$m||((D$r=D$r||new D$O).scale(D$e,D$U),D$r.rotate(.0174532922222222*D$m)),D$r},D$x._addGraphicToGraphics=function(D$s,D$r){var D$e,D$U;if((D$e=D$s.props)&&(D$U=D$x.DrawTypeDic[D$s.type])){var D$m,D$k;D$m=D$r;var D$j=D$x._getParams(D$e,D$U[1],D$U[2],D$U[3]);((D$k=D$x._tM)||1!=D$x._alpha)&&(D$m.save(),D$k&&D$m.transform(D$k),1!=D$x._alpha&&D$m.alpha(D$x._alpha)),D$m[D$U[0]].apply(D$m,D$j),(D$k||1!=D$x._alpha)&&D$m.restore()}},D$x._adptLineData=function(D$s){return D$s[2]=parseFloat(D$s[0])+parseFloat(D$s[2]),D$s[3]=parseFloat(D$s[1])+parseFloat(D$s[3]),D$s},D$x._adptTextureData=function(D$s){return D$s[0]=D$Ts.getRes(D$s[0]),D$s},D$x._adptLinesData=function(D$s){return D$s[2]=D$x._getPointListByStr(D$s[2]),D$s},D$x.isDrawType=function(D$s){return"Image"!=D$s&&D$x.DrawTypeDic.hasOwnProperty(D$s)},D$x._getParams=function(D$s,D$r,D$e,D$U){var D$m;void 0===D$e&&(D$e=0),(D$m=D$x._temParam).length=D$r.length;var D$k,D$j,D$T=0;for(D$k=D$r.length,D$T=0;D$T<D$k;D$T++)D$m[D$T]=D$x._getObjVar(D$s,D$r[D$T][0],D$r[D$T][1]);return D$x._alpha=D$x._getObjVar(D$s,"alpha",1),D$j=D$x._getTransformData(D$s),D$x._tM=D$j?(D$e||(D$e=0),D$j.translate(D$m[D$e],D$m[D$e+1]),D$m[D$e]=D$m[D$e+1]=0,D$j):null,D$U&&D$x[D$U]&&(D$m=D$x[D$U](D$m)),D$m},D$x._getPointListByStr=function(D$s){var D$r,D$e,D$U=0;for(D$e=(D$r=D$s.split(",")).length,D$U=0;D$U<D$e;D$U++)D$r[D$U]=parseFloat(D$r[D$U]);return D$r},D$x._getObjVar=function(D$s,D$r,D$e){return D$s.hasOwnProperty(D$r)?D$s[D$r]:D$e},D$x._temParam=[],D$x._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},D$x.getClass=function(D$s){var D$r=D$x._classMap[D$s]||D$s;return"string"==typeof D$r?D$D.__classmap[D$r]:D$r},D$x._tM=null,D$x._alpha=NaN,D$Y(D$x,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),D$x}(),D$p=function(){function D$k(D$s){if(this._color=[],"string"==typeof D$s){null===(this.strColor=D$s)&&(D$s="#000000"),"#"==D$s.charAt(0)&&(D$s=D$s.substr(1));var D$r=D$s.length;if(3==D$r||4==D$r){for(var D$e="",D$U=0;D$U<D$r;D$U++)D$e+=D$s[D$U]+D$s[D$U];D$s=D$e}var D$m=this.numColor=parseInt(D$s,16);if(8==D$s.length)return void(this._color=[parseInt(D$s.substr(0,2),16)/255,((16711680&D$m)>>16)/255,((65280&D$m)>>8)/255,(255&D$m)/255])}else D$m=this.numColor=D$s,this.strColor=D$u.toHexColor(D$m);this._color=[((16711680&D$m)>>16)/255,((65280&D$m)>>8)/255,(255&D$m)/255,1],this._color.__id=++D$k._COLODID}return D$h(D$k,"laya.utils.Color"),D$k._initDefault=function(){for(var D$s in D$k._DEFAULT={},D$k._COLOR_MAP)D$k._SAVE[D$s]=D$k._DEFAULT[D$s]=new D$k(D$k._COLOR_MAP[D$s]);return D$k._DEFAULT},D$k._initSaveMap=function(){for(var D$s in D$k._SAVE_SIZE=0,D$k._SAVE={},D$k._DEFAULT)D$k._SAVE[D$s]=D$k._DEFAULT[D$s]},D$k.create=function(D$s){var D$r=D$k._SAVE[D$s+""];return null!=D$r?D$r:(D$k._SAVE_SIZE<1e3||D$k._initSaveMap(),D$k._SAVE[D$s+""]=new D$k(D$s))},D$k._SAVE={},D$k._SAVE_SIZE=0,D$k._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},D$k._DEFAULT=D$k._initDefault(),D$k._COLODID=1,D$k}(),D$N=(function(){function D$s(){this._values=[],this._keys=[]}D$h(D$s,"laya.utils.Dictionary");var D$r=D$s.prototype;D$r.set=function(D$s,D$r){var D$e=this.indexOf(D$s);0<=D$e?this._values[D$e]=D$r:(this._keys.push(D$s),this._values.push(D$r))},D$r.indexOf=function(D$s){var D$r=this._keys.indexOf(D$s);return 0<=D$r?D$r:(D$s="string"==typeof D$s?Number(D$s):"number"==typeof D$s?D$s.toString():D$s,this._keys.indexOf(D$s))},D$r.get=function(D$s){var D$r=this.indexOf(D$s);return D$r<0?null:this._values[D$r]},D$r.remove=function(D$s){var D$r=this.indexOf(D$s);return 0<=D$r&&(this._keys.splice(D$r,1),this._values.splice(D$r,1),!0)},D$r.clear=function(){this._values.length=0,this._keys.length=0},D$B(0,D$r,"values",function(){return this._values}),D$B(0,D$r,"keys",function(){return this._keys})}(),function(){function D$s(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}D$h(D$s,"laya.utils.Dragging");var D$r=D$s.prototype;return D$r.start=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){void 0===D$T&&(D$T=.92),this.clearTimer(),this.target=D$s,this.area=D$r,this.hasInertia=D$e,this.elasticDistance=D$r?D$U:0,this.elasticBackTime=D$m,this.data=D$k,this._disableMouseEvent=D$j,this.ratio=D$T,1!=D$s.globalScaleX||1!=D$s.globalScaleY?this._parent=D$s.parent:this._parent=D$D.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,D$D.stage.on("mouseup",this,this.onStageMouseUp),D$D.stage.on("mouseout",this,this.onStageMouseUp),D$D.timer.frameLoop(1,this,this.loop)},D$r.clearTimer=function(){D$D.timer.clear(this,this.loop),D$D.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},D$r.stop=function(){this._dragging&&(D$$.instance.disableMouseEvent=!1,D$D.stage.off("mouseup",this,this.onStageMouseUp),D$D.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},D$r.loop=function(){var D$s=this._parent.getMousePoint(),D$r=D$s.x,D$e=D$s.y,D$U=D$r-this._lastX,D$m=D$e-this._lastY;if(this._clickOnly){if(!(1<Math.abs(D$U*D$D.stage._canvasTransform.getScaleX())||1<Math.abs(D$m*D$D.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),D$$.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(D$U,D$m);0==D$U&&0==D$m||(this._lastX=D$r,this._lastY=D$e,this.target.x+=D$U*this._elasticRateX,this.target.y+=D$m*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},D$r.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var D$s=this.area.x-this.target.x;else D$s=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-D$s/this.elasticDistance),this.target.y<this.area.y)var D$r=this.area.y-this.target.y;else D$r=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-D$r/this.elasticDistance)}},D$r.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},D$r.onStageMouseUp=function(D$s){if(D$$.instance.disableMouseEvent=!1,D$D.stage.off("mouseup",this,this.onStageMouseUp),D$D.stage.off("mouseout",this,this.onStageMouseUp),D$D.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var D$r=this._offsets.length,D$e=Math.min(D$r,6),D$U=this._offsets.length-D$e,D$m=D$r-1;D$U<D$m;D$m--)this._offsetY+=this._offsets[D$m--],this._offsetX+=this._offsets[D$m];this._offsetX=this._offsetX/D$e*2,this._offsetY=this._offsetY/D$e*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),D$D.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},D$r.checkElastic=function(){var D$s=NaN,D$r=NaN;if(this.target.x<this.area.x?D$s=this.area.x:this.target.x>this.area.x+this.area.width&&(D$s=this.area.x+this.area.width),this.target.y<this.area.y?D$r=this.area.y:this.target.y>this.area.y+this.area.height&&(D$r=this.area.y+this.area.height),isNaN(D$s)&&isNaN(D$r))this.clear();else{var D$e={};isNaN(D$s)||(D$e.x=D$s),isNaN(D$r)||(D$e.y=D$r),this._tween=D$L.to(this.target,D$e,this.elasticBackTime,D$q.sineOut,D$b.create(this,this.clear),0,!1,!1)}},D$r.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(D$D.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},D$r.clear=function(){if(this.target){this.clearTimer();var D$s=this.target;this.target=null,this._parent=null,D$s.event("dragend",this.data)}},D$s}()),D$q=function(){function D$T(){}return D$h(D$T,"laya.utils.Ease"),D$T.linearNone=function(D$s,D$r,D$e,D$U){return D$e*D$s/D$U+D$r},D$T.linearIn=function(D$s,D$r,D$e,D$U){return D$e*D$s/D$U+D$r},D$T.linearInOut=function(D$s,D$r,D$e,D$U){return D$e*D$s/D$U+D$r},D$T.linearOut=function(D$s,D$r,D$e,D$U){return D$e*D$s/D$U+D$r},D$T.bounceIn=function(D$s,D$r,D$e,D$U){return D$e-D$T.bounceOut(D$U-D$s,0,D$e,D$U)+D$r},D$T.bounceInOut=function(D$s,D$r,D$e,D$U){return D$s<.5*D$U?.5*D$T.bounceIn(2*D$s,0,D$e,D$U)+D$r:.5*D$T.bounceOut(2*D$s-D$U,0,D$e,D$U)+.5*D$e+D$r},D$T.bounceOut=function(D$s,D$r,D$e,D$U){return(D$s/=D$U)<1/2.75?D$e*(7.5625*D$s*D$s)+D$r:D$s<2/2.75?D$e*(7.5625*(D$s-=1.5/2.75)*D$s+.75)+D$r:D$s<2.5/2.75?D$e*(7.5625*(D$s-=2.25/2.75)*D$s+.9375)+D$r:D$e*(7.5625*(D$s-=2.625/2.75)*D$s+.984375)+D$r},D$T.backIn=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$m&&(D$m=1.70158),D$e*(D$s/=D$U)*D$s*((D$m+1)*D$s-D$m)+D$r},D$T.backInOut=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$m&&(D$m=1.70158),(D$s/=.5*D$U)<1?.5*D$e*(D$s*D$s*((1+(D$m*=1.525))*D$s-D$m))+D$r:D$e/2*((D$s-=2)*D$s*((1+(D$m*=1.525))*D$s+D$m)+2)+D$r},D$T.backOut=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$m&&(D$m=1.70158),D$e*((D$s=D$s/D$U-1)*D$s*((D$m+1)*D$s+D$m)+1)+D$r},D$T.elasticIn=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j;return void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=0),0==D$s?D$r:1==(D$s/=D$U)?D$r+D$e:(D$k||(D$k=.3*D$U),D$j=!D$m||0<D$e&&D$m<D$e||D$e<0&&D$m<-D$e?(D$m=D$e,D$k/4):D$k/D$T.PI2*Math.asin(D$e/D$m),-D$m*Math.pow(2,10*(D$s-=1))*Math.sin((D$s*D$U-D$j)*D$T.PI2/D$k)+D$r)},D$T.elasticInOut=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j;return void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=0),0==D$s?D$r:2==(D$s/=.5*D$U)?D$r+D$e:(D$k||(D$k=D$U*(.3*1.5)),D$j=!D$m||0<D$e&&D$m<D$e||D$e<0&&D$m<-D$e?(D$m=D$e,D$k/4):D$k/D$T.PI2*Math.asin(D$e/D$m),D$s<1?D$m*Math.pow(2,10*(D$s-=1))*Math.sin((D$s*D$U-D$j)*D$T.PI2/D$k)*-.5+D$r:D$m*Math.pow(2,-10*(D$s-=1))*Math.sin((D$s*D$U-D$j)*D$T.PI2/D$k)*.5+D$e+D$r)},D$T.elasticOut=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j;return void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=0),0==D$s?D$r:1==(D$s/=D$U)?D$r+D$e:(D$k||(D$k=.3*D$U),D$j=!D$m||0<D$e&&D$m<D$e||D$e<0&&D$m<-D$e?(D$m=D$e,D$k/4):D$k/D$T.PI2*Math.asin(D$e/D$m),D$m*Math.pow(2,-10*D$s)*Math.sin((D$s*D$U-D$j)*D$T.PI2/D$k)+D$e+D$r)},D$T.strongIn=function(D$s,D$r,D$e,D$U){return D$e*(D$s/=D$U)*D$s*D$s*D$s*D$s+D$r},D$T.strongInOut=function(D$s,D$r,D$e,D$U){return(D$s/=.5*D$U)<1?.5*D$e*D$s*D$s*D$s*D$s*D$s+D$r:.5*D$e*((D$s-=2)*D$s*D$s*D$s*D$s+2)+D$r},D$T.strongOut=function(D$s,D$r,D$e,D$U){return D$e*((D$s=D$s/D$U-1)*D$s*D$s*D$s*D$s+1)+D$r},D$T.sineInOut=function(D$s,D$r,D$e,D$U){return.5*-D$e*(Math.cos(Math.PI*D$s/D$U)-1)+D$r},D$T.sineIn=function(D$s,D$r,D$e,D$U){return-D$e*Math.cos(D$s/D$U*D$T.HALF_PI)+D$e+D$r},D$T.sineOut=function(D$s,D$r,D$e,D$U){return D$e*Math.sin(D$s/D$U*D$T.HALF_PI)+D$r},D$T.quintIn=function(D$s,D$r,D$e,D$U){return D$e*(D$s/=D$U)*D$s*D$s*D$s*D$s+D$r},D$T.quintInOut=function(D$s,D$r,D$e,D$U){return(D$s/=.5*D$U)<1?.5*D$e*D$s*D$s*D$s*D$s*D$s+D$r:.5*D$e*((D$s-=2)*D$s*D$s*D$s*D$s+2)+D$r},D$T.quintOut=function(D$s,D$r,D$e,D$U){return D$e*((D$s=D$s/D$U-1)*D$s*D$s*D$s*D$s+1)+D$r},D$T.quartIn=function(D$s,D$r,D$e,D$U){return D$e*(D$s/=D$U)*D$s*D$s*D$s+D$r},D$T.quartInOut=function(D$s,D$r,D$e,D$U){return(D$s/=.5*D$U)<1?.5*D$e*D$s*D$s*D$s*D$s+D$r:.5*-D$e*((D$s-=2)*D$s*D$s*D$s-2)+D$r},D$T.quartOut=function(D$s,D$r,D$e,D$U){return-D$e*((D$s=D$s/D$U-1)*D$s*D$s*D$s-1)+D$r},D$T.cubicIn=function(D$s,D$r,D$e,D$U){return D$e*(D$s/=D$U)*D$s*D$s+D$r},D$T.cubicInOut=function(D$s,D$r,D$e,D$U){return(D$s/=.5*D$U)<1?.5*D$e*D$s*D$s*D$s+D$r:.5*D$e*((D$s-=2)*D$s*D$s+2)+D$r},D$T.cubicOut=function(D$s,D$r,D$e,D$U){return D$e*((D$s=D$s/D$U-1)*D$s*D$s+1)+D$r},D$T.quadIn=function(D$s,D$r,D$e,D$U){return D$e*(D$s/=D$U)*D$s+D$r},D$T.quadInOut=function(D$s,D$r,D$e,D$U){return(D$s/=.5*D$U)<1?.5*D$e*D$s*D$s+D$r:.5*-D$e*(--D$s*(D$s-2)-1)+D$r},D$T.quadOut=function(D$s,D$r,D$e,D$U){return-D$e*(D$s/=D$U)*(D$s-2)+D$r},D$T.expoIn=function(D$s,D$r,D$e,D$U){return 0==D$s?D$r:D$e*Math.pow(2,10*(D$s/D$U-1))+D$r-.001*D$e},D$T.expoInOut=function(D$s,D$r,D$e,D$U){return 0==D$s?D$r:D$s==D$U?D$r+D$e:(D$s/=.5*D$U)<1?.5*D$e*Math.pow(2,10*(D$s-1))+D$r:.5*D$e*(2-Math.pow(2,-10*--D$s))+D$r},D$T.expoOut=function(D$s,D$r,D$e,D$U){return D$s==D$U?D$r+D$e:D$e*(1-Math.pow(2,-10*D$s/D$U))+D$r},D$T.circIn=function(D$s,D$r,D$e,D$U){return-D$e*(Math.sqrt(1-(D$s/=D$U)*D$s)-1)+D$r},D$T.circInOut=function(D$s,D$r,D$e,D$U){return(D$s/=.5*D$U)<1?.5*-D$e*(Math.sqrt(1-D$s*D$s)-1)+D$r:.5*D$e*(Math.sqrt(1-(D$s-=2)*D$s)+1)+D$r},D$T.circOut=function(D$s,D$r,D$e,D$U){return D$e*Math.sqrt(1-(D$s=D$s/D$U-1)*D$s)+D$r},D$T.HALF_PI=.5*Math.PI,D$T.PI2=2*Math.PI,D$T}(),D$G=function(){function D$H(){this._hit=null,this._unHit=null}D$h(D$H,"laya.utils.HitArea");var D$s=D$H.prototype;return D$s.isHit=function(D$s,D$r){return!!D$H.isHitGraphic(D$s,D$r,this.hit)&&!D$H.isHitGraphic(D$s,D$r,this.unHit)},D$s.contains=function(D$s,D$r){return this.isHit(D$s,D$r)},D$B(0,D$s,"hit",function(){return this._hit||(this._hit=new D$A),this._hit},function(D$s){this._hit=D$s}),D$B(0,D$s,"unHit",function(){return this._unHit||(this._unHit=new D$A),this._unHit},function(D$s){this._unHit=D$s}),D$H.isHitGraphic=function(D$s,D$r,D$e){if(!D$e)return!1;var D$U;if(!(D$U=D$e.cmds)&&D$e._one&&((D$U=D$H._cmds).length=1,D$U[0]=D$e._one),!D$U)return!1;var D$m,D$k,D$j=0;for(D$m=D$U.length,D$j=0;D$j<D$m;D$j++)if(D$k=D$U[D$j]){var D$T=D$c._context;switch(D$k.callee){case D$T._translate:case 6:D$s-=D$k[0],D$r-=D$k[1]}if(D$H.isHitCmd(D$s,D$r,D$k))return!0}return!1},D$H.isHitCmd=function(D$s,D$r,D$e){if(!D$e)return!1;var D$U=D$c._context,D$m=!1;switch(D$e.callee){case D$U._drawRect:case 13:D$H._rec.setTo(D$e[0],D$e[1],D$e[2],D$e[3]),D$m=D$H._rec.contains(D$s,D$r);break;case D$U._drawCircle:case D$U._fillCircle:case 14:D$m=(D$s-=D$e[0])*D$s+(D$r-=D$e[1])*D$r<D$e[2]*D$e[2];break;case D$U._drawPoly:case 18:D$s-=D$e[0],D$r-=D$e[1],D$m=D$H.ptInPolygon(D$s,D$r,D$e[2])}return D$m},D$H.ptInPolygon=function(D$s,D$r,D$e){var D$U;(D$U=D$H._ptPoint).setTo(D$s,D$r);var D$m,D$k=0,D$j=NaN,D$T=NaN,D$Y=NaN,D$Z=NaN;D$m=D$e.length;for(var D$h=0;D$h<D$m;D$h+=2){if(D$j=D$e[D$h],D$T=D$e[D$h+1],D$Y=D$e[(D$h+2)%D$m],D$T!=(D$Z=D$e[(D$h+3)%D$m]))if(!(D$U.y<Math.min(D$T,D$Z)))if(!(D$U.y>=Math.max(D$T,D$Z)))(D$U.y-D$T)*(D$Y-D$j)/(D$Z-D$T)+D$j>D$U.x&&D$k++}return D$k%2==1},D$H._cmds=[],D$Y(D$H,["_rec",function(){return this._rec=new D$y},"_ptPoint",function(){return this._ptPoint=new D$n}]),D$H}(),D$d=(function(){function D$m(D$s,D$r,D$e,D$U){this.char=D$s,this.charNum=D$s.charCodeAt(0),this._x=this._y=0,this.width=D$r,this.height=D$e,this.style=D$U,this.isWord=!D$m._isWordRegExp.test(D$s)}D$h(D$m,"laya.utils.HTMLChar");var D$s=D$m.prototype;D$D.imps(D$s,{"laya.display.ILayout":!0}),D$s.setSprite=function(D$s){this._sprite=D$s},D$s.getSprite=function(){return this._sprite},D$s._isChar=function(){return!0},D$s._getCSSStyle=function(){return this.style},D$B(0,D$s,"width",function(){return this._w},function(D$s){this._w=D$s}),D$B(0,D$s,"x",function(){return this._x},function(D$s){this._sprite&&(this._sprite.x=D$s),this._x=D$s}),D$B(0,D$s,"y",function(){return this._y},function(D$s){this._sprite&&(this._sprite.y=D$s),this._y=D$s}),D$B(0,D$s,"height",function(){return this._h},function(D$s){this._h=D$s}),D$m._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function D$r(){}D$h(D$r,"laya.utils.Log"),D$r.enable=function(){D$r._logdiv||(D$r._logdiv=D$Q.window.document.createElement("div"),D$Q.window.document.body.appendChild(D$r._logdiv),D$r._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},D$r.toggle=function(){var D$s=D$r._logdiv.style;"1px"==D$s.width?D$s.width=D$s.height="50%":D$s.width=D$s.height="1px"},D$r.print=function(D$s){D$r._logdiv&&(D$r.maxCount<=D$r._count&&D$r.clear(),D$r._count++,D$r._logdiv.innerText+=D$s+"\n",D$r._logdiv.scrollTop=D$r._logdiv.scrollHeight)},D$r.clear=function(){D$r._logdiv.innerText="",D$r._count=0},D$r._logdiv=null,D$r._count=0,D$r.maxCount=20}(),function(){function D$r(){}D$h(D$r,"laya.utils.Mouse"),D$B(1,D$r,"cursor",function(){return D$r._style.cursor},function(D$s){D$r._style.cursor=D$s}),D$r.hide=function(){"none"!=D$r.cursor&&(D$r._preCursor=D$r.cursor,D$r.cursor="none")},D$r.show=function(){"none"==D$r.cursor&&(D$r.cursor=D$r._preCursor?D$r._preCursor:"auto")},D$r._preCursor=null,D$Y(D$r,["_style",function(){return this._style=D$Q.document.body.style}])}(),function(){function D$k(){}return D$h(D$k,"laya.utils.Pool"),D$k.getPoolBySign=function(D$s){return D$k._poolDic[D$s]||(D$k._poolDic[D$s]=[])},D$k.clearBySign=function(D$s){D$k._poolDic[D$s]&&(D$k._poolDic[D$s].length=0)},D$k.recover=function(D$s,D$r){D$r.__InPool||(D$r.__InPool=!0,D$k.getPoolBySign(D$s).push(D$r))},D$k.getItemByClass=function(D$s,D$r){var D$e=D$k.getPoolBySign(D$s),D$U=D$e.length?D$e.pop():new D$r;return D$U.__InPool=!1,D$U},D$k.getItemByCreateFun=function(D$s,D$r,D$e){var D$U=D$k.getPoolBySign(D$s),D$m=D$U.length?D$U.pop():D$r.call(D$e);return D$m.__InPool=!1,D$m},D$k.getItem=function(D$s){var D$r=D$k.getPoolBySign(D$s),D$e=D$r.length?D$r.pop():null;return D$e&&(D$e.__InPool=!1),D$e},D$k._poolDic={},D$k.InPoolSign="__InPool",D$k}()),D$t=function(){function D$Y(){}return D$h(D$Y,"laya.utils.Stat"),D$B(1,D$Y,"onclick",null,function(D$s){D$Y._sp&&D$Y._sp.on("click",D$Y._sp,D$s),D$Y._canvas&&(D$Y._canvas.source.onclick=D$s,D$Y._canvas.source.style.pointerEvents="")}),D$Y.show=function(D$s,D$r,D$e){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),!D$c.isConchApp||D$c.isConchWebGL){if(D$c.isConchWebGL||D$Q.onMiniGame||D$Q.onLimixiu||(D$Y._useCanvas=!0),D$Y._show=!0,D$Y._fpsData.length=60,D$Y._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},D$Y._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},D$Y._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},D$Y._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},D$c.isWebGL)if(D$Y._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},D$c.is3DMode){if(D$Y._view[0].title="FPS(3D)",D$Y._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},D$Y._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},D$Y._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==D$e){var D$U=8;D$Y._view[D$U++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},D$Y._view[D$U++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},D$Y._view[D$U++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},D$Y._view[D$U++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},D$Y._view[D$U++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},D$Y._view[D$U++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},D$Y._view[D$U++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},D$Y._view[D$U++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},D$Y._view[D$U++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==D$e){D$U=8;D$Y._view[D$U++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},D$Y._view[D$U++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},D$Y._view[D$U++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},D$Y._view[D$U++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},D$Y._view[D$U++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},D$Y._view[D$U++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},D$Y._view[D$U++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else D$Y._view[0].title="FPS(WebGL)",D$Y._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else D$Y._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};D$Y._useCanvas?D$Y.createUIPre(D$s,D$r):D$Y.createUI(D$s,D$r),D$Y.enable()}else D$Q.window.conch.showFPS&&D$Q.window.conch.showFPS(D$s,D$r)},D$Y.createUIPre=function(D$s,D$r){var D$e=D$Q.pixelRatio;D$Y._width=170*D$e,D$Y._vx=75*D$e,D$Y._height=D$e*(12*D$Y._view.length+3*D$e)+4,D$Y._fontSize=12*D$e;for(var D$U=0;D$U<D$Y._view.length;D$U++)D$Y._view[D$U].x=4,D$Y._view[D$U].y=D$U*D$Y._fontSize+2*D$e;D$Y._canvas||((D$Y._canvas=new D$os("2D")).size(D$Y._width,D$Y._height),(D$Y._ctx=D$Y._canvas.getContext("2d")).textBaseline="top",D$Y._ctx.font=D$Y._fontSize+"px Sans-serif",D$Y._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+D$s+"px;top:"+D$r+"px;width:"+D$Y._width/D$e+"px;height:"+D$Y._height/D$e+"px;"),D$Y._first=!0,D$Y.loop(),D$Y._first=!1,D$Q.container.appendChild(D$Y._canvas.source)},D$Y.createUI=function(D$s,D$r){var D$e=D$Y._sp,D$U=D$Q.pixelRatio;D$e||(D$e=new D$Hs,(D$Y._leftText=new D$ls).pos(5,5),D$Y._leftText.color="#ffffff",D$e.addChild(D$Y._leftText),(D$Y._txt=new D$ls).pos(80*D$U,5),D$Y._txt.color="#ffffff",D$e.addChild(D$Y._txt),D$Y._sp=D$e),D$e.pos(D$s,D$r);for(var D$m="",D$k=0;D$k<D$Y._view.length;D$k++){D$m+=D$Y._view[D$k].title+"\n"}D$Y._leftText.text=D$m;var D$j=170*D$U,D$T=D$U*(12*D$Y._view.length+3*D$U)+4;D$Y._txt.fontSize=D$Y._fontSize*D$U,D$Y._leftText.fontSize=D$Y._fontSize*D$U,D$e.size(D$j,D$T),D$e.graphics.clear(),D$e.graphics.setAlpha(.5),D$e.graphics.drawRect(0,0,D$j,D$T,"#999999"),D$e.graphics.setAlpha(1),D$Y.loop()},D$Y.enable=function(){D$D.timer.frameLoop(1,D$Y,D$Y.loop)},D$Y.hide=function(){D$Y._show=!1,D$D.timer.clear(D$Y,D$Y.loop),D$Y._canvas&&D$Q.removeElement(D$Y._canvas.source)},D$Y.clear=function(){D$Y.trianglesFaces=D$Y.drawCall=D$Y.shaderCall=D$Y.spriteCount=D$Y.spriteRenderUseCacheCount=D$Y.treeNodeCollision=D$Y.treeSpriteCollision=D$Y.canvasNormal=D$Y.canvasBitmap=D$Y.canvasReCache=0},D$Y.loop=function(){D$Y._count++;var D$s=D$Q.now();if(!(D$s-D$Y._timer<1e3)){var D$r=D$Y._count;if(D$Y.FPS=Math.round(1e3*D$r/(D$s-D$Y._timer)),D$Y._show){D$Y.trianglesFaces=Math.round(D$Y.trianglesFaces/D$r),D$Y.spriteCount=D$Y._useCanvas?(D$Y.drawCall=Math.round(D$Y.drawCall/D$r)-2,D$Y.shaderCall=Math.round(D$Y.shaderCall/D$r),Math.round(D$Y.spriteCount/D$r)-1):(D$Y.drawCall=Math.round(D$Y.drawCall/D$r)-2,D$Y.shaderCall=Math.round(D$Y.shaderCall/D$r)-4,Math.round(D$Y.spriteCount/D$r)-4),D$Y.spriteRenderUseCacheCount=Math.round(D$Y.spriteRenderUseCacheCount/D$r),D$Y.canvasNormal=Math.round(D$Y.canvasNormal/D$r),D$Y.canvasBitmap=Math.round(D$Y.canvasBitmap/D$r),D$Y.canvasReCache=Math.ceil(D$Y.canvasReCache/D$r),D$Y.treeNodeCollision=Math.round(D$Y.treeNodeCollision/D$r),D$Y.treeSpriteCollision=Math.round(D$Y.treeSpriteCollision/D$r);var D$e=0<D$Y.FPS?Math.floor(1e3/D$Y.FPS).toString():" ";D$Y._fpsStr=D$Y.FPS+(D$Y.renderSlow?" slow":"")+" "+D$e,D$Y._spriteStr=D$Y.spriteCount+(D$Y.spriteRenderUseCacheCount?"/"+D$Y.spriteRenderUseCacheCount:""),D$Y._canvasStr=D$Y.canvasReCache+"/"+D$Y.canvasNormal+"/"+D$Y.canvasBitmap,D$Y.currentMemorySize=D$z.systemResourceManager.memorySize,D$Y._useCanvas?D$Y.renderInfoPre():D$Y.renderInfo(),D$Y.clear()}D$Y._count=0,D$Y._timer=D$s}},D$Y.renderInfoPre=function(){if(D$Y._canvas){var D$s=D$Y._ctx;D$s.clearRect(D$Y._first?0:D$Y._vx,0,D$Y._width,D$Y._height);for(var D$r=D$c.WebGL.mainContext,D$e=0;D$e<D$Y._view.length;D$e++){var D$U=D$Y._view[D$e];D$Y._first&&(D$s.fillStyle="white",D$s.fillText(D$U.title,D$U.x,D$U.y,null,null,null)),D$s.fillStyle=D$U.color;var D$m=-1;if((D$U=D$Y._view[D$e]).varying){if(D$r)switch(D$U.varying){case 1:D$m=D$r.getParameter(D$r[D$U.value]);break;case 2:D$m=D$r.getExtension(D$U.value)}}else D$m=D$Y[D$U.value];"M"==D$U.units&&(D$m=Math.floor(D$m/1048576*100)/100+" M"),"K"==D$U.units&&(D$m=Math.floor(D$m/1024*100)/100+" K"),"string"==D$U.units&&(D$m=D$m.match(/\d+\.?\d/i)),D$s.fillText(D$m+"",D$U.x+D$Y._vx,D$U.y,null,null,null)}}},D$Y.renderInfo=function(){for(var D$s="",D$r=D$c.WebGL.mainContext,D$e=0;D$e<D$Y._view.length;D$e++){var D$U=D$Y._view[D$e],D$m=-1;if(D$U.varying){if(D$r)switch(D$U.varying){case 1:D$m=D$r.getParameter(D$r[D$U.value]);break;case 2:D$m=D$r.getExtension(D$U.value)}}else D$m=D$Y[D$U.value];"M"==D$U.units&&(D$m=Math.floor(D$m/1048576*100)/100+" M"),"K"==D$U.units&&(D$m=Math.floor(D$m/1024*100)/100+" K"),"string"==D$U.units&&(D$m=D$m.match(/\d+\.?\d/i)),D$s+=D$m+"\n"}D$Y._txt.text=D$s},D$Y.FPS=0,D$Y.loopCount=0,D$Y.shaderCall=0,D$Y.drawCall=0,D$Y.trianglesFaces=0,D$Y.spriteCount=0,D$Y.spriteRenderUseCacheCount=0,D$Y.treeNodeCollision=0,D$Y.treeSpriteCollision=0,D$Y.canvasNormal=0,D$Y.canvasBitmap=0,D$Y.canvasReCache=0,D$Y.renderSlow=!1,D$Y.currentMemorySize=0,D$Y._fpsStr=null,D$Y._canvasStr=null,D$Y._spriteStr=null,D$Y._fpsData=[],D$Y._timer=0,D$Y._count=0,D$Y._view=[],D$Y._fontSize=12,D$Y._txt=null,D$Y._leftText=null,D$Y._sp=null,D$Y._show=!1,D$Y._useCanvas=!1,D$Y._canvas=null,D$Y._ctx=null,D$Y._first=!1,D$Y._vx=NaN,D$Y._width=0,D$Y._height=100,D$Y}(),D$W=(function(){function D$s(){this._strsToID={},this._idToStrs=[],this._length=0}D$h(D$s,"laya.utils.StringKey");var D$r=D$s.prototype;D$r.add=function(D$s){var D$r=this._strsToID[D$s];return null!=D$r?D$r:(this._idToStrs[this._length]=D$s,this._strsToID[D$s]=this._length++)},D$r.getID=function(D$s){var D$r=this._strsToID[D$s];return null==D$r?-1:D$r},D$r.getName=function(D$s){var D$r=this._idToStrs[D$s];return null==D$r?void 0:D$r}}(),function(){var D$Z;function D$s(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}D$h(D$s,"laya.utils.Timer");var D$r=D$s.prototype;return D$r._init=function(){D$D.timer&&D$D.timer.frameLoop(1,this,this._update)},D$r._now=function(){return Date.now()},D$r._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var D$s=this.currFrame=this.currFrame+this.scale,D$r=this._now();this._delta=(D$r-this._lastTimer)*this.scale;var D$e=this.currTimer=this.currTimer+this._delta;D$D.isDebug&&6e4<Math.abs(D$r-this._lastTimer)&&console.error("系统时间错误！"+(D$r-this._lastTimer)),this._lastTimer=D$r;var D$U=this._handlers;for(D$j=this._count=0,D$T=D$U.length;D$j<D$T;D$j++)if(null!==(D$Y=D$U[D$j]).method){var D$m=D$Y.userFrame?D$s:D$e;if(D$m>=D$Y.exeTime)if(D$Y.repeat)if(D$Y.jumpFrame)for(;D$m>=D$Y.exeTime;)D$Y.exeTime+=D$Y.delay,D$Y.run(!1);else D$Y.exeTime+=D$Y.delay,D$Y.run(!1),D$m>D$Y.exeTime&&(D$Y.exeTime+=Math.ceil((D$m-D$Y.exeTime)/D$Y.delay)*D$Y.delay);else D$Y.run(!0)}else this._count++;(30<this._count||D$s%200==0)&&this._clearHandlers();for(var D$k=this._laters,D$j=0,D$T=D$k.length-1;D$j<=D$T;D$j++){var D$Y=D$k[D$j];this._isIgnoreRecover(D$Y)||(null!==D$Y.method&&(delete this._map[D$Y.key],D$Y.run(!1)),this._recoverHandler(D$Y)),D$j===D$T&&(D$T=D$k.length-1)}D$k.length=0}},D$r._clearHandlers=function(){for(var D$s=this._handlers,D$r=0,D$e=D$s.length;D$r<D$e;D$r++){var D$U=D$s[D$r];null!==D$U.method?this._temp.push(D$U):this._isIgnoreRecover(D$U)?this._temp.push(D$U):this._recoverHandler(D$U)}this._handlers=this._temp,this._temp=D$s,this._temp.length=0},D$r._recoverHandler=function(D$s){this._map[D$s.key]==D$s&&delete this._map[D$s.key],D$s.recover()},D$r._create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){if(!D$e)return D$m.apply(D$U,D$k),null;if(D$j){var D$Y=this._getHandler(D$U,D$m);if(D$Y)return D$Y.repeat=D$r,D$Y.userFrame=D$s,D$Y.delay=D$e,D$Y.ignoreRecover=D$T,D$Y.caller=D$U,D$Y.method=D$m,D$Y.args=D$k,D$Y.exeTime=D$e+(D$s?this.currFrame:this.currTimer+this._now()-this._lastTimer),D$Y}return(D$Y=D$Z.create()).repeat=D$r,D$Y.userFrame=D$s,D$Y.delay=D$e,D$Y.ignoreRecover=D$T,D$Y.caller=D$U,D$Y.method=D$m,D$Y.args=D$k,D$Y.exeTime=D$e+(D$s?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(D$Y),this._handlers.push(D$Y),D$Y},D$r._indexHandler=function(D$s){var D$r=D$s.caller,D$e=D$s.method,D$U=D$r?D$r.$_GID||(D$r.$_GID=D$u.getGID()):0,D$m=D$e.$_TID||(D$e.$_TID=this._mid++);D$s.key=D$U+"_"+D$m,this._map[D$s.key]=D$s},D$r.once=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=!0),this._create(!1,!1,D$s,D$r,D$e,D$U,D$m,!1)},D$r.loop=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){void 0===D$m&&(D$m=!0),void 0===D$k&&(D$k=!1),void 0===D$j&&(D$j=!1);var D$T=this._create(!1,!0,D$s,D$r,D$e,D$U,D$m,D$j);D$T&&(D$T.jumpFrame=D$k)},D$r.frameOnce=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=!0),this._create(!0,!1,D$s,D$r,D$e,D$U,D$m,!1)},D$r.frameLoop=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$m&&(D$m=!0),void 0===D$k&&(D$k=!1),this._create(!0,!0,D$s,D$r,D$e,D$U,D$m,D$k)},D$r.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+D$Z._freeCount},D$r.clear=function(D$s,D$r){var D$e=this._getHandler(D$s,D$r);return!(!D$e||this._isIgnoreRecover(D$e))&&(delete this._map[D$e.key],D$e.key=null,D$e.clear(),!0)},D$r.clearAll=function(D$s){if(D$s)for(var D$r=0,D$e=this._handlers.length;D$r<D$e;D$r++){var D$U=this._handlers[D$r];D$U.caller===D$s&&(this._isIgnoreRecover(D$U)||(delete this._map[D$U.key],D$U.key=null,D$U.clear()))}},D$r._getHandler=function(D$s,D$r){var D$e=D$s?D$s.$_GID||(D$s.$_GID=D$u.getGID()):0,D$U=D$r.$_TID||(D$r.$_TID=this._mid++);return this._map[D$e+"_"+D$U]},D$r._isIgnoreRecover=function(D$s){if(D$s.ignoreRecover||D$s.caller&&"IgnoreRecover"==D$s.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var D$r="";try{arguments.propertyIsEnumerable.caller}catch(D$s){D$r=D$s.stack}D$D.recordError("报错：核心定时器销毁忽略  "+D$r)}return!0}return!1},D$r.hasHandler=function(D$s,D$r){return this._map[D$s.$_GID+"_"+D$r.$_TID]},D$r.callLater=function(D$s,D$r,D$e){if(null==this._getHandler(D$s,D$r)){var D$U=D$Z.create();D$U.caller=D$s,D$U.method=D$r,D$U.args=D$e,this._indexHandler(D$U),this._laters.push(D$U)}},D$r.runCallLater=function(D$s,D$r){var D$e=this._getHandler(D$s,D$r);D$e&&null!=D$e.method&&(this._isIgnoreRecover(D$e)||(delete this._map[D$e.key],D$e.run(!0)))},D$r.runTimer=function(D$s,D$r){this.runCallLater(D$s,D$r)},D$B(0,D$r,"delta",function(){return this._delta}),D$s.__init$=function(){D$Z=function(){function D$r(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}D$h(D$r,"");var D$s=D$r.prototype;return D$s.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},D$s.recover=function(){this.clear(),this.args=D$r._freeHandler,D$r._freeHandler=this,D$r._freeCount++},D$s.run=function(D$s){var D$r=this.caller;if(D$r&&D$r.destroyed)return this.clear();var D$e=this.method,D$U=this.args;D$s&&this.clear(),null!=D$e&&(D$U?D$e.apply(D$r,D$U):D$e.call(D$r))},D$r._freeHandler=null,D$r._freeCount=0,D$r.create=function(){var D$s=D$r._freeHandler;return D$s?(D$r._freeHandler=D$s.args,--D$r._freeCount,D$s.args=null,D$s):new D$r},D$r}()},D$s}()),D$L=function(){function D$H(){this.gid=0}D$h(D$H,"laya.utils.Tween");var D$s=D$H.prototype;return D$s.to=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){return void 0===D$k&&(D$k=0),void 0===D$j&&(D$j=!1),this._create(D$s,D$r,D$e,D$U,D$m,D$k,D$j,!0,!1,!0)},D$s.from=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){return void 0===D$k&&(D$k=0),void 0===D$j&&(D$j=!1),this._create(D$s,D$r,D$e,D$U,D$m,D$k,D$j,!1,!1,!0)},D$s._create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){if(!D$s)throw new Error("Tween:target is null");this._target=D$s,this._duration=D$e,this._ease=D$U||D$r.ease||D$H.easeNone,this._complete=D$m||D$r.complete,this._delay=D$k,this._props=[],this._usedTimer=0,this._startTimer=D$Q.now(),this._usedPool=D$Y,this._delayParam=null,this.update=D$r.update;var D$h=D$s.$_GID||(D$s.$_GID=D$u.getGID());return D$H.tweenMap[D$h]?(D$j&&D$H.clearTween(D$s),D$H.tweenMap[D$h].push(this)):D$H.tweenMap[D$h]=[this],D$Z?D$k<=0?this.firstStart(D$s,D$r,D$T):(this._delayParam=[D$s,D$r,D$T],D$D.scaleTimer.once(D$k,this,this.firstStart,this._delayParam)):this._initProps(D$s,D$r,D$T),this},D$s.firstStart=function(D$s,D$r,D$e){this._delayParam=null,D$s.destroyed?this.clear():(this._initProps(D$s,D$r,D$e),this._beginLoop())},D$s._initProps=function(D$s,D$r,D$e){for(var D$U in D$r)if("number"==typeof D$s[D$U]){var D$m=D$e?D$s[D$U]:D$r[D$U],D$k=D$e?D$r[D$U]:D$s[D$U];this._props.push([D$U,D$m,D$k-D$m]),D$e||(D$s[D$U]=D$m)}},D$s._beginLoop=function(){D$D.scaleTimer.frameLoop(1,this,this._doEase)},D$s._doEase=function(){this._updateEase(D$Q.now())},D$s._updateEase=function(D$s){var D$r=this._target;if(D$r){if(D$r.destroyed)return D$H.clearTween(D$r);var D$e=this._usedTimer=D$s-this._startTimer-this._delay;if(!(D$e<0)){if(D$e>=this._duration)return this.complete();for(var D$U=0<D$e?this._ease(D$e,0,1,this._duration):0,D$m=this._props,D$k=0,D$j=D$m.length;D$k<D$j;D$k++){var D$T=D$m[D$k];D$r[D$T[0]]=D$T[1]+D$U*D$T[2]}this.update&&this.update.run()}}},D$s.complete=function(){if(this._target){D$D.scaleTimer.runTimer(this,this.firstStart);for(var D$s=this._target,D$r=this._props,D$e=this._complete,D$U=0,D$m=D$r.length;D$U<D$m;D$U++){var D$k=D$r[D$U];D$s[D$k[0]]=D$k[1]+D$k[2]}this.update&&this.update.run(),this.clear(),D$e&&D$e.run()}},D$s.pause=function(){D$D.scaleTimer.clear(this,this._beginLoop),D$D.scaleTimer.clear(this,this._doEase),D$D.scaleTimer.clear(this,this.firstStart);var D$s;(D$s=D$Q.now()-this._startTimer-this._delay)<0&&(this._usedTimer=D$s)},D$s.setStartTime=function(D$s){this._startTimer=D$s},D$s.clear=function(){this._target&&(this._remove(),this._clear())},D$s._clear=function(){this.pause(),D$D.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,D$d.recover("tween",this))},D$s.recover=function(){this._usedPool=!0,this._clear()},D$s._remove=function(){var D$s=D$H.tweenMap[this._target.$_GID];if(D$s)for(var D$r=0,D$e=D$s.length;D$r<D$e;D$r++)if(D$s[D$r]===this){D$s.splice(D$r,1);break}},D$s.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=D$Q.now(),this._delayParam)D$D.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var D$s=this._props,D$r=0,D$e=D$s.length;D$r<D$e;D$r++){var D$U=D$s[D$r];this._target[D$U[0]]=D$U[1]}D$D.scaleTimer.once(this._delay,this,this._beginLoop)}},D$s.resume=function(){this._usedTimer>=this._duration||(this._startTimer=D$Q.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?D$D.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},D$B(0,D$s,"progress",null,function(D$s){var D$r=D$s*this._duration;this._startTimer=D$Q.now()-this._delay-D$r}),D$H.to=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){return void 0===D$k&&(D$k=0),void 0===D$j&&(D$j=!1),void 0===D$T&&(D$T=!0),D$d.getItemByClass("tween",D$H)._create(D$s,D$r,D$e,D$U,D$m,D$k,D$j,!0,D$T,!0)},D$H.from=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){return void 0===D$k&&(D$k=0),void 0===D$j&&(D$j=!1),void 0===D$T&&(D$T=!0),D$d.getItemByClass("tween",D$H)._create(D$s,D$r,D$e,D$U,D$m,D$k,D$j,!1,D$T,!0)},D$H.clearAll=function(D$s){if(D$s&&D$s.$_GID){var D$r=D$H.tweenMap[D$s.$_GID];if(D$r){for(var D$e=0,D$U=D$r.length;D$e<D$U;D$e++)D$r[D$e]._clear();D$r.length=0}}},D$H.clear=function(D$s){D$s.clear()},D$H.clearTween=function(D$s){D$H.clearAll(D$s)},D$H.easeNone=function(D$s,D$r,D$e,D$U){return D$e*D$s/D$U+D$r},D$H.tweenMap={},D$H}(),D$u=function(){function D$T(){}return D$h(D$T,"laya.utils.Utils"),D$T.toRadian=function(D$s){return D$s*D$T._pi2},D$T.toAngle=function(D$s){return D$s*D$T._pi},D$T.toHexColor=function(D$s){if(D$s<0||isNaN(D$s))return null;for(var D$r=D$s.toString(16);D$r.length<6;)D$r="0"+D$r;return"#"+D$r},D$T.getGID=function(){return D$T._gid++},D$T.concatArray=function(D$s,D$r){if(!D$r)return D$s;if(!D$s)return D$r;var D$e=0,D$U=D$r.length;for(D$e=0;D$e<D$U;D$e++)D$s.push(D$r[D$e]);return D$s},D$T.clearArray=function(D$s){return D$s&&(D$s.length=0),D$s},D$T.copyArray=function(D$s,D$r){if(D$s||(D$s=[]),!D$r)return D$s;D$s.length=D$r.length;var D$e=0,D$U=D$r.length;for(D$e=0;D$e<D$U;D$e++)D$s[D$e]=D$r[D$e];return D$s},D$T.getGlobalRecByPoints=function(D$s,D$r,D$e,D$U,D$m){var D$k,D$j;return D$k=new D$n(D$r,D$e),D$k=D$s.localToGlobal(D$k),D$j=new D$n(D$U,D$m),D$j=D$s.localToGlobal(D$j),D$y._getWrapRec([D$k.x,D$k.y,D$j.x,D$j.y])},D$T.getGlobalPosAndScale=function(D$s){return D$T.getGlobalRecByPoints(D$s,0,0,1,1)},D$T.bind=function(D$s,D$r){return D$s.bind(D$r)},D$T.measureText=function(D$s,D$r){return D$P.measureText(D$s,D$r)},D$T.contextMeasureText=function(D$s){var D$r=D$Q.context.measureText(D$s);return D$r||(D$r={width:16,height:16}),D$r},D$T.updateOrder=function(D$s){if(!D$s||D$s.length<2)return!1;for(var D$r,D$e=1,D$U=0,D$m=D$s.length,D$k=NaN;D$e<D$m;){for(D$r=D$s[D$U=D$e],D$k=D$s[D$U]._zOrder;-1<--D$U&&D$s[D$U]._zOrder>D$k;)D$s[D$U+1]=D$s[D$U];D$s[D$U+1]=D$r,D$e++}var D$j=D$r.parent.conchModel;if(D$j)if(null!=D$j.updateZOrder)D$j.updateZOrder();else{for(D$e=0;D$e<D$m;D$e++)D$j.removeChild(D$s[D$e].conchModel);for(D$e=0;D$e<D$m;D$e++)D$j.addChildAt(D$s[D$e].conchModel,D$e)}return!0},D$T.transPointList=function(D$s,D$r,D$e){var D$U=0,D$m=D$s.length;for(D$U=0;D$U<D$m;D$U+=2)D$s[D$U]+=D$r,D$s[D$U+1]+=D$e},D$T.parseInt=function(D$s,D$r){void 0===D$r&&(D$r=0);var D$e=D$Q.window.parseInt(D$s,D$r);return isNaN(D$e)?0:D$e},D$T.getFileExtension=function(D$s){D$T._extReg.lastIndex=D$s.lastIndexOf(".");var D$r=D$T._extReg.exec(D$s);return D$r&&1<D$r.length?D$r[1].toLowerCase():null},D$T.getTransformRelativeToWindow=function(D$s,D$r,D$e){var D$U=D$D.stage,D$m=laya.utils.Utils.getGlobalPosAndScale(D$s),D$k=D$U._canvasTransform.clone(),D$j=D$k.tx,D$T=D$k.ty;D$k.rotate(-Math.PI/180*D$D.stage.canvasDegree),D$k.scale(D$D.stage.clientScaleX,D$D.stage.clientScaleY);var D$Y=D$D.stage.canvasDegree%180!=0,D$Z=NaN,D$h=NaN;D$Y?(D$Z=D$e+D$m.y,D$h=D$r+D$m.x,D$Z*=D$k.d,D$h*=D$k.a,90==D$D.stage.canvasDegree?(D$Z=D$j-D$Z,D$h+=D$T):(D$Z+=D$j,D$h=D$T-D$h)):(D$Z=D$r+D$m.x,D$h=D$e+D$m.y,D$Z*=D$k.a,D$h*=D$k.d,D$Z+=D$j,D$h+=D$T);var D$H=NaN,D$A=NaN;return D$A=D$Y?(D$H=D$k.d*D$m.height,D$k.a*D$m.width):(D$H=D$k.a*D$m.width,D$k.d*D$m.height),{x:D$Z,y:D$h,scaleX:D$H,scaleY:D$A}},D$T.fitDOMElementInArea=function(D$s,D$r,D$e,D$U,D$m,D$k){D$s._fitLayaAirInitialized||(D$s._fitLayaAirInitialized=!0,D$s.style.transformOrigin=D$s.style.webKittransformOrigin="left top",D$s.style.position="absolute");var D$j=D$T.getTransformRelativeToWindow(D$r,D$e,D$U);D$s.style.transform=D$s.style.webkitTransform="scale("+D$j.scaleX+","+D$j.scaleY+") rotate("+D$D.stage.canvasDegree+"deg)",D$s.style.width=D$m+"px",D$s.style.height=D$k+"px",D$s.style.left=D$j.x+"px",D$s.style.top=D$j.y+"px"},D$T.isOkTextureList=function(D$s){if(!D$s)return!1;var D$r,D$e=0,D$U=D$s.length;for(D$e=0;D$e<D$U;D$e++)if(!(D$r=D$s[D$e])||!D$r.source)return!1;return!0},D$T.isOKCmdList=function(D$s){if(!D$s)return!1;var D$r,D$e,D$U=0,D$m=D$s.length,D$k=D$c._context;for(D$U=0;D$U<D$m;D$U++)switch((D$r=D$s[D$U]).callee){case D$k._drawTexture:case D$k._fillTexture:case D$k._drawTextureWithTransform:if(!(D$e=D$r[0])||!D$e.source)return!1}return!0},D$T._gid=1,D$T._pi=180/Math.PI,D$T._pi2=Math.PI/180,D$T._extReg=/\.(\w+)\??/g,D$T.parseXMLFromString=function(D$s){var D$r;if(D$s=D$s.replace(/>\s+</g,"><"),-1<(D$r=(new DOMParser).parseFromString(D$s,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(D$r.firstChild.firstChild.textContent);return D$r},D$T}(),D$M=function(){function D$s(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],D$c.isWebGL&&D$R.regCacheByFunction(D$u.bind(this.startDispose,this),D$u.bind(this.getCacheList,this))}D$h(D$s,"laya.utils.VectorGraphManager");var D$r=D$s.prototype;return D$r.getId=function(){return this._id++},D$r.addShape=function(D$s,D$r){this.shapeDic[D$s]=D$r,this.useDic[D$s]||(this.useDic[D$s]=!0)},D$r.addLine=function(D$s,D$r){this.shapeLineDic[D$s]=D$r,this.shapeLineDic[D$s]||(this.shapeLineDic[D$s]=!0)},D$r.getShape=function(D$s){this._checkKey&&null!=this.useDic[D$s]&&(this.useDic[D$s]=!0)},D$r.deleteShape=function(D$s){this.shapeDic[D$s]&&(this.shapeDic[D$s]=null,delete this.shapeDic[D$s]),this.shapeLineDic[D$s]&&(this.shapeLineDic[D$s]=null,delete this.shapeLineDic[D$s]),null!=this.useDic[D$s]&&delete this.useDic[D$s]},D$r.getCacheList=function(){var D$s,D$r=[];for(D$s in this.shapeDic)D$r.push(this.shapeDic[D$s]);for(D$s in this.shapeLineDic)D$r.push(this.shapeLineDic[D$s]);return D$r},D$r.startDispose=function(D$s){var D$r;for(D$r in this.useDic)this.useDic[D$r]=!1;this._checkKey=!0},D$r.endDispose=function(){if(this._checkKey){var D$s;for(D$s in this.useDic)this.useDic[D$s]||this.deleteShape(D$s);this._checkKey=!1}},D$s.getInstance=function(){return D$s.instance=D$s.instance||new D$s},D$s.instance=null,D$s}(),D$_=function(){function D$U(){this._obj=null,this._obj=D$U.supportWeakMap?new D$Q.window.WeakMap:{},D$U.supportWeakMap||D$U._maps.push(this)}D$h(D$U,"laya.utils.WeakObject");var D$s=D$U.prototype;return D$s.set=function(D$s,D$r){if(null!=D$s)if(D$U.supportWeakMap){var D$e=D$s;"string"!=typeof D$s&&"number"!=typeof D$s||(D$e=D$U._keys[D$s])||(D$e=D$U._keys[D$s]={k:D$s}),this._obj.set(D$e,D$r)}else"string"==typeof D$s||"number"==typeof D$s?this._obj[D$s]=D$r:(D$s.$_GID||(D$s.$_GID=D$u.getGID()),this._obj[D$s.$_GID]=D$r)},D$s.get=function(D$s){if(null==D$s)return null;if(D$U.supportWeakMap){var D$r="string"==typeof D$s||"number"==typeof D$s?D$U._keys[D$s]:D$s;return D$r?this._obj.get(D$r):null}return"string"==typeof D$s||"number"==typeof D$s?this._obj[D$s]:this._obj[D$s.$_GID]},D$s.del=function(D$s){if(null!=D$s)if(D$U.supportWeakMap){var D$r="string"==typeof D$s||"number"==typeof D$s?D$U._keys[D$s]:D$s;if(!D$r)return;this._obj.delete(D$r)}else"string"==typeof D$s||"number"==typeof D$s?delete this._obj[D$s]:delete this._obj[this._obj.$_GID]},D$s.has=function(D$s){if(null==D$s)return!1;if(D$U.supportWeakMap){var D$r="string"==typeof D$s||"number"==typeof D$s?D$U._keys[D$s]:D$s;return this._obj.has(D$r)}return"string"==typeof D$s||"number"==typeof D$s?null!=this._obj[D$s]:null!=this._obj[this._obj.$_GID]},D$U.__init__=function(){(D$U.supportWeakMap=null!=D$Q.window.WeakMap)||D$D.timer.loop(D$U.delInterval,null,D$U.clearCache)},D$U.clearCache=function(){for(var D$s=0,D$r=D$U._maps.length;D$s<D$r;D$s++){D$U._maps[D$s]._obj={}}},D$U.supportWeakMap=!1,D$U.delInterval=3e5,D$U._keys={},D$U._maps=[],D$Y(D$U,["I",function(){return this.I=new D$U}]),D$U}(),D$F=function(){function D$s(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}D$h(D$s,"laya.utils.WordText");var D$r=D$s.prototype;return D$r.setText=function(D$s){this.changed=!0,this._text=D$s},D$r.toString=function(){return this._text},D$r.charCodeAt=function(D$s){return this._text?this._text.charCodeAt(D$s):NaN},D$r.charAt=function(D$s){return this._text?this._text.charAt(D$s):null},D$B(0,D$r,"length",function(){return this._text?this._text.length:0}),D$s}(),D$ss=function(D$s){function D$j(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,D$j.__super.call(this),this._childs=D$j.ARRAY_EMPTY,this._$P=D$j.PROP_EMPTY,this.timer=D$D.scaleTimer,this.conchModel=D$c.isConchNode?this.createConchModel():null}D$h(D$j,"laya.display.Node",D$Z);var D$r=D$j.prototype;return D$r._setBit=function(D$s,D$r){1==D$s&&(this._getBit(D$s)!=D$r&&this._updateDisplayedInstage());D$r?this._bits|=D$s:this._bits&=~D$s},D$r._getBit=function(D$s){return 0!=(this._bits&D$s)},D$r._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},D$r._setUpNoticeType=function(D$s){var D$r=this;for(D$r._setBit(D$s,!0),D$r=D$r.parent;D$r;){if(D$r._getBit(D$s))return;D$r._setBit(D$s,!0),D$r=D$r.parent}},D$r.on=function(D$s,D$r,D$e,D$U){return"display"!==D$s&&"undisplay"!==D$s||this._getBit(1)||this._setUpNoticeType(1),this._createListener(D$s,D$r,D$e,D$U,!1)},D$r.once=function(D$s,D$r,D$e,D$U){return"display"!==D$s&&"undisplay"!==D$s||this._getBit(1)||this._setUpNoticeType(1),this._createListener(D$s,D$r,D$e,D$U,!0)},D$r.createConchModel=function(){return null},D$r.destroy=function(D$s){void 0===D$s&&(D$s=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(D$s?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},D$r.destroyChildren=function(){if(this._childs)for(var D$s=this._childs.length-1;-1<D$s;D$s--)this._childs[D$s].destroy(!0)},D$r.addChild=function(D$s){if(!D$s||this.destroyed||D$s===this)return D$s;if(D$s.zOrder&&this._set$P("hasZorder",!0),D$s._parent===this){var D$r=this.getChildIndex(D$s);D$r!==this._childs.length-1&&(this._childs.splice(D$r,1),this._childs.push(D$s),this.conchModel&&(this.conchModel.removeChild(D$s.conchModel),this.conchModel.addChildAt(D$s.conchModel,this._childs.length-1)),this._childChanged())}else D$s.parent&&D$s.parent.removeChild(D$s),this._childs===D$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(D$s),this.conchModel&&this.conchModel.addChildAt(D$s.conchModel,this._childs.length-1),(D$s.parent=this)._childChanged();return D$s},D$r.addChildren=function(D$s){for(var D$r=arguments,D$e=0,D$U=D$r.length;D$e<D$U;)this.addChild(D$r[D$e++])},D$r.addChildAt=function(D$s,D$r){if(!D$s||this.destroyed||D$s===this)return D$s;if(D$s.zOrder&&this._set$P("hasZorder",!0),0<=D$r&&D$r<=this._childs.length){if(D$s._parent===this){var D$e=this.getChildIndex(D$s);this._childs.splice(D$e,1),this._childs.splice(D$r,0,D$s),this.conchModel&&(this.conchModel.removeChild(D$s.conchModel),this.conchModel.addChildAt(D$s.conchModel,D$r)),this._childChanged()}else D$s.parent&&D$s.parent.removeChild(D$s),this._childs===D$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(D$r,0,D$s),this.conchModel&&this.conchModel.addChildAt(D$s.conchModel,D$r),D$s.parent=this;return D$s}throw new Error("appendChildAt:The index is out of bounds")},D$r.getChildIndex=function(D$s){return this._childs.indexOf(D$s)},D$r.getChildByName=function(D$s){var D$r=this._childs;if(D$r)for(var D$e=0,D$U=D$r.length;D$e<D$U;D$e++){var D$m=D$r[D$e];if(D$m.name===D$s)return D$m}return null},D$r._get$P=function(D$s){return this._$P[D$s]},D$r._set$P=function(D$s,D$r){return this.destroyed||(this._$P===D$j.PROP_EMPTY&&(this._$P={}),this._$P[D$s]=D$r),D$r},D$r.getChildAt=function(D$s){return this._childs[D$s]},D$r.setChildIndex=function(D$s,D$r){var D$e=this._childs;if(D$r<0||D$r>=D$e.length)throw new Error("setChildIndex:The index is out of bounds.");var D$U=this.getChildIndex(D$s);if(D$U<0)throw new Error("setChildIndex:node is must child of this object.");return D$e.splice(D$U,1),D$e.splice(D$r,0,D$s),this.conchModel&&(this.conchModel.removeChild(D$s.conchModel),this.conchModel.addChildAt(D$s.conchModel,D$r)),this._childChanged(),D$s},D$r._childChanged=function(D$s){},D$r.removeChild=function(D$s){if(!this._childs)return D$s;var D$r=this._childs.indexOf(D$s);return this.removeChildAt(D$r)},D$r.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},D$r.removeChildByName=function(D$s){var D$r=this.getChildByName(D$s);return D$r&&this.removeChild(D$r),D$r},D$r.removeChildAt=function(D$s){var D$r=this.getChildAt(D$s);if(D$r){for(var D$e=this._childs.length-1,D$U=D$s;D$U<D$e;++D$U)this._childs[D$U]=this._childs[D$U+1];this._childs.length=D$e,this.conchModel&&this.conchModel.removeChild(D$r.conchModel),D$r.parent=null}return D$r},D$r.removeChildren=function(D$s,D$r){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=2147483647),this._childs&&0<this._childs.length){var D$e=this._childs;if(0===D$s&&D$k<=D$r){var D$U=D$e;this._childs=D$j.ARRAY_EMPTY}else D$U=D$e.splice(D$s,D$r-D$s);for(var D$m=0,D$k=D$U.length;D$m<D$k;D$m++)D$U[D$m].parent=null,this.conchModel&&this.conchModel.removeChild(D$U[D$m].conchModel)}return this},D$r.replaceChild=function(D$s,D$r){var D$e=this._childs.indexOf(D$r);return-1<D$e?(this._childs.splice(D$e,1,D$s),this.conchModel&&(this.conchModel.removeChild(D$r.conchModel),this.conchModel.addChildAt(D$s.conchModel,D$e)),D$r.parent=null,D$s.parent=this,D$s):null},D$r._updateDisplayedInstage=function(){var D$s;D$s=this;var D$r=D$D.stage;for(this._displayedInStage=!1;D$s;){if(D$s._getBit(1)){this._displayedInStage=D$s._displayedInStage;break}if(D$s==D$r||D$s._displayedInStage){this._displayedInStage=!0;break}D$s=D$s.parent}},D$r._setDisplay=function(D$s){this._displayedInStage!==D$s&&((this._displayedInStage=D$s)?this.event("display"):this.event("undisplay"))},D$r._displayChild=function(D$s,D$r){var D$e=D$s._childs;if(D$e)for(var D$U=0;D$U<D$e.length;D$U++){var D$m=D$e[D$U];D$m&&D$m._getBit(1)&&(0<D$m._childs.length?this._displayChild(D$m,D$r):D$m._setDisplay(D$r))}D$s._setDisplay(D$r)},D$r.contains=function(D$s){if(D$s===this)return!0;for(;D$s;){if(D$s.parent===this)return!0;D$s=D$s.parent}return!1},D$r.timerLoop=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$m&&(D$m=!0),void 0===D$k&&(D$k=!1),this.timer.loop(D$s,D$r,D$e,D$U,D$m,D$k)},D$r.timerOnce=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=!0),this.timer._create(!1,!1,D$s,D$r,D$e,D$U,D$m)},D$r.frameLoop=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=!0),this.timer._create(!0,!0,D$s,D$r,D$e,D$U,D$m)},D$r.frameOnce=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=!0),this.timer._create(!0,!1,D$s,D$r,D$e,D$U,D$m)},D$r.clearTimer=function(D$s,D$r){this.timer.clear(D$s,D$r)},D$B(0,D$r,"numChildren",function(){return this._childs.length}),D$B(0,D$r,"destroyed",function(){return this._destroyed}),D$B(0,D$r,"parent",function(){return this._parent},function(D$s){this._parent!==D$s&&(D$s?(this._parent=D$s,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),D$s.displayedInStage&&this._displayChild(this,!0)),D$s._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=D$s))}),D$B(0,D$r,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),D$j.ARRAY_EMPTY=[],D$j.PROP_EMPTY={},D$j.NOTICE_DISPLAY=1,D$j.MOUSEENABLE=2,D$j}(),D$rs=function(D$s){function D$A(D$s){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,D$A.__super.call(this),this._padding=D$A._PADDING,this._spacing=D$A._SPACING,this._aligns=D$A._ALIGNS,this._font=D$x.EMPTY,this._ower=D$s}D$h(D$A,"laya.display.css.CSSStyle",D$s);var D$r=D$A.prototype;return D$r.destroy=function(){this._ower=null,this._font=null,this._rect=null},D$r.inherit=function(D$s){this._font=D$s._font,this._spacing=D$s._spacing===D$A._SPACING?D$A._SPACING:D$s._spacing.slice(),this.lineHeight=D$s.lineHeight},D$r._widthAuto=function(){return 0!=(262144&this._type)},D$r.widthed=function(D$s){return 0!=(8&this._type)},D$r._calculation=function(D$s,D$r){if(D$r.indexOf("%")<0)return!1;var D$U=this._ower,D$m=D$U.parent,D$k=this._rect;function D$j(D$s,D$r,D$e){return D$s*D$e[0]+D$r*D$e[1]+D$e[2]}function D$e(D$s){var D$r=D$m.width,D$e=D$U.width;D$k.width&&(D$U.width=D$j(D$r,D$e,D$k.width)),D$k.height&&(D$U.height=D$j(D$r,D$e,D$k.height)),D$k.left&&(D$U.x=D$j(D$r,D$e,D$k.left)),D$k.top&&(D$U.y=D$j(D$r,D$e,D$k.top))}null===D$k&&(D$m._getCSSStyle()._type|=524288,D$m.on("resize",this,D$e),this._rect=D$k={input:{}});var D$T=D$r.split(" ");return D$T[0]=parseFloat(D$T[0])/100,1==D$T.length?D$T[1]=D$T[2]=0:(D$T[1]=parseFloat(D$T[1])/100,D$T[2]=parseFloat(D$T[2])),D$k[D$s]=D$T,D$k.input[D$s]=D$r,D$e(),!0},D$r.heighted=function(D$s){return 0!=(8192&this._type)},D$r.size=function(D$s,D$r){var D$e=this._ower,D$U=!1;-1!==D$s&&D$s!=this._ower.width&&(this._type|=8,this._ower.width=D$s,D$U=!0),-1!==D$r&&D$r!=this._ower.height&&(this._type|=8192,this._ower.height=D$r,D$U=!0),D$U&&(D$e._layoutLater(),524288&this._type&&D$e.event("resize",this))},D$r._getAlign=function(){return this._aligns[0]},D$r._getValign=function(){return this._aligns[1]},D$r._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},D$r._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new D$x(this._font))},D$r.render=function(D$s,D$r,D$e,D$U){var D$m=D$s.width,D$k=D$s.height;D$e-=D$s.pivotX,D$U-=D$s.pivotY,this._bgground&&null!=this._bgground.color&&D$r.ctx.fillRect(D$e,D$U,D$m,D$k,this._bgground.color),this._border&&this._border.color&&D$r.drawRect(D$e,D$U,D$m,D$k,this._border.color.strColor,this._border.size)},D$r.getCSSStyle=function(){return this},D$r.cssText=function(D$s){this.attrs(D$A.parseOneCSS(D$s,";"))},D$r.attrs=function(D$s){if(D$s)for(var D$r=0,D$e=D$s.length;D$r<D$e;D$r++){var D$U=D$s[D$r];this[D$U[0]]=D$U[1]}},D$r.setTransform=function(D$s){"none"===D$s?this._tf=D$T._TF_EMPTY:this.attrs(D$A.parseOneCSS(D$s,","))},D$r.translate=function(D$s,D$r){this._tf===D$T._TF_EMPTY&&(this._tf=new D$m),this._tf.translateX=D$s,this._tf.translateY=D$r},D$r.scale=function(D$s,D$r){this._tf===D$T._TF_EMPTY&&(this._tf=new D$m),this._tf.scaleX=D$s,this._tf.scaleY=D$r},D$r._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},D$B(0,D$r,"block",D$s.prototype._$get_block,function(D$s){D$s?this._type|=1:this._type&=-2}),D$B(0,D$r,"valign",function(){return D$A._valigndef[this._aligns[1]]},function(D$s){this._aligns===D$A._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=D$A._valigndef[D$s]}),D$B(0,D$r,"height",null,function(D$s){if(this._type|=8192,"string"==typeof D$s){if(this._calculation("height",D$s))return;D$s=parseInt(D$s)}this.size(-1,D$s)}),D$B(0,D$r,"width",null,function(D$s){if(this._type|=8,"string"==typeof D$s){var D$r=D$s.indexOf("auto");if(0<=D$r&&(this._type|=262144,D$s=D$s.substr(0,D$r)),this._calculation("width",D$s))return;D$s=parseInt(D$s)}this.size(D$s,-1)}),D$B(0,D$r,"fontWeight",function(){return this._font.weight},function(D$s){this._createFont().weight=D$s}),D$B(0,D$r,"left",null,function(D$s){var D$r=this._ower;if("string"==typeof D$s){if("center"===D$s?D$s="50% -50% 0":"right"===D$s&&(D$s="100% -100% 0"),this._calculation("left",D$s))return;D$s=parseInt(D$s)}D$r.x=D$s}),D$B(0,D$r,"_translate",null,function(D$s){this.translate(D$s[0],D$s[1])}),D$B(0,D$r,"absolute",function(){return 0!=(4&this._type)}),D$B(0,D$r,"top",null,function(D$s){var D$r=this._ower;if("string"==typeof D$s){if("middle"===D$s?D$s="50% -50% 0":"bottom"===D$s&&(D$s="100% -100% 0"),this._calculation("top",D$s))return;D$s=parseInt(D$s)}D$r.y=D$s}),D$B(0,D$r,"align",function(){return D$A._aligndef[this._aligns[0]]},function(D$s){this._aligns===D$A._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=D$A._aligndef[D$s]}),D$B(0,D$r,"bold",function(){return this._font.bold},function(D$s){this._createFont().bold=D$s}),D$B(0,D$r,"padding",function(){return this._padding},function(D$s){this._padding=D$s}),D$B(0,D$r,"leading",function(){return this._spacing[1]},function(D$s){"string"==typeof D$s&&(D$s=parseInt(D$s+"")),this._spacing===D$A._SPACING&&(this._spacing=[0,0]),this._spacing[1]=D$s}),D$B(0,D$r,"lineElement",function(){return 0!=(65536&this._type)},function(D$s){D$s?this._type|=65536:this._type&=-65537}),D$B(0,D$r,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(D$s){this.lineElement=!1,"right"===D$s?this._type|=32768:this._type&=-32769}),D$B(0,D$r,"textDecoration",function(){return this._font.decoration},function(D$s){this._createFont().decoration=D$s}),D$B(0,D$r,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(D$s){"nowrap"===D$s&&(this._type|=131072),"none"===D$s&&(this._type&=-131073)}),D$B(0,D$r,"background",null,function(D$s){D$s?(this._bgground||(this._bgground={}),this._bgground.color=D$s,this._ower.conchModel&&this._ower.conchModel.bgColor(D$s),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),D$B(0,D$r,"wordWrap",function(){return 0==(131072&this._type)},function(D$s){D$s?this._type&=-131073:this._type|=131072}),D$B(0,D$r,"color",function(){return this._font.color},function(D$s){this._createFont().color=D$s}),D$B(0,D$r,"password",function(){return this._font.password},function(D$s){this._createFont().password=D$s}),D$B(0,D$r,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(D$s){"none"===D$s?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=D$s),this._ower.conchModel&&this._ower.conchModel.bgColor(D$s),this._ower._renderType|=256}),D$B(0,D$r,"font",function(){return this._font.toString()},function(D$s){this._createFont().set(D$s)}),D$B(0,D$r,"weight",null,function(D$s){this._createFont().weight=D$s}),D$B(0,D$r,"letterSpacing",function(){return this._spacing[0]},function(D$s){"string"==typeof D$s&&(D$s=parseInt(D$s+"")),this._spacing===D$A._SPACING&&(this._spacing=[0,0]),this._spacing[0]=D$s}),D$B(0,D$r,"fontSize",function(){return this._font.size},function(D$s){this._createFont().size=D$s}),D$B(0,D$r,"italic",function(){return this._font.italic},function(D$s){this._createFont().italic=D$s}),D$B(0,D$r,"fontFamily",function(){return this._font.family},function(D$s){this._createFont().family=D$s}),D$B(0,D$r,"stroke",function(){return this._font.stroke[0]},function(D$s){this._createFont().stroke===D$x._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=D$s}),D$B(0,D$r,"strokeColor",function(){return this._font.stroke[1]},function(D$s){this._createFont().stroke===D$x._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=D$s}),D$B(0,D$r,"border",function(){return this._border?this._border.value:""},function(D$s){if("none"!=D$s){this._border||(this._border={});var D$r=(this._border.value=D$s).split(" ");if(this._border.color=D$p.create(D$r[D$r.length-1]),1==D$r.length)return this._border.size=1,void(this._border.type="solid");var D$e=0;0<D$r[0].indexOf("px")?(this._border.size=parseInt(D$r[0]),D$e++):this._border.size=1,this._border.type=D$r[D$e],this._ower._renderType|=256}else this._border=null}),D$B(0,D$r,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(D$s){D$s?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==D$s?null:D$p.create(D$s),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),D$B(0,D$r,"position",function(){return 4&this._type?"absolute":""},function(D$s){"absolute"==D$s?this._type|=4:this._type&=-5}),D$B(0,D$r,"display",null,function(D$s){switch(D$s){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),D$B(0,D$r,"paddingLeft",function(){return this.padding[3]}),D$B(0,D$r,"paddingTop",function(){return this.padding[0]}),D$B(0,D$r,"_scale",null,function(D$s){this._ower.scale(D$s[0],D$s[1])}),D$B(0,D$r,"_rotate",null,function(D$s){this._ower.rotation=D$s}),D$A.parseOneCSS=function(D$s,D$r){for(var D$e,D$U=[],D$m=D$s.split(D$r),D$k=0,D$j=D$m.length;D$k<D$j;D$k++){var D$T=D$m[D$k],D$Y=D$T.indexOf(":"),D$Z=D$T.substr(0,D$Y).replace(/^\s+|\s+$/g,"");if(0!=D$Z.length){var D$h=D$T.substr(D$Y+1).replace(/^\s+|\s+$/g,""),D$H=[D$Z,D$h];switch(D$Z){case"italic":case"bold":D$H[1]="true"==D$h;break;case"line-height":D$H[0]="lineHeight",D$H[1]=parseInt(D$h);break;case"font-size":D$H[0]="fontSize",D$H[1]=parseInt(D$h);break;case"padding":1<(D$e=D$h.split(" ")).length||(D$e[1]=D$e[2]=D$e[3]=D$e[0]),D$H[1]=[parseInt(D$e[0]),parseInt(D$e[1]),parseInt(D$e[2]),parseInt(D$e[3])];break;case"rotate":D$H[0]="_rotate",D$H[1]=parseFloat(D$h);break;case"scale":D$e=D$h.split(" "),D$H[0]="_scale",D$H[1]=[parseFloat(D$e[0]),parseFloat(D$e[1])];break;case"translate":D$e=D$h.split(" "),D$H[0]="_translate",D$H[1]=[parseInt(D$e[0]),parseInt(D$e[1])];break;default:(D$H[0]=D$A._CSSTOVALUE[D$Z])||(D$H[0]=D$Z)}D$U.push(D$H)}}return D$U},D$A.parseCSS=function(D$s,D$r){for(var D$e;null!=(D$e=D$A._parseCSSRegExp.exec(D$s));)D$A.styleSheets[D$e[1]]=D$A.parseOneCSS(D$e[2],";")},D$A.EMPTY=new D$A(null),D$A._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},D$A._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),D$A._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},D$A._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},D$A.styleSheets={},D$A.ALIGN_CENTER=1,D$A.ALIGN_RIGHT=2,D$A.VALIGN_MIDDLE=1,D$A.VALIGN_BOTTOM=2,D$A._CSS_BLOCK=1,D$A._DISPLAY_NONE=2,D$A._ABSOLUTE=4,D$A._WIDTH_SET=8,D$A._PADDING=[0,0,0,0],D$A._RECT=[-1,-1,-1,-1],D$A._SPACING=[0,0],D$A._ALIGNS=[0,0,0],D$A.ADDLAYOUTED=512,D$A._NEWFONT=4096,D$A._HEIGHT_SET=8192,D$A._BACKGROUND_SET=16384,D$A._FLOAT_RIGHT=32768,D$A._LINE_ELEMENT=65536,D$A._NOWARP=131072,D$A._WIDTHAUTO=262144,D$A._LISTERRESZIE=524288,D$A}(D$T),D$es=function(D$s){function D$j(){this.url=null,this.audio=null,this.loaded=!1,D$j.__super.call(this)}D$h(D$j,"laya.media.h5audio.AudioSound",D$Z);var D$r=D$j.prototype;return D$r.dispose=function(){var D$s=D$j._audioCache[this.url];D$s&&(D$s.src="",delete D$j._audioCache[this.url])},D$r.load=function(D$s){var D$r;if(D$s=D$K.formatURL(D$s),(this.url=D$s)==D$J._tMusic?(D$j._initMusicAudio(),(D$r=D$j._musicAudio).src!=D$s&&(D$j._audioCache[D$r.src]=null,D$r=null)):D$r=D$j._audioCache[D$s],D$r&&2<=D$r.readyState)this.event("complete");else{D$r||(D$r=D$s==D$J._tMusic?(D$j._initMusicAudio(),D$j._musicAudio):D$Q.createElement("audio"),(D$j._audioCache[D$s]=D$r).src=D$s),D$r.addEventListener("canplaythrough",D$U),D$r.addEventListener("error",D$m);var D$e=this;(this.audio=D$r).load?D$r.load():D$m()}function D$U(){D$k(),D$e.loaded=!0,D$e.event("complete")}function D$m(){D$r.load=null,D$k(),D$e.event("error")}function D$k(){D$r.removeEventListener("canplaythrough",D$U),D$r.removeEventListener("error",D$m)}},D$r.play=function(D$s,D$r,D$e){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),!this.url)return null;var D$U,D$m;if(!(D$U=this.url==D$J._tMusic?D$j._musicAudio:D$j._audioCache[this.url]))return null;D$m=D$d.getItem("audio:"+this.url),D$c.isConchApp?D$m||((D$m=D$Q.createElement("audio")).src=this.url):this.url==D$J._tMusic?(D$j._initMusicAudio(),(D$m=D$j._musicAudio).src=this.url):D$m=D$m||D$U.cloneNode(!0);var D$k=new D$As(D$m);return D$k.url=this.url,D$k.loops=D$r,D$k.startTime=D$s,D$k.startHandler=D$e,D$k.play(!1),D$J.addChannel(D$k),D$k},D$B(0,D$r,"duration",function(){var D$s;return(D$s=D$j._audioCache[this.url])?D$s.duration:0}),D$j._initMusicAudio=function(){D$j._musicAudio||(D$j._musicAudio||(D$j._musicAudio=D$Q.createElement("audio")),D$c.isConchApp||D$Q.document.addEventListener("mousedown",D$j._makeMusicOK))},D$j._makeMusicOK=function(){D$Q.document.removeEventListener("mousedown",D$j._makeMusicOK),D$j._musicAudio.src?D$j._musicAudio.play():(D$j._musicAudio.src="",D$j._musicAudio.load())},D$j._audioCache={},D$j._musicAudio=null,D$j}(),D$Us=function(D$s){function D$r(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,D$r.__super.call(this)}D$h(D$r,"laya.media.SoundChannel",D$Z);var D$e=D$r.prototype;return D$e.play=function(){},D$e.stop=function(){},D$e.pause=function(){},D$e.resume=function(){},D$e.__runComplete=function(D$s){D$s&&D$s.run()},D$B(0,D$e,"volume",function(){return 1},function(D$s){}),D$B(0,D$e,"position",function(){return 0}),D$B(0,D$e,"duration",function(){return 0}),D$r}(),D$ms=function(D$s){function D$r(){D$r.__super.call(this)}D$h(D$r,"laya.media.Sound",D$Z);var D$e=D$r.prototype;return D$e.load=function(D$s){},D$e.play=function(D$s,D$r,D$e){return void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),null},D$e.dispose=function(){},D$B(0,D$e,"duration",function(){return 0}),D$r}(),D$ks=function(D$s){function D$m(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,D$m.__super.call(this)}D$h(D$m,"laya.media.webaudio.WebAudioSound",D$Z);var D$r=D$m.prototype;return D$r.load=function(D$s){this.url=D$s,this.audioBuffer=D$m._dataCache[D$s],this.audioBuffer?this._loaded(this.audioBuffer):(D$m.e.on("loaded:"+D$s,this,this._loaded),D$m.e.on("err:"+D$s,this,this._err),D$m.__loadingSound[D$s]||(D$m.__loadingSound[D$s]=!0,D$D.loader.load(D$s,D$b.create(this,this.onloaded),null,D$Ts.BUFFER,4,!1,null,!0)))},D$r.onloaded=function(D$s){D$s||this._err(),this._disposed?this._removeLoadEvents():(this.data=D$s,D$m.buffs.push({buffer:this.data,url:this.url}),D$m.decode())},D$r._err=function(){if(this._removeLoadEvents(),D$m.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var D$s,D$r,D$e,D$U=0;for(D$s=(D$r=this.__toPlays).length,D$U=0;D$U<D$s;D$U++)(D$e=D$r[D$U])[3]&&!D$e[3].isStopped&&D$e[3].event("error");this.__toPlays.length=0}},D$r._loaded=function(D$s){this._removeLoadEvents(),this._disposed||(this.audioBuffer=D$s,this.loaded=!0,this.event("complete"))},D$r._removeLoadEvents=function(){D$m.e.off("loaded:"+this.url,this,this._loaded),D$m.e.off("err:"+this.url,this,this._err)},D$r.__playAfterLoaded=function(){if(this.__toPlays){var D$s,D$r,D$e,D$U=0;for(D$s=(D$r=this.__toPlays).length,D$U=0;D$U<D$s;D$U++)(D$e=D$r[D$U])[3]&&!D$e[3].isStopped&&this.play(D$e[0],D$e[1],D$e[2],D$e[3]);this.__toPlays.length=0}},D$r.play=function(D$s,D$r,D$e,D$U){return void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),D$U=D$U||new D$xs,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([D$s,D$r,D$e,D$U]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),D$U.url=this.url,D$U.loops=D$r,D$U.audioBuffer=this.audioBuffer,D$U.startTime=D$s,D$U.startHandler=D$e,D$U.play(!1),D$J.addChannel(D$U),D$U},D$r.dispose=function(){this._disposed=!0,delete D$m._dataCache[this.url],delete D$m.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},D$B(0,D$r,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),D$m.decode=function(){if(!(D$m.buffs.length<=0||D$m.isDecoding))if(D$m.isDecoding=!0,(D$m.tInfo=D$m.buffs.shift())&&D$m.tInfo.buffer&&D$m.tInfo.buffer.byteLength)try{D$m.ctx.decodeAudioData(D$m.tInfo.buffer,D$m._done,D$m._fail)}catch(D$s){console.error("decodeAudioData error  byteLength:"+D$m.tInfo.buffer.byteLength+"  url:"+D$m.tInfo.url)}else D$m._fail()},D$m._done=function(D$s){D$m.e.event("loaded:"+D$m.tInfo.url,D$s),D$m._dataCache[D$m.tInfo.url]=D$s,D$m.isDecoding=!1,D$m.decode()},D$m._fail=function(){D$m.e.event("err:"+D$m.tInfo.url,null),D$m.isDecoding=!1,D$m.decode()},D$m._playEmptySound=function(){if(null!=D$m.ctx){if(D$m._emptySource&&(D$m._emptySource.stop(),D$m._emptySource.disconnect(0),!D$xs._tryCleanFailed))try{D$m._emptySource.buffer=null}catch(D$s){D$xs._tryCleanFailed=!0}var D$s=D$m.ctx.createBufferSource();D$s.buffer=D$m._miniBuffer,D$s.connect(D$m.ctx.destination),D$s.start(0,0,0),D$m._emptySource=D$s}},D$m._unlock=function(){D$m._unlocked||(D$m._playEmptySound(),"running"==D$m.ctx.state?(D$Q.document.removeEventListener("mousedown",D$m._unlock,!0),D$Q.document.removeEventListener("touchend",D$m._unlock,!0),D$Q.document.removeEventListener("touchstart",D$m._unlock,!0),D$m._unlocked=!0):"suspended"==D$m.ctx.state&&D$J._recoverWebAudio())},D$m.initWebAudio=function(){"running"!=D$m.ctx.state&&(D$m._unlock(),D$Q.document.addEventListener("mousedown",D$m._unlock,!0),D$Q.document.addEventListener("touchend",D$m._unlock,!0),D$Q.document.addEventListener("touchstart",D$m._unlock,!0))},D$m._emptySource=null,D$m._dataCache={},D$m.buffs=[],D$m.isDecoding=!1,D$m._unlocked=!1,D$m.tInfo=null,D$m.__loadingSound={},D$Y(D$m,["window",function(){return this.window=D$Q.window},"webAudioEnabled",function(){return this.webAudioEnabled=D$m.window.AudioContext||D$m.window.webkitAudioContext||D$m.window.mozAudioContext},"ctx",function(){return this.ctx=D$m.webAudioEnabled?new(D$m.window.AudioContext||D$m.window.webkitAudioContext||D$m.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=D$m.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new D$Z}]),D$m}(),D$js=function(D$s){function D$r(){this._responseType=null,this._data=null,D$r.__super.call(this),this._http=new D$Q.window.XMLHttpRequest}D$h(D$r,"laya.net.HttpRequest",D$Z);var D$e=D$r.prototype;return D$e.send=function(D$s,D$r,D$e,D$U,D$m){void 0===D$e&&(D$e="get"),void 0===D$U&&(D$U="text"),this._responseType=D$U,this._data=null;var D$k=this,D$j=this._http;if(D$j.open(D$e,D$s,!0),D$m)for(var D$T=0;D$T<D$m.length;D$T++)D$j.setRequestHeader(D$m[D$T++],D$m[D$T]);else D$c.isConchApp||(D$r&&"string"!=typeof D$r?D$j.setRequestHeader("Content-Type","application/json"):D$j.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));D$j.responseType="arraybuffer"!==D$U?"text":"arraybuffer",D$j.onerror=function(D$s){D$k._onError(D$s)},D$j.onabort=function(D$s){D$k._onAbort(D$s)},D$j.onprogress=function(D$s){D$k._onProgress(D$s)},D$j.onload=function(D$s){D$k._onLoad(D$s)},D$j.send(D$r)},D$e._onProgress=function(D$s){D$s&&D$s.lengthComputable&&this.event("progress",D$s.loaded/D$s.total)},D$e._onAbort=function(D$s){this.error("Request was aborted by user")},D$e._onError=function(D$s){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},D$e._onLoad=function(D$s){var D$r=this._http,D$e=void 0!==D$r.status?D$r.status:200;200===D$e||204===D$e||0===D$e?this.complete():this.error("["+D$r.status+"]"+D$r.statusText+":"+D$r.responseURL)},D$e.error=function(D$s){this.clear(),this.event("error",D$s)},D$e.complete=function(){this.clear();var D$r=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=D$u.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(D$s){D$r=!1,this.error(D$s.message)}D$r&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},D$e.clear=function(){var D$s=this._http;D$s.onerror=D$s.onabort=D$s.onprogress=D$s.onload=null},D$B(0,D$e,"url",function(){return this._http.responseURL}),D$B(0,D$e,"http",function(){return this._http}),D$B(0,D$e,"data",function(){return this._data}),D$r}(),D$Ts=function(D$s){function D$g(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,D$g.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1,this._base64=!1}D$h(D$g,"laya.net.Loader",D$Z);var D$r=D$g.prototype;return D$r.load=function(D$s,D$r,D$e,D$U,D$m){if(D$s&&""!=D$s||console.error("Loader 加载的url不合法 "+D$s),void 0===D$e&&(D$e=!0),void 0===D$m&&(D$m=!1),this._url=D$s,this._base64=!1,0===D$s.indexOf("data:image")?(this._base64=!0,this._type=D$r="image"):this._type=D$r||(D$r=this.getTypeFromUrl(D$s)),this._cache=D$e,this._data=null,!D$m&&D$g.loadedMap[D$s])return this._data=D$g.loadedMap[D$s],this.event("progress",1),void this.event("complete",this._data);if(D$U&&D$g.setGroup(D$s,D$U),null!=D$g.parserMap[D$r])return this._customParse=!0,void(D$g.parserMap[D$r]instanceof laya.utils.Handler?D$g.parserMap[D$r].runWith(this):D$g.parserMap[D$r].call(null,this));if("image"===D$r||"htmlimage"===D$r||"nativeimage"===D$r)return this._loadImage(D$s);if("ttf"===D$r)return this._loadTTF(D$s);switch(D$r){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:D$r}D$g.preLoadedMap[D$s]?this.onLoaded(D$g.preLoadedMap[D$s]):D$j.resMgrLoad(D$s,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},D$r.getTypeFromUrl=function(D$s){var D$r=D$u.getFileExtension(D$s);return D$r?D$g.typeMap[D$r]:(console.warn("Not recognize the resources suffix",D$s),"text")},D$r._loadTTF=function(D$s){D$s=D$K.formatURL(D$s);var D$r=new D$i;D$r.complete=D$b.create(this,this.onLoaded),D$r.load(D$s)},D$r._loadBase64Image=function(D$r){D$r=D$K.formatURL(D$r);var D$e,D$s=this;function D$U(){D$e.onload=null,D$e.onerror=null,delete D$g.imgCache[D$r]}function D$m(){D$U(),D$s.onLoaded(D$e)}function D$k(){D$U(),D$s.event("error","Load image failed")}"nativeimage"===this._type?((D$e=new D$Q.window.Image).crossOrigin="",D$e.onload=D$m,D$e.onerror=D$k,D$e.src=D$r,D$g.imgCache[D$r]=D$e):new D$Xs.create(D$r,{onload:D$m,onerror:D$k,onCreate:function(D$s){D$e=D$s,D$g.imgCache[D$r]=D$s}})},D$r._loadImage=function(D$s){this._base64?this._loadBase64Image(D$s):D$j.imgMgrLoad(D$s,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},D$r._loadImageComplete=function(D$s,D$r,D$e){if(null!=D$e)if(D$e instanceof ArrayBuffer){var D$U=new DataView(D$e),D$m=new laya.webgl.resource.WebGLImage(new Uint8Array(D$e,8),D$s,0,!1,D$U.getUint32(0),D$U.getUint32(4));this.onLoaded(D$m)}else if(D$e instanceof D$hs)D$g.imgMgrSet[D$s]=D$r,D$j.imgMgrLock(D$s,D$g.imgMgrSet[D$s]),this._url=D$s,this.complete(D$e);else{var D$k=-1!=D$s.indexOf(".png",D$s.length-4)?6408:6407;D$m=new laya.webgl.resource.WebGLImage(D$e,D$s,D$k,!1,D$e.width,D$e.height);this.onLoaded(D$m)}else this.event("error","Load image failed")},D$r.imageCancel=function(D$s,D$r,D$e){D$j.imgMgrCancel&&D$j.imgMgrCancel(D$s,this._onImageCallback)},D$r._loadSound=function(D$s){var D$r=new D$J._soundClass,D$e=this;function D$U(){D$r.offAll()}D$r.on("complete",this,function(){D$U(),D$e.onLoaded(D$r)}),D$r.on("error",this,function(){D$U(),D$r.dispose(),D$e.event("error","Load sound failed")}),D$r.load(D$s)},D$r.onProgress=function(D$s){"atlas"===this._type?this.event("progress",.3*D$s):this.event("progress",D$s)},D$r.onError=function(D$s){this.event("error",D$s)},D$r._loadedComplete=function(D$s,D$r,D$e){if(null!=D$e)switch(this._type){case"atlas":case"plf":case"json":var D$U=new D$C(D$e);this.onLoaded(JSON.parse(D$U.readUTFBytes()));break;case"font":D$U=new D$C(D$e);this.onLoaded(D$u.parseXMLFromString(D$U.readUTFBytes()));break;default:this.onLoaded(D$e)}else this.event("error",D$s)},D$r.onLoaded=function(D$s){var D$r=this._type;if("plf"==D$r)this.parsePLFData(D$s),this.complete(D$s);else if("image"===D$r){var D$e=new D$hs(D$s);D$e.url=this._url,this.complete(D$e)}else if("sound"===D$r||"htmlimage"===D$r||"nativeimage"===D$r)this.complete(D$s);else if("atlas"===D$r){if(!D$s.src&&!D$s._setContext){if(!this._data){if((this._data=D$s).meta&&D$s.meta.image)for(var D$U=D$s.meta.image.split(","),D$m=0<=this._url.indexOf("/")?"/":"\\",D$k=this._url.lastIndexOf(D$m),D$j=0<=D$k?this._url.substr(0,D$k+1):"",D$T=0,D$Y=D$U.length;D$T<D$Y;D$T++)D$U[D$T]=D$j+D$U[D$T];else D$U=[this._url.replace(".json",".png")];D$U.reverse(),D$s.toLoads=D$U,D$s.pics=[]}return this.event("progress",.3+1/D$U.length*.6),this._loadImage(D$U.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(D$s),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var D$Z=this._data.frames,D$h=this._url.split("?")[0],D$H=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:D$h.substring(0,D$h.lastIndexOf("."))+"/",D$A=this._data.pics,D$x=D$K.formatURL(this._url),D$B=D$g.atlasMap[D$x]||(D$g.atlasMap[D$x]=[]);D$B.dir=D$H;var D$$=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var D$l in D$$=parseFloat(this._data.meta.scale),D$Z){var D$V,D$b=D$Z[D$l],D$o=D$A[D$b.frame.idx?D$b.frame.idx:0],D$I=D$K.formatURL(D$H+D$l);D$o.scaleRate=D$$,D$V=D$hs.create(D$o,D$b.frame.x,D$b.frame.y,D$b.frame.w,D$b.frame.h,D$b.spriteSourceSize.x,D$b.spriteSourceSize.y,D$b.sourceSize.w,D$b.sourceSize.h),D$g.cacheRes(D$I,D$V),D$g.keepCache(this._url,D$H+D$l),D$V.url=D$I,D$B.push(D$I)}else for(D$l in D$Z)D$o=D$A[(D$b=D$Z[D$l]).frame.idx?D$b.frame.idx:0],D$I=D$K.formatURL(D$H+D$l),D$g.cacheRes(D$I,D$hs.create(D$o,D$b.frame.x,D$b.frame.y,D$b.frame.w,D$b.frame.h,D$b.spriteSourceSize.x,D$b.spriteSourceSize.y,D$b.sourceSize.w,D$b.sourceSize.h)),D$g.loadedMap[D$I].url=D$I,D$g.keepCache(this._url,D$H+D$l),D$B.push(D$I);delete this._data.pics,this.complete(this._data)}else if("font"==D$r){if(!D$s.src)return this._data=D$s,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var D$w=new D$f;D$w.parseFont(this._data,D$s);var D$X=this._url.split(".fnt")[0].split("/"),D$D=D$X[D$X.length-1];D$ls.registerBitmapFont(D$D,D$w),this._data=D$w,this.complete(this._data)}else if("pkm"==D$r){var D$n=D$Xs.create(D$s,this._url),D$y=new D$hs(D$n);D$y.url=this._url,this.complete(D$y)}else this.complete(D$s)},D$r.parsePLFData=function(D$s){var D$r,D$e,D$U;for(D$r in D$s)switch(D$U=D$s[D$r],D$r){case"json":case"text":for(D$e in D$U)D$g.preLoadedMap[D$K.formatURL(D$e)]=D$U[D$e];break;default:for(D$e in D$U)D$g.preLoadedMap[D$K.formatURL(D$e)]=D$U[D$e]}},D$r.complete=function(D$s){this._data=D$s,this._customParse?this.event("loaded",D$s instanceof Array?[D$s]:D$s):(D$g._loaders.push(this),D$g._isWorking||D$g.checkNext())},D$r.endLoad=function(D$s){D$s&&(this._data=D$s),this._cache&&D$g.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},D$B(0,D$r,"url",function(){return this._url}),D$B(0,D$r,"data",function(){return this._data}),D$B(0,D$r,"cache",function(){return this._cache}),D$B(0,D$r,"type",function(){return this._type}),D$g.checkNext=function(){D$g._isWorking=!0;for(var D$s=D$Q.now();D$g._startIndex<D$g._loaders.length;)if(D$Q.now(),D$g._loaders[D$g._startIndex].endLoad(),D$g._startIndex++,D$Q.now()-D$s>D$g.maxTimeOut)return console.warn("loader callback cost a long time:"+(D$Q.now()-D$s)+" url="+D$g._loaders[D$g._startIndex-1].url),void D$D.timer.frameOnce(1,null,D$g.checkNext);D$g._loaders.length=0,D$g._startIndex=0,D$g._isWorking=!1},D$g.clearRes=function(D$s,D$r){if(null!=D$s){void 0===D$r&&(D$r=!1),D$s=D$K.formatURL(D$s);var D$e=D$g.getAtlas(D$s);if(D$e){for(var D$U=0,D$m=D$e.length;D$U<D$m;D$U++){var D$k=D$e[D$U],D$j=D$g.getRes(D$k);delete D$g.loadedMap[D$k],D$g.clearCache(D$s.substring(D$K.basePath.length),D$k.substring(D$K.basePath.length)),D$j&&D$j.destroy(D$r)}D$e.length=0,delete D$g.atlasMap[D$s],delete D$g.loadedMap[D$s]}else{var D$T=D$g.loadedMap[D$s];D$T&&(delete D$g.loadedMap[D$s],D$T instanceof laya.resource.Texture&&D$T.bitmap&&D$T.destroy(D$r))}}},D$g.clearTextureRes=function(D$s){D$s=D$K.formatURL(D$s);var D$r=laya.net.Loader.getAtlas(D$s),D$e=D$r&&0<D$r.length?laya.net.Loader.getRes(D$r[0]):laya.net.Loader.getRes(D$s);D$e&&D$e.bitmap&&(D$c.isConchApp&&!D$c.isConchWebGL?D$e.bitmap.source.releaseTexture&&D$e.bitmap.source.releaseTexture():null==D$e.bitmap._atlaser&&D$e.bitmap.releaseResource(!0))},D$g.getRes=function(D$s){return D$g.loadedMap[D$K.formatURL(D$s)]},D$g.getAtlas=function(D$s){return D$g.atlasMap[D$K.formatURL(D$s)]},D$g.cacheRes=function(D$s,D$r){D$s=D$K.formatURL(D$s),null!=D$g.loadedMap[D$s]?console.warn("Resources already exist,is repeated loading:",D$s):D$g.loadedMap[D$s]=D$r},D$g.setGroup=function(D$s,D$r){D$g.groupMap[D$r]||(D$g.groupMap[D$r]=[]),D$g.groupMap[D$r].push(D$s)},D$g.clearResByGroup=function(D$s){if(D$g.groupMap[D$s]){var D$r=D$g.groupMap[D$s],D$e=0,D$U=D$r.length;for(D$e=0;D$e<D$U;D$e++)D$g.clearRes(D$r[D$e]);D$r.length=0}},D$g.keepCache=function(D$s,D$r){if(D$s&&D$r){var D$e=D$g.cacheSet[D$r];D$e?-1==D$e.indexOf(D$s)&&D$e.push(D$s):D$g.cacheSet[D$r]=[D$s]}},D$g.clearCache=function(D$s,D$r){if(D$s&&D$r){var D$e=D$g.cacheSet[D$r];if(D$e){var D$U=D$e.indexOf(D$s);if(-1!==D$U){var D$m=D$e.length-1;0==D$m?(delete D$g.cacheSet[D$r],0<D$g.imgMgrSet[D$r]?D$j.imgMgrFree(D$r,D$g.imgMgrSet[D$r]):D$g.clearRes(D$r,!0)):(D$e[D$U]=D$e[D$m],D$e.length=D$m)}}}},D$g.saveObject=function(D$s,D$r,D$e){if(D$r&&D$s){var D$U=D$g.objectSet[D$s];D$U?(console.warn("Loader.saveObject: "+D$s),D$U[0]=D$r,D$U[1]=D$e):D$g.objectSet[D$s]=[D$r,D$e,[]]}},D$g.findObject=function(D$s){if(D$s){var D$r=D$g.objectSet[D$s];if(D$r)return D$r[0]}return null},D$g.keepObject=function(D$s,D$r){if(D$s&&D$r){var D$e=D$g.objectSet[D$r];D$e&&-1===D$e[2].indexOf(D$s)&&D$e[2].push(D$s)}},D$g.clearObject=function(D$s,D$r){if(D$s&&D$r){var D$e=D$g.objectSet[D$r];if(D$e){var D$U=D$e[2],D$m=D$U.indexOf(D$s);if(-1!==D$m){var D$k=D$U.length-1;0==D$k?(delete D$g.objectSet[D$r],D$e[1]&&D$e[1].call(null,D$e[0])):(D$U[D$m]=D$U[D$k],D$U.length=D$k)}}}},D$g.TEXT="text",D$g.JSON="json",D$g.XML="xml",D$g.BUFFER="arraybuffer",D$g.IMAGE="image",D$g.SOUND="sound",D$g.ATLAS="atlas",D$g.FONT="font",D$g.TTF="ttf",D$g.PLF="plf",D$g.PKM="pkm",D$g.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},D$g.parserMap={},D$g.groupMap={},D$g.maxTimeOut=100,D$g.loadedMap={},D$g.preLoadedMap={},D$g.atlasMap={},D$g._loaders=[],D$g._isWorking=!1,D$g._startIndex=0,D$g.imgCache={},D$g.cacheSet={},D$g.objectSet={},D$g.imgMgrSet={},D$g}(),D$Ys=function(D$s){var D$A;function D$x(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},D$x.__super.call(this);for(var D$s=0;D$s<this._maxPriority;D$s++)this._resInfos[D$s]=[]}D$h(D$x,"laya.net.LoaderManager",D$Z);var D$r=D$x.prototype;return D$r.create=function(D$s,D$e,D$r,D$U,D$m,D$k,D$j,D$T){if(null==D$k&&(D$k=2),null==D$j&&(D$j=!0),D$s instanceof Array){var D$Y=D$s,D$Z=D$Y.length,D$h=0;if(D$r)var D$H=D$b.create(D$r.caller,D$r.method,D$r.args,!1);for(var D$A=0;D$A<D$Z;D$A++){var D$x=D$Y[D$A];"string"==typeof D$x&&(D$x=D$Y[D$A]={url:D$x}),D$x.progress=0}for(D$A=0;D$A<D$Z;D$A++){D$x=D$Y[D$A];var D$B=D$r?D$b.create(null,D$V,[D$x],!1):null,D$$=D$r||D$e?D$b.create(null,D$l,[D$x]):null;this._create(D$x.url,D$$,D$B,D$x.clas||D$U,D$x.params||D$m,null!=D$x.priority&&0<=D$x.priority?D$x.priority:D$k,D$j,D$x.group||D$T)}function D$l(D$s,D$r){D$h++,D$s.progress=1,D$h===D$Z&&D$e&&D$e.run()}function D$V(D$s,D$r){D$s.progress=D$r;for(var D$e=0,D$U=0;D$U<D$Z;D$U++){D$e+=D$Y[D$U].progress}var D$m=D$e/D$Z;D$H.runWith(D$m)}return!0}return this._create(D$s,D$e,D$r,D$U,D$m,D$k,D$j,D$T)},D$r._create=function(D$r,D$e,D$s,D$U,D$m,D$k,D$j,D$T){D$r&&""!=D$r||console.error("加载的url不合法 "+D$r),null==D$k&&(D$k=2),null==D$j&&(D$j=!0);var D$Y=D$K.formatURL(D$r),D$Z=this.getRes(D$Y);if(D$Z)!D$Z.hasOwnProperty("loaded")||D$Z.loaded?(D$s&&D$s.runWith(1),D$e&&D$e.run()):D$e&&D$D.loader._createListener(D$r,D$e.caller,D$e.method,D$e.args,!0,!1);else{var D$h=D$u.getFileExtension(D$r),D$H=D$x.createMap[D$h];if(!D$H)throw new Error("LoaderManager:unknown file("+D$r+") extension with: "+D$h+".");D$U||(D$U=D$H[0]);var D$A=D$H[1];if("atlas"==D$h)this.load(D$r,D$e,D$s,D$A,D$k,D$j);else{D$U===D$hs&&(D$A="htmlimage"),(D$Z=D$U?new D$U:null).hasOwnProperty("_loaded")&&(D$Z._loaded=!1),D$Z._setUrl(D$r),D$T&&D$Z._setGroup(D$T),this._createLoad(D$Z,D$r,D$b.create(null,function(D$s){D$Z&&!D$Z.destroyed&&D$s&&D$Z.onAsynLoaded.call(D$Z,D$r,D$s,D$m),D$e&&D$e.run();D$D.loader.event(D$r)}),D$s,D$A,D$k,!1,D$T,!0),D$j&&this.cacheRes(D$Y,D$Z)}}return D$Z},D$r.load=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){D$s&&""!=D$s||console.error("加载的url不合法 "+D$s);var D$Y=this;if(null==D$m&&(D$m=2),null==D$k&&(D$k=!0),void 0===D$T&&(D$T=!1),D$s instanceof Array)return this._loadAssets(D$s,D$r,D$e,D$U,D$m,D$k,D$j);var D$Z=D$Ts.getRes(D$s);if(null!=D$Z)D$D.timer.frameOnce(1,null,function(){D$e&&D$e.runWith(1),D$r&&D$r.runWith(D$Z),D$Y._loaderCount||D$Y.event("complete")});else{var D$h=D$x._resMap[D$s];D$h?(D$r&&D$h._createListener("complete",D$r.caller,D$r.method,D$r.args,!1,!1),D$e&&D$h._createListener("progress",D$e.caller,D$e.method,D$e.args,!1,!1)):((D$h=this._infoPool.length?this._infoPool.pop():new D$A).url=D$s,D$h.clas=null,D$h.type=D$U,D$h.cache=D$k,D$h.group=D$j,D$h.ignoreCache=D$T,D$h.priority=D$m,D$r&&D$h.on("complete",D$r.caller,D$r.method,D$r.args),D$e&&D$h.on("progress",D$e.caller,D$e.method,D$e.args),D$x._resMap[D$s]=D$h,D$m=D$m<this._maxPriority?0<=D$m?D$m:0:this._maxPriority-1,this._resInfos[D$m].push(D$h),this._next())}return this},D$r.cancel=function(D$s,D$r,D$e){if(D$Z=D$x._resMap[D$s]){D$r&&D$Z.off("complete",D$r.caller,D$r.method,!1),D$e&&D$Z.off("progress",D$e.caller,D$e.method,!1);var D$U=D$Z.getListener("complete"),D$m=D$Z.getListener("progress");if(!(D$U&&D$U.head||D$m&&D$m.head)){if(D$Z.loader){var D$k=D$Z.loader;D$k.imageCancel(D$s),D$k.offAll(),D$k._data=null,D$k._customParse=!1,D$k._url=null,D$k._class=null,D$k._type=null,this._loaders.push(D$k),this._loaderCount--,delete this._loaderMap[D$Z.url]}for(var D$j=0;D$j<this._maxPriority;D$j++)for(var D$T=this._resInfos[D$j],D$Y=D$T.length-1;-1<D$Y;D$Y--){var D$Z;(D$Z=D$T[D$Y])&&D$Z.url===D$s&&(D$T[D$Y]=null,D$Z.destroy(),D$Z.offAll(),this._infoPool.push(D$Z))}delete D$x._resMap[D$s],this._next()}}},D$r._createLoad=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){var D$Z=this;if(null==D$k&&(D$k=2),null==D$j&&(D$j=!0),void 0===D$Y&&(D$Y=!1),D$r instanceof Array)return this._loadAssets(D$r,D$e,D$U,D$m,D$k,D$j,D$T);var D$h=D$Ts.getRes(D$r);if(null!=D$h)D$D.timer.frameOnce(1,null,function(){D$U&&D$U.runWith(1),D$e&&D$e.runWith(D$h),D$Z._loaderCount||D$Z.event("complete")});else{var D$H=D$x._resMap[D$r];D$H?(D$e&&D$H._createListener("complete",D$e.caller,D$e.method,D$e.args,!1,!1),D$U&&D$H._createListener("progress",D$U.caller,D$U.method,D$U.args,!1,!1)):((D$H=this._infoPool.length?this._infoPool.pop():new D$A).url=D$r,D$H.clas=D$s,D$H.type=D$m,D$H.cache=D$j,D$H.group=D$T,D$H.ignoreCache=D$Y,D$H.priority=D$k,D$e&&D$H.on("complete",D$e.caller,D$e.method,D$e.args),D$U&&D$H.on("progress",D$U.caller,D$U.method,D$U.args),D$x._resMap[D$r]=D$H,D$k=D$k<this._maxPriority?0<=D$k?D$k:0:this._maxPriority-1,this._resInfos[D$k].push(D$H),this._next())}return this},D$r._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var D$s=0;D$s<this._maxPriority;D$s++)for(var D$r=this._resInfos[D$s];0<D$r.length;){var D$e=D$r.shift();if(D$e)return this._doLoad(D$e)}this._loaderCount||this.event("complete")}},D$r._doLoad=function(D$r){var D$e=this._loaders.length?this._loaders.pop():new D$Ts;this._loaderCount++,(this._loaderMap[D$r.url]=D$e).on("complete",null,D$m),D$e.on("progress",null,function(D$s){D$r.event("progress",D$s)}),D$e.on("error",null,function(D$s){D$m(null)}),D$r.loader=D$e;var D$U=this;function D$m(D$s){D$e.offAll(),D$e._data=null,D$e._customParse=!1,D$e._url=null,D$e._class=null,D$e._type=null,D$U._loaders.push(D$e),D$U._loaderCount--,delete D$U._loaderMap[D$r.url],D$U._endLoad(D$r,D$s instanceof Array?[D$s]:D$s),D$U._next()}D$e._class=D$r.clas,1<=D$r.priority?(D$e.priority=D$r.priority,D$e.realTime=!1):(D$e.priority=0,D$e.realTime=!0),D$e.load(D$r.url,D$r.type,D$r.cache,D$r.group,D$r.ignoreCache)},D$r._endLoad=function(D$s,D$r){var D$e=D$s.url;if(null==D$r){var D$U=this._failRes[D$e]||0;if(D$U<this.retryNum)return console.warn("[warn]Retry to load:",D$e),this._failRes[D$e]=D$U+1,void D$D.timer.once(this.retryDelay,this,this._addReTry,[D$s],!1);console.warn("[error]Failed to load:",D$e),this.event("error",D$e)}this._failRes[D$e]&&(this._failRes[D$e]=0),delete D$x._resMap[D$e],D$s.event("complete",D$r),D$s.destroy(),D$s.offAll(),this._infoPool.push(D$s)},D$r._addReTry=function(D$s){this._resInfos[this._maxPriority-1].push(D$s),this._next()},D$r.clearRes=function(D$s,D$r){void 0===D$r&&(D$r=!1),D$Ts.clearRes(D$s,D$r)},D$r.getRes=function(D$s){return D$Ts.getRes(D$s)},D$r.cacheRes=function(D$s,D$r){D$Ts.cacheRes(D$s,D$r)},D$r.clearTextureRes=function(D$s){D$Ts.clearTextureRes(D$s)},D$r.setGroup=function(D$s,D$r){D$Ts.setGroup(D$s,D$r)},D$r.clearResByGroup=function(D$s){D$Ts.clearResByGroup(D$s)},D$r.clearUnLoaded=function(){for(var D$s=0;D$s<this._maxPriority;D$s++){for(var D$r=this._resInfos[D$s],D$e=D$r.length-1;-1<D$e;D$e--){var D$U=D$r[D$e];D$U&&(D$U.destroy(),D$U.offAll(),this._infoPool.push(D$U))}D$r.length=0}this._loaderCount=0,D$x._resMap={}},D$r.cancelLoadByUrls=function(D$s){if(D$s)for(var D$r=0,D$e=D$s.length;D$r<D$e;D$r++)this.cancelLoadByUrl(D$s[D$r])},D$r.cancelLoadByUrl=function(D$s){for(var D$r=0;D$r<this._maxPriority;D$r++)for(var D$e=this._resInfos[D$r],D$U=D$e.length-1;-1<D$U;D$U--){var D$m=D$e[D$U];D$m&&D$m.url===D$s&&(D$e[D$U]=null,D$m.destroy(),D$m.offAll(),this._infoPool.push(D$m))}D$x._resMap[D$s]&&delete D$x._resMap[D$s]},D$r._loadAssets=function(D$s,D$e,D$j,D$r,D$U,D$m,D$k){null==D$U&&(D$U=2),null==D$m&&(D$m=!0);for(var D$T=D$s.length,D$Y=0,D$Z=0,D$h=[],D$H=!0,D$A=0;D$A<D$T;D$A++){var D$x=D$s[D$A];if(!D$x)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+D$s);"string"==typeof D$x&&(D$x={url:D$x,type:D$r,size:1,priority:D$U}),D$x.size||(D$x.size=1),D$x.progress=0,D$Z+=D$x.size,D$h.push(D$x);var D$B=D$j?D$b.create(null,D$V,[D$x],!1):null,D$$=D$e||D$j?D$b.create(null,D$l,[D$x]):null;this.load(D$x.url,D$$,D$B,D$x.type,null!=D$x.priority&&0<=D$x.priority?D$x.priority:2,D$m,D$x.group||D$k)}function D$l(D$s,D$r){D$Y++,D$s.progress=1,D$r||(D$H=!1),D$Y===D$T&&D$e&&D$e.runWith(D$H)}function D$V(D$s,D$r){if(null!=D$j){D$s.progress=D$r;for(var D$e=0,D$U=0;D$U<D$h.length;D$U++){var D$m=D$h[D$U];D$e+=D$m.size*D$m.progress}var D$k=D$e/D$Z;D$j.runWith(D$k)}}return this},D$x.cacheRes=function(D$s,D$r){D$Ts.cacheRes(D$s,D$r)},D$x._resMap={},D$Y(D$x,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),D$x.__init$=function(){D$A=function(D$s){function D$r(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,D$r.__super.call(this)}return D$h(D$r,"",D$Z),D$r.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},D$r}()},D$x}(),D$Zs=(function(D$s){function D$m(D$s){D$m.__super.call(this),D$s||(D$s=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var D$r=0,D$e=0,D$U=0;D$U<20;D$U++)D$U%5!=4?this._mat[D$r++]=D$s[D$U]:this._alpha[D$e++]=D$s[D$U];this._action=D$P.createFilterAction(32),this._action.data=this}D$h(D$m,"laya.filters.ColorFilter",D$V);var D$r=D$m.prototype;D$D.imps(D$r,{"laya.filters.IFilter":!0}),D$r.callNative=function(D$s){D$s._$P.cf=this;D$s.conchModel&&D$s.conchModel.setFilterMatrix&&D$s.conchModel.setFilterMatrix(this._mat,this._alpha)},D$B(0,D$r,"type",function(){return 32}),D$B(0,D$r,"action",function(){return this._action})}(),function(D$s){function D$U(D$s,D$r,D$e){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===D$r&&(D$r=0),D$U.__super.call(this),this._byteClass=D$e||D$C,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,D$s&&0<D$r&&D$r<65535&&this.connect(D$s,D$r)}D$h(D$U,"laya.net.Socket",D$Z);var D$r=D$U.prototype;D$r.connect=function(D$s,D$r){var D$e="ws://"+D$s+":"+D$r;D$e="https:"==D$Q.window.location.protocol?"wss://"+D$s+":"+D$r:"ws://"+D$s+":"+D$r,this.connectByUrl(D$e)},D$r.connectByUrl=function(D$s){var D$r=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new D$Q.window.WebSocket(D$s,this.protocols):this._socket=new D$Q.window.WebSocket(D$s),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(D$s){D$r._onOpen(D$s)},this._socket.onmessage=function(D$s){D$r._onMessage(D$s)},this._socket.onclose=function(D$s){D$r._onClose(D$s)},this._socket.onerror=function(D$s){D$r._onError(D$s)}},D$r.cleanSocket=function(){try{this._socket.close()}catch(D$s){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},D$r.close=function(){if(null!=this._socket)try{this._socket.close()}catch(D$s){}},D$r._onOpen=function(D$s){this._connected=!0,this.event("open",D$s)},D$r._onMessage=function(D$s){if(D$s&&D$s.data){var D$r=D$s.data;if(this.disableInput&&D$r)this.event("message",D$r);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var D$e=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,D$r&&("string"==typeof D$r?this._input.writeUTFBytes(D$r):this._input.writeArrayBuffer(D$r),this._addInputPosition=this._input.pos,this._input.pos=D$e),this.event("message",D$r)}}},D$r._onClose=function(D$s){this._connected=!1,this.event("close",D$s)},D$r._onError=function(D$s){this.event("error",D$s)},D$r.send=function(D$s){this._socket.send(D$s)},D$r.flush=function(){if(this._output&&0<this._output.length){var D$r;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(D$s){D$r=D$s}this._output.endian=this.endian,this._output.clear(),D$r&&this.event("error",D$r)}},D$B(0,D$r,"input",function(){return this._input}),D$B(0,D$r,"output",function(){return this._output}),D$B(0,D$r,"connected",function(){return this._connected}),D$B(0,D$r,"endian",function(){return this._endian},function(D$s){this._endian=D$s,null!=this._input&&(this._input.endian=D$s),null!=this._output&&(this._output.endian=D$s)}),D$U.LITTLE_ENDIAN="littleEndian",D$U.BIG_ENDIAN="bigEndian"}(),function(D$s){function D$T(){D$T.__super.call(this),this._$1__id=++D$T._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(D$T._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,D$z.currentResourceManager&&D$z.currentResourceManager.addResource(this)}D$h(D$T,"laya.resource.Resource",D$Z);var D$r=D$T.prototype;return D$D.imps(D$r,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),D$r._setUrl=function(D$s){var D$r;this._url!==D$s&&(this._url&&((D$r=D$T._urlResourcesMap[this._url]).splice(D$r.indexOf(this),1),0===D$r.length&&delete D$T._urlResourcesMap[this._url]),D$s&&((D$r=D$T._urlResourcesMap[D$s])||(D$T._urlResourcesMap[D$s]=D$r=[]),D$r.push(this)),this._url=D$s)},D$r._getGroup=function(){return this._group},D$r._setGroup=function(D$s){var D$r;this._group!==D$s&&(this._group&&((D$r=D$T._groupResourcesMap[this._group]).splice(D$r.indexOf(this),1),0===D$r.length&&delete D$T._groupResourcesMap[this._group]),D$s&&((D$r=D$T._groupResourcesMap[D$s])||(D$T._groupResourcesMap[D$s]=D$r=[]),D$r.push(this)),this._group=D$s)},D$r._addReference=function(){this._referenceCount++},D$r._removeReference=function(){this._referenceCount--},D$r._clearReference=function(){this._referenceCount=0},D$r._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},D$r.recreateResource=function(){this.completeCreate()},D$r.disposeResource=function(){},D$r.activeResource=function(D$s){void 0===D$s&&(D$s=!1),this._lastUseFrameCount=D$t.loopCount,!this._destroyed&&this.__loaded&&(this._released||D$s)&&this.recreateResource()},D$r.releaseResource=function(D$s){return void 0===D$s&&(D$s=!0),!(!D$s&&this.lock)&&(!(this._released&&!D$s)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},D$r.onAsynLoaded=function(D$s,D$r,D$e){throw new Error("Resource: must override this function!")},D$r.destroy=function(){var D$s;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete D$T._idResourcesMap[this.id],this._url&&((D$s=D$T._urlResourcesMap[this._url])&&(D$s.splice(D$s.indexOf(this),1),0===D$s.length&&delete D$T._urlResourcesMap[this.url]),D$Ts.clearRes(this._url),this.__loaded||D$P.cancelLoadByUrl(this._url)),this._group&&((D$s=D$T._groupResourcesMap[this._group]).splice(D$s.indexOf(this),1),0===D$s.length&&delete D$T._groupResourcesMap[this.url]))},D$r.completeCreate=function(){this._released=!1,this.event("recovered",this)},D$r.dispose=function(){this.destroy()},D$B(0,D$r,"memorySize",function(){return this._memorySize},function(D$s){var D$r=D$s-this._memorySize;this._memorySize=D$s,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,D$r),this.resourceManager&&this.resourceManager.addSize(D$r)}),D$B(0,D$r,"_loaded",null,function(D$s){this.__loaded=D$s}),D$B(0,D$r,"loaded",function(){return this.__loaded}),D$B(0,D$r,"id",function(){return this._$1__id}),D$B(0,D$r,"destroyed",function(){return this._destroyed}),D$B(0,D$r,"group",function(){return this._getGroup()},function(D$s){this._setGroup(D$s)}),D$B(0,D$r,"resourceManager",function(){return this._resourceManager}),D$B(0,D$r,"url",function(){return this._url}),D$B(0,D$r,"released",function(){return this._released}),D$B(0,D$r,"referenceCount",function(){return this._referenceCount}),D$T.getResourceByID=function(D$s){return D$T._idResourcesMap[D$s]},D$T.getResourceByURL=function(D$s,D$r){return void 0===D$r&&(D$r=0),null==D$T._urlResourcesMap[D$s]?null:D$T._urlResourcesMap[D$s][D$r]},D$T.getResourceCountByURL=function(D$s){return D$T._urlResourcesMap[D$s].length},D$T.destroyUnusedResources=function(D$s){var D$r;if(D$s){var D$e=D$T._groupResourcesMap[D$s];if(D$e)for(var D$U=D$e.slice(),D$m=0,D$k=D$U.length;D$m<D$k;D$m++)(D$r=D$U[D$m]).lock||0!==D$r._referenceCount||D$r.destroy()}else for(var D$j in D$T._idResourcesMap)(D$r=D$T._idResourcesMap[D$j]).lock||0!==D$r._referenceCount||D$r.destroy()},D$T._uniqueIDCounter=0,D$T._idResourcesMap={},D$T._urlResourcesMap={},D$T._groupResourcesMap={},D$T}()),D$hs=function(D$s){function D$g(D$s,D$r){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,D$g.__super.call(this),D$s&&null!=D$s._addReference&&D$s._addReference(),this.setTo(D$s,D$r)}D$h(D$g,"laya.resource.Texture",D$Z);var D$r=D$g.prototype;return D$r._setUrl=function(D$s){this.url=D$s},D$r.setTo=function(D$s,D$r){if(D$s instanceof D$j.HTMLElement){var D$e=D$os.create("2D",D$s);this.bitmap=D$e}else this.bitmap=D$s;if(this.uv=D$r||D$g.DEF_UV,D$s){this._w=D$s.width,this._h=D$s.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var D$U=this;if(this._loaded)D$P.addToAtlas&&D$P.addToAtlas(D$U);else{var D$m=D$s;D$m instanceof laya.resource.HTMLImage&&D$m.image&&D$m.image.addEventListener("load",function(D$s){D$P.addToAtlas&&D$P.addToAtlas(D$U)},!1)}}},D$r.active=function(){this.bitmap&&this.bitmap.activeResource()},D$r.destroy=function(D$s){if(void 0===D$s&&(D$s=!1),this.alphaTexture&&(this.alphaTexture.destroy(D$s),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var D$r=this.bitmap;D$s?(D$c.isConchApp&&D$r.source&&D$r.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,D$r.dispose(),D$r._clearReference()):(D$r._removeReference(),0==D$r.referenceCount&&(D$c.isConchApp&&D$r.source&&D$r.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,D$r.dispose())),this.url&&this===D$D.loader.getRes(this.url)&&D$D.loader.clearRes(this.url,D$s),this._loaded=!1}},D$r.load=function(D$s){var D$r=this;this._loaded=!1,D$s=D$K.customFormat(D$s);var D$e=this.bitmap||(this.bitmap=D$Xs.create(D$s));D$e.uri=D$s,D$e&&D$e._addReference();var D$U=this;D$e.onload=function(){D$e.onload=null,D$U._loaded=!0,D$r.sourceWidth=D$r._w=D$e.width,D$r.sourceHeight=D$r._h=D$e.height,D$U.event("loaded",this),D$P.addToAtlas&&D$P.addToAtlas(D$U)}},D$r.addTextureToAtlas=function(D$s){D$P.addTextureToAtlas(this)},D$r.getPixels=function(D$s,D$r,D$e,D$U){if(D$c.isConchApp){var D$m=this.bitmap;if(D$m.source&&D$m.source.getImageData){var D$k=D$m.source.getImageData(D$s,D$r,D$e,D$U),D$j=new Uint8Array(D$k);return Array.from(D$j)}return null}return D$c.isWebGL?D$P.getTexturePixels(this,D$s,D$r,D$e,D$U):(D$Q.canvas.size(D$e,D$U),D$Q.canvas.clear(),D$Q.context.drawTexture(this,-D$s,-D$r,this.width,this.height,0,0),D$Q.context.getImageData(0,0,D$e,D$U).data)},D$r.onAsynLoaded=function(D$s,D$r){if(D$r){if("function"!=typeof D$r._addReference)throw new Error("bitmap._addReference is not a function. "+D$r.className+" "+typeof D$r._addReference+" "+D$r.constructor);D$r._addReference()}this.setTo(D$r,this.uv),this._loaded&&this.event("loaded",this)},D$B(0,D$r,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),D$B(0,D$r,"loaded",function(){return this._loaded}),D$B(0,D$r,"released",function(){return!this.bitmap||this.bitmap.released}),D$B(0,D$r,"width",function(){return this._w?this._w:this.uv&&this.uv!==D$g.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(D$s){this._w=D$s,this.sourceWidth||(this.sourceWidth=D$s)}),D$B(0,D$r,"repeat",function(){return!D$c.isWebGL||!this.bitmap||this.bitmap.repeat},function(D$s){D$s&&D$c.isWebGL&&this.bitmap&&(this.bitmap.repeat=D$s)&&(this.bitmap.enableMerageInAtlas=!1)}),D$B(0,D$r,"height",function(){return this._h?this._h:this.uv&&this.uv!==D$g.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(D$s){this._h=D$s,this.sourceHeight||(this.sourceHeight=D$s)}),D$B(0,D$r,"isLinearSampling",function(){return!D$c.isWebGL||9728!=this.bitmap.minFifter},function(D$s){!D$s&&D$c.isWebGL&&(D$s||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),D$g.moveUV=function(D$s,D$r,D$e){for(var D$U=0;D$U<8;D$U+=2)D$e[D$U]+=D$s,D$e[D$U+1]+=D$r;return D$e},D$g.create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){void 0===D$k&&(D$k=0),void 0===D$j&&(D$j=0),void 0===D$T&&(D$T=0),void 0===D$Y&&(D$Y=0);var D$Z=D$s instanceof laya.resource.Texture,D$h=D$Z?D$s.uv:D$g.DEF_UV,D$H=D$Z?D$s.bitmap:D$s,D$A=D$P.isAtlas(D$H);if(D$A){var D$x=D$H._atlaser,D$B=D$s._atlasID;if(-1==D$B)throw new Error("create texture error");D$H=D$x._inAtlasTextureBitmapValue[D$B],D$h=D$x._inAtlasTextureOriUVValue[D$B]}var D$$=new D$g(D$H,null);D$H.width&&D$r+D$U>D$H.width&&(D$U=D$H.width-D$r),D$H.height&&D$e+D$m>D$H.height&&(D$m=D$H.height-D$e),D$$.width=D$U,D$$.height=D$m,D$$.offsetX=D$k,D$$.offsetY=D$j,D$$.sourceWidth=D$T||D$U,D$$.sourceHeight=D$Y||D$m;var D$l=1/D$H.width,D$V=1/D$H.height;D$r*=D$l,D$e*=D$V,D$U*=D$l,D$m*=D$V;var D$b=D$$.uv[0],D$o=D$$.uv[1],D$I=D$$.uv[4],D$w=D$$.uv[5],D$X=D$I-D$b,D$D=D$w-D$o,D$n=D$g.moveUV(D$h[0],D$h[1],[D$r,D$e,D$r+D$U,D$e,D$r+D$U,D$e+D$m,D$r,D$e+D$m]);D$$.uv=[D$b+D$n[0]*D$X,D$o+D$n[1]*D$D,D$I-(1-D$n[2])*D$X,D$o+D$n[3]*D$D,D$I-(1-D$n[4])*D$X,D$w-(1-D$n[5])*D$D,D$b+D$n[6]*D$X,D$w-(1-D$n[7])*D$D],D$A&&D$$.addTextureToAtlas();var D$y=D$H.scaleRate;return D$y&&1!=D$y?(D$$.sourceWidth/=D$y,D$$.sourceHeight/=D$y,D$$.width/=D$y,D$$.height/=D$y,D$$.scaleRate=D$y,D$$.offsetX/=D$y,D$$.offsetY/=D$y):D$$.scaleRate=1,D$$},D$g.createFromTexture=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$s.scaleRate;1!=D$k&&(D$r*=D$k,D$e*=D$k,D$U*=D$k,D$m*=D$k);var D$j=D$y.TEMP.setTo(D$r-D$s.offsetX,D$e-D$s.offsetY,D$U,D$m),D$T=D$j.intersection(D$g._rect1.setTo(0,0,D$s.width,D$s.height),D$g._rect2);if(!D$T)return null;var D$Y=D$g.create(D$s,D$T.x,D$T.y,D$T.width,D$T.height,D$T.x-D$j.x,D$T.y-D$j.y,D$U,D$m);if(D$Y.bitmap&&D$Y.bitmap._removeReference)return D$Y.bitmap._removeReference(),D$Y;var D$Z="bitmap:"+(D$Y.bitmap?D$Y.bitmap.constructor?D$Y.bitmap.constructor.name:D$Y.bitmap.__className:"")+", url:"+(D$s.url+" | "+(D$Y.bitmap?D$Y.bitmap.url:D$s.url))+", x="+D$r+",y="+D$e+",width="+D$U+",height="+D$m+", result="+(D$T?D$T.x+","+D$T.y+","+D$T.width+","+D$T.height:"null")+", rect="+D$j.x+","+D$j.y+","+D$j.width+","+D$j.height;throw new Error("报错：bitmap._removeReference is not a function  "+D$Z)},D$g.DEF_UV=[0,0,1,0,1,1,0,1],D$g.INV_UV=[0,1,1,1,1,0,0,0],D$g._rect1=new D$y,D$g._rect2=new D$y,D$g}(),D$s=function(D$s){var D$T;function D$k(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,D$k.__super.call(this)}D$h(D$k,"laya.utils.TimeLine",D$Z);var D$r=D$k.prototype;return D$r.to=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$m&&(D$m=0),this._create(D$s,D$r,D$e,D$U,D$m,!0)},D$r.from=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$m&&(D$m=0),this._create(D$s,D$r,D$e,D$U,D$m,!1)},D$r._create=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$d.getItemByClass("tweenData",D$T);return D$j.isTo=D$k,D$j.type=0,D$j.target=D$s,D$j.duration=D$e,D$j.data=D$r,D$j.startTime=this._startTime+D$m,D$j.endTime=D$j.startTime+D$j.duration,D$j.ease=D$U,this._startTime=Math.max(D$j.endTime,this._startTime),this._tweenDataList.push(D$j),this._startTimeSort=!0,this._endTimeSort=!0,this},D$r.addLabel=function(D$s,D$r){var D$e=D$d.getItemByClass("tweenData",D$T);return D$e.type=1,D$e.data=D$s,D$e.endTime=D$e.startTime=this._startTime+D$r,this._labelDic||(this._labelDic={}),this._labelDic[D$s]=D$e,this._tweenDataList.push(D$e),this},D$r.removeLabel=function(D$s){if(this._labelDic&&this._labelDic[D$s]){var D$r=this._labelDic[D$s];if(D$r){var D$e=this._tweenDataList.indexOf(D$r);-1<D$e&&this._tweenDataList.splice(D$e,1)}delete this._labelDic[D$s]}},D$r.gotoTime=function(D$s){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var D$r,D$e,D$U,D$m;for(var D$k in this._firstTweenDic)if(D$e=this._firstTweenDic[D$k])for(var D$j in D$e)D$e.diyTarget.hasOwnProperty(D$j)&&(D$e.diyTarget[D$j]=D$e[D$j]);for(D$k in this._tweenDic)(D$r=this._tweenDic[D$k]).clear(),delete this._tweenDic[D$k];if(this._index=0,this._gidIndex=0,this._currTime=D$s,this._lastTime=D$Q.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=D$U=this._tweenDataList.concat(),D$U.sort(function(D$s,D$r){return D$s.endTime>D$r.endTime?1:D$s.endTime<D$r.endTime?-1:0})}else D$U=this._endTweenDataList;for(var D$T=0,D$Y=D$U.length;D$T<D$Y;D$T++)if(0==(D$m=D$U[D$T]).type){if(!(D$s>=D$m.endTime))break;this._index=Math.max(this._index,D$T+1);var D$Z=D$m.data;if(D$m.isTo)for(var D$h in D$Z)D$m.target[D$h]=D$Z[D$h]}for(D$T=0,D$Y=this._tweenDataList.length;D$T<D$Y;D$T++)0==(D$m=this._tweenDataList[D$T]).type&&D$s>=D$m.startTime&&D$s<D$m.endTime&&(this._index=Math.max(this._index,D$T+1),this._gidIndex++,(D$r=D$d.getItemByClass("tween",D$L))._create(D$m.target,D$m.data,D$m.duration,D$m.ease,D$b.create(this,this._animComplete,[this._gidIndex]),0,!1,D$m.isTo,!0,!1),D$r.setStartTime(this._currTime-(D$s-D$m.startTime)),D$r._updateEase(this._currTime),D$r.gid=this._gidIndex,this._tweenDic[this._gidIndex]=D$r)}},D$r.gotoLabel=function(D$s){if(null!=this._labelDic){var D$r=this._labelDic[D$s];D$r&&this.gotoTime(D$r.startTime)}},D$r.pause=function(){D$D.timer.clear(this,this._update)},D$r.resume=function(){this.play(this._currTime,this._loopKey)},D$r.play=function(D$s,D$r){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(D$s,D$r){return D$s.startTime>D$r.startTime?1:D$s.startTime<D$r.startTime?-1:0});for(var D$e=0,D$U=this._tweenDataList.length;D$e<D$U;D$e++){var D$m=this._tweenDataList[D$e];if(null!=D$m&&0==D$m.type){var D$k=D$m.target,D$j=D$k.$_GID||(D$k.$_GID=D$u.getGID()),D$T=null;for(var D$Y in null==this._firstTweenDic[D$j]?((D$T={}).diyTarget=D$k,this._firstTweenDic[D$j]=D$T):D$T=this._firstTweenDic[D$j],D$m.data)null==D$T[D$Y]&&(D$T[D$Y]=D$k[D$Y])}}}"string"==typeof D$s?this.gotoLabel(D$s):this.gotoTime(D$s),this._loopKey=D$r,this._lastTime=D$Q.now(),D$D.timer.frameLoop(1,this,this._update)}},D$r._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var D$s in this._tweenDic)(D$r=this._tweenDic[D$s]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var D$r,D$e=D$Q.now(),D$U=D$e-this._lastTime,D$m=this._currTime+=D$U*this.scale;for(D$s in this._lastTime=D$e,this._tweenDic)(D$r=this._tweenDic[D$s])._updateEase(D$m);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var D$k=this._tweenDataList[this._index];D$m>=D$k.startTime&&(this._index++,0==D$k.type?(this._gidIndex++,(D$r=D$d.getItemByClass("tween",D$L))._create(D$k.target,D$k.data,D$k.duration,D$k.ease,D$b.create(this,this._animComplete,[this._gidIndex]),0,!1,D$k.isTo,!0,!1),D$r.setStartTime(D$m),D$r.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=D$r)._updateEase(D$m)):this.event("label",D$k.data))}},D$r._animComplete=function(D$s){this._tweenDic[D$s]&&delete this._tweenDic[D$s]},D$r._complete=function(){this.event("complete")},D$r.reset=function(){var D$s;if(this._labelDic)for(D$s in this._labelDic)delete this._labelDic[D$s];for(D$s in this._tweenDic)this._tweenDic[D$s].clear(),delete this._tweenDic[D$s];for(D$s in this._firstTweenDic)delete this._firstTweenDic[D$s];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var D$r,D$e=0;for(D$r=this._tweenDataList.length,D$e=0;D$e<D$r;D$e++)this._tweenDataList[D$e]&&this._tweenDataList[D$e].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,D$D.timer.clear(this,this._update)},D$r.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},D$B(0,D$r,"index",function(){return this._frameIndex},function(D$s){this._frameIndex=D$s,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),D$B(0,D$r,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),D$k.to=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$m&&(D$m=0),(new D$k).to(D$s,D$r,D$e,D$U,D$m)},D$k.from=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$m&&(D$m=0),(new D$k).from(D$s,D$r,D$e,D$U,D$m)},D$k.__init$=function(){D$T=function(){function D$s(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return D$h(D$s,""),D$s.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,D$d.recover("tweenData",this)},D$s}()},D$k}(),D$Hs=function(D$m){function D$e(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,D$e.__super.call(this),this._style=D$T.EMPTY}D$h(D$e,"laya.display.Sprite",D$m);var D$s=D$e.prototype;return D$D.imps(D$s,{"laya.display.ILayout":!0}),D$s.createConchModel=function(){return new ConchNode},D$s.destroy=function(D$s){if(void 0===D$s&&(D$s=!0),this._releaseMem(),!this._destroyed){this.filters=null;var D$r=this.mask;D$r&&(this.mask=null,D$r.destroy(D$s))}D$m.prototype.destroy.call(this,D$s),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},D$s.updateZOrder=function(){D$u.updateOrder(this._childs)&&this.repaint()},D$s.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},D$s.setBounds=function(D$s){this._set$P("uBounds",D$s)},D$s.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new D$y),D$y._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},D$s.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new D$y),D$y._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},D$s._boundPointsToParent=function(D$s){void 0===D$s&&(D$s=!1);var D$r=0,D$e=0;this._style&&(D$r=this._style._tf.translateX,D$e=this._style._tf.translateY,D$s=D$s||0!==this._style._tf.rotate,this._style.scrollRect&&(D$r+=this._style.scrollRect.x,D$e+=this._style.scrollRect.y));var D$U=this._getBoundPointsM(D$s);if(!D$U||D$U.length<1)return D$U;if(8!=D$U.length&&(D$U=D$s?D$w.scanPList(D$U):D$y._getWrapRec(D$U,D$y.TEMP)._getBoundPoints()),!this.transform)return D$u.transPointList(D$U,this._x-D$r,this._y-D$e),D$U;var D$m=D$n.TEMP,D$k=0,D$j=D$U.length;for(D$k=0;D$k<D$j;D$k+=2)D$m.x=D$U[D$k],D$m.y=D$U[D$k+1],this.toParentPoint(D$m),D$U[D$k]=D$m.x,D$U[D$k+1]=D$m.y;return D$U},D$s.getGraphicBounds=function(D$s){return void 0===D$s&&(D$s=!1),this._graphics?this._graphics.getBounds(D$s):D$y.TEMP.setTo(0,0,0,0)},D$s._getBoundPointsM=function(D$s){if(void 0===D$s&&(D$s=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var D$r=D$u.clearArray(this._$P.temBM),D$e=D$y.TEMP;return D$e.copyFrom(this.scrollRect),D$u.concatArray(D$r,D$e._getBoundPoints()),D$r}for(var D$U,D$m,D$k,D$j=this._graphics?this._graphics.getBoundPoints():D$u.clearArray(this._$P.temBM),D$T=0,D$Y=(D$k=this._childs).length;D$T<D$Y;D$T++)(D$U=D$k[D$T])instanceof laya.display.Sprite&&1==D$U.visible&&(D$m=D$U._boundPointsToParent(D$s))&&(D$j=D$j?D$u.concatArray(D$j,D$m):D$m);return D$j},D$s.getStyle=function(){return this._style===D$T.EMPTY&&(this._style=new D$T),this._style},D$s.setStyle=function(D$s){this._style=D$s},D$s._adjustTransform=function(){this._tfChanged=!1;var D$s,D$r=this._style._tf,D$e=D$r.scaleX,D$U=D$r.scaleY;if(D$r.rotate||1!==D$e||1!==D$U||D$r.skewX||D$r.skewY){(D$s=this._transform||(this._transform=D$O.create())).bTransform=!0;var D$m=.0174532922222222*(D$r.rotate-D$r.skewX),D$k=.0174532922222222*(D$r.rotate+D$r.skewY),D$j=Math.cos(D$k),D$T=Math.sin(D$k),D$Y=Math.sin(D$m),D$Z=Math.cos(D$m);return D$s.a=D$e*D$j,D$s.b=D$e*D$T,D$s.c=-D$U*D$Y,D$s.d=D$U*D$Z,D$s.tx=D$s.ty=0,D$s}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,D$s},D$s.pos=function(D$s,D$r,D$e){if(void 0===D$e&&(D$e=!1),this._x!==D$s||this._y!==D$r){if(this.destroyed)return this;if(D$e){this._x=D$s,this._y=D$r,this.conchModel&&this.conchModel.pos(this._x,this._y);var D$U=this._parent;D$U&&0===D$U._repaint&&(D$U._repaint=1,D$U.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=D$s,this.y=D$r}return this},D$s.pivot=function(D$s,D$r){return this.pivotX=D$s,this.pivotY=D$r,this},D$s.size=function(D$s,D$r){return this.width=D$s,this.height=D$r,this},D$s.scale=function(D$s,D$r,D$e){void 0===D$e&&(D$e=!1);var D$U=this.getStyle(),D$m=D$U._tf;if(D$m.scaleX!=D$s||D$m.scaleY!=D$r){if(this.destroyed)return this;if(D$e){D$U.setScale(D$s,D$r),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(D$s,D$r),this._renderType|=4;var D$k=this._parent;D$k&&0===D$k._repaint&&(D$k._repaint=1,D$k.parentRepaint())}else this.scaleX=D$s,this.scaleY=D$r}return this},D$s.skew=function(D$s,D$r){return this.skewX=D$s,this.skewY=D$r,this},D$s.render=function(D$s,D$r,D$e){D$t.spriteCount++,D$v.renders[this._renderType]._fun(this,D$s,D$r+this._x,D$e+this._y),this._repaint=0},D$s.drawToCanvas=function(D$s,D$r,D$e,D$U){if(D$c.isConchNode){var D$m=D$os.create("2D");return new D$E(D$s,D$r,D$m).ctx.setCanvasType(1),this.conchModel.drawToCanvas(D$m.source,D$e,D$U),D$m}return D$P.drawToCanvas(this,this._renderType,D$s,D$r,D$e,D$U)},D$s.customRender=function(D$s,D$r,D$e){this._renderType|=1024},D$s._applyFilters=function(){var D$s;if(!D$c.isWebGL&&((D$s=this._$P.filters)&&!(D$s.length<1)))for(var D$r=0,D$e=D$s.length;D$r<D$e;D$r++)D$s[D$r].action.apply(this._$P.cacheCanvas)},D$s._isHaveGlowFilter=function(){var D$s,D$r=0;if(this.filters)for(D$r=0;D$r<this.filters.length;D$r++)if(8==this.filters[D$r].type)return!0;for(D$r=0,D$s=this._childs.length;D$r<D$s;D$r++)if(this._childs[D$r]._isHaveGlowFilter())return!0;return!1},D$s.localToGlobal=function(D$s,D$r){void 0===D$r&&(D$r=!1),!0===D$r&&(D$s=new D$n(D$s.x,D$s.y));for(var D$e=this;D$e&&D$e!=D$D.stage;)D$s=D$e.toParentPoint(D$s),D$e=D$e.parent;return D$s},D$s.globalToLocal=function(D$s,D$r){void 0===D$r&&(D$r=!1),D$r&&(D$s=new D$n(D$s.x,D$s.y));for(var D$e=this,D$U=[];D$e&&D$e!=D$D.stage;)D$U.push(D$e),D$e=D$e.parent;for(var D$m=D$U.length-1;0<=D$m;)D$s=(D$e=D$U[D$m]).fromParentPoint(D$s),D$m--;return D$s},D$s.toParentPoint=function(D$s){if(!D$s)return D$s;D$s.x-=this.pivotX,D$s.y-=this.pivotY,this.transform&&this._transform.transformPoint(D$s),D$s.x+=this._x,D$s.y+=this._y;var D$r=this._style.scrollRect;return D$r&&(D$s.x-=D$r.x,D$s.y-=D$r.y),D$s},D$s.fromParentPoint=function(D$s){if(!D$s)return D$s;D$s.x-=this._x,D$s.y-=this._y;var D$r=this._style.scrollRect;return D$r&&(D$s.x+=D$r.x,D$s.y+=D$r.y),this.transform&&this._transform.invertTransformPoint(D$s),D$s.x+=this.pivotX,D$s.y+=this.pivotY,D$s},D$s.on=function(D$s,D$r,D$e,D$U){return 1!==this._mouseEnableState&&this.isMouseEvent(D$s)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(D$s,D$r,D$e,D$U,!1)):D$m.prototype.on.call(this,D$s,D$r,D$e,D$U)},D$s.once=function(D$s,D$r,D$e,D$U){return 1!==this._mouseEnableState&&this.isMouseEvent(D$s)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(D$s,D$r,D$e,D$U,!0)):D$m.prototype.once.call(this,D$s,D$r,D$e,D$U)},D$s._$2__onDisplay=function(){if(1!==this._mouseEnableState){var D$s=this;for(D$s=D$s.parent;D$s&&1!==D$s._mouseEnableState&&!D$s._getBit(2);)D$s.mouseEnabled=!0,D$s._setBit(2,!0),D$s=D$s.parent}},D$s.loadImage=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=this;return void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),this.graphics.loadImage(D$s,D$r,D$e,D$U,D$m,function(D$s){D$j.destroyed||(D$j.size(D$r+(D$U||D$s.width),D$e+(D$m||D$s.height)),D$j.repaint(),D$k&&D$k.runWith(D$s))}),this},D$s.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},D$s._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},D$s._childChanged=function(D$s){this._childs.length?this._renderType|=2048:this._renderType&=-2049,D$s&&this._get$P("hasZorder")&&D$D.timer.callLater(this,this.updateZOrder),this.repaint()},D$s.parentRepaint=function(){var D$s=this._parent;D$s&&0===D$s._repaint&&(D$s._repaint=1,D$s.parentRepaint())},D$s.startDrag=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){void 0===D$r&&(D$r=!1),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=300),void 0===D$k&&(D$k=!1),void 0===D$j&&(D$j=.92),this._$P.dragging||this._set$P("dragging",new D$N),this._$P.dragging.start(this,D$s,D$r,D$e,D$U,D$m,D$k,D$j)},D$s.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},D$s._releaseMem=function(){if(this._$P){var D$s=this._$P.cacheCanvas;D$s&&D$s.ctx&&(D$d.recover("RenderContext",D$s.ctx),D$s.ctx.canvas.size(0,0),D$s.ctx=null);var D$r=this._$P._filterCache;D$r&&(D$r.destroy(),D$r.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},D$s._setDisplay=function(D$s){D$s||this._releaseMem(),D$m.prototype._setDisplay.call(this,D$s)},D$s.hitTestPoint=function(D$s,D$r){var D$e=this.globalToLocal(D$n.TEMP.setTo(D$s,D$r));return D$s=D$e.x,D$r=D$e.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?D$y.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(D$s,D$r)},D$s.getMousePoint=function(){return this.globalToLocal(D$n.TEMP.setTo(D$D.stage.mouseX,D$D.stage.mouseY))},D$s._getWords=function(){return null},D$s._addChildsToLayout=function(D$s){var D$r=this._getWords();if(null==D$r&&0==this._childs.length)return!1;if(D$r)for(var D$e=0,D$U=D$r.length;D$e<D$U;D$e++)D$s.push(D$r[D$e]);D$e=0;for(var D$m=this._childs.length;D$e<D$m;++D$e){var D$k=this._childs[D$e];D$k._style._enableLayout()&&D$k._addToLayout(D$s)}return!0},D$s._addToLayout=function(D$s){this._style.absolute||(this._style.block?D$s.push(this):this._addChildsToLayout(D$s)&&(this.x=this.y=0))},D$s._isChar=function(){return!1},D$s._getCSSStyle=function(){return this._style.getCSSStyle()},D$s._setAttributes=function(D$s,D$r){switch(D$s){case"x":this.x=parseFloat(D$r);break;case"y":this.y=parseFloat(D$r);break;case"width":this.width=parseFloat(D$r);break;case"height":this.height=parseFloat(D$r);break;default:this[D$s]=D$r}},D$s._layoutLater=function(){this.parent&&this.parent._layoutLater()},D$B(0,D$s,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(D$s){this._optimizeScrollRect!=D$s&&(this._optimizeScrollRect=D$s,this.conchModel&&this.conchModel.optimizeScrollRect(D$s))}),D$B(0,D$s,"customRenderEnable",null,function(D$s){if(D$s&&(this._renderType|=1024,D$c.isConchNode)){D$e.CustomList.push(this);var D$r=new D$os("2d");D$r._setContext(new CanvasRenderingContext2D),this.customContext=new D$E(0,0,D$r),D$r.context.setCanvasType&&D$r.context.setCanvasType(2),this.conchModel.custom(D$r.context)}}),D$B(0,D$s,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(D$s){this.cacheAs=D$s?this._$P.hasFilter?"none":"normal":"none"}),D$B(0,D$s,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(D$s){var D$r=this._$P.cacheCanvas;if(D$s!==(D$r?D$r.type:"none")){if("none"!==D$s)this._getBit(1)||this._setUpNoticeType(1),D$r||(D$r=this._set$P("cacheCanvas",D$d.getItemByClass("cacheCanvas",Object))),D$r.type=D$s,D$r.reCache=!0,this._renderType|=16,"bitmap"==D$s&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(D$r){var D$e=D$r;D$e&&D$e.ctx&&(D$d.recover("RenderContext",D$e.ctx),D$e.ctx.canvas.size(0,0),D$e.ctx=null),D$d.recover("cacheCanvas",D$r)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),D$B(0,D$s,"zOrder",function(){return this._zOrder},function(D$s){this._zOrder!=D$s&&(this._zOrder=D$s,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(D$s),this._parent&&(D$s&&this._parent._set$P("hasZorder",!0),D$D.timer.callLater(this._parent,this.updateZOrder)))}),D$B(0,D$s,"rotation",function(){return this._style._tf.rotate},function(D$s){var D$r=this.getStyle();if(D$r._tf.rotate!==D$s){D$r.setRotate(D$s),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(D$s),this._renderType|=4;var D$e=this._parent;D$e&&0===D$e._repaint&&(D$e._repaint=1,D$e.parentRepaint())}}),D$B(0,D$s,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(D$s){this._width!==D$s&&(this._width=D$s,this.conchModel&&this.conchModel.size(D$s,this._height),this.repaint())}),D$B(0,D$s,"x",function(){return this._x},function(D$s){if(this._x!==D$s){if(this.destroyed)return;this._x=D$s,this.conchModel&&this.conchModel.pos(D$s,this._y);var D$r=this._parent;D$r&&0===D$r._repaint&&(D$r._repaint=1,D$r.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),D$B(0,D$s,"globalScaleY",function(){for(var D$s=1,D$r=this;D$r&&D$r!==D$D.stage;)D$s*=D$r.scaleY,D$r=D$r.parent;return D$s}),D$B(0,D$s,"hitArea",function(){return this._$P.hitArea},function(D$s){this._set$P("hitArea",D$s)}),D$B(0,D$s,"staticCache",function(){return this._$P.staticCache},function(D$s){this._set$P("staticCache",D$s),D$s||this.reCache()}),D$B(0,D$s,"texture",function(){return this._texture},function(D$s){this._texture!=D$s&&(this._texture=D$s,this.graphics.cleanByTexture(D$s,0,0))}),D$B(0,D$s,"y",function(){return this._y},function(D$s){if(this._y!==D$s){if(this.destroyed)return;this._y=D$s,this.conchModel&&this.conchModel.pos(this._x,D$s);var D$r=this._parent;D$r&&0===D$r._repaint&&(D$r._repaint=1,D$r.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),D$B(0,D$s,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(D$s){this._height!==D$s&&(this._height=D$s,this.conchModel&&this.conchModel.size(this._width,D$s),this.repaint())}),D$B(0,D$s,"blendMode",function(){return this._style.blendMode},function(D$s){this.getStyle().blendMode=D$s,this.conchModel&&this.conchModel.blendMode(D$s),D$s&&"source-over"!=D$s?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),D$B(0,D$s,"scaleX",function(){return this._style._tf.scaleX},function(D$s){var D$r=this.getStyle();if(D$r._tf.scaleX!==D$s){D$r.setScaleX(D$s),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(D$s,D$r._tf.scaleY),this._renderType|=4;var D$e=this._parent;D$e&&0===D$e._repaint&&(D$e._repaint=1,D$e.parentRepaint())}}),D$B(0,D$s,"scaleY",function(){return this._style._tf.scaleY},function(D$s){var D$r=this.getStyle();if(D$r._tf.scaleY!==D$s){D$r.setScaleY(D$s),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(D$r._tf.scaleX,D$s),this._renderType|=4;var D$e=this._parent;D$e&&0===D$e._repaint&&(D$e._repaint=1,D$e.parentRepaint())}}),D$B(0,D$s,"stage",function(){return D$D.stage}),D$B(0,D$s,"skewX",function(){return this._style._tf.skewX},function(D$s){var D$r=this.getStyle();if(D$r._tf.skewX!==D$s){D$r.setSkewX(D$s),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(D$s,D$r._tf.skewY),this._renderType|=4;var D$e=this._parent;D$e&&0===D$e._repaint&&(D$e._repaint=1,D$e.parentRepaint())}}),D$B(0,D$s,"scrollRect",function(){return this._style.scrollRect},function(D$s){this.getStyle().scrollRect=D$s,this.repaint(),D$s?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(D$s.x,D$s.y,D$s.width,D$s.height)):(this._renderType&=-129,this.conchModel&&(D$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),D$B(0,D$s,"skewY",function(){return this._style._tf.skewY},function(D$s){var D$r=this.getStyle();if(D$r._tf.skewY!==D$s){D$r.setSkewY(D$s),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(D$r._tf.skewX,D$s),this._renderType|=4;var D$e=this._parent;D$e&&0===D$e._repaint&&(D$e._repaint=1,D$e.parentRepaint())}}),D$B(0,D$s,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(D$s){this._tfChanged=!1,(this._transform=D$s)&&(this._x=D$s.tx,this._y=D$s.ty,D$s.tx=D$s.ty=0,this.conchModel&&this.conchModel.transform(D$s.a,D$s.b,D$s.c,D$s.d,this._x,this._y)),D$s?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),D$B(0,D$s,"pivotX",function(){return this._style._tf.translateX},function(D$s){this.getStyle().setTranslateX(D$s),this.conchModel&&this.conchModel.pivot(D$s,this._style._tf.translateY),this.repaint()}),D$B(0,D$s,"pivotY",function(){return this._style._tf.translateY},function(D$s){this.getStyle().setTranslateY(D$s),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,D$s),this.repaint()}),D$B(0,D$s,"alpha",function(){return this._style.alpha},function(D$s){this._style&&this._style.alpha!==D$s&&(D$s=D$s<0?0:1<D$s?1:D$s,this.getStyle().alpha=D$s,this.conchModel&&this.conchModel.alpha(D$s),1!==D$s?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),D$B(0,D$s,"visible",function(){return this._style.visible},function(D$s){this._style&&this._style.visible!==D$s&&(this.getStyle().visible=D$s,this.conchModel&&this.conchModel.visible(D$s),this.parentRepaint())}),D$B(0,D$s,"graphics",function(){return this._graphics||(this.graphics=D$P.createGraphics())},function(D$s){this._graphics&&(this._graphics._sp=null),(this._graphics=D$s)?(this._renderType&=-2,this._renderType|=512,(D$s._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(D$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),D$B(0,D$s,"filters",function(){return this._$P.filters},function(D$s){D$s&&0===D$s.length&&(D$s=null),this._$P.filters!=D$s&&(this._set$P("filters",D$s?D$s.slice():null),D$c.isConchApp&&(this.conchModel&&(D$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),D$c.isWebGL&&(D$s&&D$s.length?this._renderType|=32:this._renderType&=-33),D$s&&0<D$s.length?(this._getBit(1)||this._setUpNoticeType(1),D$c.isWebGL&&1==D$s.length&&D$s[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(D$c.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),D$B(0,D$s,"parent",D$m.prototype._$get_parent,function(D$s){D$D.superSet(D$ss,this,"parent",D$s),D$s&&this._getBit(2)&&this._$2__onDisplay()}),D$B(0,D$s,"mask",function(){return this._$P._mask},function(D$s){D$s&&this.mask&&this.mask._$P.maskParent||(D$s?(this.cacheAs="bitmap",this._set$P("_mask",D$s),D$s._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",D$s),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(D$s?D$s.conchModel:null),this._renderType|=64,this.parentRepaint())}),D$B(0,D$s,"mouseEnabled",function(){return 1<this._mouseEnableState},function(D$s){this._mouseEnableState=D$s?2:1}),D$B(0,D$s,"globalScaleX",function(){for(var D$s=1,D$r=this;D$r&&D$r!==D$D.stage;)D$s*=D$r.scaleX,D$r=D$r.parent;return D$s}),D$B(0,D$s,"mouseX",function(){return this.getMousePoint().x}),D$B(0,D$s,"mouseY",function(){return this.getMousePoint().y}),D$e.fromImage=function(D$s){return(new D$e).loadImage(D$s)},D$e._cachePool=[],D$e.CustomList=[],D$Y(D$e,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=D$j.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),D$e}(D$ss),D$As=function(D$s){function D$r(D$s){this._audio=null,this._onEnd=null,this._resumePlay=null,D$r.__super.call(this),this._onEnd=D$u.bind(this.__onEnd,this),this._resumePlay=D$u.bind(this.__resumePlay,this),D$s.addEventListener("ended",this._onEnd),this._audio=D$s}D$h(D$r,"laya.media.h5audio.AudioSoundChannel",D$Us);var D$e=D$r.prototype;return D$e.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(D$D.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},D$e.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,D$Q.container.appendChild(this._audio),this._audio.play()}catch(D$s){this.event("error")}},D$e.play=function(D$s){this.isStopped=!1;try{this._audio.playbackRate=D$J.playbackRate,this._audio.currentTime=this.startTime}catch(D$s){return void this._audio.addEventListener("canplay",this._resumePlay)}D$J.addChannel(this),D$Q.container.appendChild(this._audio),!D$s&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},D$e.stop=function(){this.isStopped=!0,D$J.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&D$c.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),D$Q.onIE||this._audio!=D$es._musicAudio&&D$d.recover("audio:"+this.url,this._audio),D$Q.removeElement(this._audio),this._audio=null)},D$e.pause=function(){this.isStopped=!0,D$J.removeChannel(this),"pause"in this._audio&&this._audio.pause()},D$e.resume=function(){this._audio&&(this.isStopped=!1,D$J.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},D$B(0,D$e,"position",function(){return this._audio?this._audio.currentTime:0}),D$B(0,D$e,"duration",function(){return this._audio?this._audio.duration:0}),D$B(0,D$e,"volume",function(){return this._audio?this._audio.volume:1},function(D$s){this._audio&&(this._audio.volume=D$s)}),D$r}(),D$xs=function(D$s){function D$r(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=D$ks.ctx,D$r.__super.call(this),this._onPlayEnd=D$u.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}D$h(D$r,"laya.media.webaudio.WebAudioSoundChannel",D$Us);var D$e=D$r.prototype;return D$e.play=function(D$s){if(D$J.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var D$r=this.context,D$e=this.gain,D$U=D$r.createBufferSource();(this.bufferSource=D$U).buffer=this.audioBuffer,D$U.connect(D$e),D$e&&D$e.disconnect(),D$e.connect(D$r.destination),D$U.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=D$Q.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(D$U.loop=!0),D$U.playbackRate.setTargetAtTime?D$U.playbackRate.setTargetAtTime(D$J.playbackRate,this.context.currentTime,.1):D$U.playbackRate.value=D$J.playbackRate,D$U.start(0,this.startTime),!D$s&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},D$e.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(D$D.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},D$e._clearBufferSource=function(){if(this.bufferSource){var D$s=this.bufferSource;D$s.stop?D$s.stop(0):D$s.noteOff(0),D$s.disconnect(0),D$s.onended=null,D$r._tryCleanFailed||this._tryClearBuffer(D$s),this.bufferSource=null}},D$e._tryClearBuffer=function(D$s){try{D$s.buffer=null}catch(D$s){D$r._tryCleanFailed=!0}},D$e.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,D$J.removeChannel(this),this.startHandler=null,this.completeHandler=null},D$e.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,D$J.removeChannel(this)},D$e.resume=function(){this.startTime=this._pauseTime,this.play(!1)},D$B(0,D$e,"position",function(){return this.bufferSource?(D$Q.now()-this._startTime)/1e3+this.startTime:0}),D$B(0,D$e,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),D$B(0,D$e,"volume",function(){return this._volume},function(D$s){this.isStopped||(this._volume=D$s,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(D$s,this.context.currentTime,.1):this.gain.gain.value=D$s)}),D$r._tryCleanFailed=!1,D$r}(),D$Bs=function(D$s){function D$r(){D$r.__super.call(this),this._w=0,this._h=0}D$h(D$r,"laya.resource.Bitmap",D$Zs);var D$e=D$r.prototype;return D$B(0,D$e,"width",function(){return this._w}),D$B(0,D$e,"height",function(){return this._h}),D$B(0,D$e,"source",function(){return this._source}),D$r}(),D$$s=function(D$r){function D$s(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,D$s.__super.call(this),this._interval=D$U.animationInterval,this._setUpNoticeType(1)}D$h(D$s,"laya.display.AnimationPlayerBase",D$r);var D$e=D$s.prototype;return D$e.play=function(D$s,D$r,D$e,D$U){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=!0),void 0===D$e&&(D$e=""),void 0===D$U&&(D$U=!0),this._isPlaying=!0,this.index="string"==typeof D$s?this._getFrameByLabel(D$s):D$s,this.loop=D$r,this._actionName=D$e,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},D$e._getFrameByLabel=function(D$s){var D$r=0;for(D$r=0;D$r<this._count;D$r++)if(this._labels[D$r]&&0<=this._labels[D$r].indexOf(D$s))return D$r;return 0},D$e._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},D$e._setControlNode=function(D$s){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=D$s)&&D$s!=this&&(D$s.on("display",this,this._checkResumePlaying),D$s.on("undisplay",this,this._checkResumePlaying))},D$e._setDisplay=function(D$s){D$r.prototype._setDisplay.call(this,D$s),this._checkResumePlaying()},D$e._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},D$e.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},D$e.addLabel=function(D$s,D$r){this._labels||(this._labels={}),this._labels[D$r]||(this._labels[D$r]=[]),this._labels[D$r].push(D$s)},D$e.removeLabel=function(D$s){if(D$s){if(this._labels)for(var D$r in this._labels)this._removeLabelFromLabelList(this._labels[D$r],D$s)}else this._labels=null},D$e._removeLabelFromLabelList=function(D$s,D$r){if(D$s)for(var D$e=D$s.length-1;0<=D$e;D$e--)D$s[D$e]==D$r&&D$s.splice(D$e,1)},D$e.gotoAndStop=function(D$s){this.index="string"==typeof D$s?this._getFrameByLabel(D$s):D$s,this.stop()},D$e._displayToIndex=function(D$s){},D$e.clear=function(){this.stop(),this._labels=null},D$B(0,D$e,"interval",function(){return this._interval},function(D$s){this._interval!=D$s&&(this._frameRateChanged=!0,this._interval=D$s,this._isPlaying&&0<D$s&&this.timerLoop(D$s,this,this._frameLoop,null,!0,!0))}),D$B(0,D$e,"isPlaying",function(){return this._isPlaying}),D$B(0,D$e,"index",function(){return this._index},function(D$s){if(this._index=D$s,this._displayToIndex(D$s),this._labels&&this._labels[D$s])for(var D$r=this._labels[D$s],D$e=0,D$U=D$r.length;D$e<D$U;D$e++)this.event("label",D$r[D$e])}),D$B(0,D$e,"count",function(){return this._count}),D$s.WRAP_POSITIVE=0,D$s.WRAP_REVERSE=1,D$s.WRAP_PINGPONG=2,D$s}(D$Hs),D$ls=function(D$r){function D$x(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,D$x.__super.call(this),this.overflow=D$x.VISIBLE,this._style=new D$rs(this),this._style.wordWrap=!1}D$h(D$x,"laya.display.Text",D$r);var D$s=D$x.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._lines=null,this._words&&(this._words.length=0,this._words=null)},D$s._getBoundPointsM=function(D$s){void 0===D$s&&(D$s=!1);var D$r=D$y.TEMP;return D$r.setTo(0,0,this.width,this.height),D$r._getBoundPoints()},D$s.getGraphicBounds=function(D$s){void 0===D$s&&(D$s=!1);var D$r=D$y.TEMP;return D$r.setTo(0,0,this.width,this.height),D$r},D$s._getCSSStyle=function(){return this._style},D$s.lang=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h){if(D$s=D$x.langPacks&&D$x.langPacks[D$s]?D$x.langPacks[D$s]:D$s,arguments.length<2)this._text=D$s;else{for(var D$H=0,D$A=arguments.length;D$H<D$A;D$H++)D$s=D$s.replace("{"+D$H+"}",arguments[D$H+1]);this._text=D$s}},D$s._isPassWordMode=function(){var D$s=this._style.password;return"prompt"in this&&this.prompt==this._text&&(D$s=!1),D$s},D$s._getPassWordTxt=function(D$s){var D$r;D$r="";for(var D$e=D$s.length;0<D$e;D$e--)D$r+="●";return D$r},D$s.renderText=function(D$s,D$r){var D$e=this.graphics;D$e.clear(!0);var D$U=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(D$Q.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);D$Q.context.font=D$U;var D$m=this.padding,D$k=D$m[3],D$j="left",D$T=this._lines,D$Y=this.leading+this._charSize.height,D$Z=this._currBitmapFont;D$Z&&(D$Y=this.leading+D$Z.getMaxHeight());var D$h=D$m[0];if(!D$Z&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(D$j="right",D$k=this._width-D$m[1]):"center"==this.align&&(D$j="center",D$k=.5*this._width+D$m[3]-D$m[1])),0<this._height){var D$H=this._textHeight>this._height?"top":this.valign;"middle"===D$H?D$h=.5*(this._height-D$r*D$Y)+D$m[0]-D$m[2]:"bottom"===D$H&&(D$h=this._height-D$r*D$Y-D$m[2])}var D$A=this._style;if(D$Z&&D$Z.autoScaleSize)var D$x=D$Z.fontSize/this.fontSize;if(this._clipPoint)if(D$e.save(),D$Z&&D$Z.autoScaleSize){var D$B=0,D$$=0;D$B=this._width?this._width-D$m[3]-D$m[1]:this._textWidth,D$$=this._height?this._height-D$m[0]-D$m[2]:this._textHeight,D$B*=D$x,D$$*=D$x,D$e.clipRect(D$m[3],D$m[0],D$B,D$$)}else D$e.clipRect(D$m[3],D$m[0],this._width?this._width-D$m[3]-D$m[1]:this._textWidth,this._height?this._height-D$m[0]-D$m[2]:this._textHeight);var D$l=D$A.password;"prompt"in this&&this.prompt==this._text&&(D$l=!1);for(var D$V=0,D$b=0,D$o=Math.min(this._lines.length,D$r+D$s)||1,D$I=D$s;D$I<D$o;D$I++){var D$w,D$X=D$T[D$I];if(D$l){var D$D=D$X.length;D$X="";for(var D$n=D$D;0<D$n;D$n--)D$X+="●"}if(D$V=D$k-(this._clipPoint?this._clipPoint.x:0),D$b=D$h+D$Y*D$I-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(D$j,D$V,D$b,D$I),D$Z){var D$y=this.width;D$Z.autoScaleSize&&(D$y=this.width*D$x),D$Z.drawText(D$X,this,D$V,D$b,this.align,D$y)}else D$c.isWebGL?(this._words||(this._words=[]),(D$w=this._words.length>D$I-D$s?this._words[D$I-D$s]:new D$F).setText(D$X)):D$w=D$X,D$A.stroke?D$e.fillBorderText(D$w,D$V,D$b,D$U,this.color,D$A.strokeColor,D$A.stroke,D$j):D$e.fillText(D$w,D$V,D$b,D$U,this.color,D$j)}if(D$Z&&D$Z.autoScaleSize){var D$g=1/D$x;this.scale(D$g,D$g)}this._clipPoint&&D$e.restore(),this._startX=D$k,this._startY=D$h},D$s.drawUnderline=function(D$s,D$r,D$e,D$U){var D$m=this._lineWidths[D$U];switch(D$s){case"center":D$r-=D$m/2;break;case"right":D$r-=D$m}D$e+=this._charSize.height,this._graphics.drawLine(D$r,D$e,D$r+D$m,D$e,this.underlineColor||this.color,1)},D$s.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);D$Q.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new D$n(0,0)):this._clipPoint=null;var D$s=this._lines.length;if(this.overflow!=D$x.VISIBLE){var D$r=this.overflow==D$x.HIDDEN?Math.floor:Math.ceil;D$s=Math.min(D$s,D$r((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var D$e=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(D$e,D$s),this.repaint()},D$s.evalTextSize=function(){var D$s,D$r=NaN;D$s=Math.max.apply(this,this._lineWidths),D$r=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],D$s==this._textWidth&&D$r==this._textHeight||(this._textWidth=D$s,this._textHeight=D$r,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},D$s.checkEnabledViewportOrNot=function(){return this.overflow==D$x.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},D$s.changeText=function(D$s){this._text!==D$s&&(this.lang(D$s+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},D$s.parseLines=function(D$s){var D$r=this.wordWrap||this.overflow==D$x.HIDDEN;if(D$r)var D$e=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var D$U=D$u.contextMeasureText(D$x._testWord);D$c.isConchApp&&0===D$U.width&&0===D$U.height&&(D$U=D$u.contextMeasureText("W")),this._charSize.width=D$U.width,this._charSize.height=D$U.height||this.fontSize}for(var D$m=D$s.replace(/\r\n/g,"\n").split("\n"),D$k=0,D$j=D$m.length;D$k<D$j;D$k++){var D$T=D$m[D$k];D$r?this.parseLine(D$T,D$e):(this._lineWidths.push(this.getTextWidth(D$T)),this._lines.push(D$T))}},D$s.parseLine=function(D$s,D$r){D$Q.context;var D$e,D$U=this._lines,D$m=0,D$k=NaN,D$j=NaN,D$T=0;if((D$k=this.getTextWidth(D$s))<=D$r)return D$U.push(D$s),void this._lineWidths.push(D$k);D$k=this._charSize.width,0==(D$m=Math.floor(D$r/D$k))&&(D$m=1),D$j=D$k=this.getTextWidth(D$s.substring(0,D$m));for(var D$Y=D$m,D$Z=D$s.length;D$Y<D$Z;D$Y++)if(D$r<(D$j+=D$k=this.getTextWidth(D$s.charAt(D$Y))))if(this.wordWrap){var D$h=D$s.substring(D$T,D$Y);if(D$h.charCodeAt(D$h.length-1)<255?(D$e=/(?:\w|-)+$/.exec(D$h))&&(D$Y=D$e.index+D$T,0==D$e.index?D$Y+=D$h.length:D$h=D$s.substring(D$T,D$Y)):D$x.RightToLeft&&(D$e=/([\u0600-\u06FF])+$/.exec(D$h))&&(D$Y=D$e.index+D$T,0==D$e.index?D$Y+=D$h.length:D$h=D$s.substring(D$T,D$Y)),D$U.push(D$h),this._lineWidths.push(D$j-D$k),!((D$T=D$Y)+D$m<D$Z)){D$U.push(D$s.substring(D$T,D$Z)),this._lineWidths.push(this.getTextWidth(D$U[D$U.length-1])),D$T=-1;break}D$Y+=D$m,D$j=D$k=this.getTextWidth(D$s.substring(D$T,D$Y)),D$Y--}else if(this.overflow==D$x.HIDDEN)return D$U.push(D$s.substring(0,D$Y)),void this._lineWidths.push(this.getTextWidth(D$U[D$U.length-1]));this.wordWrap&&-1!=D$T&&(D$U.push(D$s.substring(D$T,D$Z)),this._lineWidths.push(this.getTextWidth(D$U[D$U.length-1])))},D$s.getTextWidth=function(D$s){return this._currBitmapFont?this._currBitmapFont.getTextWidth(D$s):D$u.contextMeasureText(D$s).width},D$s.getWordWrapWidth=function(){var D$s=this.padding,D$r=NaN;return(D$r=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(D$r=this.wordWrap?100:D$Q.width),D$r<=0&&(D$r=100),D$r-D$s[3]-D$s[1]},D$s.getCharPoint=function(D$s,D$r){this._isChanged&&D$D.timer.runCallLater(this,this.typeset);for(var D$e=0,D$U=this._lines,D$m=0,D$k=0,D$j=D$U.length;D$k<D$j;D$k++){if(D$s<(D$e+=D$U[D$k].length)){var D$T=D$k;break}D$m=D$e}var D$Y=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;D$Q.context.font=D$Y;var D$Z=this.getTextWidth(this._text.substring(D$m,D$s));return(D$r||new D$n).setTo(this._startX+D$Z-(this._clipPoint?this._clipPoint.x:0),this._startY+D$T*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},D$B(0,D$s,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(D$s){D$s!=this._width&&(D$D.superSet(D$Hs,this,"width",D$s),this.isChanged=!0)}),D$B(0,D$s,"textWidth",function(){return this._isChanged&&D$D.timer.runCallLater(this,this.typeset),this._textWidth}),D$B(0,D$s,"height",function(){return this._height?this._height:this.textHeight},function(D$s){D$s!=this._height&&(D$D.superSet(D$Hs,this,"height",D$s),this.isChanged=!0)}),D$B(0,D$s,"textHeight",function(){return this._isChanged&&D$D.timer.runCallLater(this,this.typeset),this._textHeight}),D$B(0,D$s,"padding",function(){return this._getCSSStyle().padding},function(D$s){this._getCSSStyle().padding=D$s,this.isChanged=!0}),D$B(0,D$s,"bold",function(){return this._getCSSStyle().bold},function(D$s){this._getCSSStyle().bold=D$s,this.isChanged=!0}),D$B(0,D$s,"text",function(){return this._text||""},function(D$s){this._text!==D$s&&(this.lang(D$s+""),this.isChanged=!0,this.event("change"))}),D$B(0,D$s,"color",function(){return this._getCSSStyle().color},function(D$s){this._getCSSStyle().color!=D$s&&(this._getCSSStyle().color=D$s,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),D$B(0,D$s,"font",function(){return this._getCSSStyle().fontFamily},function(D$s){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),D$x._bitmapFonts&&D$x._bitmapFonts[D$s]&&(this._currBitmapFont=D$x._bitmapFonts[D$s]),this._getCSSStyle().fontFamily=D$s,this.isChanged=!0}),D$B(0,D$s,"fontSize",function(){return this._getCSSStyle().fontSize},function(D$s){this._getCSSStyle().fontSize=D$s,this.isChanged=!0}),D$B(0,D$s,"italic",function(){return this._getCSSStyle().italic},function(D$s){this._getCSSStyle().italic=D$s,this.isChanged=!0}),D$B(0,D$s,"align",function(){return this._getCSSStyle().align},function(D$s){this._getCSSStyle().align=D$s,this.isChanged=!0}),D$B(0,D$s,"valign",function(){return this._getCSSStyle().valign},function(D$s){this._getCSSStyle().valign=D$s,this.isChanged=!0}),D$B(0,D$s,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(D$s){this._getCSSStyle().wordWrap=D$s,this.isChanged=!0}),D$B(0,D$s,"leading",function(){return this._getCSSStyle().leading},function(D$s){this._getCSSStyle().leading=D$s,this.isChanged=!0}),D$B(0,D$s,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(D$s){this._getCSSStyle().backgroundColor=D$s,this.isChanged=!0}),D$B(0,D$s,"borderColor",function(){return this._getCSSStyle().borderColor},function(D$s){this._getCSSStyle().borderColor=D$s,this.isChanged=!0}),D$B(0,D$s,"stroke",function(){return this._getCSSStyle().stroke},function(D$s){this._getCSSStyle().stroke=D$s,this.isChanged=!0}),D$B(0,D$s,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(D$s){this._getCSSStyle().strokeColor=D$s,this.isChanged=!0}),D$B(0,D$s,"isChanged",null,function(D$s){this._isChanged!==D$s&&(this._isChanged=D$s)&&D$D.timer.callLater(this,this.typeset)}),D$B(0,D$s,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(D$s){if(!(this.overflow!=D$x.SCROLL||this.textWidth<this._width)&&this._clipPoint){D$s=D$s<this.padding[3]?this.padding[3]:D$s;var D$r=this._textWidth-this._width;D$s=D$r<D$s?D$r:D$s;var D$e=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=D$s,this.renderText(this._lastVisibleLineIndex,D$e)}}),D$B(0,D$s,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(D$s){if(!(this.overflow!=D$x.SCROLL||this.textHeight<this._height)&&this._clipPoint){D$s=D$s<this.padding[0]?this.padding[0]:D$s;var D$r=this._textHeight-this._height,D$e=(D$s=D$r<D$s?D$r:D$s)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=D$e;var D$U=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=D$s,this.renderText(D$e,D$U)}}),D$B(0,D$s,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),D$B(0,D$s,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),D$B(0,D$s,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),D$B(0,D$s,"underlineColor",function(){return this._underlineColor},function(D$s){this._underlineColor=D$s,this._isChanged=!0,this.typeset()}),D$x.registerBitmapFont=function(D$s,D$r){D$x._bitmapFonts||(D$x._bitmapFonts={}),D$x._bitmapFonts[D$s]=D$r},D$x.unregisterBitmapFont=function(D$s,D$r){if(void 0===D$r&&(D$r=!0),D$x._bitmapFonts&&D$x._bitmapFonts[D$s]){var D$e=D$x._bitmapFonts[D$s];D$r&&D$e.destroy(),delete D$x._bitmapFonts[D$s]}},D$x.setTextRightToLeft=function(){var D$s;(D$s=D$Q.canvas.source.style).display="none",D$s.position="absolute",D$s.direction="rtl",D$c._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,D$Q.document.body.appendChild(D$Q.canvas.source)},D$x.supportFont=function(D$s){D$Q.context.font="10px sans-serif";var D$r=D$u.contextMeasureText("abcji").width;D$Q.context.font="10px "+D$s;var D$e=D$u.contextMeasureText("abcji").width;return console.log(D$r,D$e),D$r!==D$e},D$x._testWord="游",D$x.langPacks=null,D$x.VISIBLE="visible",D$x.SCROLL="scroll",D$x.HIDDEN="hidden",D$x.CharacterCache=!0,D$x.RightToLeft=!1,D$x._bitmapFonts=null,D$Y(D$x,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),D$x}(D$Hs),D$Vs=function(D$H){function D$j(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",D$j.__super.call(this),this.offset=new D$n,this._canvasTransform=new D$O,this._previousOrientation=D$Q.window.orientation;var D$r=this;this.transform=D$O.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var D$s=D$Q.window,D$e=this;D$s.addEventListener("focus",function(){D$r._isFocused=!0,D$e.event("focus"),D$e.event("focuschange")}),D$s.addEventListener("blur",function(){D$r._isFocused=!1,D$e.event("blur"),D$e.event("focuschange"),D$e._isInputting()&&(D$ws.inputElement.target.focus=!1)});var D$U="visibilityState",D$m="visibilitychange",D$k=D$s.document;void 0!==D$k.hidden?(D$m="visibilitychange",D$U="visibilityState"):void 0!==D$k.mozHidden?(D$m="mozvisibilitychange",D$U="mozVisibilityState"):void 0!==D$k.msHidden?(D$m="msvisibilitychange",D$U="msVisibilityState"):void 0!==D$k.webkitHidden&&(D$m="webkitvisibilitychange",D$U="webkitVisibilityState"),D$s.document.addEventListener(D$m,function(){"hidden"==D$Q.document[D$U]?D$e._setStageVisible(!1):D$e._setStageVisible(!0)}),D$s.document.addEventListener("qbrowserVisibilityChange",function(D$s){D$e._setStageVisible(!D$s.hidden)}),D$s.addEventListener("resize",function(){var D$s=D$Q.window.orientation;null!=D$s&&D$s!=D$r._previousOrientation&&D$e._isInputting()&&(D$ws.inputElement.target.focus=!1),D$r._previousOrientation=D$s,D$e._isInputting()||D$e._resetCanvas()}),D$s.addEventListener("orientationchange",function(D$s){D$e._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),D$Q.onMobile&&this.on("mousedown",this,this._onmouseMove)}D$h(D$j,"laya.display.Stage",D$H);var D$s=D$j.prototype;return D$s._setStageVisible=function(D$s){this._isVisibility!=D$s&&(this._isVisibility=D$s,this._isVisibility||this._isInputting()&&(D$ws.inputElement.target.focus=!1),this.event("visibilitychange"))},D$s._isInputting=function(){return D$Q.onMobile&&D$ws.isInputting},D$s._changeCanvasSize=function(){this.setScreenSize(D$Q.clientWidth*D$Q.pixelRatio,D$Q.clientHeight*D$Q.pixelRatio)},D$s._resetCanvas=function(){if(this.screenAdaptationEnabled){var D$s=D$c._mainCanvas;D$s.source.style;D$s.size(1,1),D$D.timer.once(100,this,this._changeCanvasSize)}},D$s.setScreenSize=function(D$s,D$r){var D$e=!1;if("none"!==this._screenMode&&(D$e=(D$s/D$r<1?"vertical":"horizontal")!==this._screenMode)){var D$U=D$r;D$r=D$s,D$s=D$U}this.canvasRotation=D$e;var D$m=D$c._mainCanvas,D$k=D$m.source.style,D$j=this._canvasTransform.identity(),D$T=this._scaleMode,D$Y=D$s/this.designWidth,D$Z=D$r/this.designHeight,D$h=this.designWidth,D$H=this.designHeight,D$A=D$s,D$x=D$r,D$B=D$Q.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,D$T){case"noscale":D$Y=D$Z=1,D$A=this.designWidth,D$x=this.designHeight;break;case"showall":D$Y=D$Z=Math.min(D$Y,D$Z),D$h=D$A=Math.round(this.designWidth*D$Y),D$H=D$x=Math.round(this.designHeight*D$Z);break;case"noborder":D$Y=D$Z=Math.max(D$Y,D$Z),D$A=Math.round(this.designWidth*D$Y),D$x=Math.round(this.designHeight*D$Z);break;case"full":D$Y=D$Z=1,this._width=D$h=D$s,this._height=D$H=D$r;break;case"fixedwidth":D$Z=D$Y,this._height=D$H=Math.round(D$r/D$Y);break;case"fixedheight":D$Y=D$Z,this._width=D$h=Math.round(D$s/D$Z);break;case"fixedauto":D$s/D$r<this.designWidth/this.designHeight?(D$Z=D$Y,this._height=D$H=Math.round(D$r/D$Y)):(D$Y=D$Z,this._width=D$h=Math.round(D$s/D$Z))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,D$h=D$h+1&2147483646,D$H=D$H+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),D$Y*=this.scaleX,D$Z*=this.scaleY,1===D$Y&&1===D$Z?this.transform.identity():(this.transform.a=this._formatData(D$Y/(D$A/D$h)),this.transform.d=this._formatData(D$Z/(D$x/D$H)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),D$m.size(D$h,D$H),D$P.changeWebGLSize(D$h,D$H),D$j.scale(D$A/D$h/D$B,D$x/D$H/D$B),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(D$s-D$A)/D$B:this.offset.x=.5*(D$s-D$A)/D$B,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(D$r-D$x)/D$B:this.offset.y=.5*(D$r-D$x)/D$B,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),D$j.translate(this.offset.x,this.offset.y),this.canvasDegree=0,D$e&&("horizontal"===this._screenMode?(D$j.rotate(Math.PI/2),D$j.translate(D$r/D$B,0),this.canvasDegree=90):(D$j.rotate(-Math.PI/2),D$j.translate(0,D$s/D$B),this.canvasDegree=-90)),D$j.a=this._formatData(D$j.a),D$j.d=this._formatData(D$j.d),D$j.tx=this._formatData(D$j.tx),D$j.ty=this._formatData(D$j.ty),D$k.transformOrigin=D$k.webkitTransformOrigin=D$k.msTransformOrigin=D$k.mozTransformOrigin=D$k.oTransformOrigin="0px 0px 0px",D$k.transform=D$k.webkitTransform=D$k.msTransform=D$k.mozTransform=D$k.oTransform="matrix("+D$j.toString()+")",D$j.translate(parseInt(D$k.left)||0,parseInt(D$k.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},D$s._formatData=function(D$s){return Math.abs(D$s)<1e-6?0:Math.abs(1-D$s)<.001?0<D$s?1:-1:D$s},D$s.getMousePoint=function(){return D$n.TEMP.setTo(this.mouseX,this.mouseY)},D$s.repaint=function(){this._repaint=1},D$s.parentRepaint=function(){},D$s._loop=function(){return this.render(D$c.context,0,0),!0},D$s._onmouseMove=function(D$s){this._mouseMoveTime=D$Q.now()},D$s.getTimeFromFrameStart=function(){return D$Q.now()-this._frameStartTime},D$s.render=function(D$s,D$r,D$e){if("sleep"===this._frameRate&&!D$c.isConchApp){var D$U=D$Q.now();if(!(1e3<=D$U-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(D$t.loopCount++,D$$.instance.runEvent(),D$D.timer._update()));this._frameStartTime=D$U}if(this._renderCount++,D$c.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=D$Q.now();var D$m="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),D$k=this._renderCount%2==0;if(D$t.renderSlow=!D$m,D$m||D$k||D$c.isConchApp){var D$j;D$t.loopCount++,D$$.instance.runEvent(),D$D.timer._update(),D$P.update3DLoop();var D$T=0,D$Y=0;if(D$c.isConchNode)for(D$T=0,D$Y=this._scenes.length;D$T<D$Y;D$T++)(D$j=this._scenes[D$T])&&D$j._updateSceneConch();else for(D$T=0,D$Y=this._scenes.length;D$T<D$Y;D$T++)(D$j=this._scenes[D$T])&&D$j._updateScene();if(D$c.isConchNode){var D$Z=D$Hs.CustomList;for(D$T=0,D$Y=D$Z.length;D$T<D$Y;D$T++){var D$h=D$Z[D$T];D$h.customRender(D$h.customContext,0,0)}return}}D$c.isConchNode||this.renderingEnabled&&(D$m||!D$k||D$c.isConchWebGL)&&(D$c.isWebGL?D$c.WebGL.mainContext&&!D$c.WebGL.mainContext.isContextLost()&&(D$s.clear(),D$H.prototype.render.call(this,D$s,D$r,D$e),D$t._show&&D$t._sp&&D$t._sp.render(D$s,D$r,D$e),D$P.clear(this._bgColor),D$P.beginFlush(),D$s.flush(),D$P.endFinish(),D$M.instance&&D$M.getInstance().endDispose()):(D$P.clear(this._bgColor),D$H.prototype.render.call(this,D$s,D$r,D$e),D$t._show&&D$t._sp&&D$t._sp.render(D$s,D$r,D$e)))}else this._renderCount%5==0&&(D$t.loopCount++,D$$.instance.runEvent(),D$D.timer._update())},D$s._requestFullscreen=function(){var D$s=D$Q.document.documentElement;D$s.requestFullscreen?D$s.requestFullscreen():D$s.mozRequestFullScreen?D$s.mozRequestFullScreen():D$s.webkitRequestFullscreen?D$s.webkitRequestFullscreen():D$s.msRequestFullscreen&&D$s.msRequestFullscreen()},D$s._fullScreenChanged=function(){D$D.stage.event("fullscreenchange")},D$s.exitFullscreen=function(){var D$s=D$Q.document;D$s.exitFullscreen?D$s.exitFullscreen():D$s.mozCancelFullScreen?D$s.mozCancelFullScreen():D$s.webkitExitFullscreen&&D$s.webkitExitFullscreen()},D$B(0,D$s,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),D$B(0,D$s,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),D$B(0,D$s,"frameRate",function(){return this._frameRate},function(D$s){if(this._frameRate=D$s,D$c.isConchApp)switch(this._frameRate){case"slow":D$Q.window.conch&&D$Q.window.conchConfig.setSlowFrame&&D$Q.window.conchConfig.setSlowFrame(!0);break;case"fast":D$Q.window.conch&&D$Q.window.conchConfig.setSlowFrame&&D$Q.window.conchConfig.setSlowFrame(!1);break;case"mouse":D$Q.window.conch&&D$Q.window.conchConfig.setMouseFrame&&D$Q.window.conchConfig.setMouseFrame(2e3);break;case"sleep":D$Q.window.conch&&D$Q.window.conchConfig.setLimitFPS&&D$Q.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),D$B(0,D$s,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),D$B(0,D$s,"width",D$H.prototype._$get_width,function(D$s){this.designWidth=D$s,D$D.superSet(D$Hs,this,"width",D$s),D$D.timer.callLater(this,this._changeCanvasSize)}),D$B(0,D$s,"alignH",function(){return this._alignH},function(D$s){this._alignH=D$s,D$D.timer.callLater(this,this._changeCanvasSize)}),D$B(0,D$s,"isFocused",function(){return this._isFocused}),D$B(0,D$s,"height",D$H.prototype._$get_height,function(D$s){this.designHeight=D$s,D$D.superSet(D$Hs,this,"height",D$s),D$D.timer.callLater(this,this._changeCanvasSize)}),D$B(0,D$s,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||D$O.create()},D$H.prototype._$set_transform),D$B(0,D$s,"isVisibility",function(){return this._isVisibility}),D$B(0,D$s,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),D$B(0,D$s,"scaleMode",function(){return this._scaleMode},function(D$s){this._scaleMode=D$s,D$D.timer.callLater(this,this._changeCanvasSize)}),D$B(0,D$s,"alignV",function(){return this._alignV},function(D$s){this._alignV=D$s,D$D.timer.callLater(this,this._changeCanvasSize)}),D$B(0,D$s,"bgColor",function(){return this._bgColor},function(D$s){this._bgColor=D$s,this.conchModel&&this.conchModel.bgColor(D$s),D$c.isWebGL&&(D$s?D$j._wgColor=D$p.create(D$s)._color:D$Q.onMiniGame||(D$j._wgColor=null)),D$Q.onLimixiu?D$j._wgColor=D$p.create(D$s)._color:D$c.canvas.style.background=D$s||"none"}),D$B(0,D$s,"mouseX",function(){return Math.round(D$$.instance.mouseX/this.clientScaleX)}),D$B(0,D$s,"mouseY",function(){return Math.round(D$$.instance.mouseY/this.clientScaleY)}),D$B(0,D$s,"screenMode",function(){return this._screenMode},function(D$s){this._screenMode=D$s}),D$B(0,D$s,"visible",D$H.prototype._$get_visible,function(D$s){this.visible!==D$s&&(D$D.superSet(D$Hs,this,"visible",D$s),D$c._mainCanvas.source.style.visibility=D$s?"visible":"hidden")}),D$B(0,D$s,"fullScreenEnabled",null,function(D$s){var D$r=D$Q.document,D$e=D$c.canvas;D$s?(D$e.addEventListener("mousedown",this._requestFullscreen),D$e.addEventListener("touchstart",this._requestFullscreen),D$r.addEventListener("fullscreenchange",this._fullScreenChanged),D$r.addEventListener("mozfullscreenchange",this._fullScreenChanged),D$r.addEventListener("webkitfullscreenchange",this._fullScreenChanged),D$r.addEventListener("msfullscreenchange",this._fullScreenChanged)):(D$e.removeEventListener("mousedown",this._requestFullscreen),D$e.removeEventListener("touchstart",this._requestFullscreen),D$r.removeEventListener("fullscreenchange",this._fullScreenChanged),D$r.removeEventListener("mozfullscreenchange",this._fullScreenChanged),D$r.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),D$r.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),D$j.SCALE_NOSCALE="noscale",D$j.SCALE_EXACTFIT="exactfit",D$j.SCALE_SHOWALL="showall",D$j.SCALE_NOBORDER="noborder",D$j.SCALE_FULL="full",D$j.SCALE_FIXED_WIDTH="fixedwidth",D$j.SCALE_FIXED_HEIGHT="fixedheight",D$j.SCALE_FIXED_AUTO="fixedauto",D$j.ALIGN_LEFT="left",D$j.ALIGN_RIGHT="right",D$j.ALIGN_CENTER="center",D$j.ALIGN_TOP="top",D$j.ALIGN_MIDDLE="middle",D$j.ALIGN_BOTTOM="bottom",D$j.SCREEN_NONE="none",D$j.SCREEN_HORIZONTAL="horizontal",D$j.SCREEN_VERTICAL="vertical",D$j.FRAME_FAST="fast",D$j.FRAME_SLOW="slow",D$j.FRAME_MOUSE="mouse",D$j.FRAME_SLEEP="sleep",D$j.FRAME_MOUSE_THREDHOLD=2e3,D$Y(D$j,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),D$j}(D$Hs),D$bs=(function(D$s){function D$r(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,D$r.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}D$h(D$r,"laya.media.SoundNode",D$Hs);var D$e=D$r.prototype;D$e._onParentChange=function(){this.target=this.parent},D$e.play=function(D$s,D$r){void 0===D$s&&(D$s=1),isNaN(D$s)&&(D$s=1),this.url&&(this.stop(),this._channel=D$J.playSound(this.url,D$s,null,D$r))},D$e.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},D$e._setPlayAction=function(D$s,D$r,D$e,D$U){void 0===D$U&&(D$U=!0),this[D$e]&&D$s&&(D$U?D$s.on(D$r,this,this[D$e]):D$s.off(D$r,this,this[D$e]))},D$e._setPlayActions=function(D$s,D$r,D$e,D$U){if(void 0===D$U&&(D$U=!0),D$s&&D$r){var D$m,D$k=D$r.split(","),D$j=0;for(D$m=D$k.length,D$j=0;D$j<D$m;D$j++)this._setPlayAction(D$s,D$k[D$j],D$e,D$U)}},D$B(0,D$e,"playEvent",null,function(D$s){(this._playEvents=D$s)&&this._tar&&this._setPlayActions(this._tar,D$s,"play")}),D$B(0,D$e,"target",null,function(D$s){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=D$s,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),D$B(0,D$e,"stopEvent",null,function(D$s){(this._stopEvents=D$s)&&this._tar&&this._setPlayActions(this._tar,D$s,"stop")})}(),function(D$s){function D$r(){this._src=null,this._onload=null,this._onerror=null,D$r.__super.call(this)}D$h(D$r,"laya.resource.FileBitmap",D$Bs);var D$e=D$r.prototype;return D$B(0,D$e,"src",function(){return this._src},function(D$s){this._src=D$s}),D$B(0,D$e,"onload",null,function(D$s){}),D$B(0,D$e,"onerror",null,function(D$s){}),D$r}()),D$os=function(D$s){function D$e(D$s,D$r){this._is2D=!1,D$e.__super.call(this);var D$U=this;if(this._source=this,"2D"===D$s||"AUTO"===D$s&&!D$c.isWebGL){this._is2D=!0,this._source=D$r||D$Q.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var D$m=this;D$m.getContext=function(D$s,D$r){if(D$U._ctx)return D$U._ctx;var D$e=D$U._ctx=D$U._source.getContext(D$s,D$r);return D$e&&(D$e._canvas=D$m,D$c.isFlash||D$Q.onLimixiu||(D$e.size=function(D$s,D$r){})),D$e}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}D$h(D$e,"laya.resource.HTMLCanvas",D$Bs);var D$r=D$e.prototype;return D$r.clear=function(){this._ctx&&this._ctx.clear()},D$r.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},D$r.release=function(){},D$r._setContext=function(D$s){this._ctx=D$s},D$r.getContext=function(D$s,D$r){return this._ctx?this._ctx:this._ctx=D$e._createContext(this)},D$r.getMemSize=function(){return 0},D$r.size=function(D$s,D$r){(this._w!=D$s||this._h!=D$r||this._source&&(this._source.width!=D$s||this._source.height!=D$r))&&(this._w=D$s,this._h=D$r,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(D$s,D$r),this._source&&(this._source.height=D$r,this._source.width=D$s))},D$r.getCanvas=function(){return this._source},D$r.toBase64=function(D$s,D$r,D$e){if(this._source)if(D$c.isConchApp&&this._source.toBase64)this._source.toBase64(D$s,D$r,D$e);else{var D$U=this._source.toDataURL(D$s,D$r);D$e.call(this,D$U)}},D$B(0,D$r,"context",function(){return this._ctx}),D$B(0,D$r,"asBitmap",null,function(D$s){}),D$e.create=function(D$s,D$r){return new D$e(D$s,D$r)},D$e.TYPE2D="2D",D$e.TYPE3D="3D",D$e.TYPEAUTO="AUTO",D$e._createContext=null,D$e}(),D$Is=(function(D$s){function D$Y(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){throw D$Y.__super.call(this),new Error("不允许new！")}D$h(D$Y,"laya.resource.HTMLSubImage",D$Bs),D$Y.create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){return void 0===D$T&&(D$T=!1),new D$Y(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T)}}(),function(D$s){function D$H(){this._frames=null,this._url=null,D$H.__super.call(this),this._setControlNode(this)}D$h(D$H,"laya.display.Animation",D$s);var D$r=D$H.prototype;D$r.destroy=function(D$s){void 0===D$s&&(D$s=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,D$s),this._frames=null,this._labels=null},D$r.play=function(D$s,D$r,D$e,D$U){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=!0),void 0===D$e&&(D$e=""),void 0===D$U&&(D$U=!0),D$e&&this._setFramesFromCache(D$e,D$U),this._isPlaying=!0,this.index="string"==typeof D$s?this._getFrameByLabel(D$s):D$s,this.loop=D$r,this._actionName=D$e,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},D$r._setFramesFromCache=function(D$s,D$r){var D$e;return void 0===D$r&&(D$r=!1),this._url&&(D$s=this._url+"#"+D$s),D$s&&D$H.framesMap[D$s]?((D$e=D$H.framesMap[D$s])instanceof Array?(this._frames=D$H.framesMap[D$s],this._count=this._frames.length):(D$e.nodeRoot&&(D$H.framesMap[D$s]=this._parseGraphicAnimationByData(D$e),D$e=D$H.framesMap[D$s]),this._frames=D$e.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=D$e.interval),this._labels=this._copyLabels(D$e.labels)),!0):(D$r&&console.log("ani not found:",D$s),!1)},D$r._copyLabels=function(D$s){if(!D$s)return null;var D$r,D$e;for(D$e in D$r={},D$s)D$r[D$e]=D$u.copyArray([],D$s[D$e]);return D$r},D$r._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&D$s.prototype._frameLoop.call(this)},D$r._displayToIndex=function(D$s){this._frames&&(this.graphics=this._frames[D$s])},D$r.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},D$r.loadImages=function(D$s,D$r){return void 0===D$r&&(D$r=""),this._url="",this._setFramesFromCache(D$r)||(this.frames=D$H.framesMap[D$r]?D$H.framesMap[D$r]:D$H.createFrames(D$s,D$r)),this},D$r.loadAtlas=function(D$r,D$e,D$U){void 0===D$U&&(D$U=""),this._url="";var D$m=this;function D$s(D$s){D$r===D$s&&(D$m.frames=D$H.framesMap[D$U]?D$H.framesMap[D$U]:D$H.createFrames(D$r,D$U),D$e&&D$e.run())}return D$m._setFramesFromCache(D$U)||(D$Ts.getAtlas(D$r)?D$s(D$r):D$D.loader.load(D$r,D$b.create(null,D$s,[D$r]),null,"atlas")),this},D$r.loadAnimation=function(D$s,D$r,D$e){this._url=D$s;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,D$r&&D$r.run()):!D$e||D$Ts.getAtlas(D$e)?this._loadAnimationData(D$s,D$r,D$e):D$D.loader.load(D$e,D$b.create(this,this._loadAnimationData,[D$s,D$r,D$e]),null,"atlas"),this},D$r._loadAnimationData=function(D$T,D$Y,D$s){var D$Z=this;if(!D$s||D$Ts.getAtlas(D$s)){var D$h=this;D$Ts.getRes(D$T)?D$r(D$T):D$D.loader.load(D$T,D$b.create(null,D$r,[D$T]),null,"json"),D$Ts.clearRes(D$T)}else console.warn("atlas load fail:"+D$s);function D$r(D$s){if(D$Ts.getRes(D$s)&&D$T===D$s){var D$r;if(D$H.framesMap[D$T+"#"])D$h._setFramesFromCache(D$Z._actionName,!0),D$Z.index=0,D$Z._checkResumePlaying();else{var D$e=D$h._parseGraphicAnimation(D$Ts.getRes(D$T));if(!D$e)return;var D$U,D$m=D$e.animationList,D$k=0,D$j=D$m.length;for(D$k=0;D$k<D$j;D$k++)D$r=D$m[D$k],D$H.framesMap[D$T+"#"+D$r.name]=D$r,D$U||(D$U=D$r);D$U&&(D$H.framesMap[D$T+"#"]=D$U,D$h._setFramesFromCache(D$Z._actionName,!0),D$Z.index=0),D$Z._checkResumePlaying()}D$Y&&D$Y.run()}}},D$r._parseGraphicAnimation=function(D$s){return D$Ds.parseAnimationData(D$s)},D$r._parseGraphicAnimationByData=function(D$s){return D$Ds.parseAnimationByData(D$s)},D$B(0,D$r,"frames",function(){return this._frames},function(D$s){(this._frames=D$s)&&(this._count=D$s.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),D$B(0,D$r,"autoPlay",null,function(D$s){D$s?this.play():this.stop()}),D$B(0,D$r,"source",null,function(D$s){-1<D$s.indexOf(".ani")?this.loadAnimation(D$s):-1<D$s.indexOf(".json")||-1<D$s.indexOf("als")||-1<D$s.indexOf("atlas")?this.loadAtlas(D$s):this.loadImages(D$s.split(","))}),D$B(0,D$r,"autoAnimation",null,function(D$s){this.play(0,!0,D$s,!1)}),D$H.createFrames=function(D$s,D$r){var D$e,D$U,D$m=0,D$k=0;if("string"==typeof D$s){var D$j=D$Ts.getAtlas(D$s);if(D$j&&D$j.length)for(D$e=[],D$m=0,D$k=D$j.length;D$m<D$k;D$m++)(D$U=new D$P.createGraphics).drawTexture(D$Ts.getRes(D$j[D$m]),0,0),D$e.push(D$U)}else if(D$s instanceof Array)for(D$e=[],D$m=0,D$k=D$s.length;D$m<D$k;D$m++)(D$U=new D$P.createGraphics).loadImage(D$s[D$m],0,0),D$e.push(D$U);return D$r&&(D$H.framesMap[D$r]=D$e),D$e},D$H.clearCache=function(D$s){var D$r,D$e=D$H.framesMap,D$U=D$s+"#";for(D$r in D$e)D$r!==D$s&&0!=D$r.indexOf(D$U)||delete D$H.framesMap[D$r]},D$H.framesMap={}}(D$$s),function(D$s){function D$k(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,D$k.__super.call(this),null==D$k._sortIndexFun&&(D$k._sortIndexFun=D$X.sortByKey("index",!1,!0))}D$h(D$k,"laya.display.FrameAnimation",D$s);var D$r=D$k.prototype;return D$r._setUp=function(D$s,D$r){this._labels=null,this._animationNewFrames=null,this._targetDic=D$s,this._animationData=D$r,this.interval=1e3/D$r.frameRate,D$r.parsed?(this._count=D$r.count,this._labels=D$r.labels,this._animationNewFrames=D$r.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),D$r.parsed=!0,D$r.labels=this._labels,D$r.count=this._count,D$r.animationNewFrames=this._animationNewFrames},D$r.clear=function(){D$s.prototype.clear.call(this),this._targetDic=null,this._animationData=null},D$r._displayToIndex=function(D$s){if(this._animationData){D$s<0&&(D$s=0),D$s>this._count&&(D$s=this._count);var D$r=this._animationData.nodes,D$e=0,D$U=D$r.length;for(D$e=0;D$e<D$U;D$e++)this._displayNodeToFrame(D$r[D$e],D$s)}},D$r._displayNodeToFrame=function(D$s,D$r,D$e){D$e||(D$e=this._targetDic);var D$U=D$e[D$s.target];if(D$U){var D$m,D$k,D$j,D$T=D$s.frames,D$Y=D$s.keys,D$Z=0,D$h=D$Y.length;for(D$Z=0;D$Z<D$h;D$Z++)D$j=(D$k=D$T[D$m=D$Y[D$Z]]).length>D$r?D$k[D$r]:D$k[D$k.length-1],D$U[D$m]=D$j}},D$r._calculateDatas=function(){if(this._animationData){var D$s,D$r=this._animationData.nodes,D$e=0,D$U=D$r.length;for(D$e=this._count=0;D$e<D$U;D$e++)D$s=D$r[D$e],this._calculateNodeKeyFrames(D$s);this._count+=1}},D$r._calculateNodeKeyFrames=function(D$s){var D$r,D$e,D$U=D$s.keyframes,D$m=D$s.target;for(D$r in D$s.frames||(D$s.frames={}),D$s.keys?D$s.keys.length=0:D$s.keys=[],D$s.initValues||(D$s.initValues={}),D$U)D$e=D$U[D$r],D$s.frames[D$r]||(D$s.frames[D$r]=[]),this._targetDic&&this._targetDic[D$m]&&(D$s.initValues[D$r]=this._targetDic[D$m][D$r]),D$e.sort(D$k._sortIndexFun),D$s.keys.push(D$r),this._calculateNodePropFrames(D$e,D$s.frames[D$r],D$r,D$m)},D$r.resetToInitState=function(){if(this._targetDic&&this._animationData){var D$s,D$r,D$e=this._animationData.nodes,D$U=0,D$m=D$e.length;for(D$U=0;D$U<D$m;D$U++)if(D$r=(D$s=D$e[D$U]).initValues){var D$k,D$j=this._targetDic[D$s.target];if(D$j)for(D$k in D$r)D$j[D$k]=D$r[D$k]}}},D$r._calculateNodePropFrames=function(D$s,D$r,D$e,D$U){var D$m=0,D$k=D$s.length-1;if(0<D$k){for(D$r.length=D$s[D$k].index+1,D$m=0;D$m<D$k;D$m++)this._dealKeyFrame(D$s[D$m]),this._calculateFrameValues(D$s[D$m],D$s[D$m+1],D$r);this._dealKeyFrame(D$s[D$m])}0==D$k&&(D$r[D$s[0].index]=D$s[0].value,this._animationNewFrames&&(this._animationNewFrames[D$s[0].index]=!0))},D$r._dealKeyFrame=function(D$s){D$s.label&&""!=D$s.label&&this.addLabel(D$s.label,D$s.index)},D$r._calculateFrameValues=function(D$s,D$r,D$e){var D$U,D$m=0,D$k=D$s.index,D$j=D$r.index,D$T=D$s.value,D$Y=D$r.value-D$s.value,D$Z=D$j-D$k;if(D$j>this._count&&(this._count=D$j),D$s.tween)for(null==(D$U=D$q[D$s.tweenMethod])&&(D$U=D$q.linearNone),D$m=D$k;D$m<D$j;D$m++)D$e[D$m]=D$U(D$m-D$k,D$T,D$Y,D$Z),this._animationNewFrames&&(this._animationNewFrames[D$m]=!0);else for(D$m=D$k;D$m<D$j;D$m++)D$e[D$m]=D$T;this._animationNewFrames&&(this._animationNewFrames[D$s.index]=!0,this._animationNewFrames[D$r.index]=!0),D$e[D$r.index]=D$r.value},D$k._sortIndexFun=null,D$k}(D$$s)),D$ws=function(D$r){function D$m(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",D$m.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=D$ls.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}D$h(D$m,"laya.display.Input",D$r);var D$s=D$m.prototype;return D$s.setSelection=function(D$s,D$r){this.focus=!0,laya.display.Input.inputElement.selectionStart=D$s,laya.display.Input.inputElement.selectionEnd=D$r},D$s._onUnDisplay=function(D$s){this.focus=!1},D$s._onMouseDown=function(D$s){this.focus=!0},D$s._syncInputTransform=function(){var D$s=this.nativeInput,D$r=D$u.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),D$e=this._width-this.padding[1]-this.padding[3],D$U=this._height-this.padding[0]-this.padding[2];D$c.isConchApp?(D$s.setScale(D$r.scaleX,D$r.scaleY),D$s.setSize(D$e,D$U),D$s.setPos(D$r.x,D$r.y)):(D$m.inputContainer.style.transform=D$m.inputContainer.style.webkitTransform="scale("+D$r.scaleX+","+D$r.scaleY+") rotate("+D$D.stage.canvasDegree+"deg)",D$s.style.width=D$e+"px",D$s.style.height=D$U+"px",D$m.inputContainer.style.left=D$r.x+"px",D$m.inputContainer.style.top=D$r.y+"px")},D$s.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},D$s._setInputMethod=function(){D$m.input.parentElement&&D$m.inputContainer.removeChild(D$m.input),D$m.area.parentElement&&D$m.inputContainer.removeChild(D$m.area),D$m.inputElement=this._multiline?D$m.area:D$m.input,D$m.inputContainer.appendChild(D$m.inputElement),D$ls.RightToLeft&&(D$m.inputElement.style.direction="rtl")},D$s._focusIn=function(){laya.display.Input.isInputting=!0;var D$s=this.nativeInput;this._focus=!0;var D$r=D$s.style;D$r.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),D$s.readOnly=!this._editable,D$c.isConchApp&&(D$s.setType(this._type),D$s.setForbidEdit(!this._editable)),D$s.maxLength=this._maxChars;this.padding;if(D$s.type=this._type,D$s.value=this._content,D$s.placeholder=this._prompt,D$D.stage.off("keydown",this,this._onKeyDown),D$D.stage.on("keydown",this,this._onKeyDown),(D$D.stage.focus=this).event("focus"),D$Q.onPC&&D$s.focus(),!D$Q.onMiniGame){this._text;this._text=null}this.typeset(),D$s.setColor(this._originColor),D$s.setFontSize(this.fontSize),D$s.setFontFace(D$Q.onIPhone&&D$ls._fontFamilyMap[this.font]||this.font),D$c.isConchApp&&D$s.setMultiAble&&D$s.setMultiAble(this._multiline),D$r.lineHeight=this.leading+this.fontSize+"px",D$r.fontStyle=this.italic?"italic":"normal",D$r.fontWeight=this.bold?"bold":"normal",D$r.textAlign=this.align,D$r.padding="0 0",this._syncInputTransform(),!D$c.isConchApp&&D$Q.onPC&&D$D.timer.frameLoop(1,this,this._syncInputTransform)},D$s._setPromptColor=function(){(D$m.promptStyleDOM=D$Q.getElementById("promptStyle"))||((D$m.promptStyleDOM=D$Q.createElement("style")).setAttribute("id","promptStyle"),D$Q.document.head.appendChild(D$m.promptStyleDOM)),D$m.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},D$s._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(D$D.superSet(D$ls,this,"text",this._content),D$D.superSet(D$ls,this,"color",this._originColor)):(D$D.superSet(D$ls,this,"text",this._prompt),D$D.superSet(D$ls,this,"color",this._promptColor)),D$D.stage.off("keydown",this,this._onKeyDown),D$D.stage.focus=null,this.event("blur"),D$c.isConchApp&&this.nativeInput.blur(),D$Q.onPC&&D$D.timer.clear(this,this._syncInputTransform)},D$s._onKeyDown=function(D$s){13===D$s.keyCode&&(D$Q.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},D$s.changeText=function(D$s){this._content=D$s,this._focus?(this.nativeInput.value=D$s||"",this.event("change")):D$r.prototype.changeText.call(this,D$s)},D$B(0,D$s,"color",D$r.prototype._$get_color,function(D$s){this._focus&&this.nativeInput.setColor(D$s),D$D.superSet(D$ls,this,"color",this._content?D$s:this._promptColor),this._originColor=D$s}),D$B(0,D$s,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(D$s){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),D$B(0,D$s,"multiline",function(){return this._multiline},function(D$s){this._multiline=D$s,this.valign=D$s?"top":"middle"}),D$B(0,D$s,"maxChars",function(){return this._maxChars},function(D$s){D$s<=0&&(D$s=1e5),this._maxChars=D$s}),D$B(0,D$s,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(D$s){D$D.superSet(D$ls,this,"color",this._originColor),D$s+="",this._focus?(this.nativeInput.value=D$s||"",this.event("change")):(this._multiline||(D$s=D$s.replace(/\r?\n/g,"")),(this._content=D$s)?D$D.superSet(D$ls,this,"text",D$s):(D$D.superSet(D$ls,this,"text",this._prompt),D$D.superSet(D$ls,this,"color",this.promptColor)))}),D$B(0,D$s,"nativeInput",function(){return this._multiline?D$m.area:D$m.input}),D$B(0,D$s,"prompt",function(){return this._prompt},function(D$s){!this._text&&D$s&&D$D.superSet(D$ls,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?D$D.superSet(D$ls,this,"text",this._text==this._prompt?D$s:this._text):D$D.superSet(D$ls,this,"text",D$s),this._prompt=D$ls.langPacks&&D$ls.langPacks[D$s]?D$ls.langPacks[D$s]:D$s}),D$B(0,D$s,"focus",function(){return this._focus},function(D$s){var D$r=this.nativeInput;this._focus!==D$s&&(D$s?(D$r.target?D$r.target._focusOut():this._setInputMethod(),(D$r.target=this)._focusIn()):(D$r.target=null,this._focusOut(),D$Q.document.body.scrollTop=0,D$r.blur(),D$c.isConchApp?D$r.setPos(-1e4,-1e4):D$m.inputContainer.contains(D$r)&&D$m.inputContainer.removeChild(D$r)))}),D$B(0,D$s,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(D$s){D$s?(-1<(D$s="[^"+D$s+"]").indexOf("^^")&&(D$s=D$s.replace("^^","")),this._restrictPattern=new RegExp(D$s,"g")):this._restrictPattern=null}),D$B(0,D$s,"editable",function(){return this._editable},function(D$s){this._editable=D$s,D$c.isConchApp&&D$m.input.setForbidEdit(!D$s)}),D$B(0,D$s,"promptColor",function(){return this._promptColor},function(D$s){this._promptColor=D$s,this._content||D$D.superSet(D$ls,this,"color",D$s)}),D$B(0,D$s,"type",function(){return this._type},function(D$s){this._getCSSStyle().password="password"==D$s,this._type=D$s,D$c.isConchApp&&this.nativeInput.setType(D$s)}),D$B(0,D$s,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(D$s){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),D$B(0,D$s,"asPassword",function(){return this._getCSSStyle().password},function(D$s){this._getCSSStyle().password=D$s,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),D$m.__init__=function(){D$m._createInputElement(),D$Q.onMobile&&D$c.canvas.addEventListener(D$m.IOS_IFRAME?D$Q.onMiniGame?"touchend":"click":"touchend",D$m._popupInputMethod)},D$m._popupInputMethod=function(D$s){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},D$m._createInputElement=function(){D$m._initInput(D$m.area=D$Q.createElement("textarea")),D$m._initInput(D$m.input=D$Q.createElement("input")),(D$m.inputContainer=D$Q.createElement("div")).style.position="absolute",D$m.inputContainer.style.zIndex=1e5,D$Q.container.appendChild(D$m.inputContainer),D$m.inputContainer.setPos=function(D$s,D$r){D$m.inputContainer.style.left=D$s+"px",D$m.inputContainer.style.top=D$r+"px"}},D$m._initInput=function(D$r){var D$s=D$r.style;D$s.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",D$s.resize="none",D$s.backgroundColor="transparent",D$s.border="none",D$s.outline="none",D$s.zIndex=1,D$r.addEventListener("input",D$m._processInputting),D$r.addEventListener("mousemove",D$m._stopEvent),D$r.addEventListener("mousedown",D$m._stopEvent),D$r.addEventListener("touchmove",D$m._stopEvent),D$r.setFontFace=function(D$s){D$r.style.fontFamily=D$s},D$c.isConchApp||(D$r.setColor=function(D$s){D$r.style.color=D$s},D$r.setFontSize=function(D$s){D$r.style.fontSize=D$s+"px"})},D$m._processInputting=function(D$s){var D$r=laya.display.Input.inputElement.target;if(D$r){var D$e=laya.display.Input.inputElement.value;D$r._restrictPattern&&(D$e=D$e.replace(/\u2006|\x27/g,""),D$r._restrictPattern.test(D$e)&&(D$e=D$e.replace(D$r._restrictPattern,""),laya.display.Input.inputElement.value=D$e)),D$r._text=D$e,D$r.event("input")}},D$m._stopEvent=function(D$s){"touchmove"==D$s.type&&D$s.preventDefault(),D$s.stopPropagation&&D$s.stopPropagation()},D$m.TYPE_TEXT="text",D$m.TYPE_PASSWORD="password",D$m.TYPE_EMAIL="email",D$m.TYPE_URL="url",D$m.TYPE_NUMBER="number",D$m.TYPE_RANGE="range",D$m.TYPE_DATE="date",D$m.TYPE_MONTH="month",D$m.TYPE_WEEK="week",D$m.TYPE_TIME="time",D$m.TYPE_DATE_TIME="datetime",D$m.TYPE_DATE_TIME_LOCAL="datetime-local",D$m.TYPE_SEARCH="search",D$m.input=null,D$m.area=null,D$m.inputElement=null,D$m.inputContainer=null,D$m.confirmButton=null,D$m.promptStyleDOM=null,D$m.inputHeight=45,D$m.isInputting=!1,D$m.stageMatrix=null,D$Y(D$m,["IOS_IFRAME",function(){return this.IOS_IFRAME=D$Q.onIOS&&D$Q.window.top!=D$Q.window.self}]),D$m}(D$ls),D$Xs=function(D$s){function D$e(D$s,D$r){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,D$e.__super.call(this),D$s&&this._init_(D$s,D$r)}D$h(D$e,"laya.resource.HTMLImage",D$bs);var D$r=D$e.prototype;return D$r._init_=function(D$s,D$r){this._src=D$s,this._source=new D$Q.window.Image,D$r&&(D$r.onload&&(this.onload=D$r.onload),D$r.onerror&&(this.onerror=D$r.onerror),D$r.onCreate&&D$r.onCreate(this)),0!=D$s.indexOf("data:image")&&(this._source.crossOrigin=""),D$s&&(this._source.src=D$s)},D$r.recreateResource=function(){var D$s=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var D$r=this;this._source=new D$Q.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(D$r._needReleaseAgain)return D$r._needReleaseAgain=!1,D$r._source.onload=null,void(D$r._source=null);D$r._source.onload=null,D$r.memorySize=D$s._w*D$s._h*4,D$r._recreateLock=!1,D$r.completeCreate()},this._source.src=this._src}},D$r.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},D$r.onresize=function(){this._w=this._source.width,this._h=this._source.height},D$B(0,D$r,"onload",null,function(D$s){var D$r=this;this._onload=D$s,this._source&&(this._source.onload=null!=this._onload?function(){D$r.onresize(),D$r._onload()}:null)}),D$B(0,D$r,"onerror",null,function(D$s){var D$r=this;this._onerror=D$s,this._source&&(this._source.onerror=null!=this._onerror?function(){D$r._onerror()}:null)}),D$B(0,D$r,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(D$s){this._enableMerageInAtlas=D$s,D$c.isConchApp&&this._source&&(this._source.enableMerageInAtlas=D$s)}),D$e.create=function(D$s,D$r){return new D$e(D$s,D$r)},D$e}(),D$Ds=(function(D$k){function D$s(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,D$s.__super.call(this)}D$h(D$s,"laya.display.EffectAnimation",D$k);var D$r=D$s.prototype;D$r._onOtherBegin=function(D$s){D$s!=this&&this.stop()},D$r.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},D$r._onPlayAction=function(){this.play(0,!1)},D$r.play=function(D$s,D$r,D$e,D$U){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=!0),void 0===D$e&&(D$e=""),void 0===D$U&&(D$U=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,D$s,D$r,D$e,D$U))},D$r._recordInitData=function(){if(this._aniKeys){var D$s,D$r,D$e=0;for(D$s=this._aniKeys.length,D$e=0;D$e<D$s;D$e++)D$r=this._aniKeys[D$e],this._initData[D$r]=this._target[D$r]}},D$r._displayToIndex=function(D$s){if(this._animationData){D$s<0&&(D$s=0),D$s>this._count&&(D$s=this._count);var D$r=this._animationData.nodes,D$e=0,D$U=D$r.length;for(D$U=1<D$U?1:D$U,D$e=0;D$e<D$U;D$e++)this._displayNodeToFrame(D$r[D$e],D$s)}},D$r._displayNodeToFrame=function(D$s,D$r,D$e){if(this._target){var D$U;D$U=this._target;var D$m,D$k,D$j,D$T,D$Y=D$s.frames,D$Z=D$s.keys,D$h=0,D$H=D$Z.length;D$T=D$s.secondFrames;var D$A,D$x,D$B,D$$,D$l=0;for(D$h=0;D$h<D$H;D$h++)D$k=D$Y[D$m=D$Z[D$h]],D$j=-1==(D$l=D$T[D$m])?this._initData[D$m]:D$r<D$l?(D$B=(D$x=D$s.keyframes[D$m])[0]).tween?(null==(D$A=D$q[D$B.tweenMethod])&&(D$A=D$q.linearNone),D$$=D$x[1],D$A(D$r,this._initData[D$m],D$$.value-this._initData[D$m],D$$.index)):this._initData[D$m]:D$k.length>D$r?D$k[D$r]:D$k[D$k.length-1],D$U[D$m]=D$j}},D$r._calculateNodeKeyFrames=function(D$s){D$k.prototype._calculateNodeKeyFrames.call(this,D$s);var D$r,D$e,D$U,D$m=D$s.keyframes;D$s.target;for(D$r in D$U={},D$s.secondFrames=D$U,D$m)(D$e=D$m[D$r]).length<=1?D$U[D$r]=-1:D$U[D$r]=D$e[1].index},D$B(0,D$r,"target",function(){return this._target},function(D$s){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=D$s,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),D$B(0,D$r,"playEvent",null,function(D$s){(this._playEvents=D$s)&&this.addEvent()}),D$B(0,D$r,"effectData",null,function(D$s){var D$r;D$s&&((D$r=D$s.animations)&&D$r[0]&&(this._setUp({},D$r[0]),D$r[0].nodes&&D$r[0].nodes[0]&&(this._aniKeys=D$r[0].nodes[0].keys)))}),D$B(0,D$r,"effectClass",null,function(D$s){var D$r,D$e;(this._effectClass=D$a.getClass(D$s),this._effectClass)&&((D$r=this._effectClass.uiView)&&(D$e=D$r.animations)&&D$e[0]&&(this._setUp({},D$e[0]),D$e[0].nodes&&D$e[0].nodes[0]&&(this._aniKeys=D$e[0].nodes[0].keys)))}),D$s.EffectAnimationBegin="effectanimationbegin"}(D$Is),function(D$r){var D$f;function D$J(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,D$J.__super.call(this)}D$h(D$J,"laya.utils.GraphicAnimation",D$r);var D$s=D$J.prototype;return D$s._parseNodeList=function(D$s){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[D$s.compId]=D$s.props,D$s.compId&&this._nodeList.push(D$s.compId);var D$r=D$s.child;if(D$r){var D$e=0,D$U=D$r.length;for(D$e=0;D$e<D$U;D$e++)this._parseNodeList(D$r[D$e])}},D$s._calGraphicData=function(D$s){var D$r;if(this._setUp(null,D$s),this._createGraphicData(),this._nodeIDAniDic)for(D$r in this._nodeIDAniDic)this._nodeIDAniDic[D$r]=null},D$s._createGraphicData=function(){var D$s,D$r=[],D$e=0,D$U=this.count,D$m=this._animationNewFrames;for(D$m||(D$m=[]),D$e=0;D$e<D$U;D$e++)!D$m[D$e]&&D$s||(D$s=this._createFrameGraphic(D$e)),D$r.push(D$s);this._gList=D$r},D$s._createFrameGraphic=function(D$s){var D$r=D$P.createGraphics();return D$J._rootMatrix||(D$J._rootMatrix=new D$O),this._updateNodeGraphic(this._rootNode,D$s,D$J._rootMatrix,D$r),D$r},D$s._updateNodeGraphic=function(D$s,D$r,D$e,D$U,D$m){var D$k;void 0===D$m&&(D$m=1);var D$j,D$T,D$Y,D$Z=(D$k=this._nodeGDic[D$s.compId]=this._getNodeGraphicData(D$s.compId,D$r,this._nodeGDic[D$s.compId])).alpha*D$m;if(!(D$Z<.01)&&(D$k.resultTransform||(D$k.resultTransform=D$O.create()),D$j=D$k.resultTransform,D$O.mul(D$k.transform,D$e,D$j),D$k.skin&&(D$T=this._getTextureByUrl(D$k.skin))&&(D$j._checkTransform()?(D$U.drawTexture(D$T,0,0,D$k.width,D$k.height,D$j,D$Z),D$k.resultTransform=null):D$U.drawTexture(D$T,D$j.tx,D$j.ty,D$k.width,D$k.height,null,D$Z)),D$Y=D$s.child)){var D$h,D$H=0;for(D$h=D$Y.length,D$H=0;D$H<D$h;D$H++)this._updateNodeGraphic(D$Y[D$H],D$r,D$j,D$U,D$Z)}},D$s._updateNoChilds=function(D$s,D$r){if(D$s.skin){var D$e=this._getTextureByUrl(D$s.skin);if(D$e){var D$U=D$s.transform;D$U._checkTransform();!D$U.bTransform?D$r.drawTexture(D$e,D$U.tx,D$U.ty,D$s.width,D$s.height,null,D$s.alpha):D$r.drawTexture(D$e,0,0,D$s.width,D$s.height,D$U.clone(),D$s.alpha)}}},D$s._updateNodeGraphic2=function(D$s,D$r,D$e){var D$U;if(D$U=this._nodeGDic[D$s.compId]=this._getNodeGraphicData(D$s.compId,D$r,this._nodeGDic[D$s.compId]),D$s.child){var D$m=D$U.transform;D$m._checkTransform();var D$k,D$j;D$j=(D$k=!D$m.bTransform)&&(0!=D$m.tx||0!=D$m.ty);var D$T,D$Y,D$Z;if((D$T=D$m.bTransform||1!=D$U.alpha)&&D$e.save(),1!=D$U.alpha&&D$e.alpha(D$U.alpha),D$k?D$j&&D$e.translate(D$m.tx,D$m.ty):D$e.transform(D$m.clone()),D$Y=D$s.child,D$U.skin&&(D$Z=this._getTextureByUrl(D$U.skin))&&D$e.drawTexture(D$Z,0,0,D$U.width,D$U.height),D$Y){var D$h,D$H=0;for(D$h=D$Y.length,D$H=0;D$H<D$h;D$H++)this._updateNodeGraphic2(D$Y[D$H],D$r,D$e)}D$T?D$e.restore():D$k?D$j&&D$e.translate(-D$m.tx,-D$m.ty):D$e.transform(D$m.clone().invert())}else this._updateNoChilds(D$U,D$e)},D$s._calculateNodeKeyFrames=function(D$s){D$r.prototype._calculateNodeKeyFrames.call(this,D$s),this._nodeIDAniDic[D$s.target]=D$s},D$s.getNodeDataByID=function(D$s){return this._nodeIDAniDic[D$s]},D$s._getParams=function(D$s,D$r,D$e,D$U){var D$m=D$J._temParam;D$m.length=D$r.length;var D$k=0,D$j=D$r.length;for(D$k=0;D$k<D$j;D$k++)D$m[D$k]=this._getObjVar(D$s,D$r[D$k][0],D$e,D$r[D$k][1],D$U);return D$m},D$s._getObjVar=function(D$s,D$r,D$e,D$U,D$m){if(D$s.hasOwnProperty(D$r)){var D$k=D$s[D$r];if(D$e>=D$k.length&&(D$e=D$k.length-1),null!=D$s[D$r][D$e])return D$s[D$r][D$e]}return D$m.hasOwnProperty(D$r)?D$m[D$r]:D$U},D$s._getNodeGraphicData=function(D$s,D$r,D$e){D$e||(D$e=D$f.create()),D$e.transform?D$e.transform.identity():D$e.transform=D$O.create();var D$U=this.getNodeDataByID(D$s);if(!D$U)return D$e;var D$m,D$k,D$j=D$U.frames,D$T=this._getParams(D$j,D$J._drawTextureCmd,D$r,this._nodeDefaultProps[D$s]),D$Y=D$T[0],D$Z=NaN,D$h=NaN,D$H=D$T[5],D$A=D$T[6],D$x=D$T[13],D$B=D$T[14],D$$=D$T[7],D$l=D$T[8],D$V=D$T[9],D$b=D$T[11],D$o=D$T[12];D$Z=D$T[3],D$h=D$T[4],0!=D$Z&&0!=D$h||(D$Y=null),-1==D$Z&&(D$Z=0),-1==D$h&&(D$h=0),D$e.skin=D$Y,D$e.width=D$Z,D$e.height=D$h,D$Y&&((D$m=this._getTextureByUrl(D$Y))?(D$Z||(D$Z=D$m.sourceWidth),D$h||(D$h=D$m.sourceHeight)):console.warn("lost skin:",D$Y,",you may load pics first")),D$e.alpha=D$T[10],D$k=D$e.transform,0!=D$x&&(D$H=D$x*D$Z),0!=D$B&&(D$A=D$B*D$h),0==D$H&&0==D$A||D$k.translate(-D$H,-D$A);var D$I=null;if(D$V||1!==D$$||1!==D$l||D$b||D$o){(D$I=D$J._tempMt).identity(),D$I.bTransform=!0;var D$w=.0174532922222222*(D$V-D$b),D$X=.0174532922222222*(D$V+D$o),D$D=Math.cos(D$X),D$n=Math.sin(D$X),D$y=Math.sin(D$w),D$g=Math.cos(D$w);D$I.a=D$$*D$D,D$I.b=D$$*D$n,D$I.c=-D$l*D$y,D$I.d=D$l*D$g,D$I.tx=D$I.ty=0}return D$I&&(D$k=D$O.mul(D$k,D$I,D$k)),D$k.translate(D$T[1],D$T[2]),D$e},D$s._getTextureByUrl=function(D$s){return D$Ts.getRes(D$s)},D$s.setAniData=function(D$s,D$r){if(D$s.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=D$s,this._parseNodeList(D$s);var D$e,D$U={},D$m=[],D$k=D$s.animations,D$j=0,D$T=D$k.length;for(D$j=0;D$j<D$T;D$j++)if(D$e=D$k[D$j],this._labels=null,(!D$r||D$r==D$e.name)&&D$e){try{this._calGraphicData(D$e)}catch(D$s){console.warn("parse animation fail:"+D$e.name+",empty animation created"),this._gList=[]}var D$Y={};D$Y.interval=1e3/D$e.frameRate,D$Y.frames=this._gList,D$Y.labels=this._labels,D$Y.name=D$e.name,D$m.push(D$Y),D$U[D$e.name]=D$Y}this.animationList=D$m,this.animationDic=D$U}D$J._temParam.length=0},D$s.parseByData=function(D$s){var D$r,D$e;D$r=D$s.nodeRoot,D$e=D$s.aniO,delete D$s.nodeRoot,delete D$s.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=D$r,this._parseNodeList(D$r),this._labels=null;try{this._calGraphicData(D$e)}catch(D$s){console.warn("parse animation fail:"+D$e.name+",empty animation created"),this._gList=[]}var D$U=D$s;return D$U.interval=1e3/D$e.frameRate,D$U.frames=this._gList,D$U.labels=this._labels,D$U.name=D$e.name,D$U},D$s.setUpAniData=function(D$s){if(D$s.animations){var D$r,D$e={},D$U=[],D$m=D$s.animations,D$k=0,D$j=D$m.length;for(D$k=0;D$k<D$j;D$k++)if(D$r=D$m[D$k]){var D$T={};D$T.name=D$r.name,D$T.aniO=D$r,D$T.nodeRoot=D$s,D$U.push(D$T),D$e[D$r.name]=D$T}this.animationList=D$U,this.animationDic=D$e}},D$s._clear=function(){var D$s,D$r;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(D$s in this._nodeGDic)(D$r=this._nodeGDic[D$s])&&D$r.recover();this._nodeGDic=null},D$J.parseAnimationByData=function(D$s){var D$r;return D$J._I||(D$J._I=new D$J),D$r=D$J._I.parseByData(D$s),D$J._I._clear(),D$r},D$J.parseAnimationData=function(D$s){var D$r;return D$J._I||(D$J._I=new D$J),D$J._I.setUpAniData(D$s),(D$r={}).animationList=D$J._I.animationList,D$r.animationDic=D$J._I.animationDic,D$J._I._clear(),D$r},D$J._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],D$J._temParam=[],D$J._I=null,D$J._rootMatrix=null,D$Y(D$J,["_tempMt",function(){return this._tempMt=new D$O}]),D$J.__init$=function(){D$f=function(){function D$s(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return D$h(D$s,""),D$s.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),D$d.recover("GraphicNode",this)},D$s.create=function(){return D$d.getItemByClass("GraphicNode",D$s)},D$s}()},D$J}(D$Is));D$D.__init([D$Z,D$Ys,D$c,D$Q,D$W,D$g,D$s,D$Ds])}(window,document,Laya),function(D$s,D$r,D$e){D$e.un,D$e.uns,D$e.static;var D$U=D$e.class;D$e.getset,D$e.__newvec;new(function(){function D$s(){}return D$U(D$s,"LayaMain"),D$s}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(D$s,D$r){"use strict";for(var D$e in Object.defineProperty(D$r,"__esModule",{value:!0}),Laya){var D$U=Laya[D$e];D$U&&D$U.__isclass&&(D$r[D$e]=D$U)}}),function(D$s,D$r,D$X){D$X.un,D$X.uns;var D$j=D$X.static,D$A=D$X.class,D$U=D$X.getset,D$k=D$X.__newvec,D$h=laya.maths.Arith,D$H=laya.maths.Bezier,D$e=laya.resource.Bitmap,D$x=laya.utils.Browser,D$Y=laya.utils.Byte,D$B=laya.utils.Color,D$D=(laya.filters.ColorFilter,D$X.Config),D$m=laya.resource.Context,D$n=(laya.events.Event,laya.filters.Filter),D$T=laya.display.Graphics,D$Z=laya.resource.HTMLCanvas,D$$=(laya.utils.HTMLChar,laya.resource.HTMLImage),D$l=laya.resource.HTMLSubImage,D$y=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),D$g=laya.maths.Point,D$f=laya.maths.Rectangle,D$V=laya.renders.Render,D$b=(laya.renders.RenderContext,laya.renders.RenderSprite),D$o=laya.resource.Resource,D$I=laya.resource.ResourceManager,D$w=laya.utils.RunDriver,D$J=laya.display.Sprite,D$P=laya.display.Stage,D$O=laya.utils.Stat,D$i=laya.utils.StringKey,D$K=(laya.display.css.Style,laya.system.System),D$c=laya.display.Text,D$E=laya.resource.Texture,D$v=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),D$S=laya.utils.VectorGraphManager;laya.utils.WordText;D$X.interface("laya.webgl.shapes.IShape"),D$X.interface("laya.webgl.submit.ISubmit"),D$X.interface("laya.webgl.text.ICharSegment"),D$X.interface("laya.webgl.canvas.save.ISaveData"),D$X.interface("laya.webgl.resource.IMergeAtlasBitmap"),D$X.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var D$z=function(){function D$s(){}D$A(D$s,"laya.filters.webgl.FilterActionGL");var D$r=D$s.prototype;return D$X.imps(D$r,{"laya.filters.IFilterActionGL":!0}),D$r.setValue=function(D$s){},D$r.setValueMix=function(D$s){},D$r.apply3d=function(D$s,D$r,D$e,D$U,D$m){return null},D$r.apply=function(D$s){return null},D$U(0,D$r,"typeMix",function(){return 0}),D$s}(),D$Q=function(){function D$s(){}return D$A(D$s,"laya.webgl.shader.ShaderValue"),D$s}(),D$C=function(){var D$U,D$m;function D$s(D$s,D$r,D$e){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new D$m,void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),this._cells=null,this._rowInfo=null,this._init(D$s,D$r),this._atlasID=D$e}D$A(D$s,"laya.webgl.atlas.AtlasGrid");var D$r=D$s.prototype;return D$r.getAltasID=function(){return this._atlasID},D$r.setAltasID=function(D$s){0<=D$s&&(this._atlasID=D$s)},D$r.addTex=function(D$s,D$r,D$e){var D$U=this._get(D$r,D$e);return 0==D$U.ret||(this._fill(D$U.x,D$U.y,D$r,D$e,D$s),this._texCount++),D$U},D$r._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},D$r._init=function(D$s,D$r){if(this._width=D$s,this._height=D$r,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=D$k(this._height);for(var D$e=0;D$e<this._height;D$e++)this._rowInfo[D$e]=new D$U;return this._clear(),!0},D$r._get=function(D$s,D$r){var D$e=new D$a;if(D$s>=this._failSize.width&&D$r>=this._failSize.height)return D$e;for(var D$U=-1,D$m=-1,D$k=this._width,D$j=this._height,D$T=this._cells,D$Y=0;D$Y<D$j;D$Y++)if(!(this._rowInfo[D$Y].spaceCount<D$s))for(var D$Z=0;D$Z<D$k;){var D$h=3*(D$Y*D$k+D$Z);if(0!=D$T[D$h]||D$T[1+D$h]<D$s||D$T[2+D$h]<D$r)D$Z+=D$T[1+D$h];else{D$U=D$Z,D$m=D$Y;for(var D$H=0;D$H<D$s;D$H++)if(D$T[3*D$H+D$h+2]<D$r){D$U=-1;break}if(!(D$U<0))return D$e.ret=!0,D$e.x=D$U,D$e.y=D$m,D$e;D$Z+=D$T[1+D$h]}}return D$e},D$r._fill=function(D$s,D$r,D$e,D$U,D$m){var D$k=this._width,D$j=this._height;this._check(D$s+D$e<=D$k&&D$r+D$U<=D$j);for(var D$T=D$r;D$T<D$U+D$r;++D$T){this._check(this._rowInfo[D$T].spaceCount>=D$e),this._rowInfo[D$T].spaceCount-=D$e;for(var D$Y=0;D$Y<D$e;D$Y++){var D$Z=3*(D$s+D$T*D$k+D$Y);this._check(0==this._cells[D$Z]),this._cells[D$Z]=D$m,this._cells[1+D$Z]=D$e,this._cells[2+D$Z]=D$U}}if(0<D$s)for(D$T=0;D$T<D$U;++D$T){var D$h=0;for(D$Y=D$s-1;0<=D$Y&&0==this._cells[3*((D$r+D$T)*D$k+D$Y)];--D$Y,++D$h);for(D$Y=D$h;0<D$Y;--D$Y)this._cells[3*((D$r+D$T)*D$k+D$s-D$Y)+1]=D$Y,this._check(0<D$Y)}if(0<D$r)for(D$Y=D$s;D$Y<D$s+D$e;++D$Y){for(D$h=0,D$T=D$r-1;0<=D$T&&0==this._cells[3*(D$Y+D$T*D$k)];--D$T,D$h++);for(D$T=D$h;0<D$T;--D$T)this._cells[3*(D$Y+(D$r-D$T)*D$k)+2]=D$T,this._check(0<D$T)}},D$r._check=function(D$s){0==D$s&&console.log("xtexMerger 错误啦")},D$r._clear=function(){for(var D$s=this._texCount=0;D$s<this._height;D$s++)this._rowInfo[D$s].spaceCount=this._width;for(var D$r=0;D$r<this._height;D$r++)for(var D$e=0;D$e<this._width;D$e++){var D$U=3*(D$r*this._width+D$e);this._cells[D$U]=0,this._cells[1+D$U]=this._width-D$e,this._cells[2+D$U]=this._width-D$r}this._failSize.width=this._width+1,this._failSize.height=this._height+1},D$s.__init$=function(){D$U=function(){function D$s(){this.spaceCount=0}return D$A(D$s,""),D$s}(),D$m=function(){function D$s(){this.width=0,this.height=0}return D$A(D$s,""),D$s}()},D$s}(),D$R=function(){function D$V(D$s,D$r,D$e,D$U){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=D$s,this._height=D$r,this._gridSize=D$e,this._maxAtlaserCount=D$U,this._gridNumX=D$s/D$e,this._gridNumY=D$r/D$e,this._curAtlasIndex=0,this._atlaserArray=[]}D$A(D$V,"laya.webgl.atlas.AtlasResourceManager");var D$s=D$V.prototype;return D$s.setAtlasParam=function(D$s,D$r,D$e,D$U){if(1==this._setAtlasParam)return D$V._sid_=0,this._width=D$s,this._height=D$r,this._gridSize=D$e,this._maxAtlaserCount=D$U,this._gridNumX=D$s/D$e,this._gridNumY=D$r/D$e,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},D$s.pushData=function(D$s){var D$r,D$e=D$s.bitmap,D$U=-1,D$m=null,D$k=0,D$j=0;for(D$k=0,D$r=this._atlaserArray.length;D$k<D$r&&(D$j=(this._curAtlasIndex+D$k)%D$r,-1==(D$U=(D$m=this._atlaserArray[D$j]).findBitmapIsExist(D$e)));D$k++);if(-1!=D$U){var D$T=D$m.InAtlasWebGLImagesOffsetValue[D$U];return D$B=D$T[0],D$$=D$T[1],D$m.addToAtlas(D$s,D$B,D$$),!0}this._setAtlasParam=!1;for(var D$Y=Math.ceil((D$s.bitmap.width+2)/this._gridSize),D$Z=Math.ceil((D$s.bitmap.height+2)/this._gridSize),D$h=!1,D$H=0;D$H<2;D$H++){var D$A=this._maxAtlaserCount;for(D$k=0;D$k<D$A;D$k++){D$j=(this._curAtlasIndex+D$k)%D$A,this._atlaserArray.length-1>=D$j||this._atlaserArray.push(new D$fs(this._gridNumX,this._gridNumY,this._width,this._height,D$V._sid_++));var D$x=this._atlaserArray[D$j],D$B=0,D$$=0,D$l=D$x.addTex(1,D$Y,D$Z);if(D$l.ret){D$B=D$l.x*this._gridSize+1,D$$=D$l.y*this._gridSize+1,D$e.lock=!0,D$x.addToAtlasTexture(D$e,D$B,D$$),D$x.addToAtlas(D$s,D$B,D$$),D$h=!0,this._curAtlasIndex=D$j;break}}if(D$h)break;this._atlaserArray.push(new D$fs(this._gridNumX,this._gridNumY,this._width,this._height,D$V._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return D$h||console.log(">>>AtlasManager pushData error"),D$h},D$s.addToAtlas=function(D$s){laya.webgl.atlas.AtlasResourceManager.instance.pushData(D$s)},D$s.garbageCollection=function(){if(!0===this._needGC){for(var D$s=this._atlaserArray.length-this._maxAtlaserCount,D$r=0;D$r<D$s;D$r++)this._atlaserArray[D$r].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+D$s),this._atlaserArray.splice(0,D$s),this._needGC=!1}return!0},D$s.freeAll=function(){for(var D$s=0,D$r=this._atlaserArray.length;D$s<D$r;D$s++)this._atlaserArray[D$s].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},D$s.getAtlaserCount=function(){return this._atlaserArray.length},D$s.getAtlaserByIndex=function(D$s){return this._atlaserArray[D$s]},D$U(1,D$V,"instance",function(){return D$V._Instance||(D$V._Instance=new D$V(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),D$V._Instance}),D$U(1,D$V,"enabled",function(){return D$D.atlasEnable}),D$U(1,D$V,"atlasLimitWidth",function(){return D$V._atlasLimitWidth},function(D$s){D$V._atlasLimitWidth=D$s}),D$U(1,D$V,"atlasLimitHeight",function(){return D$V._atlasLimitHeight},function(D$s){D$V._atlasLimitHeight=D$s}),D$V._enable=function(){D$D.atlasEnable=!0},D$V._disable=function(){D$D.atlasEnable=!1},D$V.__init__=function(){D$V.atlasTextureWidth=2048,D$V.atlasTextureHeight=2048,D$V.maxTextureCount=6,D$V.atlasLimitWidth=512,D$V.atlasLimitHeight=512},D$V._atlasLimitWidth=0,D$V._atlasLimitHeight=0,D$V.gridSize=16,D$V.atlasTextureWidth=0,D$V.atlasTextureHeight=0,D$V.maxTextureCount=0,D$V._atlasRestore=0,D$V.BOARDER_TYPE_NO=0,D$V.BOARDER_TYPE_RIGHT=1,D$V.BOARDER_TYPE_LEFT=2,D$V.BOARDER_TYPE_BOTTOM=4,D$V.BOARDER_TYPE_TOP=8,D$V.BOARDER_TYPE_ALL=15,D$V._sid_=0,D$V._Instance=null,D$V}(),D$a=function(){function D$s(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return D$A(D$s,"laya.webgl.atlas.MergeFillInfo"),D$s}(),D$p=function(){function D$r(){}return D$A(D$r,"laya.webgl.canvas.BlendMode"),D$r._init_=function(D$s){D$r.fns=[D$r.BlendNormal,D$r.BlendAdd,D$r.BlendMultiply,D$r.BlendScreen,D$r.BlendOverlay,D$r.BlendLight,D$r.BlendMask,D$r.BlendDestinationOut],D$r.targetFns=[D$r.BlendNormalTarget,D$r.BlendAddTarget,D$r.BlendMultiplyTarget,D$r.BlendScreenTarget,D$r.BlendOverlayTarget,D$r.BlendLightTarget,D$r.BlendMask,D$r.BlendDestinationOut]},D$r.BlendNormal=function(D$s){D$s.blendFunc(1,771)},D$r.BlendAdd=function(D$s){D$s.blendFunc(1,772)},D$r.BlendMultiply=function(D$s){D$s.blendFunc(774,771)},D$r.BlendScreen=function(D$s){D$s.blendFunc(1,1)},D$r.BlendOverlay=function(D$s){D$s.blendFunc(1,769)},D$r.BlendLight=function(D$s){D$s.blendFunc(1,1)},D$r.BlendNormalTarget=function(D$s){D$s.blendFunc(1,771)},D$r.BlendAddTarget=function(D$s){D$s.blendFunc(1,772)},D$r.BlendMultiplyTarget=function(D$s){D$s.blendFunc(774,771)},D$r.BlendScreenTarget=function(D$s){D$s.blendFunc(1,1)},D$r.BlendOverlayTarget=function(D$s){D$s.blendFunc(1,769)},D$r.BlendLightTarget=function(D$s){D$s.blendFunc(1,1)},D$r.BlendMask=function(D$s){D$s.blendFunc(0,770)},D$r.BlendDestinationOut=function(D$s){D$s.blendFunc(0,0)},D$r.activeBlendFunction=null,D$r.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],D$r.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},D$r.NORMAL="normal",D$r.ADD="add",D$r.MULTIPLY="multiply",D$r.SCREEN="screen",D$r.LIGHT="light",D$r.OVERLAY="overlay",D$r.DESTINATIONOUT="destination-out",D$r.fns=[],D$r.targetFns=[],D$r}(),D$N=function(){function D$e(D$s){this._color=D$B.create("black"),this.setValue(D$s)}D$A(D$e,"laya.webgl.canvas.DrawStyle");var D$s=D$e.prototype;return D$s.setValue=function(D$s){if(D$s){if("string"==typeof D$s)return void(this._color=D$B.create(D$s));if(D$s instanceof laya.utils.Color)return void(this._color=D$s)}},D$s.reset=function(){this._color=D$B.create("black")},D$s.equal=function(D$s){return"string"==typeof D$s?this._color.strColor===D$s:D$s instanceof laya.utils.Color&&this._color.numColor===D$s.numColor},D$s.toColorStr=function(){return this._color.strColor},D$e.create=function(D$s){var D$r;if(D$s&&("string"==typeof D$s?D$r=D$B.create(D$s):D$s instanceof laya.utils.Color&&(D$r=D$s),D$r))return D$r._drawStyle||(D$r._drawStyle=new D$e(D$s));return laya.webgl.canvas.DrawStyle.DEFAULT},D$j(D$e,["DEFAULT",function(){return this.DEFAULT=new D$e("#000000")}]),D$e}(),D$q=function(){function D$s(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];D$Is.mainContext;this.ib=D$_s.create(35048),this.vb=D$Fs.create(5)}D$A(D$s,"laya.webgl.canvas.Path");var D$r=D$s.prototype;return D$r.addPoint=function(D$s,D$r){this.tempArray.push(D$s,D$r)},D$r.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},D$r.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},D$r.polygon=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j;return this.geomatrys.push(this._curGeomatry=D$j=new D$is(D$s,D$r,D$e,D$U,D$m,D$k)),D$U||(D$j.fill=!1),null==D$k&&(D$j.borderWidth=0),D$j},D$r.setGeomtry=function(D$s){this.geomatrys.push(this._curGeomatry=D$s)},D$r.drawLine=function(D$s,D$r,D$e,D$U,D$m){var D$k;return this.closePath?this.geomatrys.push(this._curGeomatry=D$k=new D$Os(D$s,D$r,D$e,D$U,D$m)):this.geomatrys.push(this._curGeomatry=D$k=new D$Ps(D$s,D$r,D$e,D$U,D$m)),D$k.fill=!1,D$k},D$r.update=function(){var D$s=this.ib._byteLength,D$r=this.geomatrys.length;this.offset=D$s;for(var D$e=this.geoStart;D$e<D$r;D$e++)this.geomatrys[D$e].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=D$r,this.count=(this.ib._byteLength-D$s)/D$$s.BYTES_PIDX},D$r.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},D$r.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},D$s}(),D$G=function(){function D$T(){}D$A(D$T,"laya.webgl.canvas.save.SaveBase");var D$s=D$T.prototype;return D$X.imps(D$s,{"laya.webgl.canvas.save.ISaveData":!0}),D$s.isSaveMark=function(){return!1},D$s.restore=function(D$s){this._dataObj[this._valueName]=this._value,(D$T._cache[D$T._cache._length++]=this)._newSubmit&&(D$s._curSubmit=D$ks.RENDERBASE,D$s._renderKey=0)},D$T._createArray=function(){var D$s=[];return D$s._length=0,D$s},D$T._init=function(){var D$s=D$T._namemap={};return D$s[1]="ALPHA",D$s[2]="fillStyle",D$s[8]="font",D$s[256]="lineWidth",D$s[512]="strokeStyle",D$s[8192]="_mergeID",D$s[1024]=D$s[2048]=D$s[4096]=[],D$s[16384]="textBaseline",D$s[32768]="textAlign",D$s[65536]="_nBlendType",D$s[1048576]="shader",D$s[2097152]="filters",D$s},D$T.save=function(D$s,D$r,D$e,D$U){if((D$s._saveMark._saveuse&D$r)!==D$r){D$s._saveMark._saveuse|=D$r;var D$m=D$T._cache,D$k=0<D$m._length?D$m[--D$m._length]:new D$T;D$k._value=D$e[D$k._valueName=D$T._namemap[D$r]],D$k._dataObj=D$e,D$k._newSubmit=D$U;var D$j=D$s._save;D$j[D$j._length++]=D$k}},D$T._cache=laya.webgl.canvas.save.SaveBase._createArray(),D$T._namemap=D$T._init(),D$T}(),D$d=function(){function D$k(){this._clipRect=new D$f}D$A(D$k,"laya.webgl.canvas.save.SaveClipRect");var D$s=D$k.prototype;return D$X.imps(D$s,{"laya.webgl.canvas.save.ISaveData":!0}),D$s.isSaveMark=function(){return!1},D$s.restore=function(D$s){D$s._clipRect=this._clipSaveRect,(D$k._cache[D$k._cache._length++]=this)._submitScissor.submitLength=D$s._submits._length-this._submitScissor.submitIndex,D$s._curSubmit=D$ks.RENDERBASE,D$s._renderKey=0},D$k.save=function(D$s,D$r){if(131072!=(131072&D$s._saveMark._saveuse)){D$s._saveMark._saveuse|=131072;var D$e=D$k._cache,D$U=0<D$e._length?D$e[--D$e._length]:new D$k;D$U._clipSaveRect=D$s._clipRect,D$s._clipRect=D$U._clipRect.copyFrom(D$s._clipRect),D$U._submitScissor=D$r;var D$m=D$s._save;D$m[D$m._length++]=D$U}},D$j(D$k,["_cache",function(){return this._cache=D$G._createArray()}]),D$k}(),D$t=function(){function D$x(){this._contextX=0,this._contextY=0,this._clipRect=new D$f,this._rect=new D$f,this._matrix=new D$y}D$A(D$x,"laya.webgl.canvas.save.SaveClipRectStencil");var D$s=D$x.prototype;return D$X.imps(D$s,{"laya.webgl.canvas.save.ISaveData":!0}),D$s.isSaveMark=function(){return!1},D$s.restore=function(D$s){D$hs.restore(D$s,this._rect,this._saveMatrix,this._contextX,this._contextY),D$s._clipRect=this._clipSaveRect,D$s._curMat=this._saveMatrix,D$s._x=this._contextX,D$s._y=this._contextY,D$x._cache[D$x._cache._length++]=this,D$s._curSubmit=D$ks.RENDERBASE},D$x.save=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){if(262144!=(262144&D$s._saveMark._saveuse)){D$s._saveMark._saveuse|=262144;var D$h=D$x._cache,D$H=0<D$h._length?D$h[--D$h._length]:new D$x;D$H._clipSaveRect=D$s._clipRect,D$H._clipRect.setTo(D$j,D$T,D$Y,D$Z),D$s._clipRect=D$H._clipRect,D$H._rect.x=D$e,D$H._rect.y=D$U,D$H._rect.width=D$m,D$H._rect.height=D$k,D$H._contextX=D$s._x,D$H._contextY=D$s._y,D$H._saveMatrix=D$s._curMat,D$s._curMat.copyTo(D$H._matrix),D$s._curMat=D$H._matrix,D$H._submitStencil=D$r;var D$A=D$s._save;D$A[D$A._length++]=D$H}},D$j(D$x,["_cache",function(){return this._cache=D$G._createArray()}]),D$x}(),D$W=function(){function D$U(){this._saveuse=0}D$A(D$U,"laya.webgl.canvas.save.SaveMark");var D$s=D$U.prototype;return D$X.imps(D$s,{"laya.webgl.canvas.save.ISaveData":!0}),D$s.isSaveMark=function(){return!0},D$s.restore=function(D$s){D$s._saveMark=this._preSaveMark,D$U._no[D$U._no._length++]=this},D$U.Create=function(D$s){var D$r=D$U._no,D$e=0<D$r._length?D$r[--D$r._length]:new D$U;return D$e._saveuse=0,D$e._preSaveMark=D$s._saveMark,D$s._saveMark=D$e},D$j(D$U,["_no",function(){return this._no=D$G._createArray()}]),D$U}(),D$L=function(){function D$k(){this._matrix=new D$y}D$A(D$k,"laya.webgl.canvas.save.SaveTransform");var D$s=D$k.prototype;return D$X.imps(D$s,{"laya.webgl.canvas.save.ISaveData":!0}),D$s.isSaveMark=function(){return!1},D$s.restore=function(D$s){D$s._curMat=this._savematrix,D$k._no[D$k._no._length++]=this},D$k.save=function(D$s){var D$r=D$s._saveMark;if(2048!=(2048&D$r._saveuse)){D$r._saveuse|=2048;var D$e=D$k._no,D$U=0<D$e._length?D$e[--D$e._length]:new D$k;D$U._savematrix=D$s._curMat,D$s._curMat=D$s._curMat.copyTo(D$U._matrix);var D$m=D$s._save;D$m[D$m._length++]=D$U}},D$j(D$k,["_no",function(){return this._no=D$G._createArray()}]),D$k}(),D$u=function(){function D$m(){}D$A(D$m,"laya.webgl.canvas.save.SaveTranslate");var D$s=D$m.prototype;return D$X.imps(D$s,{"laya.webgl.canvas.save.ISaveData":!0}),D$s.isSaveMark=function(){return!1},D$s.restore=function(D$s){D$s._curMat;D$s._x=this._x,D$s._y=this._y,D$m._no[D$m._no._length++]=this},D$m.save=function(D$s){var D$r=D$m._no,D$e=0<D$r._length?D$r[--D$r._length]:new D$m;D$e._x=D$s._x,D$e._y=D$s._y;var D$U=D$s._save;D$U[D$U._length++]=D$e},D$j(D$m,["_no",function(){return this._no=D$G._createArray()}]),D$m}(),D$M=function(){function D$s(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new D$f}D$A(D$s,"laya.webgl.resource.RenderTargetMAX");var D$r=D$s.prototype;return D$r.setSP=function(D$s){this._sp=D$s},D$r.size=function(D$s,D$r){var D$e=this;this._width!==D$s||this._height!==D$r?(this.repaint=!0,this._width=D$s,this._height=D$r,this.target?this.target.size(D$s,D$r):this.target=D$Ss.create(D$s,D$r),this.target.hasListener("recovered")||this.target.on("recovered",this,function(D$s){D$X.timer.callLater(D$e._sp,D$e._sp.repaint)})):this.target.size(D$s,D$r)},D$r._flushToTarget=function(D$s,D$r){if(!D$r._destroy){var D$e=D$bs.worldScissorTest,D$U=D$bs.worldClipRect;D$bs.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,D$bs.worldScissorTest=!1,D$Is.mainContext.disable(3089);var D$m=D$bs.worldAlpha,D$k=D$bs.worldMatrix4,D$j=D$bs.worldMatrix,D$T=D$bs.worldFilters,D$Y=D$bs.worldShaderDefines;if(D$bs.worldMatrix=D$y.EMPTY,D$bs.restoreTempArray(),D$bs.worldMatrix4=D$bs.TEMPMAT4_ARRAY,D$bs.worldAlpha=1,D$bs.worldFilters=null,D$bs.worldShaderDefines=null,D$vs.activeShader=null,D$r.start(),D$D.showCanvasMark?D$r.clear(0,1,0,.3):D$r.clear(0,0,0,0),D$s.flush(),D$r.end(),D$vs.activeShader=null,D$bs.worldAlpha=D$m,D$bs.worldMatrix4=D$k,D$bs.worldMatrix=D$j,D$bs.worldFilters=D$T,D$bs.worldShaderDefines=D$Y,D$bs.worldScissorTest=D$e){var D$Z=D$bs.height-D$U.y-D$U.height;D$Is.mainContext.scissor(D$U.x,D$Z,D$U.width,D$U.height),D$Is.mainContext.enable(3089)}D$bs.worldClipRect=D$U}},D$r.flush=function(D$s){this.repaint&&(this._flushToTarget(D$s,this.target),this.repaint=!1)},D$r.drawTo=function(D$s,D$r,D$e,D$U,D$m){D$s.drawTexture(this.target.getTexture(),D$r,D$e,D$U,D$m,0,0)},D$r.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},D$s}(),D$_=function(){function D$s(){this.ALPHA=1,this.shaderType=0,this.defines=new D$Js}return D$A(D$s,"laya.webgl.shader.d2.Shader2D"),D$s.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},D$s.__init__=function(){var D$s,D$r;D$Ws.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),D$Ws.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),D$Ws.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),D$Ws.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),D$Ws.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),D$Ws.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),D$Ws.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),D$Ws.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),D$s="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",D$r='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',D$Ws.preCompile2D(0,1,D$s,D$r,null),D$s="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",D$r='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',D$Ws.preCompile2D(0,2,D$s,D$r,null),D$s="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",D$r="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",D$Ws.preCompile2D(0,4,D$s,D$r,null),D$s="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",D$r='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',D$Ws.preCompile2D(0,256,D$s,D$r,null),D$s="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",D$r="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",D$Ws.preCompile2D(0,512,D$s,D$r,null)},D$s}(),D$F=function(){function D$r(D$s,D$r,D$e){this._value=0,this._name2int=D$s,this._int2name=D$r,this._int2nameMap=D$e}D$A(D$r,"laya.webgl.shader.ShaderDefines");var D$s=D$r.prototype;return D$s.add=function(D$s){return"string"==typeof D$s&&(D$s=this._name2int[D$s]),this._value|=D$s,this._value},D$s.addInt=function(D$s){return this._value|=D$s,this._value},D$s.remove=function(D$s){return"string"==typeof D$s&&(D$s=this._name2int[D$s]),this._value&=~D$s,this._value},D$s.isDefine=function(D$s){return(this._value&D$s)===D$s},D$s.getValue=function(){return this._value},D$s.setValue=function(D$s){this._value=D$s},D$s.toNameDic=function(){var D$s=this._int2nameMap[this._value];return D$s||D$r._toText(this._value,this._int2name,this._int2nameMap)},D$r._reg=function(D$s,D$r,D$e,D$U){D$U[D$e[D$s]=D$r]=D$s},D$r._toText=function(D$s,D$r,D$e){var D$U=D$e[D$s];if(D$U)return D$U;for(var D$m={},D$k=1,D$j=0;D$j<32&&!(D$s<(D$k=1<<D$j));D$j++)if(D$s&D$k){var D$T=D$r[D$k];D$T&&(D$m[D$T]="")}return D$e[D$s]=D$m},D$r._toInt=function(D$s,D$r){for(var D$e=D$s.split("."),D$U=0,D$m=0,D$k=D$e.length;D$m<D$k;D$m++){var D$j=D$r[D$e[D$m]];if(!D$j)throw new Error("Defines to int err:"+D$s+"/"+D$e[D$m]);D$U|=D$j}return D$U},D$r}(),D$ss=function(){function D$j(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new D$y}D$A(D$j,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var D$s=D$j.prototype;return D$s.init=function(D$s,D$r,D$e){if(D$r)this._vs=D$r;else{this._vs=[];var D$U=D$s.width,D$m=D$s.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(D$U,0,1,0,1,1,1,1),this._vs.push(D$U,D$m,1,1,1,1,1,1),this._vs.push(0,D$m,0,1,1,1,1,1)}D$e?this._ps=D$e:(D$j._defaultPS||(D$j._defaultPS=[]).push(0,1,3,3,1,2),this._ps=D$j._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=D$s},D$s.init2=function(D$s,D$r,D$e,D$U,D$m){this.transform&&(this.transform=null),D$e?this._ps=D$e:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=D$U,this._uvs=D$m,this.mEleNum=this._ps.length,this.mTexture=D$s,(D$V.isConchNode||D$V.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},D$s._initMyData=function(){var D$s=0,D$r=0,D$e=4*this._verticles.length;this._vs=D$j._tempVS;var D$U=!1;if(D$V.isConchNode||D$V.isConchApp?(this._vs.length=D$e,D$U=!0):this._vs.length<D$e&&(this._vs.length=D$e,D$U=!0),D$j._tVSLen=D$e,D$U)for(;D$s<D$e;)this._vs[D$s]=this._verticles[D$r],this._vs[D$s+1]=this._verticles[D$r+1],this._vs[D$s+2]=this._uvs[D$r],this._vs[D$s+3]=this._uvs[D$r+1],this._vs[D$s+4]=1,this._vs[D$s+5]=1,this._vs[D$s+6]=1,this._vs[D$s+7]=1,D$s+=8,D$r+=2;else for(;D$s<D$e;)this._vs[D$s]=this._verticles[D$r],this._vs[D$s+1]=this._verticles[D$r+1],this._vs[D$s+2]=this._uvs[D$r],this._vs[D$s+3]=this._uvs[D$r+1],D$s+=8,D$r+=2},D$s.getData2=function(D$s,D$r,D$e){var D$U;this.mVBBuffer=D$s,this.mIBBuffer=D$r,this._initMyData(),D$s.appendEx2(this._vs,Float32Array,D$j._tVSLen,4),this._indexStart=D$r._byteLength,(D$U=D$j._tempIB).length<this._ps.length&&(D$U.length=this._ps.length);for(var D$m=0,D$k=this._ps.length;D$m<D$k;D$m++)D$U[D$m]=this._ps[D$m]+D$e;D$r.appendEx2(D$U,Uint16Array,this._ps.length,2)},D$s.getData=function(D$s,D$r,D$e){if(this.mVBBuffer=D$s,this.mIBBuffer=D$r,D$s.append(this.mVBData),this._indexStart=D$r._byteLength,this.mIBData.start!=D$e){for(var D$U=0,D$m=this._ps.length;D$U<D$m;D$U++)this.mIBData[D$U]=this._ps[D$U]+D$e;this.mIBData.start=D$e}D$r.append(this.mIBData)},D$s.render=function(D$s,D$r,D$e){if(D$V.isWebGL&&this.mTexture){D$s._renderKey=0,D$s._shader2D.glTexture=null,D$rs.getInstance().addSkinMesh(this);var D$U=D$ks.createShape(D$s,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,D$ns.create(512,0));this.transform||(this.transform=D$y.EMPTY),this.transform.translate(D$r,D$e),D$y.mul(this.transform,D$s._curMat,this._tempMatrix),this.transform.translate(-D$r,-D$e);var D$m=D$U.shaderValue,D$k=D$m.u_mmat2||D$bs.getMatrArray();D$bs.mat2MatArray(this._tempMatrix,D$k),D$m.textureHost=this.mTexture,D$m.offsetX=0,D$m.offsetY=0,D$m.u_mmat2=D$k,D$m.ALPHA=D$s._shader2D.ALPHA,D$s._submits[D$s._submits._length++]=D$U}else D$V.isConchApp&&this.mTexture&&(this.transform||(this.transform=D$y.EMPTY),D$s.setSkinMesh&&D$s.setSkinMesh(D$r,D$e,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},D$j._tempVS=[],D$j._tempIB=[],D$j._defaultPS=null,D$j._tVSLen=0,D$j}(),D$rs=function(){function D$s(){this.ib=null,this.vb=null;D$Is.mainContext;this.ib=D$_s.create(35048),this.vb=D$Fs.create(8)}D$A(D$s,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var D$r=D$s.prototype;return D$r.addSkinMesh=function(D$s){D$s.getData2(this.vb,this.ib,this.vb._byteLength/32)},D$r.reset=function(){this.vb.clear(),this.ib.clear()},D$s.getInstance=function(){return D$s.instance=D$s.instance||new D$s},D$s.instance=null,D$s}(),D$es=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===D$Y&&(D$Y=0),this.x=D$s,this.y=D$r,this.width=D$e,this.height=D$U,this.edges=D$m,this.color=D$k,this.borderWidth=D$j,this.borderColor=D$T}D$A(D$s,"laya.webgl.shapes.BasePoly");var D$r=D$s.prototype;return D$X.imps(D$r,{"laya.webgl.shapes.IShape":!0}),D$r.getData=function(D$s,D$r,D$e){},D$r.rebuild=function(D$s){},D$r.setMatrix=function(D$s){},D$r.needUpdate=function(D$s){return!0},D$r.sector=function(D$s,D$r,D$e){var D$U=this.x,D$m=this.y,D$k=this.edges,D$j=(this.r1-this.r0)/D$k,D$T=this.width,D$Y=this.height,D$Z=this.color,D$h=(D$Z>>16&255)/255,D$H=(D$Z>>8&255)/255,D$A=(255&D$Z)/255;D$s.push(D$U,D$m,D$h,D$H,D$A);for(var D$x=0;D$x<D$k+1;D$x++)D$s.push(D$U+Math.sin(D$j*D$x+this.r0)*D$T,D$m+Math.cos(D$j*D$x+this.r0)*D$Y),D$s.push(D$h,D$H,D$A);for(D$x=0;D$x<D$k;D$x++)D$r.push(D$e,D$e+D$x+1,D$e+D$x+2)},D$r.createLine2=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j,D$T,D$Y,D$Z,D$h,D$H,D$A,D$x,D$B,D$$,D$l,D$V,D$b,D$o,D$I,D$w,D$X,D$D,D$n,D$y,D$g=D$s.concat(),D$f=D$m,D$J=this.borderColor,D$P=(D$J>>16&255)/255,D$O=(D$J>>8&255)/255,D$i=(255&D$J)/255,D$K=D$g.length/2,D$c=D$U,D$E=D$e/2;D$Y=D$g[0],D$Z=D$g[1],D$$=D$Y-(D$h=D$g[2]),D$B=(D$B=-(D$Z-(D$H=D$g[3])))/(D$y=Math.sqrt(D$B*D$B+D$$*D$$))*D$E,D$$=D$$/D$y*D$E,D$f.push(D$Y-D$B+this.x,D$Z-D$$+this.y,D$P,D$O,D$i,D$Y+D$B+this.x,D$Z+D$$+this.y,D$P,D$O,D$i);for(var D$v=1;D$v<D$K-1;D$v++)D$Y=D$g[2*(D$v-1)],D$Z=D$g[2*(D$v-1)+1],D$h=D$g[2*D$v],D$H=D$g[2*D$v+1],D$A=D$g[2*(D$v+1)],D$x=D$g[2*(D$v+1)+1],D$$=D$Y-D$h,D$V=D$h-D$A,D$I=(-(D$B=(D$B=-(D$Z-D$H))/(D$y=Math.sqrt(D$B*D$B+D$$*D$$))*D$E)+D$Y)*(-(D$$=D$$/D$y*D$E)+D$H)-(-D$B+D$h)*(-D$$+D$Z),D$D=(-(D$l=(D$l=-(D$H-D$x))/(D$y=Math.sqrt(D$l*D$l+D$V*D$V))*D$E)+D$A)*(-(D$V=D$V/D$y*D$E)+D$H)-(-D$l+D$h)*(-D$V+D$x),D$n=(D$b=-D$$+D$Z-(-D$$+D$H))*(D$X=-D$l+D$h-(-D$l+D$A))-(D$w=-D$V+D$x-(-D$V+D$H))*(D$o=-D$B+D$h-(-D$B+D$Y)),Math.abs(D$n)<.1?(D$n+=10.1,D$f.push(D$h-D$B+this.x,D$H-D$$+this.y,D$P,D$O,D$i,D$h+D$B+this.x,D$H+D$$+this.y,D$P,D$O,D$i)):(((D$j=(D$o*D$D-D$X*D$I)/D$n)-D$h)*(D$j-D$h)+((D$T=(D$w*D$I-D$b*D$D)/D$n)-D$H)+(D$T-D$H),D$f.push(D$j+this.x,D$T+this.y,D$P,D$O,D$i,D$h-(D$j-D$h)+this.x,D$H-(D$T-D$H)+this.y,D$P,D$O,D$i));D$Y=D$g[D$g.length-4],D$Z=D$g[D$g.length-3],D$$=D$Y-(D$h=D$g[D$g.length-2]),D$B=(D$B=-(D$Z-(D$H=D$g[D$g.length-1])))/(D$y=Math.sqrt(D$B*D$B+D$$*D$$))*D$E,D$$=D$$/D$y*D$E,D$f.push(D$h-D$B+this.x,D$H-D$$+this.y,D$P,D$O,D$i,D$h+D$B+this.x,D$H+D$$+this.y,D$P,D$O,D$i);var D$S=D$k;for(D$v=1;D$v<D$S;D$v++)D$r.push(D$c+2*(D$v-1),D$c+2*(D$v-1)+1,D$c+2*D$v+1,D$c+2*D$v+1,D$c+2*D$v,D$c+2*(D$v-1));return D$f},D$r.createLine=function(D$s,D$r,D$e,D$U){var D$m=D$s.concat(),D$k=D$s,D$j=this.borderColor,D$T=(D$j>>16&255)/255,D$Y=(D$j>>8&255)/255,D$Z=(255&D$j)/255;D$m.splice(0,5);var D$h,D$H,D$A,D$x,D$B,D$$,D$l,D$V,D$b,D$o,D$I,D$w,D$X,D$D,D$n,D$y,D$g,D$f,D$J,D$P,D$O=D$m.length/5,D$i=D$U,D$K=D$e/2;D$A=D$m[0],D$x=D$m[1],D$o=D$A-(D$B=D$m[5]),D$b=(D$b=-(D$x-(D$$=D$m[6])))/(D$P=Math.sqrt(D$b*D$b+D$o*D$o))*D$K,D$o=D$o/D$P*D$K,D$k.push(D$A-D$b,D$x-D$o,D$T,D$Y,D$Z,D$A+D$b,D$x+D$o,D$T,D$Y,D$Z);for(var D$c=1;D$c<D$O-1;D$c++)D$A=D$m[5*(D$c-1)],D$x=D$m[5*(D$c-1)+1],D$B=D$m[5*D$c],D$$=D$m[5*D$c+1],D$l=D$m[5*(D$c+1)],D$V=D$m[5*(D$c+1)+1],D$o=D$A-D$B,D$w=D$B-D$l,D$n=(-(D$b=(D$b=-(D$x-D$$))/(D$P=Math.sqrt(D$b*D$b+D$o*D$o))*D$K)+D$A)*(-(D$o=D$o/D$P*D$K)+D$$)-(-D$b+D$B)*(-D$o+D$x),D$f=(-(D$I=(D$I=-(D$$-D$V))/(D$P=Math.sqrt(D$I*D$I+D$w*D$w))*D$K)+D$l)*(-(D$w=D$w/D$P*D$K)+D$$)-(-D$I+D$B)*(-D$w+D$V),D$J=(D$X=-D$o+D$x-(-D$o+D$$))*(D$g=-D$I+D$B-(-D$I+D$l))-(D$y=-D$w+D$V-(-D$w+D$$))*(D$D=-D$b+D$B-(-D$b+D$A)),Math.abs(D$J)<.1?(D$J+=10.1,D$k.push(D$B-D$b,D$$-D$o,D$T,D$Y,D$Z,D$B+D$b,D$$+D$o,D$T,D$Y,D$Z)):(((D$h=(D$D*D$f-D$g*D$n)/D$J)-D$B)*(D$h-D$B)+((D$H=(D$y*D$n-D$X*D$f)/D$J)-D$$)+(D$H-D$$),D$k.push(D$h,D$H,D$T,D$Y,D$Z,D$B-(D$h-D$B),D$$-(D$H-D$$),D$T,D$Y,D$Z));D$A=D$m[D$m.length-10],D$x=D$m[D$m.length-9],D$o=D$A-(D$B=D$m[D$m.length-5]),D$b=(D$b=-(D$x-(D$$=D$m[D$m.length-4])))/(D$P=Math.sqrt(D$b*D$b+D$o*D$o))*D$K,D$o=D$o/D$P*D$K,D$k.push(D$B-D$b,D$$-D$o,D$T,D$Y,D$Z,D$B+D$b,D$$+D$o,D$T,D$Y,D$Z);var D$E=this.edges+1;for(D$c=1;D$c<D$E;D$c++)D$r.push(D$i+2*(D$c-1),D$i+2*(D$c-1)+1,D$i+2*D$c+1,D$i+2*D$c+1,D$i+2*D$c,D$i+2*(D$c-1));return D$k},D$r.createLoopLine=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$s.concat(),D$T=D$m||D$s,D$Y=this.borderColor,D$Z=(D$Y>>16&255)/255,D$h=(D$Y>>8&255)/255,D$H=(255&D$Y)/255;D$j.splice(0,5);var D$A=[D$j[0],D$j[1]],D$x=[D$j[D$j.length-5],D$j[D$j.length-4]],D$B=D$x[0]+.5*(D$A[0]-D$x[0]),D$$=D$x[1]+.5*(D$A[1]-D$x[1]);D$j.unshift(D$B,D$$,0,0,0),D$j.push(D$B,D$$,0,0,0);var D$l,D$V,D$b,D$o,D$I,D$w,D$X,D$D,D$n,D$y,D$g,D$f,D$J,D$P,D$O,D$i,D$K,D$c,D$E,D$v,D$S=D$j.length/5,D$z=D$U,D$Q=D$e/2;D$b=D$j[0],D$o=D$j[1],D$y=D$b-(D$I=D$j[5]),D$n=(D$n=-(D$o-(D$w=D$j[6])))/(D$v=Math.sqrt(D$n*D$n+D$y*D$y))*D$Q,D$y=D$y/D$v*D$Q,D$T.push(D$b-D$n,D$o-D$y,D$Z,D$h,D$H,D$b+D$n,D$o+D$y,D$Z,D$h,D$H);for(var D$C=1;D$C<D$S-1;D$C++)D$b=D$j[5*(D$C-1)],D$o=D$j[5*(D$C-1)+1],D$I=D$j[5*D$C],D$w=D$j[5*D$C+1],D$X=D$j[5*(D$C+1)],D$D=D$j[5*(D$C+1)+1],D$y=D$b-D$I,D$f=D$I-D$X,D$O=(-(D$n=(D$n=-(D$o-D$w))/(D$v=Math.sqrt(D$n*D$n+D$y*D$y))*D$Q)+D$b)*(-(D$y=D$y/D$v*D$Q)+D$w)-(-D$n+D$I)*(-D$y+D$o),D$c=(-(D$g=(D$g=-(D$w-D$D))/(D$v=Math.sqrt(D$g*D$g+D$f*D$f))*D$Q)+D$X)*(-(D$f=D$f/D$v*D$Q)+D$w)-(-D$g+D$I)*(-D$f+D$D),D$E=(D$J=-D$y+D$o-(-D$y+D$w))*(D$K=-D$g+D$I-(-D$g+D$X))-(D$i=-D$f+D$D-(-D$f+D$w))*(D$P=-D$n+D$I-(-D$n+D$b)),Math.abs(D$E)<.1?(D$E+=10.1,D$T.push(D$I-D$n,D$w-D$y,D$Z,D$h,D$H,D$I+D$n,D$w+D$y,D$Z,D$h,D$H)):(((D$l=(D$P*D$c-D$K*D$O)/D$E)-D$I)*(D$l-D$I)+((D$V=(D$i*D$O-D$J*D$c)/D$E)-D$w)+(D$V-D$w),D$T.push(D$l,D$V,D$Z,D$h,D$H,D$I-(D$l-D$I),D$w-(D$V-D$w),D$Z,D$h,D$H));D$k&&(D$r=D$k);var D$R=this.edges+1;for(D$C=1;D$C<D$R;D$C++)D$r.push(D$z+2*(D$C-1),D$z+2*(D$C-1)+1,D$z+2*D$C+1,D$z+2*D$C+1,D$z+2*D$C,D$z+2*(D$C-1));return D$r.push(D$z+2*(D$C-1),D$z+2*(D$C-1)+1,D$z+1,D$z+1,D$z,D$z+2*(D$C-1)),D$T},D$s}(),D$Us=function(){function D$$(){}return D$A(D$$,"laya.webgl.shapes.Earcut"),D$$.earcut=function(D$s,D$r,D$e){D$e=D$e||2;var D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h=D$r&&D$r.length,D$H=D$h?D$r[0]*D$e:D$s.length,D$A=D$$.linkedList(D$s,0,D$H,D$e,!0),D$x=[];if(!D$A)return D$x;if(D$h&&(D$A=D$$.eliminateHoles(D$s,D$r,D$A,D$e)),D$s.length>80*D$e){D$U=D$k=D$s[0],D$m=D$j=D$s[1];for(var D$B=D$e;D$B<D$H;D$B+=D$e)(D$T=D$s[D$B])<D$U&&(D$U=D$T),(D$Y=D$s[D$B+1])<D$m&&(D$m=D$Y),D$k<D$T&&(D$k=D$T),D$j<D$Y&&(D$j=D$Y);D$Z=0!==(D$Z=Math.max(D$k-D$U,D$j-D$m))?1/D$Z:0}return D$$.earcutLinked(D$A,D$x,D$e,D$U,D$m,D$Z),D$x},D$$.linkedList=function(D$s,D$r,D$e,D$U,D$m){var D$k,D$j;if(D$m===0<D$$.signedArea(D$s,D$r,D$e,D$U))for(D$k=D$r;D$k<D$e;D$k+=D$U)D$j=D$$.insertNode(D$k,D$s[D$k],D$s[D$k+1],D$j);else for(D$k=D$e-D$U;D$r<=D$k;D$k-=D$U)D$j=D$$.insertNode(D$k,D$s[D$k],D$s[D$k+1],D$j);return D$j&&D$$.equals(D$j,D$j.next)&&(D$$.removeNode(D$j),D$j=D$j.next),D$j},D$$.filterPoints=function(D$s,D$r){if(!D$s)return D$s;D$r||(D$r=D$s);var D$e,D$U=D$s;do{if(D$e=!1,D$U.steiner||!D$$.equals(D$U,D$U.next)&&0!==D$$.area(D$U.prev,D$U,D$U.next))D$U=D$U.next;else{if(D$$.removeNode(D$U),(D$U=D$r=D$U.prev)===D$U.next)break;D$e=!0}}while(D$e||D$U!==D$r);return D$r},D$$.earcutLinked=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){if(D$s){!D$j&&D$k&&D$$.indexCurve(D$s,D$U,D$m,D$k);for(var D$T,D$Y,D$Z=D$s;D$s.prev!==D$s.next;)if(D$T=D$s.prev,D$Y=D$s.next,D$k?D$$.isEarHashed(D$s,D$U,D$m,D$k):D$$.isEar(D$s))D$r.push(D$T.i/D$e),D$r.push(D$s.i/D$e),D$r.push(D$Y.i/D$e),D$$.removeNode(D$s),D$s=D$Y.next,D$Z=D$Y.next;else if((D$s=D$Y)===D$Z){D$j?1===D$j?(D$s=D$$.cureLocalIntersections(D$s,D$r,D$e),D$$.earcutLinked(D$s,D$r,D$e,D$U,D$m,D$k,2)):2===D$j&&D$$.splitEarcut(D$s,D$r,D$e,D$U,D$m,D$k):D$$.earcutLinked(D$$.filterPoints(D$s,null),D$r,D$e,D$U,D$m,D$k,1);break}}},D$$.isEar=function(D$s){var D$r=D$s.prev,D$e=D$s,D$U=D$s.next;if(0<=D$$.area(D$r,D$e,D$U))return!1;for(var D$m=D$s.next.next;D$m!==D$s.prev;){if(D$$.pointInTriangle(D$r.x,D$r.y,D$e.x,D$e.y,D$U.x,D$U.y,D$m.x,D$m.y)&&0<=D$$.area(D$m.prev,D$m,D$m.next))return!1;D$m=D$m.next}return!0},D$$.isEarHashed=function(D$s,D$r,D$e,D$U){var D$m=D$s.prev,D$k=D$s,D$j=D$s.next;if(0<=D$$.area(D$m,D$k,D$j))return!1;for(var D$T=D$m.x<D$k.x?D$m.x<D$j.x?D$m.x:D$j.x:D$k.x<D$j.x?D$k.x:D$j.x,D$Y=D$m.y<D$k.y?D$m.y<D$j.y?D$m.y:D$j.y:D$k.y<D$j.y?D$k.y:D$j.y,D$Z=D$m.x>D$k.x?D$m.x>D$j.x?D$m.x:D$j.x:D$k.x>D$j.x?D$k.x:D$j.x,D$h=D$m.y>D$k.y?D$m.y>D$j.y?D$m.y:D$j.y:D$k.y>D$j.y?D$k.y:D$j.y,D$H=D$$.zOrder(D$T,D$Y,D$r,D$e,D$U),D$A=D$$.zOrder(D$Z,D$h,D$r,D$e,D$U),D$x=D$s.nextZ;D$x&&D$x.z<=D$A;){if(D$x!==D$s.prev&&D$x!==D$s.next&&D$$.pointInTriangle(D$m.x,D$m.y,D$k.x,D$k.y,D$j.x,D$j.y,D$x.x,D$x.y)&&0<=D$$.area(D$x.prev,D$x,D$x.next))return!1;D$x=D$x.nextZ}for(D$x=D$s.prevZ;D$x&&D$x.z>=D$H;){if(D$x!==D$s.prev&&D$x!==D$s.next&&D$$.pointInTriangle(D$m.x,D$m.y,D$k.x,D$k.y,D$j.x,D$j.y,D$x.x,D$x.y)&&0<=D$$.area(D$x.prev,D$x,D$x.next))return!1;D$x=D$x.prevZ}return!0},D$$.cureLocalIntersections=function(D$s,D$r,D$e){var D$U=D$s;do{var D$m=D$U.prev,D$k=D$U.next.next;!D$$.equals(D$m,D$k)&&D$$.intersects(D$m,D$U,D$U.next,D$k)&&D$$.locallyInside(D$m,D$k)&&D$$.locallyInside(D$k,D$m)&&(D$r.push(D$m.i/D$e),D$r.push(D$U.i/D$e),D$r.push(D$k.i/D$e),D$$.removeNode(D$U),D$$.removeNode(D$U.next),D$U=D$s=D$k),D$U=D$U.next}while(D$U!==D$s);return D$U},D$$.splitEarcut=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$s;do{for(var D$T=D$j.next.next;D$T!==D$j.prev;){if(D$j.i!==D$T.i&&D$$.isValidDiagonal(D$j,D$T)){var D$Y=D$$.splitPolygon(D$j,D$T);return D$j=D$$.filterPoints(D$j,D$j.next),D$Y=D$$.filterPoints(D$Y,D$Y.next),D$$.earcutLinked(D$j,D$r,D$e,D$U,D$m,D$k),void D$$.earcutLinked(D$Y,D$r,D$e,D$U,D$m,D$k)}D$T=D$T.next}D$j=D$j.next}while(D$j!==D$s)},D$$.eliminateHoles=function(D$s,D$r,D$e,D$U){var D$m,D$k,D$j,D$T,D$Y,D$Z=[];for(D$m=0,D$k=D$r.length;D$m<D$k;D$m++)D$j=D$r[D$m]*D$U,D$T=D$m<D$k-1?D$r[D$m+1]*D$U:D$s.length,(D$Y=D$$.linkedList(D$s,D$j,D$T,D$U,!1))===D$Y.next&&(D$Y.steiner=!0),D$Z.push(D$$.getLeftmost(D$Y));for(D$Z.sort(D$$.compareX),D$m=0;D$m<D$Z.length;D$m++)D$$.eliminateHole(D$Z[D$m],D$e),D$e=D$$.filterPoints(D$e,D$e.next);return D$e},D$$.compareX=function(D$s,D$r){return D$s.x-D$r.x},D$$.eliminateHole=function(D$s,D$r){if(D$r=D$$.findHoleBridge(D$s,D$r)){var D$e=D$$.splitPolygon(D$r,D$s);D$$.filterPoints(D$e,D$e.next)}},D$$.findHoleBridge=function(D$s,D$r){var D$e,D$U=D$r,D$m=D$s.x,D$k=D$s.y,D$j=-1/0;do{if(D$k<=D$U.y&&D$k>=D$U.next.y&&D$U.next.y!==D$U.y){var D$T=D$U.x+(D$k-D$U.y)*(D$U.next.x-D$U.x)/(D$U.next.y-D$U.y);if(D$T<=D$m&&D$j<D$T){if((D$j=D$T)===D$m){if(D$k===D$U.y)return D$U;if(D$k===D$U.next.y)return D$U.next}D$e=D$U.x<D$U.next.x?D$U:D$U.next}}D$U=D$U.next}while(D$U!==D$r);if(!D$e)return null;if(D$m===D$j)return D$e.prev;var D$Y,D$Z=D$e,D$h=D$e.x,D$H=D$e.y,D$A=1/0;for(D$U=D$e.next;D$U!==D$Z;)D$m>=D$U.x&&D$U.x>=D$h&&D$m!==D$U.x&&D$$.pointInTriangle(D$k<D$H?D$m:D$j,D$k,D$h,D$H,D$k<D$H?D$j:D$m,D$k,D$U.x,D$U.y)&&((D$Y=Math.abs(D$k-D$U.y)/(D$m-D$U.x))<D$A||D$Y===D$A&&D$U.x>D$e.x)&&D$$.locallyInside(D$U,D$s)&&(D$e=D$U,D$A=D$Y),D$U=D$U.next;return D$e},D$$.indexCurve=function(D$s,D$r,D$e,D$U){for(var D$m=D$s;null===D$m.z&&(D$m.z=D$$.zOrder(D$m.x,D$m.y,D$r,D$e,D$U)),D$m.prevZ=D$m.prev,D$m.nextZ=D$m.next,(D$m=D$m.next)!==D$s;);D$m.prevZ.nextZ=null,D$m.prevZ=null,D$$.sortLinked(D$m)},D$$.sortLinked=function(D$s){var D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z=1;do{for(D$e=D$s,D$k=D$s=null,D$j=0;D$e;){for(D$j++,D$U=D$e,D$r=D$T=0;D$r<D$Z&&(D$T++,D$U=D$U.nextZ);D$r++);for(D$Y=D$Z;0<D$T||0<D$Y&&D$U;)0!==D$T&&(0===D$Y||!D$U||D$e.z<=D$U.z)?(D$e=(D$m=D$e).nextZ,D$T--):(D$U=(D$m=D$U).nextZ,D$Y--),D$k?D$k.nextZ=D$m:D$s=D$m,D$m.prevZ=D$k,D$k=D$m;D$e=D$U}D$k.nextZ=null,D$Z*=2}while(1<D$j);return D$s},D$$.zOrder=function(D$s,D$r,D$e,D$U,D$m){return(D$s=1431655765&((D$s=858993459&((D$s=252645135&((D$s=16711935&((D$s=32767*(D$s-D$e)*D$m)|D$s<<8))|D$s<<4))|D$s<<2))|D$s<<1))|(D$r=1431655765&((D$r=858993459&((D$r=252645135&((D$r=16711935&((D$r=32767*(D$r-D$U)*D$m)|D$r<<8))|D$r<<4))|D$r<<2))|D$r<<1))<<1},D$$.getLeftmost=function(D$s){for(var D$r=D$s,D$e=D$s;D$r.x<D$e.x&&(D$e=D$r),(D$r=D$r.next)!==D$s;);return D$e},D$$.pointInTriangle=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){return 0<=(D$m-D$j)*(D$r-D$T)-(D$s-D$j)*(D$k-D$T)&&0<=(D$s-D$j)*(D$U-D$T)-(D$e-D$j)*(D$r-D$T)&&0<=(D$e-D$j)*(D$k-D$T)-(D$m-D$j)*(D$U-D$T)},D$$.isValidDiagonal=function(D$s,D$r){return D$s.next.i!==D$r.i&&D$s.prev.i!==D$r.i&&!D$$.intersectsPolygon(D$s,D$r)&&D$$.locallyInside(D$s,D$r)&&D$$.locallyInside(D$r,D$s)&&D$$.middleInside(D$s,D$r)},D$$.area=function(D$s,D$r,D$e){return(D$r.y-D$s.y)*(D$e.x-D$r.x)-(D$r.x-D$s.x)*(D$e.y-D$r.y)},D$$.equals=function(D$s,D$r){return D$s.x===D$r.x&&D$s.y===D$r.y},D$$.intersects=function(D$s,D$r,D$e,D$U){return!!(D$$.equals(D$s,D$r)&&D$$.equals(D$e,D$U)||D$$.equals(D$s,D$U)&&D$$.equals(D$e,D$r))||0<D$$.area(D$s,D$r,D$e)!=0<D$$.area(D$s,D$r,D$U)&&0<D$$.area(D$e,D$U,D$s)!=0<D$$.area(D$e,D$U,D$r)},D$$.intersectsPolygon=function(D$s,D$r){var D$e=D$s;do{if(D$e.i!==D$s.i&&D$e.next.i!==D$s.i&&D$e.i!==D$r.i&&D$e.next.i!==D$r.i&&D$$.intersects(D$e,D$e.next,D$s,D$r))return!0;D$e=D$e.next}while(D$e!==D$s);return!1},D$$.locallyInside=function(D$s,D$r){return D$$.area(D$s.prev,D$s,D$s.next)<0?0<=D$$.area(D$s,D$r,D$s.next)&&0<=D$$.area(D$s,D$s.prev,D$r):D$$.area(D$s,D$r,D$s.prev)<0||D$$.area(D$s,D$s.next,D$r)<0},D$$.middleInside=function(D$s,D$r){for(var D$e=D$s,D$U=!1,D$m=(D$s.x+D$r.x)/2,D$k=(D$s.y+D$r.y)/2;D$e.y>D$k!=D$e.next.y>D$k&&D$e.next.y!==D$e.y&&D$m<(D$e.next.x-D$e.x)*(D$k-D$e.y)/(D$e.next.y-D$e.y)+D$e.x&&(D$U=!D$U),(D$e=D$e.next)!==D$s;);return D$U},D$$.splitPolygon=function(D$s,D$r){var D$e=new D$ms(D$s.i,D$s.x,D$s.y),D$U=new D$ms(D$r.i,D$r.x,D$r.y),D$m=D$s.next,D$k=D$r.prev;return(D$s.next=D$r).prev=D$s,(D$e.next=D$m).prev=D$e,(D$U.next=D$e).prev=D$U,(D$k.next=D$U).prev=D$k,D$U},D$$.insertNode=function(D$s,D$r,D$e,D$U){var D$m=new D$ms(D$s,D$r,D$e);return D$U?(D$m.next=D$U.next,(D$m.prev=D$U).next.prev=D$m,D$U.next=D$m):(D$m.prev=D$m).next=D$m,D$m},D$$.removeNode=function(D$s){D$s.next.prev=D$s.prev,D$s.prev.next=D$s.next,D$s.prevZ&&(D$s.prevZ.nextZ=D$s.nextZ),D$s.nextZ&&(D$s.nextZ.prevZ=D$s.prevZ)},D$$.signedArea=function(D$s,D$r,D$e,D$U){for(var D$m=0,D$k=D$r,D$j=D$e-D$U;D$k<D$e;D$k+=D$U)D$m+=(D$s[D$j]-D$s[D$k])*(D$s[D$k+1]+D$s[D$j+1]),D$j=D$k;return D$m},D$$}(),D$ms=function(){function D$s(D$s,D$r,D$e){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=D$s,this.x=D$r,this.y=D$e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return D$A(D$s,"laya.webgl.shapes.EarcutNode"),D$s}(),D$ks=(function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this.lineWidth=D$s,this.lineColor=D$r,this.lineAlpha=D$e,this.fillColor=D$U,this.fillAlpha=D$m,this.shape=D$j,this.fill=D$k}D$A(D$s,"laya.webgl.shapes.GeometryData");var D$r=D$s.prototype;D$r.clone=function(){return new D$s(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},D$r.getIndexData=function(){return null},D$r.getVertexData=function(){return null},D$r.destroy=function(){this.shape=null}}(),function(){function D$s(D$s){if(D$s instanceof Float32Array)this.points=D$s;else if(D$s instanceof Array){D$s.length;this.points=new Float32Array(D$s)}}D$A(D$s,"laya.webgl.shapes.Vertex");var D$r=D$s.prototype;D$X.imps(D$r,{"laya.webgl.shapes.IShape":!0}),D$r.getData=function(D$s,D$r,D$e){},D$r.needUpdate=function(D$s){return!1},D$r.rebuild=function(D$s){},D$r.setMatrix=function(D$s){}}(),function(){function D$Y(D$s){void 0===D$s&&(D$s=1e4),this._renderType=D$s}D$A(D$Y,"laya.webgl.submit.Submit");var D$s=D$Y.prototype;return D$X.imps(D$s,{"laya.webgl.submit.ISubmit":!0}),D$s.releaseRender=function(){var D$s=D$Y._cache;(D$s[D$s._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},D$s.getRenderType=function(){return this._renderType},D$s.renderSubmit=function(){if(0===this._numEle)return 1;var D$s=this.shaderValue.textureHost;if(D$s){var D$r=D$s.source;if(!D$s.bitmap||!D$r)return 1;this.shaderValue.texture=D$r,D$s.alphaTexture&&D$s.alphaTexture.source&&(this.shaderValue.texture1=D$s.alphaTexture.source)}this._vb.bind_upload(this._ib);var D$e=D$Is.mainContext;return this.shaderValue.upload(),D$p.activeBlendFunction!==this._blendFn&&(D$e.enable(3042),this._blendFn(D$e),D$p.activeBlendFunction=this._blendFn),D$O.drawCall++,D$O.trianglesFaces+=this._numEle/3,D$e.drawElements(4,this._numEle,5123,this._startIdx),1},D$Y.__init__=function(){var D$s=D$Y.RENDERBASE=new D$Y(-1);D$s.shaderValue=new D$ns(0,0),D$s.shaderValue.ALPHA=-1234},D$Y.createSubmit=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$Y._cache._length?D$Y._cache[--D$Y._cache._length]:new D$Y;null==D$e&&((D$e=D$k._selfVb||(D$k._selfVb=D$Fs.create(-1))).clear(),D$U=0),D$k._ib=D$r,D$k._vb=D$e,D$k._startIdx=D$U*D$$s.BYTES_PIDX,D$k._numEle=0;var D$j=D$s._nBlendType;D$k._blendFn=D$s._targets?D$p.targetFns[D$j]:D$p.fns[D$j],D$k.shaderValue=D$m,D$k.shaderValue.setValue(D$s._shader2D);var D$T=D$s._shader2D.filters;return D$T&&D$k.shaderValue.setFilters(D$T),D$k},D$Y.createShape=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$Y._cache._length?D$Y._cache[--D$Y._cache._length]:new D$Y;D$j._ib=D$r,D$j._vb=D$e,D$j._numEle=D$U,D$j._startIdx=D$m,D$j.shaderValue=D$k,D$j.shaderValue.setValue(D$s._shader2D);var D$T=D$s._nBlendType;return D$j._blendFn=D$s._targets?D$p.targetFns[D$T]:D$p.fns[D$T],D$j},D$Y.TYPE_2D=1e4,D$Y.TYPE_CANVAS=10003,D$Y.TYPE_CMDSETRT=10004,D$Y.TYPE_CUSTOM=10005,D$Y.TYPE_BLURRT=10006,D$Y.TYPE_CMDDESTORYPRERT=10007,D$Y.TYPE_DISABLESTENCIL=10008,D$Y.TYPE_OTHERIBVB=10009,D$Y.TYPE_PRIMITIVE=10010,D$Y.TYPE_RT=10011,D$Y.TYPE_BLUR_RT=10012,D$Y.TYPE_TARGET=10013,D$Y.TYPE_CHANGE_VALUE=10014,D$Y.TYPE_SHAPE=10015,D$Y.TYPE_TEXTURE=10016,D$Y.TYPE_FILLTEXTURE=10017,D$Y.RENDERBASE=null,D$Y._cache=((D$Y._cache=[])._length=0,D$Y._cache),D$Y}()),D$js=function(){function D$U(){this.fun=null,this.args=null}D$A(D$U,"laya.webgl.submit.SubmitCMD");var D$s=D$U.prototype;return D$X.imps(D$s,{"laya.webgl.submit.ISubmit":!0}),D$s.renderSubmit=function(){return this.fun.apply(null,this.args),1},D$s.getRenderType=function(){return 0},D$s.releaseRender=function(){var D$s=D$U._cache;D$s[D$s._length++]=this},D$U.create=function(D$s,D$r){var D$e=D$U._cache._length?D$U._cache[--D$U._cache._length]:new D$U;return D$e.fun=D$r,D$e.args=D$s,D$e},D$U._cache=((D$U._cache=[])._length=0,D$U._cache),D$U}(),D$Ts=function(){function D$r(){this.variables={}}D$A(D$r,"laya.webgl.submit.SubmitCMDScope");var D$s=D$r.prototype;return D$s.getValue=function(D$s){return this.variables[D$s]},D$s.addValue=function(D$s,D$r){return this.variables[D$s]=D$r},D$s.setValue=function(D$s,D$r){return this.variables.hasOwnProperty(D$s)?this.variables[D$s]=D$r:null},D$s.clear=function(){for(var D$s in this.variables)delete this.variables[D$s]},D$s.recycle=function(){this.clear(),D$r.POOL.push(this)},D$r.create=function(){var D$s=D$r.POOL.pop();return D$s||(D$s=new D$r),D$s},D$r.POOL=[],D$r}(),D$Ys=function(){function D$H(){this.offset=0,this.startIndex=0,this._mat=D$y.create()}D$A(D$H,"laya.webgl.submit.SubmitOtherIBVB");var D$s=D$H.prototype;return D$X.imps(D$s,{"laya.webgl.submit.ISubmit":!0}),D$s.releaseRender=function(){var D$s=D$H._cache;(D$s[D$s._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},D$s.getRenderType=function(){return 10009},D$s.renderSubmit=function(){var D$s=this._shaderValue.textureHost;if(D$s){var D$r=D$s.source;if(!D$s.bitmap||!D$r)return 1;this._shaderValue.texture=D$r}this._vb.bind_upload(this._ib);var D$e=D$bs.worldMatrix4,D$U=D$y.TEMP;D$y.mulPre(this._mat,D$e[0],D$e[1],D$e[4],D$e[5],D$e[12],D$e[13],D$U);var D$m=D$bs.worldMatrix4=D$H.tempMatrix4;D$m[0]=D$U.a,D$m[1]=D$U.b,D$m[4]=D$U.c,D$m[5]=D$U.d,D$m[12]=D$U.tx,D$m[13]=D$U.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var D$k=D$Is.mainContext;return D$p.activeBlendFunction!==this._blendFn&&(D$k.enable(3042),this._blendFn(D$k),D$p.activeBlendFunction=this._blendFn),D$O.drawCall++,D$O.trianglesFaces+=this._numEle/3,D$k.drawElements(4,this._numEle,5123,this.startIndex),D$bs.worldMatrix4=D$e,D$vs.activeShader=null,1},D$H.create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){void 0===D$Y&&(D$Y=0);var D$Z=D$H._cache._length?D$H._cache[--D$H._cache._length]:new D$H;D$Z._ib=D$e,D$Z._vb=D$r,D$Z._numEle=D$U,D$Z._shader=D$m,D$Z._shaderValue=D$k;var D$h=D$s._nBlendType;switch(D$Z._blendFn=D$s._targets?D$p.targetFns[D$h]:D$p.fns[D$h],D$Y){case 0:D$Z.offset=0,D$Z.startIndex=D$T/(D$$s.BYTES_PE*D$r.vertexStride)*1.5,D$Z.startIndex*=D$$s.BYTES_PIDX;break;case 1:D$Z.startIndex=D$j,D$Z.offset=D$T}return D$Z},D$H._cache=((D$H._cache=[])._length=0,D$H._cache),D$H.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D$H}(),D$Zs=function(){function D$e(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new D$f,this.screenRect=new D$f}D$A(D$e,"laya.webgl.submit.SubmitScissor");var D$s=D$e.prototype;return D$X.imps(D$s,{"laya.webgl.submit.ISubmit":!0}),D$s._scissor=function(D$s,D$r,D$e,D$U){var D$m=D$bs.worldMatrix4,D$k=D$m[0],D$j=D$m[5],D$T=D$m[12],D$Y=D$m[13];if(D$U*=D$j,(D$e*=D$k)<1||D$U<1)return!1;var D$Z=(D$s=D$s*D$k+D$T)+D$e,D$h=(D$r=D$r*D$j+D$Y)+D$U;D$s<0&&(D$e=D$Z-(D$s=0)),D$r<0&&(D$U=D$h-(D$r=0));var D$H=D$bs.worldClipRect;if(D$s=Math.max(D$s,D$H.x),D$r=Math.max(D$r,D$H.y),D$e=Math.min(D$Z,D$H.right)-D$s,D$U=Math.min(D$h,D$H.bottom)-D$r,D$e<1||D$U<1)return!1;var D$A=D$bs.worldScissorTest;return this.screenRect.copyFrom(D$H),D$H.x=D$s,D$H.y=D$r,D$H.width=D$e,D$H.height=D$U,D$bs.worldScissorTest=!0,D$r=D$bs.height-D$r-D$U,D$Is.mainContext.scissor(D$s,D$r,D$e,D$U),D$Is.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),D$A?(D$r=D$bs.height-this.screenRect.y-this.screenRect.height,D$Is.mainContext.scissor(this.screenRect.x,D$r,this.screenRect.width,this.screenRect.height),D$Is.mainContext.enable(3089)):(D$Is.mainContext.disable(3089),D$bs.worldScissorTest=!1),D$H.copyFrom(this.screenRect),!0},D$s._scissorWithTagart=function(D$s,D$r,D$e,D$U){if(D$e<1||D$U<1)return!1;var D$m=D$s+D$e,D$k=D$r+D$U;D$s<0&&(D$e=D$m-(D$s=0)),D$r<0&&(D$U=D$k-(D$r=0));var D$j=D$bs.worldClipRect;if(D$s=Math.max(D$s,D$j.x),D$r=Math.max(D$r,D$j.y),D$e=Math.min(D$m,D$j.right)-D$s,D$U=Math.min(D$k,D$j.bottom)-D$r,D$e<1||D$U<1)return!1;var D$T=D$bs.worldScissorTest;return this.screenRect.copyFrom(D$j),D$bs.worldScissorTest=!0,D$j.x=D$s,D$j.y=D$r,D$j.width=D$e,D$j.height=D$U,D$r=D$bs.height-D$r-D$U,D$Is.mainContext.scissor(D$s,D$r,D$e,D$U),D$Is.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),D$T?(D$r=D$bs.height-this.screenRect.y-this.screenRect.height,D$Is.mainContext.scissor(this.screenRect.x,D$r,this.screenRect.width,this.screenRect.height),D$Is.mainContext.enable(3089)):(D$Is.mainContext.disable(3089),D$bs.worldScissorTest=!1),D$j.copyFrom(this.screenRect),!0},D$s.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},D$s.getRenderType=function(){return 0},D$s.releaseRender=function(){var D$s=D$e._cache;(D$s[D$s._length++]=this).context=null},D$e.create=function(D$s){var D$r=D$e._cache._length?D$e._cache[--D$e._cache._length]:new D$e;return D$r.context=D$s,D$r},D$e._cache=((D$e._cache=[])._length=0,D$e._cache),D$e}(),D$hs=function(){function D$Y(){this.step=0,this.blendMode=null,this.level=0}D$A(D$Y,"laya.webgl.submit.SubmitStencil");var D$s=D$Y.prototype;return D$X.imps(D$s,{"laya.webgl.submit.ISubmit":!0}),D$s.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},D$s.getRenderType=function(){return 0},D$s.releaseRender=function(){var D$s=D$Y._cache;D$s[D$s._length++]=this},D$s.do1=function(){var D$s=D$Is.mainContext;D$s.enable(2960),D$s.clear(1024),D$s.colorMask(!1,!1,!1,!1),D$s.stencilFunc(514,this.level,255),D$s.stencilOp(7680,7680,7682)},D$s.do2=function(){var D$s=D$Is.mainContext;D$s.stencilFunc(514,this.level+1,255),D$s.colorMask(!0,!0,!0,!0),D$s.stencilOp(7680,7680,7680)},D$s.do3=function(){var D$s=D$Is.mainContext;D$s.colorMask(!0,!0,!0,!0),D$s.stencilOp(7680,7680,7680),D$s.clear(1024),D$s.disable(2960)},D$s.do4=function(){var D$s=D$Is.mainContext;0==this.level&&(D$s.enable(2960),D$s.clear(1024)),D$s.colorMask(!1,!1,!1,!1),D$s.stencilFunc(519,0,255),D$s.stencilOp(7680,7680,7682)},D$s.do5=function(){var D$s=D$Is.mainContext;D$s.stencilFunc(514,this.level,255),D$s.colorMask(!0,!0,!0,!0),D$s.stencilOp(7680,7680,7680)},D$s.do6=function(){var D$s=D$Is.mainContext;D$p.targetFns[D$p.TOINT[this.blendMode]](D$s)},D$s.do7=function(){var D$s=D$Is.mainContext;D$s.colorMask(!1,!1,!1,!1),D$s.stencilOp(7680,7680,7683)},D$s.do8=function(){var D$s=D$Is.mainContext;D$s.colorMask(!0,!0,!0,!0),D$s.stencilFunc(514,this.level,255),D$s.stencilOp(7680,7680,7680)},D$Y.restore=function(D$s,D$r,D$e,D$U,D$m){var D$k;if((D$s._renderKey=0)<D$Y._mask&&D$Y._mask--,0==D$Y._mask)D$k=laya.webgl.submit.SubmitStencil.create(3),D$s.addRenderObject(D$k),D$s._curSubmit=D$ks.RENDERBASE;else{D$k=laya.webgl.submit.SubmitStencil.create(7),D$s.addRenderObject(D$k);var D$j=D$s._vb;D$j._byteLength;if(D$ls.fillRectImgVb(D$j,null,D$r.x,D$r.y,D$r.width,D$r.height,D$E.DEF_UV,D$e,D$U,D$m,0,0)){D$s._shader2D.glTexture=null;var D$T=D$s._curSubmit=D$ks.createSubmit(D$s,D$s._ib,D$j,(D$j._byteLength-64)/32*3,D$ns.create(2,0));D$T.shaderValue.ALPHA=1,D$s._submits[D$s._submits._length++]=D$T,D$s._curSubmit._numEle+=6,D$s._curSubmit=D$ks.RENDERBASE}else alert("clipRect calc stencil rect error");D$k=laya.webgl.submit.SubmitStencil.create(8),D$s.addRenderObject(D$k)}},D$Y.restore2=function(D$s,D$r){var D$e;(D$s._renderKey=0)<D$Y._mask&&D$Y._mask--,0==D$Y._mask?(D$e=laya.webgl.submit.SubmitStencil.create(3),D$s.addRenderObject(D$e),D$s._curSubmit=D$ks.RENDERBASE):(D$e=laya.webgl.submit.SubmitStencil.create(7),D$s.addRenderObject(D$e),D$s._submits[D$s._submits._length++]=D$r,D$e=laya.webgl.submit.SubmitStencil.create(8),D$s.addRenderObject(D$e))},D$Y.create=function(D$s){var D$r=D$Y._cache._length?D$Y._cache[--D$Y._cache._length]:new D$Y;return 5==(D$r.step=D$s)&&++D$Y._mask,D$r.level=D$Y._mask,D$r},D$Y._cache=((D$Y._cache=[])._length=0,D$Y._cache),D$Y._mask=0,D$Y}(),D$Hs=function(){function D$T(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}D$A(D$T,"laya.webgl.submit.SubmitTarget");var D$s=D$T.prototype;return D$X.imps(D$s,{"laya.webgl.submit.ISubmit":!0}),D$s.renderSubmit=function(){this._vb.bind_upload(this._ib);var D$s=this.scope.getValue(this.proName);return D$s&&(this.shaderValue.texture=D$s.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[D$s.width,D$s.height]),this.shaderValue.upload(),this.blend(),D$O.drawCall++,D$O.trianglesFaces+=this._numEle/3,D$Is.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},D$s.blend=function(){if(D$p.activeBlendFunction!==D$p.fns[this.blendType]){var D$s=D$Is.mainContext;D$s.enable(3042),D$p.fns[this.blendType](D$s),D$p.activeBlendFunction=D$p.fns[this.blendType]}},D$s.getRenderType=function(){return 0},D$s.releaseRender=function(){var D$s=D$T._cache;(D$s[D$s._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},D$T.create=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$T._cache._length?D$T._cache[--D$T._cache._length]:new D$T;return D$j._ib=D$r,D$j._vb=D$e,D$j.proName=D$k,D$j._startIdx=D$U*D$$s.BYTES_PIDX,D$j._numEle=0,D$j.blendType=D$s._nBlendType,D$j.shaderValue=D$m,D$j.shaderValue.setValue(D$s._shader2D),D$j},D$T._cache=((D$T._cache=[])._length=0,D$T._cache),D$T}(),D$As=function(){function D$s(){this._sourceStr=null}D$A(D$s,"laya.webgl.text.CharSegment");var D$r=D$s.prototype;return D$X.imps(D$r,{"laya.webgl.text.ICharSegment":!0}),D$r.textToSpit=function(D$s){this._sourceStr=D$s},D$r.getChar=function(D$s){return this._sourceStr.charAt(D$s)},D$r.getCharCode=function(D$s){return this._sourceStr.charCodeAt(D$s)},D$r.length=function(){return this._sourceStr.length},D$s}(),D$xs=function(){var D$s;function D$O(){}return D$A(D$O,"laya.webgl.text.DrawText"),D$O.__init__=function(){D$O._charsTemp=new Array,D$O._drawValue=new D$s,D$O._charSeg=new D$As},D$O.customCharSeg=function(D$s){D$O._charSeg=D$s},D$O.getChar=function(D$s,D$r,D$e){var D$U=D$Gs.createOneChar(D$s,D$e);return-1!=D$r&&(D$O._charsCache[D$r]=D$U),D$U},D$O._drawSlow=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H,D$A,D$x,D$B){var D$$,D$l,D$V=D$O._drawValue.value(D$k,D$T,D$Y,D$Z,D$A,D$x,D$B),D$b=0,D$o=0,D$I=D$O._charsTemp,D$w=0,D$X=NaN;if(D$U)for(D$I.length=D$U.length,D$b=0,D$o=D$U.length;D$b<D$o;D$b++)(D$l=D$U[D$b])&&(D$X=D$l.charNum+D$V.txtID,D$I[D$b]=D$$=D$O._charsCache[D$X]||D$O.getChar(D$l.char,D$X,D$V),D$$.active());else{var D$D=D$e instanceof laya.utils.WordText?D$e.toString():D$e;if(D$c.CharacterCache){D$O._charSeg.textToSpit(D$D);var D$n=D$O._charSeg.length();for(D$b=0,D$o=D$I.length=D$n;D$b<D$o;D$b++)D$X=D$O._charSeg.getCharCode(D$b)+D$V.txtID,D$I[D$b]=D$$=D$O._charsCache[D$X]||D$O.getChar(D$O._charSeg.getChar(D$b),D$X,D$V),D$$.active(),D$w+=D$$.cw}else D$I.length=0,(D$$=D$O.getChar(D$D,-1,D$V)).active(),D$w+=D$$.cw,D$I[0]=D$$}var D$y=0;null!==D$j&&"left"!==D$j&&(D$y=-("center"==D$j?D$w/2:D$w));var D$g,D$f,D$J=NaN,D$P=0;if(D$U)for(D$b=0,D$o=D$I.length;D$b<D$o;D$b++)D$$=D$I[D$b],D$l=D$U[D$b],D$$&&D$l&&!D$$.isSpace&&(D$J=D$$.borderSize,D$g=D$$.texture,D$r._drawText(D$g,D$h+D$y+D$l.x*D$A-D$J,D$H+D$l.y*D$x-D$J,D$g.width,D$g.height,D$m,0,0,0,0));else{for(D$b=0,D$o=D$I.length;D$b<D$o;D$b++)(D$$=D$I[D$b])&&!D$$.isSpace&&(D$J=D$$.borderSize,D$g=D$$.texture,D$r._drawText(D$g,D$h+D$y-D$J,D$H-D$J,D$g.width,D$g.height,D$m,0,0,0,0),D$s&&((D$f=D$s[D$P++])||(D$f=D$s[D$P-1]=[]),D$f[0]=D$g,D$f[1]=D$y-D$J,D$f[2]=-D$J)),D$y+=D$$.cw;D$s&&(D$s.length=D$P)}},D$O._drawFast=function(D$s,D$r,D$e,D$U,D$m){for(var D$k,D$j,D$T=0,D$Y=D$s.length;D$T<D$Y;D$T++)(D$k=(D$j=D$s[D$T])[0]).active(),D$r._drawText(D$k,D$U+D$j[1],D$m+D$j[2],D$k.width,D$k.height,D$e,0,0,0,0)},D$O.drawText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H){if(void 0===D$H&&(D$H=0),!(D$r&&0===D$r.length||D$e&&0===D$e.length)){var D$A=D$U.a,D$x=D$U.d;(0!==D$U.b||0!==D$U.c)&&(D$A=D$x=1);var D$B=1!==D$A||1!==D$x;if(D$B&&D$X.stage.transform){var D$$=D$X.stage.transform;D$B=D$$.a===D$A&&D$$.d===D$x}else D$B=!1;if(D$B){var D$l=(D$U=D$U.copyTo(D$Ds._tmpMatrix)).tx,D$V=D$U.ty;D$U.scale(1/D$A,1/D$x),D$U._checkTransform(),D$Z*=D$A,D$h*=D$x,D$Z+=D$l-D$U.tx,D$h+=D$V-D$U.ty}else D$A=D$x=1;if(D$e)D$O._drawSlow(null,D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$A,D$x,D$H);else{if(null===D$r.toUpperCase){var D$b=D$A+1e5*D$x,D$o=D$r;return void(D$o.changed||D$o.id!==D$b?(D$o.id=D$b,D$o.changed=!1,D$O._drawSlow(D$o.save,D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$A,D$x,D$H)):D$O._drawFast(D$o.save,D$s,D$U,D$Z,D$h))}var D$I=D$r+D$m.toString()+D$j+D$T+D$Y+D$A+D$x+D$k,D$w=D$O._textsCache[D$I];D$c.CharacterCache?D$w?D$O._drawFast(D$w,D$s,D$U,D$Z,D$h):(D$O._textsCache.__length||(D$O._textsCache.__length=0),D$O._textsCache.__length>D$D.WebGLTextCacheCount&&((D$O._textsCache={}).__length=0,D$O._curPoolIndex=0),D$O._textCachesPool[D$O._curPoolIndex]?(D$w=D$O._textsCache[D$I]=D$O._textCachesPool[D$O._curPoolIndex]).length=0:D$O._textCachesPool[D$O._curPoolIndex]=D$w=D$O._textsCache[D$I]=[],D$O._textsCache.__length++,D$O._curPoolIndex++,D$O._drawSlow(D$w,D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$A,D$x,D$H)):D$O._drawSlow(D$w,D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$A,D$x,D$H)}}},D$O._charsTemp=null,D$O._textCachesPool=[],D$O._curPoolIndex=0,D$O._charsCache={},D$O._textsCache={},D$O._drawValue=null,D$O.d=[],D$O._charSeg=null,D$O.__init$=function(){D$s=function(){function D$Y(){}return D$A(D$Y,""),D$Y.prototype.value=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this.font=D$s,this.fillColor=D$r,this.borderColor=D$e,this.lineWidth=D$U,this.scaleX=D$m,this.scaleY=D$k,this.underLine=D$j;var D$T=D$s.toString()+D$m+D$k+D$U+(D$r?D$r.toLowerCase():" ")+(D$e?D$e.toLowerCase():" ")+D$j;return this.txtID=D$Y._keymap[D$T],this.txtID||(this.txtID=1e-7*++D$Y._keymapCount,D$Y._keymap[D$T]=this.txtID),this},D$Y.clear=function(){D$Y._keymap={},D$Y._keymapCount=1},D$Y._keymap={},D$Y._keymapCount=1,D$Y}()},D$O}(),D$Bs=function(){function D$m(D$s){this._index=0,this._size=14,this._italic=-2,D$m._cache2=D$m._cache2||[],this.setFont(D$s||"14px Arial")}D$A(D$m,"laya.webgl.text.FontInContext");var D$s=D$m.prototype;return D$s.setFont=function(D$s){var D$r=D$m._cache2[D$s];if(D$r)this._words=D$r[0],this._size=D$r[1];else{this._words=D$s.split(" ");for(var D$e=0,D$U=this._words.length;D$e<D$U;D$e++)if(0<this._words[D$e].indexOf("px")){this._index=D$e;break}this._size=parseInt(this._words[this._index]),D$m._cache2[D$s]=[this._words,this._size]}this._text=null,this._italic=-2},D$s.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},D$s.hasType=function(D$s){for(var D$r=0,D$e=this._words.length;D$r<D$e;D$r++)if(this._words[D$r]===D$s)return D$r;return-1},D$s.removeType=function(D$s){for(var D$r=0,D$e=this._words.length;D$r<D$e;D$r++)if(this._words[D$r]===D$s){this._words.splice(D$r,1),this._index>D$r&&this._index--;break}this._text=null,this._italic=-2},D$s.copyTo=function(D$s){return D$s._text=this._text,D$s._size=this._size,D$s._index=this._index,D$s._words=this._words.slice(),D$s._italic=-2,D$s},D$s.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},D$U(0,D$s,"size",function(){return this._size},function(D$s){this._size=D$s,this._words[this._index]=D$s+"px",this._text=null}),D$m.create=function(D$s){var D$r=D$m._cache[D$s];return D$r||(D$r=D$m._cache[D$s]=new D$m(D$s))},D$m.EMPTY=new D$m,D$m._cache={},D$m._cache2=null,D$m}(),D$$s=function(){function D$s(){}return D$A(D$s,"laya.webgl.utils.CONST3D2D"),D$s.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D$s.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],D$s.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],D$s._TMPARRAY=[],D$s._OFFSETX=0,D$s._OFFSETY=0,D$j(D$s,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),D$s}(),D$ls=function(){function D$B(){}return D$A(D$B,"laya.webgl.utils.GlUtils"),D$B.make2DProjection=function(D$s,D$r,D$e){return[2/D$s,0,0,0,0,-2/D$r,0,0,0,0,2/D$e,0,-1,1,0,1]},D$B.fillIBQuadrangle=function(D$s,D$r){if(65535/4<D$r)throw Error("IBQuadrangle count:"+D$r+" must<:"+Math.floor(65535/4));D$r=Math.floor(D$r),D$s._resizeBuffer(6*(D$r+1)*2,!1),D$s.byteLength=D$s.bufferLength;for(var D$e=D$s.getUint16Array(),D$U=0,D$m=0;D$m<D$r;D$m++)D$e[D$U++]=4*D$m,D$e[D$U++]=4*D$m+2,D$e[D$U++]=4*D$m+1,D$e[D$U++]=4*D$m,D$e[D$U++]=4*D$m+3,D$e[D$U++]=4*D$m+2;return D$s.setNeedUpload(),!0},D$B.expandIBQuadrangle=function(D$s,D$r){D$s.bufferLength>=6*D$r*2||D$B.fillIBQuadrangle(D$s,D$r)},D$B.mathCeilPowerOfTwo=function(D$s){return D$s--,D$s|=D$s>>1,D$s|=D$s>>2,D$s|=D$s>>4,D$s|=D$s>>8,D$s|=D$s>>16,++D$s},D$B.fillQuadrangleImgVb=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){var D$Y=16+(D$s._byteLength>>2);D$s.byteLength=D$Y<<2;var D$Z=D$s.getFloat32Array();D$Z[(D$Y-=16)+2]=D$m[0],D$Z[D$Y+3]=D$m[1],D$Z[D$Y+6]=D$m[2],D$Z[D$Y+7]=D$m[3],D$Z[D$Y+10]=D$m[4],D$Z[D$Y+11]=D$m[5],D$Z[D$Y+14]=D$m[6],D$Z[D$Y+15]=D$m[7];var D$h=D$k.a,D$H=D$k.b,D$A=D$k.c,D$x=D$k.d;if(1!==D$h||0!==D$H||0!==D$A||1!==D$x){D$k.bTransform=!0;var D$B=D$k.tx+D$j,D$$=D$k.ty+D$T;D$Z[D$Y]=(D$U[0]+D$r)*D$h+(D$U[1]+D$e)*D$A+D$B,D$Z[D$Y+1]=(D$U[0]+D$r)*D$H+(D$U[1]+D$e)*D$x+D$$,D$Z[D$Y+4]=(D$U[2]+D$r)*D$h+(D$U[3]+D$e)*D$A+D$B,D$Z[D$Y+5]=(D$U[2]+D$r)*D$H+(D$U[3]+D$e)*D$x+D$$,D$Z[D$Y+8]=(D$U[4]+D$r)*D$h+(D$U[5]+D$e)*D$A+D$B,D$Z[D$Y+9]=(D$U[4]+D$r)*D$H+(D$U[5]+D$e)*D$x+D$$,D$Z[D$Y+12]=(D$U[6]+D$r)*D$h+(D$U[7]+D$e)*D$A+D$B,D$Z[D$Y+13]=(D$U[6]+D$r)*D$H+(D$U[7]+D$e)*D$x+D$$}else D$k.bTransform=!1,D$r+=D$k.tx+D$j,D$e+=D$k.ty+D$T,D$Z[D$Y]=D$r+D$U[0],D$Z[D$Y+1]=D$e+D$U[1],D$Z[D$Y+4]=D$r+D$U[2],D$Z[D$Y+5]=D$e+D$U[3],D$Z[D$Y+8]=D$r+D$U[4],D$Z[D$Y+9]=D$e+D$U[5],D$Z[D$Y+12]=D$r+D$U[6],D$Z[D$Y+13]=D$e+D$U[7];return D$s._upload=!0},D$B.fillTranglesVB=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){var D$T=(D$s._byteLength>>2)+D$U.length;D$s.byteLength=D$T<<2;var D$Y=D$s.getFloat32Array();D$T-=D$U.length;for(var D$Z=D$U.length,D$h=D$m.a,D$H=D$m.b,D$A=D$m.c,D$x=D$m.d,D$B=0;D$B<D$Z;D$B+=4)if(D$Y[D$T+D$B+2]=D$U[D$B+2],D$Y[D$T+D$B+3]=D$U[D$B+3],1!==D$h||0!==D$H||0!==D$A||1!==D$x){D$m.bTransform=!0;var D$$=D$m.tx+D$k,D$l=D$m.ty+D$j;D$Y[D$T+D$B]=(D$U[D$B]+D$r)*D$h+(D$U[D$B+1]+D$e)*D$A+D$$,D$Y[D$T+D$B+1]=(D$U[D$B]+D$r)*D$H+(D$U[D$B+1]+D$e)*D$x+D$l}else D$m.bTransform=!1,D$r+=D$m.tx+D$k,D$e+=D$m.ty+D$j,D$Y[D$T+D$B]=D$r+D$U[D$B],D$Y[D$T+D$B+1]=D$e+D$U[D$B+1];return D$s._upload=!0},D$B.copyPreImgVb=function(D$s,D$r,D$e){var D$U=D$s._byteLength>>2;D$s.byteLength=D$U+16<<2;for(var D$m=D$s.getFloat32Array(),D$k=0,D$j=D$U-16;D$k<4;D$k++)D$m[D$U]=D$m[D$j]+D$r,++D$j,D$m[++D$U]=D$m[D$j]+D$e,++D$j,D$m[++D$U]=D$m[D$j],++D$j,D$m[++D$U]=D$m[D$j],++D$U,++D$j;D$s._upload=!0},D$B.fillRectImgVb=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H,D$A){void 0===D$A&&(D$A=!1);var D$x,D$B,D$$,D$l,D$V,D$b,D$o,D$I,D$w,D$X,D$D,D$n,D$y,D$g,D$f,D$J,D$P=1,D$O=D$T.a,D$i=D$T.b,D$K=D$T.c,D$c=D$T.d,D$E=D$r&&D$r.width<99999999;if(1!==D$O||0!==D$i||0!==D$K||1!==D$c?(D$T.bTransform=!0,0===D$i&&0===D$K&&(D$P=23,D$w=D$m+D$e,D$X=D$k+D$U,D$x=D$O*D$e+(D$D=D$T.tx+D$Y),D$$=D$O*D$w+D$D,D$B=D$c*D$U+(D$n=D$T.ty+D$Z),D$l=D$c*D$X+D$n)):(D$P=23,D$T.bTransform=!1,D$$=(D$x=D$e+D$T.tx+D$Y)+D$m,D$l=(D$B=D$U+D$T.ty+D$Z)+D$k),D$E&&(D$V=D$r.x,D$b=D$r.y,D$o=D$r.width+D$V,D$I=D$r.height+D$b),1!==D$P){if(Math.min(D$x,D$$)>=D$o)return!1;if(Math.min(D$B,D$l)>=D$I)return!1;if(Math.max(D$$,D$x)<=D$V)return!1;if(Math.max(D$l,D$B)<=D$b)return!1}var D$v=D$s._byteLength>>2;D$s.byteLength=16+D$v<<2;var D$S=D$s.getFloat32Array();switch(D$S[2+D$v]=D$j[0],D$S[3+D$v]=D$j[1],D$S[6+D$v]=D$j[2],D$S[7+D$v]=D$j[3],D$S[10+D$v]=D$j[4],D$S[11+D$v]=D$j[5],D$S[14+D$v]=D$j[6],D$S[15+D$v]=D$j[7],D$P){case 1:D$D=D$T.tx+D$Y,D$n=D$T.ty+D$Z;var D$z=D$O*D$e,D$Q=D$K*D$U,D$C=D$c*D$U,D$R=D$i*D$e,D$a=D$O*(D$w=D$m+D$e),D$p=D$K*(D$X=D$k+D$U),D$N=D$c*D$X,D$q=D$i*D$w;D$A?(D$y=D$z+D$Q+D$D,D$f=Math.round(D$y)-D$y,D$g=D$C+D$R+D$n,D$J=Math.round(D$g)-D$g,D$S[D$v]=D$y+D$f,D$S[1+D$v]=D$g+D$J,D$S[4+D$v]=D$a+D$Q+D$D+D$f,D$S[5+D$v]=D$C+D$q+D$n+D$J,D$S[8+D$v]=D$a+D$p+D$D+D$f,D$S[9+D$v]=D$N+D$q+D$n+D$J,D$S[12+D$v]=D$z+D$p+D$D+D$f,D$S[13+D$v]=D$N+D$R+D$n+D$J):(D$S[D$v]=D$z+D$Q+D$D,D$S[1+D$v]=D$C+D$R+D$n,D$S[4+D$v]=D$a+D$Q+D$D,D$S[5+D$v]=D$C+D$q+D$n,D$S[8+D$v]=D$a+D$p+D$D,D$S[9+D$v]=D$N+D$q+D$n,D$S[12+D$v]=D$z+D$p+D$D,D$S[13+D$v]=D$N+D$R+D$n);break;case 23:D$A?(D$y=D$x+D$h,D$f=Math.round(D$y)-D$y,D$g=D$B,D$J=Math.round(D$g)-D$g,D$S[D$v]=D$y+D$f,D$S[1+D$v]=D$g+D$J,D$S[4+D$v]=D$$+D$h+D$f,D$S[5+D$v]=D$B+D$J,D$S[8+D$v]=D$$+D$f,D$S[9+D$v]=D$l+D$J,D$S[12+D$v]=D$x+D$f,D$S[13+D$v]=D$l+D$J):(D$S[D$v]=D$x+D$h,D$S[1+D$v]=D$B,D$S[4+D$v]=D$$+D$h,D$S[5+D$v]=D$B,D$S[8+D$v]=D$$,D$S[9+D$v]=D$l,D$S[12+D$v]=D$x,D$S[13+D$v]=D$l)}return D$s._upload=!0},D$B.fillLineVb=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){var D$Y=.5*D$j,D$Z=D$B._fillLineArray,D$h=-(D$U-D$k),D$H=D$e-D$m,D$A=Math.sqrt(D$h*D$h+D$H*D$H);D$h/=D$A,D$H/=D$A,D$h*=D$Y,D$H*=D$Y,D$Z[0]=D$e-D$h,D$Z[1]=D$U-D$H,D$Z[4]=D$e+D$h,D$Z[5]=D$U+D$H,D$Z[8]=D$m+D$h,D$Z[9]=D$k+D$H,D$Z[12]=D$m-D$h,D$Z[13]=D$k-D$H,D$T&&D$T.transformPointArray(D$Z,D$Z);var D$x=16+(D$s._byteLength>>2);return D$s.byteLength=D$x<<2,D$s.insertData(D$Z,D$x-16),!0},D$B._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D$B}(),D$Vs=(function(){function D$Y(){}D$A(D$Y,"laya.webgl.utils.MatirxArray"),D$Y.ArrayMul=function(D$s,D$r,D$e){if(D$s)if(D$r)for(var D$U=NaN,D$m=NaN,D$k=NaN,D$j=NaN,D$T=0;D$T<4;D$T++)D$U=D$s[D$T],D$m=D$s[D$T+4],D$k=D$s[D$T+8],D$j=D$s[D$T+12],D$e[D$T]=D$U*D$r[0]+D$m*D$r[1]+D$k*D$r[2]+D$j*D$r[3],D$e[D$T+4]=D$U*D$r[4]+D$m*D$r[5]+D$k*D$r[6]+D$j*D$r[7],D$e[D$T+8]=D$U*D$r[8]+D$m*D$r[9]+D$k*D$r[10]+D$j*D$r[11],D$e[D$T+12]=D$U*D$r[12]+D$m*D$r[13]+D$k*D$r[14]+D$j*D$r[15];else D$Y.copyArray(D$s,D$e);else D$Y.copyArray(D$r,D$e)},D$Y.copyArray=function(D$s,D$r){if(D$s&&D$r)for(var D$e=0;D$e<D$s.length;D$e++)D$r[D$e]=D$s[D$e]}}(),function(){function D$r(D$s,D$r,D$e){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=D$s,this._vb=new D$Fs(D$s,35048),D$r&&this._vb._resizeBuffer(D$r,!1),this._ib=new D$_s,D$e&&this._ib._resizeBuffer(D$e,!1)}D$A(D$r,"laya.webgl.utils.Mesh2D");var D$s=D$r.prototype;return D$s.cloneWithNewVB=function(){var D$s=new D$r(this._stride,0,0);return D$s._ib=this._ib,D$s._quadNum=this._quadNum,D$s._attribInfo=this._attribInfo,D$s},D$s.cloneWithNewVBIB=function(){var D$s=new D$r(this._stride,0,0);return D$s._attribInfo=this._attribInfo,D$s},D$s.getVBW=function(){return this._vb.setNeedUpload(),this._vb},D$s.getVBR=function(){return this._vb},D$s.getIBR=function(){return this._ib},D$s.getIBW=function(){return this._ib.setNeedUpload(),this._ib},D$s.createQuadIB=function(D$s){this._quadNum=D$s,this._ib._resizeBuffer(6*D$s*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var D$r=this._ib.getUint16Array(),D$e=0,D$U=0,D$m=0;D$m<D$s;D$m++)D$r[D$e++]=D$U,D$r[D$e++]=D$U+2,D$r[D$e++]=D$U+1,D$r[D$e++]=D$U,D$r[D$e++]=D$U+3,D$r[D$e++]=D$U+2,D$U+=4;this._ib.setNeedUpload()},D$s.setAttributes=function(D$s){if(this._attribInfo=D$s,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},D$s.getEleNum=function(){return this._ib.getBuffer().byteLength/2},D$s.releaseMesh=function(){},D$s.destroy=function(){},D$s.clearVB=function(){this._vb.clear()},D$r._gvaoid=0,D$r}()),D$bs=function(){function D$m(){}return D$A(D$m,"laya.webgl.utils.RenderState2D"),D$m.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},D$m.mat2MatArray=function(D$s,D$r){var D$e=D$s,D$U=D$r;return D$U[0]=D$e.a,D$U[1]=D$e.b,D$U[2]=D$m.EMPTYMAT4_ARRAY[2],D$U[3]=D$m.EMPTYMAT4_ARRAY[3],D$U[4]=D$e.c,D$U[5]=D$e.d,D$U[6]=D$m.EMPTYMAT4_ARRAY[6],D$U[7]=D$m.EMPTYMAT4_ARRAY[7],D$U[8]=D$m.EMPTYMAT4_ARRAY[8],D$U[9]=D$m.EMPTYMAT4_ARRAY[9],D$U[10]=D$m.EMPTYMAT4_ARRAY[10],D$U[11]=D$m.EMPTYMAT4_ARRAY[11],D$U[12]=D$e.tx,D$U[13]=D$e.ty,D$U[14]=D$m.EMPTYMAT4_ARRAY[14],D$U[15]=D$m.EMPTYMAT4_ARRAY[15],D$r},D$m.restoreTempArray=function(){D$m.TEMPMAT4_ARRAY[0]=1,D$m.TEMPMAT4_ARRAY[1]=0,D$m.TEMPMAT4_ARRAY[4]=0,D$m.TEMPMAT4_ARRAY[5]=1,D$m.TEMPMAT4_ARRAY[12]=0,D$m.TEMPMAT4_ARRAY[13]=0},D$m.clear=function(){D$m.worldScissorTest=!1,D$m.worldShaderDefines=null,D$m.worldFilters=null,D$m.worldAlpha=1,D$m.worldClipRect.x=D$m.worldClipRect.y=0,D$m.worldClipRect.width=D$m.width,D$m.worldClipRect.height=D$m.height,D$m.curRenderTarget=null},D$m._MAXSIZE=99999999,D$m.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D$m.worldMatrix4=D$m.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D$m.worldAlpha=1,D$m.worldScissorTest=!1,D$m.worldFilters=null,D$m.worldShaderDefines=null,D$m.curRenderTarget=null,D$m.width=0,D$m.height=0,D$j(D$m,["worldMatrix",function(){return this.worldMatrix=new D$y},"worldClipRect",function(){return this.worldClipRect=new D$f(0,0,99999999,99999999)}]),D$m}(),D$os=function(){var D$b,D$e;function D$o(D$s,D$r,D$e,D$U,D$m){var D$k=this;function D$j(D$s){var D$r=[],D$e=new D$b(D$r);return D$k._compileToTree(D$e,D$s.split("\n"),0,D$r,D$m),D$e}var D$T=D$x.now();this._VS=D$j(D$r),this._PS=D$j(D$e),this._nameMap=D$U,2<D$x.now()-D$T&&console.log("ShaderCompile use time:"+(D$x.now()-D$T)+"  size:"+D$r.length+"/"+D$e.length)}D$A(D$o,"laya.webgl.utils.ShaderCompile");var D$s=D$o.prototype;return D$s._compileToTree=function(D$s,D$r,D$e,D$U,D$m){var D$k,D$j,D$T,D$Y,D$Z,D$h,D$H,D$A=0,D$x=0,D$B=0,D$$=0;for(D$x=D$e;D$x<D$r.length;D$x++)if(!((D$T=D$r[D$x]).length<1)&&0!==(D$A=D$T.indexOf("//"))){if(0<=D$A&&(D$T=D$T.substr(0,D$A)),D$k=D$H||new D$b(D$U),D$H=null,D$k.text=D$T,D$k.noCompile=!0,0<=(D$A=D$T.indexOf("#"))){for(D$Y="#",D$$=D$A+1,D$B=D$T.length;D$$<D$B;D$$++){var D$l=D$T.charAt(D$$);if(" "===D$l||"\t"===D$l||"\r"===D$l||"\n"===D$l||"?"===D$l)break;D$Y+=D$l}switch(D$k.name=D$Y){case"#ifdef":case"#ifndef":if(D$k.src=D$T,D$k.noCompile=null!=D$T.match(/[!&|()=<>]/),D$k.noCompile?console.log("function():Boolean{return "+D$T.substr(D$A+D$k.name.length)+"}"):(D$h=D$T.replace(/^\s*/,"").split(/\s+/),D$k.setCondition(D$h[1],"#ifdef"===D$Y?1:2),D$k.text="//"+D$k.text),D$k.setParent(D$s),D$s=D$k,D$m)for(D$h=D$T.substr(D$$).split(D$o._splitToWordExps3),D$$=0;D$$<D$h.length;D$$++)(D$T=D$h[D$$]).length&&(D$m[D$T]=!0);continue;case"#if":if(D$k.src=D$T,D$k.noCompile=!0,D$k.setParent(D$s),D$s=D$k,D$m)for(D$h=D$T.substr(D$$).split(D$o._splitToWordExps3),D$$=0;D$$<D$h.length;D$$++)(D$T=D$h[D$$]).length&&"defined"!=D$T&&(D$m[D$T]=!0);continue;case"#else":D$k.src=D$T,D$j=(D$s=D$s.parent).childs[D$s.childs.length-1],D$k.noCompile=D$j.noCompile,D$k.noCompile||(D$k.condition=D$j.condition,D$k.conditionType=1==D$j.conditionType?2:1,D$k.text="//"+D$k.text+" "+D$j.text+" "+D$k.conditionType),D$k.setParent(D$s),D$s=D$k;continue;case"#endif":D$j=(D$s=D$s.parent).childs[D$s.childs.length-1],D$k.noCompile=D$j.noCompile,D$k.noCompile||(D$k.text="//"+D$k.text),D$k.setParent(D$s);continue;case"#include":D$h=D$o.splitToWords(D$T,null);var D$V=D$o.includes[D$h[1]];if(!D$V)throw"ShaderCompile error no this include file:"+D$h[1];if((D$A=D$h[0].indexOf("?"))<0){D$k.setParent(D$s),D$T=D$V.getWith("with"==D$h[2]?D$h[3]:null),this._compileToTree(D$k,D$T.split("\n"),0,D$U,D$m),D$k.text="";continue}D$k.setCondition(D$h[0].substr(D$A+1),1),D$k.text=D$V.getWith("with"==D$h[2]?D$h[3]:null);break;case"#import":D$Z=(D$h=D$o.splitToWords(D$T,null))[1],D$U.push({node:D$k,file:D$o.includes[D$Z],ofs:D$k.text.length});continue}}else{if((D$j=D$s.childs[D$s.childs.length-1])&&!D$j.name){0<D$U.length&&D$o.splitToWords(D$T,D$j),D$H=D$k,D$j.text+="\n"+D$T;continue}0<D$U.length&&D$o.splitToWords(D$T,D$k)}D$k.setParent(D$s)}},D$s.createShader=function(D$s,D$r,D$e){var D$U={},D$m="";if(D$s)for(var D$k in D$s)D$m+="#define "+D$k+"\n",D$U[D$k]=!0;var D$j=this._VS.toscript(D$U,[]),D$T=this._PS.toscript(D$U,[]);return(D$e||D$Ws.create)(D$m+D$j.join("\n"),D$m+D$T.join("\n"),D$r,this._nameMap)},D$o._parseOne=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j={type:D$o.shaderParamsMap[D$e[D$U+1]],name:D$e[D$U+2],size:isNaN(parseInt(D$e[D$U+3]))?1:parseInt(D$e[D$U+3])};return D$k&&("attribute"==D$m?D$s.push(D$j):D$r.push(D$j)),":"==D$e[D$U+3]&&(D$j.type=D$e[D$U+4],D$U+=2),D$U+=2},D$o.addInclude=function(D$s,D$r){if(!D$r||0===D$r.length)throw new Error("add shader include file err:"+D$s);if(D$o.includes[D$s])throw new Error("add shader include file err, has add:"+D$s);D$o.includes[D$s]=new D$e(D$r)},D$o.preGetParams=function(D$s,D$r){var D$e=[D$s,D$r],D$U={},D$m=[],D$k=[],D$j={},D$T=[];D$U.attributes=D$m,D$U.uniforms=D$k,D$U.defines=D$j;for(var D$Y=0,D$Z=0,D$h=0;D$h<2;D$h++){D$e[D$h]=D$e[D$h].replace(D$o._removeAnnotation,"");var D$H,D$A=D$e[D$h].match(D$o._reg);for(D$Y=0,D$Z=D$A.length;D$Y<D$Z;D$Y++){var D$x=D$A[D$Y];if("attribute"==D$x||"uniform"==D$x)D$Y=D$o._parseOne(D$m,D$k,D$A,D$Y,D$x,!0);else{if("#define"==D$x){D$T[D$x=D$A[++D$Y]]=1;continue}if("#ifdef"==D$x){D$j[D$H=D$A[++D$Y]]=D$j[D$H]||[];for(D$Y++;D$Y<D$Z;D$Y++)if("attribute"==(D$x=D$A[D$Y])||"uniform"==D$x)D$Y=D$o._parseOne(D$m,D$k,D$A,D$Y,D$x,D$T[D$H]);else if("#else"==D$x)for(D$Y++;D$Y<D$Z;D$Y++)if("attribute"==(D$x=D$A[D$Y])||"uniform"==D$x)D$Y=D$o._parseOne(D$m,D$k,D$A,D$Y,D$x,!D$T[D$H]);else if("#endif"==D$x)break}}}}return D$U},D$o.splitToWords=function(D$s,D$r){for(var D$e,D$U,D$m=[],D$k=-1,D$j=0,D$T=D$s.length;D$j<D$T;D$j++)if(D$e=D$s.charAt(D$j),0<=" \t=+-*/&%!<>()'\",;".indexOf(D$e)){if(0<=D$k&&1<D$j-D$k&&(D$U=D$s.substr(D$k,D$j-D$k),D$m.push(D$U)),'"'==D$e||"'"==D$e){var D$Y=D$s.indexOf(D$e,D$j+1);if(D$Y<0)throw"Sharder err:"+D$s;D$m.push(D$s.substr(D$j+1,D$Y-D$j-1)),D$j=D$Y,D$k=-1;continue}"("==D$e&&D$r&&0<D$m.length&&(D$U=D$m[D$m.length-1]+";","vec4;main;".indexOf(D$U)<0&&(D$r.useFuns+=D$U)),D$k=-1}else D$k<0&&(D$k=D$j);return D$k<D$T&&1<D$T-D$k&&(D$U=D$s.substr(D$k,D$T-D$k),D$m.push(D$U)),D$m},D$o.IFDEF_NO=0,D$o.IFDEF_YES=1,D$o.IFDEF_ELSE=2,D$o.IFDEF_PARENT=3,D$o._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),D$o._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),D$o._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),D$o.includes={},D$j(D$o,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),D$o.__init$=function(){D$b=function(){function D$e(D$s){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=D$s}D$A(D$e,"");var D$s=D$e.prototype;return D$s.setParent=function(D$s){D$s.childs.push(this),this.z=D$s.z+1,this.parent=D$s},D$s.setCondition=function(D$s,D$r){D$s&&(this.conditionType=D$r,D$s=D$s.replace(/(\s*$)/g,""),this.condition=function(){return this[D$s]},this.condition.__condition=D$s)},D$s.toscript=function(D$s,D$r){return this._toscript(D$s,D$r,++D$e.__id)},D$s._toscript=function(D$U,D$m,D$k){if(this.childs.length<1&&!this.text)return D$m;D$m.length;if(this.condition){var D$s=!!this.condition.call(D$U);if(2===this.conditionType&&(D$s=!D$s),!D$s)return D$m}if(this.text&&D$m.push(this.text),0<this.childs.length&&this.childs.forEach(function(D$s,D$r,D$e){D$s._toscript(D$U,D$m,D$k)}),0<this.includefiles.length&&0<this.useFuns.length)for(var D$r,D$e=0,D$j=this.includefiles.length;D$e<D$j;D$e++)this.includefiles[D$e].curUseID!=D$k&&0<(D$r=this.includefiles[D$e].file.getFunsScript(this.useFuns)).length&&(this.includefiles[D$e].curUseID=D$k,D$m[0]=D$r+D$m[0]);return D$m},D$e.__id=1,D$e}(),D$e=function(){function D$s(D$s){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=D$s;for(var D$r=0,D$e=0,D$U=0;!((D$r=D$s.indexOf("#begin",D$r))<0);){for(D$U=D$r+5;!((D$U=D$s.indexOf("#end",D$U))<0)&&"i"===D$s.charAt(D$U+4);)D$U+=5;if(D$U<0)throw"add include err,no #end:"+D$s;D$e=D$s.indexOf("\n",D$r);var D$m=D$o.splitToWords(D$s.substr(D$r,D$e-D$r),null);"code"==D$m[1]?this.codes[D$m[2]]=D$s.substr(D$e+1,D$U-D$e-1):"function"==D$m[1]&&(D$e=D$s.indexOf("function",D$r),D$e+="function".length,this.funs[D$m[3]]=D$s.substr(D$e+1,D$U-D$e-1),this.funnames+=D$m[3]+";"),D$r=D$U+1}}D$A(D$s,"");var D$r=D$s.prototype;return D$r.getWith=function(D$s){var D$r=D$s?this.codes[D$s]:this.script;if(!D$r)throw"get with error:"+D$s;return D$r},D$r.getFunsScript=function(D$s){var D$r="";for(var D$e in this.funs)0<=D$s.indexOf(D$e+";")&&(D$r+=this.funs[D$e]);return D$r},D$s}()},D$o}(),D$Is=function(){function D$j(){}return D$A(D$j,"laya.webgl.WebGL"),D$j._uint8ArraySlice=function(){for(var D$s=this.length,D$r=new Uint8Array(this.length),D$e=0;D$e<D$s;D$e++)D$r[D$e]=this[D$e];return D$r},D$j._float32ArraySlice=function(){for(var D$s=this.length,D$r=new Float32Array(this.length),D$e=0;D$e<D$s;D$e++)D$r[D$e]=this[D$e];return D$r},D$j._uint16ArraySlice=function(D$s){var D$r,D$e=arguments,D$U=0,D$m=0;if(0===D$e.length)for(D$U=this.length,D$r=new Uint16Array(D$U),D$m=0;D$m<D$U;D$m++)D$r[D$m]=this[D$m];else if(2===D$e.length){var D$k=D$e[0],D$j=D$e[1];if(D$k<D$j)for(D$U=D$j-D$k,D$r=new Uint16Array(D$U),D$m=D$k;D$m<D$j;D$m++)D$r[D$m-D$k]=this[D$m];else D$r=new Uint16Array(0)}return D$r},D$j.expandContext=function(){var D$s=D$m.prototype,D$r=CanvasRenderingContext2D.prototype;D$r.fillTrangles=D$s.fillTrangles,D$Ls.__int__(null),D$r.setIBVB=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){void 0===D$Y&&(D$Y=0),void 0===D$Z&&(D$Z=0),null===D$e&&(this._ib=this._ib||D$_s.QuadrangleIB,D$e=this._ib,D$ls.expandIBQuadrangle(D$e,D$U._byteLength/64+8)),this._setIBVB(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z)},D$r.fillTrangles=function(D$s,D$r,D$e,D$U,D$m){this._curMat=this._curMat||D$y.create(),this._vb=this._vb||D$Fs.create(),this._ib||(this._ib=D$_s.create(),D$ls.fillIBQuadrangle(this._ib,D$j/4));var D$k=this._vb,D$j=D$U.length>>4;D$ls.fillTranglesVB(D$k,D$r,D$e,D$U,D$m||this._curMat,0,0),D$ls.expandIBQuadrangle(this._ib,D$k._byteLength/64+8);var D$T=new D$ns(1,0);D$T.textureHost=D$s;var D$Y=new D$Ms("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");D$k._vertType=3,this._setIBVB(D$r,D$e,this._ib,D$k,6*D$j,D$m,D$Y,D$T,0,0)}},D$j.enable=function(){if(D$x.__init__(),D$V.isConchApp&&!D$V.isConchWebGL)return D$w.skinAniSprite=function(){return new D$ss},D$j.expandContext(),!1;if(D$w.getWebGLContext=function(D$s){for(var D$r,D$e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],D$U=0;D$U<D$e.length;D$U++){try{D$r=D$s.getContext(D$e[D$U],{stencil:D$D.isStencil,alpha:D$D.isAlpha,antialias:D$D.isAntialias,premultipliedAlpha:D$D.premultipliedAlpha,preserveDrawingBuffer:D$D.preserveDrawingBuffer})}catch(D$s){}if(D$r)return D$r}return null},null==(D$j.mainContext=D$j.mainContext||D$w.getWebGLContext(D$V._mainCanvas)))return!1;if(D$V.isWebGL)return!0;D$$.create=function(D$s,D$r){return new D$sr(D$s,D$r)},D$l.create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){return new D$ts(D$s,D$r,D$e,D$U,D$m,D$k,D$j)},D$V.WebGL=D$j,D$V.isWebGL=!0,D$xs.__init__(),D$w.createRenderSprite=function(D$s,D$r){return new D$ys(D$s,D$r)},D$w.createWebGLContext2D=function(D$s){return new D$Ds(D$s)},D$w.changeWebGLSize=function(D$s,D$r){laya.webgl.WebGL.onStageResize(D$s,D$r)},D$w.createGraphics=function(){return new D$Xs};var D$s=D$w.createFilterAction;return D$w.createFilterAction=D$s||function(D$s){return new D$gs},D$w.clear=function(D$s){D$bs.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var D$r=D$V.context.ctx,D$e=0==D$r._submits._length||D$D.preserveDrawingBuffer?D$B.create(D$s)._color:D$P._wgColor;D$e&&D$r.clearBG(D$e[0],D$e[1],D$e[2],D$e[3]),D$bs.clear()},D$w.addToAtlas=function(D$s,D$r){void 0===D$r&&(D$r=!1);var D$e=D$s.bitmap;D$V.optimizeTextureMemory(D$s.url,D$s)?D$X.__typeof(D$e,"laya.webgl.resource.IMergeAtlasBitmap")&&D$e.allowMerageInAtlas&&D$e.on("recovered",D$s,D$s.addTextureToAtlas):D$e.enableMerageInAtlas=!1},D$w.isAtlas=function(D$s){return D$s instanceof laya.webgl.atlas.AtlasWebGLCanvas},D$R._enable(),D$w.beginFlush=function(){for(var D$s=D$R.instance,D$r=D$s.getAtlaserCount(),D$e=0;D$e<D$r;D$e++){var D$U=D$s.getAtlaserByIndex(D$e).texture;D$U._flashCacheImageNeedFlush&&D$w.flashFlushImage(D$U)}},D$w.drawToCanvas=function(D$s,D$r,D$e,D$U,D$m,D$k){(D$e<=0||D$U<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),D$e|=0,D$U|=0,D$m|=0,D$k|=0;var D$j=D$Ss.create(D$e,D$U,6408,5121,0,!1);D$j.start(),D$j.clear(0,0,0,0),D$V.context.clear(),D$b.renders[D$r]._fun(D$s,D$V.context,D$m,D$bs.height-D$U+D$k),D$V.context.flush(),D$j.end();var D$T=D$j.getData(0,0,D$e,D$U);if(D$j.recycle(),D$T.byteLength==D$e*D$U*4){var D$Y=new D$qs;D$Y._canvas=D$x.createElement("canvas"),D$Y.size(D$e,D$U);var D$Z=D$Y._canvas.getContext("2d");D$x.canvas.size(D$e,D$U);var D$h=D$x.context,D$H=D$h.createImageData(D$e,D$U);return D$H.data.set(new Uint8ClampedArray(D$T.buffer)),D$Y._imgData=D$H,D$h.putImageData(D$H,0,0),D$Z.save(),D$Z.translate(0,D$U),D$Z.scale(1,-1),D$Z.drawImage(D$x.canvas.source,0,0),D$Z.restore(),D$Y}console.log("drawToCanvas error: w:"+D$e+",h:"+D$U+",datalen:"+D$T.byteLength)},D$w.createFilterAction=function(D$s){var D$r;switch(D$s){case 32:D$r=new D$gs}return D$r},D$w.addTextureToAtlas=function(D$s){D$s._uvID++,D$R._atlasRestore++,D$s.bitmap.enableMerageInAtlas&&D$R.instance.addToAtlas(D$s)},D$w.getTexturePixels=function(D$s,D$r,D$e,D$U,D$m){D$V.context.ctx.clear();var D$k=new D$J;D$k.graphics.drawTexture(D$s,-D$r,-D$e);var D$j=D$Ss.create(D$U,D$m);D$j.start(),D$j.clear(0,0,0,0),D$k.render(D$V.context,0,0),D$V.context.ctx.flush(),D$j.end();for(var D$T=D$j.getData(0,0,D$U,D$m),D$Y=[],D$Z=0,D$h=D$m-1;0<=D$h;D$h--)for(var D$H=0;D$H<D$U;D$H++)D$Z=4*(D$h*D$U+D$H),D$Y.push(D$T[D$Z]),D$Y.push(D$T[D$Z+1]),D$Y.push(D$T[D$Z+2]),D$Y.push(D$T[D$Z+3]);return D$Y},D$w.skinAniSprite=function(){return new D$ss},D$Z.create=function(D$s,D$r){var D$e=new D$qs;return D$e._imgData=D$r,D$e.flipY=!1,D$e},D$n._filterStart=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$s.getValue("bounds"),D$j=D$Ss.create(D$k.width,D$k.height);if(D$j.start(),D$j.clear(0,0,0,0),D$s.addValue("src",D$j),D$s.addValue("ScissorTest",D$bs.worldScissorTest),D$bs.worldScissorTest){var D$T=new D$f;D$T.copyFrom(D$e.ctx._clipRect),D$s.addValue("clipRect",D$T),D$bs.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},D$n._filterEnd=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$s.getValue("bounds");D$s.getValue("src").end();var D$j=D$Ss.create(D$k.width,D$k.height);D$j.start(),D$j.clear(0,0,0,0),D$s.addValue("out",D$j),D$r._set$P("_filterCache",D$j),D$r._set$P("_isHaveGlowFilter",D$s.getValue("_isHaveGlowFilter"))},D$n._EndTarget=function(D$s,D$r){if(D$s.getValue("src").recycle(),D$s.getValue("out").end(),D$s.getValue("ScissorTest")){D$bs.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),D$r.ctx.save();var D$e=D$s.getValue("clipRect");D$r.ctx.clipRect(D$e.x,D$e.y,D$e.width,D$e.height)}},D$n._useSrc=function(D$s){var D$r=D$s.getValue("out");D$r.end(),(D$r=D$s.getValue("src")).start(),D$r.clear(0,0,0,0)},D$n._endSrc=function(D$s){D$s.getValue("src").end()},D$n._useOut=function(D$s){var D$r=D$s.getValue("src");D$r.end(),(D$r=D$s.getValue("out")).start(),D$r.clear(0,0,0,0)},D$n._endOut=function(D$s){D$s.getValue("out").end()},D$n._recycleScope=function(D$s){D$s.recycle()},D$n._filter=function(D$s,D$r,D$e,D$U){var D$m=this._next;if(D$m){var D$k,D$j,D$T=D$s.filters,D$Y=D$T.length;if(1==D$Y&&32==D$T[0].type)return D$r.ctx.save(),D$r.ctx.setFilters([D$T[0]]),D$m._fun.call(D$m,D$s,D$r,D$e,D$U),void D$r.ctx.restore();var D$Z=D$Ts.create(),D$h=D$g.TEMP,D$H=D$r.ctx._getTransformMatrix(),D$A=D$y.create();D$H.copyTo(D$A);var D$x=0,D$B=0,D$$=!1,D$l=D$s._$P._filterCache?D$s._$P._filterCache:null;if(!D$l||D$s._repaint){D$$=D$s._isHaveGlowFilter(),D$Z.addValue("_isHaveGlowFilter",D$$),D$$&&(D$x=50,D$B=25),(D$j=new D$f).copyFrom(D$s.getSelfBounds()),D$j.x+=D$s.x,D$j.y+=D$s.y,D$j.x-=D$s.pivotX+4,D$j.y-=D$s.pivotY+4;var D$V=D$j.x,D$b=D$j.y;if(D$j.width+=D$x+8,D$j.height+=D$x+8,D$h.x=D$j.x*D$A.a+D$j.y*D$A.c,D$h.y=D$j.y*D$A.d+D$j.x*D$A.b,D$j.x=D$h.x,D$j.y=D$h.y,D$h.x=D$j.width*D$A.a+D$j.height*D$A.c,D$h.y=D$j.height*D$A.d+D$j.width*D$A.b,D$j.width=D$h.x,D$j.height=D$h.y,D$j.width<=0||D$j.height<=0)return;D$l&&D$l.recycle(),D$Z.addValue("bounds",D$j);var D$o=D$js.create([D$Z,D$s,D$r,0,0],D$n._filterStart);D$r.addRenderObject(D$o),D$r.ctx._renderKey=0,D$r.ctx._shader2D.glTexture=null;var D$I=D$s.x-D$V+D$B,D$w=D$s.y-D$b+D$B;D$m._fun.call(D$m,D$s,D$r,D$I,D$w),D$o=D$js.create([D$Z,D$s,D$r,0,0],D$n._filterEnd),D$r.addRenderObject(D$o);for(var D$X=0;D$X<D$Y;D$X++){0!=D$X&&(D$o=D$js.create([D$Z],D$n._useSrc),D$r.addRenderObject(D$o),D$k=D$ns.create(1,0),D$y.TEMP.identity(),D$r.ctx.drawTarget(D$Z,0,0,D$j.width,D$j.height,D$y.TEMP,"out",D$k,null,D$p.TOINT.overlay),D$o=D$js.create([D$Z],D$n._useOut),D$r.addRenderObject(D$o)),D$T[D$X].action.apply3d(D$Z,D$s,D$r,0,0)}D$o=D$js.create([D$Z,D$r],D$n._EndTarget),D$r.addRenderObject(D$o)}else{if((D$$=!!D$s._$P._isHaveGlowFilter&&D$s._$P._isHaveGlowFilter)&&(D$x=50,D$B=25),(D$j=D$s.getBounds()).width<=0||D$j.height<=0)return;D$j.width+=D$x,D$j.height+=D$x,D$h.x=D$j.x*D$A.a+D$j.y*D$A.c,D$h.y=D$j.y*D$A.d+D$j.x*D$A.b,D$j.x=D$h.x,D$j.y=D$h.y,D$h.x=D$j.width*D$A.a+D$j.height*D$A.c,D$h.y=D$j.height*D$A.d+D$j.width*D$A.b,D$j.width=D$h.x,D$j.height=D$h.y,D$Z.addValue("out",D$l)}D$e=D$e-D$B-D$s.x,D$U=D$U-D$B-D$s.y,D$h.setTo(D$e,D$U),D$A.transformPoint(D$h),D$e=D$h.x+D$j.x,D$U=D$h.y+D$j.y,D$k=D$ns.create(1,0),D$y.TEMP.identity(),D$r.ctx.drawTarget(D$Z,D$e,D$U,D$j.width,D$j.height,D$y.TEMP,"out",D$k,null,D$p.TOINT.overlay),D$o=D$js.create([D$Z],D$n._recycleScope),D$r.addRenderObject(D$o),D$A.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=D$j._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=D$j._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=D$j._uint8ArraySlice),!0},D$j.onStageResize=function(D$s,D$r){null!=D$j.mainContext&&(D$j.mainContext.viewport(0,0,D$s,D$r),D$bs.width=D$s,D$bs.height=D$r)},D$j.onInvalidGLRes=function(){D$R.instance.freeAll(),D$I.releaseContentManagers(!0),D$j.doNodeRepaint(D$X.stage),D$j.mainContext.viewport(0,0,D$bs.width,D$bs.height),D$X.stage.event("devicelost")},D$j.doNodeRepaint=function(D$s){0==D$s.numChildren&&D$s.repaint();for(var D$r=0;D$r<D$s.numChildren;D$r++)D$j.doNodeRepaint(D$s.getChildAt(D$r))},D$j.init=function(D$s,D$r,D$e){D$j.mainCanvas=D$s,D$Z._createContext=function(D$s){return new D$Ds(D$s)},D$qs._createContext=function(D$s){return new D$Ds(D$s)};var D$U=laya.webgl.WebGL.mainContext;if(null!=D$U.getShaderPrecisionFormat){var D$m=D$U.getShaderPrecisionFormat(35633,36338),D$k=D$U.getShaderPrecisionFormat(35632,36338);D$j.shaderHighPrecision=!(!D$m.precision||!D$k.precision)}else D$j.shaderHighPrecision=!1;if(D$j.compressAstc=D$U.getExtension("WEBGL_compressed_texture_astc"),D$j.compressAtc=D$U.getExtension("WEBGL_compressed_texture_atc"),D$j.compressEtc=D$U.getExtension("WEBGL_compressed_texture_etc"),D$j.compressEtc1=D$U.getExtension("WEBGL_compressed_texture_etc1"),D$j.compressPvrtc=D$U.getExtension("WEBGL_compressed_texture_pvrtc"),D$j.compressS3tc=D$U.getExtension("WEBGL_compressed_texture_s3tc"),D$j.compressS3tc_srgb=D$U.getExtension("WEBGL_compressed_texture_s3tc_srgb"),D$j.compressAstc=D$j.compressAstc?D$j.compressAstc:{},D$j.compressAtc=D$j.compressAtc?D$j.compressAtc:{},D$j.compressEtc=D$j.compressEtc?D$j.compressEtc:{},D$j.compressEtc1=D$j.compressEtc1?D$j.compressEtc1:{},D$j.compressPvrtc=D$j.compressPvrtc?D$j.compressPvrtc:{},D$j.compressS3tc=D$j.compressS3tc?D$j.compressS3tc:{},D$j.compressS3tc_srgb=D$j.compressS3tc_srgb?D$j.compressS3tc_srgb:{},D$U.deleteTexture1=D$U.deleteTexture,D$U.deleteTexture=function(D$s){D$s==D$ws.curBindTexValue&&(D$ws.curBindTexValue=null),D$U.deleteTexture1(D$s)},D$j.onStageResize(D$r,D$e),null==D$j.mainContext)throw new Error("webGL getContext err!");D$K.__init__(),D$R.__init__(),D$Js.__init__(),D$ks.__init__(),D$Ds.__init__(),D$ns.__init__(),D$_.__init__(),D$Ls.__int__(D$U),D$p._init_(D$U),D$V.isConchApp&&conch.setOnInvalidGLRes(D$j.onInvalidGLRes)},D$j.mainCanvas=null,D$j.antialias=!0,D$j.shaderHighPrecision=!1,D$j._bg_null=[0,0,0,0],D$j}(),D$ws=function(){function D$U(){}return D$A(D$U,"laya.webgl.WebGLContext"),D$U.UseProgram=function(D$s){return D$U._useProgram!==D$s&&(D$Is.mainContext.useProgram(D$s),D$U._useProgram=D$s,!0)},D$U.setDepthTest=function(D$s,D$r){D$r!==D$U._depthTest&&((D$U._depthTest=D$r)?D$s.enable(2929):D$s.disable(2929))},D$U.setDepthMask=function(D$s,D$r){D$r!==D$U._depthMask&&(D$U._depthMask=D$r,D$s.depthMask(D$r))},D$U.setDepthFunc=function(D$s,D$r){D$r!==D$U._depthFunc&&(D$U._depthFunc=D$r,D$s.depthFunc(D$r))},D$U.setBlend=function(D$s,D$r){D$r!==D$U._blend&&((D$U._blend=D$r)?D$s.enable(3042):D$s.disable(3042))},D$U.setBlendFunc=function(D$s,D$r,D$e){(D$r!==D$U._sFactor||D$e!==D$U._dFactor)&&(D$U._sFactor=D$r,D$U._dFactor=D$e,D$s.blendFunc(D$r,D$e))},D$U.setCullFace=function(D$s,D$r){D$r!==D$U._cullFace&&((D$U._cullFace=D$r)?D$s.enable(2884):D$s.disable(2884))},D$U.setFrontFace=function(D$s,D$r){D$r!==D$U._frontFace&&(D$U._frontFace=D$r,D$s.frontFace(D$r))},D$U.bindTexture=function(D$s,D$r,D$e){D$s.bindTexture(D$r,D$e),D$U.curBindTexTarget=D$r,D$U.curBindTexValue=D$e},D$U.DEPTH_BUFFER_BIT=256,D$U.STENCIL_BUFFER_BIT=1024,D$U.COLOR_BUFFER_BIT=16384,D$U.POINTS=0,D$U.LINES=1,D$U.LINE_LOOP=2,D$U.LINE_STRIP=3,D$U.TRIANGLES=4,D$U.TRIANGLE_STRIP=5,D$U.TRIANGLE_FAN=6,D$U.ZERO=0,D$U.ONE=1,D$U.SRC_COLOR=768,D$U.ONE_MINUS_SRC_COLOR=769,D$U.SRC_ALPHA=770,D$U.ONE_MINUS_SRC_ALPHA=771,D$U.DST_ALPHA=772,D$U.ONE_MINUS_DST_ALPHA=773,D$U.DST_COLOR=774,D$U.ONE_MINUS_DST_COLOR=775,D$U.SRC_ALPHA_SATURATE=776,D$U.FUNC_ADD=32774,D$U.BLEND_EQUATION=32777,D$U.BLEND_EQUATION_RGB=32777,D$U.BLEND_EQUATION_ALPHA=34877,D$U.FUNC_SUBTRACT=32778,D$U.FUNC_REVERSE_SUBTRACT=32779,D$U.BLEND_DST_RGB=32968,D$U.BLEND_SRC_RGB=32969,D$U.BLEND_DST_ALPHA=32970,D$U.BLEND_SRC_ALPHA=32971,D$U.CONSTANT_COLOR=32769,D$U.ONE_MINUS_CONSTANT_COLOR=32770,D$U.CONSTANT_ALPHA=32771,D$U.ONE_MINUS_CONSTANT_ALPHA=32772,D$U.BLEND_COLOR=32773,D$U.ARRAY_BUFFER=34962,D$U.ELEMENT_ARRAY_BUFFER=34963,D$U.ARRAY_BUFFER_BINDING=34964,D$U.ELEMENT_ARRAY_BUFFER_BINDING=34965,D$U.STREAM_DRAW=35040,D$U.STATIC_DRAW=35044,D$U.DYNAMIC_DRAW=35048,D$U.BUFFER_SIZE=34660,D$U.BUFFER_USAGE=34661,D$U.CURRENT_VERTEX_ATTRIB=34342,D$U.FRONT=1028,D$U.BACK=1029,D$U.CULL_FACE=2884,D$U.FRONT_AND_BACK=1032,D$U.BLEND=3042,D$U.DITHER=3024,D$U.STENCIL_TEST=2960,D$U.DEPTH_TEST=2929,D$U.SCISSOR_TEST=3089,D$U.POLYGON_OFFSET_FILL=32823,D$U.SAMPLE_ALPHA_TO_COVERAGE=32926,D$U.SAMPLE_COVERAGE=32928,D$U.NO_ERROR=0,D$U.INVALID_ENUM=1280,D$U.INVALID_VALUE=1281,D$U.INVALID_OPERATION=1282,D$U.OUT_OF_MEMORY=1285,D$U.CW=2304,D$U.CCW=2305,D$U.LINE_WIDTH=2849,D$U.ALIASED_POINT_SIZE_RANGE=33901,D$U.ALIASED_LINE_WIDTH_RANGE=33902,D$U.CULL_FACE_MODE=2885,D$U.FRONT_FACE=2886,D$U.DEPTH_RANGE=2928,D$U.DEPTH_WRITEMASK=2930,D$U.DEPTH_CLEAR_VALUE=2931,D$U.DEPTH_FUNC=2932,D$U.STENCIL_CLEAR_VALUE=2961,D$U.STENCIL_FUNC=2962,D$U.STENCIL_FAIL=2964,D$U.STENCIL_PASS_DEPTH_FAIL=2965,D$U.STENCIL_PASS_DEPTH_PASS=2966,D$U.STENCIL_REF=2967,D$U.STENCIL_VALUE_MASK=2963,D$U.STENCIL_WRITEMASK=2968,D$U.STENCIL_BACK_FUNC=34816,D$U.STENCIL_BACK_FAIL=34817,D$U.STENCIL_BACK_PASS_DEPTH_FAIL=34818,D$U.STENCIL_BACK_PASS_DEPTH_PASS=34819,D$U.STENCIL_BACK_REF=36003,D$U.STENCIL_BACK_VALUE_MASK=36004,D$U.STENCIL_BACK_WRITEMASK=36005,D$U.VIEWPORT=2978,D$U.SCISSOR_BOX=3088,D$U.COLOR_CLEAR_VALUE=3106,D$U.COLOR_WRITEMASK=3107,D$U.UNPACK_ALIGNMENT=3317,D$U.PACK_ALIGNMENT=3333,D$U.MAX_TEXTURE_SIZE=3379,D$U.MAX_VIEWPORT_DIMS=3386,D$U.SUBPIXEL_BITS=3408,D$U.RED_BITS=3410,D$U.GREEN_BITS=3411,D$U.BLUE_BITS=3412,D$U.ALPHA_BITS=3413,D$U.DEPTH_BITS=3414,D$U.STENCIL_BITS=3415,D$U.POLYGON_OFFSET_UNITS=10752,D$U.POLYGON_OFFSET_FACTOR=32824,D$U.TEXTURE_BINDING_2D=32873,D$U.SAMPLE_BUFFERS=32936,D$U.SAMPLES=32937,D$U.SAMPLE_COVERAGE_VALUE=32938,D$U.SAMPLE_COVERAGE_INVERT=32939,D$U.NUM_COMPRESSED_TEXTURE_FORMATS=34466,D$U.COMPRESSED_TEXTURE_FORMATS=34467,D$U.DONT_CARE=4352,D$U.FASTEST=4353,D$U.NICEST=4354,D$U.GENERATE_MIPMAP_HINT=33170,D$U.BYTE=5120,D$U.UNSIGNED_BYTE=5121,D$U.SHORT=5122,D$U.UNSIGNED_SHORT=5123,D$U.INT=5124,D$U.UNSIGNED_INT=5125,D$U.FLOAT=5126,D$U.DEPTH_COMPONENT=6402,D$U.ALPHA=6406,D$U.RGB=6407,D$U.RGBA=6408,D$U.LUMINANCE=6409,D$U.LUMINANCE_ALPHA=6410,D$U.UNSIGNED_SHORT_4_4_4_4=32819,D$U.UNSIGNED_SHORT_5_5_5_1=32820,D$U.UNSIGNED_SHORT_5_6_5=33635,D$U.FRAGMENT_SHADER=35632,D$U.VERTEX_SHADER=35633,D$U.MAX_VERTEX_ATTRIBS=34921,D$U.MAX_VERTEX_UNIFORM_VECTORS=36347,D$U.MAX_VARYING_VECTORS=36348,D$U.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,D$U.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,D$U.MAX_TEXTURE_IMAGE_UNITS=34930,D$U.MAX_FRAGMENT_UNIFORM_VECTORS=36349,D$U.SHADER_TYPE=35663,D$U.DELETE_STATUS=35712,D$U.LINK_STATUS=35714,D$U.VALIDATE_STATUS=35715,D$U.ATTACHED_SHADERS=35717,D$U.ACTIVE_UNIFORMS=35718,D$U.ACTIVE_ATTRIBUTES=35721,D$U.SHADING_LANGUAGE_VERSION=35724,D$U.CURRENT_PROGRAM=35725,D$U.NEVER=512,D$U.LESS=513,D$U.EQUAL=514,D$U.LEQUAL=515,D$U.GREATER=516,D$U.NOTEQUAL=517,D$U.GEQUAL=518,D$U.ALWAYS=519,D$U.KEEP=7680,D$U.REPLACE=7681,D$U.INCR=7682,D$U.DECR=7683,D$U.INVERT=5386,D$U.INCR_WRAP=34055,D$U.DECR_WRAP=34056,D$U.VENDOR=7936,D$U.RENDERER=7937,D$U.VERSION=7938,D$U.NEAREST=9728,D$U.LINEAR=9729,D$U.NEAREST_MIPMAP_NEAREST=9984,D$U.LINEAR_MIPMAP_NEAREST=9985,D$U.NEAREST_MIPMAP_LINEAR=9986,D$U.LINEAR_MIPMAP_LINEAR=9987,D$U.TEXTURE_MAG_FILTER=10240,D$U.TEXTURE_MIN_FILTER=10241,D$U.TEXTURE_WRAP_S=10242,D$U.TEXTURE_WRAP_T=10243,D$U.TEXTURE_2D=3553,D$U.TEXTURE=5890,D$U.TEXTURE_CUBE_MAP=34067,D$U.TEXTURE_BINDING_CUBE_MAP=34068,D$U.TEXTURE_CUBE_MAP_POSITIVE_X=34069,D$U.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,D$U.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,D$U.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,D$U.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,D$U.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,D$U.MAX_CUBE_MAP_TEXTURE_SIZE=34076,D$U.TEXTURE0=33984,D$U.TEXTURE1=33985,D$U.TEXTURE2=33986,D$U.TEXTURE3=33987,D$U.TEXTURE4=33988,D$U.TEXTURE5=33989,D$U.TEXTURE6=33990,D$U.TEXTURE7=33991,D$U.TEXTURE8=33992,D$U.TEXTURE9=33993,D$U.TEXTURE10=33994,D$U.TEXTURE11=33995,D$U.TEXTURE12=33996,D$U.TEXTURE13=33997,D$U.TEXTURE14=33998,D$U.TEXTURE15=33999,D$U.TEXTURE16=34e3,D$U.TEXTURE17=34001,D$U.TEXTURE18=34002,D$U.TEXTURE19=34003,D$U.TEXTURE20=34004,D$U.TEXTURE21=34005,D$U.TEXTURE22=34006,D$U.TEXTURE23=34007,D$U.TEXTURE24=34008,D$U.TEXTURE25=34009,D$U.TEXTURE26=34010,D$U.TEXTURE27=34011,D$U.TEXTURE28=34012,D$U.TEXTURE29=34013,D$U.TEXTURE30=34014,D$U.TEXTURE31=34015,D$U.ACTIVE_TEXTURE=34016,D$U.REPEAT=10497,D$U.CLAMP_TO_EDGE=33071,D$U.MIRRORED_REPEAT=33648,D$U.FLOAT_VEC2=35664,D$U.FLOAT_VEC3=35665,D$U.FLOAT_VEC4=35666,D$U.INT_VEC2=35667,D$U.INT_VEC3=35668,D$U.INT_VEC4=35669,D$U.BOOL=35670,D$U.BOOL_VEC2=35671,D$U.BOOL_VEC3=35672,D$U.BOOL_VEC4=35673,D$U.FLOAT_MAT2=35674,D$U.FLOAT_MAT3=35675,D$U.FLOAT_MAT4=35676,D$U.SAMPLER_2D=35678,D$U.SAMPLER_CUBE=35680,D$U.VERTEX_ATTRIB_ARRAY_ENABLED=34338,D$U.VERTEX_ATTRIB_ARRAY_SIZE=34339,D$U.VERTEX_ATTRIB_ARRAY_STRIDE=34340,D$U.VERTEX_ATTRIB_ARRAY_TYPE=34341,D$U.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,D$U.VERTEX_ATTRIB_ARRAY_POINTER=34373,D$U.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,D$U.COMPILE_STATUS=35713,D$U.LOW_FLOAT=36336,D$U.MEDIUM_FLOAT=36337,D$U.HIGH_FLOAT=36338,D$U.LOW_INT=36339,D$U.MEDIUM_INT=36340,D$U.HIGH_INT=36341,D$U.FRAMEBUFFER=36160,D$U.RENDERBUFFER=36161,D$U.RGBA4=32854,D$U.RGB5_A1=32855,D$U.RGB565=36194,D$U.DEPTH_COMPONENT16=33189,D$U.STENCIL_INDEX=6401,D$U.STENCIL_INDEX8=36168,D$U.DEPTH_STENCIL=34041,D$U.RENDERBUFFER_WIDTH=36162,D$U.RENDERBUFFER_HEIGHT=36163,D$U.RENDERBUFFER_INTERNAL_FORMAT=36164,D$U.RENDERBUFFER_RED_SIZE=36176,D$U.RENDERBUFFER_GREEN_SIZE=36177,D$U.RENDERBUFFER_BLUE_SIZE=36178,D$U.RENDERBUFFER_ALPHA_SIZE=36179,D$U.RENDERBUFFER_DEPTH_SIZE=36180,D$U.RENDERBUFFER_STENCIL_SIZE=36181,D$U.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,D$U.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,D$U.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,D$U.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,D$U.COLOR_ATTACHMENT0=36064,D$U.DEPTH_ATTACHMENT=36096,D$U.STENCIL_ATTACHMENT=36128,D$U.DEPTH_STENCIL_ATTACHMENT=33306,D$U.NONE=0,D$U.FRAMEBUFFER_COMPLETE=36053,D$U.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,D$U.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,D$U.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,D$U.FRAMEBUFFER_UNSUPPORTED=36061,D$U.FRAMEBUFFER_BINDING=36006,D$U.RENDERBUFFER_BINDING=36007,D$U.MAX_RENDERBUFFER_SIZE=34024,D$U.INVALID_FRAMEBUFFER_OPERATION=1286,D$U.UNPACK_FLIP_Y_WEBGL=37440,D$U.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,D$U.CONTEXT_LOST_WEBGL=37442,D$U.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,D$U.BROWSER_DEFAULT_WEBGL=37444,D$U._useProgram=null,D$U._depthTest=!0,D$U._depthMask=!0,D$U._blend=!1,D$U._cullFace=!1,D$U.curBindTexTarget=null,D$U.curBindTexValue=null,D$j(D$U,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),D$U}(),D$Xs=function(D$s){function D$r(){D$r.__super.call(this)}D$A(D$r,"laya.webgl.display.GraphicsGL",D$T);var D$e=D$r.prototype;return D$e.setShader=function(D$s){this._saveToCmd(D$V.context._setShader,[D$s])},D$e.setIBVB=function(D$s,D$r,D$e,D$U,D$m,D$k){this._saveToCmd(D$V.context._setIBVB,[D$s,D$r,D$e,D$U,D$m,D$k])},D$e.drawParticle=function(D$s,D$r,D$e){var D$U=D$w.createParticleTemplate2D(D$e);D$U.x=D$s,D$U.y=D$r,this._saveToCmd(D$V.context._drawParticle,[D$U])},D$r}(),D$Ds=function(D$s){var D$e;function D$C(D$s){this._x=0,this._y=0,this._id=++D$C._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,D$C.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=D$C.MAXCLIPRECT,this.mOutPoint,this._canvas=D$s,this._canvas._addReference(),D$C._contextcount++,D$V.isFlash?(this._ib=D$_s.create(35044),D$ls.fillIBQuadrangle(this._ib,16)):this._ib=D$_s.QuadrangleIB,this.clear()}D$A(D$C,"laya.webgl.canvas.WebGLContext2D",D$m);var D$r=D$C.prototype;return D$r.setIsMainContext=function(){this._isMain=!0},D$r.clearBG=function(D$s,D$r,D$e,D$U){var D$m=D$Is.mainContext;D$m.clearColor(D$s,D$r,D$e,D$U),D$m.clear(16384)},D$r._getSubmits=function(){return this._submits},D$r._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var D$s=0,D$r=this._submits._length;D$s<D$r;D$s++)this._submits[D$s].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},D$r.destroy=function(){--D$C._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=D$_s.QuadrangleIB&&this._ib.releaseResource()},D$r.clear=function(){this._submits||(this._other=D$e.DEFAULT,this._curMat=D$y.create(),this._vb=D$Fs.create(-1),this._submits=[],this._save=[D$W.Create(this)],this._save.length=10,this._shader2D=new D$_,this._triangleMesh=D$Es.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=D$e.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=D$C.MAXCLIPRECT,this._curSubmit=D$ks.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=D$N.DEFAULT;for(var D$s=0,D$r=this._submits._length;D$s<D$r;D$s++)this._submits[D$s].releaseRender(),this._submits[D$s]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},D$r.size=function(D$s,D$r){if(this._width!=D$s||this._height!=D$r)if(0==D$s||0==D$r){0!=this._vb._byteLength&&(this._width=D$s,this._height=D$r,this._vb.clear(),this._vb.upload());for(var D$e=0,D$U=this._submits._length;D$e<D$U;D$e++)this._submits[D$e].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=D$s,this._height=D$r,this._targets&&this._targets.size(D$s,D$r),this._canvas.memorySize-=this._canvas.memorySize;0===D$s&&0===D$r&&this._releaseMem()},D$r._getTransformMatrix=function(){return this._curMat},D$r.translate=function(D$s,D$r){0===D$s&&0===D$r||(D$u.save(this),this._curMat.bTransform&&(D$L.save(this),this._curMat.transformPointN(D$g.TEMP.setTo(D$s,D$r)),D$s=D$g.TEMP.x,D$r=D$g.TEMP.y),this._x+=D$s,this._y+=D$r)},D$r.save=function(){this._save[this._save._length++]=D$W.Create(this)},D$r.restore=function(){var D$s=this._save._length;if(!(D$s<1))for(var D$r=D$s-1;0<=D$r;D$r--){var D$e=this._save[D$r];if(D$e.restore(this),D$e.isSaveMark())return void(this._save._length=D$r)}},D$r._fillText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){void 0===D$Z&&(D$Z=0);var D$h=this._shader2D,D$H=this._curSubmit.shaderValue,D$A=D$m?D$Bs.create(D$m):this._other.font;if(D$R.enabled)D$h.ALPHA!==D$H.ALPHA&&(D$h.glTexture=null),D$xs.drawText(this,D$s,D$r,this._curMat,D$A,D$Y||this._other.textAlign,D$k,D$j,D$T,D$e,D$U,D$Z);else{this._shader2D.defines.getValue();var D$x=D$k?D$B.create(D$k)._color:D$h.colorAdd;D$h.ALPHA===D$H.ALPHA&&D$x===D$h.colorAdd&&D$H.colorAdd===D$h.colorAdd||(D$h.glTexture=null,D$h.colorAdd=D$x),D$xs.drawText(this,D$s,D$r,this._curMat,D$A,D$Y||this._other.textAlign,D$k,D$j,D$T,D$e,D$U,D$Z)}},D$r.fillWords=function(D$s,D$r,D$e,D$U,D$m,D$k){this._fillText(null,D$s,D$r,D$e,D$U,D$m,null,-1,null,D$k)},D$r.fillBorderWords=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._fillBorderText(null,D$s,D$r,D$e,D$U,D$m,D$k,D$j,null)},D$r.fillText=function(D$s,D$r,D$e,D$U,D$m,D$k){this._fillText(D$s,null,D$r,D$e,D$U,D$m,null,-1,D$k)},D$r.strokeText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._fillText(D$s,null,D$r,D$e,D$U,null,D$m,D$k||1,D$j)},D$r.fillBorderText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){this._fillBorderText(D$s,null,D$r,D$e,D$U,D$m,D$k,D$j,D$T)},D$r._fillBorderText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){if(!D$R.enabled)return this._fillText(D$s,D$r,D$e,D$U,D$m,null,D$j,D$T||1,D$Y),void this._fillText(D$s,D$r,D$e,D$U,D$m,D$k,null,-1,D$Y);var D$Z=this._shader2D,D$h=this._curSubmit.shaderValue;D$Z.ALPHA!==D$h.ALPHA&&(D$Z.glTexture=null);var D$H=D$m?(D$C._fontTemp.setFont(D$m),D$C._fontTemp):this._other.font;D$xs.drawText(this,D$s,D$r,this._curMat,D$H,D$Y||this._other.textAlign,D$k,D$j,D$T||1,D$e,D$U,0)},D$r.fillRect=function(D$s,D$r,D$e,D$U,D$m){var D$k=this._vb;if(D$ls.fillRectImgVb(D$k,this._clipRect,D$s,D$r,D$e,D$U,D$E.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var D$j=this._shader2D.fillStyle;D$m&&(this._shader2D.fillStyle=D$N.create(D$m));var D$T=this._shader2D,D$Y=this._curSubmit.shaderValue;if(D$T.fillStyle!==D$Y.fillStyle||D$T.ALPHA!==D$Y.ALPHA){D$T.glTexture=null;var D$Z=this._curSubmit=D$ks.createSubmit(this,this._ib,D$k,(D$k._byteLength-64)/32*3,D$ns.create(2,0));D$Z.shaderValue.color=D$T.fillStyle._color._color,D$Z.shaderValue.ALPHA=D$T.ALPHA,this._submits[this._submits._length++]=D$Z}this._curSubmit._numEle+=6,this._shader2D.fillStyle=D$j}},D$r.fillTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){if(D$s.loaded&&D$s.bitmap&&D$s.source){var D$Y=this._vb,D$Z=D$s.bitmap.width,D$h=D$s.bitmap.height,D$H=D$s.uv,D$A=D$j.x%D$s.width,D$x=D$j.y%D$s.height;if(D$Z!=D$T.w||D$h!=D$T.h){if(!D$T.w&&!D$T.h)switch(D$T.oy=D$T.ox=0,D$k){case"repeat":D$T.width=D$U,D$T.height=D$m;break;case"repeat-x":D$T.width=D$U,D$x<0?D$s.height+D$x>D$m?D$T.height=D$m:D$T.height=D$s.height+D$x:(D$T.oy=D$x,D$s.height+D$x>D$m?D$T.height=D$m-D$x:D$T.height=D$s.height);break;case"repeat-y":D$A<0?D$s.width+D$A>D$U?D$T.width=D$U:D$T.width=D$s.width+D$A:(D$T.ox=D$A,D$s.width+D$A>D$U?D$T.width=D$U-D$A:D$T.width=D$s.width),D$T.height=D$m;break;case"no-repeat":D$A<0?D$s.width+D$A>D$U?D$T.width=D$U:D$T.width=D$s.width+D$A:(D$T.ox=D$A,D$s.width+D$A>D$U?D$T.width=D$U-D$A:D$T.width=D$s.width),D$x<0?D$s.height+D$x>D$m?D$T.height=D$m:D$T.height=D$s.height+D$x:(D$T.oy=D$x,D$s.height+D$x>D$m?D$T.height=D$m-D$x:D$T.height=D$s.height);break;default:D$T.width=D$U,D$T.height=D$m}D$T.w=D$Z,D$T.h=D$h,D$T.uv=[0,0,D$T.width/D$Z,0,D$T.width/D$Z,D$T.height/D$h,0,D$T.height/D$h]}if(D$r+=D$T.ox,D$e+=D$T.oy,D$A-=D$T.ox,D$x-=D$T.oy,D$ls.fillRectImgVb(D$Y,this._clipRect,D$r,D$e,D$T.width,D$T.height,D$T.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var D$B=D$cs.create(this,this._ib,D$Y,(D$Y._byteLength-64)/32*3,D$ns.create(256,0)),D$$=(this._submits[this._submits._length++]=D$B).shaderValue;D$$.textureHost=D$s;var D$l=D$H[0]*D$Z,D$V=D$H[1]*D$h,D$b=(D$H[2]-D$H[0])*D$Z,D$o=(D$H[5]-D$H[3])*D$h,D$I=-D$A/D$Z,D$w=-D$x/D$h;D$$.u_TexRange[0]=D$l/D$Z,D$$.u_TexRange[1]=D$b/D$Z,D$$.u_TexRange[2]=D$V/D$h,D$$.u_TexRange[3]=D$o/D$h,D$$.u_offset[0]=D$I,D$$.u_offset[1]=D$w,D$R.enabled&&!this._isMain&&D$B.addTexture(D$s,(D$Y._byteLength>>2)-16),(this._curSubmit=D$B)._renderType=10017,D$B._numEle+=6}}else this.sprite&&D$X.timer.callLater(this,this._repaintSprite)},D$r.setShader=function(D$s){D$G.save(this,1048576,this._shader2D,!0),this._shader2D.shader=D$s},D$r.setFilters=function(D$s){D$G.save(this,2097152,this._shader2D,!0),this._shader2D.filters=D$s,this._curSubmit=D$ks.RENDERBASE,this._renderKey=0,this._drawCount++},D$r.drawTexture=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._drawTextureM(D$s,D$r,D$e,D$U,D$m,D$k,D$j,null,1)},D$r.addTextureVb=function(D$s,D$r,D$e){var D$U=this._curSubmit._vb||this._vb,D$m=D$U._byteLength>>2;D$U.byteLength=D$m+16<<2;for(var D$k=D$U.getFloat32Array(),D$j=0;D$j<16;D$j+=4)D$k[D$m++]=D$s[D$j]+D$r,D$k[D$m++]=D$s[D$j+1]+D$e,D$k[D$m++]=D$s[D$j+2],D$k[D$m++]=D$s[D$j+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),D$U._upload=!0},D$r.willDrawTexture=function(D$s,D$r){if(!(D$s.loaded&&D$s.bitmap&&D$s.source))return this.sprite&&D$X.timer.callLater(this,this._repaintSprite),0;var D$e=D$s.bitmap,D$U=D$e.id+this._shader2D.ALPHA*D$r+10016;if(D$U==this._renderKey)return D$U;var D$m=this._shader2D,D$k=D$m.ALPHA,D$j=this._curSubmit.shaderValue;D$m.ALPHA*=D$r,this._renderKey=D$U,this._drawCount++,D$m.glTexture=D$e;var D$T=this._vb,D$Y=null,D$Z=D$T._byteLength/32*3,D$h=D$j.textureHost&&D$j.textureHost==D$s&&D$j.textureHost.alphaTexture==D$s.alphaTexture;return D$Y=D$cs.create(this,this._ib,D$T,D$Z,D$ns.create(1,0)),(this._submits[this._submits._length++]=D$Y).shaderValue.textureHost=D$s,D$Y._renderType=10016,D$Y._preIsSameTextureShader=10016===this._curSubmit._renderType&&D$m.ALPHA===D$j.ALPHA&&D$h,this._curSubmit=D$Y,D$m.ALPHA=D$k,D$U},D$r.drawTextures=function(D$s,D$r,D$e,D$U){if(D$s.loaded&&D$s.bitmap&&D$s.source){var D$m=this._clipRect;if(this._clipRect=D$C.MAXCLIPRECT,this._drawTextureM(D$s,D$r[0],D$r[1],D$s.width,D$s.height,D$e,D$U,null,1)){if(this._clipRect=D$m,D$O.drawCall++,!(D$r.length<4)){for(var D$k=this._curSubmit._vb||this._vb,D$j=this._curMat.a,D$T=this._curMat.d,D$Y=2,D$Z=D$r.length;D$Y<D$Z;D$Y+=2)D$ls.copyPreImgVb(D$k,(D$r[D$Y]-D$r[D$Y-2])*D$j,(D$r[D$Y+1]-D$r[D$Y-1])*D$T),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&D$X.timer.callLater(this,this._repaintSprite)},D$r._drawTextureM=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){if(!D$s.loaded||!D$s.source)return this.sprite&&D$X.timer.callLater(this,this._repaintSprite),!1;var D$Z=this._curSubmit._vb||this._vb,D$h=D$s.bitmap;D$r+=D$k,D$e+=D$j,this._drawCount++;var D$H=D$h.id+this._shader2D.ALPHA*D$Y+10016;if(D$H!=this._renderKey){this._renderKey=D$H;var D$A=this._curSubmit.shaderValue,D$x=this._shader2D,D$B=D$x.ALPHA;D$x.ALPHA*=D$Y,D$x.glTexture=D$h;var D$$=this._vb,D$l=null,D$V=D$$._byteLength/32*3,D$b=D$A.textureHost&&D$A.textureHost==D$s&&D$A.textureHost.alphaTexture==D$s.alphaTexture;D$l=D$cs.create(this,this._ib,D$$,D$V,D$ns.create(1,0)),(this._submits[this._submits._length++]=D$l).shaderValue.textureHost=D$s,D$l._renderType=10016,D$l._preIsSameTextureShader=10016===this._curSubmit._renderType&&D$x.ALPHA===D$A.ALPHA&&D$b,this._curSubmit=D$l,D$Z=this._curSubmit._vb||this._vb,D$x.ALPHA=D$B}return!!D$ls.fillRectImgVb(D$Z,this._clipRect,D$r,D$e,D$U||D$s.width,D$m||D$s.height,D$s.uv,D$T||this._curMat,this._x,this._y,0,0)&&(D$R.enabled&&!this._isMain&&this._curSubmit.addTexture(D$s,(D$Z._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},D$r._repaintSprite=function(){this.sprite&&this.sprite.repaint()},D$r._drawText=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){var D$h=D$s.bitmap;this._drawCount++;var D$H=D$h.id+this._shader2D.ALPHA+10016;if(D$H!=this._renderKey){this._renderKey=D$H;var D$A=this._curSubmit.shaderValue,D$x=this._shader2D;D$x.glTexture=D$h;var D$B=this._vb,D$$=null,D$l=D$B._byteLength/32*3,D$V=D$A.textureHost&&D$A.textureHost==D$s&&D$A.textureHost.alphaTexture==D$s.alphaTexture;(D$$=D$R.enabled?D$cs.create(this,this._ib,D$B,D$l,D$ns.create(1,0)):D$cs.create(this,this._ib,D$B,D$l,D$us.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&D$x.ALPHA===D$A.ALPHA&&D$V,(this._submits[this._submits._length++]=D$$).shaderValue.textureHost=D$s,D$$._renderType=10016,this._curSubmit=D$$}D$s.active();var D$b=this._curSubmit._vb||this._vb;D$ls.fillRectImgVb(D$b,this._clipRect,D$r+D$j,D$e+D$T,D$U||D$s.width,D$m||D$s.height,D$s.uv,D$k||this._curMat,this._x,this._y,D$Y,D$Z,!0)&&(D$R.enabled&&!this._isMain&&this._curSubmit.addTexture(D$s,(D$b._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},D$r.drawTextureWithTransform=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){if(D$k){var D$Z=this._curMat,D$h=this._x,D$H=this._y;(0!==D$j||0!==D$T)&&(this._x=D$j*D$Z.a+D$T*D$Z.c,this._y=D$T*D$Z.d+D$j*D$Z.b),D$k&&D$Z.bTransform?(D$y.mul(D$k,D$Z,D$C._tmpMatrix),(D$k=D$C._tmpMatrix)._checkTransform()):(this._x+=D$Z.tx,this._y+=D$Z.ty),this._drawTextureM(D$s,D$r,D$e,D$U,D$m,0,0,D$k,D$Y),this._x=D$h,this._y=D$H}else this._drawTextureM(D$s,D$r,D$e,D$U,D$m,D$j,D$T,null,D$Y)},D$r.fillQuadrangle=function(D$s,D$r,D$e,D$U,D$m){var D$k=this._curSubmit,D$j=this._vb,D$T=this._shader2D,D$Y=D$k.shaderValue;if(this._renderKey=0,D$s.bitmap){var D$Z=D$s.bitmap;D$T.glTexture==D$Z&&D$T.ALPHA===D$Y.ALPHA||(D$T.glTexture=D$Z,(D$k=this._curSubmit=D$ks.createSubmit(this,this._ib,D$j,D$j._byteLength/32*3,D$ns.create(1,0))).shaderValue.glTexture=D$Z,this._submits[this._submits._length++]=D$k),D$ls.fillQuadrangleImgVb(D$j,D$r,D$e,D$U,D$s.uv,D$m||this._curMat,this._x,this._y)}else D$k.shaderValue.fillStyle&&D$k.shaderValue.fillStyle.equal(D$s)&&D$T.ALPHA===D$Y.ALPHA||(D$T.glTexture=null,(D$k=this._curSubmit=D$ks.createSubmit(this,this._ib,D$j,D$j._byteLength/32*3,D$ns.create(2,0))).shaderValue.defines.add(2),D$k.shaderValue.fillStyle=D$N.create(D$s),this._submits[this._submits._length++]=D$k),D$ls.fillQuadrangleImgVb(D$j,D$r,D$e,D$U,D$E.DEF_UV,D$m||this._curMat,this._x,this._y);D$k._numEle+=6},D$r.drawTexture2=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){if(0!=D$k){var D$Y=this._curMat;if(this._x=D$s*D$Y.a+D$r*D$Y.c,this._y=D$r*D$Y.d+D$s*D$Y.b,D$m&&(D$m=D$Y.bTransform||D$m.bTransform?(D$y.mul(D$m,D$Y,D$C._tmpMatrix),D$C._tmpMatrix):(this._x+=D$m.tx+D$Y.tx,this._y+=D$m.ty+D$Y.ty,D$y.EMPTY)),1!==D$k||D$j){var D$Z=this._shader2D.ALPHA,D$h=this._nBlendType;this._shader2D.ALPHA=D$k,D$j&&(this._nBlendType=D$p.TOINT(D$j)),this._drawTextureM(D$T[0],D$T[1]-D$e,D$T[2]-D$U,D$T[3],D$T[4],0,0,D$m,1),this._shader2D.ALPHA=D$Z,this._nBlendType=D$h}else this._drawTextureM(D$T[0],D$T[1]-D$e,D$T[2]-D$U,D$T[3],D$T[4],0,0,D$m,1);this._x=this._y=0}},D$r.drawCanvas=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$s.context;if(this._renderKey=0,D$k._targets)this._submits[this._submits._length++]=D$Ks.create(D$k,0,null),this._curSubmit=D$ks.RENDERBASE,D$k._targets.drawTo(this,D$r,D$e,D$U,D$m);else{var D$j=this._submits[this._submits._length++]=D$Ks.create(D$k,this._shader2D.ALPHA,this._shader2D.filters),D$T=D$U/D$s.width,D$Y=D$m/D$s.height,D$Z=D$j._matrix;this._curMat.copyTo(D$Z),1!=D$T&&1!=D$Y&&D$Z.scale(D$T,D$Y);var D$h=D$Z.tx,D$H=D$Z.ty;D$Z.tx=D$Z.ty=0,D$Z.transformPoint(D$g.TEMP.setTo(D$r,D$e)),D$Z.translate(D$g.TEMP.x+D$h,D$g.TEMP.y+D$H),this._curSubmit=D$ks.RENDERBASE}D$D.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=D$k._targets?"yellow":"green",this.strokeRect(D$r-1,D$e-1,D$U+2,D$m+2,1),this.strokeRect(D$r,D$e,D$U,D$m,1),this.restore())},D$r.drawTarget=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){void 0===D$Z&&(D$Z=-1);var D$h=this._vb;if(D$ls.fillRectImgVb(D$h,this._clipRect,D$r,D$e,D$U,D$m,D$Y||D$E.DEF_UV,D$k||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var D$H=this._curSubmit=D$Hs.create(this,this._ib,D$h,(D$h._byteLength-64)/32*3,D$T,D$j);D$H.blendType=-1==D$Z?this._nBlendType:D$Z,D$H.scope=D$s,this._submits[this._submits._length++]=D$H,this._curSubmit._numEle+=6}},D$r.mixRGBandAlpha=function(D$s){return this._mixRGBandAlpha(D$s,this._shader2D.ALPHA)},D$r._mixRGBandAlpha=function(D$s,D$r){var D$e=(4278190080&D$s)>>>24;return 0!=D$e?D$e*=D$r:D$e=255*D$r,16777215&D$s|D$e<<24},D$r.drawTriangles=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){if(!D$s.loaded||!D$s.source)return this.sprite&&D$X.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;D$s.bitmap;var D$h=this._mixRGBandAlpha(4294967295,D$T),D$H=(D$U.length,D$k.length);this._renderKey=-1;var D$A=this._curSubmit=D$cs.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,D$ns.create(1,0));return D$A.shaderValue.textureHost=D$s,D$A._renderType=10016,this._submits[this._submits._length++]=D$A,D$j?(D$C._tmpMatrix.a=D$j.a,D$C._tmpMatrix.b=D$j.b,D$C._tmpMatrix.c=D$j.c,D$C._tmpMatrix.d=D$j.d,D$C._tmpMatrix.tx=D$j.tx+D$r,D$C._tmpMatrix.ty=D$j.ty+D$e,D$y.mul(D$C._tmpMatrix,this._curMat,D$C._tmpMatrix)):(D$C._tmpMatrix.a=this._curMat.a,D$C._tmpMatrix.b=this._curMat.b,D$C._tmpMatrix.c=this._curMat.c,D$C._tmpMatrix.d=this._curMat.d,D$C._tmpMatrix.tx=this._curMat.tx+D$r,D$C._tmpMatrix.ty=this._curMat.ty+D$e),this._triangleMesh.addData(D$U,D$m,D$k,D$C._tmpMatrix,D$h,this),this._curSubmit._numEle+=D$H,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},D$r.transform=function(D$s,D$r,D$e,D$U,D$m,D$k){D$L.save(this),D$y.mul(D$y.TEMP.setTo(D$s,D$r,D$e,D$U,D$m,D$k),this._curMat,this._curMat),this._curMat._checkTransform()},D$r.setTransformByMatrix=function(D$s){D$s.copyTo(this._curMat)},D$r.transformByMatrix=function(D$s){D$L.save(this),D$y.mul(D$s,this._curMat,this._curMat),this._curMat._checkTransform()},D$r.rotate=function(D$s){D$L.save(this),this._curMat.rotateEx(D$s)},D$r.scale=function(D$s,D$r){D$L.save(this),this._curMat.scaleEx(D$s,D$r)},D$r.clipRect=function(D$s,D$r,D$e,D$U){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var D$m=D$hs.create(4);this.addRenderObject(D$m);var D$k=this._vb,D$j=D$k._byteLength>>2;if(D$ls.fillRectImgVb(D$k,null,D$s,D$r,D$e,D$U,D$E.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var D$T=this._curSubmit=D$ks.createSubmit(this,this._ib,D$k,(D$k._byteLength-64)/32*3,D$ns.create(2,0));D$T.shaderValue.ALPHA=1,this._submits[this._submits._length++]=D$T,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var D$Y=D$hs.create(5);this.addRenderObject(D$Y);var D$Z=D$k.getFloat32Array(),D$h=Math.min(Math.min(Math.min(D$Z[0+D$j],D$Z[4+D$j]),D$Z[8+D$j]),D$Z[12+D$j]),D$H=Math.max(Math.max(Math.max(D$Z[0+D$j],D$Z[4+D$j]),D$Z[8+D$j]),D$Z[12+D$j]),D$A=Math.min(Math.min(Math.min(D$Z[1+D$j],D$Z[5+D$j]),D$Z[9+D$j]),D$Z[13+D$j]),D$x=Math.max(Math.max(Math.max(D$Z[1+D$j],D$Z[5+D$j]),D$Z[9+D$j]),D$Z[13+D$j]);D$t.save(this,D$Y,D$s,D$r,D$e,D$U,D$h,D$A,D$H-D$h,D$x-D$A),this._curSubmit=D$ks.RENDERBASE}else{D$e*=this._curMat.a,D$U*=this._curMat.d;var D$B=D$g.TEMP;this._curMat.transformPoint(D$B.setTo(D$s,D$r)),D$e<0&&(D$B.x=D$B.x+D$e,D$e=-D$e),D$U<0&&(D$B.y=D$B.y+D$U,D$U=-D$U),this._renderKey=0;var D$$=this._curSubmit=D$Zs.create(this);(this._submits[this._submits._length++]=D$$).submitIndex=this._submits._length,D$$.submitLength=9999999,D$d.save(this,D$$);var D$l=this._clipRect,D$V=D$l.x,D$b=D$l.y,D$o=D$B.x+D$e,D$I=D$B.y+D$U;D$V<D$B.x&&(D$l.x=D$B.x),D$b<D$B.y&&(D$l.y=D$B.y),D$l.width=Math.min(D$o,D$V+D$l.width)-D$l.x,D$l.height=Math.min(D$I,D$b+D$l.height)-D$l.y,this._shader2D.glTexture=null,D$$.clipRect.copyFrom(D$l),this._curSubmit=D$ks.RENDERBASE}},D$r.setIBVB=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h){if(void 0===D$Y&&(D$Y=0),void 0===D$Z&&(D$Z=0),void 0===D$h&&(D$h=0),null===D$e){if(D$V.isFlash){var D$H=D$U;D$H._selfIB||(D$H._selfIB=D$_s.create(35044)),D$H._selfIB.clear(),D$e=D$H._selfIB}else D$e=this._ib;D$ls.expandIBQuadrangle(D$e,D$U._byteLength/(4*D$U.vertexStride*4))}if(!D$T||!D$j)throw Error("setIBVB must input:shader shaderValues");var D$A=D$Ys.create(this,D$U,D$e,D$m,D$j,D$T,D$Y,D$Z,D$h);D$k||(D$k=D$y.EMPTY),D$k.translate(D$s,D$r),D$y.mul(D$k,this._curMat,D$A._mat),D$k.translate(-D$s,-D$r),this._submits[this._submits._length++]=D$A,this._curSubmit=D$ks.RENDERBASE,this._renderKey=0},D$r.addRenderObject=function(D$s){this._submits[this._submits._length++]=D$s},D$r.fillTrangles=function(D$s,D$r,D$e,D$U,D$m){var D$k=this._curSubmit,D$j=this._vb,D$T=this._shader2D,D$Y=D$k.shaderValue,D$Z=D$U.length>>4,D$h=D$s.bitmap;this._renderKey=0,D$T.glTexture==D$h&&D$T.ALPHA===D$Y.ALPHA||((D$k=this._curSubmit=D$ks.createSubmit(this,this._ib,D$j,D$j._byteLength/32*3,D$ns.create(1,0))).shaderValue.textureHost=D$s,this._submits[this._submits._length++]=D$k),D$ls.fillTranglesVB(D$j,D$r,D$e,D$U,D$m||this._curMat,this._x,this._y),D$k._numEle+=6*D$Z},D$r.submitElement=function(D$s,D$r){var D$e=this._submits;for(D$r<0&&(D$r=D$e._length);D$s<D$r;)D$s+=D$e[D$s].renderSubmit()},D$r.finish=function(){D$Is.mainContext.finish()},D$r.flush=function(){var D$s=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(D$s>this._ib.bufferLength/12&&D$ls.expandIBQuadrangle(this._ib,D$s),!this._isMain&&D$R.enabled&&D$R._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=D$R._atlasRestore;for(var D$r=this._submits,D$e=0,D$U=D$r._length;D$e<D$U;D$e++){var D$m=D$r[D$e];10016===D$m.getRenderType()&&D$m.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),D$rs.instance&&D$rs.getInstance().reset();var D$k;for(D$e=0,D$k=this.meshlist.length;D$e<D$k;D$e++){var D$j=this.meshlist[D$e];D$j.canReuse?D$j.releaseMesh():D$j.destroy()}return this.meshlist.length=0,this._curSubmit=D$ks.RENDERBASE,this._renderKey=0,this._triangleMesh=D$Es.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},D$r.setPathId=function(D$s){if(this.mId=D$s,-1!=this.mId){this.mHaveKey=!1;var D$r=D$S.getInstance();D$r.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,D$r.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},D$r.movePath=function(D$s,D$r){var D$e=D$s,D$U=D$r;D$s=this._curMat.a*D$e+this._curMat.c*D$U+this._curMat.tx,D$r=this._curMat.b*D$e+this._curMat.d*D$U+this._curMat.ty,this.mX+=D$s,this.mY+=D$r},D$r.beginPath=function(){var D$s=this._getPath();D$s.tempArray.length=0,D$s.closePath=!1,this.mX=0,this.mY=0},D$r.closePath=function(){this._path.closePath=!0},D$r.fill=function(D$s){void 0===D$s&&(D$s=!1);var D$r=this._getPath();this.drawPoly(0,0,D$r.tempArray,this.fillStyle._color.numColor,0,0,D$s)},D$r.stroke=function(){var D$s=this._getPath();if(0<this.lineWidth){if(-1==this.mId)D$s.drawLine(0,0,D$s.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var D$r=D$S.getInstance().shapeLineDic[this.mId];D$r.rebuild(D$s.tempArray),D$s.setGeomtry(D$r)}else D$S.getInstance().addLine(this.mId,D$s.drawLine(0,0,D$s.tempArray,this.lineWidth,this.strokeStyle._color.numColor));D$s.update();var D$e=[this.mX,this.mY],D$U=D$ks.createShape(this,D$s.ib,D$s.vb,D$s.count,D$s.offset,D$ns.create(4,0));D$U.shaderValue.ALPHA=this._shader2D.ALPHA,D$U.shaderValue.u_pos=D$e,D$U.shaderValue.u_mmat2=D$bs.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=D$U,this._renderKey=-1}},D$r.line=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=this._curSubmit,D$T=this._vb;if(D$ls.fillLineVb(D$T,this._clipRect,D$s,D$r,D$e,D$U,D$m,D$k)){this._renderKey=0;var D$Y=this._shader2D,D$Z=D$j.shaderValue;D$Y.strokeStyle===D$Z.strokeStyle&&D$Y.ALPHA===D$Z.ALPHA||(D$Y.glTexture=null,(D$j=this._curSubmit=D$ks.createSubmit(this,this._ib,D$T,(D$T._byteLength-64)/32*3,D$ns.create(2,0))).shaderValue.strokeStyle=D$Y.strokeStyle,D$j.shaderValue.mainID=2,D$j.shaderValue.ALPHA=D$Y.ALPHA,this._submits[this._submits._length++]=D$j),D$j._numEle+=6}},D$r.moveTo=function(D$s,D$r,D$e){void 0===D$e&&(D$e=!0);var D$U=this._getPath();if(D$e){var D$m=D$s,D$k=D$r;D$s=this._curMat.a*D$m+this._curMat.c*D$k,D$r=this._curMat.b*D$m+this._curMat.d*D$k}D$U.addPoint(D$s,D$r)},D$r.lineTo=function(D$s,D$r,D$e){void 0===D$e&&(D$e=!0);var D$U=this._getPath();if(D$e){var D$m=D$s,D$k=D$r;D$s=this._curMat.a*D$m+this._curMat.c*D$k,D$r=this._curMat.b*D$m+this._curMat.d*D$k}D$U.addPoint(D$s,D$r)},D$r.drawCurves=function(D$s,D$r,D$e){this.setPathId(-1),this.beginPath(),this.strokeStyle=D$e[3],this.lineWidth=D$e[4];var D$U=D$e[2];D$s+=D$e[0],D$r+=D$e[1],this.movePath(D$s,D$r),this.moveTo(D$U[0],D$U[1]);for(var D$m=2,D$k=D$U.length;D$m<D$k;)this.quadraticCurveTo(D$U[D$m++],D$U[D$m++],D$U[D$m++],D$U[D$m++]);this.stroke()},D$r.arcTo=function(D$s,D$r,D$e,D$U,D$m){if(-1==this.mId||!this.mHaveKey){var D$k=0,D$j=0,D$T=0,D$Y=this._getPath();this._curMat.copyTo(D$C._tmpMatrix),D$C._tmpMatrix.tx=D$C._tmpMatrix.ty=0,D$C._tempPoint.setTo(D$Y.getEndPointX(),D$Y.getEndPointY()),D$C._tmpMatrix.invertTransformPoint(D$C._tempPoint);var D$Z=D$C._tempPoint.x-D$s,D$h=D$C._tempPoint.y-D$r,D$H=Math.sqrt(D$Z*D$Z+D$h*D$h);if(!(D$H<=1e-6)){var D$A=D$Z/D$H,D$x=D$h/D$H,D$B=D$e-D$s,D$$=D$U-D$r,D$l=D$B*D$B+D$$*D$$,D$V=Math.sqrt(D$l);if(!(D$V<=1e-6)){var D$b=D$B/D$V,D$o=D$$/D$V,D$I=D$A+D$b,D$w=D$x+D$o,D$X=Math.sqrt(D$I*D$I+D$w*D$w);if(!(D$X<=1e-6)){var D$D=D$I/D$X,D$n=D$w/D$X,D$y=Math.acos(D$D*D$A+D$n*D$x),D$g=Math.PI/2-D$y,D$f=(D$H=D$m/Math.tan(D$g))*D$A+D$s,D$J=D$H*D$x+D$r,D$P=Math.sqrt(D$H*D$H+D$m*D$m),D$O=D$s+D$D*D$P,D$i=D$r+D$n*D$P,D$K=0,D$c=0;if(0<=D$A*D$o-D$x*D$b){var D$E=2*D$g/D$C.SEGNUM;D$K=Math.sin(D$E),D$c=Math.cos(D$E)}else D$E=2*-D$g/D$C.SEGNUM,D$K=Math.sin(D$E),D$c=Math.cos(D$E);D$j=this._curMat.a*D$f+this._curMat.c*D$J,D$T=this._curMat.b*D$f+this._curMat.d*D$J,D$j==this._path.getEndPointX()&&D$T==this._path.getEndPointY()||D$Y.addPoint(D$j,D$T);var D$v=D$f-D$O,D$S=D$J-D$i;for(D$k=0;D$k<D$C.SEGNUM;D$k++){var D$z=D$v*D$c+D$S*D$K,D$Q=-D$v*D$K+D$S*D$c;D$j=D$z+D$O,D$T=D$Q+D$i,D$s=this._curMat.a*D$j+this._curMat.c*D$T,D$T=D$r=this._curMat.b*D$j+this._curMat.d*D$T,(D$j=D$s)==this._path.getEndPointX()&&D$T==this._path.getEndPointY()||D$Y.addPoint(D$j,D$T),D$v=D$z,D$S=D$Q}}}}}},D$r.arc=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){if(void 0===D$k&&(D$k=!1),void 0===D$j&&(D$j=!0),-1!=this.mId){var D$T=D$S.getInstance().shapeDic[this.mId];if(D$T&&this.mHaveKey&&!D$T.needUpdate(this._curMat))return;D$r=D$s=0}var D$Y,D$Z=0,D$h=0,D$H=0,D$A=0,D$x=0,D$B=0,D$$=0;if(D$h=D$m-D$U,D$k)if(Math.abs(D$h)>=2*Math.PI)D$h=2*-Math.PI;else for(;0<D$h;)D$h-=2*Math.PI;else if(Math.abs(D$h)>=2*Math.PI)D$h=2*Math.PI;else for(;D$h<0;)D$h+=2*Math.PI;D$Y=D$h/(D$$=D$e<101?Math.max(10,D$h*D$e/5):D$e<201?Math.max(10,D$h*D$e/20):Math.max(10,D$h*D$e/40))/2,D$H=Math.abs(4/3*(1-Math.cos(D$Y))/Math.sin(D$Y)),D$k&&(D$H=-D$H);var D$l=this._getPath(),D$V=NaN,D$b=NaN;for(D$B=0;D$B<=D$$;D$B++)D$Z=D$U+D$h*(D$B/D$$),D$A=D$s+Math.cos(D$Z)*D$e,D$x=D$r+Math.sin(D$Z)*D$e,D$j&&(D$V=D$A,D$b=D$x,D$A=this._curMat.a*D$V+this._curMat.c*D$b,D$x=this._curMat.b*D$V+this._curMat.d*D$b),D$A==this._path.getEndPointX()&&D$x==this._path.getEndPointY()||D$l.addPoint(D$A,D$x);D$A=D$s+Math.cos(D$m)*D$e,D$x=D$r+Math.sin(D$m)*D$e,D$j&&(D$V=D$A,D$b=D$x,D$A=this._curMat.a*D$V+this._curMat.c*D$b,D$x=this._curMat.b*D$V+this._curMat.d*D$b),D$A==this._path.getEndPointX()&&D$x==this._path.getEndPointY()||D$l.addPoint(D$A,D$x)},D$r.quadraticCurveTo=function(D$s,D$r,D$e,D$U){var D$m=D$H.I,D$k=D$e,D$j=D$U;D$e=this._curMat.a*D$k+this._curMat.c*D$j,D$U=this._curMat.b*D$k+this._curMat.d*D$j,D$k=D$s,D$j=D$r,D$s=this._curMat.a*D$k+this._curMat.c*D$j,D$r=this._curMat.b*D$k+this._curMat.d*D$j;for(var D$T=D$m.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),D$s,D$r,D$e,D$U],30,2),D$Y=0,D$Z=D$T.length/2;D$Y<D$Z;D$Y++)this.lineTo(D$T[2*D$Y],D$T[2*D$Y+1],!1);this.lineTo(D$e,D$U,!1)},D$r.rect=function(D$s,D$r,D$e,D$U){this._other=this._other.make(),this._other.path||(this._other.path=new D$q),this._other.path.rect(D$s,D$r,D$e,D$U)},D$r.strokeRect=function(D$s,D$r,D$e,D$U,D$m){var D$k=.5*D$m;this.line(D$s-D$k,D$r,D$s+D$e+D$k,D$r,D$m,this._curMat),this.line(D$s+D$e,D$r,D$s+D$e,D$r+D$U,D$m,this._curMat),this.line(D$s,D$r,D$s,D$r+D$U,D$m,this._curMat),this.line(D$s-D$k,D$r+D$U,D$s+D$e+D$k,D$r+D$U,D$m,this._curMat)},D$r.clip=function(){},D$r.drawPoly=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){void 0===D$j&&(D$j=!1),this._renderKey=0,this._shader2D.glTexture=null;var D$T=this._getPath();if(-1==this.mId)D$T.polygon(D$s,D$r,D$e,D$U,D$m||1,D$k);else if(this.mHaveKey){var D$Y=D$S.getInstance().shapeDic[this.mId];D$Y.setMatrix(this._curMat),D$Y.rebuild(D$T.tempArray),D$T.setGeomtry(D$Y)}else{var D$Z=D$T.polygon(D$s,D$r,D$e,D$U,D$m||1,D$k);D$S.getInstance().addShape(this.mId,D$Z),D$Z.setMatrix(this._curMat)}D$T.update();var D$h,D$H=[this.mX,this.mY];if((D$h=D$ks.createShape(this,D$T.ib,D$T.vb,D$T.count,D$T.offset,D$ns.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,D$h.shaderValue.u_pos=D$H,D$h.shaderValue.u_mmat2=D$bs.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=D$h,0<D$m){if(this.mHaveLineKey){var D$A=D$S.getInstance().shapeLineDic[this.mId];D$A.rebuild(D$T.tempArray),D$T.setGeomtry(D$A)}else D$S.getInstance().addShape(this.mId,D$T.drawLine(D$s,D$r,D$e,D$m,D$k));D$T.update(),(D$h=D$ks.createShape(this,D$T.ib,D$T.vb,D$T.count,D$T.offset,D$ns.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,D$h.shaderValue.u_mmat2=D$bs.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=D$h}},D$r.drawParticle=function(D$s,D$r,D$e){D$e.x=D$s,D$e.y=D$r,this._submits[this._submits._length++]=D$e},D$r._getPath=function(){return this._path||(this._path=new D$q)},D$U(0,D$r,"globalCompositeOperation",function(){return D$p.NAMES[this._nBlendType]},function(D$s){var D$r=D$p.TOINT[D$s];null==D$r||this._nBlendType===D$r||(D$G.save(this,65536,this,!0),this._curSubmit=D$ks.RENDERBASE,this._renderKey=0,this._nBlendType=D$r)}),D$U(0,D$r,"strokeStyle",function(){return this._shader2D.strokeStyle},function(D$s){this._shader2D.strokeStyle.equal(D$s)||(D$G.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=D$N.create(D$s))}),D$U(0,D$r,"globalAlpha",function(){return this._shader2D.ALPHA},function(D$s){(D$s=Math.floor(1e3*D$s)/1e3)!=this._shader2D.ALPHA&&(D$G.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=D$s)}),D$U(0,D$r,"asBitmap",null,function(D$s){if(D$s){if(this._targets||(this._targets=new D$M),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),D$U(0,D$r,"fillStyle",function(){return this._shader2D.fillStyle},function(D$s){this._shader2D.fillStyle.equal(D$s)||(D$G.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=D$N.create(D$s))}),D$U(0,D$r,"textAlign",function(){return this._other.textAlign},function(D$s){this._other.textAlign===D$s||(this._other=this._other.make(),D$G.save(this,32768,this._other,!1),this._other.textAlign=D$s)}),D$U(0,D$r,"lineWidth",function(){return this._other.lineWidth},function(D$s){this._other.lineWidth===D$s||(this._other=this._other.make(),D$G.save(this,256,this._other,!1),this._other.lineWidth=D$s)}),D$U(0,D$r,"textBaseline",function(){return this._other.textBaseline},function(D$s){this._other.textBaseline===D$s||(this._other=this._other.make(),D$G.save(this,16384,this._other,!1),this._other.textBaseline=D$s)}),D$U(0,D$r,"font",null,function(D$s){D$s!=this._other.font.toString()&&(this._other=this._other.make(),D$G.save(this,8,this._other,!1),this._other.font===D$Bs.EMPTY?this._other.font=new D$Bs(D$s):this._other.font.setFont(D$s))}),D$C.__init__=function(){D$e.DEFAULT=new D$e},D$C._tempPoint=new D$g,D$C._SUBMITVBSIZE=32e3,D$C._MAXSIZE=99999999,D$C._RECTVBSIZE=16,D$C.MAXCLIPRECT=new D$f(0,0,99999999,99999999),D$C._COUNT=0,D$C._tmpMatrix=new D$y,D$C.SEGNUM=32,D$C._contextcount=0,D$j(D$C,["_fontTemp",function(){return this._fontTemp=new D$Bs},"_drawStyleTemp",function(){return this._drawStyleTemp=new D$N(null)}]),D$C.__init$=function(){D$e=function(){function D$s(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=D$Bs.EMPTY}D$A(D$s,"");var D$r=D$s.prototype;return D$r.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=D$Bs.EMPTY},D$r.make=function(){return this===D$s.DEFAULT?new D$s:this},D$s.DEFAULT=null,D$s}()},D$C}(),D$ns=function(D$s){function D$U(D$s,D$r){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,D$U.__super.call(this),this.defines=new D$Js,this.position=D$U._POSITION,this.mainID=D$s,this.subID=D$r,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=D$s|D$r,this._inClassCache=D$U._cache[this._cacheID],0<D$s&&!this._inClassCache&&(this._inClassCache=D$U._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}D$A(D$U,"laya.webgl.shader.d2.value.Value2D",D$Q);var D$r=D$U.prototype;return D$r.setValue=function(D$s){},D$r.refresh=function(){var D$s=this.size;return D$s[0]=D$bs.width,D$s[1]=D$bs.height,this.alpha=this.ALPHA*D$bs.worldAlpha,this.mmat=D$bs.worldMatrix4,this},D$r._ShaderWithCompile=function(){return D$Ws.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,D$Ms.create)},D$r._withWorldShaderDefines=function(){var D$s=D$bs.worldShaderDefines,D$r=D$Ws.sharders[this.mainID|this.defines._value|D$s.getValue()];if(!D$r){var D$e,D$U={};for(D$e in this.defines.toNameDic())D$U[D$e]="";for(D$e in D$s.toNameDic())D$U[D$e]="";D$r=D$Ws.withCompile2D(0,this.mainID,D$U,this.mainID|this.defines._value|D$s.getValue(),D$Ms.create)}var D$m=D$bs.worldFilters;if(!D$m)return D$r;for(var D$k,D$j=D$m.length,D$T=0;D$T<D$j;D$T++)(D$k=D$m[D$T])&&D$k.action.setValue(this);return D$r},D$r.upload=function(){var D$s=D$bs;this.alpha=this.ALPHA*D$s.worldAlpha,D$bs.worldMatrix4!==D$bs.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),D$Is.shaderHighPrecision&&this.defines.add(1024);var D$r,D$e=D$s.worldShaderDefines?this._withWorldShaderDefines():D$Ws.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=D$s.width,this.size[1]=D$s.height,this.mmat=D$s.worldMatrix4,D$vs.activeShader!==D$e?D$e._shaderValueWidth!==D$s.width||D$e._shaderValueHeight!==D$s.height?(D$e._shaderValueWidth=D$s.width,D$e._shaderValueHeight=D$s.height):D$r=D$e._params2dQuick2||D$e._make2dQuick2():D$e._shaderValueWidth!==D$s.width||D$e._shaderValueHeight!==D$s.height?(D$e._shaderValueWidth=D$s.width,D$e._shaderValueHeight=D$s.height):D$r=D$e._params2dQuick1||D$e._make2dQuick1(),D$e.upload(this,D$r)},D$r.setFilters=function(D$s){if(this.filters=D$s)for(var D$r,D$e=D$s.length,D$U=0;D$U<D$e;D$U++)(D$r=D$s[D$U])&&(this.defines.add(D$r.type),D$r.action.setValue(this))},D$r.clear=function(){this.defines.setValue(this.subID)},D$r.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},D$U._initone=function(D$s,D$r){D$U._typeClass[D$s]=D$r,D$U._cache[D$s]=[],D$U._cache[D$s]._length=0},D$U.__init__=function(){D$U._POSITION=[2,5126,!1,4*D$$s.BYTES_PE,0],D$U._TEXCOORD=[2,5126,!1,4*D$$s.BYTES_PE,2*D$$s.BYTES_PE],D$U._initone(2,D$Cs),D$U._initone(4,D$ps),D$U._initone(256,D$Rs),D$U._initone(512,D$Qs),D$U._initone(1,D$as),D$U._initone(65,D$us),D$U._initone(9,D$as)},D$U.create=function(D$s,D$r){var D$e=D$U._cache[D$s|D$r];return D$e._length?D$e[--D$e._length]:new D$U._typeClass[D$s|D$r](D$r)},D$U._POSITION=null,D$U._TEXCOORD=null,D$U._cache=[],D$U._typeClass=[],D$U.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D$U}(),D$ys=function(D$s){function D$l(D$s,D$r){D$l.__super.call(this,D$s,D$r)}D$A(D$l,"laya.webgl.utils.RenderSprite3D",D$b);var D$r=D$l.prototype;return D$r.onCreate=function(D$s){switch(D$s){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},D$r._mask=function(D$s,D$r,D$e,D$U){var D$m,D$k,D$j=this._next,D$T=D$s.mask;if(D$T){D$r.ctx.save();var D$Y=D$r.ctx.globalCompositeOperation,D$Z=new D$f;if(D$Z.copyFrom(D$T.getBounds()),D$Z.width=Math.round(D$Z.width),D$Z.height=Math.round(D$Z.height),D$Z.x=Math.round(D$Z.x),D$Z.y=Math.round(D$Z.y),0<D$Z.width&&0<D$Z.height){var D$h=D$s._style._tf,D$H=D$Ts.create();D$H.addValue("bounds",D$Z),D$m=D$js.create([D$H,D$r],laya.webgl.utils.RenderSprite3D.tmpTarget),D$r.addRenderObject(D$m),D$T.render(D$r,-D$Z.x,-D$Z.y),D$m=D$js.create([D$H],laya.webgl.utils.RenderSprite3D.endTmpTarget),D$r.addRenderObject(D$m),D$r.ctx.save(),D$r.clipRect(D$e-D$h.translateX+D$Z.x,D$U-D$h.translateY+D$Z.y,D$Z.width,D$Z.height),D$j._fun.call(D$j,D$s,D$r,D$e,D$U),D$r.ctx.restore(),D$k=D$hs.create(6),D$Y=D$r.ctx.globalCompositeOperation,D$k.blendMode="mask",D$r.addRenderObject(D$k),D$y.TEMP.identity();var D$A=D$ns.create(1,0),D$x=D$E.INV_UV,D$B=D$Z.width,D$$=D$Z.height;(D$Z.width<32||D$Z.height<32)&&((D$x=D$l.tempUV)[0]=0,D$x[1]=0,D$x[2]=32<=D$Z.width?1:D$Z.width/32,D$x[3]=0,D$x[4]=32<=D$Z.width?1:D$Z.width/32,D$x[5]=32<=D$Z.height?1:D$Z.height/32,D$x[6]=0,D$x[7]=32<=D$Z.height?1:D$Z.height/32,D$Z.width=32<=D$Z.width?D$Z.width:32,D$Z.height=32<=D$Z.height?D$Z.height:32,D$x[1]*=-1,D$x[3]*=-1,D$x[5]*=-1,D$x[7]*=-1,D$x[1]+=1,D$x[3]+=1,D$x[5]+=1,D$x[7]+=1),D$r.ctx.drawTarget(D$H,D$e+D$Z.x-D$h.translateX,D$U+D$Z.y-D$h.translateY,D$B,D$$,D$y.TEMP,"tmpTarget",D$A,D$x,6),D$m=D$js.create([D$H],laya.webgl.utils.RenderSprite3D.recycleTarget),D$r.addRenderObject(D$m),(D$k=D$hs.create(6)).blendMode=D$Y,D$r.addRenderObject(D$k)}D$r.ctx.restore()}else D$j._fun.call(D$j,D$s,D$r,D$e,D$U)},D$r._blend=function(D$s,D$r,D$e,D$U){var D$m=D$s._style,D$k=this._next;D$m.blendMode?(D$r.ctx.save(),D$r.ctx.globalCompositeOperation=D$m.blendMode,D$k._fun.call(D$k,D$s,D$r,D$e,D$U),D$r.ctx.restore()):D$k._fun.call(D$k,D$s,D$r,D$e,D$U)},D$r._transform=function(D$s,D$r,D$e,D$U){var D$m=D$s.transform,D$k=this._next;if(D$m&&D$k!=D$b.NORENDER){var D$j=D$r.ctx;D$s._style;D$m.tx=D$e,D$m.ty=D$U;var D$T=D$j._getTransformMatrix(),D$Y=D$T.clone();D$y.mul(D$m,D$T,D$T),D$T._checkTransform(),D$m.tx=D$m.ty=0,D$k._fun.call(D$k,D$s,D$r,0,0),D$Y.copyTo(D$T),D$Y.destroy()}else D$k._fun.call(D$k,D$s,D$r,D$e,D$U)},D$l.tmpTarget=function(D$s,D$r){var D$e=D$s.getValue("bounds"),D$U=D$Ss.create(D$e.width,D$e.height);D$U.start(),D$U.clear(0,0,0,0),D$s.addValue("tmpTarget",D$U)},D$l.endTmpTarget=function(D$s){D$s.getValue("tmpTarget").end()},D$l.recycleTarget=function(D$s){D$s.getValue("tmpTarget").recycle(),D$s.recycle()},D$j(D$l,["tempUV",function(){return this.tempUV=new Array(8)}]),D$l}(),D$gs=function(D$s){function D$r(){this.data=null,D$r.__super.call(this)}D$A(D$r,"laya.filters.webgl.ColorFilterActionGL",D$z);var D$e=D$r.prototype;return D$X.imps(D$e,{"laya.filters.IFilterActionGL":!0}),D$e.setValue=function(D$s){D$s.colorMat=this.data._mat,D$s.colorAlpha=this.data._alpha},D$e.apply3d=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$s.getValue("bounds"),D$j=D$ns.create(1,0);D$j.setFilters([this.data]);var D$T=D$y.TEMP;D$T.identity(),D$e.ctx.drawTarget(D$s,0,0,D$k.width,D$k.height,D$T,"src",D$j)},D$r}(),D$fs=function(D$s){function D$k(D$s,D$r,D$e,D$U,D$m){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,D$k.__super.call(this,D$s,D$r,D$m),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new D$Ns,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=D$e,this._atlasCanvas.height=D$U,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}D$A(D$k,"laya.webgl.atlas.Atlaser",D$C);var D$r=D$k.prototype;return D$r.computeUVinAtlasTexture=function(D$s,D$r,D$e,D$U){var D$m=D$R.atlasTextureWidth,D$k=D$R.atlasTextureHeight,D$j=D$e/D$m,D$T=D$U/D$k,D$Y=(D$e+D$s.bitmap.width)/D$m,D$Z=(D$U+D$s.bitmap.height)/D$k,D$h=D$s.bitmap.width/D$m,D$H=D$s.bitmap.height/D$k;D$s.uv=[D$j+D$r[0]*D$h,D$T+D$r[1]*D$H,D$Y-(1-D$r[2])*D$h,D$T+D$r[3]*D$H,D$Y-(1-D$r[4])*D$h,D$Z-(1-D$r[5])*D$H,D$j+D$r[6]*D$h,D$Z-(1-D$r[7])*D$H]},D$r.findBitmapIsExist=function(D$s){if(D$s instanceof laya.webgl.resource.WebGLImage){var D$r=D$s,D$e=D$r.url,D$U=this._InAtlasWebGLImagesKey[D$e||D$r.id];if(D$U)return D$U.offsetInfoID}return-1},D$r.addToAtlasTexture=function(D$s,D$r,D$e){if(D$s instanceof laya.webgl.resource.WebGLImage){var D$U=D$s,D$m=D$U.url;this._InAtlasWebGLImagesKey[D$m||D$U.id]={bitmap:D$s,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([D$r,D$e])}this._atlasCanvas.texSubImage2D(D$r,D$e,D$s.atlasSource),D$s.clearAtlasSource()},D$r.addToAtlas=function(D$s,D$r,D$e){D$s._atlasID=this._inAtlasTextureKey.length;var D$U=D$s.uv.slice(),D$m=D$s.bitmap;this._inAtlasTextureKey.push(D$s),this._inAtlasTextureOriUVValue.push(D$U),this._inAtlasTextureBitmapValue.push(D$m),this.computeUVinAtlasTexture(D$s,D$U,D$r,D$e),D$s.bitmap=this._atlasCanvas},D$r.clear=function(){for(var D$s=0,D$r=this._inAtlasTextureKey.length;D$s<D$r;D$s++)this._inAtlasTextureKey[D$s].bitmap=this._inAtlasTextureBitmapValue[D$s],this._inAtlasTextureKey[D$s].uv=this._inAtlasTextureOriUVValue[D$s],this._inAtlasTextureKey[D$s]._atlasID=-1,this._inAtlasTextureKey[D$s].bitmap.lock=!1,this._inAtlasTextureKey[D$s].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},D$r.dispose=function(){this.clear(),this._atlasCanvas.destroy()},D$U(0,D$r,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),D$U(0,D$r,"texture",function(){return this._atlasCanvas}),D$U(0,D$r,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),D$k}(),D$Js=function(D$s){function D$e(){D$e.__super.call(this,D$e.__name2int,D$e.__int2name,D$e.__int2nameMap)}return D$A(D$e,"laya.webgl.shader.d2.ShaderDefines2D",D$F),D$e.__init__=function(){D$e.reg("TEXTURE2D",1),D$e.reg("COLOR2D",2),D$e.reg("PRIMITIVE",4),D$e.reg("GLOW_FILTER",8),D$e.reg("BLUR_FILTER",16),D$e.reg("COLOR_FILTER",32),D$e.reg("COLOR_ADD",64),D$e.reg("WORLDMAT",128),D$e.reg("FILLTEXTURE",256),D$e.reg("FSHIGHPRECISION",1024),D$e.reg("TXTALPHA",2048),D$e.reg("TXTCOMPRESS",4096)},D$e.reg=function(D$s,D$r){D$F._reg(D$s,D$r,D$e.__name2int,D$e.__int2name)},D$e.toText=function(D$s,D$r,D$e){return D$F._toText(D$s,D$r,D$e)},D$e.toInt=function(D$s){return D$F._toInt(D$s,D$e.__name2int)},D$e.TEXTURE2D=1,D$e.COLOR2D=2,D$e.PRIMITIVE=4,D$e.FILTERGLOW=8,D$e.FILTERBLUR=16,D$e.FILTERCOLOR=32,D$e.COLORADD=64,D$e.WORLDMAT=128,D$e.FILLTEXTURE=256,D$e.SKINMESH=512,D$e.SHADERDEFINE_FSHIGHPRECISION=1024,D$e.TXTALPHA=2048,D$e.TXTCOMPRESS=4096,D$e.__name2int={},D$e.__int2name=[],D$e.__int2nameMap=[],D$e}(),D$Ps=(function(D$s){function D$T(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$T.__super.call(this,D$s,D$r,D$e,D$U,40,D$m,D$k,D$j)}D$A(D$T,"laya.webgl.shapes.Ellipse",D$es)}(),function(D$s){function D$k(D$s,D$r,D$e,D$U,D$m){this._points=[],this.rebuild(D$e),D$k.__super.call(this,D$s,D$r,0,0,0,D$m,D$U,D$m,0)}D$A(D$k,"laya.webgl.shapes.Line",D$es);var D$r=D$k.prototype;return D$r.rebuild=function(D$s){var D$r=D$s.length;D$r!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(D$r/2-1)),this.mFloat32Array=new Float32Array(5*D$r)),this._points.length=0;for(var D$e=NaN,D$U=NaN,D$m=-1,D$k=-1,D$j=D$s.length/2,D$T=0;D$T<D$j;D$T++)D$e=D$s[2*D$T],D$U=D$s[2*D$T+1],(.01<Math.abs(D$m-D$e)||.01<Math.abs(D$k-D$U))&&this._points.push(D$e,D$U),D$m=D$e,D$k=D$U},D$r.getData=function(D$s,D$r,D$e){var D$U=[],D$m=[];0<this.borderWidth&&this.createLine2(this._points,D$U,this.borderWidth,D$e,D$m,this._points.length/2),this.mUint16Array.set(D$U,0),this.mFloat32Array.set(D$m,0),D$s.append(this.mUint16Array),D$r.append(this.mFloat32Array)},D$k}()),D$Os=function(D$s){function D$H(D$s,D$r,D$e,D$U,D$m){this._points=[];for(var D$k=NaN,D$j=NaN,D$T=-1,D$Y=-1,D$Z=D$e.length/2-1,D$h=0;D$h<D$Z;D$h++)D$k=D$e[2*D$h],D$j=D$e[2*D$h+1],(.01<Math.abs(D$T-D$k)||.01<Math.abs(D$Y-D$j))&&this._points.push(D$k,D$j),D$T=D$k,D$Y=D$j;D$k=D$e[2*D$Z],D$j=D$e[2*D$Z+1],D$T=this._points[0],D$Y=this._points[1],(.01<Math.abs(D$T-D$k)||.01<Math.abs(D$Y-D$j))&&this._points.push(D$k,D$j),D$H.__super.call(this,D$s,D$r,0,0,this._points.length/2,0,D$U,D$m)}D$A(D$H,"laya.webgl.shapes.LoopLine",D$es);var D$r=D$H.prototype;return D$r.getData=function(D$s,D$r,D$e){if(0<this.borderWidth){for(var D$U=this.color,D$m=(D$U>>16&255)/255,D$k=(D$U>>8&255)/255,D$j=(255&D$U)/255,D$T=[],D$Y=0,D$Z=0,D$h=[],D$H=Math.floor(this._points.length/2),D$A=0;D$A<D$H;D$A++)D$Y=this._points[2*D$A],D$Z=this._points[2*D$A+1],D$T.push(this.x+D$Y,this.y+D$Z,D$m,D$k,D$j);this.createLoopLine(D$T,D$h,this.borderWidth,D$e+D$T.length/5),D$s.append(new Uint16Array(D$h)),D$r.append(new Float32Array(D$T))}},D$r.createLoopLine=function(D$s,D$r,D$e,D$U,D$m,D$k){D$s.length;var D$j=D$s.concat(),D$T=D$m||D$s,D$Y=this.borderColor,D$Z=(D$Y>>16&255)/255,D$h=(D$Y>>8&255)/255,D$H=(255&D$Y)/255,D$A=[D$j[0],D$j[1]],D$x=[D$j[D$j.length-5],D$j[D$j.length-4]],D$B=D$x[0]+.5*(D$A[0]-D$x[0]),D$$=D$x[1]+.5*(D$A[1]-D$x[1]);D$j.unshift(D$B,D$$,0,0,0),D$j.push(D$B,D$$,0,0,0);var D$l,D$V,D$b,D$o,D$I,D$w,D$X,D$D,D$n,D$y,D$g,D$f,D$J,D$P,D$O,D$i,D$K,D$c,D$E,D$v,D$S=D$j.length/5,D$z=D$U,D$Q=D$e/2;D$b=D$j[0],D$o=D$j[1],D$y=D$b-(D$I=D$j[5]),D$n=(D$n=-(D$o-(D$w=D$j[6])))/(D$v=Math.sqrt(D$n*D$n+D$y*D$y))*D$Q,D$y=D$y/D$v*D$Q,D$T.push(D$b-D$n,D$o-D$y,D$Z,D$h,D$H,D$b+D$n,D$o+D$y,D$Z,D$h,D$H);for(var D$C=1;D$C<D$S-1;D$C++)D$b=D$j[5*(D$C-1)],D$o=D$j[5*(D$C-1)+1],D$I=D$j[5*D$C],D$w=D$j[5*D$C+1],D$X=D$j[5*(D$C+1)],D$D=D$j[5*(D$C+1)+1],D$y=D$b-D$I,D$f=D$I-D$X,D$O=(-(D$n=(D$n=-(D$o-D$w))/(D$v=Math.sqrt(D$n*D$n+D$y*D$y))*D$Q)+D$b)*(-(D$y=D$y/D$v*D$Q)+D$w)-(-D$n+D$I)*(-D$y+D$o),D$c=(-(D$g=(D$g=-(D$w-D$D))/(D$v=Math.sqrt(D$g*D$g+D$f*D$f))*D$Q)+D$X)*(-(D$f=D$f/D$v*D$Q)+D$w)-(-D$g+D$I)*(-D$f+D$D),D$E=(D$J=-D$y+D$o-(-D$y+D$w))*(D$K=-D$g+D$I-(-D$g+D$X))-(D$i=-D$f+D$D-(-D$f+D$w))*(D$P=-D$n+D$I-(-D$n+D$b)),Math.abs(D$E)<.1?(D$E+=10.1,D$T.push(D$I-D$n,D$w-D$y,D$Z,D$h,D$H,D$I+D$n,D$w+D$y,D$Z,D$h,D$H)):(((D$l=(D$P*D$c-D$K*D$O)/D$E)-D$I)*(D$l-D$I)+((D$V=(D$i*D$O-D$J*D$c)/D$E)-D$w)+(D$V-D$w),D$T.push(D$l,D$V,D$Z,D$h,D$H,D$I-(D$l-D$I),D$w-(D$V-D$w),D$Z,D$h,D$H));D$k&&(D$r=D$k);var D$R=this.edges+1;for(D$C=1;D$C<D$R;D$C++)D$r.push(D$z+2*(D$C-1),D$z+2*(D$C-1)+1,D$z+2*D$C+1,D$z+2*D$C+1,D$z+2*D$C,D$z+2*(D$C-1));return D$r.push(D$z+2*(D$C-1),D$z+2*(D$C-1)+1,D$z+1,D$z+1,D$z,D$z+2*(D$C-1)),D$T},D$H}(),D$is=function(D$s){function D$j(D$s,D$r,D$e,D$U,D$m,D$k){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=D$y.create(),this._points=D$e.slice(0,D$e.length),D$j.__super.call(this,D$s,D$r,0,0,this._points.length/2,D$U,D$m,D$k)}D$A(D$j,"laya.webgl.shapes.Polygon",D$es);var D$r=D$j.prototype;return D$r.rebuild=function(D$s){this._repaint||(this._points.length=0,this._points=this._points.concat(D$s))},D$r.setMatrix=function(D$s){D$s.copyTo(this._mat)},D$r.needUpdate=function(D$s){return this._repaint=this._mat.a==D$s.a&&this._mat.b==D$s.b&&this._mat.c==D$s.c&&this._mat.d==D$s.d&&this._mat.tx==D$s.tx&&this._mat.ty==D$s.ty,!this._repaint},D$r.getData=function(D$s,D$r,D$e){var D$U,D$m=0,D$k=this._points,D$j=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=D$e){for(this._start=D$e,D$U=[],D$j=this.earcutTriangles.length,D$m=0;D$m<D$j;D$m++)D$U.push(this.earcutTriangles[D$m]+D$e);this.mUint16Array=new Uint16Array(D$U)}}else{this._start=D$e,D$U=[];var D$T=[],D$Y=[],D$Z=this.color,D$h=(D$Z>>16&255)/255,D$H=(D$Z>>8&255)/255,D$A=(255&D$Z)/255;for(D$j=Math.floor(D$k.length/2),D$m=0;D$m<D$j;D$m++)D$T.push(this.x+D$k[2*D$m],this.y+D$k[2*D$m+1],D$h,D$H,D$A),D$Y.push(this.x+D$k[2*D$m],this.y+D$k[2*D$m+1]);for(this.earcutTriangles=D$Us.earcut(D$Y,null,2),D$j=this.earcutTriangles.length,D$m=0;D$m<D$j;D$m++)D$U.push(this.earcutTriangles[D$m]+D$e);this.mUint16Array=new Uint16Array(D$U),this.mFloat32Array=new Float32Array(D$T)}D$s.append(this.mUint16Array),D$r.append(this.mFloat32Array)},D$j}(),D$Ks=function(D$s){function D$k(){this._matrix=new D$y,this._matrix4=D$$s.defaultMatrix4.concat(),D$k.__super.call(this,1e4),this.shaderValue=new D$ns(0,0)}D$A(D$k,"laya.webgl.submit.SubmitCanvas",D$ks);var D$r=D$k.prototype;return D$r.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var D$s=D$bs.worldAlpha,D$r=D$bs.worldMatrix4,D$e=D$bs.worldMatrix,D$U=D$bs.worldFilters,D$m=D$bs.worldShaderDefines,D$k=this.shaderValue,D$j=this._matrix,D$T=this._matrix4,D$Y=D$y.TEMP;return D$y.mul(D$j,D$e,D$Y),D$T[0]=D$Y.a,D$T[1]=D$Y.b,D$T[4]=D$Y.c,D$T[5]=D$Y.d,D$T[12]=D$Y.tx,D$T[13]=D$Y.ty,D$bs.worldMatrix=D$Y.clone(),D$bs.worldMatrix4=D$T,D$bs.worldAlpha=D$bs.worldAlpha*D$k.alpha,D$k.filters&&D$k.filters.length&&(D$bs.worldFilters=D$k.filters,D$bs.worldShaderDefines=D$k.defines),this._ctx_src.flush(),D$bs.worldAlpha=D$s,D$bs.worldMatrix4=D$r,D$bs.worldMatrix.destroy(),D$bs.worldMatrix=D$e,D$bs.worldFilters=D$U,D$bs.worldShaderDefines=D$m,1},D$r.releaseRender=function(){var D$s=D$k._cache;this._ctx_src=null,D$s[D$s._length++]=this},D$r.getRenderType=function(){return 10003},D$k.create=function(D$s,D$r,D$e){var D$U=D$k._cache._length?D$k._cache[--D$k._cache._length]:new D$k;D$U._ctx_src=D$s;var D$m=D$U.shaderValue;return D$m.alpha=D$r,D$m.defines.setValue(0),D$e&&D$e.length&&D$m.setFilters(D$e),D$U},D$k._cache=((D$k._cache=[])._length=0,D$k._cache),D$k}(),D$cs=function(D$s){function D$Z(D$s){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===D$s&&(D$s=1e4),D$Z.__super.call(this,D$s)}D$A(D$Z,"laya.webgl.submit.SubmitTexture",D$ks);var D$r=D$Z.prototype;return D$r.releaseRender=function(){var D$s=D$Z._cache;(D$s[D$s._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},D$r.addTexture=function(D$s,D$r){this._texsID[this._texs.length]=D$s._uvID,this._texs.push(D$s),this._vbPos.push(D$r)},D$r.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var D$s=this.shaderValue.textureHost.bitmap;if(null!==D$s)for(var D$r=this._vb.getFloat32Array(),D$e=0,D$U=this._texs.length;D$e<D$U;D$e++){var D$m=this._texs[D$e];D$m.active();var D$k=D$m.uv;if(this._texsID[D$e]!==D$m._uvID){this._texsID[D$e]=D$m._uvID;var D$j=this._vbPos[D$e];D$r[D$j+2]=D$k[0],D$r[D$j+3]=D$k[1],D$r[D$j+6]=D$k[2],D$r[D$j+7]=D$k[3],D$r[D$j+10]=D$k[4],D$r[D$j+11]=D$k[5],D$r[D$j+14]=D$k[6],D$r[D$j+15]=D$k[7],this._vb.setNeedUpload()}D$m.bitmap!==D$s&&(this._isSameTexture=!1)}}},D$r.renderSubmit=function(){if(0===this._numEle)return D$Z._shaderSet=!1,1;var D$s=this.shaderValue.textureHost;if(D$s){var D$r=D$s.source;if(!D$s.bitmap||!D$r)return D$Z._shaderSet=!1,1;this.shaderValue.texture=D$r,D$s.alphaTexture&&D$s.alphaTexture.source&&(this.shaderValue.texture1=D$s.alphaTexture.source)}this._vb.bind_upload(this._ib);var D$e=D$Is.mainContext;if(D$p.activeBlendFunction!==this._blendFn&&(D$e.enable(3042),this._blendFn(D$e),D$p.activeBlendFunction=this._blendFn),D$O.drawCall++,D$O.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&D$vs.activeShader&&D$Z._shaderSet?(D$vs.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&D$vs.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),D$Z._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var D$U=D$s.bitmap,D$m=0,D$k=D$vs.activeShader,D$j=0,D$T=this._texs.length;D$j<D$T;D$j++){var D$Y=this._texs[D$j];D$Y.bitmap===D$U&&D$j+1!==D$T||(D$k.uploadTexture2D(D$Y.source),D$e.drawElements(4,6*(D$j-D$m+1),5123,this._startIdx+6*D$m*D$$s.BYTES_PIDX),D$U=D$Y.bitmap,D$m=D$j)}else D$e.drawElements(4,this._numEle,5123,this._startIdx);return 1},D$Z.create=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$Z._cache._length?D$Z._cache[--D$Z._cache._length]:new D$Z;null==D$e&&((D$e=D$k._selfVb||(D$k._selfVb=D$Fs.create(-1))).clear(),D$U=0),D$k._ib=D$r,D$k._vb=D$e,D$k._startIdx=D$U*D$$s.BYTES_PIDX,D$k._numEle=0;var D$j=D$s._nBlendType;D$k._blendFn=D$s._targets?D$p.targetFns[D$j]:D$p.fns[D$j],D$k.shaderValue=D$m,D$k.shaderValue.setValue(D$s._shader2D);var D$T=D$s._shader2D.filters;return D$T&&D$k.shaderValue.setFilters(D$T),D$k},D$Z._cache=((D$Z._cache=[])._length=0,D$Z._cache),D$Z._shaderSet=!0,D$Z}(),D$Es=function(D$s){function D$V(){D$V.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}D$A(D$V,"laya.webgl.utils.MeshTexture",D$Vs);var D$r=D$V.prototype;return D$r.addData=function(D$s,D$r,D$e,D$U,D$m,D$k){for(var D$j=D$s.length/2,D$T=this._vb.needSize(D$j*D$V.const_stride)>>2,D$Y=this._vb.getFloat32Array(),D$Z=0,D$h=0;D$h<D$j;D$h++){var D$H=D$s[D$Z],D$A=D$s[D$Z+1],D$x=D$H*D$U.a+D$A*D$U.c+D$U.tx,D$B=D$H*D$U.b+D$A*D$U.d+D$U.ty;D$Y[D$T++]=D$x,D$Y[D$T++]=D$B,D$Y[D$T++]=D$r[D$Z],D$Y[D$T++]=D$r[D$Z+1],D$Z+=2}this._vb.setNeedUpload();var D$$=this.vertNum;if(0<D$$){(D$j=D$e.length)>D$V.tmpIdx.length&&(D$V.tmpIdx=new Uint16Array(D$j));for(var D$l=0;D$l<D$j;D$l++)D$V.tmpIdx[D$l]=D$e[D$l]+D$$;this._ib.appendU16Array(D$V.tmpIdx,D$e.length)}else this._ib.append(D$e);this._ib.setNeedUpload(),this.vertNum+=D$j,this.indexNum+=D$e.length},D$r.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},D$r.destroy=function(){this._ib.destroy(),this._vb.destroy()},D$V.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new D$V},D$V.const_stride=16,D$V._POOL=[],D$j(D$V,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),D$V}(),D$vs=function(D$s){function D$r(){D$r.__super.call(this),this.lock=!0}return D$A(D$r,"laya.webgl.shader.BaseShader",D$o),D$r.activeShader=null,D$r.bindShader=null,D$r}(),D$Ss=function(D$r){function D$h(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===D$e&&(D$e=6408),void 0===D$U&&(D$U=5121),void 0===D$m&&(D$m=34041),void 0===D$k&&(D$k=!1),void 0===D$j&&(D$j=!1),void 0===D$T&&(D$T=-1),void 0===D$Y&&(D$Y=-1),this._type=1,this._w=D$s,this._h=D$r,this._surfaceFormat=D$e,this._surfaceType=D$U,this._depthStencilFormat=D$m,D$V.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=D$k,this._repeat=D$j,this._minFifter=D$T,this._magFifter=D$Y,this._createWebGLRenderTarget(),this.bitmap.lock=!0,D$h.__super.call(this,this.bitmap,D$E.INV_UV)}D$A(D$h,"laya.webgl.resource.RenderTarget2D",D$r);var D$s=D$h.prototype;return D$X.imps(D$s,{"laya.resource.IDispose":!0}),D$s.getType=function(){return this._type},D$s.getTexture=function(){return this},D$s.size=function(D$s,D$r){this._w==D$s&&this._h==D$r||(this._w=D$s,this._h=D$r,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},D$s.release=function(){this.destroy()},D$s.recycle=function(){D$h.POOL.push(this)},D$s.start=function(){var D$s=D$Is.mainContext;return this._preRenderTarget=D$bs.curRenderTarget,D$bs.curRenderTarget=this,D$s.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(D$s.viewport(0,0,this._w,this._h),this._svWidth=D$bs.width,this._svHeight=D$bs.height,D$bs.width=this._w,D$bs.height=this._h,D$vs.activeShader=null),this},D$s.clear=function(D$s,D$r,D$e,D$U){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=1);var D$m=D$Is.mainContext;D$m.clearColor(D$s,D$r,D$e,D$U);var D$k=16384;switch(this._depthStencilFormat){case 33189:D$k|=256;break;case 36168:D$k|=1024;break;case 34041:D$k|=256,D$k|=1024}D$m.clear(D$k)},D$s.end=function(){var D$s=D$Is.mainContext;D$s.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,D$bs.curRenderTarget=this._preRenderTarget,1==this._type?(D$s.viewport(0,0,this._svWidth,this._svHeight),D$bs.width=this._svWidth,D$bs.height=this._svHeight,D$vs.activeShader=null):D$s.viewport(0,0,D$X.stage.width,D$X.stage.height)},D$s.getData=function(D$s,D$r,D$e,D$U){var D$m=D$Is.mainContext;if(D$m.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===D$m.checkFramebufferStatus(36160)))return D$m.bindFramebuffer(36160,null),null;var D$k=new Uint8Array(this._w*this._h*4);return D$m.readPixels(D$s,D$r,D$e,D$U,this._surfaceFormat,this._surfaceType,D$k),D$m.bindFramebuffer(36160,null),D$k},D$s.destroy=function(D$s){void 0===D$s&&(D$s=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,D$r.prototype.destroy.call(this))},D$s.dispose=function(){},D$s._createWebGLRenderTarget=function(){this.bitmap=new D$ds(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(D$s){this.event("recovered")})},D$U(0,D$s,"surfaceFormat",function(){return this._surfaceFormat}),D$U(0,D$s,"magFifter",function(){return this._magFifter}),D$U(0,D$s,"surfaceType",function(){return this._surfaceType}),D$U(0,D$s,"mipMap",function(){return this._mipMap}),D$U(0,D$s,"depthStencilFormat",function(){return this._depthStencilFormat}),D$U(0,D$s,"minFifter",function(){return this._minFifter}),D$U(0,D$s,"source",function(){return this._alreadyResolved?D$X.superGet(D$E,this,"source"):null}),D$h.create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){void 0===D$e&&(D$e=6408),void 0===D$U&&(D$U=5121),void 0===D$m&&(D$m=34041),void 0===D$k&&(D$k=!1),void 0===D$j&&(D$j=!1),void 0===D$T&&(D$T=-1),void 0===D$Y&&(D$Y=-1);var D$Z=D$h.POOL.pop();return D$Z||(D$Z=new D$h(D$s,D$r)),D$Z.bitmap&&D$Z._w==D$s&&D$Z._h==D$r&&D$Z._surfaceFormat==D$e&&D$Z._surfaceType==D$U&&D$Z._depthStencilFormat==D$m&&D$Z._mipMap==D$k&&D$Z._repeat==D$j&&D$Z._minFifter==D$T&&D$Z._magFifter==D$Y||(D$Z._w=D$s,D$Z._h=D$r,D$Z._surfaceFormat=D$e,D$Z._surfaceType=D$U,D$Z._depthStencilFormat=D$m,D$V.isConchWebGL&&34041===D$Z._depthStencilFormat&&(D$Z._depthStencilFormat=33189),D$Z._mipMap=D$k,D$Z._repeat=D$j,D$Z._minFifter=D$T,D$Z._magFifter=D$Y,D$Z.release(),D$Z._createWebGLRenderTarget()),D$Z},D$h.TYPE2D=1,D$h.TYPE3D=2,D$h.POOL=[],D$h}(D$E),D$zs=function(D$s){function D$r(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,D$r.__super.call(this),D$r._gl=D$Is.mainContext}D$A(D$r,"laya.webgl.utils.Buffer",D$o);var D$e=D$r.prototype;return D$e._bind=function(){this.activeResource(),D$r._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(D$r._bindVertexBuffer=this._glBuffer),D$r._gl.bindBuffer(this._bufferType,D$r._bindActive[this._bufferType]=this._glBuffer),D$vs.activeShader=null)},D$e.recreateResource=function(){this._glBuffer||(this._glBuffer=D$r._gl.createBuffer()),this.completeCreate()},D$e.disposeResource=function(){this._glBuffer&&(D$Is.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},D$U(0,D$e,"bufferUsage",function(){return this._bufferUsage}),D$r._gl=null,D$r._bindActive={},D$r._bindVertexBuffer=null,D$r._enableAtributes=[],D$r}(),D$Qs=function(D$s){function D$e(D$s){this.texcoord=null,this.offsetX=300,this.offsetY=0,D$e.__super.call(this,512,0);var D$r=8*D$$s.BYTES_PE;this.position=[2,5126,!1,D$r,0],this.texcoord=[2,5126,!1,D$r,2*D$$s.BYTES_PE],this.color=[4,5126,!1,D$r,4*D$$s.BYTES_PE]}return D$A(D$e,"laya.webgl.shader.d2.skinAnishader.SkinSV",D$ns),D$e}(),D$Cs=function(D$s){function D$r(D$s){D$r.__super.call(this,2,0),this.color=[]}return D$A(D$r,"laya.webgl.shader.d2.value.Color2dSV",D$ns),D$r.prototype.setValue=function(D$s){D$s.fillStyle&&(this.color=D$s.fillStyle._color._color),D$s.strokeStyle&&(this.color=D$s.strokeStyle._color._color)},D$r}(),D$Rs=function(D$s){function D$r(D$s){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=D$ns._TEXCOORD,D$r.__super.call(this,256,0)}D$A(D$r,"laya.webgl.shader.d2.value.FillTextureSV",D$ns);var D$e=D$r.prototype;return D$e.setValue=function(D$s){this.ALPHA=D$s.ALPHA,D$s.filters&&this.setFilters(D$s.filters)},D$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},D$r}(),D$as=function(D$s){function D$r(D$s){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=D$ns._TEXCOORD,void 0===D$s&&(D$s=0),D$r.__super.call(this,1,D$s)}D$A(D$r,"laya.webgl.shader.d2.value.TextureSV",D$ns);var D$e=D$r.prototype;return D$e.setValue=function(D$s){this.ALPHA=D$s.ALPHA,D$s.filters&&this.setFilters(D$s.filters)},D$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},D$r}(),D$ps=function(D$s){function D$r(D$s){this.a_color=null,this.u_pos=[0,0],D$r.__super.call(this,4,0),this.position=[2,5126,!1,5*D$$s.BYTES_PE,0],this.a_color=[3,5126,!1,5*D$$s.BYTES_PE,2*D$$s.BYTES_PE]}return D$A(D$r,"laya.webgl.shader.d2.value.PrimitiveSV",D$ns),D$r}(),D$Ns=function(D$s){function D$r(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,D$r.__super.call(this)}D$A(D$r,"laya.webgl.atlas.AtlasWebGLCanvas",D$s);var D$e=D$r.prototype;return D$e.recreateResource=function(){var D$s=D$Is.mainContext,D$r=this._source=D$s.createTexture(),D$e=D$ws.curBindTexTarget,D$U=D$ws.curBindTexValue;D$ws.bindTexture(D$s,3553,D$r),D$s.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),D$s.texParameteri(3553,10241,9729),D$s.texParameteri(3553,10240,9729),D$s.texParameteri(3553,10242,33071),D$s.texParameteri(3553,10243,33071),D$e&&D$U&&D$ws.bindTexture(D$s,D$e,D$U),this.memorySize=this._w*this._h*4,this.completeCreate()},D$e.disposeResource=function(){this._source&&(D$Is.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},D$e.texSubImage2D=function(D$s,D$r,D$e){if(D$V.isFlash){this._flashCacheImage||(this._flashCacheImage=D$$.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var D$U=D$e.bitmapdata;this._flashCacheImage._image.copyPixels(D$U,0,0,D$U.width,D$U.height,D$s,D$r),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var D$m=D$Is.mainContext,D$k=D$ws.curBindTexTarget,D$j=D$ws.curBindTexValue;D$ws.bindTexture(D$m,3553,this._source),D$m.pixelStorei(37441,!0),0<=D$s-1&&D$m.texSubImage2D(3553,0,D$s-1,D$r,6408,5121,D$e),D$s+1<=this._w&&D$m.texSubImage2D(3553,0,D$s+1,D$r,6408,5121,D$e),0<=D$r-1&&D$m.texSubImage2D(3553,0,D$s,D$r-1,6408,5121,D$e),D$r+1<=this._h&&D$m.texSubImage2D(3553,0,D$s,D$r+1,6408,5121,D$e),D$m.texSubImage2D(3553,0,D$s,D$r,6408,5121,D$e),D$m.pixelStorei(37441,!1),D$k&&D$j&&D$ws.bindTexture(D$m,D$k,D$j)}},D$e.texSubImage2DPixel=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$Is.mainContext,D$j=D$ws.curBindTexTarget,D$T=D$ws.curBindTexValue;D$ws.bindTexture(D$k,3553,this._source);var D$Y=new Uint8Array(D$m.data);D$k.pixelStorei(37441,!0),D$k.texSubImage2D(3553,0,D$s,D$r,D$e,D$U,6408,5121,D$Y),D$k.pixelStorei(37441,!1),D$j&&D$T&&D$ws.bindTexture(D$k,D$j,D$T)},D$U(0,D$e,"width",D$s.prototype._$get_width,function(D$s){this._w=D$s}),D$U(0,D$e,"height",D$s.prototype._$get_height,function(D$s){this._h=D$s}),D$r}(D$e),D$qs=function(D$s){function D$m(){this.flipY=!0,this.alwaysChange=!1,D$m.__super.call(this)}D$A(D$m,"laya.webgl.resource.WebGLCanvas",D$e);var D$r=D$m.prototype;return D$r.getCanvas=function(){return this._canvas},D$r.clear=function(){this._ctx&&this._ctx.clear()},D$r.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},D$r._setContext=function(D$s){this._ctx=D$s},D$r.getContext=function(D$s,D$r){return this._ctx?this._ctx:this._ctx=D$m._createContext(this)},D$r.size=function(D$s,D$r){this._w==D$s&&this._h==D$r||(this._w=D$s,this._h=D$r,this._ctx&&this._ctx.size(D$s,D$r),this._canvas&&(this._canvas.height=D$r,this._canvas.width=D$s))},D$r.activeResource=function(D$s){void 0===D$s&&(D$s=!1),this._source||this.recreateResource()},D$r.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},D$r.disposeResource=function(){this._source&&!this.iscpuSource&&(D$Is.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},D$r.createWebGlTexture=function(){var D$s=D$Is.mainContext;this._canvas;var D$r=this._source=D$s.createTexture();this.iscpuSource=!1;var D$e=D$ws.curBindTexTarget,D$U=D$ws.curBindTexValue;D$ws.bindTexture(D$s,3553,D$r),D$s.pixelStorei(37440,this.flipY?1:0),D$m.premulAlpha&&D$s.pixelStorei(37441,!0),D$s.texImage2D(3553,0,6408,6408,5121,this._imgData),D$m.premulAlpha&&D$s.pixelStorei(37441,!1),D$s.texParameteri(3553,10240,9729),D$s.texParameteri(3553,10241,9729),D$s.texParameteri(3553,10242,33071),D$s.texParameteri(3553,10243,33071),D$s.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,D$e&&D$U&&D$ws.bindTexture(D$s,D$e,D$U)},D$r.reloadCanvasData=function(){var D$s=D$Is.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var D$r=D$ws.curBindTexTarget,D$e=D$ws.curBindTexValue;D$ws.bindTexture(D$s,3553,this._source),D$m.premulAlpha&&D$s.pixelStorei(37441,!0),D$s.texImage2D(3553,0,6408,6408,5121,this._imgData),D$m.premulAlpha&&D$s.pixelStorei(37441,!1),D$s.pixelStorei(37440,0),D$r&&D$e&&D$ws.bindTexture(D$s,D$r,D$e)},D$r.texSubImage2D=function(D$s,D$r,D$e){var D$U=D$Is.mainContext,D$m=D$ws.curBindTexTarget,D$k=D$ws.curBindTexValue;D$ws.bindTexture(D$U,3553,this._source),D$U.pixelStorei(37441,!0),D$U.texSubImage2D(3553,0,D$r,D$e,6408,5121,D$s._source),D$U.pixelStorei(37441,!1),D$m&&D$k&&D$ws.bindTexture(D$U,D$m,D$k)},D$r.toBase64=function(D$s,D$r,D$e){var D$U=null;this._canvas&&(D$U=this._canvas.toDataURL(D$s,D$r)),D$e.call(this,D$U)},D$U(0,D$r,"context",function(){return this._ctx}),D$U(0,D$r,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),D$U(0,D$r,"asBitmap",null,function(D$s){this._ctx&&(this._ctx.asBitmap=D$s)}),D$m._createContext=null,D$m.premulAlpha=!1,D$m}(),D$Gs=function(D$s){function D$k(D$s,D$r){this.CborderSize=12,D$k.__super.call(this),this.char=D$s,this.isSpace=" "===D$s,this.xs=D$r.scaleX,this.ys=D$r.scaleY,this.font=D$r.font.toString(),this.fontSize=D$r.font.size,this.fillColor=D$r.fillColor,this.borderColor=D$r.borderColor,this.lineWidth=D$r.lineWidth,this.underLine=D$r.underLine;var D$e,D$U=D$V.isConchApp;D$U?((D$e=ConchTextCanvas)._source=ConchTextCanvas,D$e._source.canvas=ConchTextCanvas):D$e=D$x.canvas.source,this.canvas=D$e,this._enableMerageInAtlas=!0,this._ctx=D$U?D$e:this.canvas.getContext("2d",void 0);var D$m=D$v.measureText(this.char,this.font);this.cw=D$m.width*this.xs,this.ch=(D$m.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new D$E(this)}D$A(D$k,"laya.webgl.resource.WebGLCharImage",D$e);var D$r=D$k.prototype;return D$X.imps(D$r,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),D$r.active=function(){this.texture.active()},D$r.recreateResource=function(){var D$s=D$V.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),D$s){var D$r=this.fontSize;1==this.xs&&1==this.ys||(D$r=parseInt(D$r*(this.xs>this.ys?this.xs:this.ys)+""));var D$e="normal 100 "+this.font;D$e=D$e.replace(D$k._fontSizeReg,D$r),this.borderColor&&(D$e+=" 1 "+this.borderColor),this._ctx.font=D$e,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,D$c.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var D$U=this._ctx.measureText(this.char);D$U||(D$U={width:16});var D$m=D$U.width+1;this._ctx.lineTo(D$m,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},D$r.onresize=function(D$s,D$r){this._w=D$s,this._h=D$r,this._allowMerageInAtlas=!0},D$r.clearAtlasSource=function(){},D$U(0,D$r,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),D$U(0,D$r,"atlasSource",function(){return this.canvas}),D$U(0,D$r,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(D$s){this._enableMerageInAtlas=D$s}),D$k.createOneChar=function(D$s,D$r){return new D$k(D$s,D$r)},D$k._fontSizeReg=new RegExp("\\d+(?=px)","g"),D$k}(),D$ds=function(D$s){function D$Z(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){void 0===D$e&&(D$e=6408),void 0===D$U&&(D$U=5121),void 0===D$m&&(D$m=34041),void 0===D$k&&(D$k=!1),void 0===D$j&&(D$j=!1),void 0===D$T&&(D$T=-1),void 0===D$Y&&(D$Y=1),D$Z.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=D$s,this._h=D$r,this._surfaceFormat=D$e,this._surfaceType=D$U,this._depthStencilFormat=D$m,this._mipMap=D$k,this._repeat=D$j,this._minFifter=D$T,this._magFifter=D$Y}D$A(D$Z,"laya.webgl.resource.WebGLRenderTarget",D$e);var D$r=D$Z.prototype;return D$r.recreateResource=function(){var D$s=D$Is.mainContext;this._frameBuffer||(this._frameBuffer=D$s.createFramebuffer()),this._source||(this._source=D$s.createTexture());var D$r=D$ws.curBindTexTarget,D$e=D$ws.curBindTexValue;D$ws.bindTexture(D$s,3553,this._source),D$s.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var D$U=this._minFifter,D$m=this._magFifter,D$k=this._repeat?10497:33071,D$j=D$h.isPOT(this._w,this._h);if(D$j?(this._mipMap?-1!==D$U||(D$U=9987):-1!==D$U||(D$U=9729),-1!==D$m||(D$m=9729),D$s.texParameteri(3553,10241,D$U),D$s.texParameteri(3553,10240,D$m),D$s.texParameteri(3553,10242,D$k),D$s.texParameteri(3553,10243,D$k),this._mipMap&&D$s.generateMipmap(3553)):(-1!==D$U||(D$U=9729),-1!==D$m||(D$m=9729),D$s.texParameteri(3553,10241,D$U),D$s.texParameteri(3553,10240,D$m),D$s.texParameteri(3553,10242,33071),D$s.texParameteri(3553,10243,33071)),D$s.bindFramebuffer(36160,this._frameBuffer),D$s.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=D$s.createRenderbuffer()),D$s.bindRenderbuffer(36161,this._depthStencilBuffer),D$s.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:D$s.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:D$s.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:D$s.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}D$s.bindFramebuffer(36160,null),D$r&&D$e&&D$ws.bindTexture(D$s,D$r,D$e),D$s.bindRenderbuffer(36161,null),D$j&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},D$r.disposeResource=function(){this._frameBuffer&&(D$Is.mainContext.deleteTexture(this._source),D$Is.mainContext.deleteFramebuffer(this._frameBuffer),D$Is.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},D$U(0,D$r,"depthStencilBuffer",function(){return this._depthStencilBuffer}),D$U(0,D$r,"frameBuffer",function(){return this._frameBuffer}),D$Z}(),D$ts=function(D$s){function D$T(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this.offsetX=0,this.offsetY=0,D$T.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=D$k,this.canvas=D$s,this._ctx=D$s.getContext("2d",void 0),this._w=D$U,this._h=D$m,this.offsetX=D$r,this.offsetY=D$e,this.src=D$j,this._enableMerageInAtlas=!0,D$R.enabled&&this._w<D$R.atlasLimitWidth&&this._h<D$R.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}D$A(D$T,"laya.webgl.resource.WebGLSubImage",D$e);var D$r=D$T.prototype;return D$X.imps(D$r,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),D$r.size=function(D$s,D$r){this._w=D$s,this._h=D$r,this._ctx&&this._ctx.size(D$s,D$r),this.canvas&&(this.canvas.height=D$r,this.canvas.width=D$s)},D$r.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},D$r.createWebGlTexture=function(){var D$s=D$Is.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var D$r=this._source=D$s.createTexture(),D$e=D$ws.curBindTexTarget,D$U=D$ws.curBindTexValue;D$ws.bindTexture(D$s,3553,D$r),D$s.pixelStorei(37441,!0),D$s.texImage2D(3553,0,6408,6408,5121,this.canvas),D$s.pixelStorei(37441,!1);var D$m=this.minFifter,D$k=this.magFifter,D$j=this.repeat?10497:33071,D$T=D$h.isPOT(this.width,this.height);D$T?(this.mipmap?-1!==D$m||(D$m=9987):-1!==D$m||(D$m=9729),-1!==D$k||(D$k=9729),D$s.texParameteri(3553,10240,D$k),D$s.texParameteri(3553,10241,D$m),D$s.texParameteri(3553,10242,D$j),D$s.texParameteri(3553,10243,D$j),this.mipmap&&D$s.generateMipmap(3553)):(-1!==D$m||(D$m=9729),-1!==D$k||(D$k=9729),D$s.texParameteri(3553,10241,D$m),D$s.texParameteri(3553,10240,D$k),D$s.texParameteri(3553,10242,33071),D$s.texParameteri(3553,10243,33071)),D$e&&D$U&&D$ws.bindTexture(D$s,D$e,D$U),this.canvas=null,D$T&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},D$r.disposeResource=function(){D$R.enabled&&this._allowMerageInAtlas||!this._source||(D$Is.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},D$r.clearAtlasSource=function(){},D$U(0,D$r,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),D$U(0,D$r,"atlasSource",function(){return this.canvas}),D$U(0,D$r,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(D$s){this._allowMerageInAtlas=D$s}),D$T}(),D$Ws=function(D$s){function D$Z(D$s,D$r,D$e,D$U){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,D$Z.__super.call(this),!D$s||!D$r)throw"Shader Error";this._id=++D$Z._count,this._vs=D$s,this._ps=D$r,this._nameMap=D$U||{},null!=D$e&&(D$Z.sharders[D$e]=this)}D$A(D$Z,"laya.webgl.shader.Shader",D$vs);var D$r=D$Z.prototype;return D$r.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},D$r.disposeResource=function(){D$Is.mainContext.deleteShader(this._vshader),D$Is.mainContext.deleteShader(this._pshader),D$Is.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},D$r._compile=function(){if(!D$Is.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var D$s=[this._vs,this._ps],D$r=D$Is.mainContext;if(this._program=D$r.createProgram(),this._vshader=D$Z._createShader(D$r,D$s[0],35633),this._pshader=D$Z._createShader(D$r,D$s[1],35632),D$r.attachShader(this._program,this._vshader),D$r.attachShader(this._program,this._pshader),D$r.linkProgram(this._program),!D$V.isConchApp&&!D$r.getProgramParameter(this._program,35714))throw D$r.getProgramInfoLog(this._program);var D$e,D$U,D$m=0,D$k=0;for(D$k=D$V.isConchApp?D$r.getProgramParameterEx(this._vs,this._ps,"",35721):D$r.getProgramParameter(this._program,35721),D$m=0;D$m<D$k;D$m++){var D$j=null;D$e={vartype:"attribute",glfun:null,ivartype:0,attrib:D$j=D$V.isConchApp?D$r.getActiveAttribEx(this._vs,this._ps,"",D$m):D$r.getActiveAttrib(this._program,D$m),location:D$r.getAttribLocation(this._program,D$j.name),name:D$j.name,type:D$j.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(D$e)}var D$T=0;for(D$T=D$V.isConchApp?D$r.getProgramParameterEx(this._vs,this._ps,"",35718):D$r.getProgramParameter(this._program,35718),D$m=0;D$m<D$T;D$m++){var D$Y=null;D$Y=D$V.isConchApp?D$r.getActiveUniformEx(this._vs,this._ps,"",D$m):D$r.getActiveUniform(this._program,D$m),0<(D$e={vartype:"uniform",glfun:null,ivartype:1,attrib:D$j,location:D$r.getUniformLocation(this._program,D$Y.name),name:D$Y.name,type:D$Y.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(D$e.name=D$e.name.substr(0,D$e.name.length-3),D$e.isArray=!0,D$e.location=D$r.getUniformLocation(this._program,D$e.name)),this._params.push(D$e)}for(D$m=0,D$U=this._params.length;D$m<D$U;D$m++)if((D$e=this._params[D$m]).indexOfParams=D$m,D$e.index=1,D$e.value=[D$e.location,null],D$e.codename=D$e.name,D$e.name=this._nameMap[D$e.codename]?this._nameMap[D$e.codename]:D$e.codename,(this._paramsMap[D$e.name]=D$e)._this=this,D$e.uploadedValue=[],"attribute"!==D$e.vartype)switch(D$e.type){case 5124:D$e.fun=D$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:D$e.fun=D$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:D$e.fun=D$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:D$e.fun=D$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:D$e.fun=D$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:D$e.fun=this._uniform_sampler2D;break;case 35680:D$e.fun=this._uniform_samplerCube;break;case 35676:D$e.glfun=D$r.uniformMatrix4fv,D$e.fun=this._uniformMatrix4fv;break;case 35670:D$e.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else D$e.fun=this._attribute}},D$r.getUniform=function(D$s){return this._paramsMap[D$s]},D$r._attribute=function(D$s,D$r){var D$e=D$Is.mainContext,D$U=D$zs._enableAtributes,D$m=D$s.location;return D$U[D$m]||D$e.enableVertexAttribArray(D$m),D$e.vertexAttribPointer(D$m,D$r[0],D$r[1],D$r[2],D$r[3],D$r[4]+this._offset),D$U[D$m]=D$zs._bindVertexBuffer,1},D$r._uniform1f=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r?(D$Is.mainContext.uniform1f(D$s.location,D$e[0]=D$r),1):0},D$r._uniform1fv=function(D$s,D$r){if(D$r.length<4){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$Is.mainContext.uniform1fv(D$s.location,D$r),D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3],1):0}return D$Is.mainContext.uniform1fv(D$s.location,D$r),1},D$r._uniform_vec2=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]?(D$Is.mainContext.uniform2f(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1]),1):0},D$r._uniform_vec2v=function(D$s,D$r){if(D$r.length<2){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$Is.mainContext.uniform2fv(D$s.location,D$r),D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3],1):0}return D$Is.mainContext.uniform2fv(D$s.location,D$r),1},D$r._uniform_vec3=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]?(D$Is.mainContext.uniform3f(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2]),1):0},D$r._uniform_vec3v=function(D$s,D$r){return D$Is.mainContext.uniform3fv(D$s.location,D$r),1},D$r._uniform_vec4=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$Is.mainContext.uniform4f(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3]),1):0},D$r._uniform_vec4v=function(D$s,D$r){return D$Is.mainContext.uniform4fv(D$s.location,D$r),1},D$r._uniformMatrix2fv=function(D$s,D$r){return D$Is.mainContext.uniformMatrix2fv(D$s.location,!1,D$r),1},D$r._uniformMatrix3fv=function(D$s,D$r){return D$Is.mainContext.uniformMatrix3fv(D$s.location,!1,D$r),1},D$r._uniformMatrix4fv=function(D$s,D$r){return D$Is.mainContext.uniformMatrix4fv(D$s.location,!1,D$r),1},D$r._uniform1i=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r?(D$Is.mainContext.uniform1i(D$s.location,D$e[0]=D$r),1):0},D$r._uniform1iv=function(D$s,D$r){return D$Is.mainContext.uniform1iv(D$s.location,D$r),1},D$r._uniform_ivec2=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]?(D$Is.mainContext.uniform2i(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1]),1):0},D$r._uniform_ivec2v=function(D$s,D$r){return D$Is.mainContext.uniform2iv(D$s.location,D$r),1},D$r._uniform_vec3i=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]?(D$Is.mainContext.uniform3i(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2]),1):0},D$r._uniform_vec3vi=function(D$s,D$r){return D$Is.mainContext.uniform3iv(D$s.location,D$r),1},D$r._uniform_vec4i=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$Is.mainContext.uniform4i(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3]),1):0},D$r._uniform_vec4vi=function(D$s,D$r){return D$Is.mainContext.uniform4iv(D$s.location,D$r),1},D$r._uniform_sampler2D=function(D$s,D$r){var D$e=D$Is.mainContext,D$U=D$s.uploadedValue;return null==D$U[0]?(D$U[0]=this._curActTexIndex,D$e.uniform1i(D$s.location,this._curActTexIndex),D$e.activeTexture(D$Z._TEXTURES[this._curActTexIndex]),D$ws.bindTexture(D$e,3553,D$r),this._curActTexIndex++,1):(D$e.activeTexture(D$Z._TEXTURES[D$U[0]]),D$ws.bindTexture(D$e,3553,D$r),0)},D$r._uniform_samplerCube=function(D$s,D$r){var D$e=D$Is.mainContext,D$U=D$s.uploadedValue;return null==D$U[0]?(D$U[0]=this._curActTexIndex,D$e.uniform1i(D$s.location,this._curActTexIndex),D$e.activeTexture(D$Z._TEXTURES[this._curActTexIndex]),D$ws.bindTexture(D$e,34067,D$r),this._curActTexIndex++,1):(D$e.activeTexture(D$Z._TEXTURES[D$U[0]]),D$ws.bindTexture(D$e,34067,D$r),0)},D$r._noSetValue=function(D$s){console.log("no....:"+D$s.name)},D$r.uploadOne=function(D$s,D$r){this.activeResource(),D$ws.UseProgram(this._program);var D$e=this._paramsMap[D$s];D$e.fun.call(this,D$e,D$r)},D$r.uploadTexture2D=function(D$s){D$O.shaderCall++;var D$r=D$Is.mainContext;D$r.activeTexture(33984),D$ws.bindTexture(D$r,3553,D$s)},D$r.uploadTexture2D1=function(D$s){D$O.shaderCall++;var D$r=D$Is.mainContext;D$r.activeTexture(33985),D$ws.bindTexture(D$r,3553,D$s)},D$r.upload=function(D$s,D$r){D$vs.activeShader=D$vs.bindShader=this,this._lastUseFrameCount===D$O.loopCount||this.activeResource(),D$ws.UseProgram(this._program),this._reCompile?(D$r=this._params,this._reCompile=!1):D$r=D$r||this._params;D$Is.mainContext;for(var D$e,D$U,D$m=D$r.length,D$k=0,D$j=0;D$j<D$m;D$j++)null!==(D$U=D$s[(D$e=D$r[D$j]).name])&&(D$k+=D$e.fun.call(this,D$e,D$U));D$O.shaderCall+=D$k},D$r.uploadArray=function(D$s,D$r,D$e){D$vs.activeShader=this,(D$vs.bindShader=this).activeResource(),D$ws.UseProgram(this._program);this._params;for(var D$U,D$m,D$k=0,D$j=D$r-2;0<=D$j;D$j-=2)(D$m=this._paramsMap[D$s[D$j]])&&null!=(D$U=D$s[D$j+1])&&(D$e&&D$e[D$m.name]&&D$e[D$m.name].bind(),D$k+=D$m.fun.call(this,D$m,D$U));D$O.shaderCall+=D$k},D$r.getParams=function(){return this._params},D$Z.getShader=function(D$s){return D$Z.sharders[D$s]},D$Z.create=function(D$s,D$r,D$e,D$U){return new D$Z(D$s,D$r,D$e,D$U)},D$Z.withCompile=function(D$s,D$r,D$e,D$U){if(D$e&&D$Z.sharders[D$e])return D$Z.sharders[D$e];var D$m=D$Z._preCompileShader[2e-4*D$s];if(!D$m)throw new Error("withCompile shader err!"+D$s);return D$m.createShader(D$r,D$e,D$U)},D$Z.withCompile2D=function(D$s,D$r,D$e,D$U,D$m){if(D$U&&D$Z.sharders[D$U])return D$Z.sharders[D$U];var D$k=D$Z._preCompileShader[2e-4*D$s+D$r];if(!D$k)throw new Error("withCompile shader err!"+D$s+" "+D$r);return D$k.createShader(D$e,D$U,D$m)},D$Z.addInclude=function(D$s,D$r){D$os.addInclude(D$s,D$r)},D$Z.preCompile=function(D$s,D$r,D$e,D$U){var D$m=2e-4*D$s;D$Z._preCompileShader[D$m]=new D$os(D$m,D$r,D$e,D$U)},D$Z.preCompile2D=function(D$s,D$r,D$e,D$U,D$m){var D$k=2e-4*D$s+D$r;D$Z._preCompileShader[D$k]=new D$os(D$k,D$e,D$U,D$m)},D$Z._createShader=function(D$s,D$r,D$e){var D$U=D$s.createShader(D$e);return D$s.shaderSource(D$U,D$r),D$s.compileShader(D$U),D$U},D$Z._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],D$Z._count=0,D$Z._preCompileShader={},D$Z.SHADERNAME2ID=2e-4,D$Z.sharders=((D$Z.sharders=[]).length=32,D$Z.sharders),D$j(D$Z,["nameKey",function(){return this.nameKey=new D$i}]),D$Z}(),D$Ls=function(D$s){function D$r(){this._maxsize=0,this._upload=!0,this._uploadSize=0,D$r.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}D$A(D$r,"laya.webgl.utils.Buffer2D",D$s);var D$e=D$r.prototype;return D$e.needSize=function(D$s){var D$r=this._byteLength;if(D$s){var D$e=this._byteLength+D$s;D$e<=this._buffer.byteLength||this._resizeBuffer(D$e<<1,!0),this._byteLength=D$e}return D$r},D$e._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),D$O.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,D$zs._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),D$zs._gl.bufferSubData(this._bufferType,0,this._buffer)},D$e._bufferSubData=function(D$s,D$r,D$e){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),this._maxsize=Math.max(this._maxsize,this._byteLength),D$O.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,D$zs._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),D$r||D$e){var D$U=this._buffer.slice(D$r,D$e);D$zs._gl.bufferSubData(this._bufferType,D$s,D$U)}else D$zs._gl.bufferSubData(this._bufferType,D$s,this._buffer)},D$e._checkArrayUse=function(){},D$e._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},D$e._bind_subUpload=function(D$s,D$r,D$e){return void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(D$s,D$r,D$e),!0)},D$e._resizeBuffer=function(D$s,D$r){if(D$s<this._buffer.byteLength)return this;if(this.memorySize=D$s,D$r&&this._buffer&&0<this._buffer.byteLength){var D$e=new ArrayBuffer(D$s);new Uint8Array(D$e).set(new Uint8Array(this._buffer),0),this._buffer=D$e}else this._buffer=new ArrayBuffer(D$s);return this._checkArrayUse(),this._upload=!0,this},D$e.append=function(D$s){this._upload=!0;var D$r,D$e;D$r=D$s.byteLength,D$s instanceof Uint8Array?(this._resizeBuffer(this._byteLength+D$r,!0),D$e=new Uint8Array(this._buffer,this._byteLength)):D$s instanceof Uint16Array?(this._resizeBuffer(this._byteLength+D$r,!0),D$e=new Uint16Array(this._buffer,this._byteLength)):D$s instanceof Float32Array&&(this._resizeBuffer(this._byteLength+D$r,!0),D$e=new Float32Array(this._buffer,this._byteLength)),D$e.set(D$s,0),this._byteLength+=D$r,this._checkArrayUse()},D$e.appendU16Array=function(D$s,D$r){this._resizeBuffer(this._byteLength+2*D$r,!0);for(var D$e=new Uint16Array(this._buffer,this._byteLength,D$r),D$U=0;D$U<D$r;D$U++)D$e[D$U]=D$s[D$U];this._byteLength+=2*D$r,this._checkArrayUse()},D$e.appendEx=function(D$s,D$r){this._upload=!0;var D$e;D$e=D$s.byteLength,this._resizeBuffer(this._byteLength+D$e,!0),new D$r(this._buffer,this._byteLength).set(D$s,0),this._byteLength+=D$e,this._checkArrayUse()},D$e.appendEx2=function(D$s,D$r,D$e,D$U){void 0===D$U&&(D$U=1),this._upload=!0;var D$m,D$k;D$m=D$e*D$U,this._resizeBuffer(this._byteLength+D$m,!0),D$k=new D$r(this._buffer,this._byteLength);var D$j=0;for(D$j=0;D$j<D$e;D$j++)D$k[D$j]=D$s[D$j];this._byteLength+=D$m,this._checkArrayUse()},D$e.getBuffer=function(){return this._buffer},D$e.setNeedUpload=function(){this._upload=!0},D$e.getNeedUpload=function(){return this._upload},D$e.upload=function(){var D$s=this._bind_upload();return D$zs._gl.bindBuffer(this._bufferType,null),D$zs._bindActive[this._bufferType]=null,D$vs.activeShader=null,D$s},D$e.subUpload=function(D$s,D$r,D$e){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0);var D$U=this._bind_subUpload();return D$zs._gl.bindBuffer(this._bufferType,null),D$zs._bindActive[this._bufferType]=null,D$vs.activeShader=null,D$U},D$e.disposeResource=function(){D$s.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},D$e.clear=function(){this._byteLength=0,this._upload=!0},D$U(0,D$e,"bufferLength",function(){return this._buffer.byteLength}),D$U(0,D$e,"byteLength",null,function(D$s){this._byteLength!==D$s&&(D$s<=this._buffer.byteLength||this._resizeBuffer(2*D$s+256,!0),this._byteLength=D$s)}),D$r.__int__=function(D$s){D$_s.QuadrangleIB=D$_s.create(35044),D$ls.fillIBQuadrangle(D$_s.QuadrangleIB,16)},D$r.FLOAT32=4,D$r.SHORT=2,D$r}(D$zs),D$us=(function(D$r){function D$e(D$s){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,D$e.__super.call(this,9)}D$A(D$e,"laya.webgl.shader.d2.value.GlowSV",D$r);var D$s=D$e.prototype;D$s.setValue=function(D$s){D$r.prototype.setValue.call(this,D$s)},D$s.clear=function(){D$r.prototype.clear.call(this)}}(D$as),function(D$s){function D$r(D$s){D$r.__super.call(this,64),this.defines.add(64)}D$A(D$r,"laya.webgl.shader.d2.value.TextSV",D$s);var D$e=D$r.prototype;return D$e.release=function(){(D$r.pool[D$r._length++]=this).clear()},D$e.clear=function(){D$s.prototype.clear.call(this)},D$r.create=function(){return D$r._length?D$r.pool[--D$r._length]:new D$r(null)},D$r.pool=[],D$r._length=0,D$r}(D$as)),D$Ms=function(D$s){function D$m(D$s,D$r,D$e,D$U){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,D$m.__super.call(this,D$s,D$r,D$e,D$U)}D$A(D$m,"laya.webgl.shader.d2.Shader2X",D$s);var D$r=D$m.prototype;return D$r.upload2dQuick1=function(D$s){this.upload(D$s,this._params2dQuick1||this._make2dQuick1())},D$r._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var D$s,D$r=this._params,D$e=0,D$U=D$r.length;D$e<D$U;D$e++)D$s=D$r[D$e],(D$V.isFlash||"size"!==D$s.name&&"position"!==D$s.name&&"texcoord"!==D$s.name)&&this._params2dQuick1.push(D$s)}return this._params2dQuick1},D$r.disposeResource=function(){D$s.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},D$r.upload2dQuick2=function(D$s){this.upload(D$s,this._params2dQuick2||this._make2dQuick2())},D$r._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var D$s,D$r=this._params,D$e=0,D$U=D$r.length;D$e<D$U;D$e++)D$s=D$r[D$e],(D$V.isFlash||"size"!==D$s.name)&&this._params2dQuick2.push(D$s)}return this._params2dQuick2},D$m.create=function(D$s,D$r,D$e,D$U){return new D$m(D$s,D$r,D$e,D$U)},D$m}(D$Ws),D$_s=function(D$s){function D$r(D$s){this._uint8Array=null,this._uint16Array=null,void 0===D$s&&(D$s=35044),D$r.__super.call(this),this._bufferUsage=D$s,this._bufferType=34963,D$V.isFlash||(this._buffer=new ArrayBuffer(8))}D$A(D$r,"laya.webgl.utils.IndexBuffer2D",D$Ls);var D$e=D$r.prototype;return D$e._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},D$e.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},D$e.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},D$e.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},D$r.QuadrangleIB=null,D$r.create=function(D$s){return void 0===D$s&&(D$s=35044),new D$r(D$s)},D$r}(),D$Fs=function(D$s){function D$e(D$s,D$r){this._floatArray32=null,this._vertexStride=0,D$e.__super.call(this),this._vertexStride=D$s,this._bufferUsage=D$r,this._bufferType=34962,D$V.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}D$A(D$e,"laya.webgl.utils.VertexBuffer2D",D$s);var D$r=D$e.prototype;return D$r.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},D$r.bind=function(D$s){D$s&&D$s._bind(),this._bind()},D$r.insertData=function(D$s,D$r){this.getFloat32Array().set(D$s,D$r),this._upload=!0},D$r.bind_upload=function(D$s){D$s._bind_upload()||D$s._bind(),this._bind_upload()||this._bind()},D$r._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},D$r.disposeResource=function(){D$s.prototype.disposeResource.call(this)},D$r.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},D$U(0,D$r,"vertexStride",function(){return this._vertexStride}),D$e.create=function(D$s,D$r){return void 0===D$r&&(D$r=35048),new D$e(D$s,D$r)},D$e}(D$Ls),D$sr=function(D$s){function D$T(D$s,D$r,D$e,D$U,D$m,D$k){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===D$e&&(D$e=6408),void 0===D$U&&(D$U=!0),D$T.__super.call(this,D$s,D$r),D$s){if(this._format=D$e,this._mipmap=D$U,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof D$s)this._url=D$s,this._src=D$s,this._image=new D$x.window.Image,D$r&&(D$r.onload&&(this.onload=D$r.onload),D$r.onerror&&(this.onerror=D$r.onerror),D$r.onCreate&&D$r.onCreate(this)),this._image.crossOrigin=D$s&&0==D$s.indexOf("data:")?null:"",D$s&&(this._image.src=D$s);else if(D$s instanceof ArrayBuffer){this._src=D$r,this._url=this._src;var D$j=new D$Y(D$s);D$j.readUTFBytes(4),D$j.readUTFBytes(2),D$j.getInt16();D$j.endian="bigEndian",this._w=D$j.getInt16(),this._h=D$j.getInt16();D$j.getInt16(),D$j.getInt16();this._image=new Uint8Array(D$s,D$j.pos),this._format=D$Is.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,D$R.enabled&&this._w<D$R.atlasLimitWidth&&this._h<D$R.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(D$s instanceof Uint8Array))return this._src=D$r,this._url=this._src,this._image=D$s.source||D$s,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=D$r,this._url=this._src,this._w=D$m,this._h=D$k,this._image=D$s,this._format=0===D$e?D$s.byteLength/(D$m*D$k)==4?6408:6407:D$e}this._$5__enableMerageInAtlas=!0}}D$A(D$T,"laya.webgl.resource.WebGLImage",D$$);var D$r=D$T.prototype;return D$X.imps(D$r,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),D$r._init_=function(D$s,D$r){},D$r._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var D$s=D$Is.mainContext,D$r=this._source=D$s.createTexture(),D$e=D$ws.curBindTexTarget,D$U=D$ws.curBindTexValue;D$ws.bindTexture(D$s,3553,D$r);var D$m=this.minFifter,D$k=this.magFifter,D$j=this.repeat?10497:33071,D$T=D$h.isPOT(this._w,this._h),D$Y=!1;switch(D$T?(this.mipmap?-1!==D$m||(D$m=9987):-1!==D$m||(D$m=9729),-1!==D$k||(D$k=9729),D$s.texParameteri(3553,10241,D$m),D$s.texParameteri(3553,10240,D$k),D$s.texParameteri(3553,10242,D$j),D$s.texParameteri(3553,10243,D$j),this.mipmap&&D$s.generateMipmap(3553)):(-1!==D$m||(D$m=9729),-1!==D$k||(D$k=9729),D$s.texParameteri(3553,10241,D$m),D$s.texParameteri(3553,10240,D$k),D$s.texParameteri(3553,10242,33071),D$s.texParameteri(3553,10243,33071)),D$s.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&D$s.pixelStorei(D$s.UNPACK_ALIGNMENT,1),D$s.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&D$s.pixelStorei(D$s.UNPACK_ALIGNMENT,1),D$s.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:D$Y=!0,D$s.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case D$Is.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:D$Y=!0,D$s.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}D$s.pixelStorei(37441,!1),D$e&&D$U&&D$ws.bindTexture(D$s,D$e,D$U),this.uri||(this.uri=this._url),D$Y?this.memorySize=this._image.length:D$T&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},D$r.recreateResource=function(){var D$s=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var D$r=this;this._image=new D$x.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(D$r._needReleaseAgain)return D$r._needReleaseAgain=!1,D$r._image.onload=null,void(D$r._image=null);D$r._allowMerageInAtlas&&D$r._enableMerageInAtlas?(D$s.memorySize=0,D$s._recreateLock=!1):D$r._createWebGlTexture(),D$r.completeCreate()},this._image.src=this._src}},D$r.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&D$Is.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},D$r.onresize=function(){this._w=this._image.width,this._h=this._image.height,D$R.enabled&&this._w<D$R.atlasLimitWidth&&this._h<D$R.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},D$r.clearAtlasSource=function(){this._image=null},D$U(0,D$r,"format",function(){return this._format}),D$U(0,D$r,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(D$s){this._$5__enableMerageInAtlas=D$s}),D$U(0,D$r,"mipmap",function(){return this._mipmap}),D$U(0,D$r,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),D$U(0,D$r,"atlasSource",function(){return this._image}),D$U(0,D$r,"onload",null,function(D$s){var D$r=this;this._onload=D$s,this._image&&(this._image.onload=null!=this._onload?function(){D$r.onresize(),D$r._onload()}:null)}),D$U(0,D$r,"onerror",null,function(D$s){var D$r=this;this._onerror=D$s,this._image&&(this._image.onerror=null!=this._onerror?function(){D$r._onerror()}:null)}),D$T}();D$X.__init([D$xs,D$C,D$Ds,D$os])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(D$s,D$r){"use strict";for(var D$e in Object.defineProperty(D$r,"__esModule",{value:!0}),Laya){var D$U=Laya[D$e];D$U&&D$U.__isclass&&(D$r[D$e]=D$U)}}),function(D$k,D$s,D$U){D$U.un,D$U.uns;var D$m=D$U.static,D$j=D$U.class,D$T=D$U.getset,D$Y=(D$U.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),D$B=laya.utils.ClassUtils,D$H=(laya.events.Event,laya.utils.HTMLChar),D$Z=laya.net.Loader,D$h=(laya.display.Node,laya.maths.Rectangle),D$A=laya.renders.Render,D$x=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),D$$=laya.utils.Stat,D$v=laya.display.Text,D$l=laya.resource.Texture,D$V=laya.net.URL,D$b=laya.utils.Utils,D$o=function(){function D$x(){}return D$j(D$x,"laya.html.utils.HTMLParse"),D$x.parse=function(D$s,D$r,D$e){D$r=(D$r="<root>"+(D$r=D$r.replace(/<br>/g,"<br/>"))+"</root>").replace(D$x.spacePattern,D$x.char255);var D$U=D$b.parseXMLFromString(D$r);D$x._parseXML(D$s,D$U.childNodes[0].childNodes,D$e)},D$x._parseXML=function(D$s,D$r,D$e,D$U){var D$m=0,D$k=0;if(D$r.join||D$r.item)for(D$m=0,D$k=D$r.length;D$m<D$k;++D$m)D$x._parseXML(D$s,D$r[D$m],D$e,D$U);else{var D$j,D$T,D$Y;if(3==D$r.nodeType)return void(D$s instanceof laya.html.dom.HTMLDivElement?(null==D$r.nodeName&&(D$r.nodeName="#text"),D$T=D$r.nodeName.toLowerCase(),0<(D$Y=D$r.textContent.replace(/^\s+|\s+$/g,"")).length&&(D$j=D$B.getInstance(D$T))&&(D$s.addChild(D$j),D$j.innerTEXT=D$Y.replace(D$x.char255AndOneSpacePattern," "))):0<(D$Y=D$r.textContent.replace(/^\s+|\s+$/g,"")).length&&(D$s.innerTEXT=D$Y.replace(D$x.char255AndOneSpacePattern," ")));if("#comment"==(D$T=D$r.nodeName.toLowerCase()))return;if(D$j=D$B.getInstance(D$T)){(D$j=D$s.addChild(D$j)).URI=D$e,D$j.href=D$U;var D$Z=D$r.attributes;if(D$Z&&0<D$Z.length)for(D$m=0,D$k=D$Z.length;D$m<D$k;++D$m){var D$h=D$Z[D$m],D$H=D$h.nodeName,D$A=D$h.value;D$j._setAttributes(D$H,D$A)}D$x._parseXML(D$j,D$r.childNodes,D$e,D$j.href)}else D$x._parseXML(D$s,D$r.childNodes,D$e,D$U)}},D$x.char255=String.fromCharCode(255),D$x.spacePattern=/&nbsp;|&#160;/g,D$x.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),D$x}(),D$I=function(){function D$E(){}return D$j(D$E,"laya.html.utils.Layout"),D$E.later=function(D$s){null==D$E._will&&(D$E._will=[],D$U.stage.frameLoop(1,null,function(){if(!(D$E._will.length<1)){for(var D$s=0;D$s<D$E._will.length;D$s++)laya.html.utils.Layout.layout(D$E._will[D$s]);D$E._will.length=0}})),D$E._will.push(D$s)},D$E.layout=function(D$s){if(!D$s||!D$s._style)return null;if(0==(512&D$s._style._type))return null;D$s.getStyle()._type&=-513;var D$r=D$E._multiLineLayout(D$s);return D$A.isConchApp&&D$s.layaoutCallNative&&D$s.layaoutCallNative(),D$r},D$E._multiLineLayout=function(D$s){if(D$v.RightToLeft)return D$E._multiLineLayout2(D$s);var D$r=new Array;D$s._addChildsToLayout(D$r);var D$e,D$U,D$m,D$k,D$j,D$T=0,D$Y=D$r.length,D$Z=D$s._getCSSStyle(),D$h=D$Z.letterSpacing,D$H=D$Z.leading,D$A=D$Z.lineHeight,D$x=D$Z._widthAuto()||!D$Z.wordWrap,D$B=D$x?999999:D$s.width,D$$=(D$s.height,0),D$l=D$Z.italic?D$Z.fontSize/3:0,D$V=D$Z._getAlign(),D$b=D$Z._getValign(),D$o=0!==D$b||0!==D$V||0!=D$A,D$I=0,D$w=0,D$X=0,D$D=0,D$n=new Array,D$y=D$n[0]=new D$S,D$g=!1,D$f=!1;D$y.h=0,D$Z.italic&&(D$B-=D$Z.fontSize/3);var D$J=0,D$P=!0;function D$O(){D$y.y=D$w,D$w+=D$y.h+D$H,0==D$y.h&&(D$w+=D$A),D$y.mWidth=D$J,D$J=0,D$y=new D$S,D$n.push(D$y),D$y.h=0,D$g=!(D$P=!(D$I=0))}for(D$T=0;D$T<D$Y;D$T++)if(null!=(D$e=D$r[D$T]))if(D$P=!1,D$e instanceof laya.html.dom.HTMLBrElement)D$O(),D$y.y=D$w;else{if(D$e._isChar()){if((D$k=D$e).isWord)D$g=D$f||"\n"===D$k.char,D$y.wordStartIndex=D$y.elements.length;else{if(D$X=D$k.width+D$k.style.letterSpacin,0<D$n.length&&D$B<D$I+D$X&&0<D$y.wordStartIndex){var D$i;D$i=D$y.elements.length-D$y.wordStartIndex+1,D$y.elements.length=D$y.wordStartIndex,D$T-=D$i,D$O();continue}D$g=!1,D$J+=D$k.width}D$X=D$k.width+D$h,D$D=D$k.height,D$f=!1,(D$g=D$g||D$B<D$I+D$X)&&D$O(),D$y.minTextHeight=Math.min(D$y.minTextHeight,D$e.height)}else D$U=D$e._getCSSStyle(),D$j=D$e,D$m=D$U.padding,0===D$U._getCssFloat()||(D$o=!0),D$g=D$f||D$U.lineElement,D$X=D$j.width*D$j._style._tf.scaleX+D$m[1]+D$m[3]+D$h,D$D=D$j.height*D$j._style._tf.scaleY+D$m[0]+D$m[2],D$f=D$U.lineElement,(D$g=D$g||D$B<D$I+D$X&&D$U.wordWrap)&&D$O();D$y.elements.push(D$e),D$y.h=Math.max(D$y.h,D$D),D$e.x=D$I,D$e.y=D$w,D$I+=D$X,D$y.w=D$I-D$h,D$y.y=D$w,D$$=Math.max(D$I+D$l,D$$)}else D$P||(D$I+=D$E.DIV_ELEMENT_PADDING),D$y.wordStartIndex=D$y.elements.length;if(D$w=D$y.y+D$y.h,D$o){var D$K=0,D$c=D$B;for(D$x&&0<D$s.width&&(D$c=D$s.width),D$T=0,D$Y=D$n.length;D$T<D$Y;D$T++)D$n[D$T].updatePos(0,D$c,D$T,D$K,D$V,D$b,D$A),D$K+=Math.max(D$A,D$n[D$T].h+D$H);D$w=D$K}return D$x&&(D$s.width=D$$),D$w>D$s.height&&(D$s.height=D$w),[D$$,D$w]},D$E._multiLineLayout2=function(D$s){var D$r=new Array;D$s._addChildsToLayout(D$r);var D$e,D$U,D$m,D$k,D$j,D$T=0,D$Y=D$r.length,D$Z=D$s._getCSSStyle(),D$h=D$Z.letterSpacing,D$H=D$Z.leading,D$A=D$Z.lineHeight,D$x=D$Z._widthAuto()||!D$Z.wordWrap,D$B=D$x?999999:D$s.width,D$$=(D$s.height,0),D$l=D$Z.italic?D$Z.fontSize/3:0,D$V=2-D$Z._getAlign(),D$b=D$Z._getValign(),D$o=0!==D$b||0!=D$V||0!=D$A,D$I=0,D$w=0,D$X=0,D$D=0,D$n=new Array,D$y=D$n[0]=new D$S,D$g=!1,D$f=!1;D$y.h=0,D$Z.italic&&(D$B-=D$Z.fontSize/3);var D$J=0,D$P=!0;function D$O(){D$y.y=D$w,D$w+=D$y.h+D$H,0==D$y.h&&(D$w+=D$A),D$y.mWidth=D$J,D$J=0,D$y=new D$S,D$n.push(D$y),D$y.h=0,D$g=!(D$P=!(D$I=0))}for(D$T=0;D$T<D$Y;D$T++)if(null!=(D$e=D$r[D$T]))if(D$P=!1,D$e instanceof laya.html.dom.HTMLBrElement)D$O(),D$y.y=D$w;else{if(D$e._isChar()){if((D$k=D$e).isWord)D$g=D$f||"\n"===D$k.char,D$y.wordStartIndex=D$y.elements.length;else{if(0<D$n.length&&D$B<D$I+D$X&&0<D$y.wordStartIndex){var D$i;D$i=D$y.elements.length-D$y.wordStartIndex+1,D$y.elements.length=D$y.wordStartIndex,D$T-=D$i,D$O();continue}D$g=!1,D$J+=D$k.width}D$X=D$k.width+D$h,D$D=D$k.height,D$f=!1,(D$g=D$g||D$B<D$I+D$X)&&D$O(),D$y.minTextHeight=Math.min(D$y.minTextHeight,D$e.height)}else D$U=D$e._getCSSStyle(),D$j=D$e,D$m=D$U.padding,0===D$U._getCssFloat()||(D$o=!0),D$g=D$f||D$U.lineElement,D$X=D$j.width*D$j._style._tf.scaleX+D$m[1]+D$m[3]+D$h,D$D=D$j.height*D$j._style._tf.scaleY+D$m[0]+D$m[2],D$f=D$U.lineElement,(D$g=D$g||D$B<D$I+D$X&&D$U.wordWrap)&&D$O();D$y.elements.push(D$e),D$y.h=Math.max(D$y.h,D$D),D$e.x=D$I,D$e.y=D$w,D$I+=D$X,D$y.w=D$I-D$h,D$y.y=D$w,D$$=Math.max(D$I+D$l,D$$)}else D$P||(D$I+=D$E.DIV_ELEMENT_PADDING),D$y.wordStartIndex=D$y.elements.length;if(D$w=D$y.y+D$y.h,D$o){var D$K=0,D$c=D$B;for(D$T=0,D$Y=D$n.length;D$T<D$Y;D$T++)D$n[D$T].updatePos(0,D$c,D$T,D$K,D$V,D$b,D$A),D$K+=Math.max(D$A,D$n[D$T].h+D$H);D$w=D$K}for(D$x&&(D$s.width=D$$),D$w>D$s.height&&(D$s.height=D$w),D$T=0,D$Y=D$n.length;D$T<D$Y;D$T++)D$n[D$T].revertOrder(D$B);return[D$$,D$w]},D$E._will=null,D$E.DIV_ELEMENT_PADDING=0,D$E}(),D$S=function(){function D$s(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}D$j(D$s,"laya.html.utils.LayoutLine");var D$r=D$s.prototype;return D$r.updatePos=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){var D$T,D$Y=0;0<this.elements.length&&(D$Y=(D$T=this.elements[this.elements.length-1]).x+D$T.width-this.elements[0].x);var D$Z=0,D$h=NaN;1===D$m&&(D$Z=(D$r-D$Y)/2),2===D$m&&(D$Z=D$r-D$Y),0===D$j||0!=D$k||(D$k=1);for(var D$H=0,D$A=this.elements.length;D$H<D$A;D$H++){var D$x=(D$T=this.elements[D$H])._getCSSStyle();switch(0!==D$Z&&(D$T.x+=D$Z),D$x._getValign()){case 0:D$T.y=D$U;break;case 1:var D$B=0;99999!=this.minTextHeight&&(D$B=this.minTextHeight);var D$$=(D$B+D$j)/2;D$$=Math.max(D$$,this.h),D$h=(laya.html.dom.HTMLImageElement,D$U+D$$-D$T.height),D$T.y=D$h;break;case 2:D$T.y=D$U+(D$j-D$T.height)}}},D$r.revertOrder=function(D$s){var D$r;if(0<this.elements.length){var D$e,D$U=0;for(D$e=this.elements.length,D$U=0;D$U<D$e;D$U++)(D$r=this.elements[D$U]).x=D$s-D$r.x-D$r.width}},D$s}(),D$w=function(D$e){function D$r(){this.URI=null,this._href=null,D$r.__super.call(this),this._text=D$r._EMPTYTEXT,this.setStyle(new D$Y(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}D$j(D$r,"laya.html.dom.HTMLElement",D$e);var D$s=D$r.prototype;return D$s.layaoutCallNative=function(){var D$s=0;if(this._childs&&0<(D$s=this._childs.length))for(var D$r=0;D$r<D$s;D$r++)this._childs[D$r].layaoutCallNative&&this._childs[D$r].layaoutCallNative();var D$e=this._getWords();D$e?laya.html.dom.HTMLElement.fillWords(this,D$e,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},D$s.appendChild=function(D$s){return this.addChild(D$s)},D$s._getWords2=function(){var D$s=this._text.text;if(!D$s||0===D$s.length)return null;var D$r,D$e,D$U=0,D$m=0;if(this._text.drawWords)D$e=this._text.drawWords;else{for(D$m=(D$r=D$s.split(" ")).length-1,D$e=[],D$U=0;D$U<D$m;D$U++)D$e.push(D$r[D$U]," ");0<=D$m&&D$e.push(D$r[D$m]),this._text.drawWords=D$e}var D$k,D$j=this._text.words;if(D$j&&D$j.length===D$e.length)return D$j;null===D$j&&(this._text.words=D$j=[]),D$j.length=D$e.length;var D$T=this.style,D$Y=D$T.font;for(D$U=0,D$m=D$e.length;D$U<D$m;D$U++){D$k=D$b.measureText(D$e[D$U],D$Y);var D$Z=D$j[D$U]=new D$H(D$e[D$U],D$k.width,D$k.height||D$T.fontSize,D$T);if(1<D$Z.char.length&&(D$Z.charNum=D$Z.char),this.href){var D$h=new D$x;this.addChild(D$h),D$Z.setSprite(D$h)}}return D$j},D$s._getWords=function(){if(!D$v.CharacterCache)return this._getWords2();var D$s=this._text.text;if(!D$s||0===D$s.length)return null;var D$r,D$e=this._text.words;if(D$e&&D$e.length===D$s.length)return D$e;null===D$e&&(this._text.words=D$e=[]),D$e.length=D$s.length;for(var D$U=this.style,D$m=D$U.font,D$k=0,D$j=D$s.length;D$k<D$j;D$k++)if(D$r=D$b.measureText(D$s.charAt(D$k),D$m)){var D$T=D$e[D$k]=new D$H(D$s.charAt(D$k),D$r.width,D$r.height||D$U.fontSize,D$U);if(this.href){var D$Y=new D$x;this.addChild(D$Y),D$T.setSprite(D$Y)}}else console.warn("_getWords size is null"+D$s.charAt(D$k),D$m);return D$e},D$s.showLinkSprite=function(){var D$s=this._text.words;if(D$s)for(var D$r,D$e,D$U=[],D$m=0;D$m<D$s.length;D$m++)D$e=D$s[D$m],(D$r=new D$x).graphics.drawRect(0,0,D$e.width,D$e.height,"#ff0000"),D$r.width=D$e.width,D$r.height=D$e.height,this.addChild(D$r),D$U.push(D$r)},D$s._layoutLater=function(){var D$s=this.style;512&D$s._type||(D$s.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&D$s.block?(D$I.later(this),D$s._type|=512):this.parent&&this.parent._layoutLater())},D$s._setAttributes=function(D$s,D$r){switch(D$s){case"style":return void this.style.cssText(D$r);case"class":return void(this.className=D$r)}D$e.prototype._setAttributes.call(this,D$s,D$r)},D$s.updateHref=function(){if(null!=this._href){var D$s=this._getWords();if(D$s)for(var D$r,D$e,D$U=0;D$U<D$s.length;D$U++)(D$e=(D$r=D$s[D$U]).getSprite())&&(D$e.size(D$r.width,D$r.height),D$e.on("click",this,this.onLinkHandler))}},D$s.onLinkHandler=function(D$s){switch(D$s.type){case"click":for(var D$r=this;D$r;)D$r.event("link",[this.href]),D$r=D$r.parent}},D$s.formatURL=function(D$s){return this.URI?D$V.formatURL(D$s,this.URI?this.URI.path:null):D$s},D$T(0,D$s,"href",function(){return this._href},function(D$s){null!=(this._href=D$s)&&(this._getCSSStyle().underLine=1,this.updateHref())}),D$T(0,D$s,"color",null,function(D$s){this.style.color=D$s}),D$T(0,D$s,"onClick",null,function(D$s){D$U._runScript("fn=function(event){"+D$s+";}"),this.on("click",this,void 0)}),D$T(0,D$s,"id",null,function(D$s){D$X.document.setElementById(D$s,this)}),D$T(0,D$s,"innerTEXT",function(){return this._text.text},function(D$s){this.text=D$s}),D$T(0,D$s,"style",function(){return this._style}),D$T(0,D$s,"text",function(){return this._text.text},function(D$s){this._text==D$r._EMPTYTEXT?this._text={text:D$s,words:null}:(this._text.text=D$s,this._text.words&&(this._text.words.length=0)),D$A.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),D$T(0,D$s,"parent",D$e.prototype._$get_parent,function(D$s){if(D$s instanceof laya.html.dom.HTMLElement){var D$r=D$s;this.URI||(this.URI=D$r.URI),this.style.inherit(D$r.style)}D$U.superSet(D$x,this,"parent",D$s)}),D$T(0,D$s,"className",null,function(D$s){this.style.attrs(D$X.document.styleSheets["."+D$s])}),D$r.fillWords=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$s.graphics.clear();for(var D$T=0,D$Y=D$r.length;D$T<D$Y;D$T++){var D$Z=D$r[D$T];D$s.graphics.fillText(D$Z.char,D$Z.x+D$e,D$Z.y+D$U,D$m,D$k,"left",D$j)}},D$r._EMPTYTEXT={text:null,words:null},D$r}(D$x),D$r=(function(D$s){function D$r(){D$r.__super.call(this),this.style.lineElement=!0,this.style.block=!0}D$j(D$r,"laya.html.dom.HTMLBrElement",D$w)}(),function(D$s){function D$r(){this.contextHeight=NaN,this.contextWidth=NaN,D$r.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}D$j(D$r,"laya.html.dom.HTMLDivElement",D$s);var D$e=D$r.prototype;return D$e.appendHTML=function(D$s){D$o.parse(this,D$s,this.URI),this.layout()},D$e._addChildsToLayout=function(D$r){var D$s=this._getWords();if(null==D$s&&0==this._childs.length)return!1;D$s&&D$s.forEach(function(D$s){D$r.push(D$s)});for(var D$e=!0,D$U=0,D$m=this._childs.length;D$U<D$m;D$U++){var D$k=this._childs[D$U];D$e?D$e=!1:D$r.push(null),D$k._addToLayout(D$r)}return!0},D$e._addToLayout=function(D$s){this.layout()},D$e.layout=function(){if(this.style){this.style._type|=512;var D$s=D$I.layout(this);if(D$s){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new D$h);var D$r=this._$P.mHtmlBounds;D$r.x=D$r.y=0,D$r.width=this.contextWidth=D$s[0],D$r.height=this.contextHeight=D$s[1],this.setBounds(D$r)}}},D$T(0,D$e,"height",function(){return this._height?this._height:this.contextHeight},D$s.prototype._$set_height),D$T(0,D$e,"innerHTML",null,function(D$s){this.destroyChildren(),this.appendHTML(D$s)}),D$T(0,D$e,"width",function(){return this._width?this._width:this.contextWidth},function(D$s){var D$r=!1;D$r=0===D$s?D$s!=this._width:D$s!=this.width,D$U.superSet(D$w,this,"width",D$s),D$r&&this.layout()}),D$r}(D$w)),D$X=function(D$s){function D$r(){this.all=new Array,this.styleSheets=D$Y.styleSheets,D$r.__super.call(this)}D$j(D$r,"laya.html.dom.HTMLDocument",D$w);var D$e=D$r.prototype;return D$e.getElementById=function(D$s){return this.all[D$s]},D$e.setElementById=function(D$s,D$r){this.all[D$s]=D$r},D$m(D$r,["document",function(){return this.document=new D$r}]),D$r}();(function(D$s){function D$r(){this._tex=null,this._url=null,this._renderArgs=[],D$r.__super.call(this),this.style.block=!0}D$j(D$r,"laya.html.dom.HTMLImageElement",D$w);var D$e=D$r.prototype;D$e._addToLayout=function(D$s){!this._style.absolute&&D$s.push(this)},D$e.render=function(D$s,D$r,D$e){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(D$$.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,D$s.ctx.drawTexture2(D$r,D$e,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},D$e.layaoutCallNative=function(){var D$s=0;if(this._childs&&0<(D$s=this._childs.length))for(var D$r=0;D$r<D$s;D$r++)this._childs[D$r].layaoutCallNative&&this._childs[D$r].layaoutCallNative()},D$T(0,D$e,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(D$s){this._width!==D$s&&(this._width=D$s,this._style.width=D$s,this.repaint())}),D$T(0,D$e,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(D$s){this._height!==D$s&&(this._height=D$s,this._style.height=D$s,this.repaint())}),D$e.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),D$Z.clearCache(this,this._url),this._tex=null),D$w.prototype.destroy.call(this)},D$e.onloaded=function(){var D$s=this._style;D$s&&!D$s.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),D$s&&!D$s.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),D$A.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},D$e._loadImageComplete=function(D$s,D$r,D$e){if(!this._destroyed)if(null!=D$e)if(D$e instanceof ArrayBuffer){var D$U=new DataView(D$e);new laya.webgl.resource.WebGLImage(new Uint8Array(D$e,8),D$s,0,!1,D$U.getUint32(0),D$U.getUint32(4));this.onloaded()}else if(D$e instanceof D$l)D$Z.imgMgrSet[D$s]=D$r,D$k.imgMgrLock(D$s,D$Z.imgMgrSet[D$s]),this._url=D$s,this._tex=D$e,D$Z.keepCache(this,D$s),D$Z.cacheRes(D$s,this._tex),this.onloaded();else{var D$m=-1!=D$s.indexOf(".png",D$s.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(D$e,D$s,D$m,!1,D$e.width,D$e.height);this.onloaded()}else this.event("error","Load image failed")},D$T(0,D$e,"src",null,function(D$s){(D$s=this.formatURL(D$s),this._url!=D$s)&&(null!=this._tex&&(D$Z.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=D$s,(this._tex=D$Z.getRes(D$s))?(D$Z.keepCache(this,D$s),this.onloaded()):D$k.imgMgrLoad(D$s,this._loadImageComplete.bind(this),2,!1))})})(),function(D$s){function D$r(){this.type=null,D$r.__super.call(this),this.visible=!1}D$j(D$r,"laya.html.dom.HTMLLinkElement",D$s);var D$e=D$r.prototype;D$e._onload=function(D$s){switch(this.type){case"text/css":D$Y.parseCSS(D$s,this.URI)}},D$T(0,D$e,"href",D$s.prototype._$get_href,function(D$s){var D$r=this;D$s=this.formatURL(D$s),this.URI=new D$V(D$s);var D$e=new D$Z;D$e.once("complete",null,function(D$s){D$r._onload(D$s)}),D$e.load(D$s,"text")}),D$r._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(D$w),function(D$s){function D$r(){D$r.__super.call(this),this.visible=!1}D$j(D$r,"laya.html.dom.HTMLStyleElement",D$s),D$T(0,D$r.prototype,"text",D$s.prototype._$get_text,function(D$s){D$Y.parseCSS(D$s,null)})}(D$w),function(D$s){function D$r(){D$r.__super.call(this),this._getCSSStyle().valign="middle"}D$j(D$r,"laya.html.dom.HTMLIframeElement",D$s),D$T(0,D$r.prototype,"href",D$s.prototype._$get_href,function(D$e){var D$U=this;D$e=this.formatURL(D$e);var D$s=new D$Z;D$s.once("complete",null,function(D$s){var D$r=D$U.URI;D$U.URI=new D$V(D$e),D$U.innerHTML=D$s,!D$r||(D$U.URI=D$r)}),D$s.load(D$e,"text")})}(D$r)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(D$s,D$r){"use strict";for(var D$e in Object.defineProperty(D$r,"__esModule",{value:!0}),Laya){var D$U=Laya[D$e];D$U&&D$U.__isclass&&(D$r[D$e]=D$U)}}),function(D$m,D$s,D$$){D$$.un,D$$.uns;var D$U=D$$.static,D$k=D$$.class,D$j=D$$.getset,D$e=(D$$.__newvec,laya.display.Animation),D$l=(laya.utils.Browser,laya.utils.ClassUtils),D$T=laya.filters.ColorFilter,D$Y=laya.utils.Ease,D$Z=laya.events.Event,D$h=(laya.events.EventDispatcher,laya.display.css.Font),D$H=laya.display.FrameAnimation,D$r=laya.display.Graphics,D$A=laya.utils.Handler,D$x=laya.display.Input,D$b=laya.net.Loader,D$B=(laya.display.Node,laya.maths.Point),D$V=laya.maths.Rectangle,D$o=laya.renders.Render,D$I=laya.display.Sprite,D$w=laya.display.Text,D$X=laya.resource.Texture,D$D=laya.utils.Tween,D$n=laya.utils.Utils,D$y=laya.utils.WeakObject;D$$.interface("laya.ui.IItem"),D$$.interface("laya.ui.ISelect"),D$$.interface("laya.ui.IRender"),D$$.interface("laya.ui.IComponent"),D$$.interface("laya.ui.IBox","IComponent");var D$g=function(){function D$s(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return D$k(D$s,"laya.ui.LayoutStyle"),D$U(D$s,["EMPTY",function(){return this.EMPTY=new D$s}]),D$s}(),D$f=function(){function D$s(){}return D$k(D$s,"laya.ui.Styles"),D$s.labelColor="#000000",D$s.buttonStateNum=3,D$s.scrollBarMinNum=15,D$s.scrollBarDelayTime=500,D$U(D$s,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),D$s}(),D$J=function(){function D$m(){}return D$k(D$m,"laya.ui.UIUtils"),D$m.fillArray=function(D$s,D$r,D$e){var D$U=D$s.concat();if(D$r)for(var D$m=D$r.split(","),D$k=0,D$j=Math.min(D$U.length,D$m.length);D$k<D$j;D$k++){var D$T=D$m[D$k];D$U[D$k]="true"==D$T||"false"!=D$T&&D$T,null!=D$e&&(D$U[D$k]=D$e(D$T))}return D$U},D$m.toColor=function(D$s){return D$n.toHexColor(D$s)},D$m.gray=function(D$s,D$r){void 0===D$r&&(D$r=!0),D$r?D$m.addFilter(D$s,D$m.grayFilter):D$m.clearFilter(D$s,D$T)},D$m.addFilter=function(D$s,D$r){var D$e=D$s.filters||[];D$e.push(D$r),D$s.filters=D$e},D$m.clearFilter=function(D$s,D$r){var D$e=D$s.filters;if(null!=D$e&&0<D$e.length){for(var D$U=D$e.length-1;-1<D$U;D$U--){var D$m=D$e[D$U];D$$.__typeof(D$m,D$r)&&D$e.splice(D$U,1)}D$s.filters=D$e}},D$m._getReplaceStr=function(D$s){return D$m.escapeSequence[D$s]},D$m.adptString=function(D$s){return D$s.replace(/\\(\w)/g,D$m._getReplaceStr)},D$m.getBindFun=function(D$s){var D$r=D$m._funMap.get(D$s);if(null==D$r){var D$e='"'+D$s+'"',D$U="(function(data){if(data==null)return;with(data){try{\nreturn "+(D$e=D$e.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";D$r=D$$._runScript(D$U),D$m._funMap.set(D$s,D$r)}return D$r},D$U(D$m,["grayFilter",function(){return this.grayFilter=new D$T([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new D$y}]),D$m}(),D$P=function(){function D$s(){}return D$k(D$s,"UIConfig"),D$s.touchScrollEnable=!0,D$s.mouseWheelEnable=!0,D$s.showButtons=!0,D$s.popupBgColor="#000000",D$s.popupBgAlpha=.5,D$s.closeDialogOnSide=!0,D$s}(),D$O=function(D$e){function D$V(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,D$V.__super.call(this),this._weakKeys=[]}D$k(D$V,"laya.ui.AutoBitmap",D$e);var D$s=D$V.prototype;return D$s.destroy=function(){if(D$b.clearObject(this,this._weakKey),this._weakKeys){for(var D$s=0,D$r=this._weakKeys.length;D$s<D$r;++D$s)D$b.clearObject(this,this._weakKeys[D$s]);this._weakKeys=null}D$e.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},D$s._setChanged=function(){this._isChanged||(this._isChanged=!0,D$$.timer.callLater(this,this.changeSource))},D$s.changeSource=function(){this._isChanged=!1;var D$s=this._source;if(D$s&&D$s.bitmap){var D$r=this.width,D$e=this.height,D$U=this._sizeGrid,D$m=D$s.sourceWidth,D$k=D$s.sourceHeight;if(!D$U||D$m===D$r&&D$k===D$e)this.cleanByTexture(D$s,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,D$r,D$e);else{D$b.clearObject(this,this._weakKey),D$s.$_GID||(D$s.$_GID=D$n.getGID());var D$j=D$s.$_GID+"."+D$r+"."+D$e+"."+D$U.join("."),D$T=D$b.findObject(D$j);if(D$n.isOKCmdList(D$T))return this._weakKey=D$j,D$b.keepObject(this,this._weakKey),void(this.cmds=D$T);this.clear();var D$Y,D$Z,D$h=D$U[0],D$H=D$U[1],D$A=D$U[2],D$x=D$U[3],D$B=D$U[4],D$$=!1;if(D$r==D$m&&(D$x=D$H=0),D$e==D$k&&(D$h=D$A=0),D$r<D$x+D$H){var D$l=D$r;D$$=!0,D$r=D$x+D$H,this.save(),this.clipRect(0,0,D$l,D$e)}D$x&&D$h&&(D$Y=D$V.getTexture(D$s,0,0,D$x,D$h),D$Z=this._weakKeys[0],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[0]=D$Y.weakKey),this.drawTexture(D$Y,0,0,D$x,D$h)):(D$b.clearObject(this,D$Z),this._weakKeys[0]="")),D$H&&D$h&&(D$Y=D$V.getTexture(D$s,D$m-D$H,0,D$H,D$h),D$Z=this._weakKeys[1],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[1]=D$Y.weakKey),this.drawTexture(D$Y,D$r-D$H,0,D$H,D$h)):(D$b.clearObject(this,D$Z),this._weakKeys[1]="")),D$x&&D$A&&(D$Y=D$V.getTexture(D$s,0,D$k-D$A,D$x,D$A),D$Z=this._weakKeys[2],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[2]=D$Y.weakKey),this.drawTexture(D$Y,0,D$e-D$A,D$x,D$A)):(D$b.clearObject(this,D$Z),this._weakKeys[2]="")),D$H&&D$A&&(D$Y=D$V.getTexture(D$s,D$m-D$H,D$k-D$A,D$H,D$A),D$Z=this._weakKeys[3],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[3]=D$Y.weakKey),this.drawTexture(D$Y,D$r-D$H,D$e-D$A,D$H,D$A)):(D$b.clearObject(this,D$Z),this._weakKeys[3]="")),D$h&&(D$Y=D$V.getTexture(D$s,D$x,0,D$m-D$x-D$H,D$h),D$Z=this._weakKeys[4],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[4]=D$Y.weakKey),this.drawBitmap(D$B,D$Y,D$x,0,D$r-D$x-D$H,D$h)):(D$b.clearObject(this,D$Z),this._weakKeys[4]="")),D$A&&(D$Y=D$V.getTexture(D$s,D$x,D$k-D$A,D$m-D$x-D$H,D$A),D$Z=this._weakKeys[5],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[5]=D$Y.weakKey),this.drawBitmap(D$B,D$Y,D$x,D$e-D$A,D$r-D$x-D$H,D$A)):(D$b.clearObject(this,D$Z),this._weakKeys[5]="")),D$x&&(D$Y=D$V.getTexture(D$s,0,D$h,D$x,D$k-D$h-D$A),D$Z=this._weakKeys[6],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[6]=D$Y.weakKey),this.drawBitmap(D$B,D$Y,0,D$h,D$x,D$e-D$h-D$A)):(D$b.clearObject(this,D$Z),this._weakKeys[6]="")),D$H&&(D$Y=D$V.getTexture(D$s,D$m-D$H,D$h,D$H,D$k-D$h-D$A),D$Z=this._weakKeys[7],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[7]=D$Y.weakKey),this.drawBitmap(D$B,D$Y,D$r-D$H,D$h,D$H,D$e-D$h-D$A)):(D$b.clearObject(this,D$Z),this._weakKeys[7]="")),D$Y=D$V.getTexture(D$s,D$x,D$h,D$m-D$x-D$H,D$k-D$h-D$A),D$Z=this._weakKeys[8],D$Y?(D$Z!=D$Y.weakKey&&(D$b.clearObject(this,D$Z),D$b.keepObject(this,D$Y.weakKey),this._weakKeys[8]=D$Y.weakKey),this.drawBitmap(D$B,D$Y,D$x,D$h,D$r-D$x-D$H,D$e-D$h-D$A)):(D$b.clearObject(this,D$Z),this._weakKeys[8]=""),D$$&&this.restore(),this.autoCacheCmd&&!D$o.isConchApp&&(D$b.saveObject(D$j,this.cmds,null),this._weakKey=D$j,D$b.keepObject(this,this._weakKey))}this._repaint()}},D$s.drawBitmap=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=0),D$m<.1||D$k<.1||(!D$s||D$r.width==D$m&&D$r.height==D$k?this.drawTexture(D$r,D$e,D$U,D$m,D$k):this.fillTexture(D$r,D$e,D$U,D$m,D$k))},D$s.clear=function(D$s){void 0===D$s&&(D$s=!0),D$e.prototype.clear.call(this,!1)},D$j(0,D$s,"sizeGrid",function(){return this._sizeGrid},function(D$s){this._sizeGrid=D$s,this._setChanged()}),D$j(0,D$s,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(D$s){this._width!=D$s&&(this._width=D$s,this._setChanged())}),D$j(0,D$s,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(D$s){this._height!=D$s&&(this._height=D$s,this._setChanged())}),D$j(0,D$s,"source",function(){return this._source},function(D$s){D$s?(this._source=D$s,this._setChanged()):(this._source=null,this.clear())}),D$V.getTexture=function(D$s,D$r,D$e,D$U,D$m){D$U<=0&&(D$U=1),D$m<=0&&(D$m=1),D$s.$_GID||(D$s.$_GID=D$n.getGID());var D$k=D$s.$_GID+"."+D$r+"."+D$e+"."+D$U+"."+D$m,D$j=D$b.findObject(D$k);if((!D$j||!D$j.source)&&(D$j=D$X.createFromTexture(D$s,D$r,D$e,D$U,D$m))){if(D$s.alphaTexture){var D$T=D$s.width/D$s.alphaTexture.width;D$j.alphaTexture=D$X.createFromTexture(D$s.alphaTexture,D$r/D$T,D$e/D$T,D$U/D$T,D$m/D$T)}D$b.saveObject(D$k,D$j),D$j.weakKey=D$k}return D$j},D$V}(D$r),D$i=(function(D$s){function D$r(){D$r.__super.call(this)}D$k(D$r,"laya.ui.UIEvent",D$Z),D$r.SHOW_TIP="showtip",D$r.HIDE_TIP="hidetip"}(),function(D$r){function D$s(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,D$s.__super.call(this),this._layout=D$g.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}D$k(D$s,"laya.ui.Component",D$r);var D$e=D$s.prototype;return D$$.imps(D$e,{"laya.ui.IComponent":!0}),D$e.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},D$e.preinitialize=function(){},D$e.createChildren=function(){},D$e.initialize=function(){},D$e.callLater=function(D$s,D$r){D$$.timer.callLater(this,D$s,D$r)},D$e.runCallLater=function(D$s){D$$.timer.runCallLater(this,D$s)},D$e.commitMeasure=function(){},D$e.changeSize=function(){this.event("resize")},D$e.getLayout=function(){return this._layout===D$g.EMPTY&&(this._layout=new D$g),this._layout},D$e._setLayoutEnabled=function(D$s){this._layout&&this._layout.enable!=D$s&&(this._layout.enable=D$s,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},D$e.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},D$e.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},D$e.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},D$e.resetLayoutX=function(){var D$s=this._layout;if(isNaN(D$s.anchorX)||(this.pivotX=D$s.anchorX*this.width),this.layoutEnabled){var D$r=this.parent;D$r&&(isNaN(D$s.centerX)?isNaN(D$s.left)?isNaN(D$s.right)||(this.x=Math.round(D$r.width-this.displayWidth-D$s.right+this.pivotX*this.scaleX)):(this.x=Math.round(D$s.left+this.pivotX*this.scaleX),isNaN(D$s.right)||(this.width=(D$r._width-D$s.left-D$s.right)/(this.scaleX||.01))):this.x=Math.round(.5*(D$r.width-this.displayWidth)+D$s.centerX+this.pivotX*this.scaleX))}},D$e.resetLayoutY=function(){var D$s=this._layout;if(isNaN(D$s.anchorY)||(this.pivotY=D$s.anchorY*this.height),this.layoutEnabled){var D$r=this.parent;D$r&&(isNaN(D$s.centerY)?isNaN(D$s.top)?isNaN(D$s.bottom)||(this.y=Math.round(D$r.height-this.displayHeight-D$s.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(D$s.top+this.pivotY*this.scaleY),isNaN(D$s.bottom)||(this.height=(D$r._height-D$s.top-D$s.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(D$r.height-this.displayHeight)+D$s.centerY+this.pivotY*this.scaleY))}},D$e.onMouseOver=function(D$s){D$$.stage.event("showtip",this._toolTip)},D$e.onMouseOut=function(D$s){D$$.stage.event("hidetip",this._toolTip)},D$j(0,D$e,"displayWidth",function(){return this.width*this.scaleX}),D$j(0,D$e,"width",function(){return this._width?this._width:this.measureWidth},function(D$s){this._width!=D$s&&(this._width=D$s,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),D$j(0,D$e,"measureWidth",function(){var D$s=0;this.commitMeasure();for(var D$r=this.numChildren-1;-1<D$r;D$r--){var D$e=this.getChildAt(D$r);D$e.visible&&(D$s=Math.max(D$e.x+D$e.width*D$e.scaleX,D$s))}return D$s}),D$j(0,D$e,"displayHeight",function(){return this.height*this.scaleY}),D$j(0,D$e,"height",function(){return this._height?this._height:this.measureHeight},function(D$s){this._height!=D$s&&(this._height=D$s,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),D$j(0,D$e,"dataSource",function(){return this._dataSource},function(D$s){for(var D$r in this._dataSource=D$s,this._dataSource)this.hasOwnProperty(D$r)&&"function"!=typeof this[D$r]&&(this[D$r]=this._dataSource[D$r])}),D$j(0,D$e,"scaleY",D$r.prototype._$get_scaleY,function(D$s){D$$.superGet(D$I,this,"scaleY")!=D$s&&(D$$.superSet(D$I,this,"scaleY",D$s),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),D$j(0,D$e,"measureHeight",function(){var D$s=0;this.commitMeasure();for(var D$r=this.numChildren-1;-1<D$r;D$r--){var D$e=this.getChildAt(D$r);D$e.visible&&(D$s=Math.max(D$e.y+D$e.height*D$e.scaleY,D$s))}return D$s}),D$j(0,D$e,"scaleX",D$r.prototype._$get_scaleX,function(D$s){D$$.superGet(D$I,this,"scaleX")!=D$s&&(D$$.superSet(D$I,this,"scaleX",D$s),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),D$j(0,D$e,"top",function(){return this._layout.top},function(D$s){D$s!=this._layout.top&&(this.getLayout().top=D$s,this._setLayoutEnabled(!0)),this.resetLayoutY()}),D$j(0,D$e,"bottom",function(){return this._layout.bottom},function(D$s){D$s!=this._layout.bottom&&(this.getLayout().bottom=D$s,this._setLayoutEnabled(!0)),this.resetLayoutY()}),D$j(0,D$e,"left",function(){return this._layout.left},function(D$s){D$s!=this._layout.left&&(this.getLayout().left=D$s,this._setLayoutEnabled(!0)),this.resetLayoutX()}),D$j(0,D$e,"right",function(){return this._layout.right},function(D$s){D$s!=this._layout.right&&(this.getLayout().right=D$s,this._setLayoutEnabled(!0)),this.resetLayoutX()}),D$j(0,D$e,"centerX",function(){return this._layout.centerX},function(D$s){D$s!=this._layout.centerX&&(this.getLayout().centerX=D$s,this._setLayoutEnabled(!0)),this.resetLayoutX()}),D$j(0,D$e,"centerY",function(){return this._layout.centerY},function(D$s){D$s!=this._layout.centerY&&(this.getLayout().centerY=D$s,this._setLayoutEnabled(!0)),this.resetLayoutY()}),D$j(0,D$e,"anchorX",function(){return this._layout.anchorX},function(D$s){D$s!=this._layout.anchorX&&(this.getLayout().anchorX=D$s,this._setLayoutEnabled(!0)),this.resetLayoutX()}),D$j(0,D$e,"anchorY",function(){return this._layout.anchorY},function(D$s){D$s!=this._layout.anchorY&&(this.getLayout().anchorY=D$s,this._setLayoutEnabled(!0)),this.resetLayoutY()}),D$j(0,D$e,"tag",function(){return this._tag},function(D$s){this._tag=D$s}),D$j(0,D$e,"toolTip",function(){return this._toolTip},function(D$s){this._toolTip!=D$s&&(null!=(this._toolTip=D$s)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),D$j(0,D$e,"comXml",function(){return this._comXml},function(D$s){this._comXml=D$s}),D$j(0,D$e,"gray",function(){return this._gray},function(D$s){D$s!==this._gray&&(this._gray=D$s,D$J.gray(this,D$s))}),D$j(0,D$e,"disabled",function(){return this._disabled},function(D$s){D$s!==this._disabled&&(this.gray=this._disabled=D$s,this.mouseEnabled=!D$s)}),D$s}(D$I)),D$K=function(D$s){function D$r(){this.lockLayer=null,this.popupEffect=function(D$s){D$s.scale(1,1),D$D.from(D$s,{x:D$$.stage.width/2,y:D$$.stage.height/2,scaleX:0,scaleY:0},300,D$Y.backOut,D$A.create(this,this.doOpen,[D$s]))},this.closeEffect=function(D$s,D$r){D$D.to(D$s,{x:D$$.stage.width/2,y:D$$.stage.height/2,scaleX:0,scaleY:0},300,D$Y.strongOut,D$A.create(this,this.doClose,[D$s,D$r]))},D$r.__super.call(this),this.maskLayer=new D$I,this.popupEffectHandler=D$A.create(this,this.popupEffect,null,!1),this.closeEffectHandler=D$A.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,D$$.stage.addChild(this),D$$.stage.on("resize",this,this._onResize),D$P.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}D$k(D$r,"laya.ui.DialogManager",D$I);var D$e=D$r.prototype;return D$e._closeOnSide=function(){var D$s=this.getChildAt(this.numChildren-1);D$s instanceof laya.ui.Dialog&&D$s.close("side")},D$e.setLockView=function(D$s){this.lockLayer||(this.lockLayer=new D$c,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(D$$.stage.width,D$$.stage.height)),this.lockLayer.removeChildren(),D$s&&(D$s.centerX=D$s.centerY=0,this.lockLayer.addChild(D$s))},D$e._onResize=function(D$s){var D$r=this.maskLayer.width=D$$.stage.width,D$e=this.maskLayer.height=D$$.stage.height;this.lockLayer&&this.lockLayer.size(D$r,D$e),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,D$r,D$e,D$P.popupBgColor),this.maskLayer.alpha=D$P.popupBgAlpha;for(var D$U=this.numChildren-1;-1<D$U;D$U--){var D$m=this.getChildAt(D$U);D$m.popupCenter&&this._centerDialog(D$m)}},D$e._centerDialog=function(D$s){D$s.x=Math.round((D$$.stage.width-D$s.width>>1)+D$s.pivotX),D$s.y=Math.round((D$$.stage.height-D$s.height>>1)+D$s.pivotY)},D$e.open=function(D$s,D$r,D$e){void 0===D$r&&(D$r=!1),void 0===D$e&&(D$e=!1),D$r&&this._closeAll(),D$s.popupCenter&&this._centerDialog(D$s),this.addChild(D$s),(D$s.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),D$e&&null!=D$s.popupEffect?D$s.popupEffect.runWith(D$s):this.doOpen(D$s),this.event("open")},D$e.doOpen=function(D$s){D$s.onOpened()},D$e.lock=function(D$s){this.lockLayer&&(D$s?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},D$e.close=function(D$s,D$r,D$e){void 0===D$e&&(D$e=!1),D$e&&null!=D$s.closeEffect?D$s.closeEffect.runWith([D$s,D$r]):this.doClose(D$s,D$r),this.event("close")},D$e.doClose=function(D$s,D$r){D$s.removeSelf(),D$s.isModal&&this._checkMask(),D$s.closeHandler&&D$s.closeHandler.runWith(D$r),D$s.onClosed(D$r)},D$e.closeAll=function(){this._closeAll(),this.event("close")},D$e._closeAll=function(){for(var D$s=this.numChildren-1;-1<D$s;D$s--){var D$r=this.getChildAt(D$s);D$r&&null!=D$r.close&&this.doClose(D$r)}},D$e.getDialogsByGroup=function(D$s){for(var D$r=[],D$e=this.numChildren-1;-1<D$e;D$e--){var D$U=this.getChildAt(D$e);D$U&&D$U.group===D$s&&D$r.push(D$U)}return D$r},D$e.closeByGroup=function(D$s){for(var D$r=[],D$e=this.numChildren-1;-1<D$e;D$e--){var D$U=this.getChildAt(D$e);D$U&&D$U.group===D$s&&(D$U.close(),D$r.push(D$U))}return D$r},D$e._checkMask=function(){this.maskLayer.removeSelf();for(var D$s=this.numChildren-1;-1<D$s;D$s--){var D$r=this.getChildAt(D$s);if(D$r&&D$r.isModal)return void this.addChildAt(this.maskLayer,D$s)}},D$r}(),D$c=function(D$s){function D$r(){D$r.__super.call(this)}D$k(D$r,"laya.ui.Box",D$s);var D$e=D$r.prototype;return D$$.imps(D$e,{"laya.ui.IBox":!0}),D$j(0,D$e,"dataSource",D$s.prototype._$get_dataSource,function(D$s){for(var D$r in this._dataSource=D$s){var D$e=this.getChildByName(D$r);D$e?D$e.dataSource=D$s[D$r]:this.hasOwnProperty(D$r)&&"function"!=typeof this[D$r]&&(this[D$r]=D$s[D$r])}}),D$r}(D$i),D$E=function(D$r){function D$e(D$s,D$r){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,D$e.__super.call(this),this._labelColors=D$f.buttonLabelColors,this._stateNum=D$f.buttonStateNum,void 0===D$r&&(D$r=""),this.skin=D$s,this.label=D$r}D$k(D$e,"laya.ui.Button",D$r);var D$s=D$e.prototype;return D$$.imps(D$s,{"laya.ui.ISelect":!0}),D$s.destroy=function(D$s){this.clearEvent(),D$b.clearCache(this,this._skin),D$b.clearObject(this,this._weakKey),void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(D$s),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},D$s.clearEvent=function(){this._skin&&D$m.atalsNotify&&D$m.atalsNotify.off(this._skin,this,this._setBtnSource)},D$s.createChildren=function(){this.graphics=this._bitmap=new D$O},D$s.createText=function(){this._text||(this._text=new D$w,this._text.overflow=D$w.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},D$s.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},D$s.onMouse=function(D$s){if(!1!==this.toggle||!this._selected)return"click"===D$s.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=D$e.stateMap[D$s.type]))},D$s.changeClips=function(){var D$s=D$b.getRes(this._skin);if(D$s)if(this._skin&&""!=this._skin){D$b.clearObject(this,this._weakKey);var D$r=D$s.sourceWidth,D$e=D$s.sourceHeight/this._stateNum;D$s.$_GID||(D$s.$_GID=D$n.getGID());var D$U=D$s.$_GID+"-"+this._stateNum,D$m=D$b.findObject(D$U);if(D$n.isOkTextureList(D$m)||(D$m=null),D$m)this._weakKey=D$U,D$b.keepObject(this,this._weakKey),this._sources=D$m;else{if(this._sources=[],1===this._stateNum)this._sources.push(D$s);else for(var D$k=0;D$k<this._stateNum;D$k++){var D$j=D$X.createFromTexture(D$s,0,D$e*D$k,D$r,D$e);if(D$s.alphaTexture){var D$T=D$s.width/D$s.alphaTexture.width;D$j.alphaTexture=D$X.createFromTexture(D$s.alphaTexture,0/D$T,D$e*D$k/D$T,D$r/D$T,D$e/D$T)}this._sources.push(D$j)}D$b.saveObject(D$U,this._sources),this._weakKey=D$U,D$b.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||D$r,this._bitmap.height=this._height||D$e,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=D$r)}else console.warn("lose skin ",this._skin,this.name,this.__className)},D$s.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var D$s=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[D$s]),this.label&&(this._text.color=this._labelColors[D$s],this._strokeColors&&(this._text.strokeColor=this._strokeColors[D$s]))},D$s._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},D$j(0,D$s,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(D$s){this.createText(),this._text.strokeColor=D$s}),D$j(0,D$s,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),D$j(0,D$s,"skin",function(){return this._skin},function(D$s){if(this._skin!=D$s)if(this.clearEvent(),D$b.clearCache(this,this._skin),this._skin=D$s,D$b.keepCache(this,this._skin),D$b.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var D$r=D$m.resAtalsObj&&D$m.resAtalsObj[this._skin];D$r?(D$m.atalsNotify&&D$m.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=D$r.sourceW),0==this.height&&(this.height=D$r.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),D$s._setBtnSource=function(D$s,D$r){D$s===this._skin&&D$r&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},D$j(0,D$s,"state",function(){return this._state},function(D$s){this._state!=D$s&&(this._state=D$s,this._setStateChanged())}),D$j(0,D$s,"text",function(){return this.createText(),this._text}),D$j(0,D$s,"stateNum",function(){return this._stateNum},function(D$s){"string"==typeof D$s&&(D$s=parseInt(D$s)),this._stateNum!=D$s&&(this._stateNum=D$s<1?1:3<D$s?3:D$s,this.callLater(this.changeClips))}),D$j(0,D$s,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(D$s){this._strokeColors=D$J.fillArray(D$f.buttonLabelColors,D$s,String),this._setStateChanged()}),D$j(0,D$s,"labelColors",function(){return this._labelColors.join(",")},function(D$s){this._labelColors=D$J.fillArray(D$f.buttonLabelColors,D$s,String),this._setStateChanged()}),D$j(0,D$s,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),D$j(0,D$s,"label",function(){return this._text?this._text.text:null},function(D$s){(this._text||D$s)&&(this.createText(),this._text.text!=D$s&&(D$s&&!this._text.parent&&this.addChild(this._text),this._text.text=(D$s+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),D$j(0,D$s,"selected",function(){return this._selected},function(D$s){this._selected!=D$s&&(this._selected=D$s,this.state=this._selected?2:0,this.event("change"))}),D$j(0,D$s,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(D$s){this.createText(),this._text.padding=D$J.fillArray(D$f.labelPadding,D$s,Number)}),D$j(0,D$s,"labelSize",function(){return this.createText(),this._text.fontSize},function(D$s){this.createText(),this._text.fontSize=D$s}),D$j(0,D$s,"labelStroke",function(){return this.createText(),this._text.stroke},function(D$s){this.createText(),this._text.stroke=D$s}),D$j(0,D$s,"labelBold",function(){return this.createText(),this._text.bold},function(D$s){this.createText(),this._text.bold=D$s}),D$j(0,D$s,"labelFont",function(){return this.createText(),this._text.font},function(D$s){this.createText(),this._text.font=D$s}),D$j(0,D$s,"labelAlign",function(){return this.createText(),this._text.align},function(D$s){this.createText(),this._text.align=D$s}),D$j(0,D$s,"clickHandler",function(){return this._clickHandler},function(D$s){this._clickHandler=D$s}),D$j(0,D$s,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(D$s){this._bitmap.sizeGrid=D$J.fillArray(D$f.defaultSizeGrid,D$s,Number)}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$i,this,"width",D$s),this._autoSize&&(this._bitmap.width=D$s,this._text&&(this._text.width=D$s))}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$i,this,"height",D$s),this._autoSize&&(this._bitmap.height=D$s,this._text&&(this._text.height=D$s))}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)||"string"==typeof D$s?this.label=D$s+"":D$$.superSet(D$i,this,"dataSource",D$s)}),D$j(0,D$s,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(D$s){this._bitmap._offset=D$s?D$J.fillArray([1,1],D$s,Number):[]}),D$U(D$e,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),D$e}(D$i),D$v=function(D$r){function D$U(D$s,D$r,D$e){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,D$U.__super.call(this),void 0===D$r&&(D$r=1),void 0===D$e&&(D$e=1),this._clipX=D$r,this._clipY=D$e,this.skin=D$s}D$k(D$U,"laya.ui.Clip",D$r);var D$s=D$U.prototype;return D$s.destroy=function(D$s){this.clearEvent(),this.clearLoad(),D$b.clearCache(this,this._skin),D$b.clearObject(this,this._weakKey),void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},D$s.dispose=function(){this.destroy(!0),D$$.loader.clearRes(this._skin)},D$s.createChildren=function(){this.graphics=this._bitmap=new D$O},D$s._onDisplay=function(D$s){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},D$s.changeClip=function(){if(this._clipChanged=!1,this._skin){var D$s=D$b.getRes(this._skin);if(D$s)this.loadComplete(this._skin,D$s);else{if(D$m.resAtalsObj&&D$m.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=D$A.create(this,this.loadComplete,[this._skin]),this._progress=null,D$$.loader.load(this._skin,this._complete,this._progress)}}},D$s.loadComplete=function(D$s,D$r){if(D$s===this._skin&&D$r){D$b.clearObject(this,this._weakKey);var D$e=this._clipWidth||Math.ceil(D$r.sourceWidth/this._clipX),D$U=this._clipHeight||Math.ceil(D$r.sourceHeight/this._clipY),D$m=this._skin+D$e+D$U,D$k=D$b.findObject(D$m);if(D$n.isOkTextureList(D$k)||(D$k=null),D$k)this._weakKey=D$m,D$b.keepObject(this,this._weakKey),this._sources=D$k;else{this._sources=[];for(var D$j=0;D$j<this._clipY;D$j++)for(var D$T=0;D$T<this._clipX;D$T++){var D$Y=D$X.createFromTexture(D$r,D$e*D$T,D$U*D$j,D$e,D$U);if(D$r.alphaTexture){var D$Z=D$r.width/D$r.alphaTexture.width;D$Y.alphaTexture=D$X.createFromTexture(D$r.alphaTexture,D$e*D$T/D$Z,D$U*D$j/D$Z,D$e/D$Z,D$U/D$Z)}this._sources.push(D$Y)}D$b.saveObject(D$m,this._sources),this._weakKey=D$m,D$b.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},D$s.play=function(D$s,D$r){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=-1),this._isPlaying=!0,this.index=D$s,this._toIndex=D$r,this._index++,D$$.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},D$s._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},D$s.stop=function(){this._isPlaying=!1,D$$.timer.clear(this,this._loop),this.event("complete")},D$s._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},D$j(0,D$s,"interval",function(){return this._interval},function(D$s){this._interval!=D$s&&(this._interval=D$s,this._isPlaying&&this.play())}),D$s.clearEvent=function(){this._skin&&D$m.atalsNotify&&D$m.atalsNotify.off(this._skin,this,this._setBtnSource)},D$s.clearLoad=function(){this._skin&&((this._complete||this._progress)&&D$$.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},D$j(0,D$s,"skin",function(){return this._skin},function(D$s){if(this._skin!=D$s)if(this.clearLoad(),this.clearEvent(),D$b.clearCache(this,this._skin),this._skin=D$s){D$b.keepCache(this,this._skin);var D$r=D$b.getRes(D$s),D$e=D$m.resAtalsObj&&D$m.resAtalsObj[this._skin];!D$r&&D$e?D$m.atalsNotify&&D$m.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),D$s._setBtnSource=function(D$s,D$r){D$s===this._skin&&D$r&&(this.loadComplete(D$s,D$r),this.clearEvent())},D$j(0,D$s,"sources",function(){return this._sources},function(D$s){this._sources=D$s,this.index=this._index,this.event("loaded")}),D$j(0,D$s,"clipX",function(){return this._clipX},function(D$s){this._clipX=D$s||1,this._setClipChanged()}),D$j(0,D$s,"clipY",function(){return this._clipY},function(D$s){this._clipY=D$s||1,this._setClipChanged()}),D$j(0,D$s,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),D$j(0,D$s,"clipWidth",function(){return this._clipWidth},function(D$s){this._clipWidth=D$s,this._setClipChanged()}),D$j(0,D$s,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(D$s){this._bitmap.sizeGrid=D$J.fillArray(D$f.defaultSizeGrid,D$s,Number)}),D$j(0,D$s,"group",function(){return this._group},function(D$s){D$s&&this._skin&&D$b.setGroup(this._skin,D$s),this._group=D$s}),D$j(0,D$s,"clipHeight",function(){return this._clipHeight},function(D$s){this._clipHeight=D$s,this._setClipChanged()}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$i,this,"width",D$s),this._bitmap.width=D$s}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$i,this,"height",D$s),this._bitmap.height=D$s}),D$j(0,D$s,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),D$j(0,D$s,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),D$j(0,D$s,"index",function(){return this._index},function(D$s){this._index=D$s,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[D$s]),this.event("change")}),D$j(0,D$s,"autoPlay",function(){return this._autoPlay},function(D$s){this._autoPlay!=D$s&&((this._autoPlay=D$s)?this.play():this.stop())}),D$j(0,D$s,"isPlaying",function(){return this._isPlaying},function(D$s){this._isPlaying=D$s}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)&&Math.floor(D$s)==D$s||"string"==typeof D$s?this.index=parseInt(D$s):D$$.superSet(D$i,this,"dataSource",D$s)}),D$j(0,D$s,"bitmap",function(){return this._bitmap}),D$U}(D$i),D$S=function(D$r){function D$s(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,D$s.__super.call(this)}D$k(D$s,"laya.ui.ColorPicker",D$r);var D$e=D$s.prototype;return D$e.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._colorPanel&&this._colorPanel.destroy(D$s),this._colorButton&&this._colorButton.destroy(D$s),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},D$e.createChildren=function(){this.addChild(this._colorButton=new D$E),this._colorPanel=new D$c,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new D$I),this._colorPanel.addChild(this._colorBlock=new D$I),this._colorPanel.addChild(this._colorInput=new D$x)},D$e.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},D$e.onPanelMouseDown=function(D$s){D$s.stopPropagation()},D$e.changePanel=function(){this._panelChanged=!1;var D$s=this._colorPanel.graphics;D$s.clear(),D$s.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(D$s=this._colorTiles.graphics).clear();for(var D$r=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],D$e=0;D$e<12;D$e++)for(var D$U=0;D$U<20;D$U++){var D$m=0;D$m=0===D$U?D$r[D$e]:1===D$U?0:51*(((3*D$e+D$U/6)%3<<0)+3*(D$e/6<<0))<<16|D$U%6*51<<8|(D$e<<0)%6*51;var D$k=D$J.toColor(D$m);this._colors.push(D$k);var D$j=D$U*this._gridSize,D$T=D$e*this._gridSize;D$s.drawRect(D$j,D$T,this._gridSize,this._gridSize,D$k,"#000000")}},D$e.onColorButtonClick=function(D$s){this._colorPanel.parent?this.close():this.open()},D$e.open=function(){var D$s=this.localToGlobal(new D$B),D$r=D$s.x+this._colorPanel.width<=D$$.stage.width?D$s.x:D$$.stage.width-this._colorPanel.width,D$e=D$s.y+this._colorButton.height;D$e=D$e+this._colorPanel.height<=D$$.stage.height?D$e:D$s.y-this._colorPanel.height,this._colorPanel.pos(D$r,D$e),this._colorPanel.zOrder=1001,D$$._currentStage.addChild(this._colorPanel),D$$.stage.on("mousedown",this,this.removeColorBox)},D$e.close=function(){D$$.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},D$e.removeColorBox=function(D$s){this.close()},D$e.onColorFieldKeyDown=function(D$s){13==D$s.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),D$s.stopPropagation())},D$e.onColorInputChange=function(D$s){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},D$e.onColorTilesClick=function(D$s){this.selectedColor=this.getColorByMouse(),this.close()},D$e.onColorTilesMouseMove=function(D$s){this._colorInput.focus=!1;var D$r=this.getColorByMouse();this._colorInput.text=D$r,this.drawBlock(D$r)},D$e.getColorByMouse=function(){var D$s=this._colorTiles.getMousePoint(),D$r=Math.floor(D$s.x/this._gridSize),D$e=Math.floor(D$s.y/this._gridSize);return this._colors[20*D$e+D$r]},D$e.drawBlock=function(D$s){var D$r=this._colorBlock.graphics;D$r.clear();var D$e=D$s||"#ffffff";D$r.drawRect(0,0,50,20,D$e,this._borderColor),D$s||D$r.drawLine(0,0,50,20,"#ff0000")},D$e.changeColor=function(){var D$s=this.graphics;D$s.clear();var D$r=this._selectedColor||"#000000";D$s.drawRect(0,0,this._colorButton.width,this._colorButton.height,D$r)},D$e._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},D$j(0,D$e,"inputBgColor",function(){return this._inputBgColor},function(D$s){this._inputBgColor=D$s,this._setPanelChanged()}),D$j(0,D$e,"selectedColor",function(){return this._selectedColor},function(D$s){this._selectedColor!=D$s&&(this._selectedColor=this._colorInput.text=D$s,this.drawBlock(D$s),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",D$Z.EMPTY.setTo("change",this,this)))}),D$j(0,D$e,"skin",function(){return this._colorButton.skin},function(D$s){this._colorButton.skin=D$s,this.changeColor()}),D$j(0,D$e,"bgColor",function(){return this._bgColor},function(D$s){this._bgColor=D$s,this._setPanelChanged()}),D$j(0,D$e,"borderColor",function(){return this._borderColor},function(D$s){this._borderColor=D$s,this._setPanelChanged()}),D$j(0,D$e,"inputColor",function(){return this._inputColor},function(D$s){this._inputColor=D$s,this._setPanelChanged()}),D$s}(D$i),D$z=function(D$r){function D$e(D$s,D$r){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,D$e.__super.call(this),this._itemColors=D$f.comboBoxItemColors,this.skin=D$s,this.labels=D$r}D$k(D$e,"laya.ui.ComboBox",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._button&&this._button.destroy(D$s),this._list&&this._list.destroy(D$s),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},D$s.createChildren=function(){this.addChild(this._button=new D$E),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},D$s._createList=function(){this._list=new D$t,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},D$s._setListEvent=function(D$s){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=D$A.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},D$s.onListDown=function(D$s){D$s.stopPropagation()},D$s.onScrollBarDown=function(D$s){D$s.stopPropagation()},D$s.onButtonMouseDown=function(D$s){this.callLater(this.switchTo,[!this._isOpen])},D$s.changeList=function(){this._listChanged=!1;var D$s=this.width-2,D$r=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:D$s,height:this._itemHeight,fontSize:this._itemSize,color:D$r}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},D$s.onlistItemMouse=function(D$s,D$r){var D$e=D$s.type;if("mouseover"===D$e||"mouseout"===D$e){if(this._isCustomList)return;var D$U=this._list.getCell(D$r);if(!D$U)return;var D$m=D$U.getChildByName("label");D$m&&("mouseover"===D$e?(D$m.bgColor=this._itemColors[0],D$m.color=this._itemColors[1]):(D$m.bgColor=null,D$m.color=this._itemColors[2]))}else"click"===D$e&&(this.selectedIndex=D$r,this.isOpen=!1)},D$s.switchTo=function(D$s){this.isOpen=D$s},D$s.changeOpen=function(){this.isOpen=!this._isOpen},D$s.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var D$s=this._list.graphics;D$s.clear(),D$s.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var D$r=this._list.array||[],D$e=D$r.length=0,D$U=this._labels.length;D$e<D$U;D$e++)D$r.push({label:this._labels[D$e]});this._list.height=this._listHeight,this._list.array=D$r},D$s.changeSelected=function(){this._button.label=this.selectedLabel},D$s._onStageMouseWheel=function(D$s){this._list&&!this._list.contains(D$s.target)&&this.removeList(null)},D$s.removeList=function(D$s){D$$.stage.off("mousedown",this,this.removeList),D$$.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},D$j(0,D$s,"selectedIndex",function(){return this._selectedIndex},function(D$s){this._selectedIndex!=D$s&&(this._selectedIndex=D$s,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[D$Z.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),D$j(0,D$s,"measureHeight",function(){return this._button.height}),D$j(0,D$s,"skin",function(){return this._button.skin},function(D$s){this._button.skin!=D$s&&(this._button.skin=D$s,this._listChanged=!0)}),D$j(0,D$s,"measureWidth",function(){return this._button.width}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$i,this,"width",D$s),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),D$j(0,D$s,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(D$s){this.selectedIndex=this._labels.indexOf(D$s)}),D$j(0,D$s,"labels",function(){return this._labels.join(",")},function(D$s){0<this._labels.length&&(this.selectedIndex=-1),D$s?this._labels=D$s.split(","):this._labels.length=0,this._itemChanged=!0}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$i,this,"height",D$s),this._button.height=this._height}),D$j(0,D$s,"selectHandler",function(){return this._selectHandler},function(D$s){this._selectHandler=D$s}),D$j(0,D$s,"visibleNum",function(){return this._visibleNum},function(D$s){this._visibleNum=D$s,this._listChanged=!0}),D$j(0,D$s,"labelBold",function(){return this._button.text.bold},function(D$s){this._button.text.bold=D$s}),D$j(0,D$s,"itemColors",function(){return String(this._itemColors)},function(D$s){this._itemColors=D$J.fillArray(this._itemColors,D$s,String),this._listChanged=!0}),D$j(0,D$s,"itemSize",function(){return this._itemSize},function(D$s){this._itemSize=D$s,this._listChanged=!0}),D$j(0,D$s,"scrollBar",function(){return this.list.scrollBar}),D$j(0,D$s,"isOpen",function(){return this._isOpen},function(D$s){if(this._isOpen!=D$s)if(this._isOpen=D$s,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var D$r=this.localToGlobal(D$B.TEMP.setTo(0,0)),D$e=D$r.y+this._button.height;D$e=D$e+this._listHeight<=D$$.stage.height?D$e:D$r.y-this._listHeight,this._list.pos(D$r.x,D$e),this._list.zOrder=1001,D$$._currentStage.addChild(this._list),D$$.stage.once("mousedown",this,this.removeList),D$$.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),D$j(0,D$s,"scrollBarSkin",function(){return this._scrollBarSkin},function(D$s){this._scrollBarSkin=D$s}),D$j(0,D$s,"sizeGrid",function(){return this._button.sizeGrid},function(D$s){this._button.sizeGrid=D$s}),D$j(0,D$s,"button",function(){return this._button}),D$j(0,D$s,"list",function(){return this._list||this._createList(),this._list},function(D$s){D$s&&(D$s.removeSelf(),this._isCustomList=!0,this._list=D$s,this._setListEvent(D$s),this._itemHeight=D$s.getCell(0).height+D$s.spaceY)}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)&&Math.floor(D$s)==D$s||"string"==typeof D$s?this.selectedIndex=parseInt(D$s):D$s instanceof Array?this.labels=D$s.join(","):D$$.superSet(D$i,this,"dataSource",D$s)}),D$j(0,D$s,"labelColors",function(){return this._button.labelColors},function(D$s){this._button.labelColors!=D$s&&(this._button.labelColors=D$s)}),D$j(0,D$s,"labelPadding",function(){return this._button.text.padding.join(",")},function(D$s){this._button.text.padding=D$J.fillArray(D$f.labelPadding,D$s,Number)}),D$j(0,D$s,"labelSize",function(){return this._button.text.fontSize},function(D$s){this._button.text.fontSize=D$s}),D$j(0,D$s,"labelFont",function(){return this._button.text.font},function(D$s){this._button.text.font=D$s}),D$j(0,D$s,"stateNum",function(){return this._button.stateNum},function(D$s){this._button.stateNum=D$s}),D$e}(D$i),D$Q=function(D$r){function D$e(D$s){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,D$e.__super.call(this),this._showButtons=D$P.showButtons,this._touchScrollEnable=D$P.touchScrollEnable,this._mouseWheelEnable=D$P.mouseWheelEnable,this.skin=D$s,this.max=1}D$k(D$e,"laya.ui.ScrollBar",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),this.stopScroll(),this.target=null,D$r.prototype.destroy.call(this,D$s),this.upButton&&this.upButton.destroy(D$s),this.downButton&&this.downButton.destroy(D$s),this.slider&&this.slider.destroy(D$s),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},D$s.createChildren=function(){this.addChild(this.slider=new D$C),this.addChild(this.upButton=new D$E),this.addChild(this.downButton=new D$E)},D$s.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},D$s.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},D$s.onButtonMouseDown=function(D$s){var D$r=D$s.currentTarget===this.upButton;this.slide(D$r),D$$.timer.once(D$f.scrollBarDelayTime,this,this.startLoop,[D$r]),D$$.stage.once("mouseup",this,this.onStageMouseUp)},D$s.startLoop=function(D$s){D$$.timer.frameLoop(1,this,this.slide,[D$s])},D$s.slide=function(D$s){D$s?this.value-=this._scrollSize:this.value+=this._scrollSize},D$s.onStageMouseUp=function(D$s){D$$.timer.clear(this,this.startLoop),D$$.timer.clear(this,this.slide)},D$s.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},D$s.changeSize=function(){D$r.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},D$s.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},D$s.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},D$s.setScroll=function(D$s,D$r,D$e){this.runCallLater(this.changeSize),this.slider.setSlider(D$s,D$r,D$e),this.slider.bar.visible=0<D$r,!this._hide&&this.autoHide&&(this.visible=!1)},D$s.onTargetMouseWheel=function(D$s){this.value-=D$s.delta*this._scrollSize,this.target=this._target},D$s.onTargetMouseDown=function(D$s){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new D$B),this._lastPoint.setTo(D$$.stage.mouseX,D$$.stage.mouseY),D$$.timer.clear(this,this.tweenMove),D$D.clearTween(this),D$$.stage.once("mouseup",this,this.onStageMouseUp2),D$$.stage.once("mouseout",this,this.onStageMouseUp2),D$$.timer.frameLoop(1,this,this.loop)},D$s.loop=function(){var D$s=D$$.stage.mouseY,D$r=D$$.stage.mouseX;if(this._lastOffset=this.isVertical?D$s-this._lastPoint.y:D$r-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?D$$.stage._canvasTransform.getScaleY():D$$.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=D$r,this._lastPoint.y=D$s,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},D$s.onStageMouseUp2=function(D$s){if(D$$.stage.off("mouseup",this,this.onStageMouseUp2),D$$.stage.off("mouseout",this,this.onStageMouseUp2),D$$.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?D$D.to(this,{value:this.min},this.elasticBackTime,D$Y.sineOut,D$A.create(this,this.elasticOver)):this._value>this.max&&D$D.to(this,{value:this.max},this.elasticBackTime,D$Y.sineOut,D$A.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?D$$.stage.mouseY-this._lastPoint.y:D$$.stage.mouseX-this._lastPoint.x);for(var D$r=0,D$e=Math.min(this._offsets.length,3),D$U=0;D$U<D$e;D$U++)D$r+=this._offsets[this._offsets.length-1-D$U];if(this._lastOffset=D$r/D$e,(D$r=Math.abs(this._lastOffset))<2)return void this.event("end");60<D$r&&(this._lastOffset=0<this._lastOffset?60:-60);var D$m=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));D$$.timer.frameLoop(1,this,this.tweenMove,[D$m])}},D$s.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&D$D.to(this,{alpha:0},500),this.event("end")},D$s.tweenMove=function(D$s){this._lastOffset*=this.rollRatio;var D$r=NaN;if(0<D$s&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,D$r=.5*-(this.min-D$s-this.value),this._lastOffset>D$r&&(this._lastOffset=D$r)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,D$r=.5*-(this.max+D$s-this.value),this._lastOffset<D$r&&(this._lastOffset=D$r))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(D$$.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?D$D.to(this,{value:this.min},this.elasticBackTime,D$Y.sineOut,D$A.create(this,this.elasticOver)):this._value>this.max?D$D.to(this,{value:this.max},this.elasticBackTime,D$Y.sineOut,D$A.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&D$D.to(this,{alpha:0},500)}},D$s.stopScroll=function(){this.onStageMouseUp2(null),D$$.timer.clear(this,this.tweenMove),D$D.clearTween(this)},D$j(0,D$s,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),D$j(0,D$s,"skin",function(){return this._skin},function(D$s){this._skin!=D$s&&(this._skin=D$s,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),D$j(0,D$s,"max",function(){return this.slider.max},function(D$s){this.slider.max=D$s}),D$j(0,D$s,"showButtons",function(){return this._showButtons},function(D$s){this._showButtons=D$s,this.callLater(this.changeScrollBar)}),D$j(0,D$s,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),D$j(0,D$s,"min",function(){return this.slider.min},function(D$s){this.slider.min=D$s}),D$j(0,D$s,"value",function(){return this._value},function(D$s){D$s!==this._value&&(this._value=D$s,this._isElastic||(this.slider._value!=D$s&&(this.slider._value=D$s,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),D$j(0,D$s,"isVertical",function(){return this.slider.isVertical},function(D$s){this.slider.isVertical=D$s}),D$j(0,D$s,"sizeGrid",function(){return this.slider.sizeGrid},function(D$s){this.slider.sizeGrid=D$s}),D$j(0,D$s,"scrollSize",function(){return this._scrollSize},function(D$s){this._scrollSize=D$s}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)||"string"==typeof D$s?this.value=Number(D$s):D$$.superSet(D$i,this,"dataSource",D$s)}),D$j(0,D$s,"thumbPercent",function(){return this._thumbPercent},function(D$s){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),D$s=1<=D$s?.99:D$s,this._thumbPercent=D$s,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*D$s,D$f.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*D$s,D$f.scrollBarMinNum))}),D$j(0,D$s,"target",function(){return this._target},function(D$s){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=D$s)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),D$j(0,D$s,"hide",function(){return this._hide},function(D$s){this._hide=D$s,this.visible=!D$s}),D$j(0,D$s,"touchScrollEnable",function(){return this._touchScrollEnable},function(D$s){this._touchScrollEnable=D$s,this.target=this._target}),D$j(0,D$s,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(D$s){this._mouseWheelEnable=D$s,this.target=this._target}),D$j(0,D$s,"tick",function(){return this.slider.tick},function(D$s){this.slider.tick=D$s}),D$e}(D$i),D$C=function(D$r){function D$e(D$s){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,D$e.__super.call(this),this.skin=D$s}D$k(D$e,"laya.ui.Slider",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._bg&&this._bg.destroy(D$s),this._bar&&this._bar.destroy(D$s),this._progress&&this._progress.destroy(D$s),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},D$s.createChildren=function(){this.addChild(this._bg=new D$R),this.addChild(this._bar=new D$E)},D$s.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},D$s.onBarMouseDown=function(D$s){this._globalSacle||(this._globalSacle=new D$B),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=D$$.stage.mouseX,this._ty=D$$.stage.mouseY,D$$.stage.on("mousemove",this,this.mouseMove),D$$.stage.once("mouseup",this,this.mouseUp),D$$.stage.once("mouseout",this,this.mouseUp),this.showValueText()},D$s.showValueText=function(){if(this.showLabel){var D$s=laya.ui.Slider.label;this.addChild(D$s),D$s.textField.changeText(this._value+""),this.isVertical?(D$s.x=this._bar.x+20,D$s.y=.5*(this._bar.height-D$s.height)+this._bar.y):(D$s.y=this._bar.y-20,D$s.x=.5*(this._bar.width-D$s.width)+this._bar.x)}},D$s.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},D$s.mouseUp=function(D$s){D$$.stage.off("mousemove",this,this.mouseMove),D$$.stage.off("mouseup",this,this.mouseUp),D$$.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},D$s.mouseMove=function(D$s){var D$r=this._value;this.isVertical?(this._bar.y+=(D$$.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(D$$.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=D$$.stage.mouseX,this._ty=D$$.stage.mouseY;var D$e=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*D$e)/D$e,this._value!=D$r&&this.sendChangeEvent(),this.showValueText()},D$s.sendChangeEvent=function(D$s){void 0===D$s&&(D$s="change"),this.event(D$s),this.changeHandler&&this.changeHandler.runWith(this._value)},D$s.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},D$s.changeSize=function(){D$r.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},D$s.setSlider=function(D$s,D$r,D$e){this._value=-1,this._min=D$s,this._max=D$s<D$r?D$r:D$s,this.value=D$e<D$s?D$s:D$r<D$e?D$r:D$e},D$s.changeValue=function(){var D$s=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*D$s)/D$s,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var D$r=this._max-this._min;0===D$r&&(D$r=1),this.isVertical?(this._bar.y=(this._value-this._min)/D$r*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/D$r*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},D$s.onBgMouseDown=function(D$s){var D$r=this._bg.getMousePoint();this.isVertical?this.value=D$r.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=D$r.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},D$j(0,D$s,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),D$j(0,D$s,"skin",function(){return this._skin},function(D$s){if(this._skin!=D$s){this._skin=D$s,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var D$r=this._skin.replace(".png","$progress.png");D$b.getRes(D$r)&&(this._progress||(this.addChild(this._progress=new D$R),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=D$r),this.setBarPoint(),this.callLater(this.changeValue)}}),D$j(0,D$s,"allowClickBack",function(){return this._allowClickBack},function(D$s){this._allowClickBack!=D$s&&((this._allowClickBack=D$s)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),D$j(0,D$s,"max",function(){return this._max},function(D$s){this._max!=D$s&&(this._max=D$s,this.callLater(this.changeValue))}),D$j(0,D$s,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),D$j(0,D$s,"tick",function(){return this._tick},function(D$s){this._tick!=D$s&&(this._tick=D$s,this.callLater(this.changeValue))}),D$j(0,D$s,"sizeGrid",function(){return this._bg.sizeGrid},function(D$s){this._bg.sizeGrid=D$s,this._bar.sizeGrid=D$s,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),D$j(0,D$s,"min",function(){return this._min},function(D$s){this._min!=D$s&&(this._min=D$s,this.callLater(this.changeValue))}),D$j(0,D$s,"value",function(){return this._value},function(D$s){if(this._value!=D$s){var D$r=this._value;this._value=D$s,this.changeValue(),this._value!=D$r&&this.sendChangeEvent()}}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)||"string"==typeof D$s?this.value=Number(D$s):D$$.superSet(D$i,this,"dataSource",D$s)}),D$j(0,D$s,"bar",function(){return this._bar}),D$U(D$e,["label",function(){return this.label=new D$a}]),D$e}(D$i),D$R=function(D$r){function D$e(D$s){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,D$e.__super.call(this),this.skin=D$s}D$k(D$e,"laya.ui.Image",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,D$b.clearCache(this,this._skin)},D$s.dispose=function(){this.destroy(!0),D$b.clearCache(this,this._skin),this.clearEvent()},D$s.createChildren=function(){this.graphics=this._bitmap=new D$O},D$s.setSource=function(D$s,D$r){this.destroyed||D$s===this._skin&&D$r&&(this.source=D$r,this.onCompResize(),this.clearEvent())},D$s.clearEvent=function(){this._skin&&D$m.atalsNotify&&D$m.atalsNotify.off(this._skin,this,this.setSource)},D$s.clearLoad=function(){this._skin&&((this._complete||this._progress)&&D$$.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},D$j(0,D$s,"source",function(){return this._bitmap.source},function(D$s){this._bitmap&&(this._bitmap.source=D$s,this.event("loaded"),this.repaint())}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"string"==typeof(this._dataSource=D$s)?this.skin=D$s:D$$.superSet(D$i,this,"dataSource",D$s)}),D$j(0,D$s,"measureHeight",function(){return this._bitmap.height}),D$j(0,D$s,"skin",function(){return this._skin},function(D$s){if(this._skin!=D$s)if(D$b.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=D$s){D$b.keepCache(this,this._skin);var D$r=D$b.getRes(D$s),D$e=D$m.resAtalsObj&&D$m.resAtalsObj[this._skin];D$r?(this.source=D$r,this.onCompResize()):D$e?(D$m.atalsNotify&&D$m.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=D$e.sourceW),0==this.height&&(this.height=D$e.sourceH)):(this._complete=D$A.create(this,this.setSource,[this._skin]),this._progress=null,D$$.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),D$j(0,D$s,"group",function(){return this._group},function(D$s){D$s&&this._skin&&D$b.setGroup(this._skin,D$s),this._group=D$s}),D$j(0,D$s,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(D$s){this._bitmap.sizeGrid=D$J.fillArray(D$f.defaultSizeGrid,D$s,Number)}),D$j(0,D$s,"measureWidth",function(){return this._bitmap.width}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$i,this,"width",D$s),this._bitmap.width=0==D$s?1e-7:D$s}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$i,this,"height",D$s),this._bitmap.height=0==D$s?1e-7:D$s}),D$e}(D$i),D$a=function(D$r){function D$e(D$s){this._tf=null,D$e.__super.call(this),void 0===D$s&&(D$s=""),D$h.defaultColor=D$f.labelColor,this.text=D$s}D$k(D$e,"laya.ui.Label",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._tf=null},D$s.createChildren=function(){this.addChild(this._tf=new D$w)},D$s.changeText=function(D$s){this._tf.changeText(D$s)},D$j(0,D$s,"padding",function(){return this._tf.padding.join(",")},function(D$s){this._tf.padding=D$J.fillArray(D$f.labelPadding,D$s,Number)}),D$j(0,D$s,"bold",function(){return this._tf.bold},function(D$s){this._tf.bold=D$s}),D$j(0,D$s,"align",function(){return this._tf.align},function(D$s){this._tf.align=D$s}),D$j(0,D$s,"text",function(){return this._tf.text},function(D$s){this._tf.text!=D$s&&(D$s&&(D$s=D$J.adptString(D$s+"")),this._tf.text=D$s,this.event("change"),this._width&&this._height||this.onCompResize())}),D$j(0,D$s,"italic",function(){return this._tf.italic},function(D$s){this._tf.italic=D$s}),D$j(0,D$s,"wordWrap",function(){return this._tf.wordWrap},function(D$s){this._tf.wordWrap=D$s}),D$j(0,D$s,"font",function(){return this._tf.font},function(D$s){this._tf.font=D$s}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)||"string"==typeof D$s?this.text=D$s+"":D$$.superSet(D$i,this,"dataSource",D$s)}),D$j(0,D$s,"color",function(){return this._tf.color},function(D$s){this._tf.color=D$s}),D$j(0,D$s,"valign",function(){return this._tf.valign},function(D$s){this._tf.valign=D$s}),D$j(0,D$s,"leading",function(){return this._tf.leading},function(D$s){this._tf.leading=D$s}),D$j(0,D$s,"fontSize",function(){return this._tf.fontSize},function(D$s){this._tf.fontSize=D$s}),D$j(0,D$s,"bgColor",function(){return this._tf.bgColor},function(D$s){this._tf.bgColor=D$s}),D$j(0,D$s,"borderColor",function(){return this._tf.borderColor},function(D$s){this._tf.borderColor=D$s}),D$j(0,D$s,"stroke",function(){return this._tf.stroke},function(D$s){this._tf.stroke=D$s}),D$j(0,D$s,"strokeColor",function(){return this._tf.strokeColor},function(D$s){this._tf.strokeColor=D$s}),D$j(0,D$s,"textField",function(){return this._tf}),D$j(0,D$s,"measureWidth",function(){return this._tf.width}),D$j(0,D$s,"measureHeight",function(){return this._tf.height}),D$j(0,D$s,"width",function(){return this._width||this._tf.text?D$$.superGet(D$i,this,"width"):0},function(D$s){D$$.superSet(D$i,this,"width",D$s),this._tf.width=D$s}),D$j(0,D$s,"height",function(){return this._height||this._tf.text?D$$.superGet(D$i,this,"height"):0},function(D$s){D$$.superSet(D$i,this,"height",D$s),this._tf.height=D$s}),D$j(0,D$s,"overflow",function(){return this._tf.overflow},function(D$s){this._tf.overflow=D$s}),D$j(0,D$s,"underline",function(){return this._tf.underline},function(D$s){this._tf.underline=D$s}),D$j(0,D$s,"underlineColor",function(){return this._tf.underlineColor},function(D$s){this._tf.underlineColor=D$s}),D$e}(D$i),D$p=function(D$r){function D$e(D$s){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,D$e.__super.call(this),this.skin=D$s}D$k(D$e,"laya.ui.ProgressBar",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._bg&&this._bg.destroy(D$s),this._bar&&this._bar.destroy(D$s),this._bg=this._bar=null,this.changeHandler=null},D$s.createChildren=function(){this.addChild(this._bg=new D$R),this.addChild(this._bar=new D$R)},D$s.changeValue=function(){if(this.sizeGrid){var D$s=this.sizeGrid.split(","),D$r=Number(D$s[3]),D$e=Number(D$s[1]),D$U=(this.width-D$r-D$e)*this._value;this._bar.width=D$r+D$e+D$U,this._bar.visible=this._bar.width>D$r+D$e}else this._bar.width=this.width*this._value},D$j(0,D$s,"measureHeight",function(){return this._bg.height}),D$j(0,D$s,"skin",function(){return this._skin},function(D$s){this._skin!=D$s&&(this._skin=D$s,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),D$j(0,D$s,"measureWidth",function(){return this._bg.width}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$i,this,"height",D$s),this._bg.height=this._height,this._bar.height=this._height}),D$j(0,D$s,"bar",function(){return this._bar}),D$j(0,D$s,"value",function(){return this._value},function(D$s){this._value!=D$s&&(D$s=1<D$s?1:D$s<0?0:D$s,this._value=D$s,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(D$s))}),D$j(0,D$s,"bg",function(){return this._bg}),D$j(0,D$s,"sizeGrid",function(){return this._bg.sizeGrid},function(D$s){this._bg.sizeGrid=this._bar.sizeGrid=D$s}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$i,this,"width",D$s),this._bg.width=this._width,this.callLater(this.changeValue)}),D$j(0,D$s,"dataSource",D$r.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)||"string"==typeof D$s?this.value=Number(D$s):D$$.superSet(D$i,this,"dataSource",D$s)}),D$e}(D$i),D$N=(function(D$s){function D$e(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,D$e.__super.call(this),this._tipBox=new D$i,this._tipBox.addChild(this._tipText=new D$w),this._tipText.x=this._tipText.y=5,this._tipText.color=D$e.tipTextColor,this._defaultTipHandler=this._showDefaultTip,D$$.stage.on("showtip",this,this._onStageShowTip),D$$.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}D$k(D$e,"laya.ui.TipManager",D$i);var D$r=D$e.prototype;D$r._onStageHideTip=function(D$s){D$$.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},D$r._onStageShowTip=function(D$s){D$$.timer.once(D$e.tipDelay,this,this._showTip,[D$s],!0)},D$r._showTip=function(D$s){if("string"==typeof D$s){var D$r=String(D$s);Boolean(D$r)&&this._defaultTipHandler(D$r)}else D$s instanceof laya.utils.Handler?D$s.run():"function"==typeof D$s&&D$s.apply();D$$.stage.on("mousemove",this,this._onStageMouseMove),D$$.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},D$r._onStageMouseDown=function(D$s){this.closeAll()},D$r._onStageMouseMove=function(D$s){this._showToStage(this,D$e.offsetX,D$e.offsetY)},D$r._showToStage=function(D$s,D$r,D$e){void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0);var D$U=D$s.getBounds();D$s.x=D$$.stage.mouseX+D$r,D$s.y=D$$.stage.mouseY+D$e,D$s.x+D$U.width>D$$.stage.width&&(D$s.x-=D$U.width+D$r),D$s.y+D$U.height>D$$.stage.height&&(D$s.y-=D$U.height+D$e)},D$r.closeAll=function(){D$$.timer.clear(this,this._showTip),D$$.stage.off("mousemove",this,this._onStageMouseMove),D$$.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},D$r.showDislayTip=function(D$s){this.addChild(D$s),this._showToStage(this),D$$._currentStage.addChild(this)},D$r._showDefaultTip=function(D$s){this._tipText.text=D$s;var D$r=this._tipBox.graphics;D$r.clear(),D$r.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,D$e.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),D$$._currentStage.addChild(this)},D$j(0,D$r,"defaultTipHandler",function(){return this._defaultTipHandler},function(D$s){this._defaultTipHandler=D$s}),D$e.offsetX=10,D$e.offsetY=15,D$e.tipTextColor="#ffffff",D$e.tipBackColor="#111111",D$e.tipDelay=200}(),function(D$s){var D$x;function D$B(){this._idMap=null,this._aniList=null,this._watchMap={},D$B.__super.call(this)}D$k(D$B,"laya.ui.View",D$c);var D$r=D$B.prototype;return D$r.createView=function(D$s){if(D$s.animations&&!this._idMap&&(this._idMap={}),D$B.createComp(D$s,this,this),D$s.animations){var D$r,D$e,D$U=[],D$m=D$s.animations,D$k=0,D$j=D$m.length;for(D$k=0;D$k<D$j;D$k++){switch(D$r=new D$H,D$e=D$m[D$k],D$r._setUp(this._idMap,D$e),(this[D$e.name]=D$r)._setControlNode(this),D$e.action){case 1:D$r.play(0,!1);break;case 2:D$r.play(0,!0)}D$U.push(D$r)}this._aniList=D$U}0<this._width&&null==D$s.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},D$r.onEvent=function(D$s,D$r){},D$r.loadUI=function(D$s){var D$r=D$B.uiMap[D$s];D$r&&this.createView(D$r)},D$r.destroy=function(D$s){void 0===D$s&&(D$s=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,D$s)},D$r.changeData=function(D$s){var D$r=this._watchMap[D$s];if(D$r){console.log("change",D$s);for(var D$e=0,D$U=D$r.length;D$e<D$U;D$e++){D$r[D$e].exe(this)}}},D$B._regs=function(){for(var D$s in D$B.uiClassMap)D$l.regClass(D$s,D$B.uiClassMap[D$s])},D$B.createComp=function(D$s,D$r,D$e,D$U){if(!(D$r=D$r||D$B.getCompInstance(D$s)))return console.warn("can not create:"+D$s.type),null;var D$m=D$s.child;if(D$m)for(var D$k=D$r instanceof laya.ui.List,D$j=0,D$T=D$m.length;D$j<D$T;D$j++){var D$Y=D$m[D$j];if(!D$r.hasOwnProperty("itemRender")||"render"!=D$Y.props.name&&"render"!==D$Y.props.renderType)if("Graphic"==D$Y.type)D$l.addGraphicsToSprite(D$Y,D$r);else if(D$l.isDrawType(D$Y.type))D$l.addGraphicToSprite(D$Y,D$r,!0);else{if(D$k){var D$Z=[],D$h=D$B.createComp(D$Y,null,D$e,D$Z);D$Z.length&&(D$h._$bindData=D$Z)}else D$h=D$B.createComp(D$Y,null,D$e,D$U);"Script"==D$Y.type?"owner"in D$h?D$h.owner=D$r:"target"in D$h&&(D$h.target=D$r):"mask"==D$Y.props.renderType||"mask"==D$Y.props.name?D$r.mask=D$h:D$h instanceof laya.display.Sprite&&D$r.addChild(D$h)}else D$r.itemRender=D$Y}var D$H=D$s.props;for(var D$A in D$H){var D$x=D$H[D$A];D$B.eventDic[D$A]?D$x&&D$e&&D$r.on(D$A,D$e,D$e.onEvent,[D$x]):D$B.setCompValue(D$r,D$A,D$x,D$e,D$U)}return D$$.__typeof(D$r,"laya.ui.IItem")&&D$r.initItems(),D$s.compId&&D$e&&D$e._idMap&&(D$e._idMap[D$s.compId]=D$r),D$r},D$B.setCompValue=function(D$s,D$r,D$e,D$U,D$m){if("string"==typeof D$e&&-1<D$e.indexOf("${")){if(D$B._sheet||(D$B._sheet=D$l.getClass("laya.data.Table")),!D$B._sheet)return void console.warn("Can not find class Sheet");if(D$m)D$m.push(D$s,D$r,D$e);else if(D$U){-1==D$e.indexOf("].")&&(D$e=D$e.replace(".","[0]."));var D$k,D$j,D$T=new D$x(D$s,D$r,D$e);D$T.exe(D$U);for(var D$Y=D$e.replace(/\[.*?\]\./g,".");null!=(D$k=D$B._parseWatchData.exec(D$Y));){for(var D$Z=D$k[1];null!=(D$j=D$B._parseKeyWord.exec(D$Z));){var D$h=D$j[0],D$H=D$U._watchMap[D$h]||(D$U._watchMap[D$h]=[]);D$H.push(D$T),D$B._sheet.I.notifer.on(D$h,D$U,D$U.changeData,[D$h])}(D$H=D$U._watchMap[D$Z]||(D$U._watchMap[D$Z]=[])).push(D$T),D$B._sheet.I.notifer.on(D$Z,D$U,D$U.changeData,[D$Z])}}}else if("var"===D$r&&D$U)D$U[D$e]=D$s;else if("onClick"==D$r){var D$A=D$$._runScript("(function(){"+D$e+"})");D$s.on("click",D$U,D$A)}else D$s[D$r]="true"===D$e||"false"!==D$e&&D$e},D$B.getCompInstance=function(D$s){var D$r,D$e=D$s.props?D$s.props.runtime:null;return D$r=D$e?D$B.viewClassMap[D$e]||D$B.uiClassMap[D$e]||D$$.__classmap[D$e]:D$B.uiClassMap[D$s.type],D$s.props&&D$s.props.hasOwnProperty("renderType")&&"instance"==D$s.props.renderType?D$r.instance:D$r?new D$r:null},D$B.regComponent=function(D$s,D$r){D$B.uiClassMap[D$s]=D$r,D$l.regClass(D$s,D$r)},D$B.regViewRuntime=function(D$s,D$r){D$B.viewClassMap[D$s]=D$r},D$B.uiMap={},D$B.viewClassMap={},D$B._sheet=null,D$U(D$B,["uiClassMap",function(){return this.uiClassMap={ViewStack:D$ss,LinkButton:D$E,TextArea:D$Zs,ColorPicker:D$S,Box:D$c,Button:D$E,CheckBox:D$q,Clip:D$v,ComboBox:D$z,Component:D$i,HScrollBar:D$W,HSlider:D$u,Image:D$R,Label:D$a,List:D$t,Panel:D$L,ProgressBar:D$p,Radio:D$_,RadioGroup:D$Ts,ScrollBar:D$Q,Slider:D$C,Tab:D$Ys,TextInput:D$es,View:D$B,VScrollBar:D$rs,VSlider:D$Us,Tree:D$F,HBox:D$ks,VBox:D$js,Sprite:D$I,Animation:D$e,Text:D$w,FontClip:D$d}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),D$B.__init$=function(){D$B._regs(),D$x=function(){function D$s(D$s,D$r,D$e){this.comp=null,this.prop=null,this.value=null,this.comp=D$s,this.prop=D$r,this.value=D$e}return D$k(D$s,""),D$s.prototype.exe=function(D$s){var D$r=D$J.getBindFun(this.value);this.comp[this.prop]=D$r.call(this,D$s)},D$s}()},D$B}()),D$q=function(D$s){function D$e(D$s,D$r){void 0===D$r&&(D$r=""),D$e.__super.call(this,D$s,D$r)}D$k(D$e,"laya.ui.CheckBox",D$s);var D$r=D$e.prototype;return D$r.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},D$r.initialize=function(){D$s.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},D$j(0,D$r,"dataSource",D$s.prototype._$get_dataSource,function(D$s){"boolean"==typeof(this._dataSource=D$s)?this.selected=D$s:"string"==typeof D$s?this.selected="true"===D$s:D$$.superSet(D$E,this,"dataSource",D$s)}),D$e}(D$E),D$G=function(D$s){function D$r(){this._space=0,this._align="none",this._itemChanged=!1,D$r.__super.call(this)}D$k(D$r,"laya.ui.LayoutBox",D$c);var D$e=D$r.prototype;return D$e.addChild=function(D$s){return D$s.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,D$s)},D$e.onResize=function(D$s){this._setItemChanged()},D$e.addChildAt=function(D$s,D$r){return D$s.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,D$s,D$r)},D$e.removeChild=function(D$s){return D$s.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,D$s)},D$e.removeChildAt=function(D$s){return this.getChildAt(D$s).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,D$s)},D$e.refresh=function(){this._setItemChanged()},D$e.changeItems=function(){this._itemChanged=!1},D$e.sortItem=function(D$s){D$s&&D$s.sort(function(D$s,D$r){return D$s.y-D$r.y})},D$e._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},D$j(0,D$e,"space",function(){return this._space},function(D$s){this._space=D$s,this._setItemChanged()}),D$j(0,D$e,"align",function(){return this._align},function(D$s){this._align=D$s,this._setItemChanged()}),D$r}(),D$d=function(D$r){function D$e(D$s,D$r){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,D$e.__super.call(this),D$s&&(this.skin=D$s),D$r&&(this.sheet=D$r)}D$k(D$e,"laya.ui.FontClip",D$r);var D$s=D$e.prototype;return D$s.createChildren=function(){this._bitmap=new D$O,this.on("loaded",this,this._onClipLoaded)},D$s._onClipLoaded=function(){this.callLater(this.changeValue)},D$s.changeValue=function(){var D$s;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),D$s=this._sources[0]))){var D$r="horizontal"===this._direction;D$r?(this._wordsW=this._valueArr.length*(D$s.sourceWidth+this.spaceX),this._wordsH=D$s.sourceHeight):(this._wordsW=D$s.sourceWidth,this._wordsH=(D$s.sourceHeight+this.spaceY)*this._valueArr.length);var D$e=0;if(this._width)switch(this._align){case"center":D$e=.5*(this._width-this._wordsW);break;case"right":D$e=this._width-this._wordsW;break;default:D$e=0}for(var D$U=0,D$m=this._valueArr.length;D$U<D$m;D$U++){var D$k=this._indexMap[this._valueArr.charAt(D$U)];this.sources[D$k]&&(D$s=this.sources[D$k],D$r?this.graphics.drawTexture(D$s,D$e+D$U*(D$s.sourceWidth+this.spaceX),0,D$s.sourceWidth,D$s.sourceHeight):this.graphics.drawTexture(D$s,0+D$e,D$U*(D$s.sourceHeight+this.spaceY),D$s.sourceWidth,D$s.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),D$r.prototype.destroy.call(this,D$s)},D$j(0,D$s,"sheet",function(){return this._sheet},function(D$s){D$s+="";var D$r=(this._sheet=D$s).split(" ");this._clipX=String(D$r[0]).length,this.clipY=D$r.length,this._indexMap={};for(var D$e=0;D$e<this._clipY;D$e++)for(var D$U=D$r[D$e].split(""),D$m=0,D$k=D$U.length;D$m<D$k;D$m++)this._indexMap[D$U[D$m]]=D$e*this._clipX+D$m}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$v,this,"height",D$s),this.callLater(this.changeValue)}),D$j(0,D$s,"direction",function(){return this._direction},function(D$s){this._direction=D$s,this.callLater(this.changeValue)}),D$j(0,D$s,"value",function(){return this._valueArr?this._valueArr:""},function(D$s){D$s+="",this._valueArr=D$s,this.callLater(this.changeValue)}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$v,this,"width",D$s),this.callLater(this.changeValue)}),D$j(0,D$s,"spaceX",function(){return this._spaceX},function(D$s){this._spaceX=D$s,"horizontal"===this._direction&&this.callLater(this.changeValue)}),D$j(0,D$s,"spaceY",function(){return this._spaceY},function(D$s){this._spaceY=D$s,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),D$j(0,D$s,"align",function(){return this._align},function(D$s){this._align=D$s,this.callLater(this.changeValue)}),D$j(0,D$s,"measureWidth",function(){return this._wordsW}),D$j(0,D$s,"measureHeight",function(){return this._wordsH}),D$e}(D$v),D$t=function(D$s){function D$r(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new D$B,D$r.__super.call(this)}D$k(D$r,"laya.ui.List",D$s);var D$e=D$r.prototype;return D$$.imps(D$e,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),D$e.destroy=function(D$s){void 0===D$s&&(D$s=!0),this._content&&this._content.destroy(D$s),this._scrollBar&&this._scrollBar.destroy(D$s),laya.ui.Component.prototype.destroy.call(this,D$s),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},D$e.createChildren=function(){this.addChild(this._content=new D$c)},D$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=D$$.superGet(D$c,this,"cacheAs")),D$$.superSet(D$c,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},D$e.onScrollEnd=function(){D$$.superSet(D$c,this,"cacheAs",this._$P.cacheAs)},D$e._removePreScrollBar=function(){var D$s=this.removeChildByName("scrollBar");D$s&&D$s.destroy(!0)},D$e.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var D$s=this._getOneCell(),D$r=D$s.width+this._spaceX||1,D$e=D$s.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/D$r):Math.ceil(this._width/D$r)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/D$e):Math.round(this._height/D$e));var D$U=this._width?this._width:D$r*this.repeatX-this._spaceX,D$m=this._height?this._height:D$e*this.repeatY-this._spaceY;this._cellSize=this._isVertical?D$e:D$r,this._cellOffset=this._isVertical?D$e*Math.max(this._repeatY2,this._repeatY)-D$m-this._spaceY:D$r*Math.max(this._repeatX2,this._repeatX)-D$U-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=D$m:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=D$U),this.setContentSize(D$U,D$m);var D$k=this._isVertical?this.repeatX:this.repeatY,D$j=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,D$k,D$j),this._createdLine=D$j,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},D$e._getOneCell=function(){if(0===this._cells.length){var D$s=this.createItem();if(this._offset.setTo(D$s.x,D$s.y),this.cacheContent)return D$s;this._cells.push(D$s)}return this._cells[0]},D$e._createItems=function(D$s,D$r,D$e){var D$U=this._content,D$m=this._getOneCell(),D$k=D$m.width+this._spaceX,D$j=D$m.height+this._spaceY;if(this.cacheContent){var D$T=new D$c;D$T.cacheAsBitmap=!0,D$T.pos((this._isVertical?0:D$s)*D$k,(this._isVertical?D$s:0)*D$j),this._content.addChild(D$T),this._content.optimizeScrollRect=!0,D$U=D$T}else{for(var D$Y=[],D$Z=this._cells.length-1;-1<D$Z;D$Z--){var D$h=this._cells[D$Z];D$h.removeSelf(),D$Y.push(D$h)}this._cells.length=0}for(var D$H=D$s;D$H<D$e;D$H++)for(var D$A=0;D$A<D$r;D$A++)(D$m=D$Y&&D$Y.length?D$Y.pop():this.createItem()).x=(this._isVertical?D$A:D$H)*D$k-D$U.x,D$m.y=(this._isVertical?D$H:D$A)*D$j-D$U.y,D$m.name="item"+(D$H*D$r+D$A),D$U.addChild(D$m),this.addCell(D$m)},D$e.createItem=function(){var D$s=[];if("function"==typeof this._itemRender)var D$r=new this._itemRender;else D$r=D$N.createComp(this._itemRender,null,null,D$s);if(0==D$s.length&&D$r._watchMap){var D$e=D$r._watchMap;for(var D$U in D$e)for(var D$m=D$e[D$U],D$k=0;D$k<D$m.length;D$k++){var D$j=D$m[D$k];D$s.push(D$j.comp,D$j.prop,D$j.value)}}return D$s.length&&(D$r._$bindData=D$s),D$r},D$e.addCell=function(D$s){D$s.on("click",this,this.onCellMouse),D$s.on("rightclick",this,this.onCellMouse),D$s.on("mouseover",this,this.onCellMouse),D$s.on("mouseout",this,this.onCellMouse),D$s.on("mousedown",this,this.onCellMouse),D$s.on("mouseup",this,this.onCellMouse),this._cells.push(D$s)},D$e.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var D$s=0,D$r=D$s=0;D$r<1e4;D$r++){var D$e=this.getChildByName("item"+D$r);if(!D$e)break;this.addCell(D$e),D$s++}this.repeatY=D$s}},D$e.setContentSize=function(D$s,D$r){this._content.width=D$s,this._content.height=D$r,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new D$V),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,D$s,D$r),this._content.scrollRect=this._content.scrollRect),this.event("resize")},D$e.onCellMouse=function(D$s){"mousedown"===D$s.type&&(this._isMoved=!1);var D$r=D$s.currentTarget,D$e=this._startIndex+this._cells.indexOf(D$r);D$e<0||("click"===D$s.type||"rightclick"===D$s.type?this.selectEnable&&!this._isMoved?this.selectedIndex=D$e:this.changeCellState(D$r,!0,0):"mouseover"!==D$s.type&&"mouseout"!==D$s.type||this._selectedIndex===D$e||this.changeCellState(D$r,"mouseover"===D$s.type,0),this.mouseHandler&&this.mouseHandler.runWith([D$s,D$e]))},D$e.changeCellState=function(D$s,D$r,D$e){var D$U=D$s.getChildByName("selectBox");D$U&&(this.selectEnable=!0,D$U.visible=D$r,D$U.index=D$e)},D$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},D$e.onScrollBarChange=function(D$s){this.runCallLater(this.changeCells);var D$r=this._scrollBar.value,D$e=this._isVertical?this.repeatX:this.repeatY,D$U=this._isVertical?this.repeatY:this.repeatX,D$m=Math.floor(D$r/this._cellSize);if(this.cacheContent)D$j=D$U+1,this._createdLine-D$m<D$j&&(this._createItems(this._createdLine,D$e,this._createdLine+D$j),this.renderItems(this._createdLine*D$e,0),this._createdLine+=D$j);else{var D$k=D$m*D$e,D$j=0;if(D$k>this._startIndex){D$j=D$k-this._startIndex;var D$T=!0,D$Y=this._startIndex+D$e*(D$U+1);this._isMoved=!0}else D$k<this._startIndex&&(D$j=this._startIndex-D$k,D$T=!1,D$Y=this._startIndex-1,this._isMoved=!0);for(var D$Z=0;D$Z<D$j;D$Z++){if(D$T){var D$h=this._cells.shift();this._cells[this._cells.length]=D$h;var D$H=D$Y+D$Z}else D$h=this._cells.pop(),this._cells.unshift(D$h),D$H=D$Y-D$Z;var D$A=Math.floor(D$H/D$e)*this._cellSize;this._isVertical?D$h.y=D$A:D$h.x=D$A,this.renderItem(D$h,D$H)}this._startIndex=D$k,this.changeSelectStatus()}var D$x=this._content.scrollRect;this._isVertical?(D$x.y=D$r-this._offset.y,D$x.x=-this._offset.x):(D$x.y=-this._offset.y,D$x.x=D$r-this._offset.x),this._content.scrollRect=D$x},D$e.posCell=function(D$s,D$r){if(this._scrollBar){var D$e=this._isVertical?this.repeatX:this.repeatY,D$U=(this._isVertical?this.repeatY:this.repeatX,Math.floor(D$r/D$e)*this._cellSize);this._isVertical?D$s.y=D$U:D$s.x=D$U}},D$e.changeSelectStatus=function(){for(var D$s=0,D$r=this._cells.length;D$s<D$r;D$s++)this.changeCellState(this._cells[D$s],this._selectedIndex===this._startIndex+D$s,1)},D$e.renderItems=function(D$s,D$r){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0);for(var D$e=D$s,D$U=D$r||this._cells.length;D$e<D$U;D$e++)this.renderItem(this._cells[D$e],this._startIndex+D$e);this.changeSelectStatus(),this._twDone=!0},D$e.renderItem=function(D$s,D$r){this._array&&0<=D$r&&D$r<this._array.length?(D$s.visible=!0,D$s._$bindData?(D$s._dataSource=this._array[D$r],this._bindData(D$s,this._array[D$r])):D$s.dataSource=this._array[D$r],this.cacheContent||this.posCell(D$s,D$r),this.hasListener("render")&&this.event("render",[D$s,D$r]),this.renderHandler&&this.renderHandler.runWith([D$s,D$r]),this.renderTwHandler&&this.renderTwHandler.runWith([D$s,D$r])):(D$s.visible=!1,D$s.dataSource=null)},D$e._bindData=function(D$s,D$r){for(var D$e=D$s._$bindData,D$U=0,D$m=D$e.length;D$U<D$m;D$U++){var D$k=D$e[D$U++],D$j=D$e[D$U++],D$T=D$e[D$U],D$Y=D$J.getBindFun(D$T);D$k[D$j]=D$Y.call(this,D$r)}},D$e.refresh=function(){this.array=this._array},D$e.getItem=function(D$s){return-1<D$s&&D$s<this._array.length?this._array[D$s]:null},D$e.changeItem=function(D$s,D$r){-1<D$s&&D$s<this._array.length&&(this._array[D$s]=D$r,D$s>=this._startIndex&&D$s<this._startIndex+this._cells.length&&this.renderItem(this.getCell(D$s),D$s))},D$e.setItem=function(D$s,D$r){this.changeItem(D$s,D$r)},D$e.addItem=function(D$s){this._array.push(D$s),this.array=this._array},D$e.addItemAt=function(D$s,D$r){this._array.splice(D$r,0,D$s),this.array=this._array},D$e.deleteItem=function(D$s){this._array.splice(D$s,1),this.array=this._array},D$e.getCell=function(D$s){return this.runCallLater(this.changeCells),-1<D$s&&this._cells?this._cells[(D$s-this._startIndex)%this._cells.length]:null},D$e.scrollTo=function(D$s){if(this._scrollBar){var D$r=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(D$s/D$r)*this._cellSize}else this.startIndex=D$s},D$e.tweenTo=function(D$s,D$r,D$e){if(void 0===D$r&&(D$r=200),this._scrollBar){var D$U=this._isVertical?this.repeatX:this.repeatY;D$D.to(this._scrollBar,{value:Math.floor(D$s/D$U)*this._cellSize},D$r,null,D$e,0,!0)}else this.startIndex=D$s,D$e&&D$e.run()},D$e._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},D$e.commitMeasure=function(){this.runCallLater(this.changeCells)},D$j(0,D$e,"cacheAs",D$s.prototype._$get_cacheAs,function(D$s){D$$.superSet(D$c,this,"cacheAs",D$s),this._scrollBar&&(this._$P.cacheAs=null,"none"!==D$s?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),D$j(0,D$e,"content",function(){return this._content}),D$j(0,D$e,"height",D$s.prototype._$get_height,function(D$s){D$s!=this._height&&(D$$.superSet(D$c,this,"height",D$s),this._setCellChanged())}),D$j(0,D$e,"itemRender",function(){return this._itemRender},function(D$s){if(this._itemRender!=D$s){this._itemRender=D$s;for(var D$r=this._cells.length-1;-1<D$r;D$r--)this._cells[D$r].destroy();this._cells.length=0,this._setCellChanged()}}),D$j(0,D$e,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(D$s){this._removePreScrollBar();var D$r=new D$rs;D$r.name="scrollBar",D$r.right=0,D$s&&" "!=D$s&&(D$r.skin=D$s),this.scrollBar=D$r,this.addChild(D$r),this._setCellChanged()}),D$j(0,D$e,"page",function(){return this._page},function(D$s){this._page=D$s,this._array&&(this._page=0<D$s?D$s:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),D$j(0,D$e,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(D$s){this._removePreScrollBar();var D$r=new D$W;D$r.name="scrollBar",D$r.bottom=0,D$s&&" "!=D$s&&(D$r.skin=D$s),this.scrollBar=D$r,this.addChild(D$r),this._setCellChanged()}),D$j(0,D$e,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(D$s){this._repeatX=D$s,this._setCellChanged()}),D$j(0,D$e,"scrollBar",function(){return this._scrollBar},function(D$s){this._scrollBar!=D$s&&(this._scrollBar=D$s)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),D$j(0,D$e,"width",D$s.prototype._$get_width,function(D$s){D$s!=this._width&&(D$$.superSet(D$c,this,"width",D$s),this._setCellChanged())}),D$j(0,D$e,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(D$s){this._repeatY=D$s,this._setCellChanged()}),D$j(0,D$e,"spaceX",function(){return this._spaceX},function(D$s){this._spaceX=D$s,this._setCellChanged()}),D$j(0,D$e,"spaceY",function(){return this._spaceY},function(D$s){this._spaceY=D$s,this._setCellChanged()}),D$j(0,D$e,"selectedIndex",function(){return this._selectedIndex},function(D$s){this._selectedIndex!=D$s&&(this._selectedIndex=D$s,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(D$s),this.startIndex=this._startIndex)}),D$j(0,D$e,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(D$s){this.selectedIndex=this._array.indexOf(D$s)}),D$j(0,D$e,"length",function(){return this._array?this._array.length:0}),D$j(0,D$e,"selection",function(){return this.getCell(this._selectedIndex)},function(D$s){this.selectedIndex=this._startIndex+this._cells.indexOf(D$s)}),D$j(0,D$e,"startIndex",function(){return this._startIndex},function(D$s){this._startIndex=0<D$s?D$s:0,this.callLater(this.renderItems)}),D$j(0,D$e,"twSwitch",function(){return this._twSwitch},function(D$s){this._twSwitch=D$s}),D$j(0,D$e,"twDone",function(){return this._twDone},function(D$s){this._twDone=D$s}),D$j(0,D$e,"array",function(){return this._array},function(D$s){this.runCallLater(this.changeCells),this._array=D$s||[];var D$r=this._array.length;if(this.totalPage=Math.ceil(D$r/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<D$r?this._selectedIndex:D$r-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var D$e=this._isVertical?this.repeatX:this.repeatY,D$U=this._isVertical?this.repeatY:this.repeatX,D$m=Math.ceil(D$r/D$e);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=D$U/D$m,this._scrollBar.setScroll(0,(D$m-D$U)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),D$j(0,D$e,"dataSource",D$s.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)&&Math.floor(D$s)==D$s||"string"==typeof D$s?this.selectedIndex=parseInt(D$s):D$s instanceof Array?this.array=D$s:D$$.superSet(D$c,this,"dataSource",D$s)}),D$j(0,D$e,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),D$r}(D$c),D$W=function(D$s){function D$r(){D$r.__super.call(this)}return D$k(D$r,"laya.ui.HScrollBar",D$s),D$r.prototype.initialize=function(){D$s.prototype.initialize.call(this),this.slider.isVertical=!1},D$r}(D$Q),D$L=function(D$s){function D$r(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,D$r.__super.call(this),this.width=this.height=100}D$k(D$r,"laya.ui.Panel",D$s);var D$e=D$r.prototype;return D$e.destroy=function(D$s){void 0===D$s&&(D$s=!0),laya.ui.Component.prototype.destroy.call(this,D$s),this._content&&this._content.destroy(D$s),this._vScrollBar&&this._vScrollBar.destroy(D$s),this._hScrollBar&&this._hScrollBar.destroy(D$s),this._vScrollBar=null,this._hScrollBar=null,this._content=null},D$e.destroyChildren=function(){this._content.destroyChildren()},D$e.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new D$c)},D$e.addChild=function(D$s){return D$s.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(D$s)},D$e.onResize=function(){this._setScrollChanged()},D$e.addChildAt=function(D$s,D$r){return D$s.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(D$s,D$r)},D$e.removeChild=function(D$s){return D$s.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(D$s)},D$e.removeChildAt=function(D$s){return this.getChildAt(D$s).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(D$s)},D$e.removeChildren=function(D$s,D$r){return void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=2147483647),this._content.removeChildren(D$s,D$r),this._setScrollChanged(),this},D$e.getChildAt=function(D$s){return this._content.getChildAt(D$s)},D$e.getChildByName=function(D$s){return this._content.getChildByName(D$s)},D$e.getChildIndex=function(D$s){return this._content.getChildIndex(D$s)},D$e.changeScroll=function(){this._scrollChanged=!1;var D$s=this.contentWidth||1,D$r=this.contentHeight||1,D$e=this._vScrollBar,D$U=this._hScrollBar,D$m=D$e&&D$r>this._height,D$k=D$U&&D$s>this._width,D$j=D$m?this._width-D$e.width:this._width,D$T=D$k?this._height-D$U.height:this._height;D$e&&(D$e.x=this._width-D$e.width,D$e.y=0,D$e.height=this._height-(D$k?D$U.height:0),D$e.scrollSize=Math.max(.033*this._height,1),D$e.thumbPercent=D$T/D$r,D$e.setScroll(0,D$r-D$T,D$e.value)),D$U&&(D$U.x=0,D$U.y=this._height-D$U.height,D$U.width=this._width-(D$m?D$e.width:0),D$U.scrollSize=Math.max(.033*this._width,1),D$U.thumbPercent=D$j/D$s,D$U.setScroll(0,D$s-D$j,D$U.value))},D$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},D$e.setContentSize=function(D$s,D$r){var D$e=this._content;D$e.width=D$s,D$e.height=D$r,D$e.scrollRect||(D$e.scrollRect=new D$V),D$e.scrollRect.setTo(0,0,D$s,D$r),D$e.scrollRect=D$e.scrollRect},D$e.onScrollBarChange=function(D$s){var D$r=this._content.scrollRect;if(D$r){var D$e=Math.round(D$s.value);D$s.isVertical?D$r.y=D$e:D$r.x=D$e,this._content.scrollRect=D$r}},D$e.scrollTo=function(D$s,D$r){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),this.vScrollBar&&(this.vScrollBar.value=D$r),this.hScrollBar&&(this.hScrollBar.value=D$s)},D$e.refresh=function(){this.changeScroll()},D$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=D$$.superGet(D$c,this,"cacheAs")),D$$.superSet(D$c,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},D$e.onScrollEnd=function(){D$$.superSet(D$c,this,"cacheAs",this._$P.cacheAs)},D$e._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},D$j(0,D$e,"numChildren",function(){return this._content.numChildren}),D$j(0,D$e,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(D$s){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new D$W),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=D$s}),D$j(0,D$e,"contentWidth",function(){for(var D$s=0,D$r=this._content.numChildren-1;-1<D$r;D$r--){var D$e=this._content.getChildAt(D$r);D$s=Math.max(D$e.x+D$e.width*D$e.scaleX,D$s)}return D$s}),D$j(0,D$e,"contentHeight",function(){for(var D$s=0,D$r=this._content.numChildren-1;-1<D$r;D$r--){var D$e=this._content.getChildAt(D$r);D$s=Math.max(D$e.y+D$e.height*D$e.scaleY,D$s)}return D$s}),D$j(0,D$e,"width",D$s.prototype._$get_width,function(D$s){D$$.superSet(D$c,this,"width",D$s),this._setScrollChanged()}),D$j(0,D$e,"hScrollBar",function(){return this._hScrollBar}),D$j(0,D$e,"content",function(){return this._content}),D$j(0,D$e,"height",D$s.prototype._$get_height,function(D$s){D$$.superSet(D$c,this,"height",D$s),this._setScrollChanged()}),D$j(0,D$e,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(D$s){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new D$rs),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=D$s}),D$j(0,D$e,"vScrollBar",function(){return this._vScrollBar}),D$j(0,D$e,"cacheAs",D$s.prototype._$get_cacheAs,function(D$s){D$$.superSet(D$c,this,"cacheAs",D$s),this._$P.cacheAs=null,"none"!==D$s?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),D$r}(D$c),D$u=function(D$s){function D$r(D$s){D$r.__super.call(this,D$s),this.isVertical=!1}return D$k(D$r,"laya.ui.HSlider",D$C),D$r}(),D$M=function(D$s){function D$e(D$s,D$r){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,D$e.__super.call(this),this.skin=D$r,this.labels=D$s}D$k(D$e,"laya.ui.UIGroup",D$s);var D$r=D$e.prototype;return D$$.imps(D$r,{"laya.ui.IItem":!0}),D$r.preinitialize=function(){this.mouseEnabled=!0},D$r.destroy=function(D$s){void 0===D$s&&(D$s=!0),laya.ui.Component.prototype.destroy.call(this,D$s),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},D$r.addItem=function(D$s,D$r){void 0===D$r&&(D$r=!0);var D$e=D$s,D$U=this._items.length;if(D$e.name="item"+D$U,this.addChild(D$e),this.initItems(),D$r&&0<D$U){var D$m=this._items[D$U-1];"horizontal"==this._direction?D$e.x=D$m.x+D$m.width+this._space:D$e.y=D$m.y+D$m.height+this._space}else D$r&&(D$e.x=0,D$e.y=0);return D$U},D$r.delItem=function(D$s,D$r){void 0===D$r&&(D$r=!0);var D$e=this._items.indexOf(D$s);if(-1!=D$e){var D$U=D$s;this.removeChild(D$U);for(var D$m=D$e+1,D$k=this._items.length;D$m<D$k;D$m++){var D$j=this._items[D$m];D$j.name="item"+(D$m-1),D$r&&("horizontal"==this._direction?D$j.x-=D$U.width+this._space:D$j.y-=D$U.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var D$T;D$T=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=D$T}}},D$r.initItems=function(){this._items||(this._items=[]);for(var D$s=this._items.length=0;D$s<1e4;D$s++){var D$r=this.getChildByName("item"+D$s);if(null==D$r)break;this._items.push(D$r),D$r.selected=D$s===this._selectedIndex,D$r.clickHandler=D$A.create(this,this.itemClick,[D$s],!1)}},D$r.itemClick=function(D$s){this.selectedIndex=D$s},D$r.setSelect=function(D$s,D$r){this._items&&-1<D$s&&D$s<this._items.length&&(this._items[D$s].selected=D$r)},D$r.createItem=function(D$s,D$r){return null},D$r.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var D$s=0,D$r=0,D$e=this._items.length;D$r<D$e;D$r++){var D$U=this._items[D$r];this._skin&&(D$U.skin=this._skin),this._labelColors&&(D$U.labelColors=this._labelColors),this._labelSize&&(D$U.labelSize=this._labelSize),this._labelStroke&&(D$U.labelStroke=this._labelStroke),this._labelStrokeColor&&(D$U.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(D$U.strokeColors=this._strokeColors),this._labelBold&&(D$U.labelBold=this._labelBold),this._labelPadding&&(D$U.labelPadding=this._labelPadding),this._labelAlign&&(D$U.labelAlign=this._labelAlign),this._stateNum&&(D$U.stateNum=this._stateNum),this._labelFont&&(D$U.labelFont=this._labelFont),"horizontal"===this._direction?(D$U.y=0,D$U.x=D$s,D$s+=D$U.width+this._space):(D$U.x=0,D$U.y=D$s,D$s+=D$U.height+this._space)}this.changeSize()},D$r.commitMeasure=function(){this.runCallLater(this.changeLabels)},D$r._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},D$j(0,D$r,"labelStrokeColor",function(){return this._labelStrokeColor},function(D$s){this._labelStrokeColor!=D$s&&(this._labelStrokeColor=D$s,this._setLabelChanged())}),D$j(0,D$r,"skin",function(){return this._skin},function(D$s){this._skin!=D$s&&(this._skin=D$s,this._setLabelChanged())}),D$j(0,D$r,"selectedIndex",function(){return this._selectedIndex},function(D$s){this._selectedIndex!=D$s&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=D$s,this.setSelect(D$s,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),D$j(0,D$r,"labels",function(){return this._labels},function(D$s){if(this._labels!=D$s){if(this._labels=D$s,this.removeChildren(),this._setLabelChanged(),this._labels)for(var D$r=this._labels.split(","),D$e=0,D$U=D$r.length;D$e<D$U;D$e++){var D$m=this.createItem(this._skin,D$r[D$e]);D$m.name="item"+D$e,this.addChild(D$m)}this.initItems()}}),D$j(0,D$r,"strokeColors",function(){return this._strokeColors},function(D$s){this._strokeColors!=D$s&&(this._strokeColors=D$s,this._setLabelChanged())}),D$j(0,D$r,"labelColors",function(){return this._labelColors},function(D$s){this._labelColors!=D$s&&(this._labelColors=D$s,this._setLabelChanged())}),D$j(0,D$r,"labelStroke",function(){return this._labelStroke},function(D$s){this._labelStroke!=D$s&&(this._labelStroke=D$s,this._setLabelChanged())}),D$j(0,D$r,"labelSize",function(){return this._labelSize},function(D$s){this._labelSize!=D$s&&(this._labelSize=D$s,this._setLabelChanged())}),D$j(0,D$r,"stateNum",function(){return this._stateNum},function(D$s){this._stateNum!=D$s&&(this._stateNum=D$s,this._setLabelChanged())}),D$j(0,D$r,"labelBold",function(){return this._labelBold},function(D$s){this._labelBold!=D$s&&(this._labelBold=D$s,this._setLabelChanged())}),D$j(0,D$r,"labelFont",function(){return this._labelFont},function(D$s){this._labelFont!=D$s&&(this._labelFont=D$s,this._setLabelChanged())}),D$j(0,D$r,"labelPadding",function(){return this._labelPadding},function(D$s){this._labelPadding!=D$s&&(this._labelPadding=D$s,this._setLabelChanged())}),D$j(0,D$r,"direction",function(){return this._direction},function(D$s){this._direction=D$s,this._setLabelChanged()}),D$j(0,D$r,"space",function(){return this._space},function(D$s){this._space=D$s,this._setLabelChanged()}),D$j(0,D$r,"items",function(){return this._items}),D$j(0,D$r,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(D$s){this.selectedIndex=this._items.indexOf(D$s)}),D$j(0,D$r,"dataSource",D$s.prototype._$get_dataSource,function(D$s){"number"==typeof(this._dataSource=D$s)&&Math.floor(D$s)==D$s||"string"==typeof D$s?this.selectedIndex=parseInt(D$s):D$s instanceof Array?this.labels=D$s.join(","):D$$.superSet(D$c,this,"dataSource",D$s)}),D$e}(D$c),D$_=function(D$r){function D$e(D$s,D$r){this._value=null,void 0===D$r&&(D$r=""),D$e.__super.call(this,D$s,D$r)}D$k(D$e,"laya.ui.Radio",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._value=null},D$s.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},D$s.initialize=function(){D$r.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},D$s.onClick=function(D$s){this.selected=!0},D$j(0,D$s,"value",function(){return null!=this._value?this._value:this.label},function(D$s){this._value=D$s}),D$e}(D$E),D$F=function(D$s){function D$r(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,D$r.__super.call(this),this.width=this.height=200}D$k(D$r,"laya.ui.Tree",D$s);var D$e=D$r.prototype;return D$$.imps(D$e,{"laya.ui.IRender":!0}),D$e.destroy=function(D$s){void 0===D$s&&(D$s=!0),laya.ui.Component.prototype.destroy.call(this,D$s),this._list&&this._list.destroy(D$s),this._list=null,this._source=null,this._renderHandler=null},D$e.createChildren=function(){this.addChild(this._list=new D$t),this._list.renderHandler=D$A.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},D$e.onListChange=function(D$s){this.event("change")},D$e.getArray=function(){var D$s,D$r=[];for(var D$e in this._source)D$s=this._source[D$e],this.getParentOpenStatus(D$s)&&(D$s.x=this._spaceLeft*this.getDepth(D$s),D$r.push(D$s));return D$r},D$e.getDepth=function(D$s,D$r){return void 0===D$r&&(D$r=0),null==D$s.nodeParent?D$r:this.getDepth(D$s.nodeParent,D$r+1)},D$e.getParentOpenStatus=function(D$s){var D$r=D$s.nodeParent;return null==D$r||!!D$r.isOpen&&(null==D$r.nodeParent||this.getParentOpenStatus(D$r))},D$e.renderItem=function(D$s,D$r){var D$e=D$s.dataSource;if(D$e){D$s.left=D$e.x;var D$U=D$s.getChildByName("arrow");D$U&&(D$e.hasChild?(D$U.visible=!0,D$U.index=D$e.isOpen?1:0,D$U.tag=D$r,D$U.off("click",this,this.onArrowClick),D$U.on("click",this,this.onArrowClick)):D$U.visible=!1);var D$m=D$s.getChildByName("folder");D$m&&(2==D$m.clipY?D$m.index=D$e.isDirectory?0:1:D$m.index=D$e.isDirectory?D$e.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([D$s,D$r])}},D$e.onArrowClick=function(D$s){var D$r=D$s.currentTarget.tag;this._list.array[D$r].isOpen=!this._list.array[D$r].isOpen,this.event("open"),this._list.array=this.getArray()},D$e.setItemState=function(D$s,D$r){this._list.array[D$s]&&(this._list.array[D$s].isOpen=D$r,this._list.array=this.getArray())},D$e.fresh=function(){this._list.array=this.getArray(),this.repaint()},D$e.parseXml=function(D$s,D$r,D$e,D$U){var D$m,D$k=D$s.childNodes,D$j=D$k.length;if(!D$U){D$m={};var D$T,D$Y=D$s.attributes;for(var D$Z in D$Y){var D$h=(D$T=D$Y[D$Z]).nodeName,D$H=D$T.nodeValue;D$m[D$h]="true"==D$H||"false"!=D$H&&D$H}D$m.nodeParent=D$e,0<D$j&&(D$m.isDirectory=!0),D$m.hasChild=0<D$j,D$r.push(D$m)}for(var D$A=0;D$A<D$j;D$A++){var D$x=D$k[D$A];this.parseXml(D$x,D$r,D$m,!1)}},D$e.parseOpenStatus=function(D$s,D$r){for(var D$e=0,D$U=D$r.length;D$e<D$U;D$e++){var D$m=D$r[D$e];if(D$m.isDirectory)for(var D$k=0,D$j=D$s.length;D$k<D$j;D$k++){var D$T=D$s[D$k];if(D$T.isDirectory&&this.isSameParent(D$T,D$m)&&D$m.label==D$T.label){D$m.isOpen=D$T.isOpen;break}}}},D$e.isSameParent=function(D$s,D$r){return null==D$s.nodeParent&&null==D$r.nodeParent||null!=D$s.nodeParent&&null!=D$r.nodeParent&&(D$s.nodeParent.label==D$r.nodeParent.label&&this.isSameParent(D$s.nodeParent,D$r.nodeParent))},D$e.filter=function(D$s){if(Boolean(D$s)){var D$r=[];this.getFilterSource(this._source,D$r,D$s),this._list.array=D$r}else this._list.array=this.getArray()},D$e.getFilterSource=function(D$s,D$r,D$e){var D$U;for(var D$m in D$e=D$e.toLocaleLowerCase(),D$s)!(D$U=D$s[D$m]).isDirectory&&-1<String(D$U.label).toLowerCase().indexOf(D$e)&&(D$U.x=0,D$r.push(D$U)),D$U.child&&0<D$U.child.length&&this.getFilterSource(D$U.child,D$r,D$e)},D$j(0,D$e,"spaceBottom",function(){return this._list.spaceY},function(D$s){this._list.spaceY=D$s}),D$j(0,D$e,"keepStatus",function(){return this._keepStatus},function(D$s){this._keepStatus=D$s}),D$j(0,D$e,"itemRender",function(){return this._list.itemRender},function(D$s){this._list.itemRender=D$s}),D$j(0,D$e,"array",function(){return this._list.array},function(D$s){this._keepStatus&&this._list.array&&D$s&&this.parseOpenStatus(this._list.array,D$s),this._source=D$s,this._list.array=this.getArray()}),D$j(0,D$e,"mouseHandler",function(){return this._list.mouseHandler},function(D$s){this._list.mouseHandler=D$s}),D$j(0,D$e,"dataSource",D$s.prototype._$get_dataSource,function(D$s){this._dataSource=D$s,D$$.superSet(D$c,this,"dataSource",D$s)}),D$j(0,D$e,"source",function(){return this._source}),D$j(0,D$e,"scrollBar",function(){return this._list.scrollBar}),D$j(0,D$e,"list",function(){return this._list}),D$j(0,D$e,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(D$s){this._list.vScrollBarSkin=D$s}),D$j(0,D$e,"renderHandler",function(){return this._renderHandler},function(D$s){this._renderHandler=D$s}),D$j(0,D$e,"selectedIndex",function(){return this._list.selectedIndex},function(D$s){this._list.selectedIndex=D$s}),D$j(0,D$e,"spaceLeft",function(){return this._spaceLeft},function(D$s){this._spaceLeft=D$s}),D$j(0,D$e,"selectedItem",function(){return this._list.selectedItem},function(D$s){this._list.selectedItem=D$s}),D$j(0,D$e,"width",D$s.prototype._$get_width,function(D$s){D$$.superSet(D$c,this,"width",D$s),this._list.width=D$s}),D$j(0,D$e,"height",D$s.prototype._$get_height,function(D$s){D$$.superSet(D$c,this,"height",D$s),this._list.height=D$s}),D$j(0,D$e,"xml",null,function(D$s){var D$r=[];this.parseXml(D$s.childNodes[0],D$r,null,!0),this.array=D$r}),D$j(0,D$e,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),D$r}(D$c),D$ss=function(D$s){function D$r(){this._items=null,this._selectedIndex=0,D$r.__super.call(this),this._setIndexHandler=D$A.create(this,this.setIndex,null,!1)}D$k(D$r,"laya.ui.ViewStack",D$s);var D$e=D$r.prototype;return D$$.imps(D$e,{"laya.ui.IItem":!0}),D$e.setItems=function(D$s){this.removeChildren();for(var D$r=0,D$e=0,D$U=D$s.length;D$e<D$U;D$e++){var D$m=D$s[D$e];D$m&&(D$m.name="item"+D$r,this.addChild(D$m),D$r++)}this.initItems()},D$e.addItem=function(D$s){D$s.name="item"+this._items.length,this.addChild(D$s),this.initItems()},D$e.initItems=function(){this._items=[];for(var D$s=0;D$s<1e4;D$s++){var D$r=this.getChildByName("item"+D$s);if(null==D$r)break;this._items.push(D$r),D$r.visible=D$s==this._selectedIndex}},D$e.setSelect=function(D$s,D$r){this._items&&-1<D$s&&D$s<this._items.length&&(this._items[D$s].visible=D$r)},D$e.setIndex=function(D$s){this.selectedIndex=D$s},D$j(0,D$e,"dataSource",D$s.prototype._$get_dataSource,function(D$s){if("number"==typeof(this._dataSource=D$s)&&Math.floor(D$s)==D$s||"string"==typeof D$s)this.selectedIndex=parseInt(D$s);else for(var D$r in this._dataSource)this.hasOwnProperty(D$r)&&(this[D$r]=this._dataSource[D$r])}),D$j(0,D$e,"selectedIndex",function(){return this._selectedIndex},function(D$s){this._selectedIndex!=D$s&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=D$s,this.setSelect(this._selectedIndex,!0))}),D$j(0,D$e,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(D$s){this.selectedIndex=this._items.indexOf(D$s)}),D$j(0,D$e,"items",function(){return this._items}),D$j(0,D$e,"setIndexHandler",function(){return this._setIndexHandler},function(D$s){this._setIndexHandler=D$s}),D$r}(D$c),D$rs=function(D$s){function D$r(){D$r.__super.call(this)}return D$k(D$r,"laya.ui.VScrollBar",D$Q),D$r}(),D$es=function(D$r){function D$e(D$s){this._bg=null,this._skin=null,D$e.__super.call(this),void 0===D$s&&(D$s=""),this.text=D$s,this.skin=this.skin}D$k(D$e,"laya.ui.TextInput",D$r);var D$s=D$e.prototype;return D$s.preinitialize=function(){this.mouseEnabled=!0},D$s.destroy=function(D$s){D$b.clearCache(this,this._skin),void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._bg&&this._bg.destroy(),this._bg=null},D$s.createChildren=function(){this.addChild(this._tf=new D$x),this._tf.padding=D$f.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},D$s._onFocus=function(){this.event("focus",this)},D$s._onBlur=function(){this.event("blur",this)},D$s._onInput=function(){this.event("input",this)},D$s._onEnter=function(){this.event("enter",this)},D$s.initialize=function(){this.width=128,this.height=22},D$s.select=function(){this._tf.select()},D$s.setSelection=function(D$s,D$r){this._tf.setSelection(D$s,D$r)},D$j(0,D$s,"text",D$r.prototype._$get_text,function(D$s){this._tf.text!=D$s&&(D$s+="",this._tf.text=D$s,this.event("change"))}),D$j(0,D$s,"bg",function(){return this._bg},function(D$s){this.graphics=this._bg=D$s}),D$j(0,D$s,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(D$s){this._tf.inputElementYAdjuster=D$s}),D$j(0,D$s,"multiline",function(){return this._tf.multiline},function(D$s){this._tf.multiline=D$s}),D$j(0,D$s,"skin",function(){return this._skin},function(D$s){this._skin!=D$s&&(D$b.clearCache(this,this._skin),this._skin=D$s,this._bg||(this.graphics=this._bg=new D$O),D$b.keepCache(this,this._skin),this._bg.source=D$b.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),D$j(0,D$s,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(D$s){this._bg||(this.graphics=this._bg=new D$O),this._bg.sizeGrid=D$J.fillArray(D$f.defaultSizeGrid,D$s,Number)}),D$j(0,D$s,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(D$s){this._tf.inputElementXAdjuster=D$s}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$a,this,"width",D$s),this._bg&&(this._bg.width=D$s)}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$a,this,"height",D$s),this._bg&&(this._bg.height=D$s)}),D$j(0,D$s,"editable",function(){return this._tf.editable},function(D$s){this._tf.editable=D$s}),D$j(0,D$s,"restrict",function(){return this._tf.restrict},function(D$s){this._tf.restrict=D$s}),D$j(0,D$s,"prompt",function(){return this._tf.prompt},function(D$s){this._tf.prompt=D$s}),D$j(0,D$s,"promptColor",function(){return this._tf.promptColor},function(D$s){this._tf.promptColor=D$s}),D$j(0,D$s,"maxChars",function(){return this._tf.maxChars},function(D$s){this._tf.maxChars=D$s}),D$j(0,D$s,"focus",function(){return this._tf.focus},function(D$s){this._tf.focus=D$s}),D$j(0,D$s,"type",function(){return this._tf.type},function(D$s){this._tf.type=D$s}),D$j(0,D$s,"asPassword",function(){return this._tf.asPassword},function(D$s){this._tf.asPassword=D$s}),D$e}(D$a),D$Us=function(D$s){function D$r(){D$r.__super.call(this)}return D$k(D$r,"laya.ui.VSlider",D$C),D$r}(),D$ms=function(D$s){function D$U(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,D$U.__super.call(this)}D$k(D$U,"laya.ui.Dialog",D$s);var D$r=D$U.prototype;return D$r.initialize=function(){this.popupEffect=D$U.manager.popupEffectHandler,this.closeEffect=D$U.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},D$r._dealDragArea=function(){var D$s=this.getChildByName("drag");D$s&&(this.dragArea=D$s.x+","+D$s.y+","+D$s.width+","+D$s.height,D$s.removeSelf())},D$r._onClick=function(D$s){var D$r=D$s.target;if(D$r)switch(D$r.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(D$r.name)}},D$r.show=function(D$s,D$r){void 0===D$s&&(D$s=!1),void 0===D$r&&(D$r=!0),this._open(!1,D$s,D$r)},D$r.popup=function(D$s,D$r){void 0===D$s&&(D$s=!1),void 0===D$r&&(D$r=!0),this._open(!0,D$s,D$r)},D$r._open=function(D$s,D$r,D$e){D$U.manager.lock(!1),this.isModal=D$s,D$U.manager.open(this,D$r,D$e)},D$r.onOpened=function(){},D$r.close=function(D$s,D$r){void 0===D$r&&(D$r=!0),D$U.manager.close(this,D$s,D$r)},D$r.onClosed=function(D$s){},D$r._onMouseDown=function(D$s){var D$r=this.getMousePoint();this._dragArea.contains(D$r.x,D$r.y)?this.startDrag():this.stopDrag()},D$j(0,D$r,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(D$s){if(D$s){var D$r=D$J.fillArray([0,0,0,0],D$s,Number);this._dragArea=new D$V(D$r[0],D$r[1],D$r[2],D$r[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),D$j(0,D$r,"isPopup",function(){return null!=this.parent}),D$j(0,D$r,"zOrder",D$s.prototype._$get_zOrder,function(D$s){D$$.superSet(D$N,this,"zOrder",D$s),D$U.manager._checkMask()}),D$j(1,D$U,"manager",function(){return D$U._manager=D$U._manager||new D$K},function(D$s){D$U._manager=D$s}),D$U.setLockView=function(D$s){D$U.manager.setLockView(D$s)},D$U.lock=function(D$s){D$U.manager.lock(D$s)},D$U.closeAll=function(){D$U.manager.closeAll()},D$U.getDialogsByGroup=function(D$s){return D$U.manager.getDialogsByGroup(D$s)},D$U.closeByGroup=function(D$s){return D$U.manager.closeByGroup(D$s)},D$U.CLOSE="close",D$U.CANCEL="cancel",D$U.SURE="sure",D$U.NO="no",D$U.OK="ok",D$U.YES="yes",D$U._manager=null,D$U}(D$N),D$ks=function(D$s){function D$r(){D$r.__super.call(this)}D$k(D$r,"laya.ui.HBox",D$s);var D$e=D$r.prototype;return D$e.sortItem=function(D$s){D$s&&D$s.sort(function(D$s,D$r){return D$s.x-D$r.x})},D$e.changeItems=function(){this._itemChanged=!1;for(var D$s=[],D$r=0,D$e=0,D$U=this.numChildren;D$e<D$U;D$e++){var D$m=this.getChildAt(D$e);D$m&&D$m.layoutEnabled&&(D$s.push(D$m),D$r=this._height?this._height:Math.max(D$r,D$m.height*D$m.scaleY))}this.sortItem(D$s);var D$k=0;for(D$e=0,D$U=D$s.length;D$e<D$U;D$e++)(D$m=D$s[D$e]).x=D$k,D$k+=D$m.width*D$m.scaleX+this._space,"top"==this._align?D$m.y=0:"middle"==this._align?D$m.y=.5*(D$r-D$m.height*D$m.scaleY):"bottom"==this._align&&(D$m.y=D$r-D$m.height*D$m.scaleY);this.changeSize()},D$j(0,D$e,"height",D$s.prototype._$get_height,function(D$s){this._height!=D$s&&(D$$.superSet(D$G,this,"height",D$s),this.callLater(this.changeItems))}),D$r.NONE="none",D$r.TOP="top",D$r.MIDDLE="middle",D$r.BOTTOM="bottom",D$r}(D$G),D$js=function(D$s){function D$r(){D$r.__super.call(this)}D$k(D$r,"laya.ui.VBox",D$s);var D$e=D$r.prototype;return D$e.changeItems=function(){this._itemChanged=!1;for(var D$s=[],D$r=0,D$e=0,D$U=this.numChildren;D$e<D$U;D$e++){var D$m=this.getChildAt(D$e);D$m&&D$m.layoutEnabled&&(D$s.push(D$m),D$r=this._width?this._width:Math.max(D$r,D$m.width*D$m.scaleX))}this.sortItem(D$s);var D$k=0;for(D$e=0,D$U=D$s.length;D$e<D$U;D$e++)(D$m=D$s[D$e]).y=D$k,D$k+=D$m.height*D$m.scaleY+this._space,"left"==this._align?D$m.x=0:"center"==this._align?D$m.x=.5*(D$r-D$m.width*D$m.scaleX):"right"==this._align&&(D$m.x=D$r-D$m.width*D$m.scaleX);this.changeSize()},D$j(0,D$e,"width",D$s.prototype._$get_width,function(D$s){this._width!=D$s&&(D$$.superSet(D$G,this,"width",D$s),this.callLater(this.changeItems))}),D$r.NONE="none",D$r.LEFT="left",D$r.CENTER="center",D$r.RIGHT="right",D$r}(D$G),D$Ts=function(D$s){function D$r(){D$r.__super.call(this)}return D$k(D$r,"laya.ui.RadioGroup",D$M),D$r.prototype.createItem=function(D$s,D$r){return new D$_(D$s,D$r)},D$r}(),D$Ys=function(D$s){function D$r(){D$r.__super.call(this)}return D$k(D$r,"laya.ui.Tab",D$M),D$r.prototype.createItem=function(D$s,D$r){return new D$E(D$s,D$r)},D$r}(),D$Zs=function(D$r){function D$e(D$s){this._vScrollBar=null,this._hScrollBar=null,void 0===D$s&&(D$s=""),D$e.__super.call(this,D$s)}D$k(D$e,"laya.ui.TextArea",D$r);var D$s=D$e.prototype;return D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},D$s.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},D$s.onVBarChanged=function(D$s){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},D$s.onHBarChanged=function(D$s){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},D$s.changeScroll=function(){var D$s=this._vScrollBar&&0<this._tf.maxScrollY,D$r=this._hScrollBar&&0<this._tf.maxScrollX,D$e=D$s?this._width-this._vScrollBar.width:this._width,D$U=D$r?this._height-this._hScrollBar.height:this._height,D$m=this._tf.padding||D$f.labelPadding;this._tf.width=D$e,this._tf.height=D$U,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-D$m[2],this._vScrollBar.y=D$m[1],this._vScrollBar.height=this._height-(D$r?this._hScrollBar.height:0)-D$m[1]-D$m[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=D$U/Math.max(this._tf.textHeight,D$U),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=D$s),this._hScrollBar&&(this._hScrollBar.x=D$m[0],this._hScrollBar.y=this._height-this._hScrollBar.height-D$m[3],this._hScrollBar.width=this._width-(D$s?this._vScrollBar.width:0)-D$m[0]-D$m[2],this._hScrollBar.scrollSize=Math.max(.033*D$e,1),this._hScrollBar.thumbPercent=D$e/Math.max(this._tf.textWidth,D$e),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=D$r)},D$s.scrollTo=function(D$s){this.commitMeasure(),this._tf.scrollY=D$s},D$j(0,D$s,"scrollY",function(){return this._tf.scrollY}),D$j(0,D$s,"width",D$r.prototype._$get_width,function(D$s){D$$.superSet(D$es,this,"width",D$s),this.callLater(this.changeScroll)}),D$j(0,D$s,"hScrollBar",function(){return this._hScrollBar}),D$j(0,D$s,"height",D$r.prototype._$get_height,function(D$s){D$$.superSet(D$es,this,"height",D$s),this.callLater(this.changeScroll)}),D$j(0,D$s,"maxScrollX",function(){return this._tf.maxScrollX}),D$j(0,D$s,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(D$s){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new D$rs),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=D$s}),D$j(0,D$s,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(D$s){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new D$W),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=D$s}),D$j(0,D$s,"vScrollBar",function(){return this._vScrollBar}),D$j(0,D$s,"maxScrollY",function(){return this._tf.maxScrollY}),D$j(0,D$s,"scrollX",function(){return this._tf.scrollX}),D$e}(D$es);!function(D$s){function D$r(){this._uiView=null,this.isCloseOther=!1,D$r.__super.call(this)}D$k(D$r,"laya.ui.AsynDialog",D$ms);var D$e=D$r.prototype;D$e.createView=function(D$s){this._uiView=D$s},D$e._open=function(D$s,D$r,D$e){this.isModal=D$s,this.isCloseOther=D$r,D$ms.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},D$e.onCreated=function(){this.createUI(),this.onOpen()},D$e.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},D$e.onOpen=function(){D$ms.manager.open(this,this.isCloseOther),D$ms.manager.lock(!1)},D$e.close=function(D$s,D$r){void 0===D$r&&(D$r=!0),D$ms.manager.close(this),this.onClose()},D$e.onClose=function(){},D$e.destroy=function(D$s){void 0===D$s&&(D$s=!0),laya.ui.View.prototype.destroy.call(this,D$s),this._uiView=null,this.onDestroy()},D$e.onDestroy=function(){}}();D$$.__init([D$N])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(D$s,D$r){"use strict";for(var D$e in Object.defineProperty(D$r,"__esModule",{value:!0}),Laya){var D$U=Laya[D$e];D$U&&D$U.__isclass&&(D$r[D$e]=D$U)}}),function(D$A,D$s,D$w){D$w.un,D$w.uns;var D$H=D$w.static,D$x=D$w.class,D$B=D$w.getset,D$U=D$w.__newvec,D$I=laya.maths.Arith,D$j=laya.webgl.atlas.AtlasResourceManager,D$e=laya.webgl.shader.BaseShader,D$i=laya.utils.Browser,D$T=laya.webgl.utils.Buffer,D$X=laya.utils.Byte,D$m=laya.utils.ClassUtils,D$Y=D$w.Config,D$k=(laya.events.Event,laya.events.EventDispatcher),D$f=laya.utils.Handler,D$V=laya.net.Loader,D$r=laya.net.LoaderManager,D$Z=(laya.maths.MathUtil,laya.display.Node),D$$=laya.renders.Render,D$h=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),D$l=laya.resource.Resource,D$b=laya.utils.RunDriver,D$o=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),D$D=laya.display.Sprite,D$n=laya.utils.Stat,D$y=laya.utils.StringKey,D$J=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),D$g=laya.utils.Utils,D$P=laya.webgl.WebGL,D$O=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;D$w.interface("laya.d3.core.IClone"),D$w.interface("laya.d3.graphics.IVertex"),D$w.interface("laya.d3.core.render.IUpdate"),D$w.interface("laya.d3.core.scene.ITreeNode"),D$w.interface("laya.d3.core.render.IRenderable");(function(){function D$E(){}D$x(D$E,"laya.d3.animation.AnimationClipParser01"),D$E.READ_DATA=function(){D$E._DATA.offset=D$E._reader.getUint32(),D$E._DATA.size=D$E._reader.getUint32()},D$E.READ_BLOCK=function(){for(var D$s=D$E._BLOCK.count=D$E._reader.getUint16(),D$r=D$E._BLOCK.blockStarts=[],D$e=D$E._BLOCK.blockLengths=[],D$U=0;D$U<D$s;D$U++)D$r.push(D$E._reader.getUint32()),D$e.push(D$E._reader.getUint32())},D$E.READ_STRINGS=function(){var D$s=D$E._reader.getUint32(),D$r=D$E._reader.getUint16(),D$e=D$E._reader.pos;D$E._reader.pos=D$s+D$E._DATA.offset;for(var D$U=0;D$U<D$r;D$U++)D$E._strings[D$U]=D$E._reader.readUTFString();D$E._reader.pos=D$e},D$E.parse=function(D$s,D$r){D$E._animationClip=D$s;(D$E._reader=D$r).__getBuffer();D$E.READ_DATA(),D$E.READ_BLOCK(),D$E.READ_STRINGS();for(var D$e=0,D$U=D$E._BLOCK.count;D$e<D$U;D$e++){var D$m=D$r.getUint16(),D$k=D$E._strings[D$m],D$j=D$E["READ_"+D$k];if(null==D$j)throw new Error("model file err,no this function:"+D$m+" "+D$k);D$j.call()}},D$E.READ_ANIMATIONS=function(){var D$s,D$r=0,D$e=0,D$U=D$E._reader,D$m=D$U.__getBuffer(),D$k=[],D$j=D$U.getUint8();for(D$k.length=D$j,D$r=0;D$r<D$j;D$r++)D$k[D$r]=D$U.getUint16();var D$T=[],D$Y=D$U.getUint16();for(D$T.length=D$Y,D$r=0;D$r<D$Y;D$r++)D$T[D$r]=D$U.getFloat32();var D$Z=D$E._animationClip;D$Z.name=D$E._strings[D$U.getUint16()];var D$h=D$Z._duration=D$U.getFloat32();D$Z.islooping=!!D$U.getByte(),D$Z._frameRate=D$U.getInt16();var D$H=D$U.getInt16(),D$A=D$Z._nodes=new Array;D$A.length=D$H,(D$Z._publicClipDatas=[]).length=D$H;var D$x=D$Z._nodesMap={},D$B=0,D$$=0;for(D$r=0;D$r<D$H;D$r++){D$s=D$A[D$r]=new D$p;var D$l=D$U.getUint16(),D$V=D$s.path=[];for(D$V.length=D$l,D$e=0;D$e<D$l;D$e++)D$V[D$e]=D$E._strings[D$U.getUint16()];var D$b=D$V.join("/"),D$o=D$x[D$b];D$o||(D$x[D$b]=D$o=[]),D$o.push(D$s);var D$I=D$U.getInt16();-1!==D$I&&(D$s.componentType=D$E._strings[D$I]);var D$w=D$R._propertyIndexDic[D$E._strings[D$U.getUint16()]];if(null==D$w)throw new Error("AnimationClipParser01:unknown property name.");var D$X=D$w<4,D$D=!D$X||D$X&&""===D$V[0];(D$s._cacheProperty=D$D)?D$B++:D$$++,D$s.propertyNameID=D$w;var D$n=D$k[D$U.getUint8()];D$s.keyFrameWidth=D$n/4;var D$y=D$s.keyFrames=[],D$g=D$y.length=D$U.getUint16(),D$f=null,D$J=NaN;for(D$e=0;D$e<D$g;D$e++){var D$P=D$y[D$e]=new D$a;D$J=D$P.startTime=D$T[D$U.getUint16()];var D$O=D$U.pos;D$P.inTangent=new Float32Array(D$m.slice(D$O,D$O+D$n)),D$U.pos+=D$n,D$O=D$U.pos,D$P.outTangent=new Float32Array(D$m.slice(D$O,D$O+D$n)),D$U.pos+=D$n,D$O=D$U.pos,D$P.data=new Float32Array(D$m.slice(D$O,D$O+D$n)),D$U.pos+=D$n,D$f&&(D$f.next=D$P,D$f.duration=D$J-D$f.startTime),D$f=D$P}D$P.next=null,D$P.duration=D$h-D$J}var D$i=D$Z._nodeToCachePropertyMap=new Int32Array(D$H),D$K=D$Z._cachePropertyMap=new Int32Array(D$B),D$c=D$Z._unCachePropertyMap=new Int32Array(D$$);for(D$B=D$$=0,D$r=0;D$r<D$H;D$r++)(D$s=D$A[D$r])._cacheProperty?(D$i[D$r]=D$B,D$K[D$B++]=D$r):D$c[D$$++]=D$r},D$E._animationClip=null,D$E._reader=null,D$E._strings=[],D$H(D$E,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function D$Q(){}D$x(D$Q,"laya.d3.animation.AnimationClipParser02"),D$Q.READ_DATA=function(){D$Q._DATA.offset=D$Q._reader.getUint32(),D$Q._DATA.size=D$Q._reader.getUint32()},D$Q.READ_BLOCK=function(){for(var D$s=D$Q._BLOCK.count=D$Q._reader.getUint16(),D$r=D$Q._BLOCK.blockStarts=[],D$e=D$Q._BLOCK.blockLengths=[],D$U=0;D$U<D$s;D$U++)D$r.push(D$Q._reader.getUint32()),D$e.push(D$Q._reader.getUint32())},D$Q.READ_STRINGS=function(){var D$s=D$Q._reader.getUint32(),D$r=D$Q._reader.getUint16(),D$e=D$Q._reader.pos;D$Q._reader.pos=D$s+D$Q._DATA.offset;for(var D$U=0;D$U<D$r;D$U++)D$Q._strings[D$U]=D$Q._reader.readUTFString();D$Q._reader.pos=D$e},D$Q.parse=function(D$s,D$r){D$Q._animationClip=D$s;(D$Q._reader=D$r).__getBuffer();D$Q.READ_DATA(),D$Q.READ_BLOCK(),D$Q.READ_STRINGS();for(var D$e=0,D$U=D$Q._BLOCK.count;D$e<D$U;D$e++){var D$m=D$r.getUint16(),D$k=D$Q._strings[D$m],D$j=D$Q["READ_"+D$k];if(null==D$j)throw new Error("model file err,no this function:"+D$m+" "+D$k);D$j.call()}},D$Q.READ_ANIMATIONS=function(){var D$s,D$r=0,D$e=0,D$U=D$Q._reader,D$m=D$U.__getBuffer(),D$k=[],D$j=D$U.getUint8();for(D$k.length=D$j,D$r=0;D$r<D$j;D$r++)D$k[D$r]=D$U.getUint16();var D$T=[],D$Y=D$U.getUint16();for(D$T.length=D$Y,D$r=0;D$r<D$Y;D$r++)D$T[D$r]=D$U.getFloat32();var D$Z=D$Q._animationClip;D$Z.name=D$Q._strings[D$U.getUint16()];var D$h=D$Z._duration=D$U.getFloat32();D$Z.islooping=!!D$U.getByte(),D$Z._frameRate=D$U.getInt16();var D$H=D$U.getInt16(),D$A=D$Z._nodes=new Array;D$A.length=D$H,(D$Z._publicClipDatas=[]).length=D$H;var D$x=D$Z._nodesMap={},D$B=0,D$$=0;for(D$r=0;D$r<D$H;D$r++){D$s=D$A[D$r]=new D$p;var D$l=D$U.getUint16(),D$V=D$s.path=[];for(D$V.length=D$l,D$e=0;D$e<D$l;D$e++)D$V[D$e]=D$Q._strings[D$U.getUint16()];var D$b=D$V.join("/"),D$o=D$x[D$b];D$o||(D$x[D$b]=D$o=[]),D$o.push(D$s);var D$I=D$U.getInt16();-1!==D$I&&(D$s.componentType=D$Q._strings[D$I]);var D$w=D$R._propertyIndexDic[D$Q._strings[D$U.getUint16()]];if(null==D$w)throw new Error("AnimationClipParser02:unknown property name.");var D$X=D$w<4,D$D=!D$X||D$X&&""===D$V[0];(D$s._cacheProperty=D$D)?D$B++:D$$++,D$s.propertyNameID=D$w;var D$n=D$k[D$U.getUint8()];D$s.keyFrameWidth=D$n/4;var D$y=D$s.keyFrames=[],D$g=D$y.length=D$U.getUint16(),D$f=null,D$J=NaN;for(D$e=0;D$e<D$g;D$e++){var D$P=D$y[D$e]=new D$a;D$J=D$P.startTime=D$T[D$U.getUint16()];var D$O=D$U.pos;D$P.inTangent=new Float32Array(D$m.slice(D$O,D$O+D$n)),D$U.pos+=D$n,D$O=D$U.pos,D$P.outTangent=new Float32Array(D$m.slice(D$O,D$O+D$n)),D$U.pos+=D$n,D$O=D$U.pos,D$P.data=new Float32Array(D$m.slice(D$O,D$O+D$n)),D$U.pos+=D$n,D$f&&(D$f.next=D$P,D$f.duration=D$J-D$f.startTime),D$f=D$P}D$P.next=null,D$P.duration=D$h-D$J}var D$i=D$U.getUint16();for(D$r=0;D$r<D$i;D$r++){var D$K,D$c=new D$C;D$c.time=D$U.getFloat32(),D$c.eventName=D$Q._strings[D$U.getUint16()];var D$E=D$U.getUint16();for(0<D$E&&(D$c.params=D$K=[]),D$e=0;D$e<D$E;D$e++){switch(D$U.getByte()){case 0:D$K.push(!!D$U.getByte());break;case 1:D$K.push(D$U.getInt32());break;case 2:D$K.push(D$U.getFloat32());break;case 3:D$K.push(D$Q._strings[D$U.getUint16()]);break;default:throw new Error("unknown type.")}}D$Z.addEvent(D$c)}var D$v=D$Z._nodeToCachePropertyMap=new Int32Array(D$H),D$S=D$Z._cachePropertyMap=new Int32Array(D$B),D$z=D$Z._unCachePropertyMap=new Int32Array(D$$);for(D$B=D$$=0,D$r=0;D$r<D$H;D$r++)(D$s=D$A[D$r])._cacheProperty?(D$v[D$r]=D$B,D$S[D$B++]=D$r):D$z[D$$++]=D$r},D$Q._animationClip=null,D$Q._reader=null,D$Q._strings=[],D$H(D$Q,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var D$C=function(){function D$s(){this.time=NaN,this.eventName=null,this.params=null}return D$x(D$s,"laya.d3.animation.AnimationEvent"),D$s}(),D$R=function(){function D$U(){this._childs=[],this.transform=new D$br(this)}D$x(D$U,"laya.d3.animation.AnimationNode");var D$s=D$U.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.addChild=function(D$s){D$s._parent=this,D$s.transform.setParent(this.transform),this._childs.push(D$s)},D$s.removeChild=function(D$s){var D$r=this._childs.indexOf(D$s);-1!==D$r&&this._childs.splice(D$r,1)},D$s.getChildByName=function(D$s){for(var D$r=0,D$e=this._childs.length;D$r<D$e;D$r++){var D$U=this._childs[D$r];if(D$U.name===D$s)return D$U}return null},D$s.getChildByIndex=function(D$s){return this._childs[D$s]},D$s.getChildCount=function(){return this._childs.length},D$s.cloneTo=function(D$s){var D$r=D$s;D$r.name=this.name;for(var D$e=0,D$U=this._childs.length;D$e<D$U;D$e++){var D$m=this._childs[D$e],D$k=D$m.clone();D$r.addChild(D$k);var D$j=D$m.transform,D$T=D$k.transform;D$T.setLocalPosition(D$j.getLocalPosition()),D$T.setLocalRotation(D$j.getLocalRotation()),D$T.setLocalScale(D$j.getLocalScale()),D$T._localRotationEuler=D$j._localRotationEuler,D$T._setWorldMatrixIgnoreUpdate(D$j.getWorldMatrix())}},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$U.__init__=function(){D$U.registerAnimationNodeProperty("localPosition",D$U._getLocalPosition,D$U._setLocalPosition),D$U.registerAnimationNodeProperty("localRotation",D$U._getLocalRotation,D$U._setLocalRotation),D$U.registerAnimationNodeProperty("localScale",D$U._getLocalScale,D$U._setLocalScale),D$U.registerAnimationNodeProperty("localRotationEuler",D$U._getLocalRotationEuler,D$U._setLocalRotationEuler),D$U.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",D$U._getParticleRenderSharedMaterialTintColor,D$U._setParticleRenderSharedMaterialTintColor),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",D$U._getMeshRenderSharedMaterialTilingOffset,D$U._setMeshRenderSharedMaterialTilingOffset),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",D$U._getMeshRenderSharedMaterialAlbedo,D$U._setMeshRenderSharedMaterialAlbedo),D$U.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",D$U._getSkinnedMeshRenderSharedMaterialTilingOffset,D$U._setSkinnedMeshRenderSharedMaterialTilingOffset),D$U.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",D$U._getSkinnedMeshRenderSharedMaterialAlbedo,D$U._setSkinnedMeshRenderSharedMaterialAlbedo),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",D$U._getMeshRenderSharedMaterialAlbedo,D$U._setMeshRenderSharedMaterialAlbedo),D$U.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",D$U._getSkinnedMeshRenderSharedMaterialAlbedo,D$U._setSkinnedMeshRenderSharedMaterialAlbedo),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",D$U._getMeshRenderSharedMaterialIntensity,D$U._setMeshRenderSharedMaterialIntensity),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",D$U._getMeshRenderSharedMaterialAlpha,D$U._setMeshRenderSharedMaterialAlpha),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",D$U._getMeshRenderSharedMaterialAlphaColor,D$U._setMeshRenderSharedMaterialAlphaColor),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",D$U._getMeshRenderSharedMaterialBaseColor,D$U._setMeshRenderSharedMaterialBaseColor),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",D$U._getMeshRenderSharedMaterialDissolve,D$U._setMeshRenderSharedMaterialDissolve),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",D$U._getMeshRenderSharedMaterialDissolveSpeed,D$U._setMeshRenderSharedMaterialDissolveSpeed),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",D$U._getMeshRenderSharedMaterialMMultiplier,D$U._setMeshRenderSharedMaterialMMultiplier),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",D$U._getMeshRenderSharedMaterialBaseScrollSpeedX,D$U._setMeshRenderSharedMaterialBaseScrollSpeedX),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",D$U._getMeshRenderSharedMaterialBaseScrollSpeedY,D$U._setMeshRenderSharedMaterialBaseScrollSpeedY),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",D$U._getMeshRenderSharedMaterialSecondScrollSpeedX,D$U._setMeshRenderSharedMaterialSecondScrollSpeedX),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",D$U._getMeshRenderSharedMaterialSecondScrollSpeedY,D$U._setMeshRenderSharedMaterialSecondScrollSpeedY),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",D$U._getMeshRenderSharedMaterialDetailTilingOffset,D$U._setMeshRenderSharedMaterialDetailTilingOffset),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",D$U._getMeshRenderSharedMaterialDissolveTilingOffset,D$U._setMeshRenderSharedMaterialDissolveTilingOffset),D$U.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",D$U._getMeshRenderSharedMaterialMaskTilingOffset,D$U._setMeshRenderSharedMaterialMaskTilingOffset)},D$U.registerAnimationNodeProperty=function(D$s,D$r,D$e){if(D$U._propertyIndexDic[D$s])throw new Error("AnimationNode: this propertyName has registered.");D$U._propertyIndexDic[D$s]=D$U._propertyIDCounter,D$U._propertyGetFuncs[D$U._propertyIDCounter]=D$r,D$U._propertySetFuncs[D$U._propertyIDCounter]=D$e,D$U._propertyIDCounter++},D$U._getLocalPosition=function(D$s,D$r){return D$s?D$s.transform.getLocalPosition():D$r._transform.localPosition.elements},D$U._setLocalPosition=function(D$s,D$r,D$e){if(D$s)D$s.transform.setLocalPosition(D$e);else{var D$U=D$r._transform,D$m=D$U.localPosition;D$m.elements=D$e,D$U.localPosition=D$m}},D$U._getLocalRotation=function(D$s,D$r){return D$s?D$s.transform.getLocalRotation():D$r._transform.localRotation.elements},D$U._setLocalRotation=function(D$s,D$r,D$e){if(D$s)D$s.transform.setLocalRotation(D$e);else{var D$U=D$r._transform,D$m=D$U.localRotation;D$m.elements=D$e,D$U.localRotation=D$m}},D$U._getLocalScale=function(D$s,D$r){return D$s?D$s.transform.getLocalScale():D$r._transform.localScale.elements},D$U._setLocalScale=function(D$s,D$r,D$e){if(D$s)D$s.transform.setLocalScale(D$e);else{var D$U=D$r._transform,D$m=D$U.localScale;D$m.elements=D$e,D$U.localScale=D$m}},D$U._getLocalRotationEuler=function(D$s,D$r){return D$s?D$s.transform.getLocalRotationEuler():D$r._transform.localRotationEuler.elements},D$U._setLocalRotationEuler=function(D$s,D$r,D$e){if(D$s)D$s.transform.setLocalRotationEuler(D$e);else{var D$U=D$r._transform,D$m=D$U.localRotationEuler;D$m.elements=D$e,D$U.localRotationEuler=D$m}},D$U._getMeshRenderSharedMaterialTilingOffset=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return D$r.meshRender.sharedMaterial.tilingOffset.elements},D$U._setMeshRenderSharedMaterialTilingOffset=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.meshRender.material).tilingOffset).elements=D$e,D$U.tilingOffset=D$m)}else(D$m=(D$U=D$r.meshRender.material).tilingOffset).elements=D$e,D$U.tilingOffset=D$m},D$U._getMeshRenderSharedMaterialAlbedo=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.albedoColor.elements:null}return D$r.meshRender.sharedMaterial.albedoColor.elements},D$U._setMeshRenderSharedMaterialAlbedo=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.meshRender.material).albedoColor).elements=D$e,D$U.albedoColor=D$m)}else(D$m=(D$U=D$r.meshRender.material).albedoColor).elements=D$e,D$U.albedoColor=D$m},D$U._getSkinnedMeshRenderSharedMaterialTilingOffset=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return D$r.skinnedMeshRender.sharedMaterial.tilingOffset.elements},D$U._setSkinnedMeshRenderSharedMaterialTilingOffset=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.skinnedMeshRender.material).tilingOffset).elements=D$e,D$U.tilingOffset=D$m)}else(D$m=(D$U=D$r.skinnedMeshRender.material).tilingOffset).elements=D$e,D$U.tilingOffset=D$m},D$U._getSkinnedMeshRenderSharedMaterialAlbedo=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return D$r.skinnedMeshRender.sharedMaterial.albedoColor.elements},D$U._setSkinnedMeshRenderSharedMaterialAlbedo=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.skinnedMeshRender.material).albedoColor).elements=D$e,D$U.albedoColor=D$m)}else(D$m=(D$U=D$r.skinnedMeshRender.material).albedoColor).elements=D$e,D$U.albedoColor=D$m},D$U._getParticleRenderSharedMaterialTintColor=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.particleRender.sharedMaterial.tintColor.elements:null}return D$r.particleRender.sharedMaterial.tintColor.elements},D$U._setParticleRenderSharedMaterialTintColor=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.particleRender.material).tintColor).elements=D$e,D$U.tintColor=D$m)}else(D$m=(D$U=D$r.particleRender.material).tintColor).elements=D$e,D$U.tintColor=D$m},D$U._getMeshRenderSharedMaterialAlphaColor=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.alphaColor.elements:null}return D$r.meshRender.sharedMaterial.alphaColor.elements},D$U._setMeshRenderSharedMaterialAlphaColor=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.meshRender.material).alphaColor).elements=D$e,D$U.alphaColor=D$m)}else(D$m=(D$U=D$r.meshRender.material).alphaColor).elements=D$e,D$U.alphaColor=D$m},D$U._getMeshRenderSharedMaterialBaseColor=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.baseColor.elements:null}return D$r.meshRender.sharedMaterial.baseColor.elements},D$U._setMeshRenderSharedMaterialBaseColor=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.meshRender.material).baseColor).elements=D$e,D$U.baseColor=D$m)}else(D$m=(D$U=D$r.meshRender.material).baseColor).elements=D$e,D$U.baseColor=D$m},D$U._getMeshRenderSharedMaterialDissolve=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.dissolve:0}return D$r.meshRender.sharedMaterial.dissolve},D$U._setMeshRenderSharedMaterialDissolve=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.dissolve=D$e[0])}else D$r.meshRender.material.dissolve=D$e[0]},D$U._getMeshRenderSharedMaterialDissolveSpeed=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.dissolveSpeed:0}return D$r.meshRender.sharedMaterial.dissolveSpeed},D$U._setMeshRenderSharedMaterialDissolveSpeed=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.dissolveSpeed=D$e[0])}else D$r.meshRender.material.dissolveSpeed=D$e[0]},D$U._getMeshRenderSharedMaterialMMultiplier=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.mMultiplier:0}return D$r.meshRender.sharedMaterial.mMultiplier},D$U._setMeshRenderSharedMaterialMMultiplier=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.mMultiplier=D$e[0])}else D$r.meshRender.material.mMultiplier=D$e[0]},D$U._getMeshRenderSharedMaterialBaseScrollSpeedX=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return D$r.meshRender.sharedMaterial.baseScrollSpeedX},D$U._setMeshRenderSharedMaterialBaseScrollSpeedX=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.baseScrollSpeedX=D$e[0])}else D$r.meshRender.material.baseScrollSpeedX=D$e[0]},D$U._getMeshRenderSharedMaterialBaseScrollSpeedY=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return D$r.meshRender.sharedMaterial.baseScrollSpeedY},D$U._setMeshRenderSharedMaterialBaseScrollSpeedY=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.baseScrollSpeedY=D$e[0])}else D$r.meshRender.material.baseScrollSpeedY=D$e[0]},D$U._getMeshRenderSharedMaterialSecondScrollSpeedX=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return D$r.meshRender.sharedMaterial.secondScrollSpeedX},D$U._setMeshRenderSharedMaterialSecondScrollSpeedX=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.secondScrollSpeedX=D$e[0])}else D$r.meshRender.material.secondScrollSpeedX=D$e[0]},D$U._getMeshRenderSharedMaterialSecondScrollSpeedY=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return D$r.meshRender.sharedMaterial.secondScrollSpeedY},D$U._setMeshRenderSharedMaterialSecondScrollSpeedY=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.secondScrollSpeedY=D$e[0])}else D$r.meshRender.material.secondScrollSpeedY=D$e[0]},D$U._getMeshRenderSharedMaterialAlpha=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.alpha:0}return D$r.meshRender.sharedMaterial.alpha},D$U._setMeshRenderSharedMaterialAlpha=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.alpha=D$e[0])}else D$r.meshRender.material.alpha=D$e[0]},D$U._getMeshRenderSharedMaterialIntensity=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.intensity:0}return D$r.meshRender.sharedMaterial.intensity},D$U._setMeshRenderSharedMaterialIntensity=function(D$s,D$r,D$e){if(D$s){var D$U=D$s.transform._entity;D$U&&(D$U.owner.meshRender.material.intensity=D$e[0])}else D$r.meshRender.material.intensity=D$e[0]},D$U._getMeshRenderSharedMaterialDetailTilingOffset=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return D$r.meshRender.sharedMaterial.detailTilingOffset.elements},D$U._setMeshRenderSharedMaterialDetailTilingOffset=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.meshRender.material).detailTilingOffset).elements=D$e,D$U.detailTilingOffset=D$m)}else(D$m=(D$U=D$r.meshRender.material).detailTilingOffset).elements=D$e,D$U.detailTilingOffset=D$m},D$U._getMeshRenderSharedMaterialDissolveTilingOffset=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return D$r.meshRender.sharedMaterial.dissolveTilingOffset.elements},D$U._setMeshRenderSharedMaterialDissolveTilingOffset=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.meshRender.material).dissolveTilingOffset).elements=D$e,D$U.dissolveTilingOffset=D$m)}else(D$m=(D$U=D$r.meshRender.material).dissolveTilingOffset).elements=D$e,D$U.dissolveTilingOffset=D$m},D$U._getMeshRenderSharedMaterialMaskTilingOffset=function(D$s,D$r){if(D$s){var D$e=D$s.transform._entity;return D$e?D$e.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return D$r.meshRender.sharedMaterial.maskTilingOffset.elements},D$U._setMeshRenderSharedMaterialMaskTilingOffset=function(D$s,D$r,D$e){var D$U,D$m;if(D$s){var D$k=D$s.transform._entity;D$k&&((D$m=(D$U=D$k.owner.meshRender.material).maskTilingOffset).elements=D$e,D$U.maskTilingOffset=D$m)}else(D$m=(D$U=D$r.meshRender.material).maskTilingOffset).elements=D$e,D$U.maskTilingOffset=D$m},D$U._propertyIDCounter=0,D$U._propertyIndexDic={},D$U._propertySetFuncs=[],D$U._propertyGetFuncs=[],D$U}(),D$a=function(){function D$s(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return D$x(D$s,"laya.d3.animation.Keyframe"),D$s}(),D$p=function(){function D$s(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return D$x(D$s,"laya.d3.animation.KeyframeNode"),D$s}(),D$K=(function(){function D$s(){this._tempVector30=new D$jr,this._tempVector31=new D$jr,this._tempVector32=new D$jr,this._a=new D$jr,this._b=new D$jr,this._c=new D$jr,this._d=new D$jr}D$x(D$s,"laya.d3.core.glitter.SplineCurvePositionVelocity");var D$r=D$s.prototype;D$r.Init=function(D$s,D$r,D$e,D$U){D$s.cloneTo(this._d),D$r.cloneTo(this._c),D$jr.scale(D$s,2,this._a),D$jr.scale(D$e,2,this._tempVector30),D$jr.subtract(this._a,this._tempVector30,this._a),D$jr.add(this._a,D$r,this._a),D$jr.add(this._a,D$U,this._a),D$jr.scale(D$e,3,this._b),D$jr.scale(D$s,3,this._tempVector30),D$jr.subtract(this._b,this._tempVector30,this._b),D$jr.subtract(this._b,D$U,this._b),D$jr.scale(D$r,2,this._tempVector30),D$jr.subtract(this._b,this._tempVector30,this._b)},D$r.Slerp=function(D$s,D$r){D$jr.scale(this._a,D$s*D$s*D$s,this._tempVector30),D$jr.scale(this._b,D$s*D$s,this._tempVector31),D$jr.scale(this._c,D$s,this._tempVector32),D$jr.add(this._tempVector30,this._tempVector31,D$r),D$jr.add(D$r,this._tempVector32,D$r),D$jr.add(D$r,this._d,D$r)}}(),function(){function D$S(D$s,D$r,D$e,D$U){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=D$s,this._h=D$r,this._minHeight=D$e,this._maxHeight=D$U}D$x(D$S,"laya.d3.core.HeightMap");var D$s=D$S.prototype;D$s._inBounds=function(D$s,D$r){return 0<=D$s&&D$s<this._h&&0<=D$r&&D$r<this._w},D$s.getHeight=function(D$s,D$r){return this._inBounds(D$s,D$r)?this._datas[D$s][D$r]:NaN},D$B(0,D$s,"width",function(){return this._w}),D$B(0,D$s,"height",function(){return this._h}),D$B(0,D$s,"maxHeight",function(){return this._maxHeight}),D$B(0,D$s,"minHeight",function(){return this._minHeight}),D$S.creatFromMesh=function(D$s,D$r,D$e,D$U){for(var D$m=[],D$k=[],D$j=D$s.getSubMeshCount(),D$T=0;D$T<D$j;D$T++){for(var D$Y=D$s.getSubMesh(D$T),D$Z=D$Y._getVertexBuffer(),D$h=D$Z.getData(),D$H=[],D$A=0;D$A<D$h.length;D$A+=D$Z.vertexDeclaration.vertexStride/4){var D$x=new D$jr(D$h[D$A+0],D$h[D$A+1],D$h[D$A+2]);D$H.push(D$x)}D$m.push(D$H);var D$B=D$Y._getIndexBuffer();D$k.push(D$B.getData())}var D$$=D$s.boundingBox,D$l=D$$.min.x,D$V=D$$.min.z,D$b=D$$.max.x,D$o=D$$.max.z,D$I=D$$.min.y,D$w=D$$.max.y,D$X=D$b-D$l,D$D=D$o-D$V,D$n=D$U.elements[0]=D$X/(D$r-1),D$y=D$U.elements[1]=D$D/(D$e-1),D$g=new D$S(D$r,D$e,D$I,D$w),D$f=D$S._tempRay,D$J=D$f.direction.elements;D$J[0]=0,D$J[1]=-1,D$J[2]=0;var D$P=D$w+.1;D$f.origin.elements[1]=D$P;for(var D$O=0;D$O<D$e;D$O++){var D$i=D$V+D$O*D$y;D$g._datas[D$O]=[];for(var D$K=0;D$K<D$r;D$K++){var D$c=D$l+D$K*D$n,D$E=D$f.origin.elements;D$E[0]=D$c,D$E[2]=D$i;var D$v=D$S._getPosition(D$f,D$m,D$k);D$g._datas[D$O][D$K]=D$v===Number.MAX_VALUE?NaN:D$P-D$v}}return D$g},D$S.createFromImage=function(D$s,D$r,D$e){for(var D$U=D$s.width,D$m=D$s.height,D$k=new D$S(D$U,D$m,D$r,D$e),D$j=(D$e-D$r)/254,D$T=D$s.getPixels(),D$Y=0,D$Z=0;D$Z<D$m;D$Z++)for(var D$h=D$k._datas[D$Z]=[],D$H=0;D$H<D$U;D$H++){var D$A=D$T[D$Y++],D$x=D$T[D$Y++],D$B=D$T[D$Y++],D$$=D$T[D$Y++];D$h[D$H]=255==D$A&&255==D$x&&255==D$B&&255==D$$?NaN:(D$A+D$x+D$B)/3*D$j+D$r}return D$k},D$S._getPosition=function(D$s,D$r,D$e){for(var D$U=Number.MAX_VALUE,D$m=0;D$m<D$r.length;D$m++)for(var D$k=D$r[D$m],D$j=D$e[D$m],D$T=0;D$T<D$j.length;D$T+=3){var D$Y=D$k[D$j[D$T+0]],D$Z=D$k[D$j[D$T+1]],D$h=D$k[D$j[D$T+2]],D$H=D$Br.rayIntersectsTriangle(D$s,D$Y,D$Z,D$h);!isNaN(D$H)&&D$H<D$U&&(D$U=D$H)}return D$U},D$H(D$S,["_tempRay",function(){return this._tempRay=new D$mr(new D$jr,new D$jr)}])}(),function(){function D$m(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}D$x(D$m,"laya.d3.core.Layer");var D$s=D$m.prototype;return D$s._binarySearchIndex=function(){for(var D$s=0,D$r=D$m._collsionTestList.length-1,D$e=0;D$s<=D$r;){D$e=Math.floor((D$s+D$r)/2);var D$U=D$m._collsionTestList[D$e];if(D$U==this._number)return D$e;D$U>this._number?D$r=D$e-1:D$s=D$e+1}return D$s},D$s._addCollider=function(D$s){0===this._colliders.length&&D$m._collsionTestList.splice(this._binarySearchIndex(),0,this._number),D$s._isRigidbody?(this._colliders.unshift(D$s),this._nonRigidbodyOffset++):this._colliders.push(D$s)},D$s._removeCollider=function(D$s){var D$r=this._colliders.indexOf(D$s);D$r<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(D$r,1),0===this._colliders.length&&D$m._collsionTestList.splice(D$m._collsionTestList.indexOf(this._number),1)},D$B(0,D$s,"number",function(){return this._number}),D$B(0,D$s,"visible",function(){return this._visible},function(D$s){this._visible=D$s,D$m._visibleLayers=D$s?D$m._visibleLayers|this.mask:D$m._visibleLayers&~this.mask}),D$B(0,D$s,"mask",function(){return this._mask}),D$B(1,D$m,"visibleLayers",function(){return D$m._visibleLayers},function(D$s){D$m._visibleLayers=D$s;for(var D$r=0,D$e=D$m._layerList.length;D$r<D$e;D$r++){var D$U=D$m._layerList[D$r];D$U._visible=0!=(D$U._mask&D$m._visibleLayers)}}),D$m.__init__=function(){D$m._layerList.length=31;for(var D$s=0;D$s<31;D$s++){var D$r=new D$m;D$m._layerList[D$s]=D$r,0===D$s?(D$r.name="Default Layer",D$r.visible=!0):(D$r.name="Layer-"+D$s,D$r.visible=!1),D$r._number=D$s,D$r._mask=Math.pow(2,D$s)}D$m.currentCreationLayer=D$m._layerList[0]},D$m.getLayerByNumber=function(D$s){if(D$s<0||30<D$s)throw new Error("无法返回指定Layer，该number超出范围！");return D$m._layerList[D$s]},D$m.getLayerByName=function(D$s){for(var D$r=0;D$r<31;D$r++)if(D$m._layerList[D$r].name===D$s)return D$m._layerList[D$r];throw new Error("无法返回指定Layer,该name不存在")},D$m.isVisible=function(D$s){return 0!=(D$s&D$m._currentCameraCullingMask&D$m._visibleLayers)},D$m._layerList=[],D$m._visibleLayers=2147483647,D$m._collsionTestList=[],D$m._currentCameraCullingMask=2147483647,D$m.maxCount=31,D$m.currentCreationLayer=null,D$m}()),D$c=(function(){function D$s(D$s,D$r,D$e){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=D$s,this._minCount=D$r,this._maxCount=D$e}D$x(D$s,"laya.d3.core.particleShuriKen.module.Burst");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.cloneTo=function(D$s){var D$r=D$s;D$r._time=this._time,D$r._minCount=this._minCount,D$r._maxCount=this._maxCount},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"time",function(){return this._time}),D$B(0,D$r,"minCount",function(){return this._minCount}),D$B(0,D$r,"maxCount",function(){return this._maxCount})}(),function(){function D$s(D$s){this._color=null,this.enbale=!1,this._color=D$s}D$x(D$s,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var D$r=D$s.prototype;D$r.cloneTo=function(D$s){var D$r=D$s;this._color.cloneTo(D$r._color),D$r.enbale=this.enbale},D$r.clone=function(){var D$s;switch(this._color.type){case 0:D$s=D$v.createByConstant(this._color.constant.clone());break;case 1:D$s=D$v.createByGradient(this._color.gradient.clone());break;case 2:D$s=D$v.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:D$s=D$v.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var D$r=new this.constructor(D$s);return D$r.enbale=this.enbale,D$r},D$B(0,D$r,"color",function(){return this._color})}(),function(){function D$s(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}D$x(D$s,"laya.d3.core.particleShuriKen.module.Emission");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),D$r._destroy=function(){this._bursts=null,this._destroyed=!0},D$r.getBurstsCount=function(){return this._bursts.length},D$r.getBurstByIndex=function(D$s){return this._bursts[D$s]},D$r.addBurst=function(D$s){var D$r=this._bursts.length;if(0<D$r)for(var D$e=0;D$e<D$r;D$e++)this._bursts[D$e].time>D$s.time&&this._bursts.splice(D$e,0,D$s);this._bursts.push(D$s)},D$r.removeBurst=function(D$s){var D$r=this._bursts.indexOf(D$s);-1!==D$r&&this._bursts.splice(D$r,1)},D$r.removeBurstByIndex=function(D$s){this._bursts.splice(D$s,1)},D$r.clearBurst=function(){this._bursts.length=0},D$r.cloneTo=function(D$s){var D$r=D$s,D$e=D$r._bursts;D$e.length=this._bursts.length;for(var D$U=0,D$m=this._bursts.length;D$U<D$m;D$U++){var D$k=D$e[D$U];D$k?this._bursts[D$U].cloneTo(D$k):D$e[D$U]=this._bursts[D$U].clone()}D$r._emissionRate=this._emissionRate,D$r.enbale=this.enbale},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"destroyed",function(){return this._destroyed}),D$B(0,D$r,"emissionRate",function(){return this._emissionRate},function(D$s){if(D$s<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=D$s})}(),function(){function D$U(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}D$x(D$U,"laya.d3.core.particleShuriKen.module.FrameOverTime");var D$s=D$U.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.cloneTo=function(D$s){var D$r=D$s;D$r._type=this._type,D$r._constant=this._constant,this._overTime.cloneTo(D$r._overTime),D$r._constantMin=this._constantMin,D$r._constantMax=this._constantMax,this._overTimeMin.cloneTo(D$r._overTimeMin),this._overTimeMax.cloneTo(D$r._overTimeMax)},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$s,"frameOverTimeData",function(){return this._overTime}),D$B(0,D$s,"constant",function(){return this._constant}),D$B(0,D$s,"type",function(){return this._type}),D$B(0,D$s,"frameOverTimeDataMin",function(){return this._overTimeMin}),D$B(0,D$s,"constantMin",function(){return this._constantMin}),D$B(0,D$s,"frameOverTimeDataMax",function(){return this._overTimeMax}),D$B(0,D$s,"constantMax",function(){return this._constantMax}),D$U.createByConstant=function(D$s){var D$r=new D$U;return D$r._type=0,D$r._constant=D$s,D$r},D$U.createByOverTime=function(D$s){var D$r=new D$U;return D$r._type=1,D$r._overTime=D$s,D$r},D$U.createByRandomTwoConstant=function(D$s,D$r){var D$e=new D$U;return D$e._type=2,D$e._constantMin=D$s,D$e._constantMax=D$r,D$e},D$U.createByRandomTwoOverTime=function(D$s,D$r){var D$e=new D$U;return D$e._type=3,D$e._overTimeMin=D$s,D$e._overTimeMax=D$r,D$e},D$U}()),D$E=function(){function D$Z(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}D$x(D$Z,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var D$s=D$Z.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.cloneTo=function(D$s){var D$r=D$s;D$r._type=this._type,D$r._separateAxes=this._separateAxes,D$r._constant=this._constant,this._constantSeparate.cloneTo(D$r._constantSeparate),this._gradient.cloneTo(D$r._gradient),this._gradientX.cloneTo(D$r._gradientX),this._gradientY.cloneTo(D$r._gradientY),this._gradientZ.cloneTo(D$r._gradientZ),D$r._constantMin=this._constantMin,D$r._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(D$r._constantMinSeparate),this._constantMaxSeparate.cloneTo(D$r._constantMaxSeparate),this._gradientMin.cloneTo(D$r._gradientMin),this._gradientMax.cloneTo(D$r._gradientMax),this._gradientXMin.cloneTo(D$r._gradientXMin),this._gradientXMax.cloneTo(D$r._gradientXMax),this._gradientYMin.cloneTo(D$r._gradientYMin),this._gradientYMax.cloneTo(D$r._gradientYMax),this._gradientZMin.cloneTo(D$r._gradientZMin),this._gradientZMax.cloneTo(D$r._gradientZMax)},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$s,"gradientZ",function(){return this._gradientZ}),D$B(0,D$s,"constant",function(){return this._constant}),D$B(0,D$s,"gradient",function(){return this._gradient}),D$B(0,D$s,"separateAxes",function(){return this._separateAxes}),D$B(0,D$s,"type",function(){return this._type}),D$B(0,D$s,"constantSeparate",function(){return this._constantSeparate}),D$B(0,D$s,"gradientX",function(){return this._gradientX}),D$B(0,D$s,"gradientY",function(){return this._gradientY}),D$B(0,D$s,"gradientW",function(){return this._gradientW}),D$B(0,D$s,"gradientMin",function(){return this._gradientMin}),D$B(0,D$s,"constantMin",function(){return this._constantMin}),D$B(0,D$s,"gradientMax",function(){return this._gradientMax}),D$B(0,D$s,"constantMax",function(){return this._constantMax}),D$B(0,D$s,"gradientWMin",function(){return this._gradientWMin}),D$B(0,D$s,"constantMinSeparate",function(){return this._constantMinSeparate}),D$B(0,D$s,"constantMaxSeparate",function(){return this._constantMaxSeparate}),D$B(0,D$s,"gradientXMin",function(){return this._gradientXMin}),D$B(0,D$s,"gradientXMax",function(){return this._gradientXMax}),D$B(0,D$s,"gradientWMax",function(){return this._gradientWMax}),D$B(0,D$s,"gradientYMin",function(){return this._gradientYMin}),D$B(0,D$s,"gradientYMax",function(){return this._gradientYMax}),D$B(0,D$s,"gradientZMin",function(){return this._gradientZMin}),D$B(0,D$s,"gradientZMax",function(){return this._gradientZMax}),D$Z.createByConstant=function(D$s){var D$r=new D$Z;return D$r._type=0,D$r._separateAxes=!1,D$r._constant=D$s,D$r},D$Z.createByConstantSeparate=function(D$s){var D$r=new D$Z;return D$r._type=0,D$r._separateAxes=!0,D$r._constantSeparate=D$s,D$r},D$Z.createByGradient=function(D$s){var D$r=new D$Z;return D$r._type=1,D$r._separateAxes=!1,D$r._gradient=D$s,D$r},D$Z.createByGradientSeparate=function(D$s,D$r,D$e,D$U){var D$m=new D$Z;return D$m._type=1,D$m._separateAxes=!0,D$m._gradientX=D$s,D$m._gradientY=D$r,D$m._gradientZ=D$e,D$m._gradientW=D$U,D$m},D$Z.createByRandomTwoConstant=function(D$s,D$r){var D$e=new D$Z;return D$e._type=2,D$e._separateAxes=!1,D$e._constantMin=D$s,D$e._constantMax=D$r,D$e},D$Z.createByRandomTwoConstantSeparate=function(D$s,D$r){var D$e=new D$Z;return D$e._type=2,D$e._separateAxes=!0,D$e._constantMinSeparate=D$s,D$e._constantMaxSeparate=D$r,D$e},D$Z.createByRandomTwoGradient=function(D$s,D$r){var D$e=new D$Z;return D$e._type=3,D$e._separateAxes=!1,D$e._gradientMin=D$s,D$e._gradientMax=D$r,D$e},D$Z.createByRandomTwoGradientSeparate=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){var D$Y=new D$Z;return D$Y._type=3,D$Y._separateAxes=!0,D$Y._gradientXMin=D$s,D$Y._gradientXMax=D$r,D$Y._gradientYMin=D$e,D$Y._gradientYMax=D$U,D$Y._gradientZMin=D$m,D$Y._gradientZMax=D$k,D$Y._gradientWMin=D$j,D$Y._gradientWMax=D$T,D$Y},D$Z}(),D$v=function(){function D$U(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}D$x(D$U,"laya.d3.core.particleShuriKen.module.GradientColor");var D$s=D$U.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.cloneTo=function(D$s){var D$r=D$s;D$r._type=this._type,this._constant.cloneTo(D$r._constant),this._constantMin.cloneTo(D$r._constantMin),this._constantMax.cloneTo(D$r._constantMax),this._gradient.cloneTo(D$r._gradient),this._gradientMin.cloneTo(D$r._gradientMin),this._gradientMax.cloneTo(D$r._gradientMax)},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$s,"gradient",function(){return this._gradient}),D$B(0,D$s,"constant",function(){return this._constant}),D$B(0,D$s,"type",function(){return this._type}),D$B(0,D$s,"gradientMin",function(){return this._gradientMin}),D$B(0,D$s,"constantMin",function(){return this._constantMin}),D$B(0,D$s,"gradientMax",function(){return this._gradientMax}),D$B(0,D$s,"constantMax",function(){return this._constantMax}),D$U.createByConstant=function(D$s){var D$r=new D$U;return D$r._type=0,D$r._constant=D$s,D$r},D$U.createByGradient=function(D$s){var D$r=new D$U;return D$r._type=1,D$r._gradient=D$s,D$r},D$U.createByRandomTwoConstant=function(D$s,D$r){var D$e=new D$U;return D$e._type=2,D$e._constantMin=D$s,D$e._constantMax=D$r,D$e},D$U.createByRandomTwoGradient=function(D$s,D$r){var D$e=new D$U;return D$e._type=3,D$e._gradientMin=D$s,D$e._gradientMax=D$r,D$e},D$U}(),D$S=(function(){function D$s(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}D$x(D$s,"laya.d3.core.particleShuriKen.module.GradientDataColor");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.addAlpha=function(D$s,D$r){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==D$s&&(D$s=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=D$s,this._alphaElements[this._alphaCurrentLength++]=D$r):DEBUG},D$r.addRGB=function(D$s,D$r){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==D$s&&(D$s=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=D$s,this._rgbElements[this._rgbCurrentLength++]=D$r.x,this._rgbElements[this._rgbCurrentLength++]=D$r.y,this._rgbElements[this._rgbCurrentLength++]=D$r.z):DEBUG},D$r.cloneTo=function(D$s){var D$r=D$s,D$e=0,D$U=0;D$r._alphaCurrentLength=this._alphaCurrentLength;var D$m=D$r._alphaElements;for(D$m.length=this._alphaElements.length,D$e=0,D$U=this._alphaElements.length;D$e<D$U;D$e++)D$m[D$e]=this._alphaElements[D$e];D$r._rgbCurrentLength=this._rgbCurrentLength;var D$k=D$r._rgbElements;for(D$k.length=this._rgbElements.length,D$e=0,D$U=this._rgbElements.length;D$e<D$U;D$e++)D$k[D$e]=this._rgbElements[D$e]},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),D$B(0,D$r,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function D$s(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}D$x(D$s,"laya.d3.core.particleShuriKen.module.GradientDataInt");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.add=function(D$s,D$r){this._currentLength<8?(6===this._currentLength&&1!==D$s&&(D$s=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=D$s,this._elements[this._currentLength++]=D$r):console.log("Warning:data count must lessEqual than 4")},D$r.cloneTo=function(D$s){var D$r=D$s;D$r._currentLength=this._currentLength;var D$e=D$r._elements;D$e.length=this._elements.length;for(var D$U=0,D$m=this._elements.length;D$U<D$m;D$U++)D$e[D$U]=this._elements[D$U]},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"gradientCount",function(){return this._currentLength/2})}(),function(){function D$s(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}D$x(D$s,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.add=function(D$s,D$r){this._currentLength<8?(6===this._currentLength&&1!==D$s&&(D$s=1,DEBUG),this._elements[this._currentLength++]=D$s,this._elements[this._currentLength++]=D$r):DEBUG},D$r.getKeyByIndex=function(D$s){return this._elements[2*D$s]},D$r.getValueByIndex=function(D$s){return this._elements[2*D$s+1]},D$r.getAverageValue=function(){for(var D$s=0,D$r=this._currentLength-2;D$s<D$r;D$s+=2){this._elements[D$s+1];this._elements[D$s+3],this._elements[D$s+2]-this._elements[D$s]}return 0},D$r.cloneTo=function(D$s){var D$r=D$s;D$r._currentLength=this._currentLength;var D$e=D$r._elements;D$e.length=this._elements.length;for(var D$U=0,D$m=this._elements.length;D$U<D$m;D$U++)D$e[D$U]=this._elements[D$U]},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"gradientCount",function(){return this._currentLength/2})}(),function(){function D$s(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}D$x(D$s,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.add=function(D$s,D$r){this._currentLength<8?(6===this._currentLength&&1!==D$s&&(D$s=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=D$s,this._elements[this._currentLength++]=D$r.x,this._elements[this._currentLength++]=D$r.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},D$r.cloneTo=function(D$s){var D$r=D$s;D$r._currentLength=this._currentLength;var D$e=D$r._elements;D$e.length=this._elements.length;for(var D$U=0,D$m=this._elements.length;D$U<D$m;D$U++)D$e[D$U]=this._elements[D$U]},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"gradientCount",function(){return this._currentLength/3})}(),function(){function D$T(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}D$x(D$T,"laya.d3.core.particleShuriKen.module.GradientSize");var D$s=D$T.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.getMaxSizeInGradient=function(){var D$s=0,D$r=0,D$e=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(D$s=0,D$r=this._gradientX.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientX.getValueByIndex(D$s));for(D$s=0,D$r=this._gradientY.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientY.getValueByIndex(D$s))}else for(D$s=0,D$r=this._gradient.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradient.getValueByIndex(D$s));break;case 1:D$e=this._separateAxes?(D$e=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),D$e=Math.max(D$e,this._constantMinSeparate.y),Math.max(D$e,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(D$s=0,D$r=this._gradientXMin.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientXMin.getValueByIndex(D$s));for(D$s=0,D$r=this._gradientXMax.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientXMax.getValueByIndex(D$s));for(D$s=0,D$r=this._gradientYMin.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientYMin.getValueByIndex(D$s));for(D$s=0,D$r=this._gradientZMax.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientZMax.getValueByIndex(D$s))}else{for(D$s=0,D$r=this._gradientMin.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientMin.getValueByIndex(D$s));for(D$s=0,D$r=this._gradientMax.gradientCount;D$s<D$r;D$s++)D$e=Math.max(D$e,this._gradientMax.getValueByIndex(D$s))}}return D$e},D$s.cloneTo=function(D$s){var D$r=D$s;D$r._type=this._type,D$r._separateAxes=this._separateAxes,this._gradient.cloneTo(D$r._gradient),this._gradientX.cloneTo(D$r._gradientX),this._gradientY.cloneTo(D$r._gradientY),this._gradientZ.cloneTo(D$r._gradientZ),D$r._constantMin=this._constantMin,D$r._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(D$r._constantMinSeparate),this._constantMaxSeparate.cloneTo(D$r._constantMaxSeparate),this._gradientMin.cloneTo(D$r._gradientMin),this._gradientMax.cloneTo(D$r._gradientMax),this._gradientXMin.cloneTo(D$r._gradientXMin),this._gradientXMax.cloneTo(D$r._gradientXMax),this._gradientYMin.cloneTo(D$r._gradientYMin),this._gradientYMax.cloneTo(D$r._gradientYMax),this._gradientZMin.cloneTo(D$r._gradientZMin),this._gradientZMax.cloneTo(D$r._gradientZMax)},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$s,"gradientZ",function(){return this._gradientZ}),D$B(0,D$s,"gradient",function(){return this._gradient}),D$B(0,D$s,"separateAxes",function(){return this._separateAxes}),D$B(0,D$s,"type",function(){return this._type}),D$B(0,D$s,"gradientMin",function(){return this._gradientMin}),D$B(0,D$s,"constantMin",function(){return this._constantMin}),D$B(0,D$s,"gradientX",function(){return this._gradientX}),D$B(0,D$s,"gradientY",function(){return this._gradientY}),D$B(0,D$s,"gradientMax",function(){return this._gradientMax}),D$B(0,D$s,"constantMax",function(){return this._constantMax}),D$B(0,D$s,"constantMinSeparate",function(){return this._constantMinSeparate}),D$B(0,D$s,"constantMaxSeparate",function(){return this._constantMaxSeparate}),D$B(0,D$s,"gradientXMin",function(){return this._gradientXMin}),D$B(0,D$s,"gradientXMax",function(){return this._gradientXMax}),D$B(0,D$s,"gradientYMin",function(){return this._gradientYMin}),D$B(0,D$s,"gradientYMax",function(){return this._gradientYMax}),D$B(0,D$s,"gradientZMin",function(){return this._gradientZMin}),D$B(0,D$s,"gradientZMax",function(){return this._gradientZMax}),D$T.createByGradient=function(D$s){var D$r=new D$T;return D$r._type=0,D$r._separateAxes=!1,D$r._gradient=D$s,D$r},D$T.createByGradientSeparate=function(D$s,D$r,D$e){var D$U=new D$T;return D$U._type=0,D$U._separateAxes=!0,D$U._gradientX=D$s,D$U._gradientY=D$r,D$U._gradientZ=D$e,D$U},D$T.createByRandomTwoConstant=function(D$s,D$r){var D$e=new D$T;return D$e._type=1,D$e._separateAxes=!1,D$e._constantMin=D$s,D$e._constantMax=D$r,D$e},D$T.createByRandomTwoConstantSeparate=function(D$s,D$r){var D$e=new D$T;return D$e._type=1,D$e._separateAxes=!0,D$e._constantMinSeparate=D$s,D$e._constantMaxSeparate=D$r,D$e},D$T.createByRandomTwoGradient=function(D$s,D$r){var D$e=new D$T;return D$e._type=2,D$e._separateAxes=!1,D$e._gradientMin=D$s,D$e._gradientMax=D$r,D$e},D$T.createByRandomTwoGradientSeparate=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=new D$T;return D$j._type=2,D$j._separateAxes=!0,D$j._gradientXMin=D$s,D$j._gradientXMax=D$r,D$j._gradientYMin=D$e,D$j._gradientYMax=D$U,D$j._gradientZMin=D$m,D$j._gradientZMax=D$k,D$j},D$T}()),D$z=function(){function D$T(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}D$x(D$T,"laya.d3.core.particleShuriKen.module.GradientVelocity");var D$s=D$T.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.cloneTo=function(D$s){var D$r=D$s;D$r._type=this._type,this._constant.cloneTo(D$r._constant),this._gradientX.cloneTo(D$r._gradientX),this._gradientY.cloneTo(D$r._gradientY),this._gradientZ.cloneTo(D$r._gradientZ),this._constantMin.cloneTo(D$r._constantMin),this._constantMax.cloneTo(D$r._constantMax),this._gradientXMin.cloneTo(D$r._gradientXMin),this._gradientXMax.cloneTo(D$r._gradientXMax),this._gradientYMin.cloneTo(D$r._gradientYMin),this._gradientYMax.cloneTo(D$r._gradientYMax),this._gradientZMin.cloneTo(D$r._gradientZMin),this._gradientZMax.cloneTo(D$r._gradientZMax)},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$s,"gradientZ",function(){return this._gradientZ}),D$B(0,D$s,"constant",function(){return this._constant}),D$B(0,D$s,"type",function(){return this._type}),D$B(0,D$s,"gradientXMax",function(){return this._gradientXMax}),D$B(0,D$s,"constantMin",function(){return this._constantMin}),D$B(0,D$s,"gradientX",function(){return this._gradientX}),D$B(0,D$s,"gradientY",function(){return this._gradientY}),D$B(0,D$s,"gradientXMin",function(){return this._gradientXMin}),D$B(0,D$s,"constantMax",function(){return this._constantMax}),D$B(0,D$s,"gradientYMin",function(){return this._gradientYMin}),D$B(0,D$s,"gradientYMax",function(){return this._gradientYMax}),D$B(0,D$s,"gradientZMin",function(){return this._gradientZMin}),D$B(0,D$s,"gradientZMax",function(){return this._gradientZMax}),D$T.createByConstant=function(D$s){var D$r=new D$T;return D$r._type=0,D$r._constant=D$s,D$r},D$T.createByGradient=function(D$s,D$r,D$e){var D$U=new D$T;return D$U._type=1,D$U._gradientX=D$s,D$U._gradientY=D$r,D$U._gradientZ=D$e,D$U},D$T.createByRandomTwoConstant=function(D$s,D$r){var D$e=new D$T;return D$e._type=2,D$e._constantMin=D$s,D$e._constantMax=D$r,D$e},D$T.createByRandomTwoGradient=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=new D$T;return D$j._type=3,D$j._gradientXMin=D$s,D$j._gradientXMax=D$r,D$j._gradientYMin=D$e,D$j._gradientYMax=D$U,D$j._gradientZMin=D$m,D$j._gradientZMax=D$k,D$j},D$T}(),D$Q=(function(){function D$s(D$s){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=D$s}D$x(D$s,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.cloneTo=function(D$s){var D$r=D$s;this._angularVelocity.cloneTo(D$r._angularVelocity),D$r.enbale=this.enbale},D$r.clone=function(){var D$s;switch(this._angularVelocity.type){case 0:D$s=this._angularVelocity.separateAxes?D$E.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):D$E.createByConstant(this._angularVelocity.constant);break;case 1:D$s=this._angularVelocity.separateAxes?D$E.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):D$E.createByGradient(this._angularVelocity.gradient.clone());break;case 2:D$s=this._angularVelocity.separateAxes?D$E.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):D$E.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:D$s=this._angularVelocity.separateAxes?D$E.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):D$E.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var D$r=new this.constructor(D$s);return D$r.enbale=this.enbale,D$r},D$B(0,D$r,"angularVelocity",function(){return this._angularVelocity})}(),function(){function D$s(){this.enable=!1,this.randomDirection=!1}D$x(D$s,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r._getShapeBoundBox=function(D$s){throw new Error("BaseShape: must override it.")},D$r._getSpeedBoundBox=function(D$s){throw new Error("BaseShape: must override it.")},D$r.generatePositionAndDirection=function(D$s,D$r,D$e,D$U){throw new Error("BaseShape: must override it.")},D$r._calculateProceduralBounds=function(D$s,D$r,D$e){this._getShapeBoundBox(D$s);var D$U=D$s.min,D$m=D$s.max;D$jr.multiply(D$U,D$r,D$U),D$jr.multiply(D$m,D$r,D$m);var D$k=new D$Ls(new D$jr,new D$jr);this.randomDirection?(D$k.min=new D$jr(-1,-1,-1),D$k.max=new D$jr(1,1,1)):this._getSpeedBoundBox(D$k);var D$j=new D$Ls(new D$jr,new D$jr),D$T=D$j.min,D$Y=D$j.max;D$jr.scale(D$k.min,D$e.y,D$T),D$jr.scale(D$k.max,D$e.y,D$Y),D$jr.add(D$s.min,D$T,D$T),D$jr.add(D$s.max,D$Y,D$Y),D$jr.min(D$s.min,D$T,D$s.min),D$jr.max(D$s.max,D$T,D$s.max);var D$Z=new D$Ls(new D$jr,new D$jr),D$h=D$Z.min,D$H=D$Z.max;D$jr.scale(D$k.min,D$e.x,D$h),D$jr.scale(D$k.max,D$e.x,D$H),D$jr.min(D$Z.min,D$H,D$T),D$jr.max(D$Z.min,D$H,D$Y),D$jr.min(D$s.min,D$T,D$s.min),D$jr.max(D$s.max,D$T,D$s.max)},D$r.cloneTo=function(D$s){D$s.enable=this.enable},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$s}()),D$N=function(){function D$k(){}return D$x(D$k,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),D$k._randomPointUnitArcCircle=function(D$s,D$r,D$e){var D$U=D$r.elements,D$m=NaN;D$m=D$e?D$e.getFloat()*D$s:Math.random()*D$s,D$U[0]=Math.cos(D$m),D$U[1]=Math.sin(D$m)},D$k._randomPointInsideUnitArcCircle=function(D$s,D$r,D$e){var D$U=D$r.elements;D$k._randomPointUnitArcCircle(D$s,D$r,D$e);var D$m=NaN;D$m=D$e?Math.pow(D$e.getFloat(),.5):Math.pow(Math.random(),.5),D$U[0]=D$U[0]*D$m,D$U[1]=D$U[1]*D$m},D$k._randomPointUnitCircle=function(D$s,D$r){var D$e=D$s.elements,D$U=NaN;D$U=D$r?D$r.getFloat()*Math.PI*2:Math.random()*Math.PI*2,D$e[0]=Math.cos(D$U),D$e[1]=Math.sin(D$U)},D$k._randomPointInsideUnitCircle=function(D$s,D$r){var D$e=D$s.elements;D$k._randomPointUnitCircle(D$s);var D$U=NaN;D$U=D$r?Math.pow(D$r.getFloat(),.5):Math.pow(Math.random(),.5),D$e[0]=D$e[0]*D$U,D$e[1]=D$e[1]*D$U},D$k._randomPointUnitSphere=function(D$s,D$r){var D$e=D$s.elements,D$U=NaN,D$m=NaN;D$m=D$r?(D$U=D$e[2]=2*D$r.getFloat()-1,D$r.getFloat()*Math.PI*2):(D$U=D$e[2]=2*Math.random()-1,Math.random()*Math.PI*2);var D$k=Math.sqrt(1-D$U*D$U);D$e[0]=D$k*Math.cos(D$m),D$e[1]=D$k*Math.sin(D$m)},D$k._randomPointInsideUnitSphere=function(D$s,D$r){var D$e=D$s.elements;D$k._randomPointUnitSphere(D$s);var D$U=NaN;D$U=D$r?Math.pow(D$r.getFloat(),1/3):Math.pow(Math.random(),1/3),D$e[0]=D$e[0]*D$U,D$e[1]=D$e[1]*D$U,D$e[2]=D$e[2]*D$U},D$k._randomPointInsideHalfUnitBox=function(D$s,D$r){var D$e=D$s.elements;D$r?(D$e[0]=D$r.getFloat()-.5,D$e[1]=D$r.getFloat()-.5,D$e[2]=D$r.getFloat()-.5):(D$e[0]=Math.random()-.5,D$e[1]=Math.random()-.5,D$e[2]=Math.random()-.5)},D$k}(),D$q=(function(){function D$s(D$s){this._size=null,this.enbale=!1,this._size=D$s}D$x(D$s,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.cloneTo=function(D$s){var D$r=D$s;this._size.cloneTo(D$r._size),D$r.enbale=this.enbale},D$r.clone=function(){var D$s;switch(this._size.type){case 0:D$s=this._size.separateAxes?D$S.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):D$S.createByGradient(this._size.gradient.clone());break;case 1:D$s=this._size.separateAxes?D$S.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):D$S.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:D$s=this._size.separateAxes?D$S.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):D$S.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var D$r=new this.constructor(D$s);return D$r.enbale=this.enbale,D$r},D$B(0,D$r,"size",function(){return this._size})}(),function(){function D$U(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}D$x(D$U,"laya.d3.core.particleShuriKen.module.StartFrame");var D$s=D$U.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.cloneTo=function(D$s){var D$r=D$s;D$r._type=this._type,D$r._constant=this._constant,D$r._constantMin=this._constantMin,D$r._constantMax=this._constantMax},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$s,"constant",function(){return this._constant}),D$B(0,D$s,"type",function(){return this._type}),D$B(0,D$s,"constantMin",function(){return this._constantMin}),D$B(0,D$s,"constantMax",function(){return this._constantMax}),D$U.createByConstant=function(D$s){var D$r=new D$U;return D$r._type=0,D$r._constant=D$s,D$r},D$U.createByRandomTwoConstant=function(D$s,D$r){var D$e=new D$U;return D$e._type=1,D$e._constantMin=D$s,D$e._constantMax=D$r,D$e},D$U}()),D$G=(function(){function D$s(D$s,D$r){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new D$kr(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=D$s,this._startFrame=D$r}D$x(D$s,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.cloneTo=function(D$s){var D$r=D$s;this.tiles.cloneTo(D$r.tiles),D$r.type=this.type,D$r.randomRow=this.randomRow,this._frame.cloneTo(D$r._frame),this._startFrame.cloneTo(D$r._startFrame),D$r.cycles=this.cycles,D$r.enableUVChannels=this.enableUVChannels,D$r.enable=this.enable},D$r.clone=function(){var D$s,D$r;switch(this._frame.type){case 0:D$s=D$c.createByConstant(this._frame.constant);break;case 1:D$s=D$c.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:D$s=D$c.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:D$s=D$c.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:D$r=D$q.createByConstant(this._startFrame.constant);break;case 1:D$r=D$q.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var D$e=new this.constructor(D$s,D$r);return this.tiles.cloneTo(D$e.tiles),D$e.type=this.type,D$e.randomRow=this.randomRow,D$e.cycles=this.cycles,D$e.enableUVChannels=this.enableUVChannels,D$e.enable=this.enable,D$e},D$B(0,D$r,"frame",function(){return this._frame}),D$B(0,D$r,"startFrame",function(){return this._startFrame})}(),function(){function D$s(D$s){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=D$s}D$x(D$s,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.cloneTo=function(D$s){var D$r=D$s;this._velocity.cloneTo(D$r._velocity),D$r.enbale=this.enbale,D$r.space=this.space},D$r.clone=function(){var D$s;switch(this._velocity.type){case 0:D$s=D$z.createByConstant(this._velocity.constant.clone());break;case 1:D$s=D$z.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:D$s=D$z.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:D$s=D$z.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var D$r=new this.constructor(D$s);return D$r.enbale=this.enbale,D$r.space=this.space,D$r},D$B(0,D$r,"velocity",function(){return this._velocity})}(),function(){function D$s(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new D$Ar,this._vb=D$Qr.create(D$s._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=D$zr.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=D$vr.nameKey.getID("LINE"),this._shaderCompile=D$nr._preCompileShader[this._sharderNameID]}D$x(D$s,"laya.d3.core.PhasorSpriter3D");var D$r=D$s.prototype;return D$r.line=function(D$s,D$r,D$e,D$U){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(D$s.x,D$s.y,D$s.z,D$r.x,D$r.y,D$r.z,D$r.w),this.addVertex(D$e.x,D$e.y,D$e.z,D$U.x,D$U.y,D$U.z,D$U.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},D$r.circle=function(D$s,D$r,D$e,D$U,D$m,D$k){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*D$r,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/D$r,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*D$s,Math.cos(this._tempNumver0)*D$s,0,D$e,D$U,D$m,D$k),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},D$r.plane=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=D$U/2,this._tempNumver1=D$m/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(D$s-this._tempNumver0,D$r+this._tempNumver1,D$e,D$k,D$j,D$T,D$Y),this.addVertex(D$s+this._tempNumver0,D$r+this._tempNumver1,D$e,D$k,D$j,D$T,D$Y),this.addVertex(D$s-this._tempNumver0,D$r-this._tempNumver1,D$e,D$k,D$j,D$T,D$Y),this.addVertex(D$s+this._tempNumver0,D$r-this._tempNumver1,D$e,D$k,D$j,D$T,D$Y),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},D$r.box=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=D$U/2,this._tempNumver1=D$m/2,this._tempNumver2=D$k/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(D$s-this._tempNumver0,D$r+this._tempNumver1,D$e+this._tempNumver2,D$j,D$T,D$Y,D$Z),this.addVertex(D$s+this._tempNumver0,D$r+this._tempNumver1,D$e+this._tempNumver2,D$j,D$T,D$Y,D$Z),this.addVertex(D$s-this._tempNumver0,D$r-this._tempNumver1,D$e+this._tempNumver2,D$j,D$T,D$Y,D$Z),this.addVertex(D$s+this._tempNumver0,D$r-this._tempNumver1,D$e+this._tempNumver2,D$j,D$T,D$Y,D$Z),this.addVertex(D$s+this._tempNumver0,D$r+this._tempNumver1,D$e-this._tempNumver2,D$j,D$T,D$Y,D$Z),this.addVertex(D$s-this._tempNumver0,D$r+this._tempNumver1,D$e-this._tempNumver2,D$j,D$T,D$Y,D$Z),this.addVertex(D$s+this._tempNumver0,D$r-this._tempNumver1,D$e-this._tempNumver2,D$j,D$T,D$Y,D$Z),this.addVertex(D$s-this._tempNumver0,D$r-this._tempNumver1,D$e-this._tempNumver2,D$j,D$T,D$Y,D$Z),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},D$r.cone=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*D$e+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*D$e>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/D$e,this.addVertexIndex(0,D$r,0,D$U,D$m,D$k,D$j,this._tempUint0),this.addVertexIndex(0,0,0,D$U,D$m,D$k,D$j,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<D$e;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(D$s*this._tempNumver2,0,D$s*this._tempNumver3,D$U,D$m,D$k,D$j,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==D$e-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(D$s*this._tempNumver2,0,D$s*this._tempNumver3,D$U,D$m,D$k,D$j,this._tempUint0+(this._tempInt0+D$e)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==D$e-1?this.addIndexes(this._tempUint1+D$e+2):this.addIndexes(this._tempUint1+this._tempInt0+D$e+1),this.addIndexes(this._tempUint1+this._tempInt0+D$e),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},D$r.boundingBoxLine=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(D$s,D$m,D$k,D$j,D$T,D$Y,D$Z),this.addVertex(D$U,D$m,D$k,D$j,D$T,D$Y,D$Z),this.addVertex(D$s,D$r,D$k,D$j,D$T,D$Y,D$Z),this.addVertex(D$U,D$r,D$k,D$j,D$T,D$Y,D$Z),this.addVertex(D$U,D$m,D$e,D$j,D$T,D$Y,D$Z),this.addVertex(D$s,D$m,D$e,D$j,D$T,D$Y,D$Z),this.addVertex(D$U,D$r,D$e,D$j,D$T,D$Y,D$Z),this.addVertex(D$s,D$r,D$e,D$j,D$T,D$Y,D$Z),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},D$r.addVertex=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=D$s,this._vbData[this._posInVBData+1]=D$r,this._vbData[this._posInVBData+2]=D$e,this._vbData[this._posInVBData+3]=D$U,this._vbData[this._posInVBData+4]=D$m,this._vbData[this._posInVBData+5]=D$k,this._vbData[this._posInVBData+6]=D$j,this._posInVBData+=this._floatSizePerVer,this},D$r.addVertexIndex=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){return this._hasBegun||this.addVertexIndexException(),this._vbData[D$T]=D$s,this._vbData[D$T+1]=D$r,this._vbData[D$T+2]=D$e,this._vbData[D$T+3]=D$U,this._vbData[D$T+4]=D$m,this._vbData[D$T+5]=D$k,this._vbData[D$T+6]=D$j,(D$T+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=D$T),this},D$r.addIndexes=function(D$s){var D$r=arguments;this._hasBegun||this.addVertexIndexException();for(var D$e=0;D$e<D$r.length;D$e++)this._ibData[this._posInIBData]=D$r[D$e],this._posInIBData++;return this},D$r.begin=function(D$s,D$r){return this._hasBegun&&this.beginException0(),1!==D$s&&4!==D$s&&this.beginException1(),this._primitiveType=D$s,this._camera=D$r,this._hasBegun=!0,this},D$r.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},D$r.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(D$s._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),D$n.drawCall++,D$P.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},D$r.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},D$r.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},D$r.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},D$r.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},D$r.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},D$r.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(28,[new D$js(0,"vector3",0),new D$js(12,"vector4",1)])}]),D$s}()),D$d=function(){function D$s(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++D$s._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new D$Ar}D$x(D$s,"laya.d3.core.render.RenderElement");var D$r=D$s.prototype;return D$r.getDynamicBatchBakedVertexs=function(D$s){for(var D$r=this._renderObj._getVertexBuffer(D$s),D$e=D$r.getData().slice(),D$U=D$r.vertexDeclaration,D$m=D$U.getVertexElementByUsage(0).offset/4,D$k=D$U.getVertexElementByUsage(3).offset/4,D$j=this._sprite3D.transform,D$T=D$j.worldMatrix,D$Y=D$j.rotation,D$Z=D$U.vertexStride/4,D$h=0,D$H=D$e.length;D$h<D$H;D$h+=D$Z){var D$A=D$h+D$m,D$x=D$h+D$k;D$lr.transformVector3ArrayToVector3ArrayCoordinate(D$e,D$A,D$T,D$e,D$A),D$lr.transformVector3ArrayByQuat(D$e,D$x,D$Y,D$e,D$x)}return D$e},D$r.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},D$r._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},D$B(0,D$r,"id",function(){return this._id}),D$B(0,D$r,"renderObj",function(){return this._renderObj},function(D$s){this._renderObj!==D$s&&(this._renderObj=D$s)}),D$s._uniqueIDCounter=0,D$s}(),D$t=function(){function D$r(D$s){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++D$r._uniqueIDCounter,this._needSort=!1,this._scene=D$s,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}D$x(D$r,"laya.d3.core.render.RenderQueue");var D$s=D$r.prototype;return D$s._sortOpaqueFunc=function(D$s,D$r){if(D$s._render&&D$r._render){var D$e=D$s._material.renderQueue-D$r._material.renderQueue;return 0==D$e?D$s._render._distanceForSort-D$r._render._distanceForSort:D$e}return 0},D$s._sortAlphaFunc=function(D$s,D$r){if(D$s._render&&D$r._render){var D$e=D$s._material.renderQueue-D$r._material.renderQueue;return 0==D$e?D$r._render._distanceForSort-D$s._render._distanceForSort:D$e}return 0},D$s._begainRenderElement=function(D$s,D$r,D$e){return!!D$r._beforeRender(D$s)},D$s._sortAlpha=function(D$s){D$r._cameraPosition=D$s,this._finalElements.sort(this._sortAlphaFunc)},D$s._sortOpaque=function(D$s){D$r._cameraPosition=D$s,this._finalElements.sort(this._sortOpaqueFunc)},D$s._preRender=function(D$s){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},D$s._render=function(D$s,D$r){for(var D$e,D$U,D$m,D$k,D$j,D$T,D$Y=D$n.loopCount,D$Z=this._scene,D$h=D$s.camera,D$H=(D$h.id,!1),D$A=0,D$x=this._finalElements.length;D$A<D$x;D$A++){var D$B,D$$,D$l,D$V=this._finalElements[D$A];if(null!=D$V._onPreRenderFunction&&D$V._onPreRenderFunction.call(D$V._sprite3D,D$s),0===D$V._type){if(D$s.owner=D$l=D$V._sprite3D,D$s.renderElement=D$V,D$l._preRenderUpdateComponents(D$s),D$B=D$V.renderObj,D$$=D$V._material,this._begainRenderElement(D$s,D$B,D$$)){if(D$e=D$B._getVertexBuffers(),!(D$m=(D$U=D$B._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[D$U.id]){this._errorRecord[D$U.id]=1;var D$b="vertexBuffer:"+("("+D$U._destroyed+","+D$U._released+","+D$U._referenceCount+","+D$U._buffer+")")+", material:"+(D$$?D$$.__className+"("+D$$._destroyed+","+D$$._released+")":"null")+", owner:"+(D$l?D$l.__className+"("+D$l._destroyed+","+D$l._activeInHierarchy+","+D$l._displayedInStage+")":"null")+", renderObj:"+(D$B?D$B.__className+"("+D$B._destroyed+","+D$B._released+","+D$B._referenceCount+")":"")+", parent:, url:"+(D$l?D$l.url:"")+", disposeStack:"+D$U.disposeStack;D$w.recordError("报错：unknown vertexDeclaration  "+D$b)}continue}if(D$H=(D$k=D$s._shader=D$$._getShader(D$Z._shaderDefineValue,D$m.shaderDefineValue,D$l._shaderDefineValue)).bind()||D$Y!==D$k._uploadLoopCount,D$e){if(D$k._uploadVertexBuffer!==D$e||D$H){for(var D$o=0;D$o<D$e.length;D$o++){var D$I=D$e[D$o];D$k.uploadAttributesX(D$I.vertexDeclaration.shaderValues.data,D$I)}D$k._uploadVertexBuffer=D$e}}else(D$k._uploadVertexBuffer!==D$U||D$H)&&(D$k.uploadAttributes(D$m.shaderValues.data,null),D$k._uploadVertexBuffer=D$U);(D$k._uploadScene!==D$Z||D$H)&&(D$k.uploadSceneUniforms(D$Z._shaderValues.data),D$k._uploadScene=D$Z),(D$h!==D$k._uploadCamera||D$k._uploadSprite3D!==D$l||D$H)&&(D$k.uploadSpriteUniforms(D$l._shaderValues.data),D$k._uploadSprite3D=D$l),(D$h!==D$k._uploadCamera||D$H)&&(D$k.uploadCameraUniforms(D$h._shaderValues.data),D$k._uploadCamera=D$h),(D$k._uploadMaterial!==D$$||D$H)&&(D$$._upload(),D$k._uploadMaterial=D$$),D$j!==D$$?(D$$._setRenderStateBlendDepth(),D$$._setRenderStateFrontFace(D$r,D$l.transform),D$j=D$$,D$T=D$l):D$T!==D$l&&(D$$._setRenderStateFrontFace(D$r,D$l.transform),D$T=D$l),D$B._render(D$s),D$k._uploadLoopCount=D$Y}D$l._postRenderUpdateComponents(D$s)}else if(2===D$V._type){D$V.renderObj;D$s.owner=D$l=D$V._sprite3D,D$s.renderElement=D$V,D$s._batchIndexStart=D$V._tempBatchIndexStart,D$s._batchIndexEnd=D$V._tempBatchIndexEnd,D$B=D$V.renderObj,D$$=D$V._material,this._begainRenderElement(D$s,D$B,D$$)&&(D$m=(D$U=D$B._getVertexBuffer(0)).vertexDeclaration,D$H=(D$k=D$s._shader=D$$._getShader(D$Z._shaderDefineValue,D$m.shaderDefineValue,D$l._shaderDefineValue)).bind()||D$Y!==D$k._uploadLoopCount,(D$k._uploadVertexBuffer!==D$U||D$H)&&(D$k.uploadAttributes(D$m.shaderValues.data,null),D$k._uploadVertexBuffer=D$U),(D$k._uploadScene!==D$Z||D$H)&&(D$k.uploadSceneUniforms(D$Z._shaderValues.data),D$k._uploadScene=D$Z),(D$h!==D$k._uploadCamera||D$k._uploadSprite3D!==D$l||D$H)&&(D$k.uploadSpriteUniforms(D$l._shaderValues.data),D$k._uploadSprite3D=D$l),(D$h!==D$k._uploadCamera||D$H)&&(D$k.uploadCameraUniforms(D$h._shaderValues.data),D$k._uploadCamera=D$h),(D$k._uploadMaterial!==D$$||D$H)&&(D$$._upload(),D$k._uploadMaterial=D$$),D$j!==D$$?(D$$._setRenderStateBlendDepth(),D$$._setRenderStateFrontFace(D$r,D$l.transform),D$j=D$$,D$T=D$l):D$T!==D$l&&(D$$._setRenderStateFrontFace(D$r,D$l.transform),D$T=D$l),D$B._render(D$s),D$k._uploadLoopCount=D$Y)}}},D$s._renderShadow=function(D$s,D$r){for(var D$e,D$U,D$m,D$k,D$j,D$T=D$n.loopCount,D$Y=this._scene,D$Z=D$s.camera,D$h=!1,D$H=0,D$A=this._finalElements.length;D$H<D$A;D$H++){var D$x,D$B,D$$,D$l=this._finalElements[D$H];0===D$l._type&&(D$s.owner=D$$=D$l._sprite3D,D$r||D$$._projectionViewWorldUpdateCamera===D$Z&&D$$._projectionViewWorldUpdateLoopCount===D$n.loopCount||(D$$._render._renderUpdate(D$s._projectionViewMatrix),D$$._projectionViewWorldUpdateLoopCount=D$n.loopCount,D$$._projectionViewWorldUpdateCamera=D$Z),D$s.renderElement=D$l,D$$._preRenderUpdateComponents(D$s),D$x=D$l.renderObj,D$B=D$l._material,this._begainRenderElement(D$s,D$x,null)&&(D$U=(D$e=D$x._getVertexBuffer(0)).vertexDeclaration,D$h=(D$m=D$s._shader=D$B._getShader(D$Y._shaderDefineValue,D$U.shaderDefineValue,D$$._shaderDefineValue)).bind()||D$T!==D$m._uploadLoopCount,(D$m._uploadVertexBuffer!==D$e||D$h)&&(D$m.uploadAttributes(D$U.shaderValues.data,null),D$m._uploadVertexBuffer=D$e),(D$Z!==D$m._uploadCamera||D$m._uploadSprite3D!==D$$||D$h)&&(D$m.uploadSpriteUniforms(D$$._shaderValues.data),D$m._uploadSprite3D=D$$),(D$Z!==D$m._uploadCamera||D$h)&&(D$m.uploadCameraUniforms(D$Z._shaderValues.data),D$m._uploadCamera=D$Z),(D$m._uploadMaterial!==D$B||D$h)&&(D$B._upload(),D$m._uploadMaterial=D$B),D$m._uploadRenderElement,D$k!==D$B?(D$B._setRenderStateFrontFace(!1,D$$.transform),D$k=D$B,D$j=D$$):D$j!==D$$&&(D$B._setRenderStateFrontFace(!1,D$$.transform),D$j=D$$),D$x._render(D$s),D$m._uploadLoopCount=D$T),D$$._postRenderUpdateComponents(D$s))}},D$s._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},D$s._addRenderElement=function(D$s){this._renderElements.push(D$s),this._needSort=!0},D$s._addDynamicBatchElement=function(D$s){this._dynamicBatchCombineRenderElements.push(D$s)},D$B(0,D$s,"id",function(){return this._id}),D$r._uniqueIDCounter=0,D$r._cameraPosition=null,D$r}(),D$W=function(){function D$s(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return D$x(D$s,"laya.d3.core.render.RenderState"),D$s.clientWidth=0,D$s.clientHeight=0,D$s}(),D$L=function(){function D$j(D$s,D$r){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new D$Ms(new D$jr,0),this._corners=[new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr],this._boundingBoxCenter=new D$jr,this._children=D$U(8),this._objects=[],this._tempBoundBoxCorners=[new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr],this._scene=D$s,this._currentDepth=D$r}D$x(D$j,"laya.d3.core.scene.OctreeNode");var D$s=D$j.prototype;return D$w.imps(D$s,{"laya.d3.core.scene.ITreeNode":!0}),D$s.init=function(D$s,D$r){var D$e=new D$jr,D$U=new D$jr;D$jr.scale(D$r,-.5,D$e),D$jr.scale(D$r,.5,D$U),D$jr.add(D$e,D$s,D$e),D$jr.add(D$U,D$s,D$U),this.exactBox=new D$Ls(D$e,D$U),this.relaxBox=new D$Ls(D$e,D$U)},D$s.addTreeNode=function(D$s){1===Collision.boxContainsBox(this._relaxBox,D$s.boundingBox)?this.addNodeDown(D$s,0):this.addObject(D$s)},D$s.addChild=function(D$s){var D$r=this._children[D$s];if(null==D$r){D$r=new D$j(this._scene,this._currentDepth+1),(this._children[D$s]=D$r)._parent=this,D$jr.subtract(this._exactBox.max,this._exactBox.min,D$j.tempSize),D$jr.multiply(D$j.tempSize,D$j._octreeSplit[D$s],D$j.tempCenter),D$jr.add(this._exactBox.min,D$j.tempCenter,D$j.tempCenter),D$jr.scale(D$j.tempSize,.25,D$j.tempSize);var D$e=new D$jr,D$U=new D$jr;D$jr.subtract(D$j.tempCenter,D$j.tempSize,D$e),D$jr.add(D$j.tempCenter,D$j.tempSize,D$U),D$r.exactBox=new D$Ls(D$e,D$U),D$jr.scale(D$j.tempSize,D$j.relax,D$j.tempSize);var D$m=new D$jr,D$k=new D$jr;D$jr.subtract(D$j.tempCenter,D$j.tempSize,D$m),D$jr.add(D$j.tempCenter,D$j.tempSize,D$k),D$r.relaxBox=new D$Ls(D$m,D$k)}return D$r},D$s.addObject=function(D$s){(D$s._treeNode=this)._objects.push(D$s)},D$s.removeObject=function(D$s){if(D$s._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var D$r=this._objects.indexOf(D$s);return-1!==D$r&&(this._objects.splice(D$r,1),!0)},D$s.clearObject=function(){this._objects.length=0},D$s.addNodeUp=function(D$s,D$r){this._parent&&1!==Collision.boxContainsBox(this._exactBox,D$s.boundingBox)?this._parent.addNodeUp(D$s,D$r-1):this.addNodeDown(D$s,D$r)},D$s.addNodeDown=function(D$s,D$r){if(D$r<this._scene.treeLevel){var D$e=this.inChildIndex(D$s.boundingBoxCenter),D$U=this.addChild(D$e);1===Collision.boxContainsBox(D$U._relaxBox,D$s.boundingBox)?D$U.addNodeDown(D$s,++D$r):this.addObject(D$s)}else this.addObject(D$s)},D$s.inChildIndex=function(D$s){return 4*(D$s.z<this._boundingBoxCenter.z?0:1)+2*(D$s.y<this._boundingBoxCenter.y?0:1)+(D$s.x<this._boundingBoxCenter.x?0:1)},D$s.updateObject=function(D$s){1===Collision.boxContainsBox(this._relaxBox,D$s.boundingBox)?(this.removeObject(D$s),D$s._treeNode=null,this.addNodeDown(D$s,this._currentDepth)):this._parent&&(this.removeObject(D$s),D$s._treeNode=null,this._parent.addNodeUp(D$s,this._currentDepth-1))},D$s.cullingObjects=function(D$s,D$r,D$e,D$U,D$m){var D$k,D$j=0,D$T=0,D$Y=0,D$Z=this._scene._dynamicBatchManager;for(D$j=0,D$k=this._objects.length;D$j<D$k;D$j++){var D$h=this._objects[D$j];if(D$K.isVisible(D$h._owner.layer.mask)&&D$h.enable){if(D$r&&(D$n.treeSpriteCollision+=1,0===D$s.containsBoundSphere(D$h.boundingSphere)))continue;D$h._renderUpdate(D$m),D$h._distanceForSort=D$jr.distance(D$h.boundingSphere.center,D$U)+D$h.sortingFudge;var D$H=D$h._renderElements;for(D$T=0,D$Y=D$H.length;D$T<D$Y;D$T++){var D$A=D$H[D$T],D$x=D$A._staticBatch;if(D$x&&D$x._material===D$A._material)D$x._addBatchRenderElement(D$A);else{var D$B=D$A.renderObj;D$B.triangleCount<10&&1===D$B._vertexBufferCount&&D$B._getIndexBuffer()&&D$A._material.renderQueue<2&&D$A._canDynamicBatch&&!D$h._owner.isStatic?D$Z._addPrepareRenderElement(D$A):this._scene.getRenderQueue(D$A._material.renderQueue)._addRenderElement(D$A)}}}}for(D$j=0;D$j<8;D$j++){var D$$=this._children[D$j];if(null!=D$$){var D$l=D$r;if(D$r){var D$V=D$s.containsBoundBox(D$$._relaxBox);if(D$n.treeNodeCollision+=1,0===D$V)continue;D$l=2===D$V}D$$.cullingObjects(D$s,D$l,D$e,D$U,D$m)}}},D$s.cullingShadowObjects=function(D$s,D$r,D$e,D$U,D$m){var D$k,D$j=0,D$T=0,D$Y=0;this._scene._dynamicBatchManager;for(D$j=0,D$k=this._objects.length;D$j<D$k;D$j++){var D$Z=this._objects[D$j];if(D$Z.castShadow&&D$K.isVisible(D$Z._owner.layer.mask)&&D$Z.enable){if(D$e&&0===D$s[0].containsBoundSphere(D$Z.boundingSphere))continue;for(var D$h=1,D$H=D$s.length;D$h<D$H;D$h++){var D$A=D$r[D$h-1];if(0!==D$s[D$h].containsBoundSphere(D$Z.boundingSphere)){var D$x=D$Z._renderElements;for(D$T=0,D$Y=D$x.length;D$T<D$Y;D$T++)D$A._addRenderElement(D$x[D$T])}}}}for(D$j=0;D$j<8;D$j++){var D$B=this._children[D$j];if(null!=D$B){var D$$=D$e;if(D$e){var D$l=D$s[0].containsBoundBox(D$B._relaxBox);if(0===D$l)continue;D$$=2===D$l}D$B.cullingShadowObjects(D$s,D$r,D$$,D$U,D$m)}}},D$s.cullingShadowObjectsOnePSSM=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j,D$T=D$r[0],D$Y=0,D$Z=0,D$h=0;for(D$Y=0,D$j=this._objects.length;D$Y<D$j;D$Y++){var D$H=this._objects[D$Y];if(D$H.castShadow&&D$K.isVisible(D$H._owner.layer.mask)&&D$H.enable){if(D$U&&0===D$s.containsBoundSphere(D$H.boundingSphere))continue;D$H._renderUpdate(D$e);var D$A=D$H._renderElements;for(D$Z=0,D$h=D$A.length;D$Z<D$h;D$Z++)D$T._addRenderElement(D$A[D$Z])}}for(D$Y=0;D$Y<8;D$Y++){var D$x=this._children[D$Y];if(null!=D$x){var D$B=D$U;if(D$U){var D$$=D$s.containsBoundBox(D$x._relaxBox);if(0===D$$)continue;D$B=2===D$$}D$x.cullingShadowObjectsOnePSSM(D$s,D$r,D$e,D$B,D$m,D$k)}}},D$s.renderBoudingBox=function(D$s){this._renderBoudingBox(D$s);for(var D$r=0;D$r<8;++D$r){var D$e=this._children[D$r];D$e&&D$e.renderBoudingBox(D$s)}},D$s.buildAllChild=function(D$s){if(D$s<this._scene.treeLevel)for(var D$r=0;D$r<8;D$r++){this.addChild(D$r).buildAllChild(D$s+1)}},D$s._renderBoudingBox=function(D$s){},D$B(0,D$s,"exactBox",function(){return this._exactBox},function(D$s){this._exactBox=D$s,D$jr.add(D$s.min,D$s.max,this._boundingBoxCenter),D$jr.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),D$B(0,D$s,"relaxBox",function(){return this._relaxBox},function(D$s){(this._relaxBox=D$s).getCorners(this._corners),D$Ms.createfromPoints(this._corners,this._boundingSphere)}),D$j.debugMode=!1,D$j.relax=1.15,D$j.CHILDNUM=8,D$H(D$j,["tempVector0",function(){return this.tempVector0=new D$jr},"tempSize",function(){return this.tempSize=new D$jr},"tempCenter",function(){return this.tempCenter=new D$jr},"_octreeSplit",function(){return this._octreeSplit=[new D$jr(.25,.25,.25),new D$jr(.75,.25,.25),new D$jr(.25,.75,.25),new D$jr(.75,.75,.25),new D$jr(.25,.25,.75),new D$jr(.75,.25,.75),new D$jr(.25,.75,.75),new D$jr(.75,.75,.75)]}]),D$j}(),D$u=(function(){function D$s(){}D$x(D$s,"laya.d3.core.scene.SceneManager")}(),function(){function D$s(D$s,D$r,D$e,D$U){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===D$s&&(D$s=1),void 0===D$r&&(D$r=1),void 0===D$e&&(D$e=1),void 0===D$U&&(D$U=1),this._r=D$s,this._g=D$r,this._b=D$e,this._a=D$U}return D$x(D$s,"laya.d3.core.trail.module.Color",null,"Color$1"),D$s.prototype.cloneTo=function(D$s){D$s._r=this._r,D$s._g=this._g,D$s._b=this._b,D$s._a=this._a},D$H(D$s,["RED",function(){return this.RED=new D$s(1,0,0,1)},"GREEN",function(){return this.GREEN=new D$s(0,1,0,1)},"BLUE",function(){return this.BLUE=new D$s(0,0,1,1)},"CYAN",function(){return this.CYAN=new D$s(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new D$s(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new D$s(1,0,1,1)},"GRAY",function(){return this.GRAY=new D$s(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new D$s(1,1,1,1)},"BLACK",function(){return this.BLACK=new D$s(0,0,0,1)}]),D$s}()),D$M=(function(){function D$s(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}D$x(D$s,"laya.d3.core.trail.module.Gradient");var D$r=D$s.prototype;D$r.setKeys=function(D$s,D$r){var D$e,D$U;this._colorKeys=D$s;for(var D$m=this.index=0;D$m<D$s.length;D$m++){var D$k=(D$e=D$s[D$m]).color;this._colorKeyData[this.index++]=D$k._r,this._colorKeyData[this.index++]=D$k._g,this._colorKeyData[this.index++]=D$k._b,this._colorKeyData[this.index++]=D$e.time}this._alphaKeys=D$r;for(var D$j=this.index=0;D$j<D$r.length;D$j++)D$U=D$r[D$j],this._alphaKeyData[this.index++]=D$U.alpha,this._alphaKeyData[this.index++]=D$U.time},D$r.cloneTo=function(D$s){var D$r=0,D$e=0,D$U=this.colorKeys,D$m=[];for(D$r=0,D$e=D$U.length;D$r<D$e;D$r++){var D$k=new D$_;D$U[D$r].cloneTo(D$k),D$m.push(D$k)}var D$j=this.alphaKeys,D$T=[];for(D$r=0,D$e=D$j.length;D$r<D$e;D$r++){var D$Y=new D$M;D$j[D$r].cloneTo(D$Y),D$T.push(D$Y)}D$s.setKeys(D$m,D$T)},D$B(0,D$r,"mode",function(){return this._mode},function(D$s){this._mode=D$s}),D$B(0,D$r,"colorKeys",function(){return this._colorKeys},function(D$s){this._colorKeys=D$s;for(var D$r=this.index=0;D$r<D$s.length;D$r++){var D$e=D$s[D$r],D$U=D$e.color;this._colorKeyData[this.index++]=D$U._r,this._colorKeyData[this.index++]=D$U._g,this._colorKeyData[this.index++]=D$U._b,this._colorKeyData[this.index++]=D$e.time}}),D$B(0,D$r,"alphaKeys",function(){return this._alphaKeys},function(D$s){this._alphaKeys=D$s;for(var D$r=this.index=0;D$r<D$s.length;D$r++){var D$e=D$s[D$r];this._alphaKeyData[this.index++]=D$e.alpha,this._alphaKeyData[this.index++]=D$e.time}})}(),function(){function D$s(D$s,D$r){this._alpha=NaN,this._time=NaN,void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),this._alpha=D$s,this._time=D$r}D$x(D$s,"laya.d3.core.trail.module.GradientAlphaKey");var D$r=D$s.prototype;return D$r.cloneTo=function(D$s){D$s.alpha=this.alpha,D$s.time=this.time},D$B(0,D$r,"alpha",function(){return this._alpha},function(D$s){this._alpha=D$s}),D$B(0,D$r,"time",function(){return this._time},function(D$s){this._time=D$s}),D$s}()),D$_=function(){function D$s(D$s,D$r){this._color=null,this._time=NaN,void 0===D$r&&(D$r=0),this._color=D$s||new D$u,this._time=D$r}D$x(D$s,"laya.d3.core.trail.module.GradientColorKey");var D$r=D$s.prototype;return D$r.cloneTo=function(D$s){this.color.cloneTo(D$s.color),D$s.time=this.time},D$B(0,D$r,"color",function(){return this._color},function(D$s){this._color=D$s}),D$B(0,D$r,"time",function(){return this._time},function(D$s){this._time=D$s}),D$s}(),D$F=(function(){function D$s(){}D$x(D$s,"laya.d3.core.trail.module.GradientMode"),D$s.Blend=0,D$s.Fixed=1}(),function(){function D$s(){}D$x(D$s,"laya.d3.core.trail.module.TextureMode"),D$s.Stretch=0,D$s.Tile=1}(),function(){function D$s(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}D$x(D$s,"laya.d3.core.trail.module.TrailKeyFrame"),D$s.prototype.cloneTo=function(D$s){D$s.time=this.time,D$s.inTangent=this.inTangent,D$s.outTangent=this.outTangent,D$s.value=this.value}}(),function(){function D$r(D$s){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new D$jr,this._curPosition=new D$jr,this._delVector3=new D$jr,this._lastFixedVertexPosition=new D$jr,this._pointAtoBVector3=new D$jr,this._pointA=new D$jr,this._pointB=new D$jr,this._owner=D$s,this._id=D$r.renderElementCount++,0==this._id?D$s._owner.transform.position.cloneTo(this._lastPosition):D$s._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new D$Qr(D$F.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new D$Qr(D$F.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}D$x(D$r,"laya.d3.core.trail.TrailRenderElement");var D$s=D$r.prototype;D$w.imps(D$s,{"laya.d3.core.render.IRenderable":!0}),D$s._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},D$s._addTrailByFirstPosition=function(D$s,D$r){D$jr.subtract(D$r,D$s,this._delVector3),D$jr.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),D$jr.normalize(this._pointAtoBVector3,this._pointAtoBVector3),D$jr.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(D$s),D$s.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},D$s._addTrailByNextPosition=function(D$s){D$jr.subtract(D$s,this._lastFixedVertexPosition,this._delVector3),D$jr.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),D$jr.normalize(this._pointAtoBVector3,this._pointAtoBVector3),D$jr.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=D$jr.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=D$_s.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(D$s),D$s.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(D$s),this._virtualVerticesCount=2)},D$s._updateVerticesByPosition=function(D$s){this._pointe=D$s.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},D$s._updateVertexBuffer2=function(){var D$s,D$r=0,D$e=0,D$U=0;for(D$U=0,D$s=(this._verticesCount+this._virtualVerticesCount)/2;D$U<D$s;D$U++)D$e=0==this._owner.textureMode?(this._VerticesToTailLength[D$U]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[D$U],this._vertices2[D$r++]=1-D$e,this._vertices2[D$r++]=1-D$e;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},D$s._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},D$s._updateDisappear=function(){var D$s,D$r=0;for(D$r=this._curDisappearIndex,D$s=(this._verticesCount+this._virtualVerticesCount)/2;D$r<D$s;D$r++)this._owner._curtime-this._everyGroupVertexBirthTime[D$r]>=this._owner.time+D$_s.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},D$s._beforeRender=function(D$s){return this._camera=D$s.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),D$jr.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},D$s._render=function(D$s){this._isDead||(D$P.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),D$n.drawCall++,D$n.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},D$s._getVertexBuffer=function(D$s){return void 0===D$s&&(D$s=0),0===D$s?this._vertexBuffer1:1===D$s?this._vertexBuffer2:null},D$s._getVertexBuffers=function(){return this._vertexBuffers},D$s._getIndexBuffer=function(){return null},D$s.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},D$s._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},D$B(0,D$s,"_vertexBufferCount",function(){return this._vertexBuffers.length}),D$B(0,D$s,"triangleCount",function(){return 0}),D$r.renderElementCount=0}(),function(){function D$s(){}D$x(D$s,"laya.d3.core.trail.VertexTrail");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration1}),D$B(1,D$s,"vertexDeclaration1",function(){return D$s._vertexDeclaration1}),D$B(1,D$s,"vertexDeclaration2",function(){return D$s._vertexDeclaration2}),D$H(D$s,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new D$ks(32,[new D$js(0,"vector3",0),new D$js(12,"vector3",41),new D$js(24,"single",33),new D$js(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new D$ks(4,[new D$js(0,"single",38)])}]),D$s}()),D$ss=function(){function D$I(D$s){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=D$s}D$x(D$I,"laya.d3.graphics.DynamicBatch");var D$s=D$I.prototype;return D$w.imps(D$s,{"laya.d3.core.render.IRenderable":!0}),D$s._getVertexBuffer=function(D$s){return void 0===D$s&&(D$s=0),0===D$s?this._vertexBuffer:null},D$s._getIndexBuffer=function(){return this._indexBuffer},D$s._getCombineRenderElementFromPool=function(D$s,D$r,D$e){var D$U=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return D$U||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=D$U=new D$d,D$U._sprite3D=new D$tr),D$U._sprite3D._render._renderUpdate(D$e),D$U},D$s._getRenderElement=function(D$s,D$r,D$e){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*D$I.maxVertexCount),this._indexDatas=new Uint16Array(D$I.maxIndexCount),this._vertexBuffer=D$Qr.create(this._vertexDeclaration,D$I.maxVertexCount,35048),this._indexBuffer=D$zr.create("ushort",D$I.maxIndexCount,35048));for(var D$U=this._merageElements.length=0,D$m=0,D$k=0,D$j=this._combineRenderElements.length;D$k<D$j;D$k++){var D$T=this._combineRenderElements[D$k],D$Y=D$T.getDynamicBatchBakedVertexs(0),D$Z=D$T.getBakedIndices(),D$h=D$T._sprite3D.transform._isFrontFaceInvert,D$H=D$U/(this._vertexDeclaration.vertexStride/4),D$A=D$m,D$x=D$A+D$Z.length;D$T._tempBatchIndexStart=D$A,D$T._tempBatchIndexEnd=D$x,this._indexDatas.set(D$Z,D$m);var D$B=0;if(D$h)for(D$B=D$A;D$B<D$x;D$B+=3){this._indexDatas[D$B]=D$H+this._indexDatas[D$B];var D$$=this._indexDatas[D$B+1],D$l=this._indexDatas[D$B+2];this._indexDatas[D$B+1]=D$H+D$l,this._indexDatas[D$B+2]=D$H+D$$}else for(D$B=D$A;D$B<D$x;D$B+=3)this._indexDatas[D$B]=D$H+this._indexDatas[D$B],this._indexDatas[D$B+1]=D$H+this._indexDatas[D$B+1],this._indexDatas[D$B+2]=D$H+this._indexDatas[D$B+2];D$m+=D$Z.length,this._vertexDatas.set(D$Y,D$U),D$U+=D$Y.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),D$k=this._combineRenderElementPoolIndex=0,D$j=this._materials.length;D$k<D$j;D$k++){var D$V=this._getCombineRenderElementFromPool(D$s,D$r,D$e);D$V._type=2,D$V._staticBatch=null;var D$b=(D$V.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[D$k]]._tempBatchIndexStart,D$o=D$k+1===this._materialToRenderElementsOffsets.length?D$m:this._combineRenderElements[this._materialToRenderElementsOffsets[D$k+1]]._tempBatchIndexStart;D$V._tempBatchIndexStart=D$b,D$V._tempBatchIndexEnd=D$o,D$V._material=this._materials[D$k],this._merageElements.push(D$V)}},D$s._addCombineRenderObjTest=function(D$s){var D$r=D$s.renderObj,D$e=this._currentCombineIndexCount+D$r._getIndexBuffer().indexCount,D$U=this._currentCombineVertexCount+D$r._getVertexBuffer().vertexCount;return!(D$I.maxVertexCount<D$U||D$I.maxIndexCount<D$e)},D$s._addCombineRenderObj=function(D$s){var D$r=D$s.renderObj;this._combineRenderElements.push(D$s),this._currentCombineIndexCount=this._currentCombineIndexCount+D$r._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+D$r._getVertexBuffer().vertexCount},D$s._addCombineMaterial=function(D$s){this._materials.push(D$s)},D$s._addMaterialToRenderElementOffset=function(D$s){this._materialToRenderElementsOffsets.push(D$s)},D$s._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},D$s._addToRenderQueue=function(D$s,D$r,D$e,D$U){this._getRenderElement(D$r,D$e,D$U);for(var D$m=0,D$k=this._materials.length;D$m<D$k;D$m++)D$s.getRenderQueue(this._materials[D$m].renderQueue)._addDynamicBatchElement(this._merageElements[D$m])},D$s._beforeRender=function(D$s){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},D$s._render=function(D$s){var D$r=D$s._batchIndexEnd-D$s._batchIndexStart;D$P.mainContext.drawElements(4,D$r,5123,2*D$s._batchIndexStart),D$n.drawCall++,D$n.trianglesFaces+=D$r/3},D$s._getVertexBuffers=function(){return null},D$B(0,D$s,"_vertexBufferCount",function(){return 1}),D$B(0,D$s,"triangleCount",function(){return this._indexBuffer.indexCount/3}),D$B(0,D$s,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),D$I.maxVertexCount=2e4,D$I.maxIndexCount=4e4,D$I.maxCombineTriangleCount=10,D$I}(),D$rs=function(){function D$I(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}D$x(D$I,"laya.d3.graphics.DynamicBatchManager");var D$s=D$I.prototype;return D$s.getDynamicBatch=function(D$s,D$r){var D$e,D$U=D$s.id.toString()+D$r;return this._dynamicBatches[D$U]?D$e=this._dynamicBatches[D$U]:this._dynamicBatches[D$U]=D$e=new D$ss(D$s),D$e},D$s._garbageCollection=function(){for(var D$s in this._dynamicBatches)0===this._dynamicBatches[D$s].combineRenderElementsCount&&delete this._dynamicBatches[D$s]},D$s._addPrepareRenderElement=function(D$s){this._prepareDynamicBatchCombineElements.push(D$s)},D$s._finishCombineDynamicBatch=function(D$s){var D$r,D$e,D$U;this._prepareDynamicBatchCombineElements.sort(D$I._sortPrepareDynamicBatch);for(var D$m,D$k,D$j,D$T,D$Y,D$Z=-1,D$h=!0,D$H=0,D$A=-1,D$x=0,D$B=this._prepareDynamicBatchCombineElements.length;D$x<D$B;D$x++){var D$$=(D$k=this._prepareDynamicBatchCombineElements[D$x]).renderObj._getVertexBuffer(0).vertexDeclaration,D$l=D$e!==D$$;D$l&&(D$H=0,D$e=D$$);var D$V=D$H!==D$Z;if(D$V&&(D$Z=D$H),(D$l||D$V)&&(D$j=this.getDynamicBatch(D$$,D$H),D$r=null),D$h)if(D$j._addCombineRenderObjTest(D$k)){if(D$r!==(D$m=D$k._material))D$T&&(D$s.getRenderQueue(D$Y._material.renderQueue)._addRenderElement(D$Y),D$Y=D$T=null,D$A=-1),D$T=D$m,D$A=D$j.combineRenderElementsCount,D$Y=D$k,D$r=D$m;else if(D$T){var D$b=D$Y.renderObj,D$o=D$k.renderObj;D$b._getVertexBuffer().vertexCount+D$o._getVertexBuffer().vertexCount>D$ss.maxVertexCount||D$b._getIndexBuffer().indexCount+D$o._getIndexBuffer().indexCount>D$ss.maxIndexCount?(D$s.getRenderQueue(D$Y._material.renderQueue)._addRenderElement(D$Y),D$T=D$m,D$A=D$j.combineRenderElementsCount,D$Y=D$k):(D$j._addCombineMaterial(D$T),D$j._addMaterialToRenderElementOffset(D$A),D$j._addCombineRenderObj(D$Y),D$Y=D$T=null,D$A=-1,D$j._addCombineRenderObj(D$k))}else D$j._addCombineRenderObj(D$k);D$h=!0}else D$T&&(D$s.getRenderQueue(D$Y._material.renderQueue)._addRenderElement(D$Y),D$Y=D$T=null,D$A=-1),D$H++,D$h=!1;else D$U=this._prepareDynamicBatchCombineElements[D$x-1],D$j._addMaterialToRenderElementOffset(D$j.combineRenderElementsCount),D$r=D$U._material,D$j._addCombineMaterial(D$r),D$j._addCombineRenderObj(D$U),D$h=!0,D$r!==(D$m=D$k._material)?(D$T=D$m,D$A=D$j.combineRenderElementsCount,D$Y=D$k):D$j._addCombineRenderObj(D$k),D$r=D$m}D$T&&(D$s.getRenderQueue(D$Y._material.renderQueue)._addRenderElement(D$Y),D$Y=D$T=null,D$A=-1),this._prepareDynamicBatchCombineElements.length=0},D$s._clearRenderElements=function(){for(var D$s in this._dynamicBatches)this._dynamicBatches[D$s]._clearRenderElements()},D$s._addToRenderQueue=function(D$s,D$r,D$e,D$U){for(var D$m in this._dynamicBatches){var D$k=this._dynamicBatches[D$m];0<D$k.combineRenderElementsCount&&D$k._addToRenderQueue(D$s,D$r,D$e,D$U)}},D$s.dispose=function(){this._dynamicBatches=null},D$I._sortPrepareDynamicBatch=function(D$s,D$r){return D$s._mainSortID-D$r._mainSortID},D$I}(),D$es=function(){function D$s(){}return D$x(D$s,"laya.d3.graphics.FrustumCulling"),D$s.renderShadowObjectCulling=function(D$s,D$r,D$e,D$U,D$m){var D$k=0,D$j=0,D$T=0,D$Y=0;for(D$k=0,D$T=D$e.length;D$k<D$T;D$k++){var D$Z=D$e[D$k];D$Z&&D$Z._clearRenderElements()}var D$h,D$H,D$A,D$x=D$s._cullingRenders;if(1<D$m){for(D$k=0,D$T=D$s._cullingRendersLength;D$k<D$T;D$k++)if((D$h=D$x[D$k]).castShadow&&D$K.isVisible(D$h._owner.layer.mask)&&D$h.enable)for(var D$B=1,D$$=D$r.length;D$B<D$$;D$B++)if(D$H=D$e[D$B-1],0!==D$r[D$B].containsBoundSphere(D$h.boundingSphere))for(D$j=0,D$Y=(D$A=D$h._renderElements).length;D$j<D$Y;D$j++)D$H._addRenderElement(D$A[D$j])}else for(D$k=0,D$T=D$s._cullingRendersLength;D$k<D$T;D$k++)if((D$h=D$x[D$k]).castShadow&&D$K.isVisible(D$h._owner.layer.mask)&&D$h.enable&&0!==D$r[0].containsBoundSphere(D$h.boundingSphere))for(D$h._renderUpdate(D$U),D$H=D$e[0],D$j=0,D$Y=(D$A=D$h._renderElements).length;D$j<D$Y;D$j++)D$H._addRenderElement(D$A[D$j])},D$s.renderShadowObjectCullingOctree=function(D$s,D$r,D$e,D$U,D$m){for(var D$k=0,D$j=D$e.length;D$k<D$j;D$k++){var D$T=D$e[D$k];D$T&&D$T._clearRenderElements()}1<D$m?D$s.treeRoot.cullingShadowObjects(D$r,D$e,!0,0,D$s):D$s.treeRoot.cullingShadowObjectsOnePSSM(D$r[0],D$e,D$U,!0,0,D$s)},D$s.renderObjectCulling=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=0,D$T=0,D$Y=0,D$Z=0,D$h=D$r._quenes,D$H=D$r._dynamicBatchManager,D$A=D$r._cullingRenders;for(D$j=0,D$T=D$h.length;D$j<D$T;D$j++){var D$x=D$h[D$j];D$x&&D$x._clearRenderElements()}var D$B=D$Us._staticBatchManagers;for(D$j=0,D$T=D$B.length;D$j<D$T;D$j++)D$B[D$j]._clearRenderElements();D$H._clearRenderElements();var D$$=D$e.transform.position;for(D$j=0,D$T=D$r._cullingRendersLength;D$j<D$T;D$j++){var D$l=D$A[D$j];if(D$K.isVisible(D$l._owner.layer.mask)&&D$l.enable&&0!==D$s.containsBoundSphere(D$l.boundingSphere)&&D$l._renderUpdate(D$k)){D$l._distanceForSort=D$jr.distance(D$l.boundingSphere.center,D$$)+D$l.sortingFudge;var D$V=D$l._renderElements;for(D$Y=0,D$Z=D$V.length;D$Y<D$Z;D$Y++){var D$b=D$V[D$Y],D$o=D$b._staticBatch;if(D$o&&D$o._material===D$b._material)D$o._addBatchRenderElement(D$b);else{var D$I=D$b.renderObj;D$I.triangleCount<10&&1===D$I._vertexBufferCount&&D$I._getIndexBuffer()&&D$b._material.renderQueue<2&&D$b._canDynamicBatch&&!D$l._owner.isStatic?D$H._addPrepareRenderElement(D$b):D$r.getRenderQueue(D$b._material.renderQueue)._addRenderElement(D$b)}}}}for(D$j=0,D$T=D$B.length;D$j<D$T;D$j++)D$B[D$j]._addToRenderQueue(D$r,D$U,D$m,D$k);D$H._finishCombineDynamicBatch(D$r),D$H._addToRenderQueue(D$r,D$U,D$m,D$k)},D$s.renderObjectCullingOctree=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=0,D$T=0,D$Y=D$r._quenes,D$Z=D$r._dynamicBatchManager;for(D$j=0,D$T=D$Y.length;D$j<D$T;D$j++){var D$h=D$Y[D$j];D$h&&D$h._clearRenderElements()}var D$H=D$Us._staticBatchManagers;for(D$j=0,D$T=D$H.length;D$j<D$T;D$j++)D$H[D$j]._clearRenderElements();for(D$Z._clearRenderElements(),D$r._cullingRenders.length=0,D$r.treeRoot.cullingObjects(D$s,!0,0,D$e.transform.position,D$k),D$j=0,D$T=D$H.length;D$j<D$T;D$j++)D$H[D$j]._addToRenderQueue(D$r,D$U,D$m,D$k);D$Z._finishCombineDynamicBatch(D$r),D$Z._addToRenderQueue(D$r,D$U,D$m,D$k)},D$s.renderObjectCullingNoBoundFrustum=function(D$s,D$r,D$e,D$U,D$m){var D$k=0,D$j=0,D$T=0,D$Y=0,D$Z=D$s._quenes,D$h=D$s._dynamicBatchManager,D$H=D$s._cullingRenders;for(D$k=0,D$j=D$Z.length;D$k<D$j;D$k++){var D$A=D$Z[D$k];D$A&&D$A._clearRenderElements()}var D$x=D$Us._staticBatchManagers;for(D$k=0,D$j=D$x.length;D$k<D$j;D$k++)D$x[D$k]._clearRenderElements();D$h._clearRenderElements();var D$B=D$r.transform.position;for(D$k=0,D$j=D$s._cullingRendersLength;D$k<D$j;D$k++){var D$$=D$H[D$k];if(D$K.isVisible(D$$._owner.layer.mask)&&D$$.enable){D$$._renderUpdate(D$m),D$$._distanceForSort=D$jr.distance(D$$.boundingSphere.center,D$B)+D$$.sortingFudge;var D$l=D$$._renderElements;for(D$T=0,D$Y=D$l.length;D$T<D$Y;D$T++){var D$V=D$l[D$T],D$b=D$V._staticBatch;if(D$b&&D$b._material===D$V._material)D$b._addBatchRenderElement(D$V);else{var D$o=D$V.renderObj;D$o.triangleCount<10&&1===D$o._vertexBufferCount&&D$o._getIndexBuffer()&&D$V._material.renderQueue<2&&D$V._canDynamicBatch&&!D$$._owner.isStatic?D$h._addPrepareRenderElement(D$V):D$s.getRenderQueue(D$V._material.renderQueue)._addRenderElement(D$V)}}}}for(D$k=0,D$j=D$x.length;D$k<D$j;D$k++)D$x[D$k]._addToRenderQueue(D$s,D$e,D$U,D$m);D$h._finishCombineDynamicBatch(D$s),D$h._addToRenderQueue(D$s,D$e,D$U,D$m)},D$s}(),D$Us=function(){function D$k(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}D$x(D$k,"laya.d3.graphics.StaticBatchManager");var D$s=D$k.prototype;return D$s._finishInit=function(){for(var D$s in this._staticBatches)this._staticBatches[D$s]._finishInit();this._initBatchRenderElements.length=0},D$s._initStaticBatchs=function(D$s){throw new Error("StaticBatchManager:must override this function.")},D$s._addInitBatchSprite=function(D$s){for(var D$r=D$s._render._renderElements,D$e=0,D$U=D$r.length;D$e<D$U;D$e++)this._initBatchRenderElements.push(D$r[D$e])},D$s._clearRenderElements=function(){for(var D$s in this._staticBatches)this._staticBatches[D$s]._clearRenderElements()},D$s._garbageCollection=function(D$s){var D$r=D$s._staticBatch,D$e=D$r._initBatchRenderElements,D$U=D$e.indexOf(D$s);D$e.splice(D$U,1),0===D$e.length&&(D$r.dispose(),delete this._staticBatches[D$r._key])},D$s._addToRenderQueue=function(D$s,D$r,D$e,D$U){for(var D$m in this._staticBatches){var D$k=this._staticBatches[D$m];0<D$k._batchRenderElements.length&&D$k._updateToRenderQueue(D$s,D$U)}},D$s.dispose=function(){this._staticBatches=null},D$k._addToStaticBatchQueue=function(D$s){D$s instanceof laya.d3.core.RenderableSprite3D&&D$s._addToInitStaticBatchManager();for(var D$r=0,D$e=D$s.numChildren;D$r<D$e;D$r++)D$k._addToStaticBatchQueue(D$s._childs[D$r])},D$k.combine=function(D$s,D$r){var D$e,D$U=0,D$m=0;if(D$r)for(D$U=0,D$m=D$r.length;D$U<D$m;D$U++){D$r[D$U]._addToInitStaticBatchManager()}else D$s&&D$k._addToStaticBatchQueue(D$s);for(D$U=0,D$m=D$k._staticBatchManagers.length;D$U<D$m;D$U++)(D$e=D$k._staticBatchManagers[D$U])._initStaticBatchs(D$s),D$e._finishInit()},D$k._staticBatchManagers=[],D$k}(),D$ms=function(){function D$s(D$s,D$r,D$e){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=D$s,this._manager=D$r,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=D$e}D$x(D$s,"laya.d3.graphics.StaticBatch");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),D$r._binarySearch=function(D$s){for(var D$r=0,D$e=this._batchRenderElements.length-1,D$U=0;D$r<=D$e;)D$U=Math.floor((D$r+D$e)/2),this._compareBatchRenderElement(this._batchRenderElements[D$U],D$s)?D$e=D$U-1:D$r=D$U+1;return D$r},D$r._compareBatchRenderElement=function(D$s,D$r){throw new Error("StaticBatch:must override this function.")},D$r._getVertexDecLightMap=function(D$s){return D$s===D$zs.vertexDeclaration?D$Ks.vertexDeclaration:D$s===D$Ss.vertexDeclaration?D$is.vertexDeclaration:D$s===D$ys.vertexDeclaration?D$Is.vertexDeclaration:D$s===D$as.vertexDeclaration?null:D$s===D$$s.vertexDeclaration?D$ls.vertexDeclaration:D$s===D$Cs.vertexDeclaration?D$Es.vertexDeclaration:D$s===D$Ps.vertexDeclaration?D$Os.vertexDeclaration:D$s===D$Qs.vertexDeclaration?D$cs.vertexDeclaration:D$s===D$Ss.vertexDeclaration?D$is.vertexDeclaration:D$s===D$gs.vertexDeclaration?D$ws.vertexDeclaration:D$s===D$as.vertexDeclaration?null:D$s===D$$s.vertexDeclaration?D$ls.vertexDeclaration:D$s===D$Rs.vertexDeclaration?D$vs.vertexDeclaration:D$s===D$Ps.vertexDeclaration?D$Os.vertexDeclaration:D$s},D$r._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},D$r._addBatchRenderElement=function(D$s){this._batchRenderElements.splice(this._binarySearch(D$s),0,D$s)},D$r._updateToRenderQueue=function(D$s,D$r){this._combineRenderElementPoolIndex=0,this._getRenderElement(D$s.getRenderQueue(this._material.renderQueue)._renderElements,D$s,D$r)},D$r._getRenderElement=function(D$s,D$r,D$e){throw new Error("StaticBatch:must override this function.")},D$r._finishInit=function(){throw new Error("StaticBatch:must override this function.")},D$r._clearRenderElements=function(){this._batchRenderElements.length=0},D$r.dispose=function(){},D$r._getVertexBuffer=function(D$s){return void 0===D$s&&(D$s=0),null},D$r._getIndexBuffer=function(){return null},D$r._beforeRender=function(D$s){return!0},D$r._render=function(D$s){},D$r._getVertexBuffers=function(){return null},D$B(0,D$r,"_vertexBufferCount",function(){return 1}),D$B(0,D$r,"triangleCount",function(){return 0}),D$s.combine=function(D$s){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),D$Us.combine(D$s)},D$s.maxBatchVertexCount=65535,D$s}(),D$ks=function(){function D$j(D$s,D$r){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++D$j._uniqueIDCounter,this._id>D$j.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",D$j.maxVertexDeclaration);this._shaderValues=new D$Ar,this._vertexElementsDic={},this._vertexStride=D$s,this._vertexElements=D$r;for(var D$e=0;D$e<D$r.length;D$e++){var D$U=D$r[D$e],D$m=D$U.elementUsage;this._vertexElementsDic[D$m]=D$U;var D$k=[D$j._getTypeSize(D$U.elementFormat)/4,5126,!1,this._vertexStride,D$U.offset];switch(this._shaderValues.setValue(D$m,D$k),D$m){case 1:this._addShaderDefine(D$nr.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(D$nr.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(D$nr.SHADERDEFINE_UV1)}}}D$x(D$j,"laya.d3.graphics.VertexDeclaration");var D$s=D$j.prototype;return D$s._addShaderDefine=function(D$s){this._shaderDefineValue|=D$s},D$s._removeShaderDefine=function(D$s){this._shaderDefineValue&=~D$s},D$s.getVertexElements=function(){return this._vertexElements.slice()},D$s.getVertexElementByUsage=function(D$s){return this._vertexElementsDic[D$s]},D$s.unBinding=function(){},D$B(0,D$s,"shaderDefineValue",function(){return this._shaderDefineValue}),D$B(0,D$s,"id",function(){return this._id}),D$B(0,D$s,"vertexStride",function(){return this._vertexStride}),D$B(0,D$s,"shaderValues",function(){return this._shaderValues}),D$j._getTypeSize=function(D$s){switch(D$s){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},D$j.getVertexStride=function(D$s){for(var D$r=0,D$e=0;D$e<D$s.Length;D$e++){var D$U=D$s[D$e],D$m=D$U.offset+D$j._getTypeSize(D$U.elementFormat);D$r<D$m&&(D$r=D$m)}return D$r},D$j._maxVertexDeclarationBit=1e3,D$j._uniqueIDCounter=1,D$H(D$j,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),D$j}(),D$js=function(){function D$s(D$s,D$r,D$e){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=D$s,this.elementFormat=D$r,this.elementUsage=D$e}return D$x(D$s,"laya.d3.graphics.VertexElement"),D$s}(),D$Ts=(function(){function D$s(){}D$x(D$s,"laya.d3.graphics.VertexElementFormat"),D$s.Single="single",D$s.Vector2="vector2",D$s.Vector3="vector3",D$s.Vector4="vector4",D$s.Color="color",D$s.Byte4="byte4",D$s.Short2="short2",D$s.Short4="short4",D$s.NormalizedShort2="normalizedshort2",D$s.NormalizedShort4="normalizedshort4",D$s.HalfVector2="halfvector2",D$s.HalfVector4="halfvector4"}(),function(){function D$s(){}D$x(D$s,"laya.d3.graphics.VertexElementUsage"),D$s.POSITION0=0,D$s.COLOR0=1,D$s.TEXTURECOORDINATE0=2,D$s.NORMAL0=3,D$s.BINORMAL0=4,D$s.TANGENT0=5,D$s.BLENDINDICES0=6,D$s.BLENDWEIGHT0=7,D$s.DEPTH0=8,D$s.FOG0=9,D$s.POINTSIZE0=10,D$s.SAMPLE0=11,D$s.TESSELLATEFACTOR0=12,D$s.COLOR1=13,D$s.NEXTTEXTURECOORDINATE0=14,D$s.TEXTURECOORDINATE1=15,D$s.NEXTTEXTURECOORDINATE1=16,D$s.CORNERTEXTURECOORDINATE0=17,D$s.VELOCITY0=18,D$s.STARTCOLOR0=19,D$s.STARTSIZE=20,D$s.AGEADDSCALE0=21,D$s.STARTROTATION=22,D$s.ENDCOLOR0=23,D$s.STARTLIFETIME=24,D$s.TIME0=33,D$s.SHAPEPOSITIONSTARTLIFETIME=30,D$s.DIRECTIONTIME=32,D$s.SIZEROTATION0=27,D$s.RADIUS0=28,D$s.RADIAN0=29,D$s.STARTSPEED=31,D$s.RANDOM0=34,D$s.RANDOM1=35,D$s.SIMULATIONWORLDPOSTION=36,D$s.SIMULATIONWORLDROTATION=37,D$s.TEXTURECOORDINATE0X=38,D$s.TEXTURECOORDINATE0X1=39,D$s.TEXTURECOORDINATE0Y=40,D$s.OFFSETVECTOR=41}(),function(){function D$s(D$s,D$r,D$e){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=D$s,this._textureCoordinate0=D$r,this._time=D$e}D$x(D$s,"laya.d3.graphics.VertexGlitter");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate0}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"time",function(){return this._time}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(24,[new D$js(0,"vector3",0),new D$js(12,"vector2",2),new D$js(20,"single",33)])}])}(),function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=D$s,this._position=D$r,this._velocity=D$e,this._startColor=D$U,this._endColor=D$m,this._sizeRotation=D$k,this._radius=D$j,this._radian=D$T,this._ageAddScale=D$Y,this._time=D$Z}D$x(D$s,"laya.d3.graphics.VertexParticle");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"endColor",function(){return this._endColor}),D$B(0,D$r,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),D$B(0,D$r,"sizeRotation",function(){return this._sizeRotation}),D$B(0,D$r,"velocity",function(){return this._velocity}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"startColor",function(){return this._startColor}),D$B(0,D$r,"radius",function(){return this._radius}),D$B(0,D$r,"radian",function(){return this._radian}),D$B(0,D$r,"ageAddScale",function(){return this._ageAddScale}),D$B(0,D$r,"time",function(){return this._time}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(116,[new D$js(0,"vector4",17),new D$js(16,"vector3",0),new D$js(28,"vector3",18),new D$js(40,"vector4",19),new D$js(56,"vector4",23),new D$js(72,"vector3",27),new D$js(84,"vector2",28),new D$js(92,"vector4",29),new D$js(108,"single",24),new D$js(112,"single",33)])}])}(),function(){function D$s(D$s){this._position=null,this._position=D$s}D$x(D$s,"laya.d3.graphics.VertexPosition");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(12,[new D$js(0,"vector3",0)])}]),D$s}()),D$Ys=function(){function D$s(D$s,D$r){this._position=null,this._normal=null,this._position=D$s,this._normal=D$r}D$x(D$s,"laya.d3.graphics.VertexPositionNormal");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(24,[new D$js(0,"vector3",0),new D$js(12,"vector3",3)])}]),D$s}(),D$Zs=function(){function D$s(D$s,D$r,D$e){this._position=null,this._normal=null,this._color=null,this._position=D$s,this._normal=D$r,this._color=D$e}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColor");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(40,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1)])}]),D$s}(),D$hs=function(){function D$s(D$s,D$r,D$e,D$U,D$m){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._blendIndex=D$U,this._blendWeight=D$m}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorSkin");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(72,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector4",7),new D$js(56,"vector4",6)])}]),D$s}(),D$Hs=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._tangent=D$U,this._blendIndex=D$m,this._blendWeight=D$k}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(88,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector4",7),new D$js(56,"vector4",6),new D$js(72,"vector4",5)])}]),D$s}(),D$As=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._tangent=D$U,this._blendIndex=D$m,this._blendWeight=D$k}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(84,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector4",7),new D$js(56,"vector4",6),new D$js(72,"vector3",5)])}]),D$s}(),D$xs=function(){function D$s(D$s,D$r,D$e,D$U){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._tangent=D$U}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(56,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector4",5)])}]),D$s}(),D$Bs=function(){function D$s(D$s,D$r,D$e,D$U){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._tangent=D$U}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(52,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector3",5)])}]),D$s}(),D$$s=function(){function D$s(D$s,D$r,D$e,D$U){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate=D$U}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTexture");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(48,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2)])}]),D$s}(),D$ls=function(){function D$s(D$s,D$r,D$e,D$U,D$m){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate0=D$U,this._textureCoordinate1=D$m}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(56,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector2",15)])}]),D$s}(),D$Vs=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate0=D$U,this._textureCoordinate1=D$m,this._blendIndex=D$k,this._blendWeight=D$j}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(88,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector2",15),new D$js(56,"vector4",7),new D$js(72,"vector4",6)])}]),D$s}(),D$bs=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate0=D$U,this._textureCoordinate1=D$m,this._tangent=D$k,this._blendIndex=D$j,this._blendWeight=D$T}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(104,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector2",15),new D$js(56,"vector4",7),new D$js(72,"vector4",6),new D$js(88,"vector4",5)])}]),D$s}(),D$os=function(){function D$s(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$r.VertexPositionNormalColorTexture0SkinTangent=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate0=D$U,this._textureCoordinate1=D$m,this._tangent=D$k,this._blendIndex=D$j,this._blendWeight=D$T},D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(100,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector2",15),new D$js(56,"vector4",7),new D$js(72,"vector4",6),new D$js(88,"vector3",5)])}]),D$s}(),D$Is=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate0=D$U,this._textureCoordinate1=D$m,this._tangent=D$k}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(72,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector2",15),new D$js(56,"vector4",5)])}]),D$s}(),D$ws=function(){function D$s(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$r.VertexPositionNormalColorTexture0Tangent=function(D$s,D$r,D$e,D$U,D$m,D$k){this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate0=D$U,this._textureCoordinate1=D$m,this._tangent=D$k},D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(68,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector2",15),new D$js(56,"vector3",5)])}]),D$s}(),D$Xs=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate=D$U,this._blendIndex=D$m,this._blendWeight=D$k}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(80,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector4",7),new D$js(64,"vector4",6)])}]),D$s}(),D$Ds=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate=D$U,this._tangent=D$m,this._blendIndex=D$k,this._blendWeight=D$j}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(96,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector4",7),new D$js(64,"vector4",6),new D$js(80,"vector4",5)])}]),D$s}(),D$ns=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate=D$U,this._tangent=D$m,this._blendIndex=D$k,this._blendWeight=D$j}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(92,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector4",7),new D$js(64,"vector4",6),new D$js(80,"vector3",5)])}]),D$s}(),D$ys=function(){function D$s(D$s,D$r,D$e,D$U,D$m){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate=D$U,this._tangent=D$m}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(64,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector4",5)])}]),D$s}(),D$gs=function(){function D$s(D$s,D$r,D$e,D$U,D$m){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._color=D$e,this._textureCoordinate=D$U,this._tangent=D$m}D$x(D$s,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"color",function(){return this._color}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(60,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",1),new D$js(40,"vector2",2),new D$js(48,"vector3",5)])}]),D$s}(),D$fs=function(){function D$s(D$s,D$r,D$e){this._position=null,this._normal=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._tangent=D$e}D$x(D$s,"laya.d3.graphics.VertexPositionNormalSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(40,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector4",5)])}]),D$s}(),D$Js=function(){function D$s(D$s,D$r,D$e){this._position=null,this._normal=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._tangent=D$e}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(36,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector3",5)])}]),D$s}(),D$Ps=function(){function D$s(D$s,D$r,D$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTexture");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(32,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2)])}]),D$s}(),D$Os=function(){function D$s(D$s,D$r,D$e,D$U){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=D$s,this._normal=D$r,this._textureCoordinate0=D$e,this._textureCoordinate1=D$U}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(40,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector2",15)])}]),D$s}(),D$is=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=D$s,this._normal=D$r,this._textureCoordinate0=D$e,this._textureCoordinate1=D$U,this._blendIndex=D$m,this._blendWeight=D$k}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(72,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector2",15),new D$js(40,"vector4",7),new D$js(56,"vector4",6)])}]),D$s}(),D$Ks=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._textureCoordinate0=D$e,this._textureCoordinate1=D$U,this._tangent=D$m,this._blendIndex=D$k,this._blendWeight=D$j}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(88,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector2",15),new D$js(40,"vector4",7),new D$js(56,"vector4",6),new D$js(72,"vector4",5)])}]),D$s}(),D$cs=function(){function D$s(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$r.VertexPositionNormalTexture0SkinTangent=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){this._position=D$s,this._normal=D$r,this._textureCoordinate0=D$e,this._textureCoordinate1=D$U,this._tangent=D$m,this._blendIndex=D$k,this._blendWeight=D$j},D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(84,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector2",15),new D$js(40,"vector4",7),new D$js(56,"vector4",6),new D$js(72,"vector3",5)])}]),D$s}(),D$Es=function(){function D$s(D$s,D$r,D$e,D$U,D$m){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._textureCoordinate0=D$e,this._textureCoordinate1=D$U,this._tangent=D$m}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(56,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector2",15),new D$js(40,"vector4",5)])}]),D$s}(),D$vs=function(){function D$s(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$r.VertexPositionNormalTexture0Tangent=function(D$s,D$r,D$e,D$U,D$m){this._position=D$s,this._normal=D$r,this._textureCoordinate0=D$e,this._textureCoordinate1=D$U,this._tangent=D$m},D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(52,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector2",15),new D$js(40,"vector3",5)])}]),D$s}(),D$Ss=function(){function D$s(D$s,D$r,D$e,D$U,D$m){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e,this._blendIndex=D$U,this._blendWeight=D$m}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTextureSkin");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(64,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector4",7),new D$js(48,"vector4",6)])}]),D$s}(),D$zs=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e,this._tangent=D$U,this._blendIndex=D$m,this._blendWeight=D$k}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(80,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector4",7),new D$js(48,"vector4",6),new D$js(64,"vector4",5)])}]),D$s}(),D$Qs=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e,this._tangent=D$U,this._blendIndex=D$m,this._blendWeight=D$k}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(76,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector4",7),new D$js(48,"vector4",6),new D$js(64,"vector3",5)])}]),D$s}(),D$Cs=function(){function D$s(D$s,D$r,D$e,D$U){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e,this._tangent=D$U}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(48,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector4",5)])}]),D$s}(),D$Rs=function(){function D$s(D$s,D$r,D$e,D$U){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e,this._tangent=D$U}D$x(D$s,"laya.d3.graphics.VertexPositionNormalTextureTangent");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(44,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector3",5)])}]),D$s}(),D$as=function(){function D$s(D$s,D$r,D$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e}D$x(D$s,"laya.d3.graphics.VertexPositionNTBTexture");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(56,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector3",5),new D$js(36,"vector3",4),new D$js(48,"vector2",2)])}]),D$s}(),D$ps=function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=D$s,this._normal=D$r,this._textureCoordinate0=D$U,this._textureCoordinate1=D$m,this._tangent=D$k,D$e=D$e,this._blendIndex=D$j,this._blendWeight=D$T}D$x(D$s,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"tangent",function(){return this._tangent}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(0,D$r,"textureCoordinate1",function(){return this._textureCoordinate1}),D$B(0,D$r,"blendIndex",function(){return this._blendIndex}),D$B(0,D$r,"blendWeight",function(){return this._blendWeight}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(96,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector3",5),new D$js(36,"vector3",4),new D$js(48,"vector2",2),new D$js(56,"vector2",15),new D$js(64,"vector4",7),new D$js(80,"vector4",6)])}]),D$s}(),D$Ns=function(){function D$s(D$s,D$r,D$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=D$s,this._normal=D$r,this._textureCoordinate=D$e}D$x(D$s,"laya.d3.graphics.VertexPositionNTBTextureSkin");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"textureCoordinate",function(){return this._textureCoordinate}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(88,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector3",5),new D$js(36,"vector3",4),new D$js(48,"vector2",2),new D$js(56,"vector4",7),new D$js(72,"vector4",6)])}]),D$s}(),D$qs=(function(){function D$s(D$s,D$r,D$e,D$U){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=D$s,this._normal=D$r,this._textureCoord0=D$e,this._textureCoord1=D$U}D$x(D$s,"laya.d3.graphics.VertexPositionTerrain");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"normal",function(){return this._normal}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoord0",function(){return this._textureCoord0}),D$B(0,D$r,"textureCoord1",function(){return this._textureCoord1}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(40,[new D$js(0,"vector3",0),new D$js(12,"vector3",3),new D$js(24,"vector2",2),new D$js(32,"vector2",15)])}])}(),function(){function D$s(D$s,D$r){this._position=null,this._textureCoordinate0=null,this._position=D$s,this._textureCoordinate0=D$r}D$x(D$s,"laya.d3.graphics.VertexPositionTexture0");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"position",function(){return this._position}),D$B(0,D$r,"textureCoordinate0",function(){return this._textureCoordinate0}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(20,[new D$js(0,"vector3",0),new D$js(12,"vector2",2)])}]),D$s}()),D$Gs=(function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H,D$A,D$x){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=D$s,this._positionStartLifeTime=D$r,this._velocity=D$e,this._startColor=D$U,this._startSize=D$m,this._startRotation0=D$k,this._startRotation1=D$j,this._startRotation2=D$T,this._startLifeTime=D$Y,this._time=D$Z,this._startSpeed=D$h,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=D$x}D$x(D$s,"laya.d3.graphics.VertexShurikenParticleBillboard");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),D$B(0,D$r,"random1",function(){return this._randoms1}),D$B(0,D$r,"startRotation2",function(){return this._startRotation2}),D$B(0,D$r,"positionStartLifeTime",function(){return this._positionStartLifeTime}),D$B(0,D$r,"velocity",function(){return this._velocity}),D$B(0,D$r,"random0",function(){return this._randoms0}),D$B(0,D$r,"startSize",function(){return this._startSize}),D$B(0,D$r,"startColor",function(){return this._startColor}),D$B(0,D$r,"startRotation0",function(){return this._startRotation0}),D$B(0,D$r,"startRotation1",function(){return this._startRotation1}),D$B(0,D$r,"startLifeTime",function(){return this._startLifeTime}),D$B(0,D$r,"time",function(){return this._time}),D$B(0,D$r,"startSpeed",function(){return this._startSpeed}),D$B(0,D$r,"simulationWorldPostion",function(){return this._simulationWorldPostion}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(152,[new D$js(0,"vector4",17),new D$js(16,"vector4",30),new D$js(32,"vector4",32),new D$js(48,"vector4",19),new D$js(64,"vector3",20),new D$js(76,"vector3",22),new D$js(88,"single",31),new D$js(92,"vector4",34),new D$js(108,"vector4",35),new D$js(124,"vector3",36),new D$js(136,"vector4",37)])}])}(),function(){function D$s(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H,D$A,D$x){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=D$s,this._positionStartLifeTime=D$r,this._velocity=D$e,this._startColor=D$U,this._startSize=D$m,this._startRotation0=D$k,this._startRotation1=D$j,this._startRotation2=D$T,this._startLifeTime=D$Y,this._time=D$Z,this._startSpeed=D$h,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=D$x}D$x(D$s,"laya.d3.graphics.VertexShurikenParticleMesh");var D$r=D$s.prototype;D$w.imps(D$r,{"laya.d3.graphics.IVertex":!0}),D$B(0,D$r,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),D$B(0,D$r,"velocity",function(){return this._velocity}),D$B(0,D$r,"position",function(){return this._positionStartLifeTime}),D$B(0,D$r,"random0",function(){return this._randoms0}),D$B(0,D$r,"startSize",function(){return this._startSize}),D$B(0,D$r,"startColor",function(){return this._startColor}),D$B(0,D$r,"startRotation0",function(){return this._startRotation0}),D$B(0,D$r,"startRotation1",function(){return this._startRotation1}),D$B(0,D$r,"random1",function(){return this._randoms1}),D$B(0,D$r,"startRotation2",function(){return this._startRotation2}),D$B(0,D$r,"startLifeTime",function(){return this._startLifeTime}),D$B(0,D$r,"time",function(){return this._time}),D$B(0,D$r,"startSpeed",function(){return this._startSpeed}),D$B(0,D$r,"simulationWorldPostion",function(){return this._simulationWorldPostion}),D$B(0,D$r,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$B(1,D$s,"vertexDeclaration",function(){return D$s._vertexDeclaration}),D$H(D$s,["_vertexDeclaration",function(){return this._vertexDeclaration=new D$ks(172,[new D$js(0,"vector3",0),new D$js(12,"vector4",1),new D$js(28,"vector2",2),new D$js(36,"vector4",30),new D$js(52,"vector4",32),new D$js(68,"vector4",19),new D$js(84,"vector3",20),new D$js(96,"vector3",22),new D$js(108,"single",31),new D$js(112,"vector4",34),new D$js(128,"vector4",35),new D$js(144,"vector3",36),new D$js(156,"vector4",37)])}])}(),function(){function D$o(D$s,D$r,D$e,D$U,D$m,D$k){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=D$e,this._materials=D$U,this._subMeshes=D$m,this._materialMap=D$k,this._version=D$r,this._onLoaded(D$s)}D$x(D$o,"laya.d3.loaders.LoadModelV01");var D$s=D$o.prototype;return D$s._onLoaded=function(D$s){this._readData=D$s,this.READ_BLOCK();for(var D$r=0;D$r<this._BLOCK.count;D$r++){var D$e=this._readData.getUint16(),D$U=this._strings[D$e],D$m=this["READ_"+D$U];if(null==D$m)throw new Error("model file err,no this function:"+D$e+" "+D$U);if(!D$m.call(this))break}return this._mesh},D$s.onError=function(){},D$s._readString=function(){return this._strings[this._readData.getUint16()]},D$s.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},D$s.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},D$s.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var D$s=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var D$r=0;D$r<this._STRINGS.size;D$r++)this._strings[D$r]=this._readData.readUTFString();return this._readData.pos=D$s,!0},D$s.READ_MATERIAL=function(){var D$s=this._readData.getUint16(),D$r=(this._readString(),this._readString());return this._materials[D$s]="null"!==D$r?D$V.getRes(this._materialMap[D$r]):new D$Jr,!0},D$s.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var D$s,D$r=this._readData.__getBuffer(),D$e=0,D$U=this._readData.getUint32(),D$m=this._readData.getUint32(),D$k=(new Float32Array(D$r.slice(D$U+this._DATA.offset,D$U+this._DATA.offset+D$m)),this._readData.getUint32()),D$j=this._readData.getUint32(),D$T=new Float32Array(D$r.slice(D$k+this._DATA.offset,D$k+this._DATA.offset+D$j));for(this.mesh._inverseBindPoses=[],D$e=0,D$s=D$T.length;D$e<D$s;D$e+=16){var D$Y=new D$sr(D$T[D$e+0],D$T[D$e+1],D$T[D$e+2],D$T[D$e+3],D$T[D$e+4],D$T[D$e+5],D$T[D$e+6],D$T[D$e+7],D$T[D$e+8],D$T[D$e+9],D$T[D$e+10],D$T[D$e+11],D$T[D$e+12],D$T[D$e+13],D$T[D$e+14],D$T[D$e+15]);this.mesh._inverseBindPoses.push(D$Y)}break;default:throw new Error("LoadModel:unknown version.")}return!0},D$s.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var D$s=this._readString();this._shaderAttributes=D$s.match(D$o._attrReg);var D$r=this._readData.getUint32(),D$e=this._readData.getUint32(),D$U=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),D$m=this._readData.getUint32(),D$k=this._readData.getUint32(),D$j=this._readData.getUint32(),D$T=this._readData.__getBuffer(),D$Y=new D$Zr(this._mesh),D$Z=this._getVertexDeclaration(),D$h=D$Qr.create(D$Z,D$m/D$Z.vertexStride,35044,!0),D$H=D$U+this._DATA.offset,D$A=D$T.slice(D$H,D$H+D$m);D$h.setData(new Float32Array(D$A));for(var D$x=(D$Y._vertexBuffer=D$h).vertexDeclaration.getVertexElements(),D$B=0;D$B<D$x.length;D$B++)D$Y._bufferUsage[D$x[D$B].elementUsage]=D$h;var D$$=D$zr.create("ushort",D$e/2,35044,!0),D$l=D$r+this._DATA.offset,D$V=D$T.slice(D$l,D$l+D$e);D$$.setData(new Uint16Array(D$V)),D$Y._indexBuffer=D$$;var D$b=D$T.slice(D$k+this._DATA.offset,D$k+this._DATA.offset+D$j);return D$Y._boneIndicesList[0]=new Uint8Array(D$b),this._subMeshes.push(D$Y),!0},D$s.READ_DATAAREA=function(){return!1},D$s._getVertexDeclaration=function(){for(var D$s,D$r=!1,D$e=!1,D$U=!1,D$m=!1,D$k=!1,D$j=!1,D$T=!1,D$Y=!1,D$Z=!1,D$h=0;D$h<this._shaderAttributes.length;D$h+=8)switch(this._shaderAttributes[D$h]){case"POSITION":D$r=!0;break;case"NORMAL":D$e=!0;break;case"COLOR":D$U=!0;break;case"UV":D$m=!0;break;case"UV1":D$k=!0;break;case"BLENDWEIGHT":D$T=!0;break;case"BLENDINDICES":D$Y=!0;break;case"TANGENT":D$j=!0;break;case"BINORMAL":D$Z=!0}return D$r&&D$e&&D$U&&D$m&&D$k&&D$T&&D$Y&&D$j?D$s=D$os.vertexDeclaration:D$r&&D$e&&D$U&&D$m&&D$k&&D$T&&D$Y?D$s=D$Vs.vertexDeclaration:D$r&&D$e&&D$m&&D$k&&D$T&&D$Y&&D$j?D$s=D$cs.vertexDeclaration:D$r&&D$e&&D$m&&D$k&&D$T&&D$Y?D$s=D$is.vertexDeclaration:D$r&&D$e&&D$U&&D$m&&D$T&&D$Y&&D$j?D$s=D$ns.vertexDeclaration:D$r&&D$e&&D$U&&D$m&&D$T&&D$Y?D$s=D$Xs.vertexDeclaration:D$r&&D$e&&D$j&&D$Z&&D$m&&D$T&&D$Y?D$s=D$Ns.vertexDeclaration:D$r&&D$e&&D$m&&D$T&&D$Y&&D$j?D$s=D$Qs.vertexDeclaration:D$r&&D$e&&D$m&&D$T&&D$Y?D$s=D$Ss.vertexDeclaration:D$r&&D$e&&D$U&&D$T&&D$Y&&D$j?D$s=D$As.vertexDeclaration:D$r&&D$e&&D$U&&D$T&&D$Y?D$s=D$hs.vertexDeclaration:D$r&&D$e&&D$U&&D$m&&D$k&&D$j?D$s=D$ws.vertexDeclaration:D$r&&D$e&&D$U&&D$m&&D$k?D$s=D$ls.vertexDeclaration:D$r&&D$e&&D$m&&D$k&&D$j?D$s=D$vs.vertexDeclaration:D$r&&D$e&&D$m&&D$k?D$s=D$Os.vertexDeclaration:D$r&&D$e&&D$U&&D$m&&D$j?D$s=D$gs.vertexDeclaration:D$r&&D$e&&D$m&&D$j&&D$Z?D$s=D$as.vertexDeclaration:D$r&&D$e&&D$U&&D$m?D$s=D$$s.vertexDeclaration:D$r&&D$e&&D$m&&D$j?D$s=D$Rs.vertexDeclaration:D$r&&D$e&&D$m?D$s=D$Ps.vertexDeclaration:D$r&&D$e&&D$U&&D$j?D$s=D$Bs.vertexDeclaration:D$r&&D$e&&D$U&&(D$s=D$Zs.vertexDeclaration),D$s},D$B(0,D$s,"mesh",function(){return this._mesh}),D$o._attrReg=new RegExp("(\\w+)|([:,;])","g"),D$o}()),D$ds=function(){function D$D(){}return D$x(D$D,"laya.d3.loaders.LoadModelV02"),D$D.parse=function(D$s,D$r,D$e,D$U,D$m,D$k){D$D._mesh=D$e,D$D._materials=D$U,D$D._subMeshes=D$m,D$D._materialMap=D$k,D$D._version=D$r,D$D._readData=D$s,D$D.READ_DATA(),D$D.READ_BLOCK(),D$D.READ_STRINGS();for(var D$j=0,D$T=D$D._BLOCK.count;D$j<D$T;D$j++){D$D._readData.pos=D$D._BLOCK.blockStarts[D$j];var D$Y=D$D._readData.getUint16(),D$Z=D$D._strings[D$Y],D$h=D$D["READ_"+D$Z];if(null==D$h)throw new Error("model file err,no this function:"+D$Y+" "+D$Z);D$h.call()}D$D._strings.length=0,D$D._readData=null,D$D._version=null,D$D._mesh=null,D$D._materials=null,D$D._subMeshes=null,D$D._materialMap=null},D$D._readString=function(){return D$D._strings[D$D._readData.getUint16()]},D$D.READ_DATA=function(){D$D._DATA.offset=D$D._readData.getUint32(),D$D._DATA.size=D$D._readData.getUint32()},D$D.READ_BLOCK=function(){for(var D$s=D$D._BLOCK.count=D$D._readData.getUint16(),D$r=D$D._BLOCK.blockStarts=[],D$e=D$D._BLOCK.blockLengths=[],D$U=0;D$U<D$s;D$U++)D$r.push(D$D._readData.getUint32()),D$e.push(D$D._readData.getUint32())},D$D.READ_STRINGS=function(){var D$s=D$D._readData.getUint32(),D$r=D$D._readData.getUint16(),D$e=D$D._readData.pos;D$D._readData.pos=D$s+D$D._DATA.offset;for(var D$U=0;D$U<D$r;D$U++)D$D._strings[D$U]=D$D._readData.readUTFString();D$D._readData.pos=D$e},D$D.READ_MATERIAL=function(){D$D._readString(),D$D._readString();var D$s=D$D._readString();return""!==D$s&&D$D._materials.push(D$V.getRes(D$D._materialMap[D$s])),!0},D$D.READ_MESH=function(){D$D._readString();var D$s,D$r=D$D._readData.__getBuffer(),D$e=0,D$U=D$D._readData.getInt16(),D$m=D$D._DATA.offset;for(D$e=0;D$e<D$U;D$e++){var D$k=D$m+D$D._readData.getUint32(),D$j=D$D._readData.getUint32(),D$T=new Float32Array(D$r.slice(D$k,D$k+D$j)),D$Y=D$D._readString().match(D$D._attrReg),D$Z=D$D._getVertexDeclaration(D$Y),D$h=D$Qr.create(D$Z,4*D$T.length/D$Z.vertexStride,35044,!0);D$h.setData(D$T),D$D._mesh._vertexBuffers.push(D$h)}var D$H=D$m+D$D._readData.getUint32(),D$A=D$D._readData.getUint32(),D$x=new Uint16Array(D$r.slice(D$H,D$H+D$A)),D$B=D$zr.create("ushort",D$A/2,35044,!0);D$B.setData(D$x),D$D._mesh._indexBuffer=D$B;var D$$=D$D._mesh._boneNames=[],D$l=D$D._readData.getUint16();for(D$$.length=D$l,D$e=0;D$e<D$l;D$e++)D$$[D$e]=D$D._strings[D$D._readData.getUint16()];var D$V=D$D._readData.getUint32(),D$b=D$D._readData.getUint32(),D$o=(new Float32Array(D$r.slice(D$m+D$V,D$m+D$V+D$b)),D$D._readData.getUint32()),D$I=D$D._readData.getUint32(),D$w=new Float32Array(D$r.slice(D$m+D$o,D$m+D$o+D$I));for(D$D._mesh._inverseBindPoses=[],D$e=0,D$s=D$w.length;D$e<D$s;D$e+=16){var D$X=new D$sr(D$w[D$e+0],D$w[D$e+1],D$w[D$e+2],D$w[D$e+3],D$w[D$e+4],D$w[D$e+5],D$w[D$e+6],D$w[D$e+7],D$w[D$e+8],D$w[D$e+9],D$w[D$e+10],D$w[D$e+11],D$w[D$e+12],D$w[D$e+13],D$w[D$e+14],D$w[D$e+15]);D$D._mesh._inverseBindPoses.push(D$X)}return D$D._mesh._skinnedDatas=new Float32Array(16*D$w.length),!0},D$D.READ_SUBMESH=function(){var D$s=D$D._readData.__getBuffer(),D$r=new D$Zr(D$D._mesh),D$e=D$D._readData.getInt16(),D$U=D$D._readData.getUint32(),D$m=D$D._readData.getUint32();D$r._vertexBuffer=D$D._mesh._vertexBuffers[D$e],D$r._vertexStart=D$U,D$r._vertexCount=D$m;var D$k=D$D._readData.getUint32(),D$j=D$D._readData.getUint32(),D$T=D$D._mesh._indexBuffer;D$r._indexBuffer=D$T,D$r._indexStart=D$k,D$r._indexCount=D$j,D$r._indices=new Uint16Array(D$T.getData().buffer,2*D$k,D$j);var D$Y=D$D._DATA.offset,D$Z=D$r._subIndexBufferStart,D$h=D$r._subIndexBufferCount,D$H=D$r._boneIndicesList,D$A=D$D._readData.getUint16();D$Z.length=D$A,D$h.length=D$A,D$H.length=D$A;for(var D$x=0;D$x<D$A;D$x++){D$Z[D$x]=D$D._readData.getUint32(),D$h[D$x]=D$D._readData.getUint32();var D$B=D$D._readData.getUint32(),D$$=D$D._readData.getUint32();D$r._boneIndicesList[D$x]=new Uint8Array(D$s.slice(D$Y+D$B,D$Y+D$B+D$$))}return D$D._subMeshes.push(D$r),!0},D$D._getVertexDeclaration=function(D$s){for(var D$r,D$e=!1,D$U=!1,D$m=!1,D$k=!1,D$j=!1,D$T=!1,D$Y=!1,D$Z=!1,D$h=!1,D$H=0;D$H<D$s.length;D$H++)switch(D$s[D$H]){case"POSITION":D$e=!0;break;case"NORMAL":D$U=!0;break;case"COLOR":D$m=!0;break;case"UV":D$k=!0;break;case"UV1":D$j=!0;break;case"BLENDWEIGHT":D$Y=!0;break;case"BLENDINDICES":D$Z=!0;break;case"TANGENT":D$T=!0;break;case"BINORMAL":D$h=!0}return D$e&&D$U&&D$m&&D$k&&D$j&&D$Y&&D$Z&&D$T?D$r=D$os.vertexDeclaration:D$e&&D$U&&D$m&&D$k&&D$j&&D$Y&&D$Z?D$r=D$Vs.vertexDeclaration:D$e&&D$U&&D$k&&D$j&&D$Y&&D$Z&&D$T?D$r=D$cs.vertexDeclaration:D$e&&D$U&&D$k&&D$j&&D$Y&&D$Z?D$r=D$is.vertexDeclaration:D$e&&D$U&&D$m&&D$k&&D$Y&&D$Z&&D$T?D$r=D$ns.vertexDeclaration:D$e&&D$U&&D$m&&D$k&&D$Y&&D$Z?D$r=D$Xs.vertexDeclaration:D$e&&D$U&&D$k&&D$Y&&D$Z&&D$T?D$r=D$Qs.vertexDeclaration:D$e&&D$U&&D$k&&D$Y&&D$Z?D$r=D$Ss.vertexDeclaration:D$e&&D$U&&D$m&&D$Y&&D$Z&&D$T?D$r=D$As.vertexDeclaration:D$e&&D$U&&D$m&&D$Y&&D$Z?D$r=D$hs.vertexDeclaration:D$e&&D$U&&D$m&&D$k&&D$j&&D$T?D$r=D$ws.vertexDeclaration:D$e&&D$U&&D$m&&D$k&&D$j?D$r=D$ls.vertexDeclaration:D$e&&D$U&&D$k&&D$j&&D$T?D$r=D$vs.vertexDeclaration:D$e&&D$U&&D$k&&D$j?D$r=D$Os.vertexDeclaration:D$e&&D$U&&D$m&&D$k&&D$T?D$r=D$gs.vertexDeclaration:D$e&&D$U&&D$k&&D$T&&D$h?D$r=D$as.vertexDeclaration:D$e&&D$U&&D$m&&D$k?D$r=D$$s.vertexDeclaration:D$e&&D$U&&D$k&&D$T?D$r=D$Rs.vertexDeclaration:D$e&&D$U&&D$k?D$r=D$Ps.vertexDeclaration:D$e&&D$U&&D$m&&D$T?D$r=D$Bs.vertexDeclaration:D$e&&D$U&&D$m&&(D$r=D$Zs.vertexDeclaration),D$r},D$D._attrReg=new RegExp("(\\w+)|([:,;])","g"),D$D._strings=[],D$D._readData=null,D$D._version=null,D$D._mesh=null,D$D._materials=null,D$D._subMeshes=null,D$D._materialMap=null,D$H(D$D,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),D$D}(),D$ts=function(){function D$X(){}return D$x(D$X,"laya.d3.loaders.LoadModelV03"),D$X.parse=function(D$s,D$r,D$e,D$U,D$m){D$X._mesh=D$e,D$X._subMeshes=D$U,D$X._materialMap=D$m,D$X._version=D$r,D$X._readData=D$s,D$X.READ_DATA(),D$X.READ_BLOCK(),D$X.READ_STRINGS();for(var D$k=0,D$j=D$X._BLOCK.count;D$k<D$j;D$k++){D$X._readData.pos=D$X._BLOCK.blockStarts[D$k];var D$T=D$X._readData.getUint16(),D$Y=D$X._strings[D$T],D$Z=D$X["READ_"+D$Y];if(null==D$Z)throw new Error("model file err,no this function:"+D$T+" "+D$Y);D$Z.call()}D$X._strings.length=0,D$X._readData=null,D$X._version=null,D$X._mesh=null,D$X._subMeshes=null,D$X._materialMap=null},D$X._readString=function(){return D$X._strings[D$X._readData.getUint16()]},D$X.READ_DATA=function(){D$X._DATA.offset=D$X._readData.getUint32(),D$X._DATA.size=D$X._readData.getUint32()},D$X.READ_BLOCK=function(){for(var D$s=D$X._BLOCK.count=D$X._readData.getUint16(),D$r=D$X._BLOCK.blockStarts=[],D$e=D$X._BLOCK.blockLengths=[],D$U=0;D$U<D$s;D$U++)D$r.push(D$X._readData.getUint32()),D$e.push(D$X._readData.getUint32())},D$X.READ_STRINGS=function(){var D$s=D$X._readData.getUint32(),D$r=D$X._readData.getUint16(),D$e=D$X._readData.pos;D$X._readData.pos=D$s+D$X._DATA.offset;for(var D$U=0;D$U<D$r;D$U++)D$X._strings[D$U]=D$X._readData.readUTFString();D$X._readData.pos=D$e},D$X.READ_MESH=function(){var D$s,D$r=D$X._readString(),D$e=D$X._readData.__getBuffer(),D$U=0,D$m=D$X._readData.getInt16(),D$k=D$X._DATA.offset;for(D$U=0;D$U<D$m;D$U++){var D$j,D$T=D$k+D$X._readData.getUint32(),D$Y=D$X._readData.getUint32(),D$Z=new Float32Array(D$e.slice(D$T,D$T+D$Y)),D$h=D$X._readString();switch(D$X._version){case"LAYAMODEL:03":D$j=D$X._vertexDeclarationMap_Discard[D$h];break;case"LAYAMODEL:0301":D$j=D$X._vertexDeclarationMap[D$h];break;default:throw new Error("LoadModelV03: unknown version.")}if(!D$j)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+D$X._version+"  bufferAttribute="+D$h+"  name="+D$r+"  url="+(D$X._mesh?D$X._mesh.url:"null"));var D$H=D$Qr.create(D$j,4*D$Z.length/D$j.vertexStride,35044,!0,D$X._mesh._url+"_"+D$U);D$H.setData(D$Z),D$X._mesh._vertexBuffers.push(D$H)}var D$A=D$k+D$X._readData.getUint32(),D$x=D$X._readData.getUint32(),D$B=new Uint16Array(D$e.slice(D$A,D$A+D$x)),D$$=D$zr.create("ushort",D$x/2,35044,!0,D$X._mesh._url);D$$.setData(D$B),D$X._mesh._indexBuffer=D$$;var D$l=D$X._mesh._boneNames=[],D$V=D$X._readData.getUint16();for(D$l.length=D$V,D$U=0;D$U<D$V;D$U++)D$l[D$U]=D$X._strings[D$X._readData.getUint16()];D$X._readData.pos+=8;var D$b=D$X._readData.getUint32(),D$o=D$X._readData.getUint32(),D$I=new Float32Array(D$e.slice(D$k+D$b,D$k+D$b+D$o));for(D$X._mesh._inverseBindPoses=[],D$U=0,D$s=D$I.length;D$U<D$s;D$U+=16){var D$w=new D$sr(D$I[D$U+0],D$I[D$U+1],D$I[D$U+2],D$I[D$U+3],D$I[D$U+4],D$I[D$U+5],D$I[D$U+6],D$I[D$U+7],D$I[D$U+8],D$I[D$U+9],D$I[D$U+10],D$I[D$U+11],D$I[D$U+12],D$I[D$U+13],D$I[D$U+14],D$I[D$U+15]);D$X._mesh._inverseBindPoses.push(D$w)}return D$X._mesh._skinnedDatas=new Float32Array(16*D$I.length),!0},D$X.READ_SUBMESH=function(){var D$s=D$X._readData.__getBuffer(),D$r=new D$Zr(D$X._mesh),D$e=D$X._readData.getInt16(),D$U=D$X._readData.getUint32(),D$m=D$X._readData.getUint32();D$r._vertexBuffer=D$X._mesh._vertexBuffers[D$e],D$r._vertexStart=D$U,D$r._vertexCount=D$m;var D$k=D$X._readData.getUint32(),D$j=D$X._readData.getUint32(),D$T=D$X._mesh._indexBuffer;D$r._indexBuffer=D$T,D$r._indexStart=D$k,D$r._indexCount=D$j,D$r._indices=new Uint16Array(D$T.getData().buffer,2*D$k,D$j);var D$Y=D$X._DATA.offset,D$Z=D$r._subIndexBufferStart,D$h=D$r._subIndexBufferCount,D$H=D$r._boneIndicesList,D$A=D$X._readData.getUint16();D$Z.length=D$A,D$h.length=D$A,D$H.length=D$A;for(var D$x=0;D$x<D$A;D$x++){D$Z[D$x]=D$X._readData.getUint32(),D$h[D$x]=D$X._readData.getUint32();var D$B=D$X._readData.getUint32(),D$$=D$X._readData.getUint32();D$H[D$x]=new Uint8Array(D$s.slice(D$Y+D$B,D$Y+D$B+D$$))}return D$X._subMeshes.push(D$r),!0},D$X._strings=[],D$X._readData=null,D$X._version=null,D$X._mesh=null,D$X._subMeshes=null,D$X._materialMap=null,D$H(D$X,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":D$os.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":D$Vs.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":D$ps.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":D$cs.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":D$is.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":D$ns.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":D$Xs.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":D$Qs.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":D$Ss.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":D$As.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":D$hs.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":D$ws.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":D$ls.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":D$vs.vertexDeclaration,"POSITION,NORMAL,UV,UV1":D$Os.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":D$gs.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":D$as.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":D$$s.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":D$Rs.vertexDeclaration,"POSITION,NORMAL,UV":D$Ps.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":D$Bs.vertexDeclaration,"POSITION,NORMAL,COLOR":D$Zs.vertexDeclaration,"POSITION,NORMAL,TANGENT":D$Js.vertexDeclaration,"POSITION,NORMAL":D$Ys.vertexDeclaration,"POSITION,UV":D$qs.vertexDeclaration,POSITION:D$Ts.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":D$bs.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":D$Vs.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":D$ps.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":D$Ks.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":D$is.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":D$Ds.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":D$Xs.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":D$zs.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":D$Ss.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":D$Hs.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":D$hs.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":D$Is.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":D$ls.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":D$Es.vertexDeclaration,"POSITION,NORMAL,UV,UV1":D$Os.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":D$ys.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":D$as.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":D$$s.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":D$Cs.vertexDeclaration,"POSITION,NORMAL,UV":D$Ps.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":D$xs.vertexDeclaration,"POSITION,NORMAL,COLOR":D$Zs.vertexDeclaration,"POSITION,NORMAL,TANGENT":D$fs.vertexDeclaration,"POSITION,NORMAL":D$Ys.vertexDeclaration,"POSITION,UV":D$qs.vertexDeclaration,POSITION:D$Ts.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),D$X}(),D$Ws=function(){function D$T(){}return D$x(D$T,"laya.d3.loaders.MeshReader"),D$T.read=function(D$s,D$r,D$e,D$U,D$m){var D$k=new D$X(D$s);D$k.pos=0;var D$j=D$k.readUTFString();switch(D$j){case"LAYAMODEL:01":case"LAYASKINANI:01":D$T._readVersion01(D$k,D$j,D$r,D$e,D$U,D$m);break;case"LAYAMODEL:02":D$ds.parse(D$k,D$j,D$r,D$e,D$U,D$m);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":D$ts.parse(D$k,D$j,D$r,D$U,D$m);break;default:throw new Error("MeshReader: unknown mesh version.")}D$r._setSubMeshes(D$U)},D$T._readVersion01=function(D$s,D$r,D$e,D$U,D$m,D$k){new D$Gs(D$s,D$r,D$e,D$U,D$m,D$k)},D$T}(),D$Ls=function(){function D$s(D$s,D$r){this.min=null,this.max=null,this.min=D$s,this.max=D$r}D$x(D$s,"laya.d3.math.BoundBox");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.getCorners=function(D$s){D$s.length=8;var D$r=this.min.elements,D$e=this.max.elements,D$U=D$r[0],D$m=D$r[1],D$k=D$r[2],D$j=D$e[0],D$T=D$e[1],D$Y=D$e[2];D$s[0]=new D$jr(D$U,D$T,D$Y),D$s[1]=new D$jr(D$j,D$T,D$Y),D$s[2]=new D$jr(D$j,D$m,D$Y),D$s[3]=new D$jr(D$U,D$m,D$Y),D$s[4]=new D$jr(D$U,D$T,D$k),D$s[5]=new D$jr(D$j,D$T,D$k),D$s[6]=new D$jr(D$j,D$m,D$k),D$s[7]=new D$jr(D$U,D$m,D$k)},D$r.toDefault=function(){this.min.toDefault(),this.max.toDefault()},D$r.cloneTo=function(D$s){var D$r=D$s;this.min.cloneTo(D$r.min),this.max.cloneTo(D$r.max)},D$r.clone=function(){var D$s=new this.constructor(new D$jr,new D$jr);return this.cloneTo(D$s),D$s},D$s.createfromPoints=function(D$s,D$r){if(null==D$s)throw new Error("points");var D$e=D$r.min,D$U=D$r.max,D$m=D$e.elements;D$m[0]=Number.MAX_VALUE,D$m[1]=Number.MAX_VALUE,D$m[2]=Number.MAX_VALUE;var D$k=D$U.elements;D$k[0]=-Number.MAX_VALUE,D$k[1]=-Number.MAX_VALUE,D$k[2]=-Number.MAX_VALUE;for(var D$j=0,D$T=D$s.length;D$j<D$T;++D$j)D$jr.min(D$e,D$s[D$j],D$e),D$jr.max(D$U,D$s[D$j],D$U)},D$s.merge=function(D$s,D$r,D$e){D$jr.min(D$s.min,D$r.min,D$e.min),D$jr.max(D$s.max,D$r.max,D$e.max)},D$s}(),D$us=function(){function D$Z(D$s){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=D$s,this._near=new D$rr(new D$jr),this._far=new D$rr(new D$jr),this._left=new D$rr(new D$jr),this._right=new D$rr(new D$jr),this._top=new D$rr(new D$jr),this._bottom=new D$rr(new D$jr),D$Z._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}D$x(D$Z,"laya.d3.math.BoundFrustum");var D$s=D$Z.prototype;return D$s.equalsBoundFrustum=function(D$s){return this._matrix.equalsOtherMatrix(D$s.matrix)},D$s.equalsObj=function(D$s){if(D$s instanceof laya.d3.math.BoundFrustum){var D$r=D$s;return this.equalsBoundFrustum(D$r)}return!1},D$s.getPlane=function(D$s){switch(D$s){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},D$s.getCorners=function(D$s){D$Z._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(D$s[0]),D$Z._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(D$s[1]),D$Z._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(D$s[2]),D$Z._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(D$s[3]),D$Z._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(D$s[4]),D$Z._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(D$s[5]),D$Z._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(D$s[6]),D$Z._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(D$s[7])},D$s.containsPoint=function(D$s){for(var D$r=D$rr.PlaneIntersectionType_Front,D$e=D$rr.PlaneIntersectionType_Front,D$U=0;D$U<6;D$U++){switch(D$U){case 0:D$e=Collision.intersectsPlaneAndPoint(this._near,D$s);break;case 1:D$e=Collision.intersectsPlaneAndPoint(this._far,D$s);break;case 2:D$e=Collision.intersectsPlaneAndPoint(this._left,D$s);break;case 3:D$e=Collision.intersectsPlaneAndPoint(this._right,D$s);break;case 4:D$e=Collision.intersectsPlaneAndPoint(this._top,D$s);break;case 5:D$e=Collision.intersectsPlaneAndPoint(this._bottom,D$s)}switch(D$e){case D$rr.PlaneIntersectionType_Back:return 0;case D$rr.PlaneIntersectionType_Intersecting:D$r=D$rr.PlaneIntersectionType_Intersecting}}switch(D$r){case D$rr.PlaneIntersectionType_Intersecting:return 2;default:return 1}},D$s.containsBoundBox=function(D$s){for(var D$r,D$e=D$Z._tempV30,D$U=D$Z._tempV31,D$m=1,D$k=0;D$k<6;D$k++){if(D$r=this.getPlane(D$k),this._getBoxToPlanePVertexNVertex(D$s,D$r.normal,D$e,D$U),Collision.intersectsPlaneAndPoint(D$r,D$e)===D$rr.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(D$r,D$U)===D$rr.PlaneIntersectionType_Back&&(D$m=2)}return D$m},D$s.containsBoundSphere=function(D$s){for(var D$r=D$rr.PlaneIntersectionType_Front,D$e=D$rr.PlaneIntersectionType_Front,D$U=0;D$U<6;D$U++){switch(D$U){case 0:D$e=Collision.intersectsPlaneAndSphere(this._near,D$s);break;case 1:D$e=Collision.intersectsPlaneAndSphere(this._far,D$s);break;case 2:D$e=Collision.intersectsPlaneAndSphere(this._left,D$s);break;case 3:D$e=Collision.intersectsPlaneAndSphere(this._right,D$s);break;case 4:D$e=Collision.intersectsPlaneAndSphere(this._top,D$s);break;case 5:D$e=Collision.intersectsPlaneAndSphere(this._bottom,D$s)}switch(D$e){case D$rr.PlaneIntersectionType_Back:return 0;case D$rr.PlaneIntersectionType_Intersecting:D$r=D$rr.PlaneIntersectionType_Intersecting}}switch(D$r){case D$rr.PlaneIntersectionType_Intersecting:return 2;default:return 1}},D$s._getBoxToPlanePVertexNVertex=function(D$s,D$r,D$e,D$U){var D$m=D$s.min,D$k=D$m.elements,D$j=D$s.max,D$T=D$j.elements,D$Y=D$r.elements,D$Z=D$Y[0],D$h=D$Y[1],D$H=D$Y[2];D$m.cloneTo(D$e);var D$A=D$e.elements;0<=D$Z&&(D$A[0]=D$T[0]),0<=D$h&&(D$A[1]=D$T[1]),0<=D$H&&(D$A[2]=D$T[2]),D$j.cloneTo(D$U);var D$x=D$U.elements;0<=D$Z&&(D$x[0]=D$k[0]),0<=D$h&&(D$x[1]=D$k[1]),0<=D$H&&(D$x[2]=D$k[2])},D$B(0,D$s,"top",function(){return this._top}),D$B(0,D$s,"matrix",function(){return this._matrix},function(D$s){this._matrix=D$s,D$Z._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),D$B(0,D$s,"near",function(){return this._near}),D$B(0,D$s,"far",function(){return this._far}),D$B(0,D$s,"left",function(){return this._left}),D$B(0,D$s,"right",function(){return this._right}),D$B(0,D$s,"bottom",function(){return this._bottom}),D$Z._getPlanesFromMatrix=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){var D$T=D$s.elements,D$Y=D$T[0],D$Z=D$T[1],D$h=D$T[2],D$H=D$T[3],D$A=D$T[4],D$x=D$T[5],D$B=D$T[6],D$$=D$T[7],D$l=D$T[8],D$V=D$T[9],D$b=D$T[10],D$o=D$T[11],D$I=D$T[12],D$w=D$T[13],D$X=D$T[14],D$D=D$T[15],D$n=D$r.normal.elements;D$n[0]=D$H+D$h,D$n[1]=D$$+D$B,D$n[2]=D$o+D$b,D$r.distance=D$D+D$X,D$r.normalize();var D$y=D$e.normal.elements;D$y[0]=D$H-D$h,D$y[1]=D$$-D$B,D$y[2]=D$o-D$b,D$e.distance=D$D-D$X,D$e.normalize();var D$g=D$U.normal.elements;D$g[0]=D$H+D$Y,D$g[1]=D$$+D$A,D$g[2]=D$o+D$l,D$U.distance=D$D+D$I,D$U.normalize();var D$f=D$m.normal.elements;D$f[0]=D$H-D$Y,D$f[1]=D$$-D$A,D$f[2]=D$o-D$l,D$m.distance=D$D-D$I,D$m.normalize();var D$J=D$k.normal.elements;D$J[0]=D$H-D$Z,D$J[1]=D$$-D$x,D$J[2]=D$o-D$V,D$k.distance=D$D-D$w,D$k.normalize();var D$P=D$j.normal.elements;D$P[0]=D$H+D$Z,D$P[1]=D$$+D$x,D$P[2]=D$o+D$V,D$j.distance=D$D+D$w,D$j.normalize()},D$Z._get3PlaneInterPoint=function(D$s,D$r,D$e){var D$U=D$s.normal,D$m=D$r.normal,D$k=D$e.normal;D$jr.cross(D$m,D$k,D$Z._tempV30),D$jr.cross(D$k,D$U,D$Z._tempV31),D$jr.cross(D$U,D$m,D$Z._tempV32);var D$j=D$jr.dot(D$U,D$Z._tempV30),D$T=D$jr.dot(D$m,D$Z._tempV31),D$Y=D$jr.dot(D$k,D$Z._tempV32);return D$jr.scale(D$Z._tempV30,-D$s.distance/D$j,D$Z._tempV33),D$jr.scale(D$Z._tempV31,-D$r.distance/D$T,D$Z._tempV34),D$jr.scale(D$Z._tempV32,-D$e.distance/D$Y,D$Z._tempV35),D$jr.add(D$Z._tempV33,D$Z._tempV34,D$Z._tempV36),D$jr.add(D$Z._tempV35,D$Z._tempV36,D$Z._tempV37),D$Z._tempV37},D$H(D$Z,["_tempV30",function(){return this._tempV30=new D$jr},"_tempV31",function(){return this._tempV31=new D$jr},"_tempV32",function(){return this._tempV32=new D$jr},"_tempV33",function(){return this._tempV33=new D$jr},"_tempV34",function(){return this._tempV34=new D$jr},"_tempV35",function(){return this._tempV35=new D$jr},"_tempV36",function(){return this._tempV36=new D$jr},"_tempV37",function(){return this._tempV37=new D$jr}]),D$Z}(),D$Ms=function(){function D$h(D$s,D$r){this.center=null,this.radius=NaN,this.center=D$s,this.radius=D$r}D$x(D$h,"laya.d3.math.BoundSphere");var D$s=D$h.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.toDefault=function(){this.center.toDefault(),this.radius=0},D$s.intersectsRayDistance=function(D$s){return Collision.intersectsRayAndSphereRD(D$s,this)},D$s.intersectsRayPoint=function(D$s,D$r){return Collision.intersectsRayAndSphereRP(D$s,this,D$r)},D$s.cloneTo=function(D$s){var D$r=D$s;this.center.cloneTo(D$r.center),D$r.radius=this.radius},D$s.clone=function(){var D$s=new this.constructor(new D$jr,new D$jr);return this.cloneTo(D$s),D$s},D$h.createFromSubPoints=function(D$s,D$r,D$e,D$U){if(null==D$s)throw new Error("points");if(D$r<0||D$r>=D$s.length)throw new Error("start"+D$r+"Must be in the range [0, "+(D$s.length-1)+"]");if(D$e<0||D$r+D$e>D$s.length)throw new Error("count"+D$e+"Must be in the range <= "+D$s.length+"}");var D$m=D$r+D$e,D$k=D$h._tempVector3;D$k.elements[0]=0,D$k.elements[1]=0,D$k.elements[2]=0;for(var D$j=D$r;D$j<D$m;++D$j)D$jr.add(D$s[D$j],D$k,D$k);var D$T=D$U.center;D$jr.scale(D$k,1/D$e,D$T);var D$Y=0;for(D$j=D$r;D$j<D$m;++D$j){var D$Z=D$jr.distanceSquared(D$T,D$s[D$j]);D$Y<D$Z&&(D$Y=D$Z)}D$U.radius=Math.sqrt(D$Y)},D$h.createfromPoints=function(D$s,D$r){if(null==D$s)throw new Error("points");D$h.createFromSubPoints(D$s,0,D$s.length,D$r)},D$H(D$h,["_tempVector3",function(){return this._tempVector3=new D$jr}]),D$h}(),D$_s=(function(){function D$s(){}D$x(D$s,"laya.d3.math.ContainmentType"),D$s.Disjoint=0,D$s.Contains=1,D$s.Intersects=2}(),function(){function D$e(){}return D$x(D$e,"laya.d3.math.MathUtils3D"),D$e.isZero=function(D$s){return Math.abs(D$s)<D$e.zeroTolerance},D$e.nearEqual=function(D$s,D$r){return!!D$e.isZero(D$s-D$r)},D$e.fastInvSqrt=function(D$s){return D$e.isZero(D$s)?D$s:1/Math.sqrt(D$s)},D$H(D$e,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),D$e}()),D$Fs=function(){function D$Y(){var D$s=this.elements=new Float32Array(9);D$s[0]=1,D$s[1]=0,D$s[2]=0,D$s[3]=0,D$s[4]=1,D$s[5]=0,D$s[6]=0,D$s[7]=0,D$s[8]=1}D$x(D$Y,"laya.d3.math.Matrix3x3");var D$s=D$Y.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.determinant=function(){var D$s=this.elements,D$r=D$s[0],D$e=D$s[1],D$U=D$s[2],D$m=D$s[3],D$k=D$s[4],D$j=D$s[5],D$T=D$s[6],D$Y=D$s[7],D$Z=D$s[8];return D$r*(D$Z*D$k-D$j*D$Y)+D$e*(-D$Z*D$m+D$j*D$T)+D$U*(D$Y*D$m-D$k*D$T)},D$s.translate=function(D$s,D$r){var D$e=D$r.elements,D$U=this.elements,D$m=D$s.elements,D$k=D$U[0],D$j=D$U[1],D$T=D$U[2],D$Y=D$U[3],D$Z=D$U[4],D$h=D$U[5],D$H=D$U[6],D$A=D$U[7],D$x=D$U[8],D$B=D$m[0],D$$=D$m[1];D$e[0]=D$k,D$e[1]=D$j,D$e[2]=D$T,D$e[3]=D$Y,D$e[4]=D$Z,D$e[5]=D$h,D$e[6]=D$B*D$k+D$$*D$Y+D$H,D$e[7]=D$B*D$j+D$$*D$Z+D$A,D$e[8]=D$B*D$T+D$$*D$h+D$x},D$s.rotate=function(D$s,D$r){var D$e=D$r.elements,D$U=this.elements,D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$U[3],D$Y=D$U[4],D$Z=D$U[5],D$h=D$U[6],D$H=D$U[7],D$A=D$U[8],D$x=Math.sin(D$s),D$B=Math.cos(D$s);D$e[0]=D$B*D$m+D$x*D$T,D$e[1]=D$B*D$k+D$x*D$Y,D$e[2]=D$B*D$j+D$x*D$Z,D$e[3]=D$B*D$T-D$x*D$m,D$e[4]=D$B*D$Y-D$x*D$k,D$e[5]=D$B*D$Z-D$x*D$j,D$e[6]=D$h,D$e[7]=D$H,D$e[8]=D$A},D$s.scale=function(D$s,D$r){var D$e=D$r.elements,D$U=this.elements,D$m=D$s.elements,D$k=D$m[0],D$j=D$m[1];D$e[0]=D$k*D$U[0],D$e[1]=D$k*D$U[1],D$e[2]=D$k*D$U[2],D$e[3]=D$j*D$U[3],D$e[4]=D$j*D$U[4],D$e[5]=D$j*D$U[5],D$e[6]=D$U[6],D$e[7]=D$U[7],D$e[8]=D$U[8]},D$s.invert=function(D$s){var D$r=D$s.elements,D$e=this.elements,D$U=D$e[0],D$m=D$e[1],D$k=D$e[2],D$j=D$e[3],D$T=D$e[4],D$Y=D$e[5],D$Z=D$e[6],D$h=D$e[7],D$H=D$e[8],D$A=D$H*D$T-D$Y*D$h,D$x=-D$H*D$j+D$Y*D$Z,D$B=D$h*D$j-D$T*D$Z,D$$=D$U*D$A+D$m*D$x+D$k*D$B;D$$||(D$s=null),D$$=1/D$$,D$r[0]=D$A*D$$,D$r[1]=(-D$H*D$m+D$k*D$h)*D$$,D$r[2]=(D$Y*D$m-D$k*D$T)*D$$,D$r[3]=D$x*D$$,D$r[4]=(D$H*D$U-D$k*D$Z)*D$$,D$r[5]=(-D$Y*D$U+D$k*D$j)*D$$,D$r[6]=D$B*D$$,D$r[7]=(-D$h*D$U+D$m*D$Z)*D$$,D$r[8]=(D$T*D$U-D$m*D$j)*D$$},D$s.transpose=function(D$s){var D$r=D$s.elements,D$e=this.elements;if(D$s===this){var D$U=D$e[1],D$m=D$e[2],D$k=D$e[5];D$r[1]=D$e[3],D$r[2]=D$e[6],D$r[3]=D$U,D$r[5]=D$e[7],D$r[6]=D$m,D$r[7]=D$k}else D$r[0]=D$e[0],D$r[1]=D$e[3],D$r[2]=D$e[6],D$r[3]=D$e[1],D$r[4]=D$e[4],D$r[5]=D$e[7],D$r[6]=D$e[2],D$r[7]=D$e[5],D$r[8]=D$e[8]},D$s.identity=function(){var D$s=this.elements;D$s[0]=1,D$s[1]=0,D$s[2]=0,D$s[3]=0,D$s[4]=1,D$s[5]=0,D$s[6]=0,D$s[7]=0,D$s[8]=1},D$s.cloneTo=function(D$s){var D$r,D$e,D$U;if((D$e=this.elements)!==(D$U=D$s.elements))for(D$r=0;D$r<9;++D$r)D$U[D$r]=D$e[D$r]},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$Y.createFromTranslation=function(D$s,D$r){D$r.elements;var D$e=D$s.elements;D$r[0]=1,D$r[1]=0,D$r[2]=0,D$r[3]=0,D$r[4]=1,D$r[5]=0,D$r[6]=D$e[0],D$r[7]=D$e[1],D$r[8]=1},D$Y.createFromRotation=function(D$s,D$r){var D$e=D$r.elements,D$U=Math.sin(D$s),D$m=Math.cos(D$s);D$e[0]=D$m,D$e[1]=D$U,D$e[2]=0,D$e[3]=-D$U,D$e[4]=D$m,D$e[5]=0,D$e[6]=0,D$e[7]=0,D$e[8]=1},D$Y.createFromScaling=function(D$s,D$r){var D$e=D$r.elements,D$U=D$s.elements;D$e[0]=D$U[0],D$e[1]=0,D$e[2]=0,D$e[3]=0,D$e[4]=D$U[1],D$e[5]=0,D$e[6]=0,D$e[7]=0,D$e[8]=1},D$Y.createFromMatrix4x4=function(D$s,D$r){D$r[0]=D$s[0],D$r[1]=D$s[1],D$r[2]=D$s[2],D$r[3]=D$s[4],D$r[4]=D$s[5],D$r[5]=D$s[6],D$r[6]=D$s[8],D$r[7]=D$s[9],D$r[8]=D$s[10]},D$Y.multiply=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements,D$j=D$m[0],D$T=D$m[1],D$Y=D$m[2],D$Z=D$m[3],D$h=D$m[4],D$H=D$m[5],D$A=D$m[6],D$x=D$m[7],D$B=D$m[8],D$$=D$k[0],D$l=D$k[1],D$V=D$k[2],D$b=D$k[3],D$o=D$k[4],D$I=D$k[5],D$w=D$k[6],D$X=D$k[7],D$D=D$k[8];D$U[0]=D$$*D$j+D$l*D$Z+D$V*D$A,D$U[1]=D$$*D$T+D$l*D$h+D$V*D$x,D$U[2]=D$$*D$Y+D$l*D$H+D$V*D$B,D$U[3]=D$b*D$j+D$o*D$Z+D$I*D$A,D$U[4]=D$b*D$T+D$o*D$h+D$I*D$x,D$U[5]=D$b*D$Y+D$o*D$H+D$I*D$B,D$U[6]=D$w*D$j+D$X*D$Z+D$D*D$A,D$U[7]=D$w*D$T+D$X*D$h+D$D*D$x,D$U[8]=D$w*D$Y+D$X*D$H+D$D*D$B},D$Y.lookAt=function(D$s,D$r,D$e,D$U){D$jr.subtract(D$s,D$r,D$Y._tempV30),D$jr.normalize(D$Y._tempV30,D$Y._tempV30),D$jr.cross(D$e,D$Y._tempV30,D$Y._tempV31),D$jr.normalize(D$Y._tempV31,D$Y._tempV31),D$jr.cross(D$Y._tempV30,D$Y._tempV31,D$Y._tempV32);var D$m=D$Y._tempV30.elements,D$k=D$Y._tempV31.elements,D$j=D$Y._tempV32.elements,D$T=D$U.elements;D$T[0]=D$k[0],D$T[3]=D$k[1],D$T[6]=D$k[2],D$T[1]=D$j[0],D$T[4]=D$j[1],D$T[7]=D$j[2],D$T[2]=D$m[0],D$T[5]=D$m[1],D$T[8]=D$m[2]},D$Y.DEFAULT=new D$Y,D$H(D$Y,["_tempV30",function(){return this._tempV30=new D$jr},"_tempV31",function(){return this._tempV31=new D$jr},"_tempV32",function(){return this._tempV32=new D$jr}]),D$Y}(),D$sr=function(){function D$y(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H,D$A,D$x,D$B,D$$){void 0===D$s&&(D$s=1),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=1),void 0===D$j&&(D$j=0),void 0===D$T&&(D$T=0),void 0===D$Y&&(D$Y=0),void 0===D$Z&&(D$Z=0),void 0===D$h&&(D$h=1),void 0===D$H&&(D$H=0),void 0===D$A&&(D$A=0),void 0===D$x&&(D$x=0),void 0===D$B&&(D$B=0),void 0===D$$&&(D$$=1);var D$l=this.elements=new Float32Array(16);D$l[0]=D$s,D$l[1]=D$r,D$l[2]=D$e,D$l[3]=D$U,D$l[4]=D$m,D$l[5]=D$k,D$l[6]=D$j,D$l[7]=D$T,D$l[8]=D$Y,D$l[9]=D$Z,D$l[10]=D$h,D$l[11]=D$H,D$l[12]=D$A,D$l[13]=D$x,D$l[14]=D$B,D$l[15]=D$$}D$x(D$y,"laya.d3.math.Matrix4x4");var D$s=D$y.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.getElementByRowColumn=function(D$s,D$r){if(D$s<0||3<D$s)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(D$r<0||3<D$r)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*D$s+D$r]},D$s.setElementByRowColumn=function(D$s,D$r,D$e){if(D$s<0||3<D$s)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(D$r<0||3<D$r)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*D$s+D$r]=D$e},D$s.equalsOtherMatrix=function(D$s){var D$r=this.elements,D$e=D$s.elements;return D$_s.nearEqual(D$r[0],D$e[0])&&D$_s.nearEqual(D$r[1],D$e[1])&&D$_s.nearEqual(D$r[2],D$e[2])&&D$_s.nearEqual(D$r[3],D$e[3])&&D$_s.nearEqual(D$r[4],D$e[4])&&D$_s.nearEqual(D$r[5],D$e[5])&&D$_s.nearEqual(D$r[6],D$e[6])&&D$_s.nearEqual(D$r[7],D$e[7])&&D$_s.nearEqual(D$r[8],D$e[8])&&D$_s.nearEqual(D$r[9],D$e[9])&&D$_s.nearEqual(D$r[10],D$e[10])&&D$_s.nearEqual(D$r[11],D$e[11])&&D$_s.nearEqual(D$r[12],D$e[12])&&D$_s.nearEqual(D$r[13],D$e[13])&&D$_s.nearEqual(D$r[14],D$e[14])&&D$_s.nearEqual(D$r[15],D$e[15])},D$s.decomposeTransRotScale=function(D$s,D$r,D$e){var D$U=D$y._tempMatrix4x4;return this.decomposeTransRotMatScale(D$s,D$U,D$e)?(D$er.createFromMatrix4x4(D$U,D$r),!0):(D$r.identity(),!1)},D$s.decomposeTransRotMatScale=function(D$s,D$r,D$e){var D$U=this.elements,D$m=D$s.elements,D$k=D$r.elements,D$j=D$e.elements;D$m[0]=D$U[12],D$m[1]=D$U[13],D$m[2]=D$U[14];var D$T=D$U[0],D$Y=D$U[1],D$Z=D$U[2],D$h=D$U[4],D$H=D$U[5],D$A=D$U[6],D$x=D$U[8],D$B=D$U[9],D$$=D$U[10],D$l=D$j[0]=Math.sqrt(D$T*D$T+D$Y*D$Y+D$Z*D$Z),D$V=D$j[1]=Math.sqrt(D$h*D$h+D$H*D$H+D$A*D$A),D$b=D$j[2]=Math.sqrt(D$x*D$x+D$B*D$B+D$$*D$$);if(D$_s.isZero(D$l)||D$_s.isZero(D$V)||D$_s.isZero(D$b))return D$k[1]=D$k[2]=D$k[3]=D$k[4]=D$k[6]=D$k[7]=D$k[8]=D$k[9]=D$k[11]=D$k[12]=D$k[13]=D$k[14]=0,D$k[0]=D$k[5]=D$k[10]=D$k[15]=1,!1;var D$o=D$y._tempVector0,D$I=D$o.elements;D$I[0]=D$x/D$b,D$I[1]=D$B/D$b,D$I[2]=D$$/D$b;var D$w=D$y._tempVector1,D$X=D$w.elements;D$X[0]=D$T/D$l,D$X[1]=D$Y/D$l,D$X[2]=D$Z/D$l;var D$D=D$y._tempVector2;D$jr.cross(D$o,D$w,D$D);var D$n=D$y._tempVector1;return D$jr.cross(D$D,D$o,D$n),D$k[3]=D$k[7]=D$k[11]=D$k[12]=D$k[13]=D$k[14]=0,D$k[15]=1,D$k[0]=D$n.x,D$k[1]=D$n.y,D$k[2]=D$n.z,D$k[4]=D$D.x,D$k[5]=D$D.y,D$k[6]=D$D.z,D$k[8]=D$o.x,D$k[9]=D$o.y,D$k[10]=D$o.z,D$k[0]*D$T+D$k[1]*D$Y+D$k[2]*D$Z<0&&(D$j[0]=-D$l),D$k[4]*D$h+D$k[5]*D$H+D$k[6]*D$A<0&&(D$j[1]=-D$V),D$k[8]*D$x+D$k[9]*D$B+D$k[10]*D$$<0&&(D$j[2]=-D$b),!0},D$s.decomposeYawPitchRoll=function(D$s){var D$r=D$s.elements,D$e=Math.asin(-this.elements[9]);D$r[1]=D$e,Math.cos(D$e)>D$_s.zeroTolerance?(D$r[2]=Math.atan2(this.elements[1],this.elements[5]),D$r[0]=Math.atan2(this.elements[8],this.elements[10])):(D$r[2]=Math.atan2(-this.elements[4],this.elements[0]),D$r[0]=0)},D$s.normalize=function(){var D$s=this.elements,D$r=D$s[0],D$e=D$s[1],D$U=D$s[2],D$m=Math.sqrt(D$r*D$r+D$e*D$e+D$U*D$U);if(!D$m)return D$s[0]=0,D$s[1]=0,void(D$s[2]=0);1!=D$m&&(D$m=1/D$m,D$s[0]=D$r*D$m,D$s[1]=D$e*D$m,D$s[2]=D$U*D$m)},D$s.transpose=function(){var D$s,D$r;return D$r=(D$s=this.elements)[1],D$s[1]=D$s[4],D$s[4]=D$r,D$r=D$s[2],D$s[2]=D$s[8],D$s[8]=D$r,D$r=D$s[3],D$s[3]=D$s[12],D$s[12]=D$r,D$r=D$s[6],D$s[6]=D$s[9],D$s[9]=D$r,D$r=D$s[7],D$s[7]=D$s[13],D$s[13]=D$r,D$r=D$s[11],D$s[11]=D$s[14],D$s[14]=D$r,this},D$s.invert=function(D$s){var D$r=this.elements,D$e=D$s.elements,D$U=D$r[0],D$m=D$r[1],D$k=D$r[2],D$j=D$r[3],D$T=D$r[4],D$Y=D$r[5],D$Z=D$r[6],D$h=D$r[7],D$H=D$r[8],D$A=D$r[9],D$x=D$r[10],D$B=D$r[11],D$$=D$r[12],D$l=D$r[13],D$V=D$r[14],D$b=D$r[15],D$o=D$U*D$Y-D$m*D$T,D$I=D$U*D$Z-D$k*D$T,D$w=D$U*D$h-D$j*D$T,D$X=D$m*D$Z-D$k*D$Y,D$D=D$m*D$h-D$j*D$Y,D$n=D$k*D$h-D$j*D$Z,D$y=D$H*D$l-D$A*D$$,D$g=D$H*D$V-D$x*D$$,D$f=D$H*D$b-D$B*D$$,D$J=D$A*D$V-D$x*D$l,D$P=D$A*D$b-D$B*D$l,D$O=D$x*D$b-D$B*D$V,D$i=D$o*D$O-D$I*D$P+D$w*D$J+D$X*D$f-D$D*D$g+D$n*D$y;0!==Math.abs(D$i)&&(D$i=1/D$i,D$e[0]=(D$Y*D$O-D$Z*D$P+D$h*D$J)*D$i,D$e[1]=(D$k*D$P-D$m*D$O-D$j*D$J)*D$i,D$e[2]=(D$l*D$n-D$V*D$D+D$b*D$X)*D$i,D$e[3]=(D$x*D$D-D$A*D$n-D$B*D$X)*D$i,D$e[4]=(D$Z*D$f-D$T*D$O-D$h*D$g)*D$i,D$e[5]=(D$U*D$O-D$k*D$f+D$j*D$g)*D$i,D$e[6]=(D$V*D$w-D$$*D$n-D$b*D$I)*D$i,D$e[7]=(D$H*D$n-D$x*D$w+D$B*D$I)*D$i,D$e[8]=(D$T*D$P-D$Y*D$f+D$h*D$y)*D$i,D$e[9]=(D$m*D$f-D$U*D$P-D$j*D$y)*D$i,D$e[10]=(D$$*D$D-D$l*D$w+D$b*D$o)*D$i,D$e[11]=(D$A*D$w-D$H*D$D-D$B*D$o)*D$i,D$e[12]=(D$Y*D$g-D$T*D$J-D$Z*D$y)*D$i,D$e[13]=(D$U*D$J-D$m*D$g+D$k*D$y)*D$i,D$e[14]=(D$l*D$I-D$$*D$X-D$V*D$o)*D$i,D$e[15]=(D$H*D$X-D$A*D$I+D$x*D$o)*D$i)},D$s.identity=function(){var D$s=this.elements;D$s[1]=D$s[2]=D$s[3]=D$s[4]=D$s[6]=D$s[7]=D$s[8]=D$s[9]=D$s[11]=D$s[12]=D$s[13]=D$s[14]=0,D$s[0]=D$s[5]=D$s[10]=D$s[15]=1},D$s.cloneTo=function(D$s){var D$r,D$e,D$U;if((D$e=this.elements)!==(D$U=D$s.elements))for(D$r=0;D$r<16;++D$r)D$U[D$r]=D$e[D$r]},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$s.getTranslationVector=function(D$s){var D$r=this.elements,D$e=D$s.elements;D$e[0]=D$r[12],D$e[1]=D$r[13],D$e[2]=D$r[14]},D$s.setTranslationVector=function(D$s){var D$r=this.elements,D$e=D$s.elements;D$r[12]=D$e[0],D$r[13]=D$e[1],D$r[14]=D$e[2]},D$s.getForward=function(D$s){var D$r=this.elements,D$e=D$s.elements;D$e[0]=-D$r[8],D$e[1]=-D$r[9],D$e[2]=-D$r[10]},D$s.setForward=function(D$s){var D$r=this.elements,D$e=D$s.elements;D$r[8]=-D$e[0],D$r[9]=-D$e[1],D$r[10]=-D$e[2]},D$y.createRotationX=function(D$s,D$r){var D$e=D$r.elements,D$U=Math.sin(D$s),D$m=Math.cos(D$s);D$e[1]=D$e[2]=D$e[3]=D$e[4]=D$e[7]=D$e[8]=D$e[11]=D$e[12]=D$e[13]=D$e[14]=0,D$e[0]=D$e[15]=1,D$e[5]=D$e[10]=D$m,D$e[6]=D$U,D$e[9]=-D$U},D$y.createRotationY=function(D$s,D$r){var D$e=D$r.elements,D$U=Math.sin(D$s),D$m=Math.cos(D$s);D$e[1]=D$e[3]=D$e[4]=D$e[6]=D$e[7]=D$e[9]=D$e[11]=D$e[12]=D$e[13]=D$e[14]=0,D$e[5]=D$e[15]=1,D$e[0]=D$e[10]=D$m,D$e[2]=-D$U,D$e[8]=D$U},D$y.createRotationZ=function(D$s,D$r){var D$e=D$r.elements,D$U=Math.sin(D$s),D$m=Math.cos(D$s);D$e[2]=D$e[3]=D$e[6]=D$e[7]=D$e[8]=D$e[9]=D$e[11]=D$e[12]=D$e[13]=D$e[14]=0,D$e[10]=D$e[15]=1,D$e[0]=D$e[5]=D$m,D$e[1]=D$U,D$e[4]=-D$U},D$y.createRotationYawPitchRoll=function(D$s,D$r,D$e,D$U){D$er.createFromYawPitchRoll(D$s,D$r,D$e,D$y._tempQuaternion),D$y.createRotationQuaternion(D$y._tempQuaternion,D$U)},D$y.createRotationAxis=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=Math.cos(D$r),D$Y=Math.sin(D$r),D$Z=D$m*D$m,D$h=D$k*D$k,D$H=D$j*D$j,D$A=D$m*D$k,D$x=D$m*D$j,D$B=D$k*D$j,D$$=D$e.elements;D$$[3]=D$$[7]=D$$[11]=D$$[12]=D$$[13]=D$$[14]=0,D$$[15]=1,D$$[0]=D$Z+D$T*(1-D$Z),D$$[1]=D$A-D$T*D$A+D$Y*D$j,D$$[2]=D$x-D$T*D$x-D$Y*D$k,D$$[4]=D$A-D$T*D$A-D$Y*D$j,D$$[5]=D$h+D$T*(1-D$h),D$$[6]=D$B-D$T*D$B+D$Y*D$m,D$$[8]=D$x-D$T*D$x+D$Y*D$k,D$$[9]=D$B-D$T*D$B-D$Y*D$m,D$$[10]=D$H+D$T*(1-D$H)},D$y.createRotationQuaternion=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$e[0],D$k=D$e[1],D$j=D$e[2],D$T=D$e[3],D$Y=D$m*D$m,D$Z=D$k*D$k,D$h=D$j*D$j,D$H=D$m*D$k,D$A=D$j*D$T,D$x=D$j*D$m,D$B=D$k*D$T,D$$=D$k*D$j,D$l=D$m*D$T;D$U[3]=D$U[7]=D$U[11]=D$U[12]=D$U[13]=D$U[14]=0,D$U[15]=1,D$U[0]=1-2*(D$Z+D$h),D$U[1]=2*(D$H+D$A),D$U[2]=2*(D$x-D$B),D$U[4]=2*(D$H-D$A),D$U[5]=1-2*(D$h+D$Y),D$U[6]=2*(D$$+D$l),D$U[8]=2*(D$x+D$B),D$U[9]=2*(D$$-D$l),D$U[10]=1-2*(D$Z+D$Y)},D$y.createTranslate=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;D$U[4]=D$U[8]=D$U[1]=D$U[9]=D$U[2]=D$U[6]=D$U[3]=D$U[7]=D$U[11]=0,D$U[0]=D$U[5]=D$U[10]=D$U[15]=1,D$U[12]=D$e[0],D$U[13]=D$e[1],D$U[14]=D$e[2]},D$y.createScaling=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;D$U[0]=D$e[0],D$U[5]=D$e[1],D$U[10]=D$e[2],D$U[1]=D$U[4]=D$U[8]=D$U[12]=D$U[9]=D$U[13]=D$U[2]=D$U[6]=D$U[14]=D$U[3]=D$U[7]=D$U[11]=0,D$U[15]=1},D$y.multiply=function(D$s,D$r,D$e){var D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h;for(D$m=D$e.elements,D$k=D$s.elements,D$m===(D$j=D$r.elements)&&(D$j=D$j.slice()),D$U=0;D$U<4;D$U++)D$T=D$k[D$U],D$Y=D$k[D$U+4],D$Z=D$k[D$U+8],D$h=D$k[D$U+12],D$m[D$U]=D$T*D$j[0]+D$Y*D$j[1]+D$Z*D$j[2]+D$h*D$j[3],D$m[D$U+4]=D$T*D$j[4]+D$Y*D$j[5]+D$Z*D$j[6]+D$h*D$j[7],D$m[D$U+8]=D$T*D$j[8]+D$Y*D$j[9]+D$Z*D$j[10]+D$h*D$j[11],D$m[D$U+12]=D$T*D$j[12]+D$Y*D$j[13]+D$Z*D$j[14]+D$h*D$j[15]},D$y.createFromQuaternion=function(D$s,D$r){var D$e=D$r.elements,D$U=D$s.elements,D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$U[3],D$Y=D$m+D$m,D$Z=D$k+D$k,D$h=D$j+D$j,D$H=D$m*D$Y,D$A=D$k*D$Y,D$x=D$k*D$Z,D$B=D$j*D$Y,D$$=D$j*D$Z,D$l=D$j*D$h,D$V=D$T*D$Y,D$b=D$T*D$Z,D$o=D$T*D$h;D$e[0]=1-D$x-D$l,D$e[1]=D$A+D$o,D$e[2]=D$B-D$b,D$e[3]=0,D$e[4]=D$A-D$o,D$e[5]=1-D$H-D$l,D$e[6]=D$$+D$V,D$e[7]=0,D$e[8]=D$B+D$b,D$e[9]=D$$-D$V,D$e[10]=1-D$H-D$x,D$e[11]=0,D$e[12]=0,D$e[13]=0,D$e[14]=0,D$e[15]=1},D$y.createAffineTransformation=function(D$s,D$r,D$e,D$U){var D$m=D$s.elements,D$k=D$r.elements,D$j=D$e.elements,D$T=D$U.elements,D$Y=D$k[0],D$Z=D$k[1],D$h=D$k[2],D$H=D$k[3],D$A=D$Y+D$Y,D$x=D$Z+D$Z,D$B=D$h+D$h,D$$=D$Y*D$A,D$l=D$Y*D$x,D$V=D$Y*D$B,D$b=D$Z*D$x,D$o=D$Z*D$B,D$I=D$h*D$B,D$w=D$H*D$A,D$X=D$H*D$x,D$D=D$H*D$B,D$n=D$j[0],D$y=D$j[1],D$g=D$j[2];D$T[0]=(1-(D$b+D$I))*D$n,D$T[1]=(D$l+D$D)*D$n,D$T[2]=(D$V-D$X)*D$n,D$T[3]=0,D$T[4]=(D$l-D$D)*D$y,D$T[5]=(1-(D$$+D$I))*D$y,D$T[6]=(D$o+D$w)*D$y,D$T[7]=0,D$T[8]=(D$V+D$X)*D$g,D$T[9]=(D$o-D$w)*D$g,D$T[10]=(1-(D$$+D$b))*D$g,D$T[11]=0,D$T[12]=D$m[0],D$T[13]=D$m[1],D$T[14]=D$m[2],D$T[15]=1},D$y.createLookAt=function(D$s,D$r,D$e,D$U){var D$m=D$U.elements,D$k=D$y._tempVector0,D$j=D$y._tempVector1,D$T=D$y._tempVector2;D$jr.subtract(D$s,D$r,D$T),D$jr.normalize(D$T,D$T),D$jr.cross(D$e,D$T,D$k),D$jr.normalize(D$k,D$k),D$jr.cross(D$T,D$k,D$j),D$U.identity(),D$m[0]=D$k.x,D$m[4]=D$k.y,D$m[8]=D$k.z,D$m[1]=D$j.x,D$m[5]=D$j.y,D$m[9]=D$j.z,D$m[2]=D$T.x,D$m[6]=D$T.y,D$m[10]=D$T.z,D$m[12]=-D$jr.dot(D$k,D$s),D$m[13]=-D$jr.dot(D$j,D$s),D$m[14]=-D$jr.dot(D$T,D$s)},D$y.createPerspective=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$m.elements,D$j=1/Math.tan(D$s/2),D$T=1/(D$e-D$U);D$k[0]=D$j/D$r,D$k[5]=D$j,D$k[10]=(D$U+D$e)*D$T,D$k[11]=-1,D$k[14]=2*D$U*D$e*D$T,D$k[1]=D$k[2]=D$k[3]=D$k[4]=D$k[6]=D$k[7]=D$k[8]=D$k[9]=D$k[12]=D$k[13]=D$k[15]=0},D$y.createOrthoOffCenterRH=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){var D$T=D$j.elements,D$Y=1/(D$s-D$r),D$Z=1/(D$e-D$U),D$h=1/(D$m-D$k);D$T[1]=D$T[2]=D$T[3]=D$T[4]=D$T[6]=D$T[7]=D$T[8]=D$T[9]=D$T[11]=0,D$T[15]=1,D$T[0]=-2*D$Y,D$T[5]=-2*D$Z,D$T[10]=2*D$h,D$T[12]=(D$s+D$r)*D$Y,D$T[13]=(D$U+D$e)*D$Z,D$T[14]=(D$k+D$m)*D$h},D$y.translation=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;D$U[0]=D$U[5]=D$U[10]=D$U[15]=1,D$U[12]=D$e[0],D$U[13]=D$e[1],D$U[14]=D$e[2]},D$H(D$y,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new D$y},"_tempVector0",function(){return this._tempVector0=new D$jr},"_tempVector1",function(){return this._tempVector1=new D$jr},"_tempVector2",function(){return this._tempVector2=new D$jr},"_tempQuaternion",function(){return this._tempQuaternion=new D$er},"DEFAULT",function(){return this.DEFAULT=new D$y},"ZERO",function(){return this.ZERO=new D$y(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),D$y}(),D$rr=(function(){function D$o(D$s,D$r){this.extents=null,this.transformation=null,this.extents=D$s,this.transformation=D$r}D$x(D$o,"laya.d3.math.OrientedBoundBox");var D$s=D$o.prototype;D$s.getCorners=function(D$s){var D$r=D$o._tempV30.elements,D$e=D$o._tempV31.elements,D$U=D$o._tempV32.elements,D$m=this.extents.elements;D$r[0]=D$m[0],D$r[1]=D$r[2]=0,D$e[1]=D$m[1],D$e[0]=D$e[2]=0,D$U[2]=D$m[2],D$U[0]=D$U[1]=0,D$jr.TransformNormal(D$o._tempV30,this.transformation,D$o._tempV30),D$jr.TransformNormal(D$o._tempV31,this.transformation,D$o._tempV31),D$jr.TransformNormal(D$o._tempV32,this.transformation,D$o._tempV32);var D$k=D$o._tempV33;this.transformation.getTranslationVector(D$k),D$s.length=8,D$jr.add(D$k,D$o._tempV30,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV32,D$s[0]),D$jr.add(D$k,D$o._tempV30,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV32,D$s[1]),D$jr.subtract(D$k,D$o._tempV30,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV32,D$s[2]),D$jr.subtract(D$k,D$o._tempV30,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV32,D$s[3]),D$jr.add(D$k,D$o._tempV30,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV32,D$s[4]),D$jr.add(D$k,D$o._tempV30,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV32,D$s[5]),D$jr.subtract(D$k,D$o._tempV30,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV32,D$s[6]),D$jr.subtract(D$k,D$o._tempV30,D$o._tempV34),D$jr.subtract(D$o._tempV34,D$o._tempV31,D$o._tempV34),D$jr.add(D$o._tempV34,D$o._tempV32,D$s[7])},D$s.transform=function(D$s){D$sr.multiply(this.transformation,D$s,this.transformation)},D$s.scale=function(D$s){D$jr.multiply(this.extents,D$s,this.extents)},D$s.translate=function(D$s){this.transformation.getTranslationVector(D$o._tempV30),D$jr.add(D$o._tempV30,D$s,D$o._tempV31),this.transformation.setTranslationVector(D$o._tempV31)},D$s.Size=function(D$s){D$jr.scale(this.extents,2,D$s)},D$s.getSize=function(D$s){var D$r=this.extents.elements;D$o._tempV30.x=D$r[0],D$o._tempV31.y=D$r[1],D$o._tempV32.z=D$r[2],D$jr.TransformNormal(D$o._tempV30,this.transformation,D$o._tempV30),D$jr.TransformNormal(D$o._tempV31,this.transformation,D$o._tempV31),D$jr.TransformNormal(D$o._tempV31,this.transformation,D$o._tempV32);var D$e=D$s.elements;D$e[0]=D$jr.scalarLength(D$o._tempV30),D$e[1]=D$jr.scalarLength(D$o._tempV31),D$e[2]=D$jr.scalarLength(D$o._tempV32)},D$s.getSizeSquared=function(D$s){var D$r=this.extents.elements;D$o._tempV30.x=D$r[0],D$o._tempV31.y=D$r[1],D$o._tempV32.z=D$r[2],D$jr.TransformNormal(D$o._tempV30,this.transformation,D$o._tempV30),D$jr.TransformNormal(D$o._tempV31,this.transformation,D$o._tempV31),D$jr.TransformNormal(D$o._tempV31,this.transformation,D$o._tempV32);var D$e=D$s.elements;D$e[0]=D$jr.scalarLengthSquared(D$o._tempV30),D$e[1]=D$jr.scalarLengthSquared(D$o._tempV31),D$e[2]=D$jr.scalarLengthSquared(D$o._tempV32)},D$s.getCenter=function(D$s){this.transformation.getTranslationVector(D$s)},D$s.containsPoint=function(D$s){var D$r=this.extents.elements,D$e=D$r[0],D$U=D$r[1],D$m=D$r[2];this.transformation.invert(D$o._tempM0),D$jr.transformCoordinate(D$s,D$o._tempM0,D$o._tempV30);var D$k=D$o._tempV30.elements,D$j=Math.abs(D$k[0]),D$T=Math.abs(D$k[1]),D$Y=Math.abs(D$k[2]);return D$_s.nearEqual(D$j,D$e)&&D$_s.nearEqual(D$T,D$U)&&D$_s.nearEqual(D$Y,D$m)?2:D$j<D$e&&D$T<D$U&&D$Y<D$m?1:0},D$s.containsPoints=function(D$s){var D$r=this.extents.elements,D$e=D$r[0],D$U=D$r[1],D$m=D$r[2];this.transformation.invert(D$o._tempM0);for(var D$k=!0,D$j=!1,D$T=0;D$T<D$s.length;D$T++){D$jr.transformCoordinate(D$s[D$T],D$o._tempM0,D$o._tempV30);var D$Y=D$o._tempV30.elements,D$Z=Math.abs(D$Y[0]),D$h=Math.abs(D$Y[1]),D$H=Math.abs(D$Y[2]);D$_s.nearEqual(D$Z,D$e)&&D$_s.nearEqual(D$h,D$U)&&D$_s.nearEqual(D$H,D$m)&&(D$j=!0),D$Z<D$e&&D$h<D$U&&D$H<D$m?D$j=!0:D$k=!1}return D$k?1:D$j?2:0},D$s.containsSphere=function(D$s,D$r){void 0===D$r&&(D$r=!1);var D$e=this.extents.elements,D$U=D$e[0],D$m=D$e[1],D$k=D$e[2],D$j=D$s.radius;this.transformation.invert(D$o._tempM0),D$jr.transformCoordinate(D$s.center,D$o._tempM0,D$o._tempV30);var D$T=NaN;if(D$T=D$r?D$j:(D$jr.scale(D$jr.UnitX,D$j,D$o._tempV31),D$jr.TransformNormal(D$o._tempV31,D$o._tempM0,D$o._tempV31),D$jr.scalarLength(D$o._tempV31)),D$jr.scale(this.extents,-1,D$o._tempV32),D$jr.Clamp(D$o._tempV30,D$o._tempV32,this.extents,D$o._tempV33),D$T*D$T<D$jr.distanceSquared(D$o._tempV30,D$o._tempV33))return 0;var D$Y=D$o._tempV30.elements,D$Z=D$Y[0],D$h=D$Y[1],D$H=D$Y[2],D$A=D$o._tempV32.elements,D$x=D$A[0],D$B=D$A[1],D$$=D$A[2];return D$x+D$T<=D$Z&&D$Z<=D$U-D$T&&D$T<D$U-D$x&&D$B+D$T<=D$h&&D$h<=D$m-D$T&&D$T<D$m-D$B&&D$$+D$T<=D$H&&D$H<=D$k-D$T&&D$T<D$k-D$$?1:2},D$s.containsOrientedBoundBox=function(D$s){var D$r=0,D$e=0;D$s.getCorners(D$o._corners);var D$U=this.containsPoints(D$o._corners);if(0!=D$U)return D$U;var D$m=this.extents.elements;D$s.extents.cloneTo(D$o._tempV35);var D$k=D$o._tempV35.elements;D$o._getRows(this.transformation,D$o._rows1),D$o._getRows(D$s.transformation,D$o._rows2);var D$j=NaN;for(D$r=0;D$r<4;D$r++)for(D$e=0;D$e<4;D$e++)3==D$r||3==D$e?(D$o._tempM0.setElementByRowColumn(D$r,D$e,0),D$o._tempM1.setElementByRowColumn(D$r,D$e,0)):(D$j=D$jr.dot(D$o._rows1[D$r],D$o._rows2[D$e]),D$o._tempM0.setElementByRowColumn(D$r,D$e,D$j),D$o._tempM1.setElementByRowColumn(D$r,D$e,Math.abs(D$j)));D$s.getCenter(D$o._tempV34),this.getCenter(D$o._tempV36),D$jr.subtract(D$o._tempV34,D$o._tempV36,D$o._tempV30);var D$T=D$o._tempV31.elements;D$T[0]=D$jr.dot(D$o._tempV30,D$o._rows1[0]),D$T[1]=D$jr.dot(D$o._tempV30,D$o._rows1[1]),D$T[2]=D$jr.dot(D$o._tempV30,D$o._rows1[2]);var D$Y=D$o._tempV32.elements,D$Z=D$o._tempV33.elements;for(D$r=0;D$r<3;D$r++)if(D$Y[0]=D$o._tempM1.getElementByRowColumn(D$r,0),D$Y[1]=D$o._tempM1.getElementByRowColumn(D$r,1),D$Y[2]=D$o._tempM1.getElementByRowColumn(D$r,2),D$m[D$r]+D$jr.dot(D$o._tempV35,D$o._tempV32)<Math.abs(D$T[D$r]))return 0;for(D$e=0;D$e<3;D$e++)if(D$Y[0]=D$o._tempM1.getElementByRowColumn(0,D$e),D$Y[1]=D$o._tempM1.getElementByRowColumn(1,D$e),D$Y[2]=D$o._tempM1.getElementByRowColumn(2,D$e),D$Z[0]=D$o._tempM0.getElementByRowColumn(0,D$e),D$Z[1]=D$o._tempM0.getElementByRowColumn(1,D$e),D$Z[2]=D$o._tempM0.getElementByRowColumn(2,D$e),D$jr.dot(this.extents,D$o._tempV32)+D$k[D$e]<Math.abs(D$jr.dot(D$o._tempV31,D$o._tempV33)))return 0;for(D$r=0;D$r<3;D$r++)for(D$e=0;D$e<3;D$e++){var D$h=(D$r+1)%3,D$H=(D$r+2)%3,D$A=(D$e+1)%3,D$x=(D$e+2)%3;if(D$m[D$h]*D$o._tempM1.getElementByRowColumn(D$H,D$e)+D$m[D$H]*D$o._tempM1.getElementByRowColumn(D$h,D$e)+(D$k[D$A]*D$o._tempM1.getElementByRowColumn(D$r,D$x)+D$k[D$x]*D$o._tempM1.getElementByRowColumn(D$r,D$A))<Math.abs(D$T[D$H]*D$o._tempM0.getElementByRowColumn(D$h,D$e)-D$T[D$h]*D$o._tempM0.getElementByRowColumn(D$H,D$e)))return 0}return 2},D$s.containsLine=function(D$s,D$r){D$o._corners[0]=D$s,D$o._corners[1]=D$r;var D$e=this.containsPoints(D$o._corners);if(0!=D$e)return D$e;var D$U=this.extents.elements,D$m=D$U[0],D$k=D$U[1],D$j=D$U[2];this.transformation.invert(D$o._tempM0),D$jr.transformCoordinate(D$s,D$o._tempM0,D$o._tempV30),D$jr.transformCoordinate(D$r,D$o._tempM0,D$o._tempV31),D$jr.add(D$o._tempV30,D$o._tempV31,D$o._tempV32),D$jr.scale(D$o._tempV32,.5,D$o._tempV32),D$jr.subtract(D$o._tempV30,D$o._tempV32,D$o._tempV33);var D$T=D$o._tempV33.elements,D$Y=D$T[0],D$Z=D$T[1],D$h=D$T[2],D$H=D$o._tempV34.elements,D$A=D$H[0]=Math.abs(D$T[0]),D$x=D$H[1]=Math.abs(D$T[1]),D$B=D$H[2]=Math.abs(D$T[2]),D$$=D$o._tempV32.elements,D$l=D$$[0],D$V=D$$[1],D$b=D$$[2];return Math.abs(D$l)>D$m+D$A?0:Math.abs(D$V)>D$k+D$x?0:Math.abs(D$b)>D$j+D$B?0:Math.abs(D$V*D$h-D$b*D$Z)>D$k*D$B+D$j*D$x?0:Math.abs(D$l*D$h-D$b*D$Y)>D$m*D$B+D$j*D$A?0:Math.abs(D$l*D$Z-D$V*D$Y)>D$m*D$x+D$k*D$A?0:2},D$s.containsBoundBox=function(D$s){var D$r=0,D$e=0,D$U=D$s.min,D$m=D$s.max;D$s.getCorners(D$o._corners);var D$k=this.containsPoints(D$o._corners);if(0!=D$k)return D$k;D$jr.subtract(D$m,D$U,D$o._tempV30),D$jr.scale(D$o._tempV30,.5,D$o._tempV30),D$jr.add(D$U,D$o._tempV30,D$o._tempV30),D$jr.subtract(D$m,D$o._tempV30,D$o._tempV31);var D$j=this.extents.elements,D$T=D$o._tempV31.elements;D$o._getRows(this.transformation,D$o._rows1),this.transformation.invert(D$o._tempM0);for(D$r=0;D$r<3;D$r++)for(D$e=0;D$e<3;D$e++)D$o._tempM1.setElementByRowColumn(D$r,D$e,Math.abs(D$o._tempM0.getElementByRowColumn(D$r,D$e)));this.getCenter(D$o._tempV35),D$jr.subtract(D$o._tempV30,D$o._tempV35,D$o._tempV32);var D$Y=D$o._tempV31.elements;D$Y[0]=D$jr.dot(D$o._tempV32,D$o._rows1[0]),D$Y[1]=D$jr.dot(D$o._tempV32,D$o._rows1[1]),D$Y[2]=D$jr.dot(D$o._tempV32,D$o._rows1[2]);var D$Z=D$o._tempV33.elements,D$h=D$o._tempV34.elements;for(D$r=0;D$r<3;D$r++)if(D$Z[0]=D$o._tempM1.getElementByRowColumn(D$r,0),D$Z[1]=D$o._tempM1.getElementByRowColumn(D$r,1),D$Z[2]=D$o._tempM1.getElementByRowColumn(D$r,2),D$j[D$r]+D$jr.dot(D$o._tempV31,D$o._tempV33)<Math.abs(D$Y[D$r]))return 0;for(D$e=0;D$e<3;D$e++)if(D$Z[0]=D$o._tempM1.getElementByRowColumn(0,D$e),D$Z[1]=D$o._tempM1.getElementByRowColumn(1,D$e),D$Z[2]=D$o._tempM1.getElementByRowColumn(2,D$e),D$h[0]=D$o._tempM0.getElementByRowColumn(0,D$e),D$h[1]=D$o._tempM0.getElementByRowColumn(1,D$e),D$h[2]=D$o._tempM0.getElementByRowColumn(2,D$e),D$jr.dot(this.extents,D$o._tempV33)+D$T[D$e]<Math.abs(D$jr.dot(D$o._tempV31,D$o._tempV34)))return 0;for(D$r=0;D$r<3;D$r++)for(D$e=0;D$e<3;D$e++){var D$H=(D$r+1)%3,D$A=(D$r+2)%3,D$x=(D$e+1)%3,D$B=(D$e+2)%3;if(D$j[D$H]*D$o._tempM1.getElementByRowColumn(D$A,D$e)+D$j[D$A]*D$o._tempM1.getElementByRowColumn(D$H,D$e)+(D$T[D$x]*D$o._tempM1.getElementByRowColumn(D$r,D$B)+D$T[D$B]*D$o._tempM1.getElementByRowColumn(D$r,D$x))<Math.abs(D$Y[D$A]*D$o._tempM0.getElementByRowColumn(D$H,D$e)-D$Y[D$H]*D$o._tempM0.getElementByRowColumn(D$A,D$e)))return 0}return 2},D$s.intersectsRay=function(D$s,D$r){D$jr.scale(this.extents,-1,D$o._tempV30),this.transformation.invert(D$o._tempM0),D$jr.TransformNormal(D$s.direction,D$o._tempM0,D$o._ray.direction),D$jr.transformCoordinate(D$s.origin,D$o._tempM0,D$o._ray.origin),D$o._boxBound1.min=D$o._tempV30,D$o._boxBound1.max=this.extents;var D$e=Collision.intersectsRayAndBoxRP(D$o._ray,D$o._boxBound1,D$r);return-1!==D$e&&D$jr.transformCoordinate(D$r,this.transformation,D$r),D$e},D$s._getLocalCorners=function(D$s){D$s.length=8;var D$r=this.extents.elements;D$o._tempV30.x=D$r[0],D$o._tempV31.y=D$r[1],D$o._tempV32.z=D$r[2],D$jr.add(D$o._tempV30,D$o._tempV31,D$o._tempV33),D$jr.add(D$o._tempV33,D$o._tempV32,D$s[0]),D$jr.add(D$o._tempV30,D$o._tempV31,D$o._tempV33),D$jr.subtract(D$o._tempV33,D$o._tempV32,D$s[1]),D$jr.subtract(D$o._tempV31,D$o._tempV30,D$o._tempV33),D$jr.subtract(D$o._tempV33,D$o._tempV30,D$s[2]),D$jr.subtract(D$o._tempV31,D$o._tempV30,D$o._tempV33),D$jr.add(D$o._tempV33,D$o._tempV32,D$s[3]),D$jr.subtract(D$o._tempV30,D$o._tempV31,D$o._tempV33),D$jr.add(D$o._tempV33,D$o._tempV32,D$s[4]),D$jr.subtract(D$o._tempV30,D$o._tempV31,D$o._tempV33),D$jr.subtract(D$o._tempV33,D$o._tempV32,D$s[5]),D$jr.scale(D$s[0],-1,D$s[6]),D$jr.subtract(D$o._tempV32,D$o._tempV30,D$o._tempV33),D$jr.subtract(D$o._tempV33,D$o._tempV31,D$s[7])},D$s.equals=function(D$s){return this.extents==D$s.extents&&this.transformation==D$s.transformation},D$s.cloneTo=function(D$s){var D$r=D$s;this.extents.cloneTo(D$r.extents),this.transformation.cloneTo(D$r.transformation)},D$o.createByBoundBox=function(D$s,D$r){var D$e=D$s.min,D$U=D$s.max;D$jr.subtract(D$U,D$e,D$o._tempV30),D$jr.scale(D$o._tempV30,.5,D$o._tempV30),D$jr.add(D$e,D$o._tempV30,D$o._tempV31),D$jr.subtract(D$U,D$o._tempV31,D$o._tempV32),D$sr.translation(D$o._tempV31,D$o._tempM0);var D$m=D$o._tempV32.clone(),D$k=D$o._tempM0.clone();D$r.extents=D$m,D$r.transformation=D$k},D$o.createByMinAndMaxVertex=function(D$s,D$r){return D$jr.subtract(D$r,D$s,D$o._tempV30),D$jr.scale(D$o._tempV30,.5,D$o._tempV30),D$jr.add(D$s,D$o._tempV30,D$o._tempV31),D$jr.subtract(D$r,D$o._tempV31,D$o._tempV32),D$sr.translation(D$o._tempV31,D$o._tempM0),new D$o(D$o._tempV32,D$o._tempM0)},D$o._getRows=function(D$s,D$r){D$r.length=3;var D$e=D$s.elements,D$U=D$r[0].elements;D$U[0]=D$e[0],D$U[1]=D$e[1],D$U[2]=D$e[2];var D$m=D$r[1].elements;D$m[0]=D$e[4],D$m[1]=D$e[5],D$m[2]=D$e[6];var D$k=D$r[2].elements;D$k[0]=D$e[8],D$k[1]=D$e[9],D$k[2]=D$e[10]},D$o.getObbtoObbMatrix4x4=function(D$s,D$r,D$e,D$U){var D$m=D$s.transformation,D$k=D$r.transformation;if(D$e){D$o._getRows(D$m,D$o._rows1),D$o._getRows(D$k,D$o._rows2);for(var D$j=0;D$j<3;D$j++)for(var D$T=0;D$T<3;D$T++)D$U.setElementByRowColumn(D$j,D$T,D$jr.dot(D$o._rows2[D$j],D$o._rows1[D$T]));D$r.getCenter(D$o._tempV30),D$s.getCenter(D$o._tempV31),D$jr.subtract(D$o._tempV30,D$o._tempV31,D$o._tempV32);var D$Y=D$U.elements;D$Y[12]=D$jr.dot(D$o._tempV32,D$o._rows1[0]),D$Y[13]=D$jr.dot(D$o._tempV32,D$o._rows1[1]),D$Y[14]=D$jr.dot(D$o._tempV32,D$o._rows1[2]),D$Y[15]=1}else D$m.invert(D$o._tempM0),D$sr.multiply(D$k,D$o._tempM0,D$U)},D$o.merge=function(D$s,D$r,D$e){var D$U=D$s.extents,D$m=D$s.transformation;D$o.getObbtoObbMatrix4x4(D$s,D$r,D$e,D$o._tempM0),D$r._getLocalCorners(D$o._corners),D$jr.transformCoordinate(D$o._corners[0],D$o._tempM0,D$o._corners[0]),D$jr.transformCoordinate(D$o._corners[1],D$o._tempM0,D$o._corners[1]),D$jr.transformCoordinate(D$o._corners[2],D$o._tempM0,D$o._corners[2]),D$jr.transformCoordinate(D$o._corners[3],D$o._tempM0,D$o._corners[3]),D$jr.transformCoordinate(D$o._corners[4],D$o._tempM0,D$o._corners[4]),D$jr.transformCoordinate(D$o._corners[5],D$o._tempM0,D$o._corners[5]),D$jr.transformCoordinate(D$o._corners[6],D$o._tempM0,D$o._corners[6]),D$jr.transformCoordinate(D$o._corners[7],D$o._tempM0,D$o._corners[7]),D$jr.scale(D$U,-1,D$o._boxBound1.min),D$U.cloneTo(D$o._boxBound1.max),D$Ls.createfromPoints(D$o._corners,D$o._boxBound2),D$Ls.merge(D$o._boxBound2,D$o._boxBound1,D$o._boxBound3);var D$k=D$o._boxBound3.min,D$j=D$o._boxBound3.max;D$jr.subtract(D$j,D$k,D$o._tempV30),D$jr.scale(D$o._tempV30,.5,D$o._tempV30),D$jr.add(D$k,D$o._tempV30,D$o._tempV32),D$jr.subtract(D$j,D$o._tempV32,D$U),D$jr.transformCoordinate(D$o._tempV32,D$m,D$o._tempV33)},D$H(D$o,["_tempV30",function(){return this._tempV30=new D$jr},"_tempV31",function(){return this._tempV31=new D$jr},"_tempV32",function(){return this._tempV32=new D$jr},"_tempV33",function(){return this._tempV33=new D$jr},"_tempV34",function(){return this._tempV34=new D$jr},"_tempV35",function(){return this._tempV35=new D$jr},"_tempV36",function(){return this._tempV36=new D$jr},"_tempM0",function(){return this._tempM0=new D$sr},"_tempM1",function(){return this._tempM1=new D$sr},"_corners",function(){return this._corners=[new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr]},"_rows1",function(){return this._rows1=[new D$jr,new D$jr,new D$jr]},"_rows2",function(){return this._rows2=[new D$jr,new D$jr,new D$jr]},"_ray",function(){return this._ray=new D$mr(new D$jr,new D$jr)},"_boxBound1",function(){return this._boxBound1=new D$Ls(new D$jr,new D$jr)},"_boxBound2",function(){return this._boxBound2=new D$Ls(new D$jr,new D$jr)},"_boxBound3",function(){return this._boxBound3=new D$Ls(new D$jr,new D$jr)}])}(),function(){function D$w(D$s,D$r){this.normal=null,this.distance=NaN,void 0===D$r&&(D$r=0),this.normal=D$s,this.distance=D$r}return D$x(D$w,"laya.d3.math.Plane"),D$w.prototype.normalize=function(){var D$s=this.normal.elements,D$r=D$s[0],D$e=D$s[1],D$U=D$s[2],D$m=1/Math.sqrt(D$r*D$r+D$e*D$e+D$U*D$U);D$s[0]=D$r*D$m,D$s[1]=D$e*D$m,D$s[2]=D$U*D$m,this.distance*=D$m},D$w.createPlaneBy3P=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$r.elements,D$k=D$e.elements,D$j=D$m[0]-D$U[0],D$T=D$m[1]-D$U[1],D$Y=D$m[2]-D$U[2],D$Z=D$k[0]-D$U[0],D$h=D$k[1]-D$U[1],D$H=D$k[2]-D$U[2],D$A=D$T*D$H-D$Y*D$h,D$x=D$Y*D$Z-D$j*D$H,D$B=D$j*D$h-D$T*D$Z,D$$=1/Math.sqrt(D$A*D$A+D$x*D$x+D$B*D$B),D$l=D$A*D$$,D$V=D$x*D$$,D$b=D$B*D$$,D$o=D$w._TEMPVec3.elements;D$o[0]=D$l,D$o[1]=D$V,D$o[2]=D$b;var D$I=-(D$l*D$U[0]+D$V*D$U[1]+D$b*D$U[2]);return new D$w(D$w._TEMPVec3,D$I)},D$w.PlaneIntersectionType_Back=0,D$w.PlaneIntersectionType_Front=1,D$w.PlaneIntersectionType_Intersecting=2,D$H(D$w,["_TEMPVec3",function(){return this._TEMPVec3=new D$jr}]),D$w}()),D$er=function(){function D$m(D$s,D$r,D$e,D$U){this.elements=new Float32Array(4),void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=1),this.elements[0]=D$s,this.elements[1]=D$r,this.elements[2]=D$e,this.elements[3]=D$U}D$x(D$m,"laya.d3.math.Quaternion");var D$s=D$m.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.scaling=function(D$s,D$r){var D$e=D$r.elements,D$U=this.elements;D$e[0]=D$U[0]*D$s,D$e[1]=D$U[1]*D$s,D$e[2]=D$U[2]*D$s,D$e[3]=D$U[3]*D$s},D$s.normalize=function(D$s){var D$r=D$s.elements,D$e=this.elements,D$U=D$e[0],D$m=D$e[1],D$k=D$e[2],D$j=D$e[3],D$T=D$U*D$U+D$m*D$m+D$k*D$k+D$j*D$j;0<D$T&&(D$T=1/Math.sqrt(D$T),D$r[0]=D$U*D$T,D$r[1]=D$m*D$T,D$r[2]=D$k*D$T,D$r[3]=D$j*D$T)},D$s.length=function(){var D$s=this.elements,D$r=D$s[0],D$e=D$s[1],D$U=D$s[2],D$m=D$s[3];return Math.sqrt(D$r*D$r+D$e*D$e+D$U*D$U+D$m*D$m)},D$s.rotateX=function(D$s,D$r){var D$e=D$r.elements,D$U=this.elements;D$s*=.5;var D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$U[3],D$Y=Math.sin(D$s),D$Z=Math.cos(D$s);D$e[0]=D$m*D$Z+D$T*D$Y,D$e[1]=D$k*D$Z+D$j*D$Y,D$e[2]=D$j*D$Z-D$k*D$Y,D$e[3]=D$T*D$Z-D$m*D$Y},D$s.rotateY=function(D$s,D$r){var D$e=D$r.elements,D$U=this.elements;D$s*=.5;var D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$U[3],D$Y=Math.sin(D$s),D$Z=Math.cos(D$s);D$e[0]=D$m*D$Z-D$j*D$Y,D$e[1]=D$k*D$Z+D$T*D$Y,D$e[2]=D$j*D$Z+D$m*D$Y,D$e[3]=D$T*D$Z-D$k*D$Y},D$s.rotateZ=function(D$s,D$r){var D$e=D$r.elements,D$U=this.elements;D$s*=.5;var D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$U[3],D$Y=Math.sin(D$s),D$Z=Math.cos(D$s);D$e[0]=D$m*D$Z+D$k*D$Y,D$e[1]=D$k*D$Z-D$m*D$Y,D$e[2]=D$j*D$Z+D$T*D$Y,D$e[3]=D$T*D$Z-D$j*D$Y},D$s.getYawPitchRoll=function(D$s){D$jr.transformQuat(D$jr.ForwardRH,this,D$m.TEMPVector31),D$jr.transformQuat(D$jr.Up,this,D$m.TEMPVector32);var D$r=D$m.TEMPVector32.elements;D$m.angleTo(D$jr.ZERO,D$m.TEMPVector31,D$m.TEMPVector33);var D$e=D$m.TEMPVector33.elements;D$e[0]==Math.PI/2?(D$e[1]=D$m.arcTanAngle(D$r[2],D$r[0]),D$e[2]=0):D$e[0]==-Math.PI/2?(D$e[1]=D$m.arcTanAngle(-D$r[2],-D$r[0]),D$e[2]=0):(D$sr.createRotationY(-D$e[1],D$m.TEMPMatrix0),D$sr.createRotationX(-D$e[0],D$m.TEMPMatrix1),D$jr.transformCoordinate(D$m.TEMPVector32,D$m.TEMPMatrix0,D$m.TEMPVector32),D$jr.transformCoordinate(D$m.TEMPVector32,D$m.TEMPMatrix1,D$m.TEMPVector32),D$e[2]=D$m.arcTanAngle(D$r[1],-D$r[0])),D$e[1]<=-Math.PI&&(D$e[1]=Math.PI),D$e[2]<=-Math.PI&&(D$e[2]=Math.PI),D$e[1]>=Math.PI&&D$e[2]>=Math.PI&&(D$e[1]=0,D$e[2]=0,D$e[0]=Math.PI-D$e[0]);var D$U=D$s.elements;D$U[0]=D$e[1],D$U[1]=D$e[0],D$U[2]=D$e[2]},D$s.invert=function(D$s){var D$r=D$s.elements,D$e=this.elements,D$U=D$e[0],D$m=D$e[1],D$k=D$e[2],D$j=D$e[3],D$T=D$U*D$U+D$m*D$m+D$k*D$k+D$j*D$j,D$Y=D$T?1/D$T:0;D$r[0]=-D$U*D$Y,D$r[1]=-D$m*D$Y,D$r[2]=-D$k*D$Y,D$r[3]=D$j*D$Y},D$s.identity=function(){var D$s=this.elements;D$s[0]=0,D$s[1]=0,D$s[2]=0,D$s[3]=1},D$s.fromArray=function(D$s,D$r){void 0===D$r&&(D$r=0),this.elements[0]=D$s[D$r+0],this.elements[1]=D$s[D$r+1],this.elements[2]=D$s[D$r+2],this.elements[3]=D$s[D$r+3]},D$s.cloneTo=function(D$s){var D$r,D$e,D$U;if((D$e=this.elements)!==(D$U=D$s.elements))for(D$r=0;D$r<4;++D$r)D$U[D$r]=D$e[D$r]},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$s.equals=function(D$s){var D$r=this.elements,D$e=D$s.elements;return D$_s.nearEqual(D$r[0],D$e[0])&&D$_s.nearEqual(D$r[1],D$e[1])&&D$_s.nearEqual(D$r[2],D$e[2])&&D$_s.nearEqual(D$r[3],D$e[3])},D$s.lengthSquared=function(){var D$s=this.elements[0],D$r=this.elements[1],D$e=this.elements[2],D$U=this.elements[3];return D$s*D$s+D$r*D$r+D$e*D$e+D$U*D$U},D$B(0,D$s,"x",function(){return this.elements[0]}),D$B(0,D$s,"y",function(){return this.elements[1]}),D$B(0,D$s,"z",function(){return this.elements[2]}),D$B(0,D$s,"w",function(){return this.elements[3]}),D$m.createFromYawPitchRoll=function(D$s,D$r,D$e,D$U){var D$m=.5*D$e,D$k=.5*D$r,D$j=.5*D$s,D$T=Math.sin(D$m),D$Y=Math.cos(D$m),D$Z=Math.sin(D$k),D$h=Math.cos(D$k),D$H=Math.sin(D$j),D$A=Math.cos(D$j),D$x=D$U.elements;D$x[0]=D$A*D$Z*D$Y+D$H*D$h*D$T,D$x[1]=D$H*D$h*D$Y-D$A*D$Z*D$T,D$x[2]=D$A*D$h*D$T-D$H*D$Z*D$Y,D$x[3]=D$A*D$h*D$Y+D$H*D$Z*D$T},D$m.multiply=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$r.elements,D$k=D$e.elements,D$j=D$U[0],D$T=D$U[1],D$Y=D$U[2],D$Z=D$U[3],D$h=D$m[0],D$H=D$m[1],D$A=D$m[2],D$x=D$m[3],D$B=D$T*D$A-D$Y*D$H,D$$=D$Y*D$h-D$j*D$A,D$l=D$j*D$H-D$T*D$h,D$V=D$j*D$h+D$T*D$H+D$Y*D$A;D$k[0]=D$j*D$x+D$h*D$Z+D$B,D$k[1]=D$T*D$x+D$H*D$Z+D$$,D$k[2]=D$Y*D$x+D$A*D$Z+D$l,D$k[3]=D$Z*D$x-D$V},D$m.arcTanAngle=function(D$s,D$r){return 0==D$s?1==D$r?Math.PI/2:-Math.PI/2:0<D$s?Math.atan(D$r/D$s):D$s<0?0<D$r?Math.atan(D$r/D$s)+Math.PI:Math.atan(D$r/D$s)-Math.PI:0},D$m.angleTo=function(D$s,D$r,D$e){D$jr.subtract(D$r,D$s,D$m.TEMPVector30),D$jr.normalize(D$m.TEMPVector30,D$m.TEMPVector30),D$e.elements[0]=Math.asin(D$m.TEMPVector30.y),D$e.elements[1]=D$m.arcTanAngle(-D$m.TEMPVector30.z,-D$m.TEMPVector30.x)},D$m.createFromAxisAngle=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements;D$r*=.5;var D$k=Math.sin(D$r);D$U[0]=D$k*D$m[0],D$U[1]=D$k*D$m[1],D$U[2]=D$k*D$m[2],D$U[3]=Math.cos(D$r)},D$m.createFromMatrix3x3=function(D$s,D$r){var D$e,D$U=D$r.elements,D$m=D$s.elements,D$k=D$m[0]+D$m[4]+D$m[8];if(0<D$k)D$e=Math.sqrt(D$k+1),D$U[3]=.5*D$e,D$e=.5/D$e,D$U[0]=(D$m[5]-D$m[7])*D$e,D$U[1]=(D$m[6]-D$m[2])*D$e,D$U[2]=(D$m[1]-D$m[3])*D$e;else{var D$j=0;D$m[4]>D$m[0]&&(D$j=1),D$m[8]>D$m[3*D$j+D$j]&&(D$j=2);var D$T=(D$j+1)%3,D$Y=(D$j+2)%3;D$e=Math.sqrt(D$m[3*D$j+D$j]-D$m[3*D$T+D$T]-D$m[3*D$Y+D$Y]+1),D$U[D$j]=.5*D$e,D$e=.5/D$e,D$U[3]=(D$m[3*D$T+D$Y]-D$m[3*D$Y+D$T])*D$e,D$U[D$T]=(D$m[3*D$T+D$j]+D$m[3*D$j+D$T])*D$e,D$U[D$Y]=(D$m[3*D$Y+D$j]+D$m[3*D$j+D$Y])*D$e}},D$m.createFromMatrix4x4=function(D$s,D$r){var D$e,D$U,D$m=D$s.elements,D$k=D$r.elements,D$j=D$m[0]+D$m[5]+D$m[10];0<D$j?(D$e=Math.sqrt(D$j+1),D$k[3]=.5*D$e,D$e=.5/D$e,D$k[0]=(D$m[6]-D$m[9])*D$e,D$k[1]=(D$m[8]-D$m[2])*D$e,D$k[2]=(D$m[1]-D$m[4])*D$e):D$m[0]>=D$m[5]&&D$m[0]>=D$m[10]?(D$U=.5/(D$e=Math.sqrt(1+D$m[0]-D$m[5]-D$m[10])),D$k[0]=.5*D$e,D$k[1]=(D$m[1]+D$m[4])*D$U,D$k[2]=(D$m[2]+D$m[8])*D$U,D$k[3]=(D$m[6]-D$m[9])*D$U):D$m[5]>D$m[10]?(D$U=.5/(D$e=Math.sqrt(1+D$m[5]-D$m[0]-D$m[10])),D$k[0]=(D$m[4]+D$m[1])*D$U,D$k[1]=.5*D$e,D$k[2]=(D$m[9]+D$m[6])*D$U,D$k[3]=(D$m[8]-D$m[2])*D$U):(D$U=.5/(D$e=Math.sqrt(1+D$m[10]-D$m[0]-D$m[5])),D$k[0]=(D$m[8]+D$m[2])*D$U,D$k[1]=(D$m[9]+D$m[6])*D$U,D$k[2]=.5*D$e,D$k[3]=(D$m[1]-D$m[4])*D$U)},D$m.slerp=function(D$s,D$r,D$e,D$U){var D$m,D$k,D$j,D$T,D$Y,D$Z=D$s.elements,D$h=D$r.elements,D$H=D$U.elements,D$A=D$Z[0],D$x=D$Z[1],D$B=D$Z[2],D$$=D$Z[3],D$l=D$h[0],D$V=D$h[1],D$b=D$h[2],D$o=D$h[3];return(D$k=D$A*D$l+D$x*D$V+D$B*D$b+D$$*D$o)<0&&(D$k=-D$k,D$l=-D$l,D$V=-D$V,D$b=-D$b,D$o=-D$o),D$Y=1e-6<1-D$k?(D$m=Math.acos(D$k),D$j=Math.sin(D$m),D$T=Math.sin((1-D$e)*D$m)/D$j,Math.sin(D$e*D$m)/D$j):(D$T=1-D$e,D$e),D$H[0]=D$T*D$A+D$Y*D$l,D$H[1]=D$T*D$x+D$Y*D$V,D$H[2]=D$T*D$B+D$Y*D$b,D$H[3]=D$T*D$$+D$Y*D$o,D$H},D$m.lerp=function(D$s,D$r,D$e,D$U){var D$m=D$U.elements,D$k=D$s.elements,D$j=D$r.elements,D$T=D$k[0],D$Y=D$k[1],D$Z=D$k[2],D$h=D$k[3];D$m[0]=D$T+D$e*(D$j[0]-D$T),D$m[1]=D$Y+D$e*(D$j[1]-D$Y),D$m[2]=D$Z+D$e*(D$j[2]-D$Z),D$m[3]=D$h+D$e*(D$j[3]-D$h)},D$m.add=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=D$m[0]+D$k[0],D$U[1]=D$m[1]+D$k[1],D$U[2]=D$m[2]+D$k[2],D$U[3]=D$m[3]+D$k[3]},D$m.dot=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;return D$e[0]*D$U[0]+D$e[1]*D$U[1]+D$e[2]*D$U[2]+D$e[3]*D$U[3]},D$m.rotationLookAt=function(D$s,D$r,D$e){D$m.lookAt(D$jr.ZERO,D$s,D$r,D$e)},D$m.lookAt=function(D$s,D$r,D$e,D$U){D$Fs.lookAt(D$s,D$r,D$e,D$m._tempMatrix3x3),D$m.rotationMatrix(D$m._tempMatrix3x3,D$U)},D$m.invert=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$s.lengthSquared();D$_s.isZero(D$m)||(D$m=1/D$m,D$U[0]=-D$e[0]*D$m,D$U[1]=-D$e[1]*D$m,D$U[2]=-D$e[2]*D$m,D$U[3]=D$e[3]*D$m)},D$m.rotationMatrix=function(D$s,D$r){var D$e=D$s.elements,D$U=D$e[0],D$m=D$e[1],D$k=D$e[2],D$j=D$e[3],D$T=D$e[4],D$Y=D$e[5],D$Z=D$e[6],D$h=D$e[7],D$H=D$e[8],D$A=D$r.elements,D$x=NaN,D$B=NaN,D$$=D$U+D$T+D$H;0<D$$?(D$x=Math.sqrt(D$$+1),D$A[3]=.5*D$x,D$x=.5/D$x,D$A[0]=(D$Y-D$h)*D$x,D$A[1]=(D$Z-D$k)*D$x,D$A[2]=(D$m-D$j)*D$x):D$T<=D$U&&D$H<=D$U?(D$B=.5/(D$x=Math.sqrt(1+D$U-D$T-D$H)),D$A[0]=.5*D$x,D$A[1]=(D$m+D$j)*D$B,D$A[2]=(D$k+D$Z)*D$B,D$A[3]=(D$Y-D$h)*D$B):D$H<D$T?(D$B=.5/(D$x=Math.sqrt(1+D$T-D$U-D$H)),D$A[0]=(D$j+D$m)*D$B,D$A[1]=.5*D$x,D$A[2]=(D$h+D$Y)*D$B,D$A[3]=(D$Z-D$k)*D$B):(D$B=.5/(D$x=Math.sqrt(1+D$H-D$U-D$T)),D$A[0]=(D$Z+D$k)*D$B,D$A[1]=(D$h+D$Y)*D$B,D$A[2]=.5*D$x,D$A[3]=(D$m-D$j)*D$B)},D$m.DEFAULT=new D$m,D$H(D$m,["TEMPVector30",function(){return this.TEMPVector30=new D$jr},"TEMPVector31",function(){return this.TEMPVector31=new D$jr},"TEMPVector32",function(){return this.TEMPVector32=new D$jr},"TEMPVector33",function(){return this.TEMPVector33=new D$jr},"TEMPMatrix0",function(){return this.TEMPMatrix0=new D$sr},"TEMPMatrix1",function(){return this.TEMPMatrix1=new D$sr},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new D$Fs},"NAN",function(){return this.NAN=new D$m(NaN,NaN,NaN,NaN)}]),D$m}(),D$Ur=function(){function D$s(D$s){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=D$s,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}D$x(D$s,"laya.d3.math.Rand");var D$r=D$s.prototype;return D$r.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},D$r.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},D$r.getSignedFloat=function(){return 2*this.getFloat()-1},D$B(0,D$r,"seed",function(){return this.seeds[0]},function(D$s){this.seeds[0]=D$s,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),D$s.getFloatFromInt=function(D$s){return 1/8388607*(8388607&D$s)},D$s.getByteFromInt=function(D$s){return(8388607&D$s)>>>15},D$s}(),D$mr=(function(){function D$m(D$s){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(D$s instanceof Array)||4!==D$s.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|D$s[0],this._state0L=0|D$s[1],this._state1U=0|D$s[2],this._state1L=0|D$s[3]}D$x(D$m,"laya.d3.math.RandX");var D$s=D$m.prototype;D$s.randomint=function(){var D$s=this._state0U,D$r=this._state0L,D$e=this._state1U,D$U=this._state1L,D$m=(D$U>>>0)+(D$r>>>0),D$k=D$e+D$s+(D$m/2>>>31)>>>0,D$j=D$m>>>0,D$T=0,D$Y=0;D$T=(D$s^=D$T=D$s<<23|(-512&D$r)>>>9)^(this._state0U=D$e),D$Y=(D$r^=D$Y=D$r<<23)^(this._state0L=D$U);D$T^=D$s>>>18,D$Y^=D$r>>>18|(262143&D$s)<<14;return D$T^=D$e>>>5,D$Y^=D$U>>>5|(31&D$e)<<27,this._state1U=D$T,this._state1L=D$Y,[D$k,D$j]},D$s.random=function(){var D$s=this.randomint(),D$r=D$s[0],D$e=1023<<20|D$r>>>12,D$U=0|(D$s[1]>>>12|(4095&D$r)<<20);return D$m._CONVERTION_BUFFER.setUint32(0,D$e,!1),D$m._CONVERTION_BUFFER.setUint32(4,D$U,!1),D$Ur._CONVERTION_BUFFER.getFloat64(0,!1)-1},D$H(D$m,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new D$Ur([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function D$s(D$s,D$r){this.origin=null,this.direction=null,this.origin=D$s,this.direction=D$r}return D$x(D$s,"laya.d3.math.Ray"),D$s}()),D$kr=function(){function D$s(D$s,D$r){this.elements=new Float32Array(2),void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0);var D$e=this.elements;D$e[0]=D$s,D$e[1]=D$r}D$x(D$s,"laya.d3.math.Vector2");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.fromArray=function(D$s,D$r){void 0===D$r&&(D$r=0),this.elements[0]=D$s[D$r+0],this.elements[1]=D$s[D$r+1]},D$r.cloneTo=function(D$s){var D$r=D$s.elements,D$e=this.elements;D$r[0]=D$e[0],D$r[1]=D$e[1]},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"x",function(){return this.elements[0]},function(D$s){this.elements[0]=D$s}),D$B(0,D$r,"y",function(){return this.elements[1]},function(D$s){this.elements[1]=D$s}),D$s.scale=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements;D$U[0]=D$m[0]*D$r,D$U[1]=D$m[1]*D$r},D$H(D$s,["ZERO",function(){return this.ZERO=new D$s(0,0)},"ONE",function(){return this.ONE=new D$s(1,1)}]),D$s}(),D$jr=function(){function D$h(D$s,D$r,D$e){this.elements=new Float32Array(3),void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0);var D$U=this.elements;D$U[0]=D$s,D$U[1]=D$r,D$U[2]=D$e}D$x(D$h,"laya.d3.math.Vector3");var D$s=D$h.prototype;return D$w.imps(D$s,{"laya.d3.core.IClone":!0}),D$s.fromArray=function(D$s,D$r){void 0===D$r&&(D$r=0),this.elements[0]=D$s[D$r+0],this.elements[1]=D$s[D$r+1],this.elements[2]=D$s[D$r+2]},D$s.cloneTo=function(D$s){var D$r=D$s.elements,D$e=this.elements;D$r[0]=D$e[0],D$r[1]=D$e[1],D$r[2]=D$e[2]},D$s.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$s.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},D$s.reset=function(D$s,D$r,D$e){this.elements[0]=D$s,this.elements[1]=D$r,this.elements[2]=D$e},D$B(0,D$s,"x",function(){return this.elements[0]},function(D$s){this.elements[0]=D$s}),D$B(0,D$s,"y",function(){return this.elements[1]},function(D$s){this.elements[1]=D$s}),D$B(0,D$s,"z",function(){return this.elements[2]},function(D$s){this.elements[2]=D$s}),D$h.distanceSquared=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$e[0]-D$U[0],D$k=D$e[1]-D$U[1],D$j=D$e[2]-D$U[2];return D$m*D$m+D$k*D$k+D$j*D$j},D$h.distance=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$e[0]-D$U[0],D$k=D$e[1]-D$U[1],D$j=D$e[2]-D$U[2];return Math.sqrt(D$m*D$m+D$k*D$k+D$j*D$j)},D$h.min=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=Math.min(D$m[0],D$k[0]),D$U[1]=Math.min(D$m[1],D$k[1]),D$U[2]=Math.min(D$m[2],D$k[2])},D$h.max=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=Math.max(D$m[0],D$k[0]),D$U[1]=Math.max(D$m[1],D$k[1]),D$U[2]=Math.max(D$m[2],D$k[2])},D$h.transformQuat=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements,D$j=D$m[0],D$T=D$m[1],D$Y=D$m[2],D$Z=D$k[0],D$h=D$k[1],D$H=D$k[2],D$A=D$k[3],D$x=D$A*D$j+D$h*D$Y-D$H*D$T,D$B=D$A*D$T+D$H*D$j-D$Z*D$Y,D$$=D$A*D$Y+D$Z*D$T-D$h*D$j,D$l=-D$Z*D$j-D$h*D$T-D$H*D$Y;D$U[0]=D$x*D$A+D$l*-D$Z+D$B*-D$H-D$$*-D$h,D$U[1]=D$B*D$A+D$l*-D$h+D$$*-D$Z-D$x*-D$H,D$U[2]=D$$*D$A+D$l*-D$H+D$x*-D$h-D$B*-D$Z},D$h.scalarLength=function(D$s){var D$r=D$s.elements,D$e=D$r[0],D$U=D$r[1],D$m=D$r[2];return Math.sqrt(D$e*D$e+D$U*D$U+D$m*D$m)},D$h.scalarLengthSquared=function(D$s){var D$r=D$s.elements,D$e=D$r[0],D$U=D$r[1],D$m=D$r[2];return D$e*D$e+D$U*D$U+D$m*D$m},D$h.normalize=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$e[0],D$k=D$e[1],D$j=D$e[2],D$T=D$m*D$m+D$k*D$k+D$j*D$j;0<D$T&&(D$T=1/Math.sqrt(D$T),D$U[0]=D$e[0]*D$T,D$U[1]=D$e[1]*D$T,D$U[2]=D$e[2]*D$T)},D$h.multiply=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=D$m[0]*D$k[0],D$U[1]=D$m[1]*D$k[1],D$U[2]=D$m[2]*D$k[2]},D$h.scale=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements;D$U[0]=D$m[0]*D$r,D$U[1]=D$m[1]*D$r,D$U[2]=D$m[2]*D$r},D$h.lerp=function(D$s,D$r,D$e,D$U){var D$m=D$U.elements,D$k=D$s.elements,D$j=D$r.elements,D$T=D$k[0],D$Y=D$k[1],D$Z=D$k[2];D$m[0]=D$T+D$e*(D$j[0]-D$T),D$m[1]=D$Y+D$e*(D$j[1]-D$Y),D$m[2]=D$Z+D$e*(D$j[2]-D$Z)},D$h.transformV3ToV3=function(D$s,D$r,D$e){var D$U=D$h._tempVector4;D$h.transformV3ToV4(D$s,D$r,D$U);var D$m=D$U.elements,D$k=D$e.elements;D$k[0]=D$m[0],D$k[1]=D$m[1],D$k[2]=D$m[2]},D$h.transformV3ToV4=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$r.elements,D$Y=D$e.elements;D$Y[0]=D$m*D$T[0]+D$k*D$T[4]+D$j*D$T[8]+D$T[12],D$Y[1]=D$m*D$T[1]+D$k*D$T[5]+D$j*D$T[9]+D$T[13],D$Y[2]=D$m*D$T[2]+D$k*D$T[6]+D$j*D$T[10]+D$T[14],D$Y[3]=D$m*D$T[3]+D$k*D$T[7]+D$j*D$T[11]+D$T[15]},D$h.TransformNormal=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$r.elements,D$Y=D$e.elements;D$Y[0]=D$m*D$T[0]+D$k*D$T[4]+D$j*D$T[8],D$Y[1]=D$m*D$T[1]+D$k*D$T[5]+D$j*D$T[9],D$Y[2]=D$m*D$T[2]+D$k*D$T[6]+D$j*D$T[10]},D$h.transformCoordinate=function(D$s,D$r,D$e){var D$U=D$h._tempVector4.elements,D$m=D$s.elements,D$k=D$m[0],D$j=D$m[1],D$T=D$m[2],D$Y=D$r.elements;D$U[0]=D$k*D$Y[0]+D$j*D$Y[4]+D$T*D$Y[8]+D$Y[12],D$U[1]=D$k*D$Y[1]+D$j*D$Y[5]+D$T*D$Y[9]+D$Y[13],D$U[2]=D$k*D$Y[2]+D$j*D$Y[6]+D$T*D$Y[10]+D$Y[14],D$U[3]=1/(D$k*D$Y[3]+D$j*D$Y[7]+D$T*D$Y[11]+D$Y[15]);var D$Z=D$e.elements;D$Z[0]=D$U[0]*D$U[3],D$Z[1]=D$U[1]*D$U[3],D$Z[2]=D$U[2]*D$U[3]},D$h.Clamp=function(D$s,D$r,D$e,D$U){var D$m=D$s.elements,D$k=D$m[0],D$j=D$m[1],D$T=D$m[2],D$Y=D$r.elements,D$Z=D$Y[0],D$h=D$Y[1],D$H=D$Y[2],D$A=D$e.elements,D$x=D$A[0],D$B=D$A[1],D$$=D$A[2],D$l=D$U.elements;D$k=(D$k=D$x<D$k?D$x:D$k)<D$Z?D$Z:D$k,D$j=(D$j=D$B<D$j?D$B:D$j)<D$h?D$h:D$j,D$T=(D$T=D$$<D$T?D$$:D$T)<D$H?D$H:D$T,D$l[0]=D$k,D$l[1]=D$j,D$l[2]=D$T},D$h.add=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=D$m[0]+D$k[0],D$U[1]=D$m[1]+D$k[1],D$U[2]=D$m[2]+D$k[2]},D$h.subtract=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=D$m[0]-D$k[0],D$U[1]=D$m[1]-D$k[1],D$U[2]=D$m[2]-D$k[2]},D$h.cross=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$r.elements,D$k=D$e.elements,D$j=D$U[0],D$T=D$U[1],D$Y=D$U[2],D$Z=D$m[0],D$h=D$m[1],D$H=D$m[2];D$k[0]=D$T*D$H-D$Y*D$h,D$k[1]=D$Y*D$Z-D$j*D$H,D$k[2]=D$j*D$h-D$T*D$Z},D$h.dot=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;return D$e[0]*D$U[0]+D$e[1]*D$U[1]+D$e[2]*D$U[2]},D$h.equals=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;return D$_s.nearEqual(Math.abs(D$e[0]),Math.abs(D$U[0]))&&D$_s.nearEqual(Math.abs(D$e[1]),Math.abs(D$U[1]))&&D$_s.nearEqual(Math.abs(D$e[2]),Math.abs(D$U[2]))},D$h.ZERO=new D$h(0,0,0),D$h.ONE=new D$h(1,1,1),D$h.NegativeUnitX=new D$h(-1,0,0),D$h.UnitX=new D$h(1,0,0),D$h.UnitY=new D$h(0,1,0),D$h.UnitZ=new D$h(0,0,1),D$h.ForwardRH=new D$h(0,0,-1),D$h.ForwardLH=new D$h(0,0,1),D$h.Up=new D$h(0,1,0),D$h.NAN=new D$h(NaN,NaN,NaN),D$H(D$h,["_tempVector4",function(){return this._tempVector4=new D$Tr}]),D$h}(),D$Tr=function(){function D$s(D$s,D$r,D$e,D$U){this.elements=new Float32Array(4),void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=0);var D$m=this.elements;D$m[0]=D$s,D$m[1]=D$r,D$m[2]=D$e,D$m[3]=D$U}D$x(D$s,"laya.d3.math.Vector4");var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r.fromArray=function(D$s,D$r){void 0===D$r&&(D$r=0),this.elements[0]=D$s[D$r+0],this.elements[1]=D$s[D$r+1],this.elements[2]=D$s[D$r+2],this.elements[3]=D$s[D$r+3]},D$r.cloneTo=function(D$s){var D$r=D$s.elements,D$e=this.elements;D$r[0]=D$e[0],D$r[1]=D$e[1],D$r[2]=D$e[2],D$r[3]=D$e[3]},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$r.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},D$r.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},D$B(0,D$r,"x",function(){return this.elements[0]},function(D$s){this.elements[0]=D$s}),D$B(0,D$r,"y",function(){return this.elements[1]},function(D$s){this.elements[1]=D$s}),D$B(0,D$r,"z",function(){return this.elements[2]},function(D$s){this.elements[2]=D$s}),D$B(0,D$r,"w",function(){return this.elements[3]},function(D$s){this.elements[3]=D$s}),D$s.lerp=function(D$s,D$r,D$e,D$U){var D$m=D$U.elements,D$k=D$s.elements,D$j=D$r.elements,D$T=D$k[0],D$Y=D$k[1],D$Z=D$k[2],D$h=D$k[3];D$m[0]=D$T+D$e*(D$j[0]-D$T),D$m[1]=D$Y+D$e*(D$j[1]-D$Y),D$m[2]=D$Z+D$e*(D$j[2]-D$Z),D$m[3]=D$h+D$e*(D$j[3]-D$h)},D$s.transformByM4x4=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$U[0],D$k=D$U[1],D$j=D$U[2],D$T=D$U[3],D$Y=D$r.elements,D$Z=D$e.elements;D$Z[0]=D$m*D$Y[0]+D$k*D$Y[4]+D$j*D$Y[8]+D$T*D$Y[12],D$Z[1]=D$m*D$Y[1]+D$k*D$Y[5]+D$j*D$Y[9]+D$T*D$Y[13],D$Z[2]=D$m*D$Y[2]+D$k*D$Y[6]+D$j*D$Y[10]+D$T*D$Y[14],D$Z[3]=D$m*D$Y[3]+D$k*D$Y[7]+D$j*D$Y[11]+D$T*D$Y[15]},D$s.equals=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;return D$_s.nearEqual(Math.abs(D$e[0]),Math.abs(D$U[0]))&&D$_s.nearEqual(Math.abs(D$e[1]),Math.abs(D$U[1]))&&D$_s.nearEqual(Math.abs(D$e[2]),Math.abs(D$U[2]))&&D$_s.nearEqual(Math.abs(D$e[3]),Math.abs(D$U[3]))},D$s.normalize=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$s.length();0<D$m&&(D$U[0]=D$e[0]*D$m,D$U[1]=D$e[1]*D$m,D$U[2]=D$e[2]*D$m,D$U[3]=D$e[3]*D$m)},D$s.add=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=D$m[0]+D$k[0],D$U[1]=D$m[1]+D$k[1],D$U[2]=D$m[2]+D$k[2],D$U[3]=D$m[3]+D$k[3]},D$s.subtract=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=D$m[0]-D$k[0],D$U[1]=D$m[1]-D$k[1],D$U[2]=D$m[2]-D$k[2],D$U[3]=D$m[3]-D$k[3]},D$s.multiply=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=D$m[0]*D$k[0],D$U[1]=D$m[1]*D$k[1],D$U[2]=D$m[2]*D$k[2],D$U[3]=D$m[3]*D$k[3]},D$s.scale=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements;D$U[0]=D$m[0]*D$r,D$U[1]=D$m[1]*D$r,D$U[2]=D$m[2]*D$r,D$U[3]=D$m[3]*D$r},D$s.Clamp=function(D$s,D$r,D$e,D$U){var D$m=D$s.elements,D$k=D$m[0],D$j=D$m[1],D$T=D$m[2],D$Y=D$m[3],D$Z=D$r.elements,D$h=D$Z[0],D$H=D$Z[1],D$A=D$Z[2],D$x=D$Z[3],D$B=D$e.elements,D$$=D$B[0],D$l=D$B[1],D$V=D$B[2],D$b=D$B[3],D$o=D$U.elements;D$k=(D$k=D$$<D$k?D$$:D$k)<D$h?D$h:D$k,D$j=(D$j=D$l<D$j?D$l:D$j)<D$H?D$H:D$j,D$T=(D$T=D$V<D$T?D$V:D$T)<D$A?D$A:D$T,D$Y=(D$Y=D$b<D$Y?D$b:D$Y)<D$x?D$x:D$Y,D$o[0]=D$k,D$o[1]=D$j,D$o[2]=D$T,D$o[3]=D$Y},D$s.distanceSquared=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$e[0]-D$U[0],D$k=D$e[1]-D$U[1],D$j=D$e[2]-D$U[2],D$T=D$e[3]-D$U[3];return D$m*D$m+D$k*D$k+D$j*D$j+D$T*D$T},D$s.distance=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements,D$m=D$e[0]-D$U[0],D$k=D$e[1]-D$U[1],D$j=D$e[2]-D$U[2],D$T=D$e[3]-D$U[3];return Math.sqrt(D$m*D$m+D$k*D$k+D$j*D$j+D$T*D$T)},D$s.dot=function(D$s,D$r){var D$e=D$s.elements,D$U=D$r.elements;return D$e[0]*D$U[0]+D$e[1]*D$U[1]+D$e[2]*D$U[2]+D$e[3]*D$U[3]},D$s.min=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=Math.min(D$m[0],D$k[0]),D$U[1]=Math.min(D$m[1],D$k[1]),D$U[2]=Math.min(D$m[2],D$k[2]),D$U[3]=Math.min(D$m[3],D$k[3])},D$s.max=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r.elements;D$U[0]=Math.max(D$m[0],D$k[0]),D$U[1]=Math.max(D$m[1],D$k[1]),D$U[2]=Math.max(D$m[2],D$k[2]),D$U[3]=Math.max(D$m[3],D$k[3])},D$H(D$s,["ZERO",function(){return this.ZERO=new D$s},"ONE",function(){return this.ONE=new D$s(1,1,1,1)},"UnitX",function(){return this.UnitX=new D$s(1,0,0,0)},"UnitY",function(){return this.UnitY=new D$s(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new D$s(0,0,1,0)},"UnitW",function(){return this.UnitW=new D$s(0,0,0,1)}]),D$s}(),D$Yr=function(){function D$k(D$s,D$r,D$e,D$U){this.minDepth=0,this.maxDepth=1,this.x=D$s,this.y=D$r,this.width=D$e,this.height=D$U}D$x(D$k,"laya.d3.math.Viewport");var D$s=D$k.prototype;return D$s.project=function(D$s,D$r,D$e){D$jr.transformV3ToV3(D$s,D$r,D$e);var D$U=D$s.elements,D$m=D$r.elements,D$k=D$e.elements,D$j=D$U[0]*D$m[3]+D$U[1]*D$m[7]+D$U[2]*D$m[11]+D$m[15];1!==D$j&&(D$k[0]=D$k[0]/D$j,D$k[1]=D$k[1]/D$j,D$k[2]=D$k[2]/D$j),D$k[0]=.5*(D$k[0]+1)*this.width+this.x,D$k[1]=.5*(1-D$k[1])*this.height+this.y,D$k[2]=D$k[2]*(this.maxDepth-this.minDepth)+this.minDepth},D$s.unprojectFromMat=function(D$s,D$r,D$e){var D$U=D$s.elements,D$m=D$r.elements,D$k=D$e.elements;D$k[0]=(D$U[0]-this.x)/this.width*2-1,D$k[1]=-((D$U[1]-this.y)/this.height*2-1);var D$j=(this.maxDepth-this.minDepth)/2;D$k[2]=(D$U[2]-this.minDepth-D$j)/D$j;var D$T=D$k[0]*D$m[3]+D$k[1]*D$m[7]+D$k[2]*D$m[11]+D$m[15];D$jr.transformV3ToV3(D$e,D$r,D$e),1!==D$T&&(D$k[0]=D$k[0]/D$T,D$k[1]=D$k[1]/D$T,D$k[2]=D$k[2]/D$T)},D$s.unprojectFromWVP=function(D$s,D$r,D$e,D$U,D$m){D$sr.multiply(D$r,D$e,D$k._tempMatrix4x4),D$U&&D$sr.multiply(D$k._tempMatrix4x4,D$U,D$k._tempMatrix4x4),D$k._tempMatrix4x4.invert(D$k._tempMatrix4x4),this.unprojectFromMat(D$s,D$k._tempMatrix4x4,D$m)},D$H(D$k,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new D$sr}]),D$k}(),D$Zr=function(){function D$J(D$s){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=D$s,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}D$x(D$J,"laya.d3.resource.models.SubMesh");var D$s=D$J.prototype;return D$w.imps(D$s,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),D$s._getVertexBuffer=function(D$s){return void 0===D$s&&(D$s=0),0===D$s?this._vertexBuffer:null},D$s._getIndexBuffer=function(){return this._indexBuffer},D$s._getStaticBatchBakedVertexs=function(D$s,D$r){var D$e,D$U,D$m=this._vertexBuffer,D$k=D$m.vertexDeclaration,D$j=D$k.getVertexElementByUsage(0).offset/4,D$T=D$k.getVertexElementByUsage(3).offset/4,D$Y=D$r.meshRender.lightmapScaleOffset,D$Z=0,D$h=0,D$H=0,D$A=0,D$x=0,D$B=0;if(D$Y)if(D$U=D$k.getVertexElementByUsage(15))D$H=D$k.vertexStride/4,D$e=0<this._vertexCount?D$m.getData().slice(this._vertexStart*D$H,(this._vertexStart+this._vertexCount)*D$H):D$m.getData().slice(),D$A=D$U.offset/4;else{D$H=(D$B=D$k.vertexStride/4)+2,D$e=this._vertexCount?new Float32Array(this._vertexCount*(D$m.vertexDeclaration.vertexStride/4+2)):new Float32Array(D$m.vertexCount*(D$m.vertexDeclaration.vertexStride/4+2)),D$A=(D$x=D$k.getVertexElementByUsage(2).offset/4)+2;var D$$=D$m.getData();for(D$Z=0,D$h=D$$.length/D$B;D$Z<D$h;D$Z++){var D$l=0;D$l=0<this._vertexCount?(this._vertexStart+D$Z)*D$B:D$Z*D$B;var D$V=D$Z*D$H,D$b=0;for(D$b=0;D$b<D$A;D$b++)D$e[D$V+D$b]=D$$[D$l+D$b];for(D$b=D$A;D$b<D$B;D$b++)D$e[D$V+D$b+2]=D$$[D$l+D$b]}}else D$H=D$k.vertexStride/4,D$e=this._vertexCount?D$m.getData().slice(this._vertexStart*D$H,(this._vertexStart+this._vertexCount)*D$H):D$m.getData().slice();if(D$s){var D$o=D$s.worldMatrix,D$I=D$J._tempMatrix4x40;D$o.invert(D$I);var D$w=D$J._tempMatrix4x41,D$X=D$r.transform.worldMatrix;D$sr.multiply(D$I,D$X,D$w)}else D$w=D$r.transform.worldMatrix;var D$D=D$J._tempQuaternion0;for(D$w.decomposeTransRotScale(D$J._tempVector30,D$D,D$J._tempVector31),D$Z=0,D$h=D$e.length/D$H;D$Z<D$h;D$Z++){var D$n=D$Z*D$H+D$j,D$y=D$Z*D$H+D$T;if(D$lr.transformVector3ArrayToVector3ArrayCoordinate(D$e,D$n,D$w,D$e,D$n),D$lr.transformVector3ArrayByQuat(D$e,D$y,D$D,D$e,D$y),D$Y){var D$g=D$Z*D$H+D$A;if(D$U)D$lr.transformLightingMapTexcoordByUV1Array(D$e,D$g,D$Y,D$e,D$g);else{var D$f=D$Z*D$B+D$x;D$lr.transformLightingMapTexcoordByUV0Array(D$$,D$f,D$Y,D$e,D$g)}}}return D$e},D$s._getVertexBuffers=function(){return null},D$s._beforeRender=function(D$s){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},D$s._render=function(D$s){var D$r,D$e=0,D$U=D$s.renderElement;if(1<this._indexCount){var D$m=this._boneIndicesList.length;if(1<D$m){for(var D$k=0;D$k<D$m;D$k++)(D$r=D$U._skinAnimationDatas||this._skinAnimationDatas)&&(D$U._shaderValue.setValue(0,D$r[D$k]),D$s._shader.uploadRenderElementUniforms(D$U._shaderValue.data)),D$P.mainContext.drawElements(4,this._subIndexBufferCount[D$k],5123,2*this._subIndexBufferStart[D$k]);D$n.drawCall+=D$m}else(D$r=D$U._skinAnimationDatas||this._skinAnimationDatas)&&(D$U._shaderValue.setValue(0,D$r[0]),D$s._shader.uploadRenderElementUniforms(D$U._shaderValue.data)),D$P.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),D$n.drawCall++;D$e=this._indexCount}else D$e=this._indexBuffer.indexCount,(D$r=D$U._skinAnimationDatas||this._skinAnimationDatas)&&(D$U._shaderValue.setValue(0,D$r[0]),D$s._shader.uploadRenderElementUniforms(D$U._shaderValue.data)),D$P.mainContext.drawElements(4,D$e,5123,0),D$n.drawCall++;D$n.trianglesFaces+=D$e/3},D$s.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},D$s.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},D$B(0,D$s,"_vertexBufferCount",function(){return 1}),D$B(0,D$s,"triangleCount",function(){return this._indexBuffer.indexCount/3}),D$H(D$J,["_tempVector30",function(){return this._tempVector30=new D$jr},"_tempVector31",function(){return this._tempVector31=new D$jr},"_tempQuaternion0",function(){return this._tempQuaternion0=new D$er},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new D$sr},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new D$sr}]),D$J}(),D$hr=function(){function D$s(D$s){this.defineCounter=0,this.defines=null,D$s?(this.defineCounter=D$s.defineCounter,this.defines=D$s.defines.slice()):(this.defineCounter=0,this.defines=[])}return D$x(D$s,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),D$s.prototype.registerDefine=function(D$s){var D$r=Math.pow(2,this.defineCounter++);return this.defines[D$r]=D$s,D$r},D$s}(),D$Hr=function(){function D$s(){}return D$x(D$s,"laya.d3.shader.ShaderInit3D"),D$s.__init__=function(){var D$s,D$r;D$nr._globalRegDefine("HIGHPRECISION",D$nr.SHADERDEFINE_HIGHPRECISION),D$nr._globalRegDefine("FOG",D$nr.SHADERDEFINE_FOG),D$nr._globalRegDefine("DIRECTIONLIGHT",D$nr.SHADERDEFINE_DIRECTIONLIGHT),D$nr._globalRegDefine("POINTLIGHT",D$nr.SHADERDEFINE_POINTLIGHT),D$nr._globalRegDefine("SPOTLIGHT",D$nr.SHADERDEFINE_SPOTLIGHT),D$nr._globalRegDefine("UV",D$nr.SHADERDEFINE_UV0),D$nr._globalRegDefine("COLOR",D$nr.SHADERDEFINE_COLOR),D$nr._globalRegDefine("UV1",D$nr.SHADERDEFINE_UV1),D$nr._globalRegDefine("CASTSHADOW",D$xr.SHADERDEFINE_CAST_SHADOW),D$nr._globalRegDefine("SHADOWMAP_PSSM1",D$xr.SHADERDEFINE_SHADOW_PSSM1),D$nr._globalRegDefine("SHADOWMAP_PSSM2",D$xr.SHADERDEFINE_SHADOW_PSSM2),D$nr._globalRegDefine("SHADOWMAP_PSSM3",D$xr.SHADERDEFINE_SHADOW_PSSM3),D$nr._globalRegDefine("SHADOWMAP_PCF_NO",D$xr.SHADERDEFINE_SHADOW_PCF_NO),D$nr._globalRegDefine("SHADOWMAP_PCF1",D$xr.SHADERDEFINE_SHADOW_PCF1),D$nr._globalRegDefine("SHADOWMAP_PCF2",D$xr.SHADERDEFINE_SHADOW_PCF2),D$nr._globalRegDefine("SHADOWMAP_PCF3",D$xr.SHADERDEFINE_SHADOW_PCF3),D$nr._globalRegDefine("DEPTHFOG",D$nr.SAHDERDEFINE_DEPTHFOG),D$vr.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),D$vr.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),D$s={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},D$r={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var D$e=D$vr.nameKey.add("SIMPLE");shaderCompile=D$nr.add(D$e,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',D$s,D$r),D$Sr.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),D$Sr.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),D$Sr.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),D$Sr.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),D$Sr.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),D$Sr.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),D$Sr.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),D$Sr.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),D$Sr.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},D$s}(),D$Ar=function(){function D$s(){this._data=null,this._data=[]}D$x(D$s,"laya.d3.shader.ValusArray");var D$r=D$s.prototype;return D$r.setValue=function(D$s,D$r){this._data[D$s]=D$r},D$B(0,D$r,"data",function(){return this._data}),D$s}(),D$xr=function(){function D$s(){}return D$s.SHADERDEFINE_RECEIVE_SHADOW=1,D$s.SHADERDEFINE_CAST_SHADOW=512,D$s.SHADERDEFINE_SHADOW_PSSM1=1024,D$s.SHADERDEFINE_SHADOW_PSSM2=2048,D$s.SHADERDEFINE_SHADOW_PSSM3=4096,D$s.SHADERDEFINE_SHADOW_PCF_NO=8192,D$s.SHADERDEFINE_SHADOW_PCF1=16384,D$s.SHADERDEFINE_SHADOW_PCF2=32768,D$s.SHADERDEFINE_SHADOW_PCF3=65536,D$s.MAX_PSSM_COUNT=3,D$s}(),D$Br=function(){function D$t(){}return D$x(D$t,"laya.d3.utils.Picker"),D$t.calculateCursorRay=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$s.elements[0],D$T=D$s.elements[1],D$Y=D$t._tempVector30,D$Z=D$Y.elements;D$Z[0]=D$j,D$Z[1]=D$T,D$Z[2]=D$r.minDepth;var D$h=D$t._tempVector31,D$H=D$h.elements;D$H[0]=D$j,D$H[1]=D$T,D$H[2]=D$r.maxDepth;var D$A=D$k.origin,D$x=D$t._tempVector32;D$r.unprojectFromWVP(D$Y,D$e,D$U,D$m,D$A),D$r.unprojectFromWVP(D$h,D$e,D$U,D$m,D$x);var D$B=D$k.direction.elements;D$B[0]=D$x.x-D$A.x,D$B[1]=D$x.y-D$A.y,D$B[2]=D$x.z-D$A.z,D$jr.normalize(D$k.direction,D$k.direction)},D$t.rayIntersectsPositionsAndIndices=function(D$s,D$r,D$e,D$U,D$m){for(var D$k=D$e.vertexStride/4,D$j=D$e.getVertexElementByUsage(0).offset/4,D$T=Number.MAX_VALUE,D$Y=-1,D$Z=-1,D$h=-1,D$H=0;D$H<D$U.length;D$H+=3){var D$A=D$t._tempVector35,D$x=D$A.elements,D$B=D$U[D$H]*D$k,D$$=D$B+D$j;D$x[0]=D$r[D$$],D$x[1]=D$r[1+D$$],D$x[2]=D$r[2+D$$];var D$l=D$t._tempVector36,D$V=D$l.elements,D$b=D$U[D$H+1]*D$k,D$o=D$b+D$j;D$V[0]=D$r[D$o],D$V[1]=D$r[1+D$o],D$V[2]=D$r[2+D$o];var D$I=D$t._tempVector37,D$w=D$I.elements,D$X=D$U[D$H+2]*D$k,D$D=D$X+D$j;D$w[0]=D$r[D$D],D$w[1]=D$r[1+D$D],D$w[2]=D$r[2+D$D];var D$n=laya.d3.utils.Picker.rayIntersectsTriangle(D$s,D$A,D$l,D$I);!isNaN(D$n)&&D$n<D$T&&(D$T=D$n,D$Y=D$B,D$Z=D$b,D$h=D$X)}if(D$T===Number.MAX_VALUE)return D$m.position.toDefault(),D$m.distance=Number.MAX_VALUE,D$m.trianglePositions[0].toDefault(),D$m.trianglePositions[1].toDefault(),D$m.trianglePositions[2].toDefault(),D$m.triangleNormals[0].toDefault(),D$m.triangleNormals[1].toDefault(),D$m.triangleNormals[2].toDefault(),!1;D$m.distance=D$T,D$jr.scale(D$s.direction,D$T,D$m.position),D$jr.add(D$s.origin,D$m.position,D$m.position);var D$y=D$m.trianglePositions,D$g=D$y[0],D$f=D$y[1],D$J=D$y[2],D$P=D$g.elements,D$O=D$f.elements,D$i=D$J.elements,D$K=D$Y+D$j;D$P[0]=D$r[D$K],D$P[1]=D$r[D$K+1],D$P[2]=D$r[D$K+2];var D$c=D$Z+D$j;D$O[0]=D$r[D$c],D$O[1]=D$r[D$c+1],D$O[2]=D$r[D$c+2];var D$E=D$h+D$j;D$i[0]=D$r[D$E],D$i[1]=D$r[D$E+1],D$i[2]=D$r[D$E+2];var D$v=D$e.getVertexElementByUsage(3);if(D$v){var D$S=D$v.offset/4,D$z=D$m.triangleNormals,D$Q=D$z[0],D$C=D$z[1],D$R=D$z[2],D$a=D$Q.elements,D$p=D$C.elements,D$N=D$R.elements,D$q=D$Y+D$S;D$a[0]=D$r[D$q],D$a[1]=D$r[D$q+1],D$a[2]=D$r[D$q+2];var D$G=D$Z+D$S;D$p[0]=D$r[D$G],D$p[1]=D$r[D$G+1],D$p[2]=D$r[D$G+2];var D$d=D$h+D$S;D$N[0]=D$r[D$d],D$N[1]=D$r[D$d+1],D$N[2]=D$r[D$d+2]}return!0},D$t.rayIntersectsTriangle=function(D$s,D$r,D$e,D$U){var D$m=D$t._tempVector30,D$k=D$t._tempVector31;D$jr.subtract(D$e,D$r,D$m),D$jr.subtract(D$U,D$r,D$k);var D$j,D$T=D$t._tempVector32;if(D$jr.cross(D$s.direction,D$k,D$T),(D$j=D$jr.dot(D$m,D$T))>-Number.MIN_VALUE&&D$j<Number.MIN_VALUE)return Number.NaN;var D$Y,D$Z=1/D$j,D$h=D$t._tempVector33;if(D$jr.subtract(D$s.origin,D$r,D$h),D$Y=D$jr.dot(D$h,D$T),(D$Y*=D$Z)<0||1<D$Y)return Number.NaN;var D$H,D$A,D$x=D$t._tempVector34;return D$jr.cross(D$h,D$m,D$x),D$H=D$jr.dot(D$s.direction,D$x),(D$H*=D$Z)<0||1<D$Y+D$H?Number.NaN:(D$A=D$jr.dot(D$k,D$x),(D$A*=D$Z)<0?Number.NaN:D$A)},D$H(D$t,["_tempVector30",function(){return this._tempVector30=new D$jr},"_tempVector31",function(){return this._tempVector31=new D$jr},"_tempVector32",function(){return this._tempVector32=new D$jr},"_tempVector33",function(){return this._tempVector33=new D$jr},"_tempVector34",function(){return this._tempVector34=new D$jr},"_tempVector35",function(){return this._tempVector35=new D$jr},"_tempVector36",function(){return this._tempVector36=new D$jr},"_tempVector37",function(){return this._tempVector37=new D$jr}]),D$t}(),D$$r=(function(){function D$s(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new D$jr,new D$jr,new D$jr],this.trianglePositions.length=3,this.triangleNormals=[new D$jr,new D$jr,new D$jr],this.triangleNormals.length=3,this.position=new D$jr}D$x(D$s,"laya.d3.utils.RaycastHit"),D$s.prototype.cloneTo=function(D$s){D$s.distance=this.distance,this.trianglePositions[0].cloneTo(D$s.trianglePositions[0]),this.trianglePositions[1].cloneTo(D$s.trianglePositions[1]),this.trianglePositions[2].cloneTo(D$s.trianglePositions[2]),this.triangleNormals[0].cloneTo(D$s.triangleNormals[0]),this.triangleNormals[1].cloneTo(D$s.triangleNormals[1]),this.triangleNormals[2].cloneTo(D$s.triangleNormals[2]),this.position.cloneTo(D$s.position),D$s.sprite3D=this.sprite3D}}(),function(){function D$s(D$s,D$r){this._width=0,this._height=0,this._width=D$s,this._height=D$r}D$x(D$s,"laya.d3.utils.Size");var D$r=D$s.prototype;return D$B(0,D$r,"width",function(){return-1===this._width?D$W.clientWidth:this._width}),D$B(0,D$r,"height",function(){return-1===this._height?D$W.clientHeight:this._height}),D$B(1,D$s,"fullScreen",function(){return new D$s(-1,-1)}),D$s}()),D$lr=function(){function D$K(){}return D$x(D$K,"laya.d3.utils.Utils3D"),D$K._rotationTransformScaleSkinAnimation=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H){var D$A,D$x,D$B,D$$,D$l,D$V=D$K._tempArray16_0,D$b=D$K._tempArray16_1,D$o=D$K._tempArray16_2,D$I=D$U+D$U,D$w=D$m+D$m,D$X=D$k+D$k,D$D=D$U*D$I,D$n=D$m*D$I,D$y=D$m*D$w,D$g=D$k*D$I,D$f=D$k*D$w,D$J=D$k*D$X,D$P=D$j*D$I,D$O=D$j*D$w,D$i=D$j*D$X;for(D$V[15]=1,D$V[0]=1-D$y-D$J,D$V[1]=D$n+D$i,D$V[2]=D$g-D$O,D$V[4]=D$n-D$i,D$V[5]=1-D$D-D$J,D$V[6]=D$f+D$P,D$V[8]=D$g+D$O,D$V[9]=D$f-D$P,D$V[10]=1-D$D-D$y,D$b[15]=1,D$b[0]=D$T,D$b[5]=D$Y,D$b[10]=D$Z,D$A=0;D$A<4;D$A++)D$x=D$V[D$A],D$B=D$V[D$A+4],D$$=D$V[D$A+8],D$l=D$V[D$A+12],D$o[D$A]=D$x,D$o[D$A+4]=D$B,D$o[D$A+8]=D$$,D$o[D$A+12]=D$x*D$s+D$B*D$r+D$$*D$e+D$l;for(D$A=0;D$A<4;D$A++)D$x=D$o[D$A],D$B=D$o[D$A+4],D$$=D$o[D$A+8],D$l=D$o[D$A+12],D$h[D$A+D$H]=D$x*D$b[0]+D$B*D$b[1]+D$$*D$b[2]+D$l*D$b[3],D$h[D$A+D$H+4]=D$x*D$b[4]+D$B*D$b[5]+D$$*D$b[6]+D$l*D$b[7],D$h[D$A+D$H+8]=D$x*D$b[8]+D$B*D$b[9]+D$$*D$b[10]+D$l*D$b[11],D$h[D$A+D$H+12]=D$x*D$b[12]+D$B*D$b[13]+D$$*D$b[14]+D$l*D$b[15]},D$K._createNodeByJson=function(D$s,D$r,D$e,D$U){if(!D$e)switch(D$r.type){case"Sprite3D":D$e=new D$Er;break;case"MeshSprite3D":D$e=new D$tr;break;case"SkinnedMeshSprite3D":D$e=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":D$e=new ShuriKenParticle3D;break;case"TrailSprite3D":D$e=new TrailSprite3D;break;case"Terrain":D$e=new Terrain;break;case"Camera":D$e=new D$dr;break;case"DirectionLight":D$e=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var D$m=D$r.props;if(D$m)for(var D$k in D$m)D$e[D$k]=D$m[D$k];var D$j=D$r.customProps;D$j&&(D$e instanceof laya.d3.core.Sprite3D?(D$e._parseBaseCustomProps(D$j),D$e._parseCustomProps(D$s,D$U,D$j,D$r),D$e._parseCustomComponent(D$s,D$U,D$r.components)):D$e._parseCustomProps(D$s,D$U,D$j,D$r));var D$T=D$r.child;if(D$T)for(var D$Y=0,D$Z=D$T.length;D$Y<D$Z;D$Y++){var D$h=D$K._createNodeByJson(D$s,D$T[D$Y],null,D$U);D$e.addChild(D$h)}return D$e},D$K._computeBoneAndAnimationDatasByBindPoseMatrxix=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j,D$T,D$Y=0,D$Z=0,D$h=D$s.length;for(D$j=0;D$j<D$h;D$Y+=D$s[D$j].keyframeWidth,D$Z+=16,D$j++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(D$r[D$Y+0],D$r[D$Y+1],D$r[D$Y+2],D$r[D$Y+3],D$r[D$Y+4],D$r[D$Y+5],D$r[D$Y+6],D$r[D$Y+7],D$r[D$Y+8],D$r[D$Y+9],D$U,D$Z),0!=D$j&&(D$T=16*D$s[D$j].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(D$U,D$T,D$U,D$Z,D$U,D$Z));var D$H=D$e.length;for(D$j=0;D$j<D$H;D$j++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(D$U,16*D$k[D$j],D$e[D$j],D$m,16*D$j)},D$K._computeAnimationDatasByArrayAndMatrixFast=function(D$s,D$r,D$e,D$U){for(var D$m=0,D$k=D$s.length;D$m<D$k;D$m++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(D$r,16*D$U[D$m],D$s[D$m],D$e,16*D$m)},D$K._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(D$s,D$r,D$e,D$U,D$m){var D$k,D$j,D$T=0,D$Y=0,D$Z=D$s.length;for(D$k=0;D$k<D$Z;D$T+=D$s[D$k].keyframeWidth,D$Y+=16,D$k++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(D$r[D$T+7],D$r[D$T+8],D$r[D$T+9],D$r[D$T+3],D$r[D$T+4],D$r[D$T+5],D$r[D$T+6],D$r[D$T+0],D$r[D$T+1],D$r[D$T+2],D$U,D$Y),0!=D$k&&(D$j=16*D$s[D$k].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(D$U,D$j,D$U,D$Y,D$U,D$Y));var D$h=D$e.length;for(D$k=0;D$k<D$h;D$k++){var D$H=16*D$k;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(D$U,D$H,D$e[D$k],D$m,D$H)}},D$K._computeAnimationDatasByArrayAndMatrixFastOld=function(D$s,D$r,D$e){for(var D$U=D$s.length,D$m=0;D$m<D$U;D$m++){var D$k=16*D$m;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(D$r,D$k,D$s[D$m],D$e,D$k)}},D$K._computeRootAnimationData=function(D$s,D$r,D$e){for(var D$U=0,D$m=0,D$k=0,D$j=D$s.length;D$U<D$j;D$m+=D$s[D$U].keyframeWidth,D$k+=16,D$U++)laya.d3.utils.Utils3D.createAffineTransformationArray(D$r[D$m+0],D$r[D$m+1],D$r[D$m+2],D$r[D$m+3],D$r[D$m+4],D$r[D$m+5],D$r[D$m+6],D$r[D$m+7],D$r[D$m+8],D$r[D$m+9],D$e,D$k)},D$K.transformVector3ArrayByQuat=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$e.elements,D$j=D$s[D$r],D$T=D$s[D$r+1],D$Y=D$s[D$r+2],D$Z=D$k[0],D$h=D$k[1],D$H=D$k[2],D$A=D$k[3],D$x=D$A*D$j+D$h*D$Y-D$H*D$T,D$B=D$A*D$T+D$H*D$j-D$Z*D$Y,D$$=D$A*D$Y+D$Z*D$T-D$h*D$j,D$l=-D$Z*D$j-D$h*D$T-D$H*D$Y;D$U[D$m]=D$x*D$A+D$l*-D$Z+D$B*-D$H-D$$*-D$h,D$U[D$m+1]=D$B*D$A+D$l*-D$h+D$$*-D$Z-D$x*-D$H,D$U[D$m+2]=D$$*D$A+D$l*-D$H+D$x*-D$h-D$B*-D$Z},D$K.mulMatrixByArray=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j,D$T,D$Y,D$Z,D$h;if(D$m===D$e){for(D$e=D$K._tempArray16_3,D$j=0;D$j<16;++D$j)D$e[D$j]=D$m[D$k+D$j];D$U=0}for(D$j=0;D$j<4;D$j++)D$T=D$s[D$r+D$j],D$Y=D$s[D$r+D$j+4],D$Z=D$s[D$r+D$j+8],D$h=D$s[D$r+D$j+12],D$m[D$k+D$j]=D$T*D$e[D$U+0]+D$Y*D$e[D$U+1]+D$Z*D$e[D$U+2]+D$h*D$e[D$U+3],D$m[D$k+D$j+4]=D$T*D$e[D$U+4]+D$Y*D$e[D$U+5]+D$Z*D$e[D$U+6]+D$h*D$e[D$U+7],D$m[D$k+D$j+8]=D$T*D$e[D$U+8]+D$Y*D$e[D$U+9]+D$Z*D$e[D$U+10]+D$h*D$e[D$U+11],D$m[D$k+D$j+12]=D$T*D$e[D$U+12]+D$Y*D$e[D$U+13]+D$Z*D$e[D$U+14]+D$h*D$e[D$U+15]},D$K.mulMatrixByArrayFast=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j,D$T,D$Y,D$Z,D$h;for(D$j=0;D$j<4;D$j++)D$T=D$s[D$r+D$j],D$Y=D$s[D$r+D$j+4],D$Z=D$s[D$r+D$j+8],D$h=D$s[D$r+D$j+12],D$m[D$k+D$j]=D$T*D$e[D$U+0]+D$Y*D$e[D$U+1]+D$Z*D$e[D$U+2]+D$h*D$e[D$U+3],D$m[D$k+D$j+4]=D$T*D$e[D$U+4]+D$Y*D$e[D$U+5]+D$Z*D$e[D$U+6]+D$h*D$e[D$U+7],D$m[D$k+D$j+8]=D$T*D$e[D$U+8]+D$Y*D$e[D$U+9]+D$Z*D$e[D$U+10]+D$h*D$e[D$U+11],D$m[D$k+D$j+12]=D$T*D$e[D$U+12]+D$Y*D$e[D$U+13]+D$Z*D$e[D$U+14]+D$h*D$e[D$U+15]},D$K.mulMatrixByArrayAndMatrixFast=function(D$s,D$r,D$e,D$U,D$m){var D$k,D$j,D$T,D$Y,D$Z,D$h=D$e.elements,D$H=D$h[0],D$A=D$h[1],D$x=D$h[2],D$B=D$h[3],D$$=D$h[4],D$l=D$h[5],D$V=D$h[6],D$b=D$h[7],D$o=D$h[8],D$I=D$h[9],D$w=D$h[10],D$X=D$h[11],D$D=D$h[12],D$n=D$h[13],D$y=D$h[14],D$g=D$h[15],D$f=D$r,D$J=D$r+4,D$P=D$r+8,D$O=D$r+12,D$i=D$m,D$K=D$m+4,D$c=D$m+8,D$E=D$m+12;for(D$k=0;D$k<4;D$k++)D$j=D$s[D$f+D$k],D$T=D$s[D$J+D$k],D$Y=D$s[D$P+D$k],D$Z=D$s[D$O+D$k],D$U[D$i+D$k]=D$j*D$H+D$T*D$A+D$Y*D$x+D$Z*D$B,D$U[D$K+D$k]=D$j*D$$+D$T*D$l+D$Y*D$V+D$Z*D$b,D$U[D$c+D$k]=D$j*D$o+D$T*D$I+D$Y*D$w+D$Z*D$X,D$U[D$E+D$k]=D$j*D$D+D$T*D$n+D$Y*D$y+D$Z*D$g},D$K.createAffineTransformationArray=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H){var D$A=D$U+D$U,D$x=D$m+D$m,D$B=D$k+D$k,D$$=D$U*D$A,D$l=D$U*D$x,D$V=D$U*D$B,D$b=D$m*D$x,D$o=D$m*D$B,D$I=D$k*D$B,D$w=D$j*D$A,D$X=D$j*D$x,D$D=D$j*D$B;D$h[D$H+0]=(1-(D$b+D$I))*D$T,D$h[D$H+1]=(D$l+D$D)*D$T,D$h[D$H+2]=(D$V-D$X)*D$T,D$h[D$H+3]=0,D$h[D$H+4]=(D$l-D$D)*D$Y,D$h[D$H+5]=(1-(D$$+D$I))*D$Y,D$h[D$H+6]=(D$o+D$w)*D$Y,D$h[D$H+7]=0,D$h[D$H+8]=(D$V+D$X)*D$Z,D$h[D$H+9]=(D$o-D$w)*D$Z,D$h[D$H+10]=(1-(D$$+D$b))*D$Z,D$h[D$H+11]=0,D$h[D$H+12]=D$s,D$h[D$H+13]=D$r,D$h[D$H+14]=D$e,D$h[D$H+15]=1},D$K.transformVector3ArrayToVector3ArrayCoordinate=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$K._tempArray4_0,D$j=D$s[D$r+0],D$T=D$s[D$r+1],D$Y=D$s[D$r+2],D$Z=D$e.elements;D$k[0]=D$j*D$Z[0]+D$T*D$Z[4]+D$Y*D$Z[8]+D$Z[12],D$k[1]=D$j*D$Z[1]+D$T*D$Z[5]+D$Y*D$Z[9]+D$Z[13],D$k[2]=D$j*D$Z[2]+D$T*D$Z[6]+D$Y*D$Z[10]+D$Z[14],D$k[3]=1/(D$j*D$Z[3]+D$T*D$Z[7]+D$Y*D$Z[11]+D$Z[15]),D$U[D$m+0]=D$k[0]*D$k[3],D$U[D$m+1]=D$k[1]*D$k[3],D$U[D$m+2]=D$k[2]*D$k[3]},D$K.transformLightingMapTexcoordByUV0Array=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$e.elements;D$U[D$m+0]=D$s[D$r+0]*D$k[0]+D$k[2],D$U[D$m+1]=(D$s[D$r+1]-1)*D$k[1]+D$k[3]},D$K.transformLightingMapTexcoordByUV1Array=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$e.elements;D$U[D$m+0]=D$s[D$r+0]*D$k[0]+D$k[2],D$U[D$m+1]=1+D$s[D$r+1]*D$k[1]+D$k[3]},D$K.getURLVerion=function(D$s){var D$r=D$s.indexOf("?");return 0<=D$r?D$s.substr(D$r):null},D$K._quaternionCreateFromYawPitchRollArray=function(D$s,D$r,D$e,D$U){var D$m=.5*D$e,D$k=.5*D$r,D$j=.5*D$s,D$T=Math.sin(D$m),D$Y=Math.cos(D$m),D$Z=Math.sin(D$k),D$h=Math.cos(D$k),D$H=Math.sin(D$j),D$A=Math.cos(D$j);D$U[0]=D$A*D$Z*D$Y+D$H*D$h*D$T,D$U[1]=D$H*D$h*D$Y-D$A*D$Z*D$T,D$U[2]=D$A*D$h*D$T-D$H*D$Z*D$Y,D$U[3]=D$A*D$h*D$Y+D$H*D$Z*D$T},D$K._createAffineTransformationArray=function(D$s,D$r,D$e,D$U){var D$m=D$r[0],D$k=D$r[1],D$j=D$r[2],D$T=D$r[3],D$Y=D$m+D$m,D$Z=D$k+D$k,D$h=D$j+D$j,D$H=D$m*D$Y,D$A=D$m*D$Z,D$x=D$m*D$h,D$B=D$k*D$Z,D$$=D$k*D$h,D$l=D$j*D$h,D$V=D$T*D$Y,D$b=D$T*D$Z,D$o=D$T*D$h,D$I=D$e[0],D$w=D$e[1],D$X=D$e[2];D$U[0]=(1-(D$B+D$l))*D$I,D$U[1]=(D$A+D$o)*D$I,D$U[2]=(D$x-D$b)*D$I,D$U[3]=0,D$U[4]=(D$A-D$o)*D$w,D$U[5]=(1-(D$H+D$l))*D$w,D$U[6]=(D$$+D$V)*D$w,D$U[7]=0,D$U[8]=(D$x+D$b)*D$X,D$U[9]=(D$$-D$V)*D$X,D$U[10]=(1-(D$H+D$B))*D$X,D$U[11]=0,D$U[12]=D$s[0],D$U[13]=D$s[1],D$U[14]=D$s[2],D$U[15]=1},D$K._mulMatrixArray=function(D$s,D$r,D$e,D$U){var D$m,D$k,D$j,D$T,D$Y,D$Z=D$r.elements,D$h=D$Z[0],D$H=D$Z[1],D$A=D$Z[2],D$x=D$Z[3],D$B=D$Z[4],D$$=D$Z[5],D$l=D$Z[6],D$V=D$Z[7],D$b=D$Z[8],D$o=D$Z[9],D$I=D$Z[10],D$w=D$Z[11],D$X=D$Z[12],D$D=D$Z[13],D$n=D$Z[14],D$y=D$Z[15],D$g=D$U,D$f=D$U+4,D$J=D$U+8,D$P=D$U+12;for(D$m=0;D$m<4;D$m++)D$k=D$s[D$m],D$j=D$s[D$m+4],D$T=D$s[D$m+8],D$Y=D$s[D$m+12],D$e[D$g+D$m]=D$k*D$h+D$j*D$H+D$T*D$A+D$Y*D$x,D$e[D$f+D$m]=D$k*D$B+D$j*D$$+D$T*D$l+D$Y*D$V,D$e[D$J+D$m]=D$k*D$b+D$j*D$o+D$T*D$I+D$Y*D$w,D$e[D$P+D$m]=D$k*D$X+D$j*D$D+D$T*D$n+D$Y*D$y},D$K.getYawPitchRoll=function(D$s,D$r){D$K.transformQuat(D$jr.ForwardRH,D$s,D$er.TEMPVector31),D$K.transformQuat(D$jr.Up,D$s,D$er.TEMPVector32);var D$e=D$er.TEMPVector32.elements;D$K.angleTo(D$jr.ZERO,D$er.TEMPVector31,D$er.TEMPVector33);var D$U=D$er.TEMPVector33.elements;D$U[0]==Math.PI/2?(D$U[1]=D$K.arcTanAngle(D$e[2],D$e[0]),D$U[2]=0):D$U[0]==-Math.PI/2?(D$U[1]=D$K.arcTanAngle(-D$e[2],-D$e[0]),D$U[2]=0):(D$sr.createRotationY(-D$U[1],D$er.TEMPMatrix0),D$sr.createRotationX(-D$U[0],D$er.TEMPMatrix1),D$jr.transformCoordinate(D$er.TEMPVector32,D$er.TEMPMatrix0,D$er.TEMPVector32),D$jr.transformCoordinate(D$er.TEMPVector32,D$er.TEMPMatrix1,D$er.TEMPVector32),D$U[2]=D$K.arcTanAngle(D$e[1],-D$e[0])),D$U[1]<=-Math.PI&&(D$U[1]=Math.PI),D$U[2]<=-Math.PI&&(D$U[2]=Math.PI),D$U[1]>=Math.PI&&D$U[2]>=Math.PI&&(D$U[1]=0,D$U[2]=0,D$U[0]=Math.PI-D$U[0]),D$r[0]=D$U[1],D$r[1]=D$U[0],D$r[2]=D$U[2]},D$K.arcTanAngle=function(D$s,D$r){return 0==D$s?1==D$r?Math.PI/2:-Math.PI/2:0<D$s?Math.atan(D$r/D$s):D$s<0?0<D$r?Math.atan(D$r/D$s)+Math.PI:Math.atan(D$r/D$s)-Math.PI:0},D$K.angleTo=function(D$s,D$r,D$e){D$jr.subtract(D$r,D$s,D$er.TEMPVector30),D$jr.normalize(D$er.TEMPVector30,D$er.TEMPVector30),D$e.elements[0]=Math.asin(D$er.TEMPVector30.y),D$e.elements[1]=D$K.arcTanAngle(-D$er.TEMPVector30.z,-D$er.TEMPVector30.x)},D$K.transformQuat=function(D$s,D$r,D$e){var D$U=D$e.elements,D$m=D$s.elements,D$k=D$r,D$j=D$m[0],D$T=D$m[1],D$Y=D$m[2],D$Z=D$k[0],D$h=D$k[1],D$H=D$k[2],D$A=D$k[3],D$x=D$A*D$j+D$h*D$Y-D$H*D$T,D$B=D$A*D$T+D$H*D$j-D$Z*D$Y,D$$=D$A*D$Y+D$Z*D$T-D$h*D$j,D$l=-D$Z*D$j-D$h*D$T-D$H*D$Y;D$U[0]=D$x*D$A+D$l*-D$Z+D$B*-D$H-D$$*-D$h,D$U[1]=D$B*D$A+D$l*-D$h+D$$*-D$Z-D$x*-D$H,D$U[2]=D$$*D$A+D$l*-D$H+D$x*-D$h-D$B*-D$Z},D$K.quaterionNormalize=function(D$s,D$r){var D$e=D$s[0],D$U=D$s[1],D$m=D$s[2],D$k=D$s[3],D$j=D$e*D$e+D$U*D$U+D$m*D$m+D$k*D$k;0<D$j&&(D$j=1/Math.sqrt(D$j),D$r[0]=D$e*D$j,D$r[1]=D$U*D$j,D$r[2]=D$m*D$j,D$r[3]=D$k*D$j)},D$K.matrix4x4MultiplyFFF=function(D$s,D$r,D$e){var D$U,D$m,D$k,D$j,D$T;if(D$e===D$r)for(D$r=new Float32Array(16),D$U=0;D$U<16;++D$U)D$r[D$U]=D$e[D$U];for(D$U=0;D$U<4;D$U++)D$m=D$s[D$U],D$k=D$s[D$U+4],D$j=D$s[D$U+8],D$T=D$s[D$U+12],D$e[D$U]=D$m*D$r[0]+D$k*D$r[1]+D$j*D$r[2]+D$T*D$r[3],D$e[D$U+4]=D$m*D$r[4]+D$k*D$r[5]+D$j*D$r[6]+D$T*D$r[7],D$e[D$U+8]=D$m*D$r[8]+D$k*D$r[9]+D$j*D$r[10]+D$T*D$r[11],D$e[D$U+12]=D$m*D$r[12]+D$k*D$r[13]+D$j*D$r[14]+D$T*D$r[15]},D$K.matrix4x4MultiplyMFM=function(D$s,D$r,D$e){D$K.matrix4x4MultiplyFFF(D$s.elements,D$r,D$e.elements)},D$H(D$K,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new D$jr},"_tempVector3_1",function(){return this._tempVector3_1=new D$jr},"_tempVector3_2",function(){return this._tempVector3_2=new D$jr},"_tempVector3_3",function(){return this._tempVector3_3=new D$jr},"_tempVector3_4",function(){return this._tempVector3_4=new D$jr},"_tempVector3_5",function(){return this._tempVector3_5=new D$jr},"_tempVector3_6",function(){return this._tempVector3_6=new D$jr},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),D$K}(),D$Vr=function(){function D$O(){}return D$x(D$O,"Laya3D"),D$O._cancelLoadByUrl=function(D$s){D$w.loader.cancelLoadByUrl(D$s),D$O._innerFirstLevelLoaderManager.cancelLoadByUrl(D$s),D$O._innerSecondLevelLoaderManager.cancelLoadByUrl(D$s),D$O._innerThirdLevelLoaderManager.cancelLoadByUrl(D$s),D$O._innerFourthLevelLoaderManager.cancelLoadByUrl(D$s)},D$O._changeWebGLSize=function(D$s,D$r){D$P.onStageResize(D$s,D$r),D$W.clientWidth=D$s,D$W.clientHeight=D$r},D$O.__init__=function(){var D$s=D$r.createMap;D$s.lh=[D$Er,"SPRITE3DHIERARCHY"],D$s.ls=[D$cr,"SPRITE3DHIERARCHY"],D$s.lm=[D$ar,"MESH"],D$s.lmat=[D$Sr,"MATERIAL"],D$s.jpg=[D$Nr,"nativeimage"],D$s.jpeg=[D$Nr,"nativeimage"],D$s.png=[D$Nr,"nativeimage"],D$s.pkm=[D$Nr,"arraybuffer"],D$s.raw=[D$Cr,"arraybuffer"],D$s.mipmaps=[D$Cr,"arraybuffer"],D$V.parserMap.SPRITE3DHIERARCHY=D$O._loadHierarchy,D$V.parserMap.MESH=D$O._loadMesh,D$V.parserMap.MATERIAL=D$O._loadMaterial,D$V.parserMap.TEXTURECUBE=D$O._loadTextureCube,D$V.parserMap.TERRAIN=D$O._loadTerrain,D$O._innerFirstLevelLoaderManager.on("error",null,D$O._eventLoadManagerError),D$O._innerSecondLevelLoaderManager.on("error",null,D$O._eventLoadManagerError),D$O._innerThirdLevelLoaderManager.on("error",null,D$O._eventLoadManagerError),D$O._innerFourthLevelLoaderManager.on("error",null,D$O._eventLoadManagerError)},D$O.READ_BLOCK=function(){return D$O._readData.pos+=4,!0},D$O.READ_DATA=function(){return D$O._DATA.offset=D$O._readData.getUint32(),D$O._DATA.size=D$O._readData.getUint32(),!0},D$O.READ_STRINGS=function(){var D$s=[],D$r={offset:0,size:0};D$r.offset=D$O._readData.getUint16(),D$r.size=D$O._readData.getUint16();D$O._readData.pos;D$O._readData.pos=D$r.offset+D$O._DATA.offset;for(var D$e=0;D$e<D$r.size;D$e++){var D$U=D$O._readData.readUTFString();-1===D$U.lastIndexOf(".lmat")&&-1===D$U.lastIndexOf(".lpbr")||D$s.push(D$U)}return D$s},D$O.formatRelativePath=function(D$s,D$r){var D$e;if("."===D$r.charAt(0)){for(var D$U=(D$s+D$r).split("/"),D$m=0,D$k=D$U.length;D$m<D$k;D$m++)if(".."==D$U[D$m]){var D$j=D$m-1;0<D$j&&".."!==D$U[D$j]&&(D$U.splice(D$j,2),D$m-=2)}D$e=D$U.join("/")}else D$e=D$s+D$r;return null!=D$J.customFormat&&(D$e=D$J.customFormat(D$e,null)),D$e},D$O._eventLoadManagerError=function(D$s){D$w.loader.event("error",D$s)},D$O._addHierarchyInnerUrls=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j=D$O.formatRelativePath(D$U,D$m);D$e&&(D$j+=D$e),D$s.push({url:D$j,clas:D$k}),D$r[D$m]=D$j},D$O._getSprite3DHierarchyInnerUrls=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){var D$T,D$Y=0,D$Z=0;switch(D$s.type){case"Scene":var D$h=D$s.customProps.lightmaps;for(D$Y=0,D$Z=D$h.length;D$Y<D$Z;D$Y++){var D$H=D$h[D$Y].replace(".exr",".png");D$O._addHierarchyInnerUrls(D$U,D$m,D$k,D$j,D$H,D$Nr)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var D$A;if(D$s.instanceParams)(D$A=D$s.instanceParams.loadPath)&&D$O._addHierarchyInnerUrls(D$r,D$m,D$k,D$j,D$A,D$ar);else{(D$A=(D$T=D$s.customProps).meshPath)&&D$O._addHierarchyInnerUrls(D$r,D$m,D$k,D$j,D$A,D$ar);var D$x=D$T.materials;if(D$x)for(D$Y=0,D$Z=D$x.length;D$Y<D$Z;D$Y++){for(var D$B=D$x[D$Y],D$$=D$B.type.split("."),D$l=D$i.window,D$V=0,D$b=D$$.length;D$V<D$b;++D$V){D$l=D$l[this.clasPaths[D$V]]}if("function"!=typeof D$l)throw"_getSprite3DHierarchyInnerUrls 错误: "+D$B.type+" 不是类";D$O._addHierarchyInnerUrls(D$e,D$m,D$k,D$j,D$B.path,D$l)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var D$o=(D$T=D$s.customProps).meshPath;D$o&&D$O._addHierarchyInnerUrls(D$r,D$m,D$k,D$j,D$o,D$ar);var D$I=D$T.material;if(D$I){D$$=D$I.type.split("."),D$l=D$i.window;for(D$V=0,D$b=D$$.length;D$V<D$b;++D$V){D$l=D$l[this.clasPaths[D$V]]}D$O._addHierarchyInnerUrls(D$e,D$m,D$k,D$j,D$I.path,D$l)}else{var D$w=D$T.materialPath;if(D$w)D$O._addHierarchyInnerUrls(D$e,D$m,D$k,D$j,D$w,ShurikenParticleMaterial);else{var D$X=D$T.texturePath;D$X&&D$O._addHierarchyInnerUrls(D$U,D$m,D$k,D$j,D$X,D$Nr)}}break;case"Terrain":D$O._addHierarchyInnerUrls(D$U,D$m,D$k,D$j,D$s.customProps.dataPath,TerrainRes)}var D$D=D$s.components;for(var D$n in D$D){var D$y=D$D[D$n];switch(D$n){case"Animator":var D$g=D$y.avatarPath;if(D$g)D$O._addHierarchyInnerUrls(D$U,D$m,D$k,D$j,D$g,Avatar);else{var D$f=D$y.avatar;D$f&&D$O._addHierarchyInnerUrls(D$U,D$m,D$k,D$j,D$f.path,Avatar)}var D$J=D$y.clipPaths;for(D$Y=0,D$Z=D$J.length;D$Y<D$Z;D$Y++)D$O._addHierarchyInnerUrls(D$U,D$m,D$k,D$j,D$J[D$Y],AnimationClip)}}var D$P=D$s.child;for(D$Y=0,D$Z=D$P.length;D$Y<D$Z;D$Y++)D$O._getSprite3DHierarchyInnerUrls(D$P[D$Y],D$r,D$e,D$U,D$m,D$k,D$j)},D$O._loadHierarchy=function(D$s){D$s.on("loaded",null,D$O._onHierarchylhLoaded,[D$s,D$s._class._getGroup()]),D$s.load(D$s.url,"json",!1,null,!0)},D$O._onHierarchylhLoaded=function(D$s,D$r,D$e){if(D$s._class.destroyed)D$s.endLoad();else{var D$U=D$s.url,D$m=D$lr.getURLVerion(D$U),D$k=D$J.getPath(D$U),D$j=[],D$T=[],D$Y=[],D$Z={};D$O._getSprite3DHierarchyInnerUrls(D$e,D$j,D$T,D$Y,D$Z,D$m,D$k);var D$h=D$j.length+D$T.length+D$Y.length,D$H=D$h+1,D$A=1/D$H;if(D$O._onProcessChange(D$s,0,D$A,1),0<D$Y.length){var D$x=D$h/D$H,D$B=D$f.create(null,D$O._onProcessChange,[D$s,D$A,D$x],!1);D$O._innerFourthLevelLoaderManager.create(D$Y,D$f.create(null,D$O._onHierarchyInnerForthLevResouLoaded,[D$s,D$r,D$B,D$e,D$Z,D$j,D$T,D$A+D$x*D$Y.length,D$x]),D$B,null,null,1,!0,D$r)}else D$O._onHierarchyInnerForthLevResouLoaded(D$s,D$r,null,D$e,D$Z,D$j,D$T,D$A,D$x)}},D$O._onHierarchyInnerForthLevResouLoaded=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){if(D$s._class.destroyed)D$s.endLoad();else if(D$e&&D$e.recover(),0<D$j.length){var D$Z=D$f.create(null,D$O._onProcessChange,[D$s,D$T,D$Y],!1);D$O._innerSecondLevelLoaderManager.create(D$j,D$f.create(null,D$O._onHierarchyInnerSecondLevResouLoaded,[D$s,D$r,D$Z,D$U,D$m,D$k,D$T+D$Y*D$j.length,D$Y]),D$e,null,null,1,!0,D$r)}else D$O._onHierarchyInnerSecondLevResouLoaded(D$s,D$r,null,D$U,D$m,D$k,D$T,D$Y)},D$O._onHierarchyInnerSecondLevResouLoaded=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T){if(D$s._class.destroyed)D$s.endLoad();else if(D$e&&D$e.recover(),0<D$k.length){var D$Y=D$f.create(null,D$O._onProcessChange,[D$s,D$j,D$T],!1);D$O._innerFirstLevelLoaderManager.create(D$k,D$f.create(null,D$O._onHierarchyInnerFirstLevResouLoaded,[D$s,D$Y,D$U,D$m]),D$e,null,null,1,!0,D$r)}else D$O._onHierarchyInnerFirstLevResouLoaded(D$s,null,D$U,D$m)},D$O._onHierarchyInnerFirstLevResouLoaded=function(D$s,D$r,D$e,D$U){D$r&&D$r.recover(),D$s.endLoad([D$e,D$U])},D$O._loadTerrain=function(D$s){D$s.on("loaded",null,D$O._onTerrainLtLoaded,[D$s,D$s._class._getGroup()]),D$s.load(D$s.url,"json",!1,null,!0)},D$O._onTerrainLtLoaded=function(D$s,D$r,D$e){if(D$s._class.destroyed)D$s.endLoad();else{var D$U,D$m,D$k=D$s.url,D$j=D$lr.getURLVerion(D$k),D$T=D$J.getPath(D$k),D$Y=[],D$Z={},D$h=0,D$H=0,D$A=D$e.heightData;D$U=D$A.url,D$m=D$O.formatRelativePath(D$T,D$U),D$j&&(D$m+=D$j),D$U=D$Z[D$U]=D$m;var D$x=D$e.detailTexture;for(D$h=0,D$H=D$x.length;D$h<D$H;D$h++)D$Y.push({url:D$x[D$h].diffuse});var D$B=D$e.normalMap;for(D$h=0,D$H=D$B.length;D$h<D$H;D$h++)D$Y.push({url:D$B[D$h]});var D$$=D$e.alphaMap;for(D$h=0,D$H=D$$.length;D$h<D$H;D$h++)D$Y.push({url:D$$[D$h],params:[!1,!1,6408,!0]});for(D$h=0,D$H=D$Y.length;D$h<D$H;D$h++){var D$l=D$Y[D$h].url;D$m=D$O.formatRelativePath(D$T,D$l),D$j&&(D$m+=D$j),D$Y[D$h].url=D$m,D$Z[D$l]=D$m}var D$V=D$Y.length,D$b=D$V+2,D$o=1/D$b;D$O._onProcessChange(D$s,0,D$o,1);var D$I={heightMapLoaded:!1,texturesLoaded:!1},D$w=D$f.create(null,D$O._onProcessChange,[D$s,D$o,D$o],!1);D$O._innerFourthLevelLoaderManager.create(D$U,D$f.create(null,D$O._onTerrainHeightMapLoaded,[D$s,D$w,D$e,D$Z,D$I]),D$w,null,[D$A.numX,D$A.numZ,D$A.bitType,D$A.value],1,!0,D$r);var D$X=D$f.create(null,D$O._onProcessChange,[D$s,2*D$o,D$V/D$b],!1);D$O._innerFourthLevelLoaderManager.create(D$Y,D$f.create(null,D$O._onTerrainTexturesLoaded,[D$s,D$X,D$e,D$Z,D$I]),D$X,null,null,1,!0,D$r)}},D$O._onTerrainHeightMapLoaded=function(D$s,D$r,D$e,D$U,D$m){D$m.heightMapLoaded=!0,D$m.texturesLoaded&&(D$s.endLoad([D$e,D$U]),D$r.recover())},D$O._onTerrainTexturesLoaded=function(D$s,D$r,D$e,D$U,D$m){D$m.texturesLoaded=!0,D$m.heightMapLoaded&&(D$s.endLoad([D$e,D$U]),D$r.recover())},D$O._loadMesh=function(D$s){D$s.on("loaded",null,D$O._onMeshLmLoaded,[D$s,D$s._class._getGroup()]),D$s.load(D$s.url,"arraybuffer",!1,null,!0)},D$O._onMeshLmLoaded=function(D$s,D$r,D$e){if(D$s._class.destroyed)D$s.endLoad();else{var D$U,D$m,D$k,D$j=D$s.url,D$T=D$lr.getURLVerion(D$j),D$Y=D$J.getPath(D$j),D$Z={},D$h=0,D$H=0;switch((D$O._readData=new D$X(D$e)).pos=0,D$O._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var D$A=D$O._readData.getUint32();D$O._readData.pos=D$O._readData.pos+4,D$H=D$O._readData.getUint16(),D$O._readData.pos=D$O._readData.pos+8*D$H;var D$x=D$O._readData.getUint32();for(D$H=D$O._readData.getUint16(),D$O._readData.pos=D$A+D$x,D$U=[],D$h=0;D$h<D$H;D$h++){var D$B=D$O._readData.readUTFString();-1!==D$B.lastIndexOf(".lmat")&&D$U.push(D$B)}break;default:for(D$O.READ_BLOCK(),D$h=0;D$h<2;D$h++){var D$$=D$O._readData.getUint16(),D$l=D$O._strings[D$$],D$V=D$O["READ_"+D$l];if(null==D$V)throw new Error("model file err,no this function:"+D$$+" "+D$l);1===D$h?D$U=D$V.call():D$V.call()}}for(D$h=0,D$k=D$U.length;D$h<D$k;D$h++){var D$b=D$U[D$h];D$m=D$O.formatRelativePath(D$Y,D$b),D$T&&(D$m+=D$T),D$U[D$h]=D$m,D$Z[D$b]=D$m}if(0<D$U.length){D$O._onProcessChange(D$s,0,.5,1);var D$o=D$f.create(null,D$O._onProcessChange,[D$s,.5,.5],!1);D$O._innerSecondLevelLoaderManager.create(D$U,D$f.create(null,D$O._onMeshMateialLoaded,[D$s,D$o,D$e,D$Z]),D$o,null,null,1,!0,D$r)}else D$s.endLoad([D$e,D$Z])}},D$O._onMeshMateialLoaded=function(D$s,D$r,D$e,D$U){D$s.endLoad([D$e,D$U]),D$r.recover()},D$O._getMaterialTexturePath=function(D$s,D$r,D$e){var D$U=D$s.length-4;return D$s.indexOf(".dds")!=D$U&&D$s.indexOf(".tga")!=D$U&&D$s.indexOf(".exr")!=D$U&&D$s.indexOf(".DDS")!=D$U&&D$s.indexOf(".TGA")!=D$U&&D$s.indexOf(".EXR")!=D$U||(D$s=D$s.substr(0,D$U)+".png"),D$s=D$O.formatRelativePath(D$e,D$s),D$r&&(D$s+=D$r),D$s},D$O._loadMaterial=function(D$s){D$s.on("loaded",null,D$O._onMaterilLmatLoaded,[D$s,D$s._class._getGroup()]),D$s.load(D$s.url,"json",!1,null,!0)},D$O._onMaterilLmatLoaded=function(D$s,D$r,D$e){if(D$s._class.destroyed)D$s.endLoad();else{var D$U,D$m=D$s.url,D$k=D$lr.getURLVerion(D$m),D$j=D$J.getPath(D$m),D$T=[],D$Y={},D$Z=D$e.customProps,D$h=D$e.version;if(D$h)switch(D$h){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var D$H=D$e.props.textures,D$A=0,D$x=D$H.length;D$A<D$x;D$A++){var D$B=D$H[D$A],D$$=D$B.path;if(D$$){var D$l=D$$.length-4;D$$.indexOf(".exr")!=D$l&&D$$.indexOf(".EXR")!=D$l||(D$$=D$$.substr(0,D$l)+".png"),D$U=D$O.formatRelativePath(D$j,D$$),D$k&&(D$U+=D$k),D$T.push({url:D$U,params:D$B.params}),D$Y[D$$]=D$U}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var D$V=D$Z.diffuseTexture.texture2D;if(D$V&&(D$U=D$O._getMaterialTexturePath(D$V,D$k,D$j),D$T.push(D$U),D$Y[D$V]=D$U),D$Z.normalTexture){var D$b=D$Z.normalTexture.texture2D;D$b&&(D$U=D$O._getMaterialTexturePath(D$b,D$k,D$j),D$T.push(D$U),D$Y[D$b]=D$U)}if(D$Z.specularTexture){var D$o=D$Z.specularTexture.texture2D;D$o&&(D$U=D$O._getMaterialTexturePath(D$o,D$k,D$j),D$T.push(D$U),D$Y[D$o]=D$U)}if(D$Z.emissiveTexture){var D$I=D$Z.emissiveTexture.texture2D;D$I&&(D$U=D$O._getMaterialTexturePath(D$I,D$k,D$j),D$T.push(D$U),D$Y[D$I]=D$U)}if(D$Z.ambientTexture){var D$w=D$Z.ambientTexture.texture2D;D$w&&(D$U=D$O._getMaterialTexturePath(D$w,D$k,D$j),D$T.push(D$U),D$Y[D$w]=D$U)}if(D$Z.reflectTexture){var D$X=D$Z.reflectTexture.texture2D;D$X&&(D$U=D$O._getMaterialTexturePath(D$X,D$k,D$j),D$T.push(D$U),D$Y[D$X]=D$U)}}var D$D=D$T.length,D$n=D$D+1,D$y=1/D$n;if(D$O._onProcessChange(D$s,0,D$y,1),0<D$D){var D$g=D$f.create(null,D$O._onProcessChange,[D$s,D$y,D$D/D$n],!1);D$O._innerFourthLevelLoaderManager.create(D$T,D$f.create(null,D$O._onMateialTexturesLoaded,[D$s,D$g,D$e,D$Y]),D$g,D$Nr,null,1,!0,D$r)}else D$O._onMateialTexturesLoaded(D$s,null,D$e,null)}},D$O._onMateialTexturesLoaded=function(D$s,D$r,D$e,D$U){D$s.endLoad([D$e,D$U]),D$r&&D$r.recover()},D$O._loadTextureCube=function(D$s){D$s.on("loaded",null,D$O._onTextureCubeLtcLoaded,[D$s]),D$s.load(D$s.url,"json",!1,null,!0)},D$O._onTextureCubeLtcLoaded=function(D$s,D$r){if(D$s._class.destroyed)D$s.endLoad();else{var D$e=D$J.getPath(D$s.url),D$U=[D$O.formatRelativePath(D$e,D$r.px),D$O.formatRelativePath(D$e,D$r.nx),D$O.formatRelativePath(D$e,D$r.py),D$O.formatRelativePath(D$e,D$r.ny),D$O.formatRelativePath(D$e,D$r.pz),D$O.formatRelativePath(D$e,D$r.nz)];D$O._onProcessChange(D$s,0,1/7,1);var D$m=D$f.create(null,D$O._onProcessChange,[D$s,1/7,6/7],!1);D$O._innerFourthLevelLoaderManager.load(D$U,D$f.create(null,D$O._onTextureCubeImagesLoaded,[D$s,D$U,D$m]),D$m,"nativeimage")}},D$O._onTextureCubeImagesLoaded=function(D$s,D$r,D$e){var D$U=[];D$U.length=6;for(var D$m=0;D$m<6;D$m++){var D$k=D$r[D$m];D$U[D$m]=D$V.getRes(D$k),D$V.clearRes(D$k)}D$s.endLoad(D$U),D$e.recover()},D$O._onProcessChange=function(D$s,D$r,D$e,D$U){(D$U=D$r+D$U*D$e)<1&&D$s.event("progress",D$U)},D$O.init=function(D$s,D$r,D$e,D$U,D$m,D$k){if(void 0===D$e&&(D$e=!1),void 0===D$U&&(D$U=!1),void 0===D$m&&(D$m=!0),void 0===D$k&&(D$k=!0),D$b.update3DLoop=function(){},D$b.cancelLoadByUrl=function(D$s){D$O._cancelLoadByUrl(D$s)},D$Y.isAntialias=D$e,D$Y.isAlpha=D$U,D$Y.premultipliedAlpha=D$m,D$Y.isStencil=D$k,!D$P.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");D$b.changeWebGLSize=D$O._changeWebGLSize,D$$.is3DMode=!0,D$w.init(D$s,D$r),D$K.__init__(),D$Hr.__init__(),D$tr.__init__(),D$R.__init__(),D$O.__init__(),D$j.maxTextureCount=2,(D$O.debugMode||D$L.debugMode)&&(D$O._debugPhasorSprite=new D$G)},D$O.HIERARCHY="SPRITE3DHIERARCHY",D$O.MESH="MESH",D$O.MATERIAL="MATERIAL",D$O.PBRMATERIAL="PBRMTL",D$O.TEXTURECUBE="TEXTURECUBE",D$O.TERRAIN="TERRAIN",D$O._readData=null,D$O._debugPhasorSprite=null,D$O.debugMode=!1,D$H(D$O,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new D$r},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new D$r},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new D$r},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new D$r}]),D$O}(),D$br=function(D$s){function D$m(D$s){D$m.__super.call(this),this._owner=D$s,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}D$x(D$m,"laya.d3.animation.AnimationTransform3D",D$k);var D$r=D$m.prototype;return D$r._getlocalMatrix=function(){return this._localUpdate&&(D$lr._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},D$r._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._onWorldTransform()}},D$r._setWorldMatrixAndUpdate=function(D$s){if(this._worldMatrix=D$s,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var D$r=this._getlocalMatrix(),D$e=0;D$e<16;++D$e)this._worldMatrix[D$e]=D$r[D$e];else D$lr.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},D$r._setWorldMatrixNoUpdate=function(D$s){this._worldMatrix=D$s},D$r._setWorldMatrixIgnoreUpdate=function(D$s){this._worldMatrix=D$s,this._worldUpdate=!1},D$r.getLocalPosition=function(){return this._localPosition},D$r.setLocalPosition=function(D$s){if(this._parent)this._localPosition=D$s,this._localUpdate=!0,this._onWorldTransform();else{var D$r=this._entity.owner._transform,D$e=this._entity.localPosition,D$U=D$e.elements;D$U[0]=D$s[0],D$U[1]=D$s[1],D$U[2]=D$s[2],D$r.localPosition=D$e}},D$r.getLocalRotation=function(){if(this._localQuaternionUpdate){var D$s=this._localRotationEuler;D$lr._quaternionCreateFromYawPitchRollArray(D$s[1]/D$m._angleToRandin,D$s[0]/D$m._angleToRandin,D$s[2]/D$m._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},D$r.setLocalRotation=function(D$s){if(this._parent)this._localRotation=D$s,D$lr.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var D$r=this._entity.owner._transform,D$e=this._entity.localRotation,D$U=D$e.elements;D$U[0]=D$s[0],D$U[1]=D$s[1],D$U[2]=D$s[2],D$U[3]=D$s[3],D$r.localRotation=D$e}},D$r.getLocalScale=function(){return this._localScale},D$r.setLocalScale=function(D$s){if(this._parent)this._localScale=D$s,this._localUpdate=!0,this._onWorldTransform();else{var D$r=this._entity.owner._transform,D$e=this._entity.localScale,D$U=D$e.elements;D$U[0]=D$s[0],D$U[1]=D$s[1],D$U[2]=D$s[2],D$r.localScale=D$e}},D$r.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){D$lr.getYawPitchRoll(this._localRotation,D$m._tempVector3);var D$s=D$m._tempVector3,D$r=this._localRotationEuler;D$r[0]=D$s[1]*D$m._angleToRandin,D$r[1]=D$s[0]*D$m._angleToRandin,D$r[2]=D$s[2]*D$m._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},D$r.setLocalRotationEuler=function(D$s){if(this._parent)D$lr._quaternionCreateFromYawPitchRollArray(D$s[1]/D$m._angleToRandin,D$s[0]/D$m._angleToRandin,D$s[2]/D$m._angleToRandin,this._localRotation),this._localRotationEuler=D$s,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var D$r=this._entity.owner._transform,D$e=this._entity.localRotationEuler,D$U=D$e.elements;D$U[0]=D$s[0],D$U[1]=D$s[1],D$U[2]=D$s[2],D$r.localRotationEuler=D$e}},D$r.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)D$lr.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var D$s=this._getlocalMatrix(),D$r=0;D$r<16;++D$r)this._worldMatrix[D$r]=D$s[D$r];this._worldUpdate=!1}return this._worldMatrix},D$r.setParent=function(D$s){if(this._parent!==D$s){if(this._parent){var D$r=this._parent._childs,D$e=D$r.indexOf(this);D$r.splice(D$e,1)}D$s&&(D$s._childs.push(this),D$s&&this._onWorldTransform()),this._parent=D$s}},D$H(D$m,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),D$m}(),D$or=function(D$s){function D$r(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,D$r.__super.call(this),this._destroyed=!1,this._id=D$r._uniqueIDCounter,D$r._uniqueIDCounter++}D$x(D$r,"laya.d3.component.Component3D",D$k);var D$e=D$r.prototype;return D$w.imps(D$e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),D$e._initialize=function(D$s){this._owner=D$s,this._enable=!0,this.started=!1,this._load(D$s)},D$e._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},D$e._load=function(D$s){},D$e._start=function(D$s){},D$e._update=function(D$s){},D$e._lateUpdate=function(D$s){},D$e._preRenderUpdate=function(D$s){},D$e._postRenderUpdate=function(D$s){},D$e._unload=function(D$s){this.offAll()},D$e._cloneTo=function(D$s){},D$B(0,D$e,"id",function(){return this._id}),D$B(0,D$e,"destroyed",function(){return this._destroyed}),D$B(0,D$e,"owner",function(){return this._owner}),D$B(0,D$e,"enable",function(){return this._enable},function(D$s){this._enable!==D$s&&(this._enable=D$s,this.event("enablechanged",this._enable))}),D$B(0,D$e,"isSingleton",function(){return D$r._isSingleton}),D$r._isSingleton=!0,D$r._uniqueIDCounter=1,D$r}(),D$Ir=function(D$s){function D$r(){this._destroyed=!1,D$r.__super.call(this),this._destroyed=!1}D$x(D$r,"laya.d3.core.GeometryFilter",D$k);var D$e=D$r.prototype;return D$w.imps(D$e,{"laya.resource.IDestroy":!0}),D$e._destroy=function(){this.offAll(),this._destroyed=!0},D$B(0,D$e,"_isAsyncLoaded",function(){return!0}),D$B(0,D$e,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),D$B(0,D$e,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),D$B(0,D$e,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),D$B(0,D$e,"destroyed",function(){return this._destroyed}),D$r}(),D$wr=function(D$s){function D$U(D$s){D$U.__super.call(this),this._id=++D$U._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new D$Ls(new D$jr,new D$jr),this._boundingBoxCenter=new D$jr,this._boundingSphere=new D$Ms(new D$jr,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=D$s,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}D$x(D$U,"laya.d3.core.render.BaseRender",D$k);var D$r=D$U.prototype;return D$w.imps(D$r,{"laya.resource.IDestroy":!0}),D$r._changeMaterialReference=function(D$s,D$r){D$s&&D$s._removeReference(),D$r._addReference()},D$r._getInstanceMaterial=function(D$s,D$r){var D$e=new D$s.constructor;return D$s.cloneTo(D$e),D$e.name=D$e.name+"(Instance)",this._materialsInstance[D$r]=!0,this._changeMaterialReference(this._materials[D$r],D$e),this._materials[D$r]=D$e},D$r._setShaderValuelightMap=function(D$s){this._setShaderValueTexture(3,D$s)},D$r._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},D$r._renderRenderableBoundBox=function(){var D$s=D$Vr._debugPhasorSprite,D$r=this.boundingBox,D$e=D$U._tempBoundBoxCorners;D$r.getCorners(D$e),D$s.line(D$e[0],D$U._greenColor,D$e[1],D$U._greenColor),D$s.line(D$e[2],D$U._greenColor,D$e[3],D$U._greenColor),D$s.line(D$e[4],D$U._greenColor,D$e[5],D$U._greenColor),D$s.line(D$e[6],D$U._greenColor,D$e[7],D$U._greenColor),D$s.line(D$e[0],D$U._greenColor,D$e[3],D$U._greenColor),D$s.line(D$e[1],D$U._greenColor,D$e[2],D$U._greenColor),D$s.line(D$e[2],D$U._greenColor,D$e[6],D$U._greenColor),D$s.line(D$e[3],D$U._greenColor,D$e[7],D$U._greenColor),D$s.line(D$e[0],D$U._greenColor,D$e[4],D$U._greenColor),D$s.line(D$e[1],D$U._greenColor,D$e[5],D$U._greenColor),D$s.line(D$e[4],D$U._greenColor,D$e[7],D$U._greenColor),D$s.line(D$e[5],D$U._greenColor,D$e[6],D$U._greenColor)},D$r._calculateBoundingSphere=function(){throw"BaseRender: must override it."},D$r._calculateBoundingBox=function(){throw"BaseRender: must override it."},D$r._setShaderValueTexture=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r)},D$r._setShaderValueMatrix4x4=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r?D$r.elements:null)},D$r._setShaderValueColor=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r?D$r.elements:null)},D$r._setShaderValueBuffer=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r)},D$r._setShaderValueInt=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r)},D$r._setShaderValueBool=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r)},D$r._setShaderValueNumber=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r)},D$r._setShaderValueVector2=function(D$s,D$r){this._owner._shaderValues.setValue(D$s,D$r?D$r.elements:null)},D$r._addShaderDefine=function(D$s){this._owner._shaderDefineValue|=D$s},D$r._removeShaderDefine=function(D$s){this._owner._shaderDefineValue&=~D$s},D$r._renderUpdate=function(D$s){return!0},D$r._applyLightMapParams=function(){if(0<=this._lightmapIndex){var D$s=this._owner.scene;if(D$s){var D$r=D$s.getlightmaps()[this._lightmapIndex];D$r?(this._addShaderDefine(D$Gr.SAHDERDEFINE_LIGHTMAP),D$r.loaded?this._setShaderValuelightMap(D$r):D$r.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(D$Gr.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(D$Gr.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(D$Gr.SAHDERDEFINE_LIGHTMAP)},D$r._updateOctreeNode=function(){var D$s=this._treeNode;D$s&&this._octreeNodeNeedChange&&(D$s.updateObject(this),this._octreeNodeNeedChange=!1)},D$r._destroy=function(){this.offAll();var D$s=0,D$r=0;for(D$s=0,D$r=this._renderElements.length;D$s<D$r;D$s++)this._renderElements[D$s]._destroy();for(D$s=0,D$r=this._materials.length;D$s<D$r;D$s++)this._materials[D$s]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},D$B(0,D$r,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),D$B(0,D$r,"id",function(){return this._id}),D$B(0,D$r,"material",function(){var D$s=this._materials[0];if(D$s&&!this._materialsInstance[0]){var D$r=this._getInstanceMaterial(D$s,0);this.event("materialchanged",[this,0,D$r])}return this._materials[0]},function(D$s){this.sharedMaterial=D$s}),D$B(0,D$r,"sharedMaterial",function(){return this._materials[0]},function(D$s){var D$r=this._materials[0];D$r!==D$s&&(this._materials[0]=D$s,this._materialsInstance[0]=!1,this._changeMaterialReference(D$r,D$s),this.event("materialchanged",[this,0,D$s]))}),D$B(0,D$r,"lightmapIndex",function(){return this._lightmapIndex},function(D$s){this._lightmapIndex=D$s,this._applyLightMapParams()}),D$B(0,D$r,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(D$s){this._lightmapScaleOffset=D$s,this._setShaderValueColor(2,D$s),this._addShaderDefine(D$Gr.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),D$B(0,D$r,"enable",function(){return this._enable},function(D$s){this._enable=D$s,this.event("enablechanged",[this,D$s])}),D$B(0,D$r,"materials",function(){for(var D$s=0,D$r=this._materials.length;D$s<D$r;D$s++)if(!this._materialsInstance[D$s]){var D$e=this._getInstanceMaterial(this._materials[D$s],D$s);this.event("materialchanged",[this,D$s,D$e])}return this._materials.slice()},function(D$s){this.sharedMaterials=D$s}),D$B(0,D$r,"sharedMaterials",function(){return this._materials.slice()},function(D$s){if(!D$s)throw new Error("MeshRender: shadredMaterials value can't be null.");var D$r=D$s.length;this._materialsInstance.length=D$r;for(var D$e=0;D$e<D$r;D$e++){var D$U=this._materials[D$e];D$U!==D$s[D$e]&&(this._materialsInstance[D$e]=!1,this._changeMaterialReference(D$U,D$s[D$e]),this.event("materialchanged",[this,D$e,D$s[D$e]]))}this._materials=D$s}),D$B(0,D$r,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),D$B(0,D$r,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var D$s=this.boundingBox;D$jr.add(D$s.min,D$s.max,this._boundingBoxCenter),D$jr.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),D$B(0,D$r,"receiveShadow",function(){return this._receiveShadow},function(D$s){this._receiveShadow!==D$s&&((this._receiveShadow=D$s)?this._addShaderDefine(D$xr.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(D$xr.SHADERDEFINE_RECEIVE_SHADOW))}),D$B(0,D$r,"destroyed",function(){return this._destroyed}),D$U._uniqueIDCounter=0,D$H(D$U,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr,new D$jr]},"_greenColor",function(){return this._greenColor=new D$Tr(0,1,0,1)}]),D$U}(),D$Xr=function(D$s){function D$T(D$s){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,D$T.__super.call(this),this._localPosition=new D$jr,this._localRotation=new D$er(0,0,0,1),this._localScale=new D$jr(1,1,1),this._localRotationEuler=new D$jr,this._localMatrix=new D$sr,this._position=new D$jr,this._rotation=new D$er(0,0,0,1),this._scale=new D$jr(1,1,1),this._worldMatrix=new D$sr,this._forward=new D$jr,this._up=new D$jr,this._right=new D$jr,this._owner=D$s,this._childs=[]}D$x(D$T,"laya.d3.core.Transform3D",D$k);var D$r=D$T.prototype;return D$r._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)D$sr.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var D$s=D$T._tempVector30;D$jr.multiply(this.pivot,this._localScale,D$s);var D$r=D$T._tempVector31;D$jr.subtract(D$s,this.pivot,D$r);var D$e=D$T._tempVector32,D$U=this.localRotation;D$jr.transformQuat(D$s,D$U,D$e),D$jr.subtract(D$e,D$s,D$e);var D$m=D$T._tempVector33;D$jr.subtract(this._localPosition,D$r,D$m),D$jr.subtract(D$m,D$e,D$m),D$sr.createAffineTransformation(D$m,D$U,this._localScale,this._localMatrix)}},D$r._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._onWorldPositionRotationTransform()}},D$r._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._onWorldPositionScaleTransform()}},D$r._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._onWorldPositionTransform()}},D$r._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._onWorldPositionRotationTransform()}},D$r._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._onWorldPositionScaleTransform()}},D$r._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._onWorldTransform()}},D$r.translate=function(D$s,D$r){void 0===D$r&&(D$r=!0),D$r?(D$sr.createFromQuaternion(this.localRotation,D$T._tempMatrix0),D$jr.transformCoordinate(D$s,D$T._tempMatrix0,D$T._tempVector30),D$jr.add(this.localPosition,D$T._tempVector30,this._localPosition),this.localPosition=this._localPosition):(D$jr.add(this.position,D$s,this._position),this.position=this._position)},D$r.rotate=function(D$s,D$r,D$e){var D$U;void 0===D$r&&(D$r=!0),void 0===D$e&&(D$e=!0),D$U=D$e?D$s:(D$jr.scale(D$s,Math.PI/180,D$T._tempVector30),D$T._tempVector30),D$er.createFromYawPitchRoll(D$U.y,D$U.x,D$U.z,D$T._tempQuaternion0),D$r?(D$er.multiply(this._localRotation,D$T._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(D$er.multiply(D$T._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},D$r.lookAt=function(D$s,D$r,D$e){void 0===D$e&&(D$e=!1);var D$U,D$m=D$s.elements;if(D$e){if(D$U=this._localPosition.elements,Math.abs(D$U[0]-D$m[0])<D$_s.zeroTolerance&&Math.abs(D$U[1]-D$m[1])<D$_s.zeroTolerance&&Math.abs(D$U[2]-D$m[2])<D$_s.zeroTolerance)return;D$er.lookAt(this._localPosition,D$s,D$r,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var D$k=this.position;if(D$U=D$k.elements,Math.abs(D$U[0]-D$m[0])<D$_s.zeroTolerance&&Math.abs(D$U[1]-D$m[1])<D$_s.zeroTolerance&&Math.abs(D$U[2]-D$m[2])<D$_s.zeroTolerance)return;D$er.lookAt(D$k,D$s,D$r,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},D$B(0,D$r,"_isFrontFaceInvert",function(){var D$s=this.scale,D$r=D$s.x<0;return D$s.y<0&&(D$r=!D$r),D$s.z<0&&(D$r=!D$r),D$r}),D$B(0,D$r,"owner",function(){return this._owner}),D$B(0,D$r,"localRotation",function(){if(this._localQuaternionUpdate){var D$s=this._localRotationEuler.elements;D$er.createFromYawPitchRoll(D$s[1]/D$T._angleToRandin,D$s[0]/D$T._angleToRandin,D$s[2]/D$T._angleToRandin,this._localRotation)}return this._localRotation},function(D$s){this._localRotation=D$s,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),D$B(0,D$r,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?D$sr.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(D$s){null===this._parent?D$s.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),D$sr.multiply(this._localMatrix,D$s,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=D$s,this._worldUpdate=!1}),D$B(0,D$r,"worldNeedUpdate",function(){return this._worldUpdate}),D$B(0,D$r,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(D$s){this._localMatrix=D$s,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),D$B(0,D$r,"dummy",function(){return this._dummy},function(D$s){this._dummy!==D$s&&(this._dummy&&(this._dummy._entity=null),D$s&&(D$s._entity=this),this._dummy=D$s)}),D$B(0,D$r,"localPosition",function(){return this._localPosition},function(D$s){this._localPosition=D$s,this._localUpdate=!0,this._onWorldPositionTransform()}),D$B(0,D$r,"position",function(){if(this._positionUpdate){if(null!=this._parent){var D$s=this._parent.position;D$jr.multiply(this._localPosition,this._parent.scale,D$T._tempVector30),D$jr.transformQuat(D$T._tempVector30,this._parent.rotation,D$T._tempVector30),D$jr.add(D$s,D$T._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(D$s){if(null!=this._parent){D$jr.subtract(D$s,this._parent.position,this._localPosition);var D$r=this._parent.scale.elements,D$e=D$r[0],D$U=D$r[1],D$m=D$r[2];if(1!==D$e||1!==D$U||1!==D$m){var D$k=D$T._tempVector30,D$j=D$k.elements;D$j[0]=1/D$e,D$j[1]=1/D$U,D$j[2]=1/D$m,D$jr.multiply(this._localPosition,D$k,this._localPosition)}this._parent.rotation.invert(D$T._tempQuaternion0),D$jr.transformQuat(this._localPosition,D$T._tempQuaternion0,this._localPosition)}else D$s.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=D$s,this._positionUpdate=!1}),D$B(0,D$r,"localScale",function(){return this._localScale},function(D$s){this._localScale=D$s,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),D$B(0,D$r,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(D$T._tempVector30);var D$s=D$T._tempVector30.elements,D$r=this._localRotationEuler.elements;D$r[0]=D$s[1]*D$T._angleToRandin,D$r[1]=D$s[0]*D$T._angleToRandin,D$r[2]=D$s[2]*D$T._angleToRandin}return this._localRotationEuler},function(D$s){this._localRotationEuler=D$s,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),D$B(0,D$r,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?D$er.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(D$s){null!=this._parent?(this._parent.rotation.invert(D$T._tempQuaternion0),D$er.multiply(D$s,D$T._tempQuaternion0,this._localRotation)):D$s.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=D$s,this._rotationUpdate=!1}),D$B(0,D$r,"scale",function(){return this._scaleUpdate&&(null!==this._parent?D$jr.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(D$s){if(null!==this._parent){var D$r=this._parent.scale.elements,D$e=D$T._tempVector30.elements;D$e[0]=1/D$r[0],D$e[1]=1/D$r[1],D$e[2]=1/D$r[2],D$jr.multiply(D$s,D$T._tempVector30,this._localScale)}else D$s.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=D$s,this._scaleUpdate=!1}),D$B(0,D$r,"rotationEuler",null,function(D$s){D$er.createFromYawPitchRoll(D$s.y,D$s.x,D$s.z,this._rotation),this.rotation=this._rotation}),D$B(0,D$r,"forward",function(){var D$s=this.worldMatrix.elements;return this._forward.elements[0]=-D$s[8],this._forward.elements[1]=-D$s[9],this._forward.elements[2]=-D$s[10],this._forward}),D$B(0,D$r,"up",function(){var D$s=this.worldMatrix.elements;return this._up.elements[0]=D$s[4],this._up.elements[1]=D$s[5],this._up.elements[2]=D$s[6],this._up}),D$B(0,D$r,"right",function(){var D$s=this.worldMatrix.elements;return this._right.elements[0]=D$s[0],this._right.elements[1]=D$s[1],this._right.elements[2]=D$s[2],this._right}),D$B(0,D$r,"parent",function(){return this._parent},function(D$s){if(this._parent!==D$s){if(this._parent){var D$r=this._parent._childs,D$e=D$r.indexOf(this);D$r.splice(D$e,1)}D$s&&(D$s._childs.push(this),D$s&&this._onWorldTransform()),this._parent=D$s}}),D$H(D$T,["_tempVector30",function(){return this._tempVector30=new D$jr},"_tempVector31",function(){return this._tempVector31=new D$jr},"_tempVector32",function(){return this._tempVector32=new D$jr},"_tempVector33",function(){return this._tempVector33=new D$jr},"_tempQuaternion0",function(){return this._tempQuaternion0=new D$er},"_tempMatrix0",function(){return this._tempMatrix0=new D$sr},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),D$T}(),D$Dr=(function(D$s){function D$r(){this._rotation=0,this._matNeedUpdte=!1,D$r.__super.call(this),this._matrix=new D$sr,this._offset=new D$kr,this._tiling=new D$kr(1,1)}D$x(D$r,"laya.d3.core.TransformUV",D$k);var D$e=D$r.prototype;D$w.imps(D$e,{"laya.d3.core.IClone":!0}),D$e._updateMatrix=function(){D$r._tempOffsetV3.elements[0]=this._offset.x,D$r._tempOffsetV3.elements[1]=this._offset.y,D$er.createFromYawPitchRoll(0,0,this._rotation,D$r._tempRotationQua),D$r._tempTitlingV3.elements[0]=this._tiling.x,D$r._tempTitlingV3.elements[1]=this._tiling.y,D$sr.createAffineTransformation(D$r._tempOffsetV3,D$r._tempRotationQua,D$r._tempTitlingV3,this._matrix)},D$e.cloneTo=function(D$s){D$s._matrix=this._matrix.clone(),D$s._offset=this._offset.clone(),D$s._rotation=this._rotation,D$s._tiling=this._tiling.clone()},D$e.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$e,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),D$B(0,D$e,"tiling",function(){return this._tiling},function(D$s){this._tiling=D$s,this._matNeedUpdte=!0}),D$B(0,D$e,"offset",function(){return this._offset},function(D$s){this._offset=D$s,this._matNeedUpdte=!0}),D$B(0,D$e,"rotation",function(){return this._rotation},function(D$s){this._rotation=D$s,this._matNeedUpdte=!0}),D$H(D$r,["_tempOffsetV3",function(){return this._tempOffsetV3=new D$jr(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new D$er},"_tempTitlingV3",function(){return this._tempTitlingV3=new D$jr(1,1,1)}])}(),function(D$e){function D$s(){this.x=NaN,this.y=NaN,this.z=NaN,D$s.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}D$x(D$s,"laya.d3.core.particleShuriKen.module.shape.BoxShape",D$e);var D$r=D$s.prototype;D$r._getShapeBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=.5*-this.x,D$r[1]=.5*-this.y,D$r[2]=.5*-this.z;var D$e=D$s.max.elements;D$e[0]=.5*this.x,D$e[1]=.5*this.y,D$e[2]=.5*this.z},D$r._getSpeedBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=0,D$r[1]=0,D$r[2]=0;var D$e=D$s.max.elements;D$e[0]=0,D$e[1]=1,D$e[2]=0},D$r.generatePositionAndDirection=function(D$s,D$r,D$e,D$U){var D$m=D$s.elements,D$k=D$r.elements;D$e?(D$e.seed=D$U[16],D$N._randomPointInsideHalfUnitBox(D$s,D$e),D$U[16]=D$e.seed):D$N._randomPointInsideHalfUnitBox(D$s),D$m[0]=this.x*D$m[0],D$m[1]=this.y*D$m[1],D$m[2]=this.z*D$m[2],this.randomDirection?D$e?(D$e.seed=D$U[17],D$N._randomPointUnitSphere(D$r,D$e),D$U[17]=D$e.seed):D$N._randomPointUnitSphere(D$r):(D$k[0]=0,D$k[1]=0,D$k[2]=1)},D$r.cloneTo=function(D$s){D$e.prototype.cloneTo.call(this,D$s);var D$r=D$s;D$r.x=this.x,D$r.y=this.y,D$r.z=this.z,D$r.randomDirection=this.randomDirection}}(D$Q),function(D$e){function D$j(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,D$j.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}D$x(D$j,"laya.d3.core.particleShuriKen.module.shape.CircleShape",D$e);var D$s=D$j.prototype;D$s._getShapeBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=D$r[2]=-this.radius,D$r[1]=0;var D$e=D$s.max.elements;D$e[0]=D$e[2]=this.radius,D$e[1]=0},D$s._getSpeedBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=D$r[1]=-1,D$r[2]=0;var D$e=D$s.max.elements;D$e[0]=D$e[1]=1,D$e[2]=0},D$s.generatePositionAndDirection=function(D$s,D$r,D$e,D$U){var D$m=D$s.elements,D$k=D$j._tempPositionPoint.elements;D$e?(D$e.seed=D$U[16],this.emitFromEdge?D$N._randomPointUnitArcCircle(this.arc,D$j._tempPositionPoint,D$e):D$N._randomPointInsideUnitArcCircle(this.arc,D$j._tempPositionPoint,D$e),D$U[16]=D$e.seed):this.emitFromEdge?D$N._randomPointUnitArcCircle(this.arc,D$j._tempPositionPoint):D$N._randomPointInsideUnitArcCircle(this.arc,D$j._tempPositionPoint),D$m[0]=-D$k[0],D$m[1]=D$k[1],D$m[2]=0,D$jr.scale(D$s,this.radius,D$s),this.randomDirection?D$e?(D$e.seed=D$U[17],D$N._randomPointUnitSphere(D$r,D$e),D$U[17]=D$e.seed):D$N._randomPointUnitSphere(D$r):D$s.cloneTo(D$r)},D$s.cloneTo=function(D$s){D$e.prototype.cloneTo.call(this,D$s);var D$r=D$s;D$r.radius=this.radius,D$r.arc=this.arc,D$r.emitFromEdge=this.emitFromEdge,D$r.randomDirection=this.randomDirection},D$H(D$j,["_tempPositionPoint",function(){return this._tempPositionPoint=new D$kr}])}(D$Q),function(D$e){function D$A(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,D$A.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}D$x(D$A,"laya.d3.core.particleShuriKen.module.shape.ConeShape",D$e);var D$s=D$A.prototype;D$s._getShapeBoundBox=function(D$s){var D$r=this.radius+this.length*Math.sin(this.angle),D$e=this.length*Math.cos(this.angle),D$U=D$s.min.elements;D$U[0]=D$U[1]=-D$r,D$U[2]=0;var D$m=D$s.max.elements;D$m[0]=D$m[1]=D$r,D$m[2]=D$e},D$s._getSpeedBoundBox=function(D$s){var D$r=Math.sin(this.angle),D$e=D$s.min.elements;D$e[0]=D$e[1]=-D$r,D$e[2]=0;var D$U=D$s.max.elements;D$U[0]=D$e[1]=D$r,D$U[2]=1},D$s.generatePositionAndDirection=function(D$s,D$r,D$e,D$U){var D$m,D$k=D$s.elements,D$j=D$r.elements,D$T=D$A._tempPositionPoint.elements,D$Y=NaN,D$Z=NaN,D$h=Math.cos(this.angle),D$H=Math.sin(this.angle);switch(this.emitType){case 0:D$e?(D$e.seed=D$U[16],D$N._randomPointInsideUnitCircle(D$A._tempPositionPoint,D$e),D$U[16]=D$e.seed):D$N._randomPointInsideUnitCircle(D$A._tempPositionPoint),D$Y=D$T[0],D$Z=D$T[1],D$k[0]=D$Y*this.radius,D$k[1]=D$Z*this.radius,D$k[2]=0,this.randomDirection?(D$e?(D$e.seed=D$U[17],D$N._randomPointInsideUnitCircle(D$A._tempDirectionPoint,D$e),D$U[17]=D$e.seed):D$N._randomPointInsideUnitCircle(D$A._tempDirectionPoint),D$m=D$A._tempDirectionPoint.elements,D$j[0]=D$m[0]*D$H,D$j[1]=D$m[1]*D$H):(D$j[0]=D$Y*D$H,D$j[1]=D$Z*D$H),D$j[2]=D$h;break;case 1:D$e?(D$e.seed=D$U[16],D$N._randomPointUnitCircle(D$A._tempPositionPoint,D$e),D$U[16]=D$e.seed):D$N._randomPointUnitCircle(D$A._tempPositionPoint),D$Y=D$T[0],D$Z=D$T[1],D$k[0]=D$Y*this.radius,D$k[1]=D$Z*this.radius,D$k[2]=0,this.randomDirection?(D$e?(D$e.seed=D$U[17],D$N._randomPointInsideUnitCircle(D$A._tempDirectionPoint,D$e),D$U[17]=D$e.seed):D$N._randomPointInsideUnitCircle(D$A._tempDirectionPoint),D$m=D$A._tempDirectionPoint.elements,D$j[0]=D$m[0]*D$H,D$j[1]=D$m[1]*D$H):(D$j[0]=D$Y*D$H,D$j[1]=D$Z*D$H),D$j[2]=D$h;break;case 2:D$e?(D$e.seed=D$U[16],D$N._randomPointInsideUnitCircle(D$A._tempPositionPoint,D$e)):D$N._randomPointInsideUnitCircle(D$A._tempPositionPoint),D$Y=D$T[0],D$Z=D$T[1],D$k[0]=D$Y*this.radius,D$k[1]=D$Z*this.radius,D$j[D$k[2]=0]=D$Y*D$H,D$j[1]=D$Z*D$H,D$j[2]=D$h,D$jr.normalize(D$r,D$r),D$e?(D$jr.scale(D$r,this.length*D$e.getFloat(),D$r),D$U[16]=D$e.seed):D$jr.scale(D$r,this.length*Math.random(),D$r),D$jr.add(D$s,D$r,D$s),this.randomDirection&&(D$e?(D$e.seed=D$U[17],D$N._randomPointUnitSphere(D$r,D$e),D$U[17]=D$e.seed):D$N._randomPointUnitSphere(D$r));break;case 3:D$e?(D$e.seed=D$U[16],D$N._randomPointUnitCircle(D$A._tempPositionPoint,D$e)):D$N._randomPointUnitCircle(D$A._tempPositionPoint),D$Y=D$T[0],D$Z=D$T[1],D$k[0]=D$Y*this.radius,D$k[1]=D$Z*this.radius,D$j[D$k[2]=0]=D$Y*D$H,D$j[1]=D$Z*D$H,D$j[2]=D$h,D$jr.normalize(D$r,D$r),D$e?(D$jr.scale(D$r,this.length*D$e.getFloat(),D$r),D$U[16]=D$e.seed):D$jr.scale(D$r,this.length*Math.random(),D$r),D$jr.add(D$s,D$r,D$s),this.randomDirection&&(D$e?(D$e.seed=D$U[17],D$N._randomPointUnitSphere(D$r,D$e),D$U[17]=D$e.seed):D$N._randomPointUnitSphere(D$r));break;default:throw new Error("ConeShape:emitType is invalid.")}},D$s.cloneTo=function(D$s){D$e.prototype.cloneTo.call(this,D$s);var D$r=D$s;D$r.angle=this.angle,D$r.radius=this.radius,D$r.length=this.length,D$r.emitType=this.emitType,D$r.randomDirection=this.randomDirection},D$H(D$A,["_tempPositionPoint",function(){return this._tempPositionPoint=new D$kr},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new D$kr}])}(D$Q),function(D$e){function D$s(){this.radius=NaN,this.emitFromShell=!1,D$s.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}D$x(D$s,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",D$e);var D$r=D$s.prototype;D$r._getShapeBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=D$r[1]=D$r[2]=-this.radius;var D$e=D$s.max.elements;D$e[0]=D$e[1]=this.radius,D$e[2]=0},D$r._getSpeedBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=D$r[1]=-1,D$r[2]=0;var D$e=D$s.max.elements;D$e[0]=D$e[1]=D$e[2]=1},D$r.generatePositionAndDirection=function(D$s,D$r,D$e,D$U){var D$m=D$s.elements;D$e?(D$e.seed=D$U[16],this.emitFromShell?D$N._randomPointUnitSphere(D$s,D$e):D$N._randomPointInsideUnitSphere(D$s,D$e),D$U[16]=D$e.seed):this.emitFromShell?D$N._randomPointUnitSphere(D$s):D$N._randomPointInsideUnitSphere(D$s),D$jr.scale(D$s,this.radius,D$s);var D$k=D$m[2];D$k<0&&(D$m[2]=-1*D$k),this.randomDirection?D$e?(D$e.seed=D$U[17],D$N._randomPointUnitSphere(D$r,D$e),D$U[17]=D$e.seed):D$N._randomPointUnitSphere(D$r):D$s.cloneTo(D$r)},D$r.cloneTo=function(D$s){D$e.prototype.cloneTo.call(this,D$s);var D$r=D$s;D$r.radius=this.radius,D$r.emitFromShell=this.emitFromShell,D$r.randomDirection=this.randomDirection}}(D$Q),function(D$e){function D$s(){this.radius=NaN,this.emitFromShell=!1,D$s.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}D$x(D$s,"laya.d3.core.particleShuriKen.module.shape.SphereShape",D$e);var D$r=D$s.prototype;D$r._getShapeBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=D$r[1]=D$r[2]=-this.radius;var D$e=D$s.max.elements;D$e[0]=D$e[1]=D$e[2]=this.radius},D$r._getSpeedBoundBox=function(D$s){var D$r=D$s.min.elements;D$r[0]=D$r[1]=D$r[2]=-1;var D$e=D$s.max.elements;D$e[0]=D$e[1]=D$e[2]=1},D$r.generatePositionAndDirection=function(D$s,D$r,D$e,D$U){D$e?(D$e.seed=D$U[16],this.emitFromShell?D$N._randomPointUnitSphere(D$s,D$e):D$N._randomPointInsideUnitSphere(D$s,D$e),D$U[16]=D$e.seed):this.emitFromShell?D$N._randomPointUnitSphere(D$s):D$N._randomPointInsideUnitSphere(D$s),D$jr.scale(D$s,this.radius,D$s),this.randomDirection?D$e?(D$e.seed=D$U[17],D$N._randomPointUnitSphere(D$r,D$e),D$U[17]=D$e.seed):D$N._randomPointUnitSphere(D$r):D$s.cloneTo(D$r)},D$r.cloneTo=function(D$s){D$e.prototype.cloneTo.call(this,D$s);var D$r=D$s;D$r.radius=this.radius,D$r.emitFromShell=this.emitFromShell,D$r.randomDirection=this.randomDirection}}(D$Q),function(D$s){function D$r(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,D$r.__super.call(this)}return D$x(D$r,"laya.d3.core.render.SubMeshRenderElement",D$d),D$r}()),D$nr=function(D$s){function D$l(D$s,D$r,D$e,D$U,D$m,D$k){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=D$s,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[D$xr.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[D$Gr.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[D$Gr.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[D$Jr.SHADERDEFINE_ALPHATEST]="ALPHATEST";D$l.__super.call(this,D$s,D$r,D$e,null,{}),this._attributeMap=D$U;var D$j;for(D$j in D$m){var D$T=D$m[D$j];switch(D$T[1]){case 0:this._renderElementUniformMap[D$j]=D$T[0];break;case 1:this._materialUniformMap[D$j]=D$T[0];break;case 2:this._spriteUniformMap[D$j]=D$T[0];break;case 3:this._cameraUniformMap[D$j]=D$T[0];break;case 4:this._sceneUniformMap[D$j]=D$T[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}D$x(D$l,"laya.d3.shader.ShaderCompile3D",D$o);var D$r=D$l.prototype;return D$r._definesToNameDic=function(D$s,D$r){for(var D$e={},D$U=1,D$m=0;D$m<32&&!(D$s<(D$U=1<<D$m));D$m++)if(D$s&D$U){var D$k=D$r[D$U];D$k&&(D$e[D$k]="")}return D$e},D$r.withCompile=function(D$s,D$r,D$e,D$U){var D$m,D$k,D$j;if(D$k=this.sharders[D$s])if(D$j=D$k[D$r]){if(D$m=D$j[D$e])return D$m}else D$j=D$k[D$r]=[];else D$j=(D$k=this.sharders[D$s]=[])[D$r]=[];var D$T,D$Y=this._definesToNameDic(D$s,D$l._globalInt2name),D$Z=this._definesToNameDic(D$r,this._spriteInt2name),D$h=this._definesToNameDic(D$e,this._materialInt2name),D$H={},D$A="";if(D$Y)for(D$T in D$Y)D$A+="#define "+D$T+"\n",D$H[D$T]=!0;if(D$Z)for(D$T in D$Z)D$A+="#define "+D$T+"\n",D$H[D$T]=!0;if(D$h)for(D$T in D$h)D$A+="#define "+D$T+"\n",D$H[D$T]=!0;var D$x=D$vr.nameKey.getName(this._name)+" compile ("+D$s+","+D$r+","+D$e+")",D$B=this._VS.toscript(D$H,[]),D$$=this._PS.toscript(D$H,[]);D$i.now();if(D$m=D$vr.create(D$A+D$B.join("\n"),D$A+D$$.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,D$U,D$x),D$j[D$e]=D$m,laya.d3.shader.ShaderCompile3D.debugMode)D$i.now();return D$m},D$r.precompileShaderWithShaderDefine=function(D$s,D$r,D$e){this.withCompile(D$s,D$r,D$e,!0)},D$r.addMaterialDefines=function(D$s){var D$r=D$s.defines;for(var D$e in D$r){var D$U=D$r[D$e],D$m=parseInt(D$e);this._materialInt2name[D$m]=D$U,this._materialName2Int[D$U]=D$m}},D$r.addSpriteDefines=function(D$s){var D$r=D$s.defines;for(var D$e in D$r){var D$U=D$r[D$e],D$m=parseInt(D$e);this._spriteInt2name[D$m]=D$U,this._spriteName2Int[D$U]=D$m}},D$r.getMaterialDefineByName=function(D$s){return this._materialName2Int[D$s]},D$r.registerMaterialDefine=function(D$s){var D$r=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[D$r]=D$s,this._materialName2Int[D$s]=D$r},D$r.registerSpriteDefine=function(D$s){var D$r=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[D$r]=D$s,this._spriteName2Int[D$s]=D$r},D$l._globalRegDefine=function(D$s,D$r){D$l._globalInt2name[D$r]=D$s},D$l.add=function(D$s,D$r,D$e,D$U,D$m){return laya.d3.shader.ShaderCompile3D._preCompileShader[D$s]=new D$l(D$s,D$r,D$e,D$U,D$m,D$o.includes)},D$l.get=function(D$s){return laya.d3.shader.ShaderCompile3D._preCompileShader[D$vr.nameKey.getID(D$s)]},D$l._preCompileShader={},D$l._globalInt2name=[],D$l.debugMode=!1,D$l.SHADERDEFINE_HIGHPRECISION=1,D$l.SHADERDEFINE_FOG=4,D$l.SHADERDEFINE_DIRECTIONLIGHT=8,D$l.SHADERDEFINE_POINTLIGHT=16,D$l.SHADERDEFINE_SPOTLIGHT=32,D$l.SHADERDEFINE_UV0=64,D$l.SHADERDEFINE_COLOR=128,D$l.SHADERDEFINE_UV1=256,D$l.SAHDERDEFINE_DEPTHFOG=131072,D$l}(),D$yr=function(D$s){function D$B(){D$B.__super.call(this)}D$x(D$B,"laya.d3.graphics.MeshSprite3DStaticBatchManager",D$Us);var D$r=D$B.prototype;return D$r._getStaticBatch=function(D$s,D$r,D$e,D$U){var D$m,D$k;return D$k=D$s?D$s.id.toString()+D$e.id.toString()+D$r.id.toString()+D$U.toString():D$e.id.toString()+D$r.id.toString()+D$U.toString(),this._staticBatches[D$k]?D$m=this._staticBatches[D$k]:this._staticBatches[D$k]=D$m=new D$gr(D$k,this,D$s,D$r,D$e),D$m},D$r._initStaticBatchs=function(D$s){var D$r,D$e;this._initBatchRenderElements.sort(D$B._sortPrepareStaticBatch);for(var D$U,D$m=!1,D$k=0,D$j=0,D$T=this._initBatchRenderElements.length;D$j<D$T;D$j++){var D$Y,D$Z=this._initBatchRenderElements[D$j],D$h=D$Z.renderObj._getVertexBuffer(0);D$Z._sprite3D;if(D$e===D$h.vertexDeclaration&&D$r===D$Z._material)if(D$m)D$U._addCombineBatchRenderObjTest(D$Z)?(D$Y=D$Z._staticBatch)!==D$U&&(D$Y&&D$Y._deleteCombineBatchRenderObj(D$Z),D$U._addCombineBatchRenderObj(D$Z)):(D$m=!1,D$k++);else{var D$H=this._initBatchRenderElements[D$j-1],D$A=D$H.renderObj,D$x=D$Z.renderObj;D$m=!(65535<D$A._getVertexBuffer().vertexCount+D$x._getVertexBuffer().vertexCount)&&(D$U=this._getStaticBatch(D$s,D$e,D$r,D$k),(D$Y=D$H._staticBatch)!==D$U&&(D$Y&&D$Y._deleteCombineBatchRenderObj(D$H),D$U._addCombineBatchRenderObj(D$H)),(D$Y=D$Z._staticBatch)!==D$U&&(D$Y&&D$Y._deleteCombineBatchRenderObj(D$Z),D$U._addCombineBatchRenderObj(D$Z)),!0)}else D$m=!1,D$k=0;D$r=D$Z._material,D$e=D$h.vertexDeclaration}},D$B._sortPrepareStaticBatch=function(D$s,D$r){var D$e=D$s._render,D$U=D$r._render,D$m=D$e.lightmapIndex-D$U.lightmapIndex;if(0!=D$m)return D$m;var D$k=D$e.receiveShadow-D$U.receiveShadow;if(0!=D$k)return D$k;var D$j=D$s._mainSortID-D$r._mainSortID;return 0==D$j?D$s.renderObj.triangleCount-D$r.renderObj.triangleCount:D$j},D$B}(),D$gr=function(D$s){function D$k(D$s,D$r,D$e,D$U,D$m){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,D$k.__super.call(this,D$s,D$r,D$e),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=D$U,this._material=D$m}D$x(D$k,"laya.d3.graphics.SubMeshStaticBatch",D$ms);var D$r=D$k.prototype;return D$r._compareBatchRenderElement=function(D$s,D$r){return D$s._batchIndexStart>D$r._batchIndexStart},D$r._addCombineBatchRenderObjTest=function(D$s){var D$r=D$s.renderObj._vertexCount;return!(65535<(0<D$r?this._currentCombineVertexCount+D$r:this._currentCombineVertexCount+D$s.renderObj._getVertexBuffer().vertexCount))},D$r._addCombineBatchRenderObj=function(D$s){var D$r=D$s.renderObj,D$e=D$r._vertexCount;this._initBatchRenderElements.push(D$s),D$s._staticBatch=this,0<D$e?(this._currentCombineIndexCount+=D$r._indexCount,this._currentCombineVertexCount+=D$e):(this._currentCombineIndexCount=this._currentCombineIndexCount+D$r._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+D$r._getVertexBuffer().vertexCount),this._needFinishCombine=!0},D$r._deleteCombineBatchRenderObj=function(D$s){var D$r=D$s.renderObj,D$e=this._initBatchRenderElements.indexOf(D$s);if(-1!==D$e){this._initBatchRenderElements.splice(D$e,1),D$s._staticBatch=null;var D$U=D$r._vertexCount;0<D$U?(this._currentCombineIndexCount=this._currentCombineIndexCount-D$r._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-D$U):(this._currentCombineIndexCount=this._currentCombineIndexCount-D$r._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-D$r._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},D$r._finishInit=function(){if(this._needFinishCombine){var D$s=0,D$r=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var D$e=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),D$U=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=D$Qr.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=D$zr.create("ushort",this._currentCombineIndexCount,35044);for(var D$m=0,D$k=this._initBatchRenderElements.length;D$m<D$k;D$m++){var D$j=this._initBatchRenderElements[D$m],D$T=D$j.renderObj,D$Y=D$T._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,D$j._sprite3D),D$Z=D$T.getIndices(),D$h=D$j._sprite3D.transform._isFrontFaceInvert,D$H=D$s/(this._vertexDeclaration.vertexStride/4)-D$T._vertexStart,D$A=D$r,D$x=D$A+D$Z.length;D$j._batchIndexStart=D$A,D$j._batchIndexEnd=D$x,D$U.set(D$Z,D$r);var D$B=0;if(D$h)for(D$B=D$A;D$B<D$x;D$B+=3){D$U[D$B]=D$H+D$U[D$B];var D$$=D$U[D$B+1],D$l=D$U[D$B+2];D$U[D$B+1]=D$H+D$l,D$U[D$B+2]=D$H+D$$}else for(D$B=D$A;D$B<D$x;D$B+=3)D$U[D$B]=D$H+D$U[D$B],D$U[D$B+1]=D$H+D$U[D$B+1],D$U[D$B+2]=D$H+D$U[D$B+2];D$r+=D$Z.length,D$e.set(D$Y,D$s),D$s+=D$Y.length}this._vertexBuffer.setData(D$e),this._indexBuffer.setData(D$U),this._needFinishCombine=!1}},D$r._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new D$Dr)},D$r._getRenderElement=function(D$s,D$r,D$e){for(var D$U,D$m,D$k=this._batchRenderElements.length,D$j=!0,D$T=0;D$T<D$k;D$T++){var D$Y,D$Z,D$h=(D$m=this._batchRenderElements[D$T])._sprite3D._render;if(0!==D$T&&(D$j=(D$Y=(D$U=this._batchRenderElements[D$T-1])._sprite3D._render).lightmapIndex!==D$h.lightmapIndex||D$Y.receiveShadow!==D$h.receiveShadow||D$U._batchIndexEnd!==D$m._batchIndexStart),D$j){(D$Z=this._getCombineRenderElementFromPool()).renderObj=this,D$Z._material=this._material,D$Z._batchIndexStart=D$m._batchIndexStart,D$Z._batchIndexEnd=D$m._batchIndexEnd;var D$H=D$h.lightmapIndex,D$A=D$H+1,D$x=this._batchOwnerIndices[D$A];D$x||(D$x=this._batchOwnerIndices[D$A]=[]);var D$B,D$$=D$x[D$m._render.receiveShadow?1:0];void 0===D$$?(D$x[D$h.receiveShadow?1:0]=this._batchOwners.length,(D$B=new D$tr(null,"StaticBatchMeshSprite3D"))._scene=D$r,D$B._transform=this._rootOwner?this._rootOwner._transform:null,D$B._render.lightmapIndex=D$H,D$B._render.receiveShadow=D$m._render.receiveShadow,this._batchOwners.push(D$B)):D$B=this._batchOwners[D$$],D$B._render._renderUpdate(D$e),D$Z._sprite3D=D$B,D$s.push(D$Z)}else D$Z._batchIndexEnd=D$m._batchIndexEnd}},D$r._beforeRender=function(D$s){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},D$r._render=function(D$s){var D$r=D$s.renderElement,D$e=D$r._batchIndexStart,D$U=D$r._batchIndexEnd-D$e;D$P.mainContext.drawElements(4,D$U,5123,2*D$e),D$n.drawCall++,D$n.trianglesFaces+=D$U/3},D$r.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},D$r._getVertexBuffer=function(D$s){return void 0===D$s&&(D$s=0),this._vertexBuffer},D$k}(),D$fr=function(D$s){function D$r(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,D$r.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}D$x(D$r,"laya.d3.core.ComponentNode",D$Z);var D$e=D$r.prototype;return D$e.addComponent=function(D$s){var D$r,D$e=this._componentsMap.indexOf(D$s);if(-1===D$e)D$r=[],this._componentsMap.push(D$s),this._typeComponentsIndices.push(D$r);else if(D$r=this._typeComponentsIndices[D$e],this._components[D$r[0]].isSingleton)throw new Error("无法单实例创建"+D$s+"组件，"+D$s+"组件已存在！");var D$U=D$m.getInstance(D$s);return D$r.push(this._components.length),this._components.push(D$U),D$U instanceof laya.d3.component.Script&&this._scripts.push(D$U),D$U._initialize(this),D$U},D$e._removeComponent=function(D$s,D$r){var D$e=this._typeComponentsIndices[D$s],D$U=D$e[D$r],D$m=this._components[D$U];this._components.splice(D$U,1),D$m instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(D$m),1),D$e.splice(D$r,1),0===D$e.length&&(this._typeComponentsIndices.splice(D$s,1),this._componentsMap.splice(D$s,1));for(var D$k=0,D$j=this._componentsMap.length;D$k<D$j;D$k++)for(var D$T=(D$e=this._typeComponentsIndices[D$k]).length-1;0<=D$T;D$T--){var D$Y=D$e[D$T];if(!(D$U<D$Y))break;D$e[D$T]=--D$Y}D$m._destroy()},D$e.getComponentByType=function(D$s,D$r){void 0===D$r&&(D$r=0);var D$e=this._componentsMap.indexOf(D$s);return-1===D$e?null:this._components[this._typeComponentsIndices[D$e][D$r]]},D$e.getComponentsByType=function(D$s,D$r){var D$e=this._componentsMap.indexOf(D$s);if(-1!==D$e){var D$U=this._typeComponentsIndices[D$e],D$m=D$U.length;D$r.length=D$m;for(var D$k=0;D$k<D$m;D$k++)D$r[D$k]=this._components[D$U[D$k]]}else D$r.length=0},D$e.getComponentByIndex=function(D$s){return this._components[D$s]},D$e.removeComponentByType=function(D$s,D$r){void 0===D$r&&(D$r=0);var D$e=this._componentsMap.indexOf(D$s);-1!==D$e&&this._removeComponent(D$e,D$r)},D$e.removeComponentsByType=function(D$s){var D$r=this._componentsMap.indexOf(D$s);if(-1!==D$r)for(var D$e=this._typeComponentsIndices[D$r],D$U=0,D$m=D$e.length;D$U<D$m;D$e.length<D$m?D$m--:D$U++)this._removeComponent(D$r,D$U)},D$e.removeAllComponent=function(){for(var D$s=0,D$r=this._componentsMap.length;D$s<D$r;this._componentsMap.length<D$r?D$r--:D$s++)this.removeComponentsByType(this._componentsMap[D$s])},D$e._updateComponents=function(D$s){for(var D$r=0,D$e=this._components.length;D$r<D$e;D$r++){var D$U=this._components[D$r];!D$U.started&&(D$U._start(D$s),D$U.started=!0),D$U.enable&&D$U._update(D$s)}},D$e._lateUpdateComponents=function(D$s){for(var D$r=0;D$r<this._components.length;D$r++){var D$e=this._components[D$r];!D$e.started&&(D$e._start(D$s),D$e.started=!0),D$e.enable&&D$e._lateUpdate(D$s)}},D$e._preRenderUpdateComponents=function(D$s){for(var D$r=0;D$r<this._components.length;D$r++){var D$e=this._components[D$r];!D$e.started&&(D$e._start(D$s),D$e.started=!0),D$e.enable&&D$e._preRenderUpdate(D$s)}},D$e._postRenderUpdateComponents=function(D$s){for(var D$r=0;D$r<this._components.length;D$r++){var D$e=this._components[D$r];!D$e.started&&(D$e._start(D$s),D$e.started=!0),D$e.enable&&D$e._postRenderUpdate(D$s)}},D$r}(),D$Jr=function(D$U){function D$s(){D$s.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new D$Ar,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new D$Tr(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}D$x(D$s,"laya.d3.core.material.BaseMaterial",D$U);var D$r=D$s.prototype;return D$w.imps(D$r,{"laya.d3.core.IClone":!0}),D$r._addShaderDefine=function(D$s){this._shaderDefineValue|=D$s},D$r._removeShaderDefine=function(D$s){this._shaderDefineValue&=~D$s},D$r._addDisablePublicShaderDefine=function(D$s){this._disablePublicShaderDefine|=D$s},D$r._removeDisablePublicShaderDefine=function(D$s){this._disablePublicShaderDefine&=~D$s},D$r._setBuffer=function(D$s,D$r){this._shaderValues.setValue(D$s,D$r),this._values[D$s]=D$r},D$r._getBuffer=function(D$s){return this._values[D$s]},D$r._setMatrix4x4=function(D$s,D$r){this._shaderValues.setValue(D$s,D$r?D$r.elements:null),this._values[D$s]=D$r},D$r._getMatrix4x4=function(D$s){return this._values[D$s]},D$r._setInt=function(D$s,D$r){this._shaderValues.setValue(D$s,D$r),this._values[D$s]=D$r},D$r._getInt=function(D$s){return this._values[D$s]},D$r._setNumber=function(D$s,D$r){this._shaderValues.setValue(D$s,D$r),this._values[D$s]=D$r},D$r._getNumber=function(D$s){return this._values[D$s]},D$r._setBool=function(D$s,D$r){this._shaderValues.setValue(D$s,D$r),this._values[D$s]=D$r},D$r._getBool=function(D$s){return this._values[D$s]},D$r._setVector2=function(D$s,D$r){this._shaderValues.setValue(D$s,D$r?D$r.elements:null),this._values[D$s]=D$r},D$r._getVector2=function(D$s){return this._values[D$s]},D$r._setColor=function(D$s,D$r){this._shaderValues.setValue(D$s,D$r?D$r.elements:null),this._values[D$s]=D$r},D$r._getColor=function(D$s){return this._values[D$s]},D$r._setTexture=function(D$s,D$r){var D$e=this._values[D$s];this._values[D$s]=D$r,this._shaderValues.setValue(D$s,D$r),0<this.referenceCount&&(D$e&&D$e._removeReference(),D$r&&D$r._addReference())},D$r._getTexture=function(D$s){return this._values[D$s]},D$r._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},D$r._getShader=function(D$s,D$r,D$e){var D$U=(D$s|D$r)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(D$U,D$e,this._shaderDefineValue),this._shader},D$r._setRenderStateBlendDepth=function(){var D$s=D$P.mainContext;switch(D$O.setDepthMask(D$s,this.depthWrite),0===this.depthTest?D$O.setDepthTest(D$s,!1):(D$O.setDepthTest(D$s,!0),D$O.setDepthFunc(D$s,this.depthTest)),this.blend){case 0:D$O.setBlend(D$s,!1);break;case 1:D$O.setBlend(D$s,!0),D$O.setBlendFunc(D$s,this.srcBlend,this.dstBlend);break;case 2:D$O.setBlend(D$s,!0)}},D$r._setRenderStateFrontFace=function(D$s,D$r){var D$e=D$P.mainContext,D$U=0;switch(this.cull){case 0:D$O.setCullFace(D$e,!1);break;case 1:D$O.setCullFace(D$e,!0),D$U=D$s?D$r&&D$r._isFrontFaceInvert?2305:2304:D$r&&D$r._isFrontFaceInvert?2304:2305,D$O.setFrontFace(D$e,D$U);break;case 2:D$O.setCullFace(D$e,!0),D$U=D$s?D$r&&D$r._isFrontFaceInvert?2304:2305:D$r&&D$r._isFrontFaceInvert?2305:2304,D$O.setFrontFace(D$e,D$U)}},D$r.onAsynLoaded=function(D$s,D$r,D$e){var D$U=D$r[0],D$m=D$r[1];switch(D$U.version){case"LAYAMATERIAL:01":var D$k=0,D$j=0,D$T=D$U.props;for(var D$Y in D$T)switch(D$Y){case"vectors":var D$Z=D$T[D$Y];for(D$k=0,D$j=D$Z.length;D$k<D$j;D$k++){var D$h=D$Z[D$k],D$H=D$h.value;switch(D$H.length){case 2:this[D$h.name]=new D$kr(D$H[0],D$H[1]);break;case 3:this[D$h.name]=new D$jr(D$H[0],D$H[1],D$H[2]);break;case 4:this[D$h.name]=new D$Tr(D$H[0],D$H[1],D$H[2],D$H[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var D$A=D$T[D$Y];for(D$k=0,D$j=D$A.length;D$k<D$j;D$k++){var D$x=D$A[D$k],D$B=D$x.path;D$B&&(this[D$x.name]=D$V.getRes(D$m[D$B]))}break;case"defines":var D$$=D$T[D$Y];for(D$k=0,D$j=D$$.length;D$k<D$j;D$k++){var D$l=this._shaderCompile.getMaterialDefineByName(D$$[D$k]);this._addShaderDefine(D$l)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[D$Y]=D$T[D$Y];break;case"renderQueue":switch(D$T[D$Y]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[D$Y]=D$T[D$Y]}break;case"LAYAMATERIAL:02":for(D$Y in D$T=D$U.props)switch(D$Y){case"vectors":for(D$k=0,D$j=(D$Z=D$T[D$Y]).length;D$k<D$j;D$k++)switch((D$H=(D$h=D$Z[D$k]).value).length){case 2:this[D$h.name]=new D$kr(D$H[0],D$H[1]);break;case 3:this[D$h.name]=new D$jr(D$H[0],D$H[1],D$H[2]);break;case 4:this[D$h.name]=new D$Tr(D$H[0],D$H[1],D$H[2],D$H[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(D$k=0,D$j=(D$A=D$T[D$Y]).length;D$k<D$j;D$k++)(D$B=(D$x=D$A[D$k]).path)&&(this[D$x.name]=D$V.getRes(D$m[D$B]));break;case"defines":for(D$k=0,D$j=(D$$=D$T[D$Y]).length;D$k<D$j;D$k++)D$l=this._shaderCompile.getMaterialDefineByName(D$$[D$k]),this._addShaderDefine(D$l);break;default:this[D$Y]=D$T[D$Y]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},D$r._addReference=function(){D$U.prototype._addReference.call(this);for(var D$s=0,D$r=this._values.length;D$s<D$r;D$s++){var D$e=this._values[D$s];D$e&&D$e instanceof laya.d3.resource.BaseTexture&&D$e._addReference()}},D$r._removeReference=function(){D$U.prototype._removeReference.call(this);for(var D$s=0,D$r=this._values.length;D$s<D$r;D$s++){var D$e=this._values[D$s];D$e&&D$e instanceof laya.d3.resource.BaseTexture&&D$e._removeReference()}},D$r.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},D$r.setShaderName=function(D$s){var D$r=D$vr.nameKey.getID(D$s);if(-1===D$r)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=D$nr._preCompileShader[D$r]},D$r.cloneTo=function(D$s){var D$r=D$s;D$r.name=this.name,D$r.cull=this.cull,D$r.blend=this.blend,D$r.srcBlend=this.srcBlend,D$r.dstBlend=this.dstBlend,D$r.srcBlendRGB=this.srcBlendRGB,D$r.dstBlendRGB=this.dstBlendRGB,D$r.srcBlendAlpha=this.srcBlendAlpha,D$r.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(D$r.blendConstColor),D$r.blendEquation=this.blendEquation,D$r.blendEquationRGB=this.blendEquationRGB,D$r.blendEquationAlpha=this.blendEquationAlpha,D$r.depthTest=this.depthTest,D$r.depthWrite=this.depthWrite,D$r.renderQueue=this.renderQueue,D$r._shader=this._shader,D$r._disablePublicShaderDefine=this._disablePublicShaderDefine,D$r._shaderDefineValue=this._shaderDefineValue;var D$e,D$U=0,D$m=D$r._shaderValues;D$r._shaderValues.data.length=this._shaderValues.data.length;var D$k=this._values.length,D$j=D$r._values;for(D$U=0,D$e=D$j.length=D$k;D$U<D$e;D$U++){var D$T=this._values[D$U];if(D$T)if("number"==typeof D$T)D$j[D$U]=D$T,D$m.data[D$U]=D$T;else if("number"==typeof D$T&&Math.floor(D$T)==D$T)D$j[D$U]=D$T,D$m.data[D$U]=D$T;else if("boolean"==typeof D$T)D$j[D$U]=D$T,D$m.data[D$U]=D$T;else if(D$T instanceof laya.d3.math.Vector2){var D$Y=D$j[D$U]||(D$j[D$U]=new D$kr);D$T.cloneTo(D$Y),D$m.data[D$U]=D$Y.elements}else if(D$T instanceof laya.d3.math.Vector3){var D$Z=D$j[D$U]||(D$j[D$U]=new D$jr);D$T.cloneTo(D$Z),D$m.data[D$U]=D$Z.elements}else if(D$T instanceof laya.d3.math.Vector4){var D$h=D$j[D$U]||(D$j[D$U]=new D$Tr);D$T.cloneTo(D$h),D$m.data[D$U]=D$h.elements}else if(D$T instanceof laya.d3.math.Matrix4x4){var D$H=D$j[D$U]||(D$j[D$U]=new D$sr);D$T.cloneTo(D$H),D$m.data[D$U]=D$H.elements}else D$T instanceof laya.d3.resource.BaseTexture&&(D$j[D$U]=D$T,D$m.data[D$U]=D$T)}},D$r.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$B(0,D$r,"alphaTestValue",function(){return this._getNumber(0)},function(D$s){this._setNumber(0,D$s)}),D$B(0,D$r,"alphaTest",function(){return this._alphaTest},function(D$s){(this._alphaTest=D$s)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),D$s.__init__=function(){D$s.SHADERDEFINE_ALPHATEST=D$s.shaderDefines.registerDefine("ALPHATEST")},D$s.RENDERQUEUE_OPAQUE=2e3,D$s.RENDERQUEUE_ALPHATEST=2450,D$s.RENDERQUEUE_TRANSPARENT=3e3,D$s.CULL_NONE=0,D$s.CULL_FRONT=1,D$s.CULL_BACK=2,D$s.BLEND_DISABLE=0,D$s.BLEND_ENABLE_ALL=1,D$s.BLEND_ENABLE_SEPERATE=2,D$s.BLENDPARAM_ZERO=0,D$s.BLENDPARAM_ONE=1,D$s.BLENDPARAM_SRC_COLOR=768,D$s.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,D$s.BLENDPARAM_DST_COLOR=774,D$s.BLENDPARAM_ONE_MINUS_DST_COLOR=775,D$s.BLENDPARAM_SRC_ALPHA=770,D$s.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,D$s.BLENDPARAM_DST_ALPHA=772,D$s.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,D$s.BLENDPARAM_SRC_ALPHA_SATURATE=776,D$s.BLENDEQUATION_ADD=0,D$s.BLENDEQUATION_SUBTRACT=1,D$s.BLENDEQUATION_REVERSE_SUBTRACT=2,D$s.DEPTHTEST_OFF=0,D$s.DEPTHTEST_NEVER=512,D$s.DEPTHTEST_LESS=513,D$s.DEPTHTEST_EQUAL=514,D$s.DEPTHTEST_LEQUAL=515,D$s.DEPTHTEST_GREATER=516,D$s.DEPTHTEST_NOTEQUAL=517,D$s.DEPTHTEST_GEQUAL=518,D$s.DEPTHTEST_ALWAYS=519,D$s.SHADERDEFINE_ALPHATEST=1,D$s.ALPHATESTVALUE=0,D$H(D$s,["shaderDefines",function(){return this.shaderDefines=new D$hr}]),D$s}(D$l),D$Pr=function(D$s){function D$r(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,D$r.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}D$x(D$r,"laya.d3.resource.BaseTexture",D$l);var D$e=D$r.prototype;return D$B(0,D$e,"width",function(){return this._width}),D$B(0,D$e,"repeat",function(){return this._repeat},function(D$s){if(this._repeat!==D$s&&(this._repeat=D$s,this._source)){var D$r=D$P.mainContext;D$O.bindTexture(D$r,this._type,this._source),D$I.isPOT(this._width,this._height)&&this._repeat?(D$r.texParameteri(this._type,10242,10497),D$r.texParameteri(this._type,10243,10497)):(D$r.texParameteri(this._type,10242,33071),D$r.texParameteri(this._type,10243,33071))}}),D$B(0,D$e,"height",function(){return this._height}),D$B(0,D$e,"magFifter",function(){return this._magFifter},function(D$s){(this._magFifter=D$s)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(D$s)}),D$B(0,D$e,"wrapModeV",function(){return this._wrapModeV}),D$B(0,D$e,"size",function(){return this._size}),D$B(0,D$e,"wrapModeU",function(){return this._wrapModeU}),D$B(0,D$e,"mipmap",function(){return this._mipmap},function(D$s){this._mipmap=D$s,this._mipmap!=D$s&&this._conchTexture&&this._conchTexture.setMipMap(D$s)}),D$B(0,D$e,"minFifter",function(){return this._minFifter},function(D$s){this._minFifter=D$s,this._minFifter!=D$s&&this._conchTexture&&this._conchTexture.setMinFifter(D$s)}),D$B(0,D$e,"format",function(){return this._format}),D$B(0,D$e,"source",function(){return this.activeResource(),this._source}),D$B(0,D$e,"defaulteTexture",function(){return D$pr.grayTexture}),D$r.WARPMODE_REPEAT=0,D$r.WARPMODE_CLAMP=1,D$r}(),D$Or=function(D$s){function D$r(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,D$r.__super.call(this),this._boundingBoxCorners=D$U(8,null)}D$x(D$r,"laya.d3.resource.models.BaseMesh",D$l);var D$e=D$r.prototype;return D$e._getPositions=function(){throw new Error("未Override,请重载该属性！")},D$e._generateBoundingObject=function(){this._boundingSphere=new D$Ms(new D$jr,0),D$Ms.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new D$Ls(new D$jr,new D$jr),D$Ls.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},D$e.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},D$e.getRenderElement=function(D$s){throw new Error("未Override,请重载该属性！")},D$B(0,D$e,"subMeshCount",function(){return this._subMeshCount}),D$B(0,D$e,"boundingBox",function(){return this._boundingBox}),D$B(0,D$e,"boundingBoxCorners",function(){return this._boundingBoxCorners}),D$B(0,D$e,"boundingSphere",function(){return this._boundingSphere}),D$r}(),D$ir=(function(D$s){function D$r(){D$r.__super.call(this)}D$x(D$r,"laya.d3.component.Script",D$or);var D$e=D$r.prototype;D$e.onTriggerEnter=function(D$s){},D$e.onTriggerExit=function(D$s){},D$e.onTriggerStay=function(D$s){},D$B(0,D$e,"isSingleton",function(){return D$r._isSingleton}),D$r._isSingleton=!1}(),function(D$s){function D$r(D$s){this._owner=null,this._sharedMesh=null,D$r.__super.call(this),this._owner=D$s}D$x(D$r,"laya.d3.core.MeshFilter",D$s);var D$e=D$r.prototype;return D$e._sharedMeshLoaded=function(){this.event("loaded")},D$e._destroy=function(){D$s.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},D$B(0,D$e,"sharedMesh",function(){return this._sharedMesh},function(D$s){var D$r=this._sharedMesh;D$r&&D$r._removeReference(),(this._sharedMesh=D$s)._addReference(),this.event("meshchanged",[this,D$r,D$s]),D$s.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),D$B(0,D$e,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),D$B(0,D$e,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),D$B(0,D$e,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),D$B(0,D$e,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),D$r}(D$Ir)),D$Kr=function(D$s){function D$r(D$s){D$r.__super.call(this,D$s),D$s.meshFilter.on("meshchanged",this,this._onMeshChanged)}D$x(D$r,"laya.d3.core.MeshRender",D$wr);var D$e=D$r.prototype;return D$e._onMeshChanged=function(D$s,D$r,D$e){D$e.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:D$e.once("loaded",this,this._onMeshLoaed)},D$e._onMeshLoaed=function(D$s,D$r){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},D$e._calculateBoundingSphereByInitSphere=function(D$s){var D$r=NaN,D$e=this._owner.transform,D$U=D$e.scale.elements,D$m=Math.abs(D$U[0]),D$k=Math.abs(D$U[1]),D$j=Math.abs(D$U[2]);D$r=D$k<=D$m&&D$j<=D$m?D$m:D$j<=D$k?D$k:D$j,D$jr.transformCoordinate(D$s.center,D$e.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=D$s.radius*D$r},D$e._calculateBoundBoxByInitCorners=function(D$s){for(var D$r=this._owner.transform.worldMatrix,D$e=0;D$e<8;D$e++)D$jr.transformCoordinate(D$s[D$e],D$r,D$wr._tempBoundBoxCorners[D$e]);D$Ls.createfromPoints(D$wr._tempBoundBoxCorners,this._boundingBox)},D$e._calculateBoundingSphere=function(){var D$s=this._owner.meshFilter.sharedMesh;null==D$s||null==D$s.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(D$s.boundingSphere)},D$e._calculateBoundingBox=function(){var D$s=this._owner.meshFilter.sharedMesh;null==D$s||null==D$s.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(D$s.boundingBoxCorners)},D$e._renderUpdate=function(D$s){var D$r=this._owner.transform;if(D$r){this._setShaderValueMatrix4x4(0,D$r.worldMatrix);var D$e=this._owner.getProjectionViewWorldMatrix(D$s);this._setShaderValueMatrix4x4(1,D$e)}else this._setShaderValueMatrix4x4(0,D$sr.DEFAULT),this._setShaderValueMatrix4x4(1,D$s);return D$Vr.debugMode&&this._renderRenderableBoundBox(),!0},D$r}(),D$cr=function(D$r){function D$U(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,D$U.__super.call(this),this._renderState=new D$W,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new D$Ar,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new D$rs,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new D$jr(.7,.7,.7),this.ambientColor=new D$jr(.212,.227,.259),D$P.shaderHighPrecision&&this.addShaderDefine(D$nr.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}D$x(D$U,"laya.d3.core.scene.Scene",D$r);var D$s=D$U.prototype;return D$w.imps(D$s,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),D$s._setUrl=function(D$s){this._url=D$s},D$s._getGroup=function(){return this._group},D$s._setGroup=function(D$s){this._group=D$s},D$s._display=function(){D$w.stage._scenes.push(this),D$w.stage._scenes.sort(D$U._sortScenes);for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++){var D$e=this._childs[D$s];D$e.active&&D$e._activeHierarchy()}},D$s._unDisplay=function(){var D$s=D$w.stage._scenes;D$s.splice(D$s.indexOf(this),1);for(var D$r=0,D$e=this._childs.length;D$r<D$e;D$r++){var D$U=this._childs[D$r];D$U.active&&D$U._inActiveHierarchy()}},D$s._addChild3D=function(D$s){D$s.transform._onWorldTransform(),D$s._setBelongScene(this),this.displayedInStage&&D$s.active&&D$s._activeHierarchy()},D$s._removeChild3D=function(D$s){D$s.transform.parent=null,this.displayedInStage&&D$s.active&&D$s._inActiveHierarchy(),D$s._setUnBelongScene()},D$s.initOctree=function(D$s,D$r,D$e,D$U,D$m){void 0===D$m&&(D$m=6),this.treeSize=new D$jr(D$s,D$r,D$e),this.treeLevel=D$m,this.treeRoot=new D$L(this,0),this.treeRoot.init(D$U,this.treeSize)},D$s._prepareUpdateToRenderState=function(D$s,D$r){D$r.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,D$r.scene=this},D$s._prepareSceneToRender=function(D$s){var D$r=this._lights.length;if(0<D$r)for(var D$e=0,D$U=0;D$U<D$r&&!(this._lights[D$U]._prepareToScene(D$s)&&++D$e>=this._enableLightCount);D$U++);},D$s._updateChilds=function(D$s){for(var D$r=0,D$e=this._childs.length;D$r<D$e;++D$r)this._childs[D$r]._update(D$s)},D$s._preRenderScene=function(D$s,D$r,D$e){var D$U,D$m=D$r._viewMatrix,D$k=D$r._projectionMatrix,D$j=D$r._projectionViewMatrix,D$T=0,D$Y=D$r.camera;for(D$Y.useOcclusionCulling?this.treeRoot?D$es.renderObjectCullingOctree(D$e,this,D$Y,D$m,D$k,D$j):D$es.renderObjectCulling(D$e,this,D$Y,D$m,D$k,D$j):D$es.renderObjectCullingNoBoundFrustum(this,D$Y,D$m,D$k,D$j),D$T=0,D$U=this._quenes.length;D$T<D$U;D$T++)this._quenes[D$T]&&this._quenes[D$T]._preRender(D$r)},D$s._clear=function(D$s,D$r){var D$e=D$r._viewport,D$U=D$r.camera,D$m=D$e.x,D$k=D$U.renderTargetSize.height-D$e.y-D$e.height,D$j=D$e.width,D$T=D$e.height;D$s.viewport(D$m,D$k,D$j,D$T);var D$Y=256,D$Z=D$U.renderTarget;switch(D$U.clearFlag){case 0:var D$h=D$U.clearColor;if(D$h){D$s.enable(3089),D$s.scissor(D$m,D$k,D$j,D$T);var D$H=D$h.elements;D$s.clearColor(D$H[0],D$H[1],D$H[2],D$H[3]),D$Y|=16384}if(D$Z)switch(D$h||(D$Y=16384),D$Z.depthStencilFormat){case 33189:D$Y|=256;break;case 36168:D$Y|=1024;break;case 34041:D$Y|=256,D$Y|=1024}D$s.clear(D$Y),D$h&&D$s.disable(3089);break;case 1:case 2:if(D$Z)switch(D$Y=16384,D$Z.depthStencilFormat){case 33189:D$Y|=256;break;case 36168:D$Y|=1024;break;case 34041:D$Y|=256,D$Y|=1024}D$s.clear(D$Y);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},D$s._renderScene=function(D$s,D$r){var D$e,D$U,D$m=D$r.camera,D$k=0;for(D$k=0;D$k<2;D$k++)(D$U=this._quenes[D$k])&&(D$m.renderTarget?D$U._render(D$r,!0):D$U._render(D$r,!1));if(1===D$m.clearFlag){var D$j=D$m.sky;D$j&&(D$O.setCullFace(D$s,!1),D$O.setDepthFunc(D$s,515),D$O.setDepthMask(D$s,!1),D$j._render(D$r),D$O.setDepthFunc(D$s,513),D$O.setDepthMask(D$s,!0))}for(D$k=2,D$e=this._quenes.length;D$k<D$e;D$k++)(D$U=this._quenes[D$k])&&(D$U._sortAlpha(D$r.camera.transform.position),D$m.renderTarget?D$U._render(D$r,!0):D$U._render(D$r,!1))},D$s._set3DRenderConfig=function(D$s){D$s.disable(3042),D$O._blend=!1,D$s.blendFunc(770,771),D$O._sFactor=770,D$O._dFactor=771,D$s.disable(2929),D$O._depthTest=!1,D$s.enable(2884),D$O._cullFace=!0,D$s.depthMask(1),D$O._depthMask=!0,D$s.frontFace(2304),D$O._frontFace=2304},D$s._set2DRenderConfig=function(D$s){D$O.setBlend(D$s,!0),D$O.setBlendFunc(D$s,1,771),D$O.setDepthTest(D$s,!1),D$O.setCullFace(D$s,!1),D$O.setDepthMask(D$s,!0),D$O.setFrontFace(D$s,2305),D$s.viewport(0,0,D$h.width,D$h.height)},D$s._parseCustomProps=function(D$s,D$r,D$e,D$U){var D$m=D$U.customProps.lightmaps,D$k=D$m.length,D$j=this._lightmaps;D$j.length=D$k;for(var D$T=0;D$T<D$k;D$T++)D$j[D$T]=D$V.getRes(D$r[D$m[D$T].replace(".exr",".png")]);this.setlightmaps(D$j);var D$Y=D$U.customProps.ambientColor;D$Y&&(this.ambientColor=new D$jr(D$Y[0],D$Y[1],D$Y[2]));var D$Z=D$U.customProps.fogColor;D$Z&&(this.fogColor=new D$jr(D$Z[0],D$Z[1],D$Z[2]))},D$s._addLight=function(D$s){this._lights.indexOf(D$s)<0&&this._lights.push(D$s)},D$s._removeLight=function(D$s){var D$r=this._lights.indexOf(D$s);0<=D$r&&this._lights.splice(D$r,1)},D$s._updateScene=function(){var D$s=this._renderState;this._prepareUpdateToRenderState(D$P.mainContext,D$s),this._updateComponents(D$s),this._updateChilds(D$s),this._lateUpdateComponents(D$s),this._time+=D$s.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},D$s._updateSceneConch=function(){var D$s=this._renderState;this._prepareUpdateToRenderState(D$P.mainContext,D$s),this._updateComponents(D$s),this._lateUpdateComponents(D$s),this._prepareSceneToRender(D$s);for(var D$r=0,D$e=this._cameraPool.length;D$r<D$e;D$r++){var D$U=this._cameraPool[D$r];(D$s.camera=D$U)._prepareCameraToRender()}},D$s._preRenderShadow=function(D$s,D$r,D$e,D$U,D$m){this.treeRoot?D$es.renderShadowObjectCullingOctree(this,D$r,D$e,D$U,D$m):D$es.renderShadowObjectCulling(this,D$r,D$e,D$U,D$m);for(var D$k=0,D$j=D$e.length;D$k<D$j;D$k++)D$e[D$k]&&D$e[D$k]._preRender(D$s)},D$s._renderShadowMap=function(D$s,D$r,D$e){var D$U=this.parallelSplitShadowMaps[0];D$U._calcAllLightCameraInfo(D$e);var D$m,D$k,D$j,D$T=D$U.PSSMNum;if(this._preRenderShadow(D$r,D$U._lightCulling,D$U._shadowQuenes,D$U._lightVPMatrix[0],D$T),this.addShaderDefine(D$xr.SHADERDEFINE_CAST_SHADOW),1<D$T)for(var D$Y=0;D$Y<D$T;D$Y++)D$m=D$U.getRenderTarget(D$Y+1),D$U.beginRenderTarget(D$Y+1),D$s.clearColor(1,1,1,1),D$s.clear(16640),D$s.viewport(0,0,D$m.width,D$m.height),D$r.camera=D$j=D$U.getLightCamera(D$Y),D$j._prepareCameraToRender(),D$j._prepareCameraViewProject(D$j.viewMatrix,D$j.projectionMatrix),D$r._projectionViewMatrix=D$U._lightVPMatrix[D$Y+1],(D$k=D$U._shadowQuenes[D$Y])._preRender(D$r),D$k._renderShadow(D$r,!1),D$U.endRenderTarget(D$Y+1);else D$m=D$U.getRenderTarget(1),D$U.beginRenderTarget(1),D$s.clearColor(1,1,1,1),D$s.clear(16640),D$s.viewport(0,0,D$m.width,D$m.height),D$r.camera=D$j=D$U.getLightCamera(0),D$j._prepareCameraToRender(),D$j._prepareCameraViewProject(D$j.viewMatrix,D$j.projectionMatrix),D$r._projectionViewMatrix=D$U._lightVPMatrix[0],(D$k=D$U._shadowQuenes[0])._preRender(D$r),D$k._renderShadow(D$r,!0),D$U.endRenderTarget(1);this.removeShaderDefine(D$xr.SHADERDEFINE_CAST_SHADOW)},D$s.addTreeNode=function(D$s){this.treeRoot.addTreeNode(D$s)},D$s.removeTreeNode=function(D$s){this.treeSize&&D$s._treeNode&&D$s._treeNode.removeObject(D$s)},D$s.setlightmaps=function(D$s){this._lightmaps=D$s;for(var D$r=0,D$e=this._renderableSprite3Ds.length;D$r<D$e;D$r++)this._renderableSprite3Ds[D$r]._render._applyLightMapParams()},D$s.getlightmaps=function(){return this._lightmaps},D$s.addChildAt=function(D$s,D$r){if(!(D$s instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(D$s&&D$s.__className));if(!D$s||this.destroyed||D$s===this)return D$s;if(D$s.zOrder&&this._set$P("hasZorder",!0),0<=D$r&&D$r<=this._childs.length){if(D$s._parent===this){var D$e=this.getChildIndex(D$s);this._childs.splice(D$e,1),this._childs.splice(D$r,0,D$s),this.conchModel&&(this.conchModel.removeChild(D$s.conchModel),this.conchModel.addChildAt(D$s.conchModel,D$r)),this._childChanged()}else D$s.parent&&D$s.parent.removeChild(D$s),this._childs===D$Z.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(D$r,0,D$s),this.conchModel&&this.conchModel.addChildAt(D$s.conchModel,D$r),(D$s.parent=this)._addChild3D(D$s);return D$s}throw new Error("appendChildAt:The index is out of bounds")},D$s.addChild=function(D$s){if(!(D$s instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!D$s||this.destroyed||D$s===this)return D$s;if(D$s.zOrder&&this._set$P("hasZorder",!0),D$s._parent===this){var D$r=this.getChildIndex(D$s);D$r!==this._childs.length-1&&(this._childs.splice(D$r,1),this._childs.push(D$s),this.conchModel&&(this.conchModel.removeChild(D$s.conchModel),this.conchModel.addChildAt(D$s.conchModel,this._childs.length-1)),this._childChanged())}else D$s.parent&&D$s.parent.removeChild(D$s),this._childs===D$Z.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(D$s),this.conchModel&&this.conchModel.addChildAt(D$s.conchModel,this._childs.length-1),(D$s.parent=this)._childChanged(),this._addChild3D(D$s);return D$s},D$s.removeChildAt=function(D$s){var D$r=this.getChildAt(D$s);return D$r&&(this._removeChild3D(D$r),this._childs.splice(D$s,1),this.conchModel&&this.conchModel.removeChild(D$r.conchModel),D$r.parent=null),D$r},D$s.removeChildren=function(D$s,D$r){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=2147483647),this._childs&&0<this._childs.length){var D$e=this._childs;if(0===D$s&&D$k<=D$r){var D$U=D$e;this._childs=D$Z.ARRAY_EMPTY}else D$U=D$e.splice(D$s,D$r-D$s);for(var D$m=0,D$k=D$U.length;D$m<D$k;D$m++)this._removeChild3D(D$U[D$m]),D$U[D$m].parent=null,this.conchModel&&this.conchModel.removeChild(D$U[D$m].conchModel)}return this},D$s.addFrustumCullingObject=function(D$s){this.treeRoot?this.addTreeNode(D$s):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(D$s):this._cullingRenders[this._cullingRendersLength]=D$s,D$s._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},D$s.removeFrustumCullingObject=function(D$s){if(this.treeRoot)this.removeTreeNode(D$s);else{this._cullingRendersLength--;var D$r=D$s._indexInSceneFrustumCullingObjects;if(D$r!==this._cullingRendersLength){var D$e=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[D$r]=D$e)._indexInSceneFrustumCullingObjects=D$r,D$s._indexInSceneFrustumCullingObjects=-1}}},D$s.getRenderQueue=function(D$s){return D$s<3e3?this._quenes[1]||(this._quenes[1]=new D$t(this)):this._quenes[2]||(this._quenes[2]=new D$t(this))},D$s.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new D$t(this)},D$s.addShaderDefine=function(D$s){this._shaderDefineValue|=D$s},D$s.removeShaderDefine=function(D$s){this._shaderDefineValue&=~D$s},D$s.addScript=function(D$s){return this._addComponent(D$s)},D$s.getScriptByType=function(D$s,D$r){return void 0===D$r&&(D$r=0),this._getComponentByType(D$s,D$r)},D$s.getScriptsByType=function(D$s,D$r){this._getComponentsByType(D$s,D$r)},D$s.getScriptByIndex=function(D$s){return this._getComponentByIndex(D$s)},D$s.removeScriptByType=function(D$s,D$r){void 0===D$r&&(D$r=0),this._removeComponentByType(D$s,D$r)},D$s.removeScriptsByType=function(D$s){this._removeComponentByType(D$s)},D$s.removeAllScript=function(){this._removeAllComponent()},D$s.render=function(D$s,D$r,D$e){(D$$._context.ctx._renderKey=0)<this._childs.length&&D$s.addRenderObject(this)},D$s.renderSubmit=function(){var D$s=D$P.mainContext,D$r=this._renderState;this._set3DRenderConfig(D$s),this._prepareSceneToRender(this._renderState);var D$e,D$U=0,D$m=0;if(D$Vr.debugMode||D$L.debugMode)for(D$U=0,D$m=this._cameraPool.length;D$U<D$m;D$U++)D$e=this._cameraPool[D$U],D$Vr._debugPhasorSprite.begin(1,D$e),D$e.activeInHierarchy&&D$e._renderCamera(D$s,D$r,this),D$Vr._debugPhasorSprite.end();else for(D$U=0,D$m=this._cameraPool.length;D$U<D$m;D$U++)(D$e=this._cameraPool[D$U]).activeInHierarchy&&D$e._renderCamera(D$s,D$r,this);return this._set2DRenderConfig(D$s),1},D$s.onAsynLoaded=function(D$s,D$r,D$e){var D$U=D$r[0];if("Scene"!==D$U.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var D$m=D$r[1];D$lr._createNodeByJson(this,D$U,this,D$m),this.event("hierarchyloaded",[this]),this.__loaded=!0},D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),this.destroyed||(D$r.prototype.destroy.call(this,D$s),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,D$V.clearRes(this.url),this.loaded||D$Vr._cancelLoadByUrl(this.url))},D$s.getRenderType=function(){return 0},D$s.releaseRender=function(){},D$s._addComponent=function(D$s){var D$r,D$e=this._componentsMap.indexOf(D$s);if(-1===D$e)D$r=[],this._componentsMap.push(D$s),this._typeComponentsIndices.push(D$r);else if(D$r=this._typeComponentsIndices[D$e],this._components[D$r[0]].isSingleton)throw new Error("无法单实例创建"+D$s+"组件，"+D$s+"组件已存在！");var D$U=D$m.getInstance(D$s);D$r.push(this._components.length),this._components.push(D$U);return D$U._initialize(this),D$U},D$s._removeComponent=function(D$s,D$r){var D$e=this._typeComponentsIndices[D$s],D$U=D$e[D$r],D$m=this._components[D$U];this._components.splice(D$U,1),D$e.splice(D$r,1),0===D$e.length&&(this._typeComponentsIndices.splice(D$s,1),this._componentsMap.splice(D$s,1));for(var D$k=0,D$j=this._componentsMap.length;D$k<D$j;D$k++)for(var D$T=(D$e=this._typeComponentsIndices[D$k]).length-1;0<=D$T;D$T--){var D$Y=D$e[D$T];if(!(D$U<D$Y))break;D$e[D$T]=--D$Y}D$m._destroy()},D$s._getComponentByType=function(D$s,D$r){void 0===D$r&&(D$r=0);var D$e=this._componentsMap.indexOf(D$s);return-1===D$e?null:this._components[this._typeComponentsIndices[D$e][D$r]]},D$s._getComponentsByType=function(D$s,D$r){var D$e=this._componentsMap.indexOf(D$s);if(-1!==D$e){var D$U=this._typeComponentsIndices[D$e],D$m=D$U.length;D$r.length=D$m;for(var D$k=0;D$k<D$m;D$k++)D$r[D$k]=this._components[D$U[D$k]]}else D$r.length=0},D$s._getComponentByIndex=function(D$s){return this._components[D$s]},D$s._removeComponentByType=function(D$s,D$r){void 0===D$r&&(D$r=0);var D$e=this._componentsMap.indexOf(D$s);-1!==D$e&&this._removeComponent(D$e,D$r)},D$s._removeComponentsByType=function(D$s){var D$r=this._componentsMap.indexOf(D$s);if(-1!==D$r)for(var D$e=this._typeComponentsIndices[D$r],D$U=0,D$m=D$e.length;D$U<D$m;D$e.length<D$m?D$m--:D$U++)this._removeComponent(D$r,D$U)},D$s._removeAllComponent=function(){for(var D$s=0,D$r=this._componentsMap.length;D$s<D$r;this._componentsMap.length<D$r?D$r--:D$s++)this._removeComponentsByType(this._componentsMap[D$s])},D$s._updateComponents=function(D$s){for(var D$r=0,D$e=this._components.length;D$r<D$e;D$r++){var D$U=this._components[D$r];!D$U.started&&(D$U._start(D$s),D$U.started=!0),D$U.enable&&D$U._update(D$s)}},D$s._lateUpdateComponents=function(D$s){for(var D$r=0;D$r<this._components.length;D$r++){var D$e=this._components[D$r];!D$e.started&&(D$e._start(D$s),D$e.started=!0),D$e.enable&&D$e._lateUpdate(D$s)}},D$s._preRenderUpdateComponents=function(D$s){for(var D$r=0;D$r<this._components.length;D$r++){var D$e=this._components[D$r];!D$e.started&&(D$e._start(D$s),D$e.started=!0),D$e.enable&&D$e._preRenderUpdate(D$s)}},D$s._postRenderUpdateComponents=function(D$s){for(var D$r=0;D$r<this._components.length;D$r++){var D$e=this._components[D$r];!D$e.started&&(D$e._start(D$s),D$e.started=!0),D$e.enable&&D$e._postRenderUpdate(D$s)}},D$B(0,D$s,"_loaded",null,function(D$s){this.__loaded=D$s}),D$B(0,D$s,"fogColor",function(){return this._fogColor},function(D$s){this._fogColor=D$s,this._shaderValues.setValue(0,D$s.elements)}),D$B(0,D$s,"enableFog",function(){return this._enableFog},function(D$s){this._enableFog!==D$s&&((this._enableFog=D$s)?(this.addShaderDefine(D$nr.SHADERDEFINE_FOG),this.removeShaderDefine(D$nr.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(D$nr.SHADERDEFINE_FOG))}),D$B(0,D$s,"url",function(){return this._url}),D$B(0,D$s,"loaded",function(){return this.__loaded}),D$B(0,D$s,"enableDepthFog",function(){return this._enableDepthFog},function(D$s){this._enableDepthFog!=D$s&&((this._enableDepthFog=D$s)?(this.addShaderDefine(D$nr.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(D$nr.SHADERDEFINE_FOG)):this.removeShaderDefine(D$nr.SAHDERDEFINE_DEPTHFOG))}),D$B(0,D$s,"fogStart",function(){return this._fogStart},function(D$s){this._fogStart=D$s,this._shaderValues.setValue(1,D$s)}),D$B(0,D$s,"fogRange",function(){return this._fogRange},function(D$s){this._fogRange=D$s,this._shaderValues.setValue(2,D$s)}),D$B(0,D$s,"ambientColor",function(){return this._ambientColor},function(D$s){this._ambientColor=D$s,this._shaderValues.setValue(21,D$s.elements)}),D$B(0,D$s,"scene",function(){return this}),D$B(0,D$s,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),D$U._sortScenes=function(D$s,D$r){if(D$s.parent!==D$w.stage||D$r.parent!==D$w.stage)return D$s.parent!==D$w.stage&&D$r.parent!==D$w.stage?D$U._sortScenes(D$s.parent,D$r.parent):D$s.parent===D$w.stage?-1:1;var D$e=D$w.stage._childs;return D$e.indexOf(D$s)-D$e.indexOf(D$r)},D$U.load=function(D$s){return D$w.loader.create(D$s,null,null,D$U)},D$U.FOGCOLOR=0,D$U.FOGSTART=1,D$U.FOGRANGE=2,D$U.LIGHTDIRECTION=3,D$U.LIGHTDIRCOLOR=4,D$U.POINTLIGHTPOS=5,D$U.POINTLIGHTRANGE=6,D$U.POINTLIGHTATTENUATION=7,D$U.POINTLIGHTCOLOR=8,D$U.SPOTLIGHTPOS=9,D$U.SPOTLIGHTDIRECTION=10,D$U.SPOTLIGHTSPOT=11,D$U.SPOTLIGHTRANGE=12,D$U.SPOTLIGHTATTENUATION=13,D$U.SPOTLIGHTCOLOR=14,D$U.SHADOWDISTANCE=15,D$U.SHADOWLIGHTVIEWPROJECT=16,D$U.SHADOWMAPPCFOFFSET=17,D$U.SHADOWMAPTEXTURE1=18,D$U.SHADOWMAPTEXTURE2=19,D$U.SHADOWMAPTEXTURE3=20,D$U.AMBIENTCOLOR=21,D$U.TIME=22,D$U}(D$D),D$Er=function(D$s){function D$r(D$s){D$r.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new D$sr,this._shaderValues=new D$Ar,this._colliders=[],this._id=++D$r._uniqueIDCounter,this._transform=new D$Xr(this),this.name=D$s||"Sprite3D-"+D$r._nameNumberCounter++,this.layer=D$K.currentCreationLayer,this.active=!0}D$x(D$r,"laya.d3.core.Sprite3D",D$fr);var D$e=D$r.prototype;return D$w.imps(D$e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),D$e._setUrl=function(D$s){this._url=D$s},D$e._getGroup=function(){return this._group},D$e._setGroup=function(D$s){this._group=D$s},D$e._addChild3D=function(D$s){D$s.transform.parent=this.transform,this._hierarchyAnimator&&(!D$s._hierarchyAnimator&&D$s._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(D$s,!0,[D$s.name])),this._scene&&(D$s._setBelongScene(this._scene),this._activeInHierarchy&&D$s._active&&D$s._activeHierarchy())},D$e._removeChild3D=function(D$s){D$s.transform.parent=null,this._scene&&(this._activeInHierarchy&&D$s._active&&D$s._inActiveHierarchy(),D$s._setUnBelongScene()),this._hierarchyAnimator&&(D$s._hierarchyAnimator==this._hierarchyAnimator&&D$s._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(D$s,!1,[D$s.name]))},D$e._parseBaseCustomProps=function(D$s){var D$r=this.transform.localPosition;D$s.translate?(D$r.fromArray(D$s.translate),D$r.x*=100,D$r.y*=100,D$r.z*=100):D$r.elements.fill(0),this.transform.localPosition=D$r;var D$e=this.transform.localRotation;D$s.rotation?D$e.fromArray(D$s.rotation):D$e.fromArray([0,0,0,-1]),this.transform.localRotation=D$e;var D$U=this.transform.localScale;D$s.scale?D$U.fromArray(D$s.scale):D$U.elements.fill(1),this.transform.localScale=D$U;var D$m=D$s.layer;null!=D$m&&(this.layer=D$K.getLayerByNumber(D$m))},D$e._parseCustomComponent=function(D$s,D$r,D$e){for(var D$U in D$e){var D$m=D$e[D$U];switch(D$U){case"Animator":var D$k=this.addComponent(Animator);if(D$m.avatarPath)D$k.avatar=D$V.getRes(D$r[D$m.avatarPath]);else{var D$j=D$m.avatar;if(D$j){D$k.avatar=D$V.getRes(D$r[D$j.path]);var D$T=D$j.linkSprites;D$T&&D$s.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[D$k,D$T])}}for(var D$Y=D$m.clipPaths,D$Z=D$Y.length,D$h=0;D$h<D$Z;D$h++)D$k.addClip(D$V.getRes(D$r[D$Y[D$h]]));D$k.clip=D$V.getRes(D$r[D$Y[0]]);var D$H=D$m.playOnWake;void 0!==D$H&&(D$k.playOnWake=D$H);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var D$A=this.addComponent(SphereCollider);D$A.isTrigger=D$m.isTrigger;var D$x=D$A.center;D$x.fromArray(D$m.center),D$A.center=D$x,D$A.radius=D$m.radius;break;case"BoxCollider":var D$B=this.addComponent(BoxCollider);D$B.isTrigger=D$m.isTrigger,D$B.center.fromArray(D$m.center);var D$$=D$B.size;D$$.fromArray(D$m.size),D$B.size=D$$;break;case"MeshCollider":this.addComponent(MeshCollider)}}},D$e._onRootNodeHierarchyLoaded=function(D$s,D$r){for(var D$e in D$r){for(var D$U=this,D$m=D$r[D$e],D$k=0,D$j=D$m.length;D$k<D$j;D$k++){var D$T=D$m[D$k];if(""===D$T)break;if(!(D$U=D$U.getChildByName(D$T)))break}D$U&&D$s.linkSprite3DToAvatarNode(D$e,D$U)}},D$e._setHierarchyAnimator=function(D$s,D$r){this._changeHierarchyAnimator(D$s);for(var D$e=0,D$U=this._childs.length;D$e<D$U;D$e++){var D$m=this._childs[D$e];D$m._hierarchyAnimator==D$r&&D$m._setHierarchyAnimator(D$s,D$r)}},D$e._clearHierarchyAnimator=function(D$s,D$r){this._changeHierarchyAnimator(D$r);for(var D$e=0,D$U=this._childs.length;D$e<D$U;D$e++){var D$m=this._childs[D$e];D$m._hierarchyAnimator==D$s&&D$m._clearHierarchyAnimator(D$s,D$r)}},D$e._getAnimatorToLinkSprite3D=function(D$s,D$r,D$e){var D$U=this.getComponentByType(Animator);if(D$U&&(D$U.avatar?D$U.avatar._version||D$s._setAnimatorToLinkAvatar(D$U,D$r):D$s._setAnimatorToLinkSprite3DNoAvatar(D$U,D$r,D$e)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){D$e.unshift(this._parent.name);var D$m=this._parent;D$m._hierarchyAnimator&&D$m._getAnimatorToLinkSprite3D(D$s,D$r,D$e)}},D$e._setAnimatorToLinkSprite3DNoAvatar=function(D$s,D$r,D$e){var D$U=0,D$m=0;for(D$U=0,D$m=D$s.getClipCount();D$U<D$m;D$U++)D$s._handleSpriteOwnersBySprite(D$U,D$r,D$e,this);for(D$U=0,D$m=this._childs.length;D$U<D$m;D$U++){var D$k=this._childs[D$U],D$j=D$e.length;D$e.push(D$k.name),D$k._setAnimatorToLinkSprite3DNoAvatar(D$s,D$r,D$e),D$e.splice(D$j,1)}},D$e._changeHierarchyAnimator=function(D$s){this._hierarchyAnimator=D$s},D$e._isLinkSpriteToAnimationNode=function(D$s,D$r,D$e){var D$U=D$s._avatarNodes.indexOf(D$r),D$m=D$s._cacheSpriteToNodesMap;if(D$e)this._transform.dummy=D$r.transform,D$s._cacheNodesToSpriteMap[D$U]=D$m.length,D$m.push(D$U);else{this._transform.dummy=null;var D$k=D$s._cacheNodesToSpriteMap[D$U];D$s._cacheNodesToSpriteMap[D$U]=null,D$m.splice(D$k,1)}},D$e._setBelongScene=function(D$s){this._scene=D$s;for(var D$r=0,D$e=this._childs.length;D$r<D$e;D$r++)this._childs[D$r]._setBelongScene(D$s)},D$e._setUnBelongScene=function(){this._scene=null;for(var D$s=0,D$r=this._childs.length;D$s<D$r;D$s++)this._childs[D$s]._setUnBelongScene()},D$e._activeHierarchy=function(){var D$s=0,D$r=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),D$s=0,D$r=this._colliders.length;D$s<D$r;D$s++)this._layer._addCollider(this._colliders[D$s]);for(this.event("activeinhierarchychanged",!0),D$s=0,D$r=this._childs.length;D$s<D$r;D$s++){var D$e=this._childs[D$s];D$e._active&&D$e._activeHierarchy()}},D$e._inActiveHierarchy=function(){var D$s=0,D$r=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),D$s=0,D$r=this._colliders.length;D$s<D$r;D$s++){var D$e=this._colliders[D$s];D$e._clearCollsionMap(),this._layer._removeCollider(D$e)}for(this.event("activeinhierarchychanged",!1),D$s=0,D$r=this._childs.length;D$s<D$r;D$s++){var D$U=this._childs[D$s];D$U._active&&D$U._inActiveHierarchy()}},D$e.addComponent=function(D$s){var D$r,D$e=this._componentsMap.indexOf(D$s);if(-1===D$e)D$r=[],this._componentsMap.push(D$s),this._typeComponentsIndices.push(D$r);else if(D$r=this._typeComponentsIndices[D$e],this._components[D$r[0]].isSingleton)throw new Error("无法单实例创建"+D$s+"组件，"+D$s+"组件已存在！");var D$U=D$m.getInstance(D$s);return D$r.push(this._components.length),this._components.push(D$U),D$U instanceof laya.d3.component.Script&&this._scripts.push(D$U),D$U._initialize(this),D$U},D$e._removeComponent=function(D$s,D$r){var D$e,D$U=0,D$m=this._typeComponentsIndices[D$s],D$k=D$m[D$r],D$j=this._components[D$k];for(D$j instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(D$j),1),D$m.splice(D$r,1),0===D$m.length&&(this._typeComponentsIndices.splice(D$s,1),this._componentsMap.splice(D$s,1)),D$U=0,D$e=this._componentsMap.length;D$U<D$e;D$U++)for(var D$T=(D$m=this._typeComponentsIndices[D$U]).length-1;0<=D$T;D$T--){var D$Y=D$m[D$T];if(!(D$k<D$Y))break;D$m[D$T]=--D$Y}D$j._destroy()},D$e._clearSelfRenderObjects=function(){},D$e._addSelfRenderObjects=function(){},D$e._parseCustomProps=function(D$s,D$r,D$e,D$U){},D$e._updateChilds=function(D$s){var D$r=this._childs.length;if(0!==D$r)for(var D$e=0;D$e<D$r;++D$e)this._childs[D$e]._update(D$s)},D$e._getSortID=function(D$s,D$r){return 1e3*D$r.id+D$s._getVertexBuffer().vertexDeclaration.id},D$e._update=function(D$s){(D$s.owner=this)._activeInHierarchy&&(this._updateComponents(D$s),this._lateUpdateComponents(D$s),D$n.spriteCount++,this._childs.length&&this._updateChilds(D$s))},D$e.getProjectionViewWorldMatrix=function(D$s){return D$sr.multiply(D$s,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},D$e.loadHierarchy=function(D$s){this.addChild(laya.d3.core.Sprite3D.load(D$s))},D$e.addChildAt=function(D$s,D$r){if(!(D$s instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!D$s||this.destroyed||D$s===this)return D$s;if(D$s.zOrder&&this._set$P("hasZorder",!0),0<=D$r&&D$r<=this._childs.length){if(D$s._parent===this){var D$e=this.getChildIndex(D$s);this._childs.splice(D$e,1),this._childs.splice(D$r,0,D$s),this.conchModel&&(this.conchModel.removeChild(D$s.conchModel),this.conchModel.addChildAt(D$s.conchModel,D$r)),this._childChanged()}else D$s.parent&&D$s.parent.removeChild(D$s),this._childs===D$Z.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(D$r,0,D$s),this.conchModel&&this.conchModel.addChildAt(D$s.conchModel,D$r),(D$s.parent=this)._addChild3D(D$s);return D$s}throw new Error("appendChildAt:The index is out of bounds")},D$e.addChild=function(D$s){if(!(D$s instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!D$s||this.destroyed||D$s===this)return D$s;if(D$s.zOrder&&this._set$P("hasZorder",!0),D$s._parent===this){var D$r=this.getChildIndex(D$s);D$r!==this._childs.length-1&&(this._childs.splice(D$r,1),this._childs.push(D$s),this.conchModel&&(this.conchModel.removeChild(D$s.conchModel),this.conchModel.addChildAt(D$s.conchModel,this._childs.length-1)),this._childChanged())}else D$s.parent&&D$s.parent.removeChild(D$s),this._childs===D$Z.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(D$s),this.conchModel&&this.conchModel.addChildAt(D$s.conchModel,this._childs.length-1),(D$s.parent=this)._childChanged(),this._addChild3D(D$s);return D$s},D$e.removeChildAt=function(D$s){var D$r=this.getChildAt(D$s);return D$r&&(this._removeChild3D(D$r),this._childs.splice(D$s,1),this.conchModel&&this.conchModel.removeChild(D$r.conchModel),D$r.parent=null),D$r},D$e.removeChildren=function(D$s,D$r){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=2147483647),this._childs&&0<this._childs.length){var D$e=this._childs;if(0===D$s&&D$k<=D$r){var D$U=D$e;this._childs=D$Z.ARRAY_EMPTY}else D$U=D$e.splice(D$s,D$r-D$s);for(var D$m=0,D$k=D$U.length;D$m<D$k;D$m++)this._removeChild3D(D$U[D$m]),D$U[D$m].parent=null,this.conchModel&&this.conchModel.removeChild(D$U[D$m].conchModel)}return this},D$e.onAsynLoaded=function(D$s,D$r,D$e){var D$U=D$r[0];if("Sprite3D"!==D$U.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var D$m=D$r[1];D$lr._createNodeByJson(this,D$U,this,D$m),this.event("hierarchyloaded",[this]),this.__loaded=!0},D$e.cloneTo=function(D$s){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var D$r=D$s;D$r.name=this.name,D$r._destroyed=this._destroyed,D$r.timer=this.timer,D$r._$P=this._$P,D$r.active=this._active;var D$e=D$r.transform.localPosition;this.transform.localPosition.cloneTo(D$e),D$r.transform.localPosition=D$e;var D$U=D$r.transform.localRotation;this.transform.localRotation.cloneTo(D$U),D$r.transform.localRotation=D$U;var D$m=D$r.transform.localScale;this.transform.localScale.cloneTo(D$m),D$r.transform.localScale=D$m,D$r.isStatic=this.isStatic;var D$k=0,D$j=0;for(D$k=0,D$j=this._componentsMap.length;D$k<D$j;D$k++){var D$T=D$r.addComponent(this._componentsMap[D$k]);this._components[D$k]._cloneTo(D$T)}for(D$k=0,D$j=this._childs.length;D$k<D$j;D$k++)D$r.addChild(this._childs[D$k].clone());var D$Y=D$r.getComponentByType(Animator);if(D$Y){var D$Z=D$Y._linkSpritesData;if(D$Z)for(var D$h in D$Z){for(var D$H=D$Z[D$h],D$A=D$r,D$x=0,D$B=D$H.length;D$x<D$B&&(D$A=D$A.getChildByName(D$H[D$x]));D$x++);if(D$A){var D$$=D$Y._avatarNodeMap[D$h];D$A._isLinkSpriteToAnimationNode(D$Y,D$$,!0)}}}},D$e.clone=function(){var D$s=new this.constructor;return this.cloneTo(D$s),D$s},D$e.destroy=function(D$s){if(void 0===D$s&&(D$s=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,D$s);var D$r,D$e=0;for(D$e=0,D$r=this._components.length;D$e<D$r;D$e++)this._components[D$e]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,D$V.clearRes(this.url),this.loaded||D$Vr._cancelLoadByUrl(this.url)}},D$e._handleSpriteToAvatar=function(D$s,D$r){D$s._avatarNodes;var D$e=D$s._avatarNodeMap[this.name];D$e&&D$e.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(D$s,D$e,D$r)},D$e._setAnimatorToLinkAvatar=function(D$s,D$r){this._handleSpriteToAvatar(D$s,D$r);for(var D$e=0,D$U=this._childs.length;D$e<D$U;D$e++){this._childs[D$e]._setAnimatorToLinkAvatar(D$s,D$r)}},D$B(0,D$e,"activeInHierarchy",function(){return this._activeInHierarchy}),D$B(0,D$e,"_loaded",null,function(D$s){this.__loaded=D$s}),D$B(0,D$e,"active",function(){return this._active},function(D$s){this._active!==D$s&&(this._active=D$s,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(D$s?this._activeHierarchy():this._inActiveHierarchy()))}),D$B(0,D$e,"componentsCount",function(){return this._components.length}),D$B(0,D$e,"loaded",function(){return this.__loaded}),D$B(0,D$e,"id",function(){return this._id}),D$B(0,D$e,"url",function(){return this._url}),D$B(0,D$e,"layer",function(){return this._layer},function(D$s){if(this._layer!==D$s){if(!D$s)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var D$r=0,D$e=this._colliders.length;if(this._layer)for(D$r=0;D$r<D$e;D$r++)this._layer._removeCollider(this._colliders[D$r]);for(D$r=0;D$r<D$e;D$r++)D$s._addCollider(this._colliders[D$r])}this._layer=D$s,this.event("layerchanged",D$s)}}),D$B(0,D$e,"scene",function(){return this._scene}),D$B(0,D$e,"transform",function(){return this._transform}),D$r.instantiate=function(D$s,D$r,D$e,D$U,D$m){void 0===D$e&&(D$e=!0);var D$k=D$s.clone();D$r&&D$r.addChild(D$k);var D$j=D$k.transform;if(D$e){var D$T=D$j.worldMatrix;D$s.transform.worldMatrix.cloneTo(D$T),D$j.worldMatrix=D$T}else D$U&&(D$j.position=D$U),D$m&&(D$j.rotation=D$m);return D$k},D$r.load=function(D$s){return D$w.loader.create(D$s,null,null,D$r)},D$r.WORLDMATRIX=0,D$r.MVPMATRIX=1,D$r._uniqueIDCounter=0,D$r._nameNumberCounter=0,D$r}(),D$vr=function(D$s){function D$h(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],D$h.__super.call(this),!D$s||!D$r)throw"Shader Error";this._id=++D$h._count,this._vs=D$s,this._ps=D$r,this._attributeMap=D$e,this._sceneUniformMap=D$U,this._cameraUniformMap=D$m,this._spriteUniformMap=D$k,this._materialUniformMap=D$j,this._renderElementUniformMap=D$T,this._precompile=D$Y,this._define=D$Z,this._precompile&&D$h.extCompileObj&&D$h.extCompileFunc?D$h.extCompileFunc.call(D$h.extCompileObj,D$s,D$r,D$Z):this.recreateResource()}D$x(D$h,"laya.d3.shader.Shader3D",D$e);var D$r=D$h.prototype;return D$r.recreateResource=function(){D$i.now();this._compile(),this.completeCreate(),this.memorySize=0},D$r.disposeResource=function(){D$P.mainContext.deleteShader(this._vshader),D$P.mainContext.deleteShader(this._pshader),D$P.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},D$r._compile=function(){if(!D$P.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var D$s=[this._vs,this._ps],D$r=D$P.mainContext;if(this._program=D$r.createProgram(),this._vshader=D$h._createShader(D$r,D$s[0],35633),this._pshader=D$h._createShader(D$r,D$s[1],35632),D$r.attachShader(this._program,this._vshader),D$r.attachShader(this._program,this._pshader),D$r.linkProgram(this._program),!D$$.isConchApp&&D$nr.debugMode&&!D$r.getProgramParameter(this._program,35714))throw D$r.getProgramInfoLog(this._program);var D$e,D$U=0,D$m=0,D$k=0;for(D$k=D$$.isConchApp?D$r.getProgramParameterEx(this._vs,this._ps,"",35721):D$r.getProgramParameter(this._program,35721),D$U=0;D$U<D$k;D$U++){var D$j=null;D$e={vartype:"attribute",ivartype:0,attrib:D$j=D$$.isConchApp?D$r.getActiveAttribEx(this._vs,this._ps,"",D$U):D$r.getActiveAttrib(this._program,D$U),location:D$r.getAttribLocation(this._program,D$j.name),name:D$j.name,type:D$j.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(D$e)}var D$T=0;for(D$T=D$$.isConchApp?D$r.getProgramParameterEx(this._vs,this._ps,"",35718):D$r.getProgramParameter(this._program,35718),D$U=0;D$U<D$T;D$U++){var D$Y=null;D$Y=D$$.isConchApp?D$r.getActiveUniformEx(this._vs,this._ps,"",D$U):D$r.getActiveUniform(this._program,D$U),0<(D$e={vartype:"uniform",ivartype:1,attrib:D$j,location:D$r.getUniformLocation(this._program,D$Y.name),name:D$Y.name,type:D$Y.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(D$e.name=D$e.name.substr(0,D$e.name.length-3),D$e.isArray=!0,D$e.location=D$r.getUniformLocation(this._program,D$e.name)),this._uniformParams.push(D$e)}for(D$U=0,D$m=this._attributeParams.length;D$U<D$m;D$U++)(D$e=this._attributeParams[D$U]).indexOfParams=D$U,D$e.index=1,D$e.value=[D$e.location,null],D$e.codename=D$e.name,D$e.name=null!=this._attributeMap[D$e.codename]?this._attributeMap[D$e.codename]:D$e.codename,this._attributeParamsMap.push(D$e.name),this._attributeParamsMap.push(D$e),D$e._this=this,D$e.uploadedValue=[],D$e.fun=this._attribute;for(D$U=0,D$m=this._uniformParams.length;D$U<D$m;D$U++)switch((D$e=this._uniformParams[D$U]).indexOfParams=D$U,D$e.index=1,D$e.value=[D$e.location,null],D$e.codename=D$e.name,null!=this._sceneUniformMap[D$e.codename]?(D$e.name=this._sceneUniformMap[D$e.codename],this._sceneUniformParamsMap.push(D$e.name),this._sceneUniformParamsMap.push(D$e)):null!=this._cameraUniformMap[D$e.codename]?(D$e.name=this._cameraUniformMap[D$e.codename],this._cameraUniformParamsMap.push(D$e.name),this._cameraUniformParamsMap.push(D$e)):null!=this._spriteUniformMap[D$e.codename]?(D$e.name=this._spriteUniformMap[D$e.codename],this._spriteUniformParamsMap.push(D$e.name),this._spriteUniformParamsMap.push(D$e)):null!=this._materialUniformMap[D$e.codename]?(D$e.name=this._materialUniformMap[D$e.codename],this._materialUniformParamsMap.push(D$e.name),this._materialUniformParamsMap.push(D$e)):null!=this._renderElementUniformMap[D$e.codename]?(D$e.name=this._renderElementUniformMap[D$e.codename],this._renderElementUniformParamsMap.push(D$e.name),this._renderElementUniformParamsMap.push(D$e)):console.log("Shader:can't find uinform name:"+D$e.codename+" in shader file."),D$e._this=this,D$e.uploadedValue=[],D$e.type){case 5124:D$e.fun=D$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:D$e.fun=D$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:D$e.fun=D$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:D$e.fun=D$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:D$e.fun=D$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:D$e.fun=this._uniform_sampler2D;break;case 35680:D$e.fun=this._uniform_samplerCube;break;case 35676:D$e.fun=this._uniformMatrix4fv;break;case 35670:D$e.fun=this._uniform1i;break;case 35674:D$e.fun=this._uinformMatrix2fv;break;case 35675:D$e.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},D$r._attribute=function(D$s,D$r){var D$e=D$P.mainContext,D$U=D$T._enableAtributes,D$m=D$s.location;return D$U[D$m]||D$e.enableVertexAttribArray(D$m),D$e.vertexAttribPointer(D$m,D$r[0],D$r[1],D$r[2],D$r[3],D$r[4]),D$U[D$m]=D$T._bindVertexBuffer,1},D$r._uniform1f=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r?(D$P.mainContext.uniform1f(D$s.location,D$e[0]=D$r),1):0},D$r._uniform1fv=function(D$s,D$r){if(D$r.length<4){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$P.mainContext.uniform1fv(D$s.location,D$r),D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3],1):0}return D$P.mainContext.uniform1fv(D$s.location,D$r),1},D$r._uniform_vec2=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]?(D$P.mainContext.uniform2f(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1]),1):0},D$r._uniform_vec2v=function(D$s,D$r){if(D$r.length<2){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$P.mainContext.uniform2fv(D$s.location,D$r),D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3],1):0}return D$P.mainContext.uniform2fv(D$s.location,D$r),1},D$r._uniform_vec3=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]?(D$P.mainContext.uniform3f(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2]),1):0},D$r._uniform_vec3v=function(D$s,D$r){return D$P.mainContext.uniform3fv(D$s.location,D$r),1},D$r._uniform_vec4=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$P.mainContext.uniform4f(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3]),1):0},D$r._uniform_vec4v=function(D$s,D$r){return D$P.mainContext.uniform4fv(D$s.location,D$r),1},D$r._uniformMatrix2fv=function(D$s,D$r){return D$P.mainContext.uniformMatrix2fv(D$s.location,!1,D$r),1},D$r._uniformMatrix3fv=function(D$s,D$r){return D$P.mainContext.uniformMatrix3fv(D$s.location,!1,D$r),1},D$r._uniformMatrix4fv=function(D$s,D$r){return D$P.mainContext.uniformMatrix4fv(D$s.location,!1,D$r),1},D$r._uinformMatrix2fv=function(D$s,D$r){return D$P.mainContext.uniformMatrix2fv(D$s.location,!1,D$r),1},D$r._uinformMatrix3fv=function(D$s,D$r){return D$P.mainContext.uniformMatrix3fv(D$s.location,!1,D$r),1},D$r._uniform1i=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r?(D$P.mainContext.uniform1i(D$s.location,D$e[0]=D$r),1):0},D$r._uniform1iv=function(D$s,D$r){return D$P.mainContext.uniform1iv(D$s.location,D$r),1},D$r._uniform_ivec2=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]?(D$P.mainContext.uniform2i(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1]),1):0},D$r._uniform_ivec2v=function(D$s,D$r){return D$P.mainContext.uniform2iv(D$s.location,D$r),1},D$r._uniform_vec3i=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]?(D$P.mainContext.uniform3i(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2]),1):0},D$r._uniform_vec3vi=function(D$s,D$r){return D$P.mainContext.uniform3iv(D$s.location,D$r),1},D$r._uniform_vec4i=function(D$s,D$r){var D$e=D$s.uploadedValue;return D$e[0]!==D$r[0]||D$e[1]!==D$r[1]||D$e[2]!==D$r[2]||D$e[3]!==D$r[3]?(D$P.mainContext.uniform4i(D$s.location,D$e[0]=D$r[0],D$e[1]=D$r[1],D$e[2]=D$r[2],D$e[3]=D$r[3]),1):0},D$r._uniform_vec4vi=function(D$s,D$r){return D$P.mainContext.uniform4iv(D$s.location,D$r),1},D$r._uniform_sampler2D=function(D$s,D$r){var D$e=D$r.source||D$r.defaulteTexture.source,D$U=D$P.mainContext,D$m=D$s.uploadedValue;if(null!=D$m[0])return D$U.activeTexture(D$h._TEXTURES[D$m[0]]),D$e&&D$O.bindTexture(D$U,3553,D$e),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return D$m[0]=this._curActTexIndex,D$U.uniform1i(D$s.location,this._curActTexIndex),D$U.activeTexture(D$h._TEXTURES[this._curActTexIndex]),D$e&&D$O.bindTexture(D$U,3553,D$e),this._curActTexIndex++,1},D$r._uniform_samplerCube=function(D$s,D$r){var D$e=D$r.source||D$r.defaulteTexture.source,D$U=D$P.mainContext,D$m=D$s.uploadedValue;if(null!=D$m[0])return D$U.activeTexture(D$h._TEXTURES[D$m[0]]),D$e?D$O.bindTexture(D$U,34067,D$e):D$O.bindTexture(D$U,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return D$m[0]=this._curActTexIndex,D$U.uniform1i(D$s.location,this._curActTexIndex),D$U.activeTexture(D$h._TEXTURES[this._curActTexIndex]),D$e?D$O.bindTexture(D$U,34067,D$e):D$O.bindTexture(D$U,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},D$r._noSetValue=function(D$s){console.log("no....:"+D$s.name)},D$r.bind=function(){return D$e.activeShader=this,(D$e.bindShader=this).activeResource(),D$O.UseProgram(this._program)},D$r.uploadAttributes=function(D$s,D$r){for(var D$e,D$U,D$m=0,D$k=0,D$j=this._attributeParamsMap.length;D$k<D$j;D$k+=2)D$U=this._attributeParamsMap[D$k+1],null!=(D$e=D$s[this._attributeParamsMap[D$k]])&&(D$r&&D$r[D$U.name]&&D$r[D$U.name].bind(),D$m+=D$U.fun.call(this,D$U,D$e));D$n.shaderCall+=D$m},D$r.uploadAttributesX=function(D$s,D$r){for(var D$e,D$U,D$m=0,D$k=0,D$j=this._attributeParamsMap.length;D$k<D$j;D$k+=2)D$U=this._attributeParamsMap[D$k+1],null!=(D$e=D$s[this._attributeParamsMap[D$k]])&&(D$r._bind(),D$m+=D$U.fun.call(this,D$U,D$e));D$n.shaderCall+=D$m},D$r.uploadSceneUniforms=function(D$s){for(var D$r,D$e,D$U=0,D$m=0,D$k=this._sceneUniformParamsMap.length;D$m<D$k;D$m+=2)D$e=this._sceneUniformParamsMap[D$m+1],null!=(D$r=D$s[this._sceneUniformParamsMap[D$m]])&&(D$U+=D$e.fun.call(this,D$e,D$r));D$n.shaderCall+=D$U},D$r.uploadCameraUniforms=function(D$s){for(var D$r,D$e,D$U=0,D$m=0,D$k=this._cameraUniformParamsMap.length;D$m<D$k;D$m+=2)D$e=this._cameraUniformParamsMap[D$m+1],null!=(D$r=D$s[this._cameraUniformParamsMap[D$m]])&&(D$U+=D$e.fun.call(this,D$e,D$r));D$n.shaderCall+=D$U},D$r.uploadSpriteUniforms=function(D$s){for(var D$r,D$e,D$U=0,D$m=0,D$k=this._spriteUniformParamsMap.length;D$m<D$k;D$m+=2)D$e=this._spriteUniformParamsMap[D$m+1],null!=(D$r=D$s[this._spriteUniformParamsMap[D$m]])&&(D$U+=D$e.fun.call(this,D$e,D$r));D$n.shaderCall+=D$U},D$r.uploadMaterialUniforms=function(D$s){for(var D$r,D$e,D$U=0,D$m=0,D$k=this._materialUniformParamsMap.length;D$m<D$k;D$m+=2)D$e=this._materialUniformParamsMap[D$m+1],null!=(D$r=D$s[this._materialUniformParamsMap[D$m]])&&(D$U+=D$e.fun.call(this,D$e,D$r));D$n.shaderCall+=D$U},D$r.uploadRenderElementUniforms=function(D$s){for(var D$r,D$e,D$U=0,D$m=0,D$k=this._renderElementUniformParamsMap.length;D$m<D$k;D$m+=2)D$e=this._renderElementUniformParamsMap[D$m+1],null!=(D$r=D$s[this._renderElementUniformParamsMap[D$m]])&&(D$U+=D$e.fun.call(this,D$e,D$r));D$n.shaderCall+=D$U},D$h.create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){return new D$h(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z)},D$h.addInclude=function(D$s,D$r){D$o.addInclude(D$s,D$r)},D$h._createShader=function(D$s,D$r,D$e){var D$U=D$s.createShader(D$e);if(D$s.shaderSource(D$U,D$r),D$s.compileShader(D$U),D$nr.debugMode&&!D$s.getShaderParameter(D$U,35713))throw D$s.getShaderInfoLog(D$U);return D$U},D$h.PERIOD_RENDERELEMENT=0,D$h.PERIOD_MATERIAL=1,D$h.PERIOD_SPRITE=2,D$h.PERIOD_CAMERA=3,D$h.PERIOD_SCENE=4,D$h._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],D$h._count=0,D$h._preCompile=!1,D$h.extCompileFunc=null,D$h.extCompileObj=null,D$H(D$h,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new D$y}]),D$h}(),D$Sr=function(D$T){function D$Y(){this._transformUV=null,D$Y.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new D$jr(.6,.6,.6)),this._setColor(10,new D$jr(1,1,1)),this._setColor(11,new D$Tr(1,1,1,8)),this._setColor(12,new D$jr(1,1,1)),this._setColor(7,new D$Tr(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new D$Tr(1,1,0,0)),this.renderMode=1}D$x(D$Y,"laya.d3.core.material.StandardMaterial",D$T);var D$s=D$Y.prototype;return D$s.disableLight=function(){this._addDisablePublicShaderDefine(D$nr.SHADERDEFINE_POINTLIGHT|D$nr.SHADERDEFINE_SPOTLIGHT|D$nr.SHADERDEFINE_DIRECTIONLIGHT)},D$s.disableFog=function(){this._addDisablePublicShaderDefine(D$nr.SHADERDEFINE_FOG)},D$s.onAsynLoaded=function(D$s,D$r,D$e){var D$U=D$r[0];if(D$U.version)D$T.prototype.onAsynLoaded.call(this,D$s,D$r,D$e);else{var D$m=D$r[1],D$k=D$U.props;for(var D$j in D$k)this[D$j]=D$k[D$j];D$Y._parseStandardMaterial(D$m,this,D$U),this._endLoaded()}},D$s.cloneTo=function(D$s){D$T.prototype.cloneTo.call(this,D$s);var D$r=D$s;this._transformUV&&(D$r._transformUV=this._transformUV.clone())},D$B(0,D$s,"ambientColor",function(){return this._getColor(9)},function(D$s){this._setColor(9,D$s)}),D$B(0,D$s,"ambientTexture",function(){return this._getTexture(5)},function(D$s){D$s?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,D$s)}),D$B(0,D$s,"renderMode",null,function(D$s){switch(D$s){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(D$Y.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(D$s)}),D$B(0,D$s,"reflectColor",function(){return this._getColor(12)},function(D$s){this._setColor(12,D$s)}),D$B(0,D$s,"tilingOffset",function(){return this._getColor(15)},function(D$s){if(D$s){var D$r=D$s.elements;1!=D$r[0]||1!=D$r[1]||0!=D$r[2]||0!=D$r[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,D$s)}),D$B(0,D$s,"albedo",function(){return this._getColor(7)},function(D$s){this._setColor(7,D$s)}),D$B(0,D$s,"diffuseColor",function(){return this._getColor(10)},function(D$s){this._setColor(10,D$s)}),D$B(0,D$s,"albedoColor",function(){return this._getColor(7)},function(D$s){this._setColor(7,D$s)}),D$B(0,D$s,"specularColor",function(){return this._getColor(11)},function(D$s){this._setColor(11,D$s)}),D$B(0,D$s,"diffuseTexture",function(){return this._getTexture(1)},function(D$s){D$s?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,D$s)}),D$B(0,D$s,"normalTexture",function(){return this._getTexture(2)},function(D$s){D$s?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,D$s)}),D$B(0,D$s,"specularTexture",function(){return this._getTexture(3)},function(D$s){D$s?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,D$s)}),D$B(0,D$s,"emissiveTexture",function(){return this._getTexture(4)},function(D$s){D$s?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,D$s)}),D$B(0,D$s,"reflectTexture",function(){return this._getTexture(6)},function(D$s){D$s?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,D$s)}),D$B(0,D$s,"transformUV",function(){return this._transformUV},function(D$s){this._transformUV=D$s,this._setMatrix4x4(13,D$s.matrix),D$s?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,D$s.matrix.elements,0)}),D$Y.__init__=function(){D$Y.SHADERDEFINE_DIFFUSEMAP=D$Y.shaderDefines.registerDefine("DIFFUSEMAP"),D$Y.SHADERDEFINE_NORMALMAP=D$Y.shaderDefines.registerDefine("NORMALMAP"),D$Y.SHADERDEFINE_SPECULARMAP=D$Y.shaderDefines.registerDefine("SPECULARMAP"),D$Y.SHADERDEFINE_EMISSIVEMAP=D$Y.shaderDefines.registerDefine("EMISSIVEMAP"),D$Y.SHADERDEFINE_AMBIENTMAP=D$Y.shaderDefines.registerDefine("AMBIENTMAP"),D$Y.SHADERDEFINE_REFLECTMAP=D$Y.shaderDefines.registerDefine("REFLECTMAP"),D$Y.SHADERDEFINE_UVTRANSFORM=D$Y.shaderDefines.registerDefine("UVTRANSFORM"),D$Y.SHADERDEFINE_TILINGOFFSET=D$Y.shaderDefines.registerDefine("TILINGOFFSET"),D$Y.SHADERDEFINE_ADDTIVEFOG=D$Y.shaderDefines.registerDefine("ADDTIVEFOG")},D$Y.load=function(D$s){return D$w.loader.create(D$s,null,null,D$Y)},D$Y._parseStandardMaterial=function(D$s,D$r,D$e){var D$U=D$e.customProps,D$m=D$U.ambientColor;D$r.ambientColor=new D$jr(D$m[0],D$m[1],D$m[2]);var D$k=D$U.diffuseColor;D$r.diffuseColor=new D$jr(D$k[0],D$k[1],D$k[2]);var D$j=D$U.specularColor;D$r.specularColor=new D$Tr(D$j[0],D$j[1],D$j[2],D$j[3]);var D$T=D$U.reflectColor;D$r.reflectColor=new D$jr(D$T[0],D$T[1],D$T[2]);var D$Y=D$U.albedoColor;D$Y&&(D$r.albedo=new D$Tr(D$Y[0],D$Y[1],D$Y[2],D$Y[3]));var D$Z=D$U.diffuseTexture.texture2D;D$Z&&(D$r.diffuseTexture=D$V.getRes(D$s[D$Z]));var D$h=D$U.normalTexture.texture2D;D$h&&(D$r.normalTexture=D$V.getRes(D$s[D$h]));var D$H=D$U.specularTexture.texture2D;D$H&&(D$r.specularTexture=D$V.getRes(D$s[D$H]));var D$A=D$U.emissiveTexture.texture2D;D$A&&(D$r.emissiveTexture=D$V.getRes(D$s[D$A]));var D$x=D$U.ambientTexture.texture2D;D$x&&(D$r.ambientTexture=D$V.getRes(D$s[D$x]));var D$B=D$U.reflectTexture.texture2D;D$B&&(D$r.reflectTexture=D$V.getRes(D$s[D$B]))},D$Y.RENDERMODE_OPAQUE=1,D$Y.RENDERMODE_OPAQUEDOUBLEFACE=2,D$Y.RENDERMODE_CUTOUT=3,D$Y.RENDERMODE_CUTOUTDOUBLEFACE=4,D$Y.RENDERMODE_TRANSPARENT=13,D$Y.RENDERMODE_TRANSPARENTDOUBLEFACE=14,D$Y.RENDERMODE_ADDTIVE=15,D$Y.RENDERMODE_ADDTIVEDOUBLEFACE=16,D$Y.RENDERMODE_DEPTHREAD_TRANSPARENT=5,D$Y.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,D$Y.RENDERMODE_DEPTHREAD_ADDTIVE=7,D$Y.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,D$Y.RENDERMODE_NONDEPTH_TRANSPARENT=9,D$Y.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,D$Y.RENDERMODE_NONDEPTH_ADDTIVE=11,D$Y.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,D$Y.SHADERDEFINE_DIFFUSEMAP=0,D$Y.SHADERDEFINE_NORMALMAP=0,D$Y.SHADERDEFINE_SPECULARMAP=0,D$Y.SHADERDEFINE_EMISSIVEMAP=0,D$Y.SHADERDEFINE_AMBIENTMAP=0,D$Y.SHADERDEFINE_REFLECTMAP=0,D$Y.SHADERDEFINE_UVTRANSFORM=0,D$Y.SHADERDEFINE_TILINGOFFSET=0,D$Y.SHADERDEFINE_ADDTIVEFOG=0,D$Y.DIFFUSETEXTURE=1,D$Y.NORMALTEXTURE=2,D$Y.SPECULARTEXTURE=3,D$Y.EMISSIVETEXTURE=4,D$Y.AMBIENTTEXTURE=5,D$Y.REFLECTTEXTURE=6,D$Y.ALBEDO=7,D$Y.UVANIAGE=8,D$Y.MATERIALAMBIENT=9,D$Y.MATERIALDIFFUSE=10,D$Y.MATERIALSPECULAR=11,D$Y.MATERIALREFLECT=12,D$Y.UVMATRIX=13,D$Y.UVAGE=14,D$Y.TILINGOFFSET=15,D$H(D$Y,["defaultMaterial",function(){var D$s=new D$Y;return D$s.lock=!0,this.defaultMaterial=D$s},"shaderDefines",function(){return this.shaderDefines=new D$hr(D$Jr.shaderDefines)}]),D$Y}(D$Jr),D$zr=function(D$s){function D$j(D$s,D$r,D$e,D$U,D$m){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===D$e&&(D$e=35044),void 0===D$U&&(D$U=!1),D$j.__super.call(this),this._indexType=D$s,this._indexCount=D$r,this._bufferUsage=D$e,this._bufferType=34963,this._canRead=D$U;var D$k;if("ushort"==D$s)this._indexTypeByteCount=2;else{if("ubyte"!=D$s)throw new Error("unidentification index type.");this._indexTypeByteCount=1}D$k=this._indexTypeByteCount*D$r,this._byteLength=D$k,this._bind(),D$T._gl.bufferData(this._bufferType,D$k,this._bufferUsage),this.uri=D$m,D$U?("ushort"==D$s?this._buffer=new Uint16Array(D$r):"ubyte"==D$s&&(this._buffer=new Uint8Array(D$r)),this.memorySize=2*D$k):this.memorySize=D$k}D$x(D$j,"laya.d3.graphics.IndexBuffer3D",D$s);var D$r=D$j.prototype;return D$r.setData=function(D$s,D$r,D$e,D$U){void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=4294967295);var D$m=0;if("ushort"==this._indexType?(D$m=2,0===D$e&&4294967295===D$U||(D$s=new Uint16Array(D$s.buffer,D$e*D$m,D$U))):"ubyte"==this._indexType&&(D$m=1,0===D$e&&4294967295===D$U||(D$s=new Uint8Array(D$s.buffer,D$e*D$m,D$U))),this._bind(),D$T._gl.bufferSubData(this._bufferType,D$r*D$m,D$s),this._canRead)if(0!==D$r||0!==D$e||4294967295!==D$U){var D$k=this._buffer.length-D$r;D$k<D$U&&(D$U=D$k);for(var D$j=0;D$j<D$U;D$j++)this._buffer[D$r+D$j]=D$s[D$j]}else this._buffer=D$s},D$r.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},D$r.disposeResource=function(){D$s.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},D$B(0,D$r,"indexType",function(){return this._indexType}),D$B(0,D$r,"indexTypeByteCount",function(){return this._indexTypeByteCount}),D$B(0,D$r,"indexCount",function(){return this._indexCount}),D$B(0,D$r,"canRead",function(){return this._canRead}),D$j.INDEXTYPE_UBYTE="ubyte",D$j.INDEXTYPE_USHORT="ushort",D$j.create=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$e&&(D$e=35044),void 0===D$U&&(D$U=!1),new D$j(D$s,D$r,D$e,D$U,D$m)},D$j}(D$T),D$Qr=function(D$k){function D$j(D$s,D$r,D$e,D$U,D$m){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===D$U&&(D$U=!1),D$j.__super.call(this),this._vertexDeclaration=D$s,this._vertexCount=D$r,this._bufferUsage=D$e,this._bufferType=34962,this._canRead=D$U,this.uri=D$m,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*D$r,this._bind(),D$T._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),D$U&&(this._buffer=new Float32Array(this._byteLength/4))}D$x(D$j,"laya.d3.graphics.VertexBuffer3D",D$k);var D$s=D$j.prototype;return D$s.bindWithIndexBuffer=function(D$s){D$s&&D$s._bind(),this._bind()},D$s.setData=function(D$s,D$r,D$e,D$U){if(void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=4294967295),0===D$e&&4294967295===D$U||(D$s=new Float32Array(D$s.buffer,4*D$e,D$U)),this._bind(),D$T._gl.bufferSubData(this._bufferType,4*D$r,D$s),this._canRead)if(0!==D$r||0!==D$e||4294967295!==D$U){var D$m=this._buffer.length-D$r;D$m<D$U&&(D$U=D$m);for(var D$k=0;D$k<D$U;D$k++)this._buffer[D$r+D$k]=D$s[D$k]}else this._buffer=D$s},D$s.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},D$s.disposeResource=function(){for(var D$s=D$P.mainContext,D$r=this._vertexDeclaration.getVertexElements(),D$e=D$T._enableAtributes,D$U=0,D$m=D$r.length;D$U<D$m;D$U++)D$e[D$U]===this._glBuffer&&(D$s.disableVertexAttribArray(D$U),D$e[D$U]=null);D$k.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},D$B(0,D$s,"vertexDeclaration",function(){return this._vertexDeclaration}),D$B(0,D$s,"vertexCount",function(){return this._vertexCount}),D$B(0,D$s,"canRead",function(){return this._canRead}),D$j.create=function(D$s,D$r,D$e,D$U,D$m){return void 0===D$e&&(D$e=35044),void 0===D$U&&(D$U=!1),new D$j(D$s,D$r,D$e,D$U,D$m)},D$j}(D$T),D$Cr=function(D$s){function D$o(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,D$o.__super.call(this),this._type=3553}D$x(D$o,"laya.d3.resource.DataTexture2D",D$Pr);var D$r=D$o.prototype;return D$r.genDebugMipmaps=function(){var D$s=[];return D$s.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),D$s.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),D$s.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),D$s.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),D$s.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),D$s.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),D$s.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),D$s.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),D$s.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),D$s.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),D$s},D$r._onTextureLoaded=function(D$s){},D$r._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var D$s=D$P.mainContext,D$r=this._source=D$s.createTexture(),D$e=this._width,D$U=this._height,D$m=D$O.curBindTexTarget,D$k=D$O.curBindTexValue,D$j=!1;if(D$O.bindTexture(D$s,this._type,D$r),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var D$T=0;D$s.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var D$Y=0;D$Y<this._mipmaps.length;D$Y++){if(this._mipmaps[D$Y].byteLength!=D$Z*D$h*4)throw"mipmap size error  level:"+D$Y;D$s.texSubImage2D(this._type,0,D$o.simLodRect[D$T++],D$o.simLodRect[D$T++],D$o.simLodRect[D$T++],D$o.simLodRect[D$T++],6408,5121,new Uint8Array(this._mipmaps[D$Y]))}this.minFifter=9729,this.magFifter=9729}else{var D$Z=this._width,D$h=this._height;for(D$T=0,D$s.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),D$Y=0;D$Y<this._mipmaps.length;D$Y++){if(this._mipmaps[D$Y].byteLength!=D$Z*D$h*4)throw"mipmap size error  level:"+D$Y;D$s.texImage2D(this._type,D$Y,6408,D$Z,D$h,0,6408,5121,new Uint8Array(this._mipmaps[D$Y])),(D$Z/=2)<1&&(D$Z=1),(D$h/=2)<1&&(D$h=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&D$s.pixelStorei(D$s.UNPACK_ALIGNMENT,1),D$s.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var D$H=0,D$A=!1,D$x=!1;this._buffer.byteLength==4*D$e*D$U?(D$H=6408,D$A=!0):this._buffer.byteLength==3*D$e*D$U?(D$H=6407,D$x=!0):D$H=this._format,D$A||D$x?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),D$x&&D$s.pixelStorei(D$s.UNPACK_ALIGNMENT,1),D$s.texImage2D(this._type,0,D$H,D$e,D$U,0,D$H,5121,this._buffer)):D$s&&D$H==D$s.ALPHA?(D$s.texImage2D(3553,0,D$H,D$e,D$U,0,D$H,D$s.UNSIGNED_BYTE,this._buffer),D$j=!0):0!=D$H&&(D$s.compressedTexImage2D(3553,0,D$H,D$e,D$U,0,this._buffer),D$j=!0)}var D$B=this._minFifter,D$$=this._magFifter,D$l=0==this._wrapModeU?10497:33071,D$V=0==this._wrapModeV?10497:33071,D$b=D$I.isPOT(D$e,D$U);D$b?(this._mipmap||this._mipmaps?-1!==D$B||(D$B=9987):-1!==D$B||(D$B=9729),-1!==D$$||(D$$=9729),D$s.texParameteri(this._type,10241,D$B),D$s.texParameteri(this._type,10240,D$$),D$s.texParameteri(this._type,10242,D$l),D$s.texParameteri(this._type,10243,D$V),this._mipmap&&D$s.generateMipmap(this._type)):(-1!==D$B||(D$B=9729),-1!==D$$||(D$$=9729),D$s.texParameteri(this._type,10241,D$B),D$s.texParameteri(this._type,10240,D$$),D$s.texParameteri(this._type,10242,33071),D$s.texParameteri(this._type,10243,33071)),D$m&&D$k&&D$O.bindTexture(D$s,D$m,D$k),this.memorySize=D$j?this._buffer.length:D$b?D$e*D$U*4*(1+1/3):D$e*D$U*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},D$r.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},D$r.onAsynLoaded=function(D$s,D$r,D$e){var D$U;D$e&&(D$U=D$e[0].call(this,D$r)),D$U&&(this._width=D$U.width,this._height=D$U.height,this._buffer=D$U.data),this._src=D$s,this._size=new D$$r(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},D$r.getPixels=function(){return new Uint8Array(this._buffer)},D$r.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(D$P.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},D$B(0,D$r,"src",function(){return this._src}),D$o.create=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){if(void 0===D$U&&(D$U=9729),void 0===D$m&&(D$m=9729),void 0===D$k&&(D$k=!0),!D$s||D$s.byteLength<D$r*D$e*4)throw"DataTexture2D create error";var D$T=new D$o;return D$T.uri=D$j,D$T._buffer=D$s,D$T._width=D$r,D$T._height=D$e,D$T._mipmap=D$k,D$T._magFifter=D$U,D$T._minFifter=D$m,D$T._size=new D$$r(D$T._width,D$T._height),D$T._conchTexture?alert("怎么给runtime传递datatexture数据"):D$T.activeResource(),D$T},D$o.load=function(D$s,D$r,D$e,D$U,D$m){if(void 0===D$r&&(D$r=0),void 0===D$e&&(D$e=0),void 0===D$U&&(D$U=9729),void 0===D$m&&(D$m=9729),"mipmaps"===D$g.getFileExtension(D$s)){var D$k=D$w.loader.create(D$s,null,null,D$o,[function(D$s){this._mipmaps=[];var D$r=new Uint32Array(D$s);this._width=D$r[0];var D$e=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,D$e=1024),this._width!=D$e)throw"现在只支持512x256的环境贴图。当前的是"+D$r[0];this._height=D$r[1];for(var D$U=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,D$m=this._height,D$k=8;;){var D$j=D$U*D$m*4;if(D$k+D$j>D$s.byteLength)throw"load mipmaps data size error ";var D$T=new Uint8Array(D$s,D$k,D$j);if(this._mipmaps.push(D$T),D$k+=D$j,1==D$U&&1==D$m)break;(D$U/=2)<1&&(D$U=1),(D$m/=2)<1&&(D$m=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){D$k.simLodInfo=new Float32Array(40);for(var D$j=0;D$j<D$k.simLodInfo.length;)D$k.simLodInfo[D$j]=(D$o.simLodRect[D$j]+.5)/1024,D$j++,D$k.simLodInfo[D$j]=(D$o.simLodRect[D$j]+.5)/256,D$j++,D$k.simLodInfo[D$j]=Math.max(D$o.simLodRect[D$j]-1,.1)/1024,D$j++,D$k.simLodInfo[D$j]=Math.max(D$o.simLodRect[D$j]-1.5,.1)/256,D$j++}return D$k}if("number"==typeof D$r)return D$w.loader.create(D$s,null,null,D$o,[function(D$s){return this._width=D$r,this._height=D$e,this._buffer=D$s,null}]);if("function"==typeof D$r)return D$w.loader.create(D$s,null,null,D$o,[D$r]);throw new Error("unknown params.")},D$o.lodasatlas=!1,D$H(D$o,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),D$o}(),D$Rr=function(D$s){function D$r(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,D$r.__super.call(this)}D$x(D$r,"laya.d3.resource.models.PrimitiveMesh",D$Or);var D$e=D$r.prototype;return D$w.imps(D$e,{"laya.d3.core.render.IRenderable":!0}),D$e._getVertexBuffer=function(D$s){return void 0===D$s&&(D$s=0),0===D$s?this._vertexBuffer:null},D$e._getVertexBuffers=function(){return null},D$e._getIndexBuffer=function(){return this._indexBuffer},D$e._getPositions=function(){var D$s,D$r=[],D$e=this._vertexBuffer.vertexDeclaration.getVertexElements(),D$U=0;for(D$U=0;D$U<D$e.length;D$U++){var D$m=D$e[D$U];if("vector3"===D$m.elementFormat&&0===D$m.elementUsage){D$s=D$m;break}}var D$k=this._vertexBuffer.getData();for(D$U=0;D$U<D$k.length;D$U+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var D$j=D$U+D$s.offset/4,D$T=new D$jr(D$k[D$j+0],D$k[D$j+1],D$k[D$j+2]);D$r.push(D$T)}return D$r},D$e.getRenderElement=function(D$s){return this},D$e.getRenderElementsCount=function(){return 1},D$e.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},D$e._beforeRender=function(D$s){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},D$e._render=function(D$s){D$P.mainContext.drawElements(4,this._numberIndices,5123,0),D$n.drawCall++,D$n.trianglesFaces+=this._numberIndices/3},D$B(0,D$e,"_vertexBufferCount",function(){return 1}),D$B(0,D$e,"triangleCount",function(){return this._indexBuffer.indexCount/3}),D$r}(),D$ar=function(D$s){function D$r(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,D$r.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}D$x(D$r,"laya.d3.resource.models.Mesh",D$Or);var D$e=D$r.prototype;return D$e._getPositions=function(){var D$s,D$r,D$e,D$U,D$m,D$k=[],D$j=0,D$T=0,D$Y=0;if(0!==this._vertexBuffers.length){var D$Z=this._vertexBuffers.length;for(D$j=0;D$j<D$Z;D$j++){for(D$e=(D$s=this._vertexBuffers[D$j]).vertexDeclaration.getVertexElements(),D$T=0;D$T<D$e.length;D$T++)if("vector3"===(D$U=D$e[D$T]).elementFormat&&0===D$U.elementUsage){D$r=D$U;break}for(D$m=D$s.getData(),D$T=0;D$T<D$m.length;D$T+=D$s.vertexDeclaration.vertexStride/4)D$Y=D$T+D$r.offset/4,D$k.push(new D$jr(D$m[D$Y+0],D$m[D$Y+1],D$m[D$Y+2]))}}else{var D$h=this._subMeshes.length;for(D$j=0;D$j<D$h;D$j++){for(D$e=(D$s=this._subMeshes[D$j]._getVertexBuffer()).vertexDeclaration.getVertexElements(),D$T=0;D$T<D$e.length;D$T++)if("vector3"===(D$U=D$e[D$T]).elementFormat&&0===D$U.elementUsage){D$r=D$U;break}for(D$m=D$s.getData(),D$T=0;D$T<D$m.length;D$T+=D$s.vertexDeclaration.vertexStride/4)D$Y=D$T+D$r.offset/4,D$k.push(new D$jr(D$m[D$Y+0],D$m[D$Y+1],D$m[D$Y+2]))}}return D$k},D$e._setSubMeshes=function(D$s){this._subMeshes=D$s,this._subMeshCount=D$s.length;for(var D$r=0;D$r<this._subMeshCount;D$r++)D$s[D$r]._indexInMesh=D$r;this._positions=this._getPositions(),this._generateBoundingObject()},D$e.onAsynLoaded=function(D$s,D$r,D$e){var D$U=D$r[0],D$m=D$r[1];D$Ws.read(D$U,this,this._materials,this._subMeshes,D$m),this.completeCreate(),this._endLoaded()},D$e.getSubMesh=function(D$s){return this._subMeshes[D$s]},D$e.getSubMeshCount=function(){return this._subMeshes.length},D$e.getRenderElementsCount=function(){return this._subMeshes.length},D$e.getRenderElement=function(D$s){return this._subMeshes[D$s]},D$e.disposeResource=function(){for(var D$s=0;D$s<this._subMeshes.length;D$s++)this._subMeshes[D$s].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},D$B(0,D$e,"materials",function(){return this._materials.slice()}),D$B(0,D$e,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),D$r.load=function(D$s){return D$w.loader.create(D$s,null,null,D$r)},D$r}(),D$pr=(function(D$s){function D$Z(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===D$e&&(D$e=6408),void 0===D$U&&(D$U=5121),void 0===D$m&&(D$m=33189),void 0===D$k&&(D$k=!1),void 0===D$j&&(D$j=!1),void 0===D$T&&(D$T=-1),void 0===D$Y&&(D$Y=-1),D$Z.__super.call(this),this._type=3553,this._width=D$s,this._height=D$r,this._size=new D$$r(D$s,D$r),this._surfaceFormat=D$e,this._surfaceType=D$U,this._depthStencilFormat=D$m,D$$.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=D$k,this._repeat=D$j,this._minFifter=D$T,this._magFifter=D$Y,this.activeResource(),this._alreadyResolved=!0}D$x(D$Z,"laya.d3.resource.RenderTexture",D$Pr);var D$r=D$Z.prototype;D$r.recreateResource=function(){var D$s=D$P.mainContext;this._frameBuffer=D$s.createFramebuffer(),this._source=D$s.createTexture();var D$r=D$O.curBindTexTarget,D$e=D$O.curBindTexValue;D$O.bindTexture(D$s,this._type,this._source),D$s.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var D$U=this._minFifter,D$m=this._magFifter,D$k=this._repeat?10497:33071;if(D$I.isPOT(this._width,this._height)?(this._mipmap?-1!==D$U||(D$U=9987):-1!==D$U||(D$U=9729),-1!==D$m||(D$m=9729),D$s.texParameteri(this._type,10241,D$U),D$s.texParameteri(this._type,10240,D$m),D$s.texParameteri(this._type,10242,D$k),D$s.texParameteri(this._type,10243,D$k),this._mipmap&&D$s.generateMipmap(this._type)):(-1!==D$U||(D$U=9729),-1!==D$m||(D$m=9729),D$s.texParameteri(this._type,10241,D$U),D$s.texParameteri(this._type,10240,D$m),D$s.texParameteri(this._type,10242,33071),D$s.texParameteri(this._type,10243,33071)),D$r&&D$e&&D$O.bindTexture(D$s,D$r,D$e),D$s.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=D$s.createRenderbuffer(),D$s.bindRenderbuffer(36161,this._depthStencilBuffer),D$s.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),D$s.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:D$s.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:D$s.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:D$s.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}D$s.framebufferTexture2D(36160,36064,3553,this._source,0),D$s.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},D$r.start=function(){D$P.mainContext.bindFramebuffer(36160,this.frameBuffer),(D$Z._currentRenderTarget=this)._alreadyResolved=!1},D$r.end=function(){D$P.mainContext.bindFramebuffer(36160,null),D$Z._currentRenderTarget=null,this._alreadyResolved=!0},D$r.getData=function(D$s,D$r,D$e,D$U){var D$m=D$P.mainContext;if(D$m.bindFramebuffer(36160,this._frameBuffer),!(36053===D$m.checkFramebufferStatus(36160)))return D$m.bindFramebuffer(36160,null),null;var D$k=new Uint8Array(this._width*this._height*4);return D$m.readPixels(D$s,D$r,D$e,D$U,this._surfaceFormat,this._surfaceType,D$k),D$m.bindFramebuffer(36160,null),D$k},D$r.disposeResource=function(){if(this._frameBuffer){var D$s=D$P.mainContext;D$s.deleteTexture(this._source),D$s.deleteFramebuffer(this._frameBuffer),D$s.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},D$B(0,D$r,"surfaceFormat",function(){return this._surfaceFormat}),D$B(0,D$r,"surfaceType",function(){return this._surfaceType}),D$B(0,D$r,"depthStencilFormat",function(){return this._depthStencilFormat}),D$B(0,D$r,"source",function(){return this._alreadyResolved?D$w.superGet(D$Pr,this,"source"):null}),D$B(0,D$r,"depthStencilBuffer",function(){return this._depthStencilBuffer}),D$B(0,D$r,"frameBuffer",function(){return this._frameBuffer}),D$Z._currentRenderTarget=null}(),function(D$s){function D$r(D$s){this._color=null,this._pixels=null,D$r.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new D$$r(this.width,this.height),this._color=D$s,this._pixels=new Uint8Array([255*D$s.x,255*D$s.y,255*D$s.z,255*D$s.w]),this.uri="SolidColorTexture2D_"+this.id}D$x(D$r,"laya.d3.resource.SolidColorTexture2D",D$Pr);var D$e=D$r.prototype;return D$e._createWebGlTexture=function(){var D$s=D$P.mainContext,D$r=this._source=D$s.createTexture(),D$e=this._width,D$U=this._height,D$m=D$O.curBindTexTarget,D$k=D$O.curBindTexValue;D$O.bindTexture(D$s,this._type,D$r),D$s.texImage2D(this._type,0,6408,D$e,D$U,0,6408,5121,this._pixels);var D$j=this._minFifter,D$T=this._magFifter,D$Y=this._repeat?10497:33071,D$Z=D$I.isPOT(D$e,D$U);D$Z?(this._mipmap?-1!==D$j||(D$j=9987):-1!==D$j||(D$j=9729),-1!==D$T||(D$T=9729),D$s.texParameteri(this._type,10241,D$j),D$s.texParameteri(this._type,10240,D$T),D$s.texParameteri(this._type,10242,D$Y),D$s.texParameteri(this._type,10243,D$Y),this._mipmap&&D$s.generateMipmap(this._type)):(-1!==D$j||(D$j=9729),-1!==D$T||(D$T=9729),D$s.texParameteri(this._type,10241,D$j),D$s.texParameteri(this._type,10240,D$T),D$s.texParameteri(this._type,10242,33071),D$s.texParameteri(this._type,10243,33071)),D$m&&D$k&&D$O.bindTexture(D$s,D$m,D$k),this.memorySize=D$Z?D$e*D$U*4*(1+1/3):D$e*D$U*4},D$e.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},D$e.disposeResource=function(){this._source&&(D$P.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},D$H(D$r,["magentaTexture",function(){var D$s=new D$r(new D$Tr(1,0,1,1));return D$s.lock=!0,this.magentaTexture=D$s},"grayTexture",function(){var D$s=new D$r(new D$Tr(.5,.5,.5,1));return D$s.lock=!0,this.grayTexture=D$s}]),D$r}()),D$Nr=function(D$s){function D$m(D$s,D$r,D$e,D$U){this._canRead=!1,this._image=null,this._pixels=null,void 0===D$s&&(D$s=!1),void 0===D$r&&(D$r=!0),void 0===D$e&&(D$e=6408),void 0===D$U&&(D$U=!0),D$m.__super.call(this),this._type=3553,this._repeat=D$r,this._canRead=D$s,this._format=D$e,this._mipmap=D$U}D$x(D$m,"laya.d3.resource.Texture2D",D$Pr);var D$r=D$m.prototype;return D$r._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var D$s=D$P.mainContext,D$r=this._source=D$s.createTexture(),D$e=this._width,D$U=this._height,D$m=D$O.curBindTexTarget,D$k=D$O.curBindTexValue;switch(D$O.bindTexture(D$s,this._type,D$r),this._format){case 6407:case 6408:this._canRead?D$s.texImage2D(this._type,0,this._format,D$e,D$U,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?D$s.texImage2D(this._type,0,this._image._format,D$e,D$U,0,this._image._format,5121,this._image.atlasSource):D$s.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case D$P.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:D$s.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var D$j=this._minFifter,D$T=this._magFifter,D$Y=this._repeat?10497:33071,D$Z=0==this._wrapModeU?10497:33071,D$h=0==this._wrapModeV?10497:33071,D$H=D$I.isPOT(D$e,D$U);D$H?(this._mipmap?-1!==D$j||(D$j=9987):-1!==D$j||(D$j=9729),-1!==D$T||(D$T=9729),D$s.texParameteri(this._type,10241,D$j),D$s.texParameteri(this._type,10240,D$T),D$s.texParameteri(this._type,10242,D$Y),D$s.texParameteri(this._type,10243,D$Y),D$s.texParameteri(this._type,10242,D$Z),D$s.texParameteri(this._type,10243,D$h),this._mipmap&&D$s.generateMipmap(this._type)):(-1!==D$j||(D$j=9729),-1!==D$T||(D$T=9729),D$s.texParameteri(this._type,10241,D$j),D$s.texParameteri(this._type,10240,D$T),D$s.texParameteri(this._type,10242,33071),D$s.texParameteri(this._type,10243,33071)),D$m&&D$k&&D$O.bindTexture(D$s,D$m,D$k),this._image.onload=null,this._image=null,this.memorySize=D$H?D$e*D$U*4*(1+1/3):D$e*D$U*4},D$r.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},D$r.onAsynLoaded=function(D$s,D$r,D$e){if(D$e){var D$U=D$e[0];void 0!==D$U&&(this._canRead=D$U);var D$m=D$e[1];void 0!==D$m&&(this._repeat=D$m);var D$k=D$e[2];void 0!==D$k&&(this._format=D$k);var D$j=D$e[3];void 0!==D$j&&(this._mipmap=D$j);var D$T=D$e.wrapModeU;void 0!==D$T&&(this._wrapModeU=D$T);var D$Y=D$e.wrapModeV;void 0!==D$Y&&(this._wrapModeV=D$Y)}switch(this._format){case 6407:case 6408:var D$Z=(this._image=D$r).width,D$h=D$r.height;this._width=D$Z,this._height=D$h,this._size=new D$$r(D$Z,D$h),this._canRead&&(D$$.isConchApp?D$r instanceof D$A.HTMLElement&&(this._pixels=new Uint8Array(D$r.getImageData(0,0,D$Z,D$h))):(D$i.canvas.size(D$Z,D$h),D$i.canvas.clear(),D$i.context.drawImage(D$r,0,0,D$Z,D$h),this._pixels=new Uint8Array(D$i.context.getImageData(0,0,D$Z,D$h).data.buffer)));break;case D$P.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var D$H=new D$X(D$r);D$H.readUTFBytes(4),D$H.readUTFBytes(2),D$H.getInt16();D$H.endian="bigEndian",this._width=D$H.getInt16(),this._height=D$H.getInt16(),this._size=new D$$r(this._width,this._height);D$H.getInt16(),D$H.getInt16();this._image=new Uint8Array(D$r,D$H.pos)}this.recreateResource(),this._endLoaded()},D$r.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},D$r.disposeResource=function(){this._source&&(D$P.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},D$B(0,D$r,"_src",function(){return this.url}),D$B(0,D$r,"src",function(){return this.url}),D$m.load=function(D$s){return D$w.loader.create(D$s,null,null,D$m)},D$m}(),D$qr=function(D$r){function D$e(D$s,D$r){D$e.__super.call(this),void 0===D$s&&(D$s=.3),void 0===D$r&&(D$r=1e3),this._tempVector3=new D$jr,this._position=new D$jr,this._up=new D$jr,this._forward=new D$jr,this._right=new D$jr,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=D$$r.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=D$s,this._farPlane=D$r,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),D$w.stage.on("resize",this,this._onScreenSizeChanged)}D$x(D$e,"laya.d3.core.BaseCamera",D$r);var D$s=D$e.prototype;return D$s._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var D$s=this.scene._cameraPool,D$r=D$s.length-1,D$e=0;D$e<D$r;D$e++)if(D$s[D$e].renderingOrder>D$s[D$r].renderingOrder){var D$U=D$s[D$e];D$s[D$e]=D$s[D$r],D$s[D$r]=D$U}},D$s._calculateProjectionMatrix=function(){},D$s._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},D$s._prepareCameraToRender=function(){D$K._currentCameraCullingMask=this.cullingMask;var D$s=this._shaderValues;D$s.setValue(0,this.transform.position.elements),D$s.setValue(5,this.forward.elements),D$s.setValue(6,this.up.elements)},D$s._prepareCameraViewProject=function(D$s,D$r){var D$e=this._shaderValues;D$e.setValue(1,D$s.elements),D$e.setValue(2,D$r.elements)},D$s._renderCamera=function(D$s,D$r,D$e){},D$s.addLayer=function(D$s){29!==D$s.number&&30!=D$s.number&&(this.cullingMask=this.cullingMask|D$s.mask)},D$s.removeLayer=function(D$s){29!==D$s.number&&30!=D$s.number&&(this.cullingMask=this.cullingMask&~D$s.mask)},D$s.addAllLayers=function(){this.cullingMask=2147483647},D$s.removeAllLayers=function(){this.cullingMask=0|D$K.getLayerByNumber(29).mask|D$K.getLayerByNumber(30).mask},D$s.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},D$s.moveForward=function(D$s){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=D$s,this.transform.translate(this._tempVector3)},D$s.moveRight=function(D$s){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=D$s,this.transform.translate(this._tempVector3)},D$s.moveVertical=function(D$s){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=D$s,this.transform.translate(this._tempVector3,!1)},D$s._addSelfRenderObjects=function(){var D$s=this.scene._cameraPool,D$r=D$s.length;if(0<D$r){for(var D$e=D$r-1;0<=D$e;D$e--)if(this.renderingOrder<=D$s[D$e].renderingOrder){D$s.splice(D$e+1,0,this);break}}else D$s.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},D$s._clearSelfRenderObjects=function(){var D$s=this.scene._cameraPool;D$s.splice(D$s.indexOf(this),1)},D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,D$w.stage.off("resize",this,this._onScreenSizeChanged),D$r.prototype.destroy.call(this,D$s)},D$B(0,D$s,"sky",function(){return this._sky},function(D$s){(this._sky=D$s)._ownerCamera=this}),D$B(0,D$s,"forward",function(){var D$s=this.transform.worldMatrix.elements,D$r=this._forward.elements;return D$r[0]=-D$s[8],D$r[1]=-D$s[9],D$r[2]=-D$s[10],this._forward}),D$B(0,D$s,"position",function(){var D$s=this.transform.worldMatrix.elements,D$r=this._position.elements;return D$r[0]=D$s[12],D$r[1]=D$s[13],D$r[2]=D$s[14],this._position}),D$B(0,D$s,"renderTarget",function(){return this._renderTarget},function(D$s){null!=(this._renderTarget=D$s)&&(this._renderTargetSize=D$s.size)}),D$B(0,D$s,"up",function(){var D$s=this.transform.worldMatrix.elements,D$r=this._up.elements;return D$r[0]=D$s[4],D$r[1]=D$s[5],D$r[2]=D$s[6],this._up}),D$B(0,D$s,"right",function(){var D$s=this.transform.worldMatrix.elements,D$r=this._right.elements;return D$r[0]=D$s[0],D$r[1]=D$s[1],D$r[2]=D$s[2],this._right}),D$B(0,D$s,"renderTargetSize",function(){return this._renderTargetSize},function(D$s){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=D$s,this._calculateProjectionMatrix()}),D$B(0,D$s,"fieldOfView",function(){return this._fieldOfView},function(D$s){this._fieldOfView=D$s,this._calculateProjectionMatrix()}),D$B(0,D$s,"nearPlane",function(){return this._nearPlane},function(D$s){this._nearPlane=D$s,this._calculateProjectionMatrix()}),D$B(0,D$s,"farPlane",function(){return this._farPlane},function(D$s){this._farPlane=D$s,this._calculateProjectionMatrix()}),D$B(0,D$s,"orthographic",function(){return this._orthographic},function(D$s){this._orthographic=D$s,this._calculateProjectionMatrix()}),D$B(0,D$s,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(D$s){this._orthographicVerticalSize=D$s,this._calculateProjectionMatrix()}),D$B(0,D$s,"renderingOrder",function(){return this._renderingOrder},function(D$s){this._renderingOrder=D$s,this._sortCamerasByRenderingOrder()}),D$e.CAMERAPOS=0,D$e.VIEWMATRIX=1,D$e.PROJECTMATRIX=2,D$e.VPMATRIX=3,D$e.VPMATRIX_NO_TRANSLATE=4,D$e.CAMERADIRECTION=5,D$e.CAMERAUP=6,D$e.ENVIRONMENTDIFFUSE=7,D$e.ENVIRONMENTSPECULAR=8,D$e.SIMLODINFO=9,D$e.DIFFUSEIRRADMATR=10,D$e.DIFFUSEIRRADMATG=11,D$e.DIFFUSEIRRADMATB=12,D$e.HDREXPOSURE=13,D$e.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",D$e.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",D$e.CLEARFLAG_SOLIDCOLOR=0,D$e.CLEARFLAG_SKY=1,D$e.CLEARFLAG_DEPTHONLY=2,D$e.CLEARFLAG_NONE=3,D$H(D$e,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new D$sr(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new D$sr},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new D$sr}]),D$e}(D$Er),D$Gr=function(D$e){function D$r(D$s){this._render=null,this._geometryFilter=null,D$r.__super.call(this,D$s)}D$x(D$r,"laya.d3.core.RenderableSprite3D",D$e);var D$s=D$r.prototype;return D$s._addToInitStaticBatchManager=function(){},D$s._setBelongScene=function(D$s){D$e.prototype._setBelongScene.call(this,D$s),D$s._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},D$s._setUnBelongScene=function(){var D$s=this._scene._renderableSprite3Ds,D$r=D$s.indexOf(this);D$s.splice(D$r,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),D$e.prototype._setUnBelongScene.call(this)},D$s._update=function(D$s){(D$s.owner=this)._activeInHierarchy&&(this._updateComponents(D$s),this._render._updateOctreeNode(),this._lateUpdateComponents(D$s),D$n.spriteCount++,this._childs.length&&this._updateChilds(D$s))},D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$e.prototype.destroy.call(this,D$s),this._render._destroy(),this._render=null},D$r.__init__=function(){D$r.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=D$r.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),D$r.SAHDERDEFINE_LIGHTMAP=D$r.shaderDefines.registerDefine("LIGHTMAP")},D$r.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,D$r.SAHDERDEFINE_LIGHTMAP=4,D$r.LIGHTMAPSCALEOFFSET=2,D$r.LIGHTMAP=3,D$H(D$r,["shaderDefines",function(){return this.shaderDefines=new D$hr}]),D$r}(D$Er),D$dr=(function(D$s){function D$U(D$s,D$r,D$e){this._long=NaN,this._width=NaN,this._height=NaN,void 0===D$s&&(D$s=1),void 0===D$r&&(D$r=1),void 0===D$e&&(D$e=1),D$U.__super.call(this),this._long=D$s,this._width=D$r,this._height=D$e,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}D$x(D$U,"laya.d3.resource.models.BoxMesh",D$Rr);var D$r=D$U.prototype;D$r.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var D$s=D$Ps.vertexDeclaration,D$r=(D$s.vertexStride,this._long/2),D$e=this._height/2,D$U=this._width/2,D$m=new Float32Array([-D$r,D$e,-D$U,0,1,0,0,0,D$r,D$e,-D$U,0,1,0,1,0,D$r,D$e,D$U,0,1,0,1,1,-D$r,D$e,D$U,0,1,0,0,1,-D$r,-D$e,-D$U,0,-1,0,0,1,D$r,-D$e,-D$U,0,-1,0,1,1,D$r,-D$e,D$U,0,-1,0,1,0,-D$r,-D$e,D$U,0,-1,0,0,0,-D$r,D$e,-D$U,-1,0,0,0,0,-D$r,D$e,D$U,-1,0,0,1,0,-D$r,-D$e,D$U,-1,0,0,1,1,-D$r,-D$e,-D$U,-1,0,0,0,1,D$r,D$e,-D$U,1,0,0,1,0,D$r,D$e,D$U,1,0,0,0,0,D$r,-D$e,D$U,1,0,0,0,1,D$r,-D$e,-D$U,1,0,0,1,1,-D$r,D$e,D$U,0,0,1,0,0,D$r,D$e,D$U,0,0,1,1,0,D$r,-D$e,D$U,0,0,1,1,1,-D$r,-D$e,D$U,0,0,1,0,1,-D$r,D$e,-D$U,0,0,-1,1,0,D$r,D$e,-D$U,0,0,-1,0,0,D$r,-D$e,-D$U,0,0,-1,0,1,-D$r,-D$e,-D$U,0,0,-1,1,1]),D$k=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new D$Qr(D$s,this._numberVertices,35044,!0),this._indexBuffer=new D$zr("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(D$m),this._indexBuffer.setData(D$k),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},D$B(0,D$r,"long",function(){return this._long},function(D$s){this._long!==D$s&&(this._long=D$s,this.releaseResource(),this.activeResource())}),D$B(0,D$r,"width",function(){return this._width},function(D$s){this._width!==D$s&&(this._width=D$s,this.releaseResource(),this.activeResource())}),D$B(0,D$r,"height",function(){return this._height},function(D$s){this._height!==D$s&&(this._height=D$s,this.releaseResource(),this.activeResource())})}(),function(D$s){function D$m(D$s,D$r,D$e,D$U){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===D$s&&(D$s=10),void 0===D$r&&(D$r=10),void 0===D$e&&(D$e=10),void 0===D$U&&(D$U=10),D$m.__super.call(this),this._long=D$s,this._width=D$r,this._stacks=D$e,this._slices=D$U,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}D$x(D$m,"laya.d3.resource.models.PlaneMesh",D$Rr);var D$r=D$m.prototype;D$r.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var D$s=new Uint16Array(this._numberIndices),D$r=D$Ps.vertexDeclaration,D$e=D$r.vertexStride/4,D$U=new Float32Array(this._numberVertices*D$e),D$m=this._long/2,D$k=this._width/2,D$j=this._long/this._stacks,D$T=this._width/this._slices,D$Y=0,D$Z=0;D$Z<=this._slices;D$Z++)for(var D$h=0;D$h<=this._stacks;D$h++)D$U[D$Y++]=D$h*D$j-D$m,D$U[D$Y++]=0,D$U[D$Y++]=D$Z*D$T-D$k,D$U[D$Y++]=0,D$U[D$Y++]=1,D$U[D$Y++]=0,D$U[D$Y++]=1*D$h/this._stacks,D$U[D$Y++]=1*D$Z/this._slices;var D$H=0;for(D$Z=0;D$Z<this._slices;D$Z++)for(D$h=0;D$h<this._stacks;D$h++)D$s[D$H++]=(D$Z+1)*(this._stacks+1)+D$h,D$s[D$H++]=D$Z*(this._stacks+1)+D$h,D$s[D$H++]=(D$Z+1)*(this._stacks+1)+D$h+1,D$s[D$H++]=D$Z*(this._stacks+1)+D$h,D$s[D$H++]=D$Z*(this._stacks+1)+D$h+1,D$s[D$H++]=(D$Z+1)*(this._stacks+1)+D$h+1;this._vertexBuffer=new D$Qr(D$r,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new D$zr("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(D$U),this._indexBuffer.setData(D$s),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},D$B(0,D$r,"long",function(){return this._long},function(D$s){this._long!==D$s&&(this._long=D$s,this.releaseResource(),this.activeResource())}),D$B(0,D$r,"width",function(){return this._width},function(D$s){this._width!==D$s&&(this._width=D$s,this.releaseResource(),this.activeResource())}),D$B(0,D$r,"stacks",function(){return this._stacks},function(D$s){this._stacks!==D$s&&(this._stacks=D$s,this.releaseResource(),this.activeResource())}),D$B(0,D$r,"slices",function(){return this._slices},function(D$s){this._slices!==D$s&&(this._slices=D$s,this.releaseResource(),this.activeResource())})}(),function(D$s){function D$j(D$s,D$r,D$e){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=.3),void 0===D$e&&(D$e=1e3),this._viewMatrix=new D$sr,this._projectionMatrix=new D$sr,this._projectionViewMatrix=new D$sr,this._viewport=new D$Yr(0,0,0,0),this._normalizedViewport=new D$Yr(0,0,1,1),this._aspectRatio=D$s,this._boundFrustumUpdate=!0,this._boundFrustum=new D$us(D$sr.DEFAULT),D$j.__super.call(this,D$r,D$e),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}D$x(D$j,"laya.d3.core.Camera",D$qr);var D$r=D$j.prototype;return D$r._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},D$r._parseCustomProps=function(D$s,D$r,D$e,D$U){var D$m=D$e.clearColor;this.clearColor=new D$Tr(D$m[0],D$m[1],D$m[2],D$m[3]);var D$k=D$e.viewport;this.normalizedViewport=new D$Yr(D$k[0],D$k[1],D$k[2],D$k[3])},D$r._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var D$s=this.orthographicVerticalSize*this.aspectRatio*.5,D$r=.5*this.orthographicVerticalSize;D$sr.createOrthoOffCenterRH(-D$s,D$s,-D$r,D$r,this.nearPlane,this.farPlane,this._projectionMatrix)}else D$sr.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},D$r._update=function(D$s){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,D$s)},D$r._renderCamera=function(D$s,D$r,D$e){var D$U,D$m;D$e.parallelSplitShadowMaps[0]&&D$e._renderShadowMap(D$s,D$r,this),(D$r.camera=this)._prepareCameraToRender(),D$e._preRenderUpdateComponents(D$r),D$U=D$r._viewMatrix=this.viewMatrix;var D$k=this._renderTarget;D$k?(D$k.start(),D$sr.multiply(D$qr._invertYScaleMatrix,this._projectionMatrix,D$qr._invertYProjectionMatrix),D$sr.multiply(D$qr._invertYScaleMatrix,this.projectionViewMatrix,D$qr._invertYProjectionViewMatrix),D$m=D$r._projectionMatrix=D$qr._invertYProjectionMatrix,D$r._projectionViewMatrix=D$qr._invertYProjectionViewMatrix):(D$m=D$r._projectionMatrix=this._projectionMatrix,D$r._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(D$U,D$m),D$r._viewport=this.viewport,D$e._preRenderScene(D$s,D$r,this.boundFrustum),D$e._clear(D$s,D$r),D$e._renderScene(D$s,D$r),D$e._postRenderUpdateComponents(D$r),D$k&&D$k.end()},D$r.viewportPointToRay=function(D$s,D$r){D$Br.calculateCursorRay(D$s,this.viewport,this._projectionMatrix,this.viewMatrix,null,D$r)},D$r.normalizedViewportPointToRay=function(D$s,D$r){var D$e=D$j._tempVector20,D$U=this.viewport,D$m=D$s.elements,D$k=D$e.elements;D$k[0]=D$m[0]*D$U.width,D$k[1]=D$m[1]*D$U.height,D$Br.calculateCursorRay(D$e,this.viewport,this._projectionMatrix,this.viewMatrix,null,D$r)},D$r.worldToViewportPoint=function(D$s,D$r){D$sr.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(D$s,this._projectionViewMatrix,D$r);var D$e=D$r.elements;D$e[0]=D$e[0]/D$w.stage.clientScaleX,D$e[1]=D$e[1]/D$w.stage.clientScaleY},D$r.worldToNormalizedViewportPoint=function(D$s,D$r){D$sr.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(D$s,this._projectionViewMatrix,D$r);var D$e=D$r.elements;D$e[0]=D$e[0]/D$w.stage.clientScaleX,D$e[1]=D$e[1]/D$w.stage.clientScaleY},D$r.convertScreenCoordToOrthographicCoord=function(D$s,D$r){if(this._orthographic){var D$e=D$W.clientWidth,D$U=D$W.clientHeight,D$m=this.orthographicVerticalSize*this.aspectRatio/D$e,D$k=this.orthographicVerticalSize/D$U,D$j=D$s.elements,D$T=D$r.elements;return D$T[0]=(-D$e/2+D$j[0])*D$m,D$T[1]=(D$U/2-D$j[1])*D$k,D$T[2]=(this.nearPlane-this.farPlane)*(D$j[2]+1)/2-this.nearPlane,D$jr.transformCoordinate(D$r,this.transform.worldMatrix,D$r),!0}return!1},D$B(0,D$r,"projectionViewMatrix",function(){return D$sr.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),D$B(0,D$r,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var D$s=this.viewport;return D$s.width/D$s.height},function(D$s){if(D$s<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=D$s,this._calculateProjectionMatrix()}),D$B(0,D$r,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),D$B(0,D$r,"needViewport",function(){var D$s=this.normalizedViewport;return 0===D$s.x&&0===D$s.y&&1===D$s.width&&1===D$s.height}),D$B(0,D$r,"viewport",function(){if(this._viewportExpressedInClipSpace){var D$s=this._normalizedViewport,D$r=this.renderTargetSize,D$e=D$r.width,D$U=D$r.height;this._viewport.x=D$s.x*D$e,this._viewport.y=D$s.y*D$U,this._viewport.width=D$s.width*D$e,this._viewport.height=D$s.height*D$U}return this._viewport},function(D$s){if(null!=this.renderTarget&&(D$s.x<0||D$s.y<0||0==D$s.width||0==D$s.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=D$s,this._calculateProjectionMatrix()}),D$B(0,D$r,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var D$s=this._viewport,D$r=this.renderTargetSize,D$e=D$r.width,D$U=D$r.height;this._normalizedViewport.x=D$s.x/D$e,this._normalizedViewport.y=D$s.y/D$U,this._normalizedViewport.width=D$s.width/D$e,this._normalizedViewport.height=D$s.height/D$U}return this._normalizedViewport},function(D$s){D$s.x<0&&(D$s.x=0,console.warn("Camera: viewport.x must large than 0.0.")),D$s.y<0&&(D$s.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<D$s.x+D$s.width&&(D$s.width=1-D$s.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<D$s.y+D$s.height&&(D$s.height=1-D$s.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=D$s,this._calculateProjectionMatrix()}),D$B(0,D$r,"projectionMatrix",function(){return this._projectionMatrix},function(D$s){this._projectionMatrix=D$s,this._useUserProjectionMatrix=!0}),D$B(0,D$r,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),D$H(D$j,["_tempVector20",function(){return this._tempVector20=new D$kr}]),D$j}()),D$tr=function(D$e){function D$U(D$s,D$r){D$U.__super.call(this,D$r),this._geometryFilter=new D$ir(this),this._render=new D$Kr(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),D$s&&(this._geometryFilter.sharedMesh=D$s)instanceof laya.d3.resource.models.Mesh&&(D$s.loaded?this._render.sharedMaterials=D$s.materials:D$s.once("loaded",this,this._applyMeshMaterials))}D$x(D$U,"laya.d3.core.MeshSprite3D",D$e);var D$s=D$U.prototype;return D$s._changeRenderObjectByMesh=function(D$s){var D$r=this._render._renderElements,D$e=D$r[D$s];D$e||(D$e=D$r[D$s]=new D$Dr),D$e._render=this._render;var D$U=this._render.sharedMaterials[D$s];D$U||(D$U=D$Sr.defaultMaterial);var D$m=this._geometryFilter.sharedMesh.getRenderElement(D$s);return D$e._mainSortID=this._getSortID(D$m,D$U),D$e._sprite3D=this,D$e.renderObj=D$m,D$e._material=D$U,D$e},D$s._changeRenderObjectByMaterial=function(D$s,D$r){var D$e=this._render._renderElements[D$s];D$r||(D$r=D$Sr.defaultMaterial);var D$U=this._geometryFilter.sharedMesh.getRenderElement(D$s);return D$e._mainSortID=this._getSortID(D$U,D$r),D$e._sprite3D=this,D$e.renderObj=D$U,D$e._material=D$r,D$e},D$s._changeRenderObjectsByMesh=function(){var D$s=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=D$s;for(var D$r=0;D$r<D$s;D$r++)this._changeRenderObjectByMesh(D$r)},D$s._onMeshChanged=function(D$s){var D$r=D$s.sharedMesh;D$r.loaded?this._changeRenderObjectsByMesh():D$r.once("loaded",this,this._onMeshLoaded)},D$s._onMeshLoaded=function(D$s){D$s===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},D$s._onMaterialChanged=function(D$s,D$r,D$e){D$r<this._render._renderElements.length&&this._changeRenderObjectByMaterial(D$r,D$e)},D$s._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},D$s._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},D$s._parseCustomProps=function(D$s,D$r,D$e,D$U){var D$m=this.meshRender,D$k=D$e.lightmapIndex;null!=D$k&&(D$m.lightmapIndex=D$k);var D$j,D$T,D$Y=D$e.lightmapScaleOffset;if(D$Y&&(D$m.lightmapScaleOffset=new D$Tr(D$Y[0],D$Y[1],D$Y[2],D$Y[3])),D$U.instanceParams)(D$j=D$U.instanceParams.loadPath)&&(D$T=D$V.getRes(D$r[D$j]),(this.meshFilter.sharedMesh=D$T).loaded?D$m.sharedMaterials=D$T.materials:D$T.once("loaded",this,this._applyMeshMaterials));else{(D$j=D$e.meshPath)&&(D$T=D$V.getRes(D$r[D$j]),this.meshFilter.sharedMesh=D$T);var D$Z=D$e.materials;if(D$Z){var D$h=D$m.sharedMaterials,D$H=D$Z.length;D$h.length=D$H;for(var D$A=0;D$A<D$H;D$A++)D$h[D$A]=D$V.getRes(D$r[D$Z[D$A].path]);D$m.sharedMaterials=D$h}}},D$s._applyMeshMaterials=function(D$s){for(var D$r=this._render.sharedMaterials,D$e=D$s.materials,D$U=0,D$m=D$e.length;D$U<D$m;D$U++)D$r[D$U]||(D$r[D$U]=D$e[D$U]);this._render.sharedMaterials=D$r},D$s._addToInitStaticBatchManager=function(){D$U._staticBatchManager._addInitBatchSprite(this)},D$s.cloneTo=function(D$s){var D$r=D$s;D$r._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var D$e=this._render,D$U=D$r._render;D$U.enable=D$e.enable,D$U.sharedMaterials=D$e.sharedMaterials,D$U.castShadow=D$e.castShadow;var D$m=D$e.lightmapScaleOffset;D$m&&(D$U.lightmapScaleOffset=D$m.clone()),D$U.lightmapIndex=D$e.lightmapIndex,D$U.receiveShadow=D$e.receiveShadow,D$U.sortingFudge=D$e.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,D$s)},D$s.destroy=function(D$s){if(void 0===D$s&&(D$s=!0),!this.destroyed){var D$r=this.meshFilter.sharedMesh;null!=D$r&&(D$r.loaded||D$r.off("loaded",this,this._applyMeshMaterials)),D$e.prototype.destroy.call(this,D$s),this._geometryFilter._destroy()}},D$B(0,D$s,"meshFilter",function(){return this._geometryFilter}),D$B(0,D$s,"meshRender",function(){return this._render}),D$U.__init__=function(){D$Us._staticBatchManagers.push(D$U._staticBatchManager)},D$U.load=function(D$s){return D$w.loader.create(D$s,null,null,D$U)},D$H(D$U,["_staticBatchManager",function(){return this._staticBatchManager=new D$yr}]),D$U}(D$Gr)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(D$s,D$r){"use strict";for(var D$e in Object.defineProperty(D$r,"__esModule",{value:!0}),Laya){var D$U=Laya[D$e];D$U&&D$U.__isclass&&(D$r[D$e]=D$U)}}),function(D$s,D$r,D$ms){D$ms.un,D$ms.uns;var D$e=D$ms.static,D$U=D$ms.class,D$k=D$ms.getset,D$$=D$ms.__newvec,D$T=laya.maths.Bezier,D$H=laya.utils.Browser,D$Ps=laya.utils.Byte,D$m=(laya.events.Event,laya.events.EventDispatcher),D$j=laya.display.Graphics,D$Y=(laya.resource.HTMLCanvas,laya.utils.Handler),D$Z=laya.net.Loader,D$A=laya.maths.MathUtil,D$Os=laya.maths.Matrix,D$l=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),D$h=(laya.renders.RenderContext,laya.resource.Resource),D$x=laya.utils.RunDriver,D$ks=laya.display.Sprite,D$B=laya.utils.Stat,D$is=laya.resource.Texture,D$V=(laya.net.URL,laya.utils.Utils),D$O=function(){function D$s(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return D$U(D$s,"laya.ani.AnimationContent"),D$s}(),D$i=function(){function D$s(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return D$U(D$s,"laya.ani.AnimationNodeContent"),D$s}(),D$o=function(){function D$s(){}return D$U(D$s,"laya.ani.AnimationParser01"),D$s.parse=function(D$s,D$r){var D$e=D$r.__getBuffer(),D$U=0,D$m=0,D$k=0,D$j=0,D$T=0,D$Y=0,D$Z=0,D$h=D$r.readUTFString();D$s._aniClassName=D$h;var D$H,D$A=D$r.readUTFString().split("\n"),D$x=D$r.getUint8(),D$B=D$r.getUint32(),D$$=D$r.getUint32();0<D$B&&(D$H=D$e.slice(D$B,D$$));var D$l=new D$Ps(D$H);for(0<D$$&&(D$s._publicExtData=D$e.slice(D$$,D$e.byteLength)),D$s._useParent=!!D$r.getUint8(),D$s._anis.length=D$x,D$U=0;D$U<D$x;D$U++){var D$V=D$s._anis[D$U]=new D$O;D$V.nodes=new Array;var D$b=D$V.name=D$A[D$r.getUint16()];D$s._aniMap[D$b]=D$U,D$V.bone3DMap={},D$V.playTime=D$r.getFloat32(),D$V.playTime<=0&&console.error("播放时间不能为0  url="+D$s.url+" name="+D$V.name);var D$o=D$V.nodes.length=D$r.getUint8();for(D$m=D$V.totalKeyframeDatasLength=0;D$m<D$o;D$m++){var D$I=D$V.nodes[D$m]=new D$i;D$I.childs=[];var D$w=D$r.getInt16();0<=D$w&&(D$I.name=D$A[D$w],D$V.bone3DMap[D$I.name]=D$m),D$I.keyFrame=new Array,D$I.parentIndex=D$r.getInt16(),-1==D$I.parentIndex?D$I.parent=null:D$I.parent=D$V.nodes[D$I.parentIndex],D$I.lerpType=D$r.getUint8();var D$X=D$r.getUint32();D$l.pos=D$X;var D$D=D$I.keyframeWidth=D$l.getUint16();if(D$V.totalKeyframeDatasLength+=D$D,0===D$I.lerpType||1===D$I.lerpType)for(D$I.interpolationMethod=[],D$I.interpolationMethod.length=D$D,D$k=0;D$k<D$D;D$k++)D$I.interpolationMethod[D$k]=D$E.interpolation[D$l.getUint8()];null!=D$I.parent&&D$I.parent.childs.push(D$I);var D$n=D$r.getUint16();0<D$n&&(D$I.extenData=D$e.slice(D$r.pos,D$r.pos+D$n),D$r.pos+=D$n);var D$y,D$g=D$r.getUint16(),D$f=0;for(D$k=0,D$j=D$I.keyFrame.length=D$g;D$k<D$j;D$k++){if((D$y=D$I.keyFrame[D$k]=new D$K).duration=D$r.getFloat32(),D$y.startTime=D$f,2===D$I.lerpType){D$y.interpolationData=[];var D$J,D$P=D$r.getUint8();switch(D$J=D$r.getFloat32()){case 254:for(D$y.interpolationData.length=D$D,D$Z=0;D$Z<D$D;D$Z++)D$y.interpolationData[D$Z]=0;break;case 255:for(D$y.interpolationData.length=D$D,D$Z=0;D$Z<D$D;D$Z++)D$y.interpolationData[D$Z]=5;break;default:for(D$y.interpolationData.push(D$J),D$Y=1;D$Y<D$P;D$Y++)D$y.interpolationData.push(D$r.getFloat32())}}for(D$y.data=new Float32Array(D$D),D$T=0;D$T<D$D;D$T++)D$y.data[D$T]=D$r.getFloat32(),-1e-8<D$y.data[D$T]&&D$y.data[D$T]<1e-8&&(D$y.data[D$T]=0);D$f+=D$y.duration}D$y.startTime=D$V.playTime,D$I.playTime=D$V.playTime,D$s._calculateKeyFrame(D$I,D$g,D$D)}}},D$s}(),D$I=function(){function D$w(){}return D$U(D$w,"laya.ani.AnimationParser02"),D$w.READ_DATA=function(){D$w._DATA.offset=D$w._reader.getUint32(),D$w._DATA.size=D$w._reader.getUint32()},D$w.READ_BLOCK=function(){for(var D$s=D$w._BLOCK.count=D$w._reader.getUint16(),D$r=D$w._BLOCK.blockStarts=[],D$e=D$w._BLOCK.blockLengths=[],D$U=0;D$U<D$s;D$U++)D$r.push(D$w._reader.getUint32()),D$e.push(D$w._reader.getUint32())},D$w.READ_STRINGS=function(){var D$s=D$w._reader.getUint32(),D$r=D$w._reader.getUint16(),D$e=D$w._reader.pos;D$w._reader.pos=D$s+D$w._DATA.offset;for(var D$U=0;D$U<D$r;D$U++)D$w._strings[D$U]=D$w._reader.readUTFString();D$w._reader.pos=D$e},D$w.parse=function(D$s,D$r){D$w._templet=D$s;(D$w._reader=D$r).__getBuffer();D$w.READ_DATA(),D$w.READ_BLOCK(),D$w.READ_STRINGS();for(var D$e=0,D$U=D$w._BLOCK.count;D$e<D$U;D$e++){var D$m=D$r.getUint16(),D$k=D$w._strings[D$m],D$j=D$w["READ_"+D$k];if(null==D$j)throw new Error("model file err,no this function:"+D$m+" "+D$k);D$j.call()}},D$w.READ_ANIMATIONS=function(){var D$s=D$w._reader,D$r=D$s.__getBuffer(),D$e=0,D$U=0,D$m=0,D$k=0,D$j=D$s.getUint16(),D$T=[];for(D$T.length=D$j,D$e=0;D$e<D$j;D$e++)D$T[D$e]=D$E.interpolation[D$s.getByte()];var D$Y=D$s.getUint8();for(D$w._templet._anis.length=D$Y,D$e=0;D$e<D$Y;D$e++){var D$Z=D$w._templet._anis[D$e]={};D$Z.nodes=new Array;var D$h=D$Z.name=D$w._strings[D$s.getUint16()];D$w._templet._aniMap[D$h]=D$e,D$Z.bone3DMap={},D$Z.playTime=D$s.getFloat32();var D$H=D$Z.nodes.length=D$s.getInt16();for(D$U=D$Z.totalKeyframeDatasLength=0;D$U<D$H;D$U++){var D$A=D$Z.nodes[D$U]={};D$A.keyframeWidth=D$j,D$A.childs=[];var D$x=D$s.getUint16();0<=D$x&&(D$A.name=D$w._strings[D$x],D$Z.bone3DMap[D$A.name]=D$U),D$A.keyFrame=new Array,D$A.parentIndex=D$s.getInt16(),-1==D$A.parentIndex?D$A.parent=null:D$A.parent=D$Z.nodes[D$A.parentIndex],D$Z.totalKeyframeDatasLength+=D$j,D$A.interpolationMethod=D$T,null!=D$A.parent&&D$A.parent.childs.push(D$A);var D$B=D$s.getUint16(),D$$=null,D$l=null;for(D$m=0,D$k=D$A.keyFrame.length=D$B;D$m<D$k;D$m++){(D$$=D$A.keyFrame[D$m]={}).startTime=D$s.getFloat32(),D$l&&(D$l.duration=D$$.startTime-D$l.startTime);var D$V=D$w._DATA.offset,D$b=D$s.getUint32(),D$o=4*D$j,D$I=D$r.slice(D$V+D$b,D$V+D$b+D$o);D$$.data=new Float32Array(D$I),D$l=D$$}D$$.duration=0,D$A.playTime=D$Z.playTime,D$w._templet._calculateKeyFrame(D$A,D$B,D$j)}}},D$w._templet=null,D$w._reader=null,D$w._strings=[],D$e(D$w,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),D$w}(),D$Ks=(function(){function D$s(){}D$U(D$s,"laya.ani.AnimationState"),D$s.stopped=0,D$s.paused=1,D$s.playing=2}(),function(){function D$m(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new D$Gs,this.resultMatrix=new D$Os,this._children=[]}D$U(D$m,"laya.ani.bone.Bone");var D$s=D$m.prototype;return D$s.setTempMatrix=function(D$s){this._tempMatrix=D$s;var D$r,D$e=0;for(D$e=0,D$r=this._children.length;D$e<D$r;D$e++)this._children[D$e].setTempMatrix(this._tempMatrix)},D$s.update=function(D$s){var D$r;if(this.rotation=this.transform.skX,D$s)D$r=this.resultTransform.getMatrix(),D$Os.mul(D$r,D$s,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)D$r=this.resultTransform.getMatrix(),D$Os.mul(D$r,this.parentBone.resultMatrix,this.resultMatrix);else{var D$e=this.parentBone,D$U=NaN,D$m=NaN,D$k=NaN,D$j=this.parentBone.resultMatrix;D$r=this.resultTransform.getMatrix();var D$T=D$j.a*D$r.tx+D$j.c*D$r.ty+D$j.tx,D$Y=D$j.b*D$r.tx+D$j.d*D$r.ty+D$j.ty,D$Z=new D$Os;this.inheritRotation?(D$U=Math.atan2(D$e.resultMatrix.b,D$e.resultMatrix.a),D$m=Math.cos(D$U),D$k=Math.sin(D$U),D$Z.setTo(D$m,D$k,-D$k,D$m,0,0),D$Os.mul(this._tempMatrix,D$Z,D$Os.TEMP),D$Os.TEMP.copyTo(D$Z),D$r=this.resultTransform.getMatrix(),D$Os.mul(D$r,D$Z,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,D$r=this.resultTransform.getMatrix(),D$Os.TEMP.identity(),D$Os.TEMP.d=this.d,D$Os.mul(D$r,D$Os.TEMP,this.resultMatrix)),this.resultMatrix.tx=D$T,this.resultMatrix.ty=D$Y}else(D$r=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var D$h,D$H=0;for(D$H=0,D$h=this._children.length;D$H<D$h;D$H++)this._children[D$H].update()},D$s.updateChild=function(){var D$s,D$r=0;for(D$r=0,D$s=this._children.length;D$r<D$s;D$r++)this._children[D$r].update()},D$s.setRotation=function(D$s){this._sprite&&(this._sprite.rotation=180*D$s/Math.PI)},D$s.updateDraw=function(D$s,D$r){D$m.ShowBones&&!D$m.ShowBones[this.name]||(this._sprite||(this._sprite=new D$ks,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),D$ms.stage.addChild(this._sprite)),this._sprite.x=D$s+this.resultMatrix.tx,this._sprite.y=D$r+this.resultMatrix.ty);var D$e,D$U=0;for(D$U=0,D$e=this._children.length;D$U<D$e;D$U++)this._children[D$U].updateDraw(D$s,D$r)},D$s.addChild=function(D$s){this._children.push(D$s),D$s.parentBone=this},D$s.findBone=function(D$s){if(this.name==D$s)return this;var D$r,D$e,D$U=0;for(D$U=0,D$r=this._children.length;D$U<D$r;D$U++)if(D$e=this._children[D$U].findBone(D$s))return D$e;return null},D$s.localToWorld=function(D$s){var D$r=D$s[0],D$e=D$s[1];D$s[0]=D$r*this.resultMatrix.a+D$e*this.resultMatrix.c+this.resultMatrix.tx,D$s[1]=D$r*this.resultMatrix.b+D$e*this.resultMatrix.d+this.resultMatrix.ty},D$m.ShowBones={},D$m}()),D$cs=function(){function D$$(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}D$U(D$$,"laya.ani.bone.BoneSlot");var D$s=D$$.prototype;return D$s.showSlotData=function(D$s,D$r){void 0===D$r&&(D$r=!0),this.currSlotData=D$s,D$r&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},D$s.showDisplayByName=function(D$s){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(D$s))},D$s.replaceDisplayByName=function(D$s,D$r){if(this.currSlotData){var D$e;D$e=this.currSlotData.getDisplayByName(D$s);var D$U;D$U=this.currSlotData.getDisplayByName(D$r),this.replaceDisplayByIndex(D$e,D$U)}},D$s.replaceDisplayByIndex=function(D$s,D$r){this.currSlotData&&(this._replaceDic[D$s]=D$r,this.displayIndex==D$s&&this.showDisplayByIndex(D$s))},D$s.showDisplayByIndex=function(D$s){if(null!=this._replaceDic[D$s]&&(D$s=this._replaceDic[D$s]),this.currSlotData&&-1<D$s&&D$s<this.currSlotData.displayArr.length){if(this.displayIndex=D$s,this.currDisplayData=this.currSlotData.displayArr[D$s],this.currDisplayData){var D$r=this.currDisplayData.name;this.currTexture=this.templet.getTexture(D$r),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!D$l.isConchApp||D$l.isConchApp&&"0.9.15"<D$ks.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},D$s.replaceSkin=function(D$s){this._diyTexture=D$s,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},D$s.setParentMatrix=function(D$s){this._parentMatrix=D$s},D$s.draw=function(D$s,D$r,D$e,D$U){if(void 0===D$e&&(D$e=!1),void 0===D$U&&(D$U=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var D$m,D$k=this.currTexture;switch(this._diyTexture&&(D$k=this._diyTexture),this.currDisplayData.type){case 0:if(D$s){var D$j=this.getDisplayMatrix();if(this._parentMatrix){var D$T=!1;if(D$j){var D$Y;if(D$Os.mul(D$j,this._parentMatrix,D$Os.TEMP),D$Y=D$e?(null==this._resultMatrix&&(this._resultMatrix=new D$Os),this._resultMatrix):new D$Os,!D$l.isWebGL&&this.currDisplayData.uvs||D$l.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var D$Z=D$$._tempMatrix;D$Z.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(D$Z.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(D$T=!0,D$Z.rotate(-Math.PI/2)),D$Os.mul(D$Z,D$Os.TEMP,D$Y)}else D$Os.TEMP.copyTo(D$Y);D$T?D$s.drawTexture(D$k,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,D$Y):D$s.drawTexture(D$k,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,D$Y)}}}break;case 1:if(null==(D$m=D$e?(null==this._skinSprite&&(this._skinSprite=D$$.createSkinMesh()),this._skinSprite):D$$.createSkinMesh()))return;var D$h;if(null==this.currDisplayData.bones){var D$H,D$A=this.currDisplayData.weights;this.deformData&&(D$A=this.deformData),D$H=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=D$D.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=D$D.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=D$A;this.currDisplayData.triangles.length;D$h=this.currDisplayData.triangles,D$m.init2(D$k,null,D$h,this._mVerticleArr,D$H);var D$x,D$B=this.getDisplayMatrix();if(this._parentMatrix)if(D$B)D$Os.mul(D$B,this._parentMatrix,D$Os.TEMP),D$x=D$e?(null==this._resultMatrix&&(this._resultMatrix=new D$Os),this._resultMatrix):new D$Os,D$Os.TEMP.copyTo(D$x),D$m.transform=D$x}else this.skinMesh(D$r,D$m,D$U);D$s.drawSkin(D$m);break;case 2:if(null==(D$m=D$e?(null==this._skinSprite&&(this._skinSprite=D$$.createSkinMesh()),this._skinSprite):D$$.createSkinMesh()))return;this.skinMesh(D$r,D$m,D$U),D$s.drawSkin(D$m)}}},D$s.skinMesh=function(D$s,D$r,D$e){var D$U,D$m=this.currTexture,D$k=this.currDisplayData.bones;D$U=this._diyTexture?(D$m=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=D$D.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=D$D.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var D$j,D$T,D$Y=this.currDisplayData.weights,D$Z=this.currDisplayData.triangles,D$h=0,D$H=0,D$A=0,D$x=NaN,D$B=NaN,D$$=0,D$l=0,D$V=[],D$b=0,D$o=0;if(this.deformData&&0<this.deformData.length){var D$I=0;for(D$b=0,D$o=D$k.length;D$b<D$o;){for(D$A=D$k[D$b++]+D$b,D$H=D$h=0;D$b<D$A;D$b++)D$T=D$s[D$k[D$b]],D$x=D$Y[D$$]+this.deformData[D$I++],D$B=D$Y[D$$+1]+this.deformData[D$I++],D$l=D$Y[D$$+2],D$h+=(D$x*D$T.a+D$B*D$T.c+D$T.tx)*D$l,D$H+=(D$x*D$T.b+D$B*D$T.d+D$T.ty)*D$l,D$$+=3;D$V.push(D$h,D$H)}}else for(D$b=0,D$o=D$k.length;D$b<D$o;){for(D$A=D$k[D$b++]+D$b,D$H=D$h=0;D$b<D$A;D$b++)D$T=D$s[D$k[D$b]],D$x=D$Y[D$$],D$B=D$Y[D$$+1],D$l=D$Y[D$$+2],D$h+=(D$x*D$T.a+D$B*D$T.c+D$T.tx)*D$l,D$H+=(D$x*D$T.b+D$B*D$T.d+D$T.ty)*D$l,D$$+=3;D$V.push(D$h,D$H)}this._mVerticleArr=D$V,D$j=D$Z,D$r.init2(D$m,null,D$j,this._mVerticleArr,D$U)},D$s.drawBonePoint=function(D$s){D$s&&this._parentMatrix&&D$s.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},D$s.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},D$s.getMatrix=function(){return this._resultMatrix},D$s.copy=function(){var D$s=new D$$;return D$s.type="copy",D$s.name=this.name,D$s.attachmentName=this.attachmentName,D$s.srcDisplayIndex=this.srcDisplayIndex,D$s.parent=this.parent,D$s.displayIndex=this.displayIndex,D$s.templet=this.templet,D$s.currSlotData=this.currSlotData,D$s.currTexture=this.currTexture,D$s.currDisplayData=this.currDisplayData,D$s},D$$.createSkinMesh=function(){return D$l.isWebGL||D$l.isConchApp?D$x.skinAniSprite():(D$l.isWebGL,null)},D$e(D$$,["_tempMatrix",function(){return this._tempMatrix=new D$Os}]),D$$}(),D$Es=function(){function D$s(){this.skinName=null,this.deformSlotDataList=[]}return D$U(D$s,"laya.ani.bone.DeformAniData"),D$s}(),D$vs=function(){function D$s(){this.deformSlotDisplayList=[]}return D$U(D$s,"laya.ani.bone.DeformSlotData"),D$s}(),D$Ss=function(){function D$s(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}D$U(D$s,"laya.ani.bone.DeformSlotDisplayData");var D$r=D$s.prototype;return D$r.binarySearch1=function(D$s,D$r){var D$e=0,D$U=D$s.length-2;if(0==D$U)return 1;for(var D$m=D$U>>>1;;){if(D$s[Math.floor(D$m+1)]<=D$r?D$e=D$m+1:D$U=D$m,D$e==D$U)return D$e+1;D$m=D$e+D$U>>>1}return 0},D$r.apply=function(D$s,D$r,D$e){if(void 0===D$e&&(D$e=1),D$s+=.05,!(this.timeList.length<=0)){var D$U=0;if(!(D$s<this.timeList[0])){var D$m=this.vectices[0].length,D$k=[],D$j=this.binarySearch1(this.timeList,D$s);if(this.frameIndex=D$j,D$s>=this.timeList[this.timeList.length-1]){var D$T=this.vectices[this.vectices.length-1];if(D$e<1)for(D$U=0;D$U<D$m;D$U++)D$k[D$U]+=(D$T[D$U]-D$k[D$U])*D$e;else for(D$U=0;D$U<D$m;D$U++)D$k[D$U]=D$T[D$U];this.deformData=D$k}else{this.tweenKeyList[this.frameIndex];var D$Y=this.vectices[this.frameIndex-1],D$Z=this.vectices[this.frameIndex],D$h=this.timeList[this.frameIndex-1],D$H=this.timeList[this.frameIndex];D$e=this.tweenKeyList[D$j-1]?(D$s-D$h)/(D$H-D$h):0;var D$A=NaN;for(D$U=0;D$U<D$m;D$U++)D$A=D$Y[D$U],D$k[D$U]=D$A+(D$Z[D$U]-D$A)*D$e;this.deformData=D$k}}}},D$s}(),D$zs=function(){function D$s(){this.time=NaN,this.drawOrder=[]}return D$U(D$s,"laya.ani.bone.DrawOrderData"),D$s}(),D$Qs=function(){function D$s(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return D$U(D$s,"laya.ani.bone.EventData"),D$s}(),D$b=function(){function D$Us(D$s,D$r){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=D$s,this._targetBone=D$r[D$s.targetBoneIndex],this.isSpine=D$s.isSpine,null==this._bones&&(this._bones=[]);for(var D$e=this._bones.length=0,D$U=D$s.boneIndexs.length;D$e<D$U;D$e++)this._bones.push(D$r[D$s.boneIndexs[D$e]]);this.name=D$s.name,this.mix=D$s.mix,this.bendDirection=D$s.bendDirection}D$U(D$Us,"laya.ani.bone.IkConstraint");var D$s=D$Us.prototype;return D$s.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},D$s._applyIk1=function(D$s,D$r,D$e,D$U){var D$m=D$s.parentBone,D$k=1/(D$m.resultMatrix.a*D$m.resultMatrix.d-D$m.resultMatrix.b*D$m.resultMatrix.c),D$j=D$r-D$m.resultMatrix.tx,D$T=D$e-D$m.resultMatrix.ty,D$Y=(D$j*D$m.resultMatrix.d-D$T*D$m.resultMatrix.c)*D$k-D$s.transform.x,D$Z=(D$T*D$m.resultMatrix.a-D$j*D$m.resultMatrix.b)*D$k-D$s.transform.y,D$h=Math.atan2(D$Z,D$Y)*D$Us.radDeg-0-D$s.transform.skX;D$s.transform.scX<0&&(D$h+=180),180<D$h?D$h-=360:D$h<-180&&(D$h+=360),D$s.transform.skX=D$s.transform.skY=D$s.transform.skX+D$h*D$U,D$s.update()},D$s.updatePos=function(D$s,D$r){this._sp&&this._sp.pos(D$s,D$r)},D$s._applyIk2=function(D$s,D$r,D$e,D$U,D$m,D$k){if(0!=D$k){var D$j=D$s.resultTransform.x,D$T=D$s.resultTransform.y,D$Y=D$s.transform.scX,D$Z=D$s.transform.scY,D$h=D$r.transform.scX,D$H=0,D$A=0,D$x=0;D$x=D$Y<0?(D$Y=-D$Y,D$H=180,-1):(D$H=0,1),D$Z<0&&(D$Z=-D$Z,D$x=-D$x),D$A=D$h<0?(D$h=-D$h,180):0;var D$B=D$r.resultTransform.x,D$$=NaN,D$l=NaN,D$V=NaN,D$b=D$s.resultMatrix.a,D$o=D$s.resultMatrix.c,D$I=D$s.resultMatrix.b,D$w=D$s.resultMatrix.d,D$X=Math.abs(D$Y-D$Z)<=1e-4;D$V=D$X?(D$l=D$b*D$B+D$o*(D$$=D$r.resultTransform.y)+D$s.resultMatrix.tx,D$I*D$B+D$w*D$$+D$s.resultMatrix.ty):(D$$=0,D$l=D$b*D$B+D$s.resultMatrix.tx,D$I*D$B+D$s.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new D$ks,D$ms.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(D$e,D$U,15,"#ffff00"),this._sp.graphics.drawCircle(D$l,D$V,15,"#ff00ff")),D$s.setRotation(Math.atan2(D$V-D$s.resultMatrix.ty,D$l-D$s.resultMatrix.tx));var D$D=D$s.parentBone;D$b=D$D.resultMatrix.a,D$o=D$D.resultMatrix.c,D$I=D$D.resultMatrix.b;var D$n=1/(D$b*(D$w=D$D.resultMatrix.d)-D$o*D$I),D$y=D$e-D$D.resultMatrix.tx,D$g=D$U-D$D.resultMatrix.ty,D$f=(D$y*D$w-D$g*D$o)*D$n-D$j,D$J=(D$g*D$b-D$y*D$I)*D$n-D$T,D$P=((D$y=D$l-D$D.resultMatrix.tx)*D$w-(D$g=D$V-D$D.resultMatrix.ty)*D$o)*D$n-D$j,D$O=(D$g*D$b-D$y*D$I)*D$n-D$T,D$i=Math.sqrt(D$P*D$P+D$O*D$O),D$K=D$r.length*D$h,D$c=NaN,D$E=NaN;if(D$X){var D$v=(D$f*D$f+D$J*D$J-D$i*D$i-(D$K*=D$Y)*D$K)/(2*D$i*D$K);D$v<-1?D$v=-1:1<D$v&&(D$v=1),D$E=Math.acos(D$v)*D$m,D$b=D$i+D$K*D$v,D$o=D$K*Math.sin(D$E),D$c=Math.atan2(D$J*D$b-D$f*D$o,D$f*D$b+D$J*D$o)}else{var D$S=(D$b=D$Y*D$K)*D$b,D$z=(D$o=D$Z*D$K)*D$o,D$Q=D$f*D$f+D$J*D$J,D$C=Math.atan2(D$J,D$f),D$R=-2*D$z*D$i,D$a=D$z-D$S;if(0<(D$w=D$R*D$R-4*D$a*(D$I=D$z*D$i*D$i+D$S*D$Q-D$S*D$z))){var D$p=Math.sqrt(D$w);D$R<0&&(D$p=-D$p);var D$N=(D$p=-(D$R+D$p)/2)/D$a,D$q=D$I/D$p,D$G=Math.abs(D$N)<Math.abs(D$q)?D$N:D$q;D$G*D$G<=D$Q&&(D$g=Math.sqrt(D$Q-D$G*D$G)*D$m,D$c=D$C-Math.atan2(D$g,D$G),D$E=Math.atan2(D$g/D$Z,(D$G-D$i)/D$Y))}var D$d=0,D$t=Number.MAX_VALUE,D$W=0,D$L=0,D$u=0,D$M=0,D$_=0,D$F=0;D$M<(D$w=(D$y=D$i+D$b)*D$y)&&(D$u=0,D$M=D$w,D$_=D$y),(D$w=(D$y=D$i-D$b)*D$y)<D$t&&(D$d=Math.PI,D$t=D$w,D$W=D$y);var D$ss=Math.acos(-D$b*D$i/(D$S-D$z));(D$w=(D$y=D$b*Math.cos(D$ss)+D$i)*D$y+(D$g=D$o*Math.sin(D$ss))*D$g)<D$t&&(D$d=D$ss,D$t=D$w,D$W=D$y,D$L=D$g),D$M<D$w&&(D$u=D$ss,D$M=D$w,D$_=D$y,D$F=D$g),D$E=D$Q<=(D$t+D$M)/2?(D$c=D$C-Math.atan2(D$L*D$m,D$W),D$d*D$m):(D$c=D$C-Math.atan2(D$F*D$m,D$_),D$u*D$m)}var D$rs=Math.atan2(D$$,D$B)*D$x,D$es=D$s.resultTransform.skX;180<(D$c=(D$c-D$rs)*D$Us.radDeg+D$H-D$es)?D$c-=360:D$c<-180&&(D$c+=360),D$s.resultTransform.x=D$j,D$s.resultTransform.y=D$T,D$s.resultTransform.skX=D$s.resultTransform.skY=D$es+D$c*D$k,D$es=D$r.resultTransform.skX,180<(D$E=((D$E+D$rs)*D$Us.radDeg-0)*D$x+D$A-(D$es%=360))?D$E-=360:D$E<-180&&(D$E+=360),D$r.resultTransform.x=D$B,D$r.resultTransform.y=D$$,D$r.resultTransform.skX=D$r.resultTransform.skY=D$r.resultTransform.skY+D$E*D$k,D$s.update()}},D$s._applyIk3=function(D$s,D$r,D$e,D$U,D$m,D$k){if(0!=D$k){var D$j,D$T,D$Y=D$r.resultMatrix.a*D$r.length,D$Z=D$r.resultMatrix.b*D$r.length,D$h=D$Y*D$Y+D$Z*D$Z,D$H=Math.sqrt(D$h),D$A=D$s.resultMatrix.tx,D$x=D$s.resultMatrix.ty,D$B=D$r.resultMatrix.tx,D$$=D$r.resultMatrix.ty,D$l=D$B-D$A,D$V=D$$-D$x,D$b=D$l*D$l+D$V*D$V,D$o=Math.sqrt(D$b),D$I=(D$l=D$e-D$s.resultMatrix.tx)*D$l+(D$V=D$U-D$s.resultMatrix.ty)*D$V,D$w=Math.sqrt(D$I);if(D$H+D$o<=D$w||D$w+D$H<=D$o||D$w+D$o<=D$H){var D$X=NaN;D$B=D$A+(D$X=D$H+D$o<=D$w?1:-1)*(D$e-D$A)*D$o/D$w,D$$=D$x+D$X*(D$U-D$x)*D$o/D$w}else{var D$D=(D$b-D$h+D$I)/(2*D$I),D$n=Math.sqrt(D$b-D$D*D$D*D$I)/D$w,D$y=D$A+D$l*D$D,D$g=D$x+D$V*D$D,D$f=-D$V*D$n,D$J=D$l*D$n;D$$=0<D$m?(D$B=D$y-D$f,D$g-D$J):(D$B=D$y+D$f,D$g+D$J)}D$j=D$B,D$T=D$$,this.isDebug&&(this._sp||(this._sp=new D$ks,D$ms.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(D$A,D$x,15,"#ff00ff"),this._sp.graphics.drawCircle(D$e,D$U,15,"#ffff00"),this._sp.graphics.drawCircle(D$j,D$T,15,"#ff00ff"));var D$P,D$O;D$P=Math.atan2(D$T-D$s.resultMatrix.ty,D$j-D$s.resultMatrix.tx),D$s.setRotation(D$P),(D$O=D$Us._tempMatrix).identity(),D$O.rotate(D$P),D$O.scale(D$s.resultMatrix.getScaleX(),D$s.resultMatrix.getScaleY()),D$O.translate(D$s.resultMatrix.tx,D$s.resultMatrix.ty),D$O.copyTo(D$s.resultMatrix),D$s.updateChild();var D$i,D$K;D$i=Math.atan2(D$U-D$T,D$e-D$j),D$r.setRotation(D$i),(D$K=D$Us._tempMatrix).identity(),D$K.rotate(D$i),D$K.scale(D$r.resultMatrix.getScaleX(),D$r.resultMatrix.getScaleY()),D$K.translate(D$j,D$T),D$O.copyTo(D$r.resultMatrix),D$r.updateChild()}},D$e(D$Us,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new D$Os}]),D$Us}(),D$Cs=function(){function D$s(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return D$U(D$s,"laya.ani.bone.IkConstraintData"),D$s}(),D$w=function(){function D$K(D$s,D$r){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=D$s,this.position=D$s.position,this.spacing=D$s.spacing,this.rotateMix=D$s.rotateMix,this.translateMix=D$s.translateMix,this.bones=[];for(var D$e=this.data.bones,D$U=0,D$m=D$e.length;D$U<D$m;D$U++)this.bones.push(D$r[D$e[D$U]])}D$U(D$K,"laya.ani.bone.PathConstraint");var D$s=D$K.prototype;return D$s.apply=function(D$s,D$r){if(this.target){var D$e=this.translateMix,D$U=this.translateMix,D$m=0<D$U,D$k=this.data.spacingMode,D$j="length"==D$k,D$T=this.data.rotateMode,D$Y="tangent"==D$T,D$Z="chainScale"==D$T,D$h=[],D$H=this.bones.length,D$A=D$Y?D$H:D$H+1,D$x=[];(this._spaces=D$x)[0]=this.position;var D$B=this.spacing;if(D$Z||D$j)for(var D$$=0,D$l=D$A-1;D$$<D$l;){var D$V=this.bones[D$$],D$b=D$V.length,D$o=D$b*D$V.resultMatrix.a,D$I=D$b*D$V.resultMatrix.b;D$b=Math.sqrt(D$o*D$o+D$I*D$I),D$Z&&(D$h[D$$]=D$b),D$x[++D$$]=D$j?Math.max(0,D$b+D$B):D$B}else for(D$$=1;D$$<D$A;D$$++)D$x[D$$]=D$B;var D$w=this.computeWorldPositions(this.target,D$s,D$r,D$A,D$Y,"percent"==this.data.positionMode,"percent"==D$k);if(this._debugKey){for(D$$=0;D$$<D$w.length;D$$++)D$r.drawCircle(D$w[D$$++],D$w[D$$++],5,"#00ff00");var D$X=[];for(D$$=0;D$$<D$w.length;D$$++)D$X.push(D$w[D$$++],D$w[D$$++]);D$r.drawLines(0,0,D$X,"#ff0000")}var D$D=D$w[0],D$n=D$w[1],D$y=this.data.offsetRotation,D$g="chain"==D$T&&0==D$y,D$f=NaN;for(D$$=0,D$f=3;D$$<D$H;D$$++,D$f+=3){(D$V=this.bones[D$$]).resultMatrix.tx+=(D$D-D$V.resultMatrix.tx)*D$e,D$V.resultMatrix.ty+=(D$n-D$V.resultMatrix.ty)*D$e;var D$J=(D$o=D$w[D$f])-D$D,D$P=(D$I=D$w[D$f+1])-D$n;if(D$Z&&0!=(D$b=D$h[D$$])){var D$O=(Math.sqrt(D$J*D$J+D$P*D$P)/D$b-1)*D$U+1;D$V.resultMatrix.a*=D$O,D$V.resultMatrix.c*=D$O}if(D$D=D$o,D$n=D$I,D$m){var D$i=D$V.resultMatrix.a,D$K=D$V.resultMatrix.c,D$c=D$V.resultMatrix.b,D$E=D$V.resultMatrix.d,D$v=NaN,D$S=NaN,D$z=NaN;D$v=D$Y?D$w[D$f-1]:0==D$x[D$$+1]?D$w[D$f+2]:Math.atan2(D$P,D$J),D$v-=Math.atan2(D$c,D$i)-D$y/180*Math.PI,D$g&&(D$S=Math.cos(D$v),D$z=Math.sin(D$v),D$D+=((D$b=D$V.length)*(D$S*D$i-D$z*D$c)-D$J)*D$U,D$n+=(D$b*(D$z*D$i+D$S*D$c)-D$P)*D$U),D$v>Math.PI?D$v-=2*Math.PI:D$v<-Math.PI&&(D$v+=2*Math.PI),D$v*=D$U,D$S=Math.cos(D$v),D$z=Math.sin(D$v),D$V.resultMatrix.a=D$S*D$i-D$z*D$c,D$V.resultMatrix.c=D$S*D$K-D$z*D$E,D$V.resultMatrix.b=D$z*D$i+D$S*D$c,D$V.resultMatrix.d=D$z*D$K+D$S*D$E}}}},D$s.computeWorldVertices2=function(D$s,D$r,D$e,D$U,D$m,D$k){var D$j,D$T,D$Y=D$s.currDisplayData.bones,D$Z=D$s.currDisplayData.weights,D$h=D$s.currDisplayData.triangles,D$H=0,D$A=0,D$x=0,D$B=0,D$$=0,D$l=0,D$V=0,D$b=0,D$o=0,D$I=0,D$w=0;if(null!=D$Y){for(D$H=0;D$H<D$e;D$H+=2)D$A+=(D$B=D$Y[D$A])+1,D$x+=D$B;var D$X=D$r;for(D$$=D$k,D$l=3*D$x;D$$<D$U;D$$+=2){for(D$b=D$V=0,D$B=D$Y[D$A++],D$B+=D$A;D$A<D$B;D$A++,D$l+=3){D$j=D$X[D$Y[D$A]].resultMatrix,D$o=D$Z[D$l],D$I=D$Z[D$l+1];var D$D=D$Z[D$l+2];D$V+=(D$o*D$j.a+D$I*D$j.c+D$j.tx)*D$D,D$b+=(D$o*D$j.b+D$I*D$j.d+D$j.ty)*D$D}D$m[D$$]=D$V,D$m[D$$+1]=D$b}}else{var D$n,D$y;if(D$h||(D$h=D$Z),D$s.deformData&&(D$h=D$s.deformData),D$n=D$s.parent,D$r)for(D$w=D$r.length,D$H=0;D$H<D$w;D$H++)if(D$r[D$H].name==D$n){D$T=D$r[D$H];break}D$T&&(D$y=D$T.resultMatrix),D$y||(D$y=D$K._tempMt);var D$g=D$y.tx,D$f=D$y.ty,D$J=D$y.a,D$P=D$y.b,D$O=D$y.c,D$i=D$y.d;for(D$T&&(D$i*=D$T.d),D$A=D$e,D$$=D$k;D$$<D$U;D$A+=2,D$$+=2)D$o=D$h[D$A],D$I=D$h[D$A+1],D$m[D$$]=D$o*D$J+D$I*D$P+D$g,D$m[D$$+1]=-(D$o*D$O+D$I*D$i+D$f)}},D$s.computeWorldPositions=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j){D$s.currDisplayData.bones,D$s.currDisplayData.weights,D$s.currDisplayData.triangles;var D$T=[],D$Y=0,D$Z=D$s.currDisplayData.verLen,D$h=this.position,D$H=this._spaces,D$A=[],D$x=[],D$B=D$Z/6,D$$=-1,D$l=NaN,D$V=0,D$b=0,D$o=NaN,D$I=NaN,D$w=NaN,D$X=NaN;if(D$B--,D$Z-=4,this.computeWorldVertices2(D$s,D$r,2,D$Z,D$T,0),this._debugKey)for(D$Y=0;D$Y<D$T.length;)D$e.drawCircle(D$T[D$Y++],D$T[D$Y++],10,"#ff0000");D$A=D$T,this._curves.length=D$B;var D$D=this._curves,D$n=D$A[D$l=0],D$y=D$A[1],D$g=0,D$f=0,D$J=0,D$P=0,D$O=0,D$i=0,D$K=NaN,D$c=NaN,D$E=NaN,D$v=NaN,D$S=NaN,D$z=NaN,D$Q=NaN,D$C=NaN,D$R=0;for(D$Y=0,D$R=2;D$Y<D$B;D$Y++,D$R+=6)D$g=D$A[D$R],D$f=D$A[D$R+1],D$J=D$A[D$R+2],D$P=D$A[D$R+3],D$S=2*(D$K=.1875*(D$n-2*D$g+D$J))+(D$E=.09375*(3*(D$g-D$J)-D$n+(D$O=D$A[D$R+4]))),D$z=2*(D$c=.1875*(D$y-2*D$f+D$P))+(D$v=.09375*(3*(D$f-D$P)-D$y+(D$i=D$A[D$R+5]))),D$Q=.75*(D$g-D$n)+D$K+.16666667*D$E,D$C=.75*(D$f-D$y)+D$c+.16666667*D$v,D$l+=Math.sqrt(D$Q*D$Q+D$C*D$C),D$Q+=D$S,D$C+=D$z,D$S+=D$E,D$z+=D$v,D$l+=Math.sqrt(D$Q*D$Q+D$C*D$C),D$Q+=D$S,D$C+=D$z,D$l+=Math.sqrt(D$Q*D$Q+D$C*D$C),D$Q+=D$S+D$E,D$C+=D$z+D$v,D$l+=Math.sqrt(D$Q*D$Q+D$C*D$C),D$D[D$Y]=D$l,D$n=D$O,D$y=D$i;if(D$k&&(D$h*=D$l),D$j)for(D$Y=0;D$Y<D$U;D$Y++)D$H[D$Y]*=D$l;var D$a=this._segments,D$p=0,D$N=0;for(D$N=D$b=D$V=D$Y=0;D$Y<D$U;D$Y++,D$V+=3)if((D$o=D$h+=D$I=D$H[D$Y])<0)this.addBeforePosition(D$o,D$A,0,D$x,D$V);else if(D$l<D$o)this.addAfterPosition(D$o-D$l,D$A,D$Z-4,D$x,D$V);else{for(;;D$b++)if(!((D$X=D$D[D$b])<D$o)){0==D$b?D$o/=D$X:D$o=(D$o-(D$w=D$D[D$b-1]))/(D$X-D$w);break}if(D$b!=D$$){var D$q=6*(D$$=D$b);for(D$n=D$A[D$q],D$y=D$A[D$q+1],D$g=D$A[D$q+2],D$f=D$A[D$q+3],D$J=D$A[D$q+4],D$P=D$A[D$q+5],D$S=2*(D$K=.03*(D$n-2*D$g+D$J))+(D$E=.006*(3*(D$g-D$J)-D$n+(D$O=D$A[D$q+6]))),D$z=2*(D$c=.03*(D$y-2*D$f+D$P))+(D$v=.006*(3*(D$f-D$P)-D$y+(D$i=D$A[D$q+7]))),D$Q=.3*(D$g-D$n)+D$K+.16666667*D$E,D$C=.3*(D$f-D$y)+D$c+.16666667*D$v,D$p=Math.sqrt(D$Q*D$Q+D$C*D$C),D$a[0]=D$p,D$q=1;D$q<8;D$q++)D$Q+=D$S,D$C+=D$z,D$S+=D$E,D$z+=D$v,D$p+=Math.sqrt(D$Q*D$Q+D$C*D$C),D$a[D$q]=D$p;D$Q+=D$S,D$C+=D$z,D$p+=Math.sqrt(D$Q*D$Q+D$C*D$C),D$a[8]=D$p,D$Q+=D$S+D$E,D$C+=D$z+D$v,D$p+=Math.sqrt(D$Q*D$Q+D$C*D$C),D$a[9]=D$p,D$N=0}for(D$o*=D$p;;D$N++)if(!((D$X=D$a[D$N])<D$o)){0==D$N?D$o/=D$X:D$o=D$N+(D$o-(D$w=D$a[D$N-1]))/(D$X-D$w);break}this.addCurvePosition(.1*D$o,D$n,D$y,D$g,D$f,D$J,D$P,D$O,D$i,D$x,D$V,D$m||0<D$Y&&0==D$I)}return D$x},D$s.addBeforePosition=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$r[D$e],D$j=D$r[D$e+1],D$T=D$r[D$e+2]-D$k,D$Y=D$r[D$e+3]-D$j,D$Z=Math.atan2(D$Y,D$T);D$U[D$m]=D$k+D$s*Math.cos(D$Z),D$U[D$m+1]=D$j+D$s*Math.sin(D$Z),D$U[D$m+2]=D$Z},D$s.addAfterPosition=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$r[D$e+2],D$j=D$r[D$e+3],D$T=D$k-D$r[D$e],D$Y=D$j-D$r[D$e+1],D$Z=Math.atan2(D$Y,D$T);D$U[D$m]=D$k+D$s*Math.cos(D$Z),D$U[D$m+1]=D$j+D$s*Math.sin(D$Z),D$U[D$m+2]=D$Z},D$s.addCurvePosition=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h,D$H){0==D$s&&(D$s=1e-4);var D$A=D$s*D$s,D$x=D$A*D$s,D$B=1-D$s,D$$=D$B*D$B,D$l=D$$*D$B,D$V=D$B*D$s,D$b=3*D$V,D$o=D$B*D$b,D$I=D$b*D$s,D$w=D$r*D$l+D$U*D$o+D$k*D$I+D$T*D$x,D$X=D$e*D$l+D$m*D$o+D$j*D$I+D$Y*D$x;D$Z[D$h]=D$w,D$Z[D$h+1]=D$X,D$Z[D$h+2]=D$H?Math.atan2(D$X-(D$e*D$$+D$m*D$V*2+D$j*D$A),D$w-(D$r*D$$+D$U*D$V*2+D$k*D$A)):0},D$K.NONE=-1,D$K.BEFORE=-2,D$K.AFTER=-3,D$e(D$K,["_tempMt",function(){return this._tempMt=new D$Os}]),D$K}(),D$Rs=function(){function D$s(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return D$U(D$s,"laya.ani.bone.PathConstraintData"),D$s}(),D$as=function(){function D$s(){this.name=null,this.slotArr=[]}return D$U(D$s,"laya.ani.bone.SkinData"),D$s}(),D$ps=function(){function D$s(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}D$U(D$s,"laya.ani.bone.SkinSlotDisplayData");var D$r=D$s.prototype;return D$r.createTexture=function(D$s){return this.texture||(this.texture=new D$is(D$s.bitmap,this.uvs),D$s.bitmap.alphaTexture&&(this.texture.alphaTexture=new D$is(D$s.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=D$s.height,this.texture.height=D$s.width,this.texture.offsetX=-D$s.offsetX,this.texture.offsetY=-D$s.offsetY,this.texture.sourceWidth=D$s.sourceHeight,this.texture.sourceHeight=D$s.sourceWidth):(this.texture.width=D$s.width,this.texture.height=D$s.height,this.texture.offsetX=-D$s.offsetX,this.texture.offsetY=-D$s.offsetY,this.texture.sourceWidth=D$s.sourceWidth,this.texture.sourceHeight=D$s.sourceHeight),D$l.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},D$r.destory=function(){this.texture&&this.texture.destroy()},D$s}(),D$Ns=function(){function D$s(){this.name=null,this.displayArr=[]}return D$U(D$s,"laya.ani.bone.SlotData"),D$s.prototype.getDisplayByName=function(D$s){for(var D$r=0,D$e=this.displayArr.length;D$r<D$e;D$r++)if(this.displayArr[D$r].attachmentName==D$s)return D$r;return-1},D$s}(),D$X=function(){function D$s(D$s,D$r){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=D$$(2,0),this._data=D$s,null==this._bones&&(this._bones=[]),this.target=D$r[D$s.targetIndex];var D$e,D$U=0;for(D$U=0,D$e=D$s.boneIndexs.length;D$U<D$e;D$U++)this._bones.push(D$r[D$s.boneIndexs[D$U]]);this.rotateMix=D$s.rotateMix,this.translateMix=D$s.translateMix,this.scaleMix=D$s.scaleMix,this.shearMix=D$s.shearMix}return D$U(D$s,"laya.ani.bone.TfConstraint"),D$s.prototype.apply=function(){for(var D$s,D$r=this.target.resultMatrix.a,D$e=this.target.resultMatrix.b,D$U=this.target.resultMatrix.c,D$m=this.target.resultMatrix.d,D$k=0,D$j=this._bones.length;D$k<D$j;D$k++){if(D$s=this._bones[D$k],0<this.rotateMix){var D$T=D$s.resultMatrix.a,D$Y=D$s.resultMatrix.b,D$Z=D$s.resultMatrix.c,D$h=D$s.resultMatrix.d,D$H=Math.atan2(D$U,D$r)-Math.atan2(D$Z,D$T)+this._data.offsetRotation*Math.PI/180;D$H>Math.PI?D$H-=2*Math.PI:D$H<-Math.PI&&(D$H+=2*Math.PI),D$H*=this.rotateMix;var D$A=Math.cos(D$H),D$x=Math.sin(D$H);D$s.resultMatrix.a=D$A*D$T-D$x*D$Z,D$s.resultMatrix.b=D$A*D$Y-D$x*D$h,D$s.resultMatrix.c=D$x*D$T+D$A*D$Z,D$s.resultMatrix.d=D$x*D$Y+D$A*D$h}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),D$s.resultMatrix.tx+=(this._temp[0]-D$s.resultMatrix.tx)*this.translateMix,D$s.resultMatrix.ty+=(this._temp[1]-D$s.resultMatrix.ty)*this.translateMix,D$s.updateChild()),0<this.scaleMix){var D$B=Math.sqrt(D$s.resultMatrix.a*D$s.resultMatrix.a+D$s.resultMatrix.c*D$s.resultMatrix.c),D$$=Math.sqrt(D$r*D$r+D$U*D$U),D$l=1e-5<D$B?(D$B+(D$$-D$B+this._data.offsetScaleX)*this.scaleMix)/D$B:0;D$s.resultMatrix.a*=D$l,D$s.resultMatrix.c*=D$l,D$B=Math.sqrt(D$s.resultMatrix.b*D$s.resultMatrix.b+D$s.resultMatrix.d*D$s.resultMatrix.d),D$$=Math.sqrt(D$e*D$e+D$m*D$m),D$l=1e-5<D$B?(D$B+(D$$-D$B+this._data.offsetScaleY)*this.scaleMix)/D$B:0,D$s.resultMatrix.b*=D$l,D$s.resultMatrix.d*=D$l}if(0<this.shearMix){D$Y=D$s.resultMatrix.b,D$h=D$s.resultMatrix.d;var D$V=Math.atan2(D$h,D$Y);(D$H=Math.atan2(D$m,D$e)-Math.atan2(D$U,D$r)-(D$V-Math.atan2(D$s.resultMatrix.c,D$s.resultMatrix.a)))>Math.PI?D$H-=2*Math.PI:D$H<-Math.PI&&(D$H+=2*Math.PI),D$H=D$V+(D$H+this._data.offsetShearY*Math.PI/180)*this.shearMix,D$l=Math.sqrt(D$Y*D$Y+D$h*D$h),D$s.resultMatrix.b=Math.cos(D$H)*D$l,D$s.resultMatrix.d=Math.sin(D$H)*D$l}}},D$s}(),D$qs=function(){function D$s(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return D$U(D$s,"laya.ani.bone.TfConstraintData"),D$s}(),D$Gs=function(){function D$s(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}D$U(D$s,"laya.ani.bone.Transform");var D$r=D$s.prototype;return D$r.initData=function(D$s){null!=D$s.x&&(this.x=D$s.x),null!=D$s.y&&(this.y=D$s.y),null!=D$s.skX&&(this.skX=D$s.skX),null!=D$s.skY&&(this.skY=D$s.skY),null!=D$s.scX&&(this.scX=D$s.scX),null!=D$s.scY&&(this.scY=D$s.scY)},D$r.getMatrix=function(){var D$s;return(D$s=this.mMatrix?this.mMatrix:this.mMatrix=new D$Os).identity(),D$s.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(D$s,this.skewX*Math.PI/180,this.skewY*Math.PI/180),D$s.rotate(this.skX*Math.PI/180),D$s.translate(this.x,this.y),D$s},D$r.skew=function(D$s,D$r,D$e){var D$U=Math.sin(D$e),D$m=Math.cos(D$e),D$k=Math.sin(D$r),D$j=Math.cos(D$r);return D$s.setTo(D$s.a*D$j-D$s.b*D$U,D$s.a*D$k+D$s.b*D$m,D$s.c*D$j-D$s.d*D$U,D$s.c*D$k+D$s.d*D$m,D$s.tx*D$j-D$s.ty*D$U,D$s.tx*D$k+D$s.ty*D$m),D$s},D$s}(),D$D=function(){function D$s(){}return D$U(D$s,"laya.ani.bone.UVTools"),D$s.getRelativeUV=function(D$s,D$r,D$e){var D$U=D$s[0],D$m=D$s[2]-D$s[0],D$k=D$s[1],D$j=D$s[5]-D$s[1];D$e||(D$e=[]),D$e.length=D$r.length;var D$T,D$Y=0;D$T=D$e.length;var D$Z=1/D$m,D$h=1/D$j;for(D$Y=0;D$Y<D$T;D$Y+=2)D$e[D$Y]=(D$r[D$Y]-D$U)*D$Z,D$e[D$Y+1]=(D$r[D$Y+1]-D$k)*D$h;return D$e},D$s.getAbsoluteUV=function(D$s,D$r,D$e){if(0==D$s[0]&&0==D$s[1]&&1==D$s[4]&&1==D$s[5])return D$e?(D$V.copyArray(D$e,D$r),D$e):D$r;var D$U=D$s[0],D$m=D$s[2]-D$s[0],D$k=D$s[1],D$j=D$s[5]-D$s[1];D$e||(D$e=[]),D$e.length=D$r.length;var D$T,D$Y=0;for(D$T=D$e.length,D$Y=0;D$Y<D$T;D$Y+=2)D$e[D$Y]=D$r[D$Y]*D$m+D$U,D$e[D$Y+1]=D$r[D$Y+1]*D$j+D$k;return D$e},D$s}(),D$K=function(){function D$s(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return D$U(D$s,"laya.ani.KeyFramesContent"),D$s}(),D$n=function(){function D$h(){}return D$U(D$h,"laya.ani.math.BezierLerp"),D$h.getBezierRate=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$h._getBezierParamKey(D$r,D$e,D$U,D$m),D$j=100*D$k+D$s;if(D$h._bezierResultCache[D$j])return D$h._bezierResultCache[D$j];var D$T,D$Y=D$h._getBezierPoints(D$r,D$e,D$U,D$m,D$k),D$Z=0;for(D$T=D$Y.length,D$Z=0;D$Z<D$T;D$Z+=2)if(D$s<=D$Y[D$Z])return D$h._bezierResultCache[D$j]=D$Y[D$Z+1],D$Y[D$Z+1];return D$h._bezierResultCache[D$j]=1},D$h._getBezierParamKey=function(D$s,D$r,D$e,D$U){return 100*(100*(100*(100*D$s+D$r)+D$e)+D$U)},D$h._getBezierPoints=function(D$s,D$r,D$e,D$U,D$m){return D$h._bezierPointsCache[D$m]?D$h._bezierPointsCache[D$m]:(D$k=[0,0,D$s,D$r,D$e,D$U,1,1],D$j=(new D$T).getBezierPoints(D$k,100,3),D$h._bezierPointsCache[D$m]=D$j);var D$k,D$j},D$h._bezierResultCache={},D$h._bezierPointsCache={},D$h}(),D$y=function(D$s){function D$r(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,D$r.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}D$U(D$r,"laya.ani.AnimationPlayer",D$m);var D$e=D$r.prototype;return D$ms.imps(D$e,{"laya.resource.IDestroy":!0}),D$e._onTempletLoadedComputeFullKeyframeIndices=function(D$s,D$r,D$e){this._templet===D$e&&this._cachePlayRate===D$s&&this._cacheFrameRate===D$r&&this._computeFullKeyframeIndices()},D$e._computeFullKeyframeIndices=function(){for(var D$s=this._fullFrames=[],D$r=this._templet,D$e=this._cacheFrameRateInterval*this._cachePlayRate,D$U=0,D$m=D$r.getAnimationCount();D$U<D$m;D$U++){for(var D$k=[],D$j=0,D$T=D$r.getAnimation(D$U).nodes.length;D$j<D$T;D$j++){for(var D$Y=D$r.getAnimation(D$U).nodes[D$j],D$Z=Math.floor(D$Y.playTime/D$e+.01),D$h=new Uint16Array(D$Z+1),D$H=-1,D$A=0,D$x=D$Y.keyFrame.length;D$A<D$x;D$A++){var D$B=D$Y.keyFrame[D$A],D$$=D$B.startTime,D$l=D$$+D$B.duration+D$e;do{for(var D$V=Math.floor(D$$/D$e+.5),D$b=D$H+1;D$b<D$V;D$b++)D$h[D$b]=D$A;D$h[D$H=D$V]=D$A,D$$+=D$e}while(D$$<=D$l)}D$k.push(D$h)}D$s.push(D$k)}},D$e._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},D$e._calculatePlayDuration=function(){if(0!==this.state){var D$s=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=D$s),this._playEnd>D$s&&(this._playEnd=D$s),this._playDuration=this._playEnd-this._playStart}},D$e._setPlayParams=function(D$s,D$r){this._currentTime=D$s,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/D$r+.01),0),this._currentFrameTime=this._currentKeyframeIndex*D$r},D$e._setPlayParamsWhenStop=function(D$s,D$r){this._currentTime=D$s,this._currentKeyframeIndex=Math.max(Math.floor(D$s/D$r+.01),0),this._currentFrameTime=this._currentKeyframeIndex*D$r,this._currentAnimationClipIndex=-1},D$e._update=function(D$s){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var D$r=this._cacheFrameRateInterval*this._cachePlayRate,D$e=0;this._startUpdateLoopCount!==D$B.loopCount&&(D$e=D$s*this.playbackRate,this._elapsedPlaybackTime+=D$e);var D$U=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=D$U)return this._setPlayParamsWhenStop(D$U,D$r),void this.event("stopped");if(D$e+=this._currentTime,0<D$U)if(D$U<=D$e)do{if(D$e-=D$U,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(D$U,D$r),this._stopWhenCircleFinish=!1,void this.event("stopped");D$e<D$U&&(this._setPlayParams(D$e,D$r),this.event("complete"))}while(D$U<=D$e);else this._setPlayParams(D$e,D$r);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(D$U,D$r),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},D$e._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},D$e.play=function(D$s,D$r,D$e,D$U,D$m){if(void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=1),void 0===D$e&&(D$e=2147483647),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(D$e<0||D$U<0||D$m<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==D$m&&D$m<D$U)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=D$r,this._overallDuration=D$e,this._playStart=D$U,this._playEnd=D$m,this._paused=!1,this._currentAnimationClipIndex=D$s,this._currentKeyframeIndex=0,this._startUpdateLoopCount=D$B.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},D$e.playByFrame=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$s&&(D$s=0),void 0===D$r&&(D$r=1),void 0===D$e&&(D$e=2147483647),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=30);var D$j=1e3/D$k;this.play(D$s,D$r,D$e,D$U*D$j,D$m*D$j)},D$e.stop=function(D$s){void 0===D$s&&(D$s=!0),D$s?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},D$k(0,D$e,"playEnd",function(){return this._playEnd}),D$k(0,D$e,"templet",function(){return this._templet},function(D$s){0===!this.state&&this.stop(!0),this._templet!==D$s&&((this._templet=D$s).loaded?this._computeFullKeyframeIndices():D$s.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),D$k(0,D$e,"playStart",function(){return this._playStart}),D$k(0,D$e,"playDuration",function(){return this._playDuration}),D$k(0,D$e,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),D$k(0,D$e,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),D$k(0,D$e,"overallDuration",function(){return this._overallDuration}),D$k(0,D$e,"currentFrameTime",function(){return this._currentFrameTime}),D$k(0,D$e,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),D$k(0,D$e,"currentPlayTime",function(){return this._currentTime+this._playStart}),D$k(0,D$e,"cachePlayRate",function(){return this._cachePlayRate},function(D$s){this._cachePlayRate!==D$s&&(this._cachePlayRate=D$s,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[D$s,this._cacheFrameRate])))}),D$k(0,D$e,"cacheFrameRate",function(){return this._cacheFrameRate},function(D$s){this._cacheFrameRate!==D$s&&(this._cacheFrameRate=D$s,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,D$s])))}),D$k(0,D$e,"currentTime",null,function(D$s){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(D$s<this._playStart||D$s>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=D$B.loopCount;var D$r=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=D$s,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/D$r),0),this._currentFrameTime=this._currentKeyframeIndex*D$r}}),D$k(0,D$e,"paused",function(){return this._paused},function(D$s){(this._paused=D$s)&&this.event("paused")}),D$k(0,D$e,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),D$k(0,D$e,"destroyed",function(){return this._destroyed}),D$r}(),D$c=function(D$s){function D$r(){D$r.__super.call(this),D$l.isConchNode&&(this.drawSkin=function(D$s){D$s.transform||(D$s.transform=D$Os.EMPTY),this._addCmd([D$s]),this.setSkinMesh&&this.setSkinMesh(D$s._ps,D$s.mVBData,D$s.mEleNum,0,D$s.mTexture,D$s.transform)})}return D$U(D$r,"laya.ani.GraphicsAni",D$j),D$r.prototype.drawSkin=function(D$s){var D$r=[D$s];this._saveToCmd(D$l._context._drawSkin,D$r)},D$r.create=function(){return D$r._caches.pop()||new D$r},D$r.recycle=function(D$s){D$s.clear(),D$r._caches.push(D$s)},D$r._caches=[],D$r}(),D$E=function(D$s){function D$b(){this._aniMap={},this.unfixedLastAniIndex=-1,D$b.__super.call(this),this._anis=new Array}D$U(D$b,"laya.ani.AnimationTemplet",D$h);var D$r=D$b.prototype;return D$r.parse=function(D$s){var D$r=new D$Ps(D$s);this._aniVersion=D$r.readUTFString(),D$o.parse(this,D$r)},D$r._calculateKeyFrame=function(D$s,D$r,D$e){var D$U=D$s.keyFrame;D$U[D$r]=D$U[0];for(var D$m=0;D$m<D$r;D$m++){var D$k=D$U[D$m];D$k.nextData=0===D$k.duration?D$k.data:D$U[D$m+1].data}D$U.length--},D$r.onAsynLoaded=function(D$s,D$r,D$e){var D$U=new D$Ps(D$r);switch(this._aniVersion=D$U.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":D$I.parse(this,D$U);break;default:D$o.parse(this,D$U)}this._endLoaded()},D$r.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},D$r.getAnimationCount=function(){return this._anis.length},D$r.getAnimation=function(D$s){return this._anis[D$s]},D$r.getAniDuration=function(D$s){return this._anis[D$s].playTime},D$r.getNodes=function(D$s){return this._anis[D$s].nodes},D$r.getNodeIndexWithName=function(D$s,D$r){return this._anis[D$s].bone3DMap[D$r]},D$r.getNodeCount=function(D$s){return this._anis[D$s].nodes.length},D$r.getTotalkeyframesLength=function(D$s){return this._anis[D$s].totalKeyframeDatasLength},D$r.getPublicExtData=function(){return this._publicExtData},D$r.getAnimationDataWithCache=function(D$s,D$r,D$e,D$U){var D$m=D$r[D$e];if(D$m){var D$k=D$m[D$s];return D$k?D$k[D$U]:null}return null},D$r.setAnimationDataWithCache=function(D$s,D$r,D$e,D$U,D$m){var D$k=D$r[D$e]||(D$r[D$e]={});(D$k[D$s]||(D$k[D$s]=[]))[D$U]=D$m},D$r.getOriginalData=function(D$s,D$r,D$e,D$U,D$m){for(var D$k=this._anis[D$s].nodes,D$j=0,D$T=0,D$Y=D$k.length,D$Z=0;D$T<D$Y;D$T++){var D$h,D$H=D$k[D$T];D$h=D$H.keyFrame[D$e[D$T][D$U]],D$H.dataOffset=D$Z;var D$A=D$m-D$h.startTime,D$x=D$H.lerpType;if(D$x)switch(D$x){case 0:case 1:for(D$j=0;D$j<D$H.keyframeWidth;)D$j+=D$H.interpolationMethod[D$j](D$H,D$j,D$r,D$Z+D$j,D$h.data,D$A,null,D$h.duration,D$h.nextData);break;case 2:var D$B=D$h.interpolationData,D$$=D$B.length,D$l=0;for(D$j=0;D$j<D$$;){var D$V=D$B[D$j];switch(D$V){case 6:case 7:D$j+=D$b.interpolation[D$V](D$H,D$l,D$r,D$Z+D$l,D$h.data,D$A,null,D$h.duration,D$h.nextData,D$B,D$j+1);break;default:D$j+=D$b.interpolation[D$V](D$H,D$l,D$r,D$Z+D$l,D$h.data,D$A,null,D$h.duration,D$h.nextData)}D$l++}}else for(D$j=0;D$j<D$H.keyframeWidth;)D$j+=D$H.interpolationMethod[D$j](D$H,D$j,D$r,D$Z+D$j,D$h.data,D$A,null,D$h.duration,D$h.nextData);D$Z+=D$H.keyframeWidth}},D$r.getNodesCurrentFrameIndex=function(D$s,D$r){var D$e=this._anis[D$s].nodes;D$s!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(D$e.length),this.unfixedCurrentTimes=new Float32Array(D$e.length),this.unfixedLastAniIndex=D$s);for(var D$U=0,D$m=D$e.length;D$U<D$m;D$U++){var D$k=D$e[D$U];for(D$r<this.unfixedCurrentTimes[D$U]&&(this.unfixedCurrentFrameIndexes[D$U]=0),this.unfixedCurrentTimes[D$U]=D$r;this.unfixedCurrentFrameIndexes[D$U]<D$k.keyFrame.length&&!(D$k.keyFrame[this.unfixedCurrentFrameIndexes[D$U]].startTime>this.unfixedCurrentTimes[D$U]);)this.unfixedCurrentFrameIndexes[D$U]++;this.unfixedCurrentFrameIndexes[D$U]--}return this.unfixedCurrentFrameIndexes},D$r.getOriginalDataUnfixedRate=function(D$s,D$r,D$e){var D$U=this._anis[D$s].nodes;D$s!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(D$U.length),this.unfixedCurrentTimes=new Float32Array(D$U.length),this.unfixedKeyframes=D$$(D$U.length),this.unfixedLastAniIndex=D$s);for(var D$m=0,D$k=0,D$j=D$U.length,D$T=0;D$k<D$j;D$k++){var D$Y=D$U[D$k];for(D$e<this.unfixedCurrentTimes[D$k]&&(this.unfixedCurrentFrameIndexes[D$k]=0),this.unfixedCurrentTimes[D$k]=D$e;this.unfixedCurrentFrameIndexes[D$k]<D$Y.keyFrame.length&&!(D$Y.keyFrame[this.unfixedCurrentFrameIndexes[D$k]].startTime>this.unfixedCurrentTimes[D$k]);)this.unfixedKeyframes[D$k]=D$Y.keyFrame[this.unfixedCurrentFrameIndexes[D$k]],this.unfixedCurrentFrameIndexes[D$k]++;var D$Z=this.unfixedKeyframes[D$k];D$Y.dataOffset=D$T;var D$h=D$e-D$Z.startTime;if(D$Y.lerpType)switch(D$Y.lerpType){case 0:case 1:for(D$m=0;D$m<D$Y.keyframeWidth;)D$m+=D$Y.interpolationMethod[D$m](D$Y,D$m,D$r,D$T+D$m,D$Z.data,D$h,null,D$Z.duration,D$Z.nextData);break;case 2:var D$H=D$Z.interpolationData,D$A=D$H.length,D$x=0;for(D$m=0;D$m<D$A;){var D$B=D$H[D$m];switch(D$B){case 6:case 7:D$m+=D$b.interpolation[D$B](D$Y,D$x,D$r,D$T+D$x,D$Z.data,D$h,null,D$Z.duration,D$Z.nextData,D$H,D$m+1);break;default:D$m+=D$b.interpolation[D$B](D$Y,D$x,D$r,D$T+D$x,D$Z.data,D$h,null,D$Z.duration,D$Z.nextData)}D$x++}}else for(D$m=0;D$m<D$Y.keyframeWidth;)D$m+=D$Y.interpolationMethod[D$m](D$Y,D$m,D$r,D$T+D$m,D$Z.data,D$h,null,D$Z.duration,D$Z.nextData);D$T+=D$Y.keyframeWidth}},D$b._LinearInterpolation_0=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){var D$h=0===D$T?0:D$k/D$T;return D$e[D$U]=(1-D$h)*D$m[D$r]+D$h*D$Y[D$r],1},D$b._QuaternionInterpolation_1=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){var D$h=0===D$T?0:D$k/D$T;return D$A.slerpQuaternionArray(D$m,D$r,D$Y,D$r,D$h,D$e,D$U),4},D$b._AngleInterpolation_2=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){return 0},D$b._RadiansInterpolation_3=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){return 0},D$b._Matrix4x4Interpolation_4=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){for(var D$h=0;D$h<16;D$h++,D$r++)D$e[D$U+D$h]=D$m[D$r]+D$k*D$j[D$r];return 16},D$b._NoInterpolation_5=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z){return D$e[D$U]=D$m[D$r],1},D$b._BezierInterpolation_6=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h){return void 0===D$h&&(D$h=0),D$e[D$U]=D$m[D$r]+(D$Y[D$r]-D$m[D$r])*D$n.getBezierRate(D$k/D$T,D$Z[D$h],D$Z[D$h+1],D$Z[D$h+2],D$Z[D$h+3]),5},D$b._BezierInterpolation_7=function(D$s,D$r,D$e,D$U,D$m,D$k,D$j,D$T,D$Y,D$Z,D$h){return void 0===D$h&&(D$h=0),D$e[D$U]=D$Z[D$h+4]+D$Z[D$h+5]*D$n.getBezierRate((.001*D$k+D$Z[D$h+6])/D$Z[D$h+7],D$Z[D$h],D$Z[D$h+1],D$Z[D$h+2],D$Z[D$h+3]),9},D$b.load=function(D$s){return D$ms.loader.create(D$s,null,null,D$b)},D$b.interpolation=[D$b._LinearInterpolation_0,D$b._QuaternionInterpolation_1,D$b._AngleInterpolation_2,D$b._RadiansInterpolation_3,D$b._Matrix4x4Interpolation_4,D$b._NoInterpolation_5,D$b._BezierInterpolation_6,D$b._BezierInterpolation_7],D$b}(),D$g=function(D$r){function D$e(D$s,D$r){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,D$e.__super.call(this),void 0===D$r&&(D$r=0),D$s&&this.init(D$s,D$r)}D$U(D$e,"laya.ani.bone.Skeleton",D$r);var D$s=D$e.prototype;return D$s.init=function(D$s,D$r){void 0===D$r&&(D$r=0);var D$e,D$U,D$m,D$k=0,D$j=0;if(1==D$r)for(this._graphicsCache=[],D$k=0,D$j=D$s.getAnimationCount();D$k<D$j;D$k++)this._graphicsCache.push([]);if(this._yReverseMatrix=D$s.yReverseMatrix,this._aniMode=D$r,this._templet=D$s,this._player=new D$y,this._player.cacheFrameRate=D$s.rate,this._player.templet=D$s,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=D$s.mBoneArr,this._rootBone=D$s.mRootBone,this._aniSectionDic=D$s.aniSectionDic,0<D$s.ikArr.length)for(this._ikArr=[],D$k=0,D$j=D$s.ikArr.length;D$k<D$j;D$k++)this._ikArr.push(new D$b(D$s.ikArr[D$k],this._boneList));if(0<D$s.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),D$k=0,D$j=D$s.pathArr.length;D$k<D$j;D$k++)D$e=D$s.pathArr[D$k],D$U=new D$w(D$e,this._boneList),(D$m=this._boneSlotDic[D$e.name])&&((D$U=new D$w(D$e,this._boneList)).target=D$m),this._pathDic[D$e.name]=D$U;if(0<D$s.tfArr.length)for(this._tfArr=[],D$k=0,D$j=D$s.tfArr.length;D$k<D$j;D$k++)this._tfArr.push(new D$X(D$s.tfArr[D$k],this._boneList));if(0<D$s.skinDataArray.length){var D$T=this._templet.skinDataArray[this._skinIndex];this._skinName=D$T.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},D$s.load=function(D$s,D$r,D$e){},D$s._onLoaded=function(){},D$s._parseComplete=function(){var D$s=D$f.TEMPLET_DICTIONARY[this._aniPath];D$s&&(this.init(D$s,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},D$s._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},D$s._onPlay=function(){this.event("played")},D$s._onStop=function(){var D$s,D$r=this._templet.eventAniArr[this._aniClipIndex];if(D$r&&this._eventIndex<D$r.length)for(;this._eventIndex<D$r.length;this._eventIndex++)(D$s=D$r[this._eventIndex]).time>=this._player.playStart&&D$s.time<=this._player.playEnd&&this.event("label",D$s);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},D$s._onPause=function(){this.event("paused")},D$s._parseSrcBoneMatrix=function(){var D$s=0,D$r=0;for(D$r=this._templet.srcBoneMatrixArr.length,D$s=0;D$s<D$r;D$s++)this._boneMatrixArray.push(new D$Os);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var D$e,D$U,D$m=this._templet.boneSlotArray;for(D$s=0,D$r=D$m.length;D$s<D$r;D$s++)D$e=D$m[D$s],null==(D$U=this._bindBoneBoneSlotDic[D$e.parent])&&(this._bindBoneBoneSlotDic[D$e.parent]=D$U=[]),this._boneSlotDic[D$e.name]=D$e=D$e.copy(),D$U.push(D$e),this._boneSlotArray.push(D$e)}},D$s._emitMissedEvents=function(D$s,D$r,D$e){void 0===D$e&&(D$e=0);var D$U=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(D$U){var D$m,D$k,D$j=0;for(D$m=D$U.length,D$j=D$e;D$j<D$m;D$j++)(D$k=D$U[D$j]).time>=this._player.playStart&&D$k.time<=this._player.playEnd&&this.event("label",D$k)}},D$s._update=function(D$s){if(void 0===D$s&&(D$s=!0),!(this._pause||D$s&&this._indexControl)){var D$r=this.timer.currTimer,D$e=this._player.currentKeyframeIndex,D$U=D$r-this._lastTime;if(D$s?this._player._update(D$U):D$e=-1,this._lastTime=D$r,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<D$U&&this._clipIndex==D$e&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var D$m;this._lastUpdateAniClipIndex=this._aniClipIndex,D$e>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var D$k,D$j=this._templet.eventAniArr[this._aniClipIndex];if(D$j&&this._eventIndex<D$j.length&&((D$m=D$j[this._eventIndex]).time>=this._player.playStart&&D$m.time<=this._player.playEnd?this._player.currentPlayTime>=D$m.time&&(this.event("label",D$m),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(D$k=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=D$k&&(this.graphics=D$k));var D$T=0,D$Y=0;for(D$Y=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,D$Y-1)&&0<D$Y;)D$Y--;if(D$Y<this._clipIndex)for(D$T=D$Y;D$T<this._clipIndex;D$T++)this._createGraphics(D$T)}else if(1==this._aniMode){if(D$k=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=D$k&&(this.graphics=D$k));for(D$Y=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,D$Y-1)&&0<D$Y;)D$Y--;if(D$Y<this._clipIndex)for(D$T=D$Y;D$T<this._clipIndex;D$T++)this._createGraphics(D$T)}this._createGraphics()}}},D$s._createGraphics=function(D$s){void 0===D$s&&(D$s=-1),-1==D$s&&(D$s=this._clipIndex);var D$r,D$e,D$U=D$s*this._player.cacheFrameRateInterval,D$m=this._templet.drawOrderAniArr[this._aniClipIndex];if(D$m&&0<D$m.length)for(this._drawOrderIndex=0,D$r=D$m[this._drawOrderIndex];D$U>=D$r.time&&(this._drawOrder=D$r.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=D$m.length));)D$r=D$m[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=D$c.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=D$c.create(),D$e=this.graphics;var D$k=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],D$s,D$U);var D$j,D$T,D$Y,D$Z,D$h=this._aniSectionDic[this._aniClipIndex],D$H=0,D$A=0,D$x=0,D$B=0,D$$=0,D$l=this._templet.srcBoneMatrixArr.length;for(D$$=D$h[D$A=0];D$A<D$l;D$A++)D$Z=this._boneList[D$A],D$Y=this._templet.srcBoneMatrixArr[D$A],D$Z.resultTransform.scX=D$Y.scX*this._curOriginalData[D$H++],D$Z.resultTransform.skX=D$Y.skX+this._curOriginalData[D$H++],D$Z.resultTransform.skY=D$Y.skY+this._curOriginalData[D$H++],D$Z.resultTransform.scY=D$Y.scY*this._curOriginalData[D$H++],D$Z.resultTransform.x=D$Y.x+this._curOriginalData[D$H++],D$Z.resultTransform.y=D$Y.y+this._curOriginalData[D$H++],8===this._templet.tMatrixDataLen&&(D$Z.resultTransform.skewX=D$Y.skewX+this._curOriginalData[D$H++],D$Z.resultTransform.skewY=D$Y.skewY+this._curOriginalData[D$H++]);var D$V,D$b={},D$o={};for(D$$+=D$h[1];D$A<D$$;D$A++)D$b[(D$V=D$k[D$A]).name]=this._curOriginalData[D$H++],D$o[D$V.name]=this._curOriginalData[D$H++],this._curOriginalData[D$H++],this._curOriginalData[D$H++],this._curOriginalData[D$H++],this._curOriginalData[D$H++];var D$I,D$w,D$X={},D$D={};for(D$$+=D$h[2];D$A<D$$;D$A++)D$X[(D$V=D$k[D$A]).name]=this._curOriginalData[D$H++],D$D[D$V.name]=this._curOriginalData[D$H++],this._curOriginalData[D$H++],this._curOriginalData[D$H++],this._curOriginalData[D$H++],this._curOriginalData[D$H++];if(this._pathDic)for(D$$+=D$h[3];D$A<D$$;D$A++){if(D$V=D$k[D$A],D$I=this._pathDic[D$V.name])switch(new D$Ps(D$V.extenData).getByte()){case 1:D$I.position=this._curOriginalData[D$H++];break;case 2:D$I.spacing=this._curOriginalData[D$H++];break;case 3:D$I.rotateMix=this._curOriginalData[D$H++],D$I.translateMix=this._curOriginalData[D$H++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(D$Os.TEMP.identity()),this._ikArr)for(D$A=0,D$$=this._ikArr.length;D$A<D$$;D$A++)D$w=this._ikArr[D$A],D$X.hasOwnProperty(D$w.name)&&(D$w.bendDirection=D$X[D$w.name]),D$D.hasOwnProperty(D$w.name)&&(D$w.mix=D$D[D$w.name]),D$w.apply();if(this._pathDic)for(var D$n in this._pathDic)(D$I=this._pathDic[D$n]).apply(this._boneList,D$e);if(this._tfArr)for(D$A=0,D$B=this._tfArr.length;D$A<D$B;D$A++)this._tfArr[D$A].apply();for(D$A=0,D$B=this._boneList.length;D$A<D$B;D$A++)if(D$Z=this._boneList[D$A],D$T=this._bindBoneBoneSlotDic[D$Z.name],D$Z.resultMatrix.copyTo(this._boneMatrixArray[D$A]),D$T)for(D$x=0,D$$=D$T.length;D$x<D$$;D$x++)(D$j=D$T[D$x])&&D$j.setParentMatrix(D$Z.resultMatrix);var D$y,D$g,D$f,D$J,D$P={},D$O=this._templet.deformAniArr;if(D$O&&0<D$O.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,D$A=0,D$$=this._boneSlotArray.length;D$A<D$$;D$A++)(D$j=this._boneSlotArray[D$A]).deformData=null;var D$i,D$K=D$O[this._aniClipIndex];for(D$i in D$y=D$K.default,this._setDeform(D$y,D$P,this._boneSlotArray,D$U),D$K)"default"!=D$i&&D$i!=this._skinName&&(D$y=D$K[D$i],this._setDeform(D$y,D$P,this._boneSlotArray,D$U));D$y=D$K[this._skinName],this._setDeform(D$y,D$P,this._boneSlotArray,D$U)}if(this._drawOrder)for(D$A=0,D$$=this._drawOrder.length;D$A<D$$;D$A++)D$g=D$b[(D$j=this._boneSlotArray[this._drawOrder[D$A]]).name],D$f=D$o[D$j.name],isNaN(D$f)||(D$e.save(),D$e.alpha(D$f)),isNaN(D$g)||-2==D$g||(this._templet.attachmentNames?D$j.showDisplayByName(this._templet.attachmentNames[D$g]):D$j.showDisplayByIndex(D$g)),D$P[this._drawOrder[D$A]]?(D$J=D$P[this._drawOrder[D$A]],D$j.currDisplayData&&D$J[D$j.currDisplayData.attachmentName]?D$j.deformData=D$J[D$j.currDisplayData.attachmentName]:D$j.deformData=null):D$j.deformData=null,isNaN(D$f)?D$j.draw(D$e,this._boneMatrixArray,2==this._aniMode):D$j.draw(D$e,this._boneMatrixArray,2==this._aniMode,D$f),isNaN(D$f)||D$e.restore();else for(D$A=0,D$$=this._boneSlotArray.length;D$A<D$$;D$A++)D$g=D$b[(D$j=this._boneSlotArray[D$A]).name],D$f=D$o[D$j.name],isNaN(D$f)||(D$e.save(),D$e.alpha(D$f)),isNaN(D$g)||-2==D$g||(this._templet.attachmentNames?D$j.showDisplayByName(this._templet.attachmentNames[D$g]):D$j.showDisplayByIndex(D$g)),D$P[D$A]?(D$J=D$P[D$A],D$j.currDisplayData&&D$J[D$j.currDisplayData.attachmentName]?D$j.deformData=D$J[D$j.currDisplayData.attachmentName]:D$j.deformData=null):D$j.deformData=null,isNaN(D$f)?D$j.draw(D$e,this._boneMatrixArray,2==this._aniMode):D$j.draw(D$e,this._boneMatrixArray,2==this._aniMode,D$f),isNaN(D$f)||D$e.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,D$s,D$e):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,D$s,D$e)},D$s._setDeform=function(D$s,D$r,D$e,D$U){if(D$s){var D$m,D$k,D$j,D$T=0,D$Y=0,D$Z=0;if(D$s)for(D$T=0,D$Y=D$s.deformSlotDataList.length;D$T<D$Y;D$T++)for(D$m=D$s.deformSlotDataList[D$T],D$Z=0;D$Z<D$m.deformSlotDisplayList.length;D$Z++)D$j=D$e[(D$k=D$m.deformSlotDisplayList[D$Z]).slotIndex],D$k.apply(D$U,D$j),D$r[D$k.slotIndex]||(D$r[D$k.slotIndex]={}),D$r[D$k.slotIndex][D$k.attachment]=D$k.deformData}},D$s.getAnimNum=function(){return this._templet.getAnimationCount()},D$s.getAniNameByIndex=function(D$s){return this._templet.getAniNameByIndex(D$s)},D$s.getSlotByName=function(D$s){return this._boneSlotDic[D$s]},D$s.showSkinByName=function(D$s,D$r){void 0===D$r&&(D$r=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(D$s),D$r)},D$s.showSkinByIndex=function(D$s,D$r){void 0===D$r&&(D$r=!0);for(var D$e=0;D$e<this._boneSlotArray.length;D$e++)this._boneSlotArray[D$e].showSlotData(null,D$r);if(this._templet.showSkinByIndex(this._boneSlotDic,D$s,D$r)){var D$U=this._templet.skinDataArray[D$s];this._skinIndex=D$s,this._skinName=D$U.name}this._clearCache()},D$s.showSlotSkinByIndex=function(D$s,D$r){if(0!=this._aniMode){var D$e=this.getSlotByName(D$s);D$e&&D$e.showDisplayByIndex(D$r),this._clearCache()}},D$s.showSlotSkinByName=function(D$s,D$r){if(0!=this._aniMode){var D$e=this.getSlotByName(D$s);D$e&&D$e.showDisplayByName(D$r),this._clearCache()}},D$s.replaceSlotSkinName=function(D$s,D$r,D$e){if(0!=this._aniMode){var D$U=this.getSlotByName(D$s);D$U&&D$U.replaceDisplayByName(D$r,D$e),this._clearCache()}},D$s.replaceSlotSkinByIndex=function(D$s,D$r,D$e){if(0!=this._aniMode){var D$U=this.getSlotByName(D$s);D$U&&D$U.replaceDisplayByIndex(D$r,D$e),this._clearCache()}},D$s.setSlotSkin=function(D$s,D$r){if(0!=this._aniMode){var D$e=this.getSlotByName(D$s);D$e&&D$e.replaceSkin(D$r),this._clearCache()}},D$s._clearCache=function(){if(1==this._aniMode)for(var D$s=0,D$r=this._graphicsCache.length;D$s<D$r;D$s++){for(var D$e=0,D$U=this._graphicsCache[D$s].length;D$e<D$U;D$e++){var D$m=this._graphicsCache[D$s][D$e];D$m!=this.graphics&&D$c.recycle(D$m)}this._graphicsCache[D$s].length=0}},D$s.play=function(D$s,D$r,D$e,D$U,D$m,D$k){void 0===D$e&&(D$e=!0),void 0===D$U&&(D$U=0),void 0===D$m&&(D$m=0),void 0===D$k&&(D$k=!0),this._indexControl=!1;var D$j=-1,D$T=NaN;if(D$T=D$r?2147483647:0,"string"==typeof D$s)for(var D$Y=0,D$Z=this._templet.getAnimationCount();D$Y<D$Z;D$Y++){var D$h=this._templet.getAnimation(D$Y);if(D$h&&D$s==D$h.name){D$j=D$Y;break}}else D$j=D$s;-1<D$j&&D$j<this.getAnimNum()&&(this._aniClipIndex=D$j,(D$e||this._pause||this._currAniIndex!=D$j)&&(this._currAniIndex=D$j,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(D$j)),this._drawOrder=null,this._eventIndex=0,this._player.play(D$j,this._player.playbackRate,D$T,D$U,D$m),D$k&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=D$H.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},D$s.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},D$s.playbackRate=function(D$s){this._player&&(this._player.playbackRate=D$s)},D$s.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},D$s.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=D$H.now(),this.timer.frameLoop(1,this,this._update,null,!0))},D$s._getGrahicsDataWithCache=function(D$s,D$r){return this._graphicsCache[D$s][D$r]},D$s._setGrahicsDataWithCache=function(D$s,D$r,D$e){this._graphicsCache[D$s][D$r]=D$e},D$s.destroy=function(D$s){void 0===D$s&&(D$s=!0),D$r.prototype.destroy.call(this,D$s),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},D$k(0,D$s,"url",function(){return this._aniPath},function(D$s){this.load(D$s)}),D$k(0,D$s,"index",function(){return this._index},function(D$s){this.player&&(this._index=D$s,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),D$k(0,D$s,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),D$k(0,D$s,"templet",function(){return this._templet}),D$k(0,D$s,"player",function(){return this._player}),D$e.useSimpleMeshInCanvas=!1,D$e}(D$ks),D$f=function(D$r){function D$m(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,D$m.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}D$U(D$m,"laya.ani.bone.Templet",D$r);var D$s=D$m.prototype;return D$s.getLoadList=function(){return this._loadList},D$s.loadAni=function(D$s){this._skBufferUrl=D$s,D$ms.loader.load(D$s,D$Y.create(this,this.onComplete),null,"arraybuffer")},D$s.onComplete=function(D$s){if(this._isDestroyed)this.destroy();else{var D$r=D$Z.getRes(this._skBufferUrl);D$r?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,D$r)):this.event("error","load failed:"+this._skBufferUrl)}},D$s.parseData=function(D$s,D$r,D$e){void 0===D$e&&(D$e=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=D$s,this._mainTexture&&D$l.isWebGL&&D$s.bitmap&&(D$s.bitmap.enableMerageInAtlas=!1),this._rate=D$e,this.parse(D$r)},D$s.buildArmature=function(D$s){return void 0===D$s&&(D$s=0),new D$g(this,D$s)},D$s.parse=function(D$s){D$r.prototype.parse.call(this,D$s),this._endLoaded(),this._aniVersion!=D$m.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+D$m.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},D$s._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var D$s=0;this._loadList=[];var D$r,D$e=new D$Ps(this.getPublicExtData()),D$U=0,D$m=0,D$k=0,D$j=D$e.getInt32(),D$T=D$e.readUTFString(),D$Y=D$T.split("\n");for(D$s=0;D$s<D$j;D$s++)D$r=this._path+D$Y[2*D$s],D$T=D$Y[2*D$s+1],D$e.getFloat32(),D$e.getFloat32(),D$U=D$e.getFloat32(),D$m=D$e.getFloat32(),D$k=D$e.getFloat32(),isNaN(D$k)?0:D$k,D$k=D$e.getFloat32(),isNaN(D$k)?0:D$k,D$k=D$e.getFloat32(),isNaN(D$k)?D$U:D$k,D$k=D$e.getFloat32(),isNaN(D$k)?D$m:D$k,-1==this._loadList.indexOf(D$r)&&this._loadList.push(D$r);this.event("inited",this)}},D$s._textureComplete=function(){for(var D$s,D$r,D$e=0,D$U=this._loadList.length;D$e<D$U;D$e++)D$r=this._loadList[D$e],D$s=this._textureDic[D$r]=D$Z.getRes(D$r),D$l.isWebGL&&D$s&&D$s.bitmap&&(D$s.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},D$s._parsePublicExtData=function(){var D$s=0,D$r=0,D$e=0,D$U=0,D$m=0;for(D$s=0,D$m=this.getAnimationCount();D$s<D$m;D$s++)this._graphicsCache.push([]);var D$k;D$k="Dragon"!=this._aniClassName;var D$j,D$T,D$Y=new D$Ps(this.getPublicExtData()),D$Z=0,D$h=0,D$H=0,D$A=0,D$x=0,D$B=0,D$$=0,D$l=0,D$V=0,D$b=D$Y.getInt32(),D$o=D$Y.readUTFString(),D$I=D$o.split("\n");for(D$s=0;D$s<D$b;D$s++){if(D$j=this._mainTexture,D$T=this._path+D$I[2*D$s],D$o=D$I[2*D$s+1],null==this._mainTexture&&(D$j=this._textureDic[D$T]),!D$j)return this.event("error",this),void(this.isParseFail=!0);D$Z=D$Y.getFloat32(),D$h=D$Y.getFloat32(),D$H=D$Y.getFloat32(),D$A=D$Y.getFloat32(),D$V=D$Y.getFloat32(),D$x=isNaN(D$V)?0:D$V,D$V=D$Y.getFloat32(),D$B=isNaN(D$V)?0:D$V,D$V=D$Y.getFloat32(),D$$=isNaN(D$V)?D$H:D$V,D$V=D$Y.getFloat32(),D$l=isNaN(D$V)?D$A:D$V,this.subTextureDic[D$o]=D$is.create(D$j,D$Z,D$h,D$H,D$A,-D$x,-D$B,D$$,D$l),D$j.alphaTexture&&(this.subTextureDic[D$o].alphaTexture=D$is.create(D$j.alphaTexture,D$Z,D$h,D$H,D$A,-D$x,-D$B,D$$,D$l))}this._mainTexture=D$j;var D$w,D$X,D$D,D$n,D$y,D$g=D$Y.getUint16();for(D$s=0;D$s<D$g;D$s++)(D$w=[]).push(D$Y.getUint16()),D$w.push(D$Y.getUint16()),D$w.push(D$Y.getUint16()),D$w.push(D$Y.getUint16()),this.aniSectionDic[D$s]=D$w;var D$f,D$J=D$Y.getInt16(),D$P={};for(D$s=0;D$s<D$J;D$s++)D$X=new D$Ks,0==D$s?D$f=D$X:D$X.root=D$f,D$X.d=D$k?-1:1,D$n=D$Y.readUTFString(),D$y=D$Y.readUTFString(),D$X.length=D$Y.getFloat32(),1==D$Y.getByte()&&(D$X.inheritRotation=!1),1==D$Y.getByte()&&(D$X.inheritScale=!1),D$X.name=D$n,D$y&&((D$D=D$P[D$y])?D$D.addChild(D$X):this.mRootBone=D$X),D$P[D$n]=D$X,this.mBoneArr.push(D$X);this.tMatrixDataLen=D$Y.getUint16();var D$O,D$i,D$K=D$Y.getUint16(),D$c=Math.floor(D$K/this.tMatrixDataLen),D$E=this.srcBoneMatrixArr;for(D$s=0;D$s<D$c;D$s++)(D$O=new D$Gs).scX=D$Y.getFloat32(),D$O.skX=D$Y.getFloat32(),D$O.skY=D$Y.getFloat32(),D$O.scY=D$Y.getFloat32(),D$O.x=D$Y.getFloat32(),D$O.y=D$Y.getFloat32(),8===this.tMatrixDataLen&&(D$O.skewX=D$Y.getFloat32(),D$O.skewY=D$Y.getFloat32()),D$E.push(D$O),(D$X=this.mBoneArr[D$s]).transform=D$O;var D$v,D$S=D$Y.getUint16(),D$z=0;for(D$s=0;D$s<D$S;D$s++){for(D$i=new D$Cs,D$z=D$Y.getUint16(),D$r=0;D$r<D$z;D$r++)D$i.boneNames.push(D$Y.readUTFString()),D$i.boneIndexs.push(D$Y.getInt16());D$i.name=D$Y.readUTFString(),D$i.targetBoneName=D$Y.readUTFString(),D$i.targetBoneIndex=D$Y.getInt16(),D$i.bendDirection=D$Y.getFloat32(),D$i.mix=D$Y.getFloat32(),D$i.isSpine=D$k,this.ikArr.push(D$i)}var D$Q,D$C=D$Y.getUint16(),D$R=0;for(D$s=0;D$s<D$C;D$s++){for(D$v=new D$qs,D$R=D$Y.getUint16(),D$r=0;D$r<D$R;D$r++)D$v.boneIndexs.push(D$Y.getInt16());D$v.name=D$Y.getUTFString(),D$v.targetIndex=D$Y.getInt16(),D$v.rotateMix=D$Y.getFloat32(),D$v.translateMix=D$Y.getFloat32(),D$v.scaleMix=D$Y.getFloat32(),D$v.shearMix=D$Y.getFloat32(),D$v.offsetRotation=D$Y.getFloat32(),D$v.offsetX=D$Y.getFloat32(),D$v.offsetY=D$Y.getFloat32(),D$v.offsetScaleX=D$Y.getFloat32(),D$v.offsetScaleY=D$Y.getFloat32(),D$v.offsetShearY=D$Y.getFloat32(),this.tfArr.push(D$v)}var D$a=D$Y.getUint16(),D$p=0;for(D$s=0;D$s<D$a;D$s++){for((D$Q=new D$Rs).name=D$Y.readUTFString(),D$p=D$Y.getUint16(),D$r=0;D$r<D$p;D$r++)D$Q.bones.push(D$Y.getInt16());D$Q.target=D$Y.readUTFString(),D$Q.positionMode=D$Y.readUTFString(),D$Q.spacingMode=D$Y.readUTFString(),D$Q.rotateMode=D$Y.readUTFString(),D$Q.offsetRotation=D$Y.getFloat32(),D$Q.position=D$Y.getFloat32(),D$Q.spacing=D$Y.getFloat32(),D$Q.rotateMix=D$Y.getFloat32(),D$Q.translateMix=D$Y.getFloat32(),this.pathArr.push(D$Q)}var D$N,D$q,D$G,D$d,D$t,D$W=0,D$L=0,D$u=0,D$M=NaN,D$_=0,D$F=D$Y.getInt16();for(D$s=0;D$s<D$F;D$s++){var D$ss=D$Y.getUint8(),D$rs={};this.deformAniArr.push(D$rs);for(var D$es=0;D$es<D$ss;D$es++)for((D$N=new D$Es).skinName=D$Y.getUTFString(),D$rs[D$N.skinName]=D$N,D$W=D$Y.getInt16(),D$r=0;D$r<D$W;D$r++)for(D$q=new D$vs,D$N.deformSlotDataList.push(D$q),D$L=D$Y.getInt16(),D$e=0;D$e<D$L;D$e++)for(D$G=new D$Ss,D$q.deformSlotDisplayList.push(D$G),D$G.slotIndex=D$Y.getInt16(),D$G.attachment=D$Y.getUTFString(),D$u=D$Y.getInt16(),D$U=0;D$U<D$u;D$U++)for(1==D$Y.getByte()?D$G.tweenKeyList.push(!0):D$G.tweenKeyList.push(!1),D$M=D$Y.getFloat32(),D$G.timeList.push(D$M),D$d=[],D$G.vectices.push(D$d),D$_=D$Y.getInt16(),D$m=0;D$m<D$_;D$m++)D$d.push(D$Y.getFloat32())}var D$Us,D$ms,D$ks=D$Y.getInt16(),D$js=0,D$Ts=0;for(D$s=0;D$s<D$ks;D$s++){for(D$js=D$Y.getInt16(),D$t=[],D$r=0;D$r<D$js;D$r++){for((D$Us=new D$zs).time=D$Y.getFloat32(),D$Ts=D$Y.getInt16(),D$e=0;D$e<D$Ts;D$e++)D$Us.drawOrder.push(D$Y.getInt16());D$t.push(D$Us)}this.drawOrderAniArr.push(D$t)}var D$Ys,D$Zs=D$Y.getInt16(),D$hs=0;for(D$s=0;D$s<D$Zs;D$s++){for(D$hs=D$Y.getInt16(),D$ms=[],D$r=0;D$r<D$hs;D$r++)(D$Ys=new D$Qs).name=D$Y.getUTFString(),D$Ys.intValue=D$Y.getInt32(),D$Ys.floatValue=D$Y.getFloat32(),D$Ys.stringValue=D$Y.getUTFString(),D$Ys.time=D$Y.getFloat32(),D$ms.push(D$Ys);this.eventAniArr.push(D$ms)}var D$Hs=D$Y.getInt16();if(0<D$Hs)for(this.attachmentNames=[],D$s=0;D$s<D$Hs;D$s++)this.attachmentNames.push(D$Y.getUTFString());var D$As,D$xs,D$Bs=D$Y.getInt16();for(D$s=0;D$s<D$Bs;D$s++)(D$As=new D$cs).name=D$Y.readUTFString(),D$As.parent=D$Y.readUTFString(),D$As.attachmentName=D$Y.readUTFString(),D$As.srcDisplayIndex=D$As.displayIndex=D$Y.getInt16(),(D$As.templet=this).boneSlotDic[D$As.name]=D$As,null==(D$xs=this.bindBoneBoneSlotDic[D$As.parent])&&(this.bindBoneBoneSlotDic[D$As.parent]=D$xs=[]),D$xs.push(D$As),this.boneSlotArray.push(D$As);var D$$s,D$ls,D$Vs,D$bs=D$Y.readUTFString().split("\n"),D$os=0,D$Is=D$Y.getUint8(),D$ws=0,D$Xs=0,D$Ds=0,D$ns=0,D$ys=0,D$gs=0,D$fs=0;for(D$s=0;D$s<D$Is;D$s++){for((D$$s=new D$as).name=D$bs[D$os++],D$ws=D$Y.getUint8(),D$r=0;D$r<D$ws;D$r++){for((D$ls=new D$Ns).name=D$bs[D$os++],D$As=this.boneSlotDic[D$ls.name],D$Xs=D$Y.getUint8(),D$e=0;D$e<D$Xs;D$e++){if(D$Vs=new D$ps,this.skinSlotDisplayDataArr.push(D$Vs),D$Vs.name=D$bs[D$os++],D$Vs.attachmentName=D$bs[D$os++],D$Vs.transform=new D$Gs,D$Vs.transform.scX=D$Y.getFloat32(),D$Vs.transform.skX=D$Y.getFloat32(),D$Vs.transform.skY=D$Y.getFloat32(),D$Vs.transform.scY=D$Y.getFloat32(),D$Vs.transform.x=D$Y.getFloat32(),D$Vs.transform.y=D$Y.getFloat32(),D$ls.displayArr.push(D$Vs),D$Vs.width=D$Y.getFloat32(),D$Vs.height=D$Y.getFloat32(),D$Vs.type=D$Y.getUint8(),D$Vs.verLen=D$Y.getUint16(),0<(D$J=D$Y.getUint16()))for(D$Vs.bones=[],D$U=0;D$U<D$J;D$U++){var D$Js=D$Y.getUint16();D$Vs.bones.push(D$Js)}if(0<(D$Ds=D$Y.getUint16()))for(D$Vs.uvs=[],D$U=0;D$U<D$Ds;D$U++)D$Vs.uvs.push(D$Y.getFloat32());if(0<(D$ns=D$Y.getUint16()))for(D$Vs.weights=[],D$U=0;D$U<D$ns;D$U++)D$Vs.weights.push(D$Y.getFloat32());if(0<(D$ys=D$Y.getUint16()))for(D$Vs.triangles=[],D$U=0;D$U<D$ys;D$U++)D$Vs.triangles.push(D$Y.getUint16());if(0<(D$gs=D$Y.getUint16()))for(D$Vs.vertices=[],D$U=0;D$U<D$gs;D$U++)D$Vs.vertices.push(D$Y.getFloat32());if(0<(D$fs=D$Y.getUint16()))for(D$Vs.lengths=[],D$U=0;D$U<D$fs;D$U++)D$Vs.lengths.push(D$Y.getFloat32())}D$$s.slotArr.push(D$ls)}this.skinDic[D$$s.name]=D$$s,this.skinDataArray.push(D$$s)}1==D$Y.getUint8()?(this.yReverseMatrix=new D$Os(1,0,0,-1,0,0),D$f&&D$f.setTempMatrix(this.yReverseMatrix)):D$f&&D$f.setTempMatrix(new D$Os),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},D$s.getTexture=function(D$s){var D$r=this.subTextureDic[D$s];return D$r||(D$r=this.subTextureDic[D$s.substr(0,D$s.length-1)]),null==D$r?this._mainTexture:D$r},D$s.showSkinByIndex=function(D$s,D$r,D$e){if(void 0===D$e&&(D$e=!0),D$r<0&&D$r>=this.skinDataArray.length)return!1;var D$U,D$m,D$k=0,D$j=0,D$T=this.skinDataArray[D$r];if(D$T){for(D$k=0,D$j=D$T.slotArr.length;D$k<D$j;D$k++)(D$m=D$T.slotArr[D$k])&&(D$U=D$s[D$m.name])&&(D$U.showSlotData(D$m,D$e),D$e&&"undefined"!=D$U.attachmentName&&"null"!=D$U.attachmentName?D$U.showDisplayByName(D$U.attachmentName):D$U.showDisplayByIndex(D$U.displayIndex));return!0}return!1},D$s.getSkinIndexByName=function(D$s){for(var D$r=0,D$e=this.skinDataArray.length;D$r<D$e;D$r++)if(this.skinDataArray[D$r].name==D$s)return D$r;return-1},D$s.getGrahicsDataWithCache=function(D$s,D$r){return this._graphicsCache[D$s][D$r]},D$s.setGrahicsDataWithCache=function(D$s,D$r,D$e){this._graphicsCache[D$s][D$r]=D$e},D$s.destroy=function(){var D$s;for(var D$r in this._isDestroyed=!0,this.subTextureDic)(D$s=this.subTextureDic[D$r])&&D$s.destroy();for(D$r in this._textureDic)(D$s=this._textureDic[D$r])&&D$s.destroy();for(var D$e=0,D$U=this.skinSlotDisplayDataArr.length;D$e<D$U;D$e++)this.skinSlotDisplayDataArr[D$e].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete D$m.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},D$s.getAniNameByIndex=function(D$s){var D$r=this.getAnimation(D$s);return D$r?D$r.name:null},D$k(0,D$s,"rate",function(){return this._rate},function(D$s){this._rate=D$s}),D$m.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",D$m.TEMPLET_DICTIONARY=null,D$m}(D$E)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(D$s,D$r){"use strict";for(var D$e in Object.defineProperty(D$r,"__esModule",{value:!0}),Laya){var D$U=Laya[D$e];D$U&&D$U.__isclass&&(D$r[D$e]=D$U)}});