var Laya=window.Laya=function(p$Y,p$h){var p$C={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(p$h,p$q){return 1==arguments.length?p$C.__presubstr.call(this,p$h):p$C.__presubstr.call(this,p$h,0<p$q?p$q:this.length+p$q)},__init:function(p$h){p$h.forEach(function(p$h){p$h.__init$&&p$h.__init$()})},__isClass:function(p$h){return p$h&&(p$h.__isclass||p$h==Object||p$h==String||p$h==Array)},__newvec:function(p$h,p$q){var p$f=[];p$f.length=p$h;for(var p$g=0;p$g<p$h;p$g++)p$f[p$g]=p$q;return p$f},__extend:function(p$h,p$q){for(var p$f in p$q)if(p$q.hasOwnProperty(p$f)){var p$g=Object.getOwnPropertyDescriptor(p$q,p$f),p$$=p$g.get,p$P=p$g.set;p$$||p$P?p$$&&p$P?Object.defineProperty(p$h,p$f,p$g):(p$$&&Object.defineProperty(p$h,p$f,p$$),p$P&&Object.defineProperty(p$h,p$f,p$P)):p$h[p$f]=p$q[p$f]}function p$S(){p$C.un(this,"constructor",p$h)}p$S.prototype=p$q.prototype,p$h.prototype=new p$S,p$C.un(p$h.prototype,"__imps",p$C.__copy({},p$q.prototype.__imps))},__copy:function(p$h,p$q){if(!p$q)return null;for(var p$f in p$h=p$h||{},p$q)p$h[p$f]=p$q[p$f];return p$h},__package:function(p$h,p$q){if(!p$C.__packages[p$h]){p$C.__packages[p$h]=!0;var p$f=p$Y,p$g=p$h.split(".");if(1<p$g.length)for(var p$$=0,p$P=p$g.length-1;p$$<p$P;p$$++){var p$S=p$f[p$g[p$$]];p$f=p$S||(p$f[p$g[p$$]]={})}p$f[p$g[p$g.length-1]]||(p$f[p$g[p$g.length-1]]=p$q||{})}},__hasOwnProperty:function(p$h,p$q){return p$q=p$q||this,Object.hasOwnProperty.call(p$q,p$h)||function p$h(p$q,p$f){if(Object.hasOwnProperty.call(p$f.prototype,p$q))return!0;var p$g=p$f.prototype.__super;return null==p$g?null:p$h(p$q,p$g)}(p$h,p$q.__class)},__typeof:function(p$h,p$q){if(!p$h||!p$q)return!1;if(p$q===String)return"string"==typeof p$h;if(p$q===Number)return"number"==typeof p$h;if(p$q.__interface__)p$q=p$q.__interface__;else if("string"!=typeof p$q)return p$h instanceof p$q;return p$h.__imps&&p$h.__imps[p$q]||p$h.__class==p$q},__as:function(p$h,p$q){return this.__typeof(p$h,p$q)?p$h:null},__int:function(p$h){return p$h?parseInt(p$h):0},interface:function(p$h,p$q){p$C.__package(p$h,{});var p$f=p$C.__internals,p$g=p$f[p$h]=p$f[p$h]||{self:p$h};if(p$q){var p$$=p$q.split(",");p$g.extend=[];for(var p$P=0;p$P<p$$.length;p$P++){var p$S=p$$[p$P];p$f[p$S]=p$f[p$S]||{self:p$S},p$g.extend.push(p$f[p$S])}}var p$B=p$Y,p$r=p$h.split(".");for(p$P=0;p$P<p$r.length-1;p$P++)p$B=p$B[p$r[p$P]];p$B[p$r[p$r.length-1]]={__interface__:p$h}},class:function(p$h,p$q,p$f,p$g){if(p$f&&p$C.__extend(p$h,p$f),p$q)if(p$C.__package(p$q,p$h),p$C.__classmap[p$q]=p$h,0<p$q.indexOf(".")){if(0==p$q.indexOf("laya.")){var p$$=p$q.split(".");p$g=p$g||p$$[p$$.length-1],p$C[p$g]&&console.log("Warning!,this class["+p$g+"] already exist:",p$C[p$g]),p$C[p$g]=p$h}}else"Main"==p$q?p$Y.Main=p$h:"MainWX"==p$q?p$Y.MainWX=p$h:(p$C[p$q]&&console.log("Error!,this class["+p$q+"] already exist:",p$C[p$q]),p$C[p$q]=p$h);var p$P=p$C.un,p$S=p$h.prototype;p$P(p$S,"hasOwnProperty",p$C.__hasOwnProperty),p$P(p$S,"__class",p$h),p$P(p$S,"__super",p$f),p$P(p$S,"__className",p$q),p$P(p$h,"__super",p$f),p$P(p$h,"__className",p$q),p$P(p$h,"__isclass",!0),p$P(p$h,"super",function(p$h){this.__super.call(p$h)})},imps:function(p$h,p$q){if(!p$q)return null;var p$$=p$h.__imps||p$C.un(p$h,"__imps",{});function p$P(p$h){var p$q,p$f;if((p$q=p$C.__internals[p$h])&&(p$$[p$h]=!0,p$f=p$q.extend))for(var p$g=0;p$g<p$f.length;p$g++)p$P(p$f[p$g].self)}for(var p$f in p$q)p$P(p$f)},superSet:function(p$h,p$q,p$f,p$g){var p$$=p$h.prototype["_$set_"+p$f];p$$&&p$$.call(p$q,p$g)},superGet:function(p$h,p$q,p$f){var p$g=p$h.prototype["_$get_"+p$f];return p$g?p$g.call(p$q):null},getset:function(p$h,p$q,p$f,p$g,p$$){p$h?(p$g&&(p$q["_$GET_"+p$f]=p$g),p$$&&(p$q["_$SET_"+p$f]=p$$)):(p$g&&p$C.un(p$q,"_$get_"+p$f,p$g),p$$&&p$C.un(p$q,"_$set_"+p$f,p$$)),p$g&&p$$?Object.defineProperty(p$q,p$f,{get:p$g,set:p$$,enumerable:!1,configurable:!0}):(p$g&&Object.defineProperty(p$q,p$f,{get:p$g,enumerable:!1,configurable:!0}),p$$&&Object.defineProperty(p$q,p$f,{set:p$$,enumerable:!1,configurable:!0}))},static:function(p$f,p$g){for(var p$$=0,p$h=p$g.length;p$$<p$h;p$$+=2)if("length"==p$g[p$$])p$f.length=p$g[p$$+1].call(p$f);else{function p$q(){var p$q=p$g[p$$],p$h=p$g[p$$+1];Object.defineProperty(p$f,p$q,{get:function(){return delete this[p$q],this[p$q]=p$h.call(this)},set:function(p$h){delete this[p$q],this[p$q]=p$h},enumerable:!0,configurable:!0})}p$q()}},un:function(p$h,p$q,p$f){return p$f||(p$f=p$h[p$q]),p$C.__propun.value=p$f,Object.defineProperty(p$h,p$q,p$C.__propun),p$f},uns:function(p$q,p$h){p$h.forEach(function(p$h){p$C.un(p$q,p$h)})}};return p$Y.console=p$Y.console||{log:function(){}},p$Y.trace=p$Y.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),p$C}(window,document);!function(p$h,p$q,p$f){p$f.un,p$f.uns,p$f.static,p$f.class,p$f.getset,p$f.__newvec}(window,document,Laya),function(p$S,p$q,p$t){p$t.un,p$t.uns;var p$r=p$t.static,p$C=p$t.class,p$L=p$t.getset;p$t.__newvec;p$t.interface("laya.runtime.IMarket"),p$t.interface("laya.filters.IFilter"),p$t.interface("laya.display.ILayout"),p$t.interface("laya.resource.IDispose"),p$t.interface("laya.runtime.IPlatform"),p$t.interface("laya.resource.IDestroy"),p$t.interface("laya.runtime.IConchNode"),p$t.interface("laya.filters.IFilterAction"),p$t.interface("laya.runtime.ICPlatformClass"),p$t.interface("laya.resource.ICreateResource"),p$t.interface("laya.runtime.IConchRenderObject"),p$t.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var p$d=function(){function p$P(){}return p$C(p$P,"laya.utils.RunDriver"),p$P.FILTER_ACTIONS=[],p$P.pixelRatio=-1,p$P._charSizeTestDiv=null,p$P.now=function(){return Date.now()},p$P.getWindow=function(){return p$S},p$P.getPixelRatio=function(){if(p$P.pixelRatio<0){var p$h=p$w.context,p$q=p$h.backingStorePixelRatio||p$h.webkitBackingStorePixelRatio||p$h.mozBackingStorePixelRatio||p$h.msBackingStorePixelRatio||p$h.oBackingStorePixelRatio||p$h.backingStorePixelRatio||1;(p$P.pixelRatio=(p$w.window.devicePixelRatio||1)/p$q)<1&&(p$P.pixelRatio=1)}return p$P.pixelRatio},p$P.getIncludeStr=function(p$h){return null},p$P.createShaderCondition=function(p$h){var p$q="(function() {return "+p$h+";})";return p$t._runScript(p$q)},p$P.fontMap=[],p$P.measureText=function(p$h,p$q){var p$f=p$P.hanzi.test(p$h);if(p$f&&p$P.fontMap[p$q])return p$P.fontMap[p$q];var p$g=p$w.context;p$g.font=p$q;var p$$=p$g.measureText(p$h);return p$f&&(p$P.fontMap[p$q]=p$$),p$$},p$P.getWebGLContext=function(p$h){},p$P.beginFlush=function(){},p$P.endFinish=function(){},p$P.addToAtlas=null,p$P.flashFlushImage=function(p$h){},p$P.drawToCanvas=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$Gh.create("2D"),p$B=new p$M(p$f,p$g,p$S);return p$W.renders[p$q]._fun(p$h,p$B,p$$,p$P),p$S},p$P.createParticleTemplate2D=null,p$P.createGLTextur=null,p$P.createWebGLContext2D=null,p$P.changeWebGLSize=function(p$h,p$q){},p$P.createRenderSprite=function(p$h,p$q){return new p$W(p$h,p$q)},p$P.createFilterAction=function(p$h){return new p$G},p$P.createGraphics=function(){return new p$u},p$P.clear=function(p$h){p$c._context.ctx.clear()},p$P.cancelLoadByUrl=function(p$h){},p$P.clearAtlas=function(p$h){},p$P.isAtlas=function(p$h){return!1},p$P.addTextureToAtlas=function(p$h){},p$P.getTexturePixels=function(p$h,p$q,p$f,p$g,p$$){return null},p$P.skinAniSprite=function(){return null},p$P.update3DLoop=function(){},p$r(p$P,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),p$P}(),p$g=(p$L(1,p$t,"alertGlobalError",null,function(p$h){var p$P=0;p$w.window.onerror=p$h?function(p$h,p$q,p$f,p$g,p$$){p$P++<5&&p$$&&alert(p$$.stack||p$$)}:null}),p$t.init=function(p$h,p$q,p$f){for(var p$g=[],p$$=2,p$P=arguments.length;p$$<p$P;p$$++)p$g.push(arguments[p$$]);if(!p$t._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=p$t._arrayBufferSlice),p$t._isinit=!0,p$w.__init__(),p$T.__init__(),p$u.__init__(),p$t.timer=new p$Q,p$t.scaleTimer=new p$Q,p$t.loader=new p$rh,p$x.__init__(),p$$=0;for(var p$S=p$g.length;p$$<p$S;p$$++)p$g[p$$].enable&&p$g[p$$].enable();return p$v.__init__(),p$B.__init__(),p$I.__init__(),p$H.beginCheck(),p$t._currentStage=p$t.stage=new p$_h,p$t.stage.conchModel&&p$t.stage.conchModel.setRootNode(),p$t._getUrlPath(),p$t.render=new p$c(0,0),p$t.stage.size(p$h,p$q),p$W.__init__(),p$U.__init__(),p$e.instance.__init__(p$t.stage,p$c.canvas),p$Eh.__init__(),p$A.autoStopMusic=!0,p$J.__init__(),p$c.canvas}},p$t._getUrlPath=function(){var p$h=p$w.window.location,p$q=p$h.pathname;p$q=p$q&&":"==p$q.charAt(2)?p$q.substring(1):p$q,p$z.rootPath=p$z.basePath=p$z.getPath("file:"==p$h.protocol?p$q:p$h.protocol+"//"+p$h.host+p$h.pathname)},p$t._arrayBufferSlice=function(p$h,p$q){var p$f=new Uint8Array(this,p$h,p$q-p$h),p$g=new Uint8Array(p$f.length);return p$g.set(p$f),p$g.buffer},p$t._runScript=function(p$h){return p$w.window[p$t._evcode](p$h)},p$t.stage=null,p$t.timer=null,p$t.scaleTimer=null,p$t.loader=null,p$t.version="1.8.6",p$t.render=null,p$t._currentStage=null,p$t._isinit=!1,p$t.isDebug=!1,p$t.MiniAdpter={init:function(){p$S.navigator&&p$S.navigator.userAgent&&-1<p$S.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},p$r(p$t,["conchMarket",function(){return this.conchMarket=p$S.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=p$S.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function p$h(){}return p$C(p$h,"Config"),p$h.WebGLTextCacheCount=500,p$h.atlasEnable=!1,p$h.showCanvasMark=!1,p$h.animationInterval=50,p$h.isAntialias=!1,p$h.isAlpha=!1,p$h.premultipliedAlpha=!0,p$h.isStencil=!0,p$h.preserveDrawingBuffer=!1,p$h}()),p$Y=function(){function p$Y(){this._events=null}p$C(p$Y,"laya.events.EventDispatcher");var p$h=p$Y.prototype;return p$h.hasListener=function(p$h){return!!(this._events&&this._events[p$h])},p$h.event=function(p$h,p$q){if(!this._events||!this._events[p$h])return!1;var p$f=this._events[p$h];if(p$f.lock)p$f.queue||(p$f.queue=[]),p$f.queue.push(p$q);else{var p$g;for(p$f.lock=!0,p$f.cursor=p$f.head;p$f.cursor;)p$g=p$f.cursor,p$f.cursor=p$g.next,p$g.once&&p$Y.delNode(p$f,p$g),null!=p$q?p$g.args?p$g.method.apply(p$g.caller,p$g.args.concat(p$q)):p$q instanceof Array?p$g.method.apply(p$g.caller,p$q):p$g.method.call(p$g.caller,p$q):p$g.method.apply(p$g.caller,p$g.args),p$g.once&&p$Y.recoverHandler(p$g);p$f.lock=!1,!p$f.head&&this._events&&this._events[p$h]==p$f&&delete this._events[p$h],p$f.queue&&p$f.queue.length&&this.event(p$h,p$f.queue.shift())}return!0},p$h.on=function(p$h,p$q,p$f,p$g){return this._createListener(p$h,p$q,p$f,p$g,!1)},p$h.once=function(p$h,p$q,p$f,p$g){return this._createListener(p$h,p$q,p$f,p$g,!0)},p$h._createListener=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$P&&(p$P=!0),p$P&&this.off(p$h,p$q,p$f,p$$);var p$S=p$Y.createHandler(p$q||this,p$f,p$g,p$$);this._events||(this._events={});var p$B=this._events,p$r=p$B[p$h];return p$r?p$r.tail?(p$S.prev=p$r.tail,p$r.tail.next=p$S,p$r.tail=p$S):p$r.head=p$r.tail=p$S:p$B[p$h]={head:p$S,tail:p$S,cursor:null,lock:!1},this},p$h.off=function(p$h,p$q,p$f,p$g){if(void 0===p$g&&(p$g=!1),!this._events||!this._events[p$h])return this;for(var p$$=this._events[p$h],p$P=p$$.head;p$P;){if((!p$q||p$P.caller===p$q)&&p$P.method===p$f&&(!p$g||p$P.once)){p$Y.delNode(p$$,p$P),p$$.cursor==p$P&&(p$$.cursor=p$P.next),p$Y.recoverHandler(p$P);break}p$P=p$P.next}return this},p$h.offAll=function(p$h){var p$q=this._events;if(!p$q)return this;if(p$h)this._recoverHandlers(p$q[p$h]),delete p$q[p$h];else{for(var p$f in p$q)this._recoverHandlers(p$q[p$f]);this._events=null}return this},p$h._recoverHandlers=function(p$h){if(p$h){for(var p$q=p$h.head;p$q;){p$Y.delNode(p$h,p$q);var p$f=p$q.next;p$Y.recoverHandler(p$q),p$q=p$f}p$h.cursor=null}},p$h.isMouseEvent=function(p$h){return p$Y.MOUSE_EVENTS[p$h]},p$Y.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},p$Y.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},p$Y.delNode=function(p$h,p$q){p$q.prev?p$q.prev.next=p$q.next:p$h.head=p$q.next,p$q.next?p$q.next.prev=p$q.prev:p$h.tail=p$q.prev},p$Y.createHandler=function(p$h,p$q,p$f,p$g){var p$$=p$Y._freeHandler;return p$$?(p$Y._freeCount--,p$Y._freeHandler=p$$.next,p$$.caller=p$h,p$$.method=p$q,p$$.args=p$f,p$$.once=p$g):p$$={caller:p$h,method:p$q,args:p$f,once:p$g},p$$.prev=p$$.next=null,p$$},p$Y.recoverHandler=function(p$h){p$h.caller=p$h.method=p$h.args=p$h.prev=null,p$h.next=p$Y._freeHandler,p$Y._freeHandler=p$h,p$Y._freeCount++},p$Y._freeHandler=null,p$Y._freeCount=0,p$Y}(),p$N=function(){function p$$(p$h,p$q,p$f,p$g){this.once=!1,void(this._id=0)===p$g&&(p$g=!1),this.setTo(p$h,p$q,p$f,p$g)}p$C(p$$,"laya.utils.Handler");var p$h=p$$.prototype;return p$h.setTo=function(p$h,p$q,p$f,p$g){return this._id=p$$._gid++,this.caller=p$h,this.method=p$q,this.args=p$f,this.once=p$g,this},p$h.run=function(){if(null==this.method)return null;var p$h=this._id,p$q=this.method.apply(this.caller,this.args);return this._id===p$h&&this.once&&this.recover(),p$q},p$h.runWith=function(p$h){if(null==this.method)return null;var p$q=this._id;if(null==p$h)var p$f=this.method.apply(this.caller,this.args);else p$f=this.args||p$h.unshift?this.args?this.method.apply(this.caller,this.args.concat(p$h)):this.method.apply(this.caller,p$h):this.method.call(this.caller,p$h);return this._id===p$q&&this.once&&this.recover(),p$f},p$h.clear=function(){return this.caller=null,this.method=null,this.args=null,this},p$h.recover=function(){0<this._id&&(this._id=0,this.clear())},p$$.create=function(p$h,p$q,p$f,p$g){return void 0===p$g&&(p$g=!0),new p$$(p$h,p$q,p$f,p$g)},p$$._gid=1,p$$}(),p$p=function(){function p$h(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}p$C(p$h,"laya.display.BitmapFont");var p$q=p$h.prototype;return p$q.loadFont=function(p$h,p$q){this._path=p$h,this._complete=p$q,p$t.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],p$N.create(this,this.onLoaded))},p$q.onLoaded=function(){this.parseFont(p$Bh.getRes(this._path),p$Bh.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},p$q.parseFont=function(p$h,p$q){if(null!=p$h&&null!=p$q){this._texture=p$q;var p$f=p$h.getElementsByTagName("info");if(!p$f[0].getAttributeNode)return this.parseFont2(p$h,p$q);this.fontSize=parseInt(p$f[0].getAttributeNode("size").nodeValue);var p$g,p$$=p$f[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(p$$[0]),parseInt(p$$[1]),parseInt(p$$[2]),parseInt(p$$[3])],p$g=p$h.getElementsByTagName("char");var p$P=0;for(p$P=0;p$P<p$g.length;p$P++){var p$S=p$g[p$P],p$B=parseInt(p$S.getAttributeNode("id").nodeValue),p$r=parseInt(p$S.getAttributeNode("xoffset").nodeValue)/1,p$Y=parseInt(p$S.getAttributeNode("yoffset").nodeValue)/1,p$C=parseInt(p$S.getAttributeNode("xadvance").nodeValue)/1,p$U=new p$n;p$U.x=parseInt(p$S.getAttributeNode("x").nodeValue),p$U.y=parseInt(p$S.getAttributeNode("y").nodeValue),p$U.width=parseInt(p$S.getAttributeNode("width").nodeValue),p$U.height=parseInt(p$S.getAttributeNode("height").nodeValue);var p$u=p$Ch.create(p$q,p$U.x,p$U.y,p$U.width,p$U.height,p$r,p$Y);this._maxWidth=Math.max(this._maxWidth,p$C+this.letterSpacing),this._fontCharDic[p$B]=p$u,this._fontWidthMap[p$B]=p$C}}},p$q.parseFont2=function(p$h,p$q){if(null!=p$h&&null!=p$q){this._texture=p$q;var p$f=p$h.getElementsByTagName("info");this.fontSize=parseInt(p$f[0].attributes.size.nodeValue);var p$g=p$f[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(p$g[0]),parseInt(p$g[1]),parseInt(p$g[2]),parseInt(p$g[3])];var p$$=p$h.getElementsByTagName("char"),p$P=0;for(p$P=0;p$P<p$$.length;p$P++){var p$S=p$$[p$P].attributes,p$B=parseInt(p$S.id.nodeValue),p$r=parseInt(p$S.xoffset.nodeValue)/1,p$Y=parseInt(p$S.yoffset.nodeValue)/1,p$C=parseInt(p$S.xadvance.nodeValue)/1,p$U=new p$n;p$U.x=parseInt(p$S.x.nodeValue),p$U.y=parseInt(p$S.y.nodeValue),p$U.width=parseInt(p$S.width.nodeValue),p$U.height=parseInt(p$S.height.nodeValue);var p$u=p$Ch.create(p$q,p$U.x,p$U.y,p$U.width,p$U.height,p$r,p$Y);this._maxWidth=Math.max(this._maxWidth,p$C+this.letterSpacing),this._fontCharDic[p$B]=p$u,this._fontWidthMap[p$B]=p$C}}},p$q.getCharTexture=function(p$h){return this._fontCharDic[p$h.charCodeAt(0)]},p$q.destroy=function(){if(this._texture){for(var p$h in this._fontCharDic){var p$q=this._fontCharDic[p$h];p$q&&p$q.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},p$q.setSpaceWidth=function(p$h){this._spaceWidth=p$h},p$q.getCharWidth=function(p$h){var p$q=p$h.charCodeAt(0);return this._fontWidthMap[p$q]?this._fontWidthMap[p$q]+this.letterSpacing:" "==p$h?this._spaceWidth+this.letterSpacing:0},p$q.getTextWidth=function(p$h){for(var p$q=0,p$f=0,p$g=p$h.length;p$f<p$g;p$f++)p$q+=this.getCharWidth(p$h.charAt(p$f));return p$q},p$q.getMaxWidth=function(){return this._maxWidth},p$q.getMaxHeight=function(){return this.fontSize},p$q.drawText=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S,p$B=this.getTextWidth(p$h),p$r=0;"center"===p$$&&(p$r=(p$P-p$B)/2),"right"===p$$&&(p$r=p$P-p$B);for(var p$Y=0,p$C=0,p$U=p$h.length;p$C<p$U;p$C++)(p$S=this.getCharTexture(p$h.charAt(p$C)))&&(p$q.graphics.drawTexture(p$S,p$f+p$Y+p$r,p$g),p$Y+=this.getCharWidth(p$h.charAt(p$C)))},p$h}(),p$B=function(){function p$f(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=p$f._TF_EMPTY}p$C(p$f,"laya.display.css.Style");var p$h=p$f.prototype;return p$h.getTransform=function(){return this._tf},p$h.setTransform=function(p$h){this._tf="none"!==p$h&&p$h?p$h:p$f._TF_EMPTY},p$h.setTranslateX=function(p$h){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.translateX=p$h},p$h.setTranslateY=function(p$h){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.translateY=p$h},p$h.setScaleX=function(p$h){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.scaleX=p$h},p$h.setScale=function(p$h,p$q){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.scaleX=p$h,this._tf.scaleY=p$q},p$h.setScaleY=function(p$h){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.scaleY=p$h},p$h.setRotate=function(p$h){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.rotate=p$h},p$h.setSkewX=function(p$h){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.skewX=p$h},p$h.setSkewY=function(p$h){this._tf===p$f._TF_EMPTY&&(this._tf=new p$$),this._tf.skewY=p$h},p$h.destroy=function(){this.scrollRect=null},p$h.render=function(p$h,p$q,p$f,p$g){},p$h.getCSSStyle=function(){return p$qh.EMPTY},p$h._enableLayout=function(){return!1},p$L(0,p$h,"scaleX",function(){return this._tf.scaleX},function(p$h){this.setScaleX(p$h)}),p$L(0,p$h,"transform",function(){return this.getTransform()},function(p$h){this.setTransform(p$h)}),p$L(0,p$h,"translateX",function(){return this._tf.translateX},function(p$h){this.setTranslateX(p$h)}),p$L(0,p$h,"translateY",function(){return this._tf.translateY},function(p$h){this.setTranslateY(p$h)}),p$L(0,p$h,"scaleY",function(){return this._tf.scaleY},function(p$h){this.setScaleY(p$h)}),p$L(0,p$h,"block",function(){return 0!=(1&this._type)}),p$L(0,p$h,"skewY",function(){return this._tf.skewY},function(p$h){this.setSkewY(p$h)}),p$L(0,p$h,"rotate",function(){return this._tf.rotate},function(p$h){this.setRotate(p$h)}),p$L(0,p$h,"skewX",function(){return this._tf.skewX},function(p$h){this.setSkewX(p$h)}),p$L(0,p$h,"paddingLeft",function(){return 0}),p$L(0,p$h,"paddingTop",function(){return 0}),p$L(0,p$h,"absolute",function(){return!0}),p$f.__init__=function(){p$f._TF_EMPTY=new p$$,p$f.EMPTY=new p$f},p$f.EMPTY=null,p$f._TF_EMPTY=null,p$f}(),p$v=function(){function p$q(p$h){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=p$s.create(p$q.defaultColor),this.family=p$q.defaultFamily,this.stroke=p$q._STROKE,this.size=p$q.defaultSize,p$h&&p$h!==p$q.EMPTY&&p$h.copyTo(this)}p$C(p$q,"laya.display.css.Font");var p$h=p$q.prototype;return p$h.set=function(p$h){this._text=null;for(var p$q=p$h.split(" "),p$f=0,p$g=p$q.length;p$f<p$g;p$f++){var p$$=p$q[p$f];switch(p$$){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<p$$.indexOf("px")&&(this.size=parseInt(p$$),this.family=p$q[p$f+1],p$f++)}},p$h.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},p$h.copyTo=function(p$h){p$h._type=this._type,p$h._text=this._text,p$h._weight=this._weight,p$h._color=this._color,p$h.family=this.family,p$h.stroke=this.stroke!=p$q._STROKE?this.stroke.slice():p$q._STROKE,p$h.indent=this.indent,p$h.size=this.size},p$L(0,p$h,"password",function(){return 0!=(1024&this._type)},function(p$h){p$h?this._type|=1024:this._type&=-1025}),p$L(0,p$h,"color",function(){return this._color.strColor},function(p$h){this._color=p$s.create(p$h)}),p$L(0,p$h,"italic",function(){return 0!=(512&this._type)},function(p$h){p$h?this._type|=512:this._type&=-513}),p$L(0,p$h,"bold",function(){return 0!=(2048&this._type)},function(p$h){p$h?this._type|=2048:this._type&=-2049}),p$L(0,p$h,"weight",function(){return""+this._weight},function(p$h){var p$q=0;switch(p$h){case"normal":break;case"bold":this.bold=!0,p$q=700;break;case"bolder":p$q=800;break;case"lighter":p$q=100;break;default:p$q=parseInt(p$h)}this._weight=p$q,this._text=null}),p$L(0,p$h,"decoration",function(){return this._decoration?this._decoration.value:null},function(p$h){var p$q=p$h.split(" ");switch(this._decoration||(this._decoration={}),p$q[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=p$q[0]}p$q[1]&&(this._decoration.color=p$s.create(p$q)),this._decoration.value=p$h}),p$q.__init__=function(){p$q.EMPTY=new p$q(null)},p$q.EMPTY=null,p$q.defaultColor="#000000",p$q.defaultSize=12,p$q.defaultFamily="Arial",p$q.defaultFont="12px Arial",p$q._STROKE=[0,"#000000"],p$q._ITALIC=512,p$q._PASSWORD=1024,p$q._BOLD=2048,p$q}(),p$$=function(){function p$h(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return p$C(p$h,"laya.display.css.TransformInfo"),p$h}(),p$u=function(){function p$U(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,p$c.isConchNode){this._nativeObj=new p$S._conchGraphics,this.id=this._nativeObj.conchID}}p$C(p$U,"laya.display.Graphics");var p$h=p$U.prototype;return p$h.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},p$h.clear=function(p$h){void 0===p$h&&(p$h=!1);var p$q=0,p$f=0;if(p$h){var p$g=this._one;if(this._cmds){for(p$f=this._cmds.length,p$q=0;p$q<p$f;p$q++)!(p$g=this._cmds[p$q])||p$g.callee!==p$c._context._drawTexture&&p$g.callee!==p$c._context._drawTextureWithTransform||(p$g[0]=null,p$U._cache.push(p$g));this._cmds.length=0}else p$g&&(!p$g||p$g.callee!==p$c._context._drawTexture&&p$g.callee!==p$c._context._drawTextureWithTransform||(p$g[0]=null,p$U._cache.push(p$g)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(p$q=0,p$f=this._vectorgraphArray.length;p$q<p$f;p$q++)p$j.getInstance().deleteShape(this._vectorgraphArray[p$q]);this._vectorgraphArray.length=0}},p$h._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},p$h._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new p$f,this._graphicBounds._graphics=this)},p$h._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},p$h._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},p$h.getBounds=function(p$h){return void 0===p$h&&(p$h=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(p$h)},p$h.getBoundPoints=function(p$h){return void 0===p$h&&(p$h=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(p$h)},p$h._addCmd=function(p$h){this._cmds=this._cmds||[],p$h.callee=p$h.shift(),this._cmds.push(p$h)},p$h.setFilters=function(p$h){this._saveToCmd(p$c._context._setFilters,p$h)},p$h.drawTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){if(void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),void 0===p$S&&(p$S=1),!p$h||p$S<.01)return null;p$g||(p$g=p$h.sourceWidth),p$$||(p$$=p$h.sourceHeight),p$S=p$S<0?0:1<p$S?1:p$S;var p$B,p$r=!p$c.isWebGL&&(p$w.onFirefox||p$w.onEdge||p$w.onIE||p$w.onSafari)?.5:0,p$Y=p$g/p$h.sourceWidth,p$C=p$$/p$h.sourceHeight;return p$g=p$h.width*p$Y,p$$=p$h.height*p$C,p$h.loaded&&(p$g<=0||p$$<=0)?null:(p$q+=p$h.offsetX*p$Y,p$f+=p$h.offsetY*p$C,this._sp&&(this._sp._renderType|=512),p$q-=p$r,p$f-=p$r,p$g+=2*p$r,p$$+=2*p$r,p$U._cache.length?((p$B=p$U._cache.pop())[0]=p$h,p$B[1]=p$q,p$B[2]=p$f,p$B[3]=p$g,p$B[4]=p$$,p$B[5]=p$P,p$B[6]=p$S):p$B=[p$h,p$q,p$f,p$g,p$$,p$P,p$S],p$B.callee=p$P||1!=p$S?p$c._context._drawTextureWithTransform:p$c._context._drawTexture,null!=this._one||p$P||1!=p$S?this._saveToCmd(p$B.callee,p$B):(this._one=p$B,this._render=this._renderOneImg),p$h.loaded||p$h.once("loaded",this,this._textureLoaded,[p$h,p$B]),this._repaint(),p$B)},p$h.cleanByTexture=function(p$h,p$q,p$f,p$g,p$$){if(void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),!p$h)return this.clear();if(this._one&&this._render===this._renderOneImg){p$g||(p$g=p$h.sourceWidth),p$$||(p$$=p$h.sourceHeight);var p$P=p$g/p$h.sourceWidth,p$S=p$$/p$h.sourceHeight;p$g=p$h.width*p$P,p$$=p$h.height*p$S,p$q+=p$h.offsetX*p$P,p$f+=p$h.offsetY*p$S,this._one[0]=p$h,this._one[1]=p$q,this._one[2]=p$f,this._one[3]=p$g,this._one[4]=p$$,this._repaint()}else this.clear(),p$h&&this.drawTexture(p$h,p$q,p$f,p$g,p$$)},p$h.drawTextures=function(p$h,p$q){p$h&&this._saveToCmd(p$c._context._drawTextures,[p$h,p$q])},p$h.fillTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){if(void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),void 0===p$P&&(p$P="repeat"),p$h){var p$B=[p$h,p$q,p$f,p$g,p$$,p$P,p$S||p$X.EMPTY,{}];p$h.loaded||p$h.once("loaded",this,this._textureLoaded,[p$h,p$B]),this._saveToCmd(p$c._context._fillTexture,p$B)}},p$h._textureLoaded=function(p$h,p$q){p$q[3]=p$q[3]||p$h.width,p$q[4]=p$q[4]||p$h.height,this._repaint()},p$h.fillCircle=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$f.bitmap.enableMerageInAtlas=!1;var p$B=new Float32Array(2*(p$S+1)),p$r=new Float32Array(2*(p$S+1)),p$Y=new Uint16Array(3*p$S),p$C=2*Math.PI/p$S,p$U=0;p$B[0]=p$g,p$B[1]=p$$,p$r[0]=p$g/p$f.width,p$r[1]=p$$/p$f.height;for(var p$u=2,p$v=0;p$v<p$S;p$v++){var p$L=p$P*Math.cos(p$U)+p$g,p$e=p$P*Math.sin(p$U)+p$$;p$B[p$u]=p$L,p$B[p$u+1]=p$e,p$r[p$u]=p$L/p$f.width,p$r[p$u+1]=p$e/p$f.height,p$U+=p$C,p$u+=2}for(p$v=p$u=0;p$v<p$S;p$v++)p$Y[p$u++]=0,p$Y[p$u++]=p$v+1,p$Y[p$u++]=p$S+1<=p$v+2?1:p$v+2;this.drawTriangles(p$f,p$h,p$q,p$B,p$r,p$Y)},p$h.drawTriangles=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){void 0===p$B&&(p$B=1),this._saveToCmd(p$c._context.drawTriangles,[p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y])},p$h._saveToCmd=function(p$h,p$q){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=p$q,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(p$q)),p$q.callee=p$h,this._repaint(),p$q},p$h.clipRect=function(p$h,p$q,p$f,p$g){this._saveToCmd(p$c._context._clipRect,[p$h,p$q,p$f,p$g])},p$h.fillText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){void 0===p$S&&(p$S=0),this._saveToCmd(p$c._context._fillText,[p$h,p$q,p$f,p$g||p$v.defaultFont,p$$,p$P])},p$h.fillBorderText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){this._saveToCmd(p$c._context._fillBorderText,[p$h,p$q,p$f,p$g||p$v.defaultFont,p$$,p$P,p$S,p$B])},p$h.strokeText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._saveToCmd(p$c._context._strokeText,[p$h,p$q,p$f,p$g||p$v.defaultFont,p$$,p$P,p$S])},p$h.alpha=function(p$h){p$h=p$h<0?0:1<p$h?1:p$h,this._saveToCmd(p$c._context._alpha,[p$h])},p$h.setAlpha=function(p$h){p$h=p$h<0?0:1<p$h?1:p$h,this._saveToCmd(p$c._context._setAlpha,[p$h])},p$h.transform=function(p$h,p$q,p$f){void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),this._saveToCmd(p$c._context._transform,[p$h,p$q,p$f])},p$h.rotate=function(p$h,p$q,p$f){void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),this._saveToCmd(p$c._context._rotate,[p$h,p$q,p$f])},p$h.scale=function(p$h,p$q,p$f,p$g){void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0),this._saveToCmd(p$c._context._scale,[p$h,p$q,p$f,p$g])},p$h.translate=function(p$h,p$q){this._saveToCmd(p$c._context._translate,[p$h,p$q])},p$h.save=function(){this._saveToCmd(p$c._context._save,[])},p$h.restore=function(){this._saveToCmd(p$c._context._restore,[])},p$h.replaceText=function(p$h){this._repaint();var p$q=this._cmds;if(p$q){for(var p$f=p$q.length-1;-1<p$f;p$f--)if(this._isTextCmd(p$q[p$f].callee))return p$q[p$f][0].toUpperCase?p$q[p$f][0]=p$h:p$q[p$f][0].setText(p$h),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=p$h:this._one[0].setText(p$h),!0;return!1},p$h._isTextCmd=function(p$h){return p$h===p$c._context._fillText||p$h===p$c._context._fillBorderText||p$h===p$c._context._strokeText},p$h.replaceTextColor=function(p$h){this._repaint();var p$q=this._cmds;if(p$q)for(var p$f=p$q.length-1;-1<p$f;p$f--)this._isTextCmd(p$q[p$f].callee)&&(p$q[p$f][4]=p$h,p$q[p$f][0].toUpperCase||(p$q[p$f][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=p$h,this._one[0].toUpperCase||(this._one[0].changed=!0))},p$h.loadImage=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=this;void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0);var p$B=p$Bh.getRes(p$h);function p$r(p$h){p$h&&(p$S.drawTexture(p$h,p$q,p$f,p$g,p$$),null!=p$P&&p$P.call(p$S._sp,p$h))}p$B?p$r(p$B):p$t.loader.load(p$h,p$N.create(null,p$r),null,"image")},p$h._renderEmpty=function(p$h,p$q,p$f,p$g){},p$h._renderAll=function(p$h,p$q,p$f,p$g){for(var p$$,p$P=this._cmds,p$S=0,p$B=p$P.length;p$S<p$B;p$S++)(p$$=p$P[p$S]).callee.call(p$q,p$f,p$g,p$$)},p$h._renderOne=function(p$h,p$q,p$f,p$g){this._one.callee.call(p$q,p$f,p$g,this._one)},p$h._renderOneImg=function(p$h,p$q,p$f,p$g){this._one.callee.call(p$q,p$f,p$g,this._one),2305!==p$h._renderType&&(p$h._renderType|=1)},p$h.drawLine=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$P&&(p$P=1);var p$S=0;p$c.isWebGL&&(p$S=p$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(p$S));var p$B=p$P%2==0?0:.5,p$r=[p$h+p$B,p$q+p$B,p$f+p$B,p$g+p$B,p$$,p$P,p$S];this._saveToCmd(p$c._context._drawLine,p$r)},p$h.drawLines=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=1);var p$P=0;if(p$f&&!(p$f.length<4)){p$c.isWebGL&&(p$P=p$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(p$P));var p$S=p$$%2==0?0:.5,p$B=[p$h+p$S,p$q+p$S,p$f,p$g,p$$,p$P];this._saveToCmd(p$c._context._drawLines,p$B)}},p$h.drawCurves=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=1);var p$P=[p$h,p$q,p$f,p$g,p$$];this._saveToCmd(p$c._context._drawCurves,p$P)},p$h.drawRect=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){void 0===p$S&&(p$S=1);var p$B=p$P?p$S/2:0,p$r=p$P?p$S:0,p$Y=[p$h+p$B,p$q+p$B,p$f-p$r,p$g-p$r,p$$,p$P,p$S];this._saveToCmd(p$c._context._drawRect,p$Y)},p$h.drawCircle=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$P&&(p$P=1);var p$S=p$$?p$P/2:0,p$B=0;p$c.isWebGL&&(p$B=p$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(p$B));var p$r=[p$h,p$q,p$f-p$S,p$g,p$$,p$P,p$B];this._saveToCmd(p$c._context._drawCircle,p$r)},p$h.drawPie=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){void 0===p$B&&(p$B=1);var p$r=p$S?p$B/2:0,p$Y=p$S?p$B:0,p$C=0;p$c.isWebGL&&(p$C=p$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(p$C));var p$U=[p$h+p$r,p$q+p$r,p$f-p$Y,p$g,p$$,p$P,p$S,p$B,p$C];p$U[3]=p$O.toRadian(p$g),p$U[4]=p$O.toRadian(p$$),this._saveToCmd(p$c._context._drawPie,p$U)},p$h.drawPoly=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$P&&(p$P=1);var p$S=0,p$B=!1;p$c.isWebGL&&(p$S=p$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(p$S),p$B=!(6<p$f.length));var p$r=p$$?p$P%2==0?0:.5:0,p$Y=[p$h+p$r,p$q+p$r,p$f,p$g,p$$,p$P,p$S,p$B];this._saveToCmd(p$c._context._drawPoly,p$Y)},p$h.drawPath=function(p$h,p$q,p$f,p$g,p$$){var p$P=[p$h,p$q,p$f,p$g,p$$];this._saveToCmd(p$c._context._drawPath,p$P)},p$L(0,p$h,"cmds",function(){return this._cmds},function(p$h){this._sp&&(this._sp._renderType|=512),this._cmds=p$h,this._render=this._renderAll,this._repaint()}),p$U.__init__=function(){if(p$c.isConchNode){for(var p$h=laya.display.Graphics.prototype,p$q=p$w.window.ConchGraphics.prototype,p$f=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],p$g=0,p$$=p$f.length;p$g<=p$$;p$g++){var p$P=p$f[p$g];p$h[p$P]=p$q[p$P]}p$h._saveToCmd=null,p$q.drawImageS&&(p$h.drawTextures=function(p$h,p$q){if(p$h&&p$h.loaded&&p$h.bitmap&&p$h.source){var p$f=p$h.uv,p$g=p$h.bitmap.width,p$$=p$h.bitmap.height;this.drawImageS(p$h.bitmap.source,p$f[0]*p$g,p$f[1]*p$$,(p$f[2]-p$f[0])*p$g,(p$f[5]-p$f[3])*p$$,p$h.offsetX,p$h.offsetY,p$h.width,p$h.height,p$q)}}),p$h.drawTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){if(void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),void 0===p$S&&(p$S=1),p$h)if(p$h.loaded){if(p$h.loaded&&p$h.bitmap&&p$h.source&&(p$g||(p$g=p$h.sourceWidth),p$$||(p$$=p$h.sourceHeight),p$S=p$S<0?0:1<p$S?1:p$S,p$g=p$g-p$h.sourceWidth+p$h.width,p$$=p$$-p$h.sourceHeight+p$h.height,!(p$g<=0||p$$<=0))){p$q+=p$h.offsetX,p$f+=p$h.offsetY;var p$B=p$h.uv,p$r=p$h.bitmap.width,p$Y=p$h.bitmap.height;p$B[4]<p$B[0]&&p$B[5]<p$B[1]?this.drawImageM(p$h.bitmap.source,p$B[4]*p$r,p$B[5]*p$Y,(p$B[0]-p$B[4])*p$r,(p$B[1]-p$B[5])*p$Y,p$q,p$f,p$g,p$$,p$P,p$S):this.drawImageM(p$h.bitmap.source,p$B[0]*p$r,p$B[1]*p$Y,(p$B[2]-p$B[0])*p$r,(p$B[5]-p$B[3])*p$Y,p$q,p$f,p$g,p$$,p$P,p$S),this._repaint()}}else p$h.once("loaded",this,function(){this.drawTexture(p$h,p$q,p$f,p$g,p$$,p$P)})},p$h.fillTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){if(void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),void 0===p$P&&(p$P="repeat"),p$h&&p$h.loaded){var p$B,p$r=p$c._context.ctx,p$Y=p$h.bitmap.width,p$C=p$h.bitmap.height,p$U=p$h.uv;p$B=p$h.uv!=p$Ch.DEF_UV?p$r.createPattern(p$h.bitmap.source,p$P,p$U[0]*p$Y,p$U[1]*p$C,(p$U[2]-p$U[0])*p$Y,(p$U[5]-p$U[3])*p$C):p$r.createPattern(p$h.bitmap.source,p$P);var p$u=0,p$v=0;p$S&&(p$q+=p$S.x%p$h.width,p$f+=p$S.y%p$h.height,p$u-=p$S.x%p$h.width,p$v-=p$S.y%p$h.height),this._fillImage(p$B,p$q,p$f,p$u,p$v,p$g,p$$)}}}},p$U._cache=[],p$U}(),p$f=function(){function p$G(){this._cacheBoundsType=!1}p$C(p$G,"laya.display.GraphicsBounds");var p$h=p$G.prototype;return p$h.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},p$h.reset=function(){this._temp&&(this._temp.length=0)},p$h.getBounds=function(p$h){return void 0===p$h&&(p$h=!1),(!this._bounds||!this._temp||this._temp.length<1||p$h!=this._cacheBoundsType)&&(this._bounds=p$n._getWrapRec(this.getBoundPoints(p$h),this._bounds)),this._cacheBoundsType=p$h,this._bounds},p$h.getBoundPoints=function(p$h){return void 0===p$h&&(p$h=!1),(!this._temp||this._temp.length<1||p$h!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(p$h)),this._cacheBoundsType=p$h,this._rstBoundPoints=p$O.copyArray(this._rstBoundPoints,this._temp)},p$h._getCmdPoints=function(p$h){void 0===p$h&&(p$h=!1);var p$q,p$f,p$g=p$c._context,p$$=this._graphics.cmds;if((p$q=this._temp||(this._temp=[])).length=0,p$$||null==this._graphics._one||(p$G._tempCmds.length=0,p$G._tempCmds.push(this._graphics._one),p$$=p$G._tempCmds),!p$$)return p$q;(p$f=p$G._tempMatrixArrays).length=0;var p$P=p$G._initMatrix;p$P.identity();for(var p$S,p$B,p$r=p$G._tempMatrix,p$Y=NaN,p$C=NaN,p$U=NaN,p$u=NaN,p$v=NaN,p$L=NaN,p$e=0,p$l=p$$.length;p$e<p$l;p$e++)if((p$S=p$$[p$e]).callee)switch(p$S.callee){case p$g._save:case 7:p$f.push(p$P),p$P=p$P.clone();break;case p$g._restore:case 8:p$P=p$f.pop();break;case p$g._scale:case 5:p$r.identity(),p$r.translate(-p$S[2],-p$S[3]),p$r.scale(p$S[0],p$S[1]),p$r.translate(p$S[2],p$S[3]),this._switchMatrix(p$P,p$r);break;case p$g._rotate:case 3:p$r.identity(),p$r.translate(-p$S[1],-p$S[2]),p$r.rotate(p$S[0]),p$r.translate(p$S[1],p$S[2]),this._switchMatrix(p$P,p$r);break;case p$g._translate:case 6:p$r.identity(),p$r.translate(p$S[0],p$S[1]),this._switchMatrix(p$P,p$r);break;case p$g._transform:case 4:p$r.identity(),p$r.translate(-p$S[1],-p$S[2]),p$r.concat(p$S[0]),p$r.translate(p$S[1],p$S[2]),this._switchMatrix(p$P,p$r);break;case 16:case 24:p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[0],p$S[1],p$S[2],p$S[3]),p$P);break;case 17:p$P.copyTo(p$r),p$r.concat(p$S[4]),p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[0],p$S[1],p$S[2],p$S[3]),p$r);break;case p$g._drawTexture:p$B=p$S[0],p$h?p$S[3]&&p$S[4]?p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1],p$S[2],p$S[3],p$S[4]),p$P):(p$B=p$S[0],p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1],p$S[2],p$B.width,p$B.height),p$P)):(p$Y=(p$S[3]||p$B.sourceWidth)/p$B.width,p$C=(p$S[4]||p$B.sourceHeight)/p$B.height,p$U=p$Y*p$B.sourceWidth,p$u=p$C*p$B.sourceHeight,p$v=0<p$B.offsetX?p$B.offsetX:0,p$L=0<p$B.offsetY?p$B.offsetY:0,p$v*=p$Y,p$L*=p$C,p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1]-p$v,p$S[2]-p$L,p$U,p$u),p$P));break;case p$g._fillTexture:p$S[3]&&p$S[4]?p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1],p$S[2],p$S[3],p$S[4]),p$P):(p$B=p$S[0],p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1],p$S[2],p$B.width,p$B.height),p$P));break;case p$g._drawTextureWithTransform:var p$_;p$_=p$S[5]?(p$P.copyTo(p$r),p$r.concat(p$S[5]),p$r):p$P,p$h?p$S[3]&&p$S[4]?p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1],p$S[2],p$S[3],p$S[4]),p$_):(p$B=p$S[0],p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1],p$S[2],p$B.width,p$B.height),p$_)):(p$B=p$S[0],p$Y=(p$S[3]||p$B.sourceWidth)/p$B.width,p$C=(p$S[4]||p$B.sourceHeight)/p$B.height,p$U=p$Y*p$B.sourceWidth,p$u=p$C*p$B.sourceHeight,p$v=0<p$B.offsetX?p$B.offsetX:0,p$L=0<p$B.offsetY?p$B.offsetY:0,p$v*=p$Y,p$L*=p$C,p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[1]-p$v,p$S[2]-p$L,p$U,p$u),p$_));break;case p$g._drawRect:case 13:p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[0],p$S[1],p$S[2],p$S[3]),p$P);break;case p$g._drawCircle:case p$g._fillCircle:case 14:p$G._addPointArrToRst(p$q,p$n._getBoundPointS(p$S[0]-p$S[2],p$S[1]-p$S[2],p$S[2]+p$S[2],p$S[2]+p$S[2]),p$P);break;case p$g._drawLine:case 20:p$G._tempPoints.length=0;var p$N;p$N=.5*p$S[5],p$S[0]==p$S[2]?p$G._tempPoints.push(p$S[0]+p$N,p$S[1],p$S[2]+p$N,p$S[3],p$S[0]-p$N,p$S[1],p$S[2]-p$N,p$S[3]):p$S[1]==p$S[3]?p$G._tempPoints.push(p$S[0],p$S[1]+p$N,p$S[2],p$S[3]+p$N,p$S[0],p$S[1]-p$N,p$S[2],p$S[3]-p$N):p$G._tempPoints.push(p$S[0],p$S[1],p$S[2],p$S[3]),p$G._addPointArrToRst(p$q,p$G._tempPoints,p$P);break;case p$g._drawCurves:case 22:p$G._addPointArrToRst(p$q,p$m.I.getBezierPoints(p$S[2]),p$P,p$S[0],p$S[1]);break;case p$g._drawPoly:case p$g._drawLines:case 18:p$G._addPointArrToRst(p$q,p$S[2],p$P,p$S[0],p$S[1]);break;case p$g._drawPath:case 19:p$G._addPointArrToRst(p$q,this._getPathPoints(p$S[2]),p$P,p$S[0],p$S[1]);break;case p$g._drawPie:case 15:p$G._addPointArrToRst(p$q,this._getPiePoints(p$S[0],p$S[1],p$S[2],p$S[3],p$S[4]),p$P)}return 200<p$q.length?p$q=p$O.copyArray(p$q,p$n._getWrapRec(p$q)._getBoundPoints()):8<p$q.length&&(p$q=p$E.scanPList(p$q)),p$q},p$h._switchMatrix=function(p$h,p$q){p$q.concat(p$h),p$q.copyTo(p$h)},p$h._getPiePoints=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$G._tempPoints;p$G._tempPoints.length=0,p$P.push(p$h,p$q);var p$S=(p$$-p$g)%(2*Math.PI)/10,p$B=NaN,p$r=p$g;for(p$B=0;p$B<=10;p$B++)p$P.push(p$h+p$f*Math.cos(p$r),p$q+p$f*Math.sin(p$r)),p$r+=p$S;return p$P},p$h._getPathPoints=function(p$h){var p$q,p$f,p$g=0,p$$=p$G._tempPoints;for(p$$.length=0,p$q=p$h.length,p$g=0;p$g<p$q;p$g++)1<(p$f=p$h[p$g]).length&&(p$$.push(p$f[1],p$f[2]),3<p$f.length&&p$$.push(p$f[3],p$f[4]));return p$$},p$G._addPointArrToRst=function(p$h,p$q,p$f,p$g,p$$){void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0);var p$P,p$S=0;for(p$P=p$q.length,p$S=0;p$S<p$P;p$S+=2)p$G._addPointToRst(p$h,p$q[p$S]+p$g,p$q[p$S+1]+p$$,p$f)},p$G._addPointToRst=function(p$h,p$q,p$f,p$g){var p$$=p$X.TEMP;p$$.setTo(p$q||0,p$f||0),p$g.transformPoint(p$$),p$h.push(p$$.x,p$$.y)},p$G._tempPoints=[],p$G._tempMatrixArrays=[],p$G._tempCmds=[],p$r(p$G,["_tempMatrix",function(){return this._tempMatrix=new p$b},"_initMatrix",function(){return this._initMatrix=new p$b}]),p$G}(),p$P=function(){function p$h(){}p$C(p$h,"laya.events.Event");var p$q=p$h.prototype;return p$q.setTo=function(p$h,p$q,p$f){return this.type=p$h,this.currentTarget=p$q,this.target=p$f,this},p$q.stopPropagation=function(){this._stoped=!0},p$L(0,p$q,"stageY",function(){return p$t.stage.mouseY}),p$L(0,p$q,"charCode",function(){return this.nativeEvent.charCode}),p$L(0,p$q,"touches",function(){var p$h=this.nativeEvent.touches;if(p$h)for(var p$q=p$t.stage,p$f=0,p$g=p$h.length;p$f<p$g;p$f++){var p$$=p$h[p$f],p$P=p$X.TEMP;p$P.setTo(p$$.clientX,p$$.clientY),p$q._canvasTransform.invertTransformPoint(p$P),p$q.transform.invertTransformPoint(p$P),p$$.stageX=p$P.x,p$$.stageY=p$P.y}return p$h}),p$L(0,p$q,"keyLocation",function(){return this.nativeEvent.keyLocation}),p$L(0,p$q,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),p$L(0,p$q,"altKey",function(){return this.nativeEvent.altKey}),p$L(0,p$q,"shiftKey",function(){return this.nativeEvent.shiftKey}),p$L(0,p$q,"stageX",function(){return p$t.stage.mouseX}),p$h.EMPTY=new p$h,p$h.MOUSE_DOWN="mousedown",p$h.MOUSE_UP="mouseup",p$h.CLICK="click",p$h.RIGHT_MOUSE_DOWN="rightmousedown",p$h.RIGHT_MOUSE_UP="rightmouseup",p$h.RIGHT_CLICK="rightclick",p$h.MOUSE_MOVE="mousemove",p$h.MOUSE_OVER="mouseover",p$h.MOUSE_OUT="mouseout",p$h.MOUSE_WHEEL="mousewheel",p$h.ROLL_OVER="mouseover",p$h.ROLL_OUT="mouseout",p$h.DOUBLE_CLICK="doubleclick",p$h.CHANGE="change",p$h.CHANGED="changed",p$h.RESIZE="resize",p$h.ADDED="added",p$h.REMOVED="removed",p$h.DISPLAY="display",p$h.UNDISPLAY="undisplay",p$h.ERROR="error",p$h.COMPLETE="complete",p$h.LOADED="loaded",p$h.INITED="inited",p$h.PROGRESS="progress",p$h.INPUT="input",p$h.RENDER="render",p$h.OPEN="open",p$h.MESSAGE="message",p$h.CLOSE="close",p$h.KEY_DOWN="keydown",p$h.KEY_PRESS="keypress",p$h.KEY_UP="keyup",p$h.FRAME="enterframe",p$h.DRAG_START="dragstart",p$h.DRAG_MOVE="dragmove",p$h.DRAG_END="dragend",p$h.ENTER="enter",p$h.SELECT="select",p$h.BLUR="blur",p$h.FOCUS="focus",p$h.VISIBILITY_CHANGE="visibilitychange",p$h.FOCUS_CHANGE="focuschange",p$h.PLAYED="played",p$h.PAUSED="paused",p$h.STOPPED="stopped",p$h.START="start",p$h.END="end",p$h.ENABLE_CHANGED="enablechanged",p$h.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",p$h.COMPONENT_ADDED="componentadded",p$h.COMPONENT_REMOVED="componentremoved",p$h.LAYER_CHANGED="layerchanged",p$h.HIERARCHY_LOADED="hierarchyloaded",p$h.RECOVERED="recovered",p$h.RELEASED="released",p$h.LINK="link",p$h.LABEL="label",p$h.FULL_SCREEN_CHANGE="fullscreenchange",p$h.DEVICE_LOST="devicelost",p$h.MESH_CHANGED="meshchanged",p$h.MATERIAL_CHANGED="materialchanged",p$h.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",p$h.ANIMATION_CHANGED="animationchanged",p$h.TRIGGER_ENTER="triggerenter",p$h.TRIGGER_STAY="triggerstay",p$h.TRIGGER_EXIT="triggerexit",p$h.TRAIL_FILTER_CHANGE="trailfilterchange",p$h.DOMINO_FILTER_CHANGE="dominofilterchange",p$h}(),p$U=(function(){function p$h(){}p$C(p$h,"laya.events.Keyboard"),p$h.NUMBER_0=48,p$h.NUMBER_1=49,p$h.NUMBER_2=50,p$h.NUMBER_3=51,p$h.NUMBER_4=52,p$h.NUMBER_5=53,p$h.NUMBER_6=54,p$h.NUMBER_7=55,p$h.NUMBER_8=56,p$h.NUMBER_9=57,p$h.A=65,p$h.B=66,p$h.C=67,p$h.D=68,p$h.E=69,p$h.F=70,p$h.G=71,p$h.H=72,p$h.I=73,p$h.J=74,p$h.K=75,p$h.L=76,p$h.M=77,p$h.N=78,p$h.O=79,p$h.P=80,p$h.Q=81,p$h.R=82,p$h.S=83,p$h.T=84,p$h.U=85,p$h.V=86,p$h.W=87,p$h.X=88,p$h.Y=89,p$h.Z=90,p$h.F1=112,p$h.F2=113,p$h.F3=114,p$h.F4=115,p$h.F5=116,p$h.F6=117,p$h.F7=118,p$h.F8=119,p$h.F9=120,p$h.F10=121,p$h.F11=122,p$h.F12=123,p$h.F13=124,p$h.F14=125,p$h.F15=126,p$h.NUMPAD=21,p$h.NUMPAD_0=96,p$h.NUMPAD_1=97,p$h.NUMPAD_2=98,p$h.NUMPAD_3=99,p$h.NUMPAD_4=100,p$h.NUMPAD_5=101,p$h.NUMPAD_6=102,p$h.NUMPAD_7=103,p$h.NUMPAD_8=104,p$h.NUMPAD_9=105,p$h.NUMPAD_ADD=107,p$h.NUMPAD_DECIMAL=110,p$h.NUMPAD_DIVIDE=111,p$h.NUMPAD_ENTER=108,p$h.NUMPAD_MULTIPLY=106,p$h.NUMPAD_SUBTRACT=109,p$h.SEMICOLON=186,p$h.EQUAL=187,p$h.COMMA=188,p$h.MINUS=189,p$h.PERIOD=190,p$h.SLASH=191,p$h.BACKQUOTE=192,p$h.LEFTBRACKET=219,p$h.BACKSLASH=220,p$h.RIGHTBRACKET=221,p$h.QUOTE=222,p$h.ALTERNATE=18,p$h.BACKSPACE=8,p$h.CAPS_LOCK=20,p$h.COMMAND=15,p$h.CONTROL=17,p$h.DELETE=46,p$h.ENTER=13,p$h.ESCAPE=27,p$h.PAGE_UP=33,p$h.PAGE_DOWN=34,p$h.END=35,p$h.HOME=36,p$h.LEFT=37,p$h.UP=38,p$h.RIGHT=39,p$h.DOWN=40,p$h.SHIFT=16,p$h.SPACE=32,p$h.TAB=9,p$h.INSERT=45}(),function(){function p$$(){}return p$C(p$$,"laya.events.KeyBoardManager"),p$$.__init__=function(){p$$._addEvent("keydown"),p$$._addEvent("keypress"),p$$._addEvent("keyup")},p$$._addEvent=function(p$q){p$w.document.addEventListener(p$q,function(p$h){laya.events.KeyBoardManager._dispatch(p$h,p$q)},!0)},p$$._dispatch=function(p$h,p$q){if(p$$.enabled){p$$._event._stoped=!1,p$$._event.nativeEvent=p$h,p$$._event.keyCode=p$h.keyCode||p$h.which||p$h.charCode,"keydown"===p$q?p$$._pressKeys[p$$._event.keyCode]=!0:"keyup"===p$q&&(p$$._pressKeys[p$$._event.keyCode]=null);for(var p$f=p$t.stage.focus&&null!=p$t.stage.focus.event&&p$t.stage.focus.displayedInStage?p$t.stage.focus:p$t.stage,p$g=p$f;p$g;)p$g.event(p$q,p$$._event.setTo(p$q,p$g,p$f)),p$g=p$g.parent}},p$$.hasKeyDown=function(p$h){return p$$._pressKeys[p$h]},p$$._pressKeys={},p$$.enabled=!0,p$r(p$$,["_event",function(){return this._event=new p$P}]),p$$}()),p$e=(function(){function p$h(){}p$C(p$h,"laya.events.KeyLocation"),p$h.STANDARD=0,p$h.LEFT=1,p$h.RIGHT=2,p$h.NUM_PAD=3}(),function(){function p$Y(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=p$w.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new p$P,this._matrix=new p$b,this._point=new p$X,this._rect=new p$n,this._prePoint=new p$X,this._curTouchID=NaN}p$C(p$Y,"laya.events.MouseManager");var p$h=p$Y.prototype;return p$h.__init__=function(p$h,p$q){var p$f=this;this._stage=p$h;var p$g=this,p$$=this._eventList;p$q.oncontextmenu=function(p$h){if(p$Y.enabled)return!1},p$q.addEventListener("mousedown",function(p$h){p$Y.enabled&&(p$w.onIE||p$h.preventDefault(),p$$.push(p$h),p$g.mouseDownTime=p$w.now())}),p$q.addEventListener("mouseup",function(p$h){p$Y.enabled&&(p$h.preventDefault(),p$$.push(p$h),p$g.mouseDownTime=-p$w.now())},!0),p$q.addEventListener("mousemove",function(p$h){if(p$Y.enabled){p$h.preventDefault();var p$q=p$w.now();if(p$q-p$g._lastMoveTimer<10)return;p$g._lastMoveTimer=p$q,p$$.push(p$h)}},!0),p$q.addEventListener("mouseout",function(p$h){p$Y.enabled&&p$$.push(p$h)}),p$q.addEventListener("mouseover",function(p$h){p$Y.enabled&&p$$.push(p$h)}),p$q.addEventListener("touchstart",function(p$h){p$Y.enabled&&(p$$.push(p$h),p$Y._isFirstTouch||p$Eh.isInputting||p$h.preventDefault(),p$g.mouseDownTime=p$w.now())}),p$q.addEventListener("touchend",function(p$h){p$Y.enabled?(p$Y._isFirstTouch||p$Eh.isInputting||p$h.preventDefault(),p$Y._isFirstTouch=!1,p$$.push(p$h),p$g.mouseDownTime=-p$w.now()):p$f._curTouchID=NaN},!0),p$q.addEventListener("touchmove",function(p$h){p$Y.enabled&&(p$h.preventDefault(),p$$.push(p$h))},!0),p$q.addEventListener("touchcancel",function(p$h){p$Y.enabled?(p$h.preventDefault(),p$$.push(p$h)):p$f._curTouchID=NaN},!0),p$q.addEventListener("mousewheel",function(p$h){p$Y.enabled&&p$$.push(p$h)}),p$q.addEventListener("DOMMouseScroll",function(p$h){p$Y.enabled&&p$$.push(p$h)})},p$h.initEvent=function(p$h,p$q){var p$f;this._event._stoped=!1,this._event.nativeEvent=p$q||p$h,this._target=null,this._point.setTo(p$h.pageX||p$h.clientX,p$h.pageY||p$h.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=p$h.identifier||0,this._tTouchID=this._event.touchId,(p$f=p$l.I._event)._stoped=!1,p$f.nativeEvent=this._event.nativeEvent,p$f.touchId=this._event.touchId},p$h.checkMouseWheel=function(p$h){this._event.delta=p$h.wheelDelta?.025*p$h.wheelDelta:-p$h.detail;for(var p$q=p$l.I.getLastOvers(),p$f=0,p$g=p$q.length;p$f<p$g;p$f++){var p$$=p$q[p$f];p$$.event("mousewheel",this._event.setTo("mousewheel",p$$,this._target))}},p$h.onMouseMove=function(p$h){p$l.I.onMouseMove(p$h,this._tTouchID)},p$h.onMouseDown=function(p$h){if(p$Eh.isInputting&&p$t.stage.focus&&p$t.stage.focus.focus&&!p$t.stage.focus.contains(this._target)){var p$q=p$t.stage.focus._tf||p$t.stage.focus,p$f=p$h._tf||p$h;p$f instanceof laya.display.Input&&p$f.multiline==p$q.multiline?p$q._focusOut():p$q.focus=!1}p$l.I.onMouseDown(p$h,this._tTouchID,this._isLeftMouse)},p$h.onMouseUp=function(p$h){p$l.I.onMouseUp(p$h,this._tTouchID,this._isLeftMouse)},p$h.check=function(p$h,p$q,p$f,p$g){this._point.setTo(p$q,p$f),p$h.fromParentPoint(this._point),p$q=this._point.x,p$f=this._point.y;var p$$=p$h.scrollRect;if(p$$&&(this._rect.setTo(p$$.x,p$$.y,p$$.width,p$$.height),!this._rect.contains(p$q,p$f)))return!1;if(!this.disableMouseEvent){if(p$h.hitTestPrior&&!p$h.mouseThrough&&!this.hitTest(p$h,p$q,p$f))return!1;for(var p$P=p$h._childs.length-1;-1<p$P;p$P--){var p$S=p$h._childs[p$P];if(!p$S.destroyed&&p$S.mouseEnabled&&p$S.visible&&this.check(p$S,p$q,p$f,p$g))return!0}}var p$B=!(!p$h.hitTestPrior||p$h.mouseThrough||this.disableMouseEvent)||this.hitTest(p$h,p$q,p$f);return p$B?(this._target=p$h,p$g.call(this,p$h)):p$g===this.onMouseUp&&p$h===this._stage&&(this._target=this._stage,p$g.call(this,this._target)),p$B},p$h.hitTest=function(p$h,p$q,p$f){var p$g=!1;if(p$h.scrollRect&&(p$q-=p$h.scrollRect.x,p$f-=p$h.scrollRect.y),p$h.hitArea instanceof laya.utils.HitArea)return p$h.hitArea.isHit(p$q,p$f);if(0<p$h.width&&0<p$h.height||p$h.mouseThrough||p$h.hitArea)if(p$h.mouseThrough)p$g=p$h.getGraphicBounds().contains(p$q,p$f);else{var p$$=this._rect;p$h.hitArea?p$$=p$h.hitArea:p$$.setTo(0,0,p$h.width,p$h.height),p$g=p$$.contains(p$q,p$f)}return p$g},p$h.runEvent=function(){var p$h=this._eventList.length;if(p$h){this.mouseEventTime=p$w.now();var p$q,p$f=0,p$g=0,p$$=0;try{for(;p$f<p$h;){var p$P=this._eventList[p$f];switch("mousemove"!==p$P.type&&(this._prePoint.x=this._prePoint.y=-1e6),p$P.type){case"mousedown":this._touchIDs[0]=this._id++,p$Y._isTouchRespond?p$Y._isTouchRespond=!1:(this._isLeftMouse=0===p$P.button,this.initEvent(p$P),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===p$P.button,this.initEvent(p$P),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-p$P.clientX)+Math.abs(this._prePoint.y-p$P.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=p$P.clientX,this._prePoint.y=p$P.clientY,this.initEvent(p$P),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":p$Y._isTouchRespond=!0,this._isLeftMouse=!0;var p$S=p$P.changedTouches;for(p$g=0,p$$=p$S.length;p$g<p$$;p$g++)p$q=p$S[p$g],(p$Y.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=p$q.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[p$q.identifier]=this._id++,this.initEvent(p$q,p$P),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":p$Y._isTouchRespond=!0,this._isLeftMouse=!0;var p$B=p$P.changedTouches;for(p$g=0,p$$=p$B.length;p$g<p$$;p$g++)if(p$q=p$B[p$g],p$Y.multiTouchEnabled||p$q.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(p$q,p$P);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var p$r=p$P.changedTouches;for(p$g=0,p$$=p$r.length;p$g<p$$;p$g++)p$q=p$r[p$g],(p$Y.multiTouchEnabled||p$q.identifier==this._curTouchID)&&(this.initEvent(p$q,p$P),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(p$P);break;case"mouseout":p$l.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}p$f++}}catch(p$h){throw this._eventList.length=0,p$h}this._eventList.length=0}},p$Y.enabled=!0,p$Y.multiTouchEnabled=!0,p$Y._isTouchRespond=!1,p$Y._isFirstTouch=!0,p$r(p$Y,["instance",function(){return this.instance=new p$Y}]),p$Y}()),p$l=function(){function p$L(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new p$P}p$C(p$L,"laya.events.TouchManager");var p$h=p$L.prototype;return p$h._clearTempArrs=function(){p$L._oldArr.length=0,p$L._newArr.length=0,p$L._tEleArr.length=0},p$h.getTouchFromArr=function(p$h,p$q){var p$f,p$g,p$$=0;for(p$f=p$q.length,p$$=0;p$$<p$f;p$$++)if((p$g=p$q[p$$]).id==p$h)return p$g;return null},p$h.removeTouchFromArr=function(p$h,p$q){var p$f=0;for(p$f=p$q.length-1;0<=p$f;p$f--)p$q[p$f].id==p$h&&p$q.splice(p$f,1)},p$h.createTouchO=function(p$h,p$q){var p$f;return(p$f=p$F.getItem("TouchData")||{}).id=p$q,p$f.tar=p$h,p$f},p$h.onMouseDown=function(p$h,p$q,p$f){var p$g,p$$,p$P,p$S;(void 0===p$f&&(p$f=!1),this.enable)&&(p$g=this.getTouchFromArr(p$q,this.preOvers),p$P=this.getEles(p$h,null,p$L._tEleArr),p$g?p$g.tar=p$h:(p$$=this.createTouchO(p$h,p$q),this.preOvers.push(p$$)),p$w.onMobile&&this.sendEvents(p$P,"mouseover",p$q),p$S=p$f?this.preDowns:this.preRightDowns,(p$g=this.getTouchFromArr(p$q,p$S))?p$g.tar=p$h:(p$$=this.createTouchO(p$h,p$q),p$S.push(p$$)),this.sendEvents(p$P,p$f?"mousedown":"rightmousedown",p$q),this._clearTempArrs())},p$h.sendEvents=function(p$h,p$q,p$f){void 0===p$f&&(p$f=0);var p$g,p$$,p$P,p$S=0;for(p$g=p$h.length,this._event._stoped=!1,p$$=p$h[0],p$S=0;p$S<p$g;p$S++){if((p$P=p$h[p$S]).destroyed)return;if(p$P.event(p$q,this._event.setTo(p$q,p$P,p$$)),this._event._stoped)break}},p$h.getEles=function(p$h,p$q,p$f){for(p$f?p$f.length=0:p$f=[];p$h&&p$h!=p$q;)p$f.push(p$h),p$h=p$h.parent;return p$f},p$h.checkMouseOutAndOverOfMove=function(p$h,p$q,p$f){if(void 0===p$f&&(p$f=0),p$q!=p$h){var p$g,p$$,p$P=0,p$S=0;if(p$q.contains(p$h))p$$=this.getEles(p$h,p$q,p$L._tEleArr),this.sendEvents(p$$,"mouseover",p$f);else if(p$h.contains(p$q))p$$=this.getEles(p$q,p$h,p$L._tEleArr),this.sendEvents(p$$,"mouseout",p$f);else{var p$B,p$r;(p$$=p$L._tEleArr).length=0,p$B=this.getEles(p$q,null,p$L._oldArr),p$r=this.getEles(p$h,null,p$L._newArr),p$S=p$B.length;var p$Y=0;for(p$P=0;p$P<p$S;p$P++){if(p$g=p$B[p$P],0<=(p$Y=p$r.indexOf(p$g))){p$r.splice(p$Y,p$r.length-p$Y);break}p$$.push(p$g)}0<p$$.length&&this.sendEvents(p$$,"mouseout",p$f),0<p$r.length&&this.sendEvents(p$r,"mouseover",p$f)}}},p$h.onMouseMove=function(p$h,p$q){var p$f,p$g;this.enable&&((p$f=this.getTouchFromArr(p$q,this.preOvers))?(this.checkMouseOutAndOverOfMove(p$h,p$f.tar),p$f.tar=p$h,p$g=this.getEles(p$h,null,p$L._tEleArr)):(p$g=this.getEles(p$h,null,p$L._tEleArr),this.sendEvents(p$g,"mouseover",p$q),this.preOvers.push(this.createTouchO(p$h,p$q))),this.sendEvents(p$g,"mousemove",p$q),this._clearTempArrs())},p$h.getLastOvers=function(){return(p$L._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,p$L._tEleArr):(p$L._tEleArr.push(p$t.stage),p$L._tEleArr)},p$h.stageMouseOut=function(){var p$h;p$h=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(p$h,"mouseout",0)},p$h.onMouseUp=function(p$h,p$q,p$f){if(void 0===p$f&&(p$f=!1),this.enable){var p$g,p$$,p$P,p$S,p$B,p$r,p$Y=0,p$C=0,p$U=p$w.onMobile;if(p$$=this.getEles(p$h,null,p$L._tEleArr),this.sendEvents(p$$,p$f?"mouseup":"rightmouseup",p$q),p$r=p$f?this.preDowns:this.preRightDowns,p$g=this.getTouchFromArr(p$q,p$r)){var p$u,p$v=p$w.now();if(p$u=p$v-this._lastClickTime<300,this._lastClickTime=p$v,p$h==p$g.tar)p$B=p$$;else for(p$P=this.getEles(p$g.tar,null,p$L._oldArr),(p$B=p$L._newArr).length=0,p$C=p$P.length,p$Y=0;p$Y<p$C;p$Y++)p$S=p$P[p$Y],0<=p$$.indexOf(p$S)&&p$B.push(p$S);0<p$B.length&&this.sendEvents(p$B,p$f?"click":"rightclick",p$q),p$f&&p$u&&this.sendEvents(p$B,"doubleclick",p$q),this.removeTouchFromArr(p$q,p$r),p$g.tar=null,p$F.recover("TouchData",p$g)}else;(p$g=this.getTouchFromArr(p$q,this.preOvers))&&p$U&&((p$B=this.getEles(p$g.tar,null,p$B))&&0<p$B.length&&this.sendEvents(p$B,"mouseout",p$q),this.removeTouchFromArr(p$q,this.preOvers),p$g.tar=null,p$F.recover("TouchData",p$g)),this._clearTempArrs()}},p$L._oldArr=[],p$L._newArr=[],p$L._tEleArr=[],p$r(p$L,["I",function(){return this.I=new p$L}]),p$L}(),p$_=function(){function p$h(){this._action=null}p$C(p$h,"laya.filters.Filter");var p$q=p$h.prototype;return p$t.imps(p$q,{"laya.filters.IFilter":!0}),p$q.callNative=function(p$h){},p$L(0,p$q,"type",function(){return-1}),p$L(0,p$q,"action",function(){return this._action}),p$h.BLUR=16,p$h.COLOR=32,p$h.GLOW=8,p$h._filterStart=null,p$h._filterEnd=null,p$h._EndTarget=null,p$h._recycleScope=null,p$h._filter=null,p$h._useSrc=null,p$h._endSrc=null,p$h._useOut=null,p$h._endOut=null,p$h}(),p$G=function(){function p$h(){this.data=null}p$C(p$h,"laya.filters.ColorFilterAction");var p$q=p$h.prototype;return p$t.imps(p$q,{"laya.filters.IFilterAction":!0}),p$q.apply=function(p$h){var p$q=p$h.ctx.ctx,p$f=p$h.ctx.ctx.canvas;if(0==p$f.width||0==p$f.height)return p$f;for(var p$g,p$$=p$q.getImageData(0,0,p$f.width,p$f.height),p$P=p$$.data,p$S=0,p$B=p$P.length;p$S<p$B;p$S+=4)p$g=this.getColor(p$P[p$S],p$P[p$S+1],p$P[p$S+2],p$P[p$S+3]),0!=p$P[p$S+3]&&(p$P[p$S]=p$g[0],p$P[p$S+1]=p$g[1],p$P[p$S+2]=p$g[2],p$P[p$S+3]=p$g[3]);return p$q.putImageData(p$$,0,0),p$h},p$q.getColor=function(p$h,p$q,p$f,p$g){var p$$=[];if(this.data._mat&&this.data._alpha){var p$P=this.data._mat,p$S=this.data._alpha;p$$[0]=p$P[0]*p$h+p$P[1]*p$q+p$P[2]*p$f+p$P[3]*p$g+p$S[0],p$$[1]=p$P[4]*p$h+p$P[5]*p$q+p$P[6]*p$f+p$P[7]*p$g+p$S[1],p$$[2]=p$P[8]*p$h+p$P[9]*p$q+p$P[10]*p$f+p$P[11]*p$g+p$S[2],p$$[3]=p$P[12]*p$h+p$P[13]*p$q+p$P[14]*p$f+p$P[15]*p$g+p$S[3]}return p$$},p$h}(),p$m=(function(){function p$h(){}p$C(p$h,"laya.maths.Arith"),p$h.formatR=function(p$h){return p$h>Math.PI&&(p$h-=2*Math.PI),p$h<-Math.PI&&(p$h+=2*Math.PI),p$h},p$h.isPOT=function(p$h,p$q){return 0<p$h&&0==(p$h&p$h-1)&&0<p$q&&0==(p$q&p$q-1)},p$h.setMatToArray=function(p$h,p$q){p$h.a,p$h.b,p$h.c,p$h.d,p$h.tx,p$h.ty,p$q[0]=p$h.a,p$q[1]=p$h.b,p$q[4]=p$h.c,p$q[5]=p$h.d,p$q[12]=p$h.tx,p$q[13]=p$h.ty}}(),function(){function p$h(){this._controlPoints=[new p$X,new p$X,new p$X],this._calFun=this.getPoint2}p$C(p$h,"laya.maths.Bezier");var p$q=p$h.prototype;return p$q._switchPoint=function(p$h,p$q){var p$f=this._controlPoints.shift();p$f.setTo(p$h,p$q),this._controlPoints.push(p$f)},p$q.getPoint2=function(p$h,p$q){var p$f=this._controlPoints[0],p$g=this._controlPoints[1],p$$=this._controlPoints[2],p$P=Math.pow(1-p$h,2)*p$f.x+2*p$h*(1-p$h)*p$g.x+Math.pow(p$h,2)*p$$.x,p$S=Math.pow(1-p$h,2)*p$f.y+2*p$h*(1-p$h)*p$g.y+Math.pow(p$h,2)*p$$.y;p$q.push(p$P,p$S)},p$q.getPoint3=function(p$h,p$q){var p$f=this._controlPoints[0],p$g=this._controlPoints[1],p$$=this._controlPoints[2],p$P=this._controlPoints[3],p$S=Math.pow(1-p$h,3)*p$f.x+3*p$g.x*p$h*(1-p$h)*(1-p$h)+3*p$$.x*p$h*p$h*(1-p$h)+p$P.x*Math.pow(p$h,3),p$B=Math.pow(1-p$h,3)*p$f.y+3*p$g.y*p$h*(1-p$h)*(1-p$h)+3*p$$.y*p$h*p$h*(1-p$h)+p$P.y*Math.pow(p$h,3);p$q.push(p$S,p$B)},p$q.insertPoints=function(p$h,p$q){var p$f,p$g=NaN;for(p$f=1/(p$h=0<p$h?p$h:5),p$g=0;p$g<=1;p$g+=p$f)this._calFun(p$g,p$q)},p$q.getBezierPoints=function(p$h,p$q,p$f){void 0===p$q&&(p$q=5),void 0===p$f&&(p$f=2);var p$g,p$$,p$P=0;if((p$g=p$h.length)<2*(p$f+1))return[];switch(p$$=[],p$f){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=p$f;)this._controlPoints.push(new p$X);for(p$P=0;p$P<2*p$f;p$P+=2)this._switchPoint(p$h[p$P],p$h[p$P+1]);for(p$P=2*p$f;p$P<p$g;p$P+=2)this._switchPoint(p$h[p$P],p$h[p$P+1]),p$P/2%p$f==0&&this.insertPoints(p$q,p$$);return p$$},p$r(p$h,["I",function(){return this.I=new p$h}]),p$h}()),p$E=function(){function p$Y(){}return p$C(p$Y,"laya.maths.GrahamScan"),p$Y.multiply=function(p$h,p$q,p$f){return(p$h.x-p$f.x)*(p$q.y-p$f.y)-(p$q.x-p$f.x)*(p$h.y-p$f.y)},p$Y.dis=function(p$h,p$q){return(p$h.x-p$q.x)*(p$h.x-p$q.x)+(p$h.y-p$q.y)*(p$h.y-p$q.y)},p$Y._getPoints=function(p$h,p$q,p$f){for(void 0===p$q&&(p$q=!1),p$Y._mPointList||(p$Y._mPointList=[]);p$Y._mPointList.length<p$h;)p$Y._mPointList.push(new p$X);return p$f||(p$f=[]),p$f.length=0,p$q?p$Y.getFrom(p$f,p$Y._mPointList,p$h):p$Y.getFromR(p$f,p$Y._mPointList,p$h),p$f},p$Y.getFrom=function(p$h,p$q,p$f){var p$g=0;for(p$g=0;p$g<p$f;p$g++)p$h.push(p$q[p$g]);return p$h},p$Y.getFromR=function(p$h,p$q,p$f){var p$g=0;for(p$g=0;p$g<p$f;p$g++)p$h.push(p$q.pop());return p$h},p$Y.pListToPointList=function(p$h,p$q){void 0===p$q&&(p$q=!1);var p$f=0,p$g=p$h.length/2,p$$=p$Y._getPoints(p$g,p$q,p$Y._tempPointList);for(p$f=0;p$f<p$g;p$f++)p$$[p$f].setTo(p$h[p$f+p$f],p$h[p$f+p$f+1]);return p$$},p$Y.pointListToPlist=function(p$h){var p$q,p$f=0,p$g=p$h.length,p$$=p$Y._temPList;for(p$f=p$$.length=0;p$f<p$g;p$f++)p$q=p$h[p$f],p$$.push(p$q.x,p$q.y);return p$$},p$Y.scanPList=function(p$h){return p$O.copyArray(p$h,p$Y.pointListToPlist(p$Y.scan(p$Y.pListToPointList(p$h,!0))))},p$Y.scan=function(p$h){var p$q,p$f,p$g,p$$=0,p$P=0,p$S=0,p$B=p$h.length,p$r={};for((p$f=p$Y._temArr).length=0,p$$=(p$B=p$h.length)-1;0<=p$$;p$$--)p$g=(p$q=p$h[p$$]).x+"_"+p$q.y,p$r.hasOwnProperty(p$g)||(p$r[p$g]=!0,p$f.push(p$q));for(p$B=p$f.length,p$O.copyArray(p$h,p$f),p$$=1;p$$<p$B;p$$++)(p$h[p$$].y<p$h[p$S].y||p$h[p$$].y==p$h[p$S].y&&p$h[p$$].x<p$h[p$S].x)&&(p$S=p$$);for(p$q=p$h[0],p$h[0]=p$h[p$S],p$h[p$S]=p$q,p$$=1;p$$<p$B-1;p$$++){for(p$P=(p$S=p$$)+1;p$P<p$B;p$P++)(0<p$Y.multiply(p$h[p$P],p$h[p$S],p$h[0])||0==p$Y.multiply(p$h[p$P],p$h[p$S],p$h[0])&&p$Y.dis(p$h[0],p$h[p$P])<p$Y.dis(p$h[0],p$h[p$S]))&&(p$S=p$P);p$q=p$h[p$$],p$h[p$$]=p$h[p$S],p$h[p$S]=p$q}if((p$f=p$Y._temArr).length=0,p$h.length<3)return p$O.copyArray(p$f,p$h);for(p$f.push(p$h[0],p$h[1],p$h[2]),p$$=3;p$$<p$B;p$$++){for(;2<=p$f.length&&0<=p$Y.multiply(p$h[p$$],p$f[p$f.length-1],p$f[p$f.length-2]);)p$f.pop();p$h[p$$]&&p$f.push(p$h[p$$])}return p$f},p$Y._mPointList=null,p$Y._tempPointList=[],p$Y._temPList=[],p$Y._temArr=[],p$Y}(),p$R=function(){function p$$(){}return p$C(p$$,"laya.maths.MathUtil"),p$$.subtractVector3=function(p$h,p$q,p$f){p$f[0]=p$h[0]-p$q[0],p$f[1]=p$h[1]-p$q[1],p$f[2]=p$h[2]-p$q[2]},p$$.lerp=function(p$h,p$q,p$f){return p$h*(1-p$f)+p$q*p$f},p$$.scaleVector3=function(p$h,p$q,p$f){p$f[0]=p$h[0]*p$q,p$f[1]=p$h[1]*p$q,p$f[2]=p$h[2]*p$q},p$$.lerpVector3=function(p$h,p$q,p$f,p$g){var p$$=p$h[0],p$P=p$h[1],p$S=p$h[2];p$g[0]=p$$+p$f*(p$q[0]-p$$),p$g[1]=p$P+p$f*(p$q[1]-p$P),p$g[2]=p$S+p$f*(p$q[2]-p$S)},p$$.lerpVector4=function(p$h,p$q,p$f,p$g){var p$$=p$h[0],p$P=p$h[1],p$S=p$h[2],p$B=p$h[3];p$g[0]=p$$+p$f*(p$q[0]-p$$),p$g[1]=p$P+p$f*(p$q[1]-p$P),p$g[2]=p$S+p$f*(p$q[2]-p$S),p$g[3]=p$B+p$f*(p$q[3]-p$B)},p$$.slerpQuaternionArray=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){var p$B,p$r,p$Y,p$C,p$U,p$u=p$h[p$q+0],p$v=p$h[p$q+1],p$L=p$h[p$q+2],p$e=p$h[p$q+3],p$l=p$f[p$g+0],p$_=p$f[p$g+1],p$N=p$f[p$g+2],p$G=p$f[p$g+3];return(p$r=p$u*p$l+p$v*p$_+p$L*p$N+p$e*p$G)<0&&(p$r=-p$r,p$l=-p$l,p$_=-p$_,p$N=-p$N,p$G=-p$G),p$U=1e-6<1-p$r?(p$B=Math.acos(p$r),p$Y=Math.sin(p$B),p$C=Math.sin((1-p$$)*p$B)/p$Y,Math.sin(p$$*p$B)/p$Y):(p$C=1-p$$,p$$),p$P[p$S+0]=p$C*p$u+p$U*p$l,p$P[p$S+1]=p$C*p$v+p$U*p$_,p$P[p$S+2]=p$C*p$L+p$U*p$N,p$P[p$S+3]=p$C*p$e+p$U*p$G,p$P},p$$.getRotation=function(p$h,p$q,p$f,p$g){return Math.atan2(p$g-p$q,p$f-p$h)/Math.PI*180},p$$.sortBigFirst=function(p$h,p$q){return p$h==p$q?0:p$h<p$q?1:-1},p$$.sortSmallFirst=function(p$h,p$q){return p$h==p$q?0:p$h<p$q?-1:1},p$$.sortNumBigFirst=function(p$h,p$q){return parseFloat(p$q)-parseFloat(p$h)},p$$.sortNumSmallFirst=function(p$h,p$q){return parseFloat(p$h)-parseFloat(p$q)},p$$.sortByKey=function(p$f,p$h,p$q){var p$g;return void 0===p$h&&(p$h=!1),void 0===p$q&&(p$q=!0),p$g=p$h?p$q?p$$.sortNumBigFirst:p$$.sortBigFirst:p$q?p$$.sortNumSmallFirst:p$$.sortSmallFirst,function(p$h,p$q){return p$g(p$h[p$f],p$q[p$f])}},p$$}(),p$b=function(){function p$f(p$h,p$q,p$f,p$g,p$$,p$P){this.inPool=!1,this.bTransform=!1,void 0===p$h&&(p$h=1),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=1),void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=0),this.a=p$h,this.b=p$q,this.c=p$f,this.d=p$g,this.tx=p$$,this.ty=p$P,this._checkTransform()}p$C(p$f,"laya.maths.Matrix");var p$h=p$f.prototype;return p$h.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},p$h._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},p$h.setTranslate=function(p$h,p$q){return this.tx=p$h,this.ty=p$q,this},p$h.translate=function(p$h,p$q){return this.tx+=p$h,this.ty+=p$q,this},p$h.scale=function(p$h,p$q){this.a*=p$h,this.d*=p$q,this.c*=p$h,this.b*=p$q,this.tx*=p$h,this.ty*=p$q,this.bTransform=!0},p$h.rotate=function(p$h){var p$q=Math.cos(p$h),p$f=Math.sin(p$h),p$g=this.a,p$$=this.c,p$P=this.tx;this.a=p$g*p$q-this.b*p$f,this.b=p$g*p$f+this.b*p$q,this.c=p$$*p$q-this.d*p$f,this.d=p$$*p$f+this.d*p$q,this.tx=p$P*p$q-this.ty*p$f,this.ty=p$P*p$f+this.ty*p$q,this.bTransform=!0},p$h.skew=function(p$h,p$q){var p$f=Math.tan(p$h),p$g=Math.tan(p$q),p$$=this.a,p$P=this.b;return this.a+=p$g*this.c,this.b+=p$g*this.d,this.c+=p$f*p$$,this.d+=p$f*p$P,this},p$h.invertTransformPoint=function(p$h){var p$q=this.a,p$f=this.b,p$g=this.c,p$$=this.d,p$P=this.tx,p$S=p$q*p$$-p$f*p$g,p$B=p$$/p$S,p$r=-p$f/p$S,p$Y=-p$g/p$S,p$C=p$q/p$S,p$U=(p$g*this.ty-p$$*p$P)/p$S,p$u=-(p$q*this.ty-p$f*p$P)/p$S;return p$h.setTo(p$B*p$h.x+p$Y*p$h.y+p$U,p$r*p$h.x+p$C*p$h.y+p$u)},p$h.transformPoint=function(p$h){return p$h.setTo(this.a*p$h.x+this.c*p$h.y+this.tx,this.b*p$h.x+this.d*p$h.y+this.ty)},p$h.transformPointN=function(p$h){return p$h.setTo(this.a*p$h.x+this.c*p$h.y,this.b*p$h.x+this.d*p$h.y)},p$h.transformPointArray=function(p$h,p$q){for(var p$f=p$h.length,p$g=0;p$g<p$f;p$g+=2){var p$$=p$h[p$g],p$P=p$h[p$g+1];p$q[p$g]=this.a*p$$+this.c*p$P+this.tx,p$q[p$g+1]=this.b*p$$+this.d*p$P+this.ty}return p$q},p$h.transformPointArrayScale=function(p$h,p$q){for(var p$f=p$h.length,p$g=0;p$g<p$f;p$g+=2){var p$$=p$h[p$g],p$P=p$h[p$g+1];p$q[p$g]=this.a*p$$+this.c*p$P,p$q[p$g+1]=this.b*p$$+this.d*p$P}return p$q},p$h.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},p$h.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},p$h.invert=function(){var p$h=this.a,p$q=this.b,p$f=this.c,p$g=this.d,p$$=this.tx,p$P=p$h*p$g-p$q*p$f;return this.a=p$g/p$P,this.b=-p$q/p$P,this.c=-p$f/p$P,this.d=p$h/p$P,this.tx=(p$f*this.ty-p$g*p$$)/p$P,this.ty=-(p$h*this.ty-p$q*p$$)/p$P,this},p$h.setTo=function(p$h,p$q,p$f,p$g,p$$,p$P){return this.a=p$h,this.b=p$q,this.c=p$f,this.d=p$g,this.tx=p$$,this.ty=p$P,this},p$h.concat=function(p$h){var p$q=this.a,p$f=this.c,p$g=this.tx;return this.a=p$q*p$h.a+this.b*p$h.c,this.b=p$q*p$h.b+this.b*p$h.d,this.c=p$f*p$h.a+this.d*p$h.c,this.d=p$f*p$h.b+this.d*p$h.d,this.tx=p$g*p$h.a+this.ty*p$h.c+p$h.tx,this.ty=p$g*p$h.b+this.ty*p$h.d+p$h.ty,this},p$h.scaleEx=function(p$h,p$q){var p$f=this.a,p$g=this.b,p$$=this.c,p$P=this.d;0!==p$g||0!==p$$?(this.a=p$h*p$f,this.b=p$h*p$g,this.c=p$q*p$$):(this.a=p$h*p$f,this.b=0*p$P,this.c=0*p$f),this.d=p$q*p$P,this.bTransform=!0},p$h.rotateEx=function(p$h){var p$q=Math.cos(p$h),p$f=Math.sin(p$h),p$g=this.a,p$$=this.b,p$P=this.c,p$S=this.d;0!==p$$||0!==p$P?(this.a=p$q*p$g+p$f*p$P,this.b=p$q*p$$+p$f*p$S,this.c=-p$f*p$g+p$q*p$P,this.d=-p$f*p$$+p$q*p$S):(this.a=p$q*p$g,this.b=p$f*p$S,this.c=-p$f*p$g,this.d=p$q*p$S),this.bTransform=!0},p$h.clone=function(){var p$h=p$f.create();return p$h.a=this.a,p$h.b=this.b,p$h.c=this.c,p$h.d=this.d,p$h.tx=this.tx,p$h.ty=this.ty,p$h.bTransform=this.bTransform,p$h},p$h.copyTo=function(p$h){return p$h.a=this.a,p$h.b=this.b,p$h.c=this.c,p$h.d=this.d,p$h.tx=this.tx,p$h.ty=this.ty,p$h.bTransform=this.bTransform,p$h},p$h.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},p$h.destroy=function(){if(!this.inPool){var p$h=p$f._cache;this.inPool=!0,p$h._length||(p$h._length=0),(p$h[p$h._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},p$f.mul=function(p$h,p$q,p$f){var p$g=p$h.a,p$$=p$h.b,p$P=p$h.c,p$S=p$h.d,p$B=p$h.tx,p$r=p$h.ty,p$Y=p$q.a,p$C=p$q.b,p$U=p$q.c,p$u=p$q.d,p$v=p$q.tx,p$L=p$q.ty;return 0!==p$C||0!==p$U?(p$f.a=p$g*p$Y+p$$*p$U,p$f.b=p$g*p$C+p$$*p$u,p$f.c=p$P*p$Y+p$S*p$U,p$f.d=p$P*p$C+p$S*p$u,p$f.tx=p$Y*p$B+p$U*p$r+p$v,p$f.ty=p$C*p$B+p$u*p$r+p$L):(p$f.a=p$g*p$Y,p$f.b=p$$*p$u,p$f.c=p$P*p$Y,p$f.d=p$S*p$u,p$f.tx=p$Y*p$B+p$v,p$f.ty=p$u*p$r+p$L),p$f},p$f.mul16=function(p$h,p$q,p$f){var p$g=p$h.a,p$$=p$h.b,p$P=p$h.c,p$S=p$h.d,p$B=p$h.tx,p$r=p$h.ty,p$Y=p$q.a,p$C=p$q.b,p$U=p$q.c,p$u=p$q.d,p$v=p$q.tx,p$L=p$q.ty;return 0!==p$C||0!==p$U?(p$f[0]=p$g*p$Y+p$$*p$U,p$f[1]=p$g*p$C+p$$*p$u,p$f[4]=p$P*p$Y+p$S*p$U,p$f[5]=p$P*p$C+p$S*p$u,p$f[12]=p$Y*p$B+p$U*p$r+p$v,p$f[13]=p$C*p$B+p$u*p$r+p$L):(p$f[0]=p$g*p$Y,p$f[1]=p$$*p$u,p$f[4]=p$P*p$Y,p$f[5]=p$S*p$u,p$f[12]=p$Y*p$B+p$v,p$f[13]=p$u*p$r+p$L),p$f},p$f.mulPre=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){var p$r=p$h.a,p$Y=p$h.b,p$C=p$h.c,p$U=p$h.d,p$u=p$h.tx,p$v=p$h.ty;return 0!==p$f||0!==p$g?(p$B.a=p$r*p$q+p$Y*p$g,p$B.b=p$r*p$f+p$Y*p$$,p$B.c=p$C*p$q+p$U*p$g,p$B.d=p$C*p$f+p$U*p$$,p$B.tx=p$q*p$u+p$g*p$v+p$P,p$B.ty=p$f*p$u+p$$*p$v+p$S):(p$B.a=p$r*p$q,p$B.b=p$Y*p$$,p$B.c=p$C*p$q,p$B.d=p$U*p$$,p$B.tx=p$q*p$u+p$P,p$B.ty=p$$*p$v+p$S),p$B},p$f.mulPos=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){var p$r=p$h.a,p$Y=p$h.b,p$C=p$h.c,p$U=p$h.d,p$u=p$h.tx,p$v=p$h.ty;return 0!==p$Y||0!==p$C?(p$B.a=p$q*p$r+p$f*p$C,p$B.b=p$q*p$Y+p$f*p$U,p$B.c=p$g*p$r+p$$*p$C,p$B.d=p$g*p$Y+p$$*p$U,p$B.tx=p$r*p$P+p$C*p$S+p$u,p$B.ty=p$Y*p$P+p$U*p$S+p$v):(p$B.a=p$q*p$r,p$B.b=p$f*p$U,p$B.c=p$g*p$r,p$B.d=p$$*p$U,p$B.tx=p$r*p$P+p$u,p$B.ty=p$U*p$S+p$v),p$B},p$f.preMul=function(p$h,p$q,p$f){var p$g=p$h.a,p$$=p$h.b,p$P=p$h.c,p$S=p$h.d,p$B=p$q.a,p$r=p$q.b,p$Y=p$q.c,p$C=p$q.d,p$U=p$q.tx,p$u=p$q.ty;return p$f.a=p$B*p$g,p$f.b=p$f.c=0,p$f.d=p$C*p$S,p$f.tx=p$U*p$g+p$h.tx,p$f.ty=p$u*p$S+p$h.ty,0===p$r&&0===p$Y&&0===p$$&&0===p$P||(p$f.a+=p$r*p$P,p$f.d+=p$Y*p$$,p$f.b+=p$B*p$$+p$r*p$S,p$f.c+=p$Y*p$g+p$C*p$P,p$f.tx+=p$u*p$P,p$f.ty+=p$U*p$$),p$f},p$f.preMulXY=function(p$h,p$q,p$f,p$g){var p$$=p$h.a,p$P=p$h.b,p$S=p$h.c,p$B=p$h.d;return p$g.a=p$$,p$g.b=p$P,p$g.c=p$S,p$g.d=p$B,p$g.tx=p$q*p$$+p$h.tx+p$f*p$S,p$g.ty=p$f*p$B+p$h.ty+p$q*p$P,p$g},p$f.create=function(){var p$h=p$f._cache,p$q=p$h._length?p$h[--p$h._length]:new p$f;return p$q.inPool=!1,p$q},p$f.EMPTY=new p$f,p$f.TEMP=new p$f,p$f._cache=[],p$f}(),p$X=function(){function p$h(p$h,p$q){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),this.x=p$h,this.y=p$q}p$C(p$h,"laya.maths.Point");var p$q=p$h.prototype;return p$q.setTo=function(p$h,p$q){return this.x=p$h,this.y=p$q,this},p$q.distance=function(p$h,p$q){return Math.sqrt((this.x-p$h)*(this.x-p$h)+(this.y-p$q)*(this.y-p$q))},p$q.toString=function(){return this.x+","+this.y},p$q.normalize=function(){var p$h=Math.sqrt(this.x*this.x+this.y*this.y);if(0<p$h){var p$q=1/p$h;this.x*=p$q,this.y*=p$q}},p$h.TEMP=new p$h,p$h.EMPTY=new p$h,p$h}(),p$n=function(){function p$Y(p$h,p$q,p$f,p$g){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0),this.x=p$h,this.y=p$q,this.width=p$f,this.height=p$g}p$C(p$Y,"laya.maths.Rectangle");var p$h=p$Y.prototype;return p$h.setTo=function(p$h,p$q,p$f,p$g){return this.x=p$h,this.y=p$q,this.width=p$f,this.height=p$g,this},p$h.copyFrom=function(p$h){return this.x=p$h.x,this.y=p$h.y,this.width=p$h.width,this.height=p$h.height,this},p$h.contains=function(p$h,p$q){return!(this.width<=0||this.height<=0)&&(p$h>=this.x&&p$h<this.right&&p$q>=this.y&&p$q<this.bottom)},p$h.intersects=function(p$h){return!(p$h.x>this.x+this.width||p$h.x+p$h.width<this.x||p$h.y>this.y+this.height||p$h.y+p$h.height<this.y)},p$h.intersection=function(p$h,p$q){return this.intersects(p$h)?(p$q||(p$q=new p$Y),p$q.x=Math.max(this.x,p$h.x),p$q.y=Math.max(this.y,p$h.y),p$q.width=Math.min(this.right,p$h.right)-p$q.x,p$q.height=Math.min(this.bottom,p$h.bottom)-p$q.y,p$q):null},p$h.union=function(p$h,p$q){return p$q||(p$q=new p$Y),this.clone(p$q),p$h.width<=0||p$h.height<=0?p$q:(p$q.addPoint(p$h.x,p$h.y),p$q.addPoint(p$h.right,p$h.bottom),this)},p$h.clone=function(p$h){return p$h||(p$h=new p$Y),p$h.x=this.x,p$h.y=this.y,p$h.width=this.width,p$h.height=this.height,p$h},p$h.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},p$h.equals=function(p$h){return!(!p$h||p$h.x!==this.x||p$h.y!==this.y||p$h.width!==this.width||p$h.height!==this.height)},p$h.addPoint=function(p$h,p$q){return this.x>p$h&&(this.width+=this.x-p$h,this.x=p$h),this.y>p$q&&(this.height+=this.y-p$q,this.y=p$q),this.width<p$h-this.x&&(this.width=p$h-this.x),this.height<p$q-this.y&&(this.height=p$q-this.y),this},p$h._getBoundPoints=function(){var p$h=p$Y._temB;return(p$h.length=0)==this.width||0==this.height||p$h.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),p$h},p$h.isEmpty=function(){return this.width<=0||this.height<=0},p$L(0,p$h,"right",function(){return this.x+this.width}),p$L(0,p$h,"bottom",function(){return this.y+this.height}),p$Y._getBoundPointS=function(p$h,p$q,p$f,p$g){var p$$=p$Y._temA;return(p$$.length=0)==p$f||0==p$g||p$$.push(p$h,p$q,p$h+p$f,p$q,p$h,p$q+p$g,p$h+p$f,p$q+p$g),p$$},p$Y._getWrapRec=function(p$h,p$q){if(!p$h||p$h.length<1)return p$q?p$q.setTo(0,0,0,0):p$Y.TEMP.setTo(0,0,0,0);p$q=p$q||new p$Y;var p$f,p$g,p$$,p$P,p$S,p$B=p$h.length,p$r=p$X.TEMP;for(p$$=p$S=-(p$g=p$P=99999),p$f=0;p$f<p$B;p$f+=2)p$r.x=p$h[p$f],p$r.y=p$h[p$f+1],p$g=p$g<p$r.x?p$g:p$r.x,p$P=p$P<p$r.y?p$P:p$r.y,p$$=p$$>p$r.x?p$$:p$r.x,p$S=p$S>p$r.y?p$S:p$r.y;return p$q.setTo(p$g,p$P,p$$-p$g,p$S-p$P)},p$Y.EMPTY=new p$Y,p$Y.TEMP=new p$Y,p$Y._temB=[],p$Y._temA=[],p$Y}(),p$A=function(){function p$r(){}return p$C(p$r,"laya.media.SoundManager"),p$L(1,p$r,"useAudioMusic",function(){return p$r._useAudioMusic},function(p$h){p$r._useAudioMusic=p$h,p$r._musicClass=p$h?p$fh:null}),p$L(1,p$r,"autoStopMusic",function(){return p$r._autoStopMusic},function(p$h){p$t.stage.off("blur",null,p$r._stageOnBlur),p$t.stage.off("focus",null,p$r._stageOnFocus),p$t.stage.off("visibilitychange",null,p$r._visibilityChange),(p$r._autoStopMusic=p$h)&&(p$t.stage.on("blur",null,p$r._stageOnBlur),p$t.stage.on("focus",null,p$r._stageOnFocus),p$t.stage.on("visibilitychange",null,p$r._visibilityChange))}),p$L(1,p$r,"muted",function(){return p$r._muted},function(p$h){p$h!=p$r._muted&&(p$h&&p$r.stopAllSound(),p$r.musicMuted=p$h,p$r._muted=p$h)}),p$L(1,p$r,"musicMuted",function(){return p$r._musicMuted},function(p$h){p$h!=p$r._musicMuted&&(p$h?(p$r._tMusic&&p$r._musicChannel&&!p$r._musicChannel.isStopped?p$r._musicChannel.pause():p$r._musicChannel=null,p$r._musicMuted=p$h):(p$r._musicMuted=p$h,p$r._tMusic&&p$r._musicChannel&&p$r._musicChannel.resume()))}),p$L(1,p$r,"soundMuted",function(){return p$r._soundMuted},function(p$h){p$r._soundMuted=p$h}),p$r.addChannel=function(p$h){0<=p$r._channels.indexOf(p$h)||(p$r._channels.push(p$h),p$r.autoReleaseSound&&0!=p$r._notUsedCount&&p$r._notUsedUrls[p$h.url]&&(delete p$r._notUsedUrls[p$h.url],0==--p$r._notUsedCount&&p$t.timer.clear(p$r,p$r.disposeSoundIfNotUsed)))},p$r.removeChannel=function(p$h){var p$q=p$r._channels,p$f=p$q.indexOf(p$h);if(-1!=p$f&&(p$q.splice(p$f,1),p$r.autoReleaseSound)){var p$g=p$h.url,p$$=p$r.defaultIntervals[p$g]||2e4;if(0<p$$){var p$P=!0;for(p$f=p$q.length-1;0<=p$f;p$f--)if(p$q[p$f].url==p$g){p$P=!1;break}p$P&&(p$r._notUsedUrls[p$g]=Date.now()+p$$,0==p$r._notUsedCount++&&p$t.timer.loop(1e4,p$r,p$r.disposeSoundIfNotUsed))}}},p$r.disposeSoundIfNotUsed=function(){var p$h=p$r._notUsedUrls;if(0!=p$r._notUsedCount){var p$q=Date.now();for(var p$f in p$h)p$q>=p$h[p$f]&&(delete p$h[p$f],--p$r._notUsedCount,p$r.destroySound(p$f));if(0!=p$r._notUsedCount)return}p$t.timer.clear(p$r,p$r.disposeSoundIfNotUsed)},p$r._visibilityChange=function(){p$t.stage.isVisibility?p$r._stageOnFocus():p$r._stageOnBlur()},p$r._stageOnBlur=function(){p$r._isActive=!1,p$r._musicChannel&&(p$r._musicChannel.isStopped||(p$r._blurPaused=!0,p$r._musicChannel.pause())),p$r.stopAllSound(),p$t.stage.once("mousedown",null,p$r._stageOnFocus)},p$r._recoverWebAudio=function(){p$Ph.ctx&&"running"!=p$Ph.ctx.state&&p$Ph.ctx.resume&&p$Ph.ctx.resume()},p$r._stageOnFocus=function(){if(p$r._isActive=!0,p$r._recoverWebAudio(),p$t.stage.off("mousedown",null,p$r._stageOnFocus),p$r._blurPaused){var p$h=p$r._musicChannel;p$h&&p$r._music&&p$h.isStopped&&(p$r._blurPaused=!1,p$r._music._disposed?p$r.playMusic(p$h.url,p$h.loops,p$h.startHandler,p$h.completeHandler,p$h.startTime):p$h.audioBuffer?p$h.resume():p$r._music.play(p$h.startTime,p$h.loops,p$h.startHandler,p$h))}},p$r.playSound=function(p$h,p$q,p$f,p$g,p$$,p$P){if(void 0===p$q&&(p$q=1),void 0===p$P&&(p$P=0),!p$h)return null;if(p$r._muted)return null;if(p$r._recoverWebAudio(),p$h==p$r._tMusic){if(p$r._musicMuted)return null}else{if(!p$r._isActive)return null;if(p$r._soundMuted)return null}var p$S,p$B=p$r._pool[p$h];return p$$||(p$$=p$r._soundClass),p$B||((p$B=new p$$).load(p$h),p$r._pool[p$h]=p$B),(p$S=p$B.play(p$P,p$q,p$f))?(p$h==p$r._tMusic&&(p$r._music=p$B,p$r._isActive||(p$r._blurPaused=!0,p$S.pause())),p$S.url=p$h,p$S.volume=p$h==p$r._tMusic?p$r.musicVolume:p$r.soundVolume,p$S.completeHandler=p$g,p$S):null},p$r.destroySound=function(p$h){var p$q=p$r._pool[p$h];p$q&&(delete p$r._pool[p$h],p$q.dispose())},p$r.playMusic=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$q&&(p$q=0),void 0===p$$&&(p$$=0),p$r._tMusic=p$h,p$r._musicChannel&&p$r._musicChannel.stop(),p$r._musicChannel=p$r.playSound(p$h,p$q,p$f,p$g,null,p$$)},p$r.stopSound=function(p$h){for(var p$q,p$f=p$r._channels.length-1;0<=p$f;p$f--)(p$q=p$r._channels[p$f]).url==p$h&&p$q.stop()},p$r.stopAll=function(){p$r._tMusic=null;var p$h=0;for(p$h=p$r._channels.length-1;0<=p$h;p$h--)p$r._channels[p$h].stop()},p$r.stopAllSound=function(){var p$h,p$q=0;for(p$q=p$r._channels.length-1;0<=p$q;p$q--)(p$h=p$r._channels[p$q]).url!=p$r._tMusic&&p$h.stop()},p$r.stopMusic=function(){p$r._musicChannel&&p$r._musicChannel.stop(),p$r._tMusic=null},p$r.setSoundVolume=function(p$h,p$q){if(p$q)p$r._setVolume(p$q,p$h);else{p$r.soundVolume=p$h;var p$f,p$g=0;for(p$g=p$r._channels.length-1;0<=p$g;p$g--)(p$f=p$r._channels[p$g]).url!=p$r._tMusic&&(p$f.volume=p$h)}},p$r.setMusicVolume=function(p$h){p$r.musicVolume=p$h,p$r._setVolume(p$r._tMusic,p$h)},p$r._setVolume=function(p$h,p$q){for(var p$f,p$g=p$r._channels.length-1;0<=p$g;p$g--)(p$f=p$r._channels[p$g]).url==p$h&&(p$f.volume=p$q)},p$r.musicVolume=1,p$r.soundVolume=1,p$r.playbackRate=1,p$r._useAudioMusic=!0,p$r._muted=!1,p$r._soundMuted=!1,p$r._musicMuted=!1,p$r._tMusic=null,p$r._musicChannel=null,p$r._music=null,p$r._channels=[],p$r._autoStopMusic=!1,p$r._blurPaused=!1,p$r._isActive=!0,p$r._soundClass=null,p$r._musicClass=null,p$r.autoReleaseSound=!0,p$r._pool={},p$r.defaultIntervals={},p$r._notUsedUrls={},p$r._notUsedCount=0,p$r}(),p$J=function(){var p$h;function p$f(){}return p$C(p$f,"laya.net.LocalStorage"),p$f.__init__=function(){p$f._baseClass||(p$f._baseClass=p$h).init(),p$f.items=p$f._baseClass.items,p$f.support=p$f._baseClass.support},p$f.setItem=function(p$h,p$q){p$f._baseClass.setItem(p$h,p$q)},p$f.getItem=function(p$h){return p$f._baseClass.getItem(p$h)},p$f.setJSON=function(p$h,p$q){p$f._baseClass.setJSON(p$h,p$q)},p$f.getJSON=function(p$h){return p$f._baseClass.getJSON(p$h)},p$f.removeItem=function(p$h){p$f._baseClass.removeItem(p$h)},p$f.clear=function(){p$f._baseClass.clear()},p$f._baseClass=null,p$f.items=null,p$f.support=!1,p$f.__init$=function(){p$h=function(){function p$f(){}return p$C(p$f,""),p$f.init=function(){try{p$f.support=!0,p$f.items=p$S.localStorage,p$f.setItem("laya","1"),p$f.removeItem("laya")}catch(p$h){p$f.support=!1}p$f.support||console.log("LocalStorage is not supprot or browser is private mode.")},p$f.setItem=function(p$h,p$q){try{p$f.support&&p$f.items.setItem(p$h,p$q)}catch(p$h){console.warn("set localStorage failed",p$h)}},p$f.getItem=function(p$h){return p$f.support?p$f.items.getItem(p$h):null},p$f.setJSON=function(p$h,p$q){try{p$f.support&&p$f.items.setItem(p$h,JSON.stringify(p$q))}catch(p$h){console.warn("set localStorage failed",p$h)}},p$f.getJSON=function(p$h){return JSON.parse(p$f.support?p$f.items.getItem(p$h):null)},p$f.removeItem=function(p$h){p$f.support&&p$f.items.removeItem(p$h)},p$f.clear=function(){p$f.support&&p$f.items.clear()},p$f.items=null,p$f.support=!1,p$f}()},p$f}(),p$i=(function(){function p$g(){}p$C(p$g,"laya.net.ResourceVersion"),p$g.enable=function(p$h,p$q,p$f){void 0===p$f&&(p$f=2),laya.net.ResourceVersion.type=p$f,p$t.loader.load(p$h,p$N.create(null,p$g.onManifestLoaded,[p$q]),null,"json"),p$z.customFormat=p$g.addVersionPrefix},p$g.onManifestLoaded=function(p$h,p$q){p$g.manifest=p$q,p$h.run(),p$q||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},p$g.addVersionPrefix=function(p$h){return p$g.manifest&&p$g.manifest[p$h]?2==p$g.type?p$g.manifest[p$h]:p$g.manifest[p$h]+"/"+p$h:p$h},p$g.FOLDER_VERSION=1,p$g.FILENAME_VERSION=2,p$g.manifest=null,p$g.type=1}(),function(){function p$h(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}p$C(p$h,"laya.net.TTFLoader");var p$q=p$h.prototype;return p$q.load=function(p$h){var p$q=(this._url=p$h).split(".ttf")[0].split("/");this.fontName=p$q[p$q.length-1],p$w.window.conch?this._loadConch():p$w.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},p$q._loadConch=function(){this._http=new p$Sh,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},p$q._onHttpLoaded=function(p$h){p$w.window.conch.setFontFaceFromBuffer(this.fontName,p$h),this._clearHttp(),this._complete()},p$q._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},p$q._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},p$q._complete=function(){p$t.timer.clear(this,this._complete),p$t.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},p$q._checkComplete=function(){p$d.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},p$q._loadWithFontFace=function(){var p$h=new p$w.window.FontFace(this.fontName,"url('"+this._url+"')");p$w.window.document.fonts.add(p$h);var p$q=this;p$h.loaded.then(function(){p$q._complete()}),p$h.load()},p$q._createDiv=function(){this._div=p$w.createElement("div"),this._div.innerHTML="laya";var p$h=this._div.style;p$h.fontFamily=this.fontName,p$h.position="absolute",p$h.left="-100px",p$h.top="-100px",p$w.document.body.appendChild(this._div)},p$q._loadWithCSS=function(){var p$h=this,p$q=p$w.createElement("style");p$q.type="text/css",p$w.document.body.appendChild(p$q),p$q.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=p$d.measureText("LayaTTFFont",this._fontTxt).width;var p$f=this;p$q.onload=function(){p$t.timer.once(1e4,p$f,p$h._complete)},p$t.timer.loop(20,this,this._checkComplete),this._createDiv()},p$h._testString="LayaTTFFont",p$h}()),p$z=function(){function p$g(p$h){this._url=null,this._path=null,this._url=p$g.formatURL(p$h),this._path=p$g.getPath(p$h)}p$C(p$g,"laya.net.URL");var p$h=p$g.prototype;return p$L(0,p$h,"path",function(){return this._path}),p$L(0,p$h,"url",function(){return this._url}),p$g.formatURL=function(p$h,p$q){if(!p$h)return"null path";if(0<p$h.indexOf(":"))return p$h;null!=p$g.customFormat&&(p$h=p$g.customFormat(p$h,p$q));var p$f=p$h.charAt(0);if("."===p$f)return p$g.formatRelativePath((p$q||p$g.basePath)+p$h);if("~"===p$f)return p$g.rootPath+p$h.substring(1);if("d"===p$f){if(0===p$h.indexOf("data:image"))return p$h}else if("/"===p$f)return p$h;return(p$q||p$g.basePath)+p$h},p$g.formatRelativePath=function(p$h){for(var p$q=p$h.split("/"),p$f=0,p$g=p$q.length;p$f<p$g;p$f++)".."==p$q[p$f]&&(p$q.splice(p$f-1,2),p$f-=2);return p$q.join("/")},p$g.isAbsolute=function(p$h){return 0<p$h.indexOf(":")||"/"==p$h.charAt(0)},p$g.getPath=function(p$h){var p$q=p$h.lastIndexOf("/");return 0<p$q?p$h.substr(0,p$q+1):""},p$g.getFileName=function(p$h){var p$q=p$h.lastIndexOf("/");return 0<p$q?p$h.substr(p$q+1):p$h},p$g.version={},p$g.basePath="",p$g.rootPath="",p$g.customFormat=function(p$h){var p$q=p$g.version[p$h];return!p$c.isConchApp&&p$q&&(p$h+="?v="+p$q),p$h},p$g}(),p$c=function(){function p$$(p$h,p$q){this._timeId=0;var p$f=p$$._mainCanvas.source.style;p$f.position="absolute",p$f.top=p$f.left="0px",p$f.background="#000000",p$$._mainCanvas.source.id="layaCanvas";var p$g=laya.renders.Render.isWebGL;p$$._mainCanvas.source.width=p$h,p$$._mainCanvas.source.height=p$q,p$g&&p$$.WebGL.init(p$$._mainCanvas,p$h,p$q),p$w.container.appendChild(p$$._mainCanvas.source),(p$$._context=new p$M(p$h,p$q,p$g?null:p$$._mainCanvas)).ctx.setIsMainContext(),p$w.window.requestAnimationFrame(function p$h(p$q){p$w.window.requestAnimationFrame(p$h);p$t.stage._loop()}),p$t.stage.on("visibilitychange",this,this._onVisibilitychange)}p$C(p$$,"laya.renders.Render");var p$h=p$$.prototype;return p$h._onVisibilitychange=function(){p$t.stage.isVisibility?0!=this._timeId&&p$w.window.clearInterval(this._timeId):this._timeId=p$w.window.setInterval(this._enterFrame,1e3)},p$h._enterFrame=function(p$h){p$t.stage._loop()},p$L(1,p$$,"context",function(){return p$$._context}),p$L(1,p$$,"canvas",function(){return p$$._mainCanvas.source}),p$$._context=null,p$$._mainCanvas=null,p$$.WebGL=null,p$$.isConchNode=!1,p$$.isConchApp=!1,p$$.isConchWebGL=!1,p$$.isWebGL=!1,p$$.is3DMode=!1,p$$.optimizeTextureMemory=function(p$h,p$q){return!0},p$$.__init$=function(){p$S.ConchRenderType=p$S.ConchRenderType||1,p$S.ConchRenderType|=p$S.conch?4:0,p$$.isConchNode=5==(5&p$S.ConchRenderType),p$$.isConchApp=4==(4&p$S.ConchRenderType),p$$.isConchWebGL=6==p$S.ConchRenderType},p$$}(),p$M=function(){function p$S(p$h,p$q,p$f){this.x=0,this.y=0,this._drawTexture=function(p$h,p$q,p$f){p$f[0].loaded&&this.ctx.drawTexture(p$f[0],p$f[1],p$f[2],p$f[3],p$f[4],p$h,p$q)},this._fillTexture=function(p$h,p$q,p$f){p$f[0].loaded&&this.ctx.fillTexture(p$f[0],p$f[1]+p$h,p$f[2]+p$q,p$f[3],p$f[4],p$f[5],p$f[6],p$f[7])},this._drawTextureWithTransform=function(p$h,p$q,p$f){p$f[0].loaded&&this.ctx.drawTextureWithTransform(p$f[0],p$f[1],p$f[2],p$f[3],p$f[4],p$f[5],p$h,p$q,p$f[6])},this._fillQuadrangle=function(p$h,p$q,p$f){this.ctx.fillQuadrangle(p$f[0],p$f[1],p$f[2],p$f[3],p$f[4])},this._drawRect=function(p$h,p$q,p$f){var p$g=this.ctx;null!=p$f[4]&&(p$g.fillStyle=p$f[4],p$g.fillRect(p$h+p$f[0],p$q+p$f[1],p$f[2],p$f[3],null)),null!=p$f[5]&&(p$g.strokeStyle=p$f[5],p$g.lineWidth=p$f[6],p$g.strokeRect(p$h+p$f[0],p$q+p$f[1],p$f[2],p$f[3],p$f[6]))},this._drawPie=function(p$h,p$q,p$f){var p$g=this.ctx;p$c.isWebGL&&p$g.setPathId(p$f[8]),p$g.beginPath(),p$c.isWebGL?(p$g.movePath(p$f[0]+p$h,p$f[1]+p$q),p$g.moveTo(0,0)):p$g.moveTo(p$h+p$f[0],p$q+p$f[1]),p$g.arc(p$h+p$f[0],p$q+p$f[1],p$f[2],p$f[3],p$f[4]),p$g.closePath(),this._fillAndStroke(p$f[5],p$f[6],p$f[7],!0)},this._clipRect=function(p$h,p$q,p$f){this.ctx.clipRect(p$h+p$f[0],p$q+p$f[1],p$f[2],p$f[3])},this._fillRect=function(p$h,p$q,p$f){this.ctx.fillRect(p$h+p$f[0],p$q+p$f[1],p$f[2],p$f[3],p$f[4])},this._drawCircle=function(p$h,p$q,p$f){var p$g=this.ctx;p$c.isWebGL&&p$g.setPathId(p$f[6]),p$Z.drawCall++,p$g.beginPath(),p$c.isWebGL&&p$g.movePath(p$f[0]+p$h,p$f[1]+p$q),p$g.arc(p$f[0]+p$h,p$f[1]+p$q,p$f[2],0,p$S.PI2),p$g.closePath(),this._fillAndStroke(p$f[3],p$f[4],p$f[5],!0)},this._fillCircle=function(p$h,p$q,p$f){p$Z.drawCall++;var p$g=this.ctx;p$g.beginPath(),p$g.fillStyle=p$f[3],p$g.arc(p$f[0]+p$h,p$f[1]+p$q,p$f[2],0,p$S.PI2),p$g.fill()},this._setShader=function(p$h,p$q,p$f){this.ctx.setShader(p$f[0])},this._drawLine=function(p$h,p$q,p$f){var p$g=this.ctx;p$c.isWebGL&&p$g.setPathId(p$f[6]),p$g.beginPath(),p$g.strokeStyle=p$f[4],p$g.lineWidth=p$f[5],p$c.isWebGL?(p$g.movePath(p$h,p$q),p$g.moveTo(p$f[0],p$f[1]),p$g.lineTo(p$f[2],p$f[3])):(p$g.moveTo(p$h+p$f[0],p$q+p$f[1]),p$g.lineTo(p$h+p$f[2],p$q+p$f[3])),p$g.stroke()},this._drawLines=function(p$h,p$q,p$f){var p$g=this.ctx;p$c.isWebGL&&p$g.setPathId(p$f[5]),p$g.beginPath(),p$h+=p$f[0],p$q+=p$f[1],p$c.isWebGL&&p$g.movePath(p$h,p$q),p$g.strokeStyle=p$f[3],p$g.lineWidth=p$f[4];var p$$=p$f[2],p$P=2,p$S=p$$.length;if(p$c.isWebGL)for(p$g.moveTo(p$$[0],p$$[1]);p$P<p$S;)p$g.lineTo(p$$[p$P++],p$$[p$P++]);else for(p$g.moveTo(p$h+p$$[0],p$q+p$$[1]);p$P<p$S;)p$g.lineTo(p$h+p$$[p$P++],p$q+p$$[p$P++]);p$g.stroke()},this._drawLinesWebGL=function(p$h,p$q,p$f){this.ctx.drawLines(p$h+this.x+p$f[0],p$q+this.y+p$f[1],p$f[2],p$f[3],p$f[4])},this._drawCurves=function(p$h,p$q,p$f){this.ctx.drawCurves(p$h,p$q,p$f)},this._draw=function(p$h,p$q,p$f){p$f[0].call(null,this,p$h,p$q)},this._transformByMatrix=function(p$h,p$q,p$f){this.ctx.transformByMatrix(p$f[0])},this._setTransform=function(p$h,p$q,p$f){this.ctx.setTransform(p$f[0],p$f[1],p$f[2],p$f[3],p$f[4],p$f[5])},this._setTransformByMatrix=function(p$h,p$q,p$f){this.ctx.setTransformByMatrix(p$f[0])},this._save=function(p$h,p$q,p$f){this.ctx.save()},this._restore=function(p$h,p$q,p$f){this.ctx.restore()},this._translate=function(p$h,p$q,p$f){this.ctx.translate(p$f[0],p$f[1])},this._transform=function(p$h,p$q,p$f){this.ctx.translate(p$f[1]+p$h,p$f[2]+p$q);var p$g=p$f[0];this.ctx.transform(p$g.a,p$g.b,p$g.c,p$g.d,p$g.tx,p$g.ty),this.ctx.translate(-p$h-p$f[1],-p$q-p$f[2])},this._rotate=function(p$h,p$q,p$f){this.ctx.translate(p$f[1]+p$h,p$f[2]+p$q),this.ctx.rotate(p$f[0]),this.ctx.translate(-p$h-p$f[1],-p$q-p$f[2])},this._scale=function(p$h,p$q,p$f){this.ctx.translate(p$f[2]+p$h,p$f[3]+p$q),this.ctx.scale(p$f[0],p$f[1]),this.ctx.translate(-p$h-p$f[2],-p$q-p$f[3])},this._alpha=function(p$h,p$q,p$f){this.ctx.globalAlpha*=p$f[0]},this._setAlpha=function(p$h,p$q,p$f){this.ctx.globalAlpha=p$f[0]},this._fillText=function(p$h,p$q,p$f){this.ctx.fillText(p$f[0],p$f[1]+p$h,p$f[2]+p$q,p$f[3],p$f[4],p$f[5])},this._strokeText=function(p$h,p$q,p$f){this.ctx.strokeText(p$f[0],p$f[1]+p$h,p$f[2]+p$q,p$f[3],p$f[4],p$f[5],p$f[6])},this._fillBorderText=function(p$h,p$q,p$f){this.ctx.fillBorderText(p$f[0],p$f[1]+p$h,p$f[2]+p$q,p$f[3],p$f[4],p$f[5],p$f[6],p$f[7])},this._blendMode=function(p$h,p$q,p$f){this.ctx.globalCompositeOperation=p$f[0]},this._beginClip=function(p$h,p$q,p$f){this.ctx.beginClip&&this.ctx.beginClip(p$h+p$f[0],p$q+p$f[1],p$f[2],p$f[3])},this._setIBVB=function(p$h,p$q,p$f){this.ctx.setIBVB(p$f[0]+p$h,p$f[1]+p$q,p$f[2],p$f[3],p$f[4],p$f[5],p$f[6],p$f[7])},this._fillTrangles=function(p$h,p$q,p$f){this.ctx.fillTrangles(p$f[0],p$f[1]+p$h,p$f[2]+p$q,p$f[3],p$f[4])},this._drawPath=function(p$h,p$q,p$f){var p$g=this.ctx;p$c.isWebGL&&p$g.setPathId(-1),p$g.beginPath(),p$h+=p$f[0],p$q+=p$f[1],p$c.isWebGL&&p$g.movePath(p$h,p$q);for(var p$$=p$f[2],p$P=0,p$S=p$$.length;p$P<p$S;p$P++){var p$B=p$$[p$P];switch(p$B[0]){case"moveTo":p$c.isWebGL?p$g.moveTo(p$B[1],p$B[2]):p$g.moveTo(p$h+p$B[1],p$q+p$B[2]);break;case"lineTo":p$c.isWebGL?p$g.lineTo(p$B[1],p$B[2]):p$g.lineTo(p$h+p$B[1],p$q+p$B[2]);break;case"arcTo":p$c.isWebGL?p$g.arcTo(p$B[1],p$B[2],p$B[3],p$B[4],p$B[5]):p$g.arcTo(p$h+p$B[1],p$q+p$B[2],p$h+p$B[3],p$q+p$B[4],p$B[5]);break;case"closePath":p$g.closePath()}}var p$r=p$f[3];null!=p$r&&(p$g.fillStyle=p$r.fillStyle,p$g.fill());var p$Y=p$f[4];null!=p$Y&&(p$g.strokeStyle=p$Y.strokeStyle,p$g.lineWidth=p$Y.lineWidth||1,p$g.lineJoin=p$Y.lineJoin,p$g.lineCap=p$Y.lineCap,p$g.miterLimit=p$Y.miterLimit,p$g.stroke())},this.drawPoly=function(p$h,p$q,p$f){this.ctx.drawPoly(p$h+this.x+p$f[0],p$q+this.y+p$f[1],p$f[2],p$f[3],p$f[4],p$f[5],p$f[6])},this._drawPoly=function(p$h,p$q,p$f){var p$g=this.ctx,p$$=p$f[2],p$P=2,p$S=p$$.length;if(p$c.isWebGL)for(p$g.setPathId(p$f[6]),p$g.beginPath(),p$h+=p$f[0],p$q+=p$f[1],p$g.movePath(p$h,p$q),p$g.moveTo(p$$[0],p$$[1]);p$P<p$S;)p$g.lineTo(p$$[p$P++],p$$[p$P++]);else for(p$g.beginPath(),p$h+=p$f[0],p$q+=p$f[1],p$g.moveTo(p$h+p$$[0],p$q+p$$[1]);p$P<p$S;)p$g.lineTo(p$h+p$$[p$P++],p$q+p$$[p$P++]);p$g.closePath(),this._fillAndStroke(p$f[3],p$f[4],p$f[5],p$f[7])},this._drawSkin=function(p$h,p$q,p$f){var p$g=p$f[0];if(p$g){var p$$=this.ctx;p$g.render(p$$,p$h,p$q)}},this._drawParticle=function(p$h,p$q,p$f){this.ctx.drawParticle(p$h+this.x,p$q+this.y,p$f[0])},this._setFilters=function(p$h,p$q,p$f){this.ctx.setFilters(p$f)},p$f?this.ctx=p$f.getContext("2d"):(p$f=p$Gh.create("3D"),this.ctx=p$d.createWebGLContext2D(p$f),p$f._setContext(this.ctx)),p$f.size(p$h,p$q),this.canvas=p$f}p$C(p$S,"laya.renders.RenderContext");var p$h=p$S.prototype;return p$h.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},p$h.drawTexture=function(p$h,p$q,p$f,p$g,p$$){p$h.loaded&&this.ctx.drawTexture(p$h,p$q,p$f,p$g,p$$,this.x,this.y)},p$h._drawTextures=function(p$h,p$q,p$f){p$f[0].loaded&&this.ctx.drawTextures(p$f[0],p$f[1],p$h+this.x,p$q+this.y)},p$h.drawTextureWithTransform=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$h.loaded&&this.ctx.drawTextureWithTransform(p$h,p$q,p$f,p$g,p$$,p$P,this.x,this.y,p$S)},p$h.fillQuadrangle=function(p$h,p$q,p$f,p$g,p$$){this.ctx.fillQuadrangle(p$h,p$q,p$f,p$g,p$$)},p$h.drawCanvas=function(p$h,p$q,p$f,p$g,p$$){this.ctx.drawCanvas(p$h,p$q+this.x,p$f+this.y,p$g,p$$)},p$h.drawRect=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$P&&(p$P=1);var p$S=this.ctx;p$S.strokeStyle=p$$,p$S.lineWidth=p$P,p$S.strokeRect(p$h+this.x,p$q+this.y,p$f,p$g,p$P)},p$h._fillAndStroke=function(p$h,p$q,p$f,p$g){void 0===p$g&&(p$g=!1);var p$$=this.ctx;null!=p$h&&(p$$.fillStyle=p$h,p$c.isWebGL?p$$.fill(p$g):p$$.fill()),null!=p$q&&0<p$f&&(p$$.strokeStyle=p$q,p$$.lineWidth=p$f,p$$.stroke())},p$h.clipRect=function(p$h,p$q,p$f,p$g){this.ctx.clipRect(p$h+this.x,p$q+this.y,p$f,p$g)},p$h.fillRect=function(p$h,p$q,p$f,p$g,p$$){this.ctx.fillRect(p$h+this.x,p$q+this.y,p$f,p$g,p$$)},p$h.drawCircle=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=1),p$Z.drawCall++;var p$P=this.ctx;p$P.beginPath(),p$P.strokeStyle=p$g,p$P.lineWidth=p$$,p$P.arc(p$h+this.x,p$q+this.y,p$f,0,p$S.PI2),p$P.stroke()},p$h.drawTriangles=function(p$h,p$q,p$f){if(p$c.isWebGL)this.ctx.drawTriangles(p$f[0],p$h+p$f[1],p$q+p$f[2],p$f[3],p$f[4],p$f[5],p$f[6],p$f[7],p$f[8],p$f[9]);else{var p$g=p$f[5],p$$=0,p$P=p$g.length,p$S=this.ctx;for(p$$=0;p$$<p$P;p$$+=3){var p$B=2*p$g[p$$],p$r=2*p$g[p$$+1],p$Y=2*p$g[p$$+2];p$S.drawTriangle(p$f[0],p$f[3],p$f[4],p$B,p$r,p$Y,p$f[6],!0)}}},p$h.fillCircle=function(p$h,p$q,p$f,p$g){p$Z.drawCall++;var p$$=this.ctx;p$$.beginPath(),p$$.fillStyle=p$g,p$$.arc(p$h+this.x,p$q+this.y,p$f,0,p$S.PI2),p$$.fill()},p$h.setShader=function(p$h){this.ctx.setShader(p$h)},p$h.drawLine=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$P&&(p$P=1);var p$S=this.ctx;p$S.beginPath(),p$S.strokeStyle=p$$,p$S.lineWidth=p$P,p$S.moveTo(this.x+p$h,this.y+p$q),p$S.lineTo(this.x+p$f,this.y+p$g),p$S.stroke()},p$h.clear=function(){this.ctx.clear()},p$h.transformByMatrix=function(p$h){this.ctx.transformByMatrix(p$h)},p$h.setTransform=function(p$h,p$q,p$f,p$g,p$$,p$P){this.ctx.setTransform(p$h,p$q,p$f,p$g,p$$,p$P)},p$h.setTransformByMatrix=function(p$h){this.ctx.setTransformByMatrix(p$h)},p$h.save=function(){this.ctx.save()},p$h.restore=function(){this.ctx.restore()},p$h.translate=function(p$h,p$q){this.ctx.translate(p$h,p$q)},p$h.transform=function(p$h,p$q,p$f,p$g,p$$,p$P){this.ctx.transform(p$h,p$q,p$f,p$g,p$$,p$P)},p$h.rotate=function(p$h){this.ctx.rotate(p$h)},p$h.scale=function(p$h,p$q){this.ctx.scale(p$h,p$q)},p$h.alpha=function(p$h){this.ctx.globalAlpha*=p$h},p$h.setAlpha=function(p$h){this.ctx.globalAlpha=p$h},p$h.fillWords=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$P&&(p$P=0),this.ctx.fillWords(p$h,p$q,p$f,p$g,p$$,p$P)},p$h.fillBorderWords=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this.ctx.fillBorderWords(p$h,p$q,p$f,p$g,p$$,p$P,p$S)},p$h.fillText=function(p$h,p$q,p$f,p$g,p$$,p$P){this.ctx.fillText(p$h,p$q+this.x,p$f+this.y,p$g,p$$,p$P)},p$h.strokeText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this.ctx.strokeText(p$h,p$q+this.x,p$f+this.y,p$g,p$$,p$P,p$S)},p$h.blendMode=function(p$h){this.ctx.globalCompositeOperation=p$h},p$h.flush=function(){this.ctx.flush&&this.ctx.flush()},p$h.addRenderObject=function(p$h){this.ctx.addRenderObject(p$h)},p$h.beginClip=function(p$h,p$q,p$f,p$g){this.ctx.beginClip&&this.ctx.beginClip(p$h,p$q,p$f,p$g)},p$h.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},p$h.fillTrangles=function(p$h,p$q,p$f){this.ctx.fillTrangles(p$f[0],p$f[1],p$f[2],p$f[3],4<p$f.length?p$f[4]:null)},p$S.PI2=2*Math.PI,p$S}(),p$W=function(){function p$S(p$h,p$q){switch(this._next=p$q||p$S.NORENDER,p$h){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=p$_._filter);case 69905:return void(this._fun=p$S._initRenderFun)}this.onCreate(p$h)}p$C(p$S,"laya.renders.RenderSprite");var p$h=p$S.prototype;return p$h.onCreate=function(p$h){},p$h._style=function(p$h,p$q,p$f,p$g){p$h._style.render(p$h,p$q,p$f,p$g);var p$$=this._next;p$$._fun.call(p$$,p$h,p$q,p$f,p$g)},p$h._no=function(p$h,p$q,p$f,p$g){},p$h._custom=function(p$h,p$q,p$f,p$g){p$h.customRender(p$q,p$f,p$g);var p$$=p$h._style._tf;this._next._fun.call(this._next,p$h,p$q,p$f-p$$.translateX,p$g-p$$.translateY)},p$h._clip=function(p$h,p$q,p$f,p$g){var p$$=this._next;if(p$$!=p$S.NORENDER){var p$P=p$h._style.scrollRect;p$q.ctx.save(),p$q.ctx.clipRect(p$f,p$g,p$P.width,p$P.height),p$$._fun.call(p$$,p$h,p$q,p$f-p$P.x,p$g-p$P.y),p$q.ctx.restore()}},p$h._blend=function(p$h,p$q,p$f,p$g){var p$$=p$h._style;p$$.blendMode&&(p$q.ctx.globalCompositeOperation=p$$.blendMode);var p$P=this._next;p$P._fun.call(p$P,p$h,p$q,p$f,p$g),p$q.ctx.globalCompositeOperation="source-over"},p$h._mask=function(p$h,p$q,p$f,p$g){var p$$=this._next;p$$._fun.call(p$$,p$h,p$q,p$f,p$g);var p$P=p$h.mask;p$P&&(p$q.ctx.globalCompositeOperation="destination-in",(0<p$P.numChildren||!p$P.graphics._isOnlyOne())&&(p$P.cacheAsBitmap=!0),p$P.render(p$q,p$f-p$h.pivotX,p$g-p$h.pivotY)),p$q.ctx.globalCompositeOperation="source-over"},p$h._graphics=function(p$h,p$q,p$f,p$g){var p$$=p$h._style._tf;p$h._graphics&&p$h._graphics._render(p$h,p$q,p$f-p$$.translateX,p$g-p$$.translateY);var p$P=this._next;p$P._fun.call(p$P,p$h,p$q,p$f,p$g)},p$h._image=function(p$h,p$q,p$f,p$g){var p$$=p$h._style;p$q.ctx.drawTexture2(p$f,p$g,p$$._tf.translateX,p$$._tf.translateY,p$h.transform,p$$.alpha,p$$.blendMode,p$h._graphics._one)},p$h._image2=function(p$h,p$q,p$f,p$g){var p$$=p$h._style._tf;p$q.ctx.drawTexture2(p$f,p$g,p$$.translateX,p$$.translateY,p$h.transform,1,null,p$h._graphics._one)},p$h._alpha=function(p$h,p$q,p$f,p$g){var p$$;if(.01<(p$$=p$h._style.alpha)||p$h._needRepaint()){var p$P=p$q.ctx.globalAlpha;p$q.ctx.globalAlpha*=p$$;var p$S=this._next;p$S._fun.call(p$S,p$h,p$q,p$f,p$g),p$q.ctx.globalAlpha=p$P}},p$h._transform=function(p$h,p$q,p$f,p$g){var p$$=p$h.transform,p$P=this._next;p$$&&p$P!=p$S.NORENDER?(p$q.save(),p$q.transform(p$$.a,p$$.b,p$$.c,p$$.d,p$$.tx+p$f,p$$.ty+p$g),p$P._fun.call(p$P,p$h,p$q,0,0),p$q.restore()):p$P._fun.call(p$P,p$h,p$q,p$f,p$g)},p$h._childs=function(p$h,p$q,p$f,p$g){var p$$=p$h._style,p$P=p$$._tf;if(p$f=p$f-p$P.translateX+p$$.paddingLeft,p$g=p$g-p$P.translateY+p$$.paddingTop,p$$._calculation){var p$S=p$h._getWords();if(p$S){var p$B=p$$;p$B&&(p$B.stroke?p$q.fillBorderWords(p$S,p$f,p$g,p$B.font,p$B.color,p$B.strokeColor,p$B.stroke):p$q.fillWords(p$S,p$f,p$g,p$B.font,p$B.color,"none"!=p$B.textDecoration&&p$B.underLine?1:0))}}var p$r,p$Y=p$h._childs,p$C=p$Y.length;if(p$h.viewport||p$h.optimizeScrollRect&&p$h._style.scrollRect){var p$U=p$h.viewport||p$h._style.scrollRect,p$u=p$U.x,p$v=p$U.y,p$L=p$U.right,p$e=p$U.bottom,p$l=NaN,p$_=NaN;for(p$N=0;p$N<p$C;++p$N)(p$r=p$Y[p$N]).visible&&(p$l=p$r._x)<p$L&&p$l+p$r.width>p$u&&(p$_=p$r._y)<p$e&&p$_+p$r.height>p$v&&p$r.render(p$q,p$f,p$g)}else for(var p$N=0;p$N<p$C;++p$N)(p$r=p$Y[p$N])._style.visible&&p$r.render(p$q,p$f,p$g)},p$h._canvas=function(p$h,p$q,p$f,p$g){var p$$=p$h._$P.cacheCanvas;if(p$$){"bitmap"===p$$.type?p$Z.canvasBitmap++:p$Z.canvasNormal++;var p$P=p$$.ctx;if(p$h._needRepaint()||!p$P)this._canvas_repaint(p$h,p$q,p$f,p$g);else{var p$S=p$$._cacheRec;p$q.drawCanvas(p$P.canvas,p$f+p$S.x,p$g+p$S.y,p$S.width,p$S.height)}}else this._next._fun.call(this._next,p$h,p$q,p$f,p$g)},p$h._canvas_repaint=function(p$h,p$q,p$f,p$g){var p$$=p$h._$P.cacheCanvas,p$P=this._next;if(p$$){var p$S,p$B,p$r,p$Y,p$C=p$$.ctx,p$U=p$h._needRepaint()||!p$C,p$u=p$$.type;if("bitmap"===p$u?p$Z.canvasBitmap++:p$Z.canvasNormal++,p$U){var p$v,p$L;p$$._cacheRec||(p$$._cacheRec=new p$n),p$c.isWebGL&&"bitmap"!==p$u?p$$._cacheRec.setTo(-p$h.pivotX,-p$h.pivotY,1,1):((p$Y=p$h.getSelfBounds()).x=p$Y.x-p$h.pivotX,p$Y.y=p$Y.y-p$h.pivotY,p$Y.x=p$Y.x-16,p$Y.y=p$Y.y-16,p$Y.width=p$Y.width+32,p$Y.height=p$Y.height+32,p$Y.x=Math.floor(p$Y.x+p$f)-p$f,p$Y.y=Math.floor(p$Y.y+p$g)-p$g,p$Y.width=Math.floor(p$Y.width),p$Y.height=Math.floor(p$Y.height),p$$._cacheRec.copyFrom(p$Y)),p$Y=p$$._cacheRec;var p$e,p$l=p$c.isWebGL?1:p$w.pixelRatio*p$t.stage.clientScaleX,p$_=p$c.isWebGL?1:p$w.pixelRatio*p$t.stage.clientScaleY;if(!p$c.isWebGL){var p$N,p$G=1,p$m=1;for(p$N=p$h;p$N&&p$N!=p$t.stage;)p$G*=p$N.scaleX,p$m*=p$N.scaleY,p$N=p$N.parent;p$c.isWebGL?(p$G<1&&(p$l*=p$G),p$m<1&&(p$_*=p$m)):(1<p$G&&(p$l*=p$G),1<p$m&&(p$_*=p$m))}if(p$h.scrollRect){var p$E=p$h.scrollRect;p$Y.x-=p$E.x,p$Y.y-=p$E.y}if(p$v=p$Y.width*p$l,p$L=p$Y.height*p$_,p$B=p$Y.x,p$r=p$Y.y,p$c.isWebGL&&"bitmap"===p$u&&(2048<p$v||2048<p$L))return console.warn("cache bitmap size larger than 2048,cache ignored"),p$$.ctx&&(p$F.recover("RenderContext",p$$.ctx),p$$.ctx.canvas.size(0,0),p$$.ctx=null),void p$P._fun.call(p$P,p$h,p$q,p$f,p$g);if(p$C||(p$C=p$$.ctx=p$F.getItem("RenderContext")||new p$M(p$v,p$L,p$Gh.create("AUTO"))),p$C.ctx.sprite=p$h,(p$S=p$C.canvas).clear(),(p$S.width!=p$v||p$S.height!=p$L)&&p$S.size(p$v,p$L),"bitmap"===p$u?p$S.context.asBitmap=!0:"normal"===p$u&&(p$S.context.asBitmap=!1),1!=p$l||1!=p$_){var p$R=p$C.ctx;p$R.save(),p$R.scale(p$l,p$_),!p$c.isConchWebGL&&p$c.isConchApp&&(p$e=p$h._$P.cf)&&p$R.setFilterMatrix&&p$R.setFilterMatrix(p$e._mat,p$e._alpha),p$P._fun.call(p$P,p$h,p$C,-p$B,-p$r),p$R.restore(),p$c.isConchApp&&!p$c.isConchWebGL||p$h._applyFilters()}else p$R=p$C.ctx,!p$c.isConchWebGL&&p$c.isConchApp&&(p$e=p$h._$P.cf)&&p$R.setFilterMatrix&&p$R.setFilterMatrix(p$e._mat,p$e._alpha),p$P._fun.call(p$P,p$h,p$C,-p$B,-p$r),p$c.isConchApp&&!p$c.isConchWebGL||p$h._applyFilters();p$h._$P.staticCache&&(p$$.reCache=!1),p$Z.canvasReCache++}else p$B=(p$Y=p$$._cacheRec).x,p$r=p$Y.y,p$S=p$C.canvas;p$q.drawCanvas(p$S,p$f+p$B,p$g+p$r,p$Y.width,p$Y.height)}else p$P._fun.call(p$P,p$h,p$C,p$f,p$g)},p$S.__init__=function(){var p$h,p$q,p$f=0;for(p$q=p$d.createRenderSprite(69905,null),p$h=p$S.renders.length=4096,p$f=0;p$f<p$h;p$f++)p$S.renders[p$f]=p$q;p$S.renders[0]=p$d.createRenderSprite(0,null),function(p$h,p$q){for(var p$f=0,p$g=0;p$g<p$h.length;p$g++)p$f|=p$h[p$g],p$S.renders[p$f]=p$q}([1,512,4,2],new p$S(1,null)),p$S.renders[513]=p$d.createRenderSprite(513,null),p$S.renders[517]=new p$S(517,null)},p$S._initRenderFun=function(p$h,p$q,p$f,p$g){var p$$=p$h._renderType;(p$S.renders[p$$]=p$S._getTypeRender(p$$))._fun(p$h,p$q,p$f,p$g)},p$S._getTypeRender=function(p$h){for(var p$q=null,p$f=2048;1<p$f;)p$f&p$h&&(p$q=p$d.createRenderSprite(p$f,p$q)),p$f>>=1;return p$q},p$S.IMAGE=1,p$S.ALPHA=2,p$S.TRANSFORM=4,p$S.BLEND=8,p$S.CANVAS=16,p$S.FILTERS=32,p$S.MASK=64,p$S.CLIP=128,p$S.STYLE=256,p$S.GRAPHICS=512,p$S.CUSTOM=1024,p$S.CHILDS=2048,p$S.INIT=69905,p$S.renders=[],p$S.NORENDER=new p$S(0,null),p$S}(),p$T=function(){function p$B(){this._repaint=!1}p$C(p$B,"laya.resource.Context");var p$h=p$B.prototype;return p$h.replaceReset=function(){var p$h,p$q,p$f=0;for(p$h=p$B.replaceKeys.length,p$f=0;p$f<p$h;p$f++)p$q=p$B.replaceKeys[p$f],this[p$B.newKeys[p$f]]=this[p$q]},p$h.replaceResotre=function(){this.__restore(),this.__reset()},p$h.setIsMainContext=function(){},p$h.drawTextures=function(p$h,p$q,p$f,p$g){p$Z.drawCall+=p$q.length/2;for(var p$$=p$h.width,p$P=p$h.height,p$S=0,p$B=p$q.length;p$S<p$B;p$S+=2)this.drawTexture(p$h,p$q[p$S],p$q[p$S+1],p$$,p$P,p$f,p$g)},p$h.drawCanvas=function(p$h,p$q,p$f,p$g,p$$){p$Z.drawCall++,this.drawImage(p$h.source,p$q,p$f,p$g,p$$)},p$h.fillRect=function(p$h,p$q,p$f,p$g,p$$){p$Z.drawCall++,p$$&&(this.fillStyle=p$$),this.__fillRect(p$h,p$q,p$f,p$g)},p$h.fillText=function(p$h,p$q,p$f,p$g,p$$,p$P){p$Z.drawCall++,3<arguments.length&&null!=p$g&&(this.font=p$g,this.fillStyle=p$$,this.textAlign=p$P,this.textBaseline="top"),this.__fillText(p$h,p$q,p$f)},p$h.fillBorderText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){p$Z.drawCall++,this.font=p$g,this.fillStyle=p$$,this.textBaseline="top",this.strokeStyle=p$P,this.lineWidth=p$S,this.textAlign=p$B,this.__strokeText(p$h,p$q,p$f),this.__fillText(p$h,p$q,p$f)},p$h.strokeText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$Z.drawCall++,3<arguments.length&&null!=p$g&&(this.font=p$g,this.strokeStyle=p$$,this.lineWidth=p$P,this.textAlign=p$S,this.textBaseline="top"),this.__strokeText(p$h,p$q,p$f)},p$h.transformByMatrix=function(p$h){this.transform(p$h.a,p$h.b,p$h.c,p$h.d,p$h.tx,p$h.ty)},p$h.setTransformByMatrix=function(p$h){this.setTransform(p$h.a,p$h.b,p$h.c,p$h.d,p$h.tx,p$h.ty)},p$h.clipRect=function(p$h,p$q,p$f,p$g){p$Z.drawCall++,this.beginPath(),this.rect(p$h,p$q,p$f,p$g),this.clip()},p$h.drawTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$Z.drawCall++;var p$B=p$h.uv,p$r=p$h.bitmap.width,p$Y=p$h.bitmap.height;this.drawImage(p$h.source,p$B[0]*p$r,p$B[1]*p$Y,(p$B[2]-p$B[0])*p$r,(p$B[5]-p$B[3])*p$Y,p$q+p$P,p$f+p$S,p$g,p$$)},p$h.drawTextureWithTransform=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){p$Z.drawCall++;var p$Y=p$h.uv,p$C=p$h.bitmap.width,p$U=p$h.bitmap.height;this.save(),1!=p$r&&(this.globalAlpha*=p$r),p$P?(this.transform(p$P.a,p$P.b,p$P.c,p$P.d,p$P.tx+p$S,p$P.ty+p$B),this.drawImage(p$h.source,p$Y[0]*p$C,p$Y[1]*p$U,(p$Y[2]-p$Y[0])*p$C,(p$Y[5]-p$Y[3])*p$U,p$q,p$f,p$g,p$$)):this.drawImage(p$h.source,p$Y[0]*p$C,p$Y[1]*p$U,(p$Y[2]-p$Y[0])*p$C,(p$Y[5]-p$Y[3])*p$U,p$q+p$S,p$f+p$B,p$g,p$$),this.restore()},p$h.drawTexture2=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){var p$r=p$B[0];if(p$r.loaded&&p$r.bitmap&&p$r.source){p$Z.drawCall++;var p$Y=1!==p$P;if(p$Y){var p$C=this.globalAlpha;this.globalAlpha*=p$P}var p$U=p$r.uv,p$u=p$r.bitmap.width,p$v=p$r.bitmap.height;p$$?(this.save(),this.transform(p$$.a,p$$.b,p$$.c,p$$.d,p$$.tx+p$h,p$$.ty+p$q),this.drawImage(p$r.source,p$U[0]*p$u,p$U[1]*p$v,(p$U[2]-p$U[0])*p$u,(p$U[5]-p$U[3])*p$v,p$B[1]-p$f,p$B[2]-p$g,p$B[3],p$B[4]),this.restore()):this.drawImage(p$r.source,p$U[0]*p$u,p$U[1]*p$v,(p$U[2]-p$U[0])*p$u,(p$U[5]-p$U[3])*p$v,p$B[1]-p$f+p$h,p$B[2]-p$g+p$q,p$B[3],p$B[4]),p$Y&&(this.globalAlpha=p$C)}},p$h.fillTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){if(!p$B.pat){if(p$h.uv!=p$Ch.DEF_UV){var p$r=new p$Gh("2D");p$r.getContext("2d"),p$r.size(p$h.width,p$h.height),p$r.context.drawTexture(p$h,0,0,p$h.width,p$h.height,0,0),p$h=new p$Ch(p$r)}p$B.pat=this.createPattern(p$h.bitmap.source,p$P)}var p$Y=p$q,p$C=p$f,p$U=0,p$u=0;p$S&&(p$Y+=p$S.x%p$h.width,p$C+=p$S.y%p$h.height,p$U-=p$S.x%p$h.width,p$u-=p$S.y%p$h.height),this.translate(p$Y,p$C),this.fillRect(p$U,p$u,p$g,p$$,p$B.pat),this.translate(-p$Y,-p$C)},p$h.drawTriangle=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){var p$r=p$h.bitmap,p$Y=p$r.source,p$C=p$h.width,p$U=p$h.height,p$u=p$r.width,p$v=p$r.height,p$L=p$f[p$g]*p$u,p$e=p$f[p$$]*p$u,p$l=p$f[p$P]*p$u,p$_=p$f[p$g+1]*p$v,p$N=p$f[p$$+1]*p$v,p$G=p$f[p$P+1]*p$v,p$m=p$q[p$g],p$E=p$q[p$$],p$R=p$q[p$P],p$t=p$q[p$g+1],p$X=p$q[p$$+1],p$n=p$q[p$P+1];if(p$B){var p$J=(p$m+p$E+p$R)/3,p$p=(p$t+p$X+p$n)/3,p$A=p$m-p$J,p$d=p$t-p$p,p$b=Math.sqrt(p$A*p$A+p$d*p$d);p$m=p$J+p$A/p$b*(p$b+1),p$t=p$p+p$d/p$b*(p$b+1),p$d=p$X-p$p,p$E=p$J+(p$A=p$E-p$J)/(p$b=Math.sqrt(p$A*p$A+p$d*p$d))*(p$b+1),p$X=p$p+p$d/p$b*(p$b+1),p$d=p$n-p$p,p$R=p$J+(p$A=p$R-p$J)/(p$b=Math.sqrt(p$A*p$A+p$d*p$d))*(p$b+1),p$n=p$p+p$d/p$b*(p$b+1)}this.save(),p$S&&this.transform(p$S.a,p$S.b,p$S.c,p$S.d,p$S.tx,p$S.ty),this.beginPath(),this.moveTo(p$m,p$t),this.lineTo(p$E,p$X),this.lineTo(p$R,p$n),this.closePath(),this.clip();var p$i=1/(p$L*p$N+p$_*p$l+p$e*p$G-p$N*p$l-p$_*p$e-p$L*p$G),p$z=p$m*p$N+p$_*p$R+p$E*p$G-p$N*p$R-p$_*p$E-p$m*p$G,p$c=p$L*p$E+p$m*p$l+p$e*p$R-p$E*p$l-p$m*p$e-p$L*p$R,p$M=p$L*p$N*p$R+p$_*p$E*p$l+p$m*p$e*p$G-p$m*p$N*p$l-p$_*p$e*p$R-p$L*p$E*p$G,p$W=p$t*p$N+p$_*p$n+p$X*p$G-p$N*p$n-p$_*p$X-p$t*p$G,p$T=p$L*p$X+p$t*p$l+p$e*p$n-p$X*p$l-p$t*p$e-p$L*p$n,p$I=p$L*p$N*p$n+p$_*p$X*p$l+p$t*p$e*p$G-p$t*p$N*p$l-p$_*p$e*p$n-p$L*p$X*p$G;this.transform(p$z*p$i,p$W*p$i,p$c*p$i,p$T*p$i,p$M*p$i,p$I*p$i),this.drawImage(p$Y,p$h.uv[0]*p$u,p$h.uv[1]*p$v,p$C,p$U,p$h.uv[0]*p$u,p$h.uv[1]*p$v,p$C,p$U),this.restore()},p$h.flush=function(){return 0},p$h.fillWords=function(p$h,p$q,p$f,p$g,p$$,p$P){p$g&&(this.font=p$g),p$$&&(this.fillStyle=p$$);this.textBaseline="top",this.textAlign="left";for(var p$S=0,p$B=p$h.length;p$S<p$B;p$S++){var p$r=p$h[p$S];if(this.__fillText(p$r.char,p$r.x+p$q,p$r.y+p$f),1===p$P){var p$Y=p$r.height,p$C=.5*p$r.style.letterSpacing;p$C||(p$C=0),this.beginPath(),this.strokeStyle=p$$,this.lineWidth=1,this.moveTo(p$q+p$r.x-p$C+.5,p$f+p$r.y+p$Y+.5),this.lineTo(p$q+p$r.x+p$r.width+p$C+.5,p$f+p$r.y+p$Y+.5),this.stroke()}}},p$h.fillBorderWords=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$g&&(this.font=p$g),p$$&&(this.fillStyle=p$$),this.textBaseline="top",this.lineWidth=p$S,this.textAlign="left",this.strokeStyle=p$P;for(var p$B=0,p$r=p$h.length;p$B<p$r;p$B++){var p$Y=p$h[p$B];this.__strokeText(p$Y.char,p$Y.x+p$q,p$Y.y+p$f),this.__fillText(p$Y.char,p$Y.x+p$q,p$Y.y+p$f)}},p$h.destroy=function(){this.canvas.width=this.canvas.height=0},p$h.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},p$h.drawCurves=function(p$h,p$q,p$f){this.beginPath(),this.strokeStyle=p$f[3],this.lineWidth=p$f[4];var p$g=p$f[2];p$h+=p$f[0],p$q+=p$f[1],this.moveTo(p$h+p$g[0],p$q+p$g[1]);for(var p$$=2,p$P=p$g.length;p$$<p$P;)this.quadraticCurveTo(p$h+p$g[p$$++],p$q+p$g[p$$++],p$h+p$g[p$$++],p$q+p$g[p$$++]);this.stroke()},p$B.__init__=function(p$q){var p$f=laya.resource.Context.prototype;if(!(p$q=p$q||CanvasRenderingContext2D.prototype).inited){p$q.inited=!0,p$q.__fillText=p$q.fillText,p$q.__fillRect=p$q.fillRect,p$q.__strokeText=p$q.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(p$h){p$q[p$h]=p$f[p$h]})}},p$B.replaceCanvasGetSet=function(p$h,p$q){var p$f=Object.getOwnPropertyDescriptor(p$h,p$q);if(!p$f||!p$f.configurable)return!1;var p$g,p$$={};for(p$g in p$f)"set"!=p$g&&(p$$[p$g]=p$f[p$g]);var p$P=p$f.set;return p$$.set=function(p$h){p$P.call(this,p$h);var p$q=this.getContext("2d");p$q&&"__reset"in p$q&&p$q.__reset()},Object.defineProperty(p$h,p$q,p$$),!0},p$B.replaceGetSet=function(p$h,p$q){var p$f=Object.getOwnPropertyDescriptor(p$h,p$q);if(!p$f||!p$f.configurable)return!1;var p$g,p$$={};for(p$g in p$f)"set"!=p$g&&(p$$[p$g]=p$f[p$g]);var p$P=p$f.set,p$S="___"+p$q+"__";return p$B.newKeys.push(p$S),p$$.set=function(p$h){p$h!=this[p$S]&&(this[p$S]=p$h,p$P.call(this,p$h))},Object.defineProperty(p$h,p$q,p$$),!0},p$B._default=new p$B,p$B.newKeys=[],p$r(p$B,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),p$B}(),p$I=function(){function p$P(p$h){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++p$P._uniqueIDCounter,this._name=p$h||"Content Manager",p$P._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,p$P._resourceManagers.push(this),this._resources=[],this._records={}}p$C(p$P,"laya.resource.ResourceManager");var p$h=p$P.prototype;return p$t.imps(p$h,{"laya.resource.IDispose":!0}),p$h.getResourceByIndex=function(p$h){return this._resources[p$h]},p$h.getResourcesLength=function(){return this._resources.length},p$h.addResource=function(p$h){return p$h.resourceManager&&p$h.resourceManager.removeResource(p$h),-1===this._resources.indexOf(p$h)&&((p$h._resourceManager=this)._resources.push(p$h),this.addRecord(p$h.uri,p$h.__className,p$h.memorySize),this.addSize(p$h.memorySize),!0)},p$h.removeResource=function(p$h){var p$q=this._resources.indexOf(p$h);return-1!==p$q&&(this._resources.splice(p$q,1),p$h._resourceManager=null,this._memorySize-=p$h.memorySize,this.addRecord(p$h.uri,p$h.__className,-p$h.memorySize),!0)},p$h.unload=function(){for(var p$h=this._resources.slice(0,this._resources.length),p$q=0;p$q<p$h.length;p$q++){p$h[p$q].destroy()}p$h.length=0},p$h.dispose=function(){if(this===p$P._systemResourceManager)throw new Error("systemResourceManager不能被释放！");p$P._resourceManagers.splice(p$P._resourceManagers.indexOf(this),1),p$P._isResourceManagersSorted=!1;for(var p$h=this._resources.slice(0,this._resources.length),p$q=0;p$q<p$h.length;p$q++){var p$f=p$h[p$q];p$f.resourceManager.removeResource(p$f),p$f.destroy()}p$h.length=0},p$h.addSize=function(p$h){p$h&&(this.autoRelease&&0<p$h&&this._memorySize+p$h>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=p$h)},p$h.addRecord=function(p$h,p$q,p$f){DEBUG&&p$f&&!p$h&&console.error(p$h,p$q,p$f),p$h&&(this._records.hasOwnProperty(p$q+"|"+p$h)||(this._records[p$q+"|"+p$h]=0),this._records[p$q+"|"+p$h]+=p$f,DEBUG&&this._records[p$q+"|"+p$h]<0&&console.error(p$h,p$q,this._records[p$q+"|"+p$h]))},p$h.garbageCollection=function(p$h){var p$q=this._resources;(p$q=p$q.slice()).sort(function(p$h,p$q){if(!p$h||!p$q)throw new Error("a或b不能为空！");return p$h.released&&p$q.released?0:p$h.released?1:p$q.released?-1:p$h._lastUseFrameCount-p$q._lastUseFrameCount});for(var p$f=p$Z.loopCount,p$g=0,p$$=p$q.length;p$g<p$$;p$g++){var p$P=p$q[p$g];if(!(1<p$f-p$P._lastUseFrameCount))return void(this._memorySize>=p$h&&(this._isOverflow=!0));if(p$P.releaseResource(),this._memorySize<p$h)return void(this._isOverflow=!1)}},p$L(0,p$h,"id",function(){return this._id}),p$L(0,p$h,"name",function(){return this._name},function(p$h){!p$h&&""===p$h||this._name===p$h||(this._name=p$h,p$P._isResourceManagersSorted=!1)}),p$L(0,p$h,"memorySize",function(){return this._memorySize}),p$L(0,p$h,"records",function(){return this._records}),p$L(1,p$P,"systemResourceManager",function(){return p$P._systemResourceManager}),p$P.__init__=function(){p$P.currentResourceManager=p$P.systemResourceManager},p$P.getLoadedResourceManagerByIndex=function(p$h){return p$P._resourceManagers[p$h]},p$P.getLoadedResourceManagersCount=function(){return p$P._resourceManagers.length},p$P.recreateContentManagers=function(p$h){void 0===p$h&&(p$h=!1);for(var p$q=p$P.currentResourceManager,p$f=0;p$f<p$P._resourceManagers.length;p$f++){p$P.currentResourceManager=p$P._resourceManagers[p$f];for(var p$g=0;p$g<p$P.currentResourceManager._resources.length;p$g++)p$P.currentResourceManager._resources[p$g].releaseResource(p$h),p$P.currentResourceManager._resources[p$g].activeResource(p$h)}p$P.currentResourceManager=p$q},p$P.releaseContentManagers=function(p$h){void 0===p$h&&(p$h=!1);for(var p$q=p$P.currentResourceManager,p$f=0;p$f<p$P._resourceManagers.length;p$f++){p$P.currentResourceManager=p$P._resourceManagers[p$f];for(var p$g=0;p$g<p$P.currentResourceManager._resources.length;p$g++){var p$$=p$P.currentResourceManager._resources[p$g];!p$$.released&&p$$.releaseResource(p$h)}}p$P.currentResourceManager=p$q},p$P._uniqueIDCounter=0,p$P._isResourceManagersSorted=!1,p$P._resourceManagers=[],p$r(p$P,["_systemResourceManager",function(){return this._systemResourceManager=new p$P("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=p$P._systemResourceManager}]),p$P}(),p$w=(function(){function p$h(){}p$C(p$h,"laya.system.System"),p$h.changeDefinition=function(p$h,p$q){p$t[p$h]=p$q;var p$f=p$h+"=classObj";p$t._runScript(p$f)},p$h.__init__=function(){p$c.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function p$f(){}return p$C(p$f,"laya.utils.Browser"),p$L(1,p$f,"pixelRatio",function(){return p$f.__init__(),-1<p$f.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:p$d.getPixelRatio()}),p$L(1,p$f,"height",function(){return p$f.__init__(),(p$t.stage&&p$t.stage.canvasRotation?p$f.clientWidth:p$f.clientHeight)*p$f.pixelRatio}),p$L(1,p$f,"clientWidth",function(){return p$f.__init__(),p$f.window.innerWidth||p$f.document.body.clientWidth}),p$L(1,p$f,"window",function(){return p$f.__init__(),p$f._window}),p$L(1,p$f,"clientHeight",function(){return p$f.__init__(),p$f.window.innerHeight||p$f.document.body.clientHeight||p$f.document.documentElement.clientHeight}),p$L(1,p$f,"width",function(){return p$f.__init__(),(p$t.stage&&p$t.stage.canvasRotation?p$f.clientHeight:p$f.clientWidth)*p$f.pixelRatio}),p$L(1,p$f,"container",function(){return p$f.__init__(),p$f._container||((p$f._container=p$f.createElement("div")).id="layaContainer",p$f.document.body.appendChild(p$f._container)),p$f._container},function(p$h){p$f._container=p$h}),p$L(1,p$f,"document",function(){return p$f.__init__(),p$f._document}),p$f.__init__=function(){if(!p$f._window){p$f._window=p$d.getWindow(),p$f._document=p$f.window.document,p$f._window.addEventListener("message",function(p$h){laya.utils.Browser._onMessage(p$h)},!1),p$f.document.__createElement=p$f.document.createElement,p$S.requestAnimationFrame=p$S.requestAnimationFrame||p$S.webkitRequestAnimationFrame||p$S.mozRequestAnimationFrame||p$S.oRequestAnimationFrame||p$S.msRequestAnimationFrame||function(p$h){return p$S.setTimeout(p$h,1e3/60)};var p$h=p$S.document.body.style;p$h["-webkit-user-select"]="none",p$h["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",p$f.userAgent=p$f.window.navigator.userAgent,p$f.onIOS=!!(p$f.u=p$f.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),p$f.onMobile=-1<p$f.u.indexOf("Mobile"),p$f.onIPhone=-1<p$f.u.indexOf("iPhone"),p$f.onMac=-1<p$f.u.indexOf("Mac OS X"),p$f.onIPad=-1<p$f.u.indexOf("iPad"),p$f.onAndroid=-1<p$f.u.indexOf("Android")||-1<p$f.u.indexOf("Adr"),p$f.onWP=-1<p$f.u.indexOf("Windows Phone"),p$f.onQQBrowser=-1<p$f.u.indexOf("QQBrowser"),p$f.onMQQBrowser=-1<p$f.u.indexOf("MQQBrowser")||-1<p$f.u.indexOf("Mobile")&&-1<p$f.u.indexOf("QQ"),p$f.onIE=!!p$f.window.ActiveXObject||"ActiveXObject"in p$f.window,p$f.onWeiXin=-1<p$f.u.indexOf("MicroMessenger"),p$f.onPC=!p$f.onMobile,p$f.onSafari=-1<p$f.u.indexOf("Safari"),p$f.onFirefox=-1<p$f.u.indexOf("Firefox"),p$f.onEdge=-1<p$f.u.indexOf("Edge"),p$f.onMiniGame=-1<p$f.u.indexOf("MiniGame"),p$f.onLimixiu=-1<p$f.u.indexOf("limixiu"),p$f.httpProtocol="http:"==p$f.window.location.protocol,p$f.onMiniGame&&null==p$f.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),p$f.webAudioEnabled=!!(p$f.window.AudioContext||p$f.window.webkitAudioContext||p$f.window.mozAudioContext),p$f.soundType=p$f.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",p$$h=p$f.webAudioEnabled?p$Ph:p$fh,p$f.webAudioEnabled&&p$Ph.initWebAudio(),p$fh._initMusicAudio(),p$f.enableTouch="ontouchstart"in p$S||p$S.DocumentTouch&&p$q instanceof DocumentTouch,p$S.focus(),p$A._soundClass=p$$h,p$A._musicClass=p$fh,p$c._mainCanvas=p$c._mainCanvas||p$Gh.create("2D"),p$f.canvas||(p$f.canvas=p$Gh.create("2D"),p$f.context=p$f.canvas.getContext("2d"))}},p$f._onMessage=function(p$h){if(p$h.data&&"size"==p$h.data.name){if(p$f.window.innerWidth=p$h.data.width,p$f.window.innerHeight=p$h.data.height,p$f.window.__innerHeight=p$h.data.clientHeight,!p$f.document.createEvent)return void console.warn("no document.createEvent");var p$q=p$f.document.createEvent("HTMLEvents");return p$q.initEvent("resize",!1,!1),void p$f.window.dispatchEvent(p$q)}},p$f.createElement=function(p$h){return p$f.__init__(),p$f.document.__createElement(p$h)},p$f.getElementById=function(p$h){return p$f.__init__(),p$f.document.getElementById(p$h)},p$f.removeElement=function(p$h){p$h&&p$h.parentNode&&p$h.parentNode.removeChild(p$h)},p$f.now=function(){return p$d.now()},p$f._window=null,p$f._document=null,p$f._container=null,p$f.userAgent=null,p$f.u=null,p$f.onIOS=!1,p$f.onMac=!1,p$f.onMobile=!1,p$f.onIPhone=!1,p$f.onIPad=!1,p$f.onAndroid=!1,p$f.onWP=!1,p$f.onQQBrowser=!1,p$f.onMQQBrowser=!1,p$f.onSafari=!1,p$f.onFirefox=!1,p$f.onEdge=!1,p$f.onIE=!1,p$f.onWeiXin=!1,p$f.onMiniGame=!1,p$f.onLimixiu=!1,p$f.onPC=!1,p$f.httpProtocol=!1,p$f.webAudioEnabled=!1,p$f.soundType=null,p$f.enableTouch=!1,p$f.canvas=null,p$f.context=null,p$f.__init$=function(){},p$f}()),p$k=function(){function p$q(p$h){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,p$h?(this._u8d_=new Uint8Array(p$h),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}p$C(p$q,"laya.utils.Byte");var p$h=p$q.prototype;return p$h.___resizeBuffer=function(p$q){try{var p$h=new Uint8Array(p$q);null!=this._u8d_&&(this._u8d_.length<=p$q?p$h.set(this._u8d_):p$h.set(this._u8d_.subarray(0,p$q))),this._u8d_=p$h,this._d_=new DataView(p$h.buffer)}catch(p$h){throw"___resizeBuffer err:"+p$q}},p$h.getString=function(){return this.rUTF(this.getUint16())},p$h.getFloat32Array=function(p$h,p$q){var p$f=p$h+p$q;p$f=p$f>this._length?this._length:p$f;var p$g=new Float32Array(this._d_.buffer.slice(p$h,p$f));return this._pos_=p$f,p$g},p$h.getUint8Array=function(p$h,p$q){var p$f=p$h+p$q;p$f=p$f>this._length?this._length:p$f;var p$g=new Uint8Array(this._d_.buffer.slice(p$h,p$f));return this._pos_=p$f,p$g},p$h.getInt16Array=function(p$h,p$q){var p$f=p$h+p$q;p$f=p$f>this._length?this._length:p$f;var p$g=new Int16Array(this._d_.buffer.slice(p$h,p$f));return this._pos_=p$f,p$g},p$h.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var p$h=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,p$h},p$h.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var p$h=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,p$h},p$h.writeFloat32=function(p$h){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,p$h,this._xd_),this._pos_+=4},p$h.writeFloat64=function(p$h){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,p$h,this._xd_),this._pos_+=8},p$h.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var p$h=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,p$h},p$h.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var p$h=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,p$h},p$h.writeInt32=function(p$h){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,p$h,this._xd_),this._pos_+=4},p$h.writeUint32=function(p$h){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,p$h,this._xd_),this._pos_+=4},p$h.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var p$h=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,p$h},p$h.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var p$h=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,p$h},p$h.writeUint16=function(p$h){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,p$h,this._xd_),this._pos_+=2},p$h.writeInt16=function(p$h){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,p$h,this._xd_),this._pos_+=2},p$h.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},p$h.writeUint8=function(p$h){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,p$h),this._pos_++},p$h._getUInt8=function(p$h){return this._d_.getUint8(p$h)},p$h._getUint16=function(p$h){return this._d_.getUint16(p$h,this._xd_)},p$h._getMatrix=function(){return new p$b(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},p$h.rUTF=function(p$h){for(var p$q=[],p$f=this._pos_+p$h,p$g=0,p$$=0,p$P=0,p$S=String.fromCharCode,p$B=this._u8d_;this._pos_<p$f;)(p$g=p$B[this._pos_++])<128?0!=p$g&&p$q.push(p$S(p$g)):p$g<224?p$q.push(p$S((63&p$g)<<6|127&p$B[this._pos_++])):p$g<240?(p$$=p$B[this._pos_++],p$q.push(p$S((31&p$g)<<12|(127&p$$)<<6|127&p$B[this._pos_++]))):(p$$=p$B[this._pos_++],p$P=p$B[this._pos_++],p$q.push(p$S((15&p$g)<<18|(127&p$$)<<12|p$P<<6&127|127&p$B[this._pos_++]))),0;return p$q.join("")},p$h.getCustomString=function(p$h){for(var p$q=[],p$f=0,p$g=0,p$$=0,p$P=String.fromCharCode,p$S=this._u8d_;0<p$h;)if((p$g=p$S[this._pos_])<128)p$q.push(p$P(p$g)),this._pos_++,p$h--;else for(p$f=p$g-128,this._pos_++,p$h-=p$f;0<p$f;)p$g=p$S[this._pos_++],p$$=p$S[this._pos_++],p$q.push(p$P(p$$<<8|p$g)),p$f--;return p$q.join("")},p$h.clear=function(){this._pos_=0,this.length=0},p$h.__getBuffer=function(){return this._d_.buffer},p$h.writeUTFBytes=function(p$h){for(var p$q=0,p$f=(p$h+="").length;p$q<p$f;p$q++){var p$g=p$h.charCodeAt(p$q);p$g<=127?this.writeByte(p$g):p$g<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|p$g>>6,128|63&p$g],this._pos_),this._pos_+=2):p$g<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|p$g>>12,128|p$g>>6&63,128|63&p$g],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|p$g>>18,128|p$g>>12&63,128|p$g>>6&63,128|63&p$g],this._pos_),this._pos_+=4)}},p$h.writeUTFString=function(p$h){var p$q=this.pos;this.writeUint16(1),this.writeUTFBytes(p$h);var p$f=this.pos-p$q-2;if(65536<=p$f)throw"writeUTFString byte len more than 65536";this._d_.setUint16(p$q,p$f,this._xd_)},p$h.readUTFString=function(){return this.readUTFBytes(this.getUint16())},p$h.getUTFString=function(){return this.readUTFString()},p$h.readUTFBytes=function(p$h){if(void 0===p$h&&(p$h=-1),0==p$h)return"";var p$q=this.bytesAvailable;if(p$q<p$h)throw"readUTFBytes error - Out of bounds";return p$h=0<p$h?p$h:p$q,this.rUTF(p$h)},p$h.getUTFBytes=function(p$h){return void 0===p$h&&(p$h=-1),this.readUTFBytes(p$h)},p$h.writeByte=function(p$h){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,p$h),this._pos_+=1},p$h.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},p$h.getByte=function(){return this.readByte()},p$h.ensureWrite=function(p$h){this._length<p$h&&(this._length=p$h),this._allocated_<p$h&&(this.length=p$h)},p$h.writeArrayBuffer=function(p$h,p$q,p$f){if(void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),p$q<0||p$f<0)throw"writeArrayBuffer error - Out of bounds";0==p$f&&(p$f=p$h.byteLength-p$q),this.ensureWrite(this._pos_+p$f);var p$g=new Uint8Array(p$h);this._u8d_.set(p$g.subarray(p$q,p$q+p$f),this._pos_),this._pos_+=p$f},p$L(0,p$h,"buffer",function(){var p$h=this._d_.buffer;return p$h.byteLength==this.length?p$h:p$h.slice(0,this.length)}),p$L(0,p$h,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(p$h){this._xd_="littleEndian"==p$h}),p$L(0,p$h,"length",function(){return this._length},function(p$h){this._allocated_<p$h?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(p$h,2*this._allocated_))):this._allocated_>p$h&&this.___resizeBuffer(this._allocated_=p$h),this._length=p$h}),p$L(0,p$h,"pos",function(){return this._pos_},function(p$h){this._pos_=p$h}),p$L(0,p$h,"bytesAvailable",function(){return this._length-this._pos_}),p$q.getSystemEndian=function(){if(!p$q._sysEndian){var p$h=new ArrayBuffer(2);new DataView(p$h).setInt16(0,256,!0),p$q._sysEndian=256===new Int16Array(p$h)[0]?"littleEndian":"bigEndian"}return p$q._sysEndian},p$q.BIG_ENDIAN="bigEndian",p$q.LITTLE_ENDIAN="littleEndian",p$q._sysEndian=null,p$q}(),p$H=function(){function p$$(){}return p$C(p$$,"laya.utils.CacheManager"),p$$.regCacheByFunction=function(p$h,p$q){var p$f;p$$.unRegCacheByFunction(p$h,p$q),p$f={tryDispose:p$h,getCacheList:p$q},p$$._cacheList.push(p$f)},p$$.unRegCacheByFunction=function(p$h,p$q){var p$f,p$g=0;for(p$f=p$$._cacheList.length,p$g=0;p$g<p$f;p$g++)if(p$$._cacheList[p$g].tryDispose==p$h&&p$$._cacheList[p$g].getCacheList==p$q)return void p$$._cacheList.splice(p$g,1)},p$$.forceDispose=function(){var p$h=0,p$q=p$$._cacheList.length;for(p$h=0;p$h<p$q;p$h++)p$$._cacheList[p$h].tryDispose(!0)},p$$.beginCheck=function(p$h){void 0===p$h&&(p$h=15e3),p$t.timer.loop(p$h,null,p$$._checkLoop)},p$$.stopCheck=function(){p$t.timer.clear(null,p$$._checkLoop)},p$$._checkLoop=function(){var p$h=p$$._cacheList;if(!(p$h.length<1)){var p$q,p$f=p$w.now(),p$g=0;for(p$q=p$g=p$h.length;0<p$g&&(p$h[p$$._index=++p$$._index%p$q].tryDispose(!1),!(p$w.now()-p$f>p$$.loopTimeLimit));)p$g--}},p$$.loopTimeLimit=2,p$$._cacheList=[],p$$._index=0,p$$}(),p$D=function(){function p$v(){}return p$C(p$v,"laya.utils.ClassUtils"),p$v.regClass=function(p$h,p$q){p$v._classMap[p$h]=p$q},p$v.getRegClass=function(p$h){return p$v._classMap[p$h]},p$v.getInstance=function(p$h){var p$q=p$v.getClass(p$h);return p$q?new p$q:(console.warn("[error] Undefined class:",p$h),null)},p$v.createByJson=function(p$h,p$q,p$f,p$g,p$$){"string"==typeof p$h&&(p$h=JSON.parse(p$h));var p$P=p$h.props;if(!p$q&&!(p$q=p$$?p$$.runWith(p$h):p$v.getInstance(p$P.runtime||p$h.type)))return null;var p$S=p$h.child;if(p$S)for(var p$B=0,p$r=p$S.length;p$B<p$r;p$B++){var p$Y=p$S[p$B];if("render"!==p$Y.props.name&&"render"!==p$Y.props.renderType||!p$q._$set_itemRender)if("Graphic"==p$Y.type)p$v.addGraphicsToSprite(p$Y,p$q);else if(p$v.isDrawType(p$Y.type))p$v.addGraphicToSprite(p$Y,p$q,!0);else{var p$C=p$v.createByJson(p$Y,null,p$f,p$g,p$$);"Script"==p$Y.type?p$C.hasOwnProperty("owner")?p$C.owner=p$q:p$C.hasOwnProperty("target")&&(p$C.target=p$q):"mask"==p$Y.props.renderType?p$q.mask=p$C:p$q.addChild(p$C)}else p$q.itemRender=p$Y}if(p$P)for(var p$U in p$P){var p$u=p$P[p$U];"var"===p$U&&p$f?p$f[p$u]=p$q:p$u instanceof Array&&"function"==typeof p$q[p$U]?p$q[p$U].apply(p$q,p$u):p$q[p$U]=p$u}return p$g&&p$h.customProps&&p$g.runWith([p$q,p$h]),p$q.created&&p$q.created(),p$q},p$v.addGraphicsToSprite=function(p$h,p$q){var p$f;if((p$f=p$h.child)&&!(p$f.length<1)){var p$g;p$g=p$v._getGraphicsFromSprite(p$h,p$q);var p$$=0,p$P=0;p$h.props&&(p$$=p$v._getObjVar(p$h.props,"x",0),p$P=p$v._getObjVar(p$h.props,"y",0)),0!=p$$&&0!=p$P&&p$g.translate(p$$,p$P);var p$S,p$B=0;for(p$S=p$f.length,p$B=0;p$B<p$S;p$B++)p$v._addGraphicToGraphics(p$f[p$B],p$g);0!=p$$&&0!=p$P&&p$g.translate(-p$$,-p$P)}},p$v.addGraphicToSprite=function(p$h,p$q,p$f){var p$g;void 0===p$f&&(p$f=!1),p$g=p$f?p$v._getGraphicsFromSprite(p$h,p$q):p$q.graphics,p$v._addGraphicToGraphics(p$h,p$g)},p$v._getGraphicsFromSprite=function(p$h,p$q){var p$f,p$g;if(!p$h||!p$h.props)return p$q.graphics;switch(p$g=p$h.props.renderType){case"hit":case"unHit":var p$$;p$q.hitArea||(p$q.hitArea=new p$y),(p$$=p$q.hitArea)[p$g]||(p$$[p$g]=new p$u),p$f=p$$[p$g]}return p$f||(p$f=p$q.graphics),p$f},p$v._getTransformData=function(p$h){var p$q;(p$h.hasOwnProperty("pivotX")||p$h.hasOwnProperty("pivotY"))&&(p$q=p$q||new p$b).translate(-p$v._getObjVar(p$h,"pivotX",0),-p$v._getObjVar(p$h,"pivotY",0));var p$f=p$v._getObjVar(p$h,"scaleX",1),p$g=p$v._getObjVar(p$h,"scaleY",1),p$$=p$v._getObjVar(p$h,"rotation",0);p$v._getObjVar(p$h,"skewX",0),p$v._getObjVar(p$h,"skewY",0);return 1==p$f&&1==p$g&&0==p$$||((p$q=p$q||new p$b).scale(p$f,p$g),p$q.rotate(.0174532922222222*p$$)),p$q},p$v._addGraphicToGraphics=function(p$h,p$q){var p$f,p$g;if((p$f=p$h.props)&&(p$g=p$v.DrawTypeDic[p$h.type])){var p$$,p$P;p$$=p$q;var p$S=p$v._getParams(p$f,p$g[1],p$g[2],p$g[3]);((p$P=p$v._tM)||1!=p$v._alpha)&&(p$$.save(),p$P&&p$$.transform(p$P),1!=p$v._alpha&&p$$.alpha(p$v._alpha)),p$$[p$g[0]].apply(p$$,p$S),(p$P||1!=p$v._alpha)&&p$$.restore()}},p$v._adptLineData=function(p$h){return p$h[2]=parseFloat(p$h[0])+parseFloat(p$h[2]),p$h[3]=parseFloat(p$h[1])+parseFloat(p$h[3]),p$h},p$v._adptTextureData=function(p$h){return p$h[0]=p$Bh.getRes(p$h[0]),p$h},p$v._adptLinesData=function(p$h){return p$h[2]=p$v._getPointListByStr(p$h[2]),p$h},p$v.isDrawType=function(p$h){return"Image"!=p$h&&p$v.DrawTypeDic.hasOwnProperty(p$h)},p$v._getParams=function(p$h,p$q,p$f,p$g){var p$$;void 0===p$f&&(p$f=0),(p$$=p$v._temParam).length=p$q.length;var p$P,p$S,p$B=0;for(p$P=p$q.length,p$B=0;p$B<p$P;p$B++)p$$[p$B]=p$v._getObjVar(p$h,p$q[p$B][0],p$q[p$B][1]);return p$v._alpha=p$v._getObjVar(p$h,"alpha",1),p$S=p$v._getTransformData(p$h),p$v._tM=p$S?(p$f||(p$f=0),p$S.translate(p$$[p$f],p$$[p$f+1]),p$$[p$f]=p$$[p$f+1]=0,p$S):null,p$g&&p$v[p$g]&&(p$$=p$v[p$g](p$$)),p$$},p$v._getPointListByStr=function(p$h){var p$q,p$f,p$g=0;for(p$f=(p$q=p$h.split(",")).length,p$g=0;p$g<p$f;p$g++)p$q[p$g]=parseFloat(p$q[p$g]);return p$q},p$v._getObjVar=function(p$h,p$q,p$f){return p$h.hasOwnProperty(p$q)?p$h[p$q]:p$f},p$v._temParam=[],p$v._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},p$v.getClass=function(p$h){var p$q=p$v._classMap[p$h]||p$h;return"string"==typeof p$q?p$t.__classmap[p$q]:p$q},p$v._tM=null,p$v._alpha=NaN,p$r(p$v,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),p$v}(),p$s=function(){function p$P(p$h){if(this._color=[],"string"==typeof p$h){null===(this.strColor=p$h)&&(p$h="#000000"),"#"==p$h.charAt(0)&&(p$h=p$h.substr(1));var p$q=p$h.length;if(3==p$q||4==p$q){for(var p$f="",p$g=0;p$g<p$q;p$g++)p$f+=p$h[p$g]+p$h[p$g];p$h=p$f}var p$$=this.numColor=parseInt(p$h,16);if(8==p$h.length)return void(this._color=[parseInt(p$h.substr(0,2),16)/255,((16711680&p$$)>>16)/255,((65280&p$$)>>8)/255,(255&p$$)/255])}else p$$=this.numColor=p$h,this.strColor=p$O.toHexColor(p$$);this._color=[((16711680&p$$)>>16)/255,((65280&p$$)>>8)/255,(255&p$$)/255,1],this._color.__id=++p$P._COLODID}return p$C(p$P,"laya.utils.Color"),p$P._initDefault=function(){for(var p$h in p$P._DEFAULT={},p$P._COLOR_MAP)p$P._SAVE[p$h]=p$P._DEFAULT[p$h]=new p$P(p$P._COLOR_MAP[p$h]);return p$P._DEFAULT},p$P._initSaveMap=function(){for(var p$h in p$P._SAVE_SIZE=0,p$P._SAVE={},p$P._DEFAULT)p$P._SAVE[p$h]=p$P._DEFAULT[p$h]},p$P.create=function(p$h){var p$q=p$P._SAVE[p$h+""];return null!=p$q?p$q:(p$P._SAVE_SIZE<1e3||p$P._initSaveMap(),p$P._SAVE[p$h+""]=new p$P(p$h))},p$P._SAVE={},p$P._SAVE_SIZE=0,p$P._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},p$P._DEFAULT=p$P._initDefault(),p$P._COLODID=1,p$P}(),p$V=(function(){function p$h(){this._values=[],this._keys=[]}p$C(p$h,"laya.utils.Dictionary");var p$q=p$h.prototype;p$q.set=function(p$h,p$q){var p$f=this.indexOf(p$h);0<=p$f?this._values[p$f]=p$q:(this._keys.push(p$h),this._values.push(p$q))},p$q.indexOf=function(p$h){var p$q=this._keys.indexOf(p$h);return 0<=p$q?p$q:(p$h="string"==typeof p$h?Number(p$h):"number"==typeof p$h?p$h.toString():p$h,this._keys.indexOf(p$h))},p$q.get=function(p$h){var p$q=this.indexOf(p$h);return p$q<0?null:this._values[p$q]},p$q.remove=function(p$h){var p$q=this.indexOf(p$h);return 0<=p$q&&(this._keys.splice(p$q,1),this._values.splice(p$q,1),!0)},p$q.clear=function(){this._values.length=0,this._keys.length=0},p$L(0,p$q,"values",function(){return this._values}),p$L(0,p$q,"keys",function(){return this._keys})}(),function(){function p$h(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}p$C(p$h,"laya.utils.Dragging");var p$q=p$h.prototype;return p$q.start=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){void 0===p$B&&(p$B=.92),this.clearTimer(),this.target=p$h,this.area=p$q,this.hasInertia=p$f,this.elasticDistance=p$q?p$g:0,this.elasticBackTime=p$$,this.data=p$P,this._disableMouseEvent=p$S,this.ratio=p$B,1!=p$h.globalScaleX||1!=p$h.globalScaleY?this._parent=p$h.parent:this._parent=p$t.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,p$t.stage.on("mouseup",this,this.onStageMouseUp),p$t.stage.on("mouseout",this,this.onStageMouseUp),p$t.timer.frameLoop(1,this,this.loop)},p$q.clearTimer=function(){p$t.timer.clear(this,this.loop),p$t.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},p$q.stop=function(){this._dragging&&(p$e.instance.disableMouseEvent=!1,p$t.stage.off("mouseup",this,this.onStageMouseUp),p$t.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},p$q.loop=function(){var p$h=this._parent.getMousePoint(),p$q=p$h.x,p$f=p$h.y,p$g=p$q-this._lastX,p$$=p$f-this._lastY;if(this._clickOnly){if(!(1<Math.abs(p$g*p$t.stage._canvasTransform.getScaleX())||1<Math.abs(p$$*p$t.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),p$e.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(p$g,p$$);0==p$g&&0==p$$||(this._lastX=p$q,this._lastY=p$f,this.target.x+=p$g*this._elasticRateX,this.target.y+=p$$*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},p$q.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var p$h=this.area.x-this.target.x;else p$h=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-p$h/this.elasticDistance),this.target.y<this.area.y)var p$q=this.area.y-this.target.y;else p$q=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-p$q/this.elasticDistance)}},p$q.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},p$q.onStageMouseUp=function(p$h){if(p$e.instance.disableMouseEvent=!1,p$t.stage.off("mouseup",this,this.onStageMouseUp),p$t.stage.off("mouseout",this,this.onStageMouseUp),p$t.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var p$q=this._offsets.length,p$f=Math.min(p$q,6),p$g=this._offsets.length-p$f,p$$=p$q-1;p$g<p$$;p$$--)this._offsetY+=this._offsets[p$$--],this._offsetX+=this._offsets[p$$];this._offsetX=this._offsetX/p$f*2,this._offsetY=this._offsetY/p$f*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),p$t.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},p$q.checkElastic=function(){var p$h=NaN,p$q=NaN;if(this.target.x<this.area.x?p$h=this.area.x:this.target.x>this.area.x+this.area.width&&(p$h=this.area.x+this.area.width),this.target.y<this.area.y?p$q=this.area.y:this.target.y>this.area.y+this.area.height&&(p$q=this.area.y+this.area.height),isNaN(p$h)&&isNaN(p$q))this.clear();else{var p$f={};isNaN(p$h)||(p$f.x=p$h),isNaN(p$q)||(p$f.y=p$q),this._tween=p$o.to(this.target,p$f,this.elasticBackTime,p$K.sineOut,p$N.create(this,this.clear),0,!1,!1)}},p$q.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(p$t.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},p$q.clear=function(){if(this.target){this.clearTimer();var p$h=this.target;this.target=null,this._parent=null,p$h.event("dragend",this.data)}},p$h}()),p$K=function(){function p$B(){}return p$C(p$B,"laya.utils.Ease"),p$B.linearNone=function(p$h,p$q,p$f,p$g){return p$f*p$h/p$g+p$q},p$B.linearIn=function(p$h,p$q,p$f,p$g){return p$f*p$h/p$g+p$q},p$B.linearInOut=function(p$h,p$q,p$f,p$g){return p$f*p$h/p$g+p$q},p$B.linearOut=function(p$h,p$q,p$f,p$g){return p$f*p$h/p$g+p$q},p$B.bounceIn=function(p$h,p$q,p$f,p$g){return p$f-p$B.bounceOut(p$g-p$h,0,p$f,p$g)+p$q},p$B.bounceInOut=function(p$h,p$q,p$f,p$g){return p$h<.5*p$g?.5*p$B.bounceIn(2*p$h,0,p$f,p$g)+p$q:.5*p$B.bounceOut(2*p$h-p$g,0,p$f,p$g)+.5*p$f+p$q},p$B.bounceOut=function(p$h,p$q,p$f,p$g){return(p$h/=p$g)<1/2.75?p$f*(7.5625*p$h*p$h)+p$q:p$h<2/2.75?p$f*(7.5625*(p$h-=1.5/2.75)*p$h+.75)+p$q:p$h<2.5/2.75?p$f*(7.5625*(p$h-=2.25/2.75)*p$h+.9375)+p$q:p$f*(7.5625*(p$h-=2.625/2.75)*p$h+.984375)+p$q},p$B.backIn=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$$&&(p$$=1.70158),p$f*(p$h/=p$g)*p$h*((p$$+1)*p$h-p$$)+p$q},p$B.backInOut=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$$&&(p$$=1.70158),(p$h/=.5*p$g)<1?.5*p$f*(p$h*p$h*((1+(p$$*=1.525))*p$h-p$$))+p$q:p$f/2*((p$h-=2)*p$h*((1+(p$$*=1.525))*p$h+p$$)+2)+p$q},p$B.backOut=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$$&&(p$$=1.70158),p$f*((p$h=p$h/p$g-1)*p$h*((p$$+1)*p$h+p$$)+1)+p$q},p$B.elasticIn=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S;return void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=0),0==p$h?p$q:1==(p$h/=p$g)?p$q+p$f:(p$P||(p$P=.3*p$g),p$S=!p$$||0<p$f&&p$$<p$f||p$f<0&&p$$<-p$f?(p$$=p$f,p$P/4):p$P/p$B.PI2*Math.asin(p$f/p$$),-p$$*Math.pow(2,10*(p$h-=1))*Math.sin((p$h*p$g-p$S)*p$B.PI2/p$P)+p$q)},p$B.elasticInOut=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S;return void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=0),0==p$h?p$q:2==(p$h/=.5*p$g)?p$q+p$f:(p$P||(p$P=p$g*(.3*1.5)),p$S=!p$$||0<p$f&&p$$<p$f||p$f<0&&p$$<-p$f?(p$$=p$f,p$P/4):p$P/p$B.PI2*Math.asin(p$f/p$$),p$h<1?p$$*Math.pow(2,10*(p$h-=1))*Math.sin((p$h*p$g-p$S)*p$B.PI2/p$P)*-.5+p$q:p$$*Math.pow(2,-10*(p$h-=1))*Math.sin((p$h*p$g-p$S)*p$B.PI2/p$P)*.5+p$f+p$q)},p$B.elasticOut=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S;return void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=0),0==p$h?p$q:1==(p$h/=p$g)?p$q+p$f:(p$P||(p$P=.3*p$g),p$S=!p$$||0<p$f&&p$$<p$f||p$f<0&&p$$<-p$f?(p$$=p$f,p$P/4):p$P/p$B.PI2*Math.asin(p$f/p$$),p$$*Math.pow(2,-10*p$h)*Math.sin((p$h*p$g-p$S)*p$B.PI2/p$P)+p$f+p$q)},p$B.strongIn=function(p$h,p$q,p$f,p$g){return p$f*(p$h/=p$g)*p$h*p$h*p$h*p$h+p$q},p$B.strongInOut=function(p$h,p$q,p$f,p$g){return(p$h/=.5*p$g)<1?.5*p$f*p$h*p$h*p$h*p$h*p$h+p$q:.5*p$f*((p$h-=2)*p$h*p$h*p$h*p$h+2)+p$q},p$B.strongOut=function(p$h,p$q,p$f,p$g){return p$f*((p$h=p$h/p$g-1)*p$h*p$h*p$h*p$h+1)+p$q},p$B.sineInOut=function(p$h,p$q,p$f,p$g){return.5*-p$f*(Math.cos(Math.PI*p$h/p$g)-1)+p$q},p$B.sineIn=function(p$h,p$q,p$f,p$g){return-p$f*Math.cos(p$h/p$g*p$B.HALF_PI)+p$f+p$q},p$B.sineOut=function(p$h,p$q,p$f,p$g){return p$f*Math.sin(p$h/p$g*p$B.HALF_PI)+p$q},p$B.quintIn=function(p$h,p$q,p$f,p$g){return p$f*(p$h/=p$g)*p$h*p$h*p$h*p$h+p$q},p$B.quintInOut=function(p$h,p$q,p$f,p$g){return(p$h/=.5*p$g)<1?.5*p$f*p$h*p$h*p$h*p$h*p$h+p$q:.5*p$f*((p$h-=2)*p$h*p$h*p$h*p$h+2)+p$q},p$B.quintOut=function(p$h,p$q,p$f,p$g){return p$f*((p$h=p$h/p$g-1)*p$h*p$h*p$h*p$h+1)+p$q},p$B.quartIn=function(p$h,p$q,p$f,p$g){return p$f*(p$h/=p$g)*p$h*p$h*p$h+p$q},p$B.quartInOut=function(p$h,p$q,p$f,p$g){return(p$h/=.5*p$g)<1?.5*p$f*p$h*p$h*p$h*p$h+p$q:.5*-p$f*((p$h-=2)*p$h*p$h*p$h-2)+p$q},p$B.quartOut=function(p$h,p$q,p$f,p$g){return-p$f*((p$h=p$h/p$g-1)*p$h*p$h*p$h-1)+p$q},p$B.cubicIn=function(p$h,p$q,p$f,p$g){return p$f*(p$h/=p$g)*p$h*p$h+p$q},p$B.cubicInOut=function(p$h,p$q,p$f,p$g){return(p$h/=.5*p$g)<1?.5*p$f*p$h*p$h*p$h+p$q:.5*p$f*((p$h-=2)*p$h*p$h+2)+p$q},p$B.cubicOut=function(p$h,p$q,p$f,p$g){return p$f*((p$h=p$h/p$g-1)*p$h*p$h+1)+p$q},p$B.quadIn=function(p$h,p$q,p$f,p$g){return p$f*(p$h/=p$g)*p$h+p$q},p$B.quadInOut=function(p$h,p$q,p$f,p$g){return(p$h/=.5*p$g)<1?.5*p$f*p$h*p$h+p$q:.5*-p$f*(--p$h*(p$h-2)-1)+p$q},p$B.quadOut=function(p$h,p$q,p$f,p$g){return-p$f*(p$h/=p$g)*(p$h-2)+p$q},p$B.expoIn=function(p$h,p$q,p$f,p$g){return 0==p$h?p$q:p$f*Math.pow(2,10*(p$h/p$g-1))+p$q-.001*p$f},p$B.expoInOut=function(p$h,p$q,p$f,p$g){return 0==p$h?p$q:p$h==p$g?p$q+p$f:(p$h/=.5*p$g)<1?.5*p$f*Math.pow(2,10*(p$h-1))+p$q:.5*p$f*(2-Math.pow(2,-10*--p$h))+p$q},p$B.expoOut=function(p$h,p$q,p$f,p$g){return p$h==p$g?p$q+p$f:p$f*(1-Math.pow(2,-10*p$h/p$g))+p$q},p$B.circIn=function(p$h,p$q,p$f,p$g){return-p$f*(Math.sqrt(1-(p$h/=p$g)*p$h)-1)+p$q},p$B.circInOut=function(p$h,p$q,p$f,p$g){return(p$h/=.5*p$g)<1?.5*-p$f*(Math.sqrt(1-p$h*p$h)-1)+p$q:.5*p$f*(Math.sqrt(1-(p$h-=2)*p$h)+1)+p$q},p$B.circOut=function(p$h,p$q,p$f,p$g){return p$f*Math.sqrt(1-(p$h=p$h/p$g-1)*p$h)+p$q},p$B.HALF_PI=.5*Math.PI,p$B.PI2=2*Math.PI,p$B}(),p$y=function(){function p$U(){this._hit=null,this._unHit=null}p$C(p$U,"laya.utils.HitArea");var p$h=p$U.prototype;return p$h.isHit=function(p$h,p$q){return!!p$U.isHitGraphic(p$h,p$q,this.hit)&&!p$U.isHitGraphic(p$h,p$q,this.unHit)},p$h.contains=function(p$h,p$q){return this.isHit(p$h,p$q)},p$L(0,p$h,"hit",function(){return this._hit||(this._hit=new p$u),this._hit},function(p$h){this._hit=p$h}),p$L(0,p$h,"unHit",function(){return this._unHit||(this._unHit=new p$u),this._unHit},function(p$h){this._unHit=p$h}),p$U.isHitGraphic=function(p$h,p$q,p$f){if(!p$f)return!1;var p$g;if(!(p$g=p$f.cmds)&&p$f._one&&((p$g=p$U._cmds).length=1,p$g[0]=p$f._one),!p$g)return!1;var p$$,p$P,p$S=0;for(p$$=p$g.length,p$S=0;p$S<p$$;p$S++)if(p$P=p$g[p$S]){var p$B=p$c._context;switch(p$P.callee){case p$B._translate:case 6:p$h-=p$P[0],p$q-=p$P[1]}if(p$U.isHitCmd(p$h,p$q,p$P))return!0}return!1},p$U.isHitCmd=function(p$h,p$q,p$f){if(!p$f)return!1;var p$g=p$c._context,p$$=!1;switch(p$f.callee){case p$g._drawRect:case 13:p$U._rec.setTo(p$f[0],p$f[1],p$f[2],p$f[3]),p$$=p$U._rec.contains(p$h,p$q);break;case p$g._drawCircle:case p$g._fillCircle:case 14:p$$=(p$h-=p$f[0])*p$h+(p$q-=p$f[1])*p$q<p$f[2]*p$f[2];break;case p$g._drawPoly:case 18:p$h-=p$f[0],p$q-=p$f[1],p$$=p$U.ptInPolygon(p$h,p$q,p$f[2])}return p$$},p$U.ptInPolygon=function(p$h,p$q,p$f){var p$g;(p$g=p$U._ptPoint).setTo(p$h,p$q);var p$$,p$P=0,p$S=NaN,p$B=NaN,p$r=NaN,p$Y=NaN;p$$=p$f.length;for(var p$C=0;p$C<p$$;p$C+=2){if(p$S=p$f[p$C],p$B=p$f[p$C+1],p$r=p$f[(p$C+2)%p$$],p$B!=(p$Y=p$f[(p$C+3)%p$$]))if(!(p$g.y<Math.min(p$B,p$Y)))if(!(p$g.y>=Math.max(p$B,p$Y)))(p$g.y-p$B)*(p$r-p$S)/(p$Y-p$B)+p$S>p$g.x&&p$P++}return p$P%2==1},p$U._cmds=[],p$r(p$U,["_rec",function(){return this._rec=new p$n},"_ptPoint",function(){return this._ptPoint=new p$X}]),p$U}(),p$F=(function(){function p$$(p$h,p$q,p$f,p$g){this.char=p$h,this.charNum=p$h.charCodeAt(0),this._x=this._y=0,this.width=p$q,this.height=p$f,this.style=p$g,this.isWord=!p$$._isWordRegExp.test(p$h)}p$C(p$$,"laya.utils.HTMLChar");var p$h=p$$.prototype;p$t.imps(p$h,{"laya.display.ILayout":!0}),p$h.setSprite=function(p$h){this._sprite=p$h},p$h.getSprite=function(){return this._sprite},p$h._isChar=function(){return!0},p$h._getCSSStyle=function(){return this.style},p$L(0,p$h,"width",function(){return this._w},function(p$h){this._w=p$h}),p$L(0,p$h,"x",function(){return this._x},function(p$h){this._sprite&&(this._sprite.x=p$h),this._x=p$h}),p$L(0,p$h,"y",function(){return this._y},function(p$h){this._sprite&&(this._sprite.y=p$h),this._y=p$h}),p$L(0,p$h,"height",function(){return this._h},function(p$h){this._h=p$h}),p$$._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function p$q(){}p$C(p$q,"laya.utils.Log"),p$q.enable=function(){p$q._logdiv||(p$q._logdiv=p$w.window.document.createElement("div"),p$w.window.document.body.appendChild(p$q._logdiv),p$q._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},p$q.toggle=function(){var p$h=p$q._logdiv.style;"1px"==p$h.width?p$h.width=p$h.height="50%":p$h.width=p$h.height="1px"},p$q.print=function(p$h){p$q._logdiv&&(p$q.maxCount<=p$q._count&&p$q.clear(),p$q._count++,p$q._logdiv.innerText+=p$h+"\n",p$q._logdiv.scrollTop=p$q._logdiv.scrollHeight)},p$q.clear=function(){p$q._logdiv.innerText="",p$q._count=0},p$q._logdiv=null,p$q._count=0,p$q.maxCount=20}(),function(){function p$q(){}p$C(p$q,"laya.utils.Mouse"),p$L(1,p$q,"cursor",function(){return p$q._style.cursor},function(p$h){p$q._style.cursor=p$h}),p$q.hide=function(){"none"!=p$q.cursor&&(p$q._preCursor=p$q.cursor,p$q.cursor="none")},p$q.show=function(){"none"==p$q.cursor&&(p$q.cursor=p$q._preCursor?p$q._preCursor:"auto")},p$q._preCursor=null,p$r(p$q,["_style",function(){return this._style=p$w.document.body.style}])}(),function(){function p$P(){}return p$C(p$P,"laya.utils.Pool"),p$P.getPoolBySign=function(p$h){return p$P._poolDic[p$h]||(p$P._poolDic[p$h]=[])},p$P.clearBySign=function(p$h){p$P._poolDic[p$h]&&(p$P._poolDic[p$h].length=0)},p$P.recover=function(p$h,p$q){p$q.__InPool||(p$q.__InPool=!0,p$P.getPoolBySign(p$h).push(p$q))},p$P.getItemByClass=function(p$h,p$q){var p$f=p$P.getPoolBySign(p$h),p$g=p$f.length?p$f.pop():new p$q;return p$g.__InPool=!1,p$g},p$P.getItemByCreateFun=function(p$h,p$q,p$f){var p$g=p$P.getPoolBySign(p$h),p$$=p$g.length?p$g.pop():p$q.call(p$f);return p$$.__InPool=!1,p$$},p$P.getItem=function(p$h){var p$q=p$P.getPoolBySign(p$h),p$f=p$q.length?p$q.pop():null;return p$f&&(p$f.__InPool=!1),p$f},p$P._poolDic={},p$P.InPoolSign="__InPool",p$P}()),p$Z=function(){function p$r(){}return p$C(p$r,"laya.utils.Stat"),p$L(1,p$r,"onclick",null,function(p$h){p$r._sp&&p$r._sp.on("click",p$r._sp,p$h),p$r._canvas&&(p$r._canvas.source.onclick=p$h,p$r._canvas.source.style.pointerEvents="")}),p$r.show=function(p$h,p$q,p$f){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),!p$c.isConchApp||p$c.isConchWebGL){if(p$c.isConchWebGL||p$w.onMiniGame||p$w.onLimixiu||(p$r._useCanvas=!0),p$r._show=!0,p$r._fpsData.length=60,p$r._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},p$r._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},p$r._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},p$r._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},p$c.isWebGL)if(p$r._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},p$c.is3DMode){if(p$r._view[0].title="FPS(3D)",p$r._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},p$r._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},p$r._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==p$f){var p$g=8;p$r._view[p$g++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},p$r._view[p$g++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},p$r._view[p$g++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},p$r._view[p$g++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},p$r._view[p$g++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},p$r._view[p$g++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},p$r._view[p$g++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},p$r._view[p$g++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},p$r._view[p$g++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==p$f){p$g=8;p$r._view[p$g++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},p$r._view[p$g++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},p$r._view[p$g++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},p$r._view[p$g++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},p$r._view[p$g++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},p$r._view[p$g++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},p$r._view[p$g++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else p$r._view[0].title="FPS(WebGL)",p$r._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else p$r._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};p$r._useCanvas?p$r.createUIPre(p$h,p$q):p$r.createUI(p$h,p$q),p$r.enable()}else p$w.window.conch.showFPS&&p$w.window.conch.showFPS(p$h,p$q)},p$r.createUIPre=function(p$h,p$q){var p$f=p$w.pixelRatio;p$r._width=170*p$f,p$r._vx=75*p$f,p$r._height=p$f*(12*p$r._view.length+3*p$f)+4,p$r._fontSize=12*p$f;for(var p$g=0;p$g<p$r._view.length;p$g++)p$r._view[p$g].x=4,p$r._view[p$g].y=p$g*p$r._fontSize+2*p$f;p$r._canvas||((p$r._canvas=new p$Gh("2D")).size(p$r._width,p$r._height),(p$r._ctx=p$r._canvas.getContext("2d")).textBaseline="top",p$r._ctx.font=p$r._fontSize+"px Sans-serif",p$r._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+p$h+"px;top:"+p$q+"px;width:"+p$r._width/p$f+"px;height:"+p$r._height/p$f+"px;"),p$r._first=!0,p$r.loop(),p$r._first=!1,p$w.container.appendChild(p$r._canvas.source)},p$r.createUI=function(p$h,p$q){var p$f=p$r._sp,p$g=p$w.pixelRatio;p$f||(p$f=new p$Uh,(p$r._leftText=new p$lh).pos(5,5),p$r._leftText.color="#ffffff",p$f.addChild(p$r._leftText),(p$r._txt=new p$lh).pos(80*p$g,5),p$r._txt.color="#ffffff",p$f.addChild(p$r._txt),p$r._sp=p$f),p$f.pos(p$h,p$q);for(var p$$="",p$P=0;p$P<p$r._view.length;p$P++){p$$+=p$r._view[p$P].title+"\n"}p$r._leftText.text=p$$;var p$S=170*p$g,p$B=p$g*(12*p$r._view.length+3*p$g)+4;p$r._txt.fontSize=p$r._fontSize*p$g,p$r._leftText.fontSize=p$r._fontSize*p$g,p$f.size(p$S,p$B),p$f.graphics.clear(),p$f.graphics.setAlpha(.5),p$f.graphics.drawRect(0,0,p$S,p$B,"#999999"),p$f.graphics.setAlpha(1),p$r.loop()},p$r.enable=function(){p$t.timer.frameLoop(1,p$r,p$r.loop)},p$r.hide=function(){p$r._show=!1,p$t.timer.clear(p$r,p$r.loop),p$r._canvas&&p$w.removeElement(p$r._canvas.source)},p$r.clear=function(){p$r.trianglesFaces=p$r.drawCall=p$r.shaderCall=p$r.spriteCount=p$r.spriteRenderUseCacheCount=p$r.treeNodeCollision=p$r.treeSpriteCollision=p$r.canvasNormal=p$r.canvasBitmap=p$r.canvasReCache=0},p$r.loop=function(){p$r._count++;var p$h=p$w.now();if(!(p$h-p$r._timer<1e3)){var p$q=p$r._count;if(p$r.FPS=Math.round(1e3*p$q/(p$h-p$r._timer)),p$r._show){p$r.trianglesFaces=Math.round(p$r.trianglesFaces/p$q),p$r.spriteCount=p$r._useCanvas?(p$r.drawCall=Math.round(p$r.drawCall/p$q)-2,p$r.shaderCall=Math.round(p$r.shaderCall/p$q),Math.round(p$r.spriteCount/p$q)-1):(p$r.drawCall=Math.round(p$r.drawCall/p$q)-2,p$r.shaderCall=Math.round(p$r.shaderCall/p$q)-4,Math.round(p$r.spriteCount/p$q)-4),p$r.spriteRenderUseCacheCount=Math.round(p$r.spriteRenderUseCacheCount/p$q),p$r.canvasNormal=Math.round(p$r.canvasNormal/p$q),p$r.canvasBitmap=Math.round(p$r.canvasBitmap/p$q),p$r.canvasReCache=Math.ceil(p$r.canvasReCache/p$q),p$r.treeNodeCollision=Math.round(p$r.treeNodeCollision/p$q),p$r.treeSpriteCollision=Math.round(p$r.treeSpriteCollision/p$q);var p$f=0<p$r.FPS?Math.floor(1e3/p$r.FPS).toString():" ";p$r._fpsStr=p$r.FPS+(p$r.renderSlow?" slow":"")+" "+p$f,p$r._spriteStr=p$r.spriteCount+(p$r.spriteRenderUseCacheCount?"/"+p$r.spriteRenderUseCacheCount:""),p$r._canvasStr=p$r.canvasReCache+"/"+p$r.canvasNormal+"/"+p$r.canvasBitmap,p$r.currentMemorySize=p$I.systemResourceManager.memorySize,p$r._useCanvas?p$r.renderInfoPre():p$r.renderInfo(),p$r.clear()}p$r._count=0,p$r._timer=p$h}},p$r.renderInfoPre=function(){if(p$r._canvas){var p$h=p$r._ctx;p$h.clearRect(p$r._first?0:p$r._vx,0,p$r._width,p$r._height);for(var p$q=p$c.WebGL.mainContext,p$f=0;p$f<p$r._view.length;p$f++){var p$g=p$r._view[p$f];p$r._first&&(p$h.fillStyle="white",p$h.fillText(p$g.title,p$g.x,p$g.y,null,null,null)),p$h.fillStyle=p$g.color;var p$$=-1;if((p$g=p$r._view[p$f]).varying){if(p$q)switch(p$g.varying){case 1:p$$=p$q.getParameter(p$q[p$g.value]);break;case 2:p$$=p$q.getExtension(p$g.value)}}else p$$=p$r[p$g.value];"M"==p$g.units&&(p$$=Math.floor(p$$/1048576*100)/100+" M"),"K"==p$g.units&&(p$$=Math.floor(p$$/1024*100)/100+" K"),"string"==p$g.units&&(p$$=p$$.match(/\d+\.?\d/i)),p$h.fillText(p$$+"",p$g.x+p$r._vx,p$g.y,null,null,null)}}},p$r.renderInfo=function(){for(var p$h="",p$q=p$c.WebGL.mainContext,p$f=0;p$f<p$r._view.length;p$f++){var p$g=p$r._view[p$f],p$$=-1;if(p$g.varying){if(p$q)switch(p$g.varying){case 1:p$$=p$q.getParameter(p$q[p$g.value]);break;case 2:p$$=p$q.getExtension(p$g.value)}}else p$$=p$r[p$g.value];"M"==p$g.units&&(p$$=Math.floor(p$$/1048576*100)/100+" M"),"K"==p$g.units&&(p$$=Math.floor(p$$/1024*100)/100+" K"),"string"==p$g.units&&(p$$=p$$.match(/\d+\.?\d/i)),p$h+=p$$+"\n"}p$r._txt.text=p$h},p$r.FPS=0,p$r.loopCount=0,p$r.shaderCall=0,p$r.drawCall=0,p$r.trianglesFaces=0,p$r.spriteCount=0,p$r.spriteRenderUseCacheCount=0,p$r.treeNodeCollision=0,p$r.treeSpriteCollision=0,p$r.canvasNormal=0,p$r.canvasBitmap=0,p$r.canvasReCache=0,p$r.renderSlow=!1,p$r.currentMemorySize=0,p$r._fpsStr=null,p$r._canvasStr=null,p$r._spriteStr=null,p$r._fpsData=[],p$r._timer=0,p$r._count=0,p$r._view=[],p$r._fontSize=12,p$r._txt=null,p$r._leftText=null,p$r._sp=null,p$r._show=!1,p$r._useCanvas=!1,p$r._canvas=null,p$r._ctx=null,p$r._first=!1,p$r._vx=NaN,p$r._width=0,p$r._height=100,p$r}(),p$Q=(function(){function p$h(){this._strsToID={},this._idToStrs=[],this._length=0}p$C(p$h,"laya.utils.StringKey");var p$q=p$h.prototype;p$q.add=function(p$h){var p$q=this._strsToID[p$h];return null!=p$q?p$q:(this._idToStrs[this._length]=p$h,this._strsToID[p$h]=this._length++)},p$q.getID=function(p$h){var p$q=this._strsToID[p$h];return null==p$q?-1:p$q},p$q.getName=function(p$h){var p$q=this._idToStrs[p$h];return null==p$q?void 0:p$q}}(),function(){var p$Y;function p$h(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}p$C(p$h,"laya.utils.Timer");var p$q=p$h.prototype;return p$q._init=function(){p$t.timer&&p$t.timer.frameLoop(1,this,this._update)},p$q._now=function(){return Date.now()},p$q._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var p$h=this.currFrame=this.currFrame+this.scale,p$q=this._now();this._delta=(p$q-this._lastTimer)*this.scale;var p$f=this.currTimer=this.currTimer+this._delta;p$t.isDebug&&6e4<Math.abs(p$q-this._lastTimer)&&console.error("系统时间错误！"+(p$q-this._lastTimer)),this._lastTimer=p$q;var p$g=this._handlers;for(p$S=this._count=0,p$B=p$g.length;p$S<p$B;p$S++)if(null!==(p$r=p$g[p$S]).method){var p$$=p$r.userFrame?p$h:p$f;if(p$$>=p$r.exeTime)if(p$r.repeat)if(p$r.jumpFrame)for(;p$$>=p$r.exeTime;)p$r.exeTime+=p$r.delay,p$r.run(!1);else p$r.exeTime+=p$r.delay,p$r.run(!1),p$$>p$r.exeTime&&(p$r.exeTime+=Math.ceil((p$$-p$r.exeTime)/p$r.delay)*p$r.delay);else p$r.run(!0)}else this._count++;(30<this._count||p$h%200==0)&&this._clearHandlers();for(var p$P=this._laters,p$S=0,p$B=p$P.length-1;p$S<=p$B;p$S++){var p$r=p$P[p$S];this._isIgnoreRecover(p$r)||(null!==p$r.method&&(delete this._map[p$r.key],p$r.run(!1)),this._recoverHandler(p$r)),p$S===p$B&&(p$B=p$P.length-1)}p$P.length=0}},p$q._clearHandlers=function(){for(var p$h=this._handlers,p$q=0,p$f=p$h.length;p$q<p$f;p$q++){var p$g=p$h[p$q];null!==p$g.method?this._temp.push(p$g):this._isIgnoreRecover(p$g)?this._temp.push(p$g):this._recoverHandler(p$g)}this._handlers=this._temp,this._temp=p$h,this._temp.length=0},p$q._recoverHandler=function(p$h){this._map[p$h.key]==p$h&&delete this._map[p$h.key],p$h.recover()},p$q._create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){if(!p$f)return p$$.apply(p$g,p$P),null;if(p$S){var p$r=this._getHandler(p$g,p$$);if(p$r)return p$r.repeat=p$q,p$r.userFrame=p$h,p$r.delay=p$f,p$r.ignoreRecover=p$B,p$r.caller=p$g,p$r.method=p$$,p$r.args=p$P,p$r.exeTime=p$f+(p$h?this.currFrame:this.currTimer+this._now()-this._lastTimer),p$r}return(p$r=p$Y.create()).repeat=p$q,p$r.userFrame=p$h,p$r.delay=p$f,p$r.ignoreRecover=p$B,p$r.caller=p$g,p$r.method=p$$,p$r.args=p$P,p$r.exeTime=p$f+(p$h?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(p$r),this._handlers.push(p$r),p$r},p$q._indexHandler=function(p$h){var p$q=p$h.caller,p$f=p$h.method,p$g=p$q?p$q.$_GID||(p$q.$_GID=p$O.getGID()):0,p$$=p$f.$_TID||(p$f.$_TID=this._mid++);p$h.key=p$g+"_"+p$$,this._map[p$h.key]=p$h},p$q.once=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=!0),this._create(!1,!1,p$h,p$q,p$f,p$g,p$$,!1)},p$q.loop=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){void 0===p$$&&(p$$=!0),void 0===p$P&&(p$P=!1),void 0===p$S&&(p$S=!1);var p$B=this._create(!1,!0,p$h,p$q,p$f,p$g,p$$,p$S);p$B&&(p$B.jumpFrame=p$P)},p$q.frameOnce=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=!0),this._create(!0,!1,p$h,p$q,p$f,p$g,p$$,!1)},p$q.frameLoop=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$$&&(p$$=!0),void 0===p$P&&(p$P=!1),this._create(!0,!0,p$h,p$q,p$f,p$g,p$$,p$P)},p$q.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+p$Y._freeCount},p$q.clear=function(p$h,p$q){var p$f=this._getHandler(p$h,p$q);return!(!p$f||this._isIgnoreRecover(p$f))&&(delete this._map[p$f.key],p$f.key=null,p$f.clear(),!0)},p$q.clearAll=function(p$h){if(p$h)for(var p$q=0,p$f=this._handlers.length;p$q<p$f;p$q++){var p$g=this._handlers[p$q];p$g.caller===p$h&&(this._isIgnoreRecover(p$g)||(delete this._map[p$g.key],p$g.key=null,p$g.clear()))}},p$q._getHandler=function(p$h,p$q){var p$f=p$h?p$h.$_GID||(p$h.$_GID=p$O.getGID()):0,p$g=p$q.$_TID||(p$q.$_TID=this._mid++);return this._map[p$f+"_"+p$g]},p$q._isIgnoreRecover=function(p$h){if(p$h.ignoreRecover||p$h.caller&&"IgnoreRecover"==p$h.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var p$q="";try{arguments.propertyIsEnumerable.caller}catch(p$h){p$q=p$h.stack}p$t.recordError("报错：核心定时器销毁忽略  "+p$q)}return!0}return!1},p$q.hasHandler=function(p$h,p$q){return this._map[p$h.$_GID+"_"+p$q.$_TID]},p$q.callLater=function(p$h,p$q,p$f){if(null==this._getHandler(p$h,p$q)){var p$g=p$Y.create();p$g.caller=p$h,p$g.method=p$q,p$g.args=p$f,this._indexHandler(p$g),this._laters.push(p$g)}},p$q.runCallLater=function(p$h,p$q){var p$f=this._getHandler(p$h,p$q);p$f&&null!=p$f.method&&(this._isIgnoreRecover(p$f)||(delete this._map[p$f.key],p$f.run(!0)))},p$q.runTimer=function(p$h,p$q){this.runCallLater(p$h,p$q)},p$L(0,p$q,"delta",function(){return this._delta}),p$h.__init$=function(){p$Y=function(){function p$q(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}p$C(p$q,"");var p$h=p$q.prototype;return p$h.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},p$h.recover=function(){this.clear(),this.args=p$q._freeHandler,p$q._freeHandler=this,p$q._freeCount++},p$h.run=function(p$h){var p$q=this.caller;if(p$q&&p$q.destroyed)return this.clear();var p$f=this.method,p$g=this.args;p$h&&this.clear(),null!=p$f&&(p$g?p$f.apply(p$q,p$g):p$f.call(p$q))},p$q._freeHandler=null,p$q._freeCount=0,p$q.create=function(){var p$h=p$q._freeHandler;return p$h?(p$q._freeHandler=p$h.args,--p$q._freeCount,p$h.args=null,p$h):new p$q},p$q}()},p$h}()),p$o=function(){function p$U(){this.gid=0}p$C(p$U,"laya.utils.Tween");var p$h=p$U.prototype;return p$h.to=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){return void 0===p$P&&(p$P=0),void 0===p$S&&(p$S=!1),this._create(p$h,p$q,p$f,p$g,p$$,p$P,p$S,!0,!1,!0)},p$h.from=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){return void 0===p$P&&(p$P=0),void 0===p$S&&(p$S=!1),this._create(p$h,p$q,p$f,p$g,p$$,p$P,p$S,!1,!1,!0)},p$h._create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){if(!p$h)throw new Error("Tween:target is null");this._target=p$h,this._duration=p$f,this._ease=p$g||p$q.ease||p$U.easeNone,this._complete=p$$||p$q.complete,this._delay=p$P,this._props=[],this._usedTimer=0,this._startTimer=p$w.now(),this._usedPool=p$r,this._delayParam=null,this.update=p$q.update;var p$C=p$h.$_GID||(p$h.$_GID=p$O.getGID());return p$U.tweenMap[p$C]?(p$S&&p$U.clearTween(p$h),p$U.tweenMap[p$C].push(this)):p$U.tweenMap[p$C]=[this],p$Y?p$P<=0?this.firstStart(p$h,p$q,p$B):(this._delayParam=[p$h,p$q,p$B],p$t.scaleTimer.once(p$P,this,this.firstStart,this._delayParam)):this._initProps(p$h,p$q,p$B),this},p$h.firstStart=function(p$h,p$q,p$f){this._delayParam=null,p$h.destroyed?this.clear():(this._initProps(p$h,p$q,p$f),this._beginLoop())},p$h._initProps=function(p$h,p$q,p$f){for(var p$g in p$q)if("number"==typeof p$h[p$g]){var p$$=p$f?p$h[p$g]:p$q[p$g],p$P=p$f?p$q[p$g]:p$h[p$g];this._props.push([p$g,p$$,p$P-p$$]),p$f||(p$h[p$g]=p$$)}},p$h._beginLoop=function(){p$t.scaleTimer.frameLoop(1,this,this._doEase)},p$h._doEase=function(){this._updateEase(p$w.now())},p$h._updateEase=function(p$h){var p$q=this._target;if(p$q){if(p$q.destroyed)return p$U.clearTween(p$q);var p$f=this._usedTimer=p$h-this._startTimer-this._delay;if(!(p$f<0)){if(p$f>=this._duration)return this.complete();for(var p$g=0<p$f?this._ease(p$f,0,1,this._duration):0,p$$=this._props,p$P=0,p$S=p$$.length;p$P<p$S;p$P++){var p$B=p$$[p$P];p$q[p$B[0]]=p$B[1]+p$g*p$B[2]}this.update&&this.update.run()}}},p$h.complete=function(){if(this._target){p$t.scaleTimer.runTimer(this,this.firstStart);for(var p$h=this._target,p$q=this._props,p$f=this._complete,p$g=0,p$$=p$q.length;p$g<p$$;p$g++){var p$P=p$q[p$g];p$h[p$P[0]]=p$P[1]+p$P[2]}this.update&&this.update.run(),this.clear(),p$f&&p$f.run()}},p$h.pause=function(){p$t.scaleTimer.clear(this,this._beginLoop),p$t.scaleTimer.clear(this,this._doEase),p$t.scaleTimer.clear(this,this.firstStart);var p$h;(p$h=p$w.now()-this._startTimer-this._delay)<0&&(this._usedTimer=p$h)},p$h.setStartTime=function(p$h){this._startTimer=p$h},p$h.clear=function(){this._target&&(this._remove(),this._clear())},p$h._clear=function(){this.pause(),p$t.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,p$F.recover("tween",this))},p$h.recover=function(){this._usedPool=!0,this._clear()},p$h._remove=function(){var p$h=p$U.tweenMap[this._target.$_GID];if(p$h)for(var p$q=0,p$f=p$h.length;p$q<p$f;p$q++)if(p$h[p$q]===this){p$h.splice(p$q,1);break}},p$h.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=p$w.now(),this._delayParam)p$t.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var p$h=this._props,p$q=0,p$f=p$h.length;p$q<p$f;p$q++){var p$g=p$h[p$q];this._target[p$g[0]]=p$g[1]}p$t.scaleTimer.once(this._delay,this,this._beginLoop)}},p$h.resume=function(){this._usedTimer>=this._duration||(this._startTimer=p$w.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?p$t.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},p$L(0,p$h,"progress",null,function(p$h){var p$q=p$h*this._duration;this._startTimer=p$w.now()-this._delay-p$q}),p$U.to=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){return void 0===p$P&&(p$P=0),void 0===p$S&&(p$S=!1),void 0===p$B&&(p$B=!0),p$F.getItemByClass("tween",p$U)._create(p$h,p$q,p$f,p$g,p$$,p$P,p$S,!0,p$B,!0)},p$U.from=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){return void 0===p$P&&(p$P=0),void 0===p$S&&(p$S=!1),void 0===p$B&&(p$B=!0),p$F.getItemByClass("tween",p$U)._create(p$h,p$q,p$f,p$g,p$$,p$P,p$S,!1,p$B,!0)},p$U.clearAll=function(p$h){if(p$h&&p$h.$_GID){var p$q=p$U.tweenMap[p$h.$_GID];if(p$q){for(var p$f=0,p$g=p$q.length;p$f<p$g;p$f++)p$q[p$f]._clear();p$q.length=0}}},p$U.clear=function(p$h){p$h.clear()},p$U.clearTween=function(p$h){p$U.clearAll(p$h)},p$U.easeNone=function(p$h,p$q,p$f,p$g){return p$f*p$h/p$g+p$q},p$U.tweenMap={},p$U}(),p$O=function(){function p$B(){}return p$C(p$B,"laya.utils.Utils"),p$B.toRadian=function(p$h){return p$h*p$B._pi2},p$B.toAngle=function(p$h){return p$h*p$B._pi},p$B.toHexColor=function(p$h){if(p$h<0||isNaN(p$h))return null;for(var p$q=p$h.toString(16);p$q.length<6;)p$q="0"+p$q;return"#"+p$q},p$B.getGID=function(){return p$B._gid++},p$B.concatArray=function(p$h,p$q){if(!p$q)return p$h;if(!p$h)return p$q;var p$f=0,p$g=p$q.length;for(p$f=0;p$f<p$g;p$f++)p$h.push(p$q[p$f]);return p$h},p$B.clearArray=function(p$h){return p$h&&(p$h.length=0),p$h},p$B.copyArray=function(p$h,p$q){if(p$h||(p$h=[]),!p$q)return p$h;p$h.length=p$q.length;var p$f=0,p$g=p$q.length;for(p$f=0;p$f<p$g;p$f++)p$h[p$f]=p$q[p$f];return p$h},p$B.getGlobalRecByPoints=function(p$h,p$q,p$f,p$g,p$$){var p$P,p$S;return p$P=new p$X(p$q,p$f),p$P=p$h.localToGlobal(p$P),p$S=new p$X(p$g,p$$),p$S=p$h.localToGlobal(p$S),p$n._getWrapRec([p$P.x,p$P.y,p$S.x,p$S.y])},p$B.getGlobalPosAndScale=function(p$h){return p$B.getGlobalRecByPoints(p$h,0,0,1,1)},p$B.bind=function(p$h,p$q){return p$h.bind(p$q)},p$B.measureText=function(p$h,p$q){return p$d.measureText(p$h,p$q)},p$B.updateOrder=function(p$h){if(!p$h||p$h.length<2)return!1;for(var p$q,p$f=1,p$g=0,p$$=p$h.length,p$P=NaN;p$f<p$$;){for(p$q=p$h[p$g=p$f],p$P=p$h[p$g]._zOrder;-1<--p$g&&p$h[p$g]._zOrder>p$P;)p$h[p$g+1]=p$h[p$g];p$h[p$g+1]=p$q,p$f++}var p$S=p$q.parent.conchModel;if(p$S)if(null!=p$S.updateZOrder)p$S.updateZOrder();else{for(p$f=0;p$f<p$$;p$f++)p$S.removeChild(p$h[p$f].conchModel);for(p$f=0;p$f<p$$;p$f++)p$S.addChildAt(p$h[p$f].conchModel,p$f)}return!0},p$B.transPointList=function(p$h,p$q,p$f){var p$g=0,p$$=p$h.length;for(p$g=0;p$g<p$$;p$g+=2)p$h[p$g]+=p$q,p$h[p$g+1]+=p$f},p$B.parseInt=function(p$h,p$q){void 0===p$q&&(p$q=0);var p$f=p$w.window.parseInt(p$h,p$q);return isNaN(p$f)?0:p$f},p$B.getFileExtension=function(p$h){p$B._extReg.lastIndex=p$h.lastIndexOf(".");var p$q=p$B._extReg.exec(p$h);return p$q&&1<p$q.length?p$q[1].toLowerCase():null},p$B.getTransformRelativeToWindow=function(p$h,p$q,p$f){var p$g=p$t.stage,p$$=laya.utils.Utils.getGlobalPosAndScale(p$h),p$P=p$g._canvasTransform.clone(),p$S=p$P.tx,p$B=p$P.ty;p$P.rotate(-Math.PI/180*p$t.stage.canvasDegree),p$P.scale(p$t.stage.clientScaleX,p$t.stage.clientScaleY);var p$r=p$t.stage.canvasDegree%180!=0,p$Y=NaN,p$C=NaN;p$r?(p$Y=p$f+p$$.y,p$C=p$q+p$$.x,p$Y*=p$P.d,p$C*=p$P.a,90==p$t.stage.canvasDegree?(p$Y=p$S-p$Y,p$C+=p$B):(p$Y+=p$S,p$C=p$B-p$C)):(p$Y=p$q+p$$.x,p$C=p$f+p$$.y,p$Y*=p$P.a,p$C*=p$P.d,p$Y+=p$S,p$C+=p$B);var p$U=NaN,p$u=NaN;return p$u=p$r?(p$U=p$P.d*p$$.height,p$P.a*p$$.width):(p$U=p$P.a*p$$.width,p$P.d*p$$.height),{x:p$Y,y:p$C,scaleX:p$U,scaleY:p$u}},p$B.fitDOMElementInArea=function(p$h,p$q,p$f,p$g,p$$,p$P){p$h._fitLayaAirInitialized||(p$h._fitLayaAirInitialized=!0,p$h.style.transformOrigin=p$h.style.webKittransformOrigin="left top",p$h.style.position="absolute");var p$S=p$B.getTransformRelativeToWindow(p$q,p$f,p$g);p$h.style.transform=p$h.style.webkitTransform="scale("+p$S.scaleX+","+p$S.scaleY+") rotate("+p$t.stage.canvasDegree+"deg)",p$h.style.width=p$$+"px",p$h.style.height=p$P+"px",p$h.style.left=p$S.x+"px",p$h.style.top=p$S.y+"px"},p$B.isOkTextureList=function(p$h){if(!p$h)return!1;var p$q,p$f=0,p$g=p$h.length;for(p$f=0;p$f<p$g;p$f++)if(!(p$q=p$h[p$f])||!p$q.source)return!1;return!0},p$B.isOKCmdList=function(p$h){if(!p$h)return!1;var p$q,p$f,p$g=0,p$$=p$h.length,p$P=p$c._context;for(p$g=0;p$g<p$$;p$g++)switch((p$q=p$h[p$g]).callee){case p$P._drawTexture:case p$P._fillTexture:case p$P._drawTextureWithTransform:if(!(p$f=p$q[0])||!p$f.source)return!1}return!0},p$B._gid=1,p$B._pi=180/Math.PI,p$B._pi2=Math.PI/180,p$B._extReg=/\.(\w+)\??/g,p$B.parseXMLFromString=function(p$h){var p$q;if(p$h=p$h.replace(/>\s+</g,"><"),-1<(p$q=(new DOMParser).parseFromString(p$h,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(p$q.firstChild.firstChild.textContent);return p$q},p$B}(),p$j=function(){function p$h(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],p$c.isWebGL&&p$H.regCacheByFunction(p$O.bind(this.startDispose,this),p$O.bind(this.getCacheList,this))}p$C(p$h,"laya.utils.VectorGraphManager");var p$q=p$h.prototype;return p$q.getId=function(){return this._id++},p$q.addShape=function(p$h,p$q){this.shapeDic[p$h]=p$q,this.useDic[p$h]||(this.useDic[p$h]=!0)},p$q.addLine=function(p$h,p$q){this.shapeLineDic[p$h]=p$q,this.shapeLineDic[p$h]||(this.shapeLineDic[p$h]=!0)},p$q.getShape=function(p$h){this._checkKey&&null!=this.useDic[p$h]&&(this.useDic[p$h]=!0)},p$q.deleteShape=function(p$h){this.shapeDic[p$h]&&(this.shapeDic[p$h]=null,delete this.shapeDic[p$h]),this.shapeLineDic[p$h]&&(this.shapeLineDic[p$h]=null,delete this.shapeLineDic[p$h]),null!=this.useDic[p$h]&&delete this.useDic[p$h]},p$q.getCacheList=function(){var p$h,p$q=[];for(p$h in this.shapeDic)p$q.push(this.shapeDic[p$h]);for(p$h in this.shapeLineDic)p$q.push(this.shapeLineDic[p$h]);return p$q},p$q.startDispose=function(p$h){var p$q;for(p$q in this.useDic)this.useDic[p$q]=!1;this._checkKey=!0},p$q.endDispose=function(){if(this._checkKey){var p$h;for(p$h in this.useDic)this.useDic[p$h]||this.deleteShape(p$h);this._checkKey=!1}},p$h.getInstance=function(){return p$h.instance=p$h.instance||new p$h},p$h.instance=null,p$h}(),p$x=function(){function p$g(){this._obj=null,this._obj=p$g.supportWeakMap?new p$w.window.WeakMap:{},p$g.supportWeakMap||p$g._maps.push(this)}p$C(p$g,"laya.utils.WeakObject");var p$h=p$g.prototype;return p$h.set=function(p$h,p$q){if(null!=p$h)if(p$g.supportWeakMap){var p$f=p$h;"string"!=typeof p$h&&"number"!=typeof p$h||(p$f=p$g._keys[p$h])||(p$f=p$g._keys[p$h]={k:p$h}),this._obj.set(p$f,p$q)}else"string"==typeof p$h||"number"==typeof p$h?this._obj[p$h]=p$q:(p$h.$_GID||(p$h.$_GID=p$O.getGID()),this._obj[p$h.$_GID]=p$q)},p$h.get=function(p$h){if(null==p$h)return null;if(p$g.supportWeakMap){var p$q="string"==typeof p$h||"number"==typeof p$h?p$g._keys[p$h]:p$h;return p$q?this._obj.get(p$q):null}return"string"==typeof p$h||"number"==typeof p$h?this._obj[p$h]:this._obj[p$h.$_GID]},p$h.del=function(p$h){if(null!=p$h)if(p$g.supportWeakMap){var p$q="string"==typeof p$h||"number"==typeof p$h?p$g._keys[p$h]:p$h;if(!p$q)return;this._obj.delete(p$q)}else"string"==typeof p$h||"number"==typeof p$h?delete this._obj[p$h]:delete this._obj[this._obj.$_GID]},p$h.has=function(p$h){if(null==p$h)return!1;if(p$g.supportWeakMap){var p$q="string"==typeof p$h||"number"==typeof p$h?p$g._keys[p$h]:p$h;return this._obj.has(p$q)}return"string"==typeof p$h||"number"==typeof p$h?null!=this._obj[p$h]:null!=this._obj[this._obj.$_GID]},p$g.__init__=function(){(p$g.supportWeakMap=null!=p$w.window.WeakMap)||p$t.timer.loop(p$g.delInterval,null,p$g.clearCache)},p$g.clearCache=function(){for(var p$h=0,p$q=p$g._maps.length;p$h<p$q;p$h++){p$g._maps[p$h]._obj={}}},p$g.supportWeakMap=!1,p$g.delInterval=3e5,p$g._keys={},p$g._maps=[],p$r(p$g,["I",function(){return this.I=new p$g}]),p$g}(),p$a=function(){function p$h(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}p$C(p$h,"laya.utils.WordText");var p$q=p$h.prototype;return p$q.setText=function(p$h){this.changed=!0,this._text=p$h},p$q.toString=function(){return this._text},p$q.charCodeAt=function(p$h){return this._text?this._text.charCodeAt(p$h):NaN},p$q.charAt=function(p$h){return this._text?this._text.charAt(p$h):null},p$L(0,p$q,"length",function(){return this._text?this._text.length:0}),p$h}(),p$hh=function(p$h){function p$S(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,p$S.__super.call(this),this._childs=p$S.ARRAY_EMPTY,this._$P=p$S.PROP_EMPTY,this.timer=p$t.scaleTimer,this.conchModel=p$c.isConchNode?this.createConchModel():null}p$C(p$S,"laya.display.Node",p$Y);var p$q=p$S.prototype;return p$q._setBit=function(p$h,p$q){1==p$h&&(this._getBit(p$h)!=p$q&&this._updateDisplayedInstage());p$q?this._bits|=p$h:this._bits&=~p$h},p$q._getBit=function(p$h){return 0!=(this._bits&p$h)},p$q._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},p$q._setUpNoticeType=function(p$h){var p$q=this;for(p$q._setBit(p$h,!0),p$q=p$q.parent;p$q;){if(p$q._getBit(p$h))return;p$q._setBit(p$h,!0),p$q=p$q.parent}},p$q.on=function(p$h,p$q,p$f,p$g){return"display"!==p$h&&"undisplay"!==p$h||this._getBit(1)||this._setUpNoticeType(1),this._createListener(p$h,p$q,p$f,p$g,!1)},p$q.once=function(p$h,p$q,p$f,p$g){return"display"!==p$h&&"undisplay"!==p$h||this._getBit(1)||this._setUpNoticeType(1),this._createListener(p$h,p$q,p$f,p$g,!0)},p$q.createConchModel=function(){return null},p$q.destroy=function(p$h){void 0===p$h&&(p$h=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(p$h?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},p$q.destroyChildren=function(){if(this._childs)for(var p$h=this._childs.length-1;-1<p$h;p$h--)this._childs[p$h].destroy(!0)},p$q.addChild=function(p$h){if(!p$h||this.destroyed||p$h===this)return p$h;if(p$h.zOrder&&this._set$P("hasZorder",!0),p$h._parent===this){var p$q=this.getChildIndex(p$h);p$q!==this._childs.length-1&&(this._childs.splice(p$q,1),this._childs.push(p$h),this.conchModel&&(this.conchModel.removeChild(p$h.conchModel),this.conchModel.addChildAt(p$h.conchModel,this._childs.length-1)),this._childChanged())}else p$h.parent&&p$h.parent.removeChild(p$h),this._childs===p$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(p$h),this.conchModel&&this.conchModel.addChildAt(p$h.conchModel,this._childs.length-1),(p$h.parent=this)._childChanged();return p$h},p$q.addChildren=function(p$h){for(var p$q=arguments,p$f=0,p$g=p$q.length;p$f<p$g;)this.addChild(p$q[p$f++])},p$q.addChildAt=function(p$h,p$q){if(!p$h||this.destroyed||p$h===this)return p$h;if(p$h.zOrder&&this._set$P("hasZorder",!0),0<=p$q&&p$q<=this._childs.length){if(p$h._parent===this){var p$f=this.getChildIndex(p$h);this._childs.splice(p$f,1),this._childs.splice(p$q,0,p$h),this.conchModel&&(this.conchModel.removeChild(p$h.conchModel),this.conchModel.addChildAt(p$h.conchModel,p$q)),this._childChanged()}else p$h.parent&&p$h.parent.removeChild(p$h),this._childs===p$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(p$q,0,p$h),this.conchModel&&this.conchModel.addChildAt(p$h.conchModel,p$q),p$h.parent=this;return p$h}throw new Error("appendChildAt:The index is out of bounds")},p$q.getChildIndex=function(p$h){return this._childs.indexOf(p$h)},p$q.getChildByName=function(p$h){var p$q=this._childs;if(p$q)for(var p$f=0,p$g=p$q.length;p$f<p$g;p$f++){var p$$=p$q[p$f];if(p$$.name===p$h)return p$$}return null},p$q._get$P=function(p$h){return this._$P[p$h]},p$q._set$P=function(p$h,p$q){return this.destroyed||(this._$P===p$S.PROP_EMPTY&&(this._$P={}),this._$P[p$h]=p$q),p$q},p$q.getChildAt=function(p$h){return this._childs[p$h]},p$q.setChildIndex=function(p$h,p$q){var p$f=this._childs;if(p$q<0||p$q>=p$f.length)throw new Error("setChildIndex:The index is out of bounds.");var p$g=this.getChildIndex(p$h);if(p$g<0)throw new Error("setChildIndex:node is must child of this object.");return p$f.splice(p$g,1),p$f.splice(p$q,0,p$h),this.conchModel&&(this.conchModel.removeChild(p$h.conchModel),this.conchModel.addChildAt(p$h.conchModel,p$q)),this._childChanged(),p$h},p$q._childChanged=function(p$h){},p$q.removeChild=function(p$h){if(!this._childs)return p$h;var p$q=this._childs.indexOf(p$h);return this.removeChildAt(p$q)},p$q.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},p$q.removeChildByName=function(p$h){var p$q=this.getChildByName(p$h);return p$q&&this.removeChild(p$q),p$q},p$q.removeChildAt=function(p$h){var p$q=this.getChildAt(p$h);if(p$q){for(var p$f=this._childs.length-1,p$g=p$h;p$g<p$f;++p$g)this._childs[p$g]=this._childs[p$g+1];this._childs.length=p$f,this.conchModel&&this.conchModel.removeChild(p$q.conchModel),p$q.parent=null}return p$q},p$q.removeChildren=function(p$h,p$q){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=2147483647),this._childs&&0<this._childs.length){var p$f=this._childs;if(0===p$h&&p$P<=p$q){var p$g=p$f;this._childs=p$S.ARRAY_EMPTY}else p$g=p$f.splice(p$h,p$q-p$h);for(var p$$=0,p$P=p$g.length;p$$<p$P;p$$++)p$g[p$$].parent=null,this.conchModel&&this.conchModel.removeChild(p$g[p$$].conchModel)}return this},p$q.replaceChild=function(p$h,p$q){var p$f=this._childs.indexOf(p$q);return-1<p$f?(this._childs.splice(p$f,1,p$h),this.conchModel&&(this.conchModel.removeChild(p$q.conchModel),this.conchModel.addChildAt(p$h.conchModel,p$f)),p$q.parent=null,p$h.parent=this,p$h):null},p$q._updateDisplayedInstage=function(){var p$h;p$h=this;var p$q=p$t.stage;for(this._displayedInStage=!1;p$h;){if(p$h._getBit(1)){this._displayedInStage=p$h._displayedInStage;break}if(p$h==p$q||p$h._displayedInStage){this._displayedInStage=!0;break}p$h=p$h.parent}},p$q._setDisplay=function(p$h){this._displayedInStage!==p$h&&((this._displayedInStage=p$h)?this.event("display"):this.event("undisplay"))},p$q._displayChild=function(p$h,p$q){var p$f=p$h._childs;if(p$f)for(var p$g=0;p$g<p$f.length;p$g++){var p$$=p$f[p$g];p$$&&p$$._getBit(1)&&(0<p$$._childs.length?this._displayChild(p$$,p$q):p$$._setDisplay(p$q))}p$h._setDisplay(p$q)},p$q.contains=function(p$h){if(p$h===this)return!0;for(;p$h;){if(p$h.parent===this)return!0;p$h=p$h.parent}return!1},p$q.timerLoop=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$$&&(p$$=!0),void 0===p$P&&(p$P=!1),this.timer.loop(p$h,p$q,p$f,p$g,p$$,p$P)},p$q.timerOnce=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=!0),this.timer._create(!1,!1,p$h,p$q,p$f,p$g,p$$)},p$q.frameLoop=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=!0),this.timer._create(!0,!0,p$h,p$q,p$f,p$g,p$$)},p$q.frameOnce=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=!0),this.timer._create(!0,!1,p$h,p$q,p$f,p$g,p$$)},p$q.clearTimer=function(p$h,p$q){this.timer.clear(p$h,p$q)},p$L(0,p$q,"numChildren",function(){return this._childs.length}),p$L(0,p$q,"destroyed",function(){return this._destroyed}),p$L(0,p$q,"parent",function(){return this._parent},function(p$h){this._parent!==p$h&&(p$h?(this._parent=p$h,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),p$h.displayedInStage&&this._displayChild(this,!0)),p$h._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=p$h))}),p$L(0,p$q,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),p$S.ARRAY_EMPTY=[],p$S.PROP_EMPTY={},p$S.NOTICE_DISPLAY=1,p$S.MOUSEENABLE=2,p$S}(),p$qh=function(p$h){function p$u(p$h){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,p$u.__super.call(this),this._padding=p$u._PADDING,this._spacing=p$u._SPACING,this._aligns=p$u._ALIGNS,this._font=p$v.EMPTY,this._ower=p$h}p$C(p$u,"laya.display.css.CSSStyle",p$h);var p$q=p$u.prototype;return p$q.destroy=function(){this._ower=null,this._font=null,this._rect=null},p$q.inherit=function(p$h){this._font=p$h._font,this._spacing=p$h._spacing===p$u._SPACING?p$u._SPACING:p$h._spacing.slice(),this.lineHeight=p$h.lineHeight},p$q._widthAuto=function(){return 0!=(262144&this._type)},p$q.widthed=function(p$h){return 0!=(8&this._type)},p$q._calculation=function(p$h,p$q){if(p$q.indexOf("%")<0)return!1;var p$g=this._ower,p$$=p$g.parent,p$P=this._rect;function p$S(p$h,p$q,p$f){return p$h*p$f[0]+p$q*p$f[1]+p$f[2]}function p$f(p$h){var p$q=p$$.width,p$f=p$g.width;p$P.width&&(p$g.width=p$S(p$q,p$f,p$P.width)),p$P.height&&(p$g.height=p$S(p$q,p$f,p$P.height)),p$P.left&&(p$g.x=p$S(p$q,p$f,p$P.left)),p$P.top&&(p$g.y=p$S(p$q,p$f,p$P.top))}null===p$P&&(p$$._getCSSStyle()._type|=524288,p$$.on("resize",this,p$f),this._rect=p$P={input:{}});var p$B=p$q.split(" ");return p$B[0]=parseFloat(p$B[0])/100,1==p$B.length?p$B[1]=p$B[2]=0:(p$B[1]=parseFloat(p$B[1])/100,p$B[2]=parseFloat(p$B[2])),p$P[p$h]=p$B,p$P.input[p$h]=p$q,p$f(),!0},p$q.heighted=function(p$h){return 0!=(8192&this._type)},p$q.size=function(p$h,p$q){var p$f=this._ower,p$g=!1;-1!==p$h&&p$h!=this._ower.width&&(this._type|=8,this._ower.width=p$h,p$g=!0),-1!==p$q&&p$q!=this._ower.height&&(this._type|=8192,this._ower.height=p$q,p$g=!0),p$g&&(p$f._layoutLater(),524288&this._type&&p$f.event("resize",this))},p$q._getAlign=function(){return this._aligns[0]},p$q._getValign=function(){return this._aligns[1]},p$q._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},p$q._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new p$v(this._font))},p$q.render=function(p$h,p$q,p$f,p$g){var p$$=p$h.width,p$P=p$h.height;p$f-=p$h.pivotX,p$g-=p$h.pivotY,this._bgground&&null!=this._bgground.color&&p$q.ctx.fillRect(p$f,p$g,p$$,p$P,this._bgground.color),this._border&&this._border.color&&p$q.drawRect(p$f,p$g,p$$,p$P,this._border.color.strColor,this._border.size)},p$q.getCSSStyle=function(){return this},p$q.cssText=function(p$h){this.attrs(p$u.parseOneCSS(p$h,";"))},p$q.attrs=function(p$h){if(p$h)for(var p$q=0,p$f=p$h.length;p$q<p$f;p$q++){var p$g=p$h[p$q];this[p$g[0]]=p$g[1]}},p$q.setTransform=function(p$h){"none"===p$h?this._tf=p$B._TF_EMPTY:this.attrs(p$u.parseOneCSS(p$h,","))},p$q.translate=function(p$h,p$q){this._tf===p$B._TF_EMPTY&&(this._tf=new p$$),this._tf.translateX=p$h,this._tf.translateY=p$q},p$q.scale=function(p$h,p$q){this._tf===p$B._TF_EMPTY&&(this._tf=new p$$),this._tf.scaleX=p$h,this._tf.scaleY=p$q},p$q._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},p$L(0,p$q,"block",p$h.prototype._$get_block,function(p$h){p$h?this._type|=1:this._type&=-2}),p$L(0,p$q,"valign",function(){return p$u._valigndef[this._aligns[1]]},function(p$h){this._aligns===p$u._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=p$u._valigndef[p$h]}),p$L(0,p$q,"height",null,function(p$h){if(this._type|=8192,"string"==typeof p$h){if(this._calculation("height",p$h))return;p$h=parseInt(p$h)}this.size(-1,p$h)}),p$L(0,p$q,"width",null,function(p$h){if(this._type|=8,"string"==typeof p$h){var p$q=p$h.indexOf("auto");if(0<=p$q&&(this._type|=262144,p$h=p$h.substr(0,p$q)),this._calculation("width",p$h))return;p$h=parseInt(p$h)}this.size(p$h,-1)}),p$L(0,p$q,"fontWeight",function(){return this._font.weight},function(p$h){this._createFont().weight=p$h}),p$L(0,p$q,"left",null,function(p$h){var p$q=this._ower;if("string"==typeof p$h){if("center"===p$h?p$h="50% -50% 0":"right"===p$h&&(p$h="100% -100% 0"),this._calculation("left",p$h))return;p$h=parseInt(p$h)}p$q.x=p$h}),p$L(0,p$q,"_translate",null,function(p$h){this.translate(p$h[0],p$h[1])}),p$L(0,p$q,"absolute",function(){return 0!=(4&this._type)}),p$L(0,p$q,"top",null,function(p$h){var p$q=this._ower;if("string"==typeof p$h){if("middle"===p$h?p$h="50% -50% 0":"bottom"===p$h&&(p$h="100% -100% 0"),this._calculation("top",p$h))return;p$h=parseInt(p$h)}p$q.y=p$h}),p$L(0,p$q,"align",function(){return p$u._aligndef[this._aligns[0]]},function(p$h){this._aligns===p$u._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=p$u._aligndef[p$h]}),p$L(0,p$q,"bold",function(){return this._font.bold},function(p$h){this._createFont().bold=p$h}),p$L(0,p$q,"padding",function(){return this._padding},function(p$h){this._padding=p$h}),p$L(0,p$q,"leading",function(){return this._spacing[1]},function(p$h){"string"==typeof p$h&&(p$h=parseInt(p$h+"")),this._spacing===p$u._SPACING&&(this._spacing=[0,0]),this._spacing[1]=p$h}),p$L(0,p$q,"lineElement",function(){return 0!=(65536&this._type)},function(p$h){p$h?this._type|=65536:this._type&=-65537}),p$L(0,p$q,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(p$h){this.lineElement=!1,"right"===p$h?this._type|=32768:this._type&=-32769}),p$L(0,p$q,"textDecoration",function(){return this._font.decoration},function(p$h){this._createFont().decoration=p$h}),p$L(0,p$q,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(p$h){"nowrap"===p$h&&(this._type|=131072),"none"===p$h&&(this._type&=-131073)}),p$L(0,p$q,"background",null,function(p$h){p$h?(this._bgground||(this._bgground={}),this._bgground.color=p$h,this._ower.conchModel&&this._ower.conchModel.bgColor(p$h),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),p$L(0,p$q,"wordWrap",function(){return 0==(131072&this._type)},function(p$h){p$h?this._type&=-131073:this._type|=131072}),p$L(0,p$q,"color",function(){return this._font.color},function(p$h){this._createFont().color=p$h}),p$L(0,p$q,"password",function(){return this._font.password},function(p$h){this._createFont().password=p$h}),p$L(0,p$q,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(p$h){"none"===p$h?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=p$h),this._ower.conchModel&&this._ower.conchModel.bgColor(p$h),this._ower._renderType|=256}),p$L(0,p$q,"font",function(){return this._font.toString()},function(p$h){this._createFont().set(p$h)}),p$L(0,p$q,"weight",null,function(p$h){this._createFont().weight=p$h}),p$L(0,p$q,"letterSpacing",function(){return this._spacing[0]},function(p$h){"string"==typeof p$h&&(p$h=parseInt(p$h+"")),this._spacing===p$u._SPACING&&(this._spacing=[0,0]),this._spacing[0]=p$h}),p$L(0,p$q,"fontSize",function(){return this._font.size},function(p$h){this._createFont().size=p$h}),p$L(0,p$q,"italic",function(){return this._font.italic},function(p$h){this._createFont().italic=p$h}),p$L(0,p$q,"fontFamily",function(){return this._font.family},function(p$h){this._createFont().family=p$h}),p$L(0,p$q,"stroke",function(){return this._font.stroke[0]},function(p$h){this._createFont().stroke===p$v._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=p$h}),p$L(0,p$q,"strokeColor",function(){return this._font.stroke[1]},function(p$h){this._createFont().stroke===p$v._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=p$h}),p$L(0,p$q,"border",function(){return this._border?this._border.value:""},function(p$h){if("none"!=p$h){this._border||(this._border={});var p$q=(this._border.value=p$h).split(" ");if(this._border.color=p$s.create(p$q[p$q.length-1]),1==p$q.length)return this._border.size=1,void(this._border.type="solid");var p$f=0;0<p$q[0].indexOf("px")?(this._border.size=parseInt(p$q[0]),p$f++):this._border.size=1,this._border.type=p$q[p$f],this._ower._renderType|=256}else this._border=null}),p$L(0,p$q,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(p$h){p$h?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==p$h?null:p$s.create(p$h),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),p$L(0,p$q,"position",function(){return 4&this._type?"absolute":""},function(p$h){"absolute"==p$h?this._type|=4:this._type&=-5}),p$L(0,p$q,"display",null,function(p$h){switch(p$h){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),p$L(0,p$q,"paddingLeft",function(){return this.padding[3]}),p$L(0,p$q,"paddingTop",function(){return this.padding[0]}),p$L(0,p$q,"_scale",null,function(p$h){this._ower.scale(p$h[0],p$h[1])}),p$L(0,p$q,"_rotate",null,function(p$h){this._ower.rotation=p$h}),p$u.parseOneCSS=function(p$h,p$q){for(var p$f,p$g=[],p$$=p$h.split(p$q),p$P=0,p$S=p$$.length;p$P<p$S;p$P++){var p$B=p$$[p$P],p$r=p$B.indexOf(":"),p$Y=p$B.substr(0,p$r).replace(/^\s+|\s+$/g,"");if(0!=p$Y.length){var p$C=p$B.substr(p$r+1).replace(/^\s+|\s+$/g,""),p$U=[p$Y,p$C];switch(p$Y){case"italic":case"bold":p$U[1]="true"==p$C;break;case"line-height":p$U[0]="lineHeight",p$U[1]=parseInt(p$C);break;case"font-size":p$U[0]="fontSize",p$U[1]=parseInt(p$C);break;case"padding":1<(p$f=p$C.split(" ")).length||(p$f[1]=p$f[2]=p$f[3]=p$f[0]),p$U[1]=[parseInt(p$f[0]),parseInt(p$f[1]),parseInt(p$f[2]),parseInt(p$f[3])];break;case"rotate":p$U[0]="_rotate",p$U[1]=parseFloat(p$C);break;case"scale":p$f=p$C.split(" "),p$U[0]="_scale",p$U[1]=[parseFloat(p$f[0]),parseFloat(p$f[1])];break;case"translate":p$f=p$C.split(" "),p$U[0]="_translate",p$U[1]=[parseInt(p$f[0]),parseInt(p$f[1])];break;default:(p$U[0]=p$u._CSSTOVALUE[p$Y])||(p$U[0]=p$Y)}p$g.push(p$U)}}return p$g},p$u.parseCSS=function(p$h,p$q){for(var p$f;null!=(p$f=p$u._parseCSSRegExp.exec(p$h));)p$u.styleSheets[p$f[1]]=p$u.parseOneCSS(p$f[2],";")},p$u.EMPTY=new p$u(null),p$u._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},p$u._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),p$u._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},p$u._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},p$u.styleSheets={},p$u.ALIGN_CENTER=1,p$u.ALIGN_RIGHT=2,p$u.VALIGN_MIDDLE=1,p$u.VALIGN_BOTTOM=2,p$u._CSS_BLOCK=1,p$u._DISPLAY_NONE=2,p$u._ABSOLUTE=4,p$u._WIDTH_SET=8,p$u._PADDING=[0,0,0,0],p$u._RECT=[-1,-1,-1,-1],p$u._SPACING=[0,0],p$u._ALIGNS=[0,0,0],p$u.ADDLAYOUTED=512,p$u._NEWFONT=4096,p$u._HEIGHT_SET=8192,p$u._BACKGROUND_SET=16384,p$u._FLOAT_RIGHT=32768,p$u._LINE_ELEMENT=65536,p$u._NOWARP=131072,p$u._WIDTHAUTO=262144,p$u._LISTERRESZIE=524288,p$u}(p$B),p$fh=function(p$h){function p$S(){this.url=null,this.audio=null,this.loaded=!1,p$S.__super.call(this)}p$C(p$S,"laya.media.h5audio.AudioSound",p$Y);var p$q=p$S.prototype;return p$q.dispose=function(){var p$h=p$S._audioCache[this.url];p$h&&(p$h.src="",delete p$S._audioCache[this.url])},p$q.load=function(p$h){var p$q;if(p$h=p$z.formatURL(p$h),(this.url=p$h)==p$A._tMusic?(p$S._initMusicAudio(),(p$q=p$S._musicAudio).src!=p$h&&(p$S._audioCache[p$q.src]=null,p$q=null)):p$q=p$S._audioCache[p$h],p$q&&2<=p$q.readyState)this.event("complete");else{p$q||(p$q=p$h==p$A._tMusic?(p$S._initMusicAudio(),p$S._musicAudio):p$w.createElement("audio"),(p$S._audioCache[p$h]=p$q).src=p$h),p$q.addEventListener("canplaythrough",p$g),p$q.addEventListener("error",p$$);var p$f=this;(this.audio=p$q).load?p$q.load():p$$()}function p$g(){p$P(),p$f.loaded=!0,p$f.event("complete")}function p$$(){p$q.load=null,p$P(),p$f.event("error")}function p$P(){p$q.removeEventListener("canplaythrough",p$g),p$q.removeEventListener("error",p$$)}},p$q.play=function(p$h,p$q,p$f){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),!this.url)return null;var p$g,p$$;if(!(p$g=this.url==p$A._tMusic?p$S._musicAudio:p$S._audioCache[this.url]))return null;p$$=p$F.getItem("audio:"+this.url),p$c.isConchApp?p$$||((p$$=p$w.createElement("audio")).src=this.url):this.url==p$A._tMusic?(p$S._initMusicAudio(),(p$$=p$S._musicAudio).src=this.url):p$$=p$$||p$g.cloneNode(!0);var p$P=new p$uh(p$$);return p$P.url=this.url,p$P.loops=p$q,p$P.startTime=p$h,p$P.startHandler=p$f,p$P.play(!1),p$A.addChannel(p$P),p$P},p$L(0,p$q,"duration",function(){var p$h;return(p$h=p$S._audioCache[this.url])?p$h.duration:0}),p$S._initMusicAudio=function(){p$S._musicAudio||(p$S._musicAudio||(p$S._musicAudio=p$w.createElement("audio")),p$c.isConchApp||p$w.document.addEventListener("mousedown",p$S._makeMusicOK))},p$S._makeMusicOK=function(){p$w.document.removeEventListener("mousedown",p$S._makeMusicOK),p$S._musicAudio.src?p$S._musicAudio.play():(p$S._musicAudio.src="",p$S._musicAudio.load())},p$S._audioCache={},p$S._musicAudio=null,p$S}(),p$gh=function(p$h){function p$q(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,p$q.__super.call(this)}p$C(p$q,"laya.media.SoundChannel",p$Y);var p$f=p$q.prototype;return p$f.play=function(){},p$f.stop=function(){},p$f.pause=function(){},p$f.resume=function(){},p$f.__runComplete=function(p$h){p$h&&p$h.run()},p$L(0,p$f,"volume",function(){return 1},function(p$h){}),p$L(0,p$f,"position",function(){return 0}),p$L(0,p$f,"duration",function(){return 0}),p$q}(),p$$h=function(p$h){function p$q(){p$q.__super.call(this)}p$C(p$q,"laya.media.Sound",p$Y);var p$f=p$q.prototype;return p$f.load=function(p$h){},p$f.play=function(p$h,p$q,p$f){return void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),null},p$f.dispose=function(){},p$L(0,p$f,"duration",function(){return 0}),p$q}(),p$Ph=function(p$h){function p$$(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,p$$.__super.call(this)}p$C(p$$,"laya.media.webaudio.WebAudioSound",p$Y);var p$q=p$$.prototype;return p$q.load=function(p$h){this.url=p$h,this.audioBuffer=p$$._dataCache[p$h],this.audioBuffer?this._loaded(this.audioBuffer):(p$$.e.on("loaded:"+p$h,this,this._loaded),p$$.e.on("err:"+p$h,this,this._err),p$$.__loadingSound[p$h]||(p$$.__loadingSound[p$h]=!0,p$t.loader.load(p$h,p$N.create(this,this.onloaded),null,p$Bh.BUFFER,4,!1,null,!0)))},p$q.onloaded=function(p$h){p$h||this._err(),this._disposed?this._removeLoadEvents():(this.data=p$h,p$$.buffs.push({buffer:this.data,url:this.url}),p$$.decode())},p$q._err=function(){if(this._removeLoadEvents(),p$$.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var p$h,p$q,p$f,p$g=0;for(p$h=(p$q=this.__toPlays).length,p$g=0;p$g<p$h;p$g++)(p$f=p$q[p$g])[3]&&!p$f[3].isStopped&&p$f[3].event("error");this.__toPlays.length=0}},p$q._loaded=function(p$h){this._removeLoadEvents(),this._disposed||(this.audioBuffer=p$h,this.loaded=!0,this.event("complete"))},p$q._removeLoadEvents=function(){p$$.e.off("loaded:"+this.url,this,this._loaded),p$$.e.off("err:"+this.url,this,this._err)},p$q.__playAfterLoaded=function(){if(this.__toPlays){var p$h,p$q,p$f,p$g=0;for(p$h=(p$q=this.__toPlays).length,p$g=0;p$g<p$h;p$g++)(p$f=p$q[p$g])[3]&&!p$f[3].isStopped&&this.play(p$f[0],p$f[1],p$f[2],p$f[3]);this.__toPlays.length=0}},p$q.play=function(p$h,p$q,p$f,p$g){return void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),p$g=p$g||new p$vh,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([p$h,p$q,p$f,p$g]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),p$g.url=this.url,p$g.loops=p$q,p$g.audioBuffer=this.audioBuffer,p$g.startTime=p$h,p$g.startHandler=p$f,p$g.play(!1),p$A.addChannel(p$g),p$g},p$q.dispose=function(){this._disposed=!0,delete p$$._dataCache[this.url],delete p$$.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},p$L(0,p$q,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),p$$.decode=function(){if(!(p$$.buffs.length<=0||p$$.isDecoding))if(p$$.isDecoding=!0,(p$$.tInfo=p$$.buffs.shift())&&p$$.tInfo.buffer&&p$$.tInfo.buffer.byteLength)try{p$$.ctx.decodeAudioData(p$$.tInfo.buffer,p$$._done,p$$._fail)}catch(p$h){console.error("decodeAudioData error  byteLength:"+p$$.tInfo.buffer.byteLength+"  url:"+p$$.tInfo.url)}else p$$._fail()},p$$._done=function(p$h){p$$.e.event("loaded:"+p$$.tInfo.url,p$h),p$$._dataCache[p$$.tInfo.url]=p$h,p$$.isDecoding=!1,p$$.decode()},p$$._fail=function(){p$$.e.event("err:"+p$$.tInfo.url,null),p$$.isDecoding=!1,p$$.decode()},p$$._playEmptySound=function(){if(null!=p$$.ctx){if(p$$._emptySource&&(p$$._emptySource.stop(),p$$._emptySource.disconnect(0),!p$vh._tryCleanFailed))try{p$$._emptySource.buffer=null}catch(p$h){p$vh._tryCleanFailed=!0}var p$h=p$$.ctx.createBufferSource();p$h.buffer=p$$._miniBuffer,p$h.connect(p$$.ctx.destination),p$h.start(0,0,0),p$$._emptySource=p$h}},p$$._unlock=function(){p$$._unlocked||(p$$._playEmptySound(),"running"==p$$.ctx.state?(p$w.document.removeEventListener("mousedown",p$$._unlock,!0),p$w.document.removeEventListener("touchend",p$$._unlock,!0),p$w.document.removeEventListener("touchstart",p$$._unlock,!0),p$$._unlocked=!0):"suspended"==p$$.ctx.state&&p$A._recoverWebAudio())},p$$.initWebAudio=function(){"running"!=p$$.ctx.state&&(p$$._unlock(),p$w.document.addEventListener("mousedown",p$$._unlock,!0),p$w.document.addEventListener("touchend",p$$._unlock,!0),p$w.document.addEventListener("touchstart",p$$._unlock,!0))},p$$._emptySource=null,p$$._dataCache={},p$$.buffs=[],p$$.isDecoding=!1,p$$._unlocked=!1,p$$.tInfo=null,p$$.__loadingSound={},p$r(p$$,["window",function(){return this.window=p$w.window},"webAudioEnabled",function(){return this.webAudioEnabled=p$$.window.AudioContext||p$$.window.webkitAudioContext||p$$.window.mozAudioContext},"ctx",function(){return this.ctx=p$$.webAudioEnabled?new(p$$.window.AudioContext||p$$.window.webkitAudioContext||p$$.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=p$$.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new p$Y}]),p$$}(),p$Sh=function(p$h){function p$q(){this._responseType=null,this._data=null,p$q.__super.call(this),this._http=new p$w.window.XMLHttpRequest}p$C(p$q,"laya.net.HttpRequest",p$Y);var p$f=p$q.prototype;return p$f.send=function(p$h,p$q,p$f,p$g,p$$){void 0===p$f&&(p$f="get"),void 0===p$g&&(p$g="text"),this._responseType=p$g,this._data=null;var p$P=this,p$S=this._http;if(p$S.open(p$f,p$h,!0),p$$)for(var p$B=0;p$B<p$$.length;p$B++)p$S.setRequestHeader(p$$[p$B++],p$$[p$B]);else p$c.isConchApp||(p$q&&"string"!=typeof p$q?p$S.setRequestHeader("Content-Type","application/json"):p$S.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));p$S.responseType="arraybuffer"!==p$g?"text":"arraybuffer",p$S.onerror=function(p$h){p$P._onError(p$h)},p$S.onabort=function(p$h){p$P._onAbort(p$h)},p$S.onprogress=function(p$h){p$P._onProgress(p$h)},p$S.onload=function(p$h){p$P._onLoad(p$h)},p$S.send(p$q)},p$f._onProgress=function(p$h){p$h&&p$h.lengthComputable&&this.event("progress",p$h.loaded/p$h.total)},p$f._onAbort=function(p$h){this.error("Request was aborted by user")},p$f._onError=function(p$h){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},p$f._onLoad=function(p$h){var p$q=this._http,p$f=void 0!==p$q.status?p$q.status:200;200===p$f||204===p$f||0===p$f?this.complete():this.error("["+p$q.status+"]"+p$q.statusText+":"+p$q.responseURL)},p$f.error=function(p$h){this.clear(),this.event("error",p$h)},p$f.complete=function(){this.clear();var p$q=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=p$O.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(p$h){p$q=!1,this.error(p$h.message)}p$q&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},p$f.clear=function(){var p$h=this._http;p$h.onerror=p$h.onabort=p$h.onprogress=p$h.onload=null},p$L(0,p$f,"url",function(){return this._http.responseURL}),p$L(0,p$f,"http",function(){return this._http}),p$L(0,p$f,"data",function(){return this._data}),p$q}(),p$Bh=function(p$h){function p$J(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,p$J.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}p$C(p$J,"laya.net.Loader",p$Y);var p$q=p$J.prototype;return p$q.load=function(p$h,p$q,p$f,p$g,p$$){if(p$h&&""!=p$h||console.error("Loader 加载的url不合法 "+p$h),void 0===p$f&&(p$f=!0),void 0===p$$&&(p$$=!1),0===(this._url=p$h).indexOf("data:image")?this._type=p$q="image":this._type=p$q||(p$q=this.getTypeFromUrl(p$h)),this._cache=p$f,this._data=null,!p$$&&p$J.loadedMap[p$h])return this._data=p$J.loadedMap[p$h],this.event("progress",1),void this.event("complete",this._data);if(p$g&&p$J.setGroup(p$h,p$g),null!=p$J.parserMap[p$q])return this._customParse=!0,void(p$J.parserMap[p$q]instanceof laya.utils.Handler?p$J.parserMap[p$q].runWith(this):p$J.parserMap[p$q].call(null,this));if("image"===p$q||"htmlimage"===p$q||"nativeimage"===p$q)return this._loadImage(p$h);if("ttf"===p$q)return this._loadTTF(p$h);switch(p$q){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:p$q}p$J.preLoadedMap[p$h]?this.onLoaded(p$J.preLoadedMap[p$h]):p$S.resMgrLoad(p$h,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},p$q.getTypeFromUrl=function(p$h){var p$q=p$O.getFileExtension(p$h);return p$q?p$J.typeMap[p$q]:(console.warn("Not recognize the resources suffix",p$h),"text")},p$q._loadTTF=function(p$h){p$h=p$z.formatURL(p$h);var p$q=new p$i;p$q.complete=p$N.create(this,this.onLoaded),p$q.load(p$h)},p$q._loadImage=function(p$h){p$S.imgMgrLoad(p$h,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},p$q._loadImageComplete=function(p$h,p$q,p$f){if(null!=p$f)if(p$f instanceof ArrayBuffer){var p$g=new DataView(p$f),p$$=new laya.webgl.resource.WebGLImage(new Uint8Array(p$f,8),p$h,0,!1,p$g.getUint32(0),p$g.getUint32(4));this.onLoaded(p$$)}else if(p$f instanceof p$Ch)p$J.imgMgrSet[p$h]=p$q,p$S.imgMgrLock(p$h,p$J.imgMgrSet[p$h]),this._url=p$h,this.complete(p$f);else{var p$P=-1!=p$h.indexOf(".png",p$h.length-4)?6408:6407;p$$=new laya.webgl.resource.WebGLImage(p$f,p$h,p$P,!1,p$f.width,p$f.height);this.onLoaded(p$$)}else this.event("error","Load image failed")},p$q._loadSound=function(p$h){var p$q=new p$A._soundClass,p$f=this;function p$g(){p$q.offAll()}p$q.on("complete",this,function(){p$g(),p$f.onLoaded(p$q)}),p$q.on("error",this,function(){p$g(),p$q.dispose(),p$f.event("error","Load sound failed")}),p$q.load(p$h)},p$q.onProgress=function(p$h){"atlas"===this._type?this.event("progress",.3*p$h):this.event("progress",p$h)},p$q.onError=function(p$h){this.event("error",p$h)},p$q._loadedComplete=function(p$h,p$q,p$f){if(null!=p$f)switch(this._type){case"atlas":case"plf":case"json":var p$g=new p$k(p$f);this.onLoaded(JSON.parse(p$g.readUTFBytes()));break;case"font":p$g=new p$k(p$f);this.onLoaded(p$O.parseXMLFromString(p$g.readUTFBytes()));break;default:this.onLoaded(p$f)}else this.event("error",p$h)},p$q.onLoaded=function(p$h){var p$q=this._type;if("plf"==p$q)this.parsePLFData(p$h),this.complete(p$h);else if("image"===p$q){var p$f=new p$Ch(p$h);p$f.url=this._url,this.complete(p$f)}else if("sound"===p$q||"htmlimage"===p$q||"nativeimage"===p$q)this.complete(p$h);else if("atlas"===p$q){if(!p$h.src&&!p$h._setContext){if(!this._data){if((this._data=p$h).meta&&p$h.meta.image)for(var p$g=p$h.meta.image.split(","),p$$=0<=this._url.indexOf("/")?"/":"\\",p$P=this._url.lastIndexOf(p$$),p$S=0<=p$P?this._url.substr(0,p$P+1):"",p$B=0,p$r=p$g.length;p$B<p$r;p$B++)p$g[p$B]=p$S+p$g[p$B];else p$g=[this._url.replace(".json",".png")];p$g.reverse(),p$h.toLoads=p$g,p$h.pics=[]}return this.event("progress",.3+1/p$g.length*.6),this._loadImage(p$g.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(p$h),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var p$Y=this._data.frames,p$C=this._url.split("?")[0],p$U=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:p$C.substring(0,p$C.lastIndexOf("."))+"/",p$u=this._data.pics,p$v=p$z.formatURL(this._url),p$L=p$J.atlasMap[p$v]||(p$J.atlasMap[p$v]=[]);p$L.dir=p$U;var p$e=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var p$l in p$e=parseFloat(this._data.meta.scale),p$Y){var p$_,p$N=p$Y[p$l],p$G=p$u[p$N.frame.idx?p$N.frame.idx:0],p$m=p$z.formatURL(p$U+p$l);p$G.scaleRate=p$e,p$_=p$Ch.create(p$G,p$N.frame.x,p$N.frame.y,p$N.frame.w,p$N.frame.h,p$N.spriteSourceSize.x,p$N.spriteSourceSize.y,p$N.sourceSize.w,p$N.sourceSize.h),p$J.cacheRes(p$m,p$_),p$J.keepCache(this._url,p$U+p$l),p$_.url=p$m,p$L.push(p$m)}else for(p$l in p$Y)p$G=p$u[(p$N=p$Y[p$l]).frame.idx?p$N.frame.idx:0],p$m=p$z.formatURL(p$U+p$l),p$J.cacheRes(p$m,p$Ch.create(p$G,p$N.frame.x,p$N.frame.y,p$N.frame.w,p$N.frame.h,p$N.spriteSourceSize.x,p$N.spriteSourceSize.y,p$N.sourceSize.w,p$N.sourceSize.h)),p$J.loadedMap[p$m].url=p$m,p$J.keepCache(this._url,p$U+p$l),p$L.push(p$m);delete this._data.pics,this.complete(this._data)}else if("font"==p$q){if(!p$h.src)return this._data=p$h,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var p$E=new p$p;p$E.parseFont(this._data,p$h);var p$R=this._url.split(".fnt")[0].split("/"),p$t=p$R[p$R.length-1];p$lh.registerBitmapFont(p$t,p$E),this._data=p$E,this.complete(this._data)}else if("pkm"==p$q){var p$X=p$Rh.create(p$h,this._url),p$n=new p$Ch(p$X);p$n.url=this._url,this.complete(p$n)}else this.complete(p$h)},p$q.parsePLFData=function(p$h){var p$q,p$f,p$g;for(p$q in p$h)switch(p$g=p$h[p$q],p$q){case"json":case"text":for(p$f in p$g)p$J.preLoadedMap[p$z.formatURL(p$f)]=p$g[p$f];break;default:for(p$f in p$g)p$J.preLoadedMap[p$z.formatURL(p$f)]=p$g[p$f]}},p$q.complete=function(p$h){this._data=p$h,this._customParse?this.event("loaded",p$h instanceof Array?[p$h]:p$h):(p$J._loaders.push(this),p$J._isWorking||p$J.checkNext())},p$q.endLoad=function(p$h){p$h&&(this._data=p$h),this._cache&&p$J.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},p$L(0,p$q,"url",function(){return this._url}),p$L(0,p$q,"data",function(){return this._data}),p$L(0,p$q,"cache",function(){return this._cache}),p$L(0,p$q,"type",function(){return this._type}),p$J.checkNext=function(){p$J._isWorking=!0;for(var p$h=p$w.now();p$J._startIndex<p$J._loaders.length;)if(p$w.now(),p$J._loaders[p$J._startIndex].endLoad(),p$J._startIndex++,p$w.now()-p$h>p$J.maxTimeOut)return console.warn("loader callback cost a long time:"+(p$w.now()-p$h)+" url="+p$J._loaders[p$J._startIndex-1].url),void p$t.timer.frameOnce(1,null,p$J.checkNext);p$J._loaders.length=0,p$J._startIndex=0,p$J._isWorking=!1},p$J.clearRes=function(p$h,p$q){if(null!=p$h){void 0===p$q&&(p$q=!1),p$h=p$z.formatURL(p$h);var p$f=p$J.getAtlas(p$h);if(p$f){for(var p$g=0,p$$=p$f.length;p$g<p$$;p$g++){var p$P=p$f[p$g],p$S=p$J.getRes(p$P);delete p$J.loadedMap[p$P],p$J.clearCache(p$h.substring(p$z.basePath.length),p$P.substring(p$z.basePath.length)),p$S&&p$S.destroy(p$q)}p$f.length=0,delete p$J.atlasMap[p$h],delete p$J.loadedMap[p$h]}else{var p$B=p$J.loadedMap[p$h];p$B&&(delete p$J.loadedMap[p$h],p$B instanceof laya.resource.Texture&&p$B.bitmap&&p$B.destroy(p$q))}}},p$J.clearTextureRes=function(p$h){p$h=p$z.formatURL(p$h);var p$q=laya.net.Loader.getAtlas(p$h),p$f=p$q&&0<p$q.length?laya.net.Loader.getRes(p$q[0]):laya.net.Loader.getRes(p$h);p$f&&p$f.bitmap&&(p$c.isConchApp&&!p$c.isConchWebGL?p$f.bitmap.source.releaseTexture&&p$f.bitmap.source.releaseTexture():null==p$f.bitmap._atlaser&&p$f.bitmap.releaseResource(!0))},p$J.getRes=function(p$h){return p$J.loadedMap[p$z.formatURL(p$h)]},p$J.getAtlas=function(p$h){return p$J.atlasMap[p$z.formatURL(p$h)]},p$J.cacheRes=function(p$h,p$q){p$h=p$z.formatURL(p$h),null!=p$J.loadedMap[p$h]?console.warn("Resources already exist,is repeated loading:",p$h):p$J.loadedMap[p$h]=p$q},p$J.setGroup=function(p$h,p$q){p$J.groupMap[p$q]||(p$J.groupMap[p$q]=[]),p$J.groupMap[p$q].push(p$h)},p$J.clearResByGroup=function(p$h){if(p$J.groupMap[p$h]){var p$q=p$J.groupMap[p$h],p$f=0,p$g=p$q.length;for(p$f=0;p$f<p$g;p$f++)p$J.clearRes(p$q[p$f]);p$q.length=0}},p$J.keepCache=function(p$h,p$q){if(p$h&&p$q){var p$f=p$J.cacheSet[p$q];p$f?-1==p$f.indexOf(p$h)&&p$f.push(p$h):p$J.cacheSet[p$q]=[p$h]}},p$J.clearCache=function(p$h,p$q){if(p$h&&p$q){var p$f=p$J.cacheSet[p$q];if(p$f){var p$g=p$f.indexOf(p$h);if(-1!==p$g){var p$$=p$f.length-1;0==p$$?(delete p$J.cacheSet[p$q],0<p$J.imgMgrSet[p$q]?p$S.imgMgrFree(p$q,p$J.imgMgrSet[p$q]):p$J.clearRes(p$q,!0)):(p$f[p$g]=p$f[p$$],p$f.length=p$$)}}}},p$J.saveObject=function(p$h,p$q,p$f){if(p$q&&p$h){var p$g=p$J.objectSet[p$h];p$g?(console.warn("Loader.saveObject: "+p$h),p$g[0]=p$q,p$g[1]=p$f):p$J.objectSet[p$h]=[p$q,p$f,[]]}},p$J.findObject=function(p$h){if(p$h){var p$q=p$J.objectSet[p$h];if(p$q)return p$q[0]}return null},p$J.keepObject=function(p$h,p$q){if(p$h&&p$q){var p$f=p$J.objectSet[p$q];p$f&&-1===p$f[2].indexOf(p$h)&&p$f[2].push(p$h)}},p$J.clearObject=function(p$h,p$q){if(p$h&&p$q){var p$f=p$J.objectSet[p$q];if(p$f){var p$g=p$f[2],p$$=p$g.indexOf(p$h);if(-1!==p$$){var p$P=p$g.length-1;0==p$P?(delete p$J.objectSet[p$q],p$f[1]&&p$f[1].call(null,p$f[0])):(p$g[p$$]=p$g[p$P],p$g.length=p$P)}}}},p$J.TEXT="text",p$J.JSON="json",p$J.XML="xml",p$J.BUFFER="arraybuffer",p$J.IMAGE="image",p$J.SOUND="sound",p$J.ATLAS="atlas",p$J.FONT="font",p$J.TTF="ttf",p$J.PLF="plf",p$J.PKM="pkm",p$J.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},p$J.parserMap={},p$J.groupMap={},p$J.maxTimeOut=100,p$J.loadedMap={},p$J.preLoadedMap={},p$J.atlasMap={},p$J._loaders=[],p$J._isWorking=!1,p$J._startIndex=0,p$J.imgCache={},p$J.cacheSet={},p$J.objectSet={},p$J.imgMgrSet={},p$J}(),p$rh=function(p$h){var p$u;function p$v(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},p$v.__super.call(this);for(var p$h=0;p$h<this._maxPriority;p$h++)this._resInfos[p$h]=[]}p$C(p$v,"laya.net.LoaderManager",p$Y);var p$q=p$v.prototype;return p$q.create=function(p$h,p$f,p$q,p$g,p$$,p$P,p$S,p$B){if(null==p$P&&(p$P=2),null==p$S&&(p$S=!0),p$h instanceof Array){var p$r=p$h,p$Y=p$r.length,p$C=0;if(p$q)var p$U=p$N.create(p$q.caller,p$q.method,p$q.args,!1);for(var p$u=0;p$u<p$Y;p$u++){var p$v=p$r[p$u];"string"==typeof p$v&&(p$v=p$r[p$u]={url:p$v}),p$v.progress=0}for(p$u=0;p$u<p$Y;p$u++){p$v=p$r[p$u];var p$L=p$q?p$N.create(null,p$_,[p$v],!1):null,p$e=p$q||p$f?p$N.create(null,p$l,[p$v]):null;this._create(p$v.url,p$e,p$L,p$v.clas||p$g,p$v.params||p$$,null!=p$v.priority&&0<=p$v.priority?p$v.priority:p$P,p$S,p$v.group||p$B)}function p$l(p$h,p$q){p$C++,p$h.progress=1,p$C===p$Y&&p$f&&p$f.run()}function p$_(p$h,p$q){p$h.progress=p$q;for(var p$f=0,p$g=0;p$g<p$Y;p$g++){p$f+=p$r[p$g].progress}var p$$=p$f/p$Y;p$U.runWith(p$$)}return!0}return this._create(p$h,p$f,p$q,p$g,p$$,p$P,p$S,p$B)},p$q._create=function(p$q,p$f,p$h,p$g,p$$,p$P,p$S,p$B){p$q&&""!=p$q||console.error("加载的url不合法 "+p$q),null==p$P&&(p$P=2),null==p$S&&(p$S=!0);var p$r=p$z.formatURL(p$q),p$Y=this.getRes(p$r);if(p$Y)!p$Y.hasOwnProperty("loaded")||p$Y.loaded?(p$h&&p$h.runWith(1),p$f&&p$f.run()):p$f&&p$t.loader._createListener(p$q,p$f.caller,p$f.method,p$f.args,!0,!1);else{var p$C=p$O.getFileExtension(p$q),p$U=p$v.createMap[p$C];if(!p$U)throw new Error("LoaderManager:unknown file("+p$q+") extension with: "+p$C+".");p$g||(p$g=p$U[0]);var p$u=p$U[1];if("atlas"==p$C)this.load(p$q,p$f,p$h,p$u,p$P,p$S);else{p$g===p$Ch&&(p$u="htmlimage"),(p$Y=p$g?new p$g:null).hasOwnProperty("_loaded")&&(p$Y._loaded=!1),p$Y._setUrl(p$q),p$B&&p$Y._setGroup(p$B),this._createLoad(p$Y,p$q,p$N.create(null,function(p$h){p$Y&&!p$Y.destroyed&&p$h&&p$Y.onAsynLoaded.call(p$Y,p$q,p$h,p$$),p$f&&p$f.run();p$t.loader.event(p$q)}),p$h,p$u,p$P,!1,p$B,!0),p$S&&this.cacheRes(p$r,p$Y)}}return p$Y},p$q.load=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){p$h&&""!=p$h||console.error("加载的url不合法 "+p$h);var p$r=this;if(null==p$$&&(p$$=2),null==p$P&&(p$P=!0),void 0===p$B&&(p$B=!1),p$h instanceof Array)return this._loadAssets(p$h,p$q,p$f,p$g,p$$,p$P,p$S);var p$Y=p$Bh.getRes(p$h);if(null!=p$Y)p$t.timer.frameOnce(1,null,function(){p$f&&p$f.runWith(1),p$q&&p$q.runWith(p$Y),p$r._loaderCount||p$r.event("complete")});else{var p$C=p$v._resMap[p$h];p$C?(p$q&&p$C._createListener("complete",p$q.caller,p$q.method,p$q.args,!1,!1),p$f&&p$C._createListener("progress",p$f.caller,p$f.method,p$f.args,!1,!1)):((p$C=this._infoPool.length?this._infoPool.pop():new p$u).url=p$h,p$C.type=p$g,p$C.cache=p$P,p$C.group=p$S,p$C.ignoreCache=p$B,p$C.priority=p$$,p$q&&p$C.on("complete",p$q.caller,p$q.method,p$q.args),p$f&&p$C.on("progress",p$f.caller,p$f.method,p$f.args),p$v._resMap[p$h]=p$C,p$$=p$$<this._maxPriority?0<=p$$?p$$:0:this._maxPriority-1,this._resInfos[p$$].push(p$C),this._next())}return this},p$q._createLoad=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){var p$Y=this;if(null==p$P&&(p$P=2),null==p$S&&(p$S=!0),void 0===p$r&&(p$r=!1),p$q instanceof Array)return this._loadAssets(p$q,p$f,p$g,p$$,p$P,p$S,p$B);var p$C=p$Bh.getRes(p$q);if(null!=p$C)p$t.timer.frameOnce(1,null,function(){p$g&&p$g.runWith(1),p$f&&p$f.runWith(p$C),p$Y._loaderCount||p$Y.event("complete")});else{var p$U=p$v._resMap[p$q];p$U?(p$f&&p$U._createListener("complete",p$f.caller,p$f.method,p$f.args,!1,!1),p$g&&p$U._createListener("progress",p$g.caller,p$g.method,p$g.args,!1,!1)):((p$U=this._infoPool.length?this._infoPool.pop():new p$u).url=p$q,p$U.clas=p$h,p$U.type=p$$,p$U.cache=p$S,p$U.group=p$B,p$U.ignoreCache=p$r,p$U.priority=p$P,p$f&&p$U.on("complete",p$f.caller,p$f.method,p$f.args),p$g&&p$U.on("progress",p$g.caller,p$g.method,p$g.args),p$v._resMap[p$q]=p$U,p$P=p$P<this._maxPriority?0<=p$P?p$P:0:this._maxPriority-1,this._resInfos[p$P].push(p$U),this._next())}return this},p$q._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var p$h=0;p$h<this._maxPriority;p$h++)for(var p$q=this._resInfos[p$h];0<p$q.length;){var p$f=p$q.shift();if(p$f)return this._doLoad(p$f)}this._loaderCount||this.event("complete")}},p$q._doLoad=function(p$q){this._loaderCount++;var p$f=this._loaders.length?this._loaders.pop():new p$Bh;p$f.on("complete",null,p$$),p$f.on("progress",null,function(p$h){p$q.event("progress",p$h)}),p$f.on("error",null,function(p$h){p$$(null)});var p$g=this;function p$$(p$h){p$f.offAll(),p$f._data=null,p$f._customParse=!1,p$g._loaders.push(p$f),p$g._endLoad(p$q,p$h instanceof Array?[p$h]:p$h),p$g._loaderCount--,p$g._next()}p$f._class=p$q.clas,1<=p$q.priority?(p$f.priority=p$q.priority,p$f.realTime=!1):(p$f.priority=0,p$f.realTime=!0),p$f.load(p$q.url,p$q.type,p$q.cache,p$q.group,p$q.ignoreCache)},p$q._endLoad=function(p$h,p$q){var p$f=p$h.url;if(null==p$q){var p$g=this._failRes[p$f]||0;if(p$g<this.retryNum)return console.warn("[warn]Retry to load:",p$f),this._failRes[p$f]=p$g+1,void p$t.timer.once(this.retryDelay,this,this._addReTry,[p$h],!1);console.warn("[error]Failed to load:",p$f),this.event("error",p$f)}this._failRes[p$f]&&(this._failRes[p$f]=0),delete p$v._resMap[p$f],p$h.event("complete",p$q),p$h.offAll(),this._infoPool.push(p$h)},p$q._addReTry=function(p$h){this._resInfos[this._maxPriority-1].push(p$h),this._next()},p$q.clearRes=function(p$h,p$q){void 0===p$q&&(p$q=!1),p$Bh.clearRes(p$h,p$q)},p$q.getRes=function(p$h){return p$Bh.getRes(p$h)},p$q.cacheRes=function(p$h,p$q){p$Bh.cacheRes(p$h,p$q)},p$q.clearTextureRes=function(p$h){p$Bh.clearTextureRes(p$h)},p$q.setGroup=function(p$h,p$q){p$Bh.setGroup(p$h,p$q)},p$q.clearResByGroup=function(p$h){p$Bh.clearResByGroup(p$h)},p$q.clearUnLoaded=function(){for(var p$h=0;p$h<this._maxPriority;p$h++){for(var p$q=this._resInfos[p$h],p$f=p$q.length-1;-1<p$f;p$f--){var p$g=p$q[p$f];p$g&&(p$g.offAll(),this._infoPool.push(p$g))}p$q.length=0}this._loaderCount=0,p$v._resMap={}},p$q.cancelLoadByUrls=function(p$h){if(p$h)for(var p$q=0,p$f=p$h.length;p$q<p$f;p$q++)this.cancelLoadByUrl(p$h[p$q])},p$q.cancelLoadByUrl=function(p$h){for(var p$q=0;p$q<this._maxPriority;p$q++)for(var p$f=this._resInfos[p$q],p$g=p$f.length-1;-1<p$g;p$g--){var p$$=p$f[p$g];p$$&&p$$.url===p$h&&(p$f[p$g]=null,p$$.offAll(),this._infoPool.push(p$$))}p$v._resMap[p$h]&&delete p$v._resMap[p$h]},p$q._loadAssets=function(p$h,p$f,p$S,p$q,p$g,p$$,p$P){null==p$g&&(p$g=2),null==p$$&&(p$$=!0);for(var p$B=p$h.length,p$r=0,p$Y=0,p$C=[],p$U=!0,p$u=0;p$u<p$B;p$u++){var p$v=p$h[p$u];if(!p$v)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+p$h);"string"==typeof p$v&&(p$v={url:p$v,type:p$q,size:1,priority:p$g}),p$v.size||(p$v.size=1),p$v.progress=0,p$Y+=p$v.size,p$C.push(p$v);var p$L=p$S?p$N.create(null,p$_,[p$v],!1):null,p$e=p$f||p$S?p$N.create(null,p$l,[p$v]):null;this.load(p$v.url,p$e,p$L,p$v.type,null!=p$v.priority&&0<=p$v.priority?p$v.priority:2,p$$,p$v.group||p$P)}function p$l(p$h,p$q){p$r++,p$h.progress=1,p$q||(p$U=!1),p$r===p$B&&p$f&&p$f.runWith(p$U)}function p$_(p$h,p$q){if(null!=p$S){p$h.progress=p$q;for(var p$f=0,p$g=0;p$g<p$C.length;p$g++){var p$$=p$C[p$g];p$f+=p$$.size*p$$.progress}var p$P=p$f/p$Y;p$S.runWith(p$P)}}return this},p$v.cacheRes=function(p$h,p$q){p$Bh.cacheRes(p$h,p$q)},p$v._resMap={},p$r(p$v,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),p$v.__init$=function(){p$u=function(p$h){function p$q(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,p$q.__super.call(this)}return p$C(p$q,"",p$Y),p$q}()},p$v}(),p$Yh=(function(p$h){function p$$(p$h){p$$.__super.call(this),p$h||(p$h=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var p$q=0,p$f=0,p$g=0;p$g<20;p$g++)p$g%5!=4?this._mat[p$q++]=p$h[p$g]:this._alpha[p$f++]=p$h[p$g];this._action=p$d.createFilterAction(32),this._action.data=this}p$C(p$$,"laya.filters.ColorFilter",p$_);var p$q=p$$.prototype;p$t.imps(p$q,{"laya.filters.IFilter":!0}),p$q.callNative=function(p$h){p$h._$P.cf=this;p$h.conchModel&&p$h.conchModel.setFilterMatrix&&p$h.conchModel.setFilterMatrix(this._mat,this._alpha)},p$L(0,p$q,"type",function(){return 32}),p$L(0,p$q,"action",function(){return this._action})}(),function(p$h){function p$g(p$h,p$q,p$f){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===p$q&&(p$q=0),p$g.__super.call(this),this._byteClass=p$f||p$k,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,p$h&&0<p$q&&p$q<65535&&this.connect(p$h,p$q)}p$C(p$g,"laya.net.Socket",p$Y);var p$q=p$g.prototype;p$q.connect=function(p$h,p$q){var p$f="ws://"+p$h+":"+p$q;p$f="https:"==p$w.window.location.protocol?"wss://"+p$h+":"+p$q:"ws://"+p$h+":"+p$q,this.connectByUrl(p$f)},p$q.connectByUrl=function(p$h){var p$q=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new p$w.window.WebSocket(p$h,this.protocols):this._socket=new p$w.window.WebSocket(p$h),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(p$h){p$q._onOpen(p$h)},this._socket.onmessage=function(p$h){p$q._onMessage(p$h)},this._socket.onclose=function(p$h){p$q._onClose(p$h)},this._socket.onerror=function(p$h){p$q._onError(p$h)}},p$q.cleanSocket=function(){try{this._socket.close()}catch(p$h){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},p$q.close=function(){if(null!=this._socket)try{this._socket.close()}catch(p$h){}},p$q._onOpen=function(p$h){this._connected=!0,this.event("open",p$h)},p$q._onMessage=function(p$h){if(p$h&&p$h.data){var p$q=p$h.data;if(this.disableInput&&p$q)this.event("message",p$q);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var p$f=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,p$q&&("string"==typeof p$q?this._input.writeUTFBytes(p$q):this._input.writeArrayBuffer(p$q),this._addInputPosition=this._input.pos,this._input.pos=p$f),this.event("message",p$q)}}},p$q._onClose=function(p$h){this._connected=!1,this.event("close",p$h)},p$q._onError=function(p$h){this.event("error",p$h)},p$q.send=function(p$h){this._socket.send(p$h)},p$q.flush=function(){if(this._output&&0<this._output.length){var p$q;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(p$h){p$q=p$h}this._output.endian=this.endian,this._output.clear(),p$q&&this.event("error",p$q)}},p$L(0,p$q,"input",function(){return this._input}),p$L(0,p$q,"output",function(){return this._output}),p$L(0,p$q,"connected",function(){return this._connected}),p$L(0,p$q,"endian",function(){return this._endian},function(p$h){this._endian=p$h,null!=this._input&&(this._input.endian=p$h),null!=this._output&&(this._output.endian=p$h)}),p$g.LITTLE_ENDIAN="littleEndian",p$g.BIG_ENDIAN="bigEndian"}(),function(p$h){function p$B(){p$B.__super.call(this),this._$1__id=++p$B._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(p$B._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,p$I.currentResourceManager&&p$I.currentResourceManager.addResource(this)}p$C(p$B,"laya.resource.Resource",p$Y);var p$q=p$B.prototype;return p$t.imps(p$q,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),p$q._setUrl=function(p$h){var p$q;this._url!==p$h&&(this._url&&((p$q=p$B._urlResourcesMap[this._url]).splice(p$q.indexOf(this),1),0===p$q.length&&delete p$B._urlResourcesMap[this._url]),p$h&&((p$q=p$B._urlResourcesMap[p$h])||(p$B._urlResourcesMap[p$h]=p$q=[]),p$q.push(this)),this._url=p$h)},p$q._getGroup=function(){return this._group},p$q._setGroup=function(p$h){var p$q;this._group!==p$h&&(this._group&&((p$q=p$B._groupResourcesMap[this._group]).splice(p$q.indexOf(this),1),0===p$q.length&&delete p$B._groupResourcesMap[this._group]),p$h&&((p$q=p$B._groupResourcesMap[p$h])||(p$B._groupResourcesMap[p$h]=p$q=[]),p$q.push(this)),this._group=p$h)},p$q._addReference=function(){this._referenceCount++},p$q._removeReference=function(){this._referenceCount--},p$q._clearReference=function(){this._referenceCount=0},p$q._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},p$q.recreateResource=function(){this.completeCreate()},p$q.disposeResource=function(){},p$q.activeResource=function(p$h){void 0===p$h&&(p$h=!1),this._lastUseFrameCount=p$Z.loopCount,!this._destroyed&&this.__loaded&&(this._released||p$h)&&this.recreateResource()},p$q.releaseResource=function(p$h){return void 0===p$h&&(p$h=!0),!(!p$h&&this.lock)&&(!(this._released&&!p$h)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},p$q.onAsynLoaded=function(p$h,p$q,p$f){throw new Error("Resource: must override this function!")},p$q.destroy=function(){var p$h;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete p$B._idResourcesMap[this.id],this._url&&((p$h=p$B._urlResourcesMap[this._url])&&(p$h.splice(p$h.indexOf(this),1),0===p$h.length&&delete p$B._urlResourcesMap[this.url]),p$Bh.clearRes(this._url),this.__loaded||p$d.cancelLoadByUrl(this._url)),this._group&&((p$h=p$B._groupResourcesMap[this._group]).splice(p$h.indexOf(this),1),0===p$h.length&&delete p$B._groupResourcesMap[this.url]))},p$q.completeCreate=function(){this._released=!1,this.event("recovered",this)},p$q.dispose=function(){this.destroy()},p$L(0,p$q,"memorySize",function(){return this._memorySize},function(p$h){var p$q=p$h-this._memorySize;this._memorySize=p$h,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,p$q),this.resourceManager&&this.resourceManager.addSize(p$q)}),p$L(0,p$q,"_loaded",null,function(p$h){this.__loaded=p$h}),p$L(0,p$q,"loaded",function(){return this.__loaded}),p$L(0,p$q,"id",function(){return this._$1__id}),p$L(0,p$q,"destroyed",function(){return this._destroyed}),p$L(0,p$q,"group",function(){return this._getGroup()},function(p$h){this._setGroup(p$h)}),p$L(0,p$q,"resourceManager",function(){return this._resourceManager}),p$L(0,p$q,"url",function(){return this._url}),p$L(0,p$q,"released",function(){return this._released}),p$L(0,p$q,"referenceCount",function(){return this._referenceCount}),p$B.getResourceByID=function(p$h){return p$B._idResourcesMap[p$h]},p$B.getResourceByURL=function(p$h,p$q){return void 0===p$q&&(p$q=0),null==p$B._urlResourcesMap[p$h]?null:p$B._urlResourcesMap[p$h][p$q]},p$B.getResourceCountByURL=function(p$h){return p$B._urlResourcesMap[p$h].length},p$B.destroyUnusedResources=function(p$h){var p$q;if(p$h){var p$f=p$B._groupResourcesMap[p$h];if(p$f)for(var p$g=p$f.slice(),p$$=0,p$P=p$g.length;p$$<p$P;p$$++)(p$q=p$g[p$$]).lock||0!==p$q._referenceCount||p$q.destroy()}else for(var p$S in p$B._idResourcesMap)(p$q=p$B._idResourcesMap[p$S]).lock||0!==p$q._referenceCount||p$q.destroy()},p$B._uniqueIDCounter=0,p$B._idResourcesMap={},p$B._urlResourcesMap={},p$B._groupResourcesMap={},p$B}()),p$Ch=function(p$h){function p$J(p$h,p$q){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,p$J.__super.call(this),p$h&&null!=p$h._addReference&&p$h._addReference(),this.setTo(p$h,p$q)}p$C(p$J,"laya.resource.Texture",p$Y);var p$q=p$J.prototype;return p$q._setUrl=function(p$h){this.url=p$h},p$q.setTo=function(p$h,p$q){if(p$h instanceof p$S.HTMLElement){var p$f=p$Gh.create("2D",p$h);this.bitmap=p$f}else this.bitmap=p$h;if(this.uv=p$q||p$J.DEF_UV,p$h){this._w=p$h.width,this._h=p$h.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var p$g=this;if(this._loaded)p$d.addToAtlas&&p$d.addToAtlas(p$g);else{var p$$=p$h;p$$ instanceof laya.resource.HTMLImage&&p$$.image&&p$$.image.addEventListener("load",function(p$h){p$d.addToAtlas&&p$d.addToAtlas(p$g)},!1)}}},p$q.active=function(){this.bitmap&&this.bitmap.activeResource()},p$q.destroy=function(p$h){if(void 0===p$h&&(p$h=!1),this.alphaTexture&&(this.alphaTexture.destroy(p$h),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var p$q=this.bitmap;p$h?(p$c.isConchApp&&p$q.source&&p$q.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,p$q.dispose(),p$q._clearReference()):(p$q._removeReference(),0==p$q.referenceCount&&(p$c.isConchApp&&p$q.source&&p$q.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,p$q.dispose())),this.url&&this===p$t.loader.getRes(this.url)&&p$t.loader.clearRes(this.url,p$h),this._loaded=!1}},p$q.load=function(p$h){var p$q=this;this._loaded=!1,p$h=p$z.customFormat(p$h);var p$f=this.bitmap||(this.bitmap=p$Rh.create(p$h));p$f.uri=p$h,p$f&&p$f._addReference();var p$g=this;p$f.onload=function(){p$f.onload=null,p$g._loaded=!0,p$q.sourceWidth=p$q._w=p$f.width,p$q.sourceHeight=p$q._h=p$f.height,p$g.event("loaded",this),p$d.addToAtlas&&p$d.addToAtlas(p$g)}},p$q.addTextureToAtlas=function(p$h){p$d.addTextureToAtlas(this)},p$q.getPixels=function(p$h,p$q,p$f,p$g){if(p$c.isConchApp){var p$$=this.bitmap;if(p$$.source&&p$$.source.getImageData){var p$P=p$$.source.getImageData(p$h,p$q,p$f,p$g),p$S=new Uint8Array(p$P);return Array.from(p$S)}return null}return p$c.isWebGL?p$d.getTexturePixels(this,p$h,p$q,p$f,p$g):(p$w.canvas.size(p$f,p$g),p$w.canvas.clear(),p$w.context.drawTexture(this,-p$h,-p$q,this.width,this.height,0,0),p$w.context.getImageData(0,0,p$f,p$g).data)},p$q.onAsynLoaded=function(p$h,p$q){if(p$q){if("function"!=typeof p$q._addReference)throw new Error("bitmap._addReference is not a function. "+p$q.className+" "+typeof p$q._addReference+" "+p$q.constructor);p$q._addReference()}this.setTo(p$q,this.uv),this._loaded&&this.event("loaded",this)},p$L(0,p$q,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),p$L(0,p$q,"loaded",function(){return this._loaded}),p$L(0,p$q,"released",function(){return!this.bitmap||this.bitmap.released}),p$L(0,p$q,"width",function(){return this._w?this._w:this.uv&&this.uv!==p$J.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(p$h){this._w=p$h,this.sourceWidth||(this.sourceWidth=p$h)}),p$L(0,p$q,"repeat",function(){return!p$c.isWebGL||!this.bitmap||this.bitmap.repeat},function(p$h){p$h&&p$c.isWebGL&&this.bitmap&&(this.bitmap.repeat=p$h)&&(this.bitmap.enableMerageInAtlas=!1)}),p$L(0,p$q,"height",function(){return this._h?this._h:this.uv&&this.uv!==p$J.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(p$h){this._h=p$h,this.sourceHeight||(this.sourceHeight=p$h)}),p$L(0,p$q,"isLinearSampling",function(){return!p$c.isWebGL||9728!=this.bitmap.minFifter},function(p$h){!p$h&&p$c.isWebGL&&(p$h||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),p$J.moveUV=function(p$h,p$q,p$f){for(var p$g=0;p$g<8;p$g+=2)p$f[p$g]+=p$h,p$f[p$g+1]+=p$q;return p$f},p$J.create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){void 0===p$P&&(p$P=0),void 0===p$S&&(p$S=0),void 0===p$B&&(p$B=0),void 0===p$r&&(p$r=0);var p$Y=p$h instanceof laya.resource.Texture,p$C=p$Y?p$h.uv:p$J.DEF_UV,p$U=p$Y?p$h.bitmap:p$h,p$u=p$d.isAtlas(p$U);if(p$u){var p$v=p$U._atlaser,p$L=p$h._atlasID;if(-1==p$L)throw new Error("create texture error");p$U=p$v._inAtlasTextureBitmapValue[p$L],p$C=p$v._inAtlasTextureOriUVValue[p$L]}var p$e=new p$J(p$U,null);p$U.width&&p$q+p$g>p$U.width&&(p$g=p$U.width-p$q),p$U.height&&p$f+p$$>p$U.height&&(p$$=p$U.height-p$f),p$e.width=p$g,p$e.height=p$$,p$e.offsetX=p$P,p$e.offsetY=p$S,p$e.sourceWidth=p$B||p$g,p$e.sourceHeight=p$r||p$$;var p$l=1/p$U.width,p$_=1/p$U.height;p$q*=p$l,p$f*=p$_,p$g*=p$l,p$$*=p$_;var p$N=p$e.uv[0],p$G=p$e.uv[1],p$m=p$e.uv[4],p$E=p$e.uv[5],p$R=p$m-p$N,p$t=p$E-p$G,p$X=p$J.moveUV(p$C[0],p$C[1],[p$q,p$f,p$q+p$g,p$f,p$q+p$g,p$f+p$$,p$q,p$f+p$$]);p$e.uv=[p$N+p$X[0]*p$R,p$G+p$X[1]*p$t,p$m-(1-p$X[2])*p$R,p$G+p$X[3]*p$t,p$m-(1-p$X[4])*p$R,p$E-(1-p$X[5])*p$t,p$N+p$X[6]*p$R,p$E-(1-p$X[7])*p$t],p$u&&p$e.addTextureToAtlas();var p$n=p$U.scaleRate;return p$n&&1!=p$n?(p$e.sourceWidth/=p$n,p$e.sourceHeight/=p$n,p$e.width/=p$n,p$e.height/=p$n,p$e.scaleRate=p$n,p$e.offsetX/=p$n,p$e.offsetY/=p$n):p$e.scaleRate=1,p$e},p$J.createFromTexture=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$h.scaleRate;1!=p$P&&(p$q*=p$P,p$f*=p$P,p$g*=p$P,p$$*=p$P);var p$S=p$n.TEMP.setTo(p$q-p$h.offsetX,p$f-p$h.offsetY,p$g,p$$),p$B=p$S.intersection(p$J._rect1.setTo(0,0,p$h.width,p$h.height),p$J._rect2);if(!p$B)return null;var p$r=p$J.create(p$h,p$B.x,p$B.y,p$B.width,p$B.height,p$B.x-p$S.x,p$B.y-p$S.y,p$g,p$$);if(p$r.bitmap&&p$r.bitmap._removeReference)return p$r.bitmap._removeReference(),p$r;var p$Y="bitmap:"+(p$r.bitmap?p$r.bitmap.constructor?p$r.bitmap.constructor.name:p$r.bitmap.__className:"")+", url:"+(p$h.url+" | "+(p$r.bitmap?p$r.bitmap.url:p$h.url))+", x="+p$q+",y="+p$f+",width="+p$g+",height="+p$$+", result="+(p$B?p$B.x+","+p$B.y+","+p$B.width+","+p$B.height:"null")+", rect="+p$S.x+","+p$S.y+","+p$S.width+","+p$S.height;throw new Error("报错：bitmap._removeReference is not a function  "+p$Y)},p$J.DEF_UV=[0,0,1,0,1,1,0,1],p$J.INV_UV=[0,1,1,1,1,0,0,0],p$J._rect1=new p$n,p$J._rect2=new p$n,p$J}(),p$h=function(p$h){var p$B;function p$P(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,p$P.__super.call(this)}p$C(p$P,"laya.utils.TimeLine",p$Y);var p$q=p$P.prototype;return p$q.to=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$$&&(p$$=0),this._create(p$h,p$q,p$f,p$g,p$$,!0)},p$q.from=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$$&&(p$$=0),this._create(p$h,p$q,p$f,p$g,p$$,!1)},p$q._create=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$F.getItemByClass("tweenData",p$B);return p$S.isTo=p$P,p$S.type=0,p$S.target=p$h,p$S.duration=p$f,p$S.data=p$q,p$S.startTime=this._startTime+p$$,p$S.endTime=p$S.startTime+p$S.duration,p$S.ease=p$g,this._startTime=Math.max(p$S.endTime,this._startTime),this._tweenDataList.push(p$S),this._startTimeSort=!0,this._endTimeSort=!0,this},p$q.addLabel=function(p$h,p$q){var p$f=p$F.getItemByClass("tweenData",p$B);return p$f.type=1,p$f.data=p$h,p$f.endTime=p$f.startTime=this._startTime+p$q,this._labelDic||(this._labelDic={}),this._labelDic[p$h]=p$f,this._tweenDataList.push(p$f),this},p$q.removeLabel=function(p$h){if(this._labelDic&&this._labelDic[p$h]){var p$q=this._labelDic[p$h];if(p$q){var p$f=this._tweenDataList.indexOf(p$q);-1<p$f&&this._tweenDataList.splice(p$f,1)}delete this._labelDic[p$h]}},p$q.gotoTime=function(p$h){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var p$q,p$f,p$g,p$$;for(var p$P in this._firstTweenDic)if(p$f=this._firstTweenDic[p$P])for(var p$S in p$f)p$f.diyTarget.hasOwnProperty(p$S)&&(p$f.diyTarget[p$S]=p$f[p$S]);for(p$P in this._tweenDic)(p$q=this._tweenDic[p$P]).clear(),delete this._tweenDic[p$P];if(this._index=0,this._gidIndex=0,this._currTime=p$h,this._lastTime=p$w.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=p$g=this._tweenDataList.concat(),p$g.sort(function(p$h,p$q){return p$h.endTime>p$q.endTime?1:p$h.endTime<p$q.endTime?-1:0})}else p$g=this._endTweenDataList;for(var p$B=0,p$r=p$g.length;p$B<p$r;p$B++)if(0==(p$$=p$g[p$B]).type){if(!(p$h>=p$$.endTime))break;this._index=Math.max(this._index,p$B+1);var p$Y=p$$.data;if(p$$.isTo)for(var p$C in p$Y)p$$.target[p$C]=p$Y[p$C]}for(p$B=0,p$r=this._tweenDataList.length;p$B<p$r;p$B++)0==(p$$=this._tweenDataList[p$B]).type&&p$h>=p$$.startTime&&p$h<p$$.endTime&&(this._index=Math.max(this._index,p$B+1),this._gidIndex++,(p$q=p$F.getItemByClass("tween",p$o))._create(p$$.target,p$$.data,p$$.duration,p$$.ease,p$N.create(this,this._animComplete,[this._gidIndex]),0,!1,p$$.isTo,!0,!1),p$q.setStartTime(this._currTime-(p$h-p$$.startTime)),p$q._updateEase(this._currTime),p$q.gid=this._gidIndex,this._tweenDic[this._gidIndex]=p$q)}},p$q.gotoLabel=function(p$h){if(null!=this._labelDic){var p$q=this._labelDic[p$h];p$q&&this.gotoTime(p$q.startTime)}},p$q.pause=function(){p$t.timer.clear(this,this._update)},p$q.resume=function(){this.play(this._currTime,this._loopKey)},p$q.play=function(p$h,p$q){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(p$h,p$q){return p$h.startTime>p$q.startTime?1:p$h.startTime<p$q.startTime?-1:0});for(var p$f=0,p$g=this._tweenDataList.length;p$f<p$g;p$f++){var p$$=this._tweenDataList[p$f];if(null!=p$$&&0==p$$.type){var p$P=p$$.target,p$S=p$P.$_GID||(p$P.$_GID=p$O.getGID()),p$B=null;for(var p$r in null==this._firstTweenDic[p$S]?((p$B={}).diyTarget=p$P,this._firstTweenDic[p$S]=p$B):p$B=this._firstTweenDic[p$S],p$$.data)null==p$B[p$r]&&(p$B[p$r]=p$P[p$r])}}}"string"==typeof p$h?this.gotoLabel(p$h):this.gotoTime(p$h),this._loopKey=p$q,this._lastTime=p$w.now(),p$t.timer.frameLoop(1,this,this._update)}},p$q._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var p$h in this._tweenDic)(p$q=this._tweenDic[p$h]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var p$q,p$f=p$w.now(),p$g=p$f-this._lastTime,p$$=this._currTime+=p$g*this.scale;for(p$h in this._lastTime=p$f,this._tweenDic)(p$q=this._tweenDic[p$h])._updateEase(p$$);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var p$P=this._tweenDataList[this._index];p$$>=p$P.startTime&&(this._index++,0==p$P.type?(this._gidIndex++,(p$q=p$F.getItemByClass("tween",p$o))._create(p$P.target,p$P.data,p$P.duration,p$P.ease,p$N.create(this,this._animComplete,[this._gidIndex]),0,!1,p$P.isTo,!0,!1),p$q.setStartTime(p$$),p$q.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=p$q)._updateEase(p$$)):this.event("label",p$P.data))}},p$q._animComplete=function(p$h){this._tweenDic[p$h]&&delete this._tweenDic[p$h]},p$q._complete=function(){this.event("complete")},p$q.reset=function(){var p$h;if(this._labelDic)for(p$h in this._labelDic)delete this._labelDic[p$h];for(p$h in this._tweenDic)this._tweenDic[p$h].clear(),delete this._tweenDic[p$h];for(p$h in this._firstTweenDic)delete this._firstTweenDic[p$h];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var p$q,p$f=0;for(p$q=this._tweenDataList.length,p$f=0;p$f<p$q;p$f++)this._tweenDataList[p$f]&&this._tweenDataList[p$f].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,p$t.timer.clear(this,this._update)},p$q.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},p$L(0,p$q,"index",function(){return this._frameIndex},function(p$h){this._frameIndex=p$h,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),p$L(0,p$q,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),p$P.to=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$$&&(p$$=0),(new p$P).to(p$h,p$q,p$f,p$g,p$$)},p$P.from=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$$&&(p$$=0),(new p$P).from(p$h,p$q,p$f,p$g,p$$)},p$P.__init$=function(){p$B=function(){function p$h(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return p$C(p$h,""),p$h.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,p$F.recover("tweenData",this)},p$h}()},p$P}(),p$Uh=function(p$$){function p$f(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,p$f.__super.call(this),this._style=p$B.EMPTY}p$C(p$f,"laya.display.Sprite",p$$);var p$h=p$f.prototype;return p$t.imps(p$h,{"laya.display.ILayout":!0}),p$h.createConchModel=function(){return new ConchNode},p$h.destroy=function(p$h){if(void 0===p$h&&(p$h=!0),this._releaseMem(),!this._destroyed){this.filters=null;var p$q=this.mask;p$q&&(this.mask=null,p$q.destroy(p$h))}p$$.prototype.destroy.call(this,p$h),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},p$h.updateZOrder=function(){p$O.updateOrder(this._childs)&&this.repaint()},p$h.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},p$h.setBounds=function(p$h){this._set$P("uBounds",p$h)},p$h.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new p$n),p$n._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},p$h.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new p$n),p$n._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},p$h._boundPointsToParent=function(p$h){void 0===p$h&&(p$h=!1);var p$q=0,p$f=0;this._style&&(p$q=this._style._tf.translateX,p$f=this._style._tf.translateY,p$h=p$h||0!==this._style._tf.rotate,this._style.scrollRect&&(p$q+=this._style.scrollRect.x,p$f+=this._style.scrollRect.y));var p$g=this._getBoundPointsM(p$h);if(!p$g||p$g.length<1)return p$g;if(8!=p$g.length&&(p$g=p$h?p$E.scanPList(p$g):p$n._getWrapRec(p$g,p$n.TEMP)._getBoundPoints()),!this.transform)return p$O.transPointList(p$g,this._x-p$q,this._y-p$f),p$g;var p$$=p$X.TEMP,p$P=0,p$S=p$g.length;for(p$P=0;p$P<p$S;p$P+=2)p$$.x=p$g[p$P],p$$.y=p$g[p$P+1],this.toParentPoint(p$$),p$g[p$P]=p$$.x,p$g[p$P+1]=p$$.y;return p$g},p$h.getGraphicBounds=function(p$h){return void 0===p$h&&(p$h=!1),this._graphics?this._graphics.getBounds(p$h):p$n.TEMP.setTo(0,0,0,0)},p$h._getBoundPointsM=function(p$h){if(void 0===p$h&&(p$h=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var p$q=p$O.clearArray(this._$P.temBM),p$f=p$n.TEMP;return p$f.copyFrom(this.scrollRect),p$O.concatArray(p$q,p$f._getBoundPoints()),p$q}for(var p$g,p$$,p$P,p$S=this._graphics?this._graphics.getBoundPoints():p$O.clearArray(this._$P.temBM),p$B=0,p$r=(p$P=this._childs).length;p$B<p$r;p$B++)(p$g=p$P[p$B])instanceof laya.display.Sprite&&1==p$g.visible&&(p$$=p$g._boundPointsToParent(p$h))&&(p$S=p$S?p$O.concatArray(p$S,p$$):p$$);return p$S},p$h.getStyle=function(){return this._style===p$B.EMPTY&&(this._style=new p$B),this._style},p$h.setStyle=function(p$h){this._style=p$h},p$h._adjustTransform=function(){this._tfChanged=!1;var p$h,p$q=this._style._tf,p$f=p$q.scaleX,p$g=p$q.scaleY;if(p$q.rotate||1!==p$f||1!==p$g||p$q.skewX||p$q.skewY){(p$h=this._transform||(this._transform=p$b.create())).bTransform=!0;var p$$=.0174532922222222*(p$q.rotate-p$q.skewX),p$P=.0174532922222222*(p$q.rotate+p$q.skewY),p$S=Math.cos(p$P),p$B=Math.sin(p$P),p$r=Math.sin(p$$),p$Y=Math.cos(p$$);return p$h.a=p$f*p$S,p$h.b=p$f*p$B,p$h.c=-p$g*p$r,p$h.d=p$g*p$Y,p$h.tx=p$h.ty=0,p$h}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,p$h},p$h.pos=function(p$h,p$q,p$f){if(void 0===p$f&&(p$f=!1),this._x!==p$h||this._y!==p$q){if(this.destroyed)return this;if(p$f){this._x=p$h,this._y=p$q,this.conchModel&&this.conchModel.pos(this._x,this._y);var p$g=this._parent;p$g&&0===p$g._repaint&&(p$g._repaint=1,p$g.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=p$h,this.y=p$q}return this},p$h.pivot=function(p$h,p$q){return this.pivotX=p$h,this.pivotY=p$q,this},p$h.size=function(p$h,p$q){return this.width=p$h,this.height=p$q,this},p$h.scale=function(p$h,p$q,p$f){void 0===p$f&&(p$f=!1);var p$g=this.getStyle(),p$$=p$g._tf;if(p$$.scaleX!=p$h||p$$.scaleY!=p$q){if(this.destroyed)return this;if(p$f){p$g.setScale(p$h,p$q),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(p$h,p$q),this._renderType|=4;var p$P=this._parent;p$P&&0===p$P._repaint&&(p$P._repaint=1,p$P.parentRepaint())}else this.scaleX=p$h,this.scaleY=p$q}return this},p$h.skew=function(p$h,p$q){return this.skewX=p$h,this.skewY=p$q,this},p$h.render=function(p$h,p$q,p$f){p$Z.spriteCount++,p$W.renders[this._renderType]._fun(this,p$h,p$q+this._x,p$f+this._y),this._repaint=0},p$h.drawToCanvas=function(p$h,p$q,p$f,p$g){if(p$c.isConchNode){var p$$=p$Gh.create("2D");return new p$M(p$h,p$q,p$$).ctx.setCanvasType(1),this.conchModel.drawToCanvas(p$$.source,p$f,p$g),p$$}return p$d.drawToCanvas(this,this._renderType,p$h,p$q,p$f,p$g)},p$h.customRender=function(p$h,p$q,p$f){this._renderType|=1024},p$h._applyFilters=function(){var p$h;if(!p$c.isWebGL&&((p$h=this._$P.filters)&&!(p$h.length<1)))for(var p$q=0,p$f=p$h.length;p$q<p$f;p$q++)p$h[p$q].action.apply(this._$P.cacheCanvas)},p$h._isHaveGlowFilter=function(){var p$h,p$q=0;if(this.filters)for(p$q=0;p$q<this.filters.length;p$q++)if(8==this.filters[p$q].type)return!0;for(p$q=0,p$h=this._childs.length;p$q<p$h;p$q++)if(this._childs[p$q]._isHaveGlowFilter())return!0;return!1},p$h.localToGlobal=function(p$h,p$q){void 0===p$q&&(p$q=!1),!0===p$q&&(p$h=new p$X(p$h.x,p$h.y));for(var p$f=this;p$f&&p$f!=p$t.stage;)p$h=p$f.toParentPoint(p$h),p$f=p$f.parent;return p$h},p$h.globalToLocal=function(p$h,p$q){void 0===p$q&&(p$q=!1),p$q&&(p$h=new p$X(p$h.x,p$h.y));for(var p$f=this,p$g=[];p$f&&p$f!=p$t.stage;)p$g.push(p$f),p$f=p$f.parent;for(var p$$=p$g.length-1;0<=p$$;)p$h=(p$f=p$g[p$$]).fromParentPoint(p$h),p$$--;return p$h},p$h.toParentPoint=function(p$h){if(!p$h)return p$h;p$h.x-=this.pivotX,p$h.y-=this.pivotY,this.transform&&this._transform.transformPoint(p$h),p$h.x+=this._x,p$h.y+=this._y;var p$q=this._style.scrollRect;return p$q&&(p$h.x-=p$q.x,p$h.y-=p$q.y),p$h},p$h.fromParentPoint=function(p$h){if(!p$h)return p$h;p$h.x-=this._x,p$h.y-=this._y;var p$q=this._style.scrollRect;return p$q&&(p$h.x+=p$q.x,p$h.y+=p$q.y),this.transform&&this._transform.invertTransformPoint(p$h),p$h.x+=this.pivotX,p$h.y+=this.pivotY,p$h},p$h.on=function(p$h,p$q,p$f,p$g){return 1!==this._mouseEnableState&&this.isMouseEvent(p$h)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(p$h,p$q,p$f,p$g,!1)):p$$.prototype.on.call(this,p$h,p$q,p$f,p$g)},p$h.once=function(p$h,p$q,p$f,p$g){return 1!==this._mouseEnableState&&this.isMouseEvent(p$h)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(p$h,p$q,p$f,p$g,!0)):p$$.prototype.once.call(this,p$h,p$q,p$f,p$g)},p$h._$2__onDisplay=function(){if(1!==this._mouseEnableState){var p$h=this;for(p$h=p$h.parent;p$h&&1!==p$h._mouseEnableState&&!p$h._getBit(2);)p$h.mouseEnabled=!0,p$h._setBit(2,!0),p$h=p$h.parent}},p$h.loadImage=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=this;return void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),this.graphics.loadImage(p$h,p$q,p$f,p$g,p$$,function(p$h){p$S.destroyed||(p$S.size(p$q+(p$g||p$h.width),p$f+(p$$||p$h.height)),p$S.repaint(),p$P&&p$P.runWith(p$h))}),this},p$h.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},p$h._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},p$h._childChanged=function(p$h){this._childs.length?this._renderType|=2048:this._renderType&=-2049,p$h&&this._get$P("hasZorder")&&p$t.timer.callLater(this,this.updateZOrder),this.repaint()},p$h.parentRepaint=function(){var p$h=this._parent;p$h&&0===p$h._repaint&&(p$h._repaint=1,p$h.parentRepaint())},p$h.startDrag=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){void 0===p$q&&(p$q=!1),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=300),void 0===p$P&&(p$P=!1),void 0===p$S&&(p$S=.92),this._$P.dragging||this._set$P("dragging",new p$V),this._$P.dragging.start(this,p$h,p$q,p$f,p$g,p$$,p$P,p$S)},p$h.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},p$h._releaseMem=function(){if(this._$P){var p$h=this._$P.cacheCanvas;p$h&&p$h.ctx&&(p$F.recover("RenderContext",p$h.ctx),p$h.ctx.canvas.size(0,0),p$h.ctx=null);var p$q=this._$P._filterCache;p$q&&(p$q.destroy(),p$q.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},p$h._setDisplay=function(p$h){p$h||this._releaseMem(),p$$.prototype._setDisplay.call(this,p$h)},p$h.hitTestPoint=function(p$h,p$q){var p$f=this.globalToLocal(p$X.TEMP.setTo(p$h,p$q));return p$h=p$f.x,p$q=p$f.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?p$n.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(p$h,p$q)},p$h.getMousePoint=function(){return this.globalToLocal(p$X.TEMP.setTo(p$t.stage.mouseX,p$t.stage.mouseY))},p$h._getWords=function(){return null},p$h._addChildsToLayout=function(p$h){var p$q=this._getWords();if(null==p$q&&0==this._childs.length)return!1;if(p$q)for(var p$f=0,p$g=p$q.length;p$f<p$g;p$f++)p$h.push(p$q[p$f]);p$f=0;for(var p$$=this._childs.length;p$f<p$$;++p$f){var p$P=this._childs[p$f];p$P._style._enableLayout()&&p$P._addToLayout(p$h)}return!0},p$h._addToLayout=function(p$h){this._style.absolute||(this._style.block?p$h.push(this):this._addChildsToLayout(p$h)&&(this.x=this.y=0))},p$h._isChar=function(){return!1},p$h._getCSSStyle=function(){return this._style.getCSSStyle()},p$h._setAttributes=function(p$h,p$q){switch(p$h){case"x":this.x=parseFloat(p$q);break;case"y":this.y=parseFloat(p$q);break;case"width":this.width=parseFloat(p$q);break;case"height":this.height=parseFloat(p$q);break;default:this[p$h]=p$q}},p$h._layoutLater=function(){this.parent&&this.parent._layoutLater()},p$L(0,p$h,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(p$h){this._optimizeScrollRect!=p$h&&(this._optimizeScrollRect=p$h,this.conchModel&&this.conchModel.optimizeScrollRect(p$h))}),p$L(0,p$h,"customRenderEnable",null,function(p$h){if(p$h&&(this._renderType|=1024,p$c.isConchNode)){p$f.CustomList.push(this);var p$q=new p$Gh("2d");p$q._setContext(new CanvasRenderingContext2D),this.customContext=new p$M(0,0,p$q),p$q.context.setCanvasType&&p$q.context.setCanvasType(2),this.conchModel.custom(p$q.context)}}),p$L(0,p$h,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(p$h){this.cacheAs=p$h?this._$P.hasFilter?"none":"normal":"none"}),p$L(0,p$h,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(p$h){var p$q=this._$P.cacheCanvas;if(p$h!==(p$q?p$q.type:"none")){if("none"!==p$h)this._getBit(1)||this._setUpNoticeType(1),p$q||(p$q=this._set$P("cacheCanvas",p$F.getItemByClass("cacheCanvas",Object))),p$q.type=p$h,p$q.reCache=!0,this._renderType|=16,"bitmap"==p$h&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(p$q){var p$f=p$q;p$f&&p$f.ctx&&(p$F.recover("RenderContext",p$f.ctx),p$f.ctx.canvas.size(0,0),p$f.ctx=null),p$F.recover("cacheCanvas",p$q)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),p$L(0,p$h,"zOrder",function(){return this._zOrder},function(p$h){this._zOrder!=p$h&&(this._zOrder=p$h,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(p$h),this._parent&&(p$h&&this._parent._set$P("hasZorder",!0),p$t.timer.callLater(this._parent,this.updateZOrder)))}),p$L(0,p$h,"rotation",function(){return this._style._tf.rotate},function(p$h){var p$q=this.getStyle();if(p$q._tf.rotate!==p$h){p$q.setRotate(p$h),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(p$h),this._renderType|=4;var p$f=this._parent;p$f&&0===p$f._repaint&&(p$f._repaint=1,p$f.parentRepaint())}}),p$L(0,p$h,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(p$h){this._width!==p$h&&(this._width=p$h,this.conchModel&&this.conchModel.size(p$h,this._height),this.repaint())}),p$L(0,p$h,"x",function(){return this._x},function(p$h){if(this._x!==p$h){if(this.destroyed)return;this._x=p$h,this.conchModel&&this.conchModel.pos(p$h,this._y);var p$q=this._parent;p$q&&0===p$q._repaint&&(p$q._repaint=1,p$q.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),p$L(0,p$h,"globalScaleY",function(){for(var p$h=1,p$q=this;p$q&&p$q!==p$t.stage;)p$h*=p$q.scaleY,p$q=p$q.parent;return p$h}),p$L(0,p$h,"hitArea",function(){return this._$P.hitArea},function(p$h){this._set$P("hitArea",p$h)}),p$L(0,p$h,"staticCache",function(){return this._$P.staticCache},function(p$h){this._set$P("staticCache",p$h),p$h||this.reCache()}),p$L(0,p$h,"texture",function(){return this._texture},function(p$h){this._texture!=p$h&&(this._texture=p$h,this.graphics.cleanByTexture(p$h,0,0))}),p$L(0,p$h,"y",function(){return this._y},function(p$h){if(this._y!==p$h){if(this.destroyed)return;this._y=p$h,this.conchModel&&this.conchModel.pos(this._x,p$h);var p$q=this._parent;p$q&&0===p$q._repaint&&(p$q._repaint=1,p$q.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),p$L(0,p$h,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(p$h){this._height!==p$h&&(this._height=p$h,this.conchModel&&this.conchModel.size(this._width,p$h),this.repaint())}),p$L(0,p$h,"blendMode",function(){return this._style.blendMode},function(p$h){this.getStyle().blendMode=p$h,this.conchModel&&this.conchModel.blendMode(p$h),p$h&&"source-over"!=p$h?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),p$L(0,p$h,"scaleX",function(){return this._style._tf.scaleX},function(p$h){var p$q=this.getStyle();if(p$q._tf.scaleX!==p$h){p$q.setScaleX(p$h),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(p$h,p$q._tf.scaleY),this._renderType|=4;var p$f=this._parent;p$f&&0===p$f._repaint&&(p$f._repaint=1,p$f.parentRepaint())}}),p$L(0,p$h,"scaleY",function(){return this._style._tf.scaleY},function(p$h){var p$q=this.getStyle();if(p$q._tf.scaleY!==p$h){p$q.setScaleY(p$h),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(p$q._tf.scaleX,p$h),this._renderType|=4;var p$f=this._parent;p$f&&0===p$f._repaint&&(p$f._repaint=1,p$f.parentRepaint())}}),p$L(0,p$h,"stage",function(){return p$t.stage}),p$L(0,p$h,"skewX",function(){return this._style._tf.skewX},function(p$h){var p$q=this.getStyle();if(p$q._tf.skewX!==p$h){p$q.setSkewX(p$h),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(p$h,p$q._tf.skewY),this._renderType|=4;var p$f=this._parent;p$f&&0===p$f._repaint&&(p$f._repaint=1,p$f.parentRepaint())}}),p$L(0,p$h,"scrollRect",function(){return this._style.scrollRect},function(p$h){this.getStyle().scrollRect=p$h,this.repaint(),p$h?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(p$h.x,p$h.y,p$h.width,p$h.height)):(this._renderType&=-129,this.conchModel&&(p$f.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),p$L(0,p$h,"skewY",function(){return this._style._tf.skewY},function(p$h){var p$q=this.getStyle();if(p$q._tf.skewY!==p$h){p$q.setSkewY(p$h),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(p$q._tf.skewX,p$h),this._renderType|=4;var p$f=this._parent;p$f&&0===p$f._repaint&&(p$f._repaint=1,p$f.parentRepaint())}}),p$L(0,p$h,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(p$h){this._tfChanged=!1,(this._transform=p$h)&&(this._x=p$h.tx,this._y=p$h.ty,p$h.tx=p$h.ty=0,this.conchModel&&this.conchModel.transform(p$h.a,p$h.b,p$h.c,p$h.d,this._x,this._y)),p$h?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),p$L(0,p$h,"pivotX",function(){return this._style._tf.translateX},function(p$h){this.getStyle().setTranslateX(p$h),this.conchModel&&this.conchModel.pivot(p$h,this._style._tf.translateY),this.repaint()}),p$L(0,p$h,"pivotY",function(){return this._style._tf.translateY},function(p$h){this.getStyle().setTranslateY(p$h),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,p$h),this.repaint()}),p$L(0,p$h,"alpha",function(){return this._style.alpha},function(p$h){this._style&&this._style.alpha!==p$h&&(p$h=p$h<0?0:1<p$h?1:p$h,this.getStyle().alpha=p$h,this.conchModel&&this.conchModel.alpha(p$h),1!==p$h?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),p$L(0,p$h,"visible",function(){return this._style.visible},function(p$h){this._style&&this._style.visible!==p$h&&(this.getStyle().visible=p$h,this.conchModel&&this.conchModel.visible(p$h),this.parentRepaint())}),p$L(0,p$h,"graphics",function(){return this._graphics||(this.graphics=p$d.createGraphics())},function(p$h){this._graphics&&(this._graphics._sp=null),(this._graphics=p$h)?(this._renderType&=-2,this._renderType|=512,(p$h._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(p$f.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),p$L(0,p$h,"filters",function(){return this._$P.filters},function(p$h){p$h&&0===p$h.length&&(p$h=null),this._$P.filters!=p$h&&(this._set$P("filters",p$h?p$h.slice():null),p$c.isConchApp&&(this.conchModel&&(p$f.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),p$c.isWebGL&&(p$h&&p$h.length?this._renderType|=32:this._renderType&=-33),p$h&&0<p$h.length?(this._getBit(1)||this._setUpNoticeType(1),p$c.isWebGL&&1==p$h.length&&p$h[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(p$c.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),p$L(0,p$h,"parent",p$$.prototype._$get_parent,function(p$h){p$t.superSet(p$hh,this,"parent",p$h),p$h&&this._getBit(2)&&this._$2__onDisplay()}),p$L(0,p$h,"mask",function(){return this._$P._mask},function(p$h){p$h&&this.mask&&this.mask._$P.maskParent||(p$h?(this.cacheAs="bitmap",this._set$P("_mask",p$h),p$h._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",p$h),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(p$h?p$h.conchModel:null),this._renderType|=64,this.parentRepaint())}),p$L(0,p$h,"mouseEnabled",function(){return 1<this._mouseEnableState},function(p$h){this._mouseEnableState=p$h?2:1}),p$L(0,p$h,"globalScaleX",function(){for(var p$h=1,p$q=this;p$q&&p$q!==p$t.stage;)p$h*=p$q.scaleX,p$q=p$q.parent;return p$h}),p$L(0,p$h,"mouseX",function(){return this.getMousePoint().x}),p$L(0,p$h,"mouseY",function(){return this.getMousePoint().y}),p$f.fromImage=function(p$h){return(new p$f).loadImage(p$h)},p$f._cachePool=[],p$f.CustomList=[],p$r(p$f,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=p$S.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),p$f}(p$hh),p$uh=function(p$h){function p$q(p$h){this._audio=null,this._onEnd=null,this._resumePlay=null,p$q.__super.call(this),this._onEnd=p$O.bind(this.__onEnd,this),this._resumePlay=p$O.bind(this.__resumePlay,this),p$h.addEventListener("ended",this._onEnd),this._audio=p$h}p$C(p$q,"laya.media.h5audio.AudioSoundChannel",p$gh);var p$f=p$q.prototype;return p$f.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(p$t.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},p$f.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,p$w.container.appendChild(this._audio),this._audio.play()}catch(p$h){this.event("error")}},p$f.play=function(p$h){this.isStopped=!1;try{this._audio.playbackRate=p$A.playbackRate,this._audio.currentTime=this.startTime}catch(p$h){return void this._audio.addEventListener("canplay",this._resumePlay)}p$A.addChannel(this),p$w.container.appendChild(this._audio),!p$h&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},p$f.stop=function(){this.isStopped=!0,p$A.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&p$c.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),p$w.onIE||this._audio!=p$fh._musicAudio&&p$F.recover("audio:"+this.url,this._audio),p$w.removeElement(this._audio),this._audio=null)},p$f.pause=function(){this.isStopped=!0,p$A.removeChannel(this),"pause"in this._audio&&this._audio.pause()},p$f.resume=function(){this._audio&&(this.isStopped=!1,p$A.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},p$L(0,p$f,"position",function(){return this._audio?this._audio.currentTime:0}),p$L(0,p$f,"duration",function(){return this._audio?this._audio.duration:0}),p$L(0,p$f,"volume",function(){return this._audio?this._audio.volume:1},function(p$h){this._audio&&(this._audio.volume=p$h)}),p$q}(),p$vh=function(p$h){function p$q(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=p$Ph.ctx,p$q.__super.call(this),this._onPlayEnd=p$O.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}p$C(p$q,"laya.media.webaudio.WebAudioSoundChannel",p$gh);var p$f=p$q.prototype;return p$f.play=function(p$h){if(p$A.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var p$q=this.context,p$f=this.gain,p$g=p$q.createBufferSource();(this.bufferSource=p$g).buffer=this.audioBuffer,p$g.connect(p$f),p$f&&p$f.disconnect(),p$f.connect(p$q.destination),p$g.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=p$w.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(p$g.loop=!0),p$g.playbackRate.setTargetAtTime?p$g.playbackRate.setTargetAtTime(p$A.playbackRate,this.context.currentTime,.1):p$g.playbackRate.value=p$A.playbackRate,p$g.start(0,this.startTime),!p$h&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},p$f.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(p$t.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},p$f._clearBufferSource=function(){if(this.bufferSource){var p$h=this.bufferSource;p$h.stop?p$h.stop(0):p$h.noteOff(0),p$h.disconnect(0),p$h.onended=null,p$q._tryCleanFailed||this._tryClearBuffer(p$h),this.bufferSource=null}},p$f._tryClearBuffer=function(p$h){try{p$h.buffer=null}catch(p$h){p$q._tryCleanFailed=!0}},p$f.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,p$A.removeChannel(this),this.startHandler=null,this.completeHandler=null},p$f.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,p$A.removeChannel(this)},p$f.resume=function(){this.startTime=this._pauseTime,this.play(!1)},p$L(0,p$f,"position",function(){return this.bufferSource?(p$w.now()-this._startTime)/1e3+this.startTime:0}),p$L(0,p$f,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),p$L(0,p$f,"volume",function(){return this._volume},function(p$h){this.isStopped||(this._volume=p$h,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(p$h,this.context.currentTime,.1):this.gain.gain.value=p$h)}),p$q._tryCleanFailed=!1,p$q}(),p$Lh=function(p$h){function p$q(){p$q.__super.call(this),this._w=0,this._h=0}p$C(p$q,"laya.resource.Bitmap",p$Yh);var p$f=p$q.prototype;return p$L(0,p$f,"width",function(){return this._w}),p$L(0,p$f,"height",function(){return this._h}),p$L(0,p$f,"source",function(){return this._source}),p$q}(),p$eh=function(p$q){function p$h(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,p$h.__super.call(this),this._interval=p$g.animationInterval,this._setUpNoticeType(1)}p$C(p$h,"laya.display.AnimationPlayerBase",p$q);var p$f=p$h.prototype;return p$f.play=function(p$h,p$q,p$f,p$g){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=!0),void 0===p$f&&(p$f=""),void 0===p$g&&(p$g=!0),this._isPlaying=!0,this.index="string"==typeof p$h?this._getFrameByLabel(p$h):p$h,this.loop=p$q,this._actionName=p$f,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},p$f._getFrameByLabel=function(p$h){var p$q=0;for(p$q=0;p$q<this._count;p$q++)if(this._labels[p$q]&&0<=this._labels[p$q].indexOf(p$h))return p$q;return 0},p$f._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},p$f._setControlNode=function(p$h){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=p$h)&&p$h!=this&&(p$h.on("display",this,this._checkResumePlaying),p$h.on("undisplay",this,this._checkResumePlaying))},p$f._setDisplay=function(p$h){p$q.prototype._setDisplay.call(this,p$h),this._checkResumePlaying()},p$f._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},p$f.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},p$f.addLabel=function(p$h,p$q){this._labels||(this._labels={}),this._labels[p$q]||(this._labels[p$q]=[]),this._labels[p$q].push(p$h)},p$f.removeLabel=function(p$h){if(p$h){if(this._labels)for(var p$q in this._labels)this._removeLabelFromLabelList(this._labels[p$q],p$h)}else this._labels=null},p$f._removeLabelFromLabelList=function(p$h,p$q){if(p$h)for(var p$f=p$h.length-1;0<=p$f;p$f--)p$h[p$f]==p$q&&p$h.splice(p$f,1)},p$f.gotoAndStop=function(p$h){this.index="string"==typeof p$h?this._getFrameByLabel(p$h):p$h,this.stop()},p$f._displayToIndex=function(p$h){},p$f.clear=function(){this.stop(),this._labels=null},p$L(0,p$f,"interval",function(){return this._interval},function(p$h){this._interval!=p$h&&(this._frameRateChanged=!0,this._interval=p$h,this._isPlaying&&0<p$h&&this.timerLoop(p$h,this,this._frameLoop,null,!0,!0))}),p$L(0,p$f,"isPlaying",function(){return this._isPlaying}),p$L(0,p$f,"index",function(){return this._index},function(p$h){if(this._index=p$h,this._displayToIndex(p$h),this._labels&&this._labels[p$h])for(var p$q=this._labels[p$h],p$f=0,p$g=p$q.length;p$f<p$g;p$f++)this.event("label",p$q[p$f])}),p$L(0,p$f,"count",function(){return this._count}),p$h.WRAP_POSITIVE=0,p$h.WRAP_REVERSE=1,p$h.WRAP_PINGPONG=2,p$h}(p$Uh),p$lh=function(p$q){function p$v(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,p$v.__super.call(this),this.overflow=p$v.VISIBLE,this._style=new p$qh(this),this._style.wordWrap=!1}p$C(p$v,"laya.display.Text",p$q);var p$h=p$v.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._lines=null,this._words&&(this._words.length=0,this._words=null)},p$h._getBoundPointsM=function(p$h){void 0===p$h&&(p$h=!1);var p$q=p$n.TEMP;return p$q.setTo(0,0,this.width,this.height),p$q._getBoundPoints()},p$h.getGraphicBounds=function(p$h){void 0===p$h&&(p$h=!1);var p$q=p$n.TEMP;return p$q.setTo(0,0,this.width,this.height),p$q},p$h._getCSSStyle=function(){return this._style},p$h.lang=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C){if(p$h=p$v.langPacks&&p$v.langPacks[p$h]?p$v.langPacks[p$h]:p$h,arguments.length<2)this._text=p$h;else{for(var p$U=0,p$u=arguments.length;p$U<p$u;p$U++)p$h=p$h.replace("{"+p$U+"}",arguments[p$U+1]);this._text=p$h}},p$h._isPassWordMode=function(){var p$h=this._style.password;return"prompt"in this&&this.prompt==this._text&&(p$h=!1),p$h},p$h._getPassWordTxt=function(p$h){var p$q;p$q="";for(var p$f=p$h.length;0<p$f;p$f--)p$q+="●";return p$q},p$h.renderText=function(p$h,p$q){var p$f=this.graphics;p$f.clear(!0);var p$g=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(p$w.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);p$w.context.font=p$g;var p$$=this.padding,p$P=p$$[3],p$S="left",p$B=this._lines,p$r=this.leading+this._charSize.height,p$Y=this._currBitmapFont;p$Y&&(p$r=this.leading+p$Y.getMaxHeight());var p$C=p$$[0];if(!p$Y&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(p$S="right",p$P=this._width-p$$[1]):"center"==this.align&&(p$S="center",p$P=.5*this._width+p$$[3]-p$$[1])),0<this._height){var p$U=this._textHeight>this._height?"top":this.valign;"middle"===p$U?p$C=.5*(this._height-p$q*p$r)+p$$[0]-p$$[2]:"bottom"===p$U&&(p$C=this._height-p$q*p$r-p$$[2])}var p$u=this._style;if(p$Y&&p$Y.autoScaleSize)var p$v=p$Y.fontSize/this.fontSize;if(this._clipPoint)if(p$f.save(),p$Y&&p$Y.autoScaleSize){var p$L=0,p$e=0;p$L=this._width?this._width-p$$[3]-p$$[1]:this._textWidth,p$e=this._height?this._height-p$$[0]-p$$[2]:this._textHeight,p$L*=p$v,p$e*=p$v,p$f.clipRect(p$$[3],p$$[0],p$L,p$e)}else p$f.clipRect(p$$[3],p$$[0],this._width?this._width-p$$[3]-p$$[1]:this._textWidth,this._height?this._height-p$$[0]-p$$[2]:this._textHeight);var p$l=p$u.password;"prompt"in this&&this.prompt==this._text&&(p$l=!1);for(var p$_=0,p$N=0,p$G=Math.min(this._lines.length,p$q+p$h)||1,p$m=p$h;p$m<p$G;p$m++){var p$E,p$R=p$B[p$m];if(p$l){var p$t=p$R.length;p$R="";for(var p$X=p$t;0<p$X;p$X--)p$R+="●"}if(p$_=p$P-(this._clipPoint?this._clipPoint.x:0),p$N=p$C+p$r*p$m-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(p$S,p$_,p$N,p$m),p$Y){var p$n=this.width;p$Y.autoScaleSize&&(p$n=this.width*p$v),p$Y.drawText(p$R,this,p$_,p$N,this.align,p$n)}else p$c.isWebGL?(this._words||(this._words=[]),(p$E=this._words.length>p$m-p$h?this._words[p$m-p$h]:new p$a).setText(p$R)):p$E=p$R,p$u.stroke?p$f.fillBorderText(p$E,p$_,p$N,p$g,this.color,p$u.strokeColor,p$u.stroke,p$S):p$f.fillText(p$E,p$_,p$N,p$g,this.color,p$S)}if(p$Y&&p$Y.autoScaleSize){var p$J=1/p$v;this.scale(p$J,p$J)}this._clipPoint&&p$f.restore(),this._startX=p$P,this._startY=p$C},p$h.drawUnderline=function(p$h,p$q,p$f,p$g){var p$$=this._lineWidths[p$g];switch(p$h){case"center":p$q-=p$$/2;break;case"right":p$q-=p$$}p$f+=this._charSize.height,this._graphics.drawLine(p$q,p$f,p$q+p$$,p$f,this.underlineColor||this.color,1)},p$h.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);p$w.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new p$X(0,0)):this._clipPoint=null;var p$h=this._lines.length;if(this.overflow!=p$v.VISIBLE){var p$q=this.overflow==p$v.HIDDEN?Math.floor:Math.ceil;p$h=Math.min(p$h,p$q((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var p$f=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(p$f,p$h),this.repaint()},p$h.evalTextSize=function(){var p$h,p$q=NaN;p$h=Math.max.apply(this,this._lineWidths),p$q=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],p$h==this._textWidth&&p$q==this._textHeight||(this._textWidth=p$h,this._textHeight=p$q,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},p$h.checkEnabledViewportOrNot=function(){return this.overflow==p$v.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},p$h.changeText=function(p$h){this._text!==p$h&&(this.lang(p$h+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},p$h.parseLines=function(p$h){var p$q=this.wordWrap||this.overflow==p$v.HIDDEN;if(p$q)var p$f=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var p$g=p$w.context.measureText(p$v._testWord);p$c.isConchApp&&0===p$g.width&&0===p$g.height&&(p$g=p$w.context.measureText("W")),this._charSize.width=p$g.width,this._charSize.height=p$g.height||this.fontSize}for(var p$$=p$h.replace(/\r\n/g,"\n").split("\n"),p$P=0,p$S=p$$.length;p$P<p$S;p$P++){var p$B=p$$[p$P];p$q?this.parseLine(p$B,p$f):(this._lineWidths.push(this.getTextWidth(p$B)),this._lines.push(p$B))}},p$h.parseLine=function(p$h,p$q){p$w.context;var p$f,p$g=this._lines,p$$=0,p$P=NaN,p$S=NaN,p$B=0;if((p$P=this.getTextWidth(p$h))<=p$q)return p$g.push(p$h),void this._lineWidths.push(p$P);p$P=this._charSize.width,0==(p$$=Math.floor(p$q/p$P))&&(p$$=1),p$S=p$P=this.getTextWidth(p$h.substring(0,p$$));for(var p$r=p$$,p$Y=p$h.length;p$r<p$Y;p$r++)if(p$q<(p$S+=p$P=this.getTextWidth(p$h.charAt(p$r))))if(this.wordWrap){var p$C=p$h.substring(p$B,p$r);if(p$C.charCodeAt(p$C.length-1)<255?(p$f=/(?:\w|-)+$/.exec(p$C))&&(p$r=p$f.index+p$B,0==p$f.index?p$r+=p$C.length:p$C=p$h.substring(p$B,p$r)):p$v.RightToLeft&&(p$f=/([\u0600-\u06FF])+$/.exec(p$C))&&(p$r=p$f.index+p$B,0==p$f.index?p$r+=p$C.length:p$C=p$h.substring(p$B,p$r)),p$g.push(p$C),this._lineWidths.push(p$S-p$P),!((p$B=p$r)+p$$<p$Y)){p$g.push(p$h.substring(p$B,p$Y)),this._lineWidths.push(this.getTextWidth(p$g[p$g.length-1])),p$B=-1;break}p$r+=p$$,p$S=p$P=this.getTextWidth(p$h.substring(p$B,p$r)),p$r--}else if(this.overflow==p$v.HIDDEN)return p$g.push(p$h.substring(0,p$r)),void this._lineWidths.push(this.getTextWidth(p$g[p$g.length-1]));this.wordWrap&&-1!=p$B&&(p$g.push(p$h.substring(p$B,p$Y)),this._lineWidths.push(this.getTextWidth(p$g[p$g.length-1])))},p$h.getTextWidth=function(p$h){return this._currBitmapFont?this._currBitmapFont.getTextWidth(p$h):p$w.context.measureText(p$h).width},p$h.getWordWrapWidth=function(){var p$h=this.padding,p$q=NaN;return(p$q=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(p$q=this.wordWrap?100:p$w.width),p$q<=0&&(p$q=100),p$q-p$h[3]-p$h[1]},p$h.getCharPoint=function(p$h,p$q){this._isChanged&&p$t.timer.runCallLater(this,this.typeset);for(var p$f=0,p$g=this._lines,p$$=0,p$P=0,p$S=p$g.length;p$P<p$S;p$P++){if(p$h<(p$f+=p$g[p$P].length)){var p$B=p$P;break}p$$=p$f}var p$r=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;p$w.context.font=p$r;var p$Y=this.getTextWidth(this._text.substring(p$$,p$h));return(p$q||new p$X).setTo(this._startX+p$Y-(this._clipPoint?this._clipPoint.x:0),this._startY+p$B*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},p$L(0,p$h,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(p$h){p$h!=this._width&&(p$t.superSet(p$Uh,this,"width",p$h),this.isChanged=!0)}),p$L(0,p$h,"textWidth",function(){return this._isChanged&&p$t.timer.runCallLater(this,this.typeset),this._textWidth}),p$L(0,p$h,"height",function(){return this._height?this._height:this.textHeight},function(p$h){p$h!=this._height&&(p$t.superSet(p$Uh,this,"height",p$h),this.isChanged=!0)}),p$L(0,p$h,"textHeight",function(){return this._isChanged&&p$t.timer.runCallLater(this,this.typeset),this._textHeight}),p$L(0,p$h,"padding",function(){return this._getCSSStyle().padding},function(p$h){this._getCSSStyle().padding=p$h,this.isChanged=!0}),p$L(0,p$h,"bold",function(){return this._getCSSStyle().bold},function(p$h){this._getCSSStyle().bold=p$h,this.isChanged=!0}),p$L(0,p$h,"text",function(){return this._text||""},function(p$h){this._text!==p$h&&(this.lang(p$h+""),this.isChanged=!0,this.event("change"))}),p$L(0,p$h,"color",function(){return this._getCSSStyle().color},function(p$h){this._getCSSStyle().color!=p$h&&(this._getCSSStyle().color=p$h,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),p$L(0,p$h,"font",function(){return this._getCSSStyle().fontFamily},function(p$h){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),p$v._bitmapFonts&&p$v._bitmapFonts[p$h]&&(this._currBitmapFont=p$v._bitmapFonts[p$h]),this._getCSSStyle().fontFamily=p$h,this.isChanged=!0}),p$L(0,p$h,"fontSize",function(){return this._getCSSStyle().fontSize},function(p$h){this._getCSSStyle().fontSize=p$h,this.isChanged=!0}),p$L(0,p$h,"italic",function(){return this._getCSSStyle().italic},function(p$h){this._getCSSStyle().italic=p$h,this.isChanged=!0}),p$L(0,p$h,"align",function(){return this._getCSSStyle().align},function(p$h){this._getCSSStyle().align=p$h,this.isChanged=!0}),p$L(0,p$h,"valign",function(){return this._getCSSStyle().valign},function(p$h){this._getCSSStyle().valign=p$h,this.isChanged=!0}),p$L(0,p$h,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(p$h){this._getCSSStyle().wordWrap=p$h,this.isChanged=!0}),p$L(0,p$h,"leading",function(){return this._getCSSStyle().leading},function(p$h){this._getCSSStyle().leading=p$h,this.isChanged=!0}),p$L(0,p$h,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(p$h){this._getCSSStyle().backgroundColor=p$h,this.isChanged=!0}),p$L(0,p$h,"borderColor",function(){return this._getCSSStyle().borderColor},function(p$h){this._getCSSStyle().borderColor=p$h,this.isChanged=!0}),p$L(0,p$h,"stroke",function(){return this._getCSSStyle().stroke},function(p$h){this._getCSSStyle().stroke=p$h,this.isChanged=!0}),p$L(0,p$h,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(p$h){this._getCSSStyle().strokeColor=p$h,this.isChanged=!0}),p$L(0,p$h,"isChanged",null,function(p$h){this._isChanged!==p$h&&(this._isChanged=p$h)&&p$t.timer.callLater(this,this.typeset)}),p$L(0,p$h,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(p$h){if(!(this.overflow!=p$v.SCROLL||this.textWidth<this._width)&&this._clipPoint){p$h=p$h<this.padding[3]?this.padding[3]:p$h;var p$q=this._textWidth-this._width;p$h=p$q<p$h?p$q:p$h;var p$f=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=p$h,this.renderText(this._lastVisibleLineIndex,p$f)}}),p$L(0,p$h,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(p$h){if(!(this.overflow!=p$v.SCROLL||this.textHeight<this._height)&&this._clipPoint){p$h=p$h<this.padding[0]?this.padding[0]:p$h;var p$q=this._textHeight-this._height,p$f=(p$h=p$q<p$h?p$q:p$h)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=p$f;var p$g=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=p$h,this.renderText(p$f,p$g)}}),p$L(0,p$h,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),p$L(0,p$h,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),p$L(0,p$h,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),p$L(0,p$h,"underlineColor",function(){return this._underlineColor},function(p$h){this._underlineColor=p$h,this._isChanged=!0,this.typeset()}),p$v.registerBitmapFont=function(p$h,p$q){p$v._bitmapFonts||(p$v._bitmapFonts={}),p$v._bitmapFonts[p$h]=p$q},p$v.unregisterBitmapFont=function(p$h,p$q){if(void 0===p$q&&(p$q=!0),p$v._bitmapFonts&&p$v._bitmapFonts[p$h]){var p$f=p$v._bitmapFonts[p$h];p$q&&p$f.destroy(),delete p$v._bitmapFonts[p$h]}},p$v.setTextRightToLeft=function(){var p$h;(p$h=p$w.canvas.source.style).display="none",p$h.position="absolute",p$h.direction="rtl",p$c._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,p$w.document.body.appendChild(p$w.canvas.source)},p$v.supportFont=function(p$h){p$w.context.font="10px sans-serif";var p$q=p$w.context.measureText("abcji").width;p$w.context.font="10px "+p$h;var p$f=p$w.context.measureText("abcji").width;return console.log(p$q,p$f),p$q!==p$f},p$v._testWord="游",p$v.langPacks=null,p$v.VISIBLE="visible",p$v.SCROLL="scroll",p$v.HIDDEN="hidden",p$v.CharacterCache=!0,p$v.RightToLeft=!1,p$v._bitmapFonts=null,p$r(p$v,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),p$v}(p$Uh),p$_h=function(p$U){function p$S(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",p$S.__super.call(this),this.offset=new p$X,this._canvasTransform=new p$b,this._previousOrientation=p$w.window.orientation;var p$q=this;this.transform=p$b.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var p$h=p$w.window,p$f=this;p$h.addEventListener("focus",function(){p$q._isFocused=!0,p$f.event("focus"),p$f.event("focuschange")}),p$h.addEventListener("blur",function(){p$q._isFocused=!1,p$f.event("blur"),p$f.event("focuschange"),p$f._isInputting()&&(p$Eh.inputElement.target.focus=!1)});var p$g="visibilityState",p$$="visibilitychange",p$P=p$h.document;void 0!==p$P.hidden?(p$$="visibilitychange",p$g="visibilityState"):void 0!==p$P.mozHidden?(p$$="mozvisibilitychange",p$g="mozVisibilityState"):void 0!==p$P.msHidden?(p$$="msvisibilitychange",p$g="msVisibilityState"):void 0!==p$P.webkitHidden&&(p$$="webkitvisibilitychange",p$g="webkitVisibilityState"),p$h.document.addEventListener(p$$,function(){"hidden"==p$w.document[p$g]?p$f._setStageVisible(!1):p$f._setStageVisible(!0)}),p$h.document.addEventListener("qbrowserVisibilityChange",function(p$h){p$f._setStageVisible(!p$h.hidden)}),p$h.addEventListener("resize",function(){var p$h=p$w.window.orientation;null!=p$h&&p$h!=p$q._previousOrientation&&p$f._isInputting()&&(p$Eh.inputElement.target.focus=!1),p$q._previousOrientation=p$h,p$f._isInputting()||p$f._resetCanvas()}),p$h.addEventListener("orientationchange",function(p$h){p$f._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),p$w.onMobile&&this.on("mousedown",this,this._onmouseMove)}p$C(p$S,"laya.display.Stage",p$U);var p$h=p$S.prototype;return p$h._setStageVisible=function(p$h){this._isVisibility!=p$h&&(this._isVisibility=p$h,this._isVisibility||this._isInputting()&&(p$Eh.inputElement.target.focus=!1),this.event("visibilitychange"))},p$h._isInputting=function(){return p$w.onMobile&&p$Eh.isInputting},p$h._changeCanvasSize=function(){this.setScreenSize(p$w.clientWidth*p$w.pixelRatio,p$w.clientHeight*p$w.pixelRatio)},p$h._resetCanvas=function(){if(this.screenAdaptationEnabled){var p$h=p$c._mainCanvas;p$h.source.style;p$h.size(1,1),p$t.timer.once(100,this,this._changeCanvasSize)}},p$h.setScreenSize=function(p$h,p$q){var p$f=!1;if("none"!==this._screenMode&&(p$f=(p$h/p$q<1?"vertical":"horizontal")!==this._screenMode)){var p$g=p$q;p$q=p$h,p$h=p$g}this.canvasRotation=p$f;var p$$=p$c._mainCanvas,p$P=p$$.source.style,p$S=this._canvasTransform.identity(),p$B=this._scaleMode,p$r=p$h/this.designWidth,p$Y=p$q/this.designHeight,p$C=this.designWidth,p$U=this.designHeight,p$u=p$h,p$v=p$q,p$L=p$w.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,p$B){case"noscale":p$r=p$Y=1,p$u=this.designWidth,p$v=this.designHeight;break;case"showall":p$r=p$Y=Math.min(p$r,p$Y),p$C=p$u=Math.round(this.designWidth*p$r),p$U=p$v=Math.round(this.designHeight*p$Y);break;case"noborder":p$r=p$Y=Math.max(p$r,p$Y),p$u=Math.round(this.designWidth*p$r),p$v=Math.round(this.designHeight*p$Y);break;case"full":p$r=p$Y=1,this._width=p$C=p$h,this._height=p$U=p$q;break;case"fixedwidth":p$Y=p$r,this._height=p$U=Math.round(p$q/p$r);break;case"fixedheight":p$r=p$Y,this._width=p$C=Math.round(p$h/p$Y);break;case"fixedauto":p$h/p$q<this.designWidth/this.designHeight?(p$Y=p$r,this._height=p$U=Math.round(p$q/p$r)):(p$r=p$Y,this._width=p$C=Math.round(p$h/p$Y))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,p$C=p$C+1&2147483646,p$U=p$U+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),p$r*=this.scaleX,p$Y*=this.scaleY,1===p$r&&1===p$Y?this.transform.identity():(this.transform.a=this._formatData(p$r/(p$u/p$C)),this.transform.d=this._formatData(p$Y/(p$v/p$U)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),p$$.size(p$C,p$U),p$d.changeWebGLSize(p$C,p$U),p$S.scale(p$u/p$C/p$L,p$v/p$U/p$L),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(p$h-p$u)/p$L:this.offset.x=.5*(p$h-p$u)/p$L,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(p$q-p$v)/p$L:this.offset.y=.5*(p$q-p$v)/p$L,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),p$S.translate(this.offset.x,this.offset.y),this.canvasDegree=0,p$f&&("horizontal"===this._screenMode?(p$S.rotate(Math.PI/2),p$S.translate(p$q/p$L,0),this.canvasDegree=90):(p$S.rotate(-Math.PI/2),p$S.translate(0,p$h/p$L),this.canvasDegree=-90)),p$S.a=this._formatData(p$S.a),p$S.d=this._formatData(p$S.d),p$S.tx=this._formatData(p$S.tx),p$S.ty=this._formatData(p$S.ty),p$P.transformOrigin=p$P.webkitTransformOrigin=p$P.msTransformOrigin=p$P.mozTransformOrigin=p$P.oTransformOrigin="0px 0px 0px",p$P.transform=p$P.webkitTransform=p$P.msTransform=p$P.mozTransform=p$P.oTransform="matrix("+p$S.toString()+")",p$S.translate(parseInt(p$P.left)||0,parseInt(p$P.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},p$h._formatData=function(p$h){return Math.abs(p$h)<1e-6?0:Math.abs(1-p$h)<.001?0<p$h?1:-1:p$h},p$h.getMousePoint=function(){return p$X.TEMP.setTo(this.mouseX,this.mouseY)},p$h.repaint=function(){this._repaint=1},p$h.parentRepaint=function(){},p$h._loop=function(){return this.render(p$c.context,0,0),!0},p$h._onmouseMove=function(p$h){this._mouseMoveTime=p$w.now()},p$h.getTimeFromFrameStart=function(){return p$w.now()-this._frameStartTime},p$h.render=function(p$h,p$q,p$f){if("sleep"===this._frameRate&&!p$c.isConchApp){var p$g=p$w.now();if(!(1e3<=p$g-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(p$Z.loopCount++,p$e.instance.runEvent(),p$t.timer._update()));this._frameStartTime=p$g}if(this._renderCount++,p$c.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=p$w.now();var p$$="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),p$P=this._renderCount%2==0;if(p$Z.renderSlow=!p$$,p$$||p$P||p$c.isConchApp){var p$S;p$Z.loopCount++,p$e.instance.runEvent(),p$t.timer._update(),p$d.update3DLoop();var p$B=0,p$r=0;if(p$c.isConchNode)for(p$B=0,p$r=this._scenes.length;p$B<p$r;p$B++)(p$S=this._scenes[p$B])&&p$S._updateSceneConch();else for(p$B=0,p$r=this._scenes.length;p$B<p$r;p$B++)(p$S=this._scenes[p$B])&&p$S._updateScene();if(p$c.isConchNode){var p$Y=p$Uh.CustomList;for(p$B=0,p$r=p$Y.length;p$B<p$r;p$B++){var p$C=p$Y[p$B];p$C.customRender(p$C.customContext,0,0)}return}}p$c.isConchNode||this.renderingEnabled&&(p$$||!p$P||p$c.isConchWebGL)&&(p$c.isWebGL?p$c.WebGL.mainContext&&!p$c.WebGL.mainContext.isContextLost()&&(p$h.clear(),p$U.prototype.render.call(this,p$h,p$q,p$f),p$Z._show&&p$Z._sp&&p$Z._sp.render(p$h,p$q,p$f),p$d.clear(this._bgColor),p$d.beginFlush(),p$h.flush(),p$d.endFinish(),p$j.instance&&p$j.getInstance().endDispose()):(p$d.clear(this._bgColor),p$U.prototype.render.call(this,p$h,p$q,p$f),p$Z._show&&p$Z._sp&&p$Z._sp.render(p$h,p$q,p$f)))}else this._renderCount%5==0&&(p$Z.loopCount++,p$e.instance.runEvent(),p$t.timer._update())},p$h._requestFullscreen=function(){var p$h=p$w.document.documentElement;p$h.requestFullscreen?p$h.requestFullscreen():p$h.mozRequestFullScreen?p$h.mozRequestFullScreen():p$h.webkitRequestFullscreen?p$h.webkitRequestFullscreen():p$h.msRequestFullscreen&&p$h.msRequestFullscreen()},p$h._fullScreenChanged=function(){p$t.stage.event("fullscreenchange")},p$h.exitFullscreen=function(){var p$h=p$w.document;p$h.exitFullscreen?p$h.exitFullscreen():p$h.mozCancelFullScreen?p$h.mozCancelFullScreen():p$h.webkitExitFullscreen&&p$h.webkitExitFullscreen()},p$L(0,p$h,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),p$L(0,p$h,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),p$L(0,p$h,"frameRate",function(){return this._frameRate},function(p$h){if(this._frameRate=p$h,p$c.isConchApp)switch(this._frameRate){case"slow":p$w.window.conch&&p$w.window.conchConfig.setSlowFrame&&p$w.window.conchConfig.setSlowFrame(!0);break;case"fast":p$w.window.conch&&p$w.window.conchConfig.setSlowFrame&&p$w.window.conchConfig.setSlowFrame(!1);break;case"mouse":p$w.window.conch&&p$w.window.conchConfig.setMouseFrame&&p$w.window.conchConfig.setMouseFrame(2e3);break;case"sleep":p$w.window.conch&&p$w.window.conchConfig.setLimitFPS&&p$w.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),p$L(0,p$h,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),p$L(0,p$h,"width",p$U.prototype._$get_width,function(p$h){this.designWidth=p$h,p$t.superSet(p$Uh,this,"width",p$h),p$t.timer.callLater(this,this._changeCanvasSize)}),p$L(0,p$h,"alignH",function(){return this._alignH},function(p$h){this._alignH=p$h,p$t.timer.callLater(this,this._changeCanvasSize)}),p$L(0,p$h,"isFocused",function(){return this._isFocused}),p$L(0,p$h,"height",p$U.prototype._$get_height,function(p$h){this.designHeight=p$h,p$t.superSet(p$Uh,this,"height",p$h),p$t.timer.callLater(this,this._changeCanvasSize)}),p$L(0,p$h,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||p$b.create()},p$U.prototype._$set_transform),p$L(0,p$h,"isVisibility",function(){return this._isVisibility}),p$L(0,p$h,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),p$L(0,p$h,"scaleMode",function(){return this._scaleMode},function(p$h){this._scaleMode=p$h,p$t.timer.callLater(this,this._changeCanvasSize)}),p$L(0,p$h,"alignV",function(){return this._alignV},function(p$h){this._alignV=p$h,p$t.timer.callLater(this,this._changeCanvasSize)}),p$L(0,p$h,"bgColor",function(){return this._bgColor},function(p$h){this._bgColor=p$h,this.conchModel&&this.conchModel.bgColor(p$h),p$c.isWebGL&&(p$h?p$S._wgColor=p$s.create(p$h)._color:p$w.onMiniGame||(p$S._wgColor=null)),p$w.onLimixiu?p$S._wgColor=p$s.create(p$h)._color:p$c.canvas.style.background=p$h||"none"}),p$L(0,p$h,"mouseX",function(){return Math.round(p$e.instance.mouseX/this.clientScaleX)}),p$L(0,p$h,"mouseY",function(){return Math.round(p$e.instance.mouseY/this.clientScaleY)}),p$L(0,p$h,"screenMode",function(){return this._screenMode},function(p$h){this._screenMode=p$h}),p$L(0,p$h,"visible",p$U.prototype._$get_visible,function(p$h){this.visible!==p$h&&(p$t.superSet(p$Uh,this,"visible",p$h),p$c._mainCanvas.source.style.visibility=p$h?"visible":"hidden")}),p$L(0,p$h,"fullScreenEnabled",null,function(p$h){var p$q=p$w.document,p$f=p$c.canvas;p$h?(p$f.addEventListener("mousedown",this._requestFullscreen),p$f.addEventListener("touchstart",this._requestFullscreen),p$q.addEventListener("fullscreenchange",this._fullScreenChanged),p$q.addEventListener("mozfullscreenchange",this._fullScreenChanged),p$q.addEventListener("webkitfullscreenchange",this._fullScreenChanged),p$q.addEventListener("msfullscreenchange",this._fullScreenChanged)):(p$f.removeEventListener("mousedown",this._requestFullscreen),p$f.removeEventListener("touchstart",this._requestFullscreen),p$q.removeEventListener("fullscreenchange",this._fullScreenChanged),p$q.removeEventListener("mozfullscreenchange",this._fullScreenChanged),p$q.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),p$q.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),p$S.SCALE_NOSCALE="noscale",p$S.SCALE_EXACTFIT="exactfit",p$S.SCALE_SHOWALL="showall",p$S.SCALE_NOBORDER="noborder",p$S.SCALE_FULL="full",p$S.SCALE_FIXED_WIDTH="fixedwidth",p$S.SCALE_FIXED_HEIGHT="fixedheight",p$S.SCALE_FIXED_AUTO="fixedauto",p$S.ALIGN_LEFT="left",p$S.ALIGN_RIGHT="right",p$S.ALIGN_CENTER="center",p$S.ALIGN_TOP="top",p$S.ALIGN_MIDDLE="middle",p$S.ALIGN_BOTTOM="bottom",p$S.SCREEN_NONE="none",p$S.SCREEN_HORIZONTAL="horizontal",p$S.SCREEN_VERTICAL="vertical",p$S.FRAME_FAST="fast",p$S.FRAME_SLOW="slow",p$S.FRAME_MOUSE="mouse",p$S.FRAME_SLEEP="sleep",p$S.FRAME_MOUSE_THREDHOLD=2e3,p$r(p$S,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),p$S}(p$Uh),p$Nh=(function(p$h){function p$q(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,p$q.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}p$C(p$q,"laya.media.SoundNode",p$Uh);var p$f=p$q.prototype;p$f._onParentChange=function(){this.target=this.parent},p$f.play=function(p$h,p$q){void 0===p$h&&(p$h=1),isNaN(p$h)&&(p$h=1),this.url&&(this.stop(),this._channel=p$A.playSound(this.url,p$h,null,p$q))},p$f.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},p$f._setPlayAction=function(p$h,p$q,p$f,p$g){void 0===p$g&&(p$g=!0),this[p$f]&&p$h&&(p$g?p$h.on(p$q,this,this[p$f]):p$h.off(p$q,this,this[p$f]))},p$f._setPlayActions=function(p$h,p$q,p$f,p$g){if(void 0===p$g&&(p$g=!0),p$h&&p$q){var p$$,p$P=p$q.split(","),p$S=0;for(p$$=p$P.length,p$S=0;p$S<p$$;p$S++)this._setPlayAction(p$h,p$P[p$S],p$f,p$g)}},p$L(0,p$f,"playEvent",null,function(p$h){(this._playEvents=p$h)&&this._tar&&this._setPlayActions(this._tar,p$h,"play")}),p$L(0,p$f,"target",null,function(p$h){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=p$h,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),p$L(0,p$f,"stopEvent",null,function(p$h){(this._stopEvents=p$h)&&this._tar&&this._setPlayActions(this._tar,p$h,"stop")})}(),function(p$h){function p$q(){this._src=null,this._onload=null,this._onerror=null,p$q.__super.call(this)}p$C(p$q,"laya.resource.FileBitmap",p$Lh);var p$f=p$q.prototype;return p$L(0,p$f,"src",function(){return this._src},function(p$h){this._src=p$h}),p$L(0,p$f,"onload",null,function(p$h){}),p$L(0,p$f,"onerror",null,function(p$h){}),p$q}()),p$Gh=function(p$h){function p$f(p$h,p$q){this._is2D=!1,p$f.__super.call(this);var p$g=this;if(this._source=this,"2D"===p$h||"AUTO"===p$h&&!p$c.isWebGL){this._is2D=!0,this._source=p$q||p$w.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var p$$=this;p$$.getContext=function(p$h,p$q){if(p$g._ctx)return p$g._ctx;var p$f=p$g._ctx=p$g._source.getContext(p$h,p$q);return p$f&&(p$f._canvas=p$$,p$c.isFlash||p$w.onLimixiu||(p$f.size=function(p$h,p$q){})),p$f}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}p$C(p$f,"laya.resource.HTMLCanvas",p$Lh);var p$q=p$f.prototype;return p$q.clear=function(){this._ctx&&this._ctx.clear()},p$q.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},p$q.release=function(){},p$q._setContext=function(p$h){this._ctx=p$h},p$q.getContext=function(p$h,p$q){return this._ctx?this._ctx:this._ctx=p$f._createContext(this)},p$q.getMemSize=function(){return 0},p$q.size=function(p$h,p$q){(this._w!=p$h||this._h!=p$q||this._source&&(this._source.width!=p$h||this._source.height!=p$q))&&(this._w=p$h,this._h=p$q,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(p$h,p$q),this._source&&(this._source.height=p$q,this._source.width=p$h))},p$q.getCanvas=function(){return this._source},p$q.toBase64=function(p$h,p$q,p$f){if(this._source)if(p$c.isConchApp&&this._source.toBase64)this._source.toBase64(p$h,p$q,p$f);else{var p$g=this._source.toDataURL(p$h,p$q);p$f.call(this,p$g)}},p$L(0,p$q,"context",function(){return this._ctx}),p$L(0,p$q,"asBitmap",null,function(p$h){}),p$f.create=function(p$h,p$q){return new p$f(p$h,p$q)},p$f.TYPE2D="2D",p$f.TYPE3D="3D",p$f.TYPEAUTO="AUTO",p$f._createContext=null,p$f}(),p$mh=(function(p$h){function p$r(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){throw p$r.__super.call(this),new Error("不允许new！")}p$C(p$r,"laya.resource.HTMLSubImage",p$Lh),p$r.create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){return void 0===p$B&&(p$B=!1),new p$r(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B)}}(),function(p$h){function p$U(){this._frames=null,this._url=null,p$U.__super.call(this),this._setControlNode(this)}p$C(p$U,"laya.display.Animation",p$h);var p$q=p$U.prototype;p$q.destroy=function(p$h){void 0===p$h&&(p$h=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,p$h),this._frames=null,this._labels=null},p$q.play=function(p$h,p$q,p$f,p$g){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=!0),void 0===p$f&&(p$f=""),void 0===p$g&&(p$g=!0),p$f&&this._setFramesFromCache(p$f,p$g),this._isPlaying=!0,this.index="string"==typeof p$h?this._getFrameByLabel(p$h):p$h,this.loop=p$q,this._actionName=p$f,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},p$q._setFramesFromCache=function(p$h,p$q){var p$f;return void 0===p$q&&(p$q=!1),this._url&&(p$h=this._url+"#"+p$h),p$h&&p$U.framesMap[p$h]?((p$f=p$U.framesMap[p$h])instanceof Array?(this._frames=p$U.framesMap[p$h],this._count=this._frames.length):(p$f.nodeRoot&&(p$U.framesMap[p$h]=this._parseGraphicAnimationByData(p$f),p$f=p$U.framesMap[p$h]),this._frames=p$f.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=p$f.interval),this._labels=this._copyLabels(p$f.labels)),!0):(p$q&&console.log("ani not found:",p$h),!1)},p$q._copyLabels=function(p$h){if(!p$h)return null;var p$q,p$f;for(p$f in p$q={},p$h)p$q[p$f]=p$O.copyArray([],p$h[p$f]);return p$q},p$q._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&p$h.prototype._frameLoop.call(this)},p$q._displayToIndex=function(p$h){this._frames&&(this.graphics=this._frames[p$h])},p$q.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},p$q.loadImages=function(p$h,p$q){return void 0===p$q&&(p$q=""),this._url="",this._setFramesFromCache(p$q)||(this.frames=p$U.framesMap[p$q]?p$U.framesMap[p$q]:p$U.createFrames(p$h,p$q)),this},p$q.loadAtlas=function(p$q,p$f,p$g){void 0===p$g&&(p$g=""),this._url="";var p$$=this;function p$h(p$h){p$q===p$h&&(p$$.frames=p$U.framesMap[p$g]?p$U.framesMap[p$g]:p$U.createFrames(p$q,p$g),p$f&&p$f.run())}return p$$._setFramesFromCache(p$g)||(p$Bh.getAtlas(p$q)?p$h(p$q):p$t.loader.load(p$q,p$N.create(null,p$h,[p$q]),null,"atlas")),this},p$q.loadAnimation=function(p$h,p$q,p$f){this._url=p$h;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,p$q&&p$q.run()):!p$f||p$Bh.getAtlas(p$f)?this._loadAnimationData(p$h,p$q,p$f):p$t.loader.load(p$f,p$N.create(this,this._loadAnimationData,[p$h,p$q,p$f]),null,"atlas"),this},p$q._loadAnimationData=function(p$B,p$r,p$h){var p$Y=this;if(!p$h||p$Bh.getAtlas(p$h)){var p$C=this;p$Bh.getRes(p$B)?p$q(p$B):p$t.loader.load(p$B,p$N.create(null,p$q,[p$B]),null,"json"),p$Bh.clearRes(p$B)}else console.warn("atlas load fail:"+p$h);function p$q(p$h){if(p$Bh.getRes(p$h)&&p$B===p$h){var p$q;if(p$U.framesMap[p$B+"#"])p$C._setFramesFromCache(p$Y._actionName,!0),p$Y.index=0,p$Y._checkResumePlaying();else{var p$f=p$C._parseGraphicAnimation(p$Bh.getRes(p$B));if(!p$f)return;var p$g,p$$=p$f.animationList,p$P=0,p$S=p$$.length;for(p$P=0;p$P<p$S;p$P++)p$q=p$$[p$P],p$U.framesMap[p$B+"#"+p$q.name]=p$q,p$g||(p$g=p$q);p$g&&(p$U.framesMap[p$B+"#"]=p$g,p$C._setFramesFromCache(p$Y._actionName,!0),p$Y.index=0),p$Y._checkResumePlaying()}p$r&&p$r.run()}}},p$q._parseGraphicAnimation=function(p$h){return p$th.parseAnimationData(p$h)},p$q._parseGraphicAnimationByData=function(p$h){return p$th.parseAnimationByData(p$h)},p$L(0,p$q,"frames",function(){return this._frames},function(p$h){(this._frames=p$h)&&(this._count=p$h.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),p$L(0,p$q,"autoPlay",null,function(p$h){p$h?this.play():this.stop()}),p$L(0,p$q,"source",null,function(p$h){-1<p$h.indexOf(".ani")?this.loadAnimation(p$h):-1<p$h.indexOf(".json")||-1<p$h.indexOf("als")||-1<p$h.indexOf("atlas")?this.loadAtlas(p$h):this.loadImages(p$h.split(","))}),p$L(0,p$q,"autoAnimation",null,function(p$h){this.play(0,!0,p$h,!1)}),p$U.createFrames=function(p$h,p$q){var p$f,p$g,p$$=0,p$P=0;if("string"==typeof p$h){var p$S=p$Bh.getAtlas(p$h);if(p$S&&p$S.length)for(p$f=[],p$$=0,p$P=p$S.length;p$$<p$P;p$$++)(p$g=new p$d.createGraphics).drawTexture(p$Bh.getRes(p$S[p$$]),0,0),p$f.push(p$g)}else if(p$h instanceof Array)for(p$f=[],p$$=0,p$P=p$h.length;p$$<p$P;p$$++)(p$g=new p$d.createGraphics).loadImage(p$h[p$$],0,0),p$f.push(p$g);return p$q&&(p$U.framesMap[p$q]=p$f),p$f},p$U.clearCache=function(p$h){var p$q,p$f=p$U.framesMap,p$g=p$h+"#";for(p$q in p$f)p$q!==p$h&&0!=p$q.indexOf(p$g)||delete p$U.framesMap[p$q]},p$U.framesMap={}}(p$eh),function(p$h){function p$P(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,p$P.__super.call(this),null==p$P._sortIndexFun&&(p$P._sortIndexFun=p$R.sortByKey("index",!1,!0))}p$C(p$P,"laya.display.FrameAnimation",p$h);var p$q=p$P.prototype;return p$q._setUp=function(p$h,p$q){this._labels=null,this._animationNewFrames=null,this._targetDic=p$h,this._animationData=p$q,this.interval=1e3/p$q.frameRate,p$q.parsed?(this._count=p$q.count,this._labels=p$q.labels,this._animationNewFrames=p$q.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),p$q.parsed=!0,p$q.labels=this._labels,p$q.count=this._count,p$q.animationNewFrames=this._animationNewFrames},p$q.clear=function(){p$h.prototype.clear.call(this),this._targetDic=null,this._animationData=null},p$q._displayToIndex=function(p$h){if(this._animationData){p$h<0&&(p$h=0),p$h>this._count&&(p$h=this._count);var p$q=this._animationData.nodes,p$f=0,p$g=p$q.length;for(p$f=0;p$f<p$g;p$f++)this._displayNodeToFrame(p$q[p$f],p$h)}},p$q._displayNodeToFrame=function(p$h,p$q,p$f){p$f||(p$f=this._targetDic);var p$g=p$f[p$h.target];if(p$g){var p$$,p$P,p$S,p$B=p$h.frames,p$r=p$h.keys,p$Y=0,p$C=p$r.length;for(p$Y=0;p$Y<p$C;p$Y++)p$S=(p$P=p$B[p$$=p$r[p$Y]]).length>p$q?p$P[p$q]:p$P[p$P.length-1],p$g[p$$]=p$S}},p$q._calculateDatas=function(){if(this._animationData){var p$h,p$q=this._animationData.nodes,p$f=0,p$g=p$q.length;for(p$f=this._count=0;p$f<p$g;p$f++)p$h=p$q[p$f],this._calculateNodeKeyFrames(p$h);this._count+=1}},p$q._calculateNodeKeyFrames=function(p$h){var p$q,p$f,p$g=p$h.keyframes,p$$=p$h.target;for(p$q in p$h.frames||(p$h.frames={}),p$h.keys?p$h.keys.length=0:p$h.keys=[],p$h.initValues||(p$h.initValues={}),p$g)p$f=p$g[p$q],p$h.frames[p$q]||(p$h.frames[p$q]=[]),this._targetDic&&this._targetDic[p$$]&&(p$h.initValues[p$q]=this._targetDic[p$$][p$q]),p$f.sort(p$P._sortIndexFun),p$h.keys.push(p$q),this._calculateNodePropFrames(p$f,p$h.frames[p$q],p$q,p$$)},p$q.resetToInitState=function(){if(this._targetDic&&this._animationData){var p$h,p$q,p$f=this._animationData.nodes,p$g=0,p$$=p$f.length;for(p$g=0;p$g<p$$;p$g++)if(p$q=(p$h=p$f[p$g]).initValues){var p$P,p$S=this._targetDic[p$h.target];if(p$S)for(p$P in p$q)p$S[p$P]=p$q[p$P]}}},p$q._calculateNodePropFrames=function(p$h,p$q,p$f,p$g){var p$$=0,p$P=p$h.length-1;if(0<p$P){for(p$q.length=p$h[p$P].index+1,p$$=0;p$$<p$P;p$$++)this._dealKeyFrame(p$h[p$$]),this._calculateFrameValues(p$h[p$$],p$h[p$$+1],p$q);this._dealKeyFrame(p$h[p$$])}0==p$P&&(p$q[p$h[0].index]=p$h[0].value,this._animationNewFrames&&(this._animationNewFrames[p$h[0].index]=!0))},p$q._dealKeyFrame=function(p$h){p$h.label&&""!=p$h.label&&this.addLabel(p$h.label,p$h.index)},p$q._calculateFrameValues=function(p$h,p$q,p$f){var p$g,p$$=0,p$P=p$h.index,p$S=p$q.index,p$B=p$h.value,p$r=p$q.value-p$h.value,p$Y=p$S-p$P;if(p$S>this._count&&(this._count=p$S),p$h.tween)for(null==(p$g=p$K[p$h.tweenMethod])&&(p$g=p$K.linearNone),p$$=p$P;p$$<p$S;p$$++)p$f[p$$]=p$g(p$$-p$P,p$B,p$r,p$Y),this._animationNewFrames&&(this._animationNewFrames[p$$]=!0);else for(p$$=p$P;p$$<p$S;p$$++)p$f[p$$]=p$B;this._animationNewFrames&&(this._animationNewFrames[p$h.index]=!0,this._animationNewFrames[p$q.index]=!0),p$f[p$q.index]=p$q.value},p$P._sortIndexFun=null,p$P}(p$eh)),p$Eh=function(p$q){function p$$(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",p$$.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=p$lh.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}p$C(p$$,"laya.display.Input",p$q);var p$h=p$$.prototype;return p$h.setSelection=function(p$h,p$q){this.focus=!0,laya.display.Input.inputElement.selectionStart=p$h,laya.display.Input.inputElement.selectionEnd=p$q},p$h._onUnDisplay=function(p$h){this.focus=!1},p$h._onMouseDown=function(p$h){this.focus=!0},p$h._syncInputTransform=function(){var p$h=this.nativeInput,p$q=p$O.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),p$f=this._width-this.padding[1]-this.padding[3],p$g=this._height-this.padding[0]-this.padding[2];p$c.isConchApp?(p$h.setScale(p$q.scaleX,p$q.scaleY),p$h.setSize(p$f,p$g),p$h.setPos(p$q.x,p$q.y)):(p$$.inputContainer.style.transform=p$$.inputContainer.style.webkitTransform="scale("+p$q.scaleX+","+p$q.scaleY+") rotate("+p$t.stage.canvasDegree+"deg)",p$h.style.width=p$f+"px",p$h.style.height=p$g+"px",p$$.inputContainer.style.left=p$q.x+"px",p$$.inputContainer.style.top=p$q.y+"px")},p$h.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},p$h._setInputMethod=function(){p$$.input.parentElement&&p$$.inputContainer.removeChild(p$$.input),p$$.area.parentElement&&p$$.inputContainer.removeChild(p$$.area),p$$.inputElement=this._multiline?p$$.area:p$$.input,p$$.inputContainer.appendChild(p$$.inputElement),p$lh.RightToLeft&&(p$$.inputElement.style.direction="rtl")},p$h._focusIn=function(){laya.display.Input.isInputting=!0;var p$h=this.nativeInput;this._focus=!0;var p$q=p$h.style;p$q.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),p$h.readOnly=!this._editable,p$c.isConchApp&&(p$h.setType(this._type),p$h.setForbidEdit(!this._editable)),p$h.maxLength=this._maxChars;this.padding;if(p$h.type=this._type,p$h.value=this._content,p$h.placeholder=this._prompt,p$t.stage.off("keydown",this,this._onKeyDown),p$t.stage.on("keydown",this,this._onKeyDown),(p$t.stage.focus=this).event("focus"),p$w.onPC&&p$h.focus(),!p$w.onMiniGame){this._text;this._text=null}this.typeset(),p$h.setColor(this._originColor),p$h.setFontSize(this.fontSize),p$h.setFontFace(p$w.onIPhone&&p$lh._fontFamilyMap[this.font]||this.font),p$c.isConchApp&&p$h.setMultiAble&&p$h.setMultiAble(this._multiline),p$q.lineHeight=this.leading+this.fontSize+"px",p$q.fontStyle=this.italic?"italic":"normal",p$q.fontWeight=this.bold?"bold":"normal",p$q.textAlign=this.align,p$q.padding="0 0",this._syncInputTransform(),!p$c.isConchApp&&p$w.onPC&&p$t.timer.frameLoop(1,this,this._syncInputTransform)},p$h._setPromptColor=function(){(p$$.promptStyleDOM=p$w.getElementById("promptStyle"))||((p$$.promptStyleDOM=p$w.createElement("style")).setAttribute("id","promptStyle"),p$w.document.head.appendChild(p$$.promptStyleDOM)),p$$.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},p$h._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(p$t.superSet(p$lh,this,"text",this._content),p$t.superSet(p$lh,this,"color",this._originColor)):(p$t.superSet(p$lh,this,"text",this._prompt),p$t.superSet(p$lh,this,"color",this._promptColor)),p$t.stage.off("keydown",this,this._onKeyDown),p$t.stage.focus=null,this.event("blur"),p$c.isConchApp&&this.nativeInput.blur(),p$w.onPC&&p$t.timer.clear(this,this._syncInputTransform)},p$h._onKeyDown=function(p$h){13===p$h.keyCode&&(p$w.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},p$h.changeText=function(p$h){this._content=p$h,this._focus?(this.nativeInput.value=p$h||"",this.event("change")):p$q.prototype.changeText.call(this,p$h)},p$L(0,p$h,"color",p$q.prototype._$get_color,function(p$h){this._focus&&this.nativeInput.setColor(p$h),p$t.superSet(p$lh,this,"color",this._content?p$h:this._promptColor),this._originColor=p$h}),p$L(0,p$h,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(p$h){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),p$L(0,p$h,"multiline",function(){return this._multiline},function(p$h){this._multiline=p$h,this.valign=p$h?"top":"middle"}),p$L(0,p$h,"maxChars",function(){return this._maxChars},function(p$h){p$h<=0&&(p$h=1e5),this._maxChars=p$h}),p$L(0,p$h,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(p$h){p$t.superSet(p$lh,this,"color",this._originColor),p$h+="",this._focus?(this.nativeInput.value=p$h||"",this.event("change")):(this._multiline||(p$h=p$h.replace(/\r?\n/g,"")),(this._content=p$h)?p$t.superSet(p$lh,this,"text",p$h):(p$t.superSet(p$lh,this,"text",this._prompt),p$t.superSet(p$lh,this,"color",this.promptColor)))}),p$L(0,p$h,"nativeInput",function(){return this._multiline?p$$.area:p$$.input}),p$L(0,p$h,"prompt",function(){return this._prompt},function(p$h){!this._text&&p$h&&p$t.superSet(p$lh,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?p$t.superSet(p$lh,this,"text",this._text==this._prompt?p$h:this._text):p$t.superSet(p$lh,this,"text",p$h),this._prompt=p$lh.langPacks&&p$lh.langPacks[p$h]?p$lh.langPacks[p$h]:p$h}),p$L(0,p$h,"focus",function(){return this._focus},function(p$h){var p$q=this.nativeInput;this._focus!==p$h&&(p$h?(p$q.target?p$q.target._focusOut():this._setInputMethod(),(p$q.target=this)._focusIn()):(p$q.target=null,this._focusOut(),p$w.document.body.scrollTop=0,p$q.blur(),p$c.isConchApp?p$q.setPos(-1e4,-1e4):p$$.inputContainer.contains(p$q)&&p$$.inputContainer.removeChild(p$q)))}),p$L(0,p$h,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(p$h){p$h?(-1<(p$h="[^"+p$h+"]").indexOf("^^")&&(p$h=p$h.replace("^^","")),this._restrictPattern=new RegExp(p$h,"g")):this._restrictPattern=null}),p$L(0,p$h,"editable",function(){return this._editable},function(p$h){this._editable=p$h,p$c.isConchApp&&p$$.input.setForbidEdit(!p$h)}),p$L(0,p$h,"promptColor",function(){return this._promptColor},function(p$h){this._promptColor=p$h,this._content||p$t.superSet(p$lh,this,"color",p$h)}),p$L(0,p$h,"type",function(){return this._type},function(p$h){this._getCSSStyle().password="password"==p$h,this._type=p$h,p$c.isConchApp&&this.nativeInput.setType(p$h)}),p$L(0,p$h,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(p$h){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),p$L(0,p$h,"asPassword",function(){return this._getCSSStyle().password},function(p$h){this._getCSSStyle().password=p$h,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),p$$.__init__=function(){p$$._createInputElement(),p$w.onMobile&&p$c.canvas.addEventListener(p$$.IOS_IFRAME?p$w.onMiniGame?"touchend":"click":"touchend",p$$._popupInputMethod)},p$$._popupInputMethod=function(p$h){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},p$$._createInputElement=function(){p$$._initInput(p$$.area=p$w.createElement("textarea")),p$$._initInput(p$$.input=p$w.createElement("input")),(p$$.inputContainer=p$w.createElement("div")).style.position="absolute",p$$.inputContainer.style.zIndex=1e5,p$w.container.appendChild(p$$.inputContainer),p$$.inputContainer.setPos=function(p$h,p$q){p$$.inputContainer.style.left=p$h+"px",p$$.inputContainer.style.top=p$q+"px"}},p$$._initInput=function(p$q){var p$h=p$q.style;p$h.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",p$h.resize="none",p$h.backgroundColor="transparent",p$h.border="none",p$h.outline="none",p$h.zIndex=1,p$q.addEventListener("input",p$$._processInputting),p$q.addEventListener("mousemove",p$$._stopEvent),p$q.addEventListener("mousedown",p$$._stopEvent),p$q.addEventListener("touchmove",p$$._stopEvent),p$q.setFontFace=function(p$h){p$q.style.fontFamily=p$h},p$c.isConchApp||(p$q.setColor=function(p$h){p$q.style.color=p$h},p$q.setFontSize=function(p$h){p$q.style.fontSize=p$h+"px"})},p$$._processInputting=function(p$h){var p$q=laya.display.Input.inputElement.target;if(p$q){var p$f=laya.display.Input.inputElement.value;p$q._restrictPattern&&(p$f=p$f.replace(/\u2006|\x27/g,""),p$q._restrictPattern.test(p$f)&&(p$f=p$f.replace(p$q._restrictPattern,""),laya.display.Input.inputElement.value=p$f)),p$q._text=p$f,p$q.event("input")}},p$$._stopEvent=function(p$h){"touchmove"==p$h.type&&p$h.preventDefault(),p$h.stopPropagation&&p$h.stopPropagation()},p$$.TYPE_TEXT="text",p$$.TYPE_PASSWORD="password",p$$.TYPE_EMAIL="email",p$$.TYPE_URL="url",p$$.TYPE_NUMBER="number",p$$.TYPE_RANGE="range",p$$.TYPE_DATE="date",p$$.TYPE_MONTH="month",p$$.TYPE_WEEK="week",p$$.TYPE_TIME="time",p$$.TYPE_DATE_TIME="datetime",p$$.TYPE_DATE_TIME_LOCAL="datetime-local",p$$.TYPE_SEARCH="search",p$$.input=null,p$$.area=null,p$$.inputElement=null,p$$.inputContainer=null,p$$.confirmButton=null,p$$.promptStyleDOM=null,p$$.inputHeight=45,p$$.isInputting=!1,p$$.stageMatrix=null,p$r(p$$,["IOS_IFRAME",function(){return this.IOS_IFRAME=p$w.onIOS&&p$w.window.top!=p$w.window.self}]),p$$}(p$lh),p$Rh=function(p$h){function p$f(p$h,p$q){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,p$f.__super.call(this),p$h&&this._init_(p$h,p$q)}p$C(p$f,"laya.resource.HTMLImage",p$Nh);var p$q=p$f.prototype;return p$q._init_=function(p$h,p$q){this._src=p$h,this._source=new p$w.window.Image,p$q&&(p$q.onload&&(this.onload=p$q.onload),p$q.onerror&&(this.onerror=p$q.onerror),p$q.onCreate&&p$q.onCreate(this)),0!=p$h.indexOf("data:image")&&(this._source.crossOrigin=""),p$h&&(this._source.src=p$h)},p$q.recreateResource=function(){var p$h=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var p$q=this;this._source=new p$w.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(p$q._needReleaseAgain)return p$q._needReleaseAgain=!1,p$q._source.onload=null,void(p$q._source=null);p$q._source.onload=null,p$q.memorySize=p$h._w*p$h._h*4,p$q._recreateLock=!1,p$q.completeCreate()},this._source.src=this._src}},p$q.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},p$q.onresize=function(){this._w=this._source.width,this._h=this._source.height},p$L(0,p$q,"onload",null,function(p$h){var p$q=this;this._onload=p$h,this._source&&(this._source.onload=null!=this._onload?function(){p$q.onresize(),p$q._onload()}:null)}),p$L(0,p$q,"onerror",null,function(p$h){var p$q=this;this._onerror=p$h,this._source&&(this._source.onerror=null!=this._onerror?function(){p$q._onerror()}:null)}),p$L(0,p$q,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(p$h){this._enableMerageInAtlas=p$h,p$c.isConchApp&&this._source&&(this._source.enableMerageInAtlas=p$h)}),p$f.create=function(p$h,p$q){return new p$f(p$h,p$q)},p$f}(),p$th=(function(p$P){function p$h(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,p$h.__super.call(this)}p$C(p$h,"laya.display.EffectAnimation",p$P);var p$q=p$h.prototype;p$q._onOtherBegin=function(p$h){p$h!=this&&this.stop()},p$q.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},p$q._onPlayAction=function(){this.play(0,!1)},p$q.play=function(p$h,p$q,p$f,p$g){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=!0),void 0===p$f&&(p$f=""),void 0===p$g&&(p$g=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,p$h,p$q,p$f,p$g))},p$q._recordInitData=function(){if(this._aniKeys){var p$h,p$q,p$f=0;for(p$h=this._aniKeys.length,p$f=0;p$f<p$h;p$f++)p$q=this._aniKeys[p$f],this._initData[p$q]=this._target[p$q]}},p$q._displayToIndex=function(p$h){if(this._animationData){p$h<0&&(p$h=0),p$h>this._count&&(p$h=this._count);var p$q=this._animationData.nodes,p$f=0,p$g=p$q.length;for(p$g=1<p$g?1:p$g,p$f=0;p$f<p$g;p$f++)this._displayNodeToFrame(p$q[p$f],p$h)}},p$q._displayNodeToFrame=function(p$h,p$q,p$f){if(this._target){var p$g;p$g=this._target;var p$$,p$P,p$S,p$B,p$r=p$h.frames,p$Y=p$h.keys,p$C=0,p$U=p$Y.length;p$B=p$h.secondFrames;var p$u,p$v,p$L,p$e,p$l=0;for(p$C=0;p$C<p$U;p$C++)p$P=p$r[p$$=p$Y[p$C]],p$S=-1==(p$l=p$B[p$$])?this._initData[p$$]:p$q<p$l?(p$L=(p$v=p$h.keyframes[p$$])[0]).tween?(null==(p$u=p$K[p$L.tweenMethod])&&(p$u=p$K.linearNone),p$e=p$v[1],p$u(p$q,this._initData[p$$],p$e.value-this._initData[p$$],p$e.index)):this._initData[p$$]:p$P.length>p$q?p$P[p$q]:p$P[p$P.length-1],p$g[p$$]=p$S}},p$q._calculateNodeKeyFrames=function(p$h){p$P.prototype._calculateNodeKeyFrames.call(this,p$h);var p$q,p$f,p$g,p$$=p$h.keyframes;p$h.target;for(p$q in p$g={},p$h.secondFrames=p$g,p$$)(p$f=p$$[p$q]).length<=1?p$g[p$q]=-1:p$g[p$q]=p$f[1].index},p$L(0,p$q,"target",function(){return this._target},function(p$h){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=p$h,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),p$L(0,p$q,"playEvent",null,function(p$h){(this._playEvents=p$h)&&this.addEvent()}),p$L(0,p$q,"effectData",null,function(p$h){var p$q;p$h&&((p$q=p$h.animations)&&p$q[0]&&(this._setUp({},p$q[0]),p$q[0].nodes&&p$q[0].nodes[0]&&(this._aniKeys=p$q[0].nodes[0].keys)))}),p$L(0,p$q,"effectClass",null,function(p$h){var p$q,p$f;(this._effectClass=p$D.getClass(p$h),this._effectClass)&&((p$q=this._effectClass.uiView)&&(p$f=p$q.animations)&&p$f[0]&&(this._setUp({},p$f[0]),p$f[0].nodes&&p$f[0].nodes[0]&&(this._aniKeys=p$f[0].nodes[0].keys)))}),p$h.EffectAnimationBegin="effectanimationbegin"}(p$mh),function(p$q){var p$p;function p$A(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,p$A.__super.call(this)}p$C(p$A,"laya.utils.GraphicAnimation",p$q);var p$h=p$A.prototype;return p$h._parseNodeList=function(p$h){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[p$h.compId]=p$h.props,p$h.compId&&this._nodeList.push(p$h.compId);var p$q=p$h.child;if(p$q){var p$f=0,p$g=p$q.length;for(p$f=0;p$f<p$g;p$f++)this._parseNodeList(p$q[p$f])}},p$h._calGraphicData=function(p$h){var p$q;if(this._setUp(null,p$h),this._createGraphicData(),this._nodeIDAniDic)for(p$q in this._nodeIDAniDic)this._nodeIDAniDic[p$q]=null},p$h._createGraphicData=function(){var p$h,p$q=[],p$f=0,p$g=this.count,p$$=this._animationNewFrames;for(p$$||(p$$=[]),p$f=0;p$f<p$g;p$f++)!p$$[p$f]&&p$h||(p$h=this._createFrameGraphic(p$f)),p$q.push(p$h);this._gList=p$q},p$h._createFrameGraphic=function(p$h){var p$q=p$d.createGraphics();return p$A._rootMatrix||(p$A._rootMatrix=new p$b),this._updateNodeGraphic(this._rootNode,p$h,p$A._rootMatrix,p$q),p$q},p$h._updateNodeGraphic=function(p$h,p$q,p$f,p$g,p$$){var p$P;void 0===p$$&&(p$$=1);var p$S,p$B,p$r,p$Y=(p$P=this._nodeGDic[p$h.compId]=this._getNodeGraphicData(p$h.compId,p$q,this._nodeGDic[p$h.compId])).alpha*p$$;if(!(p$Y<.01)&&(p$P.resultTransform||(p$P.resultTransform=p$b.create()),p$S=p$P.resultTransform,p$b.mul(p$P.transform,p$f,p$S),p$P.skin&&(p$B=this._getTextureByUrl(p$P.skin))&&(p$S._checkTransform()?(p$g.drawTexture(p$B,0,0,p$P.width,p$P.height,p$S,p$Y),p$P.resultTransform=null):p$g.drawTexture(p$B,p$S.tx,p$S.ty,p$P.width,p$P.height,null,p$Y)),p$r=p$h.child)){var p$C,p$U=0;for(p$C=p$r.length,p$U=0;p$U<p$C;p$U++)this._updateNodeGraphic(p$r[p$U],p$q,p$S,p$g,p$Y)}},p$h._updateNoChilds=function(p$h,p$q){if(p$h.skin){var p$f=this._getTextureByUrl(p$h.skin);if(p$f){var p$g=p$h.transform;p$g._checkTransform();!p$g.bTransform?p$q.drawTexture(p$f,p$g.tx,p$g.ty,p$h.width,p$h.height,null,p$h.alpha):p$q.drawTexture(p$f,0,0,p$h.width,p$h.height,p$g.clone(),p$h.alpha)}}},p$h._updateNodeGraphic2=function(p$h,p$q,p$f){var p$g;if(p$g=this._nodeGDic[p$h.compId]=this._getNodeGraphicData(p$h.compId,p$q,this._nodeGDic[p$h.compId]),p$h.child){var p$$=p$g.transform;p$$._checkTransform();var p$P,p$S;p$S=(p$P=!p$$.bTransform)&&(0!=p$$.tx||0!=p$$.ty);var p$B,p$r,p$Y;if((p$B=p$$.bTransform||1!=p$g.alpha)&&p$f.save(),1!=p$g.alpha&&p$f.alpha(p$g.alpha),p$P?p$S&&p$f.translate(p$$.tx,p$$.ty):p$f.transform(p$$.clone()),p$r=p$h.child,p$g.skin&&(p$Y=this._getTextureByUrl(p$g.skin))&&p$f.drawTexture(p$Y,0,0,p$g.width,p$g.height),p$r){var p$C,p$U=0;for(p$C=p$r.length,p$U=0;p$U<p$C;p$U++)this._updateNodeGraphic2(p$r[p$U],p$q,p$f)}p$B?p$f.restore():p$P?p$S&&p$f.translate(-p$$.tx,-p$$.ty):p$f.transform(p$$.clone().invert())}else this._updateNoChilds(p$g,p$f)},p$h._calculateNodeKeyFrames=function(p$h){p$q.prototype._calculateNodeKeyFrames.call(this,p$h),this._nodeIDAniDic[p$h.target]=p$h},p$h.getNodeDataByID=function(p$h){return this._nodeIDAniDic[p$h]},p$h._getParams=function(p$h,p$q,p$f,p$g){var p$$=p$A._temParam;p$$.length=p$q.length;var p$P=0,p$S=p$q.length;for(p$P=0;p$P<p$S;p$P++)p$$[p$P]=this._getObjVar(p$h,p$q[p$P][0],p$f,p$q[p$P][1],p$g);return p$$},p$h._getObjVar=function(p$h,p$q,p$f,p$g,p$$){if(p$h.hasOwnProperty(p$q)){var p$P=p$h[p$q];if(p$f>=p$P.length&&(p$f=p$P.length-1),null!=p$h[p$q][p$f])return p$h[p$q][p$f]}return p$$.hasOwnProperty(p$q)?p$$[p$q]:p$g},p$h._getNodeGraphicData=function(p$h,p$q,p$f){p$f||(p$f=p$p.create()),p$f.transform?p$f.transform.identity():p$f.transform=p$b.create();var p$g=this.getNodeDataByID(p$h);if(!p$g)return p$f;var p$$,p$P,p$S=p$g.frames,p$B=this._getParams(p$S,p$A._drawTextureCmd,p$q,this._nodeDefaultProps[p$h]),p$r=p$B[0],p$Y=NaN,p$C=NaN,p$U=p$B[5],p$u=p$B[6],p$v=p$B[13],p$L=p$B[14],p$e=p$B[7],p$l=p$B[8],p$_=p$B[9],p$N=p$B[11],p$G=p$B[12];p$Y=p$B[3],p$C=p$B[4],0!=p$Y&&0!=p$C||(p$r=null),-1==p$Y&&(p$Y=0),-1==p$C&&(p$C=0),p$f.skin=p$r,p$f.width=p$Y,p$f.height=p$C,p$r&&((p$$=this._getTextureByUrl(p$r))?(p$Y||(p$Y=p$$.sourceWidth),p$C||(p$C=p$$.sourceHeight)):console.warn("lost skin:",p$r,",you may load pics first")),p$f.alpha=p$B[10],p$P=p$f.transform,0!=p$v&&(p$U=p$v*p$Y),0!=p$L&&(p$u=p$L*p$C),0==p$U&&0==p$u||p$P.translate(-p$U,-p$u);var p$m=null;if(p$_||1!==p$e||1!==p$l||p$N||p$G){(p$m=p$A._tempMt).identity(),p$m.bTransform=!0;var p$E=.0174532922222222*(p$_-p$N),p$R=.0174532922222222*(p$_+p$G),p$t=Math.cos(p$R),p$X=Math.sin(p$R),p$n=Math.sin(p$E),p$J=Math.cos(p$E);p$m.a=p$e*p$t,p$m.b=p$e*p$X,p$m.c=-p$l*p$n,p$m.d=p$l*p$J,p$m.tx=p$m.ty=0}return p$m&&(p$P=p$b.mul(p$P,p$m,p$P)),p$P.translate(p$B[1],p$B[2]),p$f},p$h._getTextureByUrl=function(p$h){return p$Bh.getRes(p$h)},p$h.setAniData=function(p$h,p$q){if(p$h.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=p$h,this._parseNodeList(p$h);var p$f,p$g={},p$$=[],p$P=p$h.animations,p$S=0,p$B=p$P.length;for(p$S=0;p$S<p$B;p$S++)if(p$f=p$P[p$S],this._labels=null,(!p$q||p$q==p$f.name)&&p$f){try{this._calGraphicData(p$f)}catch(p$h){console.warn("parse animation fail:"+p$f.name+",empty animation created"),this._gList=[]}var p$r={};p$r.interval=1e3/p$f.frameRate,p$r.frames=this._gList,p$r.labels=this._labels,p$r.name=p$f.name,p$$.push(p$r),p$g[p$f.name]=p$r}this.animationList=p$$,this.animationDic=p$g}p$A._temParam.length=0},p$h.parseByData=function(p$h){var p$q,p$f;p$q=p$h.nodeRoot,p$f=p$h.aniO,delete p$h.nodeRoot,delete p$h.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=p$q,this._parseNodeList(p$q),this._labels=null;try{this._calGraphicData(p$f)}catch(p$h){console.warn("parse animation fail:"+p$f.name+",empty animation created"),this._gList=[]}var p$g=p$h;return p$g.interval=1e3/p$f.frameRate,p$g.frames=this._gList,p$g.labels=this._labels,p$g.name=p$f.name,p$g},p$h.setUpAniData=function(p$h){if(p$h.animations){var p$q,p$f={},p$g=[],p$$=p$h.animations,p$P=0,p$S=p$$.length;for(p$P=0;p$P<p$S;p$P++)if(p$q=p$$[p$P]){var p$B={};p$B.name=p$q.name,p$B.aniO=p$q,p$B.nodeRoot=p$h,p$g.push(p$B),p$f[p$q.name]=p$B}this.animationList=p$g,this.animationDic=p$f}},p$h._clear=function(){var p$h,p$q;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(p$h in this._nodeGDic)(p$q=this._nodeGDic[p$h])&&p$q.recover();this._nodeGDic=null},p$A.parseAnimationByData=function(p$h){var p$q;return p$A._I||(p$A._I=new p$A),p$q=p$A._I.parseByData(p$h),p$A._I._clear(),p$q},p$A.parseAnimationData=function(p$h){var p$q;return p$A._I||(p$A._I=new p$A),p$A._I.setUpAniData(p$h),(p$q={}).animationList=p$A._I.animationList,p$q.animationDic=p$A._I.animationDic,p$A._I._clear(),p$q},p$A._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],p$A._temParam=[],p$A._I=null,p$A._rootMatrix=null,p$r(p$A,["_tempMt",function(){return this._tempMt=new p$b}]),p$A.__init$=function(){p$p=function(){function p$h(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return p$C(p$h,""),p$h.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),p$F.recover("GraphicNode",this)},p$h.create=function(){return p$F.getItemByClass("GraphicNode",p$h)},p$h}()},p$A}(p$mh));p$t.__init([p$Y,p$rh,p$c,p$w,p$Q,p$J,p$h,p$th])}(window,document,Laya),function(p$h,p$q,p$f){p$f.un,p$f.uns,p$f.static;var p$g=p$f.class;p$f.getset,p$f.__newvec;new(function(){function p$h(){}return p$g(p$h,"LayaMain"),p$h}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(p$h,p$q){"use strict";for(var p$f in Object.defineProperty(p$q,"__esModule",{value:!0}),Laya){var p$g=Laya[p$f];p$g&&p$g.__isclass&&(p$q[p$f]=p$g)}}),function(p$h,p$q,p$R){p$R.un,p$R.uns;var p$S=p$R.static,p$u=p$R.class,p$g=p$R.getset,p$P=p$R.__newvec,p$C=laya.maths.Arith,p$U=laya.maths.Bezier,p$f=laya.resource.Bitmap,p$v=laya.utils.Browser,p$r=laya.utils.Byte,p$L=laya.utils.Color,p$t=(laya.filters.ColorFilter,p$R.Config),p$$=laya.resource.Context,p$X=(laya.events.Event,laya.filters.Filter),p$B=laya.display.Graphics,p$Y=laya.resource.HTMLCanvas,p$e=(laya.utils.HTMLChar,laya.resource.HTMLImage),p$l=laya.resource.HTMLSubImage,p$n=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),p$J=laya.maths.Point,p$p=laya.maths.Rectangle,p$_=laya.renders.Render,p$N=(laya.renders.RenderContext,laya.renders.RenderSprite),p$G=laya.resource.Resource,p$m=laya.resource.ResourceManager,p$E=laya.utils.RunDriver,p$A=laya.display.Sprite,p$d=laya.display.Stage,p$b=laya.utils.Stat,p$i=laya.utils.StringKey,p$z=(laya.display.css.Style,laya.system.System),p$c=laya.display.Text,p$M=laya.resource.Texture,p$W=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),p$T=laya.utils.VectorGraphManager;laya.utils.WordText;p$R.interface("laya.webgl.shapes.IShape"),p$R.interface("laya.webgl.submit.ISubmit"),p$R.interface("laya.webgl.text.ICharSegment"),p$R.interface("laya.webgl.canvas.save.ISaveData"),p$R.interface("laya.webgl.resource.IMergeAtlasBitmap"),p$R.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var p$I=function(){function p$h(){}p$u(p$h,"laya.filters.webgl.FilterActionGL");var p$q=p$h.prototype;return p$R.imps(p$q,{"laya.filters.IFilterActionGL":!0}),p$q.setValue=function(p$h){},p$q.setValueMix=function(p$h){},p$q.apply3d=function(p$h,p$q,p$f,p$g,p$$){return null},p$q.apply=function(p$h){return null},p$g(0,p$q,"typeMix",function(){return 0}),p$h}(),p$w=function(){function p$h(){}return p$u(p$h,"laya.webgl.shader.ShaderValue"),p$h}(),p$k=function(){var p$g,p$$;function p$h(p$h,p$q,p$f){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new p$$,void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),this._cells=null,this._rowInfo=null,this._init(p$h,p$q),this._atlasID=p$f}p$u(p$h,"laya.webgl.atlas.AtlasGrid");var p$q=p$h.prototype;return p$q.getAltasID=function(){return this._atlasID},p$q.setAltasID=function(p$h){0<=p$h&&(this._atlasID=p$h)},p$q.addTex=function(p$h,p$q,p$f){var p$g=this._get(p$q,p$f);return 0==p$g.ret||(this._fill(p$g.x,p$g.y,p$q,p$f,p$h),this._texCount++),p$g},p$q._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},p$q._init=function(p$h,p$q){if(this._width=p$h,this._height=p$q,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=p$P(this._height);for(var p$f=0;p$f<this._height;p$f++)this._rowInfo[p$f]=new p$g;return this._clear(),!0},p$q._get=function(p$h,p$q){var p$f=new p$D;if(p$h>=this._failSize.width&&p$q>=this._failSize.height)return p$f;for(var p$g=-1,p$$=-1,p$P=this._width,p$S=this._height,p$B=this._cells,p$r=0;p$r<p$S;p$r++)if(!(this._rowInfo[p$r].spaceCount<p$h))for(var p$Y=0;p$Y<p$P;){var p$C=3*(p$r*p$P+p$Y);if(0!=p$B[p$C]||p$B[1+p$C]<p$h||p$B[2+p$C]<p$q)p$Y+=p$B[1+p$C];else{p$g=p$Y,p$$=p$r;for(var p$U=0;p$U<p$h;p$U++)if(p$B[3*p$U+p$C+2]<p$q){p$g=-1;break}if(!(p$g<0))return p$f.ret=!0,p$f.x=p$g,p$f.y=p$$,p$f;p$Y+=p$B[1+p$C]}}return p$f},p$q._fill=function(p$h,p$q,p$f,p$g,p$$){var p$P=this._width,p$S=this._height;this._check(p$h+p$f<=p$P&&p$q+p$g<=p$S);for(var p$B=p$q;p$B<p$g+p$q;++p$B){this._check(this._rowInfo[p$B].spaceCount>=p$f),this._rowInfo[p$B].spaceCount-=p$f;for(var p$r=0;p$r<p$f;p$r++){var p$Y=3*(p$h+p$B*p$P+p$r);this._check(0==this._cells[p$Y]),this._cells[p$Y]=p$$,this._cells[1+p$Y]=p$f,this._cells[2+p$Y]=p$g}}if(0<p$h)for(p$B=0;p$B<p$g;++p$B){var p$C=0;for(p$r=p$h-1;0<=p$r&&0==this._cells[3*((p$q+p$B)*p$P+p$r)];--p$r,++p$C);for(p$r=p$C;0<p$r;--p$r)this._cells[3*((p$q+p$B)*p$P+p$h-p$r)+1]=p$r,this._check(0<p$r)}if(0<p$q)for(p$r=p$h;p$r<p$h+p$f;++p$r){for(p$C=0,p$B=p$q-1;0<=p$B&&0==this._cells[3*(p$r+p$B*p$P)];--p$B,p$C++);for(p$B=p$C;0<p$B;--p$B)this._cells[3*(p$r+(p$q-p$B)*p$P)+2]=p$B,this._check(0<p$B)}},p$q._check=function(p$h){0==p$h&&console.log("xtexMerger 错误啦")},p$q._clear=function(){for(var p$h=this._texCount=0;p$h<this._height;p$h++)this._rowInfo[p$h].spaceCount=this._width;for(var p$q=0;p$q<this._height;p$q++)for(var p$f=0;p$f<this._width;p$f++){var p$g=3*(p$q*this._width+p$f);this._cells[p$g]=0,this._cells[1+p$g]=this._width-p$f,this._cells[2+p$g]=this._width-p$q}this._failSize.width=this._width+1,this._failSize.height=this._height+1},p$h.__init$=function(){p$g=function(){function p$h(){this.spaceCount=0}return p$u(p$h,""),p$h}(),p$$=function(){function p$h(){this.width=0,this.height=0}return p$u(p$h,""),p$h}()},p$h}(),p$H=function(){function p$_(p$h,p$q,p$f,p$g){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=p$h,this._height=p$q,this._gridSize=p$f,this._maxAtlaserCount=p$g,this._gridNumX=p$h/p$f,this._gridNumY=p$q/p$f,this._curAtlasIndex=0,this._atlaserArray=[]}p$u(p$_,"laya.webgl.atlas.AtlasResourceManager");var p$h=p$_.prototype;return p$h.setAtlasParam=function(p$h,p$q,p$f,p$g){if(1==this._setAtlasParam)return p$_._sid_=0,this._width=p$h,this._height=p$q,this._gridSize=p$f,this._maxAtlaserCount=p$g,this._gridNumX=p$h/p$f,this._gridNumY=p$q/p$f,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},p$h.pushData=function(p$h){var p$q,p$f=p$h.bitmap,p$g=-1,p$$=null,p$P=0,p$S=0;for(p$P=0,p$q=this._atlaserArray.length;p$P<p$q&&(p$S=(this._curAtlasIndex+p$P)%p$q,-1==(p$g=(p$$=this._atlaserArray[p$S]).findBitmapIsExist(p$f)));p$P++);if(-1!=p$g){var p$B=p$$.InAtlasWebGLImagesOffsetValue[p$g];return p$L=p$B[0],p$e=p$B[1],p$$.addToAtlas(p$h,p$L,p$e),!0}this._setAtlasParam=!1;for(var p$r=Math.ceil((p$h.bitmap.width+2)/this._gridSize),p$Y=Math.ceil((p$h.bitmap.height+2)/this._gridSize),p$C=!1,p$U=0;p$U<2;p$U++){var p$u=this._maxAtlaserCount;for(p$P=0;p$P<p$u;p$P++){p$S=(this._curAtlasIndex+p$P)%p$u,this._atlaserArray.length-1>=p$S||this._atlaserArray.push(new p$ph(this._gridNumX,this._gridNumY,this._width,this._height,p$_._sid_++));var p$v=this._atlaserArray[p$S],p$L=0,p$e=0,p$l=p$v.addTex(1,p$r,p$Y);if(p$l.ret){p$L=p$l.x*this._gridSize+1,p$e=p$l.y*this._gridSize+1,p$f.lock=!0,p$v.addToAtlasTexture(p$f,p$L,p$e),p$v.addToAtlas(p$h,p$L,p$e),p$C=!0,this._curAtlasIndex=p$S;break}}if(p$C)break;this._atlaserArray.push(new p$ph(this._gridNumX,this._gridNumY,this._width,this._height,p$_._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return p$C||console.log(">>>AtlasManager pushData error"),p$C},p$h.addToAtlas=function(p$h){laya.webgl.atlas.AtlasResourceManager.instance.pushData(p$h)},p$h.garbageCollection=function(){if(!0===this._needGC){for(var p$h=this._atlaserArray.length-this._maxAtlaserCount,p$q=0;p$q<p$h;p$q++)this._atlaserArray[p$q].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+p$h),this._atlaserArray.splice(0,p$h),this._needGC=!1}return!0},p$h.freeAll=function(){for(var p$h=0,p$q=this._atlaserArray.length;p$h<p$q;p$h++)this._atlaserArray[p$h].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},p$h.getAtlaserCount=function(){return this._atlaserArray.length},p$h.getAtlaserByIndex=function(p$h){return this._atlaserArray[p$h]},p$g(1,p$_,"instance",function(){return p$_._Instance||(p$_._Instance=new p$_(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),p$_._Instance}),p$g(1,p$_,"enabled",function(){return p$t.atlasEnable}),p$g(1,p$_,"atlasLimitWidth",function(){return p$_._atlasLimitWidth},function(p$h){p$_._atlasLimitWidth=p$h}),p$g(1,p$_,"atlasLimitHeight",function(){return p$_._atlasLimitHeight},function(p$h){p$_._atlasLimitHeight=p$h}),p$_._enable=function(){p$t.atlasEnable=!0},p$_._disable=function(){p$t.atlasEnable=!1},p$_.__init__=function(){p$_.atlasTextureWidth=2048,p$_.atlasTextureHeight=2048,p$_.maxTextureCount=6,p$_.atlasLimitWidth=512,p$_.atlasLimitHeight=512},p$_._atlasLimitWidth=0,p$_._atlasLimitHeight=0,p$_.gridSize=16,p$_.atlasTextureWidth=0,p$_.atlasTextureHeight=0,p$_.maxTextureCount=0,p$_._atlasRestore=0,p$_.BOARDER_TYPE_NO=0,p$_.BOARDER_TYPE_RIGHT=1,p$_.BOARDER_TYPE_LEFT=2,p$_.BOARDER_TYPE_BOTTOM=4,p$_.BOARDER_TYPE_TOP=8,p$_.BOARDER_TYPE_ALL=15,p$_._sid_=0,p$_._Instance=null,p$_}(),p$D=function(){function p$h(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return p$u(p$h,"laya.webgl.atlas.MergeFillInfo"),p$h}(),p$s=function(){function p$q(){}return p$u(p$q,"laya.webgl.canvas.BlendMode"),p$q._init_=function(p$h){p$q.fns=[p$q.BlendNormal,p$q.BlendAdd,p$q.BlendMultiply,p$q.BlendScreen,p$q.BlendOverlay,p$q.BlendLight,p$q.BlendMask,p$q.BlendDestinationOut],p$q.targetFns=[p$q.BlendNormalTarget,p$q.BlendAddTarget,p$q.BlendMultiplyTarget,p$q.BlendScreenTarget,p$q.BlendOverlayTarget,p$q.BlendLightTarget,p$q.BlendMask,p$q.BlendDestinationOut]},p$q.BlendNormal=function(p$h){p$h.blendFunc(1,771)},p$q.BlendAdd=function(p$h){p$h.blendFunc(1,772)},p$q.BlendMultiply=function(p$h){p$h.blendFunc(774,771)},p$q.BlendScreen=function(p$h){p$h.blendFunc(1,1)},p$q.BlendOverlay=function(p$h){p$h.blendFunc(1,769)},p$q.BlendLight=function(p$h){p$h.blendFunc(1,1)},p$q.BlendNormalTarget=function(p$h){p$h.blendFunc(1,771)},p$q.BlendAddTarget=function(p$h){p$h.blendFunc(1,772)},p$q.BlendMultiplyTarget=function(p$h){p$h.blendFunc(774,771)},p$q.BlendScreenTarget=function(p$h){p$h.blendFunc(1,1)},p$q.BlendOverlayTarget=function(p$h){p$h.blendFunc(1,769)},p$q.BlendLightTarget=function(p$h){p$h.blendFunc(1,1)},p$q.BlendMask=function(p$h){p$h.blendFunc(0,770)},p$q.BlendDestinationOut=function(p$h){p$h.blendFunc(0,0)},p$q.activeBlendFunction=null,p$q.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],p$q.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},p$q.NORMAL="normal",p$q.ADD="add",p$q.MULTIPLY="multiply",p$q.SCREEN="screen",p$q.LIGHT="light",p$q.OVERLAY="overlay",p$q.DESTINATIONOUT="destination-out",p$q.fns=[],p$q.targetFns=[],p$q}(),p$V=function(){function p$f(p$h){this._color=p$L.create("black"),this.setValue(p$h)}p$u(p$f,"laya.webgl.canvas.DrawStyle");var p$h=p$f.prototype;return p$h.setValue=function(p$h){if(p$h){if("string"==typeof p$h)return void(this._color=p$L.create(p$h));if(p$h instanceof laya.utils.Color)return void(this._color=p$h)}},p$h.reset=function(){this._color=p$L.create("black")},p$h.equal=function(p$h){return"string"==typeof p$h?this._color.strColor===p$h:p$h instanceof laya.utils.Color&&this._color.numColor===p$h.numColor},p$h.toColorStr=function(){return this._color.strColor},p$f.create=function(p$h){var p$q;if(p$h&&("string"==typeof p$h?p$q=p$L.create(p$h):p$h instanceof laya.utils.Color&&(p$q=p$h),p$q))return p$q._drawStyle||(p$q._drawStyle=new p$f(p$h));return laya.webgl.canvas.DrawStyle.DEFAULT},p$S(p$f,["DEFAULT",function(){return this.DEFAULT=new p$f("#000000")}]),p$f}(),p$K=function(){function p$h(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];p$mh.mainContext;this.ib=p$xh.create(35048),this.vb=p$ah.create(5)}p$u(p$h,"laya.webgl.canvas.Path");var p$q=p$h.prototype;return p$q.addPoint=function(p$h,p$q){this.tempArray.push(p$h,p$q)},p$q.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},p$q.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},p$q.polygon=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S;return this.geomatrys.push(this._curGeomatry=p$S=new p$ih(p$h,p$q,p$f,p$g,p$$,p$P)),p$g||(p$S.fill=!1),null==p$P&&(p$S.borderWidth=0),p$S},p$q.setGeomtry=function(p$h){this.geomatrys.push(this._curGeomatry=p$h)},p$q.drawLine=function(p$h,p$q,p$f,p$g,p$$){var p$P;return this.closePath?this.geomatrys.push(this._curGeomatry=p$P=new p$bh(p$h,p$q,p$f,p$g,p$$)):this.geomatrys.push(this._curGeomatry=p$P=new p$dh(p$h,p$q,p$f,p$g,p$$)),p$P.fill=!1,p$P},p$q.update=function(){var p$h=this.ib._byteLength,p$q=this.geomatrys.length;this.offset=p$h;for(var p$f=this.geoStart;p$f<p$q;p$f++)this.geomatrys[p$f].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=p$q,this.count=(this.ib._byteLength-p$h)/p$eh.BYTES_PIDX},p$q.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},p$q.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},p$h}(),p$y=function(){function p$B(){}p$u(p$B,"laya.webgl.canvas.save.SaveBase");var p$h=p$B.prototype;return p$R.imps(p$h,{"laya.webgl.canvas.save.ISaveData":!0}),p$h.isSaveMark=function(){return!1},p$h.restore=function(p$h){this._dataObj[this._valueName]=this._value,(p$B._cache[p$B._cache._length++]=this)._newSubmit&&(p$h._curSubmit=p$Ph.RENDERBASE,p$h._renderKey=0)},p$B._createArray=function(){var p$h=[];return p$h._length=0,p$h},p$B._init=function(){var p$h=p$B._namemap={};return p$h[1]="ALPHA",p$h[2]="fillStyle",p$h[8]="font",p$h[256]="lineWidth",p$h[512]="strokeStyle",p$h[8192]="_mergeID",p$h[1024]=p$h[2048]=p$h[4096]=[],p$h[16384]="textBaseline",p$h[32768]="textAlign",p$h[65536]="_nBlendType",p$h[1048576]="shader",p$h[2097152]="filters",p$h},p$B.save=function(p$h,p$q,p$f,p$g){if((p$h._saveMark._saveuse&p$q)!==p$q){p$h._saveMark._saveuse|=p$q;var p$$=p$B._cache,p$P=0<p$$._length?p$$[--p$$._length]:new p$B;p$P._value=p$f[p$P._valueName=p$B._namemap[p$q]],p$P._dataObj=p$f,p$P._newSubmit=p$g;var p$S=p$h._save;p$S[p$S._length++]=p$P}},p$B._cache=laya.webgl.canvas.save.SaveBase._createArray(),p$B._namemap=p$B._init(),p$B}(),p$F=function(){function p$P(){this._clipRect=new p$p}p$u(p$P,"laya.webgl.canvas.save.SaveClipRect");var p$h=p$P.prototype;return p$R.imps(p$h,{"laya.webgl.canvas.save.ISaveData":!0}),p$h.isSaveMark=function(){return!1},p$h.restore=function(p$h){p$h._clipRect=this._clipSaveRect,(p$P._cache[p$P._cache._length++]=this)._submitScissor.submitLength=p$h._submits._length-this._submitScissor.submitIndex,p$h._curSubmit=p$Ph.RENDERBASE,p$h._renderKey=0},p$P.save=function(p$h,p$q){if(131072!=(131072&p$h._saveMark._saveuse)){p$h._saveMark._saveuse|=131072;var p$f=p$P._cache,p$g=0<p$f._length?p$f[--p$f._length]:new p$P;p$g._clipSaveRect=p$h._clipRect,p$h._clipRect=p$g._clipRect.copyFrom(p$h._clipRect),p$g._submitScissor=p$q;var p$$=p$h._save;p$$[p$$._length++]=p$g}},p$S(p$P,["_cache",function(){return this._cache=p$y._createArray()}]),p$P}(),p$Z=function(){function p$v(){this._contextX=0,this._contextY=0,this._clipRect=new p$p,this._rect=new p$p,this._matrix=new p$n}p$u(p$v,"laya.webgl.canvas.save.SaveClipRectStencil");var p$h=p$v.prototype;return p$R.imps(p$h,{"laya.webgl.canvas.save.ISaveData":!0}),p$h.isSaveMark=function(){return!1},p$h.restore=function(p$h){p$Ch.restore(p$h,this._rect,this._saveMatrix,this._contextX,this._contextY),p$h._clipRect=this._clipSaveRect,p$h._curMat=this._saveMatrix,p$h._x=this._contextX,p$h._y=this._contextY,p$v._cache[p$v._cache._length++]=this,p$h._curSubmit=p$Ph.RENDERBASE},p$v.save=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){if(262144!=(262144&p$h._saveMark._saveuse)){p$h._saveMark._saveuse|=262144;var p$C=p$v._cache,p$U=0<p$C._length?p$C[--p$C._length]:new p$v;p$U._clipSaveRect=p$h._clipRect,p$U._clipRect.setTo(p$S,p$B,p$r,p$Y),p$h._clipRect=p$U._clipRect,p$U._rect.x=p$f,p$U._rect.y=p$g,p$U._rect.width=p$$,p$U._rect.height=p$P,p$U._contextX=p$h._x,p$U._contextY=p$h._y,p$U._saveMatrix=p$h._curMat,p$h._curMat.copyTo(p$U._matrix),p$h._curMat=p$U._matrix,p$U._submitStencil=p$q;var p$u=p$h._save;p$u[p$u._length++]=p$U}},p$S(p$v,["_cache",function(){return this._cache=p$y._createArray()}]),p$v}(),p$Q=function(){function p$g(){this._saveuse=0}p$u(p$g,"laya.webgl.canvas.save.SaveMark");var p$h=p$g.prototype;return p$R.imps(p$h,{"laya.webgl.canvas.save.ISaveData":!0}),p$h.isSaveMark=function(){return!0},p$h.restore=function(p$h){p$h._saveMark=this._preSaveMark,p$g._no[p$g._no._length++]=this},p$g.Create=function(p$h){var p$q=p$g._no,p$f=0<p$q._length?p$q[--p$q._length]:new p$g;return p$f._saveuse=0,p$f._preSaveMark=p$h._saveMark,p$h._saveMark=p$f},p$S(p$g,["_no",function(){return this._no=p$y._createArray()}]),p$g}(),p$o=function(){function p$P(){this._matrix=new p$n}p$u(p$P,"laya.webgl.canvas.save.SaveTransform");var p$h=p$P.prototype;return p$R.imps(p$h,{"laya.webgl.canvas.save.ISaveData":!0}),p$h.isSaveMark=function(){return!1},p$h.restore=function(p$h){p$h._curMat=this._savematrix,p$P._no[p$P._no._length++]=this},p$P.save=function(p$h){var p$q=p$h._saveMark;if(2048!=(2048&p$q._saveuse)){p$q._saveuse|=2048;var p$f=p$P._no,p$g=0<p$f._length?p$f[--p$f._length]:new p$P;p$g._savematrix=p$h._curMat,p$h._curMat=p$h._curMat.copyTo(p$g._matrix);var p$$=p$h._save;p$$[p$$._length++]=p$g}},p$S(p$P,["_no",function(){return this._no=p$y._createArray()}]),p$P}(),p$O=function(){function p$$(){}p$u(p$$,"laya.webgl.canvas.save.SaveTranslate");var p$h=p$$.prototype;return p$R.imps(p$h,{"laya.webgl.canvas.save.ISaveData":!0}),p$h.isSaveMark=function(){return!1},p$h.restore=function(p$h){p$h._curMat;p$h._x=this._x,p$h._y=this._y,p$$._no[p$$._no._length++]=this},p$$.save=function(p$h){var p$q=p$$._no,p$f=0<p$q._length?p$q[--p$q._length]:new p$$;p$f._x=p$h._x,p$f._y=p$h._y;var p$g=p$h._save;p$g[p$g._length++]=p$f},p$S(p$$,["_no",function(){return this._no=p$y._createArray()}]),p$$}(),p$j=function(){function p$h(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new p$p}p$u(p$h,"laya.webgl.resource.RenderTargetMAX");var p$q=p$h.prototype;return p$q.setSP=function(p$h){this._sp=p$h},p$q.size=function(p$h,p$q){var p$f=this;this._width!==p$h||this._height!==p$q?(this.repaint=!0,this._width=p$h,this._height=p$q,this.target?this.target.size(p$h,p$q):this.target=p$Th.create(p$h,p$q),this.target.hasListener("recovered")||this.target.on("recovered",this,function(p$h){p$R.timer.callLater(p$f._sp,p$f._sp.repaint)})):this.target.size(p$h,p$q)},p$q._flushToTarget=function(p$h,p$q){if(!p$q._destroy){var p$f=p$Nh.worldScissorTest,p$g=p$Nh.worldClipRect;p$Nh.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,p$Nh.worldScissorTest=!1,p$mh.mainContext.disable(3089);var p$$=p$Nh.worldAlpha,p$P=p$Nh.worldMatrix4,p$S=p$Nh.worldMatrix,p$B=p$Nh.worldFilters,p$r=p$Nh.worldShaderDefines;if(p$Nh.worldMatrix=p$n.EMPTY,p$Nh.restoreTempArray(),p$Nh.worldMatrix4=p$Nh.TEMPMAT4_ARRAY,p$Nh.worldAlpha=1,p$Nh.worldFilters=null,p$Nh.worldShaderDefines=null,p$Wh.activeShader=null,p$q.start(),p$t.showCanvasMark?p$q.clear(0,1,0,.3):p$q.clear(0,0,0,0),p$h.flush(),p$q.end(),p$Wh.activeShader=null,p$Nh.worldAlpha=p$$,p$Nh.worldMatrix4=p$P,p$Nh.worldMatrix=p$S,p$Nh.worldFilters=p$B,p$Nh.worldShaderDefines=p$r,p$Nh.worldScissorTest=p$f){var p$Y=p$Nh.height-p$g.y-p$g.height;p$mh.mainContext.scissor(p$g.x,p$Y,p$g.width,p$g.height),p$mh.mainContext.enable(3089)}p$Nh.worldClipRect=p$g}},p$q.flush=function(p$h){this.repaint&&(this._flushToTarget(p$h,this.target),this.repaint=!1)},p$q.drawTo=function(p$h,p$q,p$f,p$g,p$$){p$h.drawTexture(this.target.getTexture(),p$q,p$f,p$g,p$$,0,0)},p$q.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},p$h}(),p$x=function(){function p$h(){this.ALPHA=1,this.shaderType=0,this.defines=new p$Ah}return p$u(p$h,"laya.webgl.shader.d2.Shader2D"),p$h.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},p$h.__init__=function(){var p$h,p$q;p$Qh.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),p$Qh.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),p$Qh.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),p$Qh.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),p$Qh.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),p$Qh.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),p$Qh.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),p$Qh.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),p$h="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",p$q='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',p$Qh.preCompile2D(0,1,p$h,p$q,null),p$h="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",p$q='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',p$Qh.preCompile2D(0,2,p$h,p$q,null),p$h="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",p$q="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",p$Qh.preCompile2D(0,4,p$h,p$q,null),p$h="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",p$q='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',p$Qh.preCompile2D(0,256,p$h,p$q,null),p$h="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",p$q="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",p$Qh.preCompile2D(0,512,p$h,p$q,null)},p$h}(),p$a=function(){function p$q(p$h,p$q,p$f){this._value=0,this._name2int=p$h,this._int2name=p$q,this._int2nameMap=p$f}p$u(p$q,"laya.webgl.shader.ShaderDefines");var p$h=p$q.prototype;return p$h.add=function(p$h){return"string"==typeof p$h&&(p$h=this._name2int[p$h]),this._value|=p$h,this._value},p$h.addInt=function(p$h){return this._value|=p$h,this._value},p$h.remove=function(p$h){return"string"==typeof p$h&&(p$h=this._name2int[p$h]),this._value&=~p$h,this._value},p$h.isDefine=function(p$h){return(this._value&p$h)===p$h},p$h.getValue=function(){return this._value},p$h.setValue=function(p$h){this._value=p$h},p$h.toNameDic=function(){var p$h=this._int2nameMap[this._value];return p$h||p$q._toText(this._value,this._int2name,this._int2nameMap)},p$q._reg=function(p$h,p$q,p$f,p$g){p$g[p$f[p$h]=p$q]=p$h},p$q._toText=function(p$h,p$q,p$f){var p$g=p$f[p$h];if(p$g)return p$g;for(var p$$={},p$P=1,p$S=0;p$S<32&&!(p$h<(p$P=1<<p$S));p$S++)if(p$h&p$P){var p$B=p$q[p$P];p$B&&(p$$[p$B]="")}return p$f[p$h]=p$$},p$q._toInt=function(p$h,p$q){for(var p$f=p$h.split("."),p$g=0,p$$=0,p$P=p$f.length;p$$<p$P;p$$++){var p$S=p$q[p$f[p$$]];if(!p$S)throw new Error("Defines to int err:"+p$h+"/"+p$f[p$$]);p$g|=p$S}return p$g},p$q}(),p$hh=function(){function p$S(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new p$n}p$u(p$S,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var p$h=p$S.prototype;return p$h.init=function(p$h,p$q,p$f){if(p$q)this._vs=p$q;else{this._vs=[];var p$g=p$h.width,p$$=p$h.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(p$g,0,1,0,1,1,1,1),this._vs.push(p$g,p$$,1,1,1,1,1,1),this._vs.push(0,p$$,0,1,1,1,1,1)}p$f?this._ps=p$f:(p$S._defaultPS||(p$S._defaultPS=[]).push(0,1,3,3,1,2),this._ps=p$S._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=p$h},p$h.init2=function(p$h,p$q,p$f,p$g,p$$){this.transform&&(this.transform=null),p$f?this._ps=p$f:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=p$g,this._uvs=p$$,this.mEleNum=this._ps.length,this.mTexture=p$h,(p$_.isConchNode||p$_.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},p$h._initMyData=function(){var p$h=0,p$q=0,p$f=4*this._verticles.length;this._vs=p$S._tempVS;var p$g=!1;if(p$_.isConchNode||p$_.isConchApp?(this._vs.length=p$f,p$g=!0):this._vs.length<p$f&&(this._vs.length=p$f,p$g=!0),p$S._tVSLen=p$f,p$g)for(;p$h<p$f;)this._vs[p$h]=this._verticles[p$q],this._vs[p$h+1]=this._verticles[p$q+1],this._vs[p$h+2]=this._uvs[p$q],this._vs[p$h+3]=this._uvs[p$q+1],this._vs[p$h+4]=1,this._vs[p$h+5]=1,this._vs[p$h+6]=1,this._vs[p$h+7]=1,p$h+=8,p$q+=2;else for(;p$h<p$f;)this._vs[p$h]=this._verticles[p$q],this._vs[p$h+1]=this._verticles[p$q+1],this._vs[p$h+2]=this._uvs[p$q],this._vs[p$h+3]=this._uvs[p$q+1],p$h+=8,p$q+=2},p$h.getData2=function(p$h,p$q,p$f){var p$g;this.mVBBuffer=p$h,this.mIBBuffer=p$q,this._initMyData(),p$h.appendEx2(this._vs,Float32Array,p$S._tVSLen,4),this._indexStart=p$q._byteLength,(p$g=p$S._tempIB).length<this._ps.length&&(p$g.length=this._ps.length);for(var p$$=0,p$P=this._ps.length;p$$<p$P;p$$++)p$g[p$$]=this._ps[p$$]+p$f;p$q.appendEx2(p$g,Uint16Array,this._ps.length,2)},p$h.getData=function(p$h,p$q,p$f){if(this.mVBBuffer=p$h,this.mIBBuffer=p$q,p$h.append(this.mVBData),this._indexStart=p$q._byteLength,this.mIBData.start!=p$f){for(var p$g=0,p$$=this._ps.length;p$g<p$$;p$g++)this.mIBData[p$g]=this._ps[p$g]+p$f;this.mIBData.start=p$f}p$q.append(this.mIBData)},p$h.render=function(p$h,p$q,p$f){if(p$_.isWebGL&&this.mTexture){p$h._renderKey=0,p$h._shader2D.glTexture=null,p$qh.getInstance().addSkinMesh(this);var p$g=p$Ph.createShape(p$h,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,p$Xh.create(512,0));this.transform||(this.transform=p$n.EMPTY),this.transform.translate(p$q,p$f),p$n.mul(this.transform,p$h._curMat,this._tempMatrix),this.transform.translate(-p$q,-p$f);var p$$=p$g.shaderValue,p$P=p$$.u_mmat2||p$Nh.getMatrArray();p$Nh.mat2MatArray(this._tempMatrix,p$P),p$$.textureHost=this.mTexture,p$$.offsetX=0,p$$.offsetY=0,p$$.u_mmat2=p$P,p$$.ALPHA=p$h._shader2D.ALPHA,p$h._submits[p$h._submits._length++]=p$g}else p$_.isConchApp&&this.mTexture&&(this.transform||(this.transform=p$n.EMPTY),p$h.setSkinMesh&&p$h.setSkinMesh(p$q,p$f,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},p$S._tempVS=[],p$S._tempIB=[],p$S._defaultPS=null,p$S._tVSLen=0,p$S}(),p$qh=function(){function p$h(){this.ib=null,this.vb=null;p$mh.mainContext;this.ib=p$xh.create(35048),this.vb=p$ah.create(8)}p$u(p$h,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var p$q=p$h.prototype;return p$q.addSkinMesh=function(p$h){p$h.getData2(this.vb,this.ib,this.vb._byteLength/32)},p$q.reset=function(){this.vb.clear(),this.ib.clear()},p$h.getInstance=function(){return p$h.instance=p$h.instance||new p$h},p$h.instance=null,p$h}(),p$fh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===p$r&&(p$r=0),this.x=p$h,this.y=p$q,this.width=p$f,this.height=p$g,this.edges=p$$,this.color=p$P,this.borderWidth=p$S,this.borderColor=p$B}p$u(p$h,"laya.webgl.shapes.BasePoly");var p$q=p$h.prototype;return p$R.imps(p$q,{"laya.webgl.shapes.IShape":!0}),p$q.getData=function(p$h,p$q,p$f){},p$q.rebuild=function(p$h){},p$q.setMatrix=function(p$h){},p$q.needUpdate=function(p$h){return!0},p$q.sector=function(p$h,p$q,p$f){var p$g=this.x,p$$=this.y,p$P=this.edges,p$S=(this.r1-this.r0)/p$P,p$B=this.width,p$r=this.height,p$Y=this.color,p$C=(p$Y>>16&255)/255,p$U=(p$Y>>8&255)/255,p$u=(255&p$Y)/255;p$h.push(p$g,p$$,p$C,p$U,p$u);for(var p$v=0;p$v<p$P+1;p$v++)p$h.push(p$g+Math.sin(p$S*p$v+this.r0)*p$B,p$$+Math.cos(p$S*p$v+this.r0)*p$r),p$h.push(p$C,p$U,p$u);for(p$v=0;p$v<p$P;p$v++)p$q.push(p$f,p$f+p$v+1,p$f+p$v+2)},p$q.createLine2=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S,p$B,p$r,p$Y,p$C,p$U,p$u,p$v,p$L,p$e,p$l,p$_,p$N,p$G,p$m,p$E,p$R,p$t,p$X,p$n,p$J=p$h.concat(),p$p=p$$,p$A=this.borderColor,p$d=(p$A>>16&255)/255,p$b=(p$A>>8&255)/255,p$i=(255&p$A)/255,p$z=p$J.length/2,p$c=p$g,p$M=p$f/2;p$r=p$J[0],p$Y=p$J[1],p$e=p$r-(p$C=p$J[2]),p$L=(p$L=-(p$Y-(p$U=p$J[3])))/(p$n=Math.sqrt(p$L*p$L+p$e*p$e))*p$M,p$e=p$e/p$n*p$M,p$p.push(p$r-p$L+this.x,p$Y-p$e+this.y,p$d,p$b,p$i,p$r+p$L+this.x,p$Y+p$e+this.y,p$d,p$b,p$i);for(var p$W=1;p$W<p$z-1;p$W++)p$r=p$J[2*(p$W-1)],p$Y=p$J[2*(p$W-1)+1],p$C=p$J[2*p$W],p$U=p$J[2*p$W+1],p$u=p$J[2*(p$W+1)],p$v=p$J[2*(p$W+1)+1],p$e=p$r-p$C,p$_=p$C-p$u,p$m=(-(p$L=(p$L=-(p$Y-p$U))/(p$n=Math.sqrt(p$L*p$L+p$e*p$e))*p$M)+p$r)*(-(p$e=p$e/p$n*p$M)+p$U)-(-p$L+p$C)*(-p$e+p$Y),p$t=(-(p$l=(p$l=-(p$U-p$v))/(p$n=Math.sqrt(p$l*p$l+p$_*p$_))*p$M)+p$u)*(-(p$_=p$_/p$n*p$M)+p$U)-(-p$l+p$C)*(-p$_+p$v),p$X=(p$N=-p$e+p$Y-(-p$e+p$U))*(p$R=-p$l+p$C-(-p$l+p$u))-(p$E=-p$_+p$v-(-p$_+p$U))*(p$G=-p$L+p$C-(-p$L+p$r)),Math.abs(p$X)<.1?(p$X+=10.1,p$p.push(p$C-p$L+this.x,p$U-p$e+this.y,p$d,p$b,p$i,p$C+p$L+this.x,p$U+p$e+this.y,p$d,p$b,p$i)):(((p$S=(p$G*p$t-p$R*p$m)/p$X)-p$C)*(p$S-p$C)+((p$B=(p$E*p$m-p$N*p$t)/p$X)-p$U)+(p$B-p$U),p$p.push(p$S+this.x,p$B+this.y,p$d,p$b,p$i,p$C-(p$S-p$C)+this.x,p$U-(p$B-p$U)+this.y,p$d,p$b,p$i));p$r=p$J[p$J.length-4],p$Y=p$J[p$J.length-3],p$e=p$r-(p$C=p$J[p$J.length-2]),p$L=(p$L=-(p$Y-(p$U=p$J[p$J.length-1])))/(p$n=Math.sqrt(p$L*p$L+p$e*p$e))*p$M,p$e=p$e/p$n*p$M,p$p.push(p$C-p$L+this.x,p$U-p$e+this.y,p$d,p$b,p$i,p$C+p$L+this.x,p$U+p$e+this.y,p$d,p$b,p$i);var p$T=p$P;for(p$W=1;p$W<p$T;p$W++)p$q.push(p$c+2*(p$W-1),p$c+2*(p$W-1)+1,p$c+2*p$W+1,p$c+2*p$W+1,p$c+2*p$W,p$c+2*(p$W-1));return p$p},p$q.createLine=function(p$h,p$q,p$f,p$g){var p$$=p$h.concat(),p$P=p$h,p$S=this.borderColor,p$B=(p$S>>16&255)/255,p$r=(p$S>>8&255)/255,p$Y=(255&p$S)/255;p$$.splice(0,5);var p$C,p$U,p$u,p$v,p$L,p$e,p$l,p$_,p$N,p$G,p$m,p$E,p$R,p$t,p$X,p$n,p$J,p$p,p$A,p$d,p$b=p$$.length/5,p$i=p$g,p$z=p$f/2;p$u=p$$[0],p$v=p$$[1],p$G=p$u-(p$L=p$$[5]),p$N=(p$N=-(p$v-(p$e=p$$[6])))/(p$d=Math.sqrt(p$N*p$N+p$G*p$G))*p$z,p$G=p$G/p$d*p$z,p$P.push(p$u-p$N,p$v-p$G,p$B,p$r,p$Y,p$u+p$N,p$v+p$G,p$B,p$r,p$Y);for(var p$c=1;p$c<p$b-1;p$c++)p$u=p$$[5*(p$c-1)],p$v=p$$[5*(p$c-1)+1],p$L=p$$[5*p$c],p$e=p$$[5*p$c+1],p$l=p$$[5*(p$c+1)],p$_=p$$[5*(p$c+1)+1],p$G=p$u-p$L,p$E=p$L-p$l,p$X=(-(p$N=(p$N=-(p$v-p$e))/(p$d=Math.sqrt(p$N*p$N+p$G*p$G))*p$z)+p$u)*(-(p$G=p$G/p$d*p$z)+p$e)-(-p$N+p$L)*(-p$G+p$v),p$p=(-(p$m=(p$m=-(p$e-p$_))/(p$d=Math.sqrt(p$m*p$m+p$E*p$E))*p$z)+p$l)*(-(p$E=p$E/p$d*p$z)+p$e)-(-p$m+p$L)*(-p$E+p$_),p$A=(p$R=-p$G+p$v-(-p$G+p$e))*(p$J=-p$m+p$L-(-p$m+p$l))-(p$n=-p$E+p$_-(-p$E+p$e))*(p$t=-p$N+p$L-(-p$N+p$u)),Math.abs(p$A)<.1?(p$A+=10.1,p$P.push(p$L-p$N,p$e-p$G,p$B,p$r,p$Y,p$L+p$N,p$e+p$G,p$B,p$r,p$Y)):(((p$C=(p$t*p$p-p$J*p$X)/p$A)-p$L)*(p$C-p$L)+((p$U=(p$n*p$X-p$R*p$p)/p$A)-p$e)+(p$U-p$e),p$P.push(p$C,p$U,p$B,p$r,p$Y,p$L-(p$C-p$L),p$e-(p$U-p$e),p$B,p$r,p$Y));p$u=p$$[p$$.length-10],p$v=p$$[p$$.length-9],p$G=p$u-(p$L=p$$[p$$.length-5]),p$N=(p$N=-(p$v-(p$e=p$$[p$$.length-4])))/(p$d=Math.sqrt(p$N*p$N+p$G*p$G))*p$z,p$G=p$G/p$d*p$z,p$P.push(p$L-p$N,p$e-p$G,p$B,p$r,p$Y,p$L+p$N,p$e+p$G,p$B,p$r,p$Y);var p$M=this.edges+1;for(p$c=1;p$c<p$M;p$c++)p$q.push(p$i+2*(p$c-1),p$i+2*(p$c-1)+1,p$i+2*p$c+1,p$i+2*p$c+1,p$i+2*p$c,p$i+2*(p$c-1));return p$P},p$q.createLoopLine=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$h.concat(),p$B=p$$||p$h,p$r=this.borderColor,p$Y=(p$r>>16&255)/255,p$C=(p$r>>8&255)/255,p$U=(255&p$r)/255;p$S.splice(0,5);var p$u=[p$S[0],p$S[1]],p$v=[p$S[p$S.length-5],p$S[p$S.length-4]],p$L=p$v[0]+.5*(p$u[0]-p$v[0]),p$e=p$v[1]+.5*(p$u[1]-p$v[1]);p$S.unshift(p$L,p$e,0,0,0),p$S.push(p$L,p$e,0,0,0);var p$l,p$_,p$N,p$G,p$m,p$E,p$R,p$t,p$X,p$n,p$J,p$p,p$A,p$d,p$b,p$i,p$z,p$c,p$M,p$W,p$T=p$S.length/5,p$I=p$g,p$w=p$f/2;p$N=p$S[0],p$G=p$S[1],p$n=p$N-(p$m=p$S[5]),p$X=(p$X=-(p$G-(p$E=p$S[6])))/(p$W=Math.sqrt(p$X*p$X+p$n*p$n))*p$w,p$n=p$n/p$W*p$w,p$B.push(p$N-p$X,p$G-p$n,p$Y,p$C,p$U,p$N+p$X,p$G+p$n,p$Y,p$C,p$U);for(var p$k=1;p$k<p$T-1;p$k++)p$N=p$S[5*(p$k-1)],p$G=p$S[5*(p$k-1)+1],p$m=p$S[5*p$k],p$E=p$S[5*p$k+1],p$R=p$S[5*(p$k+1)],p$t=p$S[5*(p$k+1)+1],p$n=p$N-p$m,p$p=p$m-p$R,p$b=(-(p$X=(p$X=-(p$G-p$E))/(p$W=Math.sqrt(p$X*p$X+p$n*p$n))*p$w)+p$N)*(-(p$n=p$n/p$W*p$w)+p$E)-(-p$X+p$m)*(-p$n+p$G),p$c=(-(p$J=(p$J=-(p$E-p$t))/(p$W=Math.sqrt(p$J*p$J+p$p*p$p))*p$w)+p$R)*(-(p$p=p$p/p$W*p$w)+p$E)-(-p$J+p$m)*(-p$p+p$t),p$M=(p$A=-p$n+p$G-(-p$n+p$E))*(p$z=-p$J+p$m-(-p$J+p$R))-(p$i=-p$p+p$t-(-p$p+p$E))*(p$d=-p$X+p$m-(-p$X+p$N)),Math.abs(p$M)<.1?(p$M+=10.1,p$B.push(p$m-p$X,p$E-p$n,p$Y,p$C,p$U,p$m+p$X,p$E+p$n,p$Y,p$C,p$U)):(((p$l=(p$d*p$c-p$z*p$b)/p$M)-p$m)*(p$l-p$m)+((p$_=(p$i*p$b-p$A*p$c)/p$M)-p$E)+(p$_-p$E),p$B.push(p$l,p$_,p$Y,p$C,p$U,p$m-(p$l-p$m),p$E-(p$_-p$E),p$Y,p$C,p$U));p$P&&(p$q=p$P);var p$H=this.edges+1;for(p$k=1;p$k<p$H;p$k++)p$q.push(p$I+2*(p$k-1),p$I+2*(p$k-1)+1,p$I+2*p$k+1,p$I+2*p$k+1,p$I+2*p$k,p$I+2*(p$k-1));return p$q.push(p$I+2*(p$k-1),p$I+2*(p$k-1)+1,p$I+1,p$I+1,p$I,p$I+2*(p$k-1)),p$B},p$h}(),p$gh=function(){function p$e(){}return p$u(p$e,"laya.webgl.shapes.Earcut"),p$e.earcut=function(p$h,p$q,p$f){p$f=p$f||2;var p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C=p$q&&p$q.length,p$U=p$C?p$q[0]*p$f:p$h.length,p$u=p$e.linkedList(p$h,0,p$U,p$f,!0),p$v=[];if(!p$u)return p$v;if(p$C&&(p$u=p$e.eliminateHoles(p$h,p$q,p$u,p$f)),p$h.length>80*p$f){p$g=p$P=p$h[0],p$$=p$S=p$h[1];for(var p$L=p$f;p$L<p$U;p$L+=p$f)(p$B=p$h[p$L])<p$g&&(p$g=p$B),(p$r=p$h[p$L+1])<p$$&&(p$$=p$r),p$P<p$B&&(p$P=p$B),p$S<p$r&&(p$S=p$r);p$Y=0!==(p$Y=Math.max(p$P-p$g,p$S-p$$))?1/p$Y:0}return p$e.earcutLinked(p$u,p$v,p$f,p$g,p$$,p$Y),p$v},p$e.linkedList=function(p$h,p$q,p$f,p$g,p$$){var p$P,p$S;if(p$$===0<p$e.signedArea(p$h,p$q,p$f,p$g))for(p$P=p$q;p$P<p$f;p$P+=p$g)p$S=p$e.insertNode(p$P,p$h[p$P],p$h[p$P+1],p$S);else for(p$P=p$f-p$g;p$q<=p$P;p$P-=p$g)p$S=p$e.insertNode(p$P,p$h[p$P],p$h[p$P+1],p$S);return p$S&&p$e.equals(p$S,p$S.next)&&(p$e.removeNode(p$S),p$S=p$S.next),p$S},p$e.filterPoints=function(p$h,p$q){if(!p$h)return p$h;p$q||(p$q=p$h);var p$f,p$g=p$h;do{if(p$f=!1,p$g.steiner||!p$e.equals(p$g,p$g.next)&&0!==p$e.area(p$g.prev,p$g,p$g.next))p$g=p$g.next;else{if(p$e.removeNode(p$g),(p$g=p$q=p$g.prev)===p$g.next)break;p$f=!0}}while(p$f||p$g!==p$q);return p$q},p$e.earcutLinked=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){if(p$h){!p$S&&p$P&&p$e.indexCurve(p$h,p$g,p$$,p$P);for(var p$B,p$r,p$Y=p$h;p$h.prev!==p$h.next;)if(p$B=p$h.prev,p$r=p$h.next,p$P?p$e.isEarHashed(p$h,p$g,p$$,p$P):p$e.isEar(p$h))p$q.push(p$B.i/p$f),p$q.push(p$h.i/p$f),p$q.push(p$r.i/p$f),p$e.removeNode(p$h),p$h=p$r.next,p$Y=p$r.next;else if((p$h=p$r)===p$Y){p$S?1===p$S?(p$h=p$e.cureLocalIntersections(p$h,p$q,p$f),p$e.earcutLinked(p$h,p$q,p$f,p$g,p$$,p$P,2)):2===p$S&&p$e.splitEarcut(p$h,p$q,p$f,p$g,p$$,p$P):p$e.earcutLinked(p$e.filterPoints(p$h,null),p$q,p$f,p$g,p$$,p$P,1);break}}},p$e.isEar=function(p$h){var p$q=p$h.prev,p$f=p$h,p$g=p$h.next;if(0<=p$e.area(p$q,p$f,p$g))return!1;for(var p$$=p$h.next.next;p$$!==p$h.prev;){if(p$e.pointInTriangle(p$q.x,p$q.y,p$f.x,p$f.y,p$g.x,p$g.y,p$$.x,p$$.y)&&0<=p$e.area(p$$.prev,p$$,p$$.next))return!1;p$$=p$$.next}return!0},p$e.isEarHashed=function(p$h,p$q,p$f,p$g){var p$$=p$h.prev,p$P=p$h,p$S=p$h.next;if(0<=p$e.area(p$$,p$P,p$S))return!1;for(var p$B=p$$.x<p$P.x?p$$.x<p$S.x?p$$.x:p$S.x:p$P.x<p$S.x?p$P.x:p$S.x,p$r=p$$.y<p$P.y?p$$.y<p$S.y?p$$.y:p$S.y:p$P.y<p$S.y?p$P.y:p$S.y,p$Y=p$$.x>p$P.x?p$$.x>p$S.x?p$$.x:p$S.x:p$P.x>p$S.x?p$P.x:p$S.x,p$C=p$$.y>p$P.y?p$$.y>p$S.y?p$$.y:p$S.y:p$P.y>p$S.y?p$P.y:p$S.y,p$U=p$e.zOrder(p$B,p$r,p$q,p$f,p$g),p$u=p$e.zOrder(p$Y,p$C,p$q,p$f,p$g),p$v=p$h.nextZ;p$v&&p$v.z<=p$u;){if(p$v!==p$h.prev&&p$v!==p$h.next&&p$e.pointInTriangle(p$$.x,p$$.y,p$P.x,p$P.y,p$S.x,p$S.y,p$v.x,p$v.y)&&0<=p$e.area(p$v.prev,p$v,p$v.next))return!1;p$v=p$v.nextZ}for(p$v=p$h.prevZ;p$v&&p$v.z>=p$U;){if(p$v!==p$h.prev&&p$v!==p$h.next&&p$e.pointInTriangle(p$$.x,p$$.y,p$P.x,p$P.y,p$S.x,p$S.y,p$v.x,p$v.y)&&0<=p$e.area(p$v.prev,p$v,p$v.next))return!1;p$v=p$v.prevZ}return!0},p$e.cureLocalIntersections=function(p$h,p$q,p$f){var p$g=p$h;do{var p$$=p$g.prev,p$P=p$g.next.next;!p$e.equals(p$$,p$P)&&p$e.intersects(p$$,p$g,p$g.next,p$P)&&p$e.locallyInside(p$$,p$P)&&p$e.locallyInside(p$P,p$$)&&(p$q.push(p$$.i/p$f),p$q.push(p$g.i/p$f),p$q.push(p$P.i/p$f),p$e.removeNode(p$g),p$e.removeNode(p$g.next),p$g=p$h=p$P),p$g=p$g.next}while(p$g!==p$h);return p$g},p$e.splitEarcut=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$h;do{for(var p$B=p$S.next.next;p$B!==p$S.prev;){if(p$S.i!==p$B.i&&p$e.isValidDiagonal(p$S,p$B)){var p$r=p$e.splitPolygon(p$S,p$B);return p$S=p$e.filterPoints(p$S,p$S.next),p$r=p$e.filterPoints(p$r,p$r.next),p$e.earcutLinked(p$S,p$q,p$f,p$g,p$$,p$P),void p$e.earcutLinked(p$r,p$q,p$f,p$g,p$$,p$P)}p$B=p$B.next}p$S=p$S.next}while(p$S!==p$h)},p$e.eliminateHoles=function(p$h,p$q,p$f,p$g){var p$$,p$P,p$S,p$B,p$r,p$Y=[];for(p$$=0,p$P=p$q.length;p$$<p$P;p$$++)p$S=p$q[p$$]*p$g,p$B=p$$<p$P-1?p$q[p$$+1]*p$g:p$h.length,(p$r=p$e.linkedList(p$h,p$S,p$B,p$g,!1))===p$r.next&&(p$r.steiner=!0),p$Y.push(p$e.getLeftmost(p$r));for(p$Y.sort(p$e.compareX),p$$=0;p$$<p$Y.length;p$$++)p$e.eliminateHole(p$Y[p$$],p$f),p$f=p$e.filterPoints(p$f,p$f.next);return p$f},p$e.compareX=function(p$h,p$q){return p$h.x-p$q.x},p$e.eliminateHole=function(p$h,p$q){if(p$q=p$e.findHoleBridge(p$h,p$q)){var p$f=p$e.splitPolygon(p$q,p$h);p$e.filterPoints(p$f,p$f.next)}},p$e.findHoleBridge=function(p$h,p$q){var p$f,p$g=p$q,p$$=p$h.x,p$P=p$h.y,p$S=-1/0;do{if(p$P<=p$g.y&&p$P>=p$g.next.y&&p$g.next.y!==p$g.y){var p$B=p$g.x+(p$P-p$g.y)*(p$g.next.x-p$g.x)/(p$g.next.y-p$g.y);if(p$B<=p$$&&p$S<p$B){if((p$S=p$B)===p$$){if(p$P===p$g.y)return p$g;if(p$P===p$g.next.y)return p$g.next}p$f=p$g.x<p$g.next.x?p$g:p$g.next}}p$g=p$g.next}while(p$g!==p$q);if(!p$f)return null;if(p$$===p$S)return p$f.prev;var p$r,p$Y=p$f,p$C=p$f.x,p$U=p$f.y,p$u=1/0;for(p$g=p$f.next;p$g!==p$Y;)p$$>=p$g.x&&p$g.x>=p$C&&p$$!==p$g.x&&p$e.pointInTriangle(p$P<p$U?p$$:p$S,p$P,p$C,p$U,p$P<p$U?p$S:p$$,p$P,p$g.x,p$g.y)&&((p$r=Math.abs(p$P-p$g.y)/(p$$-p$g.x))<p$u||p$r===p$u&&p$g.x>p$f.x)&&p$e.locallyInside(p$g,p$h)&&(p$f=p$g,p$u=p$r),p$g=p$g.next;return p$f},p$e.indexCurve=function(p$h,p$q,p$f,p$g){for(var p$$=p$h;null===p$$.z&&(p$$.z=p$e.zOrder(p$$.x,p$$.y,p$q,p$f,p$g)),p$$.prevZ=p$$.prev,p$$.nextZ=p$$.next,(p$$=p$$.next)!==p$h;);p$$.prevZ.nextZ=null,p$$.prevZ=null,p$e.sortLinked(p$$)},p$e.sortLinked=function(p$h){var p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y=1;do{for(p$f=p$h,p$P=p$h=null,p$S=0;p$f;){for(p$S++,p$g=p$f,p$q=p$B=0;p$q<p$Y&&(p$B++,p$g=p$g.nextZ);p$q++);for(p$r=p$Y;0<p$B||0<p$r&&p$g;)0!==p$B&&(0===p$r||!p$g||p$f.z<=p$g.z)?(p$f=(p$$=p$f).nextZ,p$B--):(p$g=(p$$=p$g).nextZ,p$r--),p$P?p$P.nextZ=p$$:p$h=p$$,p$$.prevZ=p$P,p$P=p$$;p$f=p$g}p$P.nextZ=null,p$Y*=2}while(1<p$S);return p$h},p$e.zOrder=function(p$h,p$q,p$f,p$g,p$$){return(p$h=1431655765&((p$h=858993459&((p$h=252645135&((p$h=16711935&((p$h=32767*(p$h-p$f)*p$$)|p$h<<8))|p$h<<4))|p$h<<2))|p$h<<1))|(p$q=1431655765&((p$q=858993459&((p$q=252645135&((p$q=16711935&((p$q=32767*(p$q-p$g)*p$$)|p$q<<8))|p$q<<4))|p$q<<2))|p$q<<1))<<1},p$e.getLeftmost=function(p$h){for(var p$q=p$h,p$f=p$h;p$q.x<p$f.x&&(p$f=p$q),(p$q=p$q.next)!==p$h;);return p$f},p$e.pointInTriangle=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){return 0<=(p$$-p$S)*(p$q-p$B)-(p$h-p$S)*(p$P-p$B)&&0<=(p$h-p$S)*(p$g-p$B)-(p$f-p$S)*(p$q-p$B)&&0<=(p$f-p$S)*(p$P-p$B)-(p$$-p$S)*(p$g-p$B)},p$e.isValidDiagonal=function(p$h,p$q){return p$h.next.i!==p$q.i&&p$h.prev.i!==p$q.i&&!p$e.intersectsPolygon(p$h,p$q)&&p$e.locallyInside(p$h,p$q)&&p$e.locallyInside(p$q,p$h)&&p$e.middleInside(p$h,p$q)},p$e.area=function(p$h,p$q,p$f){return(p$q.y-p$h.y)*(p$f.x-p$q.x)-(p$q.x-p$h.x)*(p$f.y-p$q.y)},p$e.equals=function(p$h,p$q){return p$h.x===p$q.x&&p$h.y===p$q.y},p$e.intersects=function(p$h,p$q,p$f,p$g){return!!(p$e.equals(p$h,p$q)&&p$e.equals(p$f,p$g)||p$e.equals(p$h,p$g)&&p$e.equals(p$f,p$q))||0<p$e.area(p$h,p$q,p$f)!=0<p$e.area(p$h,p$q,p$g)&&0<p$e.area(p$f,p$g,p$h)!=0<p$e.area(p$f,p$g,p$q)},p$e.intersectsPolygon=function(p$h,p$q){var p$f=p$h;do{if(p$f.i!==p$h.i&&p$f.next.i!==p$h.i&&p$f.i!==p$q.i&&p$f.next.i!==p$q.i&&p$e.intersects(p$f,p$f.next,p$h,p$q))return!0;p$f=p$f.next}while(p$f!==p$h);return!1},p$e.locallyInside=function(p$h,p$q){return p$e.area(p$h.prev,p$h,p$h.next)<0?0<=p$e.area(p$h,p$q,p$h.next)&&0<=p$e.area(p$h,p$h.prev,p$q):p$e.area(p$h,p$q,p$h.prev)<0||p$e.area(p$h,p$h.next,p$q)<0},p$e.middleInside=function(p$h,p$q){for(var p$f=p$h,p$g=!1,p$$=(p$h.x+p$q.x)/2,p$P=(p$h.y+p$q.y)/2;p$f.y>p$P!=p$f.next.y>p$P&&p$f.next.y!==p$f.y&&p$$<(p$f.next.x-p$f.x)*(p$P-p$f.y)/(p$f.next.y-p$f.y)+p$f.x&&(p$g=!p$g),(p$f=p$f.next)!==p$h;);return p$g},p$e.splitPolygon=function(p$h,p$q){var p$f=new p$$h(p$h.i,p$h.x,p$h.y),p$g=new p$$h(p$q.i,p$q.x,p$q.y),p$$=p$h.next,p$P=p$q.prev;return(p$h.next=p$q).prev=p$h,(p$f.next=p$$).prev=p$f,(p$g.next=p$f).prev=p$g,(p$P.next=p$g).prev=p$P,p$g},p$e.insertNode=function(p$h,p$q,p$f,p$g){var p$$=new p$$h(p$h,p$q,p$f);return p$g?(p$$.next=p$g.next,(p$$.prev=p$g).next.prev=p$$,p$g.next=p$$):(p$$.prev=p$$).next=p$$,p$$},p$e.removeNode=function(p$h){p$h.next.prev=p$h.prev,p$h.prev.next=p$h.next,p$h.prevZ&&(p$h.prevZ.nextZ=p$h.nextZ),p$h.nextZ&&(p$h.nextZ.prevZ=p$h.prevZ)},p$e.signedArea=function(p$h,p$q,p$f,p$g){for(var p$$=0,p$P=p$q,p$S=p$f-p$g;p$P<p$f;p$P+=p$g)p$$+=(p$h[p$S]-p$h[p$P])*(p$h[p$P+1]+p$h[p$S+1]),p$S=p$P;return p$$},p$e}(),p$$h=function(){function p$h(p$h,p$q,p$f){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=p$h,this.x=p$q,this.y=p$f,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return p$u(p$h,"laya.webgl.shapes.EarcutNode"),p$h}(),p$Ph=(function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this.lineWidth=p$h,this.lineColor=p$q,this.lineAlpha=p$f,this.fillColor=p$g,this.fillAlpha=p$$,this.shape=p$S,this.fill=p$P}p$u(p$h,"laya.webgl.shapes.GeometryData");var p$q=p$h.prototype;p$q.clone=function(){return new p$h(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},p$q.getIndexData=function(){return null},p$q.getVertexData=function(){return null},p$q.destroy=function(){this.shape=null}}(),function(){function p$h(p$h){if(p$h instanceof Float32Array)this.points=p$h;else if(p$h instanceof Array){p$h.length;this.points=new Float32Array(p$h)}}p$u(p$h,"laya.webgl.shapes.Vertex");var p$q=p$h.prototype;p$R.imps(p$q,{"laya.webgl.shapes.IShape":!0}),p$q.getData=function(p$h,p$q,p$f){},p$q.needUpdate=function(p$h){return!1},p$q.rebuild=function(p$h){},p$q.setMatrix=function(p$h){}}(),function(){function p$r(p$h){void 0===p$h&&(p$h=1e4),this._renderType=p$h}p$u(p$r,"laya.webgl.submit.Submit");var p$h=p$r.prototype;return p$R.imps(p$h,{"laya.webgl.submit.ISubmit":!0}),p$h.releaseRender=function(){var p$h=p$r._cache;(p$h[p$h._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},p$h.getRenderType=function(){return this._renderType},p$h.renderSubmit=function(){if(0===this._numEle)return 1;var p$h=this.shaderValue.textureHost;if(p$h){var p$q=p$h.source;if(!p$h.bitmap||!p$q)return 1;this.shaderValue.texture=p$q,p$h.alphaTexture&&p$h.alphaTexture.source&&(this.shaderValue.texture1=p$h.alphaTexture.source)}this._vb.bind_upload(this._ib);var p$f=p$mh.mainContext;return this.shaderValue.upload(),p$s.activeBlendFunction!==this._blendFn&&(p$f.enable(3042),this._blendFn(p$f),p$s.activeBlendFunction=this._blendFn),p$b.drawCall++,p$b.trianglesFaces+=this._numEle/3,p$f.drawElements(4,this._numEle,5123,this._startIdx),1},p$r.__init__=function(){var p$h=p$r.RENDERBASE=new p$r(-1);p$h.shaderValue=new p$Xh(0,0),p$h.shaderValue.ALPHA=-1234},p$r.createSubmit=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$r._cache._length?p$r._cache[--p$r._cache._length]:new p$r;null==p$f&&((p$f=p$P._selfVb||(p$P._selfVb=p$ah.create(-1))).clear(),p$g=0),p$P._ib=p$q,p$P._vb=p$f,p$P._startIdx=p$g*p$eh.BYTES_PIDX,p$P._numEle=0;var p$S=p$h._nBlendType;p$P._blendFn=p$h._targets?p$s.targetFns[p$S]:p$s.fns[p$S],p$P.shaderValue=p$$,p$P.shaderValue.setValue(p$h._shader2D);var p$B=p$h._shader2D.filters;return p$B&&p$P.shaderValue.setFilters(p$B),p$P},p$r.createShape=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$r._cache._length?p$r._cache[--p$r._cache._length]:new p$r;p$S._ib=p$q,p$S._vb=p$f,p$S._numEle=p$g,p$S._startIdx=p$$,p$S.shaderValue=p$P,p$S.shaderValue.setValue(p$h._shader2D);var p$B=p$h._nBlendType;return p$S._blendFn=p$h._targets?p$s.targetFns[p$B]:p$s.fns[p$B],p$S},p$r.TYPE_2D=1e4,p$r.TYPE_CANVAS=10003,p$r.TYPE_CMDSETRT=10004,p$r.TYPE_CUSTOM=10005,p$r.TYPE_BLURRT=10006,p$r.TYPE_CMDDESTORYPRERT=10007,p$r.TYPE_DISABLESTENCIL=10008,p$r.TYPE_OTHERIBVB=10009,p$r.TYPE_PRIMITIVE=10010,p$r.TYPE_RT=10011,p$r.TYPE_BLUR_RT=10012,p$r.TYPE_TARGET=10013,p$r.TYPE_CHANGE_VALUE=10014,p$r.TYPE_SHAPE=10015,p$r.TYPE_TEXTURE=10016,p$r.TYPE_FILLTEXTURE=10017,p$r.RENDERBASE=null,p$r._cache=((p$r._cache=[])._length=0,p$r._cache),p$r}()),p$Sh=function(){function p$g(){this.fun=null,this.args=null}p$u(p$g,"laya.webgl.submit.SubmitCMD");var p$h=p$g.prototype;return p$R.imps(p$h,{"laya.webgl.submit.ISubmit":!0}),p$h.renderSubmit=function(){return this.fun.apply(null,this.args),1},p$h.getRenderType=function(){return 0},p$h.releaseRender=function(){var p$h=p$g._cache;p$h[p$h._length++]=this},p$g.create=function(p$h,p$q){var p$f=p$g._cache._length?p$g._cache[--p$g._cache._length]:new p$g;return p$f.fun=p$q,p$f.args=p$h,p$f},p$g._cache=((p$g._cache=[])._length=0,p$g._cache),p$g}(),p$Bh=function(){function p$q(){this.variables={}}p$u(p$q,"laya.webgl.submit.SubmitCMDScope");var p$h=p$q.prototype;return p$h.getValue=function(p$h){return this.variables[p$h]},p$h.addValue=function(p$h,p$q){return this.variables[p$h]=p$q},p$h.setValue=function(p$h,p$q){return this.variables.hasOwnProperty(p$h)?this.variables[p$h]=p$q:null},p$h.clear=function(){for(var p$h in this.variables)delete this.variables[p$h]},p$h.recycle=function(){this.clear(),p$q.POOL.push(this)},p$q.create=function(){var p$h=p$q.POOL.pop();return p$h||(p$h=new p$q),p$h},p$q.POOL=[],p$q}(),p$rh=function(){function p$U(){this.offset=0,this.startIndex=0,this._mat=p$n.create()}p$u(p$U,"laya.webgl.submit.SubmitOtherIBVB");var p$h=p$U.prototype;return p$R.imps(p$h,{"laya.webgl.submit.ISubmit":!0}),p$h.releaseRender=function(){var p$h=p$U._cache;(p$h[p$h._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},p$h.getRenderType=function(){return 10009},p$h.renderSubmit=function(){var p$h=this._shaderValue.textureHost;if(p$h){var p$q=p$h.source;if(!p$h.bitmap||!p$q)return 1;this._shaderValue.texture=p$q}this._vb.bind_upload(this._ib);var p$f=p$Nh.worldMatrix4,p$g=p$n.TEMP;p$n.mulPre(this._mat,p$f[0],p$f[1],p$f[4],p$f[5],p$f[12],p$f[13],p$g);var p$$=p$Nh.worldMatrix4=p$U.tempMatrix4;p$$[0]=p$g.a,p$$[1]=p$g.b,p$$[4]=p$g.c,p$$[5]=p$g.d,p$$[12]=p$g.tx,p$$[13]=p$g.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var p$P=p$mh.mainContext;return p$s.activeBlendFunction!==this._blendFn&&(p$P.enable(3042),this._blendFn(p$P),p$s.activeBlendFunction=this._blendFn),p$b.drawCall++,p$b.trianglesFaces+=this._numEle/3,p$P.drawElements(4,this._numEle,5123,this.startIndex),p$Nh.worldMatrix4=p$f,p$Wh.activeShader=null,1},p$U.create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){void 0===p$r&&(p$r=0);var p$Y=p$U._cache._length?p$U._cache[--p$U._cache._length]:new p$U;p$Y._ib=p$f,p$Y._vb=p$q,p$Y._numEle=p$g,p$Y._shader=p$$,p$Y._shaderValue=p$P;var p$C=p$h._nBlendType;switch(p$Y._blendFn=p$h._targets?p$s.targetFns[p$C]:p$s.fns[p$C],p$r){case 0:p$Y.offset=0,p$Y.startIndex=p$B/(p$eh.BYTES_PE*p$q.vertexStride)*1.5,p$Y.startIndex*=p$eh.BYTES_PIDX;break;case 1:p$Y.startIndex=p$S,p$Y.offset=p$B}return p$Y},p$U._cache=((p$U._cache=[])._length=0,p$U._cache),p$U.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p$U}(),p$Yh=function(){function p$f(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new p$p,this.screenRect=new p$p}p$u(p$f,"laya.webgl.submit.SubmitScissor");var p$h=p$f.prototype;return p$R.imps(p$h,{"laya.webgl.submit.ISubmit":!0}),p$h._scissor=function(p$h,p$q,p$f,p$g){var p$$=p$Nh.worldMatrix4,p$P=p$$[0],p$S=p$$[5],p$B=p$$[12],p$r=p$$[13];if(p$g*=p$S,(p$f*=p$P)<1||p$g<1)return!1;var p$Y=(p$h=p$h*p$P+p$B)+p$f,p$C=(p$q=p$q*p$S+p$r)+p$g;p$h<0&&(p$f=p$Y-(p$h=0)),p$q<0&&(p$g=p$C-(p$q=0));var p$U=p$Nh.worldClipRect;if(p$h=Math.max(p$h,p$U.x),p$q=Math.max(p$q,p$U.y),p$f=Math.min(p$Y,p$U.right)-p$h,p$g=Math.min(p$C,p$U.bottom)-p$q,p$f<1||p$g<1)return!1;var p$u=p$Nh.worldScissorTest;return this.screenRect.copyFrom(p$U),p$U.x=p$h,p$U.y=p$q,p$U.width=p$f,p$U.height=p$g,p$Nh.worldScissorTest=!0,p$q=p$Nh.height-p$q-p$g,p$mh.mainContext.scissor(p$h,p$q,p$f,p$g),p$mh.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),p$u?(p$q=p$Nh.height-this.screenRect.y-this.screenRect.height,p$mh.mainContext.scissor(this.screenRect.x,p$q,this.screenRect.width,this.screenRect.height),p$mh.mainContext.enable(3089)):(p$mh.mainContext.disable(3089),p$Nh.worldScissorTest=!1),p$U.copyFrom(this.screenRect),!0},p$h._scissorWithTagart=function(p$h,p$q,p$f,p$g){if(p$f<1||p$g<1)return!1;var p$$=p$h+p$f,p$P=p$q+p$g;p$h<0&&(p$f=p$$-(p$h=0)),p$q<0&&(p$g=p$P-(p$q=0));var p$S=p$Nh.worldClipRect;if(p$h=Math.max(p$h,p$S.x),p$q=Math.max(p$q,p$S.y),p$f=Math.min(p$$,p$S.right)-p$h,p$g=Math.min(p$P,p$S.bottom)-p$q,p$f<1||p$g<1)return!1;var p$B=p$Nh.worldScissorTest;return this.screenRect.copyFrom(p$S),p$Nh.worldScissorTest=!0,p$S.x=p$h,p$S.y=p$q,p$S.width=p$f,p$S.height=p$g,p$q=p$Nh.height-p$q-p$g,p$mh.mainContext.scissor(p$h,p$q,p$f,p$g),p$mh.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),p$B?(p$q=p$Nh.height-this.screenRect.y-this.screenRect.height,p$mh.mainContext.scissor(this.screenRect.x,p$q,this.screenRect.width,this.screenRect.height),p$mh.mainContext.enable(3089)):(p$mh.mainContext.disable(3089),p$Nh.worldScissorTest=!1),p$S.copyFrom(this.screenRect),!0},p$h.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},p$h.getRenderType=function(){return 0},p$h.releaseRender=function(){var p$h=p$f._cache;(p$h[p$h._length++]=this).context=null},p$f.create=function(p$h){var p$q=p$f._cache._length?p$f._cache[--p$f._cache._length]:new p$f;return p$q.context=p$h,p$q},p$f._cache=((p$f._cache=[])._length=0,p$f._cache),p$f}(),p$Ch=function(){function p$r(){this.step=0,this.blendMode=null,this.level=0}p$u(p$r,"laya.webgl.submit.SubmitStencil");var p$h=p$r.prototype;return p$R.imps(p$h,{"laya.webgl.submit.ISubmit":!0}),p$h.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},p$h.getRenderType=function(){return 0},p$h.releaseRender=function(){var p$h=p$r._cache;p$h[p$h._length++]=this},p$h.do1=function(){var p$h=p$mh.mainContext;p$h.enable(2960),p$h.clear(1024),p$h.colorMask(!1,!1,!1,!1),p$h.stencilFunc(514,this.level,255),p$h.stencilOp(7680,7680,7682)},p$h.do2=function(){var p$h=p$mh.mainContext;p$h.stencilFunc(514,this.level+1,255),p$h.colorMask(!0,!0,!0,!0),p$h.stencilOp(7680,7680,7680)},p$h.do3=function(){var p$h=p$mh.mainContext;p$h.colorMask(!0,!0,!0,!0),p$h.stencilOp(7680,7680,7680),p$h.clear(1024),p$h.disable(2960)},p$h.do4=function(){var p$h=p$mh.mainContext;0==this.level&&(p$h.enable(2960),p$h.clear(1024)),p$h.colorMask(!1,!1,!1,!1),p$h.stencilFunc(519,0,255),p$h.stencilOp(7680,7680,7682)},p$h.do5=function(){var p$h=p$mh.mainContext;p$h.stencilFunc(514,this.level,255),p$h.colorMask(!0,!0,!0,!0),p$h.stencilOp(7680,7680,7680)},p$h.do6=function(){var p$h=p$mh.mainContext;p$s.targetFns[p$s.TOINT[this.blendMode]](p$h)},p$h.do7=function(){var p$h=p$mh.mainContext;p$h.colorMask(!1,!1,!1,!1),p$h.stencilOp(7680,7680,7683)},p$h.do8=function(){var p$h=p$mh.mainContext;p$h.colorMask(!0,!0,!0,!0),p$h.stencilFunc(514,this.level,255),p$h.stencilOp(7680,7680,7680)},p$r.restore=function(p$h,p$q,p$f,p$g,p$$){var p$P;if((p$h._renderKey=0)<p$r._mask&&p$r._mask--,0==p$r._mask)p$P=laya.webgl.submit.SubmitStencil.create(3),p$h.addRenderObject(p$P),p$h._curSubmit=p$Ph.RENDERBASE;else{p$P=laya.webgl.submit.SubmitStencil.create(7),p$h.addRenderObject(p$P);var p$S=p$h._vb;p$S._byteLength;if(p$lh.fillRectImgVb(p$S,null,p$q.x,p$q.y,p$q.width,p$q.height,p$M.DEF_UV,p$f,p$g,p$$,0,0)){p$h._shader2D.glTexture=null;var p$B=p$h._curSubmit=p$Ph.createSubmit(p$h,p$h._ib,p$S,(p$S._byteLength-64)/32*3,p$Xh.create(2,0));p$B.shaderValue.ALPHA=1,p$h._submits[p$h._submits._length++]=p$B,p$h._curSubmit._numEle+=6,p$h._curSubmit=p$Ph.RENDERBASE}else alert("clipRect calc stencil rect error");p$P=laya.webgl.submit.SubmitStencil.create(8),p$h.addRenderObject(p$P)}},p$r.restore2=function(p$h,p$q){var p$f;(p$h._renderKey=0)<p$r._mask&&p$r._mask--,0==p$r._mask?(p$f=laya.webgl.submit.SubmitStencil.create(3),p$h.addRenderObject(p$f),p$h._curSubmit=p$Ph.RENDERBASE):(p$f=laya.webgl.submit.SubmitStencil.create(7),p$h.addRenderObject(p$f),p$h._submits[p$h._submits._length++]=p$q,p$f=laya.webgl.submit.SubmitStencil.create(8),p$h.addRenderObject(p$f))},p$r.create=function(p$h){var p$q=p$r._cache._length?p$r._cache[--p$r._cache._length]:new p$r;return 5==(p$q.step=p$h)&&++p$r._mask,p$q.level=p$r._mask,p$q},p$r._cache=((p$r._cache=[])._length=0,p$r._cache),p$r._mask=0,p$r}(),p$Uh=function(){function p$B(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}p$u(p$B,"laya.webgl.submit.SubmitTarget");var p$h=p$B.prototype;return p$R.imps(p$h,{"laya.webgl.submit.ISubmit":!0}),p$h.renderSubmit=function(){this._vb.bind_upload(this._ib);var p$h=this.scope.getValue(this.proName);return p$h&&(this.shaderValue.texture=p$h.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[p$h.width,p$h.height]),this.shaderValue.upload(),this.blend(),p$b.drawCall++,p$b.trianglesFaces+=this._numEle/3,p$mh.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},p$h.blend=function(){if(p$s.activeBlendFunction!==p$s.fns[this.blendType]){var p$h=p$mh.mainContext;p$h.enable(3042),p$s.fns[this.blendType](p$h),p$s.activeBlendFunction=p$s.fns[this.blendType]}},p$h.getRenderType=function(){return 0},p$h.releaseRender=function(){var p$h=p$B._cache;(p$h[p$h._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},p$B.create=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$B._cache._length?p$B._cache[--p$B._cache._length]:new p$B;return p$S._ib=p$q,p$S._vb=p$f,p$S.proName=p$P,p$S._startIdx=p$g*p$eh.BYTES_PIDX,p$S._numEle=0,p$S.blendType=p$h._nBlendType,p$S.shaderValue=p$$,p$S.shaderValue.setValue(p$h._shader2D),p$S},p$B._cache=((p$B._cache=[])._length=0,p$B._cache),p$B}(),p$uh=function(){function p$h(){this._sourceStr=null}p$u(p$h,"laya.webgl.text.CharSegment");var p$q=p$h.prototype;return p$R.imps(p$q,{"laya.webgl.text.ICharSegment":!0}),p$q.textToSpit=function(p$h){this._sourceStr=p$h},p$q.getChar=function(p$h){return this._sourceStr.charAt(p$h)},p$q.getCharCode=function(p$h){return this._sourceStr.charCodeAt(p$h)},p$q.length=function(){return this._sourceStr.length},p$h}(),p$vh=function(){var p$h;function p$b(){}return p$u(p$b,"laya.webgl.text.DrawText"),p$b.__init__=function(){p$b._charsTemp=new Array,p$b._drawValue=new p$h,p$b._charSeg=new p$uh},p$b.customCharSeg=function(p$h){p$b._charSeg=p$h},p$b.getChar=function(p$h,p$q,p$f){var p$g=p$yh.createOneChar(p$h,p$f);return-1!=p$q&&(p$b._charsCache[p$q]=p$g),p$g},p$b._drawSlow=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U,p$u,p$v,p$L){var p$e,p$l,p$_=p$b._drawValue.value(p$P,p$B,p$r,p$Y,p$u,p$v,p$L),p$N=0,p$G=0,p$m=p$b._charsTemp,p$E=0,p$R=NaN;if(p$g)for(p$m.length=p$g.length,p$N=0,p$G=p$g.length;p$N<p$G;p$N++)(p$l=p$g[p$N])&&(p$R=p$l.charNum+p$_.txtID,p$m[p$N]=p$e=p$b._charsCache[p$R]||p$b.getChar(p$l.char,p$R,p$_),p$e.active());else{var p$t=p$f instanceof laya.utils.WordText?p$f.toString():p$f;if(p$c.CharacterCache){p$b._charSeg.textToSpit(p$t);var p$X=p$b._charSeg.length();for(p$N=0,p$G=p$m.length=p$X;p$N<p$G;p$N++)p$R=p$b._charSeg.getCharCode(p$N)+p$_.txtID,p$m[p$N]=p$e=p$b._charsCache[p$R]||p$b.getChar(p$b._charSeg.getChar(p$N),p$R,p$_),p$e.active(),p$E+=p$e.cw}else p$m.length=0,(p$e=p$b.getChar(p$t,-1,p$_)).active(),p$E+=p$e.cw,p$m[0]=p$e}var p$n=0;null!==p$S&&"left"!==p$S&&(p$n=-("center"==p$S?p$E/2:p$E));var p$J,p$p,p$A=NaN,p$d=0;if(p$g)for(p$N=0,p$G=p$m.length;p$N<p$G;p$N++)p$e=p$m[p$N],p$l=p$g[p$N],p$e&&p$l&&!p$e.isSpace&&(p$A=p$e.borderSize,p$J=p$e.texture,p$q._drawText(p$J,p$C+p$n+p$l.x*p$u-p$A,p$U+p$l.y*p$v-p$A,p$J.width,p$J.height,p$$,0,0,0,0));else{for(p$N=0,p$G=p$m.length;p$N<p$G;p$N++)(p$e=p$m[p$N])&&!p$e.isSpace&&(p$A=p$e.borderSize,p$J=p$e.texture,p$q._drawText(p$J,p$C+p$n-p$A,p$U-p$A,p$J.width,p$J.height,p$$,0,0,0,0),p$h&&((p$p=p$h[p$d++])||(p$p=p$h[p$d-1]=[]),p$p[0]=p$J,p$p[1]=p$n-p$A,p$p[2]=-p$A)),p$n+=p$e.cw;p$h&&(p$h.length=p$d)}},p$b._drawFast=function(p$h,p$q,p$f,p$g,p$$){for(var p$P,p$S,p$B=0,p$r=p$h.length;p$B<p$r;p$B++)(p$P=(p$S=p$h[p$B])[0]).active(),p$q._drawText(p$P,p$g+p$S[1],p$$+p$S[2],p$P.width,p$P.height,p$f,0,0,0,0)},p$b.drawText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U){if(void 0===p$U&&(p$U=0),!(p$q&&0===p$q.length||p$f&&0===p$f.length)){var p$u=p$g.a,p$v=p$g.d;(0!==p$g.b||0!==p$g.c)&&(p$u=p$v=1);var p$L=1!==p$u||1!==p$v;if(p$L&&p$R.stage.transform){var p$e=p$R.stage.transform;p$L=p$e.a===p$u&&p$e.d===p$v}else p$L=!1;if(p$L){var p$l=(p$g=p$g.copyTo(p$th._tmpMatrix)).tx,p$_=p$g.ty;p$g.scale(1/p$u,1/p$v),p$g._checkTransform(),p$Y*=p$u,p$C*=p$v,p$Y+=p$l-p$g.tx,p$C+=p$_-p$g.ty}else p$u=p$v=1;if(p$f)p$b._drawSlow(null,p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$u,p$v,p$U);else{if(null===p$q.toUpperCase){var p$N=p$u+1e5*p$v,p$G=p$q;return void(p$G.changed||p$G.id!==p$N?(p$G.id=p$N,p$G.changed=!1,p$b._drawSlow(p$G.save,p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$u,p$v,p$U)):p$b._drawFast(p$G.save,p$h,p$g,p$Y,p$C))}var p$m=p$q+p$$.toString()+p$S+p$B+p$r+p$u+p$v+p$P,p$E=p$b._textsCache[p$m];p$c.CharacterCache?p$E?p$b._drawFast(p$E,p$h,p$g,p$Y,p$C):(p$b._textsCache.__length||(p$b._textsCache.__length=0),p$b._textsCache.__length>p$t.WebGLTextCacheCount&&((p$b._textsCache={}).__length=0,p$b._curPoolIndex=0),p$b._textCachesPool[p$b._curPoolIndex]?(p$E=p$b._textsCache[p$m]=p$b._textCachesPool[p$b._curPoolIndex]).length=0:p$b._textCachesPool[p$b._curPoolIndex]=p$E=p$b._textsCache[p$m]=[],p$b._textsCache.__length++,p$b._curPoolIndex++,p$b._drawSlow(p$E,p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$u,p$v,p$U)):p$b._drawSlow(p$E,p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$u,p$v,p$U)}}},p$b._charsTemp=null,p$b._textCachesPool=[],p$b._curPoolIndex=0,p$b._charsCache={},p$b._textsCache={},p$b._drawValue=null,p$b.d=[],p$b._charSeg=null,p$b.__init$=function(){p$h=function(){function p$r(){}return p$u(p$r,""),p$r.prototype.value=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this.font=p$h,this.fillColor=p$q,this.borderColor=p$f,this.lineWidth=p$g,this.scaleX=p$$,this.scaleY=p$P,this.underLine=p$S;var p$B=p$h.toString()+p$$+p$P+p$g+(p$q?p$q.toLowerCase():" ")+(p$f?p$f.toLowerCase():" ")+p$S;return this.txtID=p$r._keymap[p$B],this.txtID||(this.txtID=1e-7*++p$r._keymapCount,p$r._keymap[p$B]=this.txtID),this},p$r.clear=function(){p$r._keymap={},p$r._keymapCount=1},p$r._keymap={},p$r._keymapCount=1,p$r}()},p$b}(),p$Lh=function(){function p$$(p$h){this._index=0,this._size=14,this._italic=-2,p$$._cache2=p$$._cache2||[],this.setFont(p$h||"14px Arial")}p$u(p$$,"laya.webgl.text.FontInContext");var p$h=p$$.prototype;return p$h.setFont=function(p$h){var p$q=p$$._cache2[p$h];if(p$q)this._words=p$q[0],this._size=p$q[1];else{this._words=p$h.split(" ");for(var p$f=0,p$g=this._words.length;p$f<p$g;p$f++)if(0<this._words[p$f].indexOf("px")){this._index=p$f;break}this._size=parseInt(this._words[this._index]),p$$._cache2[p$h]=[this._words,this._size]}this._text=null,this._italic=-2},p$h.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},p$h.hasType=function(p$h){for(var p$q=0,p$f=this._words.length;p$q<p$f;p$q++)if(this._words[p$q]===p$h)return p$q;return-1},p$h.removeType=function(p$h){for(var p$q=0,p$f=this._words.length;p$q<p$f;p$q++)if(this._words[p$q]===p$h){this._words.splice(p$q,1),this._index>p$q&&this._index--;break}this._text=null,this._italic=-2},p$h.copyTo=function(p$h){return p$h._text=this._text,p$h._size=this._size,p$h._index=this._index,p$h._words=this._words.slice(),p$h._italic=-2,p$h},p$h.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},p$g(0,p$h,"size",function(){return this._size},function(p$h){this._size=p$h,this._words[this._index]=p$h+"px",this._text=null}),p$$.create=function(p$h){var p$q=p$$._cache[p$h];return p$q||(p$q=p$$._cache[p$h]=new p$$(p$h))},p$$.EMPTY=new p$$,p$$._cache={},p$$._cache2=null,p$$}(),p$eh=function(){function p$h(){}return p$u(p$h,"laya.webgl.utils.CONST3D2D"),p$h.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p$h.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],p$h.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],p$h._TMPARRAY=[],p$h._OFFSETX=0,p$h._OFFSETY=0,p$S(p$h,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),p$h}(),p$lh=function(){function p$L(){}return p$u(p$L,"laya.webgl.utils.GlUtils"),p$L.make2DProjection=function(p$h,p$q,p$f){return[2/p$h,0,0,0,0,-2/p$q,0,0,0,0,2/p$f,0,-1,1,0,1]},p$L.fillIBQuadrangle=function(p$h,p$q){if(65535/4<p$q)throw Error("IBQuadrangle count:"+p$q+" must<:"+Math.floor(65535/4));p$q=Math.floor(p$q),p$h._resizeBuffer(6*(p$q+1)*2,!1),p$h.byteLength=p$h.bufferLength;for(var p$f=p$h.getUint16Array(),p$g=0,p$$=0;p$$<p$q;p$$++)p$f[p$g++]=4*p$$,p$f[p$g++]=4*p$$+2,p$f[p$g++]=4*p$$+1,p$f[p$g++]=4*p$$,p$f[p$g++]=4*p$$+3,p$f[p$g++]=4*p$$+2;return p$h.setNeedUpload(),!0},p$L.expandIBQuadrangle=function(p$h,p$q){p$h.bufferLength>=6*p$q*2||p$L.fillIBQuadrangle(p$h,p$q)},p$L.mathCeilPowerOfTwo=function(p$h){return p$h--,p$h|=p$h>>1,p$h|=p$h>>2,p$h|=p$h>>4,p$h|=p$h>>8,p$h|=p$h>>16,++p$h},p$L.fillQuadrangleImgVb=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){var p$r=16+(p$h._byteLength>>2);p$h.byteLength=p$r<<2;var p$Y=p$h.getFloat32Array();p$Y[(p$r-=16)+2]=p$$[0],p$Y[p$r+3]=p$$[1],p$Y[p$r+6]=p$$[2],p$Y[p$r+7]=p$$[3],p$Y[p$r+10]=p$$[4],p$Y[p$r+11]=p$$[5],p$Y[p$r+14]=p$$[6],p$Y[p$r+15]=p$$[7];var p$C=p$P.a,p$U=p$P.b,p$u=p$P.c,p$v=p$P.d;if(1!==p$C||0!==p$U||0!==p$u||1!==p$v){p$P.bTransform=!0;var p$L=p$P.tx+p$S,p$e=p$P.ty+p$B;p$Y[p$r]=(p$g[0]+p$q)*p$C+(p$g[1]+p$f)*p$u+p$L,p$Y[p$r+1]=(p$g[0]+p$q)*p$U+(p$g[1]+p$f)*p$v+p$e,p$Y[p$r+4]=(p$g[2]+p$q)*p$C+(p$g[3]+p$f)*p$u+p$L,p$Y[p$r+5]=(p$g[2]+p$q)*p$U+(p$g[3]+p$f)*p$v+p$e,p$Y[p$r+8]=(p$g[4]+p$q)*p$C+(p$g[5]+p$f)*p$u+p$L,p$Y[p$r+9]=(p$g[4]+p$q)*p$U+(p$g[5]+p$f)*p$v+p$e,p$Y[p$r+12]=(p$g[6]+p$q)*p$C+(p$g[7]+p$f)*p$u+p$L,p$Y[p$r+13]=(p$g[6]+p$q)*p$U+(p$g[7]+p$f)*p$v+p$e}else p$P.bTransform=!1,p$q+=p$P.tx+p$S,p$f+=p$P.ty+p$B,p$Y[p$r]=p$q+p$g[0],p$Y[p$r+1]=p$f+p$g[1],p$Y[p$r+4]=p$q+p$g[2],p$Y[p$r+5]=p$f+p$g[3],p$Y[p$r+8]=p$q+p$g[4],p$Y[p$r+9]=p$f+p$g[5],p$Y[p$r+12]=p$q+p$g[6],p$Y[p$r+13]=p$f+p$g[7];return p$h._upload=!0},p$L.fillTranglesVB=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){var p$B=(p$h._byteLength>>2)+p$g.length;p$h.byteLength=p$B<<2;var p$r=p$h.getFloat32Array();p$B-=p$g.length;for(var p$Y=p$g.length,p$C=p$$.a,p$U=p$$.b,p$u=p$$.c,p$v=p$$.d,p$L=0;p$L<p$Y;p$L+=4)if(p$r[p$B+p$L+2]=p$g[p$L+2],p$r[p$B+p$L+3]=p$g[p$L+3],1!==p$C||0!==p$U||0!==p$u||1!==p$v){p$$.bTransform=!0;var p$e=p$$.tx+p$P,p$l=p$$.ty+p$S;p$r[p$B+p$L]=(p$g[p$L]+p$q)*p$C+(p$g[p$L+1]+p$f)*p$u+p$e,p$r[p$B+p$L+1]=(p$g[p$L]+p$q)*p$U+(p$g[p$L+1]+p$f)*p$v+p$l}else p$$.bTransform=!1,p$q+=p$$.tx+p$P,p$f+=p$$.ty+p$S,p$r[p$B+p$L]=p$q+p$g[p$L],p$r[p$B+p$L+1]=p$f+p$g[p$L+1];return p$h._upload=!0},p$L.copyPreImgVb=function(p$h,p$q,p$f){var p$g=p$h._byteLength>>2;p$h.byteLength=p$g+16<<2;for(var p$$=p$h.getFloat32Array(),p$P=0,p$S=p$g-16;p$P<4;p$P++)p$$[p$g]=p$$[p$S]+p$q,++p$S,p$$[++p$g]=p$$[p$S]+p$f,++p$S,p$$[++p$g]=p$$[p$S],++p$S,p$$[++p$g]=p$$[p$S],++p$g,++p$S;p$h._upload=!0},p$L.fillRectImgVb=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U,p$u){void 0===p$u&&(p$u=!1);var p$v,p$L,p$e,p$l,p$_,p$N,p$G,p$m,p$E,p$R,p$t,p$X,p$n,p$J,p$p,p$A,p$d=1,p$b=p$B.a,p$i=p$B.b,p$z=p$B.c,p$c=p$B.d,p$M=p$q&&p$q.width<99999999;if(1!==p$b||0!==p$i||0!==p$z||1!==p$c?(p$B.bTransform=!0,0===p$i&&0===p$z&&(p$d=23,p$E=p$$+p$f,p$R=p$P+p$g,p$v=p$b*p$f+(p$t=p$B.tx+p$r),p$e=p$b*p$E+p$t,p$L=p$c*p$g+(p$X=p$B.ty+p$Y),p$l=p$c*p$R+p$X)):(p$d=23,p$B.bTransform=!1,p$e=(p$v=p$f+p$B.tx+p$r)+p$$,p$l=(p$L=p$g+p$B.ty+p$Y)+p$P),p$M&&(p$_=p$q.x,p$N=p$q.y,p$G=p$q.width+p$_,p$m=p$q.height+p$N),1!==p$d){if(Math.min(p$v,p$e)>=p$G)return!1;if(Math.min(p$L,p$l)>=p$m)return!1;if(Math.max(p$e,p$v)<=p$_)return!1;if(Math.max(p$l,p$L)<=p$N)return!1}var p$W=p$h._byteLength>>2;p$h.byteLength=16+p$W<<2;var p$T=p$h.getFloat32Array();switch(p$T[2+p$W]=p$S[0],p$T[3+p$W]=p$S[1],p$T[6+p$W]=p$S[2],p$T[7+p$W]=p$S[3],p$T[10+p$W]=p$S[4],p$T[11+p$W]=p$S[5],p$T[14+p$W]=p$S[6],p$T[15+p$W]=p$S[7],p$d){case 1:p$t=p$B.tx+p$r,p$X=p$B.ty+p$Y;var p$I=p$b*p$f,p$w=p$z*p$g,p$k=p$c*p$g,p$H=p$i*p$f,p$D=p$b*(p$E=p$$+p$f),p$s=p$z*(p$R=p$P+p$g),p$V=p$c*p$R,p$K=p$i*p$E;p$u?(p$n=p$I+p$w+p$t,p$p=Math.round(p$n)-p$n,p$J=p$k+p$H+p$X,p$A=Math.round(p$J)-p$J,p$T[p$W]=p$n+p$p,p$T[1+p$W]=p$J+p$A,p$T[4+p$W]=p$D+p$w+p$t+p$p,p$T[5+p$W]=p$k+p$K+p$X+p$A,p$T[8+p$W]=p$D+p$s+p$t+p$p,p$T[9+p$W]=p$V+p$K+p$X+p$A,p$T[12+p$W]=p$I+p$s+p$t+p$p,p$T[13+p$W]=p$V+p$H+p$X+p$A):(p$T[p$W]=p$I+p$w+p$t,p$T[1+p$W]=p$k+p$H+p$X,p$T[4+p$W]=p$D+p$w+p$t,p$T[5+p$W]=p$k+p$K+p$X,p$T[8+p$W]=p$D+p$s+p$t,p$T[9+p$W]=p$V+p$K+p$X,p$T[12+p$W]=p$I+p$s+p$t,p$T[13+p$W]=p$V+p$H+p$X);break;case 23:p$u?(p$n=p$v+p$C,p$p=Math.round(p$n)-p$n,p$J=p$L,p$A=Math.round(p$J)-p$J,p$T[p$W]=p$n+p$p,p$T[1+p$W]=p$J+p$A,p$T[4+p$W]=p$e+p$C+p$p,p$T[5+p$W]=p$L+p$A,p$T[8+p$W]=p$e+p$p,p$T[9+p$W]=p$l+p$A,p$T[12+p$W]=p$v+p$p,p$T[13+p$W]=p$l+p$A):(p$T[p$W]=p$v+p$C,p$T[1+p$W]=p$L,p$T[4+p$W]=p$e+p$C,p$T[5+p$W]=p$L,p$T[8+p$W]=p$e,p$T[9+p$W]=p$l,p$T[12+p$W]=p$v,p$T[13+p$W]=p$l)}return p$h._upload=!0},p$L.fillLineVb=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){var p$r=.5*p$S,p$Y=p$L._fillLineArray,p$C=-(p$g-p$P),p$U=p$f-p$$,p$u=Math.sqrt(p$C*p$C+p$U*p$U);p$C/=p$u,p$U/=p$u,p$C*=p$r,p$U*=p$r,p$Y[0]=p$f-p$C,p$Y[1]=p$g-p$U,p$Y[4]=p$f+p$C,p$Y[5]=p$g+p$U,p$Y[8]=p$$+p$C,p$Y[9]=p$P+p$U,p$Y[12]=p$$-p$C,p$Y[13]=p$P-p$U,p$B&&p$B.transformPointArray(p$Y,p$Y);var p$v=16+(p$h._byteLength>>2);return p$h.byteLength=p$v<<2,p$h.insertData(p$Y,p$v-16),!0},p$L._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p$L}(),p$_h=(function(){function p$r(){}p$u(p$r,"laya.webgl.utils.MatirxArray"),p$r.ArrayMul=function(p$h,p$q,p$f){if(p$h)if(p$q)for(var p$g=NaN,p$$=NaN,p$P=NaN,p$S=NaN,p$B=0;p$B<4;p$B++)p$g=p$h[p$B],p$$=p$h[p$B+4],p$P=p$h[p$B+8],p$S=p$h[p$B+12],p$f[p$B]=p$g*p$q[0]+p$$*p$q[1]+p$P*p$q[2]+p$S*p$q[3],p$f[p$B+4]=p$g*p$q[4]+p$$*p$q[5]+p$P*p$q[6]+p$S*p$q[7],p$f[p$B+8]=p$g*p$q[8]+p$$*p$q[9]+p$P*p$q[10]+p$S*p$q[11],p$f[p$B+12]=p$g*p$q[12]+p$$*p$q[13]+p$P*p$q[14]+p$S*p$q[15];else p$r.copyArray(p$h,p$f);else p$r.copyArray(p$q,p$f)},p$r.copyArray=function(p$h,p$q){if(p$h&&p$q)for(var p$f=0;p$f<p$h.length;p$f++)p$q[p$f]=p$h[p$f]}}(),function(){function p$q(p$h,p$q,p$f){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=p$h,this._vb=new p$ah(p$h,35048),p$q&&this._vb._resizeBuffer(p$q,!1),this._ib=new p$xh,p$f&&this._ib._resizeBuffer(p$f,!1)}p$u(p$q,"laya.webgl.utils.Mesh2D");var p$h=p$q.prototype;return p$h.cloneWithNewVB=function(){var p$h=new p$q(this._stride,0,0);return p$h._ib=this._ib,p$h._quadNum=this._quadNum,p$h._attribInfo=this._attribInfo,p$h},p$h.cloneWithNewVBIB=function(){var p$h=new p$q(this._stride,0,0);return p$h._attribInfo=this._attribInfo,p$h},p$h.getVBW=function(){return this._vb.setNeedUpload(),this._vb},p$h.getVBR=function(){return this._vb},p$h.getIBR=function(){return this._ib},p$h.getIBW=function(){return this._ib.setNeedUpload(),this._ib},p$h.createQuadIB=function(p$h){this._quadNum=p$h,this._ib._resizeBuffer(6*p$h*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var p$q=this._ib.getUint16Array(),p$f=0,p$g=0,p$$=0;p$$<p$h;p$$++)p$q[p$f++]=p$g,p$q[p$f++]=p$g+2,p$q[p$f++]=p$g+1,p$q[p$f++]=p$g,p$q[p$f++]=p$g+3,p$q[p$f++]=p$g+2,p$g+=4;this._ib.setNeedUpload()},p$h.setAttributes=function(p$h){if(this._attribInfo=p$h,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},p$h.getEleNum=function(){return this._ib.getBuffer().byteLength/2},p$h.releaseMesh=function(){},p$h.destroy=function(){},p$h.clearVB=function(){this._vb.clear()},p$q._gvaoid=0,p$q}()),p$Nh=function(){function p$$(){}return p$u(p$$,"laya.webgl.utils.RenderState2D"),p$$.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},p$$.mat2MatArray=function(p$h,p$q){var p$f=p$h,p$g=p$q;return p$g[0]=p$f.a,p$g[1]=p$f.b,p$g[2]=p$$.EMPTYMAT4_ARRAY[2],p$g[3]=p$$.EMPTYMAT4_ARRAY[3],p$g[4]=p$f.c,p$g[5]=p$f.d,p$g[6]=p$$.EMPTYMAT4_ARRAY[6],p$g[7]=p$$.EMPTYMAT4_ARRAY[7],p$g[8]=p$$.EMPTYMAT4_ARRAY[8],p$g[9]=p$$.EMPTYMAT4_ARRAY[9],p$g[10]=p$$.EMPTYMAT4_ARRAY[10],p$g[11]=p$$.EMPTYMAT4_ARRAY[11],p$g[12]=p$f.tx,p$g[13]=p$f.ty,p$g[14]=p$$.EMPTYMAT4_ARRAY[14],p$g[15]=p$$.EMPTYMAT4_ARRAY[15],p$q},p$$.restoreTempArray=function(){p$$.TEMPMAT4_ARRAY[0]=1,p$$.TEMPMAT4_ARRAY[1]=0,p$$.TEMPMAT4_ARRAY[4]=0,p$$.TEMPMAT4_ARRAY[5]=1,p$$.TEMPMAT4_ARRAY[12]=0,p$$.TEMPMAT4_ARRAY[13]=0},p$$.clear=function(){p$$.worldScissorTest=!1,p$$.worldShaderDefines=null,p$$.worldFilters=null,p$$.worldAlpha=1,p$$.worldClipRect.x=p$$.worldClipRect.y=0,p$$.worldClipRect.width=p$$.width,p$$.worldClipRect.height=p$$.height,p$$.curRenderTarget=null},p$$._MAXSIZE=99999999,p$$.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p$$.worldMatrix4=p$$.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p$$.worldAlpha=1,p$$.worldScissorTest=!1,p$$.worldFilters=null,p$$.worldShaderDefines=null,p$$.curRenderTarget=null,p$$.width=0,p$$.height=0,p$S(p$$,["worldMatrix",function(){return this.worldMatrix=new p$n},"worldClipRect",function(){return this.worldClipRect=new p$p(0,0,99999999,99999999)}]),p$$}(),p$Gh=function(){var p$N,p$f;function p$G(p$h,p$q,p$f,p$g,p$$){var p$P=this;function p$S(p$h){var p$q=[],p$f=new p$N(p$q);return p$P._compileToTree(p$f,p$h.split("\n"),0,p$q,p$$),p$f}var p$B=p$v.now();this._VS=p$S(p$q),this._PS=p$S(p$f),this._nameMap=p$g,2<p$v.now()-p$B&&console.log("ShaderCompile use time:"+(p$v.now()-p$B)+"  size:"+p$q.length+"/"+p$f.length)}p$u(p$G,"laya.webgl.utils.ShaderCompile");var p$h=p$G.prototype;return p$h._compileToTree=function(p$h,p$q,p$f,p$g,p$$){var p$P,p$S,p$B,p$r,p$Y,p$C,p$U,p$u=0,p$v=0,p$L=0,p$e=0;for(p$v=p$f;p$v<p$q.length;p$v++)if(!((p$B=p$q[p$v]).length<1)&&0!==(p$u=p$B.indexOf("//"))){if(0<=p$u&&(p$B=p$B.substr(0,p$u)),p$P=p$U||new p$N(p$g),p$U=null,p$P.text=p$B,p$P.noCompile=!0,0<=(p$u=p$B.indexOf("#"))){for(p$r="#",p$e=p$u+1,p$L=p$B.length;p$e<p$L;p$e++){var p$l=p$B.charAt(p$e);if(" "===p$l||"\t"===p$l||"\r"===p$l||"\n"===p$l||"?"===p$l)break;p$r+=p$l}switch(p$P.name=p$r){case"#ifdef":case"#ifndef":if(p$P.src=p$B,p$P.noCompile=null!=p$B.match(/[!&|()=<>]/),p$P.noCompile?console.log("function():Boolean{return "+p$B.substr(p$u+p$P.name.length)+"}"):(p$C=p$B.replace(/^\s*/,"").split(/\s+/),p$P.setCondition(p$C[1],"#ifdef"===p$r?1:2),p$P.text="//"+p$P.text),p$P.setParent(p$h),p$h=p$P,p$$)for(p$C=p$B.substr(p$e).split(p$G._splitToWordExps3),p$e=0;p$e<p$C.length;p$e++)(p$B=p$C[p$e]).length&&(p$$[p$B]=!0);continue;case"#if":if(p$P.src=p$B,p$P.noCompile=!0,p$P.setParent(p$h),p$h=p$P,p$$)for(p$C=p$B.substr(p$e).split(p$G._splitToWordExps3),p$e=0;p$e<p$C.length;p$e++)(p$B=p$C[p$e]).length&&"defined"!=p$B&&(p$$[p$B]=!0);continue;case"#else":p$P.src=p$B,p$S=(p$h=p$h.parent).childs[p$h.childs.length-1],p$P.noCompile=p$S.noCompile,p$P.noCompile||(p$P.condition=p$S.condition,p$P.conditionType=1==p$S.conditionType?2:1,p$P.text="//"+p$P.text+" "+p$S.text+" "+p$P.conditionType),p$P.setParent(p$h),p$h=p$P;continue;case"#endif":p$S=(p$h=p$h.parent).childs[p$h.childs.length-1],p$P.noCompile=p$S.noCompile,p$P.noCompile||(p$P.text="//"+p$P.text),p$P.setParent(p$h);continue;case"#include":p$C=p$G.splitToWords(p$B,null);var p$_=p$G.includes[p$C[1]];if(!p$_)throw"ShaderCompile error no this include file:"+p$C[1];if((p$u=p$C[0].indexOf("?"))<0){p$P.setParent(p$h),p$B=p$_.getWith("with"==p$C[2]?p$C[3]:null),this._compileToTree(p$P,p$B.split("\n"),0,p$g,p$$),p$P.text="";continue}p$P.setCondition(p$C[0].substr(p$u+1),1),p$P.text=p$_.getWith("with"==p$C[2]?p$C[3]:null);break;case"#import":p$Y=(p$C=p$G.splitToWords(p$B,null))[1],p$g.push({node:p$P,file:p$G.includes[p$Y],ofs:p$P.text.length});continue}}else{if((p$S=p$h.childs[p$h.childs.length-1])&&!p$S.name){0<p$g.length&&p$G.splitToWords(p$B,p$S),p$U=p$P,p$S.text+="\n"+p$B;continue}0<p$g.length&&p$G.splitToWords(p$B,p$P)}p$P.setParent(p$h)}},p$h.createShader=function(p$h,p$q,p$f){var p$g={},p$$="";if(p$h)for(var p$P in p$h)p$$+="#define "+p$P+"\n",p$g[p$P]=!0;var p$S=this._VS.toscript(p$g,[]),p$B=this._PS.toscript(p$g,[]);return(p$f||p$Qh.create)(p$$+p$S.join("\n"),p$$+p$B.join("\n"),p$q,this._nameMap)},p$G._parseOne=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S={type:p$G.shaderParamsMap[p$f[p$g+1]],name:p$f[p$g+2],size:isNaN(parseInt(p$f[p$g+3]))?1:parseInt(p$f[p$g+3])};return p$P&&("attribute"==p$$?p$h.push(p$S):p$q.push(p$S)),":"==p$f[p$g+3]&&(p$S.type=p$f[p$g+4],p$g+=2),p$g+=2},p$G.addInclude=function(p$h,p$q){if(!p$q||0===p$q.length)throw new Error("add shader include file err:"+p$h);if(p$G.includes[p$h])throw new Error("add shader include file err, has add:"+p$h);p$G.includes[p$h]=new p$f(p$q)},p$G.preGetParams=function(p$h,p$q){var p$f=[p$h,p$q],p$g={},p$$=[],p$P=[],p$S={},p$B=[];p$g.attributes=p$$,p$g.uniforms=p$P,p$g.defines=p$S;for(var p$r=0,p$Y=0,p$C=0;p$C<2;p$C++){p$f[p$C]=p$f[p$C].replace(p$G._removeAnnotation,"");var p$U,p$u=p$f[p$C].match(p$G._reg);for(p$r=0,p$Y=p$u.length;p$r<p$Y;p$r++){var p$v=p$u[p$r];if("attribute"==p$v||"uniform"==p$v)p$r=p$G._parseOne(p$$,p$P,p$u,p$r,p$v,!0);else{if("#define"==p$v){p$B[p$v=p$u[++p$r]]=1;continue}if("#ifdef"==p$v){p$S[p$U=p$u[++p$r]]=p$S[p$U]||[];for(p$r++;p$r<p$Y;p$r++)if("attribute"==(p$v=p$u[p$r])||"uniform"==p$v)p$r=p$G._parseOne(p$$,p$P,p$u,p$r,p$v,p$B[p$U]);else if("#else"==p$v)for(p$r++;p$r<p$Y;p$r++)if("attribute"==(p$v=p$u[p$r])||"uniform"==p$v)p$r=p$G._parseOne(p$$,p$P,p$u,p$r,p$v,!p$B[p$U]);else if("#endif"==p$v)break}}}}return p$g},p$G.splitToWords=function(p$h,p$q){for(var p$f,p$g,p$$=[],p$P=-1,p$S=0,p$B=p$h.length;p$S<p$B;p$S++)if(p$f=p$h.charAt(p$S),0<=" \t=+-*/&%!<>()'\",;".indexOf(p$f)){if(0<=p$P&&1<p$S-p$P&&(p$g=p$h.substr(p$P,p$S-p$P),p$$.push(p$g)),'"'==p$f||"'"==p$f){var p$r=p$h.indexOf(p$f,p$S+1);if(p$r<0)throw"Sharder err:"+p$h;p$$.push(p$h.substr(p$S+1,p$r-p$S-1)),p$S=p$r,p$P=-1;continue}"("==p$f&&p$q&&0<p$$.length&&(p$g=p$$[p$$.length-1]+";","vec4;main;".indexOf(p$g)<0&&(p$q.useFuns+=p$g)),p$P=-1}else p$P<0&&(p$P=p$S);return p$P<p$B&&1<p$B-p$P&&(p$g=p$h.substr(p$P,p$B-p$P),p$$.push(p$g)),p$$},p$G.IFDEF_NO=0,p$G.IFDEF_YES=1,p$G.IFDEF_ELSE=2,p$G.IFDEF_PARENT=3,p$G._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),p$G._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),p$G._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),p$G.includes={},p$S(p$G,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),p$G.__init$=function(){p$N=function(){function p$f(p$h){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=p$h}p$u(p$f,"");var p$h=p$f.prototype;return p$h.setParent=function(p$h){p$h.childs.push(this),this.z=p$h.z+1,this.parent=p$h},p$h.setCondition=function(p$h,p$q){p$h&&(this.conditionType=p$q,p$h=p$h.replace(/(\s*$)/g,""),this.condition=function(){return this[p$h]},this.condition.__condition=p$h)},p$h.toscript=function(p$h,p$q){return this._toscript(p$h,p$q,++p$f.__id)},p$h._toscript=function(p$g,p$$,p$P){if(this.childs.length<1&&!this.text)return p$$;p$$.length;if(this.condition){var p$h=!!this.condition.call(p$g);if(2===this.conditionType&&(p$h=!p$h),!p$h)return p$$}if(this.text&&p$$.push(this.text),0<this.childs.length&&this.childs.forEach(function(p$h,p$q,p$f){p$h._toscript(p$g,p$$,p$P)}),0<this.includefiles.length&&0<this.useFuns.length)for(var p$q,p$f=0,p$S=this.includefiles.length;p$f<p$S;p$f++)this.includefiles[p$f].curUseID!=p$P&&0<(p$q=this.includefiles[p$f].file.getFunsScript(this.useFuns)).length&&(this.includefiles[p$f].curUseID=p$P,p$$[0]=p$q+p$$[0]);return p$$},p$f.__id=1,p$f}(),p$f=function(){function p$h(p$h){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=p$h;for(var p$q=0,p$f=0,p$g=0;!((p$q=p$h.indexOf("#begin",p$q))<0);){for(p$g=p$q+5;!((p$g=p$h.indexOf("#end",p$g))<0)&&"i"===p$h.charAt(p$g+4);)p$g+=5;if(p$g<0)throw"add include err,no #end:"+p$h;p$f=p$h.indexOf("\n",p$q);var p$$=p$G.splitToWords(p$h.substr(p$q,p$f-p$q),null);"code"==p$$[1]?this.codes[p$$[2]]=p$h.substr(p$f+1,p$g-p$f-1):"function"==p$$[1]&&(p$f=p$h.indexOf("function",p$q),p$f+="function".length,this.funs[p$$[3]]=p$h.substr(p$f+1,p$g-p$f-1),this.funnames+=p$$[3]+";"),p$q=p$g+1}}p$u(p$h,"");var p$q=p$h.prototype;return p$q.getWith=function(p$h){var p$q=p$h?this.codes[p$h]:this.script;if(!p$q)throw"get with error:"+p$h;return p$q},p$q.getFunsScript=function(p$h){var p$q="";for(var p$f in this.funs)0<=p$h.indexOf(p$f+";")&&(p$q+=this.funs[p$f]);return p$q},p$h}()},p$G}(),p$mh=function(){function p$S(){}return p$u(p$S,"laya.webgl.WebGL"),p$S._uint8ArraySlice=function(){for(var p$h=this.length,p$q=new Uint8Array(this.length),p$f=0;p$f<p$h;p$f++)p$q[p$f]=this[p$f];return p$q},p$S._float32ArraySlice=function(){for(var p$h=this.length,p$q=new Float32Array(this.length),p$f=0;p$f<p$h;p$f++)p$q[p$f]=this[p$f];return p$q},p$S._uint16ArraySlice=function(p$h){var p$q,p$f=arguments,p$g=0,p$$=0;if(0===p$f.length)for(p$g=this.length,p$q=new Uint16Array(p$g),p$$=0;p$$<p$g;p$$++)p$q[p$$]=this[p$$];else if(2===p$f.length){var p$P=p$f[0],p$S=p$f[1];if(p$P<p$S)for(p$g=p$S-p$P,p$q=new Uint16Array(p$g),p$$=p$P;p$$<p$S;p$$++)p$q[p$$-p$P]=this[p$$];else p$q=new Uint16Array(0)}return p$q},p$S.expandContext=function(){var p$h=p$$.prototype,p$q=CanvasRenderingContext2D.prototype;p$q.fillTrangles=p$h.fillTrangles,p$oh.__int__(null),p$q.setIBVB=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){void 0===p$r&&(p$r=0),void 0===p$Y&&(p$Y=0),null===p$f&&(this._ib=this._ib||p$xh.QuadrangleIB,p$f=this._ib,p$lh.expandIBQuadrangle(p$f,p$g._byteLength/64+8)),this._setIBVB(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y)},p$q.fillTrangles=function(p$h,p$q,p$f,p$g,p$$){this._curMat=this._curMat||p$n.create(),this._vb=this._vb||p$ah.create(),this._ib||(this._ib=p$xh.create(),p$lh.fillIBQuadrangle(this._ib,p$S/4));var p$P=this._vb,p$S=p$g.length>>4;p$lh.fillTranglesVB(p$P,p$q,p$f,p$g,p$$||this._curMat,0,0),p$lh.expandIBQuadrangle(this._ib,p$P._byteLength/64+8);var p$B=new p$Xh(1,0);p$B.textureHost=p$h;var p$r=new p$jh("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");p$P._vertType=3,this._setIBVB(p$q,p$f,this._ib,p$P,6*p$S,p$$,p$r,p$B,0,0)}},p$S.enable=function(){if(p$v.__init__(),p$_.isConchApp&&!p$_.isConchWebGL)return p$E.skinAniSprite=function(){return new p$hh},p$S.expandContext(),!1;if(p$E.getWebGLContext=function(p$h){for(var p$q,p$f=["webgl","experimental-webgl","webkit-3d","moz-webgl"],p$g=0;p$g<p$f.length;p$g++){try{p$q=p$h.getContext(p$f[p$g],{stencil:p$t.isStencil,alpha:p$t.isAlpha,antialias:p$t.isAntialias,premultipliedAlpha:p$t.premultipliedAlpha,preserveDrawingBuffer:p$t.preserveDrawingBuffer})}catch(p$h){}if(p$q)return p$q}return null},null==(p$S.mainContext=p$E.getWebGLContext(p$_._mainCanvas)))return!1;if(p$_.isWebGL)return!0;p$e.create=function(p$h,p$q){return new p$hq(p$h,p$q)},p$l.create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){return new p$Zh(p$h,p$q,p$f,p$g,p$$,p$P,p$S)},p$_.WebGL=p$S,p$_.isWebGL=!0,p$vh.__init__(),p$E.createRenderSprite=function(p$h,p$q){return new p$nh(p$h,p$q)},p$E.createWebGLContext2D=function(p$h){return new p$th(p$h)},p$E.changeWebGLSize=function(p$h,p$q){laya.webgl.WebGL.onStageResize(p$h,p$q)},p$E.createGraphics=function(){return new p$Rh};var p$h=p$E.createFilterAction;return p$E.createFilterAction=p$h||function(p$h){return new p$Jh},p$E.clear=function(p$h){p$Nh.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var p$q=p$_.context.ctx,p$f=0==p$q._submits._length||p$t.preserveDrawingBuffer?p$L.create(p$h)._color:p$d._wgColor;p$f&&p$q.clearBG(p$f[0],p$f[1],p$f[2],p$f[3]),p$Nh.clear()},p$E.addToAtlas=function(p$h,p$q){void 0===p$q&&(p$q=!1);var p$f=p$h.bitmap;p$_.optimizeTextureMemory(p$h.url,p$h)?p$R.__typeof(p$f,"laya.webgl.resource.IMergeAtlasBitmap")&&p$f.allowMerageInAtlas&&p$f.on("recovered",p$h,p$h.addTextureToAtlas):p$f.enableMerageInAtlas=!1},p$E.isAtlas=function(p$h){return p$h instanceof laya.webgl.atlas.AtlasWebGLCanvas},p$H._enable(),p$E.beginFlush=function(){for(var p$h=p$H.instance,p$q=p$h.getAtlaserCount(),p$f=0;p$f<p$q;p$f++){var p$g=p$h.getAtlaserByIndex(p$f).texture;p$g._flashCacheImageNeedFlush&&p$E.flashFlushImage(p$g)}},p$E.drawToCanvas=function(p$h,p$q,p$f,p$g,p$$,p$P){(p$f<=0||p$g<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),p$f|=0,p$g|=0,p$$|=0,p$P|=0;var p$S=p$Th.create(p$f,p$g,6408,5121,0,!1);p$S.start(),p$S.clear(0,0,0,0),p$_.context.clear(),p$N.renders[p$q]._fun(p$h,p$_.context,p$$,p$Nh.height-p$g+p$P),p$_.context.flush(),p$S.end();var p$B=p$S.getData(0,0,p$f,p$g);if(p$S.recycle(),p$B.byteLength==p$f*p$g*4){var p$r=new p$Kh;p$r._canvas=p$v.createElement("canvas"),p$r.size(p$f,p$g);var p$Y=p$r._canvas.getContext("2d");p$v.canvas.size(p$f,p$g);var p$C=p$v.context,p$U=p$C.createImageData(p$f,p$g);return p$U.data.set(new Uint8ClampedArray(p$B.buffer)),p$r._imgData=p$U,p$C.putImageData(p$U,0,0),p$Y.save(),p$Y.translate(0,p$g),p$Y.scale(1,-1),p$Y.drawImage(p$v.canvas.source,0,0),p$Y.restore(),p$r}console.log("drawToCanvas error: w:"+p$f+",h:"+p$g+",datalen:"+p$B.byteLength)},p$E.createFilterAction=function(p$h){var p$q;switch(p$h){case 32:p$q=new p$Jh}return p$q},p$E.addTextureToAtlas=function(p$h){p$h._uvID++,p$H._atlasRestore++,p$h.bitmap.enableMerageInAtlas&&p$H.instance.addToAtlas(p$h)},p$E.getTexturePixels=function(p$h,p$q,p$f,p$g,p$$){p$_.context.ctx.clear();var p$P=new p$A;p$P.graphics.drawTexture(p$h,-p$q,-p$f);var p$S=p$Th.create(p$g,p$$);p$S.start(),p$S.clear(0,0,0,0),p$P.render(p$_.context,0,0),p$_.context.ctx.flush(),p$S.end();for(var p$B=p$S.getData(0,0,p$g,p$$),p$r=[],p$Y=0,p$C=p$$-1;0<=p$C;p$C--)for(var p$U=0;p$U<p$g;p$U++)p$Y=4*(p$C*p$g+p$U),p$r.push(p$B[p$Y]),p$r.push(p$B[p$Y+1]),p$r.push(p$B[p$Y+2]),p$r.push(p$B[p$Y+3]);return p$r},p$E.skinAniSprite=function(){return new p$hh},p$Y.create=function(p$h,p$q){var p$f=new p$Kh;return p$f._imgData=p$q,p$f.flipY=!1,p$f},p$X._filterStart=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$h.getValue("bounds"),p$S=p$Th.create(p$P.width,p$P.height);if(p$S.start(),p$S.clear(0,0,0,0),p$h.addValue("src",p$S),p$h.addValue("ScissorTest",p$Nh.worldScissorTest),p$Nh.worldScissorTest){var p$B=new p$p;p$B.copyFrom(p$f.ctx._clipRect),p$h.addValue("clipRect",p$B),p$Nh.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},p$X._filterEnd=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$h.getValue("bounds");p$h.getValue("src").end();var p$S=p$Th.create(p$P.width,p$P.height);p$S.start(),p$S.clear(0,0,0,0),p$h.addValue("out",p$S),p$q._set$P("_filterCache",p$S),p$q._set$P("_isHaveGlowFilter",p$h.getValue("_isHaveGlowFilter"))},p$X._EndTarget=function(p$h,p$q){if(p$h.getValue("src").recycle(),p$h.getValue("out").end(),p$h.getValue("ScissorTest")){p$Nh.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),p$q.ctx.save();var p$f=p$h.getValue("clipRect");p$q.ctx.clipRect(p$f.x,p$f.y,p$f.width,p$f.height)}},p$X._useSrc=function(p$h){var p$q=p$h.getValue("out");p$q.end(),(p$q=p$h.getValue("src")).start(),p$q.clear(0,0,0,0)},p$X._endSrc=function(p$h){p$h.getValue("src").end()},p$X._useOut=function(p$h){var p$q=p$h.getValue("src");p$q.end(),(p$q=p$h.getValue("out")).start(),p$q.clear(0,0,0,0)},p$X._endOut=function(p$h){p$h.getValue("out").end()},p$X._recycleScope=function(p$h){p$h.recycle()},p$X._filter=function(p$h,p$q,p$f,p$g){var p$$=this._next;if(p$$){var p$P,p$S,p$B=p$h.filters,p$r=p$B.length;if(1==p$r&&32==p$B[0].type)return p$q.ctx.save(),p$q.ctx.setFilters([p$B[0]]),p$$._fun.call(p$$,p$h,p$q,p$f,p$g),void p$q.ctx.restore();var p$Y=p$Bh.create(),p$C=p$J.TEMP,p$U=p$q.ctx._getTransformMatrix(),p$u=p$n.create();p$U.copyTo(p$u);var p$v=0,p$L=0,p$e=!1,p$l=p$h._$P._filterCache?p$h._$P._filterCache:null;if(!p$l||p$h._repaint){p$e=p$h._isHaveGlowFilter(),p$Y.addValue("_isHaveGlowFilter",p$e),p$e&&(p$v=50,p$L=25),(p$S=new p$p).copyFrom(p$h.getSelfBounds()),p$S.x+=p$h.x,p$S.y+=p$h.y,p$S.x-=p$h.pivotX+4,p$S.y-=p$h.pivotY+4;var p$_=p$S.x,p$N=p$S.y;if(p$S.width+=p$v+8,p$S.height+=p$v+8,p$C.x=p$S.x*p$u.a+p$S.y*p$u.c,p$C.y=p$S.y*p$u.d+p$S.x*p$u.b,p$S.x=p$C.x,p$S.y=p$C.y,p$C.x=p$S.width*p$u.a+p$S.height*p$u.c,p$C.y=p$S.height*p$u.d+p$S.width*p$u.b,p$S.width=p$C.x,p$S.height=p$C.y,p$S.width<=0||p$S.height<=0)return;p$l&&p$l.recycle(),p$Y.addValue("bounds",p$S);var p$G=p$Sh.create([p$Y,p$h,p$q,0,0],p$X._filterStart);p$q.addRenderObject(p$G),p$q.ctx._renderKey=0,p$q.ctx._shader2D.glTexture=null;var p$m=p$h.x-p$_+p$L,p$E=p$h.y-p$N+p$L;p$$._fun.call(p$$,p$h,p$q,p$m,p$E),p$G=p$Sh.create([p$Y,p$h,p$q,0,0],p$X._filterEnd),p$q.addRenderObject(p$G);for(var p$R=0;p$R<p$r;p$R++){0!=p$R&&(p$G=p$Sh.create([p$Y],p$X._useSrc),p$q.addRenderObject(p$G),p$P=p$Xh.create(1,0),p$n.TEMP.identity(),p$q.ctx.drawTarget(p$Y,0,0,p$S.width,p$S.height,p$n.TEMP,"out",p$P,null,p$s.TOINT.overlay),p$G=p$Sh.create([p$Y],p$X._useOut),p$q.addRenderObject(p$G)),p$B[p$R].action.apply3d(p$Y,p$h,p$q,0,0)}p$G=p$Sh.create([p$Y,p$q],p$X._EndTarget),p$q.addRenderObject(p$G)}else{if((p$e=!!p$h._$P._isHaveGlowFilter&&p$h._$P._isHaveGlowFilter)&&(p$v=50,p$L=25),(p$S=p$h.getBounds()).width<=0||p$S.height<=0)return;p$S.width+=p$v,p$S.height+=p$v,p$C.x=p$S.x*p$u.a+p$S.y*p$u.c,p$C.y=p$S.y*p$u.d+p$S.x*p$u.b,p$S.x=p$C.x,p$S.y=p$C.y,p$C.x=p$S.width*p$u.a+p$S.height*p$u.c,p$C.y=p$S.height*p$u.d+p$S.width*p$u.b,p$S.width=p$C.x,p$S.height=p$C.y,p$Y.addValue("out",p$l)}p$f=p$f-p$L-p$h.x,p$g=p$g-p$L-p$h.y,p$C.setTo(p$f,p$g),p$u.transformPoint(p$C),p$f=p$C.x+p$S.x,p$g=p$C.y+p$S.y,p$P=p$Xh.create(1,0),p$n.TEMP.identity(),p$q.ctx.drawTarget(p$Y,p$f,p$g,p$S.width,p$S.height,p$n.TEMP,"out",p$P,null,p$s.TOINT.overlay),p$G=p$Sh.create([p$Y],p$X._recycleScope),p$q.addRenderObject(p$G),p$u.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=p$S._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=p$S._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=p$S._uint8ArraySlice),!0},p$S.onStageResize=function(p$h,p$q){null!=p$S.mainContext&&(p$S.mainContext.viewport(0,0,p$h,p$q),p$Nh.width=p$h,p$Nh.height=p$q)},p$S.onInvalidGLRes=function(){p$H.instance.freeAll(),p$m.releaseContentManagers(!0),p$S.doNodeRepaint(p$R.stage),p$S.mainContext.viewport(0,0,p$Nh.width,p$Nh.height),p$R.stage.event("devicelost")},p$S.doNodeRepaint=function(p$h){0==p$h.numChildren&&p$h.repaint();for(var p$q=0;p$q<p$h.numChildren;p$q++)p$S.doNodeRepaint(p$h.getChildAt(p$q))},p$S.init=function(p$h,p$q,p$f){p$S.mainCanvas=p$h,p$Y._createContext=function(p$h){return new p$th(p$h)},p$Kh._createContext=function(p$h){return new p$th(p$h)};var p$g=laya.webgl.WebGL.mainContext;if(null!=p$g.getShaderPrecisionFormat){var p$$=p$g.getShaderPrecisionFormat(35633,36338),p$P=p$g.getShaderPrecisionFormat(35632,36338);p$S.shaderHighPrecision=!(!p$$.precision||!p$P.precision)}else p$S.shaderHighPrecision=!1;if(p$g.deleteTexture1=p$g.deleteTexture,p$g.deleteTexture=function(p$h){p$h==p$Eh.curBindTexValue&&(p$Eh.curBindTexValue=null),p$g.deleteTexture1(p$h)},p$S.onStageResize(p$q,p$f),null==p$S.mainContext)throw new Error("webGL getContext err!");p$z.__init__(),p$H.__init__(),p$Ah.__init__(),p$Ph.__init__(),p$th.__init__(),p$Xh.__init__(),p$x.__init__(),p$oh.__int__(p$g),p$s._init_(p$g),p$_.isConchApp&&conch.setOnInvalidGLRes(p$S.onInvalidGLRes)},p$S.mainCanvas=null,p$S.mainContext=null,p$S.antialias=!0,p$S.shaderHighPrecision=!1,p$S._bg_null=[0,0,0,0],p$S}(),p$Eh=function(){function p$g(){}return p$u(p$g,"laya.webgl.WebGLContext"),p$g.UseProgram=function(p$h){return p$g._useProgram!==p$h&&(p$mh.mainContext.useProgram(p$h),p$g._useProgram=p$h,!0)},p$g.setDepthTest=function(p$h,p$q){p$q!==p$g._depthTest&&((p$g._depthTest=p$q)?p$h.enable(2929):p$h.disable(2929))},p$g.setDepthMask=function(p$h,p$q){p$q!==p$g._depthMask&&(p$g._depthMask=p$q,p$h.depthMask(p$q))},p$g.setDepthFunc=function(p$h,p$q){p$q!==p$g._depthFunc&&(p$g._depthFunc=p$q,p$h.depthFunc(p$q))},p$g.setBlend=function(p$h,p$q){p$q!==p$g._blend&&((p$g._blend=p$q)?p$h.enable(3042):p$h.disable(3042))},p$g.setBlendFunc=function(p$h,p$q,p$f){(p$q!==p$g._sFactor||p$f!==p$g._dFactor)&&(p$g._sFactor=p$q,p$g._dFactor=p$f,p$h.blendFunc(p$q,p$f))},p$g.setCullFace=function(p$h,p$q){p$q!==p$g._cullFace&&((p$g._cullFace=p$q)?p$h.enable(2884):p$h.disable(2884))},p$g.setFrontFace=function(p$h,p$q){p$q!==p$g._frontFace&&(p$g._frontFace=p$q,p$h.frontFace(p$q))},p$g.bindTexture=function(p$h,p$q,p$f){p$h.bindTexture(p$q,p$f),p$g.curBindTexTarget=p$q,p$g.curBindTexValue=p$f},p$g.DEPTH_BUFFER_BIT=256,p$g.STENCIL_BUFFER_BIT=1024,p$g.COLOR_BUFFER_BIT=16384,p$g.POINTS=0,p$g.LINES=1,p$g.LINE_LOOP=2,p$g.LINE_STRIP=3,p$g.TRIANGLES=4,p$g.TRIANGLE_STRIP=5,p$g.TRIANGLE_FAN=6,p$g.ZERO=0,p$g.ONE=1,p$g.SRC_COLOR=768,p$g.ONE_MINUS_SRC_COLOR=769,p$g.SRC_ALPHA=770,p$g.ONE_MINUS_SRC_ALPHA=771,p$g.DST_ALPHA=772,p$g.ONE_MINUS_DST_ALPHA=773,p$g.DST_COLOR=774,p$g.ONE_MINUS_DST_COLOR=775,p$g.SRC_ALPHA_SATURATE=776,p$g.FUNC_ADD=32774,p$g.BLEND_EQUATION=32777,p$g.BLEND_EQUATION_RGB=32777,p$g.BLEND_EQUATION_ALPHA=34877,p$g.FUNC_SUBTRACT=32778,p$g.FUNC_REVERSE_SUBTRACT=32779,p$g.BLEND_DST_RGB=32968,p$g.BLEND_SRC_RGB=32969,p$g.BLEND_DST_ALPHA=32970,p$g.BLEND_SRC_ALPHA=32971,p$g.CONSTANT_COLOR=32769,p$g.ONE_MINUS_CONSTANT_COLOR=32770,p$g.CONSTANT_ALPHA=32771,p$g.ONE_MINUS_CONSTANT_ALPHA=32772,p$g.BLEND_COLOR=32773,p$g.ARRAY_BUFFER=34962,p$g.ELEMENT_ARRAY_BUFFER=34963,p$g.ARRAY_BUFFER_BINDING=34964,p$g.ELEMENT_ARRAY_BUFFER_BINDING=34965,p$g.STREAM_DRAW=35040,p$g.STATIC_DRAW=35044,p$g.DYNAMIC_DRAW=35048,p$g.BUFFER_SIZE=34660,p$g.BUFFER_USAGE=34661,p$g.CURRENT_VERTEX_ATTRIB=34342,p$g.FRONT=1028,p$g.BACK=1029,p$g.CULL_FACE=2884,p$g.FRONT_AND_BACK=1032,p$g.BLEND=3042,p$g.DITHER=3024,p$g.STENCIL_TEST=2960,p$g.DEPTH_TEST=2929,p$g.SCISSOR_TEST=3089,p$g.POLYGON_OFFSET_FILL=32823,p$g.SAMPLE_ALPHA_TO_COVERAGE=32926,p$g.SAMPLE_COVERAGE=32928,p$g.NO_ERROR=0,p$g.INVALID_ENUM=1280,p$g.INVALID_VALUE=1281,p$g.INVALID_OPERATION=1282,p$g.OUT_OF_MEMORY=1285,p$g.CW=2304,p$g.CCW=2305,p$g.LINE_WIDTH=2849,p$g.ALIASED_POINT_SIZE_RANGE=33901,p$g.ALIASED_LINE_WIDTH_RANGE=33902,p$g.CULL_FACE_MODE=2885,p$g.FRONT_FACE=2886,p$g.DEPTH_RANGE=2928,p$g.DEPTH_WRITEMASK=2930,p$g.DEPTH_CLEAR_VALUE=2931,p$g.DEPTH_FUNC=2932,p$g.STENCIL_CLEAR_VALUE=2961,p$g.STENCIL_FUNC=2962,p$g.STENCIL_FAIL=2964,p$g.STENCIL_PASS_DEPTH_FAIL=2965,p$g.STENCIL_PASS_DEPTH_PASS=2966,p$g.STENCIL_REF=2967,p$g.STENCIL_VALUE_MASK=2963,p$g.STENCIL_WRITEMASK=2968,p$g.STENCIL_BACK_FUNC=34816,p$g.STENCIL_BACK_FAIL=34817,p$g.STENCIL_BACK_PASS_DEPTH_FAIL=34818,p$g.STENCIL_BACK_PASS_DEPTH_PASS=34819,p$g.STENCIL_BACK_REF=36003,p$g.STENCIL_BACK_VALUE_MASK=36004,p$g.STENCIL_BACK_WRITEMASK=36005,p$g.VIEWPORT=2978,p$g.SCISSOR_BOX=3088,p$g.COLOR_CLEAR_VALUE=3106,p$g.COLOR_WRITEMASK=3107,p$g.UNPACK_ALIGNMENT=3317,p$g.PACK_ALIGNMENT=3333,p$g.MAX_TEXTURE_SIZE=3379,p$g.MAX_VIEWPORT_DIMS=3386,p$g.SUBPIXEL_BITS=3408,p$g.RED_BITS=3410,p$g.GREEN_BITS=3411,p$g.BLUE_BITS=3412,p$g.ALPHA_BITS=3413,p$g.DEPTH_BITS=3414,p$g.STENCIL_BITS=3415,p$g.POLYGON_OFFSET_UNITS=10752,p$g.POLYGON_OFFSET_FACTOR=32824,p$g.TEXTURE_BINDING_2D=32873,p$g.SAMPLE_BUFFERS=32936,p$g.SAMPLES=32937,p$g.SAMPLE_COVERAGE_VALUE=32938,p$g.SAMPLE_COVERAGE_INVERT=32939,p$g.NUM_COMPRESSED_TEXTURE_FORMATS=34466,p$g.COMPRESSED_TEXTURE_FORMATS=34467,p$g.DONT_CARE=4352,p$g.FASTEST=4353,p$g.NICEST=4354,p$g.GENERATE_MIPMAP_HINT=33170,p$g.BYTE=5120,p$g.UNSIGNED_BYTE=5121,p$g.SHORT=5122,p$g.UNSIGNED_SHORT=5123,p$g.INT=5124,p$g.UNSIGNED_INT=5125,p$g.FLOAT=5126,p$g.DEPTH_COMPONENT=6402,p$g.ALPHA=6406,p$g.RGB=6407,p$g.RGBA=6408,p$g.LUMINANCE=6409,p$g.LUMINANCE_ALPHA=6410,p$g.UNSIGNED_SHORT_4_4_4_4=32819,p$g.UNSIGNED_SHORT_5_5_5_1=32820,p$g.UNSIGNED_SHORT_5_6_5=33635,p$g.FRAGMENT_SHADER=35632,p$g.VERTEX_SHADER=35633,p$g.MAX_VERTEX_ATTRIBS=34921,p$g.MAX_VERTEX_UNIFORM_VECTORS=36347,p$g.MAX_VARYING_VECTORS=36348,p$g.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,p$g.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,p$g.MAX_TEXTURE_IMAGE_UNITS=34930,p$g.MAX_FRAGMENT_UNIFORM_VECTORS=36349,p$g.SHADER_TYPE=35663,p$g.DELETE_STATUS=35712,p$g.LINK_STATUS=35714,p$g.VALIDATE_STATUS=35715,p$g.ATTACHED_SHADERS=35717,p$g.ACTIVE_UNIFORMS=35718,p$g.ACTIVE_ATTRIBUTES=35721,p$g.SHADING_LANGUAGE_VERSION=35724,p$g.CURRENT_PROGRAM=35725,p$g.NEVER=512,p$g.LESS=513,p$g.EQUAL=514,p$g.LEQUAL=515,p$g.GREATER=516,p$g.NOTEQUAL=517,p$g.GEQUAL=518,p$g.ALWAYS=519,p$g.KEEP=7680,p$g.REPLACE=7681,p$g.INCR=7682,p$g.DECR=7683,p$g.INVERT=5386,p$g.INCR_WRAP=34055,p$g.DECR_WRAP=34056,p$g.VENDOR=7936,p$g.RENDERER=7937,p$g.VERSION=7938,p$g.NEAREST=9728,p$g.LINEAR=9729,p$g.NEAREST_MIPMAP_NEAREST=9984,p$g.LINEAR_MIPMAP_NEAREST=9985,p$g.NEAREST_MIPMAP_LINEAR=9986,p$g.LINEAR_MIPMAP_LINEAR=9987,p$g.TEXTURE_MAG_FILTER=10240,p$g.TEXTURE_MIN_FILTER=10241,p$g.TEXTURE_WRAP_S=10242,p$g.TEXTURE_WRAP_T=10243,p$g.TEXTURE_2D=3553,p$g.TEXTURE=5890,p$g.TEXTURE_CUBE_MAP=34067,p$g.TEXTURE_BINDING_CUBE_MAP=34068,p$g.TEXTURE_CUBE_MAP_POSITIVE_X=34069,p$g.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,p$g.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,p$g.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,p$g.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,p$g.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,p$g.MAX_CUBE_MAP_TEXTURE_SIZE=34076,p$g.TEXTURE0=33984,p$g.TEXTURE1=33985,p$g.TEXTURE2=33986,p$g.TEXTURE3=33987,p$g.TEXTURE4=33988,p$g.TEXTURE5=33989,p$g.TEXTURE6=33990,p$g.TEXTURE7=33991,p$g.TEXTURE8=33992,p$g.TEXTURE9=33993,p$g.TEXTURE10=33994,p$g.TEXTURE11=33995,p$g.TEXTURE12=33996,p$g.TEXTURE13=33997,p$g.TEXTURE14=33998,p$g.TEXTURE15=33999,p$g.TEXTURE16=34e3,p$g.TEXTURE17=34001,p$g.TEXTURE18=34002,p$g.TEXTURE19=34003,p$g.TEXTURE20=34004,p$g.TEXTURE21=34005,p$g.TEXTURE22=34006,p$g.TEXTURE23=34007,p$g.TEXTURE24=34008,p$g.TEXTURE25=34009,p$g.TEXTURE26=34010,p$g.TEXTURE27=34011,p$g.TEXTURE28=34012,p$g.TEXTURE29=34013,p$g.TEXTURE30=34014,p$g.TEXTURE31=34015,p$g.ACTIVE_TEXTURE=34016,p$g.REPEAT=10497,p$g.CLAMP_TO_EDGE=33071,p$g.MIRRORED_REPEAT=33648,p$g.FLOAT_VEC2=35664,p$g.FLOAT_VEC3=35665,p$g.FLOAT_VEC4=35666,p$g.INT_VEC2=35667,p$g.INT_VEC3=35668,p$g.INT_VEC4=35669,p$g.BOOL=35670,p$g.BOOL_VEC2=35671,p$g.BOOL_VEC3=35672,p$g.BOOL_VEC4=35673,p$g.FLOAT_MAT2=35674,p$g.FLOAT_MAT3=35675,p$g.FLOAT_MAT4=35676,p$g.SAMPLER_2D=35678,p$g.SAMPLER_CUBE=35680,p$g.VERTEX_ATTRIB_ARRAY_ENABLED=34338,p$g.VERTEX_ATTRIB_ARRAY_SIZE=34339,p$g.VERTEX_ATTRIB_ARRAY_STRIDE=34340,p$g.VERTEX_ATTRIB_ARRAY_TYPE=34341,p$g.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,p$g.VERTEX_ATTRIB_ARRAY_POINTER=34373,p$g.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,p$g.COMPILE_STATUS=35713,p$g.LOW_FLOAT=36336,p$g.MEDIUM_FLOAT=36337,p$g.HIGH_FLOAT=36338,p$g.LOW_INT=36339,p$g.MEDIUM_INT=36340,p$g.HIGH_INT=36341,p$g.FRAMEBUFFER=36160,p$g.RENDERBUFFER=36161,p$g.RGBA4=32854,p$g.RGB5_A1=32855,p$g.RGB565=36194,p$g.DEPTH_COMPONENT16=33189,p$g.STENCIL_INDEX=6401,p$g.STENCIL_INDEX8=36168,p$g.DEPTH_STENCIL=34041,p$g.RENDERBUFFER_WIDTH=36162,p$g.RENDERBUFFER_HEIGHT=36163,p$g.RENDERBUFFER_INTERNAL_FORMAT=36164,p$g.RENDERBUFFER_RED_SIZE=36176,p$g.RENDERBUFFER_GREEN_SIZE=36177,p$g.RENDERBUFFER_BLUE_SIZE=36178,p$g.RENDERBUFFER_ALPHA_SIZE=36179,p$g.RENDERBUFFER_DEPTH_SIZE=36180,p$g.RENDERBUFFER_STENCIL_SIZE=36181,p$g.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,p$g.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,p$g.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,p$g.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,p$g.COLOR_ATTACHMENT0=36064,p$g.DEPTH_ATTACHMENT=36096,p$g.STENCIL_ATTACHMENT=36128,p$g.DEPTH_STENCIL_ATTACHMENT=33306,p$g.NONE=0,p$g.FRAMEBUFFER_COMPLETE=36053,p$g.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,p$g.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,p$g.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,p$g.FRAMEBUFFER_UNSUPPORTED=36061,p$g.FRAMEBUFFER_BINDING=36006,p$g.RENDERBUFFER_BINDING=36007,p$g.MAX_RENDERBUFFER_SIZE=34024,p$g.INVALID_FRAMEBUFFER_OPERATION=1286,p$g.UNPACK_FLIP_Y_WEBGL=37440,p$g.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,p$g.CONTEXT_LOST_WEBGL=37442,p$g.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,p$g.BROWSER_DEFAULT_WEBGL=37444,p$g._useProgram=null,p$g._depthTest=!0,p$g._depthMask=!0,p$g._blend=!1,p$g._cullFace=!1,p$g.curBindTexTarget=null,p$g.curBindTexValue=null,p$S(p$g,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),p$g}(),p$Rh=function(p$h){function p$q(){p$q.__super.call(this)}p$u(p$q,"laya.webgl.display.GraphicsGL",p$B);var p$f=p$q.prototype;return p$f.setShader=function(p$h){this._saveToCmd(p$_.context._setShader,[p$h])},p$f.setIBVB=function(p$h,p$q,p$f,p$g,p$$,p$P){this._saveToCmd(p$_.context._setIBVB,[p$h,p$q,p$f,p$g,p$$,p$P])},p$f.drawParticle=function(p$h,p$q,p$f){var p$g=p$E.createParticleTemplate2D(p$f);p$g.x=p$h,p$g.y=p$q,this._saveToCmd(p$_.context._drawParticle,[p$g])},p$q}(),p$th=function(p$h){var p$f;function p$k(p$h){this._x=0,this._y=0,this._id=++p$k._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,p$k.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=p$k.MAXCLIPRECT,this.mOutPoint,this._canvas=p$h,this._canvas._addReference(),p$k._contextcount++,p$_.isFlash?(this._ib=p$xh.create(35044),p$lh.fillIBQuadrangle(this._ib,16)):this._ib=p$xh.QuadrangleIB,this.clear()}p$u(p$k,"laya.webgl.canvas.WebGLContext2D",p$$);var p$q=p$k.prototype;return p$q.setIsMainContext=function(){this._isMain=!0},p$q.clearBG=function(p$h,p$q,p$f,p$g){var p$$=p$mh.mainContext;p$$.clearColor(p$h,p$q,p$f,p$g),p$$.clear(16384)},p$q._getSubmits=function(){return this._submits},p$q._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var p$h=0,p$q=this._submits._length;p$h<p$q;p$h++)this._submits[p$h].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},p$q.destroy=function(){--p$k._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=p$xh.QuadrangleIB&&this._ib.releaseResource()},p$q.clear=function(){this._submits||(this._other=p$f.DEFAULT,this._curMat=p$n.create(),this._vb=p$ah.create(-1),this._submits=[],this._save=[p$Q.Create(this)],this._save.length=10,this._shader2D=new p$x,this._triangleMesh=p$Mh.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=p$f.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=p$k.MAXCLIPRECT,this._curSubmit=p$Ph.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=p$V.DEFAULT;for(var p$h=0,p$q=this._submits._length;p$h<p$q;p$h++)this._submits[p$h].releaseRender(),this._submits[p$h]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},p$q.size=function(p$h,p$q){if(this._width!=p$h||this._height!=p$q)if(0==p$h||0==p$q){0!=this._vb._byteLength&&(this._width=p$h,this._height=p$q,this._vb.clear(),this._vb.upload());for(var p$f=0,p$g=this._submits._length;p$f<p$g;p$f++)this._submits[p$f].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=p$h,this._height=p$q,this._targets&&this._targets.size(p$h,p$q),this._canvas.memorySize-=this._canvas.memorySize;0===p$h&&0===p$q&&this._releaseMem()},p$q._getTransformMatrix=function(){return this._curMat},p$q.translate=function(p$h,p$q){0===p$h&&0===p$q||(p$O.save(this),this._curMat.bTransform&&(p$o.save(this),this._curMat.transformPointN(p$J.TEMP.setTo(p$h,p$q)),p$h=p$J.TEMP.x,p$q=p$J.TEMP.y),this._x+=p$h,this._y+=p$q)},p$q.save=function(){this._save[this._save._length++]=p$Q.Create(this)},p$q.restore=function(){var p$h=this._save._length;if(!(p$h<1))for(var p$q=p$h-1;0<=p$q;p$q--){var p$f=this._save[p$q];if(p$f.restore(this),p$f.isSaveMark())return void(this._save._length=p$q)}},p$q._fillText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){void 0===p$Y&&(p$Y=0);var p$C=this._shader2D,p$U=this._curSubmit.shaderValue,p$u=p$$?p$Lh.create(p$$):this._other.font;if(p$H.enabled)p$C.ALPHA!==p$U.ALPHA&&(p$C.glTexture=null),p$vh.drawText(this,p$h,p$q,this._curMat,p$u,p$r||this._other.textAlign,p$P,p$S,p$B,p$f,p$g,p$Y);else{this._shader2D.defines.getValue();var p$v=p$P?p$L.create(p$P)._color:p$C.colorAdd;p$C.ALPHA===p$U.ALPHA&&p$v===p$C.colorAdd&&p$U.colorAdd===p$C.colorAdd||(p$C.glTexture=null,p$C.colorAdd=p$v),p$vh.drawText(this,p$h,p$q,this._curMat,p$u,p$r||this._other.textAlign,p$P,p$S,p$B,p$f,p$g,p$Y)}},p$q.fillWords=function(p$h,p$q,p$f,p$g,p$$,p$P){this._fillText(null,p$h,p$q,p$f,p$g,p$$,null,-1,null,p$P)},p$q.fillBorderWords=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._fillBorderText(null,p$h,p$q,p$f,p$g,p$$,p$P,p$S,null)},p$q.fillText=function(p$h,p$q,p$f,p$g,p$$,p$P){this._fillText(p$h,null,p$q,p$f,p$g,p$$,null,-1,p$P)},p$q.strokeText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._fillText(p$h,null,p$q,p$f,p$g,null,p$$,p$P||1,p$S)},p$q.fillBorderText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){this._fillBorderText(p$h,null,p$q,p$f,p$g,p$$,p$P,p$S,p$B)},p$q._fillBorderText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){if(!p$H.enabled)return this._fillText(p$h,p$q,p$f,p$g,p$$,null,p$S,p$B||1,p$r),void this._fillText(p$h,p$q,p$f,p$g,p$$,p$P,null,-1,p$r);var p$Y=this._shader2D,p$C=this._curSubmit.shaderValue;p$Y.ALPHA!==p$C.ALPHA&&(p$Y.glTexture=null);var p$U=p$$?(p$k._fontTemp.setFont(p$$),p$k._fontTemp):this._other.font;p$vh.drawText(this,p$h,p$q,this._curMat,p$U,p$r||this._other.textAlign,p$P,p$S,p$B||1,p$f,p$g,0)},p$q.fillRect=function(p$h,p$q,p$f,p$g,p$$){var p$P=this._vb;if(p$lh.fillRectImgVb(p$P,this._clipRect,p$h,p$q,p$f,p$g,p$M.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var p$S=this._shader2D.fillStyle;p$$&&(this._shader2D.fillStyle=p$V.create(p$$));var p$B=this._shader2D,p$r=this._curSubmit.shaderValue;if(p$B.fillStyle!==p$r.fillStyle||p$B.ALPHA!==p$r.ALPHA){p$B.glTexture=null;var p$Y=this._curSubmit=p$Ph.createSubmit(this,this._ib,p$P,(p$P._byteLength-64)/32*3,p$Xh.create(2,0));p$Y.shaderValue.color=p$B.fillStyle._color._color,p$Y.shaderValue.ALPHA=p$B.ALPHA,this._submits[this._submits._length++]=p$Y}this._curSubmit._numEle+=6,this._shader2D.fillStyle=p$S}},p$q.fillTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){if(p$h.loaded&&p$h.bitmap&&p$h.source){var p$r=this._vb,p$Y=p$h.bitmap.width,p$C=p$h.bitmap.height,p$U=p$h.uv,p$u=p$S.x%p$h.width,p$v=p$S.y%p$h.height;if(p$Y!=p$B.w||p$C!=p$B.h){if(!p$B.w&&!p$B.h)switch(p$B.oy=p$B.ox=0,p$P){case"repeat":p$B.width=p$g,p$B.height=p$$;break;case"repeat-x":p$B.width=p$g,p$v<0?p$h.height+p$v>p$$?p$B.height=p$$:p$B.height=p$h.height+p$v:(p$B.oy=p$v,p$h.height+p$v>p$$?p$B.height=p$$-p$v:p$B.height=p$h.height);break;case"repeat-y":p$u<0?p$h.width+p$u>p$g?p$B.width=p$g:p$B.width=p$h.width+p$u:(p$B.ox=p$u,p$h.width+p$u>p$g?p$B.width=p$g-p$u:p$B.width=p$h.width),p$B.height=p$$;break;case"no-repeat":p$u<0?p$h.width+p$u>p$g?p$B.width=p$g:p$B.width=p$h.width+p$u:(p$B.ox=p$u,p$h.width+p$u>p$g?p$B.width=p$g-p$u:p$B.width=p$h.width),p$v<0?p$h.height+p$v>p$$?p$B.height=p$$:p$B.height=p$h.height+p$v:(p$B.oy=p$v,p$h.height+p$v>p$$?p$B.height=p$$-p$v:p$B.height=p$h.height);break;default:p$B.width=p$g,p$B.height=p$$}p$B.w=p$Y,p$B.h=p$C,p$B.uv=[0,0,p$B.width/p$Y,0,p$B.width/p$Y,p$B.height/p$C,0,p$B.height/p$C]}if(p$q+=p$B.ox,p$f+=p$B.oy,p$u-=p$B.ox,p$v-=p$B.oy,p$lh.fillRectImgVb(p$r,this._clipRect,p$q,p$f,p$B.width,p$B.height,p$B.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var p$L=p$ch.create(this,this._ib,p$r,(p$r._byteLength-64)/32*3,p$Xh.create(256,0)),p$e=(this._submits[this._submits._length++]=p$L).shaderValue;p$e.textureHost=p$h;var p$l=p$U[0]*p$Y,p$_=p$U[1]*p$C,p$N=(p$U[2]-p$U[0])*p$Y,p$G=(p$U[5]-p$U[3])*p$C,p$m=-p$u/p$Y,p$E=-p$v/p$C;p$e.u_TexRange[0]=p$l/p$Y,p$e.u_TexRange[1]=p$N/p$Y,p$e.u_TexRange[2]=p$_/p$C,p$e.u_TexRange[3]=p$G/p$C,p$e.u_offset[0]=p$m,p$e.u_offset[1]=p$E,p$H.enabled&&!this._isMain&&p$L.addTexture(p$h,(p$r._byteLength>>2)-16),(this._curSubmit=p$L)._renderType=10017,p$L._numEle+=6}}else this.sprite&&p$R.timer.callLater(this,this._repaintSprite)},p$q.setShader=function(p$h){p$y.save(this,1048576,this._shader2D,!0),this._shader2D.shader=p$h},p$q.setFilters=function(p$h){p$y.save(this,2097152,this._shader2D,!0),this._shader2D.filters=p$h,this._curSubmit=p$Ph.RENDERBASE,this._renderKey=0,this._drawCount++},p$q.drawTexture=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._drawTextureM(p$h,p$q,p$f,p$g,p$$,p$P,p$S,null,1)},p$q.addTextureVb=function(p$h,p$q,p$f){var p$g=this._curSubmit._vb||this._vb,p$$=p$g._byteLength>>2;p$g.byteLength=p$$+16<<2;for(var p$P=p$g.getFloat32Array(),p$S=0;p$S<16;p$S+=4)p$P[p$$++]=p$h[p$S]+p$q,p$P[p$$++]=p$h[p$S+1]+p$f,p$P[p$$++]=p$h[p$S+2],p$P[p$$++]=p$h[p$S+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),p$g._upload=!0},p$q.willDrawTexture=function(p$h,p$q){if(!(p$h.loaded&&p$h.bitmap&&p$h.source))return this.sprite&&p$R.timer.callLater(this,this._repaintSprite),0;var p$f=p$h.bitmap,p$g=p$f.id+this._shader2D.ALPHA*p$q+10016;if(p$g==this._renderKey)return p$g;var p$$=this._shader2D,p$P=p$$.ALPHA,p$S=this._curSubmit.shaderValue;p$$.ALPHA*=p$q,this._renderKey=p$g,this._drawCount++,p$$.glTexture=p$f;var p$B=this._vb,p$r=null,p$Y=p$B._byteLength/32*3,p$C=p$S.textureHost&&p$S.textureHost==p$h&&p$S.textureHost.alphaTexture==p$h.alphaTexture;return p$r=p$ch.create(this,this._ib,p$B,p$Y,p$Xh.create(1,0)),(this._submits[this._submits._length++]=p$r).shaderValue.textureHost=p$h,p$r._renderType=10016,p$r._preIsSameTextureShader=10016===this._curSubmit._renderType&&p$$.ALPHA===p$S.ALPHA&&p$C,this._curSubmit=p$r,p$$.ALPHA=p$P,p$g},p$q.drawTextures=function(p$h,p$q,p$f,p$g){if(p$h.loaded&&p$h.bitmap&&p$h.source){var p$$=this._clipRect;if(this._clipRect=p$k.MAXCLIPRECT,this._drawTextureM(p$h,p$q[0],p$q[1],p$h.width,p$h.height,p$f,p$g,null,1)){if(this._clipRect=p$$,p$b.drawCall++,!(p$q.length<4)){for(var p$P=this._curSubmit._vb||this._vb,p$S=this._curMat.a,p$B=this._curMat.d,p$r=2,p$Y=p$q.length;p$r<p$Y;p$r+=2)p$lh.copyPreImgVb(p$P,(p$q[p$r]-p$q[p$r-2])*p$S,(p$q[p$r+1]-p$q[p$r-1])*p$B),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&p$R.timer.callLater(this,this._repaintSprite)},p$q._drawTextureM=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){if(!p$h.loaded||!p$h.source)return this.sprite&&p$R.timer.callLater(this,this._repaintSprite),!1;var p$Y=this._curSubmit._vb||this._vb,p$C=p$h.bitmap;p$q+=p$P,p$f+=p$S,this._drawCount++;var p$U=p$C.id+this._shader2D.ALPHA*p$r+10016;if(p$U!=this._renderKey){this._renderKey=p$U;var p$u=this._curSubmit.shaderValue,p$v=this._shader2D,p$L=p$v.ALPHA;p$v.ALPHA*=p$r,p$v.glTexture=p$C;var p$e=this._vb,p$l=null,p$_=p$e._byteLength/32*3,p$N=p$u.textureHost&&p$u.textureHost==p$h&&p$u.textureHost.alphaTexture==p$h.alphaTexture;p$l=p$ch.create(this,this._ib,p$e,p$_,p$Xh.create(1,0)),(this._submits[this._submits._length++]=p$l).shaderValue.textureHost=p$h,p$l._renderType=10016,p$l._preIsSameTextureShader=10016===this._curSubmit._renderType&&p$v.ALPHA===p$u.ALPHA&&p$N,this._curSubmit=p$l,p$Y=this._curSubmit._vb||this._vb,p$v.ALPHA=p$L}return!!p$lh.fillRectImgVb(p$Y,this._clipRect,p$q,p$f,p$g||p$h.width,p$$||p$h.height,p$h.uv,p$B||this._curMat,this._x,this._y,0,0)&&(p$H.enabled&&!this._isMain&&this._curSubmit.addTexture(p$h,(p$Y._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},p$q._repaintSprite=function(){this.sprite&&this.sprite.repaint()},p$q._drawText=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){var p$C=p$h.bitmap;this._drawCount++;var p$U=p$C.id+this._shader2D.ALPHA+10016;if(p$U!=this._renderKey){this._renderKey=p$U;var p$u=this._curSubmit.shaderValue,p$v=this._shader2D;p$v.glTexture=p$C;var p$L=this._vb,p$e=null,p$l=p$L._byteLength/32*3,p$_=p$u.textureHost&&p$u.textureHost==p$h&&p$u.textureHost.alphaTexture==p$h.alphaTexture;(p$e=p$H.enabled?p$ch.create(this,this._ib,p$L,p$l,p$Xh.create(1,0)):p$ch.create(this,this._ib,p$L,p$l,p$Oh.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&p$v.ALPHA===p$u.ALPHA&&p$_,(this._submits[this._submits._length++]=p$e).shaderValue.textureHost=p$h,p$e._renderType=10016,this._curSubmit=p$e}p$h.active();var p$N=this._curSubmit._vb||this._vb;p$lh.fillRectImgVb(p$N,this._clipRect,p$q+p$S,p$f+p$B,p$g||p$h.width,p$$||p$h.height,p$h.uv,p$P||this._curMat,this._x,this._y,p$r,p$Y,!0)&&(p$H.enabled&&!this._isMain&&this._curSubmit.addTexture(p$h,(p$N._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},p$q.drawTextureWithTransform=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){if(p$P){var p$Y=this._curMat,p$C=this._x,p$U=this._y;(0!==p$S||0!==p$B)&&(this._x=p$S*p$Y.a+p$B*p$Y.c,this._y=p$B*p$Y.d+p$S*p$Y.b),p$P&&p$Y.bTransform?(p$n.mul(p$P,p$Y,p$k._tmpMatrix),(p$P=p$k._tmpMatrix)._checkTransform()):(this._x+=p$Y.tx,this._y+=p$Y.ty),this._drawTextureM(p$h,p$q,p$f,p$g,p$$,0,0,p$P,p$r),this._x=p$C,this._y=p$U}else this._drawTextureM(p$h,p$q,p$f,p$g,p$$,p$S,p$B,null,p$r)},p$q.fillQuadrangle=function(p$h,p$q,p$f,p$g,p$$){var p$P=this._curSubmit,p$S=this._vb,p$B=this._shader2D,p$r=p$P.shaderValue;if(this._renderKey=0,p$h.bitmap){var p$Y=p$h.bitmap;p$B.glTexture==p$Y&&p$B.ALPHA===p$r.ALPHA||(p$B.glTexture=p$Y,(p$P=this._curSubmit=p$Ph.createSubmit(this,this._ib,p$S,p$S._byteLength/32*3,p$Xh.create(1,0))).shaderValue.glTexture=p$Y,this._submits[this._submits._length++]=p$P),p$lh.fillQuadrangleImgVb(p$S,p$q,p$f,p$g,p$h.uv,p$$||this._curMat,this._x,this._y)}else p$P.shaderValue.fillStyle&&p$P.shaderValue.fillStyle.equal(p$h)&&p$B.ALPHA===p$r.ALPHA||(p$B.glTexture=null,(p$P=this._curSubmit=p$Ph.createSubmit(this,this._ib,p$S,p$S._byteLength/32*3,p$Xh.create(2,0))).shaderValue.defines.add(2),p$P.shaderValue.fillStyle=p$V.create(p$h),this._submits[this._submits._length++]=p$P),p$lh.fillQuadrangleImgVb(p$S,p$q,p$f,p$g,p$M.DEF_UV,p$$||this._curMat,this._x,this._y);p$P._numEle+=6},p$q.drawTexture2=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){if(0!=p$P){var p$r=this._curMat;if(this._x=p$h*p$r.a+p$q*p$r.c,this._y=p$q*p$r.d+p$h*p$r.b,p$$&&(p$$=p$r.bTransform||p$$.bTransform?(p$n.mul(p$$,p$r,p$k._tmpMatrix),p$k._tmpMatrix):(this._x+=p$$.tx+p$r.tx,this._y+=p$$.ty+p$r.ty,p$n.EMPTY)),1!==p$P||p$S){var p$Y=this._shader2D.ALPHA,p$C=this._nBlendType;this._shader2D.ALPHA=p$P,p$S&&(this._nBlendType=p$s.TOINT(p$S)),this._drawTextureM(p$B[0],p$B[1]-p$f,p$B[2]-p$g,p$B[3],p$B[4],0,0,p$$,1),this._shader2D.ALPHA=p$Y,this._nBlendType=p$C}else this._drawTextureM(p$B[0],p$B[1]-p$f,p$B[2]-p$g,p$B[3],p$B[4],0,0,p$$,1);this._x=this._y=0}},p$q.drawCanvas=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$h.context;if(this._renderKey=0,p$P._targets)this._submits[this._submits._length++]=p$zh.create(p$P,0,null),this._curSubmit=p$Ph.RENDERBASE,p$P._targets.drawTo(this,p$q,p$f,p$g,p$$);else{var p$S=this._submits[this._submits._length++]=p$zh.create(p$P,this._shader2D.ALPHA,this._shader2D.filters),p$B=p$g/p$h.width,p$r=p$$/p$h.height,p$Y=p$S._matrix;this._curMat.copyTo(p$Y),1!=p$B&&1!=p$r&&p$Y.scale(p$B,p$r);var p$C=p$Y.tx,p$U=p$Y.ty;p$Y.tx=p$Y.ty=0,p$Y.transformPoint(p$J.TEMP.setTo(p$q,p$f)),p$Y.translate(p$J.TEMP.x+p$C,p$J.TEMP.y+p$U),this._curSubmit=p$Ph.RENDERBASE}p$t.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=p$P._targets?"yellow":"green",this.strokeRect(p$q-1,p$f-1,p$g+2,p$$+2,1),this.strokeRect(p$q,p$f,p$g,p$$,1),this.restore())},p$q.drawTarget=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){void 0===p$Y&&(p$Y=-1);var p$C=this._vb;if(p$lh.fillRectImgVb(p$C,this._clipRect,p$q,p$f,p$g,p$$,p$r||p$M.DEF_UV,p$P||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var p$U=this._curSubmit=p$Uh.create(this,this._ib,p$C,(p$C._byteLength-64)/32*3,p$B,p$S);p$U.blendType=-1==p$Y?this._nBlendType:p$Y,p$U.scope=p$h,this._submits[this._submits._length++]=p$U,this._curSubmit._numEle+=6}},p$q.mixRGBandAlpha=function(p$h){return this._mixRGBandAlpha(p$h,this._shader2D.ALPHA)},p$q._mixRGBandAlpha=function(p$h,p$q){var p$f=(4278190080&p$h)>>>24;return 0!=p$f?p$f*=p$q:p$f=255*p$q,16777215&p$h|p$f<<24},p$q.drawTriangles=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){if(!p$h.loaded||!p$h.source)return this.sprite&&p$R.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;p$h.bitmap;var p$C=this._mixRGBandAlpha(4294967295,p$B),p$U=(p$g.length,p$P.length);this._renderKey=-1;var p$u=this._curSubmit=p$ch.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,p$Xh.create(1,0));return p$u.shaderValue.textureHost=p$h,p$u._renderType=10016,this._submits[this._submits._length++]=p$u,p$S?(p$k._tmpMatrix.a=p$S.a,p$k._tmpMatrix.b=p$S.b,p$k._tmpMatrix.c=p$S.c,p$k._tmpMatrix.d=p$S.d,p$k._tmpMatrix.tx=p$S.tx+p$q,p$k._tmpMatrix.ty=p$S.ty+p$f,p$n.mul(p$k._tmpMatrix,this._curMat,p$k._tmpMatrix)):(p$k._tmpMatrix.a=this._curMat.a,p$k._tmpMatrix.b=this._curMat.b,p$k._tmpMatrix.c=this._curMat.c,p$k._tmpMatrix.d=this._curMat.d,p$k._tmpMatrix.tx=this._curMat.tx+p$q,p$k._tmpMatrix.ty=this._curMat.ty+p$f),this._triangleMesh.addData(p$g,p$$,p$P,p$k._tmpMatrix,p$C,this),this._curSubmit._numEle+=p$U,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},p$q.transform=function(p$h,p$q,p$f,p$g,p$$,p$P){p$o.save(this),p$n.mul(p$n.TEMP.setTo(p$h,p$q,p$f,p$g,p$$,p$P),this._curMat,this._curMat),this._curMat._checkTransform()},p$q.setTransformByMatrix=function(p$h){p$h.copyTo(this._curMat)},p$q.transformByMatrix=function(p$h){p$o.save(this),p$n.mul(p$h,this._curMat,this._curMat),this._curMat._checkTransform()},p$q.rotate=function(p$h){p$o.save(this),this._curMat.rotateEx(p$h)},p$q.scale=function(p$h,p$q){p$o.save(this),this._curMat.scaleEx(p$h,p$q)},p$q.clipRect=function(p$h,p$q,p$f,p$g){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var p$$=p$Ch.create(4);this.addRenderObject(p$$);var p$P=this._vb,p$S=p$P._byteLength>>2;if(p$lh.fillRectImgVb(p$P,null,p$h,p$q,p$f,p$g,p$M.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var p$B=this._curSubmit=p$Ph.createSubmit(this,this._ib,p$P,(p$P._byteLength-64)/32*3,p$Xh.create(2,0));p$B.shaderValue.ALPHA=1,this._submits[this._submits._length++]=p$B,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var p$r=p$Ch.create(5);this.addRenderObject(p$r);var p$Y=p$P.getFloat32Array(),p$C=Math.min(Math.min(Math.min(p$Y[0+p$S],p$Y[4+p$S]),p$Y[8+p$S]),p$Y[12+p$S]),p$U=Math.max(Math.max(Math.max(p$Y[0+p$S],p$Y[4+p$S]),p$Y[8+p$S]),p$Y[12+p$S]),p$u=Math.min(Math.min(Math.min(p$Y[1+p$S],p$Y[5+p$S]),p$Y[9+p$S]),p$Y[13+p$S]),p$v=Math.max(Math.max(Math.max(p$Y[1+p$S],p$Y[5+p$S]),p$Y[9+p$S]),p$Y[13+p$S]);p$Z.save(this,p$r,p$h,p$q,p$f,p$g,p$C,p$u,p$U-p$C,p$v-p$u),this._curSubmit=p$Ph.RENDERBASE}else{p$f*=this._curMat.a,p$g*=this._curMat.d;var p$L=p$J.TEMP;this._curMat.transformPoint(p$L.setTo(p$h,p$q)),p$f<0&&(p$L.x=p$L.x+p$f,p$f=-p$f),p$g<0&&(p$L.y=p$L.y+p$g,p$g=-p$g),this._renderKey=0;var p$e=this._curSubmit=p$Yh.create(this);(this._submits[this._submits._length++]=p$e).submitIndex=this._submits._length,p$e.submitLength=9999999,p$F.save(this,p$e);var p$l=this._clipRect,p$_=p$l.x,p$N=p$l.y,p$G=p$L.x+p$f,p$m=p$L.y+p$g;p$_<p$L.x&&(p$l.x=p$L.x),p$N<p$L.y&&(p$l.y=p$L.y),p$l.width=Math.min(p$G,p$_+p$l.width)-p$l.x,p$l.height=Math.min(p$m,p$N+p$l.height)-p$l.y,this._shader2D.glTexture=null,p$e.clipRect.copyFrom(p$l),this._curSubmit=p$Ph.RENDERBASE}},p$q.setIBVB=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C){if(void 0===p$r&&(p$r=0),void 0===p$Y&&(p$Y=0),void 0===p$C&&(p$C=0),null===p$f){if(p$_.isFlash){var p$U=p$g;p$U._selfIB||(p$U._selfIB=p$xh.create(35044)),p$U._selfIB.clear(),p$f=p$U._selfIB}else p$f=this._ib;p$lh.expandIBQuadrangle(p$f,p$g._byteLength/(4*p$g.vertexStride*4))}if(!p$B||!p$S)throw Error("setIBVB must input:shader shaderValues");var p$u=p$rh.create(this,p$g,p$f,p$$,p$S,p$B,p$r,p$Y,p$C);p$P||(p$P=p$n.EMPTY),p$P.translate(p$h,p$q),p$n.mul(p$P,this._curMat,p$u._mat),p$P.translate(-p$h,-p$q),this._submits[this._submits._length++]=p$u,this._curSubmit=p$Ph.RENDERBASE,this._renderKey=0},p$q.addRenderObject=function(p$h){this._submits[this._submits._length++]=p$h},p$q.fillTrangles=function(p$h,p$q,p$f,p$g,p$$){var p$P=this._curSubmit,p$S=this._vb,p$B=this._shader2D,p$r=p$P.shaderValue,p$Y=p$g.length>>4,p$C=p$h.bitmap;this._renderKey=0,p$B.glTexture==p$C&&p$B.ALPHA===p$r.ALPHA||((p$P=this._curSubmit=p$Ph.createSubmit(this,this._ib,p$S,p$S._byteLength/32*3,p$Xh.create(1,0))).shaderValue.textureHost=p$h,this._submits[this._submits._length++]=p$P),p$lh.fillTranglesVB(p$S,p$q,p$f,p$g,p$$||this._curMat,this._x,this._y),p$P._numEle+=6*p$Y},p$q.submitElement=function(p$h,p$q){var p$f=this._submits;for(p$q<0&&(p$q=p$f._length);p$h<p$q;)p$h+=p$f[p$h].renderSubmit()},p$q.finish=function(){p$mh.mainContext.finish()},p$q.flush=function(){var p$h=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(p$h>this._ib.bufferLength/12&&p$lh.expandIBQuadrangle(this._ib,p$h),!this._isMain&&p$H.enabled&&p$H._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=p$H._atlasRestore;for(var p$q=this._submits,p$f=0,p$g=p$q._length;p$f<p$g;p$f++){var p$$=p$q[p$f];10016===p$$.getRenderType()&&p$$.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),p$qh.instance&&p$qh.getInstance().reset();var p$P;for(p$f=0,p$P=this.meshlist.length;p$f<p$P;p$f++){var p$S=this.meshlist[p$f];p$S.canReuse?p$S.releaseMesh():p$S.destroy()}return this.meshlist.length=0,this._curSubmit=p$Ph.RENDERBASE,this._renderKey=0,this._triangleMesh=p$Mh.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},p$q.setPathId=function(p$h){if(this.mId=p$h,-1!=this.mId){this.mHaveKey=!1;var p$q=p$T.getInstance();p$q.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,p$q.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},p$q.movePath=function(p$h,p$q){var p$f=p$h,p$g=p$q;p$h=this._curMat.a*p$f+this._curMat.c*p$g+this._curMat.tx,p$q=this._curMat.b*p$f+this._curMat.d*p$g+this._curMat.ty,this.mX+=p$h,this.mY+=p$q},p$q.beginPath=function(){var p$h=this._getPath();p$h.tempArray.length=0,p$h.closePath=!1,this.mX=0,this.mY=0},p$q.closePath=function(){this._path.closePath=!0},p$q.fill=function(p$h){void 0===p$h&&(p$h=!1);var p$q=this._getPath();this.drawPoly(0,0,p$q.tempArray,this.fillStyle._color.numColor,0,0,p$h)},p$q.stroke=function(){var p$h=this._getPath();if(0<this.lineWidth){if(-1==this.mId)p$h.drawLine(0,0,p$h.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var p$q=p$T.getInstance().shapeLineDic[this.mId];p$q.rebuild(p$h.tempArray),p$h.setGeomtry(p$q)}else p$T.getInstance().addLine(this.mId,p$h.drawLine(0,0,p$h.tempArray,this.lineWidth,this.strokeStyle._color.numColor));p$h.update();var p$f=[this.mX,this.mY],p$g=p$Ph.createShape(this,p$h.ib,p$h.vb,p$h.count,p$h.offset,p$Xh.create(4,0));p$g.shaderValue.ALPHA=this._shader2D.ALPHA,p$g.shaderValue.u_pos=p$f,p$g.shaderValue.u_mmat2=p$Nh.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=p$g,this._renderKey=-1}},p$q.line=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=this._curSubmit,p$B=this._vb;if(p$lh.fillLineVb(p$B,this._clipRect,p$h,p$q,p$f,p$g,p$$,p$P)){this._renderKey=0;var p$r=this._shader2D,p$Y=p$S.shaderValue;p$r.strokeStyle===p$Y.strokeStyle&&p$r.ALPHA===p$Y.ALPHA||(p$r.glTexture=null,(p$S=this._curSubmit=p$Ph.createSubmit(this,this._ib,p$B,(p$B._byteLength-64)/32*3,p$Xh.create(2,0))).shaderValue.strokeStyle=p$r.strokeStyle,p$S.shaderValue.mainID=2,p$S.shaderValue.ALPHA=p$r.ALPHA,this._submits[this._submits._length++]=p$S),p$S._numEle+=6}},p$q.moveTo=function(p$h,p$q,p$f){void 0===p$f&&(p$f=!0);var p$g=this._getPath();if(p$f){var p$$=p$h,p$P=p$q;p$h=this._curMat.a*p$$+this._curMat.c*p$P,p$q=this._curMat.b*p$$+this._curMat.d*p$P}p$g.addPoint(p$h,p$q)},p$q.lineTo=function(p$h,p$q,p$f){void 0===p$f&&(p$f=!0);var p$g=this._getPath();if(p$f){var p$$=p$h,p$P=p$q;p$h=this._curMat.a*p$$+this._curMat.c*p$P,p$q=this._curMat.b*p$$+this._curMat.d*p$P}p$g.addPoint(p$h,p$q)},p$q.drawCurves=function(p$h,p$q,p$f){this.setPathId(-1),this.beginPath(),this.strokeStyle=p$f[3],this.lineWidth=p$f[4];var p$g=p$f[2];p$h+=p$f[0],p$q+=p$f[1],this.movePath(p$h,p$q),this.moveTo(p$g[0],p$g[1]);for(var p$$=2,p$P=p$g.length;p$$<p$P;)this.quadraticCurveTo(p$g[p$$++],p$g[p$$++],p$g[p$$++],p$g[p$$++]);this.stroke()},p$q.arcTo=function(p$h,p$q,p$f,p$g,p$$){if(-1==this.mId||!this.mHaveKey){var p$P=0,p$S=0,p$B=0,p$r=this._getPath();this._curMat.copyTo(p$k._tmpMatrix),p$k._tmpMatrix.tx=p$k._tmpMatrix.ty=0,p$k._tempPoint.setTo(p$r.getEndPointX(),p$r.getEndPointY()),p$k._tmpMatrix.invertTransformPoint(p$k._tempPoint);var p$Y=p$k._tempPoint.x-p$h,p$C=p$k._tempPoint.y-p$q,p$U=Math.sqrt(p$Y*p$Y+p$C*p$C);if(!(p$U<=1e-6)){var p$u=p$Y/p$U,p$v=p$C/p$U,p$L=p$f-p$h,p$e=p$g-p$q,p$l=p$L*p$L+p$e*p$e,p$_=Math.sqrt(p$l);if(!(p$_<=1e-6)){var p$N=p$L/p$_,p$G=p$e/p$_,p$m=p$u+p$N,p$E=p$v+p$G,p$R=Math.sqrt(p$m*p$m+p$E*p$E);if(!(p$R<=1e-6)){var p$t=p$m/p$R,p$X=p$E/p$R,p$n=Math.acos(p$t*p$u+p$X*p$v),p$J=Math.PI/2-p$n,p$p=(p$U=p$$/Math.tan(p$J))*p$u+p$h,p$A=p$U*p$v+p$q,p$d=Math.sqrt(p$U*p$U+p$$*p$$),p$b=p$h+p$t*p$d,p$i=p$q+p$X*p$d,p$z=0,p$c=0;if(0<=p$u*p$G-p$v*p$N){var p$M=2*p$J/p$k.SEGNUM;p$z=Math.sin(p$M),p$c=Math.cos(p$M)}else p$M=2*-p$J/p$k.SEGNUM,p$z=Math.sin(p$M),p$c=Math.cos(p$M);p$S=this._curMat.a*p$p+this._curMat.c*p$A,p$B=this._curMat.b*p$p+this._curMat.d*p$A,p$S==this._path.getEndPointX()&&p$B==this._path.getEndPointY()||p$r.addPoint(p$S,p$B);var p$W=p$p-p$b,p$T=p$A-p$i;for(p$P=0;p$P<p$k.SEGNUM;p$P++){var p$I=p$W*p$c+p$T*p$z,p$w=-p$W*p$z+p$T*p$c;p$S=p$I+p$b,p$B=p$w+p$i,p$h=this._curMat.a*p$S+this._curMat.c*p$B,p$B=p$q=this._curMat.b*p$S+this._curMat.d*p$B,(p$S=p$h)==this._path.getEndPointX()&&p$B==this._path.getEndPointY()||p$r.addPoint(p$S,p$B),p$W=p$I,p$T=p$w}}}}}},p$q.arc=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){if(void 0===p$P&&(p$P=!1),void 0===p$S&&(p$S=!0),-1!=this.mId){var p$B=p$T.getInstance().shapeDic[this.mId];if(p$B&&this.mHaveKey&&!p$B.needUpdate(this._curMat))return;p$q=p$h=0}var p$r,p$Y=0,p$C=0,p$U=0,p$u=0,p$v=0,p$L=0,p$e=0;if(p$C=p$$-p$g,p$P)if(Math.abs(p$C)>=2*Math.PI)p$C=2*-Math.PI;else for(;0<p$C;)p$C-=2*Math.PI;else if(Math.abs(p$C)>=2*Math.PI)p$C=2*Math.PI;else for(;p$C<0;)p$C+=2*Math.PI;p$r=p$C/(p$e=p$f<101?Math.max(10,p$C*p$f/5):p$f<201?Math.max(10,p$C*p$f/20):Math.max(10,p$C*p$f/40))/2,p$U=Math.abs(4/3*(1-Math.cos(p$r))/Math.sin(p$r)),p$P&&(p$U=-p$U);var p$l=this._getPath(),p$_=NaN,p$N=NaN;for(p$L=0;p$L<=p$e;p$L++)p$Y=p$g+p$C*(p$L/p$e),p$u=p$h+Math.cos(p$Y)*p$f,p$v=p$q+Math.sin(p$Y)*p$f,p$S&&(p$_=p$u,p$N=p$v,p$u=this._curMat.a*p$_+this._curMat.c*p$N,p$v=this._curMat.b*p$_+this._curMat.d*p$N),p$u==this._path.getEndPointX()&&p$v==this._path.getEndPointY()||p$l.addPoint(p$u,p$v);p$u=p$h+Math.cos(p$$)*p$f,p$v=p$q+Math.sin(p$$)*p$f,p$S&&(p$_=p$u,p$N=p$v,p$u=this._curMat.a*p$_+this._curMat.c*p$N,p$v=this._curMat.b*p$_+this._curMat.d*p$N),p$u==this._path.getEndPointX()&&p$v==this._path.getEndPointY()||p$l.addPoint(p$u,p$v)},p$q.quadraticCurveTo=function(p$h,p$q,p$f,p$g){var p$$=p$U.I,p$P=p$f,p$S=p$g;p$f=this._curMat.a*p$P+this._curMat.c*p$S,p$g=this._curMat.b*p$P+this._curMat.d*p$S,p$P=p$h,p$S=p$q,p$h=this._curMat.a*p$P+this._curMat.c*p$S,p$q=this._curMat.b*p$P+this._curMat.d*p$S;for(var p$B=p$$.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),p$h,p$q,p$f,p$g],30,2),p$r=0,p$Y=p$B.length/2;p$r<p$Y;p$r++)this.lineTo(p$B[2*p$r],p$B[2*p$r+1],!1);this.lineTo(p$f,p$g,!1)},p$q.rect=function(p$h,p$q,p$f,p$g){this._other=this._other.make(),this._other.path||(this._other.path=new p$K),this._other.path.rect(p$h,p$q,p$f,p$g)},p$q.strokeRect=function(p$h,p$q,p$f,p$g,p$$){var p$P=.5*p$$;this.line(p$h-p$P,p$q,p$h+p$f+p$P,p$q,p$$,this._curMat),this.line(p$h+p$f,p$q,p$h+p$f,p$q+p$g,p$$,this._curMat),this.line(p$h,p$q,p$h,p$q+p$g,p$$,this._curMat),this.line(p$h-p$P,p$q+p$g,p$h+p$f+p$P,p$q+p$g,p$$,this._curMat)},p$q.clip=function(){},p$q.drawPoly=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){void 0===p$S&&(p$S=!1),this._renderKey=0,this._shader2D.glTexture=null;var p$B=this._getPath();if(-1==this.mId)p$B.polygon(p$h,p$q,p$f,p$g,p$$||1,p$P);else if(this.mHaveKey){var p$r=p$T.getInstance().shapeDic[this.mId];p$r.setMatrix(this._curMat),p$r.rebuild(p$B.tempArray),p$B.setGeomtry(p$r)}else{var p$Y=p$B.polygon(p$h,p$q,p$f,p$g,p$$||1,p$P);p$T.getInstance().addShape(this.mId,p$Y),p$Y.setMatrix(this._curMat)}p$B.update();var p$C,p$U=[this.mX,this.mY];if((p$C=p$Ph.createShape(this,p$B.ib,p$B.vb,p$B.count,p$B.offset,p$Xh.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,p$C.shaderValue.u_pos=p$U,p$C.shaderValue.u_mmat2=p$Nh.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=p$C,0<p$$){if(this.mHaveLineKey){var p$u=p$T.getInstance().shapeLineDic[this.mId];p$u.rebuild(p$B.tempArray),p$B.setGeomtry(p$u)}else p$T.getInstance().addShape(this.mId,p$B.drawLine(p$h,p$q,p$f,p$$,p$P));p$B.update(),(p$C=p$Ph.createShape(this,p$B.ib,p$B.vb,p$B.count,p$B.offset,p$Xh.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,p$C.shaderValue.u_mmat2=p$Nh.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=p$C}},p$q.drawParticle=function(p$h,p$q,p$f){p$f.x=p$h,p$f.y=p$q,this._submits[this._submits._length++]=p$f},p$q._getPath=function(){return this._path||(this._path=new p$K)},p$g(0,p$q,"globalCompositeOperation",function(){return p$s.NAMES[this._nBlendType]},function(p$h){var p$q=p$s.TOINT[p$h];null==p$q||this._nBlendType===p$q||(p$y.save(this,65536,this,!0),this._curSubmit=p$Ph.RENDERBASE,this._renderKey=0,this._nBlendType=p$q)}),p$g(0,p$q,"strokeStyle",function(){return this._shader2D.strokeStyle},function(p$h){this._shader2D.strokeStyle.equal(p$h)||(p$y.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=p$V.create(p$h))}),p$g(0,p$q,"globalAlpha",function(){return this._shader2D.ALPHA},function(p$h){(p$h=Math.floor(1e3*p$h)/1e3)!=this._shader2D.ALPHA&&(p$y.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=p$h)}),p$g(0,p$q,"asBitmap",null,function(p$h){if(p$h){if(this._targets||(this._targets=new p$j),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),p$g(0,p$q,"fillStyle",function(){return this._shader2D.fillStyle},function(p$h){this._shader2D.fillStyle.equal(p$h)||(p$y.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=p$V.create(p$h))}),p$g(0,p$q,"textAlign",function(){return this._other.textAlign},function(p$h){this._other.textAlign===p$h||(this._other=this._other.make(),p$y.save(this,32768,this._other,!1),this._other.textAlign=p$h)}),p$g(0,p$q,"lineWidth",function(){return this._other.lineWidth},function(p$h){this._other.lineWidth===p$h||(this._other=this._other.make(),p$y.save(this,256,this._other,!1),this._other.lineWidth=p$h)}),p$g(0,p$q,"textBaseline",function(){return this._other.textBaseline},function(p$h){this._other.textBaseline===p$h||(this._other=this._other.make(),p$y.save(this,16384,this._other,!1),this._other.textBaseline=p$h)}),p$g(0,p$q,"font",null,function(p$h){p$h!=this._other.font.toString()&&(this._other=this._other.make(),p$y.save(this,8,this._other,!1),this._other.font===p$Lh.EMPTY?this._other.font=new p$Lh(p$h):this._other.font.setFont(p$h))}),p$k.__init__=function(){p$f.DEFAULT=new p$f},p$k._tempPoint=new p$J,p$k._SUBMITVBSIZE=32e3,p$k._MAXSIZE=99999999,p$k._RECTVBSIZE=16,p$k.MAXCLIPRECT=new p$p(0,0,99999999,99999999),p$k._COUNT=0,p$k._tmpMatrix=new p$n,p$k.SEGNUM=32,p$k._contextcount=0,p$S(p$k,["_fontTemp",function(){return this._fontTemp=new p$Lh},"_drawStyleTemp",function(){return this._drawStyleTemp=new p$V(null)}]),p$k.__init$=function(){p$f=function(){function p$h(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=p$Lh.EMPTY}p$u(p$h,"");var p$q=p$h.prototype;return p$q.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=p$Lh.EMPTY},p$q.make=function(){return this===p$h.DEFAULT?new p$h:this},p$h.DEFAULT=null,p$h}()},p$k}(),p$Xh=function(p$h){function p$g(p$h,p$q){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,p$g.__super.call(this),this.defines=new p$Ah,this.position=p$g._POSITION,this.mainID=p$h,this.subID=p$q,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=p$h|p$q,this._inClassCache=p$g._cache[this._cacheID],0<p$h&&!this._inClassCache&&(this._inClassCache=p$g._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}p$u(p$g,"laya.webgl.shader.d2.value.Value2D",p$w);var p$q=p$g.prototype;return p$q.setValue=function(p$h){},p$q.refresh=function(){var p$h=this.size;return p$h[0]=p$Nh.width,p$h[1]=p$Nh.height,this.alpha=this.ALPHA*p$Nh.worldAlpha,this.mmat=p$Nh.worldMatrix4,this},p$q._ShaderWithCompile=function(){return p$Qh.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,p$jh.create)},p$q._withWorldShaderDefines=function(){var p$h=p$Nh.worldShaderDefines,p$q=p$Qh.sharders[this.mainID|this.defines._value|p$h.getValue()];if(!p$q){var p$f,p$g={};for(p$f in this.defines.toNameDic())p$g[p$f]="";for(p$f in p$h.toNameDic())p$g[p$f]="";p$q=p$Qh.withCompile2D(0,this.mainID,p$g,this.mainID|this.defines._value|p$h.getValue(),p$jh.create)}var p$$=p$Nh.worldFilters;if(!p$$)return p$q;for(var p$P,p$S=p$$.length,p$B=0;p$B<p$S;p$B++)(p$P=p$$[p$B])&&p$P.action.setValue(this);return p$q},p$q.upload=function(){var p$h=p$Nh;this.alpha=this.ALPHA*p$h.worldAlpha,p$Nh.worldMatrix4!==p$Nh.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),p$mh.shaderHighPrecision&&this.defines.add(1024);var p$q,p$f=p$h.worldShaderDefines?this._withWorldShaderDefines():p$Qh.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=p$h.width,this.size[1]=p$h.height,this.mmat=p$h.worldMatrix4,p$Wh.activeShader!==p$f?p$f._shaderValueWidth!==p$h.width||p$f._shaderValueHeight!==p$h.height?(p$f._shaderValueWidth=p$h.width,p$f._shaderValueHeight=p$h.height):p$q=p$f._params2dQuick2||p$f._make2dQuick2():p$f._shaderValueWidth!==p$h.width||p$f._shaderValueHeight!==p$h.height?(p$f._shaderValueWidth=p$h.width,p$f._shaderValueHeight=p$h.height):p$q=p$f._params2dQuick1||p$f._make2dQuick1(),p$f.upload(this,p$q)},p$q.setFilters=function(p$h){if(this.filters=p$h)for(var p$q,p$f=p$h.length,p$g=0;p$g<p$f;p$g++)(p$q=p$h[p$g])&&(this.defines.add(p$q.type),p$q.action.setValue(this))},p$q.clear=function(){this.defines.setValue(this.subID)},p$q.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},p$g._initone=function(p$h,p$q){p$g._typeClass[p$h]=p$q,p$g._cache[p$h]=[],p$g._cache[p$h]._length=0},p$g.__init__=function(){p$g._POSITION=[2,5126,!1,4*p$eh.BYTES_PE,0],p$g._TEXCOORD=[2,5126,!1,4*p$eh.BYTES_PE,2*p$eh.BYTES_PE],p$g._initone(2,p$kh),p$g._initone(4,p$sh),p$g._initone(256,p$Hh),p$g._initone(512,p$wh),p$g._initone(1,p$Dh),p$g._initone(65,p$Oh),p$g._initone(9,p$Dh)},p$g.create=function(p$h,p$q){var p$f=p$g._cache[p$h|p$q];return p$f._length?p$f[--p$f._length]:new p$g._typeClass[p$h|p$q](p$q)},p$g._POSITION=null,p$g._TEXCOORD=null,p$g._cache=[],p$g._typeClass=[],p$g.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p$g}(),p$nh=function(p$h){function p$l(p$h,p$q){p$l.__super.call(this,p$h,p$q)}p$u(p$l,"laya.webgl.utils.RenderSprite3D",p$N);var p$q=p$l.prototype;return p$q.onCreate=function(p$h){switch(p$h){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},p$q._mask=function(p$h,p$q,p$f,p$g){var p$$,p$P,p$S=this._next,p$B=p$h.mask;if(p$B){p$q.ctx.save();var p$r=p$q.ctx.globalCompositeOperation,p$Y=new p$p;if(p$Y.copyFrom(p$B.getBounds()),p$Y.width=Math.round(p$Y.width),p$Y.height=Math.round(p$Y.height),p$Y.x=Math.round(p$Y.x),p$Y.y=Math.round(p$Y.y),0<p$Y.width&&0<p$Y.height){var p$C=p$h._style._tf,p$U=p$Bh.create();p$U.addValue("bounds",p$Y),p$$=p$Sh.create([p$U,p$q],laya.webgl.utils.RenderSprite3D.tmpTarget),p$q.addRenderObject(p$$),p$B.render(p$q,-p$Y.x,-p$Y.y),p$$=p$Sh.create([p$U],laya.webgl.utils.RenderSprite3D.endTmpTarget),p$q.addRenderObject(p$$),p$q.ctx.save(),p$q.clipRect(p$f-p$C.translateX+p$Y.x,p$g-p$C.translateY+p$Y.y,p$Y.width,p$Y.height),p$S._fun.call(p$S,p$h,p$q,p$f,p$g),p$q.ctx.restore(),p$P=p$Ch.create(6),p$r=p$q.ctx.globalCompositeOperation,p$P.blendMode="mask",p$q.addRenderObject(p$P),p$n.TEMP.identity();var p$u=p$Xh.create(1,0),p$v=p$M.INV_UV,p$L=p$Y.width,p$e=p$Y.height;(p$Y.width<32||p$Y.height<32)&&((p$v=p$l.tempUV)[0]=0,p$v[1]=0,p$v[2]=32<=p$Y.width?1:p$Y.width/32,p$v[3]=0,p$v[4]=32<=p$Y.width?1:p$Y.width/32,p$v[5]=32<=p$Y.height?1:p$Y.height/32,p$v[6]=0,p$v[7]=32<=p$Y.height?1:p$Y.height/32,p$Y.width=32<=p$Y.width?p$Y.width:32,p$Y.height=32<=p$Y.height?p$Y.height:32,p$v[1]*=-1,p$v[3]*=-1,p$v[5]*=-1,p$v[7]*=-1,p$v[1]+=1,p$v[3]+=1,p$v[5]+=1,p$v[7]+=1),p$q.ctx.drawTarget(p$U,p$f+p$Y.x-p$C.translateX,p$g+p$Y.y-p$C.translateY,p$L,p$e,p$n.TEMP,"tmpTarget",p$u,p$v,6),p$$=p$Sh.create([p$U],laya.webgl.utils.RenderSprite3D.recycleTarget),p$q.addRenderObject(p$$),(p$P=p$Ch.create(6)).blendMode=p$r,p$q.addRenderObject(p$P)}p$q.ctx.restore()}else p$S._fun.call(p$S,p$h,p$q,p$f,p$g)},p$q._blend=function(p$h,p$q,p$f,p$g){var p$$=p$h._style,p$P=this._next;p$$.blendMode?(p$q.ctx.save(),p$q.ctx.globalCompositeOperation=p$$.blendMode,p$P._fun.call(p$P,p$h,p$q,p$f,p$g),p$q.ctx.restore()):p$P._fun.call(p$P,p$h,p$q,p$f,p$g)},p$q._transform=function(p$h,p$q,p$f,p$g){var p$$=p$h.transform,p$P=this._next;if(p$$&&p$P!=p$N.NORENDER){var p$S=p$q.ctx;p$h._style;p$$.tx=p$f,p$$.ty=p$g;var p$B=p$S._getTransformMatrix(),p$r=p$B.clone();p$n.mul(p$$,p$B,p$B),p$B._checkTransform(),p$$.tx=p$$.ty=0,p$P._fun.call(p$P,p$h,p$q,0,0),p$r.copyTo(p$B),p$r.destroy()}else p$P._fun.call(p$P,p$h,p$q,p$f,p$g)},p$l.tmpTarget=function(p$h,p$q){var p$f=p$h.getValue("bounds"),p$g=p$Th.create(p$f.width,p$f.height);p$g.start(),p$g.clear(0,0,0,0),p$h.addValue("tmpTarget",p$g)},p$l.endTmpTarget=function(p$h){p$h.getValue("tmpTarget").end()},p$l.recycleTarget=function(p$h){p$h.getValue("tmpTarget").recycle(),p$h.recycle()},p$S(p$l,["tempUV",function(){return this.tempUV=new Array(8)}]),p$l}(),p$Jh=function(p$h){function p$q(){this.data=null,p$q.__super.call(this)}p$u(p$q,"laya.filters.webgl.ColorFilterActionGL",p$I);var p$f=p$q.prototype;return p$R.imps(p$f,{"laya.filters.IFilterActionGL":!0}),p$f.setValue=function(p$h){p$h.colorMat=this.data._mat,p$h.colorAlpha=this.data._alpha},p$f.apply3d=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$h.getValue("bounds"),p$S=p$Xh.create(1,0);p$S.setFilters([this.data]);var p$B=p$n.TEMP;p$B.identity(),p$f.ctx.drawTarget(p$h,0,0,p$P.width,p$P.height,p$B,"src",p$S)},p$q}(),p$ph=function(p$h){function p$P(p$h,p$q,p$f,p$g,p$$){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,p$P.__super.call(this,p$h,p$q,p$$),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new p$Vh,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=p$f,this._atlasCanvas.height=p$g,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}p$u(p$P,"laya.webgl.atlas.Atlaser",p$k);var p$q=p$P.prototype;return p$q.computeUVinAtlasTexture=function(p$h,p$q,p$f,p$g){var p$$=p$H.atlasTextureWidth,p$P=p$H.atlasTextureHeight,p$S=p$f/p$$,p$B=p$g/p$P,p$r=(p$f+p$h.bitmap.width)/p$$,p$Y=(p$g+p$h.bitmap.height)/p$P,p$C=p$h.bitmap.width/p$$,p$U=p$h.bitmap.height/p$P;p$h.uv=[p$S+p$q[0]*p$C,p$B+p$q[1]*p$U,p$r-(1-p$q[2])*p$C,p$B+p$q[3]*p$U,p$r-(1-p$q[4])*p$C,p$Y-(1-p$q[5])*p$U,p$S+p$q[6]*p$C,p$Y-(1-p$q[7])*p$U]},p$q.findBitmapIsExist=function(p$h){if(p$h instanceof laya.webgl.resource.WebGLImage){var p$q=p$h,p$f=p$q.url,p$g=this._InAtlasWebGLImagesKey[p$f||p$q.id];if(p$g)return p$g.offsetInfoID}return-1},p$q.addToAtlasTexture=function(p$h,p$q,p$f){if(p$h instanceof laya.webgl.resource.WebGLImage){var p$g=p$h,p$$=p$g.url;this._InAtlasWebGLImagesKey[p$$||p$g.id]={bitmap:p$h,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([p$q,p$f])}this._atlasCanvas.texSubImage2D(p$q,p$f,p$h.atlasSource),p$h.clearAtlasSource()},p$q.addToAtlas=function(p$h,p$q,p$f){p$h._atlasID=this._inAtlasTextureKey.length;var p$g=p$h.uv.slice(),p$$=p$h.bitmap;this._inAtlasTextureKey.push(p$h),this._inAtlasTextureOriUVValue.push(p$g),this._inAtlasTextureBitmapValue.push(p$$),this.computeUVinAtlasTexture(p$h,p$g,p$q,p$f),p$h.bitmap=this._atlasCanvas},p$q.clear=function(){for(var p$h=0,p$q=this._inAtlasTextureKey.length;p$h<p$q;p$h++)this._inAtlasTextureKey[p$h].bitmap=this._inAtlasTextureBitmapValue[p$h],this._inAtlasTextureKey[p$h].uv=this._inAtlasTextureOriUVValue[p$h],this._inAtlasTextureKey[p$h]._atlasID=-1,this._inAtlasTextureKey[p$h].bitmap.lock=!1,this._inAtlasTextureKey[p$h].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},p$q.dispose=function(){this.clear(),this._atlasCanvas.destroy()},p$g(0,p$q,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),p$g(0,p$q,"texture",function(){return this._atlasCanvas}),p$g(0,p$q,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),p$P}(),p$Ah=function(p$h){function p$f(){p$f.__super.call(this,p$f.__name2int,p$f.__int2name,p$f.__int2nameMap)}return p$u(p$f,"laya.webgl.shader.d2.ShaderDefines2D",p$a),p$f.__init__=function(){p$f.reg("TEXTURE2D",1),p$f.reg("COLOR2D",2),p$f.reg("PRIMITIVE",4),p$f.reg("GLOW_FILTER",8),p$f.reg("BLUR_FILTER",16),p$f.reg("COLOR_FILTER",32),p$f.reg("COLOR_ADD",64),p$f.reg("WORLDMAT",128),p$f.reg("FILLTEXTURE",256),p$f.reg("FSHIGHPRECISION",1024),p$f.reg("TXTALPHA",2048),p$f.reg("TXTCOMPRESS",4096)},p$f.reg=function(p$h,p$q){p$a._reg(p$h,p$q,p$f.__name2int,p$f.__int2name)},p$f.toText=function(p$h,p$q,p$f){return p$a._toText(p$h,p$q,p$f)},p$f.toInt=function(p$h){return p$a._toInt(p$h,p$f.__name2int)},p$f.TEXTURE2D=1,p$f.COLOR2D=2,p$f.PRIMITIVE=4,p$f.FILTERGLOW=8,p$f.FILTERBLUR=16,p$f.FILTERCOLOR=32,p$f.COLORADD=64,p$f.WORLDMAT=128,p$f.FILLTEXTURE=256,p$f.SKINMESH=512,p$f.SHADERDEFINE_FSHIGHPRECISION=1024,p$f.TXTALPHA=2048,p$f.TXTCOMPRESS=4096,p$f.__name2int={},p$f.__int2name=[],p$f.__int2nameMap=[],p$f}(),p$dh=(function(p$h){function p$B(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$B.__super.call(this,p$h,p$q,p$f,p$g,40,p$$,p$P,p$S)}p$u(p$B,"laya.webgl.shapes.Ellipse",p$fh)}(),function(p$h){function p$P(p$h,p$q,p$f,p$g,p$$){this._points=[],this.rebuild(p$f),p$P.__super.call(this,p$h,p$q,0,0,0,p$$,p$g,p$$,0)}p$u(p$P,"laya.webgl.shapes.Line",p$fh);var p$q=p$P.prototype;return p$q.rebuild=function(p$h){var p$q=p$h.length;p$q!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(p$q/2-1)),this.mFloat32Array=new Float32Array(5*p$q)),this._points.length=0;for(var p$f=NaN,p$g=NaN,p$$=-1,p$P=-1,p$S=p$h.length/2,p$B=0;p$B<p$S;p$B++)p$f=p$h[2*p$B],p$g=p$h[2*p$B+1],(.01<Math.abs(p$$-p$f)||.01<Math.abs(p$P-p$g))&&this._points.push(p$f,p$g),p$$=p$f,p$P=p$g},p$q.getData=function(p$h,p$q,p$f){var p$g=[],p$$=[];0<this.borderWidth&&this.createLine2(this._points,p$g,this.borderWidth,p$f,p$$,this._points.length/2),this.mUint16Array.set(p$g,0),this.mFloat32Array.set(p$$,0),p$h.append(this.mUint16Array),p$q.append(this.mFloat32Array)},p$P}()),p$bh=function(p$h){function p$U(p$h,p$q,p$f,p$g,p$$){this._points=[];for(var p$P=NaN,p$S=NaN,p$B=-1,p$r=-1,p$Y=p$f.length/2-1,p$C=0;p$C<p$Y;p$C++)p$P=p$f[2*p$C],p$S=p$f[2*p$C+1],(.01<Math.abs(p$B-p$P)||.01<Math.abs(p$r-p$S))&&this._points.push(p$P,p$S),p$B=p$P,p$r=p$S;p$P=p$f[2*p$Y],p$S=p$f[2*p$Y+1],p$B=this._points[0],p$r=this._points[1],(.01<Math.abs(p$B-p$P)||.01<Math.abs(p$r-p$S))&&this._points.push(p$P,p$S),p$U.__super.call(this,p$h,p$q,0,0,this._points.length/2,0,p$g,p$$)}p$u(p$U,"laya.webgl.shapes.LoopLine",p$fh);var p$q=p$U.prototype;return p$q.getData=function(p$h,p$q,p$f){if(0<this.borderWidth){for(var p$g=this.color,p$$=(p$g>>16&255)/255,p$P=(p$g>>8&255)/255,p$S=(255&p$g)/255,p$B=[],p$r=0,p$Y=0,p$C=[],p$U=Math.floor(this._points.length/2),p$u=0;p$u<p$U;p$u++)p$r=this._points[2*p$u],p$Y=this._points[2*p$u+1],p$B.push(this.x+p$r,this.y+p$Y,p$$,p$P,p$S);this.createLoopLine(p$B,p$C,this.borderWidth,p$f+p$B.length/5),p$h.append(new Uint16Array(p$C)),p$q.append(new Float32Array(p$B))}},p$q.createLoopLine=function(p$h,p$q,p$f,p$g,p$$,p$P){p$h.length;var p$S=p$h.concat(),p$B=p$$||p$h,p$r=this.borderColor,p$Y=(p$r>>16&255)/255,p$C=(p$r>>8&255)/255,p$U=(255&p$r)/255,p$u=[p$S[0],p$S[1]],p$v=[p$S[p$S.length-5],p$S[p$S.length-4]],p$L=p$v[0]+.5*(p$u[0]-p$v[0]),p$e=p$v[1]+.5*(p$u[1]-p$v[1]);p$S.unshift(p$L,p$e,0,0,0),p$S.push(p$L,p$e,0,0,0);var p$l,p$_,p$N,p$G,p$m,p$E,p$R,p$t,p$X,p$n,p$J,p$p,p$A,p$d,p$b,p$i,p$z,p$c,p$M,p$W,p$T=p$S.length/5,p$I=p$g,p$w=p$f/2;p$N=p$S[0],p$G=p$S[1],p$n=p$N-(p$m=p$S[5]),p$X=(p$X=-(p$G-(p$E=p$S[6])))/(p$W=Math.sqrt(p$X*p$X+p$n*p$n))*p$w,p$n=p$n/p$W*p$w,p$B.push(p$N-p$X,p$G-p$n,p$Y,p$C,p$U,p$N+p$X,p$G+p$n,p$Y,p$C,p$U);for(var p$k=1;p$k<p$T-1;p$k++)p$N=p$S[5*(p$k-1)],p$G=p$S[5*(p$k-1)+1],p$m=p$S[5*p$k],p$E=p$S[5*p$k+1],p$R=p$S[5*(p$k+1)],p$t=p$S[5*(p$k+1)+1],p$n=p$N-p$m,p$p=p$m-p$R,p$b=(-(p$X=(p$X=-(p$G-p$E))/(p$W=Math.sqrt(p$X*p$X+p$n*p$n))*p$w)+p$N)*(-(p$n=p$n/p$W*p$w)+p$E)-(-p$X+p$m)*(-p$n+p$G),p$c=(-(p$J=(p$J=-(p$E-p$t))/(p$W=Math.sqrt(p$J*p$J+p$p*p$p))*p$w)+p$R)*(-(p$p=p$p/p$W*p$w)+p$E)-(-p$J+p$m)*(-p$p+p$t),p$M=(p$A=-p$n+p$G-(-p$n+p$E))*(p$z=-p$J+p$m-(-p$J+p$R))-(p$i=-p$p+p$t-(-p$p+p$E))*(p$d=-p$X+p$m-(-p$X+p$N)),Math.abs(p$M)<.1?(p$M+=10.1,p$B.push(p$m-p$X,p$E-p$n,p$Y,p$C,p$U,p$m+p$X,p$E+p$n,p$Y,p$C,p$U)):(((p$l=(p$d*p$c-p$z*p$b)/p$M)-p$m)*(p$l-p$m)+((p$_=(p$i*p$b-p$A*p$c)/p$M)-p$E)+(p$_-p$E),p$B.push(p$l,p$_,p$Y,p$C,p$U,p$m-(p$l-p$m),p$E-(p$_-p$E),p$Y,p$C,p$U));p$P&&(p$q=p$P);var p$H=this.edges+1;for(p$k=1;p$k<p$H;p$k++)p$q.push(p$I+2*(p$k-1),p$I+2*(p$k-1)+1,p$I+2*p$k+1,p$I+2*p$k+1,p$I+2*p$k,p$I+2*(p$k-1));return p$q.push(p$I+2*(p$k-1),p$I+2*(p$k-1)+1,p$I+1,p$I+1,p$I,p$I+2*(p$k-1)),p$B},p$U}(),p$ih=function(p$h){function p$S(p$h,p$q,p$f,p$g,p$$,p$P){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=p$n.create(),this._points=p$f.slice(0,p$f.length),p$S.__super.call(this,p$h,p$q,0,0,this._points.length/2,p$g,p$$,p$P)}p$u(p$S,"laya.webgl.shapes.Polygon",p$fh);var p$q=p$S.prototype;return p$q.rebuild=function(p$h){this._repaint||(this._points.length=0,this._points=this._points.concat(p$h))},p$q.setMatrix=function(p$h){p$h.copyTo(this._mat)},p$q.needUpdate=function(p$h){return this._repaint=this._mat.a==p$h.a&&this._mat.b==p$h.b&&this._mat.c==p$h.c&&this._mat.d==p$h.d&&this._mat.tx==p$h.tx&&this._mat.ty==p$h.ty,!this._repaint},p$q.getData=function(p$h,p$q,p$f){var p$g,p$$=0,p$P=this._points,p$S=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=p$f){for(this._start=p$f,p$g=[],p$S=this.earcutTriangles.length,p$$=0;p$$<p$S;p$$++)p$g.push(this.earcutTriangles[p$$]+p$f);this.mUint16Array=new Uint16Array(p$g)}}else{this._start=p$f,p$g=[];var p$B=[],p$r=[],p$Y=this.color,p$C=(p$Y>>16&255)/255,p$U=(p$Y>>8&255)/255,p$u=(255&p$Y)/255;for(p$S=Math.floor(p$P.length/2),p$$=0;p$$<p$S;p$$++)p$B.push(this.x+p$P[2*p$$],this.y+p$P[2*p$$+1],p$C,p$U,p$u),p$r.push(this.x+p$P[2*p$$],this.y+p$P[2*p$$+1]);for(this.earcutTriangles=p$gh.earcut(p$r,null,2),p$S=this.earcutTriangles.length,p$$=0;p$$<p$S;p$$++)p$g.push(this.earcutTriangles[p$$]+p$f);this.mUint16Array=new Uint16Array(p$g),this.mFloat32Array=new Float32Array(p$B)}p$h.append(this.mUint16Array),p$q.append(this.mFloat32Array)},p$S}(),p$zh=function(p$h){function p$P(){this._matrix=new p$n,this._matrix4=p$eh.defaultMatrix4.concat(),p$P.__super.call(this,1e4),this.shaderValue=new p$Xh(0,0)}p$u(p$P,"laya.webgl.submit.SubmitCanvas",p$Ph);var p$q=p$P.prototype;return p$q.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var p$h=p$Nh.worldAlpha,p$q=p$Nh.worldMatrix4,p$f=p$Nh.worldMatrix,p$g=p$Nh.worldFilters,p$$=p$Nh.worldShaderDefines,p$P=this.shaderValue,p$S=this._matrix,p$B=this._matrix4,p$r=p$n.TEMP;return p$n.mul(p$S,p$f,p$r),p$B[0]=p$r.a,p$B[1]=p$r.b,p$B[4]=p$r.c,p$B[5]=p$r.d,p$B[12]=p$r.tx,p$B[13]=p$r.ty,p$Nh.worldMatrix=p$r.clone(),p$Nh.worldMatrix4=p$B,p$Nh.worldAlpha=p$Nh.worldAlpha*p$P.alpha,p$P.filters&&p$P.filters.length&&(p$Nh.worldFilters=p$P.filters,p$Nh.worldShaderDefines=p$P.defines),this._ctx_src.flush(),p$Nh.worldAlpha=p$h,p$Nh.worldMatrix4=p$q,p$Nh.worldMatrix.destroy(),p$Nh.worldMatrix=p$f,p$Nh.worldFilters=p$g,p$Nh.worldShaderDefines=p$$,1},p$q.releaseRender=function(){var p$h=p$P._cache;this._ctx_src=null,p$h[p$h._length++]=this},p$q.getRenderType=function(){return 10003},p$P.create=function(p$h,p$q,p$f){var p$g=p$P._cache._length?p$P._cache[--p$P._cache._length]:new p$P;p$g._ctx_src=p$h;var p$$=p$g.shaderValue;return p$$.alpha=p$q,p$$.defines.setValue(0),p$f&&p$f.length&&p$$.setFilters(p$f),p$g},p$P._cache=((p$P._cache=[])._length=0,p$P._cache),p$P}(),p$ch=function(p$h){function p$Y(p$h){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===p$h&&(p$h=1e4),p$Y.__super.call(this,p$h)}p$u(p$Y,"laya.webgl.submit.SubmitTexture",p$Ph);var p$q=p$Y.prototype;return p$q.releaseRender=function(){var p$h=p$Y._cache;(p$h[p$h._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},p$q.addTexture=function(p$h,p$q){this._texsID[this._texs.length]=p$h._uvID,this._texs.push(p$h),this._vbPos.push(p$q)},p$q.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var p$h=this.shaderValue.textureHost.bitmap;if(null!==p$h)for(var p$q=this._vb.getFloat32Array(),p$f=0,p$g=this._texs.length;p$f<p$g;p$f++){var p$$=this._texs[p$f];p$$.active();var p$P=p$$.uv;if(this._texsID[p$f]!==p$$._uvID){this._texsID[p$f]=p$$._uvID;var p$S=this._vbPos[p$f];p$q[p$S+2]=p$P[0],p$q[p$S+3]=p$P[1],p$q[p$S+6]=p$P[2],p$q[p$S+7]=p$P[3],p$q[p$S+10]=p$P[4],p$q[p$S+11]=p$P[5],p$q[p$S+14]=p$P[6],p$q[p$S+15]=p$P[7],this._vb.setNeedUpload()}p$$.bitmap!==p$h&&(this._isSameTexture=!1)}}},p$q.renderSubmit=function(){if(0===this._numEle)return p$Y._shaderSet=!1,1;var p$h=this.shaderValue.textureHost;if(p$h){var p$q=p$h.source;if(!p$h.bitmap||!p$q)return p$Y._shaderSet=!1,1;this.shaderValue.texture=p$q,p$h.alphaTexture&&p$h.alphaTexture.source&&(this.shaderValue.texture1=p$h.alphaTexture.source)}this._vb.bind_upload(this._ib);var p$f=p$mh.mainContext;if(p$s.activeBlendFunction!==this._blendFn&&(p$f.enable(3042),this._blendFn(p$f),p$s.activeBlendFunction=this._blendFn),p$b.drawCall++,p$b.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&p$Wh.activeShader&&p$Y._shaderSet?(p$Wh.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&p$Wh.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),p$Y._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var p$g=p$h.bitmap,p$$=0,p$P=p$Wh.activeShader,p$S=0,p$B=this._texs.length;p$S<p$B;p$S++){var p$r=this._texs[p$S];p$r.bitmap===p$g&&p$S+1!==p$B||(p$P.uploadTexture2D(p$r.source),p$f.drawElements(4,6*(p$S-p$$+1),5123,this._startIdx+6*p$$*p$eh.BYTES_PIDX),p$g=p$r.bitmap,p$$=p$S)}else p$f.drawElements(4,this._numEle,5123,this._startIdx);return 1},p$Y.create=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$Y._cache._length?p$Y._cache[--p$Y._cache._length]:new p$Y;null==p$f&&((p$f=p$P._selfVb||(p$P._selfVb=p$ah.create(-1))).clear(),p$g=0),p$P._ib=p$q,p$P._vb=p$f,p$P._startIdx=p$g*p$eh.BYTES_PIDX,p$P._numEle=0;var p$S=p$h._nBlendType;p$P._blendFn=p$h._targets?p$s.targetFns[p$S]:p$s.fns[p$S],p$P.shaderValue=p$$,p$P.shaderValue.setValue(p$h._shader2D);var p$B=p$h._shader2D.filters;return p$B&&p$P.shaderValue.setFilters(p$B),p$P},p$Y._cache=((p$Y._cache=[])._length=0,p$Y._cache),p$Y._shaderSet=!0,p$Y}(),p$Mh=function(p$h){function p$_(){p$_.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}p$u(p$_,"laya.webgl.utils.MeshTexture",p$_h);var p$q=p$_.prototype;return p$q.addData=function(p$h,p$q,p$f,p$g,p$$,p$P){for(var p$S=p$h.length/2,p$B=this._vb.needSize(p$S*p$_.const_stride)>>2,p$r=this._vb.getFloat32Array(),p$Y=0,p$C=0;p$C<p$S;p$C++){var p$U=p$h[p$Y],p$u=p$h[p$Y+1],p$v=p$U*p$g.a+p$u*p$g.c+p$g.tx,p$L=p$U*p$g.b+p$u*p$g.d+p$g.ty;p$r[p$B++]=p$v,p$r[p$B++]=p$L,p$r[p$B++]=p$q[p$Y],p$r[p$B++]=p$q[p$Y+1],p$Y+=2}this._vb.setNeedUpload();var p$e=this.vertNum;if(0<p$e){(p$S=p$f.length)>p$_.tmpIdx.length&&(p$_.tmpIdx=new Uint16Array(p$S));for(var p$l=0;p$l<p$S;p$l++)p$_.tmpIdx[p$l]=p$f[p$l]+p$e;this._ib.appendU16Array(p$_.tmpIdx,p$f.length)}else this._ib.append(p$f);this._ib.setNeedUpload(),this.vertNum+=p$S,this.indexNum+=p$f.length},p$q.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},p$q.destroy=function(){this._ib.destroy(),this._vb.destroy()},p$_.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new p$_},p$_.const_stride=16,p$_._POOL=[],p$S(p$_,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),p$_}(),p$Wh=function(p$h){function p$q(){p$q.__super.call(this),this.lock=!0}return p$u(p$q,"laya.webgl.shader.BaseShader",p$G),p$q.activeShader=null,p$q.bindShader=null,p$q}(),p$Th=function(p$q){function p$C(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===p$f&&(p$f=6408),void 0===p$g&&(p$g=5121),void 0===p$$&&(p$$=34041),void 0===p$P&&(p$P=!1),void 0===p$S&&(p$S=!1),void 0===p$B&&(p$B=-1),void 0===p$r&&(p$r=-1),this._type=1,this._w=p$h,this._h=p$q,this._surfaceFormat=p$f,this._surfaceType=p$g,this._depthStencilFormat=p$$,p$_.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=p$P,this._repeat=p$S,this._minFifter=p$B,this._magFifter=p$r,this._createWebGLRenderTarget(),this.bitmap.lock=!0,p$C.__super.call(this,this.bitmap,p$M.INV_UV)}p$u(p$C,"laya.webgl.resource.RenderTarget2D",p$q);var p$h=p$C.prototype;return p$R.imps(p$h,{"laya.resource.IDispose":!0}),p$h.getType=function(){return this._type},p$h.getTexture=function(){return this},p$h.size=function(p$h,p$q){this._w==p$h&&this._h==p$q||(this._w=p$h,this._h=p$q,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},p$h.release=function(){this.destroy()},p$h.recycle=function(){p$C.POOL.push(this)},p$h.start=function(){var p$h=p$mh.mainContext;return this._preRenderTarget=p$Nh.curRenderTarget,p$Nh.curRenderTarget=this,p$h.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(p$h.viewport(0,0,this._w,this._h),this._svWidth=p$Nh.width,this._svHeight=p$Nh.height,p$Nh.width=this._w,p$Nh.height=this._h,p$Wh.activeShader=null),this},p$h.clear=function(p$h,p$q,p$f,p$g){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=1);var p$$=p$mh.mainContext;p$$.clearColor(p$h,p$q,p$f,p$g);var p$P=16384;switch(this._depthStencilFormat){case 33189:p$P|=256;break;case 36168:p$P|=1024;break;case 34041:p$P|=256,p$P|=1024}p$$.clear(p$P)},p$h.end=function(){var p$h=p$mh.mainContext;p$h.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,p$Nh.curRenderTarget=this._preRenderTarget,1==this._type?(p$h.viewport(0,0,this._svWidth,this._svHeight),p$Nh.width=this._svWidth,p$Nh.height=this._svHeight,p$Wh.activeShader=null):p$h.viewport(0,0,p$R.stage.width,p$R.stage.height)},p$h.getData=function(p$h,p$q,p$f,p$g){var p$$=p$mh.mainContext;if(p$$.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===p$$.checkFramebufferStatus(36160)))return p$$.bindFramebuffer(36160,null),null;var p$P=new Uint8Array(this._w*this._h*4);return p$$.readPixels(p$h,p$q,p$f,p$g,this._surfaceFormat,this._surfaceType,p$P),p$$.bindFramebuffer(36160,null),p$P},p$h.destroy=function(p$h){void 0===p$h&&(p$h=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,p$q.prototype.destroy.call(this))},p$h.dispose=function(){},p$h._createWebGLRenderTarget=function(){this.bitmap=new p$Fh(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(p$h){this.event("recovered")})},p$g(0,p$h,"surfaceFormat",function(){return this._surfaceFormat}),p$g(0,p$h,"magFifter",function(){return this._magFifter}),p$g(0,p$h,"surfaceType",function(){return this._surfaceType}),p$g(0,p$h,"mipMap",function(){return this._mipMap}),p$g(0,p$h,"depthStencilFormat",function(){return this._depthStencilFormat}),p$g(0,p$h,"minFifter",function(){return this._minFifter}),p$g(0,p$h,"source",function(){return this._alreadyResolved?p$R.superGet(p$M,this,"source"):null}),p$C.create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){void 0===p$f&&(p$f=6408),void 0===p$g&&(p$g=5121),void 0===p$$&&(p$$=34041),void 0===p$P&&(p$P=!1),void 0===p$S&&(p$S=!1),void 0===p$B&&(p$B=-1),void 0===p$r&&(p$r=-1);var p$Y=p$C.POOL.pop();return p$Y||(p$Y=new p$C(p$h,p$q)),p$Y.bitmap&&p$Y._w==p$h&&p$Y._h==p$q&&p$Y._surfaceFormat==p$f&&p$Y._surfaceType==p$g&&p$Y._depthStencilFormat==p$$&&p$Y._mipMap==p$P&&p$Y._repeat==p$S&&p$Y._minFifter==p$B&&p$Y._magFifter==p$r||(p$Y._w=p$h,p$Y._h=p$q,p$Y._surfaceFormat=p$f,p$Y._surfaceType=p$g,p$Y._depthStencilFormat=p$$,p$_.isConchWebGL&&34041===p$Y._depthStencilFormat&&(p$Y._depthStencilFormat=33189),p$Y._mipMap=p$P,p$Y._repeat=p$S,p$Y._minFifter=p$B,p$Y._magFifter=p$r,p$Y.release(),p$Y._createWebGLRenderTarget()),p$Y},p$C.TYPE2D=1,p$C.TYPE3D=2,p$C.POOL=[],p$C}(p$M),p$Ih=function(p$h){function p$q(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,p$q.__super.call(this),p$q._gl=p$mh.mainContext}p$u(p$q,"laya.webgl.utils.Buffer",p$G);var p$f=p$q.prototype;return p$f._bind=function(){this.activeResource(),p$q._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(p$q._bindVertexBuffer=this._glBuffer),p$q._gl.bindBuffer(this._bufferType,p$q._bindActive[this._bufferType]=this._glBuffer),p$Wh.activeShader=null)},p$f.recreateResource=function(){this._glBuffer||(this._glBuffer=p$q._gl.createBuffer()),this.completeCreate()},p$f.disposeResource=function(){this._glBuffer&&(p$mh.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},p$g(0,p$f,"bufferUsage",function(){return this._bufferUsage}),p$q._gl=null,p$q._bindActive={},p$q._bindVertexBuffer=null,p$q._enableAtributes=[],p$q}(),p$wh=function(p$h){function p$f(p$h){this.texcoord=null,this.offsetX=300,this.offsetY=0,p$f.__super.call(this,512,0);var p$q=8*p$eh.BYTES_PE;this.position=[2,5126,!1,p$q,0],this.texcoord=[2,5126,!1,p$q,2*p$eh.BYTES_PE],this.color=[4,5126,!1,p$q,4*p$eh.BYTES_PE]}return p$u(p$f,"laya.webgl.shader.d2.skinAnishader.SkinSV",p$Xh),p$f}(),p$kh=function(p$h){function p$q(p$h){p$q.__super.call(this,2,0),this.color=[]}return p$u(p$q,"laya.webgl.shader.d2.value.Color2dSV",p$Xh),p$q.prototype.setValue=function(p$h){p$h.fillStyle&&(this.color=p$h.fillStyle._color._color),p$h.strokeStyle&&(this.color=p$h.strokeStyle._color._color)},p$q}(),p$Hh=function(p$h){function p$q(p$h){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=p$Xh._TEXCOORD,p$q.__super.call(this,256,0)}p$u(p$q,"laya.webgl.shader.d2.value.FillTextureSV",p$Xh);var p$f=p$q.prototype;return p$f.setValue=function(p$h){this.ALPHA=p$h.ALPHA,p$h.filters&&this.setFilters(p$h.filters)},p$f.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},p$q}(),p$Dh=function(p$h){function p$q(p$h){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=p$Xh._TEXCOORD,void 0===p$h&&(p$h=0),p$q.__super.call(this,1,p$h)}p$u(p$q,"laya.webgl.shader.d2.value.TextureSV",p$Xh);var p$f=p$q.prototype;return p$f.setValue=function(p$h){this.ALPHA=p$h.ALPHA,p$h.filters&&this.setFilters(p$h.filters)},p$f.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},p$q}(),p$sh=function(p$h){function p$q(p$h){this.a_color=null,this.u_pos=[0,0],p$q.__super.call(this,4,0),this.position=[2,5126,!1,5*p$eh.BYTES_PE,0],this.a_color=[3,5126,!1,5*p$eh.BYTES_PE,2*p$eh.BYTES_PE]}return p$u(p$q,"laya.webgl.shader.d2.value.PrimitiveSV",p$Xh),p$q}(),p$Vh=function(p$h){function p$q(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,p$q.__super.call(this)}p$u(p$q,"laya.webgl.atlas.AtlasWebGLCanvas",p$h);var p$f=p$q.prototype;return p$f.recreateResource=function(){var p$h=p$mh.mainContext,p$q=this._source=p$h.createTexture(),p$f=p$Eh.curBindTexTarget,p$g=p$Eh.curBindTexValue;p$Eh.bindTexture(p$h,3553,p$q),p$h.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),p$h.texParameteri(3553,10241,9729),p$h.texParameteri(3553,10240,9729),p$h.texParameteri(3553,10242,33071),p$h.texParameteri(3553,10243,33071),p$f&&p$g&&p$Eh.bindTexture(p$h,p$f,p$g),this.memorySize=this._w*this._h*4,this.completeCreate()},p$f.disposeResource=function(){this._source&&(p$mh.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},p$f.texSubImage2D=function(p$h,p$q,p$f){if(p$_.isFlash){this._flashCacheImage||(this._flashCacheImage=p$e.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var p$g=p$f.bitmapdata;this._flashCacheImage._image.copyPixels(p$g,0,0,p$g.width,p$g.height,p$h,p$q),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var p$$=p$mh.mainContext,p$P=p$Eh.curBindTexTarget,p$S=p$Eh.curBindTexValue;p$Eh.bindTexture(p$$,3553,this._source),p$$.pixelStorei(37441,!0),0<=p$h-1&&p$$.texSubImage2D(3553,0,p$h-1,p$q,6408,5121,p$f),p$h+1<=this._w&&p$$.texSubImage2D(3553,0,p$h+1,p$q,6408,5121,p$f),0<=p$q-1&&p$$.texSubImage2D(3553,0,p$h,p$q-1,6408,5121,p$f),p$q+1<=this._h&&p$$.texSubImage2D(3553,0,p$h,p$q+1,6408,5121,p$f),p$$.texSubImage2D(3553,0,p$h,p$q,6408,5121,p$f),p$$.pixelStorei(37441,!1),p$P&&p$S&&p$Eh.bindTexture(p$$,p$P,p$S)}},p$f.texSubImage2DPixel=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$mh.mainContext,p$S=p$Eh.curBindTexTarget,p$B=p$Eh.curBindTexValue;p$Eh.bindTexture(p$P,3553,this._source);var p$r=new Uint8Array(p$$.data);p$P.pixelStorei(37441,!0),p$P.texSubImage2D(3553,0,p$h,p$q,p$f,p$g,6408,5121,p$r),p$P.pixelStorei(37441,!1),p$S&&p$B&&p$Eh.bindTexture(p$P,p$S,p$B)},p$g(0,p$f,"width",p$h.prototype._$get_width,function(p$h){this._w=p$h}),p$g(0,p$f,"height",p$h.prototype._$get_height,function(p$h){this._h=p$h}),p$q}(p$f),p$Kh=function(p$h){function p$$(){this.flipY=!0,this.alwaysChange=!1,p$$.__super.call(this)}p$u(p$$,"laya.webgl.resource.WebGLCanvas",p$f);var p$q=p$$.prototype;return p$q.getCanvas=function(){return this._canvas},p$q.clear=function(){this._ctx&&this._ctx.clear()},p$q.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},p$q._setContext=function(p$h){this._ctx=p$h},p$q.getContext=function(p$h,p$q){return this._ctx?this._ctx:this._ctx=p$$._createContext(this)},p$q.size=function(p$h,p$q){this._w==p$h&&this._h==p$q||(this._w=p$h,this._h=p$q,this._ctx&&this._ctx.size(p$h,p$q),this._canvas&&(this._canvas.height=p$q,this._canvas.width=p$h))},p$q.activeResource=function(p$h){void 0===p$h&&(p$h=!1),this._source||this.recreateResource()},p$q.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},p$q.disposeResource=function(){this._source&&!this.iscpuSource&&(p$mh.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},p$q.createWebGlTexture=function(){var p$h=p$mh.mainContext;this._canvas;var p$q=this._source=p$h.createTexture();this.iscpuSource=!1;var p$f=p$Eh.curBindTexTarget,p$g=p$Eh.curBindTexValue;p$Eh.bindTexture(p$h,3553,p$q),p$h.pixelStorei(37440,this.flipY?1:0),p$$.premulAlpha&&p$h.pixelStorei(37441,!0),p$h.texImage2D(3553,0,6408,6408,5121,this._imgData),p$$.premulAlpha&&p$h.pixelStorei(37441,!1),p$h.texParameteri(3553,10240,9729),p$h.texParameteri(3553,10241,9729),p$h.texParameteri(3553,10242,33071),p$h.texParameteri(3553,10243,33071),p$h.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,p$f&&p$g&&p$Eh.bindTexture(p$h,p$f,p$g)},p$q.reloadCanvasData=function(){var p$h=p$mh.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var p$q=p$Eh.curBindTexTarget,p$f=p$Eh.curBindTexValue;p$Eh.bindTexture(p$h,3553,this._source),p$$.premulAlpha&&p$h.pixelStorei(37441,!0),p$h.texImage2D(3553,0,6408,6408,5121,this._imgData),p$$.premulAlpha&&p$h.pixelStorei(37441,!1),p$h.pixelStorei(37440,0),p$q&&p$f&&p$Eh.bindTexture(p$h,p$q,p$f)},p$q.texSubImage2D=function(p$h,p$q,p$f){var p$g=p$mh.mainContext,p$$=p$Eh.curBindTexTarget,p$P=p$Eh.curBindTexValue;p$Eh.bindTexture(p$g,3553,this._source),p$g.pixelStorei(37441,!0),p$g.texSubImage2D(3553,0,p$q,p$f,6408,5121,p$h._source),p$g.pixelStorei(37441,!1),p$$&&p$P&&p$Eh.bindTexture(p$g,p$$,p$P)},p$q.toBase64=function(p$h,p$q,p$f){var p$g=null;this._canvas&&(p$g=this._canvas.toDataURL(p$h,p$q)),p$f.call(this,p$g)},p$g(0,p$q,"context",function(){return this._ctx}),p$g(0,p$q,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),p$g(0,p$q,"asBitmap",null,function(p$h){this._ctx&&(this._ctx.asBitmap=p$h)}),p$$._createContext=null,p$$.premulAlpha=!1,p$$}(),p$yh=function(p$h){function p$P(p$h,p$q){this.CborderSize=12,p$P.__super.call(this),this.char=p$h,this.isSpace=" "===p$h,this.xs=p$q.scaleX,this.ys=p$q.scaleY,this.font=p$q.font.toString(),this.fontSize=p$q.font.size,this.fillColor=p$q.fillColor,this.borderColor=p$q.borderColor,this.lineWidth=p$q.lineWidth,this.underLine=p$q.underLine;var p$f,p$g=p$_.isConchApp;p$g?((p$f=ConchTextCanvas)._source=ConchTextCanvas,p$f._source.canvas=ConchTextCanvas):p$f=p$v.canvas.source,this.canvas=p$f,this._enableMerageInAtlas=!0,this._ctx=p$g?p$f:this.canvas.getContext("2d",void 0);var p$$=p$W.measureText(this.char,this.font);this.cw=p$$.width*this.xs,this.ch=(p$$.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new p$M(this)}p$u(p$P,"laya.webgl.resource.WebGLCharImage",p$f);var p$q=p$P.prototype;return p$R.imps(p$q,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),p$q.active=function(){this.texture.active()},p$q.recreateResource=function(){var p$h=p$_.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),p$h){var p$q=this.fontSize;1==this.xs&&1==this.ys||(p$q=parseInt(p$q*(this.xs>this.ys?this.xs:this.ys)+""));var p$f="normal 100 "+this.font;p$f=p$f.replace(p$P._fontSizeReg,p$q),this.borderColor&&(p$f+=" 1 "+this.borderColor),this._ctx.font=p$f,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,p$c.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var p$g=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(p$g,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},p$q.onresize=function(p$h,p$q){this._w=p$h,this._h=p$q,this._allowMerageInAtlas=!0},p$q.clearAtlasSource=function(){},p$g(0,p$q,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),p$g(0,p$q,"atlasSource",function(){return this.canvas}),p$g(0,p$q,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(p$h){this._enableMerageInAtlas=p$h}),p$P.createOneChar=function(p$h,p$q){return new p$P(p$h,p$q)},p$P._fontSizeReg=new RegExp("\\d+(?=px)","g"),p$P}(),p$Fh=function(p$h){function p$Y(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){void 0===p$f&&(p$f=6408),void 0===p$g&&(p$g=5121),void 0===p$$&&(p$$=34041),void 0===p$P&&(p$P=!1),void 0===p$S&&(p$S=!1),void 0===p$B&&(p$B=-1),void 0===p$r&&(p$r=1),p$Y.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=p$h,this._h=p$q,this._surfaceFormat=p$f,this._surfaceType=p$g,this._depthStencilFormat=p$$,this._mipMap=p$P,this._repeat=p$S,this._minFifter=p$B,this._magFifter=p$r}p$u(p$Y,"laya.webgl.resource.WebGLRenderTarget",p$f);var p$q=p$Y.prototype;return p$q.recreateResource=function(){var p$h=p$mh.mainContext;this._frameBuffer||(this._frameBuffer=p$h.createFramebuffer()),this._source||(this._source=p$h.createTexture());var p$q=p$Eh.curBindTexTarget,p$f=p$Eh.curBindTexValue;p$Eh.bindTexture(p$h,3553,this._source),p$h.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var p$g=this._minFifter,p$$=this._magFifter,p$P=this._repeat?10497:33071,p$S=p$C.isPOT(this._w,this._h);if(p$S?(this._mipMap?-1!==p$g||(p$g=9987):-1!==p$g||(p$g=9729),-1!==p$$||(p$$=9729),p$h.texParameteri(3553,10241,p$g),p$h.texParameteri(3553,10240,p$$),p$h.texParameteri(3553,10242,p$P),p$h.texParameteri(3553,10243,p$P),this._mipMap&&p$h.generateMipmap(3553)):(-1!==p$g||(p$g=9729),-1!==p$$||(p$$=9729),p$h.texParameteri(3553,10241,p$g),p$h.texParameteri(3553,10240,p$$),p$h.texParameteri(3553,10242,33071),p$h.texParameteri(3553,10243,33071)),p$h.bindFramebuffer(36160,this._frameBuffer),p$h.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=p$h.createRenderbuffer()),p$h.bindRenderbuffer(36161,this._depthStencilBuffer),p$h.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:p$h.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:p$h.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:p$h.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}p$h.bindFramebuffer(36160,null),p$q&&p$f&&p$Eh.bindTexture(p$h,p$q,p$f),p$h.bindRenderbuffer(36161,null),p$S&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},p$q.disposeResource=function(){this._frameBuffer&&(p$mh.mainContext.deleteTexture(this._source),p$mh.mainContext.deleteFramebuffer(this._frameBuffer),p$mh.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},p$g(0,p$q,"depthStencilBuffer",function(){return this._depthStencilBuffer}),p$g(0,p$q,"frameBuffer",function(){return this._frameBuffer}),p$Y}(),p$Zh=function(p$h){function p$B(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this.offsetX=0,this.offsetY=0,p$B.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=p$P,this.canvas=p$h,this._ctx=p$h.getContext("2d",void 0),this._w=p$g,this._h=p$$,this.offsetX=p$q,this.offsetY=p$f,this.src=p$S,this._enableMerageInAtlas=!0,p$H.enabled&&this._w<p$H.atlasLimitWidth&&this._h<p$H.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}p$u(p$B,"laya.webgl.resource.WebGLSubImage",p$f);var p$q=p$B.prototype;return p$R.imps(p$q,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),p$q.size=function(p$h,p$q){this._w=p$h,this._h=p$q,this._ctx&&this._ctx.size(p$h,p$q),this.canvas&&(this.canvas.height=p$q,this.canvas.width=p$h)},p$q.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},p$q.createWebGlTexture=function(){var p$h=p$mh.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var p$q=this._source=p$h.createTexture(),p$f=p$Eh.curBindTexTarget,p$g=p$Eh.curBindTexValue;p$Eh.bindTexture(p$h,3553,p$q),p$h.pixelStorei(37441,!0),p$h.texImage2D(3553,0,6408,6408,5121,this.canvas),p$h.pixelStorei(37441,!1);var p$$=this.minFifter,p$P=this.magFifter,p$S=this.repeat?10497:33071,p$B=p$C.isPOT(this.width,this.height);p$B?(this.mipmap?-1!==p$$||(p$$=9987):-1!==p$$||(p$$=9729),-1!==p$P||(p$P=9729),p$h.texParameteri(3553,10240,p$P),p$h.texParameteri(3553,10241,p$$),p$h.texParameteri(3553,10242,p$S),p$h.texParameteri(3553,10243,p$S),this.mipmap&&p$h.generateMipmap(3553)):(-1!==p$$||(p$$=9729),-1!==p$P||(p$P=9729),p$h.texParameteri(3553,10241,p$$),p$h.texParameteri(3553,10240,p$P),p$h.texParameteri(3553,10242,33071),p$h.texParameteri(3553,10243,33071)),p$f&&p$g&&p$Eh.bindTexture(p$h,p$f,p$g),this.canvas=null,p$B&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},p$q.disposeResource=function(){p$H.enabled&&this._allowMerageInAtlas||!this._source||(p$mh.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},p$q.clearAtlasSource=function(){},p$g(0,p$q,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),p$g(0,p$q,"atlasSource",function(){return this.canvas}),p$g(0,p$q,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(p$h){this._allowMerageInAtlas=p$h}),p$B}(),p$Qh=function(p$h){function p$Y(p$h,p$q,p$f,p$g){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,p$Y.__super.call(this),!p$h||!p$q)throw"Shader Error";this._id=++p$Y._count,this._vs=p$h,this._ps=p$q,this._nameMap=p$g||{},null!=p$f&&(p$Y.sharders[p$f]=this)}p$u(p$Y,"laya.webgl.shader.Shader",p$Wh);var p$q=p$Y.prototype;return p$q.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},p$q.disposeResource=function(){p$mh.mainContext.deleteShader(this._vshader),p$mh.mainContext.deleteShader(this._pshader),p$mh.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},p$q._compile=function(){if(!p$mh.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var p$h=[this._vs,this._ps],p$q=p$mh.mainContext;if(this._program=p$q.createProgram(),this._vshader=p$Y._createShader(p$q,p$h[0],35633),this._pshader=p$Y._createShader(p$q,p$h[1],35632),p$q.attachShader(this._program,this._vshader),p$q.attachShader(this._program,this._pshader),p$q.linkProgram(this._program),!p$_.isConchApp&&!p$q.getProgramParameter(this._program,35714))throw p$q.getProgramInfoLog(this._program);var p$f,p$g,p$$=0,p$P=0;for(p$P=p$_.isConchApp?p$q.getProgramParameterEx(this._vs,this._ps,"",35721):p$q.getProgramParameter(this._program,35721),p$$=0;p$$<p$P;p$$++){var p$S=null;p$f={vartype:"attribute",glfun:null,ivartype:0,attrib:p$S=p$_.isConchApp?p$q.getActiveAttribEx(this._vs,this._ps,"",p$$):p$q.getActiveAttrib(this._program,p$$),location:p$q.getAttribLocation(this._program,p$S.name),name:p$S.name,type:p$S.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(p$f)}var p$B=0;for(p$B=p$_.isConchApp?p$q.getProgramParameterEx(this._vs,this._ps,"",35718):p$q.getProgramParameter(this._program,35718),p$$=0;p$$<p$B;p$$++){var p$r=null;p$r=p$_.isConchApp?p$q.getActiveUniformEx(this._vs,this._ps,"",p$$):p$q.getActiveUniform(this._program,p$$),0<(p$f={vartype:"uniform",glfun:null,ivartype:1,attrib:p$S,location:p$q.getUniformLocation(this._program,p$r.name),name:p$r.name,type:p$r.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(p$f.name=p$f.name.substr(0,p$f.name.length-3),p$f.isArray=!0,p$f.location=p$q.getUniformLocation(this._program,p$f.name)),this._params.push(p$f)}for(p$$=0,p$g=this._params.length;p$$<p$g;p$$++)if((p$f=this._params[p$$]).indexOfParams=p$$,p$f.index=1,p$f.value=[p$f.location,null],p$f.codename=p$f.name,p$f.name=this._nameMap[p$f.codename]?this._nameMap[p$f.codename]:p$f.codename,(this._paramsMap[p$f.name]=p$f)._this=this,p$f.uploadedValue=[],"attribute"!==p$f.vartype)switch(p$f.type){case 5124:p$f.fun=p$f.isArray?this._uniform1iv:this._uniform1i;break;case 5126:p$f.fun=p$f.isArray?this._uniform1fv:this._uniform1f;break;case 35664:p$f.fun=p$f.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:p$f.fun=p$f.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:p$f.fun=p$f.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:p$f.fun=this._uniform_sampler2D;break;case 35680:p$f.fun=this._uniform_samplerCube;break;case 35676:p$f.glfun=p$q.uniformMatrix4fv,p$f.fun=this._uniformMatrix4fv;break;case 35670:p$f.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else p$f.fun=this._attribute}},p$q.getUniform=function(p$h){return this._paramsMap[p$h]},p$q._attribute=function(p$h,p$q){var p$f=p$mh.mainContext,p$g=p$Ih._enableAtributes,p$$=p$h.location;return p$g[p$$]||p$f.enableVertexAttribArray(p$$),p$f.vertexAttribPointer(p$$,p$q[0],p$q[1],p$q[2],p$q[3],p$q[4]+this._offset),p$g[p$$]=p$Ih._bindVertexBuffer,1},p$q._uniform1f=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q?(p$mh.mainContext.uniform1f(p$h.location,p$f[0]=p$q),1):0},p$q._uniform1fv=function(p$h,p$q){if(p$q.length<4){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$mh.mainContext.uniform1fv(p$h.location,p$q),p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3],1):0}return p$mh.mainContext.uniform1fv(p$h.location,p$q),1},p$q._uniform_vec2=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]?(p$mh.mainContext.uniform2f(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1]),1):0},p$q._uniform_vec2v=function(p$h,p$q){if(p$q.length<2){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$mh.mainContext.uniform2fv(p$h.location,p$q),p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3],1):0}return p$mh.mainContext.uniform2fv(p$h.location,p$q),1},p$q._uniform_vec3=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]?(p$mh.mainContext.uniform3f(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2]),1):0},p$q._uniform_vec3v=function(p$h,p$q){return p$mh.mainContext.uniform3fv(p$h.location,p$q),1},p$q._uniform_vec4=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$mh.mainContext.uniform4f(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3]),1):0},p$q._uniform_vec4v=function(p$h,p$q){return p$mh.mainContext.uniform4fv(p$h.location,p$q),1},p$q._uniformMatrix2fv=function(p$h,p$q){return p$mh.mainContext.uniformMatrix2fv(p$h.location,!1,p$q),1},p$q._uniformMatrix3fv=function(p$h,p$q){return p$mh.mainContext.uniformMatrix3fv(p$h.location,!1,p$q),1},p$q._uniformMatrix4fv=function(p$h,p$q){return p$mh.mainContext.uniformMatrix4fv(p$h.location,!1,p$q),1},p$q._uniform1i=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q?(p$mh.mainContext.uniform1i(p$h.location,p$f[0]=p$q),1):0},p$q._uniform1iv=function(p$h,p$q){return p$mh.mainContext.uniform1iv(p$h.location,p$q),1},p$q._uniform_ivec2=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]?(p$mh.mainContext.uniform2i(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1]),1):0},p$q._uniform_ivec2v=function(p$h,p$q){return p$mh.mainContext.uniform2iv(p$h.location,p$q),1},p$q._uniform_vec3i=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]?(p$mh.mainContext.uniform3i(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2]),1):0},p$q._uniform_vec3vi=function(p$h,p$q){return p$mh.mainContext.uniform3iv(p$h.location,p$q),1},p$q._uniform_vec4i=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$mh.mainContext.uniform4i(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3]),1):0},p$q._uniform_vec4vi=function(p$h,p$q){return p$mh.mainContext.uniform4iv(p$h.location,p$q),1},p$q._uniform_sampler2D=function(p$h,p$q){var p$f=p$mh.mainContext,p$g=p$h.uploadedValue;return null==p$g[0]?(p$g[0]=this._curActTexIndex,p$f.uniform1i(p$h.location,this._curActTexIndex),p$f.activeTexture(p$Y._TEXTURES[this._curActTexIndex]),p$Eh.bindTexture(p$f,3553,p$q),this._curActTexIndex++,1):(p$f.activeTexture(p$Y._TEXTURES[p$g[0]]),p$Eh.bindTexture(p$f,3553,p$q),0)},p$q._uniform_samplerCube=function(p$h,p$q){var p$f=p$mh.mainContext,p$g=p$h.uploadedValue;return null==p$g[0]?(p$g[0]=this._curActTexIndex,p$f.uniform1i(p$h.location,this._curActTexIndex),p$f.activeTexture(p$Y._TEXTURES[this._curActTexIndex]),p$Eh.bindTexture(p$f,34067,p$q),this._curActTexIndex++,1):(p$f.activeTexture(p$Y._TEXTURES[p$g[0]]),p$Eh.bindTexture(p$f,34067,p$q),0)},p$q._noSetValue=function(p$h){console.log("no....:"+p$h.name)},p$q.uploadOne=function(p$h,p$q){this.activeResource(),p$Eh.UseProgram(this._program);var p$f=this._paramsMap[p$h];p$f.fun.call(this,p$f,p$q)},p$q.uploadTexture2D=function(p$h){p$b.shaderCall++;var p$q=p$mh.mainContext;p$q.activeTexture(33984),p$Eh.bindTexture(p$q,3553,p$h)},p$q.uploadTexture2D1=function(p$h){p$b.shaderCall++;var p$q=p$mh.mainContext;p$q.activeTexture(33985),p$Eh.bindTexture(p$q,3553,p$h)},p$q.upload=function(p$h,p$q){p$Wh.activeShader=p$Wh.bindShader=this,this._lastUseFrameCount===p$b.loopCount||this.activeResource(),p$Eh.UseProgram(this._program),this._reCompile?(p$q=this._params,this._reCompile=!1):p$q=p$q||this._params;p$mh.mainContext;for(var p$f,p$g,p$$=p$q.length,p$P=0,p$S=0;p$S<p$$;p$S++)null!==(p$g=p$h[(p$f=p$q[p$S]).name])&&(p$P+=p$f.fun.call(this,p$f,p$g));p$b.shaderCall+=p$P},p$q.uploadArray=function(p$h,p$q,p$f){p$Wh.activeShader=this,(p$Wh.bindShader=this).activeResource(),p$Eh.UseProgram(this._program);this._params;for(var p$g,p$$,p$P=0,p$S=p$q-2;0<=p$S;p$S-=2)(p$$=this._paramsMap[p$h[p$S]])&&null!=(p$g=p$h[p$S+1])&&(p$f&&p$f[p$$.name]&&p$f[p$$.name].bind(),p$P+=p$$.fun.call(this,p$$,p$g));p$b.shaderCall+=p$P},p$q.getParams=function(){return this._params},p$Y.getShader=function(p$h){return p$Y.sharders[p$h]},p$Y.create=function(p$h,p$q,p$f,p$g){return new p$Y(p$h,p$q,p$f,p$g)},p$Y.withCompile=function(p$h,p$q,p$f,p$g){if(p$f&&p$Y.sharders[p$f])return p$Y.sharders[p$f];var p$$=p$Y._preCompileShader[2e-4*p$h];if(!p$$)throw new Error("withCompile shader err!"+p$h);return p$$.createShader(p$q,p$f,p$g)},p$Y.withCompile2D=function(p$h,p$q,p$f,p$g,p$$){if(p$g&&p$Y.sharders[p$g])return p$Y.sharders[p$g];var p$P=p$Y._preCompileShader[2e-4*p$h+p$q];if(!p$P)throw new Error("withCompile shader err!"+p$h+" "+p$q);return p$P.createShader(p$f,p$g,p$$)},p$Y.addInclude=function(p$h,p$q){p$Gh.addInclude(p$h,p$q)},p$Y.preCompile=function(p$h,p$q,p$f,p$g){var p$$=2e-4*p$h;p$Y._preCompileShader[p$$]=new p$Gh(p$$,p$q,p$f,p$g)},p$Y.preCompile2D=function(p$h,p$q,p$f,p$g,p$$){var p$P=2e-4*p$h+p$q;p$Y._preCompileShader[p$P]=new p$Gh(p$P,p$f,p$g,p$$)},p$Y._createShader=function(p$h,p$q,p$f){var p$g=p$h.createShader(p$f);return p$h.shaderSource(p$g,p$q),p$h.compileShader(p$g),p$g},p$Y._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],p$Y._count=0,p$Y._preCompileShader={},p$Y.SHADERNAME2ID=2e-4,p$Y.sharders=((p$Y.sharders=[]).length=32,p$Y.sharders),p$S(p$Y,["nameKey",function(){return this.nameKey=new p$i}]),p$Y}(),p$oh=function(p$h){function p$q(){this._maxsize=0,this._upload=!0,this._uploadSize=0,p$q.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}p$u(p$q,"laya.webgl.utils.Buffer2D",p$h);var p$f=p$q.prototype;return p$f.needSize=function(p$h){var p$q=this._byteLength;if(p$h){var p$f=this._byteLength+p$h;p$f<=this._buffer.byteLength||this._resizeBuffer(p$f<<1,!0),this._byteLength=p$f}return p$q},p$f._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),p$b.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,p$Ih._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),p$Ih._gl.bufferSubData(this._bufferType,0,this._buffer)},p$f._bufferSubData=function(p$h,p$q,p$f){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),this._maxsize=Math.max(this._maxsize,this._byteLength),p$b.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,p$Ih._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),p$q||p$f){var p$g=this._buffer.slice(p$q,p$f);p$Ih._gl.bufferSubData(this._bufferType,p$h,p$g)}else p$Ih._gl.bufferSubData(this._bufferType,p$h,this._buffer)},p$f._checkArrayUse=function(){},p$f._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},p$f._bind_subUpload=function(p$h,p$q,p$f){return void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(p$h,p$q,p$f),!0)},p$f._resizeBuffer=function(p$h,p$q){if(p$h<this._buffer.byteLength)return this;if(this.memorySize=p$h,p$q&&this._buffer&&0<this._buffer.byteLength){var p$f=new ArrayBuffer(p$h);new Uint8Array(p$f).set(new Uint8Array(this._buffer),0),this._buffer=p$f}else this._buffer=new ArrayBuffer(p$h);return this._checkArrayUse(),this._upload=!0,this},p$f.append=function(p$h){this._upload=!0;var p$q,p$f;p$q=p$h.byteLength,p$h instanceof Uint8Array?(this._resizeBuffer(this._byteLength+p$q,!0),p$f=new Uint8Array(this._buffer,this._byteLength)):p$h instanceof Uint16Array?(this._resizeBuffer(this._byteLength+p$q,!0),p$f=new Uint16Array(this._buffer,this._byteLength)):p$h instanceof Float32Array&&(this._resizeBuffer(this._byteLength+p$q,!0),p$f=new Float32Array(this._buffer,this._byteLength)),p$f.set(p$h,0),this._byteLength+=p$q,this._checkArrayUse()},p$f.appendU16Array=function(p$h,p$q){this._resizeBuffer(this._byteLength+2*p$q,!0);for(var p$f=new Uint16Array(this._buffer,this._byteLength,p$q),p$g=0;p$g<p$q;p$g++)p$f[p$g]=p$h[p$g];this._byteLength+=2*p$q,this._checkArrayUse()},p$f.appendEx=function(p$h,p$q){this._upload=!0;var p$f;p$f=p$h.byteLength,this._resizeBuffer(this._byteLength+p$f,!0),new p$q(this._buffer,this._byteLength).set(p$h,0),this._byteLength+=p$f,this._checkArrayUse()},p$f.appendEx2=function(p$h,p$q,p$f,p$g){void 0===p$g&&(p$g=1),this._upload=!0;var p$$,p$P;p$$=p$f*p$g,this._resizeBuffer(this._byteLength+p$$,!0),p$P=new p$q(this._buffer,this._byteLength);var p$S=0;for(p$S=0;p$S<p$f;p$S++)p$P[p$S]=p$h[p$S];this._byteLength+=p$$,this._checkArrayUse()},p$f.getBuffer=function(){return this._buffer},p$f.setNeedUpload=function(){this._upload=!0},p$f.getNeedUpload=function(){return this._upload},p$f.upload=function(){var p$h=this._bind_upload();return p$Ih._gl.bindBuffer(this._bufferType,null),p$Ih._bindActive[this._bufferType]=null,p$Wh.activeShader=null,p$h},p$f.subUpload=function(p$h,p$q,p$f){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0);var p$g=this._bind_subUpload();return p$Ih._gl.bindBuffer(this._bufferType,null),p$Ih._bindActive[this._bufferType]=null,p$Wh.activeShader=null,p$g},p$f.disposeResource=function(){p$h.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},p$f.clear=function(){this._byteLength=0,this._upload=!0},p$g(0,p$f,"bufferLength",function(){return this._buffer.byteLength}),p$g(0,p$f,"byteLength",null,function(p$h){this._byteLength!==p$h&&(p$h<=this._buffer.byteLength||this._resizeBuffer(2*p$h+256,!0),this._byteLength=p$h)}),p$q.__int__=function(p$h){p$xh.QuadrangleIB=p$xh.create(35044),p$lh.fillIBQuadrangle(p$xh.QuadrangleIB,16)},p$q.FLOAT32=4,p$q.SHORT=2,p$q}(p$Ih),p$Oh=(function(p$q){function p$f(p$h){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,p$f.__super.call(this,9)}p$u(p$f,"laya.webgl.shader.d2.value.GlowSV",p$q);var p$h=p$f.prototype;p$h.setValue=function(p$h){p$q.prototype.setValue.call(this,p$h)},p$h.clear=function(){p$q.prototype.clear.call(this)}}(p$Dh),function(p$h){function p$q(p$h){p$q.__super.call(this,64),this.defines.add(64)}p$u(p$q,"laya.webgl.shader.d2.value.TextSV",p$h);var p$f=p$q.prototype;return p$f.release=function(){(p$q.pool[p$q._length++]=this).clear()},p$f.clear=function(){p$h.prototype.clear.call(this)},p$q.create=function(){return p$q._length?p$q.pool[--p$q._length]:new p$q(null)},p$q.pool=[],p$q._length=0,p$q}(p$Dh)),p$jh=function(p$h){function p$$(p$h,p$q,p$f,p$g){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,p$$.__super.call(this,p$h,p$q,p$f,p$g)}p$u(p$$,"laya.webgl.shader.d2.Shader2X",p$h);var p$q=p$$.prototype;return p$q.upload2dQuick1=function(p$h){this.upload(p$h,this._params2dQuick1||this._make2dQuick1())},p$q._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var p$h,p$q=this._params,p$f=0,p$g=p$q.length;p$f<p$g;p$f++)p$h=p$q[p$f],(p$_.isFlash||"size"!==p$h.name&&"position"!==p$h.name&&"texcoord"!==p$h.name)&&this._params2dQuick1.push(p$h)}return this._params2dQuick1},p$q.disposeResource=function(){p$h.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},p$q.upload2dQuick2=function(p$h){this.upload(p$h,this._params2dQuick2||this._make2dQuick2())},p$q._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var p$h,p$q=this._params,p$f=0,p$g=p$q.length;p$f<p$g;p$f++)p$h=p$q[p$f],(p$_.isFlash||"size"!==p$h.name)&&this._params2dQuick2.push(p$h)}return this._params2dQuick2},p$$.create=function(p$h,p$q,p$f,p$g){return new p$$(p$h,p$q,p$f,p$g)},p$$}(p$Qh),p$xh=function(p$h){function p$q(p$h){this._uint8Array=null,this._uint16Array=null,void 0===p$h&&(p$h=35044),p$q.__super.call(this),this._bufferUsage=p$h,this._bufferType=34963,p$_.isFlash||(this._buffer=new ArrayBuffer(8))}p$u(p$q,"laya.webgl.utils.IndexBuffer2D",p$oh);var p$f=p$q.prototype;return p$f._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},p$f.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},p$f.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},p$f.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},p$q.QuadrangleIB=null,p$q.create=function(p$h){return void 0===p$h&&(p$h=35044),new p$q(p$h)},p$q}(),p$ah=function(p$h){function p$f(p$h,p$q){this._floatArray32=null,this._vertexStride=0,p$f.__super.call(this),this._vertexStride=p$h,this._bufferUsage=p$q,this._bufferType=34962,p$_.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}p$u(p$f,"laya.webgl.utils.VertexBuffer2D",p$h);var p$q=p$f.prototype;return p$q.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},p$q.bind=function(p$h){p$h&&p$h._bind(),this._bind()},p$q.insertData=function(p$h,p$q){this.getFloat32Array().set(p$h,p$q),this._upload=!0},p$q.bind_upload=function(p$h){p$h._bind_upload()||p$h._bind(),this._bind_upload()||this._bind()},p$q._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},p$q.disposeResource=function(){p$h.prototype.disposeResource.call(this)},p$q.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},p$g(0,p$q,"vertexStride",function(){return this._vertexStride}),p$f.create=function(p$h,p$q){return void 0===p$q&&(p$q=35048),new p$f(p$h,p$q)},p$f}(p$oh),p$hq=function(p$h){function p$B(p$h,p$q,p$f,p$g,p$$,p$P){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===p$f&&(p$f=6408),void 0===p$g&&(p$g=!0),p$B.__super.call(this,p$h,p$q),p$h){if(this._format=p$f,this._mipmap=p$g,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof p$h)this._url=p$h,this._src=p$h,this._image=new p$v.window.Image,p$q&&(p$q.onload&&(this.onload=p$q.onload),p$q.onerror&&(this.onerror=p$q.onerror),p$q.onCreate&&p$q.onCreate(this)),this._image.crossOrigin=p$h&&0==p$h.indexOf("data:")?null:"",p$h&&(this._image.src=p$h);else if(p$h instanceof ArrayBuffer){this._src=p$q,this._url=this._src;var p$S=new p$r(p$h);p$S.readUTFBytes(4),p$S.readUTFBytes(2),p$S.getInt16();p$S.endian="bigEndian",this._w=p$S.getInt16(),this._h=p$S.getInt16();p$S.getInt16(),p$S.getInt16();this._image=new Uint8Array(p$h,p$S.pos),this._format=p$mh.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,p$H.enabled&&this._w<p$H.atlasLimitWidth&&this._h<p$H.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(p$h instanceof Uint8Array))return this._src=p$q,this._url=this._src,this._image=p$h.source||p$h,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=p$q,this._url=this._src,this._w=p$$,this._h=p$P,this._image=p$h,this._format=0===p$f?p$h.byteLength/(p$$*p$P)==4?6408:6407:p$f}this._$5__enableMerageInAtlas=!0}}p$u(p$B,"laya.webgl.resource.WebGLImage",p$e);var p$q=p$B.prototype;return p$R.imps(p$q,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),p$q._init_=function(p$h,p$q){},p$q._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var p$h=p$mh.mainContext,p$q=this._source=p$h.createTexture(),p$f=p$Eh.curBindTexTarget,p$g=p$Eh.curBindTexValue;p$Eh.bindTexture(p$h,3553,p$q);var p$$=this.minFifter,p$P=this.magFifter,p$S=this.repeat?10497:33071,p$B=p$C.isPOT(this._w,this._h),p$r=!1;switch(p$B?(this.mipmap?-1!==p$$||(p$$=9987):-1!==p$$||(p$$=9729),-1!==p$P||(p$P=9729),p$h.texParameteri(3553,10241,p$$),p$h.texParameteri(3553,10240,p$P),p$h.texParameteri(3553,10242,p$S),p$h.texParameteri(3553,10243,p$S),this.mipmap&&p$h.generateMipmap(3553)):(-1!==p$$||(p$$=9729),-1!==p$P||(p$P=9729),p$h.texParameteri(3553,10241,p$$),p$h.texParameteri(3553,10240,p$P),p$h.texParameteri(3553,10242,33071),p$h.texParameteri(3553,10243,33071)),p$h.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&p$h.pixelStorei(p$h.UNPACK_ALIGNMENT,1),p$h.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&p$h.pixelStorei(p$h.UNPACK_ALIGNMENT,1),p$h.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:p$r=!0,p$h.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case p$mh.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:p$r=!0,p$h.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}p$h.pixelStorei(37441,!1),p$f&&p$g&&p$Eh.bindTexture(p$h,p$f,p$g),this.uri||(this.uri=this._url),p$r?this.memorySize=this._image.length:p$B&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},p$q.recreateResource=function(){var p$h=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var p$q=this;this._image=new p$v.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(p$q._needReleaseAgain)return p$q._needReleaseAgain=!1,p$q._image.onload=null,void(p$q._image=null);p$q._allowMerageInAtlas&&p$q._enableMerageInAtlas?(p$h.memorySize=0,p$h._recreateLock=!1):p$q._createWebGlTexture(),p$q.completeCreate()},this._image.src=this._src}},p$q.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&p$mh.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},p$q.onresize=function(){this._w=this._image.width,this._h=this._image.height,p$H.enabled&&this._w<p$H.atlasLimitWidth&&this._h<p$H.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},p$q.clearAtlasSource=function(){this._image=null},p$g(0,p$q,"format",function(){return this._format}),p$g(0,p$q,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(p$h){this._$5__enableMerageInAtlas=p$h}),p$g(0,p$q,"mipmap",function(){return this._mipmap}),p$g(0,p$q,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),p$g(0,p$q,"atlasSource",function(){return this._image}),p$g(0,p$q,"onload",null,function(p$h){var p$q=this;this._onload=p$h,this._image&&(this._image.onload=null!=this._onload?function(){p$q.onresize(),p$q._onload()}:null)}),p$g(0,p$q,"onerror",null,function(p$h){var p$q=this;this._onerror=p$h,this._image&&(this._image.onerror=null!=this._onerror?function(){p$q._onerror()}:null)}),p$B}();p$R.__init([p$vh,p$k,p$th,p$Gh])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(p$h,p$q){"use strict";for(var p$f in Object.defineProperty(p$q,"__esModule",{value:!0}),Laya){var p$g=Laya[p$f];p$g&&p$g.__isclass&&(p$q[p$f]=p$g)}}),function(p$P,p$h,p$g){p$g.un,p$g.uns;var p$$=p$g.static,p$S=p$g.class,p$B=p$g.getset,p$r=(p$g.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),p$L=laya.utils.ClassUtils,p$U=(laya.events.Event,laya.utils.HTMLChar),p$Y=laya.net.Loader,p$C=(laya.display.Node,laya.maths.Rectangle),p$u=laya.renders.Render,p$v=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),p$e=laya.utils.Stat,p$W=laya.display.Text,p$l=laya.resource.Texture,p$_=laya.net.URL,p$N=laya.utils.Utils,p$G=function(){function p$v(){}return p$S(p$v,"laya.html.utils.HTMLParse"),p$v.parse=function(p$h,p$q,p$f){p$q=(p$q="<root>"+(p$q=p$q.replace(/<br>/g,"<br/>"))+"</root>").replace(p$v.spacePattern,p$v.char255);var p$g=p$N.parseXMLFromString(p$q);p$v._parseXML(p$h,p$g.childNodes[0].childNodes,p$f)},p$v._parseXML=function(p$h,p$q,p$f,p$g){var p$$=0,p$P=0;if(p$q.join||p$q.item)for(p$$=0,p$P=p$q.length;p$$<p$P;++p$$)p$v._parseXML(p$h,p$q[p$$],p$f,p$g);else{var p$S,p$B,p$r;if(3==p$q.nodeType)return void(p$h instanceof laya.html.dom.HTMLDivElement?(null==p$q.nodeName&&(p$q.nodeName="#text"),p$B=p$q.nodeName.toLowerCase(),0<(p$r=p$q.textContent.replace(/^\s+|\s+$/g,"")).length&&(p$S=p$L.getInstance(p$B))&&(p$h.addChild(p$S),p$S.innerTEXT=p$r.replace(p$v.char255AndOneSpacePattern," "))):0<(p$r=p$q.textContent.replace(/^\s+|\s+$/g,"")).length&&(p$h.innerTEXT=p$r.replace(p$v.char255AndOneSpacePattern," ")));if("#comment"==(p$B=p$q.nodeName.toLowerCase()))return;if(p$S=p$L.getInstance(p$B)){(p$S=p$h.addChild(p$S)).URI=p$f,p$S.href=p$g;var p$Y=p$q.attributes;if(p$Y&&0<p$Y.length)for(p$$=0,p$P=p$Y.length;p$$<p$P;++p$$){var p$C=p$Y[p$$],p$U=p$C.nodeName,p$u=p$C.value;p$S._setAttributes(p$U,p$u)}p$v._parseXML(p$S,p$q.childNodes,p$f,p$S.href)}else p$v._parseXML(p$h,p$q.childNodes,p$f,p$g)}},p$v.char255=String.fromCharCode(255),p$v.spacePattern=/&nbsp;|&#160;/g,p$v.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),p$v}(),p$m=function(){function p$M(){}return p$S(p$M,"laya.html.utils.Layout"),p$M.later=function(p$h){null==p$M._will&&(p$M._will=[],p$g.stage.frameLoop(1,null,function(){if(!(p$M._will.length<1)){for(var p$h=0;p$h<p$M._will.length;p$h++)laya.html.utils.Layout.layout(p$M._will[p$h]);p$M._will.length=0}})),p$M._will.push(p$h)},p$M.layout=function(p$h){if(!p$h||!p$h._style)return null;if(0==(512&p$h._style._type))return null;p$h.getStyle()._type&=-513;var p$q=p$M._multiLineLayout(p$h);return p$u.isConchApp&&p$h.layaoutCallNative&&p$h.layaoutCallNative(),p$q},p$M._multiLineLayout=function(p$h){if(p$W.RightToLeft)return p$M._multiLineLayout2(p$h);var p$q=new Array;p$h._addChildsToLayout(p$q);var p$f,p$g,p$$,p$P,p$S,p$B=0,p$r=p$q.length,p$Y=p$h._getCSSStyle(),p$C=p$Y.letterSpacing,p$U=p$Y.leading,p$u=p$Y.lineHeight,p$v=p$Y._widthAuto()||!p$Y.wordWrap,p$L=p$v?999999:p$h.width,p$e=(p$h.height,0),p$l=p$Y.italic?p$Y.fontSize/3:0,p$_=p$Y._getAlign(),p$N=p$Y._getValign(),p$G=0!==p$N||0!==p$_||0!=p$u,p$m=0,p$E=0,p$R=0,p$t=0,p$X=new Array,p$n=p$X[0]=new p$T,p$J=!1,p$p=!1;p$n.h=0,p$Y.italic&&(p$L-=p$Y.fontSize/3);var p$A=0,p$d=!0;function p$b(){p$n.y=p$E,p$E+=p$n.h+p$U,0==p$n.h&&(p$E+=p$u),p$n.mWidth=p$A,p$A=0,p$n=new p$T,p$X.push(p$n),p$n.h=0,p$J=!(p$d=!(p$m=0))}for(p$B=0;p$B<p$r;p$B++)if(null!=(p$f=p$q[p$B]))if(p$d=!1,p$f instanceof laya.html.dom.HTMLBrElement)p$b(),p$n.y=p$E;else{if(p$f._isChar()){if((p$P=p$f).isWord)p$J=p$p||"\n"===p$P.char,p$n.wordStartIndex=p$n.elements.length;else{if(p$R=p$P.width+p$P.style.letterSpacin,0<p$X.length&&p$L<p$m+p$R&&0<p$n.wordStartIndex){var p$i;p$i=p$n.elements.length-p$n.wordStartIndex+1,p$n.elements.length=p$n.wordStartIndex,p$B-=p$i,p$b();continue}p$J=!1,p$A+=p$P.width}p$R=p$P.width+p$C,p$t=p$P.height,p$p=!1,(p$J=p$J||p$L<p$m+p$R)&&p$b(),p$n.minTextHeight=Math.min(p$n.minTextHeight,p$f.height)}else p$g=p$f._getCSSStyle(),p$S=p$f,p$$=p$g.padding,0===p$g._getCssFloat()||(p$G=!0),p$J=p$p||p$g.lineElement,p$R=p$S.width*p$S._style._tf.scaleX+p$$[1]+p$$[3]+p$C,p$t=p$S.height*p$S._style._tf.scaleY+p$$[0]+p$$[2],p$p=p$g.lineElement,(p$J=p$J||p$L<p$m+p$R&&p$g.wordWrap)&&p$b();p$n.elements.push(p$f),p$n.h=Math.max(p$n.h,p$t),p$f.x=p$m,p$f.y=p$E,p$m+=p$R,p$n.w=p$m-p$C,p$n.y=p$E,p$e=Math.max(p$m+p$l,p$e)}else p$d||(p$m+=p$M.DIV_ELEMENT_PADDING),p$n.wordStartIndex=p$n.elements.length;if(p$E=p$n.y+p$n.h,p$G){var p$z=0,p$c=p$L;for(p$v&&0<p$h.width&&(p$c=p$h.width),p$B=0,p$r=p$X.length;p$B<p$r;p$B++)p$X[p$B].updatePos(0,p$c,p$B,p$z,p$_,p$N,p$u),p$z+=Math.max(p$u,p$X[p$B].h+p$U);p$E=p$z}return p$v&&(p$h.width=p$e),p$E>p$h.height&&(p$h.height=p$E),[p$e,p$E]},p$M._multiLineLayout2=function(p$h){var p$q=new Array;p$h._addChildsToLayout(p$q);var p$f,p$g,p$$,p$P,p$S,p$B=0,p$r=p$q.length,p$Y=p$h._getCSSStyle(),p$C=p$Y.letterSpacing,p$U=p$Y.leading,p$u=p$Y.lineHeight,p$v=p$Y._widthAuto()||!p$Y.wordWrap,p$L=p$v?999999:p$h.width,p$e=(p$h.height,0),p$l=p$Y.italic?p$Y.fontSize/3:0,p$_=2-p$Y._getAlign(),p$N=p$Y._getValign(),p$G=0!==p$N||0!=p$_||0!=p$u,p$m=0,p$E=0,p$R=0,p$t=0,p$X=new Array,p$n=p$X[0]=new p$T,p$J=!1,p$p=!1;p$n.h=0,p$Y.italic&&(p$L-=p$Y.fontSize/3);var p$A=0,p$d=!0;function p$b(){p$n.y=p$E,p$E+=p$n.h+p$U,0==p$n.h&&(p$E+=p$u),p$n.mWidth=p$A,p$A=0,p$n=new p$T,p$X.push(p$n),p$n.h=0,p$J=!(p$d=!(p$m=0))}for(p$B=0;p$B<p$r;p$B++)if(null!=(p$f=p$q[p$B]))if(p$d=!1,p$f instanceof laya.html.dom.HTMLBrElement)p$b(),p$n.y=p$E;else{if(p$f._isChar()){if((p$P=p$f).isWord)p$J=p$p||"\n"===p$P.char,p$n.wordStartIndex=p$n.elements.length;else{if(0<p$X.length&&p$L<p$m+p$R&&0<p$n.wordStartIndex){var p$i;p$i=p$n.elements.length-p$n.wordStartIndex+1,p$n.elements.length=p$n.wordStartIndex,p$B-=p$i,p$b();continue}p$J=!1,p$A+=p$P.width}p$R=p$P.width+p$C,p$t=p$P.height,p$p=!1,(p$J=p$J||p$L<p$m+p$R)&&p$b(),p$n.minTextHeight=Math.min(p$n.minTextHeight,p$f.height)}else p$g=p$f._getCSSStyle(),p$S=p$f,p$$=p$g.padding,0===p$g._getCssFloat()||(p$G=!0),p$J=p$p||p$g.lineElement,p$R=p$S.width*p$S._style._tf.scaleX+p$$[1]+p$$[3]+p$C,p$t=p$S.height*p$S._style._tf.scaleY+p$$[0]+p$$[2],p$p=p$g.lineElement,(p$J=p$J||p$L<p$m+p$R&&p$g.wordWrap)&&p$b();p$n.elements.push(p$f),p$n.h=Math.max(p$n.h,p$t),p$f.x=p$m,p$f.y=p$E,p$m+=p$R,p$n.w=p$m-p$C,p$n.y=p$E,p$e=Math.max(p$m+p$l,p$e)}else p$d||(p$m+=p$M.DIV_ELEMENT_PADDING),p$n.wordStartIndex=p$n.elements.length;if(p$E=p$n.y+p$n.h,p$G){var p$z=0,p$c=p$L;for(p$B=0,p$r=p$X.length;p$B<p$r;p$B++)p$X[p$B].updatePos(0,p$c,p$B,p$z,p$_,p$N,p$u),p$z+=Math.max(p$u,p$X[p$B].h+p$U);p$E=p$z}for(p$v&&(p$h.width=p$e),p$E>p$h.height&&(p$h.height=p$E),p$B=0,p$r=p$X.length;p$B<p$r;p$B++)p$X[p$B].revertOrder(p$L);return[p$e,p$E]},p$M._will=null,p$M.DIV_ELEMENT_PADDING=0,p$M}(),p$T=function(){function p$h(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}p$S(p$h,"laya.html.utils.LayoutLine");var p$q=p$h.prototype;return p$q.updatePos=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){var p$B,p$r=0;0<this.elements.length&&(p$r=(p$B=this.elements[this.elements.length-1]).x+p$B.width-this.elements[0].x);var p$Y=0,p$C=NaN;1===p$$&&(p$Y=(p$q-p$r)/2),2===p$$&&(p$Y=p$q-p$r),0===p$S||0!=p$P||(p$P=1);for(var p$U=0,p$u=this.elements.length;p$U<p$u;p$U++){var p$v=(p$B=this.elements[p$U])._getCSSStyle();switch(0!==p$Y&&(p$B.x+=p$Y),p$v._getValign()){case 0:p$B.y=p$g;break;case 1:var p$L=0;99999!=this.minTextHeight&&(p$L=this.minTextHeight);var p$e=(p$L+p$S)/2;p$e=Math.max(p$e,this.h),p$C=(laya.html.dom.HTMLImageElement,p$g+p$e-p$B.height),p$B.y=p$C;break;case 2:p$B.y=p$g+(p$S-p$B.height)}}},p$q.revertOrder=function(p$h){var p$q;if(0<this.elements.length){var p$f,p$g=0;for(p$f=this.elements.length,p$g=0;p$g<p$f;p$g++)(p$q=this.elements[p$g]).x=p$h-p$q.x-p$q.width}},p$h}(),p$E=function(p$f){function p$q(){this.URI=null,this._href=null,p$q.__super.call(this),this._text=p$q._EMPTYTEXT,this.setStyle(new p$r(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}p$S(p$q,"laya.html.dom.HTMLElement",p$f);var p$h=p$q.prototype;return p$h.layaoutCallNative=function(){var p$h=0;if(this._childs&&0<(p$h=this._childs.length))for(var p$q=0;p$q<p$h;p$q++)this._childs[p$q].layaoutCallNative&&this._childs[p$q].layaoutCallNative();var p$f=this._getWords();p$f?laya.html.dom.HTMLElement.fillWords(this,p$f,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},p$h.appendChild=function(p$h){return this.addChild(p$h)},p$h._getWords2=function(){var p$h=this._text.text;if(!p$h||0===p$h.length)return null;var p$q,p$f,p$g=0,p$$=0;if(this._text.drawWords)p$f=this._text.drawWords;else{for(p$$=(p$q=p$h.split(" ")).length-1,p$f=[],p$g=0;p$g<p$$;p$g++)p$f.push(p$q[p$g]," ");0<=p$$&&p$f.push(p$q[p$$]),this._text.drawWords=p$f}var p$P,p$S=this._text.words;if(p$S&&p$S.length===p$f.length)return p$S;null===p$S&&(this._text.words=p$S=[]),p$S.length=p$f.length;var p$B=this.style,p$r=p$B.font;for(p$g=0,p$$=p$f.length;p$g<p$$;p$g++){p$P=p$N.measureText(p$f[p$g],p$r);var p$Y=p$S[p$g]=new p$U(p$f[p$g],p$P.width,p$P.height||p$B.fontSize,p$B);if(1<p$Y.char.length&&(p$Y.charNum=p$Y.char),this.href){var p$C=new p$v;this.addChild(p$C),p$Y.setSprite(p$C)}}return p$S},p$h._getWords=function(){if(!p$W.CharacterCache)return this._getWords2();var p$h=this._text.text;if(!p$h||0===p$h.length)return null;var p$q,p$f=this._text.words;if(p$f&&p$f.length===p$h.length)return p$f;null===p$f&&(this._text.words=p$f=[]),p$f.length=p$h.length;for(var p$g=this.style,p$$=p$g.font,p$P=0,p$S=p$h.length;p$P<p$S;p$P++)if(p$q=p$N.measureText(p$h.charAt(p$P),p$$)){var p$B=p$f[p$P]=new p$U(p$h.charAt(p$P),p$q.width,p$q.height||p$g.fontSize,p$g);if(this.href){var p$r=new p$v;this.addChild(p$r),p$B.setSprite(p$r)}}else console.warn("_getWords size is null"+p$h.charAt(p$P),p$$);return p$f},p$h.showLinkSprite=function(){var p$h=this._text.words;if(p$h)for(var p$q,p$f,p$g=[],p$$=0;p$$<p$h.length;p$$++)p$f=p$h[p$$],(p$q=new p$v).graphics.drawRect(0,0,p$f.width,p$f.height,"#ff0000"),p$q.width=p$f.width,p$q.height=p$f.height,this.addChild(p$q),p$g.push(p$q)},p$h._layoutLater=function(){var p$h=this.style;512&p$h._type||(p$h.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&p$h.block?(p$m.later(this),p$h._type|=512):this.parent&&this.parent._layoutLater())},p$h._setAttributes=function(p$h,p$q){switch(p$h){case"style":return void this.style.cssText(p$q);case"class":return void(this.className=p$q)}p$f.prototype._setAttributes.call(this,p$h,p$q)},p$h.updateHref=function(){if(null!=this._href){var p$h=this._getWords();if(p$h)for(var p$q,p$f,p$g=0;p$g<p$h.length;p$g++)(p$f=(p$q=p$h[p$g]).getSprite())&&(p$f.size(p$q.width,p$q.height),p$f.on("click",this,this.onLinkHandler))}},p$h.onLinkHandler=function(p$h){switch(p$h.type){case"click":for(var p$q=this;p$q;)p$q.event("link",[this.href]),p$q=p$q.parent}},p$h.formatURL=function(p$h){return this.URI?p$_.formatURL(p$h,this.URI?this.URI.path:null):p$h},p$B(0,p$h,"href",function(){return this._href},function(p$h){null!=(this._href=p$h)&&(this._getCSSStyle().underLine=1,this.updateHref())}),p$B(0,p$h,"color",null,function(p$h){this.style.color=p$h}),p$B(0,p$h,"onClick",null,function(p$h){p$g._runScript("fn=function(event){"+p$h+";}"),this.on("click",this,void 0)}),p$B(0,p$h,"id",null,function(p$h){p$R.document.setElementById(p$h,this)}),p$B(0,p$h,"innerTEXT",function(){return this._text.text},function(p$h){this.text=p$h}),p$B(0,p$h,"style",function(){return this._style}),p$B(0,p$h,"text",function(){return this._text.text},function(p$h){this._text==p$q._EMPTYTEXT?this._text={text:p$h,words:null}:(this._text.text=p$h,this._text.words&&(this._text.words.length=0)),p$u.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),p$B(0,p$h,"parent",p$f.prototype._$get_parent,function(p$h){if(p$h instanceof laya.html.dom.HTMLElement){var p$q=p$h;this.URI||(this.URI=p$q.URI),this.style.inherit(p$q.style)}p$g.superSet(p$v,this,"parent",p$h)}),p$B(0,p$h,"className",null,function(p$h){this.style.attrs(p$R.document.styleSheets["."+p$h])}),p$q.fillWords=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$h.graphics.clear();for(var p$B=0,p$r=p$q.length;p$B<p$r;p$B++){var p$Y=p$q[p$B];p$h.graphics.fillText(p$Y.char,p$Y.x+p$f,p$Y.y+p$g,p$$,p$P,"left",p$S)}},p$q._EMPTYTEXT={text:null,words:null},p$q}(p$v),p$q=(function(p$h){function p$q(){p$q.__super.call(this),this.style.lineElement=!0,this.style.block=!0}p$S(p$q,"laya.html.dom.HTMLBrElement",p$E)}(),function(p$h){function p$q(){this.contextHeight=NaN,this.contextWidth=NaN,p$q.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}p$S(p$q,"laya.html.dom.HTMLDivElement",p$h);var p$f=p$q.prototype;return p$f.appendHTML=function(p$h){p$G.parse(this,p$h,this.URI),this.layout()},p$f._addChildsToLayout=function(p$q){var p$h=this._getWords();if(null==p$h&&0==this._childs.length)return!1;p$h&&p$h.forEach(function(p$h){p$q.push(p$h)});for(var p$f=!0,p$g=0,p$$=this._childs.length;p$g<p$$;p$g++){var p$P=this._childs[p$g];p$f?p$f=!1:p$q.push(null),p$P._addToLayout(p$q)}return!0},p$f._addToLayout=function(p$h){this.layout()},p$f.layout=function(){if(this.style){this.style._type|=512;var p$h=p$m.layout(this);if(p$h){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new p$C);var p$q=this._$P.mHtmlBounds;p$q.x=p$q.y=0,p$q.width=this.contextWidth=p$h[0],p$q.height=this.contextHeight=p$h[1],this.setBounds(p$q)}}},p$B(0,p$f,"height",function(){return this._height?this._height:this.contextHeight},p$h.prototype._$set_height),p$B(0,p$f,"innerHTML",null,function(p$h){this.destroyChildren(),this.appendHTML(p$h)}),p$B(0,p$f,"width",function(){return this._width?this._width:this.contextWidth},function(p$h){var p$q=!1;p$q=0===p$h?p$h!=this._width:p$h!=this.width,p$g.superSet(p$E,this,"width",p$h),p$q&&this.layout()}),p$q}(p$E)),p$R=function(p$h){function p$q(){this.all=new Array,this.styleSheets=p$r.styleSheets,p$q.__super.call(this)}p$S(p$q,"laya.html.dom.HTMLDocument",p$E);var p$f=p$q.prototype;return p$f.getElementById=function(p$h){return this.all[p$h]},p$f.setElementById=function(p$h,p$q){this.all[p$h]=p$q},p$$(p$q,["document",function(){return this.document=new p$q}]),p$q}();(function(p$h){function p$q(){this._tex=null,this._url=null,this._renderArgs=[],p$q.__super.call(this),this.style.block=!0}p$S(p$q,"laya.html.dom.HTMLImageElement",p$E);var p$f=p$q.prototype;p$f._addToLayout=function(p$h){!this._style.absolute&&p$h.push(this)},p$f.render=function(p$h,p$q,p$f){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(p$e.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,p$h.ctx.drawTexture2(p$q,p$f,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},p$f.layaoutCallNative=function(){var p$h=0;if(this._childs&&0<(p$h=this._childs.length))for(var p$q=0;p$q<p$h;p$q++)this._childs[p$q].layaoutCallNative&&this._childs[p$q].layaoutCallNative()},p$B(0,p$f,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(p$h){this._width!==p$h&&(this._width=p$h,this._style.width=p$h,this.repaint())}),p$B(0,p$f,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(p$h){this._height!==p$h&&(this._height=p$h,this._style.height=p$h,this.repaint())}),p$f.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),p$Y.clearCache(this,this._url),this._tex=null),p$E.prototype.destroy.call(this)},p$f.onloaded=function(){var p$h=this._style;p$h&&!p$h.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),p$h&&!p$h.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),p$u.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},p$f._loadImageComplete=function(p$h,p$q,p$f){if(!this._destroyed)if(null!=p$f)if(p$f instanceof ArrayBuffer){var p$g=new DataView(p$f);new laya.webgl.resource.WebGLImage(new Uint8Array(p$f,8),p$h,0,!1,p$g.getUint32(0),p$g.getUint32(4));this.onloaded()}else if(p$f instanceof p$l)p$Y.imgMgrSet[p$h]=p$q,p$P.imgMgrLock(p$h,p$Y.imgMgrSet[p$h]),this._url=p$h,this._tex=p$f,p$Y.keepCache(this,p$h),p$Y.cacheRes(p$h,this._tex),this.onloaded();else{var p$$=-1!=p$h.indexOf(".png",p$h.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(p$f,p$h,p$$,!1,p$f.width,p$f.height);this.onloaded()}else this.event("error","Load image failed")},p$B(0,p$f,"src",null,function(p$h){(p$h=this.formatURL(p$h),this._url!=p$h)&&(null!=this._tex&&(p$Y.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=p$h,(this._tex=p$Y.getRes(p$h))?(p$Y.keepCache(this,p$h),this.onloaded()):p$P.imgMgrLoad(p$h,this._loadImageComplete.bind(this),2,!1))})})(),function(p$h){function p$q(){this.type=null,p$q.__super.call(this),this.visible=!1}p$S(p$q,"laya.html.dom.HTMLLinkElement",p$h);var p$f=p$q.prototype;p$f._onload=function(p$h){switch(this.type){case"text/css":p$r.parseCSS(p$h,this.URI)}},p$B(0,p$f,"href",p$h.prototype._$get_href,function(p$h){var p$q=this;p$h=this.formatURL(p$h),this.URI=new p$_(p$h);var p$f=new p$Y;p$f.once("complete",null,function(p$h){p$q._onload(p$h)}),p$f.load(p$h,"text")}),p$q._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(p$E),function(p$h){function p$q(){p$q.__super.call(this),this.visible=!1}p$S(p$q,"laya.html.dom.HTMLStyleElement",p$h),p$B(0,p$q.prototype,"text",p$h.prototype._$get_text,function(p$h){p$r.parseCSS(p$h,null)})}(p$E),function(p$h){function p$q(){p$q.__super.call(this),this._getCSSStyle().valign="middle"}p$S(p$q,"laya.html.dom.HTMLIframeElement",p$h),p$B(0,p$q.prototype,"href",p$h.prototype._$get_href,function(p$f){var p$g=this;p$f=this.formatURL(p$f);var p$h=new p$Y;p$h.once("complete",null,function(p$h){var p$q=p$g.URI;p$g.URI=new p$_(p$f),p$g.innerHTML=p$h,!p$q||(p$g.URI=p$q)}),p$h.load(p$f,"text")})}(p$q)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(p$h,p$q){"use strict";for(var p$f in Object.defineProperty(p$q,"__esModule",{value:!0}),Laya){var p$g=Laya[p$f];p$g&&p$g.__isclass&&(p$q[p$f]=p$g)}}),function(p$h,p$q,p$e){p$e.un,p$e.uns;var p$g=p$e.static,p$P=p$e.class,p$$=p$e.getset,p$f=(p$e.__newvec,laya.display.Animation),p$l=(laya.utils.Browser,laya.utils.ClassUtils),p$S=laya.filters.ColorFilter,p$B=laya.utils.Ease,p$r=laya.events.Event,p$Y=(laya.events.EventDispatcher,laya.display.css.Font),p$C=laya.display.FrameAnimation,p$U=laya.display.Graphics,p$u=laya.utils.Handler,p$v=laya.display.Input,p$N=laya.net.Loader,p$L=(laya.display.Node,laya.maths.Point),p$_=laya.maths.Rectangle,p$G=laya.renders.Render,p$m=laya.display.Sprite,p$E=laya.display.Text,p$R=laya.resource.Texture,p$t=laya.utils.Tween,p$X=laya.utils.Utils,p$n=laya.utils.WeakObject;p$e.interface("laya.ui.IItem"),p$e.interface("laya.ui.ISelect"),p$e.interface("laya.ui.IRender"),p$e.interface("laya.ui.IComponent"),p$e.interface("laya.ui.IBox","IComponent");var p$J=function(){function p$h(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return p$P(p$h,"laya.ui.LayoutStyle"),p$g(p$h,["EMPTY",function(){return this.EMPTY=new p$h}]),p$h}(),p$p=function(){function p$h(){}return p$P(p$h,"laya.ui.Styles"),p$h.labelColor="#000000",p$h.buttonStateNum=3,p$h.scrollBarMinNum=15,p$h.scrollBarDelayTime=500,p$g(p$h,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),p$h}(),p$A=function(){function p$$(){}return p$P(p$$,"laya.ui.UIUtils"),p$$.fillArray=function(p$h,p$q,p$f){var p$g=p$h.concat();if(p$q)for(var p$$=p$q.split(","),p$P=0,p$S=Math.min(p$g.length,p$$.length);p$P<p$S;p$P++){var p$B=p$$[p$P];p$g[p$P]="true"==p$B||"false"!=p$B&&p$B,null!=p$f&&(p$g[p$P]=p$f(p$B))}return p$g},p$$.toColor=function(p$h){return p$X.toHexColor(p$h)},p$$.gray=function(p$h,p$q){void 0===p$q&&(p$q=!0),p$q?p$$.addFilter(p$h,p$$.grayFilter):p$$.clearFilter(p$h,p$S)},p$$.addFilter=function(p$h,p$q){var p$f=p$h.filters||[];p$f.push(p$q),p$h.filters=p$f},p$$.clearFilter=function(p$h,p$q){var p$f=p$h.filters;if(null!=p$f&&0<p$f.length){for(var p$g=p$f.length-1;-1<p$g;p$g--){var p$$=p$f[p$g];p$e.__typeof(p$$,p$q)&&p$f.splice(p$g,1)}p$h.filters=p$f}},p$$._getReplaceStr=function(p$h){return p$$.escapeSequence[p$h]},p$$.adptString=function(p$h){return p$h.replace(/\\(\w)/g,p$$._getReplaceStr)},p$$.getBindFun=function(p$h){var p$q=p$$._funMap.get(p$h);if(null==p$q){var p$f='"'+p$h+'"',p$g="(function(data){if(data==null)return;with(data){try{\nreturn "+(p$f=p$f.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";p$q=p$e._runScript(p$g),p$$._funMap.set(p$h,p$q)}return p$q},p$g(p$$,["grayFilter",function(){return this.grayFilter=new p$S([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new p$n}]),p$$}(),p$d=function(){function p$h(){}return p$P(p$h,"UIConfig"),p$h.touchScrollEnable=!0,p$h.mouseWheelEnable=!0,p$h.showButtons=!0,p$h.popupBgColor="#000000",p$h.popupBgAlpha=.5,p$h.closeDialogOnSide=!0,p$h}(),p$b=function(p$f){function p$_(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,p$_.__super.call(this),this._weakKeys=[]}p$P(p$_,"laya.ui.AutoBitmap",p$f);var p$h=p$_.prototype;return p$h.destroy=function(){if(p$N.clearObject(this,this._weakKey),this._weakKeys){for(var p$h=0,p$q=this._weakKeys.length;p$h<p$q;++p$h)p$N.clearObject(this,this._weakKeys[p$h]);this._weakKeys=null}p$f.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},p$h._setChanged=function(){this._isChanged||(this._isChanged=!0,p$e.timer.callLater(this,this.changeSource))},p$h.changeSource=function(){this._isChanged=!1;var p$h=this._source;if(p$h&&p$h.bitmap){var p$q=this.width,p$f=this.height,p$g=this._sizeGrid,p$$=p$h.sourceWidth,p$P=p$h.sourceHeight;if(!p$g||p$$===p$q&&p$P===p$f)this.cleanByTexture(p$h,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,p$q,p$f);else{p$N.clearObject(this,this._weakKey),p$h.$_GID||(p$h.$_GID=p$X.getGID());var p$S=p$h.$_GID+"."+p$q+"."+p$f+"."+p$g.join("."),p$B=p$N.findObject(p$S);if(p$X.isOKCmdList(p$B))return this._weakKey=p$S,p$N.keepObject(this,this._weakKey),void(this.cmds=p$B);this.clear();var p$r,p$Y,p$C=p$g[0],p$U=p$g[1],p$u=p$g[2],p$v=p$g[3],p$L=p$g[4],p$e=!1;if(p$q==p$$&&(p$v=p$U=0),p$f==p$P&&(p$C=p$u=0),p$q<p$v+p$U){var p$l=p$q;p$e=!0,p$q=p$v+p$U,this.save(),this.clipRect(0,0,p$l,p$f)}p$v&&p$C&&(p$r=p$_.getTexture(p$h,0,0,p$v,p$C),p$Y=this._weakKeys[0],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[0]=p$r.weakKey),this.drawTexture(p$r,0,0,p$v,p$C)):(p$N.clearObject(this,p$Y),this._weakKeys[0]="")),p$U&&p$C&&(p$r=p$_.getTexture(p$h,p$$-p$U,0,p$U,p$C),p$Y=this._weakKeys[1],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[1]=p$r.weakKey),this.drawTexture(p$r,p$q-p$U,0,p$U,p$C)):(p$N.clearObject(this,p$Y),this._weakKeys[1]="")),p$v&&p$u&&(p$r=p$_.getTexture(p$h,0,p$P-p$u,p$v,p$u),p$Y=this._weakKeys[2],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[2]=p$r.weakKey),this.drawTexture(p$r,0,p$f-p$u,p$v,p$u)):(p$N.clearObject(this,p$Y),this._weakKeys[2]="")),p$U&&p$u&&(p$r=p$_.getTexture(p$h,p$$-p$U,p$P-p$u,p$U,p$u),p$Y=this._weakKeys[3],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[3]=p$r.weakKey),this.drawTexture(p$r,p$q-p$U,p$f-p$u,p$U,p$u)):(p$N.clearObject(this,p$Y),this._weakKeys[3]="")),p$C&&(p$r=p$_.getTexture(p$h,p$v,0,p$$-p$v-p$U,p$C),p$Y=this._weakKeys[4],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[4]=p$r.weakKey),this.drawBitmap(p$L,p$r,p$v,0,p$q-p$v-p$U,p$C)):(p$N.clearObject(this,p$Y),this._weakKeys[4]="")),p$u&&(p$r=p$_.getTexture(p$h,p$v,p$P-p$u,p$$-p$v-p$U,p$u),p$Y=this._weakKeys[5],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[5]=p$r.weakKey),this.drawBitmap(p$L,p$r,p$v,p$f-p$u,p$q-p$v-p$U,p$u)):(p$N.clearObject(this,p$Y),this._weakKeys[5]="")),p$v&&(p$r=p$_.getTexture(p$h,0,p$C,p$v,p$P-p$C-p$u),p$Y=this._weakKeys[6],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[6]=p$r.weakKey),this.drawBitmap(p$L,p$r,0,p$C,p$v,p$f-p$C-p$u)):(p$N.clearObject(this,p$Y),this._weakKeys[6]="")),p$U&&(p$r=p$_.getTexture(p$h,p$$-p$U,p$C,p$U,p$P-p$C-p$u),p$Y=this._weakKeys[7],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[7]=p$r.weakKey),this.drawBitmap(p$L,p$r,p$q-p$U,p$C,p$U,p$f-p$C-p$u)):(p$N.clearObject(this,p$Y),this._weakKeys[7]="")),p$r=p$_.getTexture(p$h,p$v,p$C,p$$-p$v-p$U,p$P-p$C-p$u),p$Y=this._weakKeys[8],p$r?(p$Y!=p$r.weakKey&&(p$N.clearObject(this,p$Y),p$N.keepObject(this,p$r.weakKey),this._weakKeys[8]=p$r.weakKey),this.drawBitmap(p$L,p$r,p$v,p$C,p$q-p$v-p$U,p$f-p$C-p$u)):(p$N.clearObject(this,p$Y),this._weakKeys[8]=""),p$e&&this.restore(),this.autoCacheCmd&&!p$G.isConchApp&&(p$N.saveObject(p$S,this.cmds,null),this._weakKey=p$S,p$N.keepObject(this,this._weakKey))}this._repaint()}},p$h.drawBitmap=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=0),p$$<.1||p$P<.1||(!p$h||p$q.width==p$$&&p$q.height==p$P?this.drawTexture(p$q,p$f,p$g,p$$,p$P):this.fillTexture(p$q,p$f,p$g,p$$,p$P))},p$h.clear=function(p$h){void 0===p$h&&(p$h=!0),p$f.prototype.clear.call(this,!1)},p$$(0,p$h,"sizeGrid",function(){return this._sizeGrid},function(p$h){this._sizeGrid=p$h,this._setChanged()}),p$$(0,p$h,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(p$h){this._width!=p$h&&(this._width=p$h,this._setChanged())}),p$$(0,p$h,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(p$h){this._height!=p$h&&(this._height=p$h,this._setChanged())}),p$$(0,p$h,"source",function(){return this._source},function(p$h){p$h?(this._source=p$h,this._setChanged()):(this._source=null,this.clear())}),p$_.getTexture=function(p$h,p$q,p$f,p$g,p$$){p$g<=0&&(p$g=1),p$$<=0&&(p$$=1),p$h.$_GID||(p$h.$_GID=p$X.getGID());var p$P=p$h.$_GID+"."+p$q+"."+p$f+"."+p$g+"."+p$$,p$S=p$N.findObject(p$P);if((!p$S||!p$S.source)&&(p$S=p$R.createFromTexture(p$h,p$q,p$f,p$g,p$$))){if(p$h.alphaTexture){var p$B=p$h.width/p$h.alphaTexture.width;p$S.alphaTexture=p$R.createFromTexture(p$h.alphaTexture,p$q/p$B,p$f/p$B,p$g/p$B,p$$/p$B)}p$N.saveObject(p$P,p$S),p$S.weakKey=p$P}return p$S},p$_}(p$U),p$i=(function(p$h){function p$q(){p$q.__super.call(this)}p$P(p$q,"laya.ui.UIEvent",p$r),p$q.SHOW_TIP="showtip",p$q.HIDE_TIP="hidetip"}(),function(p$q){function p$h(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,p$h.__super.call(this),this._layout=p$J.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}p$P(p$h,"laya.ui.Component",p$q);var p$f=p$h.prototype;return p$e.imps(p$f,{"laya.ui.IComponent":!0}),p$f.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},p$f.preinitialize=function(){},p$f.createChildren=function(){},p$f.initialize=function(){},p$f.callLater=function(p$h,p$q){p$e.timer.callLater(this,p$h,p$q)},p$f.runCallLater=function(p$h){p$e.timer.runCallLater(this,p$h)},p$f.commitMeasure=function(){},p$f.changeSize=function(){this.event("resize")},p$f.getLayout=function(){return this._layout===p$J.EMPTY&&(this._layout=new p$J),this._layout},p$f._setLayoutEnabled=function(p$h){this._layout&&this._layout.enable!=p$h&&(this._layout.enable=p$h,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},p$f.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},p$f.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},p$f.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},p$f.resetLayoutX=function(){var p$h=this._layout;if(isNaN(p$h.anchorX)||(this.pivotX=p$h.anchorX*this.width),this.layoutEnabled){var p$q=this.parent;p$q&&(isNaN(p$h.centerX)?isNaN(p$h.left)?isNaN(p$h.right)||(this.x=Math.round(p$q.width-this.displayWidth-p$h.right+this.pivotX*this.scaleX)):(this.x=Math.round(p$h.left+this.pivotX*this.scaleX),isNaN(p$h.right)||(this.width=(p$q._width-p$h.left-p$h.right)/(this.scaleX||.01))):this.x=Math.round(.5*(p$q.width-this.displayWidth)+p$h.centerX+this.pivotX*this.scaleX))}},p$f.resetLayoutY=function(){var p$h=this._layout;if(isNaN(p$h.anchorY)||(this.pivotY=p$h.anchorY*this.height),this.layoutEnabled){var p$q=this.parent;p$q&&(isNaN(p$h.centerY)?isNaN(p$h.top)?isNaN(p$h.bottom)||(this.y=Math.round(p$q.height-this.displayHeight-p$h.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(p$h.top+this.pivotY*this.scaleY),isNaN(p$h.bottom)||(this.height=(p$q._height-p$h.top-p$h.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(p$q.height-this.displayHeight)+p$h.centerY+this.pivotY*this.scaleY))}},p$f.onMouseOver=function(p$h){p$e.stage.event("showtip",this._toolTip)},p$f.onMouseOut=function(p$h){p$e.stage.event("hidetip",this._toolTip)},p$$(0,p$f,"displayWidth",function(){return this.width*this.scaleX}),p$$(0,p$f,"width",function(){return this._width?this._width:this.measureWidth},function(p$h){this._width!=p$h&&(this._width=p$h,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),p$$(0,p$f,"measureWidth",function(){var p$h=0;this.commitMeasure();for(var p$q=this.numChildren-1;-1<p$q;p$q--){var p$f=this.getChildAt(p$q);p$f.visible&&(p$h=Math.max(p$f.x+p$f.width*p$f.scaleX,p$h))}return p$h}),p$$(0,p$f,"displayHeight",function(){return this.height*this.scaleY}),p$$(0,p$f,"height",function(){return this._height?this._height:this.measureHeight},function(p$h){this._height!=p$h&&(this._height=p$h,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),p$$(0,p$f,"dataSource",function(){return this._dataSource},function(p$h){for(var p$q in this._dataSource=p$h,this._dataSource)this.hasOwnProperty(p$q)&&"function"!=typeof this[p$q]&&(this[p$q]=this._dataSource[p$q])}),p$$(0,p$f,"scaleY",p$q.prototype._$get_scaleY,function(p$h){p$e.superGet(p$m,this,"scaleY")!=p$h&&(p$e.superSet(p$m,this,"scaleY",p$h),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),p$$(0,p$f,"measureHeight",function(){var p$h=0;this.commitMeasure();for(var p$q=this.numChildren-1;-1<p$q;p$q--){var p$f=this.getChildAt(p$q);p$f.visible&&(p$h=Math.max(p$f.y+p$f.height*p$f.scaleY,p$h))}return p$h}),p$$(0,p$f,"scaleX",p$q.prototype._$get_scaleX,function(p$h){p$e.superGet(p$m,this,"scaleX")!=p$h&&(p$e.superSet(p$m,this,"scaleX",p$h),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),p$$(0,p$f,"top",function(){return this._layout.top},function(p$h){p$h!=this._layout.top&&(this.getLayout().top=p$h,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$$(0,p$f,"bottom",function(){return this._layout.bottom},function(p$h){p$h!=this._layout.bottom&&(this.getLayout().bottom=p$h,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$$(0,p$f,"left",function(){return this._layout.left},function(p$h){p$h!=this._layout.left&&(this.getLayout().left=p$h,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$$(0,p$f,"right",function(){return this._layout.right},function(p$h){p$h!=this._layout.right&&(this.getLayout().right=p$h,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$$(0,p$f,"centerX",function(){return this._layout.centerX},function(p$h){p$h!=this._layout.centerX&&(this.getLayout().centerX=p$h,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$$(0,p$f,"centerY",function(){return this._layout.centerY},function(p$h){p$h!=this._layout.centerY&&(this.getLayout().centerY=p$h,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$$(0,p$f,"anchorX",function(){return this._layout.anchorX},function(p$h){p$h!=this._layout.anchorX&&(this.getLayout().anchorX=p$h,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$$(0,p$f,"anchorY",function(){return this._layout.anchorY},function(p$h){p$h!=this._layout.anchorY&&(this.getLayout().anchorY=p$h,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$$(0,p$f,"tag",function(){return this._tag},function(p$h){this._tag=p$h}),p$$(0,p$f,"toolTip",function(){return this._toolTip},function(p$h){this._toolTip!=p$h&&(null!=(this._toolTip=p$h)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),p$$(0,p$f,"comXml",function(){return this._comXml},function(p$h){this._comXml=p$h}),p$$(0,p$f,"gray",function(){return this._gray},function(p$h){p$h!==this._gray&&(this._gray=p$h,p$A.gray(this,p$h))}),p$$(0,p$f,"disabled",function(){return this._disabled},function(p$h){p$h!==this._disabled&&(this.gray=this._disabled=p$h,this.mouseEnabled=!p$h)}),p$h}(p$m)),p$z=function(p$h){function p$q(){this.lockLayer=null,this.popupEffect=function(p$h){p$h.scale(1,1),p$t.from(p$h,{x:p$e.stage.width/2,y:p$e.stage.height/2,scaleX:0,scaleY:0},300,p$B.backOut,p$u.create(this,this.doOpen,[p$h]))},this.closeEffect=function(p$h,p$q){p$t.to(p$h,{x:p$e.stage.width/2,y:p$e.stage.height/2,scaleX:0,scaleY:0},300,p$B.strongOut,p$u.create(this,this.doClose,[p$h,p$q]))},p$q.__super.call(this),this.maskLayer=new p$m,this.popupEffectHandler=p$u.create(this,this.popupEffect,null,!1),this.closeEffectHandler=p$u.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,p$e.stage.addChild(this),p$e.stage.on("resize",this,this._onResize),p$d.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}p$P(p$q,"laya.ui.DialogManager",p$m);var p$f=p$q.prototype;return p$f._closeOnSide=function(){var p$h=this.getChildAt(this.numChildren-1);p$h instanceof laya.ui.Dialog&&p$h.close("side")},p$f.setLockView=function(p$h){this.lockLayer||(this.lockLayer=new p$c,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(p$e.stage.width,p$e.stage.height)),this.lockLayer.removeChildren(),p$h&&(p$h.centerX=p$h.centerY=0,this.lockLayer.addChild(p$h))},p$f._onResize=function(p$h){var p$q=this.maskLayer.width=p$e.stage.width,p$f=this.maskLayer.height=p$e.stage.height;this.lockLayer&&this.lockLayer.size(p$q,p$f),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,p$q,p$f,p$d.popupBgColor),this.maskLayer.alpha=p$d.popupBgAlpha;for(var p$g=this.numChildren-1;-1<p$g;p$g--){var p$$=this.getChildAt(p$g);p$$.popupCenter&&this._centerDialog(p$$)}},p$f._centerDialog=function(p$h){p$h.x=Math.round((p$e.stage.width-p$h.width>>1)+p$h.pivotX),p$h.y=Math.round((p$e.stage.height-p$h.height>>1)+p$h.pivotY)},p$f.open=function(p$h,p$q,p$f){void 0===p$q&&(p$q=!1),void 0===p$f&&(p$f=!1),p$q&&this._closeAll(),p$h.popupCenter&&this._centerDialog(p$h),this.addChild(p$h),(p$h.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),p$f&&null!=p$h.popupEffect?p$h.popupEffect.runWith(p$h):this.doOpen(p$h),this.event("open")},p$f.doOpen=function(p$h){p$h.onOpened()},p$f.lock=function(p$h){this.lockLayer&&(p$h?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},p$f.close=function(p$h,p$q,p$f){void 0===p$f&&(p$f=!1),p$f&&null!=p$h.closeEffect?p$h.closeEffect.runWith([p$h,p$q]):this.doClose(p$h,p$q),this.event("close")},p$f.doClose=function(p$h,p$q){p$h.removeSelf(),p$h.isModal&&this._checkMask(),p$h.closeHandler&&p$h.closeHandler.runWith(p$q),p$h.onClosed(p$q)},p$f.closeAll=function(){this._closeAll(),this.event("close")},p$f._closeAll=function(){for(var p$h=this.numChildren-1;-1<p$h;p$h--){var p$q=this.getChildAt(p$h);p$q&&null!=p$q.close&&this.doClose(p$q)}},p$f.getDialogsByGroup=function(p$h){for(var p$q=[],p$f=this.numChildren-1;-1<p$f;p$f--){var p$g=this.getChildAt(p$f);p$g&&p$g.group===p$h&&p$q.push(p$g)}return p$q},p$f.closeByGroup=function(p$h){for(var p$q=[],p$f=this.numChildren-1;-1<p$f;p$f--){var p$g=this.getChildAt(p$f);p$g&&p$g.group===p$h&&(p$g.close(),p$q.push(p$g))}return p$q},p$f._checkMask=function(){this.maskLayer.removeSelf();for(var p$h=this.numChildren-1;-1<p$h;p$h--){var p$q=this.getChildAt(p$h);if(p$q&&p$q.isModal)return void this.addChildAt(this.maskLayer,p$h)}},p$q}(),p$c=function(p$h){function p$q(){p$q.__super.call(this)}p$P(p$q,"laya.ui.Box",p$h);var p$f=p$q.prototype;return p$e.imps(p$f,{"laya.ui.IBox":!0}),p$$(0,p$f,"dataSource",p$h.prototype._$get_dataSource,function(p$h){for(var p$q in this._dataSource=p$h){var p$f=this.getChildByName(p$q);p$f?p$f.dataSource=p$h[p$q]:this.hasOwnProperty(p$q)&&"function"!=typeof this[p$q]&&(this[p$q]=p$h[p$q])}}),p$q}(p$i),p$M=function(p$q){function p$f(p$h,p$q){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,p$f.__super.call(this),this._labelColors=p$p.buttonLabelColors,this._stateNum=p$p.buttonStateNum,void 0===p$q&&(p$q=""),this.skin=p$h,this.label=p$q}p$P(p$f,"laya.ui.Button",p$q);var p$h=p$f.prototype;return p$e.imps(p$h,{"laya.ui.ISelect":!0}),p$h.destroy=function(p$h){p$N.clearCache(this,this._skin),p$N.clearObject(this,this._weakKey),void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(p$h),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},p$h.createChildren=function(){this.graphics=this._bitmap=new p$b},p$h.createText=function(){this._text||(this._text=new p$E,this._text.overflow=p$E.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},p$h.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},p$h.onMouse=function(p$h){if(!1!==this.toggle||!this._selected)return"click"===p$h.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=p$f.stateMap[p$h.type]))},p$h.changeClips=function(){var p$h=p$N.getRes(this._skin);if(p$h&&this._skin&&""!=this._skin){p$N.clearObject(this,this._weakKey);var p$q=p$h.sourceWidth,p$f=p$h.sourceHeight/this._stateNum;p$h.$_GID||(p$h.$_GID=p$X.getGID());var p$g=p$h.$_GID+"-"+this._stateNum,p$$=p$N.findObject(p$g);if(p$X.isOkTextureList(p$$)||(p$$=null),p$$)this._weakKey=p$g,p$N.keepObject(this,this._weakKey),this._sources=p$$;else{if(this._sources=[],1===this._stateNum)this._sources.push(p$h);else for(var p$P=0;p$P<this._stateNum;p$P++){var p$S=p$R.createFromTexture(p$h,0,p$f*p$P,p$q,p$f);if(p$h.alphaTexture){var p$B=p$h.width/p$h.alphaTexture.width;p$S.alphaTexture=p$R.createFromTexture(p$h.alphaTexture,0/p$B,p$f*p$P/p$B,p$q/p$B,p$f/p$B)}this._sources.push(p$S)}p$N.saveObject(p$g,this._sources),this._weakKey=p$g,p$N.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||p$q,this._bitmap.height=this._height||p$f,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=p$q)}else console.warn("lose skin ",this._skin,this.name,this.__className)},p$h.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var p$h=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[p$h]),this.label&&(this._text.color=this._labelColors[p$h],this._strokeColors&&(this._text.strokeColor=this._strokeColors[p$h]))},p$h._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},p$$(0,p$h,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(p$h){this.createText(),this._text.strokeColor=p$h}),p$$(0,p$h,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),p$$(0,p$h,"skin",function(){return this._skin},function(p$h){this._skin!=p$h&&(p$N.clearCache(this,this._skin),this._skin=p$h,p$N.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),p$$(0,p$h,"state",function(){return this._state},function(p$h){this._state!=p$h&&(this._state=p$h,this._setStateChanged())}),p$$(0,p$h,"text",function(){return this.createText(),this._text}),p$$(0,p$h,"stateNum",function(){return this._stateNum},function(p$h){"string"==typeof p$h&&(p$h=parseInt(p$h)),this._stateNum!=p$h&&(this._stateNum=p$h<1?1:3<p$h?3:p$h,this.callLater(this.changeClips))}),p$$(0,p$h,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(p$h){this._strokeColors=p$A.fillArray(p$p.buttonLabelColors,p$h,String),this._setStateChanged()}),p$$(0,p$h,"labelColors",function(){return this._labelColors.join(",")},function(p$h){this._labelColors=p$A.fillArray(p$p.buttonLabelColors,p$h,String),this._setStateChanged()}),p$$(0,p$h,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),p$$(0,p$h,"label",function(){return this._text?this._text.text:null},function(p$h){(this._text||p$h)&&(this.createText(),this._text.text!=p$h&&(p$h&&!this._text.parent&&this.addChild(this._text),this._text.text=(p$h+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),p$$(0,p$h,"selected",function(){return this._selected},function(p$h){this._selected!=p$h&&(this._selected=p$h,this.state=this._selected?2:0,this.event("change"))}),p$$(0,p$h,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(p$h){this.createText(),this._text.padding=p$A.fillArray(p$p.labelPadding,p$h,Number)}),p$$(0,p$h,"labelSize",function(){return this.createText(),this._text.fontSize},function(p$h){this.createText(),this._text.fontSize=p$h}),p$$(0,p$h,"labelStroke",function(){return this.createText(),this._text.stroke},function(p$h){this.createText(),this._text.stroke=p$h}),p$$(0,p$h,"labelBold",function(){return this.createText(),this._text.bold},function(p$h){this.createText(),this._text.bold=p$h}),p$$(0,p$h,"labelFont",function(){return this.createText(),this._text.font},function(p$h){this.createText(),this._text.font=p$h}),p$$(0,p$h,"labelAlign",function(){return this.createText(),this._text.align},function(p$h){this.createText(),this._text.align=p$h}),p$$(0,p$h,"clickHandler",function(){return this._clickHandler},function(p$h){this._clickHandler=p$h}),p$$(0,p$h,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(p$h){this._bitmap.sizeGrid=p$A.fillArray(p$p.defaultSizeGrid,p$h,Number)}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$i,this,"width",p$h),this._autoSize&&(this._bitmap.width=p$h,this._text&&(this._text.width=p$h))}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$i,this,"height",p$h),this._autoSize&&(this._bitmap.height=p$h,this._text&&(this._text.height=p$h))}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)||"string"==typeof p$h?this.label=p$h+"":p$e.superSet(p$i,this,"dataSource",p$h)}),p$$(0,p$h,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(p$h){this._bitmap._offset=p$h?p$A.fillArray([1,1],p$h,Number):[]}),p$g(p$f,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),p$f}(p$i),p$W=function(p$q){function p$g(p$h,p$q,p$f){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,p$g.__super.call(this),void 0===p$q&&(p$q=1),void 0===p$f&&(p$f=1),this._clipX=p$q,this._clipY=p$f,this.skin=p$h}p$P(p$g,"laya.ui.Clip",p$q);var p$h=p$g.prototype;return p$h.destroy=function(p$h){p$N.clearCache(this,this._skin),p$N.clearObject(this,this._weakKey),void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},p$h.dispose=function(){this.destroy(!0),p$e.loader.clearRes(this._skin)},p$h.createChildren=function(){this.graphics=this._bitmap=new p$b},p$h._onDisplay=function(p$h){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},p$h.changeClip=function(){if(this._clipChanged=!1,this._skin){var p$h=p$N.getRes(this._skin);p$h?this.loadComplete(this._skin,p$h):p$e.loader.load(this._skin,p$u.create(this,this.loadComplete,[this._skin]))}},p$h.loadComplete=function(p$h,p$q){if(p$h===this._skin&&p$q){p$N.clearObject(this,this._weakKey);var p$f=this._clipWidth||Math.ceil(p$q.sourceWidth/this._clipX),p$g=this._clipHeight||Math.ceil(p$q.sourceHeight/this._clipY),p$$=this._skin+p$f+p$g,p$P=p$N.findObject(p$$);if(p$X.isOkTextureList(p$P)||(p$P=null),p$P)this._weakKey=p$$,p$N.keepObject(this,this._weakKey),this._sources=p$P;else{this._sources=[];for(var p$S=0;p$S<this._clipY;p$S++)for(var p$B=0;p$B<this._clipX;p$B++){var p$r=p$R.createFromTexture(p$q,p$f*p$B,p$g*p$S,p$f,p$g);if(p$q.alphaTexture){var p$Y=p$q.width/p$q.alphaTexture.width;p$r.alphaTexture=p$R.createFromTexture(p$q.alphaTexture,p$f*p$B/p$Y,p$g*p$S/p$Y,p$f/p$Y,p$g/p$Y)}this._sources.push(p$r)}p$N.saveObject(p$$,this._sources),this._weakKey=p$$,p$N.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},p$h.play=function(p$h,p$q){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=-1),this._isPlaying=!0,this.index=p$h,this._toIndex=p$q,this._index++,p$e.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},p$h._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},p$h.stop=function(){this._isPlaying=!1,p$e.timer.clear(this,this._loop),this.event("complete")},p$h._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},p$$(0,p$h,"interval",function(){return this._interval},function(p$h){this._interval!=p$h&&(this._interval=p$h,this._isPlaying&&this.play())}),p$$(0,p$h,"skin",function(){return this._skin},function(p$h){this._skin!=p$h&&(p$N.clearCache(this,this._skin),(this._skin=p$h)?(p$N.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),p$$(0,p$h,"sources",function(){return this._sources},function(p$h){this._sources=p$h,this.index=this._index,this.event("loaded")}),p$$(0,p$h,"clipX",function(){return this._clipX},function(p$h){this._clipX=p$h||1,this._setClipChanged()}),p$$(0,p$h,"clipY",function(){return this._clipY},function(p$h){this._clipY=p$h||1,this._setClipChanged()}),p$$(0,p$h,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),p$$(0,p$h,"clipWidth",function(){return this._clipWidth},function(p$h){this._clipWidth=p$h,this._setClipChanged()}),p$$(0,p$h,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(p$h){this._bitmap.sizeGrid=p$A.fillArray(p$p.defaultSizeGrid,p$h,Number)}),p$$(0,p$h,"group",function(){return this._group},function(p$h){p$h&&this._skin&&p$N.setGroup(this._skin,p$h),this._group=p$h}),p$$(0,p$h,"clipHeight",function(){return this._clipHeight},function(p$h){this._clipHeight=p$h,this._setClipChanged()}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$i,this,"width",p$h),this._bitmap.width=p$h}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$i,this,"height",p$h),this._bitmap.height=p$h}),p$$(0,p$h,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),p$$(0,p$h,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),p$$(0,p$h,"index",function(){return this._index},function(p$h){this._index=p$h,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[p$h]),this.event("change")}),p$$(0,p$h,"autoPlay",function(){return this._autoPlay},function(p$h){this._autoPlay!=p$h&&((this._autoPlay=p$h)?this.play():this.stop())}),p$$(0,p$h,"isPlaying",function(){return this._isPlaying},function(p$h){this._isPlaying=p$h}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)&&Math.floor(p$h)==p$h||"string"==typeof p$h?this.index=parseInt(p$h):p$e.superSet(p$i,this,"dataSource",p$h)}),p$$(0,p$h,"bitmap",function(){return this._bitmap}),p$g}(p$i),p$T=function(p$q){function p$h(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,p$h.__super.call(this)}p$P(p$h,"laya.ui.ColorPicker",p$q);var p$f=p$h.prototype;return p$f.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._colorPanel&&this._colorPanel.destroy(p$h),this._colorButton&&this._colorButton.destroy(p$h),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},p$f.createChildren=function(){this.addChild(this._colorButton=new p$M),this._colorPanel=new p$c,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new p$m),this._colorPanel.addChild(this._colorBlock=new p$m),this._colorPanel.addChild(this._colorInput=new p$v)},p$f.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},p$f.onPanelMouseDown=function(p$h){p$h.stopPropagation()},p$f.changePanel=function(){this._panelChanged=!1;var p$h=this._colorPanel.graphics;p$h.clear(),p$h.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(p$h=this._colorTiles.graphics).clear();for(var p$q=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],p$f=0;p$f<12;p$f++)for(var p$g=0;p$g<20;p$g++){var p$$=0;p$$=0===p$g?p$q[p$f]:1===p$g?0:51*(((3*p$f+p$g/6)%3<<0)+3*(p$f/6<<0))<<16|p$g%6*51<<8|(p$f<<0)%6*51;var p$P=p$A.toColor(p$$);this._colors.push(p$P);var p$S=p$g*this._gridSize,p$B=p$f*this._gridSize;p$h.drawRect(p$S,p$B,this._gridSize,this._gridSize,p$P,"#000000")}},p$f.onColorButtonClick=function(p$h){this._colorPanel.parent?this.close():this.open()},p$f.open=function(){var p$h=this.localToGlobal(new p$L),p$q=p$h.x+this._colorPanel.width<=p$e.stage.width?p$h.x:p$e.stage.width-this._colorPanel.width,p$f=p$h.y+this._colorButton.height;p$f=p$f+this._colorPanel.height<=p$e.stage.height?p$f:p$h.y-this._colorPanel.height,this._colorPanel.pos(p$q,p$f),this._colorPanel.zOrder=1001,p$e._currentStage.addChild(this._colorPanel),p$e.stage.on("mousedown",this,this.removeColorBox)},p$f.close=function(){p$e.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},p$f.removeColorBox=function(p$h){this.close()},p$f.onColorFieldKeyDown=function(p$h){13==p$h.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),p$h.stopPropagation())},p$f.onColorInputChange=function(p$h){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},p$f.onColorTilesClick=function(p$h){this.selectedColor=this.getColorByMouse(),this.close()},p$f.onColorTilesMouseMove=function(p$h){this._colorInput.focus=!1;var p$q=this.getColorByMouse();this._colorInput.text=p$q,this.drawBlock(p$q)},p$f.getColorByMouse=function(){var p$h=this._colorTiles.getMousePoint(),p$q=Math.floor(p$h.x/this._gridSize),p$f=Math.floor(p$h.y/this._gridSize);return this._colors[20*p$f+p$q]},p$f.drawBlock=function(p$h){var p$q=this._colorBlock.graphics;p$q.clear();var p$f=p$h||"#ffffff";p$q.drawRect(0,0,50,20,p$f,this._borderColor),p$h||p$q.drawLine(0,0,50,20,"#ff0000")},p$f.changeColor=function(){var p$h=this.graphics;p$h.clear();var p$q=this._selectedColor||"#000000";p$h.drawRect(0,0,this._colorButton.width,this._colorButton.height,p$q)},p$f._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},p$$(0,p$f,"inputBgColor",function(){return this._inputBgColor},function(p$h){this._inputBgColor=p$h,this._setPanelChanged()}),p$$(0,p$f,"selectedColor",function(){return this._selectedColor},function(p$h){this._selectedColor!=p$h&&(this._selectedColor=this._colorInput.text=p$h,this.drawBlock(p$h),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",p$r.EMPTY.setTo("change",this,this)))}),p$$(0,p$f,"skin",function(){return this._colorButton.skin},function(p$h){this._colorButton.skin=p$h,this.changeColor()}),p$$(0,p$f,"bgColor",function(){return this._bgColor},function(p$h){this._bgColor=p$h,this._setPanelChanged()}),p$$(0,p$f,"borderColor",function(){return this._borderColor},function(p$h){this._borderColor=p$h,this._setPanelChanged()}),p$$(0,p$f,"inputColor",function(){return this._inputColor},function(p$h){this._inputColor=p$h,this._setPanelChanged()}),p$h}(p$i),p$I=function(p$q){function p$f(p$h,p$q){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,p$f.__super.call(this),this._itemColors=p$p.comboBoxItemColors,this.skin=p$h,this.labels=p$q}p$P(p$f,"laya.ui.ComboBox",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._button&&this._button.destroy(p$h),this._list&&this._list.destroy(p$h),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},p$h.createChildren=function(){this.addChild(this._button=new p$M),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},p$h._createList=function(){this._list=new p$Z,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},p$h._setListEvent=function(p$h){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=p$u.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},p$h.onListDown=function(p$h){p$h.stopPropagation()},p$h.onScrollBarDown=function(p$h){p$h.stopPropagation()},p$h.onButtonMouseDown=function(p$h){this.callLater(this.switchTo,[!this._isOpen])},p$h.changeList=function(){this._listChanged=!1;var p$h=this.width-2,p$q=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:p$h,height:this._itemHeight,fontSize:this._itemSize,color:p$q}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},p$h.onlistItemMouse=function(p$h,p$q){var p$f=p$h.type;if("mouseover"===p$f||"mouseout"===p$f){if(this._isCustomList)return;var p$g=this._list.getCell(p$q);if(!p$g)return;var p$$=p$g.getChildByName("label");p$$&&("mouseover"===p$f?(p$$.bgColor=this._itemColors[0],p$$.color=this._itemColors[1]):(p$$.bgColor=null,p$$.color=this._itemColors[2]))}else"click"===p$f&&(this.selectedIndex=p$q,this.isOpen=!1)},p$h.switchTo=function(p$h){this.isOpen=p$h},p$h.changeOpen=function(){this.isOpen=!this._isOpen},p$h.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var p$h=this._list.graphics;p$h.clear(),p$h.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var p$q=this._list.array||[],p$f=p$q.length=0,p$g=this._labels.length;p$f<p$g;p$f++)p$q.push({label:this._labels[p$f]});this._list.height=this._listHeight,this._list.array=p$q},p$h.changeSelected=function(){this._button.label=this.selectedLabel},p$h._onStageMouseWheel=function(p$h){this._list&&!this._list.contains(p$h.target)&&this.removeList(null)},p$h.removeList=function(p$h){p$e.stage.off("mousedown",this,this.removeList),p$e.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},p$$(0,p$h,"selectedIndex",function(){return this._selectedIndex},function(p$h){this._selectedIndex!=p$h&&(this._selectedIndex=p$h,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[p$r.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),p$$(0,p$h,"measureHeight",function(){return this._button.height}),p$$(0,p$h,"skin",function(){return this._button.skin},function(p$h){this._button.skin!=p$h&&(this._button.skin=p$h,this._listChanged=!0)}),p$$(0,p$h,"measureWidth",function(){return this._button.width}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$i,this,"width",p$h),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),p$$(0,p$h,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(p$h){this.selectedIndex=this._labels.indexOf(p$h)}),p$$(0,p$h,"labels",function(){return this._labels.join(",")},function(p$h){0<this._labels.length&&(this.selectedIndex=-1),p$h?this._labels=p$h.split(","):this._labels.length=0,this._itemChanged=!0}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$i,this,"height",p$h),this._button.height=this._height}),p$$(0,p$h,"selectHandler",function(){return this._selectHandler},function(p$h){this._selectHandler=p$h}),p$$(0,p$h,"visibleNum",function(){return this._visibleNum},function(p$h){this._visibleNum=p$h,this._listChanged=!0}),p$$(0,p$h,"labelBold",function(){return this._button.text.bold},function(p$h){this._button.text.bold=p$h}),p$$(0,p$h,"itemColors",function(){return String(this._itemColors)},function(p$h){this._itemColors=p$A.fillArray(this._itemColors,p$h,String),this._listChanged=!0}),p$$(0,p$h,"itemSize",function(){return this._itemSize},function(p$h){this._itemSize=p$h,this._listChanged=!0}),p$$(0,p$h,"scrollBar",function(){return this.list.scrollBar}),p$$(0,p$h,"isOpen",function(){return this._isOpen},function(p$h){if(this._isOpen!=p$h)if(this._isOpen=p$h,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var p$q=this.localToGlobal(p$L.TEMP.setTo(0,0)),p$f=p$q.y+this._button.height;p$f=p$f+this._listHeight<=p$e.stage.height?p$f:p$q.y-this._listHeight,this._list.pos(p$q.x,p$f),this._list.zOrder=1001,p$e._currentStage.addChild(this._list),p$e.stage.once("mousedown",this,this.removeList),p$e.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),p$$(0,p$h,"scrollBarSkin",function(){return this._scrollBarSkin},function(p$h){this._scrollBarSkin=p$h}),p$$(0,p$h,"sizeGrid",function(){return this._button.sizeGrid},function(p$h){this._button.sizeGrid=p$h}),p$$(0,p$h,"button",function(){return this._button}),p$$(0,p$h,"list",function(){return this._list||this._createList(),this._list},function(p$h){p$h&&(p$h.removeSelf(),this._isCustomList=!0,this._list=p$h,this._setListEvent(p$h),this._itemHeight=p$h.getCell(0).height+p$h.spaceY)}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)&&Math.floor(p$h)==p$h||"string"==typeof p$h?this.selectedIndex=parseInt(p$h):p$h instanceof Array?this.labels=p$h.join(","):p$e.superSet(p$i,this,"dataSource",p$h)}),p$$(0,p$h,"labelColors",function(){return this._button.labelColors},function(p$h){this._button.labelColors!=p$h&&(this._button.labelColors=p$h)}),p$$(0,p$h,"labelPadding",function(){return this._button.text.padding.join(",")},function(p$h){this._button.text.padding=p$A.fillArray(p$p.labelPadding,p$h,Number)}),p$$(0,p$h,"labelSize",function(){return this._button.text.fontSize},function(p$h){this._button.text.fontSize=p$h}),p$$(0,p$h,"labelFont",function(){return this._button.text.font},function(p$h){this._button.text.font=p$h}),p$$(0,p$h,"stateNum",function(){return this._button.stateNum},function(p$h){this._button.stateNum=p$h}),p$f}(p$i),p$w=function(p$q){function p$f(p$h){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,p$f.__super.call(this),this._showButtons=p$d.showButtons,this._touchScrollEnable=p$d.touchScrollEnable,this._mouseWheelEnable=p$d.mouseWheelEnable,this.skin=p$h,this.max=1}p$P(p$f,"laya.ui.ScrollBar",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),this.stopScroll(),this.target=null,p$q.prototype.destroy.call(this,p$h),this.upButton&&this.upButton.destroy(p$h),this.downButton&&this.downButton.destroy(p$h),this.slider&&this.slider.destroy(p$h),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},p$h.createChildren=function(){this.addChild(this.slider=new p$k),this.addChild(this.upButton=new p$M),this.addChild(this.downButton=new p$M)},p$h.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},p$h.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},p$h.onButtonMouseDown=function(p$h){var p$q=p$h.currentTarget===this.upButton;this.slide(p$q),p$e.timer.once(p$p.scrollBarDelayTime,this,this.startLoop,[p$q]),p$e.stage.once("mouseup",this,this.onStageMouseUp)},p$h.startLoop=function(p$h){p$e.timer.frameLoop(1,this,this.slide,[p$h])},p$h.slide=function(p$h){p$h?this.value-=this._scrollSize:this.value+=this._scrollSize},p$h.onStageMouseUp=function(p$h){p$e.timer.clear(this,this.startLoop),p$e.timer.clear(this,this.slide)},p$h.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},p$h.changeSize=function(){p$q.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},p$h.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},p$h.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},p$h.setScroll=function(p$h,p$q,p$f){this.runCallLater(this.changeSize),this.slider.setSlider(p$h,p$q,p$f),this.slider.bar.visible=0<p$q,!this._hide&&this.autoHide&&(this.visible=!1)},p$h.onTargetMouseWheel=function(p$h){this.value-=p$h.delta*this._scrollSize,this.target=this._target},p$h.onTargetMouseDown=function(p$h){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new p$L),this._lastPoint.setTo(p$e.stage.mouseX,p$e.stage.mouseY),p$e.timer.clear(this,this.tweenMove),p$t.clearTween(this),p$e.stage.once("mouseup",this,this.onStageMouseUp2),p$e.stage.once("mouseout",this,this.onStageMouseUp2),p$e.timer.frameLoop(1,this,this.loop)},p$h.loop=function(){var p$h=p$e.stage.mouseY,p$q=p$e.stage.mouseX;if(this._lastOffset=this.isVertical?p$h-this._lastPoint.y:p$q-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?p$e.stage._canvasTransform.getScaleY():p$e.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=p$q,this._lastPoint.y=p$h,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},p$h.onStageMouseUp2=function(p$h){if(p$e.stage.off("mouseup",this,this.onStageMouseUp2),p$e.stage.off("mouseout",this,this.onStageMouseUp2),p$e.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?p$t.to(this,{value:this.min},this.elasticBackTime,p$B.sineOut,p$u.create(this,this.elasticOver)):this._value>this.max&&p$t.to(this,{value:this.max},this.elasticBackTime,p$B.sineOut,p$u.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?p$e.stage.mouseY-this._lastPoint.y:p$e.stage.mouseX-this._lastPoint.x);for(var p$q=0,p$f=Math.min(this._offsets.length,3),p$g=0;p$g<p$f;p$g++)p$q+=this._offsets[this._offsets.length-1-p$g];if(this._lastOffset=p$q/p$f,(p$q=Math.abs(this._lastOffset))<2)return void this.event("end");60<p$q&&(this._lastOffset=0<this._lastOffset?60:-60);var p$$=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));p$e.timer.frameLoop(1,this,this.tweenMove,[p$$])}},p$h.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&p$t.to(this,{alpha:0},500),this.event("end")},p$h.tweenMove=function(p$h){this._lastOffset*=this.rollRatio;var p$q=NaN;if(0<p$h&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,p$q=.5*-(this.min-p$h-this.value),this._lastOffset>p$q&&(this._lastOffset=p$q)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,p$q=.5*-(this.max+p$h-this.value),this._lastOffset<p$q&&(this._lastOffset=p$q))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(p$e.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?p$t.to(this,{value:this.min},this.elasticBackTime,p$B.sineOut,p$u.create(this,this.elasticOver)):this._value>this.max?p$t.to(this,{value:this.max},this.elasticBackTime,p$B.sineOut,p$u.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&p$t.to(this,{alpha:0},500)}},p$h.stopScroll=function(){this.onStageMouseUp2(null),p$e.timer.clear(this,this.tweenMove),p$t.clearTween(this)},p$$(0,p$h,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),p$$(0,p$h,"skin",function(){return this._skin},function(p$h){this._skin!=p$h&&(this._skin=p$h,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),p$$(0,p$h,"max",function(){return this.slider.max},function(p$h){this.slider.max=p$h}),p$$(0,p$h,"showButtons",function(){return this._showButtons},function(p$h){this._showButtons=p$h,this.callLater(this.changeScrollBar)}),p$$(0,p$h,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),p$$(0,p$h,"min",function(){return this.slider.min},function(p$h){this.slider.min=p$h}),p$$(0,p$h,"value",function(){return this._value},function(p$h){p$h!==this._value&&(this._value=p$h,this._isElastic||(this.slider._value!=p$h&&(this.slider._value=p$h,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),p$$(0,p$h,"isVertical",function(){return this.slider.isVertical},function(p$h){this.slider.isVertical=p$h}),p$$(0,p$h,"sizeGrid",function(){return this.slider.sizeGrid},function(p$h){this.slider.sizeGrid=p$h}),p$$(0,p$h,"scrollSize",function(){return this._scrollSize},function(p$h){this._scrollSize=p$h}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)||"string"==typeof p$h?this.value=Number(p$h):p$e.superSet(p$i,this,"dataSource",p$h)}),p$$(0,p$h,"thumbPercent",function(){return this._thumbPercent},function(p$h){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),p$h=1<=p$h?.99:p$h,this._thumbPercent=p$h,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*p$h,p$p.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*p$h,p$p.scrollBarMinNum))}),p$$(0,p$h,"target",function(){return this._target},function(p$h){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=p$h)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),p$$(0,p$h,"hide",function(){return this._hide},function(p$h){this._hide=p$h,this.visible=!p$h}),p$$(0,p$h,"touchScrollEnable",function(){return this._touchScrollEnable},function(p$h){this._touchScrollEnable=p$h,this.target=this._target}),p$$(0,p$h,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(p$h){this._mouseWheelEnable=p$h,this.target=this._target}),p$$(0,p$h,"tick",function(){return this.slider.tick},function(p$h){this.slider.tick=p$h}),p$f}(p$i),p$k=function(p$q){function p$f(p$h){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,p$f.__super.call(this),this.skin=p$h}p$P(p$f,"laya.ui.Slider",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._bg&&this._bg.destroy(p$h),this._bar&&this._bar.destroy(p$h),this._progress&&this._progress.destroy(p$h),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},p$h.createChildren=function(){this.addChild(this._bg=new p$H),this.addChild(this._bar=new p$M)},p$h.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},p$h.onBarMouseDown=function(p$h){this._globalSacle||(this._globalSacle=new p$L),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=p$e.stage.mouseX,this._ty=p$e.stage.mouseY,p$e.stage.on("mousemove",this,this.mouseMove),p$e.stage.once("mouseup",this,this.mouseUp),p$e.stage.once("mouseout",this,this.mouseUp),this.showValueText()},p$h.showValueText=function(){if(this.showLabel){var p$h=laya.ui.Slider.label;this.addChild(p$h),p$h.textField.changeText(this._value+""),this.isVertical?(p$h.x=this._bar.x+20,p$h.y=.5*(this._bar.height-p$h.height)+this._bar.y):(p$h.y=this._bar.y-20,p$h.x=.5*(this._bar.width-p$h.width)+this._bar.x)}},p$h.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},p$h.mouseUp=function(p$h){p$e.stage.off("mousemove",this,this.mouseMove),p$e.stage.off("mouseup",this,this.mouseUp),p$e.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},p$h.mouseMove=function(p$h){var p$q=this._value;this.isVertical?(this._bar.y+=(p$e.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(p$e.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=p$e.stage.mouseX,this._ty=p$e.stage.mouseY;var p$f=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*p$f)/p$f,this._value!=p$q&&this.sendChangeEvent(),this.showValueText()},p$h.sendChangeEvent=function(p$h){void 0===p$h&&(p$h="change"),this.event(p$h),this.changeHandler&&this.changeHandler.runWith(this._value)},p$h.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},p$h.changeSize=function(){p$q.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},p$h.setSlider=function(p$h,p$q,p$f){this._value=-1,this._min=p$h,this._max=p$h<p$q?p$q:p$h,this.value=p$f<p$h?p$h:p$q<p$f?p$q:p$f},p$h.changeValue=function(){var p$h=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*p$h)/p$h,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var p$q=this._max-this._min;0===p$q&&(p$q=1),this.isVertical?(this._bar.y=(this._value-this._min)/p$q*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/p$q*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},p$h.onBgMouseDown=function(p$h){var p$q=this._bg.getMousePoint();this.isVertical?this.value=p$q.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=p$q.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},p$$(0,p$h,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),p$$(0,p$h,"skin",function(){return this._skin},function(p$h){if(this._skin!=p$h){this._skin=p$h,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var p$q=this._skin.replace(".png","$progress.png");p$N.getRes(p$q)&&(this._progress||(this.addChild(this._progress=new p$H),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=p$q),this.setBarPoint(),this.callLater(this.changeValue)}}),p$$(0,p$h,"allowClickBack",function(){return this._allowClickBack},function(p$h){this._allowClickBack!=p$h&&((this._allowClickBack=p$h)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),p$$(0,p$h,"max",function(){return this._max},function(p$h){this._max!=p$h&&(this._max=p$h,this.callLater(this.changeValue))}),p$$(0,p$h,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),p$$(0,p$h,"tick",function(){return this._tick},function(p$h){this._tick!=p$h&&(this._tick=p$h,this.callLater(this.changeValue))}),p$$(0,p$h,"sizeGrid",function(){return this._bg.sizeGrid},function(p$h){this._bg.sizeGrid=p$h,this._bar.sizeGrid=p$h,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),p$$(0,p$h,"min",function(){return this._min},function(p$h){this._min!=p$h&&(this._min=p$h,this.callLater(this.changeValue))}),p$$(0,p$h,"value",function(){return this._value},function(p$h){if(this._value!=p$h){var p$q=this._value;this._value=p$h,this.changeValue(),this._value!=p$q&&this.sendChangeEvent()}}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)||"string"==typeof p$h?this.value=Number(p$h):p$e.superSet(p$i,this,"dataSource",p$h)}),p$$(0,p$h,"bar",function(){return this._bar}),p$g(p$f,["label",function(){return this.label=new p$D}]),p$f}(p$i),p$H=function(p$q){function p$f(p$h){this._bitmap=null,this._skin=null,this._group=null,p$f.__super.call(this),this.skin=p$h}p$P(p$f,"laya.ui.Image",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,p$N.clearCache(this,this._skin)},p$h.dispose=function(){this.destroy(!0),p$N.clearCache(this,this._skin)},p$h.createChildren=function(){this.graphics=this._bitmap=new p$b},p$h.setSource=function(p$h,p$q){p$h===this._skin&&p$q&&(this.source=p$q,this.onCompResize())},p$$(0,p$h,"source",function(){return this._bitmap.source},function(p$h){this._bitmap&&(this._bitmap.source=p$h,this.event("loaded"),this.repaint())}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"string"==typeof(this._dataSource=p$h)?this.skin=p$h:p$e.superSet(p$i,this,"dataSource",p$h)}),p$$(0,p$h,"measureHeight",function(){return this._bitmap.height}),p$$(0,p$h,"skin",function(){return this._skin},function(p$h){if(this._skin!=p$h)if(p$N.clearCache(this,this._skin),this._skin=p$h){p$N.keepCache(this,this._skin);var p$q=p$N.getRes(p$h);p$q?(this.source=p$q,this.onCompResize()):p$e.loader.load(this._skin,p$u.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),p$$(0,p$h,"group",function(){return this._group},function(p$h){p$h&&this._skin&&p$N.setGroup(this._skin,p$h),this._group=p$h}),p$$(0,p$h,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(p$h){this._bitmap.sizeGrid=p$A.fillArray(p$p.defaultSizeGrid,p$h,Number)}),p$$(0,p$h,"measureWidth",function(){return this._bitmap.width}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$i,this,"width",p$h),this._bitmap.width=0==p$h?1e-7:p$h}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$i,this,"height",p$h),this._bitmap.height=0==p$h?1e-7:p$h}),p$f}(p$i),p$D=function(p$q){function p$f(p$h){this._tf=null,p$f.__super.call(this),void 0===p$h&&(p$h=""),p$Y.defaultColor=p$p.labelColor,this.text=p$h}p$P(p$f,"laya.ui.Label",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._tf=null},p$h.createChildren=function(){this.addChild(this._tf=new p$E)},p$h.changeText=function(p$h){this._tf.changeText(p$h)},p$$(0,p$h,"padding",function(){return this._tf.padding.join(",")},function(p$h){this._tf.padding=p$A.fillArray(p$p.labelPadding,p$h,Number)}),p$$(0,p$h,"bold",function(){return this._tf.bold},function(p$h){this._tf.bold=p$h}),p$$(0,p$h,"align",function(){return this._tf.align},function(p$h){this._tf.align=p$h}),p$$(0,p$h,"text",function(){return this._tf.text},function(p$h){this._tf.text!=p$h&&(p$h&&(p$h=p$A.adptString(p$h+"")),this._tf.text=p$h,this.event("change"),this._width&&this._height||this.onCompResize())}),p$$(0,p$h,"italic",function(){return this._tf.italic},function(p$h){this._tf.italic=p$h}),p$$(0,p$h,"wordWrap",function(){return this._tf.wordWrap},function(p$h){this._tf.wordWrap=p$h}),p$$(0,p$h,"font",function(){return this._tf.font},function(p$h){this._tf.font=p$h}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)||"string"==typeof p$h?this.text=p$h+"":p$e.superSet(p$i,this,"dataSource",p$h)}),p$$(0,p$h,"color",function(){return this._tf.color},function(p$h){this._tf.color=p$h}),p$$(0,p$h,"valign",function(){return this._tf.valign},function(p$h){this._tf.valign=p$h}),p$$(0,p$h,"leading",function(){return this._tf.leading},function(p$h){this._tf.leading=p$h}),p$$(0,p$h,"fontSize",function(){return this._tf.fontSize},function(p$h){this._tf.fontSize=p$h}),p$$(0,p$h,"bgColor",function(){return this._tf.bgColor},function(p$h){this._tf.bgColor=p$h}),p$$(0,p$h,"borderColor",function(){return this._tf.borderColor},function(p$h){this._tf.borderColor=p$h}),p$$(0,p$h,"stroke",function(){return this._tf.stroke},function(p$h){this._tf.stroke=p$h}),p$$(0,p$h,"strokeColor",function(){return this._tf.strokeColor},function(p$h){this._tf.strokeColor=p$h}),p$$(0,p$h,"textField",function(){return this._tf}),p$$(0,p$h,"measureWidth",function(){return this._tf.width}),p$$(0,p$h,"measureHeight",function(){return this._tf.height}),p$$(0,p$h,"width",function(){return this._width||this._tf.text?p$e.superGet(p$i,this,"width"):0},function(p$h){p$e.superSet(p$i,this,"width",p$h),this._tf.width=p$h}),p$$(0,p$h,"height",function(){return this._height||this._tf.text?p$e.superGet(p$i,this,"height"):0},function(p$h){p$e.superSet(p$i,this,"height",p$h),this._tf.height=p$h}),p$$(0,p$h,"overflow",function(){return this._tf.overflow},function(p$h){this._tf.overflow=p$h}),p$$(0,p$h,"underline",function(){return this._tf.underline},function(p$h){this._tf.underline=p$h}),p$$(0,p$h,"underlineColor",function(){return this._tf.underlineColor},function(p$h){this._tf.underlineColor=p$h}),p$f}(p$i),p$s=function(p$q){function p$f(p$h){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,p$f.__super.call(this),this.skin=p$h}p$P(p$f,"laya.ui.ProgressBar",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._bg&&this._bg.destroy(p$h),this._bar&&this._bar.destroy(p$h),this._bg=this._bar=null,this.changeHandler=null},p$h.createChildren=function(){this.addChild(this._bg=new p$H),this.addChild(this._bar=new p$H)},p$h.changeValue=function(){if(this.sizeGrid){var p$h=this.sizeGrid.split(","),p$q=Number(p$h[3]),p$f=Number(p$h[1]),p$g=(this.width-p$q-p$f)*this._value;this._bar.width=p$q+p$f+p$g,this._bar.visible=this._bar.width>p$q+p$f}else this._bar.width=this.width*this._value},p$$(0,p$h,"measureHeight",function(){return this._bg.height}),p$$(0,p$h,"skin",function(){return this._skin},function(p$h){this._skin!=p$h&&(this._skin=p$h,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),p$$(0,p$h,"measureWidth",function(){return this._bg.width}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$i,this,"height",p$h),this._bg.height=this._height,this._bar.height=this._height}),p$$(0,p$h,"bar",function(){return this._bar}),p$$(0,p$h,"value",function(){return this._value},function(p$h){this._value!=p$h&&(p$h=1<p$h?1:p$h<0?0:p$h,this._value=p$h,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(p$h))}),p$$(0,p$h,"bg",function(){return this._bg}),p$$(0,p$h,"sizeGrid",function(){return this._bg.sizeGrid},function(p$h){this._bg.sizeGrid=this._bar.sizeGrid=p$h}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$i,this,"width",p$h),this._bg.width=this._width,this.callLater(this.changeValue)}),p$$(0,p$h,"dataSource",p$q.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)||"string"==typeof p$h?this.value=Number(p$h):p$e.superSet(p$i,this,"dataSource",p$h)}),p$f}(p$i),p$V=(function(p$h){function p$f(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,p$f.__super.call(this),this._tipBox=new p$i,this._tipBox.addChild(this._tipText=new p$E),this._tipText.x=this._tipText.y=5,this._tipText.color=p$f.tipTextColor,this._defaultTipHandler=this._showDefaultTip,p$e.stage.on("showtip",this,this._onStageShowTip),p$e.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}p$P(p$f,"laya.ui.TipManager",p$i);var p$q=p$f.prototype;p$q._onStageHideTip=function(p$h){p$e.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},p$q._onStageShowTip=function(p$h){p$e.timer.once(p$f.tipDelay,this,this._showTip,[p$h],!0)},p$q._showTip=function(p$h){if("string"==typeof p$h){var p$q=String(p$h);Boolean(p$q)&&this._defaultTipHandler(p$q)}else p$h instanceof laya.utils.Handler?p$h.run():"function"==typeof p$h&&p$h.apply();p$e.stage.on("mousemove",this,this._onStageMouseMove),p$e.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},p$q._onStageMouseDown=function(p$h){this.closeAll()},p$q._onStageMouseMove=function(p$h){this._showToStage(this,p$f.offsetX,p$f.offsetY)},p$q._showToStage=function(p$h,p$q,p$f){void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0);var p$g=p$h.getBounds();p$h.x=p$e.stage.mouseX+p$q,p$h.y=p$e.stage.mouseY+p$f,p$h.x+p$g.width>p$e.stage.width&&(p$h.x-=p$g.width+p$q),p$h.y+p$g.height>p$e.stage.height&&(p$h.y-=p$g.height+p$f)},p$q.closeAll=function(){p$e.timer.clear(this,this._showTip),p$e.stage.off("mousemove",this,this._onStageMouseMove),p$e.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},p$q.showDislayTip=function(p$h){this.addChild(p$h),this._showToStage(this),p$e._currentStage.addChild(this)},p$q._showDefaultTip=function(p$h){this._tipText.text=p$h;var p$q=this._tipBox.graphics;p$q.clear(),p$q.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,p$f.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),p$e._currentStage.addChild(this)},p$$(0,p$q,"defaultTipHandler",function(){return this._defaultTipHandler},function(p$h){this._defaultTipHandler=p$h}),p$f.offsetX=10,p$f.offsetY=15,p$f.tipTextColor="#ffffff",p$f.tipBackColor="#111111",p$f.tipDelay=200}(),function(p$h){var p$v;function p$L(){this._idMap=null,this._aniList=null,this._watchMap={},p$L.__super.call(this)}p$P(p$L,"laya.ui.View",p$c);var p$q=p$L.prototype;return p$q.createView=function(p$h){if(p$h.animations&&!this._idMap&&(this._idMap={}),p$L.createComp(p$h,this,this),p$h.animations){var p$q,p$f,p$g=[],p$$=p$h.animations,p$P=0,p$S=p$$.length;for(p$P=0;p$P<p$S;p$P++){switch(p$q=new p$C,p$f=p$$[p$P],p$q._setUp(this._idMap,p$f),(this[p$f.name]=p$q)._setControlNode(this),p$f.action){case 1:p$q.play(0,!1);break;case 2:p$q.play(0,!0)}p$g.push(p$q)}this._aniList=p$g}0<this._width&&null==p$h.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},p$q.onEvent=function(p$h,p$q){},p$q.loadUI=function(p$h){var p$q=p$L.uiMap[p$h];p$q&&this.createView(p$q)},p$q.destroy=function(p$h){void 0===p$h&&(p$h=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,p$h)},p$q.changeData=function(p$h){var p$q=this._watchMap[p$h];if(p$q){console.log("change",p$h);for(var p$f=0,p$g=p$q.length;p$f<p$g;p$f++){p$q[p$f].exe(this)}}},p$L._regs=function(){for(var p$h in p$L.uiClassMap)p$l.regClass(p$h,p$L.uiClassMap[p$h])},p$L.createComp=function(p$h,p$q,p$f,p$g){if(!(p$q=p$q||p$L.getCompInstance(p$h)))return console.warn("can not create:"+p$h.type),null;var p$$=p$h.child;if(p$$)for(var p$P=p$q instanceof laya.ui.List,p$S=0,p$B=p$$.length;p$S<p$B;p$S++){var p$r=p$$[p$S];if(!p$q.hasOwnProperty("itemRender")||"render"!=p$r.props.name&&"render"!==p$r.props.renderType)if("Graphic"==p$r.type)p$l.addGraphicsToSprite(p$r,p$q);else if(p$l.isDrawType(p$r.type))p$l.addGraphicToSprite(p$r,p$q,!0);else{if(p$P){var p$Y=[],p$C=p$L.createComp(p$r,null,p$f,p$Y);p$Y.length&&(p$C._$bindData=p$Y)}else p$C=p$L.createComp(p$r,null,p$f,p$g);"Script"==p$r.type?"owner"in p$C?p$C.owner=p$q:"target"in p$C&&(p$C.target=p$q):"mask"==p$r.props.renderType||"mask"==p$r.props.name?p$q.mask=p$C:p$C instanceof laya.display.Sprite&&p$q.addChild(p$C)}else p$q.itemRender=p$r}var p$U=p$h.props;for(var p$u in p$U){var p$v=p$U[p$u];p$L.eventDic[p$u]?p$v&&p$f&&p$q.on(p$u,p$f,p$f.onEvent,[p$v]):p$L.setCompValue(p$q,p$u,p$v,p$f,p$g)}return p$e.__typeof(p$q,"laya.ui.IItem")&&p$q.initItems(),p$h.compId&&p$f&&p$f._idMap&&(p$f._idMap[p$h.compId]=p$q),p$q},p$L.setCompValue=function(p$h,p$q,p$f,p$g,p$$){if("string"==typeof p$f&&-1<p$f.indexOf("${")){if(p$L._sheet||(p$L._sheet=p$l.getClass("laya.data.Table")),!p$L._sheet)return void console.warn("Can not find class Sheet");if(p$$)p$$.push(p$h,p$q,p$f);else if(p$g){-1==p$f.indexOf("].")&&(p$f=p$f.replace(".","[0]."));var p$P,p$S,p$B=new p$v(p$h,p$q,p$f);p$B.exe(p$g);for(var p$r=p$f.replace(/\[.*?\]\./g,".");null!=(p$P=p$L._parseWatchData.exec(p$r));){for(var p$Y=p$P[1];null!=(p$S=p$L._parseKeyWord.exec(p$Y));){var p$C=p$S[0],p$U=p$g._watchMap[p$C]||(p$g._watchMap[p$C]=[]);p$U.push(p$B),p$L._sheet.I.notifer.on(p$C,p$g,p$g.changeData,[p$C])}(p$U=p$g._watchMap[p$Y]||(p$g._watchMap[p$Y]=[])).push(p$B),p$L._sheet.I.notifer.on(p$Y,p$g,p$g.changeData,[p$Y])}}}else if("var"===p$q&&p$g)p$g[p$f]=p$h;else if("onClick"==p$q){var p$u=p$e._runScript("(function(){"+p$f+"})");p$h.on("click",p$g,p$u)}else p$h[p$q]="true"===p$f||"false"!==p$f&&p$f},p$L.getCompInstance=function(p$h){var p$q,p$f=p$h.props?p$h.props.runtime:null;return p$q=p$f?p$L.viewClassMap[p$f]||p$L.uiClassMap[p$f]||p$e.__classmap[p$f]:p$L.uiClassMap[p$h.type],p$h.props&&p$h.props.hasOwnProperty("renderType")&&"instance"==p$h.props.renderType?p$q.instance:p$q?new p$q:null},p$L.regComponent=function(p$h,p$q){p$L.uiClassMap[p$h]=p$q,p$l.regClass(p$h,p$q)},p$L.regViewRuntime=function(p$h,p$q){p$L.viewClassMap[p$h]=p$q},p$L.uiMap={},p$L.viewClassMap={},p$L._sheet=null,p$g(p$L,["uiClassMap",function(){return this.uiClassMap={ViewStack:p$hh,LinkButton:p$M,TextArea:p$Yh,ColorPicker:p$T,Box:p$c,Button:p$M,CheckBox:p$K,Clip:p$W,ComboBox:p$I,Component:p$i,HScrollBar:p$Q,HSlider:p$O,Image:p$H,Label:p$D,List:p$Z,Panel:p$o,ProgressBar:p$s,Radio:p$x,RadioGroup:p$Bh,ScrollBar:p$w,Slider:p$k,Tab:p$rh,TextInput:p$fh,View:p$L,VScrollBar:p$qh,VSlider:p$gh,Tree:p$a,HBox:p$Ph,VBox:p$Sh,Sprite:p$m,Animation:p$f,Text:p$E,FontClip:p$F}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),p$L.__init$=function(){p$L._regs(),p$v=function(){function p$h(p$h,p$q,p$f){this.comp=null,this.prop=null,this.value=null,this.comp=p$h,this.prop=p$q,this.value=p$f}return p$P(p$h,""),p$h.prototype.exe=function(p$h){var p$q=p$A.getBindFun(this.value);this.comp[this.prop]=p$q.call(this,p$h)},p$h}()},p$L}()),p$K=function(p$h){function p$f(p$h,p$q){void 0===p$q&&(p$q=""),p$f.__super.call(this,p$h,p$q)}p$P(p$f,"laya.ui.CheckBox",p$h);var p$q=p$f.prototype;return p$q.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},p$q.initialize=function(){p$h.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},p$$(0,p$q,"dataSource",p$h.prototype._$get_dataSource,function(p$h){"boolean"==typeof(this._dataSource=p$h)?this.selected=p$h:"string"==typeof p$h?this.selected="true"===p$h:p$e.superSet(p$M,this,"dataSource",p$h)}),p$f}(p$M),p$y=function(p$h){function p$q(){this._space=0,this._align="none",this._itemChanged=!1,p$q.__super.call(this)}p$P(p$q,"laya.ui.LayoutBox",p$c);var p$f=p$q.prototype;return p$f.addChild=function(p$h){return p$h.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,p$h)},p$f.onResize=function(p$h){this._setItemChanged()},p$f.addChildAt=function(p$h,p$q){return p$h.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,p$h,p$q)},p$f.removeChild=function(p$h){return p$h.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,p$h)},p$f.removeChildAt=function(p$h){return this.getChildAt(p$h).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,p$h)},p$f.refresh=function(){this._setItemChanged()},p$f.changeItems=function(){this._itemChanged=!1},p$f.sortItem=function(p$h){p$h&&p$h.sort(function(p$h,p$q){return p$h.y-p$q.y})},p$f._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},p$$(0,p$f,"space",function(){return this._space},function(p$h){this._space=p$h,this._setItemChanged()}),p$$(0,p$f,"align",function(){return this._align},function(p$h){this._align=p$h,this._setItemChanged()}),p$q}(),p$F=function(p$q){function p$f(p$h,p$q){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,p$f.__super.call(this),p$h&&(this.skin=p$h),p$q&&(this.sheet=p$q)}p$P(p$f,"laya.ui.FontClip",p$q);var p$h=p$f.prototype;return p$h.createChildren=function(){this._bitmap=new p$b,this.on("loaded",this,this._onClipLoaded)},p$h._onClipLoaded=function(){this.callLater(this.changeValue)},p$h.changeValue=function(){var p$h;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),p$h=this._sources[0]))){var p$q="horizontal"===this._direction;p$q?(this._wordsW=this._valueArr.length*(p$h.sourceWidth+this.spaceX),this._wordsH=p$h.sourceHeight):(this._wordsW=p$h.sourceWidth,this._wordsH=(p$h.sourceHeight+this.spaceY)*this._valueArr.length);var p$f=0;if(this._width)switch(this._align){case"center":p$f=.5*(this._width-this._wordsW);break;case"right":p$f=this._width-this._wordsW;break;default:p$f=0}for(var p$g=0,p$$=this._valueArr.length;p$g<p$$;p$g++){var p$P=this._indexMap[this._valueArr.charAt(p$g)];this.sources[p$P]&&(p$h=this.sources[p$P],p$q?this.graphics.drawTexture(p$h,p$f+p$g*(p$h.sourceWidth+this.spaceX),0,p$h.sourceWidth,p$h.sourceHeight):this.graphics.drawTexture(p$h,0+p$f,p$g*(p$h.sourceHeight+this.spaceY),p$h.sourceWidth,p$h.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),p$q.prototype.destroy.call(this,p$h)},p$$(0,p$h,"sheet",function(){return this._sheet},function(p$h){p$h+="";var p$q=(this._sheet=p$h).split(" ");this._clipX=String(p$q[0]).length,this.clipY=p$q.length,this._indexMap={};for(var p$f=0;p$f<this._clipY;p$f++)for(var p$g=p$q[p$f].split(""),p$$=0,p$P=p$g.length;p$$<p$P;p$$++)this._indexMap[p$g[p$$]]=p$f*this._clipX+p$$}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$W,this,"height",p$h),this.callLater(this.changeValue)}),p$$(0,p$h,"direction",function(){return this._direction},function(p$h){this._direction=p$h,this.callLater(this.changeValue)}),p$$(0,p$h,"value",function(){return this._valueArr?this._valueArr:""},function(p$h){p$h+="",this._valueArr=p$h,this.callLater(this.changeValue)}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$W,this,"width",p$h),this.callLater(this.changeValue)}),p$$(0,p$h,"spaceX",function(){return this._spaceX},function(p$h){this._spaceX=p$h,"horizontal"===this._direction&&this.callLater(this.changeValue)}),p$$(0,p$h,"spaceY",function(){return this._spaceY},function(p$h){this._spaceY=p$h,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),p$$(0,p$h,"align",function(){return this._align},function(p$h){this._align=p$h,this.callLater(this.changeValue)}),p$$(0,p$h,"measureWidth",function(){return this._wordsW}),p$$(0,p$h,"measureHeight",function(){return this._wordsH}),p$f}(p$W),p$Z=function(p$h){function p$q(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new p$L,p$q.__super.call(this)}p$P(p$q,"laya.ui.List",p$h);var p$f=p$q.prototype;return p$e.imps(p$f,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),p$f.destroy=function(p$h){void 0===p$h&&(p$h=!0),this._content&&this._content.destroy(p$h),this._scrollBar&&this._scrollBar.destroy(p$h),laya.ui.Component.prototype.destroy.call(this,p$h),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},p$f.createChildren=function(){this.addChild(this._content=new p$c)},p$f.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=p$e.superGet(p$c,this,"cacheAs")),p$e.superSet(p$c,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},p$f.onScrollEnd=function(){p$e.superSet(p$c,this,"cacheAs",this._$P.cacheAs)},p$f._removePreScrollBar=function(){var p$h=this.removeChildByName("scrollBar");p$h&&p$h.destroy(!0)},p$f.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var p$h=this._getOneCell(),p$q=p$h.width+this._spaceX||1,p$f=p$h.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/p$q):Math.ceil(this._width/p$q)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/p$f):Math.round(this._height/p$f));var p$g=this._width?this._width:p$q*this.repeatX-this._spaceX,p$$=this._height?this._height:p$f*this.repeatY-this._spaceY;this._cellSize=this._isVertical?p$f:p$q,this._cellOffset=this._isVertical?p$f*Math.max(this._repeatY2,this._repeatY)-p$$-this._spaceY:p$q*Math.max(this._repeatX2,this._repeatX)-p$g-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=p$$:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=p$g),this.setContentSize(p$g,p$$);var p$P=this._isVertical?this.repeatX:this.repeatY,p$S=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,p$P,p$S),this._createdLine=p$S,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},p$f._getOneCell=function(){if(0===this._cells.length){var p$h=this.createItem();if(this._offset.setTo(p$h.x,p$h.y),this.cacheContent)return p$h;this._cells.push(p$h)}return this._cells[0]},p$f._createItems=function(p$h,p$q,p$f){var p$g=this._content,p$$=this._getOneCell(),p$P=p$$.width+this._spaceX,p$S=p$$.height+this._spaceY;if(this.cacheContent){var p$B=new p$c;p$B.cacheAsBitmap=!0,p$B.pos((this._isVertical?0:p$h)*p$P,(this._isVertical?p$h:0)*p$S),this._content.addChild(p$B),this._content.optimizeScrollRect=!0,p$g=p$B}else{for(var p$r=[],p$Y=this._cells.length-1;-1<p$Y;p$Y--){var p$C=this._cells[p$Y];p$C.removeSelf(),p$r.push(p$C)}this._cells.length=0}for(var p$U=p$h;p$U<p$f;p$U++)for(var p$u=0;p$u<p$q;p$u++)(p$$=p$r&&p$r.length?p$r.pop():this.createItem()).x=(this._isVertical?p$u:p$U)*p$P-p$g.x,p$$.y=(this._isVertical?p$U:p$u)*p$S-p$g.y,p$$.name="item"+(p$U*p$q+p$u),p$g.addChild(p$$),this.addCell(p$$)},p$f.createItem=function(){var p$h=[];if("function"==typeof this._itemRender)var p$q=new this._itemRender;else p$q=p$V.createComp(this._itemRender,null,null,p$h);if(0==p$h.length&&p$q._watchMap){var p$f=p$q._watchMap;for(var p$g in p$f)for(var p$$=p$f[p$g],p$P=0;p$P<p$$.length;p$P++){var p$S=p$$[p$P];p$h.push(p$S.comp,p$S.prop,p$S.value)}}return p$h.length&&(p$q._$bindData=p$h),p$q},p$f.addCell=function(p$h){p$h.on("click",this,this.onCellMouse),p$h.on("rightclick",this,this.onCellMouse),p$h.on("mouseover",this,this.onCellMouse),p$h.on("mouseout",this,this.onCellMouse),p$h.on("mousedown",this,this.onCellMouse),p$h.on("mouseup",this,this.onCellMouse),this._cells.push(p$h)},p$f.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var p$h=0,p$q=p$h=0;p$q<1e4;p$q++){var p$f=this.getChildByName("item"+p$q);if(!p$f)break;this.addCell(p$f),p$h++}this.repeatY=p$h}},p$f.setContentSize=function(p$h,p$q){this._content.width=p$h,this._content.height=p$q,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new p$_),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,p$h,p$q),this._content.scrollRect=this._content.scrollRect),this.event("resize")},p$f.onCellMouse=function(p$h){"mousedown"===p$h.type&&(this._isMoved=!1);var p$q=p$h.currentTarget,p$f=this._startIndex+this._cells.indexOf(p$q);p$f<0||("click"===p$h.type||"rightclick"===p$h.type?this.selectEnable&&!this._isMoved?this.selectedIndex=p$f:this.changeCellState(p$q,!0,0):"mouseover"!==p$h.type&&"mouseout"!==p$h.type||this._selectedIndex===p$f||this.changeCellState(p$q,"mouseover"===p$h.type,0),this.mouseHandler&&this.mouseHandler.runWith([p$h,p$f]))},p$f.changeCellState=function(p$h,p$q,p$f){var p$g=p$h.getChildByName("selectBox");p$g&&(this.selectEnable=!0,p$g.visible=p$q,p$g.index=p$f)},p$f.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},p$f.onScrollBarChange=function(p$h){this.runCallLater(this.changeCells);var p$q=this._scrollBar.value,p$f=this._isVertical?this.repeatX:this.repeatY,p$g=this._isVertical?this.repeatY:this.repeatX,p$$=Math.floor(p$q/this._cellSize);if(this.cacheContent)p$S=p$g+1,this._createdLine-p$$<p$S&&(this._createItems(this._createdLine,p$f,this._createdLine+p$S),this.renderItems(this._createdLine*p$f,0),this._createdLine+=p$S);else{var p$P=p$$*p$f,p$S=0;if(p$P>this._startIndex){p$S=p$P-this._startIndex;var p$B=!0,p$r=this._startIndex+p$f*(p$g+1);this._isMoved=!0}else p$P<this._startIndex&&(p$S=this._startIndex-p$P,p$B=!1,p$r=this._startIndex-1,this._isMoved=!0);for(var p$Y=0;p$Y<p$S;p$Y++){if(p$B){var p$C=this._cells.shift();this._cells[this._cells.length]=p$C;var p$U=p$r+p$Y}else p$C=this._cells.pop(),this._cells.unshift(p$C),p$U=p$r-p$Y;var p$u=Math.floor(p$U/p$f)*this._cellSize;this._isVertical?p$C.y=p$u:p$C.x=p$u,this.renderItem(p$C,p$U)}this._startIndex=p$P,this.changeSelectStatus()}var p$v=this._content.scrollRect;this._isVertical?(p$v.y=p$q-this._offset.y,p$v.x=-this._offset.x):(p$v.y=-this._offset.y,p$v.x=p$q-this._offset.x),this._content.scrollRect=p$v},p$f.posCell=function(p$h,p$q){if(this._scrollBar){var p$f=this._isVertical?this.repeatX:this.repeatY,p$g=(this._isVertical?this.repeatY:this.repeatX,Math.floor(p$q/p$f)*this._cellSize);this._isVertical?p$h.y=p$g:p$h.x=p$g}},p$f.changeSelectStatus=function(){for(var p$h=0,p$q=this._cells.length;p$h<p$q;p$h++)this.changeCellState(this._cells[p$h],this._selectedIndex===this._startIndex+p$h,1)},p$f.renderItems=function(p$h,p$q){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0);for(var p$f=p$h,p$g=p$q||this._cells.length;p$f<p$g;p$f++)this.renderItem(this._cells[p$f],this._startIndex+p$f);this.changeSelectStatus()},p$f.renderItem=function(p$h,p$q){this._array&&0<=p$q&&p$q<this._array.length?(p$h.visible=!0,p$h._$bindData?(p$h._dataSource=this._array[p$q],this._bindData(p$h,this._array[p$q])):p$h.dataSource=this._array[p$q],this.cacheContent||this.posCell(p$h,p$q),this.hasListener("render")&&this.event("render",[p$h,p$q]),this.renderHandler&&this.renderHandler.runWith([p$h,p$q])):(p$h.visible=!1,p$h.dataSource=null)},p$f._bindData=function(p$h,p$q){for(var p$f=p$h._$bindData,p$g=0,p$$=p$f.length;p$g<p$$;p$g++){var p$P=p$f[p$g++],p$S=p$f[p$g++],p$B=p$f[p$g],p$r=p$A.getBindFun(p$B);p$P[p$S]=p$r.call(this,p$q)}},p$f.refresh=function(){this.array=this._array},p$f.getItem=function(p$h){return-1<p$h&&p$h<this._array.length?this._array[p$h]:null},p$f.changeItem=function(p$h,p$q){-1<p$h&&p$h<this._array.length&&(this._array[p$h]=p$q,p$h>=this._startIndex&&p$h<this._startIndex+this._cells.length&&this.renderItem(this.getCell(p$h),p$h))},p$f.setItem=function(p$h,p$q){this.changeItem(p$h,p$q)},p$f.addItem=function(p$h){this._array.push(p$h),this.array=this._array},p$f.addItemAt=function(p$h,p$q){this._array.splice(p$q,0,p$h),this.array=this._array},p$f.deleteItem=function(p$h){this._array.splice(p$h,1),this.array=this._array},p$f.getCell=function(p$h){return this.runCallLater(this.changeCells),-1<p$h&&this._cells?this._cells[(p$h-this._startIndex)%this._cells.length]:null},p$f.scrollTo=function(p$h){if(this._scrollBar){var p$q=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(p$h/p$q)*this._cellSize}else this.startIndex=p$h},p$f.tweenTo=function(p$h,p$q,p$f){if(void 0===p$q&&(p$q=200),this._scrollBar){var p$g=this._isVertical?this.repeatX:this.repeatY;p$t.to(this._scrollBar,{value:Math.floor(p$h/p$g)*this._cellSize},p$q,null,p$f,0,!0)}else this.startIndex=p$h,p$f&&p$f.run()},p$f._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},p$f.commitMeasure=function(){this.runCallLater(this.changeCells)},p$$(0,p$f,"cacheAs",p$h.prototype._$get_cacheAs,function(p$h){p$e.superSet(p$c,this,"cacheAs",p$h),this._scrollBar&&(this._$P.cacheAs=null,"none"!==p$h?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),p$$(0,p$f,"content",function(){return this._content}),p$$(0,p$f,"height",p$h.prototype._$get_height,function(p$h){p$h!=this._height&&(p$e.superSet(p$c,this,"height",p$h),this._setCellChanged())}),p$$(0,p$f,"itemRender",function(){return this._itemRender},function(p$h){if(this._itemRender!=p$h){this._itemRender=p$h;for(var p$q=this._cells.length-1;-1<p$q;p$q--)this._cells[p$q].destroy();this._cells.length=0,this._setCellChanged()}}),p$$(0,p$f,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(p$h){this._removePreScrollBar();var p$q=new p$qh;p$q.name="scrollBar",p$q.right=0,p$h&&" "!=p$h&&(p$q.skin=p$h),this.scrollBar=p$q,this.addChild(p$q),this._setCellChanged()}),p$$(0,p$f,"page",function(){return this._page},function(p$h){this._page=p$h,this._array&&(this._page=0<p$h?p$h:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),p$$(0,p$f,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(p$h){this._removePreScrollBar();var p$q=new p$Q;p$q.name="scrollBar",p$q.bottom=0,p$h&&" "!=p$h&&(p$q.skin=p$h),this.scrollBar=p$q,this.addChild(p$q),this._setCellChanged()}),p$$(0,p$f,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(p$h){this._repeatX=p$h,this._setCellChanged()}),p$$(0,p$f,"scrollBar",function(){return this._scrollBar},function(p$h){this._scrollBar!=p$h&&(this._scrollBar=p$h)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),p$$(0,p$f,"width",p$h.prototype._$get_width,function(p$h){p$h!=this._width&&(p$e.superSet(p$c,this,"width",p$h),this._setCellChanged())}),p$$(0,p$f,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(p$h){this._repeatY=p$h,this._setCellChanged()}),p$$(0,p$f,"spaceX",function(){return this._spaceX},function(p$h){this._spaceX=p$h,this._setCellChanged()}),p$$(0,p$f,"spaceY",function(){return this._spaceY},function(p$h){this._spaceY=p$h,this._setCellChanged()}),p$$(0,p$f,"selectedIndex",function(){return this._selectedIndex},function(p$h){this._selectedIndex!=p$h&&(this._selectedIndex=p$h,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(p$h),this.startIndex=this._startIndex)}),p$$(0,p$f,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(p$h){this.selectedIndex=this._array.indexOf(p$h)}),p$$(0,p$f,"length",function(){return this._array?this._array.length:0}),p$$(0,p$f,"selection",function(){return this.getCell(this._selectedIndex)},function(p$h){this.selectedIndex=this._startIndex+this._cells.indexOf(p$h)}),p$$(0,p$f,"startIndex",function(){return this._startIndex},function(p$h){this._startIndex=0<p$h?p$h:0,this.callLater(this.renderItems)}),p$$(0,p$f,"array",function(){return this._array},function(p$h){this.runCallLater(this.changeCells),this._array=p$h||[];var p$q=this._array.length;if(this.totalPage=Math.ceil(p$q/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<p$q?this._selectedIndex:p$q-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var p$f=this._isVertical?this.repeatX:this.repeatY,p$g=this._isVertical?this.repeatY:this.repeatX,p$$=Math.ceil(p$q/p$f);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=p$g/p$$,this._scrollBar.setScroll(0,(p$$-p$g)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),p$$(0,p$f,"dataSource",p$h.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)&&Math.floor(p$h)==p$h||"string"==typeof p$h?this.selectedIndex=parseInt(p$h):p$h instanceof Array?this.array=p$h:p$e.superSet(p$c,this,"dataSource",p$h)}),p$$(0,p$f,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),p$q}(p$c),p$Q=function(p$h){function p$q(){p$q.__super.call(this)}return p$P(p$q,"laya.ui.HScrollBar",p$h),p$q.prototype.initialize=function(){p$h.prototype.initialize.call(this),this.slider.isVertical=!1},p$q}(p$w),p$o=function(p$h){function p$q(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,p$q.__super.call(this),this.width=this.height=100}p$P(p$q,"laya.ui.Panel",p$h);var p$f=p$q.prototype;return p$f.destroy=function(p$h){void 0===p$h&&(p$h=!0),laya.ui.Component.prototype.destroy.call(this,p$h),this._content&&this._content.destroy(p$h),this._vScrollBar&&this._vScrollBar.destroy(p$h),this._hScrollBar&&this._hScrollBar.destroy(p$h),this._vScrollBar=null,this._hScrollBar=null,this._content=null},p$f.destroyChildren=function(){this._content.destroyChildren()},p$f.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new p$c)},p$f.addChild=function(p$h){return p$h.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(p$h)},p$f.onResize=function(){this._setScrollChanged()},p$f.addChildAt=function(p$h,p$q){return p$h.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(p$h,p$q)},p$f.removeChild=function(p$h){return p$h.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(p$h)},p$f.removeChildAt=function(p$h){return this.getChildAt(p$h).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(p$h)},p$f.removeChildren=function(p$h,p$q){return void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=2147483647),this._content.removeChildren(p$h,p$q),this._setScrollChanged(),this},p$f.getChildAt=function(p$h){return this._content.getChildAt(p$h)},p$f.getChildByName=function(p$h){return this._content.getChildByName(p$h)},p$f.getChildIndex=function(p$h){return this._content.getChildIndex(p$h)},p$f.changeScroll=function(){this._scrollChanged=!1;var p$h=this.contentWidth||1,p$q=this.contentHeight||1,p$f=this._vScrollBar,p$g=this._hScrollBar,p$$=p$f&&p$q>this._height,p$P=p$g&&p$h>this._width,p$S=p$$?this._width-p$f.width:this._width,p$B=p$P?this._height-p$g.height:this._height;p$f&&(p$f.x=this._width-p$f.width,p$f.y=0,p$f.height=this._height-(p$P?p$g.height:0),p$f.scrollSize=Math.max(.033*this._height,1),p$f.thumbPercent=p$B/p$q,p$f.setScroll(0,p$q-p$B,p$f.value)),p$g&&(p$g.x=0,p$g.y=this._height-p$g.height,p$g.width=this._width-(p$$?p$f.width:0),p$g.scrollSize=Math.max(.033*this._width,1),p$g.thumbPercent=p$S/p$h,p$g.setScroll(0,p$h-p$S,p$g.value))},p$f.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},p$f.setContentSize=function(p$h,p$q){var p$f=this._content;p$f.width=p$h,p$f.height=p$q,p$f.scrollRect||(p$f.scrollRect=new p$_),p$f.scrollRect.setTo(0,0,p$h,p$q),p$f.scrollRect=p$f.scrollRect},p$f.onScrollBarChange=function(p$h){var p$q=this._content.scrollRect;if(p$q){var p$f=Math.round(p$h.value);p$h.isVertical?p$q.y=p$f:p$q.x=p$f,this._content.scrollRect=p$q}},p$f.scrollTo=function(p$h,p$q){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),this.vScrollBar&&(this.vScrollBar.value=p$q),this.hScrollBar&&(this.hScrollBar.value=p$h)},p$f.refresh=function(){this.changeScroll()},p$f.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=p$e.superGet(p$c,this,"cacheAs")),p$e.superSet(p$c,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},p$f.onScrollEnd=function(){p$e.superSet(p$c,this,"cacheAs",this._$P.cacheAs)},p$f._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},p$$(0,p$f,"numChildren",function(){return this._content.numChildren}),p$$(0,p$f,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(p$h){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new p$Q),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=p$h}),p$$(0,p$f,"contentWidth",function(){for(var p$h=0,p$q=this._content.numChildren-1;-1<p$q;p$q--){var p$f=this._content.getChildAt(p$q);p$h=Math.max(p$f.x+p$f.width*p$f.scaleX,p$h)}return p$h}),p$$(0,p$f,"contentHeight",function(){for(var p$h=0,p$q=this._content.numChildren-1;-1<p$q;p$q--){var p$f=this._content.getChildAt(p$q);p$h=Math.max(p$f.y+p$f.height*p$f.scaleY,p$h)}return p$h}),p$$(0,p$f,"width",p$h.prototype._$get_width,function(p$h){p$e.superSet(p$c,this,"width",p$h),this._setScrollChanged()}),p$$(0,p$f,"hScrollBar",function(){return this._hScrollBar}),p$$(0,p$f,"content",function(){return this._content}),p$$(0,p$f,"height",p$h.prototype._$get_height,function(p$h){p$e.superSet(p$c,this,"height",p$h),this._setScrollChanged()}),p$$(0,p$f,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(p$h){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new p$qh),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=p$h}),p$$(0,p$f,"vScrollBar",function(){return this._vScrollBar}),p$$(0,p$f,"cacheAs",p$h.prototype._$get_cacheAs,function(p$h){p$e.superSet(p$c,this,"cacheAs",p$h),this._$P.cacheAs=null,"none"!==p$h?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),p$q}(p$c),p$O=function(p$h){function p$q(p$h){p$q.__super.call(this,p$h),this.isVertical=!1}return p$P(p$q,"laya.ui.HSlider",p$k),p$q}(),p$j=function(p$h){function p$f(p$h,p$q){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,p$f.__super.call(this),this.skin=p$q,this.labels=p$h}p$P(p$f,"laya.ui.UIGroup",p$h);var p$q=p$f.prototype;return p$e.imps(p$q,{"laya.ui.IItem":!0}),p$q.preinitialize=function(){this.mouseEnabled=!0},p$q.destroy=function(p$h){void 0===p$h&&(p$h=!0),laya.ui.Component.prototype.destroy.call(this,p$h),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},p$q.addItem=function(p$h,p$q){void 0===p$q&&(p$q=!0);var p$f=p$h,p$g=this._items.length;if(p$f.name="item"+p$g,this.addChild(p$f),this.initItems(),p$q&&0<p$g){var p$$=this._items[p$g-1];"horizontal"==this._direction?p$f.x=p$$.x+p$$.width+this._space:p$f.y=p$$.y+p$$.height+this._space}else p$q&&(p$f.x=0,p$f.y=0);return p$g},p$q.delItem=function(p$h,p$q){void 0===p$q&&(p$q=!0);var p$f=this._items.indexOf(p$h);if(-1!=p$f){var p$g=p$h;this.removeChild(p$g);for(var p$$=p$f+1,p$P=this._items.length;p$$<p$P;p$$++){var p$S=this._items[p$$];p$S.name="item"+(p$$-1),p$q&&("horizontal"==this._direction?p$S.x-=p$g.width+this._space:p$S.y-=p$g.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var p$B;p$B=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=p$B}}},p$q.initItems=function(){this._items||(this._items=[]);for(var p$h=this._items.length=0;p$h<1e4;p$h++){var p$q=this.getChildByName("item"+p$h);if(null==p$q)break;this._items.push(p$q),p$q.selected=p$h===this._selectedIndex,p$q.clickHandler=p$u.create(this,this.itemClick,[p$h],!1)}},p$q.itemClick=function(p$h){this.selectedIndex=p$h},p$q.setSelect=function(p$h,p$q){this._items&&-1<p$h&&p$h<this._items.length&&(this._items[p$h].selected=p$q)},p$q.createItem=function(p$h,p$q){return null},p$q.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var p$h=0,p$q=0,p$f=this._items.length;p$q<p$f;p$q++){var p$g=this._items[p$q];this._skin&&(p$g.skin=this._skin),this._labelColors&&(p$g.labelColors=this._labelColors),this._labelSize&&(p$g.labelSize=this._labelSize),this._labelStroke&&(p$g.labelStroke=this._labelStroke),this._labelStrokeColor&&(p$g.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(p$g.strokeColors=this._strokeColors),this._labelBold&&(p$g.labelBold=this._labelBold),this._labelPadding&&(p$g.labelPadding=this._labelPadding),this._labelAlign&&(p$g.labelAlign=this._labelAlign),this._stateNum&&(p$g.stateNum=this._stateNum),this._labelFont&&(p$g.labelFont=this._labelFont),"horizontal"===this._direction?(p$g.y=0,p$g.x=p$h,p$h+=p$g.width+this._space):(p$g.x=0,p$g.y=p$h,p$h+=p$g.height+this._space)}this.changeSize()},p$q.commitMeasure=function(){this.runCallLater(this.changeLabels)},p$q._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},p$$(0,p$q,"labelStrokeColor",function(){return this._labelStrokeColor},function(p$h){this._labelStrokeColor!=p$h&&(this._labelStrokeColor=p$h,this._setLabelChanged())}),p$$(0,p$q,"skin",function(){return this._skin},function(p$h){this._skin!=p$h&&(this._skin=p$h,this._setLabelChanged())}),p$$(0,p$q,"selectedIndex",function(){return this._selectedIndex},function(p$h){this._selectedIndex!=p$h&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=p$h,this.setSelect(p$h,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),p$$(0,p$q,"labels",function(){return this._labels},function(p$h){if(this._labels!=p$h){if(this._labels=p$h,this.removeChildren(),this._setLabelChanged(),this._labels)for(var p$q=this._labels.split(","),p$f=0,p$g=p$q.length;p$f<p$g;p$f++){var p$$=this.createItem(this._skin,p$q[p$f]);p$$.name="item"+p$f,this.addChild(p$$)}this.initItems()}}),p$$(0,p$q,"strokeColors",function(){return this._strokeColors},function(p$h){this._strokeColors!=p$h&&(this._strokeColors=p$h,this._setLabelChanged())}),p$$(0,p$q,"labelColors",function(){return this._labelColors},function(p$h){this._labelColors!=p$h&&(this._labelColors=p$h,this._setLabelChanged())}),p$$(0,p$q,"labelStroke",function(){return this._labelStroke},function(p$h){this._labelStroke!=p$h&&(this._labelStroke=p$h,this._setLabelChanged())}),p$$(0,p$q,"labelSize",function(){return this._labelSize},function(p$h){this._labelSize!=p$h&&(this._labelSize=p$h,this._setLabelChanged())}),p$$(0,p$q,"stateNum",function(){return this._stateNum},function(p$h){this._stateNum!=p$h&&(this._stateNum=p$h,this._setLabelChanged())}),p$$(0,p$q,"labelBold",function(){return this._labelBold},function(p$h){this._labelBold!=p$h&&(this._labelBold=p$h,this._setLabelChanged())}),p$$(0,p$q,"labelFont",function(){return this._labelFont},function(p$h){this._labelFont!=p$h&&(this._labelFont=p$h,this._setLabelChanged())}),p$$(0,p$q,"labelPadding",function(){return this._labelPadding},function(p$h){this._labelPadding!=p$h&&(this._labelPadding=p$h,this._setLabelChanged())}),p$$(0,p$q,"direction",function(){return this._direction},function(p$h){this._direction=p$h,this._setLabelChanged()}),p$$(0,p$q,"space",function(){return this._space},function(p$h){this._space=p$h,this._setLabelChanged()}),p$$(0,p$q,"items",function(){return this._items}),p$$(0,p$q,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(p$h){this.selectedIndex=this._items.indexOf(p$h)}),p$$(0,p$q,"dataSource",p$h.prototype._$get_dataSource,function(p$h){"number"==typeof(this._dataSource=p$h)&&Math.floor(p$h)==p$h||"string"==typeof p$h?this.selectedIndex=parseInt(p$h):p$h instanceof Array?this.labels=p$h.join(","):p$e.superSet(p$c,this,"dataSource",p$h)}),p$f}(p$c),p$x=function(p$q){function p$f(p$h,p$q){this._value=null,void 0===p$q&&(p$q=""),p$f.__super.call(this,p$h,p$q)}p$P(p$f,"laya.ui.Radio",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._value=null},p$h.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},p$h.initialize=function(){p$q.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},p$h.onClick=function(p$h){this.selected=!0},p$$(0,p$h,"value",function(){return null!=this._value?this._value:this.label},function(p$h){this._value=p$h}),p$f}(p$M),p$a=function(p$h){function p$q(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,p$q.__super.call(this),this.width=this.height=200}p$P(p$q,"laya.ui.Tree",p$h);var p$f=p$q.prototype;return p$e.imps(p$f,{"laya.ui.IRender":!0}),p$f.destroy=function(p$h){void 0===p$h&&(p$h=!0),laya.ui.Component.prototype.destroy.call(this,p$h),this._list&&this._list.destroy(p$h),this._list=null,this._source=null,this._renderHandler=null},p$f.createChildren=function(){this.addChild(this._list=new p$Z),this._list.renderHandler=p$u.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},p$f.onListChange=function(p$h){this.event("change")},p$f.getArray=function(){var p$h,p$q=[];for(var p$f in this._source)p$h=this._source[p$f],this.getParentOpenStatus(p$h)&&(p$h.x=this._spaceLeft*this.getDepth(p$h),p$q.push(p$h));return p$q},p$f.getDepth=function(p$h,p$q){return void 0===p$q&&(p$q=0),null==p$h.nodeParent?p$q:this.getDepth(p$h.nodeParent,p$q+1)},p$f.getParentOpenStatus=function(p$h){var p$q=p$h.nodeParent;return null==p$q||!!p$q.isOpen&&(null==p$q.nodeParent||this.getParentOpenStatus(p$q))},p$f.renderItem=function(p$h,p$q){var p$f=p$h.dataSource;if(p$f){p$h.left=p$f.x;var p$g=p$h.getChildByName("arrow");p$g&&(p$f.hasChild?(p$g.visible=!0,p$g.index=p$f.isOpen?1:0,p$g.tag=p$q,p$g.off("click",this,this.onArrowClick),p$g.on("click",this,this.onArrowClick)):p$g.visible=!1);var p$$=p$h.getChildByName("folder");p$$&&(2==p$$.clipY?p$$.index=p$f.isDirectory?0:1:p$$.index=p$f.isDirectory?p$f.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([p$h,p$q])}},p$f.onArrowClick=function(p$h){var p$q=p$h.currentTarget.tag;this._list.array[p$q].isOpen=!this._list.array[p$q].isOpen,this.event("open"),this._list.array=this.getArray()},p$f.setItemState=function(p$h,p$q){this._list.array[p$h]&&(this._list.array[p$h].isOpen=p$q,this._list.array=this.getArray())},p$f.fresh=function(){this._list.array=this.getArray(),this.repaint()},p$f.parseXml=function(p$h,p$q,p$f,p$g){var p$$,p$P=p$h.childNodes,p$S=p$P.length;if(!p$g){p$$={};var p$B,p$r=p$h.attributes;for(var p$Y in p$r){var p$C=(p$B=p$r[p$Y]).nodeName,p$U=p$B.nodeValue;p$$[p$C]="true"==p$U||"false"!=p$U&&p$U}p$$.nodeParent=p$f,0<p$S&&(p$$.isDirectory=!0),p$$.hasChild=0<p$S,p$q.push(p$$)}for(var p$u=0;p$u<p$S;p$u++){var p$v=p$P[p$u];this.parseXml(p$v,p$q,p$$,!1)}},p$f.parseOpenStatus=function(p$h,p$q){for(var p$f=0,p$g=p$q.length;p$f<p$g;p$f++){var p$$=p$q[p$f];if(p$$.isDirectory)for(var p$P=0,p$S=p$h.length;p$P<p$S;p$P++){var p$B=p$h[p$P];if(p$B.isDirectory&&this.isSameParent(p$B,p$$)&&p$$.label==p$B.label){p$$.isOpen=p$B.isOpen;break}}}},p$f.isSameParent=function(p$h,p$q){return null==p$h.nodeParent&&null==p$q.nodeParent||null!=p$h.nodeParent&&null!=p$q.nodeParent&&(p$h.nodeParent.label==p$q.nodeParent.label&&this.isSameParent(p$h.nodeParent,p$q.nodeParent))},p$f.filter=function(p$h){if(Boolean(p$h)){var p$q=[];this.getFilterSource(this._source,p$q,p$h),this._list.array=p$q}else this._list.array=this.getArray()},p$f.getFilterSource=function(p$h,p$q,p$f){var p$g;for(var p$$ in p$f=p$f.toLocaleLowerCase(),p$h)!(p$g=p$h[p$$]).isDirectory&&-1<String(p$g.label).toLowerCase().indexOf(p$f)&&(p$g.x=0,p$q.push(p$g)),p$g.child&&0<p$g.child.length&&this.getFilterSource(p$g.child,p$q,p$f)},p$$(0,p$f,"spaceBottom",function(){return this._list.spaceY},function(p$h){this._list.spaceY=p$h}),p$$(0,p$f,"keepStatus",function(){return this._keepStatus},function(p$h){this._keepStatus=p$h}),p$$(0,p$f,"itemRender",function(){return this._list.itemRender},function(p$h){this._list.itemRender=p$h}),p$$(0,p$f,"array",function(){return this._list.array},function(p$h){this._keepStatus&&this._list.array&&p$h&&this.parseOpenStatus(this._list.array,p$h),this._source=p$h,this._list.array=this.getArray()}),p$$(0,p$f,"mouseHandler",function(){return this._list.mouseHandler},function(p$h){this._list.mouseHandler=p$h}),p$$(0,p$f,"dataSource",p$h.prototype._$get_dataSource,function(p$h){this._dataSource=p$h,p$e.superSet(p$c,this,"dataSource",p$h)}),p$$(0,p$f,"source",function(){return this._source}),p$$(0,p$f,"scrollBar",function(){return this._list.scrollBar}),p$$(0,p$f,"list",function(){return this._list}),p$$(0,p$f,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(p$h){this._list.vScrollBarSkin=p$h}),p$$(0,p$f,"renderHandler",function(){return this._renderHandler},function(p$h){this._renderHandler=p$h}),p$$(0,p$f,"selectedIndex",function(){return this._list.selectedIndex},function(p$h){this._list.selectedIndex=p$h}),p$$(0,p$f,"spaceLeft",function(){return this._spaceLeft},function(p$h){this._spaceLeft=p$h}),p$$(0,p$f,"selectedItem",function(){return this._list.selectedItem},function(p$h){this._list.selectedItem=p$h}),p$$(0,p$f,"width",p$h.prototype._$get_width,function(p$h){p$e.superSet(p$c,this,"width",p$h),this._list.width=p$h}),p$$(0,p$f,"height",p$h.prototype._$get_height,function(p$h){p$e.superSet(p$c,this,"height",p$h),this._list.height=p$h}),p$$(0,p$f,"xml",null,function(p$h){var p$q=[];this.parseXml(p$h.childNodes[0],p$q,null,!0),this.array=p$q}),p$$(0,p$f,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),p$q}(p$c),p$hh=function(p$h){function p$q(){this._items=null,this._selectedIndex=0,p$q.__super.call(this),this._setIndexHandler=p$u.create(this,this.setIndex,null,!1)}p$P(p$q,"laya.ui.ViewStack",p$h);var p$f=p$q.prototype;return p$e.imps(p$f,{"laya.ui.IItem":!0}),p$f.setItems=function(p$h){this.removeChildren();for(var p$q=0,p$f=0,p$g=p$h.length;p$f<p$g;p$f++){var p$$=p$h[p$f];p$$&&(p$$.name="item"+p$q,this.addChild(p$$),p$q++)}this.initItems()},p$f.addItem=function(p$h){p$h.name="item"+this._items.length,this.addChild(p$h),this.initItems()},p$f.initItems=function(){this._items=[];for(var p$h=0;p$h<1e4;p$h++){var p$q=this.getChildByName("item"+p$h);if(null==p$q)break;this._items.push(p$q),p$q.visible=p$h==this._selectedIndex}},p$f.setSelect=function(p$h,p$q){this._items&&-1<p$h&&p$h<this._items.length&&(this._items[p$h].visible=p$q)},p$f.setIndex=function(p$h){this.selectedIndex=p$h},p$$(0,p$f,"dataSource",p$h.prototype._$get_dataSource,function(p$h){if("number"==typeof(this._dataSource=p$h)&&Math.floor(p$h)==p$h||"string"==typeof p$h)this.selectedIndex=parseInt(p$h);else for(var p$q in this._dataSource)this.hasOwnProperty(p$q)&&(this[p$q]=this._dataSource[p$q])}),p$$(0,p$f,"selectedIndex",function(){return this._selectedIndex},function(p$h){this._selectedIndex!=p$h&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=p$h,this.setSelect(this._selectedIndex,!0))}),p$$(0,p$f,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(p$h){this.selectedIndex=this._items.indexOf(p$h)}),p$$(0,p$f,"items",function(){return this._items}),p$$(0,p$f,"setIndexHandler",function(){return this._setIndexHandler},function(p$h){this._setIndexHandler=p$h}),p$q}(p$c),p$qh=function(p$h){function p$q(){p$q.__super.call(this)}return p$P(p$q,"laya.ui.VScrollBar",p$w),p$q}(),p$fh=function(p$q){function p$f(p$h){this._bg=null,this._skin=null,p$f.__super.call(this),void 0===p$h&&(p$h=""),this.text=p$h,this.skin=this.skin}p$P(p$f,"laya.ui.TextInput",p$q);var p$h=p$f.prototype;return p$h.preinitialize=function(){this.mouseEnabled=!0},p$h.destroy=function(p$h){p$N.clearCache(this,this._skin),void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._bg&&this._bg.destroy(),this._bg=null},p$h.createChildren=function(){this.addChild(this._tf=new p$v),this._tf.padding=p$p.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},p$h._onFocus=function(){this.event("focus",this)},p$h._onBlur=function(){this.event("blur",this)},p$h._onInput=function(){this.event("input",this)},p$h._onEnter=function(){this.event("enter",this)},p$h.initialize=function(){this.width=128,this.height=22},p$h.select=function(){this._tf.select()},p$h.setSelection=function(p$h,p$q){this._tf.setSelection(p$h,p$q)},p$$(0,p$h,"text",p$q.prototype._$get_text,function(p$h){this._tf.text!=p$h&&(p$h+="",this._tf.text=p$h,this.event("change"))}),p$$(0,p$h,"bg",function(){return this._bg},function(p$h){this.graphics=this._bg=p$h}),p$$(0,p$h,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(p$h){this._tf.inputElementYAdjuster=p$h}),p$$(0,p$h,"multiline",function(){return this._tf.multiline},function(p$h){this._tf.multiline=p$h}),p$$(0,p$h,"skin",function(){return this._skin},function(p$h){this._skin!=p$h&&(p$N.clearCache(this,this._skin),this._skin=p$h,this._bg||(this.graphics=this._bg=new p$b),p$N.keepCache(this,this._skin),this._bg.source=p$N.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),p$$(0,p$h,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(p$h){this._bg||(this.graphics=this._bg=new p$b),this._bg.sizeGrid=p$A.fillArray(p$p.defaultSizeGrid,p$h,Number)}),p$$(0,p$h,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(p$h){this._tf.inputElementXAdjuster=p$h}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$D,this,"width",p$h),this._bg&&(this._bg.width=p$h)}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$D,this,"height",p$h),this._bg&&(this._bg.height=p$h)}),p$$(0,p$h,"editable",function(){return this._tf.editable},function(p$h){this._tf.editable=p$h}),p$$(0,p$h,"restrict",function(){return this._tf.restrict},function(p$h){this._tf.restrict=p$h}),p$$(0,p$h,"prompt",function(){return this._tf.prompt},function(p$h){this._tf.prompt=p$h}),p$$(0,p$h,"promptColor",function(){return this._tf.promptColor},function(p$h){this._tf.promptColor=p$h}),p$$(0,p$h,"maxChars",function(){return this._tf.maxChars},function(p$h){this._tf.maxChars=p$h}),p$$(0,p$h,"focus",function(){return this._tf.focus},function(p$h){this._tf.focus=p$h}),p$$(0,p$h,"type",function(){return this._tf.type},function(p$h){this._tf.type=p$h}),p$$(0,p$h,"asPassword",function(){return this._tf.asPassword},function(p$h){this._tf.asPassword=p$h}),p$f}(p$D),p$gh=function(p$h){function p$q(){p$q.__super.call(this)}return p$P(p$q,"laya.ui.VSlider",p$k),p$q}(),p$$h=function(p$h){function p$g(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,p$g.__super.call(this)}p$P(p$g,"laya.ui.Dialog",p$h);var p$q=p$g.prototype;return p$q.initialize=function(){this.popupEffect=p$g.manager.popupEffectHandler,this.closeEffect=p$g.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},p$q._dealDragArea=function(){var p$h=this.getChildByName("drag");p$h&&(this.dragArea=p$h.x+","+p$h.y+","+p$h.width+","+p$h.height,p$h.removeSelf())},p$q._onClick=function(p$h){var p$q=p$h.target;if(p$q)switch(p$q.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(p$q.name)}},p$q.show=function(p$h,p$q){void 0===p$h&&(p$h=!1),void 0===p$q&&(p$q=!0),this._open(!1,p$h,p$q)},p$q.popup=function(p$h,p$q){void 0===p$h&&(p$h=!1),void 0===p$q&&(p$q=!0),this._open(!0,p$h,p$q)},p$q._open=function(p$h,p$q,p$f){p$g.manager.lock(!1),this.isModal=p$h,p$g.manager.open(this,p$q,p$f)},p$q.onOpened=function(){},p$q.close=function(p$h,p$q){void 0===p$q&&(p$q=!0),p$g.manager.close(this,p$h,p$q)},p$q.onClosed=function(p$h){},p$q._onMouseDown=function(p$h){var p$q=this.getMousePoint();this._dragArea.contains(p$q.x,p$q.y)?this.startDrag():this.stopDrag()},p$$(0,p$q,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(p$h){if(p$h){var p$q=p$A.fillArray([0,0,0,0],p$h,Number);this._dragArea=new p$_(p$q[0],p$q[1],p$q[2],p$q[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),p$$(0,p$q,"isPopup",function(){return null!=this.parent}),p$$(0,p$q,"zOrder",p$h.prototype._$get_zOrder,function(p$h){p$e.superSet(p$V,this,"zOrder",p$h),p$g.manager._checkMask()}),p$$(1,p$g,"manager",function(){return p$g._manager=p$g._manager||new p$z},function(p$h){p$g._manager=p$h}),p$g.setLockView=function(p$h){p$g.manager.setLockView(p$h)},p$g.lock=function(p$h){p$g.manager.lock(p$h)},p$g.closeAll=function(){p$g.manager.closeAll()},p$g.getDialogsByGroup=function(p$h){return p$g.manager.getDialogsByGroup(p$h)},p$g.closeByGroup=function(p$h){return p$g.manager.closeByGroup(p$h)},p$g.CLOSE="close",p$g.CANCEL="cancel",p$g.SURE="sure",p$g.NO="no",p$g.OK="ok",p$g.YES="yes",p$g._manager=null,p$g}(p$V),p$Ph=function(p$h){function p$q(){p$q.__super.call(this)}p$P(p$q,"laya.ui.HBox",p$h);var p$f=p$q.prototype;return p$f.sortItem=function(p$h){p$h&&p$h.sort(function(p$h,p$q){return p$h.x-p$q.x})},p$f.changeItems=function(){this._itemChanged=!1;for(var p$h=[],p$q=0,p$f=0,p$g=this.numChildren;p$f<p$g;p$f++){var p$$=this.getChildAt(p$f);p$$&&p$$.layoutEnabled&&(p$h.push(p$$),p$q=this._height?this._height:Math.max(p$q,p$$.height*p$$.scaleY))}this.sortItem(p$h);var p$P=0;for(p$f=0,p$g=p$h.length;p$f<p$g;p$f++)(p$$=p$h[p$f]).x=p$P,p$P+=p$$.width*p$$.scaleX+this._space,"top"==this._align?p$$.y=0:"middle"==this._align?p$$.y=.5*(p$q-p$$.height*p$$.scaleY):"bottom"==this._align&&(p$$.y=p$q-p$$.height*p$$.scaleY);this.changeSize()},p$$(0,p$f,"height",p$h.prototype._$get_height,function(p$h){this._height!=p$h&&(p$e.superSet(p$y,this,"height",p$h),this.callLater(this.changeItems))}),p$q.NONE="none",p$q.TOP="top",p$q.MIDDLE="middle",p$q.BOTTOM="bottom",p$q}(p$y),p$Sh=function(p$h){function p$q(){p$q.__super.call(this)}p$P(p$q,"laya.ui.VBox",p$h);var p$f=p$q.prototype;return p$f.changeItems=function(){this._itemChanged=!1;for(var p$h=[],p$q=0,p$f=0,p$g=this.numChildren;p$f<p$g;p$f++){var p$$=this.getChildAt(p$f);p$$&&p$$.layoutEnabled&&(p$h.push(p$$),p$q=this._width?this._width:Math.max(p$q,p$$.width*p$$.scaleX))}this.sortItem(p$h);var p$P=0;for(p$f=0,p$g=p$h.length;p$f<p$g;p$f++)(p$$=p$h[p$f]).y=p$P,p$P+=p$$.height*p$$.scaleY+this._space,"left"==this._align?p$$.x=0:"center"==this._align?p$$.x=.5*(p$q-p$$.width*p$$.scaleX):"right"==this._align&&(p$$.x=p$q-p$$.width*p$$.scaleX);this.changeSize()},p$$(0,p$f,"width",p$h.prototype._$get_width,function(p$h){this._width!=p$h&&(p$e.superSet(p$y,this,"width",p$h),this.callLater(this.changeItems))}),p$q.NONE="none",p$q.LEFT="left",p$q.CENTER="center",p$q.RIGHT="right",p$q}(p$y),p$Bh=function(p$h){function p$q(){p$q.__super.call(this)}return p$P(p$q,"laya.ui.RadioGroup",p$j),p$q.prototype.createItem=function(p$h,p$q){return new p$x(p$h,p$q)},p$q}(),p$rh=function(p$h){function p$q(){p$q.__super.call(this)}return p$P(p$q,"laya.ui.Tab",p$j),p$q.prototype.createItem=function(p$h,p$q){return new p$M(p$h,p$q)},p$q}(),p$Yh=function(p$q){function p$f(p$h){this._vScrollBar=null,this._hScrollBar=null,void 0===p$h&&(p$h=""),p$f.__super.call(this,p$h)}p$P(p$f,"laya.ui.TextArea",p$q);var p$h=p$f.prototype;return p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},p$h.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},p$h.onVBarChanged=function(p$h){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},p$h.onHBarChanged=function(p$h){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},p$h.changeScroll=function(){var p$h=this._vScrollBar&&0<this._tf.maxScrollY,p$q=this._hScrollBar&&0<this._tf.maxScrollX,p$f=p$h?this._width-this._vScrollBar.width:this._width,p$g=p$q?this._height-this._hScrollBar.height:this._height,p$$=this._tf.padding||p$p.labelPadding;this._tf.width=p$f,this._tf.height=p$g,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-p$$[2],this._vScrollBar.y=p$$[1],this._vScrollBar.height=this._height-(p$q?this._hScrollBar.height:0)-p$$[1]-p$$[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=p$g/Math.max(this._tf.textHeight,p$g),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=p$h),this._hScrollBar&&(this._hScrollBar.x=p$$[0],this._hScrollBar.y=this._height-this._hScrollBar.height-p$$[3],this._hScrollBar.width=this._width-(p$h?this._vScrollBar.width:0)-p$$[0]-p$$[2],this._hScrollBar.scrollSize=Math.max(.033*p$f,1),this._hScrollBar.thumbPercent=p$f/Math.max(this._tf.textWidth,p$f),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=p$q)},p$h.scrollTo=function(p$h){this.commitMeasure(),this._tf.scrollY=p$h},p$$(0,p$h,"scrollY",function(){return this._tf.scrollY}),p$$(0,p$h,"width",p$q.prototype._$get_width,function(p$h){p$e.superSet(p$fh,this,"width",p$h),this.callLater(this.changeScroll)}),p$$(0,p$h,"hScrollBar",function(){return this._hScrollBar}),p$$(0,p$h,"height",p$q.prototype._$get_height,function(p$h){p$e.superSet(p$fh,this,"height",p$h),this.callLater(this.changeScroll)}),p$$(0,p$h,"maxScrollX",function(){return this._tf.maxScrollX}),p$$(0,p$h,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(p$h){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new p$qh),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=p$h}),p$$(0,p$h,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(p$h){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new p$Q),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=p$h}),p$$(0,p$h,"vScrollBar",function(){return this._vScrollBar}),p$$(0,p$h,"maxScrollY",function(){return this._tf.maxScrollY}),p$$(0,p$h,"scrollX",function(){return this._tf.scrollX}),p$f}(p$fh);!function(p$h){function p$q(){this._uiView=null,this.isCloseOther=!1,p$q.__super.call(this)}p$P(p$q,"laya.ui.AsynDialog",p$$h);var p$f=p$q.prototype;p$f.createView=function(p$h){this._uiView=p$h},p$f._open=function(p$h,p$q,p$f){this.isModal=p$h,this.isCloseOther=p$q,p$$h.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},p$f.onCreated=function(){this.createUI(),this.onOpen()},p$f.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},p$f.onOpen=function(){p$$h.manager.open(this,this.isCloseOther),p$$h.manager.lock(!1)},p$f.close=function(p$h,p$q){void 0===p$q&&(p$q=!0),p$$h.manager.close(this),this.onClose()},p$f.onClose=function(){},p$f.destroy=function(p$h){void 0===p$h&&(p$h=!0),laya.ui.View.prototype.destroy.call(this,p$h),this._uiView=null,this.onDestroy()},p$f.onDestroy=function(){}}();p$e.__init([p$V])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(p$h,p$q){"use strict";for(var p$f in Object.defineProperty(p$q,"__esModule",{value:!0}),Laya){var p$g=Laya[p$f];p$g&&p$g.__isclass&&(p$q[p$f]=p$g)}}),function(p$u,p$h,p$E){p$E.un,p$E.uns;var p$U=p$E.static,p$v=p$E.class,p$L=p$E.getset,p$g=p$E.__newvec,p$m=laya.maths.Arith,p$S=laya.webgl.atlas.AtlasResourceManager,p$f=laya.webgl.shader.BaseShader,p$i=laya.utils.Browser,p$B=laya.webgl.utils.Buffer,p$R=laya.utils.Byte,p$$=laya.utils.ClassUtils,p$r=p$E.Config,p$P=(laya.events.Event,laya.events.EventDispatcher),p$p=laya.utils.Handler,p$_=laya.net.Loader,p$q=laya.net.LoaderManager,p$Y=(laya.maths.MathUtil,laya.display.Node),p$e=laya.renders.Render,p$C=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),p$l=laya.resource.Resource,p$N=laya.utils.RunDriver,p$G=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),p$t=laya.display.Sprite,p$X=laya.utils.Stat,p$n=laya.utils.StringKey,p$A=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),p$J=laya.utils.Utils,p$d=laya.webgl.WebGL,p$b=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;p$E.interface("laya.d3.core.IClone"),p$E.interface("laya.d3.graphics.IVertex"),p$E.interface("laya.d3.core.render.IUpdate"),p$E.interface("laya.d3.core.scene.ITreeNode"),p$E.interface("laya.d3.core.render.IRenderable");(function(){function p$M(){}p$v(p$M,"laya.d3.animation.AnimationClipParser01"),p$M.READ_DATA=function(){p$M._DATA.offset=p$M._reader.getUint32(),p$M._DATA.size=p$M._reader.getUint32()},p$M.READ_BLOCK=function(){for(var p$h=p$M._BLOCK.count=p$M._reader.getUint16(),p$q=p$M._BLOCK.blockStarts=[],p$f=p$M._BLOCK.blockLengths=[],p$g=0;p$g<p$h;p$g++)p$q.push(p$M._reader.getUint32()),p$f.push(p$M._reader.getUint32())},p$M.READ_STRINGS=function(){var p$h=p$M._reader.getUint32(),p$q=p$M._reader.getUint16(),p$f=p$M._reader.pos;p$M._reader.pos=p$h+p$M._DATA.offset;for(var p$g=0;p$g<p$q;p$g++)p$M._strings[p$g]=p$M._reader.readUTFString();p$M._reader.pos=p$f},p$M.parse=function(p$h,p$q){p$M._animationClip=p$h;(p$M._reader=p$q).__getBuffer();p$M.READ_DATA(),p$M.READ_BLOCK(),p$M.READ_STRINGS();for(var p$f=0,p$g=p$M._BLOCK.count;p$f<p$g;p$f++){var p$$=p$q.getUint16(),p$P=p$M._strings[p$$],p$S=p$M["READ_"+p$P];if(null==p$S)throw new Error("model file err,no this function:"+p$$+" "+p$P);p$S.call()}},p$M.READ_ANIMATIONS=function(){var p$h,p$q=0,p$f=0,p$g=p$M._reader,p$$=p$g.__getBuffer(),p$P=[],p$S=p$g.getUint8();for(p$P.length=p$S,p$q=0;p$q<p$S;p$q++)p$P[p$q]=p$g.getUint16();var p$B=[],p$r=p$g.getUint16();for(p$B.length=p$r,p$q=0;p$q<p$r;p$q++)p$B[p$q]=p$g.getFloat32();var p$Y=p$M._animationClip;p$Y.name=p$M._strings[p$g.getUint16()];var p$C=p$Y._duration=p$g.getFloat32();p$Y.islooping=!!p$g.getByte(),p$Y._frameRate=p$g.getInt16();var p$U=p$g.getInt16(),p$u=p$Y._nodes=new Array;p$u.length=p$U,(p$Y._publicClipDatas=[]).length=p$U;var p$v=p$Y._nodesMap={},p$L=0,p$e=0;for(p$q=0;p$q<p$U;p$q++){p$h=p$u[p$q]=new p$s;var p$l=p$g.getUint16(),p$_=p$h.path=[];for(p$_.length=p$l,p$f=0;p$f<p$l;p$f++)p$_[p$f]=p$M._strings[p$g.getUint16()];var p$N=p$_.join("/"),p$G=p$v[p$N];p$G||(p$v[p$N]=p$G=[]),p$G.push(p$h);var p$m=p$g.getInt16();-1!==p$m&&(p$h.componentType=p$M._strings[p$m]);var p$E=p$H._propertyIndexDic[p$M._strings[p$g.getUint16()]];if(null==p$E)throw new Error("AnimationClipParser01:unknown property name.");var p$R=p$E<4,p$t=!p$R||p$R&&""===p$_[0];(p$h._cacheProperty=p$t)?p$L++:p$e++,p$h.propertyNameID=p$E;var p$X=p$P[p$g.getUint8()];p$h.keyFrameWidth=p$X/4;var p$n=p$h.keyFrames=[],p$J=p$n.length=p$g.getUint16(),p$p=null,p$A=NaN;for(p$f=0;p$f<p$J;p$f++){var p$d=p$n[p$f]=new p$D;p$A=p$d.startTime=p$B[p$g.getUint16()];var p$b=p$g.pos;p$d.inTangent=new Float32Array(p$$.slice(p$b,p$b+p$X)),p$g.pos+=p$X,p$b=p$g.pos,p$d.outTangent=new Float32Array(p$$.slice(p$b,p$b+p$X)),p$g.pos+=p$X,p$b=p$g.pos,p$d.data=new Float32Array(p$$.slice(p$b,p$b+p$X)),p$g.pos+=p$X,p$p&&(p$p.next=p$d,p$p.duration=p$A-p$p.startTime),p$p=p$d}p$d.next=null,p$d.duration=p$C-p$A}var p$i=p$Y._nodeToCachePropertyMap=new Int32Array(p$U),p$z=p$Y._cachePropertyMap=new Int32Array(p$L),p$c=p$Y._unCachePropertyMap=new Int32Array(p$e);for(p$L=p$e=0,p$q=0;p$q<p$U;p$q++)(p$h=p$u[p$q])._cacheProperty?(p$i[p$q]=p$L,p$z[p$L++]=p$q):p$c[p$e++]=p$q},p$M._animationClip=null,p$M._reader=null,p$M._strings=[],p$U(p$M,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function p$w(){}p$v(p$w,"laya.d3.animation.AnimationClipParser02"),p$w.READ_DATA=function(){p$w._DATA.offset=p$w._reader.getUint32(),p$w._DATA.size=p$w._reader.getUint32()},p$w.READ_BLOCK=function(){for(var p$h=p$w._BLOCK.count=p$w._reader.getUint16(),p$q=p$w._BLOCK.blockStarts=[],p$f=p$w._BLOCK.blockLengths=[],p$g=0;p$g<p$h;p$g++)p$q.push(p$w._reader.getUint32()),p$f.push(p$w._reader.getUint32())},p$w.READ_STRINGS=function(){var p$h=p$w._reader.getUint32(),p$q=p$w._reader.getUint16(),p$f=p$w._reader.pos;p$w._reader.pos=p$h+p$w._DATA.offset;for(var p$g=0;p$g<p$q;p$g++)p$w._strings[p$g]=p$w._reader.readUTFString();p$w._reader.pos=p$f},p$w.parse=function(p$h,p$q){p$w._animationClip=p$h;(p$w._reader=p$q).__getBuffer();p$w.READ_DATA(),p$w.READ_BLOCK(),p$w.READ_STRINGS();for(var p$f=0,p$g=p$w._BLOCK.count;p$f<p$g;p$f++){var p$$=p$q.getUint16(),p$P=p$w._strings[p$$],p$S=p$w["READ_"+p$P];if(null==p$S)throw new Error("model file err,no this function:"+p$$+" "+p$P);p$S.call()}},p$w.READ_ANIMATIONS=function(){var p$h,p$q=0,p$f=0,p$g=p$w._reader,p$$=p$g.__getBuffer(),p$P=[],p$S=p$g.getUint8();for(p$P.length=p$S,p$q=0;p$q<p$S;p$q++)p$P[p$q]=p$g.getUint16();var p$B=[],p$r=p$g.getUint16();for(p$B.length=p$r,p$q=0;p$q<p$r;p$q++)p$B[p$q]=p$g.getFloat32();var p$Y=p$w._animationClip;p$Y.name=p$w._strings[p$g.getUint16()];var p$C=p$Y._duration=p$g.getFloat32();p$Y.islooping=!!p$g.getByte(),p$Y._frameRate=p$g.getInt16();var p$U=p$g.getInt16(),p$u=p$Y._nodes=new Array;p$u.length=p$U,(p$Y._publicClipDatas=[]).length=p$U;var p$v=p$Y._nodesMap={},p$L=0,p$e=0;for(p$q=0;p$q<p$U;p$q++){p$h=p$u[p$q]=new p$s;var p$l=p$g.getUint16(),p$_=p$h.path=[];for(p$_.length=p$l,p$f=0;p$f<p$l;p$f++)p$_[p$f]=p$w._strings[p$g.getUint16()];var p$N=p$_.join("/"),p$G=p$v[p$N];p$G||(p$v[p$N]=p$G=[]),p$G.push(p$h);var p$m=p$g.getInt16();-1!==p$m&&(p$h.componentType=p$w._strings[p$m]);var p$E=p$H._propertyIndexDic[p$w._strings[p$g.getUint16()]];if(null==p$E)throw new Error("AnimationClipParser02:unknown property name.");var p$R=p$E<4,p$t=!p$R||p$R&&""===p$_[0];(p$h._cacheProperty=p$t)?p$L++:p$e++,p$h.propertyNameID=p$E;var p$X=p$P[p$g.getUint8()];p$h.keyFrameWidth=p$X/4;var p$n=p$h.keyFrames=[],p$J=p$n.length=p$g.getUint16(),p$p=null,p$A=NaN;for(p$f=0;p$f<p$J;p$f++){var p$d=p$n[p$f]=new p$D;p$A=p$d.startTime=p$B[p$g.getUint16()];var p$b=p$g.pos;p$d.inTangent=new Float32Array(p$$.slice(p$b,p$b+p$X)),p$g.pos+=p$X,p$b=p$g.pos,p$d.outTangent=new Float32Array(p$$.slice(p$b,p$b+p$X)),p$g.pos+=p$X,p$b=p$g.pos,p$d.data=new Float32Array(p$$.slice(p$b,p$b+p$X)),p$g.pos+=p$X,p$p&&(p$p.next=p$d,p$p.duration=p$A-p$p.startTime),p$p=p$d}p$d.next=null,p$d.duration=p$C-p$A}var p$i=p$g.getUint16();for(p$q=0;p$q<p$i;p$q++){var p$z,p$c=new p$k;p$c.time=p$g.getFloat32(),p$c.eventName=p$w._strings[p$g.getUint16()];var p$M=p$g.getUint16();for(0<p$M&&(p$c.params=p$z=[]),p$f=0;p$f<p$M;p$f++){switch(p$g.getByte()){case 0:p$z.push(!!p$g.getByte());break;case 1:p$z.push(p$g.getInt32());break;case 2:p$z.push(p$g.getFloat32());break;case 3:p$z.push(p$w._strings[p$g.getUint16()]);break;default:throw new Error("unknown type.")}}p$Y.addEvent(p$c)}var p$W=p$Y._nodeToCachePropertyMap=new Int32Array(p$U),p$T=p$Y._cachePropertyMap=new Int32Array(p$L),p$I=p$Y._unCachePropertyMap=new Int32Array(p$e);for(p$L=p$e=0,p$q=0;p$q<p$U;p$q++)(p$h=p$u[p$q])._cacheProperty?(p$W[p$q]=p$L,p$T[p$L++]=p$q):p$I[p$e++]=p$q},p$w._animationClip=null,p$w._reader=null,p$w._strings=[],p$U(p$w,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var p$k=function(){function p$h(){this.time=NaN,this.eventName=null,this.params=null}return p$v(p$h,"laya.d3.animation.AnimationEvent"),p$h}(),p$H=function(){function p$g(){this._childs=[],this.transform=new p$Nq(this)}p$v(p$g,"laya.d3.animation.AnimationNode");var p$h=p$g.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.addChild=function(p$h){p$h._parent=this,p$h.transform.setParent(this.transform),this._childs.push(p$h)},p$h.removeChild=function(p$h){var p$q=this._childs.indexOf(p$h);-1!==p$q&&this._childs.splice(p$q,1)},p$h.getChildByName=function(p$h){for(var p$q=0,p$f=this._childs.length;p$q<p$f;p$q++){var p$g=this._childs[p$q];if(p$g.name===p$h)return p$g}return null},p$h.getChildByIndex=function(p$h){return this._childs[p$h]},p$h.getChildCount=function(){return this._childs.length},p$h.cloneTo=function(p$h){var p$q=p$h;p$q.name=this.name;for(var p$f=0,p$g=this._childs.length;p$f<p$g;p$f++){var p$$=this._childs[p$f],p$P=p$$.clone();p$q.addChild(p$P);var p$S=p$$.transform,p$B=p$P.transform;p$B.setLocalPosition(p$S.getLocalPosition()),p$B.setLocalRotation(p$S.getLocalRotation()),p$B.setLocalScale(p$S.getLocalScale()),p$B._localRotationEuler=p$S._localRotationEuler,p$B._setWorldMatrixIgnoreUpdate(p$S.getWorldMatrix())}},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$g.__init__=function(){p$g.registerAnimationNodeProperty("localPosition",p$g._getLocalPosition,p$g._setLocalPosition),p$g.registerAnimationNodeProperty("localRotation",p$g._getLocalRotation,p$g._setLocalRotation),p$g.registerAnimationNodeProperty("localScale",p$g._getLocalScale,p$g._setLocalScale),p$g.registerAnimationNodeProperty("localRotationEuler",p$g._getLocalRotationEuler,p$g._setLocalRotationEuler),p$g.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",p$g._getParticleRenderSharedMaterialTintColor,p$g._setParticleRenderSharedMaterialTintColor),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",p$g._getMeshRenderSharedMaterialTilingOffset,p$g._setMeshRenderSharedMaterialTilingOffset),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",p$g._getMeshRenderSharedMaterialAlbedo,p$g._setMeshRenderSharedMaterialAlbedo),p$g.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",p$g._getSkinnedMeshRenderSharedMaterialTilingOffset,p$g._setSkinnedMeshRenderSharedMaterialTilingOffset),p$g.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",p$g._getSkinnedMeshRenderSharedMaterialAlbedo,p$g._setSkinnedMeshRenderSharedMaterialAlbedo),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",p$g._getMeshRenderSharedMaterialAlbedo,p$g._setMeshRenderSharedMaterialAlbedo),p$g.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",p$g._getSkinnedMeshRenderSharedMaterialAlbedo,p$g._setSkinnedMeshRenderSharedMaterialAlbedo),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",p$g._getMeshRenderSharedMaterialIntensity,p$g._setMeshRenderSharedMaterialIntensity),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",p$g._getMeshRenderSharedMaterialAlpha,p$g._setMeshRenderSharedMaterialAlpha),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",p$g._getMeshRenderSharedMaterialAlphaColor,p$g._setMeshRenderSharedMaterialAlphaColor),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",p$g._getMeshRenderSharedMaterialBaseColor,p$g._setMeshRenderSharedMaterialBaseColor),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",p$g._getMeshRenderSharedMaterialDissolve,p$g._setMeshRenderSharedMaterialDissolve),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",p$g._getMeshRenderSharedMaterialDissolveSpeed,p$g._setMeshRenderSharedMaterialDissolveSpeed),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",p$g._getMeshRenderSharedMaterialMMultiplier,p$g._setMeshRenderSharedMaterialMMultiplier),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",p$g._getMeshRenderSharedMaterialBaseScrollSpeedX,p$g._setMeshRenderSharedMaterialBaseScrollSpeedX),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",p$g._getMeshRenderSharedMaterialBaseScrollSpeedY,p$g._setMeshRenderSharedMaterialBaseScrollSpeedY),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",p$g._getMeshRenderSharedMaterialSecondScrollSpeedX,p$g._setMeshRenderSharedMaterialSecondScrollSpeedX),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",p$g._getMeshRenderSharedMaterialSecondScrollSpeedY,p$g._setMeshRenderSharedMaterialSecondScrollSpeedY),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",p$g._getMeshRenderSharedMaterialDetailTilingOffset,p$g._setMeshRenderSharedMaterialDetailTilingOffset),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",p$g._getMeshRenderSharedMaterialDissolveTilingOffset,p$g._setMeshRenderSharedMaterialDissolveTilingOffset),p$g.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",p$g._getMeshRenderSharedMaterialMaskTilingOffset,p$g._setMeshRenderSharedMaterialMaskTilingOffset)},p$g.registerAnimationNodeProperty=function(p$h,p$q,p$f){if(p$g._propertyIndexDic[p$h])throw new Error("AnimationNode: this propertyName has registered.");p$g._propertyIndexDic[p$h]=p$g._propertyIDCounter,p$g._propertyGetFuncs[p$g._propertyIDCounter]=p$q,p$g._propertySetFuncs[p$g._propertyIDCounter]=p$f,p$g._propertyIDCounter++},p$g._getLocalPosition=function(p$h,p$q){return p$h?p$h.transform.getLocalPosition():p$q._transform.localPosition.elements},p$g._setLocalPosition=function(p$h,p$q,p$f){if(p$h)p$h.transform.setLocalPosition(p$f);else{var p$g=p$q._transform,p$$=p$g.localPosition;p$$.elements=p$f,p$g.localPosition=p$$}},p$g._getLocalRotation=function(p$h,p$q){return p$h?p$h.transform.getLocalRotation():p$q._transform.localRotation.elements},p$g._setLocalRotation=function(p$h,p$q,p$f){if(p$h)p$h.transform.setLocalRotation(p$f);else{var p$g=p$q._transform,p$$=p$g.localRotation;p$$.elements=p$f,p$g.localRotation=p$$}},p$g._getLocalScale=function(p$h,p$q){return p$h?p$h.transform.getLocalScale():p$q._transform.localScale.elements},p$g._setLocalScale=function(p$h,p$q,p$f){if(p$h)p$h.transform.setLocalScale(p$f);else{var p$g=p$q._transform,p$$=p$g.localScale;p$$.elements=p$f,p$g.localScale=p$$}},p$g._getLocalRotationEuler=function(p$h,p$q){return p$h?p$h.transform.getLocalRotationEuler():p$q._transform.localRotationEuler.elements},p$g._setLocalRotationEuler=function(p$h,p$q,p$f){if(p$h)p$h.transform.setLocalRotationEuler(p$f);else{var p$g=p$q._transform,p$$=p$g.localRotationEuler;p$$.elements=p$f,p$g.localRotationEuler=p$$}},p$g._getMeshRenderSharedMaterialTilingOffset=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return p$q.meshRender.sharedMaterial.tilingOffset.elements},p$g._setMeshRenderSharedMaterialTilingOffset=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.meshRender.material).tilingOffset).elements=p$f,p$g.tilingOffset=p$$)}else(p$$=(p$g=p$q.meshRender.material).tilingOffset).elements=p$f,p$g.tilingOffset=p$$},p$g._getMeshRenderSharedMaterialAlbedo=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.albedoColor.elements:null}return p$q.meshRender.sharedMaterial.albedoColor.elements},p$g._setMeshRenderSharedMaterialAlbedo=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.meshRender.material).albedoColor).elements=p$f,p$g.albedoColor=p$$)}else(p$$=(p$g=p$q.meshRender.material).albedoColor).elements=p$f,p$g.albedoColor=p$$},p$g._getSkinnedMeshRenderSharedMaterialTilingOffset=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return p$q.skinnedMeshRender.sharedMaterial.tilingOffset.elements},p$g._setSkinnedMeshRenderSharedMaterialTilingOffset=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.skinnedMeshRender.material).tilingOffset).elements=p$f,p$g.tilingOffset=p$$)}else(p$$=(p$g=p$q.skinnedMeshRender.material).tilingOffset).elements=p$f,p$g.tilingOffset=p$$},p$g._getSkinnedMeshRenderSharedMaterialAlbedo=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return p$q.skinnedMeshRender.sharedMaterial.albedoColor.elements},p$g._setSkinnedMeshRenderSharedMaterialAlbedo=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.skinnedMeshRender.material).albedoColor).elements=p$f,p$g.albedoColor=p$$)}else(p$$=(p$g=p$q.skinnedMeshRender.material).albedoColor).elements=p$f,p$g.albedoColor=p$$},p$g._getParticleRenderSharedMaterialTintColor=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.particleRender.sharedMaterial.tintColor.elements:null}return p$q.particleRender.sharedMaterial.tintColor.elements},p$g._setParticleRenderSharedMaterialTintColor=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.particleRender.material).tintColor).elements=p$f,p$g.tintColor=p$$)}else(p$$=(p$g=p$q.particleRender.material).tintColor).elements=p$f,p$g.tintColor=p$$},p$g._getMeshRenderSharedMaterialAlphaColor=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.alphaColor.elements:null}return p$q.meshRender.sharedMaterial.alphaColor.elements},p$g._setMeshRenderSharedMaterialAlphaColor=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.meshRender.material).alphaColor).elements=p$f,p$g.alphaColor=p$$)}else(p$$=(p$g=p$q.meshRender.material).alphaColor).elements=p$f,p$g.alphaColor=p$$},p$g._getMeshRenderSharedMaterialBaseColor=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.baseColor.elements:null}return p$q.meshRender.sharedMaterial.baseColor.elements},p$g._setMeshRenderSharedMaterialBaseColor=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.meshRender.material).baseColor).elements=p$f,p$g.baseColor=p$$)}else(p$$=(p$g=p$q.meshRender.material).baseColor).elements=p$f,p$g.baseColor=p$$},p$g._getMeshRenderSharedMaterialDissolve=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.dissolve:0}return p$q.meshRender.sharedMaterial.dissolve},p$g._setMeshRenderSharedMaterialDissolve=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.dissolve=p$f[0])}else p$q.meshRender.material.dissolve=p$f[0]},p$g._getMeshRenderSharedMaterialDissolveSpeed=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.dissolveSpeed:0}return p$q.meshRender.sharedMaterial.dissolveSpeed},p$g._setMeshRenderSharedMaterialDissolveSpeed=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.dissolveSpeed=p$f[0])}else p$q.meshRender.material.dissolveSpeed=p$f[0]},p$g._getMeshRenderSharedMaterialMMultiplier=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.mMultiplier:0}return p$q.meshRender.sharedMaterial.mMultiplier},p$g._setMeshRenderSharedMaterialMMultiplier=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.mMultiplier=p$f[0])}else p$q.meshRender.material.mMultiplier=p$f[0]},p$g._getMeshRenderSharedMaterialBaseScrollSpeedX=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return p$q.meshRender.sharedMaterial.baseScrollSpeedX},p$g._setMeshRenderSharedMaterialBaseScrollSpeedX=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.baseScrollSpeedX=p$f[0])}else p$q.meshRender.material.baseScrollSpeedX=p$f[0]},p$g._getMeshRenderSharedMaterialBaseScrollSpeedY=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return p$q.meshRender.sharedMaterial.baseScrollSpeedY},p$g._setMeshRenderSharedMaterialBaseScrollSpeedY=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.baseScrollSpeedY=p$f[0])}else p$q.meshRender.material.baseScrollSpeedY=p$f[0]},p$g._getMeshRenderSharedMaterialSecondScrollSpeedX=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return p$q.meshRender.sharedMaterial.secondScrollSpeedX},p$g._setMeshRenderSharedMaterialSecondScrollSpeedX=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.secondScrollSpeedX=p$f[0])}else p$q.meshRender.material.secondScrollSpeedX=p$f[0]},p$g._getMeshRenderSharedMaterialSecondScrollSpeedY=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return p$q.meshRender.sharedMaterial.secondScrollSpeedY},p$g._setMeshRenderSharedMaterialSecondScrollSpeedY=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.secondScrollSpeedY=p$f[0])}else p$q.meshRender.material.secondScrollSpeedY=p$f[0]},p$g._getMeshRenderSharedMaterialAlpha=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.alpha:0}return p$q.meshRender.sharedMaterial.alpha},p$g._setMeshRenderSharedMaterialAlpha=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.alpha=p$f[0])}else p$q.meshRender.material.alpha=p$f[0]},p$g._getMeshRenderSharedMaterialIntensity=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.intensity:0}return p$q.meshRender.sharedMaterial.intensity},p$g._setMeshRenderSharedMaterialIntensity=function(p$h,p$q,p$f){if(p$h){var p$g=p$h.transform._entity;p$g&&(p$g.owner.meshRender.material.intensity=p$f[0])}else p$q.meshRender.material.intensity=p$f[0]},p$g._getMeshRenderSharedMaterialDetailTilingOffset=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return p$q.meshRender.sharedMaterial.detailTilingOffset.elements},p$g._setMeshRenderSharedMaterialDetailTilingOffset=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.meshRender.material).detailTilingOffset).elements=p$f,p$g.detailTilingOffset=p$$)}else(p$$=(p$g=p$q.meshRender.material).detailTilingOffset).elements=p$f,p$g.detailTilingOffset=p$$},p$g._getMeshRenderSharedMaterialDissolveTilingOffset=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return p$q.meshRender.sharedMaterial.dissolveTilingOffset.elements},p$g._setMeshRenderSharedMaterialDissolveTilingOffset=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.meshRender.material).dissolveTilingOffset).elements=p$f,p$g.dissolveTilingOffset=p$$)}else(p$$=(p$g=p$q.meshRender.material).dissolveTilingOffset).elements=p$f,p$g.dissolveTilingOffset=p$$},p$g._getMeshRenderSharedMaterialMaskTilingOffset=function(p$h,p$q){if(p$h){var p$f=p$h.transform._entity;return p$f?p$f.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return p$q.meshRender.sharedMaterial.maskTilingOffset.elements},p$g._setMeshRenderSharedMaterialMaskTilingOffset=function(p$h,p$q,p$f){var p$g,p$$;if(p$h){var p$P=p$h.transform._entity;p$P&&((p$$=(p$g=p$P.owner.meshRender.material).maskTilingOffset).elements=p$f,p$g.maskTilingOffset=p$$)}else(p$$=(p$g=p$q.meshRender.material).maskTilingOffset).elements=p$f,p$g.maskTilingOffset=p$$},p$g._propertyIDCounter=0,p$g._propertyIndexDic={},p$g._propertySetFuncs=[],p$g._propertyGetFuncs=[],p$g}(),p$D=function(){function p$h(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return p$v(p$h,"laya.d3.animation.Keyframe"),p$h}(),p$s=function(){function p$h(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return p$v(p$h,"laya.d3.animation.KeyframeNode"),p$h}(),p$z=(function(){function p$h(){this._tempVector30=new p$Sq,this._tempVector31=new p$Sq,this._tempVector32=new p$Sq,this._a=new p$Sq,this._b=new p$Sq,this._c=new p$Sq,this._d=new p$Sq}p$v(p$h,"laya.d3.core.glitter.SplineCurvePositionVelocity");var p$q=p$h.prototype;p$q.Init=function(p$h,p$q,p$f,p$g){p$h.cloneTo(this._d),p$q.cloneTo(this._c),p$Sq.scale(p$h,2,this._a),p$Sq.scale(p$f,2,this._tempVector30),p$Sq.subtract(this._a,this._tempVector30,this._a),p$Sq.add(this._a,p$q,this._a),p$Sq.add(this._a,p$g,this._a),p$Sq.scale(p$f,3,this._b),p$Sq.scale(p$h,3,this._tempVector30),p$Sq.subtract(this._b,this._tempVector30,this._b),p$Sq.subtract(this._b,p$g,this._b),p$Sq.scale(p$q,2,this._tempVector30),p$Sq.subtract(this._b,this._tempVector30,this._b)},p$q.Slerp=function(p$h,p$q){p$Sq.scale(this._a,p$h*p$h*p$h,this._tempVector30),p$Sq.scale(this._b,p$h*p$h,this._tempVector31),p$Sq.scale(this._c,p$h,this._tempVector32),p$Sq.add(this._tempVector30,this._tempVector31,p$q),p$Sq.add(p$q,this._tempVector32,p$q),p$Sq.add(p$q,this._d,p$q)}}(),function(){function p$T(p$h,p$q,p$f,p$g){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=p$h,this._h=p$q,this._minHeight=p$f,this._maxHeight=p$g}p$v(p$T,"laya.d3.core.HeightMap");var p$h=p$T.prototype;p$h._inBounds=function(p$h,p$q){return 0<=p$h&&p$h<this._h&&0<=p$q&&p$q<this._w},p$h.getHeight=function(p$h,p$q){return this._inBounds(p$h,p$q)?this._datas[p$h][p$q]:NaN},p$L(0,p$h,"width",function(){return this._w}),p$L(0,p$h,"height",function(){return this._h}),p$L(0,p$h,"maxHeight",function(){return this._maxHeight}),p$L(0,p$h,"minHeight",function(){return this._minHeight}),p$T.creatFromMesh=function(p$h,p$q,p$f,p$g){for(var p$$=[],p$P=[],p$S=p$h.getSubMeshCount(),p$B=0;p$B<p$S;p$B++){for(var p$r=p$h.getSubMesh(p$B),p$Y=p$r._getVertexBuffer(),p$C=p$Y.getData(),p$U=[],p$u=0;p$u<p$C.length;p$u+=p$Y.vertexDeclaration.vertexStride/4){var p$v=new p$Sq(p$C[p$u+0],p$C[p$u+1],p$C[p$u+2]);p$U.push(p$v)}p$$.push(p$U);var p$L=p$r._getIndexBuffer();p$P.push(p$L.getData())}var p$e=p$h.boundingBox,p$l=p$e.min.x,p$_=p$e.min.z,p$N=p$e.max.x,p$G=p$e.max.z,p$m=p$e.min.y,p$E=p$e.max.y,p$R=p$N-p$l,p$t=p$G-p$_,p$X=p$g.elements[0]=p$R/(p$q-1),p$n=p$g.elements[1]=p$t/(p$f-1),p$J=new p$T(p$q,p$f,p$m,p$E),p$p=p$T._tempRay,p$A=p$p.direction.elements;p$A[0]=0,p$A[1]=-1,p$A[2]=0;var p$d=p$E+.1;p$p.origin.elements[1]=p$d;for(var p$b=0;p$b<p$f;p$b++){var p$i=p$_+p$b*p$n;p$J._datas[p$b]=[];for(var p$z=0;p$z<p$q;p$z++){var p$c=p$l+p$z*p$X,p$M=p$p.origin.elements;p$M[0]=p$c,p$M[2]=p$i;var p$W=p$T._getPosition(p$p,p$$,p$P);p$J._datas[p$b][p$z]=p$W===Number.MAX_VALUE?NaN:p$d-p$W}}return p$J},p$T.createFromImage=function(p$h,p$q,p$f){for(var p$g=p$h.width,p$$=p$h.height,p$P=new p$T(p$g,p$$,p$q,p$f),p$S=(p$f-p$q)/254,p$B=p$h.getPixels(),p$r=0,p$Y=0;p$Y<p$$;p$Y++)for(var p$C=p$P._datas[p$Y]=[],p$U=0;p$U<p$g;p$U++){var p$u=p$B[p$r++],p$v=p$B[p$r++],p$L=p$B[p$r++],p$e=p$B[p$r++];p$C[p$U]=255==p$u&&255==p$v&&255==p$L&&255==p$e?NaN:(p$u+p$v+p$L)/3*p$S+p$q}return p$P},p$T._getPosition=function(p$h,p$q,p$f){for(var p$g=Number.MAX_VALUE,p$$=0;p$$<p$q.length;p$$++)for(var p$P=p$q[p$$],p$S=p$f[p$$],p$B=0;p$B<p$S.length;p$B+=3){var p$r=p$P[p$S[p$B+0]],p$Y=p$P[p$S[p$B+1]],p$C=p$P[p$S[p$B+2]],p$U=p$Lq.rayIntersectsTriangle(p$h,p$r,p$Y,p$C);!isNaN(p$U)&&p$U<p$g&&(p$g=p$U)}return p$g},p$U(p$T,["_tempRay",function(){return this._tempRay=new p$$q(new p$Sq,new p$Sq)}])}(),function(){function p$$(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}p$v(p$$,"laya.d3.core.Layer");var p$h=p$$.prototype;return p$h._binarySearchIndex=function(){for(var p$h=0,p$q=p$$._collsionTestList.length-1,p$f=0;p$h<=p$q;){p$f=Math.floor((p$h+p$q)/2);var p$g=p$$._collsionTestList[p$f];if(p$g==this._number)return p$f;p$g>this._number?p$q=p$f-1:p$h=p$f+1}return p$h},p$h._addCollider=function(p$h){0===this._colliders.length&&p$$._collsionTestList.splice(this._binarySearchIndex(),0,this._number),p$h._isRigidbody?(this._colliders.unshift(p$h),this._nonRigidbodyOffset++):this._colliders.push(p$h)},p$h._removeCollider=function(p$h){var p$q=this._colliders.indexOf(p$h);p$q<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(p$q,1),0===this._colliders.length&&p$$._collsionTestList.splice(p$$._collsionTestList.indexOf(this._number),1)},p$L(0,p$h,"number",function(){return this._number}),p$L(0,p$h,"visible",function(){return this._visible},function(p$h){this._visible=p$h,p$$._visibleLayers=p$h?p$$._visibleLayers|this.mask:p$$._visibleLayers&~this.mask}),p$L(0,p$h,"mask",function(){return this._mask}),p$L(1,p$$,"visibleLayers",function(){return p$$._visibleLayers},function(p$h){p$$._visibleLayers=p$h;for(var p$q=0,p$f=p$$._layerList.length;p$q<p$f;p$q++){var p$g=p$$._layerList[p$q];p$g._visible=0!=(p$g._mask&p$$._visibleLayers)}}),p$$.__init__=function(){p$$._layerList.length=31;for(var p$h=0;p$h<31;p$h++){var p$q=new p$$;p$$._layerList[p$h]=p$q,0===p$h?(p$q.name="Default Layer",p$q.visible=!0):(p$q.name="Layer-"+p$h,p$q.visible=!1),p$q._number=p$h,p$q._mask=Math.pow(2,p$h)}p$$.currentCreationLayer=p$$._layerList[0]},p$$.getLayerByNumber=function(p$h){if(p$h<0||30<p$h)throw new Error("无法返回指定Layer，该number超出范围！");return p$$._layerList[p$h]},p$$.getLayerByName=function(p$h){for(var p$q=0;p$q<31;p$q++)if(p$$._layerList[p$q].name===p$h)return p$$._layerList[p$q];throw new Error("无法返回指定Layer,该name不存在")},p$$.isVisible=function(p$h){return 0!=(p$h&p$$._currentCameraCullingMask&p$$._visibleLayers)},p$$._layerList=[],p$$._visibleLayers=2147483647,p$$._collsionTestList=[],p$$._currentCameraCullingMask=2147483647,p$$.maxCount=31,p$$.currentCreationLayer=null,p$$}()),p$c=(function(){function p$h(p$h,p$q,p$f){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=p$h,this._minCount=p$q,this._maxCount=p$f}p$v(p$h,"laya.d3.core.particleShuriKen.module.Burst");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.cloneTo=function(p$h){var p$q=p$h;p$q._time=this._time,p$q._minCount=this._minCount,p$q._maxCount=this._maxCount},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"time",function(){return this._time}),p$L(0,p$q,"minCount",function(){return this._minCount}),p$L(0,p$q,"maxCount",function(){return this._maxCount})}(),function(){function p$h(p$h){this._color=null,this.enbale=!1,this._color=p$h}p$v(p$h,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var p$q=p$h.prototype;p$q.cloneTo=function(p$h){var p$q=p$h;this._color.cloneTo(p$q._color),p$q.enbale=this.enbale},p$q.clone=function(){var p$h;switch(this._color.type){case 0:p$h=p$W.createByConstant(this._color.constant.clone());break;case 1:p$h=p$W.createByGradient(this._color.gradient.clone());break;case 2:p$h=p$W.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:p$h=p$W.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var p$q=new this.constructor(p$h);return p$q.enbale=this.enbale,p$q},p$L(0,p$q,"color",function(){return this._color})}(),function(){function p$h(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}p$v(p$h,"laya.d3.core.particleShuriKen.module.Emission");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),p$q._destroy=function(){this._bursts=null,this._destroyed=!0},p$q.getBurstsCount=function(){return this._bursts.length},p$q.getBurstByIndex=function(p$h){return this._bursts[p$h]},p$q.addBurst=function(p$h){var p$q=this._bursts.length;if(0<p$q)for(var p$f=0;p$f<p$q;p$f++)this._bursts[p$f].time>p$h.time&&this._bursts.splice(p$f,0,p$h);this._bursts.push(p$h)},p$q.removeBurst=function(p$h){var p$q=this._bursts.indexOf(p$h);-1!==p$q&&this._bursts.splice(p$q,1)},p$q.removeBurstByIndex=function(p$h){this._bursts.splice(p$h,1)},p$q.clearBurst=function(){this._bursts.length=0},p$q.cloneTo=function(p$h){var p$q=p$h,p$f=p$q._bursts;p$f.length=this._bursts.length;for(var p$g=0,p$$=this._bursts.length;p$g<p$$;p$g++){var p$P=p$f[p$g];p$P?this._bursts[p$g].cloneTo(p$P):p$f[p$g]=this._bursts[p$g].clone()}p$q._emissionRate=this._emissionRate,p$q.enbale=this.enbale},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"destroyed",function(){return this._destroyed}),p$L(0,p$q,"emissionRate",function(){return this._emissionRate},function(p$h){if(p$h<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=p$h})}(),function(){function p$g(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}p$v(p$g,"laya.d3.core.particleShuriKen.module.FrameOverTime");var p$h=p$g.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.cloneTo=function(p$h){var p$q=p$h;p$q._type=this._type,p$q._constant=this._constant,this._overTime.cloneTo(p$q._overTime),p$q._constantMin=this._constantMin,p$q._constantMax=this._constantMax,this._overTimeMin.cloneTo(p$q._overTimeMin),this._overTimeMax.cloneTo(p$q._overTimeMax)},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$h,"frameOverTimeData",function(){return this._overTime}),p$L(0,p$h,"constant",function(){return this._constant}),p$L(0,p$h,"type",function(){return this._type}),p$L(0,p$h,"frameOverTimeDataMin",function(){return this._overTimeMin}),p$L(0,p$h,"constantMin",function(){return this._constantMin}),p$L(0,p$h,"frameOverTimeDataMax",function(){return this._overTimeMax}),p$L(0,p$h,"constantMax",function(){return this._constantMax}),p$g.createByConstant=function(p$h){var p$q=new p$g;return p$q._type=0,p$q._constant=p$h,p$q},p$g.createByOverTime=function(p$h){var p$q=new p$g;return p$q._type=1,p$q._overTime=p$h,p$q},p$g.createByRandomTwoConstant=function(p$h,p$q){var p$f=new p$g;return p$f._type=2,p$f._constantMin=p$h,p$f._constantMax=p$q,p$f},p$g.createByRandomTwoOverTime=function(p$h,p$q){var p$f=new p$g;return p$f._type=3,p$f._overTimeMin=p$h,p$f._overTimeMax=p$q,p$f},p$g}()),p$M=function(){function p$Y(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}p$v(p$Y,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var p$h=p$Y.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.cloneTo=function(p$h){var p$q=p$h;p$q._type=this._type,p$q._separateAxes=this._separateAxes,p$q._constant=this._constant,this._constantSeparate.cloneTo(p$q._constantSeparate),this._gradient.cloneTo(p$q._gradient),this._gradientX.cloneTo(p$q._gradientX),this._gradientY.cloneTo(p$q._gradientY),this._gradientZ.cloneTo(p$q._gradientZ),p$q._constantMin=this._constantMin,p$q._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(p$q._constantMinSeparate),this._constantMaxSeparate.cloneTo(p$q._constantMaxSeparate),this._gradientMin.cloneTo(p$q._gradientMin),this._gradientMax.cloneTo(p$q._gradientMax),this._gradientXMin.cloneTo(p$q._gradientXMin),this._gradientXMax.cloneTo(p$q._gradientXMax),this._gradientYMin.cloneTo(p$q._gradientYMin),this._gradientYMax.cloneTo(p$q._gradientYMax),this._gradientZMin.cloneTo(p$q._gradientZMin),this._gradientZMax.cloneTo(p$q._gradientZMax)},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$h,"gradientZ",function(){return this._gradientZ}),p$L(0,p$h,"constant",function(){return this._constant}),p$L(0,p$h,"gradient",function(){return this._gradient}),p$L(0,p$h,"separateAxes",function(){return this._separateAxes}),p$L(0,p$h,"type",function(){return this._type}),p$L(0,p$h,"constantSeparate",function(){return this._constantSeparate}),p$L(0,p$h,"gradientX",function(){return this._gradientX}),p$L(0,p$h,"gradientY",function(){return this._gradientY}),p$L(0,p$h,"gradientW",function(){return this._gradientW}),p$L(0,p$h,"gradientMin",function(){return this._gradientMin}),p$L(0,p$h,"constantMin",function(){return this._constantMin}),p$L(0,p$h,"gradientMax",function(){return this._gradientMax}),p$L(0,p$h,"constantMax",function(){return this._constantMax}),p$L(0,p$h,"gradientWMin",function(){return this._gradientWMin}),p$L(0,p$h,"constantMinSeparate",function(){return this._constantMinSeparate}),p$L(0,p$h,"constantMaxSeparate",function(){return this._constantMaxSeparate}),p$L(0,p$h,"gradientXMin",function(){return this._gradientXMin}),p$L(0,p$h,"gradientXMax",function(){return this._gradientXMax}),p$L(0,p$h,"gradientWMax",function(){return this._gradientWMax}),p$L(0,p$h,"gradientYMin",function(){return this._gradientYMin}),p$L(0,p$h,"gradientYMax",function(){return this._gradientYMax}),p$L(0,p$h,"gradientZMin",function(){return this._gradientZMin}),p$L(0,p$h,"gradientZMax",function(){return this._gradientZMax}),p$Y.createByConstant=function(p$h){var p$q=new p$Y;return p$q._type=0,p$q._separateAxes=!1,p$q._constant=p$h,p$q},p$Y.createByConstantSeparate=function(p$h){var p$q=new p$Y;return p$q._type=0,p$q._separateAxes=!0,p$q._constantSeparate=p$h,p$q},p$Y.createByGradient=function(p$h){var p$q=new p$Y;return p$q._type=1,p$q._separateAxes=!1,p$q._gradient=p$h,p$q},p$Y.createByGradientSeparate=function(p$h,p$q,p$f,p$g){var p$$=new p$Y;return p$$._type=1,p$$._separateAxes=!0,p$$._gradientX=p$h,p$$._gradientY=p$q,p$$._gradientZ=p$f,p$$._gradientW=p$g,p$$},p$Y.createByRandomTwoConstant=function(p$h,p$q){var p$f=new p$Y;return p$f._type=2,p$f._separateAxes=!1,p$f._constantMin=p$h,p$f._constantMax=p$q,p$f},p$Y.createByRandomTwoConstantSeparate=function(p$h,p$q){var p$f=new p$Y;return p$f._type=2,p$f._separateAxes=!0,p$f._constantMinSeparate=p$h,p$f._constantMaxSeparate=p$q,p$f},p$Y.createByRandomTwoGradient=function(p$h,p$q){var p$f=new p$Y;return p$f._type=3,p$f._separateAxes=!1,p$f._gradientMin=p$h,p$f._gradientMax=p$q,p$f},p$Y.createByRandomTwoGradientSeparate=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){var p$r=new p$Y;return p$r._type=3,p$r._separateAxes=!0,p$r._gradientXMin=p$h,p$r._gradientXMax=p$q,p$r._gradientYMin=p$f,p$r._gradientYMax=p$g,p$r._gradientZMin=p$$,p$r._gradientZMax=p$P,p$r._gradientWMin=p$S,p$r._gradientWMax=p$B,p$r},p$Y}(),p$W=function(){function p$g(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}p$v(p$g,"laya.d3.core.particleShuriKen.module.GradientColor");var p$h=p$g.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.cloneTo=function(p$h){var p$q=p$h;p$q._type=this._type,this._constant.cloneTo(p$q._constant),this._constantMin.cloneTo(p$q._constantMin),this._constantMax.cloneTo(p$q._constantMax),this._gradient.cloneTo(p$q._gradient),this._gradientMin.cloneTo(p$q._gradientMin),this._gradientMax.cloneTo(p$q._gradientMax)},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$h,"gradient",function(){return this._gradient}),p$L(0,p$h,"constant",function(){return this._constant}),p$L(0,p$h,"type",function(){return this._type}),p$L(0,p$h,"gradientMin",function(){return this._gradientMin}),p$L(0,p$h,"constantMin",function(){return this._constantMin}),p$L(0,p$h,"gradientMax",function(){return this._gradientMax}),p$L(0,p$h,"constantMax",function(){return this._constantMax}),p$g.createByConstant=function(p$h){var p$q=new p$g;return p$q._type=0,p$q._constant=p$h,p$q},p$g.createByGradient=function(p$h){var p$q=new p$g;return p$q._type=1,p$q._gradient=p$h,p$q},p$g.createByRandomTwoConstant=function(p$h,p$q){var p$f=new p$g;return p$f._type=2,p$f._constantMin=p$h,p$f._constantMax=p$q,p$f},p$g.createByRandomTwoGradient=function(p$h,p$q){var p$f=new p$g;return p$f._type=3,p$f._gradientMin=p$h,p$f._gradientMax=p$q,p$f},p$g}(),p$T=(function(){function p$h(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}p$v(p$h,"laya.d3.core.particleShuriKen.module.GradientDataColor");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.addAlpha=function(p$h,p$q){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==p$h&&(p$h=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=p$h,this._alphaElements[this._alphaCurrentLength++]=p$q):DEBUG},p$q.addRGB=function(p$h,p$q){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==p$h&&(p$h=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=p$h,this._rgbElements[this._rgbCurrentLength++]=p$q.x,this._rgbElements[this._rgbCurrentLength++]=p$q.y,this._rgbElements[this._rgbCurrentLength++]=p$q.z):DEBUG},p$q.cloneTo=function(p$h){var p$q=p$h,p$f=0,p$g=0;p$q._alphaCurrentLength=this._alphaCurrentLength;var p$$=p$q._alphaElements;for(p$$.length=this._alphaElements.length,p$f=0,p$g=this._alphaElements.length;p$f<p$g;p$f++)p$$[p$f]=this._alphaElements[p$f];p$q._rgbCurrentLength=this._rgbCurrentLength;var p$P=p$q._rgbElements;for(p$P.length=this._rgbElements.length,p$f=0,p$g=this._rgbElements.length;p$f<p$g;p$f++)p$P[p$f]=this._rgbElements[p$f]},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),p$L(0,p$q,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function p$h(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}p$v(p$h,"laya.d3.core.particleShuriKen.module.GradientDataInt");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.add=function(p$h,p$q){this._currentLength<8?(6===this._currentLength&&1!==p$h&&(p$h=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=p$h,this._elements[this._currentLength++]=p$q):console.log("Warning:data count must lessEqual than 4")},p$q.cloneTo=function(p$h){var p$q=p$h;p$q._currentLength=this._currentLength;var p$f=p$q._elements;p$f.length=this._elements.length;for(var p$g=0,p$$=this._elements.length;p$g<p$$;p$g++)p$f[p$g]=this._elements[p$g]},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"gradientCount",function(){return this._currentLength/2})}(),function(){function p$h(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}p$v(p$h,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.add=function(p$h,p$q){this._currentLength<8?(6===this._currentLength&&1!==p$h&&(p$h=1,DEBUG),this._elements[this._currentLength++]=p$h,this._elements[this._currentLength++]=p$q):DEBUG},p$q.getKeyByIndex=function(p$h){return this._elements[2*p$h]},p$q.getValueByIndex=function(p$h){return this._elements[2*p$h+1]},p$q.getAverageValue=function(){for(var p$h=0,p$q=this._currentLength-2;p$h<p$q;p$h+=2){this._elements[p$h+1];this._elements[p$h+3],this._elements[p$h+2]-this._elements[p$h]}return 0},p$q.cloneTo=function(p$h){var p$q=p$h;p$q._currentLength=this._currentLength;var p$f=p$q._elements;p$f.length=this._elements.length;for(var p$g=0,p$$=this._elements.length;p$g<p$$;p$g++)p$f[p$g]=this._elements[p$g]},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"gradientCount",function(){return this._currentLength/2})}(),function(){function p$h(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}p$v(p$h,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.add=function(p$h,p$q){this._currentLength<8?(6===this._currentLength&&1!==p$h&&(p$h=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=p$h,this._elements[this._currentLength++]=p$q.x,this._elements[this._currentLength++]=p$q.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},p$q.cloneTo=function(p$h){var p$q=p$h;p$q._currentLength=this._currentLength;var p$f=p$q._elements;p$f.length=this._elements.length;for(var p$g=0,p$$=this._elements.length;p$g<p$$;p$g++)p$f[p$g]=this._elements[p$g]},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"gradientCount",function(){return this._currentLength/3})}(),function(){function p$B(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}p$v(p$B,"laya.d3.core.particleShuriKen.module.GradientSize");var p$h=p$B.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.getMaxSizeInGradient=function(){var p$h=0,p$q=0,p$f=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(p$h=0,p$q=this._gradientX.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientX.getValueByIndex(p$h));for(p$h=0,p$q=this._gradientY.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientY.getValueByIndex(p$h))}else for(p$h=0,p$q=this._gradient.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradient.getValueByIndex(p$h));break;case 1:p$f=this._separateAxes?(p$f=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),p$f=Math.max(p$f,this._constantMinSeparate.y),Math.max(p$f,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(p$h=0,p$q=this._gradientXMin.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientXMin.getValueByIndex(p$h));for(p$h=0,p$q=this._gradientXMax.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientXMax.getValueByIndex(p$h));for(p$h=0,p$q=this._gradientYMin.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientYMin.getValueByIndex(p$h));for(p$h=0,p$q=this._gradientZMax.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientZMax.getValueByIndex(p$h))}else{for(p$h=0,p$q=this._gradientMin.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientMin.getValueByIndex(p$h));for(p$h=0,p$q=this._gradientMax.gradientCount;p$h<p$q;p$h++)p$f=Math.max(p$f,this._gradientMax.getValueByIndex(p$h))}}return p$f},p$h.cloneTo=function(p$h){var p$q=p$h;p$q._type=this._type,p$q._separateAxes=this._separateAxes,this._gradient.cloneTo(p$q._gradient),this._gradientX.cloneTo(p$q._gradientX),this._gradientY.cloneTo(p$q._gradientY),this._gradientZ.cloneTo(p$q._gradientZ),p$q._constantMin=this._constantMin,p$q._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(p$q._constantMinSeparate),this._constantMaxSeparate.cloneTo(p$q._constantMaxSeparate),this._gradientMin.cloneTo(p$q._gradientMin),this._gradientMax.cloneTo(p$q._gradientMax),this._gradientXMin.cloneTo(p$q._gradientXMin),this._gradientXMax.cloneTo(p$q._gradientXMax),this._gradientYMin.cloneTo(p$q._gradientYMin),this._gradientYMax.cloneTo(p$q._gradientYMax),this._gradientZMin.cloneTo(p$q._gradientZMin),this._gradientZMax.cloneTo(p$q._gradientZMax)},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$h,"gradientZ",function(){return this._gradientZ}),p$L(0,p$h,"gradient",function(){return this._gradient}),p$L(0,p$h,"separateAxes",function(){return this._separateAxes}),p$L(0,p$h,"type",function(){return this._type}),p$L(0,p$h,"gradientMin",function(){return this._gradientMin}),p$L(0,p$h,"constantMin",function(){return this._constantMin}),p$L(0,p$h,"gradientX",function(){return this._gradientX}),p$L(0,p$h,"gradientY",function(){return this._gradientY}),p$L(0,p$h,"gradientMax",function(){return this._gradientMax}),p$L(0,p$h,"constantMax",function(){return this._constantMax}),p$L(0,p$h,"constantMinSeparate",function(){return this._constantMinSeparate}),p$L(0,p$h,"constantMaxSeparate",function(){return this._constantMaxSeparate}),p$L(0,p$h,"gradientXMin",function(){return this._gradientXMin}),p$L(0,p$h,"gradientXMax",function(){return this._gradientXMax}),p$L(0,p$h,"gradientYMin",function(){return this._gradientYMin}),p$L(0,p$h,"gradientYMax",function(){return this._gradientYMax}),p$L(0,p$h,"gradientZMin",function(){return this._gradientZMin}),p$L(0,p$h,"gradientZMax",function(){return this._gradientZMax}),p$B.createByGradient=function(p$h){var p$q=new p$B;return p$q._type=0,p$q._separateAxes=!1,p$q._gradient=p$h,p$q},p$B.createByGradientSeparate=function(p$h,p$q,p$f){var p$g=new p$B;return p$g._type=0,p$g._separateAxes=!0,p$g._gradientX=p$h,p$g._gradientY=p$q,p$g._gradientZ=p$f,p$g},p$B.createByRandomTwoConstant=function(p$h,p$q){var p$f=new p$B;return p$f._type=1,p$f._separateAxes=!1,p$f._constantMin=p$h,p$f._constantMax=p$q,p$f},p$B.createByRandomTwoConstantSeparate=function(p$h,p$q){var p$f=new p$B;return p$f._type=1,p$f._separateAxes=!0,p$f._constantMinSeparate=p$h,p$f._constantMaxSeparate=p$q,p$f},p$B.createByRandomTwoGradient=function(p$h,p$q){var p$f=new p$B;return p$f._type=2,p$f._separateAxes=!1,p$f._gradientMin=p$h,p$f._gradientMax=p$q,p$f},p$B.createByRandomTwoGradientSeparate=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=new p$B;return p$S._type=2,p$S._separateAxes=!0,p$S._gradientXMin=p$h,p$S._gradientXMax=p$q,p$S._gradientYMin=p$f,p$S._gradientYMax=p$g,p$S._gradientZMin=p$$,p$S._gradientZMax=p$P,p$S},p$B}()),p$I=function(){function p$B(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}p$v(p$B,"laya.d3.core.particleShuriKen.module.GradientVelocity");var p$h=p$B.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.cloneTo=function(p$h){var p$q=p$h;p$q._type=this._type,this._constant.cloneTo(p$q._constant),this._gradientX.cloneTo(p$q._gradientX),this._gradientY.cloneTo(p$q._gradientY),this._gradientZ.cloneTo(p$q._gradientZ),this._constantMin.cloneTo(p$q._constantMin),this._constantMax.cloneTo(p$q._constantMax),this._gradientXMin.cloneTo(p$q._gradientXMin),this._gradientXMax.cloneTo(p$q._gradientXMax),this._gradientYMin.cloneTo(p$q._gradientYMin),this._gradientYMax.cloneTo(p$q._gradientYMax),this._gradientZMin.cloneTo(p$q._gradientZMin),this._gradientZMax.cloneTo(p$q._gradientZMax)},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$h,"gradientZ",function(){return this._gradientZ}),p$L(0,p$h,"constant",function(){return this._constant}),p$L(0,p$h,"type",function(){return this._type}),p$L(0,p$h,"gradientXMax",function(){return this._gradientXMax}),p$L(0,p$h,"constantMin",function(){return this._constantMin}),p$L(0,p$h,"gradientX",function(){return this._gradientX}),p$L(0,p$h,"gradientY",function(){return this._gradientY}),p$L(0,p$h,"gradientXMin",function(){return this._gradientXMin}),p$L(0,p$h,"constantMax",function(){return this._constantMax}),p$L(0,p$h,"gradientYMin",function(){return this._gradientYMin}),p$L(0,p$h,"gradientYMax",function(){return this._gradientYMax}),p$L(0,p$h,"gradientZMin",function(){return this._gradientZMin}),p$L(0,p$h,"gradientZMax",function(){return this._gradientZMax}),p$B.createByConstant=function(p$h){var p$q=new p$B;return p$q._type=0,p$q._constant=p$h,p$q},p$B.createByGradient=function(p$h,p$q,p$f){var p$g=new p$B;return p$g._type=1,p$g._gradientX=p$h,p$g._gradientY=p$q,p$g._gradientZ=p$f,p$g},p$B.createByRandomTwoConstant=function(p$h,p$q){var p$f=new p$B;return p$f._type=2,p$f._constantMin=p$h,p$f._constantMax=p$q,p$f},p$B.createByRandomTwoGradient=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=new p$B;return p$S._type=3,p$S._gradientXMin=p$h,p$S._gradientXMax=p$q,p$S._gradientYMin=p$f,p$S._gradientYMax=p$g,p$S._gradientZMin=p$$,p$S._gradientZMax=p$P,p$S},p$B}(),p$w=(function(){function p$h(p$h){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=p$h}p$v(p$h,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.cloneTo=function(p$h){var p$q=p$h;this._angularVelocity.cloneTo(p$q._angularVelocity),p$q.enbale=this.enbale},p$q.clone=function(){var p$h;switch(this._angularVelocity.type){case 0:p$h=this._angularVelocity.separateAxes?p$M.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):p$M.createByConstant(this._angularVelocity.constant);break;case 1:p$h=this._angularVelocity.separateAxes?p$M.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):p$M.createByGradient(this._angularVelocity.gradient.clone());break;case 2:p$h=this._angularVelocity.separateAxes?p$M.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):p$M.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:p$h=this._angularVelocity.separateAxes?p$M.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):p$M.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var p$q=new this.constructor(p$h);return p$q.enbale=this.enbale,p$q},p$L(0,p$q,"angularVelocity",function(){return this._angularVelocity})}(),function(){function p$h(){this.enable=!1,this.randomDirection=!1}p$v(p$h,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q._getShapeBoundBox=function(p$h){throw new Error("BaseShape: must override it.")},p$q._getSpeedBoundBox=function(p$h){throw new Error("BaseShape: must override it.")},p$q.generatePositionAndDirection=function(p$h,p$q,p$f,p$g){throw new Error("BaseShape: must override it.")},p$q._calculateProceduralBounds=function(p$h,p$q,p$f){this._getShapeBoundBox(p$h);var p$g=p$h.min,p$$=p$h.max;p$Sq.multiply(p$g,p$q,p$g),p$Sq.multiply(p$$,p$q,p$$);var p$P=new p$oh(new p$Sq,new p$Sq);this.randomDirection?(p$P.min=new p$Sq(-1,-1,-1),p$P.max=new p$Sq(1,1,1)):this._getSpeedBoundBox(p$P);var p$S=new p$oh(new p$Sq,new p$Sq),p$B=p$S.min,p$r=p$S.max;p$Sq.scale(p$P.min,p$f.y,p$B),p$Sq.scale(p$P.max,p$f.y,p$r),p$Sq.add(p$h.min,p$B,p$B),p$Sq.add(p$h.max,p$r,p$r),p$Sq.min(p$h.min,p$B,p$h.min),p$Sq.max(p$h.max,p$B,p$h.max);var p$Y=new p$oh(new p$Sq,new p$Sq),p$C=p$Y.min,p$U=p$Y.max;p$Sq.scale(p$P.min,p$f.x,p$C),p$Sq.scale(p$P.max,p$f.x,p$U),p$Sq.min(p$Y.min,p$U,p$B),p$Sq.max(p$Y.min,p$U,p$r),p$Sq.min(p$h.min,p$B,p$h.min),p$Sq.max(p$h.max,p$B,p$h.max)},p$q.cloneTo=function(p$h){p$h.enable=this.enable},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$h}()),p$V=function(){function p$P(){}return p$v(p$P,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),p$P._randomPointUnitArcCircle=function(p$h,p$q,p$f){var p$g=p$q.elements,p$$=NaN;p$$=p$f?p$f.getFloat()*p$h:Math.random()*p$h,p$g[0]=Math.cos(p$$),p$g[1]=Math.sin(p$$)},p$P._randomPointInsideUnitArcCircle=function(p$h,p$q,p$f){var p$g=p$q.elements;p$P._randomPointUnitArcCircle(p$h,p$q,p$f);var p$$=NaN;p$$=p$f?Math.pow(p$f.getFloat(),.5):Math.pow(Math.random(),.5),p$g[0]=p$g[0]*p$$,p$g[1]=p$g[1]*p$$},p$P._randomPointUnitCircle=function(p$h,p$q){var p$f=p$h.elements,p$g=NaN;p$g=p$q?p$q.getFloat()*Math.PI*2:Math.random()*Math.PI*2,p$f[0]=Math.cos(p$g),p$f[1]=Math.sin(p$g)},p$P._randomPointInsideUnitCircle=function(p$h,p$q){var p$f=p$h.elements;p$P._randomPointUnitCircle(p$h);var p$g=NaN;p$g=p$q?Math.pow(p$q.getFloat(),.5):Math.pow(Math.random(),.5),p$f[0]=p$f[0]*p$g,p$f[1]=p$f[1]*p$g},p$P._randomPointUnitSphere=function(p$h,p$q){var p$f=p$h.elements,p$g=NaN,p$$=NaN;p$$=p$q?(p$g=p$f[2]=2*p$q.getFloat()-1,p$q.getFloat()*Math.PI*2):(p$g=p$f[2]=2*Math.random()-1,Math.random()*Math.PI*2);var p$P=Math.sqrt(1-p$g*p$g);p$f[0]=p$P*Math.cos(p$$),p$f[1]=p$P*Math.sin(p$$)},p$P._randomPointInsideUnitSphere=function(p$h,p$q){var p$f=p$h.elements;p$P._randomPointUnitSphere(p$h);var p$g=NaN;p$g=p$q?Math.pow(p$q.getFloat(),1/3):Math.pow(Math.random(),1/3),p$f[0]=p$f[0]*p$g,p$f[1]=p$f[1]*p$g,p$f[2]=p$f[2]*p$g},p$P._randomPointInsideHalfUnitBox=function(p$h,p$q){var p$f=p$h.elements;p$q?(p$f[0]=p$q.getFloat()-.5,p$f[1]=p$q.getFloat()-.5,p$f[2]=p$q.getFloat()-.5):(p$f[0]=Math.random()-.5,p$f[1]=Math.random()-.5,p$f[2]=Math.random()-.5)},p$P}(),p$K=(function(){function p$h(p$h){this._size=null,this.enbale=!1,this._size=p$h}p$v(p$h,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.cloneTo=function(p$h){var p$q=p$h;this._size.cloneTo(p$q._size),p$q.enbale=this.enbale},p$q.clone=function(){var p$h;switch(this._size.type){case 0:p$h=this._size.separateAxes?p$T.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):p$T.createByGradient(this._size.gradient.clone());break;case 1:p$h=this._size.separateAxes?p$T.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):p$T.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:p$h=this._size.separateAxes?p$T.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):p$T.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var p$q=new this.constructor(p$h);return p$q.enbale=this.enbale,p$q},p$L(0,p$q,"size",function(){return this._size})}(),function(){function p$g(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}p$v(p$g,"laya.d3.core.particleShuriKen.module.StartFrame");var p$h=p$g.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.cloneTo=function(p$h){var p$q=p$h;p$q._type=this._type,p$q._constant=this._constant,p$q._constantMin=this._constantMin,p$q._constantMax=this._constantMax},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$h,"constant",function(){return this._constant}),p$L(0,p$h,"type",function(){return this._type}),p$L(0,p$h,"constantMin",function(){return this._constantMin}),p$L(0,p$h,"constantMax",function(){return this._constantMax}),p$g.createByConstant=function(p$h){var p$q=new p$g;return p$q._type=0,p$q._constant=p$h,p$q},p$g.createByRandomTwoConstant=function(p$h,p$q){var p$f=new p$g;return p$f._type=1,p$f._constantMin=p$h,p$f._constantMax=p$q,p$f},p$g}()),p$y=(function(){function p$h(p$h,p$q){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new p$Pq(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=p$h,this._startFrame=p$q}p$v(p$h,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.cloneTo=function(p$h){var p$q=p$h;this.tiles.cloneTo(p$q.tiles),p$q.type=this.type,p$q.randomRow=this.randomRow,this._frame.cloneTo(p$q._frame),this._startFrame.cloneTo(p$q._startFrame),p$q.cycles=this.cycles,p$q.enableUVChannels=this.enableUVChannels,p$q.enable=this.enable},p$q.clone=function(){var p$h,p$q;switch(this._frame.type){case 0:p$h=p$c.createByConstant(this._frame.constant);break;case 1:p$h=p$c.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:p$h=p$c.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:p$h=p$c.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:p$q=p$K.createByConstant(this._startFrame.constant);break;case 1:p$q=p$K.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var p$f=new this.constructor(p$h,p$q);return this.tiles.cloneTo(p$f.tiles),p$f.type=this.type,p$f.randomRow=this.randomRow,p$f.cycles=this.cycles,p$f.enableUVChannels=this.enableUVChannels,p$f.enable=this.enable,p$f},p$L(0,p$q,"frame",function(){return this._frame}),p$L(0,p$q,"startFrame",function(){return this._startFrame})}(),function(){function p$h(p$h){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=p$h}p$v(p$h,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.cloneTo=function(p$h){var p$q=p$h;this._velocity.cloneTo(p$q._velocity),p$q.enbale=this.enbale,p$q.space=this.space},p$q.clone=function(){var p$h;switch(this._velocity.type){case 0:p$h=p$I.createByConstant(this._velocity.constant.clone());break;case 1:p$h=p$I.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:p$h=p$I.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:p$h=p$I.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var p$q=new this.constructor(p$h);return p$q.enbale=this.enbale,p$q.space=this.space,p$q},p$L(0,p$q,"velocity",function(){return this._velocity})}(),function(){function p$h(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new p$uq,this._vb=p$wq.create(p$h._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=p$Iq.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=p$Wq.nameKey.getID("LINE"),this._shaderCompile=p$Xq._preCompileShader[this._sharderNameID]}p$v(p$h,"laya.d3.core.PhasorSpriter3D");var p$q=p$h.prototype;return p$q.line=function(p$h,p$q,p$f,p$g){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(p$h.x,p$h.y,p$h.z,p$q.x,p$q.y,p$q.z,p$q.w),this.addVertex(p$f.x,p$f.y,p$f.z,p$g.x,p$g.y,p$g.z,p$g.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},p$q.circle=function(p$h,p$q,p$f,p$g,p$$,p$P){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*p$q,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/p$q,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*p$h,Math.cos(this._tempNumver0)*p$h,0,p$f,p$g,p$$,p$P),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},p$q.plane=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=p$g/2,this._tempNumver1=p$$/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(p$h-this._tempNumver0,p$q+this._tempNumver1,p$f,p$P,p$S,p$B,p$r),this.addVertex(p$h+this._tempNumver0,p$q+this._tempNumver1,p$f,p$P,p$S,p$B,p$r),this.addVertex(p$h-this._tempNumver0,p$q-this._tempNumver1,p$f,p$P,p$S,p$B,p$r),this.addVertex(p$h+this._tempNumver0,p$q-this._tempNumver1,p$f,p$P,p$S,p$B,p$r),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},p$q.box=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=p$g/2,this._tempNumver1=p$$/2,this._tempNumver2=p$P/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(p$h-this._tempNumver0,p$q+this._tempNumver1,p$f+this._tempNumver2,p$S,p$B,p$r,p$Y),this.addVertex(p$h+this._tempNumver0,p$q+this._tempNumver1,p$f+this._tempNumver2,p$S,p$B,p$r,p$Y),this.addVertex(p$h-this._tempNumver0,p$q-this._tempNumver1,p$f+this._tempNumver2,p$S,p$B,p$r,p$Y),this.addVertex(p$h+this._tempNumver0,p$q-this._tempNumver1,p$f+this._tempNumver2,p$S,p$B,p$r,p$Y),this.addVertex(p$h+this._tempNumver0,p$q+this._tempNumver1,p$f-this._tempNumver2,p$S,p$B,p$r,p$Y),this.addVertex(p$h-this._tempNumver0,p$q+this._tempNumver1,p$f-this._tempNumver2,p$S,p$B,p$r,p$Y),this.addVertex(p$h+this._tempNumver0,p$q-this._tempNumver1,p$f-this._tempNumver2,p$S,p$B,p$r,p$Y),this.addVertex(p$h-this._tempNumver0,p$q-this._tempNumver1,p$f-this._tempNumver2,p$S,p$B,p$r,p$Y),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},p$q.cone=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*p$f+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*p$f>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/p$f,this.addVertexIndex(0,p$q,0,p$g,p$$,p$P,p$S,this._tempUint0),this.addVertexIndex(0,0,0,p$g,p$$,p$P,p$S,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<p$f;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(p$h*this._tempNumver2,0,p$h*this._tempNumver3,p$g,p$$,p$P,p$S,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==p$f-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(p$h*this._tempNumver2,0,p$h*this._tempNumver3,p$g,p$$,p$P,p$S,this._tempUint0+(this._tempInt0+p$f)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==p$f-1?this.addIndexes(this._tempUint1+p$f+2):this.addIndexes(this._tempUint1+this._tempInt0+p$f+1),this.addIndexes(this._tempUint1+this._tempInt0+p$f),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},p$q.boundingBoxLine=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(p$h,p$$,p$P,p$S,p$B,p$r,p$Y),this.addVertex(p$g,p$$,p$P,p$S,p$B,p$r,p$Y),this.addVertex(p$h,p$q,p$P,p$S,p$B,p$r,p$Y),this.addVertex(p$g,p$q,p$P,p$S,p$B,p$r,p$Y),this.addVertex(p$g,p$$,p$f,p$S,p$B,p$r,p$Y),this.addVertex(p$h,p$$,p$f,p$S,p$B,p$r,p$Y),this.addVertex(p$g,p$q,p$f,p$S,p$B,p$r,p$Y),this.addVertex(p$h,p$q,p$f,p$S,p$B,p$r,p$Y),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},p$q.addVertex=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=p$h,this._vbData[this._posInVBData+1]=p$q,this._vbData[this._posInVBData+2]=p$f,this._vbData[this._posInVBData+3]=p$g,this._vbData[this._posInVBData+4]=p$$,this._vbData[this._posInVBData+5]=p$P,this._vbData[this._posInVBData+6]=p$S,this._posInVBData+=this._floatSizePerVer,this},p$q.addVertexIndex=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){return this._hasBegun||this.addVertexIndexException(),this._vbData[p$B]=p$h,this._vbData[p$B+1]=p$q,this._vbData[p$B+2]=p$f,this._vbData[p$B+3]=p$g,this._vbData[p$B+4]=p$$,this._vbData[p$B+5]=p$P,this._vbData[p$B+6]=p$S,(p$B+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=p$B),this},p$q.addIndexes=function(p$h){var p$q=arguments;this._hasBegun||this.addVertexIndexException();for(var p$f=0;p$f<p$q.length;p$f++)this._ibData[this._posInIBData]=p$q[p$f],this._posInIBData++;return this},p$q.begin=function(p$h,p$q){return this._hasBegun&&this.beginException0(),1!==p$h&&4!==p$h&&this.beginException1(),this._primitiveType=p$h,this._camera=p$q,this._hasBegun=!0,this},p$q.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},p$q.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(p$h._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),p$X.drawCall++,p$d.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},p$q.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},p$q.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},p$q.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},p$q.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},p$q.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},p$q.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(28,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector4",1)])}]),p$h}()),p$F=function(){function p$h(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++p$h._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new p$uq}p$v(p$h,"laya.d3.core.render.RenderElement");var p$q=p$h.prototype;return p$q.getDynamicBatchBakedVertexs=function(p$h){for(var p$q=this._renderObj._getVertexBuffer(p$h),p$f=p$q.getData().slice(),p$g=p$q.vertexDeclaration,p$$=p$g.getVertexElementByUsage(0).offset/4,p$P=p$g.getVertexElementByUsage(3).offset/4,p$S=this._sprite3D.transform,p$B=p$S.worldMatrix,p$r=p$S.rotation,p$Y=p$g.vertexStride/4,p$C=0,p$U=p$f.length;p$C<p$U;p$C+=p$Y){var p$u=p$C+p$$,p$v=p$C+p$P;p$lq.transformVector3ArrayToVector3ArrayCoordinate(p$f,p$u,p$B,p$f,p$u),p$lq.transformVector3ArrayByQuat(p$f,p$v,p$r,p$f,p$v)}return p$f},p$q.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},p$q._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},p$L(0,p$q,"id",function(){return this._id}),p$L(0,p$q,"renderObj",function(){return this._renderObj},function(p$h){this._renderObj!==p$h&&(this._renderObj=p$h)}),p$h._uniqueIDCounter=0,p$h}(),p$Z=function(){function p$q(p$h){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++p$q._uniqueIDCounter,this._needSort=!1,this._scene=p$h,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}p$v(p$q,"laya.d3.core.render.RenderQueue");var p$h=p$q.prototype;return p$h._sortOpaqueFunc=function(p$h,p$q){if(p$h._render&&p$q._render){var p$f=p$h._material.renderQueue-p$q._material.renderQueue;return 0==p$f?p$h._render._distanceForSort-p$q._render._distanceForSort:p$f}return 0},p$h._sortAlphaFunc=function(p$h,p$q){if(p$h._render&&p$q._render){var p$f=p$h._material.renderQueue-p$q._material.renderQueue;return 0==p$f?p$q._render._distanceForSort-p$h._render._distanceForSort:p$f}return 0},p$h._begainRenderElement=function(p$h,p$q,p$f){return!!p$q._beforeRender(p$h)},p$h._sortAlpha=function(p$h){p$q._cameraPosition=p$h,this._finalElements.sort(this._sortAlphaFunc)},p$h._sortOpaque=function(p$h){p$q._cameraPosition=p$h,this._finalElements.sort(this._sortOpaqueFunc)},p$h._preRender=function(p$h){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},p$h._render=function(p$h,p$q){for(var p$f,p$g,p$$,p$P,p$S,p$B,p$r=p$X.loopCount,p$Y=this._scene,p$C=p$h.camera,p$U=(p$C.id,!1),p$u=0,p$v=this._finalElements.length;p$u<p$v;p$u++){var p$L,p$e,p$l,p$_=this._finalElements[p$u];if(null!=p$_._onPreRenderFunction&&p$_._onPreRenderFunction.call(p$_._sprite3D,p$h),0===p$_._type){if(p$h.owner=p$l=p$_._sprite3D,p$h.renderElement=p$_,p$l._preRenderUpdateComponents(p$h),p$L=p$_.renderObj,p$e=p$_._material,this._begainRenderElement(p$h,p$L,p$e)){if(p$f=p$L._getVertexBuffers(),!(p$$=(p$g=p$L._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[p$g.id]){this._errorRecord[p$g.id]=1;var p$N="vertexBuffer:"+("("+p$g._destroyed+","+p$g._released+","+p$g._referenceCount+","+p$g._buffer+")")+", material:"+(p$e?p$e.__className+"("+p$e._destroyed+","+p$e._released+")":"null")+", owner:"+(p$l?p$l.__className+"("+p$l._destroyed+","+p$l._activeInHierarchy+","+p$l._displayedInStage+")":"null")+", renderObj:"+(p$L?p$L.__className+"("+p$L._destroyed+","+p$L._released+","+p$L._referenceCount+")":"")+", parent:, url:"+(p$l?p$l.url:"")+", disposeStack:"+p$g.disposeStack;p$E.recordError("报错：unknown vertexDeclaration  "+p$N)}continue}if(p$U=(p$P=p$h._shader=p$e._getShader(p$Y._shaderDefineValue,p$$.shaderDefineValue,p$l._shaderDefineValue)).bind()||p$r!==p$P._uploadLoopCount,p$f){if(p$P._uploadVertexBuffer!==p$f||p$U){for(var p$G=0;p$G<p$f.length;p$G++){var p$m=p$f[p$G];p$P.uploadAttributesX(p$m.vertexDeclaration.shaderValues.data,p$m)}p$P._uploadVertexBuffer=p$f}}else(p$P._uploadVertexBuffer!==p$g||p$U)&&(p$P.uploadAttributes(p$$.shaderValues.data,null),p$P._uploadVertexBuffer=p$g);(p$P._uploadScene!==p$Y||p$U)&&(p$P.uploadSceneUniforms(p$Y._shaderValues.data),p$P._uploadScene=p$Y),(p$C!==p$P._uploadCamera||p$P._uploadSprite3D!==p$l||p$U)&&(p$P.uploadSpriteUniforms(p$l._shaderValues.data),p$P._uploadSprite3D=p$l),(p$C!==p$P._uploadCamera||p$U)&&(p$P.uploadCameraUniforms(p$C._shaderValues.data),p$P._uploadCamera=p$C),(p$P._uploadMaterial!==p$e||p$U)&&(p$e._upload(),p$P._uploadMaterial=p$e),p$S!==p$e?(p$e._setRenderStateBlendDepth(),p$e._setRenderStateFrontFace(p$q,p$l.transform),p$S=p$e,p$B=p$l):p$B!==p$l&&(p$e._setRenderStateFrontFace(p$q,p$l.transform),p$B=p$l),p$L._render(p$h),p$P._uploadLoopCount=p$r}p$l._postRenderUpdateComponents(p$h)}else if(2===p$_._type){p$_.renderObj;p$h.owner=p$l=p$_._sprite3D,p$h.renderElement=p$_,p$h._batchIndexStart=p$_._tempBatchIndexStart,p$h._batchIndexEnd=p$_._tempBatchIndexEnd,p$L=p$_.renderObj,p$e=p$_._material,this._begainRenderElement(p$h,p$L,p$e)&&(p$$=(p$g=p$L._getVertexBuffer(0)).vertexDeclaration,p$U=(p$P=p$h._shader=p$e._getShader(p$Y._shaderDefineValue,p$$.shaderDefineValue,p$l._shaderDefineValue)).bind()||p$r!==p$P._uploadLoopCount,(p$P._uploadVertexBuffer!==p$g||p$U)&&(p$P.uploadAttributes(p$$.shaderValues.data,null),p$P._uploadVertexBuffer=p$g),(p$P._uploadScene!==p$Y||p$U)&&(p$P.uploadSceneUniforms(p$Y._shaderValues.data),p$P._uploadScene=p$Y),(p$C!==p$P._uploadCamera||p$P._uploadSprite3D!==p$l||p$U)&&(p$P.uploadSpriteUniforms(p$l._shaderValues.data),p$P._uploadSprite3D=p$l),(p$C!==p$P._uploadCamera||p$U)&&(p$P.uploadCameraUniforms(p$C._shaderValues.data),p$P._uploadCamera=p$C),(p$P._uploadMaterial!==p$e||p$U)&&(p$e._upload(),p$P._uploadMaterial=p$e),p$S!==p$e?(p$e._setRenderStateBlendDepth(),p$e._setRenderStateFrontFace(p$q,p$l.transform),p$S=p$e,p$B=p$l):p$B!==p$l&&(p$e._setRenderStateFrontFace(p$q,p$l.transform),p$B=p$l),p$L._render(p$h),p$P._uploadLoopCount=p$r)}}},p$h._renderShadow=function(p$h,p$q){for(var p$f,p$g,p$$,p$P,p$S,p$B=p$X.loopCount,p$r=this._scene,p$Y=p$h.camera,p$C=!1,p$U=0,p$u=this._finalElements.length;p$U<p$u;p$U++){var p$v,p$L,p$e,p$l=this._finalElements[p$U];0===p$l._type&&(p$h.owner=p$e=p$l._sprite3D,p$q||p$e._projectionViewWorldUpdateCamera===p$Y&&p$e._projectionViewWorldUpdateLoopCount===p$X.loopCount||(p$e._render._renderUpdate(p$h._projectionViewMatrix),p$e._projectionViewWorldUpdateLoopCount=p$X.loopCount,p$e._projectionViewWorldUpdateCamera=p$Y),p$h.renderElement=p$l,p$e._preRenderUpdateComponents(p$h),p$v=p$l.renderObj,p$L=p$l._material,this._begainRenderElement(p$h,p$v,null)&&(p$g=(p$f=p$v._getVertexBuffer(0)).vertexDeclaration,p$C=(p$$=p$h._shader=p$L._getShader(p$r._shaderDefineValue,p$g.shaderDefineValue,p$e._shaderDefineValue)).bind()||p$B!==p$$._uploadLoopCount,(p$$._uploadVertexBuffer!==p$f||p$C)&&(p$$.uploadAttributes(p$g.shaderValues.data,null),p$$._uploadVertexBuffer=p$f),(p$Y!==p$$._uploadCamera||p$$._uploadSprite3D!==p$e||p$C)&&(p$$.uploadSpriteUniforms(p$e._shaderValues.data),p$$._uploadSprite3D=p$e),(p$Y!==p$$._uploadCamera||p$C)&&(p$$.uploadCameraUniforms(p$Y._shaderValues.data),p$$._uploadCamera=p$Y),(p$$._uploadMaterial!==p$L||p$C)&&(p$L._upload(),p$$._uploadMaterial=p$L),p$$._uploadRenderElement,p$P!==p$L?(p$L._setRenderStateFrontFace(!1,p$e.transform),p$P=p$L,p$S=p$e):p$S!==p$e&&(p$L._setRenderStateFrontFace(!1,p$e.transform),p$S=p$e),p$v._render(p$h),p$$._uploadLoopCount=p$B),p$e._postRenderUpdateComponents(p$h))}},p$h._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},p$h._addRenderElement=function(p$h){this._renderElements.push(p$h),this._needSort=!0},p$h._addDynamicBatchElement=function(p$h){this._dynamicBatchCombineRenderElements.push(p$h)},p$L(0,p$h,"id",function(){return this._id}),p$q._uniqueIDCounter=0,p$q._cameraPosition=null,p$q}(),p$Q=function(){function p$h(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return p$v(p$h,"laya.d3.core.render.RenderState"),p$h.clientWidth=0,p$h.clientHeight=0,p$h}(),p$o=function(){function p$S(p$h,p$q){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new p$jh(new p$Sq,0),this._corners=[new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq],this._boundingBoxCenter=new p$Sq,this._children=p$g(8),this._objects=[],this._tempBoundBoxCorners=[new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq],this._scene=p$h,this._currentDepth=p$q}p$v(p$S,"laya.d3.core.scene.OctreeNode");var p$h=p$S.prototype;return p$E.imps(p$h,{"laya.d3.core.scene.ITreeNode":!0}),p$h.init=function(p$h,p$q){var p$f=new p$Sq,p$g=new p$Sq;p$Sq.scale(p$q,-.5,p$f),p$Sq.scale(p$q,.5,p$g),p$Sq.add(p$f,p$h,p$f),p$Sq.add(p$g,p$h,p$g),this.exactBox=new p$oh(p$f,p$g),this.relaxBox=new p$oh(p$f,p$g)},p$h.addTreeNode=function(p$h){1===Collision.boxContainsBox(this._relaxBox,p$h.boundingBox)?this.addNodeDown(p$h,0):this.addObject(p$h)},p$h.addChild=function(p$h){var p$q=this._children[p$h];if(null==p$q){p$q=new p$S(this._scene,this._currentDepth+1),(this._children[p$h]=p$q)._parent=this,p$Sq.subtract(this._exactBox.max,this._exactBox.min,p$S.tempSize),p$Sq.multiply(p$S.tempSize,p$S._octreeSplit[p$h],p$S.tempCenter),p$Sq.add(this._exactBox.min,p$S.tempCenter,p$S.tempCenter),p$Sq.scale(p$S.tempSize,.25,p$S.tempSize);var p$f=new p$Sq,p$g=new p$Sq;p$Sq.subtract(p$S.tempCenter,p$S.tempSize,p$f),p$Sq.add(p$S.tempCenter,p$S.tempSize,p$g),p$q.exactBox=new p$oh(p$f,p$g),p$Sq.scale(p$S.tempSize,p$S.relax,p$S.tempSize);var p$$=new p$Sq,p$P=new p$Sq;p$Sq.subtract(p$S.tempCenter,p$S.tempSize,p$$),p$Sq.add(p$S.tempCenter,p$S.tempSize,p$P),p$q.relaxBox=new p$oh(p$$,p$P)}return p$q},p$h.addObject=function(p$h){(p$h._treeNode=this)._objects.push(p$h)},p$h.removeObject=function(p$h){if(p$h._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var p$q=this._objects.indexOf(p$h);return-1!==p$q&&(this._objects.splice(p$q,1),!0)},p$h.clearObject=function(){this._objects.length=0},p$h.addNodeUp=function(p$h,p$q){this._parent&&1!==Collision.boxContainsBox(this._exactBox,p$h.boundingBox)?this._parent.addNodeUp(p$h,p$q-1):this.addNodeDown(p$h,p$q)},p$h.addNodeDown=function(p$h,p$q){if(p$q<this._scene.treeLevel){var p$f=this.inChildIndex(p$h.boundingBoxCenter),p$g=this.addChild(p$f);1===Collision.boxContainsBox(p$g._relaxBox,p$h.boundingBox)?p$g.addNodeDown(p$h,++p$q):this.addObject(p$h)}else this.addObject(p$h)},p$h.inChildIndex=function(p$h){return 4*(p$h.z<this._boundingBoxCenter.z?0:1)+2*(p$h.y<this._boundingBoxCenter.y?0:1)+(p$h.x<this._boundingBoxCenter.x?0:1)},p$h.updateObject=function(p$h){1===Collision.boxContainsBox(this._relaxBox,p$h.boundingBox)?(this.removeObject(p$h),p$h._treeNode=null,this.addNodeDown(p$h,this._currentDepth)):this._parent&&(this.removeObject(p$h),p$h._treeNode=null,this._parent.addNodeUp(p$h,this._currentDepth-1))},p$h.cullingObjects=function(p$h,p$q,p$f,p$g,p$$){var p$P,p$S=0,p$B=0,p$r=0,p$Y=this._scene._dynamicBatchManager;for(p$S=0,p$P=this._objects.length;p$S<p$P;p$S++){var p$C=this._objects[p$S];if(p$z.isVisible(p$C._owner.layer.mask)&&p$C.enable){if(p$q&&(p$X.treeSpriteCollision+=1,0===p$h.containsBoundSphere(p$C.boundingSphere)))continue;p$C._renderUpdate(p$$),p$C._distanceForSort=p$Sq.distance(p$C.boundingSphere.center,p$g)+p$C.sortingFudge;var p$U=p$C._renderElements;for(p$B=0,p$r=p$U.length;p$B<p$r;p$B++){var p$u=p$U[p$B],p$v=p$u._staticBatch;if(p$v&&p$v._material===p$u._material)p$v._addBatchRenderElement(p$u);else{var p$L=p$u.renderObj;p$L.triangleCount<10&&1===p$L._vertexBufferCount&&p$L._getIndexBuffer()&&p$u._material.renderQueue<2&&p$u._canDynamicBatch&&!p$C._owner.isStatic?p$Y._addPrepareRenderElement(p$u):this._scene.getRenderQueue(p$u._material.renderQueue)._addRenderElement(p$u)}}}}for(p$S=0;p$S<8;p$S++){var p$e=this._children[p$S];if(null!=p$e){var p$l=p$q;if(p$q){var p$_=p$h.containsBoundBox(p$e._relaxBox);if(p$X.treeNodeCollision+=1,0===p$_)continue;p$l=2===p$_}p$e.cullingObjects(p$h,p$l,p$f,p$g,p$$)}}},p$h.cullingShadowObjects=function(p$h,p$q,p$f,p$g,p$$){var p$P,p$S=0,p$B=0,p$r=0;this._scene._dynamicBatchManager;for(p$S=0,p$P=this._objects.length;p$S<p$P;p$S++){var p$Y=this._objects[p$S];if(p$Y.castShadow&&p$z.isVisible(p$Y._owner.layer.mask)&&p$Y.enable){if(p$f&&0===p$h[0].containsBoundSphere(p$Y.boundingSphere))continue;for(var p$C=1,p$U=p$h.length;p$C<p$U;p$C++){var p$u=p$q[p$C-1];if(0!==p$h[p$C].containsBoundSphere(p$Y.boundingSphere)){var p$v=p$Y._renderElements;for(p$B=0,p$r=p$v.length;p$B<p$r;p$B++)p$u._addRenderElement(p$v[p$B])}}}}for(p$S=0;p$S<8;p$S++){var p$L=this._children[p$S];if(null!=p$L){var p$e=p$f;if(p$f){var p$l=p$h[0].containsBoundBox(p$L._relaxBox);if(0===p$l)continue;p$e=2===p$l}p$L.cullingShadowObjects(p$h,p$q,p$e,p$g,p$$)}}},p$h.cullingShadowObjectsOnePSSM=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S,p$B=p$q[0],p$r=0,p$Y=0,p$C=0;for(p$r=0,p$S=this._objects.length;p$r<p$S;p$r++){var p$U=this._objects[p$r];if(p$U.castShadow&&p$z.isVisible(p$U._owner.layer.mask)&&p$U.enable){if(p$g&&0===p$h.containsBoundSphere(p$U.boundingSphere))continue;p$U._renderUpdate(p$f);var p$u=p$U._renderElements;for(p$Y=0,p$C=p$u.length;p$Y<p$C;p$Y++)p$B._addRenderElement(p$u[p$Y])}}for(p$r=0;p$r<8;p$r++){var p$v=this._children[p$r];if(null!=p$v){var p$L=p$g;if(p$g){var p$e=p$h.containsBoundBox(p$v._relaxBox);if(0===p$e)continue;p$L=2===p$e}p$v.cullingShadowObjectsOnePSSM(p$h,p$q,p$f,p$L,p$$,p$P)}}},p$h.renderBoudingBox=function(p$h){this._renderBoudingBox(p$h);for(var p$q=0;p$q<8;++p$q){var p$f=this._children[p$q];p$f&&p$f.renderBoudingBox(p$h)}},p$h.buildAllChild=function(p$h){if(p$h<this._scene.treeLevel)for(var p$q=0;p$q<8;p$q++){this.addChild(p$q).buildAllChild(p$h+1)}},p$h._renderBoudingBox=function(p$h){},p$L(0,p$h,"exactBox",function(){return this._exactBox},function(p$h){this._exactBox=p$h,p$Sq.add(p$h.min,p$h.max,this._boundingBoxCenter),p$Sq.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),p$L(0,p$h,"relaxBox",function(){return this._relaxBox},function(p$h){(this._relaxBox=p$h).getCorners(this._corners),p$jh.createfromPoints(this._corners,this._boundingSphere)}),p$S.debugMode=!1,p$S.relax=1.15,p$S.CHILDNUM=8,p$U(p$S,["tempVector0",function(){return this.tempVector0=new p$Sq},"tempSize",function(){return this.tempSize=new p$Sq},"tempCenter",function(){return this.tempCenter=new p$Sq},"_octreeSplit",function(){return this._octreeSplit=[new p$Sq(.25,.25,.25),new p$Sq(.75,.25,.25),new p$Sq(.25,.75,.25),new p$Sq(.75,.75,.25),new p$Sq(.25,.25,.75),new p$Sq(.75,.25,.75),new p$Sq(.25,.75,.75),new p$Sq(.75,.75,.75)]}]),p$S}(),p$O=(function(){function p$h(){}p$v(p$h,"laya.d3.core.scene.SceneManager")}(),function(){function p$h(p$h,p$q,p$f,p$g){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===p$h&&(p$h=1),void 0===p$q&&(p$q=1),void 0===p$f&&(p$f=1),void 0===p$g&&(p$g=1),this._r=p$h,this._g=p$q,this._b=p$f,this._a=p$g}return p$v(p$h,"laya.d3.core.trail.module.Color",null,"Color$1"),p$h.prototype.cloneTo=function(p$h){p$h._r=this._r,p$h._g=this._g,p$h._b=this._b,p$h._a=this._a},p$U(p$h,["RED",function(){return this.RED=new p$h(1,0,0,1)},"GREEN",function(){return this.GREEN=new p$h(0,1,0,1)},"BLUE",function(){return this.BLUE=new p$h(0,0,1,1)},"CYAN",function(){return this.CYAN=new p$h(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new p$h(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new p$h(1,0,1,1)},"GRAY",function(){return this.GRAY=new p$h(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new p$h(1,1,1,1)},"BLACK",function(){return this.BLACK=new p$h(0,0,0,1)}]),p$h}()),p$j=(function(){function p$h(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}p$v(p$h,"laya.d3.core.trail.module.Gradient");var p$q=p$h.prototype;p$q.setKeys=function(p$h,p$q){var p$f,p$g;this._colorKeys=p$h;for(var p$$=this.index=0;p$$<p$h.length;p$$++){var p$P=(p$f=p$h[p$$]).color;this._colorKeyData[this.index++]=p$P._r,this._colorKeyData[this.index++]=p$P._g,this._colorKeyData[this.index++]=p$P._b,this._colorKeyData[this.index++]=p$f.time}this._alphaKeys=p$q;for(var p$S=this.index=0;p$S<p$q.length;p$S++)p$g=p$q[p$S],this._alphaKeyData[this.index++]=p$g.alpha,this._alphaKeyData[this.index++]=p$g.time},p$q.cloneTo=function(p$h){var p$q=0,p$f=0,p$g=this.colorKeys,p$$=[];for(p$q=0,p$f=p$g.length;p$q<p$f;p$q++){var p$P=new p$x;p$g[p$q].cloneTo(p$P),p$$.push(p$P)}var p$S=this.alphaKeys,p$B=[];for(p$q=0,p$f=p$S.length;p$q<p$f;p$q++){var p$r=new p$j;p$S[p$q].cloneTo(p$r),p$B.push(p$r)}p$h.setKeys(p$$,p$B)},p$L(0,p$q,"mode",function(){return this._mode},function(p$h){this._mode=p$h}),p$L(0,p$q,"colorKeys",function(){return this._colorKeys},function(p$h){this._colorKeys=p$h;for(var p$q=this.index=0;p$q<p$h.length;p$q++){var p$f=p$h[p$q],p$g=p$f.color;this._colorKeyData[this.index++]=p$g._r,this._colorKeyData[this.index++]=p$g._g,this._colorKeyData[this.index++]=p$g._b,this._colorKeyData[this.index++]=p$f.time}}),p$L(0,p$q,"alphaKeys",function(){return this._alphaKeys},function(p$h){this._alphaKeys=p$h;for(var p$q=this.index=0;p$q<p$h.length;p$q++){var p$f=p$h[p$q];this._alphaKeyData[this.index++]=p$f.alpha,this._alphaKeyData[this.index++]=p$f.time}})}(),function(){function p$h(p$h,p$q){this._alpha=NaN,this._time=NaN,void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),this._alpha=p$h,this._time=p$q}p$v(p$h,"laya.d3.core.trail.module.GradientAlphaKey");var p$q=p$h.prototype;return p$q.cloneTo=function(p$h){p$h.alpha=this.alpha,p$h.time=this.time},p$L(0,p$q,"alpha",function(){return this._alpha},function(p$h){this._alpha=p$h}),p$L(0,p$q,"time",function(){return this._time},function(p$h){this._time=p$h}),p$h}()),p$x=function(){function p$h(p$h,p$q){this._color=null,this._time=NaN,void 0===p$q&&(p$q=0),this._color=p$h||new p$O,this._time=p$q}p$v(p$h,"laya.d3.core.trail.module.GradientColorKey");var p$q=p$h.prototype;return p$q.cloneTo=function(p$h){this.color.cloneTo(p$h.color),p$h.time=this.time},p$L(0,p$q,"color",function(){return this._color},function(p$h){this._color=p$h}),p$L(0,p$q,"time",function(){return this._time},function(p$h){this._time=p$h}),p$h}(),p$a=(function(){function p$h(){}p$v(p$h,"laya.d3.core.trail.module.GradientMode"),p$h.Blend=0,p$h.Fixed=1}(),function(){function p$h(){}p$v(p$h,"laya.d3.core.trail.module.TextureMode"),p$h.Stretch=0,p$h.Tile=1}(),function(){function p$h(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}p$v(p$h,"laya.d3.core.trail.module.TrailKeyFrame"),p$h.prototype.cloneTo=function(p$h){p$h.time=this.time,p$h.inTangent=this.inTangent,p$h.outTangent=this.outTangent,p$h.value=this.value}}(),function(){function p$q(p$h){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new p$Sq,this._curPosition=new p$Sq,this._delVector3=new p$Sq,this._lastFixedVertexPosition=new p$Sq,this._pointAtoBVector3=new p$Sq,this._pointA=new p$Sq,this._pointB=new p$Sq,this._owner=p$h,this._id=p$q.renderElementCount++,0==this._id?p$h._owner.transform.position.cloneTo(this._lastPosition):p$h._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new p$wq(p$a.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new p$wq(p$a.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}p$v(p$q,"laya.d3.core.trail.TrailRenderElement");var p$h=p$q.prototype;p$E.imps(p$h,{"laya.d3.core.render.IRenderable":!0}),p$h._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},p$h._addTrailByFirstPosition=function(p$h,p$q){p$Sq.subtract(p$q,p$h,this._delVector3),p$Sq.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),p$Sq.normalize(this._pointAtoBVector3,this._pointAtoBVector3),p$Sq.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(p$h),p$h.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},p$h._addTrailByNextPosition=function(p$h){p$Sq.subtract(p$h,this._lastFixedVertexPosition,this._delVector3),p$Sq.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),p$Sq.normalize(this._pointAtoBVector3,this._pointAtoBVector3),p$Sq.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=p$Sq.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=p$xh.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(p$h),p$h.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(p$h),this._virtualVerticesCount=2)},p$h._updateVerticesByPosition=function(p$h){this._pointe=p$h.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},p$h._updateVertexBuffer2=function(){var p$h,p$q=0,p$f=0,p$g=0;for(p$g=0,p$h=(this._verticesCount+this._virtualVerticesCount)/2;p$g<p$h;p$g++)p$f=0==this._owner.textureMode?(this._VerticesToTailLength[p$g]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[p$g],this._vertices2[p$q++]=1-p$f,this._vertices2[p$q++]=1-p$f;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},p$h._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},p$h._updateDisappear=function(){var p$h,p$q=0;for(p$q=this._curDisappearIndex,p$h=(this._verticesCount+this._virtualVerticesCount)/2;p$q<p$h;p$q++)this._owner._curtime-this._everyGroupVertexBirthTime[p$q]>=this._owner.time+p$xh.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},p$h._beforeRender=function(p$h){return this._camera=p$h.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),p$Sq.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},p$h._render=function(p$h){this._isDead||(p$d.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),p$X.drawCall++,p$X.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},p$h._getVertexBuffer=function(p$h){return void 0===p$h&&(p$h=0),0===p$h?this._vertexBuffer1:1===p$h?this._vertexBuffer2:null},p$h._getVertexBuffers=function(){return this._vertexBuffers},p$h._getIndexBuffer=function(){return null},p$h.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},p$h._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},p$L(0,p$h,"_vertexBufferCount",function(){return this._vertexBuffers.length}),p$L(0,p$h,"triangleCount",function(){return 0}),p$q.renderElementCount=0}(),function(){function p$h(){}p$v(p$h,"laya.d3.core.trail.VertexTrail");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration1}),p$L(1,p$h,"vertexDeclaration1",function(){return p$h._vertexDeclaration1}),p$L(1,p$h,"vertexDeclaration2",function(){return p$h._vertexDeclaration2}),p$U(p$h,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new p$Ph(32,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",41),new p$Sh(24,"single",33),new p$Sh(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new p$Ph(4,[new p$Sh(0,"single",38)])}]),p$h}()),p$hh=function(){function p$m(p$h){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=p$h}p$v(p$m,"laya.d3.graphics.DynamicBatch");var p$h=p$m.prototype;return p$E.imps(p$h,{"laya.d3.core.render.IRenderable":!0}),p$h._getVertexBuffer=function(p$h){return void 0===p$h&&(p$h=0),0===p$h?this._vertexBuffer:null},p$h._getIndexBuffer=function(){return this._indexBuffer},p$h._getCombineRenderElementFromPool=function(p$h,p$q,p$f){var p$g=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return p$g||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=p$g=new p$F,p$g._sprite3D=new p$Zq),p$g._sprite3D._render._renderUpdate(p$f),p$g},p$h._getRenderElement=function(p$h,p$q,p$f){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*p$m.maxVertexCount),this._indexDatas=new Uint16Array(p$m.maxIndexCount),this._vertexBuffer=p$wq.create(this._vertexDeclaration,p$m.maxVertexCount,35048),this._indexBuffer=p$Iq.create("ushort",p$m.maxIndexCount,35048));for(var p$g=this._merageElements.length=0,p$$=0,p$P=0,p$S=this._combineRenderElements.length;p$P<p$S;p$P++){var p$B=this._combineRenderElements[p$P],p$r=p$B.getDynamicBatchBakedVertexs(0),p$Y=p$B.getBakedIndices(),p$C=p$B._sprite3D.transform._isFrontFaceInvert,p$U=p$g/(this._vertexDeclaration.vertexStride/4),p$u=p$$,p$v=p$u+p$Y.length;p$B._tempBatchIndexStart=p$u,p$B._tempBatchIndexEnd=p$v,this._indexDatas.set(p$Y,p$$);var p$L=0;if(p$C)for(p$L=p$u;p$L<p$v;p$L+=3){this._indexDatas[p$L]=p$U+this._indexDatas[p$L];var p$e=this._indexDatas[p$L+1],p$l=this._indexDatas[p$L+2];this._indexDatas[p$L+1]=p$U+p$l,this._indexDatas[p$L+2]=p$U+p$e}else for(p$L=p$u;p$L<p$v;p$L+=3)this._indexDatas[p$L]=p$U+this._indexDatas[p$L],this._indexDatas[p$L+1]=p$U+this._indexDatas[p$L+1],this._indexDatas[p$L+2]=p$U+this._indexDatas[p$L+2];p$$+=p$Y.length,this._vertexDatas.set(p$r,p$g),p$g+=p$r.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),p$P=this._combineRenderElementPoolIndex=0,p$S=this._materials.length;p$P<p$S;p$P++){var p$_=this._getCombineRenderElementFromPool(p$h,p$q,p$f);p$_._type=2,p$_._staticBatch=null;var p$N=(p$_.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[p$P]]._tempBatchIndexStart,p$G=p$P+1===this._materialToRenderElementsOffsets.length?p$$:this._combineRenderElements[this._materialToRenderElementsOffsets[p$P+1]]._tempBatchIndexStart;p$_._tempBatchIndexStart=p$N,p$_._tempBatchIndexEnd=p$G,p$_._material=this._materials[p$P],this._merageElements.push(p$_)}},p$h._addCombineRenderObjTest=function(p$h){var p$q=p$h.renderObj,p$f=this._currentCombineIndexCount+p$q._getIndexBuffer().indexCount,p$g=this._currentCombineVertexCount+p$q._getVertexBuffer().vertexCount;return!(p$m.maxVertexCount<p$g||p$m.maxIndexCount<p$f)},p$h._addCombineRenderObj=function(p$h){var p$q=p$h.renderObj;this._combineRenderElements.push(p$h),this._currentCombineIndexCount=this._currentCombineIndexCount+p$q._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+p$q._getVertexBuffer().vertexCount},p$h._addCombineMaterial=function(p$h){this._materials.push(p$h)},p$h._addMaterialToRenderElementOffset=function(p$h){this._materialToRenderElementsOffsets.push(p$h)},p$h._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},p$h._addToRenderQueue=function(p$h,p$q,p$f,p$g){this._getRenderElement(p$q,p$f,p$g);for(var p$$=0,p$P=this._materials.length;p$$<p$P;p$$++)p$h.getRenderQueue(this._materials[p$$].renderQueue)._addDynamicBatchElement(this._merageElements[p$$])},p$h._beforeRender=function(p$h){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},p$h._render=function(p$h){var p$q=p$h._batchIndexEnd-p$h._batchIndexStart;p$d.mainContext.drawElements(4,p$q,5123,2*p$h._batchIndexStart),p$X.drawCall++,p$X.trianglesFaces+=p$q/3},p$h._getVertexBuffers=function(){return null},p$L(0,p$h,"_vertexBufferCount",function(){return 1}),p$L(0,p$h,"triangleCount",function(){return this._indexBuffer.indexCount/3}),p$L(0,p$h,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),p$m.maxVertexCount=2e4,p$m.maxIndexCount=4e4,p$m.maxCombineTriangleCount=10,p$m}(),p$qh=function(){function p$m(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}p$v(p$m,"laya.d3.graphics.DynamicBatchManager");var p$h=p$m.prototype;return p$h.getDynamicBatch=function(p$h,p$q){var p$f,p$g=p$h.id.toString()+p$q;return this._dynamicBatches[p$g]?p$f=this._dynamicBatches[p$g]:this._dynamicBatches[p$g]=p$f=new p$hh(p$h),p$f},p$h._garbageCollection=function(){for(var p$h in this._dynamicBatches)0===this._dynamicBatches[p$h].combineRenderElementsCount&&delete this._dynamicBatches[p$h]},p$h._addPrepareRenderElement=function(p$h){this._prepareDynamicBatchCombineElements.push(p$h)},p$h._finishCombineDynamicBatch=function(p$h){var p$q,p$f,p$g;this._prepareDynamicBatchCombineElements.sort(p$m._sortPrepareDynamicBatch);for(var p$$,p$P,p$S,p$B,p$r,p$Y=-1,p$C=!0,p$U=0,p$u=-1,p$v=0,p$L=this._prepareDynamicBatchCombineElements.length;p$v<p$L;p$v++){var p$e=(p$P=this._prepareDynamicBatchCombineElements[p$v]).renderObj._getVertexBuffer(0).vertexDeclaration,p$l=p$f!==p$e;p$l&&(p$U=0,p$f=p$e);var p$_=p$U!==p$Y;if(p$_&&(p$Y=p$U),(p$l||p$_)&&(p$S=this.getDynamicBatch(p$e,p$U),p$q=null),p$C)if(p$S._addCombineRenderObjTest(p$P)){if(p$q!==(p$$=p$P._material))p$B&&(p$h.getRenderQueue(p$r._material.renderQueue)._addRenderElement(p$r),p$r=p$B=null,p$u=-1),p$B=p$$,p$u=p$S.combineRenderElementsCount,p$r=p$P,p$q=p$$;else if(p$B){var p$N=p$r.renderObj,p$G=p$P.renderObj;p$N._getVertexBuffer().vertexCount+p$G._getVertexBuffer().vertexCount>p$hh.maxVertexCount||p$N._getIndexBuffer().indexCount+p$G._getIndexBuffer().indexCount>p$hh.maxIndexCount?(p$h.getRenderQueue(p$r._material.renderQueue)._addRenderElement(p$r),p$B=p$$,p$u=p$S.combineRenderElementsCount,p$r=p$P):(p$S._addCombineMaterial(p$B),p$S._addMaterialToRenderElementOffset(p$u),p$S._addCombineRenderObj(p$r),p$r=p$B=null,p$u=-1,p$S._addCombineRenderObj(p$P))}else p$S._addCombineRenderObj(p$P);p$C=!0}else p$B&&(p$h.getRenderQueue(p$r._material.renderQueue)._addRenderElement(p$r),p$r=p$B=null,p$u=-1),p$U++,p$C=!1;else p$g=this._prepareDynamicBatchCombineElements[p$v-1],p$S._addMaterialToRenderElementOffset(p$S.combineRenderElementsCount),p$q=p$g._material,p$S._addCombineMaterial(p$q),p$S._addCombineRenderObj(p$g),p$C=!0,p$q!==(p$$=p$P._material)?(p$B=p$$,p$u=p$S.combineRenderElementsCount,p$r=p$P):p$S._addCombineRenderObj(p$P),p$q=p$$}p$B&&(p$h.getRenderQueue(p$r._material.renderQueue)._addRenderElement(p$r),p$r=p$B=null,p$u=-1),this._prepareDynamicBatchCombineElements.length=0},p$h._clearRenderElements=function(){for(var p$h in this._dynamicBatches)this._dynamicBatches[p$h]._clearRenderElements()},p$h._addToRenderQueue=function(p$h,p$q,p$f,p$g){for(var p$$ in this._dynamicBatches){var p$P=this._dynamicBatches[p$$];0<p$P.combineRenderElementsCount&&p$P._addToRenderQueue(p$h,p$q,p$f,p$g)}},p$h.dispose=function(){this._dynamicBatches=null},p$m._sortPrepareDynamicBatch=function(p$h,p$q){return p$h._mainSortID-p$q._mainSortID},p$m}(),p$fh=function(){function p$h(){}return p$v(p$h,"laya.d3.graphics.FrustumCulling"),p$h.renderShadowObjectCulling=function(p$h,p$q,p$f,p$g,p$$){var p$P=0,p$S=0,p$B=0,p$r=0;for(p$P=0,p$B=p$f.length;p$P<p$B;p$P++){var p$Y=p$f[p$P];p$Y&&p$Y._clearRenderElements()}var p$C,p$U,p$u,p$v=p$h._cullingRenders;if(1<p$$){for(p$P=0,p$B=p$h._cullingRendersLength;p$P<p$B;p$P++)if((p$C=p$v[p$P]).castShadow&&p$z.isVisible(p$C._owner.layer.mask)&&p$C.enable)for(var p$L=1,p$e=p$q.length;p$L<p$e;p$L++)if(p$U=p$f[p$L-1],0!==p$q[p$L].containsBoundSphere(p$C.boundingSphere))for(p$S=0,p$r=(p$u=p$C._renderElements).length;p$S<p$r;p$S++)p$U._addRenderElement(p$u[p$S])}else for(p$P=0,p$B=p$h._cullingRendersLength;p$P<p$B;p$P++)if((p$C=p$v[p$P]).castShadow&&p$z.isVisible(p$C._owner.layer.mask)&&p$C.enable&&0!==p$q[0].containsBoundSphere(p$C.boundingSphere))for(p$C._renderUpdate(p$g),p$U=p$f[0],p$S=0,p$r=(p$u=p$C._renderElements).length;p$S<p$r;p$S++)p$U._addRenderElement(p$u[p$S])},p$h.renderShadowObjectCullingOctree=function(p$h,p$q,p$f,p$g,p$$){for(var p$P=0,p$S=p$f.length;p$P<p$S;p$P++){var p$B=p$f[p$P];p$B&&p$B._clearRenderElements()}1<p$$?p$h.treeRoot.cullingShadowObjects(p$q,p$f,!0,0,p$h):p$h.treeRoot.cullingShadowObjectsOnePSSM(p$q[0],p$f,p$g,!0,0,p$h)},p$h.renderObjectCulling=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=0,p$B=0,p$r=0,p$Y=0,p$C=p$q._quenes,p$U=p$q._dynamicBatchManager,p$u=p$q._cullingRenders;for(p$S=0,p$B=p$C.length;p$S<p$B;p$S++){var p$v=p$C[p$S];p$v&&p$v._clearRenderElements()}var p$L=p$gh._staticBatchManagers;for(p$S=0,p$B=p$L.length;p$S<p$B;p$S++)p$L[p$S]._clearRenderElements();p$U._clearRenderElements();var p$e=p$f.transform.position;for(p$S=0,p$B=p$q._cullingRendersLength;p$S<p$B;p$S++){var p$l=p$u[p$S];if(p$z.isVisible(p$l._owner.layer.mask)&&p$l.enable&&0!==p$h.containsBoundSphere(p$l.boundingSphere)&&p$l._renderUpdate(p$P)){p$l._distanceForSort=p$Sq.distance(p$l.boundingSphere.center,p$e)+p$l.sortingFudge;var p$_=p$l._renderElements;for(p$r=0,p$Y=p$_.length;p$r<p$Y;p$r++){var p$N=p$_[p$r],p$G=p$N._staticBatch;if(p$G&&p$G._material===p$N._material)p$G._addBatchRenderElement(p$N);else{var p$m=p$N.renderObj;p$m.triangleCount<10&&1===p$m._vertexBufferCount&&p$m._getIndexBuffer()&&p$N._material.renderQueue<2&&p$N._canDynamicBatch&&!p$l._owner.isStatic?p$U._addPrepareRenderElement(p$N):p$q.getRenderQueue(p$N._material.renderQueue)._addRenderElement(p$N)}}}}for(p$S=0,p$B=p$L.length;p$S<p$B;p$S++)p$L[p$S]._addToRenderQueue(p$q,p$g,p$$,p$P);p$U._finishCombineDynamicBatch(p$q),p$U._addToRenderQueue(p$q,p$g,p$$,p$P)},p$h.renderObjectCullingOctree=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=0,p$B=0,p$r=p$q._quenes,p$Y=p$q._dynamicBatchManager;for(p$S=0,p$B=p$r.length;p$S<p$B;p$S++){var p$C=p$r[p$S];p$C&&p$C._clearRenderElements()}var p$U=p$gh._staticBatchManagers;for(p$S=0,p$B=p$U.length;p$S<p$B;p$S++)p$U[p$S]._clearRenderElements();for(p$Y._clearRenderElements(),p$q._cullingRenders.length=0,p$q.treeRoot.cullingObjects(p$h,!0,0,p$f.transform.position,p$P),p$S=0,p$B=p$U.length;p$S<p$B;p$S++)p$U[p$S]._addToRenderQueue(p$q,p$g,p$$,p$P);p$Y._finishCombineDynamicBatch(p$q),p$Y._addToRenderQueue(p$q,p$g,p$$,p$P)},p$h.renderObjectCullingNoBoundFrustum=function(p$h,p$q,p$f,p$g,p$$){var p$P=0,p$S=0,p$B=0,p$r=0,p$Y=p$h._quenes,p$C=p$h._dynamicBatchManager,p$U=p$h._cullingRenders;for(p$P=0,p$S=p$Y.length;p$P<p$S;p$P++){var p$u=p$Y[p$P];p$u&&p$u._clearRenderElements()}var p$v=p$gh._staticBatchManagers;for(p$P=0,p$S=p$v.length;p$P<p$S;p$P++)p$v[p$P]._clearRenderElements();p$C._clearRenderElements();var p$L=p$q.transform.position;for(p$P=0,p$S=p$h._cullingRendersLength;p$P<p$S;p$P++){var p$e=p$U[p$P];if(p$z.isVisible(p$e._owner.layer.mask)&&p$e.enable){p$e._renderUpdate(p$$),p$e._distanceForSort=p$Sq.distance(p$e.boundingSphere.center,p$L)+p$e.sortingFudge;var p$l=p$e._renderElements;for(p$B=0,p$r=p$l.length;p$B<p$r;p$B++){var p$_=p$l[p$B],p$N=p$_._staticBatch;if(p$N&&p$N._material===p$_._material)p$N._addBatchRenderElement(p$_);else{var p$G=p$_.renderObj;p$G.triangleCount<10&&1===p$G._vertexBufferCount&&p$G._getIndexBuffer()&&p$_._material.renderQueue<2&&p$_._canDynamicBatch&&!p$e._owner.isStatic?p$C._addPrepareRenderElement(p$_):p$h.getRenderQueue(p$_._material.renderQueue)._addRenderElement(p$_)}}}}for(p$P=0,p$S=p$v.length;p$P<p$S;p$P++)p$v[p$P]._addToRenderQueue(p$h,p$f,p$g,p$$);p$C._finishCombineDynamicBatch(p$h),p$C._addToRenderQueue(p$h,p$f,p$g,p$$)},p$h}(),p$gh=function(){function p$P(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}p$v(p$P,"laya.d3.graphics.StaticBatchManager");var p$h=p$P.prototype;return p$h._finishInit=function(){for(var p$h in this._staticBatches)this._staticBatches[p$h]._finishInit();this._initBatchRenderElements.length=0},p$h._initStaticBatchs=function(p$h){throw new Error("StaticBatchManager:must override this function.")},p$h._addInitBatchSprite=function(p$h){for(var p$q=p$h._render._renderElements,p$f=0,p$g=p$q.length;p$f<p$g;p$f++)this._initBatchRenderElements.push(p$q[p$f])},p$h._clearRenderElements=function(){for(var p$h in this._staticBatches)this._staticBatches[p$h]._clearRenderElements()},p$h._garbageCollection=function(p$h){var p$q=p$h._staticBatch,p$f=p$q._initBatchRenderElements,p$g=p$f.indexOf(p$h);p$f.splice(p$g,1),0===p$f.length&&(p$q.dispose(),delete this._staticBatches[p$q._key])},p$h._addToRenderQueue=function(p$h,p$q,p$f,p$g){for(var p$$ in this._staticBatches){var p$P=this._staticBatches[p$$];0<p$P._batchRenderElements.length&&p$P._updateToRenderQueue(p$h,p$g)}},p$h.dispose=function(){this._staticBatches=null},p$P._addToStaticBatchQueue=function(p$h){p$h instanceof laya.d3.core.RenderableSprite3D&&p$h._addToInitStaticBatchManager();for(var p$q=0,p$f=p$h.numChildren;p$q<p$f;p$q++)p$P._addToStaticBatchQueue(p$h._childs[p$q])},p$P.combine=function(p$h,p$q){var p$f,p$g=0,p$$=0;if(p$q)for(p$g=0,p$$=p$q.length;p$g<p$$;p$g++){p$q[p$g]._addToInitStaticBatchManager()}else p$h&&p$P._addToStaticBatchQueue(p$h);for(p$g=0,p$$=p$P._staticBatchManagers.length;p$g<p$$;p$g++)(p$f=p$P._staticBatchManagers[p$g])._initStaticBatchs(p$h),p$f._finishInit()},p$P._staticBatchManagers=[],p$P}(),p$$h=function(){function p$h(p$h,p$q,p$f){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=p$h,this._manager=p$q,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=p$f}p$v(p$h,"laya.d3.graphics.StaticBatch");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),p$q._binarySearch=function(p$h){for(var p$q=0,p$f=this._batchRenderElements.length-1,p$g=0;p$q<=p$f;)p$g=Math.floor((p$q+p$f)/2),this._compareBatchRenderElement(this._batchRenderElements[p$g],p$h)?p$f=p$g-1:p$q=p$g+1;return p$q},p$q._compareBatchRenderElement=function(p$h,p$q){throw new Error("StaticBatch:must override this function.")},p$q._getVertexDecLightMap=function(p$h){return p$h===p$Ih.vertexDeclaration?p$zh.vertexDeclaration:p$h===p$Th.vertexDeclaration?p$ih.vertexDeclaration:p$h===p$nh.vertexDeclaration?p$mh.vertexDeclaration:p$h===p$Dh.vertexDeclaration?null:p$h===p$eh.vertexDeclaration?p$lh.vertexDeclaration:p$h===p$kh.vertexDeclaration?p$Mh.vertexDeclaration:p$h===p$dh.vertexDeclaration?p$bh.vertexDeclaration:p$h===p$wh.vertexDeclaration?p$ch.vertexDeclaration:p$h===p$Th.vertexDeclaration?p$ih.vertexDeclaration:p$h===p$Jh.vertexDeclaration?p$Eh.vertexDeclaration:p$h===p$Dh.vertexDeclaration?null:p$h===p$eh.vertexDeclaration?p$lh.vertexDeclaration:p$h===p$Hh.vertexDeclaration?p$Wh.vertexDeclaration:p$h===p$dh.vertexDeclaration?p$bh.vertexDeclaration:p$h},p$q._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},p$q._addBatchRenderElement=function(p$h){this._batchRenderElements.splice(this._binarySearch(p$h),0,p$h)},p$q._updateToRenderQueue=function(p$h,p$q){this._combineRenderElementPoolIndex=0,this._getRenderElement(p$h.getRenderQueue(this._material.renderQueue)._renderElements,p$h,p$q)},p$q._getRenderElement=function(p$h,p$q,p$f){throw new Error("StaticBatch:must override this function.")},p$q._finishInit=function(){throw new Error("StaticBatch:must override this function.")},p$q._clearRenderElements=function(){this._batchRenderElements.length=0},p$q.dispose=function(){},p$q._getVertexBuffer=function(p$h){return void 0===p$h&&(p$h=0),null},p$q._getIndexBuffer=function(){return null},p$q._beforeRender=function(p$h){return!0},p$q._render=function(p$h){},p$q._getVertexBuffers=function(){return null},p$L(0,p$q,"_vertexBufferCount",function(){return 1}),p$L(0,p$q,"triangleCount",function(){return 0}),p$h.combine=function(p$h){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),p$gh.combine(p$h)},p$h.maxBatchVertexCount=65535,p$h}(),p$Ph=function(){function p$S(p$h,p$q){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++p$S._uniqueIDCounter,this._id>p$S.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",p$S.maxVertexDeclaration);this._shaderValues=new p$uq,this._vertexElementsDic={},this._vertexStride=p$h,this._vertexElements=p$q;for(var p$f=0;p$f<p$q.length;p$f++){var p$g=p$q[p$f],p$$=p$g.elementUsage;this._vertexElementsDic[p$$]=p$g;var p$P=[p$S._getTypeSize(p$g.elementFormat)/4,5126,!1,this._vertexStride,p$g.offset];switch(this._shaderValues.setValue(p$$,p$P),p$$){case 1:this._addShaderDefine(p$Xq.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(p$Xq.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(p$Xq.SHADERDEFINE_UV1)}}}p$v(p$S,"laya.d3.graphics.VertexDeclaration");var p$h=p$S.prototype;return p$h._addShaderDefine=function(p$h){this._shaderDefineValue|=p$h},p$h._removeShaderDefine=function(p$h){this._shaderDefineValue&=~p$h},p$h.getVertexElements=function(){return this._vertexElements.slice()},p$h.getVertexElementByUsage=function(p$h){return this._vertexElementsDic[p$h]},p$h.unBinding=function(){},p$L(0,p$h,"shaderDefineValue",function(){return this._shaderDefineValue}),p$L(0,p$h,"id",function(){return this._id}),p$L(0,p$h,"vertexStride",function(){return this._vertexStride}),p$L(0,p$h,"shaderValues",function(){return this._shaderValues}),p$S._getTypeSize=function(p$h){switch(p$h){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},p$S.getVertexStride=function(p$h){for(var p$q=0,p$f=0;p$f<p$h.Length;p$f++){var p$g=p$h[p$f],p$$=p$g.offset+p$S._getTypeSize(p$g.elementFormat);p$q<p$$&&(p$q=p$$)}return p$q},p$S._maxVertexDeclarationBit=1e3,p$S._uniqueIDCounter=1,p$U(p$S,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),p$S}(),p$Sh=function(){function p$h(p$h,p$q,p$f){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=p$h,this.elementFormat=p$q,this.elementUsage=p$f}return p$v(p$h,"laya.d3.graphics.VertexElement"),p$h}(),p$Bh=(function(){function p$h(){}p$v(p$h,"laya.d3.graphics.VertexElementFormat"),p$h.Single="single",p$h.Vector2="vector2",p$h.Vector3="vector3",p$h.Vector4="vector4",p$h.Color="color",p$h.Byte4="byte4",p$h.Short2="short2",p$h.Short4="short4",p$h.NormalizedShort2="normalizedshort2",p$h.NormalizedShort4="normalizedshort4",p$h.HalfVector2="halfvector2",p$h.HalfVector4="halfvector4"}(),function(){function p$h(){}p$v(p$h,"laya.d3.graphics.VertexElementUsage"),p$h.POSITION0=0,p$h.COLOR0=1,p$h.TEXTURECOORDINATE0=2,p$h.NORMAL0=3,p$h.BINORMAL0=4,p$h.TANGENT0=5,p$h.BLENDINDICES0=6,p$h.BLENDWEIGHT0=7,p$h.DEPTH0=8,p$h.FOG0=9,p$h.POINTSIZE0=10,p$h.SAMPLE0=11,p$h.TESSELLATEFACTOR0=12,p$h.COLOR1=13,p$h.NEXTTEXTURECOORDINATE0=14,p$h.TEXTURECOORDINATE1=15,p$h.NEXTTEXTURECOORDINATE1=16,p$h.CORNERTEXTURECOORDINATE0=17,p$h.VELOCITY0=18,p$h.STARTCOLOR0=19,p$h.STARTSIZE=20,p$h.AGEADDSCALE0=21,p$h.STARTROTATION=22,p$h.ENDCOLOR0=23,p$h.STARTLIFETIME=24,p$h.TIME0=33,p$h.SHAPEPOSITIONSTARTLIFETIME=30,p$h.DIRECTIONTIME=32,p$h.SIZEROTATION0=27,p$h.RADIUS0=28,p$h.RADIAN0=29,p$h.STARTSPEED=31,p$h.RANDOM0=34,p$h.RANDOM1=35,p$h.SIMULATIONWORLDPOSTION=36,p$h.SIMULATIONWORLDROTATION=37,p$h.TEXTURECOORDINATE0X=38,p$h.TEXTURECOORDINATE0X1=39,p$h.TEXTURECOORDINATE0Y=40,p$h.OFFSETVECTOR=41}(),function(){function p$h(p$h,p$q,p$f){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=p$h,this._textureCoordinate0=p$q,this._time=p$f}p$v(p$h,"laya.d3.graphics.VertexGlitter");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate0}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"time",function(){return this._time}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(24,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector2",2),new p$Sh(20,"single",33)])}])}(),function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=p$h,this._position=p$q,this._velocity=p$f,this._startColor=p$g,this._endColor=p$$,this._sizeRotation=p$P,this._radius=p$S,this._radian=p$B,this._ageAddScale=p$r,this._time=p$Y}p$v(p$h,"laya.d3.graphics.VertexParticle");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"endColor",function(){return this._endColor}),p$L(0,p$q,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),p$L(0,p$q,"sizeRotation",function(){return this._sizeRotation}),p$L(0,p$q,"velocity",function(){return this._velocity}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"startColor",function(){return this._startColor}),p$L(0,p$q,"radius",function(){return this._radius}),p$L(0,p$q,"radian",function(){return this._radian}),p$L(0,p$q,"ageAddScale",function(){return this._ageAddScale}),p$L(0,p$q,"time",function(){return this._time}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(116,[new p$Sh(0,"vector4",17),new p$Sh(16,"vector3",0),new p$Sh(28,"vector3",18),new p$Sh(40,"vector4",19),new p$Sh(56,"vector4",23),new p$Sh(72,"vector3",27),new p$Sh(84,"vector2",28),new p$Sh(92,"vector4",29),new p$Sh(108,"single",24),new p$Sh(112,"single",33)])}])}(),function(){function p$h(p$h){this._position=null,this._position=p$h}p$v(p$h,"laya.d3.graphics.VertexPosition");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(12,[new p$Sh(0,"vector3",0)])}]),p$h}()),p$rh=function(){function p$h(p$h,p$q){this._position=null,this._normal=null,this._position=p$h,this._normal=p$q}p$v(p$h,"laya.d3.graphics.VertexPositionNormal");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(24,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3)])}]),p$h}(),p$Yh=function(){function p$h(p$h,p$q,p$f){this._position=null,this._normal=null,this._color=null,this._position=p$h,this._normal=p$q,this._color=p$f}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColor");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(40,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1)])}]),p$h}(),p$Ch=function(){function p$h(p$h,p$q,p$f,p$g,p$$){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._blendIndex=p$g,this._blendWeight=p$$}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorSkin");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(72,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector4",7),new p$Sh(56,"vector4",6)])}]),p$h}(),p$Uh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._tangent=p$g,this._blendIndex=p$$,this._blendWeight=p$P}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(88,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector4",7),new p$Sh(56,"vector4",6),new p$Sh(72,"vector4",5)])}]),p$h}(),p$uh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._tangent=p$g,this._blendIndex=p$$,this._blendWeight=p$P}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(84,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector4",7),new p$Sh(56,"vector4",6),new p$Sh(72,"vector3",5)])}]),p$h}(),p$vh=function(){function p$h(p$h,p$q,p$f,p$g){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._tangent=p$g}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(56,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector4",5)])}]),p$h}(),p$Lh=function(){function p$h(p$h,p$q,p$f,p$g){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._tangent=p$g}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(52,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector3",5)])}]),p$h}(),p$eh=function(){function p$h(p$h,p$q,p$f,p$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate=p$g}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTexture");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(48,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2)])}]),p$h}(),p$lh=function(){function p$h(p$h,p$q,p$f,p$g,p$$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate0=p$g,this._textureCoordinate1=p$$}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(56,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector2",15)])}]),p$h}(),p$_h=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate0=p$g,this._textureCoordinate1=p$$,this._blendIndex=p$P,this._blendWeight=p$S}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(88,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector2",15),new p$Sh(56,"vector4",7),new p$Sh(72,"vector4",6)])}]),p$h}(),p$Nh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate0=p$g,this._textureCoordinate1=p$$,this._tangent=p$P,this._blendIndex=p$S,this._blendWeight=p$B}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(104,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector2",15),new p$Sh(56,"vector4",7),new p$Sh(72,"vector4",6),new p$Sh(88,"vector4",5)])}]),p$h}(),p$Gh=function(){function p$h(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$q.VertexPositionNormalColorTexture0SkinTangent=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate0=p$g,this._textureCoordinate1=p$$,this._tangent=p$P,this._blendIndex=p$S,this._blendWeight=p$B},p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(100,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector2",15),new p$Sh(56,"vector4",7),new p$Sh(72,"vector4",6),new p$Sh(88,"vector3",5)])}]),p$h}(),p$mh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate0=p$g,this._textureCoordinate1=p$$,this._tangent=p$P}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(72,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector2",15),new p$Sh(56,"vector4",5)])}]),p$h}(),p$Eh=function(){function p$h(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$q.VertexPositionNormalColorTexture0Tangent=function(p$h,p$q,p$f,p$g,p$$,p$P){this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate0=p$g,this._textureCoordinate1=p$$,this._tangent=p$P},p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(68,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector2",15),new p$Sh(56,"vector3",5)])}]),p$h}(),p$Rh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate=p$g,this._blendIndex=p$$,this._blendWeight=p$P}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(80,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector4",7),new p$Sh(64,"vector4",6)])}]),p$h}(),p$th=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate=p$g,this._tangent=p$$,this._blendIndex=p$P,this._blendWeight=p$S}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(96,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector4",7),new p$Sh(64,"vector4",6),new p$Sh(80,"vector4",5)])}]),p$h}(),p$Xh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate=p$g,this._tangent=p$$,this._blendIndex=p$P,this._blendWeight=p$S}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(92,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector4",7),new p$Sh(64,"vector4",6),new p$Sh(80,"vector3",5)])}]),p$h}(),p$nh=function(){function p$h(p$h,p$q,p$f,p$g,p$$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate=p$g,this._tangent=p$$}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(64,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector4",5)])}]),p$h}(),p$Jh=function(){function p$h(p$h,p$q,p$f,p$g,p$$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._color=p$f,this._textureCoordinate=p$g,this._tangent=p$$}p$v(p$h,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"color",function(){return this._color}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(60,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",1),new p$Sh(40,"vector2",2),new p$Sh(48,"vector3",5)])}]),p$h}(),p$ph=function(){function p$h(p$h,p$q,p$f){this._position=null,this._normal=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._tangent=p$f}p$v(p$h,"laya.d3.graphics.VertexPositionNormalSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(40,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector4",5)])}]),p$h}(),p$Ah=function(){function p$h(p$h,p$q,p$f){this._position=null,this._normal=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._tangent=p$f}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(36,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector3",5)])}]),p$h}(),p$dh=function(){function p$h(p$h,p$q,p$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTexture");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(32,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2)])}]),p$h}(),p$bh=function(){function p$h(p$h,p$q,p$f,p$g){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=p$h,this._normal=p$q,this._textureCoordinate0=p$f,this._textureCoordinate1=p$g}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(40,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector2",15)])}]),p$h}(),p$ih=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=p$h,this._normal=p$q,this._textureCoordinate0=p$f,this._textureCoordinate1=p$g,this._blendIndex=p$$,this._blendWeight=p$P}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(72,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector2",15),new p$Sh(40,"vector4",7),new p$Sh(56,"vector4",6)])}]),p$h}(),p$zh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._textureCoordinate0=p$f,this._textureCoordinate1=p$g,this._tangent=p$$,this._blendIndex=p$P,this._blendWeight=p$S}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(88,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector2",15),new p$Sh(40,"vector4",7),new p$Sh(56,"vector4",6),new p$Sh(72,"vector4",5)])}]),p$h}(),p$ch=function(){function p$h(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$q.VertexPositionNormalTexture0SkinTangent=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){this._position=p$h,this._normal=p$q,this._textureCoordinate0=p$f,this._textureCoordinate1=p$g,this._tangent=p$$,this._blendIndex=p$P,this._blendWeight=p$S},p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(84,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector2",15),new p$Sh(40,"vector4",7),new p$Sh(56,"vector4",6),new p$Sh(72,"vector3",5)])}]),p$h}(),p$Mh=function(){function p$h(p$h,p$q,p$f,p$g,p$$){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._textureCoordinate0=p$f,this._textureCoordinate1=p$g,this._tangent=p$$}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(56,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector2",15),new p$Sh(40,"vector4",5)])}]),p$h}(),p$Wh=function(){function p$h(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$q.VertexPositionNormalTexture0Tangent=function(p$h,p$q,p$f,p$g,p$$){this._position=p$h,this._normal=p$q,this._textureCoordinate0=p$f,this._textureCoordinate1=p$g,this._tangent=p$$},p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(52,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector2",15),new p$Sh(40,"vector3",5)])}]),p$h}(),p$Th=function(){function p$h(p$h,p$q,p$f,p$g,p$$){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f,this._blendIndex=p$g,this._blendWeight=p$$}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTextureSkin");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(64,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector4",7),new p$Sh(48,"vector4",6)])}]),p$h}(),p$Ih=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f,this._tangent=p$g,this._blendIndex=p$$,this._blendWeight=p$P}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(80,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector4",7),new p$Sh(48,"vector4",6),new p$Sh(64,"vector4",5)])}]),p$h}(),p$wh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f,this._tangent=p$g,this._blendIndex=p$$,this._blendWeight=p$P}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(76,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector4",7),new p$Sh(48,"vector4",6),new p$Sh(64,"vector3",5)])}]),p$h}(),p$kh=function(){function p$h(p$h,p$q,p$f,p$g){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f,this._tangent=p$g}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(48,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector4",5)])}]),p$h}(),p$Hh=function(){function p$h(p$h,p$q,p$f,p$g){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f,this._tangent=p$g}p$v(p$h,"laya.d3.graphics.VertexPositionNormalTextureTangent");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(44,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector3",5)])}]),p$h}(),p$Dh=function(){function p$h(p$h,p$q,p$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f}p$v(p$h,"laya.d3.graphics.VertexPositionNTBTexture");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(56,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector3",5),new p$Sh(36,"vector3",4),new p$Sh(48,"vector2",2)])}]),p$h}(),p$sh=function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=p$h,this._normal=p$q,this._textureCoordinate0=p$g,this._textureCoordinate1=p$$,this._tangent=p$P,p$f=p$f,this._blendIndex=p$S,this._blendWeight=p$B}p$v(p$h,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"tangent",function(){return this._tangent}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(0,p$q,"textureCoordinate1",function(){return this._textureCoordinate1}),p$L(0,p$q,"blendIndex",function(){return this._blendIndex}),p$L(0,p$q,"blendWeight",function(){return this._blendWeight}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(96,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector3",5),new p$Sh(36,"vector3",4),new p$Sh(48,"vector2",2),new p$Sh(56,"vector2",15),new p$Sh(64,"vector4",7),new p$Sh(80,"vector4",6)])}]),p$h}(),p$Vh=function(){function p$h(p$h,p$q,p$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=p$h,this._normal=p$q,this._textureCoordinate=p$f}p$v(p$h,"laya.d3.graphics.VertexPositionNTBTextureSkin");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"textureCoordinate",function(){return this._textureCoordinate}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(88,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector3",5),new p$Sh(36,"vector3",4),new p$Sh(48,"vector2",2),new p$Sh(56,"vector4",7),new p$Sh(72,"vector4",6)])}]),p$h}(),p$Kh=(function(){function p$h(p$h,p$q,p$f,p$g){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=p$h,this._normal=p$q,this._textureCoord0=p$f,this._textureCoord1=p$g}p$v(p$h,"laya.d3.graphics.VertexPositionTerrain");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"normal",function(){return this._normal}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoord0",function(){return this._textureCoord0}),p$L(0,p$q,"textureCoord1",function(){return this._textureCoord1}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(40,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector3",3),new p$Sh(24,"vector2",2),new p$Sh(32,"vector2",15)])}])}(),function(){function p$h(p$h,p$q){this._position=null,this._textureCoordinate0=null,this._position=p$h,this._textureCoordinate0=p$q}p$v(p$h,"laya.d3.graphics.VertexPositionTexture0");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"position",function(){return this._position}),p$L(0,p$q,"textureCoordinate0",function(){return this._textureCoordinate0}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(20,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector2",2)])}]),p$h}()),p$yh=(function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U,p$u,p$v){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=p$h,this._positionStartLifeTime=p$q,this._velocity=p$f,this._startColor=p$g,this._startSize=p$$,this._startRotation0=p$P,this._startRotation1=p$S,this._startRotation2=p$B,this._startLifeTime=p$r,this._time=p$Y,this._startSpeed=p$C,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=p$v}p$v(p$h,"laya.d3.graphics.VertexShurikenParticleBillboard");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),p$L(0,p$q,"random1",function(){return this._randoms1}),p$L(0,p$q,"startRotation2",function(){return this._startRotation2}),p$L(0,p$q,"positionStartLifeTime",function(){return this._positionStartLifeTime}),p$L(0,p$q,"velocity",function(){return this._velocity}),p$L(0,p$q,"random0",function(){return this._randoms0}),p$L(0,p$q,"startSize",function(){return this._startSize}),p$L(0,p$q,"startColor",function(){return this._startColor}),p$L(0,p$q,"startRotation0",function(){return this._startRotation0}),p$L(0,p$q,"startRotation1",function(){return this._startRotation1}),p$L(0,p$q,"startLifeTime",function(){return this._startLifeTime}),p$L(0,p$q,"time",function(){return this._time}),p$L(0,p$q,"startSpeed",function(){return this._startSpeed}),p$L(0,p$q,"simulationWorldPostion",function(){return this._simulationWorldPostion}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(152,[new p$Sh(0,"vector4",17),new p$Sh(16,"vector4",30),new p$Sh(32,"vector4",32),new p$Sh(48,"vector4",19),new p$Sh(64,"vector3",20),new p$Sh(76,"vector3",22),new p$Sh(88,"single",31),new p$Sh(92,"vector4",34),new p$Sh(108,"vector4",35),new p$Sh(124,"vector3",36),new p$Sh(136,"vector4",37)])}])}(),function(){function p$h(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U,p$u,p$v){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=p$h,this._positionStartLifeTime=p$q,this._velocity=p$f,this._startColor=p$g,this._startSize=p$$,this._startRotation0=p$P,this._startRotation1=p$S,this._startRotation2=p$B,this._startLifeTime=p$r,this._time=p$Y,this._startSpeed=p$C,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=p$v}p$v(p$h,"laya.d3.graphics.VertexShurikenParticleMesh");var p$q=p$h.prototype;p$E.imps(p$q,{"laya.d3.graphics.IVertex":!0}),p$L(0,p$q,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),p$L(0,p$q,"velocity",function(){return this._velocity}),p$L(0,p$q,"position",function(){return this._positionStartLifeTime}),p$L(0,p$q,"random0",function(){return this._randoms0}),p$L(0,p$q,"startSize",function(){return this._startSize}),p$L(0,p$q,"startColor",function(){return this._startColor}),p$L(0,p$q,"startRotation0",function(){return this._startRotation0}),p$L(0,p$q,"startRotation1",function(){return this._startRotation1}),p$L(0,p$q,"random1",function(){return this._randoms1}),p$L(0,p$q,"startRotation2",function(){return this._startRotation2}),p$L(0,p$q,"startLifeTime",function(){return this._startLifeTime}),p$L(0,p$q,"time",function(){return this._time}),p$L(0,p$q,"startSpeed",function(){return this._startSpeed}),p$L(0,p$q,"simulationWorldPostion",function(){return this._simulationWorldPostion}),p$L(0,p$q,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$L(1,p$h,"vertexDeclaration",function(){return p$h._vertexDeclaration}),p$U(p$h,["_vertexDeclaration",function(){return this._vertexDeclaration=new p$Ph(172,[new p$Sh(0,"vector3",0),new p$Sh(12,"vector4",1),new p$Sh(28,"vector2",2),new p$Sh(36,"vector4",30),new p$Sh(52,"vector4",32),new p$Sh(68,"vector4",19),new p$Sh(84,"vector3",20),new p$Sh(96,"vector3",22),new p$Sh(108,"single",31),new p$Sh(112,"vector4",34),new p$Sh(128,"vector4",35),new p$Sh(144,"vector3",36),new p$Sh(156,"vector4",37)])}])}(),function(){function p$G(p$h,p$q,p$f,p$g,p$$,p$P){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=p$f,this._materials=p$g,this._subMeshes=p$$,this._materialMap=p$P,this._version=p$q,this._onLoaded(p$h)}p$v(p$G,"laya.d3.loaders.LoadModelV01");var p$h=p$G.prototype;return p$h._onLoaded=function(p$h){this._readData=p$h,this.READ_BLOCK();for(var p$q=0;p$q<this._BLOCK.count;p$q++){var p$f=this._readData.getUint16(),p$g=this._strings[p$f],p$$=this["READ_"+p$g];if(null==p$$)throw new Error("model file err,no this function:"+p$f+" "+p$g);if(!p$$.call(this))break}return this._mesh},p$h.onError=function(){},p$h._readString=function(){return this._strings[this._readData.getUint16()]},p$h.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},p$h.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},p$h.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var p$h=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var p$q=0;p$q<this._STRINGS.size;p$q++)this._strings[p$q]=this._readData.readUTFString();return this._readData.pos=p$h,!0},p$h.READ_MATERIAL=function(){var p$h=this._readData.getUint16(),p$q=(this._readString(),this._readString());return this._materials[p$h]="null"!==p$q?p$_.getRes(this._materialMap[p$q]):new p$Aq,!0},p$h.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var p$h,p$q=this._readData.__getBuffer(),p$f=0,p$g=this._readData.getUint32(),p$$=this._readData.getUint32(),p$P=(new Float32Array(p$q.slice(p$g+this._DATA.offset,p$g+this._DATA.offset+p$$)),this._readData.getUint32()),p$S=this._readData.getUint32(),p$B=new Float32Array(p$q.slice(p$P+this._DATA.offset,p$P+this._DATA.offset+p$S));for(this.mesh._inverseBindPoses=[],p$f=0,p$h=p$B.length;p$f<p$h;p$f+=16){var p$r=new p$hq(p$B[p$f+0],p$B[p$f+1],p$B[p$f+2],p$B[p$f+3],p$B[p$f+4],p$B[p$f+5],p$B[p$f+6],p$B[p$f+7],p$B[p$f+8],p$B[p$f+9],p$B[p$f+10],p$B[p$f+11],p$B[p$f+12],p$B[p$f+13],p$B[p$f+14],p$B[p$f+15]);this.mesh._inverseBindPoses.push(p$r)}break;default:throw new Error("LoadModel:unknown version.")}return!0},p$h.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var p$h=this._readString();this._shaderAttributes=p$h.match(p$G._attrReg);var p$q=this._readData.getUint32(),p$f=this._readData.getUint32(),p$g=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),p$$=this._readData.getUint32(),p$P=this._readData.getUint32(),p$S=this._readData.getUint32(),p$B=this._readData.__getBuffer(),p$r=new p$Yq(this._mesh),p$Y=this._getVertexDeclaration(),p$C=p$wq.create(p$Y,p$$/p$Y.vertexStride,35044,!0),p$U=p$g+this._DATA.offset,p$u=p$B.slice(p$U,p$U+p$$);p$C.setData(new Float32Array(p$u));for(var p$v=(p$r._vertexBuffer=p$C).vertexDeclaration.getVertexElements(),p$L=0;p$L<p$v.length;p$L++)p$r._bufferUsage[p$v[p$L].elementUsage]=p$C;var p$e=p$Iq.create("ushort",p$f/2,35044,!0),p$l=p$q+this._DATA.offset,p$_=p$B.slice(p$l,p$l+p$f);p$e.setData(new Uint16Array(p$_)),p$r._indexBuffer=p$e;var p$N=p$B.slice(p$P+this._DATA.offset,p$P+this._DATA.offset+p$S);return p$r._boneIndicesList[0]=new Uint8Array(p$N),this._subMeshes.push(p$r),!0},p$h.READ_DATAAREA=function(){return!1},p$h._getVertexDeclaration=function(){for(var p$h,p$q=!1,p$f=!1,p$g=!1,p$$=!1,p$P=!1,p$S=!1,p$B=!1,p$r=!1,p$Y=!1,p$C=0;p$C<this._shaderAttributes.length;p$C+=8)switch(this._shaderAttributes[p$C]){case"POSITION":p$q=!0;break;case"NORMAL":p$f=!0;break;case"COLOR":p$g=!0;break;case"UV":p$$=!0;break;case"UV1":p$P=!0;break;case"BLENDWEIGHT":p$B=!0;break;case"BLENDINDICES":p$r=!0;break;case"TANGENT":p$S=!0;break;case"BINORMAL":p$Y=!0}return p$q&&p$f&&p$g&&p$$&&p$P&&p$B&&p$r&&p$S?p$h=p$Gh.vertexDeclaration:p$q&&p$f&&p$g&&p$$&&p$P&&p$B&&p$r?p$h=p$_h.vertexDeclaration:p$q&&p$f&&p$$&&p$P&&p$B&&p$r&&p$S?p$h=p$ch.vertexDeclaration:p$q&&p$f&&p$$&&p$P&&p$B&&p$r?p$h=p$ih.vertexDeclaration:p$q&&p$f&&p$g&&p$$&&p$B&&p$r&&p$S?p$h=p$Xh.vertexDeclaration:p$q&&p$f&&p$g&&p$$&&p$B&&p$r?p$h=p$Rh.vertexDeclaration:p$q&&p$f&&p$S&&p$Y&&p$$&&p$B&&p$r?p$h=p$Vh.vertexDeclaration:p$q&&p$f&&p$$&&p$B&&p$r&&p$S?p$h=p$wh.vertexDeclaration:p$q&&p$f&&p$$&&p$B&&p$r?p$h=p$Th.vertexDeclaration:p$q&&p$f&&p$g&&p$B&&p$r&&p$S?p$h=p$uh.vertexDeclaration:p$q&&p$f&&p$g&&p$B&&p$r?p$h=p$Ch.vertexDeclaration:p$q&&p$f&&p$g&&p$$&&p$P&&p$S?p$h=p$Eh.vertexDeclaration:p$q&&p$f&&p$g&&p$$&&p$P?p$h=p$lh.vertexDeclaration:p$q&&p$f&&p$$&&p$P&&p$S?p$h=p$Wh.vertexDeclaration:p$q&&p$f&&p$$&&p$P?p$h=p$bh.vertexDeclaration:p$q&&p$f&&p$g&&p$$&&p$S?p$h=p$Jh.vertexDeclaration:p$q&&p$f&&p$$&&p$S&&p$Y?p$h=p$Dh.vertexDeclaration:p$q&&p$f&&p$g&&p$$?p$h=p$eh.vertexDeclaration:p$q&&p$f&&p$$&&p$S?p$h=p$Hh.vertexDeclaration:p$q&&p$f&&p$$?p$h=p$dh.vertexDeclaration:p$q&&p$f&&p$g&&p$S?p$h=p$Lh.vertexDeclaration:p$q&&p$f&&p$g&&(p$h=p$Yh.vertexDeclaration),p$h},p$L(0,p$h,"mesh",function(){return this._mesh}),p$G._attrReg=new RegExp("(\\w+)|([:,;])","g"),p$G}()),p$Fh=function(){function p$t(){}return p$v(p$t,"laya.d3.loaders.LoadModelV02"),p$t.parse=function(p$h,p$q,p$f,p$g,p$$,p$P){p$t._mesh=p$f,p$t._materials=p$g,p$t._subMeshes=p$$,p$t._materialMap=p$P,p$t._version=p$q,p$t._readData=p$h,p$t.READ_DATA(),p$t.READ_BLOCK(),p$t.READ_STRINGS();for(var p$S=0,p$B=p$t._BLOCK.count;p$S<p$B;p$S++){p$t._readData.pos=p$t._BLOCK.blockStarts[p$S];var p$r=p$t._readData.getUint16(),p$Y=p$t._strings[p$r],p$C=p$t["READ_"+p$Y];if(null==p$C)throw new Error("model file err,no this function:"+p$r+" "+p$Y);p$C.call()}p$t._strings.length=0,p$t._readData=null,p$t._version=null,p$t._mesh=null,p$t._materials=null,p$t._subMeshes=null,p$t._materialMap=null},p$t._readString=function(){return p$t._strings[p$t._readData.getUint16()]},p$t.READ_DATA=function(){p$t._DATA.offset=p$t._readData.getUint32(),p$t._DATA.size=p$t._readData.getUint32()},p$t.READ_BLOCK=function(){for(var p$h=p$t._BLOCK.count=p$t._readData.getUint16(),p$q=p$t._BLOCK.blockStarts=[],p$f=p$t._BLOCK.blockLengths=[],p$g=0;p$g<p$h;p$g++)p$q.push(p$t._readData.getUint32()),p$f.push(p$t._readData.getUint32())},p$t.READ_STRINGS=function(){var p$h=p$t._readData.getUint32(),p$q=p$t._readData.getUint16(),p$f=p$t._readData.pos;p$t._readData.pos=p$h+p$t._DATA.offset;for(var p$g=0;p$g<p$q;p$g++)p$t._strings[p$g]=p$t._readData.readUTFString();p$t._readData.pos=p$f},p$t.READ_MATERIAL=function(){p$t._readString(),p$t._readString();var p$h=p$t._readString();return""!==p$h&&p$t._materials.push(p$_.getRes(p$t._materialMap[p$h])),!0},p$t.READ_MESH=function(){p$t._readString();var p$h,p$q=p$t._readData.__getBuffer(),p$f=0,p$g=p$t._readData.getInt16(),p$$=p$t._DATA.offset;for(p$f=0;p$f<p$g;p$f++){var p$P=p$$+p$t._readData.getUint32(),p$S=p$t._readData.getUint32(),p$B=new Float32Array(p$q.slice(p$P,p$P+p$S)),p$r=p$t._readString().match(p$t._attrReg),p$Y=p$t._getVertexDeclaration(p$r),p$C=p$wq.create(p$Y,4*p$B.length/p$Y.vertexStride,35044,!0);p$C.setData(p$B),p$t._mesh._vertexBuffers.push(p$C)}var p$U=p$$+p$t._readData.getUint32(),p$u=p$t._readData.getUint32(),p$v=new Uint16Array(p$q.slice(p$U,p$U+p$u)),p$L=p$Iq.create("ushort",p$u/2,35044,!0);p$L.setData(p$v),p$t._mesh._indexBuffer=p$L;var p$e=p$t._mesh._boneNames=[],p$l=p$t._readData.getUint16();for(p$e.length=p$l,p$f=0;p$f<p$l;p$f++)p$e[p$f]=p$t._strings[p$t._readData.getUint16()];var p$_=p$t._readData.getUint32(),p$N=p$t._readData.getUint32(),p$G=(new Float32Array(p$q.slice(p$$+p$_,p$$+p$_+p$N)),p$t._readData.getUint32()),p$m=p$t._readData.getUint32(),p$E=new Float32Array(p$q.slice(p$$+p$G,p$$+p$G+p$m));for(p$t._mesh._inverseBindPoses=[],p$f=0,p$h=p$E.length;p$f<p$h;p$f+=16){var p$R=new p$hq(p$E[p$f+0],p$E[p$f+1],p$E[p$f+2],p$E[p$f+3],p$E[p$f+4],p$E[p$f+5],p$E[p$f+6],p$E[p$f+7],p$E[p$f+8],p$E[p$f+9],p$E[p$f+10],p$E[p$f+11],p$E[p$f+12],p$E[p$f+13],p$E[p$f+14],p$E[p$f+15]);p$t._mesh._inverseBindPoses.push(p$R)}return p$t._mesh._skinnedDatas=new Float32Array(16*p$E.length),!0},p$t.READ_SUBMESH=function(){var p$h=p$t._readData.__getBuffer(),p$q=new p$Yq(p$t._mesh),p$f=p$t._readData.getInt16(),p$g=p$t._readData.getUint32(),p$$=p$t._readData.getUint32();p$q._vertexBuffer=p$t._mesh._vertexBuffers[p$f],p$q._vertexStart=p$g,p$q._vertexCount=p$$;var p$P=p$t._readData.getUint32(),p$S=p$t._readData.getUint32(),p$B=p$t._mesh._indexBuffer;p$q._indexBuffer=p$B,p$q._indexStart=p$P,p$q._indexCount=p$S,p$q._indices=new Uint16Array(p$B.getData().buffer,2*p$P,p$S);var p$r=p$t._DATA.offset,p$Y=p$q._subIndexBufferStart,p$C=p$q._subIndexBufferCount,p$U=p$q._boneIndicesList,p$u=p$t._readData.getUint16();p$Y.length=p$u,p$C.length=p$u,p$U.length=p$u;for(var p$v=0;p$v<p$u;p$v++){p$Y[p$v]=p$t._readData.getUint32(),p$C[p$v]=p$t._readData.getUint32();var p$L=p$t._readData.getUint32(),p$e=p$t._readData.getUint32();p$q._boneIndicesList[p$v]=new Uint8Array(p$h.slice(p$r+p$L,p$r+p$L+p$e))}return p$t._subMeshes.push(p$q),!0},p$t._getVertexDeclaration=function(p$h){for(var p$q,p$f=!1,p$g=!1,p$$=!1,p$P=!1,p$S=!1,p$B=!1,p$r=!1,p$Y=!1,p$C=!1,p$U=0;p$U<p$h.length;p$U++)switch(p$h[p$U]){case"POSITION":p$f=!0;break;case"NORMAL":p$g=!0;break;case"COLOR":p$$=!0;break;case"UV":p$P=!0;break;case"UV1":p$S=!0;break;case"BLENDWEIGHT":p$r=!0;break;case"BLENDINDICES":p$Y=!0;break;case"TANGENT":p$B=!0;break;case"BINORMAL":p$C=!0}return p$f&&p$g&&p$$&&p$P&&p$S&&p$r&&p$Y&&p$B?p$q=p$Gh.vertexDeclaration:p$f&&p$g&&p$$&&p$P&&p$S&&p$r&&p$Y?p$q=p$_h.vertexDeclaration:p$f&&p$g&&p$P&&p$S&&p$r&&p$Y&&p$B?p$q=p$ch.vertexDeclaration:p$f&&p$g&&p$P&&p$S&&p$r&&p$Y?p$q=p$ih.vertexDeclaration:p$f&&p$g&&p$$&&p$P&&p$r&&p$Y&&p$B?p$q=p$Xh.vertexDeclaration:p$f&&p$g&&p$$&&p$P&&p$r&&p$Y?p$q=p$Rh.vertexDeclaration:p$f&&p$g&&p$P&&p$r&&p$Y&&p$B?p$q=p$wh.vertexDeclaration:p$f&&p$g&&p$P&&p$r&&p$Y?p$q=p$Th.vertexDeclaration:p$f&&p$g&&p$$&&p$r&&p$Y&&p$B?p$q=p$uh.vertexDeclaration:p$f&&p$g&&p$$&&p$r&&p$Y?p$q=p$Ch.vertexDeclaration:p$f&&p$g&&p$$&&p$P&&p$S&&p$B?p$q=p$Eh.vertexDeclaration:p$f&&p$g&&p$$&&p$P&&p$S?p$q=p$lh.vertexDeclaration:p$f&&p$g&&p$P&&p$S&&p$B?p$q=p$Wh.vertexDeclaration:p$f&&p$g&&p$P&&p$S?p$q=p$bh.vertexDeclaration:p$f&&p$g&&p$$&&p$P&&p$B?p$q=p$Jh.vertexDeclaration:p$f&&p$g&&p$P&&p$B&&p$C?p$q=p$Dh.vertexDeclaration:p$f&&p$g&&p$$&&p$P?p$q=p$eh.vertexDeclaration:p$f&&p$g&&p$P&&p$B?p$q=p$Hh.vertexDeclaration:p$f&&p$g&&p$P?p$q=p$dh.vertexDeclaration:p$f&&p$g&&p$$&&p$B?p$q=p$Lh.vertexDeclaration:p$f&&p$g&&p$$&&(p$q=p$Yh.vertexDeclaration),p$q},p$t._attrReg=new RegExp("(\\w+)|([:,;])","g"),p$t._strings=[],p$t._readData=null,p$t._version=null,p$t._mesh=null,p$t._materials=null,p$t._subMeshes=null,p$t._materialMap=null,p$U(p$t,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),p$t}(),p$Zh=function(){function p$R(){}return p$v(p$R,"laya.d3.loaders.LoadModelV03"),p$R.parse=function(p$h,p$q,p$f,p$g,p$$){p$R._mesh=p$f,p$R._subMeshes=p$g,p$R._materialMap=p$$,p$R._version=p$q,p$R._readData=p$h,p$R.READ_DATA(),p$R.READ_BLOCK(),p$R.READ_STRINGS();for(var p$P=0,p$S=p$R._BLOCK.count;p$P<p$S;p$P++){p$R._readData.pos=p$R._BLOCK.blockStarts[p$P];var p$B=p$R._readData.getUint16(),p$r=p$R._strings[p$B],p$Y=p$R["READ_"+p$r];if(null==p$Y)throw new Error("model file err,no this function:"+p$B+" "+p$r);p$Y.call()}p$R._strings.length=0,p$R._readData=null,p$R._version=null,p$R._mesh=null,p$R._subMeshes=null,p$R._materialMap=null},p$R._readString=function(){return p$R._strings[p$R._readData.getUint16()]},p$R.READ_DATA=function(){p$R._DATA.offset=p$R._readData.getUint32(),p$R._DATA.size=p$R._readData.getUint32()},p$R.READ_BLOCK=function(){for(var p$h=p$R._BLOCK.count=p$R._readData.getUint16(),p$q=p$R._BLOCK.blockStarts=[],p$f=p$R._BLOCK.blockLengths=[],p$g=0;p$g<p$h;p$g++)p$q.push(p$R._readData.getUint32()),p$f.push(p$R._readData.getUint32())},p$R.READ_STRINGS=function(){var p$h=p$R._readData.getUint32(),p$q=p$R._readData.getUint16(),p$f=p$R._readData.pos;p$R._readData.pos=p$h+p$R._DATA.offset;for(var p$g=0;p$g<p$q;p$g++)p$R._strings[p$g]=p$R._readData.readUTFString();p$R._readData.pos=p$f},p$R.READ_MESH=function(){var p$h,p$q=p$R._readString(),p$f=p$R._readData.__getBuffer(),p$g=0,p$$=p$R._readData.getInt16(),p$P=p$R._DATA.offset;for(p$g=0;p$g<p$$;p$g++){var p$S,p$B=p$P+p$R._readData.getUint32(),p$r=p$R._readData.getUint32(),p$Y=new Float32Array(p$f.slice(p$B,p$B+p$r)),p$C=p$R._readString();switch(p$R._version){case"LAYAMODEL:03":p$S=p$R._vertexDeclarationMap_Discard[p$C];break;case"LAYAMODEL:0301":p$S=p$R._vertexDeclarationMap[p$C];break;default:throw new Error("LoadModelV03: unknown version.")}if(!p$S)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+p$R._version+"  bufferAttribute="+p$C+"  name="+p$q+"  url="+(p$R._mesh?p$R._mesh.url:"null"));var p$U=p$wq.create(p$S,4*p$Y.length/p$S.vertexStride,35044,!0,p$R._mesh._url+"_"+p$g);p$U.setData(p$Y),p$R._mesh._vertexBuffers.push(p$U)}var p$u=p$P+p$R._readData.getUint32(),p$v=p$R._readData.getUint32(),p$L=new Uint16Array(p$f.slice(p$u,p$u+p$v)),p$e=p$Iq.create("ushort",p$v/2,35044,!0,p$R._mesh._url);p$e.setData(p$L),p$R._mesh._indexBuffer=p$e;var p$l=p$R._mesh._boneNames=[],p$_=p$R._readData.getUint16();for(p$l.length=p$_,p$g=0;p$g<p$_;p$g++)p$l[p$g]=p$R._strings[p$R._readData.getUint16()];p$R._readData.pos+=8;var p$N=p$R._readData.getUint32(),p$G=p$R._readData.getUint32(),p$m=new Float32Array(p$f.slice(p$P+p$N,p$P+p$N+p$G));for(p$R._mesh._inverseBindPoses=[],p$g=0,p$h=p$m.length;p$g<p$h;p$g+=16){var p$E=new p$hq(p$m[p$g+0],p$m[p$g+1],p$m[p$g+2],p$m[p$g+3],p$m[p$g+4],p$m[p$g+5],p$m[p$g+6],p$m[p$g+7],p$m[p$g+8],p$m[p$g+9],p$m[p$g+10],p$m[p$g+11],p$m[p$g+12],p$m[p$g+13],p$m[p$g+14],p$m[p$g+15]);p$R._mesh._inverseBindPoses.push(p$E)}return p$R._mesh._skinnedDatas=new Float32Array(16*p$m.length),!0},p$R.READ_SUBMESH=function(){var p$h=p$R._readData.__getBuffer(),p$q=new p$Yq(p$R._mesh),p$f=p$R._readData.getInt16(),p$g=p$R._readData.getUint32(),p$$=p$R._readData.getUint32();p$q._vertexBuffer=p$R._mesh._vertexBuffers[p$f],p$q._vertexStart=p$g,p$q._vertexCount=p$$;var p$P=p$R._readData.getUint32(),p$S=p$R._readData.getUint32(),p$B=p$R._mesh._indexBuffer;p$q._indexBuffer=p$B,p$q._indexStart=p$P,p$q._indexCount=p$S,p$q._indices=new Uint16Array(p$B.getData().buffer,2*p$P,p$S);var p$r=p$R._DATA.offset,p$Y=p$q._subIndexBufferStart,p$C=p$q._subIndexBufferCount,p$U=p$q._boneIndicesList,p$u=p$R._readData.getUint16();p$Y.length=p$u,p$C.length=p$u,p$U.length=p$u;for(var p$v=0;p$v<p$u;p$v++){p$Y[p$v]=p$R._readData.getUint32(),p$C[p$v]=p$R._readData.getUint32();var p$L=p$R._readData.getUint32(),p$e=p$R._readData.getUint32();p$U[p$v]=new Uint8Array(p$h.slice(p$r+p$L,p$r+p$L+p$e))}return p$R._subMeshes.push(p$q),!0},p$R._strings=[],p$R._readData=null,p$R._version=null,p$R._mesh=null,p$R._subMeshes=null,p$R._materialMap=null,p$U(p$R,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":p$Gh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":p$_h.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":p$sh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":p$ch.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":p$ih.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":p$Xh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":p$Rh.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":p$wh.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":p$Th.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":p$uh.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":p$Ch.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":p$Eh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":p$lh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":p$Wh.vertexDeclaration,"POSITION,NORMAL,UV,UV1":p$bh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":p$Jh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":p$Dh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":p$eh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":p$Hh.vertexDeclaration,"POSITION,NORMAL,UV":p$dh.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":p$Lh.vertexDeclaration,"POSITION,NORMAL,COLOR":p$Yh.vertexDeclaration,"POSITION,NORMAL,TANGENT":p$Ah.vertexDeclaration,"POSITION,NORMAL":p$rh.vertexDeclaration,"POSITION,UV":p$Kh.vertexDeclaration,POSITION:p$Bh.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":p$Nh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":p$_h.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":p$sh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":p$zh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":p$ih.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":p$th.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":p$Rh.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":p$Ih.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":p$Th.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":p$Uh.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":p$Ch.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":p$mh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":p$lh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":p$Mh.vertexDeclaration,"POSITION,NORMAL,UV,UV1":p$bh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":p$nh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":p$Dh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":p$eh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":p$kh.vertexDeclaration,"POSITION,NORMAL,UV":p$dh.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":p$vh.vertexDeclaration,"POSITION,NORMAL,COLOR":p$Yh.vertexDeclaration,"POSITION,NORMAL,TANGENT":p$ph.vertexDeclaration,"POSITION,NORMAL":p$rh.vertexDeclaration,"POSITION,UV":p$Kh.vertexDeclaration,POSITION:p$Bh.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),p$R}(),p$Qh=function(){function p$B(){}return p$v(p$B,"laya.d3.loaders.MeshReader"),p$B.read=function(p$h,p$q,p$f,p$g,p$$){var p$P=new p$R(p$h);p$P.pos=0;var p$S=p$P.readUTFString();switch(p$S){case"LAYAMODEL:01":case"LAYASKINANI:01":p$B._readVersion01(p$P,p$S,p$q,p$f,p$g,p$$);break;case"LAYAMODEL:02":p$Fh.parse(p$P,p$S,p$q,p$f,p$g,p$$);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":p$Zh.parse(p$P,p$S,p$q,p$g,p$$);break;default:throw new Error("MeshReader: unknown mesh version.")}p$q._setSubMeshes(p$g)},p$B._readVersion01=function(p$h,p$q,p$f,p$g,p$$,p$P){new p$yh(p$h,p$q,p$f,p$g,p$$,p$P)},p$B}(),p$oh=function(){function p$h(p$h,p$q){this.min=null,this.max=null,this.min=p$h,this.max=p$q}p$v(p$h,"laya.d3.math.BoundBox");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.getCorners=function(p$h){p$h.length=8;var p$q=this.min.elements,p$f=this.max.elements,p$g=p$q[0],p$$=p$q[1],p$P=p$q[2],p$S=p$f[0],p$B=p$f[1],p$r=p$f[2];p$h[0]=new p$Sq(p$g,p$B,p$r),p$h[1]=new p$Sq(p$S,p$B,p$r),p$h[2]=new p$Sq(p$S,p$$,p$r),p$h[3]=new p$Sq(p$g,p$$,p$r),p$h[4]=new p$Sq(p$g,p$B,p$P),p$h[5]=new p$Sq(p$S,p$B,p$P),p$h[6]=new p$Sq(p$S,p$$,p$P),p$h[7]=new p$Sq(p$g,p$$,p$P)},p$q.toDefault=function(){this.min.toDefault(),this.max.toDefault()},p$q.cloneTo=function(p$h){var p$q=p$h;this.min.cloneTo(p$q.min),this.max.cloneTo(p$q.max)},p$q.clone=function(){var p$h=new this.constructor(new p$Sq,new p$Sq);return this.cloneTo(p$h),p$h},p$h.createfromPoints=function(p$h,p$q){if(null==p$h)throw new Error("points");var p$f=p$q.min,p$g=p$q.max,p$$=p$f.elements;p$$[0]=Number.MAX_VALUE,p$$[1]=Number.MAX_VALUE,p$$[2]=Number.MAX_VALUE;var p$P=p$g.elements;p$P[0]=-Number.MAX_VALUE,p$P[1]=-Number.MAX_VALUE,p$P[2]=-Number.MAX_VALUE;for(var p$S=0,p$B=p$h.length;p$S<p$B;++p$S)p$Sq.min(p$f,p$h[p$S],p$f),p$Sq.max(p$g,p$h[p$S],p$g)},p$h.merge=function(p$h,p$q,p$f){p$Sq.min(p$h.min,p$q.min,p$f.min),p$Sq.max(p$h.max,p$q.max,p$f.max)},p$h}(),p$Oh=function(){function p$Y(p$h){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=p$h,this._near=new p$qq(new p$Sq),this._far=new p$qq(new p$Sq),this._left=new p$qq(new p$Sq),this._right=new p$qq(new p$Sq),this._top=new p$qq(new p$Sq),this._bottom=new p$qq(new p$Sq),p$Y._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}p$v(p$Y,"laya.d3.math.BoundFrustum");var p$h=p$Y.prototype;return p$h.equalsBoundFrustum=function(p$h){return this._matrix.equalsOtherMatrix(p$h.matrix)},p$h.equalsObj=function(p$h){if(p$h instanceof laya.d3.math.BoundFrustum){var p$q=p$h;return this.equalsBoundFrustum(p$q)}return!1},p$h.getPlane=function(p$h){switch(p$h){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},p$h.getCorners=function(p$h){p$Y._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(p$h[0]),p$Y._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(p$h[1]),p$Y._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(p$h[2]),p$Y._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(p$h[3]),p$Y._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(p$h[4]),p$Y._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(p$h[5]),p$Y._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(p$h[6]),p$Y._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(p$h[7])},p$h.containsPoint=function(p$h){for(var p$q=p$qq.PlaneIntersectionType_Front,p$f=p$qq.PlaneIntersectionType_Front,p$g=0;p$g<6;p$g++){switch(p$g){case 0:p$f=Collision.intersectsPlaneAndPoint(this._near,p$h);break;case 1:p$f=Collision.intersectsPlaneAndPoint(this._far,p$h);break;case 2:p$f=Collision.intersectsPlaneAndPoint(this._left,p$h);break;case 3:p$f=Collision.intersectsPlaneAndPoint(this._right,p$h);break;case 4:p$f=Collision.intersectsPlaneAndPoint(this._top,p$h);break;case 5:p$f=Collision.intersectsPlaneAndPoint(this._bottom,p$h)}switch(p$f){case p$qq.PlaneIntersectionType_Back:return 0;case p$qq.PlaneIntersectionType_Intersecting:p$q=p$qq.PlaneIntersectionType_Intersecting}}switch(p$q){case p$qq.PlaneIntersectionType_Intersecting:return 2;default:return 1}},p$h.containsBoundBox=function(p$h){for(var p$q,p$f=p$Y._tempV30,p$g=p$Y._tempV31,p$$=1,p$P=0;p$P<6;p$P++){if(p$q=this.getPlane(p$P),this._getBoxToPlanePVertexNVertex(p$h,p$q.normal,p$f,p$g),Collision.intersectsPlaneAndPoint(p$q,p$f)===p$qq.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(p$q,p$g)===p$qq.PlaneIntersectionType_Back&&(p$$=2)}return p$$},p$h.containsBoundSphere=function(p$h){for(var p$q=p$qq.PlaneIntersectionType_Front,p$f=p$qq.PlaneIntersectionType_Front,p$g=0;p$g<6;p$g++){switch(p$g){case 0:p$f=Collision.intersectsPlaneAndSphere(this._near,p$h);break;case 1:p$f=Collision.intersectsPlaneAndSphere(this._far,p$h);break;case 2:p$f=Collision.intersectsPlaneAndSphere(this._left,p$h);break;case 3:p$f=Collision.intersectsPlaneAndSphere(this._right,p$h);break;case 4:p$f=Collision.intersectsPlaneAndSphere(this._top,p$h);break;case 5:p$f=Collision.intersectsPlaneAndSphere(this._bottom,p$h)}switch(p$f){case p$qq.PlaneIntersectionType_Back:return 0;case p$qq.PlaneIntersectionType_Intersecting:p$q=p$qq.PlaneIntersectionType_Intersecting}}switch(p$q){case p$qq.PlaneIntersectionType_Intersecting:return 2;default:return 1}},p$h._getBoxToPlanePVertexNVertex=function(p$h,p$q,p$f,p$g){var p$$=p$h.min,p$P=p$$.elements,p$S=p$h.max,p$B=p$S.elements,p$r=p$q.elements,p$Y=p$r[0],p$C=p$r[1],p$U=p$r[2];p$$.cloneTo(p$f);var p$u=p$f.elements;0<=p$Y&&(p$u[0]=p$B[0]),0<=p$C&&(p$u[1]=p$B[1]),0<=p$U&&(p$u[2]=p$B[2]),p$S.cloneTo(p$g);var p$v=p$g.elements;0<=p$Y&&(p$v[0]=p$P[0]),0<=p$C&&(p$v[1]=p$P[1]),0<=p$U&&(p$v[2]=p$P[2])},p$L(0,p$h,"top",function(){return this._top}),p$L(0,p$h,"matrix",function(){return this._matrix},function(p$h){this._matrix=p$h,p$Y._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),p$L(0,p$h,"near",function(){return this._near}),p$L(0,p$h,"far",function(){return this._far}),p$L(0,p$h,"left",function(){return this._left}),p$L(0,p$h,"right",function(){return this._right}),p$L(0,p$h,"bottom",function(){return this._bottom}),p$Y._getPlanesFromMatrix=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){var p$B=p$h.elements,p$r=p$B[0],p$Y=p$B[1],p$C=p$B[2],p$U=p$B[3],p$u=p$B[4],p$v=p$B[5],p$L=p$B[6],p$e=p$B[7],p$l=p$B[8],p$_=p$B[9],p$N=p$B[10],p$G=p$B[11],p$m=p$B[12],p$E=p$B[13],p$R=p$B[14],p$t=p$B[15],p$X=p$q.normal.elements;p$X[0]=p$U+p$C,p$X[1]=p$e+p$L,p$X[2]=p$G+p$N,p$q.distance=p$t+p$R,p$q.normalize();var p$n=p$f.normal.elements;p$n[0]=p$U-p$C,p$n[1]=p$e-p$L,p$n[2]=p$G-p$N,p$f.distance=p$t-p$R,p$f.normalize();var p$J=p$g.normal.elements;p$J[0]=p$U+p$r,p$J[1]=p$e+p$u,p$J[2]=p$G+p$l,p$g.distance=p$t+p$m,p$g.normalize();var p$p=p$$.normal.elements;p$p[0]=p$U-p$r,p$p[1]=p$e-p$u,p$p[2]=p$G-p$l,p$$.distance=p$t-p$m,p$$.normalize();var p$A=p$P.normal.elements;p$A[0]=p$U-p$Y,p$A[1]=p$e-p$v,p$A[2]=p$G-p$_,p$P.distance=p$t-p$E,p$P.normalize();var p$d=p$S.normal.elements;p$d[0]=p$U+p$Y,p$d[1]=p$e+p$v,p$d[2]=p$G+p$_,p$S.distance=p$t+p$E,p$S.normalize()},p$Y._get3PlaneInterPoint=function(p$h,p$q,p$f){var p$g=p$h.normal,p$$=p$q.normal,p$P=p$f.normal;p$Sq.cross(p$$,p$P,p$Y._tempV30),p$Sq.cross(p$P,p$g,p$Y._tempV31),p$Sq.cross(p$g,p$$,p$Y._tempV32);var p$S=p$Sq.dot(p$g,p$Y._tempV30),p$B=p$Sq.dot(p$$,p$Y._tempV31),p$r=p$Sq.dot(p$P,p$Y._tempV32);return p$Sq.scale(p$Y._tempV30,-p$h.distance/p$S,p$Y._tempV33),p$Sq.scale(p$Y._tempV31,-p$q.distance/p$B,p$Y._tempV34),p$Sq.scale(p$Y._tempV32,-p$f.distance/p$r,p$Y._tempV35),p$Sq.add(p$Y._tempV33,p$Y._tempV34,p$Y._tempV36),p$Sq.add(p$Y._tempV35,p$Y._tempV36,p$Y._tempV37),p$Y._tempV37},p$U(p$Y,["_tempV30",function(){return this._tempV30=new p$Sq},"_tempV31",function(){return this._tempV31=new p$Sq},"_tempV32",function(){return this._tempV32=new p$Sq},"_tempV33",function(){return this._tempV33=new p$Sq},"_tempV34",function(){return this._tempV34=new p$Sq},"_tempV35",function(){return this._tempV35=new p$Sq},"_tempV36",function(){return this._tempV36=new p$Sq},"_tempV37",function(){return this._tempV37=new p$Sq}]),p$Y}(),p$jh=function(){function p$C(p$h,p$q){this.center=null,this.radius=NaN,this.center=p$h,this.radius=p$q}p$v(p$C,"laya.d3.math.BoundSphere");var p$h=p$C.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.toDefault=function(){this.center.toDefault(),this.radius=0},p$h.intersectsRayDistance=function(p$h){return Collision.intersectsRayAndSphereRD(p$h,this)},p$h.intersectsRayPoint=function(p$h,p$q){return Collision.intersectsRayAndSphereRP(p$h,this,p$q)},p$h.cloneTo=function(p$h){var p$q=p$h;this.center.cloneTo(p$q.center),p$q.radius=this.radius},p$h.clone=function(){var p$h=new this.constructor(new p$Sq,new p$Sq);return this.cloneTo(p$h),p$h},p$C.createFromSubPoints=function(p$h,p$q,p$f,p$g){if(null==p$h)throw new Error("points");if(p$q<0||p$q>=p$h.length)throw new Error("start"+p$q+"Must be in the range [0, "+(p$h.length-1)+"]");if(p$f<0||p$q+p$f>p$h.length)throw new Error("count"+p$f+"Must be in the range <= "+p$h.length+"}");var p$$=p$q+p$f,p$P=p$C._tempVector3;p$P.elements[0]=0,p$P.elements[1]=0,p$P.elements[2]=0;for(var p$S=p$q;p$S<p$$;++p$S)p$Sq.add(p$h[p$S],p$P,p$P);var p$B=p$g.center;p$Sq.scale(p$P,1/p$f,p$B);var p$r=0;for(p$S=p$q;p$S<p$$;++p$S){var p$Y=p$Sq.distanceSquared(p$B,p$h[p$S]);p$r<p$Y&&(p$r=p$Y)}p$g.radius=Math.sqrt(p$r)},p$C.createfromPoints=function(p$h,p$q){if(null==p$h)throw new Error("points");p$C.createFromSubPoints(p$h,0,p$h.length,p$q)},p$U(p$C,["_tempVector3",function(){return this._tempVector3=new p$Sq}]),p$C}(),p$xh=(function(){function p$h(){}p$v(p$h,"laya.d3.math.ContainmentType"),p$h.Disjoint=0,p$h.Contains=1,p$h.Intersects=2}(),function(){function p$f(){}return p$v(p$f,"laya.d3.math.MathUtils3D"),p$f.isZero=function(p$h){return Math.abs(p$h)<p$f.zeroTolerance},p$f.nearEqual=function(p$h,p$q){return!!p$f.isZero(p$h-p$q)},p$f.fastInvSqrt=function(p$h){return p$f.isZero(p$h)?p$h:1/Math.sqrt(p$h)},p$U(p$f,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),p$f}()),p$ah=function(){function p$r(){var p$h=this.elements=new Float32Array(9);p$h[0]=1,p$h[1]=0,p$h[2]=0,p$h[3]=0,p$h[4]=1,p$h[5]=0,p$h[6]=0,p$h[7]=0,p$h[8]=1}p$v(p$r,"laya.d3.math.Matrix3x3");var p$h=p$r.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.determinant=function(){var p$h=this.elements,p$q=p$h[0],p$f=p$h[1],p$g=p$h[2],p$$=p$h[3],p$P=p$h[4],p$S=p$h[5],p$B=p$h[6],p$r=p$h[7],p$Y=p$h[8];return p$q*(p$Y*p$P-p$S*p$r)+p$f*(-p$Y*p$$+p$S*p$B)+p$g*(p$r*p$$-p$P*p$B)},p$h.translate=function(p$h,p$q){var p$f=p$q.elements,p$g=this.elements,p$$=p$h.elements,p$P=p$g[0],p$S=p$g[1],p$B=p$g[2],p$r=p$g[3],p$Y=p$g[4],p$C=p$g[5],p$U=p$g[6],p$u=p$g[7],p$v=p$g[8],p$L=p$$[0],p$e=p$$[1];p$f[0]=p$P,p$f[1]=p$S,p$f[2]=p$B,p$f[3]=p$r,p$f[4]=p$Y,p$f[5]=p$C,p$f[6]=p$L*p$P+p$e*p$r+p$U,p$f[7]=p$L*p$S+p$e*p$Y+p$u,p$f[8]=p$L*p$B+p$e*p$C+p$v},p$h.rotate=function(p$h,p$q){var p$f=p$q.elements,p$g=this.elements,p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$g[3],p$r=p$g[4],p$Y=p$g[5],p$C=p$g[6],p$U=p$g[7],p$u=p$g[8],p$v=Math.sin(p$h),p$L=Math.cos(p$h);p$f[0]=p$L*p$$+p$v*p$B,p$f[1]=p$L*p$P+p$v*p$r,p$f[2]=p$L*p$S+p$v*p$Y,p$f[3]=p$L*p$B-p$v*p$$,p$f[4]=p$L*p$r-p$v*p$P,p$f[5]=p$L*p$Y-p$v*p$S,p$f[6]=p$C,p$f[7]=p$U,p$f[8]=p$u},p$h.scale=function(p$h,p$q){var p$f=p$q.elements,p$g=this.elements,p$$=p$h.elements,p$P=p$$[0],p$S=p$$[1];p$f[0]=p$P*p$g[0],p$f[1]=p$P*p$g[1],p$f[2]=p$P*p$g[2],p$f[3]=p$S*p$g[3],p$f[4]=p$S*p$g[4],p$f[5]=p$S*p$g[5],p$f[6]=p$g[6],p$f[7]=p$g[7],p$f[8]=p$g[8]},p$h.invert=function(p$h){var p$q=p$h.elements,p$f=this.elements,p$g=p$f[0],p$$=p$f[1],p$P=p$f[2],p$S=p$f[3],p$B=p$f[4],p$r=p$f[5],p$Y=p$f[6],p$C=p$f[7],p$U=p$f[8],p$u=p$U*p$B-p$r*p$C,p$v=-p$U*p$S+p$r*p$Y,p$L=p$C*p$S-p$B*p$Y,p$e=p$g*p$u+p$$*p$v+p$P*p$L;p$e||(p$h=null),p$e=1/p$e,p$q[0]=p$u*p$e,p$q[1]=(-p$U*p$$+p$P*p$C)*p$e,p$q[2]=(p$r*p$$-p$P*p$B)*p$e,p$q[3]=p$v*p$e,p$q[4]=(p$U*p$g-p$P*p$Y)*p$e,p$q[5]=(-p$r*p$g+p$P*p$S)*p$e,p$q[6]=p$L*p$e,p$q[7]=(-p$C*p$g+p$$*p$Y)*p$e,p$q[8]=(p$B*p$g-p$$*p$S)*p$e},p$h.transpose=function(p$h){var p$q=p$h.elements,p$f=this.elements;if(p$h===this){var p$g=p$f[1],p$$=p$f[2],p$P=p$f[5];p$q[1]=p$f[3],p$q[2]=p$f[6],p$q[3]=p$g,p$q[5]=p$f[7],p$q[6]=p$$,p$q[7]=p$P}else p$q[0]=p$f[0],p$q[1]=p$f[3],p$q[2]=p$f[6],p$q[3]=p$f[1],p$q[4]=p$f[4],p$q[5]=p$f[7],p$q[6]=p$f[2],p$q[7]=p$f[5],p$q[8]=p$f[8]},p$h.identity=function(){var p$h=this.elements;p$h[0]=1,p$h[1]=0,p$h[2]=0,p$h[3]=0,p$h[4]=1,p$h[5]=0,p$h[6]=0,p$h[7]=0,p$h[8]=1},p$h.cloneTo=function(p$h){var p$q,p$f,p$g;if((p$f=this.elements)!==(p$g=p$h.elements))for(p$q=0;p$q<9;++p$q)p$g[p$q]=p$f[p$q]},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$r.createFromTranslation=function(p$h,p$q){p$q.elements;var p$f=p$h.elements;p$q[0]=1,p$q[1]=0,p$q[2]=0,p$q[3]=0,p$q[4]=1,p$q[5]=0,p$q[6]=p$f[0],p$q[7]=p$f[1],p$q[8]=1},p$r.createFromRotation=function(p$h,p$q){var p$f=p$q.elements,p$g=Math.sin(p$h),p$$=Math.cos(p$h);p$f[0]=p$$,p$f[1]=p$g,p$f[2]=0,p$f[3]=-p$g,p$f[4]=p$$,p$f[5]=0,p$f[6]=0,p$f[7]=0,p$f[8]=1},p$r.createFromScaling=function(p$h,p$q){var p$f=p$q.elements,p$g=p$h.elements;p$f[0]=p$g[0],p$f[1]=0,p$f[2]=0,p$f[3]=0,p$f[4]=p$g[1],p$f[5]=0,p$f[6]=0,p$f[7]=0,p$f[8]=1},p$r.createFromMatrix4x4=function(p$h,p$q){p$q[0]=p$h[0],p$q[1]=p$h[1],p$q[2]=p$h[2],p$q[3]=p$h[4],p$q[4]=p$h[5],p$q[5]=p$h[6],p$q[6]=p$h[8],p$q[7]=p$h[9],p$q[8]=p$h[10]},p$r.multiply=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements,p$S=p$$[0],p$B=p$$[1],p$r=p$$[2],p$Y=p$$[3],p$C=p$$[4],p$U=p$$[5],p$u=p$$[6],p$v=p$$[7],p$L=p$$[8],p$e=p$P[0],p$l=p$P[1],p$_=p$P[2],p$N=p$P[3],p$G=p$P[4],p$m=p$P[5],p$E=p$P[6],p$R=p$P[7],p$t=p$P[8];p$g[0]=p$e*p$S+p$l*p$Y+p$_*p$u,p$g[1]=p$e*p$B+p$l*p$C+p$_*p$v,p$g[2]=p$e*p$r+p$l*p$U+p$_*p$L,p$g[3]=p$N*p$S+p$G*p$Y+p$m*p$u,p$g[4]=p$N*p$B+p$G*p$C+p$m*p$v,p$g[5]=p$N*p$r+p$G*p$U+p$m*p$L,p$g[6]=p$E*p$S+p$R*p$Y+p$t*p$u,p$g[7]=p$E*p$B+p$R*p$C+p$t*p$v,p$g[8]=p$E*p$r+p$R*p$U+p$t*p$L},p$r.lookAt=function(p$h,p$q,p$f,p$g){p$Sq.subtract(p$h,p$q,p$r._tempV30),p$Sq.normalize(p$r._tempV30,p$r._tempV30),p$Sq.cross(p$f,p$r._tempV30,p$r._tempV31),p$Sq.normalize(p$r._tempV31,p$r._tempV31),p$Sq.cross(p$r._tempV30,p$r._tempV31,p$r._tempV32);var p$$=p$r._tempV30.elements,p$P=p$r._tempV31.elements,p$S=p$r._tempV32.elements,p$B=p$g.elements;p$B[0]=p$P[0],p$B[3]=p$P[1],p$B[6]=p$P[2],p$B[1]=p$S[0],p$B[4]=p$S[1],p$B[7]=p$S[2],p$B[2]=p$$[0],p$B[5]=p$$[1],p$B[8]=p$$[2]},p$r.DEFAULT=new p$r,p$U(p$r,["_tempV30",function(){return this._tempV30=new p$Sq},"_tempV31",function(){return this._tempV31=new p$Sq},"_tempV32",function(){return this._tempV32=new p$Sq}]),p$r}(),p$hq=function(){function p$n(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U,p$u,p$v,p$L,p$e){void 0===p$h&&(p$h=1),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=1),void 0===p$S&&(p$S=0),void 0===p$B&&(p$B=0),void 0===p$r&&(p$r=0),void 0===p$Y&&(p$Y=0),void 0===p$C&&(p$C=1),void 0===p$U&&(p$U=0),void 0===p$u&&(p$u=0),void 0===p$v&&(p$v=0),void 0===p$L&&(p$L=0),void 0===p$e&&(p$e=1);var p$l=this.elements=new Float32Array(16);p$l[0]=p$h,p$l[1]=p$q,p$l[2]=p$f,p$l[3]=p$g,p$l[4]=p$$,p$l[5]=p$P,p$l[6]=p$S,p$l[7]=p$B,p$l[8]=p$r,p$l[9]=p$Y,p$l[10]=p$C,p$l[11]=p$U,p$l[12]=p$u,p$l[13]=p$v,p$l[14]=p$L,p$l[15]=p$e}p$v(p$n,"laya.d3.math.Matrix4x4");var p$h=p$n.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.getElementByRowColumn=function(p$h,p$q){if(p$h<0||3<p$h)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(p$q<0||3<p$q)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*p$h+p$q]},p$h.setElementByRowColumn=function(p$h,p$q,p$f){if(p$h<0||3<p$h)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(p$q<0||3<p$q)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*p$h+p$q]=p$f},p$h.equalsOtherMatrix=function(p$h){var p$q=this.elements,p$f=p$h.elements;return p$xh.nearEqual(p$q[0],p$f[0])&&p$xh.nearEqual(p$q[1],p$f[1])&&p$xh.nearEqual(p$q[2],p$f[2])&&p$xh.nearEqual(p$q[3],p$f[3])&&p$xh.nearEqual(p$q[4],p$f[4])&&p$xh.nearEqual(p$q[5],p$f[5])&&p$xh.nearEqual(p$q[6],p$f[6])&&p$xh.nearEqual(p$q[7],p$f[7])&&p$xh.nearEqual(p$q[8],p$f[8])&&p$xh.nearEqual(p$q[9],p$f[9])&&p$xh.nearEqual(p$q[10],p$f[10])&&p$xh.nearEqual(p$q[11],p$f[11])&&p$xh.nearEqual(p$q[12],p$f[12])&&p$xh.nearEqual(p$q[13],p$f[13])&&p$xh.nearEqual(p$q[14],p$f[14])&&p$xh.nearEqual(p$q[15],p$f[15])},p$h.decomposeTransRotScale=function(p$h,p$q,p$f){var p$g=p$n._tempMatrix4x4;return this.decomposeTransRotMatScale(p$h,p$g,p$f)?(p$fq.createFromMatrix4x4(p$g,p$q),!0):(p$q.identity(),!1)},p$h.decomposeTransRotMatScale=function(p$h,p$q,p$f){var p$g=this.elements,p$$=p$h.elements,p$P=p$q.elements,p$S=p$f.elements;p$$[0]=p$g[12],p$$[1]=p$g[13],p$$[2]=p$g[14];var p$B=p$g[0],p$r=p$g[1],p$Y=p$g[2],p$C=p$g[4],p$U=p$g[5],p$u=p$g[6],p$v=p$g[8],p$L=p$g[9],p$e=p$g[10],p$l=p$S[0]=Math.sqrt(p$B*p$B+p$r*p$r+p$Y*p$Y),p$_=p$S[1]=Math.sqrt(p$C*p$C+p$U*p$U+p$u*p$u),p$N=p$S[2]=Math.sqrt(p$v*p$v+p$L*p$L+p$e*p$e);if(p$xh.isZero(p$l)||p$xh.isZero(p$_)||p$xh.isZero(p$N))return p$P[1]=p$P[2]=p$P[3]=p$P[4]=p$P[6]=p$P[7]=p$P[8]=p$P[9]=p$P[11]=p$P[12]=p$P[13]=p$P[14]=0,p$P[0]=p$P[5]=p$P[10]=p$P[15]=1,!1;var p$G=p$n._tempVector0,p$m=p$G.elements;p$m[0]=p$v/p$N,p$m[1]=p$L/p$N,p$m[2]=p$e/p$N;var p$E=p$n._tempVector1,p$R=p$E.elements;p$R[0]=p$B/p$l,p$R[1]=p$r/p$l,p$R[2]=p$Y/p$l;var p$t=p$n._tempVector2;p$Sq.cross(p$G,p$E,p$t);var p$X=p$n._tempVector1;return p$Sq.cross(p$t,p$G,p$X),p$P[3]=p$P[7]=p$P[11]=p$P[12]=p$P[13]=p$P[14]=0,p$P[15]=1,p$P[0]=p$X.x,p$P[1]=p$X.y,p$P[2]=p$X.z,p$P[4]=p$t.x,p$P[5]=p$t.y,p$P[6]=p$t.z,p$P[8]=p$G.x,p$P[9]=p$G.y,p$P[10]=p$G.z,p$P[0]*p$B+p$P[1]*p$r+p$P[2]*p$Y<0&&(p$S[0]=-p$l),p$P[4]*p$C+p$P[5]*p$U+p$P[6]*p$u<0&&(p$S[1]=-p$_),p$P[8]*p$v+p$P[9]*p$L+p$P[10]*p$e<0&&(p$S[2]=-p$N),!0},p$h.decomposeYawPitchRoll=function(p$h){var p$q=p$h.elements,p$f=Math.asin(-this.elements[9]);p$q[1]=p$f,Math.cos(p$f)>p$xh.zeroTolerance?(p$q[2]=Math.atan2(this.elements[1],this.elements[5]),p$q[0]=Math.atan2(this.elements[8],this.elements[10])):(p$q[2]=Math.atan2(-this.elements[4],this.elements[0]),p$q[0]=0)},p$h.normalize=function(){var p$h=this.elements,p$q=p$h[0],p$f=p$h[1],p$g=p$h[2],p$$=Math.sqrt(p$q*p$q+p$f*p$f+p$g*p$g);if(!p$$)return p$h[0]=0,p$h[1]=0,void(p$h[2]=0);1!=p$$&&(p$$=1/p$$,p$h[0]=p$q*p$$,p$h[1]=p$f*p$$,p$h[2]=p$g*p$$)},p$h.transpose=function(){var p$h,p$q;return p$q=(p$h=this.elements)[1],p$h[1]=p$h[4],p$h[4]=p$q,p$q=p$h[2],p$h[2]=p$h[8],p$h[8]=p$q,p$q=p$h[3],p$h[3]=p$h[12],p$h[12]=p$q,p$q=p$h[6],p$h[6]=p$h[9],p$h[9]=p$q,p$q=p$h[7],p$h[7]=p$h[13],p$h[13]=p$q,p$q=p$h[11],p$h[11]=p$h[14],p$h[14]=p$q,this},p$h.invert=function(p$h){var p$q=this.elements,p$f=p$h.elements,p$g=p$q[0],p$$=p$q[1],p$P=p$q[2],p$S=p$q[3],p$B=p$q[4],p$r=p$q[5],p$Y=p$q[6],p$C=p$q[7],p$U=p$q[8],p$u=p$q[9],p$v=p$q[10],p$L=p$q[11],p$e=p$q[12],p$l=p$q[13],p$_=p$q[14],p$N=p$q[15],p$G=p$g*p$r-p$$*p$B,p$m=p$g*p$Y-p$P*p$B,p$E=p$g*p$C-p$S*p$B,p$R=p$$*p$Y-p$P*p$r,p$t=p$$*p$C-p$S*p$r,p$X=p$P*p$C-p$S*p$Y,p$n=p$U*p$l-p$u*p$e,p$J=p$U*p$_-p$v*p$e,p$p=p$U*p$N-p$L*p$e,p$A=p$u*p$_-p$v*p$l,p$d=p$u*p$N-p$L*p$l,p$b=p$v*p$N-p$L*p$_,p$i=p$G*p$b-p$m*p$d+p$E*p$A+p$R*p$p-p$t*p$J+p$X*p$n;0!==Math.abs(p$i)&&(p$i=1/p$i,p$f[0]=(p$r*p$b-p$Y*p$d+p$C*p$A)*p$i,p$f[1]=(p$P*p$d-p$$*p$b-p$S*p$A)*p$i,p$f[2]=(p$l*p$X-p$_*p$t+p$N*p$R)*p$i,p$f[3]=(p$v*p$t-p$u*p$X-p$L*p$R)*p$i,p$f[4]=(p$Y*p$p-p$B*p$b-p$C*p$J)*p$i,p$f[5]=(p$g*p$b-p$P*p$p+p$S*p$J)*p$i,p$f[6]=(p$_*p$E-p$e*p$X-p$N*p$m)*p$i,p$f[7]=(p$U*p$X-p$v*p$E+p$L*p$m)*p$i,p$f[8]=(p$B*p$d-p$r*p$p+p$C*p$n)*p$i,p$f[9]=(p$$*p$p-p$g*p$d-p$S*p$n)*p$i,p$f[10]=(p$e*p$t-p$l*p$E+p$N*p$G)*p$i,p$f[11]=(p$u*p$E-p$U*p$t-p$L*p$G)*p$i,p$f[12]=(p$r*p$J-p$B*p$A-p$Y*p$n)*p$i,p$f[13]=(p$g*p$A-p$$*p$J+p$P*p$n)*p$i,p$f[14]=(p$l*p$m-p$e*p$R-p$_*p$G)*p$i,p$f[15]=(p$U*p$R-p$u*p$m+p$v*p$G)*p$i)},p$h.identity=function(){var p$h=this.elements;p$h[1]=p$h[2]=p$h[3]=p$h[4]=p$h[6]=p$h[7]=p$h[8]=p$h[9]=p$h[11]=p$h[12]=p$h[13]=p$h[14]=0,p$h[0]=p$h[5]=p$h[10]=p$h[15]=1},p$h.cloneTo=function(p$h){var p$q,p$f,p$g;if((p$f=this.elements)!==(p$g=p$h.elements))for(p$q=0;p$q<16;++p$q)p$g[p$q]=p$f[p$q]},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$h.getTranslationVector=function(p$h){var p$q=this.elements,p$f=p$h.elements;p$f[0]=p$q[12],p$f[1]=p$q[13],p$f[2]=p$q[14]},p$h.setTranslationVector=function(p$h){var p$q=this.elements,p$f=p$h.elements;p$q[12]=p$f[0],p$q[13]=p$f[1],p$q[14]=p$f[2]},p$h.getForward=function(p$h){var p$q=this.elements,p$f=p$h.elements;p$f[0]=-p$q[8],p$f[1]=-p$q[9],p$f[2]=-p$q[10]},p$h.setForward=function(p$h){var p$q=this.elements,p$f=p$h.elements;p$q[8]=-p$f[0],p$q[9]=-p$f[1],p$q[10]=-p$f[2]},p$n.createRotationX=function(p$h,p$q){var p$f=p$q.elements,p$g=Math.sin(p$h),p$$=Math.cos(p$h);p$f[1]=p$f[2]=p$f[3]=p$f[4]=p$f[7]=p$f[8]=p$f[11]=p$f[12]=p$f[13]=p$f[14]=0,p$f[0]=p$f[15]=1,p$f[5]=p$f[10]=p$$,p$f[6]=p$g,p$f[9]=-p$g},p$n.createRotationY=function(p$h,p$q){var p$f=p$q.elements,p$g=Math.sin(p$h),p$$=Math.cos(p$h);p$f[1]=p$f[3]=p$f[4]=p$f[6]=p$f[7]=p$f[9]=p$f[11]=p$f[12]=p$f[13]=p$f[14]=0,p$f[5]=p$f[15]=1,p$f[0]=p$f[10]=p$$,p$f[2]=-p$g,p$f[8]=p$g},p$n.createRotationZ=function(p$h,p$q){var p$f=p$q.elements,p$g=Math.sin(p$h),p$$=Math.cos(p$h);p$f[2]=p$f[3]=p$f[6]=p$f[7]=p$f[8]=p$f[9]=p$f[11]=p$f[12]=p$f[13]=p$f[14]=0,p$f[10]=p$f[15]=1,p$f[0]=p$f[5]=p$$,p$f[1]=p$g,p$f[4]=-p$g},p$n.createRotationYawPitchRoll=function(p$h,p$q,p$f,p$g){p$fq.createFromYawPitchRoll(p$h,p$q,p$f,p$n._tempQuaternion),p$n.createRotationQuaternion(p$n._tempQuaternion,p$g)},p$n.createRotationAxis=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=Math.cos(p$q),p$r=Math.sin(p$q),p$Y=p$$*p$$,p$C=p$P*p$P,p$U=p$S*p$S,p$u=p$$*p$P,p$v=p$$*p$S,p$L=p$P*p$S,p$e=p$f.elements;p$e[3]=p$e[7]=p$e[11]=p$e[12]=p$e[13]=p$e[14]=0,p$e[15]=1,p$e[0]=p$Y+p$B*(1-p$Y),p$e[1]=p$u-p$B*p$u+p$r*p$S,p$e[2]=p$v-p$B*p$v-p$r*p$P,p$e[4]=p$u-p$B*p$u-p$r*p$S,p$e[5]=p$C+p$B*(1-p$C),p$e[6]=p$L-p$B*p$L+p$r*p$$,p$e[8]=p$v-p$B*p$v+p$r*p$P,p$e[9]=p$L-p$B*p$L-p$r*p$$,p$e[10]=p$U+p$B*(1-p$U)},p$n.createRotationQuaternion=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$f[0],p$P=p$f[1],p$S=p$f[2],p$B=p$f[3],p$r=p$$*p$$,p$Y=p$P*p$P,p$C=p$S*p$S,p$U=p$$*p$P,p$u=p$S*p$B,p$v=p$S*p$$,p$L=p$P*p$B,p$e=p$P*p$S,p$l=p$$*p$B;p$g[3]=p$g[7]=p$g[11]=p$g[12]=p$g[13]=p$g[14]=0,p$g[15]=1,p$g[0]=1-2*(p$Y+p$C),p$g[1]=2*(p$U+p$u),p$g[2]=2*(p$v-p$L),p$g[4]=2*(p$U-p$u),p$g[5]=1-2*(p$C+p$r),p$g[6]=2*(p$e+p$l),p$g[8]=2*(p$v+p$L),p$g[9]=2*(p$e-p$l),p$g[10]=1-2*(p$Y+p$r)},p$n.createTranslate=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;p$g[4]=p$g[8]=p$g[1]=p$g[9]=p$g[2]=p$g[6]=p$g[3]=p$g[7]=p$g[11]=0,p$g[0]=p$g[5]=p$g[10]=p$g[15]=1,p$g[12]=p$f[0],p$g[13]=p$f[1],p$g[14]=p$f[2]},p$n.createScaling=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;p$g[0]=p$f[0],p$g[5]=p$f[1],p$g[10]=p$f[2],p$g[1]=p$g[4]=p$g[8]=p$g[12]=p$g[9]=p$g[13]=p$g[2]=p$g[6]=p$g[14]=p$g[3]=p$g[7]=p$g[11]=0,p$g[15]=1},p$n.multiply=function(p$h,p$q,p$f){var p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C;for(p$$=p$f.elements,p$P=p$h.elements,p$$===(p$S=p$q.elements)&&(p$S=p$S.slice()),p$g=0;p$g<4;p$g++)p$B=p$P[p$g],p$r=p$P[p$g+4],p$Y=p$P[p$g+8],p$C=p$P[p$g+12],p$$[p$g]=p$B*p$S[0]+p$r*p$S[1]+p$Y*p$S[2]+p$C*p$S[3],p$$[p$g+4]=p$B*p$S[4]+p$r*p$S[5]+p$Y*p$S[6]+p$C*p$S[7],p$$[p$g+8]=p$B*p$S[8]+p$r*p$S[9]+p$Y*p$S[10]+p$C*p$S[11],p$$[p$g+12]=p$B*p$S[12]+p$r*p$S[13]+p$Y*p$S[14]+p$C*p$S[15]},p$n.createFromQuaternion=function(p$h,p$q){var p$f=p$q.elements,p$g=p$h.elements,p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$g[3],p$r=p$$+p$$,p$Y=p$P+p$P,p$C=p$S+p$S,p$U=p$$*p$r,p$u=p$P*p$r,p$v=p$P*p$Y,p$L=p$S*p$r,p$e=p$S*p$Y,p$l=p$S*p$C,p$_=p$B*p$r,p$N=p$B*p$Y,p$G=p$B*p$C;p$f[0]=1-p$v-p$l,p$f[1]=p$u+p$G,p$f[2]=p$L-p$N,p$f[3]=0,p$f[4]=p$u-p$G,p$f[5]=1-p$U-p$l,p$f[6]=p$e+p$_,p$f[7]=0,p$f[8]=p$L+p$N,p$f[9]=p$e-p$_,p$f[10]=1-p$U-p$v,p$f[11]=0,p$f[12]=0,p$f[13]=0,p$f[14]=0,p$f[15]=1},p$n.createAffineTransformation=function(p$h,p$q,p$f,p$g){var p$$=p$h.elements,p$P=p$q.elements,p$S=p$f.elements,p$B=p$g.elements,p$r=p$P[0],p$Y=p$P[1],p$C=p$P[2],p$U=p$P[3],p$u=p$r+p$r,p$v=p$Y+p$Y,p$L=p$C+p$C,p$e=p$r*p$u,p$l=p$r*p$v,p$_=p$r*p$L,p$N=p$Y*p$v,p$G=p$Y*p$L,p$m=p$C*p$L,p$E=p$U*p$u,p$R=p$U*p$v,p$t=p$U*p$L,p$X=p$S[0],p$n=p$S[1],p$J=p$S[2];p$B[0]=(1-(p$N+p$m))*p$X,p$B[1]=(p$l+p$t)*p$X,p$B[2]=(p$_-p$R)*p$X,p$B[3]=0,p$B[4]=(p$l-p$t)*p$n,p$B[5]=(1-(p$e+p$m))*p$n,p$B[6]=(p$G+p$E)*p$n,p$B[7]=0,p$B[8]=(p$_+p$R)*p$J,p$B[9]=(p$G-p$E)*p$J,p$B[10]=(1-(p$e+p$N))*p$J,p$B[11]=0,p$B[12]=p$$[0],p$B[13]=p$$[1],p$B[14]=p$$[2],p$B[15]=1},p$n.createLookAt=function(p$h,p$q,p$f,p$g){var p$$=p$g.elements,p$P=p$n._tempVector0,p$S=p$n._tempVector1,p$B=p$n._tempVector2;p$Sq.subtract(p$h,p$q,p$B),p$Sq.normalize(p$B,p$B),p$Sq.cross(p$f,p$B,p$P),p$Sq.normalize(p$P,p$P),p$Sq.cross(p$B,p$P,p$S),p$g.identity(),p$$[0]=p$P.x,p$$[4]=p$P.y,p$$[8]=p$P.z,p$$[1]=p$S.x,p$$[5]=p$S.y,p$$[9]=p$S.z,p$$[2]=p$B.x,p$$[6]=p$B.y,p$$[10]=p$B.z,p$$[12]=-p$Sq.dot(p$P,p$h),p$$[13]=-p$Sq.dot(p$S,p$h),p$$[14]=-p$Sq.dot(p$B,p$h)},p$n.createPerspective=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$$.elements,p$S=1/Math.tan(p$h/2),p$B=1/(p$f-p$g);p$P[0]=p$S/p$q,p$P[5]=p$S,p$P[10]=(p$g+p$f)*p$B,p$P[11]=-1,p$P[14]=2*p$g*p$f*p$B,p$P[1]=p$P[2]=p$P[3]=p$P[4]=p$P[6]=p$P[7]=p$P[8]=p$P[9]=p$P[12]=p$P[13]=p$P[15]=0},p$n.createOrthoOffCenterRH=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){var p$B=p$S.elements,p$r=1/(p$h-p$q),p$Y=1/(p$f-p$g),p$C=1/(p$$-p$P);p$B[1]=p$B[2]=p$B[3]=p$B[4]=p$B[6]=p$B[7]=p$B[8]=p$B[9]=p$B[11]=0,p$B[15]=1,p$B[0]=-2*p$r,p$B[5]=-2*p$Y,p$B[10]=2*p$C,p$B[12]=(p$h+p$q)*p$r,p$B[13]=(p$g+p$f)*p$Y,p$B[14]=(p$P+p$$)*p$C},p$n.translation=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;p$g[0]=p$g[5]=p$g[10]=p$g[15]=1,p$g[12]=p$f[0],p$g[13]=p$f[1],p$g[14]=p$f[2]},p$U(p$n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new p$n},"_tempVector0",function(){return this._tempVector0=new p$Sq},"_tempVector1",function(){return this._tempVector1=new p$Sq},"_tempVector2",function(){return this._tempVector2=new p$Sq},"_tempQuaternion",function(){return this._tempQuaternion=new p$fq},"DEFAULT",function(){return this.DEFAULT=new p$n},"ZERO",function(){return this.ZERO=new p$n(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),p$n}(),p$qq=(function(){function p$G(p$h,p$q){this.extents=null,this.transformation=null,this.extents=p$h,this.transformation=p$q}p$v(p$G,"laya.d3.math.OrientedBoundBox");var p$h=p$G.prototype;p$h.getCorners=function(p$h){var p$q=p$G._tempV30.elements,p$f=p$G._tempV31.elements,p$g=p$G._tempV32.elements,p$$=this.extents.elements;p$q[0]=p$$[0],p$q[1]=p$q[2]=0,p$f[1]=p$$[1],p$f[0]=p$f[2]=0,p$g[2]=p$$[2],p$g[0]=p$g[1]=0,p$Sq.TransformNormal(p$G._tempV30,this.transformation,p$G._tempV30),p$Sq.TransformNormal(p$G._tempV31,this.transformation,p$G._tempV31),p$Sq.TransformNormal(p$G._tempV32,this.transformation,p$G._tempV32);var p$P=p$G._tempV33;this.transformation.getTranslationVector(p$P),p$h.length=8,p$Sq.add(p$P,p$G._tempV30,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV32,p$h[0]),p$Sq.add(p$P,p$G._tempV30,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV32,p$h[1]),p$Sq.subtract(p$P,p$G._tempV30,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV32,p$h[2]),p$Sq.subtract(p$P,p$G._tempV30,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV32,p$h[3]),p$Sq.add(p$P,p$G._tempV30,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV32,p$h[4]),p$Sq.add(p$P,p$G._tempV30,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV32,p$h[5]),p$Sq.subtract(p$P,p$G._tempV30,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV32,p$h[6]),p$Sq.subtract(p$P,p$G._tempV30,p$G._tempV34),p$Sq.subtract(p$G._tempV34,p$G._tempV31,p$G._tempV34),p$Sq.add(p$G._tempV34,p$G._tempV32,p$h[7])},p$h.transform=function(p$h){p$hq.multiply(this.transformation,p$h,this.transformation)},p$h.scale=function(p$h){p$Sq.multiply(this.extents,p$h,this.extents)},p$h.translate=function(p$h){this.transformation.getTranslationVector(p$G._tempV30),p$Sq.add(p$G._tempV30,p$h,p$G._tempV31),this.transformation.setTranslationVector(p$G._tempV31)},p$h.Size=function(p$h){p$Sq.scale(this.extents,2,p$h)},p$h.getSize=function(p$h){var p$q=this.extents.elements;p$G._tempV30.x=p$q[0],p$G._tempV31.y=p$q[1],p$G._tempV32.z=p$q[2],p$Sq.TransformNormal(p$G._tempV30,this.transformation,p$G._tempV30),p$Sq.TransformNormal(p$G._tempV31,this.transformation,p$G._tempV31),p$Sq.TransformNormal(p$G._tempV31,this.transformation,p$G._tempV32);var p$f=p$h.elements;p$f[0]=p$Sq.scalarLength(p$G._tempV30),p$f[1]=p$Sq.scalarLength(p$G._tempV31),p$f[2]=p$Sq.scalarLength(p$G._tempV32)},p$h.getSizeSquared=function(p$h){var p$q=this.extents.elements;p$G._tempV30.x=p$q[0],p$G._tempV31.y=p$q[1],p$G._tempV32.z=p$q[2],p$Sq.TransformNormal(p$G._tempV30,this.transformation,p$G._tempV30),p$Sq.TransformNormal(p$G._tempV31,this.transformation,p$G._tempV31),p$Sq.TransformNormal(p$G._tempV31,this.transformation,p$G._tempV32);var p$f=p$h.elements;p$f[0]=p$Sq.scalarLengthSquared(p$G._tempV30),p$f[1]=p$Sq.scalarLengthSquared(p$G._tempV31),p$f[2]=p$Sq.scalarLengthSquared(p$G._tempV32)},p$h.getCenter=function(p$h){this.transformation.getTranslationVector(p$h)},p$h.containsPoint=function(p$h){var p$q=this.extents.elements,p$f=p$q[0],p$g=p$q[1],p$$=p$q[2];this.transformation.invert(p$G._tempM0),p$Sq.transformCoordinate(p$h,p$G._tempM0,p$G._tempV30);var p$P=p$G._tempV30.elements,p$S=Math.abs(p$P[0]),p$B=Math.abs(p$P[1]),p$r=Math.abs(p$P[2]);return p$xh.nearEqual(p$S,p$f)&&p$xh.nearEqual(p$B,p$g)&&p$xh.nearEqual(p$r,p$$)?2:p$S<p$f&&p$B<p$g&&p$r<p$$?1:0},p$h.containsPoints=function(p$h){var p$q=this.extents.elements,p$f=p$q[0],p$g=p$q[1],p$$=p$q[2];this.transformation.invert(p$G._tempM0);for(var p$P=!0,p$S=!1,p$B=0;p$B<p$h.length;p$B++){p$Sq.transformCoordinate(p$h[p$B],p$G._tempM0,p$G._tempV30);var p$r=p$G._tempV30.elements,p$Y=Math.abs(p$r[0]),p$C=Math.abs(p$r[1]),p$U=Math.abs(p$r[2]);p$xh.nearEqual(p$Y,p$f)&&p$xh.nearEqual(p$C,p$g)&&p$xh.nearEqual(p$U,p$$)&&(p$S=!0),p$Y<p$f&&p$C<p$g&&p$U<p$$?p$S=!0:p$P=!1}return p$P?1:p$S?2:0},p$h.containsSphere=function(p$h,p$q){void 0===p$q&&(p$q=!1);var p$f=this.extents.elements,p$g=p$f[0],p$$=p$f[1],p$P=p$f[2],p$S=p$h.radius;this.transformation.invert(p$G._tempM0),p$Sq.transformCoordinate(p$h.center,p$G._tempM0,p$G._tempV30);var p$B=NaN;if(p$B=p$q?p$S:(p$Sq.scale(p$Sq.UnitX,p$S,p$G._tempV31),p$Sq.TransformNormal(p$G._tempV31,p$G._tempM0,p$G._tempV31),p$Sq.scalarLength(p$G._tempV31)),p$Sq.scale(this.extents,-1,p$G._tempV32),p$Sq.Clamp(p$G._tempV30,p$G._tempV32,this.extents,p$G._tempV33),p$B*p$B<p$Sq.distanceSquared(p$G._tempV30,p$G._tempV33))return 0;var p$r=p$G._tempV30.elements,p$Y=p$r[0],p$C=p$r[1],p$U=p$r[2],p$u=p$G._tempV32.elements,p$v=p$u[0],p$L=p$u[1],p$e=p$u[2];return p$v+p$B<=p$Y&&p$Y<=p$g-p$B&&p$B<p$g-p$v&&p$L+p$B<=p$C&&p$C<=p$$-p$B&&p$B<p$$-p$L&&p$e+p$B<=p$U&&p$U<=p$P-p$B&&p$B<p$P-p$e?1:2},p$h.containsOrientedBoundBox=function(p$h){var p$q=0,p$f=0;p$h.getCorners(p$G._corners);var p$g=this.containsPoints(p$G._corners);if(0!=p$g)return p$g;var p$$=this.extents.elements;p$h.extents.cloneTo(p$G._tempV35);var p$P=p$G._tempV35.elements;p$G._getRows(this.transformation,p$G._rows1),p$G._getRows(p$h.transformation,p$G._rows2);var p$S=NaN;for(p$q=0;p$q<4;p$q++)for(p$f=0;p$f<4;p$f++)3==p$q||3==p$f?(p$G._tempM0.setElementByRowColumn(p$q,p$f,0),p$G._tempM1.setElementByRowColumn(p$q,p$f,0)):(p$S=p$Sq.dot(p$G._rows1[p$q],p$G._rows2[p$f]),p$G._tempM0.setElementByRowColumn(p$q,p$f,p$S),p$G._tempM1.setElementByRowColumn(p$q,p$f,Math.abs(p$S)));p$h.getCenter(p$G._tempV34),this.getCenter(p$G._tempV36),p$Sq.subtract(p$G._tempV34,p$G._tempV36,p$G._tempV30);var p$B=p$G._tempV31.elements;p$B[0]=p$Sq.dot(p$G._tempV30,p$G._rows1[0]),p$B[1]=p$Sq.dot(p$G._tempV30,p$G._rows1[1]),p$B[2]=p$Sq.dot(p$G._tempV30,p$G._rows1[2]);var p$r=p$G._tempV32.elements,p$Y=p$G._tempV33.elements;for(p$q=0;p$q<3;p$q++)if(p$r[0]=p$G._tempM1.getElementByRowColumn(p$q,0),p$r[1]=p$G._tempM1.getElementByRowColumn(p$q,1),p$r[2]=p$G._tempM1.getElementByRowColumn(p$q,2),p$$[p$q]+p$Sq.dot(p$G._tempV35,p$G._tempV32)<Math.abs(p$B[p$q]))return 0;for(p$f=0;p$f<3;p$f++)if(p$r[0]=p$G._tempM1.getElementByRowColumn(0,p$f),p$r[1]=p$G._tempM1.getElementByRowColumn(1,p$f),p$r[2]=p$G._tempM1.getElementByRowColumn(2,p$f),p$Y[0]=p$G._tempM0.getElementByRowColumn(0,p$f),p$Y[1]=p$G._tempM0.getElementByRowColumn(1,p$f),p$Y[2]=p$G._tempM0.getElementByRowColumn(2,p$f),p$Sq.dot(this.extents,p$G._tempV32)+p$P[p$f]<Math.abs(p$Sq.dot(p$G._tempV31,p$G._tempV33)))return 0;for(p$q=0;p$q<3;p$q++)for(p$f=0;p$f<3;p$f++){var p$C=(p$q+1)%3,p$U=(p$q+2)%3,p$u=(p$f+1)%3,p$v=(p$f+2)%3;if(p$$[p$C]*p$G._tempM1.getElementByRowColumn(p$U,p$f)+p$$[p$U]*p$G._tempM1.getElementByRowColumn(p$C,p$f)+(p$P[p$u]*p$G._tempM1.getElementByRowColumn(p$q,p$v)+p$P[p$v]*p$G._tempM1.getElementByRowColumn(p$q,p$u))<Math.abs(p$B[p$U]*p$G._tempM0.getElementByRowColumn(p$C,p$f)-p$B[p$C]*p$G._tempM0.getElementByRowColumn(p$U,p$f)))return 0}return 2},p$h.containsLine=function(p$h,p$q){p$G._corners[0]=p$h,p$G._corners[1]=p$q;var p$f=this.containsPoints(p$G._corners);if(0!=p$f)return p$f;var p$g=this.extents.elements,p$$=p$g[0],p$P=p$g[1],p$S=p$g[2];this.transformation.invert(p$G._tempM0),p$Sq.transformCoordinate(p$h,p$G._tempM0,p$G._tempV30),p$Sq.transformCoordinate(p$q,p$G._tempM0,p$G._tempV31),p$Sq.add(p$G._tempV30,p$G._tempV31,p$G._tempV32),p$Sq.scale(p$G._tempV32,.5,p$G._tempV32),p$Sq.subtract(p$G._tempV30,p$G._tempV32,p$G._tempV33);var p$B=p$G._tempV33.elements,p$r=p$B[0],p$Y=p$B[1],p$C=p$B[2],p$U=p$G._tempV34.elements,p$u=p$U[0]=Math.abs(p$B[0]),p$v=p$U[1]=Math.abs(p$B[1]),p$L=p$U[2]=Math.abs(p$B[2]),p$e=p$G._tempV32.elements,p$l=p$e[0],p$_=p$e[1],p$N=p$e[2];return Math.abs(p$l)>p$$+p$u?0:Math.abs(p$_)>p$P+p$v?0:Math.abs(p$N)>p$S+p$L?0:Math.abs(p$_*p$C-p$N*p$Y)>p$P*p$L+p$S*p$v?0:Math.abs(p$l*p$C-p$N*p$r)>p$$*p$L+p$S*p$u?0:Math.abs(p$l*p$Y-p$_*p$r)>p$$*p$v+p$P*p$u?0:2},p$h.containsBoundBox=function(p$h){var p$q=0,p$f=0,p$g=p$h.min,p$$=p$h.max;p$h.getCorners(p$G._corners);var p$P=this.containsPoints(p$G._corners);if(0!=p$P)return p$P;p$Sq.subtract(p$$,p$g,p$G._tempV30),p$Sq.scale(p$G._tempV30,.5,p$G._tempV30),p$Sq.add(p$g,p$G._tempV30,p$G._tempV30),p$Sq.subtract(p$$,p$G._tempV30,p$G._tempV31);var p$S=this.extents.elements,p$B=p$G._tempV31.elements;p$G._getRows(this.transformation,p$G._rows1),this.transformation.invert(p$G._tempM0);for(p$q=0;p$q<3;p$q++)for(p$f=0;p$f<3;p$f++)p$G._tempM1.setElementByRowColumn(p$q,p$f,Math.abs(p$G._tempM0.getElementByRowColumn(p$q,p$f)));this.getCenter(p$G._tempV35),p$Sq.subtract(p$G._tempV30,p$G._tempV35,p$G._tempV32);var p$r=p$G._tempV31.elements;p$r[0]=p$Sq.dot(p$G._tempV32,p$G._rows1[0]),p$r[1]=p$Sq.dot(p$G._tempV32,p$G._rows1[1]),p$r[2]=p$Sq.dot(p$G._tempV32,p$G._rows1[2]);var p$Y=p$G._tempV33.elements,p$C=p$G._tempV34.elements;for(p$q=0;p$q<3;p$q++)if(p$Y[0]=p$G._tempM1.getElementByRowColumn(p$q,0),p$Y[1]=p$G._tempM1.getElementByRowColumn(p$q,1),p$Y[2]=p$G._tempM1.getElementByRowColumn(p$q,2),p$S[p$q]+p$Sq.dot(p$G._tempV31,p$G._tempV33)<Math.abs(p$r[p$q]))return 0;for(p$f=0;p$f<3;p$f++)if(p$Y[0]=p$G._tempM1.getElementByRowColumn(0,p$f),p$Y[1]=p$G._tempM1.getElementByRowColumn(1,p$f),p$Y[2]=p$G._tempM1.getElementByRowColumn(2,p$f),p$C[0]=p$G._tempM0.getElementByRowColumn(0,p$f),p$C[1]=p$G._tempM0.getElementByRowColumn(1,p$f),p$C[2]=p$G._tempM0.getElementByRowColumn(2,p$f),p$Sq.dot(this.extents,p$G._tempV33)+p$B[p$f]<Math.abs(p$Sq.dot(p$G._tempV31,p$G._tempV34)))return 0;for(p$q=0;p$q<3;p$q++)for(p$f=0;p$f<3;p$f++){var p$U=(p$q+1)%3,p$u=(p$q+2)%3,p$v=(p$f+1)%3,p$L=(p$f+2)%3;if(p$S[p$U]*p$G._tempM1.getElementByRowColumn(p$u,p$f)+p$S[p$u]*p$G._tempM1.getElementByRowColumn(p$U,p$f)+(p$B[p$v]*p$G._tempM1.getElementByRowColumn(p$q,p$L)+p$B[p$L]*p$G._tempM1.getElementByRowColumn(p$q,p$v))<Math.abs(p$r[p$u]*p$G._tempM0.getElementByRowColumn(p$U,p$f)-p$r[p$U]*p$G._tempM0.getElementByRowColumn(p$u,p$f)))return 0}return 2},p$h.intersectsRay=function(p$h,p$q){p$Sq.scale(this.extents,-1,p$G._tempV30),this.transformation.invert(p$G._tempM0),p$Sq.TransformNormal(p$h.direction,p$G._tempM0,p$G._ray.direction),p$Sq.transformCoordinate(p$h.origin,p$G._tempM0,p$G._ray.origin),p$G._boxBound1.min=p$G._tempV30,p$G._boxBound1.max=this.extents;var p$f=Collision.intersectsRayAndBoxRP(p$G._ray,p$G._boxBound1,p$q);return-1!==p$f&&p$Sq.transformCoordinate(p$q,this.transformation,p$q),p$f},p$h._getLocalCorners=function(p$h){p$h.length=8;var p$q=this.extents.elements;p$G._tempV30.x=p$q[0],p$G._tempV31.y=p$q[1],p$G._tempV32.z=p$q[2],p$Sq.add(p$G._tempV30,p$G._tempV31,p$G._tempV33),p$Sq.add(p$G._tempV33,p$G._tempV32,p$h[0]),p$Sq.add(p$G._tempV30,p$G._tempV31,p$G._tempV33),p$Sq.subtract(p$G._tempV33,p$G._tempV32,p$h[1]),p$Sq.subtract(p$G._tempV31,p$G._tempV30,p$G._tempV33),p$Sq.subtract(p$G._tempV33,p$G._tempV30,p$h[2]),p$Sq.subtract(p$G._tempV31,p$G._tempV30,p$G._tempV33),p$Sq.add(p$G._tempV33,p$G._tempV32,p$h[3]),p$Sq.subtract(p$G._tempV30,p$G._tempV31,p$G._tempV33),p$Sq.add(p$G._tempV33,p$G._tempV32,p$h[4]),p$Sq.subtract(p$G._tempV30,p$G._tempV31,p$G._tempV33),p$Sq.subtract(p$G._tempV33,p$G._tempV32,p$h[5]),p$Sq.scale(p$h[0],-1,p$h[6]),p$Sq.subtract(p$G._tempV32,p$G._tempV30,p$G._tempV33),p$Sq.subtract(p$G._tempV33,p$G._tempV31,p$h[7])},p$h.equals=function(p$h){return this.extents==p$h.extents&&this.transformation==p$h.transformation},p$h.cloneTo=function(p$h){var p$q=p$h;this.extents.cloneTo(p$q.extents),this.transformation.cloneTo(p$q.transformation)},p$G.createByBoundBox=function(p$h,p$q){var p$f=p$h.min,p$g=p$h.max;p$Sq.subtract(p$g,p$f,p$G._tempV30),p$Sq.scale(p$G._tempV30,.5,p$G._tempV30),p$Sq.add(p$f,p$G._tempV30,p$G._tempV31),p$Sq.subtract(p$g,p$G._tempV31,p$G._tempV32),p$hq.translation(p$G._tempV31,p$G._tempM0);var p$$=p$G._tempV32.clone(),p$P=p$G._tempM0.clone();p$q.extents=p$$,p$q.transformation=p$P},p$G.createByMinAndMaxVertex=function(p$h,p$q){return p$Sq.subtract(p$q,p$h,p$G._tempV30),p$Sq.scale(p$G._tempV30,.5,p$G._tempV30),p$Sq.add(p$h,p$G._tempV30,p$G._tempV31),p$Sq.subtract(p$q,p$G._tempV31,p$G._tempV32),p$hq.translation(p$G._tempV31,p$G._tempM0),new p$G(p$G._tempV32,p$G._tempM0)},p$G._getRows=function(p$h,p$q){p$q.length=3;var p$f=p$h.elements,p$g=p$q[0].elements;p$g[0]=p$f[0],p$g[1]=p$f[1],p$g[2]=p$f[2];var p$$=p$q[1].elements;p$$[0]=p$f[4],p$$[1]=p$f[5],p$$[2]=p$f[6];var p$P=p$q[2].elements;p$P[0]=p$f[8],p$P[1]=p$f[9],p$P[2]=p$f[10]},p$G.getObbtoObbMatrix4x4=function(p$h,p$q,p$f,p$g){var p$$=p$h.transformation,p$P=p$q.transformation;if(p$f){p$G._getRows(p$$,p$G._rows1),p$G._getRows(p$P,p$G._rows2);for(var p$S=0;p$S<3;p$S++)for(var p$B=0;p$B<3;p$B++)p$g.setElementByRowColumn(p$S,p$B,p$Sq.dot(p$G._rows2[p$S],p$G._rows1[p$B]));p$q.getCenter(p$G._tempV30),p$h.getCenter(p$G._tempV31),p$Sq.subtract(p$G._tempV30,p$G._tempV31,p$G._tempV32);var p$r=p$g.elements;p$r[12]=p$Sq.dot(p$G._tempV32,p$G._rows1[0]),p$r[13]=p$Sq.dot(p$G._tempV32,p$G._rows1[1]),p$r[14]=p$Sq.dot(p$G._tempV32,p$G._rows1[2]),p$r[15]=1}else p$$.invert(p$G._tempM0),p$hq.multiply(p$P,p$G._tempM0,p$g)},p$G.merge=function(p$h,p$q,p$f){var p$g=p$h.extents,p$$=p$h.transformation;p$G.getObbtoObbMatrix4x4(p$h,p$q,p$f,p$G._tempM0),p$q._getLocalCorners(p$G._corners),p$Sq.transformCoordinate(p$G._corners[0],p$G._tempM0,p$G._corners[0]),p$Sq.transformCoordinate(p$G._corners[1],p$G._tempM0,p$G._corners[1]),p$Sq.transformCoordinate(p$G._corners[2],p$G._tempM0,p$G._corners[2]),p$Sq.transformCoordinate(p$G._corners[3],p$G._tempM0,p$G._corners[3]),p$Sq.transformCoordinate(p$G._corners[4],p$G._tempM0,p$G._corners[4]),p$Sq.transformCoordinate(p$G._corners[5],p$G._tempM0,p$G._corners[5]),p$Sq.transformCoordinate(p$G._corners[6],p$G._tempM0,p$G._corners[6]),p$Sq.transformCoordinate(p$G._corners[7],p$G._tempM0,p$G._corners[7]),p$Sq.scale(p$g,-1,p$G._boxBound1.min),p$g.cloneTo(p$G._boxBound1.max),p$oh.createfromPoints(p$G._corners,p$G._boxBound2),p$oh.merge(p$G._boxBound2,p$G._boxBound1,p$G._boxBound3);var p$P=p$G._boxBound3.min,p$S=p$G._boxBound3.max;p$Sq.subtract(p$S,p$P,p$G._tempV30),p$Sq.scale(p$G._tempV30,.5,p$G._tempV30),p$Sq.add(p$P,p$G._tempV30,p$G._tempV32),p$Sq.subtract(p$S,p$G._tempV32,p$g),p$Sq.transformCoordinate(p$G._tempV32,p$$,p$G._tempV33)},p$U(p$G,["_tempV30",function(){return this._tempV30=new p$Sq},"_tempV31",function(){return this._tempV31=new p$Sq},"_tempV32",function(){return this._tempV32=new p$Sq},"_tempV33",function(){return this._tempV33=new p$Sq},"_tempV34",function(){return this._tempV34=new p$Sq},"_tempV35",function(){return this._tempV35=new p$Sq},"_tempV36",function(){return this._tempV36=new p$Sq},"_tempM0",function(){return this._tempM0=new p$hq},"_tempM1",function(){return this._tempM1=new p$hq},"_corners",function(){return this._corners=[new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq]},"_rows1",function(){return this._rows1=[new p$Sq,new p$Sq,new p$Sq]},"_rows2",function(){return this._rows2=[new p$Sq,new p$Sq,new p$Sq]},"_ray",function(){return this._ray=new p$$q(new p$Sq,new p$Sq)},"_boxBound1",function(){return this._boxBound1=new p$oh(new p$Sq,new p$Sq)},"_boxBound2",function(){return this._boxBound2=new p$oh(new p$Sq,new p$Sq)},"_boxBound3",function(){return this._boxBound3=new p$oh(new p$Sq,new p$Sq)}])}(),function(){function p$E(p$h,p$q){this.normal=null,this.distance=NaN,void 0===p$q&&(p$q=0),this.normal=p$h,this.distance=p$q}return p$v(p$E,"laya.d3.math.Plane"),p$E.prototype.normalize=function(){var p$h=this.normal.elements,p$q=p$h[0],p$f=p$h[1],p$g=p$h[2],p$$=1/Math.sqrt(p$q*p$q+p$f*p$f+p$g*p$g);p$h[0]=p$q*p$$,p$h[1]=p$f*p$$,p$h[2]=p$g*p$$,this.distance*=p$$},p$E.createPlaneBy3P=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$q.elements,p$P=p$f.elements,p$S=p$$[0]-p$g[0],p$B=p$$[1]-p$g[1],p$r=p$$[2]-p$g[2],p$Y=p$P[0]-p$g[0],p$C=p$P[1]-p$g[1],p$U=p$P[2]-p$g[2],p$u=p$B*p$U-p$r*p$C,p$v=p$r*p$Y-p$S*p$U,p$L=p$S*p$C-p$B*p$Y,p$e=1/Math.sqrt(p$u*p$u+p$v*p$v+p$L*p$L),p$l=p$u*p$e,p$_=p$v*p$e,p$N=p$L*p$e,p$G=p$E._TEMPVec3.elements;p$G[0]=p$l,p$G[1]=p$_,p$G[2]=p$N;var p$m=-(p$l*p$g[0]+p$_*p$g[1]+p$N*p$g[2]);return new p$E(p$E._TEMPVec3,p$m)},p$E.PlaneIntersectionType_Back=0,p$E.PlaneIntersectionType_Front=1,p$E.PlaneIntersectionType_Intersecting=2,p$U(p$E,["_TEMPVec3",function(){return this._TEMPVec3=new p$Sq}]),p$E}()),p$fq=function(){function p$$(p$h,p$q,p$f,p$g){this.elements=new Float32Array(4),void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=1),this.elements[0]=p$h,this.elements[1]=p$q,this.elements[2]=p$f,this.elements[3]=p$g}p$v(p$$,"laya.d3.math.Quaternion");var p$h=p$$.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.scaling=function(p$h,p$q){var p$f=p$q.elements,p$g=this.elements;p$f[0]=p$g[0]*p$h,p$f[1]=p$g[1]*p$h,p$f[2]=p$g[2]*p$h,p$f[3]=p$g[3]*p$h},p$h.normalize=function(p$h){var p$q=p$h.elements,p$f=this.elements,p$g=p$f[0],p$$=p$f[1],p$P=p$f[2],p$S=p$f[3],p$B=p$g*p$g+p$$*p$$+p$P*p$P+p$S*p$S;0<p$B&&(p$B=1/Math.sqrt(p$B),p$q[0]=p$g*p$B,p$q[1]=p$$*p$B,p$q[2]=p$P*p$B,p$q[3]=p$S*p$B)},p$h.length=function(){var p$h=this.elements,p$q=p$h[0],p$f=p$h[1],p$g=p$h[2],p$$=p$h[3];return Math.sqrt(p$q*p$q+p$f*p$f+p$g*p$g+p$$*p$$)},p$h.rotateX=function(p$h,p$q){var p$f=p$q.elements,p$g=this.elements;p$h*=.5;var p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$g[3],p$r=Math.sin(p$h),p$Y=Math.cos(p$h);p$f[0]=p$$*p$Y+p$B*p$r,p$f[1]=p$P*p$Y+p$S*p$r,p$f[2]=p$S*p$Y-p$P*p$r,p$f[3]=p$B*p$Y-p$$*p$r},p$h.rotateY=function(p$h,p$q){var p$f=p$q.elements,p$g=this.elements;p$h*=.5;var p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$g[3],p$r=Math.sin(p$h),p$Y=Math.cos(p$h);p$f[0]=p$$*p$Y-p$S*p$r,p$f[1]=p$P*p$Y+p$B*p$r,p$f[2]=p$S*p$Y+p$$*p$r,p$f[3]=p$B*p$Y-p$P*p$r},p$h.rotateZ=function(p$h,p$q){var p$f=p$q.elements,p$g=this.elements;p$h*=.5;var p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$g[3],p$r=Math.sin(p$h),p$Y=Math.cos(p$h);p$f[0]=p$$*p$Y+p$P*p$r,p$f[1]=p$P*p$Y-p$$*p$r,p$f[2]=p$S*p$Y+p$B*p$r,p$f[3]=p$B*p$Y-p$S*p$r},p$h.getYawPitchRoll=function(p$h){p$Sq.transformQuat(p$Sq.ForwardRH,this,p$$.TEMPVector31),p$Sq.transformQuat(p$Sq.Up,this,p$$.TEMPVector32);var p$q=p$$.TEMPVector32.elements;p$$.angleTo(p$Sq.ZERO,p$$.TEMPVector31,p$$.TEMPVector33);var p$f=p$$.TEMPVector33.elements;p$f[0]==Math.PI/2?(p$f[1]=p$$.arcTanAngle(p$q[2],p$q[0]),p$f[2]=0):p$f[0]==-Math.PI/2?(p$f[1]=p$$.arcTanAngle(-p$q[2],-p$q[0]),p$f[2]=0):(p$hq.createRotationY(-p$f[1],p$$.TEMPMatrix0),p$hq.createRotationX(-p$f[0],p$$.TEMPMatrix1),p$Sq.transformCoordinate(p$$.TEMPVector32,p$$.TEMPMatrix0,p$$.TEMPVector32),p$Sq.transformCoordinate(p$$.TEMPVector32,p$$.TEMPMatrix1,p$$.TEMPVector32),p$f[2]=p$$.arcTanAngle(p$q[1],-p$q[0])),p$f[1]<=-Math.PI&&(p$f[1]=Math.PI),p$f[2]<=-Math.PI&&(p$f[2]=Math.PI),p$f[1]>=Math.PI&&p$f[2]>=Math.PI&&(p$f[1]=0,p$f[2]=0,p$f[0]=Math.PI-p$f[0]);var p$g=p$h.elements;p$g[0]=p$f[1],p$g[1]=p$f[0],p$g[2]=p$f[2]},p$h.invert=function(p$h){var p$q=p$h.elements,p$f=this.elements,p$g=p$f[0],p$$=p$f[1],p$P=p$f[2],p$S=p$f[3],p$B=p$g*p$g+p$$*p$$+p$P*p$P+p$S*p$S,p$r=p$B?1/p$B:0;p$q[0]=-p$g*p$r,p$q[1]=-p$$*p$r,p$q[2]=-p$P*p$r,p$q[3]=p$S*p$r},p$h.identity=function(){var p$h=this.elements;p$h[0]=0,p$h[1]=0,p$h[2]=0,p$h[3]=1},p$h.fromArray=function(p$h,p$q){void 0===p$q&&(p$q=0),this.elements[0]=p$h[p$q+0],this.elements[1]=p$h[p$q+1],this.elements[2]=p$h[p$q+2],this.elements[3]=p$h[p$q+3]},p$h.cloneTo=function(p$h){var p$q,p$f,p$g;if((p$f=this.elements)!==(p$g=p$h.elements))for(p$q=0;p$q<4;++p$q)p$g[p$q]=p$f[p$q]},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$h.equals=function(p$h){var p$q=this.elements,p$f=p$h.elements;return p$xh.nearEqual(p$q[0],p$f[0])&&p$xh.nearEqual(p$q[1],p$f[1])&&p$xh.nearEqual(p$q[2],p$f[2])&&p$xh.nearEqual(p$q[3],p$f[3])},p$h.lengthSquared=function(){var p$h=this.elements[0],p$q=this.elements[1],p$f=this.elements[2],p$g=this.elements[3];return p$h*p$h+p$q*p$q+p$f*p$f+p$g*p$g},p$L(0,p$h,"x",function(){return this.elements[0]}),p$L(0,p$h,"y",function(){return this.elements[1]}),p$L(0,p$h,"z",function(){return this.elements[2]}),p$L(0,p$h,"w",function(){return this.elements[3]}),p$$.createFromYawPitchRoll=function(p$h,p$q,p$f,p$g){var p$$=.5*p$f,p$P=.5*p$q,p$S=.5*p$h,p$B=Math.sin(p$$),p$r=Math.cos(p$$),p$Y=Math.sin(p$P),p$C=Math.cos(p$P),p$U=Math.sin(p$S),p$u=Math.cos(p$S),p$v=p$g.elements;p$v[0]=p$u*p$Y*p$r+p$U*p$C*p$B,p$v[1]=p$U*p$C*p$r-p$u*p$Y*p$B,p$v[2]=p$u*p$C*p$B-p$U*p$Y*p$r,p$v[3]=p$u*p$C*p$r+p$U*p$Y*p$B},p$$.multiply=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$q.elements,p$P=p$f.elements,p$S=p$g[0],p$B=p$g[1],p$r=p$g[2],p$Y=p$g[3],p$C=p$$[0],p$U=p$$[1],p$u=p$$[2],p$v=p$$[3],p$L=p$B*p$u-p$r*p$U,p$e=p$r*p$C-p$S*p$u,p$l=p$S*p$U-p$B*p$C,p$_=p$S*p$C+p$B*p$U+p$r*p$u;p$P[0]=p$S*p$v+p$C*p$Y+p$L,p$P[1]=p$B*p$v+p$U*p$Y+p$e,p$P[2]=p$r*p$v+p$u*p$Y+p$l,p$P[3]=p$Y*p$v-p$_},p$$.arcTanAngle=function(p$h,p$q){return 0==p$h?1==p$q?Math.PI/2:-Math.PI/2:0<p$h?Math.atan(p$q/p$h):p$h<0?0<p$q?Math.atan(p$q/p$h)+Math.PI:Math.atan(p$q/p$h)-Math.PI:0},p$$.angleTo=function(p$h,p$q,p$f){p$Sq.subtract(p$q,p$h,p$$.TEMPVector30),p$Sq.normalize(p$$.TEMPVector30,p$$.TEMPVector30),p$f.elements[0]=Math.asin(p$$.TEMPVector30.y),p$f.elements[1]=p$$.arcTanAngle(-p$$.TEMPVector30.z,-p$$.TEMPVector30.x)},p$$.createFromAxisAngle=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements;p$q*=.5;var p$P=Math.sin(p$q);p$g[0]=p$P*p$$[0],p$g[1]=p$P*p$$[1],p$g[2]=p$P*p$$[2],p$g[3]=Math.cos(p$q)},p$$.createFromMatrix3x3=function(p$h,p$q){var p$f,p$g=p$q.elements,p$$=p$h.elements,p$P=p$$[0]+p$$[4]+p$$[8];if(0<p$P)p$f=Math.sqrt(p$P+1),p$g[3]=.5*p$f,p$f=.5/p$f,p$g[0]=(p$$[5]-p$$[7])*p$f,p$g[1]=(p$$[6]-p$$[2])*p$f,p$g[2]=(p$$[1]-p$$[3])*p$f;else{var p$S=0;p$$[4]>p$$[0]&&(p$S=1),p$$[8]>p$$[3*p$S+p$S]&&(p$S=2);var p$B=(p$S+1)%3,p$r=(p$S+2)%3;p$f=Math.sqrt(p$$[3*p$S+p$S]-p$$[3*p$B+p$B]-p$$[3*p$r+p$r]+1),p$g[p$S]=.5*p$f,p$f=.5/p$f,p$g[3]=(p$$[3*p$B+p$r]-p$$[3*p$r+p$B])*p$f,p$g[p$B]=(p$$[3*p$B+p$S]+p$$[3*p$S+p$B])*p$f,p$g[p$r]=(p$$[3*p$r+p$S]+p$$[3*p$S+p$r])*p$f}},p$$.createFromMatrix4x4=function(p$h,p$q){var p$f,p$g,p$$=p$h.elements,p$P=p$q.elements,p$S=p$$[0]+p$$[5]+p$$[10];0<p$S?(p$f=Math.sqrt(p$S+1),p$P[3]=.5*p$f,p$f=.5/p$f,p$P[0]=(p$$[6]-p$$[9])*p$f,p$P[1]=(p$$[8]-p$$[2])*p$f,p$P[2]=(p$$[1]-p$$[4])*p$f):p$$[0]>=p$$[5]&&p$$[0]>=p$$[10]?(p$g=.5/(p$f=Math.sqrt(1+p$$[0]-p$$[5]-p$$[10])),p$P[0]=.5*p$f,p$P[1]=(p$$[1]+p$$[4])*p$g,p$P[2]=(p$$[2]+p$$[8])*p$g,p$P[3]=(p$$[6]-p$$[9])*p$g):p$$[5]>p$$[10]?(p$g=.5/(p$f=Math.sqrt(1+p$$[5]-p$$[0]-p$$[10])),p$P[0]=(p$$[4]+p$$[1])*p$g,p$P[1]=.5*p$f,p$P[2]=(p$$[9]+p$$[6])*p$g,p$P[3]=(p$$[8]-p$$[2])*p$g):(p$g=.5/(p$f=Math.sqrt(1+p$$[10]-p$$[0]-p$$[5])),p$P[0]=(p$$[8]+p$$[2])*p$g,p$P[1]=(p$$[9]+p$$[6])*p$g,p$P[2]=.5*p$f,p$P[3]=(p$$[1]-p$$[4])*p$g)},p$$.slerp=function(p$h,p$q,p$f,p$g){var p$$,p$P,p$S,p$B,p$r,p$Y=p$h.elements,p$C=p$q.elements,p$U=p$g.elements,p$u=p$Y[0],p$v=p$Y[1],p$L=p$Y[2],p$e=p$Y[3],p$l=p$C[0],p$_=p$C[1],p$N=p$C[2],p$G=p$C[3];return(p$P=p$u*p$l+p$v*p$_+p$L*p$N+p$e*p$G)<0&&(p$P=-p$P,p$l=-p$l,p$_=-p$_,p$N=-p$N,p$G=-p$G),p$r=1e-6<1-p$P?(p$$=Math.acos(p$P),p$S=Math.sin(p$$),p$B=Math.sin((1-p$f)*p$$)/p$S,Math.sin(p$f*p$$)/p$S):(p$B=1-p$f,p$f),p$U[0]=p$B*p$u+p$r*p$l,p$U[1]=p$B*p$v+p$r*p$_,p$U[2]=p$B*p$L+p$r*p$N,p$U[3]=p$B*p$e+p$r*p$G,p$U},p$$.lerp=function(p$h,p$q,p$f,p$g){var p$$=p$g.elements,p$P=p$h.elements,p$S=p$q.elements,p$B=p$P[0],p$r=p$P[1],p$Y=p$P[2],p$C=p$P[3];p$$[0]=p$B+p$f*(p$S[0]-p$B),p$$[1]=p$r+p$f*(p$S[1]-p$r),p$$[2]=p$Y+p$f*(p$S[2]-p$Y),p$$[3]=p$C+p$f*(p$S[3]-p$C)},p$$.add=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=p$$[0]+p$P[0],p$g[1]=p$$[1]+p$P[1],p$g[2]=p$$[2]+p$P[2],p$g[3]=p$$[3]+p$P[3]},p$$.dot=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;return p$f[0]*p$g[0]+p$f[1]*p$g[1]+p$f[2]*p$g[2]+p$f[3]*p$g[3]},p$$.rotationLookAt=function(p$h,p$q,p$f){p$$.lookAt(p$Sq.ZERO,p$h,p$q,p$f)},p$$.lookAt=function(p$h,p$q,p$f,p$g){p$ah.lookAt(p$h,p$q,p$f,p$$._tempMatrix3x3),p$$.rotationMatrix(p$$._tempMatrix3x3,p$g)},p$$.invert=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$h.lengthSquared();p$xh.isZero(p$$)||(p$$=1/p$$,p$g[0]=-p$f[0]*p$$,p$g[1]=-p$f[1]*p$$,p$g[2]=-p$f[2]*p$$,p$g[3]=p$f[3]*p$$)},p$$.rotationMatrix=function(p$h,p$q){var p$f=p$h.elements,p$g=p$f[0],p$$=p$f[1],p$P=p$f[2],p$S=p$f[3],p$B=p$f[4],p$r=p$f[5],p$Y=p$f[6],p$C=p$f[7],p$U=p$f[8],p$u=p$q.elements,p$v=NaN,p$L=NaN,p$e=p$g+p$B+p$U;0<p$e?(p$v=Math.sqrt(p$e+1),p$u[3]=.5*p$v,p$v=.5/p$v,p$u[0]=(p$r-p$C)*p$v,p$u[1]=(p$Y-p$P)*p$v,p$u[2]=(p$$-p$S)*p$v):p$B<=p$g&&p$U<=p$g?(p$L=.5/(p$v=Math.sqrt(1+p$g-p$B-p$U)),p$u[0]=.5*p$v,p$u[1]=(p$$+p$S)*p$L,p$u[2]=(p$P+p$Y)*p$L,p$u[3]=(p$r-p$C)*p$L):p$U<p$B?(p$L=.5/(p$v=Math.sqrt(1+p$B-p$g-p$U)),p$u[0]=(p$S+p$$)*p$L,p$u[1]=.5*p$v,p$u[2]=(p$C+p$r)*p$L,p$u[3]=(p$Y-p$P)*p$L):(p$L=.5/(p$v=Math.sqrt(1+p$U-p$g-p$B)),p$u[0]=(p$Y+p$P)*p$L,p$u[1]=(p$C+p$r)*p$L,p$u[2]=.5*p$v,p$u[3]=(p$$-p$S)*p$L)},p$$.DEFAULT=new p$$,p$U(p$$,["TEMPVector30",function(){return this.TEMPVector30=new p$Sq},"TEMPVector31",function(){return this.TEMPVector31=new p$Sq},"TEMPVector32",function(){return this.TEMPVector32=new p$Sq},"TEMPVector33",function(){return this.TEMPVector33=new p$Sq},"TEMPMatrix0",function(){return this.TEMPMatrix0=new p$hq},"TEMPMatrix1",function(){return this.TEMPMatrix1=new p$hq},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new p$ah},"NAN",function(){return this.NAN=new p$$(NaN,NaN,NaN,NaN)}]),p$$}(),p$gq=function(){function p$h(p$h){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=p$h,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}p$v(p$h,"laya.d3.math.Rand");var p$q=p$h.prototype;return p$q.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},p$q.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},p$q.getSignedFloat=function(){return 2*this.getFloat()-1},p$L(0,p$q,"seed",function(){return this.seeds[0]},function(p$h){this.seeds[0]=p$h,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),p$h.getFloatFromInt=function(p$h){return 1/8388607*(8388607&p$h)},p$h.getByteFromInt=function(p$h){return(8388607&p$h)>>>15},p$h}(),p$$q=(function(){function p$$(p$h){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(p$h instanceof Array)||4!==p$h.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|p$h[0],this._state0L=0|p$h[1],this._state1U=0|p$h[2],this._state1L=0|p$h[3]}p$v(p$$,"laya.d3.math.RandX");var p$h=p$$.prototype;p$h.randomint=function(){var p$h=this._state0U,p$q=this._state0L,p$f=this._state1U,p$g=this._state1L,p$$=(p$g>>>0)+(p$q>>>0),p$P=p$f+p$h+(p$$/2>>>31)>>>0,p$S=p$$>>>0,p$B=0,p$r=0;p$B=(p$h^=p$B=p$h<<23|(-512&p$q)>>>9)^(this._state0U=p$f),p$r=(p$q^=p$r=p$q<<23)^(this._state0L=p$g);p$B^=p$h>>>18,p$r^=p$q>>>18|(262143&p$h)<<14;return p$B^=p$f>>>5,p$r^=p$g>>>5|(31&p$f)<<27,this._state1U=p$B,this._state1L=p$r,[p$P,p$S]},p$h.random=function(){var p$h=this.randomint(),p$q=p$h[0],p$f=1023<<20|p$q>>>12,p$g=0|(p$h[1]>>>12|(4095&p$q)<<20);return p$$._CONVERTION_BUFFER.setUint32(0,p$f,!1),p$$._CONVERTION_BUFFER.setUint32(4,p$g,!1),p$gq._CONVERTION_BUFFER.getFloat64(0,!1)-1},p$U(p$$,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new p$gq([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function p$h(p$h,p$q){this.origin=null,this.direction=null,this.origin=p$h,this.direction=p$q}return p$v(p$h,"laya.d3.math.Ray"),p$h}()),p$Pq=function(){function p$h(p$h,p$q){this.elements=new Float32Array(2),void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0);var p$f=this.elements;p$f[0]=p$h,p$f[1]=p$q}p$v(p$h,"laya.d3.math.Vector2");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.fromArray=function(p$h,p$q){void 0===p$q&&(p$q=0),this.elements[0]=p$h[p$q+0],this.elements[1]=p$h[p$q+1]},p$q.cloneTo=function(p$h){var p$q=p$h.elements,p$f=this.elements;p$q[0]=p$f[0],p$q[1]=p$f[1]},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"x",function(){return this.elements[0]},function(p$h){this.elements[0]=p$h}),p$L(0,p$q,"y",function(){return this.elements[1]},function(p$h){this.elements[1]=p$h}),p$h.scale=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements;p$g[0]=p$$[0]*p$q,p$g[1]=p$$[1]*p$q},p$U(p$h,["ZERO",function(){return this.ZERO=new p$h(0,0)},"ONE",function(){return this.ONE=new p$h(1,1)}]),p$h}(),p$Sq=function(){function p$C(p$h,p$q,p$f){this.elements=new Float32Array(3),void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0);var p$g=this.elements;p$g[0]=p$h,p$g[1]=p$q,p$g[2]=p$f}p$v(p$C,"laya.d3.math.Vector3");var p$h=p$C.prototype;return p$E.imps(p$h,{"laya.d3.core.IClone":!0}),p$h.fromArray=function(p$h,p$q){void 0===p$q&&(p$q=0),this.elements[0]=p$h[p$q+0],this.elements[1]=p$h[p$q+1],this.elements[2]=p$h[p$q+2]},p$h.cloneTo=function(p$h){var p$q=p$h.elements,p$f=this.elements;p$q[0]=p$f[0],p$q[1]=p$f[1],p$q[2]=p$f[2]},p$h.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$h.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},p$h.reset=function(p$h,p$q,p$f){this.elements[0]=p$h,this.elements[1]=p$q,this.elements[2]=p$f},p$L(0,p$h,"x",function(){return this.elements[0]},function(p$h){this.elements[0]=p$h}),p$L(0,p$h,"y",function(){return this.elements[1]},function(p$h){this.elements[1]=p$h}),p$L(0,p$h,"z",function(){return this.elements[2]},function(p$h){this.elements[2]=p$h}),p$C.distanceSquared=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$f[0]-p$g[0],p$P=p$f[1]-p$g[1],p$S=p$f[2]-p$g[2];return p$$*p$$+p$P*p$P+p$S*p$S},p$C.distance=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$f[0]-p$g[0],p$P=p$f[1]-p$g[1],p$S=p$f[2]-p$g[2];return Math.sqrt(p$$*p$$+p$P*p$P+p$S*p$S)},p$C.min=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=Math.min(p$$[0],p$P[0]),p$g[1]=Math.min(p$$[1],p$P[1]),p$g[2]=Math.min(p$$[2],p$P[2])},p$C.max=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=Math.max(p$$[0],p$P[0]),p$g[1]=Math.max(p$$[1],p$P[1]),p$g[2]=Math.max(p$$[2],p$P[2])},p$C.transformQuat=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements,p$S=p$$[0],p$B=p$$[1],p$r=p$$[2],p$Y=p$P[0],p$C=p$P[1],p$U=p$P[2],p$u=p$P[3],p$v=p$u*p$S+p$C*p$r-p$U*p$B,p$L=p$u*p$B+p$U*p$S-p$Y*p$r,p$e=p$u*p$r+p$Y*p$B-p$C*p$S,p$l=-p$Y*p$S-p$C*p$B-p$U*p$r;p$g[0]=p$v*p$u+p$l*-p$Y+p$L*-p$U-p$e*-p$C,p$g[1]=p$L*p$u+p$l*-p$C+p$e*-p$Y-p$v*-p$U,p$g[2]=p$e*p$u+p$l*-p$U+p$v*-p$C-p$L*-p$Y},p$C.scalarLength=function(p$h){var p$q=p$h.elements,p$f=p$q[0],p$g=p$q[1],p$$=p$q[2];return Math.sqrt(p$f*p$f+p$g*p$g+p$$*p$$)},p$C.scalarLengthSquared=function(p$h){var p$q=p$h.elements,p$f=p$q[0],p$g=p$q[1],p$$=p$q[2];return p$f*p$f+p$g*p$g+p$$*p$$},p$C.normalize=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$f[0],p$P=p$f[1],p$S=p$f[2],p$B=p$$*p$$+p$P*p$P+p$S*p$S;0<p$B&&(p$B=1/Math.sqrt(p$B),p$g[0]=p$f[0]*p$B,p$g[1]=p$f[1]*p$B,p$g[2]=p$f[2]*p$B)},p$C.multiply=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=p$$[0]*p$P[0],p$g[1]=p$$[1]*p$P[1],p$g[2]=p$$[2]*p$P[2]},p$C.scale=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements;p$g[0]=p$$[0]*p$q,p$g[1]=p$$[1]*p$q,p$g[2]=p$$[2]*p$q},p$C.lerp=function(p$h,p$q,p$f,p$g){var p$$=p$g.elements,p$P=p$h.elements,p$S=p$q.elements,p$B=p$P[0],p$r=p$P[1],p$Y=p$P[2];p$$[0]=p$B+p$f*(p$S[0]-p$B),p$$[1]=p$r+p$f*(p$S[1]-p$r),p$$[2]=p$Y+p$f*(p$S[2]-p$Y)},p$C.transformV3ToV3=function(p$h,p$q,p$f){var p$g=p$C._tempVector4;p$C.transformV3ToV4(p$h,p$q,p$g);var p$$=p$g.elements,p$P=p$f.elements;p$P[0]=p$$[0],p$P[1]=p$$[1],p$P[2]=p$$[2]},p$C.transformV3ToV4=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$q.elements,p$r=p$f.elements;p$r[0]=p$$*p$B[0]+p$P*p$B[4]+p$S*p$B[8]+p$B[12],p$r[1]=p$$*p$B[1]+p$P*p$B[5]+p$S*p$B[9]+p$B[13],p$r[2]=p$$*p$B[2]+p$P*p$B[6]+p$S*p$B[10]+p$B[14],p$r[3]=p$$*p$B[3]+p$P*p$B[7]+p$S*p$B[11]+p$B[15]},p$C.TransformNormal=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$q.elements,p$r=p$f.elements;p$r[0]=p$$*p$B[0]+p$P*p$B[4]+p$S*p$B[8],p$r[1]=p$$*p$B[1]+p$P*p$B[5]+p$S*p$B[9],p$r[2]=p$$*p$B[2]+p$P*p$B[6]+p$S*p$B[10]},p$C.transformCoordinate=function(p$h,p$q,p$f){var p$g=p$C._tempVector4.elements,p$$=p$h.elements,p$P=p$$[0],p$S=p$$[1],p$B=p$$[2],p$r=p$q.elements;p$g[0]=p$P*p$r[0]+p$S*p$r[4]+p$B*p$r[8]+p$r[12],p$g[1]=p$P*p$r[1]+p$S*p$r[5]+p$B*p$r[9]+p$r[13],p$g[2]=p$P*p$r[2]+p$S*p$r[6]+p$B*p$r[10]+p$r[14],p$g[3]=1/(p$P*p$r[3]+p$S*p$r[7]+p$B*p$r[11]+p$r[15]);var p$Y=p$f.elements;p$Y[0]=p$g[0]*p$g[3],p$Y[1]=p$g[1]*p$g[3],p$Y[2]=p$g[2]*p$g[3]},p$C.Clamp=function(p$h,p$q,p$f,p$g){var p$$=p$h.elements,p$P=p$$[0],p$S=p$$[1],p$B=p$$[2],p$r=p$q.elements,p$Y=p$r[0],p$C=p$r[1],p$U=p$r[2],p$u=p$f.elements,p$v=p$u[0],p$L=p$u[1],p$e=p$u[2],p$l=p$g.elements;p$P=(p$P=p$v<p$P?p$v:p$P)<p$Y?p$Y:p$P,p$S=(p$S=p$L<p$S?p$L:p$S)<p$C?p$C:p$S,p$B=(p$B=p$e<p$B?p$e:p$B)<p$U?p$U:p$B,p$l[0]=p$P,p$l[1]=p$S,p$l[2]=p$B},p$C.add=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=p$$[0]+p$P[0],p$g[1]=p$$[1]+p$P[1],p$g[2]=p$$[2]+p$P[2]},p$C.subtract=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=p$$[0]-p$P[0],p$g[1]=p$$[1]-p$P[1],p$g[2]=p$$[2]-p$P[2]},p$C.cross=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$q.elements,p$P=p$f.elements,p$S=p$g[0],p$B=p$g[1],p$r=p$g[2],p$Y=p$$[0],p$C=p$$[1],p$U=p$$[2];p$P[0]=p$B*p$U-p$r*p$C,p$P[1]=p$r*p$Y-p$S*p$U,p$P[2]=p$S*p$C-p$B*p$Y},p$C.dot=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;return p$f[0]*p$g[0]+p$f[1]*p$g[1]+p$f[2]*p$g[2]},p$C.equals=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;return p$xh.nearEqual(Math.abs(p$f[0]),Math.abs(p$g[0]))&&p$xh.nearEqual(Math.abs(p$f[1]),Math.abs(p$g[1]))&&p$xh.nearEqual(Math.abs(p$f[2]),Math.abs(p$g[2]))},p$C.ZERO=new p$C(0,0,0),p$C.ONE=new p$C(1,1,1),p$C.NegativeUnitX=new p$C(-1,0,0),p$C.UnitX=new p$C(1,0,0),p$C.UnitY=new p$C(0,1,0),p$C.UnitZ=new p$C(0,0,1),p$C.ForwardRH=new p$C(0,0,-1),p$C.ForwardLH=new p$C(0,0,1),p$C.Up=new p$C(0,1,0),p$C.NAN=new p$C(NaN,NaN,NaN),p$U(p$C,["_tempVector4",function(){return this._tempVector4=new p$Bq}]),p$C}(),p$Bq=function(){function p$h(p$h,p$q,p$f,p$g){this.elements=new Float32Array(4),void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=0);var p$$=this.elements;p$$[0]=p$h,p$$[1]=p$q,p$$[2]=p$f,p$$[3]=p$g}p$v(p$h,"laya.d3.math.Vector4");var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q.fromArray=function(p$h,p$q){void 0===p$q&&(p$q=0),this.elements[0]=p$h[p$q+0],this.elements[1]=p$h[p$q+1],this.elements[2]=p$h[p$q+2],this.elements[3]=p$h[p$q+3]},p$q.cloneTo=function(p$h){var p$q=p$h.elements,p$f=this.elements;p$q[0]=p$f[0],p$q[1]=p$f[1],p$q[2]=p$f[2],p$q[3]=p$f[3]},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$q.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},p$q.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},p$L(0,p$q,"x",function(){return this.elements[0]},function(p$h){this.elements[0]=p$h}),p$L(0,p$q,"y",function(){return this.elements[1]},function(p$h){this.elements[1]=p$h}),p$L(0,p$q,"z",function(){return this.elements[2]},function(p$h){this.elements[2]=p$h}),p$L(0,p$q,"w",function(){return this.elements[3]},function(p$h){this.elements[3]=p$h}),p$h.lerp=function(p$h,p$q,p$f,p$g){var p$$=p$g.elements,p$P=p$h.elements,p$S=p$q.elements,p$B=p$P[0],p$r=p$P[1],p$Y=p$P[2],p$C=p$P[3];p$$[0]=p$B+p$f*(p$S[0]-p$B),p$$[1]=p$r+p$f*(p$S[1]-p$r),p$$[2]=p$Y+p$f*(p$S[2]-p$Y),p$$[3]=p$C+p$f*(p$S[3]-p$C)},p$h.transformByM4x4=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$g[0],p$P=p$g[1],p$S=p$g[2],p$B=p$g[3],p$r=p$q.elements,p$Y=p$f.elements;p$Y[0]=p$$*p$r[0]+p$P*p$r[4]+p$S*p$r[8]+p$B*p$r[12],p$Y[1]=p$$*p$r[1]+p$P*p$r[5]+p$S*p$r[9]+p$B*p$r[13],p$Y[2]=p$$*p$r[2]+p$P*p$r[6]+p$S*p$r[10]+p$B*p$r[14],p$Y[3]=p$$*p$r[3]+p$P*p$r[7]+p$S*p$r[11]+p$B*p$r[15]},p$h.equals=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;return p$xh.nearEqual(Math.abs(p$f[0]),Math.abs(p$g[0]))&&p$xh.nearEqual(Math.abs(p$f[1]),Math.abs(p$g[1]))&&p$xh.nearEqual(Math.abs(p$f[2]),Math.abs(p$g[2]))&&p$xh.nearEqual(Math.abs(p$f[3]),Math.abs(p$g[3]))},p$h.normalize=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$h.length();0<p$$&&(p$g[0]=p$f[0]*p$$,p$g[1]=p$f[1]*p$$,p$g[2]=p$f[2]*p$$,p$g[3]=p$f[3]*p$$)},p$h.add=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=p$$[0]+p$P[0],p$g[1]=p$$[1]+p$P[1],p$g[2]=p$$[2]+p$P[2],p$g[3]=p$$[3]+p$P[3]},p$h.subtract=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=p$$[0]-p$P[0],p$g[1]=p$$[1]-p$P[1],p$g[2]=p$$[2]-p$P[2],p$g[3]=p$$[3]-p$P[3]},p$h.multiply=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=p$$[0]*p$P[0],p$g[1]=p$$[1]*p$P[1],p$g[2]=p$$[2]*p$P[2],p$g[3]=p$$[3]*p$P[3]},p$h.scale=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements;p$g[0]=p$$[0]*p$q,p$g[1]=p$$[1]*p$q,p$g[2]=p$$[2]*p$q,p$g[3]=p$$[3]*p$q},p$h.Clamp=function(p$h,p$q,p$f,p$g){var p$$=p$h.elements,p$P=p$$[0],p$S=p$$[1],p$B=p$$[2],p$r=p$$[3],p$Y=p$q.elements,p$C=p$Y[0],p$U=p$Y[1],p$u=p$Y[2],p$v=p$Y[3],p$L=p$f.elements,p$e=p$L[0],p$l=p$L[1],p$_=p$L[2],p$N=p$L[3],p$G=p$g.elements;p$P=(p$P=p$e<p$P?p$e:p$P)<p$C?p$C:p$P,p$S=(p$S=p$l<p$S?p$l:p$S)<p$U?p$U:p$S,p$B=(p$B=p$_<p$B?p$_:p$B)<p$u?p$u:p$B,p$r=(p$r=p$N<p$r?p$N:p$r)<p$v?p$v:p$r,p$G[0]=p$P,p$G[1]=p$S,p$G[2]=p$B,p$G[3]=p$r},p$h.distanceSquared=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$f[0]-p$g[0],p$P=p$f[1]-p$g[1],p$S=p$f[2]-p$g[2],p$B=p$f[3]-p$g[3];return p$$*p$$+p$P*p$P+p$S*p$S+p$B*p$B},p$h.distance=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements,p$$=p$f[0]-p$g[0],p$P=p$f[1]-p$g[1],p$S=p$f[2]-p$g[2],p$B=p$f[3]-p$g[3];return Math.sqrt(p$$*p$$+p$P*p$P+p$S*p$S+p$B*p$B)},p$h.dot=function(p$h,p$q){var p$f=p$h.elements,p$g=p$q.elements;return p$f[0]*p$g[0]+p$f[1]*p$g[1]+p$f[2]*p$g[2]+p$f[3]*p$g[3]},p$h.min=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=Math.min(p$$[0],p$P[0]),p$g[1]=Math.min(p$$[1],p$P[1]),p$g[2]=Math.min(p$$[2],p$P[2]),p$g[3]=Math.min(p$$[3],p$P[3])},p$h.max=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q.elements;p$g[0]=Math.max(p$$[0],p$P[0]),p$g[1]=Math.max(p$$[1],p$P[1]),p$g[2]=Math.max(p$$[2],p$P[2]),p$g[3]=Math.max(p$$[3],p$P[3])},p$U(p$h,["ZERO",function(){return this.ZERO=new p$h},"ONE",function(){return this.ONE=new p$h(1,1,1,1)},"UnitX",function(){return this.UnitX=new p$h(1,0,0,0)},"UnitY",function(){return this.UnitY=new p$h(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new p$h(0,0,1,0)},"UnitW",function(){return this.UnitW=new p$h(0,0,0,1)}]),p$h}(),p$rq=function(){function p$P(p$h,p$q,p$f,p$g){this.minDepth=0,this.maxDepth=1,this.x=p$h,this.y=p$q,this.width=p$f,this.height=p$g}p$v(p$P,"laya.d3.math.Viewport");var p$h=p$P.prototype;return p$h.project=function(p$h,p$q,p$f){p$Sq.transformV3ToV3(p$h,p$q,p$f);var p$g=p$h.elements,p$$=p$q.elements,p$P=p$f.elements,p$S=p$g[0]*p$$[3]+p$g[1]*p$$[7]+p$g[2]*p$$[11]+p$$[15];1!==p$S&&(p$P[0]=p$P[0]/p$S,p$P[1]=p$P[1]/p$S,p$P[2]=p$P[2]/p$S),p$P[0]=.5*(p$P[0]+1)*this.width+this.x,p$P[1]=.5*(1-p$P[1])*this.height+this.y,p$P[2]=p$P[2]*(this.maxDepth-this.minDepth)+this.minDepth},p$h.unprojectFromMat=function(p$h,p$q,p$f){var p$g=p$h.elements,p$$=p$q.elements,p$P=p$f.elements;p$P[0]=(p$g[0]-this.x)/this.width*2-1,p$P[1]=-((p$g[1]-this.y)/this.height*2-1);var p$S=(this.maxDepth-this.minDepth)/2;p$P[2]=(p$g[2]-this.minDepth-p$S)/p$S;var p$B=p$P[0]*p$$[3]+p$P[1]*p$$[7]+p$P[2]*p$$[11]+p$$[15];p$Sq.transformV3ToV3(p$f,p$q,p$f),1!==p$B&&(p$P[0]=p$P[0]/p$B,p$P[1]=p$P[1]/p$B,p$P[2]=p$P[2]/p$B)},p$h.unprojectFromWVP=function(p$h,p$q,p$f,p$g,p$$){p$hq.multiply(p$q,p$f,p$P._tempMatrix4x4),p$g&&p$hq.multiply(p$P._tempMatrix4x4,p$g,p$P._tempMatrix4x4),p$P._tempMatrix4x4.invert(p$P._tempMatrix4x4),this.unprojectFromMat(p$h,p$P._tempMatrix4x4,p$$)},p$U(p$P,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new p$hq}]),p$P}(),p$Yq=function(){function p$A(p$h){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=p$h,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}p$v(p$A,"laya.d3.resource.models.SubMesh");var p$h=p$A.prototype;return p$E.imps(p$h,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),p$h._getVertexBuffer=function(p$h){return void 0===p$h&&(p$h=0),0===p$h?this._vertexBuffer:null},p$h._getIndexBuffer=function(){return this._indexBuffer},p$h._getStaticBatchBakedVertexs=function(p$h,p$q){var p$f,p$g,p$$=this._vertexBuffer,p$P=p$$.vertexDeclaration,p$S=p$P.getVertexElementByUsage(0).offset/4,p$B=p$P.getVertexElementByUsage(3).offset/4,p$r=p$q.meshRender.lightmapScaleOffset,p$Y=0,p$C=0,p$U=0,p$u=0,p$v=0,p$L=0;if(p$r)if(p$g=p$P.getVertexElementByUsage(15))p$U=p$P.vertexStride/4,p$f=0<this._vertexCount?p$$.getData().slice(this._vertexStart*p$U,(this._vertexStart+this._vertexCount)*p$U):p$$.getData().slice(),p$u=p$g.offset/4;else{p$U=(p$L=p$P.vertexStride/4)+2,p$f=this._vertexCount?new Float32Array(this._vertexCount*(p$$.vertexDeclaration.vertexStride/4+2)):new Float32Array(p$$.vertexCount*(p$$.vertexDeclaration.vertexStride/4+2)),p$u=(p$v=p$P.getVertexElementByUsage(2).offset/4)+2;var p$e=p$$.getData();for(p$Y=0,p$C=p$e.length/p$L;p$Y<p$C;p$Y++){var p$l=0;p$l=0<this._vertexCount?(this._vertexStart+p$Y)*p$L:p$Y*p$L;var p$_=p$Y*p$U,p$N=0;for(p$N=0;p$N<p$u;p$N++)p$f[p$_+p$N]=p$e[p$l+p$N];for(p$N=p$u;p$N<p$L;p$N++)p$f[p$_+p$N+2]=p$e[p$l+p$N]}}else p$U=p$P.vertexStride/4,p$f=this._vertexCount?p$$.getData().slice(this._vertexStart*p$U,(this._vertexStart+this._vertexCount)*p$U):p$$.getData().slice();if(p$h){var p$G=p$h.worldMatrix,p$m=p$A._tempMatrix4x40;p$G.invert(p$m);var p$E=p$A._tempMatrix4x41,p$R=p$q.transform.worldMatrix;p$hq.multiply(p$m,p$R,p$E)}else p$E=p$q.transform.worldMatrix;var p$t=p$A._tempQuaternion0;for(p$E.decomposeTransRotScale(p$A._tempVector30,p$t,p$A._tempVector31),p$Y=0,p$C=p$f.length/p$U;p$Y<p$C;p$Y++){var p$X=p$Y*p$U+p$S,p$n=p$Y*p$U+p$B;if(p$lq.transformVector3ArrayToVector3ArrayCoordinate(p$f,p$X,p$E,p$f,p$X),p$lq.transformVector3ArrayByQuat(p$f,p$n,p$t,p$f,p$n),p$r){var p$J=p$Y*p$U+p$u;if(p$g)p$lq.transformLightingMapTexcoordByUV1Array(p$f,p$J,p$r,p$f,p$J);else{var p$p=p$Y*p$L+p$v;p$lq.transformLightingMapTexcoordByUV0Array(p$e,p$p,p$r,p$f,p$J)}}}return p$f},p$h._getVertexBuffers=function(){return null},p$h._beforeRender=function(p$h){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},p$h._render=function(p$h){var p$q,p$f=0,p$g=p$h.renderElement;if(1<this._indexCount){var p$$=this._boneIndicesList.length;if(1<p$$){for(var p$P=0;p$P<p$$;p$P++)(p$q=p$g._skinAnimationDatas||this._skinAnimationDatas)&&(p$g._shaderValue.setValue(0,p$q[p$P]),p$h._shader.uploadRenderElementUniforms(p$g._shaderValue.data)),p$d.mainContext.drawElements(4,this._subIndexBufferCount[p$P],5123,2*this._subIndexBufferStart[p$P]);p$X.drawCall+=p$$}else(p$q=p$g._skinAnimationDatas||this._skinAnimationDatas)&&(p$g._shaderValue.setValue(0,p$q[0]),p$h._shader.uploadRenderElementUniforms(p$g._shaderValue.data)),p$d.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),p$X.drawCall++;p$f=this._indexCount}else p$f=this._indexBuffer.indexCount,(p$q=p$g._skinAnimationDatas||this._skinAnimationDatas)&&(p$g._shaderValue.setValue(0,p$q[0]),p$h._shader.uploadRenderElementUniforms(p$g._shaderValue.data)),p$d.mainContext.drawElements(4,p$f,5123,0),p$X.drawCall++;p$X.trianglesFaces+=p$f/3},p$h.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},p$h.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},p$L(0,p$h,"_vertexBufferCount",function(){return 1}),p$L(0,p$h,"triangleCount",function(){return this._indexBuffer.indexCount/3}),p$U(p$A,["_tempVector30",function(){return this._tempVector30=new p$Sq},"_tempVector31",function(){return this._tempVector31=new p$Sq},"_tempQuaternion0",function(){return this._tempQuaternion0=new p$fq},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new p$hq},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new p$hq}]),p$A}(),p$Cq=function(){function p$h(p$h){this.defineCounter=0,this.defines=null,p$h?(this.defineCounter=p$h.defineCounter,this.defines=p$h.defines.slice()):(this.defineCounter=0,this.defines=[])}return p$v(p$h,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),p$h.prototype.registerDefine=function(p$h){var p$q=Math.pow(2,this.defineCounter++);return this.defines[p$q]=p$h,p$q},p$h}(),p$Uq=function(){function p$h(){}return p$v(p$h,"laya.d3.shader.ShaderInit3D"),p$h.__init__=function(){var p$h,p$q;p$Xq._globalRegDefine("HIGHPRECISION",p$Xq.SHADERDEFINE_HIGHPRECISION),p$Xq._globalRegDefine("FOG",p$Xq.SHADERDEFINE_FOG),p$Xq._globalRegDefine("DIRECTIONLIGHT",p$Xq.SHADERDEFINE_DIRECTIONLIGHT),p$Xq._globalRegDefine("POINTLIGHT",p$Xq.SHADERDEFINE_POINTLIGHT),p$Xq._globalRegDefine("SPOTLIGHT",p$Xq.SHADERDEFINE_SPOTLIGHT),p$Xq._globalRegDefine("UV",p$Xq.SHADERDEFINE_UV0),p$Xq._globalRegDefine("COLOR",p$Xq.SHADERDEFINE_COLOR),p$Xq._globalRegDefine("UV1",p$Xq.SHADERDEFINE_UV1),p$Xq._globalRegDefine("CASTSHADOW",p$vq.SHADERDEFINE_CAST_SHADOW),p$Xq._globalRegDefine("SHADOWMAP_PSSM1",p$vq.SHADERDEFINE_SHADOW_PSSM1),p$Xq._globalRegDefine("SHADOWMAP_PSSM2",p$vq.SHADERDEFINE_SHADOW_PSSM2),p$Xq._globalRegDefine("SHADOWMAP_PSSM3",p$vq.SHADERDEFINE_SHADOW_PSSM3),p$Xq._globalRegDefine("SHADOWMAP_PCF_NO",p$vq.SHADERDEFINE_SHADOW_PCF_NO),p$Xq._globalRegDefine("SHADOWMAP_PCF1",p$vq.SHADERDEFINE_SHADOW_PCF1),p$Xq._globalRegDefine("SHADOWMAP_PCF2",p$vq.SHADERDEFINE_SHADOW_PCF2),p$Xq._globalRegDefine("SHADOWMAP_PCF3",p$vq.SHADERDEFINE_SHADOW_PCF3),p$Xq._globalRegDefine("DEPTHFOG",p$Xq.SAHDERDEFINE_DEPTHFOG),p$Wq.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),p$Wq.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),p$h={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},p$q={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var p$f=p$Wq.nameKey.add("SIMPLE");shaderCompile=p$Xq.add(p$f,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',p$h,p$q),p$Tq.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),p$Tq.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),p$Tq.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),p$Tq.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),p$Tq.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),p$Tq.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),p$Tq.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),p$Tq.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),p$Tq.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},p$h}(),p$uq=function(){function p$h(){this._data=null,this._data=[]}p$v(p$h,"laya.d3.shader.ValusArray");var p$q=p$h.prototype;return p$q.setValue=function(p$h,p$q){this._data[p$h]=p$q},p$L(0,p$q,"data",function(){return this._data}),p$h}(),p$vq=function(){function p$h(){}return p$h.SHADERDEFINE_RECEIVE_SHADOW=1,p$h.SHADERDEFINE_CAST_SHADOW=512,p$h.SHADERDEFINE_SHADOW_PSSM1=1024,p$h.SHADERDEFINE_SHADOW_PSSM2=2048,p$h.SHADERDEFINE_SHADOW_PSSM3=4096,p$h.SHADERDEFINE_SHADOW_PCF_NO=8192,p$h.SHADERDEFINE_SHADOW_PCF1=16384,p$h.SHADERDEFINE_SHADOW_PCF2=32768,p$h.SHADERDEFINE_SHADOW_PCF3=65536,p$h.MAX_PSSM_COUNT=3,p$h}(),p$Lq=function(){function p$Z(){}return p$v(p$Z,"laya.d3.utils.Picker"),p$Z.calculateCursorRay=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$h.elements[0],p$B=p$h.elements[1],p$r=p$Z._tempVector30,p$Y=p$r.elements;p$Y[0]=p$S,p$Y[1]=p$B,p$Y[2]=p$q.minDepth;var p$C=p$Z._tempVector31,p$U=p$C.elements;p$U[0]=p$S,p$U[1]=p$B,p$U[2]=p$q.maxDepth;var p$u=p$P.origin,p$v=p$Z._tempVector32;p$q.unprojectFromWVP(p$r,p$f,p$g,p$$,p$u),p$q.unprojectFromWVP(p$C,p$f,p$g,p$$,p$v);var p$L=p$P.direction.elements;p$L[0]=p$v.x-p$u.x,p$L[1]=p$v.y-p$u.y,p$L[2]=p$v.z-p$u.z,p$Sq.normalize(p$P.direction,p$P.direction)},p$Z.rayIntersectsPositionsAndIndices=function(p$h,p$q,p$f,p$g,p$$){for(var p$P=p$f.vertexStride/4,p$S=p$f.getVertexElementByUsage(0).offset/4,p$B=Number.MAX_VALUE,p$r=-1,p$Y=-1,p$C=-1,p$U=0;p$U<p$g.length;p$U+=3){var p$u=p$Z._tempVector35,p$v=p$u.elements,p$L=p$g[p$U]*p$P,p$e=p$L+p$S;p$v[0]=p$q[p$e],p$v[1]=p$q[1+p$e],p$v[2]=p$q[2+p$e];var p$l=p$Z._tempVector36,p$_=p$l.elements,p$N=p$g[p$U+1]*p$P,p$G=p$N+p$S;p$_[0]=p$q[p$G],p$_[1]=p$q[1+p$G],p$_[2]=p$q[2+p$G];var p$m=p$Z._tempVector37,p$E=p$m.elements,p$R=p$g[p$U+2]*p$P,p$t=p$R+p$S;p$E[0]=p$q[p$t],p$E[1]=p$q[1+p$t],p$E[2]=p$q[2+p$t];var p$X=laya.d3.utils.Picker.rayIntersectsTriangle(p$h,p$u,p$l,p$m);!isNaN(p$X)&&p$X<p$B&&(p$B=p$X,p$r=p$L,p$Y=p$N,p$C=p$R)}if(p$B===Number.MAX_VALUE)return p$$.position.toDefault(),p$$.distance=Number.MAX_VALUE,p$$.trianglePositions[0].toDefault(),p$$.trianglePositions[1].toDefault(),p$$.trianglePositions[2].toDefault(),p$$.triangleNormals[0].toDefault(),p$$.triangleNormals[1].toDefault(),p$$.triangleNormals[2].toDefault(),!1;p$$.distance=p$B,p$Sq.scale(p$h.direction,p$B,p$$.position),p$Sq.add(p$h.origin,p$$.position,p$$.position);var p$n=p$$.trianglePositions,p$J=p$n[0],p$p=p$n[1],p$A=p$n[2],p$d=p$J.elements,p$b=p$p.elements,p$i=p$A.elements,p$z=p$r+p$S;p$d[0]=p$q[p$z],p$d[1]=p$q[p$z+1],p$d[2]=p$q[p$z+2];var p$c=p$Y+p$S;p$b[0]=p$q[p$c],p$b[1]=p$q[p$c+1],p$b[2]=p$q[p$c+2];var p$M=p$C+p$S;p$i[0]=p$q[p$M],p$i[1]=p$q[p$M+1],p$i[2]=p$q[p$M+2];var p$W=p$f.getVertexElementByUsage(3);if(p$W){var p$T=p$W.offset/4,p$I=p$$.triangleNormals,p$w=p$I[0],p$k=p$I[1],p$H=p$I[2],p$D=p$w.elements,p$s=p$k.elements,p$V=p$H.elements,p$K=p$r+p$T;p$D[0]=p$q[p$K],p$D[1]=p$q[p$K+1],p$D[2]=p$q[p$K+2];var p$y=p$Y+p$T;p$s[0]=p$q[p$y],p$s[1]=p$q[p$y+1],p$s[2]=p$q[p$y+2];var p$F=p$C+p$T;p$V[0]=p$q[p$F],p$V[1]=p$q[p$F+1],p$V[2]=p$q[p$F+2]}return!0},p$Z.rayIntersectsTriangle=function(p$h,p$q,p$f,p$g){var p$$=p$Z._tempVector30,p$P=p$Z._tempVector31;p$Sq.subtract(p$f,p$q,p$$),p$Sq.subtract(p$g,p$q,p$P);var p$S,p$B=p$Z._tempVector32;if(p$Sq.cross(p$h.direction,p$P,p$B),(p$S=p$Sq.dot(p$$,p$B))>-Number.MIN_VALUE&&p$S<Number.MIN_VALUE)return Number.NaN;var p$r,p$Y=1/p$S,p$C=p$Z._tempVector33;if(p$Sq.subtract(p$h.origin,p$q,p$C),p$r=p$Sq.dot(p$C,p$B),(p$r*=p$Y)<0||1<p$r)return Number.NaN;var p$U,p$u,p$v=p$Z._tempVector34;return p$Sq.cross(p$C,p$$,p$v),p$U=p$Sq.dot(p$h.direction,p$v),(p$U*=p$Y)<0||1<p$r+p$U?Number.NaN:(p$u=p$Sq.dot(p$P,p$v),(p$u*=p$Y)<0?Number.NaN:p$u)},p$U(p$Z,["_tempVector30",function(){return this._tempVector30=new p$Sq},"_tempVector31",function(){return this._tempVector31=new p$Sq},"_tempVector32",function(){return this._tempVector32=new p$Sq},"_tempVector33",function(){return this._tempVector33=new p$Sq},"_tempVector34",function(){return this._tempVector34=new p$Sq},"_tempVector35",function(){return this._tempVector35=new p$Sq},"_tempVector36",function(){return this._tempVector36=new p$Sq},"_tempVector37",function(){return this._tempVector37=new p$Sq}]),p$Z}(),p$eq=(function(){function p$h(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new p$Sq,new p$Sq,new p$Sq],this.trianglePositions.length=3,this.triangleNormals=[new p$Sq,new p$Sq,new p$Sq],this.triangleNormals.length=3,this.position=new p$Sq}p$v(p$h,"laya.d3.utils.RaycastHit"),p$h.prototype.cloneTo=function(p$h){p$h.distance=this.distance,this.trianglePositions[0].cloneTo(p$h.trianglePositions[0]),this.trianglePositions[1].cloneTo(p$h.trianglePositions[1]),this.trianglePositions[2].cloneTo(p$h.trianglePositions[2]),this.triangleNormals[0].cloneTo(p$h.triangleNormals[0]),this.triangleNormals[1].cloneTo(p$h.triangleNormals[1]),this.triangleNormals[2].cloneTo(p$h.triangleNormals[2]),this.position.cloneTo(p$h.position),p$h.sprite3D=this.sprite3D}}(),function(){function p$h(p$h,p$q){this._width=0,this._height=0,this._width=p$h,this._height=p$q}p$v(p$h,"laya.d3.utils.Size");var p$q=p$h.prototype;return p$L(0,p$q,"width",function(){return-1===this._width?p$Q.clientWidth:this._width}),p$L(0,p$q,"height",function(){return-1===this._height?p$Q.clientHeight:this._height}),p$L(1,p$h,"fullScreen",function(){return new p$h(-1,-1)}),p$h}()),p$lq=function(){function p$z(){}return p$v(p$z,"laya.d3.utils.Utils3D"),p$z._rotationTransformScaleSkinAnimation=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U){var p$u,p$v,p$L,p$e,p$l,p$_=p$z._tempArray16_0,p$N=p$z._tempArray16_1,p$G=p$z._tempArray16_2,p$m=p$g+p$g,p$E=p$$+p$$,p$R=p$P+p$P,p$t=p$g*p$m,p$X=p$$*p$m,p$n=p$$*p$E,p$J=p$P*p$m,p$p=p$P*p$E,p$A=p$P*p$R,p$d=p$S*p$m,p$b=p$S*p$E,p$i=p$S*p$R;for(p$_[15]=1,p$_[0]=1-p$n-p$A,p$_[1]=p$X+p$i,p$_[2]=p$J-p$b,p$_[4]=p$X-p$i,p$_[5]=1-p$t-p$A,p$_[6]=p$p+p$d,p$_[8]=p$J+p$b,p$_[9]=p$p-p$d,p$_[10]=1-p$t-p$n,p$N[15]=1,p$N[0]=p$B,p$N[5]=p$r,p$N[10]=p$Y,p$u=0;p$u<4;p$u++)p$v=p$_[p$u],p$L=p$_[p$u+4],p$e=p$_[p$u+8],p$l=p$_[p$u+12],p$G[p$u]=p$v,p$G[p$u+4]=p$L,p$G[p$u+8]=p$e,p$G[p$u+12]=p$v*p$h+p$L*p$q+p$e*p$f+p$l;for(p$u=0;p$u<4;p$u++)p$v=p$G[p$u],p$L=p$G[p$u+4],p$e=p$G[p$u+8],p$l=p$G[p$u+12],p$C[p$u+p$U]=p$v*p$N[0]+p$L*p$N[1]+p$e*p$N[2]+p$l*p$N[3],p$C[p$u+p$U+4]=p$v*p$N[4]+p$L*p$N[5]+p$e*p$N[6]+p$l*p$N[7],p$C[p$u+p$U+8]=p$v*p$N[8]+p$L*p$N[9]+p$e*p$N[10]+p$l*p$N[11],p$C[p$u+p$U+12]=p$v*p$N[12]+p$L*p$N[13]+p$e*p$N[14]+p$l*p$N[15]},p$z._createNodeByJson=function(p$h,p$q,p$f,p$g){if(!p$f)switch(p$q.type){case"Sprite3D":p$f=new p$Mq;break;case"MeshSprite3D":p$f=new p$Zq;break;case"SkinnedMeshSprite3D":p$f=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":p$f=new ShuriKenParticle3D;break;case"TrailSprite3D":p$f=new TrailSprite3D;break;case"Terrain":p$f=new Terrain;break;case"Camera":p$f=new p$Fq;break;case"DirectionLight":p$f=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var p$$=p$q.props;if(p$$)for(var p$P in p$$)p$f[p$P]=p$$[p$P];var p$S=p$q.customProps;p$S&&(p$f instanceof laya.d3.core.Sprite3D?(p$f._parseBaseCustomProps(p$S),p$f._parseCustomProps(p$h,p$g,p$S,p$q),p$f._parseCustomComponent(p$h,p$g,p$q.components)):p$f._parseCustomProps(p$h,p$g,p$S,p$q));var p$B=p$q.child;if(p$B)for(var p$r=0,p$Y=p$B.length;p$r<p$Y;p$r++){var p$C=p$z._createNodeByJson(p$h,p$B[p$r],null,p$g);p$f.addChild(p$C)}return p$f},p$z._computeBoneAndAnimationDatasByBindPoseMatrxix=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S,p$B,p$r=0,p$Y=0,p$C=p$h.length;for(p$S=0;p$S<p$C;p$r+=p$h[p$S].keyframeWidth,p$Y+=16,p$S++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(p$q[p$r+0],p$q[p$r+1],p$q[p$r+2],p$q[p$r+3],p$q[p$r+4],p$q[p$r+5],p$q[p$r+6],p$q[p$r+7],p$q[p$r+8],p$q[p$r+9],p$g,p$Y),0!=p$S&&(p$B=16*p$h[p$S].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(p$g,p$B,p$g,p$Y,p$g,p$Y));var p$U=p$f.length;for(p$S=0;p$S<p$U;p$S++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(p$g,16*p$P[p$S],p$f[p$S],p$$,16*p$S)},p$z._computeAnimationDatasByArrayAndMatrixFast=function(p$h,p$q,p$f,p$g){for(var p$$=0,p$P=p$h.length;p$$<p$P;p$$++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(p$q,16*p$g[p$$],p$h[p$$],p$f,16*p$$)},p$z._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(p$h,p$q,p$f,p$g,p$$){var p$P,p$S,p$B=0,p$r=0,p$Y=p$h.length;for(p$P=0;p$P<p$Y;p$B+=p$h[p$P].keyframeWidth,p$r+=16,p$P++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(p$q[p$B+7],p$q[p$B+8],p$q[p$B+9],p$q[p$B+3],p$q[p$B+4],p$q[p$B+5],p$q[p$B+6],p$q[p$B+0],p$q[p$B+1],p$q[p$B+2],p$g,p$r),0!=p$P&&(p$S=16*p$h[p$P].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(p$g,p$S,p$g,p$r,p$g,p$r));var p$C=p$f.length;for(p$P=0;p$P<p$C;p$P++){var p$U=16*p$P;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(p$g,p$U,p$f[p$P],p$$,p$U)}},p$z._computeAnimationDatasByArrayAndMatrixFastOld=function(p$h,p$q,p$f){for(var p$g=p$h.length,p$$=0;p$$<p$g;p$$++){var p$P=16*p$$;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(p$q,p$P,p$h[p$$],p$f,p$P)}},p$z._computeRootAnimationData=function(p$h,p$q,p$f){for(var p$g=0,p$$=0,p$P=0,p$S=p$h.length;p$g<p$S;p$$+=p$h[p$g].keyframeWidth,p$P+=16,p$g++)laya.d3.utils.Utils3D.createAffineTransformationArray(p$q[p$$+0],p$q[p$$+1],p$q[p$$+2],p$q[p$$+3],p$q[p$$+4],p$q[p$$+5],p$q[p$$+6],p$q[p$$+7],p$q[p$$+8],p$q[p$$+9],p$f,p$P)},p$z.transformVector3ArrayByQuat=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$f.elements,p$S=p$h[p$q],p$B=p$h[p$q+1],p$r=p$h[p$q+2],p$Y=p$P[0],p$C=p$P[1],p$U=p$P[2],p$u=p$P[3],p$v=p$u*p$S+p$C*p$r-p$U*p$B,p$L=p$u*p$B+p$U*p$S-p$Y*p$r,p$e=p$u*p$r+p$Y*p$B-p$C*p$S,p$l=-p$Y*p$S-p$C*p$B-p$U*p$r;p$g[p$$]=p$v*p$u+p$l*-p$Y+p$L*-p$U-p$e*-p$C,p$g[p$$+1]=p$L*p$u+p$l*-p$C+p$e*-p$Y-p$v*-p$U,p$g[p$$+2]=p$e*p$u+p$l*-p$U+p$v*-p$C-p$L*-p$Y},p$z.mulMatrixByArray=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S,p$B,p$r,p$Y,p$C;if(p$$===p$f){for(p$f=p$z._tempArray16_3,p$S=0;p$S<16;++p$S)p$f[p$S]=p$$[p$P+p$S];p$g=0}for(p$S=0;p$S<4;p$S++)p$B=p$h[p$q+p$S],p$r=p$h[p$q+p$S+4],p$Y=p$h[p$q+p$S+8],p$C=p$h[p$q+p$S+12],p$$[p$P+p$S]=p$B*p$f[p$g+0]+p$r*p$f[p$g+1]+p$Y*p$f[p$g+2]+p$C*p$f[p$g+3],p$$[p$P+p$S+4]=p$B*p$f[p$g+4]+p$r*p$f[p$g+5]+p$Y*p$f[p$g+6]+p$C*p$f[p$g+7],p$$[p$P+p$S+8]=p$B*p$f[p$g+8]+p$r*p$f[p$g+9]+p$Y*p$f[p$g+10]+p$C*p$f[p$g+11],p$$[p$P+p$S+12]=p$B*p$f[p$g+12]+p$r*p$f[p$g+13]+p$Y*p$f[p$g+14]+p$C*p$f[p$g+15]},p$z.mulMatrixByArrayFast=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S,p$B,p$r,p$Y,p$C;for(p$S=0;p$S<4;p$S++)p$B=p$h[p$q+p$S],p$r=p$h[p$q+p$S+4],p$Y=p$h[p$q+p$S+8],p$C=p$h[p$q+p$S+12],p$$[p$P+p$S]=p$B*p$f[p$g+0]+p$r*p$f[p$g+1]+p$Y*p$f[p$g+2]+p$C*p$f[p$g+3],p$$[p$P+p$S+4]=p$B*p$f[p$g+4]+p$r*p$f[p$g+5]+p$Y*p$f[p$g+6]+p$C*p$f[p$g+7],p$$[p$P+p$S+8]=p$B*p$f[p$g+8]+p$r*p$f[p$g+9]+p$Y*p$f[p$g+10]+p$C*p$f[p$g+11],p$$[p$P+p$S+12]=p$B*p$f[p$g+12]+p$r*p$f[p$g+13]+p$Y*p$f[p$g+14]+p$C*p$f[p$g+15]},p$z.mulMatrixByArrayAndMatrixFast=function(p$h,p$q,p$f,p$g,p$$){var p$P,p$S,p$B,p$r,p$Y,p$C=p$f.elements,p$U=p$C[0],p$u=p$C[1],p$v=p$C[2],p$L=p$C[3],p$e=p$C[4],p$l=p$C[5],p$_=p$C[6],p$N=p$C[7],p$G=p$C[8],p$m=p$C[9],p$E=p$C[10],p$R=p$C[11],p$t=p$C[12],p$X=p$C[13],p$n=p$C[14],p$J=p$C[15],p$p=p$q,p$A=p$q+4,p$d=p$q+8,p$b=p$q+12,p$i=p$$,p$z=p$$+4,p$c=p$$+8,p$M=p$$+12;for(p$P=0;p$P<4;p$P++)p$S=p$h[p$p+p$P],p$B=p$h[p$A+p$P],p$r=p$h[p$d+p$P],p$Y=p$h[p$b+p$P],p$g[p$i+p$P]=p$S*p$U+p$B*p$u+p$r*p$v+p$Y*p$L,p$g[p$z+p$P]=p$S*p$e+p$B*p$l+p$r*p$_+p$Y*p$N,p$g[p$c+p$P]=p$S*p$G+p$B*p$m+p$r*p$E+p$Y*p$R,p$g[p$M+p$P]=p$S*p$t+p$B*p$X+p$r*p$n+p$Y*p$J},p$z.createAffineTransformationArray=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U){var p$u=p$g+p$g,p$v=p$$+p$$,p$L=p$P+p$P,p$e=p$g*p$u,p$l=p$g*p$v,p$_=p$g*p$L,p$N=p$$*p$v,p$G=p$$*p$L,p$m=p$P*p$L,p$E=p$S*p$u,p$R=p$S*p$v,p$t=p$S*p$L;p$C[p$U+0]=(1-(p$N+p$m))*p$B,p$C[p$U+1]=(p$l+p$t)*p$B,p$C[p$U+2]=(p$_-p$R)*p$B,p$C[p$U+3]=0,p$C[p$U+4]=(p$l-p$t)*p$r,p$C[p$U+5]=(1-(p$e+p$m))*p$r,p$C[p$U+6]=(p$G+p$E)*p$r,p$C[p$U+7]=0,p$C[p$U+8]=(p$_+p$R)*p$Y,p$C[p$U+9]=(p$G-p$E)*p$Y,p$C[p$U+10]=(1-(p$e+p$N))*p$Y,p$C[p$U+11]=0,p$C[p$U+12]=p$h,p$C[p$U+13]=p$q,p$C[p$U+14]=p$f,p$C[p$U+15]=1},p$z.transformVector3ArrayToVector3ArrayCoordinate=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$z._tempArray4_0,p$S=p$h[p$q+0],p$B=p$h[p$q+1],p$r=p$h[p$q+2],p$Y=p$f.elements;p$P[0]=p$S*p$Y[0]+p$B*p$Y[4]+p$r*p$Y[8]+p$Y[12],p$P[1]=p$S*p$Y[1]+p$B*p$Y[5]+p$r*p$Y[9]+p$Y[13],p$P[2]=p$S*p$Y[2]+p$B*p$Y[6]+p$r*p$Y[10]+p$Y[14],p$P[3]=1/(p$S*p$Y[3]+p$B*p$Y[7]+p$r*p$Y[11]+p$Y[15]),p$g[p$$+0]=p$P[0]*p$P[3],p$g[p$$+1]=p$P[1]*p$P[3],p$g[p$$+2]=p$P[2]*p$P[3]},p$z.transformLightingMapTexcoordByUV0Array=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$f.elements;p$g[p$$+0]=p$h[p$q+0]*p$P[0]+p$P[2],p$g[p$$+1]=(p$h[p$q+1]-1)*p$P[1]+p$P[3]},p$z.transformLightingMapTexcoordByUV1Array=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$f.elements;p$g[p$$+0]=p$h[p$q+0]*p$P[0]+p$P[2],p$g[p$$+1]=1+p$h[p$q+1]*p$P[1]+p$P[3]},p$z.getURLVerion=function(p$h){var p$q=p$h.indexOf("?");return 0<=p$q?p$h.substr(p$q):null},p$z._quaternionCreateFromYawPitchRollArray=function(p$h,p$q,p$f,p$g){var p$$=.5*p$f,p$P=.5*p$q,p$S=.5*p$h,p$B=Math.sin(p$$),p$r=Math.cos(p$$),p$Y=Math.sin(p$P),p$C=Math.cos(p$P),p$U=Math.sin(p$S),p$u=Math.cos(p$S);p$g[0]=p$u*p$Y*p$r+p$U*p$C*p$B,p$g[1]=p$U*p$C*p$r-p$u*p$Y*p$B,p$g[2]=p$u*p$C*p$B-p$U*p$Y*p$r,p$g[3]=p$u*p$C*p$r+p$U*p$Y*p$B},p$z._createAffineTransformationArray=function(p$h,p$q,p$f,p$g){var p$$=p$q[0],p$P=p$q[1],p$S=p$q[2],p$B=p$q[3],p$r=p$$+p$$,p$Y=p$P+p$P,p$C=p$S+p$S,p$U=p$$*p$r,p$u=p$$*p$Y,p$v=p$$*p$C,p$L=p$P*p$Y,p$e=p$P*p$C,p$l=p$S*p$C,p$_=p$B*p$r,p$N=p$B*p$Y,p$G=p$B*p$C,p$m=p$f[0],p$E=p$f[1],p$R=p$f[2];p$g[0]=(1-(p$L+p$l))*p$m,p$g[1]=(p$u+p$G)*p$m,p$g[2]=(p$v-p$N)*p$m,p$g[3]=0,p$g[4]=(p$u-p$G)*p$E,p$g[5]=(1-(p$U+p$l))*p$E,p$g[6]=(p$e+p$_)*p$E,p$g[7]=0,p$g[8]=(p$v+p$N)*p$R,p$g[9]=(p$e-p$_)*p$R,p$g[10]=(1-(p$U+p$L))*p$R,p$g[11]=0,p$g[12]=p$h[0],p$g[13]=p$h[1],p$g[14]=p$h[2],p$g[15]=1},p$z._mulMatrixArray=function(p$h,p$q,p$f,p$g){var p$$,p$P,p$S,p$B,p$r,p$Y=p$q.elements,p$C=p$Y[0],p$U=p$Y[1],p$u=p$Y[2],p$v=p$Y[3],p$L=p$Y[4],p$e=p$Y[5],p$l=p$Y[6],p$_=p$Y[7],p$N=p$Y[8],p$G=p$Y[9],p$m=p$Y[10],p$E=p$Y[11],p$R=p$Y[12],p$t=p$Y[13],p$X=p$Y[14],p$n=p$Y[15],p$J=p$g,p$p=p$g+4,p$A=p$g+8,p$d=p$g+12;for(p$$=0;p$$<4;p$$++)p$P=p$h[p$$],p$S=p$h[p$$+4],p$B=p$h[p$$+8],p$r=p$h[p$$+12],p$f[p$J+p$$]=p$P*p$C+p$S*p$U+p$B*p$u+p$r*p$v,p$f[p$p+p$$]=p$P*p$L+p$S*p$e+p$B*p$l+p$r*p$_,p$f[p$A+p$$]=p$P*p$N+p$S*p$G+p$B*p$m+p$r*p$E,p$f[p$d+p$$]=p$P*p$R+p$S*p$t+p$B*p$X+p$r*p$n},p$z.getYawPitchRoll=function(p$h,p$q){p$z.transformQuat(p$Sq.ForwardRH,p$h,p$fq.TEMPVector31),p$z.transformQuat(p$Sq.Up,p$h,p$fq.TEMPVector32);var p$f=p$fq.TEMPVector32.elements;p$z.angleTo(p$Sq.ZERO,p$fq.TEMPVector31,p$fq.TEMPVector33);var p$g=p$fq.TEMPVector33.elements;p$g[0]==Math.PI/2?(p$g[1]=p$z.arcTanAngle(p$f[2],p$f[0]),p$g[2]=0):p$g[0]==-Math.PI/2?(p$g[1]=p$z.arcTanAngle(-p$f[2],-p$f[0]),p$g[2]=0):(p$hq.createRotationY(-p$g[1],p$fq.TEMPMatrix0),p$hq.createRotationX(-p$g[0],p$fq.TEMPMatrix1),p$Sq.transformCoordinate(p$fq.TEMPVector32,p$fq.TEMPMatrix0,p$fq.TEMPVector32),p$Sq.transformCoordinate(p$fq.TEMPVector32,p$fq.TEMPMatrix1,p$fq.TEMPVector32),p$g[2]=p$z.arcTanAngle(p$f[1],-p$f[0])),p$g[1]<=-Math.PI&&(p$g[1]=Math.PI),p$g[2]<=-Math.PI&&(p$g[2]=Math.PI),p$g[1]>=Math.PI&&p$g[2]>=Math.PI&&(p$g[1]=0,p$g[2]=0,p$g[0]=Math.PI-p$g[0]),p$q[0]=p$g[1],p$q[1]=p$g[0],p$q[2]=p$g[2]},p$z.arcTanAngle=function(p$h,p$q){return 0==p$h?1==p$q?Math.PI/2:-Math.PI/2:0<p$h?Math.atan(p$q/p$h):p$h<0?0<p$q?Math.atan(p$q/p$h)+Math.PI:Math.atan(p$q/p$h)-Math.PI:0},p$z.angleTo=function(p$h,p$q,p$f){p$Sq.subtract(p$q,p$h,p$fq.TEMPVector30),p$Sq.normalize(p$fq.TEMPVector30,p$fq.TEMPVector30),p$f.elements[0]=Math.asin(p$fq.TEMPVector30.y),p$f.elements[1]=p$z.arcTanAngle(-p$fq.TEMPVector30.z,-p$fq.TEMPVector30.x)},p$z.transformQuat=function(p$h,p$q,p$f){var p$g=p$f.elements,p$$=p$h.elements,p$P=p$q,p$S=p$$[0],p$B=p$$[1],p$r=p$$[2],p$Y=p$P[0],p$C=p$P[1],p$U=p$P[2],p$u=p$P[3],p$v=p$u*p$S+p$C*p$r-p$U*p$B,p$L=p$u*p$B+p$U*p$S-p$Y*p$r,p$e=p$u*p$r+p$Y*p$B-p$C*p$S,p$l=-p$Y*p$S-p$C*p$B-p$U*p$r;p$g[0]=p$v*p$u+p$l*-p$Y+p$L*-p$U-p$e*-p$C,p$g[1]=p$L*p$u+p$l*-p$C+p$e*-p$Y-p$v*-p$U,p$g[2]=p$e*p$u+p$l*-p$U+p$v*-p$C-p$L*-p$Y},p$z.quaterionNormalize=function(p$h,p$q){var p$f=p$h[0],p$g=p$h[1],p$$=p$h[2],p$P=p$h[3],p$S=p$f*p$f+p$g*p$g+p$$*p$$+p$P*p$P;0<p$S&&(p$S=1/Math.sqrt(p$S),p$q[0]=p$f*p$S,p$q[1]=p$g*p$S,p$q[2]=p$$*p$S,p$q[3]=p$P*p$S)},p$z.matrix4x4MultiplyFFF=function(p$h,p$q,p$f){var p$g,p$$,p$P,p$S,p$B;if(p$f===p$q)for(p$q=new Float32Array(16),p$g=0;p$g<16;++p$g)p$q[p$g]=p$f[p$g];for(p$g=0;p$g<4;p$g++)p$$=p$h[p$g],p$P=p$h[p$g+4],p$S=p$h[p$g+8],p$B=p$h[p$g+12],p$f[p$g]=p$$*p$q[0]+p$P*p$q[1]+p$S*p$q[2]+p$B*p$q[3],p$f[p$g+4]=p$$*p$q[4]+p$P*p$q[5]+p$S*p$q[6]+p$B*p$q[7],p$f[p$g+8]=p$$*p$q[8]+p$P*p$q[9]+p$S*p$q[10]+p$B*p$q[11],p$f[p$g+12]=p$$*p$q[12]+p$P*p$q[13]+p$S*p$q[14]+p$B*p$q[15]},p$z.matrix4x4MultiplyMFM=function(p$h,p$q,p$f){p$z.matrix4x4MultiplyFFF(p$h.elements,p$q,p$f.elements)},p$U(p$z,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new p$Sq},"_tempVector3_1",function(){return this._tempVector3_1=new p$Sq},"_tempVector3_2",function(){return this._tempVector3_2=new p$Sq},"_tempVector3_3",function(){return this._tempVector3_3=new p$Sq},"_tempVector3_4",function(){return this._tempVector3_4=new p$Sq},"_tempVector3_5",function(){return this._tempVector3_5=new p$Sq},"_tempVector3_6",function(){return this._tempVector3_6=new p$Sq},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),p$z}(),p$_q=function(){function p$b(){}return p$v(p$b,"Laya3D"),p$b._cancelLoadByUrl=function(p$h){p$E.loader.cancelLoadByUrl(p$h),p$b._innerFirstLevelLoaderManager.cancelLoadByUrl(p$h),p$b._innerSecondLevelLoaderManager.cancelLoadByUrl(p$h),p$b._innerThirdLevelLoaderManager.cancelLoadByUrl(p$h),p$b._innerFourthLevelLoaderManager.cancelLoadByUrl(p$h)},p$b._changeWebGLSize=function(p$h,p$q){p$d.onStageResize(p$h,p$q),p$Q.clientWidth=p$h,p$Q.clientHeight=p$q},p$b.__init__=function(){var p$h=p$q.createMap;p$h.lh=[p$Mq,"SPRITE3DHIERARCHY"],p$h.ls=[p$cq,"SPRITE3DHIERARCHY"],p$h.lm=[p$Dq,"MESH"],p$h.lmat=[p$Tq,"MATERIAL"],p$h.jpg=[p$Vq,"nativeimage"],p$h.jpeg=[p$Vq,"nativeimage"],p$h.png=[p$Vq,"nativeimage"],p$h.pkm=[p$Vq,"arraybuffer"],p$h.raw=[p$kq,"arraybuffer"],p$h.mipmaps=[p$kq,"arraybuffer"],p$_.parserMap.SPRITE3DHIERARCHY=p$b._loadHierarchy,p$_.parserMap.MESH=p$b._loadMesh,p$_.parserMap.MATERIAL=p$b._loadMaterial,p$_.parserMap.TEXTURECUBE=p$b._loadTextureCube,p$_.parserMap.TERRAIN=p$b._loadTerrain,p$b._innerFirstLevelLoaderManager.on("error",null,p$b._eventLoadManagerError),p$b._innerSecondLevelLoaderManager.on("error",null,p$b._eventLoadManagerError),p$b._innerThirdLevelLoaderManager.on("error",null,p$b._eventLoadManagerError),p$b._innerFourthLevelLoaderManager.on("error",null,p$b._eventLoadManagerError)},p$b.READ_BLOCK=function(){return p$b._readData.pos+=4,!0},p$b.READ_DATA=function(){return p$b._DATA.offset=p$b._readData.getUint32(),p$b._DATA.size=p$b._readData.getUint32(),!0},p$b.READ_STRINGS=function(){var p$h=[],p$q={offset:0,size:0};p$q.offset=p$b._readData.getUint16(),p$q.size=p$b._readData.getUint16();p$b._readData.pos;p$b._readData.pos=p$q.offset+p$b._DATA.offset;for(var p$f=0;p$f<p$q.size;p$f++){var p$g=p$b._readData.readUTFString();-1===p$g.lastIndexOf(".lmat")&&-1===p$g.lastIndexOf(".lpbr")||p$h.push(p$g)}return p$h},p$b.formatRelativePath=function(p$h,p$q){var p$f;if("."===p$q.charAt(0)){for(var p$g=(p$h+p$q).split("/"),p$$=0,p$P=p$g.length;p$$<p$P;p$$++)if(".."==p$g[p$$]){var p$S=p$$-1;0<p$S&&".."!==p$g[p$S]&&(p$g.splice(p$S,2),p$$-=2)}p$f=p$g.join("/")}else p$f=p$h+p$q;return null!=p$A.customFormat&&(p$f=p$A.customFormat(p$f,null)),p$f},p$b._eventLoadManagerError=function(p$h){p$E.loader.event("error",p$h)},p$b._addHierarchyInnerUrls=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S=p$b.formatRelativePath(p$g,p$$);p$f&&(p$S+=p$f),p$h.push({url:p$S,clas:p$P}),p$q[p$$]=p$S},p$b._getSprite3DHierarchyInnerUrls=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){var p$B,p$r=0,p$Y=0;switch(p$h.type){case"Scene":var p$C=p$h.customProps.lightmaps;for(p$r=0,p$Y=p$C.length;p$r<p$Y;p$r++){var p$U=p$C[p$r].replace(".exr",".png");p$b._addHierarchyInnerUrls(p$g,p$$,p$P,p$S,p$U,p$Vq)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var p$u;if(p$h.instanceParams)(p$u=p$h.instanceParams.loadPath)&&p$b._addHierarchyInnerUrls(p$q,p$$,p$P,p$S,p$u,p$Dq);else{(p$u=(p$B=p$h.customProps).meshPath)&&p$b._addHierarchyInnerUrls(p$q,p$$,p$P,p$S,p$u,p$Dq);var p$v=p$B.materials;if(p$v)for(p$r=0,p$Y=p$v.length;p$r<p$Y;p$r++){for(var p$L=p$v[p$r],p$e=p$L.type.split("."),p$l=p$i.window,p$_=0,p$N=p$e.length;p$_<p$N;++p$_){p$l=p$l[this.clasPaths[p$_]]}if("function"!=typeof p$l)throw"_getSprite3DHierarchyInnerUrls 错误: "+p$L.type+" 不是类";p$b._addHierarchyInnerUrls(p$f,p$$,p$P,p$S,p$L.path,p$l)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var p$G=(p$B=p$h.customProps).meshPath;p$G&&p$b._addHierarchyInnerUrls(p$q,p$$,p$P,p$S,p$G,p$Dq);var p$m=p$B.material;if(p$m){p$e=p$m.type.split("."),p$l=p$i.window;for(p$_=0,p$N=p$e.length;p$_<p$N;++p$_){p$l=p$l[this.clasPaths[p$_]]}p$b._addHierarchyInnerUrls(p$f,p$$,p$P,p$S,p$m.path,p$l)}else{var p$E=p$B.materialPath;if(p$E)p$b._addHierarchyInnerUrls(p$f,p$$,p$P,p$S,p$E,ShurikenParticleMaterial);else{var p$R=p$B.texturePath;p$R&&p$b._addHierarchyInnerUrls(p$g,p$$,p$P,p$S,p$R,p$Vq)}}break;case"Terrain":p$b._addHierarchyInnerUrls(p$g,p$$,p$P,p$S,p$h.customProps.dataPath,TerrainRes)}var p$t=p$h.components;for(var p$X in p$t){var p$n=p$t[p$X];switch(p$X){case"Animator":var p$J=p$n.avatarPath;if(p$J)p$b._addHierarchyInnerUrls(p$g,p$$,p$P,p$S,p$J,Avatar);else{var p$p=p$n.avatar;p$p&&p$b._addHierarchyInnerUrls(p$g,p$$,p$P,p$S,p$p.path,Avatar)}var p$A=p$n.clipPaths;for(p$r=0,p$Y=p$A.length;p$r<p$Y;p$r++)p$b._addHierarchyInnerUrls(p$g,p$$,p$P,p$S,p$A[p$r],AnimationClip)}}var p$d=p$h.child;for(p$r=0,p$Y=p$d.length;p$r<p$Y;p$r++)p$b._getSprite3DHierarchyInnerUrls(p$d[p$r],p$q,p$f,p$g,p$$,p$P,p$S)},p$b._loadHierarchy=function(p$h){p$h.on("loaded",null,p$b._onHierarchylhLoaded,[p$h,p$h._class._getGroup()]),p$h.load(p$h.url,"json",!1,null,!0)},p$b._onHierarchylhLoaded=function(p$h,p$q,p$f){if(p$h._class.destroyed)p$h.endLoad();else{var p$g=p$h.url,p$$=p$lq.getURLVerion(p$g),p$P=p$A.getPath(p$g),p$S=[],p$B=[],p$r=[],p$Y={};p$b._getSprite3DHierarchyInnerUrls(p$f,p$S,p$B,p$r,p$Y,p$$,p$P);var p$C=p$S.length+p$B.length+p$r.length,p$U=p$C+1,p$u=1/p$U;if(p$b._onProcessChange(p$h,0,p$u,1),0<p$r.length){var p$v=p$C/p$U,p$L=p$p.create(null,p$b._onProcessChange,[p$h,p$u,p$v],!1);p$b._innerFourthLevelLoaderManager.create(p$r,p$p.create(null,p$b._onHierarchyInnerForthLevResouLoaded,[p$h,p$q,p$L,p$f,p$Y,p$S,p$B,p$u+p$v*p$r.length,p$v]),p$L,null,null,1,!0,p$q)}else p$b._onHierarchyInnerForthLevResouLoaded(p$h,p$q,null,p$f,p$Y,p$S,p$B,p$u,p$v)}},p$b._onHierarchyInnerForthLevResouLoaded=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){if(p$h._class.destroyed)p$h.endLoad();else if(p$f&&p$f.recover(),0<p$S.length){var p$Y=p$p.create(null,p$b._onProcessChange,[p$h,p$B,p$r],!1);p$b._innerSecondLevelLoaderManager.create(p$S,p$p.create(null,p$b._onHierarchyInnerSecondLevResouLoaded,[p$h,p$q,p$Y,p$g,p$$,p$P,p$B+p$r*p$S.length,p$r]),p$f,null,null,1,!0,p$q)}else p$b._onHierarchyInnerSecondLevResouLoaded(p$h,p$q,null,p$g,p$$,p$P,p$B,p$r)},p$b._onHierarchyInnerSecondLevResouLoaded=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B){if(p$h._class.destroyed)p$h.endLoad();else if(p$f&&p$f.recover(),0<p$P.length){var p$r=p$p.create(null,p$b._onProcessChange,[p$h,p$S,p$B],!1);p$b._innerFirstLevelLoaderManager.create(p$P,p$p.create(null,p$b._onHierarchyInnerFirstLevResouLoaded,[p$h,p$r,p$g,p$$]),p$f,null,null,1,!0,p$q)}else p$b._onHierarchyInnerFirstLevResouLoaded(p$h,null,p$g,p$$)},p$b._onHierarchyInnerFirstLevResouLoaded=function(p$h,p$q,p$f,p$g){p$q&&p$q.recover(),p$h.endLoad([p$f,p$g])},p$b._loadTerrain=function(p$h){p$h.on("loaded",null,p$b._onTerrainLtLoaded,[p$h,p$h._class._getGroup()]),p$h.load(p$h.url,"json",!1,null,!0)},p$b._onTerrainLtLoaded=function(p$h,p$q,p$f){if(p$h._class.destroyed)p$h.endLoad();else{var p$g,p$$,p$P=p$h.url,p$S=p$lq.getURLVerion(p$P),p$B=p$A.getPath(p$P),p$r=[],p$Y={},p$C=0,p$U=0,p$u=p$f.heightData;p$g=p$u.url,p$$=p$b.formatRelativePath(p$B,p$g),p$S&&(p$$+=p$S),p$g=p$Y[p$g]=p$$;var p$v=p$f.detailTexture;for(p$C=0,p$U=p$v.length;p$C<p$U;p$C++)p$r.push({url:p$v[p$C].diffuse});var p$L=p$f.normalMap;for(p$C=0,p$U=p$L.length;p$C<p$U;p$C++)p$r.push({url:p$L[p$C]});var p$e=p$f.alphaMap;for(p$C=0,p$U=p$e.length;p$C<p$U;p$C++)p$r.push({url:p$e[p$C],params:[!1,!1,6408,!0]});for(p$C=0,p$U=p$r.length;p$C<p$U;p$C++){var p$l=p$r[p$C].url;p$$=p$b.formatRelativePath(p$B,p$l),p$S&&(p$$+=p$S),p$r[p$C].url=p$$,p$Y[p$l]=p$$}var p$_=p$r.length,p$N=p$_+2,p$G=1/p$N;p$b._onProcessChange(p$h,0,p$G,1);var p$m={heightMapLoaded:!1,texturesLoaded:!1},p$E=p$p.create(null,p$b._onProcessChange,[p$h,p$G,p$G],!1);p$b._innerFourthLevelLoaderManager.create(p$g,p$p.create(null,p$b._onTerrainHeightMapLoaded,[p$h,p$E,p$f,p$Y,p$m]),p$E,null,[p$u.numX,p$u.numZ,p$u.bitType,p$u.value],1,!0,p$q);var p$R=p$p.create(null,p$b._onProcessChange,[p$h,2*p$G,p$_/p$N],!1);p$b._innerFourthLevelLoaderManager.create(p$r,p$p.create(null,p$b._onTerrainTexturesLoaded,[p$h,p$R,p$f,p$Y,p$m]),p$R,null,null,1,!0,p$q)}},p$b._onTerrainHeightMapLoaded=function(p$h,p$q,p$f,p$g,p$$){p$$.heightMapLoaded=!0,p$$.texturesLoaded&&(p$h.endLoad([p$f,p$g]),p$q.recover())},p$b._onTerrainTexturesLoaded=function(p$h,p$q,p$f,p$g,p$$){p$$.texturesLoaded=!0,p$$.heightMapLoaded&&(p$h.endLoad([p$f,p$g]),p$q.recover())},p$b._loadMesh=function(p$h){p$h.on("loaded",null,p$b._onMeshLmLoaded,[p$h,p$h._class._getGroup()]),p$h.load(p$h.url,"arraybuffer",!1,null,!0)},p$b._onMeshLmLoaded=function(p$h,p$q,p$f){if(p$h._class.destroyed)p$h.endLoad();else{var p$g,p$$,p$P,p$S=p$h.url,p$B=p$lq.getURLVerion(p$S),p$r=p$A.getPath(p$S),p$Y={},p$C=0,p$U=0;switch((p$b._readData=new p$R(p$f)).pos=0,p$b._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var p$u=p$b._readData.getUint32();p$b._readData.pos=p$b._readData.pos+4,p$U=p$b._readData.getUint16(),p$b._readData.pos=p$b._readData.pos+8*p$U;var p$v=p$b._readData.getUint32();for(p$U=p$b._readData.getUint16(),p$b._readData.pos=p$u+p$v,p$g=[],p$C=0;p$C<p$U;p$C++){var p$L=p$b._readData.readUTFString();-1!==p$L.lastIndexOf(".lmat")&&p$g.push(p$L)}break;default:for(p$b.READ_BLOCK(),p$C=0;p$C<2;p$C++){var p$e=p$b._readData.getUint16(),p$l=p$b._strings[p$e],p$_=p$b["READ_"+p$l];if(null==p$_)throw new Error("model file err,no this function:"+p$e+" "+p$l);1===p$C?p$g=p$_.call():p$_.call()}}for(p$C=0,p$P=p$g.length;p$C<p$P;p$C++){var p$N=p$g[p$C];p$$=p$b.formatRelativePath(p$r,p$N),p$B&&(p$$+=p$B),p$g[p$C]=p$$,p$Y[p$N]=p$$}if(0<p$g.length){p$b._onProcessChange(p$h,0,.5,1);var p$G=p$p.create(null,p$b._onProcessChange,[p$h,.5,.5],!1);p$b._innerSecondLevelLoaderManager.create(p$g,p$p.create(null,p$b._onMeshMateialLoaded,[p$h,p$G,p$f,p$Y]),p$G,null,null,1,!0,p$q)}else p$h.endLoad([p$f,p$Y])}},p$b._onMeshMateialLoaded=function(p$h,p$q,p$f,p$g){p$h.endLoad([p$f,p$g]),p$q.recover()},p$b._getMaterialTexturePath=function(p$h,p$q,p$f){var p$g=p$h.length-4;return p$h.indexOf(".dds")!=p$g&&p$h.indexOf(".tga")!=p$g&&p$h.indexOf(".exr")!=p$g&&p$h.indexOf(".DDS")!=p$g&&p$h.indexOf(".TGA")!=p$g&&p$h.indexOf(".EXR")!=p$g||(p$h=p$h.substr(0,p$g)+".png"),p$h=p$b.formatRelativePath(p$f,p$h),p$q&&(p$h+=p$q),p$h},p$b._loadMaterial=function(p$h){p$h.on("loaded",null,p$b._onMaterilLmatLoaded,[p$h,p$h._class._getGroup()]),p$h.load(p$h.url,"json",!1,null,!0)},p$b._onMaterilLmatLoaded=function(p$h,p$q,p$f){if(p$h._class.destroyed)p$h.endLoad();else{var p$g,p$$=p$h.url,p$P=p$lq.getURLVerion(p$$),p$S=p$A.getPath(p$$),p$B=[],p$r={},p$Y=p$f.customProps,p$C=p$f.version;if(p$C)switch(p$C){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var p$U=p$f.props.textures,p$u=0,p$v=p$U.length;p$u<p$v;p$u++){var p$L=p$U[p$u],p$e=p$L.path;if(p$e){var p$l=p$e.length-4;p$e.indexOf(".exr")!=p$l&&p$e.indexOf(".EXR")!=p$l||(p$e=p$e.substr(0,p$l)+".png"),p$g=p$b.formatRelativePath(p$S,p$e),p$P&&(p$g+=p$P),p$B.push({url:p$g,params:p$L.params}),p$r[p$e]=p$g}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var p$_=p$Y.diffuseTexture.texture2D;if(p$_&&(p$g=p$b._getMaterialTexturePath(p$_,p$P,p$S),p$B.push(p$g),p$r[p$_]=p$g),p$Y.normalTexture){var p$N=p$Y.normalTexture.texture2D;p$N&&(p$g=p$b._getMaterialTexturePath(p$N,p$P,p$S),p$B.push(p$g),p$r[p$N]=p$g)}if(p$Y.specularTexture){var p$G=p$Y.specularTexture.texture2D;p$G&&(p$g=p$b._getMaterialTexturePath(p$G,p$P,p$S),p$B.push(p$g),p$r[p$G]=p$g)}if(p$Y.emissiveTexture){var p$m=p$Y.emissiveTexture.texture2D;p$m&&(p$g=p$b._getMaterialTexturePath(p$m,p$P,p$S),p$B.push(p$g),p$r[p$m]=p$g)}if(p$Y.ambientTexture){var p$E=p$Y.ambientTexture.texture2D;p$E&&(p$g=p$b._getMaterialTexturePath(p$E,p$P,p$S),p$B.push(p$g),p$r[p$E]=p$g)}if(p$Y.reflectTexture){var p$R=p$Y.reflectTexture.texture2D;p$R&&(p$g=p$b._getMaterialTexturePath(p$R,p$P,p$S),p$B.push(p$g),p$r[p$R]=p$g)}}var p$t=p$B.length,p$X=p$t+1,p$n=1/p$X;if(p$b._onProcessChange(p$h,0,p$n,1),0<p$t){var p$J=p$p.create(null,p$b._onProcessChange,[p$h,p$n,p$t/p$X],!1);p$b._innerFourthLevelLoaderManager.create(p$B,p$p.create(null,p$b._onMateialTexturesLoaded,[p$h,p$J,p$f,p$r]),p$J,p$Vq,null,1,!0,p$q)}else p$b._onMateialTexturesLoaded(p$h,null,p$f,null)}},p$b._onMateialTexturesLoaded=function(p$h,p$q,p$f,p$g){p$h.endLoad([p$f,p$g]),p$q&&p$q.recover()},p$b._loadTextureCube=function(p$h){p$h.on("loaded",null,p$b._onTextureCubeLtcLoaded,[p$h]),p$h.load(p$h.url,"json",!1,null,!0)},p$b._onTextureCubeLtcLoaded=function(p$h,p$q){if(p$h._class.destroyed)p$h.endLoad();else{var p$f=p$A.getPath(p$h.url),p$g=[p$b.formatRelativePath(p$f,p$q.px),p$b.formatRelativePath(p$f,p$q.nx),p$b.formatRelativePath(p$f,p$q.py),p$b.formatRelativePath(p$f,p$q.ny),p$b.formatRelativePath(p$f,p$q.pz),p$b.formatRelativePath(p$f,p$q.nz)];p$b._onProcessChange(p$h,0,1/7,1);var p$$=p$p.create(null,p$b._onProcessChange,[p$h,1/7,6/7],!1);p$b._innerFourthLevelLoaderManager.load(p$g,p$p.create(null,p$b._onTextureCubeImagesLoaded,[p$h,p$g,p$$]),p$$,"nativeimage")}},p$b._onTextureCubeImagesLoaded=function(p$h,p$q,p$f){var p$g=[];p$g.length=6;for(var p$$=0;p$$<6;p$$++){var p$P=p$q[p$$];p$g[p$$]=p$_.getRes(p$P),p$_.clearRes(p$P)}p$h.endLoad(p$g),p$f.recover()},p$b._onProcessChange=function(p$h,p$q,p$f,p$g){(p$g=p$q+p$g*p$f)<1&&p$h.event("progress",p$g)},p$b.init=function(p$h,p$q,p$f,p$g,p$$,p$P){if(void 0===p$f&&(p$f=!1),void 0===p$g&&(p$g=!1),void 0===p$$&&(p$$=!0),void 0===p$P&&(p$P=!0),p$N.update3DLoop=function(){},p$N.cancelLoadByUrl=function(p$h){p$b._cancelLoadByUrl(p$h)},p$r.isAntialias=p$f,p$r.isAlpha=p$g,p$r.premultipliedAlpha=p$$,p$r.isStencil=p$P,!p$d.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");p$N.changeWebGLSize=p$b._changeWebGLSize,p$e.is3DMode=!0,p$E.init(p$h,p$q),p$z.__init__(),p$Uq.__init__(),p$Zq.__init__(),p$H.__init__(),p$b.__init__(),p$S.maxTextureCount=2,(p$b.debugMode||p$o.debugMode)&&(p$b._debugPhasorSprite=new p$y)},p$b.HIERARCHY="SPRITE3DHIERARCHY",p$b.MESH="MESH",p$b.MATERIAL="MATERIAL",p$b.PBRMATERIAL="PBRMTL",p$b.TEXTURECUBE="TEXTURECUBE",p$b.TERRAIN="TERRAIN",p$b._readData=null,p$b._debugPhasorSprite=null,p$b.debugMode=!1,p$U(p$b,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new p$q},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new p$q},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new p$q},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new p$q}]),p$b}(),p$Nq=function(p$h){function p$$(p$h){p$$.__super.call(this),this._owner=p$h,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}p$v(p$$,"laya.d3.animation.AnimationTransform3D",p$P);var p$q=p$$.prototype;return p$q._getlocalMatrix=function(){return this._localUpdate&&(p$lq._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},p$q._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._onWorldTransform()}},p$q._setWorldMatrixAndUpdate=function(p$h){if(this._worldMatrix=p$h,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var p$q=this._getlocalMatrix(),p$f=0;p$f<16;++p$f)this._worldMatrix[p$f]=p$q[p$f];else p$lq.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},p$q._setWorldMatrixNoUpdate=function(p$h){this._worldMatrix=p$h},p$q._setWorldMatrixIgnoreUpdate=function(p$h){this._worldMatrix=p$h,this._worldUpdate=!1},p$q.getLocalPosition=function(){return this._localPosition},p$q.setLocalPosition=function(p$h){if(this._parent)this._localPosition=p$h,this._localUpdate=!0,this._onWorldTransform();else{var p$q=this._entity.owner._transform,p$f=this._entity.localPosition,p$g=p$f.elements;p$g[0]=p$h[0],p$g[1]=p$h[1],p$g[2]=p$h[2],p$q.localPosition=p$f}},p$q.getLocalRotation=function(){if(this._localQuaternionUpdate){var p$h=this._localRotationEuler;p$lq._quaternionCreateFromYawPitchRollArray(p$h[1]/p$$._angleToRandin,p$h[0]/p$$._angleToRandin,p$h[2]/p$$._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},p$q.setLocalRotation=function(p$h){if(this._parent)this._localRotation=p$h,p$lq.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var p$q=this._entity.owner._transform,p$f=this._entity.localRotation,p$g=p$f.elements;p$g[0]=p$h[0],p$g[1]=p$h[1],p$g[2]=p$h[2],p$g[3]=p$h[3],p$q.localRotation=p$f}},p$q.getLocalScale=function(){return this._localScale},p$q.setLocalScale=function(p$h){if(this._parent)this._localScale=p$h,this._localUpdate=!0,this._onWorldTransform();else{var p$q=this._entity.owner._transform,p$f=this._entity.localScale,p$g=p$f.elements;p$g[0]=p$h[0],p$g[1]=p$h[1],p$g[2]=p$h[2],p$q.localScale=p$f}},p$q.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){p$lq.getYawPitchRoll(this._localRotation,p$$._tempVector3);var p$h=p$$._tempVector3,p$q=this._localRotationEuler;p$q[0]=p$h[1]*p$$._angleToRandin,p$q[1]=p$h[0]*p$$._angleToRandin,p$q[2]=p$h[2]*p$$._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},p$q.setLocalRotationEuler=function(p$h){if(this._parent)p$lq._quaternionCreateFromYawPitchRollArray(p$h[1]/p$$._angleToRandin,p$h[0]/p$$._angleToRandin,p$h[2]/p$$._angleToRandin,this._localRotation),this._localRotationEuler=p$h,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var p$q=this._entity.owner._transform,p$f=this._entity.localRotationEuler,p$g=p$f.elements;p$g[0]=p$h[0],p$g[1]=p$h[1],p$g[2]=p$h[2],p$q.localRotationEuler=p$f}},p$q.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)p$lq.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var p$h=this._getlocalMatrix(),p$q=0;p$q<16;++p$q)this._worldMatrix[p$q]=p$h[p$q];this._worldUpdate=!1}return this._worldMatrix},p$q.setParent=function(p$h){if(this._parent!==p$h){if(this._parent){var p$q=this._parent._childs,p$f=p$q.indexOf(this);p$q.splice(p$f,1)}p$h&&(p$h._childs.push(this),p$h&&this._onWorldTransform()),this._parent=p$h}},p$U(p$$,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),p$$}(),p$Gq=function(p$h){function p$q(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,p$q.__super.call(this),this._destroyed=!1,this._id=p$q._uniqueIDCounter,p$q._uniqueIDCounter++}p$v(p$q,"laya.d3.component.Component3D",p$P);var p$f=p$q.prototype;return p$E.imps(p$f,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),p$f._initialize=function(p$h){this._owner=p$h,this._enable=!0,this.started=!1,this._load(p$h)},p$f._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},p$f._load=function(p$h){},p$f._start=function(p$h){},p$f._update=function(p$h){},p$f._lateUpdate=function(p$h){},p$f._preRenderUpdate=function(p$h){},p$f._postRenderUpdate=function(p$h){},p$f._unload=function(p$h){this.offAll()},p$f._cloneTo=function(p$h){},p$L(0,p$f,"id",function(){return this._id}),p$L(0,p$f,"destroyed",function(){return this._destroyed}),p$L(0,p$f,"owner",function(){return this._owner}),p$L(0,p$f,"enable",function(){return this._enable},function(p$h){this._enable!==p$h&&(this._enable=p$h,this.event("enablechanged",this._enable))}),p$L(0,p$f,"isSingleton",function(){return p$q._isSingleton}),p$q._isSingleton=!0,p$q._uniqueIDCounter=1,p$q}(),p$mq=function(p$h){function p$q(){this._destroyed=!1,p$q.__super.call(this),this._destroyed=!1}p$v(p$q,"laya.d3.core.GeometryFilter",p$P);var p$f=p$q.prototype;return p$E.imps(p$f,{"laya.resource.IDestroy":!0}),p$f._destroy=function(){this.offAll(),this._destroyed=!0},p$L(0,p$f,"_isAsyncLoaded",function(){return!0}),p$L(0,p$f,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),p$L(0,p$f,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),p$L(0,p$f,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),p$L(0,p$f,"destroyed",function(){return this._destroyed}),p$q}(),p$Eq=function(p$h){function p$g(p$h){p$g.__super.call(this),this._id=++p$g._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new p$oh(new p$Sq,new p$Sq),this._boundingBoxCenter=new p$Sq,this._boundingSphere=new p$jh(new p$Sq,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=p$h,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}p$v(p$g,"laya.d3.core.render.BaseRender",p$P);var p$q=p$g.prototype;return p$E.imps(p$q,{"laya.resource.IDestroy":!0}),p$q._changeMaterialReference=function(p$h,p$q){p$h&&p$h._removeReference(),p$q._addReference()},p$q._getInstanceMaterial=function(p$h,p$q){var p$f=new p$h.constructor;return p$h.cloneTo(p$f),p$f.name=p$f.name+"(Instance)",this._materialsInstance[p$q]=!0,this._changeMaterialReference(this._materials[p$q],p$f),this._materials[p$q]=p$f},p$q._setShaderValuelightMap=function(p$h){this._setShaderValueTexture(3,p$h)},p$q._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},p$q._renderRenderableBoundBox=function(){var p$h=p$_q._debugPhasorSprite,p$q=this.boundingBox,p$f=p$g._tempBoundBoxCorners;p$q.getCorners(p$f),p$h.line(p$f[0],p$g._greenColor,p$f[1],p$g._greenColor),p$h.line(p$f[2],p$g._greenColor,p$f[3],p$g._greenColor),p$h.line(p$f[4],p$g._greenColor,p$f[5],p$g._greenColor),p$h.line(p$f[6],p$g._greenColor,p$f[7],p$g._greenColor),p$h.line(p$f[0],p$g._greenColor,p$f[3],p$g._greenColor),p$h.line(p$f[1],p$g._greenColor,p$f[2],p$g._greenColor),p$h.line(p$f[2],p$g._greenColor,p$f[6],p$g._greenColor),p$h.line(p$f[3],p$g._greenColor,p$f[7],p$g._greenColor),p$h.line(p$f[0],p$g._greenColor,p$f[4],p$g._greenColor),p$h.line(p$f[1],p$g._greenColor,p$f[5],p$g._greenColor),p$h.line(p$f[4],p$g._greenColor,p$f[7],p$g._greenColor),p$h.line(p$f[5],p$g._greenColor,p$f[6],p$g._greenColor)},p$q._calculateBoundingSphere=function(){throw"BaseRender: must override it."},p$q._calculateBoundingBox=function(){throw"BaseRender: must override it."},p$q._setShaderValueTexture=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q)},p$q._setShaderValueMatrix4x4=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q?p$q.elements:null)},p$q._setShaderValueColor=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q?p$q.elements:null)},p$q._setShaderValueBuffer=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q)},p$q._setShaderValueInt=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q)},p$q._setShaderValueBool=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q)},p$q._setShaderValueNumber=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q)},p$q._setShaderValueVector2=function(p$h,p$q){this._owner._shaderValues.setValue(p$h,p$q?p$q.elements:null)},p$q._addShaderDefine=function(p$h){this._owner._shaderDefineValue|=p$h},p$q._removeShaderDefine=function(p$h){this._owner._shaderDefineValue&=~p$h},p$q._renderUpdate=function(p$h){return!0},p$q._applyLightMapParams=function(){if(0<=this._lightmapIndex){var p$h=this._owner.scene;if(p$h){var p$q=p$h.getlightmaps()[this._lightmapIndex];p$q?(this._addShaderDefine(p$yq.SAHDERDEFINE_LIGHTMAP),p$q.loaded?this._setShaderValuelightMap(p$q):p$q.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(p$yq.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(p$yq.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(p$yq.SAHDERDEFINE_LIGHTMAP)},p$q._updateOctreeNode=function(){var p$h=this._treeNode;p$h&&this._octreeNodeNeedChange&&(p$h.updateObject(this),this._octreeNodeNeedChange=!1)},p$q._destroy=function(){this.offAll();var p$h=0,p$q=0;for(p$h=0,p$q=this._renderElements.length;p$h<p$q;p$h++)this._renderElements[p$h]._destroy();for(p$h=0,p$q=this._materials.length;p$h<p$q;p$h++)this._materials[p$h]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},p$L(0,p$q,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),p$L(0,p$q,"id",function(){return this._id}),p$L(0,p$q,"material",function(){var p$h=this._materials[0];if(p$h&&!this._materialsInstance[0]){var p$q=this._getInstanceMaterial(p$h,0);this.event("materialchanged",[this,0,p$q])}return this._materials[0]},function(p$h){this.sharedMaterial=p$h}),p$L(0,p$q,"sharedMaterial",function(){return this._materials[0]},function(p$h){var p$q=this._materials[0];p$q!==p$h&&(this._materials[0]=p$h,this._materialsInstance[0]=!1,this._changeMaterialReference(p$q,p$h),this.event("materialchanged",[this,0,p$h]))}),p$L(0,p$q,"lightmapIndex",function(){return this._lightmapIndex},function(p$h){this._lightmapIndex=p$h,this._applyLightMapParams()}),p$L(0,p$q,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(p$h){this._lightmapScaleOffset=p$h,this._setShaderValueColor(2,p$h),this._addShaderDefine(p$yq.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),p$L(0,p$q,"enable",function(){return this._enable},function(p$h){this._enable=p$h,this.event("enablechanged",[this,p$h])}),p$L(0,p$q,"materials",function(){for(var p$h=0,p$q=this._materials.length;p$h<p$q;p$h++)if(!this._materialsInstance[p$h]){var p$f=this._getInstanceMaterial(this._materials[p$h],p$h);this.event("materialchanged",[this,p$h,p$f])}return this._materials.slice()},function(p$h){this.sharedMaterials=p$h}),p$L(0,p$q,"sharedMaterials",function(){return this._materials.slice()},function(p$h){if(!p$h)throw new Error("MeshRender: shadredMaterials value can't be null.");var p$q=p$h.length;this._materialsInstance.length=p$q;for(var p$f=0;p$f<p$q;p$f++){var p$g=this._materials[p$f];p$g!==p$h[p$f]&&(this._materialsInstance[p$f]=!1,this._changeMaterialReference(p$g,p$h[p$f]),this.event("materialchanged",[this,p$f,p$h[p$f]]))}this._materials=p$h}),p$L(0,p$q,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),p$L(0,p$q,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var p$h=this.boundingBox;p$Sq.add(p$h.min,p$h.max,this._boundingBoxCenter),p$Sq.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),p$L(0,p$q,"receiveShadow",function(){return this._receiveShadow},function(p$h){this._receiveShadow!==p$h&&((this._receiveShadow=p$h)?this._addShaderDefine(p$vq.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(p$vq.SHADERDEFINE_RECEIVE_SHADOW))}),p$L(0,p$q,"destroyed",function(){return this._destroyed}),p$g._uniqueIDCounter=0,p$U(p$g,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq,new p$Sq]},"_greenColor",function(){return this._greenColor=new p$Bq(0,1,0,1)}]),p$g}(),p$Rq=function(p$h){function p$B(p$h){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,p$B.__super.call(this),this._localPosition=new p$Sq,this._localRotation=new p$fq(0,0,0,1),this._localScale=new p$Sq(1,1,1),this._localRotationEuler=new p$Sq,this._localMatrix=new p$hq,this._position=new p$Sq,this._rotation=new p$fq(0,0,0,1),this._scale=new p$Sq(1,1,1),this._worldMatrix=new p$hq,this._forward=new p$Sq,this._up=new p$Sq,this._right=new p$Sq,this._owner=p$h,this._childs=[]}p$v(p$B,"laya.d3.core.Transform3D",p$P);var p$q=p$B.prototype;return p$q._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)p$hq.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var p$h=p$B._tempVector30;p$Sq.multiply(this.pivot,this._localScale,p$h);var p$q=p$B._tempVector31;p$Sq.subtract(p$h,this.pivot,p$q);var p$f=p$B._tempVector32,p$g=this.localRotation;p$Sq.transformQuat(p$h,p$g,p$f),p$Sq.subtract(p$f,p$h,p$f);var p$$=p$B._tempVector33;p$Sq.subtract(this._localPosition,p$q,p$$),p$Sq.subtract(p$$,p$f,p$$),p$hq.createAffineTransformation(p$$,p$g,this._localScale,this._localMatrix)}},p$q._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._onWorldPositionRotationTransform()}},p$q._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._onWorldPositionScaleTransform()}},p$q._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._onWorldPositionTransform()}},p$q._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._onWorldPositionRotationTransform()}},p$q._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._onWorldPositionScaleTransform()}},p$q._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._onWorldTransform()}},p$q.translate=function(p$h,p$q){void 0===p$q&&(p$q=!0),p$q?(p$hq.createFromQuaternion(this.localRotation,p$B._tempMatrix0),p$Sq.transformCoordinate(p$h,p$B._tempMatrix0,p$B._tempVector30),p$Sq.add(this.localPosition,p$B._tempVector30,this._localPosition),this.localPosition=this._localPosition):(p$Sq.add(this.position,p$h,this._position),this.position=this._position)},p$q.rotate=function(p$h,p$q,p$f){var p$g;void 0===p$q&&(p$q=!0),void 0===p$f&&(p$f=!0),p$g=p$f?p$h:(p$Sq.scale(p$h,Math.PI/180,p$B._tempVector30),p$B._tempVector30),p$fq.createFromYawPitchRoll(p$g.y,p$g.x,p$g.z,p$B._tempQuaternion0),p$q?(p$fq.multiply(this._localRotation,p$B._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(p$fq.multiply(p$B._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},p$q.lookAt=function(p$h,p$q,p$f){void 0===p$f&&(p$f=!1);var p$g,p$$=p$h.elements;if(p$f){if(p$g=this._localPosition.elements,Math.abs(p$g[0]-p$$[0])<p$xh.zeroTolerance&&Math.abs(p$g[1]-p$$[1])<p$xh.zeroTolerance&&Math.abs(p$g[2]-p$$[2])<p$xh.zeroTolerance)return;p$fq.lookAt(this._localPosition,p$h,p$q,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var p$P=this.position;if(p$g=p$P.elements,Math.abs(p$g[0]-p$$[0])<p$xh.zeroTolerance&&Math.abs(p$g[1]-p$$[1])<p$xh.zeroTolerance&&Math.abs(p$g[2]-p$$[2])<p$xh.zeroTolerance)return;p$fq.lookAt(p$P,p$h,p$q,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},p$L(0,p$q,"_isFrontFaceInvert",function(){var p$h=this.scale,p$q=p$h.x<0;return p$h.y<0&&(p$q=!p$q),p$h.z<0&&(p$q=!p$q),p$q}),p$L(0,p$q,"owner",function(){return this._owner}),p$L(0,p$q,"localRotation",function(){if(this._localQuaternionUpdate){var p$h=this._localRotationEuler.elements;p$fq.createFromYawPitchRoll(p$h[1]/p$B._angleToRandin,p$h[0]/p$B._angleToRandin,p$h[2]/p$B._angleToRandin,this._localRotation)}return this._localRotation},function(p$h){this._localRotation=p$h,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),p$L(0,p$q,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?p$hq.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(p$h){null===this._parent?p$h.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),p$hq.multiply(this._localMatrix,p$h,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=p$h,this._worldUpdate=!1}),p$L(0,p$q,"worldNeedUpdate",function(){return this._worldUpdate}),p$L(0,p$q,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(p$h){this._localMatrix=p$h,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),p$L(0,p$q,"dummy",function(){return this._dummy},function(p$h){this._dummy!==p$h&&(this._dummy&&(this._dummy._entity=null),p$h&&(p$h._entity=this),this._dummy=p$h)}),p$L(0,p$q,"localPosition",function(){return this._localPosition},function(p$h){this._localPosition=p$h,this._localUpdate=!0,this._onWorldPositionTransform()}),p$L(0,p$q,"position",function(){if(this._positionUpdate){if(null!=this._parent){var p$h=this._parent.position;p$Sq.multiply(this._localPosition,this._parent.scale,p$B._tempVector30),p$Sq.transformQuat(p$B._tempVector30,this._parent.rotation,p$B._tempVector30),p$Sq.add(p$h,p$B._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(p$h){if(null!=this._parent){p$Sq.subtract(p$h,this._parent.position,this._localPosition);var p$q=this._parent.scale.elements,p$f=p$q[0],p$g=p$q[1],p$$=p$q[2];if(1!==p$f||1!==p$g||1!==p$$){var p$P=p$B._tempVector30,p$S=p$P.elements;p$S[0]=1/p$f,p$S[1]=1/p$g,p$S[2]=1/p$$,p$Sq.multiply(this._localPosition,p$P,this._localPosition)}this._parent.rotation.invert(p$B._tempQuaternion0),p$Sq.transformQuat(this._localPosition,p$B._tempQuaternion0,this._localPosition)}else p$h.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=p$h,this._positionUpdate=!1}),p$L(0,p$q,"localScale",function(){return this._localScale},function(p$h){this._localScale=p$h,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),p$L(0,p$q,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(p$B._tempVector30);var p$h=p$B._tempVector30.elements,p$q=this._localRotationEuler.elements;p$q[0]=p$h[1]*p$B._angleToRandin,p$q[1]=p$h[0]*p$B._angleToRandin,p$q[2]=p$h[2]*p$B._angleToRandin}return this._localRotationEuler},function(p$h){this._localRotationEuler=p$h,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),p$L(0,p$q,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?p$fq.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(p$h){null!=this._parent?(this._parent.rotation.invert(p$B._tempQuaternion0),p$fq.multiply(p$h,p$B._tempQuaternion0,this._localRotation)):p$h.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=p$h,this._rotationUpdate=!1}),p$L(0,p$q,"scale",function(){return this._scaleUpdate&&(null!==this._parent?p$Sq.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(p$h){if(null!==this._parent){var p$q=this._parent.scale.elements,p$f=p$B._tempVector30.elements;p$f[0]=1/p$q[0],p$f[1]=1/p$q[1],p$f[2]=1/p$q[2],p$Sq.multiply(p$h,p$B._tempVector30,this._localScale)}else p$h.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=p$h,this._scaleUpdate=!1}),p$L(0,p$q,"rotationEuler",null,function(p$h){p$fq.createFromYawPitchRoll(p$h.y,p$h.x,p$h.z,this._rotation),this.rotation=this._rotation}),p$L(0,p$q,"forward",function(){var p$h=this.worldMatrix.elements;return this._forward.elements[0]=-p$h[8],this._forward.elements[1]=-p$h[9],this._forward.elements[2]=-p$h[10],this._forward}),p$L(0,p$q,"up",function(){var p$h=this.worldMatrix.elements;return this._up.elements[0]=p$h[4],this._up.elements[1]=p$h[5],this._up.elements[2]=p$h[6],this._up}),p$L(0,p$q,"right",function(){var p$h=this.worldMatrix.elements;return this._right.elements[0]=p$h[0],this._right.elements[1]=p$h[1],this._right.elements[2]=p$h[2],this._right}),p$L(0,p$q,"parent",function(){return this._parent},function(p$h){if(this._parent!==p$h){if(this._parent){var p$q=this._parent._childs,p$f=p$q.indexOf(this);p$q.splice(p$f,1)}p$h&&(p$h._childs.push(this),p$h&&this._onWorldTransform()),this._parent=p$h}}),p$U(p$B,["_tempVector30",function(){return this._tempVector30=new p$Sq},"_tempVector31",function(){return this._tempVector31=new p$Sq},"_tempVector32",function(){return this._tempVector32=new p$Sq},"_tempVector33",function(){return this._tempVector33=new p$Sq},"_tempQuaternion0",function(){return this._tempQuaternion0=new p$fq},"_tempMatrix0",function(){return this._tempMatrix0=new p$hq},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),p$B}(),p$tq=(function(p$h){function p$q(){this._rotation=0,this._matNeedUpdte=!1,p$q.__super.call(this),this._matrix=new p$hq,this._offset=new p$Pq,this._tiling=new p$Pq(1,1)}p$v(p$q,"laya.d3.core.TransformUV",p$P);var p$f=p$q.prototype;p$E.imps(p$f,{"laya.d3.core.IClone":!0}),p$f._updateMatrix=function(){p$q._tempOffsetV3.elements[0]=this._offset.x,p$q._tempOffsetV3.elements[1]=this._offset.y,p$fq.createFromYawPitchRoll(0,0,this._rotation,p$q._tempRotationQua),p$q._tempTitlingV3.elements[0]=this._tiling.x,p$q._tempTitlingV3.elements[1]=this._tiling.y,p$hq.createAffineTransformation(p$q._tempOffsetV3,p$q._tempRotationQua,p$q._tempTitlingV3,this._matrix)},p$f.cloneTo=function(p$h){p$h._matrix=this._matrix.clone(),p$h._offset=this._offset.clone(),p$h._rotation=this._rotation,p$h._tiling=this._tiling.clone()},p$f.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$f,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),p$L(0,p$f,"tiling",function(){return this._tiling},function(p$h){this._tiling=p$h,this._matNeedUpdte=!0}),p$L(0,p$f,"offset",function(){return this._offset},function(p$h){this._offset=p$h,this._matNeedUpdte=!0}),p$L(0,p$f,"rotation",function(){return this._rotation},function(p$h){this._rotation=p$h,this._matNeedUpdte=!0}),p$U(p$q,["_tempOffsetV3",function(){return this._tempOffsetV3=new p$Sq(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new p$fq},"_tempTitlingV3",function(){return this._tempTitlingV3=new p$Sq(1,1,1)}])}(),function(p$f){function p$h(){this.x=NaN,this.y=NaN,this.z=NaN,p$h.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}p$v(p$h,"laya.d3.core.particleShuriKen.module.shape.BoxShape",p$f);var p$q=p$h.prototype;p$q._getShapeBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=.5*-this.x,p$q[1]=.5*-this.y,p$q[2]=.5*-this.z;var p$f=p$h.max.elements;p$f[0]=.5*this.x,p$f[1]=.5*this.y,p$f[2]=.5*this.z},p$q._getSpeedBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=0,p$q[1]=0,p$q[2]=0;var p$f=p$h.max.elements;p$f[0]=0,p$f[1]=1,p$f[2]=0},p$q.generatePositionAndDirection=function(p$h,p$q,p$f,p$g){var p$$=p$h.elements,p$P=p$q.elements;p$f?(p$f.seed=p$g[16],p$V._randomPointInsideHalfUnitBox(p$h,p$f),p$g[16]=p$f.seed):p$V._randomPointInsideHalfUnitBox(p$h),p$$[0]=this.x*p$$[0],p$$[1]=this.y*p$$[1],p$$[2]=this.z*p$$[2],this.randomDirection?p$f?(p$f.seed=p$g[17],p$V._randomPointUnitSphere(p$q,p$f),p$g[17]=p$f.seed):p$V._randomPointUnitSphere(p$q):(p$P[0]=0,p$P[1]=0,p$P[2]=1)},p$q.cloneTo=function(p$h){p$f.prototype.cloneTo.call(this,p$h);var p$q=p$h;p$q.x=this.x,p$q.y=this.y,p$q.z=this.z,p$q.randomDirection=this.randomDirection}}(p$w),function(p$f){function p$S(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,p$S.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}p$v(p$S,"laya.d3.core.particleShuriKen.module.shape.CircleShape",p$f);var p$h=p$S.prototype;p$h._getShapeBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=p$q[2]=-this.radius,p$q[1]=0;var p$f=p$h.max.elements;p$f[0]=p$f[2]=this.radius,p$f[1]=0},p$h._getSpeedBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=p$q[1]=-1,p$q[2]=0;var p$f=p$h.max.elements;p$f[0]=p$f[1]=1,p$f[2]=0},p$h.generatePositionAndDirection=function(p$h,p$q,p$f,p$g){var p$$=p$h.elements,p$P=p$S._tempPositionPoint.elements;p$f?(p$f.seed=p$g[16],this.emitFromEdge?p$V._randomPointUnitArcCircle(this.arc,p$S._tempPositionPoint,p$f):p$V._randomPointInsideUnitArcCircle(this.arc,p$S._tempPositionPoint,p$f),p$g[16]=p$f.seed):this.emitFromEdge?p$V._randomPointUnitArcCircle(this.arc,p$S._tempPositionPoint):p$V._randomPointInsideUnitArcCircle(this.arc,p$S._tempPositionPoint),p$$[0]=-p$P[0],p$$[1]=p$P[1],p$$[2]=0,p$Sq.scale(p$h,this.radius,p$h),this.randomDirection?p$f?(p$f.seed=p$g[17],p$V._randomPointUnitSphere(p$q,p$f),p$g[17]=p$f.seed):p$V._randomPointUnitSphere(p$q):p$h.cloneTo(p$q)},p$h.cloneTo=function(p$h){p$f.prototype.cloneTo.call(this,p$h);var p$q=p$h;p$q.radius=this.radius,p$q.arc=this.arc,p$q.emitFromEdge=this.emitFromEdge,p$q.randomDirection=this.randomDirection},p$U(p$S,["_tempPositionPoint",function(){return this._tempPositionPoint=new p$Pq}])}(p$w),function(p$f){function p$u(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,p$u.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}p$v(p$u,"laya.d3.core.particleShuriKen.module.shape.ConeShape",p$f);var p$h=p$u.prototype;p$h._getShapeBoundBox=function(p$h){var p$q=this.radius+this.length*Math.sin(this.angle),p$f=this.length*Math.cos(this.angle),p$g=p$h.min.elements;p$g[0]=p$g[1]=-p$q,p$g[2]=0;var p$$=p$h.max.elements;p$$[0]=p$$[1]=p$q,p$$[2]=p$f},p$h._getSpeedBoundBox=function(p$h){var p$q=Math.sin(this.angle),p$f=p$h.min.elements;p$f[0]=p$f[1]=-p$q,p$f[2]=0;var p$g=p$h.max.elements;p$g[0]=p$f[1]=p$q,p$g[2]=1},p$h.generatePositionAndDirection=function(p$h,p$q,p$f,p$g){var p$$,p$P=p$h.elements,p$S=p$q.elements,p$B=p$u._tempPositionPoint.elements,p$r=NaN,p$Y=NaN,p$C=Math.cos(this.angle),p$U=Math.sin(this.angle);switch(this.emitType){case 0:p$f?(p$f.seed=p$g[16],p$V._randomPointInsideUnitCircle(p$u._tempPositionPoint,p$f),p$g[16]=p$f.seed):p$V._randomPointInsideUnitCircle(p$u._tempPositionPoint),p$r=p$B[0],p$Y=p$B[1],p$P[0]=p$r*this.radius,p$P[1]=p$Y*this.radius,p$P[2]=0,this.randomDirection?(p$f?(p$f.seed=p$g[17],p$V._randomPointInsideUnitCircle(p$u._tempDirectionPoint,p$f),p$g[17]=p$f.seed):p$V._randomPointInsideUnitCircle(p$u._tempDirectionPoint),p$$=p$u._tempDirectionPoint.elements,p$S[0]=p$$[0]*p$U,p$S[1]=p$$[1]*p$U):(p$S[0]=p$r*p$U,p$S[1]=p$Y*p$U),p$S[2]=p$C;break;case 1:p$f?(p$f.seed=p$g[16],p$V._randomPointUnitCircle(p$u._tempPositionPoint,p$f),p$g[16]=p$f.seed):p$V._randomPointUnitCircle(p$u._tempPositionPoint),p$r=p$B[0],p$Y=p$B[1],p$P[0]=p$r*this.radius,p$P[1]=p$Y*this.radius,p$P[2]=0,this.randomDirection?(p$f?(p$f.seed=p$g[17],p$V._randomPointInsideUnitCircle(p$u._tempDirectionPoint,p$f),p$g[17]=p$f.seed):p$V._randomPointInsideUnitCircle(p$u._tempDirectionPoint),p$$=p$u._tempDirectionPoint.elements,p$S[0]=p$$[0]*p$U,p$S[1]=p$$[1]*p$U):(p$S[0]=p$r*p$U,p$S[1]=p$Y*p$U),p$S[2]=p$C;break;case 2:p$f?(p$f.seed=p$g[16],p$V._randomPointInsideUnitCircle(p$u._tempPositionPoint,p$f)):p$V._randomPointInsideUnitCircle(p$u._tempPositionPoint),p$r=p$B[0],p$Y=p$B[1],p$P[0]=p$r*this.radius,p$P[1]=p$Y*this.radius,p$S[p$P[2]=0]=p$r*p$U,p$S[1]=p$Y*p$U,p$S[2]=p$C,p$Sq.normalize(p$q,p$q),p$f?(p$Sq.scale(p$q,this.length*p$f.getFloat(),p$q),p$g[16]=p$f.seed):p$Sq.scale(p$q,this.length*Math.random(),p$q),p$Sq.add(p$h,p$q,p$h),this.randomDirection&&(p$f?(p$f.seed=p$g[17],p$V._randomPointUnitSphere(p$q,p$f),p$g[17]=p$f.seed):p$V._randomPointUnitSphere(p$q));break;case 3:p$f?(p$f.seed=p$g[16],p$V._randomPointUnitCircle(p$u._tempPositionPoint,p$f)):p$V._randomPointUnitCircle(p$u._tempPositionPoint),p$r=p$B[0],p$Y=p$B[1],p$P[0]=p$r*this.radius,p$P[1]=p$Y*this.radius,p$S[p$P[2]=0]=p$r*p$U,p$S[1]=p$Y*p$U,p$S[2]=p$C,p$Sq.normalize(p$q,p$q),p$f?(p$Sq.scale(p$q,this.length*p$f.getFloat(),p$q),p$g[16]=p$f.seed):p$Sq.scale(p$q,this.length*Math.random(),p$q),p$Sq.add(p$h,p$q,p$h),this.randomDirection&&(p$f?(p$f.seed=p$g[17],p$V._randomPointUnitSphere(p$q,p$f),p$g[17]=p$f.seed):p$V._randomPointUnitSphere(p$q));break;default:throw new Error("ConeShape:emitType is invalid.")}},p$h.cloneTo=function(p$h){p$f.prototype.cloneTo.call(this,p$h);var p$q=p$h;p$q.angle=this.angle,p$q.radius=this.radius,p$q.length=this.length,p$q.emitType=this.emitType,p$q.randomDirection=this.randomDirection},p$U(p$u,["_tempPositionPoint",function(){return this._tempPositionPoint=new p$Pq},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new p$Pq}])}(p$w),function(p$f){function p$h(){this.radius=NaN,this.emitFromShell=!1,p$h.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}p$v(p$h,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",p$f);var p$q=p$h.prototype;p$q._getShapeBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=p$q[1]=p$q[2]=-this.radius;var p$f=p$h.max.elements;p$f[0]=p$f[1]=this.radius,p$f[2]=0},p$q._getSpeedBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=p$q[1]=-1,p$q[2]=0;var p$f=p$h.max.elements;p$f[0]=p$f[1]=p$f[2]=1},p$q.generatePositionAndDirection=function(p$h,p$q,p$f,p$g){var p$$=p$h.elements;p$f?(p$f.seed=p$g[16],this.emitFromShell?p$V._randomPointUnitSphere(p$h,p$f):p$V._randomPointInsideUnitSphere(p$h,p$f),p$g[16]=p$f.seed):this.emitFromShell?p$V._randomPointUnitSphere(p$h):p$V._randomPointInsideUnitSphere(p$h),p$Sq.scale(p$h,this.radius,p$h);var p$P=p$$[2];p$P<0&&(p$$[2]=-1*p$P),this.randomDirection?p$f?(p$f.seed=p$g[17],p$V._randomPointUnitSphere(p$q,p$f),p$g[17]=p$f.seed):p$V._randomPointUnitSphere(p$q):p$h.cloneTo(p$q)},p$q.cloneTo=function(p$h){p$f.prototype.cloneTo.call(this,p$h);var p$q=p$h;p$q.radius=this.radius,p$q.emitFromShell=this.emitFromShell,p$q.randomDirection=this.randomDirection}}(p$w),function(p$f){function p$h(){this.radius=NaN,this.emitFromShell=!1,p$h.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}p$v(p$h,"laya.d3.core.particleShuriKen.module.shape.SphereShape",p$f);var p$q=p$h.prototype;p$q._getShapeBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=p$q[1]=p$q[2]=-this.radius;var p$f=p$h.max.elements;p$f[0]=p$f[1]=p$f[2]=this.radius},p$q._getSpeedBoundBox=function(p$h){var p$q=p$h.min.elements;p$q[0]=p$q[1]=p$q[2]=-1;var p$f=p$h.max.elements;p$f[0]=p$f[1]=p$f[2]=1},p$q.generatePositionAndDirection=function(p$h,p$q,p$f,p$g){p$f?(p$f.seed=p$g[16],this.emitFromShell?p$V._randomPointUnitSphere(p$h,p$f):p$V._randomPointInsideUnitSphere(p$h,p$f),p$g[16]=p$f.seed):this.emitFromShell?p$V._randomPointUnitSphere(p$h):p$V._randomPointInsideUnitSphere(p$h),p$Sq.scale(p$h,this.radius,p$h),this.randomDirection?p$f?(p$f.seed=p$g[17],p$V._randomPointUnitSphere(p$q,p$f),p$g[17]=p$f.seed):p$V._randomPointUnitSphere(p$q):p$h.cloneTo(p$q)},p$q.cloneTo=function(p$h){p$f.prototype.cloneTo.call(this,p$h);var p$q=p$h;p$q.radius=this.radius,p$q.emitFromShell=this.emitFromShell,p$q.randomDirection=this.randomDirection}}(p$w),function(p$h){function p$q(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,p$q.__super.call(this)}return p$v(p$q,"laya.d3.core.render.SubMeshRenderElement",p$F),p$q}()),p$Xq=function(p$h){function p$l(p$h,p$q,p$f,p$g,p$$,p$P){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=p$h,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[p$vq.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[p$yq.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[p$yq.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[p$Aq.SHADERDEFINE_ALPHATEST]="ALPHATEST";p$l.__super.call(this,p$h,p$q,p$f,null,{}),this._attributeMap=p$g;var p$S;for(p$S in p$$){var p$B=p$$[p$S];switch(p$B[1]){case 0:this._renderElementUniformMap[p$S]=p$B[0];break;case 1:this._materialUniformMap[p$S]=p$B[0];break;case 2:this._spriteUniformMap[p$S]=p$B[0];break;case 3:this._cameraUniformMap[p$S]=p$B[0];break;case 4:this._sceneUniformMap[p$S]=p$B[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}p$v(p$l,"laya.d3.shader.ShaderCompile3D",p$G);var p$q=p$l.prototype;return p$q._definesToNameDic=function(p$h,p$q){for(var p$f={},p$g=1,p$$=0;p$$<32&&!(p$h<(p$g=1<<p$$));p$$++)if(p$h&p$g){var p$P=p$q[p$g];p$P&&(p$f[p$P]="")}return p$f},p$q.withCompile=function(p$h,p$q,p$f,p$g){var p$$,p$P,p$S;if(p$P=this.sharders[p$h])if(p$S=p$P[p$q]){if(p$$=p$S[p$f])return p$$}else p$S=p$P[p$q]=[];else p$S=(p$P=this.sharders[p$h]=[])[p$q]=[];var p$B,p$r=this._definesToNameDic(p$h,p$l._globalInt2name),p$Y=this._definesToNameDic(p$q,this._spriteInt2name),p$C=this._definesToNameDic(p$f,this._materialInt2name),p$U={},p$u="";if(p$r)for(p$B in p$r)p$u+="#define "+p$B+"\n",p$U[p$B]=!0;if(p$Y)for(p$B in p$Y)p$u+="#define "+p$B+"\n",p$U[p$B]=!0;if(p$C)for(p$B in p$C)p$u+="#define "+p$B+"\n",p$U[p$B]=!0;var p$v=p$Wq.nameKey.getName(this._name)+" compile ("+p$h+","+p$q+","+p$f+")",p$L=this._VS.toscript(p$U,[]),p$e=this._PS.toscript(p$U,[]);p$i.now();if(p$$=p$Wq.create(p$u+p$L.join("\n"),p$u+p$e.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,p$g,p$v),p$S[p$f]=p$$,laya.d3.shader.ShaderCompile3D.debugMode)p$i.now();return p$$},p$q.precompileShaderWithShaderDefine=function(p$h,p$q,p$f){this.withCompile(p$h,p$q,p$f,!0)},p$q.addMaterialDefines=function(p$h){var p$q=p$h.defines;for(var p$f in p$q){var p$g=p$q[p$f],p$$=parseInt(p$f);this._materialInt2name[p$$]=p$g,this._materialName2Int[p$g]=p$$}},p$q.addSpriteDefines=function(p$h){var p$q=p$h.defines;for(var p$f in p$q){var p$g=p$q[p$f],p$$=parseInt(p$f);this._spriteInt2name[p$$]=p$g,this._spriteName2Int[p$g]=p$$}},p$q.getMaterialDefineByName=function(p$h){return this._materialName2Int[p$h]},p$q.registerMaterialDefine=function(p$h){var p$q=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[p$q]=p$h,this._materialName2Int[p$h]=p$q},p$q.registerSpriteDefine=function(p$h){var p$q=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[p$q]=p$h,this._spriteName2Int[p$h]=p$q},p$l._globalRegDefine=function(p$h,p$q){p$l._globalInt2name[p$q]=p$h},p$l.add=function(p$h,p$q,p$f,p$g,p$$){return laya.d3.shader.ShaderCompile3D._preCompileShader[p$h]=new p$l(p$h,p$q,p$f,p$g,p$$,p$G.includes)},p$l.get=function(p$h){return laya.d3.shader.ShaderCompile3D._preCompileShader[p$Wq.nameKey.getID(p$h)]},p$l._preCompileShader={},p$l._globalInt2name=[],p$l.debugMode=!1,p$l.SHADERDEFINE_HIGHPRECISION=1,p$l.SHADERDEFINE_FOG=4,p$l.SHADERDEFINE_DIRECTIONLIGHT=8,p$l.SHADERDEFINE_POINTLIGHT=16,p$l.SHADERDEFINE_SPOTLIGHT=32,p$l.SHADERDEFINE_UV0=64,p$l.SHADERDEFINE_COLOR=128,p$l.SHADERDEFINE_UV1=256,p$l.SAHDERDEFINE_DEPTHFOG=131072,p$l}(),p$nq=function(p$h){function p$L(){p$L.__super.call(this)}p$v(p$L,"laya.d3.graphics.MeshSprite3DStaticBatchManager",p$gh);var p$q=p$L.prototype;return p$q._getStaticBatch=function(p$h,p$q,p$f,p$g){var p$$,p$P;return p$P=p$h?p$h.id.toString()+p$f.id.toString()+p$q.id.toString()+p$g.toString():p$f.id.toString()+p$q.id.toString()+p$g.toString(),this._staticBatches[p$P]?p$$=this._staticBatches[p$P]:this._staticBatches[p$P]=p$$=new p$Jq(p$P,this,p$h,p$q,p$f),p$$},p$q._initStaticBatchs=function(p$h){var p$q,p$f;this._initBatchRenderElements.sort(p$L._sortPrepareStaticBatch);for(var p$g,p$$=!1,p$P=0,p$S=0,p$B=this._initBatchRenderElements.length;p$S<p$B;p$S++){var p$r,p$Y=this._initBatchRenderElements[p$S],p$C=p$Y.renderObj._getVertexBuffer(0);p$Y._sprite3D;if(p$f===p$C.vertexDeclaration&&p$q===p$Y._material)if(p$$)p$g._addCombineBatchRenderObjTest(p$Y)?(p$r=p$Y._staticBatch)!==p$g&&(p$r&&p$r._deleteCombineBatchRenderObj(p$Y),p$g._addCombineBatchRenderObj(p$Y)):(p$$=!1,p$P++);else{var p$U=this._initBatchRenderElements[p$S-1],p$u=p$U.renderObj,p$v=p$Y.renderObj;p$$=!(65535<p$u._getVertexBuffer().vertexCount+p$v._getVertexBuffer().vertexCount)&&(p$g=this._getStaticBatch(p$h,p$f,p$q,p$P),(p$r=p$U._staticBatch)!==p$g&&(p$r&&p$r._deleteCombineBatchRenderObj(p$U),p$g._addCombineBatchRenderObj(p$U)),(p$r=p$Y._staticBatch)!==p$g&&(p$r&&p$r._deleteCombineBatchRenderObj(p$Y),p$g._addCombineBatchRenderObj(p$Y)),!0)}else p$$=!1,p$P=0;p$q=p$Y._material,p$f=p$C.vertexDeclaration}},p$L._sortPrepareStaticBatch=function(p$h,p$q){var p$f=p$h._render,p$g=p$q._render,p$$=p$f.lightmapIndex-p$g.lightmapIndex;if(0!=p$$)return p$$;var p$P=p$f.receiveShadow-p$g.receiveShadow;if(0!=p$P)return p$P;var p$S=p$h._mainSortID-p$q._mainSortID;return 0==p$S?p$h.renderObj.triangleCount-p$q.renderObj.triangleCount:p$S},p$L}(),p$Jq=function(p$h){function p$P(p$h,p$q,p$f,p$g,p$$){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,p$P.__super.call(this,p$h,p$q,p$f),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=p$g,this._material=p$$}p$v(p$P,"laya.d3.graphics.SubMeshStaticBatch",p$$h);var p$q=p$P.prototype;return p$q._compareBatchRenderElement=function(p$h,p$q){return p$h._batchIndexStart>p$q._batchIndexStart},p$q._addCombineBatchRenderObjTest=function(p$h){var p$q=p$h.renderObj._vertexCount;return!(65535<(0<p$q?this._currentCombineVertexCount+p$q:this._currentCombineVertexCount+p$h.renderObj._getVertexBuffer().vertexCount))},p$q._addCombineBatchRenderObj=function(p$h){var p$q=p$h.renderObj,p$f=p$q._vertexCount;this._initBatchRenderElements.push(p$h),p$h._staticBatch=this,0<p$f?(this._currentCombineIndexCount+=p$q._indexCount,this._currentCombineVertexCount+=p$f):(this._currentCombineIndexCount=this._currentCombineIndexCount+p$q._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+p$q._getVertexBuffer().vertexCount),this._needFinishCombine=!0},p$q._deleteCombineBatchRenderObj=function(p$h){var p$q=p$h.renderObj,p$f=this._initBatchRenderElements.indexOf(p$h);if(-1!==p$f){this._initBatchRenderElements.splice(p$f,1),p$h._staticBatch=null;var p$g=p$q._vertexCount;0<p$g?(this._currentCombineIndexCount=this._currentCombineIndexCount-p$q._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-p$g):(this._currentCombineIndexCount=this._currentCombineIndexCount-p$q._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-p$q._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},p$q._finishInit=function(){if(this._needFinishCombine){var p$h=0,p$q=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var p$f=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),p$g=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=p$wq.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=p$Iq.create("ushort",this._currentCombineIndexCount,35044);for(var p$$=0,p$P=this._initBatchRenderElements.length;p$$<p$P;p$$++){var p$S=this._initBatchRenderElements[p$$],p$B=p$S.renderObj,p$r=p$B._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,p$S._sprite3D),p$Y=p$B.getIndices(),p$C=p$S._sprite3D.transform._isFrontFaceInvert,p$U=p$h/(this._vertexDeclaration.vertexStride/4)-p$B._vertexStart,p$u=p$q,p$v=p$u+p$Y.length;p$S._batchIndexStart=p$u,p$S._batchIndexEnd=p$v,p$g.set(p$Y,p$q);var p$L=0;if(p$C)for(p$L=p$u;p$L<p$v;p$L+=3){p$g[p$L]=p$U+p$g[p$L];var p$e=p$g[p$L+1],p$l=p$g[p$L+2];p$g[p$L+1]=p$U+p$l,p$g[p$L+2]=p$U+p$e}else for(p$L=p$u;p$L<p$v;p$L+=3)p$g[p$L]=p$U+p$g[p$L],p$g[p$L+1]=p$U+p$g[p$L+1],p$g[p$L+2]=p$U+p$g[p$L+2];p$q+=p$Y.length,p$f.set(p$r,p$h),p$h+=p$r.length}this._vertexBuffer.setData(p$f),this._indexBuffer.setData(p$g),this._needFinishCombine=!1}},p$q._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new p$tq)},p$q._getRenderElement=function(p$h,p$q,p$f){for(var p$g,p$$,p$P=this._batchRenderElements.length,p$S=!0,p$B=0;p$B<p$P;p$B++){var p$r,p$Y,p$C=(p$$=this._batchRenderElements[p$B])._sprite3D._render;if(0!==p$B&&(p$S=(p$r=(p$g=this._batchRenderElements[p$B-1])._sprite3D._render).lightmapIndex!==p$C.lightmapIndex||p$r.receiveShadow!==p$C.receiveShadow||p$g._batchIndexEnd!==p$$._batchIndexStart),p$S){(p$Y=this._getCombineRenderElementFromPool()).renderObj=this,p$Y._material=this._material,p$Y._batchIndexStart=p$$._batchIndexStart,p$Y._batchIndexEnd=p$$._batchIndexEnd;var p$U=p$C.lightmapIndex,p$u=p$U+1,p$v=this._batchOwnerIndices[p$u];p$v||(p$v=this._batchOwnerIndices[p$u]=[]);var p$L,p$e=p$v[p$$._render.receiveShadow?1:0];void 0===p$e?(p$v[p$C.receiveShadow?1:0]=this._batchOwners.length,(p$L=new p$Zq(null,"StaticBatchMeshSprite3D"))._scene=p$q,p$L._transform=this._rootOwner?this._rootOwner._transform:null,p$L._render.lightmapIndex=p$U,p$L._render.receiveShadow=p$$._render.receiveShadow,this._batchOwners.push(p$L)):p$L=this._batchOwners[p$e],p$L._render._renderUpdate(p$f),p$Y._sprite3D=p$L,p$h.push(p$Y)}else p$Y._batchIndexEnd=p$$._batchIndexEnd}},p$q._beforeRender=function(p$h){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},p$q._render=function(p$h){var p$q=p$h.renderElement,p$f=p$q._batchIndexStart,p$g=p$q._batchIndexEnd-p$f;p$d.mainContext.drawElements(4,p$g,5123,2*p$f),p$X.drawCall++,p$X.trianglesFaces+=p$g/3},p$q.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},p$q._getVertexBuffer=function(p$h){return void 0===p$h&&(p$h=0),this._vertexBuffer},p$P}(),p$pq=function(p$h){function p$q(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,p$q.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}p$v(p$q,"laya.d3.core.ComponentNode",p$Y);var p$f=p$q.prototype;return p$f.addComponent=function(p$h){var p$q,p$f=this._componentsMap.indexOf(p$h);if(-1===p$f)p$q=[],this._componentsMap.push(p$h),this._typeComponentsIndices.push(p$q);else if(p$q=this._typeComponentsIndices[p$f],this._components[p$q[0]].isSingleton)throw new Error("无法单实例创建"+p$h+"组件，"+p$h+"组件已存在！");var p$g=p$$.getInstance(p$h);return p$q.push(this._components.length),this._components.push(p$g),p$g instanceof laya.d3.component.Script&&this._scripts.push(p$g),p$g._initialize(this),p$g},p$f._removeComponent=function(p$h,p$q){var p$f=this._typeComponentsIndices[p$h],p$g=p$f[p$q],p$$=this._components[p$g];this._components.splice(p$g,1),p$$ instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(p$$),1),p$f.splice(p$q,1),0===p$f.length&&(this._typeComponentsIndices.splice(p$h,1),this._componentsMap.splice(p$h,1));for(var p$P=0,p$S=this._componentsMap.length;p$P<p$S;p$P++)for(var p$B=(p$f=this._typeComponentsIndices[p$P]).length-1;0<=p$B;p$B--){var p$r=p$f[p$B];if(!(p$g<p$r))break;p$f[p$B]=--p$r}p$$._destroy()},p$f.getComponentByType=function(p$h,p$q){void 0===p$q&&(p$q=0);var p$f=this._componentsMap.indexOf(p$h);return-1===p$f?null:this._components[this._typeComponentsIndices[p$f][p$q]]},p$f.getComponentsByType=function(p$h,p$q){var p$f=this._componentsMap.indexOf(p$h);if(-1!==p$f){var p$g=this._typeComponentsIndices[p$f],p$$=p$g.length;p$q.length=p$$;for(var p$P=0;p$P<p$$;p$P++)p$q[p$P]=this._components[p$g[p$P]]}else p$q.length=0},p$f.getComponentByIndex=function(p$h){return this._components[p$h]},p$f.removeComponentByType=function(p$h,p$q){void 0===p$q&&(p$q=0);var p$f=this._componentsMap.indexOf(p$h);-1!==p$f&&this._removeComponent(p$f,p$q)},p$f.removeComponentsByType=function(p$h){var p$q=this._componentsMap.indexOf(p$h);if(-1!==p$q)for(var p$f=this._typeComponentsIndices[p$q],p$g=0,p$$=p$f.length;p$g<p$$;p$f.length<p$$?p$$--:p$g++)this._removeComponent(p$q,p$g)},p$f.removeAllComponent=function(){for(var p$h=0,p$q=this._componentsMap.length;p$h<p$q;this._componentsMap.length<p$q?p$q--:p$h++)this.removeComponentsByType(this._componentsMap[p$h])},p$f._updateComponents=function(p$h){for(var p$q=0,p$f=this._components.length;p$q<p$f;p$q++){var p$g=this._components[p$q];!p$g.started&&(p$g._start(p$h),p$g.started=!0),p$g.enable&&p$g._update(p$h)}},p$f._lateUpdateComponents=function(p$h){for(var p$q=0;p$q<this._components.length;p$q++){var p$f=this._components[p$q];!p$f.started&&(p$f._start(p$h),p$f.started=!0),p$f.enable&&p$f._lateUpdate(p$h)}},p$f._preRenderUpdateComponents=function(p$h){for(var p$q=0;p$q<this._components.length;p$q++){var p$f=this._components[p$q];!p$f.started&&(p$f._start(p$h),p$f.started=!0),p$f.enable&&p$f._preRenderUpdate(p$h)}},p$f._postRenderUpdateComponents=function(p$h){for(var p$q=0;p$q<this._components.length;p$q++){var p$f=this._components[p$q];!p$f.started&&(p$f._start(p$h),p$f.started=!0),p$f.enable&&p$f._postRenderUpdate(p$h)}},p$q}(),p$Aq=function(p$g){function p$h(){p$h.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new p$uq,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new p$Bq(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}p$v(p$h,"laya.d3.core.material.BaseMaterial",p$g);var p$q=p$h.prototype;return p$E.imps(p$q,{"laya.d3.core.IClone":!0}),p$q._addShaderDefine=function(p$h){this._shaderDefineValue|=p$h},p$q._removeShaderDefine=function(p$h){this._shaderDefineValue&=~p$h},p$q._addDisablePublicShaderDefine=function(p$h){this._disablePublicShaderDefine|=p$h},p$q._removeDisablePublicShaderDefine=function(p$h){this._disablePublicShaderDefine&=~p$h},p$q._setBuffer=function(p$h,p$q){this._shaderValues.setValue(p$h,p$q),this._values[p$h]=p$q},p$q._getBuffer=function(p$h){return this._values[p$h]},p$q._setMatrix4x4=function(p$h,p$q){this._shaderValues.setValue(p$h,p$q?p$q.elements:null),this._values[p$h]=p$q},p$q._getMatrix4x4=function(p$h){return this._values[p$h]},p$q._setInt=function(p$h,p$q){this._shaderValues.setValue(p$h,p$q),this._values[p$h]=p$q},p$q._getInt=function(p$h){return this._values[p$h]},p$q._setNumber=function(p$h,p$q){this._shaderValues.setValue(p$h,p$q),this._values[p$h]=p$q},p$q._getNumber=function(p$h){return this._values[p$h]},p$q._setBool=function(p$h,p$q){this._shaderValues.setValue(p$h,p$q),this._values[p$h]=p$q},p$q._getBool=function(p$h){return this._values[p$h]},p$q._setVector2=function(p$h,p$q){this._shaderValues.setValue(p$h,p$q?p$q.elements:null),this._values[p$h]=p$q},p$q._getVector2=function(p$h){return this._values[p$h]},p$q._setColor=function(p$h,p$q){this._shaderValues.setValue(p$h,p$q?p$q.elements:null),this._values[p$h]=p$q},p$q._getColor=function(p$h){return this._values[p$h]},p$q._setTexture=function(p$h,p$q){var p$f=this._values[p$h];this._values[p$h]=p$q,this._shaderValues.setValue(p$h,p$q),0<this.referenceCount&&(p$f&&p$f._removeReference(),p$q&&p$q._addReference())},p$q._getTexture=function(p$h){return this._values[p$h]},p$q._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},p$q._getShader=function(p$h,p$q,p$f){var p$g=(p$h|p$q)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(p$g,p$f,this._shaderDefineValue),this._shader},p$q._setRenderStateBlendDepth=function(){var p$h=p$d.mainContext;switch(p$b.setDepthMask(p$h,this.depthWrite),0===this.depthTest?p$b.setDepthTest(p$h,!1):(p$b.setDepthTest(p$h,!0),p$b.setDepthFunc(p$h,this.depthTest)),this.blend){case 0:p$b.setBlend(p$h,!1);break;case 1:p$b.setBlend(p$h,!0),p$b.setBlendFunc(p$h,this.srcBlend,this.dstBlend);break;case 2:p$b.setBlend(p$h,!0)}},p$q._setRenderStateFrontFace=function(p$h,p$q){var p$f=p$d.mainContext,p$g=0;switch(this.cull){case 0:p$b.setCullFace(p$f,!1);break;case 1:p$b.setCullFace(p$f,!0),p$g=p$h?p$q&&p$q._isFrontFaceInvert?2305:2304:p$q&&p$q._isFrontFaceInvert?2304:2305,p$b.setFrontFace(p$f,p$g);break;case 2:p$b.setCullFace(p$f,!0),p$g=p$h?p$q&&p$q._isFrontFaceInvert?2304:2305:p$q&&p$q._isFrontFaceInvert?2305:2304,p$b.setFrontFace(p$f,p$g)}},p$q.onAsynLoaded=function(p$h,p$q,p$f){var p$g=p$q[0],p$$=p$q[1];switch(p$g.version){case"LAYAMATERIAL:01":var p$P=0,p$S=0,p$B=p$g.props;for(var p$r in p$B)switch(p$r){case"vectors":var p$Y=p$B[p$r];for(p$P=0,p$S=p$Y.length;p$P<p$S;p$P++){var p$C=p$Y[p$P],p$U=p$C.value;switch(p$U.length){case 2:this[p$C.name]=new p$Pq(p$U[0],p$U[1]);break;case 3:this[p$C.name]=new p$Sq(p$U[0],p$U[1],p$U[2]);break;case 4:this[p$C.name]=new p$Bq(p$U[0],p$U[1],p$U[2],p$U[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var p$u=p$B[p$r];for(p$P=0,p$S=p$u.length;p$P<p$S;p$P++){var p$v=p$u[p$P],p$L=p$v.path;p$L&&(this[p$v.name]=p$_.getRes(p$$[p$L]))}break;case"defines":var p$e=p$B[p$r];for(p$P=0,p$S=p$e.length;p$P<p$S;p$P++){var p$l=this._shaderCompile.getMaterialDefineByName(p$e[p$P]);this._addShaderDefine(p$l)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[p$r]=p$B[p$r];break;case"renderQueue":switch(p$B[p$r]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[p$r]=p$B[p$r]}break;case"LAYAMATERIAL:02":for(p$r in p$B=p$g.props)switch(p$r){case"vectors":for(p$P=0,p$S=(p$Y=p$B[p$r]).length;p$P<p$S;p$P++)switch((p$U=(p$C=p$Y[p$P]).value).length){case 2:this[p$C.name]=new p$Pq(p$U[0],p$U[1]);break;case 3:this[p$C.name]=new p$Sq(p$U[0],p$U[1],p$U[2]);break;case 4:this[p$C.name]=new p$Bq(p$U[0],p$U[1],p$U[2],p$U[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(p$P=0,p$S=(p$u=p$B[p$r]).length;p$P<p$S;p$P++)(p$L=(p$v=p$u[p$P]).path)&&(this[p$v.name]=p$_.getRes(p$$[p$L]));break;case"defines":for(p$P=0,p$S=(p$e=p$B[p$r]).length;p$P<p$S;p$P++)p$l=this._shaderCompile.getMaterialDefineByName(p$e[p$P]),this._addShaderDefine(p$l);break;default:this[p$r]=p$B[p$r]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},p$q._addReference=function(){p$g.prototype._addReference.call(this);for(var p$h=0,p$q=this._values.length;p$h<p$q;p$h++){var p$f=this._values[p$h];p$f&&p$f instanceof laya.d3.resource.BaseTexture&&p$f._addReference()}},p$q._removeReference=function(){p$g.prototype._removeReference.call(this);for(var p$h=0,p$q=this._values.length;p$h<p$q;p$h++){var p$f=this._values[p$h];p$f&&p$f instanceof laya.d3.resource.BaseTexture&&p$f._removeReference()}},p$q.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},p$q.setShaderName=function(p$h){var p$q=p$Wq.nameKey.getID(p$h);if(-1===p$q)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=p$Xq._preCompileShader[p$q]},p$q.cloneTo=function(p$h){var p$q=p$h;p$q.name=this.name,p$q.cull=this.cull,p$q.blend=this.blend,p$q.srcBlend=this.srcBlend,p$q.dstBlend=this.dstBlend,p$q.srcBlendRGB=this.srcBlendRGB,p$q.dstBlendRGB=this.dstBlendRGB,p$q.srcBlendAlpha=this.srcBlendAlpha,p$q.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(p$q.blendConstColor),p$q.blendEquation=this.blendEquation,p$q.blendEquationRGB=this.blendEquationRGB,p$q.blendEquationAlpha=this.blendEquationAlpha,p$q.depthTest=this.depthTest,p$q.depthWrite=this.depthWrite,p$q.renderQueue=this.renderQueue,p$q._shader=this._shader,p$q._disablePublicShaderDefine=this._disablePublicShaderDefine,p$q._shaderDefineValue=this._shaderDefineValue;var p$f,p$g=0,p$$=p$q._shaderValues;p$q._shaderValues.data.length=this._shaderValues.data.length;var p$P=this._values.length,p$S=p$q._values;for(p$g=0,p$f=p$S.length=p$P;p$g<p$f;p$g++){var p$B=this._values[p$g];if(p$B)if("number"==typeof p$B)p$S[p$g]=p$B,p$$.data[p$g]=p$B;else if("number"==typeof p$B&&Math.floor(p$B)==p$B)p$S[p$g]=p$B,p$$.data[p$g]=p$B;else if("boolean"==typeof p$B)p$S[p$g]=p$B,p$$.data[p$g]=p$B;else if(p$B instanceof laya.d3.math.Vector2){var p$r=p$S[p$g]||(p$S[p$g]=new p$Pq);p$B.cloneTo(p$r),p$$.data[p$g]=p$r.elements}else if(p$B instanceof laya.d3.math.Vector3){var p$Y=p$S[p$g]||(p$S[p$g]=new p$Sq);p$B.cloneTo(p$Y),p$$.data[p$g]=p$Y.elements}else if(p$B instanceof laya.d3.math.Vector4){var p$C=p$S[p$g]||(p$S[p$g]=new p$Bq);p$B.cloneTo(p$C),p$$.data[p$g]=p$C.elements}else if(p$B instanceof laya.d3.math.Matrix4x4){var p$U=p$S[p$g]||(p$S[p$g]=new p$hq);p$B.cloneTo(p$U),p$$.data[p$g]=p$U.elements}else p$B instanceof laya.d3.resource.BaseTexture&&(p$S[p$g]=p$B,p$$.data[p$g]=p$B)}},p$q.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$L(0,p$q,"alphaTestValue",function(){return this._getNumber(0)},function(p$h){this._setNumber(0,p$h)}),p$L(0,p$q,"alphaTest",function(){return this._alphaTest},function(p$h){(this._alphaTest=p$h)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),p$h.__init__=function(){p$h.SHADERDEFINE_ALPHATEST=p$h.shaderDefines.registerDefine("ALPHATEST")},p$h.RENDERQUEUE_OPAQUE=2e3,p$h.RENDERQUEUE_ALPHATEST=2450,p$h.RENDERQUEUE_TRANSPARENT=3e3,p$h.CULL_NONE=0,p$h.CULL_FRONT=1,p$h.CULL_BACK=2,p$h.BLEND_DISABLE=0,p$h.BLEND_ENABLE_ALL=1,p$h.BLEND_ENABLE_SEPERATE=2,p$h.BLENDPARAM_ZERO=0,p$h.BLENDPARAM_ONE=1,p$h.BLENDPARAM_SRC_COLOR=768,p$h.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,p$h.BLENDPARAM_DST_COLOR=774,p$h.BLENDPARAM_ONE_MINUS_DST_COLOR=775,p$h.BLENDPARAM_SRC_ALPHA=770,p$h.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,p$h.BLENDPARAM_DST_ALPHA=772,p$h.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,p$h.BLENDPARAM_SRC_ALPHA_SATURATE=776,p$h.BLENDEQUATION_ADD=0,p$h.BLENDEQUATION_SUBTRACT=1,p$h.BLENDEQUATION_REVERSE_SUBTRACT=2,p$h.DEPTHTEST_OFF=0,p$h.DEPTHTEST_NEVER=512,p$h.DEPTHTEST_LESS=513,p$h.DEPTHTEST_EQUAL=514,p$h.DEPTHTEST_LEQUAL=515,p$h.DEPTHTEST_GREATER=516,p$h.DEPTHTEST_NOTEQUAL=517,p$h.DEPTHTEST_GEQUAL=518,p$h.DEPTHTEST_ALWAYS=519,p$h.SHADERDEFINE_ALPHATEST=1,p$h.ALPHATESTVALUE=0,p$U(p$h,["shaderDefines",function(){return this.shaderDefines=new p$Cq}]),p$h}(p$l),p$dq=function(p$h){function p$q(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,p$q.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}p$v(p$q,"laya.d3.resource.BaseTexture",p$l);var p$f=p$q.prototype;return p$L(0,p$f,"width",function(){return this._width}),p$L(0,p$f,"repeat",function(){return this._repeat},function(p$h){if(this._repeat!==p$h&&(this._repeat=p$h,this._source)){var p$q=p$d.mainContext;p$b.bindTexture(p$q,this._type,this._source),p$m.isPOT(this._width,this._height)&&this._repeat?(p$q.texParameteri(this._type,10242,10497),p$q.texParameteri(this._type,10243,10497)):(p$q.texParameteri(this._type,10242,33071),p$q.texParameteri(this._type,10243,33071))}}),p$L(0,p$f,"height",function(){return this._height}),p$L(0,p$f,"magFifter",function(){return this._magFifter},function(p$h){(this._magFifter=p$h)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(p$h)}),p$L(0,p$f,"wrapModeV",function(){return this._wrapModeV}),p$L(0,p$f,"size",function(){return this._size}),p$L(0,p$f,"wrapModeU",function(){return this._wrapModeU}),p$L(0,p$f,"mipmap",function(){return this._mipmap},function(p$h){this._mipmap=p$h,this._mipmap!=p$h&&this._conchTexture&&this._conchTexture.setMipMap(p$h)}),p$L(0,p$f,"minFifter",function(){return this._minFifter},function(p$h){this._minFifter=p$h,this._minFifter!=p$h&&this._conchTexture&&this._conchTexture.setMinFifter(p$h)}),p$L(0,p$f,"format",function(){return this._format}),p$L(0,p$f,"source",function(){return this.activeResource(),this._source}),p$L(0,p$f,"defaulteTexture",function(){return p$sq.grayTexture}),p$q.WARPMODE_REPEAT=0,p$q.WARPMODE_CLAMP=1,p$q}(),p$bq=function(p$h){function p$q(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,p$q.__super.call(this),this._boundingBoxCorners=p$g(8,null)}p$v(p$q,"laya.d3.resource.models.BaseMesh",p$l);var p$f=p$q.prototype;return p$f._getPositions=function(){throw new Error("未Override,请重载该属性！")},p$f._generateBoundingObject=function(){this._boundingSphere=new p$jh(new p$Sq,0),p$jh.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new p$oh(new p$Sq,new p$Sq),p$oh.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},p$f.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},p$f.getRenderElement=function(p$h){throw new Error("未Override,请重载该属性！")},p$L(0,p$f,"subMeshCount",function(){return this._subMeshCount}),p$L(0,p$f,"boundingBox",function(){return this._boundingBox}),p$L(0,p$f,"boundingBoxCorners",function(){return this._boundingBoxCorners}),p$L(0,p$f,"boundingSphere",function(){return this._boundingSphere}),p$q}(),p$iq=(function(p$h){function p$q(){p$q.__super.call(this)}p$v(p$q,"laya.d3.component.Script",p$Gq);var p$f=p$q.prototype;p$f.onTriggerEnter=function(p$h){},p$f.onTriggerExit=function(p$h){},p$f.onTriggerStay=function(p$h){},p$L(0,p$f,"isSingleton",function(){return p$q._isSingleton}),p$q._isSingleton=!1}(),function(p$h){function p$q(p$h){this._owner=null,this._sharedMesh=null,p$q.__super.call(this),this._owner=p$h}p$v(p$q,"laya.d3.core.MeshFilter",p$h);var p$f=p$q.prototype;return p$f._sharedMeshLoaded=function(){this.event("loaded")},p$f._destroy=function(){p$h.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},p$L(0,p$f,"sharedMesh",function(){return this._sharedMesh},function(p$h){var p$q=this._sharedMesh;p$q&&p$q._removeReference(),(this._sharedMesh=p$h)._addReference(),this.event("meshchanged",[this,p$q,p$h]),p$h.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),p$L(0,p$f,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),p$L(0,p$f,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),p$L(0,p$f,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),p$L(0,p$f,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),p$q}(p$mq)),p$zq=function(p$h){function p$q(p$h){p$q.__super.call(this,p$h),p$h.meshFilter.on("meshchanged",this,this._onMeshChanged)}p$v(p$q,"laya.d3.core.MeshRender",p$Eq);var p$f=p$q.prototype;return p$f._onMeshChanged=function(p$h,p$q,p$f){p$f.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:p$f.once("loaded",this,this._onMeshLoaed)},p$f._onMeshLoaed=function(p$h,p$q){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},p$f._calculateBoundingSphereByInitSphere=function(p$h){var p$q=NaN,p$f=this._owner.transform,p$g=p$f.scale.elements,p$$=Math.abs(p$g[0]),p$P=Math.abs(p$g[1]),p$S=Math.abs(p$g[2]);p$q=p$P<=p$$&&p$S<=p$$?p$$:p$S<=p$P?p$P:p$S,p$Sq.transformCoordinate(p$h.center,p$f.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=p$h.radius*p$q},p$f._calculateBoundBoxByInitCorners=function(p$h){for(var p$q=this._owner.transform.worldMatrix,p$f=0;p$f<8;p$f++)p$Sq.transformCoordinate(p$h[p$f],p$q,p$Eq._tempBoundBoxCorners[p$f]);p$oh.createfromPoints(p$Eq._tempBoundBoxCorners,this._boundingBox)},p$f._calculateBoundingSphere=function(){var p$h=this._owner.meshFilter.sharedMesh;null==p$h||null==p$h.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(p$h.boundingSphere)},p$f._calculateBoundingBox=function(){var p$h=this._owner.meshFilter.sharedMesh;null==p$h||null==p$h.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(p$h.boundingBoxCorners)},p$f._renderUpdate=function(p$h){var p$q=this._owner.transform;if(p$q){this._setShaderValueMatrix4x4(0,p$q.worldMatrix);var p$f=this._owner.getProjectionViewWorldMatrix(p$h);this._setShaderValueMatrix4x4(1,p$f)}else this._setShaderValueMatrix4x4(0,p$hq.DEFAULT),this._setShaderValueMatrix4x4(1,p$h);return p$_q.debugMode&&this._renderRenderableBoundBox(),!0},p$q}(),p$cq=function(p$q){function p$g(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,p$g.__super.call(this),this._renderState=new p$Q,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new p$uq,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new p$qh,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new p$Sq(.7,.7,.7),this.ambientColor=new p$Sq(.212,.227,.259),p$d.shaderHighPrecision&&this.addShaderDefine(p$Xq.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}p$v(p$g,"laya.d3.core.scene.Scene",p$q);var p$h=p$g.prototype;return p$E.imps(p$h,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),p$h._setUrl=function(p$h){this._url=p$h},p$h._getGroup=function(){return this._group},p$h._setGroup=function(p$h){this._group=p$h},p$h._display=function(){p$E.stage._scenes.push(this),p$E.stage._scenes.sort(p$g._sortScenes);for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++){var p$f=this._childs[p$h];p$f.active&&p$f._activeHierarchy()}},p$h._unDisplay=function(){var p$h=p$E.stage._scenes;p$h.splice(p$h.indexOf(this),1);for(var p$q=0,p$f=this._childs.length;p$q<p$f;p$q++){var p$g=this._childs[p$q];p$g.active&&p$g._inActiveHierarchy()}},p$h._addChild3D=function(p$h){p$h.transform._onWorldTransform(),p$h._setBelongScene(this),this.displayedInStage&&p$h.active&&p$h._activeHierarchy()},p$h._removeChild3D=function(p$h){p$h.transform.parent=null,this.displayedInStage&&p$h.active&&p$h._inActiveHierarchy(),p$h._setUnBelongScene()},p$h.initOctree=function(p$h,p$q,p$f,p$g,p$$){void 0===p$$&&(p$$=6),this.treeSize=new p$Sq(p$h,p$q,p$f),this.treeLevel=p$$,this.treeRoot=new p$o(this,0),this.treeRoot.init(p$g,this.treeSize)},p$h._prepareUpdateToRenderState=function(p$h,p$q){p$q.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,p$q.scene=this},p$h._prepareSceneToRender=function(p$h){var p$q=this._lights.length;if(0<p$q)for(var p$f=0,p$g=0;p$g<p$q&&!(this._lights[p$g]._prepareToScene(p$h)&&++p$f>=this._enableLightCount);p$g++);},p$h._updateChilds=function(p$h){for(var p$q=0,p$f=this._childs.length;p$q<p$f;++p$q)this._childs[p$q]._update(p$h)},p$h._preRenderScene=function(p$h,p$q,p$f){var p$g,p$$=p$q._viewMatrix,p$P=p$q._projectionMatrix,p$S=p$q._projectionViewMatrix,p$B=0,p$r=p$q.camera;for(p$r.useOcclusionCulling?this.treeRoot?p$fh.renderObjectCullingOctree(p$f,this,p$r,p$$,p$P,p$S):p$fh.renderObjectCulling(p$f,this,p$r,p$$,p$P,p$S):p$fh.renderObjectCullingNoBoundFrustum(this,p$r,p$$,p$P,p$S),p$B=0,p$g=this._quenes.length;p$B<p$g;p$B++)this._quenes[p$B]&&this._quenes[p$B]._preRender(p$q)},p$h._clear=function(p$h,p$q){var p$f=p$q._viewport,p$g=p$q.camera,p$$=p$f.x,p$P=p$g.renderTargetSize.height-p$f.y-p$f.height,p$S=p$f.width,p$B=p$f.height;p$h.viewport(p$$,p$P,p$S,p$B);var p$r=256,p$Y=p$g.renderTarget;switch(p$g.clearFlag){case 0:var p$C=p$g.clearColor;if(p$C){p$h.enable(3089),p$h.scissor(p$$,p$P,p$S,p$B);var p$U=p$C.elements;p$h.clearColor(p$U[0],p$U[1],p$U[2],p$U[3]),p$r|=16384}if(p$Y)switch(p$C||(p$r=16384),p$Y.depthStencilFormat){case 33189:p$r|=256;break;case 36168:p$r|=1024;break;case 34041:p$r|=256,p$r|=1024}p$h.clear(p$r),p$C&&p$h.disable(3089);break;case 1:case 2:if(p$Y)switch(p$r=16384,p$Y.depthStencilFormat){case 33189:p$r|=256;break;case 36168:p$r|=1024;break;case 34041:p$r|=256,p$r|=1024}p$h.clear(p$r);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},p$h._renderScene=function(p$h,p$q){var p$f,p$g,p$$=p$q.camera,p$P=0;for(p$P=0;p$P<2;p$P++)(p$g=this._quenes[p$P])&&(p$$.renderTarget?p$g._render(p$q,!0):p$g._render(p$q,!1));if(1===p$$.clearFlag){var p$S=p$$.sky;p$S&&(p$b.setCullFace(p$h,!1),p$b.setDepthFunc(p$h,515),p$b.setDepthMask(p$h,!1),p$S._render(p$q),p$b.setDepthFunc(p$h,513),p$b.setDepthMask(p$h,!0))}for(p$P=2,p$f=this._quenes.length;p$P<p$f;p$P++)(p$g=this._quenes[p$P])&&(p$g._sortAlpha(p$q.camera.transform.position),p$$.renderTarget?p$g._render(p$q,!0):p$g._render(p$q,!1))},p$h._set3DRenderConfig=function(p$h){p$h.disable(3042),p$b._blend=!1,p$h.blendFunc(770,771),p$b._sFactor=770,p$b._dFactor=771,p$h.disable(2929),p$b._depthTest=!1,p$h.enable(2884),p$b._cullFace=!0,p$h.depthMask(1),p$b._depthMask=!0,p$h.frontFace(2304),p$b._frontFace=2304},p$h._set2DRenderConfig=function(p$h){p$b.setBlend(p$h,!0),p$b.setBlendFunc(p$h,1,771),p$b.setDepthTest(p$h,!1),p$b.setCullFace(p$h,!1),p$b.setDepthMask(p$h,!0),p$b.setFrontFace(p$h,2305),p$h.viewport(0,0,p$C.width,p$C.height)},p$h._parseCustomProps=function(p$h,p$q,p$f,p$g){var p$$=p$g.customProps.lightmaps,p$P=p$$.length,p$S=this._lightmaps;p$S.length=p$P;for(var p$B=0;p$B<p$P;p$B++)p$S[p$B]=p$_.getRes(p$q[p$$[p$B].replace(".exr",".png")]);this.setlightmaps(p$S);var p$r=p$g.customProps.ambientColor;p$r&&(this.ambientColor=new p$Sq(p$r[0],p$r[1],p$r[2]));var p$Y=p$g.customProps.fogColor;p$Y&&(this.fogColor=new p$Sq(p$Y[0],p$Y[1],p$Y[2]))},p$h._addLight=function(p$h){this._lights.indexOf(p$h)<0&&this._lights.push(p$h)},p$h._removeLight=function(p$h){var p$q=this._lights.indexOf(p$h);0<=p$q&&this._lights.splice(p$q,1)},p$h._updateScene=function(){var p$h=this._renderState;this._prepareUpdateToRenderState(p$d.mainContext,p$h),this._updateComponents(p$h),this._updateChilds(p$h),this._lateUpdateComponents(p$h),this._time+=p$h.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},p$h._updateSceneConch=function(){var p$h=this._renderState;this._prepareUpdateToRenderState(p$d.mainContext,p$h),this._updateComponents(p$h),this._lateUpdateComponents(p$h),this._prepareSceneToRender(p$h);for(var p$q=0,p$f=this._cameraPool.length;p$q<p$f;p$q++){var p$g=this._cameraPool[p$q];(p$h.camera=p$g)._prepareCameraToRender()}},p$h._preRenderShadow=function(p$h,p$q,p$f,p$g,p$$){this.treeRoot?p$fh.renderShadowObjectCullingOctree(this,p$q,p$f,p$g,p$$):p$fh.renderShadowObjectCulling(this,p$q,p$f,p$g,p$$);for(var p$P=0,p$S=p$f.length;p$P<p$S;p$P++)p$f[p$P]&&p$f[p$P]._preRender(p$h)},p$h._renderShadowMap=function(p$h,p$q,p$f){var p$g=this.parallelSplitShadowMaps[0];p$g._calcAllLightCameraInfo(p$f);var p$$,p$P,p$S,p$B=p$g.PSSMNum;if(this._preRenderShadow(p$q,p$g._lightCulling,p$g._shadowQuenes,p$g._lightVPMatrix[0],p$B),this.addShaderDefine(p$vq.SHADERDEFINE_CAST_SHADOW),1<p$B)for(var p$r=0;p$r<p$B;p$r++)p$$=p$g.getRenderTarget(p$r+1),p$g.beginRenderTarget(p$r+1),p$h.clearColor(1,1,1,1),p$h.clear(16640),p$h.viewport(0,0,p$$.width,p$$.height),p$q.camera=p$S=p$g.getLightCamera(p$r),p$S._prepareCameraToRender(),p$S._prepareCameraViewProject(p$S.viewMatrix,p$S.projectionMatrix),p$q._projectionViewMatrix=p$g._lightVPMatrix[p$r+1],(p$P=p$g._shadowQuenes[p$r])._preRender(p$q),p$P._renderShadow(p$q,!1),p$g.endRenderTarget(p$r+1);else p$$=p$g.getRenderTarget(1),p$g.beginRenderTarget(1),p$h.clearColor(1,1,1,1),p$h.clear(16640),p$h.viewport(0,0,p$$.width,p$$.height),p$q.camera=p$S=p$g.getLightCamera(0),p$S._prepareCameraToRender(),p$S._prepareCameraViewProject(p$S.viewMatrix,p$S.projectionMatrix),p$q._projectionViewMatrix=p$g._lightVPMatrix[0],(p$P=p$g._shadowQuenes[0])._preRender(p$q),p$P._renderShadow(p$q,!0),p$g.endRenderTarget(1);this.removeShaderDefine(p$vq.SHADERDEFINE_CAST_SHADOW)},p$h.addTreeNode=function(p$h){this.treeRoot.addTreeNode(p$h)},p$h.removeTreeNode=function(p$h){this.treeSize&&p$h._treeNode&&p$h._treeNode.removeObject(p$h)},p$h.setlightmaps=function(p$h){this._lightmaps=p$h;for(var p$q=0,p$f=this._renderableSprite3Ds.length;p$q<p$f;p$q++)this._renderableSprite3Ds[p$q]._render._applyLightMapParams()},p$h.getlightmaps=function(){return this._lightmaps},p$h.addChildAt=function(p$h,p$q){if(!(p$h instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(p$h&&p$h.__className));if(!p$h||this.destroyed||p$h===this)return p$h;if(p$h.zOrder&&this._set$P("hasZorder",!0),0<=p$q&&p$q<=this._childs.length){if(p$h._parent===this){var p$f=this.getChildIndex(p$h);this._childs.splice(p$f,1),this._childs.splice(p$q,0,p$h),this.conchModel&&(this.conchModel.removeChild(p$h.conchModel),this.conchModel.addChildAt(p$h.conchModel,p$q)),this._childChanged()}else p$h.parent&&p$h.parent.removeChild(p$h),this._childs===p$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(p$q,0,p$h),this.conchModel&&this.conchModel.addChildAt(p$h.conchModel,p$q),(p$h.parent=this)._addChild3D(p$h);return p$h}throw new Error("appendChildAt:The index is out of bounds")},p$h.addChild=function(p$h){if(!(p$h instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!p$h||this.destroyed||p$h===this)return p$h;if(p$h.zOrder&&this._set$P("hasZorder",!0),p$h._parent===this){var p$q=this.getChildIndex(p$h);p$q!==this._childs.length-1&&(this._childs.splice(p$q,1),this._childs.push(p$h),this.conchModel&&(this.conchModel.removeChild(p$h.conchModel),this.conchModel.addChildAt(p$h.conchModel,this._childs.length-1)),this._childChanged())}else p$h.parent&&p$h.parent.removeChild(p$h),this._childs===p$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(p$h),this.conchModel&&this.conchModel.addChildAt(p$h.conchModel,this._childs.length-1),(p$h.parent=this)._childChanged(),this._addChild3D(p$h);return p$h},p$h.removeChildAt=function(p$h){var p$q=this.getChildAt(p$h);return p$q&&(this._removeChild3D(p$q),this._childs.splice(p$h,1),this.conchModel&&this.conchModel.removeChild(p$q.conchModel),p$q.parent=null),p$q},p$h.removeChildren=function(p$h,p$q){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=2147483647),this._childs&&0<this._childs.length){var p$f=this._childs;if(0===p$h&&p$P<=p$q){var p$g=p$f;this._childs=p$Y.ARRAY_EMPTY}else p$g=p$f.splice(p$h,p$q-p$h);for(var p$$=0,p$P=p$g.length;p$$<p$P;p$$++)this._removeChild3D(p$g[p$$]),p$g[p$$].parent=null,this.conchModel&&this.conchModel.removeChild(p$g[p$$].conchModel)}return this},p$h.addFrustumCullingObject=function(p$h){this.treeRoot?this.addTreeNode(p$h):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(p$h):this._cullingRenders[this._cullingRendersLength]=p$h,p$h._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},p$h.removeFrustumCullingObject=function(p$h){if(this.treeRoot)this.removeTreeNode(p$h);else{this._cullingRendersLength--;var p$q=p$h._indexInSceneFrustumCullingObjects;if(p$q!==this._cullingRendersLength){var p$f=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[p$q]=p$f)._indexInSceneFrustumCullingObjects=p$q,p$h._indexInSceneFrustumCullingObjects=-1}}},p$h.getRenderQueue=function(p$h){return p$h<3e3?this._quenes[1]||(this._quenes[1]=new p$Z(this)):this._quenes[2]||(this._quenes[2]=new p$Z(this))},p$h.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new p$Z(this)},p$h.addShaderDefine=function(p$h){this._shaderDefineValue|=p$h},p$h.removeShaderDefine=function(p$h){this._shaderDefineValue&=~p$h},p$h.addScript=function(p$h){return this._addComponent(p$h)},p$h.getScriptByType=function(p$h,p$q){return void 0===p$q&&(p$q=0),this._getComponentByType(p$h,p$q)},p$h.getScriptsByType=function(p$h,p$q){this._getComponentsByType(p$h,p$q)},p$h.getScriptByIndex=function(p$h){return this._getComponentByIndex(p$h)},p$h.removeScriptByType=function(p$h,p$q){void 0===p$q&&(p$q=0),this._removeComponentByType(p$h,p$q)},p$h.removeScriptsByType=function(p$h){this._removeComponentByType(p$h)},p$h.removeAllScript=function(){this._removeAllComponent()},p$h.render=function(p$h,p$q,p$f){(p$e._context.ctx._renderKey=0)<this._childs.length&&p$h.addRenderObject(this)},p$h.renderSubmit=function(){var p$h=p$d.mainContext,p$q=this._renderState;this._set3DRenderConfig(p$h),this._prepareSceneToRender(this._renderState);var p$f,p$g=0,p$$=0;if(p$_q.debugMode||p$o.debugMode)for(p$g=0,p$$=this._cameraPool.length;p$g<p$$;p$g++)p$f=this._cameraPool[p$g],p$_q._debugPhasorSprite.begin(1,p$f),p$f.activeInHierarchy&&p$f._renderCamera(p$h,p$q,this),p$_q._debugPhasorSprite.end();else for(p$g=0,p$$=this._cameraPool.length;p$g<p$$;p$g++)(p$f=this._cameraPool[p$g]).activeInHierarchy&&p$f._renderCamera(p$h,p$q,this);return this._set2DRenderConfig(p$h),1},p$h.onAsynLoaded=function(p$h,p$q,p$f){var p$g=p$q[0];if("Scene"!==p$g.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var p$$=p$q[1];p$lq._createNodeByJson(this,p$g,this,p$$),this.event("hierarchyloaded",[this]),this.__loaded=!0},p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),this.destroyed||(p$q.prototype.destroy.call(this,p$h),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,p$_.clearRes(this.url),this.loaded||p$_q._cancelLoadByUrl(this.url))},p$h.getRenderType=function(){return 0},p$h.releaseRender=function(){},p$h._addComponent=function(p$h){var p$q,p$f=this._componentsMap.indexOf(p$h);if(-1===p$f)p$q=[],this._componentsMap.push(p$h),this._typeComponentsIndices.push(p$q);else if(p$q=this._typeComponentsIndices[p$f],this._components[p$q[0]].isSingleton)throw new Error("无法单实例创建"+p$h+"组件，"+p$h+"组件已存在！");var p$g=p$$.getInstance(p$h);p$q.push(this._components.length),this._components.push(p$g);return p$g._initialize(this),p$g},p$h._removeComponent=function(p$h,p$q){var p$f=this._typeComponentsIndices[p$h],p$g=p$f[p$q],p$$=this._components[p$g];this._components.splice(p$g,1),p$f.splice(p$q,1),0===p$f.length&&(this._typeComponentsIndices.splice(p$h,1),this._componentsMap.splice(p$h,1));for(var p$P=0,p$S=this._componentsMap.length;p$P<p$S;p$P++)for(var p$B=(p$f=this._typeComponentsIndices[p$P]).length-1;0<=p$B;p$B--){var p$r=p$f[p$B];if(!(p$g<p$r))break;p$f[p$B]=--p$r}p$$._destroy()},p$h._getComponentByType=function(p$h,p$q){void 0===p$q&&(p$q=0);var p$f=this._componentsMap.indexOf(p$h);return-1===p$f?null:this._components[this._typeComponentsIndices[p$f][p$q]]},p$h._getComponentsByType=function(p$h,p$q){var p$f=this._componentsMap.indexOf(p$h);if(-1!==p$f){var p$g=this._typeComponentsIndices[p$f],p$$=p$g.length;p$q.length=p$$;for(var p$P=0;p$P<p$$;p$P++)p$q[p$P]=this._components[p$g[p$P]]}else p$q.length=0},p$h._getComponentByIndex=function(p$h){return this._components[p$h]},p$h._removeComponentByType=function(p$h,p$q){void 0===p$q&&(p$q=0);var p$f=this._componentsMap.indexOf(p$h);-1!==p$f&&this._removeComponent(p$f,p$q)},p$h._removeComponentsByType=function(p$h){var p$q=this._componentsMap.indexOf(p$h);if(-1!==p$q)for(var p$f=this._typeComponentsIndices[p$q],p$g=0,p$$=p$f.length;p$g<p$$;p$f.length<p$$?p$$--:p$g++)this._removeComponent(p$q,p$g)},p$h._removeAllComponent=function(){for(var p$h=0,p$q=this._componentsMap.length;p$h<p$q;this._componentsMap.length<p$q?p$q--:p$h++)this._removeComponentsByType(this._componentsMap[p$h])},p$h._updateComponents=function(p$h){for(var p$q=0,p$f=this._components.length;p$q<p$f;p$q++){var p$g=this._components[p$q];!p$g.started&&(p$g._start(p$h),p$g.started=!0),p$g.enable&&p$g._update(p$h)}},p$h._lateUpdateComponents=function(p$h){for(var p$q=0;p$q<this._components.length;p$q++){var p$f=this._components[p$q];!p$f.started&&(p$f._start(p$h),p$f.started=!0),p$f.enable&&p$f._lateUpdate(p$h)}},p$h._preRenderUpdateComponents=function(p$h){for(var p$q=0;p$q<this._components.length;p$q++){var p$f=this._components[p$q];!p$f.started&&(p$f._start(p$h),p$f.started=!0),p$f.enable&&p$f._preRenderUpdate(p$h)}},p$h._postRenderUpdateComponents=function(p$h){for(var p$q=0;p$q<this._components.length;p$q++){var p$f=this._components[p$q];!p$f.started&&(p$f._start(p$h),p$f.started=!0),p$f.enable&&p$f._postRenderUpdate(p$h)}},p$L(0,p$h,"_loaded",null,function(p$h){this.__loaded=p$h}),p$L(0,p$h,"fogColor",function(){return this._fogColor},function(p$h){this._fogColor=p$h,this._shaderValues.setValue(0,p$h.elements)}),p$L(0,p$h,"enableFog",function(){return this._enableFog},function(p$h){this._enableFog!==p$h&&((this._enableFog=p$h)?(this.addShaderDefine(p$Xq.SHADERDEFINE_FOG),this.removeShaderDefine(p$Xq.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(p$Xq.SHADERDEFINE_FOG))}),p$L(0,p$h,"url",function(){return this._url}),p$L(0,p$h,"loaded",function(){return this.__loaded}),p$L(0,p$h,"enableDepthFog",function(){return this._enableDepthFog},function(p$h){this._enableDepthFog!=p$h&&((this._enableDepthFog=p$h)?(this.addShaderDefine(p$Xq.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(p$Xq.SHADERDEFINE_FOG)):this.removeShaderDefine(p$Xq.SAHDERDEFINE_DEPTHFOG))}),p$L(0,p$h,"fogStart",function(){return this._fogStart},function(p$h){this._fogStart=p$h,this._shaderValues.setValue(1,p$h)}),p$L(0,p$h,"fogRange",function(){return this._fogRange},function(p$h){this._fogRange=p$h,this._shaderValues.setValue(2,p$h)}),p$L(0,p$h,"ambientColor",function(){return this._ambientColor},function(p$h){this._ambientColor=p$h,this._shaderValues.setValue(21,p$h.elements)}),p$L(0,p$h,"scene",function(){return this}),p$L(0,p$h,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),p$g._sortScenes=function(p$h,p$q){if(p$h.parent!==p$E.stage||p$q.parent!==p$E.stage)return p$h.parent!==p$E.stage&&p$q.parent!==p$E.stage?p$g._sortScenes(p$h.parent,p$q.parent):p$h.parent===p$E.stage?-1:1;var p$f=p$E.stage._childs;return p$f.indexOf(p$h)-p$f.indexOf(p$q)},p$g.load=function(p$h){return p$E.loader.create(p$h,null,null,p$g)},p$g.FOGCOLOR=0,p$g.FOGSTART=1,p$g.FOGRANGE=2,p$g.LIGHTDIRECTION=3,p$g.LIGHTDIRCOLOR=4,p$g.POINTLIGHTPOS=5,p$g.POINTLIGHTRANGE=6,p$g.POINTLIGHTATTENUATION=7,p$g.POINTLIGHTCOLOR=8,p$g.SPOTLIGHTPOS=9,p$g.SPOTLIGHTDIRECTION=10,p$g.SPOTLIGHTSPOT=11,p$g.SPOTLIGHTRANGE=12,p$g.SPOTLIGHTATTENUATION=13,p$g.SPOTLIGHTCOLOR=14,p$g.SHADOWDISTANCE=15,p$g.SHADOWLIGHTVIEWPROJECT=16,p$g.SHADOWMAPPCFOFFSET=17,p$g.SHADOWMAPTEXTURE1=18,p$g.SHADOWMAPTEXTURE2=19,p$g.SHADOWMAPTEXTURE3=20,p$g.AMBIENTCOLOR=21,p$g.TIME=22,p$g}(p$t),p$Mq=function(p$h){function p$q(p$h){p$q.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new p$hq,this._shaderValues=new p$uq,this._colliders=[],this._id=++p$q._uniqueIDCounter,this._transform=new p$Rq(this),this.name=p$h||"Sprite3D-"+p$q._nameNumberCounter++,this.layer=p$z.currentCreationLayer,this.active=!0}p$v(p$q,"laya.d3.core.Sprite3D",p$pq);var p$f=p$q.prototype;return p$E.imps(p$f,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),p$f._setUrl=function(p$h){this._url=p$h},p$f._getGroup=function(){return this._group},p$f._setGroup=function(p$h){this._group=p$h},p$f._addChild3D=function(p$h){p$h.transform.parent=this.transform,this._hierarchyAnimator&&(!p$h._hierarchyAnimator&&p$h._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(p$h,!0,[p$h.name])),this._scene&&(p$h._setBelongScene(this._scene),this._activeInHierarchy&&p$h._active&&p$h._activeHierarchy())},p$f._removeChild3D=function(p$h){p$h.transform.parent=null,this._scene&&(this._activeInHierarchy&&p$h._active&&p$h._inActiveHierarchy(),p$h._setUnBelongScene()),this._hierarchyAnimator&&(p$h._hierarchyAnimator==this._hierarchyAnimator&&p$h._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(p$h,!1,[p$h.name]))},p$f._parseBaseCustomProps=function(p$h){var p$q=this.transform.localPosition;p$h.translate?(p$q.fromArray(p$h.translate),p$q.x*=100,p$q.y*=100,p$q.z*=100):p$q.elements.fill(0),this.transform.localPosition=p$q;var p$f=this.transform.localRotation;p$h.rotation?p$f.fromArray(p$h.rotation):p$f.fromArray([0,0,0,-1]),this.transform.localRotation=p$f;var p$g=this.transform.localScale;p$h.scale?p$g.fromArray(p$h.scale):p$g.elements.fill(1),this.transform.localScale=p$g;var p$$=p$h.layer;null!=p$$&&(this.layer=p$z.getLayerByNumber(p$$))},p$f._parseCustomComponent=function(p$h,p$q,p$f){for(var p$g in p$f){var p$$=p$f[p$g];switch(p$g){case"Animator":var p$P=this.addComponent(Animator);if(p$$.avatarPath)p$P.avatar=p$_.getRes(p$q[p$$.avatarPath]);else{var p$S=p$$.avatar;if(p$S){p$P.avatar=p$_.getRes(p$q[p$S.path]);var p$B=p$S.linkSprites;p$B&&p$h.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[p$P,p$B])}}for(var p$r=p$$.clipPaths,p$Y=p$r.length,p$C=0;p$C<p$Y;p$C++)p$P.addClip(p$_.getRes(p$q[p$r[p$C]]));p$P.clip=p$_.getRes(p$q[p$r[0]]);var p$U=p$$.playOnWake;void 0!==p$U&&(p$P.playOnWake=p$U);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var p$u=this.addComponent(SphereCollider);p$u.isTrigger=p$$.isTrigger;var p$v=p$u.center;p$v.fromArray(p$$.center),p$u.center=p$v,p$u.radius=p$$.radius;break;case"BoxCollider":var p$L=this.addComponent(BoxCollider);p$L.isTrigger=p$$.isTrigger,p$L.center.fromArray(p$$.center);var p$e=p$L.size;p$e.fromArray(p$$.size),p$L.size=p$e;break;case"MeshCollider":this.addComponent(MeshCollider)}}},p$f._onRootNodeHierarchyLoaded=function(p$h,p$q){for(var p$f in p$q){for(var p$g=this,p$$=p$q[p$f],p$P=0,p$S=p$$.length;p$P<p$S;p$P++){var p$B=p$$[p$P];if(""===p$B)break;if(!(p$g=p$g.getChildByName(p$B)))break}p$g&&p$h.linkSprite3DToAvatarNode(p$f,p$g)}},p$f._setHierarchyAnimator=function(p$h,p$q){this._changeHierarchyAnimator(p$h);for(var p$f=0,p$g=this._childs.length;p$f<p$g;p$f++){var p$$=this._childs[p$f];p$$._hierarchyAnimator==p$q&&p$$._setHierarchyAnimator(p$h,p$q)}},p$f._clearHierarchyAnimator=function(p$h,p$q){this._changeHierarchyAnimator(p$q);for(var p$f=0,p$g=this._childs.length;p$f<p$g;p$f++){var p$$=this._childs[p$f];p$$._hierarchyAnimator==p$h&&p$$._clearHierarchyAnimator(p$h,p$q)}},p$f._getAnimatorToLinkSprite3D=function(p$h,p$q,p$f){var p$g=this.getComponentByType(Animator);if(p$g&&(p$g.avatar?p$g.avatar._version||p$h._setAnimatorToLinkAvatar(p$g,p$q):p$h._setAnimatorToLinkSprite3DNoAvatar(p$g,p$q,p$f)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){p$f.unshift(this._parent.name);var p$$=this._parent;p$$._hierarchyAnimator&&p$$._getAnimatorToLinkSprite3D(p$h,p$q,p$f)}},p$f._setAnimatorToLinkSprite3DNoAvatar=function(p$h,p$q,p$f){var p$g=0,p$$=0;for(p$g=0,p$$=p$h.getClipCount();p$g<p$$;p$g++)p$h._handleSpriteOwnersBySprite(p$g,p$q,p$f,this);for(p$g=0,p$$=this._childs.length;p$g<p$$;p$g++){var p$P=this._childs[p$g],p$S=p$f.length;p$f.push(p$P.name),p$P._setAnimatorToLinkSprite3DNoAvatar(p$h,p$q,p$f),p$f.splice(p$S,1)}},p$f._changeHierarchyAnimator=function(p$h){this._hierarchyAnimator=p$h},p$f._isLinkSpriteToAnimationNode=function(p$h,p$q,p$f){var p$g=p$h._avatarNodes.indexOf(p$q),p$$=p$h._cacheSpriteToNodesMap;if(p$f)this._transform.dummy=p$q.transform,p$h._cacheNodesToSpriteMap[p$g]=p$$.length,p$$.push(p$g);else{this._transform.dummy=null;var p$P=p$h._cacheNodesToSpriteMap[p$g];p$h._cacheNodesToSpriteMap[p$g]=null,p$$.splice(p$P,1)}},p$f._setBelongScene=function(p$h){this._scene=p$h;for(var p$q=0,p$f=this._childs.length;p$q<p$f;p$q++)this._childs[p$q]._setBelongScene(p$h)},p$f._setUnBelongScene=function(){this._scene=null;for(var p$h=0,p$q=this._childs.length;p$h<p$q;p$h++)this._childs[p$h]._setUnBelongScene()},p$f._activeHierarchy=function(){var p$h=0,p$q=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),p$h=0,p$q=this._colliders.length;p$h<p$q;p$h++)this._layer._addCollider(this._colliders[p$h]);for(this.event("activeinhierarchychanged",!0),p$h=0,p$q=this._childs.length;p$h<p$q;p$h++){var p$f=this._childs[p$h];p$f._active&&p$f._activeHierarchy()}},p$f._inActiveHierarchy=function(){var p$h=0,p$q=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),p$h=0,p$q=this._colliders.length;p$h<p$q;p$h++){var p$f=this._colliders[p$h];p$f._clearCollsionMap(),this._layer._removeCollider(p$f)}for(this.event("activeinhierarchychanged",!1),p$h=0,p$q=this._childs.length;p$h<p$q;p$h++){var p$g=this._childs[p$h];p$g._active&&p$g._inActiveHierarchy()}},p$f.addComponent=function(p$h){var p$q,p$f=this._componentsMap.indexOf(p$h);if(-1===p$f)p$q=[],this._componentsMap.push(p$h),this._typeComponentsIndices.push(p$q);else if(p$q=this._typeComponentsIndices[p$f],this._components[p$q[0]].isSingleton)throw new Error("无法单实例创建"+p$h+"组件，"+p$h+"组件已存在！");var p$g=p$$.getInstance(p$h);return p$q.push(this._components.length),this._components.push(p$g),p$g instanceof laya.d3.component.Script&&this._scripts.push(p$g),p$g._initialize(this),p$g},p$f._removeComponent=function(p$h,p$q){var p$f,p$g=0,p$$=this._typeComponentsIndices[p$h],p$P=p$$[p$q],p$S=this._components[p$P];for(p$S instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(p$S),1),p$$.splice(p$q,1),0===p$$.length&&(this._typeComponentsIndices.splice(p$h,1),this._componentsMap.splice(p$h,1)),p$g=0,p$f=this._componentsMap.length;p$g<p$f;p$g++)for(var p$B=(p$$=this._typeComponentsIndices[p$g]).length-1;0<=p$B;p$B--){var p$r=p$$[p$B];if(!(p$P<p$r))break;p$$[p$B]=--p$r}p$S._destroy()},p$f._clearSelfRenderObjects=function(){},p$f._addSelfRenderObjects=function(){},p$f._parseCustomProps=function(p$h,p$q,p$f,p$g){},p$f._updateChilds=function(p$h){var p$q=this._childs.length;if(0!==p$q)for(var p$f=0;p$f<p$q;++p$f)this._childs[p$f]._update(p$h)},p$f._getSortID=function(p$h,p$q){return 1e3*p$q.id+p$h._getVertexBuffer().vertexDeclaration.id},p$f._update=function(p$h){(p$h.owner=this)._activeInHierarchy&&(this._updateComponents(p$h),this._lateUpdateComponents(p$h),p$X.spriteCount++,this._childs.length&&this._updateChilds(p$h))},p$f.getProjectionViewWorldMatrix=function(p$h){return p$hq.multiply(p$h,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},p$f.loadHierarchy=function(p$h){this.addChild(laya.d3.core.Sprite3D.load(p$h))},p$f.addChildAt=function(p$h,p$q){if(!(p$h instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!p$h||this.destroyed||p$h===this)return p$h;if(p$h.zOrder&&this._set$P("hasZorder",!0),0<=p$q&&p$q<=this._childs.length){if(p$h._parent===this){var p$f=this.getChildIndex(p$h);this._childs.splice(p$f,1),this._childs.splice(p$q,0,p$h),this.conchModel&&(this.conchModel.removeChild(p$h.conchModel),this.conchModel.addChildAt(p$h.conchModel,p$q)),this._childChanged()}else p$h.parent&&p$h.parent.removeChild(p$h),this._childs===p$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(p$q,0,p$h),this.conchModel&&this.conchModel.addChildAt(p$h.conchModel,p$q),(p$h.parent=this)._addChild3D(p$h);return p$h}throw new Error("appendChildAt:The index is out of bounds")},p$f.addChild=function(p$h){if(!(p$h instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!p$h||this.destroyed||p$h===this)return p$h;if(p$h.zOrder&&this._set$P("hasZorder",!0),p$h._parent===this){var p$q=this.getChildIndex(p$h);p$q!==this._childs.length-1&&(this._childs.splice(p$q,1),this._childs.push(p$h),this.conchModel&&(this.conchModel.removeChild(p$h.conchModel),this.conchModel.addChildAt(p$h.conchModel,this._childs.length-1)),this._childChanged())}else p$h.parent&&p$h.parent.removeChild(p$h),this._childs===p$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(p$h),this.conchModel&&this.conchModel.addChildAt(p$h.conchModel,this._childs.length-1),(p$h.parent=this)._childChanged(),this._addChild3D(p$h);return p$h},p$f.removeChildAt=function(p$h){var p$q=this.getChildAt(p$h);return p$q&&(this._removeChild3D(p$q),this._childs.splice(p$h,1),this.conchModel&&this.conchModel.removeChild(p$q.conchModel),p$q.parent=null),p$q},p$f.removeChildren=function(p$h,p$q){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=2147483647),this._childs&&0<this._childs.length){var p$f=this._childs;if(0===p$h&&p$P<=p$q){var p$g=p$f;this._childs=p$Y.ARRAY_EMPTY}else p$g=p$f.splice(p$h,p$q-p$h);for(var p$$=0,p$P=p$g.length;p$$<p$P;p$$++)this._removeChild3D(p$g[p$$]),p$g[p$$].parent=null,this.conchModel&&this.conchModel.removeChild(p$g[p$$].conchModel)}return this},p$f.onAsynLoaded=function(p$h,p$q,p$f){var p$g=p$q[0];if("Sprite3D"!==p$g.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var p$$=p$q[1];p$lq._createNodeByJson(this,p$g,this,p$$),this.event("hierarchyloaded",[this]),this.__loaded=!0},p$f.cloneTo=function(p$h){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var p$q=p$h;p$q.name=this.name,p$q._destroyed=this._destroyed,p$q.timer=this.timer,p$q._$P=this._$P,p$q.active=this._active;var p$f=p$q.transform.localPosition;this.transform.localPosition.cloneTo(p$f),p$q.transform.localPosition=p$f;var p$g=p$q.transform.localRotation;this.transform.localRotation.cloneTo(p$g),p$q.transform.localRotation=p$g;var p$$=p$q.transform.localScale;this.transform.localScale.cloneTo(p$$),p$q.transform.localScale=p$$,p$q.isStatic=this.isStatic;var p$P=0,p$S=0;for(p$P=0,p$S=this._componentsMap.length;p$P<p$S;p$P++){var p$B=p$q.addComponent(this._componentsMap[p$P]);this._components[p$P]._cloneTo(p$B)}for(p$P=0,p$S=this._childs.length;p$P<p$S;p$P++)p$q.addChild(this._childs[p$P].clone());var p$r=p$q.getComponentByType(Animator);if(p$r){var p$Y=p$r._linkSpritesData;if(p$Y)for(var p$C in p$Y){for(var p$U=p$Y[p$C],p$u=p$q,p$v=0,p$L=p$U.length;p$v<p$L&&(p$u=p$u.getChildByName(p$U[p$v]));p$v++);if(p$u){var p$e=p$r._avatarNodeMap[p$C];p$u._isLinkSpriteToAnimationNode(p$r,p$e,!0)}}}},p$f.clone=function(){var p$h=new this.constructor;return this.cloneTo(p$h),p$h},p$f.destroy=function(p$h){if(void 0===p$h&&(p$h=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,p$h);var p$q,p$f=0;for(p$f=0,p$q=this._components.length;p$f<p$q;p$f++)this._components[p$f]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,p$_.clearRes(this.url),this.loaded||p$_q._cancelLoadByUrl(this.url)}},p$f._handleSpriteToAvatar=function(p$h,p$q){p$h._avatarNodes;var p$f=p$h._avatarNodeMap[this.name];p$f&&p$f.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(p$h,p$f,p$q)},p$f._setAnimatorToLinkAvatar=function(p$h,p$q){this._handleSpriteToAvatar(p$h,p$q);for(var p$f=0,p$g=this._childs.length;p$f<p$g;p$f++){this._childs[p$f]._setAnimatorToLinkAvatar(p$h,p$q)}},p$L(0,p$f,"activeInHierarchy",function(){return this._activeInHierarchy}),p$L(0,p$f,"_loaded",null,function(p$h){this.__loaded=p$h}),p$L(0,p$f,"active",function(){return this._active},function(p$h){this._active!==p$h&&(this._active=p$h,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(p$h?this._activeHierarchy():this._inActiveHierarchy()))}),p$L(0,p$f,"componentsCount",function(){return this._components.length}),p$L(0,p$f,"loaded",function(){return this.__loaded}),p$L(0,p$f,"id",function(){return this._id}),p$L(0,p$f,"url",function(){return this._url}),p$L(0,p$f,"layer",function(){return this._layer},function(p$h){if(this._layer!==p$h){if(!p$h)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var p$q=0,p$f=this._colliders.length;if(this._layer)for(p$q=0;p$q<p$f;p$q++)this._layer._removeCollider(this._colliders[p$q]);for(p$q=0;p$q<p$f;p$q++)p$h._addCollider(this._colliders[p$q])}this._layer=p$h,this.event("layerchanged",p$h)}}),p$L(0,p$f,"scene",function(){return this._scene}),p$L(0,p$f,"transform",function(){return this._transform}),p$q.instantiate=function(p$h,p$q,p$f,p$g,p$$){void 0===p$f&&(p$f=!0);var p$P=p$h.clone();p$q&&p$q.addChild(p$P);var p$S=p$P.transform;if(p$f){var p$B=p$S.worldMatrix;p$h.transform.worldMatrix.cloneTo(p$B),p$S.worldMatrix=p$B}else p$g&&(p$S.position=p$g),p$$&&(p$S.rotation=p$$);return p$P},p$q.load=function(p$h){return p$E.loader.create(p$h,null,null,p$q)},p$q.WORLDMATRIX=0,p$q.MVPMATRIX=1,p$q._uniqueIDCounter=0,p$q._nameNumberCounter=0,p$q}(),p$Wq=function(p$h){function p$C(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],p$C.__super.call(this),!p$h||!p$q)throw"Shader Error";this._id=++p$C._count,this._vs=p$h,this._ps=p$q,this._attributeMap=p$f,this._sceneUniformMap=p$g,this._cameraUniformMap=p$$,this._spriteUniformMap=p$P,this._materialUniformMap=p$S,this._renderElementUniformMap=p$B,this._precompile=p$r,this._define=p$Y,this._precompile&&p$C.extCompileObj&&p$C.extCompileFunc?p$C.extCompileFunc.call(p$C.extCompileObj,p$h,p$q,p$Y):this.recreateResource()}p$v(p$C,"laya.d3.shader.Shader3D",p$f);var p$q=p$C.prototype;return p$q.recreateResource=function(){p$i.now();this._compile(),this.completeCreate(),this.memorySize=0},p$q.disposeResource=function(){p$d.mainContext.deleteShader(this._vshader),p$d.mainContext.deleteShader(this._pshader),p$d.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},p$q._compile=function(){if(!p$d.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var p$h=[this._vs,this._ps],p$q=p$d.mainContext;if(this._program=p$q.createProgram(),this._vshader=p$C._createShader(p$q,p$h[0],35633),this._pshader=p$C._createShader(p$q,p$h[1],35632),p$q.attachShader(this._program,this._vshader),p$q.attachShader(this._program,this._pshader),p$q.linkProgram(this._program),!p$e.isConchApp&&p$Xq.debugMode&&!p$q.getProgramParameter(this._program,35714))throw p$q.getProgramInfoLog(this._program);var p$f,p$g=0,p$$=0,p$P=0;for(p$P=p$e.isConchApp?p$q.getProgramParameterEx(this._vs,this._ps,"",35721):p$q.getProgramParameter(this._program,35721),p$g=0;p$g<p$P;p$g++){var p$S=null;p$f={vartype:"attribute",ivartype:0,attrib:p$S=p$e.isConchApp?p$q.getActiveAttribEx(this._vs,this._ps,"",p$g):p$q.getActiveAttrib(this._program,p$g),location:p$q.getAttribLocation(this._program,p$S.name),name:p$S.name,type:p$S.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(p$f)}var p$B=0;for(p$B=p$e.isConchApp?p$q.getProgramParameterEx(this._vs,this._ps,"",35718):p$q.getProgramParameter(this._program,35718),p$g=0;p$g<p$B;p$g++){var p$r=null;p$r=p$e.isConchApp?p$q.getActiveUniformEx(this._vs,this._ps,"",p$g):p$q.getActiveUniform(this._program,p$g),0<(p$f={vartype:"uniform",ivartype:1,attrib:p$S,location:p$q.getUniformLocation(this._program,p$r.name),name:p$r.name,type:p$r.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(p$f.name=p$f.name.substr(0,p$f.name.length-3),p$f.isArray=!0,p$f.location=p$q.getUniformLocation(this._program,p$f.name)),this._uniformParams.push(p$f)}for(p$g=0,p$$=this._attributeParams.length;p$g<p$$;p$g++)(p$f=this._attributeParams[p$g]).indexOfParams=p$g,p$f.index=1,p$f.value=[p$f.location,null],p$f.codename=p$f.name,p$f.name=null!=this._attributeMap[p$f.codename]?this._attributeMap[p$f.codename]:p$f.codename,this._attributeParamsMap.push(p$f.name),this._attributeParamsMap.push(p$f),p$f._this=this,p$f.uploadedValue=[],p$f.fun=this._attribute;for(p$g=0,p$$=this._uniformParams.length;p$g<p$$;p$g++)switch((p$f=this._uniformParams[p$g]).indexOfParams=p$g,p$f.index=1,p$f.value=[p$f.location,null],p$f.codename=p$f.name,null!=this._sceneUniformMap[p$f.codename]?(p$f.name=this._sceneUniformMap[p$f.codename],this._sceneUniformParamsMap.push(p$f.name),this._sceneUniformParamsMap.push(p$f)):null!=this._cameraUniformMap[p$f.codename]?(p$f.name=this._cameraUniformMap[p$f.codename],this._cameraUniformParamsMap.push(p$f.name),this._cameraUniformParamsMap.push(p$f)):null!=this._spriteUniformMap[p$f.codename]?(p$f.name=this._spriteUniformMap[p$f.codename],this._spriteUniformParamsMap.push(p$f.name),this._spriteUniformParamsMap.push(p$f)):null!=this._materialUniformMap[p$f.codename]?(p$f.name=this._materialUniformMap[p$f.codename],this._materialUniformParamsMap.push(p$f.name),this._materialUniformParamsMap.push(p$f)):null!=this._renderElementUniformMap[p$f.codename]?(p$f.name=this._renderElementUniformMap[p$f.codename],this._renderElementUniformParamsMap.push(p$f.name),this._renderElementUniformParamsMap.push(p$f)):console.log("Shader:can't find uinform name:"+p$f.codename+" in shader file."),p$f._this=this,p$f.uploadedValue=[],p$f.type){case 5124:p$f.fun=p$f.isArray?this._uniform1iv:this._uniform1i;break;case 5126:p$f.fun=p$f.isArray?this._uniform1fv:this._uniform1f;break;case 35664:p$f.fun=p$f.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:p$f.fun=p$f.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:p$f.fun=p$f.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:p$f.fun=this._uniform_sampler2D;break;case 35680:p$f.fun=this._uniform_samplerCube;break;case 35676:p$f.fun=this._uniformMatrix4fv;break;case 35670:p$f.fun=this._uniform1i;break;case 35674:p$f.fun=this._uinformMatrix2fv;break;case 35675:p$f.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},p$q._attribute=function(p$h,p$q){var p$f=p$d.mainContext,p$g=p$B._enableAtributes,p$$=p$h.location;return p$g[p$$]||p$f.enableVertexAttribArray(p$$),p$f.vertexAttribPointer(p$$,p$q[0],p$q[1],p$q[2],p$q[3],p$q[4]),p$g[p$$]=p$B._bindVertexBuffer,1},p$q._uniform1f=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q?(p$d.mainContext.uniform1f(p$h.location,p$f[0]=p$q),1):0},p$q._uniform1fv=function(p$h,p$q){if(p$q.length<4){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$d.mainContext.uniform1fv(p$h.location,p$q),p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3],1):0}return p$d.mainContext.uniform1fv(p$h.location,p$q),1},p$q._uniform_vec2=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]?(p$d.mainContext.uniform2f(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1]),1):0},p$q._uniform_vec2v=function(p$h,p$q){if(p$q.length<2){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$d.mainContext.uniform2fv(p$h.location,p$q),p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3],1):0}return p$d.mainContext.uniform2fv(p$h.location,p$q),1},p$q._uniform_vec3=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]?(p$d.mainContext.uniform3f(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2]),1):0},p$q._uniform_vec3v=function(p$h,p$q){return p$d.mainContext.uniform3fv(p$h.location,p$q),1},p$q._uniform_vec4=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$d.mainContext.uniform4f(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3]),1):0},p$q._uniform_vec4v=function(p$h,p$q){return p$d.mainContext.uniform4fv(p$h.location,p$q),1},p$q._uniformMatrix2fv=function(p$h,p$q){return p$d.mainContext.uniformMatrix2fv(p$h.location,!1,p$q),1},p$q._uniformMatrix3fv=function(p$h,p$q){return p$d.mainContext.uniformMatrix3fv(p$h.location,!1,p$q),1},p$q._uniformMatrix4fv=function(p$h,p$q){return p$d.mainContext.uniformMatrix4fv(p$h.location,!1,p$q),1},p$q._uinformMatrix2fv=function(p$h,p$q){return p$d.mainContext.uniformMatrix2fv(p$h.location,!1,p$q),1},p$q._uinformMatrix3fv=function(p$h,p$q){return p$d.mainContext.uniformMatrix3fv(p$h.location,!1,p$q),1},p$q._uniform1i=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q?(p$d.mainContext.uniform1i(p$h.location,p$f[0]=p$q),1):0},p$q._uniform1iv=function(p$h,p$q){return p$d.mainContext.uniform1iv(p$h.location,p$q),1},p$q._uniform_ivec2=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]?(p$d.mainContext.uniform2i(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1]),1):0},p$q._uniform_ivec2v=function(p$h,p$q){return p$d.mainContext.uniform2iv(p$h.location,p$q),1},p$q._uniform_vec3i=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]?(p$d.mainContext.uniform3i(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2]),1):0},p$q._uniform_vec3vi=function(p$h,p$q){return p$d.mainContext.uniform3iv(p$h.location,p$q),1},p$q._uniform_vec4i=function(p$h,p$q){var p$f=p$h.uploadedValue;return p$f[0]!==p$q[0]||p$f[1]!==p$q[1]||p$f[2]!==p$q[2]||p$f[3]!==p$q[3]?(p$d.mainContext.uniform4i(p$h.location,p$f[0]=p$q[0],p$f[1]=p$q[1],p$f[2]=p$q[2],p$f[3]=p$q[3]),1):0},p$q._uniform_vec4vi=function(p$h,p$q){return p$d.mainContext.uniform4iv(p$h.location,p$q),1},p$q._uniform_sampler2D=function(p$h,p$q){var p$f=p$q.source||p$q.defaulteTexture.source,p$g=p$d.mainContext,p$$=p$h.uploadedValue;if(null!=p$$[0])return p$g.activeTexture(p$C._TEXTURES[p$$[0]]),p$f&&p$b.bindTexture(p$g,3553,p$f),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return p$$[0]=this._curActTexIndex,p$g.uniform1i(p$h.location,this._curActTexIndex),p$g.activeTexture(p$C._TEXTURES[this._curActTexIndex]),p$f&&p$b.bindTexture(p$g,3553,p$f),this._curActTexIndex++,1},p$q._uniform_samplerCube=function(p$h,p$q){var p$f=p$q.source||p$q.defaulteTexture.source,p$g=p$d.mainContext,p$$=p$h.uploadedValue;if(null!=p$$[0])return p$g.activeTexture(p$C._TEXTURES[p$$[0]]),p$f?p$b.bindTexture(p$g,34067,p$f):p$b.bindTexture(p$g,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return p$$[0]=this._curActTexIndex,p$g.uniform1i(p$h.location,this._curActTexIndex),p$g.activeTexture(p$C._TEXTURES[this._curActTexIndex]),p$f?p$b.bindTexture(p$g,34067,p$f):p$b.bindTexture(p$g,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},p$q._noSetValue=function(p$h){console.log("no....:"+p$h.name)},p$q.bind=function(){return p$f.activeShader=this,(p$f.bindShader=this).activeResource(),p$b.UseProgram(this._program)},p$q.uploadAttributes=function(p$h,p$q){for(var p$f,p$g,p$$=0,p$P=0,p$S=this._attributeParamsMap.length;p$P<p$S;p$P+=2)p$g=this._attributeParamsMap[p$P+1],null!=(p$f=p$h[this._attributeParamsMap[p$P]])&&(p$q&&p$q[p$g.name]&&p$q[p$g.name].bind(),p$$+=p$g.fun.call(this,p$g,p$f));p$X.shaderCall+=p$$},p$q.uploadAttributesX=function(p$h,p$q){for(var p$f,p$g,p$$=0,p$P=0,p$S=this._attributeParamsMap.length;p$P<p$S;p$P+=2)p$g=this._attributeParamsMap[p$P+1],null!=(p$f=p$h[this._attributeParamsMap[p$P]])&&(p$q._bind(),p$$+=p$g.fun.call(this,p$g,p$f));p$X.shaderCall+=p$$},p$q.uploadSceneUniforms=function(p$h){for(var p$q,p$f,p$g=0,p$$=0,p$P=this._sceneUniformParamsMap.length;p$$<p$P;p$$+=2)p$f=this._sceneUniformParamsMap[p$$+1],null!=(p$q=p$h[this._sceneUniformParamsMap[p$$]])&&(p$g+=p$f.fun.call(this,p$f,p$q));p$X.shaderCall+=p$g},p$q.uploadCameraUniforms=function(p$h){for(var p$q,p$f,p$g=0,p$$=0,p$P=this._cameraUniformParamsMap.length;p$$<p$P;p$$+=2)p$f=this._cameraUniformParamsMap[p$$+1],null!=(p$q=p$h[this._cameraUniformParamsMap[p$$]])&&(p$g+=p$f.fun.call(this,p$f,p$q));p$X.shaderCall+=p$g},p$q.uploadSpriteUniforms=function(p$h){for(var p$q,p$f,p$g=0,p$$=0,p$P=this._spriteUniformParamsMap.length;p$$<p$P;p$$+=2)p$f=this._spriteUniformParamsMap[p$$+1],null!=(p$q=p$h[this._spriteUniformParamsMap[p$$]])&&(p$g+=p$f.fun.call(this,p$f,p$q));p$X.shaderCall+=p$g},p$q.uploadMaterialUniforms=function(p$h){for(var p$q,p$f,p$g=0,p$$=0,p$P=this._materialUniformParamsMap.length;p$$<p$P;p$$+=2)p$f=this._materialUniformParamsMap[p$$+1],null!=(p$q=p$h[this._materialUniformParamsMap[p$$]])&&(p$g+=p$f.fun.call(this,p$f,p$q));p$X.shaderCall+=p$g},p$q.uploadRenderElementUniforms=function(p$h){for(var p$q,p$f,p$g=0,p$$=0,p$P=this._renderElementUniformParamsMap.length;p$$<p$P;p$$+=2)p$f=this._renderElementUniformParamsMap[p$$+1],null!=(p$q=p$h[this._renderElementUniformParamsMap[p$$]])&&(p$g+=p$f.fun.call(this,p$f,p$q));p$X.shaderCall+=p$g},p$C.create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){return new p$C(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y)},p$C.addInclude=function(p$h,p$q){p$G.addInclude(p$h,p$q)},p$C._createShader=function(p$h,p$q,p$f){var p$g=p$h.createShader(p$f);if(p$h.shaderSource(p$g,p$q),p$h.compileShader(p$g),p$Xq.debugMode&&!p$h.getShaderParameter(p$g,35713))throw p$h.getShaderInfoLog(p$g);return p$g},p$C.PERIOD_RENDERELEMENT=0,p$C.PERIOD_MATERIAL=1,p$C.PERIOD_SPRITE=2,p$C.PERIOD_CAMERA=3,p$C.PERIOD_SCENE=4,p$C._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],p$C._count=0,p$C._preCompile=!1,p$C.extCompileFunc=null,p$C.extCompileObj=null,p$U(p$C,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new p$n}]),p$C}(),p$Tq=function(p$B){function p$r(){this._transformUV=null,p$r.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new p$Sq(.6,.6,.6)),this._setColor(10,new p$Sq(1,1,1)),this._setColor(11,new p$Bq(1,1,1,8)),this._setColor(12,new p$Sq(1,1,1)),this._setColor(7,new p$Bq(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new p$Bq(1,1,0,0)),this.renderMode=1}p$v(p$r,"laya.d3.core.material.StandardMaterial",p$B);var p$h=p$r.prototype;return p$h.disableLight=function(){this._addDisablePublicShaderDefine(p$Xq.SHADERDEFINE_POINTLIGHT|p$Xq.SHADERDEFINE_SPOTLIGHT|p$Xq.SHADERDEFINE_DIRECTIONLIGHT)},p$h.disableFog=function(){this._addDisablePublicShaderDefine(p$Xq.SHADERDEFINE_FOG)},p$h.onAsynLoaded=function(p$h,p$q,p$f){var p$g=p$q[0];if(p$g.version)p$B.prototype.onAsynLoaded.call(this,p$h,p$q,p$f);else{var p$$=p$q[1],p$P=p$g.props;for(var p$S in p$P)this[p$S]=p$P[p$S];p$r._parseStandardMaterial(p$$,this,p$g),this._endLoaded()}},p$h.cloneTo=function(p$h){p$B.prototype.cloneTo.call(this,p$h);var p$q=p$h;this._transformUV&&(p$q._transformUV=this._transformUV.clone())},p$L(0,p$h,"ambientColor",function(){return this._getColor(9)},function(p$h){this._setColor(9,p$h)}),p$L(0,p$h,"ambientTexture",function(){return this._getTexture(5)},function(p$h){p$h?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,p$h)}),p$L(0,p$h,"renderMode",null,function(p$h){switch(p$h){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(p$r.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(p$h)}),p$L(0,p$h,"reflectColor",function(){return this._getColor(12)},function(p$h){this._setColor(12,p$h)}),p$L(0,p$h,"tilingOffset",function(){return this._getColor(15)},function(p$h){if(p$h){var p$q=p$h.elements;1!=p$q[0]||1!=p$q[1]||0!=p$q[2]||0!=p$q[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,p$h)}),p$L(0,p$h,"albedo",function(){return this._getColor(7)},function(p$h){this._setColor(7,p$h)}),p$L(0,p$h,"diffuseColor",function(){return this._getColor(10)},function(p$h){this._setColor(10,p$h)}),p$L(0,p$h,"albedoColor",function(){return this._getColor(7)},function(p$h){this._setColor(7,p$h)}),p$L(0,p$h,"specularColor",function(){return this._getColor(11)},function(p$h){this._setColor(11,p$h)}),p$L(0,p$h,"diffuseTexture",function(){return this._getTexture(1)},function(p$h){p$h?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,p$h)}),p$L(0,p$h,"normalTexture",function(){return this._getTexture(2)},function(p$h){p$h?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,p$h)}),p$L(0,p$h,"specularTexture",function(){return this._getTexture(3)},function(p$h){p$h?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,p$h)}),p$L(0,p$h,"emissiveTexture",function(){return this._getTexture(4)},function(p$h){p$h?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,p$h)}),p$L(0,p$h,"reflectTexture",function(){return this._getTexture(6)},function(p$h){p$h?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,p$h)}),p$L(0,p$h,"transformUV",function(){return this._transformUV},function(p$h){this._transformUV=p$h,this._setMatrix4x4(13,p$h.matrix),p$h?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,p$h.matrix.elements,0)}),p$r.__init__=function(){p$r.SHADERDEFINE_DIFFUSEMAP=p$r.shaderDefines.registerDefine("DIFFUSEMAP"),p$r.SHADERDEFINE_NORMALMAP=p$r.shaderDefines.registerDefine("NORMALMAP"),p$r.SHADERDEFINE_SPECULARMAP=p$r.shaderDefines.registerDefine("SPECULARMAP"),p$r.SHADERDEFINE_EMISSIVEMAP=p$r.shaderDefines.registerDefine("EMISSIVEMAP"),p$r.SHADERDEFINE_AMBIENTMAP=p$r.shaderDefines.registerDefine("AMBIENTMAP"),p$r.SHADERDEFINE_REFLECTMAP=p$r.shaderDefines.registerDefine("REFLECTMAP"),p$r.SHADERDEFINE_UVTRANSFORM=p$r.shaderDefines.registerDefine("UVTRANSFORM"),p$r.SHADERDEFINE_TILINGOFFSET=p$r.shaderDefines.registerDefine("TILINGOFFSET"),p$r.SHADERDEFINE_ADDTIVEFOG=p$r.shaderDefines.registerDefine("ADDTIVEFOG")},p$r.load=function(p$h){return p$E.loader.create(p$h,null,null,p$r)},p$r._parseStandardMaterial=function(p$h,p$q,p$f){var p$g=p$f.customProps,p$$=p$g.ambientColor;p$q.ambientColor=new p$Sq(p$$[0],p$$[1],p$$[2]);var p$P=p$g.diffuseColor;p$q.diffuseColor=new p$Sq(p$P[0],p$P[1],p$P[2]);var p$S=p$g.specularColor;p$q.specularColor=new p$Bq(p$S[0],p$S[1],p$S[2],p$S[3]);var p$B=p$g.reflectColor;p$q.reflectColor=new p$Sq(p$B[0],p$B[1],p$B[2]);var p$r=p$g.albedoColor;p$r&&(p$q.albedo=new p$Bq(p$r[0],p$r[1],p$r[2],p$r[3]));var p$Y=p$g.diffuseTexture.texture2D;p$Y&&(p$q.diffuseTexture=p$_.getRes(p$h[p$Y]));var p$C=p$g.normalTexture.texture2D;p$C&&(p$q.normalTexture=p$_.getRes(p$h[p$C]));var p$U=p$g.specularTexture.texture2D;p$U&&(p$q.specularTexture=p$_.getRes(p$h[p$U]));var p$u=p$g.emissiveTexture.texture2D;p$u&&(p$q.emissiveTexture=p$_.getRes(p$h[p$u]));var p$v=p$g.ambientTexture.texture2D;p$v&&(p$q.ambientTexture=p$_.getRes(p$h[p$v]));var p$L=p$g.reflectTexture.texture2D;p$L&&(p$q.reflectTexture=p$_.getRes(p$h[p$L]))},p$r.RENDERMODE_OPAQUE=1,p$r.RENDERMODE_OPAQUEDOUBLEFACE=2,p$r.RENDERMODE_CUTOUT=3,p$r.RENDERMODE_CUTOUTDOUBLEFACE=4,p$r.RENDERMODE_TRANSPARENT=13,p$r.RENDERMODE_TRANSPARENTDOUBLEFACE=14,p$r.RENDERMODE_ADDTIVE=15,p$r.RENDERMODE_ADDTIVEDOUBLEFACE=16,p$r.RENDERMODE_DEPTHREAD_TRANSPARENT=5,p$r.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,p$r.RENDERMODE_DEPTHREAD_ADDTIVE=7,p$r.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,p$r.RENDERMODE_NONDEPTH_TRANSPARENT=9,p$r.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,p$r.RENDERMODE_NONDEPTH_ADDTIVE=11,p$r.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,p$r.SHADERDEFINE_DIFFUSEMAP=0,p$r.SHADERDEFINE_NORMALMAP=0,p$r.SHADERDEFINE_SPECULARMAP=0,p$r.SHADERDEFINE_EMISSIVEMAP=0,p$r.SHADERDEFINE_AMBIENTMAP=0,p$r.SHADERDEFINE_REFLECTMAP=0,p$r.SHADERDEFINE_UVTRANSFORM=0,p$r.SHADERDEFINE_TILINGOFFSET=0,p$r.SHADERDEFINE_ADDTIVEFOG=0,p$r.DIFFUSETEXTURE=1,p$r.NORMALTEXTURE=2,p$r.SPECULARTEXTURE=3,p$r.EMISSIVETEXTURE=4,p$r.AMBIENTTEXTURE=5,p$r.REFLECTTEXTURE=6,p$r.ALBEDO=7,p$r.UVANIAGE=8,p$r.MATERIALAMBIENT=9,p$r.MATERIALDIFFUSE=10,p$r.MATERIALSPECULAR=11,p$r.MATERIALREFLECT=12,p$r.UVMATRIX=13,p$r.UVAGE=14,p$r.TILINGOFFSET=15,p$U(p$r,["defaultMaterial",function(){var p$h=new p$r;return p$h.lock=!0,this.defaultMaterial=p$h},"shaderDefines",function(){return this.shaderDefines=new p$Cq(p$Aq.shaderDefines)}]),p$r}(p$Aq),p$Iq=function(p$h){function p$S(p$h,p$q,p$f,p$g,p$$){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===p$f&&(p$f=35044),void 0===p$g&&(p$g=!1),p$S.__super.call(this),this._indexType=p$h,this._indexCount=p$q,this._bufferUsage=p$f,this._bufferType=34963,this._canRead=p$g;var p$P;if("ushort"==p$h)this._indexTypeByteCount=2;else{if("ubyte"!=p$h)throw new Error("unidentification index type.");this._indexTypeByteCount=1}p$P=this._indexTypeByteCount*p$q,this._byteLength=p$P,this._bind(),p$B._gl.bufferData(this._bufferType,p$P,this._bufferUsage),this.uri=p$$,p$g?("ushort"==p$h?this._buffer=new Uint16Array(p$q):"ubyte"==p$h&&(this._buffer=new Uint8Array(p$q)),this.memorySize=2*p$P):this.memorySize=p$P}p$v(p$S,"laya.d3.graphics.IndexBuffer3D",p$h);var p$q=p$S.prototype;return p$q.setData=function(p$h,p$q,p$f,p$g){void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=4294967295);var p$$=0;if("ushort"==this._indexType?(p$$=2,0===p$f&&4294967295===p$g||(p$h=new Uint16Array(p$h.buffer,p$f*p$$,p$g))):"ubyte"==this._indexType&&(p$$=1,0===p$f&&4294967295===p$g||(p$h=new Uint8Array(p$h.buffer,p$f*p$$,p$g))),this._bind(),p$B._gl.bufferSubData(this._bufferType,p$q*p$$,p$h),this._canRead)if(0!==p$q||0!==p$f||4294967295!==p$g){var p$P=this._buffer.length-p$q;p$P<p$g&&(p$g=p$P);for(var p$S=0;p$S<p$g;p$S++)this._buffer[p$q+p$S]=p$h[p$S]}else this._buffer=p$h},p$q.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},p$q.disposeResource=function(){p$h.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},p$L(0,p$q,"indexType",function(){return this._indexType}),p$L(0,p$q,"indexTypeByteCount",function(){return this._indexTypeByteCount}),p$L(0,p$q,"indexCount",function(){return this._indexCount}),p$L(0,p$q,"canRead",function(){return this._canRead}),p$S.INDEXTYPE_UBYTE="ubyte",p$S.INDEXTYPE_USHORT="ushort",p$S.create=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$f&&(p$f=35044),void 0===p$g&&(p$g=!1),new p$S(p$h,p$q,p$f,p$g,p$$)},p$S}(p$B),p$wq=function(p$P){function p$S(p$h,p$q,p$f,p$g,p$$){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===p$g&&(p$g=!1),p$S.__super.call(this),this._vertexDeclaration=p$h,this._vertexCount=p$q,this._bufferUsage=p$f,this._bufferType=34962,this._canRead=p$g,this.uri=p$$,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*p$q,this._bind(),p$B._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),p$g&&(this._buffer=new Float32Array(this._byteLength/4))}p$v(p$S,"laya.d3.graphics.VertexBuffer3D",p$P);var p$h=p$S.prototype;return p$h.bindWithIndexBuffer=function(p$h){p$h&&p$h._bind(),this._bind()},p$h.setData=function(p$h,p$q,p$f,p$g){if(void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=4294967295),0===p$f&&4294967295===p$g||(p$h=new Float32Array(p$h.buffer,4*p$f,p$g)),this._bind(),p$B._gl.bufferSubData(this._bufferType,4*p$q,p$h),this._canRead)if(0!==p$q||0!==p$f||4294967295!==p$g){var p$$=this._buffer.length-p$q;p$$<p$g&&(p$g=p$$);for(var p$P=0;p$P<p$g;p$P++)this._buffer[p$q+p$P]=p$h[p$P]}else this._buffer=p$h},p$h.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},p$h.disposeResource=function(){for(var p$h=p$d.mainContext,p$q=this._vertexDeclaration.getVertexElements(),p$f=p$B._enableAtributes,p$g=0,p$$=p$q.length;p$g<p$$;p$g++)p$f[p$g]===this._glBuffer&&(p$h.disableVertexAttribArray(p$g),p$f[p$g]=null);p$P.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},p$L(0,p$h,"vertexDeclaration",function(){return this._vertexDeclaration}),p$L(0,p$h,"vertexCount",function(){return this._vertexCount}),p$L(0,p$h,"canRead",function(){return this._canRead}),p$S.create=function(p$h,p$q,p$f,p$g,p$$){return void 0===p$f&&(p$f=35044),void 0===p$g&&(p$g=!1),new p$S(p$h,p$q,p$f,p$g,p$$)},p$S}(p$B),p$kq=function(p$h){function p$G(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,p$G.__super.call(this),this._type=3553}p$v(p$G,"laya.d3.resource.DataTexture2D",p$dq);var p$q=p$G.prototype;return p$q.genDebugMipmaps=function(){var p$h=[];return p$h.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),p$h.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),p$h.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),p$h.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),p$h.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),p$h.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),p$h.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),p$h.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),p$h.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),p$h.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),p$h},p$q._onTextureLoaded=function(p$h){},p$q._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var p$h=p$d.mainContext,p$q=this._source=p$h.createTexture(),p$f=this._width,p$g=this._height,p$$=p$b.curBindTexTarget,p$P=p$b.curBindTexValue,p$S=!1;if(p$b.bindTexture(p$h,this._type,p$q),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var p$B=0;p$h.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var p$r=0;p$r<this._mipmaps.length;p$r++){if(this._mipmaps[p$r].byteLength!=p$Y*p$C*4)throw"mipmap size error  level:"+p$r;p$h.texSubImage2D(this._type,0,p$G.simLodRect[p$B++],p$G.simLodRect[p$B++],p$G.simLodRect[p$B++],p$G.simLodRect[p$B++],6408,5121,new Uint8Array(this._mipmaps[p$r]))}this.minFifter=9729,this.magFifter=9729}else{var p$Y=this._width,p$C=this._height;for(p$B=0,p$h.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),p$r=0;p$r<this._mipmaps.length;p$r++){if(this._mipmaps[p$r].byteLength!=p$Y*p$C*4)throw"mipmap size error  level:"+p$r;p$h.texImage2D(this._type,p$r,6408,p$Y,p$C,0,6408,5121,new Uint8Array(this._mipmaps[p$r])),(p$Y/=2)<1&&(p$Y=1),(p$C/=2)<1&&(p$C=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&p$h.pixelStorei(p$h.UNPACK_ALIGNMENT,1),p$h.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var p$U=0,p$u=!1,p$v=!1;this._buffer.byteLength==4*p$f*p$g?(p$U=6408,p$u=!0):this._buffer.byteLength==3*p$f*p$g?(p$U=6407,p$v=!0):p$U=this._format,p$u||p$v?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),p$v&&p$h.pixelStorei(p$h.UNPACK_ALIGNMENT,1),p$h.texImage2D(this._type,0,p$U,p$f,p$g,0,p$U,5121,this._buffer)):p$h&&p$U==p$h.ALPHA?(p$h.texImage2D(3553,0,p$U,p$f,p$g,0,p$U,p$h.UNSIGNED_BYTE,this._buffer),p$S=!0):0!=p$U&&(p$h.compressedTexImage2D(3553,0,p$U,p$f,p$g,0,this._buffer),p$S=!0)}var p$L=this._minFifter,p$e=this._magFifter,p$l=0==this._wrapModeU?10497:33071,p$_=0==this._wrapModeV?10497:33071,p$N=p$m.isPOT(p$f,p$g);p$N?(this._mipmap||this._mipmaps?-1!==p$L||(p$L=9987):-1!==p$L||(p$L=9729),-1!==p$e||(p$e=9729),p$h.texParameteri(this._type,10241,p$L),p$h.texParameteri(this._type,10240,p$e),p$h.texParameteri(this._type,10242,p$l),p$h.texParameteri(this._type,10243,p$_),this._mipmap&&p$h.generateMipmap(this._type)):(-1!==p$L||(p$L=9729),-1!==p$e||(p$e=9729),p$h.texParameteri(this._type,10241,p$L),p$h.texParameteri(this._type,10240,p$e),p$h.texParameteri(this._type,10242,33071),p$h.texParameteri(this._type,10243,33071)),p$$&&p$P&&p$b.bindTexture(p$h,p$$,p$P),this.memorySize=p$S?this._buffer.length:p$N?p$f*p$g*4*(1+1/3):p$f*p$g*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},p$q.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},p$q.onAsynLoaded=function(p$h,p$q,p$f){var p$g;p$f&&(p$g=p$f[0].call(this,p$q)),p$g&&(this._width=p$g.width,this._height=p$g.height,this._buffer=p$g.data),this._src=p$h,this._size=new p$eq(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},p$q.getPixels=function(){return new Uint8Array(this._buffer)},p$q.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(p$d.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},p$L(0,p$q,"src",function(){return this._src}),p$G.create=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){if(void 0===p$g&&(p$g=9729),void 0===p$$&&(p$$=9729),void 0===p$P&&(p$P=!0),!p$h||p$h.byteLength<p$q*p$f*4)throw"DataTexture2D create error";var p$B=new p$G;return p$B.uri=p$S,p$B._buffer=p$h,p$B._width=p$q,p$B._height=p$f,p$B._mipmap=p$P,p$B._magFifter=p$g,p$B._minFifter=p$$,p$B._size=new p$eq(p$B._width,p$B._height),p$B._conchTexture?alert("怎么给runtime传递datatexture数据"):p$B.activeResource(),p$B},p$G.load=function(p$h,p$q,p$f,p$g,p$$){if(void 0===p$q&&(p$q=0),void 0===p$f&&(p$f=0),void 0===p$g&&(p$g=9729),void 0===p$$&&(p$$=9729),"mipmaps"===p$J.getFileExtension(p$h)){var p$P=p$E.loader.create(p$h,null,null,p$G,[function(p$h){this._mipmaps=[];var p$q=new Uint32Array(p$h);this._width=p$q[0];var p$f=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,p$f=1024),this._width!=p$f)throw"现在只支持512x256的环境贴图。当前的是"+p$q[0];this._height=p$q[1];for(var p$g=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,p$$=this._height,p$P=8;;){var p$S=p$g*p$$*4;if(p$P+p$S>p$h.byteLength)throw"load mipmaps data size error ";var p$B=new Uint8Array(p$h,p$P,p$S);if(this._mipmaps.push(p$B),p$P+=p$S,1==p$g&&1==p$$)break;(p$g/=2)<1&&(p$g=1),(p$$/=2)<1&&(p$$=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){p$P.simLodInfo=new Float32Array(40);for(var p$S=0;p$S<p$P.simLodInfo.length;)p$P.simLodInfo[p$S]=(p$G.simLodRect[p$S]+.5)/1024,p$S++,p$P.simLodInfo[p$S]=(p$G.simLodRect[p$S]+.5)/256,p$S++,p$P.simLodInfo[p$S]=Math.max(p$G.simLodRect[p$S]-1,.1)/1024,p$S++,p$P.simLodInfo[p$S]=Math.max(p$G.simLodRect[p$S]-1.5,.1)/256,p$S++}return p$P}if("number"==typeof p$q)return p$E.loader.create(p$h,null,null,p$G,[function(p$h){return this._width=p$q,this._height=p$f,this._buffer=p$h,null}]);if("function"==typeof p$q)return p$E.loader.create(p$h,null,null,p$G,[p$q]);throw new Error("unknown params.")},p$G.lodasatlas=!1,p$U(p$G,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),p$G}(),p$Hq=function(p$h){function p$q(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,p$q.__super.call(this)}p$v(p$q,"laya.d3.resource.models.PrimitiveMesh",p$bq);var p$f=p$q.prototype;return p$E.imps(p$f,{"laya.d3.core.render.IRenderable":!0}),p$f._getVertexBuffer=function(p$h){return void 0===p$h&&(p$h=0),0===p$h?this._vertexBuffer:null},p$f._getVertexBuffers=function(){return null},p$f._getIndexBuffer=function(){return this._indexBuffer},p$f._getPositions=function(){var p$h,p$q=[],p$f=this._vertexBuffer.vertexDeclaration.getVertexElements(),p$g=0;for(p$g=0;p$g<p$f.length;p$g++){var p$$=p$f[p$g];if("vector3"===p$$.elementFormat&&0===p$$.elementUsage){p$h=p$$;break}}var p$P=this._vertexBuffer.getData();for(p$g=0;p$g<p$P.length;p$g+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var p$S=p$g+p$h.offset/4,p$B=new p$Sq(p$P[p$S+0],p$P[p$S+1],p$P[p$S+2]);p$q.push(p$B)}return p$q},p$f.getRenderElement=function(p$h){return this},p$f.getRenderElementsCount=function(){return 1},p$f.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},p$f._beforeRender=function(p$h){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},p$f._render=function(p$h){p$d.mainContext.drawElements(4,this._numberIndices,5123,0),p$X.drawCall++,p$X.trianglesFaces+=this._numberIndices/3},p$L(0,p$f,"_vertexBufferCount",function(){return 1}),p$L(0,p$f,"triangleCount",function(){return this._indexBuffer.indexCount/3}),p$q}(),p$Dq=function(p$h){function p$q(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,p$q.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}p$v(p$q,"laya.d3.resource.models.Mesh",p$bq);var p$f=p$q.prototype;return p$f._getPositions=function(){var p$h,p$q,p$f,p$g,p$$,p$P=[],p$S=0,p$B=0,p$r=0;if(0!==this._vertexBuffers.length){var p$Y=this._vertexBuffers.length;for(p$S=0;p$S<p$Y;p$S++){for(p$f=(p$h=this._vertexBuffers[p$S]).vertexDeclaration.getVertexElements(),p$B=0;p$B<p$f.length;p$B++)if("vector3"===(p$g=p$f[p$B]).elementFormat&&0===p$g.elementUsage){p$q=p$g;break}for(p$$=p$h.getData(),p$B=0;p$B<p$$.length;p$B+=p$h.vertexDeclaration.vertexStride/4)p$r=p$B+p$q.offset/4,p$P.push(new p$Sq(p$$[p$r+0],p$$[p$r+1],p$$[p$r+2]))}}else{var p$C=this._subMeshes.length;for(p$S=0;p$S<p$C;p$S++){for(p$f=(p$h=this._subMeshes[p$S]._getVertexBuffer()).vertexDeclaration.getVertexElements(),p$B=0;p$B<p$f.length;p$B++)if("vector3"===(p$g=p$f[p$B]).elementFormat&&0===p$g.elementUsage){p$q=p$g;break}for(p$$=p$h.getData(),p$B=0;p$B<p$$.length;p$B+=p$h.vertexDeclaration.vertexStride/4)p$r=p$B+p$q.offset/4,p$P.push(new p$Sq(p$$[p$r+0],p$$[p$r+1],p$$[p$r+2]))}}return p$P},p$f._setSubMeshes=function(p$h){this._subMeshes=p$h,this._subMeshCount=p$h.length;for(var p$q=0;p$q<this._subMeshCount;p$q++)p$h[p$q]._indexInMesh=p$q;this._positions=this._getPositions(),this._generateBoundingObject()},p$f.onAsynLoaded=function(p$h,p$q,p$f){var p$g=p$q[0],p$$=p$q[1];p$Qh.read(p$g,this,this._materials,this._subMeshes,p$$),this.completeCreate(),this._endLoaded()},p$f.getSubMesh=function(p$h){return this._subMeshes[p$h]},p$f.getSubMeshCount=function(){return this._subMeshes.length},p$f.getRenderElementsCount=function(){return this._subMeshes.length},p$f.getRenderElement=function(p$h){return this._subMeshes[p$h]},p$f.disposeResource=function(){for(var p$h=0;p$h<this._subMeshes.length;p$h++)this._subMeshes[p$h].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},p$L(0,p$f,"materials",function(){return this._materials.slice()}),p$L(0,p$f,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),p$q.load=function(p$h){return p$E.loader.create(p$h,null,null,p$q)},p$q}(),p$sq=(function(p$h){function p$Y(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===p$f&&(p$f=6408),void 0===p$g&&(p$g=5121),void 0===p$$&&(p$$=33189),void 0===p$P&&(p$P=!1),void 0===p$S&&(p$S=!1),void 0===p$B&&(p$B=-1),void 0===p$r&&(p$r=-1),p$Y.__super.call(this),this._type=3553,this._width=p$h,this._height=p$q,this._size=new p$eq(p$h,p$q),this._surfaceFormat=p$f,this._surfaceType=p$g,this._depthStencilFormat=p$$,p$e.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=p$P,this._repeat=p$S,this._minFifter=p$B,this._magFifter=p$r,this.activeResource(),this._alreadyResolved=!0}p$v(p$Y,"laya.d3.resource.RenderTexture",p$dq);var p$q=p$Y.prototype;p$q.recreateResource=function(){var p$h=p$d.mainContext;this._frameBuffer=p$h.createFramebuffer(),this._source=p$h.createTexture();var p$q=p$b.curBindTexTarget,p$f=p$b.curBindTexValue;p$b.bindTexture(p$h,this._type,this._source),p$h.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var p$g=this._minFifter,p$$=this._magFifter,p$P=this._repeat?10497:33071;if(p$m.isPOT(this._width,this._height)?(this._mipmap?-1!==p$g||(p$g=9987):-1!==p$g||(p$g=9729),-1!==p$$||(p$$=9729),p$h.texParameteri(this._type,10241,p$g),p$h.texParameteri(this._type,10240,p$$),p$h.texParameteri(this._type,10242,p$P),p$h.texParameteri(this._type,10243,p$P),this._mipmap&&p$h.generateMipmap(this._type)):(-1!==p$g||(p$g=9729),-1!==p$$||(p$$=9729),p$h.texParameteri(this._type,10241,p$g),p$h.texParameteri(this._type,10240,p$$),p$h.texParameteri(this._type,10242,33071),p$h.texParameteri(this._type,10243,33071)),p$q&&p$f&&p$b.bindTexture(p$h,p$q,p$f),p$h.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=p$h.createRenderbuffer(),p$h.bindRenderbuffer(36161,this._depthStencilBuffer),p$h.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),p$h.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:p$h.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:p$h.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:p$h.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}p$h.framebufferTexture2D(36160,36064,3553,this._source,0),p$h.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},p$q.start=function(){p$d.mainContext.bindFramebuffer(36160,this.frameBuffer),(p$Y._currentRenderTarget=this)._alreadyResolved=!1},p$q.end=function(){p$d.mainContext.bindFramebuffer(36160,null),p$Y._currentRenderTarget=null,this._alreadyResolved=!0},p$q.getData=function(p$h,p$q,p$f,p$g){var p$$=p$d.mainContext;if(p$$.bindFramebuffer(36160,this._frameBuffer),!(36053===p$$.checkFramebufferStatus(36160)))return p$$.bindFramebuffer(36160,null),null;var p$P=new Uint8Array(this._width*this._height*4);return p$$.readPixels(p$h,p$q,p$f,p$g,this._surfaceFormat,this._surfaceType,p$P),p$$.bindFramebuffer(36160,null),p$P},p$q.disposeResource=function(){if(this._frameBuffer){var p$h=p$d.mainContext;p$h.deleteTexture(this._source),p$h.deleteFramebuffer(this._frameBuffer),p$h.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},p$L(0,p$q,"surfaceFormat",function(){return this._surfaceFormat}),p$L(0,p$q,"surfaceType",function(){return this._surfaceType}),p$L(0,p$q,"depthStencilFormat",function(){return this._depthStencilFormat}),p$L(0,p$q,"source",function(){return this._alreadyResolved?p$E.superGet(p$dq,this,"source"):null}),p$L(0,p$q,"depthStencilBuffer",function(){return this._depthStencilBuffer}),p$L(0,p$q,"frameBuffer",function(){return this._frameBuffer}),p$Y._currentRenderTarget=null}(),function(p$h){function p$q(p$h){this._color=null,this._pixels=null,p$q.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new p$eq(this.width,this.height),this._color=p$h,this._pixels=new Uint8Array([255*p$h.x,255*p$h.y,255*p$h.z,255*p$h.w]),this.uri="SolidColorTexture2D_"+this.id}p$v(p$q,"laya.d3.resource.SolidColorTexture2D",p$dq);var p$f=p$q.prototype;return p$f._createWebGlTexture=function(){var p$h=p$d.mainContext,p$q=this._source=p$h.createTexture(),p$f=this._width,p$g=this._height,p$$=p$b.curBindTexTarget,p$P=p$b.curBindTexValue;p$b.bindTexture(p$h,this._type,p$q),p$h.texImage2D(this._type,0,6408,p$f,p$g,0,6408,5121,this._pixels);var p$S=this._minFifter,p$B=this._magFifter,p$r=this._repeat?10497:33071,p$Y=p$m.isPOT(p$f,p$g);p$Y?(this._mipmap?-1!==p$S||(p$S=9987):-1!==p$S||(p$S=9729),-1!==p$B||(p$B=9729),p$h.texParameteri(this._type,10241,p$S),p$h.texParameteri(this._type,10240,p$B),p$h.texParameteri(this._type,10242,p$r),p$h.texParameteri(this._type,10243,p$r),this._mipmap&&p$h.generateMipmap(this._type)):(-1!==p$S||(p$S=9729),-1!==p$B||(p$B=9729),p$h.texParameteri(this._type,10241,p$S),p$h.texParameteri(this._type,10240,p$B),p$h.texParameteri(this._type,10242,33071),p$h.texParameteri(this._type,10243,33071)),p$$&&p$P&&p$b.bindTexture(p$h,p$$,p$P),this.memorySize=p$Y?p$f*p$g*4*(1+1/3):p$f*p$g*4},p$f.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},p$f.disposeResource=function(){this._source&&(p$d.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},p$U(p$q,["magentaTexture",function(){var p$h=new p$q(new p$Bq(1,0,1,1));return p$h.lock=!0,this.magentaTexture=p$h},"grayTexture",function(){var p$h=new p$q(new p$Bq(.5,.5,.5,1));return p$h.lock=!0,this.grayTexture=p$h}]),p$q}()),p$Vq=function(p$h){function p$$(p$h,p$q,p$f,p$g){this._canRead=!1,this._image=null,this._pixels=null,void 0===p$h&&(p$h=!1),void 0===p$q&&(p$q=!0),void 0===p$f&&(p$f=6408),void 0===p$g&&(p$g=!0),p$$.__super.call(this),this._type=3553,this._repeat=p$q,this._canRead=p$h,this._format=p$f,this._mipmap=p$g}p$v(p$$,"laya.d3.resource.Texture2D",p$dq);var p$q=p$$.prototype;return p$q._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var p$h=p$d.mainContext,p$q=this._source=p$h.createTexture(),p$f=this._width,p$g=this._height,p$$=p$b.curBindTexTarget,p$P=p$b.curBindTexValue;switch(p$b.bindTexture(p$h,this._type,p$q),this._format){case 6407:case 6408:this._canRead?p$h.texImage2D(this._type,0,this._format,p$f,p$g,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?p$h.texImage2D(this._type,0,this._image._format,p$f,p$g,0,this._image._format,5121,this._image.atlasSource):p$h.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case p$d.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:p$h.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var p$S=this._minFifter,p$B=this._magFifter,p$r=this._repeat?10497:33071,p$Y=0==this._wrapModeU?10497:33071,p$C=0==this._wrapModeV?10497:33071,p$U=p$m.isPOT(p$f,p$g);p$U?(this._mipmap?-1!==p$S||(p$S=9987):-1!==p$S||(p$S=9729),-1!==p$B||(p$B=9729),p$h.texParameteri(this._type,10241,p$S),p$h.texParameteri(this._type,10240,p$B),p$h.texParameteri(this._type,10242,p$r),p$h.texParameteri(this._type,10243,p$r),p$h.texParameteri(this._type,10242,p$Y),p$h.texParameteri(this._type,10243,p$C),this._mipmap&&p$h.generateMipmap(this._type)):(-1!==p$S||(p$S=9729),-1!==p$B||(p$B=9729),p$h.texParameteri(this._type,10241,p$S),p$h.texParameteri(this._type,10240,p$B),p$h.texParameteri(this._type,10242,33071),p$h.texParameteri(this._type,10243,33071)),p$$&&p$P&&p$b.bindTexture(p$h,p$$,p$P),this._image.onload=null,this._image=null,this.memorySize=p$U?p$f*p$g*4*(1+1/3):p$f*p$g*4},p$q.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},p$q.onAsynLoaded=function(p$h,p$q,p$f){if(p$f){var p$g=p$f[0];void 0!==p$g&&(this._canRead=p$g);var p$$=p$f[1];void 0!==p$$&&(this._repeat=p$$);var p$P=p$f[2];void 0!==p$P&&(this._format=p$P);var p$S=p$f[3];void 0!==p$S&&(this._mipmap=p$S);var p$B=p$f.wrapModeU;void 0!==p$B&&(this._wrapModeU=p$B);var p$r=p$f.wrapModeV;void 0!==p$r&&(this._wrapModeV=p$r)}switch(this._format){case 6407:case 6408:var p$Y=(this._image=p$q).width,p$C=p$q.height;this._width=p$Y,this._height=p$C,this._size=new p$eq(p$Y,p$C),this._canRead&&(p$e.isConchApp?p$q instanceof p$u.HTMLElement&&(this._pixels=new Uint8Array(p$q.getImageData(0,0,p$Y,p$C))):(p$i.canvas.size(p$Y,p$C),p$i.canvas.clear(),p$i.context.drawImage(p$q,0,0,p$Y,p$C),this._pixels=new Uint8Array(p$i.context.getImageData(0,0,p$Y,p$C).data.buffer)));break;case p$d.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var p$U=new p$R(p$q);p$U.readUTFBytes(4),p$U.readUTFBytes(2),p$U.getInt16();p$U.endian="bigEndian",this._width=p$U.getInt16(),this._height=p$U.getInt16(),this._size=new p$eq(this._width,this._height);p$U.getInt16(),p$U.getInt16();this._image=new Uint8Array(p$q,p$U.pos)}this.recreateResource(),this._endLoaded()},p$q.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},p$q.disposeResource=function(){this._source&&(p$d.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},p$L(0,p$q,"_src",function(){return this.url}),p$L(0,p$q,"src",function(){return this.url}),p$$.load=function(p$h){return p$E.loader.create(p$h,null,null,p$$)},p$$}(),p$Kq=function(p$q){function p$f(p$h,p$q){p$f.__super.call(this),void 0===p$h&&(p$h=.3),void 0===p$q&&(p$q=1e3),this._tempVector3=new p$Sq,this._position=new p$Sq,this._up=new p$Sq,this._forward=new p$Sq,this._right=new p$Sq,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=p$eq.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=p$h,this._farPlane=p$q,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),p$E.stage.on("resize",this,this._onScreenSizeChanged)}p$v(p$f,"laya.d3.core.BaseCamera",p$q);var p$h=p$f.prototype;return p$h._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var p$h=this.scene._cameraPool,p$q=p$h.length-1,p$f=0;p$f<p$q;p$f++)if(p$h[p$f].renderingOrder>p$h[p$q].renderingOrder){var p$g=p$h[p$f];p$h[p$f]=p$h[p$q],p$h[p$q]=p$g}},p$h._calculateProjectionMatrix=function(){},p$h._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},p$h._prepareCameraToRender=function(){p$z._currentCameraCullingMask=this.cullingMask;var p$h=this._shaderValues;p$h.setValue(0,this.transform.position.elements),p$h.setValue(5,this.forward.elements),p$h.setValue(6,this.up.elements)},p$h._prepareCameraViewProject=function(p$h,p$q){var p$f=this._shaderValues;p$f.setValue(1,p$h.elements),p$f.setValue(2,p$q.elements)},p$h._renderCamera=function(p$h,p$q,p$f){},p$h.addLayer=function(p$h){29!==p$h.number&&30!=p$h.number&&(this.cullingMask=this.cullingMask|p$h.mask)},p$h.removeLayer=function(p$h){29!==p$h.number&&30!=p$h.number&&(this.cullingMask=this.cullingMask&~p$h.mask)},p$h.addAllLayers=function(){this.cullingMask=2147483647},p$h.removeAllLayers=function(){this.cullingMask=0|p$z.getLayerByNumber(29).mask|p$z.getLayerByNumber(30).mask},p$h.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},p$h.moveForward=function(p$h){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=p$h,this.transform.translate(this._tempVector3)},p$h.moveRight=function(p$h){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=p$h,this.transform.translate(this._tempVector3)},p$h.moveVertical=function(p$h){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=p$h,this.transform.translate(this._tempVector3,!1)},p$h._addSelfRenderObjects=function(){var p$h=this.scene._cameraPool,p$q=p$h.length;if(0<p$q){for(var p$f=p$q-1;0<=p$f;p$f--)if(this.renderingOrder<=p$h[p$f].renderingOrder){p$h.splice(p$f+1,0,this);break}}else p$h.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},p$h._clearSelfRenderObjects=function(){var p$h=this.scene._cameraPool;p$h.splice(p$h.indexOf(this),1)},p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,p$E.stage.off("resize",this,this._onScreenSizeChanged),p$q.prototype.destroy.call(this,p$h)},p$L(0,p$h,"sky",function(){return this._sky},function(p$h){(this._sky=p$h)._ownerCamera=this}),p$L(0,p$h,"forward",function(){var p$h=this.transform.worldMatrix.elements,p$q=this._forward.elements;return p$q[0]=-p$h[8],p$q[1]=-p$h[9],p$q[2]=-p$h[10],this._forward}),p$L(0,p$h,"position",function(){var p$h=this.transform.worldMatrix.elements,p$q=this._position.elements;return p$q[0]=p$h[12],p$q[1]=p$h[13],p$q[2]=p$h[14],this._position}),p$L(0,p$h,"renderTarget",function(){return this._renderTarget},function(p$h){null!=(this._renderTarget=p$h)&&(this._renderTargetSize=p$h.size)}),p$L(0,p$h,"up",function(){var p$h=this.transform.worldMatrix.elements,p$q=this._up.elements;return p$q[0]=p$h[4],p$q[1]=p$h[5],p$q[2]=p$h[6],this._up}),p$L(0,p$h,"right",function(){var p$h=this.transform.worldMatrix.elements,p$q=this._right.elements;return p$q[0]=p$h[0],p$q[1]=p$h[1],p$q[2]=p$h[2],this._right}),p$L(0,p$h,"renderTargetSize",function(){return this._renderTargetSize},function(p$h){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=p$h,this._calculateProjectionMatrix()}),p$L(0,p$h,"fieldOfView",function(){return this._fieldOfView},function(p$h){this._fieldOfView=p$h,this._calculateProjectionMatrix()}),p$L(0,p$h,"nearPlane",function(){return this._nearPlane},function(p$h){this._nearPlane=p$h,this._calculateProjectionMatrix()}),p$L(0,p$h,"farPlane",function(){return this._farPlane},function(p$h){this._farPlane=p$h,this._calculateProjectionMatrix()}),p$L(0,p$h,"orthographic",function(){return this._orthographic},function(p$h){this._orthographic=p$h,this._calculateProjectionMatrix()}),p$L(0,p$h,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(p$h){this._orthographicVerticalSize=p$h,this._calculateProjectionMatrix()}),p$L(0,p$h,"renderingOrder",function(){return this._renderingOrder},function(p$h){this._renderingOrder=p$h,this._sortCamerasByRenderingOrder()}),p$f.CAMERAPOS=0,p$f.VIEWMATRIX=1,p$f.PROJECTMATRIX=2,p$f.VPMATRIX=3,p$f.VPMATRIX_NO_TRANSLATE=4,p$f.CAMERADIRECTION=5,p$f.CAMERAUP=6,p$f.ENVIRONMENTDIFFUSE=7,p$f.ENVIRONMENTSPECULAR=8,p$f.SIMLODINFO=9,p$f.DIFFUSEIRRADMATR=10,p$f.DIFFUSEIRRADMATG=11,p$f.DIFFUSEIRRADMATB=12,p$f.HDREXPOSURE=13,p$f.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",p$f.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",p$f.CLEARFLAG_SOLIDCOLOR=0,p$f.CLEARFLAG_SKY=1,p$f.CLEARFLAG_DEPTHONLY=2,p$f.CLEARFLAG_NONE=3,p$U(p$f,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new p$hq(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new p$hq},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new p$hq}]),p$f}(p$Mq),p$yq=function(p$f){function p$q(p$h){this._render=null,this._geometryFilter=null,p$q.__super.call(this,p$h)}p$v(p$q,"laya.d3.core.RenderableSprite3D",p$f);var p$h=p$q.prototype;return p$h._addToInitStaticBatchManager=function(){},p$h._setBelongScene=function(p$h){p$f.prototype._setBelongScene.call(this,p$h),p$h._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},p$h._setUnBelongScene=function(){var p$h=this._scene._renderableSprite3Ds,p$q=p$h.indexOf(this);p$h.splice(p$q,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),p$f.prototype._setUnBelongScene.call(this)},p$h._update=function(p$h){(p$h.owner=this)._activeInHierarchy&&(this._updateComponents(p$h),this._render._updateOctreeNode(),this._lateUpdateComponents(p$h),p$X.spriteCount++,this._childs.length&&this._updateChilds(p$h))},p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$f.prototype.destroy.call(this,p$h),this._render._destroy(),this._render=null},p$q.__init__=function(){p$q.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=p$q.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),p$q.SAHDERDEFINE_LIGHTMAP=p$q.shaderDefines.registerDefine("LIGHTMAP")},p$q.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,p$q.SAHDERDEFINE_LIGHTMAP=4,p$q.LIGHTMAPSCALEOFFSET=2,p$q.LIGHTMAP=3,p$U(p$q,["shaderDefines",function(){return this.shaderDefines=new p$Cq}]),p$q}(p$Mq),p$Fq=(function(p$h){function p$g(p$h,p$q,p$f){this._long=NaN,this._width=NaN,this._height=NaN,void 0===p$h&&(p$h=1),void 0===p$q&&(p$q=1),void 0===p$f&&(p$f=1),p$g.__super.call(this),this._long=p$h,this._width=p$q,this._height=p$f,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}p$v(p$g,"laya.d3.resource.models.BoxMesh",p$Hq);var p$q=p$g.prototype;p$q.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var p$h=p$dh.vertexDeclaration,p$q=(p$h.vertexStride,this._long/2),p$f=this._height/2,p$g=this._width/2,p$$=new Float32Array([-p$q,p$f,-p$g,0,1,0,0,0,p$q,p$f,-p$g,0,1,0,1,0,p$q,p$f,p$g,0,1,0,1,1,-p$q,p$f,p$g,0,1,0,0,1,-p$q,-p$f,-p$g,0,-1,0,0,1,p$q,-p$f,-p$g,0,-1,0,1,1,p$q,-p$f,p$g,0,-1,0,1,0,-p$q,-p$f,p$g,0,-1,0,0,0,-p$q,p$f,-p$g,-1,0,0,0,0,-p$q,p$f,p$g,-1,0,0,1,0,-p$q,-p$f,p$g,-1,0,0,1,1,-p$q,-p$f,-p$g,-1,0,0,0,1,p$q,p$f,-p$g,1,0,0,1,0,p$q,p$f,p$g,1,0,0,0,0,p$q,-p$f,p$g,1,0,0,0,1,p$q,-p$f,-p$g,1,0,0,1,1,-p$q,p$f,p$g,0,0,1,0,0,p$q,p$f,p$g,0,0,1,1,0,p$q,-p$f,p$g,0,0,1,1,1,-p$q,-p$f,p$g,0,0,1,0,1,-p$q,p$f,-p$g,0,0,-1,1,0,p$q,p$f,-p$g,0,0,-1,0,0,p$q,-p$f,-p$g,0,0,-1,0,1,-p$q,-p$f,-p$g,0,0,-1,1,1]),p$P=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new p$wq(p$h,this._numberVertices,35044,!0),this._indexBuffer=new p$Iq("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(p$$),this._indexBuffer.setData(p$P),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},p$L(0,p$q,"long",function(){return this._long},function(p$h){this._long!==p$h&&(this._long=p$h,this.releaseResource(),this.activeResource())}),p$L(0,p$q,"width",function(){return this._width},function(p$h){this._width!==p$h&&(this._width=p$h,this.releaseResource(),this.activeResource())}),p$L(0,p$q,"height",function(){return this._height},function(p$h){this._height!==p$h&&(this._height=p$h,this.releaseResource(),this.activeResource())})}(),function(p$h){function p$S(p$h,p$q,p$f){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=.3),void 0===p$f&&(p$f=1e3),this._viewMatrix=new p$hq,this._projectionMatrix=new p$hq,this._projectionViewMatrix=new p$hq,this._viewport=new p$rq(0,0,0,0),this._normalizedViewport=new p$rq(0,0,1,1),this._aspectRatio=p$h,this._boundFrustumUpdate=!0,this._boundFrustum=new p$Oh(p$hq.DEFAULT),p$S.__super.call(this,p$q,p$f),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}p$v(p$S,"laya.d3.core.Camera",p$Kq);var p$q=p$S.prototype;return p$q._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},p$q._parseCustomProps=function(p$h,p$q,p$f,p$g){var p$$=p$f.clearColor;this.clearColor=new p$Bq(p$$[0],p$$[1],p$$[2],p$$[3]);var p$P=p$f.viewport;this.normalizedViewport=new p$rq(p$P[0],p$P[1],p$P[2],p$P[3])},p$q._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var p$h=this.orthographicVerticalSize*this.aspectRatio*.5,p$q=.5*this.orthographicVerticalSize;p$hq.createOrthoOffCenterRH(-p$h,p$h,-p$q,p$q,this.nearPlane,this.farPlane,this._projectionMatrix)}else p$hq.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},p$q._update=function(p$h){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,p$h)},p$q._renderCamera=function(p$h,p$q,p$f){var p$g,p$$;p$f.parallelSplitShadowMaps[0]&&p$f._renderShadowMap(p$h,p$q,this),(p$q.camera=this)._prepareCameraToRender(),p$f._preRenderUpdateComponents(p$q),p$g=p$q._viewMatrix=this.viewMatrix;var p$P=this._renderTarget;p$P?(p$P.start(),p$hq.multiply(p$Kq._invertYScaleMatrix,this._projectionMatrix,p$Kq._invertYProjectionMatrix),p$hq.multiply(p$Kq._invertYScaleMatrix,this.projectionViewMatrix,p$Kq._invertYProjectionViewMatrix),p$$=p$q._projectionMatrix=p$Kq._invertYProjectionMatrix,p$q._projectionViewMatrix=p$Kq._invertYProjectionViewMatrix):(p$$=p$q._projectionMatrix=this._projectionMatrix,p$q._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(p$g,p$$),p$q._viewport=this.viewport,p$f._preRenderScene(p$h,p$q,this.boundFrustum),p$f._clear(p$h,p$q),p$f._renderScene(p$h,p$q),p$f._postRenderUpdateComponents(p$q),p$P&&p$P.end()},p$q.viewportPointToRay=function(p$h,p$q){p$Lq.calculateCursorRay(p$h,this.viewport,this._projectionMatrix,this.viewMatrix,null,p$q)},p$q.normalizedViewportPointToRay=function(p$h,p$q){var p$f=p$S._tempVector20,p$g=this.viewport,p$$=p$h.elements,p$P=p$f.elements;p$P[0]=p$$[0]*p$g.width,p$P[1]=p$$[1]*p$g.height,p$Lq.calculateCursorRay(p$f,this.viewport,this._projectionMatrix,this.viewMatrix,null,p$q)},p$q.worldToViewportPoint=function(p$h,p$q){p$hq.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(p$h,this._projectionViewMatrix,p$q);var p$f=p$q.elements;p$f[0]=p$f[0]/p$E.stage.clientScaleX,p$f[1]=p$f[1]/p$E.stage.clientScaleY},p$q.worldToNormalizedViewportPoint=function(p$h,p$q){p$hq.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(p$h,this._projectionViewMatrix,p$q);var p$f=p$q.elements;p$f[0]=p$f[0]/p$E.stage.clientScaleX,p$f[1]=p$f[1]/p$E.stage.clientScaleY},p$q.convertScreenCoordToOrthographicCoord=function(p$h,p$q){if(this._orthographic){var p$f=p$Q.clientWidth,p$g=p$Q.clientHeight,p$$=this.orthographicVerticalSize*this.aspectRatio/p$f,p$P=this.orthographicVerticalSize/p$g,p$S=p$h.elements,p$B=p$q.elements;return p$B[0]=(-p$f/2+p$S[0])*p$$,p$B[1]=(p$g/2-p$S[1])*p$P,p$B[2]=(this.nearPlane-this.farPlane)*(p$S[2]+1)/2-this.nearPlane,p$Sq.transformCoordinate(p$q,this.transform.worldMatrix,p$q),!0}return!1},p$L(0,p$q,"projectionViewMatrix",function(){return p$hq.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),p$L(0,p$q,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var p$h=this.viewport;return p$h.width/p$h.height},function(p$h){if(p$h<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=p$h,this._calculateProjectionMatrix()}),p$L(0,p$q,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),p$L(0,p$q,"needViewport",function(){var p$h=this.normalizedViewport;return 0===p$h.x&&0===p$h.y&&1===p$h.width&&1===p$h.height}),p$L(0,p$q,"viewport",function(){if(this._viewportExpressedInClipSpace){var p$h=this._normalizedViewport,p$q=this.renderTargetSize,p$f=p$q.width,p$g=p$q.height;this._viewport.x=p$h.x*p$f,this._viewport.y=p$h.y*p$g,this._viewport.width=p$h.width*p$f,this._viewport.height=p$h.height*p$g}return this._viewport},function(p$h){if(null!=this.renderTarget&&(p$h.x<0||p$h.y<0||0==p$h.width||0==p$h.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=p$h,this._calculateProjectionMatrix()}),p$L(0,p$q,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var p$h=this._viewport,p$q=this.renderTargetSize,p$f=p$q.width,p$g=p$q.height;this._normalizedViewport.x=p$h.x/p$f,this._normalizedViewport.y=p$h.y/p$g,this._normalizedViewport.width=p$h.width/p$f,this._normalizedViewport.height=p$h.height/p$g}return this._normalizedViewport},function(p$h){p$h.x<0&&(p$h.x=0,console.warn("Camera: viewport.x must large than 0.0.")),p$h.y<0&&(p$h.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<p$h.x+p$h.width&&(p$h.width=1-p$h.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<p$h.y+p$h.height&&(p$h.height=1-p$h.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=p$h,this._calculateProjectionMatrix()}),p$L(0,p$q,"projectionMatrix",function(){return this._projectionMatrix},function(p$h){this._projectionMatrix=p$h,this._useUserProjectionMatrix=!0}),p$L(0,p$q,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),p$U(p$S,["_tempVector20",function(){return this._tempVector20=new p$Pq}]),p$S}()),p$Zq=function(p$f){function p$g(p$h,p$q){p$g.__super.call(this,p$q),this._geometryFilter=new p$iq(this),this._render=new p$zq(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),p$h&&(this._geometryFilter.sharedMesh=p$h)instanceof laya.d3.resource.models.Mesh&&(p$h.loaded?this._render.sharedMaterials=p$h.materials:p$h.once("loaded",this,this._applyMeshMaterials))}p$v(p$g,"laya.d3.core.MeshSprite3D",p$f);var p$h=p$g.prototype;return p$h._changeRenderObjectByMesh=function(p$h){var p$q=this._render._renderElements,p$f=p$q[p$h];p$f||(p$f=p$q[p$h]=new p$tq),p$f._render=this._render;var p$g=this._render.sharedMaterials[p$h];p$g||(p$g=p$Tq.defaultMaterial);var p$$=this._geometryFilter.sharedMesh.getRenderElement(p$h);return p$f._mainSortID=this._getSortID(p$$,p$g),p$f._sprite3D=this,p$f.renderObj=p$$,p$f._material=p$g,p$f},p$h._changeRenderObjectByMaterial=function(p$h,p$q){var p$f=this._render._renderElements[p$h];p$q||(p$q=p$Tq.defaultMaterial);var p$g=this._geometryFilter.sharedMesh.getRenderElement(p$h);return p$f._mainSortID=this._getSortID(p$g,p$q),p$f._sprite3D=this,p$f.renderObj=p$g,p$f._material=p$q,p$f},p$h._changeRenderObjectsByMesh=function(){var p$h=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=p$h;for(var p$q=0;p$q<p$h;p$q++)this._changeRenderObjectByMesh(p$q)},p$h._onMeshChanged=function(p$h){var p$q=p$h.sharedMesh;p$q.loaded?this._changeRenderObjectsByMesh():p$q.once("loaded",this,this._onMeshLoaded)},p$h._onMeshLoaded=function(p$h){p$h===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},p$h._onMaterialChanged=function(p$h,p$q,p$f){p$q<this._render._renderElements.length&&this._changeRenderObjectByMaterial(p$q,p$f)},p$h._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},p$h._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},p$h._parseCustomProps=function(p$h,p$q,p$f,p$g){var p$$=this.meshRender,p$P=p$f.lightmapIndex;null!=p$P&&(p$$.lightmapIndex=p$P);var p$S,p$B,p$r=p$f.lightmapScaleOffset;if(p$r&&(p$$.lightmapScaleOffset=new p$Bq(p$r[0],p$r[1],p$r[2],p$r[3])),p$g.instanceParams)(p$S=p$g.instanceParams.loadPath)&&(p$B=p$_.getRes(p$q[p$S]),(this.meshFilter.sharedMesh=p$B).loaded?p$$.sharedMaterials=p$B.materials:p$B.once("loaded",this,this._applyMeshMaterials));else{(p$S=p$f.meshPath)&&(p$B=p$_.getRes(p$q[p$S]),this.meshFilter.sharedMesh=p$B);var p$Y=p$f.materials;if(p$Y){var p$C=p$$.sharedMaterials,p$U=p$Y.length;p$C.length=p$U;for(var p$u=0;p$u<p$U;p$u++)p$C[p$u]=p$_.getRes(p$q[p$Y[p$u].path]);p$$.sharedMaterials=p$C}}},p$h._applyMeshMaterials=function(p$h){for(var p$q=this._render.sharedMaterials,p$f=p$h.materials,p$g=0,p$$=p$f.length;p$g<p$$;p$g++)p$q[p$g]||(p$q[p$g]=p$f[p$g]);this._render.sharedMaterials=p$q},p$h._addToInitStaticBatchManager=function(){p$g._staticBatchManager._addInitBatchSprite(this)},p$h.cloneTo=function(p$h){var p$q=p$h;p$q._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var p$f=this._render,p$g=p$q._render;p$g.enable=p$f.enable,p$g.sharedMaterials=p$f.sharedMaterials,p$g.castShadow=p$f.castShadow;var p$$=p$f.lightmapScaleOffset;p$$&&(p$g.lightmapScaleOffset=p$$.clone()),p$g.lightmapIndex=p$f.lightmapIndex,p$g.receiveShadow=p$f.receiveShadow,p$g.sortingFudge=p$f.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,p$h)},p$h.destroy=function(p$h){if(void 0===p$h&&(p$h=!0),!this.destroyed){var p$q=this.meshFilter.sharedMesh;null!=p$q&&(p$q.loaded||p$q.off("loaded",this,this._applyMeshMaterials)),p$f.prototype.destroy.call(this,p$h),this._geometryFilter._destroy()}},p$L(0,p$h,"meshFilter",function(){return this._geometryFilter}),p$L(0,p$h,"meshRender",function(){return this._render}),p$g.__init__=function(){p$gh._staticBatchManagers.push(p$g._staticBatchManager)},p$g.load=function(p$h){return p$E.loader.create(p$h,null,null,p$g)},p$U(p$g,["_staticBatchManager",function(){return this._staticBatchManager=new p$nq}]),p$g}(p$yq)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(p$h,p$q){"use strict";for(var p$f in Object.defineProperty(p$q,"__esModule",{value:!0}),Laya){var p$g=Laya[p$f];p$g&&p$g.__isclass&&(p$q[p$f]=p$g)}}),function(p$h,p$q,p$$h){p$$h.un,p$$h.uns;var p$f=p$$h.static,p$g=p$$h.class,p$P=p$$h.getset,p$e=p$$h.__newvec,p$B=laya.maths.Bezier,p$U=laya.utils.Browser,p$dh=laya.utils.Byte,p$$=(laya.events.Event,laya.events.EventDispatcher),p$S=laya.display.Graphics,p$r=(laya.resource.HTMLCanvas,laya.utils.Handler),p$Y=laya.net.Loader,p$u=laya.maths.MathUtil,p$bh=laya.maths.Matrix,p$l=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),p$C=(laya.renders.RenderContext,laya.resource.Resource),p$v=laya.utils.RunDriver,p$Ph=laya.display.Sprite,p$L=laya.utils.Stat,p$ih=laya.resource.Texture,p$_=(laya.net.URL,laya.utils.Utils),p$b=function(){function p$h(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return p$g(p$h,"laya.ani.AnimationContent"),p$h}(),p$i=function(){function p$h(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return p$g(p$h,"laya.ani.AnimationNodeContent"),p$h}(),p$G=function(){function p$h(){}return p$g(p$h,"laya.ani.AnimationParser01"),p$h.parse=function(p$h,p$q){var p$f=p$q.__getBuffer(),p$g=0,p$$=0,p$P=0,p$S=0,p$B=0,p$r=0,p$Y=0,p$C=p$q.readUTFString();p$h._aniClassName=p$C;var p$U,p$u=p$q.readUTFString().split("\n"),p$v=p$q.getUint8(),p$L=p$q.getUint32(),p$e=p$q.getUint32();0<p$L&&(p$U=p$f.slice(p$L,p$e));var p$l=new p$dh(p$U);for(0<p$e&&(p$h._publicExtData=p$f.slice(p$e,p$f.byteLength)),p$h._useParent=!!p$q.getUint8(),p$h._anis.length=p$v,p$g=0;p$g<p$v;p$g++){var p$_=p$h._anis[p$g]=new p$b;p$_.nodes=new Array;var p$N=p$_.name=p$u[p$q.getUint16()];p$h._aniMap[p$N]=p$g,p$_.bone3DMap={},p$_.playTime=p$q.getFloat32(),p$_.playTime<=0&&console.error("播放时间不能为0  url="+p$h.url+" name="+p$_.name);var p$G=p$_.nodes.length=p$q.getUint8();for(p$$=p$_.totalKeyframeDatasLength=0;p$$<p$G;p$$++){var p$m=p$_.nodes[p$$]=new p$i;p$m.childs=[];var p$E=p$q.getInt16();0<=p$E&&(p$m.name=p$u[p$E],p$_.bone3DMap[p$m.name]=p$$),p$m.keyFrame=new Array,p$m.parentIndex=p$q.getInt16(),-1==p$m.parentIndex?p$m.parent=null:p$m.parent=p$_.nodes[p$m.parentIndex],p$m.lerpType=p$q.getUint8();var p$R=p$q.getUint32();p$l.pos=p$R;var p$t=p$m.keyframeWidth=p$l.getUint16();if(p$_.totalKeyframeDatasLength+=p$t,0===p$m.lerpType||1===p$m.lerpType)for(p$m.interpolationMethod=[],p$m.interpolationMethod.length=p$t,p$P=0;p$P<p$t;p$P++)p$m.interpolationMethod[p$P]=p$M.interpolation[p$l.getUint8()];null!=p$m.parent&&p$m.parent.childs.push(p$m);var p$X=p$q.getUint16();0<p$X&&(p$m.extenData=p$f.slice(p$q.pos,p$q.pos+p$X),p$q.pos+=p$X);var p$n,p$J=p$q.getUint16(),p$p=0;for(p$P=0,p$S=p$m.keyFrame.length=p$J;p$P<p$S;p$P++){if((p$n=p$m.keyFrame[p$P]=new p$z).duration=p$q.getFloat32(),p$n.startTime=p$p,2===p$m.lerpType){p$n.interpolationData=[];var p$A,p$d=p$q.getUint8();switch(p$A=p$q.getFloat32()){case 254:for(p$n.interpolationData.length=p$t,p$Y=0;p$Y<p$t;p$Y++)p$n.interpolationData[p$Y]=0;break;case 255:for(p$n.interpolationData.length=p$t,p$Y=0;p$Y<p$t;p$Y++)p$n.interpolationData[p$Y]=5;break;default:for(p$n.interpolationData.push(p$A),p$r=1;p$r<p$d;p$r++)p$n.interpolationData.push(p$q.getFloat32())}}for(p$n.data=new Float32Array(p$t),p$B=0;p$B<p$t;p$B++)p$n.data[p$B]=p$q.getFloat32(),-1e-8<p$n.data[p$B]&&p$n.data[p$B]<1e-8&&(p$n.data[p$B]=0);p$p+=p$n.duration}p$n.startTime=p$_.playTime,p$m.playTime=p$_.playTime,p$h._calculateKeyFrame(p$m,p$J,p$t)}}},p$h}(),p$m=function(){function p$E(){}return p$g(p$E,"laya.ani.AnimationParser02"),p$E.READ_DATA=function(){p$E._DATA.offset=p$E._reader.getUint32(),p$E._DATA.size=p$E._reader.getUint32()},p$E.READ_BLOCK=function(){for(var p$h=p$E._BLOCK.count=p$E._reader.getUint16(),p$q=p$E._BLOCK.blockStarts=[],p$f=p$E._BLOCK.blockLengths=[],p$g=0;p$g<p$h;p$g++)p$q.push(p$E._reader.getUint32()),p$f.push(p$E._reader.getUint32())},p$E.READ_STRINGS=function(){var p$h=p$E._reader.getUint32(),p$q=p$E._reader.getUint16(),p$f=p$E._reader.pos;p$E._reader.pos=p$h+p$E._DATA.offset;for(var p$g=0;p$g<p$q;p$g++)p$E._strings[p$g]=p$E._reader.readUTFString();p$E._reader.pos=p$f},p$E.parse=function(p$h,p$q){p$E._templet=p$h;(p$E._reader=p$q).__getBuffer();p$E.READ_DATA(),p$E.READ_BLOCK(),p$E.READ_STRINGS();for(var p$f=0,p$g=p$E._BLOCK.count;p$f<p$g;p$f++){var p$$=p$q.getUint16(),p$P=p$E._strings[p$$],p$S=p$E["READ_"+p$P];if(null==p$S)throw new Error("model file err,no this function:"+p$$+" "+p$P);p$S.call()}},p$E.READ_ANIMATIONS=function(){var p$h=p$E._reader,p$q=p$h.__getBuffer(),p$f=0,p$g=0,p$$=0,p$P=0,p$S=p$h.getUint16(),p$B=[];for(p$B.length=p$S,p$f=0;p$f<p$S;p$f++)p$B[p$f]=p$M.interpolation[p$h.getByte()];var p$r=p$h.getUint8();for(p$E._templet._anis.length=p$r,p$f=0;p$f<p$r;p$f++){var p$Y=p$E._templet._anis[p$f]={};p$Y.nodes=new Array;var p$C=p$Y.name=p$E._strings[p$h.getUint16()];p$E._templet._aniMap[p$C]=p$f,p$Y.bone3DMap={},p$Y.playTime=p$h.getFloat32();var p$U=p$Y.nodes.length=p$h.getInt16();for(p$g=p$Y.totalKeyframeDatasLength=0;p$g<p$U;p$g++){var p$u=p$Y.nodes[p$g]={};p$u.keyframeWidth=p$S,p$u.childs=[];var p$v=p$h.getUint16();0<=p$v&&(p$u.name=p$E._strings[p$v],p$Y.bone3DMap[p$u.name]=p$g),p$u.keyFrame=new Array,p$u.parentIndex=p$h.getInt16(),-1==p$u.parentIndex?p$u.parent=null:p$u.parent=p$Y.nodes[p$u.parentIndex],p$Y.totalKeyframeDatasLength+=p$S,p$u.interpolationMethod=p$B,null!=p$u.parent&&p$u.parent.childs.push(p$u);var p$L=p$h.getUint16(),p$e=null,p$l=null;for(p$$=0,p$P=p$u.keyFrame.length=p$L;p$$<p$P;p$$++){(p$e=p$u.keyFrame[p$$]={}).startTime=p$h.getFloat32(),p$l&&(p$l.duration=p$e.startTime-p$l.startTime);var p$_=p$E._DATA.offset,p$N=p$h.getUint32(),p$G=4*p$S,p$m=p$q.slice(p$_+p$N,p$_+p$N+p$G);p$e.data=new Float32Array(p$m),p$l=p$e}p$e.duration=0,p$u.playTime=p$Y.playTime,p$E._templet._calculateKeyFrame(p$u,p$L,p$S)}}},p$E._templet=null,p$E._reader=null,p$E._strings=[],p$f(p$E,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),p$E}(),p$zh=(function(){function p$h(){}p$g(p$h,"laya.ani.AnimationState"),p$h.stopped=0,p$h.paused=1,p$h.playing=2}(),function(){function p$$(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new p$yh,this.resultMatrix=new p$bh,this._children=[]}p$g(p$$,"laya.ani.bone.Bone");var p$h=p$$.prototype;return p$h.setTempMatrix=function(p$h){this._tempMatrix=p$h;var p$q,p$f=0;for(p$f=0,p$q=this._children.length;p$f<p$q;p$f++)this._children[p$f].setTempMatrix(this._tempMatrix)},p$h.update=function(p$h){var p$q;if(this.rotation=this.transform.skX,p$h)p$q=this.resultTransform.getMatrix(),p$bh.mul(p$q,p$h,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)p$q=this.resultTransform.getMatrix(),p$bh.mul(p$q,this.parentBone.resultMatrix,this.resultMatrix);else{var p$f=this.parentBone,p$g=NaN,p$$=NaN,p$P=NaN,p$S=this.parentBone.resultMatrix;p$q=this.resultTransform.getMatrix();var p$B=p$S.a*p$q.tx+p$S.c*p$q.ty+p$S.tx,p$r=p$S.b*p$q.tx+p$S.d*p$q.ty+p$S.ty,p$Y=new p$bh;this.inheritRotation?(p$g=Math.atan2(p$f.resultMatrix.b,p$f.resultMatrix.a),p$$=Math.cos(p$g),p$P=Math.sin(p$g),p$Y.setTo(p$$,p$P,-p$P,p$$,0,0),p$bh.mul(this._tempMatrix,p$Y,p$bh.TEMP),p$bh.TEMP.copyTo(p$Y),p$q=this.resultTransform.getMatrix(),p$bh.mul(p$q,p$Y,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,p$q=this.resultTransform.getMatrix(),p$bh.TEMP.identity(),p$bh.TEMP.d=this.d,p$bh.mul(p$q,p$bh.TEMP,this.resultMatrix)),this.resultMatrix.tx=p$B,this.resultMatrix.ty=p$r}else(p$q=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var p$C,p$U=0;for(p$U=0,p$C=this._children.length;p$U<p$C;p$U++)this._children[p$U].update()},p$h.updateChild=function(){var p$h,p$q=0;for(p$q=0,p$h=this._children.length;p$q<p$h;p$q++)this._children[p$q].update()},p$h.setRotation=function(p$h){this._sprite&&(this._sprite.rotation=180*p$h/Math.PI)},p$h.updateDraw=function(p$h,p$q){p$$.ShowBones&&!p$$.ShowBones[this.name]||(this._sprite||(this._sprite=new p$Ph,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),p$$h.stage.addChild(this._sprite)),this._sprite.x=p$h+this.resultMatrix.tx,this._sprite.y=p$q+this.resultMatrix.ty);var p$f,p$g=0;for(p$g=0,p$f=this._children.length;p$g<p$f;p$g++)this._children[p$g].updateDraw(p$h,p$q)},p$h.addChild=function(p$h){this._children.push(p$h),p$h.parentBone=this},p$h.findBone=function(p$h){if(this.name==p$h)return this;var p$q,p$f,p$g=0;for(p$g=0,p$q=this._children.length;p$g<p$q;p$g++)if(p$f=this._children[p$g].findBone(p$h))return p$f;return null},p$h.localToWorld=function(p$h){var p$q=p$h[0],p$f=p$h[1];p$h[0]=p$q*this.resultMatrix.a+p$f*this.resultMatrix.c+this.resultMatrix.tx,p$h[1]=p$q*this.resultMatrix.b+p$f*this.resultMatrix.d+this.resultMatrix.ty},p$$.ShowBones={},p$$}()),p$ch=function(){function p$e(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}p$g(p$e,"laya.ani.bone.BoneSlot");var p$h=p$e.prototype;return p$h.showSlotData=function(p$h,p$q){void 0===p$q&&(p$q=!0),this.currSlotData=p$h,p$q&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},p$h.showDisplayByName=function(p$h){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(p$h))},p$h.replaceDisplayByName=function(p$h,p$q){if(this.currSlotData){var p$f;p$f=this.currSlotData.getDisplayByName(p$h);var p$g;p$g=this.currSlotData.getDisplayByName(p$q),this.replaceDisplayByIndex(p$f,p$g)}},p$h.replaceDisplayByIndex=function(p$h,p$q){this.currSlotData&&(this._replaceDic[p$h]=p$q,this.displayIndex==p$h&&this.showDisplayByIndex(p$h))},p$h.showDisplayByIndex=function(p$h){if(null!=this._replaceDic[p$h]&&(p$h=this._replaceDic[p$h]),this.currSlotData&&-1<p$h&&p$h<this.currSlotData.displayArr.length){if(this.displayIndex=p$h,this.currDisplayData=this.currSlotData.displayArr[p$h],this.currDisplayData){var p$q=this.currDisplayData.name;this.currTexture=this.templet.getTexture(p$q),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!p$l.isConchApp||p$l.isConchApp&&"0.9.15"<p$Ph.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},p$h.replaceSkin=function(p$h){this._diyTexture=p$h,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},p$h.setParentMatrix=function(p$h){this._parentMatrix=p$h},p$h.draw=function(p$h,p$q,p$f,p$g){if(void 0===p$f&&(p$f=!1),void 0===p$g&&(p$g=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var p$$,p$P=this.currTexture;switch(this._diyTexture&&(p$P=this._diyTexture),this.currDisplayData.type){case 0:if(p$h){var p$S=this.getDisplayMatrix();if(this._parentMatrix){var p$B=!1;if(p$S){var p$r;if(p$bh.mul(p$S,this._parentMatrix,p$bh.TEMP),p$r=p$f?(null==this._resultMatrix&&(this._resultMatrix=new p$bh),this._resultMatrix):new p$bh,!p$l.isWebGL&&this.currDisplayData.uvs||p$l.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var p$Y=p$e._tempMatrix;p$Y.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(p$Y.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(p$B=!0,p$Y.rotate(-Math.PI/2)),p$bh.mul(p$Y,p$bh.TEMP,p$r)}else p$bh.TEMP.copyTo(p$r);p$B?p$h.drawTexture(p$P,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,p$r):p$h.drawTexture(p$P,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,p$r)}}}break;case 1:if(null==(p$$=p$f?(null==this._skinSprite&&(this._skinSprite=p$e.createSkinMesh()),this._skinSprite):p$e.createSkinMesh()))return;var p$C;if(null==this.currDisplayData.bones){var p$U,p$u=this.currDisplayData.weights;this.deformData&&(p$u=this.deformData),p$U=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=p$t.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=p$t.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=p$u;this.currDisplayData.triangles.length;p$C=this.currDisplayData.triangles,p$$.init2(p$P,null,p$C,this._mVerticleArr,p$U);var p$v,p$L=this.getDisplayMatrix();if(this._parentMatrix)if(p$L)p$bh.mul(p$L,this._parentMatrix,p$bh.TEMP),p$v=p$f?(null==this._resultMatrix&&(this._resultMatrix=new p$bh),this._resultMatrix):new p$bh,p$bh.TEMP.copyTo(p$v),p$$.transform=p$v}else this.skinMesh(p$q,p$$,p$g);p$h.drawSkin(p$$);break;case 2:if(null==(p$$=p$f?(null==this._skinSprite&&(this._skinSprite=p$e.createSkinMesh()),this._skinSprite):p$e.createSkinMesh()))return;this.skinMesh(p$q,p$$,p$g),p$h.drawSkin(p$$)}}},p$h.skinMesh=function(p$h,p$q,p$f){var p$g,p$$=this.currTexture,p$P=this.currDisplayData.bones;p$g=this._diyTexture?(p$$=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=p$t.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=p$t.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var p$S,p$B,p$r=this.currDisplayData.weights,p$Y=this.currDisplayData.triangles,p$C=0,p$U=0,p$u=0,p$v=NaN,p$L=NaN,p$e=0,p$l=0,p$_=[],p$N=0,p$G=0;if(this.deformData&&0<this.deformData.length){var p$m=0;for(p$N=0,p$G=p$P.length;p$N<p$G;){for(p$u=p$P[p$N++]+p$N,p$U=p$C=0;p$N<p$u;p$N++)p$B=p$h[p$P[p$N]],p$v=p$r[p$e]+this.deformData[p$m++],p$L=p$r[p$e+1]+this.deformData[p$m++],p$l=p$r[p$e+2],p$C+=(p$v*p$B.a+p$L*p$B.c+p$B.tx)*p$l,p$U+=(p$v*p$B.b+p$L*p$B.d+p$B.ty)*p$l,p$e+=3;p$_.push(p$C,p$U)}}else for(p$N=0,p$G=p$P.length;p$N<p$G;){for(p$u=p$P[p$N++]+p$N,p$U=p$C=0;p$N<p$u;p$N++)p$B=p$h[p$P[p$N]],p$v=p$r[p$e],p$L=p$r[p$e+1],p$l=p$r[p$e+2],p$C+=(p$v*p$B.a+p$L*p$B.c+p$B.tx)*p$l,p$U+=(p$v*p$B.b+p$L*p$B.d+p$B.ty)*p$l,p$e+=3;p$_.push(p$C,p$U)}this._mVerticleArr=p$_,p$S=p$Y,p$q.init2(p$$,null,p$S,this._mVerticleArr,p$g)},p$h.drawBonePoint=function(p$h){p$h&&this._parentMatrix&&p$h.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},p$h.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},p$h.getMatrix=function(){return this._resultMatrix},p$h.copy=function(){var p$h=new p$e;return p$h.type="copy",p$h.name=this.name,p$h.attachmentName=this.attachmentName,p$h.srcDisplayIndex=this.srcDisplayIndex,p$h.parent=this.parent,p$h.displayIndex=this.displayIndex,p$h.templet=this.templet,p$h.currSlotData=this.currSlotData,p$h.currTexture=this.currTexture,p$h.currDisplayData=this.currDisplayData,p$h},p$e.createSkinMesh=function(){return p$l.isWebGL||p$l.isConchApp?p$v.skinAniSprite():(p$l.isWebGL,null)},p$f(p$e,["_tempMatrix",function(){return this._tempMatrix=new p$bh}]),p$e}(),p$Mh=function(){function p$h(){this.skinName=null,this.deformSlotDataList=[]}return p$g(p$h,"laya.ani.bone.DeformAniData"),p$h}(),p$Wh=function(){function p$h(){this.deformSlotDisplayList=[]}return p$g(p$h,"laya.ani.bone.DeformSlotData"),p$h}(),p$Th=function(){function p$h(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}p$g(p$h,"laya.ani.bone.DeformSlotDisplayData");var p$q=p$h.prototype;return p$q.binarySearch1=function(p$h,p$q){var p$f=0,p$g=p$h.length-2;if(0==p$g)return 1;for(var p$$=p$g>>>1;;){if(p$h[Math.floor(p$$+1)]<=p$q?p$f=p$$+1:p$g=p$$,p$f==p$g)return p$f+1;p$$=p$f+p$g>>>1}return 0},p$q.apply=function(p$h,p$q,p$f){if(void 0===p$f&&(p$f=1),p$h+=.05,!(this.timeList.length<=0)){var p$g=0;if(!(p$h<this.timeList[0])){var p$$=this.vectices[0].length,p$P=[],p$S=this.binarySearch1(this.timeList,p$h);if(this.frameIndex=p$S,p$h>=this.timeList[this.timeList.length-1]){var p$B=this.vectices[this.vectices.length-1];if(p$f<1)for(p$g=0;p$g<p$$;p$g++)p$P[p$g]+=(p$B[p$g]-p$P[p$g])*p$f;else for(p$g=0;p$g<p$$;p$g++)p$P[p$g]=p$B[p$g];this.deformData=p$P}else{this.tweenKeyList[this.frameIndex];var p$r=this.vectices[this.frameIndex-1],p$Y=this.vectices[this.frameIndex],p$C=this.timeList[this.frameIndex-1],p$U=this.timeList[this.frameIndex];p$f=this.tweenKeyList[p$S-1]?(p$h-p$C)/(p$U-p$C):0;var p$u=NaN;for(p$g=0;p$g<p$$;p$g++)p$u=p$r[p$g],p$P[p$g]=p$u+(p$Y[p$g]-p$u)*p$f;this.deformData=p$P}}}},p$h}(),p$Ih=function(){function p$h(){this.time=NaN,this.drawOrder=[]}return p$g(p$h,"laya.ani.bone.DrawOrderData"),p$h}(),p$wh=function(){function p$h(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return p$g(p$h,"laya.ani.bone.EventData"),p$h}(),p$N=function(){function p$gh(p$h,p$q){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=p$h,this._targetBone=p$q[p$h.targetBoneIndex],this.isSpine=p$h.isSpine,null==this._bones&&(this._bones=[]);for(var p$f=this._bones.length=0,p$g=p$h.boneIndexs.length;p$f<p$g;p$f++)this._bones.push(p$q[p$h.boneIndexs[p$f]]);this.name=p$h.name,this.mix=p$h.mix,this.bendDirection=p$h.bendDirection}p$g(p$gh,"laya.ani.bone.IkConstraint");var p$h=p$gh.prototype;return p$h.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},p$h._applyIk1=function(p$h,p$q,p$f,p$g){var p$$=p$h.parentBone,p$P=1/(p$$.resultMatrix.a*p$$.resultMatrix.d-p$$.resultMatrix.b*p$$.resultMatrix.c),p$S=p$q-p$$.resultMatrix.tx,p$B=p$f-p$$.resultMatrix.ty,p$r=(p$S*p$$.resultMatrix.d-p$B*p$$.resultMatrix.c)*p$P-p$h.transform.x,p$Y=(p$B*p$$.resultMatrix.a-p$S*p$$.resultMatrix.b)*p$P-p$h.transform.y,p$C=Math.atan2(p$Y,p$r)*p$gh.radDeg-0-p$h.transform.skX;p$h.transform.scX<0&&(p$C+=180),180<p$C?p$C-=360:p$C<-180&&(p$C+=360),p$h.transform.skX=p$h.transform.skY=p$h.transform.skX+p$C*p$g,p$h.update()},p$h.updatePos=function(p$h,p$q){this._sp&&this._sp.pos(p$h,p$q)},p$h._applyIk2=function(p$h,p$q,p$f,p$g,p$$,p$P){if(0!=p$P){var p$S=p$h.resultTransform.x,p$B=p$h.resultTransform.y,p$r=p$h.transform.scX,p$Y=p$h.transform.scY,p$C=p$q.transform.scX,p$U=0,p$u=0,p$v=0;p$v=p$r<0?(p$r=-p$r,p$U=180,-1):(p$U=0,1),p$Y<0&&(p$Y=-p$Y,p$v=-p$v),p$u=p$C<0?(p$C=-p$C,180):0;var p$L=p$q.resultTransform.x,p$e=NaN,p$l=NaN,p$_=NaN,p$N=p$h.resultMatrix.a,p$G=p$h.resultMatrix.c,p$m=p$h.resultMatrix.b,p$E=p$h.resultMatrix.d,p$R=Math.abs(p$r-p$Y)<=1e-4;p$_=p$R?(p$l=p$N*p$L+p$G*(p$e=p$q.resultTransform.y)+p$h.resultMatrix.tx,p$m*p$L+p$E*p$e+p$h.resultMatrix.ty):(p$e=0,p$l=p$N*p$L+p$h.resultMatrix.tx,p$m*p$L+p$h.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new p$Ph,p$$h.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(p$f,p$g,15,"#ffff00"),this._sp.graphics.drawCircle(p$l,p$_,15,"#ff00ff")),p$h.setRotation(Math.atan2(p$_-p$h.resultMatrix.ty,p$l-p$h.resultMatrix.tx));var p$t=p$h.parentBone;p$N=p$t.resultMatrix.a,p$G=p$t.resultMatrix.c,p$m=p$t.resultMatrix.b;var p$X=1/(p$N*(p$E=p$t.resultMatrix.d)-p$G*p$m),p$n=p$f-p$t.resultMatrix.tx,p$J=p$g-p$t.resultMatrix.ty,p$p=(p$n*p$E-p$J*p$G)*p$X-p$S,p$A=(p$J*p$N-p$n*p$m)*p$X-p$B,p$d=((p$n=p$l-p$t.resultMatrix.tx)*p$E-(p$J=p$_-p$t.resultMatrix.ty)*p$G)*p$X-p$S,p$b=(p$J*p$N-p$n*p$m)*p$X-p$B,p$i=Math.sqrt(p$d*p$d+p$b*p$b),p$z=p$q.length*p$C,p$c=NaN,p$M=NaN;if(p$R){var p$W=(p$p*p$p+p$A*p$A-p$i*p$i-(p$z*=p$r)*p$z)/(2*p$i*p$z);p$W<-1?p$W=-1:1<p$W&&(p$W=1),p$M=Math.acos(p$W)*p$$,p$N=p$i+p$z*p$W,p$G=p$z*Math.sin(p$M),p$c=Math.atan2(p$A*p$N-p$p*p$G,p$p*p$N+p$A*p$G)}else{var p$T=(p$N=p$r*p$z)*p$N,p$I=(p$G=p$Y*p$z)*p$G,p$w=p$p*p$p+p$A*p$A,p$k=Math.atan2(p$A,p$p),p$H=-2*p$I*p$i,p$D=p$I-p$T;if(0<(p$E=p$H*p$H-4*p$D*(p$m=p$I*p$i*p$i+p$T*p$w-p$T*p$I))){var p$s=Math.sqrt(p$E);p$H<0&&(p$s=-p$s);var p$V=(p$s=-(p$H+p$s)/2)/p$D,p$K=p$m/p$s,p$y=Math.abs(p$V)<Math.abs(p$K)?p$V:p$K;p$y*p$y<=p$w&&(p$J=Math.sqrt(p$w-p$y*p$y)*p$$,p$c=p$k-Math.atan2(p$J,p$y),p$M=Math.atan2(p$J/p$Y,(p$y-p$i)/p$r))}var p$F=0,p$Z=Number.MAX_VALUE,p$Q=0,p$o=0,p$O=0,p$j=0,p$x=0,p$a=0;p$j<(p$E=(p$n=p$i+p$N)*p$n)&&(p$O=0,p$j=p$E,p$x=p$n),(p$E=(p$n=p$i-p$N)*p$n)<p$Z&&(p$F=Math.PI,p$Z=p$E,p$Q=p$n);var p$hh=Math.acos(-p$N*p$i/(p$T-p$I));(p$E=(p$n=p$N*Math.cos(p$hh)+p$i)*p$n+(p$J=p$G*Math.sin(p$hh))*p$J)<p$Z&&(p$F=p$hh,p$Z=p$E,p$Q=p$n,p$o=p$J),p$j<p$E&&(p$O=p$hh,p$j=p$E,p$x=p$n,p$a=p$J),p$M=p$w<=(p$Z+p$j)/2?(p$c=p$k-Math.atan2(p$o*p$$,p$Q),p$F*p$$):(p$c=p$k-Math.atan2(p$a*p$$,p$x),p$O*p$$)}var p$qh=Math.atan2(p$e,p$L)*p$v,p$fh=p$h.resultTransform.skX;180<(p$c=(p$c-p$qh)*p$gh.radDeg+p$U-p$fh)?p$c-=360:p$c<-180&&(p$c+=360),p$h.resultTransform.x=p$S,p$h.resultTransform.y=p$B,p$h.resultTransform.skX=p$h.resultTransform.skY=p$fh+p$c*p$P,p$fh=p$q.resultTransform.skX,180<(p$M=((p$M+p$qh)*p$gh.radDeg-0)*p$v+p$u-(p$fh%=360))?p$M-=360:p$M<-180&&(p$M+=360),p$q.resultTransform.x=p$L,p$q.resultTransform.y=p$e,p$q.resultTransform.skX=p$q.resultTransform.skY=p$q.resultTransform.skY+p$M*p$P,p$h.update()}},p$h._applyIk3=function(p$h,p$q,p$f,p$g,p$$,p$P){if(0!=p$P){var p$S,p$B,p$r=p$q.resultMatrix.a*p$q.length,p$Y=p$q.resultMatrix.b*p$q.length,p$C=p$r*p$r+p$Y*p$Y,p$U=Math.sqrt(p$C),p$u=p$h.resultMatrix.tx,p$v=p$h.resultMatrix.ty,p$L=p$q.resultMatrix.tx,p$e=p$q.resultMatrix.ty,p$l=p$L-p$u,p$_=p$e-p$v,p$N=p$l*p$l+p$_*p$_,p$G=Math.sqrt(p$N),p$m=(p$l=p$f-p$h.resultMatrix.tx)*p$l+(p$_=p$g-p$h.resultMatrix.ty)*p$_,p$E=Math.sqrt(p$m);if(p$U+p$G<=p$E||p$E+p$U<=p$G||p$E+p$G<=p$U){var p$R=NaN;p$L=p$u+(p$R=p$U+p$G<=p$E?1:-1)*(p$f-p$u)*p$G/p$E,p$e=p$v+p$R*(p$g-p$v)*p$G/p$E}else{var p$t=(p$N-p$C+p$m)/(2*p$m),p$X=Math.sqrt(p$N-p$t*p$t*p$m)/p$E,p$n=p$u+p$l*p$t,p$J=p$v+p$_*p$t,p$p=-p$_*p$X,p$A=p$l*p$X;p$e=0<p$$?(p$L=p$n-p$p,p$J-p$A):(p$L=p$n+p$p,p$J+p$A)}p$S=p$L,p$B=p$e,this.isDebug&&(this._sp||(this._sp=new p$Ph,p$$h.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(p$u,p$v,15,"#ff00ff"),this._sp.graphics.drawCircle(p$f,p$g,15,"#ffff00"),this._sp.graphics.drawCircle(p$S,p$B,15,"#ff00ff"));var p$d,p$b;p$d=Math.atan2(p$B-p$h.resultMatrix.ty,p$S-p$h.resultMatrix.tx),p$h.setRotation(p$d),(p$b=p$gh._tempMatrix).identity(),p$b.rotate(p$d),p$b.scale(p$h.resultMatrix.getScaleX(),p$h.resultMatrix.getScaleY()),p$b.translate(p$h.resultMatrix.tx,p$h.resultMatrix.ty),p$b.copyTo(p$h.resultMatrix),p$h.updateChild();var p$i,p$z;p$i=Math.atan2(p$g-p$B,p$f-p$S),p$q.setRotation(p$i),(p$z=p$gh._tempMatrix).identity(),p$z.rotate(p$i),p$z.scale(p$q.resultMatrix.getScaleX(),p$q.resultMatrix.getScaleY()),p$z.translate(p$S,p$B),p$b.copyTo(p$q.resultMatrix),p$q.updateChild()}},p$f(p$gh,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new p$bh}]),p$gh}(),p$kh=function(){function p$h(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return p$g(p$h,"laya.ani.bone.IkConstraintData"),p$h}(),p$E=function(){function p$z(p$h,p$q){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=p$h,this.position=p$h.position,this.spacing=p$h.spacing,this.rotateMix=p$h.rotateMix,this.translateMix=p$h.translateMix,this.bones=[];for(var p$f=this.data.bones,p$g=0,p$$=p$f.length;p$g<p$$;p$g++)this.bones.push(p$q[p$f[p$g]])}p$g(p$z,"laya.ani.bone.PathConstraint");var p$h=p$z.prototype;return p$h.apply=function(p$h,p$q){if(this.target){var p$f=this.translateMix,p$g=this.translateMix,p$$=0<p$g,p$P=this.data.spacingMode,p$S="length"==p$P,p$B=this.data.rotateMode,p$r="tangent"==p$B,p$Y="chainScale"==p$B,p$C=[],p$U=this.bones.length,p$u=p$r?p$U:p$U+1,p$v=[];(this._spaces=p$v)[0]=this.position;var p$L=this.spacing;if(p$Y||p$S)for(var p$e=0,p$l=p$u-1;p$e<p$l;){var p$_=this.bones[p$e],p$N=p$_.length,p$G=p$N*p$_.resultMatrix.a,p$m=p$N*p$_.resultMatrix.b;p$N=Math.sqrt(p$G*p$G+p$m*p$m),p$Y&&(p$C[p$e]=p$N),p$v[++p$e]=p$S?Math.max(0,p$N+p$L):p$L}else for(p$e=1;p$e<p$u;p$e++)p$v[p$e]=p$L;var p$E=this.computeWorldPositions(this.target,p$h,p$q,p$u,p$r,"percent"==this.data.positionMode,"percent"==p$P);if(this._debugKey){for(p$e=0;p$e<p$E.length;p$e++)p$q.drawCircle(p$E[p$e++],p$E[p$e++],5,"#00ff00");var p$R=[];for(p$e=0;p$e<p$E.length;p$e++)p$R.push(p$E[p$e++],p$E[p$e++]);p$q.drawLines(0,0,p$R,"#ff0000")}var p$t=p$E[0],p$X=p$E[1],p$n=this.data.offsetRotation,p$J="chain"==p$B&&0==p$n,p$p=NaN;for(p$e=0,p$p=3;p$e<p$U;p$e++,p$p+=3){(p$_=this.bones[p$e]).resultMatrix.tx+=(p$t-p$_.resultMatrix.tx)*p$f,p$_.resultMatrix.ty+=(p$X-p$_.resultMatrix.ty)*p$f;var p$A=(p$G=p$E[p$p])-p$t,p$d=(p$m=p$E[p$p+1])-p$X;if(p$Y&&0!=(p$N=p$C[p$e])){var p$b=(Math.sqrt(p$A*p$A+p$d*p$d)/p$N-1)*p$g+1;p$_.resultMatrix.a*=p$b,p$_.resultMatrix.c*=p$b}if(p$t=p$G,p$X=p$m,p$$){var p$i=p$_.resultMatrix.a,p$z=p$_.resultMatrix.c,p$c=p$_.resultMatrix.b,p$M=p$_.resultMatrix.d,p$W=NaN,p$T=NaN,p$I=NaN;p$W=p$r?p$E[p$p-1]:0==p$v[p$e+1]?p$E[p$p+2]:Math.atan2(p$d,p$A),p$W-=Math.atan2(p$c,p$i)-p$n/180*Math.PI,p$J&&(p$T=Math.cos(p$W),p$I=Math.sin(p$W),p$t+=((p$N=p$_.length)*(p$T*p$i-p$I*p$c)-p$A)*p$g,p$X+=(p$N*(p$I*p$i+p$T*p$c)-p$d)*p$g),p$W>Math.PI?p$W-=2*Math.PI:p$W<-Math.PI&&(p$W+=2*Math.PI),p$W*=p$g,p$T=Math.cos(p$W),p$I=Math.sin(p$W),p$_.resultMatrix.a=p$T*p$i-p$I*p$c,p$_.resultMatrix.c=p$T*p$z-p$I*p$M,p$_.resultMatrix.b=p$I*p$i+p$T*p$c,p$_.resultMatrix.d=p$I*p$z+p$T*p$M}}}},p$h.computeWorldVertices2=function(p$h,p$q,p$f,p$g,p$$,p$P){var p$S,p$B,p$r=p$h.currDisplayData.bones,p$Y=p$h.currDisplayData.weights,p$C=p$h.currDisplayData.triangles,p$U=0,p$u=0,p$v=0,p$L=0,p$e=0,p$l=0,p$_=0,p$N=0,p$G=0,p$m=0,p$E=0;if(null!=p$r){for(p$U=0;p$U<p$f;p$U+=2)p$u+=(p$L=p$r[p$u])+1,p$v+=p$L;var p$R=p$q;for(p$e=p$P,p$l=3*p$v;p$e<p$g;p$e+=2){for(p$N=p$_=0,p$L=p$r[p$u++],p$L+=p$u;p$u<p$L;p$u++,p$l+=3){p$S=p$R[p$r[p$u]].resultMatrix,p$G=p$Y[p$l],p$m=p$Y[p$l+1];var p$t=p$Y[p$l+2];p$_+=(p$G*p$S.a+p$m*p$S.c+p$S.tx)*p$t,p$N+=(p$G*p$S.b+p$m*p$S.d+p$S.ty)*p$t}p$$[p$e]=p$_,p$$[p$e+1]=p$N}}else{var p$X,p$n;if(p$C||(p$C=p$Y),p$h.deformData&&(p$C=p$h.deformData),p$X=p$h.parent,p$q)for(p$E=p$q.length,p$U=0;p$U<p$E;p$U++)if(p$q[p$U].name==p$X){p$B=p$q[p$U];break}p$B&&(p$n=p$B.resultMatrix),p$n||(p$n=p$z._tempMt);var p$J=p$n.tx,p$p=p$n.ty,p$A=p$n.a,p$d=p$n.b,p$b=p$n.c,p$i=p$n.d;for(p$B&&(p$i*=p$B.d),p$u=p$f,p$e=p$P;p$e<p$g;p$u+=2,p$e+=2)p$G=p$C[p$u],p$m=p$C[p$u+1],p$$[p$e]=p$G*p$A+p$m*p$d+p$J,p$$[p$e+1]=-(p$G*p$b+p$m*p$i+p$p)}},p$h.computeWorldPositions=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S){p$h.currDisplayData.bones,p$h.currDisplayData.weights,p$h.currDisplayData.triangles;var p$B=[],p$r=0,p$Y=p$h.currDisplayData.verLen,p$C=this.position,p$U=this._spaces,p$u=[],p$v=[],p$L=p$Y/6,p$e=-1,p$l=NaN,p$_=0,p$N=0,p$G=NaN,p$m=NaN,p$E=NaN,p$R=NaN;if(p$L--,p$Y-=4,this.computeWorldVertices2(p$h,p$q,2,p$Y,p$B,0),this._debugKey)for(p$r=0;p$r<p$B.length;)p$f.drawCircle(p$B[p$r++],p$B[p$r++],10,"#ff0000");p$u=p$B,this._curves.length=p$L;var p$t=this._curves,p$X=p$u[p$l=0],p$n=p$u[1],p$J=0,p$p=0,p$A=0,p$d=0,p$b=0,p$i=0,p$z=NaN,p$c=NaN,p$M=NaN,p$W=NaN,p$T=NaN,p$I=NaN,p$w=NaN,p$k=NaN,p$H=0;for(p$r=0,p$H=2;p$r<p$L;p$r++,p$H+=6)p$J=p$u[p$H],p$p=p$u[p$H+1],p$A=p$u[p$H+2],p$d=p$u[p$H+3],p$T=2*(p$z=.1875*(p$X-2*p$J+p$A))+(p$M=.09375*(3*(p$J-p$A)-p$X+(p$b=p$u[p$H+4]))),p$I=2*(p$c=.1875*(p$n-2*p$p+p$d))+(p$W=.09375*(3*(p$p-p$d)-p$n+(p$i=p$u[p$H+5]))),p$w=.75*(p$J-p$X)+p$z+.16666667*p$M,p$k=.75*(p$p-p$n)+p$c+.16666667*p$W,p$l+=Math.sqrt(p$w*p$w+p$k*p$k),p$w+=p$T,p$k+=p$I,p$T+=p$M,p$I+=p$W,p$l+=Math.sqrt(p$w*p$w+p$k*p$k),p$w+=p$T,p$k+=p$I,p$l+=Math.sqrt(p$w*p$w+p$k*p$k),p$w+=p$T+p$M,p$k+=p$I+p$W,p$l+=Math.sqrt(p$w*p$w+p$k*p$k),p$t[p$r]=p$l,p$X=p$b,p$n=p$i;if(p$P&&(p$C*=p$l),p$S)for(p$r=0;p$r<p$g;p$r++)p$U[p$r]*=p$l;var p$D=this._segments,p$s=0,p$V=0;for(p$V=p$N=p$_=p$r=0;p$r<p$g;p$r++,p$_+=3)if((p$G=p$C+=p$m=p$U[p$r])<0)this.addBeforePosition(p$G,p$u,0,p$v,p$_);else if(p$l<p$G)this.addAfterPosition(p$G-p$l,p$u,p$Y-4,p$v,p$_);else{for(;;p$N++)if(!((p$R=p$t[p$N])<p$G)){0==p$N?p$G/=p$R:p$G=(p$G-(p$E=p$t[p$N-1]))/(p$R-p$E);break}if(p$N!=p$e){var p$K=6*(p$e=p$N);for(p$X=p$u[p$K],p$n=p$u[p$K+1],p$J=p$u[p$K+2],p$p=p$u[p$K+3],p$A=p$u[p$K+4],p$d=p$u[p$K+5],p$T=2*(p$z=.03*(p$X-2*p$J+p$A))+(p$M=.006*(3*(p$J-p$A)-p$X+(p$b=p$u[p$K+6]))),p$I=2*(p$c=.03*(p$n-2*p$p+p$d))+(p$W=.006*(3*(p$p-p$d)-p$n+(p$i=p$u[p$K+7]))),p$w=.3*(p$J-p$X)+p$z+.16666667*p$M,p$k=.3*(p$p-p$n)+p$c+.16666667*p$W,p$s=Math.sqrt(p$w*p$w+p$k*p$k),p$D[0]=p$s,p$K=1;p$K<8;p$K++)p$w+=p$T,p$k+=p$I,p$T+=p$M,p$I+=p$W,p$s+=Math.sqrt(p$w*p$w+p$k*p$k),p$D[p$K]=p$s;p$w+=p$T,p$k+=p$I,p$s+=Math.sqrt(p$w*p$w+p$k*p$k),p$D[8]=p$s,p$w+=p$T+p$M,p$k+=p$I+p$W,p$s+=Math.sqrt(p$w*p$w+p$k*p$k),p$D[9]=p$s,p$V=0}for(p$G*=p$s;;p$V++)if(!((p$R=p$D[p$V])<p$G)){0==p$V?p$G/=p$R:p$G=p$V+(p$G-(p$E=p$D[p$V-1]))/(p$R-p$E);break}this.addCurvePosition(.1*p$G,p$X,p$n,p$J,p$p,p$A,p$d,p$b,p$i,p$v,p$_,p$$||0<p$r&&0==p$m)}return p$v},p$h.addBeforePosition=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$q[p$f],p$S=p$q[p$f+1],p$B=p$q[p$f+2]-p$P,p$r=p$q[p$f+3]-p$S,p$Y=Math.atan2(p$r,p$B);p$g[p$$]=p$P+p$h*Math.cos(p$Y),p$g[p$$+1]=p$S+p$h*Math.sin(p$Y),p$g[p$$+2]=p$Y},p$h.addAfterPosition=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$q[p$f+2],p$S=p$q[p$f+3],p$B=p$P-p$q[p$f],p$r=p$S-p$q[p$f+1],p$Y=Math.atan2(p$r,p$B);p$g[p$$]=p$P+p$h*Math.cos(p$Y),p$g[p$$+1]=p$S+p$h*Math.sin(p$Y),p$g[p$$+2]=p$Y},p$h.addCurvePosition=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C,p$U){0==p$h&&(p$h=1e-4);var p$u=p$h*p$h,p$v=p$u*p$h,p$L=1-p$h,p$e=p$L*p$L,p$l=p$e*p$L,p$_=p$L*p$h,p$N=3*p$_,p$G=p$L*p$N,p$m=p$N*p$h,p$E=p$q*p$l+p$g*p$G+p$P*p$m+p$B*p$v,p$R=p$f*p$l+p$$*p$G+p$S*p$m+p$r*p$v;p$Y[p$C]=p$E,p$Y[p$C+1]=p$R,p$Y[p$C+2]=p$U?Math.atan2(p$R-(p$f*p$e+p$$*p$_*2+p$S*p$u),p$E-(p$q*p$e+p$g*p$_*2+p$P*p$u)):0},p$z.NONE=-1,p$z.BEFORE=-2,p$z.AFTER=-3,p$f(p$z,["_tempMt",function(){return this._tempMt=new p$bh}]),p$z}(),p$Hh=function(){function p$h(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return p$g(p$h,"laya.ani.bone.PathConstraintData"),p$h}(),p$Dh=function(){function p$h(){this.name=null,this.slotArr=[]}return p$g(p$h,"laya.ani.bone.SkinData"),p$h}(),p$sh=function(){function p$h(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}p$g(p$h,"laya.ani.bone.SkinSlotDisplayData");var p$q=p$h.prototype;return p$q.createTexture=function(p$h){return this.texture||(this.texture=new p$ih(p$h.bitmap,this.uvs),p$h.bitmap.alphaTexture&&(this.texture.alphaTexture=new p$ih(p$h.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=p$h.height,this.texture.height=p$h.width,this.texture.offsetX=-p$h.offsetX,this.texture.offsetY=-p$h.offsetY,this.texture.sourceWidth=p$h.sourceHeight,this.texture.sourceHeight=p$h.sourceWidth):(this.texture.width=p$h.width,this.texture.height=p$h.height,this.texture.offsetX=-p$h.offsetX,this.texture.offsetY=-p$h.offsetY,this.texture.sourceWidth=p$h.sourceWidth,this.texture.sourceHeight=p$h.sourceHeight),p$l.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},p$q.destory=function(){this.texture&&this.texture.destroy()},p$h}(),p$Vh=function(){function p$h(){this.name=null,this.displayArr=[]}return p$g(p$h,"laya.ani.bone.SlotData"),p$h.prototype.getDisplayByName=function(p$h){for(var p$q=0,p$f=this.displayArr.length;p$q<p$f;p$q++)if(this.displayArr[p$q].attachmentName==p$h)return p$q;return-1},p$h}(),p$R=function(){function p$h(p$h,p$q){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=p$e(2,0),this._data=p$h,null==this._bones&&(this._bones=[]),this.target=p$q[p$h.targetIndex];var p$f,p$g=0;for(p$g=0,p$f=p$h.boneIndexs.length;p$g<p$f;p$g++)this._bones.push(p$q[p$h.boneIndexs[p$g]]);this.rotateMix=p$h.rotateMix,this.translateMix=p$h.translateMix,this.scaleMix=p$h.scaleMix,this.shearMix=p$h.shearMix}return p$g(p$h,"laya.ani.bone.TfConstraint"),p$h.prototype.apply=function(){for(var p$h,p$q=this.target.resultMatrix.a,p$f=this.target.resultMatrix.b,p$g=this.target.resultMatrix.c,p$$=this.target.resultMatrix.d,p$P=0,p$S=this._bones.length;p$P<p$S;p$P++){if(p$h=this._bones[p$P],0<this.rotateMix){var p$B=p$h.resultMatrix.a,p$r=p$h.resultMatrix.b,p$Y=p$h.resultMatrix.c,p$C=p$h.resultMatrix.d,p$U=Math.atan2(p$g,p$q)-Math.atan2(p$Y,p$B)+this._data.offsetRotation*Math.PI/180;p$U>Math.PI?p$U-=2*Math.PI:p$U<-Math.PI&&(p$U+=2*Math.PI),p$U*=this.rotateMix;var p$u=Math.cos(p$U),p$v=Math.sin(p$U);p$h.resultMatrix.a=p$u*p$B-p$v*p$Y,p$h.resultMatrix.b=p$u*p$r-p$v*p$C,p$h.resultMatrix.c=p$v*p$B+p$u*p$Y,p$h.resultMatrix.d=p$v*p$r+p$u*p$C}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),p$h.resultMatrix.tx+=(this._temp[0]-p$h.resultMatrix.tx)*this.translateMix,p$h.resultMatrix.ty+=(this._temp[1]-p$h.resultMatrix.ty)*this.translateMix,p$h.updateChild()),0<this.scaleMix){var p$L=Math.sqrt(p$h.resultMatrix.a*p$h.resultMatrix.a+p$h.resultMatrix.c*p$h.resultMatrix.c),p$e=Math.sqrt(p$q*p$q+p$g*p$g),p$l=1e-5<p$L?(p$L+(p$e-p$L+this._data.offsetScaleX)*this.scaleMix)/p$L:0;p$h.resultMatrix.a*=p$l,p$h.resultMatrix.c*=p$l,p$L=Math.sqrt(p$h.resultMatrix.b*p$h.resultMatrix.b+p$h.resultMatrix.d*p$h.resultMatrix.d),p$e=Math.sqrt(p$f*p$f+p$$*p$$),p$l=1e-5<p$L?(p$L+(p$e-p$L+this._data.offsetScaleY)*this.scaleMix)/p$L:0,p$h.resultMatrix.b*=p$l,p$h.resultMatrix.d*=p$l}if(0<this.shearMix){p$r=p$h.resultMatrix.b,p$C=p$h.resultMatrix.d;var p$_=Math.atan2(p$C,p$r);(p$U=Math.atan2(p$$,p$f)-Math.atan2(p$g,p$q)-(p$_-Math.atan2(p$h.resultMatrix.c,p$h.resultMatrix.a)))>Math.PI?p$U-=2*Math.PI:p$U<-Math.PI&&(p$U+=2*Math.PI),p$U=p$_+(p$U+this._data.offsetShearY*Math.PI/180)*this.shearMix,p$l=Math.sqrt(p$r*p$r+p$C*p$C),p$h.resultMatrix.b=Math.cos(p$U)*p$l,p$h.resultMatrix.d=Math.sin(p$U)*p$l}}},p$h}(),p$Kh=function(){function p$h(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return p$g(p$h,"laya.ani.bone.TfConstraintData"),p$h}(),p$yh=function(){function p$h(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}p$g(p$h,"laya.ani.bone.Transform");var p$q=p$h.prototype;return p$q.initData=function(p$h){null!=p$h.x&&(this.x=p$h.x),null!=p$h.y&&(this.y=p$h.y),null!=p$h.skX&&(this.skX=p$h.skX),null!=p$h.skY&&(this.skY=p$h.skY),null!=p$h.scX&&(this.scX=p$h.scX),null!=p$h.scY&&(this.scY=p$h.scY)},p$q.getMatrix=function(){var p$h;return(p$h=this.mMatrix?this.mMatrix:this.mMatrix=new p$bh).identity(),p$h.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(p$h,this.skewX*Math.PI/180,this.skewY*Math.PI/180),p$h.rotate(this.skX*Math.PI/180),p$h.translate(this.x,this.y),p$h},p$q.skew=function(p$h,p$q,p$f){var p$g=Math.sin(p$f),p$$=Math.cos(p$f),p$P=Math.sin(p$q),p$S=Math.cos(p$q);return p$h.setTo(p$h.a*p$S-p$h.b*p$g,p$h.a*p$P+p$h.b*p$$,p$h.c*p$S-p$h.d*p$g,p$h.c*p$P+p$h.d*p$$,p$h.tx*p$S-p$h.ty*p$g,p$h.tx*p$P+p$h.ty*p$$),p$h},p$h}(),p$t=function(){function p$h(){}return p$g(p$h,"laya.ani.bone.UVTools"),p$h.getRelativeUV=function(p$h,p$q,p$f){var p$g=p$h[0],p$$=p$h[2]-p$h[0],p$P=p$h[1],p$S=p$h[5]-p$h[1];p$f||(p$f=[]),p$f.length=p$q.length;var p$B,p$r=0;p$B=p$f.length;var p$Y=1/p$$,p$C=1/p$S;for(p$r=0;p$r<p$B;p$r+=2)p$f[p$r]=(p$q[p$r]-p$g)*p$Y,p$f[p$r+1]=(p$q[p$r+1]-p$P)*p$C;return p$f},p$h.getAbsoluteUV=function(p$h,p$q,p$f){if(0==p$h[0]&&0==p$h[1]&&1==p$h[4]&&1==p$h[5])return p$f?(p$_.copyArray(p$f,p$q),p$f):p$q;var p$g=p$h[0],p$$=p$h[2]-p$h[0],p$P=p$h[1],p$S=p$h[5]-p$h[1];p$f||(p$f=[]),p$f.length=p$q.length;var p$B,p$r=0;for(p$B=p$f.length,p$r=0;p$r<p$B;p$r+=2)p$f[p$r]=p$q[p$r]*p$$+p$g,p$f[p$r+1]=p$q[p$r+1]*p$S+p$P;return p$f},p$h}(),p$z=function(){function p$h(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return p$g(p$h,"laya.ani.KeyFramesContent"),p$h}(),p$X=function(){function p$C(){}return p$g(p$C,"laya.ani.math.BezierLerp"),p$C.getBezierRate=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$C._getBezierParamKey(p$q,p$f,p$g,p$$),p$S=100*p$P+p$h;if(p$C._bezierResultCache[p$S])return p$C._bezierResultCache[p$S];var p$B,p$r=p$C._getBezierPoints(p$q,p$f,p$g,p$$,p$P),p$Y=0;for(p$B=p$r.length,p$Y=0;p$Y<p$B;p$Y+=2)if(p$h<=p$r[p$Y])return p$C._bezierResultCache[p$S]=p$r[p$Y+1],p$r[p$Y+1];return p$C._bezierResultCache[p$S]=1},p$C._getBezierParamKey=function(p$h,p$q,p$f,p$g){return 100*(100*(100*(100*p$h+p$q)+p$f)+p$g)},p$C._getBezierPoints=function(p$h,p$q,p$f,p$g,p$$){return p$C._bezierPointsCache[p$$]?p$C._bezierPointsCache[p$$]:(p$P=[0,0,p$h,p$q,p$f,p$g,1,1],p$S=(new p$B).getBezierPoints(p$P,100,3),p$C._bezierPointsCache[p$$]=p$S);var p$P,p$S},p$C._bezierResultCache={},p$C._bezierPointsCache={},p$C}(),p$n=function(p$h){function p$q(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,p$q.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}p$g(p$q,"laya.ani.AnimationPlayer",p$$);var p$f=p$q.prototype;return p$$h.imps(p$f,{"laya.resource.IDestroy":!0}),p$f._onTempletLoadedComputeFullKeyframeIndices=function(p$h,p$q,p$f){this._templet===p$f&&this._cachePlayRate===p$h&&this._cacheFrameRate===p$q&&this._computeFullKeyframeIndices()},p$f._computeFullKeyframeIndices=function(){for(var p$h=this._fullFrames=[],p$q=this._templet,p$f=this._cacheFrameRateInterval*this._cachePlayRate,p$g=0,p$$=p$q.getAnimationCount();p$g<p$$;p$g++){for(var p$P=[],p$S=0,p$B=p$q.getAnimation(p$g).nodes.length;p$S<p$B;p$S++){for(var p$r=p$q.getAnimation(p$g).nodes[p$S],p$Y=Math.floor(p$r.playTime/p$f+.01),p$C=new Uint16Array(p$Y+1),p$U=-1,p$u=0,p$v=p$r.keyFrame.length;p$u<p$v;p$u++){var p$L=p$r.keyFrame[p$u],p$e=p$L.startTime,p$l=p$e+p$L.duration+p$f;do{for(var p$_=Math.floor(p$e/p$f+.5),p$N=p$U+1;p$N<p$_;p$N++)p$C[p$N]=p$u;p$C[p$U=p$_]=p$u,p$e+=p$f}while(p$e<=p$l)}p$P.push(p$C)}p$h.push(p$P)}},p$f._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},p$f._calculatePlayDuration=function(){if(0!==this.state){var p$h=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=p$h),this._playEnd>p$h&&(this._playEnd=p$h),this._playDuration=this._playEnd-this._playStart}},p$f._setPlayParams=function(p$h,p$q){this._currentTime=p$h,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/p$q+.01),0),this._currentFrameTime=this._currentKeyframeIndex*p$q},p$f._setPlayParamsWhenStop=function(p$h,p$q){this._currentTime=p$h,this._currentKeyframeIndex=Math.max(Math.floor(p$h/p$q+.01),0),this._currentFrameTime=this._currentKeyframeIndex*p$q,this._currentAnimationClipIndex=-1},p$f._update=function(p$h){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var p$q=this._cacheFrameRateInterval*this._cachePlayRate,p$f=0;this._startUpdateLoopCount!==p$L.loopCount&&(p$f=p$h*this.playbackRate,this._elapsedPlaybackTime+=p$f);var p$g=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=p$g)return this._setPlayParamsWhenStop(p$g,p$q),void this.event("stopped");if(p$f+=this._currentTime,0<p$g)if(p$g<=p$f)do{if(p$f-=p$g,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(p$g,p$q),this._stopWhenCircleFinish=!1,void this.event("stopped");p$f<p$g&&(this._setPlayParams(p$f,p$q),this.event("complete"))}while(p$g<=p$f);else this._setPlayParams(p$f,p$q);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(p$g,p$q),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},p$f._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},p$f.play=function(p$h,p$q,p$f,p$g,p$$){if(void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=1),void 0===p$f&&(p$f=2147483647),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(p$f<0||p$g<0||p$$<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==p$$&&p$$<p$g)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=p$q,this._overallDuration=p$f,this._playStart=p$g,this._playEnd=p$$,this._paused=!1,this._currentAnimationClipIndex=p$h,this._currentKeyframeIndex=0,this._startUpdateLoopCount=p$L.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},p$f.playByFrame=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$h&&(p$h=0),void 0===p$q&&(p$q=1),void 0===p$f&&(p$f=2147483647),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=30);var p$S=1e3/p$P;this.play(p$h,p$q,p$f,p$g*p$S,p$$*p$S)},p$f.stop=function(p$h){void 0===p$h&&(p$h=!0),p$h?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},p$P(0,p$f,"playEnd",function(){return this._playEnd}),p$P(0,p$f,"templet",function(){return this._templet},function(p$h){0===!this.state&&this.stop(!0),this._templet!==p$h&&((this._templet=p$h).loaded?this._computeFullKeyframeIndices():p$h.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),p$P(0,p$f,"playStart",function(){return this._playStart}),p$P(0,p$f,"playDuration",function(){return this._playDuration}),p$P(0,p$f,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),p$P(0,p$f,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),p$P(0,p$f,"overallDuration",function(){return this._overallDuration}),p$P(0,p$f,"currentFrameTime",function(){return this._currentFrameTime}),p$P(0,p$f,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),p$P(0,p$f,"currentPlayTime",function(){return this._currentTime+this._playStart}),p$P(0,p$f,"cachePlayRate",function(){return this._cachePlayRate},function(p$h){this._cachePlayRate!==p$h&&(this._cachePlayRate=p$h,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[p$h,this._cacheFrameRate])))}),p$P(0,p$f,"cacheFrameRate",function(){return this._cacheFrameRate},function(p$h){this._cacheFrameRate!==p$h&&(this._cacheFrameRate=p$h,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,p$h])))}),p$P(0,p$f,"currentTime",null,function(p$h){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(p$h<this._playStart||p$h>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=p$L.loopCount;var p$q=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=p$h,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/p$q),0),this._currentFrameTime=this._currentKeyframeIndex*p$q}}),p$P(0,p$f,"paused",function(){return this._paused},function(p$h){(this._paused=p$h)&&this.event("paused")}),p$P(0,p$f,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),p$P(0,p$f,"destroyed",function(){return this._destroyed}),p$q}(),p$c=function(p$h){function p$q(){p$q.__super.call(this),p$l.isConchNode&&(this.drawSkin=function(p$h){p$h.transform||(p$h.transform=p$bh.EMPTY),this._addCmd([p$h]),this.setSkinMesh&&this.setSkinMesh(p$h._ps,p$h.mVBData,p$h.mEleNum,0,p$h.mTexture,p$h.transform)})}return p$g(p$q,"laya.ani.GraphicsAni",p$S),p$q.prototype.drawSkin=function(p$h){var p$q=[p$h];this._saveToCmd(p$l._context._drawSkin,p$q)},p$q.create=function(){return p$q._caches.pop()||new p$q},p$q.recycle=function(p$h){p$h.clear(),p$q._caches.push(p$h)},p$q._caches=[],p$q}(),p$M=function(p$h){function p$N(){this._aniMap={},this.unfixedLastAniIndex=-1,p$N.__super.call(this),this._anis=new Array}p$g(p$N,"laya.ani.AnimationTemplet",p$C);var p$q=p$N.prototype;return p$q.parse=function(p$h){var p$q=new p$dh(p$h);this._aniVersion=p$q.readUTFString(),p$G.parse(this,p$q)},p$q._calculateKeyFrame=function(p$h,p$q,p$f){var p$g=p$h.keyFrame;p$g[p$q]=p$g[0];for(var p$$=0;p$$<p$q;p$$++){var p$P=p$g[p$$];p$P.nextData=0===p$P.duration?p$P.data:p$g[p$$+1].data}p$g.length--},p$q.onAsynLoaded=function(p$h,p$q,p$f){var p$g=new p$dh(p$q);switch(this._aniVersion=p$g.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":p$m.parse(this,p$g);break;default:p$G.parse(this,p$g)}this._endLoaded()},p$q.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},p$q.getAnimationCount=function(){return this._anis.length},p$q.getAnimation=function(p$h){return this._anis[p$h]},p$q.getAniDuration=function(p$h){return this._anis[p$h].playTime},p$q.getNodes=function(p$h){return this._anis[p$h].nodes},p$q.getNodeIndexWithName=function(p$h,p$q){return this._anis[p$h].bone3DMap[p$q]},p$q.getNodeCount=function(p$h){return this._anis[p$h].nodes.length},p$q.getTotalkeyframesLength=function(p$h){return this._anis[p$h].totalKeyframeDatasLength},p$q.getPublicExtData=function(){return this._publicExtData},p$q.getAnimationDataWithCache=function(p$h,p$q,p$f,p$g){var p$$=p$q[p$f];if(p$$){var p$P=p$$[p$h];return p$P?p$P[p$g]:null}return null},p$q.setAnimationDataWithCache=function(p$h,p$q,p$f,p$g,p$$){var p$P=p$q[p$f]||(p$q[p$f]={});(p$P[p$h]||(p$P[p$h]=[]))[p$g]=p$$},p$q.getOriginalData=function(p$h,p$q,p$f,p$g,p$$){for(var p$P=this._anis[p$h].nodes,p$S=0,p$B=0,p$r=p$P.length,p$Y=0;p$B<p$r;p$B++){var p$C,p$U=p$P[p$B];p$C=p$U.keyFrame[p$f[p$B][p$g]],p$U.dataOffset=p$Y;var p$u=p$$-p$C.startTime,p$v=p$U.lerpType;if(p$v)switch(p$v){case 0:case 1:for(p$S=0;p$S<p$U.keyframeWidth;)p$S+=p$U.interpolationMethod[p$S](p$U,p$S,p$q,p$Y+p$S,p$C.data,p$u,null,p$C.duration,p$C.nextData);break;case 2:var p$L=p$C.interpolationData,p$e=p$L.length,p$l=0;for(p$S=0;p$S<p$e;){var p$_=p$L[p$S];switch(p$_){case 6:case 7:p$S+=p$N.interpolation[p$_](p$U,p$l,p$q,p$Y+p$l,p$C.data,p$u,null,p$C.duration,p$C.nextData,p$L,p$S+1);break;default:p$S+=p$N.interpolation[p$_](p$U,p$l,p$q,p$Y+p$l,p$C.data,p$u,null,p$C.duration,p$C.nextData)}p$l++}}else for(p$S=0;p$S<p$U.keyframeWidth;)p$S+=p$U.interpolationMethod[p$S](p$U,p$S,p$q,p$Y+p$S,p$C.data,p$u,null,p$C.duration,p$C.nextData);p$Y+=p$U.keyframeWidth}},p$q.getNodesCurrentFrameIndex=function(p$h,p$q){var p$f=this._anis[p$h].nodes;p$h!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(p$f.length),this.unfixedCurrentTimes=new Float32Array(p$f.length),this.unfixedLastAniIndex=p$h);for(var p$g=0,p$$=p$f.length;p$g<p$$;p$g++){var p$P=p$f[p$g];for(p$q<this.unfixedCurrentTimes[p$g]&&(this.unfixedCurrentFrameIndexes[p$g]=0),this.unfixedCurrentTimes[p$g]=p$q;this.unfixedCurrentFrameIndexes[p$g]<p$P.keyFrame.length&&!(p$P.keyFrame[this.unfixedCurrentFrameIndexes[p$g]].startTime>this.unfixedCurrentTimes[p$g]);)this.unfixedCurrentFrameIndexes[p$g]++;this.unfixedCurrentFrameIndexes[p$g]--}return this.unfixedCurrentFrameIndexes},p$q.getOriginalDataUnfixedRate=function(p$h,p$q,p$f){var p$g=this._anis[p$h].nodes;p$h!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(p$g.length),this.unfixedCurrentTimes=new Float32Array(p$g.length),this.unfixedKeyframes=p$e(p$g.length),this.unfixedLastAniIndex=p$h);for(var p$$=0,p$P=0,p$S=p$g.length,p$B=0;p$P<p$S;p$P++){var p$r=p$g[p$P];for(p$f<this.unfixedCurrentTimes[p$P]&&(this.unfixedCurrentFrameIndexes[p$P]=0),this.unfixedCurrentTimes[p$P]=p$f;this.unfixedCurrentFrameIndexes[p$P]<p$r.keyFrame.length&&!(p$r.keyFrame[this.unfixedCurrentFrameIndexes[p$P]].startTime>this.unfixedCurrentTimes[p$P]);)this.unfixedKeyframes[p$P]=p$r.keyFrame[this.unfixedCurrentFrameIndexes[p$P]],this.unfixedCurrentFrameIndexes[p$P]++;var p$Y=this.unfixedKeyframes[p$P];p$r.dataOffset=p$B;var p$C=p$f-p$Y.startTime;if(p$r.lerpType)switch(p$r.lerpType){case 0:case 1:for(p$$=0;p$$<p$r.keyframeWidth;)p$$+=p$r.interpolationMethod[p$$](p$r,p$$,p$q,p$B+p$$,p$Y.data,p$C,null,p$Y.duration,p$Y.nextData);break;case 2:var p$U=p$Y.interpolationData,p$u=p$U.length,p$v=0;for(p$$=0;p$$<p$u;){var p$L=p$U[p$$];switch(p$L){case 6:case 7:p$$+=p$N.interpolation[p$L](p$r,p$v,p$q,p$B+p$v,p$Y.data,p$C,null,p$Y.duration,p$Y.nextData,p$U,p$$+1);break;default:p$$+=p$N.interpolation[p$L](p$r,p$v,p$q,p$B+p$v,p$Y.data,p$C,null,p$Y.duration,p$Y.nextData)}p$v++}}else for(p$$=0;p$$<p$r.keyframeWidth;)p$$+=p$r.interpolationMethod[p$$](p$r,p$$,p$q,p$B+p$$,p$Y.data,p$C,null,p$Y.duration,p$Y.nextData);p$B+=p$r.keyframeWidth}},p$N._LinearInterpolation_0=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){var p$C=0===p$B?0:p$P/p$B;return p$f[p$g]=(1-p$C)*p$$[p$q]+p$C*p$r[p$q],1},p$N._QuaternionInterpolation_1=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){var p$C=0===p$B?0:p$P/p$B;return p$u.slerpQuaternionArray(p$$,p$q,p$r,p$q,p$C,p$f,p$g),4},p$N._AngleInterpolation_2=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){return 0},p$N._RadiansInterpolation_3=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){return 0},p$N._Matrix4x4Interpolation_4=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){for(var p$C=0;p$C<16;p$C++,p$q++)p$f[p$g+p$C]=p$$[p$q]+p$P*p$S[p$q];return 16},p$N._NoInterpolation_5=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y){return p$f[p$g]=p$$[p$q],1},p$N._BezierInterpolation_6=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C){return void 0===p$C&&(p$C=0),p$f[p$g]=p$$[p$q]+(p$r[p$q]-p$$[p$q])*p$X.getBezierRate(p$P/p$B,p$Y[p$C],p$Y[p$C+1],p$Y[p$C+2],p$Y[p$C+3]),5},p$N._BezierInterpolation_7=function(p$h,p$q,p$f,p$g,p$$,p$P,p$S,p$B,p$r,p$Y,p$C){return void 0===p$C&&(p$C=0),p$f[p$g]=p$Y[p$C+4]+p$Y[p$C+5]*p$X.getBezierRate((.001*p$P+p$Y[p$C+6])/p$Y[p$C+7],p$Y[p$C],p$Y[p$C+1],p$Y[p$C+2],p$Y[p$C+3]),9},p$N.load=function(p$h){return p$$h.loader.create(p$h,null,null,p$N)},p$N.interpolation=[p$N._LinearInterpolation_0,p$N._QuaternionInterpolation_1,p$N._AngleInterpolation_2,p$N._RadiansInterpolation_3,p$N._Matrix4x4Interpolation_4,p$N._NoInterpolation_5,p$N._BezierInterpolation_6,p$N._BezierInterpolation_7],p$N}(),p$J=function(p$q){function p$f(p$h,p$q){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,p$f.__super.call(this),void 0===p$q&&(p$q=0),p$h&&this.init(p$h,p$q)}p$g(p$f,"laya.ani.bone.Skeleton",p$q);var p$h=p$f.prototype;return p$h.init=function(p$h,p$q){void 0===p$q&&(p$q=0);var p$f,p$g,p$$,p$P=0,p$S=0;if(1==p$q)for(this._graphicsCache=[],p$P=0,p$S=p$h.getAnimationCount();p$P<p$S;p$P++)this._graphicsCache.push([]);if(this._yReverseMatrix=p$h.yReverseMatrix,this._aniMode=p$q,this._templet=p$h,this._player=new p$n,this._player.cacheFrameRate=p$h.rate,this._player.templet=p$h,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=p$h.mBoneArr,this._rootBone=p$h.mRootBone,this._aniSectionDic=p$h.aniSectionDic,0<p$h.ikArr.length)for(this._ikArr=[],p$P=0,p$S=p$h.ikArr.length;p$P<p$S;p$P++)this._ikArr.push(new p$N(p$h.ikArr[p$P],this._boneList));if(0<p$h.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),p$P=0,p$S=p$h.pathArr.length;p$P<p$S;p$P++)p$f=p$h.pathArr[p$P],p$g=new p$E(p$f,this._boneList),(p$$=this._boneSlotDic[p$f.name])&&((p$g=new p$E(p$f,this._boneList)).target=p$$),this._pathDic[p$f.name]=p$g;if(0<p$h.tfArr.length)for(this._tfArr=[],p$P=0,p$S=p$h.tfArr.length;p$P<p$S;p$P++)this._tfArr.push(new p$R(p$h.tfArr[p$P],this._boneList));if(0<p$h.skinDataArray.length){var p$B=this._templet.skinDataArray[this._skinIndex];this._skinName=p$B.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},p$h.load=function(p$h,p$q,p$f){},p$h._onLoaded=function(){},p$h._parseComplete=function(){var p$h=p$p.TEMPLET_DICTIONARY[this._aniPath];p$h&&(this.init(p$h,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},p$h._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},p$h._onPlay=function(){this.event("played")},p$h._onStop=function(){var p$h,p$q=this._templet.eventAniArr[this._aniClipIndex];if(p$q&&this._eventIndex<p$q.length)for(;this._eventIndex<p$q.length;this._eventIndex++)(p$h=p$q[this._eventIndex]).time>=this._player.playStart&&p$h.time<=this._player.playEnd&&this.event("label",p$h);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},p$h._onPause=function(){this.event("paused")},p$h._parseSrcBoneMatrix=function(){var p$h=0,p$q=0;for(p$q=this._templet.srcBoneMatrixArr.length,p$h=0;p$h<p$q;p$h++)this._boneMatrixArray.push(new p$bh);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var p$f,p$g,p$$=this._templet.boneSlotArray;for(p$h=0,p$q=p$$.length;p$h<p$q;p$h++)p$f=p$$[p$h],null==(p$g=this._bindBoneBoneSlotDic[p$f.parent])&&(this._bindBoneBoneSlotDic[p$f.parent]=p$g=[]),this._boneSlotDic[p$f.name]=p$f=p$f.copy(),p$g.push(p$f),this._boneSlotArray.push(p$f)}},p$h._emitMissedEvents=function(p$h,p$q,p$f){void 0===p$f&&(p$f=0);var p$g=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(p$g){var p$$,p$P,p$S=0;for(p$$=p$g.length,p$S=p$f;p$S<p$$;p$S++)(p$P=p$g[p$S]).time>=this._player.playStart&&p$P.time<=this._player.playEnd&&this.event("label",p$P)}},p$h._update=function(p$h){if(void 0===p$h&&(p$h=!0),!(this._pause||p$h&&this._indexControl)){var p$q=this.timer.currTimer,p$f=this._player.currentKeyframeIndex,p$g=p$q-this._lastTime;if(p$h?this._player._update(p$g):p$f=-1,this._lastTime=p$q,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<p$g&&this._clipIndex==p$f&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var p$$;this._lastUpdateAniClipIndex=this._aniClipIndex,p$f>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var p$P,p$S=this._templet.eventAniArr[this._aniClipIndex];if(p$S&&this._eventIndex<p$S.length&&((p$$=p$S[this._eventIndex]).time>=this._player.playStart&&p$$.time<=this._player.playEnd?this._player.currentPlayTime>=p$$.time&&(this.event("label",p$$),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(p$P=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=p$P&&(this.graphics=p$P));var p$B=0,p$r=0;for(p$r=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,p$r-1)&&0<p$r;)p$r--;if(p$r<this._clipIndex)for(p$B=p$r;p$B<this._clipIndex;p$B++)this._createGraphics(p$B)}else if(1==this._aniMode){if(p$P=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=p$P&&(this.graphics=p$P));for(p$r=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,p$r-1)&&0<p$r;)p$r--;if(p$r<this._clipIndex)for(p$B=p$r;p$B<this._clipIndex;p$B++)this._createGraphics(p$B)}this._createGraphics()}}},p$h._createGraphics=function(p$h){void 0===p$h&&(p$h=-1),-1==p$h&&(p$h=this._clipIndex);var p$q,p$f,p$g=p$h*this._player.cacheFrameRateInterval,p$$=this._templet.drawOrderAniArr[this._aniClipIndex];if(p$$&&0<p$$.length)for(this._drawOrderIndex=0,p$q=p$$[this._drawOrderIndex];p$g>=p$q.time&&(this._drawOrder=p$q.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=p$$.length));)p$q=p$$[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=p$c.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=p$c.create(),p$f=this.graphics;var p$P=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],p$h,p$g);var p$S,p$B,p$r,p$Y,p$C=this._aniSectionDic[this._aniClipIndex],p$U=0,p$u=0,p$v=0,p$L=0,p$e=0,p$l=this._templet.srcBoneMatrixArr.length;for(p$e=p$C[p$u=0];p$u<p$l;p$u++)p$Y=this._boneList[p$u],p$r=this._templet.srcBoneMatrixArr[p$u],p$Y.resultTransform.scX=p$r.scX*this._curOriginalData[p$U++],p$Y.resultTransform.skX=p$r.skX+this._curOriginalData[p$U++],p$Y.resultTransform.skY=p$r.skY+this._curOriginalData[p$U++],p$Y.resultTransform.scY=p$r.scY*this._curOriginalData[p$U++],p$Y.resultTransform.x=p$r.x+this._curOriginalData[p$U++],p$Y.resultTransform.y=p$r.y+this._curOriginalData[p$U++],8===this._templet.tMatrixDataLen&&(p$Y.resultTransform.skewX=p$r.skewX+this._curOriginalData[p$U++],p$Y.resultTransform.skewY=p$r.skewY+this._curOriginalData[p$U++]);var p$_,p$N={},p$G={};for(p$e+=p$C[1];p$u<p$e;p$u++)p$N[(p$_=p$P[p$u]).name]=this._curOriginalData[p$U++],p$G[p$_.name]=this._curOriginalData[p$U++],this._curOriginalData[p$U++],this._curOriginalData[p$U++],this._curOriginalData[p$U++],this._curOriginalData[p$U++];var p$m,p$E,p$R={},p$t={};for(p$e+=p$C[2];p$u<p$e;p$u++)p$R[(p$_=p$P[p$u]).name]=this._curOriginalData[p$U++],p$t[p$_.name]=this._curOriginalData[p$U++],this._curOriginalData[p$U++],this._curOriginalData[p$U++],this._curOriginalData[p$U++],this._curOriginalData[p$U++];if(this._pathDic)for(p$e+=p$C[3];p$u<p$e;p$u++){if(p$_=p$P[p$u],p$m=this._pathDic[p$_.name])switch(new p$dh(p$_.extenData).getByte()){case 1:p$m.position=this._curOriginalData[p$U++];break;case 2:p$m.spacing=this._curOriginalData[p$U++];break;case 3:p$m.rotateMix=this._curOriginalData[p$U++],p$m.translateMix=this._curOriginalData[p$U++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(p$bh.TEMP.identity()),this._ikArr)for(p$u=0,p$e=this._ikArr.length;p$u<p$e;p$u++)p$E=this._ikArr[p$u],p$R.hasOwnProperty(p$E.name)&&(p$E.bendDirection=p$R[p$E.name]),p$t.hasOwnProperty(p$E.name)&&(p$E.mix=p$t[p$E.name]),p$E.apply();if(this._pathDic)for(var p$X in this._pathDic)(p$m=this._pathDic[p$X]).apply(this._boneList,p$f);if(this._tfArr)for(p$u=0,p$L=this._tfArr.length;p$u<p$L;p$u++)this._tfArr[p$u].apply();for(p$u=0,p$L=this._boneList.length;p$u<p$L;p$u++)if(p$Y=this._boneList[p$u],p$B=this._bindBoneBoneSlotDic[p$Y.name],p$Y.resultMatrix.copyTo(this._boneMatrixArray[p$u]),p$B)for(p$v=0,p$e=p$B.length;p$v<p$e;p$v++)(p$S=p$B[p$v])&&p$S.setParentMatrix(p$Y.resultMatrix);var p$n,p$J,p$p,p$A,p$d={},p$b=this._templet.deformAniArr;if(p$b&&0<p$b.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,p$u=0,p$e=this._boneSlotArray.length;p$u<p$e;p$u++)(p$S=this._boneSlotArray[p$u]).deformData=null;var p$i,p$z=p$b[this._aniClipIndex];for(p$i in p$n=p$z.default,this._setDeform(p$n,p$d,this._boneSlotArray,p$g),p$z)"default"!=p$i&&p$i!=this._skinName&&(p$n=p$z[p$i],this._setDeform(p$n,p$d,this._boneSlotArray,p$g));p$n=p$z[this._skinName],this._setDeform(p$n,p$d,this._boneSlotArray,p$g)}if(this._drawOrder)for(p$u=0,p$e=this._drawOrder.length;p$u<p$e;p$u++)p$J=p$N[(p$S=this._boneSlotArray[this._drawOrder[p$u]]).name],p$p=p$G[p$S.name],isNaN(p$p)||(p$f.save(),p$f.alpha(p$p)),isNaN(p$J)||-2==p$J||(this._templet.attachmentNames?p$S.showDisplayByName(this._templet.attachmentNames[p$J]):p$S.showDisplayByIndex(p$J)),p$d[this._drawOrder[p$u]]?(p$A=p$d[this._drawOrder[p$u]],p$S.currDisplayData&&p$A[p$S.currDisplayData.attachmentName]?p$S.deformData=p$A[p$S.currDisplayData.attachmentName]:p$S.deformData=null):p$S.deformData=null,isNaN(p$p)?p$S.draw(p$f,this._boneMatrixArray,2==this._aniMode):p$S.draw(p$f,this._boneMatrixArray,2==this._aniMode,p$p),isNaN(p$p)||p$f.restore();else for(p$u=0,p$e=this._boneSlotArray.length;p$u<p$e;p$u++)p$J=p$N[(p$S=this._boneSlotArray[p$u]).name],p$p=p$G[p$S.name],isNaN(p$p)||(p$f.save(),p$f.alpha(p$p)),isNaN(p$J)||-2==p$J||(this._templet.attachmentNames?p$S.showDisplayByName(this._templet.attachmentNames[p$J]):p$S.showDisplayByIndex(p$J)),p$d[p$u]?(p$A=p$d[p$u],p$S.currDisplayData&&p$A[p$S.currDisplayData.attachmentName]?p$S.deformData=p$A[p$S.currDisplayData.attachmentName]:p$S.deformData=null):p$S.deformData=null,isNaN(p$p)?p$S.draw(p$f,this._boneMatrixArray,2==this._aniMode):p$S.draw(p$f,this._boneMatrixArray,2==this._aniMode,p$p),isNaN(p$p)||p$f.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,p$h,p$f):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,p$h,p$f)},p$h._setDeform=function(p$h,p$q,p$f,p$g){if(p$h){var p$$,p$P,p$S,p$B=0,p$r=0,p$Y=0;if(p$h)for(p$B=0,p$r=p$h.deformSlotDataList.length;p$B<p$r;p$B++)for(p$$=p$h.deformSlotDataList[p$B],p$Y=0;p$Y<p$$.deformSlotDisplayList.length;p$Y++)p$S=p$f[(p$P=p$$.deformSlotDisplayList[p$Y]).slotIndex],p$P.apply(p$g,p$S),p$q[p$P.slotIndex]||(p$q[p$P.slotIndex]={}),p$q[p$P.slotIndex][p$P.attachment]=p$P.deformData}},p$h.getAnimNum=function(){return this._templet.getAnimationCount()},p$h.getAniNameByIndex=function(p$h){return this._templet.getAniNameByIndex(p$h)},p$h.getSlotByName=function(p$h){return this._boneSlotDic[p$h]},p$h.showSkinByName=function(p$h,p$q){void 0===p$q&&(p$q=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(p$h),p$q)},p$h.showSkinByIndex=function(p$h,p$q){void 0===p$q&&(p$q=!0);for(var p$f=0;p$f<this._boneSlotArray.length;p$f++)this._boneSlotArray[p$f].showSlotData(null,p$q);if(this._templet.showSkinByIndex(this._boneSlotDic,p$h,p$q)){var p$g=this._templet.skinDataArray[p$h];this._skinIndex=p$h,this._skinName=p$g.name}this._clearCache()},p$h.showSlotSkinByIndex=function(p$h,p$q){if(0!=this._aniMode){var p$f=this.getSlotByName(p$h);p$f&&p$f.showDisplayByIndex(p$q),this._clearCache()}},p$h.showSlotSkinByName=function(p$h,p$q){if(0!=this._aniMode){var p$f=this.getSlotByName(p$h);p$f&&p$f.showDisplayByName(p$q),this._clearCache()}},p$h.replaceSlotSkinName=function(p$h,p$q,p$f){if(0!=this._aniMode){var p$g=this.getSlotByName(p$h);p$g&&p$g.replaceDisplayByName(p$q,p$f),this._clearCache()}},p$h.replaceSlotSkinByIndex=function(p$h,p$q,p$f){if(0!=this._aniMode){var p$g=this.getSlotByName(p$h);p$g&&p$g.replaceDisplayByIndex(p$q,p$f),this._clearCache()}},p$h.setSlotSkin=function(p$h,p$q){if(0!=this._aniMode){var p$f=this.getSlotByName(p$h);p$f&&p$f.replaceSkin(p$q),this._clearCache()}},p$h._clearCache=function(){if(1==this._aniMode)for(var p$h=0,p$q=this._graphicsCache.length;p$h<p$q;p$h++){for(var p$f=0,p$g=this._graphicsCache[p$h].length;p$f<p$g;p$f++){var p$$=this._graphicsCache[p$h][p$f];p$$!=this.graphics&&p$c.recycle(p$$)}this._graphicsCache[p$h].length=0}},p$h.play=function(p$h,p$q,p$f,p$g,p$$,p$P){void 0===p$f&&(p$f=!0),void 0===p$g&&(p$g=0),void 0===p$$&&(p$$=0),void 0===p$P&&(p$P=!0),this._indexControl=!1;var p$S=-1,p$B=NaN;if(p$B=p$q?2147483647:0,"string"==typeof p$h)for(var p$r=0,p$Y=this._templet.getAnimationCount();p$r<p$Y;p$r++){var p$C=this._templet.getAnimation(p$r);if(p$C&&p$h==p$C.name){p$S=p$r;break}}else p$S=p$h;-1<p$S&&p$S<this.getAnimNum()&&(this._aniClipIndex=p$S,(p$f||this._pause||this._currAniIndex!=p$S)&&(this._currAniIndex=p$S,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(p$S)),this._drawOrder=null,this._eventIndex=0,this._player.play(p$S,this._player.playbackRate,p$B,p$g,p$$),p$P&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=p$U.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},p$h.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},p$h.playbackRate=function(p$h){this._player&&(this._player.playbackRate=p$h)},p$h.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},p$h.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=p$U.now(),this.timer.frameLoop(1,this,this._update,null,!0))},p$h._getGrahicsDataWithCache=function(p$h,p$q){return this._graphicsCache[p$h][p$q]},p$h._setGrahicsDataWithCache=function(p$h,p$q,p$f){this._graphicsCache[p$h][p$q]=p$f},p$h.destroy=function(p$h){void 0===p$h&&(p$h=!0),p$q.prototype.destroy.call(this,p$h),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},p$P(0,p$h,"url",function(){return this._aniPath},function(p$h){this.load(p$h)}),p$P(0,p$h,"index",function(){return this._index},function(p$h){this.player&&(this._index=p$h,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),p$P(0,p$h,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),p$P(0,p$h,"templet",function(){return this._templet}),p$P(0,p$h,"player",function(){return this._player}),p$f.useSimpleMeshInCanvas=!1,p$f}(p$Ph),p$p=function(p$q){function p$$(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,p$$.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}p$g(p$$,"laya.ani.bone.Templet",p$q);var p$h=p$$.prototype;return p$h.getLoadList=function(){return this._loadList},p$h.loadAni=function(p$h){this._skBufferUrl=p$h,p$$h.loader.load(p$h,p$r.create(this,this.onComplete),null,"arraybuffer")},p$h.onComplete=function(p$h){if(this._isDestroyed)this.destroy();else{var p$q=p$Y.getRes(this._skBufferUrl);p$q?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,p$q)):this.event("error","load failed:"+this._skBufferUrl)}},p$h.parseData=function(p$h,p$q,p$f){void 0===p$f&&(p$f=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=p$h,this._mainTexture&&p$l.isWebGL&&p$h.bitmap&&(p$h.bitmap.enableMerageInAtlas=!1),this._rate=p$f,this.parse(p$q)},p$h.buildArmature=function(p$h){return void 0===p$h&&(p$h=0),new p$J(this,p$h)},p$h.parse=function(p$h){p$q.prototype.parse.call(this,p$h),this._endLoaded(),this._aniVersion!=p$$.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+p$$.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},p$h._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var p$h=0;this._loadList=[];var p$q,p$f=new p$dh(this.getPublicExtData()),p$g=0,p$$=0,p$P=0,p$S=p$f.getInt32(),p$B=p$f.readUTFString(),p$r=p$B.split("\n");for(p$h=0;p$h<p$S;p$h++)p$q=this._path+p$r[2*p$h],p$B=p$r[2*p$h+1],p$f.getFloat32(),p$f.getFloat32(),p$g=p$f.getFloat32(),p$$=p$f.getFloat32(),p$P=p$f.getFloat32(),isNaN(p$P)?0:p$P,p$P=p$f.getFloat32(),isNaN(p$P)?0:p$P,p$P=p$f.getFloat32(),isNaN(p$P)?p$g:p$P,p$P=p$f.getFloat32(),isNaN(p$P)?p$$:p$P,-1==this._loadList.indexOf(p$q)&&this._loadList.push(p$q);this.event("inited",this)}},p$h._textureComplete=function(){for(var p$h,p$q,p$f=0,p$g=this._loadList.length;p$f<p$g;p$f++)p$q=this._loadList[p$f],p$h=this._textureDic[p$q]=p$Y.getRes(p$q),p$l.isWebGL&&p$h&&p$h.bitmap&&(p$h.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},p$h._parsePublicExtData=function(){var p$h=0,p$q=0,p$f=0,p$g=0,p$$=0;for(p$h=0,p$$=this.getAnimationCount();p$h<p$$;p$h++)this._graphicsCache.push([]);var p$P;p$P="Dragon"!=this._aniClassName;var p$S,p$B,p$r=new p$dh(this.getPublicExtData()),p$Y=0,p$C=0,p$U=0,p$u=0,p$v=0,p$L=0,p$e=0,p$l=0,p$_=0,p$N=p$r.getInt32(),p$G=p$r.readUTFString(),p$m=p$G.split("\n");for(p$h=0;p$h<p$N;p$h++){if(p$S=this._mainTexture,p$B=this._path+p$m[2*p$h],p$G=p$m[2*p$h+1],null==this._mainTexture&&(p$S=this._textureDic[p$B]),!p$S)return this.event("error",this),void(this.isParseFail=!0);p$Y=p$r.getFloat32(),p$C=p$r.getFloat32(),p$U=p$r.getFloat32(),p$u=p$r.getFloat32(),p$_=p$r.getFloat32(),p$v=isNaN(p$_)?0:p$_,p$_=p$r.getFloat32(),p$L=isNaN(p$_)?0:p$_,p$_=p$r.getFloat32(),p$e=isNaN(p$_)?p$U:p$_,p$_=p$r.getFloat32(),p$l=isNaN(p$_)?p$u:p$_,this.subTextureDic[p$G]=p$ih.create(p$S,p$Y,p$C,p$U,p$u,-p$v,-p$L,p$e,p$l),p$S.alphaTexture&&(this.subTextureDic[p$G].alphaTexture=p$ih.create(p$S.alphaTexture,p$Y,p$C,p$U,p$u,-p$v,-p$L,p$e,p$l))}this._mainTexture=p$S;var p$E,p$R,p$t,p$X,p$n,p$J=p$r.getUint16();for(p$h=0;p$h<p$J;p$h++)(p$E=[]).push(p$r.getUint16()),p$E.push(p$r.getUint16()),p$E.push(p$r.getUint16()),p$E.push(p$r.getUint16()),this.aniSectionDic[p$h]=p$E;var p$p,p$A=p$r.getInt16(),p$d={};for(p$h=0;p$h<p$A;p$h++)p$R=new p$zh,0==p$h?p$p=p$R:p$R.root=p$p,p$R.d=p$P?-1:1,p$X=p$r.readUTFString(),p$n=p$r.readUTFString(),p$R.length=p$r.getFloat32(),1==p$r.getByte()&&(p$R.inheritRotation=!1),1==p$r.getByte()&&(p$R.inheritScale=!1),p$R.name=p$X,p$n&&((p$t=p$d[p$n])?p$t.addChild(p$R):this.mRootBone=p$R),p$d[p$X]=p$R,this.mBoneArr.push(p$R);this.tMatrixDataLen=p$r.getUint16();var p$b,p$i,p$z=p$r.getUint16(),p$c=Math.floor(p$z/this.tMatrixDataLen),p$M=this.srcBoneMatrixArr;for(p$h=0;p$h<p$c;p$h++)(p$b=new p$yh).scX=p$r.getFloat32(),p$b.skX=p$r.getFloat32(),p$b.skY=p$r.getFloat32(),p$b.scY=p$r.getFloat32(),p$b.x=p$r.getFloat32(),p$b.y=p$r.getFloat32(),8===this.tMatrixDataLen&&(p$b.skewX=p$r.getFloat32(),p$b.skewY=p$r.getFloat32()),p$M.push(p$b),(p$R=this.mBoneArr[p$h]).transform=p$b;var p$W,p$T=p$r.getUint16(),p$I=0;for(p$h=0;p$h<p$T;p$h++){for(p$i=new p$kh,p$I=p$r.getUint16(),p$q=0;p$q<p$I;p$q++)p$i.boneNames.push(p$r.readUTFString()),p$i.boneIndexs.push(p$r.getInt16());p$i.name=p$r.readUTFString(),p$i.targetBoneName=p$r.readUTFString(),p$i.targetBoneIndex=p$r.getInt16(),p$i.bendDirection=p$r.getFloat32(),p$i.mix=p$r.getFloat32(),p$i.isSpine=p$P,this.ikArr.push(p$i)}var p$w,p$k=p$r.getUint16(),p$H=0;for(p$h=0;p$h<p$k;p$h++){for(p$W=new p$Kh,p$H=p$r.getUint16(),p$q=0;p$q<p$H;p$q++)p$W.boneIndexs.push(p$r.getInt16());p$W.name=p$r.getUTFString(),p$W.targetIndex=p$r.getInt16(),p$W.rotateMix=p$r.getFloat32(),p$W.translateMix=p$r.getFloat32(),p$W.scaleMix=p$r.getFloat32(),p$W.shearMix=p$r.getFloat32(),p$W.offsetRotation=p$r.getFloat32(),p$W.offsetX=p$r.getFloat32(),p$W.offsetY=p$r.getFloat32(),p$W.offsetScaleX=p$r.getFloat32(),p$W.offsetScaleY=p$r.getFloat32(),p$W.offsetShearY=p$r.getFloat32(),this.tfArr.push(p$W)}var p$D=p$r.getUint16(),p$s=0;for(p$h=0;p$h<p$D;p$h++){for((p$w=new p$Hh).name=p$r.readUTFString(),p$s=p$r.getUint16(),p$q=0;p$q<p$s;p$q++)p$w.bones.push(p$r.getInt16());p$w.target=p$r.readUTFString(),p$w.positionMode=p$r.readUTFString(),p$w.spacingMode=p$r.readUTFString(),p$w.rotateMode=p$r.readUTFString(),p$w.offsetRotation=p$r.getFloat32(),p$w.position=p$r.getFloat32(),p$w.spacing=p$r.getFloat32(),p$w.rotateMix=p$r.getFloat32(),p$w.translateMix=p$r.getFloat32(),this.pathArr.push(p$w)}var p$V,p$K,p$y,p$F,p$Z,p$Q=0,p$o=0,p$O=0,p$j=NaN,p$x=0,p$a=p$r.getInt16();for(p$h=0;p$h<p$a;p$h++){var p$hh=p$r.getUint8(),p$qh={};this.deformAniArr.push(p$qh);for(var p$fh=0;p$fh<p$hh;p$fh++)for((p$V=new p$Mh).skinName=p$r.getUTFString(),p$qh[p$V.skinName]=p$V,p$Q=p$r.getInt16(),p$q=0;p$q<p$Q;p$q++)for(p$K=new p$Wh,p$V.deformSlotDataList.push(p$K),p$o=p$r.getInt16(),p$f=0;p$f<p$o;p$f++)for(p$y=new p$Th,p$K.deformSlotDisplayList.push(p$y),p$y.slotIndex=p$r.getInt16(),p$y.attachment=p$r.getUTFString(),p$O=p$r.getInt16(),p$g=0;p$g<p$O;p$g++)for(1==p$r.getByte()?p$y.tweenKeyList.push(!0):p$y.tweenKeyList.push(!1),p$j=p$r.getFloat32(),p$y.timeList.push(p$j),p$F=[],p$y.vectices.push(p$F),p$x=p$r.getInt16(),p$$=0;p$$<p$x;p$$++)p$F.push(p$r.getFloat32())}var p$gh,p$$h,p$Ph=p$r.getInt16(),p$Sh=0,p$Bh=0;for(p$h=0;p$h<p$Ph;p$h++){for(p$Sh=p$r.getInt16(),p$Z=[],p$q=0;p$q<p$Sh;p$q++){for((p$gh=new p$Ih).time=p$r.getFloat32(),p$Bh=p$r.getInt16(),p$f=0;p$f<p$Bh;p$f++)p$gh.drawOrder.push(p$r.getInt16());p$Z.push(p$gh)}this.drawOrderAniArr.push(p$Z)}var p$rh,p$Yh=p$r.getInt16(),p$Ch=0;for(p$h=0;p$h<p$Yh;p$h++){for(p$Ch=p$r.getInt16(),p$$h=[],p$q=0;p$q<p$Ch;p$q++)(p$rh=new p$wh).name=p$r.getUTFString(),p$rh.intValue=p$r.getInt32(),p$rh.floatValue=p$r.getFloat32(),p$rh.stringValue=p$r.getUTFString(),p$rh.time=p$r.getFloat32(),p$$h.push(p$rh);this.eventAniArr.push(p$$h)}var p$Uh=p$r.getInt16();if(0<p$Uh)for(this.attachmentNames=[],p$h=0;p$h<p$Uh;p$h++)this.attachmentNames.push(p$r.getUTFString());var p$uh,p$vh,p$Lh=p$r.getInt16();for(p$h=0;p$h<p$Lh;p$h++)(p$uh=new p$ch).name=p$r.readUTFString(),p$uh.parent=p$r.readUTFString(),p$uh.attachmentName=p$r.readUTFString(),p$uh.srcDisplayIndex=p$uh.displayIndex=p$r.getInt16(),(p$uh.templet=this).boneSlotDic[p$uh.name]=p$uh,null==(p$vh=this.bindBoneBoneSlotDic[p$uh.parent])&&(this.bindBoneBoneSlotDic[p$uh.parent]=p$vh=[]),p$vh.push(p$uh),this.boneSlotArray.push(p$uh);var p$eh,p$lh,p$_h,p$Nh=p$r.readUTFString().split("\n"),p$Gh=0,p$mh=p$r.getUint8(),p$Eh=0,p$Rh=0,p$th=0,p$Xh=0,p$nh=0,p$Jh=0,p$ph=0;for(p$h=0;p$h<p$mh;p$h++){for((p$eh=new p$Dh).name=p$Nh[p$Gh++],p$Eh=p$r.getUint8(),p$q=0;p$q<p$Eh;p$q++){for((p$lh=new p$Vh).name=p$Nh[p$Gh++],p$uh=this.boneSlotDic[p$lh.name],p$Rh=p$r.getUint8(),p$f=0;p$f<p$Rh;p$f++){if(p$_h=new p$sh,this.skinSlotDisplayDataArr.push(p$_h),p$_h.name=p$Nh[p$Gh++],p$_h.attachmentName=p$Nh[p$Gh++],p$_h.transform=new p$yh,p$_h.transform.scX=p$r.getFloat32(),p$_h.transform.skX=p$r.getFloat32(),p$_h.transform.skY=p$r.getFloat32(),p$_h.transform.scY=p$r.getFloat32(),p$_h.transform.x=p$r.getFloat32(),p$_h.transform.y=p$r.getFloat32(),p$lh.displayArr.push(p$_h),p$_h.width=p$r.getFloat32(),p$_h.height=p$r.getFloat32(),p$_h.type=p$r.getUint8(),p$_h.verLen=p$r.getUint16(),0<(p$A=p$r.getUint16()))for(p$_h.bones=[],p$g=0;p$g<p$A;p$g++){var p$Ah=p$r.getUint16();p$_h.bones.push(p$Ah)}if(0<(p$th=p$r.getUint16()))for(p$_h.uvs=[],p$g=0;p$g<p$th;p$g++)p$_h.uvs.push(p$r.getFloat32());if(0<(p$Xh=p$r.getUint16()))for(p$_h.weights=[],p$g=0;p$g<p$Xh;p$g++)p$_h.weights.push(p$r.getFloat32());if(0<(p$nh=p$r.getUint16()))for(p$_h.triangles=[],p$g=0;p$g<p$nh;p$g++)p$_h.triangles.push(p$r.getUint16());if(0<(p$Jh=p$r.getUint16()))for(p$_h.vertices=[],p$g=0;p$g<p$Jh;p$g++)p$_h.vertices.push(p$r.getFloat32());if(0<(p$ph=p$r.getUint16()))for(p$_h.lengths=[],p$g=0;p$g<p$ph;p$g++)p$_h.lengths.push(p$r.getFloat32())}p$eh.slotArr.push(p$lh)}this.skinDic[p$eh.name]=p$eh,this.skinDataArray.push(p$eh)}1==p$r.getUint8()?(this.yReverseMatrix=new p$bh(1,0,0,-1,0,0),p$p&&p$p.setTempMatrix(this.yReverseMatrix)):p$p&&p$p.setTempMatrix(new p$bh),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},p$h.getTexture=function(p$h){var p$q=this.subTextureDic[p$h];return p$q||(p$q=this.subTextureDic[p$h.substr(0,p$h.length-1)]),null==p$q?this._mainTexture:p$q},p$h.showSkinByIndex=function(p$h,p$q,p$f){if(void 0===p$f&&(p$f=!0),p$q<0&&p$q>=this.skinDataArray.length)return!1;var p$g,p$$,p$P=0,p$S=0,p$B=this.skinDataArray[p$q];if(p$B){for(p$P=0,p$S=p$B.slotArr.length;p$P<p$S;p$P++)(p$$=p$B.slotArr[p$P])&&(p$g=p$h[p$$.name])&&(p$g.showSlotData(p$$,p$f),p$f&&"undefined"!=p$g.attachmentName&&"null"!=p$g.attachmentName?p$g.showDisplayByName(p$g.attachmentName):p$g.showDisplayByIndex(p$g.displayIndex));return!0}return!1},p$h.getSkinIndexByName=function(p$h){for(var p$q=0,p$f=this.skinDataArray.length;p$q<p$f;p$q++)if(this.skinDataArray[p$q].name==p$h)return p$q;return-1},p$h.getGrahicsDataWithCache=function(p$h,p$q){return this._graphicsCache[p$h][p$q]},p$h.setGrahicsDataWithCache=function(p$h,p$q,p$f){this._graphicsCache[p$h][p$q]=p$f},p$h.destroy=function(){var p$h;for(var p$q in this._isDestroyed=!0,this.subTextureDic)(p$h=this.subTextureDic[p$q])&&p$h.destroy();for(p$q in this._textureDic)(p$h=this._textureDic[p$q])&&p$h.destroy();for(var p$f=0,p$g=this.skinSlotDisplayDataArr.length;p$f<p$g;p$f++)this.skinSlotDisplayDataArr[p$f].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete p$$.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},p$h.getAniNameByIndex=function(p$h){var p$q=this.getAnimation(p$h);return p$q?p$q.name:null},p$P(0,p$h,"rate",function(){return this._rate},function(p$h){this._rate=p$h}),p$$.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",p$$.TEMPLET_DICTIONARY=null,p$$}(p$M)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(p$h,p$q){"use strict";for(var p$f in Object.defineProperty(p$q,"__esModule",{value:!0}),Laya){var p$g=Laya[p$f];p$g&&p$g.__isclass&&(p$q[p$f]=p$g)}});