var Laya=window.Laya=function(pY,ph){var pC={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(ph,pq){return 1==arguments.length?pC.__presubstr.call(this,ph):pC.__presubstr.call(this,ph,0<pq?pq:this.length+pq)},__init:function(ph){ph.forEach(function(ph){ph.__init$&&ph.__init$()})},__isClass:function(ph){return ph&&(ph.__isclass||ph==Object||ph==String||ph==Array)},__newvec:function(ph,pq){var pf=[];pf.length=ph;for(var pg=0;pg<ph;pg++)pf[pg]=pq;return pf},__extend:function(ph,pq){for(var pf in pq)if(pq.hasOwnProperty(pf)){var pg=Object.getOwnPropertyDescriptor(pq,pf),p$=pg.get,pP=pg.set;p$||pP?p$&&pP?Object.defineProperty(ph,pf,pg):(p$&&Object.defineProperty(ph,pf,p$),pP&&Object.defineProperty(ph,pf,pP)):ph[pf]=pq[pf]}function pS(){pC.un(this,"constructor",ph)}pS.prototype=pq.prototype,ph.prototype=new pS,pC.un(ph.prototype,"__imps",pC.__copy({},pq.prototype.__imps))},__copy:function(ph,pq){if(!pq)return null;for(var pf in ph=ph||{},pq)ph[pf]=pq[pf];return ph},__package:function(ph,pq){if(!pC.__packages[ph]){pC.__packages[ph]=!0;var pf=pY,pg=ph.split(".");if(1<pg.length)for(var p$=0,pP=pg.length-1;p$<pP;p$++){var pS=pf[pg[p$]];pf=pS||(pf[pg[p$]]={})}pf[pg[pg.length-1]]||(pf[pg[pg.length-1]]=pq||{})}},__hasOwnProperty:function(ph,pq){return pq=pq||this,Object.hasOwnProperty.call(pq,ph)||function ph(pq,pf){if(Object.hasOwnProperty.call(pf.prototype,pq))return!0;var pg=pf.prototype.__super;return null==pg?null:ph(pq,pg)}(ph,pq.__class)},__typeof:function(ph,pq){if(!ph||!pq)return!1;if(pq===String)return"string"==typeof ph;if(pq===Number)return"number"==typeof ph;if(pq.__interface__)pq=pq.__interface__;else if("string"!=typeof pq)return ph instanceof pq;return ph.__imps&&ph.__imps[pq]||ph.__class==pq},__as:function(ph,pq){return this.__typeof(ph,pq)?ph:null},__int:function(ph){return ph?parseInt(ph):0},interface:function(ph,pq){pC.__package(ph,{});var pf=pC.__internals,pg=pf[ph]=pf[ph]||{self:ph};if(pq){var p$=pq.split(",");pg.extend=[];for(var pP=0;pP<p$.length;pP++){var pS=p$[pP];pf[pS]=pf[pS]||{self:pS},pg.extend.push(pf[pS])}}var pB=pY,pr=ph.split(".");for(pP=0;pP<pr.length-1;pP++)pB=pB[pr[pP]];pB[pr[pr.length-1]]={__interface__:ph}},class:function(ph,pq,pf,pg){if(pf&&pC.__extend(ph,pf),pq)if(pC.__package(pq,ph),pC.__classmap[pq]=ph,0<pq.indexOf(".")){if(0==pq.indexOf("laya.")){var p$=pq.split(".");pg=pg||p$[p$.length-1],pC[pg]&&console.log("Warning!,this class["+pg+"] already exist:",pC[pg]),pC[pg]=ph}}else"Main"==pq?pY.Main=ph:"MainWX"==pq?pY.MainWX=ph:(pC[pq]&&console.log("Error!,this class["+pq+"] already exist:",pC[pq]),pC[pq]=ph);var pP=pC.un,pS=ph.prototype;pP(pS,"hasOwnProperty",pC.__hasOwnProperty),pP(pS,"__class",ph),pP(pS,"__super",pf),pP(pS,"__className",pq),pP(ph,"__super",pf),pP(ph,"__className",pq),pP(ph,"__isclass",!0),pP(ph,"super",function(ph){this.__super.call(ph)})},imps:function(ph,pq){if(!pq)return null;var p$=ph.__imps||pC.un(ph,"__imps",{});function pP(ph){var pq,pf;if((pq=pC.__internals[ph])&&(p$[ph]=!0,pf=pq.extend))for(var pg=0;pg<pf.length;pg++)pP(pf[pg].self)}for(var pf in pq)pP(pf)},superSet:function(ph,pq,pf,pg){var p$=ph.prototype["_$set_"+pf];p$&&p$.call(pq,pg)},superGet:function(ph,pq,pf){var pg=ph.prototype["_$get_"+pf];return pg?pg.call(pq):null},getset:function(ph,pq,pf,pg,p$){ph?(pg&&(pq["_$GET_"+pf]=pg),p$&&(pq["_$SET_"+pf]=p$)):(pg&&pC.un(pq,"_$get_"+pf,pg),p$&&pC.un(pq,"_$set_"+pf,p$)),pg&&p$?Object.defineProperty(pq,pf,{get:pg,set:p$,enumerable:!1,configurable:!0}):(pg&&Object.defineProperty(pq,pf,{get:pg,enumerable:!1,configurable:!0}),p$&&Object.defineProperty(pq,pf,{set:p$,enumerable:!1,configurable:!0}))},static:function(pf,pg){for(var p$=0,ph=pg.length;p$<ph;p$+=2)if("length"==pg[p$])pf.length=pg[p$+1].call(pf);else{function pq(){var pq=pg[p$],ph=pg[p$+1];Object.defineProperty(pf,pq,{get:function(){return delete this[pq],this[pq]=ph.call(this)},set:function(ph){delete this[pq],this[pq]=ph},enumerable:!0,configurable:!0})}pq()}},un:function(ph,pq,pf){return pf||(pf=ph[pq]),pC.__propun.value=pf,Object.defineProperty(ph,pq,pC.__propun),pf},uns:function(pq,ph){ph.forEach(function(ph){pC.un(pq,ph)})}};return pY.console=pY.console||{log:function(){}},pY.trace=pY.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),pC}(window,document);!function(ph,pq,pf){pf.un,pf.uns,pf.static,pf.class,pf.getset,pf.__newvec}(window,document,Laya),function(pS,pq,pt){pt.un,pt.uns;var pr=pt.static,pe=pt.class,pC=pt.getset;pt.__newvec;pt.interface("laya.runtime.IMarket"),pt.interface("laya.filters.IFilter"),pt.interface("laya.display.ILayout"),pt.interface("laya.resource.IDispose"),pt.interface("laya.runtime.IPlatform"),pt.interface("laya.resource.IDestroy"),pt.interface("laya.runtime.IConchNode"),pt.interface("laya.filters.IFilterAction"),pt.interface("laya.runtime.ICPlatformClass"),pt.interface("laya.resource.ICreateResource"),pt.interface("laya.runtime.IConchRenderObject"),pt.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var pd=function(){function pP(){}return pe(pP,"laya.utils.RunDriver"),pP.FILTER_ACTIONS=[],pP.pixelRatio=-1,pP._charSizeTestDiv=null,pP.now=function(){return Date.now()},pP.getWindow=function(){return pS},pP.getPixelRatio=function(){if(pP.pixelRatio<0){var ph=pw.context,pq=ph.backingStorePixelRatio||ph.webkitBackingStorePixelRatio||ph.mozBackingStorePixelRatio||ph.msBackingStorePixelRatio||ph.oBackingStorePixelRatio||ph.backingStorePixelRatio||1;(pP.pixelRatio=(pw.window.devicePixelRatio||1)/pq)<1&&(pP.pixelRatio=1)}return pP.pixelRatio},pP.getIncludeStr=function(ph){return null},pP.createShaderCondition=function(ph){var pq="(function() {return "+ph+";})";return pt._runScript(pq)},pP.fontMap=[],pP.measureText=function(ph,pq){var pf=pP.hanzi.test(ph);if(pf&&pP.fontMap[pq])return pP.fontMap[pq];var pg=pw.context;pg.font=pq;var p$=pg.measureText(ph);return pf&&(pP.fontMap[pq]=p$),p$},pP.getWebGLContext=function(ph){},pP.beginFlush=function(){},pP.endFinish=function(){},pP.addToAtlas=null,pP.flashFlushImage=function(ph){},pP.drawToCanvas=function(ph,pq,pf,pg,p$,pP){var pS=pGh.create("2D"),pB=new pM(pf,pg,pS);return pW.renders[pq]._fun(ph,pB,p$,pP),pS},pP.createParticleTemplate2D=null,pP.createGLTextur=null,pP.createWebGLContext2D=null,pP.changeWebGLSize=function(ph,pq){},pP.createRenderSprite=function(ph,pq){return new pW(ph,pq)},pP.createFilterAction=function(ph){return new pG},pP.createGraphics=function(){return new pu},pP.clear=function(ph){pc._context.ctx.clear()},pP.cancelLoadByUrl=function(ph){},pP.clearAtlas=function(ph){},pP.isAtlas=function(ph){return!1},pP.addTextureToAtlas=function(ph){},pP.getTexturePixels=function(ph,pq,pf,pg,p$){return null},pP.skinAniSprite=function(){return null},pP.update3DLoop=function(){},pr(pP,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),pP}(),pg=(pC(1,pt,"alertGlobalError",null,function(ph){var pP=0;pw.window.onerror=ph?function(ph,pq,pf,pg,p$){pP++<5&&p$&&alert(p$.stack||p$)}:null}),pt.init=function(ph,pq,pf){for(var pg=[],p$=2,pP=arguments.length;p$<pP;p$++)pg.push(arguments[p$]);if(!pt._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=pt._arrayBufferSlice),pt._isinit=!0,pw.__init__(),pT.__init__(),pu.__init__(),pt.timer=new pQ,pt.scaleTimer=new pQ,pt.loader=new prh,px.__init__(),p$=0;for(var pS=pg.length;p$<pS;p$++)pg[p$].enable&&pg[p$].enable();return pv.__init__(),pB.__init__(),pI.__init__(),pH.beginCheck(),pt._currentStage=pt.stage=new p_h,pt.stage.conchModel&&pt.stage.conchModel.setRootNode(),pt._getUrlPath(),pt.render=new pc(0,0),pt.stage.size(ph,pq),pW.__init__(),pU.__init__(),pL.instance.__init__(pt.stage,pc.canvas),pEh.__init__(),pA.autoStopMusic=!0,pJ.__init__(),pc.canvas}},pt._getUrlPath=function(){var ph=pw.window.location,pq=ph.pathname;pq=pq&&":"==pq.charAt(2)?pq.substring(1):pq,pz.rootPath=pz.basePath=pz.getPath("file:"==ph.protocol?pq:ph.protocol+"//"+ph.host+ph.pathname)},pt._arrayBufferSlice=function(ph,pq){var pf=new Uint8Array(this,ph,pq-ph),pg=new Uint8Array(pf.length);return pg.set(pf),pg.buffer},pt._runScript=function(ph){return pw.window[pt._evcode](ph)},pt.stage=null,pt.timer=null,pt.scaleTimer=null,pt.loader=null,pt.version="1.8.6",pt.render=null,pt._currentStage=null,pt._isinit=!1,pt.isDebug=!1,pt.MiniAdpter={init:function(){pS.navigator&&pS.navigator.userAgent&&-1<pS.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},pr(pt,["conchMarket",function(){return this.conchMarket=pS.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=pS.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function ph(){}return pe(ph,"Config"),ph.WebGLTextCacheCount=500,ph.atlasEnable=!1,ph.showCanvasMark=!1,ph.animationInterval=50,ph.isAntialias=!1,ph.isAlpha=!1,ph.premultipliedAlpha=!0,ph.isStencil=!0,ph.preserveDrawingBuffer=!1,ph}()),pY=function(){function pY(){this._events=null}pe(pY,"laya.events.EventDispatcher");var ph=pY.prototype;return ph.hasListener=function(ph){return!!(this._events&&this._events[ph])},ph.event=function(ph,pq){if(!this._events||!this._events[ph])return!1;var pf=this._events[ph];if(pf.lock)pf.queue||(pf.queue=[]),pf.queue.push(pq);else{var pg;for(pf.lock=!0,pf.cursor=pf.head;pf.cursor;)pg=pf.cursor,pf.cursor=pg.next,pg.once&&pY.delNode(pf,pg),null!=pq?pg.args?pg.method.apply(pg.caller,pg.args.concat(pq)):pq instanceof Array?pg.method.apply(pg.caller,pq):pg.method.call(pg.caller,pq):pg.method.apply(pg.caller,pg.args),pg.once&&pY.recoverHandler(pg);pf.lock=!1,!pf.head&&this._events&&this._events[ph]==pf&&delete this._events[ph],pf.queue&&pf.queue.length&&this.event(ph,pf.queue.shift())}return!0},ph.on=function(ph,pq,pf,pg){return this._createListener(ph,pq,pf,pg,!1)},ph.once=function(ph,pq,pf,pg){return this._createListener(ph,pq,pf,pg,!0)},ph._createListener=function(ph,pq,pf,pg,p$,pP){void 0===pP&&(pP=!0),pP&&this.off(ph,pq,pf,p$);var pS=pY.createHandler(pq||this,pf,pg,p$);this._events||(this._events={});var pB=this._events,pr=pB[ph];return pr?pr.tail?(pS.prev=pr.tail,pr.tail.next=pS,pr.tail=pS):pr.head=pr.tail=pS:pB[ph]={head:pS,tail:pS,cursor:null,lock:!1},this},ph.off=function(ph,pq,pf,pg){if(void 0===pg&&(pg=!1),!this._events||!this._events[ph])return this;for(var p$=this._events[ph],pP=p$.head;pP;){if((!pq||pP.caller===pq)&&pP.method===pf&&(!pg||pP.once)){pY.delNode(p$,pP),p$.cursor==pP&&(p$.cursor=pP.next),pY.recoverHandler(pP);break}pP=pP.next}return this},ph.offAll=function(ph){var pq=this._events;if(!pq)return this;if(ph)this._recoverHandlers(pq[ph]),delete pq[ph];else{for(var pf in pq)this._recoverHandlers(pq[pf]);this._events=null}return this},ph._recoverHandlers=function(ph){if(ph){for(var pq=ph.head;pq;){pY.delNode(ph,pq);var pf=pq.next;pY.recoverHandler(pq),pq=pf}ph.cursor=null}},ph.isMouseEvent=function(ph){return pY.MOUSE_EVENTS[ph]},pY.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},pY.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},pY.delNode=function(ph,pq){pq.prev?pq.prev.next=pq.next:ph.head=pq.next,pq.next?pq.next.prev=pq.prev:ph.tail=pq.prev},pY.createHandler=function(ph,pq,pf,pg){var p$=pY._freeHandler;return p$?(pY._freeCount--,pY._freeHandler=p$.next,p$.caller=ph,p$.method=pq,p$.args=pf,p$.once=pg):p$={caller:ph,method:pq,args:pf,once:pg},p$.prev=p$.next=null,p$},pY.recoverHandler=function(ph){ph.caller=ph.method=ph.args=ph.prev=null,ph.next=pY._freeHandler,pY._freeHandler=ph,pY._freeCount++},pY._freeHandler=null,pY._freeCount=0,pY}(),pN=function(){function p$(ph,pq,pf,pg){this.once=!1,void(this._id=0)===pg&&(pg=!1),this.setTo(ph,pq,pf,pg)}pe(p$,"laya.utils.Handler");var ph=p$.prototype;return ph.setTo=function(ph,pq,pf,pg){return this._id=p$._gid++,this.caller=ph,this.method=pq,this.args=pf,this.once=pg,this},ph.run=function(){if(null==this.method)return null;var ph=this._id,pq=this.method.apply(this.caller,this.args);return this._id===ph&&this.once&&this.recover(),pq},ph.runWith=function(ph){if(null==this.method)return null;var pq=this._id;if(null==ph)var pf=this.method.apply(this.caller,this.args);else pf=this.args||ph.unshift?this.args?this.method.apply(this.caller,this.args.concat(ph)):this.method.apply(this.caller,ph):this.method.call(this.caller,ph);return this._id===pq&&this.once&&this.recover(),pf},ph.clear=function(){return this.caller=null,this.method=null,this.args=null,this},ph.recover=function(){0<this._id&&(this._id=0,this.clear())},p$.create=function(ph,pq,pf,pg){return void 0===pg&&(pg=!0),new p$(ph,pq,pf,pg)},p$._gid=1,p$}(),pp=function(){function ph(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}pe(ph,"laya.display.BitmapFont");var pq=ph.prototype;return pq.loadFont=function(ph,pq){this._path=ph,this._complete=pq,pt.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],pN.create(this,this.onLoaded))},pq.onLoaded=function(){this.parseFont(pBh.getRes(this._path),pBh.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},pq.parseFont=function(ph,pq){if(null!=ph&&null!=pq){this._texture=pq;var pf=ph.getElementsByTagName("info");if(!pf[0].getAttributeNode)return this.parseFont2(ph,pq);this.fontSize=parseInt(pf[0].getAttributeNode("size").nodeValue);var pg,p$=pf[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(p$[0]),parseInt(p$[1]),parseInt(p$[2]),parseInt(p$[3])],pg=ph.getElementsByTagName("char");var pP=0;for(pP=0;pP<pg.length;pP++){var pS=pg[pP],pB=parseInt(pS.getAttributeNode("id").nodeValue),pr=parseInt(pS.getAttributeNode("xoffset").nodeValue)/1,pY=parseInt(pS.getAttributeNode("yoffset").nodeValue)/1,pC=parseInt(pS.getAttributeNode("xadvance").nodeValue)/1,pU=new pn;pU.x=parseInt(pS.getAttributeNode("x").nodeValue),pU.y=parseInt(pS.getAttributeNode("y").nodeValue),pU.width=parseInt(pS.getAttributeNode("width").nodeValue),pU.height=parseInt(pS.getAttributeNode("height").nodeValue);var pu=pCh.create(pq,pU.x,pU.y,pU.width,pU.height,pr,pY);this._maxWidth=Math.max(this._maxWidth,pC+this.letterSpacing),this._fontCharDic[pB]=pu,this._fontWidthMap[pB]=pC}}},pq.parseFont2=function(ph,pq){if(null!=ph&&null!=pq){this._texture=pq;var pf=ph.getElementsByTagName("info");this.fontSize=parseInt(pf[0].attributes.size.nodeValue);var pg=pf[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(pg[0]),parseInt(pg[1]),parseInt(pg[2]),parseInt(pg[3])];var p$=ph.getElementsByTagName("char"),pP=0;for(pP=0;pP<p$.length;pP++){var pS=p$[pP].attributes,pB=parseInt(pS.id.nodeValue),pr=parseInt(pS.xoffset.nodeValue)/1,pY=parseInt(pS.yoffset.nodeValue)/1,pC=parseInt(pS.xadvance.nodeValue)/1,pU=new pn;pU.x=parseInt(pS.x.nodeValue),pU.y=parseInt(pS.y.nodeValue),pU.width=parseInt(pS.width.nodeValue),pU.height=parseInt(pS.height.nodeValue);var pu=pCh.create(pq,pU.x,pU.y,pU.width,pU.height,pr,pY);this._maxWidth=Math.max(this._maxWidth,pC+this.letterSpacing),this._fontCharDic[pB]=pu,this._fontWidthMap[pB]=pC}}},pq.getCharTexture=function(ph){return this._fontCharDic[ph.charCodeAt(0)]},pq.destroy=function(){if(this._texture){for(var ph in this._fontCharDic){var pq=this._fontCharDic[ph];pq&&pq.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},pq.setSpaceWidth=function(ph){this._spaceWidth=ph},pq.getCharWidth=function(ph){var pq=ph.charCodeAt(0);return this._fontWidthMap[pq]?this._fontWidthMap[pq]+this.letterSpacing:" "==ph?this._spaceWidth+this.letterSpacing:0},pq.getTextWidth=function(ph){for(var pq=0,pf=0,pg=ph.length;pf<pg;pf++)pq+=this.getCharWidth(ph.charAt(pf));return pq},pq.getMaxWidth=function(){return this._maxWidth},pq.getMaxHeight=function(){return this.fontSize},pq.drawText=function(ph,pq,pf,pg,p$,pP){var pS,pB=this.getTextWidth(ph),pr=0;"center"===p$&&(pr=(pP-pB)/2),"right"===p$&&(pr=pP-pB);for(var pY=0,pC=0,pU=ph.length;pC<pU;pC++)(pS=this.getCharTexture(ph.charAt(pC)))&&(pq.graphics.drawTexture(pS,pf+pY+pr,pg),pY+=this.getCharWidth(ph.charAt(pC)))},ph}(),pB=function(){function pf(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=pf._TF_EMPTY}pe(pf,"laya.display.css.Style");var ph=pf.prototype;return ph.getTransform=function(){return this._tf},ph.setTransform=function(ph){this._tf="none"!==ph&&ph?ph:pf._TF_EMPTY},ph.setTranslateX=function(ph){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.translateX=ph},ph.setTranslateY=function(ph){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.translateY=ph},ph.setScaleX=function(ph){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.scaleX=ph},ph.setScale=function(ph,pq){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.scaleX=ph,this._tf.scaleY=pq},ph.setScaleY=function(ph){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.scaleY=ph},ph.setRotate=function(ph){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.rotate=ph},ph.setSkewX=function(ph){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.skewX=ph},ph.setSkewY=function(ph){this._tf===pf._TF_EMPTY&&(this._tf=new p$),this._tf.skewY=ph},ph.destroy=function(){this.scrollRect=null},ph.render=function(ph,pq,pf,pg){},ph.getCSSStyle=function(){return pqh.EMPTY},ph._enableLayout=function(){return!1},pC(0,ph,"scaleX",function(){return this._tf.scaleX},function(ph){this.setScaleX(ph)}),pC(0,ph,"transform",function(){return this.getTransform()},function(ph){this.setTransform(ph)}),pC(0,ph,"translateX",function(){return this._tf.translateX},function(ph){this.setTranslateX(ph)}),pC(0,ph,"translateY",function(){return this._tf.translateY},function(ph){this.setTranslateY(ph)}),pC(0,ph,"scaleY",function(){return this._tf.scaleY},function(ph){this.setScaleY(ph)}),pC(0,ph,"block",function(){return 0!=(1&this._type)}),pC(0,ph,"skewY",function(){return this._tf.skewY},function(ph){this.setSkewY(ph)}),pC(0,ph,"rotate",function(){return this._tf.rotate},function(ph){this.setRotate(ph)}),pC(0,ph,"skewX",function(){return this._tf.skewX},function(ph){this.setSkewX(ph)}),pC(0,ph,"paddingLeft",function(){return 0}),pC(0,ph,"paddingTop",function(){return 0}),pC(0,ph,"absolute",function(){return!0}),pf.__init__=function(){pf._TF_EMPTY=new p$,pf.EMPTY=new pf},pf.EMPTY=null,pf._TF_EMPTY=null,pf}(),pv=function(){function pq(ph){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=ps.create(pq.defaultColor),this.family=pq.defaultFamily,this.stroke=pq._STROKE,this.size=pq.defaultSize,ph&&ph!==pq.EMPTY&&ph.copyTo(this)}pe(pq,"laya.display.css.Font");var ph=pq.prototype;return ph.set=function(ph){this._text=null;for(var pq=ph.split(" "),pf=0,pg=pq.length;pf<pg;pf++){var p$=pq[pf];switch(p$){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<p$.indexOf("px")&&(this.size=parseInt(p$),this.family=pq[pf+1],pf++)}},ph.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},ph.copyTo=function(ph){ph._type=this._type,ph._text=this._text,ph._weight=this._weight,ph._color=this._color,ph.family=this.family,ph.stroke=this.stroke!=pq._STROKE?this.stroke.slice():pq._STROKE,ph.indent=this.indent,ph.size=this.size},pC(0,ph,"password",function(){return 0!=(1024&this._type)},function(ph){ph?this._type|=1024:this._type&=-1025}),pC(0,ph,"color",function(){return this._color.strColor},function(ph){this._color=ps.create(ph)}),pC(0,ph,"italic",function(){return 0!=(512&this._type)},function(ph){ph?this._type|=512:this._type&=-513}),pC(0,ph,"bold",function(){return 0!=(2048&this._type)},function(ph){ph?this._type|=2048:this._type&=-2049}),pC(0,ph,"weight",function(){return""+this._weight},function(ph){var pq=0;switch(ph){case"normal":break;case"bold":this.bold=!0,pq=700;break;case"bolder":pq=800;break;case"lighter":pq=100;break;default:pq=parseInt(ph)}this._weight=pq,this._text=null}),pC(0,ph,"decoration",function(){return this._decoration?this._decoration.value:null},function(ph){var pq=ph.split(" ");switch(this._decoration||(this._decoration={}),pq[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=pq[0]}pq[1]&&(this._decoration.color=ps.create(pq)),this._decoration.value=ph}),pq.__init__=function(){pq.EMPTY=new pq(null)},pq.EMPTY=null,pq.defaultColor="#000000",pq.defaultSize=12,pq.defaultFamily="Arial",pq.defaultFont="12px Arial",pq._STROKE=[0,"#000000"],pq._ITALIC=512,pq._PASSWORD=1024,pq._BOLD=2048,pq}(),p$=function(){function ph(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return pe(ph,"laya.display.css.TransformInfo"),ph}(),pu=function(){function pU(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,pc.isConchNode){this._nativeObj=new pS._conchGraphics,this.id=this._nativeObj.conchID}}pe(pU,"laya.display.Graphics");var ph=pU.prototype;return ph.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},ph.clear=function(ph){void 0===ph&&(ph=!1);var pq=0,pf=0;if(ph){var pg=this._one;if(this._cmds){for(pf=this._cmds.length,pq=0;pq<pf;pq++)!(pg=this._cmds[pq])||pg.callee!==pc._context._drawTexture&&pg.callee!==pc._context._drawTextureWithTransform||(pg[0]=null,pU._cache.push(pg));this._cmds.length=0}else pg&&(!pg||pg.callee!==pc._context._drawTexture&&pg.callee!==pc._context._drawTextureWithTransform||(pg[0]=null,pU._cache.push(pg)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(pq=0,pf=this._vectorgraphArray.length;pq<pf;pq++)pj.getInstance().deleteShape(this._vectorgraphArray[pq]);this._vectorgraphArray.length=0}},ph._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},ph._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new pf,this._graphicBounds._graphics=this)},ph._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},ph._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},ph.getBounds=function(ph){return void 0===ph&&(ph=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(ph)},ph.getBoundPoints=function(ph){return void 0===ph&&(ph=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(ph)},ph._addCmd=function(ph){this._cmds=this._cmds||[],ph.callee=ph.shift(),this._cmds.push(ph)},ph.setFilters=function(ph){this._saveToCmd(pc._context._setFilters,ph)},ph.drawTexture=function(ph,pq,pf,pg,p$,pP,pS){if(void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=0),void 0===p$&&(p$=0),void 0===pS&&(pS=1),!ph||pS<.01)return null;pg||(pg=ph.sourceWidth),p$||(p$=ph.sourceHeight),pS=pS<0?0:1<pS?1:pS;var pB,pr=!pc.isWebGL&&(pw.onFirefox||pw.onEdge||pw.onIE||pw.onSafari)?.5:0,pY=pg/ph.sourceWidth,pC=p$/ph.sourceHeight;return pg=ph.width*pY,p$=ph.height*pC,ph.loaded&&(pg<=0||p$<=0)?null:(pq+=ph.offsetX*pY,pf+=ph.offsetY*pC,this._sp&&(this._sp._renderType|=512),pq-=pr,pf-=pr,pg+=2*pr,p$+=2*pr,pU._cache.length?((pB=pU._cache.pop())[0]=ph,pB[1]=pq,pB[2]=pf,pB[3]=pg,pB[4]=p$,pB[5]=pP,pB[6]=pS):pB=[ph,pq,pf,pg,p$,pP,pS],pB.callee=pP||1!=pS?pc._context._drawTextureWithTransform:pc._context._drawTexture,null!=this._one||pP||1!=pS?this._saveToCmd(pB.callee,pB):(this._one=pB,this._render=this._renderOneImg),ph.loaded||ph.once("loaded",this,this._textureLoaded,[ph,pB]),this._repaint(),pB)},ph.cleanByTexture=function(ph,pq,pf,pg,p$){if(void 0===pg&&(pg=0),void 0===p$&&(p$=0),!ph)return this.clear();if(this._one&&this._render===this._renderOneImg){pg||(pg=ph.sourceWidth),p$||(p$=ph.sourceHeight);var pP=pg/ph.sourceWidth,pS=p$/ph.sourceHeight;pg=ph.width*pP,p$=ph.height*pS,pq+=ph.offsetX*pP,pf+=ph.offsetY*pS,this._one[0]=ph,this._one[1]=pq,this._one[2]=pf,this._one[3]=pg,this._one[4]=p$,this._repaint()}else this.clear(),ph&&this.drawTexture(ph,pq,pf,pg,p$)},ph.drawTextures=function(ph,pq){ph&&this._saveToCmd(pc._context._drawTextures,[ph,pq])},ph.fillTexture=function(ph,pq,pf,pg,p$,pP,pS){if(void 0===pg&&(pg=0),void 0===p$&&(p$=0),void 0===pP&&(pP="repeat"),ph){var pB=[ph,pq,pf,pg,p$,pP,pS||pX.EMPTY,{}];ph.loaded||ph.once("loaded",this,this._textureLoaded,[ph,pB]),this._saveToCmd(pc._context._fillTexture,pB)}},ph._textureLoaded=function(ph,pq){pq[3]=pq[3]||ph.width,pq[4]=pq[4]||ph.height,this._repaint()},ph.fillCircle=function(ph,pq,pf,pg,p$,pP,pS){pf.bitmap.enableMerageInAtlas=!1;var pB=new Float32Array(2*(pS+1)),pr=new Float32Array(2*(pS+1)),pY=new Uint16Array(3*pS),pC=2*Math.PI/pS,pU=0;pB[0]=pg,pB[1]=p$,pr[0]=pg/pf.width,pr[1]=p$/pf.height;for(var pu=2,pv=0;pv<pS;pv++){var pL=pP*Math.cos(pU)+pg,pe=pP*Math.sin(pU)+p$;pB[pu]=pL,pB[pu+1]=pe,pr[pu]=pL/pf.width,pr[pu+1]=pe/pf.height,pU+=pC,pu+=2}for(pv=pu=0;pv<pS;pv++)pY[pu++]=0,pY[pu++]=pv+1,pY[pu++]=pS+1<=pv+2?1:pv+2;this.drawTriangles(pf,ph,pq,pB,pr,pY)},ph.drawTriangles=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){void 0===pB&&(pB=1),this._saveToCmd(pc._context.drawTriangles,[ph,pq,pf,pg,p$,pP,pS,pB,pr,pY])},ph._saveToCmd=function(ph,pq){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=pq,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(pq)),pq.callee=ph,this._repaint(),pq},ph.clipRect=function(ph,pq,pf,pg){this._saveToCmd(pc._context._clipRect,[ph,pq,pf,pg])},ph.fillText=function(ph,pq,pf,pg,p$,pP,pS){void 0===pS&&(pS=0),this._saveToCmd(pc._context._fillText,[ph,pq,pf,pg||pv.defaultFont,p$,pP])},ph.fillBorderText=function(ph,pq,pf,pg,p$,pP,pS,pB){this._saveToCmd(pc._context._fillBorderText,[ph,pq,pf,pg||pv.defaultFont,p$,pP,pS,pB])},ph.strokeText=function(ph,pq,pf,pg,p$,pP,pS){this._saveToCmd(pc._context._strokeText,[ph,pq,pf,pg||pv.defaultFont,p$,pP,pS])},ph.alpha=function(ph){ph=ph<0?0:1<ph?1:ph,this._saveToCmd(pc._context._alpha,[ph])},ph.setAlpha=function(ph){ph=ph<0?0:1<ph?1:ph,this._saveToCmd(pc._context._setAlpha,[ph])},ph.transform=function(ph,pq,pf){void 0===pq&&(pq=0),void 0===pf&&(pf=0),this._saveToCmd(pc._context._transform,[ph,pq,pf])},ph.rotate=function(ph,pq,pf){void 0===pq&&(pq=0),void 0===pf&&(pf=0),this._saveToCmd(pc._context._rotate,[ph,pq,pf])},ph.scale=function(ph,pq,pf,pg){void 0===pf&&(pf=0),void 0===pg&&(pg=0),this._saveToCmd(pc._context._scale,[ph,pq,pf,pg])},ph.translate=function(ph,pq){this._saveToCmd(pc._context._translate,[ph,pq])},ph.save=function(){this._saveToCmd(pc._context._save,[])},ph.restore=function(){this._saveToCmd(pc._context._restore,[])},ph.replaceText=function(ph){this._repaint();var pq=this._cmds;if(pq){for(var pf=pq.length-1;-1<pf;pf--)if(this._isTextCmd(pq[pf].callee))return pq[pf][0].toUpperCase?pq[pf][0]=ph:pq[pf][0].setText(ph),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=ph:this._one[0].setText(ph),!0;return!1},ph._isTextCmd=function(ph){return ph===pc._context._fillText||ph===pc._context._fillBorderText||ph===pc._context._strokeText},ph.replaceTextColor=function(ph){this._repaint();var pq=this._cmds;if(pq)for(var pf=pq.length-1;-1<pf;pf--)this._isTextCmd(pq[pf].callee)&&(pq[pf][4]=ph,pq[pf][0].toUpperCase||(pq[pf][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=ph,this._one[0].toUpperCase||(this._one[0].changed=!0))},ph.loadImage=function(ph,pq,pf,pg,p$,pP){var pS=this;void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=0),void 0===p$&&(p$=0);var pB=pBh.getRes(ph);function pr(ph){ph&&(pS.drawTexture(ph,pq,pf,pg,p$),null!=pP&&pP.call(pS._sp,ph))}pB?pr(pB):pt.loader.load(ph,pN.create(null,pr),null,"image")},ph._renderEmpty=function(ph,pq,pf,pg){},ph._renderAll=function(ph,pq,pf,pg){for(var p$,pP=this._cmds,pS=0,pB=pP.length;pS<pB;pS++)(p$=pP[pS]).callee.call(pq,pf,pg,p$)},ph._renderOne=function(ph,pq,pf,pg){this._one.callee.call(pq,pf,pg,this._one)},ph._renderOneImg=function(ph,pq,pf,pg){this._one.callee.call(pq,pf,pg,this._one),2305!==ph._renderType&&(ph._renderType|=1)},ph.drawLine=function(ph,pq,pf,pg,p$,pP){void 0===pP&&(pP=1);var pS=0;pc.isWebGL&&(pS=pj.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(pS));var pB=pP%2==0?0:.5,pr=[ph+pB,pq+pB,pf+pB,pg+pB,p$,pP,pS];this._saveToCmd(pc._context._drawLine,pr)},ph.drawLines=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=1);var pP=0;if(pf&&!(pf.length<4)){pc.isWebGL&&(pP=pj.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(pP));var pS=p$%2==0?0:.5,pB=[ph+pS,pq+pS,pf,pg,p$,pP];this._saveToCmd(pc._context._drawLines,pB)}},ph.drawCurves=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=1);var pP=[ph,pq,pf,pg,p$];this._saveToCmd(pc._context._drawCurves,pP)},ph.drawRect=function(ph,pq,pf,pg,p$,pP,pS){void 0===pS&&(pS=1);var pB=pP?pS/2:0,pr=pP?pS:0,pY=[ph+pB,pq+pB,pf-pr,pg-pr,p$,pP,pS];this._saveToCmd(pc._context._drawRect,pY)},ph.drawCircle=function(ph,pq,pf,pg,p$,pP){void 0===pP&&(pP=1);var pS=p$?pP/2:0,pB=0;pc.isWebGL&&(pB=pj.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(pB));var pr=[ph,pq,pf-pS,pg,p$,pP,pB];this._saveToCmd(pc._context._drawCircle,pr)},ph.drawPie=function(ph,pq,pf,pg,p$,pP,pS,pB){void 0===pB&&(pB=1);var pr=pS?pB/2:0,pY=pS?pB:0,pC=0;pc.isWebGL&&(pC=pj.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(pC));var pU=[ph+pr,pq+pr,pf-pY,pg,p$,pP,pS,pB,pC];pU[3]=pO.toRadian(pg),pU[4]=pO.toRadian(p$),this._saveToCmd(pc._context._drawPie,pU)},ph.drawPoly=function(ph,pq,pf,pg,p$,pP){void 0===pP&&(pP=1);var pS=0,pB=!1;pc.isWebGL&&(pS=pj.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(pS),pB=!(6<pf.length));var pr=p$?pP%2==0?0:.5:0,pY=[ph+pr,pq+pr,pf,pg,p$,pP,pS,pB];this._saveToCmd(pc._context._drawPoly,pY)},ph.drawPath=function(ph,pq,pf,pg,p$){var pP=[ph,pq,pf,pg,p$];this._saveToCmd(pc._context._drawPath,pP)},pC(0,ph,"cmds",function(){return this._cmds},function(ph){this._sp&&(this._sp._renderType|=512),this._cmds=ph,this._render=this._renderAll,this._repaint()}),pU.__init__=function(){if(pc.isConchNode){for(var ph=laya.display.Graphics.prototype,pq=pw.window.ConchGraphics.prototype,pf=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],pg=0,p$=pf.length;pg<=p$;pg++){var pP=pf[pg];ph[pP]=pq[pP]}ph._saveToCmd=null,pq.drawImageS&&(ph.drawTextures=function(ph,pq){if(ph&&ph.loaded&&ph.bitmap&&ph.source){var pf=ph.uv,pg=ph.bitmap.width,p$=ph.bitmap.height;this.drawImageS(ph.bitmap.source,pf[0]*pg,pf[1]*p$,(pf[2]-pf[0])*pg,(pf[5]-pf[3])*p$,ph.offsetX,ph.offsetY,ph.width,ph.height,pq)}}),ph.drawTexture=function(ph,pq,pf,pg,p$,pP,pS){if(void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=0),void 0===p$&&(p$=0),void 0===pS&&(pS=1),ph)if(ph.loaded){if(ph.loaded&&ph.bitmap&&ph.source&&(pg||(pg=ph.sourceWidth),p$||(p$=ph.sourceHeight),pS=pS<0?0:1<pS?1:pS,pg=pg-ph.sourceWidth+ph.width,p$=p$-ph.sourceHeight+ph.height,!(pg<=0||p$<=0))){pq+=ph.offsetX,pf+=ph.offsetY;var pB=ph.uv,pr=ph.bitmap.width,pY=ph.bitmap.height;pB[4]<pB[0]&&pB[5]<pB[1]?this.drawImageM(ph.bitmap.source,pB[4]*pr,pB[5]*pY,(pB[0]-pB[4])*pr,(pB[1]-pB[5])*pY,pq,pf,pg,p$,pP,pS):this.drawImageM(ph.bitmap.source,pB[0]*pr,pB[1]*pY,(pB[2]-pB[0])*pr,(pB[5]-pB[3])*pY,pq,pf,pg,p$,pP,pS),this._repaint()}}else ph.once("loaded",this,function(){this.drawTexture(ph,pq,pf,pg,p$,pP)})},ph.fillTexture=function(ph,pq,pf,pg,p$,pP,pS){if(void 0===pg&&(pg=0),void 0===p$&&(p$=0),void 0===pP&&(pP="repeat"),ph&&ph.loaded){var pB,pr=pc._context.ctx,pY=ph.bitmap.width,pC=ph.bitmap.height,pU=ph.uv;pB=ph.uv!=pCh.DEF_UV?pr.createPattern(ph.bitmap.source,pP,pU[0]*pY,pU[1]*pC,(pU[2]-pU[0])*pY,(pU[5]-pU[3])*pC):pr.createPattern(ph.bitmap.source,pP);var pu=0,pv=0;pS&&(pq+=pS.x%ph.width,pf+=pS.y%ph.height,pu-=pS.x%ph.width,pv-=pS.y%ph.height),this._fillImage(pB,pq,pf,pu,pv,pg,p$)}}}},pU._cache=[],pU}(),pf=function(){function pG(){this._cacheBoundsType=!1}pe(pG,"laya.display.GraphicsBounds");var ph=pG.prototype;return ph.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},ph.reset=function(){this._temp&&(this._temp.length=0)},ph.getBounds=function(ph){return void 0===ph&&(ph=!1),(!this._bounds||!this._temp||this._temp.length<1||ph!=this._cacheBoundsType)&&(this._bounds=pn._getWrapRec(this.getBoundPoints(ph),this._bounds)),this._cacheBoundsType=ph,this._bounds},ph.getBoundPoints=function(ph){return void 0===ph&&(ph=!1),(!this._temp||this._temp.length<1||ph!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(ph)),this._cacheBoundsType=ph,this._rstBoundPoints=pO.copyArray(this._rstBoundPoints,this._temp)},ph._getCmdPoints=function(ph){void 0===ph&&(ph=!1);var pq,pf,pg=pc._context,p$=this._graphics.cmds;if((pq=this._temp||(this._temp=[])).length=0,p$||null==this._graphics._one||(pG._tempCmds.length=0,pG._tempCmds.push(this._graphics._one),p$=pG._tempCmds),!p$)return pq;(pf=pG._tempMatrixArrays).length=0;var pP=pG._initMatrix;pP.identity();for(var pS,pB,pr=pG._tempMatrix,pY=NaN,pC=NaN,pU=NaN,pu=NaN,pv=NaN,pL=NaN,pe=0,pl=p$.length;pe<pl;pe++)if((pS=p$[pe]).callee)switch(pS.callee){case pg._save:case 7:pf.push(pP),pP=pP.clone();break;case pg._restore:case 8:pP=pf.pop();break;case pg._scale:case 5:pr.identity(),pr.translate(-pS[2],-pS[3]),pr.scale(pS[0],pS[1]),pr.translate(pS[2],pS[3]),this._switchMatrix(pP,pr);break;case pg._rotate:case 3:pr.identity(),pr.translate(-pS[1],-pS[2]),pr.rotate(pS[0]),pr.translate(pS[1],pS[2]),this._switchMatrix(pP,pr);break;case pg._translate:case 6:pr.identity(),pr.translate(pS[0],pS[1]),this._switchMatrix(pP,pr);break;case pg._transform:case 4:pr.identity(),pr.translate(-pS[1],-pS[2]),pr.concat(pS[0]),pr.translate(pS[1],pS[2]),this._switchMatrix(pP,pr);break;case 16:case 24:pG._addPointArrToRst(pq,pn._getBoundPointS(pS[0],pS[1],pS[2],pS[3]),pP);break;case 17:pP.copyTo(pr),pr.concat(pS[4]),pG._addPointArrToRst(pq,pn._getBoundPointS(pS[0],pS[1],pS[2],pS[3]),pr);break;case pg._drawTexture:pB=pS[0],ph?pS[3]&&pS[4]?pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1],pS[2],pS[3],pS[4]),pP):(pB=pS[0],pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1],pS[2],pB.width,pB.height),pP)):(pY=(pS[3]||pB.sourceWidth)/pB.width,pC=(pS[4]||pB.sourceHeight)/pB.height,pU=pY*pB.sourceWidth,pu=pC*pB.sourceHeight,pv=0<pB.offsetX?pB.offsetX:0,pL=0<pB.offsetY?pB.offsetY:0,pv*=pY,pL*=pC,pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1]-pv,pS[2]-pL,pU,pu),pP));break;case pg._fillTexture:pS[3]&&pS[4]?pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1],pS[2],pS[3],pS[4]),pP):(pB=pS[0],pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1],pS[2],pB.width,pB.height),pP));break;case pg._drawTextureWithTransform:var p_;p_=pS[5]?(pP.copyTo(pr),pr.concat(pS[5]),pr):pP,ph?pS[3]&&pS[4]?pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1],pS[2],pS[3],pS[4]),p_):(pB=pS[0],pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1],pS[2],pB.width,pB.height),p_)):(pB=pS[0],pY=(pS[3]||pB.sourceWidth)/pB.width,pC=(pS[4]||pB.sourceHeight)/pB.height,pU=pY*pB.sourceWidth,pu=pC*pB.sourceHeight,pv=0<pB.offsetX?pB.offsetX:0,pL=0<pB.offsetY?pB.offsetY:0,pv*=pY,pL*=pC,pG._addPointArrToRst(pq,pn._getBoundPointS(pS[1]-pv,pS[2]-pL,pU,pu),p_));break;case pg._drawRect:case 13:pG._addPointArrToRst(pq,pn._getBoundPointS(pS[0],pS[1],pS[2],pS[3]),pP);break;case pg._drawCircle:case pg._fillCircle:case 14:pG._addPointArrToRst(pq,pn._getBoundPointS(pS[0]-pS[2],pS[1]-pS[2],pS[2]+pS[2],pS[2]+pS[2]),pP);break;case pg._drawLine:case 20:pG._tempPoints.length=0;var pN;pN=.5*pS[5],pS[0]==pS[2]?pG._tempPoints.push(pS[0]+pN,pS[1],pS[2]+pN,pS[3],pS[0]-pN,pS[1],pS[2]-pN,pS[3]):pS[1]==pS[3]?pG._tempPoints.push(pS[0],pS[1]+pN,pS[2],pS[3]+pN,pS[0],pS[1]-pN,pS[2],pS[3]-pN):pG._tempPoints.push(pS[0],pS[1],pS[2],pS[3]),pG._addPointArrToRst(pq,pG._tempPoints,pP);break;case pg._drawCurves:case 22:pG._addPointArrToRst(pq,pm.I.getBezierPoints(pS[2]),pP,pS[0],pS[1]);break;case pg._drawPoly:case pg._drawLines:case 18:pG._addPointArrToRst(pq,pS[2],pP,pS[0],pS[1]);break;case pg._drawPath:case 19:pG._addPointArrToRst(pq,this._getPathPoints(pS[2]),pP,pS[0],pS[1]);break;case pg._drawPie:case 15:pG._addPointArrToRst(pq,this._getPiePoints(pS[0],pS[1],pS[2],pS[3],pS[4]),pP)}return 200<pq.length?pq=pO.copyArray(pq,pn._getWrapRec(pq)._getBoundPoints()):8<pq.length&&(pq=pE.scanPList(pq)),pq},ph._switchMatrix=function(ph,pq){pq.concat(ph),pq.copyTo(ph)},ph._getPiePoints=function(ph,pq,pf,pg,p$){var pP=pG._tempPoints;pG._tempPoints.length=0,pP.push(ph,pq);var pS=(p$-pg)%(2*Math.PI)/10,pB=NaN,pr=pg;for(pB=0;pB<=10;pB++)pP.push(ph+pf*Math.cos(pr),pq+pf*Math.sin(pr)),pr+=pS;return pP},ph._getPathPoints=function(ph){var pq,pf,pg=0,p$=pG._tempPoints;for(p$.length=0,pq=ph.length,pg=0;pg<pq;pg++)1<(pf=ph[pg]).length&&(p$.push(pf[1],pf[2]),3<pf.length&&p$.push(pf[3],pf[4]));return p$},pG._addPointArrToRst=function(ph,pq,pf,pg,p$){void 0===pg&&(pg=0),void 0===p$&&(p$=0);var pP,pS=0;for(pP=pq.length,pS=0;pS<pP;pS+=2)pG._addPointToRst(ph,pq[pS]+pg,pq[pS+1]+p$,pf)},pG._addPointToRst=function(ph,pq,pf,pg){var p$=pX.TEMP;p$.setTo(pq||0,pf||0),pg.transformPoint(p$),ph.push(p$.x,p$.y)},pG._tempPoints=[],pG._tempMatrixArrays=[],pG._tempCmds=[],pr(pG,["_tempMatrix",function(){return this._tempMatrix=new pb},"_initMatrix",function(){return this._initMatrix=new pb}]),pG}(),pP=function(){function ph(){}pe(ph,"laya.events.Event");var pq=ph.prototype;return pq.setTo=function(ph,pq,pf){return this.type=ph,this.currentTarget=pq,this.target=pf,this},pq.stopPropagation=function(){this._stoped=!0},pC(0,pq,"stageY",function(){return pt.stage.mouseY}),pC(0,pq,"charCode",function(){return this.nativeEvent.charCode}),pC(0,pq,"touches",function(){var ph=this.nativeEvent.touches;if(ph)for(var pq=pt.stage,pf=0,pg=ph.length;pf<pg;pf++){var p$=ph[pf],pP=pX.TEMP;pP.setTo(p$.clientX,p$.clientY),pq._canvasTransform.invertTransformPoint(pP),pq.transform.invertTransformPoint(pP),p$.stageX=pP.x,p$.stageY=pP.y}return ph}),pC(0,pq,"keyLocation",function(){return this.nativeEvent.keyLocation}),pC(0,pq,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),pC(0,pq,"altKey",function(){return this.nativeEvent.altKey}),pC(0,pq,"shiftKey",function(){return this.nativeEvent.shiftKey}),pC(0,pq,"stageX",function(){return pt.stage.mouseX}),ph.EMPTY=new ph,ph.MOUSE_DOWN="mousedown",ph.MOUSE_UP="mouseup",ph.CLICK="click",ph.RIGHT_MOUSE_DOWN="rightmousedown",ph.RIGHT_MOUSE_UP="rightmouseup",ph.RIGHT_CLICK="rightclick",ph.MOUSE_MOVE="mousemove",ph.MOUSE_OVER="mouseover",ph.MOUSE_OUT="mouseout",ph.MOUSE_WHEEL="mousewheel",ph.ROLL_OVER="mouseover",ph.ROLL_OUT="mouseout",ph.DOUBLE_CLICK="doubleclick",ph.CHANGE="change",ph.CHANGED="changed",ph.RESIZE="resize",ph.ADDED="added",ph.REMOVED="removed",ph.DISPLAY="display",ph.UNDISPLAY="undisplay",ph.ERROR="error",ph.COMPLETE="complete",ph.LOADED="loaded",ph.INITED="inited",ph.PROGRESS="progress",ph.INPUT="input",ph.RENDER="render",ph.OPEN="open",ph.MESSAGE="message",ph.CLOSE="close",ph.KEY_DOWN="keydown",ph.KEY_PRESS="keypress",ph.KEY_UP="keyup",ph.FRAME="enterframe",ph.DRAG_START="dragstart",ph.DRAG_MOVE="dragmove",ph.DRAG_END="dragend",ph.ENTER="enter",ph.SELECT="select",ph.BLUR="blur",ph.FOCUS="focus",ph.VISIBILITY_CHANGE="visibilitychange",ph.FOCUS_CHANGE="focuschange",ph.PLAYED="played",ph.PAUSED="paused",ph.STOPPED="stopped",ph.START="start",ph.END="end",ph.ENABLE_CHANGED="enablechanged",ph.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",ph.COMPONENT_ADDED="componentadded",ph.COMPONENT_REMOVED="componentremoved",ph.LAYER_CHANGED="layerchanged",ph.HIERARCHY_LOADED="hierarchyloaded",ph.RECOVERED="recovered",ph.RELEASED="released",ph.LINK="link",ph.LABEL="label",ph.FULL_SCREEN_CHANGE="fullscreenchange",ph.DEVICE_LOST="devicelost",ph.MESH_CHANGED="meshchanged",ph.MATERIAL_CHANGED="materialchanged",ph.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",ph.ANIMATION_CHANGED="animationchanged",ph.TRIGGER_ENTER="triggerenter",ph.TRIGGER_STAY="triggerstay",ph.TRIGGER_EXIT="triggerexit",ph.TRAIL_FILTER_CHANGE="trailfilterchange",ph.DOMINO_FILTER_CHANGE="dominofilterchange",ph}(),pU=(function(){function ph(){}pe(ph,"laya.events.Keyboard"),ph.NUMBER_0=48,ph.NUMBER_1=49,ph.NUMBER_2=50,ph.NUMBER_3=51,ph.NUMBER_4=52,ph.NUMBER_5=53,ph.NUMBER_6=54,ph.NUMBER_7=55,ph.NUMBER_8=56,ph.NUMBER_9=57,ph.A=65,ph.B=66,ph.C=67,ph.D=68,ph.E=69,ph.F=70,ph.G=71,ph.H=72,ph.I=73,ph.J=74,ph.K=75,ph.L=76,ph.M=77,ph.N=78,ph.O=79,ph.P=80,ph.Q=81,ph.R=82,ph.S=83,ph.T=84,ph.U=85,ph.V=86,ph.W=87,ph.X=88,ph.Y=89,ph.Z=90,ph.F1=112,ph.F2=113,ph.F3=114,ph.F4=115,ph.F5=116,ph.F6=117,ph.F7=118,ph.F8=119,ph.F9=120,ph.F10=121,ph.F11=122,ph.F12=123,ph.F13=124,ph.F14=125,ph.F15=126,ph.NUMPAD=21,ph.NUMPAD_0=96,ph.NUMPAD_1=97,ph.NUMPAD_2=98,ph.NUMPAD_3=99,ph.NUMPAD_4=100,ph.NUMPAD_5=101,ph.NUMPAD_6=102,ph.NUMPAD_7=103,ph.NUMPAD_8=104,ph.NUMPAD_9=105,ph.NUMPAD_ADD=107,ph.NUMPAD_DECIMAL=110,ph.NUMPAD_DIVIDE=111,ph.NUMPAD_ENTER=108,ph.NUMPAD_MULTIPLY=106,ph.NUMPAD_SUBTRACT=109,ph.SEMICOLON=186,ph.EQUAL=187,ph.COMMA=188,ph.MINUS=189,ph.PERIOD=190,ph.SLASH=191,ph.BACKQUOTE=192,ph.LEFTBRACKET=219,ph.BACKSLASH=220,ph.RIGHTBRACKET=221,ph.QUOTE=222,ph.ALTERNATE=18,ph.BACKSPACE=8,ph.CAPS_LOCK=20,ph.COMMAND=15,ph.CONTROL=17,ph.DELETE=46,ph.ENTER=13,ph.ESCAPE=27,ph.PAGE_UP=33,ph.PAGE_DOWN=34,ph.END=35,ph.HOME=36,ph.LEFT=37,ph.UP=38,ph.RIGHT=39,ph.DOWN=40,ph.SHIFT=16,ph.SPACE=32,ph.TAB=9,ph.INSERT=45}(),function(){function p$(){}return pe(p$,"laya.events.KeyBoardManager"),p$.__init__=function(){p$._addEvent("keydown"),p$._addEvent("keypress"),p$._addEvent("keyup")},p$._addEvent=function(pq){pw.document.addEventListener(pq,function(ph){laya.events.KeyBoardManager._dispatch(ph,pq)},!0)},p$._dispatch=function(ph,pq){if(p$.enabled){p$._event._stoped=!1,p$._event.nativeEvent=ph,p$._event.keyCode=ph.keyCode||ph.which||ph.charCode,"keydown"===pq?p$._pressKeys[p$._event.keyCode]=!0:"keyup"===pq&&(p$._pressKeys[p$._event.keyCode]=null);for(var pf=pt.stage.focus&&null!=pt.stage.focus.event&&pt.stage.focus.displayedInStage?pt.stage.focus:pt.stage,pg=pf;pg;)pg.event(pq,p$._event.setTo(pq,pg,pf)),pg=pg.parent}},p$.hasKeyDown=function(ph){return p$._pressKeys[ph]},p$._pressKeys={},p$.enabled=!0,pr(p$,["_event",function(){return this._event=new pP}]),p$}()),pL=(function(){function ph(){}pe(ph,"laya.events.KeyLocation"),ph.STANDARD=0,ph.LEFT=1,ph.RIGHT=2,ph.NUM_PAD=3}(),function(){function pC(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=pw.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new pP,this._matrix=new pb,this._point=new pX,this._rect=new pn,this._prePoint=new pX,this._curTouchID=NaN}pe(pC,"laya.events.MouseManager");var ph=pC.prototype;return ph.__init__=function(ph,pq){var pf=this;this._stage=ph;var pg=this,p$=this._eventList;pq.oncontextmenu=function(ph){if(pC.enabled)return!1},pq.addEventListener("mousedown",function(ph){pC.enabled&&(pw.onIE||ph.preventDefault(),p$.push(ph),pg.mouseDownTime=pw.now())}),pq.addEventListener("mouseup",function(ph){pC.enabled&&(ph.preventDefault(),p$.push(ph),pg.mouseDownTime=-pw.now())},!0),pq.addEventListener("mousemove",function(ph){if(pC.enabled){ph.preventDefault();var pq=pw.now();if(pq-pg._lastMoveTimer<10)return;pg._lastMoveTimer=pq,p$.push(ph)}},!0),pq.addEventListener("mouseout",function(ph){pC.enabled&&p$.push(ph)}),pq.addEventListener("mouseover",function(ph){pC.enabled&&p$.push(ph)}),pq.addEventListener("touchstart",function(ph){pC.enabled&&(p$.push(ph),pC._isFirstTouch||pEh.isInputting||ph.preventDefault(),pg.mouseDownTime=pw.now())}),pq.addEventListener("touchend",function(ph){pC.enabled?(pC._isFirstTouch||pEh.isInputting||ph.preventDefault(),pC._isFirstTouch=!1,p$.push(ph),pg.mouseDownTime=-pw.now()):pf._curTouchID=NaN},!0),pq.addEventListener("touchmove",function(ph){pC.enabled&&(ph.preventDefault(),p$.push(ph))},!0),pq.addEventListener("touchcancel",function(ph){pC.enabled?(ph.preventDefault(),p$.push(ph)):pf._curTouchID=NaN},!0),pq.addEventListener("mousewheel",function(ph){pC.enabled&&p$.push(ph)}),pq.addEventListener("DOMMouseScroll",function(ph){pC.enabled&&p$.push(ph)})},ph.initEvent=function(ph,pq){var pf;this._event._stoped=!1,this._event.nativeEvent=pq||ph,this._target=null,this._point.setTo(ph.pageX||ph.clientX,ph.pageY||ph.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=ph.identifier||0,this._tTouchID=this._event.touchId,(pf=pl.I._event)._stoped=!1,pf.nativeEvent=this._event.nativeEvent,pf.touchId=this._event.touchId},ph.checkMouseWheel=function(ph){this._event.delta=ph.wheelDelta?.025*ph.wheelDelta:-ph.detail;for(var pq=pl.I.getLastOvers(),pf=0,pg=pq.length;pf<pg;pf++){var p$=pq[pf];p$.event("mousewheel",this._event.setTo("mousewheel",p$,this._target))}},ph.onMouseMove=function(ph){pl.I.onMouseMove(ph,this._tTouchID)},ph.onMouseDown=function(ph){if(pEh.isInputting&&pt.stage.focus&&pt.stage.focus.focus&&!pt.stage.focus.contains(this._target)){var pq=pt.stage.focus._tf||pt.stage.focus,pf=ph._tf||ph;pf instanceof laya.display.Input&&pf.multiline==pq.multiline?pq._focusOut():pq.focus=!1}pl.I.onMouseDown(ph,this._tTouchID,this._isLeftMouse)},ph.onMouseUp=function(ph){pl.I.onMouseUp(ph,this._tTouchID,this._isLeftMouse)},ph.check=function(ph,pq,pf,pg){this._point.setTo(pq,pf),ph.fromParentPoint(this._point),pq=this._point.x,pf=this._point.y;var p$=ph.scrollRect;if(p$&&(this._rect.setTo(p$.x,p$.y,p$.width,p$.height),!this._rect.contains(pq,pf)))return!1;if(!this.disableMouseEvent){if(ph.hitTestPrior&&!ph.mouseThrough&&!this.hitTest(ph,pq,pf))return!1;for(var pP=ph._childs.length-1;-1<pP;pP--){var pS=ph._childs[pP];if(!pS.destroyed&&pS.mouseEnabled&&pS.visible&&this.check(pS,pq,pf,pg))return!0}}var pB=!(!ph.hitTestPrior||ph.mouseThrough||this.disableMouseEvent)||this.hitTest(ph,pq,pf);return pB?(this._target=ph,pg.call(this,ph)):pg===this.onMouseUp&&ph===this._stage&&(this._target=this._stage,pg.call(this,this._target)),pB},ph.hitTest=function(ph,pq,pf){var pg=!1;if(ph.scrollRect&&(pq-=ph.scrollRect.x,pf-=ph.scrollRect.y),ph.hitArea instanceof laya.utils.HitArea)return ph.hitArea.isHit(pq,pf);if(0<ph.width&&0<ph.height||ph.mouseThrough||ph.hitArea)if(ph.mouseThrough)pg=ph.getGraphicBounds().contains(pq,pf);else{var p$=this._rect;ph.hitArea?p$=ph.hitArea:p$.setTo(0,0,ph.width,ph.height),pg=p$.contains(pq,pf)}return pg},ph.runEvent=function(){var ph=this._eventList.length;if(ph){var pq=this;pq.mouseEventTime=pw.now();var pf,pg=0,p$=0,pP=0;try{for(;pg<ph;){var pS=this._eventList[pg];switch("mousemove"!==pS.type&&(this._prePoint.x=this._prePoint.y=-1e6),pS.type){case"mousedown":this._touchIDs[0]=this._id++,pC._isTouchRespond?pC._isTouchRespond=!1:(pq._isLeftMouse=0===pS.button,pq.initEvent(pS),pq.check(pq._stage,pq.mouseX,pq.mouseY,pq.onMouseDown));break;case"mouseup":pq._isLeftMouse=0===pS.button,pq.initEvent(pS),pq.check(pq._stage,pq.mouseX,pq.mouseY,pq.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-pS.clientX)+Math.abs(this._prePoint.y-pS.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=pS.clientX,this._prePoint.y=pS.clientY,pq.initEvent(pS),pq.check(pq._stage,pq.mouseX,pq.mouseY,pq.onMouseMove));break;case"touchstart":pC._isTouchRespond=!0,pq._isLeftMouse=!0;var pB=pS.changedTouches;for(p$=0,pP=pB.length;p$<pP;p$++)pf=pB[p$],(pC.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=pf.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[pf.identifier]=this._id++,pq.initEvent(pf,pS),pq.check(pq._stage,pq.mouseX,pq.mouseY,pq.onMouseDown));break;case"touchend":case"touchcancel":pC._isTouchRespond=!0,pq._isLeftMouse=!0;var pr=pS.changedTouches;for(p$=0,pP=pr.length;p$<pP;p$++)if(pf=pr[p$],pC.multiTouchEnabled||pf.identifier==this._curTouchID){this._curTouchID=NaN,pq.initEvent(pf,pS);pq.check(pq._stage,pq.mouseX,pq.mouseY,pq.onMouseUp)||pq.onMouseUp(null)}break;case"touchmove":var pY=pS.changedTouches;for(p$=0,pP=pY.length;p$<pP;p$++)pf=pY[p$],(pC.multiTouchEnabled||pf.identifier==this._curTouchID)&&(pq.initEvent(pf,pS),pq.check(pq._stage,pq.mouseX,pq.mouseY,pq.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":pq.checkMouseWheel(pS);break;case"mouseout":pl.I.stageMouseOut();break;case"mouseover":pq._stage.event("mouseover",pq._event.setTo("mouseover",pq._stage,pq._stage))}pg++}}catch(ph){throw this._eventList.length=0,ph}this._eventList.length=0}},pC.enabled=!0,pC.multiTouchEnabled=!0,pC._isTouchRespond=!1,pC._isFirstTouch=!0,pr(pC,["instance",function(){return this.instance=new pC}]),pC}()),pl=function(){function pL(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new pP}pe(pL,"laya.events.TouchManager");var ph=pL.prototype;return ph._clearTempArrs=function(){pL._oldArr.length=0,pL._newArr.length=0,pL._tEleArr.length=0},ph.getTouchFromArr=function(ph,pq){var pf,pg,p$=0;for(pf=pq.length,p$=0;p$<pf;p$++)if((pg=pq[p$]).id==ph)return pg;return null},ph.removeTouchFromArr=function(ph,pq){var pf=0;for(pf=pq.length-1;0<=pf;pf--)pq[pf].id==ph&&pq.splice(pf,1)},ph.createTouchO=function(ph,pq){var pf;return(pf=pF.getItem("TouchData")||{}).id=pq,pf.tar=ph,pf},ph.onMouseDown=function(ph,pq,pf){var pg,p$,pP,pS;(void 0===pf&&(pf=!1),this.enable)&&(pg=this.getTouchFromArr(pq,this.preOvers),pP=this.getEles(ph,null,pL._tEleArr),pg?pg.tar=ph:(p$=this.createTouchO(ph,pq),this.preOvers.push(p$)),pw.onMobile&&this.sendEvents(pP,"mouseover",pq),pS=pf?this.preDowns:this.preRightDowns,(pg=this.getTouchFromArr(pq,pS))?pg.tar=ph:(p$=this.createTouchO(ph,pq),pS.push(p$)),this.sendEvents(pP,pf?"mousedown":"rightmousedown",pq),this._clearTempArrs())},ph.sendEvents=function(ph,pq,pf){void 0===pf&&(pf=0);var pg,p$,pP,pS=0;for(pg=ph.length,this._event._stoped=!1,p$=ph[0],pS=0;pS<pg;pS++){if((pP=ph[pS]).destroyed)return;if(pP.event(pq,this._event.setTo(pq,pP,p$)),this._event._stoped)break}},ph.getEles=function(ph,pq,pf){for(pf?pf.length=0:pf=[];ph&&ph!=pq;)pf.push(ph),ph=ph.parent;return pf},ph.checkMouseOutAndOverOfMove=function(ph,pq,pf){if(void 0===pf&&(pf=0),pq!=ph){var pg,p$,pP=0,pS=0;if(pq.contains(ph))p$=this.getEles(ph,pq,pL._tEleArr),this.sendEvents(p$,"mouseover",pf);else if(ph.contains(pq))p$=this.getEles(pq,ph,pL._tEleArr),this.sendEvents(p$,"mouseout",pf);else{var pB,pr;(p$=pL._tEleArr).length=0,pB=this.getEles(pq,null,pL._oldArr),pr=this.getEles(ph,null,pL._newArr),pS=pB.length;var pY=0;for(pP=0;pP<pS;pP++){if(pg=pB[pP],0<=(pY=pr.indexOf(pg))){pr.splice(pY,pr.length-pY);break}p$.push(pg)}0<p$.length&&this.sendEvents(p$,"mouseout",pf),0<pr.length&&this.sendEvents(pr,"mouseover",pf)}}},ph.onMouseMove=function(ph,pq){var pf,pg;this.enable&&((pf=this.getTouchFromArr(pq,this.preOvers))?(this.checkMouseOutAndOverOfMove(ph,pf.tar),pf.tar=ph,pg=this.getEles(ph,null,pL._tEleArr)):(pg=this.getEles(ph,null,pL._tEleArr),this.sendEvents(pg,"mouseover",pq),this.preOvers.push(this.createTouchO(ph,pq))),this.sendEvents(pg,"mousemove",pq),this._clearTempArrs())},ph.getLastOvers=function(){return(pL._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,pL._tEleArr):(pL._tEleArr.push(pt.stage),pL._tEleArr)},ph.stageMouseOut=function(){var ph;ph=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(ph,"mouseout",0)},ph.onMouseUp=function(ph,pq,pf){if(void 0===pf&&(pf=!1),this.enable){var pg,p$,pP,pS,pB,pr,pY=0,pC=0,pU=pw.onMobile;if(p$=this.getEles(ph,null,pL._tEleArr),this.sendEvents(p$,pf?"mouseup":"rightmouseup",pq),pr=pf?this.preDowns:this.preRightDowns,pg=this.getTouchFromArr(pq,pr)){var pu,pv=pw.now();if(pu=pv-this._lastClickTime<300,this._lastClickTime=pv,ph==pg.tar)pB=p$;else for(pP=this.getEles(pg.tar,null,pL._oldArr),(pB=pL._newArr).length=0,pC=pP.length,pY=0;pY<pC;pY++)pS=pP[pY],0<=p$.indexOf(pS)&&pB.push(pS);0<pB.length&&this.sendEvents(pB,pf?"click":"rightclick",pq),pf&&pu&&this.sendEvents(pB,"doubleclick",pq),this.removeTouchFromArr(pq,pr),pg.tar=null,pF.recover("TouchData",pg)}else;(pg=this.getTouchFromArr(pq,this.preOvers))&&pU&&((pB=this.getEles(pg.tar,null,pB))&&0<pB.length&&this.sendEvents(pB,"mouseout",pq),this.removeTouchFromArr(pq,this.preOvers),pg.tar=null,pF.recover("TouchData",pg)),this._clearTempArrs()}},pL._oldArr=[],pL._newArr=[],pL._tEleArr=[],pr(pL,["I",function(){return this.I=new pL}]),pL}(),p_=function(){function ph(){this._action=null}pe(ph,"laya.filters.Filter");var pq=ph.prototype;return pt.imps(pq,{"laya.filters.IFilter":!0}),pq.callNative=function(ph){},pC(0,pq,"type",function(){return-1}),pC(0,pq,"action",function(){return this._action}),ph.BLUR=16,ph.COLOR=32,ph.GLOW=8,ph._filterStart=null,ph._filterEnd=null,ph._EndTarget=null,ph._recycleScope=null,ph._filter=null,ph._useSrc=null,ph._endSrc=null,ph._useOut=null,ph._endOut=null,ph}(),pG=function(){function ph(){this.data=null}pe(ph,"laya.filters.ColorFilterAction");var pq=ph.prototype;return pt.imps(pq,{"laya.filters.IFilterAction":!0}),pq.apply=function(ph){var pq=ph.ctx.ctx,pf=ph.ctx.ctx.canvas;if(0==pf.width||0==pf.height)return pf;for(var pg,p$=pq.getImageData(0,0,pf.width,pf.height),pP=p$.data,pS=0,pB=pP.length;pS<pB;pS+=4)pg=this.getColor(pP[pS],pP[pS+1],pP[pS+2],pP[pS+3]),0!=pP[pS+3]&&(pP[pS]=pg[0],pP[pS+1]=pg[1],pP[pS+2]=pg[2],pP[pS+3]=pg[3]);return pq.putImageData(p$,0,0),ph},pq.getColor=function(ph,pq,pf,pg){var p$=[];if(this.data._mat&&this.data._alpha){var pP=this.data._mat,pS=this.data._alpha;p$[0]=pP[0]*ph+pP[1]*pq+pP[2]*pf+pP[3]*pg+pS[0],p$[1]=pP[4]*ph+pP[5]*pq+pP[6]*pf+pP[7]*pg+pS[1],p$[2]=pP[8]*ph+pP[9]*pq+pP[10]*pf+pP[11]*pg+pS[2],p$[3]=pP[12]*ph+pP[13]*pq+pP[14]*pf+pP[15]*pg+pS[3]}return p$},ph}(),pm=(function(){function ph(){}pe(ph,"laya.maths.Arith"),ph.formatR=function(ph){return ph>Math.PI&&(ph-=2*Math.PI),ph<-Math.PI&&(ph+=2*Math.PI),ph},ph.isPOT=function(ph,pq){return 0<ph&&0==(ph&ph-1)&&0<pq&&0==(pq&pq-1)},ph.setMatToArray=function(ph,pq){ph.a,ph.b,ph.c,ph.d,ph.tx,ph.ty,pq[0]=ph.a,pq[1]=ph.b,pq[4]=ph.c,pq[5]=ph.d,pq[12]=ph.tx,pq[13]=ph.ty}}(),function(){function ph(){this._controlPoints=[new pX,new pX,new pX],this._calFun=this.getPoint2}pe(ph,"laya.maths.Bezier");var pq=ph.prototype;return pq._switchPoint=function(ph,pq){var pf=this._controlPoints.shift();pf.setTo(ph,pq),this._controlPoints.push(pf)},pq.getPoint2=function(ph,pq){var pf=this._controlPoints[0],pg=this._controlPoints[1],p$=this._controlPoints[2],pP=Math.pow(1-ph,2)*pf.x+2*ph*(1-ph)*pg.x+Math.pow(ph,2)*p$.x,pS=Math.pow(1-ph,2)*pf.y+2*ph*(1-ph)*pg.y+Math.pow(ph,2)*p$.y;pq.push(pP,pS)},pq.getPoint3=function(ph,pq){var pf=this._controlPoints[0],pg=this._controlPoints[1],p$=this._controlPoints[2],pP=this._controlPoints[3],pS=Math.pow(1-ph,3)*pf.x+3*pg.x*ph*(1-ph)*(1-ph)+3*p$.x*ph*ph*(1-ph)+pP.x*Math.pow(ph,3),pB=Math.pow(1-ph,3)*pf.y+3*pg.y*ph*(1-ph)*(1-ph)+3*p$.y*ph*ph*(1-ph)+pP.y*Math.pow(ph,3);pq.push(pS,pB)},pq.insertPoints=function(ph,pq){var pf,pg=NaN;for(pf=1/(ph=0<ph?ph:5),pg=0;pg<=1;pg+=pf)this._calFun(pg,pq)},pq.getBezierPoints=function(ph,pq,pf){void 0===pq&&(pq=5),void 0===pf&&(pf=2);var pg,p$,pP=0;if((pg=ph.length)<2*(pf+1))return[];switch(p$=[],pf){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=pf;)this._controlPoints.push(new pX);for(pP=0;pP<2*pf;pP+=2)this._switchPoint(ph[pP],ph[pP+1]);for(pP=2*pf;pP<pg;pP+=2)this._switchPoint(ph[pP],ph[pP+1]),pP/2%pf==0&&this.insertPoints(pq,p$);return p$},pr(ph,["I",function(){return this.I=new ph}]),ph}()),pE=function(){function pY(){}return pe(pY,"laya.maths.GrahamScan"),pY.multiply=function(ph,pq,pf){return(ph.x-pf.x)*(pq.y-pf.y)-(pq.x-pf.x)*(ph.y-pf.y)},pY.dis=function(ph,pq){return(ph.x-pq.x)*(ph.x-pq.x)+(ph.y-pq.y)*(ph.y-pq.y)},pY._getPoints=function(ph,pq,pf){for(void 0===pq&&(pq=!1),pY._mPointList||(pY._mPointList=[]);pY._mPointList.length<ph;)pY._mPointList.push(new pX);return pf||(pf=[]),pf.length=0,pq?pY.getFrom(pf,pY._mPointList,ph):pY.getFromR(pf,pY._mPointList,ph),pf},pY.getFrom=function(ph,pq,pf){var pg=0;for(pg=0;pg<pf;pg++)ph.push(pq[pg]);return ph},pY.getFromR=function(ph,pq,pf){var pg=0;for(pg=0;pg<pf;pg++)ph.push(pq.pop());return ph},pY.pListToPointList=function(ph,pq){void 0===pq&&(pq=!1);var pf=0,pg=ph.length/2,p$=pY._getPoints(pg,pq,pY._tempPointList);for(pf=0;pf<pg;pf++)p$[pf].setTo(ph[pf+pf],ph[pf+pf+1]);return p$},pY.pointListToPlist=function(ph){var pq,pf=0,pg=ph.length,p$=pY._temPList;for(pf=p$.length=0;pf<pg;pf++)pq=ph[pf],p$.push(pq.x,pq.y);return p$},pY.scanPList=function(ph){return pO.copyArray(ph,pY.pointListToPlist(pY.scan(pY.pListToPointList(ph,!0))))},pY.scan=function(ph){var pq,pf,pg,p$=0,pP=0,pS=0,pB=ph.length,pr={};for((pf=pY._temArr).length=0,p$=(pB=ph.length)-1;0<=p$;p$--)pg=(pq=ph[p$]).x+"_"+pq.y,pr.hasOwnProperty(pg)||(pr[pg]=!0,pf.push(pq));for(pB=pf.length,pO.copyArray(ph,pf),p$=1;p$<pB;p$++)(ph[p$].y<ph[pS].y||ph[p$].y==ph[pS].y&&ph[p$].x<ph[pS].x)&&(pS=p$);for(pq=ph[0],ph[0]=ph[pS],ph[pS]=pq,p$=1;p$<pB-1;p$++){for(pP=(pS=p$)+1;pP<pB;pP++)(0<pY.multiply(ph[pP],ph[pS],ph[0])||0==pY.multiply(ph[pP],ph[pS],ph[0])&&pY.dis(ph[0],ph[pP])<pY.dis(ph[0],ph[pS]))&&(pS=pP);pq=ph[p$],ph[p$]=ph[pS],ph[pS]=pq}if((pf=pY._temArr).length=0,ph.length<3)return pO.copyArray(pf,ph);for(pf.push(ph[0],ph[1],ph[2]),p$=3;p$<pB;p$++){for(;2<=pf.length&&0<=pY.multiply(ph[p$],pf[pf.length-1],pf[pf.length-2]);)pf.pop();ph[p$]&&pf.push(ph[p$])}return pf},pY._mPointList=null,pY._tempPointList=[],pY._temPList=[],pY._temArr=[],pY}(),pR=function(){function p$(){}return pe(p$,"laya.maths.MathUtil"),p$.subtractVector3=function(ph,pq,pf){pf[0]=ph[0]-pq[0],pf[1]=ph[1]-pq[1],pf[2]=ph[2]-pq[2]},p$.lerp=function(ph,pq,pf){return ph*(1-pf)+pq*pf},p$.scaleVector3=function(ph,pq,pf){pf[0]=ph[0]*pq,pf[1]=ph[1]*pq,pf[2]=ph[2]*pq},p$.lerpVector3=function(ph,pq,pf,pg){var p$=ph[0],pP=ph[1],pS=ph[2];pg[0]=p$+pf*(pq[0]-p$),pg[1]=pP+pf*(pq[1]-pP),pg[2]=pS+pf*(pq[2]-pS)},p$.lerpVector4=function(ph,pq,pf,pg){var p$=ph[0],pP=ph[1],pS=ph[2],pB=ph[3];pg[0]=p$+pf*(pq[0]-p$),pg[1]=pP+pf*(pq[1]-pP),pg[2]=pS+pf*(pq[2]-pS),pg[3]=pB+pf*(pq[3]-pB)},p$.slerpQuaternionArray=function(ph,pq,pf,pg,p$,pP,pS){var pB,pr,pY,pC,pU,pu=ph[pq+0],pv=ph[pq+1],pL=ph[pq+2],pe=ph[pq+3],pl=pf[pg+0],p_=pf[pg+1],pN=pf[pg+2],pG=pf[pg+3];return(pr=pu*pl+pv*p_+pL*pN+pe*pG)<0&&(pr=-pr,pl=-pl,p_=-p_,pN=-pN,pG=-pG),pU=1e-6<1-pr?(pB=Math.acos(pr),pY=Math.sin(pB),pC=Math.sin((1-p$)*pB)/pY,Math.sin(p$*pB)/pY):(pC=1-p$,p$),pP[pS+0]=pC*pu+pU*pl,pP[pS+1]=pC*pv+pU*p_,pP[pS+2]=pC*pL+pU*pN,pP[pS+3]=pC*pe+pU*pG,pP},p$.getRotation=function(ph,pq,pf,pg){return Math.atan2(pg-pq,pf-ph)/Math.PI*180},p$.sortBigFirst=function(ph,pq){return ph==pq?0:ph<pq?1:-1},p$.sortSmallFirst=function(ph,pq){return ph==pq?0:ph<pq?-1:1},p$.sortNumBigFirst=function(ph,pq){return parseFloat(pq)-parseFloat(ph)},p$.sortNumSmallFirst=function(ph,pq){return parseFloat(ph)-parseFloat(pq)},p$.sortByKey=function(pf,ph,pq){var pg;return void 0===ph&&(ph=!1),void 0===pq&&(pq=!0),pg=ph?pq?p$.sortNumBigFirst:p$.sortBigFirst:pq?p$.sortNumSmallFirst:p$.sortSmallFirst,function(ph,pq){return pg(ph[pf],pq[pf])}},p$}(),pb=function(){function pf(ph,pq,pf,pg,p$,pP){this.inPool=!1,this.bTransform=!1,void 0===ph&&(ph=1),void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=1),void 0===p$&&(p$=0),void 0===pP&&(pP=0),this.a=ph,this.b=pq,this.c=pf,this.d=pg,this.tx=p$,this.ty=pP,this._checkTransform()}pe(pf,"laya.maths.Matrix");var ph=pf.prototype;return ph.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},ph._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},ph.setTranslate=function(ph,pq){return this.tx=ph,this.ty=pq,this},ph.translate=function(ph,pq){return this.tx+=ph,this.ty+=pq,this},ph.scale=function(ph,pq){this.a*=ph,this.d*=pq,this.c*=ph,this.b*=pq,this.tx*=ph,this.ty*=pq,this.bTransform=!0},ph.rotate=function(ph){var pq=Math.cos(ph),pf=Math.sin(ph),pg=this.a,p$=this.c,pP=this.tx;this.a=pg*pq-this.b*pf,this.b=pg*pf+this.b*pq,this.c=p$*pq-this.d*pf,this.d=p$*pf+this.d*pq,this.tx=pP*pq-this.ty*pf,this.ty=pP*pf+this.ty*pq,this.bTransform=!0},ph.skew=function(ph,pq){var pf=Math.tan(ph),pg=Math.tan(pq),p$=this.a,pP=this.b;return this.a+=pg*this.c,this.b+=pg*this.d,this.c+=pf*p$,this.d+=pf*pP,this},ph.invertTransformPoint=function(ph){var pq=this.a,pf=this.b,pg=this.c,p$=this.d,pP=this.tx,pS=pq*p$-pf*pg,pB=p$/pS,pr=-pf/pS,pY=-pg/pS,pC=pq/pS,pU=(pg*this.ty-p$*pP)/pS,pu=-(pq*this.ty-pf*pP)/pS;return ph.setTo(pB*ph.x+pY*ph.y+pU,pr*ph.x+pC*ph.y+pu)},ph.transformPoint=function(ph){return ph.setTo(this.a*ph.x+this.c*ph.y+this.tx,this.b*ph.x+this.d*ph.y+this.ty)},ph.transformPointN=function(ph){return ph.setTo(this.a*ph.x+this.c*ph.y,this.b*ph.x+this.d*ph.y)},ph.transformPointArray=function(ph,pq){for(var pf=ph.length,pg=0;pg<pf;pg+=2){var p$=ph[pg],pP=ph[pg+1];pq[pg]=this.a*p$+this.c*pP+this.tx,pq[pg+1]=this.b*p$+this.d*pP+this.ty}return pq},ph.transformPointArrayScale=function(ph,pq){for(var pf=ph.length,pg=0;pg<pf;pg+=2){var p$=ph[pg],pP=ph[pg+1];pq[pg]=this.a*p$+this.c*pP,pq[pg+1]=this.b*p$+this.d*pP}return pq},ph.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},ph.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},ph.invert=function(){var ph=this.a,pq=this.b,pf=this.c,pg=this.d,p$=this.tx,pP=ph*pg-pq*pf;return this.a=pg/pP,this.b=-pq/pP,this.c=-pf/pP,this.d=ph/pP,this.tx=(pf*this.ty-pg*p$)/pP,this.ty=-(ph*this.ty-pq*p$)/pP,this},ph.setTo=function(ph,pq,pf,pg,p$,pP){return this.a=ph,this.b=pq,this.c=pf,this.d=pg,this.tx=p$,this.ty=pP,this},ph.concat=function(ph){var pq=this.a,pf=this.c,pg=this.tx;return this.a=pq*ph.a+this.b*ph.c,this.b=pq*ph.b+this.b*ph.d,this.c=pf*ph.a+this.d*ph.c,this.d=pf*ph.b+this.d*ph.d,this.tx=pg*ph.a+this.ty*ph.c+ph.tx,this.ty=pg*ph.b+this.ty*ph.d+ph.ty,this},ph.scaleEx=function(ph,pq){var pf=this.a,pg=this.b,p$=this.c,pP=this.d;0!==pg||0!==p$?(this.a=ph*pf,this.b=ph*pg,this.c=pq*p$):(this.a=ph*pf,this.b=0*pP,this.c=0*pf),this.d=pq*pP,this.bTransform=!0},ph.rotateEx=function(ph){var pq=Math.cos(ph),pf=Math.sin(ph),pg=this.a,p$=this.b,pP=this.c,pS=this.d;0!==p$||0!==pP?(this.a=pq*pg+pf*pP,this.b=pq*p$+pf*pS,this.c=-pf*pg+pq*pP,this.d=-pf*p$+pq*pS):(this.a=pq*pg,this.b=pf*pS,this.c=-pf*pg,this.d=pq*pS),this.bTransform=!0},ph.clone=function(){var ph=pf.create();return ph.a=this.a,ph.b=this.b,ph.c=this.c,ph.d=this.d,ph.tx=this.tx,ph.ty=this.ty,ph.bTransform=this.bTransform,ph},ph.copyTo=function(ph){return ph.a=this.a,ph.b=this.b,ph.c=this.c,ph.d=this.d,ph.tx=this.tx,ph.ty=this.ty,ph.bTransform=this.bTransform,ph},ph.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},ph.destroy=function(){if(!this.inPool){var ph=pf._cache;this.inPool=!0,ph._length||(ph._length=0),(ph[ph._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},pf.mul=function(ph,pq,pf){var pg=ph.a,p$=ph.b,pP=ph.c,pS=ph.d,pB=ph.tx,pr=ph.ty,pY=pq.a,pC=pq.b,pU=pq.c,pu=pq.d,pv=pq.tx,pL=pq.ty;return 0!==pC||0!==pU?(pf.a=pg*pY+p$*pU,pf.b=pg*pC+p$*pu,pf.c=pP*pY+pS*pU,pf.d=pP*pC+pS*pu,pf.tx=pY*pB+pU*pr+pv,pf.ty=pC*pB+pu*pr+pL):(pf.a=pg*pY,pf.b=p$*pu,pf.c=pP*pY,pf.d=pS*pu,pf.tx=pY*pB+pv,pf.ty=pu*pr+pL),pf},pf.mul16=function(ph,pq,pf){var pg=ph.a,p$=ph.b,pP=ph.c,pS=ph.d,pB=ph.tx,pr=ph.ty,pY=pq.a,pC=pq.b,pU=pq.c,pu=pq.d,pv=pq.tx,pL=pq.ty;return 0!==pC||0!==pU?(pf[0]=pg*pY+p$*pU,pf[1]=pg*pC+p$*pu,pf[4]=pP*pY+pS*pU,pf[5]=pP*pC+pS*pu,pf[12]=pY*pB+pU*pr+pv,pf[13]=pC*pB+pu*pr+pL):(pf[0]=pg*pY,pf[1]=p$*pu,pf[4]=pP*pY,pf[5]=pS*pu,pf[12]=pY*pB+pv,pf[13]=pu*pr+pL),pf},pf.mulPre=function(ph,pq,pf,pg,p$,pP,pS,pB){var pr=ph.a,pY=ph.b,pC=ph.c,pU=ph.d,pu=ph.tx,pv=ph.ty;return 0!==pf||0!==pg?(pB.a=pr*pq+pY*pg,pB.b=pr*pf+pY*p$,pB.c=pC*pq+pU*pg,pB.d=pC*pf+pU*p$,pB.tx=pq*pu+pg*pv+pP,pB.ty=pf*pu+p$*pv+pS):(pB.a=pr*pq,pB.b=pY*p$,pB.c=pC*pq,pB.d=pU*p$,pB.tx=pq*pu+pP,pB.ty=p$*pv+pS),pB},pf.mulPos=function(ph,pq,pf,pg,p$,pP,pS,pB){var pr=ph.a,pY=ph.b,pC=ph.c,pU=ph.d,pu=ph.tx,pv=ph.ty;return 0!==pY||0!==pC?(pB.a=pq*pr+pf*pC,pB.b=pq*pY+pf*pU,pB.c=pg*pr+p$*pC,pB.d=pg*pY+p$*pU,pB.tx=pr*pP+pC*pS+pu,pB.ty=pY*pP+pU*pS+pv):(pB.a=pq*pr,pB.b=pf*pU,pB.c=pg*pr,pB.d=p$*pU,pB.tx=pr*pP+pu,pB.ty=pU*pS+pv),pB},pf.preMul=function(ph,pq,pf){var pg=ph.a,p$=ph.b,pP=ph.c,pS=ph.d,pB=pq.a,pr=pq.b,pY=pq.c,pC=pq.d,pU=pq.tx,pu=pq.ty;return pf.a=pB*pg,pf.b=pf.c=0,pf.d=pC*pS,pf.tx=pU*pg+ph.tx,pf.ty=pu*pS+ph.ty,0===pr&&0===pY&&0===p$&&0===pP||(pf.a+=pr*pP,pf.d+=pY*p$,pf.b+=pB*p$+pr*pS,pf.c+=pY*pg+pC*pP,pf.tx+=pu*pP,pf.ty+=pU*p$),pf},pf.preMulXY=function(ph,pq,pf,pg){var p$=ph.a,pP=ph.b,pS=ph.c,pB=ph.d;return pg.a=p$,pg.b=pP,pg.c=pS,pg.d=pB,pg.tx=pq*p$+ph.tx+pf*pS,pg.ty=pf*pB+ph.ty+pq*pP,pg},pf.create=function(){var ph=pf._cache,pq=ph._length?ph[--ph._length]:new pf;return pq.inPool=!1,pq},pf.EMPTY=new pf,pf.TEMP=new pf,pf._cache=[],pf}(),pX=function(){function ph(ph,pq){void 0===ph&&(ph=0),void 0===pq&&(pq=0),this.x=ph,this.y=pq}pe(ph,"laya.maths.Point");var pq=ph.prototype;return pq.setTo=function(ph,pq){return this.x=ph,this.y=pq,this},pq.distance=function(ph,pq){return Math.sqrt((this.x-ph)*(this.x-ph)+(this.y-pq)*(this.y-pq))},pq.toString=function(){return this.x+","+this.y},pq.normalize=function(){var ph=Math.sqrt(this.x*this.x+this.y*this.y);if(0<ph){var pq=1/ph;this.x*=pq,this.y*=pq}},ph.TEMP=new ph,ph.EMPTY=new ph,ph}(),pn=function(){function pY(ph,pq,pf,pg){void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=0),this.x=ph,this.y=pq,this.width=pf,this.height=pg}pe(pY,"laya.maths.Rectangle");var ph=pY.prototype;return ph.setTo=function(ph,pq,pf,pg){return this.x=ph,this.y=pq,this.width=pf,this.height=pg,this},ph.copyFrom=function(ph){return this.x=ph.x,this.y=ph.y,this.width=ph.width,this.height=ph.height,this},ph.contains=function(ph,pq){return!(this.width<=0||this.height<=0)&&(ph>=this.x&&ph<this.right&&pq>=this.y&&pq<this.bottom)},ph.intersects=function(ph){return!(ph.x>this.x+this.width||ph.x+ph.width<this.x||ph.y>this.y+this.height||ph.y+ph.height<this.y)},ph.intersection=function(ph,pq){return this.intersects(ph)?(pq||(pq=new pY),pq.x=Math.max(this.x,ph.x),pq.y=Math.max(this.y,ph.y),pq.width=Math.min(this.right,ph.right)-pq.x,pq.height=Math.min(this.bottom,ph.bottom)-pq.y,pq):null},ph.union=function(ph,pq){return pq||(pq=new pY),this.clone(pq),ph.width<=0||ph.height<=0?pq:(pq.addPoint(ph.x,ph.y),pq.addPoint(ph.right,ph.bottom),this)},ph.clone=function(ph){return ph||(ph=new pY),ph.x=this.x,ph.y=this.y,ph.width=this.width,ph.height=this.height,ph},ph.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},ph.equals=function(ph){return!(!ph||ph.x!==this.x||ph.y!==this.y||ph.width!==this.width||ph.height!==this.height)},ph.addPoint=function(ph,pq){return this.x>ph&&(this.width+=this.x-ph,this.x=ph),this.y>pq&&(this.height+=this.y-pq,this.y=pq),this.width<ph-this.x&&(this.width=ph-this.x),this.height<pq-this.y&&(this.height=pq-this.y),this},ph._getBoundPoints=function(){var ph=pY._temB;return(ph.length=0)==this.width||0==this.height||ph.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),ph},ph.isEmpty=function(){return this.width<=0||this.height<=0},pC(0,ph,"right",function(){return this.x+this.width}),pC(0,ph,"bottom",function(){return this.y+this.height}),pY._getBoundPointS=function(ph,pq,pf,pg){var p$=pY._temA;return(p$.length=0)==pf||0==pg||p$.push(ph,pq,ph+pf,pq,ph,pq+pg,ph+pf,pq+pg),p$},pY._getWrapRec=function(ph,pq){if(!ph||ph.length<1)return pq?pq.setTo(0,0,0,0):pY.TEMP.setTo(0,0,0,0);pq=pq||new pY;var pf,pg,p$,pP,pS,pB=ph.length,pr=pX.TEMP;for(p$=pS=-(pg=pP=99999),pf=0;pf<pB;pf+=2)pr.x=ph[pf],pr.y=ph[pf+1],pg=pg<pr.x?pg:pr.x,pP=pP<pr.y?pP:pr.y,p$=p$>pr.x?p$:pr.x,pS=pS>pr.y?pS:pr.y;return pq.setTo(pg,pP,p$-pg,pS-pP)},pY.EMPTY=new pY,pY.TEMP=new pY,pY._temB=[],pY._temA=[],pY}(),pA=function(){function pr(){}return pe(pr,"laya.media.SoundManager"),pC(1,pr,"useAudioMusic",function(){return pr._useAudioMusic},function(ph){pr._useAudioMusic=ph,pr._musicClass=ph?pfh:null}),pC(1,pr,"autoStopMusic",function(){return pr._autoStopMusic},function(ph){pt.stage.off("blur",null,pr._stageOnBlur),pt.stage.off("focus",null,pr._stageOnFocus),pt.stage.off("visibilitychange",null,pr._visibilityChange),(pr._autoStopMusic=ph)&&(pt.stage.on("blur",null,pr._stageOnBlur),pt.stage.on("focus",null,pr._stageOnFocus),pt.stage.on("visibilitychange",null,pr._visibilityChange))}),pC(1,pr,"muted",function(){return pr._muted},function(ph){ph!=pr._muted&&(ph&&pr.stopAllSound(),pr.musicMuted=ph,pr._muted=ph)}),pC(1,pr,"musicMuted",function(){return pr._musicMuted},function(ph){ph!=pr._musicMuted&&(ph?(pr._tMusic&&pr._musicChannel&&!pr._musicChannel.isStopped?pr._musicChannel.pause():pr._musicChannel=null,pr._musicMuted=ph):(pr._musicMuted=ph,pr._tMusic&&pr._musicChannel&&pr._musicChannel.resume()))}),pC(1,pr,"soundMuted",function(){return pr._soundMuted},function(ph){pr._soundMuted=ph}),pr.addChannel=function(ph){0<=pr._channels.indexOf(ph)||(pr._channels.push(ph),pr.autoReleaseSound&&0!=pr._notUsedCount&&pr._notUsedUrls[ph.url]&&(delete pr._notUsedUrls[ph.url],0==--pr._notUsedCount&&pt.timer.clear(pr,pr.disposeSoundIfNotUsed)))},pr.removeChannel=function(ph){var pq=pr._channels,pf=pq.indexOf(ph);if(-1!=pf&&(pq.splice(pf,1),pr.autoReleaseSound)){var pg=ph.url,p$=pr.defaultIntervals[pg]||2e4;if(0<p$){var pP=!0;for(pf=pq.length-1;0<=pf;pf--)if(pq[pf].url==pg){pP=!1;break}pP&&(pr._notUsedUrls[pg]=Date.now()+p$,0==pr._notUsedCount++&&pt.timer.loop(1e4,pr,pr.disposeSoundIfNotUsed))}}},pr.disposeSoundIfNotUsed=function(){var ph=pr._notUsedUrls;if(0!=pr._notUsedCount){var pq=Date.now();for(var pf in ph)pq>=ph[pf]&&(delete ph[pf],--pr._notUsedCount,pr.destroySound(pf));if(0!=pr._notUsedCount)return}pt.timer.clear(pr,pr.disposeSoundIfNotUsed)},pr._visibilityChange=function(){pt.stage.isVisibility?pr._stageOnFocus():pr._stageOnBlur()},pr._stageOnBlur=function(){pr._isActive=!1,pr._musicChannel&&(pr._musicChannel.isStopped||(pr._blurPaused=!0,pr._musicChannel.pause())),pr.stopAllSound(),pt.stage.once("mousedown",null,pr._stageOnFocus)},pr._recoverWebAudio=function(){pPh.ctx&&"running"!=pPh.ctx.state&&pPh.ctx.resume&&pPh.ctx.resume()},pr._stageOnFocus=function(){if(pr._isActive=!0,pr._recoverWebAudio(),pt.stage.off("mousedown",null,pr._stageOnFocus),pr._blurPaused){var ph=pr._musicChannel;ph&&pr._music&&ph.isStopped&&(pr._blurPaused=!1,pr._music._disposed?pr.playMusic(ph.url,ph.loops,ph.startHandler,ph.completeHandler,ph.startTime):ph.audioBuffer?ph.resume():pr._music.play(ph.startTime,ph.loops,ph.startHandler,ph))}},pr.playSound=function(ph,pq,pf,pg,p$,pP){if(void 0===pq&&(pq=1),void 0===pP&&(pP=0),!ph)return null;if(pr._muted)return null;if(pr._recoverWebAudio(),ph==pr._tMusic){if(pr._musicMuted)return null}else{if(!pr._isActive)return null;if(pr._soundMuted)return null}var pS,pB=pr._pool[ph];return p$||(p$=pr._soundClass),pB||((pB=new p$).load(ph),pr._pool[ph]=pB),(pS=pB.play(pP,pq,pf))?(ph==pr._tMusic&&(pr._music=pB,pr._isActive||(pr._blurPaused=!0,pS.pause())),pS.url=ph,pS.volume=ph==pr._tMusic?pr.musicVolume:pr.soundVolume,pS.completeHandler=pg,pS):null},pr.destroySound=function(ph){var pq=pr._pool[ph];pq&&(delete pr._pool[ph],pq.dispose())},pr.playMusic=function(ph,pq,pf,pg,p$){return void 0===pq&&(pq=0),void 0===p$&&(p$=0),pr._tMusic=ph,pr._musicChannel&&pr._musicChannel.stop(),pr._musicChannel=pr.playSound(ph,pq,pf,pg,null,p$)},pr.stopSound=function(ph){for(var pq,pf=pr._channels.length-1;0<=pf;pf--)(pq=pr._channels[pf]).url==ph&&pq.stop()},pr.stopAll=function(){pr._tMusic=null;var ph=0;for(ph=pr._channels.length-1;0<=ph;ph--)pr._channels[ph].stop()},pr.stopAllSound=function(){var ph,pq=0;for(pq=pr._channels.length-1;0<=pq;pq--)(ph=pr._channels[pq]).url!=pr._tMusic&&ph.stop()},pr.stopMusic=function(){pr._musicChannel&&pr._musicChannel.stop(),pr._tMusic=null},pr.setSoundVolume=function(ph,pq){if(pq)pr._setVolume(pq,ph);else{pr.soundVolume=ph;var pf,pg=0;for(pg=pr._channels.length-1;0<=pg;pg--)(pf=pr._channels[pg]).url!=pr._tMusic&&(pf.volume=ph)}},pr.setMusicVolume=function(ph){pr.musicVolume=ph,pr._setVolume(pr._tMusic,ph)},pr._setVolume=function(ph,pq){for(var pf,pg=pr._channels.length-1;0<=pg;pg--)(pf=pr._channels[pg]).url==ph&&(pf.volume=pq)},pr.musicVolume=1,pr.soundVolume=1,pr.playbackRate=1,pr._useAudioMusic=!0,pr._muted=!1,pr._soundMuted=!1,pr._musicMuted=!1,pr._tMusic=null,pr._musicChannel=null,pr._music=null,pr._channels=[],pr._autoStopMusic=!1,pr._blurPaused=!1,pr._isActive=!0,pr._soundClass=null,pr._musicClass=null,pr.autoReleaseSound=!0,pr._pool={},pr.defaultIntervals={},pr._notUsedUrls={},pr._notUsedCount=0,pr}(),pJ=function(){var ph;function pf(){}return pe(pf,"laya.net.LocalStorage"),pf.__init__=function(){pf._baseClass||(pf._baseClass=ph).init(),pf.items=pf._baseClass.items,pf.support=pf._baseClass.support},pf.setItem=function(ph,pq){pf._baseClass.setItem(ph,pq)},pf.getItem=function(ph){return pf._baseClass.getItem(ph)},pf.setJSON=function(ph,pq){pf._baseClass.setJSON(ph,pq)},pf.getJSON=function(ph){return pf._baseClass.getJSON(ph)},pf.removeItem=function(ph){pf._baseClass.removeItem(ph)},pf.clear=function(){pf._baseClass.clear()},pf._baseClass=null,pf.items=null,pf.support=!1,pf.__init$=function(){ph=function(){function pf(){}return pe(pf,""),pf.init=function(){try{pf.support=!0,pf.items=pS.localStorage,pf.setItem("laya","1"),pf.removeItem("laya")}catch(ph){pf.support=!1}pf.support||console.log("LocalStorage is not supprot or browser is private mode.")},pf.setItem=function(ph,pq){try{pf.support&&pf.items.setItem(ph,pq)}catch(ph){console.warn("set localStorage failed",ph)}},pf.getItem=function(ph){return pf.support?pf.items.getItem(ph):null},pf.setJSON=function(ph,pq){try{pf.support&&pf.items.setItem(ph,JSON.stringify(pq))}catch(ph){console.warn("set localStorage failed",ph)}},pf.getJSON=function(ph){return JSON.parse(pf.support?pf.items.getItem(ph):null)},pf.removeItem=function(ph){pf.support&&pf.items.removeItem(ph)},pf.clear=function(){pf.support&&pf.items.clear()},pf.items=null,pf.support=!1,pf}()},pf}(),pi=(function(){function pg(){}pe(pg,"laya.net.ResourceVersion"),pg.enable=function(ph,pq,pf){void 0===pf&&(pf=2),laya.net.ResourceVersion.type=pf,pt.loader.load(ph,pN.create(null,pg.onManifestLoaded,[pq]),null,"json"),pz.customFormat=pg.addVersionPrefix},pg.onManifestLoaded=function(ph,pq){pg.manifest=pq,ph.run(),pq||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},pg.addVersionPrefix=function(ph){return pg.manifest&&pg.manifest[ph]?2==pg.type?pg.manifest[ph]:pg.manifest[ph]+"/"+ph:ph},pg.FOLDER_VERSION=1,pg.FILENAME_VERSION=2,pg.manifest=null,pg.type=1}(),function(){function ph(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}pe(ph,"laya.net.TTFLoader");var pq=ph.prototype;return pq.load=function(ph){var pq=(this._url=ph).split(".ttf")[0].split("/");this.fontName=pq[pq.length-1],pw.window.conch?this._loadConch():pw.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},pq._loadConch=function(){this._http=new pSh,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},pq._onHttpLoaded=function(ph){pw.window.conch.setFontFaceFromBuffer(this.fontName,ph),this._clearHttp(),this._complete()},pq._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},pq._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},pq._complete=function(){pt.timer.clear(this,this._complete),pt.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},pq._checkComplete=function(){pd.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},pq._loadWithFontFace=function(){var ph=new pw.window.FontFace(this.fontName,"url('"+this._url+"')");pw.window.document.fonts.add(ph);var pq=this;ph.loaded.then(function(){pq._complete()}),ph.load()},pq._createDiv=function(){this._div=pw.createElement("div"),this._div.innerHTML="laya";var ph=this._div.style;ph.fontFamily=this.fontName,ph.position="absolute",ph.left="-100px",ph.top="-100px",pw.document.body.appendChild(this._div)},pq._loadWithCSS=function(){var ph=this,pq=pw.createElement("style");pq.type="text/css",pw.document.body.appendChild(pq),pq.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=pd.measureText("LayaTTFFont",this._fontTxt).width;var pf=this;pq.onload=function(){pt.timer.once(1e4,pf,ph._complete)},pt.timer.loop(20,this,this._checkComplete),this._createDiv()},ph._testString="LayaTTFFont",ph}()),pz=function(){function pg(ph){this._url=null,this._path=null,this._url=pg.formatURL(ph),this._path=pg.getPath(ph)}pe(pg,"laya.net.URL");var ph=pg.prototype;return pC(0,ph,"path",function(){return this._path}),pC(0,ph,"url",function(){return this._url}),pg.formatURL=function(ph,pq){if(!ph)return"null path";if(0<ph.indexOf(":"))return ph;null!=pg.customFormat&&(ph=pg.customFormat(ph,pq));var pf=ph.charAt(0);if("."===pf)return pg.formatRelativePath((pq||pg.basePath)+ph);if("~"===pf)return pg.rootPath+ph.substring(1);if("d"===pf){if(0===ph.indexOf("data:image"))return ph}else if("/"===pf)return ph;return(pq||pg.basePath)+ph},pg.formatRelativePath=function(ph){for(var pq=ph.split("/"),pf=0,pg=pq.length;pf<pg;pf++)".."==pq[pf]&&(pq.splice(pf-1,2),pf-=2);return pq.join("/")},pg.isAbsolute=function(ph){return 0<ph.indexOf(":")||"/"==ph.charAt(0)},pg.getPath=function(ph){var pq=ph.lastIndexOf("/");return 0<pq?ph.substr(0,pq+1):""},pg.getFileName=function(ph){var pq=ph.lastIndexOf("/");return 0<pq?ph.substr(pq+1):ph},pg.version={},pg.basePath="",pg.rootPath="",pg.customFormat=function(ph){var pq=pg.version[ph];return!pc.isConchApp&&pq&&(ph+="?v="+pq),ph},pg}(),pc=function(){function p$(ph,pq){this._timeId=0;var pf=p$._mainCanvas.source.style;pf.position="absolute",pf.top=pf.left="0px",pf.background="#000000",p$._mainCanvas.source.id="layaCanvas";var pg=laya.renders.Render.isWebGL;p$._mainCanvas.source.width=ph,p$._mainCanvas.source.height=pq,pg&&p$.WebGL.init(p$._mainCanvas,ph,pq),pw.container.appendChild(p$._mainCanvas.source),(p$._context=new pM(ph,pq,pg?null:p$._mainCanvas)).ctx.setIsMainContext(),pw.window.requestAnimationFrame(function ph(pq){pw.window.requestAnimationFrame(ph);pt.stage._loop()}),pt.stage.on("visibilitychange",this,this._onVisibilitychange)}pe(p$,"laya.renders.Render");var ph=p$.prototype;return ph._onVisibilitychange=function(){pt.stage.isVisibility?0!=this._timeId&&pw.window.clearInterval(this._timeId):this._timeId=pw.window.setInterval(this._enterFrame,1e3)},ph._enterFrame=function(ph){pt.stage._loop()},pC(1,p$,"context",function(){return p$._context}),pC(1,p$,"canvas",function(){return p$._mainCanvas.source}),p$._context=null,p$._mainCanvas=null,p$.WebGL=null,p$.isConchNode=!1,p$.isConchApp=!1,p$.isConchWebGL=!1,p$.isWebGL=!1,p$.is3DMode=!1,p$.optimizeTextureMemory=function(ph,pq){return!0},p$.__init$=function(){pS.ConchRenderType=pS.ConchRenderType||1,pS.ConchRenderType|=pS.conch?4:0,p$.isConchNode=5==(5&pS.ConchRenderType),p$.isConchApp=4==(4&pS.ConchRenderType),p$.isConchWebGL=6==pS.ConchRenderType},p$}(),pM=function(){function pS(ph,pq,pf){this.x=0,this.y=0,this._drawTexture=function(ph,pq,pf){pf[0].loaded&&this.ctx.drawTexture(pf[0],pf[1],pf[2],pf[3],pf[4],ph,pq)},this._fillTexture=function(ph,pq,pf){pf[0].loaded&&this.ctx.fillTexture(pf[0],pf[1]+ph,pf[2]+pq,pf[3],pf[4],pf[5],pf[6],pf[7])},this._drawTextureWithTransform=function(ph,pq,pf){pf[0].loaded&&this.ctx.drawTextureWithTransform(pf[0],pf[1],pf[2],pf[3],pf[4],pf[5],ph,pq,pf[6])},this._fillQuadrangle=function(ph,pq,pf){this.ctx.fillQuadrangle(pf[0],pf[1],pf[2],pf[3],pf[4])},this._drawRect=function(ph,pq,pf){var pg=this.ctx;null!=pf[4]&&(pg.fillStyle=pf[4],pg.fillRect(ph+pf[0],pq+pf[1],pf[2],pf[3],null)),null!=pf[5]&&(pg.strokeStyle=pf[5],pg.lineWidth=pf[6],pg.strokeRect(ph+pf[0],pq+pf[1],pf[2],pf[3],pf[6]))},this._drawPie=function(ph,pq,pf){var pg=this.ctx;pc.isWebGL&&pg.setPathId(pf[8]),pg.beginPath(),pc.isWebGL?(pg.movePath(pf[0]+ph,pf[1]+pq),pg.moveTo(0,0)):pg.moveTo(ph+pf[0],pq+pf[1]),pg.arc(ph+pf[0],pq+pf[1],pf[2],pf[3],pf[4]),pg.closePath(),this._fillAndStroke(pf[5],pf[6],pf[7],!0)},this._clipRect=function(ph,pq,pf){this.ctx.clipRect(ph+pf[0],pq+pf[1],pf[2],pf[3])},this._fillRect=function(ph,pq,pf){this.ctx.fillRect(ph+pf[0],pq+pf[1],pf[2],pf[3],pf[4])},this._drawCircle=function(ph,pq,pf){var pg=this.ctx;pc.isWebGL&&pg.setPathId(pf[6]),pZ.drawCall++,pg.beginPath(),pc.isWebGL&&pg.movePath(pf[0]+ph,pf[1]+pq),pg.arc(pf[0]+ph,pf[1]+pq,pf[2],0,pS.PI2),pg.closePath(),this._fillAndStroke(pf[3],pf[4],pf[5],!0)},this._fillCircle=function(ph,pq,pf){pZ.drawCall++;var pg=this.ctx;pg.beginPath(),pg.fillStyle=pf[3],pg.arc(pf[0]+ph,pf[1]+pq,pf[2],0,pS.PI2),pg.fill()},this._setShader=function(ph,pq,pf){this.ctx.setShader(pf[0])},this._drawLine=function(ph,pq,pf){var pg=this.ctx;pc.isWebGL&&pg.setPathId(pf[6]),pg.beginPath(),pg.strokeStyle=pf[4],pg.lineWidth=pf[5],pc.isWebGL?(pg.movePath(ph,pq),pg.moveTo(pf[0],pf[1]),pg.lineTo(pf[2],pf[3])):(pg.moveTo(ph+pf[0],pq+pf[1]),pg.lineTo(ph+pf[2],pq+pf[3])),pg.stroke()},this._drawLines=function(ph,pq,pf){var pg=this.ctx;pc.isWebGL&&pg.setPathId(pf[5]),pg.beginPath(),ph+=pf[0],pq+=pf[1],pc.isWebGL&&pg.movePath(ph,pq),pg.strokeStyle=pf[3],pg.lineWidth=pf[4];var p$=pf[2],pP=2,pS=p$.length;if(pc.isWebGL)for(pg.moveTo(p$[0],p$[1]);pP<pS;)pg.lineTo(p$[pP++],p$[pP++]);else for(pg.moveTo(ph+p$[0],pq+p$[1]);pP<pS;)pg.lineTo(ph+p$[pP++],pq+p$[pP++]);pg.stroke()},this._drawLinesWebGL=function(ph,pq,pf){this.ctx.drawLines(ph+this.x+pf[0],pq+this.y+pf[1],pf[2],pf[3],pf[4])},this._drawCurves=function(ph,pq,pf){this.ctx.drawCurves(ph,pq,pf)},this._draw=function(ph,pq,pf){pf[0].call(null,this,ph,pq)},this._transformByMatrix=function(ph,pq,pf){this.ctx.transformByMatrix(pf[0])},this._setTransform=function(ph,pq,pf){this.ctx.setTransform(pf[0],pf[1],pf[2],pf[3],pf[4],pf[5])},this._setTransformByMatrix=function(ph,pq,pf){this.ctx.setTransformByMatrix(pf[0])},this._save=function(ph,pq,pf){this.ctx.save()},this._restore=function(ph,pq,pf){this.ctx.restore()},this._translate=function(ph,pq,pf){this.ctx.translate(pf[0],pf[1])},this._transform=function(ph,pq,pf){this.ctx.translate(pf[1]+ph,pf[2]+pq);var pg=pf[0];this.ctx.transform(pg.a,pg.b,pg.c,pg.d,pg.tx,pg.ty),this.ctx.translate(-ph-pf[1],-pq-pf[2])},this._rotate=function(ph,pq,pf){this.ctx.translate(pf[1]+ph,pf[2]+pq),this.ctx.rotate(pf[0]),this.ctx.translate(-ph-pf[1],-pq-pf[2])},this._scale=function(ph,pq,pf){this.ctx.translate(pf[2]+ph,pf[3]+pq),this.ctx.scale(pf[0],pf[1]),this.ctx.translate(-ph-pf[2],-pq-pf[3])},this._alpha=function(ph,pq,pf){this.ctx.globalAlpha*=pf[0]},this._setAlpha=function(ph,pq,pf){this.ctx.globalAlpha=pf[0]},this._fillText=function(ph,pq,pf){this.ctx.fillText(pf[0],pf[1]+ph,pf[2]+pq,pf[3],pf[4],pf[5])},this._strokeText=function(ph,pq,pf){this.ctx.strokeText(pf[0],pf[1]+ph,pf[2]+pq,pf[3],pf[4],pf[5],pf[6])},this._fillBorderText=function(ph,pq,pf){this.ctx.fillBorderText(pf[0],pf[1]+ph,pf[2]+pq,pf[3],pf[4],pf[5],pf[6],pf[7])},this._blendMode=function(ph,pq,pf){this.ctx.globalCompositeOperation=pf[0]},this._beginClip=function(ph,pq,pf){this.ctx.beginClip&&this.ctx.beginClip(ph+pf[0],pq+pf[1],pf[2],pf[3])},this._setIBVB=function(ph,pq,pf){this.ctx.setIBVB(pf[0]+ph,pf[1]+pq,pf[2],pf[3],pf[4],pf[5],pf[6],pf[7])},this._fillTrangles=function(ph,pq,pf){this.ctx.fillTrangles(pf[0],pf[1]+ph,pf[2]+pq,pf[3],pf[4])},this._drawPath=function(ph,pq,pf){var pg=this.ctx;pc.isWebGL&&pg.setPathId(-1),pg.beginPath(),ph+=pf[0],pq+=pf[1],pc.isWebGL&&pg.movePath(ph,pq);for(var p$=pf[2],pP=0,pS=p$.length;pP<pS;pP++){var pB=p$[pP];switch(pB[0]){case"moveTo":pc.isWebGL?pg.moveTo(pB[1],pB[2]):pg.moveTo(ph+pB[1],pq+pB[2]);break;case"lineTo":pc.isWebGL?pg.lineTo(pB[1],pB[2]):pg.lineTo(ph+pB[1],pq+pB[2]);break;case"arcTo":pc.isWebGL?pg.arcTo(pB[1],pB[2],pB[3],pB[4],pB[5]):pg.arcTo(ph+pB[1],pq+pB[2],ph+pB[3],pq+pB[4],pB[5]);break;case"closePath":pg.closePath()}}var pr=pf[3];null!=pr&&(pg.fillStyle=pr.fillStyle,pg.fill());var pY=pf[4];null!=pY&&(pg.strokeStyle=pY.strokeStyle,pg.lineWidth=pY.lineWidth||1,pg.lineJoin=pY.lineJoin,pg.lineCap=pY.lineCap,pg.miterLimit=pY.miterLimit,pg.stroke())},this.drawPoly=function(ph,pq,pf){this.ctx.drawPoly(ph+this.x+pf[0],pq+this.y+pf[1],pf[2],pf[3],pf[4],pf[5],pf[6])},this._drawPoly=function(ph,pq,pf){var pg=this.ctx,p$=pf[2],pP=2,pS=p$.length;if(pc.isWebGL)for(pg.setPathId(pf[6]),pg.beginPath(),ph+=pf[0],pq+=pf[1],pg.movePath(ph,pq),pg.moveTo(p$[0],p$[1]);pP<pS;)pg.lineTo(p$[pP++],p$[pP++]);else for(pg.beginPath(),ph+=pf[0],pq+=pf[1],pg.moveTo(ph+p$[0],pq+p$[1]);pP<pS;)pg.lineTo(ph+p$[pP++],pq+p$[pP++]);pg.closePath(),this._fillAndStroke(pf[3],pf[4],pf[5],pf[7])},this._drawSkin=function(ph,pq,pf){var pg=pf[0];if(pg){var p$=this.ctx;pg.render(p$,ph,pq)}},this._drawParticle=function(ph,pq,pf){this.ctx.drawParticle(ph+this.x,pq+this.y,pf[0])},this._setFilters=function(ph,pq,pf){this.ctx.setFilters(pf)},pf?this.ctx=pf.getContext("2d"):(pf=pGh.create("3D"),this.ctx=pd.createWebGLContext2D(pf),pf._setContext(this.ctx)),pf.size(ph,pq),this.canvas=pf}pe(pS,"laya.renders.RenderContext");var ph=pS.prototype;return ph.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},ph.drawTexture=function(ph,pq,pf,pg,p$){ph.loaded&&this.ctx.drawTexture(ph,pq,pf,pg,p$,this.x,this.y)},ph._drawTextures=function(ph,pq,pf){pf[0].loaded&&this.ctx.drawTextures(pf[0],pf[1],ph+this.x,pq+this.y)},ph.drawTextureWithTransform=function(ph,pq,pf,pg,p$,pP,pS){ph.loaded&&this.ctx.drawTextureWithTransform(ph,pq,pf,pg,p$,pP,this.x,this.y,pS)},ph.fillQuadrangle=function(ph,pq,pf,pg,p$){this.ctx.fillQuadrangle(ph,pq,pf,pg,p$)},ph.drawCanvas=function(ph,pq,pf,pg,p$){this.ctx.drawCanvas(ph,pq+this.x,pf+this.y,pg,p$)},ph.drawRect=function(ph,pq,pf,pg,p$,pP){void 0===pP&&(pP=1);var pS=this.ctx;pS.strokeStyle=p$,pS.lineWidth=pP,pS.strokeRect(ph+this.x,pq+this.y,pf,pg,pP)},ph._fillAndStroke=function(ph,pq,pf,pg){void 0===pg&&(pg=!1);var p$=this.ctx;null!=ph&&(p$.fillStyle=ph,pc.isWebGL?p$.fill(pg):p$.fill()),null!=pq&&0<pf&&(p$.strokeStyle=pq,p$.lineWidth=pf,p$.stroke())},ph.clipRect=function(ph,pq,pf,pg){this.ctx.clipRect(ph+this.x,pq+this.y,pf,pg)},ph.fillRect=function(ph,pq,pf,pg,p$){this.ctx.fillRect(ph+this.x,pq+this.y,pf,pg,p$)},ph.drawCircle=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=1),pZ.drawCall++;var pP=this.ctx;pP.beginPath(),pP.strokeStyle=pg,pP.lineWidth=p$,pP.arc(ph+this.x,pq+this.y,pf,0,pS.PI2),pP.stroke()},ph.drawTriangles=function(ph,pq,pf){if(pc.isWebGL)this.ctx.drawTriangles(pf[0],ph+pf[1],pq+pf[2],pf[3],pf[4],pf[5],pf[6],pf[7],pf[8],pf[9]);else{var pg=pf[5],p$=0,pP=pg.length,pS=this.ctx;for(p$=0;p$<pP;p$+=3){var pB=2*pg[p$],pr=2*pg[p$+1],pY=2*pg[p$+2];pS.drawTriangle(pf[0],pf[3],pf[4],pB,pr,pY,pf[6],!0)}}},ph.fillCircle=function(ph,pq,pf,pg){pZ.drawCall++;var p$=this.ctx;p$.beginPath(),p$.fillStyle=pg,p$.arc(ph+this.x,pq+this.y,pf,0,pS.PI2),p$.fill()},ph.setShader=function(ph){this.ctx.setShader(ph)},ph.drawLine=function(ph,pq,pf,pg,p$,pP){void 0===pP&&(pP=1);var pS=this.ctx;pS.beginPath(),pS.strokeStyle=p$,pS.lineWidth=pP,pS.moveTo(this.x+ph,this.y+pq),pS.lineTo(this.x+pf,this.y+pg),pS.stroke()},ph.clear=function(){this.ctx.clear()},ph.transformByMatrix=function(ph){this.ctx.transformByMatrix(ph)},ph.setTransform=function(ph,pq,pf,pg,p$,pP){this.ctx.setTransform(ph,pq,pf,pg,p$,pP)},ph.setTransformByMatrix=function(ph){this.ctx.setTransformByMatrix(ph)},ph.save=function(){this.ctx.save()},ph.restore=function(){this.ctx.restore()},ph.translate=function(ph,pq){this.ctx.translate(ph,pq)},ph.transform=function(ph,pq,pf,pg,p$,pP){this.ctx.transform(ph,pq,pf,pg,p$,pP)},ph.rotate=function(ph){this.ctx.rotate(ph)},ph.scale=function(ph,pq){this.ctx.scale(ph,pq)},ph.alpha=function(ph){this.ctx.globalAlpha*=ph},ph.setAlpha=function(ph){this.ctx.globalAlpha=ph},ph.fillWords=function(ph,pq,pf,pg,p$,pP){void 0===pP&&(pP=0),this.ctx.fillWords(ph,pq,pf,pg,p$,pP)},ph.fillBorderWords=function(ph,pq,pf,pg,p$,pP,pS){this.ctx.fillBorderWords(ph,pq,pf,pg,p$,pP,pS)},ph.fillText=function(ph,pq,pf,pg,p$,pP){this.ctx.fillText(ph,pq+this.x,pf+this.y,pg,p$,pP)},ph.strokeText=function(ph,pq,pf,pg,p$,pP,pS){this.ctx.strokeText(ph,pq+this.x,pf+this.y,pg,p$,pP,pS)},ph.blendMode=function(ph){this.ctx.globalCompositeOperation=ph},ph.flush=function(){this.ctx.flush&&this.ctx.flush()},ph.addRenderObject=function(ph){this.ctx.addRenderObject(ph)},ph.beginClip=function(ph,pq,pf,pg){this.ctx.beginClip&&this.ctx.beginClip(ph,pq,pf,pg)},ph.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},ph.fillTrangles=function(ph,pq,pf){this.ctx.fillTrangles(pf[0],pf[1],pf[2],pf[3],4<pf.length?pf[4]:null)},pS.PI2=2*Math.PI,pS}(),pW=function(){function pS(ph,pq){switch(this._next=pq||pS.NORENDER,ph){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=p_._filter);case 69905:return void(this._fun=pS._initRenderFun)}this.onCreate(ph)}pe(pS,"laya.renders.RenderSprite");var ph=pS.prototype;return ph.onCreate=function(ph){},ph._style=function(ph,pq,pf,pg){ph._style.render(ph,pq,pf,pg);var p$=this._next;p$._fun.call(p$,ph,pq,pf,pg)},ph._no=function(ph,pq,pf,pg){},ph._custom=function(ph,pq,pf,pg){ph.customRender(pq,pf,pg);var p$=ph._style._tf;this._next._fun.call(this._next,ph,pq,pf-p$.translateX,pg-p$.translateY)},ph._clip=function(ph,pq,pf,pg){var p$=this._next;if(p$!=pS.NORENDER){var pP=ph._style.scrollRect;pq.ctx.save(),pq.ctx.clipRect(pf,pg,pP.width,pP.height),p$._fun.call(p$,ph,pq,pf-pP.x,pg-pP.y),pq.ctx.restore()}},ph._blend=function(ph,pq,pf,pg){var p$=ph._style;p$.blendMode&&(pq.ctx.globalCompositeOperation=p$.blendMode);var pP=this._next;pP._fun.call(pP,ph,pq,pf,pg),pq.ctx.globalCompositeOperation="source-over"},ph._mask=function(ph,pq,pf,pg){var p$=this._next;p$._fun.call(p$,ph,pq,pf,pg);var pP=ph.mask;pP&&(pq.ctx.globalCompositeOperation="destination-in",(0<pP.numChildren||!pP.graphics._isOnlyOne())&&(pP.cacheAsBitmap=!0),pP.render(pq,pf-ph.pivotX,pg-ph.pivotY)),pq.ctx.globalCompositeOperation="source-over"},ph._graphics=function(ph,pq,pf,pg){var p$=ph._style._tf;ph._graphics&&ph._graphics._render(ph,pq,pf-p$.translateX,pg-p$.translateY);var pP=this._next;pP._fun.call(pP,ph,pq,pf,pg)},ph._image=function(ph,pq,pf,pg){var p$=ph._style;pq.ctx.drawTexture2(pf,pg,p$._tf.translateX,p$._tf.translateY,ph.transform,p$.alpha,p$.blendMode,ph._graphics._one)},ph._image2=function(ph,pq,pf,pg){var p$=ph._style._tf;pq.ctx.drawTexture2(pf,pg,p$.translateX,p$.translateY,ph.transform,1,null,ph._graphics._one)},ph._alpha=function(ph,pq,pf,pg){var p$;if(.01<(p$=ph._style.alpha)||ph._needRepaint()){var pP=pq.ctx.globalAlpha;pq.ctx.globalAlpha*=p$;var pS=this._next;pS._fun.call(pS,ph,pq,pf,pg),pq.ctx.globalAlpha=pP}},ph._transform=function(ph,pq,pf,pg){var p$=ph.transform,pP=this._next;p$&&pP!=pS.NORENDER?(pq.save(),pq.transform(p$.a,p$.b,p$.c,p$.d,p$.tx+pf,p$.ty+pg),pP._fun.call(pP,ph,pq,0,0),pq.restore()):pP._fun.call(pP,ph,pq,pf,pg)},ph._childs=function(ph,pq,pf,pg){var p$=ph._style,pP=p$._tf;if(pf=pf-pP.translateX+p$.paddingLeft,pg=pg-pP.translateY+p$.paddingTop,p$._calculation){var pS=ph._getWords();if(pS){var pB=p$;pB&&(pB.stroke?pq.fillBorderWords(pS,pf,pg,pB.font,pB.color,pB.strokeColor,pB.stroke):pq.fillWords(pS,pf,pg,pB.font,pB.color,"none"!=pB.textDecoration&&pB.underLine?1:0))}}var pr,pY=ph._childs,pC=pY.length;if(ph.viewport||ph.optimizeScrollRect&&ph._style.scrollRect){var pU=ph.viewport||ph._style.scrollRect,pu=pU.x,pv=pU.y,pL=pU.right,pe=pU.bottom,pl=NaN,p_=NaN;for(pN=0;pN<pC;++pN)(pr=pY[pN]).visible&&(pl=pr._x)<pL&&pl+pr.width>pu&&(p_=pr._y)<pe&&p_+pr.height>pv&&pr.render(pq,pf,pg)}else for(var pN=0;pN<pC;++pN)(pr=pY[pN])._style.visible&&pr.render(pq,pf,pg)},ph._canvas=function(ph,pq,pf,pg){var p$=ph._$P.cacheCanvas;if(p$){"bitmap"===p$.type?pZ.canvasBitmap++:pZ.canvasNormal++;var pP=p$.ctx;if(ph._needRepaint()||!pP)this._canvas_repaint(ph,pq,pf,pg);else{var pS=p$._cacheRec;pq.drawCanvas(pP.canvas,pf+pS.x,pg+pS.y,pS.width,pS.height)}}else this._next._fun.call(this._next,ph,pq,pf,pg)},ph._canvas_repaint=function(ph,pq,pf,pg){var p$=ph._$P.cacheCanvas,pP=this._next;if(p$){var pS,pB,pr,pY,pC=p$.ctx,pU=ph._needRepaint()||!pC,pu=p$.type;if("bitmap"===pu?pZ.canvasBitmap++:pZ.canvasNormal++,pU){var pv,pL;p$._cacheRec||(p$._cacheRec=new pn),pc.isWebGL&&"bitmap"!==pu?p$._cacheRec.setTo(-ph.pivotX,-ph.pivotY,1,1):((pY=ph.getSelfBounds()).x=pY.x-ph.pivotX,pY.y=pY.y-ph.pivotY,pY.x=pY.x-16,pY.y=pY.y-16,pY.width=pY.width+32,pY.height=pY.height+32,pY.x=Math.floor(pY.x+pf)-pf,pY.y=Math.floor(pY.y+pg)-pg,pY.width=Math.floor(pY.width),pY.height=Math.floor(pY.height),p$._cacheRec.copyFrom(pY)),pY=p$._cacheRec;var pe,pl=pc.isWebGL?1:pw.pixelRatio*pt.stage.clientScaleX,p_=pc.isWebGL?1:pw.pixelRatio*pt.stage.clientScaleY;if(!pc.isWebGL){var pN,pG=1,pm=1;for(pN=ph;pN&&pN!=pt.stage;)pG*=pN.scaleX,pm*=pN.scaleY,pN=pN.parent;pc.isWebGL?(pG<1&&(pl*=pG),pm<1&&(p_*=pm)):(1<pG&&(pl*=pG),1<pm&&(p_*=pm))}if(ph.scrollRect){var pE=ph.scrollRect;pY.x-=pE.x,pY.y-=pE.y}if(pv=pY.width*pl,pL=pY.height*p_,pB=pY.x,pr=pY.y,pc.isWebGL&&"bitmap"===pu&&(2048<pv||2048<pL))return console.warn("cache bitmap size larger than 2048,cache ignored"),p$.ctx&&(pF.recover("RenderContext",p$.ctx),p$.ctx.canvas.size(0,0),p$.ctx=null),void pP._fun.call(pP,ph,pq,pf,pg);if(pC||(pC=p$.ctx=pF.getItem("RenderContext")||new pM(pv,pL,pGh.create("AUTO"))),pC.ctx.sprite=ph,(pS=pC.canvas).clear(),(pS.width!=pv||pS.height!=pL)&&pS.size(pv,pL),"bitmap"===pu?pS.context.asBitmap=!0:"normal"===pu&&(pS.context.asBitmap=!1),1!=pl||1!=p_){var pR=pC.ctx;pR.save(),pR.scale(pl,p_),!pc.isConchWebGL&&pc.isConchApp&&(pe=ph._$P.cf)&&pR.setFilterMatrix&&pR.setFilterMatrix(pe._mat,pe._alpha),pP._fun.call(pP,ph,pC,-pB,-pr),pR.restore(),pc.isConchApp&&!pc.isConchWebGL||ph._applyFilters()}else pR=pC.ctx,!pc.isConchWebGL&&pc.isConchApp&&(pe=ph._$P.cf)&&pR.setFilterMatrix&&pR.setFilterMatrix(pe._mat,pe._alpha),pP._fun.call(pP,ph,pC,-pB,-pr),pc.isConchApp&&!pc.isConchWebGL||ph._applyFilters();ph._$P.staticCache&&(p$.reCache=!1),pZ.canvasReCache++}else pB=(pY=p$._cacheRec).x,pr=pY.y,pS=pC.canvas;pq.drawCanvas(pS,pf+pB,pg+pr,pY.width,pY.height)}else pP._fun.call(pP,ph,pC,pf,pg)},pS.__init__=function(){var ph,pq,pf=0;for(pq=pd.createRenderSprite(69905,null),ph=pS.renders.length=4096,pf=0;pf<ph;pf++)pS.renders[pf]=pq;pS.renders[0]=pd.createRenderSprite(0,null),function(ph,pq){for(var pf=0,pg=0;pg<ph.length;pg++)pf|=ph[pg],pS.renders[pf]=pq}([1,512,4,2],new pS(1,null)),pS.renders[513]=pd.createRenderSprite(513,null),pS.renders[517]=new pS(517,null)},pS._initRenderFun=function(ph,pq,pf,pg){var p$=ph._renderType;(pS.renders[p$]=pS._getTypeRender(p$))._fun(ph,pq,pf,pg)},pS._getTypeRender=function(ph){for(var pq=null,pf=2048;1<pf;)pf&ph&&(pq=pd.createRenderSprite(pf,pq)),pf>>=1;return pq},pS.IMAGE=1,pS.ALPHA=2,pS.TRANSFORM=4,pS.BLEND=8,pS.CANVAS=16,pS.FILTERS=32,pS.MASK=64,pS.CLIP=128,pS.STYLE=256,pS.GRAPHICS=512,pS.CUSTOM=1024,pS.CHILDS=2048,pS.INIT=69905,pS.renders=[],pS.NORENDER=new pS(0,null),pS}(),pT=function(){function pB(){this._repaint=!1}pe(pB,"laya.resource.Context");var ph=pB.prototype;return ph.replaceReset=function(){var ph,pq,pf=0;for(ph=pB.replaceKeys.length,pf=0;pf<ph;pf++)pq=pB.replaceKeys[pf],this[pB.newKeys[pf]]=this[pq]},ph.replaceResotre=function(){this.__restore(),this.__reset()},ph.setIsMainContext=function(){},ph.drawTextures=function(ph,pq,pf,pg){pZ.drawCall+=pq.length/2;for(var p$=ph.width,pP=ph.height,pS=0,pB=pq.length;pS<pB;pS+=2)this.drawTexture(ph,pq[pS],pq[pS+1],p$,pP,pf,pg)},ph.drawCanvas=function(ph,pq,pf,pg,p$){pZ.drawCall++,this.drawImage(ph.source,pq,pf,pg,p$)},ph.fillRect=function(ph,pq,pf,pg,p$){pZ.drawCall++,p$&&(this.fillStyle=p$),this.__fillRect(ph,pq,pf,pg)},ph.fillText=function(ph,pq,pf,pg,p$,pP){pZ.drawCall++,3<arguments.length&&null!=pg&&(this.font=pg,this.fillStyle=p$,this.textAlign=pP,this.textBaseline="top"),this.__fillText(ph,pq,pf)},ph.fillBorderText=function(ph,pq,pf,pg,p$,pP,pS,pB){pZ.drawCall++,this.font=pg,this.fillStyle=p$,this.textBaseline="top",this.strokeStyle=pP,this.lineWidth=pS,this.textAlign=pB,this.__strokeText(ph,pq,pf),this.__fillText(ph,pq,pf)},ph.strokeText=function(ph,pq,pf,pg,p$,pP,pS){pZ.drawCall++,3<arguments.length&&null!=pg&&(this.font=pg,this.strokeStyle=p$,this.lineWidth=pP,this.textAlign=pS,this.textBaseline="top"),this.__strokeText(ph,pq,pf)},ph.transformByMatrix=function(ph){this.transform(ph.a,ph.b,ph.c,ph.d,ph.tx,ph.ty)},ph.setTransformByMatrix=function(ph){this.setTransform(ph.a,ph.b,ph.c,ph.d,ph.tx,ph.ty)},ph.clipRect=function(ph,pq,pf,pg){pZ.drawCall++,this.beginPath(),this.rect(ph,pq,pf,pg),this.clip()},ph.drawTexture=function(ph,pq,pf,pg,p$,pP,pS){pZ.drawCall++;var pB=ph.uv,pr=ph.bitmap.width,pY=ph.bitmap.height;this.drawImage(ph.source,pB[0]*pr,pB[1]*pY,(pB[2]-pB[0])*pr,(pB[5]-pB[3])*pY,pq+pP,pf+pS,pg,p$)},ph.drawTextureWithTransform=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){pZ.drawCall++;var pY=ph.uv,pC=ph.bitmap.width,pU=ph.bitmap.height;this.save(),1!=pr&&(this.globalAlpha*=pr),pP?(this.transform(pP.a,pP.b,pP.c,pP.d,pP.tx+pS,pP.ty+pB),this.drawImage(ph.source,pY[0]*pC,pY[1]*pU,(pY[2]-pY[0])*pC,(pY[5]-pY[3])*pU,pq,pf,pg,p$)):this.drawImage(ph.source,pY[0]*pC,pY[1]*pU,(pY[2]-pY[0])*pC,(pY[5]-pY[3])*pU,pq+pS,pf+pB,pg,p$),this.restore()},ph.drawTexture2=function(ph,pq,pf,pg,p$,pP,pS,pB){var pr=pB[0];if(pr.loaded&&pr.bitmap&&pr.source){pZ.drawCall++;var pY=1!==pP;if(pY){var pC=this.globalAlpha;this.globalAlpha*=pP}var pU=pr.uv,pu=pr.bitmap.width,pv=pr.bitmap.height;p$?(this.save(),this.transform(p$.a,p$.b,p$.c,p$.d,p$.tx+ph,p$.ty+pq),this.drawImage(pr.source,pU[0]*pu,pU[1]*pv,(pU[2]-pU[0])*pu,(pU[5]-pU[3])*pv,pB[1]-pf,pB[2]-pg,pB[3],pB[4]),this.restore()):this.drawImage(pr.source,pU[0]*pu,pU[1]*pv,(pU[2]-pU[0])*pu,(pU[5]-pU[3])*pv,pB[1]-pf+ph,pB[2]-pg+pq,pB[3],pB[4]),pY&&(this.globalAlpha=pC)}},ph.fillTexture=function(ph,pq,pf,pg,p$,pP,pS,pB){if(!pB.pat){if(ph.uv!=pCh.DEF_UV){var pr=new pGh("2D");pr.getContext("2d"),pr.size(ph.width,ph.height),pr.context.drawTexture(ph,0,0,ph.width,ph.height,0,0),ph=new pCh(pr)}pB.pat=this.createPattern(ph.bitmap.source,pP)}var pY=pq,pC=pf,pU=0,pu=0;pS&&(pY+=pS.x%ph.width,pC+=pS.y%ph.height,pU-=pS.x%ph.width,pu-=pS.y%ph.height),this.translate(pY,pC),this.fillRect(pU,pu,pg,p$,pB.pat),this.translate(-pY,-pC)},ph.drawTriangle=function(ph,pq,pf,pg,p$,pP,pS,pB){var pr=ph.bitmap,pY=pr.source,pC=ph.width,pU=ph.height,pu=pr.width,pv=pr.height,pL=pf[pg]*pu,pe=pf[p$]*pu,pl=pf[pP]*pu,p_=pf[pg+1]*pv,pN=pf[p$+1]*pv,pG=pf[pP+1]*pv,pm=pq[pg],pE=pq[p$],pR=pq[pP],pt=pq[pg+1],pX=pq[p$+1],pn=pq[pP+1];if(pB){var pJ=(pm+pE+pR)/3,pp=(pt+pX+pn)/3,pA=pm-pJ,pd=pt-pp,pb=Math.sqrt(pA*pA+pd*pd);pm=pJ+pA/pb*(pb+1),pt=pp+pd/pb*(pb+1),pd=pX-pp,pE=pJ+(pA=pE-pJ)/(pb=Math.sqrt(pA*pA+pd*pd))*(pb+1),pX=pp+pd/pb*(pb+1),pd=pn-pp,pR=pJ+(pA=pR-pJ)/(pb=Math.sqrt(pA*pA+pd*pd))*(pb+1),pn=pp+pd/pb*(pb+1)}this.save(),pS&&this.transform(pS.a,pS.b,pS.c,pS.d,pS.tx,pS.ty),this.beginPath(),this.moveTo(pm,pt),this.lineTo(pE,pX),this.lineTo(pR,pn),this.closePath(),this.clip();var pi=1/(pL*pN+p_*pl+pe*pG-pN*pl-p_*pe-pL*pG),pz=pm*pN+p_*pR+pE*pG-pN*pR-p_*pE-pm*pG,pc=pL*pE+pm*pl+pe*pR-pE*pl-pm*pe-pL*pR,pM=pL*pN*pR+p_*pE*pl+pm*pe*pG-pm*pN*pl-p_*pe*pR-pL*pE*pG,pW=pt*pN+p_*pn+pX*pG-pN*pn-p_*pX-pt*pG,pT=pL*pX+pt*pl+pe*pn-pX*pl-pt*pe-pL*pn,pI=pL*pN*pn+p_*pX*pl+pt*pe*pG-pt*pN*pl-p_*pe*pn-pL*pX*pG;this.transform(pz*pi,pW*pi,pc*pi,pT*pi,pM*pi,pI*pi),this.drawImage(pY,ph.uv[0]*pu,ph.uv[1]*pv,pC,pU,ph.uv[0]*pu,ph.uv[1]*pv,pC,pU),this.restore()},ph.flush=function(){return 0},ph.fillWords=function(ph,pq,pf,pg,p$,pP){pg&&(this.font=pg),p$&&(this.fillStyle=p$);this.textBaseline="top",this.textAlign="left";for(var pS=0,pB=ph.length;pS<pB;pS++){var pr=ph[pS];if(this.__fillText(pr.char,pr.x+pq,pr.y+pf),1===pP){var pY=pr.height,pC=.5*pr.style.letterSpacing;pC||(pC=0),this.beginPath(),this.strokeStyle=p$,this.lineWidth=1,this.moveTo(pq+pr.x-pC+.5,pf+pr.y+pY+.5),this.lineTo(pq+pr.x+pr.width+pC+.5,pf+pr.y+pY+.5),this.stroke()}}},ph.fillBorderWords=function(ph,pq,pf,pg,p$,pP,pS){pg&&(this.font=pg),p$&&(this.fillStyle=p$),this.textBaseline="top",this.lineWidth=pS,this.textAlign="left",this.strokeStyle=pP;for(var pB=0,pr=ph.length;pB<pr;pB++){var pY=ph[pB];this.__strokeText(pY.char,pY.x+pq,pY.y+pf),this.__fillText(pY.char,pY.x+pq,pY.y+pf)}},ph.destroy=function(){this.canvas.width=this.canvas.height=0},ph.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},ph.drawCurves=function(ph,pq,pf){this.beginPath(),this.strokeStyle=pf[3],this.lineWidth=pf[4];var pg=pf[2];ph+=pf[0],pq+=pf[1],this.moveTo(ph+pg[0],pq+pg[1]);for(var p$=2,pP=pg.length;p$<pP;)this.quadraticCurveTo(ph+pg[p$++],pq+pg[p$++],ph+pg[p$++],pq+pg[p$++]);this.stroke()},pB.__init__=function(pq){var pf=laya.resource.Context.prototype;if(!(pq=pq||CanvasRenderingContext2D.prototype).inited){pq.inited=!0,pq.__fillText=pq.fillText,pq.__fillRect=pq.fillRect,pq.__strokeText=pq.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(ph){pq[ph]=pf[ph]})}},pB.replaceCanvasGetSet=function(ph,pq){var pf=Object.getOwnPropertyDescriptor(ph,pq);if(!pf||!pf.configurable)return!1;var pg,p$={};for(pg in pf)"set"!=pg&&(p$[pg]=pf[pg]);var pP=pf.set;return p$.set=function(ph){pP.call(this,ph);var pq=this.getContext("2d");pq&&"__reset"in pq&&pq.__reset()},Object.defineProperty(ph,pq,p$),!0},pB.replaceGetSet=function(ph,pq){var pf=Object.getOwnPropertyDescriptor(ph,pq);if(!pf||!pf.configurable)return!1;var pg,p$={};for(pg in pf)"set"!=pg&&(p$[pg]=pf[pg]);var pP=pf.set,pS="___"+pq+"__";return pB.newKeys.push(pS),p$.set=function(ph){ph!=this[pS]&&(this[pS]=ph,pP.call(this,ph))},Object.defineProperty(ph,pq,p$),!0},pB._default=new pB,pB.newKeys=[],pr(pB,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),pB}(),pI=function(){function pP(ph){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++pP._uniqueIDCounter,this._name=ph||"Content Manager",pP._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,pP._resourceManagers.push(this),this._resources=[],this._records={}}pe(pP,"laya.resource.ResourceManager");var ph=pP.prototype;return pt.imps(ph,{"laya.resource.IDispose":!0}),ph.getResourceByIndex=function(ph){return this._resources[ph]},ph.getResourcesLength=function(){return this._resources.length},ph.addResource=function(ph){return ph.resourceManager&&ph.resourceManager.removeResource(ph),-1===this._resources.indexOf(ph)&&((ph._resourceManager=this)._resources.push(ph),this.addRecord(ph.uri,ph.__className,ph.memorySize),this.addSize(ph.memorySize),!0)},ph.removeResource=function(ph){var pq=this._resources.indexOf(ph);return-1!==pq&&(this._resources.splice(pq,1),ph._resourceManager=null,this._memorySize-=ph.memorySize,this.addRecord(ph.uri,ph.__className,-ph.memorySize),!0)},ph.unload=function(){for(var ph=this._resources.slice(0,this._resources.length),pq=0;pq<ph.length;pq++){ph[pq].destroy()}ph.length=0},ph.dispose=function(){if(this===pP._systemResourceManager)throw new Error("systemResourceManager不能被释放！");pP._resourceManagers.splice(pP._resourceManagers.indexOf(this),1),pP._isResourceManagersSorted=!1;for(var ph=this._resources.slice(0,this._resources.length),pq=0;pq<ph.length;pq++){var pf=ph[pq];pf.resourceManager.removeResource(pf),pf.destroy()}ph.length=0},ph.addSize=function(ph){ph&&(this.autoRelease&&0<ph&&this._memorySize+ph>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=ph)},ph.addRecord=function(ph,pq,pf){DEBUG&&pf&&!ph&&console.error(ph,pq,pf),ph&&(this._records.hasOwnProperty(pq+"|"+ph)||(this._records[pq+"|"+ph]=0),this._records[pq+"|"+ph]+=pf,DEBUG&&this._records[pq+"|"+ph]<0&&console.error(ph,pq,this._records[pq+"|"+ph]))},ph.garbageCollection=function(ph){var pq=this._resources;(pq=pq.slice()).sort(function(ph,pq){if(!ph||!pq)throw new Error("a或b不能为空！");return ph.released&&pq.released?0:ph.released?1:pq.released?-1:ph._lastUseFrameCount-pq._lastUseFrameCount});for(var pf=pZ.loopCount,pg=0,p$=pq.length;pg<p$;pg++){var pP=pq[pg];if(!(1<pf-pP._lastUseFrameCount))return void(this._memorySize>=ph&&(this._isOverflow=!0));if(pP.releaseResource(),this._memorySize<ph)return void(this._isOverflow=!1)}},pC(0,ph,"id",function(){return this._id}),pC(0,ph,"name",function(){return this._name},function(ph){!ph&&""===ph||this._name===ph||(this._name=ph,pP._isResourceManagersSorted=!1)}),pC(0,ph,"memorySize",function(){return this._memorySize}),pC(0,ph,"records",function(){return this._records}),pC(1,pP,"systemResourceManager",function(){return pP._systemResourceManager}),pP.__init__=function(){pP.currentResourceManager=pP.systemResourceManager},pP.getLoadedResourceManagerByIndex=function(ph){return pP._resourceManagers[ph]},pP.getLoadedResourceManagersCount=function(){return pP._resourceManagers.length},pP.recreateContentManagers=function(ph){void 0===ph&&(ph=!1);for(var pq=pP.currentResourceManager,pf=0;pf<pP._resourceManagers.length;pf++){pP.currentResourceManager=pP._resourceManagers[pf];for(var pg=0;pg<pP.currentResourceManager._resources.length;pg++)pP.currentResourceManager._resources[pg].releaseResource(ph),pP.currentResourceManager._resources[pg].activeResource(ph)}pP.currentResourceManager=pq},pP.releaseContentManagers=function(ph){void 0===ph&&(ph=!1);for(var pq=pP.currentResourceManager,pf=0;pf<pP._resourceManagers.length;pf++){pP.currentResourceManager=pP._resourceManagers[pf];for(var pg=0;pg<pP.currentResourceManager._resources.length;pg++){var p$=pP.currentResourceManager._resources[pg];!p$.released&&p$.releaseResource(ph)}}pP.currentResourceManager=pq},pP._uniqueIDCounter=0,pP._isResourceManagersSorted=!1,pP._resourceManagers=[],pr(pP,["_systemResourceManager",function(){return this._systemResourceManager=new pP("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=pP._systemResourceManager}]),pP}(),pw=(function(){function ph(){}pe(ph,"laya.system.System"),ph.changeDefinition=function(ph,pq){pt[ph]=pq;var pf=ph+"=classObj";pt._runScript(pf)},ph.__init__=function(){pc.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function pf(){}return pe(pf,"laya.utils.Browser"),pC(1,pf,"pixelRatio",function(){return pf.__init__(),-1<pf.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:pd.getPixelRatio()}),pC(1,pf,"height",function(){return pf.__init__(),(pt.stage&&pt.stage.canvasRotation?pf.clientWidth:pf.clientHeight)*pf.pixelRatio}),pC(1,pf,"clientWidth",function(){return pf.__init__(),pf.window.innerWidth||pf.document.body.clientWidth}),pC(1,pf,"window",function(){return pf.__init__(),pf._window}),pC(1,pf,"clientHeight",function(){return pf.__init__(),pf.window.innerHeight||pf.document.body.clientHeight||pf.document.documentElement.clientHeight}),pC(1,pf,"width",function(){return pf.__init__(),(pt.stage&&pt.stage.canvasRotation?pf.clientHeight:pf.clientWidth)*pf.pixelRatio}),pC(1,pf,"container",function(){return pf.__init__(),pf._container||((pf._container=pf.createElement("div")).id="layaContainer",pf.document.body.appendChild(pf._container)),pf._container},function(ph){pf._container=ph}),pC(1,pf,"document",function(){return pf.__init__(),pf._document}),pf.__init__=function(){if(!pf._window){pf._window=pd.getWindow(),pf._document=pf.window.document,pf._window.addEventListener("message",function(ph){laya.utils.Browser._onMessage(ph)},!1),pf.document.__createElement=pf.document.createElement,pS.requestAnimationFrame=pS.requestAnimationFrame||pS.webkitRequestAnimationFrame||pS.mozRequestAnimationFrame||pS.oRequestAnimationFrame||pS.msRequestAnimationFrame||function(ph){return pS.setTimeout(ph,1e3/60)};var ph=pS.document.body.style;ph["-webkit-user-select"]="none",ph["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",pf.userAgent=pf.window.navigator.userAgent,pf.onIOS=!!(pf.u=pf.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),pf.onMobile=-1<pf.u.indexOf("Mobile"),pf.onIPhone=-1<pf.u.indexOf("iPhone"),pf.onMac=-1<pf.u.indexOf("Mac OS X"),pf.onIPad=-1<pf.u.indexOf("iPad"),pf.onAndroid=-1<pf.u.indexOf("Android")||-1<pf.u.indexOf("Adr"),pf.onWP=-1<pf.u.indexOf("Windows Phone"),pf.onQQBrowser=-1<pf.u.indexOf("QQBrowser"),pf.onMQQBrowser=-1<pf.u.indexOf("MQQBrowser")||-1<pf.u.indexOf("Mobile")&&-1<pf.u.indexOf("QQ"),pf.onIE=!!pf.window.ActiveXObject||"ActiveXObject"in pf.window,pf.onWeiXin=-1<pf.u.indexOf("MicroMessenger"),pf.onPC=!pf.onMobile,pf.onSafari=-1<pf.u.indexOf("Safari"),pf.onFirefox=-1<pf.u.indexOf("Firefox"),pf.onEdge=-1<pf.u.indexOf("Edge"),pf.onMiniGame=-1<pf.u.indexOf("MiniGame"),pf.onLimixiu=-1<pf.u.indexOf("limixiu"),pf.httpProtocol="http:"==pf.window.location.protocol,pf.onMiniGame&&null==pf.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),pf.webAudioEnabled=!!(pf.window.AudioContext||pf.window.webkitAudioContext||pf.window.mozAudioContext),pf.soundType=pf.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",p$h=pf.webAudioEnabled?pPh:pfh,pf.webAudioEnabled&&pPh.initWebAudio(),pfh._initMusicAudio(),pf.enableTouch="ontouchstart"in pS||pS.DocumentTouch&&pq instanceof DocumentTouch,pS.focus(),pA._soundClass=p$h,pA._musicClass=pfh,pc._mainCanvas=pc._mainCanvas||pGh.create("2D"),pf.canvas||(pf.canvas=pGh.create("2D"),pf.context=pf.canvas.getContext("2d"))}},pf._onMessage=function(ph){if(ph.data&&"size"==ph.data.name){if(pf.window.innerWidth=ph.data.width,pf.window.innerHeight=ph.data.height,pf.window.__innerHeight=ph.data.clientHeight,!pf.document.createEvent)return void console.warn("no document.createEvent");var pq=pf.document.createEvent("HTMLEvents");return pq.initEvent("resize",!1,!1),void pf.window.dispatchEvent(pq)}},pf.createElement=function(ph){return pf.__init__(),pf.document.__createElement(ph)},pf.getElementById=function(ph){return pf.__init__(),pf.document.getElementById(ph)},pf.removeElement=function(ph){ph&&ph.parentNode&&ph.parentNode.removeChild(ph)},pf.now=function(){return pd.now()},pf._window=null,pf._document=null,pf._container=null,pf.userAgent=null,pf.u=null,pf.onIOS=!1,pf.onMac=!1,pf.onMobile=!1,pf.onIPhone=!1,pf.onIPad=!1,pf.onAndroid=!1,pf.onWP=!1,pf.onQQBrowser=!1,pf.onMQQBrowser=!1,pf.onSafari=!1,pf.onFirefox=!1,pf.onEdge=!1,pf.onIE=!1,pf.onWeiXin=!1,pf.onMiniGame=!1,pf.onLimixiu=!1,pf.onPC=!1,pf.httpProtocol=!1,pf.webAudioEnabled=!1,pf.soundType=null,pf.enableTouch=!1,pf.canvas=null,pf.context=null,pf.__init$=function(){},pf}()),pk=function(){function pq(ph){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,ph?(this._u8d_=new Uint8Array(ph),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}pe(pq,"laya.utils.Byte");var ph=pq.prototype;return ph.___resizeBuffer=function(pq){try{var ph=new Uint8Array(pq);null!=this._u8d_&&(this._u8d_.length<=pq?ph.set(this._u8d_):ph.set(this._u8d_.subarray(0,pq))),this._u8d_=ph,this._d_=new DataView(ph.buffer)}catch(ph){throw"___resizeBuffer err:"+pq}},ph.getString=function(){return this.rUTF(this.getUint16())},ph.getFloat32Array=function(ph,pq){var pf=ph+pq;pf=pf>this._length?this._length:pf;var pg=new Float32Array(this._d_.buffer.slice(ph,pf));return this._pos_=pf,pg},ph.getUint8Array=function(ph,pq){var pf=ph+pq;pf=pf>this._length?this._length:pf;var pg=new Uint8Array(this._d_.buffer.slice(ph,pf));return this._pos_=pf,pg},ph.getInt16Array=function(ph,pq){var pf=ph+pq;pf=pf>this._length?this._length:pf;var pg=new Int16Array(this._d_.buffer.slice(ph,pf));return this._pos_=pf,pg},ph.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var ph=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,ph},ph.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var ph=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,ph},ph.writeFloat32=function(ph){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,ph,this._xd_),this._pos_+=4},ph.writeFloat64=function(ph){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,ph,this._xd_),this._pos_+=8},ph.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var ph=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,ph},ph.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var ph=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,ph},ph.writeInt32=function(ph){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,ph,this._xd_),this._pos_+=4},ph.writeUint32=function(ph){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,ph,this._xd_),this._pos_+=4},ph.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var ph=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,ph},ph.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var ph=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,ph},ph.writeUint16=function(ph){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,ph,this._xd_),this._pos_+=2},ph.writeInt16=function(ph){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,ph,this._xd_),this._pos_+=2},ph.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},ph.writeUint8=function(ph){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,ph),this._pos_++},ph._getUInt8=function(ph){return this._d_.getUint8(ph)},ph._getUint16=function(ph){return this._d_.getUint16(ph,this._xd_)},ph._getMatrix=function(){return new pb(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},ph.rUTF=function(ph){for(var pq=[],pf=this._pos_+ph,pg=0,p$=0,pP=0,pS=String.fromCharCode,pB=this._u8d_;this._pos_<pf;)(pg=pB[this._pos_++])<128?0!=pg&&pq.push(pS(pg)):pg<224?pq.push(pS((63&pg)<<6|127&pB[this._pos_++])):pg<240?(p$=pB[this._pos_++],pq.push(pS((31&pg)<<12|(127&p$)<<6|127&pB[this._pos_++]))):(p$=pB[this._pos_++],pP=pB[this._pos_++],pq.push(pS((15&pg)<<18|(127&p$)<<12|pP<<6&127|127&pB[this._pos_++]))),0;return pq.join("")},ph.getCustomString=function(ph){for(var pq=[],pf=0,pg=0,p$=0,pP=String.fromCharCode,pS=this._u8d_;0<ph;)if((pg=pS[this._pos_])<128)pq.push(pP(pg)),this._pos_++,ph--;else for(pf=pg-128,this._pos_++,ph-=pf;0<pf;)pg=pS[this._pos_++],p$=pS[this._pos_++],pq.push(pP(p$<<8|pg)),pf--;return pq.join("")},ph.clear=function(){this._pos_=0,this.length=0},ph.__getBuffer=function(){return this._d_.buffer},ph.writeUTFBytes=function(ph){for(var pq=0,pf=(ph+="").length;pq<pf;pq++){var pg=ph.charCodeAt(pq);pg<=127?this.writeByte(pg):pg<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|pg>>6,128|63&pg],this._pos_),this._pos_+=2):pg<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|pg>>12,128|pg>>6&63,128|63&pg],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|pg>>18,128|pg>>12&63,128|pg>>6&63,128|63&pg],this._pos_),this._pos_+=4)}},ph.writeUTFString=function(ph){var pq=this.pos;this.writeUint16(1),this.writeUTFBytes(ph);var pf=this.pos-pq-2;if(65536<=pf)throw"writeUTFString byte len more than 65536";this._d_.setUint16(pq,pf,this._xd_)},ph.readUTFString=function(){return this.readUTFBytes(this.getUint16())},ph.getUTFString=function(){return this.readUTFString()},ph.readUTFBytes=function(ph){if(void 0===ph&&(ph=-1),0==ph)return"";var pq=this.bytesAvailable;if(pq<ph)throw"readUTFBytes error - Out of bounds";return ph=0<ph?ph:pq,this.rUTF(ph)},ph.getUTFBytes=function(ph){return void 0===ph&&(ph=-1),this.readUTFBytes(ph)},ph.writeByte=function(ph){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,ph),this._pos_+=1},ph.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},ph.getByte=function(){return this.readByte()},ph.ensureWrite=function(ph){this._length<ph&&(this._length=ph),this._allocated_<ph&&(this.length=ph)},ph.writeArrayBuffer=function(ph,pq,pf){if(void 0===pq&&(pq=0),void 0===pf&&(pf=0),pq<0||pf<0)throw"writeArrayBuffer error - Out of bounds";0==pf&&(pf=ph.byteLength-pq),this.ensureWrite(this._pos_+pf);var pg=new Uint8Array(ph);this._u8d_.set(pg.subarray(pq,pq+pf),this._pos_),this._pos_+=pf},pC(0,ph,"buffer",function(){var ph=this._d_.buffer;return ph.byteLength==this.length?ph:ph.slice(0,this.length)}),pC(0,ph,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(ph){this._xd_="littleEndian"==ph}),pC(0,ph,"length",function(){return this._length},function(ph){this._allocated_<ph?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(ph,2*this._allocated_))):this._allocated_>ph&&this.___resizeBuffer(this._allocated_=ph),this._length=ph}),pC(0,ph,"pos",function(){return this._pos_},function(ph){this._pos_=ph}),pC(0,ph,"bytesAvailable",function(){return this._length-this._pos_}),pq.getSystemEndian=function(){if(!pq._sysEndian){var ph=new ArrayBuffer(2);new DataView(ph).setInt16(0,256,!0),pq._sysEndian=256===new Int16Array(ph)[0]?"littleEndian":"bigEndian"}return pq._sysEndian},pq.BIG_ENDIAN="bigEndian",pq.LITTLE_ENDIAN="littleEndian",pq._sysEndian=null,pq}(),pH=function(){function p$(){}return pe(p$,"laya.utils.CacheManager"),p$.regCacheByFunction=function(ph,pq){var pf;p$.unRegCacheByFunction(ph,pq),pf={tryDispose:ph,getCacheList:pq},p$._cacheList.push(pf)},p$.unRegCacheByFunction=function(ph,pq){var pf,pg=0;for(pf=p$._cacheList.length,pg=0;pg<pf;pg++)if(p$._cacheList[pg].tryDispose==ph&&p$._cacheList[pg].getCacheList==pq)return void p$._cacheList.splice(pg,1)},p$.forceDispose=function(){var ph=0,pq=p$._cacheList.length;for(ph=0;ph<pq;ph++)p$._cacheList[ph].tryDispose(!0)},p$.beginCheck=function(ph){void 0===ph&&(ph=15e3),pt.timer.loop(ph,null,p$._checkLoop)},p$.stopCheck=function(){pt.timer.clear(null,p$._checkLoop)},p$._checkLoop=function(){var ph=p$._cacheList;if(!(ph.length<1)){var pq,pf=pw.now(),pg=0;for(pq=pg=ph.length;0<pg&&(ph[p$._index=++p$._index%pq].tryDispose(!1),!(pw.now()-pf>p$.loopTimeLimit));)pg--}},p$.loopTimeLimit=2,p$._cacheList=[],p$._index=0,p$}(),pD=function(){function pv(){}return pe(pv,"laya.utils.ClassUtils"),pv.regClass=function(ph,pq){pv._classMap[ph]=pq},pv.getRegClass=function(ph){return pv._classMap[ph]},pv.getInstance=function(ph){var pq=pv.getClass(ph);return pq?new pq:(console.warn("[error] Undefined class:",ph),null)},pv.createByJson=function(ph,pq,pf,pg,p$){"string"==typeof ph&&(ph=JSON.parse(ph));var pP=ph.props;if(!pq&&!(pq=p$?p$.runWith(ph):pv.getInstance(pP.runtime||ph.type)))return null;var pS=ph.child;if(pS)for(var pB=0,pr=pS.length;pB<pr;pB++){var pY=pS[pB];if("render"!==pY.props.name&&"render"!==pY.props.renderType||!pq._$set_itemRender)if("Graphic"==pY.type)pv.addGraphicsToSprite(pY,pq);else if(pv.isDrawType(pY.type))pv.addGraphicToSprite(pY,pq,!0);else{var pC=pv.createByJson(pY,null,pf,pg,p$);"Script"==pY.type?pC.hasOwnProperty("owner")?pC.owner=pq:pC.hasOwnProperty("target")&&(pC.target=pq):"mask"==pY.props.renderType?pq.mask=pC:pq.addChild(pC)}else pq.itemRender=pY}if(pP)for(var pU in pP){var pu=pP[pU];"var"===pU&&pf?pf[pu]=pq:pu instanceof Array&&"function"==typeof pq[pU]?pq[pU].apply(pq,pu):pq[pU]=pu}return pg&&ph.customProps&&pg.runWith([pq,ph]),pq.created&&pq.created(),pq},pv.addGraphicsToSprite=function(ph,pq){var pf;if((pf=ph.child)&&!(pf.length<1)){var pg;pg=pv._getGraphicsFromSprite(ph,pq);var p$=0,pP=0;ph.props&&(p$=pv._getObjVar(ph.props,"x",0),pP=pv._getObjVar(ph.props,"y",0)),0!=p$&&0!=pP&&pg.translate(p$,pP);var pS,pB=0;for(pS=pf.length,pB=0;pB<pS;pB++)pv._addGraphicToGraphics(pf[pB],pg);0!=p$&&0!=pP&&pg.translate(-p$,-pP)}},pv.addGraphicToSprite=function(ph,pq,pf){var pg;void 0===pf&&(pf=!1),pg=pf?pv._getGraphicsFromSprite(ph,pq):pq.graphics,pv._addGraphicToGraphics(ph,pg)},pv._getGraphicsFromSprite=function(ph,pq){var pf,pg;if(!ph||!ph.props)return pq.graphics;switch(pg=ph.props.renderType){case"hit":case"unHit":var p$;pq.hitArea||(pq.hitArea=new py),(p$=pq.hitArea)[pg]||(p$[pg]=new pu),pf=p$[pg]}return pf||(pf=pq.graphics),pf},pv._getTransformData=function(ph){var pq;(ph.hasOwnProperty("pivotX")||ph.hasOwnProperty("pivotY"))&&(pq=pq||new pb).translate(-pv._getObjVar(ph,"pivotX",0),-pv._getObjVar(ph,"pivotY",0));var pf=pv._getObjVar(ph,"scaleX",1),pg=pv._getObjVar(ph,"scaleY",1),p$=pv._getObjVar(ph,"rotation",0);pv._getObjVar(ph,"skewX",0),pv._getObjVar(ph,"skewY",0);return 1==pf&&1==pg&&0==p$||((pq=pq||new pb).scale(pf,pg),pq.rotate(.0174532922222222*p$)),pq},pv._addGraphicToGraphics=function(ph,pq){var pf,pg;if((pf=ph.props)&&(pg=pv.DrawTypeDic[ph.type])){var p$,pP;p$=pq;var pS=pv._getParams(pf,pg[1],pg[2],pg[3]);((pP=pv._tM)||1!=pv._alpha)&&(p$.save(),pP&&p$.transform(pP),1!=pv._alpha&&p$.alpha(pv._alpha)),p$[pg[0]].apply(p$,pS),(pP||1!=pv._alpha)&&p$.restore()}},pv._adptLineData=function(ph){return ph[2]=parseFloat(ph[0])+parseFloat(ph[2]),ph[3]=parseFloat(ph[1])+parseFloat(ph[3]),ph},pv._adptTextureData=function(ph){return ph[0]=pBh.getRes(ph[0]),ph},pv._adptLinesData=function(ph){return ph[2]=pv._getPointListByStr(ph[2]),ph},pv.isDrawType=function(ph){return"Image"!=ph&&pv.DrawTypeDic.hasOwnProperty(ph)},pv._getParams=function(ph,pq,pf,pg){var p$;void 0===pf&&(pf=0),(p$=pv._temParam).length=pq.length;var pP,pS,pB=0;for(pP=pq.length,pB=0;pB<pP;pB++)p$[pB]=pv._getObjVar(ph,pq[pB][0],pq[pB][1]);return pv._alpha=pv._getObjVar(ph,"alpha",1),pS=pv._getTransformData(ph),pv._tM=pS?(pf||(pf=0),pS.translate(p$[pf],p$[pf+1]),p$[pf]=p$[pf+1]=0,pS):null,pg&&pv[pg]&&(p$=pv[pg](p$)),p$},pv._getPointListByStr=function(ph){var pq,pf,pg=0;for(pf=(pq=ph.split(",")).length,pg=0;pg<pf;pg++)pq[pg]=parseFloat(pq[pg]);return pq},pv._getObjVar=function(ph,pq,pf){return ph.hasOwnProperty(pq)?ph[pq]:pf},pv._temParam=[],pv._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},pv.getClass=function(ph){var pq=pv._classMap[ph]||ph;return"string"==typeof pq?pt.__classmap[pq]:pq},pv._tM=null,pv._alpha=NaN,pr(pv,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),pv}(),ps=function(){function pP(ph){if(this._color=[],"string"==typeof ph){null===(this.strColor=ph)&&(ph="#000000"),"#"==ph.charAt(0)&&(ph=ph.substr(1));var pq=ph.length;if(3==pq||4==pq){for(var pf="",pg=0;pg<pq;pg++)pf+=ph[pg]+ph[pg];ph=pf}var p$=this.numColor=parseInt(ph,16);if(8==ph.length)return void(this._color=[parseInt(ph.substr(0,2),16)/255,((16711680&p$)>>16)/255,((65280&p$)>>8)/255,(255&p$)/255])}else p$=this.numColor=ph,this.strColor=pO.toHexColor(p$);this._color=[((16711680&p$)>>16)/255,((65280&p$)>>8)/255,(255&p$)/255,1],this._color.__id=++pP._COLODID}return pe(pP,"laya.utils.Color"),pP._initDefault=function(){for(var ph in pP._DEFAULT={},pP._COLOR_MAP)pP._SAVE[ph]=pP._DEFAULT[ph]=new pP(pP._COLOR_MAP[ph]);return pP._DEFAULT},pP._initSaveMap=function(){for(var ph in pP._SAVE_SIZE=0,pP._SAVE={},pP._DEFAULT)pP._SAVE[ph]=pP._DEFAULT[ph]},pP.create=function(ph){var pq=pP._SAVE[ph+""];return null!=pq?pq:(pP._SAVE_SIZE<1e3||pP._initSaveMap(),pP._SAVE[ph+""]=new pP(ph))},pP._SAVE={},pP._SAVE_SIZE=0,pP._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},pP._DEFAULT=pP._initDefault(),pP._COLODID=1,pP}(),pV=(function(){function ph(){this._values=[],this._keys=[]}pe(ph,"laya.utils.Dictionary");var pq=ph.prototype;pq.set=function(ph,pq){var pf=this.indexOf(ph);0<=pf?this._values[pf]=pq:(this._keys.push(ph),this._values.push(pq))},pq.indexOf=function(ph){var pq=this._keys.indexOf(ph);return 0<=pq?pq:(ph="string"==typeof ph?Number(ph):"number"==typeof ph?ph.toString():ph,this._keys.indexOf(ph))},pq.get=function(ph){var pq=this.indexOf(ph);return pq<0?null:this._values[pq]},pq.remove=function(ph){var pq=this.indexOf(ph);return 0<=pq&&(this._keys.splice(pq,1),this._values.splice(pq,1),!0)},pq.clear=function(){this._values.length=0,this._keys.length=0},pC(0,pq,"values",function(){return this._values}),pC(0,pq,"keys",function(){return this._keys})}(),function(){function ph(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}pe(ph,"laya.utils.Dragging");var pq=ph.prototype;return pq.start=function(ph,pq,pf,pg,p$,pP,pS,pB){void 0===pB&&(pB=.92),this.clearTimer(),this.target=ph,this.area=pq,this.hasInertia=pf,this.elasticDistance=pq?pg:0,this.elasticBackTime=p$,this.data=pP,this._disableMouseEvent=pS,this.ratio=pB,1!=ph.globalScaleX||1!=ph.globalScaleY?this._parent=ph.parent:this._parent=pt.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,pt.stage.on("mouseup",this,this.onStageMouseUp),pt.stage.on("mouseout",this,this.onStageMouseUp),pt.timer.frameLoop(1,this,this.loop)},pq.clearTimer=function(){pt.timer.clear(this,this.loop),pt.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},pq.stop=function(){this._dragging&&(pL.instance.disableMouseEvent=!1,pt.stage.off("mouseup",this,this.onStageMouseUp),pt.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},pq.loop=function(){var ph=this._parent.getMousePoint(),pq=ph.x,pf=ph.y,pg=pq-this._lastX,p$=pf-this._lastY;if(this._clickOnly){if(!(1<Math.abs(pg*pt.stage._canvasTransform.getScaleX())||1<Math.abs(p$*pt.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),pL.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(pg,p$);0==pg&&0==p$||(this._lastX=pq,this._lastY=pf,this.target.x+=pg*this._elasticRateX,this.target.y+=p$*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},pq.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var ph=this.area.x-this.target.x;else ph=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-ph/this.elasticDistance),this.target.y<this.area.y)var pq=this.area.y-this.target.y;else pq=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-pq/this.elasticDistance)}},pq.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},pq.onStageMouseUp=function(ph){if(pL.instance.disableMouseEvent=!1,pt.stage.off("mouseup",this,this.onStageMouseUp),pt.stage.off("mouseout",this,this.onStageMouseUp),pt.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var pq=this._offsets.length,pf=Math.min(pq,6),pg=this._offsets.length-pf,p$=pq-1;pg<p$;p$--)this._offsetY+=this._offsets[p$--],this._offsetX+=this._offsets[p$];this._offsetX=this._offsetX/pf*2,this._offsetY=this._offsetY/pf*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),pt.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},pq.checkElastic=function(){var ph=NaN,pq=NaN;if(this.target.x<this.area.x?ph=this.area.x:this.target.x>this.area.x+this.area.width&&(ph=this.area.x+this.area.width),this.target.y<this.area.y?pq=this.area.y:this.target.y>this.area.y+this.area.height&&(pq=this.area.y+this.area.height),isNaN(ph)&&isNaN(pq))this.clear();else{var pf={};isNaN(ph)||(pf.x=ph),isNaN(pq)||(pf.y=pq),this._tween=po.to(this.target,pf,this.elasticBackTime,pK.sineOut,pN.create(this,this.clear),0,!1,!1)}},pq.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(pt.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},pq.clear=function(){if(this.target){this.clearTimer();var ph=this.target;this.target=null,this._parent=null,ph.event("dragend",this.data)}},ph}()),pK=function(){function pB(){}return pe(pB,"laya.utils.Ease"),pB.linearNone=function(ph,pq,pf,pg){return pf*ph/pg+pq},pB.linearIn=function(ph,pq,pf,pg){return pf*ph/pg+pq},pB.linearInOut=function(ph,pq,pf,pg){return pf*ph/pg+pq},pB.linearOut=function(ph,pq,pf,pg){return pf*ph/pg+pq},pB.bounceIn=function(ph,pq,pf,pg){return pf-pB.bounceOut(pg-ph,0,pf,pg)+pq},pB.bounceInOut=function(ph,pq,pf,pg){return ph<.5*pg?.5*pB.bounceIn(2*ph,0,pf,pg)+pq:.5*pB.bounceOut(2*ph-pg,0,pf,pg)+.5*pf+pq},pB.bounceOut=function(ph,pq,pf,pg){return(ph/=pg)<1/2.75?pf*(7.5625*ph*ph)+pq:ph<2/2.75?pf*(7.5625*(ph-=1.5/2.75)*ph+.75)+pq:ph<2.5/2.75?pf*(7.5625*(ph-=2.25/2.75)*ph+.9375)+pq:pf*(7.5625*(ph-=2.625/2.75)*ph+.984375)+pq},pB.backIn=function(ph,pq,pf,pg,p$){return void 0===p$&&(p$=1.70158),pf*(ph/=pg)*ph*((p$+1)*ph-p$)+pq},pB.backInOut=function(ph,pq,pf,pg,p$){return void 0===p$&&(p$=1.70158),(ph/=.5*pg)<1?.5*pf*(ph*ph*((1+(p$*=1.525))*ph-p$))+pq:pf/2*((ph-=2)*ph*((1+(p$*=1.525))*ph+p$)+2)+pq},pB.backOut=function(ph,pq,pf,pg,p$){return void 0===p$&&(p$=1.70158),pf*((ph=ph/pg-1)*ph*((p$+1)*ph+p$)+1)+pq},pB.elasticIn=function(ph,pq,pf,pg,p$,pP){var pS;return void 0===p$&&(p$=0),void 0===pP&&(pP=0),0==ph?pq:1==(ph/=pg)?pq+pf:(pP||(pP=.3*pg),pS=!p$||0<pf&&p$<pf||pf<0&&p$<-pf?(p$=pf,pP/4):pP/pB.PI2*Math.asin(pf/p$),-p$*Math.pow(2,10*(ph-=1))*Math.sin((ph*pg-pS)*pB.PI2/pP)+pq)},pB.elasticInOut=function(ph,pq,pf,pg,p$,pP){var pS;return void 0===p$&&(p$=0),void 0===pP&&(pP=0),0==ph?pq:2==(ph/=.5*pg)?pq+pf:(pP||(pP=pg*(.3*1.5)),pS=!p$||0<pf&&p$<pf||pf<0&&p$<-pf?(p$=pf,pP/4):pP/pB.PI2*Math.asin(pf/p$),ph<1?p$*Math.pow(2,10*(ph-=1))*Math.sin((ph*pg-pS)*pB.PI2/pP)*-.5+pq:p$*Math.pow(2,-10*(ph-=1))*Math.sin((ph*pg-pS)*pB.PI2/pP)*.5+pf+pq)},pB.elasticOut=function(ph,pq,pf,pg,p$,pP){var pS;return void 0===p$&&(p$=0),void 0===pP&&(pP=0),0==ph?pq:1==(ph/=pg)?pq+pf:(pP||(pP=.3*pg),pS=!p$||0<pf&&p$<pf||pf<0&&p$<-pf?(p$=pf,pP/4):pP/pB.PI2*Math.asin(pf/p$),p$*Math.pow(2,-10*ph)*Math.sin((ph*pg-pS)*pB.PI2/pP)+pf+pq)},pB.strongIn=function(ph,pq,pf,pg){return pf*(ph/=pg)*ph*ph*ph*ph+pq},pB.strongInOut=function(ph,pq,pf,pg){return(ph/=.5*pg)<1?.5*pf*ph*ph*ph*ph*ph+pq:.5*pf*((ph-=2)*ph*ph*ph*ph+2)+pq},pB.strongOut=function(ph,pq,pf,pg){return pf*((ph=ph/pg-1)*ph*ph*ph*ph+1)+pq},pB.sineInOut=function(ph,pq,pf,pg){return.5*-pf*(Math.cos(Math.PI*ph/pg)-1)+pq},pB.sineIn=function(ph,pq,pf,pg){return-pf*Math.cos(ph/pg*pB.HALF_PI)+pf+pq},pB.sineOut=function(ph,pq,pf,pg){return pf*Math.sin(ph/pg*pB.HALF_PI)+pq},pB.quintIn=function(ph,pq,pf,pg){return pf*(ph/=pg)*ph*ph*ph*ph+pq},pB.quintInOut=function(ph,pq,pf,pg){return(ph/=.5*pg)<1?.5*pf*ph*ph*ph*ph*ph+pq:.5*pf*((ph-=2)*ph*ph*ph*ph+2)+pq},pB.quintOut=function(ph,pq,pf,pg){return pf*((ph=ph/pg-1)*ph*ph*ph*ph+1)+pq},pB.quartIn=function(ph,pq,pf,pg){return pf*(ph/=pg)*ph*ph*ph+pq},pB.quartInOut=function(ph,pq,pf,pg){return(ph/=.5*pg)<1?.5*pf*ph*ph*ph*ph+pq:.5*-pf*((ph-=2)*ph*ph*ph-2)+pq},pB.quartOut=function(ph,pq,pf,pg){return-pf*((ph=ph/pg-1)*ph*ph*ph-1)+pq},pB.cubicIn=function(ph,pq,pf,pg){return pf*(ph/=pg)*ph*ph+pq},pB.cubicInOut=function(ph,pq,pf,pg){return(ph/=.5*pg)<1?.5*pf*ph*ph*ph+pq:.5*pf*((ph-=2)*ph*ph+2)+pq},pB.cubicOut=function(ph,pq,pf,pg){return pf*((ph=ph/pg-1)*ph*ph+1)+pq},pB.quadIn=function(ph,pq,pf,pg){return pf*(ph/=pg)*ph+pq},pB.quadInOut=function(ph,pq,pf,pg){return(ph/=.5*pg)<1?.5*pf*ph*ph+pq:.5*-pf*(--ph*(ph-2)-1)+pq},pB.quadOut=function(ph,pq,pf,pg){return-pf*(ph/=pg)*(ph-2)+pq},pB.expoIn=function(ph,pq,pf,pg){return 0==ph?pq:pf*Math.pow(2,10*(ph/pg-1))+pq-.001*pf},pB.expoInOut=function(ph,pq,pf,pg){return 0==ph?pq:ph==pg?pq+pf:(ph/=.5*pg)<1?.5*pf*Math.pow(2,10*(ph-1))+pq:.5*pf*(2-Math.pow(2,-10*--ph))+pq},pB.expoOut=function(ph,pq,pf,pg){return ph==pg?pq+pf:pf*(1-Math.pow(2,-10*ph/pg))+pq},pB.circIn=function(ph,pq,pf,pg){return-pf*(Math.sqrt(1-(ph/=pg)*ph)-1)+pq},pB.circInOut=function(ph,pq,pf,pg){return(ph/=.5*pg)<1?.5*-pf*(Math.sqrt(1-ph*ph)-1)+pq:.5*pf*(Math.sqrt(1-(ph-=2)*ph)+1)+pq},pB.circOut=function(ph,pq,pf,pg){return pf*Math.sqrt(1-(ph=ph/pg-1)*ph)+pq},pB.HALF_PI=.5*Math.PI,pB.PI2=2*Math.PI,pB}(),py=function(){function pU(){this._hit=null,this._unHit=null}pe(pU,"laya.utils.HitArea");var ph=pU.prototype;return ph.isHit=function(ph,pq){return!!pU.isHitGraphic(ph,pq,this.hit)&&!pU.isHitGraphic(ph,pq,this.unHit)},ph.contains=function(ph,pq){return this.isHit(ph,pq)},pC(0,ph,"hit",function(){return this._hit||(this._hit=new pu),this._hit},function(ph){this._hit=ph}),pC(0,ph,"unHit",function(){return this._unHit||(this._unHit=new pu),this._unHit},function(ph){this._unHit=ph}),pU.isHitGraphic=function(ph,pq,pf){if(!pf)return!1;var pg;if(!(pg=pf.cmds)&&pf._one&&((pg=pU._cmds).length=1,pg[0]=pf._one),!pg)return!1;var p$,pP,pS=0;for(p$=pg.length,pS=0;pS<p$;pS++)if(pP=pg[pS]){var pB=pc._context;switch(pP.callee){case pB._translate:case 6:ph-=pP[0],pq-=pP[1]}if(pU.isHitCmd(ph,pq,pP))return!0}return!1},pU.isHitCmd=function(ph,pq,pf){if(!pf)return!1;var pg=pc._context,p$=!1;switch(pf.callee){case pg._drawRect:case 13:pU._rec.setTo(pf[0],pf[1],pf[2],pf[3]),p$=pU._rec.contains(ph,pq);break;case pg._drawCircle:case pg._fillCircle:case 14:p$=(ph-=pf[0])*ph+(pq-=pf[1])*pq<pf[2]*pf[2];break;case pg._drawPoly:case 18:ph-=pf[0],pq-=pf[1],p$=pU.ptInPolygon(ph,pq,pf[2])}return p$},pU.ptInPolygon=function(ph,pq,pf){var pg;(pg=pU._ptPoint).setTo(ph,pq);var p$,pP=0,pS=NaN,pB=NaN,pr=NaN,pY=NaN;p$=pf.length;for(var pC=0;pC<p$;pC+=2){if(pS=pf[pC],pB=pf[pC+1],pr=pf[(pC+2)%p$],pB!=(pY=pf[(pC+3)%p$]))if(!(pg.y<Math.min(pB,pY)))if(!(pg.y>=Math.max(pB,pY)))(pg.y-pB)*(pr-pS)/(pY-pB)+pS>pg.x&&pP++}return pP%2==1},pU._cmds=[],pr(pU,["_rec",function(){return this._rec=new pn},"_ptPoint",function(){return this._ptPoint=new pX}]),pU}(),pF=(function(){function p$(ph,pq,pf,pg){this.char=ph,this.charNum=ph.charCodeAt(0),this._x=this._y=0,this.width=pq,this.height=pf,this.style=pg,this.isWord=!p$._isWordRegExp.test(ph)}pe(p$,"laya.utils.HTMLChar");var ph=p$.prototype;pt.imps(ph,{"laya.display.ILayout":!0}),ph.setSprite=function(ph){this._sprite=ph},ph.getSprite=function(){return this._sprite},ph._isChar=function(){return!0},ph._getCSSStyle=function(){return this.style},pC(0,ph,"width",function(){return this._w},function(ph){this._w=ph}),pC(0,ph,"x",function(){return this._x},function(ph){this._sprite&&(this._sprite.x=ph),this._x=ph}),pC(0,ph,"y",function(){return this._y},function(ph){this._sprite&&(this._sprite.y=ph),this._y=ph}),pC(0,ph,"height",function(){return this._h},function(ph){this._h=ph}),p$._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function pq(){}pe(pq,"laya.utils.Log"),pq.enable=function(){pq._logdiv||(pq._logdiv=pw.window.document.createElement("div"),pw.window.document.body.appendChild(pq._logdiv),pq._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},pq.toggle=function(){var ph=pq._logdiv.style;"1px"==ph.width?ph.width=ph.height="50%":ph.width=ph.height="1px"},pq.print=function(ph){pq._logdiv&&(pq.maxCount<=pq._count&&pq.clear(),pq._count++,pq._logdiv.innerText+=ph+"\n",pq._logdiv.scrollTop=pq._logdiv.scrollHeight)},pq.clear=function(){pq._logdiv.innerText="",pq._count=0},pq._logdiv=null,pq._count=0,pq.maxCount=20}(),function(){function pq(){}pe(pq,"laya.utils.Mouse"),pC(1,pq,"cursor",function(){return pq._style.cursor},function(ph){pq._style.cursor=ph}),pq.hide=function(){"none"!=pq.cursor&&(pq._preCursor=pq.cursor,pq.cursor="none")},pq.show=function(){"none"==pq.cursor&&(pq.cursor=pq._preCursor?pq._preCursor:"auto")},pq._preCursor=null,pr(pq,["_style",function(){return this._style=pw.document.body.style}])}(),function(){function pP(){}return pe(pP,"laya.utils.Pool"),pP.getPoolBySign=function(ph){return pP._poolDic[ph]||(pP._poolDic[ph]=[])},pP.clearBySign=function(ph){pP._poolDic[ph]&&(pP._poolDic[ph].length=0)},pP.recover=function(ph,pq){pq.__InPool||(pq.__InPool=!0,pP.getPoolBySign(ph).push(pq))},pP.getItemByClass=function(ph,pq){var pf=pP.getPoolBySign(ph),pg=pf.length?pf.pop():new pq;return pg.__InPool=!1,pg},pP.getItemByCreateFun=function(ph,pq,pf){var pg=pP.getPoolBySign(ph),p$=pg.length?pg.pop():pq.call(pf);return p$.__InPool=!1,p$},pP.getItem=function(ph){var pq=pP.getPoolBySign(ph),pf=pq.length?pq.pop():null;return pf&&(pf.__InPool=!1),pf},pP._poolDic={},pP.InPoolSign="__InPool",pP}()),pZ=function(){function pr(){}return pe(pr,"laya.utils.Stat"),pC(1,pr,"onclick",null,function(ph){pr._sp&&pr._sp.on("click",pr._sp,ph),pr._canvas&&(pr._canvas.source.onclick=ph,pr._canvas.source.style.pointerEvents="")}),pr.show=function(ph,pq,pf){if(void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),!pc.isConchApp||pc.isConchWebGL){if(pc.isConchWebGL||pw.onMiniGame||pw.onLimixiu||(pr._useCanvas=!0),pr._show=!0,pr._fpsData.length=60,pr._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},pr._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},pr._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},pr._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},pc.isWebGL)if(pr._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},pc.is3DMode){if(pr._view[0].title="FPS(3D)",pr._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},pr._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},pr._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==pf){var pg=8;pr._view[pg++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},pr._view[pg++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},pr._view[pg++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},pr._view[pg++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},pr._view[pg++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},pr._view[pg++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},pr._view[pg++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},pr._view[pg++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},pr._view[pg++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==pf){pg=8;pr._view[pg++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},pr._view[pg++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},pr._view[pg++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},pr._view[pg++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},pr._view[pg++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},pr._view[pg++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},pr._view[pg++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else pr._view[0].title="FPS(WebGL)",pr._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else pr._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};pr._useCanvas?pr.createUIPre(ph,pq):pr.createUI(ph,pq),pr.enable()}else pw.window.conch.showFPS&&pw.window.conch.showFPS(ph,pq)},pr.createUIPre=function(ph,pq){var pf=pw.pixelRatio;pr._width=170*pf,pr._vx=75*pf,pr._height=pf*(12*pr._view.length+3*pf)+4,pr._fontSize=12*pf;for(var pg=0;pg<pr._view.length;pg++)pr._view[pg].x=4,pr._view[pg].y=pg*pr._fontSize+2*pf;pr._canvas||((pr._canvas=new pGh("2D")).size(pr._width,pr._height),(pr._ctx=pr._canvas.getContext("2d")).textBaseline="top",pr._ctx.font=pr._fontSize+"px Sans-serif",pr._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+ph+"px;top:"+pq+"px;width:"+pr._width/pf+"px;height:"+pr._height/pf+"px;"),pr._first=!0,pr.loop(),pr._first=!1,pw.container.appendChild(pr._canvas.source)},pr.createUI=function(ph,pq){var pf=pr._sp,pg=pw.pixelRatio;pf||(pf=new pUh,(pr._leftText=new plh).pos(5,5),pr._leftText.color="#ffffff",pf.addChild(pr._leftText),(pr._txt=new plh).pos(80*pg,5),pr._txt.color="#ffffff",pf.addChild(pr._txt),pr._sp=pf),pf.pos(ph,pq);for(var p$="",pP=0;pP<pr._view.length;pP++){p$+=pr._view[pP].title+"\n"}pr._leftText.text=p$;var pS=170*pg,pB=pg*(12*pr._view.length+3*pg)+4;pr._txt.fontSize=pr._fontSize*pg,pr._leftText.fontSize=pr._fontSize*pg,pf.size(pS,pB),pf.graphics.clear(),pf.graphics.setAlpha(.5),pf.graphics.drawRect(0,0,pS,pB,"#999999"),pf.graphics.setAlpha(1),pr.loop()},pr.enable=function(){pt.timer.frameLoop(1,pr,pr.loop)},pr.hide=function(){pr._show=!1,pt.timer.clear(pr,pr.loop),pr._canvas&&pw.removeElement(pr._canvas.source)},pr.clear=function(){pr.trianglesFaces=pr.drawCall=pr.shaderCall=pr.spriteCount=pr.spriteRenderUseCacheCount=pr.treeNodeCollision=pr.treeSpriteCollision=pr.canvasNormal=pr.canvasBitmap=pr.canvasReCache=0},pr.loop=function(){pr._count++;var ph=pw.now();if(!(ph-pr._timer<1e3)){var pq=pr._count;if(pr.FPS=Math.round(1e3*pq/(ph-pr._timer)),pr._show){pr.trianglesFaces=Math.round(pr.trianglesFaces/pq),pr.spriteCount=pr._useCanvas?(pr.drawCall=Math.round(pr.drawCall/pq)-2,pr.shaderCall=Math.round(pr.shaderCall/pq),Math.round(pr.spriteCount/pq)-1):(pr.drawCall=Math.round(pr.drawCall/pq)-2,pr.shaderCall=Math.round(pr.shaderCall/pq)-4,Math.round(pr.spriteCount/pq)-4),pr.spriteRenderUseCacheCount=Math.round(pr.spriteRenderUseCacheCount/pq),pr.canvasNormal=Math.round(pr.canvasNormal/pq),pr.canvasBitmap=Math.round(pr.canvasBitmap/pq),pr.canvasReCache=Math.ceil(pr.canvasReCache/pq),pr.treeNodeCollision=Math.round(pr.treeNodeCollision/pq),pr.treeSpriteCollision=Math.round(pr.treeSpriteCollision/pq);var pf=0<pr.FPS?Math.floor(1e3/pr.FPS).toString():" ";pr._fpsStr=pr.FPS+(pr.renderSlow?" slow":"")+" "+pf,pr._spriteStr=pr.spriteCount+(pr.spriteRenderUseCacheCount?"/"+pr.spriteRenderUseCacheCount:""),pr._canvasStr=pr.canvasReCache+"/"+pr.canvasNormal+"/"+pr.canvasBitmap,pr.currentMemorySize=pI.systemResourceManager.memorySize,pr._useCanvas?pr.renderInfoPre():pr.renderInfo(),pr.clear()}pr._count=0,pr._timer=ph}},pr.renderInfoPre=function(){if(pr._canvas){var ph=pr._ctx;ph.clearRect(pr._first?0:pr._vx,0,pr._width,pr._height);for(var pq=pc.WebGL.mainContext,pf=0;pf<pr._view.length;pf++){var pg=pr._view[pf];pr._first&&(ph.fillStyle="white",ph.fillText(pg.title,pg.x,pg.y,null,null,null)),ph.fillStyle=pg.color;var p$=-1;if((pg=pr._view[pf]).varying){if(pq)switch(pg.varying){case 1:p$=pq.getParameter(pq[pg.value]);break;case 2:p$=pq.getExtension(pg.value)}}else p$=pr[pg.value];"M"==pg.units&&(p$=Math.floor(p$/1048576*100)/100+" M"),"K"==pg.units&&(p$=Math.floor(p$/1024*100)/100+" K"),"string"==pg.units&&(p$=p$.match(/\d+\.?\d/i)),ph.fillText(p$+"",pg.x+pr._vx,pg.y,null,null,null)}}},pr.renderInfo=function(){for(var ph="",pq=pc.WebGL.mainContext,pf=0;pf<pr._view.length;pf++){var pg=pr._view[pf],p$=-1;if(pg.varying){if(pq)switch(pg.varying){case 1:p$=pq.getParameter(pq[pg.value]);break;case 2:p$=pq.getExtension(pg.value)}}else p$=pr[pg.value];"M"==pg.units&&(p$=Math.floor(p$/1048576*100)/100+" M"),"K"==pg.units&&(p$=Math.floor(p$/1024*100)/100+" K"),"string"==pg.units&&(p$=p$.match(/\d+\.?\d/i)),ph+=p$+"\n"}pr._txt.text=ph},pr.FPS=0,pr.loopCount=0,pr.shaderCall=0,pr.drawCall=0,pr.trianglesFaces=0,pr.spriteCount=0,pr.spriteRenderUseCacheCount=0,pr.treeNodeCollision=0,pr.treeSpriteCollision=0,pr.canvasNormal=0,pr.canvasBitmap=0,pr.canvasReCache=0,pr.renderSlow=!1,pr.currentMemorySize=0,pr._fpsStr=null,pr._canvasStr=null,pr._spriteStr=null,pr._fpsData=[],pr._timer=0,pr._count=0,pr._view=[],pr._fontSize=12,pr._txt=null,pr._leftText=null,pr._sp=null,pr._show=!1,pr._useCanvas=!1,pr._canvas=null,pr._ctx=null,pr._first=!1,pr._vx=NaN,pr._width=0,pr._height=100,pr}(),pQ=(function(){function ph(){this._strsToID={},this._idToStrs=[],this._length=0}pe(ph,"laya.utils.StringKey");var pq=ph.prototype;pq.add=function(ph){var pq=this._strsToID[ph];return null!=pq?pq:(this._idToStrs[this._length]=ph,this._strsToID[ph]=this._length++)},pq.getID=function(ph){var pq=this._strsToID[ph];return null==pq?-1:pq},pq.getName=function(ph){var pq=this._idToStrs[ph];return null==pq?void 0:pq}}(),function(){var pY;function ph(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}pe(ph,"laya.utils.Timer");var pq=ph.prototype;return pq._init=function(){pt.timer&&pt.timer.frameLoop(1,this,this._update)},pq._now=function(){return Date.now()},pq._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var ph=this.currFrame=this.currFrame+this.scale,pq=this._now();this._delta=(pq-this._lastTimer)*this.scale;var pf=this.currTimer=this.currTimer+this._delta;pt.isDebug&&6e4<Math.abs(pq-this._lastTimer)&&console.error("系统时间错误！"+(pq-this._lastTimer)),this._lastTimer=pq;var pg=this._handlers;for(pS=this._count=0,pB=pg.length;pS<pB;pS++)if(null!==(pr=pg[pS]).method){var p$=pr.userFrame?ph:pf;if(p$>=pr.exeTime)if(pr.repeat)if(pr.jumpFrame)for(;p$>=pr.exeTime;)pr.exeTime+=pr.delay,pr.run(!1);else pr.exeTime+=pr.delay,pr.run(!1),p$>pr.exeTime&&(pr.exeTime+=Math.ceil((p$-pr.exeTime)/pr.delay)*pr.delay);else pr.run(!0)}else this._count++;(30<this._count||ph%200==0)&&this._clearHandlers();for(var pP=this._laters,pS=0,pB=pP.length-1;pS<=pB;pS++){var pr=pP[pS];this._isIgnoreRecover(pr)||(null!==pr.method&&(delete this._map[pr.key],pr.run(!1)),this._recoverHandler(pr)),pS===pB&&(pB=pP.length-1)}pP.length=0}},pq._clearHandlers=function(){for(var ph=this._handlers,pq=0,pf=ph.length;pq<pf;pq++){var pg=ph[pq];null!==pg.method?this._temp.push(pg):this._isIgnoreRecover(pg)?this._temp.push(pg):this._recoverHandler(pg)}this._handlers=this._temp,this._temp=ph,this._temp.length=0},pq._recoverHandler=function(ph){this._map[ph.key]==ph&&delete this._map[ph.key],ph.recover()},pq._create=function(ph,pq,pf,pg,p$,pP,pS,pB){if(!pf)return p$.apply(pg,pP),null;if(pS){var pr=this._getHandler(pg,p$);if(pr)return pr.repeat=pq,pr.userFrame=ph,pr.delay=pf,pr.ignoreRecover=pB,pr.caller=pg,pr.method=p$,pr.args=pP,pr.exeTime=pf+(ph?this.currFrame:this.currTimer+this._now()-this._lastTimer),pr}return(pr=pY.create()).repeat=pq,pr.userFrame=ph,pr.delay=pf,pr.ignoreRecover=pB,pr.caller=pg,pr.method=p$,pr.args=pP,pr.exeTime=pf+(ph?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(pr),this._handlers.push(pr),pr},pq._indexHandler=function(ph){var pq=ph.caller,pf=ph.method,pg=pq?pq.$_GID||(pq.$_GID=pO.getGID()):0,p$=pf.$_TID||(pf.$_TID=this._mid++);ph.key=pg+"_"+p$,this._map[ph.key]=ph},pq.once=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=!0),this._create(!1,!1,ph,pq,pf,pg,p$,!1)},pq.loop=function(ph,pq,pf,pg,p$,pP,pS){void 0===p$&&(p$=!0),void 0===pP&&(pP=!1),void 0===pS&&(pS=!1);var pB=this._create(!1,!0,ph,pq,pf,pg,p$,pS);pB&&(pB.jumpFrame=pP)},pq.frameOnce=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=!0),this._create(!0,!1,ph,pq,pf,pg,p$,!1)},pq.frameLoop=function(ph,pq,pf,pg,p$,pP){void 0===p$&&(p$=!0),void 0===pP&&(pP=!1),this._create(!0,!0,ph,pq,pf,pg,p$,pP)},pq.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+pY._freeCount},pq.clear=function(ph,pq){var pf=this._getHandler(ph,pq);return!(!pf||this._isIgnoreRecover(pf))&&(delete this._map[pf.key],pf.key=null,pf.clear(),!0)},pq.clearAll=function(ph){if(ph)for(var pq=0,pf=this._handlers.length;pq<pf;pq++){var pg=this._handlers[pq];pg.caller===ph&&(this._isIgnoreRecover(pg)||(delete this._map[pg.key],pg.key=null,pg.clear()))}},pq._getHandler=function(ph,pq){var pf=ph?ph.$_GID||(ph.$_GID=pO.getGID()):0,pg=pq.$_TID||(pq.$_TID=this._mid++);return this._map[pf+"_"+pg]},pq._isIgnoreRecover=function(ph){if(ph.ignoreRecover||ph.caller&&"IgnoreRecover"==ph.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var pq="";try{arguments.propertyIsEnumerable.caller}catch(ph){pq=ph.stack}pt.recordError("报错：核心定时器销毁忽略  "+pq)}return!0}return!1},pq.hasHandler=function(ph,pq){return this._map[ph.$_GID+"_"+pq.$_TID]},pq.callLater=function(ph,pq,pf){if(null==this._getHandler(ph,pq)){var pg=pY.create();pg.caller=ph,pg.method=pq,pg.args=pf,this._indexHandler(pg),this._laters.push(pg)}},pq.runCallLater=function(ph,pq){var pf=this._getHandler(ph,pq);pf&&null!=pf.method&&(this._isIgnoreRecover(pf)||(delete this._map[pf.key],pf.run(!0)))},pq.runTimer=function(ph,pq){this.runCallLater(ph,pq)},pC(0,pq,"delta",function(){return this._delta}),ph.__init$=function(){pY=function(){function pq(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}pe(pq,"");var ph=pq.prototype;return ph.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},ph.recover=function(){this.clear(),this.args=pq._freeHandler,pq._freeHandler=this,pq._freeCount++},ph.run=function(ph){var pq=this.caller;if(pq&&pq.destroyed)return this.clear();var pf=this.method,pg=this.args;ph&&this.clear(),null!=pf&&(pg?pf.apply(pq,pg):pf.call(pq))},pq._freeHandler=null,pq._freeCount=0,pq.create=function(){var ph=pq._freeHandler;return ph?(pq._freeHandler=ph.args,--pq._freeCount,ph.args=null,ph):new pq},pq}()},ph}()),po=function(){function pU(){this.gid=0}pe(pU,"laya.utils.Tween");var ph=pU.prototype;return ph.to=function(ph,pq,pf,pg,p$,pP,pS){return void 0===pP&&(pP=0),void 0===pS&&(pS=!1),this._create(ph,pq,pf,pg,p$,pP,pS,!0,!1,!0)},ph.from=function(ph,pq,pf,pg,p$,pP,pS){return void 0===pP&&(pP=0),void 0===pS&&(pS=!1),this._create(ph,pq,pf,pg,p$,pP,pS,!1,!1,!0)},ph._create=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){if(!ph)throw new Error("Tween:target is null");this._target=ph,this._duration=pf,this._ease=pg||pq.ease||pU.easeNone,this._complete=p$||pq.complete,this._delay=pP,this._props=[],this._usedTimer=0,this._startTimer=pw.now(),this._usedPool=pr,this._delayParam=null,this.update=pq.update;var pC=ph.$_GID||(ph.$_GID=pO.getGID());return pU.tweenMap[pC]?(pS&&pU.clearTween(ph),pU.tweenMap[pC].push(this)):pU.tweenMap[pC]=[this],pY?pP<=0?this.firstStart(ph,pq,pB):(this._delayParam=[ph,pq,pB],pt.scaleTimer.once(pP,this,this.firstStart,this._delayParam)):this._initProps(ph,pq,pB),this},ph.firstStart=function(ph,pq,pf){this._delayParam=null,ph.destroyed?this.clear():(this._initProps(ph,pq,pf),this._beginLoop())},ph._initProps=function(ph,pq,pf){for(var pg in pq)if("number"==typeof ph[pg]){var p$=pf?ph[pg]:pq[pg],pP=pf?pq[pg]:ph[pg];this._props.push([pg,p$,pP-p$]),pf||(ph[pg]=p$)}},ph._beginLoop=function(){pt.scaleTimer.frameLoop(1,this,this._doEase)},ph._doEase=function(){this._updateEase(pw.now())},ph._updateEase=function(ph){var pq=this._target;if(pq){if(pq.destroyed)return pU.clearTween(pq);var pf=this._usedTimer=ph-this._startTimer-this._delay;if(!(pf<0)){if(pf>=this._duration)return this.complete();for(var pg=0<pf?this._ease(pf,0,1,this._duration):0,p$=this._props,pP=0,pS=p$.length;pP<pS;pP++){var pB=p$[pP];pq[pB[0]]=pB[1]+pg*pB[2]}this.update&&this.update.run()}}},ph.complete=function(){if(this._target){pt.scaleTimer.runTimer(this,this.firstStart);for(var ph=this._target,pq=this._props,pf=this._complete,pg=0,p$=pq.length;pg<p$;pg++){var pP=pq[pg];ph[pP[0]]=pP[1]+pP[2]}this.update&&this.update.run(),this.clear(),pf&&pf.run()}},ph.pause=function(){pt.scaleTimer.clear(this,this._beginLoop),pt.scaleTimer.clear(this,this._doEase),pt.scaleTimer.clear(this,this.firstStart);var ph;(ph=pw.now()-this._startTimer-this._delay)<0&&(this._usedTimer=ph)},ph.setStartTime=function(ph){this._startTimer=ph},ph.clear=function(){this._target&&(this._remove(),this._clear())},ph._clear=function(){this.pause(),pt.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,pF.recover("tween",this))},ph.recover=function(){this._usedPool=!0,this._clear()},ph._remove=function(){var ph=pU.tweenMap[this._target.$_GID];if(ph)for(var pq=0,pf=ph.length;pq<pf;pq++)if(ph[pq]===this){ph.splice(pq,1);break}},ph.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=pw.now(),this._delayParam)pt.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var ph=this._props,pq=0,pf=ph.length;pq<pf;pq++){var pg=ph[pq];this._target[pg[0]]=pg[1]}pt.scaleTimer.once(this._delay,this,this._beginLoop)}},ph.resume=function(){this._usedTimer>=this._duration||(this._startTimer=pw.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?pt.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},pC(0,ph,"progress",null,function(ph){var pq=ph*this._duration;this._startTimer=pw.now()-this._delay-pq}),pU.to=function(ph,pq,pf,pg,p$,pP,pS,pB){return void 0===pP&&(pP=0),void 0===pS&&(pS=!1),void 0===pB&&(pB=!0),pF.getItemByClass("tween",pU)._create(ph,pq,pf,pg,p$,pP,pS,!0,pB,!0)},pU.from=function(ph,pq,pf,pg,p$,pP,pS,pB){return void 0===pP&&(pP=0),void 0===pS&&(pS=!1),void 0===pB&&(pB=!0),pF.getItemByClass("tween",pU)._create(ph,pq,pf,pg,p$,pP,pS,!1,pB,!0)},pU.clearAll=function(ph){if(ph&&ph.$_GID){var pq=pU.tweenMap[ph.$_GID];if(pq){for(var pf=0,pg=pq.length;pf<pg;pf++)pq[pf]._clear();pq.length=0}}},pU.clear=function(ph){ph.clear()},pU.clearTween=function(ph){pU.clearAll(ph)},pU.easeNone=function(ph,pq,pf,pg){return pf*ph/pg+pq},pU.tweenMap={},pU}(),pO=function(){function pB(){}return pe(pB,"laya.utils.Utils"),pB.toRadian=function(ph){return ph*pB._pi2},pB.toAngle=function(ph){return ph*pB._pi},pB.toHexColor=function(ph){if(ph<0||isNaN(ph))return null;for(var pq=ph.toString(16);pq.length<6;)pq="0"+pq;return"#"+pq},pB.getGID=function(){return pB._gid++},pB.concatArray=function(ph,pq){if(!pq)return ph;if(!ph)return pq;var pf=0,pg=pq.length;for(pf=0;pf<pg;pf++)ph.push(pq[pf]);return ph},pB.clearArray=function(ph){return ph&&(ph.length=0),ph},pB.copyArray=function(ph,pq){if(ph||(ph=[]),!pq)return ph;ph.length=pq.length;var pf=0,pg=pq.length;for(pf=0;pf<pg;pf++)ph[pf]=pq[pf];return ph},pB.getGlobalRecByPoints=function(ph,pq,pf,pg,p$){var pP,pS;return pP=new pX(pq,pf),pP=ph.localToGlobal(pP),pS=new pX(pg,p$),pS=ph.localToGlobal(pS),pn._getWrapRec([pP.x,pP.y,pS.x,pS.y])},pB.getGlobalPosAndScale=function(ph){return pB.getGlobalRecByPoints(ph,0,0,1,1)},pB.bind=function(ph,pq){return ph.bind(pq)},pB.measureText=function(ph,pq){return pd.measureText(ph,pq)},pB.updateOrder=function(ph){if(!ph||ph.length<2)return!1;for(var pq,pf=1,pg=0,p$=ph.length,pP=NaN;pf<p$;){for(pq=ph[pg=pf],pP=ph[pg]._zOrder;-1<--pg&&ph[pg]._zOrder>pP;)ph[pg+1]=ph[pg];ph[pg+1]=pq,pf++}var pS=pq.parent.conchModel;if(pS)if(null!=pS.updateZOrder)pS.updateZOrder();else{for(pf=0;pf<p$;pf++)pS.removeChild(ph[pf].conchModel);for(pf=0;pf<p$;pf++)pS.addChildAt(ph[pf].conchModel,pf)}return!0},pB.transPointList=function(ph,pq,pf){var pg=0,p$=ph.length;for(pg=0;pg<p$;pg+=2)ph[pg]+=pq,ph[pg+1]+=pf},pB.parseInt=function(ph,pq){void 0===pq&&(pq=0);var pf=pw.window.parseInt(ph,pq);return isNaN(pf)?0:pf},pB.getFileExtension=function(ph){pB._extReg.lastIndex=ph.lastIndexOf(".");var pq=pB._extReg.exec(ph);return pq&&1<pq.length?pq[1].toLowerCase():null},pB.getTransformRelativeToWindow=function(ph,pq,pf){var pg=pt.stage,p$=laya.utils.Utils.getGlobalPosAndScale(ph),pP=pg._canvasTransform.clone(),pS=pP.tx,pB=pP.ty;pP.rotate(-Math.PI/180*pt.stage.canvasDegree),pP.scale(pt.stage.clientScaleX,pt.stage.clientScaleY);var pr=pt.stage.canvasDegree%180!=0,pY=NaN,pC=NaN;pr?(pY=pf+p$.y,pC=pq+p$.x,pY*=pP.d,pC*=pP.a,90==pt.stage.canvasDegree?(pY=pS-pY,pC+=pB):(pY+=pS,pC=pB-pC)):(pY=pq+p$.x,pC=pf+p$.y,pY*=pP.a,pC*=pP.d,pY+=pS,pC+=pB);var pU=NaN,pu=NaN;return pu=pr?(pU=pP.d*p$.height,pP.a*p$.width):(pU=pP.a*p$.width,pP.d*p$.height),{x:pY,y:pC,scaleX:pU,scaleY:pu}},pB.fitDOMElementInArea=function(ph,pq,pf,pg,p$,pP){ph._fitLayaAirInitialized||(ph._fitLayaAirInitialized=!0,ph.style.transformOrigin=ph.style.webKittransformOrigin="left top",ph.style.position="absolute");var pS=pB.getTransformRelativeToWindow(pq,pf,pg);ph.style.transform=ph.style.webkitTransform="scale("+pS.scaleX+","+pS.scaleY+") rotate("+pt.stage.canvasDegree+"deg)",ph.style.width=p$+"px",ph.style.height=pP+"px",ph.style.left=pS.x+"px",ph.style.top=pS.y+"px"},pB.isOkTextureList=function(ph){if(!ph)return!1;var pq,pf=0,pg=ph.length;for(pf=0;pf<pg;pf++)if(!(pq=ph[pf])||!pq.source)return!1;return!0},pB.isOKCmdList=function(ph){if(!ph)return!1;var pq,pf,pg=0,p$=ph.length,pP=pc._context;for(pg=0;pg<p$;pg++)switch((pq=ph[pg]).callee){case pP._drawTexture:case pP._fillTexture:case pP._drawTextureWithTransform:if(!(pf=pq[0])||!pf.source)return!1}return!0},pB._gid=1,pB._pi=180/Math.PI,pB._pi2=Math.PI/180,pB._extReg=/\.(\w+)\??/g,pB.parseXMLFromString=function(ph){var pq;if(ph=ph.replace(/>\s+</g,"><"),-1<(pq=(new DOMParser).parseFromString(ph,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(pq.firstChild.firstChild.textContent);return pq},pB}(),pj=function(){function ph(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],pc.isWebGL&&pH.regCacheByFunction(pO.bind(this.startDispose,this),pO.bind(this.getCacheList,this))}pe(ph,"laya.utils.VectorGraphManager");var pq=ph.prototype;return pq.getId=function(){return this._id++},pq.addShape=function(ph,pq){this.shapeDic[ph]=pq,this.useDic[ph]||(this.useDic[ph]=!0)},pq.addLine=function(ph,pq){this.shapeLineDic[ph]=pq,this.shapeLineDic[ph]||(this.shapeLineDic[ph]=!0)},pq.getShape=function(ph){this._checkKey&&null!=this.useDic[ph]&&(this.useDic[ph]=!0)},pq.deleteShape=function(ph){this.shapeDic[ph]&&(this.shapeDic[ph]=null,delete this.shapeDic[ph]),this.shapeLineDic[ph]&&(this.shapeLineDic[ph]=null,delete this.shapeLineDic[ph]),null!=this.useDic[ph]&&delete this.useDic[ph]},pq.getCacheList=function(){var ph,pq=[];for(ph in this.shapeDic)pq.push(this.shapeDic[ph]);for(ph in this.shapeLineDic)pq.push(this.shapeLineDic[ph]);return pq},pq.startDispose=function(ph){var pq;for(pq in this.useDic)this.useDic[pq]=!1;this._checkKey=!0},pq.endDispose=function(){if(this._checkKey){var ph;for(ph in this.useDic)this.useDic[ph]||this.deleteShape(ph);this._checkKey=!1}},ph.getInstance=function(){return ph.instance=ph.instance||new ph},ph.instance=null,ph}(),px=function(){function pg(){this._obj=null,this._obj=pg.supportWeakMap?new pw.window.WeakMap:{},pg.supportWeakMap||pg._maps.push(this)}pe(pg,"laya.utils.WeakObject");var ph=pg.prototype;return ph.set=function(ph,pq){if(null!=ph)if(pg.supportWeakMap){var pf=ph;"string"!=typeof ph&&"number"!=typeof ph||(pf=pg._keys[ph])||(pf=pg._keys[ph]={k:ph}),this._obj.set(pf,pq)}else"string"==typeof ph||"number"==typeof ph?this._obj[ph]=pq:(ph.$_GID||(ph.$_GID=pO.getGID()),this._obj[ph.$_GID]=pq)},ph.get=function(ph){if(null==ph)return null;if(pg.supportWeakMap){var pq="string"==typeof ph||"number"==typeof ph?pg._keys[ph]:ph;return pq?this._obj.get(pq):null}return"string"==typeof ph||"number"==typeof ph?this._obj[ph]:this._obj[ph.$_GID]},ph.del=function(ph){if(null!=ph)if(pg.supportWeakMap){var pq="string"==typeof ph||"number"==typeof ph?pg._keys[ph]:ph;if(!pq)return;this._obj.delete(pq)}else"string"==typeof ph||"number"==typeof ph?delete this._obj[ph]:delete this._obj[this._obj.$_GID]},ph.has=function(ph){if(null==ph)return!1;if(pg.supportWeakMap){var pq="string"==typeof ph||"number"==typeof ph?pg._keys[ph]:ph;return this._obj.has(pq)}return"string"==typeof ph||"number"==typeof ph?null!=this._obj[ph]:null!=this._obj[this._obj.$_GID]},pg.__init__=function(){(pg.supportWeakMap=null!=pw.window.WeakMap)||pt.timer.loop(pg.delInterval,null,pg.clearCache)},pg.clearCache=function(){for(var ph=0,pq=pg._maps.length;ph<pq;ph++){pg._maps[ph]._obj={}}},pg.supportWeakMap=!1,pg.delInterval=3e5,pg._keys={},pg._maps=[],pr(pg,["I",function(){return this.I=new pg}]),pg}(),pa=function(){function ph(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}pe(ph,"laya.utils.WordText");var pq=ph.prototype;return pq.setText=function(ph){this.changed=!0,this._text=ph},pq.toString=function(){return this._text},pq.charCodeAt=function(ph){return this._text?this._text.charCodeAt(ph):NaN},pq.charAt=function(ph){return this._text?this._text.charAt(ph):null},pC(0,pq,"length",function(){return this._text?this._text.length:0}),ph}(),phh=function(ph){function pS(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,pS.__super.call(this),this._childs=pS.ARRAY_EMPTY,this._$P=pS.PROP_EMPTY,this.timer=pt.scaleTimer,this.conchModel=pc.isConchNode?this.createConchModel():null}pe(pS,"laya.display.Node",pY);var pq=pS.prototype;return pq._setBit=function(ph,pq){1==ph&&(this._getBit(ph)!=pq&&this._updateDisplayedInstage());pq?this._bits|=ph:this._bits&=~ph},pq._getBit=function(ph){return 0!=(this._bits&ph)},pq._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},pq._setUpNoticeType=function(ph){var pq=this;for(pq._setBit(ph,!0),pq=pq.parent;pq;){if(pq._getBit(ph))return;pq._setBit(ph,!0),pq=pq.parent}},pq.on=function(ph,pq,pf,pg){return"display"!==ph&&"undisplay"!==ph||this._getBit(1)||this._setUpNoticeType(1),this._createListener(ph,pq,pf,pg,!1)},pq.once=function(ph,pq,pf,pg){return"display"!==ph&&"undisplay"!==ph||this._getBit(1)||this._setUpNoticeType(1),this._createListener(ph,pq,pf,pg,!0)},pq.createConchModel=function(){return null},pq.destroy=function(ph){void 0===ph&&(ph=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(ph?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},pq.destroyChildren=function(){if(this._childs)for(var ph=this._childs.length-1;-1<ph;ph--)this._childs[ph].destroy(!0)},pq.addChild=function(ph){if(!ph||this.destroyed||ph===this)return ph;if(ph.zOrder&&this._set$P("hasZorder",!0),ph._parent===this){var pq=this.getChildIndex(ph);pq!==this._childs.length-1&&(this._childs.splice(pq,1),this._childs.push(ph),this.conchModel&&(this.conchModel.removeChild(ph.conchModel),this.conchModel.addChildAt(ph.conchModel,this._childs.length-1)),this._childChanged())}else ph.parent&&ph.parent.removeChild(ph),this._childs===pS.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(ph),this.conchModel&&this.conchModel.addChildAt(ph.conchModel,this._childs.length-1),(ph.parent=this)._childChanged();return ph},pq.addChildren=function(ph){for(var pq=arguments,pf=0,pg=pq.length;pf<pg;)this.addChild(pq[pf++])},pq.addChildAt=function(ph,pq){if(!ph||this.destroyed||ph===this)return ph;if(ph.zOrder&&this._set$P("hasZorder",!0),0<=pq&&pq<=this._childs.length){if(ph._parent===this){var pf=this.getChildIndex(ph);this._childs.splice(pf,1),this._childs.splice(pq,0,ph),this.conchModel&&(this.conchModel.removeChild(ph.conchModel),this.conchModel.addChildAt(ph.conchModel,pq)),this._childChanged()}else ph.parent&&ph.parent.removeChild(ph),this._childs===pS.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(pq,0,ph),this.conchModel&&this.conchModel.addChildAt(ph.conchModel,pq),ph.parent=this;return ph}throw new Error("appendChildAt:The index is out of bounds")},pq.getChildIndex=function(ph){return this._childs.indexOf(ph)},pq.getChildByName=function(ph){var pq=this._childs;if(pq)for(var pf=0,pg=pq.length;pf<pg;pf++){var p$=pq[pf];if(p$.name===ph)return p$}return null},pq._get$P=function(ph){return this._$P[ph]},pq._set$P=function(ph,pq){return this.destroyed||(this._$P===pS.PROP_EMPTY&&(this._$P={}),this._$P[ph]=pq),pq},pq.getChildAt=function(ph){return this._childs[ph]},pq.setChildIndex=function(ph,pq){var pf=this._childs;if(pq<0||pq>=pf.length)throw new Error("setChildIndex:The index is out of bounds.");var pg=this.getChildIndex(ph);if(pg<0)throw new Error("setChildIndex:node is must child of this object.");return pf.splice(pg,1),pf.splice(pq,0,ph),this.conchModel&&(this.conchModel.removeChild(ph.conchModel),this.conchModel.addChildAt(ph.conchModel,pq)),this._childChanged(),ph},pq._childChanged=function(ph){},pq.removeChild=function(ph){if(!this._childs)return ph;var pq=this._childs.indexOf(ph);return this.removeChildAt(pq)},pq.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},pq.removeChildByName=function(ph){var pq=this.getChildByName(ph);return pq&&this.removeChild(pq),pq},pq.removeChildAt=function(ph){var pq=this.getChildAt(ph);if(pq){for(var pf=this._childs.length-1,pg=ph;pg<pf;++pg)this._childs[pg]=this._childs[pg+1];this._childs.length=pf,this.conchModel&&this.conchModel.removeChild(pq.conchModel),pq.parent=null}return pq},pq.removeChildren=function(ph,pq){if(void 0===ph&&(ph=0),void 0===pq&&(pq=2147483647),this._childs&&0<this._childs.length){var pf=this._childs;if(0===ph&&pP<=pq){var pg=pf;this._childs=pS.ARRAY_EMPTY}else pg=pf.splice(ph,pq-ph);for(var p$=0,pP=pg.length;p$<pP;p$++)pg[p$].parent=null,this.conchModel&&this.conchModel.removeChild(pg[p$].conchModel)}return this},pq.replaceChild=function(ph,pq){var pf=this._childs.indexOf(pq);return-1<pf?(this._childs.splice(pf,1,ph),this.conchModel&&(this.conchModel.removeChild(pq.conchModel),this.conchModel.addChildAt(ph.conchModel,pf)),pq.parent=null,ph.parent=this,ph):null},pq._updateDisplayedInstage=function(){var ph;ph=this;var pq=pt.stage;for(this._displayedInStage=!1;ph;){if(ph._getBit(1)){this._displayedInStage=ph._displayedInStage;break}if(ph==pq||ph._displayedInStage){this._displayedInStage=!0;break}ph=ph.parent}},pq._setDisplay=function(ph){this._displayedInStage!==ph&&((this._displayedInStage=ph)?this.event("display"):this.event("undisplay"))},pq._displayChild=function(ph,pq){var pf=ph._childs;if(pf)for(var pg=0;pg<pf.length;pg++){var p$=pf[pg];p$&&p$._getBit(1)&&(0<p$._childs.length?this._displayChild(p$,pq):p$._setDisplay(pq))}ph._setDisplay(pq)},pq.contains=function(ph){if(ph===this)return!0;for(;ph;){if(ph.parent===this)return!0;ph=ph.parent}return!1},pq.timerLoop=function(ph,pq,pf,pg,p$,pP){void 0===p$&&(p$=!0),void 0===pP&&(pP=!1),this.timer.loop(ph,pq,pf,pg,p$,pP)},pq.timerOnce=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=!0),this.timer._create(!1,!1,ph,pq,pf,pg,p$)},pq.frameLoop=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=!0),this.timer._create(!0,!0,ph,pq,pf,pg,p$)},pq.frameOnce=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=!0),this.timer._create(!0,!1,ph,pq,pf,pg,p$)},pq.clearTimer=function(ph,pq){this.timer.clear(ph,pq)},pC(0,pq,"numChildren",function(){return this._childs.length}),pC(0,pq,"destroyed",function(){return this._destroyed}),pC(0,pq,"parent",function(){return this._parent},function(ph){this._parent!==ph&&(ph?(this._parent=ph,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),ph.displayedInStage&&this._displayChild(this,!0)),ph._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=ph))}),pC(0,pq,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),pS.ARRAY_EMPTY=[],pS.PROP_EMPTY={},pS.NOTICE_DISPLAY=1,pS.MOUSEENABLE=2,pS}(),pqh=function(ph){function pu(ph){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,pu.__super.call(this),this._padding=pu._PADDING,this._spacing=pu._SPACING,this._aligns=pu._ALIGNS,this._font=pv.EMPTY,this._ower=ph}pe(pu,"laya.display.css.CSSStyle",ph);var pq=pu.prototype;return pq.destroy=function(){this._ower=null,this._font=null,this._rect=null},pq.inherit=function(ph){this._font=ph._font,this._spacing=ph._spacing===pu._SPACING?pu._SPACING:ph._spacing.slice(),this.lineHeight=ph.lineHeight},pq._widthAuto=function(){return 0!=(262144&this._type)},pq.widthed=function(ph){return 0!=(8&this._type)},pq._calculation=function(ph,pq){if(pq.indexOf("%")<0)return!1;var pg=this._ower,p$=pg.parent,pP=this._rect;function pS(ph,pq,pf){return ph*pf[0]+pq*pf[1]+pf[2]}function pf(ph){var pq=p$.width,pf=pg.width;pP.width&&(pg.width=pS(pq,pf,pP.width)),pP.height&&(pg.height=pS(pq,pf,pP.height)),pP.left&&(pg.x=pS(pq,pf,pP.left)),pP.top&&(pg.y=pS(pq,pf,pP.top))}null===pP&&(p$._getCSSStyle()._type|=524288,p$.on("resize",this,pf),this._rect=pP={input:{}});var pB=pq.split(" ");return pB[0]=parseFloat(pB[0])/100,1==pB.length?pB[1]=pB[2]=0:(pB[1]=parseFloat(pB[1])/100,pB[2]=parseFloat(pB[2])),pP[ph]=pB,pP.input[ph]=pq,pf(),!0},pq.heighted=function(ph){return 0!=(8192&this._type)},pq.size=function(ph,pq){var pf=this._ower,pg=!1;-1!==ph&&ph!=this._ower.width&&(this._type|=8,this._ower.width=ph,pg=!0),-1!==pq&&pq!=this._ower.height&&(this._type|=8192,this._ower.height=pq,pg=!0),pg&&(pf._layoutLater(),524288&this._type&&pf.event("resize",this))},pq._getAlign=function(){return this._aligns[0]},pq._getValign=function(){return this._aligns[1]},pq._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},pq._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new pv(this._font))},pq.render=function(ph,pq,pf,pg){var p$=ph.width,pP=ph.height;pf-=ph.pivotX,pg-=ph.pivotY,this._bgground&&null!=this._bgground.color&&pq.ctx.fillRect(pf,pg,p$,pP,this._bgground.color),this._border&&this._border.color&&pq.drawRect(pf,pg,p$,pP,this._border.color.strColor,this._border.size)},pq.getCSSStyle=function(){return this},pq.cssText=function(ph){this.attrs(pu.parseOneCSS(ph,";"))},pq.attrs=function(ph){if(ph)for(var pq=0,pf=ph.length;pq<pf;pq++){var pg=ph[pq];this[pg[0]]=pg[1]}},pq.setTransform=function(ph){"none"===ph?this._tf=pB._TF_EMPTY:this.attrs(pu.parseOneCSS(ph,","))},pq.translate=function(ph,pq){this._tf===pB._TF_EMPTY&&(this._tf=new p$),this._tf.translateX=ph,this._tf.translateY=pq},pq.scale=function(ph,pq){this._tf===pB._TF_EMPTY&&(this._tf=new p$),this._tf.scaleX=ph,this._tf.scaleY=pq},pq._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},pC(0,pq,"block",ph.prototype._$get_block,function(ph){ph?this._type|=1:this._type&=-2}),pC(0,pq,"valign",function(){return pu._valigndef[this._aligns[1]]},function(ph){this._aligns===pu._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=pu._valigndef[ph]}),pC(0,pq,"height",null,function(ph){if(this._type|=8192,"string"==typeof ph){if(this._calculation("height",ph))return;ph=parseInt(ph)}this.size(-1,ph)}),pC(0,pq,"width",null,function(ph){if(this._type|=8,"string"==typeof ph){var pq=ph.indexOf("auto");if(0<=pq&&(this._type|=262144,ph=ph.substr(0,pq)),this._calculation("width",ph))return;ph=parseInt(ph)}this.size(ph,-1)}),pC(0,pq,"fontWeight",function(){return this._font.weight},function(ph){this._createFont().weight=ph}),pC(0,pq,"left",null,function(ph){var pq=this._ower;if("string"==typeof ph){if("center"===ph?ph="50% -50% 0":"right"===ph&&(ph="100% -100% 0"),this._calculation("left",ph))return;ph=parseInt(ph)}pq.x=ph}),pC(0,pq,"_translate",null,function(ph){this.translate(ph[0],ph[1])}),pC(0,pq,"absolute",function(){return 0!=(4&this._type)}),pC(0,pq,"top",null,function(ph){var pq=this._ower;if("string"==typeof ph){if("middle"===ph?ph="50% -50% 0":"bottom"===ph&&(ph="100% -100% 0"),this._calculation("top",ph))return;ph=parseInt(ph)}pq.y=ph}),pC(0,pq,"align",function(){return pu._aligndef[this._aligns[0]]},function(ph){this._aligns===pu._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=pu._aligndef[ph]}),pC(0,pq,"bold",function(){return this._font.bold},function(ph){this._createFont().bold=ph}),pC(0,pq,"padding",function(){return this._padding},function(ph){this._padding=ph}),pC(0,pq,"leading",function(){return this._spacing[1]},function(ph){"string"==typeof ph&&(ph=parseInt(ph+"")),this._spacing===pu._SPACING&&(this._spacing=[0,0]),this._spacing[1]=ph}),pC(0,pq,"lineElement",function(){return 0!=(65536&this._type)},function(ph){ph?this._type|=65536:this._type&=-65537}),pC(0,pq,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(ph){this.lineElement=!1,"right"===ph?this._type|=32768:this._type&=-32769}),pC(0,pq,"textDecoration",function(){return this._font.decoration},function(ph){this._createFont().decoration=ph}),pC(0,pq,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(ph){"nowrap"===ph&&(this._type|=131072),"none"===ph&&(this._type&=-131073)}),pC(0,pq,"background",null,function(ph){ph?(this._bgground||(this._bgground={}),this._bgground.color=ph,this._ower.conchModel&&this._ower.conchModel.bgColor(ph),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),pC(0,pq,"wordWrap",function(){return 0==(131072&this._type)},function(ph){ph?this._type&=-131073:this._type|=131072}),pC(0,pq,"color",function(){return this._font.color},function(ph){this._createFont().color=ph}),pC(0,pq,"password",function(){return this._font.password},function(ph){this._createFont().password=ph}),pC(0,pq,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(ph){"none"===ph?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=ph),this._ower.conchModel&&this._ower.conchModel.bgColor(ph),this._ower._renderType|=256}),pC(0,pq,"font",function(){return this._font.toString()},function(ph){this._createFont().set(ph)}),pC(0,pq,"weight",null,function(ph){this._createFont().weight=ph}),pC(0,pq,"letterSpacing",function(){return this._spacing[0]},function(ph){"string"==typeof ph&&(ph=parseInt(ph+"")),this._spacing===pu._SPACING&&(this._spacing=[0,0]),this._spacing[0]=ph}),pC(0,pq,"fontSize",function(){return this._font.size},function(ph){this._createFont().size=ph}),pC(0,pq,"italic",function(){return this._font.italic},function(ph){this._createFont().italic=ph}),pC(0,pq,"fontFamily",function(){return this._font.family},function(ph){this._createFont().family=ph}),pC(0,pq,"stroke",function(){return this._font.stroke[0]},function(ph){this._createFont().stroke===pv._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=ph}),pC(0,pq,"strokeColor",function(){return this._font.stroke[1]},function(ph){this._createFont().stroke===pv._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=ph}),pC(0,pq,"border",function(){return this._border?this._border.value:""},function(ph){if("none"!=ph){this._border||(this._border={});var pq=(this._border.value=ph).split(" ");if(this._border.color=ps.create(pq[pq.length-1]),1==pq.length)return this._border.size=1,void(this._border.type="solid");var pf=0;0<pq[0].indexOf("px")?(this._border.size=parseInt(pq[0]),pf++):this._border.size=1,this._border.type=pq[pf],this._ower._renderType|=256}else this._border=null}),pC(0,pq,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(ph){ph?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==ph?null:ps.create(ph),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),pC(0,pq,"position",function(){return 4&this._type?"absolute":""},function(ph){"absolute"==ph?this._type|=4:this._type&=-5}),pC(0,pq,"display",null,function(ph){switch(ph){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),pC(0,pq,"paddingLeft",function(){return this.padding[3]}),pC(0,pq,"paddingTop",function(){return this.padding[0]}),pC(0,pq,"_scale",null,function(ph){this._ower.scale(ph[0],ph[1])}),pC(0,pq,"_rotate",null,function(ph){this._ower.rotation=ph}),pu.parseOneCSS=function(ph,pq){for(var pf,pg=[],p$=ph.split(pq),pP=0,pS=p$.length;pP<pS;pP++){var pB=p$[pP],pr=pB.indexOf(":"),pY=pB.substr(0,pr).replace(/^\s+|\s+$/g,"");if(0!=pY.length){var pC=pB.substr(pr+1).replace(/^\s+|\s+$/g,""),pU=[pY,pC];switch(pY){case"italic":case"bold":pU[1]="true"==pC;break;case"line-height":pU[0]="lineHeight",pU[1]=parseInt(pC);break;case"font-size":pU[0]="fontSize",pU[1]=parseInt(pC);break;case"padding":1<(pf=pC.split(" ")).length||(pf[1]=pf[2]=pf[3]=pf[0]),pU[1]=[parseInt(pf[0]),parseInt(pf[1]),parseInt(pf[2]),parseInt(pf[3])];break;case"rotate":pU[0]="_rotate",pU[1]=parseFloat(pC);break;case"scale":pf=pC.split(" "),pU[0]="_scale",pU[1]=[parseFloat(pf[0]),parseFloat(pf[1])];break;case"translate":pf=pC.split(" "),pU[0]="_translate",pU[1]=[parseInt(pf[0]),parseInt(pf[1])];break;default:(pU[0]=pu._CSSTOVALUE[pY])||(pU[0]=pY)}pg.push(pU)}}return pg},pu.parseCSS=function(ph,pq){for(var pf;null!=(pf=pu._parseCSSRegExp.exec(ph));)pu.styleSheets[pf[1]]=pu.parseOneCSS(pf[2],";")},pu.EMPTY=new pu(null),pu._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},pu._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),pu._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},pu._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},pu.styleSheets={},pu.ALIGN_CENTER=1,pu.ALIGN_RIGHT=2,pu.VALIGN_MIDDLE=1,pu.VALIGN_BOTTOM=2,pu._CSS_BLOCK=1,pu._DISPLAY_NONE=2,pu._ABSOLUTE=4,pu._WIDTH_SET=8,pu._PADDING=[0,0,0,0],pu._RECT=[-1,-1,-1,-1],pu._SPACING=[0,0],pu._ALIGNS=[0,0,0],pu.ADDLAYOUTED=512,pu._NEWFONT=4096,pu._HEIGHT_SET=8192,pu._BACKGROUND_SET=16384,pu._FLOAT_RIGHT=32768,pu._LINE_ELEMENT=65536,pu._NOWARP=131072,pu._WIDTHAUTO=262144,pu._LISTERRESZIE=524288,pu}(pB),pfh=function(ph){function pS(){this.url=null,this.audio=null,this.loaded=!1,pS.__super.call(this)}pe(pS,"laya.media.h5audio.AudioSound",pY);var pq=pS.prototype;return pq.dispose=function(){var ph=pS._audioCache[this.url];ph&&(ph.src="",delete pS._audioCache[this.url])},pq.load=function(ph){var pq;if(ph=pz.formatURL(ph),(this.url=ph)==pA._tMusic?(pS._initMusicAudio(),(pq=pS._musicAudio).src!=ph&&(pS._audioCache[pq.src]=null,pq=null)):pq=pS._audioCache[ph],pq&&2<=pq.readyState)this.event("complete");else{pq||(pq=ph==pA._tMusic?(pS._initMusicAudio(),pS._musicAudio):pw.createElement("audio"),(pS._audioCache[ph]=pq).src=ph),pq.addEventListener("canplaythrough",pg),pq.addEventListener("error",p$);var pf=this;(this.audio=pq).load?pq.load():p$()}function pg(){pP(),pf.loaded=!0,pf.event("complete")}function p$(){pq.load=null,pP(),pf.event("error")}function pP(){pq.removeEventListener("canplaythrough",pg),pq.removeEventListener("error",p$)}},pq.play=function(ph,pq,pf){if(void 0===ph&&(ph=0),void 0===pq&&(pq=0),!this.url)return null;var pg,p$;if(!(pg=this.url==pA._tMusic?pS._musicAudio:pS._audioCache[this.url]))return null;p$=pF.getItem("audio:"+this.url),pc.isConchApp?p$||((p$=pw.createElement("audio")).src=this.url):this.url==pA._tMusic?(pS._initMusicAudio(),(p$=pS._musicAudio).src=this.url):p$=p$||pg.cloneNode(!0);var pP=new puh(p$);return pP.url=this.url,pP.loops=pq,pP.startTime=ph,pP.startHandler=pf,pP.play(!1),pA.addChannel(pP),pP},pC(0,pq,"duration",function(){var ph;return(ph=pS._audioCache[this.url])?ph.duration:0}),pS._initMusicAudio=function(){pS._musicAudio||(pS._musicAudio||(pS._musicAudio=pw.createElement("audio")),pc.isConchApp||pw.document.addEventListener("mousedown",pS._makeMusicOK))},pS._makeMusicOK=function(){pw.document.removeEventListener("mousedown",pS._makeMusicOK),pS._musicAudio.src?pS._musicAudio.play():(pS._musicAudio.src="",pS._musicAudio.load())},pS._audioCache={},pS._musicAudio=null,pS}(),pgh=function(ph){function pq(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,pq.__super.call(this)}pe(pq,"laya.media.SoundChannel",pY);var pf=pq.prototype;return pf.play=function(){},pf.stop=function(){},pf.pause=function(){},pf.resume=function(){},pf.__runComplete=function(ph){ph&&ph.run()},pC(0,pf,"volume",function(){return 1},function(ph){}),pC(0,pf,"position",function(){return 0}),pC(0,pf,"duration",function(){return 0}),pq}(),p$h=function(ph){function pq(){pq.__super.call(this)}pe(pq,"laya.media.Sound",pY);var pf=pq.prototype;return pf.load=function(ph){},pf.play=function(ph,pq,pf){return void 0===ph&&(ph=0),void 0===pq&&(pq=0),null},pf.dispose=function(){},pC(0,pf,"duration",function(){return 0}),pq}(),pPh=function(ph){function p$(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,p$.__super.call(this)}pe(p$,"laya.media.webaudio.WebAudioSound",pY);var pq=p$.prototype;return pq.load=function(ph){this.url=ph,this.audioBuffer=p$._dataCache[ph],this.audioBuffer?this._loaded(this.audioBuffer):(p$.e.on("loaded:"+ph,this,this._loaded),p$.e.on("err:"+ph,this,this._err),p$.__loadingSound[ph]||(p$.__loadingSound[ph]=!0,pt.loader.load(ph,pN.create(this,this.onloaded),null,pBh.BUFFER,4,!1,null,!0)))},pq.onloaded=function(ph){ph||this._err(),this._disposed?this._removeLoadEvents():(this.data=ph,p$.buffs.push({buffer:this.data,url:this.url}),p$.decode())},pq._err=function(){if(this._removeLoadEvents(),p$.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var ph,pq,pf,pg=0;for(ph=(pq=this.__toPlays).length,pg=0;pg<ph;pg++)(pf=pq[pg])[3]&&!pf[3].isStopped&&pf[3].event("error");this.__toPlays.length=0}},pq._loaded=function(ph){this._removeLoadEvents(),this._disposed||(this.audioBuffer=ph,this.loaded=!0,this.event("complete"))},pq._removeLoadEvents=function(){p$.e.off("loaded:"+this.url,this,this._loaded),p$.e.off("err:"+this.url,this,this._err)},pq.__playAfterLoaded=function(){if(this.__toPlays){var ph,pq,pf,pg=0;for(ph=(pq=this.__toPlays).length,pg=0;pg<ph;pg++)(pf=pq[pg])[3]&&!pf[3].isStopped&&this.play(pf[0],pf[1],pf[2],pf[3]);this.__toPlays.length=0}},pq.play=function(ph,pq,pf,pg){return void 0===ph&&(ph=0),void 0===pq&&(pq=0),pg=pg||new pvh,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([ph,pq,pf,pg]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),pg.url=this.url,pg.loops=pq,pg.audioBuffer=this.audioBuffer,pg.startTime=ph,pg.startHandler=pf,pg.play(!1),pA.addChannel(pg),pg},pq.dispose=function(){this._disposed=!0,delete p$._dataCache[this.url],delete p$.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},pC(0,pq,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),p$.decode=function(){if(!(p$.buffs.length<=0||p$.isDecoding))if(p$.isDecoding=!0,(p$.tInfo=p$.buffs.shift())&&p$.tInfo.buffer&&p$.tInfo.buffer.byteLength)try{p$.ctx.decodeAudioData(p$.tInfo.buffer,p$._done,p$._fail)}catch(ph){console.error("decodeAudioData error  byteLength:"+p$.tInfo.buffer.byteLength+"  url:"+p$.tInfo.url)}else p$._fail()},p$._done=function(ph){p$.e.event("loaded:"+p$.tInfo.url,ph),p$._dataCache[p$.tInfo.url]=ph,p$.isDecoding=!1,p$.decode()},p$._fail=function(){p$.e.event("err:"+p$.tInfo.url,null),p$.isDecoding=!1,p$.decode()},p$._playEmptySound=function(){if(null!=p$.ctx){if(p$._emptySource&&(p$._emptySource.stop(),p$._emptySource.disconnect(0),!pvh._tryCleanFailed))try{p$._emptySource.buffer=null}catch(ph){pvh._tryCleanFailed=!0}var ph=p$.ctx.createBufferSource();ph.buffer=p$._miniBuffer,ph.connect(p$.ctx.destination),ph.start(0,0,0),p$._emptySource=ph}},p$._unlock=function(){p$._unlocked||(p$._playEmptySound(),"running"==p$.ctx.state?(pw.document.removeEventListener("mousedown",p$._unlock,!0),pw.document.removeEventListener("touchend",p$._unlock,!0),pw.document.removeEventListener("touchstart",p$._unlock,!0),p$._unlocked=!0):"suspended"==p$.ctx.state&&pA._recoverWebAudio())},p$.initWebAudio=function(){"running"!=p$.ctx.state&&(p$._unlock(),pw.document.addEventListener("mousedown",p$._unlock,!0),pw.document.addEventListener("touchend",p$._unlock,!0),pw.document.addEventListener("touchstart",p$._unlock,!0))},p$._emptySource=null,p$._dataCache={},p$.buffs=[],p$.isDecoding=!1,p$._unlocked=!1,p$.tInfo=null,p$.__loadingSound={},pr(p$,["window",function(){return this.window=pw.window},"webAudioEnabled",function(){return this.webAudioEnabled=p$.window.AudioContext||p$.window.webkitAudioContext||p$.window.mozAudioContext},"ctx",function(){return this.ctx=p$.webAudioEnabled?new(p$.window.AudioContext||p$.window.webkitAudioContext||p$.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=p$.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new pY}]),p$}(),pSh=function(ph){function pq(){this._responseType=null,this._data=null,pq.__super.call(this),this._http=new pw.window.XMLHttpRequest}pe(pq,"laya.net.HttpRequest",pY);var pf=pq.prototype;return pf.send=function(ph,pq,pf,pg,p$){void 0===pf&&(pf="get"),void 0===pg&&(pg="text"),this._responseType=pg,this._data=null;var pP=this,pS=this._http;if(pS.open(pf,ph,!0),p$)for(var pB=0;pB<p$.length;pB++)pS.setRequestHeader(p$[pB++],p$[pB]);else pc.isConchApp||(pq&&"string"!=typeof pq?pS.setRequestHeader("Content-Type","application/json"):pS.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));pS.responseType="arraybuffer"!==pg?"text":"arraybuffer",pS.onerror=function(ph){pP._onError(ph)},pS.onabort=function(ph){pP._onAbort(ph)},pS.onprogress=function(ph){pP._onProgress(ph)},pS.onload=function(ph){pP._onLoad(ph)},pS.send(pq)},pf._onProgress=function(ph){ph&&ph.lengthComputable&&this.event("progress",ph.loaded/ph.total)},pf._onAbort=function(ph){this.error("Request was aborted by user")},pf._onError=function(ph){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},pf._onLoad=function(ph){var pq=this._http,pf=void 0!==pq.status?pq.status:200;200===pf||204===pf||0===pf?this.complete():this.error("["+pq.status+"]"+pq.statusText+":"+pq.responseURL)},pf.error=function(ph){this.clear(),this.event("error",ph)},pf.complete=function(){this.clear();var pq=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=pO.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(ph){pq=!1,this.error(ph.message)}pq&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},pf.clear=function(){var ph=this._http;ph.onerror=ph.onabort=ph.onprogress=ph.onload=null},pC(0,pf,"url",function(){return this._http.responseURL}),pC(0,pf,"http",function(){return this._http}),pC(0,pf,"data",function(){return this._data}),pq}(),pBh=function(ph){function pJ(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,pJ.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}pe(pJ,"laya.net.Loader",pY);var pq=pJ.prototype;return pq.load=function(ph,pq,pf,pg,p$){if(ph&&""!=ph||console.error("Loader 加载的url不合法 "+ph),void 0===pf&&(pf=!0),void 0===p$&&(p$=!1),0===(this._url=ph).indexOf("data:image")?this._type=pq="image":this._type=pq||(pq=this.getTypeFromUrl(ph)),this._cache=pf,this._data=null,!p$&&pJ.loadedMap[ph])return this._data=pJ.loadedMap[ph],this.event("progress",1),void this.event("complete",this._data);if(pg&&pJ.setGroup(ph,pg),null!=pJ.parserMap[pq])return this._customParse=!0,void(pJ.parserMap[pq]instanceof laya.utils.Handler?pJ.parserMap[pq].runWith(this):pJ.parserMap[pq].call(null,this));if("image"===pq||"htmlimage"===pq||"nativeimage"===pq)return this._loadImage(ph);if("ttf"===pq)return this._loadTTF(ph);switch(pq){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:pq}pJ.preLoadedMap[ph]?this.onLoaded(pJ.preLoadedMap[ph]):pS.resMgrLoad(ph,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},pq.getTypeFromUrl=function(ph){var pq=pO.getFileExtension(ph);return pq?pJ.typeMap[pq]:(console.warn("Not recognize the resources suffix",ph),"text")},pq._loadTTF=function(ph){ph=pz.formatURL(ph);var pq=new pi;pq.complete=pN.create(this,this.onLoaded),pq.load(ph)},pq._loadImage=function(ph){pS.imgMgrLoad(ph,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},pq._loadImageComplete=function(ph,pq,pf){if(null!=pf)if(pf instanceof ArrayBuffer){var pg=new DataView(pf),p$=new laya.webgl.resource.WebGLImage(new Uint8Array(pf,8),ph,0,!1,pg.getUint32(0),pg.getUint32(4));this.onLoaded(p$)}else if(pf instanceof pCh)pJ.imgMgrSet[ph]=pq,pS.imgMgrLock(ph,pJ.imgMgrSet[ph]),this._url=ph,this.complete(pf);else{var pP=-1!=ph.indexOf(".png",ph.length-4)?6408:6407;p$=new laya.webgl.resource.WebGLImage(pf,ph,pP,!1,pf.width,pf.height);this.onLoaded(p$)}else this.event("error","Load image failed")},pq._loadSound=function(ph){var pq=new pA._soundClass,pf=this;function pg(){pq.offAll()}pq.on("complete",this,function(){pg(),pf.onLoaded(pq)}),pq.on("error",this,function(){pg(),pq.dispose(),pf.event("error","Load sound failed")}),pq.load(ph)},pq.onProgress=function(ph){"atlas"===this._type?this.event("progress",.3*ph):this.event("progress",ph)},pq.onError=function(ph){this.event("error",ph)},pq._loadedComplete=function(ph,pq,pf){if(null!=pf)switch(this._type){case"atlas":case"plf":case"json":var pg=new pk(pf);this.onLoaded(JSON.parse(pg.readUTFBytes()));break;case"font":pg=new pk(pf);this.onLoaded(pO.parseXMLFromString(pg.readUTFBytes()));break;default:this.onLoaded(pf)}else this.event("error",ph)},pq.onLoaded=function(ph){var pq=this._type;if("plf"==pq)this.parsePLFData(ph),this.complete(ph);else if("image"===pq){var pf=new pCh(ph);pf.url=this._url,this.complete(pf)}else if("sound"===pq||"htmlimage"===pq||"nativeimage"===pq)this.complete(ph);else if("atlas"===pq){if(!ph.src&&!ph._setContext){if(!this._data){if((this._data=ph).meta&&ph.meta.image)for(var pg=ph.meta.image.split(","),p$=0<=this._url.indexOf("/")?"/":"\\",pP=this._url.lastIndexOf(p$),pS=0<=pP?this._url.substr(0,pP+1):"",pB=0,pr=pg.length;pB<pr;pB++)pg[pB]=pS+pg[pB];else pg=[this._url.replace(".json",".png")];pg.reverse(),ph.toLoads=pg,ph.pics=[]}return this.event("progress",.3+1/pg.length*.6),this._loadImage(pg.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(ph),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var pY=this._data.frames,pC=this._url.split("?")[0],pU=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:pC.substring(0,pC.lastIndexOf("."))+"/",pu=this._data.pics,pv=pz.formatURL(this._url),pL=pJ.atlasMap[pv]||(pJ.atlasMap[pv]=[]);pL.dir=pU;var pe=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var pl in pe=parseFloat(this._data.meta.scale),pY){var p_,pN=pY[pl],pG=pu[pN.frame.idx?pN.frame.idx:0],pm=pz.formatURL(pU+pl);pG.scaleRate=pe,p_=pCh.create(pG,pN.frame.x,pN.frame.y,pN.frame.w,pN.frame.h,pN.spriteSourceSize.x,pN.spriteSourceSize.y,pN.sourceSize.w,pN.sourceSize.h),pJ.cacheRes(pm,p_),pJ.keepCache(this._url,pU+pl),p_.url=pm,pL.push(pm)}else for(pl in pY)pG=pu[(pN=pY[pl]).frame.idx?pN.frame.idx:0],pm=pz.formatURL(pU+pl),pJ.cacheRes(pm,pCh.create(pG,pN.frame.x,pN.frame.y,pN.frame.w,pN.frame.h,pN.spriteSourceSize.x,pN.spriteSourceSize.y,pN.sourceSize.w,pN.sourceSize.h)),pJ.loadedMap[pm].url=pm,pJ.keepCache(this._url,pU+pl),pL.push(pm);delete this._data.pics,this.complete(this._data)}else if("font"==pq){if(!ph.src)return this._data=ph,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var pE=new pp;pE.parseFont(this._data,ph);var pR=this._url.split(".fnt")[0].split("/"),pt=pR[pR.length-1];plh.registerBitmapFont(pt,pE),this._data=pE,this.complete(this._data)}else if("pkm"==pq){var pX=pRh.create(ph,this._url),pn=new pCh(pX);pn.url=this._url,this.complete(pn)}else this.complete(ph)},pq.parsePLFData=function(ph){var pq,pf,pg;for(pq in ph)switch(pg=ph[pq],pq){case"json":case"text":for(pf in pg)pJ.preLoadedMap[pz.formatURL(pf)]=pg[pf];break;default:for(pf in pg)pJ.preLoadedMap[pz.formatURL(pf)]=pg[pf]}},pq.complete=function(ph){this._data=ph,this._customParse?this.event("loaded",ph instanceof Array?[ph]:ph):(pJ._loaders.push(this),pJ._isWorking||pJ.checkNext())},pq.endLoad=function(ph){ph&&(this._data=ph),this._cache&&pJ.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},pC(0,pq,"url",function(){return this._url}),pC(0,pq,"data",function(){return this._data}),pC(0,pq,"cache",function(){return this._cache}),pC(0,pq,"type",function(){return this._type}),pJ.checkNext=function(){pJ._isWorking=!0;for(var ph=pw.now();pJ._startIndex<pJ._loaders.length;)if(pw.now(),pJ._loaders[pJ._startIndex].endLoad(),pJ._startIndex++,pw.now()-ph>pJ.maxTimeOut)return console.warn("loader callback cost a long time:"+(pw.now()-ph)+" url="+pJ._loaders[pJ._startIndex-1].url),void pt.timer.frameOnce(1,null,pJ.checkNext);pJ._loaders.length=0,pJ._startIndex=0,pJ._isWorking=!1},pJ.clearRes=function(ph,pq){if(null!=ph){void 0===pq&&(pq=!1),ph=pz.formatURL(ph);var pf=pJ.getAtlas(ph);if(pf){for(var pg=0,p$=pf.length;pg<p$;pg++){var pP=pf[pg],pS=pJ.getRes(pP);delete pJ.loadedMap[pP],pJ.clearCache(ph.substring(pz.basePath.length),pP.substring(pz.basePath.length)),pS&&pS.destroy(pq)}pf.length=0,delete pJ.atlasMap[ph],delete pJ.loadedMap[ph]}else{var pB=pJ.loadedMap[ph];pB&&(delete pJ.loadedMap[ph],pB instanceof laya.resource.Texture&&pB.bitmap&&pB.destroy(pq))}}},pJ.clearTextureRes=function(ph){ph=pz.formatURL(ph);var pq=laya.net.Loader.getAtlas(ph),pf=pq&&0<pq.length?laya.net.Loader.getRes(pq[0]):laya.net.Loader.getRes(ph);pf&&pf.bitmap&&(pc.isConchApp&&!pc.isConchWebGL?pf.bitmap.source.releaseTexture&&pf.bitmap.source.releaseTexture():null==pf.bitmap._atlaser&&pf.bitmap.releaseResource(!0))},pJ.getRes=function(ph){return pJ.loadedMap[pz.formatURL(ph)]},pJ.getAtlas=function(ph){return pJ.atlasMap[pz.formatURL(ph)]},pJ.cacheRes=function(ph,pq){ph=pz.formatURL(ph),null!=pJ.loadedMap[ph]?console.warn("Resources already exist,is repeated loading:",ph):pJ.loadedMap[ph]=pq},pJ.setGroup=function(ph,pq){pJ.groupMap[pq]||(pJ.groupMap[pq]=[]),pJ.groupMap[pq].push(ph)},pJ.clearResByGroup=function(ph){if(pJ.groupMap[ph]){var pq=pJ.groupMap[ph],pf=0,pg=pq.length;for(pf=0;pf<pg;pf++)pJ.clearRes(pq[pf]);pq.length=0}},pJ.keepCache=function(ph,pq){if(ph&&pq){var pf=pJ.cacheSet[pq];pf?-1==pf.indexOf(ph)&&pf.push(ph):pJ.cacheSet[pq]=[ph]}},pJ.clearCache=function(ph,pq){if(ph&&pq){var pf=pJ.cacheSet[pq];if(pf){var pg=pf.indexOf(ph);if(-1!==pg){var p$=pf.length-1;0==p$?(delete pJ.cacheSet[pq],0<pJ.imgMgrSet[pq]?pS.imgMgrFree(pq,pJ.imgMgrSet[pq]):pJ.clearRes(pq,!0)):(pf[pg]=pf[p$],pf.length=p$)}}}},pJ.saveObject=function(ph,pq,pf){if(pq&&ph){var pg=pJ.objectSet[ph];pg?(console.warn("Loader.saveObject: "+ph),pg[0]=pq,pg[1]=pf):pJ.objectSet[ph]=[pq,pf,[]]}},pJ.findObject=function(ph){if(ph){var pq=pJ.objectSet[ph];if(pq)return pq[0]}return null},pJ.keepObject=function(ph,pq){if(ph&&pq){var pf=pJ.objectSet[pq];pf&&-1===pf[2].indexOf(ph)&&pf[2].push(ph)}},pJ.clearObject=function(ph,pq){if(ph&&pq){var pf=pJ.objectSet[pq];if(pf){var pg=pf[2],p$=pg.indexOf(ph);if(-1!==p$){var pP=pg.length-1;0==pP?(delete pJ.objectSet[pq],pf[1]&&pf[1].call(null,pf[0])):(pg[p$]=pg[pP],pg.length=pP)}}}},pJ.TEXT="text",pJ.JSON="json",pJ.XML="xml",pJ.BUFFER="arraybuffer",pJ.IMAGE="image",pJ.SOUND="sound",pJ.ATLAS="atlas",pJ.FONT="font",pJ.TTF="ttf",pJ.PLF="plf",pJ.PKM="pkm",pJ.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},pJ.parserMap={},pJ.groupMap={},pJ.maxTimeOut=100,pJ.loadedMap={},pJ.preLoadedMap={},pJ.atlasMap={},pJ._loaders=[],pJ._isWorking=!1,pJ._startIndex=0,pJ.imgCache={},pJ.cacheSet={},pJ.objectSet={},pJ.imgMgrSet={},pJ}(),prh=function(ph){var pu;function pv(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},pv.__super.call(this);for(var ph=0;ph<this._maxPriority;ph++)this._resInfos[ph]=[]}pe(pv,"laya.net.LoaderManager",pY);var pq=pv.prototype;return pq.create=function(ph,pf,pq,pg,p$,pP,pS,pB){if(null==pP&&(pP=2),null==pS&&(pS=!0),ph instanceof Array){var pr=ph,pY=pr.length,pC=0;if(pq)var pU=pN.create(pq.caller,pq.method,pq.args,!1);for(var pu=0;pu<pY;pu++){var pv=pr[pu];"string"==typeof pv&&(pv=pr[pu]={url:pv}),pv.progress=0}for(pu=0;pu<pY;pu++){pv=pr[pu];var pL=pq?pN.create(null,p_,[pv],!1):null,pe=pq||pf?pN.create(null,pl,[pv]):null;this._create(pv.url,pe,pL,pv.clas||pg,pv.params||p$,null!=pv.priority&&0<=pv.priority?pv.priority:pP,pS,pv.group||pB)}function pl(ph,pq){pC++,ph.progress=1,pC===pY&&pf&&pf.run()}function p_(ph,pq){ph.progress=pq;for(var pf=0,pg=0;pg<pY;pg++){pf+=pr[pg].progress}var p$=pf/pY;pU.runWith(p$)}return!0}return this._create(ph,pf,pq,pg,p$,pP,pS,pB)},pq._create=function(pq,pf,ph,pg,p$,pP,pS,pB){pq&&""!=pq||console.error("加载的url不合法 "+pq),null==pP&&(pP=2),null==pS&&(pS=!0);var pr=pz.formatURL(pq),pY=this.getRes(pr);if(pY)!pY.hasOwnProperty("loaded")||pY.loaded?(ph&&ph.runWith(1),pf&&pf.run()):pf&&pt.loader._createListener(pq,pf.caller,pf.method,pf.args,!0,!1);else{var pC=pO.getFileExtension(pq),pU=pv.createMap[pC];if(!pU)throw new Error("LoaderManager:unknown file("+pq+") extension with: "+pC+".");pg||(pg=pU[0]);var pu=pU[1];if("atlas"==pC)this.load(pq,pf,ph,pu,pP,pS);else{pg===pCh&&(pu="htmlimage"),(pY=pg?new pg:null).hasOwnProperty("_loaded")&&(pY._loaded=!1),pY._setUrl(pq),pB&&pY._setGroup(pB),this._createLoad(pY,pq,pN.create(null,function(ph){pY&&!pY.destroyed&&ph&&pY.onAsynLoaded.call(pY,pq,ph,p$),pf&&pf.run();pt.loader.event(pq)}),ph,pu,pP,!1,pB,!0),pS&&this.cacheRes(pr,pY)}}return pY},pq.load=function(ph,pq,pf,pg,p$,pP,pS,pB){ph&&""!=ph||console.error("加载的url不合法 "+ph);var pr=this;if(null==p$&&(p$=2),null==pP&&(pP=!0),void 0===pB&&(pB=!1),ph instanceof Array)return this._loadAssets(ph,pq,pf,pg,p$,pP,pS);var pY=pBh.getRes(ph);if(null!=pY)pt.timer.frameOnce(1,null,function(){pf&&pf.runWith(1),pq&&pq.runWith(pY),pr._loaderCount||pr.event("complete")});else{var pC=pv._resMap[ph];pC?(pq&&pC._createListener("complete",pq.caller,pq.method,pq.args,!1,!1),pf&&pC._createListener("progress",pf.caller,pf.method,pf.args,!1,!1)):((pC=this._infoPool.length?this._infoPool.pop():new pu).url=ph,pC.type=pg,pC.cache=pP,pC.group=pS,pC.ignoreCache=pB,pC.priority=p$,pq&&pC.on("complete",pq.caller,pq.method,pq.args),pf&&pC.on("progress",pf.caller,pf.method,pf.args),pv._resMap[ph]=pC,p$=p$<this._maxPriority?0<=p$?p$:0:this._maxPriority-1,this._resInfos[p$].push(pC),this._next())}return this},pq._createLoad=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){var pY=this;if(null==pP&&(pP=2),null==pS&&(pS=!0),void 0===pr&&(pr=!1),pq instanceof Array)return this._loadAssets(pq,pf,pg,p$,pP,pS,pB);var pC=pBh.getRes(pq);if(null!=pC)pt.timer.frameOnce(1,null,function(){pg&&pg.runWith(1),pf&&pf.runWith(pC),pY._loaderCount||pY.event("complete")});else{var pU=pv._resMap[pq];pU?(pf&&pU._createListener("complete",pf.caller,pf.method,pf.args,!1,!1),pg&&pU._createListener("progress",pg.caller,pg.method,pg.args,!1,!1)):((pU=this._infoPool.length?this._infoPool.pop():new pu).url=pq,pU.clas=ph,pU.type=p$,pU.cache=pS,pU.group=pB,pU.ignoreCache=pr,pU.priority=pP,pf&&pU.on("complete",pf.caller,pf.method,pf.args),pg&&pU.on("progress",pg.caller,pg.method,pg.args),pv._resMap[pq]=pU,pP=pP<this._maxPriority?0<=pP?pP:0:this._maxPriority-1,this._resInfos[pP].push(pU),this._next())}return this},pq._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var ph=0;ph<this._maxPriority;ph++)for(var pq=this._resInfos[ph];0<pq.length;){var pf=pq.shift();if(pf)return this._doLoad(pf)}this._loaderCount||this.event("complete")}},pq._doLoad=function(pq){this._loaderCount++;var pf=this._loaders.length?this._loaders.pop():new pBh;pf.on("complete",null,p$),pf.on("progress",null,function(ph){pq.event("progress",ph)}),pf.on("error",null,function(ph){p$(null)});var pg=this;function p$(ph){pf.offAll(),pf._data=null,pf._customParse=!1,pg._loaders.push(pf),pg._endLoad(pq,ph instanceof Array?[ph]:ph),pg._loaderCount--,pg._next()}pf._class=pq.clas,1<=pq.priority?(pf.priority=pq.priority,pf.realTime=!1):(pf.priority=0,pf.realTime=!0),pf.load(pq.url,pq.type,pq.cache,pq.group,pq.ignoreCache)},pq._endLoad=function(ph,pq){var pf=ph.url;if(null==pq){var pg=this._failRes[pf]||0;if(pg<this.retryNum)return console.warn("[warn]Retry to load:",pf),this._failRes[pf]=pg+1,void pt.timer.once(this.retryDelay,this,this._addReTry,[ph],!1);console.warn("[error]Failed to load:",pf),this.event("error",pf)}this._failRes[pf]&&(this._failRes[pf]=0),delete pv._resMap[pf],ph.event("complete",pq),ph.offAll(),this._infoPool.push(ph)},pq._addReTry=function(ph){this._resInfos[this._maxPriority-1].push(ph),this._next()},pq.clearRes=function(ph,pq){void 0===pq&&(pq=!1),pBh.clearRes(ph,pq)},pq.getRes=function(ph){return pBh.getRes(ph)},pq.cacheRes=function(ph,pq){pBh.cacheRes(ph,pq)},pq.clearTextureRes=function(ph){pBh.clearTextureRes(ph)},pq.setGroup=function(ph,pq){pBh.setGroup(ph,pq)},pq.clearResByGroup=function(ph){pBh.clearResByGroup(ph)},pq.clearUnLoaded=function(){for(var ph=0;ph<this._maxPriority;ph++){for(var pq=this._resInfos[ph],pf=pq.length-1;-1<pf;pf--){var pg=pq[pf];pg&&(pg.offAll(),this._infoPool.push(pg))}pq.length=0}this._loaderCount=0,pv._resMap={}},pq.cancelLoadByUrls=function(ph){if(ph)for(var pq=0,pf=ph.length;pq<pf;pq++)this.cancelLoadByUrl(ph[pq])},pq.cancelLoadByUrl=function(ph){for(var pq=0;pq<this._maxPriority;pq++)for(var pf=this._resInfos[pq],pg=pf.length-1;-1<pg;pg--){var p$=pf[pg];p$&&p$.url===ph&&(pf[pg]=null,p$.offAll(),this._infoPool.push(p$))}pv._resMap[ph]&&delete pv._resMap[ph]},pq._loadAssets=function(ph,pf,pS,pq,pg,p$,pP){null==pg&&(pg=2),null==p$&&(p$=!0);for(var pB=ph.length,pr=0,pY=0,pC=[],pU=!0,pu=0;pu<pB;pu++){var pv=ph[pu];if(!pv)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+ph);"string"==typeof pv&&(pv={url:pv,type:pq,size:1,priority:pg}),pv.size||(pv.size=1),pv.progress=0,pY+=pv.size,pC.push(pv);var pL=pS?pN.create(null,p_,[pv],!1):null,pe=pf||pS?pN.create(null,pl,[pv]):null;this.load(pv.url,pe,pL,pv.type,null!=pv.priority&&0<=pv.priority?pv.priority:2,p$,pv.group||pP)}function pl(ph,pq){pr++,ph.progress=1,pq||(pU=!1),pr===pB&&pf&&pf.runWith(pU)}function p_(ph,pq){if(null!=pS){ph.progress=pq;for(var pf=0,pg=0;pg<pC.length;pg++){var p$=pC[pg];pf+=p$.size*p$.progress}var pP=pf/pY;pS.runWith(pP)}}return this},pv.cacheRes=function(ph,pq){pBh.cacheRes(ph,pq)},pv._resMap={},pr(pv,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),pv.__init$=function(){pu=function(ph){function pq(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,pq.__super.call(this)}return pe(pq,"",pY),pq}()},pv}(),pYh=(function(ph){function p$(ph){p$.__super.call(this),ph||(ph=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var pq=0,pf=0,pg=0;pg<20;pg++)pg%5!=4?this._mat[pq++]=ph[pg]:this._alpha[pf++]=ph[pg];this._action=pd.createFilterAction(32),this._action.data=this}pe(p$,"laya.filters.ColorFilter",p_);var pq=p$.prototype;pt.imps(pq,{"laya.filters.IFilter":!0}),pq.callNative=function(ph){ph._$P.cf=this;ph.conchModel&&ph.conchModel.setFilterMatrix&&ph.conchModel.setFilterMatrix(this._mat,this._alpha)},pC(0,pq,"type",function(){return 32}),pC(0,pq,"action",function(){return this._action})}(),function(ph){function pg(ph,pq,pf){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===pq&&(pq=0),pg.__super.call(this),this._byteClass=pf||pk,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,ph&&0<pq&&pq<65535&&this.connect(ph,pq)}pe(pg,"laya.net.Socket",pY);var pq=pg.prototype;pq.connect=function(ph,pq){var pf="ws://"+ph+":"+pq;pf="https:"==pw.window.location.protocol?"wss://"+ph+":"+pq:"ws://"+ph+":"+pq,this.connectByUrl(pf)},pq.connectByUrl=function(ph){var pq=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new pw.window.WebSocket(ph,this.protocols):this._socket=new pw.window.WebSocket(ph),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(ph){pq._onOpen(ph)},this._socket.onmessage=function(ph){pq._onMessage(ph)},this._socket.onclose=function(ph){pq._onClose(ph)},this._socket.onerror=function(ph){pq._onError(ph)}},pq.cleanSocket=function(){try{this._socket.close()}catch(ph){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},pq.close=function(){if(null!=this._socket)try{this._socket.close()}catch(ph){}},pq._onOpen=function(ph){this._connected=!0,this.event("open",ph)},pq._onMessage=function(ph){if(ph&&ph.data){var pq=ph.data;if(this.disableInput&&pq)this.event("message",pq);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var pf=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,pq&&("string"==typeof pq?this._input.writeUTFBytes(pq):this._input.writeArrayBuffer(pq),this._addInputPosition=this._input.pos,this._input.pos=pf),this.event("message",pq)}}},pq._onClose=function(ph){this._connected=!1,this.event("close",ph)},pq._onError=function(ph){this.event("error",ph)},pq.send=function(ph){this._socket.send(ph)},pq.flush=function(){if(this._output&&0<this._output.length){var pq;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(ph){pq=ph}this._output.endian=this.endian,this._output.clear(),pq&&this.event("error",pq)}},pC(0,pq,"input",function(){return this._input}),pC(0,pq,"output",function(){return this._output}),pC(0,pq,"connected",function(){return this._connected}),pC(0,pq,"endian",function(){return this._endian},function(ph){this._endian=ph,null!=this._input&&(this._input.endian=ph),null!=this._output&&(this._output.endian=ph)}),pg.LITTLE_ENDIAN="littleEndian",pg.BIG_ENDIAN="bigEndian"}(),function(ph){function pB(){pB.__super.call(this),this._$1__id=++pB._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(pB._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,pI.currentResourceManager&&pI.currentResourceManager.addResource(this)}pe(pB,"laya.resource.Resource",pY);var pq=pB.prototype;return pt.imps(pq,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),pq._setUrl=function(ph){var pq;this._url!==ph&&(this._url&&((pq=pB._urlResourcesMap[this._url]).splice(pq.indexOf(this),1),0===pq.length&&delete pB._urlResourcesMap[this._url]),ph&&((pq=pB._urlResourcesMap[ph])||(pB._urlResourcesMap[ph]=pq=[]),pq.push(this)),this._url=ph)},pq._getGroup=function(){return this._group},pq._setGroup=function(ph){var pq;this._group!==ph&&(this._group&&((pq=pB._groupResourcesMap[this._group]).splice(pq.indexOf(this),1),0===pq.length&&delete pB._groupResourcesMap[this._group]),ph&&((pq=pB._groupResourcesMap[ph])||(pB._groupResourcesMap[ph]=pq=[]),pq.push(this)),this._group=ph)},pq._addReference=function(){this._referenceCount++},pq._removeReference=function(){this._referenceCount--},pq._clearReference=function(){this._referenceCount=0},pq._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},pq.recreateResource=function(){this.completeCreate()},pq.disposeResource=function(){},pq.activeResource=function(ph){void 0===ph&&(ph=!1),this._lastUseFrameCount=pZ.loopCount,!this._destroyed&&this.__loaded&&(this._released||ph)&&this.recreateResource()},pq.releaseResource=function(ph){return void 0===ph&&(ph=!0),!(!ph&&this.lock)&&(!(this._released&&!ph)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},pq.onAsynLoaded=function(ph,pq,pf){throw new Error("Resource: must override this function!")},pq.destroy=function(){var ph;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete pB._idResourcesMap[this.id],this._url&&((ph=pB._urlResourcesMap[this._url])&&(ph.splice(ph.indexOf(this),1),0===ph.length&&delete pB._urlResourcesMap[this.url]),pBh.clearRes(this._url),this.__loaded||pd.cancelLoadByUrl(this._url)),this._group&&((ph=pB._groupResourcesMap[this._group]).splice(ph.indexOf(this),1),0===ph.length&&delete pB._groupResourcesMap[this.url]))},pq.completeCreate=function(){this._released=!1,this.event("recovered",this)},pq.dispose=function(){this.destroy()},pC(0,pq,"memorySize",function(){return this._memorySize},function(ph){var pq=ph-this._memorySize;this._memorySize=ph,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,pq),this.resourceManager&&this.resourceManager.addSize(pq)}),pC(0,pq,"_loaded",null,function(ph){this.__loaded=ph}),pC(0,pq,"loaded",function(){return this.__loaded}),pC(0,pq,"id",function(){return this._$1__id}),pC(0,pq,"destroyed",function(){return this._destroyed}),pC(0,pq,"group",function(){return this._getGroup()},function(ph){this._setGroup(ph)}),pC(0,pq,"resourceManager",function(){return this._resourceManager}),pC(0,pq,"url",function(){return this._url}),pC(0,pq,"released",function(){return this._released}),pC(0,pq,"referenceCount",function(){return this._referenceCount}),pB.getResourceByID=function(ph){return pB._idResourcesMap[ph]},pB.getResourceByURL=function(ph,pq){return void 0===pq&&(pq=0),null==pB._urlResourcesMap[ph]?null:pB._urlResourcesMap[ph][pq]},pB.getResourceCountByURL=function(ph){return pB._urlResourcesMap[ph].length},pB.destroyUnusedResources=function(ph){var pq;if(ph){var pf=pB._groupResourcesMap[ph];if(pf)for(var pg=pf.slice(),p$=0,pP=pg.length;p$<pP;p$++)(pq=pg[p$]).lock||0!==pq._referenceCount||pq.destroy()}else for(var pS in pB._idResourcesMap)(pq=pB._idResourcesMap[pS]).lock||0!==pq._referenceCount||pq.destroy()},pB._uniqueIDCounter=0,pB._idResourcesMap={},pB._urlResourcesMap={},pB._groupResourcesMap={},pB}()),pCh=function(ph){function pJ(ph,pq){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,pJ.__super.call(this),ph&&null!=ph._addReference&&ph._addReference(),this.setTo(ph,pq)}pe(pJ,"laya.resource.Texture",pY);var pq=pJ.prototype;return pq._setUrl=function(ph){this.url=ph},pq.setTo=function(ph,pq){if(ph instanceof pS.HTMLElement){var pf=pGh.create("2D",ph);this.bitmap=pf}else this.bitmap=ph;if(this.uv=pq||pJ.DEF_UV,ph){this._w=ph.width,this._h=ph.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var pg=this;if(this._loaded)pd.addToAtlas&&pd.addToAtlas(pg);else{var p$=ph;p$ instanceof laya.resource.HTMLImage&&p$.image&&p$.image.addEventListener("load",function(ph){pd.addToAtlas&&pd.addToAtlas(pg)},!1)}}},pq.active=function(){this.bitmap&&this.bitmap.activeResource()},pq.destroy=function(ph){if(void 0===ph&&(ph=!1),this.alphaTexture&&(this.alphaTexture.destroy(ph),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var pq=this.bitmap;ph?(pc.isConchApp&&pq.source&&pq.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,pq.dispose(),pq._clearReference()):(pq._removeReference(),0==pq.referenceCount&&(pc.isConchApp&&pq.source&&pq.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,pq.dispose())),this.url&&this===pt.loader.getRes(this.url)&&pt.loader.clearRes(this.url,ph),this._loaded=!1}},pq.load=function(ph){var pq=this;this._loaded=!1,ph=pz.customFormat(ph);var pf=this.bitmap||(this.bitmap=pRh.create(ph));pf.uri=ph,pf&&pf._addReference();var pg=this;pf.onload=function(){pf.onload=null,pg._loaded=!0,pq.sourceWidth=pq._w=pf.width,pq.sourceHeight=pq._h=pf.height,pg.event("loaded",this),pd.addToAtlas&&pd.addToAtlas(pg)}},pq.addTextureToAtlas=function(ph){pd.addTextureToAtlas(this)},pq.getPixels=function(ph,pq,pf,pg){if(pc.isConchApp){var p$=this.bitmap;if(p$.source&&p$.source.getImageData){var pP=p$.source.getImageData(ph,pq,pf,pg),pS=new Uint8Array(pP);return Array.from(pS)}return null}return pc.isWebGL?pd.getTexturePixels(this,ph,pq,pf,pg):(pw.canvas.size(pf,pg),pw.canvas.clear(),pw.context.drawTexture(this,-ph,-pq,this.width,this.height,0,0),pw.context.getImageData(0,0,pf,pg).data)},pq.onAsynLoaded=function(ph,pq){if(pq){if("function"!=typeof pq._addReference)throw new Error("bitmap._addReference is not a function. "+pq.className+" "+typeof pq._addReference+" "+pq.constructor);pq._addReference()}this.setTo(pq,this.uv),this._loaded&&this.event("loaded",this)},pC(0,pq,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),pC(0,pq,"loaded",function(){return this._loaded}),pC(0,pq,"released",function(){return!this.bitmap||this.bitmap.released}),pC(0,pq,"width",function(){return this._w?this._w:this.uv&&this.uv!==pJ.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(ph){this._w=ph,this.sourceWidth||(this.sourceWidth=ph)}),pC(0,pq,"repeat",function(){return!pc.isWebGL||!this.bitmap||this.bitmap.repeat},function(ph){ph&&pc.isWebGL&&this.bitmap&&(this.bitmap.repeat=ph)&&(this.bitmap.enableMerageInAtlas=!1)}),pC(0,pq,"height",function(){return this._h?this._h:this.uv&&this.uv!==pJ.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(ph){this._h=ph,this.sourceHeight||(this.sourceHeight=ph)}),pC(0,pq,"isLinearSampling",function(){return!pc.isWebGL||9728!=this.bitmap.minFifter},function(ph){!ph&&pc.isWebGL&&(ph||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),pJ.moveUV=function(ph,pq,pf){for(var pg=0;pg<8;pg+=2)pf[pg]+=ph,pf[pg+1]+=pq;return pf},pJ.create=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){void 0===pP&&(pP=0),void 0===pS&&(pS=0),void 0===pB&&(pB=0),void 0===pr&&(pr=0);var pY=ph instanceof laya.resource.Texture,pC=pY?ph.uv:pJ.DEF_UV,pU=pY?ph.bitmap:ph,pu=pd.isAtlas(pU);if(pu){var pv=pU._atlaser,pL=ph._atlasID;if(-1==pL)throw new Error("create texture error");pU=pv._inAtlasTextureBitmapValue[pL],pC=pv._inAtlasTextureOriUVValue[pL]}var pe=new pJ(pU,null);pU.width&&pq+pg>pU.width&&(pg=pU.width-pq),pU.height&&pf+p$>pU.height&&(p$=pU.height-pf),pe.width=pg,pe.height=p$,pe.offsetX=pP,pe.offsetY=pS,pe.sourceWidth=pB||pg,pe.sourceHeight=pr||p$;var pl=1/pU.width,p_=1/pU.height;pq*=pl,pf*=p_,pg*=pl,p$*=p_;var pN=pe.uv[0],pG=pe.uv[1],pm=pe.uv[4],pE=pe.uv[5],pR=pm-pN,pt=pE-pG,pX=pJ.moveUV(pC[0],pC[1],[pq,pf,pq+pg,pf,pq+pg,pf+p$,pq,pf+p$]);pe.uv=[pN+pX[0]*pR,pG+pX[1]*pt,pm-(1-pX[2])*pR,pG+pX[3]*pt,pm-(1-pX[4])*pR,pE-(1-pX[5])*pt,pN+pX[6]*pR,pE-(1-pX[7])*pt],pu&&pe.addTextureToAtlas();var pn=pU.scaleRate;return pn&&1!=pn?(pe.sourceWidth/=pn,pe.sourceHeight/=pn,pe.width/=pn,pe.height/=pn,pe.scaleRate=pn,pe.offsetX/=pn,pe.offsetY/=pn):pe.scaleRate=1,pe},pJ.createFromTexture=function(ph,pq,pf,pg,p$){var pP=ph.scaleRate;1!=pP&&(pq*=pP,pf*=pP,pg*=pP,p$*=pP);var pS=pn.TEMP.setTo(pq-ph.offsetX,pf-ph.offsetY,pg,p$),pB=pS.intersection(pJ._rect1.setTo(0,0,ph.width,ph.height),pJ._rect2);if(!pB)return null;var pr=pJ.create(ph,pB.x,pB.y,pB.width,pB.height,pB.x-pS.x,pB.y-pS.y,pg,p$);if(pr.bitmap&&pr.bitmap._removeReference)return pr.bitmap._removeReference(),pr;var pY="bitmap:"+(pr.bitmap?pr.bitmap.constructor?pr.bitmap.constructor.name:pr.bitmap.__className:"")+", url:"+(ph.url+" | "+(pr.bitmap?pr.bitmap.url:ph.url))+", x="+pq+",y="+pf+",width="+pg+",height="+p$+", result="+(pB?pB.x+","+pB.y+","+pB.width+","+pB.height:"null")+", rect="+pS.x+","+pS.y+","+pS.width+","+pS.height;throw new Error("报错：bitmap._removeReference is not a function  "+pY)},pJ.DEF_UV=[0,0,1,0,1,1,0,1],pJ.INV_UV=[0,1,1,1,1,0,0,0],pJ._rect1=new pn,pJ._rect2=new pn,pJ}(),ph=function(ph){var pB;function pP(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,pP.__super.call(this)}pe(pP,"laya.utils.TimeLine",pY);var pq=pP.prototype;return pq.to=function(ph,pq,pf,pg,p$){return void 0===p$&&(p$=0),this._create(ph,pq,pf,pg,p$,!0)},pq.from=function(ph,pq,pf,pg,p$){return void 0===p$&&(p$=0),this._create(ph,pq,pf,pg,p$,!1)},pq._create=function(ph,pq,pf,pg,p$,pP){var pS=pF.getItemByClass("tweenData",pB);return pS.isTo=pP,pS.type=0,pS.target=ph,pS.duration=pf,pS.data=pq,pS.startTime=this._startTime+p$,pS.endTime=pS.startTime+pS.duration,pS.ease=pg,this._startTime=Math.max(pS.endTime,this._startTime),this._tweenDataList.push(pS),this._startTimeSort=!0,this._endTimeSort=!0,this},pq.addLabel=function(ph,pq){var pf=pF.getItemByClass("tweenData",pB);return pf.type=1,pf.data=ph,pf.endTime=pf.startTime=this._startTime+pq,this._labelDic||(this._labelDic={}),this._labelDic[ph]=pf,this._tweenDataList.push(pf),this},pq.removeLabel=function(ph){if(this._labelDic&&this._labelDic[ph]){var pq=this._labelDic[ph];if(pq){var pf=this._tweenDataList.indexOf(pq);-1<pf&&this._tweenDataList.splice(pf,1)}delete this._labelDic[ph]}},pq.gotoTime=function(ph){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var pq,pf,pg,p$;for(var pP in this._firstTweenDic)if(pf=this._firstTweenDic[pP])for(var pS in pf)pf.diyTarget.hasOwnProperty(pS)&&(pf.diyTarget[pS]=pf[pS]);for(pP in this._tweenDic)(pq=this._tweenDic[pP]).clear(),delete this._tweenDic[pP];if(this._index=0,this._gidIndex=0,this._currTime=ph,this._lastTime=pw.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=pg=this._tweenDataList.concat(),pg.sort(function(ph,pq){return ph.endTime>pq.endTime?1:ph.endTime<pq.endTime?-1:0})}else pg=this._endTweenDataList;for(var pB=0,pr=pg.length;pB<pr;pB++)if(0==(p$=pg[pB]).type){if(!(ph>=p$.endTime))break;this._index=Math.max(this._index,pB+1);var pY=p$.data;if(p$.isTo)for(var pC in pY)p$.target[pC]=pY[pC]}for(pB=0,pr=this._tweenDataList.length;pB<pr;pB++)0==(p$=this._tweenDataList[pB]).type&&ph>=p$.startTime&&ph<p$.endTime&&(this._index=Math.max(this._index,pB+1),this._gidIndex++,(pq=pF.getItemByClass("tween",po))._create(p$.target,p$.data,p$.duration,p$.ease,pN.create(this,this._animComplete,[this._gidIndex]),0,!1,p$.isTo,!0,!1),pq.setStartTime(this._currTime-(ph-p$.startTime)),pq._updateEase(this._currTime),pq.gid=this._gidIndex,this._tweenDic[this._gidIndex]=pq)}},pq.gotoLabel=function(ph){if(null!=this._labelDic){var pq=this._labelDic[ph];pq&&this.gotoTime(pq.startTime)}},pq.pause=function(){pt.timer.clear(this,this._update)},pq.resume=function(){this.play(this._currTime,this._loopKey)},pq.play=function(ph,pq){if(void 0===ph&&(ph=0),void 0===pq&&(pq=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(ph,pq){return ph.startTime>pq.startTime?1:ph.startTime<pq.startTime?-1:0});for(var pf=0,pg=this._tweenDataList.length;pf<pg;pf++){var p$=this._tweenDataList[pf];if(null!=p$&&0==p$.type){var pP=p$.target,pS=pP.$_GID||(pP.$_GID=pO.getGID()),pB=null;for(var pr in null==this._firstTweenDic[pS]?((pB={}).diyTarget=pP,this._firstTweenDic[pS]=pB):pB=this._firstTweenDic[pS],p$.data)null==pB[pr]&&(pB[pr]=pP[pr])}}}"string"==typeof ph?this.gotoLabel(ph):this.gotoTime(ph),this._loopKey=pq,this._lastTime=pw.now(),pt.timer.frameLoop(1,this,this._update)}},pq._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var ph in this._tweenDic)(pq=this._tweenDic[ph]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var pq,pf=pw.now(),pg=pf-this._lastTime,p$=this._currTime+=pg*this.scale;for(ph in this._lastTime=pf,this._tweenDic)(pq=this._tweenDic[ph])._updateEase(p$);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var pP=this._tweenDataList[this._index];p$>=pP.startTime&&(this._index++,0==pP.type?(this._gidIndex++,(pq=pF.getItemByClass("tween",po))._create(pP.target,pP.data,pP.duration,pP.ease,pN.create(this,this._animComplete,[this._gidIndex]),0,!1,pP.isTo,!0,!1),pq.setStartTime(p$),pq.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=pq)._updateEase(p$)):this.event("label",pP.data))}},pq._animComplete=function(ph){this._tweenDic[ph]&&delete this._tweenDic[ph]},pq._complete=function(){this.event("complete")},pq.reset=function(){var ph;if(this._labelDic)for(ph in this._labelDic)delete this._labelDic[ph];for(ph in this._tweenDic)this._tweenDic[ph].clear(),delete this._tweenDic[ph];for(ph in this._firstTweenDic)delete this._firstTweenDic[ph];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var pq,pf=0;for(pq=this._tweenDataList.length,pf=0;pf<pq;pf++)this._tweenDataList[pf]&&this._tweenDataList[pf].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,pt.timer.clear(this,this._update)},pq.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},pC(0,pq,"index",function(){return this._frameIndex},function(ph){this._frameIndex=ph,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),pC(0,pq,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),pP.to=function(ph,pq,pf,pg,p$){return void 0===p$&&(p$=0),(new pP).to(ph,pq,pf,pg,p$)},pP.from=function(ph,pq,pf,pg,p$){return void 0===p$&&(p$=0),(new pP).from(ph,pq,pf,pg,p$)},pP.__init$=function(){pB=function(){function ph(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return pe(ph,""),ph.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,pF.recover("tweenData",this)},ph}()},pP}(),pUh=function(p$){function pf(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,pf.__super.call(this),this._style=pB.EMPTY}pe(pf,"laya.display.Sprite",p$);var ph=pf.prototype;return pt.imps(ph,{"laya.display.ILayout":!0}),ph.createConchModel=function(){return new ConchNode},ph.destroy=function(ph){if(void 0===ph&&(ph=!0),this._releaseMem(),!this._destroyed){this.filters=null;var pq=this.mask;pq&&(this.mask=null,pq.destroy(ph))}p$.prototype.destroy.call(this,ph),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},ph.updateZOrder=function(){pO.updateOrder(this._childs)&&this.repaint()},ph.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},ph.setBounds=function(ph){this._set$P("uBounds",ph)},ph.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new pn),pn._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},ph.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new pn),pn._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},ph._boundPointsToParent=function(ph){void 0===ph&&(ph=!1);var pq=0,pf=0;this._style&&(pq=this._style._tf.translateX,pf=this._style._tf.translateY,ph=ph||0!==this._style._tf.rotate,this._style.scrollRect&&(pq+=this._style.scrollRect.x,pf+=this._style.scrollRect.y));var pg=this._getBoundPointsM(ph);if(!pg||pg.length<1)return pg;if(8!=pg.length&&(pg=ph?pE.scanPList(pg):pn._getWrapRec(pg,pn.TEMP)._getBoundPoints()),!this.transform)return pO.transPointList(pg,this._x-pq,this._y-pf),pg;var p$=pX.TEMP,pP=0,pS=pg.length;for(pP=0;pP<pS;pP+=2)p$.x=pg[pP],p$.y=pg[pP+1],this.toParentPoint(p$),pg[pP]=p$.x,pg[pP+1]=p$.y;return pg},ph.getGraphicBounds=function(ph){return void 0===ph&&(ph=!1),this._graphics?this._graphics.getBounds(ph):pn.TEMP.setTo(0,0,0,0)},ph._getBoundPointsM=function(ph){if(void 0===ph&&(ph=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var pq=pO.clearArray(this._$P.temBM),pf=pn.TEMP;return pf.copyFrom(this.scrollRect),pO.concatArray(pq,pf._getBoundPoints()),pq}for(var pg,p$,pP,pS=this._graphics?this._graphics.getBoundPoints():pO.clearArray(this._$P.temBM),pB=0,pr=(pP=this._childs).length;pB<pr;pB++)(pg=pP[pB])instanceof laya.display.Sprite&&1==pg.visible&&(p$=pg._boundPointsToParent(ph))&&(pS=pS?pO.concatArray(pS,p$):p$);return pS},ph.getStyle=function(){return this._style===pB.EMPTY&&(this._style=new pB),this._style},ph.setStyle=function(ph){this._style=ph},ph._adjustTransform=function(){this._tfChanged=!1;var ph,pq=this._style._tf,pf=pq.scaleX,pg=pq.scaleY;if(pq.rotate||1!==pf||1!==pg||pq.skewX||pq.skewY){(ph=this._transform||(this._transform=pb.create())).bTransform=!0;var p$=.0174532922222222*(pq.rotate-pq.skewX),pP=.0174532922222222*(pq.rotate+pq.skewY),pS=Math.cos(pP),pB=Math.sin(pP),pr=Math.sin(p$),pY=Math.cos(p$);return ph.a=pf*pS,ph.b=pf*pB,ph.c=-pg*pr,ph.d=pg*pY,ph.tx=ph.ty=0,ph}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,ph},ph.pos=function(ph,pq,pf){if(void 0===pf&&(pf=!1),this._x!==ph||this._y!==pq){if(this.destroyed)return this;if(pf){this._x=ph,this._y=pq,this.conchModel&&this.conchModel.pos(this._x,this._y);var pg=this._parent;pg&&0===pg._repaint&&(pg._repaint=1,pg.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=ph,this.y=pq}return this},ph.pivot=function(ph,pq){return this.pivotX=ph,this.pivotY=pq,this},ph.size=function(ph,pq){return this.width=ph,this.height=pq,this},ph.scale=function(ph,pq,pf){void 0===pf&&(pf=!1);var pg=this.getStyle(),p$=pg._tf;if(p$.scaleX!=ph||p$.scaleY!=pq){if(this.destroyed)return this;if(pf){pg.setScale(ph,pq),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(ph,pq),this._renderType|=4;var pP=this._parent;pP&&0===pP._repaint&&(pP._repaint=1,pP.parentRepaint())}else this.scaleX=ph,this.scaleY=pq}return this},ph.skew=function(ph,pq){return this.skewX=ph,this.skewY=pq,this},ph.render=function(ph,pq,pf){pZ.spriteCount++,pW.renders[this._renderType]._fun(this,ph,pq+this._x,pf+this._y),this._repaint=0},ph.drawToCanvas=function(ph,pq,pf,pg){if(pc.isConchNode){var p$=pGh.create("2D");return new pM(ph,pq,p$).ctx.setCanvasType(1),this.conchModel.drawToCanvas(p$.source,pf,pg),p$}return pd.drawToCanvas(this,this._renderType,ph,pq,pf,pg)},ph.customRender=function(ph,pq,pf){this._renderType|=1024},ph._applyFilters=function(){var ph;if(!pc.isWebGL&&((ph=this._$P.filters)&&!(ph.length<1)))for(var pq=0,pf=ph.length;pq<pf;pq++)ph[pq].action.apply(this._$P.cacheCanvas)},ph._isHaveGlowFilter=function(){var ph,pq=0;if(this.filters)for(pq=0;pq<this.filters.length;pq++)if(8==this.filters[pq].type)return!0;for(pq=0,ph=this._childs.length;pq<ph;pq++)if(this._childs[pq]._isHaveGlowFilter())return!0;return!1},ph.localToGlobal=function(ph,pq){void 0===pq&&(pq=!1),!0===pq&&(ph=new pX(ph.x,ph.y));for(var pf=this;pf&&pf!=pt.stage;)ph=pf.toParentPoint(ph),pf=pf.parent;return ph},ph.globalToLocal=function(ph,pq){void 0===pq&&(pq=!1),pq&&(ph=new pX(ph.x,ph.y));for(var pf=this,pg=[];pf&&pf!=pt.stage;)pg.push(pf),pf=pf.parent;for(var p$=pg.length-1;0<=p$;)ph=(pf=pg[p$]).fromParentPoint(ph),p$--;return ph},ph.toParentPoint=function(ph){if(!ph)return ph;ph.x-=this.pivotX,ph.y-=this.pivotY,this.transform&&this._transform.transformPoint(ph),ph.x+=this._x,ph.y+=this._y;var pq=this._style.scrollRect;return pq&&(ph.x-=pq.x,ph.y-=pq.y),ph},ph.fromParentPoint=function(ph){if(!ph)return ph;ph.x-=this._x,ph.y-=this._y;var pq=this._style.scrollRect;return pq&&(ph.x+=pq.x,ph.y+=pq.y),this.transform&&this._transform.invertTransformPoint(ph),ph.x+=this.pivotX,ph.y+=this.pivotY,ph},ph.on=function(ph,pq,pf,pg){return 1!==this._mouseEnableState&&this.isMouseEvent(ph)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(ph,pq,pf,pg,!1)):p$.prototype.on.call(this,ph,pq,pf,pg)},ph.once=function(ph,pq,pf,pg){return 1!==this._mouseEnableState&&this.isMouseEvent(ph)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(ph,pq,pf,pg,!0)):p$.prototype.once.call(this,ph,pq,pf,pg)},ph._$2__onDisplay=function(){if(1!==this._mouseEnableState){var ph=this;for(ph=ph.parent;ph&&1!==ph._mouseEnableState&&!ph._getBit(2);)ph.mouseEnabled=!0,ph._setBit(2,!0),ph=ph.parent}},ph.loadImage=function(ph,pq,pf,pg,p$,pP){var pS=this;return void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=0),void 0===p$&&(p$=0),this.graphics.loadImage(ph,pq,pf,pg,p$,function(ph){pS.destroyed||(pS.size(pq+(pg||ph.width),pf+(p$||ph.height)),pS.repaint(),pP&&pP.runWith(ph))}),this},ph.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},ph._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},ph._childChanged=function(ph){this._childs.length?this._renderType|=2048:this._renderType&=-2049,ph&&this._get$P("hasZorder")&&pt.timer.callLater(this,this.updateZOrder),this.repaint()},ph.parentRepaint=function(){var ph=this._parent;ph&&0===ph._repaint&&(ph._repaint=1,ph.parentRepaint())},ph.startDrag=function(ph,pq,pf,pg,p$,pP,pS){void 0===pq&&(pq=!1),void 0===pf&&(pf=0),void 0===pg&&(pg=300),void 0===pP&&(pP=!1),void 0===pS&&(pS=.92),this._$P.dragging||this._set$P("dragging",new pV),this._$P.dragging.start(this,ph,pq,pf,pg,p$,pP,pS)},ph.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},ph._releaseMem=function(){if(this._$P){var ph=this._$P.cacheCanvas;ph&&ph.ctx&&(pF.recover("RenderContext",ph.ctx),ph.ctx.canvas.size(0,0),ph.ctx=null);var pq=this._$P._filterCache;pq&&(pq.destroy(),pq.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},ph._setDisplay=function(ph){ph||this._releaseMem(),p$.prototype._setDisplay.call(this,ph)},ph.hitTestPoint=function(ph,pq){var pf=this.globalToLocal(pX.TEMP.setTo(ph,pq));return ph=pf.x,pq=pf.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?pn.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(ph,pq)},ph.getMousePoint=function(){return this.globalToLocal(pX.TEMP.setTo(pt.stage.mouseX,pt.stage.mouseY))},ph._getWords=function(){return null},ph._addChildsToLayout=function(ph){var pq=this._getWords();if(null==pq&&0==this._childs.length)return!1;if(pq)for(var pf=0,pg=pq.length;pf<pg;pf++)ph.push(pq[pf]);pf=0;for(var p$=this._childs.length;pf<p$;++pf){var pP=this._childs[pf];pP._style._enableLayout()&&pP._addToLayout(ph)}return!0},ph._addToLayout=function(ph){this._style.absolute||(this._style.block?ph.push(this):this._addChildsToLayout(ph)&&(this.x=this.y=0))},ph._isChar=function(){return!1},ph._getCSSStyle=function(){return this._style.getCSSStyle()},ph._setAttributes=function(ph,pq){switch(ph){case"x":this.x=parseFloat(pq);break;case"y":this.y=parseFloat(pq);break;case"width":this.width=parseFloat(pq);break;case"height":this.height=parseFloat(pq);break;default:this[ph]=pq}},ph._layoutLater=function(){this.parent&&this.parent._layoutLater()},pC(0,ph,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(ph){this._optimizeScrollRect!=ph&&(this._optimizeScrollRect=ph,this.conchModel&&this.conchModel.optimizeScrollRect(ph))}),pC(0,ph,"customRenderEnable",null,function(ph){if(ph&&(this._renderType|=1024,pc.isConchNode)){pf.CustomList.push(this);var pq=new pGh("2d");pq._setContext(new CanvasRenderingContext2D),this.customContext=new pM(0,0,pq),pq.context.setCanvasType&&pq.context.setCanvasType(2),this.conchModel.custom(pq.context)}}),pC(0,ph,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(ph){this.cacheAs=ph?this._$P.hasFilter?"none":"normal":"none"}),pC(0,ph,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(ph){var pq=this._$P.cacheCanvas;if(ph!==(pq?pq.type:"none")){if("none"!==ph)this._getBit(1)||this._setUpNoticeType(1),pq||(pq=this._set$P("cacheCanvas",pF.getItemByClass("cacheCanvas",Object))),pq.type=ph,pq.reCache=!0,this._renderType|=16,"bitmap"==ph&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(pq){var pf=pq;pf&&pf.ctx&&(pF.recover("RenderContext",pf.ctx),pf.ctx.canvas.size(0,0),pf.ctx=null),pF.recover("cacheCanvas",pq)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),pC(0,ph,"zOrder",function(){return this._zOrder},function(ph){this._zOrder!=ph&&(this._zOrder=ph,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(ph),this._parent&&(ph&&this._parent._set$P("hasZorder",!0),pt.timer.callLater(this._parent,this.updateZOrder)))}),pC(0,ph,"rotation",function(){return this._style._tf.rotate},function(ph){var pq=this.getStyle();if(pq._tf.rotate!==ph){pq.setRotate(ph),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(ph),this._renderType|=4;var pf=this._parent;pf&&0===pf._repaint&&(pf._repaint=1,pf.parentRepaint())}}),pC(0,ph,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(ph){this._width!==ph&&(this._width=ph,this.conchModel&&this.conchModel.size(ph,this._height),this.repaint())}),pC(0,ph,"x",function(){return this._x},function(ph){if(this._x!==ph){if(this.destroyed)return;this._x=ph,this.conchModel&&this.conchModel.pos(ph,this._y);var pq=this._parent;pq&&0===pq._repaint&&(pq._repaint=1,pq.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),pC(0,ph,"globalScaleY",function(){for(var ph=1,pq=this;pq&&pq!==pt.stage;)ph*=pq.scaleY,pq=pq.parent;return ph}),pC(0,ph,"hitArea",function(){return this._$P.hitArea},function(ph){this._set$P("hitArea",ph)}),pC(0,ph,"staticCache",function(){return this._$P.staticCache},function(ph){this._set$P("staticCache",ph),ph||this.reCache()}),pC(0,ph,"texture",function(){return this._texture},function(ph){this._texture!=ph&&(this._texture=ph,this.graphics.cleanByTexture(ph,0,0))}),pC(0,ph,"y",function(){return this._y},function(ph){if(this._y!==ph){if(this.destroyed)return;this._y=ph,this.conchModel&&this.conchModel.pos(this._x,ph);var pq=this._parent;pq&&0===pq._repaint&&(pq._repaint=1,pq.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),pC(0,ph,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(ph){this._height!==ph&&(this._height=ph,this.conchModel&&this.conchModel.size(this._width,ph),this.repaint())}),pC(0,ph,"blendMode",function(){return this._style.blendMode},function(ph){this.getStyle().blendMode=ph,this.conchModel&&this.conchModel.blendMode(ph),ph&&"source-over"!=ph?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),pC(0,ph,"scaleX",function(){return this._style._tf.scaleX},function(ph){var pq=this.getStyle();if(pq._tf.scaleX!==ph){pq.setScaleX(ph),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(ph,pq._tf.scaleY),this._renderType|=4;var pf=this._parent;pf&&0===pf._repaint&&(pf._repaint=1,pf.parentRepaint())}}),pC(0,ph,"scaleY",function(){return this._style._tf.scaleY},function(ph){var pq=this.getStyle();if(pq._tf.scaleY!==ph){pq.setScaleY(ph),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(pq._tf.scaleX,ph),this._renderType|=4;var pf=this._parent;pf&&0===pf._repaint&&(pf._repaint=1,pf.parentRepaint())}}),pC(0,ph,"stage",function(){return pt.stage}),pC(0,ph,"skewX",function(){return this._style._tf.skewX},function(ph){var pq=this.getStyle();if(pq._tf.skewX!==ph){pq.setSkewX(ph),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(ph,pq._tf.skewY),this._renderType|=4;var pf=this._parent;pf&&0===pf._repaint&&(pf._repaint=1,pf.parentRepaint())}}),pC(0,ph,"scrollRect",function(){return this._style.scrollRect},function(ph){this.getStyle().scrollRect=ph,this.repaint(),ph?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(ph.x,ph.y,ph.width,ph.height)):(this._renderType&=-129,this.conchModel&&(pf.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),pC(0,ph,"skewY",function(){return this._style._tf.skewY},function(ph){var pq=this.getStyle();if(pq._tf.skewY!==ph){pq.setSkewY(ph),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(pq._tf.skewX,ph),this._renderType|=4;var pf=this._parent;pf&&0===pf._repaint&&(pf._repaint=1,pf.parentRepaint())}}),pC(0,ph,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(ph){this._tfChanged=!1,(this._transform=ph)&&(this._x=ph.tx,this._y=ph.ty,ph.tx=ph.ty=0,this.conchModel&&this.conchModel.transform(ph.a,ph.b,ph.c,ph.d,this._x,this._y)),ph?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),pC(0,ph,"pivotX",function(){return this._style._tf.translateX},function(ph){this.getStyle().setTranslateX(ph),this.conchModel&&this.conchModel.pivot(ph,this._style._tf.translateY),this.repaint()}),pC(0,ph,"pivotY",function(){return this._style._tf.translateY},function(ph){this.getStyle().setTranslateY(ph),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,ph),this.repaint()}),pC(0,ph,"alpha",function(){return this._style.alpha},function(ph){this._style&&this._style.alpha!==ph&&(ph=ph<0?0:1<ph?1:ph,this.getStyle().alpha=ph,this.conchModel&&this.conchModel.alpha(ph),1!==ph?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),pC(0,ph,"visible",function(){return this._style.visible},function(ph){this._style&&this._style.visible!==ph&&(this.getStyle().visible=ph,this.conchModel&&this.conchModel.visible(ph),this.parentRepaint())}),pC(0,ph,"graphics",function(){return this._graphics||(this.graphics=pd.createGraphics())},function(ph){this._graphics&&(this._graphics._sp=null),(this._graphics=ph)?(this._renderType&=-2,this._renderType|=512,(ph._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(pf.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),pC(0,ph,"filters",function(){return this._$P.filters},function(ph){ph&&0===ph.length&&(ph=null),this._$P.filters!=ph&&(this._set$P("filters",ph?ph.slice():null),pc.isConchApp&&(this.conchModel&&(pf.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),pc.isWebGL&&(ph&&ph.length?this._renderType|=32:this._renderType&=-33),ph&&0<ph.length?(this._getBit(1)||this._setUpNoticeType(1),pc.isWebGL&&1==ph.length&&ph[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(pc.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),pC(0,ph,"parent",p$.prototype._$get_parent,function(ph){pt.superSet(phh,this,"parent",ph),ph&&this._getBit(2)&&this._$2__onDisplay()}),pC(0,ph,"mask",function(){return this._$P._mask},function(ph){ph&&this.mask&&this.mask._$P.maskParent||(ph?(this.cacheAs="bitmap",this._set$P("_mask",ph),ph._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",ph),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(ph?ph.conchModel:null),this._renderType|=64,this.parentRepaint())}),pC(0,ph,"mouseEnabled",function(){return 1<this._mouseEnableState},function(ph){this._mouseEnableState=ph?2:1}),pC(0,ph,"globalScaleX",function(){for(var ph=1,pq=this;pq&&pq!==pt.stage;)ph*=pq.scaleX,pq=pq.parent;return ph}),pC(0,ph,"mouseX",function(){return this.getMousePoint().x}),pC(0,ph,"mouseY",function(){return this.getMousePoint().y}),pf.fromImage=function(ph){return(new pf).loadImage(ph)},pf._cachePool=[],pf.CustomList=[],pr(pf,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=pS.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),pf}(phh),puh=function(ph){function pq(ph){this._audio=null,this._onEnd=null,this._resumePlay=null,pq.__super.call(this),this._onEnd=pO.bind(this.__onEnd,this),this._resumePlay=pO.bind(this.__resumePlay,this),ph.addEventListener("ended",this._onEnd),this._audio=ph}pe(pq,"laya.media.h5audio.AudioSoundChannel",pgh);var pf=pq.prototype;return pf.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(pt.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},pf.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,pw.container.appendChild(this._audio),this._audio.play()}catch(ph){this.event("error")}},pf.play=function(ph){this.isStopped=!1;try{this._audio.playbackRate=pA.playbackRate,this._audio.currentTime=this.startTime}catch(ph){return void this._audio.addEventListener("canplay",this._resumePlay)}pA.addChannel(this),pw.container.appendChild(this._audio),!ph&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},pf.stop=function(){this.isStopped=!0,pA.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&pc.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),pw.onIE||this._audio!=pfh._musicAudio&&pF.recover("audio:"+this.url,this._audio),pw.removeElement(this._audio),this._audio=null)},pf.pause=function(){this.isStopped=!0,pA.removeChannel(this),"pause"in this._audio&&this._audio.pause()},pf.resume=function(){this._audio&&(this.isStopped=!1,pA.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},pC(0,pf,"position",function(){return this._audio?this._audio.currentTime:0}),pC(0,pf,"duration",function(){return this._audio?this._audio.duration:0}),pC(0,pf,"volume",function(){return this._audio?this._audio.volume:1},function(ph){this._audio&&(this._audio.volume=ph)}),pq}(),pvh=function(ph){function pq(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=pPh.ctx,pq.__super.call(this),this._onPlayEnd=pO.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}pe(pq,"laya.media.webaudio.WebAudioSoundChannel",pgh);var pf=pq.prototype;return pf.play=function(ph){if(pA.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var pq=this.context,pf=this.gain,pg=pq.createBufferSource();(this.bufferSource=pg).buffer=this.audioBuffer,pg.connect(pf),pf&&pf.disconnect(),pf.connect(pq.destination),pg.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=pw.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(pg.loop=!0),pg.playbackRate.setTargetAtTime?pg.playbackRate.setTargetAtTime(pA.playbackRate,this.context.currentTime,.1):pg.playbackRate.value=pA.playbackRate,pg.start(0,this.startTime),!ph&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},pf.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(pt.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},pf._clearBufferSource=function(){if(this.bufferSource){var ph=this.bufferSource;ph.stop?ph.stop(0):ph.noteOff(0),ph.disconnect(0),ph.onended=null,pq._tryCleanFailed||this._tryClearBuffer(ph),this.bufferSource=null}},pf._tryClearBuffer=function(ph){try{ph.buffer=null}catch(ph){pq._tryCleanFailed=!0}},pf.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,pA.removeChannel(this),this.startHandler=null,this.completeHandler=null},pf.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,pA.removeChannel(this)},pf.resume=function(){this.startTime=this._pauseTime,this.play(!1)},pC(0,pf,"position",function(){return this.bufferSource?(pw.now()-this._startTime)/1e3+this.startTime:0}),pC(0,pf,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),pC(0,pf,"volume",function(){return this._volume},function(ph){this.isStopped||(this._volume=ph,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(ph,this.context.currentTime,.1):this.gain.gain.value=ph)}),pq._tryCleanFailed=!1,pq}(),pLh=function(ph){function pq(){pq.__super.call(this),this._w=0,this._h=0}pe(pq,"laya.resource.Bitmap",pYh);var pf=pq.prototype;return pC(0,pf,"width",function(){return this._w}),pC(0,pf,"height",function(){return this._h}),pC(0,pf,"source",function(){return this._source}),pq}(),peh=function(pq){function ph(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,ph.__super.call(this),this._interval=pg.animationInterval,this._setUpNoticeType(1)}pe(ph,"laya.display.AnimationPlayerBase",pq);var pf=ph.prototype;return pf.play=function(ph,pq,pf,pg){void 0===ph&&(ph=0),void 0===pq&&(pq=!0),void 0===pf&&(pf=""),void 0===pg&&(pg=!0),this._isPlaying=!0,this.index="string"==typeof ph?this._getFrameByLabel(ph):ph,this.loop=pq,this._actionName=pf,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},pf._getFrameByLabel=function(ph){var pq=0;for(pq=0;pq<this._count;pq++)if(this._labels[pq]&&0<=this._labels[pq].indexOf(ph))return pq;return 0},pf._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},pf._setControlNode=function(ph){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=ph)&&ph!=this&&(ph.on("display",this,this._checkResumePlaying),ph.on("undisplay",this,this._checkResumePlaying))},pf._setDisplay=function(ph){pq.prototype._setDisplay.call(this,ph),this._checkResumePlaying()},pf._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},pf.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},pf.addLabel=function(ph,pq){this._labels||(this._labels={}),this._labels[pq]||(this._labels[pq]=[]),this._labels[pq].push(ph)},pf.removeLabel=function(ph){if(ph){if(this._labels)for(var pq in this._labels)this._removeLabelFromLabelList(this._labels[pq],ph)}else this._labels=null},pf._removeLabelFromLabelList=function(ph,pq){if(ph)for(var pf=ph.length-1;0<=pf;pf--)ph[pf]==pq&&ph.splice(pf,1)},pf.gotoAndStop=function(ph){this.index="string"==typeof ph?this._getFrameByLabel(ph):ph,this.stop()},pf._displayToIndex=function(ph){},pf.clear=function(){this.stop(),this._labels=null},pC(0,pf,"interval",function(){return this._interval},function(ph){this._interval!=ph&&(this._frameRateChanged=!0,this._interval=ph,this._isPlaying&&0<ph&&this.timerLoop(ph,this,this._frameLoop,null,!0,!0))}),pC(0,pf,"isPlaying",function(){return this._isPlaying}),pC(0,pf,"index",function(){return this._index},function(ph){if(this._index=ph,this._displayToIndex(ph),this._labels&&this._labels[ph])for(var pq=this._labels[ph],pf=0,pg=pq.length;pf<pg;pf++)this.event("label",pq[pf])}),pC(0,pf,"count",function(){return this._count}),ph.WRAP_POSITIVE=0,ph.WRAP_REVERSE=1,ph.WRAP_PINGPONG=2,ph}(pUh),plh=function(pq){function pv(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,pv.__super.call(this),this.overflow=pv.VISIBLE,this._style=new pqh(this),this._style.wordWrap=!1}pe(pv,"laya.display.Text",pq);var ph=pv.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._lines=null,this._words&&(this._words.length=0,this._words=null)},ph._getBoundPointsM=function(ph){void 0===ph&&(ph=!1);var pq=pn.TEMP;return pq.setTo(0,0,this.width,this.height),pq._getBoundPoints()},ph.getGraphicBounds=function(ph){void 0===ph&&(ph=!1);var pq=pn.TEMP;return pq.setTo(0,0,this.width,this.height),pq},ph._getCSSStyle=function(){return this._style},ph.lang=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC){if(ph=pv.langPacks&&pv.langPacks[ph]?pv.langPacks[ph]:ph,arguments.length<2)this._text=ph;else{for(var pU=0,pu=arguments.length;pU<pu;pU++)ph=ph.replace("{"+pU+"}",arguments[pU+1]);this._text=ph}},ph._isPassWordMode=function(){var ph=this._style.password;return"prompt"in this&&this.prompt==this._text&&(ph=!1),ph},ph._getPassWordTxt=function(ph){var pq;pq="";for(var pf=ph.length;0<pf;pf--)pq+="●";return pq},ph.renderText=function(ph,pq){var pf=this.graphics;pf.clear(!0);var pg=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(pw.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);pw.context.font=pg;var p$=this.padding,pP=p$[3],pS="left",pB=this._lines,pr=this.leading+this._charSize.height,pY=this._currBitmapFont;pY&&(pr=this.leading+pY.getMaxHeight());var pC=p$[0];if(!pY&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(pS="right",pP=this._width-p$[1]):"center"==this.align&&(pS="center",pP=.5*this._width+p$[3]-p$[1])),0<this._height){var pU=this._textHeight>this._height?"top":this.valign;"middle"===pU?pC=.5*(this._height-pq*pr)+p$[0]-p$[2]:"bottom"===pU&&(pC=this._height-pq*pr-p$[2])}var pu=this._style;if(pY&&pY.autoScaleSize)var pv=pY.fontSize/this.fontSize;if(this._clipPoint)if(pf.save(),pY&&pY.autoScaleSize){var pL=0,pe=0;pL=this._width?this._width-p$[3]-p$[1]:this._textWidth,pe=this._height?this._height-p$[0]-p$[2]:this._textHeight,pL*=pv,pe*=pv,pf.clipRect(p$[3],p$[0],pL,pe)}else pf.clipRect(p$[3],p$[0],this._width?this._width-p$[3]-p$[1]:this._textWidth,this._height?this._height-p$[0]-p$[2]:this._textHeight);var pl=pu.password;"prompt"in this&&this.prompt==this._text&&(pl=!1);for(var p_=0,pN=0,pG=Math.min(this._lines.length,pq+ph)||1,pm=ph;pm<pG;pm++){var pE,pR=pB[pm];if(pl){var pt=pR.length;pR="";for(var pX=pt;0<pX;pX--)pR+="●"}if(p_=pP-(this._clipPoint?this._clipPoint.x:0),pN=pC+pr*pm-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(pS,p_,pN,pm),pY){var pn=this.width;pY.autoScaleSize&&(pn=this.width*pv),pY.drawText(pR,this,p_,pN,this.align,pn)}else pc.isWebGL?(this._words||(this._words=[]),(pE=this._words.length>pm-ph?this._words[pm-ph]:new pa).setText(pR)):pE=pR,pu.stroke?pf.fillBorderText(pE,p_,pN,pg,this.color,pu.strokeColor,pu.stroke,pS):pf.fillText(pE,p_,pN,pg,this.color,pS)}if(pY&&pY.autoScaleSize){var pJ=1/pv;this.scale(pJ,pJ)}this._clipPoint&&pf.restore(),this._startX=pP,this._startY=pC},ph.drawUnderline=function(ph,pq,pf,pg){var p$=this._lineWidths[pg];switch(ph){case"center":pq-=p$/2;break;case"right":pq-=p$}pf+=this._charSize.height,this._graphics.drawLine(pq,pf,pq+p$,pf,this.underlineColor||this.color,1)},ph.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);pw.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new pX(0,0)):this._clipPoint=null;var ph=this._lines.length;if(this.overflow!=pv.VISIBLE){var pq=this.overflow==pv.HIDDEN?Math.floor:Math.ceil;ph=Math.min(ph,pq((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var pf=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(pf,ph),this.repaint()},ph.evalTextSize=function(){var ph,pq=NaN;ph=Math.max.apply(this,this._lineWidths),pq=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],ph==this._textWidth&&pq==this._textHeight||(this._textWidth=ph,this._textHeight=pq,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},ph.checkEnabledViewportOrNot=function(){return this.overflow==pv.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},ph.changeText=function(ph){this._text!==ph&&(this.lang(ph+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},ph.parseLines=function(ph){var pq=this.wordWrap||this.overflow==pv.HIDDEN;if(pq)var pf=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var pg=pw.context.measureText(pv._testWord);pc.isConchApp&&0===pg.width&&0===pg.height&&(pg=pw.context.measureText("W")),this._charSize.width=pg.width,this._charSize.height=pg.height||this.fontSize}for(var p$=ph.replace(/\r\n/g,"\n").split("\n"),pP=0,pS=p$.length;pP<pS;pP++){var pB=p$[pP];pq?this.parseLine(pB,pf):(this._lineWidths.push(this.getTextWidth(pB)),this._lines.push(pB))}},ph.parseLine=function(ph,pq){pw.context;var pf,pg=this._lines,p$=0,pP=NaN,pS=NaN,pB=0;if((pP=this.getTextWidth(ph))<=pq)return pg.push(ph),void this._lineWidths.push(pP);pP=this._charSize.width,0==(p$=Math.floor(pq/pP))&&(p$=1),pS=pP=this.getTextWidth(ph.substring(0,p$));for(var pr=p$,pY=ph.length;pr<pY;pr++)if(pq<(pS+=pP=this.getTextWidth(ph.charAt(pr))))if(this.wordWrap){var pC=ph.substring(pB,pr);if(pC.charCodeAt(pC.length-1)<255?(pf=/(?:\w|-)+$/.exec(pC))&&(pr=pf.index+pB,0==pf.index?pr+=pC.length:pC=ph.substring(pB,pr)):pv.RightToLeft&&(pf=/([\u0600-\u06FF])+$/.exec(pC))&&(pr=pf.index+pB,0==pf.index?pr+=pC.length:pC=ph.substring(pB,pr)),pg.push(pC),this._lineWidths.push(pS-pP),!((pB=pr)+p$<pY)){pg.push(ph.substring(pB,pY)),this._lineWidths.push(this.getTextWidth(pg[pg.length-1])),pB=-1;break}pr+=p$,pS=pP=this.getTextWidth(ph.substring(pB,pr)),pr--}else if(this.overflow==pv.HIDDEN)return pg.push(ph.substring(0,pr)),void this._lineWidths.push(this.getTextWidth(pg[pg.length-1]));this.wordWrap&&-1!=pB&&(pg.push(ph.substring(pB,pY)),this._lineWidths.push(this.getTextWidth(pg[pg.length-1])))},ph.getTextWidth=function(ph){return this._currBitmapFont?this._currBitmapFont.getTextWidth(ph):pw.context.measureText(ph).width},ph.getWordWrapWidth=function(){var ph=this.padding,pq=NaN;return(pq=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(pq=this.wordWrap?100:pw.width),pq<=0&&(pq=100),pq-ph[3]-ph[1]},ph.getCharPoint=function(ph,pq){this._isChanged&&pt.timer.runCallLater(this,this.typeset);for(var pf=0,pg=this._lines,p$=0,pP=0,pS=pg.length;pP<pS;pP++){if(ph<(pf+=pg[pP].length)){var pB=pP;break}p$=pf}var pr=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;pw.context.font=pr;var pY=this.getTextWidth(this._text.substring(p$,ph));return(pq||new pX).setTo(this._startX+pY-(this._clipPoint?this._clipPoint.x:0),this._startY+pB*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},pC(0,ph,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(ph){ph!=this._width&&(pt.superSet(pUh,this,"width",ph),this.isChanged=!0)}),pC(0,ph,"textWidth",function(){return this._isChanged&&pt.timer.runCallLater(this,this.typeset),this._textWidth}),pC(0,ph,"height",function(){return this._height?this._height:this.textHeight},function(ph){ph!=this._height&&(pt.superSet(pUh,this,"height",ph),this.isChanged=!0)}),pC(0,ph,"textHeight",function(){return this._isChanged&&pt.timer.runCallLater(this,this.typeset),this._textHeight}),pC(0,ph,"padding",function(){return this._getCSSStyle().padding},function(ph){this._getCSSStyle().padding=ph,this.isChanged=!0}),pC(0,ph,"bold",function(){return this._getCSSStyle().bold},function(ph){this._getCSSStyle().bold=ph,this.isChanged=!0}),pC(0,ph,"text",function(){return this._text||""},function(ph){this._text!==ph&&(this.lang(ph+""),this.isChanged=!0,this.event("change"))}),pC(0,ph,"color",function(){return this._getCSSStyle().color},function(ph){this._getCSSStyle().color!=ph&&(this._getCSSStyle().color=ph,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),pC(0,ph,"font",function(){return this._getCSSStyle().fontFamily},function(ph){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),pv._bitmapFonts&&pv._bitmapFonts[ph]&&(this._currBitmapFont=pv._bitmapFonts[ph]),this._getCSSStyle().fontFamily=ph,this.isChanged=!0}),pC(0,ph,"fontSize",function(){return this._getCSSStyle().fontSize},function(ph){this._getCSSStyle().fontSize=ph,this.isChanged=!0}),pC(0,ph,"italic",function(){return this._getCSSStyle().italic},function(ph){this._getCSSStyle().italic=ph,this.isChanged=!0}),pC(0,ph,"align",function(){return this._getCSSStyle().align},function(ph){this._getCSSStyle().align=ph,this.isChanged=!0}),pC(0,ph,"valign",function(){return this._getCSSStyle().valign},function(ph){this._getCSSStyle().valign=ph,this.isChanged=!0}),pC(0,ph,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(ph){this._getCSSStyle().wordWrap=ph,this.isChanged=!0}),pC(0,ph,"leading",function(){return this._getCSSStyle().leading},function(ph){this._getCSSStyle().leading=ph,this.isChanged=!0}),pC(0,ph,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(ph){this._getCSSStyle().backgroundColor=ph,this.isChanged=!0}),pC(0,ph,"borderColor",function(){return this._getCSSStyle().borderColor},function(ph){this._getCSSStyle().borderColor=ph,this.isChanged=!0}),pC(0,ph,"stroke",function(){return this._getCSSStyle().stroke},function(ph){this._getCSSStyle().stroke=ph,this.isChanged=!0}),pC(0,ph,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(ph){this._getCSSStyle().strokeColor=ph,this.isChanged=!0}),pC(0,ph,"isChanged",null,function(ph){this._isChanged!==ph&&(this._isChanged=ph)&&pt.timer.callLater(this,this.typeset)}),pC(0,ph,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(ph){if(!(this.overflow!=pv.SCROLL||this.textWidth<this._width)&&this._clipPoint){ph=ph<this.padding[3]?this.padding[3]:ph;var pq=this._textWidth-this._width;ph=pq<ph?pq:ph;var pf=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=ph,this.renderText(this._lastVisibleLineIndex,pf)}}),pC(0,ph,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(ph){if(!(this.overflow!=pv.SCROLL||this.textHeight<this._height)&&this._clipPoint){ph=ph<this.padding[0]?this.padding[0]:ph;var pq=this._textHeight-this._height,pf=(ph=pq<ph?pq:ph)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=pf;var pg=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=ph,this.renderText(pf,pg)}}),pC(0,ph,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),pC(0,ph,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),pC(0,ph,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),pC(0,ph,"underlineColor",function(){return this._underlineColor},function(ph){this._underlineColor=ph,this._isChanged=!0,this.typeset()}),pv.registerBitmapFont=function(ph,pq){pv._bitmapFonts||(pv._bitmapFonts={}),pv._bitmapFonts[ph]=pq},pv.unregisterBitmapFont=function(ph,pq){if(void 0===pq&&(pq=!0),pv._bitmapFonts&&pv._bitmapFonts[ph]){var pf=pv._bitmapFonts[ph];pq&&pf.destroy(),delete pv._bitmapFonts[ph]}},pv.setTextRightToLeft=function(){var ph;(ph=pw.canvas.source.style).display="none",ph.position="absolute",ph.direction="rtl",pc._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,pw.document.body.appendChild(pw.canvas.source)},pv.supportFont=function(ph){pw.context.font="10px sans-serif";var pq=pw.context.measureText("abcji").width;pw.context.font="10px "+ph;var pf=pw.context.measureText("abcji").width;return console.log(pq,pf),pq!==pf},pv._testWord="游",pv.langPacks=null,pv.VISIBLE="visible",pv.SCROLL="scroll",pv.HIDDEN="hidden",pv.CharacterCache=!0,pv.RightToLeft=!1,pv._bitmapFonts=null,pr(pv,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),pv}(pUh),p_h=function(pU){function pS(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",pS.__super.call(this),this.offset=new pX,this._canvasTransform=new pb,this._previousOrientation=pw.window.orientation;var pq=this;this.transform=pb.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var ph=pw.window,pf=this;ph.addEventListener("focus",function(){pq._isFocused=!0,pf.event("focus"),pf.event("focuschange")}),ph.addEventListener("blur",function(){pq._isFocused=!1,pf.event("blur"),pf.event("focuschange"),pf._isInputting()&&(pEh.inputElement.target.focus=!1)});var pg="visibilityState",p$="visibilitychange",pP=ph.document;void 0!==pP.hidden?(p$="visibilitychange",pg="visibilityState"):void 0!==pP.mozHidden?(p$="mozvisibilitychange",pg="mozVisibilityState"):void 0!==pP.msHidden?(p$="msvisibilitychange",pg="msVisibilityState"):void 0!==pP.webkitHidden&&(p$="webkitvisibilitychange",pg="webkitVisibilityState"),ph.document.addEventListener(p$,function(){"hidden"==pw.document[pg]?pf._setStageVisible(!1):pf._setStageVisible(!0)}),ph.document.addEventListener("qbrowserVisibilityChange",function(ph){pf._setStageVisible(!ph.hidden)}),ph.addEventListener("resize",function(){var ph=pw.window.orientation;null!=ph&&ph!=pq._previousOrientation&&pf._isInputting()&&(pEh.inputElement.target.focus=!1),pq._previousOrientation=ph,pf._isInputting()||pf._resetCanvas()}),ph.addEventListener("orientationchange",function(ph){pf._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),pw.onMobile&&this.on("mousedown",this,this._onmouseMove)}pe(pS,"laya.display.Stage",pU);var ph=pS.prototype;return ph._setStageVisible=function(ph){this._isVisibility!=ph&&(this._isVisibility=ph,this._isVisibility||this._isInputting()&&(pEh.inputElement.target.focus=!1),this.event("visibilitychange"))},ph._isInputting=function(){return pw.onMobile&&pEh.isInputting},ph._changeCanvasSize=function(){this.setScreenSize(pw.clientWidth*pw.pixelRatio,pw.clientHeight*pw.pixelRatio)},ph._resetCanvas=function(){if(this.screenAdaptationEnabled){var ph=pc._mainCanvas;ph.source.style;ph.size(1,1),pt.timer.once(100,this,this._changeCanvasSize)}},ph.setScreenSize=function(ph,pq){var pf=!1;if("none"!==this._screenMode&&(pf=(ph/pq<1?"vertical":"horizontal")!==this._screenMode)){var pg=pq;pq=ph,ph=pg}this.canvasRotation=pf;var p$=pc._mainCanvas,pP=p$.source.style,pS=this._canvasTransform.identity(),pB=this._scaleMode,pr=ph/this.designWidth,pY=pq/this.designHeight,pC=this.designWidth,pU=this.designHeight,pu=ph,pv=pq,pL=pw.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,pB){case"noscale":pr=pY=1,pu=this.designWidth,pv=this.designHeight;break;case"showall":pr=pY=Math.min(pr,pY),pC=pu=Math.round(this.designWidth*pr),pU=pv=Math.round(this.designHeight*pY);break;case"noborder":pr=pY=Math.max(pr,pY),pu=Math.round(this.designWidth*pr),pv=Math.round(this.designHeight*pY);break;case"full":pr=pY=1,this._width=pC=ph,this._height=pU=pq;break;case"fixedwidth":pY=pr,this._height=pU=Math.round(pq/pr);break;case"fixedheight":pr=pY,this._width=pC=Math.round(ph/pY);break;case"fixedauto":ph/pq<this.designWidth/this.designHeight?(pY=pr,this._height=pU=Math.round(pq/pr)):(pr=pY,this._width=pC=Math.round(ph/pY))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,pC=pC+1&2147483646,pU=pU+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),pr*=this.scaleX,pY*=this.scaleY,1===pr&&1===pY?this.transform.identity():(this.transform.a=this._formatData(pr/(pu/pC)),this.transform.d=this._formatData(pY/(pv/pU)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),p$.size(pC,pU),pd.changeWebGLSize(pC,pU),pS.scale(pu/pC/pL,pv/pU/pL),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(ph-pu)/pL:this.offset.x=.5*(ph-pu)/pL,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(pq-pv)/pL:this.offset.y=.5*(pq-pv)/pL,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),pS.translate(this.offset.x,this.offset.y),this.canvasDegree=0,pf&&("horizontal"===this._screenMode?(pS.rotate(Math.PI/2),pS.translate(pq/pL,0),this.canvasDegree=90):(pS.rotate(-Math.PI/2),pS.translate(0,ph/pL),this.canvasDegree=-90)),pS.a=this._formatData(pS.a),pS.d=this._formatData(pS.d),pS.tx=this._formatData(pS.tx),pS.ty=this._formatData(pS.ty),pP.transformOrigin=pP.webkitTransformOrigin=pP.msTransformOrigin=pP.mozTransformOrigin=pP.oTransformOrigin="0px 0px 0px",pP.transform=pP.webkitTransform=pP.msTransform=pP.mozTransform=pP.oTransform="matrix("+pS.toString()+")",pS.translate(parseInt(pP.left)||0,parseInt(pP.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},ph._formatData=function(ph){return Math.abs(ph)<1e-6?0:Math.abs(1-ph)<.001?0<ph?1:-1:ph},ph.getMousePoint=function(){return pX.TEMP.setTo(this.mouseX,this.mouseY)},ph.repaint=function(){this._repaint=1},ph.parentRepaint=function(){},ph._loop=function(){return this.render(pc.context,0,0),!0},ph._onmouseMove=function(ph){this._mouseMoveTime=pw.now()},ph.getTimeFromFrameStart=function(){return pw.now()-this._frameStartTime},ph.render=function(ph,pq,pf){if("sleep"===this._frameRate&&!pc.isConchApp){var pg=pw.now();if(!(1e3<=pg-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(pZ.loopCount++,pL.instance.runEvent(),pt.timer._update()));this._frameStartTime=pg}if(this._renderCount++,pc.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=pw.now();var p$="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),pP=this._renderCount%2==0;if(pZ.renderSlow=!p$,p$||pP||pc.isConchApp){var pS;pZ.loopCount++,pL.instance.runEvent(),pt.timer._update(),pd.update3DLoop();var pB=0,pr=0;if(pc.isConchNode)for(pB=0,pr=this._scenes.length;pB<pr;pB++)(pS=this._scenes[pB])&&pS._updateSceneConch();else for(pB=0,pr=this._scenes.length;pB<pr;pB++)(pS=this._scenes[pB])&&pS._updateScene();if(pc.isConchNode){var pY=pUh.CustomList;for(pB=0,pr=pY.length;pB<pr;pB++){var pC=pY[pB];pC.customRender(pC.customContext,0,0)}return}}pc.isConchNode||this.renderingEnabled&&(p$||!pP||pc.isConchWebGL)&&(pc.isWebGL?pc.WebGL.mainContext&&!pc.WebGL.mainContext.isContextLost()&&(ph.clear(),pU.prototype.render.call(this,ph,pq,pf),pZ._show&&pZ._sp&&pZ._sp.render(ph,pq,pf),pd.clear(this._bgColor),pd.beginFlush(),ph.flush(),pd.endFinish(),pj.instance&&pj.getInstance().endDispose()):(pd.clear(this._bgColor),pU.prototype.render.call(this,ph,pq,pf),pZ._show&&pZ._sp&&pZ._sp.render(ph,pq,pf)))}else this._renderCount%5==0&&(pZ.loopCount++,pL.instance.runEvent(),pt.timer._update())},ph._requestFullscreen=function(){var ph=pw.document.documentElement;ph.requestFullscreen?ph.requestFullscreen():ph.mozRequestFullScreen?ph.mozRequestFullScreen():ph.webkitRequestFullscreen?ph.webkitRequestFullscreen():ph.msRequestFullscreen&&ph.msRequestFullscreen()},ph._fullScreenChanged=function(){pt.stage.event("fullscreenchange")},ph.exitFullscreen=function(){var ph=pw.document;ph.exitFullscreen?ph.exitFullscreen():ph.mozCancelFullScreen?ph.mozCancelFullScreen():ph.webkitExitFullscreen&&ph.webkitExitFullscreen()},pC(0,ph,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),pC(0,ph,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),pC(0,ph,"frameRate",function(){return this._frameRate},function(ph){if(this._frameRate=ph,pc.isConchApp)switch(this._frameRate){case"slow":pw.window.conch&&pw.window.conchConfig.setSlowFrame&&pw.window.conchConfig.setSlowFrame(!0);break;case"fast":pw.window.conch&&pw.window.conchConfig.setSlowFrame&&pw.window.conchConfig.setSlowFrame(!1);break;case"mouse":pw.window.conch&&pw.window.conchConfig.setMouseFrame&&pw.window.conchConfig.setMouseFrame(2e3);break;case"sleep":pw.window.conch&&pw.window.conchConfig.setLimitFPS&&pw.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),pC(0,ph,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),pC(0,ph,"width",pU.prototype._$get_width,function(ph){this.designWidth=ph,pt.superSet(pUh,this,"width",ph),pt.timer.callLater(this,this._changeCanvasSize)}),pC(0,ph,"alignH",function(){return this._alignH},function(ph){this._alignH=ph,pt.timer.callLater(this,this._changeCanvasSize)}),pC(0,ph,"isFocused",function(){return this._isFocused}),pC(0,ph,"height",pU.prototype._$get_height,function(ph){this.designHeight=ph,pt.superSet(pUh,this,"height",ph),pt.timer.callLater(this,this._changeCanvasSize)}),pC(0,ph,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||pb.create()},pU.prototype._$set_transform),pC(0,ph,"isVisibility",function(){return this._isVisibility}),pC(0,ph,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),pC(0,ph,"scaleMode",function(){return this._scaleMode},function(ph){this._scaleMode=ph,pt.timer.callLater(this,this._changeCanvasSize)}),pC(0,ph,"alignV",function(){return this._alignV},function(ph){this._alignV=ph,pt.timer.callLater(this,this._changeCanvasSize)}),pC(0,ph,"bgColor",function(){return this._bgColor},function(ph){this._bgColor=ph,this.conchModel&&this.conchModel.bgColor(ph),pc.isWebGL&&(ph?pS._wgColor=ps.create(ph)._color:pw.onMiniGame||(pS._wgColor=null)),pw.onLimixiu?pS._wgColor=ps.create(ph)._color:pc.canvas.style.background=ph||"none"}),pC(0,ph,"mouseX",function(){return Math.round(pL.instance.mouseX/this.clientScaleX)}),pC(0,ph,"mouseY",function(){return Math.round(pL.instance.mouseY/this.clientScaleY)}),pC(0,ph,"screenMode",function(){return this._screenMode},function(ph){this._screenMode=ph}),pC(0,ph,"visible",pU.prototype._$get_visible,function(ph){this.visible!==ph&&(pt.superSet(pUh,this,"visible",ph),pc._mainCanvas.source.style.visibility=ph?"visible":"hidden")}),pC(0,ph,"fullScreenEnabled",null,function(ph){var pq=pw.document,pf=pc.canvas;ph?(pf.addEventListener("mousedown",this._requestFullscreen),pf.addEventListener("touchstart",this._requestFullscreen),pq.addEventListener("fullscreenchange",this._fullScreenChanged),pq.addEventListener("mozfullscreenchange",this._fullScreenChanged),pq.addEventListener("webkitfullscreenchange",this._fullScreenChanged),pq.addEventListener("msfullscreenchange",this._fullScreenChanged)):(pf.removeEventListener("mousedown",this._requestFullscreen),pf.removeEventListener("touchstart",this._requestFullscreen),pq.removeEventListener("fullscreenchange",this._fullScreenChanged),pq.removeEventListener("mozfullscreenchange",this._fullScreenChanged),pq.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),pq.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),pS.SCALE_NOSCALE="noscale",pS.SCALE_EXACTFIT="exactfit",pS.SCALE_SHOWALL="showall",pS.SCALE_NOBORDER="noborder",pS.SCALE_FULL="full",pS.SCALE_FIXED_WIDTH="fixedwidth",pS.SCALE_FIXED_HEIGHT="fixedheight",pS.SCALE_FIXED_AUTO="fixedauto",pS.ALIGN_LEFT="left",pS.ALIGN_RIGHT="right",pS.ALIGN_CENTER="center",pS.ALIGN_TOP="top",pS.ALIGN_MIDDLE="middle",pS.ALIGN_BOTTOM="bottom",pS.SCREEN_NONE="none",pS.SCREEN_HORIZONTAL="horizontal",pS.SCREEN_VERTICAL="vertical",pS.FRAME_FAST="fast",pS.FRAME_SLOW="slow",pS.FRAME_MOUSE="mouse",pS.FRAME_SLEEP="sleep",pS.FRAME_MOUSE_THREDHOLD=2e3,pr(pS,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),pS}(pUh),pNh=(function(ph){function pq(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,pq.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}pe(pq,"laya.media.SoundNode",pUh);var pf=pq.prototype;pf._onParentChange=function(){this.target=this.parent},pf.play=function(ph,pq){void 0===ph&&(ph=1),isNaN(ph)&&(ph=1),this.url&&(this.stop(),this._channel=pA.playSound(this.url,ph,null,pq))},pf.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},pf._setPlayAction=function(ph,pq,pf,pg){void 0===pg&&(pg=!0),this[pf]&&ph&&(pg?ph.on(pq,this,this[pf]):ph.off(pq,this,this[pf]))},pf._setPlayActions=function(ph,pq,pf,pg){if(void 0===pg&&(pg=!0),ph&&pq){var p$,pP=pq.split(","),pS=0;for(p$=pP.length,pS=0;pS<p$;pS++)this._setPlayAction(ph,pP[pS],pf,pg)}},pC(0,pf,"playEvent",null,function(ph){(this._playEvents=ph)&&this._tar&&this._setPlayActions(this._tar,ph,"play")}),pC(0,pf,"target",null,function(ph){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=ph,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),pC(0,pf,"stopEvent",null,function(ph){(this._stopEvents=ph)&&this._tar&&this._setPlayActions(this._tar,ph,"stop")})}(),function(ph){function pq(){this._src=null,this._onload=null,this._onerror=null,pq.__super.call(this)}pe(pq,"laya.resource.FileBitmap",pLh);var pf=pq.prototype;return pC(0,pf,"src",function(){return this._src},function(ph){this._src=ph}),pC(0,pf,"onload",null,function(ph){}),pC(0,pf,"onerror",null,function(ph){}),pq}()),pGh=function(ph){function pf(ph,pq){this._is2D=!1,pf.__super.call(this);var pg=this;if(this._source=this,"2D"===ph||"AUTO"===ph&&!pc.isWebGL){this._is2D=!0,this._source=pq||pw.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var p$=this;p$.getContext=function(ph,pq){if(pg._ctx)return pg._ctx;var pf=pg._ctx=pg._source.getContext(ph,pq);return pf&&(pf._canvas=p$,pc.isFlash||pw.onLimixiu||(pf.size=function(ph,pq){})),pf}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}pe(pf,"laya.resource.HTMLCanvas",pLh);var pq=pf.prototype;return pq.clear=function(){this._ctx&&this._ctx.clear()},pq.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},pq.release=function(){},pq._setContext=function(ph){this._ctx=ph},pq.getContext=function(ph,pq){return this._ctx?this._ctx:this._ctx=pf._createContext(this)},pq.getMemSize=function(){return 0},pq.size=function(ph,pq){(this._w!=ph||this._h!=pq||this._source&&(this._source.width!=ph||this._source.height!=pq))&&(this._w=ph,this._h=pq,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(ph,pq),this._source&&(this._source.height=pq,this._source.width=ph))},pq.getCanvas=function(){return this._source},pq.toBase64=function(ph,pq,pf){if(this._source)if(pc.isConchApp&&this._source.toBase64)this._source.toBase64(ph,pq,pf);else{var pg=this._source.toDataURL(ph,pq);pf.call(this,pg)}},pC(0,pq,"context",function(){return this._ctx}),pC(0,pq,"asBitmap",null,function(ph){}),pf.create=function(ph,pq){return new pf(ph,pq)},pf.TYPE2D="2D",pf.TYPE3D="3D",pf.TYPEAUTO="AUTO",pf._createContext=null,pf}(),pmh=(function(ph){function pr(ph,pq,pf,pg,p$,pP,pS,pB){throw pr.__super.call(this),new Error("不允许new！")}pe(pr,"laya.resource.HTMLSubImage",pLh),pr.create=function(ph,pq,pf,pg,p$,pP,pS,pB){return void 0===pB&&(pB=!1),new pr(ph,pq,pf,pg,p$,pP,pS,pB)}}(),function(ph){function pU(){this._frames=null,this._url=null,pU.__super.call(this),this._setControlNode(this)}pe(pU,"laya.display.Animation",ph);var pq=pU.prototype;pq.destroy=function(ph){void 0===ph&&(ph=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,ph),this._frames=null,this._labels=null},pq.play=function(ph,pq,pf,pg){void 0===ph&&(ph=0),void 0===pq&&(pq=!0),void 0===pf&&(pf=""),void 0===pg&&(pg=!0),pf&&this._setFramesFromCache(pf,pg),this._isPlaying=!0,this.index="string"==typeof ph?this._getFrameByLabel(ph):ph,this.loop=pq,this._actionName=pf,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},pq._setFramesFromCache=function(ph,pq){var pf;return void 0===pq&&(pq=!1),this._url&&(ph=this._url+"#"+ph),ph&&pU.framesMap[ph]?((pf=pU.framesMap[ph])instanceof Array?(this._frames=pU.framesMap[ph],this._count=this._frames.length):(pf.nodeRoot&&(pU.framesMap[ph]=this._parseGraphicAnimationByData(pf),pf=pU.framesMap[ph]),this._frames=pf.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=pf.interval),this._labels=this._copyLabels(pf.labels)),!0):(pq&&console.log("ani not found:",ph),!1)},pq._copyLabels=function(ph){if(!ph)return null;var pq,pf;for(pf in pq={},ph)pq[pf]=pO.copyArray([],ph[pf]);return pq},pq._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&ph.prototype._frameLoop.call(this)},pq._displayToIndex=function(ph){this._frames&&(this.graphics=this._frames[ph])},pq.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},pq.loadImages=function(ph,pq){return void 0===pq&&(pq=""),this._url="",this._setFramesFromCache(pq)||(this.frames=pU.framesMap[pq]?pU.framesMap[pq]:pU.createFrames(ph,pq)),this},pq.loadAtlas=function(pq,pf,pg){void 0===pg&&(pg=""),this._url="";var p$=this;function ph(ph){pq===ph&&(p$.frames=pU.framesMap[pg]?pU.framesMap[pg]:pU.createFrames(pq,pg),pf&&pf.run())}return p$._setFramesFromCache(pg)||(pBh.getAtlas(pq)?ph(pq):pt.loader.load(pq,pN.create(null,ph,[pq]),null,"atlas")),this},pq.loadAnimation=function(ph,pq,pf){this._url=ph;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,pq&&pq.run()):!pf||pBh.getAtlas(pf)?this._loadAnimationData(ph,pq,pf):pt.loader.load(pf,pN.create(this,this._loadAnimationData,[ph,pq,pf]),null,"atlas"),this},pq._loadAnimationData=function(pB,pr,ph){var pY=this;if(!ph||pBh.getAtlas(ph)){var pC=this;pBh.getRes(pB)?pq(pB):pt.loader.load(pB,pN.create(null,pq,[pB]),null,"json"),pBh.clearRes(pB)}else console.warn("atlas load fail:"+ph);function pq(ph){if(pBh.getRes(ph)&&pB===ph){var pq;if(pU.framesMap[pB+"#"])pC._setFramesFromCache(pY._actionName,!0),pY.index=0,pY._checkResumePlaying();else{var pf=pC._parseGraphicAnimation(pBh.getRes(pB));if(!pf)return;var pg,p$=pf.animationList,pP=0,pS=p$.length;for(pP=0;pP<pS;pP++)pq=p$[pP],pU.framesMap[pB+"#"+pq.name]=pq,pg||(pg=pq);pg&&(pU.framesMap[pB+"#"]=pg,pC._setFramesFromCache(pY._actionName,!0),pY.index=0),pY._checkResumePlaying()}pr&&pr.run()}}},pq._parseGraphicAnimation=function(ph){return pth.parseAnimationData(ph)},pq._parseGraphicAnimationByData=function(ph){return pth.parseAnimationByData(ph)},pC(0,pq,"frames",function(){return this._frames},function(ph){(this._frames=ph)&&(this._count=ph.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),pC(0,pq,"autoPlay",null,function(ph){ph?this.play():this.stop()}),pC(0,pq,"source",null,function(ph){-1<ph.indexOf(".ani")?this.loadAnimation(ph):-1<ph.indexOf(".json")||-1<ph.indexOf("als")||-1<ph.indexOf("atlas")?this.loadAtlas(ph):this.loadImages(ph.split(","))}),pC(0,pq,"autoAnimation",null,function(ph){this.play(0,!0,ph,!1)}),pU.createFrames=function(ph,pq){var pf,pg,p$=0,pP=0;if("string"==typeof ph){var pS=pBh.getAtlas(ph);if(pS&&pS.length)for(pf=[],p$=0,pP=pS.length;p$<pP;p$++)(pg=new pd.createGraphics).drawTexture(pBh.getRes(pS[p$]),0,0),pf.push(pg)}else if(ph instanceof Array)for(pf=[],p$=0,pP=ph.length;p$<pP;p$++)(pg=new pd.createGraphics).loadImage(ph[p$],0,0),pf.push(pg);return pq&&(pU.framesMap[pq]=pf),pf},pU.clearCache=function(ph){var pq,pf=pU.framesMap,pg=ph+"#";for(pq in pf)pq!==ph&&0!=pq.indexOf(pg)||delete pU.framesMap[pq]},pU.framesMap={}}(peh),function(ph){function pP(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,pP.__super.call(this),null==pP._sortIndexFun&&(pP._sortIndexFun=pR.sortByKey("index",!1,!0))}pe(pP,"laya.display.FrameAnimation",ph);var pq=pP.prototype;return pq._setUp=function(ph,pq){this._labels=null,this._animationNewFrames=null,this._targetDic=ph,this._animationData=pq,this.interval=1e3/pq.frameRate,pq.parsed?(this._count=pq.count,this._labels=pq.labels,this._animationNewFrames=pq.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),pq.parsed=!0,pq.labels=this._labels,pq.count=this._count,pq.animationNewFrames=this._animationNewFrames},pq.clear=function(){ph.prototype.clear.call(this),this._targetDic=null,this._animationData=null},pq._displayToIndex=function(ph){if(this._animationData){ph<0&&(ph=0),ph>this._count&&(ph=this._count);var pq=this._animationData.nodes,pf=0,pg=pq.length;for(pf=0;pf<pg;pf++)this._displayNodeToFrame(pq[pf],ph)}},pq._displayNodeToFrame=function(ph,pq,pf){pf||(pf=this._targetDic);var pg=pf[ph.target];if(pg){var p$,pP,pS,pB=ph.frames,pr=ph.keys,pY=0,pC=pr.length;for(pY=0;pY<pC;pY++)pS=(pP=pB[p$=pr[pY]]).length>pq?pP[pq]:pP[pP.length-1],pg[p$]=pS}},pq._calculateDatas=function(){if(this._animationData){var ph,pq=this._animationData.nodes,pf=0,pg=pq.length;for(pf=this._count=0;pf<pg;pf++)ph=pq[pf],this._calculateNodeKeyFrames(ph);this._count+=1}},pq._calculateNodeKeyFrames=function(ph){var pq,pf,pg=ph.keyframes,p$=ph.target;for(pq in ph.frames||(ph.frames={}),ph.keys?ph.keys.length=0:ph.keys=[],ph.initValues||(ph.initValues={}),pg)pf=pg[pq],ph.frames[pq]||(ph.frames[pq]=[]),this._targetDic&&this._targetDic[p$]&&(ph.initValues[pq]=this._targetDic[p$][pq]),pf.sort(pP._sortIndexFun),ph.keys.push(pq),this._calculateNodePropFrames(pf,ph.frames[pq],pq,p$)},pq.resetToInitState=function(){if(this._targetDic&&this._animationData){var ph,pq,pf=this._animationData.nodes,pg=0,p$=pf.length;for(pg=0;pg<p$;pg++)if(pq=(ph=pf[pg]).initValues){var pP,pS=this._targetDic[ph.target];if(pS)for(pP in pq)pS[pP]=pq[pP]}}},pq._calculateNodePropFrames=function(ph,pq,pf,pg){var p$=0,pP=ph.length-1;if(0<pP){for(pq.length=ph[pP].index+1,p$=0;p$<pP;p$++)this._dealKeyFrame(ph[p$]),this._calculateFrameValues(ph[p$],ph[p$+1],pq);this._dealKeyFrame(ph[p$])}0==pP&&(pq[ph[0].index]=ph[0].value,this._animationNewFrames&&(this._animationNewFrames[ph[0].index]=!0))},pq._dealKeyFrame=function(ph){ph.label&&""!=ph.label&&this.addLabel(ph.label,ph.index)},pq._calculateFrameValues=function(ph,pq,pf){var pg,p$=0,pP=ph.index,pS=pq.index,pB=ph.value,pr=pq.value-ph.value,pY=pS-pP;if(pS>this._count&&(this._count=pS),ph.tween)for(null==(pg=pK[ph.tweenMethod])&&(pg=pK.linearNone),p$=pP;p$<pS;p$++)pf[p$]=pg(p$-pP,pB,pr,pY),this._animationNewFrames&&(this._animationNewFrames[p$]=!0);else for(p$=pP;p$<pS;p$++)pf[p$]=pB;this._animationNewFrames&&(this._animationNewFrames[ph.index]=!0,this._animationNewFrames[pq.index]=!0),pf[pq.index]=pq.value},pP._sortIndexFun=null,pP}(peh)),pEh=function(pq){function p$(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",p$.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=plh.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}pe(p$,"laya.display.Input",pq);var ph=p$.prototype;return ph.setSelection=function(ph,pq){this.focus=!0,laya.display.Input.inputElement.selectionStart=ph,laya.display.Input.inputElement.selectionEnd=pq},ph._onUnDisplay=function(ph){this.focus=!1},ph._onMouseDown=function(ph){this.focus=!0},ph._syncInputTransform=function(){var ph=this.nativeInput,pq=pO.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),pf=this._width-this.padding[1]-this.padding[3],pg=this._height-this.padding[0]-this.padding[2];pc.isConchApp?(ph.setScale(pq.scaleX,pq.scaleY),ph.setSize(pf,pg),ph.setPos(pq.x,pq.y)):(p$.inputContainer.style.transform=p$.inputContainer.style.webkitTransform="scale("+pq.scaleX+","+pq.scaleY+") rotate("+pt.stage.canvasDegree+"deg)",ph.style.width=pf+"px",ph.style.height=pg+"px",p$.inputContainer.style.left=pq.x+"px",p$.inputContainer.style.top=pq.y+"px")},ph.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},ph._setInputMethod=function(){p$.input.parentElement&&p$.inputContainer.removeChild(p$.input),p$.area.parentElement&&p$.inputContainer.removeChild(p$.area),p$.inputElement=this._multiline?p$.area:p$.input,p$.inputContainer.appendChild(p$.inputElement),plh.RightToLeft&&(p$.inputElement.style.direction="rtl")},ph._focusIn=function(){laya.display.Input.isInputting=!0;var ph=this.nativeInput;this._focus=!0;var pq=ph.style;pq.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),ph.readOnly=!this._editable,pc.isConchApp&&(ph.setType(this._type),ph.setForbidEdit(!this._editable)),ph.maxLength=this._maxChars;this.padding;if(ph.type=this._type,ph.value=this._content,ph.placeholder=this._prompt,pt.stage.off("keydown",this,this._onKeyDown),pt.stage.on("keydown",this,this._onKeyDown),(pt.stage.focus=this).event("focus"),pw.onPC&&ph.focus(),!pw.onMiniGame){this._text;this._text=null}this.typeset(),ph.setColor(this._originColor),ph.setFontSize(this.fontSize),ph.setFontFace(pw.onIPhone&&plh._fontFamilyMap[this.font]||this.font),pc.isConchApp&&ph.setMultiAble&&ph.setMultiAble(this._multiline),pq.lineHeight=this.leading+this.fontSize+"px",pq.fontStyle=this.italic?"italic":"normal",pq.fontWeight=this.bold?"bold":"normal",pq.textAlign=this.align,pq.padding="0 0",this._syncInputTransform(),!pc.isConchApp&&pw.onPC&&pt.timer.frameLoop(1,this,this._syncInputTransform)},ph._setPromptColor=function(){(p$.promptStyleDOM=pw.getElementById("promptStyle"))||((p$.promptStyleDOM=pw.createElement("style")).setAttribute("id","promptStyle"),pw.document.head.appendChild(p$.promptStyleDOM)),p$.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},ph._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(pt.superSet(plh,this,"text",this._content),pt.superSet(plh,this,"color",this._originColor)):(pt.superSet(plh,this,"text",this._prompt),pt.superSet(plh,this,"color",this._promptColor)),pt.stage.off("keydown",this,this._onKeyDown),pt.stage.focus=null,this.event("blur"),pc.isConchApp&&this.nativeInput.blur(),pw.onPC&&pt.timer.clear(this,this._syncInputTransform)},ph._onKeyDown=function(ph){13===ph.keyCode&&(pw.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},ph.changeText=function(ph){this._content=ph,this._focus?(this.nativeInput.value=ph||"",this.event("change")):pq.prototype.changeText.call(this,ph)},pC(0,ph,"color",pq.prototype._$get_color,function(ph){this._focus&&this.nativeInput.setColor(ph),pt.superSet(plh,this,"color",this._content?ph:this._promptColor),this._originColor=ph}),pC(0,ph,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(ph){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),pC(0,ph,"multiline",function(){return this._multiline},function(ph){this._multiline=ph,this.valign=ph?"top":"middle"}),pC(0,ph,"maxChars",function(){return this._maxChars},function(ph){ph<=0&&(ph=1e5),this._maxChars=ph}),pC(0,ph,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(ph){pt.superSet(plh,this,"color",this._originColor),ph+="",this._focus?(this.nativeInput.value=ph||"",this.event("change")):(this._multiline||(ph=ph.replace(/\r?\n/g,"")),(this._content=ph)?pt.superSet(plh,this,"text",ph):(pt.superSet(plh,this,"text",this._prompt),pt.superSet(plh,this,"color",this.promptColor)))}),pC(0,ph,"nativeInput",function(){return this._multiline?p$.area:p$.input}),pC(0,ph,"prompt",function(){return this._prompt},function(ph){!this._text&&ph&&pt.superSet(plh,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?pt.superSet(plh,this,"text",this._text==this._prompt?ph:this._text):pt.superSet(plh,this,"text",ph),this._prompt=plh.langPacks&&plh.langPacks[ph]?plh.langPacks[ph]:ph}),pC(0,ph,"focus",function(){return this._focus},function(ph){var pq=this.nativeInput;this._focus!==ph&&(ph?(pq.target?pq.target._focusOut():this._setInputMethod(),(pq.target=this)._focusIn()):(pq.target=null,this._focusOut(),pw.document.body.scrollTop=0,pq.blur(),pc.isConchApp?pq.setPos(-1e4,-1e4):p$.inputContainer.contains(pq)&&p$.inputContainer.removeChild(pq)))}),pC(0,ph,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(ph){ph?(-1<(ph="[^"+ph+"]").indexOf("^^")&&(ph=ph.replace("^^","")),this._restrictPattern=new RegExp(ph,"g")):this._restrictPattern=null}),pC(0,ph,"editable",function(){return this._editable},function(ph){this._editable=ph,pc.isConchApp&&p$.input.setForbidEdit(!ph)}),pC(0,ph,"promptColor",function(){return this._promptColor},function(ph){this._promptColor=ph,this._content||pt.superSet(plh,this,"color",ph)}),pC(0,ph,"type",function(){return this._type},function(ph){this._getCSSStyle().password="password"==ph,this._type=ph,pc.isConchApp&&this.nativeInput.setType(ph)}),pC(0,ph,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(ph){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),pC(0,ph,"asPassword",function(){return this._getCSSStyle().password},function(ph){this._getCSSStyle().password=ph,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),p$.__init__=function(){p$._createInputElement(),pw.onMobile&&pc.canvas.addEventListener(p$.IOS_IFRAME?pw.onMiniGame?"touchend":"click":"touchend",p$._popupInputMethod)},p$._popupInputMethod=function(ph){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},p$._createInputElement=function(){p$._initInput(p$.area=pw.createElement("textarea")),p$._initInput(p$.input=pw.createElement("input")),(p$.inputContainer=pw.createElement("div")).style.position="absolute",p$.inputContainer.style.zIndex=1e5,pw.container.appendChild(p$.inputContainer),p$.inputContainer.setPos=function(ph,pq){p$.inputContainer.style.left=ph+"px",p$.inputContainer.style.top=pq+"px"}},p$._initInput=function(pq){var ph=pq.style;ph.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",ph.resize="none",ph.backgroundColor="transparent",ph.border="none",ph.outline="none",ph.zIndex=1,pq.addEventListener("input",p$._processInputting),pq.addEventListener("mousemove",p$._stopEvent),pq.addEventListener("mousedown",p$._stopEvent),pq.addEventListener("touchmove",p$._stopEvent),pq.setFontFace=function(ph){pq.style.fontFamily=ph},pc.isConchApp||(pq.setColor=function(ph){pq.style.color=ph},pq.setFontSize=function(ph){pq.style.fontSize=ph+"px"})},p$._processInputting=function(ph){var pq=laya.display.Input.inputElement.target;if(pq){var pf=laya.display.Input.inputElement.value;pq._restrictPattern&&(pf=pf.replace(/\u2006|\x27/g,""),pq._restrictPattern.test(pf)&&(pf=pf.replace(pq._restrictPattern,""),laya.display.Input.inputElement.value=pf)),pq._text=pf,pq.event("input")}},p$._stopEvent=function(ph){"touchmove"==ph.type&&ph.preventDefault(),ph.stopPropagation&&ph.stopPropagation()},p$.TYPE_TEXT="text",p$.TYPE_PASSWORD="password",p$.TYPE_EMAIL="email",p$.TYPE_URL="url",p$.TYPE_NUMBER="number",p$.TYPE_RANGE="range",p$.TYPE_DATE="date",p$.TYPE_MONTH="month",p$.TYPE_WEEK="week",p$.TYPE_TIME="time",p$.TYPE_DATE_TIME="datetime",p$.TYPE_DATE_TIME_LOCAL="datetime-local",p$.TYPE_SEARCH="search",p$.input=null,p$.area=null,p$.inputElement=null,p$.inputContainer=null,p$.confirmButton=null,p$.promptStyleDOM=null,p$.inputHeight=45,p$.isInputting=!1,p$.stageMatrix=null,pr(p$,["IOS_IFRAME",function(){return this.IOS_IFRAME=pw.onIOS&&pw.window.top!=pw.window.self}]),p$}(plh),pRh=function(ph){function pf(ph,pq){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,pf.__super.call(this),ph&&this._init_(ph,pq)}pe(pf,"laya.resource.HTMLImage",pNh);var pq=pf.prototype;return pq._init_=function(ph,pq){this._src=ph,this._source=new pw.window.Image,pq&&(pq.onload&&(this.onload=pq.onload),pq.onerror&&(this.onerror=pq.onerror),pq.onCreate&&pq.onCreate(this)),0!=ph.indexOf("data:image")&&(this._source.crossOrigin=""),ph&&(this._source.src=ph)},pq.recreateResource=function(){var ph=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var pq=this;this._source=new pw.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(pq._needReleaseAgain)return pq._needReleaseAgain=!1,pq._source.onload=null,void(pq._source=null);pq._source.onload=null,pq.memorySize=ph._w*ph._h*4,pq._recreateLock=!1,pq.completeCreate()},this._source.src=this._src}},pq.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},pq.onresize=function(){this._w=this._source.width,this._h=this._source.height},pC(0,pq,"onload",null,function(ph){var pq=this;this._onload=ph,this._source&&(this._source.onload=null!=this._onload?function(){pq.onresize(),pq._onload()}:null)}),pC(0,pq,"onerror",null,function(ph){var pq=this;this._onerror=ph,this._source&&(this._source.onerror=null!=this._onerror?function(){pq._onerror()}:null)}),pC(0,pq,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(ph){this._enableMerageInAtlas=ph,pc.isConchApp&&this._source&&(this._source.enableMerageInAtlas=ph)}),pf.create=function(ph,pq){return new pf(ph,pq)},pf}(),pth=(function(pP){function ph(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,ph.__super.call(this)}pe(ph,"laya.display.EffectAnimation",pP);var pq=ph.prototype;pq._onOtherBegin=function(ph){ph!=this&&this.stop()},pq.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},pq._onPlayAction=function(){this.play(0,!1)},pq.play=function(ph,pq,pf,pg){void 0===ph&&(ph=0),void 0===pq&&(pq=!0),void 0===pf&&(pf=""),void 0===pg&&(pg=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,ph,pq,pf,pg))},pq._recordInitData=function(){if(this._aniKeys){var ph,pq,pf=0;for(ph=this._aniKeys.length,pf=0;pf<ph;pf++)pq=this._aniKeys[pf],this._initData[pq]=this._target[pq]}},pq._displayToIndex=function(ph){if(this._animationData){ph<0&&(ph=0),ph>this._count&&(ph=this._count);var pq=this._animationData.nodes,pf=0,pg=pq.length;for(pg=1<pg?1:pg,pf=0;pf<pg;pf++)this._displayNodeToFrame(pq[pf],ph)}},pq._displayNodeToFrame=function(ph,pq,pf){if(this._target){var pg;pg=this._target;var p$,pP,pS,pB,pr=ph.frames,pY=ph.keys,pC=0,pU=pY.length;pB=ph.secondFrames;var pu,pv,pL,pe,pl=0;for(pC=0;pC<pU;pC++)pP=pr[p$=pY[pC]],pS=-1==(pl=pB[p$])?this._initData[p$]:pq<pl?(pL=(pv=ph.keyframes[p$])[0]).tween?(null==(pu=pK[pL.tweenMethod])&&(pu=pK.linearNone),pe=pv[1],pu(pq,this._initData[p$],pe.value-this._initData[p$],pe.index)):this._initData[p$]:pP.length>pq?pP[pq]:pP[pP.length-1],pg[p$]=pS}},pq._calculateNodeKeyFrames=function(ph){pP.prototype._calculateNodeKeyFrames.call(this,ph);var pq,pf,pg,p$=ph.keyframes;ph.target;for(pq in pg={},ph.secondFrames=pg,p$)(pf=p$[pq]).length<=1?pg[pq]=-1:pg[pq]=pf[1].index},pC(0,pq,"target",function(){return this._target},function(ph){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=ph,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),pC(0,pq,"playEvent",null,function(ph){(this._playEvents=ph)&&this.addEvent()}),pC(0,pq,"effectData",null,function(ph){var pq;ph&&((pq=ph.animations)&&pq[0]&&(this._setUp({},pq[0]),pq[0].nodes&&pq[0].nodes[0]&&(this._aniKeys=pq[0].nodes[0].keys)))}),pC(0,pq,"effectClass",null,function(ph){var pq,pf;(this._effectClass=pD.getClass(ph),this._effectClass)&&((pq=this._effectClass.uiView)&&(pf=pq.animations)&&pf[0]&&(this._setUp({},pf[0]),pf[0].nodes&&pf[0].nodes[0]&&(this._aniKeys=pf[0].nodes[0].keys)))}),ph.EffectAnimationBegin="effectanimationbegin"}(pmh),function(pq){var pp;function pA(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,pA.__super.call(this)}pe(pA,"laya.utils.GraphicAnimation",pq);var ph=pA.prototype;return ph._parseNodeList=function(ph){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[ph.compId]=ph.props,ph.compId&&this._nodeList.push(ph.compId);var pq=ph.child;if(pq){var pf=0,pg=pq.length;for(pf=0;pf<pg;pf++)this._parseNodeList(pq[pf])}},ph._calGraphicData=function(ph){var pq;if(this._setUp(null,ph),this._createGraphicData(),this._nodeIDAniDic)for(pq in this._nodeIDAniDic)this._nodeIDAniDic[pq]=null},ph._createGraphicData=function(){var ph,pq=[],pf=0,pg=this.count,p$=this._animationNewFrames;for(p$||(p$=[]),pf=0;pf<pg;pf++)!p$[pf]&&ph||(ph=this._createFrameGraphic(pf)),pq.push(ph);this._gList=pq},ph._createFrameGraphic=function(ph){var pq=pd.createGraphics();return pA._rootMatrix||(pA._rootMatrix=new pb),this._updateNodeGraphic(this._rootNode,ph,pA._rootMatrix,pq),pq},ph._updateNodeGraphic=function(ph,pq,pf,pg,p$){var pP;void 0===p$&&(p$=1);var pS,pB,pr,pY=(pP=this._nodeGDic[ph.compId]=this._getNodeGraphicData(ph.compId,pq,this._nodeGDic[ph.compId])).alpha*p$;if(!(pY<.01)&&(pP.resultTransform||(pP.resultTransform=pb.create()),pS=pP.resultTransform,pb.mul(pP.transform,pf,pS),pP.skin&&(pB=this._getTextureByUrl(pP.skin))&&(pS._checkTransform()?(pg.drawTexture(pB,0,0,pP.width,pP.height,pS,pY),pP.resultTransform=null):pg.drawTexture(pB,pS.tx,pS.ty,pP.width,pP.height,null,pY)),pr=ph.child)){var pC,pU=0;for(pC=pr.length,pU=0;pU<pC;pU++)this._updateNodeGraphic(pr[pU],pq,pS,pg,pY)}},ph._updateNoChilds=function(ph,pq){if(ph.skin){var pf=this._getTextureByUrl(ph.skin);if(pf){var pg=ph.transform;pg._checkTransform();!pg.bTransform?pq.drawTexture(pf,pg.tx,pg.ty,ph.width,ph.height,null,ph.alpha):pq.drawTexture(pf,0,0,ph.width,ph.height,pg.clone(),ph.alpha)}}},ph._updateNodeGraphic2=function(ph,pq,pf){var pg;if(pg=this._nodeGDic[ph.compId]=this._getNodeGraphicData(ph.compId,pq,this._nodeGDic[ph.compId]),ph.child){var p$=pg.transform;p$._checkTransform();var pP,pS;pS=(pP=!p$.bTransform)&&(0!=p$.tx||0!=p$.ty);var pB,pr,pY;if((pB=p$.bTransform||1!=pg.alpha)&&pf.save(),1!=pg.alpha&&pf.alpha(pg.alpha),pP?pS&&pf.translate(p$.tx,p$.ty):pf.transform(p$.clone()),pr=ph.child,pg.skin&&(pY=this._getTextureByUrl(pg.skin))&&pf.drawTexture(pY,0,0,pg.width,pg.height),pr){var pC,pU=0;for(pC=pr.length,pU=0;pU<pC;pU++)this._updateNodeGraphic2(pr[pU],pq,pf)}pB?pf.restore():pP?pS&&pf.translate(-p$.tx,-p$.ty):pf.transform(p$.clone().invert())}else this._updateNoChilds(pg,pf)},ph._calculateNodeKeyFrames=function(ph){pq.prototype._calculateNodeKeyFrames.call(this,ph),this._nodeIDAniDic[ph.target]=ph},ph.getNodeDataByID=function(ph){return this._nodeIDAniDic[ph]},ph._getParams=function(ph,pq,pf,pg){var p$=pA._temParam;p$.length=pq.length;var pP=0,pS=pq.length;for(pP=0;pP<pS;pP++)p$[pP]=this._getObjVar(ph,pq[pP][0],pf,pq[pP][1],pg);return p$},ph._getObjVar=function(ph,pq,pf,pg,p$){if(ph.hasOwnProperty(pq)){var pP=ph[pq];if(pf>=pP.length&&(pf=pP.length-1),null!=ph[pq][pf])return ph[pq][pf]}return p$.hasOwnProperty(pq)?p$[pq]:pg},ph._getNodeGraphicData=function(ph,pq,pf){pf||(pf=pp.create()),pf.transform?pf.transform.identity():pf.transform=pb.create();var pg=this.getNodeDataByID(ph);if(!pg)return pf;var p$,pP,pS=pg.frames,pB=this._getParams(pS,pA._drawTextureCmd,pq,this._nodeDefaultProps[ph]),pr=pB[0],pY=NaN,pC=NaN,pU=pB[5],pu=pB[6],pv=pB[13],pL=pB[14],pe=pB[7],pl=pB[8],p_=pB[9],pN=pB[11],pG=pB[12];pY=pB[3],pC=pB[4],0!=pY&&0!=pC||(pr=null),-1==pY&&(pY=0),-1==pC&&(pC=0),pf.skin=pr,pf.width=pY,pf.height=pC,pr&&((p$=this._getTextureByUrl(pr))?(pY||(pY=p$.sourceWidth),pC||(pC=p$.sourceHeight)):console.warn("lost skin:",pr,",you may load pics first")),pf.alpha=pB[10],pP=pf.transform,0!=pv&&(pU=pv*pY),0!=pL&&(pu=pL*pC),0==pU&&0==pu||pP.translate(-pU,-pu);var pm=null;if(p_||1!==pe||1!==pl||pN||pG){(pm=pA._tempMt).identity(),pm.bTransform=!0;var pE=.0174532922222222*(p_-pN),pR=.0174532922222222*(p_+pG),pt=Math.cos(pR),pX=Math.sin(pR),pn=Math.sin(pE),pJ=Math.cos(pE);pm.a=pe*pt,pm.b=pe*pX,pm.c=-pl*pn,pm.d=pl*pJ,pm.tx=pm.ty=0}return pm&&(pP=pb.mul(pP,pm,pP)),pP.translate(pB[1],pB[2]),pf},ph._getTextureByUrl=function(ph){return pBh.getRes(ph)},ph.setAniData=function(ph,pq){if(ph.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=ph,this._parseNodeList(ph);var pf,pg={},p$=[],pP=ph.animations,pS=0,pB=pP.length;for(pS=0;pS<pB;pS++)if(pf=pP[pS],this._labels=null,(!pq||pq==pf.name)&&pf){try{this._calGraphicData(pf)}catch(ph){console.warn("parse animation fail:"+pf.name+",empty animation created"),this._gList=[]}var pr={};pr.interval=1e3/pf.frameRate,pr.frames=this._gList,pr.labels=this._labels,pr.name=pf.name,p$.push(pr),pg[pf.name]=pr}this.animationList=p$,this.animationDic=pg}pA._temParam.length=0},ph.parseByData=function(ph){var pq,pf;pq=ph.nodeRoot,pf=ph.aniO,delete ph.nodeRoot,delete ph.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=pq,this._parseNodeList(pq),this._labels=null;try{this._calGraphicData(pf)}catch(ph){console.warn("parse animation fail:"+pf.name+",empty animation created"),this._gList=[]}var pg=ph;return pg.interval=1e3/pf.frameRate,pg.frames=this._gList,pg.labels=this._labels,pg.name=pf.name,pg},ph.setUpAniData=function(ph){if(ph.animations){var pq,pf={},pg=[],p$=ph.animations,pP=0,pS=p$.length;for(pP=0;pP<pS;pP++)if(pq=p$[pP]){var pB={};pB.name=pq.name,pB.aniO=pq,pB.nodeRoot=ph,pg.push(pB),pf[pq.name]=pB}this.animationList=pg,this.animationDic=pf}},ph._clear=function(){var ph,pq;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(ph in this._nodeGDic)(pq=this._nodeGDic[ph])&&pq.recover();this._nodeGDic=null},pA.parseAnimationByData=function(ph){var pq;return pA._I||(pA._I=new pA),pq=pA._I.parseByData(ph),pA._I._clear(),pq},pA.parseAnimationData=function(ph){var pq;return pA._I||(pA._I=new pA),pA._I.setUpAniData(ph),(pq={}).animationList=pA._I.animationList,pq.animationDic=pA._I.animationDic,pA._I._clear(),pq},pA._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],pA._temParam=[],pA._I=null,pA._rootMatrix=null,pr(pA,["_tempMt",function(){return this._tempMt=new pb}]),pA.__init$=function(){pp=function(){function ph(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return pe(ph,""),ph.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),pF.recover("GraphicNode",this)},ph.create=function(){return pF.getItemByClass("GraphicNode",ph)},ph}()},pA}(pmh));pt.__init([pY,prh,pc,pw,pQ,pJ,ph,pth])}(window,document,Laya),function(ph,pq,pf){pf.un,pf.uns,pf.static;var pg=pf.class;pf.getset,pf.__newvec;new(function(){function ph(){}return pg(ph,"LayaMain"),ph}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ph,pq){"use strict";for(var pf in Object.defineProperty(pq,"__esModule",{value:!0}),Laya){var pg=Laya[pf];pg&&pg.__isclass&&(pq[pf]=pg)}}),function(ph,pq,pR){pR.un,pR.uns;var pS=pR.static,pu=pR.class,pg=pR.getset,pP=pR.__newvec,pC=laya.maths.Arith,pU=laya.maths.Bezier,pf=laya.resource.Bitmap,pv=laya.utils.Browser,pr=laya.utils.Byte,pL=laya.utils.Color,pt=(laya.filters.ColorFilter,pR.Config),p$=laya.resource.Context,pX=(laya.events.Event,laya.filters.Filter),pB=laya.display.Graphics,pY=laya.resource.HTMLCanvas,pe=(laya.utils.HTMLChar,laya.resource.HTMLImage),pl=laya.resource.HTMLSubImage,pn=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),pJ=laya.maths.Point,pp=laya.maths.Rectangle,p_=laya.renders.Render,pN=(laya.renders.RenderContext,laya.renders.RenderSprite),pG=laya.resource.Resource,pm=laya.resource.ResourceManager,pE=laya.utils.RunDriver,pA=laya.display.Sprite,pd=laya.display.Stage,pb=laya.utils.Stat,pi=laya.utils.StringKey,pz=(laya.display.css.Style,laya.system.System),pc=laya.display.Text,pM=laya.resource.Texture,pW=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),pT=laya.utils.VectorGraphManager;laya.utils.WordText;pR.interface("laya.webgl.shapes.IShape"),pR.interface("laya.webgl.submit.ISubmit"),pR.interface("laya.webgl.text.ICharSegment"),pR.interface("laya.webgl.canvas.save.ISaveData"),pR.interface("laya.webgl.resource.IMergeAtlasBitmap"),pR.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var pI=function(){function ph(){}pu(ph,"laya.filters.webgl.FilterActionGL");var pq=ph.prototype;return pR.imps(pq,{"laya.filters.IFilterActionGL":!0}),pq.setValue=function(ph){},pq.setValueMix=function(ph){},pq.apply3d=function(ph,pq,pf,pg,p$){return null},pq.apply=function(ph){return null},pg(0,pq,"typeMix",function(){return 0}),ph}(),pw=function(){function ph(){}return pu(ph,"laya.webgl.shader.ShaderValue"),ph}(),pk=function(){var pg,p$;function ph(ph,pq,pf){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new p$,void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),this._cells=null,this._rowInfo=null,this._init(ph,pq),this._atlasID=pf}pu(ph,"laya.webgl.atlas.AtlasGrid");var pq=ph.prototype;return pq.getAltasID=function(){return this._atlasID},pq.setAltasID=function(ph){0<=ph&&(this._atlasID=ph)},pq.addTex=function(ph,pq,pf){var pg=this._get(pq,pf);return 0==pg.ret||(this._fill(pg.x,pg.y,pq,pf,ph),this._texCount++),pg},pq._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},pq._init=function(ph,pq){if(this._width=ph,this._height=pq,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=pP(this._height);for(var pf=0;pf<this._height;pf++)this._rowInfo[pf]=new pg;return this._clear(),!0},pq._get=function(ph,pq){var pf=new pD;if(ph>=this._failSize.width&&pq>=this._failSize.height)return pf;for(var pg=-1,p$=-1,pP=this._width,pS=this._height,pB=this._cells,pr=0;pr<pS;pr++)if(!(this._rowInfo[pr].spaceCount<ph))for(var pY=0;pY<pP;){var pC=3*(pr*pP+pY);if(0!=pB[pC]||pB[1+pC]<ph||pB[2+pC]<pq)pY+=pB[1+pC];else{pg=pY,p$=pr;for(var pU=0;pU<ph;pU++)if(pB[3*pU+pC+2]<pq){pg=-1;break}if(!(pg<0))return pf.ret=!0,pf.x=pg,pf.y=p$,pf;pY+=pB[1+pC]}}return pf},pq._fill=function(ph,pq,pf,pg,p$){var pP=this._width,pS=this._height;this._check(ph+pf<=pP&&pq+pg<=pS);for(var pB=pq;pB<pg+pq;++pB){this._check(this._rowInfo[pB].spaceCount>=pf),this._rowInfo[pB].spaceCount-=pf;for(var pr=0;pr<pf;pr++){var pY=3*(ph+pB*pP+pr);this._check(0==this._cells[pY]),this._cells[pY]=p$,this._cells[1+pY]=pf,this._cells[2+pY]=pg}}if(0<ph)for(pB=0;pB<pg;++pB){var pC=0;for(pr=ph-1;0<=pr&&0==this._cells[3*((pq+pB)*pP+pr)];--pr,++pC);for(pr=pC;0<pr;--pr)this._cells[3*((pq+pB)*pP+ph-pr)+1]=pr,this._check(0<pr)}if(0<pq)for(pr=ph;pr<ph+pf;++pr){for(pC=0,pB=pq-1;0<=pB&&0==this._cells[3*(pr+pB*pP)];--pB,pC++);for(pB=pC;0<pB;--pB)this._cells[3*(pr+(pq-pB)*pP)+2]=pB,this._check(0<pB)}},pq._check=function(ph){0==ph&&console.log("xtexMerger 错误啦")},pq._clear=function(){for(var ph=this._texCount=0;ph<this._height;ph++)this._rowInfo[ph].spaceCount=this._width;for(var pq=0;pq<this._height;pq++)for(var pf=0;pf<this._width;pf++){var pg=3*(pq*this._width+pf);this._cells[pg]=0,this._cells[1+pg]=this._width-pf,this._cells[2+pg]=this._width-pq}this._failSize.width=this._width+1,this._failSize.height=this._height+1},ph.__init$=function(){pg=function(){function ph(){this.spaceCount=0}return pu(ph,""),ph}(),p$=function(){function ph(){this.width=0,this.height=0}return pu(ph,""),ph}()},ph}(),pH=function(){function p_(ph,pq,pf,pg){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=ph,this._height=pq,this._gridSize=pf,this._maxAtlaserCount=pg,this._gridNumX=ph/pf,this._gridNumY=pq/pf,this._curAtlasIndex=0,this._atlaserArray=[]}pu(p_,"laya.webgl.atlas.AtlasResourceManager");var ph=p_.prototype;return ph.setAtlasParam=function(ph,pq,pf,pg){if(1==this._setAtlasParam)return p_._sid_=0,this._width=ph,this._height=pq,this._gridSize=pf,this._maxAtlaserCount=pg,this._gridNumX=ph/pf,this._gridNumY=pq/pf,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},ph.pushData=function(ph){var pq,pf=ph.bitmap,pg=-1,p$=null,pP=0,pS=0;for(pP=0,pq=this._atlaserArray.length;pP<pq&&(pS=(this._curAtlasIndex+pP)%pq,-1==(pg=(p$=this._atlaserArray[pS]).findBitmapIsExist(pf)));pP++);if(-1!=pg){var pB=p$.InAtlasWebGLImagesOffsetValue[pg];return pL=pB[0],pe=pB[1],p$.addToAtlas(ph,pL,pe),!0}this._setAtlasParam=!1;for(var pr=Math.ceil((ph.bitmap.width+2)/this._gridSize),pY=Math.ceil((ph.bitmap.height+2)/this._gridSize),pC=!1,pU=0;pU<2;pU++){var pu=this._maxAtlaserCount;for(pP=0;pP<pu;pP++){pS=(this._curAtlasIndex+pP)%pu,this._atlaserArray.length-1>=pS||this._atlaserArray.push(new pph(this._gridNumX,this._gridNumY,this._width,this._height,p_._sid_++));var pv=this._atlaserArray[pS],pL=0,pe=0,pl=pv.addTex(1,pr,pY);if(pl.ret){pL=pl.x*this._gridSize+1,pe=pl.y*this._gridSize+1,pf.lock=!0,pv.addToAtlasTexture(pf,pL,pe),pv.addToAtlas(ph,pL,pe),pC=!0,this._curAtlasIndex=pS;break}}if(pC)break;this._atlaserArray.push(new pph(this._gridNumX,this._gridNumY,this._width,this._height,p_._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return pC||console.log(">>>AtlasManager pushData error"),pC},ph.addToAtlas=function(ph){laya.webgl.atlas.AtlasResourceManager.instance.pushData(ph)},ph.garbageCollection=function(){if(!0===this._needGC){for(var ph=this._atlaserArray.length-this._maxAtlaserCount,pq=0;pq<ph;pq++)this._atlaserArray[pq].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+ph),this._atlaserArray.splice(0,ph),this._needGC=!1}return!0},ph.freeAll=function(){for(var ph=0,pq=this._atlaserArray.length;ph<pq;ph++)this._atlaserArray[ph].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},ph.getAtlaserCount=function(){return this._atlaserArray.length},ph.getAtlaserByIndex=function(ph){return this._atlaserArray[ph]},pg(1,p_,"instance",function(){return p_._Instance||(p_._Instance=new p_(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),p_._Instance}),pg(1,p_,"enabled",function(){return pt.atlasEnable}),pg(1,p_,"atlasLimitWidth",function(){return p_._atlasLimitWidth},function(ph){p_._atlasLimitWidth=ph}),pg(1,p_,"atlasLimitHeight",function(){return p_._atlasLimitHeight},function(ph){p_._atlasLimitHeight=ph}),p_._enable=function(){pt.atlasEnable=!0},p_._disable=function(){pt.atlasEnable=!1},p_.__init__=function(){p_.atlasTextureWidth=2048,p_.atlasTextureHeight=2048,p_.maxTextureCount=6,p_.atlasLimitWidth=512,p_.atlasLimitHeight=512},p_._atlasLimitWidth=0,p_._atlasLimitHeight=0,p_.gridSize=16,p_.atlasTextureWidth=0,p_.atlasTextureHeight=0,p_.maxTextureCount=0,p_._atlasRestore=0,p_.BOARDER_TYPE_NO=0,p_.BOARDER_TYPE_RIGHT=1,p_.BOARDER_TYPE_LEFT=2,p_.BOARDER_TYPE_BOTTOM=4,p_.BOARDER_TYPE_TOP=8,p_.BOARDER_TYPE_ALL=15,p_._sid_=0,p_._Instance=null,p_}(),pD=function(){function ph(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return pu(ph,"laya.webgl.atlas.MergeFillInfo"),ph}(),ps=function(){function pq(){}return pu(pq,"laya.webgl.canvas.BlendMode"),pq._init_=function(ph){pq.fns=[pq.BlendNormal,pq.BlendAdd,pq.BlendMultiply,pq.BlendScreen,pq.BlendOverlay,pq.BlendLight,pq.BlendMask,pq.BlendDestinationOut],pq.targetFns=[pq.BlendNormalTarget,pq.BlendAddTarget,pq.BlendMultiplyTarget,pq.BlendScreenTarget,pq.BlendOverlayTarget,pq.BlendLightTarget,pq.BlendMask,pq.BlendDestinationOut]},pq.BlendNormal=function(ph){ph.blendFunc(1,771)},pq.BlendAdd=function(ph){ph.blendFunc(1,772)},pq.BlendMultiply=function(ph){ph.blendFunc(774,771)},pq.BlendScreen=function(ph){ph.blendFunc(1,1)},pq.BlendOverlay=function(ph){ph.blendFunc(1,769)},pq.BlendLight=function(ph){ph.blendFunc(1,1)},pq.BlendNormalTarget=function(ph){ph.blendFunc(1,771)},pq.BlendAddTarget=function(ph){ph.blendFunc(1,772)},pq.BlendMultiplyTarget=function(ph){ph.blendFunc(774,771)},pq.BlendScreenTarget=function(ph){ph.blendFunc(1,1)},pq.BlendOverlayTarget=function(ph){ph.blendFunc(1,769)},pq.BlendLightTarget=function(ph){ph.blendFunc(1,1)},pq.BlendMask=function(ph){ph.blendFunc(0,770)},pq.BlendDestinationOut=function(ph){ph.blendFunc(0,0)},pq.activeBlendFunction=null,pq.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],pq.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},pq.NORMAL="normal",pq.ADD="add",pq.MULTIPLY="multiply",pq.SCREEN="screen",pq.LIGHT="light",pq.OVERLAY="overlay",pq.DESTINATIONOUT="destination-out",pq.fns=[],pq.targetFns=[],pq}(),pV=function(){function pf(ph){this._color=pL.create("black"),this.setValue(ph)}pu(pf,"laya.webgl.canvas.DrawStyle");var ph=pf.prototype;return ph.setValue=function(ph){if(ph){if("string"==typeof ph)return void(this._color=pL.create(ph));if(ph instanceof laya.utils.Color)return void(this._color=ph)}},ph.reset=function(){this._color=pL.create("black")},ph.equal=function(ph){return"string"==typeof ph?this._color.strColor===ph:ph instanceof laya.utils.Color&&this._color.numColor===ph.numColor},ph.toColorStr=function(){return this._color.strColor},pf.create=function(ph){var pq;if(ph&&("string"==typeof ph?pq=pL.create(ph):ph instanceof laya.utils.Color&&(pq=ph),pq))return pq._drawStyle||(pq._drawStyle=new pf(ph));return laya.webgl.canvas.DrawStyle.DEFAULT},pS(pf,["DEFAULT",function(){return this.DEFAULT=new pf("#000000")}]),pf}(),pK=function(){function ph(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];pmh.mainContext;this.ib=pxh.create(35048),this.vb=pah.create(5)}pu(ph,"laya.webgl.canvas.Path");var pq=ph.prototype;return pq.addPoint=function(ph,pq){this.tempArray.push(ph,pq)},pq.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},pq.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},pq.polygon=function(ph,pq,pf,pg,p$,pP){var pS;return this.geomatrys.push(this._curGeomatry=pS=new pih(ph,pq,pf,pg,p$,pP)),pg||(pS.fill=!1),null==pP&&(pS.borderWidth=0),pS},pq.setGeomtry=function(ph){this.geomatrys.push(this._curGeomatry=ph)},pq.drawLine=function(ph,pq,pf,pg,p$){var pP;return this.closePath?this.geomatrys.push(this._curGeomatry=pP=new pbh(ph,pq,pf,pg,p$)):this.geomatrys.push(this._curGeomatry=pP=new pdh(ph,pq,pf,pg,p$)),pP.fill=!1,pP},pq.update=function(){var ph=this.ib._byteLength,pq=this.geomatrys.length;this.offset=ph;for(var pf=this.geoStart;pf<pq;pf++)this.geomatrys[pf].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=pq,this.count=(this.ib._byteLength-ph)/peh.BYTES_PIDX},pq.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},pq.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},ph}(),py=function(){function pB(){}pu(pB,"laya.webgl.canvas.save.SaveBase");var ph=pB.prototype;return pR.imps(ph,{"laya.webgl.canvas.save.ISaveData":!0}),ph.isSaveMark=function(){return!1},ph.restore=function(ph){this._dataObj[this._valueName]=this._value,(pB._cache[pB._cache._length++]=this)._newSubmit&&(ph._curSubmit=pPh.RENDERBASE,ph._renderKey=0)},pB._createArray=function(){var ph=[];return ph._length=0,ph},pB._init=function(){var ph=pB._namemap={};return ph[1]="ALPHA",ph[2]="fillStyle",ph[8]="font",ph[256]="lineWidth",ph[512]="strokeStyle",ph[8192]="_mergeID",ph[1024]=ph[2048]=ph[4096]=[],ph[16384]="textBaseline",ph[32768]="textAlign",ph[65536]="_nBlendType",ph[1048576]="shader",ph[2097152]="filters",ph},pB.save=function(ph,pq,pf,pg){if((ph._saveMark._saveuse&pq)!==pq){ph._saveMark._saveuse|=pq;var p$=pB._cache,pP=0<p$._length?p$[--p$._length]:new pB;pP._value=pf[pP._valueName=pB._namemap[pq]],pP._dataObj=pf,pP._newSubmit=pg;var pS=ph._save;pS[pS._length++]=pP}},pB._cache=laya.webgl.canvas.save.SaveBase._createArray(),pB._namemap=pB._init(),pB}(),pF=function(){function pP(){this._clipRect=new pp}pu(pP,"laya.webgl.canvas.save.SaveClipRect");var ph=pP.prototype;return pR.imps(ph,{"laya.webgl.canvas.save.ISaveData":!0}),ph.isSaveMark=function(){return!1},ph.restore=function(ph){ph._clipRect=this._clipSaveRect,(pP._cache[pP._cache._length++]=this)._submitScissor.submitLength=ph._submits._length-this._submitScissor.submitIndex,ph._curSubmit=pPh.RENDERBASE,ph._renderKey=0},pP.save=function(ph,pq){if(131072!=(131072&ph._saveMark._saveuse)){ph._saveMark._saveuse|=131072;var pf=pP._cache,pg=0<pf._length?pf[--pf._length]:new pP;pg._clipSaveRect=ph._clipRect,ph._clipRect=pg._clipRect.copyFrom(ph._clipRect),pg._submitScissor=pq;var p$=ph._save;p$[p$._length++]=pg}},pS(pP,["_cache",function(){return this._cache=py._createArray()}]),pP}(),pZ=function(){function pv(){this._contextX=0,this._contextY=0,this._clipRect=new pp,this._rect=new pp,this._matrix=new pn}pu(pv,"laya.webgl.canvas.save.SaveClipRectStencil");var ph=pv.prototype;return pR.imps(ph,{"laya.webgl.canvas.save.ISaveData":!0}),ph.isSaveMark=function(){return!1},ph.restore=function(ph){pCh.restore(ph,this._rect,this._saveMatrix,this._contextX,this._contextY),ph._clipRect=this._clipSaveRect,ph._curMat=this._saveMatrix,ph._x=this._contextX,ph._y=this._contextY,pv._cache[pv._cache._length++]=this,ph._curSubmit=pPh.RENDERBASE},pv.save=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){if(262144!=(262144&ph._saveMark._saveuse)){ph._saveMark._saveuse|=262144;var pC=pv._cache,pU=0<pC._length?pC[--pC._length]:new pv;pU._clipSaveRect=ph._clipRect,pU._clipRect.setTo(pS,pB,pr,pY),ph._clipRect=pU._clipRect,pU._rect.x=pf,pU._rect.y=pg,pU._rect.width=p$,pU._rect.height=pP,pU._contextX=ph._x,pU._contextY=ph._y,pU._saveMatrix=ph._curMat,ph._curMat.copyTo(pU._matrix),ph._curMat=pU._matrix,pU._submitStencil=pq;var pu=ph._save;pu[pu._length++]=pU}},pS(pv,["_cache",function(){return this._cache=py._createArray()}]),pv}(),pQ=function(){function pg(){this._saveuse=0}pu(pg,"laya.webgl.canvas.save.SaveMark");var ph=pg.prototype;return pR.imps(ph,{"laya.webgl.canvas.save.ISaveData":!0}),ph.isSaveMark=function(){return!0},ph.restore=function(ph){ph._saveMark=this._preSaveMark,pg._no[pg._no._length++]=this},pg.Create=function(ph){var pq=pg._no,pf=0<pq._length?pq[--pq._length]:new pg;return pf._saveuse=0,pf._preSaveMark=ph._saveMark,ph._saveMark=pf},pS(pg,["_no",function(){return this._no=py._createArray()}]),pg}(),po=function(){function pP(){this._matrix=new pn}pu(pP,"laya.webgl.canvas.save.SaveTransform");var ph=pP.prototype;return pR.imps(ph,{"laya.webgl.canvas.save.ISaveData":!0}),ph.isSaveMark=function(){return!1},ph.restore=function(ph){ph._curMat=this._savematrix,pP._no[pP._no._length++]=this},pP.save=function(ph){var pq=ph._saveMark;if(2048!=(2048&pq._saveuse)){pq._saveuse|=2048;var pf=pP._no,pg=0<pf._length?pf[--pf._length]:new pP;pg._savematrix=ph._curMat,ph._curMat=ph._curMat.copyTo(pg._matrix);var p$=ph._save;p$[p$._length++]=pg}},pS(pP,["_no",function(){return this._no=py._createArray()}]),pP}(),pO=function(){function p$(){}pu(p$,"laya.webgl.canvas.save.SaveTranslate");var ph=p$.prototype;return pR.imps(ph,{"laya.webgl.canvas.save.ISaveData":!0}),ph.isSaveMark=function(){return!1},ph.restore=function(ph){ph._curMat;ph._x=this._x,ph._y=this._y,p$._no[p$._no._length++]=this},p$.save=function(ph){var pq=p$._no,pf=0<pq._length?pq[--pq._length]:new p$;pf._x=ph._x,pf._y=ph._y;var pg=ph._save;pg[pg._length++]=pf},pS(p$,["_no",function(){return this._no=py._createArray()}]),p$}(),pj=function(){function ph(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new pp}pu(ph,"laya.webgl.resource.RenderTargetMAX");var pq=ph.prototype;return pq.setSP=function(ph){this._sp=ph},pq.size=function(ph,pq){var pf=this;this._width!==ph||this._height!==pq?(this.repaint=!0,this._width=ph,this._height=pq,this.target?this.target.size(ph,pq):this.target=pTh.create(ph,pq),this.target.hasListener("recovered")||this.target.on("recovered",this,function(ph){pR.timer.callLater(pf._sp,pf._sp.repaint)})):this.target.size(ph,pq)},pq._flushToTarget=function(ph,pq){if(!pq._destroy){var pf=pNh.worldScissorTest,pg=pNh.worldClipRect;pNh.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,pNh.worldScissorTest=!1,pmh.mainContext.disable(3089);var p$=pNh.worldAlpha,pP=pNh.worldMatrix4,pS=pNh.worldMatrix,pB=pNh.worldFilters,pr=pNh.worldShaderDefines;if(pNh.worldMatrix=pn.EMPTY,pNh.restoreTempArray(),pNh.worldMatrix4=pNh.TEMPMAT4_ARRAY,pNh.worldAlpha=1,pNh.worldFilters=null,pNh.worldShaderDefines=null,pWh.activeShader=null,pq.start(),pt.showCanvasMark?pq.clear(0,1,0,.3):pq.clear(0,0,0,0),ph.flush(),pq.end(),pWh.activeShader=null,pNh.worldAlpha=p$,pNh.worldMatrix4=pP,pNh.worldMatrix=pS,pNh.worldFilters=pB,pNh.worldShaderDefines=pr,pNh.worldScissorTest=pf){var pY=pNh.height-pg.y-pg.height;pmh.mainContext.scissor(pg.x,pY,pg.width,pg.height),pmh.mainContext.enable(3089)}pNh.worldClipRect=pg}},pq.flush=function(ph){this.repaint&&(this._flushToTarget(ph,this.target),this.repaint=!1)},pq.drawTo=function(ph,pq,pf,pg,p$){ph.drawTexture(this.target.getTexture(),pq,pf,pg,p$,0,0)},pq.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},ph}(),px=function(){function ph(){this.ALPHA=1,this.shaderType=0,this.defines=new pAh}return pu(ph,"laya.webgl.shader.d2.Shader2D"),ph.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},ph.__init__=function(){var ph,pq;pQh.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),pQh.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),pQh.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),pQh.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),pQh.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),pQh.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),pQh.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),pQh.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),ph="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",pq='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',pQh.preCompile2D(0,1,ph,pq,null),ph="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",pq='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',pQh.preCompile2D(0,2,ph,pq,null),ph="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",pq="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",pQh.preCompile2D(0,4,ph,pq,null),ph="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",pq='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',pQh.preCompile2D(0,256,ph,pq,null),ph="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",pq="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",pQh.preCompile2D(0,512,ph,pq,null)},ph}(),pa=function(){function pq(ph,pq,pf){this._value=0,this._name2int=ph,this._int2name=pq,this._int2nameMap=pf}pu(pq,"laya.webgl.shader.ShaderDefines");var ph=pq.prototype;return ph.add=function(ph){return"string"==typeof ph&&(ph=this._name2int[ph]),this._value|=ph,this._value},ph.addInt=function(ph){return this._value|=ph,this._value},ph.remove=function(ph){return"string"==typeof ph&&(ph=this._name2int[ph]),this._value&=~ph,this._value},ph.isDefine=function(ph){return(this._value&ph)===ph},ph.getValue=function(){return this._value},ph.setValue=function(ph){this._value=ph},ph.toNameDic=function(){var ph=this._int2nameMap[this._value];return ph||pq._toText(this._value,this._int2name,this._int2nameMap)},pq._reg=function(ph,pq,pf,pg){pg[pf[ph]=pq]=ph},pq._toText=function(ph,pq,pf){var pg=pf[ph];if(pg)return pg;for(var p$={},pP=1,pS=0;pS<32&&!(ph<(pP=1<<pS));pS++)if(ph&pP){var pB=pq[pP];pB&&(p$[pB]="")}return pf[ph]=p$},pq._toInt=function(ph,pq){for(var pf=ph.split("."),pg=0,p$=0,pP=pf.length;p$<pP;p$++){var pS=pq[pf[p$]];if(!pS)throw new Error("Defines to int err:"+ph+"/"+pf[p$]);pg|=pS}return pg},pq}(),phh=function(){function pS(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new pn}pu(pS,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var ph=pS.prototype;return ph.init=function(ph,pq,pf){if(pq)this._vs=pq;else{this._vs=[];var pg=ph.width,p$=ph.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(pg,0,1,0,1,1,1,1),this._vs.push(pg,p$,1,1,1,1,1,1),this._vs.push(0,p$,0,1,1,1,1,1)}pf?this._ps=pf:(pS._defaultPS||(pS._defaultPS=[]).push(0,1,3,3,1,2),this._ps=pS._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=ph},ph.init2=function(ph,pq,pf,pg,p$){this.transform&&(this.transform=null),pf?this._ps=pf:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=pg,this._uvs=p$,this.mEleNum=this._ps.length,this.mTexture=ph,(p_.isConchNode||p_.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},ph._initMyData=function(){var ph=0,pq=0,pf=4*this._verticles.length;this._vs=pS._tempVS;var pg=!1;if(p_.isConchNode||p_.isConchApp?(this._vs.length=pf,pg=!0):this._vs.length<pf&&(this._vs.length=pf,pg=!0),pS._tVSLen=pf,pg)for(;ph<pf;)this._vs[ph]=this._verticles[pq],this._vs[ph+1]=this._verticles[pq+1],this._vs[ph+2]=this._uvs[pq],this._vs[ph+3]=this._uvs[pq+1],this._vs[ph+4]=1,this._vs[ph+5]=1,this._vs[ph+6]=1,this._vs[ph+7]=1,ph+=8,pq+=2;else for(;ph<pf;)this._vs[ph]=this._verticles[pq],this._vs[ph+1]=this._verticles[pq+1],this._vs[ph+2]=this._uvs[pq],this._vs[ph+3]=this._uvs[pq+1],ph+=8,pq+=2},ph.getData2=function(ph,pq,pf){var pg;this.mVBBuffer=ph,this.mIBBuffer=pq,this._initMyData(),ph.appendEx2(this._vs,Float32Array,pS._tVSLen,4),this._indexStart=pq._byteLength,(pg=pS._tempIB).length<this._ps.length&&(pg.length=this._ps.length);for(var p$=0,pP=this._ps.length;p$<pP;p$++)pg[p$]=this._ps[p$]+pf;pq.appendEx2(pg,Uint16Array,this._ps.length,2)},ph.getData=function(ph,pq,pf){if(this.mVBBuffer=ph,this.mIBBuffer=pq,ph.append(this.mVBData),this._indexStart=pq._byteLength,this.mIBData.start!=pf){for(var pg=0,p$=this._ps.length;pg<p$;pg++)this.mIBData[pg]=this._ps[pg]+pf;this.mIBData.start=pf}pq.append(this.mIBData)},ph.render=function(ph,pq,pf){if(p_.isWebGL&&this.mTexture){ph._renderKey=0,ph._shader2D.glTexture=null,pqh.getInstance().addSkinMesh(this);var pg=pPh.createShape(ph,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,pXh.create(512,0));this.transform||(this.transform=pn.EMPTY),this.transform.translate(pq,pf),pn.mul(this.transform,ph._curMat,this._tempMatrix),this.transform.translate(-pq,-pf);var p$=pg.shaderValue,pP=p$.u_mmat2||pNh.getMatrArray();pNh.mat2MatArray(this._tempMatrix,pP),p$.textureHost=this.mTexture,p$.offsetX=0,p$.offsetY=0,p$.u_mmat2=pP,p$.ALPHA=ph._shader2D.ALPHA,ph._submits[ph._submits._length++]=pg}else p_.isConchApp&&this.mTexture&&(this.transform||(this.transform=pn.EMPTY),ph.setSkinMesh&&ph.setSkinMesh(pq,pf,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},pS._tempVS=[],pS._tempIB=[],pS._defaultPS=null,pS._tVSLen=0,pS}(),pqh=function(){function ph(){this.ib=null,this.vb=null;pmh.mainContext;this.ib=pxh.create(35048),this.vb=pah.create(8)}pu(ph,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var pq=ph.prototype;return pq.addSkinMesh=function(ph){ph.getData2(this.vb,this.ib,this.vb._byteLength/32)},pq.reset=function(){this.vb.clear(),this.ib.clear()},ph.getInstance=function(){return ph.instance=ph.instance||new ph},ph.instance=null,ph}(),pfh=function(){function ph(ph,pq,pf,pg,p$,pP,pS,pB,pr){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===pr&&(pr=0),this.x=ph,this.y=pq,this.width=pf,this.height=pg,this.edges=p$,this.color=pP,this.borderWidth=pS,this.borderColor=pB}pu(ph,"laya.webgl.shapes.BasePoly");var pq=ph.prototype;return pR.imps(pq,{"laya.webgl.shapes.IShape":!0}),pq.getData=function(ph,pq,pf){},pq.rebuild=function(ph){},pq.setMatrix=function(ph){},pq.needUpdate=function(ph){return!0},pq.sector=function(ph,pq,pf){var pg=this.x,p$=this.y,pP=this.edges,pS=(this.r1-this.r0)/pP,pB=this.width,pr=this.height,pY=this.color,pC=(pY>>16&255)/255,pU=(pY>>8&255)/255,pu=(255&pY)/255;ph.push(pg,p$,pC,pU,pu);for(var pv=0;pv<pP+1;pv++)ph.push(pg+Math.sin(pS*pv+this.r0)*pB,p$+Math.cos(pS*pv+this.r0)*pr),ph.push(pC,pU,pu);for(pv=0;pv<pP;pv++)pq.push(pf,pf+pv+1,pf+pv+2)},pq.createLine2=function(ph,pq,pf,pg,p$,pP){var pS,pB,pr,pY,pC,pU,pu,pv,pL,pe,pl,p_,pN,pG,pm,pE,pR,pt,pX,pn,pJ=ph.concat(),pp=p$,pA=this.borderColor,pd=(pA>>16&255)/255,pb=(pA>>8&255)/255,pi=(255&pA)/255,pz=pJ.length/2,pc=pg,pM=pf/2;pr=pJ[0],pY=pJ[1],pe=pr-(pC=pJ[2]),pL=(pL=-(pY-(pU=pJ[3])))/(pn=Math.sqrt(pL*pL+pe*pe))*pM,pe=pe/pn*pM,pp.push(pr-pL+this.x,pY-pe+this.y,pd,pb,pi,pr+pL+this.x,pY+pe+this.y,pd,pb,pi);for(var pW=1;pW<pz-1;pW++)pr=pJ[2*(pW-1)],pY=pJ[2*(pW-1)+1],pC=pJ[2*pW],pU=pJ[2*pW+1],pu=pJ[2*(pW+1)],pv=pJ[2*(pW+1)+1],pe=pr-pC,p_=pC-pu,pm=(-(pL=(pL=-(pY-pU))/(pn=Math.sqrt(pL*pL+pe*pe))*pM)+pr)*(-(pe=pe/pn*pM)+pU)-(-pL+pC)*(-pe+pY),pt=(-(pl=(pl=-(pU-pv))/(pn=Math.sqrt(pl*pl+p_*p_))*pM)+pu)*(-(p_=p_/pn*pM)+pU)-(-pl+pC)*(-p_+pv),pX=(pN=-pe+pY-(-pe+pU))*(pR=-pl+pC-(-pl+pu))-(pE=-p_+pv-(-p_+pU))*(pG=-pL+pC-(-pL+pr)),Math.abs(pX)<.1?(pX+=10.1,pp.push(pC-pL+this.x,pU-pe+this.y,pd,pb,pi,pC+pL+this.x,pU+pe+this.y,pd,pb,pi)):(((pS=(pG*pt-pR*pm)/pX)-pC)*(pS-pC)+((pB=(pE*pm-pN*pt)/pX)-pU)+(pB-pU),pp.push(pS+this.x,pB+this.y,pd,pb,pi,pC-(pS-pC)+this.x,pU-(pB-pU)+this.y,pd,pb,pi));pr=pJ[pJ.length-4],pY=pJ[pJ.length-3],pe=pr-(pC=pJ[pJ.length-2]),pL=(pL=-(pY-(pU=pJ[pJ.length-1])))/(pn=Math.sqrt(pL*pL+pe*pe))*pM,pe=pe/pn*pM,pp.push(pC-pL+this.x,pU-pe+this.y,pd,pb,pi,pC+pL+this.x,pU+pe+this.y,pd,pb,pi);var pT=pP;for(pW=1;pW<pT;pW++)pq.push(pc+2*(pW-1),pc+2*(pW-1)+1,pc+2*pW+1,pc+2*pW+1,pc+2*pW,pc+2*(pW-1));return pp},pq.createLine=function(ph,pq,pf,pg){var p$=ph.concat(),pP=ph,pS=this.borderColor,pB=(pS>>16&255)/255,pr=(pS>>8&255)/255,pY=(255&pS)/255;p$.splice(0,5);var pC,pU,pu,pv,pL,pe,pl,p_,pN,pG,pm,pE,pR,pt,pX,pn,pJ,pp,pA,pd,pb=p$.length/5,pi=pg,pz=pf/2;pu=p$[0],pv=p$[1],pG=pu-(pL=p$[5]),pN=(pN=-(pv-(pe=p$[6])))/(pd=Math.sqrt(pN*pN+pG*pG))*pz,pG=pG/pd*pz,pP.push(pu-pN,pv-pG,pB,pr,pY,pu+pN,pv+pG,pB,pr,pY);for(var pc=1;pc<pb-1;pc++)pu=p$[5*(pc-1)],pv=p$[5*(pc-1)+1],pL=p$[5*pc],pe=p$[5*pc+1],pl=p$[5*(pc+1)],p_=p$[5*(pc+1)+1],pG=pu-pL,pE=pL-pl,pX=(-(pN=(pN=-(pv-pe))/(pd=Math.sqrt(pN*pN+pG*pG))*pz)+pu)*(-(pG=pG/pd*pz)+pe)-(-pN+pL)*(-pG+pv),pp=(-(pm=(pm=-(pe-p_))/(pd=Math.sqrt(pm*pm+pE*pE))*pz)+pl)*(-(pE=pE/pd*pz)+pe)-(-pm+pL)*(-pE+p_),pA=(pR=-pG+pv-(-pG+pe))*(pJ=-pm+pL-(-pm+pl))-(pn=-pE+p_-(-pE+pe))*(pt=-pN+pL-(-pN+pu)),Math.abs(pA)<.1?(pA+=10.1,pP.push(pL-pN,pe-pG,pB,pr,pY,pL+pN,pe+pG,pB,pr,pY)):(((pC=(pt*pp-pJ*pX)/pA)-pL)*(pC-pL)+((pU=(pn*pX-pR*pp)/pA)-pe)+(pU-pe),pP.push(pC,pU,pB,pr,pY,pL-(pC-pL),pe-(pU-pe),pB,pr,pY));pu=p$[p$.length-10],pv=p$[p$.length-9],pG=pu-(pL=p$[p$.length-5]),pN=(pN=-(pv-(pe=p$[p$.length-4])))/(pd=Math.sqrt(pN*pN+pG*pG))*pz,pG=pG/pd*pz,pP.push(pL-pN,pe-pG,pB,pr,pY,pL+pN,pe+pG,pB,pr,pY);var pM=this.edges+1;for(pc=1;pc<pM;pc++)pq.push(pi+2*(pc-1),pi+2*(pc-1)+1,pi+2*pc+1,pi+2*pc+1,pi+2*pc,pi+2*(pc-1));return pP},pq.createLoopLine=function(ph,pq,pf,pg,p$,pP){var pS=ph.concat(),pB=p$||ph,pr=this.borderColor,pY=(pr>>16&255)/255,pC=(pr>>8&255)/255,pU=(255&pr)/255;pS.splice(0,5);var pu=[pS[0],pS[1]],pv=[pS[pS.length-5],pS[pS.length-4]],pL=pv[0]+.5*(pu[0]-pv[0]),pe=pv[1]+.5*(pu[1]-pv[1]);pS.unshift(pL,pe,0,0,0),pS.push(pL,pe,0,0,0);var pl,p_,pN,pG,pm,pE,pR,pt,pX,pn,pJ,pp,pA,pd,pb,pi,pz,pc,pM,pW,pT=pS.length/5,pI=pg,pw=pf/2;pN=pS[0],pG=pS[1],pn=pN-(pm=pS[5]),pX=(pX=-(pG-(pE=pS[6])))/(pW=Math.sqrt(pX*pX+pn*pn))*pw,pn=pn/pW*pw,pB.push(pN-pX,pG-pn,pY,pC,pU,pN+pX,pG+pn,pY,pC,pU);for(var pk=1;pk<pT-1;pk++)pN=pS[5*(pk-1)],pG=pS[5*(pk-1)+1],pm=pS[5*pk],pE=pS[5*pk+1],pR=pS[5*(pk+1)],pt=pS[5*(pk+1)+1],pn=pN-pm,pp=pm-pR,pb=(-(pX=(pX=-(pG-pE))/(pW=Math.sqrt(pX*pX+pn*pn))*pw)+pN)*(-(pn=pn/pW*pw)+pE)-(-pX+pm)*(-pn+pG),pc=(-(pJ=(pJ=-(pE-pt))/(pW=Math.sqrt(pJ*pJ+pp*pp))*pw)+pR)*(-(pp=pp/pW*pw)+pE)-(-pJ+pm)*(-pp+pt),pM=(pA=-pn+pG-(-pn+pE))*(pz=-pJ+pm-(-pJ+pR))-(pi=-pp+pt-(-pp+pE))*(pd=-pX+pm-(-pX+pN)),Math.abs(pM)<.1?(pM+=10.1,pB.push(pm-pX,pE-pn,pY,pC,pU,pm+pX,pE+pn,pY,pC,pU)):(((pl=(pd*pc-pz*pb)/pM)-pm)*(pl-pm)+((p_=(pi*pb-pA*pc)/pM)-pE)+(p_-pE),pB.push(pl,p_,pY,pC,pU,pm-(pl-pm),pE-(p_-pE),pY,pC,pU));pP&&(pq=pP);var pH=this.edges+1;for(pk=1;pk<pH;pk++)pq.push(pI+2*(pk-1),pI+2*(pk-1)+1,pI+2*pk+1,pI+2*pk+1,pI+2*pk,pI+2*(pk-1));return pq.push(pI+2*(pk-1),pI+2*(pk-1)+1,pI+1,pI+1,pI,pI+2*(pk-1)),pB},ph}(),pgh=function(){function pe(){}return pu(pe,"laya.webgl.shapes.Earcut"),pe.earcut=function(ph,pq,pf){pf=pf||2;var pg,p$,pP,pS,pB,pr,pY,pC=pq&&pq.length,pU=pC?pq[0]*pf:ph.length,pu=pe.linkedList(ph,0,pU,pf,!0),pv=[];if(!pu)return pv;if(pC&&(pu=pe.eliminateHoles(ph,pq,pu,pf)),ph.length>80*pf){pg=pP=ph[0],p$=pS=ph[1];for(var pL=pf;pL<pU;pL+=pf)(pB=ph[pL])<pg&&(pg=pB),(pr=ph[pL+1])<p$&&(p$=pr),pP<pB&&(pP=pB),pS<pr&&(pS=pr);pY=0!==(pY=Math.max(pP-pg,pS-p$))?1/pY:0}return pe.earcutLinked(pu,pv,pf,pg,p$,pY),pv},pe.linkedList=function(ph,pq,pf,pg,p$){var pP,pS;if(p$===0<pe.signedArea(ph,pq,pf,pg))for(pP=pq;pP<pf;pP+=pg)pS=pe.insertNode(pP,ph[pP],ph[pP+1],pS);else for(pP=pf-pg;pq<=pP;pP-=pg)pS=pe.insertNode(pP,ph[pP],ph[pP+1],pS);return pS&&pe.equals(pS,pS.next)&&(pe.removeNode(pS),pS=pS.next),pS},pe.filterPoints=function(ph,pq){if(!ph)return ph;pq||(pq=ph);var pf,pg=ph;do{if(pf=!1,pg.steiner||!pe.equals(pg,pg.next)&&0!==pe.area(pg.prev,pg,pg.next))pg=pg.next;else{if(pe.removeNode(pg),(pg=pq=pg.prev)===pg.next)break;pf=!0}}while(pf||pg!==pq);return pq},pe.earcutLinked=function(ph,pq,pf,pg,p$,pP,pS){if(ph){!pS&&pP&&pe.indexCurve(ph,pg,p$,pP);for(var pB,pr,pY=ph;ph.prev!==ph.next;)if(pB=ph.prev,pr=ph.next,pP?pe.isEarHashed(ph,pg,p$,pP):pe.isEar(ph))pq.push(pB.i/pf),pq.push(ph.i/pf),pq.push(pr.i/pf),pe.removeNode(ph),ph=pr.next,pY=pr.next;else if((ph=pr)===pY){pS?1===pS?(ph=pe.cureLocalIntersections(ph,pq,pf),pe.earcutLinked(ph,pq,pf,pg,p$,pP,2)):2===pS&&pe.splitEarcut(ph,pq,pf,pg,p$,pP):pe.earcutLinked(pe.filterPoints(ph,null),pq,pf,pg,p$,pP,1);break}}},pe.isEar=function(ph){var pq=ph.prev,pf=ph,pg=ph.next;if(0<=pe.area(pq,pf,pg))return!1;for(var p$=ph.next.next;p$!==ph.prev;){if(pe.pointInTriangle(pq.x,pq.y,pf.x,pf.y,pg.x,pg.y,p$.x,p$.y)&&0<=pe.area(p$.prev,p$,p$.next))return!1;p$=p$.next}return!0},pe.isEarHashed=function(ph,pq,pf,pg){var p$=ph.prev,pP=ph,pS=ph.next;if(0<=pe.area(p$,pP,pS))return!1;for(var pB=p$.x<pP.x?p$.x<pS.x?p$.x:pS.x:pP.x<pS.x?pP.x:pS.x,pr=p$.y<pP.y?p$.y<pS.y?p$.y:pS.y:pP.y<pS.y?pP.y:pS.y,pY=p$.x>pP.x?p$.x>pS.x?p$.x:pS.x:pP.x>pS.x?pP.x:pS.x,pC=p$.y>pP.y?p$.y>pS.y?p$.y:pS.y:pP.y>pS.y?pP.y:pS.y,pU=pe.zOrder(pB,pr,pq,pf,pg),pu=pe.zOrder(pY,pC,pq,pf,pg),pv=ph.nextZ;pv&&pv.z<=pu;){if(pv!==ph.prev&&pv!==ph.next&&pe.pointInTriangle(p$.x,p$.y,pP.x,pP.y,pS.x,pS.y,pv.x,pv.y)&&0<=pe.area(pv.prev,pv,pv.next))return!1;pv=pv.nextZ}for(pv=ph.prevZ;pv&&pv.z>=pU;){if(pv!==ph.prev&&pv!==ph.next&&pe.pointInTriangle(p$.x,p$.y,pP.x,pP.y,pS.x,pS.y,pv.x,pv.y)&&0<=pe.area(pv.prev,pv,pv.next))return!1;pv=pv.prevZ}return!0},pe.cureLocalIntersections=function(ph,pq,pf){var pg=ph;do{var p$=pg.prev,pP=pg.next.next;!pe.equals(p$,pP)&&pe.intersects(p$,pg,pg.next,pP)&&pe.locallyInside(p$,pP)&&pe.locallyInside(pP,p$)&&(pq.push(p$.i/pf),pq.push(pg.i/pf),pq.push(pP.i/pf),pe.removeNode(pg),pe.removeNode(pg.next),pg=ph=pP),pg=pg.next}while(pg!==ph);return pg},pe.splitEarcut=function(ph,pq,pf,pg,p$,pP){var pS=ph;do{for(var pB=pS.next.next;pB!==pS.prev;){if(pS.i!==pB.i&&pe.isValidDiagonal(pS,pB)){var pr=pe.splitPolygon(pS,pB);return pS=pe.filterPoints(pS,pS.next),pr=pe.filterPoints(pr,pr.next),pe.earcutLinked(pS,pq,pf,pg,p$,pP),void pe.earcutLinked(pr,pq,pf,pg,p$,pP)}pB=pB.next}pS=pS.next}while(pS!==ph)},pe.eliminateHoles=function(ph,pq,pf,pg){var p$,pP,pS,pB,pr,pY=[];for(p$=0,pP=pq.length;p$<pP;p$++)pS=pq[p$]*pg,pB=p$<pP-1?pq[p$+1]*pg:ph.length,(pr=pe.linkedList(ph,pS,pB,pg,!1))===pr.next&&(pr.steiner=!0),pY.push(pe.getLeftmost(pr));for(pY.sort(pe.compareX),p$=0;p$<pY.length;p$++)pe.eliminateHole(pY[p$],pf),pf=pe.filterPoints(pf,pf.next);return pf},pe.compareX=function(ph,pq){return ph.x-pq.x},pe.eliminateHole=function(ph,pq){if(pq=pe.findHoleBridge(ph,pq)){var pf=pe.splitPolygon(pq,ph);pe.filterPoints(pf,pf.next)}},pe.findHoleBridge=function(ph,pq){var pf,pg=pq,p$=ph.x,pP=ph.y,pS=-1/0;do{if(pP<=pg.y&&pP>=pg.next.y&&pg.next.y!==pg.y){var pB=pg.x+(pP-pg.y)*(pg.next.x-pg.x)/(pg.next.y-pg.y);if(pB<=p$&&pS<pB){if((pS=pB)===p$){if(pP===pg.y)return pg;if(pP===pg.next.y)return pg.next}pf=pg.x<pg.next.x?pg:pg.next}}pg=pg.next}while(pg!==pq);if(!pf)return null;if(p$===pS)return pf.prev;var pr,pY=pf,pC=pf.x,pU=pf.y,pu=1/0;for(pg=pf.next;pg!==pY;)p$>=pg.x&&pg.x>=pC&&p$!==pg.x&&pe.pointInTriangle(pP<pU?p$:pS,pP,pC,pU,pP<pU?pS:p$,pP,pg.x,pg.y)&&((pr=Math.abs(pP-pg.y)/(p$-pg.x))<pu||pr===pu&&pg.x>pf.x)&&pe.locallyInside(pg,ph)&&(pf=pg,pu=pr),pg=pg.next;return pf},pe.indexCurve=function(ph,pq,pf,pg){for(var p$=ph;null===p$.z&&(p$.z=pe.zOrder(p$.x,p$.y,pq,pf,pg)),p$.prevZ=p$.prev,p$.nextZ=p$.next,(p$=p$.next)!==ph;);p$.prevZ.nextZ=null,p$.prevZ=null,pe.sortLinked(p$)},pe.sortLinked=function(ph){var pq,pf,pg,p$,pP,pS,pB,pr,pY=1;do{for(pf=ph,pP=ph=null,pS=0;pf;){for(pS++,pg=pf,pq=pB=0;pq<pY&&(pB++,pg=pg.nextZ);pq++);for(pr=pY;0<pB||0<pr&&pg;)0!==pB&&(0===pr||!pg||pf.z<=pg.z)?(pf=(p$=pf).nextZ,pB--):(pg=(p$=pg).nextZ,pr--),pP?pP.nextZ=p$:ph=p$,p$.prevZ=pP,pP=p$;pf=pg}pP.nextZ=null,pY*=2}while(1<pS);return ph},pe.zOrder=function(ph,pq,pf,pg,p$){return(ph=1431655765&((ph=858993459&((ph=252645135&((ph=16711935&((ph=32767*(ph-pf)*p$)|ph<<8))|ph<<4))|ph<<2))|ph<<1))|(pq=1431655765&((pq=858993459&((pq=252645135&((pq=16711935&((pq=32767*(pq-pg)*p$)|pq<<8))|pq<<4))|pq<<2))|pq<<1))<<1},pe.getLeftmost=function(ph){for(var pq=ph,pf=ph;pq.x<pf.x&&(pf=pq),(pq=pq.next)!==ph;);return pf},pe.pointInTriangle=function(ph,pq,pf,pg,p$,pP,pS,pB){return 0<=(p$-pS)*(pq-pB)-(ph-pS)*(pP-pB)&&0<=(ph-pS)*(pg-pB)-(pf-pS)*(pq-pB)&&0<=(pf-pS)*(pP-pB)-(p$-pS)*(pg-pB)},pe.isValidDiagonal=function(ph,pq){return ph.next.i!==pq.i&&ph.prev.i!==pq.i&&!pe.intersectsPolygon(ph,pq)&&pe.locallyInside(ph,pq)&&pe.locallyInside(pq,ph)&&pe.middleInside(ph,pq)},pe.area=function(ph,pq,pf){return(pq.y-ph.y)*(pf.x-pq.x)-(pq.x-ph.x)*(pf.y-pq.y)},pe.equals=function(ph,pq){return ph.x===pq.x&&ph.y===pq.y},pe.intersects=function(ph,pq,pf,pg){return!!(pe.equals(ph,pq)&&pe.equals(pf,pg)||pe.equals(ph,pg)&&pe.equals(pf,pq))||0<pe.area(ph,pq,pf)!=0<pe.area(ph,pq,pg)&&0<pe.area(pf,pg,ph)!=0<pe.area(pf,pg,pq)},pe.intersectsPolygon=function(ph,pq){var pf=ph;do{if(pf.i!==ph.i&&pf.next.i!==ph.i&&pf.i!==pq.i&&pf.next.i!==pq.i&&pe.intersects(pf,pf.next,ph,pq))return!0;pf=pf.next}while(pf!==ph);return!1},pe.locallyInside=function(ph,pq){return pe.area(ph.prev,ph,ph.next)<0?0<=pe.area(ph,pq,ph.next)&&0<=pe.area(ph,ph.prev,pq):pe.area(ph,pq,ph.prev)<0||pe.area(ph,ph.next,pq)<0},pe.middleInside=function(ph,pq){for(var pf=ph,pg=!1,p$=(ph.x+pq.x)/2,pP=(ph.y+pq.y)/2;pf.y>pP!=pf.next.y>pP&&pf.next.y!==pf.y&&p$<(pf.next.x-pf.x)*(pP-pf.y)/(pf.next.y-pf.y)+pf.x&&(pg=!pg),(pf=pf.next)!==ph;);return pg},pe.splitPolygon=function(ph,pq){var pf=new p$h(ph.i,ph.x,ph.y),pg=new p$h(pq.i,pq.x,pq.y),p$=ph.next,pP=pq.prev;return(ph.next=pq).prev=ph,(pf.next=p$).prev=pf,(pg.next=pf).prev=pg,(pP.next=pg).prev=pP,pg},pe.insertNode=function(ph,pq,pf,pg){var p$=new p$h(ph,pq,pf);return pg?(p$.next=pg.next,(p$.prev=pg).next.prev=p$,pg.next=p$):(p$.prev=p$).next=p$,p$},pe.removeNode=function(ph){ph.next.prev=ph.prev,ph.prev.next=ph.next,ph.prevZ&&(ph.prevZ.nextZ=ph.nextZ),ph.nextZ&&(ph.nextZ.prevZ=ph.prevZ)},pe.signedArea=function(ph,pq,pf,pg){for(var p$=0,pP=pq,pS=pf-pg;pP<pf;pP+=pg)p$+=(ph[pS]-ph[pP])*(ph[pP+1]+ph[pS+1]),pS=pP;return p$},pe}(),p$h=function(){function ph(ph,pq,pf){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=ph,this.x=pq,this.y=pf,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return pu(ph,"laya.webgl.shapes.EarcutNode"),ph}(),pPh=(function(){function ph(ph,pq,pf,pg,p$,pP,pS){this.lineWidth=ph,this.lineColor=pq,this.lineAlpha=pf,this.fillColor=pg,this.fillAlpha=p$,this.shape=pS,this.fill=pP}pu(ph,"laya.webgl.shapes.GeometryData");var pq=ph.prototype;pq.clone=function(){return new ph(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},pq.getIndexData=function(){return null},pq.getVertexData=function(){return null},pq.destroy=function(){this.shape=null}}(),function(){function ph(ph){if(ph instanceof Float32Array)this.points=ph;else if(ph instanceof Array){ph.length;this.points=new Float32Array(ph)}}pu(ph,"laya.webgl.shapes.Vertex");var pq=ph.prototype;pR.imps(pq,{"laya.webgl.shapes.IShape":!0}),pq.getData=function(ph,pq,pf){},pq.needUpdate=function(ph){return!1},pq.rebuild=function(ph){},pq.setMatrix=function(ph){}}(),function(){function pr(ph){void 0===ph&&(ph=1e4),this._renderType=ph}pu(pr,"laya.webgl.submit.Submit");var ph=pr.prototype;return pR.imps(ph,{"laya.webgl.submit.ISubmit":!0}),ph.releaseRender=function(){var ph=pr._cache;(ph[ph._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},ph.getRenderType=function(){return this._renderType},ph.renderSubmit=function(){if(0===this._numEle)return 1;var ph=this.shaderValue.textureHost;if(ph){var pq=ph.source;if(!ph.bitmap||!pq)return 1;this.shaderValue.texture=pq,ph.alphaTexture&&ph.alphaTexture.source&&(this.shaderValue.texture1=ph.alphaTexture.source)}this._vb.bind_upload(this._ib);var pf=pmh.mainContext;return this.shaderValue.upload(),ps.activeBlendFunction!==this._blendFn&&(pf.enable(3042),this._blendFn(pf),ps.activeBlendFunction=this._blendFn),pb.drawCall++,pb.trianglesFaces+=this._numEle/3,pf.drawElements(4,this._numEle,5123,this._startIdx),1},pr.__init__=function(){var ph=pr.RENDERBASE=new pr(-1);ph.shaderValue=new pXh(0,0),ph.shaderValue.ALPHA=-1234},pr.createSubmit=function(ph,pq,pf,pg,p$){var pP=pr._cache._length?pr._cache[--pr._cache._length]:new pr;null==pf&&((pf=pP._selfVb||(pP._selfVb=pah.create(-1))).clear(),pg=0),pP._ib=pq,pP._vb=pf,pP._startIdx=pg*peh.BYTES_PIDX,pP._numEle=0;var pS=ph._nBlendType;pP._blendFn=ph._targets?ps.targetFns[pS]:ps.fns[pS],pP.shaderValue=p$,pP.shaderValue.setValue(ph._shader2D);var pB=ph._shader2D.filters;return pB&&pP.shaderValue.setFilters(pB),pP},pr.createShape=function(ph,pq,pf,pg,p$,pP){var pS=pr._cache._length?pr._cache[--pr._cache._length]:new pr;pS._ib=pq,pS._vb=pf,pS._numEle=pg,pS._startIdx=p$,pS.shaderValue=pP,pS.shaderValue.setValue(ph._shader2D);var pB=ph._nBlendType;return pS._blendFn=ph._targets?ps.targetFns[pB]:ps.fns[pB],pS},pr.TYPE_2D=1e4,pr.TYPE_CANVAS=10003,pr.TYPE_CMDSETRT=10004,pr.TYPE_CUSTOM=10005,pr.TYPE_BLURRT=10006,pr.TYPE_CMDDESTORYPRERT=10007,pr.TYPE_DISABLESTENCIL=10008,pr.TYPE_OTHERIBVB=10009,pr.TYPE_PRIMITIVE=10010,pr.TYPE_RT=10011,pr.TYPE_BLUR_RT=10012,pr.TYPE_TARGET=10013,pr.TYPE_CHANGE_VALUE=10014,pr.TYPE_SHAPE=10015,pr.TYPE_TEXTURE=10016,pr.TYPE_FILLTEXTURE=10017,pr.RENDERBASE=null,pr._cache=((pr._cache=[])._length=0,pr._cache),pr}()),pSh=function(){function pg(){this.fun=null,this.args=null}pu(pg,"laya.webgl.submit.SubmitCMD");var ph=pg.prototype;return pR.imps(ph,{"laya.webgl.submit.ISubmit":!0}),ph.renderSubmit=function(){return this.fun.apply(null,this.args),1},ph.getRenderType=function(){return 0},ph.releaseRender=function(){var ph=pg._cache;ph[ph._length++]=this},pg.create=function(ph,pq){var pf=pg._cache._length?pg._cache[--pg._cache._length]:new pg;return pf.fun=pq,pf.args=ph,pf},pg._cache=((pg._cache=[])._length=0,pg._cache),pg}(),pBh=function(){function pq(){this.variables={}}pu(pq,"laya.webgl.submit.SubmitCMDScope");var ph=pq.prototype;return ph.getValue=function(ph){return this.variables[ph]},ph.addValue=function(ph,pq){return this.variables[ph]=pq},ph.setValue=function(ph,pq){return this.variables.hasOwnProperty(ph)?this.variables[ph]=pq:null},ph.clear=function(){for(var ph in this.variables)delete this.variables[ph]},ph.recycle=function(){this.clear(),pq.POOL.push(this)},pq.create=function(){var ph=pq.POOL.pop();return ph||(ph=new pq),ph},pq.POOL=[],pq}(),prh=function(){function pU(){this.offset=0,this.startIndex=0,this._mat=pn.create()}pu(pU,"laya.webgl.submit.SubmitOtherIBVB");var ph=pU.prototype;return pR.imps(ph,{"laya.webgl.submit.ISubmit":!0}),ph.releaseRender=function(){var ph=pU._cache;(ph[ph._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},ph.getRenderType=function(){return 10009},ph.renderSubmit=function(){var ph=this._shaderValue.textureHost;if(ph){var pq=ph.source;if(!ph.bitmap||!pq)return 1;this._shaderValue.texture=pq}this._vb.bind_upload(this._ib);var pf=pNh.worldMatrix4,pg=pn.TEMP;pn.mulPre(this._mat,pf[0],pf[1],pf[4],pf[5],pf[12],pf[13],pg);var p$=pNh.worldMatrix4=pU.tempMatrix4;p$[0]=pg.a,p$[1]=pg.b,p$[4]=pg.c,p$[5]=pg.d,p$[12]=pg.tx,p$[13]=pg.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var pP=pmh.mainContext;return ps.activeBlendFunction!==this._blendFn&&(pP.enable(3042),this._blendFn(pP),ps.activeBlendFunction=this._blendFn),pb.drawCall++,pb.trianglesFaces+=this._numEle/3,pP.drawElements(4,this._numEle,5123,this.startIndex),pNh.worldMatrix4=pf,pWh.activeShader=null,1},pU.create=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){void 0===pr&&(pr=0);var pY=pU._cache._length?pU._cache[--pU._cache._length]:new pU;pY._ib=pf,pY._vb=pq,pY._numEle=pg,pY._shader=p$,pY._shaderValue=pP;var pC=ph._nBlendType;switch(pY._blendFn=ph._targets?ps.targetFns[pC]:ps.fns[pC],pr){case 0:pY.offset=0,pY.startIndex=pB/(peh.BYTES_PE*pq.vertexStride)*1.5,pY.startIndex*=peh.BYTES_PIDX;break;case 1:pY.startIndex=pS,pY.offset=pB}return pY},pU._cache=((pU._cache=[])._length=0,pU._cache),pU.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],pU}(),pYh=function(){function pf(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new pp,this.screenRect=new pp}pu(pf,"laya.webgl.submit.SubmitScissor");var ph=pf.prototype;return pR.imps(ph,{"laya.webgl.submit.ISubmit":!0}),ph._scissor=function(ph,pq,pf,pg){var p$=pNh.worldMatrix4,pP=p$[0],pS=p$[5],pB=p$[12],pr=p$[13];if(pg*=pS,(pf*=pP)<1||pg<1)return!1;var pY=(ph=ph*pP+pB)+pf,pC=(pq=pq*pS+pr)+pg;ph<0&&(pf=pY-(ph=0)),pq<0&&(pg=pC-(pq=0));var pU=pNh.worldClipRect;if(ph=Math.max(ph,pU.x),pq=Math.max(pq,pU.y),pf=Math.min(pY,pU.right)-ph,pg=Math.min(pC,pU.bottom)-pq,pf<1||pg<1)return!1;var pu=pNh.worldScissorTest;return this.screenRect.copyFrom(pU),pU.x=ph,pU.y=pq,pU.width=pf,pU.height=pg,pNh.worldScissorTest=!0,pq=pNh.height-pq-pg,pmh.mainContext.scissor(ph,pq,pf,pg),pmh.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),pu?(pq=pNh.height-this.screenRect.y-this.screenRect.height,pmh.mainContext.scissor(this.screenRect.x,pq,this.screenRect.width,this.screenRect.height),pmh.mainContext.enable(3089)):(pmh.mainContext.disable(3089),pNh.worldScissorTest=!1),pU.copyFrom(this.screenRect),!0},ph._scissorWithTagart=function(ph,pq,pf,pg){if(pf<1||pg<1)return!1;var p$=ph+pf,pP=pq+pg;ph<0&&(pf=p$-(ph=0)),pq<0&&(pg=pP-(pq=0));var pS=pNh.worldClipRect;if(ph=Math.max(ph,pS.x),pq=Math.max(pq,pS.y),pf=Math.min(p$,pS.right)-ph,pg=Math.min(pP,pS.bottom)-pq,pf<1||pg<1)return!1;var pB=pNh.worldScissorTest;return this.screenRect.copyFrom(pS),pNh.worldScissorTest=!0,pS.x=ph,pS.y=pq,pS.width=pf,pS.height=pg,pq=pNh.height-pq-pg,pmh.mainContext.scissor(ph,pq,pf,pg),pmh.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),pB?(pq=pNh.height-this.screenRect.y-this.screenRect.height,pmh.mainContext.scissor(this.screenRect.x,pq,this.screenRect.width,this.screenRect.height),pmh.mainContext.enable(3089)):(pmh.mainContext.disable(3089),pNh.worldScissorTest=!1),pS.copyFrom(this.screenRect),!0},ph.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},ph.getRenderType=function(){return 0},ph.releaseRender=function(){var ph=pf._cache;(ph[ph._length++]=this).context=null},pf.create=function(ph){var pq=pf._cache._length?pf._cache[--pf._cache._length]:new pf;return pq.context=ph,pq},pf._cache=((pf._cache=[])._length=0,pf._cache),pf}(),pCh=function(){function pr(){this.step=0,this.blendMode=null,this.level=0}pu(pr,"laya.webgl.submit.SubmitStencil");var ph=pr.prototype;return pR.imps(ph,{"laya.webgl.submit.ISubmit":!0}),ph.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},ph.getRenderType=function(){return 0},ph.releaseRender=function(){var ph=pr._cache;ph[ph._length++]=this},ph.do1=function(){var ph=pmh.mainContext;ph.enable(2960),ph.clear(1024),ph.colorMask(!1,!1,!1,!1),ph.stencilFunc(514,this.level,255),ph.stencilOp(7680,7680,7682)},ph.do2=function(){var ph=pmh.mainContext;ph.stencilFunc(514,this.level+1,255),ph.colorMask(!0,!0,!0,!0),ph.stencilOp(7680,7680,7680)},ph.do3=function(){var ph=pmh.mainContext;ph.colorMask(!0,!0,!0,!0),ph.stencilOp(7680,7680,7680),ph.clear(1024),ph.disable(2960)},ph.do4=function(){var ph=pmh.mainContext;0==this.level&&(ph.enable(2960),ph.clear(1024)),ph.colorMask(!1,!1,!1,!1),ph.stencilFunc(519,0,255),ph.stencilOp(7680,7680,7682)},ph.do5=function(){var ph=pmh.mainContext;ph.stencilFunc(514,this.level,255),ph.colorMask(!0,!0,!0,!0),ph.stencilOp(7680,7680,7680)},ph.do6=function(){var ph=pmh.mainContext;ps.targetFns[ps.TOINT[this.blendMode]](ph)},ph.do7=function(){var ph=pmh.mainContext;ph.colorMask(!1,!1,!1,!1),ph.stencilOp(7680,7680,7683)},ph.do8=function(){var ph=pmh.mainContext;ph.colorMask(!0,!0,!0,!0),ph.stencilFunc(514,this.level,255),ph.stencilOp(7680,7680,7680)},pr.restore=function(ph,pq,pf,pg,p$){var pP;if((ph._renderKey=0)<pr._mask&&pr._mask--,0==pr._mask)pP=laya.webgl.submit.SubmitStencil.create(3),ph.addRenderObject(pP),ph._curSubmit=pPh.RENDERBASE;else{pP=laya.webgl.submit.SubmitStencil.create(7),ph.addRenderObject(pP);var pS=ph._vb;pS._byteLength;if(plh.fillRectImgVb(pS,null,pq.x,pq.y,pq.width,pq.height,pM.DEF_UV,pf,pg,p$,0,0)){ph._shader2D.glTexture=null;var pB=ph._curSubmit=pPh.createSubmit(ph,ph._ib,pS,(pS._byteLength-64)/32*3,pXh.create(2,0));pB.shaderValue.ALPHA=1,ph._submits[ph._submits._length++]=pB,ph._curSubmit._numEle+=6,ph._curSubmit=pPh.RENDERBASE}else alert("clipRect calc stencil rect error");pP=laya.webgl.submit.SubmitStencil.create(8),ph.addRenderObject(pP)}},pr.restore2=function(ph,pq){var pf;(ph._renderKey=0)<pr._mask&&pr._mask--,0==pr._mask?(pf=laya.webgl.submit.SubmitStencil.create(3),ph.addRenderObject(pf),ph._curSubmit=pPh.RENDERBASE):(pf=laya.webgl.submit.SubmitStencil.create(7),ph.addRenderObject(pf),ph._submits[ph._submits._length++]=pq,pf=laya.webgl.submit.SubmitStencil.create(8),ph.addRenderObject(pf))},pr.create=function(ph){var pq=pr._cache._length?pr._cache[--pr._cache._length]:new pr;return 5==(pq.step=ph)&&++pr._mask,pq.level=pr._mask,pq},pr._cache=((pr._cache=[])._length=0,pr._cache),pr._mask=0,pr}(),pUh=function(){function pB(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}pu(pB,"laya.webgl.submit.SubmitTarget");var ph=pB.prototype;return pR.imps(ph,{"laya.webgl.submit.ISubmit":!0}),ph.renderSubmit=function(){this._vb.bind_upload(this._ib);var ph=this.scope.getValue(this.proName);return ph&&(this.shaderValue.texture=ph.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[ph.width,ph.height]),this.shaderValue.upload(),this.blend(),pb.drawCall++,pb.trianglesFaces+=this._numEle/3,pmh.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},ph.blend=function(){if(ps.activeBlendFunction!==ps.fns[this.blendType]){var ph=pmh.mainContext;ph.enable(3042),ps.fns[this.blendType](ph),ps.activeBlendFunction=ps.fns[this.blendType]}},ph.getRenderType=function(){return 0},ph.releaseRender=function(){var ph=pB._cache;(ph[ph._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},pB.create=function(ph,pq,pf,pg,p$,pP){var pS=pB._cache._length?pB._cache[--pB._cache._length]:new pB;return pS._ib=pq,pS._vb=pf,pS.proName=pP,pS._startIdx=pg*peh.BYTES_PIDX,pS._numEle=0,pS.blendType=ph._nBlendType,pS.shaderValue=p$,pS.shaderValue.setValue(ph._shader2D),pS},pB._cache=((pB._cache=[])._length=0,pB._cache),pB}(),puh=function(){function ph(){this._sourceStr=null}pu(ph,"laya.webgl.text.CharSegment");var pq=ph.prototype;return pR.imps(pq,{"laya.webgl.text.ICharSegment":!0}),pq.textToSpit=function(ph){this._sourceStr=ph},pq.getChar=function(ph){return this._sourceStr.charAt(ph)},pq.getCharCode=function(ph){return this._sourceStr.charCodeAt(ph)},pq.length=function(){return this._sourceStr.length},ph}(),pvh=function(){var ph;function pb(){}return pu(pb,"laya.webgl.text.DrawText"),pb.__init__=function(){pb._charsTemp=new Array,pb._drawValue=new ph,pb._charSeg=new puh},pb.customCharSeg=function(ph){pb._charSeg=ph},pb.getChar=function(ph,pq,pf){var pg=pyh.createOneChar(ph,pf);return-1!=pq&&(pb._charsCache[pq]=pg),pg},pb._drawSlow=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU,pu,pv,pL){var pe,pl,p_=pb._drawValue.value(pP,pB,pr,pY,pu,pv,pL),pN=0,pG=0,pm=pb._charsTemp,pE=0,pR=NaN;if(pg)for(pm.length=pg.length,pN=0,pG=pg.length;pN<pG;pN++)(pl=pg[pN])&&(pR=pl.charNum+p_.txtID,pm[pN]=pe=pb._charsCache[pR]||pb.getChar(pl.char,pR,p_),pe.active());else{var pt=pf instanceof laya.utils.WordText?pf.toString():pf;if(pc.CharacterCache){pb._charSeg.textToSpit(pt);var pX=pb._charSeg.length();for(pN=0,pG=pm.length=pX;pN<pG;pN++)pR=pb._charSeg.getCharCode(pN)+p_.txtID,pm[pN]=pe=pb._charsCache[pR]||pb.getChar(pb._charSeg.getChar(pN),pR,p_),pe.active(),pE+=pe.cw}else pm.length=0,(pe=pb.getChar(pt,-1,p_)).active(),pE+=pe.cw,pm[0]=pe}var pn=0;null!==pS&&"left"!==pS&&(pn=-("center"==pS?pE/2:pE));var pJ,pp,pA=NaN,pd=0;if(pg)for(pN=0,pG=pm.length;pN<pG;pN++)pe=pm[pN],pl=pg[pN],pe&&pl&&!pe.isSpace&&(pA=pe.borderSize,pJ=pe.texture,pq._drawText(pJ,pC+pn+pl.x*pu-pA,pU+pl.y*pv-pA,pJ.width,pJ.height,p$,0,0,0,0));else{for(pN=0,pG=pm.length;pN<pG;pN++)(pe=pm[pN])&&!pe.isSpace&&(pA=pe.borderSize,pJ=pe.texture,pq._drawText(pJ,pC+pn-pA,pU-pA,pJ.width,pJ.height,p$,0,0,0,0),ph&&((pp=ph[pd++])||(pp=ph[pd-1]=[]),pp[0]=pJ,pp[1]=pn-pA,pp[2]=-pA)),pn+=pe.cw;ph&&(ph.length=pd)}},pb._drawFast=function(ph,pq,pf,pg,p$){for(var pP,pS,pB=0,pr=ph.length;pB<pr;pB++)(pP=(pS=ph[pB])[0]).active(),pq._drawText(pP,pg+pS[1],p$+pS[2],pP.width,pP.height,pf,0,0,0,0)},pb.drawText=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU){if(void 0===pU&&(pU=0),!(pq&&0===pq.length||pf&&0===pf.length)){var pu=pg.a,pv=pg.d;(0!==pg.b||0!==pg.c)&&(pu=pv=1);var pL=1!==pu||1!==pv;if(pL&&pR.stage.transform){var pe=pR.stage.transform;pL=pe.a===pu&&pe.d===pv}else pL=!1;if(pL){var pl=(pg=pg.copyTo(pth._tmpMatrix)).tx,p_=pg.ty;pg.scale(1/pu,1/pv),pg._checkTransform(),pY*=pu,pC*=pv,pY+=pl-pg.tx,pC+=p_-pg.ty}else pu=pv=1;if(pf)pb._drawSlow(null,ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pu,pv,pU);else{if(null===pq.toUpperCase){var pN=pu+1e5*pv,pG=pq;return void(pG.changed||pG.id!==pN?(pG.id=pN,pG.changed=!1,pb._drawSlow(pG.save,ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pu,pv,pU)):pb._drawFast(pG.save,ph,pg,pY,pC))}var pm=pq+p$.toString()+pS+pB+pr+pu+pv+pP,pE=pb._textsCache[pm];pc.CharacterCache?pE?pb._drawFast(pE,ph,pg,pY,pC):(pb._textsCache.__length||(pb._textsCache.__length=0),pb._textsCache.__length>pt.WebGLTextCacheCount&&((pb._textsCache={}).__length=0,pb._curPoolIndex=0),pb._textCachesPool[pb._curPoolIndex]?(pE=pb._textsCache[pm]=pb._textCachesPool[pb._curPoolIndex]).length=0:pb._textCachesPool[pb._curPoolIndex]=pE=pb._textsCache[pm]=[],pb._textsCache.__length++,pb._curPoolIndex++,pb._drawSlow(pE,ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pu,pv,pU)):pb._drawSlow(pE,ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pu,pv,pU)}}},pb._charsTemp=null,pb._textCachesPool=[],pb._curPoolIndex=0,pb._charsCache={},pb._textsCache={},pb._drawValue=null,pb.d=[],pb._charSeg=null,pb.__init$=function(){ph=function(){function pr(){}return pu(pr,""),pr.prototype.value=function(ph,pq,pf,pg,p$,pP,pS){this.font=ph,this.fillColor=pq,this.borderColor=pf,this.lineWidth=pg,this.scaleX=p$,this.scaleY=pP,this.underLine=pS;var pB=ph.toString()+p$+pP+pg+(pq?pq.toLowerCase():" ")+(pf?pf.toLowerCase():" ")+pS;return this.txtID=pr._keymap[pB],this.txtID||(this.txtID=1e-7*++pr._keymapCount,pr._keymap[pB]=this.txtID),this},pr.clear=function(){pr._keymap={},pr._keymapCount=1},pr._keymap={},pr._keymapCount=1,pr}()},pb}(),pLh=function(){function p$(ph){this._index=0,this._size=14,this._italic=-2,p$._cache2=p$._cache2||[],this.setFont(ph||"14px Arial")}pu(p$,"laya.webgl.text.FontInContext");var ph=p$.prototype;return ph.setFont=function(ph){var pq=p$._cache2[ph];if(pq)this._words=pq[0],this._size=pq[1];else{this._words=ph.split(" ");for(var pf=0,pg=this._words.length;pf<pg;pf++)if(0<this._words[pf].indexOf("px")){this._index=pf;break}this._size=parseInt(this._words[this._index]),p$._cache2[ph]=[this._words,this._size]}this._text=null,this._italic=-2},ph.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},ph.hasType=function(ph){for(var pq=0,pf=this._words.length;pq<pf;pq++)if(this._words[pq]===ph)return pq;return-1},ph.removeType=function(ph){for(var pq=0,pf=this._words.length;pq<pf;pq++)if(this._words[pq]===ph){this._words.splice(pq,1),this._index>pq&&this._index--;break}this._text=null,this._italic=-2},ph.copyTo=function(ph){return ph._text=this._text,ph._size=this._size,ph._index=this._index,ph._words=this._words.slice(),ph._italic=-2,ph},ph.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},pg(0,ph,"size",function(){return this._size},function(ph){this._size=ph,this._words[this._index]=ph+"px",this._text=null}),p$.create=function(ph){var pq=p$._cache[ph];return pq||(pq=p$._cache[ph]=new p$(ph))},p$.EMPTY=new p$,p$._cache={},p$._cache2=null,p$}(),peh=function(){function ph(){}return pu(ph,"laya.webgl.utils.CONST3D2D"),ph.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ph.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],ph.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],ph._TMPARRAY=[],ph._OFFSETX=0,ph._OFFSETY=0,pS(ph,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),ph}(),plh=function(){function pL(){}return pu(pL,"laya.webgl.utils.GlUtils"),pL.make2DProjection=function(ph,pq,pf){return[2/ph,0,0,0,0,-2/pq,0,0,0,0,2/pf,0,-1,1,0,1]},pL.fillIBQuadrangle=function(ph,pq){if(65535/4<pq)throw Error("IBQuadrangle count:"+pq+" must<:"+Math.floor(65535/4));pq=Math.floor(pq),ph._resizeBuffer(6*(pq+1)*2,!1),ph.byteLength=ph.bufferLength;for(var pf=ph.getUint16Array(),pg=0,p$=0;p$<pq;p$++)pf[pg++]=4*p$,pf[pg++]=4*p$+2,pf[pg++]=4*p$+1,pf[pg++]=4*p$,pf[pg++]=4*p$+3,pf[pg++]=4*p$+2;return ph.setNeedUpload(),!0},pL.expandIBQuadrangle=function(ph,pq){ph.bufferLength>=6*pq*2||pL.fillIBQuadrangle(ph,pq)},pL.mathCeilPowerOfTwo=function(ph){return ph--,ph|=ph>>1,ph|=ph>>2,ph|=ph>>4,ph|=ph>>8,ph|=ph>>16,++ph},pL.fillQuadrangleImgVb=function(ph,pq,pf,pg,p$,pP,pS,pB){var pr=16+(ph._byteLength>>2);ph.byteLength=pr<<2;var pY=ph.getFloat32Array();pY[(pr-=16)+2]=p$[0],pY[pr+3]=p$[1],pY[pr+6]=p$[2],pY[pr+7]=p$[3],pY[pr+10]=p$[4],pY[pr+11]=p$[5],pY[pr+14]=p$[6],pY[pr+15]=p$[7];var pC=pP.a,pU=pP.b,pu=pP.c,pv=pP.d;if(1!==pC||0!==pU||0!==pu||1!==pv){pP.bTransform=!0;var pL=pP.tx+pS,pe=pP.ty+pB;pY[pr]=(pg[0]+pq)*pC+(pg[1]+pf)*pu+pL,pY[pr+1]=(pg[0]+pq)*pU+(pg[1]+pf)*pv+pe,pY[pr+4]=(pg[2]+pq)*pC+(pg[3]+pf)*pu+pL,pY[pr+5]=(pg[2]+pq)*pU+(pg[3]+pf)*pv+pe,pY[pr+8]=(pg[4]+pq)*pC+(pg[5]+pf)*pu+pL,pY[pr+9]=(pg[4]+pq)*pU+(pg[5]+pf)*pv+pe,pY[pr+12]=(pg[6]+pq)*pC+(pg[7]+pf)*pu+pL,pY[pr+13]=(pg[6]+pq)*pU+(pg[7]+pf)*pv+pe}else pP.bTransform=!1,pq+=pP.tx+pS,pf+=pP.ty+pB,pY[pr]=pq+pg[0],pY[pr+1]=pf+pg[1],pY[pr+4]=pq+pg[2],pY[pr+5]=pf+pg[3],pY[pr+8]=pq+pg[4],pY[pr+9]=pf+pg[5],pY[pr+12]=pq+pg[6],pY[pr+13]=pf+pg[7];return ph._upload=!0},pL.fillTranglesVB=function(ph,pq,pf,pg,p$,pP,pS){var pB=(ph._byteLength>>2)+pg.length;ph.byteLength=pB<<2;var pr=ph.getFloat32Array();pB-=pg.length;for(var pY=pg.length,pC=p$.a,pU=p$.b,pu=p$.c,pv=p$.d,pL=0;pL<pY;pL+=4)if(pr[pB+pL+2]=pg[pL+2],pr[pB+pL+3]=pg[pL+3],1!==pC||0!==pU||0!==pu||1!==pv){p$.bTransform=!0;var pe=p$.tx+pP,pl=p$.ty+pS;pr[pB+pL]=(pg[pL]+pq)*pC+(pg[pL+1]+pf)*pu+pe,pr[pB+pL+1]=(pg[pL]+pq)*pU+(pg[pL+1]+pf)*pv+pl}else p$.bTransform=!1,pq+=p$.tx+pP,pf+=p$.ty+pS,pr[pB+pL]=pq+pg[pL],pr[pB+pL+1]=pf+pg[pL+1];return ph._upload=!0},pL.copyPreImgVb=function(ph,pq,pf){var pg=ph._byteLength>>2;ph.byteLength=pg+16<<2;for(var p$=ph.getFloat32Array(),pP=0,pS=pg-16;pP<4;pP++)p$[pg]=p$[pS]+pq,++pS,p$[++pg]=p$[pS]+pf,++pS,p$[++pg]=p$[pS],++pS,p$[++pg]=p$[pS],++pg,++pS;ph._upload=!0},pL.fillRectImgVb=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU,pu){void 0===pu&&(pu=!1);var pv,pL,pe,pl,p_,pN,pG,pm,pE,pR,pt,pX,pn,pJ,pp,pA,pd=1,pb=pB.a,pi=pB.b,pz=pB.c,pc=pB.d,pM=pq&&pq.width<99999999;if(1!==pb||0!==pi||0!==pz||1!==pc?(pB.bTransform=!0,0===pi&&0===pz&&(pd=23,pE=p$+pf,pR=pP+pg,pv=pb*pf+(pt=pB.tx+pr),pe=pb*pE+pt,pL=pc*pg+(pX=pB.ty+pY),pl=pc*pR+pX)):(pd=23,pB.bTransform=!1,pe=(pv=pf+pB.tx+pr)+p$,pl=(pL=pg+pB.ty+pY)+pP),pM&&(p_=pq.x,pN=pq.y,pG=pq.width+p_,pm=pq.height+pN),1!==pd){if(Math.min(pv,pe)>=pG)return!1;if(Math.min(pL,pl)>=pm)return!1;if(Math.max(pe,pv)<=p_)return!1;if(Math.max(pl,pL)<=pN)return!1}var pW=ph._byteLength>>2;ph.byteLength=16+pW<<2;var pT=ph.getFloat32Array();switch(pT[2+pW]=pS[0],pT[3+pW]=pS[1],pT[6+pW]=pS[2],pT[7+pW]=pS[3],pT[10+pW]=pS[4],pT[11+pW]=pS[5],pT[14+pW]=pS[6],pT[15+pW]=pS[7],pd){case 1:pt=pB.tx+pr,pX=pB.ty+pY;var pI=pb*pf,pw=pz*pg,pk=pc*pg,pH=pi*pf,pD=pb*(pE=p$+pf),ps=pz*(pR=pP+pg),pV=pc*pR,pK=pi*pE;pu?(pn=pI+pw+pt,pp=Math.round(pn)-pn,pJ=pk+pH+pX,pA=Math.round(pJ)-pJ,pT[pW]=pn+pp,pT[1+pW]=pJ+pA,pT[4+pW]=pD+pw+pt+pp,pT[5+pW]=pk+pK+pX+pA,pT[8+pW]=pD+ps+pt+pp,pT[9+pW]=pV+pK+pX+pA,pT[12+pW]=pI+ps+pt+pp,pT[13+pW]=pV+pH+pX+pA):(pT[pW]=pI+pw+pt,pT[1+pW]=pk+pH+pX,pT[4+pW]=pD+pw+pt,pT[5+pW]=pk+pK+pX,pT[8+pW]=pD+ps+pt,pT[9+pW]=pV+pK+pX,pT[12+pW]=pI+ps+pt,pT[13+pW]=pV+pH+pX);break;case 23:pu?(pn=pv+pC,pp=Math.round(pn)-pn,pJ=pL,pA=Math.round(pJ)-pJ,pT[pW]=pn+pp,pT[1+pW]=pJ+pA,pT[4+pW]=pe+pC+pp,pT[5+pW]=pL+pA,pT[8+pW]=pe+pp,pT[9+pW]=pl+pA,pT[12+pW]=pv+pp,pT[13+pW]=pl+pA):(pT[pW]=pv+pC,pT[1+pW]=pL,pT[4+pW]=pe+pC,pT[5+pW]=pL,pT[8+pW]=pe,pT[9+pW]=pl,pT[12+pW]=pv,pT[13+pW]=pl)}return ph._upload=!0},pL.fillLineVb=function(ph,pq,pf,pg,p$,pP,pS,pB){var pr=.5*pS,pY=pL._fillLineArray,pC=-(pg-pP),pU=pf-p$,pu=Math.sqrt(pC*pC+pU*pU);pC/=pu,pU/=pu,pC*=pr,pU*=pr,pY[0]=pf-pC,pY[1]=pg-pU,pY[4]=pf+pC,pY[5]=pg+pU,pY[8]=p$+pC,pY[9]=pP+pU,pY[12]=p$-pC,pY[13]=pP-pU,pB&&pB.transformPointArray(pY,pY);var pv=16+(ph._byteLength>>2);return ph.byteLength=pv<<2,ph.insertData(pY,pv-16),!0},pL._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pL}(),p_h=(function(){function pr(){}pu(pr,"laya.webgl.utils.MatirxArray"),pr.ArrayMul=function(ph,pq,pf){if(ph)if(pq)for(var pg=NaN,p$=NaN,pP=NaN,pS=NaN,pB=0;pB<4;pB++)pg=ph[pB],p$=ph[pB+4],pP=ph[pB+8],pS=ph[pB+12],pf[pB]=pg*pq[0]+p$*pq[1]+pP*pq[2]+pS*pq[3],pf[pB+4]=pg*pq[4]+p$*pq[5]+pP*pq[6]+pS*pq[7],pf[pB+8]=pg*pq[8]+p$*pq[9]+pP*pq[10]+pS*pq[11],pf[pB+12]=pg*pq[12]+p$*pq[13]+pP*pq[14]+pS*pq[15];else pr.copyArray(ph,pf);else pr.copyArray(pq,pf)},pr.copyArray=function(ph,pq){if(ph&&pq)for(var pf=0;pf<ph.length;pf++)pq[pf]=ph[pf]}}(),function(){function pq(ph,pq,pf){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=ph,this._vb=new pah(ph,35048),pq&&this._vb._resizeBuffer(pq,!1),this._ib=new pxh,pf&&this._ib._resizeBuffer(pf,!1)}pu(pq,"laya.webgl.utils.Mesh2D");var ph=pq.prototype;return ph.cloneWithNewVB=function(){var ph=new pq(this._stride,0,0);return ph._ib=this._ib,ph._quadNum=this._quadNum,ph._attribInfo=this._attribInfo,ph},ph.cloneWithNewVBIB=function(){var ph=new pq(this._stride,0,0);return ph._attribInfo=this._attribInfo,ph},ph.getVBW=function(){return this._vb.setNeedUpload(),this._vb},ph.getVBR=function(){return this._vb},ph.getIBR=function(){return this._ib},ph.getIBW=function(){return this._ib.setNeedUpload(),this._ib},ph.createQuadIB=function(ph){this._quadNum=ph,this._ib._resizeBuffer(6*ph*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var pq=this._ib.getUint16Array(),pf=0,pg=0,p$=0;p$<ph;p$++)pq[pf++]=pg,pq[pf++]=pg+2,pq[pf++]=pg+1,pq[pf++]=pg,pq[pf++]=pg+3,pq[pf++]=pg+2,pg+=4;this._ib.setNeedUpload()},ph.setAttributes=function(ph){if(this._attribInfo=ph,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},ph.getEleNum=function(){return this._ib.getBuffer().byteLength/2},ph.releaseMesh=function(){},ph.destroy=function(){},ph.clearVB=function(){this._vb.clear()},pq._gvaoid=0,pq}()),pNh=function(){function p$(){}return pu(p$,"laya.webgl.utils.RenderState2D"),p$.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},p$.mat2MatArray=function(ph,pq){var pf=ph,pg=pq;return pg[0]=pf.a,pg[1]=pf.b,pg[2]=p$.EMPTYMAT4_ARRAY[2],pg[3]=p$.EMPTYMAT4_ARRAY[3],pg[4]=pf.c,pg[5]=pf.d,pg[6]=p$.EMPTYMAT4_ARRAY[6],pg[7]=p$.EMPTYMAT4_ARRAY[7],pg[8]=p$.EMPTYMAT4_ARRAY[8],pg[9]=p$.EMPTYMAT4_ARRAY[9],pg[10]=p$.EMPTYMAT4_ARRAY[10],pg[11]=p$.EMPTYMAT4_ARRAY[11],pg[12]=pf.tx,pg[13]=pf.ty,pg[14]=p$.EMPTYMAT4_ARRAY[14],pg[15]=p$.EMPTYMAT4_ARRAY[15],pq},p$.restoreTempArray=function(){p$.TEMPMAT4_ARRAY[0]=1,p$.TEMPMAT4_ARRAY[1]=0,p$.TEMPMAT4_ARRAY[4]=0,p$.TEMPMAT4_ARRAY[5]=1,p$.TEMPMAT4_ARRAY[12]=0,p$.TEMPMAT4_ARRAY[13]=0},p$.clear=function(){p$.worldScissorTest=!1,p$.worldShaderDefines=null,p$.worldFilters=null,p$.worldAlpha=1,p$.worldClipRect.x=p$.worldClipRect.y=0,p$.worldClipRect.width=p$.width,p$.worldClipRect.height=p$.height,p$.curRenderTarget=null},p$._MAXSIZE=99999999,p$.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p$.worldMatrix4=p$.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p$.worldAlpha=1,p$.worldScissorTest=!1,p$.worldFilters=null,p$.worldShaderDefines=null,p$.curRenderTarget=null,p$.width=0,p$.height=0,pS(p$,["worldMatrix",function(){return this.worldMatrix=new pn},"worldClipRect",function(){return this.worldClipRect=new pp(0,0,99999999,99999999)}]),p$}(),pGh=function(){var pN,pf;function pG(ph,pq,pf,pg,p$){var pP=this;function pS(ph){var pq=[],pf=new pN(pq);return pP._compileToTree(pf,ph.split("\n"),0,pq,p$),pf}var pB=pv.now();this._VS=pS(pq),this._PS=pS(pf),this._nameMap=pg,2<pv.now()-pB&&console.log("ShaderCompile use time:"+(pv.now()-pB)+"  size:"+pq.length+"/"+pf.length)}pu(pG,"laya.webgl.utils.ShaderCompile");var ph=pG.prototype;return ph._compileToTree=function(ph,pq,pf,pg,p$){var pP,pS,pB,pr,pY,pC,pU,pu=0,pv=0,pL=0,pe=0;for(pv=pf;pv<pq.length;pv++)if(!((pB=pq[pv]).length<1)&&0!==(pu=pB.indexOf("//"))){if(0<=pu&&(pB=pB.substr(0,pu)),pP=pU||new pN(pg),pU=null,pP.text=pB,pP.noCompile=!0,0<=(pu=pB.indexOf("#"))){for(pr="#",pe=pu+1,pL=pB.length;pe<pL;pe++){var pl=pB.charAt(pe);if(" "===pl||"\t"===pl||"\r"===pl||"\n"===pl||"?"===pl)break;pr+=pl}switch(pP.name=pr){case"#ifdef":case"#ifndef":if(pP.src=pB,pP.noCompile=null!=pB.match(/[!&|()=<>]/),pP.noCompile?console.log("function():Boolean{return "+pB.substr(pu+pP.name.length)+"}"):(pC=pB.replace(/^\s*/,"").split(/\s+/),pP.setCondition(pC[1],"#ifdef"===pr?1:2),pP.text="//"+pP.text),pP.setParent(ph),ph=pP,p$)for(pC=pB.substr(pe).split(pG._splitToWordExps3),pe=0;pe<pC.length;pe++)(pB=pC[pe]).length&&(p$[pB]=!0);continue;case"#if":if(pP.src=pB,pP.noCompile=!0,pP.setParent(ph),ph=pP,p$)for(pC=pB.substr(pe).split(pG._splitToWordExps3),pe=0;pe<pC.length;pe++)(pB=pC[pe]).length&&"defined"!=pB&&(p$[pB]=!0);continue;case"#else":pP.src=pB,pS=(ph=ph.parent).childs[ph.childs.length-1],pP.noCompile=pS.noCompile,pP.noCompile||(pP.condition=pS.condition,pP.conditionType=1==pS.conditionType?2:1,pP.text="//"+pP.text+" "+pS.text+" "+pP.conditionType),pP.setParent(ph),ph=pP;continue;case"#endif":pS=(ph=ph.parent).childs[ph.childs.length-1],pP.noCompile=pS.noCompile,pP.noCompile||(pP.text="//"+pP.text),pP.setParent(ph);continue;case"#include":pC=pG.splitToWords(pB,null);var p_=pG.includes[pC[1]];if(!p_)throw"ShaderCompile error no this include file:"+pC[1];if((pu=pC[0].indexOf("?"))<0){pP.setParent(ph),pB=p_.getWith("with"==pC[2]?pC[3]:null),this._compileToTree(pP,pB.split("\n"),0,pg,p$),pP.text="";continue}pP.setCondition(pC[0].substr(pu+1),1),pP.text=p_.getWith("with"==pC[2]?pC[3]:null);break;case"#import":pY=(pC=pG.splitToWords(pB,null))[1],pg.push({node:pP,file:pG.includes[pY],ofs:pP.text.length});continue}}else{if((pS=ph.childs[ph.childs.length-1])&&!pS.name){0<pg.length&&pG.splitToWords(pB,pS),pU=pP,pS.text+="\n"+pB;continue}0<pg.length&&pG.splitToWords(pB,pP)}pP.setParent(ph)}},ph.createShader=function(ph,pq,pf){var pg={},p$="";if(ph)for(var pP in ph)p$+="#define "+pP+"\n",pg[pP]=!0;var pS=this._VS.toscript(pg,[]),pB=this._PS.toscript(pg,[]);return(pf||pQh.create)(p$+pS.join("\n"),p$+pB.join("\n"),pq,this._nameMap)},pG._parseOne=function(ph,pq,pf,pg,p$,pP){var pS={type:pG.shaderParamsMap[pf[pg+1]],name:pf[pg+2],size:isNaN(parseInt(pf[pg+3]))?1:parseInt(pf[pg+3])};return pP&&("attribute"==p$?ph.push(pS):pq.push(pS)),":"==pf[pg+3]&&(pS.type=pf[pg+4],pg+=2),pg+=2},pG.addInclude=function(ph,pq){if(!pq||0===pq.length)throw new Error("add shader include file err:"+ph);if(pG.includes[ph])throw new Error("add shader include file err, has add:"+ph);pG.includes[ph]=new pf(pq)},pG.preGetParams=function(ph,pq){var pf=[ph,pq],pg={},p$=[],pP=[],pS={},pB=[];pg.attributes=p$,pg.uniforms=pP,pg.defines=pS;for(var pr=0,pY=0,pC=0;pC<2;pC++){pf[pC]=pf[pC].replace(pG._removeAnnotation,"");var pU,pu=pf[pC].match(pG._reg);for(pr=0,pY=pu.length;pr<pY;pr++){var pv=pu[pr];if("attribute"==pv||"uniform"==pv)pr=pG._parseOne(p$,pP,pu,pr,pv,!0);else{if("#define"==pv){pB[pv=pu[++pr]]=1;continue}if("#ifdef"==pv){pS[pU=pu[++pr]]=pS[pU]||[];for(pr++;pr<pY;pr++)if("attribute"==(pv=pu[pr])||"uniform"==pv)pr=pG._parseOne(p$,pP,pu,pr,pv,pB[pU]);else if("#else"==pv)for(pr++;pr<pY;pr++)if("attribute"==(pv=pu[pr])||"uniform"==pv)pr=pG._parseOne(p$,pP,pu,pr,pv,!pB[pU]);else if("#endif"==pv)break}}}}return pg},pG.splitToWords=function(ph,pq){for(var pf,pg,p$=[],pP=-1,pS=0,pB=ph.length;pS<pB;pS++)if(pf=ph.charAt(pS),0<=" \t=+-*/&%!<>()'\",;".indexOf(pf)){if(0<=pP&&1<pS-pP&&(pg=ph.substr(pP,pS-pP),p$.push(pg)),'"'==pf||"'"==pf){var pr=ph.indexOf(pf,pS+1);if(pr<0)throw"Sharder err:"+ph;p$.push(ph.substr(pS+1,pr-pS-1)),pS=pr,pP=-1;continue}"("==pf&&pq&&0<p$.length&&(pg=p$[p$.length-1]+";","vec4;main;".indexOf(pg)<0&&(pq.useFuns+=pg)),pP=-1}else pP<0&&(pP=pS);return pP<pB&&1<pB-pP&&(pg=ph.substr(pP,pB-pP),p$.push(pg)),p$},pG.IFDEF_NO=0,pG.IFDEF_YES=1,pG.IFDEF_ELSE=2,pG.IFDEF_PARENT=3,pG._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),pG._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),pG._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),pG.includes={},pS(pG,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),pG.__init$=function(){pN=function(){function pf(ph){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=ph}pu(pf,"");var ph=pf.prototype;return ph.setParent=function(ph){ph.childs.push(this),this.z=ph.z+1,this.parent=ph},ph.setCondition=function(ph,pq){ph&&(this.conditionType=pq,ph=ph.replace(/(\s*$)/g,""),this.condition=function(){return this[ph]},this.condition.__condition=ph)},ph.toscript=function(ph,pq){return this._toscript(ph,pq,++pf.__id)},ph._toscript=function(pg,p$,pP){if(this.childs.length<1&&!this.text)return p$;p$.length;if(this.condition){var ph=!!this.condition.call(pg);if(2===this.conditionType&&(ph=!ph),!ph)return p$}if(this.text&&p$.push(this.text),0<this.childs.length&&this.childs.forEach(function(ph,pq,pf){ph._toscript(pg,p$,pP)}),0<this.includefiles.length&&0<this.useFuns.length)for(var pq,pf=0,pS=this.includefiles.length;pf<pS;pf++)this.includefiles[pf].curUseID!=pP&&0<(pq=this.includefiles[pf].file.getFunsScript(this.useFuns)).length&&(this.includefiles[pf].curUseID=pP,p$[0]=pq+p$[0]);return p$},pf.__id=1,pf}(),pf=function(){function ph(ph){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=ph;for(var pq=0,pf=0,pg=0;!((pq=ph.indexOf("#begin",pq))<0);){for(pg=pq+5;!((pg=ph.indexOf("#end",pg))<0)&&"i"===ph.charAt(pg+4);)pg+=5;if(pg<0)throw"add include err,no #end:"+ph;pf=ph.indexOf("\n",pq);var p$=pG.splitToWords(ph.substr(pq,pf-pq),null);"code"==p$[1]?this.codes[p$[2]]=ph.substr(pf+1,pg-pf-1):"function"==p$[1]&&(pf=ph.indexOf("function",pq),pf+="function".length,this.funs[p$[3]]=ph.substr(pf+1,pg-pf-1),this.funnames+=p$[3]+";"),pq=pg+1}}pu(ph,"");var pq=ph.prototype;return pq.getWith=function(ph){var pq=ph?this.codes[ph]:this.script;if(!pq)throw"get with error:"+ph;return pq},pq.getFunsScript=function(ph){var pq="";for(var pf in this.funs)0<=ph.indexOf(pf+";")&&(pq+=this.funs[pf]);return pq},ph}()},pG}(),pmh=function(){function pS(){}return pu(pS,"laya.webgl.WebGL"),pS._uint8ArraySlice=function(){for(var ph=this.length,pq=new Uint8Array(this.length),pf=0;pf<ph;pf++)pq[pf]=this[pf];return pq},pS._float32ArraySlice=function(){for(var ph=this.length,pq=new Float32Array(this.length),pf=0;pf<ph;pf++)pq[pf]=this[pf];return pq},pS._uint16ArraySlice=function(ph){var pq,pf=arguments,pg=0,p$=0;if(0===pf.length)for(pg=this.length,pq=new Uint16Array(pg),p$=0;p$<pg;p$++)pq[p$]=this[p$];else if(2===pf.length){var pP=pf[0],pS=pf[1];if(pP<pS)for(pg=pS-pP,pq=new Uint16Array(pg),p$=pP;p$<pS;p$++)pq[p$-pP]=this[p$];else pq=new Uint16Array(0)}return pq},pS.expandContext=function(){var ph=p$.prototype,pq=CanvasRenderingContext2D.prototype;pq.fillTrangles=ph.fillTrangles,poh.__int__(null),pq.setIBVB=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){void 0===pr&&(pr=0),void 0===pY&&(pY=0),null===pf&&(this._ib=this._ib||pxh.QuadrangleIB,pf=this._ib,plh.expandIBQuadrangle(pf,pg._byteLength/64+8)),this._setIBVB(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY)},pq.fillTrangles=function(ph,pq,pf,pg,p$){this._curMat=this._curMat||pn.create(),this._vb=this._vb||pah.create(),this._ib||(this._ib=pxh.create(),plh.fillIBQuadrangle(this._ib,pS/4));var pP=this._vb,pS=pg.length>>4;plh.fillTranglesVB(pP,pq,pf,pg,p$||this._curMat,0,0),plh.expandIBQuadrangle(this._ib,pP._byteLength/64+8);var pB=new pXh(1,0);pB.textureHost=ph;var pr=new pjh("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");pP._vertType=3,this._setIBVB(pq,pf,this._ib,pP,6*pS,p$,pr,pB,0,0)}},pS.enable=function(){if(pv.__init__(),p_.isConchApp&&!p_.isConchWebGL)return pE.skinAniSprite=function(){return new phh},pS.expandContext(),!1;if(pE.getWebGLContext=function(ph){for(var pq,pf=["webgl","experimental-webgl","webkit-3d","moz-webgl"],pg=0;pg<pf.length;pg++){try{pq=ph.getContext(pf[pg],{stencil:pt.isStencil,alpha:pt.isAlpha,antialias:pt.isAntialias,premultipliedAlpha:pt.premultipliedAlpha,preserveDrawingBuffer:pt.preserveDrawingBuffer})}catch(ph){}if(pq)return pq}return null},null==(pS.mainContext=pE.getWebGLContext(p_._mainCanvas)))return!1;if(p_.isWebGL)return!0;pe.create=function(ph,pq){return new phq(ph,pq)},pl.create=function(ph,pq,pf,pg,p$,pP,pS){return new pZh(ph,pq,pf,pg,p$,pP,pS)},p_.WebGL=pS,p_.isWebGL=!0,pvh.__init__(),pE.createRenderSprite=function(ph,pq){return new pnh(ph,pq)},pE.createWebGLContext2D=function(ph){return new pth(ph)},pE.changeWebGLSize=function(ph,pq){laya.webgl.WebGL.onStageResize(ph,pq)},pE.createGraphics=function(){return new pRh};var ph=pE.createFilterAction;return pE.createFilterAction=ph||function(ph){return new pJh},pE.clear=function(ph){pNh.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var pq=p_.context.ctx,pf=0==pq._submits._length||pt.preserveDrawingBuffer?pL.create(ph)._color:pd._wgColor;pf&&pq.clearBG(pf[0],pf[1],pf[2],pf[3]),pNh.clear()},pE.addToAtlas=function(ph,pq){void 0===pq&&(pq=!1);var pf=ph.bitmap;p_.optimizeTextureMemory(ph.url,ph)?pR.__typeof(pf,"laya.webgl.resource.IMergeAtlasBitmap")&&pf.allowMerageInAtlas&&pf.on("recovered",ph,ph.addTextureToAtlas):pf.enableMerageInAtlas=!1},pE.isAtlas=function(ph){return ph instanceof laya.webgl.atlas.AtlasWebGLCanvas},pH._enable(),pE.beginFlush=function(){for(var ph=pH.instance,pq=ph.getAtlaserCount(),pf=0;pf<pq;pf++){var pg=ph.getAtlaserByIndex(pf).texture;pg._flashCacheImageNeedFlush&&pE.flashFlushImage(pg)}},pE.drawToCanvas=function(ph,pq,pf,pg,p$,pP){(pf<=0||pg<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),pf|=0,pg|=0,p$|=0,pP|=0;var pS=pTh.create(pf,pg,6408,5121,0,!1);pS.start(),pS.clear(0,0,0,0),p_.context.clear(),pN.renders[pq]._fun(ph,p_.context,p$,pNh.height-pg+pP),p_.context.flush(),pS.end();var pB=pS.getData(0,0,pf,pg);if(pS.recycle(),pB.byteLength==pf*pg*4){var pr=new pKh;pr._canvas=pv.createElement("canvas"),pr.size(pf,pg);var pY=pr._canvas.getContext("2d");pv.canvas.size(pf,pg);var pC=pv.context,pU=pC.createImageData(pf,pg);return pU.data.set(new Uint8ClampedArray(pB.buffer)),pr._imgData=pU,pC.putImageData(pU,0,0),pY.save(),pY.translate(0,pg),pY.scale(1,-1),pY.drawImage(pv.canvas.source,0,0),pY.restore(),pr}console.log("drawToCanvas error: w:"+pf+",h:"+pg+",datalen:"+pB.byteLength)},pE.createFilterAction=function(ph){var pq;switch(ph){case 32:pq=new pJh}return pq},pE.addTextureToAtlas=function(ph){ph._uvID++,pH._atlasRestore++,ph.bitmap.enableMerageInAtlas&&pH.instance.addToAtlas(ph)},pE.getTexturePixels=function(ph,pq,pf,pg,p$){p_.context.ctx.clear();var pP=new pA;pP.graphics.drawTexture(ph,-pq,-pf);var pS=pTh.create(pg,p$);pS.start(),pS.clear(0,0,0,0),pP.render(p_.context,0,0),p_.context.ctx.flush(),pS.end();for(var pB=pS.getData(0,0,pg,p$),pr=[],pY=0,pC=p$-1;0<=pC;pC--)for(var pU=0;pU<pg;pU++)pY=4*(pC*pg+pU),pr.push(pB[pY]),pr.push(pB[pY+1]),pr.push(pB[pY+2]),pr.push(pB[pY+3]);return pr},pE.skinAniSprite=function(){return new phh},pY.create=function(ph,pq){var pf=new pKh;return pf._imgData=pq,pf.flipY=!1,pf},pX._filterStart=function(ph,pq,pf,pg,p$){var pP=ph.getValue("bounds"),pS=pTh.create(pP.width,pP.height);if(pS.start(),pS.clear(0,0,0,0),ph.addValue("src",pS),ph.addValue("ScissorTest",pNh.worldScissorTest),pNh.worldScissorTest){var pB=new pp;pB.copyFrom(pf.ctx._clipRect),ph.addValue("clipRect",pB),pNh.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},pX._filterEnd=function(ph,pq,pf,pg,p$){var pP=ph.getValue("bounds");ph.getValue("src").end();var pS=pTh.create(pP.width,pP.height);pS.start(),pS.clear(0,0,0,0),ph.addValue("out",pS),pq._set$P("_filterCache",pS),pq._set$P("_isHaveGlowFilter",ph.getValue("_isHaveGlowFilter"))},pX._EndTarget=function(ph,pq){if(ph.getValue("src").recycle(),ph.getValue("out").end(),ph.getValue("ScissorTest")){pNh.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),pq.ctx.save();var pf=ph.getValue("clipRect");pq.ctx.clipRect(pf.x,pf.y,pf.width,pf.height)}},pX._useSrc=function(ph){var pq=ph.getValue("out");pq.end(),(pq=ph.getValue("src")).start(),pq.clear(0,0,0,0)},pX._endSrc=function(ph){ph.getValue("src").end()},pX._useOut=function(ph){var pq=ph.getValue("src");pq.end(),(pq=ph.getValue("out")).start(),pq.clear(0,0,0,0)},pX._endOut=function(ph){ph.getValue("out").end()},pX._recycleScope=function(ph){ph.recycle()},pX._filter=function(ph,pq,pf,pg){var p$=this._next;if(p$){var pP,pS,pB=ph.filters,pr=pB.length;if(1==pr&&32==pB[0].type)return pq.ctx.save(),pq.ctx.setFilters([pB[0]]),p$._fun.call(p$,ph,pq,pf,pg),void pq.ctx.restore();var pY=pBh.create(),pC=pJ.TEMP,pU=pq.ctx._getTransformMatrix(),pu=pn.create();pU.copyTo(pu);var pv=0,pL=0,pe=!1,pl=ph._$P._filterCache?ph._$P._filterCache:null;if(!pl||ph._repaint){pe=ph._isHaveGlowFilter(),pY.addValue("_isHaveGlowFilter",pe),pe&&(pv=50,pL=25),(pS=new pp).copyFrom(ph.getSelfBounds()),pS.x+=ph.x,pS.y+=ph.y,pS.x-=ph.pivotX+4,pS.y-=ph.pivotY+4;var p_=pS.x,pN=pS.y;if(pS.width+=pv+8,pS.height+=pv+8,pC.x=pS.x*pu.a+pS.y*pu.c,pC.y=pS.y*pu.d+pS.x*pu.b,pS.x=pC.x,pS.y=pC.y,pC.x=pS.width*pu.a+pS.height*pu.c,pC.y=pS.height*pu.d+pS.width*pu.b,pS.width=pC.x,pS.height=pC.y,pS.width<=0||pS.height<=0)return;pl&&pl.recycle(),pY.addValue("bounds",pS);var pG=pSh.create([pY,ph,pq,0,0],pX._filterStart);pq.addRenderObject(pG),pq.ctx._renderKey=0,pq.ctx._shader2D.glTexture=null;var pm=ph.x-p_+pL,pE=ph.y-pN+pL;p$._fun.call(p$,ph,pq,pm,pE),pG=pSh.create([pY,ph,pq,0,0],pX._filterEnd),pq.addRenderObject(pG);for(var pR=0;pR<pr;pR++){0!=pR&&(pG=pSh.create([pY],pX._useSrc),pq.addRenderObject(pG),pP=pXh.create(1,0),pn.TEMP.identity(),pq.ctx.drawTarget(pY,0,0,pS.width,pS.height,pn.TEMP,"out",pP,null,ps.TOINT.overlay),pG=pSh.create([pY],pX._useOut),pq.addRenderObject(pG)),pB[pR].action.apply3d(pY,ph,pq,0,0)}pG=pSh.create([pY,pq],pX._EndTarget),pq.addRenderObject(pG)}else{if((pe=!!ph._$P._isHaveGlowFilter&&ph._$P._isHaveGlowFilter)&&(pv=50,pL=25),(pS=ph.getBounds()).width<=0||pS.height<=0)return;pS.width+=pv,pS.height+=pv,pC.x=pS.x*pu.a+pS.y*pu.c,pC.y=pS.y*pu.d+pS.x*pu.b,pS.x=pC.x,pS.y=pC.y,pC.x=pS.width*pu.a+pS.height*pu.c,pC.y=pS.height*pu.d+pS.width*pu.b,pS.width=pC.x,pS.height=pC.y,pY.addValue("out",pl)}pf=pf-pL-ph.x,pg=pg-pL-ph.y,pC.setTo(pf,pg),pu.transformPoint(pC),pf=pC.x+pS.x,pg=pC.y+pS.y,pP=pXh.create(1,0),pn.TEMP.identity(),pq.ctx.drawTarget(pY,pf,pg,pS.width,pS.height,pn.TEMP,"out",pP,null,ps.TOINT.overlay),pG=pSh.create([pY],pX._recycleScope),pq.addRenderObject(pG),pu.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=pS._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=pS._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=pS._uint8ArraySlice),!0},pS.onStageResize=function(ph,pq){null!=pS.mainContext&&(pS.mainContext.viewport(0,0,ph,pq),pNh.width=ph,pNh.height=pq)},pS.onInvalidGLRes=function(){pH.instance.freeAll(),pm.releaseContentManagers(!0),pS.doNodeRepaint(pR.stage),pS.mainContext.viewport(0,0,pNh.width,pNh.height),pR.stage.event("devicelost")},pS.doNodeRepaint=function(ph){0==ph.numChildren&&ph.repaint();for(var pq=0;pq<ph.numChildren;pq++)pS.doNodeRepaint(ph.getChildAt(pq))},pS.init=function(ph,pq,pf){pS.mainCanvas=ph,pY._createContext=function(ph){return new pth(ph)},pKh._createContext=function(ph){return new pth(ph)};var pg=laya.webgl.WebGL.mainContext;if(null!=pg.getShaderPrecisionFormat){var p$=pg.getShaderPrecisionFormat(35633,36338),pP=pg.getShaderPrecisionFormat(35632,36338);pS.shaderHighPrecision=!(!p$.precision||!pP.precision)}else pS.shaderHighPrecision=!1;if(pg.deleteTexture1=pg.deleteTexture,pg.deleteTexture=function(ph){ph==pEh.curBindTexValue&&(pEh.curBindTexValue=null),pg.deleteTexture1(ph)},pS.onStageResize(pq,pf),null==pS.mainContext)throw new Error("webGL getContext err!");pz.__init__(),pH.__init__(),pAh.__init__(),pPh.__init__(),pth.__init__(),pXh.__init__(),px.__init__(),poh.__int__(pg),ps._init_(pg),p_.isConchApp&&conch.setOnInvalidGLRes(pS.onInvalidGLRes)},pS.mainCanvas=null,pS.mainContext=null,pS.antialias=!0,pS.shaderHighPrecision=!1,pS._bg_null=[0,0,0,0],pS}(),pEh=function(){function pg(){}return pu(pg,"laya.webgl.WebGLContext"),pg.UseProgram=function(ph){return pg._useProgram!==ph&&(pmh.mainContext.useProgram(ph),pg._useProgram=ph,!0)},pg.setDepthTest=function(ph,pq){pq!==pg._depthTest&&((pg._depthTest=pq)?ph.enable(2929):ph.disable(2929))},pg.setDepthMask=function(ph,pq){pq!==pg._depthMask&&(pg._depthMask=pq,ph.depthMask(pq))},pg.setDepthFunc=function(ph,pq){pq!==pg._depthFunc&&(pg._depthFunc=pq,ph.depthFunc(pq))},pg.setBlend=function(ph,pq){pq!==pg._blend&&((pg._blend=pq)?ph.enable(3042):ph.disable(3042))},pg.setBlendFunc=function(ph,pq,pf){(pq!==pg._sFactor||pf!==pg._dFactor)&&(pg._sFactor=pq,pg._dFactor=pf,ph.blendFunc(pq,pf))},pg.setCullFace=function(ph,pq){pq!==pg._cullFace&&((pg._cullFace=pq)?ph.enable(2884):ph.disable(2884))},pg.setFrontFace=function(ph,pq){pq!==pg._frontFace&&(pg._frontFace=pq,ph.frontFace(pq))},pg.bindTexture=function(ph,pq,pf){ph.bindTexture(pq,pf),pg.curBindTexTarget=pq,pg.curBindTexValue=pf},pg.DEPTH_BUFFER_BIT=256,pg.STENCIL_BUFFER_BIT=1024,pg.COLOR_BUFFER_BIT=16384,pg.POINTS=0,pg.LINES=1,pg.LINE_LOOP=2,pg.LINE_STRIP=3,pg.TRIANGLES=4,pg.TRIANGLE_STRIP=5,pg.TRIANGLE_FAN=6,pg.ZERO=0,pg.ONE=1,pg.SRC_COLOR=768,pg.ONE_MINUS_SRC_COLOR=769,pg.SRC_ALPHA=770,pg.ONE_MINUS_SRC_ALPHA=771,pg.DST_ALPHA=772,pg.ONE_MINUS_DST_ALPHA=773,pg.DST_COLOR=774,pg.ONE_MINUS_DST_COLOR=775,pg.SRC_ALPHA_SATURATE=776,pg.FUNC_ADD=32774,pg.BLEND_EQUATION=32777,pg.BLEND_EQUATION_RGB=32777,pg.BLEND_EQUATION_ALPHA=34877,pg.FUNC_SUBTRACT=32778,pg.FUNC_REVERSE_SUBTRACT=32779,pg.BLEND_DST_RGB=32968,pg.BLEND_SRC_RGB=32969,pg.BLEND_DST_ALPHA=32970,pg.BLEND_SRC_ALPHA=32971,pg.CONSTANT_COLOR=32769,pg.ONE_MINUS_CONSTANT_COLOR=32770,pg.CONSTANT_ALPHA=32771,pg.ONE_MINUS_CONSTANT_ALPHA=32772,pg.BLEND_COLOR=32773,pg.ARRAY_BUFFER=34962,pg.ELEMENT_ARRAY_BUFFER=34963,pg.ARRAY_BUFFER_BINDING=34964,pg.ELEMENT_ARRAY_BUFFER_BINDING=34965,pg.STREAM_DRAW=35040,pg.STATIC_DRAW=35044,pg.DYNAMIC_DRAW=35048,pg.BUFFER_SIZE=34660,pg.BUFFER_USAGE=34661,pg.CURRENT_VERTEX_ATTRIB=34342,pg.FRONT=1028,pg.BACK=1029,pg.CULL_FACE=2884,pg.FRONT_AND_BACK=1032,pg.BLEND=3042,pg.DITHER=3024,pg.STENCIL_TEST=2960,pg.DEPTH_TEST=2929,pg.SCISSOR_TEST=3089,pg.POLYGON_OFFSET_FILL=32823,pg.SAMPLE_ALPHA_TO_COVERAGE=32926,pg.SAMPLE_COVERAGE=32928,pg.NO_ERROR=0,pg.INVALID_ENUM=1280,pg.INVALID_VALUE=1281,pg.INVALID_OPERATION=1282,pg.OUT_OF_MEMORY=1285,pg.CW=2304,pg.CCW=2305,pg.LINE_WIDTH=2849,pg.ALIASED_POINT_SIZE_RANGE=33901,pg.ALIASED_LINE_WIDTH_RANGE=33902,pg.CULL_FACE_MODE=2885,pg.FRONT_FACE=2886,pg.DEPTH_RANGE=2928,pg.DEPTH_WRITEMASK=2930,pg.DEPTH_CLEAR_VALUE=2931,pg.DEPTH_FUNC=2932,pg.STENCIL_CLEAR_VALUE=2961,pg.STENCIL_FUNC=2962,pg.STENCIL_FAIL=2964,pg.STENCIL_PASS_DEPTH_FAIL=2965,pg.STENCIL_PASS_DEPTH_PASS=2966,pg.STENCIL_REF=2967,pg.STENCIL_VALUE_MASK=2963,pg.STENCIL_WRITEMASK=2968,pg.STENCIL_BACK_FUNC=34816,pg.STENCIL_BACK_FAIL=34817,pg.STENCIL_BACK_PASS_DEPTH_FAIL=34818,pg.STENCIL_BACK_PASS_DEPTH_PASS=34819,pg.STENCIL_BACK_REF=36003,pg.STENCIL_BACK_VALUE_MASK=36004,pg.STENCIL_BACK_WRITEMASK=36005,pg.VIEWPORT=2978,pg.SCISSOR_BOX=3088,pg.COLOR_CLEAR_VALUE=3106,pg.COLOR_WRITEMASK=3107,pg.UNPACK_ALIGNMENT=3317,pg.PACK_ALIGNMENT=3333,pg.MAX_TEXTURE_SIZE=3379,pg.MAX_VIEWPORT_DIMS=3386,pg.SUBPIXEL_BITS=3408,pg.RED_BITS=3410,pg.GREEN_BITS=3411,pg.BLUE_BITS=3412,pg.ALPHA_BITS=3413,pg.DEPTH_BITS=3414,pg.STENCIL_BITS=3415,pg.POLYGON_OFFSET_UNITS=10752,pg.POLYGON_OFFSET_FACTOR=32824,pg.TEXTURE_BINDING_2D=32873,pg.SAMPLE_BUFFERS=32936,pg.SAMPLES=32937,pg.SAMPLE_COVERAGE_VALUE=32938,pg.SAMPLE_COVERAGE_INVERT=32939,pg.NUM_COMPRESSED_TEXTURE_FORMATS=34466,pg.COMPRESSED_TEXTURE_FORMATS=34467,pg.DONT_CARE=4352,pg.FASTEST=4353,pg.NICEST=4354,pg.GENERATE_MIPMAP_HINT=33170,pg.BYTE=5120,pg.UNSIGNED_BYTE=5121,pg.SHORT=5122,pg.UNSIGNED_SHORT=5123,pg.INT=5124,pg.UNSIGNED_INT=5125,pg.FLOAT=5126,pg.DEPTH_COMPONENT=6402,pg.ALPHA=6406,pg.RGB=6407,pg.RGBA=6408,pg.LUMINANCE=6409,pg.LUMINANCE_ALPHA=6410,pg.UNSIGNED_SHORT_4_4_4_4=32819,pg.UNSIGNED_SHORT_5_5_5_1=32820,pg.UNSIGNED_SHORT_5_6_5=33635,pg.FRAGMENT_SHADER=35632,pg.VERTEX_SHADER=35633,pg.MAX_VERTEX_ATTRIBS=34921,pg.MAX_VERTEX_UNIFORM_VECTORS=36347,pg.MAX_VARYING_VECTORS=36348,pg.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,pg.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,pg.MAX_TEXTURE_IMAGE_UNITS=34930,pg.MAX_FRAGMENT_UNIFORM_VECTORS=36349,pg.SHADER_TYPE=35663,pg.DELETE_STATUS=35712,pg.LINK_STATUS=35714,pg.VALIDATE_STATUS=35715,pg.ATTACHED_SHADERS=35717,pg.ACTIVE_UNIFORMS=35718,pg.ACTIVE_ATTRIBUTES=35721,pg.SHADING_LANGUAGE_VERSION=35724,pg.CURRENT_PROGRAM=35725,pg.NEVER=512,pg.LESS=513,pg.EQUAL=514,pg.LEQUAL=515,pg.GREATER=516,pg.NOTEQUAL=517,pg.GEQUAL=518,pg.ALWAYS=519,pg.KEEP=7680,pg.REPLACE=7681,pg.INCR=7682,pg.DECR=7683,pg.INVERT=5386,pg.INCR_WRAP=34055,pg.DECR_WRAP=34056,pg.VENDOR=7936,pg.RENDERER=7937,pg.VERSION=7938,pg.NEAREST=9728,pg.LINEAR=9729,pg.NEAREST_MIPMAP_NEAREST=9984,pg.LINEAR_MIPMAP_NEAREST=9985,pg.NEAREST_MIPMAP_LINEAR=9986,pg.LINEAR_MIPMAP_LINEAR=9987,pg.TEXTURE_MAG_FILTER=10240,pg.TEXTURE_MIN_FILTER=10241,pg.TEXTURE_WRAP_S=10242,pg.TEXTURE_WRAP_T=10243,pg.TEXTURE_2D=3553,pg.TEXTURE=5890,pg.TEXTURE_CUBE_MAP=34067,pg.TEXTURE_BINDING_CUBE_MAP=34068,pg.TEXTURE_CUBE_MAP_POSITIVE_X=34069,pg.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,pg.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,pg.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,pg.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,pg.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,pg.MAX_CUBE_MAP_TEXTURE_SIZE=34076,pg.TEXTURE0=33984,pg.TEXTURE1=33985,pg.TEXTURE2=33986,pg.TEXTURE3=33987,pg.TEXTURE4=33988,pg.TEXTURE5=33989,pg.TEXTURE6=33990,pg.TEXTURE7=33991,pg.TEXTURE8=33992,pg.TEXTURE9=33993,pg.TEXTURE10=33994,pg.TEXTURE11=33995,pg.TEXTURE12=33996,pg.TEXTURE13=33997,pg.TEXTURE14=33998,pg.TEXTURE15=33999,pg.TEXTURE16=34e3,pg.TEXTURE17=34001,pg.TEXTURE18=34002,pg.TEXTURE19=34003,pg.TEXTURE20=34004,pg.TEXTURE21=34005,pg.TEXTURE22=34006,pg.TEXTURE23=34007,pg.TEXTURE24=34008,pg.TEXTURE25=34009,pg.TEXTURE26=34010,pg.TEXTURE27=34011,pg.TEXTURE28=34012,pg.TEXTURE29=34013,pg.TEXTURE30=34014,pg.TEXTURE31=34015,pg.ACTIVE_TEXTURE=34016,pg.REPEAT=10497,pg.CLAMP_TO_EDGE=33071,pg.MIRRORED_REPEAT=33648,pg.FLOAT_VEC2=35664,pg.FLOAT_VEC3=35665,pg.FLOAT_VEC4=35666,pg.INT_VEC2=35667,pg.INT_VEC3=35668,pg.INT_VEC4=35669,pg.BOOL=35670,pg.BOOL_VEC2=35671,pg.BOOL_VEC3=35672,pg.BOOL_VEC4=35673,pg.FLOAT_MAT2=35674,pg.FLOAT_MAT3=35675,pg.FLOAT_MAT4=35676,pg.SAMPLER_2D=35678,pg.SAMPLER_CUBE=35680,pg.VERTEX_ATTRIB_ARRAY_ENABLED=34338,pg.VERTEX_ATTRIB_ARRAY_SIZE=34339,pg.VERTEX_ATTRIB_ARRAY_STRIDE=34340,pg.VERTEX_ATTRIB_ARRAY_TYPE=34341,pg.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,pg.VERTEX_ATTRIB_ARRAY_POINTER=34373,pg.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,pg.COMPILE_STATUS=35713,pg.LOW_FLOAT=36336,pg.MEDIUM_FLOAT=36337,pg.HIGH_FLOAT=36338,pg.LOW_INT=36339,pg.MEDIUM_INT=36340,pg.HIGH_INT=36341,pg.FRAMEBUFFER=36160,pg.RENDERBUFFER=36161,pg.RGBA4=32854,pg.RGB5_A1=32855,pg.RGB565=36194,pg.DEPTH_COMPONENT16=33189,pg.STENCIL_INDEX=6401,pg.STENCIL_INDEX8=36168,pg.DEPTH_STENCIL=34041,pg.RENDERBUFFER_WIDTH=36162,pg.RENDERBUFFER_HEIGHT=36163,pg.RENDERBUFFER_INTERNAL_FORMAT=36164,pg.RENDERBUFFER_RED_SIZE=36176,pg.RENDERBUFFER_GREEN_SIZE=36177,pg.RENDERBUFFER_BLUE_SIZE=36178,pg.RENDERBUFFER_ALPHA_SIZE=36179,pg.RENDERBUFFER_DEPTH_SIZE=36180,pg.RENDERBUFFER_STENCIL_SIZE=36181,pg.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,pg.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,pg.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,pg.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,pg.COLOR_ATTACHMENT0=36064,pg.DEPTH_ATTACHMENT=36096,pg.STENCIL_ATTACHMENT=36128,pg.DEPTH_STENCIL_ATTACHMENT=33306,pg.NONE=0,pg.FRAMEBUFFER_COMPLETE=36053,pg.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,pg.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,pg.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,pg.FRAMEBUFFER_UNSUPPORTED=36061,pg.FRAMEBUFFER_BINDING=36006,pg.RENDERBUFFER_BINDING=36007,pg.MAX_RENDERBUFFER_SIZE=34024,pg.INVALID_FRAMEBUFFER_OPERATION=1286,pg.UNPACK_FLIP_Y_WEBGL=37440,pg.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,pg.CONTEXT_LOST_WEBGL=37442,pg.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,pg.BROWSER_DEFAULT_WEBGL=37444,pg._useProgram=null,pg._depthTest=!0,pg._depthMask=!0,pg._blend=!1,pg._cullFace=!1,pg.curBindTexTarget=null,pg.curBindTexValue=null,pS(pg,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),pg}(),pRh=function(ph){function pq(){pq.__super.call(this)}pu(pq,"laya.webgl.display.GraphicsGL",pB);var pf=pq.prototype;return pf.setShader=function(ph){this._saveToCmd(p_.context._setShader,[ph])},pf.setIBVB=function(ph,pq,pf,pg,p$,pP){this._saveToCmd(p_.context._setIBVB,[ph,pq,pf,pg,p$,pP])},pf.drawParticle=function(ph,pq,pf){var pg=pE.createParticleTemplate2D(pf);pg.x=ph,pg.y=pq,this._saveToCmd(p_.context._drawParticle,[pg])},pq}(),pth=function(ph){var pf;function pk(ph){this._x=0,this._y=0,this._id=++pk._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,pk.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=pk.MAXCLIPRECT,this.mOutPoint,this._canvas=ph,this._canvas._addReference(),pk._contextcount++,p_.isFlash?(this._ib=pxh.create(35044),plh.fillIBQuadrangle(this._ib,16)):this._ib=pxh.QuadrangleIB,this.clear()}pu(pk,"laya.webgl.canvas.WebGLContext2D",p$);var pq=pk.prototype;return pq.setIsMainContext=function(){this._isMain=!0},pq.clearBG=function(ph,pq,pf,pg){var p$=pmh.mainContext;p$.clearColor(ph,pq,pf,pg),p$.clear(16384)},pq._getSubmits=function(){return this._submits},pq._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var ph=0,pq=this._submits._length;ph<pq;ph++)this._submits[ph].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},pq.destroy=function(){--pk._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=pxh.QuadrangleIB&&this._ib.releaseResource()},pq.clear=function(){this._submits||(this._other=pf.DEFAULT,this._curMat=pn.create(),this._vb=pah.create(-1),this._submits=[],this._save=[pQ.Create(this)],this._save.length=10,this._shader2D=new px,this._triangleMesh=pMh.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=pf.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=pk.MAXCLIPRECT,this._curSubmit=pPh.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=pV.DEFAULT;for(var ph=0,pq=this._submits._length;ph<pq;ph++)this._submits[ph].releaseRender(),this._submits[ph]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},pq.size=function(ph,pq){if(this._width!=ph||this._height!=pq)if(0==ph||0==pq){0!=this._vb._byteLength&&(this._width=ph,this._height=pq,this._vb.clear(),this._vb.upload());for(var pf=0,pg=this._submits._length;pf<pg;pf++)this._submits[pf].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=ph,this._height=pq,this._targets&&this._targets.size(ph,pq),this._canvas.memorySize-=this._canvas.memorySize;0===ph&&0===pq&&this._releaseMem()},pq._getTransformMatrix=function(){return this._curMat},pq.translate=function(ph,pq){0===ph&&0===pq||(pO.save(this),this._curMat.bTransform&&(po.save(this),this._curMat.transformPointN(pJ.TEMP.setTo(ph,pq)),ph=pJ.TEMP.x,pq=pJ.TEMP.y),this._x+=ph,this._y+=pq)},pq.save=function(){this._save[this._save._length++]=pQ.Create(this)},pq.restore=function(){var ph=this._save._length;if(!(ph<1))for(var pq=ph-1;0<=pq;pq--){var pf=this._save[pq];if(pf.restore(this),pf.isSaveMark())return void(this._save._length=pq)}},pq._fillText=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){void 0===pY&&(pY=0);var pC=this._shader2D,pU=this._curSubmit.shaderValue,pu=p$?pLh.create(p$):this._other.font;if(pH.enabled)pC.ALPHA!==pU.ALPHA&&(pC.glTexture=null),pvh.drawText(this,ph,pq,this._curMat,pu,pr||this._other.textAlign,pP,pS,pB,pf,pg,pY);else{this._shader2D.defines.getValue();var pv=pP?pL.create(pP)._color:pC.colorAdd;pC.ALPHA===pU.ALPHA&&pv===pC.colorAdd&&pU.colorAdd===pC.colorAdd||(pC.glTexture=null,pC.colorAdd=pv),pvh.drawText(this,ph,pq,this._curMat,pu,pr||this._other.textAlign,pP,pS,pB,pf,pg,pY)}},pq.fillWords=function(ph,pq,pf,pg,p$,pP){this._fillText(null,ph,pq,pf,pg,p$,null,-1,null,pP)},pq.fillBorderWords=function(ph,pq,pf,pg,p$,pP,pS){this._fillBorderText(null,ph,pq,pf,pg,p$,pP,pS,null)},pq.fillText=function(ph,pq,pf,pg,p$,pP){this._fillText(ph,null,pq,pf,pg,p$,null,-1,pP)},pq.strokeText=function(ph,pq,pf,pg,p$,pP,pS){this._fillText(ph,null,pq,pf,pg,null,p$,pP||1,pS)},pq.fillBorderText=function(ph,pq,pf,pg,p$,pP,pS,pB){this._fillBorderText(ph,null,pq,pf,pg,p$,pP,pS,pB)},pq._fillBorderText=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){if(!pH.enabled)return this._fillText(ph,pq,pf,pg,p$,null,pS,pB||1,pr),void this._fillText(ph,pq,pf,pg,p$,pP,null,-1,pr);var pY=this._shader2D,pC=this._curSubmit.shaderValue;pY.ALPHA!==pC.ALPHA&&(pY.glTexture=null);var pU=p$?(pk._fontTemp.setFont(p$),pk._fontTemp):this._other.font;pvh.drawText(this,ph,pq,this._curMat,pU,pr||this._other.textAlign,pP,pS,pB||1,pf,pg,0)},pq.fillRect=function(ph,pq,pf,pg,p$){var pP=this._vb;if(plh.fillRectImgVb(pP,this._clipRect,ph,pq,pf,pg,pM.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var pS=this._shader2D.fillStyle;p$&&(this._shader2D.fillStyle=pV.create(p$));var pB=this._shader2D,pr=this._curSubmit.shaderValue;if(pB.fillStyle!==pr.fillStyle||pB.ALPHA!==pr.ALPHA){pB.glTexture=null;var pY=this._curSubmit=pPh.createSubmit(this,this._ib,pP,(pP._byteLength-64)/32*3,pXh.create(2,0));pY.shaderValue.color=pB.fillStyle._color._color,pY.shaderValue.ALPHA=pB.ALPHA,this._submits[this._submits._length++]=pY}this._curSubmit._numEle+=6,this._shader2D.fillStyle=pS}},pq.fillTexture=function(ph,pq,pf,pg,p$,pP,pS,pB){if(ph.loaded&&ph.bitmap&&ph.source){var pr=this._vb,pY=ph.bitmap.width,pC=ph.bitmap.height,pU=ph.uv,pu=pS.x%ph.width,pv=pS.y%ph.height;if(pY!=pB.w||pC!=pB.h){if(!pB.w&&!pB.h)switch(pB.oy=pB.ox=0,pP){case"repeat":pB.width=pg,pB.height=p$;break;case"repeat-x":pB.width=pg,pv<0?ph.height+pv>p$?pB.height=p$:pB.height=ph.height+pv:(pB.oy=pv,ph.height+pv>p$?pB.height=p$-pv:pB.height=ph.height);break;case"repeat-y":pu<0?ph.width+pu>pg?pB.width=pg:pB.width=ph.width+pu:(pB.ox=pu,ph.width+pu>pg?pB.width=pg-pu:pB.width=ph.width),pB.height=p$;break;case"no-repeat":pu<0?ph.width+pu>pg?pB.width=pg:pB.width=ph.width+pu:(pB.ox=pu,ph.width+pu>pg?pB.width=pg-pu:pB.width=ph.width),pv<0?ph.height+pv>p$?pB.height=p$:pB.height=ph.height+pv:(pB.oy=pv,ph.height+pv>p$?pB.height=p$-pv:pB.height=ph.height);break;default:pB.width=pg,pB.height=p$}pB.w=pY,pB.h=pC,pB.uv=[0,0,pB.width/pY,0,pB.width/pY,pB.height/pC,0,pB.height/pC]}if(pq+=pB.ox,pf+=pB.oy,pu-=pB.ox,pv-=pB.oy,plh.fillRectImgVb(pr,this._clipRect,pq,pf,pB.width,pB.height,pB.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var pL=pch.create(this,this._ib,pr,(pr._byteLength-64)/32*3,pXh.create(256,0)),pe=(this._submits[this._submits._length++]=pL).shaderValue;pe.textureHost=ph;var pl=pU[0]*pY,p_=pU[1]*pC,pN=(pU[2]-pU[0])*pY,pG=(pU[5]-pU[3])*pC,pm=-pu/pY,pE=-pv/pC;pe.u_TexRange[0]=pl/pY,pe.u_TexRange[1]=pN/pY,pe.u_TexRange[2]=p_/pC,pe.u_TexRange[3]=pG/pC,pe.u_offset[0]=pm,pe.u_offset[1]=pE,pH.enabled&&!this._isMain&&pL.addTexture(ph,(pr._byteLength>>2)-16),(this._curSubmit=pL)._renderType=10017,pL._numEle+=6}}else this.sprite&&pR.timer.callLater(this,this._repaintSprite)},pq.setShader=function(ph){py.save(this,1048576,this._shader2D,!0),this._shader2D.shader=ph},pq.setFilters=function(ph){py.save(this,2097152,this._shader2D,!0),this._shader2D.filters=ph,this._curSubmit=pPh.RENDERBASE,this._renderKey=0,this._drawCount++},pq.drawTexture=function(ph,pq,pf,pg,p$,pP,pS){this._drawTextureM(ph,pq,pf,pg,p$,pP,pS,null,1)},pq.addTextureVb=function(ph,pq,pf){var pg=this._curSubmit._vb||this._vb,p$=pg._byteLength>>2;pg.byteLength=p$+16<<2;for(var pP=pg.getFloat32Array(),pS=0;pS<16;pS+=4)pP[p$++]=ph[pS]+pq,pP[p$++]=ph[pS+1]+pf,pP[p$++]=ph[pS+2],pP[p$++]=ph[pS+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),pg._upload=!0},pq.willDrawTexture=function(ph,pq){if(!(ph.loaded&&ph.bitmap&&ph.source))return this.sprite&&pR.timer.callLater(this,this._repaintSprite),0;var pf=ph.bitmap,pg=pf.id+this._shader2D.ALPHA*pq+10016;if(pg==this._renderKey)return pg;var p$=this._shader2D,pP=p$.ALPHA,pS=this._curSubmit.shaderValue;p$.ALPHA*=pq,this._renderKey=pg,this._drawCount++,p$.glTexture=pf;var pB=this._vb,pr=null,pY=pB._byteLength/32*3,pC=pS.textureHost&&pS.textureHost==ph&&pS.textureHost.alphaTexture==ph.alphaTexture;return pr=pch.create(this,this._ib,pB,pY,pXh.create(1,0)),(this._submits[this._submits._length++]=pr).shaderValue.textureHost=ph,pr._renderType=10016,pr._preIsSameTextureShader=10016===this._curSubmit._renderType&&p$.ALPHA===pS.ALPHA&&pC,this._curSubmit=pr,p$.ALPHA=pP,pg},pq.drawTextures=function(ph,pq,pf,pg){if(ph.loaded&&ph.bitmap&&ph.source){var p$=this._clipRect;if(this._clipRect=pk.MAXCLIPRECT,this._drawTextureM(ph,pq[0],pq[1],ph.width,ph.height,pf,pg,null,1)){if(this._clipRect=p$,pb.drawCall++,!(pq.length<4)){for(var pP=this._curSubmit._vb||this._vb,pS=this._curMat.a,pB=this._curMat.d,pr=2,pY=pq.length;pr<pY;pr+=2)plh.copyPreImgVb(pP,(pq[pr]-pq[pr-2])*pS,(pq[pr+1]-pq[pr-1])*pB),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&pR.timer.callLater(this,this._repaintSprite)},pq._drawTextureM=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){if(!ph.loaded||!ph.source)return this.sprite&&pR.timer.callLater(this,this._repaintSprite),!1;var pY=this._curSubmit._vb||this._vb,pC=ph.bitmap;pq+=pP,pf+=pS,this._drawCount++;var pU=pC.id+this._shader2D.ALPHA*pr+10016;if(pU!=this._renderKey){this._renderKey=pU;var pu=this._curSubmit.shaderValue,pv=this._shader2D,pL=pv.ALPHA;pv.ALPHA*=pr,pv.glTexture=pC;var pe=this._vb,pl=null,p_=pe._byteLength/32*3,pN=pu.textureHost&&pu.textureHost==ph&&pu.textureHost.alphaTexture==ph.alphaTexture;pl=pch.create(this,this._ib,pe,p_,pXh.create(1,0)),(this._submits[this._submits._length++]=pl).shaderValue.textureHost=ph,pl._renderType=10016,pl._preIsSameTextureShader=10016===this._curSubmit._renderType&&pv.ALPHA===pu.ALPHA&&pN,this._curSubmit=pl,pY=this._curSubmit._vb||this._vb,pv.ALPHA=pL}return!!plh.fillRectImgVb(pY,this._clipRect,pq,pf,pg||ph.width,p$||ph.height,ph.uv,pB||this._curMat,this._x,this._y,0,0)&&(pH.enabled&&!this._isMain&&this._curSubmit.addTexture(ph,(pY._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},pq._repaintSprite=function(){this.sprite&&this.sprite.repaint()},pq._drawText=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){var pC=ph.bitmap;this._drawCount++;var pU=pC.id+this._shader2D.ALPHA+10016;if(pU!=this._renderKey){this._renderKey=pU;var pu=this._curSubmit.shaderValue,pv=this._shader2D;pv.glTexture=pC;var pL=this._vb,pe=null,pl=pL._byteLength/32*3,p_=pu.textureHost&&pu.textureHost==ph&&pu.textureHost.alphaTexture==ph.alphaTexture;(pe=pH.enabled?pch.create(this,this._ib,pL,pl,pXh.create(1,0)):pch.create(this,this._ib,pL,pl,pOh.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&pv.ALPHA===pu.ALPHA&&p_,(this._submits[this._submits._length++]=pe).shaderValue.textureHost=ph,pe._renderType=10016,this._curSubmit=pe}ph.active();var pN=this._curSubmit._vb||this._vb;plh.fillRectImgVb(pN,this._clipRect,pq+pS,pf+pB,pg||ph.width,p$||ph.height,ph.uv,pP||this._curMat,this._x,this._y,pr,pY,!0)&&(pH.enabled&&!this._isMain&&this._curSubmit.addTexture(ph,(pN._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},pq.drawTextureWithTransform=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){if(pP){var pY=this._curMat,pC=this._x,pU=this._y;(0!==pS||0!==pB)&&(this._x=pS*pY.a+pB*pY.c,this._y=pB*pY.d+pS*pY.b),pP&&pY.bTransform?(pn.mul(pP,pY,pk._tmpMatrix),(pP=pk._tmpMatrix)._checkTransform()):(this._x+=pY.tx,this._y+=pY.ty),this._drawTextureM(ph,pq,pf,pg,p$,0,0,pP,pr),this._x=pC,this._y=pU}else this._drawTextureM(ph,pq,pf,pg,p$,pS,pB,null,pr)},pq.fillQuadrangle=function(ph,pq,pf,pg,p$){var pP=this._curSubmit,pS=this._vb,pB=this._shader2D,pr=pP.shaderValue;if(this._renderKey=0,ph.bitmap){var pY=ph.bitmap;pB.glTexture==pY&&pB.ALPHA===pr.ALPHA||(pB.glTexture=pY,(pP=this._curSubmit=pPh.createSubmit(this,this._ib,pS,pS._byteLength/32*3,pXh.create(1,0))).shaderValue.glTexture=pY,this._submits[this._submits._length++]=pP),plh.fillQuadrangleImgVb(pS,pq,pf,pg,ph.uv,p$||this._curMat,this._x,this._y)}else pP.shaderValue.fillStyle&&pP.shaderValue.fillStyle.equal(ph)&&pB.ALPHA===pr.ALPHA||(pB.glTexture=null,(pP=this._curSubmit=pPh.createSubmit(this,this._ib,pS,pS._byteLength/32*3,pXh.create(2,0))).shaderValue.defines.add(2),pP.shaderValue.fillStyle=pV.create(ph),this._submits[this._submits._length++]=pP),plh.fillQuadrangleImgVb(pS,pq,pf,pg,pM.DEF_UV,p$||this._curMat,this._x,this._y);pP._numEle+=6},pq.drawTexture2=function(ph,pq,pf,pg,p$,pP,pS,pB){if(0!=pP){var pr=this._curMat;if(this._x=ph*pr.a+pq*pr.c,this._y=pq*pr.d+ph*pr.b,p$&&(p$=pr.bTransform||p$.bTransform?(pn.mul(p$,pr,pk._tmpMatrix),pk._tmpMatrix):(this._x+=p$.tx+pr.tx,this._y+=p$.ty+pr.ty,pn.EMPTY)),1!==pP||pS){var pY=this._shader2D.ALPHA,pC=this._nBlendType;this._shader2D.ALPHA=pP,pS&&(this._nBlendType=ps.TOINT(pS)),this._drawTextureM(pB[0],pB[1]-pf,pB[2]-pg,pB[3],pB[4],0,0,p$,1),this._shader2D.ALPHA=pY,this._nBlendType=pC}else this._drawTextureM(pB[0],pB[1]-pf,pB[2]-pg,pB[3],pB[4],0,0,p$,1);this._x=this._y=0}},pq.drawCanvas=function(ph,pq,pf,pg,p$){var pP=ph.context;if(this._renderKey=0,pP._targets)this._submits[this._submits._length++]=pzh.create(pP,0,null),this._curSubmit=pPh.RENDERBASE,pP._targets.drawTo(this,pq,pf,pg,p$);else{var pS=this._submits[this._submits._length++]=pzh.create(pP,this._shader2D.ALPHA,this._shader2D.filters),pB=pg/ph.width,pr=p$/ph.height,pY=pS._matrix;this._curMat.copyTo(pY),1!=pB&&1!=pr&&pY.scale(pB,pr);var pC=pY.tx,pU=pY.ty;pY.tx=pY.ty=0,pY.transformPoint(pJ.TEMP.setTo(pq,pf)),pY.translate(pJ.TEMP.x+pC,pJ.TEMP.y+pU),this._curSubmit=pPh.RENDERBASE}pt.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=pP._targets?"yellow":"green",this.strokeRect(pq-1,pf-1,pg+2,p$+2,1),this.strokeRect(pq,pf,pg,p$,1),this.restore())},pq.drawTarget=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){void 0===pY&&(pY=-1);var pC=this._vb;if(plh.fillRectImgVb(pC,this._clipRect,pq,pf,pg,p$,pr||pM.DEF_UV,pP||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var pU=this._curSubmit=pUh.create(this,this._ib,pC,(pC._byteLength-64)/32*3,pB,pS);pU.blendType=-1==pY?this._nBlendType:pY,pU.scope=ph,this._submits[this._submits._length++]=pU,this._curSubmit._numEle+=6}},pq.mixRGBandAlpha=function(ph){return this._mixRGBandAlpha(ph,this._shader2D.ALPHA)},pq._mixRGBandAlpha=function(ph,pq){var pf=(4278190080&ph)>>>24;return 0!=pf?pf*=pq:pf=255*pq,16777215&ph|pf<<24},pq.drawTriangles=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){if(!ph.loaded||!ph.source)return this.sprite&&pR.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;ph.bitmap;var pC=this._mixRGBandAlpha(4294967295,pB),pU=(pg.length,pP.length);this._renderKey=-1;var pu=this._curSubmit=pch.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,pXh.create(1,0));return pu.shaderValue.textureHost=ph,pu._renderType=10016,this._submits[this._submits._length++]=pu,pS?(pk._tmpMatrix.a=pS.a,pk._tmpMatrix.b=pS.b,pk._tmpMatrix.c=pS.c,pk._tmpMatrix.d=pS.d,pk._tmpMatrix.tx=pS.tx+pq,pk._tmpMatrix.ty=pS.ty+pf,pn.mul(pk._tmpMatrix,this._curMat,pk._tmpMatrix)):(pk._tmpMatrix.a=this._curMat.a,pk._tmpMatrix.b=this._curMat.b,pk._tmpMatrix.c=this._curMat.c,pk._tmpMatrix.d=this._curMat.d,pk._tmpMatrix.tx=this._curMat.tx+pq,pk._tmpMatrix.ty=this._curMat.ty+pf),this._triangleMesh.addData(pg,p$,pP,pk._tmpMatrix,pC,this),this._curSubmit._numEle+=pU,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},pq.transform=function(ph,pq,pf,pg,p$,pP){po.save(this),pn.mul(pn.TEMP.setTo(ph,pq,pf,pg,p$,pP),this._curMat,this._curMat),this._curMat._checkTransform()},pq.setTransformByMatrix=function(ph){ph.copyTo(this._curMat)},pq.transformByMatrix=function(ph){po.save(this),pn.mul(ph,this._curMat,this._curMat),this._curMat._checkTransform()},pq.rotate=function(ph){po.save(this),this._curMat.rotateEx(ph)},pq.scale=function(ph,pq){po.save(this),this._curMat.scaleEx(ph,pq)},pq.clipRect=function(ph,pq,pf,pg){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var p$=pCh.create(4);this.addRenderObject(p$);var pP=this._vb,pS=pP._byteLength>>2;if(plh.fillRectImgVb(pP,null,ph,pq,pf,pg,pM.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var pB=this._curSubmit=pPh.createSubmit(this,this._ib,pP,(pP._byteLength-64)/32*3,pXh.create(2,0));pB.shaderValue.ALPHA=1,this._submits[this._submits._length++]=pB,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var pr=pCh.create(5);this.addRenderObject(pr);var pY=pP.getFloat32Array(),pC=Math.min(Math.min(Math.min(pY[0+pS],pY[4+pS]),pY[8+pS]),pY[12+pS]),pU=Math.max(Math.max(Math.max(pY[0+pS],pY[4+pS]),pY[8+pS]),pY[12+pS]),pu=Math.min(Math.min(Math.min(pY[1+pS],pY[5+pS]),pY[9+pS]),pY[13+pS]),pv=Math.max(Math.max(Math.max(pY[1+pS],pY[5+pS]),pY[9+pS]),pY[13+pS]);pZ.save(this,pr,ph,pq,pf,pg,pC,pu,pU-pC,pv-pu),this._curSubmit=pPh.RENDERBASE}else{pf*=this._curMat.a,pg*=this._curMat.d;var pL=pJ.TEMP;this._curMat.transformPoint(pL.setTo(ph,pq)),pf<0&&(pL.x=pL.x+pf,pf=-pf),pg<0&&(pL.y=pL.y+pg,pg=-pg),this._renderKey=0;var pe=this._curSubmit=pYh.create(this);(this._submits[this._submits._length++]=pe).submitIndex=this._submits._length,pe.submitLength=9999999,pF.save(this,pe);var pl=this._clipRect,p_=pl.x,pN=pl.y,pG=pL.x+pf,pm=pL.y+pg;p_<pL.x&&(pl.x=pL.x),pN<pL.y&&(pl.y=pL.y),pl.width=Math.min(pG,p_+pl.width)-pl.x,pl.height=Math.min(pm,pN+pl.height)-pl.y,this._shader2D.glTexture=null,pe.clipRect.copyFrom(pl),this._curSubmit=pPh.RENDERBASE}},pq.setIBVB=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC){if(void 0===pr&&(pr=0),void 0===pY&&(pY=0),void 0===pC&&(pC=0),null===pf){if(p_.isFlash){var pU=pg;pU._selfIB||(pU._selfIB=pxh.create(35044)),pU._selfIB.clear(),pf=pU._selfIB}else pf=this._ib;plh.expandIBQuadrangle(pf,pg._byteLength/(4*pg.vertexStride*4))}if(!pB||!pS)throw Error("setIBVB must input:shader shaderValues");var pu=prh.create(this,pg,pf,p$,pS,pB,pr,pY,pC);pP||(pP=pn.EMPTY),pP.translate(ph,pq),pn.mul(pP,this._curMat,pu._mat),pP.translate(-ph,-pq),this._submits[this._submits._length++]=pu,this._curSubmit=pPh.RENDERBASE,this._renderKey=0},pq.addRenderObject=function(ph){this._submits[this._submits._length++]=ph},pq.fillTrangles=function(ph,pq,pf,pg,p$){var pP=this._curSubmit,pS=this._vb,pB=this._shader2D,pr=pP.shaderValue,pY=pg.length>>4,pC=ph.bitmap;this._renderKey=0,pB.glTexture==pC&&pB.ALPHA===pr.ALPHA||((pP=this._curSubmit=pPh.createSubmit(this,this._ib,pS,pS._byteLength/32*3,pXh.create(1,0))).shaderValue.textureHost=ph,this._submits[this._submits._length++]=pP),plh.fillTranglesVB(pS,pq,pf,pg,p$||this._curMat,this._x,this._y),pP._numEle+=6*pY},pq.submitElement=function(ph,pq){var pf=this._submits;for(pq<0&&(pq=pf._length);ph<pq;)ph+=pf[ph].renderSubmit()},pq.finish=function(){pmh.mainContext.finish()},pq.flush=function(){var ph=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(ph>this._ib.bufferLength/12&&plh.expandIBQuadrangle(this._ib,ph),!this._isMain&&pH.enabled&&pH._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=pH._atlasRestore;for(var pq=this._submits,pf=0,pg=pq._length;pf<pg;pf++){var p$=pq[pf];10016===p$.getRenderType()&&p$.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),pqh.instance&&pqh.getInstance().reset();var pP;for(pf=0,pP=this.meshlist.length;pf<pP;pf++){var pS=this.meshlist[pf];pS.canReuse?pS.releaseMesh():pS.destroy()}return this.meshlist.length=0,this._curSubmit=pPh.RENDERBASE,this._renderKey=0,this._triangleMesh=pMh.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},pq.setPathId=function(ph){if(this.mId=ph,-1!=this.mId){this.mHaveKey=!1;var pq=pT.getInstance();pq.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,pq.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},pq.movePath=function(ph,pq){var pf=ph,pg=pq;ph=this._curMat.a*pf+this._curMat.c*pg+this._curMat.tx,pq=this._curMat.b*pf+this._curMat.d*pg+this._curMat.ty,this.mX+=ph,this.mY+=pq},pq.beginPath=function(){var ph=this._getPath();ph.tempArray.length=0,ph.closePath=!1,this.mX=0,this.mY=0},pq.closePath=function(){this._path.closePath=!0},pq.fill=function(ph){void 0===ph&&(ph=!1);var pq=this._getPath();this.drawPoly(0,0,pq.tempArray,this.fillStyle._color.numColor,0,0,ph)},pq.stroke=function(){var ph=this._getPath();if(0<this.lineWidth){if(-1==this.mId)ph.drawLine(0,0,ph.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var pq=pT.getInstance().shapeLineDic[this.mId];pq.rebuild(ph.tempArray),ph.setGeomtry(pq)}else pT.getInstance().addLine(this.mId,ph.drawLine(0,0,ph.tempArray,this.lineWidth,this.strokeStyle._color.numColor));ph.update();var pf=[this.mX,this.mY],pg=pPh.createShape(this,ph.ib,ph.vb,ph.count,ph.offset,pXh.create(4,0));pg.shaderValue.ALPHA=this._shader2D.ALPHA,pg.shaderValue.u_pos=pf,pg.shaderValue.u_mmat2=pNh.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=pg,this._renderKey=-1}},pq.line=function(ph,pq,pf,pg,p$,pP){var pS=this._curSubmit,pB=this._vb;if(plh.fillLineVb(pB,this._clipRect,ph,pq,pf,pg,p$,pP)){this._renderKey=0;var pr=this._shader2D,pY=pS.shaderValue;pr.strokeStyle===pY.strokeStyle&&pr.ALPHA===pY.ALPHA||(pr.glTexture=null,(pS=this._curSubmit=pPh.createSubmit(this,this._ib,pB,(pB._byteLength-64)/32*3,pXh.create(2,0))).shaderValue.strokeStyle=pr.strokeStyle,pS.shaderValue.mainID=2,pS.shaderValue.ALPHA=pr.ALPHA,this._submits[this._submits._length++]=pS),pS._numEle+=6}},pq.moveTo=function(ph,pq,pf){void 0===pf&&(pf=!0);var pg=this._getPath();if(pf){var p$=ph,pP=pq;ph=this._curMat.a*p$+this._curMat.c*pP,pq=this._curMat.b*p$+this._curMat.d*pP}pg.addPoint(ph,pq)},pq.lineTo=function(ph,pq,pf){void 0===pf&&(pf=!0);var pg=this._getPath();if(pf){var p$=ph,pP=pq;ph=this._curMat.a*p$+this._curMat.c*pP,pq=this._curMat.b*p$+this._curMat.d*pP}pg.addPoint(ph,pq)},pq.drawCurves=function(ph,pq,pf){this.setPathId(-1),this.beginPath(),this.strokeStyle=pf[3],this.lineWidth=pf[4];var pg=pf[2];ph+=pf[0],pq+=pf[1],this.movePath(ph,pq),this.moveTo(pg[0],pg[1]);for(var p$=2,pP=pg.length;p$<pP;)this.quadraticCurveTo(pg[p$++],pg[p$++],pg[p$++],pg[p$++]);this.stroke()},pq.arcTo=function(ph,pq,pf,pg,p$){if(-1==this.mId||!this.mHaveKey){var pP=0,pS=0,pB=0,pr=this._getPath();this._curMat.copyTo(pk._tmpMatrix),pk._tmpMatrix.tx=pk._tmpMatrix.ty=0,pk._tempPoint.setTo(pr.getEndPointX(),pr.getEndPointY()),pk._tmpMatrix.invertTransformPoint(pk._tempPoint);var pY=pk._tempPoint.x-ph,pC=pk._tempPoint.y-pq,pU=Math.sqrt(pY*pY+pC*pC);if(!(pU<=1e-6)){var pu=pY/pU,pv=pC/pU,pL=pf-ph,pe=pg-pq,pl=pL*pL+pe*pe,p_=Math.sqrt(pl);if(!(p_<=1e-6)){var pN=pL/p_,pG=pe/p_,pm=pu+pN,pE=pv+pG,pR=Math.sqrt(pm*pm+pE*pE);if(!(pR<=1e-6)){var pt=pm/pR,pX=pE/pR,pn=Math.acos(pt*pu+pX*pv),pJ=Math.PI/2-pn,pp=(pU=p$/Math.tan(pJ))*pu+ph,pA=pU*pv+pq,pd=Math.sqrt(pU*pU+p$*p$),pb=ph+pt*pd,pi=pq+pX*pd,pz=0,pc=0;if(0<=pu*pG-pv*pN){var pM=2*pJ/pk.SEGNUM;pz=Math.sin(pM),pc=Math.cos(pM)}else pM=2*-pJ/pk.SEGNUM,pz=Math.sin(pM),pc=Math.cos(pM);pS=this._curMat.a*pp+this._curMat.c*pA,pB=this._curMat.b*pp+this._curMat.d*pA,pS==this._path.getEndPointX()&&pB==this._path.getEndPointY()||pr.addPoint(pS,pB);var pW=pp-pb,pT=pA-pi;for(pP=0;pP<pk.SEGNUM;pP++){var pI=pW*pc+pT*pz,pw=-pW*pz+pT*pc;pS=pI+pb,pB=pw+pi,ph=this._curMat.a*pS+this._curMat.c*pB,pB=pq=this._curMat.b*pS+this._curMat.d*pB,(pS=ph)==this._path.getEndPointX()&&pB==this._path.getEndPointY()||pr.addPoint(pS,pB),pW=pI,pT=pw}}}}}},pq.arc=function(ph,pq,pf,pg,p$,pP,pS){if(void 0===pP&&(pP=!1),void 0===pS&&(pS=!0),-1!=this.mId){var pB=pT.getInstance().shapeDic[this.mId];if(pB&&this.mHaveKey&&!pB.needUpdate(this._curMat))return;pq=ph=0}var pr,pY=0,pC=0,pU=0,pu=0,pv=0,pL=0,pe=0;if(pC=p$-pg,pP)if(Math.abs(pC)>=2*Math.PI)pC=2*-Math.PI;else for(;0<pC;)pC-=2*Math.PI;else if(Math.abs(pC)>=2*Math.PI)pC=2*Math.PI;else for(;pC<0;)pC+=2*Math.PI;pr=pC/(pe=pf<101?Math.max(10,pC*pf/5):pf<201?Math.max(10,pC*pf/20):Math.max(10,pC*pf/40))/2,pU=Math.abs(4/3*(1-Math.cos(pr))/Math.sin(pr)),pP&&(pU=-pU);var pl=this._getPath(),p_=NaN,pN=NaN;for(pL=0;pL<=pe;pL++)pY=pg+pC*(pL/pe),pu=ph+Math.cos(pY)*pf,pv=pq+Math.sin(pY)*pf,pS&&(p_=pu,pN=pv,pu=this._curMat.a*p_+this._curMat.c*pN,pv=this._curMat.b*p_+this._curMat.d*pN),pu==this._path.getEndPointX()&&pv==this._path.getEndPointY()||pl.addPoint(pu,pv);pu=ph+Math.cos(p$)*pf,pv=pq+Math.sin(p$)*pf,pS&&(p_=pu,pN=pv,pu=this._curMat.a*p_+this._curMat.c*pN,pv=this._curMat.b*p_+this._curMat.d*pN),pu==this._path.getEndPointX()&&pv==this._path.getEndPointY()||pl.addPoint(pu,pv)},pq.quadraticCurveTo=function(ph,pq,pf,pg){var p$=pU.I,pP=pf,pS=pg;pf=this._curMat.a*pP+this._curMat.c*pS,pg=this._curMat.b*pP+this._curMat.d*pS,pP=ph,pS=pq,ph=this._curMat.a*pP+this._curMat.c*pS,pq=this._curMat.b*pP+this._curMat.d*pS;for(var pB=p$.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),ph,pq,pf,pg],30,2),pr=0,pY=pB.length/2;pr<pY;pr++)this.lineTo(pB[2*pr],pB[2*pr+1],!1);this.lineTo(pf,pg,!1)},pq.rect=function(ph,pq,pf,pg){this._other=this._other.make(),this._other.path||(this._other.path=new pK),this._other.path.rect(ph,pq,pf,pg)},pq.strokeRect=function(ph,pq,pf,pg,p$){var pP=.5*p$;this.line(ph-pP,pq,ph+pf+pP,pq,p$,this._curMat),this.line(ph+pf,pq,ph+pf,pq+pg,p$,this._curMat),this.line(ph,pq,ph,pq+pg,p$,this._curMat),this.line(ph-pP,pq+pg,ph+pf+pP,pq+pg,p$,this._curMat)},pq.clip=function(){},pq.drawPoly=function(ph,pq,pf,pg,p$,pP,pS){void 0===pS&&(pS=!1),this._renderKey=0,this._shader2D.glTexture=null;var pB=this._getPath();if(-1==this.mId)pB.polygon(ph,pq,pf,pg,p$||1,pP);else if(this.mHaveKey){var pr=pT.getInstance().shapeDic[this.mId];pr.setMatrix(this._curMat),pr.rebuild(pB.tempArray),pB.setGeomtry(pr)}else{var pY=pB.polygon(ph,pq,pf,pg,p$||1,pP);pT.getInstance().addShape(this.mId,pY),pY.setMatrix(this._curMat)}pB.update();var pC,pU=[this.mX,this.mY];if((pC=pPh.createShape(this,pB.ib,pB.vb,pB.count,pB.offset,pXh.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,pC.shaderValue.u_pos=pU,pC.shaderValue.u_mmat2=pNh.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=pC,0<p$){if(this.mHaveLineKey){var pu=pT.getInstance().shapeLineDic[this.mId];pu.rebuild(pB.tempArray),pB.setGeomtry(pu)}else pT.getInstance().addShape(this.mId,pB.drawLine(ph,pq,pf,p$,pP));pB.update(),(pC=pPh.createShape(this,pB.ib,pB.vb,pB.count,pB.offset,pXh.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,pC.shaderValue.u_mmat2=pNh.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=pC}},pq.drawParticle=function(ph,pq,pf){pf.x=ph,pf.y=pq,this._submits[this._submits._length++]=pf},pq._getPath=function(){return this._path||(this._path=new pK)},pg(0,pq,"globalCompositeOperation",function(){return ps.NAMES[this._nBlendType]},function(ph){var pq=ps.TOINT[ph];null==pq||this._nBlendType===pq||(py.save(this,65536,this,!0),this._curSubmit=pPh.RENDERBASE,this._renderKey=0,this._nBlendType=pq)}),pg(0,pq,"strokeStyle",function(){return this._shader2D.strokeStyle},function(ph){this._shader2D.strokeStyle.equal(ph)||(py.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=pV.create(ph))}),pg(0,pq,"globalAlpha",function(){return this._shader2D.ALPHA},function(ph){(ph=Math.floor(1e3*ph)/1e3)!=this._shader2D.ALPHA&&(py.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=ph)}),pg(0,pq,"asBitmap",null,function(ph){if(ph){if(this._targets||(this._targets=new pj),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),pg(0,pq,"fillStyle",function(){return this._shader2D.fillStyle},function(ph){this._shader2D.fillStyle.equal(ph)||(py.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=pV.create(ph))}),pg(0,pq,"textAlign",function(){return this._other.textAlign},function(ph){this._other.textAlign===ph||(this._other=this._other.make(),py.save(this,32768,this._other,!1),this._other.textAlign=ph)}),pg(0,pq,"lineWidth",function(){return this._other.lineWidth},function(ph){this._other.lineWidth===ph||(this._other=this._other.make(),py.save(this,256,this._other,!1),this._other.lineWidth=ph)}),pg(0,pq,"textBaseline",function(){return this._other.textBaseline},function(ph){this._other.textBaseline===ph||(this._other=this._other.make(),py.save(this,16384,this._other,!1),this._other.textBaseline=ph)}),pg(0,pq,"font",null,function(ph){ph!=this._other.font.toString()&&(this._other=this._other.make(),py.save(this,8,this._other,!1),this._other.font===pLh.EMPTY?this._other.font=new pLh(ph):this._other.font.setFont(ph))}),pk.__init__=function(){pf.DEFAULT=new pf},pk._tempPoint=new pJ,pk._SUBMITVBSIZE=32e3,pk._MAXSIZE=99999999,pk._RECTVBSIZE=16,pk.MAXCLIPRECT=new pp(0,0,99999999,99999999),pk._COUNT=0,pk._tmpMatrix=new pn,pk.SEGNUM=32,pk._contextcount=0,pS(pk,["_fontTemp",function(){return this._fontTemp=new pLh},"_drawStyleTemp",function(){return this._drawStyleTemp=new pV(null)}]),pk.__init$=function(){pf=function(){function ph(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=pLh.EMPTY}pu(ph,"");var pq=ph.prototype;return pq.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=pLh.EMPTY},pq.make=function(){return this===ph.DEFAULT?new ph:this},ph.DEFAULT=null,ph}()},pk}(),pXh=function(ph){function pg(ph,pq){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,pg.__super.call(this),this.defines=new pAh,this.position=pg._POSITION,this.mainID=ph,this.subID=pq,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=ph|pq,this._inClassCache=pg._cache[this._cacheID],0<ph&&!this._inClassCache&&(this._inClassCache=pg._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}pu(pg,"laya.webgl.shader.d2.value.Value2D",pw);var pq=pg.prototype;return pq.setValue=function(ph){},pq.refresh=function(){var ph=this.size;return ph[0]=pNh.width,ph[1]=pNh.height,this.alpha=this.ALPHA*pNh.worldAlpha,this.mmat=pNh.worldMatrix4,this},pq._ShaderWithCompile=function(){return pQh.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,pjh.create)},pq._withWorldShaderDefines=function(){var ph=pNh.worldShaderDefines,pq=pQh.sharders[this.mainID|this.defines._value|ph.getValue()];if(!pq){var pf,pg={};for(pf in this.defines.toNameDic())pg[pf]="";for(pf in ph.toNameDic())pg[pf]="";pq=pQh.withCompile2D(0,this.mainID,pg,this.mainID|this.defines._value|ph.getValue(),pjh.create)}var p$=pNh.worldFilters;if(!p$)return pq;for(var pP,pS=p$.length,pB=0;pB<pS;pB++)(pP=p$[pB])&&pP.action.setValue(this);return pq},pq.upload=function(){var ph=pNh;this.alpha=this.ALPHA*ph.worldAlpha,pNh.worldMatrix4!==pNh.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),pmh.shaderHighPrecision&&this.defines.add(1024);var pq,pf=ph.worldShaderDefines?this._withWorldShaderDefines():pQh.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=ph.width,this.size[1]=ph.height,this.mmat=ph.worldMatrix4,pWh.activeShader!==pf?pf._shaderValueWidth!==ph.width||pf._shaderValueHeight!==ph.height?(pf._shaderValueWidth=ph.width,pf._shaderValueHeight=ph.height):pq=pf._params2dQuick2||pf._make2dQuick2():pf._shaderValueWidth!==ph.width||pf._shaderValueHeight!==ph.height?(pf._shaderValueWidth=ph.width,pf._shaderValueHeight=ph.height):pq=pf._params2dQuick1||pf._make2dQuick1(),pf.upload(this,pq)},pq.setFilters=function(ph){if(this.filters=ph)for(var pq,pf=ph.length,pg=0;pg<pf;pg++)(pq=ph[pg])&&(this.defines.add(pq.type),pq.action.setValue(this))},pq.clear=function(){this.defines.setValue(this.subID)},pq.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},pg._initone=function(ph,pq){pg._typeClass[ph]=pq,pg._cache[ph]=[],pg._cache[ph]._length=0},pg.__init__=function(){pg._POSITION=[2,5126,!1,4*peh.BYTES_PE,0],pg._TEXCOORD=[2,5126,!1,4*peh.BYTES_PE,2*peh.BYTES_PE],pg._initone(2,pkh),pg._initone(4,psh),pg._initone(256,pHh),pg._initone(512,pwh),pg._initone(1,pDh),pg._initone(65,pOh),pg._initone(9,pDh)},pg.create=function(ph,pq){var pf=pg._cache[ph|pq];return pf._length?pf[--pf._length]:new pg._typeClass[ph|pq](pq)},pg._POSITION=null,pg._TEXCOORD=null,pg._cache=[],pg._typeClass=[],pg.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],pg}(),pnh=function(ph){function pl(ph,pq){pl.__super.call(this,ph,pq)}pu(pl,"laya.webgl.utils.RenderSprite3D",pN);var pq=pl.prototype;return pq.onCreate=function(ph){switch(ph){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},pq._mask=function(ph,pq,pf,pg){var p$,pP,pS=this._next,pB=ph.mask;if(pB){pq.ctx.save();var pr=pq.ctx.globalCompositeOperation,pY=new pp;if(pY.copyFrom(pB.getBounds()),pY.width=Math.round(pY.width),pY.height=Math.round(pY.height),pY.x=Math.round(pY.x),pY.y=Math.round(pY.y),0<pY.width&&0<pY.height){var pC=ph._style._tf,pU=pBh.create();pU.addValue("bounds",pY),p$=pSh.create([pU,pq],laya.webgl.utils.RenderSprite3D.tmpTarget),pq.addRenderObject(p$),pB.render(pq,-pY.x,-pY.y),p$=pSh.create([pU],laya.webgl.utils.RenderSprite3D.endTmpTarget),pq.addRenderObject(p$),pq.ctx.save(),pq.clipRect(pf-pC.translateX+pY.x,pg-pC.translateY+pY.y,pY.width,pY.height),pS._fun.call(pS,ph,pq,pf,pg),pq.ctx.restore(),pP=pCh.create(6),pr=pq.ctx.globalCompositeOperation,pP.blendMode="mask",pq.addRenderObject(pP),pn.TEMP.identity();var pu=pXh.create(1,0),pv=pM.INV_UV,pL=pY.width,pe=pY.height;(pY.width<32||pY.height<32)&&((pv=pl.tempUV)[0]=0,pv[1]=0,pv[2]=32<=pY.width?1:pY.width/32,pv[3]=0,pv[4]=32<=pY.width?1:pY.width/32,pv[5]=32<=pY.height?1:pY.height/32,pv[6]=0,pv[7]=32<=pY.height?1:pY.height/32,pY.width=32<=pY.width?pY.width:32,pY.height=32<=pY.height?pY.height:32,pv[1]*=-1,pv[3]*=-1,pv[5]*=-1,pv[7]*=-1,pv[1]+=1,pv[3]+=1,pv[5]+=1,pv[7]+=1),pq.ctx.drawTarget(pU,pf+pY.x-pC.translateX,pg+pY.y-pC.translateY,pL,pe,pn.TEMP,"tmpTarget",pu,pv,6),p$=pSh.create([pU],laya.webgl.utils.RenderSprite3D.recycleTarget),pq.addRenderObject(p$),(pP=pCh.create(6)).blendMode=pr,pq.addRenderObject(pP)}pq.ctx.restore()}else pS._fun.call(pS,ph,pq,pf,pg)},pq._blend=function(ph,pq,pf,pg){var p$=ph._style,pP=this._next;p$.blendMode?(pq.ctx.save(),pq.ctx.globalCompositeOperation=p$.blendMode,pP._fun.call(pP,ph,pq,pf,pg),pq.ctx.restore()):pP._fun.call(pP,ph,pq,pf,pg)},pq._transform=function(ph,pq,pf,pg){var p$=ph.transform,pP=this._next;if(p$&&pP!=pN.NORENDER){var pS=pq.ctx;ph._style;p$.tx=pf,p$.ty=pg;var pB=pS._getTransformMatrix(),pr=pB.clone();pn.mul(p$,pB,pB),pB._checkTransform(),p$.tx=p$.ty=0,pP._fun.call(pP,ph,pq,0,0),pr.copyTo(pB),pr.destroy()}else pP._fun.call(pP,ph,pq,pf,pg)},pl.tmpTarget=function(ph,pq){var pf=ph.getValue("bounds"),pg=pTh.create(pf.width,pf.height);pg.start(),pg.clear(0,0,0,0),ph.addValue("tmpTarget",pg)},pl.endTmpTarget=function(ph){ph.getValue("tmpTarget").end()},pl.recycleTarget=function(ph){ph.getValue("tmpTarget").recycle(),ph.recycle()},pS(pl,["tempUV",function(){return this.tempUV=new Array(8)}]),pl}(),pJh=function(ph){function pq(){this.data=null,pq.__super.call(this)}pu(pq,"laya.filters.webgl.ColorFilterActionGL",pI);var pf=pq.prototype;return pR.imps(pf,{"laya.filters.IFilterActionGL":!0}),pf.setValue=function(ph){ph.colorMat=this.data._mat,ph.colorAlpha=this.data._alpha},pf.apply3d=function(ph,pq,pf,pg,p$){var pP=ph.getValue("bounds"),pS=pXh.create(1,0);pS.setFilters([this.data]);var pB=pn.TEMP;pB.identity(),pf.ctx.drawTarget(ph,0,0,pP.width,pP.height,pB,"src",pS)},pq}(),pph=function(ph){function pP(ph,pq,pf,pg,p$){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,pP.__super.call(this,ph,pq,p$),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new pVh,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=pf,this._atlasCanvas.height=pg,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}pu(pP,"laya.webgl.atlas.Atlaser",pk);var pq=pP.prototype;return pq.computeUVinAtlasTexture=function(ph,pq,pf,pg){var p$=pH.atlasTextureWidth,pP=pH.atlasTextureHeight,pS=pf/p$,pB=pg/pP,pr=(pf+ph.bitmap.width)/p$,pY=(pg+ph.bitmap.height)/pP,pC=ph.bitmap.width/p$,pU=ph.bitmap.height/pP;ph.uv=[pS+pq[0]*pC,pB+pq[1]*pU,pr-(1-pq[2])*pC,pB+pq[3]*pU,pr-(1-pq[4])*pC,pY-(1-pq[5])*pU,pS+pq[6]*pC,pY-(1-pq[7])*pU]},pq.findBitmapIsExist=function(ph){if(ph instanceof laya.webgl.resource.WebGLImage){var pq=ph,pf=pq.url,pg=this._InAtlasWebGLImagesKey[pf||pq.id];if(pg)return pg.offsetInfoID}return-1},pq.addToAtlasTexture=function(ph,pq,pf){if(ph instanceof laya.webgl.resource.WebGLImage){var pg=ph,p$=pg.url;this._InAtlasWebGLImagesKey[p$||pg.id]={bitmap:ph,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([pq,pf])}this._atlasCanvas.texSubImage2D(pq,pf,ph.atlasSource),ph.clearAtlasSource()},pq.addToAtlas=function(ph,pq,pf){ph._atlasID=this._inAtlasTextureKey.length;var pg=ph.uv.slice(),p$=ph.bitmap;this._inAtlasTextureKey.push(ph),this._inAtlasTextureOriUVValue.push(pg),this._inAtlasTextureBitmapValue.push(p$),this.computeUVinAtlasTexture(ph,pg,pq,pf),ph.bitmap=this._atlasCanvas},pq.clear=function(){for(var ph=0,pq=this._inAtlasTextureKey.length;ph<pq;ph++)this._inAtlasTextureKey[ph].bitmap=this._inAtlasTextureBitmapValue[ph],this._inAtlasTextureKey[ph].uv=this._inAtlasTextureOriUVValue[ph],this._inAtlasTextureKey[ph]._atlasID=-1,this._inAtlasTextureKey[ph].bitmap.lock=!1,this._inAtlasTextureKey[ph].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},pq.dispose=function(){this.clear(),this._atlasCanvas.destroy()},pg(0,pq,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),pg(0,pq,"texture",function(){return this._atlasCanvas}),pg(0,pq,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),pP}(),pAh=function(ph){function pf(){pf.__super.call(this,pf.__name2int,pf.__int2name,pf.__int2nameMap)}return pu(pf,"laya.webgl.shader.d2.ShaderDefines2D",pa),pf.__init__=function(){pf.reg("TEXTURE2D",1),pf.reg("COLOR2D",2),pf.reg("PRIMITIVE",4),pf.reg("GLOW_FILTER",8),pf.reg("BLUR_FILTER",16),pf.reg("COLOR_FILTER",32),pf.reg("COLOR_ADD",64),pf.reg("WORLDMAT",128),pf.reg("FILLTEXTURE",256),pf.reg("FSHIGHPRECISION",1024),pf.reg("TXTALPHA",2048),pf.reg("TXTCOMPRESS",4096)},pf.reg=function(ph,pq){pa._reg(ph,pq,pf.__name2int,pf.__int2name)},pf.toText=function(ph,pq,pf){return pa._toText(ph,pq,pf)},pf.toInt=function(ph){return pa._toInt(ph,pf.__name2int)},pf.TEXTURE2D=1,pf.COLOR2D=2,pf.PRIMITIVE=4,pf.FILTERGLOW=8,pf.FILTERBLUR=16,pf.FILTERCOLOR=32,pf.COLORADD=64,pf.WORLDMAT=128,pf.FILLTEXTURE=256,pf.SKINMESH=512,pf.SHADERDEFINE_FSHIGHPRECISION=1024,pf.TXTALPHA=2048,pf.TXTCOMPRESS=4096,pf.__name2int={},pf.__int2name=[],pf.__int2nameMap=[],pf}(),pdh=(function(ph){function pB(ph,pq,pf,pg,p$,pP,pS){pB.__super.call(this,ph,pq,pf,pg,40,p$,pP,pS)}pu(pB,"laya.webgl.shapes.Ellipse",pfh)}(),function(ph){function pP(ph,pq,pf,pg,p$){this._points=[],this.rebuild(pf),pP.__super.call(this,ph,pq,0,0,0,p$,pg,p$,0)}pu(pP,"laya.webgl.shapes.Line",pfh);var pq=pP.prototype;return pq.rebuild=function(ph){var pq=ph.length;pq!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(pq/2-1)),this.mFloat32Array=new Float32Array(5*pq)),this._points.length=0;for(var pf=NaN,pg=NaN,p$=-1,pP=-1,pS=ph.length/2,pB=0;pB<pS;pB++)pf=ph[2*pB],pg=ph[2*pB+1],(.01<Math.abs(p$-pf)||.01<Math.abs(pP-pg))&&this._points.push(pf,pg),p$=pf,pP=pg},pq.getData=function(ph,pq,pf){var pg=[],p$=[];0<this.borderWidth&&this.createLine2(this._points,pg,this.borderWidth,pf,p$,this._points.length/2),this.mUint16Array.set(pg,0),this.mFloat32Array.set(p$,0),ph.append(this.mUint16Array),pq.append(this.mFloat32Array)},pP}()),pbh=function(ph){function pU(ph,pq,pf,pg,p$){this._points=[];for(var pP=NaN,pS=NaN,pB=-1,pr=-1,pY=pf.length/2-1,pC=0;pC<pY;pC++)pP=pf[2*pC],pS=pf[2*pC+1],(.01<Math.abs(pB-pP)||.01<Math.abs(pr-pS))&&this._points.push(pP,pS),pB=pP,pr=pS;pP=pf[2*pY],pS=pf[2*pY+1],pB=this._points[0],pr=this._points[1],(.01<Math.abs(pB-pP)||.01<Math.abs(pr-pS))&&this._points.push(pP,pS),pU.__super.call(this,ph,pq,0,0,this._points.length/2,0,pg,p$)}pu(pU,"laya.webgl.shapes.LoopLine",pfh);var pq=pU.prototype;return pq.getData=function(ph,pq,pf){if(0<this.borderWidth){for(var pg=this.color,p$=(pg>>16&255)/255,pP=(pg>>8&255)/255,pS=(255&pg)/255,pB=[],pr=0,pY=0,pC=[],pU=Math.floor(this._points.length/2),pu=0;pu<pU;pu++)pr=this._points[2*pu],pY=this._points[2*pu+1],pB.push(this.x+pr,this.y+pY,p$,pP,pS);this.createLoopLine(pB,pC,this.borderWidth,pf+pB.length/5),ph.append(new Uint16Array(pC)),pq.append(new Float32Array(pB))}},pq.createLoopLine=function(ph,pq,pf,pg,p$,pP){ph.length;var pS=ph.concat(),pB=p$||ph,pr=this.borderColor,pY=(pr>>16&255)/255,pC=(pr>>8&255)/255,pU=(255&pr)/255,pu=[pS[0],pS[1]],pv=[pS[pS.length-5],pS[pS.length-4]],pL=pv[0]+.5*(pu[0]-pv[0]),pe=pv[1]+.5*(pu[1]-pv[1]);pS.unshift(pL,pe,0,0,0),pS.push(pL,pe,0,0,0);var pl,p_,pN,pG,pm,pE,pR,pt,pX,pn,pJ,pp,pA,pd,pb,pi,pz,pc,pM,pW,pT=pS.length/5,pI=pg,pw=pf/2;pN=pS[0],pG=pS[1],pn=pN-(pm=pS[5]),pX=(pX=-(pG-(pE=pS[6])))/(pW=Math.sqrt(pX*pX+pn*pn))*pw,pn=pn/pW*pw,pB.push(pN-pX,pG-pn,pY,pC,pU,pN+pX,pG+pn,pY,pC,pU);for(var pk=1;pk<pT-1;pk++)pN=pS[5*(pk-1)],pG=pS[5*(pk-1)+1],pm=pS[5*pk],pE=pS[5*pk+1],pR=pS[5*(pk+1)],pt=pS[5*(pk+1)+1],pn=pN-pm,pp=pm-pR,pb=(-(pX=(pX=-(pG-pE))/(pW=Math.sqrt(pX*pX+pn*pn))*pw)+pN)*(-(pn=pn/pW*pw)+pE)-(-pX+pm)*(-pn+pG),pc=(-(pJ=(pJ=-(pE-pt))/(pW=Math.sqrt(pJ*pJ+pp*pp))*pw)+pR)*(-(pp=pp/pW*pw)+pE)-(-pJ+pm)*(-pp+pt),pM=(pA=-pn+pG-(-pn+pE))*(pz=-pJ+pm-(-pJ+pR))-(pi=-pp+pt-(-pp+pE))*(pd=-pX+pm-(-pX+pN)),Math.abs(pM)<.1?(pM+=10.1,pB.push(pm-pX,pE-pn,pY,pC,pU,pm+pX,pE+pn,pY,pC,pU)):(((pl=(pd*pc-pz*pb)/pM)-pm)*(pl-pm)+((p_=(pi*pb-pA*pc)/pM)-pE)+(p_-pE),pB.push(pl,p_,pY,pC,pU,pm-(pl-pm),pE-(p_-pE),pY,pC,pU));pP&&(pq=pP);var pH=this.edges+1;for(pk=1;pk<pH;pk++)pq.push(pI+2*(pk-1),pI+2*(pk-1)+1,pI+2*pk+1,pI+2*pk+1,pI+2*pk,pI+2*(pk-1));return pq.push(pI+2*(pk-1),pI+2*(pk-1)+1,pI+1,pI+1,pI,pI+2*(pk-1)),pB},pU}(),pih=function(ph){function pS(ph,pq,pf,pg,p$,pP){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=pn.create(),this._points=pf.slice(0,pf.length),pS.__super.call(this,ph,pq,0,0,this._points.length/2,pg,p$,pP)}pu(pS,"laya.webgl.shapes.Polygon",pfh);var pq=pS.prototype;return pq.rebuild=function(ph){this._repaint||(this._points.length=0,this._points=this._points.concat(ph))},pq.setMatrix=function(ph){ph.copyTo(this._mat)},pq.needUpdate=function(ph){return this._repaint=this._mat.a==ph.a&&this._mat.b==ph.b&&this._mat.c==ph.c&&this._mat.d==ph.d&&this._mat.tx==ph.tx&&this._mat.ty==ph.ty,!this._repaint},pq.getData=function(ph,pq,pf){var pg,p$=0,pP=this._points,pS=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=pf){for(this._start=pf,pg=[],pS=this.earcutTriangles.length,p$=0;p$<pS;p$++)pg.push(this.earcutTriangles[p$]+pf);this.mUint16Array=new Uint16Array(pg)}}else{this._start=pf,pg=[];var pB=[],pr=[],pY=this.color,pC=(pY>>16&255)/255,pU=(pY>>8&255)/255,pu=(255&pY)/255;for(pS=Math.floor(pP.length/2),p$=0;p$<pS;p$++)pB.push(this.x+pP[2*p$],this.y+pP[2*p$+1],pC,pU,pu),pr.push(this.x+pP[2*p$],this.y+pP[2*p$+1]);for(this.earcutTriangles=pgh.earcut(pr,null,2),pS=this.earcutTriangles.length,p$=0;p$<pS;p$++)pg.push(this.earcutTriangles[p$]+pf);this.mUint16Array=new Uint16Array(pg),this.mFloat32Array=new Float32Array(pB)}ph.append(this.mUint16Array),pq.append(this.mFloat32Array)},pS}(),pzh=function(ph){function pP(){this._matrix=new pn,this._matrix4=peh.defaultMatrix4.concat(),pP.__super.call(this,1e4),this.shaderValue=new pXh(0,0)}pu(pP,"laya.webgl.submit.SubmitCanvas",pPh);var pq=pP.prototype;return pq.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var ph=pNh.worldAlpha,pq=pNh.worldMatrix4,pf=pNh.worldMatrix,pg=pNh.worldFilters,p$=pNh.worldShaderDefines,pP=this.shaderValue,pS=this._matrix,pB=this._matrix4,pr=pn.TEMP;return pn.mul(pS,pf,pr),pB[0]=pr.a,pB[1]=pr.b,pB[4]=pr.c,pB[5]=pr.d,pB[12]=pr.tx,pB[13]=pr.ty,pNh.worldMatrix=pr.clone(),pNh.worldMatrix4=pB,pNh.worldAlpha=pNh.worldAlpha*pP.alpha,pP.filters&&pP.filters.length&&(pNh.worldFilters=pP.filters,pNh.worldShaderDefines=pP.defines),this._ctx_src.flush(),pNh.worldAlpha=ph,pNh.worldMatrix4=pq,pNh.worldMatrix.destroy(),pNh.worldMatrix=pf,pNh.worldFilters=pg,pNh.worldShaderDefines=p$,1},pq.releaseRender=function(){var ph=pP._cache;this._ctx_src=null,ph[ph._length++]=this},pq.getRenderType=function(){return 10003},pP.create=function(ph,pq,pf){var pg=pP._cache._length?pP._cache[--pP._cache._length]:new pP;pg._ctx_src=ph;var p$=pg.shaderValue;return p$.alpha=pq,p$.defines.setValue(0),pf&&pf.length&&p$.setFilters(pf),pg},pP._cache=((pP._cache=[])._length=0,pP._cache),pP}(),pch=function(ph){function pY(ph){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===ph&&(ph=1e4),pY.__super.call(this,ph)}pu(pY,"laya.webgl.submit.SubmitTexture",pPh);var pq=pY.prototype;return pq.releaseRender=function(){var ph=pY._cache;(ph[ph._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},pq.addTexture=function(ph,pq){this._texsID[this._texs.length]=ph._uvID,this._texs.push(ph),this._vbPos.push(pq)},pq.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var ph=this.shaderValue.textureHost.bitmap;if(null!==ph)for(var pq=this._vb.getFloat32Array(),pf=0,pg=this._texs.length;pf<pg;pf++){var p$=this._texs[pf];p$.active();var pP=p$.uv;if(this._texsID[pf]!==p$._uvID){this._texsID[pf]=p$._uvID;var pS=this._vbPos[pf];pq[pS+2]=pP[0],pq[pS+3]=pP[1],pq[pS+6]=pP[2],pq[pS+7]=pP[3],pq[pS+10]=pP[4],pq[pS+11]=pP[5],pq[pS+14]=pP[6],pq[pS+15]=pP[7],this._vb.setNeedUpload()}p$.bitmap!==ph&&(this._isSameTexture=!1)}}},pq.renderSubmit=function(){if(0===this._numEle)return pY._shaderSet=!1,1;var ph=this.shaderValue.textureHost;if(ph){var pq=ph.source;if(!ph.bitmap||!pq)return pY._shaderSet=!1,1;this.shaderValue.texture=pq,ph.alphaTexture&&ph.alphaTexture.source&&(this.shaderValue.texture1=ph.alphaTexture.source)}this._vb.bind_upload(this._ib);var pf=pmh.mainContext;if(ps.activeBlendFunction!==this._blendFn&&(pf.enable(3042),this._blendFn(pf),ps.activeBlendFunction=this._blendFn),pb.drawCall++,pb.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&pWh.activeShader&&pY._shaderSet?(pWh.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&pWh.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),pY._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var pg=ph.bitmap,p$=0,pP=pWh.activeShader,pS=0,pB=this._texs.length;pS<pB;pS++){var pr=this._texs[pS];pr.bitmap===pg&&pS+1!==pB||(pP.uploadTexture2D(pr.source),pf.drawElements(4,6*(pS-p$+1),5123,this._startIdx+6*p$*peh.BYTES_PIDX),pg=pr.bitmap,p$=pS)}else pf.drawElements(4,this._numEle,5123,this._startIdx);return 1},pY.create=function(ph,pq,pf,pg,p$){var pP=pY._cache._length?pY._cache[--pY._cache._length]:new pY;null==pf&&((pf=pP._selfVb||(pP._selfVb=pah.create(-1))).clear(),pg=0),pP._ib=pq,pP._vb=pf,pP._startIdx=pg*peh.BYTES_PIDX,pP._numEle=0;var pS=ph._nBlendType;pP._blendFn=ph._targets?ps.targetFns[pS]:ps.fns[pS],pP.shaderValue=p$,pP.shaderValue.setValue(ph._shader2D);var pB=ph._shader2D.filters;return pB&&pP.shaderValue.setFilters(pB),pP},pY._cache=((pY._cache=[])._length=0,pY._cache),pY._shaderSet=!0,pY}(),pMh=function(ph){function p_(){p_.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}pu(p_,"laya.webgl.utils.MeshTexture",p_h);var pq=p_.prototype;return pq.addData=function(ph,pq,pf,pg,p$,pP){for(var pS=ph.length/2,pB=this._vb.needSize(pS*p_.const_stride)>>2,pr=this._vb.getFloat32Array(),pY=0,pC=0;pC<pS;pC++){var pU=ph[pY],pu=ph[pY+1],pv=pU*pg.a+pu*pg.c+pg.tx,pL=pU*pg.b+pu*pg.d+pg.ty;pr[pB++]=pv,pr[pB++]=pL,pr[pB++]=pq[pY],pr[pB++]=pq[pY+1],pY+=2}this._vb.setNeedUpload();var pe=this.vertNum;if(0<pe){(pS=pf.length)>p_.tmpIdx.length&&(p_.tmpIdx=new Uint16Array(pS));for(var pl=0;pl<pS;pl++)p_.tmpIdx[pl]=pf[pl]+pe;this._ib.appendU16Array(p_.tmpIdx,pf.length)}else this._ib.append(pf);this._ib.setNeedUpload(),this.vertNum+=pS,this.indexNum+=pf.length},pq.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},pq.destroy=function(){this._ib.destroy(),this._vb.destroy()},p_.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new p_},p_.const_stride=16,p_._POOL=[],pS(p_,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),p_}(),pWh=function(ph){function pq(){pq.__super.call(this),this.lock=!0}return pu(pq,"laya.webgl.shader.BaseShader",pG),pq.activeShader=null,pq.bindShader=null,pq}(),pTh=function(pq){function pC(ph,pq,pf,pg,p$,pP,pS,pB,pr){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===pf&&(pf=6408),void 0===pg&&(pg=5121),void 0===p$&&(p$=34041),void 0===pP&&(pP=!1),void 0===pS&&(pS=!1),void 0===pB&&(pB=-1),void 0===pr&&(pr=-1),this._type=1,this._w=ph,this._h=pq,this._surfaceFormat=pf,this._surfaceType=pg,this._depthStencilFormat=p$,p_.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=pP,this._repeat=pS,this._minFifter=pB,this._magFifter=pr,this._createWebGLRenderTarget(),this.bitmap.lock=!0,pC.__super.call(this,this.bitmap,pM.INV_UV)}pu(pC,"laya.webgl.resource.RenderTarget2D",pq);var ph=pC.prototype;return pR.imps(ph,{"laya.resource.IDispose":!0}),ph.getType=function(){return this._type},ph.getTexture=function(){return this},ph.size=function(ph,pq){this._w==ph&&this._h==pq||(this._w=ph,this._h=pq,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},ph.release=function(){this.destroy()},ph.recycle=function(){pC.POOL.push(this)},ph.start=function(){var ph=pmh.mainContext;return this._preRenderTarget=pNh.curRenderTarget,pNh.curRenderTarget=this,ph.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(ph.viewport(0,0,this._w,this._h),this._svWidth=pNh.width,this._svHeight=pNh.height,pNh.width=this._w,pNh.height=this._h,pWh.activeShader=null),this},ph.clear=function(ph,pq,pf,pg){void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=1);var p$=pmh.mainContext;p$.clearColor(ph,pq,pf,pg);var pP=16384;switch(this._depthStencilFormat){case 33189:pP|=256;break;case 36168:pP|=1024;break;case 34041:pP|=256,pP|=1024}p$.clear(pP)},ph.end=function(){var ph=pmh.mainContext;ph.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,pNh.curRenderTarget=this._preRenderTarget,1==this._type?(ph.viewport(0,0,this._svWidth,this._svHeight),pNh.width=this._svWidth,pNh.height=this._svHeight,pWh.activeShader=null):ph.viewport(0,0,pR.stage.width,pR.stage.height)},ph.getData=function(ph,pq,pf,pg){var p$=pmh.mainContext;if(p$.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===p$.checkFramebufferStatus(36160)))return p$.bindFramebuffer(36160,null),null;var pP=new Uint8Array(this._w*this._h*4);return p$.readPixels(ph,pq,pf,pg,this._surfaceFormat,this._surfaceType,pP),p$.bindFramebuffer(36160,null),pP},ph.destroy=function(ph){void 0===ph&&(ph=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,pq.prototype.destroy.call(this))},ph.dispose=function(){},ph._createWebGLRenderTarget=function(){this.bitmap=new pFh(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(ph){this.event("recovered")})},pg(0,ph,"surfaceFormat",function(){return this._surfaceFormat}),pg(0,ph,"magFifter",function(){return this._magFifter}),pg(0,ph,"surfaceType",function(){return this._surfaceType}),pg(0,ph,"mipMap",function(){return this._mipMap}),pg(0,ph,"depthStencilFormat",function(){return this._depthStencilFormat}),pg(0,ph,"minFifter",function(){return this._minFifter}),pg(0,ph,"source",function(){return this._alreadyResolved?pR.superGet(pM,this,"source"):null}),pC.create=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){void 0===pf&&(pf=6408),void 0===pg&&(pg=5121),void 0===p$&&(p$=34041),void 0===pP&&(pP=!1),void 0===pS&&(pS=!1),void 0===pB&&(pB=-1),void 0===pr&&(pr=-1);var pY=pC.POOL.pop();return pY||(pY=new pC(ph,pq)),pY.bitmap&&pY._w==ph&&pY._h==pq&&pY._surfaceFormat==pf&&pY._surfaceType==pg&&pY._depthStencilFormat==p$&&pY._mipMap==pP&&pY._repeat==pS&&pY._minFifter==pB&&pY._magFifter==pr||(pY._w=ph,pY._h=pq,pY._surfaceFormat=pf,pY._surfaceType=pg,pY._depthStencilFormat=p$,p_.isConchWebGL&&34041===pY._depthStencilFormat&&(pY._depthStencilFormat=33189),pY._mipMap=pP,pY._repeat=pS,pY._minFifter=pB,pY._magFifter=pr,pY.release(),pY._createWebGLRenderTarget()),pY},pC.TYPE2D=1,pC.TYPE3D=2,pC.POOL=[],pC}(pM),pIh=function(ph){function pq(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,pq.__super.call(this),pq._gl=pmh.mainContext}pu(pq,"laya.webgl.utils.Buffer",pG);var pf=pq.prototype;return pf._bind=function(){this.activeResource(),pq._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(pq._bindVertexBuffer=this._glBuffer),pq._gl.bindBuffer(this._bufferType,pq._bindActive[this._bufferType]=this._glBuffer),pWh.activeShader=null)},pf.recreateResource=function(){this._glBuffer||(this._glBuffer=pq._gl.createBuffer()),this.completeCreate()},pf.disposeResource=function(){this._glBuffer&&(pmh.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},pg(0,pf,"bufferUsage",function(){return this._bufferUsage}),pq._gl=null,pq._bindActive={},pq._bindVertexBuffer=null,pq._enableAtributes=[],pq}(),pwh=function(ph){function pf(ph){this.texcoord=null,this.offsetX=300,this.offsetY=0,pf.__super.call(this,512,0);var pq=8*peh.BYTES_PE;this.position=[2,5126,!1,pq,0],this.texcoord=[2,5126,!1,pq,2*peh.BYTES_PE],this.color=[4,5126,!1,pq,4*peh.BYTES_PE]}return pu(pf,"laya.webgl.shader.d2.skinAnishader.SkinSV",pXh),pf}(),pkh=function(ph){function pq(ph){pq.__super.call(this,2,0),this.color=[]}return pu(pq,"laya.webgl.shader.d2.value.Color2dSV",pXh),pq.prototype.setValue=function(ph){ph.fillStyle&&(this.color=ph.fillStyle._color._color),ph.strokeStyle&&(this.color=ph.strokeStyle._color._color)},pq}(),pHh=function(ph){function pq(ph){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=pXh._TEXCOORD,pq.__super.call(this,256,0)}pu(pq,"laya.webgl.shader.d2.value.FillTextureSV",pXh);var pf=pq.prototype;return pf.setValue=function(ph){this.ALPHA=ph.ALPHA,ph.filters&&this.setFilters(ph.filters)},pf.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},pq}(),pDh=function(ph){function pq(ph){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=pXh._TEXCOORD,void 0===ph&&(ph=0),pq.__super.call(this,1,ph)}pu(pq,"laya.webgl.shader.d2.value.TextureSV",pXh);var pf=pq.prototype;return pf.setValue=function(ph){this.ALPHA=ph.ALPHA,ph.filters&&this.setFilters(ph.filters)},pf.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},pq}(),psh=function(ph){function pq(ph){this.a_color=null,this.u_pos=[0,0],pq.__super.call(this,4,0),this.position=[2,5126,!1,5*peh.BYTES_PE,0],this.a_color=[3,5126,!1,5*peh.BYTES_PE,2*peh.BYTES_PE]}return pu(pq,"laya.webgl.shader.d2.value.PrimitiveSV",pXh),pq}(),pVh=function(ph){function pq(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,pq.__super.call(this)}pu(pq,"laya.webgl.atlas.AtlasWebGLCanvas",ph);var pf=pq.prototype;return pf.recreateResource=function(){var ph=pmh.mainContext,pq=this._source=ph.createTexture(),pf=pEh.curBindTexTarget,pg=pEh.curBindTexValue;pEh.bindTexture(ph,3553,pq),ph.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),ph.texParameteri(3553,10241,9729),ph.texParameteri(3553,10240,9729),ph.texParameteri(3553,10242,33071),ph.texParameteri(3553,10243,33071),pf&&pg&&pEh.bindTexture(ph,pf,pg),this.memorySize=this._w*this._h*4,this.completeCreate()},pf.disposeResource=function(){this._source&&(pmh.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},pf.texSubImage2D=function(ph,pq,pf){if(p_.isFlash){this._flashCacheImage||(this._flashCacheImage=pe.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var pg=pf.bitmapdata;this._flashCacheImage._image.copyPixels(pg,0,0,pg.width,pg.height,ph,pq),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var p$=pmh.mainContext,pP=pEh.curBindTexTarget,pS=pEh.curBindTexValue;pEh.bindTexture(p$,3553,this._source),p$.pixelStorei(37441,!0),0<=ph-1&&p$.texSubImage2D(3553,0,ph-1,pq,6408,5121,pf),ph+1<=this._w&&p$.texSubImage2D(3553,0,ph+1,pq,6408,5121,pf),0<=pq-1&&p$.texSubImage2D(3553,0,ph,pq-1,6408,5121,pf),pq+1<=this._h&&p$.texSubImage2D(3553,0,ph,pq+1,6408,5121,pf),p$.texSubImage2D(3553,0,ph,pq,6408,5121,pf),p$.pixelStorei(37441,!1),pP&&pS&&pEh.bindTexture(p$,pP,pS)}},pf.texSubImage2DPixel=function(ph,pq,pf,pg,p$){var pP=pmh.mainContext,pS=pEh.curBindTexTarget,pB=pEh.curBindTexValue;pEh.bindTexture(pP,3553,this._source);var pr=new Uint8Array(p$.data);pP.pixelStorei(37441,!0),pP.texSubImage2D(3553,0,ph,pq,pf,pg,6408,5121,pr),pP.pixelStorei(37441,!1),pS&&pB&&pEh.bindTexture(pP,pS,pB)},pg(0,pf,"width",ph.prototype._$get_width,function(ph){this._w=ph}),pg(0,pf,"height",ph.prototype._$get_height,function(ph){this._h=ph}),pq}(pf),pKh=function(ph){function p$(){this.flipY=!0,this.alwaysChange=!1,p$.__super.call(this)}pu(p$,"laya.webgl.resource.WebGLCanvas",pf);var pq=p$.prototype;return pq.getCanvas=function(){return this._canvas},pq.clear=function(){this._ctx&&this._ctx.clear()},pq.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},pq._setContext=function(ph){this._ctx=ph},pq.getContext=function(ph,pq){return this._ctx?this._ctx:this._ctx=p$._createContext(this)},pq.size=function(ph,pq){this._w==ph&&this._h==pq||(this._w=ph,this._h=pq,this._ctx&&this._ctx.size(ph,pq),this._canvas&&(this._canvas.height=pq,this._canvas.width=ph))},pq.activeResource=function(ph){void 0===ph&&(ph=!1),this._source||this.recreateResource()},pq.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},pq.disposeResource=function(){this._source&&!this.iscpuSource&&(pmh.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},pq.createWebGlTexture=function(){var ph=pmh.mainContext;this._canvas;var pq=this._source=ph.createTexture();this.iscpuSource=!1;var pf=pEh.curBindTexTarget,pg=pEh.curBindTexValue;pEh.bindTexture(ph,3553,pq),ph.pixelStorei(37440,this.flipY?1:0),p$.premulAlpha&&ph.pixelStorei(37441,!0),ph.texImage2D(3553,0,6408,6408,5121,this._imgData),p$.premulAlpha&&ph.pixelStorei(37441,!1),ph.texParameteri(3553,10240,9729),ph.texParameteri(3553,10241,9729),ph.texParameteri(3553,10242,33071),ph.texParameteri(3553,10243,33071),ph.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,pf&&pg&&pEh.bindTexture(ph,pf,pg)},pq.reloadCanvasData=function(){var ph=pmh.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var pq=pEh.curBindTexTarget,pf=pEh.curBindTexValue;pEh.bindTexture(ph,3553,this._source),p$.premulAlpha&&ph.pixelStorei(37441,!0),ph.texImage2D(3553,0,6408,6408,5121,this._imgData),p$.premulAlpha&&ph.pixelStorei(37441,!1),ph.pixelStorei(37440,0),pq&&pf&&pEh.bindTexture(ph,pq,pf)},pq.texSubImage2D=function(ph,pq,pf){var pg=pmh.mainContext,p$=pEh.curBindTexTarget,pP=pEh.curBindTexValue;pEh.bindTexture(pg,3553,this._source),pg.pixelStorei(37441,!0),pg.texSubImage2D(3553,0,pq,pf,6408,5121,ph._source),pg.pixelStorei(37441,!1),p$&&pP&&pEh.bindTexture(pg,p$,pP)},pq.toBase64=function(ph,pq,pf){var pg=null;this._canvas&&(pg=this._canvas.toDataURL(ph,pq)),pf.call(this,pg)},pg(0,pq,"context",function(){return this._ctx}),pg(0,pq,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),pg(0,pq,"asBitmap",null,function(ph){this._ctx&&(this._ctx.asBitmap=ph)}),p$._createContext=null,p$.premulAlpha=!1,p$}(),pyh=function(ph){function pP(ph,pq){this.CborderSize=12,pP.__super.call(this),this.char=ph,this.isSpace=" "===ph,this.xs=pq.scaleX,this.ys=pq.scaleY,this.font=pq.font.toString(),this.fontSize=pq.font.size,this.fillColor=pq.fillColor,this.borderColor=pq.borderColor,this.lineWidth=pq.lineWidth,this.underLine=pq.underLine;var pf,pg=p_.isConchApp;pg?((pf=ConchTextCanvas)._source=ConchTextCanvas,pf._source.canvas=ConchTextCanvas):pf=pv.canvas.source,this.canvas=pf,this._enableMerageInAtlas=!0,this._ctx=pg?pf:this.canvas.getContext("2d",void 0);var p$=pW.measureText(this.char,this.font);this.cw=p$.width*this.xs,this.ch=(p$.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new pM(this)}pu(pP,"laya.webgl.resource.WebGLCharImage",pf);var pq=pP.prototype;return pR.imps(pq,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),pq.active=function(){this.texture.active()},pq.recreateResource=function(){var ph=p_.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),ph){var pq=this.fontSize;1==this.xs&&1==this.ys||(pq=parseInt(pq*(this.xs>this.ys?this.xs:this.ys)+""));var pf="normal 100 "+this.font;pf=pf.replace(pP._fontSizeReg,pq),this.borderColor&&(pf+=" 1 "+this.borderColor),this._ctx.font=pf,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,pc.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var pg=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(pg,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},pq.onresize=function(ph,pq){this._w=ph,this._h=pq,this._allowMerageInAtlas=!0},pq.clearAtlasSource=function(){},pg(0,pq,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),pg(0,pq,"atlasSource",function(){return this.canvas}),pg(0,pq,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(ph){this._enableMerageInAtlas=ph}),pP.createOneChar=function(ph,pq){return new pP(ph,pq)},pP._fontSizeReg=new RegExp("\\d+(?=px)","g"),pP}(),pFh=function(ph){function pY(ph,pq,pf,pg,p$,pP,pS,pB,pr){void 0===pf&&(pf=6408),void 0===pg&&(pg=5121),void 0===p$&&(p$=34041),void 0===pP&&(pP=!1),void 0===pS&&(pS=!1),void 0===pB&&(pB=-1),void 0===pr&&(pr=1),pY.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=ph,this._h=pq,this._surfaceFormat=pf,this._surfaceType=pg,this._depthStencilFormat=p$,this._mipMap=pP,this._repeat=pS,this._minFifter=pB,this._magFifter=pr}pu(pY,"laya.webgl.resource.WebGLRenderTarget",pf);var pq=pY.prototype;return pq.recreateResource=function(){var ph=pmh.mainContext;this._frameBuffer||(this._frameBuffer=ph.createFramebuffer()),this._source||(this._source=ph.createTexture());var pq=pEh.curBindTexTarget,pf=pEh.curBindTexValue;pEh.bindTexture(ph,3553,this._source),ph.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var pg=this._minFifter,p$=this._magFifter,pP=this._repeat?10497:33071,pS=pC.isPOT(this._w,this._h);if(pS?(this._mipMap?-1!==pg||(pg=9987):-1!==pg||(pg=9729),-1!==p$||(p$=9729),ph.texParameteri(3553,10241,pg),ph.texParameteri(3553,10240,p$),ph.texParameteri(3553,10242,pP),ph.texParameteri(3553,10243,pP),this._mipMap&&ph.generateMipmap(3553)):(-1!==pg||(pg=9729),-1!==p$||(p$=9729),ph.texParameteri(3553,10241,pg),ph.texParameteri(3553,10240,p$),ph.texParameteri(3553,10242,33071),ph.texParameteri(3553,10243,33071)),ph.bindFramebuffer(36160,this._frameBuffer),ph.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=ph.createRenderbuffer()),ph.bindRenderbuffer(36161,this._depthStencilBuffer),ph.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:ph.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:ph.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:ph.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}ph.bindFramebuffer(36160,null),pq&&pf&&pEh.bindTexture(ph,pq,pf),ph.bindRenderbuffer(36161,null),pS&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},pq.disposeResource=function(){this._frameBuffer&&(pmh.mainContext.deleteTexture(this._source),pmh.mainContext.deleteFramebuffer(this._frameBuffer),pmh.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},pg(0,pq,"depthStencilBuffer",function(){return this._depthStencilBuffer}),pg(0,pq,"frameBuffer",function(){return this._frameBuffer}),pY}(),pZh=function(ph){function pB(ph,pq,pf,pg,p$,pP,pS){this.offsetX=0,this.offsetY=0,pB.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=pP,this.canvas=ph,this._ctx=ph.getContext("2d",void 0),this._w=pg,this._h=p$,this.offsetX=pq,this.offsetY=pf,this.src=pS,this._enableMerageInAtlas=!0,pH.enabled&&this._w<pH.atlasLimitWidth&&this._h<pH.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}pu(pB,"laya.webgl.resource.WebGLSubImage",pf);var pq=pB.prototype;return pR.imps(pq,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),pq.size=function(ph,pq){this._w=ph,this._h=pq,this._ctx&&this._ctx.size(ph,pq),this.canvas&&(this.canvas.height=pq,this.canvas.width=ph)},pq.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},pq.createWebGlTexture=function(){var ph=pmh.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var pq=this._source=ph.createTexture(),pf=pEh.curBindTexTarget,pg=pEh.curBindTexValue;pEh.bindTexture(ph,3553,pq),ph.pixelStorei(37441,!0),ph.texImage2D(3553,0,6408,6408,5121,this.canvas),ph.pixelStorei(37441,!1);var p$=this.minFifter,pP=this.magFifter,pS=this.repeat?10497:33071,pB=pC.isPOT(this.width,this.height);pB?(this.mipmap?-1!==p$||(p$=9987):-1!==p$||(p$=9729),-1!==pP||(pP=9729),ph.texParameteri(3553,10240,pP),ph.texParameteri(3553,10241,p$),ph.texParameteri(3553,10242,pS),ph.texParameteri(3553,10243,pS),this.mipmap&&ph.generateMipmap(3553)):(-1!==p$||(p$=9729),-1!==pP||(pP=9729),ph.texParameteri(3553,10241,p$),ph.texParameteri(3553,10240,pP),ph.texParameteri(3553,10242,33071),ph.texParameteri(3553,10243,33071)),pf&&pg&&pEh.bindTexture(ph,pf,pg),this.canvas=null,pB&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},pq.disposeResource=function(){pH.enabled&&this._allowMerageInAtlas||!this._source||(pmh.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},pq.clearAtlasSource=function(){},pg(0,pq,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),pg(0,pq,"atlasSource",function(){return this.canvas}),pg(0,pq,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(ph){this._allowMerageInAtlas=ph}),pB}(),pQh=function(ph){function pY(ph,pq,pf,pg){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,pY.__super.call(this),!ph||!pq)throw"Shader Error";this._id=++pY._count,this._vs=ph,this._ps=pq,this._nameMap=pg||{},null!=pf&&(pY.sharders[pf]=this)}pu(pY,"laya.webgl.shader.Shader",pWh);var pq=pY.prototype;return pq.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},pq.disposeResource=function(){pmh.mainContext.deleteShader(this._vshader),pmh.mainContext.deleteShader(this._pshader),pmh.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},pq._compile=function(){if(!pmh.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var ph=[this._vs,this._ps],pq=pmh.mainContext;if(this._program=pq.createProgram(),this._vshader=pY._createShader(pq,ph[0],35633),this._pshader=pY._createShader(pq,ph[1],35632),pq.attachShader(this._program,this._vshader),pq.attachShader(this._program,this._pshader),pq.linkProgram(this._program),!p_.isConchApp&&!pq.getProgramParameter(this._program,35714))throw pq.getProgramInfoLog(this._program);var pf,pg,p$=0,pP=0;for(pP=p_.isConchApp?pq.getProgramParameterEx(this._vs,this._ps,"",35721):pq.getProgramParameter(this._program,35721),p$=0;p$<pP;p$++){var pS=null;pf={vartype:"attribute",glfun:null,ivartype:0,attrib:pS=p_.isConchApp?pq.getActiveAttribEx(this._vs,this._ps,"",p$):pq.getActiveAttrib(this._program,p$),location:pq.getAttribLocation(this._program,pS.name),name:pS.name,type:pS.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(pf)}var pB=0;for(pB=p_.isConchApp?pq.getProgramParameterEx(this._vs,this._ps,"",35718):pq.getProgramParameter(this._program,35718),p$=0;p$<pB;p$++){var pr=null;pr=p_.isConchApp?pq.getActiveUniformEx(this._vs,this._ps,"",p$):pq.getActiveUniform(this._program,p$),0<(pf={vartype:"uniform",glfun:null,ivartype:1,attrib:pS,location:pq.getUniformLocation(this._program,pr.name),name:pr.name,type:pr.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(pf.name=pf.name.substr(0,pf.name.length-3),pf.isArray=!0,pf.location=pq.getUniformLocation(this._program,pf.name)),this._params.push(pf)}for(p$=0,pg=this._params.length;p$<pg;p$++)if((pf=this._params[p$]).indexOfParams=p$,pf.index=1,pf.value=[pf.location,null],pf.codename=pf.name,pf.name=this._nameMap[pf.codename]?this._nameMap[pf.codename]:pf.codename,(this._paramsMap[pf.name]=pf)._this=this,pf.uploadedValue=[],"attribute"!==pf.vartype)switch(pf.type){case 5124:pf.fun=pf.isArray?this._uniform1iv:this._uniform1i;break;case 5126:pf.fun=pf.isArray?this._uniform1fv:this._uniform1f;break;case 35664:pf.fun=pf.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:pf.fun=pf.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:pf.fun=pf.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:pf.fun=this._uniform_sampler2D;break;case 35680:pf.fun=this._uniform_samplerCube;break;case 35676:pf.glfun=pq.uniformMatrix4fv,pf.fun=this._uniformMatrix4fv;break;case 35670:pf.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else pf.fun=this._attribute}},pq.getUniform=function(ph){return this._paramsMap[ph]},pq._attribute=function(ph,pq){var pf=pmh.mainContext,pg=pIh._enableAtributes,p$=ph.location;return pg[p$]||pf.enableVertexAttribArray(p$),pf.vertexAttribPointer(p$,pq[0],pq[1],pq[2],pq[3],pq[4]+this._offset),pg[p$]=pIh._bindVertexBuffer,1},pq._uniform1f=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq?(pmh.mainContext.uniform1f(ph.location,pf[0]=pq),1):0},pq._uniform1fv=function(ph,pq){if(pq.length<4){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pmh.mainContext.uniform1fv(ph.location,pq),pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3],1):0}return pmh.mainContext.uniform1fv(ph.location,pq),1},pq._uniform_vec2=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]?(pmh.mainContext.uniform2f(ph.location,pf[0]=pq[0],pf[1]=pq[1]),1):0},pq._uniform_vec2v=function(ph,pq){if(pq.length<2){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pmh.mainContext.uniform2fv(ph.location,pq),pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3],1):0}return pmh.mainContext.uniform2fv(ph.location,pq),1},pq._uniform_vec3=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]?(pmh.mainContext.uniform3f(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2]),1):0},pq._uniform_vec3v=function(ph,pq){return pmh.mainContext.uniform3fv(ph.location,pq),1},pq._uniform_vec4=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pmh.mainContext.uniform4f(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3]),1):0},pq._uniform_vec4v=function(ph,pq){return pmh.mainContext.uniform4fv(ph.location,pq),1},pq._uniformMatrix2fv=function(ph,pq){return pmh.mainContext.uniformMatrix2fv(ph.location,!1,pq),1},pq._uniformMatrix3fv=function(ph,pq){return pmh.mainContext.uniformMatrix3fv(ph.location,!1,pq),1},pq._uniformMatrix4fv=function(ph,pq){return pmh.mainContext.uniformMatrix4fv(ph.location,!1,pq),1},pq._uniform1i=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq?(pmh.mainContext.uniform1i(ph.location,pf[0]=pq),1):0},pq._uniform1iv=function(ph,pq){return pmh.mainContext.uniform1iv(ph.location,pq),1},pq._uniform_ivec2=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]?(pmh.mainContext.uniform2i(ph.location,pf[0]=pq[0],pf[1]=pq[1]),1):0},pq._uniform_ivec2v=function(ph,pq){return pmh.mainContext.uniform2iv(ph.location,pq),1},pq._uniform_vec3i=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]?(pmh.mainContext.uniform3i(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2]),1):0},pq._uniform_vec3vi=function(ph,pq){return pmh.mainContext.uniform3iv(ph.location,pq),1},pq._uniform_vec4i=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pmh.mainContext.uniform4i(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3]),1):0},pq._uniform_vec4vi=function(ph,pq){return pmh.mainContext.uniform4iv(ph.location,pq),1},pq._uniform_sampler2D=function(ph,pq){var pf=pmh.mainContext,pg=ph.uploadedValue;return null==pg[0]?(pg[0]=this._curActTexIndex,pf.uniform1i(ph.location,this._curActTexIndex),pf.activeTexture(pY._TEXTURES[this._curActTexIndex]),pEh.bindTexture(pf,3553,pq),this._curActTexIndex++,1):(pf.activeTexture(pY._TEXTURES[pg[0]]),pEh.bindTexture(pf,3553,pq),0)},pq._uniform_samplerCube=function(ph,pq){var pf=pmh.mainContext,pg=ph.uploadedValue;return null==pg[0]?(pg[0]=this._curActTexIndex,pf.uniform1i(ph.location,this._curActTexIndex),pf.activeTexture(pY._TEXTURES[this._curActTexIndex]),pEh.bindTexture(pf,34067,pq),this._curActTexIndex++,1):(pf.activeTexture(pY._TEXTURES[pg[0]]),pEh.bindTexture(pf,34067,pq),0)},pq._noSetValue=function(ph){console.log("no....:"+ph.name)},pq.uploadOne=function(ph,pq){this.activeResource(),pEh.UseProgram(this._program);var pf=this._paramsMap[ph];pf.fun.call(this,pf,pq)},pq.uploadTexture2D=function(ph){pb.shaderCall++;var pq=pmh.mainContext;pq.activeTexture(33984),pEh.bindTexture(pq,3553,ph)},pq.uploadTexture2D1=function(ph){pb.shaderCall++;var pq=pmh.mainContext;pq.activeTexture(33985),pEh.bindTexture(pq,3553,ph)},pq.upload=function(ph,pq){pWh.activeShader=pWh.bindShader=this,this._lastUseFrameCount===pb.loopCount||this.activeResource(),pEh.UseProgram(this._program),this._reCompile?(pq=this._params,this._reCompile=!1):pq=pq||this._params;pmh.mainContext;for(var pf,pg,p$=pq.length,pP=0,pS=0;pS<p$;pS++)null!==(pg=ph[(pf=pq[pS]).name])&&(pP+=pf.fun.call(this,pf,pg));pb.shaderCall+=pP},pq.uploadArray=function(ph,pq,pf){pWh.activeShader=this,(pWh.bindShader=this).activeResource(),pEh.UseProgram(this._program);this._params;for(var pg,p$,pP=0,pS=pq-2;0<=pS;pS-=2)(p$=this._paramsMap[ph[pS]])&&null!=(pg=ph[pS+1])&&(pf&&pf[p$.name]&&pf[p$.name].bind(),pP+=p$.fun.call(this,p$,pg));pb.shaderCall+=pP},pq.getParams=function(){return this._params},pY.getShader=function(ph){return pY.sharders[ph]},pY.create=function(ph,pq,pf,pg){return new pY(ph,pq,pf,pg)},pY.withCompile=function(ph,pq,pf,pg){if(pf&&pY.sharders[pf])return pY.sharders[pf];var p$=pY._preCompileShader[2e-4*ph];if(!p$)throw new Error("withCompile shader err!"+ph);return p$.createShader(pq,pf,pg)},pY.withCompile2D=function(ph,pq,pf,pg,p$){if(pg&&pY.sharders[pg])return pY.sharders[pg];var pP=pY._preCompileShader[2e-4*ph+pq];if(!pP)throw new Error("withCompile shader err!"+ph+" "+pq);return pP.createShader(pf,pg,p$)},pY.addInclude=function(ph,pq){pGh.addInclude(ph,pq)},pY.preCompile=function(ph,pq,pf,pg){var p$=2e-4*ph;pY._preCompileShader[p$]=new pGh(p$,pq,pf,pg)},pY.preCompile2D=function(ph,pq,pf,pg,p$){var pP=2e-4*ph+pq;pY._preCompileShader[pP]=new pGh(pP,pf,pg,p$)},pY._createShader=function(ph,pq,pf){var pg=ph.createShader(pf);return ph.shaderSource(pg,pq),ph.compileShader(pg),pg},pY._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],pY._count=0,pY._preCompileShader={},pY.SHADERNAME2ID=2e-4,pY.sharders=((pY.sharders=[]).length=32,pY.sharders),pS(pY,["nameKey",function(){return this.nameKey=new pi}]),pY}(),poh=function(ph){function pq(){this._maxsize=0,this._upload=!0,this._uploadSize=0,pq.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}pu(pq,"laya.webgl.utils.Buffer2D",ph);var pf=pq.prototype;return pf.needSize=function(ph){var pq=this._byteLength;if(ph){var pf=this._byteLength+ph;pf<=this._buffer.byteLength||this._resizeBuffer(pf<<1,!0),this._byteLength=pf}return pq},pf._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),pb.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,pIh._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),pIh._gl.bufferSubData(this._bufferType,0,this._buffer)},pf._bufferSubData=function(ph,pq,pf){if(void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),this._maxsize=Math.max(this._maxsize,this._byteLength),pb.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,pIh._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),pq||pf){var pg=this._buffer.slice(pq,pf);pIh._gl.bufferSubData(this._bufferType,ph,pg)}else pIh._gl.bufferSubData(this._bufferType,ph,this._buffer)},pf._checkArrayUse=function(){},pf._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},pf._bind_subUpload=function(ph,pq,pf){return void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(ph,pq,pf),!0)},pf._resizeBuffer=function(ph,pq){if(ph<this._buffer.byteLength)return this;if(this.memorySize=ph,pq&&this._buffer&&0<this._buffer.byteLength){var pf=new ArrayBuffer(ph);new Uint8Array(pf).set(new Uint8Array(this._buffer),0),this._buffer=pf}else this._buffer=new ArrayBuffer(ph);return this._checkArrayUse(),this._upload=!0,this},pf.append=function(ph){this._upload=!0;var pq,pf;pq=ph.byteLength,ph instanceof Uint8Array?(this._resizeBuffer(this._byteLength+pq,!0),pf=new Uint8Array(this._buffer,this._byteLength)):ph instanceof Uint16Array?(this._resizeBuffer(this._byteLength+pq,!0),pf=new Uint16Array(this._buffer,this._byteLength)):ph instanceof Float32Array&&(this._resizeBuffer(this._byteLength+pq,!0),pf=new Float32Array(this._buffer,this._byteLength)),pf.set(ph,0),this._byteLength+=pq,this._checkArrayUse()},pf.appendU16Array=function(ph,pq){this._resizeBuffer(this._byteLength+2*pq,!0);for(var pf=new Uint16Array(this._buffer,this._byteLength,pq),pg=0;pg<pq;pg++)pf[pg]=ph[pg];this._byteLength+=2*pq,this._checkArrayUse()},pf.appendEx=function(ph,pq){this._upload=!0;var pf;pf=ph.byteLength,this._resizeBuffer(this._byteLength+pf,!0),new pq(this._buffer,this._byteLength).set(ph,0),this._byteLength+=pf,this._checkArrayUse()},pf.appendEx2=function(ph,pq,pf,pg){void 0===pg&&(pg=1),this._upload=!0;var p$,pP;p$=pf*pg,this._resizeBuffer(this._byteLength+p$,!0),pP=new pq(this._buffer,this._byteLength);var pS=0;for(pS=0;pS<pf;pS++)pP[pS]=ph[pS];this._byteLength+=p$,this._checkArrayUse()},pf.getBuffer=function(){return this._buffer},pf.setNeedUpload=function(){this._upload=!0},pf.getNeedUpload=function(){return this._upload},pf.upload=function(){var ph=this._bind_upload();return pIh._gl.bindBuffer(this._bufferType,null),pIh._bindActive[this._bufferType]=null,pWh.activeShader=null,ph},pf.subUpload=function(ph,pq,pf){void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0);var pg=this._bind_subUpload();return pIh._gl.bindBuffer(this._bufferType,null),pIh._bindActive[this._bufferType]=null,pWh.activeShader=null,pg},pf.disposeResource=function(){ph.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},pf.clear=function(){this._byteLength=0,this._upload=!0},pg(0,pf,"bufferLength",function(){return this._buffer.byteLength}),pg(0,pf,"byteLength",null,function(ph){this._byteLength!==ph&&(ph<=this._buffer.byteLength||this._resizeBuffer(2*ph+256,!0),this._byteLength=ph)}),pq.__int__=function(ph){pxh.QuadrangleIB=pxh.create(35044),plh.fillIBQuadrangle(pxh.QuadrangleIB,16)},pq.FLOAT32=4,pq.SHORT=2,pq}(pIh),pOh=(function(pq){function pf(ph){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,pf.__super.call(this,9)}pu(pf,"laya.webgl.shader.d2.value.GlowSV",pq);var ph=pf.prototype;ph.setValue=function(ph){pq.prototype.setValue.call(this,ph)},ph.clear=function(){pq.prototype.clear.call(this)}}(pDh),function(ph){function pq(ph){pq.__super.call(this,64),this.defines.add(64)}pu(pq,"laya.webgl.shader.d2.value.TextSV",ph);var pf=pq.prototype;return pf.release=function(){(pq.pool[pq._length++]=this).clear()},pf.clear=function(){ph.prototype.clear.call(this)},pq.create=function(){return pq._length?pq.pool[--pq._length]:new pq(null)},pq.pool=[],pq._length=0,pq}(pDh)),pjh=function(ph){function p$(ph,pq,pf,pg){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,p$.__super.call(this,ph,pq,pf,pg)}pu(p$,"laya.webgl.shader.d2.Shader2X",ph);var pq=p$.prototype;return pq.upload2dQuick1=function(ph){this.upload(ph,this._params2dQuick1||this._make2dQuick1())},pq._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var ph,pq=this._params,pf=0,pg=pq.length;pf<pg;pf++)ph=pq[pf],(p_.isFlash||"size"!==ph.name&&"position"!==ph.name&&"texcoord"!==ph.name)&&this._params2dQuick1.push(ph)}return this._params2dQuick1},pq.disposeResource=function(){ph.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},pq.upload2dQuick2=function(ph){this.upload(ph,this._params2dQuick2||this._make2dQuick2())},pq._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var ph,pq=this._params,pf=0,pg=pq.length;pf<pg;pf++)ph=pq[pf],(p_.isFlash||"size"!==ph.name)&&this._params2dQuick2.push(ph)}return this._params2dQuick2},p$.create=function(ph,pq,pf,pg){return new p$(ph,pq,pf,pg)},p$}(pQh),pxh=function(ph){function pq(ph){this._uint8Array=null,this._uint16Array=null,void 0===ph&&(ph=35044),pq.__super.call(this),this._bufferUsage=ph,this._bufferType=34963,p_.isFlash||(this._buffer=new ArrayBuffer(8))}pu(pq,"laya.webgl.utils.IndexBuffer2D",poh);var pf=pq.prototype;return pf._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},pf.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},pf.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},pf.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},pq.QuadrangleIB=null,pq.create=function(ph){return void 0===ph&&(ph=35044),new pq(ph)},pq}(),pah=function(ph){function pf(ph,pq){this._floatArray32=null,this._vertexStride=0,pf.__super.call(this),this._vertexStride=ph,this._bufferUsage=pq,this._bufferType=34962,p_.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}pu(pf,"laya.webgl.utils.VertexBuffer2D",ph);var pq=pf.prototype;return pq.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},pq.bind=function(ph){ph&&ph._bind(),this._bind()},pq.insertData=function(ph,pq){this.getFloat32Array().set(ph,pq),this._upload=!0},pq.bind_upload=function(ph){ph._bind_upload()||ph._bind(),this._bind_upload()||this._bind()},pq._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},pq.disposeResource=function(){ph.prototype.disposeResource.call(this)},pq.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},pg(0,pq,"vertexStride",function(){return this._vertexStride}),pf.create=function(ph,pq){return void 0===pq&&(pq=35048),new pf(ph,pq)},pf}(poh),phq=function(ph){function pB(ph,pq,pf,pg,p$,pP){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===pf&&(pf=6408),void 0===pg&&(pg=!0),pB.__super.call(this,ph,pq),ph){if(this._format=pf,this._mipmap=pg,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof ph)this._url=ph,this._src=ph,this._image=new pv.window.Image,pq&&(pq.onload&&(this.onload=pq.onload),pq.onerror&&(this.onerror=pq.onerror),pq.onCreate&&pq.onCreate(this)),this._image.crossOrigin=ph&&0==ph.indexOf("data:")?null:"",ph&&(this._image.src=ph);else if(ph instanceof ArrayBuffer){this._src=pq,this._url=this._src;var pS=new pr(ph);pS.readUTFBytes(4),pS.readUTFBytes(2),pS.getInt16();pS.endian="bigEndian",this._w=pS.getInt16(),this._h=pS.getInt16();pS.getInt16(),pS.getInt16();this._image=new Uint8Array(ph,pS.pos),this._format=pmh.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,pH.enabled&&this._w<pH.atlasLimitWidth&&this._h<pH.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(ph instanceof Uint8Array))return this._src=pq,this._url=this._src,this._image=ph.source||ph,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=pq,this._url=this._src,this._w=p$,this._h=pP,this._image=ph,this._format=0===pf?ph.byteLength/(p$*pP)==4?6408:6407:pf}this._$5__enableMerageInAtlas=!0}}pu(pB,"laya.webgl.resource.WebGLImage",pe);var pq=pB.prototype;return pR.imps(pq,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),pq._init_=function(ph,pq){},pq._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var ph=pmh.mainContext,pq=this._source=ph.createTexture(),pf=pEh.curBindTexTarget,pg=pEh.curBindTexValue;pEh.bindTexture(ph,3553,pq);var p$=this.minFifter,pP=this.magFifter,pS=this.repeat?10497:33071,pB=pC.isPOT(this._w,this._h),pr=!1;switch(pB?(this.mipmap?-1!==p$||(p$=9987):-1!==p$||(p$=9729),-1!==pP||(pP=9729),ph.texParameteri(3553,10241,p$),ph.texParameteri(3553,10240,pP),ph.texParameteri(3553,10242,pS),ph.texParameteri(3553,10243,pS),this.mipmap&&ph.generateMipmap(3553)):(-1!==p$||(p$=9729),-1!==pP||(pP=9729),ph.texParameteri(3553,10241,p$),ph.texParameteri(3553,10240,pP),ph.texParameteri(3553,10242,33071),ph.texParameteri(3553,10243,33071)),ph.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&ph.pixelStorei(ph.UNPACK_ALIGNMENT,1),ph.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&ph.pixelStorei(ph.UNPACK_ALIGNMENT,1),ph.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:pr=!0,ph.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case pmh.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:pr=!0,ph.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}ph.pixelStorei(37441,!1),pf&&pg&&pEh.bindTexture(ph,pf,pg),this.uri||(this.uri=this._url),pr?this.memorySize=this._image.length:pB&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},pq.recreateResource=function(){var ph=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var pq=this;this._image=new pv.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(pq._needReleaseAgain)return pq._needReleaseAgain=!1,pq._image.onload=null,void(pq._image=null);pq._allowMerageInAtlas&&pq._enableMerageInAtlas?(ph.memorySize=0,ph._recreateLock=!1):pq._createWebGlTexture(),pq.completeCreate()},this._image.src=this._src}},pq.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&pmh.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},pq.onresize=function(){this._w=this._image.width,this._h=this._image.height,pH.enabled&&this._w<pH.atlasLimitWidth&&this._h<pH.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},pq.clearAtlasSource=function(){this._image=null},pg(0,pq,"format",function(){return this._format}),pg(0,pq,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(ph){this._$5__enableMerageInAtlas=ph}),pg(0,pq,"mipmap",function(){return this._mipmap}),pg(0,pq,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),pg(0,pq,"atlasSource",function(){return this._image}),pg(0,pq,"onload",null,function(ph){var pq=this;this._onload=ph,this._image&&(this._image.onload=null!=this._onload?function(){pq.onresize(),pq._onload()}:null)}),pg(0,pq,"onerror",null,function(ph){var pq=this;this._onerror=ph,this._image&&(this._image.onerror=null!=this._onerror?function(){pq._onerror()}:null)}),pB}();pR.__init([pvh,pk,pth,pGh])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ph,pq){"use strict";for(var pf in Object.defineProperty(pq,"__esModule",{value:!0}),Laya){var pg=Laya[pf];pg&&pg.__isclass&&(pq[pf]=pg)}}),function(pP,ph,pg){pg.un,pg.uns;var p$=pg.static,pS=pg.class,pB=pg.getset,pr=(pg.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),pL=laya.utils.ClassUtils,pU=(laya.events.Event,laya.utils.HTMLChar),pY=laya.net.Loader,pC=(laya.display.Node,laya.maths.Rectangle),pu=laya.renders.Render,pv=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),pe=laya.utils.Stat,pW=laya.display.Text,pl=laya.resource.Texture,p_=laya.net.URL,pN=laya.utils.Utils,pG=function(){function pv(){}return pS(pv,"laya.html.utils.HTMLParse"),pv.parse=function(ph,pq,pf){pq=(pq="<root>"+(pq=pq.replace(/<br>/g,"<br/>"))+"</root>").replace(pv.spacePattern,pv.char255);var pg=pN.parseXMLFromString(pq);pv._parseXML(ph,pg.childNodes[0].childNodes,pf)},pv._parseXML=function(ph,pq,pf,pg){var p$=0,pP=0;if(pq.join||pq.item)for(p$=0,pP=pq.length;p$<pP;++p$)pv._parseXML(ph,pq[p$],pf,pg);else{var pS,pB,pr;if(3==pq.nodeType)return void(ph instanceof laya.html.dom.HTMLDivElement?(null==pq.nodeName&&(pq.nodeName="#text"),pB=pq.nodeName.toLowerCase(),0<(pr=pq.textContent.replace(/^\s+|\s+$/g,"")).length&&(pS=pL.getInstance(pB))&&(ph.addChild(pS),pS.innerTEXT=pr.replace(pv.char255AndOneSpacePattern," "))):0<(pr=pq.textContent.replace(/^\s+|\s+$/g,"")).length&&(ph.innerTEXT=pr.replace(pv.char255AndOneSpacePattern," ")));if("#comment"==(pB=pq.nodeName.toLowerCase()))return;if(pS=pL.getInstance(pB)){(pS=ph.addChild(pS)).URI=pf,pS.href=pg;var pY=pq.attributes;if(pY&&0<pY.length)for(p$=0,pP=pY.length;p$<pP;++p$){var pC=pY[p$],pU=pC.nodeName,pu=pC.value;pS._setAttributes(pU,pu)}pv._parseXML(pS,pq.childNodes,pf,pS.href)}else pv._parseXML(ph,pq.childNodes,pf,pg)}},pv.char255=String.fromCharCode(255),pv.spacePattern=/&nbsp;|&#160;/g,pv.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),pv}(),pm=function(){function pM(){}return pS(pM,"laya.html.utils.Layout"),pM.later=function(ph){null==pM._will&&(pM._will=[],pg.stage.frameLoop(1,null,function(){if(!(pM._will.length<1)){for(var ph=0;ph<pM._will.length;ph++)laya.html.utils.Layout.layout(pM._will[ph]);pM._will.length=0}})),pM._will.push(ph)},pM.layout=function(ph){if(!ph||!ph._style)return null;if(0==(512&ph._style._type))return null;ph.getStyle()._type&=-513;var pq=pM._multiLineLayout(ph);return pu.isConchApp&&ph.layaoutCallNative&&ph.layaoutCallNative(),pq},pM._multiLineLayout=function(ph){if(pW.RightToLeft)return pM._multiLineLayout2(ph);var pq=new Array;ph._addChildsToLayout(pq);var pf,pg,p$,pP,pS,pB=0,pr=pq.length,pY=ph._getCSSStyle(),pC=pY.letterSpacing,pU=pY.leading,pu=pY.lineHeight,pv=pY._widthAuto()||!pY.wordWrap,pL=pv?999999:ph.width,pe=(ph.height,0),pl=pY.italic?pY.fontSize/3:0,p_=pY._getAlign(),pN=pY._getValign(),pG=0!==pN||0!==p_||0!=pu,pm=0,pE=0,pR=0,pt=0,pX=new Array,pn=pX[0]=new pT,pJ=!1,pp=!1;pn.h=0,pY.italic&&(pL-=pY.fontSize/3);var pA=0,pd=!0;function pb(){pn.y=pE,pE+=pn.h+pU,0==pn.h&&(pE+=pu),pn.mWidth=pA,pA=0,pn=new pT,pX.push(pn),pn.h=0,pJ=!(pd=!(pm=0))}for(pB=0;pB<pr;pB++)if(null!=(pf=pq[pB]))if(pd=!1,pf instanceof laya.html.dom.HTMLBrElement)pb(),pn.y=pE;else{if(pf._isChar()){if((pP=pf).isWord)pJ=pp||"\n"===pP.char,pn.wordStartIndex=pn.elements.length;else{if(pR=pP.width+pP.style.letterSpacin,0<pX.length&&pL<pm+pR&&0<pn.wordStartIndex){var pi;pi=pn.elements.length-pn.wordStartIndex+1,pn.elements.length=pn.wordStartIndex,pB-=pi,pb();continue}pJ=!1,pA+=pP.width}pR=pP.width+pC,pt=pP.height,pp=!1,(pJ=pJ||pL<pm+pR)&&pb(),pn.minTextHeight=Math.min(pn.minTextHeight,pf.height)}else pg=pf._getCSSStyle(),pS=pf,p$=pg.padding,0===pg._getCssFloat()||(pG=!0),pJ=pp||pg.lineElement,pR=pS.width*pS._style._tf.scaleX+p$[1]+p$[3]+pC,pt=pS.height*pS._style._tf.scaleY+p$[0]+p$[2],pp=pg.lineElement,(pJ=pJ||pL<pm+pR&&pg.wordWrap)&&pb();pn.elements.push(pf),pn.h=Math.max(pn.h,pt),pf.x=pm,pf.y=pE,pm+=pR,pn.w=pm-pC,pn.y=pE,pe=Math.max(pm+pl,pe)}else pd||(pm+=pM.DIV_ELEMENT_PADDING),pn.wordStartIndex=pn.elements.length;if(pE=pn.y+pn.h,pG){var pz=0,pc=pL;for(pv&&0<ph.width&&(pc=ph.width),pB=0,pr=pX.length;pB<pr;pB++)pX[pB].updatePos(0,pc,pB,pz,p_,pN,pu),pz+=Math.max(pu,pX[pB].h+pU);pE=pz}return pv&&(ph.width=pe),pE>ph.height&&(ph.height=pE),[pe,pE]},pM._multiLineLayout2=function(ph){var pq=new Array;ph._addChildsToLayout(pq);var pf,pg,p$,pP,pS,pB=0,pr=pq.length,pY=ph._getCSSStyle(),pC=pY.letterSpacing,pU=pY.leading,pu=pY.lineHeight,pv=pY._widthAuto()||!pY.wordWrap,pL=pv?999999:ph.width,pe=(ph.height,0),pl=pY.italic?pY.fontSize/3:0,p_=2-pY._getAlign(),pN=pY._getValign(),pG=0!==pN||0!=p_||0!=pu,pm=0,pE=0,pR=0,pt=0,pX=new Array,pn=pX[0]=new pT,pJ=!1,pp=!1;pn.h=0,pY.italic&&(pL-=pY.fontSize/3);var pA=0,pd=!0;function pb(){pn.y=pE,pE+=pn.h+pU,0==pn.h&&(pE+=pu),pn.mWidth=pA,pA=0,pn=new pT,pX.push(pn),pn.h=0,pJ=!(pd=!(pm=0))}for(pB=0;pB<pr;pB++)if(null!=(pf=pq[pB]))if(pd=!1,pf instanceof laya.html.dom.HTMLBrElement)pb(),pn.y=pE;else{if(pf._isChar()){if((pP=pf).isWord)pJ=pp||"\n"===pP.char,pn.wordStartIndex=pn.elements.length;else{if(0<pX.length&&pL<pm+pR&&0<pn.wordStartIndex){var pi;pi=pn.elements.length-pn.wordStartIndex+1,pn.elements.length=pn.wordStartIndex,pB-=pi,pb();continue}pJ=!1,pA+=pP.width}pR=pP.width+pC,pt=pP.height,pp=!1,(pJ=pJ||pL<pm+pR)&&pb(),pn.minTextHeight=Math.min(pn.minTextHeight,pf.height)}else pg=pf._getCSSStyle(),pS=pf,p$=pg.padding,0===pg._getCssFloat()||(pG=!0),pJ=pp||pg.lineElement,pR=pS.width*pS._style._tf.scaleX+p$[1]+p$[3]+pC,pt=pS.height*pS._style._tf.scaleY+p$[0]+p$[2],pp=pg.lineElement,(pJ=pJ||pL<pm+pR&&pg.wordWrap)&&pb();pn.elements.push(pf),pn.h=Math.max(pn.h,pt),pf.x=pm,pf.y=pE,pm+=pR,pn.w=pm-pC,pn.y=pE,pe=Math.max(pm+pl,pe)}else pd||(pm+=pM.DIV_ELEMENT_PADDING),pn.wordStartIndex=pn.elements.length;if(pE=pn.y+pn.h,pG){var pz=0,pc=pL;for(pB=0,pr=pX.length;pB<pr;pB++)pX[pB].updatePos(0,pc,pB,pz,p_,pN,pu),pz+=Math.max(pu,pX[pB].h+pU);pE=pz}for(pv&&(ph.width=pe),pE>ph.height&&(ph.height=pE),pB=0,pr=pX.length;pB<pr;pB++)pX[pB].revertOrder(pL);return[pe,pE]},pM._will=null,pM.DIV_ELEMENT_PADDING=0,pM}(),pT=function(){function ph(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}pS(ph,"laya.html.utils.LayoutLine");var pq=ph.prototype;return pq.updatePos=function(ph,pq,pf,pg,p$,pP,pS){var pB,pr=0;0<this.elements.length&&(pr=(pB=this.elements[this.elements.length-1]).x+pB.width-this.elements[0].x);var pY=0,pC=NaN;1===p$&&(pY=(pq-pr)/2),2===p$&&(pY=pq-pr),0===pS||0!=pP||(pP=1);for(var pU=0,pu=this.elements.length;pU<pu;pU++){var pv=(pB=this.elements[pU])._getCSSStyle();switch(0!==pY&&(pB.x+=pY),pv._getValign()){case 0:pB.y=pg;break;case 1:var pL=0;99999!=this.minTextHeight&&(pL=this.minTextHeight);var pe=(pL+pS)/2;pe=Math.max(pe,this.h),pC=(laya.html.dom.HTMLImageElement,pg+pe-pB.height),pB.y=pC;break;case 2:pB.y=pg+(pS-pB.height)}}},pq.revertOrder=function(ph){var pq;if(0<this.elements.length){var pf,pg=0;for(pf=this.elements.length,pg=0;pg<pf;pg++)(pq=this.elements[pg]).x=ph-pq.x-pq.width}},ph}(),pE=function(pf){function pq(){this.URI=null,this._href=null,pq.__super.call(this),this._text=pq._EMPTYTEXT,this.setStyle(new pr(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}pS(pq,"laya.html.dom.HTMLElement",pf);var ph=pq.prototype;return ph.layaoutCallNative=function(){var ph=0;if(this._childs&&0<(ph=this._childs.length))for(var pq=0;pq<ph;pq++)this._childs[pq].layaoutCallNative&&this._childs[pq].layaoutCallNative();var pf=this._getWords();pf?laya.html.dom.HTMLElement.fillWords(this,pf,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},ph.appendChild=function(ph){return this.addChild(ph)},ph._getWords2=function(){var ph=this._text.text;if(!ph||0===ph.length)return null;var pq,pf,pg=0,p$=0;if(this._text.drawWords)pf=this._text.drawWords;else{for(p$=(pq=ph.split(" ")).length-1,pf=[],pg=0;pg<p$;pg++)pf.push(pq[pg]," ");0<=p$&&pf.push(pq[p$]),this._text.drawWords=pf}var pP,pS=this._text.words;if(pS&&pS.length===pf.length)return pS;null===pS&&(this._text.words=pS=[]),pS.length=pf.length;var pB=this.style,pr=pB.font;for(pg=0,p$=pf.length;pg<p$;pg++){pP=pN.measureText(pf[pg],pr);var pY=pS[pg]=new pU(pf[pg],pP.width,pP.height||pB.fontSize,pB);if(1<pY.char.length&&(pY.charNum=pY.char),this.href){var pC=new pv;this.addChild(pC),pY.setSprite(pC)}}return pS},ph._getWords=function(){if(!pW.CharacterCache)return this._getWords2();var ph=this._text.text;if(!ph||0===ph.length)return null;var pq,pf=this._text.words;if(pf&&pf.length===ph.length)return pf;null===pf&&(this._text.words=pf=[]),pf.length=ph.length;for(var pg=this.style,p$=pg.font,pP=0,pS=ph.length;pP<pS;pP++)if(pq=pN.measureText(ph.charAt(pP),p$)){var pB=pf[pP]=new pU(ph.charAt(pP),pq.width,pq.height||pg.fontSize,pg);if(this.href){var pr=new pv;this.addChild(pr),pB.setSprite(pr)}}else console.warn("_getWords size is null"+ph.charAt(pP),p$);return pf},ph.showLinkSprite=function(){var ph=this._text.words;if(ph)for(var pq,pf,pg=[],p$=0;p$<ph.length;p$++)pf=ph[p$],(pq=new pv).graphics.drawRect(0,0,pf.width,pf.height,"#ff0000"),pq.width=pf.width,pq.height=pf.height,this.addChild(pq),pg.push(pq)},ph._layoutLater=function(){var ph=this.style;512&ph._type||(ph.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&ph.block?(pm.later(this),ph._type|=512):this.parent&&this.parent._layoutLater())},ph._setAttributes=function(ph,pq){switch(ph){case"style":return void this.style.cssText(pq);case"class":return void(this.className=pq)}pf.prototype._setAttributes.call(this,ph,pq)},ph.updateHref=function(){if(null!=this._href){var ph=this._getWords();if(ph)for(var pq,pf,pg=0;pg<ph.length;pg++)(pf=(pq=ph[pg]).getSprite())&&(pf.size(pq.width,pq.height),pf.on("click",this,this.onLinkHandler))}},ph.onLinkHandler=function(ph){switch(ph.type){case"click":for(var pq=this;pq;)pq.event("link",[this.href]),pq=pq.parent}},ph.formatURL=function(ph){return this.URI?p_.formatURL(ph,this.URI?this.URI.path:null):ph},pB(0,ph,"href",function(){return this._href},function(ph){null!=(this._href=ph)&&(this._getCSSStyle().underLine=1,this.updateHref())}),pB(0,ph,"color",null,function(ph){this.style.color=ph}),pB(0,ph,"onClick",null,function(ph){pg._runScript("fn=function(event){"+ph+";}"),this.on("click",this,void 0)}),pB(0,ph,"id",null,function(ph){pR.document.setElementById(ph,this)}),pB(0,ph,"innerTEXT",function(){return this._text.text},function(ph){this.text=ph}),pB(0,ph,"style",function(){return this._style}),pB(0,ph,"text",function(){return this._text.text},function(ph){this._text==pq._EMPTYTEXT?this._text={text:ph,words:null}:(this._text.text=ph,this._text.words&&(this._text.words.length=0)),pu.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),pB(0,ph,"parent",pf.prototype._$get_parent,function(ph){if(ph instanceof laya.html.dom.HTMLElement){var pq=ph;this.URI||(this.URI=pq.URI),this.style.inherit(pq.style)}pg.superSet(pv,this,"parent",ph)}),pB(0,ph,"className",null,function(ph){this.style.attrs(pR.document.styleSheets["."+ph])}),pq.fillWords=function(ph,pq,pf,pg,p$,pP,pS){ph.graphics.clear();for(var pB=0,pr=pq.length;pB<pr;pB++){var pY=pq[pB];ph.graphics.fillText(pY.char,pY.x+pf,pY.y+pg,p$,pP,"left",pS)}},pq._EMPTYTEXT={text:null,words:null},pq}(pv),pq=(function(ph){function pq(){pq.__super.call(this),this.style.lineElement=!0,this.style.block=!0}pS(pq,"laya.html.dom.HTMLBrElement",pE)}(),function(ph){function pq(){this.contextHeight=NaN,this.contextWidth=NaN,pq.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}pS(pq,"laya.html.dom.HTMLDivElement",ph);var pf=pq.prototype;return pf.appendHTML=function(ph){pG.parse(this,ph,this.URI),this.layout()},pf._addChildsToLayout=function(pq){var ph=this._getWords();if(null==ph&&0==this._childs.length)return!1;ph&&ph.forEach(function(ph){pq.push(ph)});for(var pf=!0,pg=0,p$=this._childs.length;pg<p$;pg++){var pP=this._childs[pg];pf?pf=!1:pq.push(null),pP._addToLayout(pq)}return!0},pf._addToLayout=function(ph){this.layout()},pf.layout=function(){if(this.style){this.style._type|=512;var ph=pm.layout(this);if(ph){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new pC);var pq=this._$P.mHtmlBounds;pq.x=pq.y=0,pq.width=this.contextWidth=ph[0],pq.height=this.contextHeight=ph[1],this.setBounds(pq)}}},pB(0,pf,"height",function(){return this._height?this._height:this.contextHeight},ph.prototype._$set_height),pB(0,pf,"innerHTML",null,function(ph){this.destroyChildren(),this.appendHTML(ph)}),pB(0,pf,"width",function(){return this._width?this._width:this.contextWidth},function(ph){var pq=!1;pq=0===ph?ph!=this._width:ph!=this.width,pg.superSet(pE,this,"width",ph),pq&&this.layout()}),pq}(pE)),pR=function(ph){function pq(){this.all=new Array,this.styleSheets=pr.styleSheets,pq.__super.call(this)}pS(pq,"laya.html.dom.HTMLDocument",pE);var pf=pq.prototype;return pf.getElementById=function(ph){return this.all[ph]},pf.setElementById=function(ph,pq){this.all[ph]=pq},p$(pq,["document",function(){return this.document=new pq}]),pq}();(function(ph){function pq(){this._tex=null,this._url=null,this._renderArgs=[],pq.__super.call(this),this.style.block=!0}pS(pq,"laya.html.dom.HTMLImageElement",pE);var pf=pq.prototype;pf._addToLayout=function(ph){!this._style.absolute&&ph.push(this)},pf.render=function(ph,pq,pf){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(pe.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,ph.ctx.drawTexture2(pq,pf,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},pf.layaoutCallNative=function(){var ph=0;if(this._childs&&0<(ph=this._childs.length))for(var pq=0;pq<ph;pq++)this._childs[pq].layaoutCallNative&&this._childs[pq].layaoutCallNative()},pB(0,pf,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(ph){this._width!==ph&&(this._width=ph,this._style.width=ph,this.repaint())}),pB(0,pf,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(ph){this._height!==ph&&(this._height=ph,this._style.height=ph,this.repaint())}),pf.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),pY.clearCache(this,this._url),this._tex=null),pE.prototype.destroy.call(this)},pf.onloaded=function(){var ph=this._style;ph&&!ph.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),ph&&!ph.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),pu.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},pf._loadImageComplete=function(ph,pq,pf){if(!this._destroyed)if(null!=pf)if(pf instanceof ArrayBuffer){var pg=new DataView(pf);new laya.webgl.resource.WebGLImage(new Uint8Array(pf,8),ph,0,!1,pg.getUint32(0),pg.getUint32(4));this.onloaded()}else if(pf instanceof pl)pY.imgMgrSet[ph]=pq,pP.imgMgrLock(ph,pY.imgMgrSet[ph]),this._url=ph,this._tex=pf,pY.keepCache(this,ph),pY.cacheRes(ph,this._tex),this.onloaded();else{var p$=-1!=ph.indexOf(".png",ph.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(pf,ph,p$,!1,pf.width,pf.height);this.onloaded()}else this.event("error","Load image failed")},pB(0,pf,"src",null,function(ph){(ph=this.formatURL(ph),this._url!=ph)&&(null!=this._tex&&(pY.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=ph,(this._tex=pY.getRes(ph))?(pY.keepCache(this,ph),this.onloaded()):pP.imgMgrLoad(ph,this._loadImageComplete.bind(this),2,!1))})})(),function(ph){function pq(){this.type=null,pq.__super.call(this),this.visible=!1}pS(pq,"laya.html.dom.HTMLLinkElement",ph);var pf=pq.prototype;pf._onload=function(ph){switch(this.type){case"text/css":pr.parseCSS(ph,this.URI)}},pB(0,pf,"href",ph.prototype._$get_href,function(ph){var pq=this;ph=this.formatURL(ph),this.URI=new p_(ph);var pf=new pY;pf.once("complete",null,function(ph){pq._onload(ph)}),pf.load(ph,"text")}),pq._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(pE),function(ph){function pq(){pq.__super.call(this),this.visible=!1}pS(pq,"laya.html.dom.HTMLStyleElement",ph),pB(0,pq.prototype,"text",ph.prototype._$get_text,function(ph){pr.parseCSS(ph,null)})}(pE),function(ph){function pq(){pq.__super.call(this),this._getCSSStyle().valign="middle"}pS(pq,"laya.html.dom.HTMLIframeElement",ph),pB(0,pq.prototype,"href",ph.prototype._$get_href,function(pf){var pg=this;pf=this.formatURL(pf);var ph=new pY;ph.once("complete",null,function(ph){var pq=pg.URI;pg.URI=new p_(pf),pg.innerHTML=ph,!pq||(pg.URI=pq)}),ph.load(pf,"text")})}(pq)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ph,pq){"use strict";for(var pf in Object.defineProperty(pq,"__esModule",{value:!0}),Laya){var pg=Laya[pf];pg&&pg.__isclass&&(pq[pf]=pg)}}),function(ph,pq,pe){pe.un,pe.uns;var pg=pe.static,pP=pe.class,p$=pe.getset,pf=(pe.__newvec,laya.display.Animation),pl=(laya.utils.Browser,laya.utils.ClassUtils),pS=laya.filters.ColorFilter,pB=laya.utils.Ease,pr=laya.events.Event,pY=(laya.events.EventDispatcher,laya.display.css.Font),pC=laya.display.FrameAnimation,pU=laya.display.Graphics,pu=laya.utils.Handler,pv=laya.display.Input,pN=laya.net.Loader,pL=(laya.display.Node,laya.maths.Point),p_=laya.maths.Rectangle,pG=laya.renders.Render,pm=laya.display.Sprite,pE=laya.display.Text,pR=laya.resource.Texture,pt=laya.utils.Tween,pX=laya.utils.Utils,pn=laya.utils.WeakObject;pe.interface("laya.ui.IItem"),pe.interface("laya.ui.ISelect"),pe.interface("laya.ui.IRender"),pe.interface("laya.ui.IComponent"),pe.interface("laya.ui.IBox","IComponent");var pJ=function(){function ph(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return pP(ph,"laya.ui.LayoutStyle"),pg(ph,["EMPTY",function(){return this.EMPTY=new ph}]),ph}(),pp=function(){function ph(){}return pP(ph,"laya.ui.Styles"),ph.labelColor="#000000",ph.buttonStateNum=3,ph.scrollBarMinNum=15,ph.scrollBarDelayTime=500,pg(ph,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),ph}(),pA=function(){function p$(){}return pP(p$,"laya.ui.UIUtils"),p$.fillArray=function(ph,pq,pf){var pg=ph.concat();if(pq)for(var p$=pq.split(","),pP=0,pS=Math.min(pg.length,p$.length);pP<pS;pP++){var pB=p$[pP];pg[pP]="true"==pB||"false"!=pB&&pB,null!=pf&&(pg[pP]=pf(pB))}return pg},p$.toColor=function(ph){return pX.toHexColor(ph)},p$.gray=function(ph,pq){void 0===pq&&(pq=!0),pq?p$.addFilter(ph,p$.grayFilter):p$.clearFilter(ph,pS)},p$.addFilter=function(ph,pq){var pf=ph.filters||[];pf.push(pq),ph.filters=pf},p$.clearFilter=function(ph,pq){var pf=ph.filters;if(null!=pf&&0<pf.length){for(var pg=pf.length-1;-1<pg;pg--){var p$=pf[pg];pe.__typeof(p$,pq)&&pf.splice(pg,1)}ph.filters=pf}},p$._getReplaceStr=function(ph){return p$.escapeSequence[ph]},p$.adptString=function(ph){return ph.replace(/\\(\w)/g,p$._getReplaceStr)},p$.getBindFun=function(ph){var pq=p$._funMap.get(ph);if(null==pq){var pf='"'+ph+'"',pg="(function(data){if(data==null)return;with(data){try{\nreturn "+(pf=pf.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";pq=pe._runScript(pg),p$._funMap.set(ph,pq)}return pq},pg(p$,["grayFilter",function(){return this.grayFilter=new pS([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new pn}]),p$}(),pd=function(){function ph(){}return pP(ph,"UIConfig"),ph.touchScrollEnable=!0,ph.mouseWheelEnable=!0,ph.showButtons=!0,ph.popupBgColor="#000000",ph.popupBgAlpha=.5,ph.closeDialogOnSide=!0,ph}(),pb=function(pf){function p_(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,p_.__super.call(this),this._weakKeys=[]}pP(p_,"laya.ui.AutoBitmap",pf);var ph=p_.prototype;return ph.destroy=function(){if(pN.clearObject(this,this._weakKey),this._weakKeys){for(var ph=0,pq=this._weakKeys.length;ph<pq;++ph)pN.clearObject(this,this._weakKeys[ph]);this._weakKeys=null}pf.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},ph._setChanged=function(){this._isChanged||(this._isChanged=!0,pe.timer.callLater(this,this.changeSource))},ph.changeSource=function(){this._isChanged=!1;var ph=this._source;if(ph&&ph.bitmap){var pq=this.width,pf=this.height,pg=this._sizeGrid,p$=ph.sourceWidth,pP=ph.sourceHeight;if(!pg||p$===pq&&pP===pf)this.cleanByTexture(ph,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,pq,pf);else{pN.clearObject(this,this._weakKey),ph.$_GID||(ph.$_GID=pX.getGID());var pS=ph.$_GID+"."+pq+"."+pf+"."+pg.join("."),pB=pN.findObject(pS);if(pX.isOKCmdList(pB))return this._weakKey=pS,pN.keepObject(this,this._weakKey),void(this.cmds=pB);this.clear();var pr,pY,pC=pg[0],pU=pg[1],pu=pg[2],pv=pg[3],pL=pg[4],pe=!1;if(pq==p$&&(pv=pU=0),pf==pP&&(pC=pu=0),pq<pv+pU){var pl=pq;pe=!0,pq=pv+pU,this.save(),this.clipRect(0,0,pl,pf)}pv&&pC&&(pr=p_.getTexture(ph,0,0,pv,pC),pY=this._weakKeys[0],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[0]=pr.weakKey),this.drawTexture(pr,0,0,pv,pC)):(pN.clearObject(this,pY),this._weakKeys[0]="")),pU&&pC&&(pr=p_.getTexture(ph,p$-pU,0,pU,pC),pY=this._weakKeys[1],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[1]=pr.weakKey),this.drawTexture(pr,pq-pU,0,pU,pC)):(pN.clearObject(this,pY),this._weakKeys[1]="")),pv&&pu&&(pr=p_.getTexture(ph,0,pP-pu,pv,pu),pY=this._weakKeys[2],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[2]=pr.weakKey),this.drawTexture(pr,0,pf-pu,pv,pu)):(pN.clearObject(this,pY),this._weakKeys[2]="")),pU&&pu&&(pr=p_.getTexture(ph,p$-pU,pP-pu,pU,pu),pY=this._weakKeys[3],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[3]=pr.weakKey),this.drawTexture(pr,pq-pU,pf-pu,pU,pu)):(pN.clearObject(this,pY),this._weakKeys[3]="")),pC&&(pr=p_.getTexture(ph,pv,0,p$-pv-pU,pC),pY=this._weakKeys[4],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[4]=pr.weakKey),this.drawBitmap(pL,pr,pv,0,pq-pv-pU,pC)):(pN.clearObject(this,pY),this._weakKeys[4]="")),pu&&(pr=p_.getTexture(ph,pv,pP-pu,p$-pv-pU,pu),pY=this._weakKeys[5],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[5]=pr.weakKey),this.drawBitmap(pL,pr,pv,pf-pu,pq-pv-pU,pu)):(pN.clearObject(this,pY),this._weakKeys[5]="")),pv&&(pr=p_.getTexture(ph,0,pC,pv,pP-pC-pu),pY=this._weakKeys[6],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[6]=pr.weakKey),this.drawBitmap(pL,pr,0,pC,pv,pf-pC-pu)):(pN.clearObject(this,pY),this._weakKeys[6]="")),pU&&(pr=p_.getTexture(ph,p$-pU,pC,pU,pP-pC-pu),pY=this._weakKeys[7],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[7]=pr.weakKey),this.drawBitmap(pL,pr,pq-pU,pC,pU,pf-pC-pu)):(pN.clearObject(this,pY),this._weakKeys[7]="")),pr=p_.getTexture(ph,pv,pC,p$-pv-pU,pP-pC-pu),pY=this._weakKeys[8],pr?(pY!=pr.weakKey&&(pN.clearObject(this,pY),pN.keepObject(this,pr.weakKey),this._weakKeys[8]=pr.weakKey),this.drawBitmap(pL,pr,pv,pC,pq-pv-pU,pf-pC-pu)):(pN.clearObject(this,pY),this._weakKeys[8]=""),pe&&this.restore(),this.autoCacheCmd&&!pG.isConchApp&&(pN.saveObject(pS,this.cmds,null),this._weakKey=pS,pN.keepObject(this,this._weakKey))}this._repaint()}},ph.drawBitmap=function(ph,pq,pf,pg,p$,pP){void 0===p$&&(p$=0),void 0===pP&&(pP=0),p$<.1||pP<.1||(!ph||pq.width==p$&&pq.height==pP?this.drawTexture(pq,pf,pg,p$,pP):this.fillTexture(pq,pf,pg,p$,pP))},ph.clear=function(ph){void 0===ph&&(ph=!0),pf.prototype.clear.call(this,!1)},p$(0,ph,"sizeGrid",function(){return this._sizeGrid},function(ph){this._sizeGrid=ph,this._setChanged()}),p$(0,ph,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(ph){this._width!=ph&&(this._width=ph,this._setChanged())}),p$(0,ph,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(ph){this._height!=ph&&(this._height=ph,this._setChanged())}),p$(0,ph,"source",function(){return this._source},function(ph){ph?(this._source=ph,this._setChanged()):(this._source=null,this.clear())}),p_.getTexture=function(ph,pq,pf,pg,p$){pg<=0&&(pg=1),p$<=0&&(p$=1),ph.$_GID||(ph.$_GID=pX.getGID());var pP=ph.$_GID+"."+pq+"."+pf+"."+pg+"."+p$,pS=pN.findObject(pP);if((!pS||!pS.source)&&(pS=pR.createFromTexture(ph,pq,pf,pg,p$))){if(ph.alphaTexture){var pB=ph.width/ph.alphaTexture.width;pS.alphaTexture=pR.createFromTexture(ph.alphaTexture,pq/pB,pf/pB,pg/pB,p$/pB)}pN.saveObject(pP,pS),pS.weakKey=pP}return pS},p_}(pU),pi=(function(ph){function pq(){pq.__super.call(this)}pP(pq,"laya.ui.UIEvent",pr),pq.SHOW_TIP="showtip",pq.HIDE_TIP="hidetip"}(),function(pq){function ph(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,ph.__super.call(this),this._layout=pJ.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}pP(ph,"laya.ui.Component",pq);var pf=ph.prototype;return pe.imps(pf,{"laya.ui.IComponent":!0}),pf.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},pf.preinitialize=function(){},pf.createChildren=function(){},pf.initialize=function(){},pf.callLater=function(ph,pq){pe.timer.callLater(this,ph,pq)},pf.runCallLater=function(ph){pe.timer.runCallLater(this,ph)},pf.commitMeasure=function(){},pf.changeSize=function(){this.event("resize")},pf.getLayout=function(){return this._layout===pJ.EMPTY&&(this._layout=new pJ),this._layout},pf._setLayoutEnabled=function(ph){this._layout&&this._layout.enable!=ph&&(this._layout.enable=ph,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},pf.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},pf.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},pf.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},pf.resetLayoutX=function(){var ph=this._layout;if(isNaN(ph.anchorX)||(this.pivotX=ph.anchorX*this.width),this.layoutEnabled){var pq=this.parent;pq&&(isNaN(ph.centerX)?isNaN(ph.left)?isNaN(ph.right)||(this.x=Math.round(pq.width-this.displayWidth-ph.right+this.pivotX*this.scaleX)):(this.x=Math.round(ph.left+this.pivotX*this.scaleX),isNaN(ph.right)||(this.width=(pq._width-ph.left-ph.right)/(this.scaleX||.01))):this.x=Math.round(.5*(pq.width-this.displayWidth)+ph.centerX+this.pivotX*this.scaleX))}},pf.resetLayoutY=function(){var ph=this._layout;if(isNaN(ph.anchorY)||(this.pivotY=ph.anchorY*this.height),this.layoutEnabled){var pq=this.parent;pq&&(isNaN(ph.centerY)?isNaN(ph.top)?isNaN(ph.bottom)||(this.y=Math.round(pq.height-this.displayHeight-ph.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(ph.top+this.pivotY*this.scaleY),isNaN(ph.bottom)||(this.height=(pq._height-ph.top-ph.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(pq.height-this.displayHeight)+ph.centerY+this.pivotY*this.scaleY))}},pf.onMouseOver=function(ph){pe.stage.event("showtip",this._toolTip)},pf.onMouseOut=function(ph){pe.stage.event("hidetip",this._toolTip)},p$(0,pf,"displayWidth",function(){return this.width*this.scaleX}),p$(0,pf,"width",function(){return this._width?this._width:this.measureWidth},function(ph){this._width!=ph&&(this._width=ph,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),p$(0,pf,"measureWidth",function(){var ph=0;this.commitMeasure();for(var pq=this.numChildren-1;-1<pq;pq--){var pf=this.getChildAt(pq);pf.visible&&(ph=Math.max(pf.x+pf.width*pf.scaleX,ph))}return ph}),p$(0,pf,"displayHeight",function(){return this.height*this.scaleY}),p$(0,pf,"height",function(){return this._height?this._height:this.measureHeight},function(ph){this._height!=ph&&(this._height=ph,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),p$(0,pf,"dataSource",function(){return this._dataSource},function(ph){for(var pq in this._dataSource=ph,this._dataSource)this.hasOwnProperty(pq)&&"function"!=typeof this[pq]&&(this[pq]=this._dataSource[pq])}),p$(0,pf,"scaleY",pq.prototype._$get_scaleY,function(ph){pe.superGet(pm,this,"scaleY")!=ph&&(pe.superSet(pm,this,"scaleY",ph),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),p$(0,pf,"measureHeight",function(){var ph=0;this.commitMeasure();for(var pq=this.numChildren-1;-1<pq;pq--){var pf=this.getChildAt(pq);pf.visible&&(ph=Math.max(pf.y+pf.height*pf.scaleY,ph))}return ph}),p$(0,pf,"scaleX",pq.prototype._$get_scaleX,function(ph){pe.superGet(pm,this,"scaleX")!=ph&&(pe.superSet(pm,this,"scaleX",ph),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),p$(0,pf,"top",function(){return this._layout.top},function(ph){ph!=this._layout.top&&(this.getLayout().top=ph,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$(0,pf,"bottom",function(){return this._layout.bottom},function(ph){ph!=this._layout.bottom&&(this.getLayout().bottom=ph,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$(0,pf,"left",function(){return this._layout.left},function(ph){ph!=this._layout.left&&(this.getLayout().left=ph,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$(0,pf,"right",function(){return this._layout.right},function(ph){ph!=this._layout.right&&(this.getLayout().right=ph,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$(0,pf,"centerX",function(){return this._layout.centerX},function(ph){ph!=this._layout.centerX&&(this.getLayout().centerX=ph,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$(0,pf,"centerY",function(){return this._layout.centerY},function(ph){ph!=this._layout.centerY&&(this.getLayout().centerY=ph,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$(0,pf,"anchorX",function(){return this._layout.anchorX},function(ph){ph!=this._layout.anchorX&&(this.getLayout().anchorX=ph,this._setLayoutEnabled(!0)),this.resetLayoutX()}),p$(0,pf,"anchorY",function(){return this._layout.anchorY},function(ph){ph!=this._layout.anchorY&&(this.getLayout().anchorY=ph,this._setLayoutEnabled(!0)),this.resetLayoutY()}),p$(0,pf,"tag",function(){return this._tag},function(ph){this._tag=ph}),p$(0,pf,"toolTip",function(){return this._toolTip},function(ph){this._toolTip!=ph&&(null!=(this._toolTip=ph)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),p$(0,pf,"comXml",function(){return this._comXml},function(ph){this._comXml=ph}),p$(0,pf,"gray",function(){return this._gray},function(ph){ph!==this._gray&&(this._gray=ph,pA.gray(this,ph))}),p$(0,pf,"disabled",function(){return this._disabled},function(ph){ph!==this._disabled&&(this.gray=this._disabled=ph,this.mouseEnabled=!ph)}),ph}(pm)),pz=function(ph){function pq(){this.lockLayer=null,this.popupEffect=function(ph){ph.scale(1,1),pt.from(ph,{x:pe.stage.width/2,y:pe.stage.height/2,scaleX:0,scaleY:0},300,pB.backOut,pu.create(this,this.doOpen,[ph]))},this.closeEffect=function(ph,pq){pt.to(ph,{x:pe.stage.width/2,y:pe.stage.height/2,scaleX:0,scaleY:0},300,pB.strongOut,pu.create(this,this.doClose,[ph,pq]))},pq.__super.call(this),this.maskLayer=new pm,this.popupEffectHandler=pu.create(this,this.popupEffect,null,!1),this.closeEffectHandler=pu.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,pe.stage.addChild(this),pe.stage.on("resize",this,this._onResize),pd.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}pP(pq,"laya.ui.DialogManager",pm);var pf=pq.prototype;return pf._closeOnSide=function(){var ph=this.getChildAt(this.numChildren-1);ph instanceof laya.ui.Dialog&&ph.close("side")},pf.setLockView=function(ph){this.lockLayer||(this.lockLayer=new pc,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(pe.stage.width,pe.stage.height)),this.lockLayer.removeChildren(),ph&&(ph.centerX=ph.centerY=0,this.lockLayer.addChild(ph))},pf._onResize=function(ph){var pq=this.maskLayer.width=pe.stage.width,pf=this.maskLayer.height=pe.stage.height;this.lockLayer&&this.lockLayer.size(pq,pf),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,pq,pf,pd.popupBgColor),this.maskLayer.alpha=pd.popupBgAlpha;for(var pg=this.numChildren-1;-1<pg;pg--){var p$=this.getChildAt(pg);p$.popupCenter&&this._centerDialog(p$)}},pf._centerDialog=function(ph){ph.x=Math.round((pe.stage.width-ph.width>>1)+ph.pivotX),ph.y=Math.round((pe.stage.height-ph.height>>1)+ph.pivotY)},pf.open=function(ph,pq,pf){void 0===pq&&(pq=!1),void 0===pf&&(pf=!1),pq&&this._closeAll(),ph.popupCenter&&this._centerDialog(ph),this.addChild(ph),(ph.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),pf&&null!=ph.popupEffect?ph.popupEffect.runWith(ph):this.doOpen(ph),this.event("open")},pf.doOpen=function(ph){ph.onOpened()},pf.lock=function(ph){this.lockLayer&&(ph?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},pf.close=function(ph,pq,pf){void 0===pf&&(pf=!1),pf&&null!=ph.closeEffect?ph.closeEffect.runWith([ph,pq]):this.doClose(ph,pq),this.event("close")},pf.doClose=function(ph,pq){ph.removeSelf(),ph.isModal&&this._checkMask(),ph.closeHandler&&ph.closeHandler.runWith(pq),ph.onClosed(pq)},pf.closeAll=function(){this._closeAll(),this.event("close")},pf._closeAll=function(){for(var ph=this.numChildren-1;-1<ph;ph--){var pq=this.getChildAt(ph);pq&&null!=pq.close&&this.doClose(pq)}},pf.getDialogsByGroup=function(ph){for(var pq=[],pf=this.numChildren-1;-1<pf;pf--){var pg=this.getChildAt(pf);pg&&pg.group===ph&&pq.push(pg)}return pq},pf.closeByGroup=function(ph){for(var pq=[],pf=this.numChildren-1;-1<pf;pf--){var pg=this.getChildAt(pf);pg&&pg.group===ph&&(pg.close(),pq.push(pg))}return pq},pf._checkMask=function(){this.maskLayer.removeSelf();for(var ph=this.numChildren-1;-1<ph;ph--){var pq=this.getChildAt(ph);if(pq&&pq.isModal)return void this.addChildAt(this.maskLayer,ph)}},pq}(),pc=function(ph){function pq(){pq.__super.call(this)}pP(pq,"laya.ui.Box",ph);var pf=pq.prototype;return pe.imps(pf,{"laya.ui.IBox":!0}),p$(0,pf,"dataSource",ph.prototype._$get_dataSource,function(ph){for(var pq in this._dataSource=ph){var pf=this.getChildByName(pq);pf?pf.dataSource=ph[pq]:this.hasOwnProperty(pq)&&"function"!=typeof this[pq]&&(this[pq]=ph[pq])}}),pq}(pi),pM=function(pq){function pf(ph,pq){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,pf.__super.call(this),this._labelColors=pp.buttonLabelColors,this._stateNum=pp.buttonStateNum,void 0===pq&&(pq=""),this.skin=ph,this.label=pq}pP(pf,"laya.ui.Button",pq);var ph=pf.prototype;return pe.imps(ph,{"laya.ui.ISelect":!0}),ph.destroy=function(ph){pN.clearCache(this,this._skin),pN.clearObject(this,this._weakKey),void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(ph),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},ph.createChildren=function(){this.graphics=this._bitmap=new pb},ph.createText=function(){this._text||(this._text=new pE,this._text.overflow=pE.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},ph.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},ph.onMouse=function(ph){if(!1!==this.toggle||!this._selected)return"click"===ph.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=pf.stateMap[ph.type]))},ph.changeClips=function(){var ph=pN.getRes(this._skin);if(ph&&this._skin&&""!=this._skin){pN.clearObject(this,this._weakKey);var pq=ph.sourceWidth,pf=ph.sourceHeight/this._stateNum;ph.$_GID||(ph.$_GID=pX.getGID());var pg=ph.$_GID+"-"+this._stateNum,p$=pN.findObject(pg);if(pX.isOkTextureList(p$)||(p$=null),p$)this._weakKey=pg,pN.keepObject(this,this._weakKey),this._sources=p$;else{if(this._sources=[],1===this._stateNum)this._sources.push(ph);else for(var pP=0;pP<this._stateNum;pP++){var pS=pR.createFromTexture(ph,0,pf*pP,pq,pf);if(ph.alphaTexture){var pB=ph.width/ph.alphaTexture.width;pS.alphaTexture=pR.createFromTexture(ph.alphaTexture,0/pB,pf*pP/pB,pq/pB,pf/pB)}this._sources.push(pS)}pN.saveObject(pg,this._sources),this._weakKey=pg,pN.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||pq,this._bitmap.height=this._height||pf,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=pq)}else console.warn("lose skin ",this._skin,this.name,this.__className)},ph.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var ph=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[ph]),this.label&&(this._text.color=this._labelColors[ph],this._strokeColors&&(this._text.strokeColor=this._strokeColors[ph]))},ph._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},p$(0,ph,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(ph){this.createText(),this._text.strokeColor=ph}),p$(0,ph,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),p$(0,ph,"skin",function(){return this._skin},function(ph){this._skin!=ph&&(pN.clearCache(this,this._skin),this._skin=ph,pN.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),p$(0,ph,"state",function(){return this._state},function(ph){this._state!=ph&&(this._state=ph,this._setStateChanged())}),p$(0,ph,"text",function(){return this.createText(),this._text}),p$(0,ph,"stateNum",function(){return this._stateNum},function(ph){"string"==typeof ph&&(ph=parseInt(ph)),this._stateNum!=ph&&(this._stateNum=ph<1?1:3<ph?3:ph,this.callLater(this.changeClips))}),p$(0,ph,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(ph){this._strokeColors=pA.fillArray(pp.buttonLabelColors,ph,String),this._setStateChanged()}),p$(0,ph,"labelColors",function(){return this._labelColors.join(",")},function(ph){this._labelColors=pA.fillArray(pp.buttonLabelColors,ph,String),this._setStateChanged()}),p$(0,ph,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),p$(0,ph,"label",function(){return this._text?this._text.text:null},function(ph){(this._text||ph)&&(this.createText(),this._text.text!=ph&&(ph&&!this._text.parent&&this.addChild(this._text),this._text.text=(ph+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),p$(0,ph,"selected",function(){return this._selected},function(ph){this._selected!=ph&&(this._selected=ph,this.state=this._selected?2:0,this.event("change"))}),p$(0,ph,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(ph){this.createText(),this._text.padding=pA.fillArray(pp.labelPadding,ph,Number)}),p$(0,ph,"labelSize",function(){return this.createText(),this._text.fontSize},function(ph){this.createText(),this._text.fontSize=ph}),p$(0,ph,"labelStroke",function(){return this.createText(),this._text.stroke},function(ph){this.createText(),this._text.stroke=ph}),p$(0,ph,"labelBold",function(){return this.createText(),this._text.bold},function(ph){this.createText(),this._text.bold=ph}),p$(0,ph,"labelFont",function(){return this.createText(),this._text.font},function(ph){this.createText(),this._text.font=ph}),p$(0,ph,"labelAlign",function(){return this.createText(),this._text.align},function(ph){this.createText(),this._text.align=ph}),p$(0,ph,"clickHandler",function(){return this._clickHandler},function(ph){this._clickHandler=ph}),p$(0,ph,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(ph){this._bitmap.sizeGrid=pA.fillArray(pp.defaultSizeGrid,ph,Number)}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pi,this,"width",ph),this._autoSize&&(this._bitmap.width=ph,this._text&&(this._text.width=ph))}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pi,this,"height",ph),this._autoSize&&(this._bitmap.height=ph,this._text&&(this._text.height=ph))}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)||"string"==typeof ph?this.label=ph+"":pe.superSet(pi,this,"dataSource",ph)}),p$(0,ph,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(ph){this._bitmap._offset=ph?pA.fillArray([1,1],ph,Number):[]}),pg(pf,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),pf}(pi),pW=function(pq){function pg(ph,pq,pf){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,pg.__super.call(this),void 0===pq&&(pq=1),void 0===pf&&(pf=1),this._clipX=pq,this._clipY=pf,this.skin=ph}pP(pg,"laya.ui.Clip",pq);var ph=pg.prototype;return ph.destroy=function(ph){pN.clearCache(this,this._skin),pN.clearObject(this,this._weakKey),void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},ph.dispose=function(){this.destroy(!0),pe.loader.clearRes(this._skin)},ph.createChildren=function(){this.graphics=this._bitmap=new pb},ph._onDisplay=function(ph){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},ph.changeClip=function(){if(this._clipChanged=!1,this._skin){var ph=pN.getRes(this._skin);ph?this.loadComplete(this._skin,ph):pe.loader.load(this._skin,pu.create(this,this.loadComplete,[this._skin]))}},ph.loadComplete=function(ph,pq){if(ph===this._skin&&pq){pN.clearObject(this,this._weakKey);var pf=this._clipWidth||Math.ceil(pq.sourceWidth/this._clipX),pg=this._clipHeight||Math.ceil(pq.sourceHeight/this._clipY),p$=this._skin+pf+pg,pP=pN.findObject(p$);if(pX.isOkTextureList(pP)||(pP=null),pP)this._weakKey=p$,pN.keepObject(this,this._weakKey),this._sources=pP;else{this._sources=[];for(var pS=0;pS<this._clipY;pS++)for(var pB=0;pB<this._clipX;pB++){var pr=pR.createFromTexture(pq,pf*pB,pg*pS,pf,pg);if(pq.alphaTexture){var pY=pq.width/pq.alphaTexture.width;pr.alphaTexture=pR.createFromTexture(pq.alphaTexture,pf*pB/pY,pg*pS/pY,pf/pY,pg/pY)}this._sources.push(pr)}pN.saveObject(p$,this._sources),this._weakKey=p$,pN.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},ph.play=function(ph,pq){void 0===ph&&(ph=0),void 0===pq&&(pq=-1),this._isPlaying=!0,this.index=ph,this._toIndex=pq,this._index++,pe.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},ph._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},ph.stop=function(){this._isPlaying=!1,pe.timer.clear(this,this._loop),this.event("complete")},ph._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},p$(0,ph,"interval",function(){return this._interval},function(ph){this._interval!=ph&&(this._interval=ph,this._isPlaying&&this.play())}),p$(0,ph,"skin",function(){return this._skin},function(ph){this._skin!=ph&&(pN.clearCache(this,this._skin),(this._skin=ph)?(pN.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),p$(0,ph,"sources",function(){return this._sources},function(ph){this._sources=ph,this.index=this._index,this.event("loaded")}),p$(0,ph,"clipX",function(){return this._clipX},function(ph){this._clipX=ph||1,this._setClipChanged()}),p$(0,ph,"clipY",function(){return this._clipY},function(ph){this._clipY=ph||1,this._setClipChanged()}),p$(0,ph,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),p$(0,ph,"clipWidth",function(){return this._clipWidth},function(ph){this._clipWidth=ph,this._setClipChanged()}),p$(0,ph,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(ph){this._bitmap.sizeGrid=pA.fillArray(pp.defaultSizeGrid,ph,Number)}),p$(0,ph,"group",function(){return this._group},function(ph){ph&&this._skin&&pN.setGroup(this._skin,ph),this._group=ph}),p$(0,ph,"clipHeight",function(){return this._clipHeight},function(ph){this._clipHeight=ph,this._setClipChanged()}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pi,this,"width",ph),this._bitmap.width=ph}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pi,this,"height",ph),this._bitmap.height=ph}),p$(0,ph,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),p$(0,ph,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),p$(0,ph,"index",function(){return this._index},function(ph){this._index=ph,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[ph]),this.event("change")}),p$(0,ph,"autoPlay",function(){return this._autoPlay},function(ph){this._autoPlay!=ph&&((this._autoPlay=ph)?this.play():this.stop())}),p$(0,ph,"isPlaying",function(){return this._isPlaying},function(ph){this._isPlaying=ph}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)&&Math.floor(ph)==ph||"string"==typeof ph?this.index=parseInt(ph):pe.superSet(pi,this,"dataSource",ph)}),p$(0,ph,"bitmap",function(){return this._bitmap}),pg}(pi),pT=function(pq){function ph(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,ph.__super.call(this)}pP(ph,"laya.ui.ColorPicker",pq);var pf=ph.prototype;return pf.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._colorPanel&&this._colorPanel.destroy(ph),this._colorButton&&this._colorButton.destroy(ph),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},pf.createChildren=function(){this.addChild(this._colorButton=new pM),this._colorPanel=new pc,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new pm),this._colorPanel.addChild(this._colorBlock=new pm),this._colorPanel.addChild(this._colorInput=new pv)},pf.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},pf.onPanelMouseDown=function(ph){ph.stopPropagation()},pf.changePanel=function(){this._panelChanged=!1;var ph=this._colorPanel.graphics;ph.clear(),ph.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(ph=this._colorTiles.graphics).clear();for(var pq=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],pf=0;pf<12;pf++)for(var pg=0;pg<20;pg++){var p$=0;p$=0===pg?pq[pf]:1===pg?0:51*(((3*pf+pg/6)%3<<0)+3*(pf/6<<0))<<16|pg%6*51<<8|(pf<<0)%6*51;var pP=pA.toColor(p$);this._colors.push(pP);var pS=pg*this._gridSize,pB=pf*this._gridSize;ph.drawRect(pS,pB,this._gridSize,this._gridSize,pP,"#000000")}},pf.onColorButtonClick=function(ph){this._colorPanel.parent?this.close():this.open()},pf.open=function(){var ph=this.localToGlobal(new pL),pq=ph.x+this._colorPanel.width<=pe.stage.width?ph.x:pe.stage.width-this._colorPanel.width,pf=ph.y+this._colorButton.height;pf=pf+this._colorPanel.height<=pe.stage.height?pf:ph.y-this._colorPanel.height,this._colorPanel.pos(pq,pf),this._colorPanel.zOrder=1001,pe._currentStage.addChild(this._colorPanel),pe.stage.on("mousedown",this,this.removeColorBox)},pf.close=function(){pe.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},pf.removeColorBox=function(ph){this.close()},pf.onColorFieldKeyDown=function(ph){13==ph.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),ph.stopPropagation())},pf.onColorInputChange=function(ph){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},pf.onColorTilesClick=function(ph){this.selectedColor=this.getColorByMouse(),this.close()},pf.onColorTilesMouseMove=function(ph){this._colorInput.focus=!1;var pq=this.getColorByMouse();this._colorInput.text=pq,this.drawBlock(pq)},pf.getColorByMouse=function(){var ph=this._colorTiles.getMousePoint(),pq=Math.floor(ph.x/this._gridSize),pf=Math.floor(ph.y/this._gridSize);return this._colors[20*pf+pq]},pf.drawBlock=function(ph){var pq=this._colorBlock.graphics;pq.clear();var pf=ph||"#ffffff";pq.drawRect(0,0,50,20,pf,this._borderColor),ph||pq.drawLine(0,0,50,20,"#ff0000")},pf.changeColor=function(){var ph=this.graphics;ph.clear();var pq=this._selectedColor||"#000000";ph.drawRect(0,0,this._colorButton.width,this._colorButton.height,pq)},pf._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},p$(0,pf,"inputBgColor",function(){return this._inputBgColor},function(ph){this._inputBgColor=ph,this._setPanelChanged()}),p$(0,pf,"selectedColor",function(){return this._selectedColor},function(ph){this._selectedColor!=ph&&(this._selectedColor=this._colorInput.text=ph,this.drawBlock(ph),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",pr.EMPTY.setTo("change",this,this)))}),p$(0,pf,"skin",function(){return this._colorButton.skin},function(ph){this._colorButton.skin=ph,this.changeColor()}),p$(0,pf,"bgColor",function(){return this._bgColor},function(ph){this._bgColor=ph,this._setPanelChanged()}),p$(0,pf,"borderColor",function(){return this._borderColor},function(ph){this._borderColor=ph,this._setPanelChanged()}),p$(0,pf,"inputColor",function(){return this._inputColor},function(ph){this._inputColor=ph,this._setPanelChanged()}),ph}(pi),pI=function(pq){function pf(ph,pq){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,pf.__super.call(this),this._itemColors=pp.comboBoxItemColors,this.skin=ph,this.labels=pq}pP(pf,"laya.ui.ComboBox",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._button&&this._button.destroy(ph),this._list&&this._list.destroy(ph),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},ph.createChildren=function(){this.addChild(this._button=new pM),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},ph._createList=function(){this._list=new pZ,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},ph._setListEvent=function(ph){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=pu.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},ph.onListDown=function(ph){ph.stopPropagation()},ph.onScrollBarDown=function(ph){ph.stopPropagation()},ph.onButtonMouseDown=function(ph){this.callLater(this.switchTo,[!this._isOpen])},ph.changeList=function(){this._listChanged=!1;var ph=this.width-2,pq=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:ph,height:this._itemHeight,fontSize:this._itemSize,color:pq}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},ph.onlistItemMouse=function(ph,pq){var pf=ph.type;if("mouseover"===pf||"mouseout"===pf){if(this._isCustomList)return;var pg=this._list.getCell(pq);if(!pg)return;var p$=pg.getChildByName("label");p$&&("mouseover"===pf?(p$.bgColor=this._itemColors[0],p$.color=this._itemColors[1]):(p$.bgColor=null,p$.color=this._itemColors[2]))}else"click"===pf&&(this.selectedIndex=pq,this.isOpen=!1)},ph.switchTo=function(ph){this.isOpen=ph},ph.changeOpen=function(){this.isOpen=!this._isOpen},ph.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var ph=this._list.graphics;ph.clear(),ph.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var pq=this._list.array||[],pf=pq.length=0,pg=this._labels.length;pf<pg;pf++)pq.push({label:this._labels[pf]});this._list.height=this._listHeight,this._list.array=pq},ph.changeSelected=function(){this._button.label=this.selectedLabel},ph._onStageMouseWheel=function(ph){this._list&&!this._list.contains(ph.target)&&this.removeList(null)},ph.removeList=function(ph){pe.stage.off("mousedown",this,this.removeList),pe.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},p$(0,ph,"selectedIndex",function(){return this._selectedIndex},function(ph){this._selectedIndex!=ph&&(this._selectedIndex=ph,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[pr.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),p$(0,ph,"measureHeight",function(){return this._button.height}),p$(0,ph,"skin",function(){return this._button.skin},function(ph){this._button.skin!=ph&&(this._button.skin=ph,this._listChanged=!0)}),p$(0,ph,"measureWidth",function(){return this._button.width}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pi,this,"width",ph),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),p$(0,ph,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(ph){this.selectedIndex=this._labels.indexOf(ph)}),p$(0,ph,"labels",function(){return this._labels.join(",")},function(ph){0<this._labels.length&&(this.selectedIndex=-1),ph?this._labels=ph.split(","):this._labels.length=0,this._itemChanged=!0}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pi,this,"height",ph),this._button.height=this._height}),p$(0,ph,"selectHandler",function(){return this._selectHandler},function(ph){this._selectHandler=ph}),p$(0,ph,"visibleNum",function(){return this._visibleNum},function(ph){this._visibleNum=ph,this._listChanged=!0}),p$(0,ph,"labelBold",function(){return this._button.text.bold},function(ph){this._button.text.bold=ph}),p$(0,ph,"itemColors",function(){return String(this._itemColors)},function(ph){this._itemColors=pA.fillArray(this._itemColors,ph,String),this._listChanged=!0}),p$(0,ph,"itemSize",function(){return this._itemSize},function(ph){this._itemSize=ph,this._listChanged=!0}),p$(0,ph,"scrollBar",function(){return this.list.scrollBar}),p$(0,ph,"isOpen",function(){return this._isOpen},function(ph){if(this._isOpen!=ph)if(this._isOpen=ph,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var pq=this.localToGlobal(pL.TEMP.setTo(0,0)),pf=pq.y+this._button.height;pf=pf+this._listHeight<=pe.stage.height?pf:pq.y-this._listHeight,this._list.pos(pq.x,pf),this._list.zOrder=1001,pe._currentStage.addChild(this._list),pe.stage.once("mousedown",this,this.removeList),pe.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),p$(0,ph,"scrollBarSkin",function(){return this._scrollBarSkin},function(ph){this._scrollBarSkin=ph}),p$(0,ph,"sizeGrid",function(){return this._button.sizeGrid},function(ph){this._button.sizeGrid=ph}),p$(0,ph,"button",function(){return this._button}),p$(0,ph,"list",function(){return this._list||this._createList(),this._list},function(ph){ph&&(ph.removeSelf(),this._isCustomList=!0,this._list=ph,this._setListEvent(ph),this._itemHeight=ph.getCell(0).height+ph.spaceY)}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)&&Math.floor(ph)==ph||"string"==typeof ph?this.selectedIndex=parseInt(ph):ph instanceof Array?this.labels=ph.join(","):pe.superSet(pi,this,"dataSource",ph)}),p$(0,ph,"labelColors",function(){return this._button.labelColors},function(ph){this._button.labelColors!=ph&&(this._button.labelColors=ph)}),p$(0,ph,"labelPadding",function(){return this._button.text.padding.join(",")},function(ph){this._button.text.padding=pA.fillArray(pp.labelPadding,ph,Number)}),p$(0,ph,"labelSize",function(){return this._button.text.fontSize},function(ph){this._button.text.fontSize=ph}),p$(0,ph,"labelFont",function(){return this._button.text.font},function(ph){this._button.text.font=ph}),p$(0,ph,"stateNum",function(){return this._button.stateNum},function(ph){this._button.stateNum=ph}),pf}(pi),pw=function(pq){function pf(ph){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,pf.__super.call(this),this._showButtons=pd.showButtons,this._touchScrollEnable=pd.touchScrollEnable,this._mouseWheelEnable=pd.mouseWheelEnable,this.skin=ph,this.max=1}pP(pf,"laya.ui.ScrollBar",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),this.stopScroll(),this.target=null,pq.prototype.destroy.call(this,ph),this.upButton&&this.upButton.destroy(ph),this.downButton&&this.downButton.destroy(ph),this.slider&&this.slider.destroy(ph),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},ph.createChildren=function(){this.addChild(this.slider=new pk),this.addChild(this.upButton=new pM),this.addChild(this.downButton=new pM)},ph.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},ph.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},ph.onButtonMouseDown=function(ph){var pq=ph.currentTarget===this.upButton;this.slide(pq),pe.timer.once(pp.scrollBarDelayTime,this,this.startLoop,[pq]),pe.stage.once("mouseup",this,this.onStageMouseUp)},ph.startLoop=function(ph){pe.timer.frameLoop(1,this,this.slide,[ph])},ph.slide=function(ph){ph?this.value-=this._scrollSize:this.value+=this._scrollSize},ph.onStageMouseUp=function(ph){pe.timer.clear(this,this.startLoop),pe.timer.clear(this,this.slide)},ph.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},ph.changeSize=function(){pq.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},ph.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},ph.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},ph.setScroll=function(ph,pq,pf){this.runCallLater(this.changeSize),this.slider.setSlider(ph,pq,pf),this.slider.bar.visible=0<pq,!this._hide&&this.autoHide&&(this.visible=!1)},ph.onTargetMouseWheel=function(ph){this.value-=ph.delta*this._scrollSize,this.target=this._target},ph.onTargetMouseDown=function(ph){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new pL),this._lastPoint.setTo(pe.stage.mouseX,pe.stage.mouseY),pe.timer.clear(this,this.tweenMove),pt.clearTween(this),pe.stage.once("mouseup",this,this.onStageMouseUp2),pe.stage.once("mouseout",this,this.onStageMouseUp2),pe.timer.frameLoop(1,this,this.loop)},ph.loop=function(){var ph=pe.stage.mouseY,pq=pe.stage.mouseX;if(this._lastOffset=this.isVertical?ph-this._lastPoint.y:pq-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?pe.stage._canvasTransform.getScaleY():pe.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=pq,this._lastPoint.y=ph,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},ph.onStageMouseUp2=function(ph){if(pe.stage.off("mouseup",this,this.onStageMouseUp2),pe.stage.off("mouseout",this,this.onStageMouseUp2),pe.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?pt.to(this,{value:this.min},this.elasticBackTime,pB.sineOut,pu.create(this,this.elasticOver)):this._value>this.max&&pt.to(this,{value:this.max},this.elasticBackTime,pB.sineOut,pu.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?pe.stage.mouseY-this._lastPoint.y:pe.stage.mouseX-this._lastPoint.x);for(var pq=0,pf=Math.min(this._offsets.length,3),pg=0;pg<pf;pg++)pq+=this._offsets[this._offsets.length-1-pg];if(this._lastOffset=pq/pf,(pq=Math.abs(this._lastOffset))<2)return void this.event("end");60<pq&&(this._lastOffset=0<this._lastOffset?60:-60);var p$=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));pe.timer.frameLoop(1,this,this.tweenMove,[p$])}},ph.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&pt.to(this,{alpha:0},500),this.event("end")},ph.tweenMove=function(ph){this._lastOffset*=this.rollRatio;var pq=NaN;if(0<ph&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,pq=.5*-(this.min-ph-this.value),this._lastOffset>pq&&(this._lastOffset=pq)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,pq=.5*-(this.max+ph-this.value),this._lastOffset<pq&&(this._lastOffset=pq))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(pe.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?pt.to(this,{value:this.min},this.elasticBackTime,pB.sineOut,pu.create(this,this.elasticOver)):this._value>this.max?pt.to(this,{value:this.max},this.elasticBackTime,pB.sineOut,pu.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&pt.to(this,{alpha:0},500)}},ph.stopScroll=function(){this.onStageMouseUp2(null),pe.timer.clear(this,this.tweenMove),pt.clearTween(this)},p$(0,ph,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),p$(0,ph,"skin",function(){return this._skin},function(ph){this._skin!=ph&&(this._skin=ph,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),p$(0,ph,"max",function(){return this.slider.max},function(ph){this.slider.max=ph}),p$(0,ph,"showButtons",function(){return this._showButtons},function(ph){this._showButtons=ph,this.callLater(this.changeScrollBar)}),p$(0,ph,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),p$(0,ph,"min",function(){return this.slider.min},function(ph){this.slider.min=ph}),p$(0,ph,"value",function(){return this._value},function(ph){ph!==this._value&&(this._value=ph,this._isElastic||(this.slider._value!=ph&&(this.slider._value=ph,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),p$(0,ph,"isVertical",function(){return this.slider.isVertical},function(ph){this.slider.isVertical=ph}),p$(0,ph,"sizeGrid",function(){return this.slider.sizeGrid},function(ph){this.slider.sizeGrid=ph}),p$(0,ph,"scrollSize",function(){return this._scrollSize},function(ph){this._scrollSize=ph}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)||"string"==typeof ph?this.value=Number(ph):pe.superSet(pi,this,"dataSource",ph)}),p$(0,ph,"thumbPercent",function(){return this._thumbPercent},function(ph){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),ph=1<=ph?.99:ph,this._thumbPercent=ph,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*ph,pp.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*ph,pp.scrollBarMinNum))}),p$(0,ph,"target",function(){return this._target},function(ph){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=ph)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),p$(0,ph,"hide",function(){return this._hide},function(ph){this._hide=ph,this.visible=!ph}),p$(0,ph,"touchScrollEnable",function(){return this._touchScrollEnable},function(ph){this._touchScrollEnable=ph,this.target=this._target}),p$(0,ph,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(ph){this._mouseWheelEnable=ph,this.target=this._target}),p$(0,ph,"tick",function(){return this.slider.tick},function(ph){this.slider.tick=ph}),pf}(pi),pk=function(pq){function pf(ph){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,pf.__super.call(this),this.skin=ph}pP(pf,"laya.ui.Slider",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._bg&&this._bg.destroy(ph),this._bar&&this._bar.destroy(ph),this._progress&&this._progress.destroy(ph),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},ph.createChildren=function(){this.addChild(this._bg=new pH),this.addChild(this._bar=new pM)},ph.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},ph.onBarMouseDown=function(ph){this._globalSacle||(this._globalSacle=new pL),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=pe.stage.mouseX,this._ty=pe.stage.mouseY,pe.stage.on("mousemove",this,this.mouseMove),pe.stage.once("mouseup",this,this.mouseUp),pe.stage.once("mouseout",this,this.mouseUp),this.showValueText()},ph.showValueText=function(){if(this.showLabel){var ph=laya.ui.Slider.label;this.addChild(ph),ph.textField.changeText(this._value+""),this.isVertical?(ph.x=this._bar.x+20,ph.y=.5*(this._bar.height-ph.height)+this._bar.y):(ph.y=this._bar.y-20,ph.x=.5*(this._bar.width-ph.width)+this._bar.x)}},ph.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},ph.mouseUp=function(ph){pe.stage.off("mousemove",this,this.mouseMove),pe.stage.off("mouseup",this,this.mouseUp),pe.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},ph.mouseMove=function(ph){var pq=this._value;this.isVertical?(this._bar.y+=(pe.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(pe.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=pe.stage.mouseX,this._ty=pe.stage.mouseY;var pf=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*pf)/pf,this._value!=pq&&this.sendChangeEvent(),this.showValueText()},ph.sendChangeEvent=function(ph){void 0===ph&&(ph="change"),this.event(ph),this.changeHandler&&this.changeHandler.runWith(this._value)},ph.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},ph.changeSize=function(){pq.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},ph.setSlider=function(ph,pq,pf){this._value=-1,this._min=ph,this._max=ph<pq?pq:ph,this.value=pf<ph?ph:pq<pf?pq:pf},ph.changeValue=function(){var ph=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*ph)/ph,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var pq=this._max-this._min;0===pq&&(pq=1),this.isVertical?(this._bar.y=(this._value-this._min)/pq*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/pq*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},ph.onBgMouseDown=function(ph){var pq=this._bg.getMousePoint();this.isVertical?this.value=pq.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=pq.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},p$(0,ph,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),p$(0,ph,"skin",function(){return this._skin},function(ph){if(this._skin!=ph){this._skin=ph,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var pq=this._skin.replace(".png","$progress.png");pN.getRes(pq)&&(this._progress||(this.addChild(this._progress=new pH),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=pq),this.setBarPoint(),this.callLater(this.changeValue)}}),p$(0,ph,"allowClickBack",function(){return this._allowClickBack},function(ph){this._allowClickBack!=ph&&((this._allowClickBack=ph)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),p$(0,ph,"max",function(){return this._max},function(ph){this._max!=ph&&(this._max=ph,this.callLater(this.changeValue))}),p$(0,ph,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),p$(0,ph,"tick",function(){return this._tick},function(ph){this._tick!=ph&&(this._tick=ph,this.callLater(this.changeValue))}),p$(0,ph,"sizeGrid",function(){return this._bg.sizeGrid},function(ph){this._bg.sizeGrid=ph,this._bar.sizeGrid=ph,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),p$(0,ph,"min",function(){return this._min},function(ph){this._min!=ph&&(this._min=ph,this.callLater(this.changeValue))}),p$(0,ph,"value",function(){return this._value},function(ph){if(this._value!=ph){var pq=this._value;this._value=ph,this.changeValue(),this._value!=pq&&this.sendChangeEvent()}}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)||"string"==typeof ph?this.value=Number(ph):pe.superSet(pi,this,"dataSource",ph)}),p$(0,ph,"bar",function(){return this._bar}),pg(pf,["label",function(){return this.label=new pD}]),pf}(pi),pH=function(pq){function pf(ph){this._bitmap=null,this._skin=null,this._group=null,pf.__super.call(this),this.skin=ph}pP(pf,"laya.ui.Image",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,pN.clearCache(this,this._skin)},ph.dispose=function(){this.destroy(!0),pN.clearCache(this,this._skin)},ph.createChildren=function(){this.graphics=this._bitmap=new pb},ph.setSource=function(ph,pq){ph===this._skin&&pq&&(this.source=pq,this.onCompResize())},p$(0,ph,"source",function(){return this._bitmap.source},function(ph){this._bitmap&&(this._bitmap.source=ph,this.event("loaded"),this.repaint())}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"string"==typeof(this._dataSource=ph)?this.skin=ph:pe.superSet(pi,this,"dataSource",ph)}),p$(0,ph,"measureHeight",function(){return this._bitmap.height}),p$(0,ph,"skin",function(){return this._skin},function(ph){if(this._skin!=ph)if(pN.clearCache(this,this._skin),this._skin=ph){pN.keepCache(this,this._skin);var pq=pN.getRes(ph);pq?(this.source=pq,this.onCompResize()):pe.loader.load(this._skin,pu.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),p$(0,ph,"group",function(){return this._group},function(ph){ph&&this._skin&&pN.setGroup(this._skin,ph),this._group=ph}),p$(0,ph,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(ph){this._bitmap.sizeGrid=pA.fillArray(pp.defaultSizeGrid,ph,Number)}),p$(0,ph,"measureWidth",function(){return this._bitmap.width}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pi,this,"width",ph),this._bitmap.width=0==ph?1e-7:ph}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pi,this,"height",ph),this._bitmap.height=0==ph?1e-7:ph}),pf}(pi),pD=function(pq){function pf(ph){this._tf=null,pf.__super.call(this),void 0===ph&&(ph=""),pY.defaultColor=pp.labelColor,this.text=ph}pP(pf,"laya.ui.Label",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._tf=null},ph.createChildren=function(){this.addChild(this._tf=new pE)},ph.changeText=function(ph){this._tf.changeText(ph)},p$(0,ph,"padding",function(){return this._tf.padding.join(",")},function(ph){this._tf.padding=pA.fillArray(pp.labelPadding,ph,Number)}),p$(0,ph,"bold",function(){return this._tf.bold},function(ph){this._tf.bold=ph}),p$(0,ph,"align",function(){return this._tf.align},function(ph){this._tf.align=ph}),p$(0,ph,"text",function(){return this._tf.text},function(ph){this._tf.text!=ph&&(ph&&(ph=pA.adptString(ph+"")),this._tf.text=ph,this.event("change"),this._width&&this._height||this.onCompResize())}),p$(0,ph,"italic",function(){return this._tf.italic},function(ph){this._tf.italic=ph}),p$(0,ph,"wordWrap",function(){return this._tf.wordWrap},function(ph){this._tf.wordWrap=ph}),p$(0,ph,"font",function(){return this._tf.font},function(ph){this._tf.font=ph}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)||"string"==typeof ph?this.text=ph+"":pe.superSet(pi,this,"dataSource",ph)}),p$(0,ph,"color",function(){return this._tf.color},function(ph){this._tf.color=ph}),p$(0,ph,"valign",function(){return this._tf.valign},function(ph){this._tf.valign=ph}),p$(0,ph,"leading",function(){return this._tf.leading},function(ph){this._tf.leading=ph}),p$(0,ph,"fontSize",function(){return this._tf.fontSize},function(ph){this._tf.fontSize=ph}),p$(0,ph,"bgColor",function(){return this._tf.bgColor},function(ph){this._tf.bgColor=ph}),p$(0,ph,"borderColor",function(){return this._tf.borderColor},function(ph){this._tf.borderColor=ph}),p$(0,ph,"stroke",function(){return this._tf.stroke},function(ph){this._tf.stroke=ph}),p$(0,ph,"strokeColor",function(){return this._tf.strokeColor},function(ph){this._tf.strokeColor=ph}),p$(0,ph,"textField",function(){return this._tf}),p$(0,ph,"measureWidth",function(){return this._tf.width}),p$(0,ph,"measureHeight",function(){return this._tf.height}),p$(0,ph,"width",function(){return this._width||this._tf.text?pe.superGet(pi,this,"width"):0},function(ph){pe.superSet(pi,this,"width",ph),this._tf.width=ph}),p$(0,ph,"height",function(){return this._height||this._tf.text?pe.superGet(pi,this,"height"):0},function(ph){pe.superSet(pi,this,"height",ph),this._tf.height=ph}),p$(0,ph,"overflow",function(){return this._tf.overflow},function(ph){this._tf.overflow=ph}),p$(0,ph,"underline",function(){return this._tf.underline},function(ph){this._tf.underline=ph}),p$(0,ph,"underlineColor",function(){return this._tf.underlineColor},function(ph){this._tf.underlineColor=ph}),pf}(pi),ps=function(pq){function pf(ph){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,pf.__super.call(this),this.skin=ph}pP(pf,"laya.ui.ProgressBar",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._bg&&this._bg.destroy(ph),this._bar&&this._bar.destroy(ph),this._bg=this._bar=null,this.changeHandler=null},ph.createChildren=function(){this.addChild(this._bg=new pH),this.addChild(this._bar=new pH)},ph.changeValue=function(){if(this.sizeGrid){var ph=this.sizeGrid.split(","),pq=Number(ph[3]),pf=Number(ph[1]),pg=(this.width-pq-pf)*this._value;this._bar.width=pq+pf+pg,this._bar.visible=this._bar.width>pq+pf}else this._bar.width=this.width*this._value},p$(0,ph,"measureHeight",function(){return this._bg.height}),p$(0,ph,"skin",function(){return this._skin},function(ph){this._skin!=ph&&(this._skin=ph,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),p$(0,ph,"measureWidth",function(){return this._bg.width}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pi,this,"height",ph),this._bg.height=this._height,this._bar.height=this._height}),p$(0,ph,"bar",function(){return this._bar}),p$(0,ph,"value",function(){return this._value},function(ph){this._value!=ph&&(ph=1<ph?1:ph<0?0:ph,this._value=ph,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(ph))}),p$(0,ph,"bg",function(){return this._bg}),p$(0,ph,"sizeGrid",function(){return this._bg.sizeGrid},function(ph){this._bg.sizeGrid=this._bar.sizeGrid=ph}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pi,this,"width",ph),this._bg.width=this._width,this.callLater(this.changeValue)}),p$(0,ph,"dataSource",pq.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)||"string"==typeof ph?this.value=Number(ph):pe.superSet(pi,this,"dataSource",ph)}),pf}(pi),pV=(function(ph){function pf(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,pf.__super.call(this),this._tipBox=new pi,this._tipBox.addChild(this._tipText=new pE),this._tipText.x=this._tipText.y=5,this._tipText.color=pf.tipTextColor,this._defaultTipHandler=this._showDefaultTip,pe.stage.on("showtip",this,this._onStageShowTip),pe.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}pP(pf,"laya.ui.TipManager",pi);var pq=pf.prototype;pq._onStageHideTip=function(ph){pe.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},pq._onStageShowTip=function(ph){pe.timer.once(pf.tipDelay,this,this._showTip,[ph],!0)},pq._showTip=function(ph){if("string"==typeof ph){var pq=String(ph);Boolean(pq)&&this._defaultTipHandler(pq)}else ph instanceof laya.utils.Handler?ph.run():"function"==typeof ph&&ph.apply();pe.stage.on("mousemove",this,this._onStageMouseMove),pe.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},pq._onStageMouseDown=function(ph){this.closeAll()},pq._onStageMouseMove=function(ph){this._showToStage(this,pf.offsetX,pf.offsetY)},pq._showToStage=function(ph,pq,pf){void 0===pq&&(pq=0),void 0===pf&&(pf=0);var pg=ph.getBounds();ph.x=pe.stage.mouseX+pq,ph.y=pe.stage.mouseY+pf,ph.x+pg.width>pe.stage.width&&(ph.x-=pg.width+pq),ph.y+pg.height>pe.stage.height&&(ph.y-=pg.height+pf)},pq.closeAll=function(){pe.timer.clear(this,this._showTip),pe.stage.off("mousemove",this,this._onStageMouseMove),pe.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},pq.showDislayTip=function(ph){this.addChild(ph),this._showToStage(this),pe._currentStage.addChild(this)},pq._showDefaultTip=function(ph){this._tipText.text=ph;var pq=this._tipBox.graphics;pq.clear(),pq.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,pf.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),pe._currentStage.addChild(this)},p$(0,pq,"defaultTipHandler",function(){return this._defaultTipHandler},function(ph){this._defaultTipHandler=ph}),pf.offsetX=10,pf.offsetY=15,pf.tipTextColor="#ffffff",pf.tipBackColor="#111111",pf.tipDelay=200}(),function(ph){var pv;function pL(){this._idMap=null,this._aniList=null,this._watchMap={},pL.__super.call(this)}pP(pL,"laya.ui.View",pc);var pq=pL.prototype;return pq.createView=function(ph){if(ph.animations&&!this._idMap&&(this._idMap={}),pL.createComp(ph,this,this),ph.animations){var pq,pf,pg=[],p$=ph.animations,pP=0,pS=p$.length;for(pP=0;pP<pS;pP++){switch(pq=new pC,pf=p$[pP],pq._setUp(this._idMap,pf),(this[pf.name]=pq)._setControlNode(this),pf.action){case 1:pq.play(0,!1);break;case 2:pq.play(0,!0)}pg.push(pq)}this._aniList=pg}0<this._width&&null==ph.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},pq.onEvent=function(ph,pq){},pq.loadUI=function(ph){var pq=pL.uiMap[ph];pq&&this.createView(pq)},pq.destroy=function(ph){void 0===ph&&(ph=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,ph)},pq.changeData=function(ph){var pq=this._watchMap[ph];if(pq){console.log("change",ph);for(var pf=0,pg=pq.length;pf<pg;pf++){pq[pf].exe(this)}}},pL._regs=function(){for(var ph in pL.uiClassMap)pl.regClass(ph,pL.uiClassMap[ph])},pL.createComp=function(ph,pq,pf,pg){if(!(pq=pq||pL.getCompInstance(ph)))return console.warn("can not create:"+ph.type),null;var p$=ph.child;if(p$)for(var pP=pq instanceof laya.ui.List,pS=0,pB=p$.length;pS<pB;pS++){var pr=p$[pS];if(!pq.hasOwnProperty("itemRender")||"render"!=pr.props.name&&"render"!==pr.props.renderType)if("Graphic"==pr.type)pl.addGraphicsToSprite(pr,pq);else if(pl.isDrawType(pr.type))pl.addGraphicToSprite(pr,pq,!0);else{if(pP){var pY=[],pC=pL.createComp(pr,null,pf,pY);pY.length&&(pC._$bindData=pY)}else pC=pL.createComp(pr,null,pf,pg);"Script"==pr.type?"owner"in pC?pC.owner=pq:"target"in pC&&(pC.target=pq):"mask"==pr.props.renderType||"mask"==pr.props.name?pq.mask=pC:pC instanceof laya.display.Sprite&&pq.addChild(pC)}else pq.itemRender=pr}var pU=ph.props;for(var pu in pU){var pv=pU[pu];pL.eventDic[pu]?pv&&pf&&pq.on(pu,pf,pf.onEvent,[pv]):pL.setCompValue(pq,pu,pv,pf,pg)}return pe.__typeof(pq,"laya.ui.IItem")&&pq.initItems(),ph.compId&&pf&&pf._idMap&&(pf._idMap[ph.compId]=pq),pq},pL.setCompValue=function(ph,pq,pf,pg,p$){if("string"==typeof pf&&-1<pf.indexOf("${")){if(pL._sheet||(pL._sheet=pl.getClass("laya.data.Table")),!pL._sheet)return void console.warn("Can not find class Sheet");if(p$)p$.push(ph,pq,pf);else if(pg){-1==pf.indexOf("].")&&(pf=pf.replace(".","[0]."));var pP,pS,pB=new pv(ph,pq,pf);pB.exe(pg);for(var pr=pf.replace(/\[.*?\]\./g,".");null!=(pP=pL._parseWatchData.exec(pr));){for(var pY=pP[1];null!=(pS=pL._parseKeyWord.exec(pY));){var pC=pS[0],pU=pg._watchMap[pC]||(pg._watchMap[pC]=[]);pU.push(pB),pL._sheet.I.notifer.on(pC,pg,pg.changeData,[pC])}(pU=pg._watchMap[pY]||(pg._watchMap[pY]=[])).push(pB),pL._sheet.I.notifer.on(pY,pg,pg.changeData,[pY])}}}else if("var"===pq&&pg)pg[pf]=ph;else if("onClick"==pq){var pu=pe._runScript("(function(){"+pf+"})");ph.on("click",pg,pu)}else ph[pq]="true"===pf||"false"!==pf&&pf},pL.getCompInstance=function(ph){var pq,pf=ph.props?ph.props.runtime:null;return pq=pf?pL.viewClassMap[pf]||pL.uiClassMap[pf]||pe.__classmap[pf]:pL.uiClassMap[ph.type],ph.props&&ph.props.hasOwnProperty("renderType")&&"instance"==ph.props.renderType?pq.instance:pq?new pq:null},pL.regComponent=function(ph,pq){pL.uiClassMap[ph]=pq,pl.regClass(ph,pq)},pL.regViewRuntime=function(ph,pq){pL.viewClassMap[ph]=pq},pL.uiMap={},pL.viewClassMap={},pL._sheet=null,pg(pL,["uiClassMap",function(){return this.uiClassMap={ViewStack:phh,LinkButton:pM,TextArea:pYh,ColorPicker:pT,Box:pc,Button:pM,CheckBox:pK,Clip:pW,ComboBox:pI,Component:pi,HScrollBar:pQ,HSlider:pO,Image:pH,Label:pD,List:pZ,Panel:po,ProgressBar:ps,Radio:px,RadioGroup:pBh,ScrollBar:pw,Slider:pk,Tab:prh,TextInput:pfh,View:pL,VScrollBar:pqh,VSlider:pgh,Tree:pa,HBox:pPh,VBox:pSh,Sprite:pm,Animation:pf,Text:pE,FontClip:pF}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),pL.__init$=function(){pL._regs(),pv=function(){function ph(ph,pq,pf){this.comp=null,this.prop=null,this.value=null,this.comp=ph,this.prop=pq,this.value=pf}return pP(ph,""),ph.prototype.exe=function(ph){var pq=pA.getBindFun(this.value);this.comp[this.prop]=pq.call(this,ph)},ph}()},pL}()),pK=function(ph){function pf(ph,pq){void 0===pq&&(pq=""),pf.__super.call(this,ph,pq)}pP(pf,"laya.ui.CheckBox",ph);var pq=pf.prototype;return pq.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},pq.initialize=function(){ph.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},p$(0,pq,"dataSource",ph.prototype._$get_dataSource,function(ph){"boolean"==typeof(this._dataSource=ph)?this.selected=ph:"string"==typeof ph?this.selected="true"===ph:pe.superSet(pM,this,"dataSource",ph)}),pf}(pM),py=function(ph){function pq(){this._space=0,this._align="none",this._itemChanged=!1,pq.__super.call(this)}pP(pq,"laya.ui.LayoutBox",pc);var pf=pq.prototype;return pf.addChild=function(ph){return ph.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,ph)},pf.onResize=function(ph){this._setItemChanged()},pf.addChildAt=function(ph,pq){return ph.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,ph,pq)},pf.removeChild=function(ph){return ph.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,ph)},pf.removeChildAt=function(ph){return this.getChildAt(ph).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,ph)},pf.refresh=function(){this._setItemChanged()},pf.changeItems=function(){this._itemChanged=!1},pf.sortItem=function(ph){ph&&ph.sort(function(ph,pq){return ph.y-pq.y})},pf._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},p$(0,pf,"space",function(){return this._space},function(ph){this._space=ph,this._setItemChanged()}),p$(0,pf,"align",function(){return this._align},function(ph){this._align=ph,this._setItemChanged()}),pq}(),pF=function(pq){function pf(ph,pq){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,pf.__super.call(this),ph&&(this.skin=ph),pq&&(this.sheet=pq)}pP(pf,"laya.ui.FontClip",pq);var ph=pf.prototype;return ph.createChildren=function(){this._bitmap=new pb,this.on("loaded",this,this._onClipLoaded)},ph._onClipLoaded=function(){this.callLater(this.changeValue)},ph.changeValue=function(){var ph;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),ph=this._sources[0]))){var pq="horizontal"===this._direction;pq?(this._wordsW=this._valueArr.length*(ph.sourceWidth+this.spaceX),this._wordsH=ph.sourceHeight):(this._wordsW=ph.sourceWidth,this._wordsH=(ph.sourceHeight+this.spaceY)*this._valueArr.length);var pf=0;if(this._width)switch(this._align){case"center":pf=.5*(this._width-this._wordsW);break;case"right":pf=this._width-this._wordsW;break;default:pf=0}for(var pg=0,p$=this._valueArr.length;pg<p$;pg++){var pP=this._indexMap[this._valueArr.charAt(pg)];this.sources[pP]&&(ph=this.sources[pP],pq?this.graphics.drawTexture(ph,pf+pg*(ph.sourceWidth+this.spaceX),0,ph.sourceWidth,ph.sourceHeight):this.graphics.drawTexture(ph,0+pf,pg*(ph.sourceHeight+this.spaceY),ph.sourceWidth,ph.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},ph.destroy=function(ph){void 0===ph&&(ph=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),pq.prototype.destroy.call(this,ph)},p$(0,ph,"sheet",function(){return this._sheet},function(ph){ph+="";var pq=(this._sheet=ph).split(" ");this._clipX=String(pq[0]).length,this.clipY=pq.length,this._indexMap={};for(var pf=0;pf<this._clipY;pf++)for(var pg=pq[pf].split(""),p$=0,pP=pg.length;p$<pP;p$++)this._indexMap[pg[p$]]=pf*this._clipX+p$}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pW,this,"height",ph),this.callLater(this.changeValue)}),p$(0,ph,"direction",function(){return this._direction},function(ph){this._direction=ph,this.callLater(this.changeValue)}),p$(0,ph,"value",function(){return this._valueArr?this._valueArr:""},function(ph){ph+="",this._valueArr=ph,this.callLater(this.changeValue)}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pW,this,"width",ph),this.callLater(this.changeValue)}),p$(0,ph,"spaceX",function(){return this._spaceX},function(ph){this._spaceX=ph,"horizontal"===this._direction&&this.callLater(this.changeValue)}),p$(0,ph,"spaceY",function(){return this._spaceY},function(ph){this._spaceY=ph,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),p$(0,ph,"align",function(){return this._align},function(ph){this._align=ph,this.callLater(this.changeValue)}),p$(0,ph,"measureWidth",function(){return this._wordsW}),p$(0,ph,"measureHeight",function(){return this._wordsH}),pf}(pW),pZ=function(ph){function pq(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new pL,pq.__super.call(this)}pP(pq,"laya.ui.List",ph);var pf=pq.prototype;return pe.imps(pf,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),pf.destroy=function(ph){void 0===ph&&(ph=!0),this._content&&this._content.destroy(ph),this._scrollBar&&this._scrollBar.destroy(ph),laya.ui.Component.prototype.destroy.call(this,ph),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},pf.createChildren=function(){this.addChild(this._content=new pc)},pf.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=pe.superGet(pc,this,"cacheAs")),pe.superSet(pc,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},pf.onScrollEnd=function(){pe.superSet(pc,this,"cacheAs",this._$P.cacheAs)},pf._removePreScrollBar=function(){var ph=this.removeChildByName("scrollBar");ph&&ph.destroy(!0)},pf.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var ph=this._getOneCell(),pq=ph.width+this._spaceX||1,pf=ph.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/pq):Math.ceil(this._width/pq)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/pf):Math.round(this._height/pf));var pg=this._width?this._width:pq*this.repeatX-this._spaceX,p$=this._height?this._height:pf*this.repeatY-this._spaceY;this._cellSize=this._isVertical?pf:pq,this._cellOffset=this._isVertical?pf*Math.max(this._repeatY2,this._repeatY)-p$-this._spaceY:pq*Math.max(this._repeatX2,this._repeatX)-pg-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=p$:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=pg),this.setContentSize(pg,p$);var pP=this._isVertical?this.repeatX:this.repeatY,pS=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,pP,pS),this._createdLine=pS,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},pf._getOneCell=function(){if(0===this._cells.length){var ph=this.createItem();if(this._offset.setTo(ph.x,ph.y),this.cacheContent)return ph;this._cells.push(ph)}return this._cells[0]},pf._createItems=function(ph,pq,pf){var pg=this._content,p$=this._getOneCell(),pP=p$.width+this._spaceX,pS=p$.height+this._spaceY;if(this.cacheContent){var pB=new pc;pB.cacheAsBitmap=!0,pB.pos((this._isVertical?0:ph)*pP,(this._isVertical?ph:0)*pS),this._content.addChild(pB),this._content.optimizeScrollRect=!0,pg=pB}else{for(var pr=[],pY=this._cells.length-1;-1<pY;pY--){var pC=this._cells[pY];pC.removeSelf(),pr.push(pC)}this._cells.length=0}for(var pU=ph;pU<pf;pU++)for(var pu=0;pu<pq;pu++)(p$=pr&&pr.length?pr.pop():this.createItem()).x=(this._isVertical?pu:pU)*pP-pg.x,p$.y=(this._isVertical?pU:pu)*pS-pg.y,p$.name="item"+(pU*pq+pu),pg.addChild(p$),this.addCell(p$)},pf.createItem=function(){var ph=[];if("function"==typeof this._itemRender)var pq=new this._itemRender;else pq=pV.createComp(this._itemRender,null,null,ph);if(0==ph.length&&pq._watchMap){var pf=pq._watchMap;for(var pg in pf)for(var p$=pf[pg],pP=0;pP<p$.length;pP++){var pS=p$[pP];ph.push(pS.comp,pS.prop,pS.value)}}return ph.length&&(pq._$bindData=ph),pq},pf.addCell=function(ph){ph.on("click",this,this.onCellMouse),ph.on("rightclick",this,this.onCellMouse),ph.on("mouseover",this,this.onCellMouse),ph.on("mouseout",this,this.onCellMouse),ph.on("mousedown",this,this.onCellMouse),ph.on("mouseup",this,this.onCellMouse),this._cells.push(ph)},pf.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var ph=0,pq=ph=0;pq<1e4;pq++){var pf=this.getChildByName("item"+pq);if(!pf)break;this.addCell(pf),ph++}this.repeatY=ph}},pf.setContentSize=function(ph,pq){this._content.width=ph,this._content.height=pq,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new p_),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,ph,pq),this._content.scrollRect=this._content.scrollRect),this.event("resize")},pf.onCellMouse=function(ph){"mousedown"===ph.type&&(this._isMoved=!1);var pq=ph.currentTarget,pf=this._startIndex+this._cells.indexOf(pq);pf<0||("click"===ph.type||"rightclick"===ph.type?this.selectEnable&&!this._isMoved?this.selectedIndex=pf:this.changeCellState(pq,!0,0):"mouseover"!==ph.type&&"mouseout"!==ph.type||this._selectedIndex===pf||this.changeCellState(pq,"mouseover"===ph.type,0),this.mouseHandler&&this.mouseHandler.runWith([ph,pf]))},pf.changeCellState=function(ph,pq,pf){var pg=ph.getChildByName("selectBox");pg&&(this.selectEnable=!0,pg.visible=pq,pg.index=pf)},pf.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},pf.onScrollBarChange=function(ph){this.runCallLater(this.changeCells);var pq=this._scrollBar.value,pf=this._isVertical?this.repeatX:this.repeatY,pg=this._isVertical?this.repeatY:this.repeatX,p$=Math.floor(pq/this._cellSize);if(this.cacheContent)pS=pg+1,this._createdLine-p$<pS&&(this._createItems(this._createdLine,pf,this._createdLine+pS),this.renderItems(this._createdLine*pf,0),this._createdLine+=pS);else{var pP=p$*pf,pS=0;if(pP>this._startIndex){pS=pP-this._startIndex;var pB=!0,pr=this._startIndex+pf*(pg+1);this._isMoved=!0}else pP<this._startIndex&&(pS=this._startIndex-pP,pB=!1,pr=this._startIndex-1,this._isMoved=!0);for(var pY=0;pY<pS;pY++){if(pB){var pC=this._cells.shift();this._cells[this._cells.length]=pC;var pU=pr+pY}else pC=this._cells.pop(),this._cells.unshift(pC),pU=pr-pY;var pu=Math.floor(pU/pf)*this._cellSize;this._isVertical?pC.y=pu:pC.x=pu,this.renderItem(pC,pU)}this._startIndex=pP,this.changeSelectStatus()}var pv=this._content.scrollRect;this._isVertical?(pv.y=pq-this._offset.y,pv.x=-this._offset.x):(pv.y=-this._offset.y,pv.x=pq-this._offset.x),this._content.scrollRect=pv},pf.posCell=function(ph,pq){if(this._scrollBar){var pf=this._isVertical?this.repeatX:this.repeatY,pg=(this._isVertical?this.repeatY:this.repeatX,Math.floor(pq/pf)*this._cellSize);this._isVertical?ph.y=pg:ph.x=pg}},pf.changeSelectStatus=function(){for(var ph=0,pq=this._cells.length;ph<pq;ph++)this.changeCellState(this._cells[ph],this._selectedIndex===this._startIndex+ph,1)},pf.renderItems=function(ph,pq){void 0===ph&&(ph=0),void 0===pq&&(pq=0);for(var pf=ph,pg=pq||this._cells.length;pf<pg;pf++)this.renderItem(this._cells[pf],this._startIndex+pf);this.changeSelectStatus()},pf.renderItem=function(ph,pq){this._array&&0<=pq&&pq<this._array.length?(ph.visible=!0,ph._$bindData?(ph._dataSource=this._array[pq],this._bindData(ph,this._array[pq])):ph.dataSource=this._array[pq],this.cacheContent||this.posCell(ph,pq),this.hasListener("render")&&this.event("render",[ph,pq]),this.renderHandler&&this.renderHandler.runWith([ph,pq])):(ph.visible=!1,ph.dataSource=null)},pf._bindData=function(ph,pq){for(var pf=ph._$bindData,pg=0,p$=pf.length;pg<p$;pg++){var pP=pf[pg++],pS=pf[pg++],pB=pf[pg],pr=pA.getBindFun(pB);pP[pS]=pr.call(this,pq)}},pf.refresh=function(){this.array=this._array},pf.getItem=function(ph){return-1<ph&&ph<this._array.length?this._array[ph]:null},pf.changeItem=function(ph,pq){-1<ph&&ph<this._array.length&&(this._array[ph]=pq,ph>=this._startIndex&&ph<this._startIndex+this._cells.length&&this.renderItem(this.getCell(ph),ph))},pf.setItem=function(ph,pq){this.changeItem(ph,pq)},pf.addItem=function(ph){this._array.push(ph),this.array=this._array},pf.addItemAt=function(ph,pq){this._array.splice(pq,0,ph),this.array=this._array},pf.deleteItem=function(ph){this._array.splice(ph,1),this.array=this._array},pf.getCell=function(ph){return this.runCallLater(this.changeCells),-1<ph&&this._cells?this._cells[(ph-this._startIndex)%this._cells.length]:null},pf.scrollTo=function(ph){if(this._scrollBar){var pq=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(ph/pq)*this._cellSize}else this.startIndex=ph},pf.tweenTo=function(ph,pq,pf){if(void 0===pq&&(pq=200),this._scrollBar){var pg=this._isVertical?this.repeatX:this.repeatY;pt.to(this._scrollBar,{value:Math.floor(ph/pg)*this._cellSize},pq,null,pf,0,!0)}else this.startIndex=ph,pf&&pf.run()},pf._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},pf.commitMeasure=function(){this.runCallLater(this.changeCells)},p$(0,pf,"cacheAs",ph.prototype._$get_cacheAs,function(ph){pe.superSet(pc,this,"cacheAs",ph),this._scrollBar&&(this._$P.cacheAs=null,"none"!==ph?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),p$(0,pf,"content",function(){return this._content}),p$(0,pf,"height",ph.prototype._$get_height,function(ph){ph!=this._height&&(pe.superSet(pc,this,"height",ph),this._setCellChanged())}),p$(0,pf,"itemRender",function(){return this._itemRender},function(ph){if(this._itemRender!=ph){this._itemRender=ph;for(var pq=this._cells.length-1;-1<pq;pq--)this._cells[pq].destroy();this._cells.length=0,this._setCellChanged()}}),p$(0,pf,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(ph){this._removePreScrollBar();var pq=new pqh;pq.name="scrollBar",pq.right=0,ph&&" "!=ph&&(pq.skin=ph),this.scrollBar=pq,this.addChild(pq),this._setCellChanged()}),p$(0,pf,"page",function(){return this._page},function(ph){this._page=ph,this._array&&(this._page=0<ph?ph:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),p$(0,pf,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(ph){this._removePreScrollBar();var pq=new pQ;pq.name="scrollBar",pq.bottom=0,ph&&" "!=ph&&(pq.skin=ph),this.scrollBar=pq,this.addChild(pq),this._setCellChanged()}),p$(0,pf,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(ph){this._repeatX=ph,this._setCellChanged()}),p$(0,pf,"scrollBar",function(){return this._scrollBar},function(ph){this._scrollBar!=ph&&(this._scrollBar=ph)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),p$(0,pf,"width",ph.prototype._$get_width,function(ph){ph!=this._width&&(pe.superSet(pc,this,"width",ph),this._setCellChanged())}),p$(0,pf,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(ph){this._repeatY=ph,this._setCellChanged()}),p$(0,pf,"spaceX",function(){return this._spaceX},function(ph){this._spaceX=ph,this._setCellChanged()}),p$(0,pf,"spaceY",function(){return this._spaceY},function(ph){this._spaceY=ph,this._setCellChanged()}),p$(0,pf,"selectedIndex",function(){return this._selectedIndex},function(ph){this._selectedIndex!=ph&&(this._selectedIndex=ph,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(ph),this.startIndex=this._startIndex)}),p$(0,pf,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(ph){this.selectedIndex=this._array.indexOf(ph)}),p$(0,pf,"length",function(){return this._array?this._array.length:0}),p$(0,pf,"selection",function(){return this.getCell(this._selectedIndex)},function(ph){this.selectedIndex=this._startIndex+this._cells.indexOf(ph)}),p$(0,pf,"startIndex",function(){return this._startIndex},function(ph){this._startIndex=0<ph?ph:0,this.callLater(this.renderItems)}),p$(0,pf,"array",function(){return this._array},function(ph){this.runCallLater(this.changeCells),this._array=ph||[];var pq=this._array.length;if(this.totalPage=Math.ceil(pq/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<pq?this._selectedIndex:pq-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var pf=this._isVertical?this.repeatX:this.repeatY,pg=this._isVertical?this.repeatY:this.repeatX,p$=Math.ceil(pq/pf);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=pg/p$,this._scrollBar.setScroll(0,(p$-pg)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),p$(0,pf,"dataSource",ph.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)&&Math.floor(ph)==ph||"string"==typeof ph?this.selectedIndex=parseInt(ph):ph instanceof Array?this.array=ph:pe.superSet(pc,this,"dataSource",ph)}),p$(0,pf,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),pq}(pc),pQ=function(ph){function pq(){pq.__super.call(this)}return pP(pq,"laya.ui.HScrollBar",ph),pq.prototype.initialize=function(){ph.prototype.initialize.call(this),this.slider.isVertical=!1},pq}(pw),po=function(ph){function pq(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,pq.__super.call(this),this.width=this.height=100}pP(pq,"laya.ui.Panel",ph);var pf=pq.prototype;return pf.destroy=function(ph){void 0===ph&&(ph=!0),laya.ui.Component.prototype.destroy.call(this,ph),this._content&&this._content.destroy(ph),this._vScrollBar&&this._vScrollBar.destroy(ph),this._hScrollBar&&this._hScrollBar.destroy(ph),this._vScrollBar=null,this._hScrollBar=null,this._content=null},pf.destroyChildren=function(){this._content.destroyChildren()},pf.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new pc)},pf.addChild=function(ph){return ph.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(ph)},pf.onResize=function(){this._setScrollChanged()},pf.addChildAt=function(ph,pq){return ph.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(ph,pq)},pf.removeChild=function(ph){return ph.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(ph)},pf.removeChildAt=function(ph){return this.getChildAt(ph).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(ph)},pf.removeChildren=function(ph,pq){return void 0===ph&&(ph=0),void 0===pq&&(pq=2147483647),this._content.removeChildren(ph,pq),this._setScrollChanged(),this},pf.getChildAt=function(ph){return this._content.getChildAt(ph)},pf.getChildByName=function(ph){return this._content.getChildByName(ph)},pf.getChildIndex=function(ph){return this._content.getChildIndex(ph)},pf.changeScroll=function(){this._scrollChanged=!1;var ph=this.contentWidth||1,pq=this.contentHeight||1,pf=this._vScrollBar,pg=this._hScrollBar,p$=pf&&pq>this._height,pP=pg&&ph>this._width,pS=p$?this._width-pf.width:this._width,pB=pP?this._height-pg.height:this._height;pf&&(pf.x=this._width-pf.width,pf.y=0,pf.height=this._height-(pP?pg.height:0),pf.scrollSize=Math.max(.033*this._height,1),pf.thumbPercent=pB/pq,pf.setScroll(0,pq-pB,pf.value)),pg&&(pg.x=0,pg.y=this._height-pg.height,pg.width=this._width-(p$?pf.width:0),pg.scrollSize=Math.max(.033*this._width,1),pg.thumbPercent=pS/ph,pg.setScroll(0,ph-pS,pg.value))},pf.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},pf.setContentSize=function(ph,pq){var pf=this._content;pf.width=ph,pf.height=pq,pf.scrollRect||(pf.scrollRect=new p_),pf.scrollRect.setTo(0,0,ph,pq),pf.scrollRect=pf.scrollRect},pf.onScrollBarChange=function(ph){var pq=this._content.scrollRect;if(pq){var pf=Math.round(ph.value);ph.isVertical?pq.y=pf:pq.x=pf,this._content.scrollRect=pq}},pf.scrollTo=function(ph,pq){void 0===ph&&(ph=0),void 0===pq&&(pq=0),this.vScrollBar&&(this.vScrollBar.value=pq),this.hScrollBar&&(this.hScrollBar.value=ph)},pf.refresh=function(){this.changeScroll()},pf.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=pe.superGet(pc,this,"cacheAs")),pe.superSet(pc,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},pf.onScrollEnd=function(){pe.superSet(pc,this,"cacheAs",this._$P.cacheAs)},pf._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},p$(0,pf,"numChildren",function(){return this._content.numChildren}),p$(0,pf,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(ph){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new pQ),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=ph}),p$(0,pf,"contentWidth",function(){for(var ph=0,pq=this._content.numChildren-1;-1<pq;pq--){var pf=this._content.getChildAt(pq);ph=Math.max(pf.x+pf.width*pf.scaleX,ph)}return ph}),p$(0,pf,"contentHeight",function(){for(var ph=0,pq=this._content.numChildren-1;-1<pq;pq--){var pf=this._content.getChildAt(pq);ph=Math.max(pf.y+pf.height*pf.scaleY,ph)}return ph}),p$(0,pf,"width",ph.prototype._$get_width,function(ph){pe.superSet(pc,this,"width",ph),this._setScrollChanged()}),p$(0,pf,"hScrollBar",function(){return this._hScrollBar}),p$(0,pf,"content",function(){return this._content}),p$(0,pf,"height",ph.prototype._$get_height,function(ph){pe.superSet(pc,this,"height",ph),this._setScrollChanged()}),p$(0,pf,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(ph){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new pqh),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=ph}),p$(0,pf,"vScrollBar",function(){return this._vScrollBar}),p$(0,pf,"cacheAs",ph.prototype._$get_cacheAs,function(ph){pe.superSet(pc,this,"cacheAs",ph),this._$P.cacheAs=null,"none"!==ph?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),pq}(pc),pO=function(ph){function pq(ph){pq.__super.call(this,ph),this.isVertical=!1}return pP(pq,"laya.ui.HSlider",pk),pq}(),pj=function(ph){function pf(ph,pq){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,pf.__super.call(this),this.skin=pq,this.labels=ph}pP(pf,"laya.ui.UIGroup",ph);var pq=pf.prototype;return pe.imps(pq,{"laya.ui.IItem":!0}),pq.preinitialize=function(){this.mouseEnabled=!0},pq.destroy=function(ph){void 0===ph&&(ph=!0),laya.ui.Component.prototype.destroy.call(this,ph),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},pq.addItem=function(ph,pq){void 0===pq&&(pq=!0);var pf=ph,pg=this._items.length;if(pf.name="item"+pg,this.addChild(pf),this.initItems(),pq&&0<pg){var p$=this._items[pg-1];"horizontal"==this._direction?pf.x=p$.x+p$.width+this._space:pf.y=p$.y+p$.height+this._space}else pq&&(pf.x=0,pf.y=0);return pg},pq.delItem=function(ph,pq){void 0===pq&&(pq=!0);var pf=this._items.indexOf(ph);if(-1!=pf){var pg=ph;this.removeChild(pg);for(var p$=pf+1,pP=this._items.length;p$<pP;p$++){var pS=this._items[p$];pS.name="item"+(p$-1),pq&&("horizontal"==this._direction?pS.x-=pg.width+this._space:pS.y-=pg.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var pB;pB=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=pB}}},pq.initItems=function(){this._items||(this._items=[]);for(var ph=this._items.length=0;ph<1e4;ph++){var pq=this.getChildByName("item"+ph);if(null==pq)break;this._items.push(pq),pq.selected=ph===this._selectedIndex,pq.clickHandler=pu.create(this,this.itemClick,[ph],!1)}},pq.itemClick=function(ph){this.selectedIndex=ph},pq.setSelect=function(ph,pq){this._items&&-1<ph&&ph<this._items.length&&(this._items[ph].selected=pq)},pq.createItem=function(ph,pq){return null},pq.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var ph=0,pq=0,pf=this._items.length;pq<pf;pq++){var pg=this._items[pq];this._skin&&(pg.skin=this._skin),this._labelColors&&(pg.labelColors=this._labelColors),this._labelSize&&(pg.labelSize=this._labelSize),this._labelStroke&&(pg.labelStroke=this._labelStroke),this._labelStrokeColor&&(pg.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(pg.strokeColors=this._strokeColors),this._labelBold&&(pg.labelBold=this._labelBold),this._labelPadding&&(pg.labelPadding=this._labelPadding),this._labelAlign&&(pg.labelAlign=this._labelAlign),this._stateNum&&(pg.stateNum=this._stateNum),this._labelFont&&(pg.labelFont=this._labelFont),"horizontal"===this._direction?(pg.y=0,pg.x=ph,ph+=pg.width+this._space):(pg.x=0,pg.y=ph,ph+=pg.height+this._space)}this.changeSize()},pq.commitMeasure=function(){this.runCallLater(this.changeLabels)},pq._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},p$(0,pq,"labelStrokeColor",function(){return this._labelStrokeColor},function(ph){this._labelStrokeColor!=ph&&(this._labelStrokeColor=ph,this._setLabelChanged())}),p$(0,pq,"skin",function(){return this._skin},function(ph){this._skin!=ph&&(this._skin=ph,this._setLabelChanged())}),p$(0,pq,"selectedIndex",function(){return this._selectedIndex},function(ph){this._selectedIndex!=ph&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=ph,this.setSelect(ph,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),p$(0,pq,"labels",function(){return this._labels},function(ph){if(this._labels!=ph){if(this._labels=ph,this.removeChildren(),this._setLabelChanged(),this._labels)for(var pq=this._labels.split(","),pf=0,pg=pq.length;pf<pg;pf++){var p$=this.createItem(this._skin,pq[pf]);p$.name="item"+pf,this.addChild(p$)}this.initItems()}}),p$(0,pq,"strokeColors",function(){return this._strokeColors},function(ph){this._strokeColors!=ph&&(this._strokeColors=ph,this._setLabelChanged())}),p$(0,pq,"labelColors",function(){return this._labelColors},function(ph){this._labelColors!=ph&&(this._labelColors=ph,this._setLabelChanged())}),p$(0,pq,"labelStroke",function(){return this._labelStroke},function(ph){this._labelStroke!=ph&&(this._labelStroke=ph,this._setLabelChanged())}),p$(0,pq,"labelSize",function(){return this._labelSize},function(ph){this._labelSize!=ph&&(this._labelSize=ph,this._setLabelChanged())}),p$(0,pq,"stateNum",function(){return this._stateNum},function(ph){this._stateNum!=ph&&(this._stateNum=ph,this._setLabelChanged())}),p$(0,pq,"labelBold",function(){return this._labelBold},function(ph){this._labelBold!=ph&&(this._labelBold=ph,this._setLabelChanged())}),p$(0,pq,"labelFont",function(){return this._labelFont},function(ph){this._labelFont!=ph&&(this._labelFont=ph,this._setLabelChanged())}),p$(0,pq,"labelPadding",function(){return this._labelPadding},function(ph){this._labelPadding!=ph&&(this._labelPadding=ph,this._setLabelChanged())}),p$(0,pq,"direction",function(){return this._direction},function(ph){this._direction=ph,this._setLabelChanged()}),p$(0,pq,"space",function(){return this._space},function(ph){this._space=ph,this._setLabelChanged()}),p$(0,pq,"items",function(){return this._items}),p$(0,pq,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(ph){this.selectedIndex=this._items.indexOf(ph)}),p$(0,pq,"dataSource",ph.prototype._$get_dataSource,function(ph){"number"==typeof(this._dataSource=ph)&&Math.floor(ph)==ph||"string"==typeof ph?this.selectedIndex=parseInt(ph):ph instanceof Array?this.labels=ph.join(","):pe.superSet(pc,this,"dataSource",ph)}),pf}(pc),px=function(pq){function pf(ph,pq){this._value=null,void 0===pq&&(pq=""),pf.__super.call(this,ph,pq)}pP(pf,"laya.ui.Radio",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._value=null},ph.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},ph.initialize=function(){pq.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},ph.onClick=function(ph){this.selected=!0},p$(0,ph,"value",function(){return null!=this._value?this._value:this.label},function(ph){this._value=ph}),pf}(pM),pa=function(ph){function pq(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,pq.__super.call(this),this.width=this.height=200}pP(pq,"laya.ui.Tree",ph);var pf=pq.prototype;return pe.imps(pf,{"laya.ui.IRender":!0}),pf.destroy=function(ph){void 0===ph&&(ph=!0),laya.ui.Component.prototype.destroy.call(this,ph),this._list&&this._list.destroy(ph),this._list=null,this._source=null,this._renderHandler=null},pf.createChildren=function(){this.addChild(this._list=new pZ),this._list.renderHandler=pu.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},pf.onListChange=function(ph){this.event("change")},pf.getArray=function(){var ph,pq=[];for(var pf in this._source)ph=this._source[pf],this.getParentOpenStatus(ph)&&(ph.x=this._spaceLeft*this.getDepth(ph),pq.push(ph));return pq},pf.getDepth=function(ph,pq){return void 0===pq&&(pq=0),null==ph.nodeParent?pq:this.getDepth(ph.nodeParent,pq+1)},pf.getParentOpenStatus=function(ph){var pq=ph.nodeParent;return null==pq||!!pq.isOpen&&(null==pq.nodeParent||this.getParentOpenStatus(pq))},pf.renderItem=function(ph,pq){var pf=ph.dataSource;if(pf){ph.left=pf.x;var pg=ph.getChildByName("arrow");pg&&(pf.hasChild?(pg.visible=!0,pg.index=pf.isOpen?1:0,pg.tag=pq,pg.off("click",this,this.onArrowClick),pg.on("click",this,this.onArrowClick)):pg.visible=!1);var p$=ph.getChildByName("folder");p$&&(2==p$.clipY?p$.index=pf.isDirectory?0:1:p$.index=pf.isDirectory?pf.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([ph,pq])}},pf.onArrowClick=function(ph){var pq=ph.currentTarget.tag;this._list.array[pq].isOpen=!this._list.array[pq].isOpen,this.event("open"),this._list.array=this.getArray()},pf.setItemState=function(ph,pq){this._list.array[ph]&&(this._list.array[ph].isOpen=pq,this._list.array=this.getArray())},pf.fresh=function(){this._list.array=this.getArray(),this.repaint()},pf.parseXml=function(ph,pq,pf,pg){var p$,pP=ph.childNodes,pS=pP.length;if(!pg){p$={};var pB,pr=ph.attributes;for(var pY in pr){var pC=(pB=pr[pY]).nodeName,pU=pB.nodeValue;p$[pC]="true"==pU||"false"!=pU&&pU}p$.nodeParent=pf,0<pS&&(p$.isDirectory=!0),p$.hasChild=0<pS,pq.push(p$)}for(var pu=0;pu<pS;pu++){var pv=pP[pu];this.parseXml(pv,pq,p$,!1)}},pf.parseOpenStatus=function(ph,pq){for(var pf=0,pg=pq.length;pf<pg;pf++){var p$=pq[pf];if(p$.isDirectory)for(var pP=0,pS=ph.length;pP<pS;pP++){var pB=ph[pP];if(pB.isDirectory&&this.isSameParent(pB,p$)&&p$.label==pB.label){p$.isOpen=pB.isOpen;break}}}},pf.isSameParent=function(ph,pq){return null==ph.nodeParent&&null==pq.nodeParent||null!=ph.nodeParent&&null!=pq.nodeParent&&(ph.nodeParent.label==pq.nodeParent.label&&this.isSameParent(ph.nodeParent,pq.nodeParent))},pf.filter=function(ph){if(Boolean(ph)){var pq=[];this.getFilterSource(this._source,pq,ph),this._list.array=pq}else this._list.array=this.getArray()},pf.getFilterSource=function(ph,pq,pf){var pg;for(var p$ in pf=pf.toLocaleLowerCase(),ph)!(pg=ph[p$]).isDirectory&&-1<String(pg.label).toLowerCase().indexOf(pf)&&(pg.x=0,pq.push(pg)),pg.child&&0<pg.child.length&&this.getFilterSource(pg.child,pq,pf)},p$(0,pf,"spaceBottom",function(){return this._list.spaceY},function(ph){this._list.spaceY=ph}),p$(0,pf,"keepStatus",function(){return this._keepStatus},function(ph){this._keepStatus=ph}),p$(0,pf,"itemRender",function(){return this._list.itemRender},function(ph){this._list.itemRender=ph}),p$(0,pf,"array",function(){return this._list.array},function(ph){this._keepStatus&&this._list.array&&ph&&this.parseOpenStatus(this._list.array,ph),this._source=ph,this._list.array=this.getArray()}),p$(0,pf,"mouseHandler",function(){return this._list.mouseHandler},function(ph){this._list.mouseHandler=ph}),p$(0,pf,"dataSource",ph.prototype._$get_dataSource,function(ph){this._dataSource=ph,pe.superSet(pc,this,"dataSource",ph)}),p$(0,pf,"source",function(){return this._source}),p$(0,pf,"scrollBar",function(){return this._list.scrollBar}),p$(0,pf,"list",function(){return this._list}),p$(0,pf,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(ph){this._list.vScrollBarSkin=ph}),p$(0,pf,"renderHandler",function(){return this._renderHandler},function(ph){this._renderHandler=ph}),p$(0,pf,"selectedIndex",function(){return this._list.selectedIndex},function(ph){this._list.selectedIndex=ph}),p$(0,pf,"spaceLeft",function(){return this._spaceLeft},function(ph){this._spaceLeft=ph}),p$(0,pf,"selectedItem",function(){return this._list.selectedItem},function(ph){this._list.selectedItem=ph}),p$(0,pf,"width",ph.prototype._$get_width,function(ph){pe.superSet(pc,this,"width",ph),this._list.width=ph}),p$(0,pf,"height",ph.prototype._$get_height,function(ph){pe.superSet(pc,this,"height",ph),this._list.height=ph}),p$(0,pf,"xml",null,function(ph){var pq=[];this.parseXml(ph.childNodes[0],pq,null,!0),this.array=pq}),p$(0,pf,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),pq}(pc),phh=function(ph){function pq(){this._items=null,this._selectedIndex=0,pq.__super.call(this),this._setIndexHandler=pu.create(this,this.setIndex,null,!1)}pP(pq,"laya.ui.ViewStack",ph);var pf=pq.prototype;return pe.imps(pf,{"laya.ui.IItem":!0}),pf.setItems=function(ph){this.removeChildren();for(var pq=0,pf=0,pg=ph.length;pf<pg;pf++){var p$=ph[pf];p$&&(p$.name="item"+pq,this.addChild(p$),pq++)}this.initItems()},pf.addItem=function(ph){ph.name="item"+this._items.length,this.addChild(ph),this.initItems()},pf.initItems=function(){this._items=[];for(var ph=0;ph<1e4;ph++){var pq=this.getChildByName("item"+ph);if(null==pq)break;this._items.push(pq),pq.visible=ph==this._selectedIndex}},pf.setSelect=function(ph,pq){this._items&&-1<ph&&ph<this._items.length&&(this._items[ph].visible=pq)},pf.setIndex=function(ph){this.selectedIndex=ph},p$(0,pf,"dataSource",ph.prototype._$get_dataSource,function(ph){if("number"==typeof(this._dataSource=ph)&&Math.floor(ph)==ph||"string"==typeof ph)this.selectedIndex=parseInt(ph);else for(var pq in this._dataSource)this.hasOwnProperty(pq)&&(this[pq]=this._dataSource[pq])}),p$(0,pf,"selectedIndex",function(){return this._selectedIndex},function(ph){this._selectedIndex!=ph&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=ph,this.setSelect(this._selectedIndex,!0))}),p$(0,pf,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(ph){this.selectedIndex=this._items.indexOf(ph)}),p$(0,pf,"items",function(){return this._items}),p$(0,pf,"setIndexHandler",function(){return this._setIndexHandler},function(ph){this._setIndexHandler=ph}),pq}(pc),pqh=function(ph){function pq(){pq.__super.call(this)}return pP(pq,"laya.ui.VScrollBar",pw),pq}(),pfh=function(pq){function pf(ph){this._bg=null,this._skin=null,pf.__super.call(this),void 0===ph&&(ph=""),this.text=ph,this.skin=this.skin}pP(pf,"laya.ui.TextInput",pq);var ph=pf.prototype;return ph.preinitialize=function(){this.mouseEnabled=!0},ph.destroy=function(ph){pN.clearCache(this,this._skin),void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._bg&&this._bg.destroy(),this._bg=null},ph.createChildren=function(){this.addChild(this._tf=new pv),this._tf.padding=pp.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},ph._onFocus=function(){this.event("focus",this)},ph._onBlur=function(){this.event("blur",this)},ph._onInput=function(){this.event("input",this)},ph._onEnter=function(){this.event("enter",this)},ph.initialize=function(){this.width=128,this.height=22},ph.select=function(){this._tf.select()},ph.setSelection=function(ph,pq){this._tf.setSelection(ph,pq)},p$(0,ph,"text",pq.prototype._$get_text,function(ph){this._tf.text!=ph&&(ph+="",this._tf.text=ph,this.event("change"))}),p$(0,ph,"bg",function(){return this._bg},function(ph){this.graphics=this._bg=ph}),p$(0,ph,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(ph){this._tf.inputElementYAdjuster=ph}),p$(0,ph,"multiline",function(){return this._tf.multiline},function(ph){this._tf.multiline=ph}),p$(0,ph,"skin",function(){return this._skin},function(ph){this._skin!=ph&&(pN.clearCache(this,this._skin),this._skin=ph,this._bg||(this.graphics=this._bg=new pb),pN.keepCache(this,this._skin),this._bg.source=pN.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),p$(0,ph,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(ph){this._bg||(this.graphics=this._bg=new pb),this._bg.sizeGrid=pA.fillArray(pp.defaultSizeGrid,ph,Number)}),p$(0,ph,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(ph){this._tf.inputElementXAdjuster=ph}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pD,this,"width",ph),this._bg&&(this._bg.width=ph)}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pD,this,"height",ph),this._bg&&(this._bg.height=ph)}),p$(0,ph,"editable",function(){return this._tf.editable},function(ph){this._tf.editable=ph}),p$(0,ph,"restrict",function(){return this._tf.restrict},function(ph){this._tf.restrict=ph}),p$(0,ph,"prompt",function(){return this._tf.prompt},function(ph){this._tf.prompt=ph}),p$(0,ph,"promptColor",function(){return this._tf.promptColor},function(ph){this._tf.promptColor=ph}),p$(0,ph,"maxChars",function(){return this._tf.maxChars},function(ph){this._tf.maxChars=ph}),p$(0,ph,"focus",function(){return this._tf.focus},function(ph){this._tf.focus=ph}),p$(0,ph,"type",function(){return this._tf.type},function(ph){this._tf.type=ph}),p$(0,ph,"asPassword",function(){return this._tf.asPassword},function(ph){this._tf.asPassword=ph}),pf}(pD),pgh=function(ph){function pq(){pq.__super.call(this)}return pP(pq,"laya.ui.VSlider",pk),pq}(),p$h=function(ph){function pg(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,pg.__super.call(this)}pP(pg,"laya.ui.Dialog",ph);var pq=pg.prototype;return pq.initialize=function(){this.popupEffect=pg.manager.popupEffectHandler,this.closeEffect=pg.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},pq._dealDragArea=function(){var ph=this.getChildByName("drag");ph&&(this.dragArea=ph.x+","+ph.y+","+ph.width+","+ph.height,ph.removeSelf())},pq._onClick=function(ph){var pq=ph.target;if(pq)switch(pq.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(pq.name)}},pq.show=function(ph,pq){void 0===ph&&(ph=!1),void 0===pq&&(pq=!0),this._open(!1,ph,pq)},pq.popup=function(ph,pq){void 0===ph&&(ph=!1),void 0===pq&&(pq=!0),this._open(!0,ph,pq)},pq._open=function(ph,pq,pf){pg.manager.lock(!1),this.isModal=ph,pg.manager.open(this,pq,pf)},pq.onOpened=function(){},pq.close=function(ph,pq){void 0===pq&&(pq=!0),pg.manager.close(this,ph,pq)},pq.onClosed=function(ph){},pq._onMouseDown=function(ph){var pq=this.getMousePoint();this._dragArea.contains(pq.x,pq.y)?this.startDrag():this.stopDrag()},p$(0,pq,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(ph){if(ph){var pq=pA.fillArray([0,0,0,0],ph,Number);this._dragArea=new p_(pq[0],pq[1],pq[2],pq[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),p$(0,pq,"isPopup",function(){return null!=this.parent}),p$(0,pq,"zOrder",ph.prototype._$get_zOrder,function(ph){pe.superSet(pV,this,"zOrder",ph),pg.manager._checkMask()}),p$(1,pg,"manager",function(){return pg._manager=pg._manager||new pz},function(ph){pg._manager=ph}),pg.setLockView=function(ph){pg.manager.setLockView(ph)},pg.lock=function(ph){pg.manager.lock(ph)},pg.closeAll=function(){pg.manager.closeAll()},pg.getDialogsByGroup=function(ph){return pg.manager.getDialogsByGroup(ph)},pg.closeByGroup=function(ph){return pg.manager.closeByGroup(ph)},pg.CLOSE="close",pg.CANCEL="cancel",pg.SURE="sure",pg.NO="no",pg.OK="ok",pg.YES="yes",pg._manager=null,pg}(pV),pPh=function(ph){function pq(){pq.__super.call(this)}pP(pq,"laya.ui.HBox",ph);var pf=pq.prototype;return pf.sortItem=function(ph){ph&&ph.sort(function(ph,pq){return ph.x-pq.x})},pf.changeItems=function(){this._itemChanged=!1;for(var ph=[],pq=0,pf=0,pg=this.numChildren;pf<pg;pf++){var p$=this.getChildAt(pf);p$&&p$.layoutEnabled&&(ph.push(p$),pq=this._height?this._height:Math.max(pq,p$.height*p$.scaleY))}this.sortItem(ph);var pP=0;for(pf=0,pg=ph.length;pf<pg;pf++)(p$=ph[pf]).x=pP,pP+=p$.width*p$.scaleX+this._space,"top"==this._align?p$.y=0:"middle"==this._align?p$.y=.5*(pq-p$.height*p$.scaleY):"bottom"==this._align&&(p$.y=pq-p$.height*p$.scaleY);this.changeSize()},p$(0,pf,"height",ph.prototype._$get_height,function(ph){this._height!=ph&&(pe.superSet(py,this,"height",ph),this.callLater(this.changeItems))}),pq.NONE="none",pq.TOP="top",pq.MIDDLE="middle",pq.BOTTOM="bottom",pq}(py),pSh=function(ph){function pq(){pq.__super.call(this)}pP(pq,"laya.ui.VBox",ph);var pf=pq.prototype;return pf.changeItems=function(){this._itemChanged=!1;for(var ph=[],pq=0,pf=0,pg=this.numChildren;pf<pg;pf++){var p$=this.getChildAt(pf);p$&&p$.layoutEnabled&&(ph.push(p$),pq=this._width?this._width:Math.max(pq,p$.width*p$.scaleX))}this.sortItem(ph);var pP=0;for(pf=0,pg=ph.length;pf<pg;pf++)(p$=ph[pf]).y=pP,pP+=p$.height*p$.scaleY+this._space,"left"==this._align?p$.x=0:"center"==this._align?p$.x=.5*(pq-p$.width*p$.scaleX):"right"==this._align&&(p$.x=pq-p$.width*p$.scaleX);this.changeSize()},p$(0,pf,"width",ph.prototype._$get_width,function(ph){this._width!=ph&&(pe.superSet(py,this,"width",ph),this.callLater(this.changeItems))}),pq.NONE="none",pq.LEFT="left",pq.CENTER="center",pq.RIGHT="right",pq}(py),pBh=function(ph){function pq(){pq.__super.call(this)}return pP(pq,"laya.ui.RadioGroup",pj),pq.prototype.createItem=function(ph,pq){return new px(ph,pq)},pq}(),prh=function(ph){function pq(){pq.__super.call(this)}return pP(pq,"laya.ui.Tab",pj),pq.prototype.createItem=function(ph,pq){return new pM(ph,pq)},pq}(),pYh=function(pq){function pf(ph){this._vScrollBar=null,this._hScrollBar=null,void 0===ph&&(ph=""),pf.__super.call(this,ph)}pP(pf,"laya.ui.TextArea",pq);var ph=pf.prototype;return ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},ph.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},ph.onVBarChanged=function(ph){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},ph.onHBarChanged=function(ph){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},ph.changeScroll=function(){var ph=this._vScrollBar&&0<this._tf.maxScrollY,pq=this._hScrollBar&&0<this._tf.maxScrollX,pf=ph?this._width-this._vScrollBar.width:this._width,pg=pq?this._height-this._hScrollBar.height:this._height,p$=this._tf.padding||pp.labelPadding;this._tf.width=pf,this._tf.height=pg,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-p$[2],this._vScrollBar.y=p$[1],this._vScrollBar.height=this._height-(pq?this._hScrollBar.height:0)-p$[1]-p$[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=pg/Math.max(this._tf.textHeight,pg),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=ph),this._hScrollBar&&(this._hScrollBar.x=p$[0],this._hScrollBar.y=this._height-this._hScrollBar.height-p$[3],this._hScrollBar.width=this._width-(ph?this._vScrollBar.width:0)-p$[0]-p$[2],this._hScrollBar.scrollSize=Math.max(.033*pf,1),this._hScrollBar.thumbPercent=pf/Math.max(this._tf.textWidth,pf),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=pq)},ph.scrollTo=function(ph){this.commitMeasure(),this._tf.scrollY=ph},p$(0,ph,"scrollY",function(){return this._tf.scrollY}),p$(0,ph,"width",pq.prototype._$get_width,function(ph){pe.superSet(pfh,this,"width",ph),this.callLater(this.changeScroll)}),p$(0,ph,"hScrollBar",function(){return this._hScrollBar}),p$(0,ph,"height",pq.prototype._$get_height,function(ph){pe.superSet(pfh,this,"height",ph),this.callLater(this.changeScroll)}),p$(0,ph,"maxScrollX",function(){return this._tf.maxScrollX}),p$(0,ph,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(ph){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new pqh),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=ph}),p$(0,ph,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(ph){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new pQ),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=ph}),p$(0,ph,"vScrollBar",function(){return this._vScrollBar}),p$(0,ph,"maxScrollY",function(){return this._tf.maxScrollY}),p$(0,ph,"scrollX",function(){return this._tf.scrollX}),pf}(pfh);!function(ph){function pq(){this._uiView=null,this.isCloseOther=!1,pq.__super.call(this)}pP(pq,"laya.ui.AsynDialog",p$h);var pf=pq.prototype;pf.createView=function(ph){this._uiView=ph},pf._open=function(ph,pq,pf){this.isModal=ph,this.isCloseOther=pq,p$h.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},pf.onCreated=function(){this.createUI(),this.onOpen()},pf.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},pf.onOpen=function(){p$h.manager.open(this,this.isCloseOther),p$h.manager.lock(!1)},pf.close=function(ph,pq){void 0===pq&&(pq=!0),p$h.manager.close(this),this.onClose()},pf.onClose=function(){},pf.destroy=function(ph){void 0===ph&&(ph=!0),laya.ui.View.prototype.destroy.call(this,ph),this._uiView=null,this.onDestroy()},pf.onDestroy=function(){}}();pe.__init([pV])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ph,pq){"use strict";for(var pf in Object.defineProperty(pq,"__esModule",{value:!0}),Laya){var pg=Laya[pf];pg&&pg.__isclass&&(pq[pf]=pg)}}),function(pu,ph,pE){pE.un,pE.uns;var pU=pE.static,pv=pE.class,pL=pE.getset,pg=pE.__newvec,pm=laya.maths.Arith,pS=laya.webgl.atlas.AtlasResourceManager,pf=laya.webgl.shader.BaseShader,pi=laya.utils.Browser,pB=laya.webgl.utils.Buffer,pR=laya.utils.Byte,p$=laya.utils.ClassUtils,pr=pE.Config,pP=(laya.events.Event,laya.events.EventDispatcher),pp=laya.utils.Handler,p_=laya.net.Loader,pq=laya.net.LoaderManager,pY=(laya.maths.MathUtil,laya.display.Node),pe=laya.renders.Render,pC=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),pl=laya.resource.Resource,pN=laya.utils.RunDriver,pG=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),pt=laya.display.Sprite,pX=laya.utils.Stat,pn=laya.utils.StringKey,pA=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),pJ=laya.utils.Utils,pd=laya.webgl.WebGL,pb=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;pE.interface("laya.d3.core.IClone"),pE.interface("laya.d3.graphics.IVertex"),pE.interface("laya.d3.core.render.IUpdate"),pE.interface("laya.d3.core.scene.ITreeNode"),pE.interface("laya.d3.core.render.IRenderable");(function(){function pM(){}pv(pM,"laya.d3.animation.AnimationClipParser01"),pM.READ_DATA=function(){pM._DATA.offset=pM._reader.getUint32(),pM._DATA.size=pM._reader.getUint32()},pM.READ_BLOCK=function(){for(var ph=pM._BLOCK.count=pM._reader.getUint16(),pq=pM._BLOCK.blockStarts=[],pf=pM._BLOCK.blockLengths=[],pg=0;pg<ph;pg++)pq.push(pM._reader.getUint32()),pf.push(pM._reader.getUint32())},pM.READ_STRINGS=function(){var ph=pM._reader.getUint32(),pq=pM._reader.getUint16(),pf=pM._reader.pos;pM._reader.pos=ph+pM._DATA.offset;for(var pg=0;pg<pq;pg++)pM._strings[pg]=pM._reader.readUTFString();pM._reader.pos=pf},pM.parse=function(ph,pq){pM._animationClip=ph;(pM._reader=pq).__getBuffer();pM.READ_DATA(),pM.READ_BLOCK(),pM.READ_STRINGS();for(var pf=0,pg=pM._BLOCK.count;pf<pg;pf++){var p$=pq.getUint16(),pP=pM._strings[p$],pS=pM["READ_"+pP];if(null==pS)throw new Error("model file err,no this function:"+p$+" "+pP);pS.call()}},pM.READ_ANIMATIONS=function(){var ph,pq=0,pf=0,pg=pM._reader,p$=pg.__getBuffer(),pP=[],pS=pg.getUint8();for(pP.length=pS,pq=0;pq<pS;pq++)pP[pq]=pg.getUint16();var pB=[],pr=pg.getUint16();for(pB.length=pr,pq=0;pq<pr;pq++)pB[pq]=pg.getFloat32();var pY=pM._animationClip;pY.name=pM._strings[pg.getUint16()];var pC=pY._duration=pg.getFloat32();pY.islooping=!!pg.getByte(),pY._frameRate=pg.getInt16();var pU=pg.getInt16(),pu=pY._nodes=new Array;pu.length=pU,(pY._publicClipDatas=[]).length=pU;var pv=pY._nodesMap={},pL=0,pe=0;for(pq=0;pq<pU;pq++){ph=pu[pq]=new ps;var pl=pg.getUint16(),p_=ph.path=[];for(p_.length=pl,pf=0;pf<pl;pf++)p_[pf]=pM._strings[pg.getUint16()];var pN=p_.join("/"),pG=pv[pN];pG||(pv[pN]=pG=[]),pG.push(ph);var pm=pg.getInt16();-1!==pm&&(ph.componentType=pM._strings[pm]);var pE=pH._propertyIndexDic[pM._strings[pg.getUint16()]];if(null==pE)throw new Error("AnimationClipParser01:unknown property name.");var pR=pE<4,pt=!pR||pR&&""===p_[0];(ph._cacheProperty=pt)?pL++:pe++,ph.propertyNameID=pE;var pX=pP[pg.getUint8()];ph.keyFrameWidth=pX/4;var pn=ph.keyFrames=[],pJ=pn.length=pg.getUint16(),pp=null,pA=NaN;for(pf=0;pf<pJ;pf++){var pd=pn[pf]=new pD;pA=pd.startTime=pB[pg.getUint16()];var pb=pg.pos;pd.inTangent=new Float32Array(p$.slice(pb,pb+pX)),pg.pos+=pX,pb=pg.pos,pd.outTangent=new Float32Array(p$.slice(pb,pb+pX)),pg.pos+=pX,pb=pg.pos,pd.data=new Float32Array(p$.slice(pb,pb+pX)),pg.pos+=pX,pp&&(pp.next=pd,pp.duration=pA-pp.startTime),pp=pd}pd.next=null,pd.duration=pC-pA}var pi=pY._nodeToCachePropertyMap=new Int32Array(pU),pz=pY._cachePropertyMap=new Int32Array(pL),pc=pY._unCachePropertyMap=new Int32Array(pe);for(pL=pe=0,pq=0;pq<pU;pq++)(ph=pu[pq])._cacheProperty?(pi[pq]=pL,pz[pL++]=pq):pc[pe++]=pq},pM._animationClip=null,pM._reader=null,pM._strings=[],pU(pM,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function pw(){}pv(pw,"laya.d3.animation.AnimationClipParser02"),pw.READ_DATA=function(){pw._DATA.offset=pw._reader.getUint32(),pw._DATA.size=pw._reader.getUint32()},pw.READ_BLOCK=function(){for(var ph=pw._BLOCK.count=pw._reader.getUint16(),pq=pw._BLOCK.blockStarts=[],pf=pw._BLOCK.blockLengths=[],pg=0;pg<ph;pg++)pq.push(pw._reader.getUint32()),pf.push(pw._reader.getUint32())},pw.READ_STRINGS=function(){var ph=pw._reader.getUint32(),pq=pw._reader.getUint16(),pf=pw._reader.pos;pw._reader.pos=ph+pw._DATA.offset;for(var pg=0;pg<pq;pg++)pw._strings[pg]=pw._reader.readUTFString();pw._reader.pos=pf},pw.parse=function(ph,pq){pw._animationClip=ph;(pw._reader=pq).__getBuffer();pw.READ_DATA(),pw.READ_BLOCK(),pw.READ_STRINGS();for(var pf=0,pg=pw._BLOCK.count;pf<pg;pf++){var p$=pq.getUint16(),pP=pw._strings[p$],pS=pw["READ_"+pP];if(null==pS)throw new Error("model file err,no this function:"+p$+" "+pP);pS.call()}},pw.READ_ANIMATIONS=function(){var ph,pq=0,pf=0,pg=pw._reader,p$=pg.__getBuffer(),pP=[],pS=pg.getUint8();for(pP.length=pS,pq=0;pq<pS;pq++)pP[pq]=pg.getUint16();var pB=[],pr=pg.getUint16();for(pB.length=pr,pq=0;pq<pr;pq++)pB[pq]=pg.getFloat32();var pY=pw._animationClip;pY.name=pw._strings[pg.getUint16()];var pC=pY._duration=pg.getFloat32();pY.islooping=!!pg.getByte(),pY._frameRate=pg.getInt16();var pU=pg.getInt16(),pu=pY._nodes=new Array;pu.length=pU,(pY._publicClipDatas=[]).length=pU;var pv=pY._nodesMap={},pL=0,pe=0;for(pq=0;pq<pU;pq++){ph=pu[pq]=new ps;var pl=pg.getUint16(),p_=ph.path=[];for(p_.length=pl,pf=0;pf<pl;pf++)p_[pf]=pw._strings[pg.getUint16()];var pN=p_.join("/"),pG=pv[pN];pG||(pv[pN]=pG=[]),pG.push(ph);var pm=pg.getInt16();-1!==pm&&(ph.componentType=pw._strings[pm]);var pE=pH._propertyIndexDic[pw._strings[pg.getUint16()]];if(null==pE)throw new Error("AnimationClipParser02:unknown property name.");var pR=pE<4,pt=!pR||pR&&""===p_[0];(ph._cacheProperty=pt)?pL++:pe++,ph.propertyNameID=pE;var pX=pP[pg.getUint8()];ph.keyFrameWidth=pX/4;var pn=ph.keyFrames=[],pJ=pn.length=pg.getUint16(),pp=null,pA=NaN;for(pf=0;pf<pJ;pf++){var pd=pn[pf]=new pD;pA=pd.startTime=pB[pg.getUint16()];var pb=pg.pos;pd.inTangent=new Float32Array(p$.slice(pb,pb+pX)),pg.pos+=pX,pb=pg.pos,pd.outTangent=new Float32Array(p$.slice(pb,pb+pX)),pg.pos+=pX,pb=pg.pos,pd.data=new Float32Array(p$.slice(pb,pb+pX)),pg.pos+=pX,pp&&(pp.next=pd,pp.duration=pA-pp.startTime),pp=pd}pd.next=null,pd.duration=pC-pA}var pi=pg.getUint16();for(pq=0;pq<pi;pq++){var pz,pc=new pk;pc.time=pg.getFloat32(),pc.eventName=pw._strings[pg.getUint16()];var pM=pg.getUint16();for(0<pM&&(pc.params=pz=[]),pf=0;pf<pM;pf++){switch(pg.getByte()){case 0:pz.push(!!pg.getByte());break;case 1:pz.push(pg.getInt32());break;case 2:pz.push(pg.getFloat32());break;case 3:pz.push(pw._strings[pg.getUint16()]);break;default:throw new Error("unknown type.")}}pY.addEvent(pc)}var pW=pY._nodeToCachePropertyMap=new Int32Array(pU),pT=pY._cachePropertyMap=new Int32Array(pL),pI=pY._unCachePropertyMap=new Int32Array(pe);for(pL=pe=0,pq=0;pq<pU;pq++)(ph=pu[pq])._cacheProperty?(pW[pq]=pL,pT[pL++]=pq):pI[pe++]=pq},pw._animationClip=null,pw._reader=null,pw._strings=[],pU(pw,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var pk=function(){function ph(){this.time=NaN,this.eventName=null,this.params=null}return pv(ph,"laya.d3.animation.AnimationEvent"),ph}(),pH=function(){function pg(){this._childs=[],this.transform=new pNq(this)}pv(pg,"laya.d3.animation.AnimationNode");var ph=pg.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.addChild=function(ph){ph._parent=this,ph.transform.setParent(this.transform),this._childs.push(ph)},ph.removeChild=function(ph){var pq=this._childs.indexOf(ph);-1!==pq&&this._childs.splice(pq,1)},ph.getChildByName=function(ph){for(var pq=0,pf=this._childs.length;pq<pf;pq++){var pg=this._childs[pq];if(pg.name===ph)return pg}return null},ph.getChildByIndex=function(ph){return this._childs[ph]},ph.getChildCount=function(){return this._childs.length},ph.cloneTo=function(ph){var pq=ph;pq.name=this.name;for(var pf=0,pg=this._childs.length;pf<pg;pf++){var p$=this._childs[pf],pP=p$.clone();pq.addChild(pP);var pS=p$.transform,pB=pP.transform;pB.setLocalPosition(pS.getLocalPosition()),pB.setLocalRotation(pS.getLocalRotation()),pB.setLocalScale(pS.getLocalScale()),pB._localRotationEuler=pS._localRotationEuler,pB._setWorldMatrixIgnoreUpdate(pS.getWorldMatrix())}},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pg.__init__=function(){pg.registerAnimationNodeProperty("localPosition",pg._getLocalPosition,pg._setLocalPosition),pg.registerAnimationNodeProperty("localRotation",pg._getLocalRotation,pg._setLocalRotation),pg.registerAnimationNodeProperty("localScale",pg._getLocalScale,pg._setLocalScale),pg.registerAnimationNodeProperty("localRotationEuler",pg._getLocalRotationEuler,pg._setLocalRotationEuler),pg.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",pg._getParticleRenderSharedMaterialTintColor,pg._setParticleRenderSharedMaterialTintColor),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",pg._getMeshRenderSharedMaterialTilingOffset,pg._setMeshRenderSharedMaterialTilingOffset),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",pg._getMeshRenderSharedMaterialAlbedo,pg._setMeshRenderSharedMaterialAlbedo),pg.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",pg._getSkinnedMeshRenderSharedMaterialTilingOffset,pg._setSkinnedMeshRenderSharedMaterialTilingOffset),pg.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",pg._getSkinnedMeshRenderSharedMaterialAlbedo,pg._setSkinnedMeshRenderSharedMaterialAlbedo),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",pg._getMeshRenderSharedMaterialAlbedo,pg._setMeshRenderSharedMaterialAlbedo),pg.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",pg._getSkinnedMeshRenderSharedMaterialAlbedo,pg._setSkinnedMeshRenderSharedMaterialAlbedo),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",pg._getMeshRenderSharedMaterialIntensity,pg._setMeshRenderSharedMaterialIntensity),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",pg._getMeshRenderSharedMaterialAlpha,pg._setMeshRenderSharedMaterialAlpha),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",pg._getMeshRenderSharedMaterialAlphaColor,pg._setMeshRenderSharedMaterialAlphaColor),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",pg._getMeshRenderSharedMaterialBaseColor,pg._setMeshRenderSharedMaterialBaseColor),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",pg._getMeshRenderSharedMaterialDissolve,pg._setMeshRenderSharedMaterialDissolve),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",pg._getMeshRenderSharedMaterialDissolveSpeed,pg._setMeshRenderSharedMaterialDissolveSpeed),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",pg._getMeshRenderSharedMaterialMMultiplier,pg._setMeshRenderSharedMaterialMMultiplier),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",pg._getMeshRenderSharedMaterialBaseScrollSpeedX,pg._setMeshRenderSharedMaterialBaseScrollSpeedX),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",pg._getMeshRenderSharedMaterialBaseScrollSpeedY,pg._setMeshRenderSharedMaterialBaseScrollSpeedY),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",pg._getMeshRenderSharedMaterialSecondScrollSpeedX,pg._setMeshRenderSharedMaterialSecondScrollSpeedX),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",pg._getMeshRenderSharedMaterialSecondScrollSpeedY,pg._setMeshRenderSharedMaterialSecondScrollSpeedY),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",pg._getMeshRenderSharedMaterialDetailTilingOffset,pg._setMeshRenderSharedMaterialDetailTilingOffset),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",pg._getMeshRenderSharedMaterialDissolveTilingOffset,pg._setMeshRenderSharedMaterialDissolveTilingOffset),pg.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",pg._getMeshRenderSharedMaterialMaskTilingOffset,pg._setMeshRenderSharedMaterialMaskTilingOffset)},pg.registerAnimationNodeProperty=function(ph,pq,pf){if(pg._propertyIndexDic[ph])throw new Error("AnimationNode: this propertyName has registered.");pg._propertyIndexDic[ph]=pg._propertyIDCounter,pg._propertyGetFuncs[pg._propertyIDCounter]=pq,pg._propertySetFuncs[pg._propertyIDCounter]=pf,pg._propertyIDCounter++},pg._getLocalPosition=function(ph,pq){return ph?ph.transform.getLocalPosition():pq._transform.localPosition.elements},pg._setLocalPosition=function(ph,pq,pf){if(ph)ph.transform.setLocalPosition(pf);else{var pg=pq._transform,p$=pg.localPosition;p$.elements=pf,pg.localPosition=p$}},pg._getLocalRotation=function(ph,pq){return ph?ph.transform.getLocalRotation():pq._transform.localRotation.elements},pg._setLocalRotation=function(ph,pq,pf){if(ph)ph.transform.setLocalRotation(pf);else{var pg=pq._transform,p$=pg.localRotation;p$.elements=pf,pg.localRotation=p$}},pg._getLocalScale=function(ph,pq){return ph?ph.transform.getLocalScale():pq._transform.localScale.elements},pg._setLocalScale=function(ph,pq,pf){if(ph)ph.transform.setLocalScale(pf);else{var pg=pq._transform,p$=pg.localScale;p$.elements=pf,pg.localScale=p$}},pg._getLocalRotationEuler=function(ph,pq){return ph?ph.transform.getLocalRotationEuler():pq._transform.localRotationEuler.elements},pg._setLocalRotationEuler=function(ph,pq,pf){if(ph)ph.transform.setLocalRotationEuler(pf);else{var pg=pq._transform,p$=pg.localRotationEuler;p$.elements=pf,pg.localRotationEuler=p$}},pg._getMeshRenderSharedMaterialTilingOffset=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return pq.meshRender.sharedMaterial.tilingOffset.elements},pg._setMeshRenderSharedMaterialTilingOffset=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.meshRender.material).tilingOffset).elements=pf,pg.tilingOffset=p$)}else(p$=(pg=pq.meshRender.material).tilingOffset).elements=pf,pg.tilingOffset=p$},pg._getMeshRenderSharedMaterialAlbedo=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.albedoColor.elements:null}return pq.meshRender.sharedMaterial.albedoColor.elements},pg._setMeshRenderSharedMaterialAlbedo=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.meshRender.material).albedoColor).elements=pf,pg.albedoColor=p$)}else(p$=(pg=pq.meshRender.material).albedoColor).elements=pf,pg.albedoColor=p$},pg._getSkinnedMeshRenderSharedMaterialTilingOffset=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return pq.skinnedMeshRender.sharedMaterial.tilingOffset.elements},pg._setSkinnedMeshRenderSharedMaterialTilingOffset=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.skinnedMeshRender.material).tilingOffset).elements=pf,pg.tilingOffset=p$)}else(p$=(pg=pq.skinnedMeshRender.material).tilingOffset).elements=pf,pg.tilingOffset=p$},pg._getSkinnedMeshRenderSharedMaterialAlbedo=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return pq.skinnedMeshRender.sharedMaterial.albedoColor.elements},pg._setSkinnedMeshRenderSharedMaterialAlbedo=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.skinnedMeshRender.material).albedoColor).elements=pf,pg.albedoColor=p$)}else(p$=(pg=pq.skinnedMeshRender.material).albedoColor).elements=pf,pg.albedoColor=p$},pg._getParticleRenderSharedMaterialTintColor=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.particleRender.sharedMaterial.tintColor.elements:null}return pq.particleRender.sharedMaterial.tintColor.elements},pg._setParticleRenderSharedMaterialTintColor=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.particleRender.material).tintColor).elements=pf,pg.tintColor=p$)}else(p$=(pg=pq.particleRender.material).tintColor).elements=pf,pg.tintColor=p$},pg._getMeshRenderSharedMaterialAlphaColor=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.alphaColor.elements:null}return pq.meshRender.sharedMaterial.alphaColor.elements},pg._setMeshRenderSharedMaterialAlphaColor=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.meshRender.material).alphaColor).elements=pf,pg.alphaColor=p$)}else(p$=(pg=pq.meshRender.material).alphaColor).elements=pf,pg.alphaColor=p$},pg._getMeshRenderSharedMaterialBaseColor=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.baseColor.elements:null}return pq.meshRender.sharedMaterial.baseColor.elements},pg._setMeshRenderSharedMaterialBaseColor=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.meshRender.material).baseColor).elements=pf,pg.baseColor=p$)}else(p$=(pg=pq.meshRender.material).baseColor).elements=pf,pg.baseColor=p$},pg._getMeshRenderSharedMaterialDissolve=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.dissolve:0}return pq.meshRender.sharedMaterial.dissolve},pg._setMeshRenderSharedMaterialDissolve=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.dissolve=pf[0])}else pq.meshRender.material.dissolve=pf[0]},pg._getMeshRenderSharedMaterialDissolveSpeed=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.dissolveSpeed:0}return pq.meshRender.sharedMaterial.dissolveSpeed},pg._setMeshRenderSharedMaterialDissolveSpeed=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.dissolveSpeed=pf[0])}else pq.meshRender.material.dissolveSpeed=pf[0]},pg._getMeshRenderSharedMaterialMMultiplier=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.mMultiplier:0}return pq.meshRender.sharedMaterial.mMultiplier},pg._setMeshRenderSharedMaterialMMultiplier=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.mMultiplier=pf[0])}else pq.meshRender.material.mMultiplier=pf[0]},pg._getMeshRenderSharedMaterialBaseScrollSpeedX=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return pq.meshRender.sharedMaterial.baseScrollSpeedX},pg._setMeshRenderSharedMaterialBaseScrollSpeedX=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.baseScrollSpeedX=pf[0])}else pq.meshRender.material.baseScrollSpeedX=pf[0]},pg._getMeshRenderSharedMaterialBaseScrollSpeedY=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return pq.meshRender.sharedMaterial.baseScrollSpeedY},pg._setMeshRenderSharedMaterialBaseScrollSpeedY=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.baseScrollSpeedY=pf[0])}else pq.meshRender.material.baseScrollSpeedY=pf[0]},pg._getMeshRenderSharedMaterialSecondScrollSpeedX=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return pq.meshRender.sharedMaterial.secondScrollSpeedX},pg._setMeshRenderSharedMaterialSecondScrollSpeedX=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.secondScrollSpeedX=pf[0])}else pq.meshRender.material.secondScrollSpeedX=pf[0]},pg._getMeshRenderSharedMaterialSecondScrollSpeedY=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return pq.meshRender.sharedMaterial.secondScrollSpeedY},pg._setMeshRenderSharedMaterialSecondScrollSpeedY=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.secondScrollSpeedY=pf[0])}else pq.meshRender.material.secondScrollSpeedY=pf[0]},pg._getMeshRenderSharedMaterialAlpha=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.alpha:0}return pq.meshRender.sharedMaterial.alpha},pg._setMeshRenderSharedMaterialAlpha=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.alpha=pf[0])}else pq.meshRender.material.alpha=pf[0]},pg._getMeshRenderSharedMaterialIntensity=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.intensity:0}return pq.meshRender.sharedMaterial.intensity},pg._setMeshRenderSharedMaterialIntensity=function(ph,pq,pf){if(ph){var pg=ph.transform._entity;pg&&(pg.owner.meshRender.material.intensity=pf[0])}else pq.meshRender.material.intensity=pf[0]},pg._getMeshRenderSharedMaterialDetailTilingOffset=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return pq.meshRender.sharedMaterial.detailTilingOffset.elements},pg._setMeshRenderSharedMaterialDetailTilingOffset=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.meshRender.material).detailTilingOffset).elements=pf,pg.detailTilingOffset=p$)}else(p$=(pg=pq.meshRender.material).detailTilingOffset).elements=pf,pg.detailTilingOffset=p$},pg._getMeshRenderSharedMaterialDissolveTilingOffset=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return pq.meshRender.sharedMaterial.dissolveTilingOffset.elements},pg._setMeshRenderSharedMaterialDissolveTilingOffset=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.meshRender.material).dissolveTilingOffset).elements=pf,pg.dissolveTilingOffset=p$)}else(p$=(pg=pq.meshRender.material).dissolveTilingOffset).elements=pf,pg.dissolveTilingOffset=p$},pg._getMeshRenderSharedMaterialMaskTilingOffset=function(ph,pq){if(ph){var pf=ph.transform._entity;return pf?pf.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return pq.meshRender.sharedMaterial.maskTilingOffset.elements},pg._setMeshRenderSharedMaterialMaskTilingOffset=function(ph,pq,pf){var pg,p$;if(ph){var pP=ph.transform._entity;pP&&((p$=(pg=pP.owner.meshRender.material).maskTilingOffset).elements=pf,pg.maskTilingOffset=p$)}else(p$=(pg=pq.meshRender.material).maskTilingOffset).elements=pf,pg.maskTilingOffset=p$},pg._propertyIDCounter=0,pg._propertyIndexDic={},pg._propertySetFuncs=[],pg._propertyGetFuncs=[],pg}(),pD=function(){function ph(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return pv(ph,"laya.d3.animation.Keyframe"),ph}(),ps=function(){function ph(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return pv(ph,"laya.d3.animation.KeyframeNode"),ph}(),pz=(function(){function ph(){this._tempVector30=new pSq,this._tempVector31=new pSq,this._tempVector32=new pSq,this._a=new pSq,this._b=new pSq,this._c=new pSq,this._d=new pSq}pv(ph,"laya.d3.core.glitter.SplineCurvePositionVelocity");var pq=ph.prototype;pq.Init=function(ph,pq,pf,pg){ph.cloneTo(this._d),pq.cloneTo(this._c),pSq.scale(ph,2,this._a),pSq.scale(pf,2,this._tempVector30),pSq.subtract(this._a,this._tempVector30,this._a),pSq.add(this._a,pq,this._a),pSq.add(this._a,pg,this._a),pSq.scale(pf,3,this._b),pSq.scale(ph,3,this._tempVector30),pSq.subtract(this._b,this._tempVector30,this._b),pSq.subtract(this._b,pg,this._b),pSq.scale(pq,2,this._tempVector30),pSq.subtract(this._b,this._tempVector30,this._b)},pq.Slerp=function(ph,pq){pSq.scale(this._a,ph*ph*ph,this._tempVector30),pSq.scale(this._b,ph*ph,this._tempVector31),pSq.scale(this._c,ph,this._tempVector32),pSq.add(this._tempVector30,this._tempVector31,pq),pSq.add(pq,this._tempVector32,pq),pSq.add(pq,this._d,pq)}}(),function(){function pT(ph,pq,pf,pg){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=ph,this._h=pq,this._minHeight=pf,this._maxHeight=pg}pv(pT,"laya.d3.core.HeightMap");var ph=pT.prototype;ph._inBounds=function(ph,pq){return 0<=ph&&ph<this._h&&0<=pq&&pq<this._w},ph.getHeight=function(ph,pq){return this._inBounds(ph,pq)?this._datas[ph][pq]:NaN},pL(0,ph,"width",function(){return this._w}),pL(0,ph,"height",function(){return this._h}),pL(0,ph,"maxHeight",function(){return this._maxHeight}),pL(0,ph,"minHeight",function(){return this._minHeight}),pT.creatFromMesh=function(ph,pq,pf,pg){for(var p$=[],pP=[],pS=ph.getSubMeshCount(),pB=0;pB<pS;pB++){for(var pr=ph.getSubMesh(pB),pY=pr._getVertexBuffer(),pC=pY.getData(),pU=[],pu=0;pu<pC.length;pu+=pY.vertexDeclaration.vertexStride/4){var pv=new pSq(pC[pu+0],pC[pu+1],pC[pu+2]);pU.push(pv)}p$.push(pU);var pL=pr._getIndexBuffer();pP.push(pL.getData())}var pe=ph.boundingBox,pl=pe.min.x,p_=pe.min.z,pN=pe.max.x,pG=pe.max.z,pm=pe.min.y,pE=pe.max.y,pR=pN-pl,pt=pG-p_,pX=pg.elements[0]=pR/(pq-1),pn=pg.elements[1]=pt/(pf-1),pJ=new pT(pq,pf,pm,pE),pp=pT._tempRay,pA=pp.direction.elements;pA[0]=0,pA[1]=-1,pA[2]=0;var pd=pE+.1;pp.origin.elements[1]=pd;for(var pb=0;pb<pf;pb++){var pi=p_+pb*pn;pJ._datas[pb]=[];for(var pz=0;pz<pq;pz++){var pc=pl+pz*pX,pM=pp.origin.elements;pM[0]=pc,pM[2]=pi;var pW=pT._getPosition(pp,p$,pP);pJ._datas[pb][pz]=pW===Number.MAX_VALUE?NaN:pd-pW}}return pJ},pT.createFromImage=function(ph,pq,pf){for(var pg=ph.width,p$=ph.height,pP=new pT(pg,p$,pq,pf),pS=(pf-pq)/254,pB=ph.getPixels(),pr=0,pY=0;pY<p$;pY++)for(var pC=pP._datas[pY]=[],pU=0;pU<pg;pU++){var pu=pB[pr++],pv=pB[pr++],pL=pB[pr++],pe=pB[pr++];pC[pU]=255==pu&&255==pv&&255==pL&&255==pe?NaN:(pu+pv+pL)/3*pS+pq}return pP},pT._getPosition=function(ph,pq,pf){for(var pg=Number.MAX_VALUE,p$=0;p$<pq.length;p$++)for(var pP=pq[p$],pS=pf[p$],pB=0;pB<pS.length;pB+=3){var pr=pP[pS[pB+0]],pY=pP[pS[pB+1]],pC=pP[pS[pB+2]],pU=pLq.rayIntersectsTriangle(ph,pr,pY,pC);!isNaN(pU)&&pU<pg&&(pg=pU)}return pg},pU(pT,["_tempRay",function(){return this._tempRay=new p$q(new pSq,new pSq)}])}(),function(){function p$(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}pv(p$,"laya.d3.core.Layer");var ph=p$.prototype;return ph._binarySearchIndex=function(){for(var ph=0,pq=p$._collsionTestList.length-1,pf=0;ph<=pq;){pf=Math.floor((ph+pq)/2);var pg=p$._collsionTestList[pf];if(pg==this._number)return pf;pg>this._number?pq=pf-1:ph=pf+1}return ph},ph._addCollider=function(ph){0===this._colliders.length&&p$._collsionTestList.splice(this._binarySearchIndex(),0,this._number),ph._isRigidbody?(this._colliders.unshift(ph),this._nonRigidbodyOffset++):this._colliders.push(ph)},ph._removeCollider=function(ph){var pq=this._colliders.indexOf(ph);pq<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(pq,1),0===this._colliders.length&&p$._collsionTestList.splice(p$._collsionTestList.indexOf(this._number),1)},pL(0,ph,"number",function(){return this._number}),pL(0,ph,"visible",function(){return this._visible},function(ph){this._visible=ph,p$._visibleLayers=ph?p$._visibleLayers|this.mask:p$._visibleLayers&~this.mask}),pL(0,ph,"mask",function(){return this._mask}),pL(1,p$,"visibleLayers",function(){return p$._visibleLayers},function(ph){p$._visibleLayers=ph;for(var pq=0,pf=p$._layerList.length;pq<pf;pq++){var pg=p$._layerList[pq];pg._visible=0!=(pg._mask&p$._visibleLayers)}}),p$.__init__=function(){p$._layerList.length=31;for(var ph=0;ph<31;ph++){var pq=new p$;p$._layerList[ph]=pq,0===ph?(pq.name="Default Layer",pq.visible=!0):(pq.name="Layer-"+ph,pq.visible=!1),pq._number=ph,pq._mask=Math.pow(2,ph)}p$.currentCreationLayer=p$._layerList[0]},p$.getLayerByNumber=function(ph){if(ph<0||30<ph)throw new Error("无法返回指定Layer，该number超出范围！");return p$._layerList[ph]},p$.getLayerByName=function(ph){for(var pq=0;pq<31;pq++)if(p$._layerList[pq].name===ph)return p$._layerList[pq];throw new Error("无法返回指定Layer,该name不存在")},p$.isVisible=function(ph){return 0!=(ph&p$._currentCameraCullingMask&p$._visibleLayers)},p$._layerList=[],p$._visibleLayers=2147483647,p$._collsionTestList=[],p$._currentCameraCullingMask=2147483647,p$.maxCount=31,p$.currentCreationLayer=null,p$}()),pc=(function(){function ph(ph,pq,pf){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=ph,this._minCount=pq,this._maxCount=pf}pv(ph,"laya.d3.core.particleShuriKen.module.Burst");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.cloneTo=function(ph){var pq=ph;pq._time=this._time,pq._minCount=this._minCount,pq._maxCount=this._maxCount},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"time",function(){return this._time}),pL(0,pq,"minCount",function(){return this._minCount}),pL(0,pq,"maxCount",function(){return this._maxCount})}(),function(){function ph(ph){this._color=null,this.enbale=!1,this._color=ph}pv(ph,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var pq=ph.prototype;pq.cloneTo=function(ph){var pq=ph;this._color.cloneTo(pq._color),pq.enbale=this.enbale},pq.clone=function(){var ph;switch(this._color.type){case 0:ph=pW.createByConstant(this._color.constant.clone());break;case 1:ph=pW.createByGradient(this._color.gradient.clone());break;case 2:ph=pW.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:ph=pW.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var pq=new this.constructor(ph);return pq.enbale=this.enbale,pq},pL(0,pq,"color",function(){return this._color})}(),function(){function ph(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}pv(ph,"laya.d3.core.particleShuriKen.module.Emission");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),pq._destroy=function(){this._bursts=null,this._destroyed=!0},pq.getBurstsCount=function(){return this._bursts.length},pq.getBurstByIndex=function(ph){return this._bursts[ph]},pq.addBurst=function(ph){var pq=this._bursts.length;if(0<pq)for(var pf=0;pf<pq;pf++)this._bursts[pf].time>ph.time&&this._bursts.splice(pf,0,ph);this._bursts.push(ph)},pq.removeBurst=function(ph){var pq=this._bursts.indexOf(ph);-1!==pq&&this._bursts.splice(pq,1)},pq.removeBurstByIndex=function(ph){this._bursts.splice(ph,1)},pq.clearBurst=function(){this._bursts.length=0},pq.cloneTo=function(ph){var pq=ph,pf=pq._bursts;pf.length=this._bursts.length;for(var pg=0,p$=this._bursts.length;pg<p$;pg++){var pP=pf[pg];pP?this._bursts[pg].cloneTo(pP):pf[pg]=this._bursts[pg].clone()}pq._emissionRate=this._emissionRate,pq.enbale=this.enbale},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"destroyed",function(){return this._destroyed}),pL(0,pq,"emissionRate",function(){return this._emissionRate},function(ph){if(ph<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=ph})}(),function(){function pg(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}pv(pg,"laya.d3.core.particleShuriKen.module.FrameOverTime");var ph=pg.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.cloneTo=function(ph){var pq=ph;pq._type=this._type,pq._constant=this._constant,this._overTime.cloneTo(pq._overTime),pq._constantMin=this._constantMin,pq._constantMax=this._constantMax,this._overTimeMin.cloneTo(pq._overTimeMin),this._overTimeMax.cloneTo(pq._overTimeMax)},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,ph,"frameOverTimeData",function(){return this._overTime}),pL(0,ph,"constant",function(){return this._constant}),pL(0,ph,"type",function(){return this._type}),pL(0,ph,"frameOverTimeDataMin",function(){return this._overTimeMin}),pL(0,ph,"constantMin",function(){return this._constantMin}),pL(0,ph,"frameOverTimeDataMax",function(){return this._overTimeMax}),pL(0,ph,"constantMax",function(){return this._constantMax}),pg.createByConstant=function(ph){var pq=new pg;return pq._type=0,pq._constant=ph,pq},pg.createByOverTime=function(ph){var pq=new pg;return pq._type=1,pq._overTime=ph,pq},pg.createByRandomTwoConstant=function(ph,pq){var pf=new pg;return pf._type=2,pf._constantMin=ph,pf._constantMax=pq,pf},pg.createByRandomTwoOverTime=function(ph,pq){var pf=new pg;return pf._type=3,pf._overTimeMin=ph,pf._overTimeMax=pq,pf},pg}()),pM=function(){function pY(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}pv(pY,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var ph=pY.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.cloneTo=function(ph){var pq=ph;pq._type=this._type,pq._separateAxes=this._separateAxes,pq._constant=this._constant,this._constantSeparate.cloneTo(pq._constantSeparate),this._gradient.cloneTo(pq._gradient),this._gradientX.cloneTo(pq._gradientX),this._gradientY.cloneTo(pq._gradientY),this._gradientZ.cloneTo(pq._gradientZ),pq._constantMin=this._constantMin,pq._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(pq._constantMinSeparate),this._constantMaxSeparate.cloneTo(pq._constantMaxSeparate),this._gradientMin.cloneTo(pq._gradientMin),this._gradientMax.cloneTo(pq._gradientMax),this._gradientXMin.cloneTo(pq._gradientXMin),this._gradientXMax.cloneTo(pq._gradientXMax),this._gradientYMin.cloneTo(pq._gradientYMin),this._gradientYMax.cloneTo(pq._gradientYMax),this._gradientZMin.cloneTo(pq._gradientZMin),this._gradientZMax.cloneTo(pq._gradientZMax)},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,ph,"gradientZ",function(){return this._gradientZ}),pL(0,ph,"constant",function(){return this._constant}),pL(0,ph,"gradient",function(){return this._gradient}),pL(0,ph,"separateAxes",function(){return this._separateAxes}),pL(0,ph,"type",function(){return this._type}),pL(0,ph,"constantSeparate",function(){return this._constantSeparate}),pL(0,ph,"gradientX",function(){return this._gradientX}),pL(0,ph,"gradientY",function(){return this._gradientY}),pL(0,ph,"gradientW",function(){return this._gradientW}),pL(0,ph,"gradientMin",function(){return this._gradientMin}),pL(0,ph,"constantMin",function(){return this._constantMin}),pL(0,ph,"gradientMax",function(){return this._gradientMax}),pL(0,ph,"constantMax",function(){return this._constantMax}),pL(0,ph,"gradientWMin",function(){return this._gradientWMin}),pL(0,ph,"constantMinSeparate",function(){return this._constantMinSeparate}),pL(0,ph,"constantMaxSeparate",function(){return this._constantMaxSeparate}),pL(0,ph,"gradientXMin",function(){return this._gradientXMin}),pL(0,ph,"gradientXMax",function(){return this._gradientXMax}),pL(0,ph,"gradientWMax",function(){return this._gradientWMax}),pL(0,ph,"gradientYMin",function(){return this._gradientYMin}),pL(0,ph,"gradientYMax",function(){return this._gradientYMax}),pL(0,ph,"gradientZMin",function(){return this._gradientZMin}),pL(0,ph,"gradientZMax",function(){return this._gradientZMax}),pY.createByConstant=function(ph){var pq=new pY;return pq._type=0,pq._separateAxes=!1,pq._constant=ph,pq},pY.createByConstantSeparate=function(ph){var pq=new pY;return pq._type=0,pq._separateAxes=!0,pq._constantSeparate=ph,pq},pY.createByGradient=function(ph){var pq=new pY;return pq._type=1,pq._separateAxes=!1,pq._gradient=ph,pq},pY.createByGradientSeparate=function(ph,pq,pf,pg){var p$=new pY;return p$._type=1,p$._separateAxes=!0,p$._gradientX=ph,p$._gradientY=pq,p$._gradientZ=pf,p$._gradientW=pg,p$},pY.createByRandomTwoConstant=function(ph,pq){var pf=new pY;return pf._type=2,pf._separateAxes=!1,pf._constantMin=ph,pf._constantMax=pq,pf},pY.createByRandomTwoConstantSeparate=function(ph,pq){var pf=new pY;return pf._type=2,pf._separateAxes=!0,pf._constantMinSeparate=ph,pf._constantMaxSeparate=pq,pf},pY.createByRandomTwoGradient=function(ph,pq){var pf=new pY;return pf._type=3,pf._separateAxes=!1,pf._gradientMin=ph,pf._gradientMax=pq,pf},pY.createByRandomTwoGradientSeparate=function(ph,pq,pf,pg,p$,pP,pS,pB){var pr=new pY;return pr._type=3,pr._separateAxes=!0,pr._gradientXMin=ph,pr._gradientXMax=pq,pr._gradientYMin=pf,pr._gradientYMax=pg,pr._gradientZMin=p$,pr._gradientZMax=pP,pr._gradientWMin=pS,pr._gradientWMax=pB,pr},pY}(),pW=function(){function pg(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}pv(pg,"laya.d3.core.particleShuriKen.module.GradientColor");var ph=pg.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.cloneTo=function(ph){var pq=ph;pq._type=this._type,this._constant.cloneTo(pq._constant),this._constantMin.cloneTo(pq._constantMin),this._constantMax.cloneTo(pq._constantMax),this._gradient.cloneTo(pq._gradient),this._gradientMin.cloneTo(pq._gradientMin),this._gradientMax.cloneTo(pq._gradientMax)},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,ph,"gradient",function(){return this._gradient}),pL(0,ph,"constant",function(){return this._constant}),pL(0,ph,"type",function(){return this._type}),pL(0,ph,"gradientMin",function(){return this._gradientMin}),pL(0,ph,"constantMin",function(){return this._constantMin}),pL(0,ph,"gradientMax",function(){return this._gradientMax}),pL(0,ph,"constantMax",function(){return this._constantMax}),pg.createByConstant=function(ph){var pq=new pg;return pq._type=0,pq._constant=ph,pq},pg.createByGradient=function(ph){var pq=new pg;return pq._type=1,pq._gradient=ph,pq},pg.createByRandomTwoConstant=function(ph,pq){var pf=new pg;return pf._type=2,pf._constantMin=ph,pf._constantMax=pq,pf},pg.createByRandomTwoGradient=function(ph,pq){var pf=new pg;return pf._type=3,pf._gradientMin=ph,pf._gradientMax=pq,pf},pg}(),pT=(function(){function ph(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}pv(ph,"laya.d3.core.particleShuriKen.module.GradientDataColor");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.addAlpha=function(ph,pq){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==ph&&(ph=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=ph,this._alphaElements[this._alphaCurrentLength++]=pq):DEBUG},pq.addRGB=function(ph,pq){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==ph&&(ph=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=ph,this._rgbElements[this._rgbCurrentLength++]=pq.x,this._rgbElements[this._rgbCurrentLength++]=pq.y,this._rgbElements[this._rgbCurrentLength++]=pq.z):DEBUG},pq.cloneTo=function(ph){var pq=ph,pf=0,pg=0;pq._alphaCurrentLength=this._alphaCurrentLength;var p$=pq._alphaElements;for(p$.length=this._alphaElements.length,pf=0,pg=this._alphaElements.length;pf<pg;pf++)p$[pf]=this._alphaElements[pf];pq._rgbCurrentLength=this._rgbCurrentLength;var pP=pq._rgbElements;for(pP.length=this._rgbElements.length,pf=0,pg=this._rgbElements.length;pf<pg;pf++)pP[pf]=this._rgbElements[pf]},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),pL(0,pq,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function ph(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}pv(ph,"laya.d3.core.particleShuriKen.module.GradientDataInt");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.add=function(ph,pq){this._currentLength<8?(6===this._currentLength&&1!==ph&&(ph=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=ph,this._elements[this._currentLength++]=pq):console.log("Warning:data count must lessEqual than 4")},pq.cloneTo=function(ph){var pq=ph;pq._currentLength=this._currentLength;var pf=pq._elements;pf.length=this._elements.length;for(var pg=0,p$=this._elements.length;pg<p$;pg++)pf[pg]=this._elements[pg]},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"gradientCount",function(){return this._currentLength/2})}(),function(){function ph(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}pv(ph,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.add=function(ph,pq){this._currentLength<8?(6===this._currentLength&&1!==ph&&(ph=1,DEBUG),this._elements[this._currentLength++]=ph,this._elements[this._currentLength++]=pq):DEBUG},pq.getKeyByIndex=function(ph){return this._elements[2*ph]},pq.getValueByIndex=function(ph){return this._elements[2*ph+1]},pq.getAverageValue=function(){for(var ph=0,pq=this._currentLength-2;ph<pq;ph+=2){this._elements[ph+1];this._elements[ph+3],this._elements[ph+2]-this._elements[ph]}return 0},pq.cloneTo=function(ph){var pq=ph;pq._currentLength=this._currentLength;var pf=pq._elements;pf.length=this._elements.length;for(var pg=0,p$=this._elements.length;pg<p$;pg++)pf[pg]=this._elements[pg]},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"gradientCount",function(){return this._currentLength/2})}(),function(){function ph(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}pv(ph,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.add=function(ph,pq){this._currentLength<8?(6===this._currentLength&&1!==ph&&(ph=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=ph,this._elements[this._currentLength++]=pq.x,this._elements[this._currentLength++]=pq.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},pq.cloneTo=function(ph){var pq=ph;pq._currentLength=this._currentLength;var pf=pq._elements;pf.length=this._elements.length;for(var pg=0,p$=this._elements.length;pg<p$;pg++)pf[pg]=this._elements[pg]},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"gradientCount",function(){return this._currentLength/3})}(),function(){function pB(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}pv(pB,"laya.d3.core.particleShuriKen.module.GradientSize");var ph=pB.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.getMaxSizeInGradient=function(){var ph=0,pq=0,pf=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(ph=0,pq=this._gradientX.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientX.getValueByIndex(ph));for(ph=0,pq=this._gradientY.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientY.getValueByIndex(ph))}else for(ph=0,pq=this._gradient.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradient.getValueByIndex(ph));break;case 1:pf=this._separateAxes?(pf=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),pf=Math.max(pf,this._constantMinSeparate.y),Math.max(pf,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(ph=0,pq=this._gradientXMin.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientXMin.getValueByIndex(ph));for(ph=0,pq=this._gradientXMax.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientXMax.getValueByIndex(ph));for(ph=0,pq=this._gradientYMin.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientYMin.getValueByIndex(ph));for(ph=0,pq=this._gradientZMax.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientZMax.getValueByIndex(ph))}else{for(ph=0,pq=this._gradientMin.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientMin.getValueByIndex(ph));for(ph=0,pq=this._gradientMax.gradientCount;ph<pq;ph++)pf=Math.max(pf,this._gradientMax.getValueByIndex(ph))}}return pf},ph.cloneTo=function(ph){var pq=ph;pq._type=this._type,pq._separateAxes=this._separateAxes,this._gradient.cloneTo(pq._gradient),this._gradientX.cloneTo(pq._gradientX),this._gradientY.cloneTo(pq._gradientY),this._gradientZ.cloneTo(pq._gradientZ),pq._constantMin=this._constantMin,pq._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(pq._constantMinSeparate),this._constantMaxSeparate.cloneTo(pq._constantMaxSeparate),this._gradientMin.cloneTo(pq._gradientMin),this._gradientMax.cloneTo(pq._gradientMax),this._gradientXMin.cloneTo(pq._gradientXMin),this._gradientXMax.cloneTo(pq._gradientXMax),this._gradientYMin.cloneTo(pq._gradientYMin),this._gradientYMax.cloneTo(pq._gradientYMax),this._gradientZMin.cloneTo(pq._gradientZMin),this._gradientZMax.cloneTo(pq._gradientZMax)},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,ph,"gradientZ",function(){return this._gradientZ}),pL(0,ph,"gradient",function(){return this._gradient}),pL(0,ph,"separateAxes",function(){return this._separateAxes}),pL(0,ph,"type",function(){return this._type}),pL(0,ph,"gradientMin",function(){return this._gradientMin}),pL(0,ph,"constantMin",function(){return this._constantMin}),pL(0,ph,"gradientX",function(){return this._gradientX}),pL(0,ph,"gradientY",function(){return this._gradientY}),pL(0,ph,"gradientMax",function(){return this._gradientMax}),pL(0,ph,"constantMax",function(){return this._constantMax}),pL(0,ph,"constantMinSeparate",function(){return this._constantMinSeparate}),pL(0,ph,"constantMaxSeparate",function(){return this._constantMaxSeparate}),pL(0,ph,"gradientXMin",function(){return this._gradientXMin}),pL(0,ph,"gradientXMax",function(){return this._gradientXMax}),pL(0,ph,"gradientYMin",function(){return this._gradientYMin}),pL(0,ph,"gradientYMax",function(){return this._gradientYMax}),pL(0,ph,"gradientZMin",function(){return this._gradientZMin}),pL(0,ph,"gradientZMax",function(){return this._gradientZMax}),pB.createByGradient=function(ph){var pq=new pB;return pq._type=0,pq._separateAxes=!1,pq._gradient=ph,pq},pB.createByGradientSeparate=function(ph,pq,pf){var pg=new pB;return pg._type=0,pg._separateAxes=!0,pg._gradientX=ph,pg._gradientY=pq,pg._gradientZ=pf,pg},pB.createByRandomTwoConstant=function(ph,pq){var pf=new pB;return pf._type=1,pf._separateAxes=!1,pf._constantMin=ph,pf._constantMax=pq,pf},pB.createByRandomTwoConstantSeparate=function(ph,pq){var pf=new pB;return pf._type=1,pf._separateAxes=!0,pf._constantMinSeparate=ph,pf._constantMaxSeparate=pq,pf},pB.createByRandomTwoGradient=function(ph,pq){var pf=new pB;return pf._type=2,pf._separateAxes=!1,pf._gradientMin=ph,pf._gradientMax=pq,pf},pB.createByRandomTwoGradientSeparate=function(ph,pq,pf,pg,p$,pP){var pS=new pB;return pS._type=2,pS._separateAxes=!0,pS._gradientXMin=ph,pS._gradientXMax=pq,pS._gradientYMin=pf,pS._gradientYMax=pg,pS._gradientZMin=p$,pS._gradientZMax=pP,pS},pB}()),pI=function(){function pB(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}pv(pB,"laya.d3.core.particleShuriKen.module.GradientVelocity");var ph=pB.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.cloneTo=function(ph){var pq=ph;pq._type=this._type,this._constant.cloneTo(pq._constant),this._gradientX.cloneTo(pq._gradientX),this._gradientY.cloneTo(pq._gradientY),this._gradientZ.cloneTo(pq._gradientZ),this._constantMin.cloneTo(pq._constantMin),this._constantMax.cloneTo(pq._constantMax),this._gradientXMin.cloneTo(pq._gradientXMin),this._gradientXMax.cloneTo(pq._gradientXMax),this._gradientYMin.cloneTo(pq._gradientYMin),this._gradientYMax.cloneTo(pq._gradientYMax),this._gradientZMin.cloneTo(pq._gradientZMin),this._gradientZMax.cloneTo(pq._gradientZMax)},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,ph,"gradientZ",function(){return this._gradientZ}),pL(0,ph,"constant",function(){return this._constant}),pL(0,ph,"type",function(){return this._type}),pL(0,ph,"gradientXMax",function(){return this._gradientXMax}),pL(0,ph,"constantMin",function(){return this._constantMin}),pL(0,ph,"gradientX",function(){return this._gradientX}),pL(0,ph,"gradientY",function(){return this._gradientY}),pL(0,ph,"gradientXMin",function(){return this._gradientXMin}),pL(0,ph,"constantMax",function(){return this._constantMax}),pL(0,ph,"gradientYMin",function(){return this._gradientYMin}),pL(0,ph,"gradientYMax",function(){return this._gradientYMax}),pL(0,ph,"gradientZMin",function(){return this._gradientZMin}),pL(0,ph,"gradientZMax",function(){return this._gradientZMax}),pB.createByConstant=function(ph){var pq=new pB;return pq._type=0,pq._constant=ph,pq},pB.createByGradient=function(ph,pq,pf){var pg=new pB;return pg._type=1,pg._gradientX=ph,pg._gradientY=pq,pg._gradientZ=pf,pg},pB.createByRandomTwoConstant=function(ph,pq){var pf=new pB;return pf._type=2,pf._constantMin=ph,pf._constantMax=pq,pf},pB.createByRandomTwoGradient=function(ph,pq,pf,pg,p$,pP){var pS=new pB;return pS._type=3,pS._gradientXMin=ph,pS._gradientXMax=pq,pS._gradientYMin=pf,pS._gradientYMax=pg,pS._gradientZMin=p$,pS._gradientZMax=pP,pS},pB}(),pw=(function(){function ph(ph){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=ph}pv(ph,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.cloneTo=function(ph){var pq=ph;this._angularVelocity.cloneTo(pq._angularVelocity),pq.enbale=this.enbale},pq.clone=function(){var ph;switch(this._angularVelocity.type){case 0:ph=this._angularVelocity.separateAxes?pM.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):pM.createByConstant(this._angularVelocity.constant);break;case 1:ph=this._angularVelocity.separateAxes?pM.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):pM.createByGradient(this._angularVelocity.gradient.clone());break;case 2:ph=this._angularVelocity.separateAxes?pM.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):pM.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:ph=this._angularVelocity.separateAxes?pM.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):pM.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var pq=new this.constructor(ph);return pq.enbale=this.enbale,pq},pL(0,pq,"angularVelocity",function(){return this._angularVelocity})}(),function(){function ph(){this.enable=!1,this.randomDirection=!1}pv(ph,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.core.IClone":!0}),pq._getShapeBoundBox=function(ph){throw new Error("BaseShape: must override it.")},pq._getSpeedBoundBox=function(ph){throw new Error("BaseShape: must override it.")},pq.generatePositionAndDirection=function(ph,pq,pf,pg){throw new Error("BaseShape: must override it.")},pq._calculateProceduralBounds=function(ph,pq,pf){this._getShapeBoundBox(ph);var pg=ph.min,p$=ph.max;pSq.multiply(pg,pq,pg),pSq.multiply(p$,pq,p$);var pP=new poh(new pSq,new pSq);this.randomDirection?(pP.min=new pSq(-1,-1,-1),pP.max=new pSq(1,1,1)):this._getSpeedBoundBox(pP);var pS=new poh(new pSq,new pSq),pB=pS.min,pr=pS.max;pSq.scale(pP.min,pf.y,pB),pSq.scale(pP.max,pf.y,pr),pSq.add(ph.min,pB,pB),pSq.add(ph.max,pr,pr),pSq.min(ph.min,pB,ph.min),pSq.max(ph.max,pB,ph.max);var pY=new poh(new pSq,new pSq),pC=pY.min,pU=pY.max;pSq.scale(pP.min,pf.x,pC),pSq.scale(pP.max,pf.x,pU),pSq.min(pY.min,pU,pB),pSq.max(pY.min,pU,pr),pSq.min(ph.min,pB,ph.min),pSq.max(ph.max,pB,ph.max)},pq.cloneTo=function(ph){ph.enable=this.enable},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},ph}()),pV=function(){function pP(){}return pv(pP,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),pP._randomPointUnitArcCircle=function(ph,pq,pf){var pg=pq.elements,p$=NaN;p$=pf?pf.getFloat()*ph:Math.random()*ph,pg[0]=Math.cos(p$),pg[1]=Math.sin(p$)},pP._randomPointInsideUnitArcCircle=function(ph,pq,pf){var pg=pq.elements;pP._randomPointUnitArcCircle(ph,pq,pf);var p$=NaN;p$=pf?Math.pow(pf.getFloat(),.5):Math.pow(Math.random(),.5),pg[0]=pg[0]*p$,pg[1]=pg[1]*p$},pP._randomPointUnitCircle=function(ph,pq){var pf=ph.elements,pg=NaN;pg=pq?pq.getFloat()*Math.PI*2:Math.random()*Math.PI*2,pf[0]=Math.cos(pg),pf[1]=Math.sin(pg)},pP._randomPointInsideUnitCircle=function(ph,pq){var pf=ph.elements;pP._randomPointUnitCircle(ph);var pg=NaN;pg=pq?Math.pow(pq.getFloat(),.5):Math.pow(Math.random(),.5),pf[0]=pf[0]*pg,pf[1]=pf[1]*pg},pP._randomPointUnitSphere=function(ph,pq){var pf=ph.elements,pg=NaN,p$=NaN;p$=pq?(pg=pf[2]=2*pq.getFloat()-1,pq.getFloat()*Math.PI*2):(pg=pf[2]=2*Math.random()-1,Math.random()*Math.PI*2);var pP=Math.sqrt(1-pg*pg);pf[0]=pP*Math.cos(p$),pf[1]=pP*Math.sin(p$)},pP._randomPointInsideUnitSphere=function(ph,pq){var pf=ph.elements;pP._randomPointUnitSphere(ph);var pg=NaN;pg=pq?Math.pow(pq.getFloat(),1/3):Math.pow(Math.random(),1/3),pf[0]=pf[0]*pg,pf[1]=pf[1]*pg,pf[2]=pf[2]*pg},pP._randomPointInsideHalfUnitBox=function(ph,pq){var pf=ph.elements;pq?(pf[0]=pq.getFloat()-.5,pf[1]=pq.getFloat()-.5,pf[2]=pq.getFloat()-.5):(pf[0]=Math.random()-.5,pf[1]=Math.random()-.5,pf[2]=Math.random()-.5)},pP}(),pK=(function(){function ph(ph){this._size=null,this.enbale=!1,this._size=ph}pv(ph,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.cloneTo=function(ph){var pq=ph;this._size.cloneTo(pq._size),pq.enbale=this.enbale},pq.clone=function(){var ph;switch(this._size.type){case 0:ph=this._size.separateAxes?pT.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):pT.createByGradient(this._size.gradient.clone());break;case 1:ph=this._size.separateAxes?pT.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):pT.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:ph=this._size.separateAxes?pT.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):pT.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var pq=new this.constructor(ph);return pq.enbale=this.enbale,pq},pL(0,pq,"size",function(){return this._size})}(),function(){function pg(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}pv(pg,"laya.d3.core.particleShuriKen.module.StartFrame");var ph=pg.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.cloneTo=function(ph){var pq=ph;pq._type=this._type,pq._constant=this._constant,pq._constantMin=this._constantMin,pq._constantMax=this._constantMax},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,ph,"constant",function(){return this._constant}),pL(0,ph,"type",function(){return this._type}),pL(0,ph,"constantMin",function(){return this._constantMin}),pL(0,ph,"constantMax",function(){return this._constantMax}),pg.createByConstant=function(ph){var pq=new pg;return pq._type=0,pq._constant=ph,pq},pg.createByRandomTwoConstant=function(ph,pq){var pf=new pg;return pf._type=1,pf._constantMin=ph,pf._constantMax=pq,pf},pg}()),py=(function(){function ph(ph,pq){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new pPq(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=ph,this._startFrame=pq}pv(ph,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.cloneTo=function(ph){var pq=ph;this.tiles.cloneTo(pq.tiles),pq.type=this.type,pq.randomRow=this.randomRow,this._frame.cloneTo(pq._frame),this._startFrame.cloneTo(pq._startFrame),pq.cycles=this.cycles,pq.enableUVChannels=this.enableUVChannels,pq.enable=this.enable},pq.clone=function(){var ph,pq;switch(this._frame.type){case 0:ph=pc.createByConstant(this._frame.constant);break;case 1:ph=pc.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:ph=pc.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:ph=pc.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:pq=pK.createByConstant(this._startFrame.constant);break;case 1:pq=pK.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var pf=new this.constructor(ph,pq);return this.tiles.cloneTo(pf.tiles),pf.type=this.type,pf.randomRow=this.randomRow,pf.cycles=this.cycles,pf.enableUVChannels=this.enableUVChannels,pf.enable=this.enable,pf},pL(0,pq,"frame",function(){return this._frame}),pL(0,pq,"startFrame",function(){return this._startFrame})}(),function(){function ph(ph){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=ph}pv(ph,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var pq=ph.prototype;pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.cloneTo=function(ph){var pq=ph;this._velocity.cloneTo(pq._velocity),pq.enbale=this.enbale,pq.space=this.space},pq.clone=function(){var ph;switch(this._velocity.type){case 0:ph=pI.createByConstant(this._velocity.constant.clone());break;case 1:ph=pI.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:ph=pI.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:ph=pI.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var pq=new this.constructor(ph);return pq.enbale=this.enbale,pq.space=this.space,pq},pL(0,pq,"velocity",function(){return this._velocity})}(),function(){function ph(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new puq,this._vb=pwq.create(ph._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=pIq.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=pWq.nameKey.getID("LINE"),this._shaderCompile=pXq._preCompileShader[this._sharderNameID]}pv(ph,"laya.d3.core.PhasorSpriter3D");var pq=ph.prototype;return pq.line=function(ph,pq,pf,pg){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ph.x,ph.y,ph.z,pq.x,pq.y,pq.z,pq.w),this.addVertex(pf.x,pf.y,pf.z,pg.x,pg.y,pg.z,pg.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},pq.circle=function(ph,pq,pf,pg,p$,pP){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*pq,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/pq,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*ph,Math.cos(this._tempNumver0)*ph,0,pf,pg,p$,pP),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},pq.plane=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=pg/2,this._tempNumver1=p$/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ph-this._tempNumver0,pq+this._tempNumver1,pf,pP,pS,pB,pr),this.addVertex(ph+this._tempNumver0,pq+this._tempNumver1,pf,pP,pS,pB,pr),this.addVertex(ph-this._tempNumver0,pq-this._tempNumver1,pf,pP,pS,pB,pr),this.addVertex(ph+this._tempNumver0,pq-this._tempNumver1,pf,pP,pS,pB,pr),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},pq.box=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=pg/2,this._tempNumver1=p$/2,this._tempNumver2=pP/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ph-this._tempNumver0,pq+this._tempNumver1,pf+this._tempNumver2,pS,pB,pr,pY),this.addVertex(ph+this._tempNumver0,pq+this._tempNumver1,pf+this._tempNumver2,pS,pB,pr,pY),this.addVertex(ph-this._tempNumver0,pq-this._tempNumver1,pf+this._tempNumver2,pS,pB,pr,pY),this.addVertex(ph+this._tempNumver0,pq-this._tempNumver1,pf+this._tempNumver2,pS,pB,pr,pY),this.addVertex(ph+this._tempNumver0,pq+this._tempNumver1,pf-this._tempNumver2,pS,pB,pr,pY),this.addVertex(ph-this._tempNumver0,pq+this._tempNumver1,pf-this._tempNumver2,pS,pB,pr,pY),this.addVertex(ph+this._tempNumver0,pq-this._tempNumver1,pf-this._tempNumver2,pS,pB,pr,pY),this.addVertex(ph-this._tempNumver0,pq-this._tempNumver1,pf-this._tempNumver2,pS,pB,pr,pY),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},pq.cone=function(ph,pq,pf,pg,p$,pP,pS){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*pf+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*pf>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/pf,this.addVertexIndex(0,pq,0,pg,p$,pP,pS,this._tempUint0),this.addVertexIndex(0,0,0,pg,p$,pP,pS,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<pf;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(ph*this._tempNumver2,0,ph*this._tempNumver3,pg,p$,pP,pS,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==pf-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(ph*this._tempNumver2,0,ph*this._tempNumver3,pg,p$,pP,pS,this._tempUint0+(this._tempInt0+pf)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==pf-1?this.addIndexes(this._tempUint1+pf+2):this.addIndexes(this._tempUint1+this._tempInt0+pf+1),this.addIndexes(this._tempUint1+this._tempInt0+pf),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},pq.boundingBoxLine=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ph,p$,pP,pS,pB,pr,pY),this.addVertex(pg,p$,pP,pS,pB,pr,pY),this.addVertex(ph,pq,pP,pS,pB,pr,pY),this.addVertex(pg,pq,pP,pS,pB,pr,pY),this.addVertex(pg,p$,pf,pS,pB,pr,pY),this.addVertex(ph,p$,pf,pS,pB,pr,pY),this.addVertex(pg,pq,pf,pS,pB,pr,pY),this.addVertex(ph,pq,pf,pS,pB,pr,pY),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},pq.addVertex=function(ph,pq,pf,pg,p$,pP,pS){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=ph,this._vbData[this._posInVBData+1]=pq,this._vbData[this._posInVBData+2]=pf,this._vbData[this._posInVBData+3]=pg,this._vbData[this._posInVBData+4]=p$,this._vbData[this._posInVBData+5]=pP,this._vbData[this._posInVBData+6]=pS,this._posInVBData+=this._floatSizePerVer,this},pq.addVertexIndex=function(ph,pq,pf,pg,p$,pP,pS,pB){return this._hasBegun||this.addVertexIndexException(),this._vbData[pB]=ph,this._vbData[pB+1]=pq,this._vbData[pB+2]=pf,this._vbData[pB+3]=pg,this._vbData[pB+4]=p$,this._vbData[pB+5]=pP,this._vbData[pB+6]=pS,(pB+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=pB),this},pq.addIndexes=function(ph){var pq=arguments;this._hasBegun||this.addVertexIndexException();for(var pf=0;pf<pq.length;pf++)this._ibData[this._posInIBData]=pq[pf],this._posInIBData++;return this},pq.begin=function(ph,pq){return this._hasBegun&&this.beginException0(),1!==ph&&4!==ph&&this.beginException1(),this._primitiveType=ph,this._camera=pq,this._hasBegun=!0,this},pq.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},pq.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(ph._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),pX.drawCall++,pd.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},pq.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},pq.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},pq.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},pq.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},pq.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},pq.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(28,[new pSh(0,"vector3",0),new pSh(12,"vector4",1)])}]),ph}()),pF=function(){function ph(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++ph._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new puq}pv(ph,"laya.d3.core.render.RenderElement");var pq=ph.prototype;return pq.getDynamicBatchBakedVertexs=function(ph){for(var pq=this._renderObj._getVertexBuffer(ph),pf=pq.getData().slice(),pg=pq.vertexDeclaration,p$=pg.getVertexElementByUsage(0).offset/4,pP=pg.getVertexElementByUsage(3).offset/4,pS=this._sprite3D.transform,pB=pS.worldMatrix,pr=pS.rotation,pY=pg.vertexStride/4,pC=0,pU=pf.length;pC<pU;pC+=pY){var pu=pC+p$,pv=pC+pP;plq.transformVector3ArrayToVector3ArrayCoordinate(pf,pu,pB,pf,pu),plq.transformVector3ArrayByQuat(pf,pv,pr,pf,pv)}return pf},pq.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},pq._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},pL(0,pq,"id",function(){return this._id}),pL(0,pq,"renderObj",function(){return this._renderObj},function(ph){this._renderObj!==ph&&(this._renderObj=ph)}),ph._uniqueIDCounter=0,ph}(),pZ=function(){function pq(ph){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++pq._uniqueIDCounter,this._needSort=!1,this._scene=ph,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}pv(pq,"laya.d3.core.render.RenderQueue");var ph=pq.prototype;return ph._sortOpaqueFunc=function(ph,pq){if(ph._render&&pq._render){var pf=ph._material.renderQueue-pq._material.renderQueue;return 0==pf?ph._render._distanceForSort-pq._render._distanceForSort:pf}return 0},ph._sortAlphaFunc=function(ph,pq){if(ph._render&&pq._render){var pf=ph._material.renderQueue-pq._material.renderQueue;return 0==pf?pq._render._distanceForSort-ph._render._distanceForSort:pf}return 0},ph._begainRenderElement=function(ph,pq,pf){return!!pq._beforeRender(ph)},ph._sortAlpha=function(ph){pq._cameraPosition=ph,this._finalElements.sort(this._sortAlphaFunc)},ph._sortOpaque=function(ph){pq._cameraPosition=ph,this._finalElements.sort(this._sortOpaqueFunc)},ph._preRender=function(ph){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},ph._render=function(ph,pq){for(var pf,pg,p$,pP,pS,pB,pr=pX.loopCount,pY=this._scene,pC=ph.camera,pU=(pC.id,!1),pu=0,pv=this._finalElements.length;pu<pv;pu++){var pL,pe,pl,p_=this._finalElements[pu];if(null!=p_._onPreRenderFunction&&p_._onPreRenderFunction.call(p_._sprite3D,ph),0===p_._type){if(ph.owner=pl=p_._sprite3D,ph.renderElement=p_,pl._preRenderUpdateComponents(ph),pL=p_.renderObj,pe=p_._material,this._begainRenderElement(ph,pL,pe)){if(pf=pL._getVertexBuffers(),!(p$=(pg=pL._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[pg.id]){this._errorRecord[pg.id]=1;var pN="vertexBuffer:"+("("+pg._destroyed+","+pg._released+","+pg._referenceCount+","+pg._buffer+")")+", material:"+(pe?pe.__className+"("+pe._destroyed+","+pe._released+")":"null")+", owner:"+(pl?pl.__className+"("+pl._destroyed+","+pl._activeInHierarchy+","+pl._displayedInStage+")":"null")+", renderObj:"+(pL?pL.__className+"("+pL._destroyed+","+pL._released+","+pL._referenceCount+")":"")+", parent:, url:"+(pl?pl.url:"")+", disposeStack:"+pg.disposeStack;pE.recordError("报错：unknown vertexDeclaration  "+pN)}continue}if(pU=(pP=ph._shader=pe._getShader(pY._shaderDefineValue,p$.shaderDefineValue,pl._shaderDefineValue)).bind()||pr!==pP._uploadLoopCount,pf){if(pP._uploadVertexBuffer!==pf||pU){for(var pG=0;pG<pf.length;pG++){var pm=pf[pG];pP.uploadAttributesX(pm.vertexDeclaration.shaderValues.data,pm)}pP._uploadVertexBuffer=pf}}else(pP._uploadVertexBuffer!==pg||pU)&&(pP.uploadAttributes(p$.shaderValues.data,null),pP._uploadVertexBuffer=pg);(pP._uploadScene!==pY||pU)&&(pP.uploadSceneUniforms(pY._shaderValues.data),pP._uploadScene=pY),(pC!==pP._uploadCamera||pP._uploadSprite3D!==pl||pU)&&(pP.uploadSpriteUniforms(pl._shaderValues.data),pP._uploadSprite3D=pl),(pC!==pP._uploadCamera||pU)&&(pP.uploadCameraUniforms(pC._shaderValues.data),pP._uploadCamera=pC),(pP._uploadMaterial!==pe||pU)&&(pe._upload(),pP._uploadMaterial=pe),pS!==pe?(pe._setRenderStateBlendDepth(),pe._setRenderStateFrontFace(pq,pl.transform),pS=pe,pB=pl):pB!==pl&&(pe._setRenderStateFrontFace(pq,pl.transform),pB=pl),pL._render(ph),pP._uploadLoopCount=pr}pl._postRenderUpdateComponents(ph)}else if(2===p_._type){p_.renderObj;ph.owner=pl=p_._sprite3D,ph.renderElement=p_,ph._batchIndexStart=p_._tempBatchIndexStart,ph._batchIndexEnd=p_._tempBatchIndexEnd,pL=p_.renderObj,pe=p_._material,this._begainRenderElement(ph,pL,pe)&&(p$=(pg=pL._getVertexBuffer(0)).vertexDeclaration,pU=(pP=ph._shader=pe._getShader(pY._shaderDefineValue,p$.shaderDefineValue,pl._shaderDefineValue)).bind()||pr!==pP._uploadLoopCount,(pP._uploadVertexBuffer!==pg||pU)&&(pP.uploadAttributes(p$.shaderValues.data,null),pP._uploadVertexBuffer=pg),(pP._uploadScene!==pY||pU)&&(pP.uploadSceneUniforms(pY._shaderValues.data),pP._uploadScene=pY),(pC!==pP._uploadCamera||pP._uploadSprite3D!==pl||pU)&&(pP.uploadSpriteUniforms(pl._shaderValues.data),pP._uploadSprite3D=pl),(pC!==pP._uploadCamera||pU)&&(pP.uploadCameraUniforms(pC._shaderValues.data),pP._uploadCamera=pC),(pP._uploadMaterial!==pe||pU)&&(pe._upload(),pP._uploadMaterial=pe),pS!==pe?(pe._setRenderStateBlendDepth(),pe._setRenderStateFrontFace(pq,pl.transform),pS=pe,pB=pl):pB!==pl&&(pe._setRenderStateFrontFace(pq,pl.transform),pB=pl),pL._render(ph),pP._uploadLoopCount=pr)}}},ph._renderShadow=function(ph,pq){for(var pf,pg,p$,pP,pS,pB=pX.loopCount,pr=this._scene,pY=ph.camera,pC=!1,pU=0,pu=this._finalElements.length;pU<pu;pU++){var pv,pL,pe,pl=this._finalElements[pU];0===pl._type&&(ph.owner=pe=pl._sprite3D,pq||pe._projectionViewWorldUpdateCamera===pY&&pe._projectionViewWorldUpdateLoopCount===pX.loopCount||(pe._render._renderUpdate(ph._projectionViewMatrix),pe._projectionViewWorldUpdateLoopCount=pX.loopCount,pe._projectionViewWorldUpdateCamera=pY),ph.renderElement=pl,pe._preRenderUpdateComponents(ph),pv=pl.renderObj,pL=pl._material,this._begainRenderElement(ph,pv,null)&&(pg=(pf=pv._getVertexBuffer(0)).vertexDeclaration,pC=(p$=ph._shader=pL._getShader(pr._shaderDefineValue,pg.shaderDefineValue,pe._shaderDefineValue)).bind()||pB!==p$._uploadLoopCount,(p$._uploadVertexBuffer!==pf||pC)&&(p$.uploadAttributes(pg.shaderValues.data,null),p$._uploadVertexBuffer=pf),(pY!==p$._uploadCamera||p$._uploadSprite3D!==pe||pC)&&(p$.uploadSpriteUniforms(pe._shaderValues.data),p$._uploadSprite3D=pe),(pY!==p$._uploadCamera||pC)&&(p$.uploadCameraUniforms(pY._shaderValues.data),p$._uploadCamera=pY),(p$._uploadMaterial!==pL||pC)&&(pL._upload(),p$._uploadMaterial=pL),p$._uploadRenderElement,pP!==pL?(pL._setRenderStateFrontFace(!1,pe.transform),pP=pL,pS=pe):pS!==pe&&(pL._setRenderStateFrontFace(!1,pe.transform),pS=pe),pv._render(ph),p$._uploadLoopCount=pB),pe._postRenderUpdateComponents(ph))}},ph._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},ph._addRenderElement=function(ph){this._renderElements.push(ph),this._needSort=!0},ph._addDynamicBatchElement=function(ph){this._dynamicBatchCombineRenderElements.push(ph)},pL(0,ph,"id",function(){return this._id}),pq._uniqueIDCounter=0,pq._cameraPosition=null,pq}(),pQ=function(){function ph(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return pv(ph,"laya.d3.core.render.RenderState"),ph.clientWidth=0,ph.clientHeight=0,ph}(),po=function(){function pS(ph,pq){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new pjh(new pSq,0),this._corners=[new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq],this._boundingBoxCenter=new pSq,this._children=pg(8),this._objects=[],this._tempBoundBoxCorners=[new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq],this._scene=ph,this._currentDepth=pq}pv(pS,"laya.d3.core.scene.OctreeNode");var ph=pS.prototype;return pE.imps(ph,{"laya.d3.core.scene.ITreeNode":!0}),ph.init=function(ph,pq){var pf=new pSq,pg=new pSq;pSq.scale(pq,-.5,pf),pSq.scale(pq,.5,pg),pSq.add(pf,ph,pf),pSq.add(pg,ph,pg),this.exactBox=new poh(pf,pg),this.relaxBox=new poh(pf,pg)},ph.addTreeNode=function(ph){1===Collision.boxContainsBox(this._relaxBox,ph.boundingBox)?this.addNodeDown(ph,0):this.addObject(ph)},ph.addChild=function(ph){var pq=this._children[ph];if(null==pq){pq=new pS(this._scene,this._currentDepth+1),(this._children[ph]=pq)._parent=this,pSq.subtract(this._exactBox.max,this._exactBox.min,pS.tempSize),pSq.multiply(pS.tempSize,pS._octreeSplit[ph],pS.tempCenter),pSq.add(this._exactBox.min,pS.tempCenter,pS.tempCenter),pSq.scale(pS.tempSize,.25,pS.tempSize);var pf=new pSq,pg=new pSq;pSq.subtract(pS.tempCenter,pS.tempSize,pf),pSq.add(pS.tempCenter,pS.tempSize,pg),pq.exactBox=new poh(pf,pg),pSq.scale(pS.tempSize,pS.relax,pS.tempSize);var p$=new pSq,pP=new pSq;pSq.subtract(pS.tempCenter,pS.tempSize,p$),pSq.add(pS.tempCenter,pS.tempSize,pP),pq.relaxBox=new poh(p$,pP)}return pq},ph.addObject=function(ph){(ph._treeNode=this)._objects.push(ph)},ph.removeObject=function(ph){if(ph._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var pq=this._objects.indexOf(ph);return-1!==pq&&(this._objects.splice(pq,1),!0)},ph.clearObject=function(){this._objects.length=0},ph.addNodeUp=function(ph,pq){this._parent&&1!==Collision.boxContainsBox(this._exactBox,ph.boundingBox)?this._parent.addNodeUp(ph,pq-1):this.addNodeDown(ph,pq)},ph.addNodeDown=function(ph,pq){if(pq<this._scene.treeLevel){var pf=this.inChildIndex(ph.boundingBoxCenter),pg=this.addChild(pf);1===Collision.boxContainsBox(pg._relaxBox,ph.boundingBox)?pg.addNodeDown(ph,++pq):this.addObject(ph)}else this.addObject(ph)},ph.inChildIndex=function(ph){return 4*(ph.z<this._boundingBoxCenter.z?0:1)+2*(ph.y<this._boundingBoxCenter.y?0:1)+(ph.x<this._boundingBoxCenter.x?0:1)},ph.updateObject=function(ph){1===Collision.boxContainsBox(this._relaxBox,ph.boundingBox)?(this.removeObject(ph),ph._treeNode=null,this.addNodeDown(ph,this._currentDepth)):this._parent&&(this.removeObject(ph),ph._treeNode=null,this._parent.addNodeUp(ph,this._currentDepth-1))},ph.cullingObjects=function(ph,pq,pf,pg,p$){var pP,pS=0,pB=0,pr=0,pY=this._scene._dynamicBatchManager;for(pS=0,pP=this._objects.length;pS<pP;pS++){var pC=this._objects[pS];if(pz.isVisible(pC._owner.layer.mask)&&pC.enable){if(pq&&(pX.treeSpriteCollision+=1,0===ph.containsBoundSphere(pC.boundingSphere)))continue;pC._renderUpdate(p$),pC._distanceForSort=pSq.distance(pC.boundingSphere.center,pg)+pC.sortingFudge;var pU=pC._renderElements;for(pB=0,pr=pU.length;pB<pr;pB++){var pu=pU[pB],pv=pu._staticBatch;if(pv&&pv._material===pu._material)pv._addBatchRenderElement(pu);else{var pL=pu.renderObj;pL.triangleCount<10&&1===pL._vertexBufferCount&&pL._getIndexBuffer()&&pu._material.renderQueue<2&&pu._canDynamicBatch&&!pC._owner.isStatic?pY._addPrepareRenderElement(pu):this._scene.getRenderQueue(pu._material.renderQueue)._addRenderElement(pu)}}}}for(pS=0;pS<8;pS++){var pe=this._children[pS];if(null!=pe){var pl=pq;if(pq){var p_=ph.containsBoundBox(pe._relaxBox);if(pX.treeNodeCollision+=1,0===p_)continue;pl=2===p_}pe.cullingObjects(ph,pl,pf,pg,p$)}}},ph.cullingShadowObjects=function(ph,pq,pf,pg,p$){var pP,pS=0,pB=0,pr=0;this._scene._dynamicBatchManager;for(pS=0,pP=this._objects.length;pS<pP;pS++){var pY=this._objects[pS];if(pY.castShadow&&pz.isVisible(pY._owner.layer.mask)&&pY.enable){if(pf&&0===ph[0].containsBoundSphere(pY.boundingSphere))continue;for(var pC=1,pU=ph.length;pC<pU;pC++){var pu=pq[pC-1];if(0!==ph[pC].containsBoundSphere(pY.boundingSphere)){var pv=pY._renderElements;for(pB=0,pr=pv.length;pB<pr;pB++)pu._addRenderElement(pv[pB])}}}}for(pS=0;pS<8;pS++){var pL=this._children[pS];if(null!=pL){var pe=pf;if(pf){var pl=ph[0].containsBoundBox(pL._relaxBox);if(0===pl)continue;pe=2===pl}pL.cullingShadowObjects(ph,pq,pe,pg,p$)}}},ph.cullingShadowObjectsOnePSSM=function(ph,pq,pf,pg,p$,pP){var pS,pB=pq[0],pr=0,pY=0,pC=0;for(pr=0,pS=this._objects.length;pr<pS;pr++){var pU=this._objects[pr];if(pU.castShadow&&pz.isVisible(pU._owner.layer.mask)&&pU.enable){if(pg&&0===ph.containsBoundSphere(pU.boundingSphere))continue;pU._renderUpdate(pf);var pu=pU._renderElements;for(pY=0,pC=pu.length;pY<pC;pY++)pB._addRenderElement(pu[pY])}}for(pr=0;pr<8;pr++){var pv=this._children[pr];if(null!=pv){var pL=pg;if(pg){var pe=ph.containsBoundBox(pv._relaxBox);if(0===pe)continue;pL=2===pe}pv.cullingShadowObjectsOnePSSM(ph,pq,pf,pL,p$,pP)}}},ph.renderBoudingBox=function(ph){this._renderBoudingBox(ph);for(var pq=0;pq<8;++pq){var pf=this._children[pq];pf&&pf.renderBoudingBox(ph)}},ph.buildAllChild=function(ph){if(ph<this._scene.treeLevel)for(var pq=0;pq<8;pq++){this.addChild(pq).buildAllChild(ph+1)}},ph._renderBoudingBox=function(ph){},pL(0,ph,"exactBox",function(){return this._exactBox},function(ph){this._exactBox=ph,pSq.add(ph.min,ph.max,this._boundingBoxCenter),pSq.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),pL(0,ph,"relaxBox",function(){return this._relaxBox},function(ph){(this._relaxBox=ph).getCorners(this._corners),pjh.createfromPoints(this._corners,this._boundingSphere)}),pS.debugMode=!1,pS.relax=1.15,pS.CHILDNUM=8,pU(pS,["tempVector0",function(){return this.tempVector0=new pSq},"tempSize",function(){return this.tempSize=new pSq},"tempCenter",function(){return this.tempCenter=new pSq},"_octreeSplit",function(){return this._octreeSplit=[new pSq(.25,.25,.25),new pSq(.75,.25,.25),new pSq(.25,.75,.25),new pSq(.75,.75,.25),new pSq(.25,.25,.75),new pSq(.75,.25,.75),new pSq(.25,.75,.75),new pSq(.75,.75,.75)]}]),pS}(),pO=(function(){function ph(){}pv(ph,"laya.d3.core.scene.SceneManager")}(),function(){function ph(ph,pq,pf,pg){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===ph&&(ph=1),void 0===pq&&(pq=1),void 0===pf&&(pf=1),void 0===pg&&(pg=1),this._r=ph,this._g=pq,this._b=pf,this._a=pg}return pv(ph,"laya.d3.core.trail.module.Color",null,"Color$1"),ph.prototype.cloneTo=function(ph){ph._r=this._r,ph._g=this._g,ph._b=this._b,ph._a=this._a},pU(ph,["RED",function(){return this.RED=new ph(1,0,0,1)},"GREEN",function(){return this.GREEN=new ph(0,1,0,1)},"BLUE",function(){return this.BLUE=new ph(0,0,1,1)},"CYAN",function(){return this.CYAN=new ph(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new ph(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new ph(1,0,1,1)},"GRAY",function(){return this.GRAY=new ph(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new ph(1,1,1,1)},"BLACK",function(){return this.BLACK=new ph(0,0,0,1)}]),ph}()),pj=(function(){function ph(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}pv(ph,"laya.d3.core.trail.module.Gradient");var pq=ph.prototype;pq.setKeys=function(ph,pq){var pf,pg;this._colorKeys=ph;for(var p$=this.index=0;p$<ph.length;p$++){var pP=(pf=ph[p$]).color;this._colorKeyData[this.index++]=pP._r,this._colorKeyData[this.index++]=pP._g,this._colorKeyData[this.index++]=pP._b,this._colorKeyData[this.index++]=pf.time}this._alphaKeys=pq;for(var pS=this.index=0;pS<pq.length;pS++)pg=pq[pS],this._alphaKeyData[this.index++]=pg.alpha,this._alphaKeyData[this.index++]=pg.time},pq.cloneTo=function(ph){var pq=0,pf=0,pg=this.colorKeys,p$=[];for(pq=0,pf=pg.length;pq<pf;pq++){var pP=new px;pg[pq].cloneTo(pP),p$.push(pP)}var pS=this.alphaKeys,pB=[];for(pq=0,pf=pS.length;pq<pf;pq++){var pr=new pj;pS[pq].cloneTo(pr),pB.push(pr)}ph.setKeys(p$,pB)},pL(0,pq,"mode",function(){return this._mode},function(ph){this._mode=ph}),pL(0,pq,"colorKeys",function(){return this._colorKeys},function(ph){this._colorKeys=ph;for(var pq=this.index=0;pq<ph.length;pq++){var pf=ph[pq],pg=pf.color;this._colorKeyData[this.index++]=pg._r,this._colorKeyData[this.index++]=pg._g,this._colorKeyData[this.index++]=pg._b,this._colorKeyData[this.index++]=pf.time}}),pL(0,pq,"alphaKeys",function(){return this._alphaKeys},function(ph){this._alphaKeys=ph;for(var pq=this.index=0;pq<ph.length;pq++){var pf=ph[pq];this._alphaKeyData[this.index++]=pf.alpha,this._alphaKeyData[this.index++]=pf.time}})}(),function(){function ph(ph,pq){this._alpha=NaN,this._time=NaN,void 0===ph&&(ph=0),void 0===pq&&(pq=0),this._alpha=ph,this._time=pq}pv(ph,"laya.d3.core.trail.module.GradientAlphaKey");var pq=ph.prototype;return pq.cloneTo=function(ph){ph.alpha=this.alpha,ph.time=this.time},pL(0,pq,"alpha",function(){return this._alpha},function(ph){this._alpha=ph}),pL(0,pq,"time",function(){return this._time},function(ph){this._time=ph}),ph}()),px=function(){function ph(ph,pq){this._color=null,this._time=NaN,void 0===pq&&(pq=0),this._color=ph||new pO,this._time=pq}pv(ph,"laya.d3.core.trail.module.GradientColorKey");var pq=ph.prototype;return pq.cloneTo=function(ph){this.color.cloneTo(ph.color),ph.time=this.time},pL(0,pq,"color",function(){return this._color},function(ph){this._color=ph}),pL(0,pq,"time",function(){return this._time},function(ph){this._time=ph}),ph}(),pa=(function(){function ph(){}pv(ph,"laya.d3.core.trail.module.GradientMode"),ph.Blend=0,ph.Fixed=1}(),function(){function ph(){}pv(ph,"laya.d3.core.trail.module.TextureMode"),ph.Stretch=0,ph.Tile=1}(),function(){function ph(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}pv(ph,"laya.d3.core.trail.module.TrailKeyFrame"),ph.prototype.cloneTo=function(ph){ph.time=this.time,ph.inTangent=this.inTangent,ph.outTangent=this.outTangent,ph.value=this.value}}(),function(){function pq(ph){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new pSq,this._curPosition=new pSq,this._delVector3=new pSq,this._lastFixedVertexPosition=new pSq,this._pointAtoBVector3=new pSq,this._pointA=new pSq,this._pointB=new pSq,this._owner=ph,this._id=pq.renderElementCount++,0==this._id?ph._owner.transform.position.cloneTo(this._lastPosition):ph._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new pwq(pa.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new pwq(pa.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}pv(pq,"laya.d3.core.trail.TrailRenderElement");var ph=pq.prototype;pE.imps(ph,{"laya.d3.core.render.IRenderable":!0}),ph._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},ph._addTrailByFirstPosition=function(ph,pq){pSq.subtract(pq,ph,this._delVector3),pSq.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),pSq.normalize(this._pointAtoBVector3,this._pointAtoBVector3),pSq.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(ph),ph.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},ph._addTrailByNextPosition=function(ph){pSq.subtract(ph,this._lastFixedVertexPosition,this._delVector3),pSq.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),pSq.normalize(this._pointAtoBVector3,this._pointAtoBVector3),pSq.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=pSq.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=pxh.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(ph),ph.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(ph),this._virtualVerticesCount=2)},ph._updateVerticesByPosition=function(ph){this._pointe=ph.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},ph._updateVertexBuffer2=function(){var ph,pq=0,pf=0,pg=0;for(pg=0,ph=(this._verticesCount+this._virtualVerticesCount)/2;pg<ph;pg++)pf=0==this._owner.textureMode?(this._VerticesToTailLength[pg]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[pg],this._vertices2[pq++]=1-pf,this._vertices2[pq++]=1-pf;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},ph._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},ph._updateDisappear=function(){var ph,pq=0;for(pq=this._curDisappearIndex,ph=(this._verticesCount+this._virtualVerticesCount)/2;pq<ph;pq++)this._owner._curtime-this._everyGroupVertexBirthTime[pq]>=this._owner.time+pxh.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},ph._beforeRender=function(ph){return this._camera=ph.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),pSq.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},ph._render=function(ph){this._isDead||(pd.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),pX.drawCall++,pX.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},ph._getVertexBuffer=function(ph){return void 0===ph&&(ph=0),0===ph?this._vertexBuffer1:1===ph?this._vertexBuffer2:null},ph._getVertexBuffers=function(){return this._vertexBuffers},ph._getIndexBuffer=function(){return null},ph.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},ph._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},pL(0,ph,"_vertexBufferCount",function(){return this._vertexBuffers.length}),pL(0,ph,"triangleCount",function(){return 0}),pq.renderElementCount=0}(),function(){function ph(){}pv(ph,"laya.d3.core.trail.VertexTrail");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration1}),pL(1,ph,"vertexDeclaration1",function(){return ph._vertexDeclaration1}),pL(1,ph,"vertexDeclaration2",function(){return ph._vertexDeclaration2}),pU(ph,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new pPh(32,[new pSh(0,"vector3",0),new pSh(12,"vector3",41),new pSh(24,"single",33),new pSh(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new pPh(4,[new pSh(0,"single",38)])}]),ph}()),phh=function(){function pm(ph){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=ph}pv(pm,"laya.d3.graphics.DynamicBatch");var ph=pm.prototype;return pE.imps(ph,{"laya.d3.core.render.IRenderable":!0}),ph._getVertexBuffer=function(ph){return void 0===ph&&(ph=0),0===ph?this._vertexBuffer:null},ph._getIndexBuffer=function(){return this._indexBuffer},ph._getCombineRenderElementFromPool=function(ph,pq,pf){var pg=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return pg||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=pg=new pF,pg._sprite3D=new pZq),pg._sprite3D._render._renderUpdate(pf),pg},ph._getRenderElement=function(ph,pq,pf){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*pm.maxVertexCount),this._indexDatas=new Uint16Array(pm.maxIndexCount),this._vertexBuffer=pwq.create(this._vertexDeclaration,pm.maxVertexCount,35048),this._indexBuffer=pIq.create("ushort",pm.maxIndexCount,35048));for(var pg=this._merageElements.length=0,p$=0,pP=0,pS=this._combineRenderElements.length;pP<pS;pP++){var pB=this._combineRenderElements[pP],pr=pB.getDynamicBatchBakedVertexs(0),pY=pB.getBakedIndices(),pC=pB._sprite3D.transform._isFrontFaceInvert,pU=pg/(this._vertexDeclaration.vertexStride/4),pu=p$,pv=pu+pY.length;pB._tempBatchIndexStart=pu,pB._tempBatchIndexEnd=pv,this._indexDatas.set(pY,p$);var pL=0;if(pC)for(pL=pu;pL<pv;pL+=3){this._indexDatas[pL]=pU+this._indexDatas[pL];var pe=this._indexDatas[pL+1],pl=this._indexDatas[pL+2];this._indexDatas[pL+1]=pU+pl,this._indexDatas[pL+2]=pU+pe}else for(pL=pu;pL<pv;pL+=3)this._indexDatas[pL]=pU+this._indexDatas[pL],this._indexDatas[pL+1]=pU+this._indexDatas[pL+1],this._indexDatas[pL+2]=pU+this._indexDatas[pL+2];p$+=pY.length,this._vertexDatas.set(pr,pg),pg+=pr.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),pP=this._combineRenderElementPoolIndex=0,pS=this._materials.length;pP<pS;pP++){var p_=this._getCombineRenderElementFromPool(ph,pq,pf);p_._type=2,p_._staticBatch=null;var pN=(p_.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[pP]]._tempBatchIndexStart,pG=pP+1===this._materialToRenderElementsOffsets.length?p$:this._combineRenderElements[this._materialToRenderElementsOffsets[pP+1]]._tempBatchIndexStart;p_._tempBatchIndexStart=pN,p_._tempBatchIndexEnd=pG,p_._material=this._materials[pP],this._merageElements.push(p_)}},ph._addCombineRenderObjTest=function(ph){var pq=ph.renderObj,pf=this._currentCombineIndexCount+pq._getIndexBuffer().indexCount,pg=this._currentCombineVertexCount+pq._getVertexBuffer().vertexCount;return!(pm.maxVertexCount<pg||pm.maxIndexCount<pf)},ph._addCombineRenderObj=function(ph){var pq=ph.renderObj;this._combineRenderElements.push(ph),this._currentCombineIndexCount=this._currentCombineIndexCount+pq._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+pq._getVertexBuffer().vertexCount},ph._addCombineMaterial=function(ph){this._materials.push(ph)},ph._addMaterialToRenderElementOffset=function(ph){this._materialToRenderElementsOffsets.push(ph)},ph._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},ph._addToRenderQueue=function(ph,pq,pf,pg){this._getRenderElement(pq,pf,pg);for(var p$=0,pP=this._materials.length;p$<pP;p$++)ph.getRenderQueue(this._materials[p$].renderQueue)._addDynamicBatchElement(this._merageElements[p$])},ph._beforeRender=function(ph){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},ph._render=function(ph){var pq=ph._batchIndexEnd-ph._batchIndexStart;pd.mainContext.drawElements(4,pq,5123,2*ph._batchIndexStart),pX.drawCall++,pX.trianglesFaces+=pq/3},ph._getVertexBuffers=function(){return null},pL(0,ph,"_vertexBufferCount",function(){return 1}),pL(0,ph,"triangleCount",function(){return this._indexBuffer.indexCount/3}),pL(0,ph,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),pm.maxVertexCount=2e4,pm.maxIndexCount=4e4,pm.maxCombineTriangleCount=10,pm}(),pqh=function(){function pm(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}pv(pm,"laya.d3.graphics.DynamicBatchManager");var ph=pm.prototype;return ph.getDynamicBatch=function(ph,pq){var pf,pg=ph.id.toString()+pq;return this._dynamicBatches[pg]?pf=this._dynamicBatches[pg]:this._dynamicBatches[pg]=pf=new phh(ph),pf},ph._garbageCollection=function(){for(var ph in this._dynamicBatches)0===this._dynamicBatches[ph].combineRenderElementsCount&&delete this._dynamicBatches[ph]},ph._addPrepareRenderElement=function(ph){this._prepareDynamicBatchCombineElements.push(ph)},ph._finishCombineDynamicBatch=function(ph){var pq,pf,pg;this._prepareDynamicBatchCombineElements.sort(pm._sortPrepareDynamicBatch);for(var p$,pP,pS,pB,pr,pY=-1,pC=!0,pU=0,pu=-1,pv=0,pL=this._prepareDynamicBatchCombineElements.length;pv<pL;pv++){var pe=(pP=this._prepareDynamicBatchCombineElements[pv]).renderObj._getVertexBuffer(0).vertexDeclaration,pl=pf!==pe;pl&&(pU=0,pf=pe);var p_=pU!==pY;if(p_&&(pY=pU),(pl||p_)&&(pS=this.getDynamicBatch(pe,pU),pq=null),pC)if(pS._addCombineRenderObjTest(pP)){if(pq!==(p$=pP._material))pB&&(ph.getRenderQueue(pr._material.renderQueue)._addRenderElement(pr),pr=pB=null,pu=-1),pB=p$,pu=pS.combineRenderElementsCount,pr=pP,pq=p$;else if(pB){var pN=pr.renderObj,pG=pP.renderObj;pN._getVertexBuffer().vertexCount+pG._getVertexBuffer().vertexCount>phh.maxVertexCount||pN._getIndexBuffer().indexCount+pG._getIndexBuffer().indexCount>phh.maxIndexCount?(ph.getRenderQueue(pr._material.renderQueue)._addRenderElement(pr),pB=p$,pu=pS.combineRenderElementsCount,pr=pP):(pS._addCombineMaterial(pB),pS._addMaterialToRenderElementOffset(pu),pS._addCombineRenderObj(pr),pr=pB=null,pu=-1,pS._addCombineRenderObj(pP))}else pS._addCombineRenderObj(pP);pC=!0}else pB&&(ph.getRenderQueue(pr._material.renderQueue)._addRenderElement(pr),pr=pB=null,pu=-1),pU++,pC=!1;else pg=this._prepareDynamicBatchCombineElements[pv-1],pS._addMaterialToRenderElementOffset(pS.combineRenderElementsCount),pq=pg._material,pS._addCombineMaterial(pq),pS._addCombineRenderObj(pg),pC=!0,pq!==(p$=pP._material)?(pB=p$,pu=pS.combineRenderElementsCount,pr=pP):pS._addCombineRenderObj(pP),pq=p$}pB&&(ph.getRenderQueue(pr._material.renderQueue)._addRenderElement(pr),pr=pB=null,pu=-1),this._prepareDynamicBatchCombineElements.length=0},ph._clearRenderElements=function(){for(var ph in this._dynamicBatches)this._dynamicBatches[ph]._clearRenderElements()},ph._addToRenderQueue=function(ph,pq,pf,pg){for(var p$ in this._dynamicBatches){var pP=this._dynamicBatches[p$];0<pP.combineRenderElementsCount&&pP._addToRenderQueue(ph,pq,pf,pg)}},ph.dispose=function(){this._dynamicBatches=null},pm._sortPrepareDynamicBatch=function(ph,pq){return ph._mainSortID-pq._mainSortID},pm}(),pfh=function(){function ph(){}return pv(ph,"laya.d3.graphics.FrustumCulling"),ph.renderShadowObjectCulling=function(ph,pq,pf,pg,p$){var pP=0,pS=0,pB=0,pr=0;for(pP=0,pB=pf.length;pP<pB;pP++){var pY=pf[pP];pY&&pY._clearRenderElements()}var pC,pU,pu,pv=ph._cullingRenders;if(1<p$){for(pP=0,pB=ph._cullingRendersLength;pP<pB;pP++)if((pC=pv[pP]).castShadow&&pz.isVisible(pC._owner.layer.mask)&&pC.enable)for(var pL=1,pe=pq.length;pL<pe;pL++)if(pU=pf[pL-1],0!==pq[pL].containsBoundSphere(pC.boundingSphere))for(pS=0,pr=(pu=pC._renderElements).length;pS<pr;pS++)pU._addRenderElement(pu[pS])}else for(pP=0,pB=ph._cullingRendersLength;pP<pB;pP++)if((pC=pv[pP]).castShadow&&pz.isVisible(pC._owner.layer.mask)&&pC.enable&&0!==pq[0].containsBoundSphere(pC.boundingSphere))for(pC._renderUpdate(pg),pU=pf[0],pS=0,pr=(pu=pC._renderElements).length;pS<pr;pS++)pU._addRenderElement(pu[pS])},ph.renderShadowObjectCullingOctree=function(ph,pq,pf,pg,p$){for(var pP=0,pS=pf.length;pP<pS;pP++){var pB=pf[pP];pB&&pB._clearRenderElements()}1<p$?ph.treeRoot.cullingShadowObjects(pq,pf,!0,0,ph):ph.treeRoot.cullingShadowObjectsOnePSSM(pq[0],pf,pg,!0,0,ph)},ph.renderObjectCulling=function(ph,pq,pf,pg,p$,pP){var pS=0,pB=0,pr=0,pY=0,pC=pq._quenes,pU=pq._dynamicBatchManager,pu=pq._cullingRenders;for(pS=0,pB=pC.length;pS<pB;pS++){var pv=pC[pS];pv&&pv._clearRenderElements()}var pL=pgh._staticBatchManagers;for(pS=0,pB=pL.length;pS<pB;pS++)pL[pS]._clearRenderElements();pU._clearRenderElements();var pe=pf.transform.position;for(pS=0,pB=pq._cullingRendersLength;pS<pB;pS++){var pl=pu[pS];if(pz.isVisible(pl._owner.layer.mask)&&pl.enable&&0!==ph.containsBoundSphere(pl.boundingSphere)&&pl._renderUpdate(pP)){pl._distanceForSort=pSq.distance(pl.boundingSphere.center,pe)+pl.sortingFudge;var p_=pl._renderElements;for(pr=0,pY=p_.length;pr<pY;pr++){var pN=p_[pr],pG=pN._staticBatch;if(pG&&pG._material===pN._material)pG._addBatchRenderElement(pN);else{var pm=pN.renderObj;pm.triangleCount<10&&1===pm._vertexBufferCount&&pm._getIndexBuffer()&&pN._material.renderQueue<2&&pN._canDynamicBatch&&!pl._owner.isStatic?pU._addPrepareRenderElement(pN):pq.getRenderQueue(pN._material.renderQueue)._addRenderElement(pN)}}}}for(pS=0,pB=pL.length;pS<pB;pS++)pL[pS]._addToRenderQueue(pq,pg,p$,pP);pU._finishCombineDynamicBatch(pq),pU._addToRenderQueue(pq,pg,p$,pP)},ph.renderObjectCullingOctree=function(ph,pq,pf,pg,p$,pP){var pS=0,pB=0,pr=pq._quenes,pY=pq._dynamicBatchManager;for(pS=0,pB=pr.length;pS<pB;pS++){var pC=pr[pS];pC&&pC._clearRenderElements()}var pU=pgh._staticBatchManagers;for(pS=0,pB=pU.length;pS<pB;pS++)pU[pS]._clearRenderElements();for(pY._clearRenderElements(),pq._cullingRenders.length=0,pq.treeRoot.cullingObjects(ph,!0,0,pf.transform.position,pP),pS=0,pB=pU.length;pS<pB;pS++)pU[pS]._addToRenderQueue(pq,pg,p$,pP);pY._finishCombineDynamicBatch(pq),pY._addToRenderQueue(pq,pg,p$,pP)},ph.renderObjectCullingNoBoundFrustum=function(ph,pq,pf,pg,p$){var pP=0,pS=0,pB=0,pr=0,pY=ph._quenes,pC=ph._dynamicBatchManager,pU=ph._cullingRenders;for(pP=0,pS=pY.length;pP<pS;pP++){var pu=pY[pP];pu&&pu._clearRenderElements()}var pv=pgh._staticBatchManagers;for(pP=0,pS=pv.length;pP<pS;pP++)pv[pP]._clearRenderElements();pC._clearRenderElements();var pL=pq.transform.position;for(pP=0,pS=ph._cullingRendersLength;pP<pS;pP++){var pe=pU[pP];if(pz.isVisible(pe._owner.layer.mask)&&pe.enable){pe._renderUpdate(p$),pe._distanceForSort=pSq.distance(pe.boundingSphere.center,pL)+pe.sortingFudge;var pl=pe._renderElements;for(pB=0,pr=pl.length;pB<pr;pB++){var p_=pl[pB],pN=p_._staticBatch;if(pN&&pN._material===p_._material)pN._addBatchRenderElement(p_);else{var pG=p_.renderObj;pG.triangleCount<10&&1===pG._vertexBufferCount&&pG._getIndexBuffer()&&p_._material.renderQueue<2&&p_._canDynamicBatch&&!pe._owner.isStatic?pC._addPrepareRenderElement(p_):ph.getRenderQueue(p_._material.renderQueue)._addRenderElement(p_)}}}}for(pP=0,pS=pv.length;pP<pS;pP++)pv[pP]._addToRenderQueue(ph,pf,pg,p$);pC._finishCombineDynamicBatch(ph),pC._addToRenderQueue(ph,pf,pg,p$)},ph}(),pgh=function(){function pP(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}pv(pP,"laya.d3.graphics.StaticBatchManager");var ph=pP.prototype;return ph._finishInit=function(){for(var ph in this._staticBatches)this._staticBatches[ph]._finishInit();this._initBatchRenderElements.length=0},ph._initStaticBatchs=function(ph){throw new Error("StaticBatchManager:must override this function.")},ph._addInitBatchSprite=function(ph){for(var pq=ph._render._renderElements,pf=0,pg=pq.length;pf<pg;pf++)this._initBatchRenderElements.push(pq[pf])},ph._clearRenderElements=function(){for(var ph in this._staticBatches)this._staticBatches[ph]._clearRenderElements()},ph._garbageCollection=function(ph){var pq=ph._staticBatch,pf=pq._initBatchRenderElements,pg=pf.indexOf(ph);pf.splice(pg,1),0===pf.length&&(pq.dispose(),delete this._staticBatches[pq._key])},ph._addToRenderQueue=function(ph,pq,pf,pg){for(var p$ in this._staticBatches){var pP=this._staticBatches[p$];0<pP._batchRenderElements.length&&pP._updateToRenderQueue(ph,pg)}},ph.dispose=function(){this._staticBatches=null},pP._addToStaticBatchQueue=function(ph){ph instanceof laya.d3.core.RenderableSprite3D&&ph._addToInitStaticBatchManager();for(var pq=0,pf=ph.numChildren;pq<pf;pq++)pP._addToStaticBatchQueue(ph._childs[pq])},pP.combine=function(ph,pq){var pf,pg=0,p$=0;if(pq)for(pg=0,p$=pq.length;pg<p$;pg++){pq[pg]._addToInitStaticBatchManager()}else ph&&pP._addToStaticBatchQueue(ph);for(pg=0,p$=pP._staticBatchManagers.length;pg<p$;pg++)(pf=pP._staticBatchManagers[pg])._initStaticBatchs(ph),pf._finishInit()},pP._staticBatchManagers=[],pP}(),p$h=function(){function ph(ph,pq,pf){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=ph,this._manager=pq,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=pf}pv(ph,"laya.d3.graphics.StaticBatch");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),pq._binarySearch=function(ph){for(var pq=0,pf=this._batchRenderElements.length-1,pg=0;pq<=pf;)pg=Math.floor((pq+pf)/2),this._compareBatchRenderElement(this._batchRenderElements[pg],ph)?pf=pg-1:pq=pg+1;return pq},pq._compareBatchRenderElement=function(ph,pq){throw new Error("StaticBatch:must override this function.")},pq._getVertexDecLightMap=function(ph){return ph===pIh.vertexDeclaration?pzh.vertexDeclaration:ph===pTh.vertexDeclaration?pih.vertexDeclaration:ph===pnh.vertexDeclaration?pmh.vertexDeclaration:ph===pDh.vertexDeclaration?null:ph===peh.vertexDeclaration?plh.vertexDeclaration:ph===pkh.vertexDeclaration?pMh.vertexDeclaration:ph===pdh.vertexDeclaration?pbh.vertexDeclaration:ph===pwh.vertexDeclaration?pch.vertexDeclaration:ph===pTh.vertexDeclaration?pih.vertexDeclaration:ph===pJh.vertexDeclaration?pEh.vertexDeclaration:ph===pDh.vertexDeclaration?null:ph===peh.vertexDeclaration?plh.vertexDeclaration:ph===pHh.vertexDeclaration?pWh.vertexDeclaration:ph===pdh.vertexDeclaration?pbh.vertexDeclaration:ph},pq._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},pq._addBatchRenderElement=function(ph){this._batchRenderElements.splice(this._binarySearch(ph),0,ph)},pq._updateToRenderQueue=function(ph,pq){this._combineRenderElementPoolIndex=0,this._getRenderElement(ph.getRenderQueue(this._material.renderQueue)._renderElements,ph,pq)},pq._getRenderElement=function(ph,pq,pf){throw new Error("StaticBatch:must override this function.")},pq._finishInit=function(){throw new Error("StaticBatch:must override this function.")},pq._clearRenderElements=function(){this._batchRenderElements.length=0},pq.dispose=function(){},pq._getVertexBuffer=function(ph){return void 0===ph&&(ph=0),null},pq._getIndexBuffer=function(){return null},pq._beforeRender=function(ph){return!0},pq._render=function(ph){},pq._getVertexBuffers=function(){return null},pL(0,pq,"_vertexBufferCount",function(){return 1}),pL(0,pq,"triangleCount",function(){return 0}),ph.combine=function(ph){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),pgh.combine(ph)},ph.maxBatchVertexCount=65535,ph}(),pPh=function(){function pS(ph,pq){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++pS._uniqueIDCounter,this._id>pS.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",pS.maxVertexDeclaration);this._shaderValues=new puq,this._vertexElementsDic={},this._vertexStride=ph,this._vertexElements=pq;for(var pf=0;pf<pq.length;pf++){var pg=pq[pf],p$=pg.elementUsage;this._vertexElementsDic[p$]=pg;var pP=[pS._getTypeSize(pg.elementFormat)/4,5126,!1,this._vertexStride,pg.offset];switch(this._shaderValues.setValue(p$,pP),p$){case 1:this._addShaderDefine(pXq.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(pXq.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(pXq.SHADERDEFINE_UV1)}}}pv(pS,"laya.d3.graphics.VertexDeclaration");var ph=pS.prototype;return ph._addShaderDefine=function(ph){this._shaderDefineValue|=ph},ph._removeShaderDefine=function(ph){this._shaderDefineValue&=~ph},ph.getVertexElements=function(){return this._vertexElements.slice()},ph.getVertexElementByUsage=function(ph){return this._vertexElementsDic[ph]},ph.unBinding=function(){},pL(0,ph,"shaderDefineValue",function(){return this._shaderDefineValue}),pL(0,ph,"id",function(){return this._id}),pL(0,ph,"vertexStride",function(){return this._vertexStride}),pL(0,ph,"shaderValues",function(){return this._shaderValues}),pS._getTypeSize=function(ph){switch(ph){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},pS.getVertexStride=function(ph){for(var pq=0,pf=0;pf<ph.Length;pf++){var pg=ph[pf],p$=pg.offset+pS._getTypeSize(pg.elementFormat);pq<p$&&(pq=p$)}return pq},pS._maxVertexDeclarationBit=1e3,pS._uniqueIDCounter=1,pU(pS,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),pS}(),pSh=function(){function ph(ph,pq,pf){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=ph,this.elementFormat=pq,this.elementUsage=pf}return pv(ph,"laya.d3.graphics.VertexElement"),ph}(),pBh=(function(){function ph(){}pv(ph,"laya.d3.graphics.VertexElementFormat"),ph.Single="single",ph.Vector2="vector2",ph.Vector3="vector3",ph.Vector4="vector4",ph.Color="color",ph.Byte4="byte4",ph.Short2="short2",ph.Short4="short4",ph.NormalizedShort2="normalizedshort2",ph.NormalizedShort4="normalizedshort4",ph.HalfVector2="halfvector2",ph.HalfVector4="halfvector4"}(),function(){function ph(){}pv(ph,"laya.d3.graphics.VertexElementUsage"),ph.POSITION0=0,ph.COLOR0=1,ph.TEXTURECOORDINATE0=2,ph.NORMAL0=3,ph.BINORMAL0=4,ph.TANGENT0=5,ph.BLENDINDICES0=6,ph.BLENDWEIGHT0=7,ph.DEPTH0=8,ph.FOG0=9,ph.POINTSIZE0=10,ph.SAMPLE0=11,ph.TESSELLATEFACTOR0=12,ph.COLOR1=13,ph.NEXTTEXTURECOORDINATE0=14,ph.TEXTURECOORDINATE1=15,ph.NEXTTEXTURECOORDINATE1=16,ph.CORNERTEXTURECOORDINATE0=17,ph.VELOCITY0=18,ph.STARTCOLOR0=19,ph.STARTSIZE=20,ph.AGEADDSCALE0=21,ph.STARTROTATION=22,ph.ENDCOLOR0=23,ph.STARTLIFETIME=24,ph.TIME0=33,ph.SHAPEPOSITIONSTARTLIFETIME=30,ph.DIRECTIONTIME=32,ph.SIZEROTATION0=27,ph.RADIUS0=28,ph.RADIAN0=29,ph.STARTSPEED=31,ph.RANDOM0=34,ph.RANDOM1=35,ph.SIMULATIONWORLDPOSTION=36,ph.SIMULATIONWORLDROTATION=37,ph.TEXTURECOORDINATE0X=38,ph.TEXTURECOORDINATE0X1=39,ph.TEXTURECOORDINATE0Y=40,ph.OFFSETVECTOR=41}(),function(){function ph(ph,pq,pf){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=ph,this._textureCoordinate0=pq,this._time=pf}pv(ph,"laya.d3.graphics.VertexGlitter");var pq=ph.prototype;pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate0}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"time",function(){return this._time}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(24,[new pSh(0,"vector3",0),new pSh(12,"vector2",2),new pSh(20,"single",33)])}])}(),function(){function ph(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=ph,this._position=pq,this._velocity=pf,this._startColor=pg,this._endColor=p$,this._sizeRotation=pP,this._radius=pS,this._radian=pB,this._ageAddScale=pr,this._time=pY}pv(ph,"laya.d3.graphics.VertexParticle");var pq=ph.prototype;pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"endColor",function(){return this._endColor}),pL(0,pq,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),pL(0,pq,"sizeRotation",function(){return this._sizeRotation}),pL(0,pq,"velocity",function(){return this._velocity}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"startColor",function(){return this._startColor}),pL(0,pq,"radius",function(){return this._radius}),pL(0,pq,"radian",function(){return this._radian}),pL(0,pq,"ageAddScale",function(){return this._ageAddScale}),pL(0,pq,"time",function(){return this._time}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(116,[new pSh(0,"vector4",17),new pSh(16,"vector3",0),new pSh(28,"vector3",18),new pSh(40,"vector4",19),new pSh(56,"vector4",23),new pSh(72,"vector3",27),new pSh(84,"vector2",28),new pSh(92,"vector4",29),new pSh(108,"single",24),new pSh(112,"single",33)])}])}(),function(){function ph(ph){this._position=null,this._position=ph}pv(ph,"laya.d3.graphics.VertexPosition");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(12,[new pSh(0,"vector3",0)])}]),ph}()),prh=function(){function ph(ph,pq){this._position=null,this._normal=null,this._position=ph,this._normal=pq}pv(ph,"laya.d3.graphics.VertexPositionNormal");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(24,[new pSh(0,"vector3",0),new pSh(12,"vector3",3)])}]),ph}(),pYh=function(){function ph(ph,pq,pf){this._position=null,this._normal=null,this._color=null,this._position=ph,this._normal=pq,this._color=pf}pv(ph,"laya.d3.graphics.VertexPositionNormalColor");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(40,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1)])}]),ph}(),pCh=function(){function ph(ph,pq,pf,pg,p$){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=ph,this._normal=pq,this._color=pf,this._blendIndex=pg,this._blendWeight=p$}pv(ph,"laya.d3.graphics.VertexPositionNormalColorSkin");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(72,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector4",7),new pSh(56,"vector4",6)])}]),ph}(),pUh=function(){function ph(ph,pq,pf,pg,p$,pP){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._tangent=pg,this._blendIndex=p$,this._blendWeight=pP}pv(ph,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(88,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector4",7),new pSh(56,"vector4",6),new pSh(72,"vector4",5)])}]),ph}(),puh=function(){function ph(ph,pq,pf,pg,p$,pP){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._tangent=pg,this._blendIndex=p$,this._blendWeight=pP}pv(ph,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(84,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector4",7),new pSh(56,"vector4",6),new pSh(72,"vector3",5)])}]),ph}(),pvh=function(){function ph(ph,pq,pf,pg){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._tangent=pg}pv(ph,"laya.d3.graphics.VertexPositionNormalColorSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(56,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector4",5)])}]),ph}(),pLh=function(){function ph(ph,pq,pf,pg){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._tangent=pg}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(52,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector3",5)])}]),ph}(),peh=function(){function ph(ph,pq,pf,pg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate=pg}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTexture");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(48,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2)])}]),ph}(),plh=function(){function ph(ph,pq,pf,pg,p$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate0=pg,this._textureCoordinate1=p$}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(56,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector2",15)])}]),ph}(),p_h=function(){function ph(ph,pq,pf,pg,p$,pP,pS){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate0=pg,this._textureCoordinate1=p$,this._blendIndex=pP,this._blendWeight=pS}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(88,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector2",15),new pSh(56,"vector4",7),new pSh(72,"vector4",6)])}]),ph}(),pNh=function(){function ph(ph,pq,pf,pg,p$,pP,pS,pB){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate0=pg,this._textureCoordinate1=p$,this._tangent=pP,this._blendIndex=pS,this._blendWeight=pB}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(104,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector2",15),new pSh(56,"vector4",7),new pSh(72,"vector4",6),new pSh(88,"vector4",5)])}]),ph}(),pGh=function(){function ph(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pq.VertexPositionNormalColorTexture0SkinTangent=function(ph,pq,pf,pg,p$,pP,pS,pB){this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate0=pg,this._textureCoordinate1=p$,this._tangent=pP,this._blendIndex=pS,this._blendWeight=pB},pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(100,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector2",15),new pSh(56,"vector4",7),new pSh(72,"vector4",6),new pSh(88,"vector3",5)])}]),ph}(),pmh=function(){function ph(ph,pq,pf,pg,p$,pP){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate0=pg,this._textureCoordinate1=p$,this._tangent=pP}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(72,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector2",15),new pSh(56,"vector4",5)])}]),ph}(),pEh=function(){function ph(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pq.VertexPositionNormalColorTexture0Tangent=function(ph,pq,pf,pg,p$,pP){this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate0=pg,this._textureCoordinate1=p$,this._tangent=pP},pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(68,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector2",15),new pSh(56,"vector3",5)])}]),ph}(),pRh=function(){function ph(ph,pq,pf,pg,p$,pP){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate=pg,this._blendIndex=p$,this._blendWeight=pP}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(80,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector4",7),new pSh(64,"vector4",6)])}]),ph}(),pth=function(){function ph(ph,pq,pf,pg,p$,pP,pS){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate=pg,this._tangent=p$,this._blendIndex=pP,this._blendWeight=pS}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(96,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector4",7),new pSh(64,"vector4",6),new pSh(80,"vector4",5)])}]),ph}(),pXh=function(){function ph(ph,pq,pf,pg,p$,pP,pS){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate=pg,this._tangent=p$,this._blendIndex=pP,this._blendWeight=pS}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(92,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector4",7),new pSh(64,"vector4",6),new pSh(80,"vector3",5)])}]),ph}(),pnh=function(){function ph(ph,pq,pf,pg,p$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate=pg,this._tangent=p$}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(64,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector4",5)])}]),ph}(),pJh=function(){function ph(ph,pq,pf,pg,p$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=ph,this._normal=pq,this._color=pf,this._textureCoordinate=pg,this._tangent=p$}pv(ph,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"color",function(){return this._color}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(60,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",1),new pSh(40,"vector2",2),new pSh(48,"vector3",5)])}]),ph}(),pph=function(){function ph(ph,pq,pf){this._position=null,this._normal=null,this._tangent=null,this._position=ph,this._normal=pq,this._tangent=pf}pv(ph,"laya.d3.graphics.VertexPositionNormalSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(40,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector4",5)])}]),ph}(),pAh=function(){function ph(ph,pq,pf){this._position=null,this._normal=null,this._tangent=null,this._position=ph,this._normal=pq,this._tangent=pf}pv(ph,"laya.d3.graphics.VertexPositionNormalTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(36,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector3",5)])}]),ph}(),pdh=function(){function ph(ph,pq,pf){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf}pv(ph,"laya.d3.graphics.VertexPositionNormalTexture");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(32,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2)])}]),ph}(),pbh=function(){function ph(ph,pq,pf,pg){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=ph,this._normal=pq,this._textureCoordinate0=pf,this._textureCoordinate1=pg}pv(ph,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(40,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector2",15)])}]),ph}(),pih=function(){function ph(ph,pq,pf,pg,p$,pP){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=ph,this._normal=pq,this._textureCoordinate0=pf,this._textureCoordinate1=pg,this._blendIndex=p$,this._blendWeight=pP}pv(ph,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(72,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector2",15),new pSh(40,"vector4",7),new pSh(56,"vector4",6)])}]),ph}(),pzh=function(){function ph(ph,pq,pf,pg,p$,pP,pS){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._textureCoordinate0=pf,this._textureCoordinate1=pg,this._tangent=p$,this._blendIndex=pP,this._blendWeight=pS}pv(ph,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(88,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector2",15),new pSh(40,"vector4",7),new pSh(56,"vector4",6),new pSh(72,"vector4",5)])}]),ph}(),pch=function(){function ph(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}pv(ph,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pq.VertexPositionNormalTexture0SkinTangent=function(ph,pq,pf,pg,p$,pP,pS){this._position=ph,this._normal=pq,this._textureCoordinate0=pf,this._textureCoordinate1=pg,this._tangent=p$,this._blendIndex=pP,this._blendWeight=pS},pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(84,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector2",15),new pSh(40,"vector4",7),new pSh(56,"vector4",6),new pSh(72,"vector3",5)])}]),ph}(),pMh=function(){function ph(ph,pq,pf,pg,p$){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=ph,this._normal=pq,this._textureCoordinate0=pf,this._textureCoordinate1=pg,this._tangent=p$}pv(ph,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(56,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector2",15),new pSh(40,"vector4",5)])}]),ph}(),pWh=function(){function ph(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}pv(ph,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pq.VertexPositionNormalTexture0Tangent=function(ph,pq,pf,pg,p$){this._position=ph,this._normal=pq,this._textureCoordinate0=pf,this._textureCoordinate1=pg,this._tangent=p$},pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(52,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector2",15),new pSh(40,"vector3",5)])}]),ph}(),pTh=function(){function ph(ph,pq,pf,pg,p$){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf,this._blendIndex=pg,this._blendWeight=p$}pv(ph,"laya.d3.graphics.VertexPositionNormalTextureSkin");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(64,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector4",7),new pSh(48,"vector4",6)])}]),ph}(),pIh=function(){function ph(ph,pq,pf,pg,p$,pP){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf,this._tangent=pg,this._blendIndex=p$,this._blendWeight=pP}pv(ph,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(80,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector4",7),new pSh(48,"vector4",6),new pSh(64,"vector4",5)])}]),ph}(),pwh=function(){function ph(ph,pq,pf,pg,p$,pP){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf,this._tangent=pg,this._blendIndex=p$,this._blendWeight=pP}pv(ph,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(76,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector4",7),new pSh(48,"vector4",6),new pSh(64,"vector3",5)])}]),ph}(),pkh=function(){function ph(ph,pq,pf,pg){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf,this._tangent=pg}pv(ph,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(48,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector4",5)])}]),ph}(),pHh=function(){function ph(ph,pq,pf,pg){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf,this._tangent=pg}pv(ph,"laya.d3.graphics.VertexPositionNormalTextureTangent");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(44,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector3",5)])}]),ph}(),pDh=function(){function ph(ph,pq,pf){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf}pv(ph,"laya.d3.graphics.VertexPositionNTBTexture");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(56,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector3",5),new pSh(36,"vector3",4),new pSh(48,"vector2",2)])}]),ph}(),psh=function(){function ph(ph,pq,pf,pg,p$,pP,pS,pB){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=ph,this._normal=pq,this._textureCoordinate0=pg,this._textureCoordinate1=p$,this._tangent=pP,pf=pf,this._blendIndex=pS,this._blendWeight=pB}pv(ph,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"tangent",function(){return this._tangent}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(0,pq,"textureCoordinate1",function(){return this._textureCoordinate1}),pL(0,pq,"blendIndex",function(){return this._blendIndex}),pL(0,pq,"blendWeight",function(){return this._blendWeight}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(96,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector3",5),new pSh(36,"vector3",4),new pSh(48,"vector2",2),new pSh(56,"vector2",15),new pSh(64,"vector4",7),new pSh(80,"vector4",6)])}]),ph}(),pVh=function(){function ph(ph,pq,pf){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=ph,this._normal=pq,this._textureCoordinate=pf}pv(ph,"laya.d3.graphics.VertexPositionNTBTextureSkin");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"textureCoordinate",function(){return this._textureCoordinate}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(88,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector3",5),new pSh(36,"vector3",4),new pSh(48,"vector2",2),new pSh(56,"vector4",7),new pSh(72,"vector4",6)])}]),ph}(),pKh=(function(){function ph(ph,pq,pf,pg){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=ph,this._normal=pq,this._textureCoord0=pf,this._textureCoord1=pg}pv(ph,"laya.d3.graphics.VertexPositionTerrain");var pq=ph.prototype;pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"normal",function(){return this._normal}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoord0",function(){return this._textureCoord0}),pL(0,pq,"textureCoord1",function(){return this._textureCoord1}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(40,[new pSh(0,"vector3",0),new pSh(12,"vector3",3),new pSh(24,"vector2",2),new pSh(32,"vector2",15)])}])}(),function(){function ph(ph,pq){this._position=null,this._textureCoordinate0=null,this._position=ph,this._textureCoordinate0=pq}pv(ph,"laya.d3.graphics.VertexPositionTexture0");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"position",function(){return this._position}),pL(0,pq,"textureCoordinate0",function(){return this._textureCoordinate0}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(20,[new pSh(0,"vector3",0),new pSh(12,"vector2",2)])}]),ph}()),pyh=(function(){function ph(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU,pu,pv){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=ph,this._positionStartLifeTime=pq,this._velocity=pf,this._startColor=pg,this._startSize=p$,this._startRotation0=pP,this._startRotation1=pS,this._startRotation2=pB,this._startLifeTime=pr,this._time=pY,this._startSpeed=pC,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=pv}pv(ph,"laya.d3.graphics.VertexShurikenParticleBillboard");var pq=ph.prototype;pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),pL(0,pq,"random1",function(){return this._randoms1}),pL(0,pq,"startRotation2",function(){return this._startRotation2}),pL(0,pq,"positionStartLifeTime",function(){return this._positionStartLifeTime}),pL(0,pq,"velocity",function(){return this._velocity}),pL(0,pq,"random0",function(){return this._randoms0}),pL(0,pq,"startSize",function(){return this._startSize}),pL(0,pq,"startColor",function(){return this._startColor}),pL(0,pq,"startRotation0",function(){return this._startRotation0}),pL(0,pq,"startRotation1",function(){return this._startRotation1}),pL(0,pq,"startLifeTime",function(){return this._startLifeTime}),pL(0,pq,"time",function(){return this._time}),pL(0,pq,"startSpeed",function(){return this._startSpeed}),pL(0,pq,"simulationWorldPostion",function(){return this._simulationWorldPostion}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(152,[new pSh(0,"vector4",17),new pSh(16,"vector4",30),new pSh(32,"vector4",32),new pSh(48,"vector4",19),new pSh(64,"vector3",20),new pSh(76,"vector3",22),new pSh(88,"single",31),new pSh(92,"vector4",34),new pSh(108,"vector4",35),new pSh(124,"vector3",36),new pSh(136,"vector4",37)])}])}(),function(){function ph(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU,pu,pv){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=ph,this._positionStartLifeTime=pq,this._velocity=pf,this._startColor=pg,this._startSize=p$,this._startRotation0=pP,this._startRotation1=pS,this._startRotation2=pB,this._startLifeTime=pr,this._time=pY,this._startSpeed=pC,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=pv}pv(ph,"laya.d3.graphics.VertexShurikenParticleMesh");var pq=ph.prototype;pE.imps(pq,{"laya.d3.graphics.IVertex":!0}),pL(0,pq,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),pL(0,pq,"velocity",function(){return this._velocity}),pL(0,pq,"position",function(){return this._positionStartLifeTime}),pL(0,pq,"random0",function(){return this._randoms0}),pL(0,pq,"startSize",function(){return this._startSize}),pL(0,pq,"startColor",function(){return this._startColor}),pL(0,pq,"startRotation0",function(){return this._startRotation0}),pL(0,pq,"startRotation1",function(){return this._startRotation1}),pL(0,pq,"random1",function(){return this._randoms1}),pL(0,pq,"startRotation2",function(){return this._startRotation2}),pL(0,pq,"startLifeTime",function(){return this._startLifeTime}),pL(0,pq,"time",function(){return this._time}),pL(0,pq,"startSpeed",function(){return this._startSpeed}),pL(0,pq,"simulationWorldPostion",function(){return this._simulationWorldPostion}),pL(0,pq,"vertexDeclaration",function(){return ph._vertexDeclaration}),pL(1,ph,"vertexDeclaration",function(){return ph._vertexDeclaration}),pU(ph,["_vertexDeclaration",function(){return this._vertexDeclaration=new pPh(172,[new pSh(0,"vector3",0),new pSh(12,"vector4",1),new pSh(28,"vector2",2),new pSh(36,"vector4",30),new pSh(52,"vector4",32),new pSh(68,"vector4",19),new pSh(84,"vector3",20),new pSh(96,"vector3",22),new pSh(108,"single",31),new pSh(112,"vector4",34),new pSh(128,"vector4",35),new pSh(144,"vector3",36),new pSh(156,"vector4",37)])}])}(),function(){function pG(ph,pq,pf,pg,p$,pP){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=pf,this._materials=pg,this._subMeshes=p$,this._materialMap=pP,this._version=pq,this._onLoaded(ph)}pv(pG,"laya.d3.loaders.LoadModelV01");var ph=pG.prototype;return ph._onLoaded=function(ph){this._readData=ph,this.READ_BLOCK();for(var pq=0;pq<this._BLOCK.count;pq++){var pf=this._readData.getUint16(),pg=this._strings[pf],p$=this["READ_"+pg];if(null==p$)throw new Error("model file err,no this function:"+pf+" "+pg);if(!p$.call(this))break}return this._mesh},ph.onError=function(){},ph._readString=function(){return this._strings[this._readData.getUint16()]},ph.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},ph.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},ph.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var ph=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var pq=0;pq<this._STRINGS.size;pq++)this._strings[pq]=this._readData.readUTFString();return this._readData.pos=ph,!0},ph.READ_MATERIAL=function(){var ph=this._readData.getUint16(),pq=(this._readString(),this._readString());return this._materials[ph]="null"!==pq?p_.getRes(this._materialMap[pq]):new pAq,!0},ph.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var ph,pq=this._readData.__getBuffer(),pf=0,pg=this._readData.getUint32(),p$=this._readData.getUint32(),pP=(new Float32Array(pq.slice(pg+this._DATA.offset,pg+this._DATA.offset+p$)),this._readData.getUint32()),pS=this._readData.getUint32(),pB=new Float32Array(pq.slice(pP+this._DATA.offset,pP+this._DATA.offset+pS));for(this.mesh._inverseBindPoses=[],pf=0,ph=pB.length;pf<ph;pf+=16){var pr=new phq(pB[pf+0],pB[pf+1],pB[pf+2],pB[pf+3],pB[pf+4],pB[pf+5],pB[pf+6],pB[pf+7],pB[pf+8],pB[pf+9],pB[pf+10],pB[pf+11],pB[pf+12],pB[pf+13],pB[pf+14],pB[pf+15]);this.mesh._inverseBindPoses.push(pr)}break;default:throw new Error("LoadModel:unknown version.")}return!0},ph.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var ph=this._readString();this._shaderAttributes=ph.match(pG._attrReg);var pq=this._readData.getUint32(),pf=this._readData.getUint32(),pg=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),p$=this._readData.getUint32(),pP=this._readData.getUint32(),pS=this._readData.getUint32(),pB=this._readData.__getBuffer(),pr=new pYq(this._mesh),pY=this._getVertexDeclaration(),pC=pwq.create(pY,p$/pY.vertexStride,35044,!0),pU=pg+this._DATA.offset,pu=pB.slice(pU,pU+p$);pC.setData(new Float32Array(pu));for(var pv=(pr._vertexBuffer=pC).vertexDeclaration.getVertexElements(),pL=0;pL<pv.length;pL++)pr._bufferUsage[pv[pL].elementUsage]=pC;var pe=pIq.create("ushort",pf/2,35044,!0),pl=pq+this._DATA.offset,p_=pB.slice(pl,pl+pf);pe.setData(new Uint16Array(p_)),pr._indexBuffer=pe;var pN=pB.slice(pP+this._DATA.offset,pP+this._DATA.offset+pS);return pr._boneIndicesList[0]=new Uint8Array(pN),this._subMeshes.push(pr),!0},ph.READ_DATAAREA=function(){return!1},ph._getVertexDeclaration=function(){for(var ph,pq=!1,pf=!1,pg=!1,p$=!1,pP=!1,pS=!1,pB=!1,pr=!1,pY=!1,pC=0;pC<this._shaderAttributes.length;pC+=8)switch(this._shaderAttributes[pC]){case"POSITION":pq=!0;break;case"NORMAL":pf=!0;break;case"COLOR":pg=!0;break;case"UV":p$=!0;break;case"UV1":pP=!0;break;case"BLENDWEIGHT":pB=!0;break;case"BLENDINDICES":pr=!0;break;case"TANGENT":pS=!0;break;case"BINORMAL":pY=!0}return pq&&pf&&pg&&p$&&pP&&pB&&pr&&pS?ph=pGh.vertexDeclaration:pq&&pf&&pg&&p$&&pP&&pB&&pr?ph=p_h.vertexDeclaration:pq&&pf&&p$&&pP&&pB&&pr&&pS?ph=pch.vertexDeclaration:pq&&pf&&p$&&pP&&pB&&pr?ph=pih.vertexDeclaration:pq&&pf&&pg&&p$&&pB&&pr&&pS?ph=pXh.vertexDeclaration:pq&&pf&&pg&&p$&&pB&&pr?ph=pRh.vertexDeclaration:pq&&pf&&pS&&pY&&p$&&pB&&pr?ph=pVh.vertexDeclaration:pq&&pf&&p$&&pB&&pr&&pS?ph=pwh.vertexDeclaration:pq&&pf&&p$&&pB&&pr?ph=pTh.vertexDeclaration:pq&&pf&&pg&&pB&&pr&&pS?ph=puh.vertexDeclaration:pq&&pf&&pg&&pB&&pr?ph=pCh.vertexDeclaration:pq&&pf&&pg&&p$&&pP&&pS?ph=pEh.vertexDeclaration:pq&&pf&&pg&&p$&&pP?ph=plh.vertexDeclaration:pq&&pf&&p$&&pP&&pS?ph=pWh.vertexDeclaration:pq&&pf&&p$&&pP?ph=pbh.vertexDeclaration:pq&&pf&&pg&&p$&&pS?ph=pJh.vertexDeclaration:pq&&pf&&p$&&pS&&pY?ph=pDh.vertexDeclaration:pq&&pf&&pg&&p$?ph=peh.vertexDeclaration:pq&&pf&&p$&&pS?ph=pHh.vertexDeclaration:pq&&pf&&p$?ph=pdh.vertexDeclaration:pq&&pf&&pg&&pS?ph=pLh.vertexDeclaration:pq&&pf&&pg&&(ph=pYh.vertexDeclaration),ph},pL(0,ph,"mesh",function(){return this._mesh}),pG._attrReg=new RegExp("(\\w+)|([:,;])","g"),pG}()),pFh=function(){function pt(){}return pv(pt,"laya.d3.loaders.LoadModelV02"),pt.parse=function(ph,pq,pf,pg,p$,pP){pt._mesh=pf,pt._materials=pg,pt._subMeshes=p$,pt._materialMap=pP,pt._version=pq,pt._readData=ph,pt.READ_DATA(),pt.READ_BLOCK(),pt.READ_STRINGS();for(var pS=0,pB=pt._BLOCK.count;pS<pB;pS++){pt._readData.pos=pt._BLOCK.blockStarts[pS];var pr=pt._readData.getUint16(),pY=pt._strings[pr],pC=pt["READ_"+pY];if(null==pC)throw new Error("model file err,no this function:"+pr+" "+pY);pC.call()}pt._strings.length=0,pt._readData=null,pt._version=null,pt._mesh=null,pt._materials=null,pt._subMeshes=null,pt._materialMap=null},pt._readString=function(){return pt._strings[pt._readData.getUint16()]},pt.READ_DATA=function(){pt._DATA.offset=pt._readData.getUint32(),pt._DATA.size=pt._readData.getUint32()},pt.READ_BLOCK=function(){for(var ph=pt._BLOCK.count=pt._readData.getUint16(),pq=pt._BLOCK.blockStarts=[],pf=pt._BLOCK.blockLengths=[],pg=0;pg<ph;pg++)pq.push(pt._readData.getUint32()),pf.push(pt._readData.getUint32())},pt.READ_STRINGS=function(){var ph=pt._readData.getUint32(),pq=pt._readData.getUint16(),pf=pt._readData.pos;pt._readData.pos=ph+pt._DATA.offset;for(var pg=0;pg<pq;pg++)pt._strings[pg]=pt._readData.readUTFString();pt._readData.pos=pf},pt.READ_MATERIAL=function(){pt._readString(),pt._readString();var ph=pt._readString();return""!==ph&&pt._materials.push(p_.getRes(pt._materialMap[ph])),!0},pt.READ_MESH=function(){pt._readString();var ph,pq=pt._readData.__getBuffer(),pf=0,pg=pt._readData.getInt16(),p$=pt._DATA.offset;for(pf=0;pf<pg;pf++){var pP=p$+pt._readData.getUint32(),pS=pt._readData.getUint32(),pB=new Float32Array(pq.slice(pP,pP+pS)),pr=pt._readString().match(pt._attrReg),pY=pt._getVertexDeclaration(pr),pC=pwq.create(pY,4*pB.length/pY.vertexStride,35044,!0);pC.setData(pB),pt._mesh._vertexBuffers.push(pC)}var pU=p$+pt._readData.getUint32(),pu=pt._readData.getUint32(),pv=new Uint16Array(pq.slice(pU,pU+pu)),pL=pIq.create("ushort",pu/2,35044,!0);pL.setData(pv),pt._mesh._indexBuffer=pL;var pe=pt._mesh._boneNames=[],pl=pt._readData.getUint16();for(pe.length=pl,pf=0;pf<pl;pf++)pe[pf]=pt._strings[pt._readData.getUint16()];var p_=pt._readData.getUint32(),pN=pt._readData.getUint32(),pG=(new Float32Array(pq.slice(p$+p_,p$+p_+pN)),pt._readData.getUint32()),pm=pt._readData.getUint32(),pE=new Float32Array(pq.slice(p$+pG,p$+pG+pm));for(pt._mesh._inverseBindPoses=[],pf=0,ph=pE.length;pf<ph;pf+=16){var pR=new phq(pE[pf+0],pE[pf+1],pE[pf+2],pE[pf+3],pE[pf+4],pE[pf+5],pE[pf+6],pE[pf+7],pE[pf+8],pE[pf+9],pE[pf+10],pE[pf+11],pE[pf+12],pE[pf+13],pE[pf+14],pE[pf+15]);pt._mesh._inverseBindPoses.push(pR)}return pt._mesh._skinnedDatas=new Float32Array(16*pE.length),!0},pt.READ_SUBMESH=function(){var ph=pt._readData.__getBuffer(),pq=new pYq(pt._mesh),pf=pt._readData.getInt16(),pg=pt._readData.getUint32(),p$=pt._readData.getUint32();pq._vertexBuffer=pt._mesh._vertexBuffers[pf],pq._vertexStart=pg,pq._vertexCount=p$;var pP=pt._readData.getUint32(),pS=pt._readData.getUint32(),pB=pt._mesh._indexBuffer;pq._indexBuffer=pB,pq._indexStart=pP,pq._indexCount=pS,pq._indices=new Uint16Array(pB.getData().buffer,2*pP,pS);var pr=pt._DATA.offset,pY=pq._subIndexBufferStart,pC=pq._subIndexBufferCount,pU=pq._boneIndicesList,pu=pt._readData.getUint16();pY.length=pu,pC.length=pu,pU.length=pu;for(var pv=0;pv<pu;pv++){pY[pv]=pt._readData.getUint32(),pC[pv]=pt._readData.getUint32();var pL=pt._readData.getUint32(),pe=pt._readData.getUint32();pq._boneIndicesList[pv]=new Uint8Array(ph.slice(pr+pL,pr+pL+pe))}return pt._subMeshes.push(pq),!0},pt._getVertexDeclaration=function(ph){for(var pq,pf=!1,pg=!1,p$=!1,pP=!1,pS=!1,pB=!1,pr=!1,pY=!1,pC=!1,pU=0;pU<ph.length;pU++)switch(ph[pU]){case"POSITION":pf=!0;break;case"NORMAL":pg=!0;break;case"COLOR":p$=!0;break;case"UV":pP=!0;break;case"UV1":pS=!0;break;case"BLENDWEIGHT":pr=!0;break;case"BLENDINDICES":pY=!0;break;case"TANGENT":pB=!0;break;case"BINORMAL":pC=!0}return pf&&pg&&p$&&pP&&pS&&pr&&pY&&pB?pq=pGh.vertexDeclaration:pf&&pg&&p$&&pP&&pS&&pr&&pY?pq=p_h.vertexDeclaration:pf&&pg&&pP&&pS&&pr&&pY&&pB?pq=pch.vertexDeclaration:pf&&pg&&pP&&pS&&pr&&pY?pq=pih.vertexDeclaration:pf&&pg&&p$&&pP&&pr&&pY&&pB?pq=pXh.vertexDeclaration:pf&&pg&&p$&&pP&&pr&&pY?pq=pRh.vertexDeclaration:pf&&pg&&pP&&pr&&pY&&pB?pq=pwh.vertexDeclaration:pf&&pg&&pP&&pr&&pY?pq=pTh.vertexDeclaration:pf&&pg&&p$&&pr&&pY&&pB?pq=puh.vertexDeclaration:pf&&pg&&p$&&pr&&pY?pq=pCh.vertexDeclaration:pf&&pg&&p$&&pP&&pS&&pB?pq=pEh.vertexDeclaration:pf&&pg&&p$&&pP&&pS?pq=plh.vertexDeclaration:pf&&pg&&pP&&pS&&pB?pq=pWh.vertexDeclaration:pf&&pg&&pP&&pS?pq=pbh.vertexDeclaration:pf&&pg&&p$&&pP&&pB?pq=pJh.vertexDeclaration:pf&&pg&&pP&&pB&&pC?pq=pDh.vertexDeclaration:pf&&pg&&p$&&pP?pq=peh.vertexDeclaration:pf&&pg&&pP&&pB?pq=pHh.vertexDeclaration:pf&&pg&&pP?pq=pdh.vertexDeclaration:pf&&pg&&p$&&pB?pq=pLh.vertexDeclaration:pf&&pg&&p$&&(pq=pYh.vertexDeclaration),pq},pt._attrReg=new RegExp("(\\w+)|([:,;])","g"),pt._strings=[],pt._readData=null,pt._version=null,pt._mesh=null,pt._materials=null,pt._subMeshes=null,pt._materialMap=null,pU(pt,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),pt}(),pZh=function(){function pR(){}return pv(pR,"laya.d3.loaders.LoadModelV03"),pR.parse=function(ph,pq,pf,pg,p$){pR._mesh=pf,pR._subMeshes=pg,pR._materialMap=p$,pR._version=pq,pR._readData=ph,pR.READ_DATA(),pR.READ_BLOCK(),pR.READ_STRINGS();for(var pP=0,pS=pR._BLOCK.count;pP<pS;pP++){pR._readData.pos=pR._BLOCK.blockStarts[pP];var pB=pR._readData.getUint16(),pr=pR._strings[pB],pY=pR["READ_"+pr];if(null==pY)throw new Error("model file err,no this function:"+pB+" "+pr);pY.call()}pR._strings.length=0,pR._readData=null,pR._version=null,pR._mesh=null,pR._subMeshes=null,pR._materialMap=null},pR._readString=function(){return pR._strings[pR._readData.getUint16()]},pR.READ_DATA=function(){pR._DATA.offset=pR._readData.getUint32(),pR._DATA.size=pR._readData.getUint32()},pR.READ_BLOCK=function(){for(var ph=pR._BLOCK.count=pR._readData.getUint16(),pq=pR._BLOCK.blockStarts=[],pf=pR._BLOCK.blockLengths=[],pg=0;pg<ph;pg++)pq.push(pR._readData.getUint32()),pf.push(pR._readData.getUint32())},pR.READ_STRINGS=function(){var ph=pR._readData.getUint32(),pq=pR._readData.getUint16(),pf=pR._readData.pos;pR._readData.pos=ph+pR._DATA.offset;for(var pg=0;pg<pq;pg++)pR._strings[pg]=pR._readData.readUTFString();pR._readData.pos=pf},pR.READ_MESH=function(){var ph,pq=pR._readString(),pf=pR._readData.__getBuffer(),pg=0,p$=pR._readData.getInt16(),pP=pR._DATA.offset;for(pg=0;pg<p$;pg++){var pS,pB=pP+pR._readData.getUint32(),pr=pR._readData.getUint32(),pY=new Float32Array(pf.slice(pB,pB+pr)),pC=pR._readString();switch(pR._version){case"LAYAMODEL:03":pS=pR._vertexDeclarationMap_Discard[pC];break;case"LAYAMODEL:0301":pS=pR._vertexDeclarationMap[pC];break;default:throw new Error("LoadModelV03: unknown version.")}if(!pS)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+pR._version+"  bufferAttribute="+pC+"  name="+pq+"  url="+(pR._mesh?pR._mesh.url:"null"));var pU=pwq.create(pS,4*pY.length/pS.vertexStride,35044,!0,pR._mesh._url+"_"+pg);pU.setData(pY),pR._mesh._vertexBuffers.push(pU)}var pu=pP+pR._readData.getUint32(),pv=pR._readData.getUint32(),pL=new Uint16Array(pf.slice(pu,pu+pv)),pe=pIq.create("ushort",pv/2,35044,!0,pR._mesh._url);pe.setData(pL),pR._mesh._indexBuffer=pe;var pl=pR._mesh._boneNames=[],p_=pR._readData.getUint16();for(pl.length=p_,pg=0;pg<p_;pg++)pl[pg]=pR._strings[pR._readData.getUint16()];pR._readData.pos+=8;var pN=pR._readData.getUint32(),pG=pR._readData.getUint32(),pm=new Float32Array(pf.slice(pP+pN,pP+pN+pG));for(pR._mesh._inverseBindPoses=[],pg=0,ph=pm.length;pg<ph;pg+=16){var pE=new phq(pm[pg+0],pm[pg+1],pm[pg+2],pm[pg+3],pm[pg+4],pm[pg+5],pm[pg+6],pm[pg+7],pm[pg+8],pm[pg+9],pm[pg+10],pm[pg+11],pm[pg+12],pm[pg+13],pm[pg+14],pm[pg+15]);pR._mesh._inverseBindPoses.push(pE)}return pR._mesh._skinnedDatas=new Float32Array(16*pm.length),!0},pR.READ_SUBMESH=function(){var ph=pR._readData.__getBuffer(),pq=new pYq(pR._mesh),pf=pR._readData.getInt16(),pg=pR._readData.getUint32(),p$=pR._readData.getUint32();pq._vertexBuffer=pR._mesh._vertexBuffers[pf],pq._vertexStart=pg,pq._vertexCount=p$;var pP=pR._readData.getUint32(),pS=pR._readData.getUint32(),pB=pR._mesh._indexBuffer;pq._indexBuffer=pB,pq._indexStart=pP,pq._indexCount=pS,pq._indices=new Uint16Array(pB.getData().buffer,2*pP,pS);var pr=pR._DATA.offset,pY=pq._subIndexBufferStart,pC=pq._subIndexBufferCount,pU=pq._boneIndicesList,pu=pR._readData.getUint16();pY.length=pu,pC.length=pu,pU.length=pu;for(var pv=0;pv<pu;pv++){pY[pv]=pR._readData.getUint32(),pC[pv]=pR._readData.getUint32();var pL=pR._readData.getUint32(),pe=pR._readData.getUint32();pU[pv]=new Uint8Array(ph.slice(pr+pL,pr+pL+pe))}return pR._subMeshes.push(pq),!0},pR._strings=[],pR._readData=null,pR._version=null,pR._mesh=null,pR._subMeshes=null,pR._materialMap=null,pU(pR,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":pGh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":p_h.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":psh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":pch.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":pih.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":pXh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":pRh.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":pwh.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":pTh.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":puh.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":pCh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":pEh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":plh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":pWh.vertexDeclaration,"POSITION,NORMAL,UV,UV1":pbh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":pJh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":pDh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":peh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":pHh.vertexDeclaration,"POSITION,NORMAL,UV":pdh.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":pLh.vertexDeclaration,"POSITION,NORMAL,COLOR":pYh.vertexDeclaration,"POSITION,NORMAL,TANGENT":pAh.vertexDeclaration,"POSITION,NORMAL":prh.vertexDeclaration,"POSITION,UV":pKh.vertexDeclaration,POSITION:pBh.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":pNh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":p_h.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":psh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":pzh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":pih.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":pth.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":pRh.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":pIh.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":pTh.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":pUh.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":pCh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":pmh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":plh.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":pMh.vertexDeclaration,"POSITION,NORMAL,UV,UV1":pbh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":pnh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":pDh.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":peh.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":pkh.vertexDeclaration,"POSITION,NORMAL,UV":pdh.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":pvh.vertexDeclaration,"POSITION,NORMAL,COLOR":pYh.vertexDeclaration,"POSITION,NORMAL,TANGENT":pph.vertexDeclaration,"POSITION,NORMAL":prh.vertexDeclaration,"POSITION,UV":pKh.vertexDeclaration,POSITION:pBh.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),pR}(),pQh=function(){function pB(){}return pv(pB,"laya.d3.loaders.MeshReader"),pB.read=function(ph,pq,pf,pg,p$){var pP=new pR(ph);pP.pos=0;var pS=pP.readUTFString();switch(pS){case"LAYAMODEL:01":case"LAYASKINANI:01":pB._readVersion01(pP,pS,pq,pf,pg,p$);break;case"LAYAMODEL:02":pFh.parse(pP,pS,pq,pf,pg,p$);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":pZh.parse(pP,pS,pq,pg,p$);break;default:throw new Error("MeshReader: unknown mesh version.")}pq._setSubMeshes(pg)},pB._readVersion01=function(ph,pq,pf,pg,p$,pP){new pyh(ph,pq,pf,pg,p$,pP)},pB}(),poh=function(){function ph(ph,pq){this.min=null,this.max=null,this.min=ph,this.max=pq}pv(ph,"laya.d3.math.BoundBox");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.getCorners=function(ph){ph.length=8;var pq=this.min.elements,pf=this.max.elements,pg=pq[0],p$=pq[1],pP=pq[2],pS=pf[0],pB=pf[1],pr=pf[2];ph[0]=new pSq(pg,pB,pr),ph[1]=new pSq(pS,pB,pr),ph[2]=new pSq(pS,p$,pr),ph[3]=new pSq(pg,p$,pr),ph[4]=new pSq(pg,pB,pP),ph[5]=new pSq(pS,pB,pP),ph[6]=new pSq(pS,p$,pP),ph[7]=new pSq(pg,p$,pP)},pq.toDefault=function(){this.min.toDefault(),this.max.toDefault()},pq.cloneTo=function(ph){var pq=ph;this.min.cloneTo(pq.min),this.max.cloneTo(pq.max)},pq.clone=function(){var ph=new this.constructor(new pSq,new pSq);return this.cloneTo(ph),ph},ph.createfromPoints=function(ph,pq){if(null==ph)throw new Error("points");var pf=pq.min,pg=pq.max,p$=pf.elements;p$[0]=Number.MAX_VALUE,p$[1]=Number.MAX_VALUE,p$[2]=Number.MAX_VALUE;var pP=pg.elements;pP[0]=-Number.MAX_VALUE,pP[1]=-Number.MAX_VALUE,pP[2]=-Number.MAX_VALUE;for(var pS=0,pB=ph.length;pS<pB;++pS)pSq.min(pf,ph[pS],pf),pSq.max(pg,ph[pS],pg)},ph.merge=function(ph,pq,pf){pSq.min(ph.min,pq.min,pf.min),pSq.max(ph.max,pq.max,pf.max)},ph}(),pOh=function(){function pY(ph){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=ph,this._near=new pqq(new pSq),this._far=new pqq(new pSq),this._left=new pqq(new pSq),this._right=new pqq(new pSq),this._top=new pqq(new pSq),this._bottom=new pqq(new pSq),pY._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}pv(pY,"laya.d3.math.BoundFrustum");var ph=pY.prototype;return ph.equalsBoundFrustum=function(ph){return this._matrix.equalsOtherMatrix(ph.matrix)},ph.equalsObj=function(ph){if(ph instanceof laya.d3.math.BoundFrustum){var pq=ph;return this.equalsBoundFrustum(pq)}return!1},ph.getPlane=function(ph){switch(ph){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},ph.getCorners=function(ph){pY._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(ph[0]),pY._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(ph[1]),pY._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(ph[2]),pY._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(ph[3]),pY._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(ph[4]),pY._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(ph[5]),pY._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(ph[6]),pY._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(ph[7])},ph.containsPoint=function(ph){for(var pq=pqq.PlaneIntersectionType_Front,pf=pqq.PlaneIntersectionType_Front,pg=0;pg<6;pg++){switch(pg){case 0:pf=Collision.intersectsPlaneAndPoint(this._near,ph);break;case 1:pf=Collision.intersectsPlaneAndPoint(this._far,ph);break;case 2:pf=Collision.intersectsPlaneAndPoint(this._left,ph);break;case 3:pf=Collision.intersectsPlaneAndPoint(this._right,ph);break;case 4:pf=Collision.intersectsPlaneAndPoint(this._top,ph);break;case 5:pf=Collision.intersectsPlaneAndPoint(this._bottom,ph)}switch(pf){case pqq.PlaneIntersectionType_Back:return 0;case pqq.PlaneIntersectionType_Intersecting:pq=pqq.PlaneIntersectionType_Intersecting}}switch(pq){case pqq.PlaneIntersectionType_Intersecting:return 2;default:return 1}},ph.containsBoundBox=function(ph){for(var pq,pf=pY._tempV30,pg=pY._tempV31,p$=1,pP=0;pP<6;pP++){if(pq=this.getPlane(pP),this._getBoxToPlanePVertexNVertex(ph,pq.normal,pf,pg),Collision.intersectsPlaneAndPoint(pq,pf)===pqq.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(pq,pg)===pqq.PlaneIntersectionType_Back&&(p$=2)}return p$},ph.containsBoundSphere=function(ph){for(var pq=pqq.PlaneIntersectionType_Front,pf=pqq.PlaneIntersectionType_Front,pg=0;pg<6;pg++){switch(pg){case 0:pf=Collision.intersectsPlaneAndSphere(this._near,ph);break;case 1:pf=Collision.intersectsPlaneAndSphere(this._far,ph);break;case 2:pf=Collision.intersectsPlaneAndSphere(this._left,ph);break;case 3:pf=Collision.intersectsPlaneAndSphere(this._right,ph);break;case 4:pf=Collision.intersectsPlaneAndSphere(this._top,ph);break;case 5:pf=Collision.intersectsPlaneAndSphere(this._bottom,ph)}switch(pf){case pqq.PlaneIntersectionType_Back:return 0;case pqq.PlaneIntersectionType_Intersecting:pq=pqq.PlaneIntersectionType_Intersecting}}switch(pq){case pqq.PlaneIntersectionType_Intersecting:return 2;default:return 1}},ph._getBoxToPlanePVertexNVertex=function(ph,pq,pf,pg){var p$=ph.min,pP=p$.elements,pS=ph.max,pB=pS.elements,pr=pq.elements,pY=pr[0],pC=pr[1],pU=pr[2];p$.cloneTo(pf);var pu=pf.elements;0<=pY&&(pu[0]=pB[0]),0<=pC&&(pu[1]=pB[1]),0<=pU&&(pu[2]=pB[2]),pS.cloneTo(pg);var pv=pg.elements;0<=pY&&(pv[0]=pP[0]),0<=pC&&(pv[1]=pP[1]),0<=pU&&(pv[2]=pP[2])},pL(0,ph,"top",function(){return this._top}),pL(0,ph,"matrix",function(){return this._matrix},function(ph){this._matrix=ph,pY._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),pL(0,ph,"near",function(){return this._near}),pL(0,ph,"far",function(){return this._far}),pL(0,ph,"left",function(){return this._left}),pL(0,ph,"right",function(){return this._right}),pL(0,ph,"bottom",function(){return this._bottom}),pY._getPlanesFromMatrix=function(ph,pq,pf,pg,p$,pP,pS){var pB=ph.elements,pr=pB[0],pY=pB[1],pC=pB[2],pU=pB[3],pu=pB[4],pv=pB[5],pL=pB[6],pe=pB[7],pl=pB[8],p_=pB[9],pN=pB[10],pG=pB[11],pm=pB[12],pE=pB[13],pR=pB[14],pt=pB[15],pX=pq.normal.elements;pX[0]=pU+pC,pX[1]=pe+pL,pX[2]=pG+pN,pq.distance=pt+pR,pq.normalize();var pn=pf.normal.elements;pn[0]=pU-pC,pn[1]=pe-pL,pn[2]=pG-pN,pf.distance=pt-pR,pf.normalize();var pJ=pg.normal.elements;pJ[0]=pU+pr,pJ[1]=pe+pu,pJ[2]=pG+pl,pg.distance=pt+pm,pg.normalize();var pp=p$.normal.elements;pp[0]=pU-pr,pp[1]=pe-pu,pp[2]=pG-pl,p$.distance=pt-pm,p$.normalize();var pA=pP.normal.elements;pA[0]=pU-pY,pA[1]=pe-pv,pA[2]=pG-p_,pP.distance=pt-pE,pP.normalize();var pd=pS.normal.elements;pd[0]=pU+pY,pd[1]=pe+pv,pd[2]=pG+p_,pS.distance=pt+pE,pS.normalize()},pY._get3PlaneInterPoint=function(ph,pq,pf){var pg=ph.normal,p$=pq.normal,pP=pf.normal;pSq.cross(p$,pP,pY._tempV30),pSq.cross(pP,pg,pY._tempV31),pSq.cross(pg,p$,pY._tempV32);var pS=pSq.dot(pg,pY._tempV30),pB=pSq.dot(p$,pY._tempV31),pr=pSq.dot(pP,pY._tempV32);return pSq.scale(pY._tempV30,-ph.distance/pS,pY._tempV33),pSq.scale(pY._tempV31,-pq.distance/pB,pY._tempV34),pSq.scale(pY._tempV32,-pf.distance/pr,pY._tempV35),pSq.add(pY._tempV33,pY._tempV34,pY._tempV36),pSq.add(pY._tempV35,pY._tempV36,pY._tempV37),pY._tempV37},pU(pY,["_tempV30",function(){return this._tempV30=new pSq},"_tempV31",function(){return this._tempV31=new pSq},"_tempV32",function(){return this._tempV32=new pSq},"_tempV33",function(){return this._tempV33=new pSq},"_tempV34",function(){return this._tempV34=new pSq},"_tempV35",function(){return this._tempV35=new pSq},"_tempV36",function(){return this._tempV36=new pSq},"_tempV37",function(){return this._tempV37=new pSq}]),pY}(),pjh=function(){function pC(ph,pq){this.center=null,this.radius=NaN,this.center=ph,this.radius=pq}pv(pC,"laya.d3.math.BoundSphere");var ph=pC.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.toDefault=function(){this.center.toDefault(),this.radius=0},ph.intersectsRayDistance=function(ph){return Collision.intersectsRayAndSphereRD(ph,this)},ph.intersectsRayPoint=function(ph,pq){return Collision.intersectsRayAndSphereRP(ph,this,pq)},ph.cloneTo=function(ph){var pq=ph;this.center.cloneTo(pq.center),pq.radius=this.radius},ph.clone=function(){var ph=new this.constructor(new pSq,new pSq);return this.cloneTo(ph),ph},pC.createFromSubPoints=function(ph,pq,pf,pg){if(null==ph)throw new Error("points");if(pq<0||pq>=ph.length)throw new Error("start"+pq+"Must be in the range [0, "+(ph.length-1)+"]");if(pf<0||pq+pf>ph.length)throw new Error("count"+pf+"Must be in the range <= "+ph.length+"}");var p$=pq+pf,pP=pC._tempVector3;pP.elements[0]=0,pP.elements[1]=0,pP.elements[2]=0;for(var pS=pq;pS<p$;++pS)pSq.add(ph[pS],pP,pP);var pB=pg.center;pSq.scale(pP,1/pf,pB);var pr=0;for(pS=pq;pS<p$;++pS){var pY=pSq.distanceSquared(pB,ph[pS]);pr<pY&&(pr=pY)}pg.radius=Math.sqrt(pr)},pC.createfromPoints=function(ph,pq){if(null==ph)throw new Error("points");pC.createFromSubPoints(ph,0,ph.length,pq)},pU(pC,["_tempVector3",function(){return this._tempVector3=new pSq}]),pC}(),pxh=(function(){function ph(){}pv(ph,"laya.d3.math.ContainmentType"),ph.Disjoint=0,ph.Contains=1,ph.Intersects=2}(),function(){function pf(){}return pv(pf,"laya.d3.math.MathUtils3D"),pf.isZero=function(ph){return Math.abs(ph)<pf.zeroTolerance},pf.nearEqual=function(ph,pq){return!!pf.isZero(ph-pq)},pf.fastInvSqrt=function(ph){return pf.isZero(ph)?ph:1/Math.sqrt(ph)},pU(pf,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),pf}()),pah=function(){function pr(){var ph=this.elements=new Float32Array(9);ph[0]=1,ph[1]=0,ph[2]=0,ph[3]=0,ph[4]=1,ph[5]=0,ph[6]=0,ph[7]=0,ph[8]=1}pv(pr,"laya.d3.math.Matrix3x3");var ph=pr.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.determinant=function(){var ph=this.elements,pq=ph[0],pf=ph[1],pg=ph[2],p$=ph[3],pP=ph[4],pS=ph[5],pB=ph[6],pr=ph[7],pY=ph[8];return pq*(pY*pP-pS*pr)+pf*(-pY*p$+pS*pB)+pg*(pr*p$-pP*pB)},ph.translate=function(ph,pq){var pf=pq.elements,pg=this.elements,p$=ph.elements,pP=pg[0],pS=pg[1],pB=pg[2],pr=pg[3],pY=pg[4],pC=pg[5],pU=pg[6],pu=pg[7],pv=pg[8],pL=p$[0],pe=p$[1];pf[0]=pP,pf[1]=pS,pf[2]=pB,pf[3]=pr,pf[4]=pY,pf[5]=pC,pf[6]=pL*pP+pe*pr+pU,pf[7]=pL*pS+pe*pY+pu,pf[8]=pL*pB+pe*pC+pv},ph.rotate=function(ph,pq){var pf=pq.elements,pg=this.elements,p$=pg[0],pP=pg[1],pS=pg[2],pB=pg[3],pr=pg[4],pY=pg[5],pC=pg[6],pU=pg[7],pu=pg[8],pv=Math.sin(ph),pL=Math.cos(ph);pf[0]=pL*p$+pv*pB,pf[1]=pL*pP+pv*pr,pf[2]=pL*pS+pv*pY,pf[3]=pL*pB-pv*p$,pf[4]=pL*pr-pv*pP,pf[5]=pL*pY-pv*pS,pf[6]=pC,pf[7]=pU,pf[8]=pu},ph.scale=function(ph,pq){var pf=pq.elements,pg=this.elements,p$=ph.elements,pP=p$[0],pS=p$[1];pf[0]=pP*pg[0],pf[1]=pP*pg[1],pf[2]=pP*pg[2],pf[3]=pS*pg[3],pf[4]=pS*pg[4],pf[5]=pS*pg[5],pf[6]=pg[6],pf[7]=pg[7],pf[8]=pg[8]},ph.invert=function(ph){var pq=ph.elements,pf=this.elements,pg=pf[0],p$=pf[1],pP=pf[2],pS=pf[3],pB=pf[4],pr=pf[5],pY=pf[6],pC=pf[7],pU=pf[8],pu=pU*pB-pr*pC,pv=-pU*pS+pr*pY,pL=pC*pS-pB*pY,pe=pg*pu+p$*pv+pP*pL;pe||(ph=null),pe=1/pe,pq[0]=pu*pe,pq[1]=(-pU*p$+pP*pC)*pe,pq[2]=(pr*p$-pP*pB)*pe,pq[3]=pv*pe,pq[4]=(pU*pg-pP*pY)*pe,pq[5]=(-pr*pg+pP*pS)*pe,pq[6]=pL*pe,pq[7]=(-pC*pg+p$*pY)*pe,pq[8]=(pB*pg-p$*pS)*pe},ph.transpose=function(ph){var pq=ph.elements,pf=this.elements;if(ph===this){var pg=pf[1],p$=pf[2],pP=pf[5];pq[1]=pf[3],pq[2]=pf[6],pq[3]=pg,pq[5]=pf[7],pq[6]=p$,pq[7]=pP}else pq[0]=pf[0],pq[1]=pf[3],pq[2]=pf[6],pq[3]=pf[1],pq[4]=pf[4],pq[5]=pf[7],pq[6]=pf[2],pq[7]=pf[5],pq[8]=pf[8]},ph.identity=function(){var ph=this.elements;ph[0]=1,ph[1]=0,ph[2]=0,ph[3]=0,ph[4]=1,ph[5]=0,ph[6]=0,ph[7]=0,ph[8]=1},ph.cloneTo=function(ph){var pq,pf,pg;if((pf=this.elements)!==(pg=ph.elements))for(pq=0;pq<9;++pq)pg[pq]=pf[pq]},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pr.createFromTranslation=function(ph,pq){pq.elements;var pf=ph.elements;pq[0]=1,pq[1]=0,pq[2]=0,pq[3]=0,pq[4]=1,pq[5]=0,pq[6]=pf[0],pq[7]=pf[1],pq[8]=1},pr.createFromRotation=function(ph,pq){var pf=pq.elements,pg=Math.sin(ph),p$=Math.cos(ph);pf[0]=p$,pf[1]=pg,pf[2]=0,pf[3]=-pg,pf[4]=p$,pf[5]=0,pf[6]=0,pf[7]=0,pf[8]=1},pr.createFromScaling=function(ph,pq){var pf=pq.elements,pg=ph.elements;pf[0]=pg[0],pf[1]=0,pf[2]=0,pf[3]=0,pf[4]=pg[1],pf[5]=0,pf[6]=0,pf[7]=0,pf[8]=1},pr.createFromMatrix4x4=function(ph,pq){pq[0]=ph[0],pq[1]=ph[1],pq[2]=ph[2],pq[3]=ph[4],pq[4]=ph[5],pq[5]=ph[6],pq[6]=ph[8],pq[7]=ph[9],pq[8]=ph[10]},pr.multiply=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements,pS=p$[0],pB=p$[1],pr=p$[2],pY=p$[3],pC=p$[4],pU=p$[5],pu=p$[6],pv=p$[7],pL=p$[8],pe=pP[0],pl=pP[1],p_=pP[2],pN=pP[3],pG=pP[4],pm=pP[5],pE=pP[6],pR=pP[7],pt=pP[8];pg[0]=pe*pS+pl*pY+p_*pu,pg[1]=pe*pB+pl*pC+p_*pv,pg[2]=pe*pr+pl*pU+p_*pL,pg[3]=pN*pS+pG*pY+pm*pu,pg[4]=pN*pB+pG*pC+pm*pv,pg[5]=pN*pr+pG*pU+pm*pL,pg[6]=pE*pS+pR*pY+pt*pu,pg[7]=pE*pB+pR*pC+pt*pv,pg[8]=pE*pr+pR*pU+pt*pL},pr.lookAt=function(ph,pq,pf,pg){pSq.subtract(ph,pq,pr._tempV30),pSq.normalize(pr._tempV30,pr._tempV30),pSq.cross(pf,pr._tempV30,pr._tempV31),pSq.normalize(pr._tempV31,pr._tempV31),pSq.cross(pr._tempV30,pr._tempV31,pr._tempV32);var p$=pr._tempV30.elements,pP=pr._tempV31.elements,pS=pr._tempV32.elements,pB=pg.elements;pB[0]=pP[0],pB[3]=pP[1],pB[6]=pP[2],pB[1]=pS[0],pB[4]=pS[1],pB[7]=pS[2],pB[2]=p$[0],pB[5]=p$[1],pB[8]=p$[2]},pr.DEFAULT=new pr,pU(pr,["_tempV30",function(){return this._tempV30=new pSq},"_tempV31",function(){return this._tempV31=new pSq},"_tempV32",function(){return this._tempV32=new pSq}]),pr}(),phq=function(){function pn(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU,pu,pv,pL,pe){void 0===ph&&(ph=1),void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=0),void 0===p$&&(p$=0),void 0===pP&&(pP=1),void 0===pS&&(pS=0),void 0===pB&&(pB=0),void 0===pr&&(pr=0),void 0===pY&&(pY=0),void 0===pC&&(pC=1),void 0===pU&&(pU=0),void 0===pu&&(pu=0),void 0===pv&&(pv=0),void 0===pL&&(pL=0),void 0===pe&&(pe=1);var pl=this.elements=new Float32Array(16);pl[0]=ph,pl[1]=pq,pl[2]=pf,pl[3]=pg,pl[4]=p$,pl[5]=pP,pl[6]=pS,pl[7]=pB,pl[8]=pr,pl[9]=pY,pl[10]=pC,pl[11]=pU,pl[12]=pu,pl[13]=pv,pl[14]=pL,pl[15]=pe}pv(pn,"laya.d3.math.Matrix4x4");var ph=pn.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.getElementByRowColumn=function(ph,pq){if(ph<0||3<ph)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(pq<0||3<pq)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*ph+pq]},ph.setElementByRowColumn=function(ph,pq,pf){if(ph<0||3<ph)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(pq<0||3<pq)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*ph+pq]=pf},ph.equalsOtherMatrix=function(ph){var pq=this.elements,pf=ph.elements;return pxh.nearEqual(pq[0],pf[0])&&pxh.nearEqual(pq[1],pf[1])&&pxh.nearEqual(pq[2],pf[2])&&pxh.nearEqual(pq[3],pf[3])&&pxh.nearEqual(pq[4],pf[4])&&pxh.nearEqual(pq[5],pf[5])&&pxh.nearEqual(pq[6],pf[6])&&pxh.nearEqual(pq[7],pf[7])&&pxh.nearEqual(pq[8],pf[8])&&pxh.nearEqual(pq[9],pf[9])&&pxh.nearEqual(pq[10],pf[10])&&pxh.nearEqual(pq[11],pf[11])&&pxh.nearEqual(pq[12],pf[12])&&pxh.nearEqual(pq[13],pf[13])&&pxh.nearEqual(pq[14],pf[14])&&pxh.nearEqual(pq[15],pf[15])},ph.decomposeTransRotScale=function(ph,pq,pf){var pg=pn._tempMatrix4x4;return this.decomposeTransRotMatScale(ph,pg,pf)?(pfq.createFromMatrix4x4(pg,pq),!0):(pq.identity(),!1)},ph.decomposeTransRotMatScale=function(ph,pq,pf){var pg=this.elements,p$=ph.elements,pP=pq.elements,pS=pf.elements;p$[0]=pg[12],p$[1]=pg[13],p$[2]=pg[14];var pB=pg[0],pr=pg[1],pY=pg[2],pC=pg[4],pU=pg[5],pu=pg[6],pv=pg[8],pL=pg[9],pe=pg[10],pl=pS[0]=Math.sqrt(pB*pB+pr*pr+pY*pY),p_=pS[1]=Math.sqrt(pC*pC+pU*pU+pu*pu),pN=pS[2]=Math.sqrt(pv*pv+pL*pL+pe*pe);if(pxh.isZero(pl)||pxh.isZero(p_)||pxh.isZero(pN))return pP[1]=pP[2]=pP[3]=pP[4]=pP[6]=pP[7]=pP[8]=pP[9]=pP[11]=pP[12]=pP[13]=pP[14]=0,pP[0]=pP[5]=pP[10]=pP[15]=1,!1;var pG=pn._tempVector0,pm=pG.elements;pm[0]=pv/pN,pm[1]=pL/pN,pm[2]=pe/pN;var pE=pn._tempVector1,pR=pE.elements;pR[0]=pB/pl,pR[1]=pr/pl,pR[2]=pY/pl;var pt=pn._tempVector2;pSq.cross(pG,pE,pt);var pX=pn._tempVector1;return pSq.cross(pt,pG,pX),pP[3]=pP[7]=pP[11]=pP[12]=pP[13]=pP[14]=0,pP[15]=1,pP[0]=pX.x,pP[1]=pX.y,pP[2]=pX.z,pP[4]=pt.x,pP[5]=pt.y,pP[6]=pt.z,pP[8]=pG.x,pP[9]=pG.y,pP[10]=pG.z,pP[0]*pB+pP[1]*pr+pP[2]*pY<0&&(pS[0]=-pl),pP[4]*pC+pP[5]*pU+pP[6]*pu<0&&(pS[1]=-p_),pP[8]*pv+pP[9]*pL+pP[10]*pe<0&&(pS[2]=-pN),!0},ph.decomposeYawPitchRoll=function(ph){var pq=ph.elements,pf=Math.asin(-this.elements[9]);pq[1]=pf,Math.cos(pf)>pxh.zeroTolerance?(pq[2]=Math.atan2(this.elements[1],this.elements[5]),pq[0]=Math.atan2(this.elements[8],this.elements[10])):(pq[2]=Math.atan2(-this.elements[4],this.elements[0]),pq[0]=0)},ph.normalize=function(){var ph=this.elements,pq=ph[0],pf=ph[1],pg=ph[2],p$=Math.sqrt(pq*pq+pf*pf+pg*pg);if(!p$)return ph[0]=0,ph[1]=0,void(ph[2]=0);1!=p$&&(p$=1/p$,ph[0]=pq*p$,ph[1]=pf*p$,ph[2]=pg*p$)},ph.transpose=function(){var ph,pq;return pq=(ph=this.elements)[1],ph[1]=ph[4],ph[4]=pq,pq=ph[2],ph[2]=ph[8],ph[8]=pq,pq=ph[3],ph[3]=ph[12],ph[12]=pq,pq=ph[6],ph[6]=ph[9],ph[9]=pq,pq=ph[7],ph[7]=ph[13],ph[13]=pq,pq=ph[11],ph[11]=ph[14],ph[14]=pq,this},ph.invert=function(ph){var pq=this.elements,pf=ph.elements,pg=pq[0],p$=pq[1],pP=pq[2],pS=pq[3],pB=pq[4],pr=pq[5],pY=pq[6],pC=pq[7],pU=pq[8],pu=pq[9],pv=pq[10],pL=pq[11],pe=pq[12],pl=pq[13],p_=pq[14],pN=pq[15],pG=pg*pr-p$*pB,pm=pg*pY-pP*pB,pE=pg*pC-pS*pB,pR=p$*pY-pP*pr,pt=p$*pC-pS*pr,pX=pP*pC-pS*pY,pn=pU*pl-pu*pe,pJ=pU*p_-pv*pe,pp=pU*pN-pL*pe,pA=pu*p_-pv*pl,pd=pu*pN-pL*pl,pb=pv*pN-pL*p_,pi=pG*pb-pm*pd+pE*pA+pR*pp-pt*pJ+pX*pn;0!==Math.abs(pi)&&(pi=1/pi,pf[0]=(pr*pb-pY*pd+pC*pA)*pi,pf[1]=(pP*pd-p$*pb-pS*pA)*pi,pf[2]=(pl*pX-p_*pt+pN*pR)*pi,pf[3]=(pv*pt-pu*pX-pL*pR)*pi,pf[4]=(pY*pp-pB*pb-pC*pJ)*pi,pf[5]=(pg*pb-pP*pp+pS*pJ)*pi,pf[6]=(p_*pE-pe*pX-pN*pm)*pi,pf[7]=(pU*pX-pv*pE+pL*pm)*pi,pf[8]=(pB*pd-pr*pp+pC*pn)*pi,pf[9]=(p$*pp-pg*pd-pS*pn)*pi,pf[10]=(pe*pt-pl*pE+pN*pG)*pi,pf[11]=(pu*pE-pU*pt-pL*pG)*pi,pf[12]=(pr*pJ-pB*pA-pY*pn)*pi,pf[13]=(pg*pA-p$*pJ+pP*pn)*pi,pf[14]=(pl*pm-pe*pR-p_*pG)*pi,pf[15]=(pU*pR-pu*pm+pv*pG)*pi)},ph.identity=function(){var ph=this.elements;ph[1]=ph[2]=ph[3]=ph[4]=ph[6]=ph[7]=ph[8]=ph[9]=ph[11]=ph[12]=ph[13]=ph[14]=0,ph[0]=ph[5]=ph[10]=ph[15]=1},ph.cloneTo=function(ph){var pq,pf,pg;if((pf=this.elements)!==(pg=ph.elements))for(pq=0;pq<16;++pq)pg[pq]=pf[pq]},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},ph.getTranslationVector=function(ph){var pq=this.elements,pf=ph.elements;pf[0]=pq[12],pf[1]=pq[13],pf[2]=pq[14]},ph.setTranslationVector=function(ph){var pq=this.elements,pf=ph.elements;pq[12]=pf[0],pq[13]=pf[1],pq[14]=pf[2]},ph.getForward=function(ph){var pq=this.elements,pf=ph.elements;pf[0]=-pq[8],pf[1]=-pq[9],pf[2]=-pq[10]},ph.setForward=function(ph){var pq=this.elements,pf=ph.elements;pq[8]=-pf[0],pq[9]=-pf[1],pq[10]=-pf[2]},pn.createRotationX=function(ph,pq){var pf=pq.elements,pg=Math.sin(ph),p$=Math.cos(ph);pf[1]=pf[2]=pf[3]=pf[4]=pf[7]=pf[8]=pf[11]=pf[12]=pf[13]=pf[14]=0,pf[0]=pf[15]=1,pf[5]=pf[10]=p$,pf[6]=pg,pf[9]=-pg},pn.createRotationY=function(ph,pq){var pf=pq.elements,pg=Math.sin(ph),p$=Math.cos(ph);pf[1]=pf[3]=pf[4]=pf[6]=pf[7]=pf[9]=pf[11]=pf[12]=pf[13]=pf[14]=0,pf[5]=pf[15]=1,pf[0]=pf[10]=p$,pf[2]=-pg,pf[8]=pg},pn.createRotationZ=function(ph,pq){var pf=pq.elements,pg=Math.sin(ph),p$=Math.cos(ph);pf[2]=pf[3]=pf[6]=pf[7]=pf[8]=pf[9]=pf[11]=pf[12]=pf[13]=pf[14]=0,pf[10]=pf[15]=1,pf[0]=pf[5]=p$,pf[1]=pg,pf[4]=-pg},pn.createRotationYawPitchRoll=function(ph,pq,pf,pg){pfq.createFromYawPitchRoll(ph,pq,pf,pn._tempQuaternion),pn.createRotationQuaternion(pn._tempQuaternion,pg)},pn.createRotationAxis=function(ph,pq,pf){var pg=ph.elements,p$=pg[0],pP=pg[1],pS=pg[2],pB=Math.cos(pq),pr=Math.sin(pq),pY=p$*p$,pC=pP*pP,pU=pS*pS,pu=p$*pP,pv=p$*pS,pL=pP*pS,pe=pf.elements;pe[3]=pe[7]=pe[11]=pe[12]=pe[13]=pe[14]=0,pe[15]=1,pe[0]=pY+pB*(1-pY),pe[1]=pu-pB*pu+pr*pS,pe[2]=pv-pB*pv-pr*pP,pe[4]=pu-pB*pu-pr*pS,pe[5]=pC+pB*(1-pC),pe[6]=pL-pB*pL+pr*p$,pe[8]=pv-pB*pv+pr*pP,pe[9]=pL-pB*pL-pr*p$,pe[10]=pU+pB*(1-pU)},pn.createRotationQuaternion=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=pf[0],pP=pf[1],pS=pf[2],pB=pf[3],pr=p$*p$,pY=pP*pP,pC=pS*pS,pU=p$*pP,pu=pS*pB,pv=pS*p$,pL=pP*pB,pe=pP*pS,pl=p$*pB;pg[3]=pg[7]=pg[11]=pg[12]=pg[13]=pg[14]=0,pg[15]=1,pg[0]=1-2*(pY+pC),pg[1]=2*(pU+pu),pg[2]=2*(pv-pL),pg[4]=2*(pU-pu),pg[5]=1-2*(pC+pr),pg[6]=2*(pe+pl),pg[8]=2*(pv+pL),pg[9]=2*(pe-pl),pg[10]=1-2*(pY+pr)},pn.createTranslate=function(ph,pq){var pf=ph.elements,pg=pq.elements;pg[4]=pg[8]=pg[1]=pg[9]=pg[2]=pg[6]=pg[3]=pg[7]=pg[11]=0,pg[0]=pg[5]=pg[10]=pg[15]=1,pg[12]=pf[0],pg[13]=pf[1],pg[14]=pf[2]},pn.createScaling=function(ph,pq){var pf=ph.elements,pg=pq.elements;pg[0]=pf[0],pg[5]=pf[1],pg[10]=pf[2],pg[1]=pg[4]=pg[8]=pg[12]=pg[9]=pg[13]=pg[2]=pg[6]=pg[14]=pg[3]=pg[7]=pg[11]=0,pg[15]=1},pn.multiply=function(ph,pq,pf){var pg,p$,pP,pS,pB,pr,pY,pC;for(p$=pf.elements,pP=ph.elements,p$===(pS=pq.elements)&&(pS=pS.slice()),pg=0;pg<4;pg++)pB=pP[pg],pr=pP[pg+4],pY=pP[pg+8],pC=pP[pg+12],p$[pg]=pB*pS[0]+pr*pS[1]+pY*pS[2]+pC*pS[3],p$[pg+4]=pB*pS[4]+pr*pS[5]+pY*pS[6]+pC*pS[7],p$[pg+8]=pB*pS[8]+pr*pS[9]+pY*pS[10]+pC*pS[11],p$[pg+12]=pB*pS[12]+pr*pS[13]+pY*pS[14]+pC*pS[15]},pn.createFromQuaternion=function(ph,pq){var pf=pq.elements,pg=ph.elements,p$=pg[0],pP=pg[1],pS=pg[2],pB=pg[3],pr=p$+p$,pY=pP+pP,pC=pS+pS,pU=p$*pr,pu=pP*pr,pv=pP*pY,pL=pS*pr,pe=pS*pY,pl=pS*pC,p_=pB*pr,pN=pB*pY,pG=pB*pC;pf[0]=1-pv-pl,pf[1]=pu+pG,pf[2]=pL-pN,pf[3]=0,pf[4]=pu-pG,pf[5]=1-pU-pl,pf[6]=pe+p_,pf[7]=0,pf[8]=pL+pN,pf[9]=pe-p_,pf[10]=1-pU-pv,pf[11]=0,pf[12]=0,pf[13]=0,pf[14]=0,pf[15]=1},pn.createAffineTransformation=function(ph,pq,pf,pg){var p$=ph.elements,pP=pq.elements,pS=pf.elements,pB=pg.elements,pr=pP[0],pY=pP[1],pC=pP[2],pU=pP[3],pu=pr+pr,pv=pY+pY,pL=pC+pC,pe=pr*pu,pl=pr*pv,p_=pr*pL,pN=pY*pv,pG=pY*pL,pm=pC*pL,pE=pU*pu,pR=pU*pv,pt=pU*pL,pX=pS[0],pn=pS[1],pJ=pS[2];pB[0]=(1-(pN+pm))*pX,pB[1]=(pl+pt)*pX,pB[2]=(p_-pR)*pX,pB[3]=0,pB[4]=(pl-pt)*pn,pB[5]=(1-(pe+pm))*pn,pB[6]=(pG+pE)*pn,pB[7]=0,pB[8]=(p_+pR)*pJ,pB[9]=(pG-pE)*pJ,pB[10]=(1-(pe+pN))*pJ,pB[11]=0,pB[12]=p$[0],pB[13]=p$[1],pB[14]=p$[2],pB[15]=1},pn.createLookAt=function(ph,pq,pf,pg){var p$=pg.elements,pP=pn._tempVector0,pS=pn._tempVector1,pB=pn._tempVector2;pSq.subtract(ph,pq,pB),pSq.normalize(pB,pB),pSq.cross(pf,pB,pP),pSq.normalize(pP,pP),pSq.cross(pB,pP,pS),pg.identity(),p$[0]=pP.x,p$[4]=pP.y,p$[8]=pP.z,p$[1]=pS.x,p$[5]=pS.y,p$[9]=pS.z,p$[2]=pB.x,p$[6]=pB.y,p$[10]=pB.z,p$[12]=-pSq.dot(pP,ph),p$[13]=-pSq.dot(pS,ph),p$[14]=-pSq.dot(pB,ph)},pn.createPerspective=function(ph,pq,pf,pg,p$){var pP=p$.elements,pS=1/Math.tan(ph/2),pB=1/(pf-pg);pP[0]=pS/pq,pP[5]=pS,pP[10]=(pg+pf)*pB,pP[11]=-1,pP[14]=2*pg*pf*pB,pP[1]=pP[2]=pP[3]=pP[4]=pP[6]=pP[7]=pP[8]=pP[9]=pP[12]=pP[13]=pP[15]=0},pn.createOrthoOffCenterRH=function(ph,pq,pf,pg,p$,pP,pS){var pB=pS.elements,pr=1/(ph-pq),pY=1/(pf-pg),pC=1/(p$-pP);pB[1]=pB[2]=pB[3]=pB[4]=pB[6]=pB[7]=pB[8]=pB[9]=pB[11]=0,pB[15]=1,pB[0]=-2*pr,pB[5]=-2*pY,pB[10]=2*pC,pB[12]=(ph+pq)*pr,pB[13]=(pg+pf)*pY,pB[14]=(pP+p$)*pC},pn.translation=function(ph,pq){var pf=ph.elements,pg=pq.elements;pg[0]=pg[5]=pg[10]=pg[15]=1,pg[12]=pf[0],pg[13]=pf[1],pg[14]=pf[2]},pU(pn,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new pn},"_tempVector0",function(){return this._tempVector0=new pSq},"_tempVector1",function(){return this._tempVector1=new pSq},"_tempVector2",function(){return this._tempVector2=new pSq},"_tempQuaternion",function(){return this._tempQuaternion=new pfq},"DEFAULT",function(){return this.DEFAULT=new pn},"ZERO",function(){return this.ZERO=new pn(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),pn}(),pqq=(function(){function pG(ph,pq){this.extents=null,this.transformation=null,this.extents=ph,this.transformation=pq}pv(pG,"laya.d3.math.OrientedBoundBox");var ph=pG.prototype;ph.getCorners=function(ph){var pq=pG._tempV30.elements,pf=pG._tempV31.elements,pg=pG._tempV32.elements,p$=this.extents.elements;pq[0]=p$[0],pq[1]=pq[2]=0,pf[1]=p$[1],pf[0]=pf[2]=0,pg[2]=p$[2],pg[0]=pg[1]=0,pSq.TransformNormal(pG._tempV30,this.transformation,pG._tempV30),pSq.TransformNormal(pG._tempV31,this.transformation,pG._tempV31),pSq.TransformNormal(pG._tempV32,this.transformation,pG._tempV32);var pP=pG._tempV33;this.transformation.getTranslationVector(pP),ph.length=8,pSq.add(pP,pG._tempV30,pG._tempV34),pSq.add(pG._tempV34,pG._tempV31,pG._tempV34),pSq.add(pG._tempV34,pG._tempV32,ph[0]),pSq.add(pP,pG._tempV30,pG._tempV34),pSq.add(pG._tempV34,pG._tempV31,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV32,ph[1]),pSq.subtract(pP,pG._tempV30,pG._tempV34),pSq.add(pG._tempV34,pG._tempV31,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV32,ph[2]),pSq.subtract(pP,pG._tempV30,pG._tempV34),pSq.add(pG._tempV34,pG._tempV31,pG._tempV34),pSq.add(pG._tempV34,pG._tempV32,ph[3]),pSq.add(pP,pG._tempV30,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV31,pG._tempV34),pSq.add(pG._tempV34,pG._tempV32,ph[4]),pSq.add(pP,pG._tempV30,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV31,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV32,ph[5]),pSq.subtract(pP,pG._tempV30,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV31,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV32,ph[6]),pSq.subtract(pP,pG._tempV30,pG._tempV34),pSq.subtract(pG._tempV34,pG._tempV31,pG._tempV34),pSq.add(pG._tempV34,pG._tempV32,ph[7])},ph.transform=function(ph){phq.multiply(this.transformation,ph,this.transformation)},ph.scale=function(ph){pSq.multiply(this.extents,ph,this.extents)},ph.translate=function(ph){this.transformation.getTranslationVector(pG._tempV30),pSq.add(pG._tempV30,ph,pG._tempV31),this.transformation.setTranslationVector(pG._tempV31)},ph.Size=function(ph){pSq.scale(this.extents,2,ph)},ph.getSize=function(ph){var pq=this.extents.elements;pG._tempV30.x=pq[0],pG._tempV31.y=pq[1],pG._tempV32.z=pq[2],pSq.TransformNormal(pG._tempV30,this.transformation,pG._tempV30),pSq.TransformNormal(pG._tempV31,this.transformation,pG._tempV31),pSq.TransformNormal(pG._tempV31,this.transformation,pG._tempV32);var pf=ph.elements;pf[0]=pSq.scalarLength(pG._tempV30),pf[1]=pSq.scalarLength(pG._tempV31),pf[2]=pSq.scalarLength(pG._tempV32)},ph.getSizeSquared=function(ph){var pq=this.extents.elements;pG._tempV30.x=pq[0],pG._tempV31.y=pq[1],pG._tempV32.z=pq[2],pSq.TransformNormal(pG._tempV30,this.transformation,pG._tempV30),pSq.TransformNormal(pG._tempV31,this.transformation,pG._tempV31),pSq.TransformNormal(pG._tempV31,this.transformation,pG._tempV32);var pf=ph.elements;pf[0]=pSq.scalarLengthSquared(pG._tempV30),pf[1]=pSq.scalarLengthSquared(pG._tempV31),pf[2]=pSq.scalarLengthSquared(pG._tempV32)},ph.getCenter=function(ph){this.transformation.getTranslationVector(ph)},ph.containsPoint=function(ph){var pq=this.extents.elements,pf=pq[0],pg=pq[1],p$=pq[2];this.transformation.invert(pG._tempM0),pSq.transformCoordinate(ph,pG._tempM0,pG._tempV30);var pP=pG._tempV30.elements,pS=Math.abs(pP[0]),pB=Math.abs(pP[1]),pr=Math.abs(pP[2]);return pxh.nearEqual(pS,pf)&&pxh.nearEqual(pB,pg)&&pxh.nearEqual(pr,p$)?2:pS<pf&&pB<pg&&pr<p$?1:0},ph.containsPoints=function(ph){var pq=this.extents.elements,pf=pq[0],pg=pq[1],p$=pq[2];this.transformation.invert(pG._tempM0);for(var pP=!0,pS=!1,pB=0;pB<ph.length;pB++){pSq.transformCoordinate(ph[pB],pG._tempM0,pG._tempV30);var pr=pG._tempV30.elements,pY=Math.abs(pr[0]),pC=Math.abs(pr[1]),pU=Math.abs(pr[2]);pxh.nearEqual(pY,pf)&&pxh.nearEqual(pC,pg)&&pxh.nearEqual(pU,p$)&&(pS=!0),pY<pf&&pC<pg&&pU<p$?pS=!0:pP=!1}return pP?1:pS?2:0},ph.containsSphere=function(ph,pq){void 0===pq&&(pq=!1);var pf=this.extents.elements,pg=pf[0],p$=pf[1],pP=pf[2],pS=ph.radius;this.transformation.invert(pG._tempM0),pSq.transformCoordinate(ph.center,pG._tempM0,pG._tempV30);var pB=NaN;if(pB=pq?pS:(pSq.scale(pSq.UnitX,pS,pG._tempV31),pSq.TransformNormal(pG._tempV31,pG._tempM0,pG._tempV31),pSq.scalarLength(pG._tempV31)),pSq.scale(this.extents,-1,pG._tempV32),pSq.Clamp(pG._tempV30,pG._tempV32,this.extents,pG._tempV33),pB*pB<pSq.distanceSquared(pG._tempV30,pG._tempV33))return 0;var pr=pG._tempV30.elements,pY=pr[0],pC=pr[1],pU=pr[2],pu=pG._tempV32.elements,pv=pu[0],pL=pu[1],pe=pu[2];return pv+pB<=pY&&pY<=pg-pB&&pB<pg-pv&&pL+pB<=pC&&pC<=p$-pB&&pB<p$-pL&&pe+pB<=pU&&pU<=pP-pB&&pB<pP-pe?1:2},ph.containsOrientedBoundBox=function(ph){var pq=0,pf=0;ph.getCorners(pG._corners);var pg=this.containsPoints(pG._corners);if(0!=pg)return pg;var p$=this.extents.elements;ph.extents.cloneTo(pG._tempV35);var pP=pG._tempV35.elements;pG._getRows(this.transformation,pG._rows1),pG._getRows(ph.transformation,pG._rows2);var pS=NaN;for(pq=0;pq<4;pq++)for(pf=0;pf<4;pf++)3==pq||3==pf?(pG._tempM0.setElementByRowColumn(pq,pf,0),pG._tempM1.setElementByRowColumn(pq,pf,0)):(pS=pSq.dot(pG._rows1[pq],pG._rows2[pf]),pG._tempM0.setElementByRowColumn(pq,pf,pS),pG._tempM1.setElementByRowColumn(pq,pf,Math.abs(pS)));ph.getCenter(pG._tempV34),this.getCenter(pG._tempV36),pSq.subtract(pG._tempV34,pG._tempV36,pG._tempV30);var pB=pG._tempV31.elements;pB[0]=pSq.dot(pG._tempV30,pG._rows1[0]),pB[1]=pSq.dot(pG._tempV30,pG._rows1[1]),pB[2]=pSq.dot(pG._tempV30,pG._rows1[2]);var pr=pG._tempV32.elements,pY=pG._tempV33.elements;for(pq=0;pq<3;pq++)if(pr[0]=pG._tempM1.getElementByRowColumn(pq,0),pr[1]=pG._tempM1.getElementByRowColumn(pq,1),pr[2]=pG._tempM1.getElementByRowColumn(pq,2),p$[pq]+pSq.dot(pG._tempV35,pG._tempV32)<Math.abs(pB[pq]))return 0;for(pf=0;pf<3;pf++)if(pr[0]=pG._tempM1.getElementByRowColumn(0,pf),pr[1]=pG._tempM1.getElementByRowColumn(1,pf),pr[2]=pG._tempM1.getElementByRowColumn(2,pf),pY[0]=pG._tempM0.getElementByRowColumn(0,pf),pY[1]=pG._tempM0.getElementByRowColumn(1,pf),pY[2]=pG._tempM0.getElementByRowColumn(2,pf),pSq.dot(this.extents,pG._tempV32)+pP[pf]<Math.abs(pSq.dot(pG._tempV31,pG._tempV33)))return 0;for(pq=0;pq<3;pq++)for(pf=0;pf<3;pf++){var pC=(pq+1)%3,pU=(pq+2)%3,pu=(pf+1)%3,pv=(pf+2)%3;if(p$[pC]*pG._tempM1.getElementByRowColumn(pU,pf)+p$[pU]*pG._tempM1.getElementByRowColumn(pC,pf)+(pP[pu]*pG._tempM1.getElementByRowColumn(pq,pv)+pP[pv]*pG._tempM1.getElementByRowColumn(pq,pu))<Math.abs(pB[pU]*pG._tempM0.getElementByRowColumn(pC,pf)-pB[pC]*pG._tempM0.getElementByRowColumn(pU,pf)))return 0}return 2},ph.containsLine=function(ph,pq){pG._corners[0]=ph,pG._corners[1]=pq;var pf=this.containsPoints(pG._corners);if(0!=pf)return pf;var pg=this.extents.elements,p$=pg[0],pP=pg[1],pS=pg[2];this.transformation.invert(pG._tempM0),pSq.transformCoordinate(ph,pG._tempM0,pG._tempV30),pSq.transformCoordinate(pq,pG._tempM0,pG._tempV31),pSq.add(pG._tempV30,pG._tempV31,pG._tempV32),pSq.scale(pG._tempV32,.5,pG._tempV32),pSq.subtract(pG._tempV30,pG._tempV32,pG._tempV33);var pB=pG._tempV33.elements,pr=pB[0],pY=pB[1],pC=pB[2],pU=pG._tempV34.elements,pu=pU[0]=Math.abs(pB[0]),pv=pU[1]=Math.abs(pB[1]),pL=pU[2]=Math.abs(pB[2]),pe=pG._tempV32.elements,pl=pe[0],p_=pe[1],pN=pe[2];return Math.abs(pl)>p$+pu?0:Math.abs(p_)>pP+pv?0:Math.abs(pN)>pS+pL?0:Math.abs(p_*pC-pN*pY)>pP*pL+pS*pv?0:Math.abs(pl*pC-pN*pr)>p$*pL+pS*pu?0:Math.abs(pl*pY-p_*pr)>p$*pv+pP*pu?0:2},ph.containsBoundBox=function(ph){var pq=0,pf=0,pg=ph.min,p$=ph.max;ph.getCorners(pG._corners);var pP=this.containsPoints(pG._corners);if(0!=pP)return pP;pSq.subtract(p$,pg,pG._tempV30),pSq.scale(pG._tempV30,.5,pG._tempV30),pSq.add(pg,pG._tempV30,pG._tempV30),pSq.subtract(p$,pG._tempV30,pG._tempV31);var pS=this.extents.elements,pB=pG._tempV31.elements;pG._getRows(this.transformation,pG._rows1),this.transformation.invert(pG._tempM0);for(pq=0;pq<3;pq++)for(pf=0;pf<3;pf++)pG._tempM1.setElementByRowColumn(pq,pf,Math.abs(pG._tempM0.getElementByRowColumn(pq,pf)));this.getCenter(pG._tempV35),pSq.subtract(pG._tempV30,pG._tempV35,pG._tempV32);var pr=pG._tempV31.elements;pr[0]=pSq.dot(pG._tempV32,pG._rows1[0]),pr[1]=pSq.dot(pG._tempV32,pG._rows1[1]),pr[2]=pSq.dot(pG._tempV32,pG._rows1[2]);var pY=pG._tempV33.elements,pC=pG._tempV34.elements;for(pq=0;pq<3;pq++)if(pY[0]=pG._tempM1.getElementByRowColumn(pq,0),pY[1]=pG._tempM1.getElementByRowColumn(pq,1),pY[2]=pG._tempM1.getElementByRowColumn(pq,2),pS[pq]+pSq.dot(pG._tempV31,pG._tempV33)<Math.abs(pr[pq]))return 0;for(pf=0;pf<3;pf++)if(pY[0]=pG._tempM1.getElementByRowColumn(0,pf),pY[1]=pG._tempM1.getElementByRowColumn(1,pf),pY[2]=pG._tempM1.getElementByRowColumn(2,pf),pC[0]=pG._tempM0.getElementByRowColumn(0,pf),pC[1]=pG._tempM0.getElementByRowColumn(1,pf),pC[2]=pG._tempM0.getElementByRowColumn(2,pf),pSq.dot(this.extents,pG._tempV33)+pB[pf]<Math.abs(pSq.dot(pG._tempV31,pG._tempV34)))return 0;for(pq=0;pq<3;pq++)for(pf=0;pf<3;pf++){var pU=(pq+1)%3,pu=(pq+2)%3,pv=(pf+1)%3,pL=(pf+2)%3;if(pS[pU]*pG._tempM1.getElementByRowColumn(pu,pf)+pS[pu]*pG._tempM1.getElementByRowColumn(pU,pf)+(pB[pv]*pG._tempM1.getElementByRowColumn(pq,pL)+pB[pL]*pG._tempM1.getElementByRowColumn(pq,pv))<Math.abs(pr[pu]*pG._tempM0.getElementByRowColumn(pU,pf)-pr[pU]*pG._tempM0.getElementByRowColumn(pu,pf)))return 0}return 2},ph.intersectsRay=function(ph,pq){pSq.scale(this.extents,-1,pG._tempV30),this.transformation.invert(pG._tempM0),pSq.TransformNormal(ph.direction,pG._tempM0,pG._ray.direction),pSq.transformCoordinate(ph.origin,pG._tempM0,pG._ray.origin),pG._boxBound1.min=pG._tempV30,pG._boxBound1.max=this.extents;var pf=Collision.intersectsRayAndBoxRP(pG._ray,pG._boxBound1,pq);return-1!==pf&&pSq.transformCoordinate(pq,this.transformation,pq),pf},ph._getLocalCorners=function(ph){ph.length=8;var pq=this.extents.elements;pG._tempV30.x=pq[0],pG._tempV31.y=pq[1],pG._tempV32.z=pq[2],pSq.add(pG._tempV30,pG._tempV31,pG._tempV33),pSq.add(pG._tempV33,pG._tempV32,ph[0]),pSq.add(pG._tempV30,pG._tempV31,pG._tempV33),pSq.subtract(pG._tempV33,pG._tempV32,ph[1]),pSq.subtract(pG._tempV31,pG._tempV30,pG._tempV33),pSq.subtract(pG._tempV33,pG._tempV30,ph[2]),pSq.subtract(pG._tempV31,pG._tempV30,pG._tempV33),pSq.add(pG._tempV33,pG._tempV32,ph[3]),pSq.subtract(pG._tempV30,pG._tempV31,pG._tempV33),pSq.add(pG._tempV33,pG._tempV32,ph[4]),pSq.subtract(pG._tempV30,pG._tempV31,pG._tempV33),pSq.subtract(pG._tempV33,pG._tempV32,ph[5]),pSq.scale(ph[0],-1,ph[6]),pSq.subtract(pG._tempV32,pG._tempV30,pG._tempV33),pSq.subtract(pG._tempV33,pG._tempV31,ph[7])},ph.equals=function(ph){return this.extents==ph.extents&&this.transformation==ph.transformation},ph.cloneTo=function(ph){var pq=ph;this.extents.cloneTo(pq.extents),this.transformation.cloneTo(pq.transformation)},pG.createByBoundBox=function(ph,pq){var pf=ph.min,pg=ph.max;pSq.subtract(pg,pf,pG._tempV30),pSq.scale(pG._tempV30,.5,pG._tempV30),pSq.add(pf,pG._tempV30,pG._tempV31),pSq.subtract(pg,pG._tempV31,pG._tempV32),phq.translation(pG._tempV31,pG._tempM0);var p$=pG._tempV32.clone(),pP=pG._tempM0.clone();pq.extents=p$,pq.transformation=pP},pG.createByMinAndMaxVertex=function(ph,pq){return pSq.subtract(pq,ph,pG._tempV30),pSq.scale(pG._tempV30,.5,pG._tempV30),pSq.add(ph,pG._tempV30,pG._tempV31),pSq.subtract(pq,pG._tempV31,pG._tempV32),phq.translation(pG._tempV31,pG._tempM0),new pG(pG._tempV32,pG._tempM0)},pG._getRows=function(ph,pq){pq.length=3;var pf=ph.elements,pg=pq[0].elements;pg[0]=pf[0],pg[1]=pf[1],pg[2]=pf[2];var p$=pq[1].elements;p$[0]=pf[4],p$[1]=pf[5],p$[2]=pf[6];var pP=pq[2].elements;pP[0]=pf[8],pP[1]=pf[9],pP[2]=pf[10]},pG.getObbtoObbMatrix4x4=function(ph,pq,pf,pg){var p$=ph.transformation,pP=pq.transformation;if(pf){pG._getRows(p$,pG._rows1),pG._getRows(pP,pG._rows2);for(var pS=0;pS<3;pS++)for(var pB=0;pB<3;pB++)pg.setElementByRowColumn(pS,pB,pSq.dot(pG._rows2[pS],pG._rows1[pB]));pq.getCenter(pG._tempV30),ph.getCenter(pG._tempV31),pSq.subtract(pG._tempV30,pG._tempV31,pG._tempV32);var pr=pg.elements;pr[12]=pSq.dot(pG._tempV32,pG._rows1[0]),pr[13]=pSq.dot(pG._tempV32,pG._rows1[1]),pr[14]=pSq.dot(pG._tempV32,pG._rows1[2]),pr[15]=1}else p$.invert(pG._tempM0),phq.multiply(pP,pG._tempM0,pg)},pG.merge=function(ph,pq,pf){var pg=ph.extents,p$=ph.transformation;pG.getObbtoObbMatrix4x4(ph,pq,pf,pG._tempM0),pq._getLocalCorners(pG._corners),pSq.transformCoordinate(pG._corners[0],pG._tempM0,pG._corners[0]),pSq.transformCoordinate(pG._corners[1],pG._tempM0,pG._corners[1]),pSq.transformCoordinate(pG._corners[2],pG._tempM0,pG._corners[2]),pSq.transformCoordinate(pG._corners[3],pG._tempM0,pG._corners[3]),pSq.transformCoordinate(pG._corners[4],pG._tempM0,pG._corners[4]),pSq.transformCoordinate(pG._corners[5],pG._tempM0,pG._corners[5]),pSq.transformCoordinate(pG._corners[6],pG._tempM0,pG._corners[6]),pSq.transformCoordinate(pG._corners[7],pG._tempM0,pG._corners[7]),pSq.scale(pg,-1,pG._boxBound1.min),pg.cloneTo(pG._boxBound1.max),poh.createfromPoints(pG._corners,pG._boxBound2),poh.merge(pG._boxBound2,pG._boxBound1,pG._boxBound3);var pP=pG._boxBound3.min,pS=pG._boxBound3.max;pSq.subtract(pS,pP,pG._tempV30),pSq.scale(pG._tempV30,.5,pG._tempV30),pSq.add(pP,pG._tempV30,pG._tempV32),pSq.subtract(pS,pG._tempV32,pg),pSq.transformCoordinate(pG._tempV32,p$,pG._tempV33)},pU(pG,["_tempV30",function(){return this._tempV30=new pSq},"_tempV31",function(){return this._tempV31=new pSq},"_tempV32",function(){return this._tempV32=new pSq},"_tempV33",function(){return this._tempV33=new pSq},"_tempV34",function(){return this._tempV34=new pSq},"_tempV35",function(){return this._tempV35=new pSq},"_tempV36",function(){return this._tempV36=new pSq},"_tempM0",function(){return this._tempM0=new phq},"_tempM1",function(){return this._tempM1=new phq},"_corners",function(){return this._corners=[new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq]},"_rows1",function(){return this._rows1=[new pSq,new pSq,new pSq]},"_rows2",function(){return this._rows2=[new pSq,new pSq,new pSq]},"_ray",function(){return this._ray=new p$q(new pSq,new pSq)},"_boxBound1",function(){return this._boxBound1=new poh(new pSq,new pSq)},"_boxBound2",function(){return this._boxBound2=new poh(new pSq,new pSq)},"_boxBound3",function(){return this._boxBound3=new poh(new pSq,new pSq)}])}(),function(){function pE(ph,pq){this.normal=null,this.distance=NaN,void 0===pq&&(pq=0),this.normal=ph,this.distance=pq}return pv(pE,"laya.d3.math.Plane"),pE.prototype.normalize=function(){var ph=this.normal.elements,pq=ph[0],pf=ph[1],pg=ph[2],p$=1/Math.sqrt(pq*pq+pf*pf+pg*pg);ph[0]=pq*p$,ph[1]=pf*p$,ph[2]=pg*p$,this.distance*=p$},pE.createPlaneBy3P=function(ph,pq,pf){var pg=ph.elements,p$=pq.elements,pP=pf.elements,pS=p$[0]-pg[0],pB=p$[1]-pg[1],pr=p$[2]-pg[2],pY=pP[0]-pg[0],pC=pP[1]-pg[1],pU=pP[2]-pg[2],pu=pB*pU-pr*pC,pv=pr*pY-pS*pU,pL=pS*pC-pB*pY,pe=1/Math.sqrt(pu*pu+pv*pv+pL*pL),pl=pu*pe,p_=pv*pe,pN=pL*pe,pG=pE._TEMPVec3.elements;pG[0]=pl,pG[1]=p_,pG[2]=pN;var pm=-(pl*pg[0]+p_*pg[1]+pN*pg[2]);return new pE(pE._TEMPVec3,pm)},pE.PlaneIntersectionType_Back=0,pE.PlaneIntersectionType_Front=1,pE.PlaneIntersectionType_Intersecting=2,pU(pE,["_TEMPVec3",function(){return this._TEMPVec3=new pSq}]),pE}()),pfq=function(){function p$(ph,pq,pf,pg){this.elements=new Float32Array(4),void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=1),this.elements[0]=ph,this.elements[1]=pq,this.elements[2]=pf,this.elements[3]=pg}pv(p$,"laya.d3.math.Quaternion");var ph=p$.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.scaling=function(ph,pq){var pf=pq.elements,pg=this.elements;pf[0]=pg[0]*ph,pf[1]=pg[1]*ph,pf[2]=pg[2]*ph,pf[3]=pg[3]*ph},ph.normalize=function(ph){var pq=ph.elements,pf=this.elements,pg=pf[0],p$=pf[1],pP=pf[2],pS=pf[3],pB=pg*pg+p$*p$+pP*pP+pS*pS;0<pB&&(pB=1/Math.sqrt(pB),pq[0]=pg*pB,pq[1]=p$*pB,pq[2]=pP*pB,pq[3]=pS*pB)},ph.length=function(){var ph=this.elements,pq=ph[0],pf=ph[1],pg=ph[2],p$=ph[3];return Math.sqrt(pq*pq+pf*pf+pg*pg+p$*p$)},ph.rotateX=function(ph,pq){var pf=pq.elements,pg=this.elements;ph*=.5;var p$=pg[0],pP=pg[1],pS=pg[2],pB=pg[3],pr=Math.sin(ph),pY=Math.cos(ph);pf[0]=p$*pY+pB*pr,pf[1]=pP*pY+pS*pr,pf[2]=pS*pY-pP*pr,pf[3]=pB*pY-p$*pr},ph.rotateY=function(ph,pq){var pf=pq.elements,pg=this.elements;ph*=.5;var p$=pg[0],pP=pg[1],pS=pg[2],pB=pg[3],pr=Math.sin(ph),pY=Math.cos(ph);pf[0]=p$*pY-pS*pr,pf[1]=pP*pY+pB*pr,pf[2]=pS*pY+p$*pr,pf[3]=pB*pY-pP*pr},ph.rotateZ=function(ph,pq){var pf=pq.elements,pg=this.elements;ph*=.5;var p$=pg[0],pP=pg[1],pS=pg[2],pB=pg[3],pr=Math.sin(ph),pY=Math.cos(ph);pf[0]=p$*pY+pP*pr,pf[1]=pP*pY-p$*pr,pf[2]=pS*pY+pB*pr,pf[3]=pB*pY-pS*pr},ph.getYawPitchRoll=function(ph){pSq.transformQuat(pSq.ForwardRH,this,p$.TEMPVector31),pSq.transformQuat(pSq.Up,this,p$.TEMPVector32);var pq=p$.TEMPVector32.elements;p$.angleTo(pSq.ZERO,p$.TEMPVector31,p$.TEMPVector33);var pf=p$.TEMPVector33.elements;pf[0]==Math.PI/2?(pf[1]=p$.arcTanAngle(pq[2],pq[0]),pf[2]=0):pf[0]==-Math.PI/2?(pf[1]=p$.arcTanAngle(-pq[2],-pq[0]),pf[2]=0):(phq.createRotationY(-pf[1],p$.TEMPMatrix0),phq.createRotationX(-pf[0],p$.TEMPMatrix1),pSq.transformCoordinate(p$.TEMPVector32,p$.TEMPMatrix0,p$.TEMPVector32),pSq.transformCoordinate(p$.TEMPVector32,p$.TEMPMatrix1,p$.TEMPVector32),pf[2]=p$.arcTanAngle(pq[1],-pq[0])),pf[1]<=-Math.PI&&(pf[1]=Math.PI),pf[2]<=-Math.PI&&(pf[2]=Math.PI),pf[1]>=Math.PI&&pf[2]>=Math.PI&&(pf[1]=0,pf[2]=0,pf[0]=Math.PI-pf[0]);var pg=ph.elements;pg[0]=pf[1],pg[1]=pf[0],pg[2]=pf[2]},ph.invert=function(ph){var pq=ph.elements,pf=this.elements,pg=pf[0],p$=pf[1],pP=pf[2],pS=pf[3],pB=pg*pg+p$*p$+pP*pP+pS*pS,pr=pB?1/pB:0;pq[0]=-pg*pr,pq[1]=-p$*pr,pq[2]=-pP*pr,pq[3]=pS*pr},ph.identity=function(){var ph=this.elements;ph[0]=0,ph[1]=0,ph[2]=0,ph[3]=1},ph.fromArray=function(ph,pq){void 0===pq&&(pq=0),this.elements[0]=ph[pq+0],this.elements[1]=ph[pq+1],this.elements[2]=ph[pq+2],this.elements[3]=ph[pq+3]},ph.cloneTo=function(ph){var pq,pf,pg;if((pf=this.elements)!==(pg=ph.elements))for(pq=0;pq<4;++pq)pg[pq]=pf[pq]},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},ph.equals=function(ph){var pq=this.elements,pf=ph.elements;return pxh.nearEqual(pq[0],pf[0])&&pxh.nearEqual(pq[1],pf[1])&&pxh.nearEqual(pq[2],pf[2])&&pxh.nearEqual(pq[3],pf[3])},ph.lengthSquared=function(){var ph=this.elements[0],pq=this.elements[1],pf=this.elements[2],pg=this.elements[3];return ph*ph+pq*pq+pf*pf+pg*pg},pL(0,ph,"x",function(){return this.elements[0]}),pL(0,ph,"y",function(){return this.elements[1]}),pL(0,ph,"z",function(){return this.elements[2]}),pL(0,ph,"w",function(){return this.elements[3]}),p$.createFromYawPitchRoll=function(ph,pq,pf,pg){var p$=.5*pf,pP=.5*pq,pS=.5*ph,pB=Math.sin(p$),pr=Math.cos(p$),pY=Math.sin(pP),pC=Math.cos(pP),pU=Math.sin(pS),pu=Math.cos(pS),pv=pg.elements;pv[0]=pu*pY*pr+pU*pC*pB,pv[1]=pU*pC*pr-pu*pY*pB,pv[2]=pu*pC*pB-pU*pY*pr,pv[3]=pu*pC*pr+pU*pY*pB},p$.multiply=function(ph,pq,pf){var pg=ph.elements,p$=pq.elements,pP=pf.elements,pS=pg[0],pB=pg[1],pr=pg[2],pY=pg[3],pC=p$[0],pU=p$[1],pu=p$[2],pv=p$[3],pL=pB*pu-pr*pU,pe=pr*pC-pS*pu,pl=pS*pU-pB*pC,p_=pS*pC+pB*pU+pr*pu;pP[0]=pS*pv+pC*pY+pL,pP[1]=pB*pv+pU*pY+pe,pP[2]=pr*pv+pu*pY+pl,pP[3]=pY*pv-p_},p$.arcTanAngle=function(ph,pq){return 0==ph?1==pq?Math.PI/2:-Math.PI/2:0<ph?Math.atan(pq/ph):ph<0?0<pq?Math.atan(pq/ph)+Math.PI:Math.atan(pq/ph)-Math.PI:0},p$.angleTo=function(ph,pq,pf){pSq.subtract(pq,ph,p$.TEMPVector30),pSq.normalize(p$.TEMPVector30,p$.TEMPVector30),pf.elements[0]=Math.asin(p$.TEMPVector30.y),pf.elements[1]=p$.arcTanAngle(-p$.TEMPVector30.z,-p$.TEMPVector30.x)},p$.createFromAxisAngle=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements;pq*=.5;var pP=Math.sin(pq);pg[0]=pP*p$[0],pg[1]=pP*p$[1],pg[2]=pP*p$[2],pg[3]=Math.cos(pq)},p$.createFromMatrix3x3=function(ph,pq){var pf,pg=pq.elements,p$=ph.elements,pP=p$[0]+p$[4]+p$[8];if(0<pP)pf=Math.sqrt(pP+1),pg[3]=.5*pf,pf=.5/pf,pg[0]=(p$[5]-p$[7])*pf,pg[1]=(p$[6]-p$[2])*pf,pg[2]=(p$[1]-p$[3])*pf;else{var pS=0;p$[4]>p$[0]&&(pS=1),p$[8]>p$[3*pS+pS]&&(pS=2);var pB=(pS+1)%3,pr=(pS+2)%3;pf=Math.sqrt(p$[3*pS+pS]-p$[3*pB+pB]-p$[3*pr+pr]+1),pg[pS]=.5*pf,pf=.5/pf,pg[3]=(p$[3*pB+pr]-p$[3*pr+pB])*pf,pg[pB]=(p$[3*pB+pS]+p$[3*pS+pB])*pf,pg[pr]=(p$[3*pr+pS]+p$[3*pS+pr])*pf}},p$.createFromMatrix4x4=function(ph,pq){var pf,pg,p$=ph.elements,pP=pq.elements,pS=p$[0]+p$[5]+p$[10];0<pS?(pf=Math.sqrt(pS+1),pP[3]=.5*pf,pf=.5/pf,pP[0]=(p$[6]-p$[9])*pf,pP[1]=(p$[8]-p$[2])*pf,pP[2]=(p$[1]-p$[4])*pf):p$[0]>=p$[5]&&p$[0]>=p$[10]?(pg=.5/(pf=Math.sqrt(1+p$[0]-p$[5]-p$[10])),pP[0]=.5*pf,pP[1]=(p$[1]+p$[4])*pg,pP[2]=(p$[2]+p$[8])*pg,pP[3]=(p$[6]-p$[9])*pg):p$[5]>p$[10]?(pg=.5/(pf=Math.sqrt(1+p$[5]-p$[0]-p$[10])),pP[0]=(p$[4]+p$[1])*pg,pP[1]=.5*pf,pP[2]=(p$[9]+p$[6])*pg,pP[3]=(p$[8]-p$[2])*pg):(pg=.5/(pf=Math.sqrt(1+p$[10]-p$[0]-p$[5])),pP[0]=(p$[8]+p$[2])*pg,pP[1]=(p$[9]+p$[6])*pg,pP[2]=.5*pf,pP[3]=(p$[1]-p$[4])*pg)},p$.slerp=function(ph,pq,pf,pg){var p$,pP,pS,pB,pr,pY=ph.elements,pC=pq.elements,pU=pg.elements,pu=pY[0],pv=pY[1],pL=pY[2],pe=pY[3],pl=pC[0],p_=pC[1],pN=pC[2],pG=pC[3];return(pP=pu*pl+pv*p_+pL*pN+pe*pG)<0&&(pP=-pP,pl=-pl,p_=-p_,pN=-pN,pG=-pG),pr=1e-6<1-pP?(p$=Math.acos(pP),pS=Math.sin(p$),pB=Math.sin((1-pf)*p$)/pS,Math.sin(pf*p$)/pS):(pB=1-pf,pf),pU[0]=pB*pu+pr*pl,pU[1]=pB*pv+pr*p_,pU[2]=pB*pL+pr*pN,pU[3]=pB*pe+pr*pG,pU},p$.lerp=function(ph,pq,pf,pg){var p$=pg.elements,pP=ph.elements,pS=pq.elements,pB=pP[0],pr=pP[1],pY=pP[2],pC=pP[3];p$[0]=pB+pf*(pS[0]-pB),p$[1]=pr+pf*(pS[1]-pr),p$[2]=pY+pf*(pS[2]-pY),p$[3]=pC+pf*(pS[3]-pC)},p$.add=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=p$[0]+pP[0],pg[1]=p$[1]+pP[1],pg[2]=p$[2]+pP[2],pg[3]=p$[3]+pP[3]},p$.dot=function(ph,pq){var pf=ph.elements,pg=pq.elements;return pf[0]*pg[0]+pf[1]*pg[1]+pf[2]*pg[2]+pf[3]*pg[3]},p$.rotationLookAt=function(ph,pq,pf){p$.lookAt(pSq.ZERO,ph,pq,pf)},p$.lookAt=function(ph,pq,pf,pg){pah.lookAt(ph,pq,pf,p$._tempMatrix3x3),p$.rotationMatrix(p$._tempMatrix3x3,pg)},p$.invert=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=ph.lengthSquared();pxh.isZero(p$)||(p$=1/p$,pg[0]=-pf[0]*p$,pg[1]=-pf[1]*p$,pg[2]=-pf[2]*p$,pg[3]=pf[3]*p$)},p$.rotationMatrix=function(ph,pq){var pf=ph.elements,pg=pf[0],p$=pf[1],pP=pf[2],pS=pf[3],pB=pf[4],pr=pf[5],pY=pf[6],pC=pf[7],pU=pf[8],pu=pq.elements,pv=NaN,pL=NaN,pe=pg+pB+pU;0<pe?(pv=Math.sqrt(pe+1),pu[3]=.5*pv,pv=.5/pv,pu[0]=(pr-pC)*pv,pu[1]=(pY-pP)*pv,pu[2]=(p$-pS)*pv):pB<=pg&&pU<=pg?(pL=.5/(pv=Math.sqrt(1+pg-pB-pU)),pu[0]=.5*pv,pu[1]=(p$+pS)*pL,pu[2]=(pP+pY)*pL,pu[3]=(pr-pC)*pL):pU<pB?(pL=.5/(pv=Math.sqrt(1+pB-pg-pU)),pu[0]=(pS+p$)*pL,pu[1]=.5*pv,pu[2]=(pC+pr)*pL,pu[3]=(pY-pP)*pL):(pL=.5/(pv=Math.sqrt(1+pU-pg-pB)),pu[0]=(pY+pP)*pL,pu[1]=(pC+pr)*pL,pu[2]=.5*pv,pu[3]=(p$-pS)*pL)},p$.DEFAULT=new p$,pU(p$,["TEMPVector30",function(){return this.TEMPVector30=new pSq},"TEMPVector31",function(){return this.TEMPVector31=new pSq},"TEMPVector32",function(){return this.TEMPVector32=new pSq},"TEMPVector33",function(){return this.TEMPVector33=new pSq},"TEMPMatrix0",function(){return this.TEMPMatrix0=new phq},"TEMPMatrix1",function(){return this.TEMPMatrix1=new phq},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new pah},"NAN",function(){return this.NAN=new p$(NaN,NaN,NaN,NaN)}]),p$}(),pgq=function(){function ph(ph){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=ph,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}pv(ph,"laya.d3.math.Rand");var pq=ph.prototype;return pq.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},pq.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},pq.getSignedFloat=function(){return 2*this.getFloat()-1},pL(0,pq,"seed",function(){return this.seeds[0]},function(ph){this.seeds[0]=ph,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),ph.getFloatFromInt=function(ph){return 1/8388607*(8388607&ph)},ph.getByteFromInt=function(ph){return(8388607&ph)>>>15},ph}(),p$q=(function(){function p$(ph){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(ph instanceof Array)||4!==ph.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|ph[0],this._state0L=0|ph[1],this._state1U=0|ph[2],this._state1L=0|ph[3]}pv(p$,"laya.d3.math.RandX");var ph=p$.prototype;ph.randomint=function(){var ph=this._state0U,pq=this._state0L,pf=this._state1U,pg=this._state1L,p$=(pg>>>0)+(pq>>>0),pP=pf+ph+(p$/2>>>31)>>>0,pS=p$>>>0,pB=0,pr=0;pB=(ph^=pB=ph<<23|(-512&pq)>>>9)^(this._state0U=pf),pr=(pq^=pr=pq<<23)^(this._state0L=pg);pB^=ph>>>18,pr^=pq>>>18|(262143&ph)<<14;return pB^=pf>>>5,pr^=pg>>>5|(31&pf)<<27,this._state1U=pB,this._state1L=pr,[pP,pS]},ph.random=function(){var ph=this.randomint(),pq=ph[0],pf=1023<<20|pq>>>12,pg=0|(ph[1]>>>12|(4095&pq)<<20);return p$._CONVERTION_BUFFER.setUint32(0,pf,!1),p$._CONVERTION_BUFFER.setUint32(4,pg,!1),pgq._CONVERTION_BUFFER.getFloat64(0,!1)-1},pU(p$,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new pgq([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function ph(ph,pq){this.origin=null,this.direction=null,this.origin=ph,this.direction=pq}return pv(ph,"laya.d3.math.Ray"),ph}()),pPq=function(){function ph(ph,pq){this.elements=new Float32Array(2),void 0===ph&&(ph=0),void 0===pq&&(pq=0);var pf=this.elements;pf[0]=ph,pf[1]=pq}pv(ph,"laya.d3.math.Vector2");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.fromArray=function(ph,pq){void 0===pq&&(pq=0),this.elements[0]=ph[pq+0],this.elements[1]=ph[pq+1]},pq.cloneTo=function(ph){var pq=ph.elements,pf=this.elements;pq[0]=pf[0],pq[1]=pf[1]},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"x",function(){return this.elements[0]},function(ph){this.elements[0]=ph}),pL(0,pq,"y",function(){return this.elements[1]},function(ph){this.elements[1]=ph}),ph.scale=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements;pg[0]=p$[0]*pq,pg[1]=p$[1]*pq},pU(ph,["ZERO",function(){return this.ZERO=new ph(0,0)},"ONE",function(){return this.ONE=new ph(1,1)}]),ph}(),pSq=function(){function pC(ph,pq,pf){this.elements=new Float32Array(3),void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0);var pg=this.elements;pg[0]=ph,pg[1]=pq,pg[2]=pf}pv(pC,"laya.d3.math.Vector3");var ph=pC.prototype;return pE.imps(ph,{"laya.d3.core.IClone":!0}),ph.fromArray=function(ph,pq){void 0===pq&&(pq=0),this.elements[0]=ph[pq+0],this.elements[1]=ph[pq+1],this.elements[2]=ph[pq+2]},ph.cloneTo=function(ph){var pq=ph.elements,pf=this.elements;pq[0]=pf[0],pq[1]=pf[1],pq[2]=pf[2]},ph.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},ph.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},ph.reset=function(ph,pq,pf){this.elements[0]=ph,this.elements[1]=pq,this.elements[2]=pf},pL(0,ph,"x",function(){return this.elements[0]},function(ph){this.elements[0]=ph}),pL(0,ph,"y",function(){return this.elements[1]},function(ph){this.elements[1]=ph}),pL(0,ph,"z",function(){return this.elements[2]},function(ph){this.elements[2]=ph}),pC.distanceSquared=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=pf[0]-pg[0],pP=pf[1]-pg[1],pS=pf[2]-pg[2];return p$*p$+pP*pP+pS*pS},pC.distance=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=pf[0]-pg[0],pP=pf[1]-pg[1],pS=pf[2]-pg[2];return Math.sqrt(p$*p$+pP*pP+pS*pS)},pC.min=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=Math.min(p$[0],pP[0]),pg[1]=Math.min(p$[1],pP[1]),pg[2]=Math.min(p$[2],pP[2])},pC.max=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=Math.max(p$[0],pP[0]),pg[1]=Math.max(p$[1],pP[1]),pg[2]=Math.max(p$[2],pP[2])},pC.transformQuat=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements,pS=p$[0],pB=p$[1],pr=p$[2],pY=pP[0],pC=pP[1],pU=pP[2],pu=pP[3],pv=pu*pS+pC*pr-pU*pB,pL=pu*pB+pU*pS-pY*pr,pe=pu*pr+pY*pB-pC*pS,pl=-pY*pS-pC*pB-pU*pr;pg[0]=pv*pu+pl*-pY+pL*-pU-pe*-pC,pg[1]=pL*pu+pl*-pC+pe*-pY-pv*-pU,pg[2]=pe*pu+pl*-pU+pv*-pC-pL*-pY},pC.scalarLength=function(ph){var pq=ph.elements,pf=pq[0],pg=pq[1],p$=pq[2];return Math.sqrt(pf*pf+pg*pg+p$*p$)},pC.scalarLengthSquared=function(ph){var pq=ph.elements,pf=pq[0],pg=pq[1],p$=pq[2];return pf*pf+pg*pg+p$*p$},pC.normalize=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=pf[0],pP=pf[1],pS=pf[2],pB=p$*p$+pP*pP+pS*pS;0<pB&&(pB=1/Math.sqrt(pB),pg[0]=pf[0]*pB,pg[1]=pf[1]*pB,pg[2]=pf[2]*pB)},pC.multiply=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=p$[0]*pP[0],pg[1]=p$[1]*pP[1],pg[2]=p$[2]*pP[2]},pC.scale=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements;pg[0]=p$[0]*pq,pg[1]=p$[1]*pq,pg[2]=p$[2]*pq},pC.lerp=function(ph,pq,pf,pg){var p$=pg.elements,pP=ph.elements,pS=pq.elements,pB=pP[0],pr=pP[1],pY=pP[2];p$[0]=pB+pf*(pS[0]-pB),p$[1]=pr+pf*(pS[1]-pr),p$[2]=pY+pf*(pS[2]-pY)},pC.transformV3ToV3=function(ph,pq,pf){var pg=pC._tempVector4;pC.transformV3ToV4(ph,pq,pg);var p$=pg.elements,pP=pf.elements;pP[0]=p$[0],pP[1]=p$[1],pP[2]=p$[2]},pC.transformV3ToV4=function(ph,pq,pf){var pg=ph.elements,p$=pg[0],pP=pg[1],pS=pg[2],pB=pq.elements,pr=pf.elements;pr[0]=p$*pB[0]+pP*pB[4]+pS*pB[8]+pB[12],pr[1]=p$*pB[1]+pP*pB[5]+pS*pB[9]+pB[13],pr[2]=p$*pB[2]+pP*pB[6]+pS*pB[10]+pB[14],pr[3]=p$*pB[3]+pP*pB[7]+pS*pB[11]+pB[15]},pC.TransformNormal=function(ph,pq,pf){var pg=ph.elements,p$=pg[0],pP=pg[1],pS=pg[2],pB=pq.elements,pr=pf.elements;pr[0]=p$*pB[0]+pP*pB[4]+pS*pB[8],pr[1]=p$*pB[1]+pP*pB[5]+pS*pB[9],pr[2]=p$*pB[2]+pP*pB[6]+pS*pB[10]},pC.transformCoordinate=function(ph,pq,pf){var pg=pC._tempVector4.elements,p$=ph.elements,pP=p$[0],pS=p$[1],pB=p$[2],pr=pq.elements;pg[0]=pP*pr[0]+pS*pr[4]+pB*pr[8]+pr[12],pg[1]=pP*pr[1]+pS*pr[5]+pB*pr[9]+pr[13],pg[2]=pP*pr[2]+pS*pr[6]+pB*pr[10]+pr[14],pg[3]=1/(pP*pr[3]+pS*pr[7]+pB*pr[11]+pr[15]);var pY=pf.elements;pY[0]=pg[0]*pg[3],pY[1]=pg[1]*pg[3],pY[2]=pg[2]*pg[3]},pC.Clamp=function(ph,pq,pf,pg){var p$=ph.elements,pP=p$[0],pS=p$[1],pB=p$[2],pr=pq.elements,pY=pr[0],pC=pr[1],pU=pr[2],pu=pf.elements,pv=pu[0],pL=pu[1],pe=pu[2],pl=pg.elements;pP=(pP=pv<pP?pv:pP)<pY?pY:pP,pS=(pS=pL<pS?pL:pS)<pC?pC:pS,pB=(pB=pe<pB?pe:pB)<pU?pU:pB,pl[0]=pP,pl[1]=pS,pl[2]=pB},pC.add=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=p$[0]+pP[0],pg[1]=p$[1]+pP[1],pg[2]=p$[2]+pP[2]},pC.subtract=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=p$[0]-pP[0],pg[1]=p$[1]-pP[1],pg[2]=p$[2]-pP[2]},pC.cross=function(ph,pq,pf){var pg=ph.elements,p$=pq.elements,pP=pf.elements,pS=pg[0],pB=pg[1],pr=pg[2],pY=p$[0],pC=p$[1],pU=p$[2];pP[0]=pB*pU-pr*pC,pP[1]=pr*pY-pS*pU,pP[2]=pS*pC-pB*pY},pC.dot=function(ph,pq){var pf=ph.elements,pg=pq.elements;return pf[0]*pg[0]+pf[1]*pg[1]+pf[2]*pg[2]},pC.equals=function(ph,pq){var pf=ph.elements,pg=pq.elements;return pxh.nearEqual(Math.abs(pf[0]),Math.abs(pg[0]))&&pxh.nearEqual(Math.abs(pf[1]),Math.abs(pg[1]))&&pxh.nearEqual(Math.abs(pf[2]),Math.abs(pg[2]))},pC.ZERO=new pC(0,0,0),pC.ONE=new pC(1,1,1),pC.NegativeUnitX=new pC(-1,0,0),pC.UnitX=new pC(1,0,0),pC.UnitY=new pC(0,1,0),pC.UnitZ=new pC(0,0,1),pC.ForwardRH=new pC(0,0,-1),pC.ForwardLH=new pC(0,0,1),pC.Up=new pC(0,1,0),pC.NAN=new pC(NaN,NaN,NaN),pU(pC,["_tempVector4",function(){return this._tempVector4=new pBq}]),pC}(),pBq=function(){function ph(ph,pq,pf,pg){this.elements=new Float32Array(4),void 0===ph&&(ph=0),void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=0);var p$=this.elements;p$[0]=ph,p$[1]=pq,p$[2]=pf,p$[3]=pg}pv(ph,"laya.d3.math.Vector4");var pq=ph.prototype;return pE.imps(pq,{"laya.d3.core.IClone":!0}),pq.fromArray=function(ph,pq){void 0===pq&&(pq=0),this.elements[0]=ph[pq+0],this.elements[1]=ph[pq+1],this.elements[2]=ph[pq+2],this.elements[3]=ph[pq+3]},pq.cloneTo=function(ph){var pq=ph.elements,pf=this.elements;pq[0]=pf[0],pq[1]=pf[1],pq[2]=pf[2],pq[3]=pf[3]},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pq.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},pq.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},pL(0,pq,"x",function(){return this.elements[0]},function(ph){this.elements[0]=ph}),pL(0,pq,"y",function(){return this.elements[1]},function(ph){this.elements[1]=ph}),pL(0,pq,"z",function(){return this.elements[2]},function(ph){this.elements[2]=ph}),pL(0,pq,"w",function(){return this.elements[3]},function(ph){this.elements[3]=ph}),ph.lerp=function(ph,pq,pf,pg){var p$=pg.elements,pP=ph.elements,pS=pq.elements,pB=pP[0],pr=pP[1],pY=pP[2],pC=pP[3];p$[0]=pB+pf*(pS[0]-pB),p$[1]=pr+pf*(pS[1]-pr),p$[2]=pY+pf*(pS[2]-pY),p$[3]=pC+pf*(pS[3]-pC)},ph.transformByM4x4=function(ph,pq,pf){var pg=ph.elements,p$=pg[0],pP=pg[1],pS=pg[2],pB=pg[3],pr=pq.elements,pY=pf.elements;pY[0]=p$*pr[0]+pP*pr[4]+pS*pr[8]+pB*pr[12],pY[1]=p$*pr[1]+pP*pr[5]+pS*pr[9]+pB*pr[13],pY[2]=p$*pr[2]+pP*pr[6]+pS*pr[10]+pB*pr[14],pY[3]=p$*pr[3]+pP*pr[7]+pS*pr[11]+pB*pr[15]},ph.equals=function(ph,pq){var pf=ph.elements,pg=pq.elements;return pxh.nearEqual(Math.abs(pf[0]),Math.abs(pg[0]))&&pxh.nearEqual(Math.abs(pf[1]),Math.abs(pg[1]))&&pxh.nearEqual(Math.abs(pf[2]),Math.abs(pg[2]))&&pxh.nearEqual(Math.abs(pf[3]),Math.abs(pg[3]))},ph.normalize=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=ph.length();0<p$&&(pg[0]=pf[0]*p$,pg[1]=pf[1]*p$,pg[2]=pf[2]*p$,pg[3]=pf[3]*p$)},ph.add=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=p$[0]+pP[0],pg[1]=p$[1]+pP[1],pg[2]=p$[2]+pP[2],pg[3]=p$[3]+pP[3]},ph.subtract=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=p$[0]-pP[0],pg[1]=p$[1]-pP[1],pg[2]=p$[2]-pP[2],pg[3]=p$[3]-pP[3]},ph.multiply=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=p$[0]*pP[0],pg[1]=p$[1]*pP[1],pg[2]=p$[2]*pP[2],pg[3]=p$[3]*pP[3]},ph.scale=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements;pg[0]=p$[0]*pq,pg[1]=p$[1]*pq,pg[2]=p$[2]*pq,pg[3]=p$[3]*pq},ph.Clamp=function(ph,pq,pf,pg){var p$=ph.elements,pP=p$[0],pS=p$[1],pB=p$[2],pr=p$[3],pY=pq.elements,pC=pY[0],pU=pY[1],pu=pY[2],pv=pY[3],pL=pf.elements,pe=pL[0],pl=pL[1],p_=pL[2],pN=pL[3],pG=pg.elements;pP=(pP=pe<pP?pe:pP)<pC?pC:pP,pS=(pS=pl<pS?pl:pS)<pU?pU:pS,pB=(pB=p_<pB?p_:pB)<pu?pu:pB,pr=(pr=pN<pr?pN:pr)<pv?pv:pr,pG[0]=pP,pG[1]=pS,pG[2]=pB,pG[3]=pr},ph.distanceSquared=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=pf[0]-pg[0],pP=pf[1]-pg[1],pS=pf[2]-pg[2],pB=pf[3]-pg[3];return p$*p$+pP*pP+pS*pS+pB*pB},ph.distance=function(ph,pq){var pf=ph.elements,pg=pq.elements,p$=pf[0]-pg[0],pP=pf[1]-pg[1],pS=pf[2]-pg[2],pB=pf[3]-pg[3];return Math.sqrt(p$*p$+pP*pP+pS*pS+pB*pB)},ph.dot=function(ph,pq){var pf=ph.elements,pg=pq.elements;return pf[0]*pg[0]+pf[1]*pg[1]+pf[2]*pg[2]+pf[3]*pg[3]},ph.min=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=Math.min(p$[0],pP[0]),pg[1]=Math.min(p$[1],pP[1]),pg[2]=Math.min(p$[2],pP[2]),pg[3]=Math.min(p$[3],pP[3])},ph.max=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq.elements;pg[0]=Math.max(p$[0],pP[0]),pg[1]=Math.max(p$[1],pP[1]),pg[2]=Math.max(p$[2],pP[2]),pg[3]=Math.max(p$[3],pP[3])},pU(ph,["ZERO",function(){return this.ZERO=new ph},"ONE",function(){return this.ONE=new ph(1,1,1,1)},"UnitX",function(){return this.UnitX=new ph(1,0,0,0)},"UnitY",function(){return this.UnitY=new ph(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new ph(0,0,1,0)},"UnitW",function(){return this.UnitW=new ph(0,0,0,1)}]),ph}(),prq=function(){function pP(ph,pq,pf,pg){this.minDepth=0,this.maxDepth=1,this.x=ph,this.y=pq,this.width=pf,this.height=pg}pv(pP,"laya.d3.math.Viewport");var ph=pP.prototype;return ph.project=function(ph,pq,pf){pSq.transformV3ToV3(ph,pq,pf);var pg=ph.elements,p$=pq.elements,pP=pf.elements,pS=pg[0]*p$[3]+pg[1]*p$[7]+pg[2]*p$[11]+p$[15];1!==pS&&(pP[0]=pP[0]/pS,pP[1]=pP[1]/pS,pP[2]=pP[2]/pS),pP[0]=.5*(pP[0]+1)*this.width+this.x,pP[1]=.5*(1-pP[1])*this.height+this.y,pP[2]=pP[2]*(this.maxDepth-this.minDepth)+this.minDepth},ph.unprojectFromMat=function(ph,pq,pf){var pg=ph.elements,p$=pq.elements,pP=pf.elements;pP[0]=(pg[0]-this.x)/this.width*2-1,pP[1]=-((pg[1]-this.y)/this.height*2-1);var pS=(this.maxDepth-this.minDepth)/2;pP[2]=(pg[2]-this.minDepth-pS)/pS;var pB=pP[0]*p$[3]+pP[1]*p$[7]+pP[2]*p$[11]+p$[15];pSq.transformV3ToV3(pf,pq,pf),1!==pB&&(pP[0]=pP[0]/pB,pP[1]=pP[1]/pB,pP[2]=pP[2]/pB)},ph.unprojectFromWVP=function(ph,pq,pf,pg,p$){phq.multiply(pq,pf,pP._tempMatrix4x4),pg&&phq.multiply(pP._tempMatrix4x4,pg,pP._tempMatrix4x4),pP._tempMatrix4x4.invert(pP._tempMatrix4x4),this.unprojectFromMat(ph,pP._tempMatrix4x4,p$)},pU(pP,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new phq}]),pP}(),pYq=function(){function pA(ph){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=ph,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}pv(pA,"laya.d3.resource.models.SubMesh");var ph=pA.prototype;return pE.imps(ph,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),ph._getVertexBuffer=function(ph){return void 0===ph&&(ph=0),0===ph?this._vertexBuffer:null},ph._getIndexBuffer=function(){return this._indexBuffer},ph._getStaticBatchBakedVertexs=function(ph,pq){var pf,pg,p$=this._vertexBuffer,pP=p$.vertexDeclaration,pS=pP.getVertexElementByUsage(0).offset/4,pB=pP.getVertexElementByUsage(3).offset/4,pr=pq.meshRender.lightmapScaleOffset,pY=0,pC=0,pU=0,pu=0,pv=0,pL=0;if(pr)if(pg=pP.getVertexElementByUsage(15))pU=pP.vertexStride/4,pf=0<this._vertexCount?p$.getData().slice(this._vertexStart*pU,(this._vertexStart+this._vertexCount)*pU):p$.getData().slice(),pu=pg.offset/4;else{pU=(pL=pP.vertexStride/4)+2,pf=this._vertexCount?new Float32Array(this._vertexCount*(p$.vertexDeclaration.vertexStride/4+2)):new Float32Array(p$.vertexCount*(p$.vertexDeclaration.vertexStride/4+2)),pu=(pv=pP.getVertexElementByUsage(2).offset/4)+2;var pe=p$.getData();for(pY=0,pC=pe.length/pL;pY<pC;pY++){var pl=0;pl=0<this._vertexCount?(this._vertexStart+pY)*pL:pY*pL;var p_=pY*pU,pN=0;for(pN=0;pN<pu;pN++)pf[p_+pN]=pe[pl+pN];for(pN=pu;pN<pL;pN++)pf[p_+pN+2]=pe[pl+pN]}}else pU=pP.vertexStride/4,pf=this._vertexCount?p$.getData().slice(this._vertexStart*pU,(this._vertexStart+this._vertexCount)*pU):p$.getData().slice();if(ph){var pG=ph.worldMatrix,pm=pA._tempMatrix4x40;pG.invert(pm);var pE=pA._tempMatrix4x41,pR=pq.transform.worldMatrix;phq.multiply(pm,pR,pE)}else pE=pq.transform.worldMatrix;var pt=pA._tempQuaternion0;for(pE.decomposeTransRotScale(pA._tempVector30,pt,pA._tempVector31),pY=0,pC=pf.length/pU;pY<pC;pY++){var pX=pY*pU+pS,pn=pY*pU+pB;if(plq.transformVector3ArrayToVector3ArrayCoordinate(pf,pX,pE,pf,pX),plq.transformVector3ArrayByQuat(pf,pn,pt,pf,pn),pr){var pJ=pY*pU+pu;if(pg)plq.transformLightingMapTexcoordByUV1Array(pf,pJ,pr,pf,pJ);else{var pp=pY*pL+pv;plq.transformLightingMapTexcoordByUV0Array(pe,pp,pr,pf,pJ)}}}return pf},ph._getVertexBuffers=function(){return null},ph._beforeRender=function(ph){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},ph._render=function(ph){var pq,pf=0,pg=ph.renderElement;if(1<this._indexCount){var p$=this._boneIndicesList.length;if(1<p$){for(var pP=0;pP<p$;pP++)(pq=pg._skinAnimationDatas||this._skinAnimationDatas)&&(pg._shaderValue.setValue(0,pq[pP]),ph._shader.uploadRenderElementUniforms(pg._shaderValue.data)),pd.mainContext.drawElements(4,this._subIndexBufferCount[pP],5123,2*this._subIndexBufferStart[pP]);pX.drawCall+=p$}else(pq=pg._skinAnimationDatas||this._skinAnimationDatas)&&(pg._shaderValue.setValue(0,pq[0]),ph._shader.uploadRenderElementUniforms(pg._shaderValue.data)),pd.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),pX.drawCall++;pf=this._indexCount}else pf=this._indexBuffer.indexCount,(pq=pg._skinAnimationDatas||this._skinAnimationDatas)&&(pg._shaderValue.setValue(0,pq[0]),ph._shader.uploadRenderElementUniforms(pg._shaderValue.data)),pd.mainContext.drawElements(4,pf,5123,0),pX.drawCall++;pX.trianglesFaces+=pf/3},ph.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},ph.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},pL(0,ph,"_vertexBufferCount",function(){return 1}),pL(0,ph,"triangleCount",function(){return this._indexBuffer.indexCount/3}),pU(pA,["_tempVector30",function(){return this._tempVector30=new pSq},"_tempVector31",function(){return this._tempVector31=new pSq},"_tempQuaternion0",function(){return this._tempQuaternion0=new pfq},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new phq},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new phq}]),pA}(),pCq=function(){function ph(ph){this.defineCounter=0,this.defines=null,ph?(this.defineCounter=ph.defineCounter,this.defines=ph.defines.slice()):(this.defineCounter=0,this.defines=[])}return pv(ph,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),ph.prototype.registerDefine=function(ph){var pq=Math.pow(2,this.defineCounter++);return this.defines[pq]=ph,pq},ph}(),pUq=function(){function ph(){}return pv(ph,"laya.d3.shader.ShaderInit3D"),ph.__init__=function(){var ph,pq;pXq._globalRegDefine("HIGHPRECISION",pXq.SHADERDEFINE_HIGHPRECISION),pXq._globalRegDefine("FOG",pXq.SHADERDEFINE_FOG),pXq._globalRegDefine("DIRECTIONLIGHT",pXq.SHADERDEFINE_DIRECTIONLIGHT),pXq._globalRegDefine("POINTLIGHT",pXq.SHADERDEFINE_POINTLIGHT),pXq._globalRegDefine("SPOTLIGHT",pXq.SHADERDEFINE_SPOTLIGHT),pXq._globalRegDefine("UV",pXq.SHADERDEFINE_UV0),pXq._globalRegDefine("COLOR",pXq.SHADERDEFINE_COLOR),pXq._globalRegDefine("UV1",pXq.SHADERDEFINE_UV1),pXq._globalRegDefine("CASTSHADOW",pvq.SHADERDEFINE_CAST_SHADOW),pXq._globalRegDefine("SHADOWMAP_PSSM1",pvq.SHADERDEFINE_SHADOW_PSSM1),pXq._globalRegDefine("SHADOWMAP_PSSM2",pvq.SHADERDEFINE_SHADOW_PSSM2),pXq._globalRegDefine("SHADOWMAP_PSSM3",pvq.SHADERDEFINE_SHADOW_PSSM3),pXq._globalRegDefine("SHADOWMAP_PCF_NO",pvq.SHADERDEFINE_SHADOW_PCF_NO),pXq._globalRegDefine("SHADOWMAP_PCF1",pvq.SHADERDEFINE_SHADOW_PCF1),pXq._globalRegDefine("SHADOWMAP_PCF2",pvq.SHADERDEFINE_SHADOW_PCF2),pXq._globalRegDefine("SHADOWMAP_PCF3",pvq.SHADERDEFINE_SHADOW_PCF3),pXq._globalRegDefine("DEPTHFOG",pXq.SAHDERDEFINE_DEPTHFOG),pWq.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),pWq.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),ph={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},pq={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var pf=pWq.nameKey.add("SIMPLE");shaderCompile=pXq.add(pf,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',ph,pq),pTq.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),pTq.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),pTq.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),pTq.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),pTq.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),pTq.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),pTq.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),pTq.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),pTq.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},ph}(),puq=function(){function ph(){this._data=null,this._data=[]}pv(ph,"laya.d3.shader.ValusArray");var pq=ph.prototype;return pq.setValue=function(ph,pq){this._data[ph]=pq},pL(0,pq,"data",function(){return this._data}),ph}(),pvq=function(){function ph(){}return ph.SHADERDEFINE_RECEIVE_SHADOW=1,ph.SHADERDEFINE_CAST_SHADOW=512,ph.SHADERDEFINE_SHADOW_PSSM1=1024,ph.SHADERDEFINE_SHADOW_PSSM2=2048,ph.SHADERDEFINE_SHADOW_PSSM3=4096,ph.SHADERDEFINE_SHADOW_PCF_NO=8192,ph.SHADERDEFINE_SHADOW_PCF1=16384,ph.SHADERDEFINE_SHADOW_PCF2=32768,ph.SHADERDEFINE_SHADOW_PCF3=65536,ph.MAX_PSSM_COUNT=3,ph}(),pLq=function(){function pZ(){}return pv(pZ,"laya.d3.utils.Picker"),pZ.calculateCursorRay=function(ph,pq,pf,pg,p$,pP){var pS=ph.elements[0],pB=ph.elements[1],pr=pZ._tempVector30,pY=pr.elements;pY[0]=pS,pY[1]=pB,pY[2]=pq.minDepth;var pC=pZ._tempVector31,pU=pC.elements;pU[0]=pS,pU[1]=pB,pU[2]=pq.maxDepth;var pu=pP.origin,pv=pZ._tempVector32;pq.unprojectFromWVP(pr,pf,pg,p$,pu),pq.unprojectFromWVP(pC,pf,pg,p$,pv);var pL=pP.direction.elements;pL[0]=pv.x-pu.x,pL[1]=pv.y-pu.y,pL[2]=pv.z-pu.z,pSq.normalize(pP.direction,pP.direction)},pZ.rayIntersectsPositionsAndIndices=function(ph,pq,pf,pg,p$){for(var pP=pf.vertexStride/4,pS=pf.getVertexElementByUsage(0).offset/4,pB=Number.MAX_VALUE,pr=-1,pY=-1,pC=-1,pU=0;pU<pg.length;pU+=3){var pu=pZ._tempVector35,pv=pu.elements,pL=pg[pU]*pP,pe=pL+pS;pv[0]=pq[pe],pv[1]=pq[1+pe],pv[2]=pq[2+pe];var pl=pZ._tempVector36,p_=pl.elements,pN=pg[pU+1]*pP,pG=pN+pS;p_[0]=pq[pG],p_[1]=pq[1+pG],p_[2]=pq[2+pG];var pm=pZ._tempVector37,pE=pm.elements,pR=pg[pU+2]*pP,pt=pR+pS;pE[0]=pq[pt],pE[1]=pq[1+pt],pE[2]=pq[2+pt];var pX=laya.d3.utils.Picker.rayIntersectsTriangle(ph,pu,pl,pm);!isNaN(pX)&&pX<pB&&(pB=pX,pr=pL,pY=pN,pC=pR)}if(pB===Number.MAX_VALUE)return p$.position.toDefault(),p$.distance=Number.MAX_VALUE,p$.trianglePositions[0].toDefault(),p$.trianglePositions[1].toDefault(),p$.trianglePositions[2].toDefault(),p$.triangleNormals[0].toDefault(),p$.triangleNormals[1].toDefault(),p$.triangleNormals[2].toDefault(),!1;p$.distance=pB,pSq.scale(ph.direction,pB,p$.position),pSq.add(ph.origin,p$.position,p$.position);var pn=p$.trianglePositions,pJ=pn[0],pp=pn[1],pA=pn[2],pd=pJ.elements,pb=pp.elements,pi=pA.elements,pz=pr+pS;pd[0]=pq[pz],pd[1]=pq[pz+1],pd[2]=pq[pz+2];var pc=pY+pS;pb[0]=pq[pc],pb[1]=pq[pc+1],pb[2]=pq[pc+2];var pM=pC+pS;pi[0]=pq[pM],pi[1]=pq[pM+1],pi[2]=pq[pM+2];var pW=pf.getVertexElementByUsage(3);if(pW){var pT=pW.offset/4,pI=p$.triangleNormals,pw=pI[0],pk=pI[1],pH=pI[2],pD=pw.elements,ps=pk.elements,pV=pH.elements,pK=pr+pT;pD[0]=pq[pK],pD[1]=pq[pK+1],pD[2]=pq[pK+2];var py=pY+pT;ps[0]=pq[py],ps[1]=pq[py+1],ps[2]=pq[py+2];var pF=pC+pT;pV[0]=pq[pF],pV[1]=pq[pF+1],pV[2]=pq[pF+2]}return!0},pZ.rayIntersectsTriangle=function(ph,pq,pf,pg){var p$=pZ._tempVector30,pP=pZ._tempVector31;pSq.subtract(pf,pq,p$),pSq.subtract(pg,pq,pP);var pS,pB=pZ._tempVector32;if(pSq.cross(ph.direction,pP,pB),(pS=pSq.dot(p$,pB))>-Number.MIN_VALUE&&pS<Number.MIN_VALUE)return Number.NaN;var pr,pY=1/pS,pC=pZ._tempVector33;if(pSq.subtract(ph.origin,pq,pC),pr=pSq.dot(pC,pB),(pr*=pY)<0||1<pr)return Number.NaN;var pU,pu,pv=pZ._tempVector34;return pSq.cross(pC,p$,pv),pU=pSq.dot(ph.direction,pv),(pU*=pY)<0||1<pr+pU?Number.NaN:(pu=pSq.dot(pP,pv),(pu*=pY)<0?Number.NaN:pu)},pU(pZ,["_tempVector30",function(){return this._tempVector30=new pSq},"_tempVector31",function(){return this._tempVector31=new pSq},"_tempVector32",function(){return this._tempVector32=new pSq},"_tempVector33",function(){return this._tempVector33=new pSq},"_tempVector34",function(){return this._tempVector34=new pSq},"_tempVector35",function(){return this._tempVector35=new pSq},"_tempVector36",function(){return this._tempVector36=new pSq},"_tempVector37",function(){return this._tempVector37=new pSq}]),pZ}(),peq=(function(){function ph(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new pSq,new pSq,new pSq],this.trianglePositions.length=3,this.triangleNormals=[new pSq,new pSq,new pSq],this.triangleNormals.length=3,this.position=new pSq}pv(ph,"laya.d3.utils.RaycastHit"),ph.prototype.cloneTo=function(ph){ph.distance=this.distance,this.trianglePositions[0].cloneTo(ph.trianglePositions[0]),this.trianglePositions[1].cloneTo(ph.trianglePositions[1]),this.trianglePositions[2].cloneTo(ph.trianglePositions[2]),this.triangleNormals[0].cloneTo(ph.triangleNormals[0]),this.triangleNormals[1].cloneTo(ph.triangleNormals[1]),this.triangleNormals[2].cloneTo(ph.triangleNormals[2]),this.position.cloneTo(ph.position),ph.sprite3D=this.sprite3D}}(),function(){function ph(ph,pq){this._width=0,this._height=0,this._width=ph,this._height=pq}pv(ph,"laya.d3.utils.Size");var pq=ph.prototype;return pL(0,pq,"width",function(){return-1===this._width?pQ.clientWidth:this._width}),pL(0,pq,"height",function(){return-1===this._height?pQ.clientHeight:this._height}),pL(1,ph,"fullScreen",function(){return new ph(-1,-1)}),ph}()),plq=function(){function pz(){}return pv(pz,"laya.d3.utils.Utils3D"),pz._rotationTransformScaleSkinAnimation=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU){var pu,pv,pL,pe,pl,p_=pz._tempArray16_0,pN=pz._tempArray16_1,pG=pz._tempArray16_2,pm=pg+pg,pE=p$+p$,pR=pP+pP,pt=pg*pm,pX=p$*pm,pn=p$*pE,pJ=pP*pm,pp=pP*pE,pA=pP*pR,pd=pS*pm,pb=pS*pE,pi=pS*pR;for(p_[15]=1,p_[0]=1-pn-pA,p_[1]=pX+pi,p_[2]=pJ-pb,p_[4]=pX-pi,p_[5]=1-pt-pA,p_[6]=pp+pd,p_[8]=pJ+pb,p_[9]=pp-pd,p_[10]=1-pt-pn,pN[15]=1,pN[0]=pB,pN[5]=pr,pN[10]=pY,pu=0;pu<4;pu++)pv=p_[pu],pL=p_[pu+4],pe=p_[pu+8],pl=p_[pu+12],pG[pu]=pv,pG[pu+4]=pL,pG[pu+8]=pe,pG[pu+12]=pv*ph+pL*pq+pe*pf+pl;for(pu=0;pu<4;pu++)pv=pG[pu],pL=pG[pu+4],pe=pG[pu+8],pl=pG[pu+12],pC[pu+pU]=pv*pN[0]+pL*pN[1]+pe*pN[2]+pl*pN[3],pC[pu+pU+4]=pv*pN[4]+pL*pN[5]+pe*pN[6]+pl*pN[7],pC[pu+pU+8]=pv*pN[8]+pL*pN[9]+pe*pN[10]+pl*pN[11],pC[pu+pU+12]=pv*pN[12]+pL*pN[13]+pe*pN[14]+pl*pN[15]},pz._createNodeByJson=function(ph,pq,pf,pg){if(!pf)switch(pq.type){case"Sprite3D":pf=new pMq;break;case"MeshSprite3D":pf=new pZq;break;case"SkinnedMeshSprite3D":pf=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":pf=new ShuriKenParticle3D;break;case"TrailSprite3D":pf=new TrailSprite3D;break;case"Terrain":pf=new Terrain;break;case"Camera":pf=new pFq;break;case"DirectionLight":pf=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var p$=pq.props;if(p$)for(var pP in p$)pf[pP]=p$[pP];var pS=pq.customProps;pS&&(pf instanceof laya.d3.core.Sprite3D?(pf._parseBaseCustomProps(pS),pf._parseCustomProps(ph,pg,pS,pq),pf._parseCustomComponent(ph,pg,pq.components)):pf._parseCustomProps(ph,pg,pS,pq));var pB=pq.child;if(pB)for(var pr=0,pY=pB.length;pr<pY;pr++){var pC=pz._createNodeByJson(ph,pB[pr],null,pg);pf.addChild(pC)}return pf},pz._computeBoneAndAnimationDatasByBindPoseMatrxix=function(ph,pq,pf,pg,p$,pP){var pS,pB,pr=0,pY=0,pC=ph.length;for(pS=0;pS<pC;pr+=ph[pS].keyframeWidth,pY+=16,pS++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(pq[pr+0],pq[pr+1],pq[pr+2],pq[pr+3],pq[pr+4],pq[pr+5],pq[pr+6],pq[pr+7],pq[pr+8],pq[pr+9],pg,pY),0!=pS&&(pB=16*ph[pS].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(pg,pB,pg,pY,pg,pY));var pU=pf.length;for(pS=0;pS<pU;pS++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(pg,16*pP[pS],pf[pS],p$,16*pS)},pz._computeAnimationDatasByArrayAndMatrixFast=function(ph,pq,pf,pg){for(var p$=0,pP=ph.length;p$<pP;p$++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(pq,16*pg[p$],ph[p$],pf,16*p$)},pz._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(ph,pq,pf,pg,p$){var pP,pS,pB=0,pr=0,pY=ph.length;for(pP=0;pP<pY;pB+=ph[pP].keyframeWidth,pr+=16,pP++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(pq[pB+7],pq[pB+8],pq[pB+9],pq[pB+3],pq[pB+4],pq[pB+5],pq[pB+6],pq[pB+0],pq[pB+1],pq[pB+2],pg,pr),0!=pP&&(pS=16*ph[pP].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(pg,pS,pg,pr,pg,pr));var pC=pf.length;for(pP=0;pP<pC;pP++){var pU=16*pP;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(pg,pU,pf[pP],p$,pU)}},pz._computeAnimationDatasByArrayAndMatrixFastOld=function(ph,pq,pf){for(var pg=ph.length,p$=0;p$<pg;p$++){var pP=16*p$;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(pq,pP,ph[p$],pf,pP)}},pz._computeRootAnimationData=function(ph,pq,pf){for(var pg=0,p$=0,pP=0,pS=ph.length;pg<pS;p$+=ph[pg].keyframeWidth,pP+=16,pg++)laya.d3.utils.Utils3D.createAffineTransformationArray(pq[p$+0],pq[p$+1],pq[p$+2],pq[p$+3],pq[p$+4],pq[p$+5],pq[p$+6],pq[p$+7],pq[p$+8],pq[p$+9],pf,pP)},pz.transformVector3ArrayByQuat=function(ph,pq,pf,pg,p$){var pP=pf.elements,pS=ph[pq],pB=ph[pq+1],pr=ph[pq+2],pY=pP[0],pC=pP[1],pU=pP[2],pu=pP[3],pv=pu*pS+pC*pr-pU*pB,pL=pu*pB+pU*pS-pY*pr,pe=pu*pr+pY*pB-pC*pS,pl=-pY*pS-pC*pB-pU*pr;pg[p$]=pv*pu+pl*-pY+pL*-pU-pe*-pC,pg[p$+1]=pL*pu+pl*-pC+pe*-pY-pv*-pU,pg[p$+2]=pe*pu+pl*-pU+pv*-pC-pL*-pY},pz.mulMatrixByArray=function(ph,pq,pf,pg,p$,pP){var pS,pB,pr,pY,pC;if(p$===pf){for(pf=pz._tempArray16_3,pS=0;pS<16;++pS)pf[pS]=p$[pP+pS];pg=0}for(pS=0;pS<4;pS++)pB=ph[pq+pS],pr=ph[pq+pS+4],pY=ph[pq+pS+8],pC=ph[pq+pS+12],p$[pP+pS]=pB*pf[pg+0]+pr*pf[pg+1]+pY*pf[pg+2]+pC*pf[pg+3],p$[pP+pS+4]=pB*pf[pg+4]+pr*pf[pg+5]+pY*pf[pg+6]+pC*pf[pg+7],p$[pP+pS+8]=pB*pf[pg+8]+pr*pf[pg+9]+pY*pf[pg+10]+pC*pf[pg+11],p$[pP+pS+12]=pB*pf[pg+12]+pr*pf[pg+13]+pY*pf[pg+14]+pC*pf[pg+15]},pz.mulMatrixByArrayFast=function(ph,pq,pf,pg,p$,pP){var pS,pB,pr,pY,pC;for(pS=0;pS<4;pS++)pB=ph[pq+pS],pr=ph[pq+pS+4],pY=ph[pq+pS+8],pC=ph[pq+pS+12],p$[pP+pS]=pB*pf[pg+0]+pr*pf[pg+1]+pY*pf[pg+2]+pC*pf[pg+3],p$[pP+pS+4]=pB*pf[pg+4]+pr*pf[pg+5]+pY*pf[pg+6]+pC*pf[pg+7],p$[pP+pS+8]=pB*pf[pg+8]+pr*pf[pg+9]+pY*pf[pg+10]+pC*pf[pg+11],p$[pP+pS+12]=pB*pf[pg+12]+pr*pf[pg+13]+pY*pf[pg+14]+pC*pf[pg+15]},pz.mulMatrixByArrayAndMatrixFast=function(ph,pq,pf,pg,p$){var pP,pS,pB,pr,pY,pC=pf.elements,pU=pC[0],pu=pC[1],pv=pC[2],pL=pC[3],pe=pC[4],pl=pC[5],p_=pC[6],pN=pC[7],pG=pC[8],pm=pC[9],pE=pC[10],pR=pC[11],pt=pC[12],pX=pC[13],pn=pC[14],pJ=pC[15],pp=pq,pA=pq+4,pd=pq+8,pb=pq+12,pi=p$,pz=p$+4,pc=p$+8,pM=p$+12;for(pP=0;pP<4;pP++)pS=ph[pp+pP],pB=ph[pA+pP],pr=ph[pd+pP],pY=ph[pb+pP],pg[pi+pP]=pS*pU+pB*pu+pr*pv+pY*pL,pg[pz+pP]=pS*pe+pB*pl+pr*p_+pY*pN,pg[pc+pP]=pS*pG+pB*pm+pr*pE+pY*pR,pg[pM+pP]=pS*pt+pB*pX+pr*pn+pY*pJ},pz.createAffineTransformationArray=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU){var pu=pg+pg,pv=p$+p$,pL=pP+pP,pe=pg*pu,pl=pg*pv,p_=pg*pL,pN=p$*pv,pG=p$*pL,pm=pP*pL,pE=pS*pu,pR=pS*pv,pt=pS*pL;pC[pU+0]=(1-(pN+pm))*pB,pC[pU+1]=(pl+pt)*pB,pC[pU+2]=(p_-pR)*pB,pC[pU+3]=0,pC[pU+4]=(pl-pt)*pr,pC[pU+5]=(1-(pe+pm))*pr,pC[pU+6]=(pG+pE)*pr,pC[pU+7]=0,pC[pU+8]=(p_+pR)*pY,pC[pU+9]=(pG-pE)*pY,pC[pU+10]=(1-(pe+pN))*pY,pC[pU+11]=0,pC[pU+12]=ph,pC[pU+13]=pq,pC[pU+14]=pf,pC[pU+15]=1},pz.transformVector3ArrayToVector3ArrayCoordinate=function(ph,pq,pf,pg,p$){var pP=pz._tempArray4_0,pS=ph[pq+0],pB=ph[pq+1],pr=ph[pq+2],pY=pf.elements;pP[0]=pS*pY[0]+pB*pY[4]+pr*pY[8]+pY[12],pP[1]=pS*pY[1]+pB*pY[5]+pr*pY[9]+pY[13],pP[2]=pS*pY[2]+pB*pY[6]+pr*pY[10]+pY[14],pP[3]=1/(pS*pY[3]+pB*pY[7]+pr*pY[11]+pY[15]),pg[p$+0]=pP[0]*pP[3],pg[p$+1]=pP[1]*pP[3],pg[p$+2]=pP[2]*pP[3]},pz.transformLightingMapTexcoordByUV0Array=function(ph,pq,pf,pg,p$){var pP=pf.elements;pg[p$+0]=ph[pq+0]*pP[0]+pP[2],pg[p$+1]=(ph[pq+1]-1)*pP[1]+pP[3]},pz.transformLightingMapTexcoordByUV1Array=function(ph,pq,pf,pg,p$){var pP=pf.elements;pg[p$+0]=ph[pq+0]*pP[0]+pP[2],pg[p$+1]=1+ph[pq+1]*pP[1]+pP[3]},pz.getURLVerion=function(ph){var pq=ph.indexOf("?");return 0<=pq?ph.substr(pq):null},pz._quaternionCreateFromYawPitchRollArray=function(ph,pq,pf,pg){var p$=.5*pf,pP=.5*pq,pS=.5*ph,pB=Math.sin(p$),pr=Math.cos(p$),pY=Math.sin(pP),pC=Math.cos(pP),pU=Math.sin(pS),pu=Math.cos(pS);pg[0]=pu*pY*pr+pU*pC*pB,pg[1]=pU*pC*pr-pu*pY*pB,pg[2]=pu*pC*pB-pU*pY*pr,pg[3]=pu*pC*pr+pU*pY*pB},pz._createAffineTransformationArray=function(ph,pq,pf,pg){var p$=pq[0],pP=pq[1],pS=pq[2],pB=pq[3],pr=p$+p$,pY=pP+pP,pC=pS+pS,pU=p$*pr,pu=p$*pY,pv=p$*pC,pL=pP*pY,pe=pP*pC,pl=pS*pC,p_=pB*pr,pN=pB*pY,pG=pB*pC,pm=pf[0],pE=pf[1],pR=pf[2];pg[0]=(1-(pL+pl))*pm,pg[1]=(pu+pG)*pm,pg[2]=(pv-pN)*pm,pg[3]=0,pg[4]=(pu-pG)*pE,pg[5]=(1-(pU+pl))*pE,pg[6]=(pe+p_)*pE,pg[7]=0,pg[8]=(pv+pN)*pR,pg[9]=(pe-p_)*pR,pg[10]=(1-(pU+pL))*pR,pg[11]=0,pg[12]=ph[0],pg[13]=ph[1],pg[14]=ph[2],pg[15]=1},pz._mulMatrixArray=function(ph,pq,pf,pg){var p$,pP,pS,pB,pr,pY=pq.elements,pC=pY[0],pU=pY[1],pu=pY[2],pv=pY[3],pL=pY[4],pe=pY[5],pl=pY[6],p_=pY[7],pN=pY[8],pG=pY[9],pm=pY[10],pE=pY[11],pR=pY[12],pt=pY[13],pX=pY[14],pn=pY[15],pJ=pg,pp=pg+4,pA=pg+8,pd=pg+12;for(p$=0;p$<4;p$++)pP=ph[p$],pS=ph[p$+4],pB=ph[p$+8],pr=ph[p$+12],pf[pJ+p$]=pP*pC+pS*pU+pB*pu+pr*pv,pf[pp+p$]=pP*pL+pS*pe+pB*pl+pr*p_,pf[pA+p$]=pP*pN+pS*pG+pB*pm+pr*pE,pf[pd+p$]=pP*pR+pS*pt+pB*pX+pr*pn},pz.getYawPitchRoll=function(ph,pq){pz.transformQuat(pSq.ForwardRH,ph,pfq.TEMPVector31),pz.transformQuat(pSq.Up,ph,pfq.TEMPVector32);var pf=pfq.TEMPVector32.elements;pz.angleTo(pSq.ZERO,pfq.TEMPVector31,pfq.TEMPVector33);var pg=pfq.TEMPVector33.elements;pg[0]==Math.PI/2?(pg[1]=pz.arcTanAngle(pf[2],pf[0]),pg[2]=0):pg[0]==-Math.PI/2?(pg[1]=pz.arcTanAngle(-pf[2],-pf[0]),pg[2]=0):(phq.createRotationY(-pg[1],pfq.TEMPMatrix0),phq.createRotationX(-pg[0],pfq.TEMPMatrix1),pSq.transformCoordinate(pfq.TEMPVector32,pfq.TEMPMatrix0,pfq.TEMPVector32),pSq.transformCoordinate(pfq.TEMPVector32,pfq.TEMPMatrix1,pfq.TEMPVector32),pg[2]=pz.arcTanAngle(pf[1],-pf[0])),pg[1]<=-Math.PI&&(pg[1]=Math.PI),pg[2]<=-Math.PI&&(pg[2]=Math.PI),pg[1]>=Math.PI&&pg[2]>=Math.PI&&(pg[1]=0,pg[2]=0,pg[0]=Math.PI-pg[0]),pq[0]=pg[1],pq[1]=pg[0],pq[2]=pg[2]},pz.arcTanAngle=function(ph,pq){return 0==ph?1==pq?Math.PI/2:-Math.PI/2:0<ph?Math.atan(pq/ph):ph<0?0<pq?Math.atan(pq/ph)+Math.PI:Math.atan(pq/ph)-Math.PI:0},pz.angleTo=function(ph,pq,pf){pSq.subtract(pq,ph,pfq.TEMPVector30),pSq.normalize(pfq.TEMPVector30,pfq.TEMPVector30),pf.elements[0]=Math.asin(pfq.TEMPVector30.y),pf.elements[1]=pz.arcTanAngle(-pfq.TEMPVector30.z,-pfq.TEMPVector30.x)},pz.transformQuat=function(ph,pq,pf){var pg=pf.elements,p$=ph.elements,pP=pq,pS=p$[0],pB=p$[1],pr=p$[2],pY=pP[0],pC=pP[1],pU=pP[2],pu=pP[3],pv=pu*pS+pC*pr-pU*pB,pL=pu*pB+pU*pS-pY*pr,pe=pu*pr+pY*pB-pC*pS,pl=-pY*pS-pC*pB-pU*pr;pg[0]=pv*pu+pl*-pY+pL*-pU-pe*-pC,pg[1]=pL*pu+pl*-pC+pe*-pY-pv*-pU,pg[2]=pe*pu+pl*-pU+pv*-pC-pL*-pY},pz.quaterionNormalize=function(ph,pq){var pf=ph[0],pg=ph[1],p$=ph[2],pP=ph[3],pS=pf*pf+pg*pg+p$*p$+pP*pP;0<pS&&(pS=1/Math.sqrt(pS),pq[0]=pf*pS,pq[1]=pg*pS,pq[2]=p$*pS,pq[3]=pP*pS)},pz.matrix4x4MultiplyFFF=function(ph,pq,pf){var pg,p$,pP,pS,pB;if(pf===pq)for(pq=new Float32Array(16),pg=0;pg<16;++pg)pq[pg]=pf[pg];for(pg=0;pg<4;pg++)p$=ph[pg],pP=ph[pg+4],pS=ph[pg+8],pB=ph[pg+12],pf[pg]=p$*pq[0]+pP*pq[1]+pS*pq[2]+pB*pq[3],pf[pg+4]=p$*pq[4]+pP*pq[5]+pS*pq[6]+pB*pq[7],pf[pg+8]=p$*pq[8]+pP*pq[9]+pS*pq[10]+pB*pq[11],pf[pg+12]=p$*pq[12]+pP*pq[13]+pS*pq[14]+pB*pq[15]},pz.matrix4x4MultiplyMFM=function(ph,pq,pf){pz.matrix4x4MultiplyFFF(ph.elements,pq,pf.elements)},pU(pz,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new pSq},"_tempVector3_1",function(){return this._tempVector3_1=new pSq},"_tempVector3_2",function(){return this._tempVector3_2=new pSq},"_tempVector3_3",function(){return this._tempVector3_3=new pSq},"_tempVector3_4",function(){return this._tempVector3_4=new pSq},"_tempVector3_5",function(){return this._tempVector3_5=new pSq},"_tempVector3_6",function(){return this._tempVector3_6=new pSq},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),pz}(),p_q=function(){function pb(){}return pv(pb,"Laya3D"),pb._cancelLoadByUrl=function(ph){pE.loader.cancelLoadByUrl(ph),pb._innerFirstLevelLoaderManager.cancelLoadByUrl(ph),pb._innerSecondLevelLoaderManager.cancelLoadByUrl(ph),pb._innerThirdLevelLoaderManager.cancelLoadByUrl(ph),pb._innerFourthLevelLoaderManager.cancelLoadByUrl(ph)},pb._changeWebGLSize=function(ph,pq){pd.onStageResize(ph,pq),pQ.clientWidth=ph,pQ.clientHeight=pq},pb.__init__=function(){var ph=pq.createMap;ph.lh=[pMq,"SPRITE3DHIERARCHY"],ph.ls=[pcq,"SPRITE3DHIERARCHY"],ph.lm=[pDq,"MESH"],ph.lmat=[pTq,"MATERIAL"],ph.jpg=[pVq,"nativeimage"],ph.jpeg=[pVq,"nativeimage"],ph.png=[pVq,"nativeimage"],ph.pkm=[pVq,"arraybuffer"],ph.raw=[pkq,"arraybuffer"],ph.mipmaps=[pkq,"arraybuffer"],p_.parserMap.SPRITE3DHIERARCHY=pb._loadHierarchy,p_.parserMap.MESH=pb._loadMesh,p_.parserMap.MATERIAL=pb._loadMaterial,p_.parserMap.TEXTURECUBE=pb._loadTextureCube,p_.parserMap.TERRAIN=pb._loadTerrain,pb._innerFirstLevelLoaderManager.on("error",null,pb._eventLoadManagerError),pb._innerSecondLevelLoaderManager.on("error",null,pb._eventLoadManagerError),pb._innerThirdLevelLoaderManager.on("error",null,pb._eventLoadManagerError),pb._innerFourthLevelLoaderManager.on("error",null,pb._eventLoadManagerError)},pb.READ_BLOCK=function(){return pb._readData.pos+=4,!0},pb.READ_DATA=function(){return pb._DATA.offset=pb._readData.getUint32(),pb._DATA.size=pb._readData.getUint32(),!0},pb.READ_STRINGS=function(){var ph=[],pq={offset:0,size:0};pq.offset=pb._readData.getUint16(),pq.size=pb._readData.getUint16();pb._readData.pos;pb._readData.pos=pq.offset+pb._DATA.offset;for(var pf=0;pf<pq.size;pf++){var pg=pb._readData.readUTFString();-1===pg.lastIndexOf(".lmat")&&-1===pg.lastIndexOf(".lpbr")||ph.push(pg)}return ph},pb.formatRelativePath=function(ph,pq){var pf;if("."===pq.charAt(0)){for(var pg=(ph+pq).split("/"),p$=0,pP=pg.length;p$<pP;p$++)if(".."==pg[p$]){var pS=p$-1;0<pS&&".."!==pg[pS]&&(pg.splice(pS,2),p$-=2)}pf=pg.join("/")}else pf=ph+pq;return null!=pA.customFormat&&(pf=pA.customFormat(pf,null)),pf},pb._eventLoadManagerError=function(ph){pE.loader.event("error",ph)},pb._addHierarchyInnerUrls=function(ph,pq,pf,pg,p$,pP){var pS=pb.formatRelativePath(pg,p$);pf&&(pS+=pf),ph.push({url:pS,clas:pP}),pq[p$]=pS},pb._getSprite3DHierarchyInnerUrls=function(ph,pq,pf,pg,p$,pP,pS){var pB,pr=0,pY=0;switch(ph.type){case"Scene":var pC=ph.customProps.lightmaps;for(pr=0,pY=pC.length;pr<pY;pr++){var pU=pC[pr].replace(".exr",".png");pb._addHierarchyInnerUrls(pg,p$,pP,pS,pU,pVq)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var pu;if(ph.instanceParams)(pu=ph.instanceParams.loadPath)&&pb._addHierarchyInnerUrls(pq,p$,pP,pS,pu,pDq);else{(pu=(pB=ph.customProps).meshPath)&&pb._addHierarchyInnerUrls(pq,p$,pP,pS,pu,pDq);var pv=pB.materials;if(pv)for(pr=0,pY=pv.length;pr<pY;pr++){for(var pL=pv[pr],pe=pL.type.split("."),pl=pi.window,p_=0,pN=pe.length;p_<pN;++p_){pl=pl[this.clasPaths[p_]]}if("function"!=typeof pl)throw"_getSprite3DHierarchyInnerUrls 错误: "+pL.type+" 不是类";pb._addHierarchyInnerUrls(pf,p$,pP,pS,pL.path,pl)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var pG=(pB=ph.customProps).meshPath;pG&&pb._addHierarchyInnerUrls(pq,p$,pP,pS,pG,pDq);var pm=pB.material;if(pm){pe=pm.type.split("."),pl=pi.window;for(p_=0,pN=pe.length;p_<pN;++p_){pl=pl[this.clasPaths[p_]]}pb._addHierarchyInnerUrls(pf,p$,pP,pS,pm.path,pl)}else{var pE=pB.materialPath;if(pE)pb._addHierarchyInnerUrls(pf,p$,pP,pS,pE,ShurikenParticleMaterial);else{var pR=pB.texturePath;pR&&pb._addHierarchyInnerUrls(pg,p$,pP,pS,pR,pVq)}}break;case"Terrain":pb._addHierarchyInnerUrls(pg,p$,pP,pS,ph.customProps.dataPath,TerrainRes)}var pt=ph.components;for(var pX in pt){var pn=pt[pX];switch(pX){case"Animator":var pJ=pn.avatarPath;if(pJ)pb._addHierarchyInnerUrls(pg,p$,pP,pS,pJ,Avatar);else{var pp=pn.avatar;pp&&pb._addHierarchyInnerUrls(pg,p$,pP,pS,pp.path,Avatar)}var pA=pn.clipPaths;for(pr=0,pY=pA.length;pr<pY;pr++)pb._addHierarchyInnerUrls(pg,p$,pP,pS,pA[pr],AnimationClip)}}var pd=ph.child;for(pr=0,pY=pd.length;pr<pY;pr++)pb._getSprite3DHierarchyInnerUrls(pd[pr],pq,pf,pg,p$,pP,pS)},pb._loadHierarchy=function(ph){ph.on("loaded",null,pb._onHierarchylhLoaded,[ph,ph._class._getGroup()]),ph.load(ph.url,"json",!1,null,!0)},pb._onHierarchylhLoaded=function(ph,pq,pf){if(ph._class.destroyed)ph.endLoad();else{var pg=ph.url,p$=plq.getURLVerion(pg),pP=pA.getPath(pg),pS=[],pB=[],pr=[],pY={};pb._getSprite3DHierarchyInnerUrls(pf,pS,pB,pr,pY,p$,pP);var pC=pS.length+pB.length+pr.length,pU=pC+1,pu=1/pU;if(pb._onProcessChange(ph,0,pu,1),0<pr.length){var pv=pC/pU,pL=pp.create(null,pb._onProcessChange,[ph,pu,pv],!1);pb._innerFourthLevelLoaderManager.create(pr,pp.create(null,pb._onHierarchyInnerForthLevResouLoaded,[ph,pq,pL,pf,pY,pS,pB,pu+pv*pr.length,pv]),pL,null,null,1,!0,pq)}else pb._onHierarchyInnerForthLevResouLoaded(ph,pq,null,pf,pY,pS,pB,pu,pv)}},pb._onHierarchyInnerForthLevResouLoaded=function(ph,pq,pf,pg,p$,pP,pS,pB,pr){if(ph._class.destroyed)ph.endLoad();else if(pf&&pf.recover(),0<pS.length){var pY=pp.create(null,pb._onProcessChange,[ph,pB,pr],!1);pb._innerSecondLevelLoaderManager.create(pS,pp.create(null,pb._onHierarchyInnerSecondLevResouLoaded,[ph,pq,pY,pg,p$,pP,pB+pr*pS.length,pr]),pf,null,null,1,!0,pq)}else pb._onHierarchyInnerSecondLevResouLoaded(ph,pq,null,pg,p$,pP,pB,pr)},pb._onHierarchyInnerSecondLevResouLoaded=function(ph,pq,pf,pg,p$,pP,pS,pB){if(ph._class.destroyed)ph.endLoad();else if(pf&&pf.recover(),0<pP.length){var pr=pp.create(null,pb._onProcessChange,[ph,pS,pB],!1);pb._innerFirstLevelLoaderManager.create(pP,pp.create(null,pb._onHierarchyInnerFirstLevResouLoaded,[ph,pr,pg,p$]),pf,null,null,1,!0,pq)}else pb._onHierarchyInnerFirstLevResouLoaded(ph,null,pg,p$)},pb._onHierarchyInnerFirstLevResouLoaded=function(ph,pq,pf,pg){pq&&pq.recover(),ph.endLoad([pf,pg])},pb._loadTerrain=function(ph){ph.on("loaded",null,pb._onTerrainLtLoaded,[ph,ph._class._getGroup()]),ph.load(ph.url,"json",!1,null,!0)},pb._onTerrainLtLoaded=function(ph,pq,pf){if(ph._class.destroyed)ph.endLoad();else{var pg,p$,pP=ph.url,pS=plq.getURLVerion(pP),pB=pA.getPath(pP),pr=[],pY={},pC=0,pU=0,pu=pf.heightData;pg=pu.url,p$=pb.formatRelativePath(pB,pg),pS&&(p$+=pS),pg=pY[pg]=p$;var pv=pf.detailTexture;for(pC=0,pU=pv.length;pC<pU;pC++)pr.push({url:pv[pC].diffuse});var pL=pf.normalMap;for(pC=0,pU=pL.length;pC<pU;pC++)pr.push({url:pL[pC]});var pe=pf.alphaMap;for(pC=0,pU=pe.length;pC<pU;pC++)pr.push({url:pe[pC],params:[!1,!1,6408,!0]});for(pC=0,pU=pr.length;pC<pU;pC++){var pl=pr[pC].url;p$=pb.formatRelativePath(pB,pl),pS&&(p$+=pS),pr[pC].url=p$,pY[pl]=p$}var p_=pr.length,pN=p_+2,pG=1/pN;pb._onProcessChange(ph,0,pG,1);var pm={heightMapLoaded:!1,texturesLoaded:!1},pE=pp.create(null,pb._onProcessChange,[ph,pG,pG],!1);pb._innerFourthLevelLoaderManager.create(pg,pp.create(null,pb._onTerrainHeightMapLoaded,[ph,pE,pf,pY,pm]),pE,null,[pu.numX,pu.numZ,pu.bitType,pu.value],1,!0,pq);var pR=pp.create(null,pb._onProcessChange,[ph,2*pG,p_/pN],!1);pb._innerFourthLevelLoaderManager.create(pr,pp.create(null,pb._onTerrainTexturesLoaded,[ph,pR,pf,pY,pm]),pR,null,null,1,!0,pq)}},pb._onTerrainHeightMapLoaded=function(ph,pq,pf,pg,p$){p$.heightMapLoaded=!0,p$.texturesLoaded&&(ph.endLoad([pf,pg]),pq.recover())},pb._onTerrainTexturesLoaded=function(ph,pq,pf,pg,p$){p$.texturesLoaded=!0,p$.heightMapLoaded&&(ph.endLoad([pf,pg]),pq.recover())},pb._loadMesh=function(ph){ph.on("loaded",null,pb._onMeshLmLoaded,[ph,ph._class._getGroup()]),ph.load(ph.url,"arraybuffer",!1,null,!0)},pb._onMeshLmLoaded=function(ph,pq,pf){if(ph._class.destroyed)ph.endLoad();else{var pg,p$,pP,pS=ph.url,pB=plq.getURLVerion(pS),pr=pA.getPath(pS),pY={},pC=0,pU=0;switch((pb._readData=new pR(pf)).pos=0,pb._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var pu=pb._readData.getUint32();pb._readData.pos=pb._readData.pos+4,pU=pb._readData.getUint16(),pb._readData.pos=pb._readData.pos+8*pU;var pv=pb._readData.getUint32();for(pU=pb._readData.getUint16(),pb._readData.pos=pu+pv,pg=[],pC=0;pC<pU;pC++){var pL=pb._readData.readUTFString();-1!==pL.lastIndexOf(".lmat")&&pg.push(pL)}break;default:for(pb.READ_BLOCK(),pC=0;pC<2;pC++){var pe=pb._readData.getUint16(),pl=pb._strings[pe],p_=pb["READ_"+pl];if(null==p_)throw new Error("model file err,no this function:"+pe+" "+pl);1===pC?pg=p_.call():p_.call()}}for(pC=0,pP=pg.length;pC<pP;pC++){var pN=pg[pC];p$=pb.formatRelativePath(pr,pN),pB&&(p$+=pB),pg[pC]=p$,pY[pN]=p$}if(0<pg.length){pb._onProcessChange(ph,0,.5,1);var pG=pp.create(null,pb._onProcessChange,[ph,.5,.5],!1);pb._innerSecondLevelLoaderManager.create(pg,pp.create(null,pb._onMeshMateialLoaded,[ph,pG,pf,pY]),pG,null,null,1,!0,pq)}else ph.endLoad([pf,pY])}},pb._onMeshMateialLoaded=function(ph,pq,pf,pg){ph.endLoad([pf,pg]),pq.recover()},pb._getMaterialTexturePath=function(ph,pq,pf){var pg=ph.length-4;return ph.indexOf(".dds")!=pg&&ph.indexOf(".tga")!=pg&&ph.indexOf(".exr")!=pg&&ph.indexOf(".DDS")!=pg&&ph.indexOf(".TGA")!=pg&&ph.indexOf(".EXR")!=pg||(ph=ph.substr(0,pg)+".png"),ph=pb.formatRelativePath(pf,ph),pq&&(ph+=pq),ph},pb._loadMaterial=function(ph){ph.on("loaded",null,pb._onMaterilLmatLoaded,[ph,ph._class._getGroup()]),ph.load(ph.url,"json",!1,null,!0)},pb._onMaterilLmatLoaded=function(ph,pq,pf){if(ph._class.destroyed)ph.endLoad();else{var pg,p$=ph.url,pP=plq.getURLVerion(p$),pS=pA.getPath(p$),pB=[],pr={},pY=pf.customProps,pC=pf.version;if(pC)switch(pC){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var pU=pf.props.textures,pu=0,pv=pU.length;pu<pv;pu++){var pL=pU[pu],pe=pL.path;if(pe){var pl=pe.length-4;pe.indexOf(".exr")!=pl&&pe.indexOf(".EXR")!=pl||(pe=pe.substr(0,pl)+".png"),pg=pb.formatRelativePath(pS,pe),pP&&(pg+=pP),pB.push({url:pg,params:pL.params}),pr[pe]=pg}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var p_=pY.diffuseTexture.texture2D;if(p_&&(pg=pb._getMaterialTexturePath(p_,pP,pS),pB.push(pg),pr[p_]=pg),pY.normalTexture){var pN=pY.normalTexture.texture2D;pN&&(pg=pb._getMaterialTexturePath(pN,pP,pS),pB.push(pg),pr[pN]=pg)}if(pY.specularTexture){var pG=pY.specularTexture.texture2D;pG&&(pg=pb._getMaterialTexturePath(pG,pP,pS),pB.push(pg),pr[pG]=pg)}if(pY.emissiveTexture){var pm=pY.emissiveTexture.texture2D;pm&&(pg=pb._getMaterialTexturePath(pm,pP,pS),pB.push(pg),pr[pm]=pg)}if(pY.ambientTexture){var pE=pY.ambientTexture.texture2D;pE&&(pg=pb._getMaterialTexturePath(pE,pP,pS),pB.push(pg),pr[pE]=pg)}if(pY.reflectTexture){var pR=pY.reflectTexture.texture2D;pR&&(pg=pb._getMaterialTexturePath(pR,pP,pS),pB.push(pg),pr[pR]=pg)}}var pt=pB.length,pX=pt+1,pn=1/pX;if(pb._onProcessChange(ph,0,pn,1),0<pt){var pJ=pp.create(null,pb._onProcessChange,[ph,pn,pt/pX],!1);pb._innerFourthLevelLoaderManager.create(pB,pp.create(null,pb._onMateialTexturesLoaded,[ph,pJ,pf,pr]),pJ,pVq,null,1,!0,pq)}else pb._onMateialTexturesLoaded(ph,null,pf,null)}},pb._onMateialTexturesLoaded=function(ph,pq,pf,pg){ph.endLoad([pf,pg]),pq&&pq.recover()},pb._loadTextureCube=function(ph){ph.on("loaded",null,pb._onTextureCubeLtcLoaded,[ph]),ph.load(ph.url,"json",!1,null,!0)},pb._onTextureCubeLtcLoaded=function(ph,pq){if(ph._class.destroyed)ph.endLoad();else{var pf=pA.getPath(ph.url),pg=[pb.formatRelativePath(pf,pq.px),pb.formatRelativePath(pf,pq.nx),pb.formatRelativePath(pf,pq.py),pb.formatRelativePath(pf,pq.ny),pb.formatRelativePath(pf,pq.pz),pb.formatRelativePath(pf,pq.nz)];pb._onProcessChange(ph,0,1/7,1);var p$=pp.create(null,pb._onProcessChange,[ph,1/7,6/7],!1);pb._innerFourthLevelLoaderManager.load(pg,pp.create(null,pb._onTextureCubeImagesLoaded,[ph,pg,p$]),p$,"nativeimage")}},pb._onTextureCubeImagesLoaded=function(ph,pq,pf){var pg=[];pg.length=6;for(var p$=0;p$<6;p$++){var pP=pq[p$];pg[p$]=p_.getRes(pP),p_.clearRes(pP)}ph.endLoad(pg),pf.recover()},pb._onProcessChange=function(ph,pq,pf,pg){(pg=pq+pg*pf)<1&&ph.event("progress",pg)},pb.init=function(ph,pq,pf,pg,p$,pP){if(void 0===pf&&(pf=!1),void 0===pg&&(pg=!1),void 0===p$&&(p$=!0),void 0===pP&&(pP=!0),pN.update3DLoop=function(){},pN.cancelLoadByUrl=function(ph){pb._cancelLoadByUrl(ph)},pr.isAntialias=pf,pr.isAlpha=pg,pr.premultipliedAlpha=p$,pr.isStencil=pP,!pd.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");pN.changeWebGLSize=pb._changeWebGLSize,pe.is3DMode=!0,pE.init(ph,pq),pz.__init__(),pUq.__init__(),pZq.__init__(),pH.__init__(),pb.__init__(),pS.maxTextureCount=2,(pb.debugMode||po.debugMode)&&(pb._debugPhasorSprite=new py)},pb.HIERARCHY="SPRITE3DHIERARCHY",pb.MESH="MESH",pb.MATERIAL="MATERIAL",pb.PBRMATERIAL="PBRMTL",pb.TEXTURECUBE="TEXTURECUBE",pb.TERRAIN="TERRAIN",pb._readData=null,pb._debugPhasorSprite=null,pb.debugMode=!1,pU(pb,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new pq},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new pq},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new pq},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new pq}]),pb}(),pNq=function(ph){function p$(ph){p$.__super.call(this),this._owner=ph,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}pv(p$,"laya.d3.animation.AnimationTransform3D",pP);var pq=p$.prototype;return pq._getlocalMatrix=function(){return this._localUpdate&&(plq._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},pq._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._onWorldTransform()}},pq._setWorldMatrixAndUpdate=function(ph){if(this._worldMatrix=ph,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var pq=this._getlocalMatrix(),pf=0;pf<16;++pf)this._worldMatrix[pf]=pq[pf];else plq.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},pq._setWorldMatrixNoUpdate=function(ph){this._worldMatrix=ph},pq._setWorldMatrixIgnoreUpdate=function(ph){this._worldMatrix=ph,this._worldUpdate=!1},pq.getLocalPosition=function(){return this._localPosition},pq.setLocalPosition=function(ph){if(this._parent)this._localPosition=ph,this._localUpdate=!0,this._onWorldTransform();else{var pq=this._entity.owner._transform,pf=this._entity.localPosition,pg=pf.elements;pg[0]=ph[0],pg[1]=ph[1],pg[2]=ph[2],pq.localPosition=pf}},pq.getLocalRotation=function(){if(this._localQuaternionUpdate){var ph=this._localRotationEuler;plq._quaternionCreateFromYawPitchRollArray(ph[1]/p$._angleToRandin,ph[0]/p$._angleToRandin,ph[2]/p$._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},pq.setLocalRotation=function(ph){if(this._parent)this._localRotation=ph,plq.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var pq=this._entity.owner._transform,pf=this._entity.localRotation,pg=pf.elements;pg[0]=ph[0],pg[1]=ph[1],pg[2]=ph[2],pg[3]=ph[3],pq.localRotation=pf}},pq.getLocalScale=function(){return this._localScale},pq.setLocalScale=function(ph){if(this._parent)this._localScale=ph,this._localUpdate=!0,this._onWorldTransform();else{var pq=this._entity.owner._transform,pf=this._entity.localScale,pg=pf.elements;pg[0]=ph[0],pg[1]=ph[1],pg[2]=ph[2],pq.localScale=pf}},pq.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){plq.getYawPitchRoll(this._localRotation,p$._tempVector3);var ph=p$._tempVector3,pq=this._localRotationEuler;pq[0]=ph[1]*p$._angleToRandin,pq[1]=ph[0]*p$._angleToRandin,pq[2]=ph[2]*p$._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},pq.setLocalRotationEuler=function(ph){if(this._parent)plq._quaternionCreateFromYawPitchRollArray(ph[1]/p$._angleToRandin,ph[0]/p$._angleToRandin,ph[2]/p$._angleToRandin,this._localRotation),this._localRotationEuler=ph,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var pq=this._entity.owner._transform,pf=this._entity.localRotationEuler,pg=pf.elements;pg[0]=ph[0],pg[1]=ph[1],pg[2]=ph[2],pq.localRotationEuler=pf}},pq.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)plq.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var ph=this._getlocalMatrix(),pq=0;pq<16;++pq)this._worldMatrix[pq]=ph[pq];this._worldUpdate=!1}return this._worldMatrix},pq.setParent=function(ph){if(this._parent!==ph){if(this._parent){var pq=this._parent._childs,pf=pq.indexOf(this);pq.splice(pf,1)}ph&&(ph._childs.push(this),ph&&this._onWorldTransform()),this._parent=ph}},pU(p$,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),p$}(),pGq=function(ph){function pq(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,pq.__super.call(this),this._destroyed=!1,this._id=pq._uniqueIDCounter,pq._uniqueIDCounter++}pv(pq,"laya.d3.component.Component3D",pP);var pf=pq.prototype;return pE.imps(pf,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),pf._initialize=function(ph){this._owner=ph,this._enable=!0,this.started=!1,this._load(ph)},pf._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},pf._load=function(ph){},pf._start=function(ph){},pf._update=function(ph){},pf._lateUpdate=function(ph){},pf._preRenderUpdate=function(ph){},pf._postRenderUpdate=function(ph){},pf._unload=function(ph){this.offAll()},pf._cloneTo=function(ph){},pL(0,pf,"id",function(){return this._id}),pL(0,pf,"destroyed",function(){return this._destroyed}),pL(0,pf,"owner",function(){return this._owner}),pL(0,pf,"enable",function(){return this._enable},function(ph){this._enable!==ph&&(this._enable=ph,this.event("enablechanged",this._enable))}),pL(0,pf,"isSingleton",function(){return pq._isSingleton}),pq._isSingleton=!0,pq._uniqueIDCounter=1,pq}(),pmq=function(ph){function pq(){this._destroyed=!1,pq.__super.call(this),this._destroyed=!1}pv(pq,"laya.d3.core.GeometryFilter",pP);var pf=pq.prototype;return pE.imps(pf,{"laya.resource.IDestroy":!0}),pf._destroy=function(){this.offAll(),this._destroyed=!0},pL(0,pf,"_isAsyncLoaded",function(){return!0}),pL(0,pf,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),pL(0,pf,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),pL(0,pf,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),pL(0,pf,"destroyed",function(){return this._destroyed}),pq}(),pEq=function(ph){function pg(ph){pg.__super.call(this),this._id=++pg._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new poh(new pSq,new pSq),this._boundingBoxCenter=new pSq,this._boundingSphere=new pjh(new pSq,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=ph,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}pv(pg,"laya.d3.core.render.BaseRender",pP);var pq=pg.prototype;return pE.imps(pq,{"laya.resource.IDestroy":!0}),pq._changeMaterialReference=function(ph,pq){ph&&ph._removeReference(),pq._addReference()},pq._getInstanceMaterial=function(ph,pq){var pf=new ph.constructor;return ph.cloneTo(pf),pf.name=pf.name+"(Instance)",this._materialsInstance[pq]=!0,this._changeMaterialReference(this._materials[pq],pf),this._materials[pq]=pf},pq._setShaderValuelightMap=function(ph){this._setShaderValueTexture(3,ph)},pq._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},pq._renderRenderableBoundBox=function(){var ph=p_q._debugPhasorSprite,pq=this.boundingBox,pf=pg._tempBoundBoxCorners;pq.getCorners(pf),ph.line(pf[0],pg._greenColor,pf[1],pg._greenColor),ph.line(pf[2],pg._greenColor,pf[3],pg._greenColor),ph.line(pf[4],pg._greenColor,pf[5],pg._greenColor),ph.line(pf[6],pg._greenColor,pf[7],pg._greenColor),ph.line(pf[0],pg._greenColor,pf[3],pg._greenColor),ph.line(pf[1],pg._greenColor,pf[2],pg._greenColor),ph.line(pf[2],pg._greenColor,pf[6],pg._greenColor),ph.line(pf[3],pg._greenColor,pf[7],pg._greenColor),ph.line(pf[0],pg._greenColor,pf[4],pg._greenColor),ph.line(pf[1],pg._greenColor,pf[5],pg._greenColor),ph.line(pf[4],pg._greenColor,pf[7],pg._greenColor),ph.line(pf[5],pg._greenColor,pf[6],pg._greenColor)},pq._calculateBoundingSphere=function(){throw"BaseRender: must override it."},pq._calculateBoundingBox=function(){throw"BaseRender: must override it."},pq._setShaderValueTexture=function(ph,pq){this._owner._shaderValues.setValue(ph,pq)},pq._setShaderValueMatrix4x4=function(ph,pq){this._owner._shaderValues.setValue(ph,pq?pq.elements:null)},pq._setShaderValueColor=function(ph,pq){this._owner._shaderValues.setValue(ph,pq?pq.elements:null)},pq._setShaderValueBuffer=function(ph,pq){this._owner._shaderValues.setValue(ph,pq)},pq._setShaderValueInt=function(ph,pq){this._owner._shaderValues.setValue(ph,pq)},pq._setShaderValueBool=function(ph,pq){this._owner._shaderValues.setValue(ph,pq)},pq._setShaderValueNumber=function(ph,pq){this._owner._shaderValues.setValue(ph,pq)},pq._setShaderValueVector2=function(ph,pq){this._owner._shaderValues.setValue(ph,pq?pq.elements:null)},pq._addShaderDefine=function(ph){this._owner._shaderDefineValue|=ph},pq._removeShaderDefine=function(ph){this._owner._shaderDefineValue&=~ph},pq._renderUpdate=function(ph){return!0},pq._applyLightMapParams=function(){if(0<=this._lightmapIndex){var ph=this._owner.scene;if(ph){var pq=ph.getlightmaps()[this._lightmapIndex];pq?(this._addShaderDefine(pyq.SAHDERDEFINE_LIGHTMAP),pq.loaded?this._setShaderValuelightMap(pq):pq.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(pyq.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(pyq.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(pyq.SAHDERDEFINE_LIGHTMAP)},pq._updateOctreeNode=function(){var ph=this._treeNode;ph&&this._octreeNodeNeedChange&&(ph.updateObject(this),this._octreeNodeNeedChange=!1)},pq._destroy=function(){this.offAll();var ph=0,pq=0;for(ph=0,pq=this._renderElements.length;ph<pq;ph++)this._renderElements[ph]._destroy();for(ph=0,pq=this._materials.length;ph<pq;ph++)this._materials[ph]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},pL(0,pq,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),pL(0,pq,"id",function(){return this._id}),pL(0,pq,"material",function(){var ph=this._materials[0];if(ph&&!this._materialsInstance[0]){var pq=this._getInstanceMaterial(ph,0);this.event("materialchanged",[this,0,pq])}return this._materials[0]},function(ph){this.sharedMaterial=ph}),pL(0,pq,"sharedMaterial",function(){return this._materials[0]},function(ph){var pq=this._materials[0];pq!==ph&&(this._materials[0]=ph,this._materialsInstance[0]=!1,this._changeMaterialReference(pq,ph),this.event("materialchanged",[this,0,ph]))}),pL(0,pq,"lightmapIndex",function(){return this._lightmapIndex},function(ph){this._lightmapIndex=ph,this._applyLightMapParams()}),pL(0,pq,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(ph){this._lightmapScaleOffset=ph,this._setShaderValueColor(2,ph),this._addShaderDefine(pyq.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),pL(0,pq,"enable",function(){return this._enable},function(ph){this._enable=ph,this.event("enablechanged",[this,ph])}),pL(0,pq,"materials",function(){for(var ph=0,pq=this._materials.length;ph<pq;ph++)if(!this._materialsInstance[ph]){var pf=this._getInstanceMaterial(this._materials[ph],ph);this.event("materialchanged",[this,ph,pf])}return this._materials.slice()},function(ph){this.sharedMaterials=ph}),pL(0,pq,"sharedMaterials",function(){return this._materials.slice()},function(ph){if(!ph)throw new Error("MeshRender: shadredMaterials value can't be null.");var pq=ph.length;this._materialsInstance.length=pq;for(var pf=0;pf<pq;pf++){var pg=this._materials[pf];pg!==ph[pf]&&(this._materialsInstance[pf]=!1,this._changeMaterialReference(pg,ph[pf]),this.event("materialchanged",[this,pf,ph[pf]]))}this._materials=ph}),pL(0,pq,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),pL(0,pq,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var ph=this.boundingBox;pSq.add(ph.min,ph.max,this._boundingBoxCenter),pSq.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),pL(0,pq,"receiveShadow",function(){return this._receiveShadow},function(ph){this._receiveShadow!==ph&&((this._receiveShadow=ph)?this._addShaderDefine(pvq.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(pvq.SHADERDEFINE_RECEIVE_SHADOW))}),pL(0,pq,"destroyed",function(){return this._destroyed}),pg._uniqueIDCounter=0,pU(pg,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq,new pSq]},"_greenColor",function(){return this._greenColor=new pBq(0,1,0,1)}]),pg}(),pRq=function(ph){function pB(ph){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,pB.__super.call(this),this._localPosition=new pSq,this._localRotation=new pfq(0,0,0,1),this._localScale=new pSq(1,1,1),this._localRotationEuler=new pSq,this._localMatrix=new phq,this._position=new pSq,this._rotation=new pfq(0,0,0,1),this._scale=new pSq(1,1,1),this._worldMatrix=new phq,this._forward=new pSq,this._up=new pSq,this._right=new pSq,this._owner=ph,this._childs=[]}pv(pB,"laya.d3.core.Transform3D",pP);var pq=pB.prototype;return pq._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)phq.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var ph=pB._tempVector30;pSq.multiply(this.pivot,this._localScale,ph);var pq=pB._tempVector31;pSq.subtract(ph,this.pivot,pq);var pf=pB._tempVector32,pg=this.localRotation;pSq.transformQuat(ph,pg,pf),pSq.subtract(pf,ph,pf);var p$=pB._tempVector33;pSq.subtract(this._localPosition,pq,p$),pSq.subtract(p$,pf,p$),phq.createAffineTransformation(p$,pg,this._localScale,this._localMatrix)}},pq._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._onWorldPositionRotationTransform()}},pq._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._onWorldPositionScaleTransform()}},pq._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._onWorldPositionTransform()}},pq._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._onWorldPositionRotationTransform()}},pq._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._onWorldPositionScaleTransform()}},pq._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._onWorldTransform()}},pq.translate=function(ph,pq){void 0===pq&&(pq=!0),pq?(phq.createFromQuaternion(this.localRotation,pB._tempMatrix0),pSq.transformCoordinate(ph,pB._tempMatrix0,pB._tempVector30),pSq.add(this.localPosition,pB._tempVector30,this._localPosition),this.localPosition=this._localPosition):(pSq.add(this.position,ph,this._position),this.position=this._position)},pq.rotate=function(ph,pq,pf){var pg;void 0===pq&&(pq=!0),void 0===pf&&(pf=!0),pg=pf?ph:(pSq.scale(ph,Math.PI/180,pB._tempVector30),pB._tempVector30),pfq.createFromYawPitchRoll(pg.y,pg.x,pg.z,pB._tempQuaternion0),pq?(pfq.multiply(this._localRotation,pB._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(pfq.multiply(pB._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},pq.lookAt=function(ph,pq,pf){void 0===pf&&(pf=!1);var pg,p$=ph.elements;if(pf){if(pg=this._localPosition.elements,Math.abs(pg[0]-p$[0])<pxh.zeroTolerance&&Math.abs(pg[1]-p$[1])<pxh.zeroTolerance&&Math.abs(pg[2]-p$[2])<pxh.zeroTolerance)return;pfq.lookAt(this._localPosition,ph,pq,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var pP=this.position;if(pg=pP.elements,Math.abs(pg[0]-p$[0])<pxh.zeroTolerance&&Math.abs(pg[1]-p$[1])<pxh.zeroTolerance&&Math.abs(pg[2]-p$[2])<pxh.zeroTolerance)return;pfq.lookAt(pP,ph,pq,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},pL(0,pq,"_isFrontFaceInvert",function(){var ph=this.scale,pq=ph.x<0;return ph.y<0&&(pq=!pq),ph.z<0&&(pq=!pq),pq}),pL(0,pq,"owner",function(){return this._owner}),pL(0,pq,"localRotation",function(){if(this._localQuaternionUpdate){var ph=this._localRotationEuler.elements;pfq.createFromYawPitchRoll(ph[1]/pB._angleToRandin,ph[0]/pB._angleToRandin,ph[2]/pB._angleToRandin,this._localRotation)}return this._localRotation},function(ph){this._localRotation=ph,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),pL(0,pq,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?phq.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(ph){null===this._parent?ph.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),phq.multiply(this._localMatrix,ph,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=ph,this._worldUpdate=!1}),pL(0,pq,"worldNeedUpdate",function(){return this._worldUpdate}),pL(0,pq,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(ph){this._localMatrix=ph,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),pL(0,pq,"dummy",function(){return this._dummy},function(ph){this._dummy!==ph&&(this._dummy&&(this._dummy._entity=null),ph&&(ph._entity=this),this._dummy=ph)}),pL(0,pq,"localPosition",function(){return this._localPosition},function(ph){this._localPosition=ph,this._localUpdate=!0,this._onWorldPositionTransform()}),pL(0,pq,"position",function(){if(this._positionUpdate){if(null!=this._parent){var ph=this._parent.position;pSq.multiply(this._localPosition,this._parent.scale,pB._tempVector30),pSq.transformQuat(pB._tempVector30,this._parent.rotation,pB._tempVector30),pSq.add(ph,pB._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(ph){if(null!=this._parent){pSq.subtract(ph,this._parent.position,this._localPosition);var pq=this._parent.scale.elements,pf=pq[0],pg=pq[1],p$=pq[2];if(1!==pf||1!==pg||1!==p$){var pP=pB._tempVector30,pS=pP.elements;pS[0]=1/pf,pS[1]=1/pg,pS[2]=1/p$,pSq.multiply(this._localPosition,pP,this._localPosition)}this._parent.rotation.invert(pB._tempQuaternion0),pSq.transformQuat(this._localPosition,pB._tempQuaternion0,this._localPosition)}else ph.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=ph,this._positionUpdate=!1}),pL(0,pq,"localScale",function(){return this._localScale},function(ph){this._localScale=ph,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),pL(0,pq,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(pB._tempVector30);var ph=pB._tempVector30.elements,pq=this._localRotationEuler.elements;pq[0]=ph[1]*pB._angleToRandin,pq[1]=ph[0]*pB._angleToRandin,pq[2]=ph[2]*pB._angleToRandin}return this._localRotationEuler},function(ph){this._localRotationEuler=ph,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),pL(0,pq,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?pfq.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(ph){null!=this._parent?(this._parent.rotation.invert(pB._tempQuaternion0),pfq.multiply(ph,pB._tempQuaternion0,this._localRotation)):ph.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=ph,this._rotationUpdate=!1}),pL(0,pq,"scale",function(){return this._scaleUpdate&&(null!==this._parent?pSq.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(ph){if(null!==this._parent){var pq=this._parent.scale.elements,pf=pB._tempVector30.elements;pf[0]=1/pq[0],pf[1]=1/pq[1],pf[2]=1/pq[2],pSq.multiply(ph,pB._tempVector30,this._localScale)}else ph.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=ph,this._scaleUpdate=!1}),pL(0,pq,"rotationEuler",null,function(ph){pfq.createFromYawPitchRoll(ph.y,ph.x,ph.z,this._rotation),this.rotation=this._rotation}),pL(0,pq,"forward",function(){var ph=this.worldMatrix.elements;return this._forward.elements[0]=-ph[8],this._forward.elements[1]=-ph[9],this._forward.elements[2]=-ph[10],this._forward}),pL(0,pq,"up",function(){var ph=this.worldMatrix.elements;return this._up.elements[0]=ph[4],this._up.elements[1]=ph[5],this._up.elements[2]=ph[6],this._up}),pL(0,pq,"right",function(){var ph=this.worldMatrix.elements;return this._right.elements[0]=ph[0],this._right.elements[1]=ph[1],this._right.elements[2]=ph[2],this._right}),pL(0,pq,"parent",function(){return this._parent},function(ph){if(this._parent!==ph){if(this._parent){var pq=this._parent._childs,pf=pq.indexOf(this);pq.splice(pf,1)}ph&&(ph._childs.push(this),ph&&this._onWorldTransform()),this._parent=ph}}),pU(pB,["_tempVector30",function(){return this._tempVector30=new pSq},"_tempVector31",function(){return this._tempVector31=new pSq},"_tempVector32",function(){return this._tempVector32=new pSq},"_tempVector33",function(){return this._tempVector33=new pSq},"_tempQuaternion0",function(){return this._tempQuaternion0=new pfq},"_tempMatrix0",function(){return this._tempMatrix0=new phq},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),pB}(),ptq=(function(ph){function pq(){this._rotation=0,this._matNeedUpdte=!1,pq.__super.call(this),this._matrix=new phq,this._offset=new pPq,this._tiling=new pPq(1,1)}pv(pq,"laya.d3.core.TransformUV",pP);var pf=pq.prototype;pE.imps(pf,{"laya.d3.core.IClone":!0}),pf._updateMatrix=function(){pq._tempOffsetV3.elements[0]=this._offset.x,pq._tempOffsetV3.elements[1]=this._offset.y,pfq.createFromYawPitchRoll(0,0,this._rotation,pq._tempRotationQua),pq._tempTitlingV3.elements[0]=this._tiling.x,pq._tempTitlingV3.elements[1]=this._tiling.y,phq.createAffineTransformation(pq._tempOffsetV3,pq._tempRotationQua,pq._tempTitlingV3,this._matrix)},pf.cloneTo=function(ph){ph._matrix=this._matrix.clone(),ph._offset=this._offset.clone(),ph._rotation=this._rotation,ph._tiling=this._tiling.clone()},pf.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pf,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),pL(0,pf,"tiling",function(){return this._tiling},function(ph){this._tiling=ph,this._matNeedUpdte=!0}),pL(0,pf,"offset",function(){return this._offset},function(ph){this._offset=ph,this._matNeedUpdte=!0}),pL(0,pf,"rotation",function(){return this._rotation},function(ph){this._rotation=ph,this._matNeedUpdte=!0}),pU(pq,["_tempOffsetV3",function(){return this._tempOffsetV3=new pSq(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new pfq},"_tempTitlingV3",function(){return this._tempTitlingV3=new pSq(1,1,1)}])}(),function(pf){function ph(){this.x=NaN,this.y=NaN,this.z=NaN,ph.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}pv(ph,"laya.d3.core.particleShuriKen.module.shape.BoxShape",pf);var pq=ph.prototype;pq._getShapeBoundBox=function(ph){var pq=ph.min.elements;pq[0]=.5*-this.x,pq[1]=.5*-this.y,pq[2]=.5*-this.z;var pf=ph.max.elements;pf[0]=.5*this.x,pf[1]=.5*this.y,pf[2]=.5*this.z},pq._getSpeedBoundBox=function(ph){var pq=ph.min.elements;pq[0]=0,pq[1]=0,pq[2]=0;var pf=ph.max.elements;pf[0]=0,pf[1]=1,pf[2]=0},pq.generatePositionAndDirection=function(ph,pq,pf,pg){var p$=ph.elements,pP=pq.elements;pf?(pf.seed=pg[16],pV._randomPointInsideHalfUnitBox(ph,pf),pg[16]=pf.seed):pV._randomPointInsideHalfUnitBox(ph),p$[0]=this.x*p$[0],p$[1]=this.y*p$[1],p$[2]=this.z*p$[2],this.randomDirection?pf?(pf.seed=pg[17],pV._randomPointUnitSphere(pq,pf),pg[17]=pf.seed):pV._randomPointUnitSphere(pq):(pP[0]=0,pP[1]=0,pP[2]=1)},pq.cloneTo=function(ph){pf.prototype.cloneTo.call(this,ph);var pq=ph;pq.x=this.x,pq.y=this.y,pq.z=this.z,pq.randomDirection=this.randomDirection}}(pw),function(pf){function pS(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,pS.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}pv(pS,"laya.d3.core.particleShuriKen.module.shape.CircleShape",pf);var ph=pS.prototype;ph._getShapeBoundBox=function(ph){var pq=ph.min.elements;pq[0]=pq[2]=-this.radius,pq[1]=0;var pf=ph.max.elements;pf[0]=pf[2]=this.radius,pf[1]=0},ph._getSpeedBoundBox=function(ph){var pq=ph.min.elements;pq[0]=pq[1]=-1,pq[2]=0;var pf=ph.max.elements;pf[0]=pf[1]=1,pf[2]=0},ph.generatePositionAndDirection=function(ph,pq,pf,pg){var p$=ph.elements,pP=pS._tempPositionPoint.elements;pf?(pf.seed=pg[16],this.emitFromEdge?pV._randomPointUnitArcCircle(this.arc,pS._tempPositionPoint,pf):pV._randomPointInsideUnitArcCircle(this.arc,pS._tempPositionPoint,pf),pg[16]=pf.seed):this.emitFromEdge?pV._randomPointUnitArcCircle(this.arc,pS._tempPositionPoint):pV._randomPointInsideUnitArcCircle(this.arc,pS._tempPositionPoint),p$[0]=-pP[0],p$[1]=pP[1],p$[2]=0,pSq.scale(ph,this.radius,ph),this.randomDirection?pf?(pf.seed=pg[17],pV._randomPointUnitSphere(pq,pf),pg[17]=pf.seed):pV._randomPointUnitSphere(pq):ph.cloneTo(pq)},ph.cloneTo=function(ph){pf.prototype.cloneTo.call(this,ph);var pq=ph;pq.radius=this.radius,pq.arc=this.arc,pq.emitFromEdge=this.emitFromEdge,pq.randomDirection=this.randomDirection},pU(pS,["_tempPositionPoint",function(){return this._tempPositionPoint=new pPq}])}(pw),function(pf){function pu(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,pu.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}pv(pu,"laya.d3.core.particleShuriKen.module.shape.ConeShape",pf);var ph=pu.prototype;ph._getShapeBoundBox=function(ph){var pq=this.radius+this.length*Math.sin(this.angle),pf=this.length*Math.cos(this.angle),pg=ph.min.elements;pg[0]=pg[1]=-pq,pg[2]=0;var p$=ph.max.elements;p$[0]=p$[1]=pq,p$[2]=pf},ph._getSpeedBoundBox=function(ph){var pq=Math.sin(this.angle),pf=ph.min.elements;pf[0]=pf[1]=-pq,pf[2]=0;var pg=ph.max.elements;pg[0]=pf[1]=pq,pg[2]=1},ph.generatePositionAndDirection=function(ph,pq,pf,pg){var p$,pP=ph.elements,pS=pq.elements,pB=pu._tempPositionPoint.elements,pr=NaN,pY=NaN,pC=Math.cos(this.angle),pU=Math.sin(this.angle);switch(this.emitType){case 0:pf?(pf.seed=pg[16],pV._randomPointInsideUnitCircle(pu._tempPositionPoint,pf),pg[16]=pf.seed):pV._randomPointInsideUnitCircle(pu._tempPositionPoint),pr=pB[0],pY=pB[1],pP[0]=pr*this.radius,pP[1]=pY*this.radius,pP[2]=0,this.randomDirection?(pf?(pf.seed=pg[17],pV._randomPointInsideUnitCircle(pu._tempDirectionPoint,pf),pg[17]=pf.seed):pV._randomPointInsideUnitCircle(pu._tempDirectionPoint),p$=pu._tempDirectionPoint.elements,pS[0]=p$[0]*pU,pS[1]=p$[1]*pU):(pS[0]=pr*pU,pS[1]=pY*pU),pS[2]=pC;break;case 1:pf?(pf.seed=pg[16],pV._randomPointUnitCircle(pu._tempPositionPoint,pf),pg[16]=pf.seed):pV._randomPointUnitCircle(pu._tempPositionPoint),pr=pB[0],pY=pB[1],pP[0]=pr*this.radius,pP[1]=pY*this.radius,pP[2]=0,this.randomDirection?(pf?(pf.seed=pg[17],pV._randomPointInsideUnitCircle(pu._tempDirectionPoint,pf),pg[17]=pf.seed):pV._randomPointInsideUnitCircle(pu._tempDirectionPoint),p$=pu._tempDirectionPoint.elements,pS[0]=p$[0]*pU,pS[1]=p$[1]*pU):(pS[0]=pr*pU,pS[1]=pY*pU),pS[2]=pC;break;case 2:pf?(pf.seed=pg[16],pV._randomPointInsideUnitCircle(pu._tempPositionPoint,pf)):pV._randomPointInsideUnitCircle(pu._tempPositionPoint),pr=pB[0],pY=pB[1],pP[0]=pr*this.radius,pP[1]=pY*this.radius,pS[pP[2]=0]=pr*pU,pS[1]=pY*pU,pS[2]=pC,pSq.normalize(pq,pq),pf?(pSq.scale(pq,this.length*pf.getFloat(),pq),pg[16]=pf.seed):pSq.scale(pq,this.length*Math.random(),pq),pSq.add(ph,pq,ph),this.randomDirection&&(pf?(pf.seed=pg[17],pV._randomPointUnitSphere(pq,pf),pg[17]=pf.seed):pV._randomPointUnitSphere(pq));break;case 3:pf?(pf.seed=pg[16],pV._randomPointUnitCircle(pu._tempPositionPoint,pf)):pV._randomPointUnitCircle(pu._tempPositionPoint),pr=pB[0],pY=pB[1],pP[0]=pr*this.radius,pP[1]=pY*this.radius,pS[pP[2]=0]=pr*pU,pS[1]=pY*pU,pS[2]=pC,pSq.normalize(pq,pq),pf?(pSq.scale(pq,this.length*pf.getFloat(),pq),pg[16]=pf.seed):pSq.scale(pq,this.length*Math.random(),pq),pSq.add(ph,pq,ph),this.randomDirection&&(pf?(pf.seed=pg[17],pV._randomPointUnitSphere(pq,pf),pg[17]=pf.seed):pV._randomPointUnitSphere(pq));break;default:throw new Error("ConeShape:emitType is invalid.")}},ph.cloneTo=function(ph){pf.prototype.cloneTo.call(this,ph);var pq=ph;pq.angle=this.angle,pq.radius=this.radius,pq.length=this.length,pq.emitType=this.emitType,pq.randomDirection=this.randomDirection},pU(pu,["_tempPositionPoint",function(){return this._tempPositionPoint=new pPq},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new pPq}])}(pw),function(pf){function ph(){this.radius=NaN,this.emitFromShell=!1,ph.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}pv(ph,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",pf);var pq=ph.prototype;pq._getShapeBoundBox=function(ph){var pq=ph.min.elements;pq[0]=pq[1]=pq[2]=-this.radius;var pf=ph.max.elements;pf[0]=pf[1]=this.radius,pf[2]=0},pq._getSpeedBoundBox=function(ph){var pq=ph.min.elements;pq[0]=pq[1]=-1,pq[2]=0;var pf=ph.max.elements;pf[0]=pf[1]=pf[2]=1},pq.generatePositionAndDirection=function(ph,pq,pf,pg){var p$=ph.elements;pf?(pf.seed=pg[16],this.emitFromShell?pV._randomPointUnitSphere(ph,pf):pV._randomPointInsideUnitSphere(ph,pf),pg[16]=pf.seed):this.emitFromShell?pV._randomPointUnitSphere(ph):pV._randomPointInsideUnitSphere(ph),pSq.scale(ph,this.radius,ph);var pP=p$[2];pP<0&&(p$[2]=-1*pP),this.randomDirection?pf?(pf.seed=pg[17],pV._randomPointUnitSphere(pq,pf),pg[17]=pf.seed):pV._randomPointUnitSphere(pq):ph.cloneTo(pq)},pq.cloneTo=function(ph){pf.prototype.cloneTo.call(this,ph);var pq=ph;pq.radius=this.radius,pq.emitFromShell=this.emitFromShell,pq.randomDirection=this.randomDirection}}(pw),function(pf){function ph(){this.radius=NaN,this.emitFromShell=!1,ph.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}pv(ph,"laya.d3.core.particleShuriKen.module.shape.SphereShape",pf);var pq=ph.prototype;pq._getShapeBoundBox=function(ph){var pq=ph.min.elements;pq[0]=pq[1]=pq[2]=-this.radius;var pf=ph.max.elements;pf[0]=pf[1]=pf[2]=this.radius},pq._getSpeedBoundBox=function(ph){var pq=ph.min.elements;pq[0]=pq[1]=pq[2]=-1;var pf=ph.max.elements;pf[0]=pf[1]=pf[2]=1},pq.generatePositionAndDirection=function(ph,pq,pf,pg){pf?(pf.seed=pg[16],this.emitFromShell?pV._randomPointUnitSphere(ph,pf):pV._randomPointInsideUnitSphere(ph,pf),pg[16]=pf.seed):this.emitFromShell?pV._randomPointUnitSphere(ph):pV._randomPointInsideUnitSphere(ph),pSq.scale(ph,this.radius,ph),this.randomDirection?pf?(pf.seed=pg[17],pV._randomPointUnitSphere(pq,pf),pg[17]=pf.seed):pV._randomPointUnitSphere(pq):ph.cloneTo(pq)},pq.cloneTo=function(ph){pf.prototype.cloneTo.call(this,ph);var pq=ph;pq.radius=this.radius,pq.emitFromShell=this.emitFromShell,pq.randomDirection=this.randomDirection}}(pw),function(ph){function pq(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,pq.__super.call(this)}return pv(pq,"laya.d3.core.render.SubMeshRenderElement",pF),pq}()),pXq=function(ph){function pl(ph,pq,pf,pg,p$,pP){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=ph,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[pvq.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[pyq.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[pyq.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[pAq.SHADERDEFINE_ALPHATEST]="ALPHATEST";pl.__super.call(this,ph,pq,pf,null,{}),this._attributeMap=pg;var pS;for(pS in p$){var pB=p$[pS];switch(pB[1]){case 0:this._renderElementUniformMap[pS]=pB[0];break;case 1:this._materialUniformMap[pS]=pB[0];break;case 2:this._spriteUniformMap[pS]=pB[0];break;case 3:this._cameraUniformMap[pS]=pB[0];break;case 4:this._sceneUniformMap[pS]=pB[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}pv(pl,"laya.d3.shader.ShaderCompile3D",pG);var pq=pl.prototype;return pq._definesToNameDic=function(ph,pq){for(var pf={},pg=1,p$=0;p$<32&&!(ph<(pg=1<<p$));p$++)if(ph&pg){var pP=pq[pg];pP&&(pf[pP]="")}return pf},pq.withCompile=function(ph,pq,pf,pg){var p$,pP,pS;if(pP=this.sharders[ph])if(pS=pP[pq]){if(p$=pS[pf])return p$}else pS=pP[pq]=[];else pS=(pP=this.sharders[ph]=[])[pq]=[];var pB,pr=this._definesToNameDic(ph,pl._globalInt2name),pY=this._definesToNameDic(pq,this._spriteInt2name),pC=this._definesToNameDic(pf,this._materialInt2name),pU={},pu="";if(pr)for(pB in pr)pu+="#define "+pB+"\n",pU[pB]=!0;if(pY)for(pB in pY)pu+="#define "+pB+"\n",pU[pB]=!0;if(pC)for(pB in pC)pu+="#define "+pB+"\n",pU[pB]=!0;var pv=pWq.nameKey.getName(this._name)+" compile ("+ph+","+pq+","+pf+")",pL=this._VS.toscript(pU,[]),pe=this._PS.toscript(pU,[]);pi.now();if(p$=pWq.create(pu+pL.join("\n"),pu+pe.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,pg,pv),pS[pf]=p$,laya.d3.shader.ShaderCompile3D.debugMode)pi.now();return p$},pq.precompileShaderWithShaderDefine=function(ph,pq,pf){this.withCompile(ph,pq,pf,!0)},pq.addMaterialDefines=function(ph){var pq=ph.defines;for(var pf in pq){var pg=pq[pf],p$=parseInt(pf);this._materialInt2name[p$]=pg,this._materialName2Int[pg]=p$}},pq.addSpriteDefines=function(ph){var pq=ph.defines;for(var pf in pq){var pg=pq[pf],p$=parseInt(pf);this._spriteInt2name[p$]=pg,this._spriteName2Int[pg]=p$}},pq.getMaterialDefineByName=function(ph){return this._materialName2Int[ph]},pq.registerMaterialDefine=function(ph){var pq=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[pq]=ph,this._materialName2Int[ph]=pq},pq.registerSpriteDefine=function(ph){var pq=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[pq]=ph,this._spriteName2Int[ph]=pq},pl._globalRegDefine=function(ph,pq){pl._globalInt2name[pq]=ph},pl.add=function(ph,pq,pf,pg,p$){return laya.d3.shader.ShaderCompile3D._preCompileShader[ph]=new pl(ph,pq,pf,pg,p$,pG.includes)},pl.get=function(ph){return laya.d3.shader.ShaderCompile3D._preCompileShader[pWq.nameKey.getID(ph)]},pl._preCompileShader={},pl._globalInt2name=[],pl.debugMode=!1,pl.SHADERDEFINE_HIGHPRECISION=1,pl.SHADERDEFINE_FOG=4,pl.SHADERDEFINE_DIRECTIONLIGHT=8,pl.SHADERDEFINE_POINTLIGHT=16,pl.SHADERDEFINE_SPOTLIGHT=32,pl.SHADERDEFINE_UV0=64,pl.SHADERDEFINE_COLOR=128,pl.SHADERDEFINE_UV1=256,pl.SAHDERDEFINE_DEPTHFOG=131072,pl}(),pnq=function(ph){function pL(){pL.__super.call(this)}pv(pL,"laya.d3.graphics.MeshSprite3DStaticBatchManager",pgh);var pq=pL.prototype;return pq._getStaticBatch=function(ph,pq,pf,pg){var p$,pP;return pP=ph?ph.id.toString()+pf.id.toString()+pq.id.toString()+pg.toString():pf.id.toString()+pq.id.toString()+pg.toString(),this._staticBatches[pP]?p$=this._staticBatches[pP]:this._staticBatches[pP]=p$=new pJq(pP,this,ph,pq,pf),p$},pq._initStaticBatchs=function(ph){var pq,pf;this._initBatchRenderElements.sort(pL._sortPrepareStaticBatch);for(var pg,p$=!1,pP=0,pS=0,pB=this._initBatchRenderElements.length;pS<pB;pS++){var pr,pY=this._initBatchRenderElements[pS],pC=pY.renderObj._getVertexBuffer(0);pY._sprite3D;if(pf===pC.vertexDeclaration&&pq===pY._material)if(p$)pg._addCombineBatchRenderObjTest(pY)?(pr=pY._staticBatch)!==pg&&(pr&&pr._deleteCombineBatchRenderObj(pY),pg._addCombineBatchRenderObj(pY)):(p$=!1,pP++);else{var pU=this._initBatchRenderElements[pS-1],pu=pU.renderObj,pv=pY.renderObj;p$=!(65535<pu._getVertexBuffer().vertexCount+pv._getVertexBuffer().vertexCount)&&(pg=this._getStaticBatch(ph,pf,pq,pP),(pr=pU._staticBatch)!==pg&&(pr&&pr._deleteCombineBatchRenderObj(pU),pg._addCombineBatchRenderObj(pU)),(pr=pY._staticBatch)!==pg&&(pr&&pr._deleteCombineBatchRenderObj(pY),pg._addCombineBatchRenderObj(pY)),!0)}else p$=!1,pP=0;pq=pY._material,pf=pC.vertexDeclaration}},pL._sortPrepareStaticBatch=function(ph,pq){var pf=ph._render,pg=pq._render,p$=pf.lightmapIndex-pg.lightmapIndex;if(0!=p$)return p$;var pP=pf.receiveShadow-pg.receiveShadow;if(0!=pP)return pP;var pS=ph._mainSortID-pq._mainSortID;return 0==pS?ph.renderObj.triangleCount-pq.renderObj.triangleCount:pS},pL}(),pJq=function(ph){function pP(ph,pq,pf,pg,p$){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,pP.__super.call(this,ph,pq,pf),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=pg,this._material=p$}pv(pP,"laya.d3.graphics.SubMeshStaticBatch",p$h);var pq=pP.prototype;return pq._compareBatchRenderElement=function(ph,pq){return ph._batchIndexStart>pq._batchIndexStart},pq._addCombineBatchRenderObjTest=function(ph){var pq=ph.renderObj._vertexCount;return!(65535<(0<pq?this._currentCombineVertexCount+pq:this._currentCombineVertexCount+ph.renderObj._getVertexBuffer().vertexCount))},pq._addCombineBatchRenderObj=function(ph){var pq=ph.renderObj,pf=pq._vertexCount;this._initBatchRenderElements.push(ph),ph._staticBatch=this,0<pf?(this._currentCombineIndexCount+=pq._indexCount,this._currentCombineVertexCount+=pf):(this._currentCombineIndexCount=this._currentCombineIndexCount+pq._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+pq._getVertexBuffer().vertexCount),this._needFinishCombine=!0},pq._deleteCombineBatchRenderObj=function(ph){var pq=ph.renderObj,pf=this._initBatchRenderElements.indexOf(ph);if(-1!==pf){this._initBatchRenderElements.splice(pf,1),ph._staticBatch=null;var pg=pq._vertexCount;0<pg?(this._currentCombineIndexCount=this._currentCombineIndexCount-pq._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-pg):(this._currentCombineIndexCount=this._currentCombineIndexCount-pq._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-pq._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},pq._finishInit=function(){if(this._needFinishCombine){var ph=0,pq=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var pf=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),pg=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=pwq.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=pIq.create("ushort",this._currentCombineIndexCount,35044);for(var p$=0,pP=this._initBatchRenderElements.length;p$<pP;p$++){var pS=this._initBatchRenderElements[p$],pB=pS.renderObj,pr=pB._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,pS._sprite3D),pY=pB.getIndices(),pC=pS._sprite3D.transform._isFrontFaceInvert,pU=ph/(this._vertexDeclaration.vertexStride/4)-pB._vertexStart,pu=pq,pv=pu+pY.length;pS._batchIndexStart=pu,pS._batchIndexEnd=pv,pg.set(pY,pq);var pL=0;if(pC)for(pL=pu;pL<pv;pL+=3){pg[pL]=pU+pg[pL];var pe=pg[pL+1],pl=pg[pL+2];pg[pL+1]=pU+pl,pg[pL+2]=pU+pe}else for(pL=pu;pL<pv;pL+=3)pg[pL]=pU+pg[pL],pg[pL+1]=pU+pg[pL+1],pg[pL+2]=pU+pg[pL+2];pq+=pY.length,pf.set(pr,ph),ph+=pr.length}this._vertexBuffer.setData(pf),this._indexBuffer.setData(pg),this._needFinishCombine=!1}},pq._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new ptq)},pq._getRenderElement=function(ph,pq,pf){for(var pg,p$,pP=this._batchRenderElements.length,pS=!0,pB=0;pB<pP;pB++){var pr,pY,pC=(p$=this._batchRenderElements[pB])._sprite3D._render;if(0!==pB&&(pS=(pr=(pg=this._batchRenderElements[pB-1])._sprite3D._render).lightmapIndex!==pC.lightmapIndex||pr.receiveShadow!==pC.receiveShadow||pg._batchIndexEnd!==p$._batchIndexStart),pS){(pY=this._getCombineRenderElementFromPool()).renderObj=this,pY._material=this._material,pY._batchIndexStart=p$._batchIndexStart,pY._batchIndexEnd=p$._batchIndexEnd;var pU=pC.lightmapIndex,pu=pU+1,pv=this._batchOwnerIndices[pu];pv||(pv=this._batchOwnerIndices[pu]=[]);var pL,pe=pv[p$._render.receiveShadow?1:0];void 0===pe?(pv[pC.receiveShadow?1:0]=this._batchOwners.length,(pL=new pZq(null,"StaticBatchMeshSprite3D"))._scene=pq,pL._transform=this._rootOwner?this._rootOwner._transform:null,pL._render.lightmapIndex=pU,pL._render.receiveShadow=p$._render.receiveShadow,this._batchOwners.push(pL)):pL=this._batchOwners[pe],pL._render._renderUpdate(pf),pY._sprite3D=pL,ph.push(pY)}else pY._batchIndexEnd=p$._batchIndexEnd}},pq._beforeRender=function(ph){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},pq._render=function(ph){var pq=ph.renderElement,pf=pq._batchIndexStart,pg=pq._batchIndexEnd-pf;pd.mainContext.drawElements(4,pg,5123,2*pf),pX.drawCall++,pX.trianglesFaces+=pg/3},pq.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},pq._getVertexBuffer=function(ph){return void 0===ph&&(ph=0),this._vertexBuffer},pP}(),ppq=function(ph){function pq(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,pq.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}pv(pq,"laya.d3.core.ComponentNode",pY);var pf=pq.prototype;return pf.addComponent=function(ph){var pq,pf=this._componentsMap.indexOf(ph);if(-1===pf)pq=[],this._componentsMap.push(ph),this._typeComponentsIndices.push(pq);else if(pq=this._typeComponentsIndices[pf],this._components[pq[0]].isSingleton)throw new Error("无法单实例创建"+ph+"组件，"+ph+"组件已存在！");var pg=p$.getInstance(ph);return pq.push(this._components.length),this._components.push(pg),pg instanceof laya.d3.component.Script&&this._scripts.push(pg),pg._initialize(this),pg},pf._removeComponent=function(ph,pq){var pf=this._typeComponentsIndices[ph],pg=pf[pq],p$=this._components[pg];this._components.splice(pg,1),p$ instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(p$),1),pf.splice(pq,1),0===pf.length&&(this._typeComponentsIndices.splice(ph,1),this._componentsMap.splice(ph,1));for(var pP=0,pS=this._componentsMap.length;pP<pS;pP++)for(var pB=(pf=this._typeComponentsIndices[pP]).length-1;0<=pB;pB--){var pr=pf[pB];if(!(pg<pr))break;pf[pB]=--pr}p$._destroy()},pf.getComponentByType=function(ph,pq){void 0===pq&&(pq=0);var pf=this._componentsMap.indexOf(ph);return-1===pf?null:this._components[this._typeComponentsIndices[pf][pq]]},pf.getComponentsByType=function(ph,pq){var pf=this._componentsMap.indexOf(ph);if(-1!==pf){var pg=this._typeComponentsIndices[pf],p$=pg.length;pq.length=p$;for(var pP=0;pP<p$;pP++)pq[pP]=this._components[pg[pP]]}else pq.length=0},pf.getComponentByIndex=function(ph){return this._components[ph]},pf.removeComponentByType=function(ph,pq){void 0===pq&&(pq=0);var pf=this._componentsMap.indexOf(ph);-1!==pf&&this._removeComponent(pf,pq)},pf.removeComponentsByType=function(ph){var pq=this._componentsMap.indexOf(ph);if(-1!==pq)for(var pf=this._typeComponentsIndices[pq],pg=0,p$=pf.length;pg<p$;pf.length<p$?p$--:pg++)this._removeComponent(pq,pg)},pf.removeAllComponent=function(){for(var ph=0,pq=this._componentsMap.length;ph<pq;this._componentsMap.length<pq?pq--:ph++)this.removeComponentsByType(this._componentsMap[ph])},pf._updateComponents=function(ph){for(var pq=0,pf=this._components.length;pq<pf;pq++){var pg=this._components[pq];!pg.started&&(pg._start(ph),pg.started=!0),pg.enable&&pg._update(ph)}},pf._lateUpdateComponents=function(ph){for(var pq=0;pq<this._components.length;pq++){var pf=this._components[pq];!pf.started&&(pf._start(ph),pf.started=!0),pf.enable&&pf._lateUpdate(ph)}},pf._preRenderUpdateComponents=function(ph){for(var pq=0;pq<this._components.length;pq++){var pf=this._components[pq];!pf.started&&(pf._start(ph),pf.started=!0),pf.enable&&pf._preRenderUpdate(ph)}},pf._postRenderUpdateComponents=function(ph){for(var pq=0;pq<this._components.length;pq++){var pf=this._components[pq];!pf.started&&(pf._start(ph),pf.started=!0),pf.enable&&pf._postRenderUpdate(ph)}},pq}(),pAq=function(pg){function ph(){ph.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new puq,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new pBq(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}pv(ph,"laya.d3.core.material.BaseMaterial",pg);var pq=ph.prototype;return pE.imps(pq,{"laya.d3.core.IClone":!0}),pq._addShaderDefine=function(ph){this._shaderDefineValue|=ph},pq._removeShaderDefine=function(ph){this._shaderDefineValue&=~ph},pq._addDisablePublicShaderDefine=function(ph){this._disablePublicShaderDefine|=ph},pq._removeDisablePublicShaderDefine=function(ph){this._disablePublicShaderDefine&=~ph},pq._setBuffer=function(ph,pq){this._shaderValues.setValue(ph,pq),this._values[ph]=pq},pq._getBuffer=function(ph){return this._values[ph]},pq._setMatrix4x4=function(ph,pq){this._shaderValues.setValue(ph,pq?pq.elements:null),this._values[ph]=pq},pq._getMatrix4x4=function(ph){return this._values[ph]},pq._setInt=function(ph,pq){this._shaderValues.setValue(ph,pq),this._values[ph]=pq},pq._getInt=function(ph){return this._values[ph]},pq._setNumber=function(ph,pq){this._shaderValues.setValue(ph,pq),this._values[ph]=pq},pq._getNumber=function(ph){return this._values[ph]},pq._setBool=function(ph,pq){this._shaderValues.setValue(ph,pq),this._values[ph]=pq},pq._getBool=function(ph){return this._values[ph]},pq._setVector2=function(ph,pq){this._shaderValues.setValue(ph,pq?pq.elements:null),this._values[ph]=pq},pq._getVector2=function(ph){return this._values[ph]},pq._setColor=function(ph,pq){this._shaderValues.setValue(ph,pq?pq.elements:null),this._values[ph]=pq},pq._getColor=function(ph){return this._values[ph]},pq._setTexture=function(ph,pq){var pf=this._values[ph];this._values[ph]=pq,this._shaderValues.setValue(ph,pq),0<this.referenceCount&&(pf&&pf._removeReference(),pq&&pq._addReference())},pq._getTexture=function(ph){return this._values[ph]},pq._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},pq._getShader=function(ph,pq,pf){var pg=(ph|pq)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(pg,pf,this._shaderDefineValue),this._shader},pq._setRenderStateBlendDepth=function(){var ph=pd.mainContext;switch(pb.setDepthMask(ph,this.depthWrite),0===this.depthTest?pb.setDepthTest(ph,!1):(pb.setDepthTest(ph,!0),pb.setDepthFunc(ph,this.depthTest)),this.blend){case 0:pb.setBlend(ph,!1);break;case 1:pb.setBlend(ph,!0),pb.setBlendFunc(ph,this.srcBlend,this.dstBlend);break;case 2:pb.setBlend(ph,!0)}},pq._setRenderStateFrontFace=function(ph,pq){var pf=pd.mainContext,pg=0;switch(this.cull){case 0:pb.setCullFace(pf,!1);break;case 1:pb.setCullFace(pf,!0),pg=ph?pq&&pq._isFrontFaceInvert?2305:2304:pq&&pq._isFrontFaceInvert?2304:2305,pb.setFrontFace(pf,pg);break;case 2:pb.setCullFace(pf,!0),pg=ph?pq&&pq._isFrontFaceInvert?2304:2305:pq&&pq._isFrontFaceInvert?2305:2304,pb.setFrontFace(pf,pg)}},pq.onAsynLoaded=function(ph,pq,pf){var pg=pq[0],p$=pq[1];switch(pg.version){case"LAYAMATERIAL:01":var pP=0,pS=0,pB=pg.props;for(var pr in pB)switch(pr){case"vectors":var pY=pB[pr];for(pP=0,pS=pY.length;pP<pS;pP++){var pC=pY[pP],pU=pC.value;switch(pU.length){case 2:this[pC.name]=new pPq(pU[0],pU[1]);break;case 3:this[pC.name]=new pSq(pU[0],pU[1],pU[2]);break;case 4:this[pC.name]=new pBq(pU[0],pU[1],pU[2],pU[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var pu=pB[pr];for(pP=0,pS=pu.length;pP<pS;pP++){var pv=pu[pP],pL=pv.path;pL&&(this[pv.name]=p_.getRes(p$[pL]))}break;case"defines":var pe=pB[pr];for(pP=0,pS=pe.length;pP<pS;pP++){var pl=this._shaderCompile.getMaterialDefineByName(pe[pP]);this._addShaderDefine(pl)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[pr]=pB[pr];break;case"renderQueue":switch(pB[pr]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[pr]=pB[pr]}break;case"LAYAMATERIAL:02":for(pr in pB=pg.props)switch(pr){case"vectors":for(pP=0,pS=(pY=pB[pr]).length;pP<pS;pP++)switch((pU=(pC=pY[pP]).value).length){case 2:this[pC.name]=new pPq(pU[0],pU[1]);break;case 3:this[pC.name]=new pSq(pU[0],pU[1],pU[2]);break;case 4:this[pC.name]=new pBq(pU[0],pU[1],pU[2],pU[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(pP=0,pS=(pu=pB[pr]).length;pP<pS;pP++)(pL=(pv=pu[pP]).path)&&(this[pv.name]=p_.getRes(p$[pL]));break;case"defines":for(pP=0,pS=(pe=pB[pr]).length;pP<pS;pP++)pl=this._shaderCompile.getMaterialDefineByName(pe[pP]),this._addShaderDefine(pl);break;default:this[pr]=pB[pr]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},pq._addReference=function(){pg.prototype._addReference.call(this);for(var ph=0,pq=this._values.length;ph<pq;ph++){var pf=this._values[ph];pf&&pf instanceof laya.d3.resource.BaseTexture&&pf._addReference()}},pq._removeReference=function(){pg.prototype._removeReference.call(this);for(var ph=0,pq=this._values.length;ph<pq;ph++){var pf=this._values[ph];pf&&pf instanceof laya.d3.resource.BaseTexture&&pf._removeReference()}},pq.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},pq.setShaderName=function(ph){var pq=pWq.nameKey.getID(ph);if(-1===pq)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=pXq._preCompileShader[pq]},pq.cloneTo=function(ph){var pq=ph;pq.name=this.name,pq.cull=this.cull,pq.blend=this.blend,pq.srcBlend=this.srcBlend,pq.dstBlend=this.dstBlend,pq.srcBlendRGB=this.srcBlendRGB,pq.dstBlendRGB=this.dstBlendRGB,pq.srcBlendAlpha=this.srcBlendAlpha,pq.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(pq.blendConstColor),pq.blendEquation=this.blendEquation,pq.blendEquationRGB=this.blendEquationRGB,pq.blendEquationAlpha=this.blendEquationAlpha,pq.depthTest=this.depthTest,pq.depthWrite=this.depthWrite,pq.renderQueue=this.renderQueue,pq._shader=this._shader,pq._disablePublicShaderDefine=this._disablePublicShaderDefine,pq._shaderDefineValue=this._shaderDefineValue;var pf,pg=0,p$=pq._shaderValues;pq._shaderValues.data.length=this._shaderValues.data.length;var pP=this._values.length,pS=pq._values;for(pg=0,pf=pS.length=pP;pg<pf;pg++){var pB=this._values[pg];if(pB)if("number"==typeof pB)pS[pg]=pB,p$.data[pg]=pB;else if("number"==typeof pB&&Math.floor(pB)==pB)pS[pg]=pB,p$.data[pg]=pB;else if("boolean"==typeof pB)pS[pg]=pB,p$.data[pg]=pB;else if(pB instanceof laya.d3.math.Vector2){var pr=pS[pg]||(pS[pg]=new pPq);pB.cloneTo(pr),p$.data[pg]=pr.elements}else if(pB instanceof laya.d3.math.Vector3){var pY=pS[pg]||(pS[pg]=new pSq);pB.cloneTo(pY),p$.data[pg]=pY.elements}else if(pB instanceof laya.d3.math.Vector4){var pC=pS[pg]||(pS[pg]=new pBq);pB.cloneTo(pC),p$.data[pg]=pC.elements}else if(pB instanceof laya.d3.math.Matrix4x4){var pU=pS[pg]||(pS[pg]=new phq);pB.cloneTo(pU),p$.data[pg]=pU.elements}else pB instanceof laya.d3.resource.BaseTexture&&(pS[pg]=pB,p$.data[pg]=pB)}},pq.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pL(0,pq,"alphaTestValue",function(){return this._getNumber(0)},function(ph){this._setNumber(0,ph)}),pL(0,pq,"alphaTest",function(){return this._alphaTest},function(ph){(this._alphaTest=ph)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),ph.__init__=function(){ph.SHADERDEFINE_ALPHATEST=ph.shaderDefines.registerDefine("ALPHATEST")},ph.RENDERQUEUE_OPAQUE=2e3,ph.RENDERQUEUE_ALPHATEST=2450,ph.RENDERQUEUE_TRANSPARENT=3e3,ph.CULL_NONE=0,ph.CULL_FRONT=1,ph.CULL_BACK=2,ph.BLEND_DISABLE=0,ph.BLEND_ENABLE_ALL=1,ph.BLEND_ENABLE_SEPERATE=2,ph.BLENDPARAM_ZERO=0,ph.BLENDPARAM_ONE=1,ph.BLENDPARAM_SRC_COLOR=768,ph.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,ph.BLENDPARAM_DST_COLOR=774,ph.BLENDPARAM_ONE_MINUS_DST_COLOR=775,ph.BLENDPARAM_SRC_ALPHA=770,ph.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,ph.BLENDPARAM_DST_ALPHA=772,ph.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,ph.BLENDPARAM_SRC_ALPHA_SATURATE=776,ph.BLENDEQUATION_ADD=0,ph.BLENDEQUATION_SUBTRACT=1,ph.BLENDEQUATION_REVERSE_SUBTRACT=2,ph.DEPTHTEST_OFF=0,ph.DEPTHTEST_NEVER=512,ph.DEPTHTEST_LESS=513,ph.DEPTHTEST_EQUAL=514,ph.DEPTHTEST_LEQUAL=515,ph.DEPTHTEST_GREATER=516,ph.DEPTHTEST_NOTEQUAL=517,ph.DEPTHTEST_GEQUAL=518,ph.DEPTHTEST_ALWAYS=519,ph.SHADERDEFINE_ALPHATEST=1,ph.ALPHATESTVALUE=0,pU(ph,["shaderDefines",function(){return this.shaderDefines=new pCq}]),ph}(pl),pdq=function(ph){function pq(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,pq.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}pv(pq,"laya.d3.resource.BaseTexture",pl);var pf=pq.prototype;return pL(0,pf,"width",function(){return this._width}),pL(0,pf,"repeat",function(){return this._repeat},function(ph){if(this._repeat!==ph&&(this._repeat=ph,this._source)){var pq=pd.mainContext;pb.bindTexture(pq,this._type,this._source),pm.isPOT(this._width,this._height)&&this._repeat?(pq.texParameteri(this._type,10242,10497),pq.texParameteri(this._type,10243,10497)):(pq.texParameteri(this._type,10242,33071),pq.texParameteri(this._type,10243,33071))}}),pL(0,pf,"height",function(){return this._height}),pL(0,pf,"magFifter",function(){return this._magFifter},function(ph){(this._magFifter=ph)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(ph)}),pL(0,pf,"wrapModeV",function(){return this._wrapModeV}),pL(0,pf,"size",function(){return this._size}),pL(0,pf,"wrapModeU",function(){return this._wrapModeU}),pL(0,pf,"mipmap",function(){return this._mipmap},function(ph){this._mipmap=ph,this._mipmap!=ph&&this._conchTexture&&this._conchTexture.setMipMap(ph)}),pL(0,pf,"minFifter",function(){return this._minFifter},function(ph){this._minFifter=ph,this._minFifter!=ph&&this._conchTexture&&this._conchTexture.setMinFifter(ph)}),pL(0,pf,"format",function(){return this._format}),pL(0,pf,"source",function(){return this.activeResource(),this._source}),pL(0,pf,"defaulteTexture",function(){return psq.grayTexture}),pq.WARPMODE_REPEAT=0,pq.WARPMODE_CLAMP=1,pq}(),pbq=function(ph){function pq(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,pq.__super.call(this),this._boundingBoxCorners=pg(8,null)}pv(pq,"laya.d3.resource.models.BaseMesh",pl);var pf=pq.prototype;return pf._getPositions=function(){throw new Error("未Override,请重载该属性！")},pf._generateBoundingObject=function(){this._boundingSphere=new pjh(new pSq,0),pjh.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new poh(new pSq,new pSq),poh.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},pf.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},pf.getRenderElement=function(ph){throw new Error("未Override,请重载该属性！")},pL(0,pf,"subMeshCount",function(){return this._subMeshCount}),pL(0,pf,"boundingBox",function(){return this._boundingBox}),pL(0,pf,"boundingBoxCorners",function(){return this._boundingBoxCorners}),pL(0,pf,"boundingSphere",function(){return this._boundingSphere}),pq}(),piq=(function(ph){function pq(){pq.__super.call(this)}pv(pq,"laya.d3.component.Script",pGq);var pf=pq.prototype;pf.onTriggerEnter=function(ph){},pf.onTriggerExit=function(ph){},pf.onTriggerStay=function(ph){},pL(0,pf,"isSingleton",function(){return pq._isSingleton}),pq._isSingleton=!1}(),function(ph){function pq(ph){this._owner=null,this._sharedMesh=null,pq.__super.call(this),this._owner=ph}pv(pq,"laya.d3.core.MeshFilter",ph);var pf=pq.prototype;return pf._sharedMeshLoaded=function(){this.event("loaded")},pf._destroy=function(){ph.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},pL(0,pf,"sharedMesh",function(){return this._sharedMesh},function(ph){var pq=this._sharedMesh;pq&&pq._removeReference(),(this._sharedMesh=ph)._addReference(),this.event("meshchanged",[this,pq,ph]),ph.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),pL(0,pf,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),pL(0,pf,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),pL(0,pf,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),pL(0,pf,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),pq}(pmq)),pzq=function(ph){function pq(ph){pq.__super.call(this,ph),ph.meshFilter.on("meshchanged",this,this._onMeshChanged)}pv(pq,"laya.d3.core.MeshRender",pEq);var pf=pq.prototype;return pf._onMeshChanged=function(ph,pq,pf){pf.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:pf.once("loaded",this,this._onMeshLoaed)},pf._onMeshLoaed=function(ph,pq){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},pf._calculateBoundingSphereByInitSphere=function(ph){var pq=NaN,pf=this._owner.transform,pg=pf.scale.elements,p$=Math.abs(pg[0]),pP=Math.abs(pg[1]),pS=Math.abs(pg[2]);pq=pP<=p$&&pS<=p$?p$:pS<=pP?pP:pS,pSq.transformCoordinate(ph.center,pf.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=ph.radius*pq},pf._calculateBoundBoxByInitCorners=function(ph){for(var pq=this._owner.transform.worldMatrix,pf=0;pf<8;pf++)pSq.transformCoordinate(ph[pf],pq,pEq._tempBoundBoxCorners[pf]);poh.createfromPoints(pEq._tempBoundBoxCorners,this._boundingBox)},pf._calculateBoundingSphere=function(){var ph=this._owner.meshFilter.sharedMesh;null==ph||null==ph.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(ph.boundingSphere)},pf._calculateBoundingBox=function(){var ph=this._owner.meshFilter.sharedMesh;null==ph||null==ph.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(ph.boundingBoxCorners)},pf._renderUpdate=function(ph){var pq=this._owner.transform;if(pq){this._setShaderValueMatrix4x4(0,pq.worldMatrix);var pf=this._owner.getProjectionViewWorldMatrix(ph);this._setShaderValueMatrix4x4(1,pf)}else this._setShaderValueMatrix4x4(0,phq.DEFAULT),this._setShaderValueMatrix4x4(1,ph);return p_q.debugMode&&this._renderRenderableBoundBox(),!0},pq}(),pcq=function(pq){function pg(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,pg.__super.call(this),this._renderState=new pQ,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new puq,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new pqh,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new pSq(.7,.7,.7),this.ambientColor=new pSq(.212,.227,.259),pd.shaderHighPrecision&&this.addShaderDefine(pXq.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}pv(pg,"laya.d3.core.scene.Scene",pq);var ph=pg.prototype;return pE.imps(ph,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),ph._setUrl=function(ph){this._url=ph},ph._getGroup=function(){return this._group},ph._setGroup=function(ph){this._group=ph},ph._display=function(){pE.stage._scenes.push(this),pE.stage._scenes.sort(pg._sortScenes);for(var ph=0,pq=this._childs.length;ph<pq;ph++){var pf=this._childs[ph];pf.active&&pf._activeHierarchy()}},ph._unDisplay=function(){var ph=pE.stage._scenes;ph.splice(ph.indexOf(this),1);for(var pq=0,pf=this._childs.length;pq<pf;pq++){var pg=this._childs[pq];pg.active&&pg._inActiveHierarchy()}},ph._addChild3D=function(ph){ph.transform._onWorldTransform(),ph._setBelongScene(this),this.displayedInStage&&ph.active&&ph._activeHierarchy()},ph._removeChild3D=function(ph){ph.transform.parent=null,this.displayedInStage&&ph.active&&ph._inActiveHierarchy(),ph._setUnBelongScene()},ph.initOctree=function(ph,pq,pf,pg,p$){void 0===p$&&(p$=6),this.treeSize=new pSq(ph,pq,pf),this.treeLevel=p$,this.treeRoot=new po(this,0),this.treeRoot.init(pg,this.treeSize)},ph._prepareUpdateToRenderState=function(ph,pq){pq.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,pq.scene=this},ph._prepareSceneToRender=function(ph){var pq=this._lights.length;if(0<pq)for(var pf=0,pg=0;pg<pq&&!(this._lights[pg]._prepareToScene(ph)&&++pf>=this._enableLightCount);pg++);},ph._updateChilds=function(ph){for(var pq=0,pf=this._childs.length;pq<pf;++pq)this._childs[pq]._update(ph)},ph._preRenderScene=function(ph,pq,pf){var pg,p$=pq._viewMatrix,pP=pq._projectionMatrix,pS=pq._projectionViewMatrix,pB=0,pr=pq.camera;for(pr.useOcclusionCulling?this.treeRoot?pfh.renderObjectCullingOctree(pf,this,pr,p$,pP,pS):pfh.renderObjectCulling(pf,this,pr,p$,pP,pS):pfh.renderObjectCullingNoBoundFrustum(this,pr,p$,pP,pS),pB=0,pg=this._quenes.length;pB<pg;pB++)this._quenes[pB]&&this._quenes[pB]._preRender(pq)},ph._clear=function(ph,pq){var pf=pq._viewport,pg=pq.camera,p$=pf.x,pP=pg.renderTargetSize.height-pf.y-pf.height,pS=pf.width,pB=pf.height;ph.viewport(p$,pP,pS,pB);var pr=256,pY=pg.renderTarget;switch(pg.clearFlag){case 0:var pC=pg.clearColor;if(pC){ph.enable(3089),ph.scissor(p$,pP,pS,pB);var pU=pC.elements;ph.clearColor(pU[0],pU[1],pU[2],pU[3]),pr|=16384}if(pY)switch(pC||(pr=16384),pY.depthStencilFormat){case 33189:pr|=256;break;case 36168:pr|=1024;break;case 34041:pr|=256,pr|=1024}ph.clear(pr),pC&&ph.disable(3089);break;case 1:case 2:if(pY)switch(pr=16384,pY.depthStencilFormat){case 33189:pr|=256;break;case 36168:pr|=1024;break;case 34041:pr|=256,pr|=1024}ph.clear(pr);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},ph._renderScene=function(ph,pq){var pf,pg,p$=pq.camera,pP=0;for(pP=0;pP<2;pP++)(pg=this._quenes[pP])&&(p$.renderTarget?pg._render(pq,!0):pg._render(pq,!1));if(1===p$.clearFlag){var pS=p$.sky;pS&&(pb.setCullFace(ph,!1),pb.setDepthFunc(ph,515),pb.setDepthMask(ph,!1),pS._render(pq),pb.setDepthFunc(ph,513),pb.setDepthMask(ph,!0))}for(pP=2,pf=this._quenes.length;pP<pf;pP++)(pg=this._quenes[pP])&&(pg._sortAlpha(pq.camera.transform.position),p$.renderTarget?pg._render(pq,!0):pg._render(pq,!1))},ph._set3DRenderConfig=function(ph){ph.disable(3042),pb._blend=!1,ph.blendFunc(770,771),pb._sFactor=770,pb._dFactor=771,ph.disable(2929),pb._depthTest=!1,ph.enable(2884),pb._cullFace=!0,ph.depthMask(1),pb._depthMask=!0,ph.frontFace(2304),pb._frontFace=2304},ph._set2DRenderConfig=function(ph){pb.setBlend(ph,!0),pb.setBlendFunc(ph,1,771),pb.setDepthTest(ph,!1),pb.setCullFace(ph,!1),pb.setDepthMask(ph,!0),pb.setFrontFace(ph,2305),ph.viewport(0,0,pC.width,pC.height)},ph._parseCustomProps=function(ph,pq,pf,pg){var p$=pg.customProps.lightmaps,pP=p$.length,pS=this._lightmaps;pS.length=pP;for(var pB=0;pB<pP;pB++)pS[pB]=p_.getRes(pq[p$[pB].replace(".exr",".png")]);this.setlightmaps(pS);var pr=pg.customProps.ambientColor;pr&&(this.ambientColor=new pSq(pr[0],pr[1],pr[2]));var pY=pg.customProps.fogColor;pY&&(this.fogColor=new pSq(pY[0],pY[1],pY[2]))},ph._addLight=function(ph){this._lights.indexOf(ph)<0&&this._lights.push(ph)},ph._removeLight=function(ph){var pq=this._lights.indexOf(ph);0<=pq&&this._lights.splice(pq,1)},ph._updateScene=function(){var ph=this._renderState;this._prepareUpdateToRenderState(pd.mainContext,ph),this._updateComponents(ph),this._updateChilds(ph),this._lateUpdateComponents(ph),this._time+=ph.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},ph._updateSceneConch=function(){var ph=this._renderState;this._prepareUpdateToRenderState(pd.mainContext,ph),this._updateComponents(ph),this._lateUpdateComponents(ph),this._prepareSceneToRender(ph);for(var pq=0,pf=this._cameraPool.length;pq<pf;pq++){var pg=this._cameraPool[pq];(ph.camera=pg)._prepareCameraToRender()}},ph._preRenderShadow=function(ph,pq,pf,pg,p$){this.treeRoot?pfh.renderShadowObjectCullingOctree(this,pq,pf,pg,p$):pfh.renderShadowObjectCulling(this,pq,pf,pg,p$);for(var pP=0,pS=pf.length;pP<pS;pP++)pf[pP]&&pf[pP]._preRender(ph)},ph._renderShadowMap=function(ph,pq,pf){var pg=this.parallelSplitShadowMaps[0];pg._calcAllLightCameraInfo(pf);var p$,pP,pS,pB=pg.PSSMNum;if(this._preRenderShadow(pq,pg._lightCulling,pg._shadowQuenes,pg._lightVPMatrix[0],pB),this.addShaderDefine(pvq.SHADERDEFINE_CAST_SHADOW),1<pB)for(var pr=0;pr<pB;pr++)p$=pg.getRenderTarget(pr+1),pg.beginRenderTarget(pr+1),ph.clearColor(1,1,1,1),ph.clear(16640),ph.viewport(0,0,p$.width,p$.height),pq.camera=pS=pg.getLightCamera(pr),pS._prepareCameraToRender(),pS._prepareCameraViewProject(pS.viewMatrix,pS.projectionMatrix),pq._projectionViewMatrix=pg._lightVPMatrix[pr+1],(pP=pg._shadowQuenes[pr])._preRender(pq),pP._renderShadow(pq,!1),pg.endRenderTarget(pr+1);else p$=pg.getRenderTarget(1),pg.beginRenderTarget(1),ph.clearColor(1,1,1,1),ph.clear(16640),ph.viewport(0,0,p$.width,p$.height),pq.camera=pS=pg.getLightCamera(0),pS._prepareCameraToRender(),pS._prepareCameraViewProject(pS.viewMatrix,pS.projectionMatrix),pq._projectionViewMatrix=pg._lightVPMatrix[0],(pP=pg._shadowQuenes[0])._preRender(pq),pP._renderShadow(pq,!0),pg.endRenderTarget(1);this.removeShaderDefine(pvq.SHADERDEFINE_CAST_SHADOW)},ph.addTreeNode=function(ph){this.treeRoot.addTreeNode(ph)},ph.removeTreeNode=function(ph){this.treeSize&&ph._treeNode&&ph._treeNode.removeObject(ph)},ph.setlightmaps=function(ph){this._lightmaps=ph;for(var pq=0,pf=this._renderableSprite3Ds.length;pq<pf;pq++)this._renderableSprite3Ds[pq]._render._applyLightMapParams()},ph.getlightmaps=function(){return this._lightmaps},ph.addChildAt=function(ph,pq){if(!(ph instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(ph&&ph.__className));if(!ph||this.destroyed||ph===this)return ph;if(ph.zOrder&&this._set$P("hasZorder",!0),0<=pq&&pq<=this._childs.length){if(ph._parent===this){var pf=this.getChildIndex(ph);this._childs.splice(pf,1),this._childs.splice(pq,0,ph),this.conchModel&&(this.conchModel.removeChild(ph.conchModel),this.conchModel.addChildAt(ph.conchModel,pq)),this._childChanged()}else ph.parent&&ph.parent.removeChild(ph),this._childs===pY.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(pq,0,ph),this.conchModel&&this.conchModel.addChildAt(ph.conchModel,pq),(ph.parent=this)._addChild3D(ph);return ph}throw new Error("appendChildAt:The index is out of bounds")},ph.addChild=function(ph){if(!(ph instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!ph||this.destroyed||ph===this)return ph;if(ph.zOrder&&this._set$P("hasZorder",!0),ph._parent===this){var pq=this.getChildIndex(ph);pq!==this._childs.length-1&&(this._childs.splice(pq,1),this._childs.push(ph),this.conchModel&&(this.conchModel.removeChild(ph.conchModel),this.conchModel.addChildAt(ph.conchModel,this._childs.length-1)),this._childChanged())}else ph.parent&&ph.parent.removeChild(ph),this._childs===pY.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(ph),this.conchModel&&this.conchModel.addChildAt(ph.conchModel,this._childs.length-1),(ph.parent=this)._childChanged(),this._addChild3D(ph);return ph},ph.removeChildAt=function(ph){var pq=this.getChildAt(ph);return pq&&(this._removeChild3D(pq),this._childs.splice(ph,1),this.conchModel&&this.conchModel.removeChild(pq.conchModel),pq.parent=null),pq},ph.removeChildren=function(ph,pq){if(void 0===ph&&(ph=0),void 0===pq&&(pq=2147483647),this._childs&&0<this._childs.length){var pf=this._childs;if(0===ph&&pP<=pq){var pg=pf;this._childs=pY.ARRAY_EMPTY}else pg=pf.splice(ph,pq-ph);for(var p$=0,pP=pg.length;p$<pP;p$++)this._removeChild3D(pg[p$]),pg[p$].parent=null,this.conchModel&&this.conchModel.removeChild(pg[p$].conchModel)}return this},ph.addFrustumCullingObject=function(ph){this.treeRoot?this.addTreeNode(ph):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(ph):this._cullingRenders[this._cullingRendersLength]=ph,ph._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},ph.removeFrustumCullingObject=function(ph){if(this.treeRoot)this.removeTreeNode(ph);else{this._cullingRendersLength--;var pq=ph._indexInSceneFrustumCullingObjects;if(pq!==this._cullingRendersLength){var pf=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[pq]=pf)._indexInSceneFrustumCullingObjects=pq,ph._indexInSceneFrustumCullingObjects=-1}}},ph.getRenderQueue=function(ph){return ph<3e3?this._quenes[1]||(this._quenes[1]=new pZ(this)):this._quenes[2]||(this._quenes[2]=new pZ(this))},ph.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new pZ(this)},ph.addShaderDefine=function(ph){this._shaderDefineValue|=ph},ph.removeShaderDefine=function(ph){this._shaderDefineValue&=~ph},ph.addScript=function(ph){return this._addComponent(ph)},ph.getScriptByType=function(ph,pq){return void 0===pq&&(pq=0),this._getComponentByType(ph,pq)},ph.getScriptsByType=function(ph,pq){this._getComponentsByType(ph,pq)},ph.getScriptByIndex=function(ph){return this._getComponentByIndex(ph)},ph.removeScriptByType=function(ph,pq){void 0===pq&&(pq=0),this._removeComponentByType(ph,pq)},ph.removeScriptsByType=function(ph){this._removeComponentByType(ph)},ph.removeAllScript=function(){this._removeAllComponent()},ph.render=function(ph,pq,pf){(pe._context.ctx._renderKey=0)<this._childs.length&&ph.addRenderObject(this)},ph.renderSubmit=function(){var ph=pd.mainContext,pq=this._renderState;this._set3DRenderConfig(ph),this._prepareSceneToRender(this._renderState);var pf,pg=0,p$=0;if(p_q.debugMode||po.debugMode)for(pg=0,p$=this._cameraPool.length;pg<p$;pg++)pf=this._cameraPool[pg],p_q._debugPhasorSprite.begin(1,pf),pf.activeInHierarchy&&pf._renderCamera(ph,pq,this),p_q._debugPhasorSprite.end();else for(pg=0,p$=this._cameraPool.length;pg<p$;pg++)(pf=this._cameraPool[pg]).activeInHierarchy&&pf._renderCamera(ph,pq,this);return this._set2DRenderConfig(ph),1},ph.onAsynLoaded=function(ph,pq,pf){var pg=pq[0];if("Scene"!==pg.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var p$=pq[1];plq._createNodeByJson(this,pg,this,p$),this.event("hierarchyloaded",[this]),this.__loaded=!0},ph.destroy=function(ph){void 0===ph&&(ph=!0),this.destroyed||(pq.prototype.destroy.call(this,ph),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,p_.clearRes(this.url),this.loaded||p_q._cancelLoadByUrl(this.url))},ph.getRenderType=function(){return 0},ph.releaseRender=function(){},ph._addComponent=function(ph){var pq,pf=this._componentsMap.indexOf(ph);if(-1===pf)pq=[],this._componentsMap.push(ph),this._typeComponentsIndices.push(pq);else if(pq=this._typeComponentsIndices[pf],this._components[pq[0]].isSingleton)throw new Error("无法单实例创建"+ph+"组件，"+ph+"组件已存在！");var pg=p$.getInstance(ph);pq.push(this._components.length),this._components.push(pg);return pg._initialize(this),pg},ph._removeComponent=function(ph,pq){var pf=this._typeComponentsIndices[ph],pg=pf[pq],p$=this._components[pg];this._components.splice(pg,1),pf.splice(pq,1),0===pf.length&&(this._typeComponentsIndices.splice(ph,1),this._componentsMap.splice(ph,1));for(var pP=0,pS=this._componentsMap.length;pP<pS;pP++)for(var pB=(pf=this._typeComponentsIndices[pP]).length-1;0<=pB;pB--){var pr=pf[pB];if(!(pg<pr))break;pf[pB]=--pr}p$._destroy()},ph._getComponentByType=function(ph,pq){void 0===pq&&(pq=0);var pf=this._componentsMap.indexOf(ph);return-1===pf?null:this._components[this._typeComponentsIndices[pf][pq]]},ph._getComponentsByType=function(ph,pq){var pf=this._componentsMap.indexOf(ph);if(-1!==pf){var pg=this._typeComponentsIndices[pf],p$=pg.length;pq.length=p$;for(var pP=0;pP<p$;pP++)pq[pP]=this._components[pg[pP]]}else pq.length=0},ph._getComponentByIndex=function(ph){return this._components[ph]},ph._removeComponentByType=function(ph,pq){void 0===pq&&(pq=0);var pf=this._componentsMap.indexOf(ph);-1!==pf&&this._removeComponent(pf,pq)},ph._removeComponentsByType=function(ph){var pq=this._componentsMap.indexOf(ph);if(-1!==pq)for(var pf=this._typeComponentsIndices[pq],pg=0,p$=pf.length;pg<p$;pf.length<p$?p$--:pg++)this._removeComponent(pq,pg)},ph._removeAllComponent=function(){for(var ph=0,pq=this._componentsMap.length;ph<pq;this._componentsMap.length<pq?pq--:ph++)this._removeComponentsByType(this._componentsMap[ph])},ph._updateComponents=function(ph){for(var pq=0,pf=this._components.length;pq<pf;pq++){var pg=this._components[pq];!pg.started&&(pg._start(ph),pg.started=!0),pg.enable&&pg._update(ph)}},ph._lateUpdateComponents=function(ph){for(var pq=0;pq<this._components.length;pq++){var pf=this._components[pq];!pf.started&&(pf._start(ph),pf.started=!0),pf.enable&&pf._lateUpdate(ph)}},ph._preRenderUpdateComponents=function(ph){for(var pq=0;pq<this._components.length;pq++){var pf=this._components[pq];!pf.started&&(pf._start(ph),pf.started=!0),pf.enable&&pf._preRenderUpdate(ph)}},ph._postRenderUpdateComponents=function(ph){for(var pq=0;pq<this._components.length;pq++){var pf=this._components[pq];!pf.started&&(pf._start(ph),pf.started=!0),pf.enable&&pf._postRenderUpdate(ph)}},pL(0,ph,"_loaded",null,function(ph){this.__loaded=ph}),pL(0,ph,"fogColor",function(){return this._fogColor},function(ph){this._fogColor=ph,this._shaderValues.setValue(0,ph.elements)}),pL(0,ph,"enableFog",function(){return this._enableFog},function(ph){this._enableFog!==ph&&((this._enableFog=ph)?(this.addShaderDefine(pXq.SHADERDEFINE_FOG),this.removeShaderDefine(pXq.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(pXq.SHADERDEFINE_FOG))}),pL(0,ph,"url",function(){return this._url}),pL(0,ph,"loaded",function(){return this.__loaded}),pL(0,ph,"enableDepthFog",function(){return this._enableDepthFog},function(ph){this._enableDepthFog!=ph&&((this._enableDepthFog=ph)?(this.addShaderDefine(pXq.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(pXq.SHADERDEFINE_FOG)):this.removeShaderDefine(pXq.SAHDERDEFINE_DEPTHFOG))}),pL(0,ph,"fogStart",function(){return this._fogStart},function(ph){this._fogStart=ph,this._shaderValues.setValue(1,ph)}),pL(0,ph,"fogRange",function(){return this._fogRange},function(ph){this._fogRange=ph,this._shaderValues.setValue(2,ph)}),pL(0,ph,"ambientColor",function(){return this._ambientColor},function(ph){this._ambientColor=ph,this._shaderValues.setValue(21,ph.elements)}),pL(0,ph,"scene",function(){return this}),pL(0,ph,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),pg._sortScenes=function(ph,pq){if(ph.parent!==pE.stage||pq.parent!==pE.stage)return ph.parent!==pE.stage&&pq.parent!==pE.stage?pg._sortScenes(ph.parent,pq.parent):ph.parent===pE.stage?-1:1;var pf=pE.stage._childs;return pf.indexOf(ph)-pf.indexOf(pq)},pg.load=function(ph){return pE.loader.create(ph,null,null,pg)},pg.FOGCOLOR=0,pg.FOGSTART=1,pg.FOGRANGE=2,pg.LIGHTDIRECTION=3,pg.LIGHTDIRCOLOR=4,pg.POINTLIGHTPOS=5,pg.POINTLIGHTRANGE=6,pg.POINTLIGHTATTENUATION=7,pg.POINTLIGHTCOLOR=8,pg.SPOTLIGHTPOS=9,pg.SPOTLIGHTDIRECTION=10,pg.SPOTLIGHTSPOT=11,pg.SPOTLIGHTRANGE=12,pg.SPOTLIGHTATTENUATION=13,pg.SPOTLIGHTCOLOR=14,pg.SHADOWDISTANCE=15,pg.SHADOWLIGHTVIEWPROJECT=16,pg.SHADOWMAPPCFOFFSET=17,pg.SHADOWMAPTEXTURE1=18,pg.SHADOWMAPTEXTURE2=19,pg.SHADOWMAPTEXTURE3=20,pg.AMBIENTCOLOR=21,pg.TIME=22,pg}(pt),pMq=function(ph){function pq(ph){pq.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new phq,this._shaderValues=new puq,this._colliders=[],this._id=++pq._uniqueIDCounter,this._transform=new pRq(this),this.name=ph||"Sprite3D-"+pq._nameNumberCounter++,this.layer=pz.currentCreationLayer,this.active=!0}pv(pq,"laya.d3.core.Sprite3D",ppq);var pf=pq.prototype;return pE.imps(pf,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),pf._setUrl=function(ph){this._url=ph},pf._getGroup=function(){return this._group},pf._setGroup=function(ph){this._group=ph},pf._addChild3D=function(ph){ph.transform.parent=this.transform,this._hierarchyAnimator&&(!ph._hierarchyAnimator&&ph._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(ph,!0,[ph.name])),this._scene&&(ph._setBelongScene(this._scene),this._activeInHierarchy&&ph._active&&ph._activeHierarchy())},pf._removeChild3D=function(ph){ph.transform.parent=null,this._scene&&(this._activeInHierarchy&&ph._active&&ph._inActiveHierarchy(),ph._setUnBelongScene()),this._hierarchyAnimator&&(ph._hierarchyAnimator==this._hierarchyAnimator&&ph._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(ph,!1,[ph.name]))},pf._parseBaseCustomProps=function(ph){var pq=this.transform.localPosition;ph.translate?(pq.fromArray(ph.translate),pq.x*=100,pq.y*=100,pq.z*=100):pq.elements.fill(0),this.transform.localPosition=pq;var pf=this.transform.localRotation;ph.rotation?pf.fromArray(ph.rotation):pf.fromArray([0,0,0,-1]),this.transform.localRotation=pf;var pg=this.transform.localScale;ph.scale?pg.fromArray(ph.scale):pg.elements.fill(1),this.transform.localScale=pg;var p$=ph.layer;null!=p$&&(this.layer=pz.getLayerByNumber(p$))},pf._parseCustomComponent=function(ph,pq,pf){for(var pg in pf){var p$=pf[pg];switch(pg){case"Animator":var pP=this.addComponent(Animator);if(p$.avatarPath)pP.avatar=p_.getRes(pq[p$.avatarPath]);else{var pS=p$.avatar;if(pS){pP.avatar=p_.getRes(pq[pS.path]);var pB=pS.linkSprites;pB&&ph.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[pP,pB])}}for(var pr=p$.clipPaths,pY=pr.length,pC=0;pC<pY;pC++)pP.addClip(p_.getRes(pq[pr[pC]]));pP.clip=p_.getRes(pq[pr[0]]);var pU=p$.playOnWake;void 0!==pU&&(pP.playOnWake=pU);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var pu=this.addComponent(SphereCollider);pu.isTrigger=p$.isTrigger;var pv=pu.center;pv.fromArray(p$.center),pu.center=pv,pu.radius=p$.radius;break;case"BoxCollider":var pL=this.addComponent(BoxCollider);pL.isTrigger=p$.isTrigger,pL.center.fromArray(p$.center);var pe=pL.size;pe.fromArray(p$.size),pL.size=pe;break;case"MeshCollider":this.addComponent(MeshCollider)}}},pf._onRootNodeHierarchyLoaded=function(ph,pq){for(var pf in pq){for(var pg=this,p$=pq[pf],pP=0,pS=p$.length;pP<pS;pP++){var pB=p$[pP];if(""===pB)break;if(!(pg=pg.getChildByName(pB)))break}pg&&ph.linkSprite3DToAvatarNode(pf,pg)}},pf._setHierarchyAnimator=function(ph,pq){this._changeHierarchyAnimator(ph);for(var pf=0,pg=this._childs.length;pf<pg;pf++){var p$=this._childs[pf];p$._hierarchyAnimator==pq&&p$._setHierarchyAnimator(ph,pq)}},pf._clearHierarchyAnimator=function(ph,pq){this._changeHierarchyAnimator(pq);for(var pf=0,pg=this._childs.length;pf<pg;pf++){var p$=this._childs[pf];p$._hierarchyAnimator==ph&&p$._clearHierarchyAnimator(ph,pq)}},pf._getAnimatorToLinkSprite3D=function(ph,pq,pf){var pg=this.getComponentByType(Animator);if(pg&&(pg.avatar?pg.avatar._version||ph._setAnimatorToLinkAvatar(pg,pq):ph._setAnimatorToLinkSprite3DNoAvatar(pg,pq,pf)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){pf.unshift(this._parent.name);var p$=this._parent;p$._hierarchyAnimator&&p$._getAnimatorToLinkSprite3D(ph,pq,pf)}},pf._setAnimatorToLinkSprite3DNoAvatar=function(ph,pq,pf){var pg=0,p$=0;for(pg=0,p$=ph.getClipCount();pg<p$;pg++)ph._handleSpriteOwnersBySprite(pg,pq,pf,this);for(pg=0,p$=this._childs.length;pg<p$;pg++){var pP=this._childs[pg],pS=pf.length;pf.push(pP.name),pP._setAnimatorToLinkSprite3DNoAvatar(ph,pq,pf),pf.splice(pS,1)}},pf._changeHierarchyAnimator=function(ph){this._hierarchyAnimator=ph},pf._isLinkSpriteToAnimationNode=function(ph,pq,pf){var pg=ph._avatarNodes.indexOf(pq),p$=ph._cacheSpriteToNodesMap;if(pf)this._transform.dummy=pq.transform,ph._cacheNodesToSpriteMap[pg]=p$.length,p$.push(pg);else{this._transform.dummy=null;var pP=ph._cacheNodesToSpriteMap[pg];ph._cacheNodesToSpriteMap[pg]=null,p$.splice(pP,1)}},pf._setBelongScene=function(ph){this._scene=ph;for(var pq=0,pf=this._childs.length;pq<pf;pq++)this._childs[pq]._setBelongScene(ph)},pf._setUnBelongScene=function(){this._scene=null;for(var ph=0,pq=this._childs.length;ph<pq;ph++)this._childs[ph]._setUnBelongScene()},pf._activeHierarchy=function(){var ph=0,pq=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),ph=0,pq=this._colliders.length;ph<pq;ph++)this._layer._addCollider(this._colliders[ph]);for(this.event("activeinhierarchychanged",!0),ph=0,pq=this._childs.length;ph<pq;ph++){var pf=this._childs[ph];pf._active&&pf._activeHierarchy()}},pf._inActiveHierarchy=function(){var ph=0,pq=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),ph=0,pq=this._colliders.length;ph<pq;ph++){var pf=this._colliders[ph];pf._clearCollsionMap(),this._layer._removeCollider(pf)}for(this.event("activeinhierarchychanged",!1),ph=0,pq=this._childs.length;ph<pq;ph++){var pg=this._childs[ph];pg._active&&pg._inActiveHierarchy()}},pf.addComponent=function(ph){var pq,pf=this._componentsMap.indexOf(ph);if(-1===pf)pq=[],this._componentsMap.push(ph),this._typeComponentsIndices.push(pq);else if(pq=this._typeComponentsIndices[pf],this._components[pq[0]].isSingleton)throw new Error("无法单实例创建"+ph+"组件，"+ph+"组件已存在！");var pg=p$.getInstance(ph);return pq.push(this._components.length),this._components.push(pg),pg instanceof laya.d3.component.Script&&this._scripts.push(pg),pg._initialize(this),pg},pf._removeComponent=function(ph,pq){var pf,pg=0,p$=this._typeComponentsIndices[ph],pP=p$[pq],pS=this._components[pP];for(pS instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(pS),1),p$.splice(pq,1),0===p$.length&&(this._typeComponentsIndices.splice(ph,1),this._componentsMap.splice(ph,1)),pg=0,pf=this._componentsMap.length;pg<pf;pg++)for(var pB=(p$=this._typeComponentsIndices[pg]).length-1;0<=pB;pB--){var pr=p$[pB];if(!(pP<pr))break;p$[pB]=--pr}pS._destroy()},pf._clearSelfRenderObjects=function(){},pf._addSelfRenderObjects=function(){},pf._parseCustomProps=function(ph,pq,pf,pg){},pf._updateChilds=function(ph){var pq=this._childs.length;if(0!==pq)for(var pf=0;pf<pq;++pf)this._childs[pf]._update(ph)},pf._getSortID=function(ph,pq){return 1e3*pq.id+ph._getVertexBuffer().vertexDeclaration.id},pf._update=function(ph){(ph.owner=this)._activeInHierarchy&&(this._updateComponents(ph),this._lateUpdateComponents(ph),pX.spriteCount++,this._childs.length&&this._updateChilds(ph))},pf.getProjectionViewWorldMatrix=function(ph){return phq.multiply(ph,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},pf.loadHierarchy=function(ph){this.addChild(laya.d3.core.Sprite3D.load(ph))},pf.addChildAt=function(ph,pq){if(!(ph instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!ph||this.destroyed||ph===this)return ph;if(ph.zOrder&&this._set$P("hasZorder",!0),0<=pq&&pq<=this._childs.length){if(ph._parent===this){var pf=this.getChildIndex(ph);this._childs.splice(pf,1),this._childs.splice(pq,0,ph),this.conchModel&&(this.conchModel.removeChild(ph.conchModel),this.conchModel.addChildAt(ph.conchModel,pq)),this._childChanged()}else ph.parent&&ph.parent.removeChild(ph),this._childs===pY.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(pq,0,ph),this.conchModel&&this.conchModel.addChildAt(ph.conchModel,pq),(ph.parent=this)._addChild3D(ph);return ph}throw new Error("appendChildAt:The index is out of bounds")},pf.addChild=function(ph){if(!(ph instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!ph||this.destroyed||ph===this)return ph;if(ph.zOrder&&this._set$P("hasZorder",!0),ph._parent===this){var pq=this.getChildIndex(ph);pq!==this._childs.length-1&&(this._childs.splice(pq,1),this._childs.push(ph),this.conchModel&&(this.conchModel.removeChild(ph.conchModel),this.conchModel.addChildAt(ph.conchModel,this._childs.length-1)),this._childChanged())}else ph.parent&&ph.parent.removeChild(ph),this._childs===pY.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(ph),this.conchModel&&this.conchModel.addChildAt(ph.conchModel,this._childs.length-1),(ph.parent=this)._childChanged(),this._addChild3D(ph);return ph},pf.removeChildAt=function(ph){var pq=this.getChildAt(ph);return pq&&(this._removeChild3D(pq),this._childs.splice(ph,1),this.conchModel&&this.conchModel.removeChild(pq.conchModel),pq.parent=null),pq},pf.removeChildren=function(ph,pq){if(void 0===ph&&(ph=0),void 0===pq&&(pq=2147483647),this._childs&&0<this._childs.length){var pf=this._childs;if(0===ph&&pP<=pq){var pg=pf;this._childs=pY.ARRAY_EMPTY}else pg=pf.splice(ph,pq-ph);for(var p$=0,pP=pg.length;p$<pP;p$++)this._removeChild3D(pg[p$]),pg[p$].parent=null,this.conchModel&&this.conchModel.removeChild(pg[p$].conchModel)}return this},pf.onAsynLoaded=function(ph,pq,pf){var pg=pq[0];if("Sprite3D"!==pg.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var p$=pq[1];plq._createNodeByJson(this,pg,this,p$),this.event("hierarchyloaded",[this]),this.__loaded=!0},pf.cloneTo=function(ph){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var pq=ph;pq.name=this.name,pq._destroyed=this._destroyed,pq.timer=this.timer,pq._$P=this._$P,pq.active=this._active;var pf=pq.transform.localPosition;this.transform.localPosition.cloneTo(pf),pq.transform.localPosition=pf;var pg=pq.transform.localRotation;this.transform.localRotation.cloneTo(pg),pq.transform.localRotation=pg;var p$=pq.transform.localScale;this.transform.localScale.cloneTo(p$),pq.transform.localScale=p$,pq.isStatic=this.isStatic;var pP=0,pS=0;for(pP=0,pS=this._componentsMap.length;pP<pS;pP++){var pB=pq.addComponent(this._componentsMap[pP]);this._components[pP]._cloneTo(pB)}for(pP=0,pS=this._childs.length;pP<pS;pP++)pq.addChild(this._childs[pP].clone());var pr=pq.getComponentByType(Animator);if(pr){var pY=pr._linkSpritesData;if(pY)for(var pC in pY){for(var pU=pY[pC],pu=pq,pv=0,pL=pU.length;pv<pL&&(pu=pu.getChildByName(pU[pv]));pv++);if(pu){var pe=pr._avatarNodeMap[pC];pu._isLinkSpriteToAnimationNode(pr,pe,!0)}}}},pf.clone=function(){var ph=new this.constructor;return this.cloneTo(ph),ph},pf.destroy=function(ph){if(void 0===ph&&(ph=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,ph);var pq,pf=0;for(pf=0,pq=this._components.length;pf<pq;pf++)this._components[pf]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,p_.clearRes(this.url),this.loaded||p_q._cancelLoadByUrl(this.url)}},pf._handleSpriteToAvatar=function(ph,pq){ph._avatarNodes;var pf=ph._avatarNodeMap[this.name];pf&&pf.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(ph,pf,pq)},pf._setAnimatorToLinkAvatar=function(ph,pq){this._handleSpriteToAvatar(ph,pq);for(var pf=0,pg=this._childs.length;pf<pg;pf++){this._childs[pf]._setAnimatorToLinkAvatar(ph,pq)}},pL(0,pf,"activeInHierarchy",function(){return this._activeInHierarchy}),pL(0,pf,"_loaded",null,function(ph){this.__loaded=ph}),pL(0,pf,"active",function(){return this._active},function(ph){this._active!==ph&&(this._active=ph,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(ph?this._activeHierarchy():this._inActiveHierarchy()))}),pL(0,pf,"componentsCount",function(){return this._components.length}),pL(0,pf,"loaded",function(){return this.__loaded}),pL(0,pf,"id",function(){return this._id}),pL(0,pf,"url",function(){return this._url}),pL(0,pf,"layer",function(){return this._layer},function(ph){if(this._layer!==ph){if(!ph)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var pq=0,pf=this._colliders.length;if(this._layer)for(pq=0;pq<pf;pq++)this._layer._removeCollider(this._colliders[pq]);for(pq=0;pq<pf;pq++)ph._addCollider(this._colliders[pq])}this._layer=ph,this.event("layerchanged",ph)}}),pL(0,pf,"scene",function(){return this._scene}),pL(0,pf,"transform",function(){return this._transform}),pq.instantiate=function(ph,pq,pf,pg,p$){void 0===pf&&(pf=!0);var pP=ph.clone();pq&&pq.addChild(pP);var pS=pP.transform;if(pf){var pB=pS.worldMatrix;ph.transform.worldMatrix.cloneTo(pB),pS.worldMatrix=pB}else pg&&(pS.position=pg),p$&&(pS.rotation=p$);return pP},pq.load=function(ph){return pE.loader.create(ph,null,null,pq)},pq.WORLDMATRIX=0,pq.MVPMATRIX=1,pq._uniqueIDCounter=0,pq._nameNumberCounter=0,pq}(),pWq=function(ph){function pC(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],pC.__super.call(this),!ph||!pq)throw"Shader Error";this._id=++pC._count,this._vs=ph,this._ps=pq,this._attributeMap=pf,this._sceneUniformMap=pg,this._cameraUniformMap=p$,this._spriteUniformMap=pP,this._materialUniformMap=pS,this._renderElementUniformMap=pB,this._precompile=pr,this._define=pY,this._precompile&&pC.extCompileObj&&pC.extCompileFunc?pC.extCompileFunc.call(pC.extCompileObj,ph,pq,pY):this.recreateResource()}pv(pC,"laya.d3.shader.Shader3D",pf);var pq=pC.prototype;return pq.recreateResource=function(){pi.now();this._compile(),this.completeCreate(),this.memorySize=0},pq.disposeResource=function(){pd.mainContext.deleteShader(this._vshader),pd.mainContext.deleteShader(this._pshader),pd.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},pq._compile=function(){if(!pd.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var ph=[this._vs,this._ps],pq=pd.mainContext;if(this._program=pq.createProgram(),this._vshader=pC._createShader(pq,ph[0],35633),this._pshader=pC._createShader(pq,ph[1],35632),pq.attachShader(this._program,this._vshader),pq.attachShader(this._program,this._pshader),pq.linkProgram(this._program),!pe.isConchApp&&pXq.debugMode&&!pq.getProgramParameter(this._program,35714))throw pq.getProgramInfoLog(this._program);var pf,pg=0,p$=0,pP=0;for(pP=pe.isConchApp?pq.getProgramParameterEx(this._vs,this._ps,"",35721):pq.getProgramParameter(this._program,35721),pg=0;pg<pP;pg++){var pS=null;pf={vartype:"attribute",ivartype:0,attrib:pS=pe.isConchApp?pq.getActiveAttribEx(this._vs,this._ps,"",pg):pq.getActiveAttrib(this._program,pg),location:pq.getAttribLocation(this._program,pS.name),name:pS.name,type:pS.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(pf)}var pB=0;for(pB=pe.isConchApp?pq.getProgramParameterEx(this._vs,this._ps,"",35718):pq.getProgramParameter(this._program,35718),pg=0;pg<pB;pg++){var pr=null;pr=pe.isConchApp?pq.getActiveUniformEx(this._vs,this._ps,"",pg):pq.getActiveUniform(this._program,pg),0<(pf={vartype:"uniform",ivartype:1,attrib:pS,location:pq.getUniformLocation(this._program,pr.name),name:pr.name,type:pr.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(pf.name=pf.name.substr(0,pf.name.length-3),pf.isArray=!0,pf.location=pq.getUniformLocation(this._program,pf.name)),this._uniformParams.push(pf)}for(pg=0,p$=this._attributeParams.length;pg<p$;pg++)(pf=this._attributeParams[pg]).indexOfParams=pg,pf.index=1,pf.value=[pf.location,null],pf.codename=pf.name,pf.name=null!=this._attributeMap[pf.codename]?this._attributeMap[pf.codename]:pf.codename,this._attributeParamsMap.push(pf.name),this._attributeParamsMap.push(pf),pf._this=this,pf.uploadedValue=[],pf.fun=this._attribute;for(pg=0,p$=this._uniformParams.length;pg<p$;pg++)switch((pf=this._uniformParams[pg]).indexOfParams=pg,pf.index=1,pf.value=[pf.location,null],pf.codename=pf.name,null!=this._sceneUniformMap[pf.codename]?(pf.name=this._sceneUniformMap[pf.codename],this._sceneUniformParamsMap.push(pf.name),this._sceneUniformParamsMap.push(pf)):null!=this._cameraUniformMap[pf.codename]?(pf.name=this._cameraUniformMap[pf.codename],this._cameraUniformParamsMap.push(pf.name),this._cameraUniformParamsMap.push(pf)):null!=this._spriteUniformMap[pf.codename]?(pf.name=this._spriteUniformMap[pf.codename],this._spriteUniformParamsMap.push(pf.name),this._spriteUniformParamsMap.push(pf)):null!=this._materialUniformMap[pf.codename]?(pf.name=this._materialUniformMap[pf.codename],this._materialUniformParamsMap.push(pf.name),this._materialUniformParamsMap.push(pf)):null!=this._renderElementUniformMap[pf.codename]?(pf.name=this._renderElementUniformMap[pf.codename],this._renderElementUniformParamsMap.push(pf.name),this._renderElementUniformParamsMap.push(pf)):console.log("Shader:can't find uinform name:"+pf.codename+" in shader file."),pf._this=this,pf.uploadedValue=[],pf.type){case 5124:pf.fun=pf.isArray?this._uniform1iv:this._uniform1i;break;case 5126:pf.fun=pf.isArray?this._uniform1fv:this._uniform1f;break;case 35664:pf.fun=pf.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:pf.fun=pf.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:pf.fun=pf.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:pf.fun=this._uniform_sampler2D;break;case 35680:pf.fun=this._uniform_samplerCube;break;case 35676:pf.fun=this._uniformMatrix4fv;break;case 35670:pf.fun=this._uniform1i;break;case 35674:pf.fun=this._uinformMatrix2fv;break;case 35675:pf.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},pq._attribute=function(ph,pq){var pf=pd.mainContext,pg=pB._enableAtributes,p$=ph.location;return pg[p$]||pf.enableVertexAttribArray(p$),pf.vertexAttribPointer(p$,pq[0],pq[1],pq[2],pq[3],pq[4]),pg[p$]=pB._bindVertexBuffer,1},pq._uniform1f=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq?(pd.mainContext.uniform1f(ph.location,pf[0]=pq),1):0},pq._uniform1fv=function(ph,pq){if(pq.length<4){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pd.mainContext.uniform1fv(ph.location,pq),pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3],1):0}return pd.mainContext.uniform1fv(ph.location,pq),1},pq._uniform_vec2=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]?(pd.mainContext.uniform2f(ph.location,pf[0]=pq[0],pf[1]=pq[1]),1):0},pq._uniform_vec2v=function(ph,pq){if(pq.length<2){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pd.mainContext.uniform2fv(ph.location,pq),pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3],1):0}return pd.mainContext.uniform2fv(ph.location,pq),1},pq._uniform_vec3=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]?(pd.mainContext.uniform3f(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2]),1):0},pq._uniform_vec3v=function(ph,pq){return pd.mainContext.uniform3fv(ph.location,pq),1},pq._uniform_vec4=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pd.mainContext.uniform4f(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3]),1):0},pq._uniform_vec4v=function(ph,pq){return pd.mainContext.uniform4fv(ph.location,pq),1},pq._uniformMatrix2fv=function(ph,pq){return pd.mainContext.uniformMatrix2fv(ph.location,!1,pq),1},pq._uniformMatrix3fv=function(ph,pq){return pd.mainContext.uniformMatrix3fv(ph.location,!1,pq),1},pq._uniformMatrix4fv=function(ph,pq){return pd.mainContext.uniformMatrix4fv(ph.location,!1,pq),1},pq._uinformMatrix2fv=function(ph,pq){return pd.mainContext.uniformMatrix2fv(ph.location,!1,pq),1},pq._uinformMatrix3fv=function(ph,pq){return pd.mainContext.uniformMatrix3fv(ph.location,!1,pq),1},pq._uniform1i=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq?(pd.mainContext.uniform1i(ph.location,pf[0]=pq),1):0},pq._uniform1iv=function(ph,pq){return pd.mainContext.uniform1iv(ph.location,pq),1},pq._uniform_ivec2=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]?(pd.mainContext.uniform2i(ph.location,pf[0]=pq[0],pf[1]=pq[1]),1):0},pq._uniform_ivec2v=function(ph,pq){return pd.mainContext.uniform2iv(ph.location,pq),1},pq._uniform_vec3i=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]?(pd.mainContext.uniform3i(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2]),1):0},pq._uniform_vec3vi=function(ph,pq){return pd.mainContext.uniform3iv(ph.location,pq),1},pq._uniform_vec4i=function(ph,pq){var pf=ph.uploadedValue;return pf[0]!==pq[0]||pf[1]!==pq[1]||pf[2]!==pq[2]||pf[3]!==pq[3]?(pd.mainContext.uniform4i(ph.location,pf[0]=pq[0],pf[1]=pq[1],pf[2]=pq[2],pf[3]=pq[3]),1):0},pq._uniform_vec4vi=function(ph,pq){return pd.mainContext.uniform4iv(ph.location,pq),1},pq._uniform_sampler2D=function(ph,pq){var pf=pq.source||pq.defaulteTexture.source,pg=pd.mainContext,p$=ph.uploadedValue;if(null!=p$[0])return pg.activeTexture(pC._TEXTURES[p$[0]]),pf&&pb.bindTexture(pg,3553,pf),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return p$[0]=this._curActTexIndex,pg.uniform1i(ph.location,this._curActTexIndex),pg.activeTexture(pC._TEXTURES[this._curActTexIndex]),pf&&pb.bindTexture(pg,3553,pf),this._curActTexIndex++,1},pq._uniform_samplerCube=function(ph,pq){var pf=pq.source||pq.defaulteTexture.source,pg=pd.mainContext,p$=ph.uploadedValue;if(null!=p$[0])return pg.activeTexture(pC._TEXTURES[p$[0]]),pf?pb.bindTexture(pg,34067,pf):pb.bindTexture(pg,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return p$[0]=this._curActTexIndex,pg.uniform1i(ph.location,this._curActTexIndex),pg.activeTexture(pC._TEXTURES[this._curActTexIndex]),pf?pb.bindTexture(pg,34067,pf):pb.bindTexture(pg,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},pq._noSetValue=function(ph){console.log("no....:"+ph.name)},pq.bind=function(){return pf.activeShader=this,(pf.bindShader=this).activeResource(),pb.UseProgram(this._program)},pq.uploadAttributes=function(ph,pq){for(var pf,pg,p$=0,pP=0,pS=this._attributeParamsMap.length;pP<pS;pP+=2)pg=this._attributeParamsMap[pP+1],null!=(pf=ph[this._attributeParamsMap[pP]])&&(pq&&pq[pg.name]&&pq[pg.name].bind(),p$+=pg.fun.call(this,pg,pf));pX.shaderCall+=p$},pq.uploadAttributesX=function(ph,pq){for(var pf,pg,p$=0,pP=0,pS=this._attributeParamsMap.length;pP<pS;pP+=2)pg=this._attributeParamsMap[pP+1],null!=(pf=ph[this._attributeParamsMap[pP]])&&(pq._bind(),p$+=pg.fun.call(this,pg,pf));pX.shaderCall+=p$},pq.uploadSceneUniforms=function(ph){for(var pq,pf,pg=0,p$=0,pP=this._sceneUniformParamsMap.length;p$<pP;p$+=2)pf=this._sceneUniformParamsMap[p$+1],null!=(pq=ph[this._sceneUniformParamsMap[p$]])&&(pg+=pf.fun.call(this,pf,pq));pX.shaderCall+=pg},pq.uploadCameraUniforms=function(ph){for(var pq,pf,pg=0,p$=0,pP=this._cameraUniformParamsMap.length;p$<pP;p$+=2)pf=this._cameraUniformParamsMap[p$+1],null!=(pq=ph[this._cameraUniformParamsMap[p$]])&&(pg+=pf.fun.call(this,pf,pq));pX.shaderCall+=pg},pq.uploadSpriteUniforms=function(ph){for(var pq,pf,pg=0,p$=0,pP=this._spriteUniformParamsMap.length;p$<pP;p$+=2)pf=this._spriteUniformParamsMap[p$+1],null!=(pq=ph[this._spriteUniformParamsMap[p$]])&&(pg+=pf.fun.call(this,pf,pq));pX.shaderCall+=pg},pq.uploadMaterialUniforms=function(ph){for(var pq,pf,pg=0,p$=0,pP=this._materialUniformParamsMap.length;p$<pP;p$+=2)pf=this._materialUniformParamsMap[p$+1],null!=(pq=ph[this._materialUniformParamsMap[p$]])&&(pg+=pf.fun.call(this,pf,pq));pX.shaderCall+=pg},pq.uploadRenderElementUniforms=function(ph){for(var pq,pf,pg=0,p$=0,pP=this._renderElementUniformParamsMap.length;p$<pP;p$+=2)pf=this._renderElementUniformParamsMap[p$+1],null!=(pq=ph[this._renderElementUniformParamsMap[p$]])&&(pg+=pf.fun.call(this,pf,pq));pX.shaderCall+=pg},pC.create=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){return new pC(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY)},pC.addInclude=function(ph,pq){pG.addInclude(ph,pq)},pC._createShader=function(ph,pq,pf){var pg=ph.createShader(pf);if(ph.shaderSource(pg,pq),ph.compileShader(pg),pXq.debugMode&&!ph.getShaderParameter(pg,35713))throw ph.getShaderInfoLog(pg);return pg},pC.PERIOD_RENDERELEMENT=0,pC.PERIOD_MATERIAL=1,pC.PERIOD_SPRITE=2,pC.PERIOD_CAMERA=3,pC.PERIOD_SCENE=4,pC._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],pC._count=0,pC._preCompile=!1,pC.extCompileFunc=null,pC.extCompileObj=null,pU(pC,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new pn}]),pC}(),pTq=function(pB){function pr(){this._transformUV=null,pr.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new pSq(.6,.6,.6)),this._setColor(10,new pSq(1,1,1)),this._setColor(11,new pBq(1,1,1,8)),this._setColor(12,new pSq(1,1,1)),this._setColor(7,new pBq(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new pBq(1,1,0,0)),this.renderMode=1}pv(pr,"laya.d3.core.material.StandardMaterial",pB);var ph=pr.prototype;return ph.disableLight=function(){this._addDisablePublicShaderDefine(pXq.SHADERDEFINE_POINTLIGHT|pXq.SHADERDEFINE_SPOTLIGHT|pXq.SHADERDEFINE_DIRECTIONLIGHT)},ph.disableFog=function(){this._addDisablePublicShaderDefine(pXq.SHADERDEFINE_FOG)},ph.onAsynLoaded=function(ph,pq,pf){var pg=pq[0];if(pg.version)pB.prototype.onAsynLoaded.call(this,ph,pq,pf);else{var p$=pq[1],pP=pg.props;for(var pS in pP)this[pS]=pP[pS];pr._parseStandardMaterial(p$,this,pg),this._endLoaded()}},ph.cloneTo=function(ph){pB.prototype.cloneTo.call(this,ph);var pq=ph;this._transformUV&&(pq._transformUV=this._transformUV.clone())},pL(0,ph,"ambientColor",function(){return this._getColor(9)},function(ph){this._setColor(9,ph)}),pL(0,ph,"ambientTexture",function(){return this._getTexture(5)},function(ph){ph?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,ph)}),pL(0,ph,"renderMode",null,function(ph){switch(ph){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(pr.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(ph)}),pL(0,ph,"reflectColor",function(){return this._getColor(12)},function(ph){this._setColor(12,ph)}),pL(0,ph,"tilingOffset",function(){return this._getColor(15)},function(ph){if(ph){var pq=ph.elements;1!=pq[0]||1!=pq[1]||0!=pq[2]||0!=pq[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,ph)}),pL(0,ph,"albedo",function(){return this._getColor(7)},function(ph){this._setColor(7,ph)}),pL(0,ph,"diffuseColor",function(){return this._getColor(10)},function(ph){this._setColor(10,ph)}),pL(0,ph,"albedoColor",function(){return this._getColor(7)},function(ph){this._setColor(7,ph)}),pL(0,ph,"specularColor",function(){return this._getColor(11)},function(ph){this._setColor(11,ph)}),pL(0,ph,"diffuseTexture",function(){return this._getTexture(1)},function(ph){ph?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,ph)}),pL(0,ph,"normalTexture",function(){return this._getTexture(2)},function(ph){ph?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,ph)}),pL(0,ph,"specularTexture",function(){return this._getTexture(3)},function(ph){ph?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,ph)}),pL(0,ph,"emissiveTexture",function(){return this._getTexture(4)},function(ph){ph?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,ph)}),pL(0,ph,"reflectTexture",function(){return this._getTexture(6)},function(ph){ph?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,ph)}),pL(0,ph,"transformUV",function(){return this._transformUV},function(ph){this._transformUV=ph,this._setMatrix4x4(13,ph.matrix),ph?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,ph.matrix.elements,0)}),pr.__init__=function(){pr.SHADERDEFINE_DIFFUSEMAP=pr.shaderDefines.registerDefine("DIFFUSEMAP"),pr.SHADERDEFINE_NORMALMAP=pr.shaderDefines.registerDefine("NORMALMAP"),pr.SHADERDEFINE_SPECULARMAP=pr.shaderDefines.registerDefine("SPECULARMAP"),pr.SHADERDEFINE_EMISSIVEMAP=pr.shaderDefines.registerDefine("EMISSIVEMAP"),pr.SHADERDEFINE_AMBIENTMAP=pr.shaderDefines.registerDefine("AMBIENTMAP"),pr.SHADERDEFINE_REFLECTMAP=pr.shaderDefines.registerDefine("REFLECTMAP"),pr.SHADERDEFINE_UVTRANSFORM=pr.shaderDefines.registerDefine("UVTRANSFORM"),pr.SHADERDEFINE_TILINGOFFSET=pr.shaderDefines.registerDefine("TILINGOFFSET"),pr.SHADERDEFINE_ADDTIVEFOG=pr.shaderDefines.registerDefine("ADDTIVEFOG")},pr.load=function(ph){return pE.loader.create(ph,null,null,pr)},pr._parseStandardMaterial=function(ph,pq,pf){var pg=pf.customProps,p$=pg.ambientColor;pq.ambientColor=new pSq(p$[0],p$[1],p$[2]);var pP=pg.diffuseColor;pq.diffuseColor=new pSq(pP[0],pP[1],pP[2]);var pS=pg.specularColor;pq.specularColor=new pBq(pS[0],pS[1],pS[2],pS[3]);var pB=pg.reflectColor;pq.reflectColor=new pSq(pB[0],pB[1],pB[2]);var pr=pg.albedoColor;pr&&(pq.albedo=new pBq(pr[0],pr[1],pr[2],pr[3]));var pY=pg.diffuseTexture.texture2D;pY&&(pq.diffuseTexture=p_.getRes(ph[pY]));var pC=pg.normalTexture.texture2D;pC&&(pq.normalTexture=p_.getRes(ph[pC]));var pU=pg.specularTexture.texture2D;pU&&(pq.specularTexture=p_.getRes(ph[pU]));var pu=pg.emissiveTexture.texture2D;pu&&(pq.emissiveTexture=p_.getRes(ph[pu]));var pv=pg.ambientTexture.texture2D;pv&&(pq.ambientTexture=p_.getRes(ph[pv]));var pL=pg.reflectTexture.texture2D;pL&&(pq.reflectTexture=p_.getRes(ph[pL]))},pr.RENDERMODE_OPAQUE=1,pr.RENDERMODE_OPAQUEDOUBLEFACE=2,pr.RENDERMODE_CUTOUT=3,pr.RENDERMODE_CUTOUTDOUBLEFACE=4,pr.RENDERMODE_TRANSPARENT=13,pr.RENDERMODE_TRANSPARENTDOUBLEFACE=14,pr.RENDERMODE_ADDTIVE=15,pr.RENDERMODE_ADDTIVEDOUBLEFACE=16,pr.RENDERMODE_DEPTHREAD_TRANSPARENT=5,pr.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,pr.RENDERMODE_DEPTHREAD_ADDTIVE=7,pr.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,pr.RENDERMODE_NONDEPTH_TRANSPARENT=9,pr.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,pr.RENDERMODE_NONDEPTH_ADDTIVE=11,pr.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,pr.SHADERDEFINE_DIFFUSEMAP=0,pr.SHADERDEFINE_NORMALMAP=0,pr.SHADERDEFINE_SPECULARMAP=0,pr.SHADERDEFINE_EMISSIVEMAP=0,pr.SHADERDEFINE_AMBIENTMAP=0,pr.SHADERDEFINE_REFLECTMAP=0,pr.SHADERDEFINE_UVTRANSFORM=0,pr.SHADERDEFINE_TILINGOFFSET=0,pr.SHADERDEFINE_ADDTIVEFOG=0,pr.DIFFUSETEXTURE=1,pr.NORMALTEXTURE=2,pr.SPECULARTEXTURE=3,pr.EMISSIVETEXTURE=4,pr.AMBIENTTEXTURE=5,pr.REFLECTTEXTURE=6,pr.ALBEDO=7,pr.UVANIAGE=8,pr.MATERIALAMBIENT=9,pr.MATERIALDIFFUSE=10,pr.MATERIALSPECULAR=11,pr.MATERIALREFLECT=12,pr.UVMATRIX=13,pr.UVAGE=14,pr.TILINGOFFSET=15,pU(pr,["defaultMaterial",function(){var ph=new pr;return ph.lock=!0,this.defaultMaterial=ph},"shaderDefines",function(){return this.shaderDefines=new pCq(pAq.shaderDefines)}]),pr}(pAq),pIq=function(ph){function pS(ph,pq,pf,pg,p$){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===pf&&(pf=35044),void 0===pg&&(pg=!1),pS.__super.call(this),this._indexType=ph,this._indexCount=pq,this._bufferUsage=pf,this._bufferType=34963,this._canRead=pg;var pP;if("ushort"==ph)this._indexTypeByteCount=2;else{if("ubyte"!=ph)throw new Error("unidentification index type.");this._indexTypeByteCount=1}pP=this._indexTypeByteCount*pq,this._byteLength=pP,this._bind(),pB._gl.bufferData(this._bufferType,pP,this._bufferUsage),this.uri=p$,pg?("ushort"==ph?this._buffer=new Uint16Array(pq):"ubyte"==ph&&(this._buffer=new Uint8Array(pq)),this.memorySize=2*pP):this.memorySize=pP}pv(pS,"laya.d3.graphics.IndexBuffer3D",ph);var pq=pS.prototype;return pq.setData=function(ph,pq,pf,pg){void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=4294967295);var p$=0;if("ushort"==this._indexType?(p$=2,0===pf&&4294967295===pg||(ph=new Uint16Array(ph.buffer,pf*p$,pg))):"ubyte"==this._indexType&&(p$=1,0===pf&&4294967295===pg||(ph=new Uint8Array(ph.buffer,pf*p$,pg))),this._bind(),pB._gl.bufferSubData(this._bufferType,pq*p$,ph),this._canRead)if(0!==pq||0!==pf||4294967295!==pg){var pP=this._buffer.length-pq;pP<pg&&(pg=pP);for(var pS=0;pS<pg;pS++)this._buffer[pq+pS]=ph[pS]}else this._buffer=ph},pq.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},pq.disposeResource=function(){ph.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},pL(0,pq,"indexType",function(){return this._indexType}),pL(0,pq,"indexTypeByteCount",function(){return this._indexTypeByteCount}),pL(0,pq,"indexCount",function(){return this._indexCount}),pL(0,pq,"canRead",function(){return this._canRead}),pS.INDEXTYPE_UBYTE="ubyte",pS.INDEXTYPE_USHORT="ushort",pS.create=function(ph,pq,pf,pg,p$){return void 0===pf&&(pf=35044),void 0===pg&&(pg=!1),new pS(ph,pq,pf,pg,p$)},pS}(pB),pwq=function(pP){function pS(ph,pq,pf,pg,p$){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===pg&&(pg=!1),pS.__super.call(this),this._vertexDeclaration=ph,this._vertexCount=pq,this._bufferUsage=pf,this._bufferType=34962,this._canRead=pg,this.uri=p$,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*pq,this._bind(),pB._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),pg&&(this._buffer=new Float32Array(this._byteLength/4))}pv(pS,"laya.d3.graphics.VertexBuffer3D",pP);var ph=pS.prototype;return ph.bindWithIndexBuffer=function(ph){ph&&ph._bind(),this._bind()},ph.setData=function(ph,pq,pf,pg){if(void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=4294967295),0===pf&&4294967295===pg||(ph=new Float32Array(ph.buffer,4*pf,pg)),this._bind(),pB._gl.bufferSubData(this._bufferType,4*pq,ph),this._canRead)if(0!==pq||0!==pf||4294967295!==pg){var p$=this._buffer.length-pq;p$<pg&&(pg=p$);for(var pP=0;pP<pg;pP++)this._buffer[pq+pP]=ph[pP]}else this._buffer=ph},ph.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},ph.disposeResource=function(){for(var ph=pd.mainContext,pq=this._vertexDeclaration.getVertexElements(),pf=pB._enableAtributes,pg=0,p$=pq.length;pg<p$;pg++)pf[pg]===this._glBuffer&&(ph.disableVertexAttribArray(pg),pf[pg]=null);pP.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},pL(0,ph,"vertexDeclaration",function(){return this._vertexDeclaration}),pL(0,ph,"vertexCount",function(){return this._vertexCount}),pL(0,ph,"canRead",function(){return this._canRead}),pS.create=function(ph,pq,pf,pg,p$){return void 0===pf&&(pf=35044),void 0===pg&&(pg=!1),new pS(ph,pq,pf,pg,p$)},pS}(pB),pkq=function(ph){function pG(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,pG.__super.call(this),this._type=3553}pv(pG,"laya.d3.resource.DataTexture2D",pdq);var pq=pG.prototype;return pq.genDebugMipmaps=function(){var ph=[];return ph.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),ph.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),ph.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),ph.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),ph.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),ph.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),ph.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),ph.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),ph.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),ph.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),ph},pq._onTextureLoaded=function(ph){},pq._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var ph=pd.mainContext,pq=this._source=ph.createTexture(),pf=this._width,pg=this._height,p$=pb.curBindTexTarget,pP=pb.curBindTexValue,pS=!1;if(pb.bindTexture(ph,this._type,pq),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var pB=0;ph.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var pr=0;pr<this._mipmaps.length;pr++){if(this._mipmaps[pr].byteLength!=pY*pC*4)throw"mipmap size error  level:"+pr;ph.texSubImage2D(this._type,0,pG.simLodRect[pB++],pG.simLodRect[pB++],pG.simLodRect[pB++],pG.simLodRect[pB++],6408,5121,new Uint8Array(this._mipmaps[pr]))}this.minFifter=9729,this.magFifter=9729}else{var pY=this._width,pC=this._height;for(pB=0,ph.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),pr=0;pr<this._mipmaps.length;pr++){if(this._mipmaps[pr].byteLength!=pY*pC*4)throw"mipmap size error  level:"+pr;ph.texImage2D(this._type,pr,6408,pY,pC,0,6408,5121,new Uint8Array(this._mipmaps[pr])),(pY/=2)<1&&(pY=1),(pC/=2)<1&&(pC=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&ph.pixelStorei(ph.UNPACK_ALIGNMENT,1),ph.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var pU=0,pu=!1,pv=!1;this._buffer.byteLength==4*pf*pg?(pU=6408,pu=!0):this._buffer.byteLength==3*pf*pg?(pU=6407,pv=!0):pU=this._format,pu||pv?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),pv&&ph.pixelStorei(ph.UNPACK_ALIGNMENT,1),ph.texImage2D(this._type,0,pU,pf,pg,0,pU,5121,this._buffer)):ph&&pU==ph.ALPHA?(ph.texImage2D(3553,0,pU,pf,pg,0,pU,ph.UNSIGNED_BYTE,this._buffer),pS=!0):0!=pU&&(ph.compressedTexImage2D(3553,0,pU,pf,pg,0,this._buffer),pS=!0)}var pL=this._minFifter,pe=this._magFifter,pl=0==this._wrapModeU?10497:33071,p_=0==this._wrapModeV?10497:33071,pN=pm.isPOT(pf,pg);pN?(this._mipmap||this._mipmaps?-1!==pL||(pL=9987):-1!==pL||(pL=9729),-1!==pe||(pe=9729),ph.texParameteri(this._type,10241,pL),ph.texParameteri(this._type,10240,pe),ph.texParameteri(this._type,10242,pl),ph.texParameteri(this._type,10243,p_),this._mipmap&&ph.generateMipmap(this._type)):(-1!==pL||(pL=9729),-1!==pe||(pe=9729),ph.texParameteri(this._type,10241,pL),ph.texParameteri(this._type,10240,pe),ph.texParameteri(this._type,10242,33071),ph.texParameteri(this._type,10243,33071)),p$&&pP&&pb.bindTexture(ph,p$,pP),this.memorySize=pS?this._buffer.length:pN?pf*pg*4*(1+1/3):pf*pg*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},pq.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},pq.onAsynLoaded=function(ph,pq,pf){var pg;pf&&(pg=pf[0].call(this,pq)),pg&&(this._width=pg.width,this._height=pg.height,this._buffer=pg.data),this._src=ph,this._size=new peq(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},pq.getPixels=function(){return new Uint8Array(this._buffer)},pq.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(pd.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},pL(0,pq,"src",function(){return this._src}),pG.create=function(ph,pq,pf,pg,p$,pP,pS){if(void 0===pg&&(pg=9729),void 0===p$&&(p$=9729),void 0===pP&&(pP=!0),!ph||ph.byteLength<pq*pf*4)throw"DataTexture2D create error";var pB=new pG;return pB.uri=pS,pB._buffer=ph,pB._width=pq,pB._height=pf,pB._mipmap=pP,pB._magFifter=pg,pB._minFifter=p$,pB._size=new peq(pB._width,pB._height),pB._conchTexture?alert("怎么给runtime传递datatexture数据"):pB.activeResource(),pB},pG.load=function(ph,pq,pf,pg,p$){if(void 0===pq&&(pq=0),void 0===pf&&(pf=0),void 0===pg&&(pg=9729),void 0===p$&&(p$=9729),"mipmaps"===pJ.getFileExtension(ph)){var pP=pE.loader.create(ph,null,null,pG,[function(ph){this._mipmaps=[];var pq=new Uint32Array(ph);this._width=pq[0];var pf=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,pf=1024),this._width!=pf)throw"现在只支持512x256的环境贴图。当前的是"+pq[0];this._height=pq[1];for(var pg=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,p$=this._height,pP=8;;){var pS=pg*p$*4;if(pP+pS>ph.byteLength)throw"load mipmaps data size error ";var pB=new Uint8Array(ph,pP,pS);if(this._mipmaps.push(pB),pP+=pS,1==pg&&1==p$)break;(pg/=2)<1&&(pg=1),(p$/=2)<1&&(p$=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){pP.simLodInfo=new Float32Array(40);for(var pS=0;pS<pP.simLodInfo.length;)pP.simLodInfo[pS]=(pG.simLodRect[pS]+.5)/1024,pS++,pP.simLodInfo[pS]=(pG.simLodRect[pS]+.5)/256,pS++,pP.simLodInfo[pS]=Math.max(pG.simLodRect[pS]-1,.1)/1024,pS++,pP.simLodInfo[pS]=Math.max(pG.simLodRect[pS]-1.5,.1)/256,pS++}return pP}if("number"==typeof pq)return pE.loader.create(ph,null,null,pG,[function(ph){return this._width=pq,this._height=pf,this._buffer=ph,null}]);if("function"==typeof pq)return pE.loader.create(ph,null,null,pG,[pq]);throw new Error("unknown params.")},pG.lodasatlas=!1,pU(pG,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),pG}(),pHq=function(ph){function pq(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,pq.__super.call(this)}pv(pq,"laya.d3.resource.models.PrimitiveMesh",pbq);var pf=pq.prototype;return pE.imps(pf,{"laya.d3.core.render.IRenderable":!0}),pf._getVertexBuffer=function(ph){return void 0===ph&&(ph=0),0===ph?this._vertexBuffer:null},pf._getVertexBuffers=function(){return null},pf._getIndexBuffer=function(){return this._indexBuffer},pf._getPositions=function(){var ph,pq=[],pf=this._vertexBuffer.vertexDeclaration.getVertexElements(),pg=0;for(pg=0;pg<pf.length;pg++){var p$=pf[pg];if("vector3"===p$.elementFormat&&0===p$.elementUsage){ph=p$;break}}var pP=this._vertexBuffer.getData();for(pg=0;pg<pP.length;pg+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var pS=pg+ph.offset/4,pB=new pSq(pP[pS+0],pP[pS+1],pP[pS+2]);pq.push(pB)}return pq},pf.getRenderElement=function(ph){return this},pf.getRenderElementsCount=function(){return 1},pf.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},pf._beforeRender=function(ph){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},pf._render=function(ph){pd.mainContext.drawElements(4,this._numberIndices,5123,0),pX.drawCall++,pX.trianglesFaces+=this._numberIndices/3},pL(0,pf,"_vertexBufferCount",function(){return 1}),pL(0,pf,"triangleCount",function(){return this._indexBuffer.indexCount/3}),pq}(),pDq=function(ph){function pq(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,pq.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}pv(pq,"laya.d3.resource.models.Mesh",pbq);var pf=pq.prototype;return pf._getPositions=function(){var ph,pq,pf,pg,p$,pP=[],pS=0,pB=0,pr=0;if(0!==this._vertexBuffers.length){var pY=this._vertexBuffers.length;for(pS=0;pS<pY;pS++){for(pf=(ph=this._vertexBuffers[pS]).vertexDeclaration.getVertexElements(),pB=0;pB<pf.length;pB++)if("vector3"===(pg=pf[pB]).elementFormat&&0===pg.elementUsage){pq=pg;break}for(p$=ph.getData(),pB=0;pB<p$.length;pB+=ph.vertexDeclaration.vertexStride/4)pr=pB+pq.offset/4,pP.push(new pSq(p$[pr+0],p$[pr+1],p$[pr+2]))}}else{var pC=this._subMeshes.length;for(pS=0;pS<pC;pS++){for(pf=(ph=this._subMeshes[pS]._getVertexBuffer()).vertexDeclaration.getVertexElements(),pB=0;pB<pf.length;pB++)if("vector3"===(pg=pf[pB]).elementFormat&&0===pg.elementUsage){pq=pg;break}for(p$=ph.getData(),pB=0;pB<p$.length;pB+=ph.vertexDeclaration.vertexStride/4)pr=pB+pq.offset/4,pP.push(new pSq(p$[pr+0],p$[pr+1],p$[pr+2]))}}return pP},pf._setSubMeshes=function(ph){this._subMeshes=ph,this._subMeshCount=ph.length;for(var pq=0;pq<this._subMeshCount;pq++)ph[pq]._indexInMesh=pq;this._positions=this._getPositions(),this._generateBoundingObject()},pf.onAsynLoaded=function(ph,pq,pf){var pg=pq[0],p$=pq[1];pQh.read(pg,this,this._materials,this._subMeshes,p$),this.completeCreate(),this._endLoaded()},pf.getSubMesh=function(ph){return this._subMeshes[ph]},pf.getSubMeshCount=function(){return this._subMeshes.length},pf.getRenderElementsCount=function(){return this._subMeshes.length},pf.getRenderElement=function(ph){return this._subMeshes[ph]},pf.disposeResource=function(){for(var ph=0;ph<this._subMeshes.length;ph++)this._subMeshes[ph].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},pL(0,pf,"materials",function(){return this._materials.slice()}),pL(0,pf,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),pq.load=function(ph){return pE.loader.create(ph,null,null,pq)},pq}(),psq=(function(ph){function pY(ph,pq,pf,pg,p$,pP,pS,pB,pr){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===pf&&(pf=6408),void 0===pg&&(pg=5121),void 0===p$&&(p$=33189),void 0===pP&&(pP=!1),void 0===pS&&(pS=!1),void 0===pB&&(pB=-1),void 0===pr&&(pr=-1),pY.__super.call(this),this._type=3553,this._width=ph,this._height=pq,this._size=new peq(ph,pq),this._surfaceFormat=pf,this._surfaceType=pg,this._depthStencilFormat=p$,pe.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=pP,this._repeat=pS,this._minFifter=pB,this._magFifter=pr,this.activeResource(),this._alreadyResolved=!0}pv(pY,"laya.d3.resource.RenderTexture",pdq);var pq=pY.prototype;pq.recreateResource=function(){var ph=pd.mainContext;this._frameBuffer=ph.createFramebuffer(),this._source=ph.createTexture();var pq=pb.curBindTexTarget,pf=pb.curBindTexValue;pb.bindTexture(ph,this._type,this._source),ph.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var pg=this._minFifter,p$=this._magFifter,pP=this._repeat?10497:33071;if(pm.isPOT(this._width,this._height)?(this._mipmap?-1!==pg||(pg=9987):-1!==pg||(pg=9729),-1!==p$||(p$=9729),ph.texParameteri(this._type,10241,pg),ph.texParameteri(this._type,10240,p$),ph.texParameteri(this._type,10242,pP),ph.texParameteri(this._type,10243,pP),this._mipmap&&ph.generateMipmap(this._type)):(-1!==pg||(pg=9729),-1!==p$||(p$=9729),ph.texParameteri(this._type,10241,pg),ph.texParameteri(this._type,10240,p$),ph.texParameteri(this._type,10242,33071),ph.texParameteri(this._type,10243,33071)),pq&&pf&&pb.bindTexture(ph,pq,pf),ph.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=ph.createRenderbuffer(),ph.bindRenderbuffer(36161,this._depthStencilBuffer),ph.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),ph.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:ph.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:ph.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:ph.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}ph.framebufferTexture2D(36160,36064,3553,this._source,0),ph.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},pq.start=function(){pd.mainContext.bindFramebuffer(36160,this.frameBuffer),(pY._currentRenderTarget=this)._alreadyResolved=!1},pq.end=function(){pd.mainContext.bindFramebuffer(36160,null),pY._currentRenderTarget=null,this._alreadyResolved=!0},pq.getData=function(ph,pq,pf,pg){var p$=pd.mainContext;if(p$.bindFramebuffer(36160,this._frameBuffer),!(36053===p$.checkFramebufferStatus(36160)))return p$.bindFramebuffer(36160,null),null;var pP=new Uint8Array(this._width*this._height*4);return p$.readPixels(ph,pq,pf,pg,this._surfaceFormat,this._surfaceType,pP),p$.bindFramebuffer(36160,null),pP},pq.disposeResource=function(){if(this._frameBuffer){var ph=pd.mainContext;ph.deleteTexture(this._source),ph.deleteFramebuffer(this._frameBuffer),ph.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},pL(0,pq,"surfaceFormat",function(){return this._surfaceFormat}),pL(0,pq,"surfaceType",function(){return this._surfaceType}),pL(0,pq,"depthStencilFormat",function(){return this._depthStencilFormat}),pL(0,pq,"source",function(){return this._alreadyResolved?pE.superGet(pdq,this,"source"):null}),pL(0,pq,"depthStencilBuffer",function(){return this._depthStencilBuffer}),pL(0,pq,"frameBuffer",function(){return this._frameBuffer}),pY._currentRenderTarget=null}(),function(ph){function pq(ph){this._color=null,this._pixels=null,pq.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new peq(this.width,this.height),this._color=ph,this._pixels=new Uint8Array([255*ph.x,255*ph.y,255*ph.z,255*ph.w]),this.uri="SolidColorTexture2D_"+this.id}pv(pq,"laya.d3.resource.SolidColorTexture2D",pdq);var pf=pq.prototype;return pf._createWebGlTexture=function(){var ph=pd.mainContext,pq=this._source=ph.createTexture(),pf=this._width,pg=this._height,p$=pb.curBindTexTarget,pP=pb.curBindTexValue;pb.bindTexture(ph,this._type,pq),ph.texImage2D(this._type,0,6408,pf,pg,0,6408,5121,this._pixels);var pS=this._minFifter,pB=this._magFifter,pr=this._repeat?10497:33071,pY=pm.isPOT(pf,pg);pY?(this._mipmap?-1!==pS||(pS=9987):-1!==pS||(pS=9729),-1!==pB||(pB=9729),ph.texParameteri(this._type,10241,pS),ph.texParameteri(this._type,10240,pB),ph.texParameteri(this._type,10242,pr),ph.texParameteri(this._type,10243,pr),this._mipmap&&ph.generateMipmap(this._type)):(-1!==pS||(pS=9729),-1!==pB||(pB=9729),ph.texParameteri(this._type,10241,pS),ph.texParameteri(this._type,10240,pB),ph.texParameteri(this._type,10242,33071),ph.texParameteri(this._type,10243,33071)),p$&&pP&&pb.bindTexture(ph,p$,pP),this.memorySize=pY?pf*pg*4*(1+1/3):pf*pg*4},pf.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},pf.disposeResource=function(){this._source&&(pd.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},pU(pq,["magentaTexture",function(){var ph=new pq(new pBq(1,0,1,1));return ph.lock=!0,this.magentaTexture=ph},"grayTexture",function(){var ph=new pq(new pBq(.5,.5,.5,1));return ph.lock=!0,this.grayTexture=ph}]),pq}()),pVq=function(ph){function p$(ph,pq,pf,pg){this._canRead=!1,this._image=null,this._pixels=null,void 0===ph&&(ph=!1),void 0===pq&&(pq=!0),void 0===pf&&(pf=6408),void 0===pg&&(pg=!0),p$.__super.call(this),this._type=3553,this._repeat=pq,this._canRead=ph,this._format=pf,this._mipmap=pg}pv(p$,"laya.d3.resource.Texture2D",pdq);var pq=p$.prototype;return pq._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var ph=pd.mainContext,pq=this._source=ph.createTexture(),pf=this._width,pg=this._height,p$=pb.curBindTexTarget,pP=pb.curBindTexValue;switch(pb.bindTexture(ph,this._type,pq),this._format){case 6407:case 6408:this._canRead?ph.texImage2D(this._type,0,this._format,pf,pg,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?ph.texImage2D(this._type,0,this._image._format,pf,pg,0,this._image._format,5121,this._image.atlasSource):ph.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case pd.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:ph.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var pS=this._minFifter,pB=this._magFifter,pr=this._repeat?10497:33071,pY=0==this._wrapModeU?10497:33071,pC=0==this._wrapModeV?10497:33071,pU=pm.isPOT(pf,pg);pU?(this._mipmap?-1!==pS||(pS=9987):-1!==pS||(pS=9729),-1!==pB||(pB=9729),ph.texParameteri(this._type,10241,pS),ph.texParameteri(this._type,10240,pB),ph.texParameteri(this._type,10242,pr),ph.texParameteri(this._type,10243,pr),ph.texParameteri(this._type,10242,pY),ph.texParameteri(this._type,10243,pC),this._mipmap&&ph.generateMipmap(this._type)):(-1!==pS||(pS=9729),-1!==pB||(pB=9729),ph.texParameteri(this._type,10241,pS),ph.texParameteri(this._type,10240,pB),ph.texParameteri(this._type,10242,33071),ph.texParameteri(this._type,10243,33071)),p$&&pP&&pb.bindTexture(ph,p$,pP),this._image.onload=null,this._image=null,this.memorySize=pU?pf*pg*4*(1+1/3):pf*pg*4},pq.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},pq.onAsynLoaded=function(ph,pq,pf){if(pf){var pg=pf[0];void 0!==pg&&(this._canRead=pg);var p$=pf[1];void 0!==p$&&(this._repeat=p$);var pP=pf[2];void 0!==pP&&(this._format=pP);var pS=pf[3];void 0!==pS&&(this._mipmap=pS);var pB=pf.wrapModeU;void 0!==pB&&(this._wrapModeU=pB);var pr=pf.wrapModeV;void 0!==pr&&(this._wrapModeV=pr)}switch(this._format){case 6407:case 6408:var pY=(this._image=pq).width,pC=pq.height;this._width=pY,this._height=pC,this._size=new peq(pY,pC),this._canRead&&(pe.isConchApp?pq instanceof pu.HTMLElement&&(this._pixels=new Uint8Array(pq.getImageData(0,0,pY,pC))):(pi.canvas.size(pY,pC),pi.canvas.clear(),pi.context.drawImage(pq,0,0,pY,pC),this._pixels=new Uint8Array(pi.context.getImageData(0,0,pY,pC).data.buffer)));break;case pd.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var pU=new pR(pq);pU.readUTFBytes(4),pU.readUTFBytes(2),pU.getInt16();pU.endian="bigEndian",this._width=pU.getInt16(),this._height=pU.getInt16(),this._size=new peq(this._width,this._height);pU.getInt16(),pU.getInt16();this._image=new Uint8Array(pq,pU.pos)}this.recreateResource(),this._endLoaded()},pq.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},pq.disposeResource=function(){this._source&&(pd.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},pL(0,pq,"_src",function(){return this.url}),pL(0,pq,"src",function(){return this.url}),p$.load=function(ph){return pE.loader.create(ph,null,null,p$)},p$}(),pKq=function(pq){function pf(ph,pq){pf.__super.call(this),void 0===ph&&(ph=.3),void 0===pq&&(pq=1e3),this._tempVector3=new pSq,this._position=new pSq,this._up=new pSq,this._forward=new pSq,this._right=new pSq,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=peq.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=ph,this._farPlane=pq,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),pE.stage.on("resize",this,this._onScreenSizeChanged)}pv(pf,"laya.d3.core.BaseCamera",pq);var ph=pf.prototype;return ph._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var ph=this.scene._cameraPool,pq=ph.length-1,pf=0;pf<pq;pf++)if(ph[pf].renderingOrder>ph[pq].renderingOrder){var pg=ph[pf];ph[pf]=ph[pq],ph[pq]=pg}},ph._calculateProjectionMatrix=function(){},ph._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},ph._prepareCameraToRender=function(){pz._currentCameraCullingMask=this.cullingMask;var ph=this._shaderValues;ph.setValue(0,this.transform.position.elements),ph.setValue(5,this.forward.elements),ph.setValue(6,this.up.elements)},ph._prepareCameraViewProject=function(ph,pq){var pf=this._shaderValues;pf.setValue(1,ph.elements),pf.setValue(2,pq.elements)},ph._renderCamera=function(ph,pq,pf){},ph.addLayer=function(ph){29!==ph.number&&30!=ph.number&&(this.cullingMask=this.cullingMask|ph.mask)},ph.removeLayer=function(ph){29!==ph.number&&30!=ph.number&&(this.cullingMask=this.cullingMask&~ph.mask)},ph.addAllLayers=function(){this.cullingMask=2147483647},ph.removeAllLayers=function(){this.cullingMask=0|pz.getLayerByNumber(29).mask|pz.getLayerByNumber(30).mask},ph.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},ph.moveForward=function(ph){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=ph,this.transform.translate(this._tempVector3)},ph.moveRight=function(ph){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=ph,this.transform.translate(this._tempVector3)},ph.moveVertical=function(ph){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=ph,this.transform.translate(this._tempVector3,!1)},ph._addSelfRenderObjects=function(){var ph=this.scene._cameraPool,pq=ph.length;if(0<pq){for(var pf=pq-1;0<=pf;pf--)if(this.renderingOrder<=ph[pf].renderingOrder){ph.splice(pf+1,0,this);break}}else ph.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},ph._clearSelfRenderObjects=function(){var ph=this.scene._cameraPool;ph.splice(ph.indexOf(this),1)},ph.destroy=function(ph){void 0===ph&&(ph=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,pE.stage.off("resize",this,this._onScreenSizeChanged),pq.prototype.destroy.call(this,ph)},pL(0,ph,"sky",function(){return this._sky},function(ph){(this._sky=ph)._ownerCamera=this}),pL(0,ph,"forward",function(){var ph=this.transform.worldMatrix.elements,pq=this._forward.elements;return pq[0]=-ph[8],pq[1]=-ph[9],pq[2]=-ph[10],this._forward}),pL(0,ph,"position",function(){var ph=this.transform.worldMatrix.elements,pq=this._position.elements;return pq[0]=ph[12],pq[1]=ph[13],pq[2]=ph[14],this._position}),pL(0,ph,"renderTarget",function(){return this._renderTarget},function(ph){null!=(this._renderTarget=ph)&&(this._renderTargetSize=ph.size)}),pL(0,ph,"up",function(){var ph=this.transform.worldMatrix.elements,pq=this._up.elements;return pq[0]=ph[4],pq[1]=ph[5],pq[2]=ph[6],this._up}),pL(0,ph,"right",function(){var ph=this.transform.worldMatrix.elements,pq=this._right.elements;return pq[0]=ph[0],pq[1]=ph[1],pq[2]=ph[2],this._right}),pL(0,ph,"renderTargetSize",function(){return this._renderTargetSize},function(ph){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=ph,this._calculateProjectionMatrix()}),pL(0,ph,"fieldOfView",function(){return this._fieldOfView},function(ph){this._fieldOfView=ph,this._calculateProjectionMatrix()}),pL(0,ph,"nearPlane",function(){return this._nearPlane},function(ph){this._nearPlane=ph,this._calculateProjectionMatrix()}),pL(0,ph,"farPlane",function(){return this._farPlane},function(ph){this._farPlane=ph,this._calculateProjectionMatrix()}),pL(0,ph,"orthographic",function(){return this._orthographic},function(ph){this._orthographic=ph,this._calculateProjectionMatrix()}),pL(0,ph,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(ph){this._orthographicVerticalSize=ph,this._calculateProjectionMatrix()}),pL(0,ph,"renderingOrder",function(){return this._renderingOrder},function(ph){this._renderingOrder=ph,this._sortCamerasByRenderingOrder()}),pf.CAMERAPOS=0,pf.VIEWMATRIX=1,pf.PROJECTMATRIX=2,pf.VPMATRIX=3,pf.VPMATRIX_NO_TRANSLATE=4,pf.CAMERADIRECTION=5,pf.CAMERAUP=6,pf.ENVIRONMENTDIFFUSE=7,pf.ENVIRONMENTSPECULAR=8,pf.SIMLODINFO=9,pf.DIFFUSEIRRADMATR=10,pf.DIFFUSEIRRADMATG=11,pf.DIFFUSEIRRADMATB=12,pf.HDREXPOSURE=13,pf.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",pf.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",pf.CLEARFLAG_SOLIDCOLOR=0,pf.CLEARFLAG_SKY=1,pf.CLEARFLAG_DEPTHONLY=2,pf.CLEARFLAG_NONE=3,pU(pf,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new phq(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new phq},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new phq}]),pf}(pMq),pyq=function(pf){function pq(ph){this._render=null,this._geometryFilter=null,pq.__super.call(this,ph)}pv(pq,"laya.d3.core.RenderableSprite3D",pf);var ph=pq.prototype;return ph._addToInitStaticBatchManager=function(){},ph._setBelongScene=function(ph){pf.prototype._setBelongScene.call(this,ph),ph._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},ph._setUnBelongScene=function(){var ph=this._scene._renderableSprite3Ds,pq=ph.indexOf(this);ph.splice(pq,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),pf.prototype._setUnBelongScene.call(this)},ph._update=function(ph){(ph.owner=this)._activeInHierarchy&&(this._updateComponents(ph),this._render._updateOctreeNode(),this._lateUpdateComponents(ph),pX.spriteCount++,this._childs.length&&this._updateChilds(ph))},ph.destroy=function(ph){void 0===ph&&(ph=!0),pf.prototype.destroy.call(this,ph),this._render._destroy(),this._render=null},pq.__init__=function(){pq.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=pq.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),pq.SAHDERDEFINE_LIGHTMAP=pq.shaderDefines.registerDefine("LIGHTMAP")},pq.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,pq.SAHDERDEFINE_LIGHTMAP=4,pq.LIGHTMAPSCALEOFFSET=2,pq.LIGHTMAP=3,pU(pq,["shaderDefines",function(){return this.shaderDefines=new pCq}]),pq}(pMq),pFq=(function(ph){function pg(ph,pq,pf){this._long=NaN,this._width=NaN,this._height=NaN,void 0===ph&&(ph=1),void 0===pq&&(pq=1),void 0===pf&&(pf=1),pg.__super.call(this),this._long=ph,this._width=pq,this._height=pf,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}pv(pg,"laya.d3.resource.models.BoxMesh",pHq);var pq=pg.prototype;pq.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var ph=pdh.vertexDeclaration,pq=(ph.vertexStride,this._long/2),pf=this._height/2,pg=this._width/2,p$=new Float32Array([-pq,pf,-pg,0,1,0,0,0,pq,pf,-pg,0,1,0,1,0,pq,pf,pg,0,1,0,1,1,-pq,pf,pg,0,1,0,0,1,-pq,-pf,-pg,0,-1,0,0,1,pq,-pf,-pg,0,-1,0,1,1,pq,-pf,pg,0,-1,0,1,0,-pq,-pf,pg,0,-1,0,0,0,-pq,pf,-pg,-1,0,0,0,0,-pq,pf,pg,-1,0,0,1,0,-pq,-pf,pg,-1,0,0,1,1,-pq,-pf,-pg,-1,0,0,0,1,pq,pf,-pg,1,0,0,1,0,pq,pf,pg,1,0,0,0,0,pq,-pf,pg,1,0,0,0,1,pq,-pf,-pg,1,0,0,1,1,-pq,pf,pg,0,0,1,0,0,pq,pf,pg,0,0,1,1,0,pq,-pf,pg,0,0,1,1,1,-pq,-pf,pg,0,0,1,0,1,-pq,pf,-pg,0,0,-1,1,0,pq,pf,-pg,0,0,-1,0,0,pq,-pf,-pg,0,0,-1,0,1,-pq,-pf,-pg,0,0,-1,1,1]),pP=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new pwq(ph,this._numberVertices,35044,!0),this._indexBuffer=new pIq("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(p$),this._indexBuffer.setData(pP),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},pL(0,pq,"long",function(){return this._long},function(ph){this._long!==ph&&(this._long=ph,this.releaseResource(),this.activeResource())}),pL(0,pq,"width",function(){return this._width},function(ph){this._width!==ph&&(this._width=ph,this.releaseResource(),this.activeResource())}),pL(0,pq,"height",function(){return this._height},function(ph){this._height!==ph&&(this._height=ph,this.releaseResource(),this.activeResource())})}(),function(ph){function pS(ph,pq,pf){void 0===ph&&(ph=0),void 0===pq&&(pq=.3),void 0===pf&&(pf=1e3),this._viewMatrix=new phq,this._projectionMatrix=new phq,this._projectionViewMatrix=new phq,this._viewport=new prq(0,0,0,0),this._normalizedViewport=new prq(0,0,1,1),this._aspectRatio=ph,this._boundFrustumUpdate=!0,this._boundFrustum=new pOh(phq.DEFAULT),pS.__super.call(this,pq,pf),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}pv(pS,"laya.d3.core.Camera",pKq);var pq=pS.prototype;return pq._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},pq._parseCustomProps=function(ph,pq,pf,pg){var p$=pf.clearColor;this.clearColor=new pBq(p$[0],p$[1],p$[2],p$[3]);var pP=pf.viewport;this.normalizedViewport=new prq(pP[0],pP[1],pP[2],pP[3])},pq._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var ph=this.orthographicVerticalSize*this.aspectRatio*.5,pq=.5*this.orthographicVerticalSize;phq.createOrthoOffCenterRH(-ph,ph,-pq,pq,this.nearPlane,this.farPlane,this._projectionMatrix)}else phq.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},pq._update=function(ph){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,ph)},pq._renderCamera=function(ph,pq,pf){var pg,p$;pf.parallelSplitShadowMaps[0]&&pf._renderShadowMap(ph,pq,this),(pq.camera=this)._prepareCameraToRender(),pf._preRenderUpdateComponents(pq),pg=pq._viewMatrix=this.viewMatrix;var pP=this._renderTarget;pP?(pP.start(),phq.multiply(pKq._invertYScaleMatrix,this._projectionMatrix,pKq._invertYProjectionMatrix),phq.multiply(pKq._invertYScaleMatrix,this.projectionViewMatrix,pKq._invertYProjectionViewMatrix),p$=pq._projectionMatrix=pKq._invertYProjectionMatrix,pq._projectionViewMatrix=pKq._invertYProjectionViewMatrix):(p$=pq._projectionMatrix=this._projectionMatrix,pq._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(pg,p$),pq._viewport=this.viewport,pf._preRenderScene(ph,pq,this.boundFrustum),pf._clear(ph,pq),pf._renderScene(ph,pq),pf._postRenderUpdateComponents(pq),pP&&pP.end()},pq.viewportPointToRay=function(ph,pq){pLq.calculateCursorRay(ph,this.viewport,this._projectionMatrix,this.viewMatrix,null,pq)},pq.normalizedViewportPointToRay=function(ph,pq){var pf=pS._tempVector20,pg=this.viewport,p$=ph.elements,pP=pf.elements;pP[0]=p$[0]*pg.width,pP[1]=p$[1]*pg.height,pLq.calculateCursorRay(pf,this.viewport,this._projectionMatrix,this.viewMatrix,null,pq)},pq.worldToViewportPoint=function(ph,pq){phq.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(ph,this._projectionViewMatrix,pq);var pf=pq.elements;pf[0]=pf[0]/pE.stage.clientScaleX,pf[1]=pf[1]/pE.stage.clientScaleY},pq.worldToNormalizedViewportPoint=function(ph,pq){phq.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(ph,this._projectionViewMatrix,pq);var pf=pq.elements;pf[0]=pf[0]/pE.stage.clientScaleX,pf[1]=pf[1]/pE.stage.clientScaleY},pq.convertScreenCoordToOrthographicCoord=function(ph,pq){if(this._orthographic){var pf=pQ.clientWidth,pg=pQ.clientHeight,p$=this.orthographicVerticalSize*this.aspectRatio/pf,pP=this.orthographicVerticalSize/pg,pS=ph.elements,pB=pq.elements;return pB[0]=(-pf/2+pS[0])*p$,pB[1]=(pg/2-pS[1])*pP,pB[2]=(this.nearPlane-this.farPlane)*(pS[2]+1)/2-this.nearPlane,pSq.transformCoordinate(pq,this.transform.worldMatrix,pq),!0}return!1},pL(0,pq,"projectionViewMatrix",function(){return phq.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),pL(0,pq,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var ph=this.viewport;return ph.width/ph.height},function(ph){if(ph<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=ph,this._calculateProjectionMatrix()}),pL(0,pq,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),pL(0,pq,"needViewport",function(){var ph=this.normalizedViewport;return 0===ph.x&&0===ph.y&&1===ph.width&&1===ph.height}),pL(0,pq,"viewport",function(){if(this._viewportExpressedInClipSpace){var ph=this._normalizedViewport,pq=this.renderTargetSize,pf=pq.width,pg=pq.height;this._viewport.x=ph.x*pf,this._viewport.y=ph.y*pg,this._viewport.width=ph.width*pf,this._viewport.height=ph.height*pg}return this._viewport},function(ph){if(null!=this.renderTarget&&(ph.x<0||ph.y<0||0==ph.width||0==ph.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=ph,this._calculateProjectionMatrix()}),pL(0,pq,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var ph=this._viewport,pq=this.renderTargetSize,pf=pq.width,pg=pq.height;this._normalizedViewport.x=ph.x/pf,this._normalizedViewport.y=ph.y/pg,this._normalizedViewport.width=ph.width/pf,this._normalizedViewport.height=ph.height/pg}return this._normalizedViewport},function(ph){ph.x<0&&(ph.x=0,console.warn("Camera: viewport.x must large than 0.0.")),ph.y<0&&(ph.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<ph.x+ph.width&&(ph.width=1-ph.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<ph.y+ph.height&&(ph.height=1-ph.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=ph,this._calculateProjectionMatrix()}),pL(0,pq,"projectionMatrix",function(){return this._projectionMatrix},function(ph){this._projectionMatrix=ph,this._useUserProjectionMatrix=!0}),pL(0,pq,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),pU(pS,["_tempVector20",function(){return this._tempVector20=new pPq}]),pS}()),pZq=function(pf){function pg(ph,pq){pg.__super.call(this,pq),this._geometryFilter=new piq(this),this._render=new pzq(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),ph&&(this._geometryFilter.sharedMesh=ph)instanceof laya.d3.resource.models.Mesh&&(ph.loaded?this._render.sharedMaterials=ph.materials:ph.once("loaded",this,this._applyMeshMaterials))}pv(pg,"laya.d3.core.MeshSprite3D",pf);var ph=pg.prototype;return ph._changeRenderObjectByMesh=function(ph){var pq=this._render._renderElements,pf=pq[ph];pf||(pf=pq[ph]=new ptq),pf._render=this._render;var pg=this._render.sharedMaterials[ph];pg||(pg=pTq.defaultMaterial);var p$=this._geometryFilter.sharedMesh.getRenderElement(ph);return pf._mainSortID=this._getSortID(p$,pg),pf._sprite3D=this,pf.renderObj=p$,pf._material=pg,pf},ph._changeRenderObjectByMaterial=function(ph,pq){var pf=this._render._renderElements[ph];pq||(pq=pTq.defaultMaterial);var pg=this._geometryFilter.sharedMesh.getRenderElement(ph);return pf._mainSortID=this._getSortID(pg,pq),pf._sprite3D=this,pf.renderObj=pg,pf._material=pq,pf},ph._changeRenderObjectsByMesh=function(){var ph=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=ph;for(var pq=0;pq<ph;pq++)this._changeRenderObjectByMesh(pq)},ph._onMeshChanged=function(ph){var pq=ph.sharedMesh;pq.loaded?this._changeRenderObjectsByMesh():pq.once("loaded",this,this._onMeshLoaded)},ph._onMeshLoaded=function(ph){ph===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},ph._onMaterialChanged=function(ph,pq,pf){pq<this._render._renderElements.length&&this._changeRenderObjectByMaterial(pq,pf)},ph._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},ph._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},ph._parseCustomProps=function(ph,pq,pf,pg){var p$=this.meshRender,pP=pf.lightmapIndex;null!=pP&&(p$.lightmapIndex=pP);var pS,pB,pr=pf.lightmapScaleOffset;if(pr&&(p$.lightmapScaleOffset=new pBq(pr[0],pr[1],pr[2],pr[3])),pg.instanceParams)(pS=pg.instanceParams.loadPath)&&(pB=p_.getRes(pq[pS]),(this.meshFilter.sharedMesh=pB).loaded?p$.sharedMaterials=pB.materials:pB.once("loaded",this,this._applyMeshMaterials));else{(pS=pf.meshPath)&&(pB=p_.getRes(pq[pS]),this.meshFilter.sharedMesh=pB);var pY=pf.materials;if(pY){var pC=p$.sharedMaterials,pU=pY.length;pC.length=pU;for(var pu=0;pu<pU;pu++)pC[pu]=p_.getRes(pq[pY[pu].path]);p$.sharedMaterials=pC}}},ph._applyMeshMaterials=function(ph){for(var pq=this._render.sharedMaterials,pf=ph.materials,pg=0,p$=pf.length;pg<p$;pg++)pq[pg]||(pq[pg]=pf[pg]);this._render.sharedMaterials=pq},ph._addToInitStaticBatchManager=function(){pg._staticBatchManager._addInitBatchSprite(this)},ph.cloneTo=function(ph){var pq=ph;pq._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var pf=this._render,pg=pq._render;pg.enable=pf.enable,pg.sharedMaterials=pf.sharedMaterials,pg.castShadow=pf.castShadow;var p$=pf.lightmapScaleOffset;p$&&(pg.lightmapScaleOffset=p$.clone()),pg.lightmapIndex=pf.lightmapIndex,pg.receiveShadow=pf.receiveShadow,pg.sortingFudge=pf.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,ph)},ph.destroy=function(ph){if(void 0===ph&&(ph=!0),!this.destroyed){var pq=this.meshFilter.sharedMesh;null!=pq&&(pq.loaded||pq.off("loaded",this,this._applyMeshMaterials)),pf.prototype.destroy.call(this,ph),this._geometryFilter._destroy()}},pL(0,ph,"meshFilter",function(){return this._geometryFilter}),pL(0,ph,"meshRender",function(){return this._render}),pg.__init__=function(){pgh._staticBatchManagers.push(pg._staticBatchManager)},pg.load=function(ph){return pE.loader.create(ph,null,null,pg)},pU(pg,["_staticBatchManager",function(){return this._staticBatchManager=new pnq}]),pg}(pyq)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ph,pq){"use strict";for(var pf in Object.defineProperty(pq,"__esModule",{value:!0}),Laya){var pg=Laya[pf];pg&&pg.__isclass&&(pq[pf]=pg)}}),function(ph,pq,p$h){p$h.un,p$h.uns;var pf=p$h.static,pg=p$h.class,pP=p$h.getset,pe=p$h.__newvec,pB=laya.maths.Bezier,pU=laya.utils.Browser,pdh=laya.utils.Byte,p$=(laya.events.Event,laya.events.EventDispatcher),pS=laya.display.Graphics,pr=(laya.resource.HTMLCanvas,laya.utils.Handler),pY=laya.net.Loader,pu=laya.maths.MathUtil,pbh=laya.maths.Matrix,pl=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),pC=(laya.renders.RenderContext,laya.resource.Resource),pv=laya.utils.RunDriver,pPh=laya.display.Sprite,pL=laya.utils.Stat,pih=laya.resource.Texture,p_=(laya.net.URL,laya.utils.Utils),pb=function(){function ph(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return pg(ph,"laya.ani.AnimationContent"),ph}(),pi=function(){function ph(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return pg(ph,"laya.ani.AnimationNodeContent"),ph}(),pG=function(){function ph(){}return pg(ph,"laya.ani.AnimationParser01"),ph.parse=function(ph,pq){var pf=pq.__getBuffer(),pg=0,p$=0,pP=0,pS=0,pB=0,pr=0,pY=0,pC=pq.readUTFString();ph._aniClassName=pC;var pU,pu=pq.readUTFString().split("\n"),pv=pq.getUint8(),pL=pq.getUint32(),pe=pq.getUint32();0<pL&&(pU=pf.slice(pL,pe));var pl=new pdh(pU);for(0<pe&&(ph._publicExtData=pf.slice(pe,pf.byteLength)),ph._useParent=!!pq.getUint8(),ph._anis.length=pv,pg=0;pg<pv;pg++){var p_=ph._anis[pg]=new pb;p_.nodes=new Array;var pN=p_.name=pu[pq.getUint16()];ph._aniMap[pN]=pg,p_.bone3DMap={},p_.playTime=pq.getFloat32(),p_.playTime<=0&&console.error("播放时间不能为0  url="+ph.url+" name="+p_.name);var pG=p_.nodes.length=pq.getUint8();for(p$=p_.totalKeyframeDatasLength=0;p$<pG;p$++){var pm=p_.nodes[p$]=new pi;pm.childs=[];var pE=pq.getInt16();0<=pE&&(pm.name=pu[pE],p_.bone3DMap[pm.name]=p$),pm.keyFrame=new Array,pm.parentIndex=pq.getInt16(),-1==pm.parentIndex?pm.parent=null:pm.parent=p_.nodes[pm.parentIndex],pm.lerpType=pq.getUint8();var pR=pq.getUint32();pl.pos=pR;var pt=pm.keyframeWidth=pl.getUint16();if(p_.totalKeyframeDatasLength+=pt,0===pm.lerpType||1===pm.lerpType)for(pm.interpolationMethod=[],pm.interpolationMethod.length=pt,pP=0;pP<pt;pP++)pm.interpolationMethod[pP]=pM.interpolation[pl.getUint8()];null!=pm.parent&&pm.parent.childs.push(pm);var pX=pq.getUint16();0<pX&&(pm.extenData=pf.slice(pq.pos,pq.pos+pX),pq.pos+=pX);var pn,pJ=pq.getUint16(),pp=0;for(pP=0,pS=pm.keyFrame.length=pJ;pP<pS;pP++){if((pn=pm.keyFrame[pP]=new pz).duration=pq.getFloat32(),pn.startTime=pp,2===pm.lerpType){pn.interpolationData=[];var pA,pd=pq.getUint8();switch(pA=pq.getFloat32()){case 254:for(pn.interpolationData.length=pt,pY=0;pY<pt;pY++)pn.interpolationData[pY]=0;break;case 255:for(pn.interpolationData.length=pt,pY=0;pY<pt;pY++)pn.interpolationData[pY]=5;break;default:for(pn.interpolationData.push(pA),pr=1;pr<pd;pr++)pn.interpolationData.push(pq.getFloat32())}}for(pn.data=new Float32Array(pt),pB=0;pB<pt;pB++)pn.data[pB]=pq.getFloat32(),-1e-8<pn.data[pB]&&pn.data[pB]<1e-8&&(pn.data[pB]=0);pp+=pn.duration}pn.startTime=p_.playTime,pm.playTime=p_.playTime,ph._calculateKeyFrame(pm,pJ,pt)}}},ph}(),pm=function(){function pE(){}return pg(pE,"laya.ani.AnimationParser02"),pE.READ_DATA=function(){pE._DATA.offset=pE._reader.getUint32(),pE._DATA.size=pE._reader.getUint32()},pE.READ_BLOCK=function(){for(var ph=pE._BLOCK.count=pE._reader.getUint16(),pq=pE._BLOCK.blockStarts=[],pf=pE._BLOCK.blockLengths=[],pg=0;pg<ph;pg++)pq.push(pE._reader.getUint32()),pf.push(pE._reader.getUint32())},pE.READ_STRINGS=function(){var ph=pE._reader.getUint32(),pq=pE._reader.getUint16(),pf=pE._reader.pos;pE._reader.pos=ph+pE._DATA.offset;for(var pg=0;pg<pq;pg++)pE._strings[pg]=pE._reader.readUTFString();pE._reader.pos=pf},pE.parse=function(ph,pq){pE._templet=ph;(pE._reader=pq).__getBuffer();pE.READ_DATA(),pE.READ_BLOCK(),pE.READ_STRINGS();for(var pf=0,pg=pE._BLOCK.count;pf<pg;pf++){var p$=pq.getUint16(),pP=pE._strings[p$],pS=pE["READ_"+pP];if(null==pS)throw new Error("model file err,no this function:"+p$+" "+pP);pS.call()}},pE.READ_ANIMATIONS=function(){var ph=pE._reader,pq=ph.__getBuffer(),pf=0,pg=0,p$=0,pP=0,pS=ph.getUint16(),pB=[];for(pB.length=pS,pf=0;pf<pS;pf++)pB[pf]=pM.interpolation[ph.getByte()];var pr=ph.getUint8();for(pE._templet._anis.length=pr,pf=0;pf<pr;pf++){var pY=pE._templet._anis[pf]={};pY.nodes=new Array;var pC=pY.name=pE._strings[ph.getUint16()];pE._templet._aniMap[pC]=pf,pY.bone3DMap={},pY.playTime=ph.getFloat32();var pU=pY.nodes.length=ph.getInt16();for(pg=pY.totalKeyframeDatasLength=0;pg<pU;pg++){var pu=pY.nodes[pg]={};pu.keyframeWidth=pS,pu.childs=[];var pv=ph.getUint16();0<=pv&&(pu.name=pE._strings[pv],pY.bone3DMap[pu.name]=pg),pu.keyFrame=new Array,pu.parentIndex=ph.getInt16(),-1==pu.parentIndex?pu.parent=null:pu.parent=pY.nodes[pu.parentIndex],pY.totalKeyframeDatasLength+=pS,pu.interpolationMethod=pB,null!=pu.parent&&pu.parent.childs.push(pu);var pL=ph.getUint16(),pe=null,pl=null;for(p$=0,pP=pu.keyFrame.length=pL;p$<pP;p$++){(pe=pu.keyFrame[p$]={}).startTime=ph.getFloat32(),pl&&(pl.duration=pe.startTime-pl.startTime);var p_=pE._DATA.offset,pN=ph.getUint32(),pG=4*pS,pm=pq.slice(p_+pN,p_+pN+pG);pe.data=new Float32Array(pm),pl=pe}pe.duration=0,pu.playTime=pY.playTime,pE._templet._calculateKeyFrame(pu,pL,pS)}}},pE._templet=null,pE._reader=null,pE._strings=[],pf(pE,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),pE}(),pzh=(function(){function ph(){}pg(ph,"laya.ani.AnimationState"),ph.stopped=0,ph.paused=1,ph.playing=2}(),function(){function p$(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new pyh,this.resultMatrix=new pbh,this._children=[]}pg(p$,"laya.ani.bone.Bone");var ph=p$.prototype;return ph.setTempMatrix=function(ph){this._tempMatrix=ph;var pq,pf=0;for(pf=0,pq=this._children.length;pf<pq;pf++)this._children[pf].setTempMatrix(this._tempMatrix)},ph.update=function(ph){var pq;if(this.rotation=this.transform.skX,ph)pq=this.resultTransform.getMatrix(),pbh.mul(pq,ph,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)pq=this.resultTransform.getMatrix(),pbh.mul(pq,this.parentBone.resultMatrix,this.resultMatrix);else{var pf=this.parentBone,pg=NaN,p$=NaN,pP=NaN,pS=this.parentBone.resultMatrix;pq=this.resultTransform.getMatrix();var pB=pS.a*pq.tx+pS.c*pq.ty+pS.tx,pr=pS.b*pq.tx+pS.d*pq.ty+pS.ty,pY=new pbh;this.inheritRotation?(pg=Math.atan2(pf.resultMatrix.b,pf.resultMatrix.a),p$=Math.cos(pg),pP=Math.sin(pg),pY.setTo(p$,pP,-pP,p$,0,0),pbh.mul(this._tempMatrix,pY,pbh.TEMP),pbh.TEMP.copyTo(pY),pq=this.resultTransform.getMatrix(),pbh.mul(pq,pY,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,pq=this.resultTransform.getMatrix(),pbh.TEMP.identity(),pbh.TEMP.d=this.d,pbh.mul(pq,pbh.TEMP,this.resultMatrix)),this.resultMatrix.tx=pB,this.resultMatrix.ty=pr}else(pq=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var pC,pU=0;for(pU=0,pC=this._children.length;pU<pC;pU++)this._children[pU].update()},ph.updateChild=function(){var ph,pq=0;for(pq=0,ph=this._children.length;pq<ph;pq++)this._children[pq].update()},ph.setRotation=function(ph){this._sprite&&(this._sprite.rotation=180*ph/Math.PI)},ph.updateDraw=function(ph,pq){p$.ShowBones&&!p$.ShowBones[this.name]||(this._sprite||(this._sprite=new pPh,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),p$h.stage.addChild(this._sprite)),this._sprite.x=ph+this.resultMatrix.tx,this._sprite.y=pq+this.resultMatrix.ty);var pf,pg=0;for(pg=0,pf=this._children.length;pg<pf;pg++)this._children[pg].updateDraw(ph,pq)},ph.addChild=function(ph){this._children.push(ph),ph.parentBone=this},ph.findBone=function(ph){if(this.name==ph)return this;var pq,pf,pg=0;for(pg=0,pq=this._children.length;pg<pq;pg++)if(pf=this._children[pg].findBone(ph))return pf;return null},ph.localToWorld=function(ph){var pq=ph[0],pf=ph[1];ph[0]=pq*this.resultMatrix.a+pf*this.resultMatrix.c+this.resultMatrix.tx,ph[1]=pq*this.resultMatrix.b+pf*this.resultMatrix.d+this.resultMatrix.ty},p$.ShowBones={},p$}()),pch=function(){function pe(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}pg(pe,"laya.ani.bone.BoneSlot");var ph=pe.prototype;return ph.showSlotData=function(ph,pq){void 0===pq&&(pq=!0),this.currSlotData=ph,pq&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},ph.showDisplayByName=function(ph){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(ph))},ph.replaceDisplayByName=function(ph,pq){if(this.currSlotData){var pf;pf=this.currSlotData.getDisplayByName(ph);var pg;pg=this.currSlotData.getDisplayByName(pq),this.replaceDisplayByIndex(pf,pg)}},ph.replaceDisplayByIndex=function(ph,pq){this.currSlotData&&(this._replaceDic[ph]=pq,this.displayIndex==ph&&this.showDisplayByIndex(ph))},ph.showDisplayByIndex=function(ph){if(null!=this._replaceDic[ph]&&(ph=this._replaceDic[ph]),this.currSlotData&&-1<ph&&ph<this.currSlotData.displayArr.length){if(this.displayIndex=ph,this.currDisplayData=this.currSlotData.displayArr[ph],this.currDisplayData){var pq=this.currDisplayData.name;this.currTexture=this.templet.getTexture(pq),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!pl.isConchApp||pl.isConchApp&&"0.9.15"<pPh.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},ph.replaceSkin=function(ph){this._diyTexture=ph,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},ph.setParentMatrix=function(ph){this._parentMatrix=ph},ph.draw=function(ph,pq,pf,pg){if(void 0===pf&&(pf=!1),void 0===pg&&(pg=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var p$,pP=this.currTexture;switch(this._diyTexture&&(pP=this._diyTexture),this.currDisplayData.type){case 0:if(ph){var pS=this.getDisplayMatrix();if(this._parentMatrix){var pB=!1;if(pS){var pr;if(pbh.mul(pS,this._parentMatrix,pbh.TEMP),pr=pf?(null==this._resultMatrix&&(this._resultMatrix=new pbh),this._resultMatrix):new pbh,!pl.isWebGL&&this.currDisplayData.uvs||pl.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var pY=pe._tempMatrix;pY.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(pY.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(pB=!0,pY.rotate(-Math.PI/2)),pbh.mul(pY,pbh.TEMP,pr)}else pbh.TEMP.copyTo(pr);pB?ph.drawTexture(pP,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,pr):ph.drawTexture(pP,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,pr)}}}break;case 1:if(null==(p$=pf?(null==this._skinSprite&&(this._skinSprite=pe.createSkinMesh()),this._skinSprite):pe.createSkinMesh()))return;var pC;if(null==this.currDisplayData.bones){var pU,pu=this.currDisplayData.weights;this.deformData&&(pu=this.deformData),pU=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=pt.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=pt.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=pu;this.currDisplayData.triangles.length;pC=this.currDisplayData.triangles,p$.init2(pP,null,pC,this._mVerticleArr,pU);var pv,pL=this.getDisplayMatrix();if(this._parentMatrix)if(pL)pbh.mul(pL,this._parentMatrix,pbh.TEMP),pv=pf?(null==this._resultMatrix&&(this._resultMatrix=new pbh),this._resultMatrix):new pbh,pbh.TEMP.copyTo(pv),p$.transform=pv}else this.skinMesh(pq,p$,pg);ph.drawSkin(p$);break;case 2:if(null==(p$=pf?(null==this._skinSprite&&(this._skinSprite=pe.createSkinMesh()),this._skinSprite):pe.createSkinMesh()))return;this.skinMesh(pq,p$,pg),ph.drawSkin(p$)}}},ph.skinMesh=function(ph,pq,pf){var pg,p$=this.currTexture,pP=this.currDisplayData.bones;pg=this._diyTexture?(p$=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=pt.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=pt.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var pS,pB,pr=this.currDisplayData.weights,pY=this.currDisplayData.triangles,pC=0,pU=0,pu=0,pv=NaN,pL=NaN,pe=0,pl=0,p_=[],pN=0,pG=0;if(this.deformData&&0<this.deformData.length){var pm=0;for(pN=0,pG=pP.length;pN<pG;){for(pu=pP[pN++]+pN,pU=pC=0;pN<pu;pN++)pB=ph[pP[pN]],pv=pr[pe]+this.deformData[pm++],pL=pr[pe+1]+this.deformData[pm++],pl=pr[pe+2],pC+=(pv*pB.a+pL*pB.c+pB.tx)*pl,pU+=(pv*pB.b+pL*pB.d+pB.ty)*pl,pe+=3;p_.push(pC,pU)}}else for(pN=0,pG=pP.length;pN<pG;){for(pu=pP[pN++]+pN,pU=pC=0;pN<pu;pN++)pB=ph[pP[pN]],pv=pr[pe],pL=pr[pe+1],pl=pr[pe+2],pC+=(pv*pB.a+pL*pB.c+pB.tx)*pl,pU+=(pv*pB.b+pL*pB.d+pB.ty)*pl,pe+=3;p_.push(pC,pU)}this._mVerticleArr=p_,pS=pY,pq.init2(p$,null,pS,this._mVerticleArr,pg)},ph.drawBonePoint=function(ph){ph&&this._parentMatrix&&ph.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},ph.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},ph.getMatrix=function(){return this._resultMatrix},ph.copy=function(){var ph=new pe;return ph.type="copy",ph.name=this.name,ph.attachmentName=this.attachmentName,ph.srcDisplayIndex=this.srcDisplayIndex,ph.parent=this.parent,ph.displayIndex=this.displayIndex,ph.templet=this.templet,ph.currSlotData=this.currSlotData,ph.currTexture=this.currTexture,ph.currDisplayData=this.currDisplayData,ph},pe.createSkinMesh=function(){return pl.isWebGL||pl.isConchApp?pv.skinAniSprite():(pl.isWebGL,null)},pf(pe,["_tempMatrix",function(){return this._tempMatrix=new pbh}]),pe}(),pMh=function(){function ph(){this.skinName=null,this.deformSlotDataList=[]}return pg(ph,"laya.ani.bone.DeformAniData"),ph}(),pWh=function(){function ph(){this.deformSlotDisplayList=[]}return pg(ph,"laya.ani.bone.DeformSlotData"),ph}(),pTh=function(){function ph(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}pg(ph,"laya.ani.bone.DeformSlotDisplayData");var pq=ph.prototype;return pq.binarySearch1=function(ph,pq){var pf=0,pg=ph.length-2;if(0==pg)return 1;for(var p$=pg>>>1;;){if(ph[Math.floor(p$+1)]<=pq?pf=p$+1:pg=p$,pf==pg)return pf+1;p$=pf+pg>>>1}return 0},pq.apply=function(ph,pq,pf){if(void 0===pf&&(pf=1),ph+=.05,!(this.timeList.length<=0)){var pg=0;if(!(ph<this.timeList[0])){var p$=this.vectices[0].length,pP=[],pS=this.binarySearch1(this.timeList,ph);if(this.frameIndex=pS,ph>=this.timeList[this.timeList.length-1]){var pB=this.vectices[this.vectices.length-1];if(pf<1)for(pg=0;pg<p$;pg++)pP[pg]+=(pB[pg]-pP[pg])*pf;else for(pg=0;pg<p$;pg++)pP[pg]=pB[pg];this.deformData=pP}else{this.tweenKeyList[this.frameIndex];var pr=this.vectices[this.frameIndex-1],pY=this.vectices[this.frameIndex],pC=this.timeList[this.frameIndex-1],pU=this.timeList[this.frameIndex];pf=this.tweenKeyList[pS-1]?(ph-pC)/(pU-pC):0;var pu=NaN;for(pg=0;pg<p$;pg++)pu=pr[pg],pP[pg]=pu+(pY[pg]-pu)*pf;this.deformData=pP}}}},ph}(),pIh=function(){function ph(){this.time=NaN,this.drawOrder=[]}return pg(ph,"laya.ani.bone.DrawOrderData"),ph}(),pwh=function(){function ph(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return pg(ph,"laya.ani.bone.EventData"),ph}(),pN=function(){function pgh(ph,pq){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=ph,this._targetBone=pq[ph.targetBoneIndex],this.isSpine=ph.isSpine,null==this._bones&&(this._bones=[]);for(var pf=this._bones.length=0,pg=ph.boneIndexs.length;pf<pg;pf++)this._bones.push(pq[ph.boneIndexs[pf]]);this.name=ph.name,this.mix=ph.mix,this.bendDirection=ph.bendDirection}pg(pgh,"laya.ani.bone.IkConstraint");var ph=pgh.prototype;return ph.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},ph._applyIk1=function(ph,pq,pf,pg){var p$=ph.parentBone,pP=1/(p$.resultMatrix.a*p$.resultMatrix.d-p$.resultMatrix.b*p$.resultMatrix.c),pS=pq-p$.resultMatrix.tx,pB=pf-p$.resultMatrix.ty,pr=(pS*p$.resultMatrix.d-pB*p$.resultMatrix.c)*pP-ph.transform.x,pY=(pB*p$.resultMatrix.a-pS*p$.resultMatrix.b)*pP-ph.transform.y,pC=Math.atan2(pY,pr)*pgh.radDeg-0-ph.transform.skX;ph.transform.scX<0&&(pC+=180),180<pC?pC-=360:pC<-180&&(pC+=360),ph.transform.skX=ph.transform.skY=ph.transform.skX+pC*pg,ph.update()},ph.updatePos=function(ph,pq){this._sp&&this._sp.pos(ph,pq)},ph._applyIk2=function(ph,pq,pf,pg,p$,pP){if(0!=pP){var pS=ph.resultTransform.x,pB=ph.resultTransform.y,pr=ph.transform.scX,pY=ph.transform.scY,pC=pq.transform.scX,pU=0,pu=0,pv=0;pv=pr<0?(pr=-pr,pU=180,-1):(pU=0,1),pY<0&&(pY=-pY,pv=-pv),pu=pC<0?(pC=-pC,180):0;var pL=pq.resultTransform.x,pe=NaN,pl=NaN,p_=NaN,pN=ph.resultMatrix.a,pG=ph.resultMatrix.c,pm=ph.resultMatrix.b,pE=ph.resultMatrix.d,pR=Math.abs(pr-pY)<=1e-4;p_=pR?(pl=pN*pL+pG*(pe=pq.resultTransform.y)+ph.resultMatrix.tx,pm*pL+pE*pe+ph.resultMatrix.ty):(pe=0,pl=pN*pL+ph.resultMatrix.tx,pm*pL+ph.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new pPh,p$h.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(pf,pg,15,"#ffff00"),this._sp.graphics.drawCircle(pl,p_,15,"#ff00ff")),ph.setRotation(Math.atan2(p_-ph.resultMatrix.ty,pl-ph.resultMatrix.tx));var pt=ph.parentBone;pN=pt.resultMatrix.a,pG=pt.resultMatrix.c,pm=pt.resultMatrix.b;var pX=1/(pN*(pE=pt.resultMatrix.d)-pG*pm),pn=pf-pt.resultMatrix.tx,pJ=pg-pt.resultMatrix.ty,pp=(pn*pE-pJ*pG)*pX-pS,pA=(pJ*pN-pn*pm)*pX-pB,pd=((pn=pl-pt.resultMatrix.tx)*pE-(pJ=p_-pt.resultMatrix.ty)*pG)*pX-pS,pb=(pJ*pN-pn*pm)*pX-pB,pi=Math.sqrt(pd*pd+pb*pb),pz=pq.length*pC,pc=NaN,pM=NaN;if(pR){var pW=(pp*pp+pA*pA-pi*pi-(pz*=pr)*pz)/(2*pi*pz);pW<-1?pW=-1:1<pW&&(pW=1),pM=Math.acos(pW)*p$,pN=pi+pz*pW,pG=pz*Math.sin(pM),pc=Math.atan2(pA*pN-pp*pG,pp*pN+pA*pG)}else{var pT=(pN=pr*pz)*pN,pI=(pG=pY*pz)*pG,pw=pp*pp+pA*pA,pk=Math.atan2(pA,pp),pH=-2*pI*pi,pD=pI-pT;if(0<(pE=pH*pH-4*pD*(pm=pI*pi*pi+pT*pw-pT*pI))){var ps=Math.sqrt(pE);pH<0&&(ps=-ps);var pV=(ps=-(pH+ps)/2)/pD,pK=pm/ps,py=Math.abs(pV)<Math.abs(pK)?pV:pK;py*py<=pw&&(pJ=Math.sqrt(pw-py*py)*p$,pc=pk-Math.atan2(pJ,py),pM=Math.atan2(pJ/pY,(py-pi)/pr))}var pF=0,pZ=Number.MAX_VALUE,pQ=0,po=0,pO=0,pj=0,px=0,pa=0;pj<(pE=(pn=pi+pN)*pn)&&(pO=0,pj=pE,px=pn),(pE=(pn=pi-pN)*pn)<pZ&&(pF=Math.PI,pZ=pE,pQ=pn);var phh=Math.acos(-pN*pi/(pT-pI));(pE=(pn=pN*Math.cos(phh)+pi)*pn+(pJ=pG*Math.sin(phh))*pJ)<pZ&&(pF=phh,pZ=pE,pQ=pn,po=pJ),pj<pE&&(pO=phh,pj=pE,px=pn,pa=pJ),pM=pw<=(pZ+pj)/2?(pc=pk-Math.atan2(po*p$,pQ),pF*p$):(pc=pk-Math.atan2(pa*p$,px),pO*p$)}var pqh=Math.atan2(pe,pL)*pv,pfh=ph.resultTransform.skX;180<(pc=(pc-pqh)*pgh.radDeg+pU-pfh)?pc-=360:pc<-180&&(pc+=360),ph.resultTransform.x=pS,ph.resultTransform.y=pB,ph.resultTransform.skX=ph.resultTransform.skY=pfh+pc*pP,pfh=pq.resultTransform.skX,180<(pM=((pM+pqh)*pgh.radDeg-0)*pv+pu-(pfh%=360))?pM-=360:pM<-180&&(pM+=360),pq.resultTransform.x=pL,pq.resultTransform.y=pe,pq.resultTransform.skX=pq.resultTransform.skY=pq.resultTransform.skY+pM*pP,ph.update()}},ph._applyIk3=function(ph,pq,pf,pg,p$,pP){if(0!=pP){var pS,pB,pr=pq.resultMatrix.a*pq.length,pY=pq.resultMatrix.b*pq.length,pC=pr*pr+pY*pY,pU=Math.sqrt(pC),pu=ph.resultMatrix.tx,pv=ph.resultMatrix.ty,pL=pq.resultMatrix.tx,pe=pq.resultMatrix.ty,pl=pL-pu,p_=pe-pv,pN=pl*pl+p_*p_,pG=Math.sqrt(pN),pm=(pl=pf-ph.resultMatrix.tx)*pl+(p_=pg-ph.resultMatrix.ty)*p_,pE=Math.sqrt(pm);if(pU+pG<=pE||pE+pU<=pG||pE+pG<=pU){var pR=NaN;pL=pu+(pR=pU+pG<=pE?1:-1)*(pf-pu)*pG/pE,pe=pv+pR*(pg-pv)*pG/pE}else{var pt=(pN-pC+pm)/(2*pm),pX=Math.sqrt(pN-pt*pt*pm)/pE,pn=pu+pl*pt,pJ=pv+p_*pt,pp=-p_*pX,pA=pl*pX;pe=0<p$?(pL=pn-pp,pJ-pA):(pL=pn+pp,pJ+pA)}pS=pL,pB=pe,this.isDebug&&(this._sp||(this._sp=new pPh,p$h.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(pu,pv,15,"#ff00ff"),this._sp.graphics.drawCircle(pf,pg,15,"#ffff00"),this._sp.graphics.drawCircle(pS,pB,15,"#ff00ff"));var pd,pb;pd=Math.atan2(pB-ph.resultMatrix.ty,pS-ph.resultMatrix.tx),ph.setRotation(pd),(pb=pgh._tempMatrix).identity(),pb.rotate(pd),pb.scale(ph.resultMatrix.getScaleX(),ph.resultMatrix.getScaleY()),pb.translate(ph.resultMatrix.tx,ph.resultMatrix.ty),pb.copyTo(ph.resultMatrix),ph.updateChild();var pi,pz;pi=Math.atan2(pg-pB,pf-pS),pq.setRotation(pi),(pz=pgh._tempMatrix).identity(),pz.rotate(pi),pz.scale(pq.resultMatrix.getScaleX(),pq.resultMatrix.getScaleY()),pz.translate(pS,pB),pb.copyTo(pq.resultMatrix),pq.updateChild()}},pf(pgh,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new pbh}]),pgh}(),pkh=function(){function ph(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return pg(ph,"laya.ani.bone.IkConstraintData"),ph}(),pE=function(){function pz(ph,pq){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=ph,this.position=ph.position,this.spacing=ph.spacing,this.rotateMix=ph.rotateMix,this.translateMix=ph.translateMix,this.bones=[];for(var pf=this.data.bones,pg=0,p$=pf.length;pg<p$;pg++)this.bones.push(pq[pf[pg]])}pg(pz,"laya.ani.bone.PathConstraint");var ph=pz.prototype;return ph.apply=function(ph,pq){if(this.target){var pf=this.translateMix,pg=this.translateMix,p$=0<pg,pP=this.data.spacingMode,pS="length"==pP,pB=this.data.rotateMode,pr="tangent"==pB,pY="chainScale"==pB,pC=[],pU=this.bones.length,pu=pr?pU:pU+1,pv=[];(this._spaces=pv)[0]=this.position;var pL=this.spacing;if(pY||pS)for(var pe=0,pl=pu-1;pe<pl;){var p_=this.bones[pe],pN=p_.length,pG=pN*p_.resultMatrix.a,pm=pN*p_.resultMatrix.b;pN=Math.sqrt(pG*pG+pm*pm),pY&&(pC[pe]=pN),pv[++pe]=pS?Math.max(0,pN+pL):pL}else for(pe=1;pe<pu;pe++)pv[pe]=pL;var pE=this.computeWorldPositions(this.target,ph,pq,pu,pr,"percent"==this.data.positionMode,"percent"==pP);if(this._debugKey){for(pe=0;pe<pE.length;pe++)pq.drawCircle(pE[pe++],pE[pe++],5,"#00ff00");var pR=[];for(pe=0;pe<pE.length;pe++)pR.push(pE[pe++],pE[pe++]);pq.drawLines(0,0,pR,"#ff0000")}var pt=pE[0],pX=pE[1],pn=this.data.offsetRotation,pJ="chain"==pB&&0==pn,pp=NaN;for(pe=0,pp=3;pe<pU;pe++,pp+=3){(p_=this.bones[pe]).resultMatrix.tx+=(pt-p_.resultMatrix.tx)*pf,p_.resultMatrix.ty+=(pX-p_.resultMatrix.ty)*pf;var pA=(pG=pE[pp])-pt,pd=(pm=pE[pp+1])-pX;if(pY&&0!=(pN=pC[pe])){var pb=(Math.sqrt(pA*pA+pd*pd)/pN-1)*pg+1;p_.resultMatrix.a*=pb,p_.resultMatrix.c*=pb}if(pt=pG,pX=pm,p$){var pi=p_.resultMatrix.a,pz=p_.resultMatrix.c,pc=p_.resultMatrix.b,pM=p_.resultMatrix.d,pW=NaN,pT=NaN,pI=NaN;pW=pr?pE[pp-1]:0==pv[pe+1]?pE[pp+2]:Math.atan2(pd,pA),pW-=Math.atan2(pc,pi)-pn/180*Math.PI,pJ&&(pT=Math.cos(pW),pI=Math.sin(pW),pt+=((pN=p_.length)*(pT*pi-pI*pc)-pA)*pg,pX+=(pN*(pI*pi+pT*pc)-pd)*pg),pW>Math.PI?pW-=2*Math.PI:pW<-Math.PI&&(pW+=2*Math.PI),pW*=pg,pT=Math.cos(pW),pI=Math.sin(pW),p_.resultMatrix.a=pT*pi-pI*pc,p_.resultMatrix.c=pT*pz-pI*pM,p_.resultMatrix.b=pI*pi+pT*pc,p_.resultMatrix.d=pI*pz+pT*pM}}}},ph.computeWorldVertices2=function(ph,pq,pf,pg,p$,pP){var pS,pB,pr=ph.currDisplayData.bones,pY=ph.currDisplayData.weights,pC=ph.currDisplayData.triangles,pU=0,pu=0,pv=0,pL=0,pe=0,pl=0,p_=0,pN=0,pG=0,pm=0,pE=0;if(null!=pr){for(pU=0;pU<pf;pU+=2)pu+=(pL=pr[pu])+1,pv+=pL;var pR=pq;for(pe=pP,pl=3*pv;pe<pg;pe+=2){for(pN=p_=0,pL=pr[pu++],pL+=pu;pu<pL;pu++,pl+=3){pS=pR[pr[pu]].resultMatrix,pG=pY[pl],pm=pY[pl+1];var pt=pY[pl+2];p_+=(pG*pS.a+pm*pS.c+pS.tx)*pt,pN+=(pG*pS.b+pm*pS.d+pS.ty)*pt}p$[pe]=p_,p$[pe+1]=pN}}else{var pX,pn;if(pC||(pC=pY),ph.deformData&&(pC=ph.deformData),pX=ph.parent,pq)for(pE=pq.length,pU=0;pU<pE;pU++)if(pq[pU].name==pX){pB=pq[pU];break}pB&&(pn=pB.resultMatrix),pn||(pn=pz._tempMt);var pJ=pn.tx,pp=pn.ty,pA=pn.a,pd=pn.b,pb=pn.c,pi=pn.d;for(pB&&(pi*=pB.d),pu=pf,pe=pP;pe<pg;pu+=2,pe+=2)pG=pC[pu],pm=pC[pu+1],p$[pe]=pG*pA+pm*pd+pJ,p$[pe+1]=-(pG*pb+pm*pi+pp)}},ph.computeWorldPositions=function(ph,pq,pf,pg,p$,pP,pS){ph.currDisplayData.bones,ph.currDisplayData.weights,ph.currDisplayData.triangles;var pB=[],pr=0,pY=ph.currDisplayData.verLen,pC=this.position,pU=this._spaces,pu=[],pv=[],pL=pY/6,pe=-1,pl=NaN,p_=0,pN=0,pG=NaN,pm=NaN,pE=NaN,pR=NaN;if(pL--,pY-=4,this.computeWorldVertices2(ph,pq,2,pY,pB,0),this._debugKey)for(pr=0;pr<pB.length;)pf.drawCircle(pB[pr++],pB[pr++],10,"#ff0000");pu=pB,this._curves.length=pL;var pt=this._curves,pX=pu[pl=0],pn=pu[1],pJ=0,pp=0,pA=0,pd=0,pb=0,pi=0,pz=NaN,pc=NaN,pM=NaN,pW=NaN,pT=NaN,pI=NaN,pw=NaN,pk=NaN,pH=0;for(pr=0,pH=2;pr<pL;pr++,pH+=6)pJ=pu[pH],pp=pu[pH+1],pA=pu[pH+2],pd=pu[pH+3],pT=2*(pz=.1875*(pX-2*pJ+pA))+(pM=.09375*(3*(pJ-pA)-pX+(pb=pu[pH+4]))),pI=2*(pc=.1875*(pn-2*pp+pd))+(pW=.09375*(3*(pp-pd)-pn+(pi=pu[pH+5]))),pw=.75*(pJ-pX)+pz+.16666667*pM,pk=.75*(pp-pn)+pc+.16666667*pW,pl+=Math.sqrt(pw*pw+pk*pk),pw+=pT,pk+=pI,pT+=pM,pI+=pW,pl+=Math.sqrt(pw*pw+pk*pk),pw+=pT,pk+=pI,pl+=Math.sqrt(pw*pw+pk*pk),pw+=pT+pM,pk+=pI+pW,pl+=Math.sqrt(pw*pw+pk*pk),pt[pr]=pl,pX=pb,pn=pi;if(pP&&(pC*=pl),pS)for(pr=0;pr<pg;pr++)pU[pr]*=pl;var pD=this._segments,ps=0,pV=0;for(pV=pN=p_=pr=0;pr<pg;pr++,p_+=3)if((pG=pC+=pm=pU[pr])<0)this.addBeforePosition(pG,pu,0,pv,p_);else if(pl<pG)this.addAfterPosition(pG-pl,pu,pY-4,pv,p_);else{for(;;pN++)if(!((pR=pt[pN])<pG)){0==pN?pG/=pR:pG=(pG-(pE=pt[pN-1]))/(pR-pE);break}if(pN!=pe){var pK=6*(pe=pN);for(pX=pu[pK],pn=pu[pK+1],pJ=pu[pK+2],pp=pu[pK+3],pA=pu[pK+4],pd=pu[pK+5],pT=2*(pz=.03*(pX-2*pJ+pA))+(pM=.006*(3*(pJ-pA)-pX+(pb=pu[pK+6]))),pI=2*(pc=.03*(pn-2*pp+pd))+(pW=.006*(3*(pp-pd)-pn+(pi=pu[pK+7]))),pw=.3*(pJ-pX)+pz+.16666667*pM,pk=.3*(pp-pn)+pc+.16666667*pW,ps=Math.sqrt(pw*pw+pk*pk),pD[0]=ps,pK=1;pK<8;pK++)pw+=pT,pk+=pI,pT+=pM,pI+=pW,ps+=Math.sqrt(pw*pw+pk*pk),pD[pK]=ps;pw+=pT,pk+=pI,ps+=Math.sqrt(pw*pw+pk*pk),pD[8]=ps,pw+=pT+pM,pk+=pI+pW,ps+=Math.sqrt(pw*pw+pk*pk),pD[9]=ps,pV=0}for(pG*=ps;;pV++)if(!((pR=pD[pV])<pG)){0==pV?pG/=pR:pG=pV+(pG-(pE=pD[pV-1]))/(pR-pE);break}this.addCurvePosition(.1*pG,pX,pn,pJ,pp,pA,pd,pb,pi,pv,p_,p$||0<pr&&0==pm)}return pv},ph.addBeforePosition=function(ph,pq,pf,pg,p$){var pP=pq[pf],pS=pq[pf+1],pB=pq[pf+2]-pP,pr=pq[pf+3]-pS,pY=Math.atan2(pr,pB);pg[p$]=pP+ph*Math.cos(pY),pg[p$+1]=pS+ph*Math.sin(pY),pg[p$+2]=pY},ph.addAfterPosition=function(ph,pq,pf,pg,p$){var pP=pq[pf+2],pS=pq[pf+3],pB=pP-pq[pf],pr=pS-pq[pf+1],pY=Math.atan2(pr,pB);pg[p$]=pP+ph*Math.cos(pY),pg[p$+1]=pS+ph*Math.sin(pY),pg[p$+2]=pY},ph.addCurvePosition=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC,pU){0==ph&&(ph=1e-4);var pu=ph*ph,pv=pu*ph,pL=1-ph,pe=pL*pL,pl=pe*pL,p_=pL*ph,pN=3*p_,pG=pL*pN,pm=pN*ph,pE=pq*pl+pg*pG+pP*pm+pB*pv,pR=pf*pl+p$*pG+pS*pm+pr*pv;pY[pC]=pE,pY[pC+1]=pR,pY[pC+2]=pU?Math.atan2(pR-(pf*pe+p$*p_*2+pS*pu),pE-(pq*pe+pg*p_*2+pP*pu)):0},pz.NONE=-1,pz.BEFORE=-2,pz.AFTER=-3,pf(pz,["_tempMt",function(){return this._tempMt=new pbh}]),pz}(),pHh=function(){function ph(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return pg(ph,"laya.ani.bone.PathConstraintData"),ph}(),pDh=function(){function ph(){this.name=null,this.slotArr=[]}return pg(ph,"laya.ani.bone.SkinData"),ph}(),psh=function(){function ph(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}pg(ph,"laya.ani.bone.SkinSlotDisplayData");var pq=ph.prototype;return pq.createTexture=function(ph){return this.texture||(this.texture=new pih(ph.bitmap,this.uvs),ph.bitmap.alphaTexture&&(this.texture.alphaTexture=new pih(ph.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=ph.height,this.texture.height=ph.width,this.texture.offsetX=-ph.offsetX,this.texture.offsetY=-ph.offsetY,this.texture.sourceWidth=ph.sourceHeight,this.texture.sourceHeight=ph.sourceWidth):(this.texture.width=ph.width,this.texture.height=ph.height,this.texture.offsetX=-ph.offsetX,this.texture.offsetY=-ph.offsetY,this.texture.sourceWidth=ph.sourceWidth,this.texture.sourceHeight=ph.sourceHeight),pl.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},pq.destory=function(){this.texture&&this.texture.destroy()},ph}(),pVh=function(){function ph(){this.name=null,this.displayArr=[]}return pg(ph,"laya.ani.bone.SlotData"),ph.prototype.getDisplayByName=function(ph){for(var pq=0,pf=this.displayArr.length;pq<pf;pq++)if(this.displayArr[pq].attachmentName==ph)return pq;return-1},ph}(),pR=function(){function ph(ph,pq){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=pe(2,0),this._data=ph,null==this._bones&&(this._bones=[]),this.target=pq[ph.targetIndex];var pf,pg=0;for(pg=0,pf=ph.boneIndexs.length;pg<pf;pg++)this._bones.push(pq[ph.boneIndexs[pg]]);this.rotateMix=ph.rotateMix,this.translateMix=ph.translateMix,this.scaleMix=ph.scaleMix,this.shearMix=ph.shearMix}return pg(ph,"laya.ani.bone.TfConstraint"),ph.prototype.apply=function(){for(var ph,pq=this.target.resultMatrix.a,pf=this.target.resultMatrix.b,pg=this.target.resultMatrix.c,p$=this.target.resultMatrix.d,pP=0,pS=this._bones.length;pP<pS;pP++){if(ph=this._bones[pP],0<this.rotateMix){var pB=ph.resultMatrix.a,pr=ph.resultMatrix.b,pY=ph.resultMatrix.c,pC=ph.resultMatrix.d,pU=Math.atan2(pg,pq)-Math.atan2(pY,pB)+this._data.offsetRotation*Math.PI/180;pU>Math.PI?pU-=2*Math.PI:pU<-Math.PI&&(pU+=2*Math.PI),pU*=this.rotateMix;var pu=Math.cos(pU),pv=Math.sin(pU);ph.resultMatrix.a=pu*pB-pv*pY,ph.resultMatrix.b=pu*pr-pv*pC,ph.resultMatrix.c=pv*pB+pu*pY,ph.resultMatrix.d=pv*pr+pu*pC}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),ph.resultMatrix.tx+=(this._temp[0]-ph.resultMatrix.tx)*this.translateMix,ph.resultMatrix.ty+=(this._temp[1]-ph.resultMatrix.ty)*this.translateMix,ph.updateChild()),0<this.scaleMix){var pL=Math.sqrt(ph.resultMatrix.a*ph.resultMatrix.a+ph.resultMatrix.c*ph.resultMatrix.c),pe=Math.sqrt(pq*pq+pg*pg),pl=1e-5<pL?(pL+(pe-pL+this._data.offsetScaleX)*this.scaleMix)/pL:0;ph.resultMatrix.a*=pl,ph.resultMatrix.c*=pl,pL=Math.sqrt(ph.resultMatrix.b*ph.resultMatrix.b+ph.resultMatrix.d*ph.resultMatrix.d),pe=Math.sqrt(pf*pf+p$*p$),pl=1e-5<pL?(pL+(pe-pL+this._data.offsetScaleY)*this.scaleMix)/pL:0,ph.resultMatrix.b*=pl,ph.resultMatrix.d*=pl}if(0<this.shearMix){pr=ph.resultMatrix.b,pC=ph.resultMatrix.d;var p_=Math.atan2(pC,pr);(pU=Math.atan2(p$,pf)-Math.atan2(pg,pq)-(p_-Math.atan2(ph.resultMatrix.c,ph.resultMatrix.a)))>Math.PI?pU-=2*Math.PI:pU<-Math.PI&&(pU+=2*Math.PI),pU=p_+(pU+this._data.offsetShearY*Math.PI/180)*this.shearMix,pl=Math.sqrt(pr*pr+pC*pC),ph.resultMatrix.b=Math.cos(pU)*pl,ph.resultMatrix.d=Math.sin(pU)*pl}}},ph}(),pKh=function(){function ph(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return pg(ph,"laya.ani.bone.TfConstraintData"),ph}(),pyh=function(){function ph(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}pg(ph,"laya.ani.bone.Transform");var pq=ph.prototype;return pq.initData=function(ph){null!=ph.x&&(this.x=ph.x),null!=ph.y&&(this.y=ph.y),null!=ph.skX&&(this.skX=ph.skX),null!=ph.skY&&(this.skY=ph.skY),null!=ph.scX&&(this.scX=ph.scX),null!=ph.scY&&(this.scY=ph.scY)},pq.getMatrix=function(){var ph;return(ph=this.mMatrix?this.mMatrix:this.mMatrix=new pbh).identity(),ph.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(ph,this.skewX*Math.PI/180,this.skewY*Math.PI/180),ph.rotate(this.skX*Math.PI/180),ph.translate(this.x,this.y),ph},pq.skew=function(ph,pq,pf){var pg=Math.sin(pf),p$=Math.cos(pf),pP=Math.sin(pq),pS=Math.cos(pq);return ph.setTo(ph.a*pS-ph.b*pg,ph.a*pP+ph.b*p$,ph.c*pS-ph.d*pg,ph.c*pP+ph.d*p$,ph.tx*pS-ph.ty*pg,ph.tx*pP+ph.ty*p$),ph},ph}(),pt=function(){function ph(){}return pg(ph,"laya.ani.bone.UVTools"),ph.getRelativeUV=function(ph,pq,pf){var pg=ph[0],p$=ph[2]-ph[0],pP=ph[1],pS=ph[5]-ph[1];pf||(pf=[]),pf.length=pq.length;var pB,pr=0;pB=pf.length;var pY=1/p$,pC=1/pS;for(pr=0;pr<pB;pr+=2)pf[pr]=(pq[pr]-pg)*pY,pf[pr+1]=(pq[pr+1]-pP)*pC;return pf},ph.getAbsoluteUV=function(ph,pq,pf){if(0==ph[0]&&0==ph[1]&&1==ph[4]&&1==ph[5])return pf?(p_.copyArray(pf,pq),pf):pq;var pg=ph[0],p$=ph[2]-ph[0],pP=ph[1],pS=ph[5]-ph[1];pf||(pf=[]),pf.length=pq.length;var pB,pr=0;for(pB=pf.length,pr=0;pr<pB;pr+=2)pf[pr]=pq[pr]*p$+pg,pf[pr+1]=pq[pr+1]*pS+pP;return pf},ph}(),pz=function(){function ph(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return pg(ph,"laya.ani.KeyFramesContent"),ph}(),pX=function(){function pC(){}return pg(pC,"laya.ani.math.BezierLerp"),pC.getBezierRate=function(ph,pq,pf,pg,p$){var pP=pC._getBezierParamKey(pq,pf,pg,p$),pS=100*pP+ph;if(pC._bezierResultCache[pS])return pC._bezierResultCache[pS];var pB,pr=pC._getBezierPoints(pq,pf,pg,p$,pP),pY=0;for(pB=pr.length,pY=0;pY<pB;pY+=2)if(ph<=pr[pY])return pC._bezierResultCache[pS]=pr[pY+1],pr[pY+1];return pC._bezierResultCache[pS]=1},pC._getBezierParamKey=function(ph,pq,pf,pg){return 100*(100*(100*(100*ph+pq)+pf)+pg)},pC._getBezierPoints=function(ph,pq,pf,pg,p$){return pC._bezierPointsCache[p$]?pC._bezierPointsCache[p$]:(pP=[0,0,ph,pq,pf,pg,1,1],pS=(new pB).getBezierPoints(pP,100,3),pC._bezierPointsCache[p$]=pS);var pP,pS},pC._bezierResultCache={},pC._bezierPointsCache={},pC}(),pn=function(ph){function pq(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,pq.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}pg(pq,"laya.ani.AnimationPlayer",p$);var pf=pq.prototype;return p$h.imps(pf,{"laya.resource.IDestroy":!0}),pf._onTempletLoadedComputeFullKeyframeIndices=function(ph,pq,pf){this._templet===pf&&this._cachePlayRate===ph&&this._cacheFrameRate===pq&&this._computeFullKeyframeIndices()},pf._computeFullKeyframeIndices=function(){for(var ph=this._fullFrames=[],pq=this._templet,pf=this._cacheFrameRateInterval*this._cachePlayRate,pg=0,p$=pq.getAnimationCount();pg<p$;pg++){for(var pP=[],pS=0,pB=pq.getAnimation(pg).nodes.length;pS<pB;pS++){for(var pr=pq.getAnimation(pg).nodes[pS],pY=Math.floor(pr.playTime/pf+.01),pC=new Uint16Array(pY+1),pU=-1,pu=0,pv=pr.keyFrame.length;pu<pv;pu++){var pL=pr.keyFrame[pu],pe=pL.startTime,pl=pe+pL.duration+pf;do{for(var p_=Math.floor(pe/pf+.5),pN=pU+1;pN<p_;pN++)pC[pN]=pu;pC[pU=p_]=pu,pe+=pf}while(pe<=pl)}pP.push(pC)}ph.push(pP)}},pf._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},pf._calculatePlayDuration=function(){if(0!==this.state){var ph=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=ph),this._playEnd>ph&&(this._playEnd=ph),this._playDuration=this._playEnd-this._playStart}},pf._setPlayParams=function(ph,pq){this._currentTime=ph,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/pq+.01),0),this._currentFrameTime=this._currentKeyframeIndex*pq},pf._setPlayParamsWhenStop=function(ph,pq){this._currentTime=ph,this._currentKeyframeIndex=Math.max(Math.floor(ph/pq+.01),0),this._currentFrameTime=this._currentKeyframeIndex*pq,this._currentAnimationClipIndex=-1},pf._update=function(ph){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var pq=this._cacheFrameRateInterval*this._cachePlayRate,pf=0;this._startUpdateLoopCount!==pL.loopCount&&(pf=ph*this.playbackRate,this._elapsedPlaybackTime+=pf);var pg=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=pg)return this._setPlayParamsWhenStop(pg,pq),void this.event("stopped");if(pf+=this._currentTime,0<pg)if(pg<=pf)do{if(pf-=pg,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(pg,pq),this._stopWhenCircleFinish=!1,void this.event("stopped");pf<pg&&(this._setPlayParams(pf,pq),this.event("complete"))}while(pg<=pf);else this._setPlayParams(pf,pq);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(pg,pq),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},pf._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},pf.play=function(ph,pq,pf,pg,p$){if(void 0===ph&&(ph=0),void 0===pq&&(pq=1),void 0===pf&&(pf=2147483647),void 0===pg&&(pg=0),void 0===p$&&(p$=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(pf<0||pg<0||p$<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==p$&&p$<pg)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=pq,this._overallDuration=pf,this._playStart=pg,this._playEnd=p$,this._paused=!1,this._currentAnimationClipIndex=ph,this._currentKeyframeIndex=0,this._startUpdateLoopCount=pL.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},pf.playByFrame=function(ph,pq,pf,pg,p$,pP){void 0===ph&&(ph=0),void 0===pq&&(pq=1),void 0===pf&&(pf=2147483647),void 0===pg&&(pg=0),void 0===p$&&(p$=0),void 0===pP&&(pP=30);var pS=1e3/pP;this.play(ph,pq,pf,pg*pS,p$*pS)},pf.stop=function(ph){void 0===ph&&(ph=!0),ph?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},pP(0,pf,"playEnd",function(){return this._playEnd}),pP(0,pf,"templet",function(){return this._templet},function(ph){0===!this.state&&this.stop(!0),this._templet!==ph&&((this._templet=ph).loaded?this._computeFullKeyframeIndices():ph.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),pP(0,pf,"playStart",function(){return this._playStart}),pP(0,pf,"playDuration",function(){return this._playDuration}),pP(0,pf,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),pP(0,pf,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),pP(0,pf,"overallDuration",function(){return this._overallDuration}),pP(0,pf,"currentFrameTime",function(){return this._currentFrameTime}),pP(0,pf,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),pP(0,pf,"currentPlayTime",function(){return this._currentTime+this._playStart}),pP(0,pf,"cachePlayRate",function(){return this._cachePlayRate},function(ph){this._cachePlayRate!==ph&&(this._cachePlayRate=ph,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[ph,this._cacheFrameRate])))}),pP(0,pf,"cacheFrameRate",function(){return this._cacheFrameRate},function(ph){this._cacheFrameRate!==ph&&(this._cacheFrameRate=ph,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,ph])))}),pP(0,pf,"currentTime",null,function(ph){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(ph<this._playStart||ph>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=pL.loopCount;var pq=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=ph,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/pq),0),this._currentFrameTime=this._currentKeyframeIndex*pq}}),pP(0,pf,"paused",function(){return this._paused},function(ph){(this._paused=ph)&&this.event("paused")}),pP(0,pf,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),pP(0,pf,"destroyed",function(){return this._destroyed}),pq}(),pc=function(ph){function pq(){pq.__super.call(this),pl.isConchNode&&(this.drawSkin=function(ph){ph.transform||(ph.transform=pbh.EMPTY),this._addCmd([ph]),this.setSkinMesh&&this.setSkinMesh(ph._ps,ph.mVBData,ph.mEleNum,0,ph.mTexture,ph.transform)})}return pg(pq,"laya.ani.GraphicsAni",pS),pq.prototype.drawSkin=function(ph){var pq=[ph];this._saveToCmd(pl._context._drawSkin,pq)},pq.create=function(){return pq._caches.pop()||new pq},pq.recycle=function(ph){ph.clear(),pq._caches.push(ph)},pq._caches=[],pq}(),pM=function(ph){function pN(){this._aniMap={},this.unfixedLastAniIndex=-1,pN.__super.call(this),this._anis=new Array}pg(pN,"laya.ani.AnimationTemplet",pC);var pq=pN.prototype;return pq.parse=function(ph){var pq=new pdh(ph);this._aniVersion=pq.readUTFString(),pG.parse(this,pq)},pq._calculateKeyFrame=function(ph,pq,pf){var pg=ph.keyFrame;pg[pq]=pg[0];for(var p$=0;p$<pq;p$++){var pP=pg[p$];pP.nextData=0===pP.duration?pP.data:pg[p$+1].data}pg.length--},pq.onAsynLoaded=function(ph,pq,pf){var pg=new pdh(pq);switch(this._aniVersion=pg.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":pm.parse(this,pg);break;default:pG.parse(this,pg)}this._endLoaded()},pq.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},pq.getAnimationCount=function(){return this._anis.length},pq.getAnimation=function(ph){return this._anis[ph]},pq.getAniDuration=function(ph){return this._anis[ph].playTime},pq.getNodes=function(ph){return this._anis[ph].nodes},pq.getNodeIndexWithName=function(ph,pq){return this._anis[ph].bone3DMap[pq]},pq.getNodeCount=function(ph){return this._anis[ph].nodes.length},pq.getTotalkeyframesLength=function(ph){return this._anis[ph].totalKeyframeDatasLength},pq.getPublicExtData=function(){return this._publicExtData},pq.getAnimationDataWithCache=function(ph,pq,pf,pg){var p$=pq[pf];if(p$){var pP=p$[ph];return pP?pP[pg]:null}return null},pq.setAnimationDataWithCache=function(ph,pq,pf,pg,p$){var pP=pq[pf]||(pq[pf]={});(pP[ph]||(pP[ph]=[]))[pg]=p$},pq.getOriginalData=function(ph,pq,pf,pg,p$){for(var pP=this._anis[ph].nodes,pS=0,pB=0,pr=pP.length,pY=0;pB<pr;pB++){var pC,pU=pP[pB];pC=pU.keyFrame[pf[pB][pg]],pU.dataOffset=pY;var pu=p$-pC.startTime,pv=pU.lerpType;if(pv)switch(pv){case 0:case 1:for(pS=0;pS<pU.keyframeWidth;)pS+=pU.interpolationMethod[pS](pU,pS,pq,pY+pS,pC.data,pu,null,pC.duration,pC.nextData);break;case 2:var pL=pC.interpolationData,pe=pL.length,pl=0;for(pS=0;pS<pe;){var p_=pL[pS];switch(p_){case 6:case 7:pS+=pN.interpolation[p_](pU,pl,pq,pY+pl,pC.data,pu,null,pC.duration,pC.nextData,pL,pS+1);break;default:pS+=pN.interpolation[p_](pU,pl,pq,pY+pl,pC.data,pu,null,pC.duration,pC.nextData)}pl++}}else for(pS=0;pS<pU.keyframeWidth;)pS+=pU.interpolationMethod[pS](pU,pS,pq,pY+pS,pC.data,pu,null,pC.duration,pC.nextData);pY+=pU.keyframeWidth}},pq.getNodesCurrentFrameIndex=function(ph,pq){var pf=this._anis[ph].nodes;ph!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(pf.length),this.unfixedCurrentTimes=new Float32Array(pf.length),this.unfixedLastAniIndex=ph);for(var pg=0,p$=pf.length;pg<p$;pg++){var pP=pf[pg];for(pq<this.unfixedCurrentTimes[pg]&&(this.unfixedCurrentFrameIndexes[pg]=0),this.unfixedCurrentTimes[pg]=pq;this.unfixedCurrentFrameIndexes[pg]<pP.keyFrame.length&&!(pP.keyFrame[this.unfixedCurrentFrameIndexes[pg]].startTime>this.unfixedCurrentTimes[pg]);)this.unfixedCurrentFrameIndexes[pg]++;this.unfixedCurrentFrameIndexes[pg]--}return this.unfixedCurrentFrameIndexes},pq.getOriginalDataUnfixedRate=function(ph,pq,pf){var pg=this._anis[ph].nodes;ph!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(pg.length),this.unfixedCurrentTimes=new Float32Array(pg.length),this.unfixedKeyframes=pe(pg.length),this.unfixedLastAniIndex=ph);for(var p$=0,pP=0,pS=pg.length,pB=0;pP<pS;pP++){var pr=pg[pP];for(pf<this.unfixedCurrentTimes[pP]&&(this.unfixedCurrentFrameIndexes[pP]=0),this.unfixedCurrentTimes[pP]=pf;this.unfixedCurrentFrameIndexes[pP]<pr.keyFrame.length&&!(pr.keyFrame[this.unfixedCurrentFrameIndexes[pP]].startTime>this.unfixedCurrentTimes[pP]);)this.unfixedKeyframes[pP]=pr.keyFrame[this.unfixedCurrentFrameIndexes[pP]],this.unfixedCurrentFrameIndexes[pP]++;var pY=this.unfixedKeyframes[pP];pr.dataOffset=pB;var pC=pf-pY.startTime;if(pr.lerpType)switch(pr.lerpType){case 0:case 1:for(p$=0;p$<pr.keyframeWidth;)p$+=pr.interpolationMethod[p$](pr,p$,pq,pB+p$,pY.data,pC,null,pY.duration,pY.nextData);break;case 2:var pU=pY.interpolationData,pu=pU.length,pv=0;for(p$=0;p$<pu;){var pL=pU[p$];switch(pL){case 6:case 7:p$+=pN.interpolation[pL](pr,pv,pq,pB+pv,pY.data,pC,null,pY.duration,pY.nextData,pU,p$+1);break;default:p$+=pN.interpolation[pL](pr,pv,pq,pB+pv,pY.data,pC,null,pY.duration,pY.nextData)}pv++}}else for(p$=0;p$<pr.keyframeWidth;)p$+=pr.interpolationMethod[p$](pr,p$,pq,pB+p$,pY.data,pC,null,pY.duration,pY.nextData);pB+=pr.keyframeWidth}},pN._LinearInterpolation_0=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){var pC=0===pB?0:pP/pB;return pf[pg]=(1-pC)*p$[pq]+pC*pr[pq],1},pN._QuaternionInterpolation_1=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){var pC=0===pB?0:pP/pB;return pu.slerpQuaternionArray(p$,pq,pr,pq,pC,pf,pg),4},pN._AngleInterpolation_2=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){return 0},pN._RadiansInterpolation_3=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){return 0},pN._Matrix4x4Interpolation_4=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){for(var pC=0;pC<16;pC++,pq++)pf[pg+pC]=p$[pq]+pP*pS[pq];return 16},pN._NoInterpolation_5=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY){return pf[pg]=p$[pq],1},pN._BezierInterpolation_6=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC){return void 0===pC&&(pC=0),pf[pg]=p$[pq]+(pr[pq]-p$[pq])*pX.getBezierRate(pP/pB,pY[pC],pY[pC+1],pY[pC+2],pY[pC+3]),5},pN._BezierInterpolation_7=function(ph,pq,pf,pg,p$,pP,pS,pB,pr,pY,pC){return void 0===pC&&(pC=0),pf[pg]=pY[pC+4]+pY[pC+5]*pX.getBezierRate((.001*pP+pY[pC+6])/pY[pC+7],pY[pC],pY[pC+1],pY[pC+2],pY[pC+3]),9},pN.load=function(ph){return p$h.loader.create(ph,null,null,pN)},pN.interpolation=[pN._LinearInterpolation_0,pN._QuaternionInterpolation_1,pN._AngleInterpolation_2,pN._RadiansInterpolation_3,pN._Matrix4x4Interpolation_4,pN._NoInterpolation_5,pN._BezierInterpolation_6,pN._BezierInterpolation_7],pN}(),pJ=function(pq){function pf(ph,pq){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,pf.__super.call(this),void 0===pq&&(pq=0),ph&&this.init(ph,pq)}pg(pf,"laya.ani.bone.Skeleton",pq);var ph=pf.prototype;return ph.init=function(ph,pq){void 0===pq&&(pq=0);var pf,pg,p$,pP=0,pS=0;if(1==pq)for(this._graphicsCache=[],pP=0,pS=ph.getAnimationCount();pP<pS;pP++)this._graphicsCache.push([]);if(this._yReverseMatrix=ph.yReverseMatrix,this._aniMode=pq,this._templet=ph,this._player=new pn,this._player.cacheFrameRate=ph.rate,this._player.templet=ph,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=ph.mBoneArr,this._rootBone=ph.mRootBone,this._aniSectionDic=ph.aniSectionDic,0<ph.ikArr.length)for(this._ikArr=[],pP=0,pS=ph.ikArr.length;pP<pS;pP++)this._ikArr.push(new pN(ph.ikArr[pP],this._boneList));if(0<ph.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),pP=0,pS=ph.pathArr.length;pP<pS;pP++)pf=ph.pathArr[pP],pg=new pE(pf,this._boneList),(p$=this._boneSlotDic[pf.name])&&((pg=new pE(pf,this._boneList)).target=p$),this._pathDic[pf.name]=pg;if(0<ph.tfArr.length)for(this._tfArr=[],pP=0,pS=ph.tfArr.length;pP<pS;pP++)this._tfArr.push(new pR(ph.tfArr[pP],this._boneList));if(0<ph.skinDataArray.length){var pB=this._templet.skinDataArray[this._skinIndex];this._skinName=pB.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},ph.load=function(ph,pq,pf){},ph._onLoaded=function(){},ph._parseComplete=function(){var ph=pp.TEMPLET_DICTIONARY[this._aniPath];ph&&(this.init(ph,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},ph._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},ph._onPlay=function(){this.event("played")},ph._onStop=function(){var ph,pq=this._templet.eventAniArr[this._aniClipIndex];if(pq&&this._eventIndex<pq.length)for(;this._eventIndex<pq.length;this._eventIndex++)(ph=pq[this._eventIndex]).time>=this._player.playStart&&ph.time<=this._player.playEnd&&this.event("label",ph);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},ph._onPause=function(){this.event("paused")},ph._parseSrcBoneMatrix=function(){var ph=0,pq=0;for(pq=this._templet.srcBoneMatrixArr.length,ph=0;ph<pq;ph++)this._boneMatrixArray.push(new pbh);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var pf,pg,p$=this._templet.boneSlotArray;for(ph=0,pq=p$.length;ph<pq;ph++)pf=p$[ph],null==(pg=this._bindBoneBoneSlotDic[pf.parent])&&(this._bindBoneBoneSlotDic[pf.parent]=pg=[]),this._boneSlotDic[pf.name]=pf=pf.copy(),pg.push(pf),this._boneSlotArray.push(pf)}},ph._emitMissedEvents=function(ph,pq,pf){void 0===pf&&(pf=0);var pg=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(pg){var p$,pP,pS=0;for(p$=pg.length,pS=pf;pS<p$;pS++)(pP=pg[pS]).time>=this._player.playStart&&pP.time<=this._player.playEnd&&this.event("label",pP)}},ph._update=function(ph){if(void 0===ph&&(ph=!0),!(this._pause||ph&&this._indexControl)){var pq=this.timer.currTimer,pf=this._player.currentKeyframeIndex,pg=pq-this._lastTime;if(ph?this._player._update(pg):pf=-1,this._lastTime=pq,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<pg&&this._clipIndex==pf&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var p$;this._lastUpdateAniClipIndex=this._aniClipIndex,pf>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var pP,pS=this._templet.eventAniArr[this._aniClipIndex];if(pS&&this._eventIndex<pS.length&&((p$=pS[this._eventIndex]).time>=this._player.playStart&&p$.time<=this._player.playEnd?this._player.currentPlayTime>=p$.time&&(this.event("label",p$),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(pP=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=pP&&(this.graphics=pP));var pB=0,pr=0;for(pr=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,pr-1)&&0<pr;)pr--;if(pr<this._clipIndex)for(pB=pr;pB<this._clipIndex;pB++)this._createGraphics(pB)}else if(1==this._aniMode){if(pP=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=pP&&(this.graphics=pP));for(pr=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,pr-1)&&0<pr;)pr--;if(pr<this._clipIndex)for(pB=pr;pB<this._clipIndex;pB++)this._createGraphics(pB)}this._createGraphics()}}},ph._createGraphics=function(ph){void 0===ph&&(ph=-1),-1==ph&&(ph=this._clipIndex);var pq,pf,pg=ph*this._player.cacheFrameRateInterval,p$=this._templet.drawOrderAniArr[this._aniClipIndex];if(p$&&0<p$.length)for(this._drawOrderIndex=0,pq=p$[this._drawOrderIndex];pg>=pq.time&&(this._drawOrder=pq.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=p$.length));)pq=p$[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=pc.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=pc.create(),pf=this.graphics;var pP=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],ph,pg);var pS,pB,pr,pY,pC=this._aniSectionDic[this._aniClipIndex],pU=0,pu=0,pv=0,pL=0,pe=0,pl=this._templet.srcBoneMatrixArr.length;for(pe=pC[pu=0];pu<pl;pu++)pY=this._boneList[pu],pr=this._templet.srcBoneMatrixArr[pu],pY.resultTransform.scX=pr.scX*this._curOriginalData[pU++],pY.resultTransform.skX=pr.skX+this._curOriginalData[pU++],pY.resultTransform.skY=pr.skY+this._curOriginalData[pU++],pY.resultTransform.scY=pr.scY*this._curOriginalData[pU++],pY.resultTransform.x=pr.x+this._curOriginalData[pU++],pY.resultTransform.y=pr.y+this._curOriginalData[pU++],8===this._templet.tMatrixDataLen&&(pY.resultTransform.skewX=pr.skewX+this._curOriginalData[pU++],pY.resultTransform.skewY=pr.skewY+this._curOriginalData[pU++]);var p_,pN={},pG={};for(pe+=pC[1];pu<pe;pu++)pN[(p_=pP[pu]).name]=this._curOriginalData[pU++],pG[p_.name]=this._curOriginalData[pU++],this._curOriginalData[pU++],this._curOriginalData[pU++],this._curOriginalData[pU++],this._curOriginalData[pU++];var pm,pE,pR={},pt={};for(pe+=pC[2];pu<pe;pu++)pR[(p_=pP[pu]).name]=this._curOriginalData[pU++],pt[p_.name]=this._curOriginalData[pU++],this._curOriginalData[pU++],this._curOriginalData[pU++],this._curOriginalData[pU++],this._curOriginalData[pU++];if(this._pathDic)for(pe+=pC[3];pu<pe;pu++){if(p_=pP[pu],pm=this._pathDic[p_.name])switch(new pdh(p_.extenData).getByte()){case 1:pm.position=this._curOriginalData[pU++];break;case 2:pm.spacing=this._curOriginalData[pU++];break;case 3:pm.rotateMix=this._curOriginalData[pU++],pm.translateMix=this._curOriginalData[pU++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(pbh.TEMP.identity()),this._ikArr)for(pu=0,pe=this._ikArr.length;pu<pe;pu++)pE=this._ikArr[pu],pR.hasOwnProperty(pE.name)&&(pE.bendDirection=pR[pE.name]),pt.hasOwnProperty(pE.name)&&(pE.mix=pt[pE.name]),pE.apply();if(this._pathDic)for(var pX in this._pathDic)(pm=this._pathDic[pX]).apply(this._boneList,pf);if(this._tfArr)for(pu=0,pL=this._tfArr.length;pu<pL;pu++)this._tfArr[pu].apply();for(pu=0,pL=this._boneList.length;pu<pL;pu++)if(pY=this._boneList[pu],pB=this._bindBoneBoneSlotDic[pY.name],pY.resultMatrix.copyTo(this._boneMatrixArray[pu]),pB)for(pv=0,pe=pB.length;pv<pe;pv++)(pS=pB[pv])&&pS.setParentMatrix(pY.resultMatrix);var pn,pJ,pp,pA,pd={},pb=this._templet.deformAniArr;if(pb&&0<pb.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,pu=0,pe=this._boneSlotArray.length;pu<pe;pu++)(pS=this._boneSlotArray[pu]).deformData=null;var pi,pz=pb[this._aniClipIndex];for(pi in pn=pz.default,this._setDeform(pn,pd,this._boneSlotArray,pg),pz)"default"!=pi&&pi!=this._skinName&&(pn=pz[pi],this._setDeform(pn,pd,this._boneSlotArray,pg));pn=pz[this._skinName],this._setDeform(pn,pd,this._boneSlotArray,pg)}if(this._drawOrder)for(pu=0,pe=this._drawOrder.length;pu<pe;pu++)pJ=pN[(pS=this._boneSlotArray[this._drawOrder[pu]]).name],pp=pG[pS.name],isNaN(pp)||(pf.save(),pf.alpha(pp)),isNaN(pJ)||-2==pJ||(this._templet.attachmentNames?pS.showDisplayByName(this._templet.attachmentNames[pJ]):pS.showDisplayByIndex(pJ)),pd[this._drawOrder[pu]]?(pA=pd[this._drawOrder[pu]],pS.currDisplayData&&pA[pS.currDisplayData.attachmentName]?pS.deformData=pA[pS.currDisplayData.attachmentName]:pS.deformData=null):pS.deformData=null,isNaN(pp)?pS.draw(pf,this._boneMatrixArray,2==this._aniMode):pS.draw(pf,this._boneMatrixArray,2==this._aniMode,pp),isNaN(pp)||pf.restore();else for(pu=0,pe=this._boneSlotArray.length;pu<pe;pu++)pJ=pN[(pS=this._boneSlotArray[pu]).name],pp=pG[pS.name],isNaN(pp)||(pf.save(),pf.alpha(pp)),isNaN(pJ)||-2==pJ||(this._templet.attachmentNames?pS.showDisplayByName(this._templet.attachmentNames[pJ]):pS.showDisplayByIndex(pJ)),pd[pu]?(pA=pd[pu],pS.currDisplayData&&pA[pS.currDisplayData.attachmentName]?pS.deformData=pA[pS.currDisplayData.attachmentName]:pS.deformData=null):pS.deformData=null,isNaN(pp)?pS.draw(pf,this._boneMatrixArray,2==this._aniMode):pS.draw(pf,this._boneMatrixArray,2==this._aniMode,pp),isNaN(pp)||pf.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,ph,pf):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,ph,pf)},ph._setDeform=function(ph,pq,pf,pg){if(ph){var p$,pP,pS,pB=0,pr=0,pY=0;if(ph)for(pB=0,pr=ph.deformSlotDataList.length;pB<pr;pB++)for(p$=ph.deformSlotDataList[pB],pY=0;pY<p$.deformSlotDisplayList.length;pY++)pS=pf[(pP=p$.deformSlotDisplayList[pY]).slotIndex],pP.apply(pg,pS),pq[pP.slotIndex]||(pq[pP.slotIndex]={}),pq[pP.slotIndex][pP.attachment]=pP.deformData}},ph.getAnimNum=function(){return this._templet.getAnimationCount()},ph.getAniNameByIndex=function(ph){return this._templet.getAniNameByIndex(ph)},ph.getSlotByName=function(ph){return this._boneSlotDic[ph]},ph.showSkinByName=function(ph,pq){void 0===pq&&(pq=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(ph),pq)},ph.showSkinByIndex=function(ph,pq){void 0===pq&&(pq=!0);for(var pf=0;pf<this._boneSlotArray.length;pf++)this._boneSlotArray[pf].showSlotData(null,pq);if(this._templet.showSkinByIndex(this._boneSlotDic,ph,pq)){var pg=this._templet.skinDataArray[ph];this._skinIndex=ph,this._skinName=pg.name}this._clearCache()},ph.showSlotSkinByIndex=function(ph,pq){if(0!=this._aniMode){var pf=this.getSlotByName(ph);pf&&pf.showDisplayByIndex(pq),this._clearCache()}},ph.showSlotSkinByName=function(ph,pq){if(0!=this._aniMode){var pf=this.getSlotByName(ph);pf&&pf.showDisplayByName(pq),this._clearCache()}},ph.replaceSlotSkinName=function(ph,pq,pf){if(0!=this._aniMode){var pg=this.getSlotByName(ph);pg&&pg.replaceDisplayByName(pq,pf),this._clearCache()}},ph.replaceSlotSkinByIndex=function(ph,pq,pf){if(0!=this._aniMode){var pg=this.getSlotByName(ph);pg&&pg.replaceDisplayByIndex(pq,pf),this._clearCache()}},ph.setSlotSkin=function(ph,pq){if(0!=this._aniMode){var pf=this.getSlotByName(ph);pf&&pf.replaceSkin(pq),this._clearCache()}},ph._clearCache=function(){if(1==this._aniMode)for(var ph=0,pq=this._graphicsCache.length;ph<pq;ph++){for(var pf=0,pg=this._graphicsCache[ph].length;pf<pg;pf++){var p$=this._graphicsCache[ph][pf];p$!=this.graphics&&pc.recycle(p$)}this._graphicsCache[ph].length=0}},ph.play=function(ph,pq,pf,pg,p$,pP){void 0===pf&&(pf=!0),void 0===pg&&(pg=0),void 0===p$&&(p$=0),void 0===pP&&(pP=!0),this._indexControl=!1;var pS=-1,pB=NaN;if(pB=pq?2147483647:0,"string"==typeof ph)for(var pr=0,pY=this._templet.getAnimationCount();pr<pY;pr++){var pC=this._templet.getAnimation(pr);if(pC&&ph==pC.name){pS=pr;break}}else pS=ph;-1<pS&&pS<this.getAnimNum()&&(this._aniClipIndex=pS,(pf||this._pause||this._currAniIndex!=pS)&&(this._currAniIndex=pS,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(pS)),this._drawOrder=null,this._eventIndex=0,this._player.play(pS,this._player.playbackRate,pB,pg,p$),pP&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=pU.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},ph.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},ph.playbackRate=function(ph){this._player&&(this._player.playbackRate=ph)},ph.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},ph.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=pU.now(),this.timer.frameLoop(1,this,this._update,null,!0))},ph._getGrahicsDataWithCache=function(ph,pq){return this._graphicsCache[ph][pq]},ph._setGrahicsDataWithCache=function(ph,pq,pf){this._graphicsCache[ph][pq]=pf},ph.destroy=function(ph){void 0===ph&&(ph=!0),pq.prototype.destroy.call(this,ph),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},pP(0,ph,"url",function(){return this._aniPath},function(ph){this.load(ph)}),pP(0,ph,"index",function(){return this._index},function(ph){this.player&&(this._index=ph,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),pP(0,ph,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),pP(0,ph,"templet",function(){return this._templet}),pP(0,ph,"player",function(){return this._player}),pf.useSimpleMeshInCanvas=!1,pf}(pPh),pp=function(pq){function p$(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,p$.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}pg(p$,"laya.ani.bone.Templet",pq);var ph=p$.prototype;return ph.getLoadList=function(){return this._loadList},ph.loadAni=function(ph){this._skBufferUrl=ph,p$h.loader.load(ph,pr.create(this,this.onComplete),null,"arraybuffer")},ph.onComplete=function(ph){if(this._isDestroyed)this.destroy();else{var pq=pY.getRes(this._skBufferUrl);pq?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,pq)):this.event("error","load failed:"+this._skBufferUrl)}},ph.parseData=function(ph,pq,pf){void 0===pf&&(pf=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=ph,this._mainTexture&&pl.isWebGL&&ph.bitmap&&(ph.bitmap.enableMerageInAtlas=!1),this._rate=pf,this.parse(pq)},ph.buildArmature=function(ph){return void 0===ph&&(ph=0),new pJ(this,ph)},ph.parse=function(ph){pq.prototype.parse.call(this,ph),this._endLoaded(),this._aniVersion!=p$.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+p$.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},ph._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var ph=0;this._loadList=[];var pq,pf=new pdh(this.getPublicExtData()),pg=0,p$=0,pP=0,pS=pf.getInt32(),pB=pf.readUTFString(),pr=pB.split("\n");for(ph=0;ph<pS;ph++)pq=this._path+pr[2*ph],pB=pr[2*ph+1],pf.getFloat32(),pf.getFloat32(),pg=pf.getFloat32(),p$=pf.getFloat32(),pP=pf.getFloat32(),isNaN(pP)?0:pP,pP=pf.getFloat32(),isNaN(pP)?0:pP,pP=pf.getFloat32(),isNaN(pP)?pg:pP,pP=pf.getFloat32(),isNaN(pP)?p$:pP,-1==this._loadList.indexOf(pq)&&this._loadList.push(pq);this.event("inited",this)}},ph._textureComplete=function(){for(var ph,pq,pf=0,pg=this._loadList.length;pf<pg;pf++)pq=this._loadList[pf],ph=this._textureDic[pq]=pY.getRes(pq),pl.isWebGL&&ph&&ph.bitmap&&(ph.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},ph._parsePublicExtData=function(){var ph=0,pq=0,pf=0,pg=0,p$=0;for(ph=0,p$=this.getAnimationCount();ph<p$;ph++)this._graphicsCache.push([]);var pP;pP="Dragon"!=this._aniClassName;var pS,pB,pr=new pdh(this.getPublicExtData()),pY=0,pC=0,pU=0,pu=0,pv=0,pL=0,pe=0,pl=0,p_=0,pN=pr.getInt32(),pG=pr.readUTFString(),pm=pG.split("\n");for(ph=0;ph<pN;ph++){if(pS=this._mainTexture,pB=this._path+pm[2*ph],pG=pm[2*ph+1],null==this._mainTexture&&(pS=this._textureDic[pB]),!pS)return this.event("error",this),void(this.isParseFail=!0);pY=pr.getFloat32(),pC=pr.getFloat32(),pU=pr.getFloat32(),pu=pr.getFloat32(),p_=pr.getFloat32(),pv=isNaN(p_)?0:p_,p_=pr.getFloat32(),pL=isNaN(p_)?0:p_,p_=pr.getFloat32(),pe=isNaN(p_)?pU:p_,p_=pr.getFloat32(),pl=isNaN(p_)?pu:p_,this.subTextureDic[pG]=pih.create(pS,pY,pC,pU,pu,-pv,-pL,pe,pl),pS.alphaTexture&&(this.subTextureDic[pG].alphaTexture=pih.create(pS.alphaTexture,pY,pC,pU,pu,-pv,-pL,pe,pl))}this._mainTexture=pS;var pE,pR,pt,pX,pn,pJ=pr.getUint16();for(ph=0;ph<pJ;ph++)(pE=[]).push(pr.getUint16()),pE.push(pr.getUint16()),pE.push(pr.getUint16()),pE.push(pr.getUint16()),this.aniSectionDic[ph]=pE;var pp,pA=pr.getInt16(),pd={};for(ph=0;ph<pA;ph++)pR=new pzh,0==ph?pp=pR:pR.root=pp,pR.d=pP?-1:1,pX=pr.readUTFString(),pn=pr.readUTFString(),pR.length=pr.getFloat32(),1==pr.getByte()&&(pR.inheritRotation=!1),1==pr.getByte()&&(pR.inheritScale=!1),pR.name=pX,pn&&((pt=pd[pn])?pt.addChild(pR):this.mRootBone=pR),pd[pX]=pR,this.mBoneArr.push(pR);this.tMatrixDataLen=pr.getUint16();var pb,pi,pz=pr.getUint16(),pc=Math.floor(pz/this.tMatrixDataLen),pM=this.srcBoneMatrixArr;for(ph=0;ph<pc;ph++)(pb=new pyh).scX=pr.getFloat32(),pb.skX=pr.getFloat32(),pb.skY=pr.getFloat32(),pb.scY=pr.getFloat32(),pb.x=pr.getFloat32(),pb.y=pr.getFloat32(),8===this.tMatrixDataLen&&(pb.skewX=pr.getFloat32(),pb.skewY=pr.getFloat32()),pM.push(pb),(pR=this.mBoneArr[ph]).transform=pb;var pW,pT=pr.getUint16(),pI=0;for(ph=0;ph<pT;ph++){for(pi=new pkh,pI=pr.getUint16(),pq=0;pq<pI;pq++)pi.boneNames.push(pr.readUTFString()),pi.boneIndexs.push(pr.getInt16());pi.name=pr.readUTFString(),pi.targetBoneName=pr.readUTFString(),pi.targetBoneIndex=pr.getInt16(),pi.bendDirection=pr.getFloat32(),pi.mix=pr.getFloat32(),pi.isSpine=pP,this.ikArr.push(pi)}var pw,pk=pr.getUint16(),pH=0;for(ph=0;ph<pk;ph++){for(pW=new pKh,pH=pr.getUint16(),pq=0;pq<pH;pq++)pW.boneIndexs.push(pr.getInt16());pW.name=pr.getUTFString(),pW.targetIndex=pr.getInt16(),pW.rotateMix=pr.getFloat32(),pW.translateMix=pr.getFloat32(),pW.scaleMix=pr.getFloat32(),pW.shearMix=pr.getFloat32(),pW.offsetRotation=pr.getFloat32(),pW.offsetX=pr.getFloat32(),pW.offsetY=pr.getFloat32(),pW.offsetScaleX=pr.getFloat32(),pW.offsetScaleY=pr.getFloat32(),pW.offsetShearY=pr.getFloat32(),this.tfArr.push(pW)}var pD=pr.getUint16(),ps=0;for(ph=0;ph<pD;ph++){for((pw=new pHh).name=pr.readUTFString(),ps=pr.getUint16(),pq=0;pq<ps;pq++)pw.bones.push(pr.getInt16());pw.target=pr.readUTFString(),pw.positionMode=pr.readUTFString(),pw.spacingMode=pr.readUTFString(),pw.rotateMode=pr.readUTFString(),pw.offsetRotation=pr.getFloat32(),pw.position=pr.getFloat32(),pw.spacing=pr.getFloat32(),pw.rotateMix=pr.getFloat32(),pw.translateMix=pr.getFloat32(),this.pathArr.push(pw)}var pV,pK,py,pF,pZ,pQ=0,po=0,pO=0,pj=NaN,px=0,pa=pr.getInt16();for(ph=0;ph<pa;ph++){var phh=pr.getUint8(),pqh={};this.deformAniArr.push(pqh);for(var pfh=0;pfh<phh;pfh++)for((pV=new pMh).skinName=pr.getUTFString(),pqh[pV.skinName]=pV,pQ=pr.getInt16(),pq=0;pq<pQ;pq++)for(pK=new pWh,pV.deformSlotDataList.push(pK),po=pr.getInt16(),pf=0;pf<po;pf++)for(py=new pTh,pK.deformSlotDisplayList.push(py),py.slotIndex=pr.getInt16(),py.attachment=pr.getUTFString(),pO=pr.getInt16(),pg=0;pg<pO;pg++)for(1==pr.getByte()?py.tweenKeyList.push(!0):py.tweenKeyList.push(!1),pj=pr.getFloat32(),py.timeList.push(pj),pF=[],py.vectices.push(pF),px=pr.getInt16(),p$=0;p$<px;p$++)pF.push(pr.getFloat32())}var pgh,p$h,pPh=pr.getInt16(),pSh=0,pBh=0;for(ph=0;ph<pPh;ph++){for(pSh=pr.getInt16(),pZ=[],pq=0;pq<pSh;pq++){for((pgh=new pIh).time=pr.getFloat32(),pBh=pr.getInt16(),pf=0;pf<pBh;pf++)pgh.drawOrder.push(pr.getInt16());pZ.push(pgh)}this.drawOrderAniArr.push(pZ)}var prh,pYh=pr.getInt16(),pCh=0;for(ph=0;ph<pYh;ph++){for(pCh=pr.getInt16(),p$h=[],pq=0;pq<pCh;pq++)(prh=new pwh).name=pr.getUTFString(),prh.intValue=pr.getInt32(),prh.floatValue=pr.getFloat32(),prh.stringValue=pr.getUTFString(),prh.time=pr.getFloat32(),p$h.push(prh);this.eventAniArr.push(p$h)}var pUh=pr.getInt16();if(0<pUh)for(this.attachmentNames=[],ph=0;ph<pUh;ph++)this.attachmentNames.push(pr.getUTFString());var puh,pvh,pLh=pr.getInt16();for(ph=0;ph<pLh;ph++)(puh=new pch).name=pr.readUTFString(),puh.parent=pr.readUTFString(),puh.attachmentName=pr.readUTFString(),puh.srcDisplayIndex=puh.displayIndex=pr.getInt16(),(puh.templet=this).boneSlotDic[puh.name]=puh,null==(pvh=this.bindBoneBoneSlotDic[puh.parent])&&(this.bindBoneBoneSlotDic[puh.parent]=pvh=[]),pvh.push(puh),this.boneSlotArray.push(puh);var peh,plh,p_h,pNh=pr.readUTFString().split("\n"),pGh=0,pmh=pr.getUint8(),pEh=0,pRh=0,pth=0,pXh=0,pnh=0,pJh=0,pph=0;for(ph=0;ph<pmh;ph++){for((peh=new pDh).name=pNh[pGh++],pEh=pr.getUint8(),pq=0;pq<pEh;pq++){for((plh=new pVh).name=pNh[pGh++],puh=this.boneSlotDic[plh.name],pRh=pr.getUint8(),pf=0;pf<pRh;pf++){if(p_h=new psh,this.skinSlotDisplayDataArr.push(p_h),p_h.name=pNh[pGh++],p_h.attachmentName=pNh[pGh++],p_h.transform=new pyh,p_h.transform.scX=pr.getFloat32(),p_h.transform.skX=pr.getFloat32(),p_h.transform.skY=pr.getFloat32(),p_h.transform.scY=pr.getFloat32(),p_h.transform.x=pr.getFloat32(),p_h.transform.y=pr.getFloat32(),plh.displayArr.push(p_h),p_h.width=pr.getFloat32(),p_h.height=pr.getFloat32(),p_h.type=pr.getUint8(),p_h.verLen=pr.getUint16(),0<(pA=pr.getUint16()))for(p_h.bones=[],pg=0;pg<pA;pg++){var pAh=pr.getUint16();p_h.bones.push(pAh)}if(0<(pth=pr.getUint16()))for(p_h.uvs=[],pg=0;pg<pth;pg++)p_h.uvs.push(pr.getFloat32());if(0<(pXh=pr.getUint16()))for(p_h.weights=[],pg=0;pg<pXh;pg++)p_h.weights.push(pr.getFloat32());if(0<(pnh=pr.getUint16()))for(p_h.triangles=[],pg=0;pg<pnh;pg++)p_h.triangles.push(pr.getUint16());if(0<(pJh=pr.getUint16()))for(p_h.vertices=[],pg=0;pg<pJh;pg++)p_h.vertices.push(pr.getFloat32());if(0<(pph=pr.getUint16()))for(p_h.lengths=[],pg=0;pg<pph;pg++)p_h.lengths.push(pr.getFloat32())}peh.slotArr.push(plh)}this.skinDic[peh.name]=peh,this.skinDataArray.push(peh)}1==pr.getUint8()?(this.yReverseMatrix=new pbh(1,0,0,-1,0,0),pp&&pp.setTempMatrix(this.yReverseMatrix)):pp&&pp.setTempMatrix(new pbh),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},ph.getTexture=function(ph){var pq=this.subTextureDic[ph];return pq||(pq=this.subTextureDic[ph.substr(0,ph.length-1)]),null==pq?this._mainTexture:pq},ph.showSkinByIndex=function(ph,pq,pf){if(void 0===pf&&(pf=!0),pq<0&&pq>=this.skinDataArray.length)return!1;var pg,p$,pP=0,pS=0,pB=this.skinDataArray[pq];if(pB){for(pP=0,pS=pB.slotArr.length;pP<pS;pP++)(p$=pB.slotArr[pP])&&(pg=ph[p$.name])&&(pg.showSlotData(p$,pf),pf&&"undefined"!=pg.attachmentName&&"null"!=pg.attachmentName?pg.showDisplayByName(pg.attachmentName):pg.showDisplayByIndex(pg.displayIndex));return!0}return!1},ph.getSkinIndexByName=function(ph){for(var pq=0,pf=this.skinDataArray.length;pq<pf;pq++)if(this.skinDataArray[pq].name==ph)return pq;return-1},ph.getGrahicsDataWithCache=function(ph,pq){return this._graphicsCache[ph][pq]},ph.setGrahicsDataWithCache=function(ph,pq,pf){this._graphicsCache[ph][pq]=pf},ph.destroy=function(){var ph;for(var pq in this._isDestroyed=!0,this.subTextureDic)(ph=this.subTextureDic[pq])&&ph.destroy();for(pq in this._textureDic)(ph=this._textureDic[pq])&&ph.destroy();for(var pf=0,pg=this.skinSlotDisplayDataArr.length;pf<pg;pf++)this.skinSlotDisplayDataArr[pf].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete p$.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},ph.getAniNameByIndex=function(ph){var pq=this.getAnimation(ph);return pq?pq.name:null},pP(0,ph,"rate",function(){return this._rate},function(ph){this._rate=ph}),p$.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",p$.TEMPLET_DICTIONARY=null,p$}(pM)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ph,pq){"use strict";for(var pf in Object.defineProperty(pq,"__esModule",{value:!0}),Laya){var pg=Laya[pf];pg&&pg.__isclass&&(pq[pf]=pg)}});